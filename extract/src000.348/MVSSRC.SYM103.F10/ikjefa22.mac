         TITLE 'I K J E F A 2 2  --  CHANGE PASSWORD/ACCOUNT NUMBER ROU*
               TINE    '
IKJEFA22 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFA22  73.209'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*         CTRLTABP = R1;              /* ADDR OF THE CHANGE        0021
*                                        CONTROL TABLE               */
         LR    CTRLTABP,R1                                         0021
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */
*         /* ALLOCATE WORK REGISTERS.                                */
*         HEDBPTR = HEADADDR;         /* ASSIGN PTR TO USER HEADER   */
         SLR   @10,@10                                             0023
         ICM   @10,7,HEADADDR(CTRLTABP)                            0023
         LR    HEDBPTR,@10                                         0023
*         SRCHIND = 0;                /* INIT THE SEARCH INDICATOR   */
         MVI   SRCHIND(CTRLTABP),X'00'                             0024
*         CFLAGS = '0'B;              /* INITIALIZE ALL FLAGS        */
         MVI   CFLAGS,B'00000000'                                  0025
*         /* PARTIAL BUILDING OF GETSPACE/FREESPACE PARAMETER LIST.  */
*         /* IT WILL BE COMPLETED AT EACH POINT OF CALL.             */
*         READBUFF = HEADADDR;        /* PTR TO USERID TREE BUFFER   */
         ST    @10,READBUFF                                        0026
*         NUMBLOKS = BLKCNT;          /* NO. OF BLOCKS IN BUFFER     */
         SLR   @10,@10                                             0027
         IC    @10,BLKCNT(,CTRLTABP)                               0027
         STH   @10,NUMBLOKS                                        0027
*         /***********************************************************/
*         /*                                                         */
*         /*          CHANGE LEVEL  =  PASSWORD LEVEL                */
*         /*                                                         */
*         /***********************************************************/
*         DPOBPTR = PASSADDR;         /* GET ADDR FROM CTRLTAB       */
         L     DPOBPTR,PASSADDR(,CTRLTABP)                         0028
*         NLPWOBAD = DPOBPTR;         /* SAVE ADDR OF THIS OBLK      */
         LR    NLPWOBAD,DPOBPTR                                    0029
*         /* DETERMINE WHETHER CHANGE LEVEL = PASSWORD LEVEL. IF IT  */
*         /* IS, THEN SEARCH FOR THE DATALIST PASSWORD. IF NOT, THEN */
*         /* CONTINUE AT THE ACCTNMBR LEVEL.                         */
*         IF CHLEVL = 3                                            0030
*           THEN                      /* CHANGE LEVEL ^= PASSWD LEVL */
         CLI   CHLEVL(CTRLTABP),3                                  0030
         BE    @RT00030                                            0030
*             GOTO ACLEVL;            /* CONTINUE AT THE ACTNBR LEVL */
*         /* AN '*' IN THE PASSWORD POSITION MEANS: CHANGE ALL PASS- */
*         /* WORDS TO THE NEW PASSWORD.                              */
*         IF PASSWD(1) = '*'          /* NLPASSWORD = '*'?           */
*           THEN                      /* YES,                        */
         L     @10,NODELPTR(,CTRLTABP)                             0032
         CLI   PASSWD(@10),C'*'                                    0032
         BE    @RT00032                                            0032
*             GOTO CHALLPW;           /* GO CHANGE ALL PASSWORDS     */
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF 1ST PASSWRD OBLK        */
         LR    DPOBPTR,HEDBPTR                                     0034
         A     DPOBPTR,UADSPWD1(,HEDBPTR)                          0034
*         /* SEARCH FOR THE PASSWORD SPECIFIED IN THE DATALIST.      */
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */
         NI    LOOPFLG,B'11111011'                                 0035
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TO END OF PASSWD CHAIN */
         B     @DE00036                                            0036
@DL00036 DS    0H                                                  0037
*           UADSPPTR = HEDBPTR+UADSPDAT;/* REF THE PASSWD DATA FIELD */
         LR    UADSPPTR,HEDBPTR                                    0037
         A     UADSPPTR,UADSPDAT(,DPOBPTR)                         0037
*           /* COMPARE THE UADS PASSWORD TO THE DATALIST PASSWORD.   */
*           IF UADSPPWD = DPASSWD                                  0038
*             THEN                    /* THE DLPASSWORD EXISTS IN THIS
*                                        CHAIN. PRUNING IS NECESSARY */
         L     @10,DATALPTR(,CTRLTABP)                             0038
         CLC   UADSPPWD(8,UADSPPTR),DPASSWD(@10)                   0038
         BNE   @RF00038                                            0038
*               DO;                                                0039
*               DLPWOBAD = DPOBPTR;   /* SAVE THE ADDR OF THIS OBLK  */
         ST    DPOBPTR,DLPWOBAD                                    0040
*               GOTO ACTWSRCH;        /* GO SEARCH FOR ACTNBR TWINS  */
         B     ACTWSRCH                                            0041
*               END;                                               0042
*           /* THE DATALIST PASSWORD HAS NOT BEEN FOUND YET. IF THERE
*              ARE MORE PASSWORDS IN THIS CHAIN, THEN CONTINUE THE 0043
*              SEARCH.                                               */
*           IF PFLG01 = '1'B          /* WAS THIS THE LAST PASSWORD? */
*             THEN                    /* YES,                        */
@RF00038 TM    PFLG01(DPOBPTR),B'10000000'                         0043
         BNO   @RF00043                                            0043
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */
         OI    LOOPFLG,B'00000100'                                 0044
*             ELSE                    /* NO,                         */
*               DPOBPTR = HEDBPTR     /* REF THE NEXT PASSWORD OBLK  */
*                 +UADSPNEX;                                       0045
         B     @RC00043                                            0045
@RF00043 LR    @10,HEDBPTR                                         0045
         SLR   @09,@09                                             0045
         ICM   @09,7,UADSPNEX(DPOBPTR)                             0045
         AR    @10,@09                                             0045
         LR    DPOBPTR,@10                                         0045
*         END;                                                     0046
@RC00043 DS    0H                                                  0046
@DE00036 TM    LOOPFLG,B'00000100'                                 0046
         BZ    @DL00036                                            0046
*         /* THE DATALIST PASSWORD DOES NOT EXIST IN THIS CHAIN.     */
*         /* THEREFORE, PRUNING IS NOT NECESSARY. CHANGE THE NODE-   */
*         /* LIST PASSWORD DATA FIELD.                               */
*         DPOBPTR = NLPWOBAD;         /* REF THE NLPASSWORD OBLK     */
         LR    DPOBPTR,NLPWOBAD                                    0047
*         UADSPPTR = HEDBPTR+UADSPDAT;/* REF THE DATA FIELD          */
         LR    UADSPPTR,HEDBPTR                                    0048
         A     UADSPPTR,UADSPDAT(,DPOBPTR)                         0048
*         UADSPPWD = DPASSWD;         /* INSERT THE NEW PASSWORD     */
         L     @10,DATALPTR(,CTRLTABP)                             0049
         MVC   UADSPPWD(8,UADSPPTR),DPASSWD(@10)                   0049
*         GOTO CHGEOK;                /* WRITE THIS TREE BACK INTO 0050
*                                        THE UADS                    */
         B     CHGEOK                                              0050
*CHALLPW: /* ALL PASSWORDS IN THIS TREE ARE TO BE CHANGED TO THE     */
*         /* DATALIST PASSWORD. ALL ACCTNMBRS WILL BECOME BROTHERS.  */
*         /* TWINS CREATED BY THIS MERGE MUST BE PRUNED FROM THE     */
*         /* USERID TREE.                                            */
*         UADSPPTR = HEDBPTR+UADSPDAT;/* REF ITS DATA FIELD          */
CHALLPW  LR    UADSPPTR,HEDBPTR                                    0051
         A     UADSPPTR,UADSPDAT(,DPOBPTR)                         0051
*         UADSPPWD = DPASSWD;         /* INSERT THE DATALIST PASSWRD */
         L     @10,DATALPTR(,CTRLTABP)                             0052
         MVC   UADSPPWD(8,UADSPPTR),DPASSWD(@10)                   0052
*         PNEXSAVE = UADSPNEX;        /* SAVE OFFSET TO NEXT OBLK    */
         SLR   @10,@10                                             0053
         ICM   @10,7,UADSPNEX(DPOBPTR)                             0053
         ST    @10,PNEXSAVE                                        0053
*         UADSPNEX = 0;               /* SET OFFSET TO NEXT OBLK TO 0,
*                                        INDICATING END OF CHAIN     */
         SLR   @10,@10                                             0054
         STCM  @10,7,UADSPNEX(DPOBPTR)                             0054
*         /* IF THIS TREE HAS ONLY ONE PASSWORD, THEN NO OTHER CHAN- */
*         /* GES ARE NECESSARY.                                      */
*         IF PFLG01 = '1'B            /* ANY BROTHERS?               */
*           THEN                      /* NO,                         */
         TM    PFLG01(DPOBPTR),B'10000000'                         0055
         BO    @RT00055                                            0055
*             GOTO CHGEOK;            /* GO WRITE THIS TREE BACK   0056
*                                        INTO THE UADS               */
*         PFLG01 = '1'B;              /* SET CHAIN FLAG TO '1'       */
         OI    PFLG01(DPOBPTR),B'10000000'                         0057
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE FIRST ACCTNMBR OBLK */
         LR    DNOBPTR,HEDBPTR                                     0058
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0058
*         /* MERGE ALL ACCTNMBR CHAINS BY CHANGING ALL COUSINS TO    */
*         /* BROTHERS.                                               */
*         /* CHANGE ALL CHAIN FLAGS THAT ARE '1' TO '0', EXCEPT THE  */
*         /* LAST ONE IN THE TOTAL CHAIN.                            */
*         DO WHILE UADSANEX ^= 0;     /* END OF TOTAL CHAIN?         */
         B     @DE00059                                            0059
@DL00059 DS    0H                                                  0060
*             AFLG01 = '0'B;          /* CHANGE FLAG TO '0'          */
         NI    AFLG01(DNOBPTR),B'01111111'                         0060
*             DNOBPTR = HEDBPTR+UADSANEX; /* REF THE NEXT ACCT OBLK  */
         LR    @10,HEDBPTR                                         0061
         SLR   @09,@09                                             0061
         ICM   @09,7,UADSANEX(DNOBPTR)                             0061
         AR    @10,@09                                             0061
         LR    DNOBPTR,@10                                         0061
*             END;                                                 0062
@DE00059 ICM   @10,7,UADSANEX(DNOBPTR)                             0062
         BNZ   @DL00059                                            0062
*         /* SEARCH THE TOTAL ACCTNMBR CHAIN FOR TWINS.              */
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE FIRST ACCTNMBR OBLK */
         LR    DNOBPTR,HEDBPTR                                     0063
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0063
*         /* COMPARE THIS ACCTNMBR TO ALL OTHERS IN THE TOTAL CHAIN  */
*         /* IF THIS IS THE LAST ACCTNMBR IN THE TOTAL CHAIN,        */
*         /* THEN THE SEARCH FOR ACCTNMBR TWINS IS FINISHED.         */
*         LOOPFLG2 = '0'B;            /* RESET LOOP FLAG             */
         NI    LOOPFLG2,B'11111101'                                0064
*         DO WHILE LOOPFLG2 = '0'B;   /* LOOP TO END OF ACCTNBR CHAIN*/
         B     @DE00065                                            0065
@DL00065 DS    0H                                                  0066
*           ACTWIN2 = DNOBPTR;        /* SAVE THE ADDR OF THIS OBLK  */
         LR    ACTWIN2,DNOBPTR                                     0066
*           ADATSAVE = UADSADAT;      /* SAVE THE OFFSET TO ITS DFLD */
         L     @10,UADSADAT(,DNOBPTR)                              0067
         ST    @10,ADATSAVE                                        0067
*           /* REFERENCE THE FIRST BROTHER AND COMPARE THE DATA      */
*           /* FIELD OFFSETS. IF THEY ARE EQUAL, THEN THE ACCTNMBRS  */
*           /* MUST BE EQUAL.                                        */
*TCTWSR2:   DO WHILE UADSANEX ^= 0;   /* LOOP TO END OF ACCTNBR CHAIN*/
TCTWSR2  B     @DE00068                                            0068
@DL00068 DS    0H                                                  0069
*             DNOBPTR = HEDBPTR+UADSANEX;/* REF THE BROTHER OBLK     */
         LR    @10,HEDBPTR                                         0069
         SLR   @07,@07                                             0069
         ICM   @07,7,UADSANEX(DNOBPTR)                             0069
         AR    @10,@07                                             0069
         LR    DNOBPTR,@10                                         0069
*             IF UADSADAT = ADATSAVE  /* ARE THE DATA OFFSETS EQUAL? */
*               THEN                  /* YES, TWINS HAVE BEEN FOUND  */
         CLC   UADSADAT(4,DNOBPTR),ADATSAVE                        0070
         BNE   @RF00070                                            0070
*                 DO;                                              0071
*                 ACTWIN1 = DNOBPTR;  /* SAVE ADDR OF SECOND TWIN    */
         LR    ACTWIN1,DNOBPTR                                     0072
*                 ACTWSRF = '0'B;     /* SET FLAG TO DETERMINE FLOW  */
         NI    ACTWSRF,B'11101111'                                 0073
*                 GOTO PRTWSRCH;      /* GO SEARCH FOR PROC TWINS    */
         B     PRTWSRCH                                            0074
*                 END;                                             0075
*             END;                                                 0076
@RF00070 DS    0H                                                  0076
@DE00068 ICM   @10,7,UADSANEX(DNOBPTR)                             0076
         BNZ   @DL00068                                            0076
*           DNOBPTR = ACTWIN2;        /* REF THE ACCTNMBR JUST USED
*                                        FOR COMPARISON              */
         LR    DNOBPTR,ACTWIN2                                     0077
*           IF AFLG01 = '1'B          /* END OF CHAIN?               */
*             THEN                    /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0078
         BNO   @RF00078                                            0078
*               LOOPFLG2 = '1'B;      /* TERMINATE LOOP              */
         OI    LOOPFLG2,B'00000010'                                0079
*             ELSE                                                 0080
*               DNOBPTR = HEDBPTR+    /* REF ITS BROTHER AND MAKE IT */
*                 UADSANEX;           /* THE BASIS FOR COMPARISON    */
         B     @RC00078                                            0080
@RF00078 LR    @10,HEDBPTR                                         0080
         SLR   @09,@09                                             0080
         ICM   @09,7,UADSANEX(DNOBPTR)                             0080
         AR    @10,@09                                             0080
         LR    DNOBPTR,@10                                         0080
*           END;                                                   0081
@RC00078 DS    0H                                                  0081
@DE00065 TM    LOOPFLG2,B'00000010'                                0081
         BZ    @DL00065                                            0081
*         /* PRUNE ALL PASSWORDS AFTER THE FIRST ONE IN THE CHAIN    */
*         /* FROM THIS USERID TREE.                                  */
*         DO WHILE PNEXSAVE ^= 0;     /* LOOP TO END OF CHAIN        */
         B     @DE00082                                            0082
@DL00082 DS    0H                                                  0083
*           DPOBPTR = HEDBPTR+PNEXSAVE; /* REF THE NEXT OBLK         */
         LR    DPOBPTR,HEDBPTR                                     0083
         A     DPOBPTR,PNEXSAVE                                    0083
*           /* PREPARE TO FREE THE PASSWORD DATA FIELD.              */
*           AREAOFST = UADSPDAT;      /* OFFSET TO THIS DATAFLD      */
         L     @10,UADSPDAT(,DPOBPTR)                              0084
         ST    @10,AREAOFST                                        0084
*           AREALNTH = 12;            /* NUMBER OF BYTES TO BE FREED */
         MVC   AREALNTH(2),@CH00055                                0085
*           CALL IKJFRSP;             /* GO FREE THIS DATA FIELD     */
         BAL   @14,IKJFRSP                                         0086
*           PNEXSAVE = UADSPNEX;      /* SAVE OFFSET TO NEXT OBLK    */
         SLR   @10,@10                                             0087
         ICM   @10,7,UADSPNEX(DPOBPTR)                             0087
         ST    @10,PNEXSAVE                                        0087
*           /* PREPARE TO FREE THE PASSWORD OFFSET BLOCK.            */
*           AREAOFST = DPOBPTR-HEDBPTR;/* OFFSET TO THIS OBLK        */
         LR    @10,DPOBPTR                                         0088
         SR    @10,HEDBPTR                                         0088
         ST    @10,AREAOFST                                        0088
*           CALL IKJFRSP;             /* GO FREE THIS OFFSET BLOCK   */
         BAL   @14,IKJFRSP                                         0089
*           END;                                                   0090
@DE00082 L     @10,PNEXSAVE                                        0090
         LTR   @10,@10                                             0090
         BNZ   @DL00082                                            0090
*         GOTO CHGEOK;                /* GO WRITE THIS TREE BACK INTO
*                                        THE UADS                    */
         B     CHGEOK                                              0091
*ACTWSRCH:/* A MERGING OF TWO ACCTNMBR CHAINS IS NECESSARY BECAUSE   */
*         /* OF THE PRUNING OF A PASSWORD FROM THE TREE. THE TWO     */
*         /* CHAINS MUST BE COMPARED TO ASSURE THAT THE MERGE WILL   */
*         /* NOT RESULT IN TWINS. IF IT DOES, THEN ONE OF THE TWINS  */
*         /* MUST BE PRUNED FROM THE TREE.                           */
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE SUBFIELD            */
ACTWSRCH LR    DNOBPTR,HEDBPTR                                     0092
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0092
*         /* BEGINNING OF THE SEARCH LOOP                            */
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */
         NI    LOOPFLG,B'11111011'                                 0093
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TO END OF ACCTNBR CHAIN*/
         B     @DE00094                                            0094
@DL00094 DS    0H                                                  0095
*           ACTWIN2 = DNOBPTR;        /* SAVE ADDR OF THIS OBLK IN 0095
*                                        THE DLPASSWORD ACTNBR CHAIN */
         LR    ACTWIN2,DNOBPTR                                     0095
*           ADATSAVE = UADSADAT;      /* SAVE OFFSET TO THIS DATAFLD */
         L     @10,UADSADAT(,DNOBPTR)                              0096
         ST    @10,ADATSAVE                                        0096
*           DPOBPTR = NLPWOBAD;       /* REF THE NLPASSWORD OBLK     */
         LR    DPOBPTR,NLPWOBAD                                    0097
*           DNOBPTR = HEDBPTR+UADSPSUB; /* REF ITS DATA FIELD        */
         LR    DNOBPTR,HEDBPTR                                     0098
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0098
*           /* COMPARE THE OFFSETS TO THE DATA FIELDS. IF THE ACCTNBRS
*              ARE THE SAME, THEN THEIR OFFSET BLOCKS MUST POINT TO
*              THE SAME DATA FIELDS.                                 */
*           LOOPFLG2 = '0'B;          /* RESET LOOP FLAG             */
         NI    LOOPFLG2,B'11111101'                                0099
*           DO WHILE LOOPFLG2 = '0'B; /* LOOP TO END OF ACCTNBR CHAIN*/
         B     @DE00100                                            0100
@DL00100 DS    0H                                                  0101
*             IF UADSADAT = ADATSAVE  /* OFFSETS TO DATAFLDS EQUAL?  */
*             THEN                    /* YES, TWINS EXIST            */
         CLC   UADSADAT(4,DNOBPTR),ADATSAVE                        0101
         BNE   @RF00101                                            0101
*               DO;                                                0102
*               ACTWIN1 = DNOBPTR;    /* SAVE ADDR OF THIS TWIN OBLK */
         LR    ACTWIN1,DNOBPTR                                     0103
*               ACTWSRF = '1'B;       /* FLAG TO DETERMINE FLOW      */
         OI    ACTWSRF,B'00010000'                                 0104
*               GOTO PRTWSRCH;        /* GO SEARCH FOR PROC TWINS IN
*                                        THESE TWO ACCTNMBR CHAINS   */
         B     PRTWSRCH                                            0105
*               END;                                               0106
*             IF AFLG01 = '1'B        /* WAS THIS THE LAST ACCTNMBR? */
*               THEN                  /* YES,                        */
@RF00101 TM    AFLG01(DNOBPTR),B'10000000'                         0107
         BNO   @RF00107                                            0107
*                 LOOPFLG2 = '1'B;    /* TERMINATE LOOP              */
         OI    LOOPFLG2,B'00000010'                                0108
*               ELSE                  /* NO,                         */
*                 DNOBPTR = HEDBPTR   /* REF THE NEXT ACCTNMBR OBLK  */
*                   +UADSANEX;        /* UNDER THE NODELIST PASSWORD */
         B     @RC00107                                            0109
@RF00107 LR    @10,HEDBPTR                                         0109
         SLR   @07,@07                                             0109
         ICM   @07,7,UADSANEX(DNOBPTR)                             0109
         AR    @10,@07                                             0109
         LR    DNOBPTR,@10                                         0109
*             END;                                                 0110
@RC00107 DS    0H                                                  0110
@DE00100 TM    LOOPFLG2,B'00000010'                                0110
         BZ    @DL00100                                            0110
*ACTWSR1:   /* CONTINUATION AFTER A TWIN HAS BEEN PRUNED.            */
*           DNOBPTR = ACTWIN2;        /* REF THE LAST-USED ACCTNMBR
*                                        OBLK UNDER THE DLPASSWORD   */
ACTWSR1  LR    DNOBPTR,ACTWIN2                                     0111
*           /* ARE THERE MORE ACCTNMBRS UNDER THE DATALIST PASSWORD? */
*           IF AFLG01 = '1'B          /* WAS THIS THE LAST ACCTNMBR? */
*             THEN                    /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0112
         BNO   @RF00112                                            0112
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */
         OI    LOOPFLG,B'00000100'                                 0113
*             ELSE                    /* NO,                         */
*               DNOBPTR = HEDBPTR     /* REF THE NEXT ACCTNMBR OBLK  */
*                 +UADSANEX;          /* UNDER THE DATALIST PASSWORD */
         B     @RC00112                                            0114
@RF00112 LR    @10,HEDBPTR                                         0114
         SLR   @09,@09                                             0114
         ICM   @09,7,UADSANEX(DNOBPTR)                             0114
         AR    @10,@09                                             0114
         LR    DNOBPTR,@10                                         0114
*           END;                                                   0115
@RC00112 DS    0H                                                  0115
@DE00094 TM    LOOPFLG,B'00000100'                                 0115
         BZ    @DL00094                                            0115
*         DPOBPTR = DLPWOBAD;         /* REF THE DLPASSWORD OBLK     */
         L     DPOBPTR,DLPWOBAD                                    0116
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE FIRST ACCTNMBR IN 0117
*                                        THIS LOCAL CHAIN            */
         LR    DNOBPTR,HEDBPTR                                     0117
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0117
*ACMERGE: /* THIS SECTION OF CODE WILL MERGE TWO ACCTNMBR CHAINS.    */
*         /* THE MERGE IS MADE NECESSARY BY THE PRUNING OF ONE PASS- */
*         /* WORD TWIN FROM THE TREE.                                */
*         /* FIND THE LAST ACCTNMBR IN THIS LOCAL CHAIN.             */
*         DO WHILE AFLG01 = '0'B;     /* MORE BROTHERS?              */
ACMERGE  B     @DE00118                                            0118
@DL00118 DS    0H                                                  0119
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF THE NEXT ACCTNMBR OBLK */
         LR    @10,HEDBPTR                                         0119
         SLR   @09,@09                                             0119
         ICM   @09,7,UADSANEX(DNOBPTR)                             0119
         AR    @10,@09                                             0119
         LR    DNOBPTR,@10                                         0119
*           END;                                                   0120
@DE00118 TM    AFLG01(DNOBPTR),B'10000000'                         0120
         BZ    @DL00118                                            0120
*         /* CHECK WHETHER THIS IS ALSO THE END OF THE TOTAL CHAIN.  */
*         /* IF IT IS, THEN THIS PROCESS MUST START WITH THE CHAIN   */
*         /* UNDER THE OTHER PASSWORD TWIN.                          */
*         IF UADSANEX = 0             /* END OF TOTAL CHAIN?         */
*           THEN                      /* YES,                        */
         SLR   @10,@10                                             0121
         ICM   @10,7,UADSANEX(DNOBPTR)                             0121
         LTR   @10,@10                                             0121
         BZ    @RT00121                                            0121
*             GOTO ACMERG2;           /* START WITH OTHER TWIN CHAIN */
*         LASTOB = DNOBPTR;           /* SAVE ADDR OF THIS LAST OBLK */
         ST    DNOBPTR,LASTOB                                      0123
*         ACSNOFS = UADSANEX;         /* SAVE OFFSET TO COUSIN       */
         LR    ACSNOFS,@10                                         0124
*         CSNSAVE = ACSNOFS;          /* SAME AS ABOVE,FOR LATER USE */
         ST    ACSNOFS,CSNSAVE                                     0125
*         DPOBPTR = NLPWOBAD;         /* REF THE OTHER TWIN OBLK     */
         LR    DPOBPTR,NLPWOBAD                                    0126
*         SUBOFS = UADSPSUB;          /* SAVE OFFSET TO FIRST ACCT-
*                                        NMBR OBLK                   */
         L     @10,UADSPSUB(,DPOBPTR)                              0127
         ST    @10,SUBOFS                                          0127
*         /* COMPARE COUSIN-OFFSET FROM THE FIRST CHAIN TO THE ABOVE */
*         /* OFFSET. IF THEY ARE EQUAL, THEN THE TWO CHAINS ARE      */
*         /* ADJACENT AND OFFSETS DO NOT HAVE TO BE CHANGED.         */
*         IF ACSNOFS = SUBOFS                                      0128
*           THEN                      /* YES, THEY ARE ADJACENT      */
         CR    ACSNOFS,@10                                         0128
         BNE   @RF00128                                            0128
*             DO;                                                  0129
*               DNOBPTR = LASTOB;     /* REF LAST OBLK UNDER FIRST 0130
*                                        PASSWORD TWIN               */
         L     @10,LASTOB                                          0130
         LR    DNOBPTR,@10                                         0130
*               AFLG01 = '0'B;        /* SET CHAIN FLAG TO 0, CHANGING
*                                        COUSINS TO BROTHERS         */
         NI    AFLG01(DNOBPTR),B'01111111'                         0131
*               GOTO PWPRUNE;         /* GO FREE THE OBLK AND DATAFD */
         B     PWPRUNE                                             0132
*             END;                                                 0133
*ACMERG1: /* THE TWO CHAINS ARE NOT ADJACENT. FIND THE END OF THE    */
*         /* NEXT INTERVENING CHAIN AND CHECK WHETHER IT POINTS TO   */
*         /* THE SECOND TWIN CHAIN.                                  */
*         DNOBPTR = HEDBPTR+ACSNOFS;  /* REF FIRST OBLK OF THE INTER-
*                                        VENING CHAIN                */
@RF00128 DS    0H                                                  0134
ACMERG1  LR    DNOBPTR,HEDBPTR                                     0134
         AR    DNOBPTR,ACSNOFS                                     0134
*         /* FIND THE END OF THIS CHAIN.                             */
*         DO WHILE AFLG01 = '0'B;     /* MORE BROTHERS?              */
         B     @DE00135                                            0135
@DL00135 DS    0H                                                  0136
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF THE NEXT OBLK          */
         LR    @10,HEDBPTR                                         0136
         SLR   @09,@09                                             0136
         ICM   @09,7,UADSANEX(DNOBPTR)                             0136
         AR    @10,@09                                             0136
         LR    DNOBPTR,@10                                         0136
*           END;                                                   0137
@DE00135 TM    AFLG01(DNOBPTR),B'10000000'                         0137
         BZ    @DL00135                                            0137
*         /* END OF THIS CHAIN. IF IT IS ALSO THE END OF THE TOTAL   */
*         /* CHAIN, THEN THE SEARCH MUST BEGIN WITH THE OTHER TWIN   */
*         /* CHAIN.                                                  */
*         IF UADSANEX = 0             /* END OF TOTAL CHAIN?         */
*           THEN                      /* YES,                        */
         SLR   @10,@10                                             0138
         ICM   @10,7,UADSANEX(DNOBPTR)                             0138
         LTR   @10,@10                                             0138
         BZ    @RT00138                                            0138
*             GOTO ACMERG2;           /* GO START WITH OTHER TWIN    */
*         CSNPTR = DNOBPTR;           /* SAVE ADDR OF THIS OBLK      */
         ST    DNOBPTR,CSNPTR                                      0140
*         ACSNOFS = UADSANEX;         /* SAVE OFFSET TO COUSIN       */
         LR    ACSNOFS,@10                                         0141
*         /* COMPARE THE ABOVE OFFSET TO THE OFFSET TO THE TWIN      */
*         /* CHAIN. REPEAT THE PROCESS UNTIL THE TWIN CHAIN IS FOUND */
*         IF ACSNOFS ^= SUBOFS                                     0142
*           THEN                      /* THIS IS NOT THE OFFSET TO 0142
*                                        THE TWIN CHAIN              */
         C     ACSNOFS,SUBOFS                                      0142
         BNE   @RT00142                                            0142
*             GOTO ACMERG1;           /* CONTINUE THE SEARCH         */
*         /* THE TWIN CHAIN HAS BEEN FOUND. START THE MERGE          */
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF FIRST OBLK OF SECOND  0144
*                                        TWIN CHAIN                  */
         LR    DNOBPTR,HEDBPTR                                     0144
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0144
*         /* FIND THE END OF THE SECOND TWIN CHAIN.                  */
*         DO WHILE AFLG01 = '0'B;     /* MORE BROTHERS?              */
         B     @DE00145                                            0145
@DL00145 DS    0H                                                  0146
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF NEXT OBLK              */
         LR    @10,HEDBPTR                                         0146
         SLR   @09,@09                                             0146
         ICM   @09,7,UADSANEX(DNOBPTR)                             0146
         AR    @10,@09                                             0146
         LR    DNOBPTR,@10                                         0146
*           END;                                                   0147
@DE00145 TM    AFLG01(DNOBPTR),B'10000000'                         0147
         BZ    @DL00145                                            0147
*         ANEXSAVE = UADSANEX;        /* SAVE OFFSET TO NEXT CHAIN   */
         SLR   ANEXSAVE,ANEXSAVE                                   0148
         ICM   ANEXSAVE,7,UADSANEX(DNOBPTR)                        0148
*         UADSANEX = CSNSAVE;         /* CONNECT THE INTERVENING   0149
*                                        CHAIN(S) TO THE END OF THE
*                                        SECOND TWIN CHAIN           */
         MVC   UADSANEX(3,DNOBPTR),CSNSAVE+1                       0149
*         DNOBPTR = CSNPTR;           /* REF THE LAST OBLK OF THE  0150
*                                        INTERVENING CHAIN(S)        */
         L     DNOBPTR,CSNPTR                                      0150
*         UADSANEX = ANEXSAVE;        /* CONNECT THE ABOVE OBLK TO THE
*                                        REST OF THE TOTAL CHAIN     */
         STCM  ANEXSAVE,7,UADSANEX(DNOBPTR)                        0151
*         DNOBPTR = LASTOB;           /* REF LAST OBLK IN FIRST TWIN */
         L     DNOBPTR,LASTOB                                      0152
*         UADSANEX = ACSNOFS;         /* CONNECT THE TWO TWIN CHAINS */
         STCM  ACSNOFS,7,UADSANEX(DNOBPTR)                         0153
*         AFLG01 = '0'B;              /* SET CHAIN FLAG TO 0, CHANGING
*                                        COUSINS TO BROTHERS         */
         NI    AFLG01(DNOBPTR),B'01111111'                         0154
*         GOTO PWPRUNE;               /* MERGING IS COMPLETED. GO FREE
*                                        THE PWD OBLK AND DATA FIELD */
         B     PWPRUNE                                             0155
*ACMERG2: /* THE END OF THE TOTAL CHAIN WAS REACHED BEFORE THE       */
*         /* TWIN CHAIN WAS FOUND. RESET APPROPRIATE PTRS AND START  */
*         /* THE MERGE PROCESS WITH THE OTHER TWIN CHAIN.            */
*         DPOBPTR = DLPWOBAD;         /* REF ONE TWIN PWD OBLK       */
ACMERG2  L     @10,DLPWOBAD                                        0156
         LR    DPOBPTR,@10                                         0156
*         SUBOFS = UADSPSUB;          /* SAVE OFFSET TO 1ST ACTNBR   */
         L     @09,UADSPSUB(,DPOBPTR)                              0157
         ST    @09,SUBOFS                                          0157
*         DPOBPTR = NLPWOBAD;         /* REF THE OTHER TWIN OBLK     */
         LR    DPOBPTR,NLPWOBAD                                    0158
*         ACSNOFS = UADSPSUB;         /* SAVE OFFSET TO 1ST ACTNBR   */
         L     ACSNOFS,UADSPSUB(,DPOBPTR)                          0159
*         UADSPSUB = SUBOFS;          /* CONNECT CHAIN OF OTHER TWIN */
         ST    @09,UADSPSUB(,DPOBPTR)                              0160
*         DPOBPTR = DLPWOBAD;         /* REF 1ST TWIN AGAIN          */
         LR    DPOBPTR,@10                                         0161
*         UADSPSUB = ACSNOFS;         /* CONNECT CHAIN OF OTHER TWIN */
         ST    ACSNOFS,UADSPSUB(,DPOBPTR)                          0162
*         DNOBPTR = HEDBPTR+ACSNOFS;  /* REF FIRST ACCTNMBR OBLK     */
         LR    DNOBPTR,HEDBPTR                                     0163
         AR    DNOBPTR,ACSNOFS                                     0163
*         GOTO ACMERGE;               /* GO START THE PROCESS AGAIN  */
         B     ACMERGE                                             0164
*PWPRUNE: /* THIS SECTION OF CODE WILL PRUNE ONE PASSWORD OFFSET     */
*         /* BLOCK AND DATA FIELD FROM THE TREE.                     */
*         DPOBPTR = NLPWOBAD;         /* REF THE OBLK TO BE PRUNED   */
PWPRUNE  LR    DPOBPTR,NLPWOBAD                                    0165
*         PRUNOFS = NLPWOBAD-HEDBPTR; /* RECALCULATE OFFSET TO OBLK
*                                        THAT IS TO BE PRUNED        */
         LR    PRUNOFS,NLPWOBAD                                    0166
         SR    PRUNOFS,HEDBPTR                                     0166
*         CSNSAVE = UADSPNEX;         /* SAVE OFFSET TO BROTHER      */
         SLR   @10,@10                                             0167
         ICM   @10,7,UADSPNEX(DPOBPTR)                             0167
         ST    @10,CSNSAVE                                         0167
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF FIRST OBLK IN PWD CHAIN */
         LR    DPOBPTR,HEDBPTR                                     0168
         A     DPOBPTR,UADSPWD1(,HEDBPTR)                          0168
*         /* CHECK WHETHER THE OBLK TO BE PRUNED IS THE FIRST ONE    */
*         /* IN THE CHAIN.                                           */
*         IF DPOBPTR = NLPWOBAD                                    0169
*           THEN                      /* YES,                        */
         CR    DPOBPTR,NLPWOBAD                                    0169
         BNE   @RF00169                                            0169
*             UADSPWD1 = CSNSAVE;     /* PUT THE OFFSET TO THE BROTHER
*                                        OBLK INTO THE USER HEADER   */
         ST    @10,UADSPWD1(,HEDBPTR)                              0170
*           ELSE                                                   0171
*             DO;                                                  0171
         B     @RC00169                                            0171
@RF00169 DS    0H                                                  0172
*             /* FIND THE BROTHER OBLK WHICH POINTS TO THE OBLK TO BE*/
*             /* PRUNED FROM THE TREE.                               */
*             DO WHILE PRUNOFS ^= UADSPNEX;                        0172
         B     @DE00172                                            0172
@DL00172 DS    0H                                                  0173
*               DPOBPTR = HEDBPTR+UADSPNEX;/* REF THE NEXT PASSWD    */
         LR    @10,HEDBPTR                                         0173
         SLR   @09,@09                                             0173
         ICM   @09,7,UADSPNEX(DPOBPTR)                             0173
         AR    @10,@09                                             0173
         LR    DPOBPTR,@10                                         0173
*               END;                                               0174
@DE00172 SLR   @10,@10                                             0174
         ICM   @10,7,UADSPNEX(DPOBPTR)                             0174
         CR    PRUNOFS,@10                                         0174
         BNE   @DL00172                                            0174
*             /* THE DESIRED BROTHER OBLK HAS BEEN FOUND.            */
*             UADSPNEX = CSNSAVE;     /* PUT THE BROTHER-OFFSET FROM
*                                        THE PRUNED OBLK INTO THIS 0175
*                                        OBLK                        */
         L     @10,CSNSAVE                                         0175
         STCM  @10,7,UADSPNEX(DPOBPTR)                             0175
*             /* IF THE OBLK TO BE PRUNED IS THE LAST ONE IN THE     */
*             /* TOTAL CHAIN, THEN THE CHAIN FLAG IN THE 'NEW' LAST  */
*             /* OBLK MUST BE SET TO 1, INDICATING END OF CHAIN.     */
*             IF CSNSAVE = 0                                       0176
*               THEN                  /* YES, IT IS THE LAST OBLK    */
         LTR   @10,@10                                             0176
         BNZ   @RF00176                                            0176
*                 PFLG01 = '1'B;      /* SET CHAIN FLAG IN NEW LAST
*                                        OBLK TO 1                   */
         OI    PFLG01(DPOBPTR),B'10000000'                         0177
*             END;                                                 0178
@RF00176 DS    0H                                                  0179
*         DPOBPTR = NLPWOBAD;         /* REF THE OBLK TO BE PRUNED   */
@RC00169 LR    DPOBPTR,NLPWOBAD                                    0179
*         AREAOFST = UADSPDAT;        /* OFFSET TO DATA FIELD        */
         L     @10,UADSPDAT(,DPOBPTR)                              0180
         ST    @10,AREAOFST                                        0180
*         AREALNTH = 12;              /* NUMBER OF BYTES TO BE FREED */
         MVC   AREALNTH(2),@CH00055                                0181
*         CALL IKJFRSP;               /* GO FREE THE DATA FIELD      */
         BAL   @14,IKJFRSP                                         0182
*         /* PREPARE TO FREE THE OFFSET BLOCK                        */
*         AREAOFST = PRUNOFS;         /* OFFSET TO THIS OBLOK        */
         ST    PRUNOFS,AREAOFST                                    0183
*         CALL IKJFRSP;               /* GO FREE THE OFFSET BLOCK    */
         BAL   @14,IKJFRSP                                         0184
*         GOTO CHGEOK;                /* GO WRITE THIS TREE BACK INTO
*                                        THE UADS                    */
         B     CHGEOK                                              0185
*PRTWSRCH:/* MERGING OF TWO PROCNAME CHAINS IS NECESSARY BECAUSE     */
*         /* AN ACCTNMBR (ONE OF A PAIR OF TWINS) HAS TO BE PRUNED   */
*         /* FROM THE TREE. THE TWO CHAINS MUST BE COMPARED TO       */
*         /* ASSURE THAT THE MERGE WILL NOT RESULT IN PROC TWINS.    */
*         /* IF IT DOES, THEN ONE OF THE TWINS MUST BE PRUNED FROM   */
*         /* THE TREE.                                               */
*         DNOBPTR = ACTWIN2;          /* REF FIRST ACCTNMBR TWIN     */
PRTWSRCH LR    DNOBPTR,ACTWIN2                                     0186
*         DROBPTR = HEDBPTR+UADSASUB; /* REF ITS FIRST PROCNAME OBLK */
         LR    DROBPTR,HEDBPTR                                     0187
         A     DROBPTR,UADSASUB(,DNOBPTR)                          0187
*PRTWSR1: /* BEGINNING OF THE SEARCH LOOP.                           */
*         RDATSAVE = UADSRDAT;        /* SAVE OFFSET TO DATA FIELD   */
PRTWSR1  L     @07,UADSRDAT(,DROBPTR)                              0188
         ST    @07,RDATSAVE                                        0188
*         UADSRPTR = HEDBPTR+RDATSAVE;/* REF THE DATA FIELD          */
         AR    @07,HEDBPTR                                         0189
         LR    UADSRPTR,@07                                        0189
*         PRCOMP = UADSRNAM;          /* SAVE THIS PROCNAME          */
         MVC   PRCOMP(8),UADSRNAM(UADSRPTR)                        0190
*         PRTWIN1 = DROBPTR;          /* SAVE ADDR OF THIS OBLK      */
         ST    DROBPTR,PRTWIN1                                     0191
*         DNOBPTR = ACTWIN1;          /* REF THE SECOND ACTNBR TWIN  */
         LR    DNOBPTR,ACTWIN1                                     0192
*         /* IT IS POSSIBLE THAT ALL PROCS UNDER THE TWIN HAVE       */
*         /* BEEN PRUNED. IF SO, THEN THE SUB OFFSET WAS SET TO 0.   */
*         IF UADSASUB = 0             /* ANY PROCS LEFT?             */
*           THEN                      /* NO,                         */
         L     @07,UADSASUB(,DNOBPTR)                              0193
         LTR   @07,@07                                             0193
         BZ    @RT00193                                            0193
*             GOTO PRTWSR3;           /* GO CHECK WHERE TO CONTINUE  */
*         DROBPTR = HEDBPTR+UADSASUB; /* REF ITS FIRST PROCNAME OBLK */
         AR    @07,HEDBPTR                                         0195
         LR    DROBPTR,@07                                         0195
*         /* COMPARE THE PROCEDURE NAMES. IF TWO EQUAL NAMES ARE     */
*         /* FOUND, THEN COMPARE THE DATA FIELDS. IF THESE ARE NOT   */
*         /* EQUAL, THEN THE MERGE IS NOT POSSIBLE SINCE IT IS NOT   */
*         /* KNOWN WHICH ATTRIBUTES ARE TO BE KEPT.                  */
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */
         NI    LOOPFLG,B'11111011'                                 0196
*         DO WHILE LOOPFLG = '0'B;    /* LOOP TO END OF ACCTNBR CHAIN*/
         B     @DE00197                                            0197
@DL00197 DS    0H                                                  0198
*           UADSRPTR = HEDBPTR+UADSRDAT;/* REF THIS PROC DATA FIELD  */
         L     @07,UADSRDAT(,DROBPTR)                              0198
         LR    UADSRPTR,HEDBPTR                                    0198
         AR    UADSRPTR,@07                                        0198
*           IF PRCOMP = UADSRNAM      /* ARE THE PROCNAMES EQUAL?    */
*             THEN                    /* YES,                        */
         CLC   PRCOMP(8),UADSRNAM(UADSRPTR)                        0199
         BNE   @RF00199                                            0199
*               /* DO THEY USE THE SAME DATA FIELDS? IF NOT, THEN    */
*               /* THE DATA IS DIFFERENT AND THE MERGE IS IMPOSSIBLE.*/
*               IF RDATSAVE ^= UADSRDAT                            0200
*                 THEN                /* THE DATA IS NOT EQUAL       */
         C     @07,RDATSAVE                                        0200
         BE    @RF00200                                            0200
*                   DO;                                            0201
*                   MSGNMBR = 15;     /* 13- IMPOSSIBLE MERGE        */
         MVI   MSGNMBR(CTRLTABP),X'0F'                             0202
*                   RETURN;           /* CHANGE CP WILL ISSUE THE  0203
*                                        ERROR MSG & CONTINUE WITH 0203
*                                        THE NEXT USERID, IF ANY     */
@EL00001 L     @13,4(,@13)                                         0203
@EF00001 L     @00,@SIZDATD                                        0203
         LR    @01,@11                                             0203
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0203
         BR    @14                                                 0203
*                   END;                                           0204
*                 ELSE                /* THE DATA IS EQUAL           */
*                   DO;                                            0205
@RF00200 DS    0H                                                  0206
*                   PRTWIN2 = DROBPTR;/* SAVE ADDR OF THIS TWIN      */
         ST    DROBPTR,PRTWIN2                                     0206
*                   GOTO PRPRUNE;     /* GO PRUNE ONE TWIN           */
         B     PRPRUNE                                             0207
*                   END;                                           0208
*           /* PROCNAMES ARE NOT EQUAL. CONTINUE THE SEARCH          */
*           IF FLGR01 = '1'B          /* ARE THERE MORE BROTHERS?    */
*             THEN                    /* NO,                         */
@RF00199 TM    FLGR01(DROBPTR),B'10000000'                         0209
         BNO   @RF00209                                            0209
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */
         OI    LOOPFLG,B'00000100'                                 0210
*             ELSE                    /* YES,                        */
*               DROBPTR = HEDBPTR     /* REF THE BROTHER OBLK        */
*                 +UADSRNEX;                                       0211
         B     @RC00209                                            0211
@RF00209 LR    @07,HEDBPTR                                         0211
         SLR   @05,@05                                             0211
         ICM   @05,7,UADSRNEX(DROBPTR)                             0211
         AR    @07,@05                                             0211
         LR    DROBPTR,@07                                         0211
*           END;                                                   0212
@RC00209 DS    0H                                                  0212
@DE00197 TM    LOOPFLG,B'00000100'                                 0212
         BZ    @DL00197                                            0212
*PRTWSR2: /* LABEL FOR RETURN POINT AFTER ONE TWIN HAS BEEN PRUNED.  */
*         DROBPTR = PRTWIN1;          /* REF THE LAST-USED OBLK IN 0213
*                                        THE ACTWIN2 CHAIN           */
PRTWSR2  L     DROBPTR,PRTWIN1                                     0213
*         /* ARE THERE MORE PROCNAMES IN THE ACTWIN2 CHAIN?          */
*         IF FLGR01 = '0'B                                         0214
*           THEN                      /* YES,                        */
         TM    FLGR01(DROBPTR),B'10000000'                         0214
         BNZ   @RF00214                                            0214
*             DO;                                                  0215
*               DROBPTR = HEDBPTR     /* REF THE BROTHER OBLK        */
*                 +UADSRNEX;                                       0216
         LR    @07,HEDBPTR                                         0216
         SLR   @05,@05                                             0216
         ICM   @05,7,UADSRNEX(DROBPTR)                             0216
         AR    @07,@05                                             0216
         LR    DROBPTR,@07                                         0216
*               GOTO PRTWSR1;         /* CONTINUE THE TWIN SEARCH    */
         B     PRTWSR1                                             0217
*             END;                                                 0218
*           ELSE                      /* NO, SEARCH IS COMPLETED,    */
*PRTWSR3:     /* CHECK CONTROL FLAG TO DETERMINE WHERE TO CONTINUE.  */
*             IF ALLACFLG = '1'B                                   0219
*               THEN                                               0219
@RF00214 DS    0H                                                  0219
PRTWSR3  TM    ALLACFLG,B'00100000'                                0219
         BO    @RT00219                                            0219
*                 GOTO CHTWSR2;       /* CONTINUE SEARCH UNDER NEXT 2
*                                        ACCTNMBRS IN A LOCAL CHAIN  */
*               ELSE                                               0221
*                 GOTO PRMERGE;       /* GO MERGE THE TWO PROCNAME 0221
*                                        CHAINS OF ACTWIN1 & ACTWIN2 */
         B     PRMERGE                                             0221
*PRPRUNE: /* THIS SECTION OF CODE WILL PRUNE A PROCEDURE NAME OFF-   */
*         /* SET BLOCK, ONE OF A PAIR OF TWINS, FROM THE TREE. THE   */
*         /* TWINS ARE THE RESULT OF THE MERGE OF TWO PROCNAME       */
*         /* CHAINS UNDER ACCTNMBR TWINS.                            */
*         UADSRPTR = HEDBPTR+UADSRDAT;/* REF ITS DATA FIELD          */
PRPRUNE  LR    UADSRPTR,HEDBPTR                                    0222
         A     UADSRPTR,UADSRDAT(,DROBPTR)                         0222
*         UADSRCTR = UADSRCTR-1;      /* DECREMENT THE USE COUNTER   */
         SLR   @07,@07                                             0223
         IC    @07,UADSRCTR(,UADSRPTR)                             0223
         BCTR  @07,0                                               0223
         STC   @07,UADSRCTR(,UADSRPTR)                             0223
*         RNEXSAVE = UADSRNEX;        /* SAVE OFFSET TO NEXT OBLK    */
         SLR   @07,@07                                             0224
         ICM   @07,7,UADSRNEX(DROBPTR)                             0224
         ST    @07,RNEXSAVE                                        0224
*         /* SAVE THE CHAIN FLAG BEFORE PRUNING THE OFFSET BLOCK     */
*         IF FLGR01 = '0'B            /* CHAIN FLAG = '0'?           */
*           THEN                      /* YES,                        */
         TM    FLGR01(DROBPTR),B'10000000'                         0225
         BNZ   @RF00225                                            0225
*             FLGSAVE = '0'B;         /* SET FLAGSAVE TO '0'         */
         NI    FLGSAVE,B'01111111'                                 0226
*           ELSE                      /* NO,                         */
*             FLGSAVE = '1'B;         /* SET FLAGSAVE TO '1'         */
         B     @RC00225                                            0227
@RF00225 OI    FLGSAVE,B'10000000'                                 0227
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF FIRST PASSWORD OBLK     */
@RC00225 LR    DPOBPTR,HEDBPTR                                     0228
         A     DPOBPTR,UADSPWD1(,HEDBPTR)                          0228
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF FIRST ACCTNMBR OBLK     */
         LR    DNOBPTR,HEDBPTR                                     0229
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0229
*         /* IT IS POSSIBLE THAT NO PROCNAMES ARE LEFT UNDER THE     */
*         /* FIRST ACCTNMBR. FIND THE 1ST ACCTNMBR OFFSET BLOCK IN   */
*         /* WHICH THE SUB OFFSET IS NOT 0.                          */
*         DO WHILE UADSASUB = 0;      /* ALL PROCNAMES PRUNED?       */
         B     @DE00230                                            0230
@DL00230 DS    0H                                                  0231
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF NEXT ACCTNMBR OBLK     */
         LR    @07,HEDBPTR                                         0231
         SLR   @05,@05                                             0231
         ICM   @05,7,UADSANEX(DNOBPTR)                             0231
         AR    @07,@05                                             0231
         LR    DNOBPTR,@07                                         0231
*           END;                                                   0232
@DE00230 L     @07,UADSASUB(,DNOBPTR)                              0232
         LTR   @07,@07                                             0232
         BZ    @DL00230                                            0232
*         DROBPTR = HEDBPTR+UADSASUB; /* REF FIRST PROCNAME OBLK     */
         L     @05,UADSASUB(,DNOBPTR)                              0233
         AR    @05,HEDBPTR                                         0233
         LR    DROBPTR,@05                                         0233
*         PRUNOFS = PRTWIN2-HEDBPTR;  /* RECALCULATE OFFSET TO OBLK
*                                        TO BE PRUNED                */
         L     @05,PRTWIN2                                         0234
         LR    PRUNOFS,@05                                         0234
         SR    PRUNOFS,HEDBPTR                                     0234
*         /* IF THE OFFSET BLOCK TO BE PRUNED IS THE FIRST ONE IN    */
*         /* THE TOTAL CHAIN, NO CHANGES TO OTHER OBLKS ARE NECES-   */
*         /* SARY. IF NOT, THEN THE BROTHER OR COUSIN POINTING TO    */
*         /* THE TWIN TO BE PRUNED MUST BE FOUND.                    */
*         IF DROBPTR = PRTWIN2        /* FIRST OBLK IN TOTAL CHAIN?  */
*           THEN                      /* YES,                        */
         CR    DROBPTR,@05                                         0235
         BE    @RT00235                                            0235
*             GOTO PRPRUN3;           /* GO FREE THIS OBLK           */
*         /* FIND THE OFFSET BLOCK POINTING TO THE TWIN OBLK BY      */
*         /* COMPARING UADSRNEX TO THE KNOWN OFFSET.                 */
*         DO WHILE UADSRNEX ^= PRUNOFS;/* DOES THIS OBLK POINT TO THE
*                                         OBLK TO BE PRUNED?         */
         B     @DE00237                                            0237
@DL00237 DS    0H                                                  0238
*           DROBPTR = HEDBPTR+UADSRNEX;/* REF NEXT OBLK IN THE CHAIN */
         LR    @05,HEDBPTR                                         0238
         SLR   @03,@03                                             0238
         ICM   @03,7,UADSRNEX(DROBPTR)                             0238
         AR    @05,@03                                             0238
         LR    DROBPTR,@05                                         0238
*           END;                                                   0239
@DE00237 SLR   @05,@05                                             0239
         ICM   @05,7,UADSRNEX(DROBPTR)                             0239
         CR    PRUNOFS,@05                                         0239
         BNE   @DL00237                                            0239
*         /* THE ABOVE DESCRIBED OFFSET BLOCK HAS BEEN FOUND. INSERT */
*         /* CHAIN FLAG OF TWIN IF THAT FLAG IS '1', I.E., IF THE    */
*         /* TWIN IS THE LAST OFFSET BLOCK IN ITS LOCAL CHAIN.       */
*         IF FLGSAVE = '1'B                                        0240
*           THEN                      /* YES, LAST IN CHAIN,         */
         TM    FLGSAVE,B'10000000'                                 0240
         BNO   @RF00240                                            0240
*             FLGR01 = '1'B;          /* INSERT FLAG OF TWIN         */
         OI    FLGR01(DROBPTR),B'10000000'                         0241
*         UADSRNEX = RNEXSAVE;        /* INSERT THE OFFSET TO THE  0242
*                                        NEXT OBLK. THIS UNHOOKS THE
*                                        TWIN FROM THE CHAIN         */
@RF00240 MVC   UADSRNEX(3,DROBPTR),RNEXSAVE+1                      0242
*PRPRUN3: /* PRUNE THE TWIN OFFSET BLOCK FROM THE TREE.              */
*         /* IF THE PROC OFFSET BLOCK TO BE PRUNED IS THE ONLY ONE   */
*         /* UNDER ITS ACCTNMBR, THEN SET THE SUB OFFSET IN THE      */
*         /* ACCTNMBR OBLK TO 0 FOR LATER USE.                       */
*         DNOBPTR = ACTWIN1;          /* REF THE ACCTNMBR TWIN       */
PRPRUN3  LR    DNOBPTR,ACTWIN1                                     0243
*         DROBPTR = PRTWIN2;          /* REF THE PROC TO BE PRUNED   */
         L     DROBPTR,PRTWIN2                                     0244
*         /* IS THE PROC TWIN THE 1ST ONE IN ITS CHAIN?              */
*         IF UADSASUB = PRUNOFS                                    0245
*           THEN                      /* YES,                        */
         C     PRUNOFS,UADSASUB(,DNOBPTR)                          0245
         BNE   @RF00245                                            0245
*             /* IF IT IS ALSO THE LAST ONE, THEN IT IS THE ONLY ONE */
*             IF FLGR01 = '1'B                                     0246
*               THEN                  /* IT IS THE ONLY PROC         */
         TM    FLGR01(DROBPTR),B'10000000'                         0246
         BNO   @RF00246                                            0246
*                 UADSASUB = 0;       /* SET SUB OFFSET TO 0         */
         SLR   @05,@05                                             0247
         ST    @05,UADSASUB(,DNOBPTR)                              0247
*               ELSE                  /* NOT THE ONLY ONE,           */
*                 UADSASUB = RNEXSAVE;/* INSERT OFFSET TO BROTHER    */
         B     @RC00246                                            0248
@RF00246 L     @05,RNEXSAVE                                        0248
         ST    @05,UADSASUB(,DNOBPTR)                              0248
*         AREAOFST = PRUNOFS;         /* OFFSET TO OBLK TO BE FREED  */
@RC00246 DS    0H                                                  0249
@RF00245 ST    PRUNOFS,AREAOFST                                    0249
*         AREALNTH = 12;              /* NUMBER OF BYTES TO BE FREED */
         MVC   AREALNTH(2),@CH00055                                0250
*         CALL IKJFRSP;               /* GO FREE THIS OBLK           */
         BAL   @14,IKJFRSP                                         0251
*         GOTO PRTWSR2;               /* CONTINUE THE SEARCH FOR   0252
*                                        PROCNAME TWINS              */
         B     PRTWSR2                                             0252
*PRMERGE: /* THIS SECTION OF CODE WILL MERGE TWO PROCNAME CHAINS.    */
*         /* PROCNAME TWINS, IF ANY WERE FOUND, HAVE BEEN PRUNED.    */
*         /* THE MERGE IS MADE NECESSARY BY THE PRUNING OF ONE       */
*         /* ACCTNMBR TWIN FROM THE TREE.                            */
*         DNOBPTR = ACTWIN1;          /* REF THE TWIN TO BE PRUNED   */
PRMERGE  LR    DNOBPTR,ACTWIN1                                     0253
*         /* IF THERE ARE NO PROCS LEFT UNDER THIS ACCTNMBR TWIN,    */
*         /* THEN MERGING IS UNNECESSARY.                            */
*         IF UADSASUB = 0                                          0254
*           THEN                      /* NO PROCS LEFT               */
         L     @07,UADSASUB(,DNOBPTR)                              0254
         LTR   @07,@07                                             0254
         BZ    @RT00254                                            0254
*             GOTO MRGNEXT;           /* BYPASS THE MERGING SECTION  */
*         DNOBPTR = ACTWIN2;          /* REF THE OTHER ACTNBR TWIN   */
         LR    DNOBPTR,ACTWIN2                                     0256
*         DROBPTR = HEDBPTR+UADSASUB; /* REF ITS FIRST PROC OBLK     */
         LR    DROBPTR,HEDBPTR                                     0257
         A     DROBPTR,UADSASUB(,DNOBPTR)                          0257
*PRMERG1: /* FIND THE LAST OFFSET BLOCK IN THIS LOCAL CHAIN.         */
*         DO WHILE FLGR01 = '0'B;     /* ANY BROTHERS?               */
PRMERG1  B     @DE00258                                            0258
@DL00258 DS    0H                                                  0259
*           DROBPTR = HEDBPTR+UADSRNEX;/* REF THE NEXT BROTHER OBLK  */
         LR    @07,HEDBPTR                                         0259
         SLR   @05,@05                                             0259
         ICM   @05,7,UADSRNEX(DROBPTR)                             0259
         AR    @07,@05                                             0259
         LR    DROBPTR,@07                                         0259
*           END;                                                   0260
@DE00258 TM    FLGR01(DROBPTR),B'10000000'                         0260
         BZ    @DL00258                                            0260
*         /* CHECK WHETHER THIS IS ALSO THE END OF THE TOTAL CHAIN.  */
*         /* IF IT IS, THEN THIS PROCESS MUST START WITH THE CHAIN   */
*         /* UNDER THE OTHER ACCTNMBR TWIN.                          */
*         IF UADSRNEX = 0             /* END OF TOTAL CHAIN?         */
*           THEN                      /* YES,                        */
         SLR   @07,@07                                             0261
         ICM   @07,7,UADSRNEX(DROBPTR)                             0261
         LTR   @07,@07                                             0261
         BZ    @RT00261                                            0261
*             GOTO PRMERG5;           /* START WITH OTHER TWIN CHAIN */
*         LASTOB = DROBPTR;           /* SAVE ADDR OF THIS LAST OBLK */
         ST    DROBPTR,LASTOB                                      0263
*         ACSNOFS = UADSRNEX;         /* SAVE OFFSET TO COUSIN       */
         SLR   @05,@05                                             0264
         ICM   @05,7,UADSRNEX(DROBPTR)                             0264
         LR    ACSNOFS,@05                                         0264
*         CSNSAVE = ACSNOFS;          /* SAME AS ABOVE,FOR LATER USE */
         ST    ACSNOFS,CSNSAVE                                     0265
*         DNOBPTR = ACTWIN1;          /* REF THE OTHER TWIN OBLK     */
         LR    DNOBPTR,ACTWIN1                                     0266
*         SUBOFS = UADSASUB;          /* SAVE OFFSET TO ITS FIRST  0267
*                                        PROCNAME OBLK               */
         L     @05,UADSASUB(,DNOBPTR)                              0267
         ST    @05,SUBOFS                                          0267
*         /* COMPARE COUSIN-OFFSET FROM THE FIRST CHAIN TO THE ABOVE */
*         /* OFFSET. IF THEY ARE EQUAL, THEN THE TWO CHAINS ARE      */
*         /* ADJACENT AND OFFSETS DO NOT HAVE TO BE CHANGED.         */
*         IF ACSNOFS = SUBOFS                                      0268
*           THEN                      /* YES, THEY ARE ADJACENT      */
         CR    ACSNOFS,@05                                         0268
         BNE   @RF00268                                            0268
*             DO;                                                  0269
*               DROBPTR = LASTOB;     /* REF LAST OBLK UNDER FIRST 0270
*                                        ACCTNMBR TWIN               */
         L     @07,LASTOB                                          0270
         LR    DROBPTR,@07                                         0270
*               FLGR01 = '0'B;        /* CHANGE COUSIN TO BROTHER    */
         NI    FLGR01(DROBPTR),B'01111111'                         0271
*               GOTO MRGNEXT;         /* GO CHK WHERE TO CONTINUE    */
         B     MRGNEXT                                             0272
*             END;                                                 0273
*PRMERG2: /* THE TWO CHAINS ARE NOT ADJACENT. FIND THE END OF THE    */
*         /* NEXT INTERVENING CHAIN AND CHECK WHETHER IT POINTS TO   */
*         /* THE SECOND TWIN CHAIN.                                  */
*         DROBPTR = HEDBPTR+ACSNOFS;  /* REF FIRST OBLK OF THE INTER-
*                                        VENING CHAIN                */
@RF00268 DS    0H                                                  0274
PRMERG2  LR    DROBPTR,HEDBPTR                                     0274
         AR    DROBPTR,ACSNOFS                                     0274
*         /* FIND THE END OF THIS CHAIN.                             */
*         DO WHILE FLGR01 = '0'B;     /* ANY BROTHERS?               */
         B     @DE00275                                            0275
@DL00275 DS    0H                                                  0276
*           DROBPTR = HEDBPTR+UADSRNEX;/* REF THE NEXT OBLK          */
         LR    @07,HEDBPTR                                         0276
         SLR   @05,@05                                             0276
         ICM   @05,7,UADSRNEX(DROBPTR)                             0276
         AR    @07,@05                                             0276
         LR    DROBPTR,@07                                         0276
*             END;                                                 0277
@DE00275 TM    FLGR01(DROBPTR),B'10000000'                         0277
         BZ    @DL00275                                            0277
*         /* END OF THIS CHAIN. IF IT IS ALSO THE END OF THE TOTAL   */
*         /* CHAIN, THEN THE SEARCH MUST BEGIN WITH THE OTHER TWIN.  */
*         IF UADSRNEX = 0             /* END OF TOTAL CHAIN?         */
*           THEN                      /* YES,                        */
         SLR   @07,@07                                             0278
         ICM   @07,7,UADSRNEX(DROBPTR)                             0278
         LTR   @07,@07                                             0278
         BZ    @RT00278                                            0278
*             GOTO PRMERG5;           /* GO START WITH OTHER TWIN    */
*         CSNPTR = DROBPTR;           /* SAVE ADDR OF THIS OBLK      */
         ST    DROBPTR,CSNPTR                                      0280
*         ACSNOFS = UADSRNEX;         /* SAVE OFFSET TO COUSIN       */
         SLR   @05,@05                                             0281
         ICM   @05,7,UADSRNEX(DROBPTR)                             0281
         LR    ACSNOFS,@05                                         0281
*         /* COMPARE THE ABOVE OFFSET TO THE OFFSET TO THE TWIN      */
*         /* CHAIN. REPEAT THE PROCESS UNTIL THE TWIN CHAIN IS FOUND */
*         IF ACSNOFS ^= SUBOFS                                     0282
*           THEN                      /* THIS IS NOT THE OFFSET TO 0282
*                                        THE TWIN CHAIN              */
         C     ACSNOFS,SUBOFS                                      0282
         BNE   @RT00282                                            0282
*             GOTO PRMERG2;           /* CONTINUE THE SEARCH         */
*         /* THE TWIN CHAIN HAS BEEN FOUND. START THE MERGE          */
*         DROBPTR = HEDBPTR+UADSASUB; /* REF FIRST OBLK OF SECOND  0284
*                                        TWIN CHAIN                  */
         LR    DROBPTR,HEDBPTR                                     0284
         A     DROBPTR,UADSASUB(,DNOBPTR)                          0284
*         /* FIND THE END OF THE SECOND TWIN CHAIN.                  */
*         DO WHILE FLGR01 = '0'B;     /* ANY BROTHERS?               */
         B     @DE00285                                            0285
@DL00285 DS    0H                                                  0286
*           DROBPTR = HEDBPTR+UADSRNEX;/* REF THE NEXT OBLK          */
         LR    @05,HEDBPTR                                         0286
         SLR   @03,@03                                             0286
         ICM   @03,7,UADSRNEX(DROBPTR)                             0286
         AR    @05,@03                                             0286
         LR    DROBPTR,@05                                         0286
*             END;                                                 0287
@DE00285 TM    FLGR01(DROBPTR),B'10000000'                         0287
         BZ    @DL00285                                            0287
*         RNEXSAVE = UADSRNEX;        /* SAVE OFFSET TO NEXT CHAIN   */
         SLR   @05,@05                                             0288
         ICM   @05,7,UADSRNEX(DROBPTR)                             0288
         ST    @05,RNEXSAVE                                        0288
*         UADSRNEX = CSNSAVE;         /* CONNECT THE INTERVENING   0289
*                                        CHAIN(S) TO THE END OF THE
*                                        SECOND TWIN CHAIN           */
         MVC   UADSRNEX(3,DROBPTR),CSNSAVE+1                       0289
*         DROBPTR = CSNPTR;           /* REF THE LAST OBLK OF THE  0290
*                                        INTERVENING CHAIN(S)        */
         L     DROBPTR,CSNPTR                                      0290
*         UADSRNEX = RNEXSAVE;        /* CONNECT THE ABOVE OBLK TO THE
*                                        REST OF THE TOTAL CHAIN     */
         STCM  @05,7,UADSRNEX(DROBPTR)                             0291
*         DROBPTR = LASTOB;           /* REF FIRST OBLK IN THE FIRST
*                                        TWIN CHAIN                  */
         L     DROBPTR,LASTOB                                      0292
*         UADSRNEX = ACSNOFS;         /* CONNECT THE TWO TWIN CHAINS */
         STCM  ACSNOFS,7,UADSRNEX(DROBPTR)                         0293
*         FLGR01 = '0'B;              /* CHANGE COUSINS TO BROTHERS  */
         NI    FLGR01(DROBPTR),B'01111111'                         0294
*MRGNEXT: /* CHECK CONTROL FLAG TO DETERMINE WHERE TO GO NEXT.       */
*         IF ACPRFLG = '1'B                                        0295
*           THEN                                                   0295
MRGNEXT  TM    ACPRFLG,B'00000001'                                 0295
         BO    @RT00295                                            0295
*             GOTO ACCHGE2;           /* GO MAKE REQUIRED ADJUSTMENTS
*                                        BEFORE PRUNING THE OBLK     */
*         GOTO ACPRUNE;               /* MERGING IS COMPLETED. GO FREE
*                                        ONE ACCTNMBR TWIN           */
         B     ACPRUNE                                             0297
*PRMERG5: /* THE END OF THE TOTAL CHAIN WAS REACHED BEFORE THE       */
*         /* SECOND TWIN CHAIN WAS FOUND. RESET APPROPRIATE PTRS     */
*         /* AND START THE MERGE PROCESS WITH THE OTHER TWIN CHAIN.  */
*         DNOBPTR = ACTWIN2;          /* REF ONE TWIN OBLK           */
PRMERG5  LR    DNOBPTR,ACTWIN2                                     0298
*         SUBOFS = UADSASUB;          /* SAVE OFFSET TO ITS 1ST PROC */
         L     @05,UADSASUB(,DNOBPTR)                              0299
         ST    @05,SUBOFS                                          0299
*         DNOBPTR = ACTWIN1;          /* REF THE OTHER ACTNBR TWIN   */
         LR    DNOBPTR,ACTWIN1                                     0300
*         ACSNOFS = UADSASUB;         /* SAVE OFFSET TO ITS 1ST PROC */
         L     ACSNOFS,UADSASUB(,DNOBPTR)                          0301
*         UADSASUB = SUBOFS;          /* INSERT OFFSET TO OTHER TWIN'S
*                                        FIRST PROC                  */
         ST    @05,UADSASUB(,DNOBPTR)                              0302
*         DNOBPTR = ACTWIN2;          /* REF 1ST TWIN AGAIN          */
         LR    DNOBPTR,ACTWIN2                                     0303
*         UADSASUB = ACSNOFS;         /* INSERT OFFSET TO OTHER TWIN'S
*                                        FIRST PROC                  */
         ST    ACSNOFS,UADSASUB(,DNOBPTR)                          0304
*         DROBPTR = HEDBPTR+ACSNOFS;  /* REF FIRST PROCNAME OBLK     */
         LR    DROBPTR,HEDBPTR                                     0305
         AR    DROBPTR,ACSNOFS                                     0305
*         GOTO PRMERG1;               /* GO START THE PROCESS AGAIN  */
         B     PRMERG1                                             0306
*ACPRUNE: /* THIS SECTION OF CODE WILL PRUNE AN ACCTNMBR OFFSET      */
*         /* BLOCK, ONE OF A PAIR OF TWINS, FROM THE TREE.           */
*         DNOBPTR = ACTWIN1;          /* REF THE TWIN TO BE PRUNED   */
ACPRUNE  LR    DNOBPTR,ACTWIN1                                     0307
*         IF UADSADAT ^= 0            /* ARE ACCT NMBRS SUPPORTED    */
*           THEN                      /* YES,                        */
         L     @07,UADSADAT(,DNOBPTR)                              0308
         LTR   @07,@07                                             0308
         BZ    @RF00308                                            0308
*             DO;                                                  0309
*               UADSAPTR = HEDBPTR+UADSADAT;/* REF ITS DATA FIELD    */
         AR    @07,HEDBPTR                                         0310
         ST    @07,UADSAPTR                                        0310
*               UADSACTR = UADSACTR-1;      /* DECREMENT THE USE CNT */
         SLR   @05,@05                                             0311
         IC    @05,UADSACTR(,@07)                                  0311
         BCTR  @05,0                                               0311
         STC   @05,UADSACTR(,@07)                                  0311
*             END;                                                 0312
*         ANEXSAVE = UADSANEX;        /* SAVE OFFSET TO NEXT OBLK    */
@RF00308 SLR   ANEXSAVE,ANEXSAVE                                   0313
         ICM   ANEXSAVE,7,UADSANEX(DNOBPTR)                        0313
*         /* SAVE THE CHAIN FLAG BEFORE PRUNING THE OFFSET BLOCK     */
*         IF AFLG01 = '0'B            /* CHAIN FLAG = '0'?           */
*           THEN                      /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0314
         BNZ   @RF00314                                            0314
*             FLGSAVE = '0'B;         /* SET FLAGSAVE TO '0'         */
         NI    FLGSAVE,B'01111111'                                 0315
*           ELSE                      /* NO,                         */
*             FLGSAVE = '1'B;         /* SET FLAGSAVE TO '1'         */
         B     @RC00314                                            0316
@RF00314 OI    FLGSAVE,B'10000000'                                 0316
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF FIRST PASSWORD OBLK     */
@RC00314 LR    DPOBPTR,HEDBPTR                                     0317
         A     DPOBPTR,UADSPWD1(,HEDBPTR)                          0317
*         /* IT IS POSSIBLE THAT NO ACCTNMBRS ARE LEFT UNDER THE     */
*         /* FIRST PASSWORD. FIND THE 1ST PASSWORD OFFSET BLOCK IN   */
*         /* WHICH THE SUB OFFSET IS NOT 0.                          */
*         DO WHILE UADSPSUB = 0;      /* ALL ACCTNMBRS PRUNED?       */
         B     @DE00318                                            0318
@DL00318 DS    0H                                                  0319
*           DPOBPTR = HEDBPTR+UADSPNEX;/* REF NEXT PASSWORD OBLK     */
         LR    @07,HEDBPTR                                         0319
         SLR   @03,@03                                             0319
         ICM   @03,7,UADSPNEX(DPOBPTR)                             0319
         AR    @07,@03                                             0319
         LR    DPOBPTR,@07                                         0319
*           END;                                                   0320
@DE00318 L     @07,UADSPSUB(,DPOBPTR)                              0320
         LTR   @07,@07                                             0320
         BZ    @DL00318                                            0320
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF FIRST ACCTNMBR OBLK IN
*                                        THE TOTAL CHAIN             */
         L     @15,UADSPSUB(,DPOBPTR)                              0321
         AR    @15,HEDBPTR                                         0321
         LR    DNOBPTR,@15                                         0321
*         PRUNOFS = ACTWIN1-HEDBPTR;  /* RECALCULATE OFFSET TO OBLK
*                                        TO BE PRUNED                */
         LR    PRUNOFS,ACTWIN1                                     0322
         SR    PRUNOFS,HEDBPTR                                     0322
*         /* IF THE OFFSET BLOCK TO BE PRUNED IS THE FIRST ONE IN    */
*         /* THE TOTAL CHAIN, NO CHANGES TO OTHER OBLKS ARE NECES-   */
*         /* SARY. IF NOT, THEN THE BROTHER OR COUSIN POINTING TO    */
*         /* THE TWIN TO BE PRUNED MUST BE FOUND.                    */
*         IF DNOBPTR = ACTWIN1        /* FIRST IN TOTAL CHAIN?       */
*           THEN                      /* YES,                        */
         CR    DNOBPTR,ACTWIN1                                     0323
         BE    @RT00323                                            0323
*             GOTO ACPRUN3;           /* GO FREE THIS OBLK           */
*         /* FIND THE OFFSET BLOCK POINTING TO THE TWIN OFFSET BLOCK */
*         /* BY COMPARING UADSANEX TO THE KNOWN OFFSET.              */
*         DO WHILE UADSANEX ^= PRUNOFS;/* DOES THIS OBLK POINT TO THE
*                                         OBLK TO BE PRUNED?         */
         B     @DE00325                                            0325
@DL00325 DS    0H                                                  0326
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF NEXT OBLK IN THE CHAIN */
         LR    @05,HEDBPTR                                         0326
         SLR   @15,@15                                             0326
         ICM   @15,7,UADSANEX(DNOBPTR)                             0326
         AR    @05,@15                                             0326
         LR    DNOBPTR,@05                                         0326
*           END;                                                   0327
@DE00325 SLR   @05,@05                                             0327
         ICM   @05,7,UADSANEX(DNOBPTR)                             0327
         CR    PRUNOFS,@05                                         0327
         BNE   @DL00325                                            0327
*         /* THE ABOVE DESCRIBED OFFSET BLOCK HAS BEEN FOUND.        */
*         /* INSERT THE CHAIN FLAG OF THE OFFSET BLOCK TO BE PRUNED  */
*         /* IF THAT FLAG WAS '1'.                                   */
*         IF FLGSAVE = '1'B                                        0328
*           THEN                                                   0328
         TM    FLGSAVE,B'10000000'                                 0328
         BNO   @RF00328                                            0328
*             AFLG01 = '1'B;          /* CHANGE FLAG OF BROTHER TO 1 */
         OI    AFLG01(DNOBPTR),B'10000000'                         0329
*         UADSANEX = ANEXSAVE;        /* INSERT THE OFFSET TO THE  0330
*                                        NEXT OBLK. THIS UNHOOKS THE
*                                        TWIN FROM THE CHAIN         */
@RF00328 STCM  ANEXSAVE,7,UADSANEX(DNOBPTR)                        0330
*         ACTWIN3 = DNOBPTR;          /* SAVE THE ADDR OF THIS OBLK  */
         ST    DNOBPTR,ACTWIN3                                     0331
*ACPRUN3: /* PRUNE THE TWIN OFFSET BLOCK FROM THE TREE.              */
*         /* IF THE ACTNO OFFSET BLOCK TO BE PRUNED IS THE ONLY ONE  */
*         /* UNDER ITS PASSWORD, THEN SET THE SUB OFFSET IN THE      */
*         /* PASSWORD OBLK TO 0 FOR LATER USE.                       */
*         DPOBPTR = NLPWOBAD;         /* REF THE NODELST PASSWRD     */
ACPRUN3  LR    DPOBPTR,NLPWOBAD                                    0332
*         DNOBPTR = ACTWIN1;          /* REF THE ACCTNMBR TWIN       */
         LR    DNOBPTR,ACTWIN1                                     0333
*         /* IS THE ACTNO TWIN THE 1ST ONE IN ITS CHAIN?             */
*         IF UADSPSUB = PRUNOFS                                    0334
*           THEN                      /* YES,                        */
         C     PRUNOFS,UADSPSUB(,DPOBPTR)                          0334
         BNE   @RF00334                                            0334
*             /* IF IT IS ALSO THE LAST ONE, THEN IT IS THE ONLY ONE */
*             IF AFLG01 = '1'B                                     0335
*               THEN                  /* IT IS THE ONLY ACTNO        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0335
         BNO   @RF00335                                            0335
*                 UADSPSUB = 0;       /* SET SUB OFFSET TO 0         */
         SLR   @10,@10                                             0336
         ST    @10,UADSPSUB(,DPOBPTR)                              0336
*               ELSE                  /* NOT THE ONLY ONE,           */
*                 UADSPSUB = ANEXSAVE;/* INSERT OFFSET TO BROTHER    */
         B     @RC00335                                            0337
@RF00335 ST    ANEXSAVE,UADSPSUB(,DPOBPTR)                         0337
*         AREAOFST = PRUNOFS;         /* OFFSET TO OBLK TO BE FREED  */
@RC00335 DS    0H                                                  0338
@RF00334 ST    PRUNOFS,AREAOFST                                    0338
*         AREALNTH = 12;              /* NUMBER OF BYTES TO BE FREED */
         MVC   AREALNTH(2),@CH00055                                0339
*         CALL IKJFRSP;               /* GO FREE THIS OBLK           */
         BAL   @14,IKJFRSP                                         0340
*         /* FREESPACE WAS SUCCESSFUL. CHECK CONTROL FLAG TO DETER-  */
*         /* MINE WHERE TO CONTINUE.                                 */
*         IF ACPRFLG = '1'B                                        0341
*           THEN                                                   0341
         TM    ACPRFLG,B'00000001'                                 0341
         BO    @RT00341                                            0341
*             GOTO CHKACDF;           /* GO PROCESS THE ACCTNMBR DATA-
*                                        FIELD ASSOCIATED WITH THE 0342
*                                        PRUNED OFFSET BLOCK         */
*         IF ACTWSRF = '1'B                                        0343
*           THEN                                                   0343
         TM    ACTWSRF,B'00010000'                                 0343
         BNO   @RF00343                                            0343
*             DO;                     /* CONTINUE THE SEARCH FOR   0344
*                                        ACCTNMBR TWINS              */
*             DPOBPTR = NLPWOBAD;     /* REF THE NODELIST PASSWORD   */
         LR    DPOBPTR,NLPWOBAD                                    0345
*             /* IT IS POSSIBLE THAT THERE ARE NO ACCTNMBRS LEFT     */
*             /* UNDER THIS PASSWORD. IF SO, NO MERGING IS NECESSARY.*/
*             IF UADSPSUB = 0         /* ANY ACTNBRS LEFT?           */
*               THEN                  /* NO,                         */
         L     @10,UADSPSUB(,DPOBPTR)                              0346
         LTR   @10,@10                                             0346
         BZ    @RT00346                                            0346
*                 GOTO PWPRUNE;       /* GO PRUNE THE NODELST PWD    */
*               ELSE                  /* YES,                        */
*                 GOTO ACTWSR1;       /* CONTINUE SEARCH FOR TWINS   */
         B     ACTWSR1                                             0348
*             END;                                                 0349
*         DNOBPTR = ACTWIN3;          /* REF THE PREVIOUS ACCTNMBR   */
@RF00343 L     DNOBPTR,ACTWIN3                                     0350
*         GOTO TCTWSR2;               /* CONTINUE THE TWIN SEARCH    */
         B     TCTWSR2                                             0351
*ACLEVL:  /***********************************************************/
*         /*                                                         */
*         /*          CHANGE LEVEL  =  ACCTNMBR LEVEL                */
*         /*                                                         */
*         /***********************************************************/
*         /* AN '*' IN THE ACCTNMBR POSITION OF THE NODELIST MEANS:  */
*         /* CHANGE ALL ACCTNMBRS TO THE NEW ACCTNMBR. THIS CASE     */
*         /* WILL BE HANDLED BY A SEPARATE SECTION OF CODE.          */
*         IF ACCTNO(1:2) = '* '       /* NLACCTNMBR = '*'?           */
*           THEN                      /* YES,                        */
ACLEVL   L     @10,NODELPTR(,CTRLTABP)                             0352
         CLC   ACCTNO(2,@10),@CC00240                              0352
         BE    @RT00352                                            0352
*             GOTO CHALLAC;           /* GO TO SPECIAL SECTION TO  0353
*                                        HANDLE THIS CASE            */
*         DPOBPTR = PASSADDR;         /* GET PTR TO PASSWRD OBLK FROM
*                                        THE CHANGE CONTROL TABLE    */
         L     DPOBPTR,PASSADDR(,CTRLTABP)                         0354
*         NLPWOBAD = DPOBPTR;         /* SAVE ADDR OF THIS OBLK      */
         LR    NLPWOBAD,DPOBPTR                                    0355
*         OACSAVE = ACCTADDR;         /* GET PTR TO ACCTNBR OBLK FROM
*                                        THE CHANGE CONTROL TABLE    */
         L     @10,ACCTADDR(,CTRLTABP)                             0356
         ST    @10,OACSAVE                                         0356
*         /* SEARCH FOR THE ACCTNMBR SPECIFIED IN THE DATALIST.      */
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF 1ST ACCTNMBR OBLK IN  0357
*                                        THE LOCAL CHAIN             */
         LR    DNOBPTR,HEDBPTR                                     0357
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0357
*         CALL DLACLS;                /* GO TO SEARCH RTNE           */
         BAL   @14,DLACLS                                          0358
*         /* DOES THE NEW ACCTNMBR EXIST IN THE LOCAL CHAIN?         */
*         IF ACTWIN2 ^= 0                                          0359
*           THEN                      /* YES, PRUNING IS NECESSARY   */
         LTR   ACTWIN2,ACTWIN2                                     0359
         BZ    @RF00359                                            0359
*             DO;                                                  0360
*               ACTWIN1 = OACSAVE;    /* SET PTR TO TWIN OBLK        */
         L     ACTWIN1,OACSAVE                                     0361
*               ACPRFLG = '1'B;       /* FLAG WILL DETERMINE ACTION
*                                        AFTER PROC TWIN PRUNING     */
         OI    ACPRFLG,B'00000001'                                 0362
*               GOTO PRTWSRCH;         /* GO SEARCH FOR PROCTWINS     *
         B     PRTWSRCH                                            0363
*             END;                                                 0364
*         CALL DLACTS;                /* GO SEARCH THE TOTAL CHAIN   */
@RF00359 BAL   @14,DLACTS                                          0365
*         /* DOES THE NEW ACCTNMBR EXIST IN THE TOTAL CHAIN?         */
*         IF CSNPTR ^= 0                                           0366
*           THEN                      /* YES,                        */
         L     @10,CSNPTR                                          0366
         LTR   @10,@10                                             0366
         BNZ   @RT00366                                            0366
*             GOTO ACCHGE1;           /* GO MAKE APPROPRIATE CHANGES */
*         /* DETERMINE WHETHER THE EXISTING NODELIST DATA FIELD CAN  */
*         /* BE USED (USE CTR = 1). IF NOT, THEN A NEW DATA FIELD    */
*         /* MUST BE CREATED.                                        */
*         DNOBPTR = OACSAVE;          /* REF THE NLACCTNMBR OBLK     */
         L     DNOBPTR,OACSAVE                                     0368
*         UADSAPTR = HEDBPTR+UADSADAT;/* REF ITS DATAFLD             */
         LR    @10,HEDBPTR                                         0369
         A     @10,UADSADAT(,DNOBPTR)                              0369
         ST    @10,UADSAPTR                                        0369
*         /* CHECK THE USE CTR. IF THE FIELD IS SHARED BY COUSINS,   */
*         /* THEN IT CANNOT BE USED.                                 */
*         IF UADSACTR > 1                                          0370
*           THEN                      /* THE DATAFLD IS SHARED       */
         CLI   UADSACTR(@10),1                                     0370
         BNH   @RF00370                                            0370
*             DO;                                                  0371
*               UADSACTR = UADSACTR-1;/* DECREMENT THE USE CTR       */
         SLR   @09,@09                                             0372
         IC    @09,UADSACTR(,@10)                                  0372
         BCTR  @09,0                                               0372
         STC   @09,UADSACTR(,@10)                                  0372
*               GOTO NEWACDF;         /* GO BUILD A NEW DATAFLD      */
         B     NEWACDF                                             0373
*             END;                                                 0374
*         /* THE FIELD IS NOT SHARED. IT WILL BE USED IF THE NEW     */
*         /* ACCTNMBR HAS THE SAME LENGTH AS THE OLD ONE. IF IT DOES */
*         /* NOT, THEN THE EXISTING FIELD WILL BE FREED AND A NEW    */
*         /* FIELD WILL BE BUILT.                                    */
*         IF UADSALEN ^= DACTLEN                                   0375
*           THEN                      /* THE LENGTHS ARE DIFFERENT   */
@RF00370 L     @10,DATALPTR(,CTRLTABP)                             0375
         L     @09,UADSAPTR                                        0375
         CLC   UADSALEN(1,@09),DACTLEN(@10)                        0375
         BE    @RF00375                                            0375
*             DO;                                                  0376
*               ADATSAVE = UADSADAT;  /* SAVE OFFSET TO OLD DATAFLD  */
         L     @10,UADSADAT(,DNOBPTR)                              0377
         ST    @10,ADATSAVE                                        0377
*               FLDFLG = '1'B;        /* SET FLAG: OLD DATAFLD HAS 0378
*                                        TO BE FREED                 */
         OI    FLDFLG,B'01000000'                                  0378
*               GOTO NEWACDF;         /* GO BUILD A NEW DATAFLD AND
*                                        FREE THE EXISTING ONE       */
         B     NEWACDF                                             0379
*             END;                                                 0380
*         /* THE EXISTING FIELD CAN BE USED.                         */
*         UADSANUM(1:DACTLEN) =       /* INSERT THE NEW ACCTNMBR     */
*           DACCTNO;                                               0381
@RF00375 L     @10,UADSAPTR                                        0381
         L     @09,DATALPTR(,CTRLTABP)                             0381
         SLR   @07,@07                                             0381
         IC    @07,DACTLEN(,@09)                                   0381
         BCTR  @07,0                                               0381
         EX    @07,@SM00304                                        0381
*ACNEXT:  /* AT LEAST ONE ACCTNMBR HAS NOW BEEN PROCESSED AND THIS   */
*         /* USERID TREE HAS BEEN CHANGED (THE WORK COPY). DETERMINE */
*         /* WHERE PROCESSING IS TO CONTINUE.                        */
*         DPOBPTR = NLPWOBAD;         /* REF PASSWD JUST PROCESSED   */
ACNEXT   LR    DPOBPTR,NLPWOBAD                                    0382
*         /* IF A PASSWORD WAS SPECIFIED, OR THERE ARE NO MORE PASS- */
*         /* WORDS IN THE CHAIN, THEN ALL NECESSARY CHANGES HAVE     */
*         /* BEEN MADE TO THIS TREE. OTHERWISE, IKJEFA20 WILL SEARCH */
*         /* FOR THE SPECIFIED ACCTNMBR IN THE REMAINING BRANCHES    */
*         /* OF THIS TREE.                                           */
*         IF PASSWD(1) ^= '*'         /* PASSWORD SPECIFIED?         */
*           PFLG01 = '1'B            /* OR END OF CHAIN?            */
*           THEN                      /* YES, ONE OF THE ABOVE,      */
         L     @10,NODELPTR(,CTRLTABP)                             0383
         CLI   PASSWD(@10),C'*'                                    0383
         BNE   @RT00383                                            0383
         TM    PFLG01(DPOBPTR),B'10000000'                         0383
         BO    @RT00383                                            0383
*             GOTO CHGEOK;            /* CHANGE CP WILL WRITE THIS 0384
*                                        TREE BACK INTO THE UADS     */
*         PASSADDR = HEDBPTR          /* REF THE NEXT PASSWORD OBLK  */
*           +UADSPNEX;                                             0385
         LR    @10,HEDBPTR                                         0385
         SLR   @07,@07                                             0385
         ICM   @07,7,UADSPNEX(DPOBPTR)                             0385
         AR    @10,@07                                             0385
         ST    @10,PASSADDR(,CTRLTABP)                             0385
*         SRCHIND = 1;                /* SEARCH FOR THE NODELIST ACCT-
*                                        NMBR UNDER THE NEXT PASSWRD */
         MVI   SRCHIND(CTRLTABP),X'01'                             0386
*         TRCHGE = '1'B;              /* THIS TREE HAS BEEN CHANGED  */
         OI    TRCHGE(CTRLTABP),B'10000000'                        0387
*         RETURN;                     /* RETURN TO THE CHANGE CP     */
         B     @EL00001                                            0388
*NEWACDF: /* THIS SECTION OF CODE WILL CREATE A NEW ACCTNMBR DATAFLD */
*         AREALNTH = 45+DACTLEN;      /* NUMBER OF BYTES NECESSARY:
*                                        CONSTANT AREA + LENGTH OF 0389
*                                        THE NEW ACCTNMBR            */
NEWACDF  L     @10,DATALPTR(,CTRLTABP)                             0389
         LA    @09,45                                              0389
         SLR   @07,@07                                             0389
         IC    @07,DACTLEN(,@10)                                   0389
         AR    @09,@07                                             0389
         STH   @09,AREALNTH                                        0389
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REG      */
*         R1 = ADDR(GETFREE);         /* PTR TO GETSPACE PARMLIST    */
         LA    R1,GETFREE                                          0391
*         CALL IKJEFA53;              /* CALL THE GETSPACE ROUTINE   */
         L     @15,@CV00107                                        0392
         BALR  @14,@15                                             0392
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */
*         RETCODE = R15;              /* ASSIGN THE RETURN CODE      */
         ST    R15,RETCODE(,CTRLTABP)                              0395
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */
*         /* CHECK THE RETURN CODE FROM GETSPACE.                    */
*         IF RETCODE ^= 0                                          0397
*           THEN                      /* GETSPACE UNSUCCESSFUL       */
         L     @10,RETCODE(,CTRLTABP)                              0397
         LTR   @10,@10                                             0397
         BZ    @RF00397                                            0397
*             DO;                                                  0398
*               MSGNMBR = 23;         /* SET ERROR MSG NUMBER        */
         MVI   MSGNMBR(CTRLTABP),X'17'                             0399
*               RETURN;               /* CHANGE CP WILL ISSUE THE  0400
*                                        ERROR MSG & CONTINUE WITH 0400
*                                        THE NEXT USERID, IF ANY     */
         B     @EL00001                                            0400
*             END;                                                 0401
*         NEWDFPTR = HEDBPTR+AREAOFST;/* ADDR OF THE NEW DATAFLD     */
@RF00397 L     @10,AREAOFST                                        0402
         LR    NEWDFPTR,HEDBPTR                                    0402
         AR    NEWDFPTR,@10                                        0402
*         NEWDFPTR -> DNOBD(1:45) =   /* COPY THE EXISTING DATA, EX- */
*           UADSAPTR -> DNOBD(1:45);  /* CLUDING THE ACCTNMBR, INTO
*                                        THE NEW DATAFLD             */
         L     @09,UADSAPTR                                        0403
         MVC   DNOBD(45,NEWDFPTR),DNOBD(@09)                       0403
*         UADSADAT = AREAOFST;        /* PUT OFFSET TO NEW DATAFLD 0404
*                                        INTO THE OFFSET BLOCK       */
         ST    @10,UADSADAT(,DNOBPTR)                              0404
*         UADSAPTR = NEWDFPTR;        /* REF THE NEW DATAFLD         */
         ST    NEWDFPTR,UADSAPTR                                   0405
*         UADSACTR = 1;               /* SET USE CTR TO 1            */
         L     @10,UADSAPTR                                        0406
         MVI   UADSACTR(@10),X'01'                                 0406
*         UADSALEN = DACTLEN;         /* INSERT NEW LENGTH           */
         L     @09,DATALPTR(,CTRLTABP)                             0407
         SLR   @07,@07                                             0407
         IC    @07,DACTLEN(,@09)                                   0407
         STC   @07,UADSALEN(,@10)                                  0407
*         UADSANUM(1:DACTLEN) =       /* INSERT NEW ACCTNMBR         */
*           DACCTNO;                                               0408
         BCTR  @07,0                                               0408
         EX    @07,@SM00304                                        0408
*         /* CHECK CONTROL FLAG TO DETERMINE WHERE TO CONTINUE.      */
*         IF NACDFLG = '1'B                                        0409
*           THEN                                                   0409
         TM    NACDFLG,B'00001000'                                 0409
         BO    @RT00409                                            0409
*             GOTO NACNF2;            /* GO TO INDICATED SECTION     */
*         /* CHECK WHETHER THE OLD DATA FIELD HAS TO BE FREED.       */
*         IF FLDFLG = '0'B                                         0411
*           THEN                      /* NO,                         */
         TM    FLDFLG,B'01000000'                                  0411
         BZ    @RT00411                                            0411
*             GOTO ACNEXT;            /* GO CHECK WHERE PROCESSING 0412
*                                        IS TO CONTINUE              */
*         UADSAPTR = HEDBPTR+ADATSAVE;/* REF THE OLD DATAFLD         */
         LR    @10,HEDBPTR                                         0413
         A     @10,ADATSAVE                                        0413
         ST    @10,UADSAPTR                                        0413
*FREACDF: /* THIS SECTION WILL PRUNE AN ACCTNMBR DATA FIELD FROM     */
*         /* THE USERID TREE.                                        */
*         AREALNTH = 45+UADSALEN;     /* NUMBER OF BYTES TO BE FREED */
FREACDF  LA    @10,45                                              0414
         L     @09,UADSAPTR                                        0414
         SLR   @07,@07                                             0414
         IC    @07,UADSALEN(,@09)                                  0414
         AR    @10,@07                                             0414
         STH   @10,AREALNTH                                        0414
*         AREAOFST = ADATSAVE;        /* OFFSET TO FIELD TO BE FREED */
         L     @10,ADATSAVE                                        0415
         ST    @10,AREAOFST                                        0415
*         CALL IKJFRSP;               /* GO FREE THIS DATA FIELD     */
         BAL   @14,IKJFRSP                                         0416
*         FLDFLG = '0'B;              /* SET CONTROL FLAG BACK TO 0  */
         NI    FLDFLG,B'10111111'                                  0417
*         GOTO ACNEXT;                /* GO CHECK WHERE PROCESSING 0418
*                                        IS TO CONTINUE              */
         B     ACNEXT                                              0418
*ACCHGE1: /* THE NEW ACCTNMBR ALREADY EXISTS IN A COUSIN CHAIN OF    */
*         /* THIS TREE. THE COUSIN DATA FIELD WILL BE USED AND THE   */
*         /* NODELIST ACCTNMBR DATA FIELD WILL BE FREED IF IT IS     */
*         /* NOT SHARED (USE CTR = 1).                               */
*         UADSAPTR = NDFPTR;          /* REF THE COUSIN DATAFLD      */
ACCHGE1  L     @10,NDFPTR                                          0419
         ST    @10,UADSAPTR                                        0419
*         /* CHECK THE USE COUNTER BEFORE INCREMENTING IT. IT CANNOT */
*         /* EXCEED 255.                                             */
*         IF UADSACTR = 255                                        0420
*           THEN                      /* CTR LIMIT HAS BEEN REACHED  */
         CLI   UADSACTR(@10),255                                   0420
         BNE   @RF00420                                            0420
*             DO;                                                  0421
*               MSGNMBR = 30;         /* SET MSG NO FOR IKJEFA20     */
         MVI   MSGNMBR(CTRLTABP),X'1E'                             0422
*               GOTO WORKEND;         /* GO RETURN                   */
         B     WORKEND                                             0423
*             END;                                                 0424
*         UADSACTR = UADSACTR+1;      /* INCREMENT THE USE CTR       */
@RF00420 L     @10,UADSAPTR                                        0425
         LA    @09,1                                               0425
         SLR   @07,@07                                             0425
         IC    @07,UADSACTR(,@10)                                  0425
         AR    @09,@07                                             0425
         STC   @09,UADSACTR(,@10)                                  0425
*         DNOBPTR = OACSAVE;          /* REF THE NODELIST ACTNO OBLK */
         L     DNOBPTR,OACSAVE                                     0426
*         ADATSAVE = UADSADAT;        /* SAVE OFFSET TO ITS DATAFLD  */
         L     @10,UADSADAT(,DNOBPTR)                              0427
         ST    @10,ADATSAVE                                        0427
*         UADSADAT = RDATSAVE;        /* PUT OFFSET TO COUSIN DATAFLD
*                                        INTO THIS OFFSET BLOCK      */
         L     @09,RDATSAVE                                        0428
         ST    @09,UADSADAT(,DNOBPTR)                              0428
*         UADSAPTR = HEDBPTR+ADATSAVE;/* REF NODELIST ACTNO DATAFLD  */
         AR    @10,HEDBPTR                                         0429
         ST    @10,UADSAPTR                                        0429
*         /* IF THE NODELIST ACCTNMBR DATA FIELD IS NOT SHARED, IT   */
*         /* WILL BE PRUNED FROM THIS USERID TREE.                   */
*         IF UADSACTR = 1                                          0430
*           THEN                      /* THIS DATAFLD IS NOT SHARED  */
         CLI   UADSACTR(@10),1                                     0430
         BE    @RT00430                                            0430
*             GOTO FREACDF;           /* GO PRUNE IT FROM THE TREE   */
*         UADSACTR = UADSACTR-1;      /* DECREMENT ITS USE CTR       */
         SLR   @09,@09                                             0432
         IC    @09,UADSACTR(,@10)                                  0432
         BCTR  @09,0                                               0432
         STC   @09,UADSACTR(,@10)                                  0432
*         GOTO ACNEXT;                /* GO CHECK WHERE PROCESSING 0433
*                                        IS TO CONTINUE              */
         B     ACNEXT                                              0433
*ACCHGE2: /* THE NEW ACCTNMBR ALREADY EXISTS IN THE SAME LOCAL CHAIN */
*         /* AS THE NODELIST ACCTNMBR. THE LATTER'S OFFSET BLOCK     */
*         /* WILL BE PRUNED FROM THE TREE. ITS DATA FIELD WILL ALSO  */
*         /* BE FREED IF IT IS NOT SHARED. THE TWO PROCNAME CHAINS   */
*         /* HAVE BEEN MERGED AND PROCNAME TWINS, IF ANY WERE FOUND, */
*         /* HAVE BEEN PRUNED.                                       */
*         DNOBPTR = OACSAVE;          /* REF THE NODELIST ACTNO OBLK */
ACCHGE2  L     DNOBPTR,OACSAVE                                     0434
*         ADATSAVE = UADSADAT;        /* SAVE OFFSET TO ITS DATAFLD  */
         L     @07,UADSADAT(,DNOBPTR)                              0435
         ST    @07,ADATSAVE                                        0435
*         GOTO ACPRUNE;               /* GO TO PRUNING SECTION       */
         B     ACPRUNE                                             0436
*CHKACDF: /* AFTER PRUNING THE NODELIST ACCTNMBR OFFSET BLOCK,       */
*         /* CHECK ITS DATA FIELD. IF IT IS NOT SHARED (USE CTR = 1) */
*         /* IT WILL ALSO BE FREED.                                  */
*         UADSAPTR = HEDBPTR+ADATSAVE;/* REF NODELIST ACTNO DATAFLD  */
CHKACDF  LR    @10,HEDBPTR                                         0437
         A     @10,ADATSAVE                                        0437
         ST    @10,UADSAPTR                                        0437
*         UADSACTR = UADSACTR+1;      /* RESET USE CTR. IT WAS DECRE-
*                                        MENTED IN THE COMMON ACCTNMBR
*                                        OBLK PRUNING SECTION        */
         LA    @09,1                                               0438
         SLR   @07,@07                                             0438
         IC    @07,UADSACTR(,@10)                                  0438
         AR    @09,@07                                             0438
         STC   @09,UADSACTR(,@10)                                  0438
*         ACPRFLG = '0'B;             /* RESET THIS CONTROL FLAG     */
         NI    ACPRFLG,B'11111110'                                 0439
*         /* IS THIS DATA FIELD SHARED WITH COUSINS?                 */
*         IF UADSACTR > 1                                          0440
*           THEN                      /* IT IS SHARED,               */
         CLI   UADSACTR(@10),1                                     0440
         BNH   @RF00440                                            0440
*             UADSACTR = UADSACTR-1;  /* DECREMENT ITS USE CTR       */
         BCTR  @09,0                                               0441
         STC   @09,UADSACTR(,@10)                                  0441
*           ELSE                      /* IT IS NOT SHARED,           */
*             GOTO FREACDF;           /* GO PRUNE IT FROM THE TREE   */
*         GOTO ACNEXT;                /* GO CHECK WHERE PROCESSING 0443
*                                        IS TO CONTINUE              */
         B     ACNEXT                                              0443
*CHALLAC: /* THIS SECTION OF CODE WILL CHANGE ALL ACCTNMBRS IN A     */
*         /* LOCAL ACCTNMBR CHAIN TO THE NEW ACCTNMBR SPECIFIED IN   */
*         /* THE DATA SUBFIELD OF THE COMMAND. ALL UNNECESSARY DATA  */
*         /* FIELDS & OFFSET BLOCKS WILL BE PRUNED FROM THE TREE.    */
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF 1ST OBLK IN LOC CHAIN   */
CHALLAC  LR    DNOBPTR,HEDBPTR                                     0444
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0444
*         OACSAVE = DNOBPTR;          /* SAVE ADDR OF THIS OBLK      */
         ST    DNOBPTR,OACSAVE                                     0445
*         ODFPTR = HEDBPTR+UADSADAT;  /* SAVE ADDR OF ITS DATAFLD    */
         LR    @10,HEDBPTR                                         0446
         A     @10,UADSADAT(,DNOBPTR)                              0446
         ST    @10,ODFPTR                                          0446
*         /* IS THIS THE ONLY ACCTNMBR IN THIS CHAIN? IF IT IS, THEN */
*         /* MERGING OF PROCNAME CHAINS IS NOT NECESSARY.            */
*         IF AFLG01 = '0'B                                         0447
*           THEN                      /* NO, THERE ARE BROTHERS      */
         TM    AFLG01(DNOBPTR),B'10000000'                         0447
         BZ    @RT00447                                            0447
*             GOTO CHTWSR1;           /* GO SEARCH FOR PROC TWINS    */
*NACLS:   /* IF THE NEW ACCTNMBR EXISTS IN THIS CHAIN, THEN ITS      */
*         /* DATA FIELD MUST BE USED.                                */
*         RDATSAVE = UADSADAT;        /* SAVE ADDR OF 1ST DATAFLD    */
NACLS    L     @10,UADSADAT(,DNOBPTR)                              0449
         ST    @10,RDATSAVE                                        0449
*         CALL DLACLS;                /* GO TO SEARCH SUBRTNE        */
         BAL   @14,DLACLS                                          0450
*         /* DOES THE NEW ACCTNMBR EXIST IN THIS CHAIN? IF NOT, THEN */
*         /* SEARCH THE TOTAL CHAIN. A COUSIN DATA FIELD MUST BE     */
*         /* USED IF IT EXISTS.                                      */
*         IF ACTWIN2 = 0                                           0451
*           THEN                      /* NO, IT WAS NOT FOUND,       */
         LTR   ACTWIN2,ACTWIN2                                     0451
         BZ    @RT00451                                            0451
*             GOTO NACTS;             /* GO SEARCH THE TOTAL CHAIN   */
*         /* THE NEW ACCTNMBR EXISTS IN THIS LOCAL CHAIN. SWITCH     */
*         /* THE DATA FIELD OFFSET TO THE 1ST OFFSET BLOCK IN THE    */
*         /* CHAIN TO FACILITATE THE PRUNING OF THE UNNECESSARY      */
*         /* OFFSET BLOCKS.                                          */
*         ADATSAVE = UADSADAT;        /* SAVE OFFSET TO THE NEW ACCT-
*                                        NMBR DATA FIELD             */
         L     @10,UADSADAT(,DNOBPTR)                              0453
         ST    @10,ADATSAVE                                        0453
*         UADSADAT = RDATSAVE;        /* PUT IN OFFSET TO 1ST DATAFD */
         L     @09,RDATSAVE                                        0454
         ST    @09,UADSADAT(,DNOBPTR)                              0454
*         DNOBPTR = OACSAVE;          /* REF 1ST OBLK AGAIN          */
         L     DNOBPTR,OACSAVE                                     0455
*         UADSADAT = ADATSAVE;        /* PUT IN OFFSET TO NEW ACCT-
*                                        NMBR DATA FIELD             */
         ST    @10,UADSADAT(,DNOBPTR)                              0456
*ACHNPR1: /* IF THERE ARE NO BROTHERS, THEN PRUNING IS UNNECESSARY.  */
*         IF AFLG01 = '1'B                                         0457
*           THEN                      /* NO BROTHERS,                */
ACHNPR1  TM    AFLG01(DNOBPTR),B'10000000'                         0457
         BO    @RT00457                                            0457
*             GOTO ACNEXT2;           /* GO CHECK WHERE PROCESSING 0458
*                                        IS TO CONTINUE              */
*         /* MUST MAKE SURE THAT THE 1ST OFFSET BLOCK POINTS TO THE  */
*         /* BEGINNING OF THE PROC CHAIN. IT IS POSSIBLE THAT THERE  */
*         /* ARE NO PROCS LEFT UNDER THE 1ST ACCTNMBR, SO THAT THE   */
*         /* 1ST PROC IS UNDER ONE OF THE BROTHERS THAT WILL BE      */
*         /* PRUNED FROM THE TREE.                                   */
*         IF UADSASUB = 0             /* ANY PROCS UNDER 1ST ACTNBR? */
*           THEN                      /* NO,                         */
         L     @10,UADSASUB(,DNOBPTR)                              0459
         LTR   @10,@10                                             0459
         BNZ   @RF00459                                            0459
*             DO;                                                  0460
*             /* FIND THE 1ST REMAINING PROC UNDER THE CURRENT PASSWD*/
*             DNOBPTR = HEDBPTR+UADSANEX; /* REF THE 1ST ACTN BROTHER*/
         LR    @10,HEDBPTR                                         0461
         SLR   @09,@09                                             0461
         ICM   @09,7,UADSANEX(DNOBPTR)                             0461
         AR    @10,@09                                             0461
         LR    DNOBPTR,@10                                         0461
*             /* PROC CHAIN START UNDER THIS ACCTNMBR?               */
*             DO WHILE UADSASUB = 0;                               0462
         B     @DE00462                                            0462
@DL00462 DS    0H                                                  0463
*               DNOBPTR = HEDBPTR+UADSANEX;/* REF THE NEXT BROTHER   */
         LR    @10,HEDBPTR                                         0463
         SLR   @09,@09                                             0463
         ICM   @09,7,UADSANEX(DNOBPTR)                             0463
         AR    @10,@09                                             0463
         LR    DNOBPTR,@10                                         0463
*               END;                                               0464
@DE00462 L     @10,UADSASUB(,DNOBPTR)                              0464
         LTR   @10,@10                                             0464
         BZ    @DL00462                                            0464
*             SUBOFS = UADSASUB;      /* SAVE OFFSET TO 1ST PROC     */
         ST    @10,SUBOFS                                          0465
*             DNOBPTR = OACSAVE;      /* REF 1ST ACCTNMBR AGAIN      */
         L     DNOBPTR,OACSAVE                                     0466
*             UADSASUB = SUBOFS;      /* CONNECT 1ST PROC TO IT      */
         ST    @10,UADSASUB(,DNOBPTR)                              0467
*               END;                                               0468
*         /* START THE PRUNING PROCESS WITH THE 1ST BROTHER.         */
*         DNOBPTR = HEDBPTR+UADSANEX;                              0469
@RF00459 LR    @10,HEDBPTR                                         0469
         SLR   @09,@09                                             0469
         ICM   @09,7,UADSANEX(DNOBPTR)                             0469
         AR    @10,@09                                             0469
         LR    DNOBPTR,@10                                         0469
*ACHNPR2: /* BEGINNING OF THE PRUNING SECTION.                       */
*         ANEXSAVE = UADSANEX;        /* SAVE OFFSET TO NEXT OBLK    */
ACHNPR2  SLR   ANEXSAVE,ANEXSAVE                                   0470
         ICM   ANEXSAVE,7,UADSANEX(DNOBPTR)                        0470
*         /* SAVE THE CHAIN FLAG.                                    */
*         IF AFLG01 = '1'B                                         0471
*           THEN                                                   0471
         TM    AFLG01(DNOBPTR),B'10000000'                         0471
         BNO   @RF00471                                            0471
*             FLGSAVE = '1'B;                                      0472
         OI    FLGSAVE,B'10000000'                                 0472
*           ELSE                                                   0473
*             FLGSAVE = '0'B;                                      0473
         B     @RC00471                                            0473
@RF00471 NI    FLGSAVE,B'01111111'                                 0473
*         UADSAPTR = HEDBPTR+UADSADAT;/* REF ITS DATA FIELD          */
@RC00471 L     @10,UADSADAT(,DNOBPTR)                              0474
         LR    @09,HEDBPTR                                         0474
         AR    @09,@10                                             0474
         ST    @09,UADSAPTR                                        0474
*         /* CHECK WHETHER THE DATAFLD CAN BE FREED (IF USE CTR = 1) */
*         IF UADSACTR = 1                                          0475
*           THEN                      /* YES,                        */
         CLI   UADSACTR(@09),1                                     0475
         BNE   @RF00475                                            0475
*             DO;                                                  0476
*               AREAOFST = UADSADAT;  /* OFFSET TO AREA TO BE FREED  */
         ST    @10,AREAOFST                                        0477
*               AREALNTH = 45+UADSALEN;/* LENGTH TO BE FREED         */
         LA    @10,45                                              0478
         SLR   @07,@07                                             0478
         IC    @07,UADSALEN(,@09)                                  0478
         AR    @10,@07                                             0478
         STH   @10,AREALNTH                                        0478
*               CALL IKJFRSP;         /* GO FREE THE DATAFLD         */
         BAL   @14,IKJFRSP                                         0479
*             END;                                                 0480
*           ELSE                      /* NO,                         */
*             UADSACTR = UADSACTR-1;  /* DECREMENT THE USE COUNTER   */
         B     @RC00475                                            0481
@RF00475 L     @10,UADSAPTR                                        0481
         SLR   @09,@09                                             0481
         IC    @09,UADSACTR(,@10)                                  0481
         BCTR  @09,0                                               0481
         STC   @09,UADSACTR(,@10)                                  0481
*         /* PRUNE ONE ACCTNMBR OFFSET BLOCK FROM THE TREE.          */
*         AREAOFST = DNOBPTR-HEDBPTR; /* OFFSET TO AREA TO BE FREED  */
@RC00475 LR    @10,DNOBPTR                                         0482
         SR    @10,HEDBPTR                                         0482
         ST    @10,AREAOFST                                        0482
*         AREALNTH = 12;              /* LENGTH TO BE FREED          */
         MVC   AREALNTH(2),@CH00055                                0483
*         CALL IKJFRSP;               /* GO FREE THE OBLK            */
         BAL   @14,IKJFRSP                                         0484
*         /* CHECK FOR MORE BROTHERS IN THIS CHAIN.                  */
*         IF FLGSAVE = '0'B                                        0485
*           THEN                      /* MORE OBLKS TO BE FREED      */
         TM    FLGSAVE,B'10000000'                                 0485
         BNZ   @RF00485                                            0485
*             DO;                                                  0486
*               DNOBPTR =             /* REF THE NEXT OBLK           */
*                 HEDBPTR+ANEXSAVE;                                0487
         LR    DNOBPTR,HEDBPTR                                     0487
         AR    DNOBPTR,ANEXSAVE                                    0487
*               GOTO ACHNPR2;         /* CONTINUE PRUNING            */
         B     ACHNPR2                                             0488
*             END;                                                 0489
*         /* PRUNING IN THIS LOCAL CHAIN HAS BEEN COMPLETED.         */
*         DNOBPTR = OACSAVE;          /* REF THE 1ST OBLK AGAIN      */
@RF00485 L     DNOBPTR,OACSAVE                                     0490
*         UADSANEX = ANEXSAVE;        /* INSERT THE OFFSET TO THE 1ST
*                                        OBLK IN THE NEXT CHAIN      */
         STCM  ANEXSAVE,7,UADSANEX(DNOBPTR)                        0491
*         AFLG01 = '1'B;              /* SET THE CHAIN FLAG TO 1 - 0492
*                                        END OF THIS LOCAL CHAIN     */
         OI    AFLG01(DNOBPTR),B'10000000'                         0492
*         GOTO ACNEXT2;               /* GO CHECK WHERE PROCESSING 0493
*                                        IS TO CONTINUE              */
         B     ACNEXT2                                             0493
*NACTS:   /* SEARCH THE TOTAL CHAIN FOR THE NEW ACCTNMBR.            */
*         CALL DLACTS;                /* GO TO TOTAL SEARCH SUBRTNE  */
NACTS    BAL   @14,DLACTS                                          0494
*         /* DOES THE NEW ACCTNMBR EXIST IN THE TOTAL CHAIN?         */
*         IF CSNPTR = 0                                            0495
*           THEN                      /* NO,                         */
         L     @10,CSNPTR                                          0495
         LTR   @10,@10                                             0495
         BZ    @RT00495                                            0495
*             GOTO NACNF1;            /* GO MAKE APPROPRIATE CHANGES */
*         /* THE NEW ACCTNMBR EXISTS IN A COUSIN CHAIN. THE COUSIN   */
*         /* DATA FIELD MUST BE USED.                                */
*         /* CHECK THE USE COUNTER BEFORE INCREMENTING IT. IT CANNOT */
*         /* EXCEED 255.                                             */
*         IF UADSACTR = 255                                        0497
*           THEN                      /* CTR LIMIT HAS BEEN REACHED  */
         L     @10,UADSAPTR                                        0497
         CLI   UADSACTR(@10),255                                   0497
         BNE   @RF00497                                            0497
*             DO;                                                  0498
*               MSGNMBR = 30;         /* SET MSG NO FOR IKJEFA20     */
         MVI   MSGNMBR(CTRLTABP),X'1E'                             0499
*               GOTO WORKEND;         /* GO RETURN                   */
         B     WORKEND                                             0500
*             END;                                                 0501
*         UADSACTR = UADSACTR+1;      /* INCREMENT THE USE CTR       */
@RF00497 L     @10,UADSAPTR                                        0502
         LA    @09,1                                               0502
         SLR   @07,@07                                             0502
         IC    @07,UADSACTR(,@10)                                  0502
         AR    @09,@07                                             0502
         STC   @09,UADSACTR(,@10)                                  0502
*         DNOBPTR = OACSAVE;          /* REF 1ST OBLK AGAIN          */
         L     DNOBPTR,OACSAVE                                     0503
*         ADATSAVE = UADSADAT;        /* SAVE OFFSET TO ITS DATAFLD  */
         L     @10,UADSADAT(,DNOBPTR)                              0504
         ST    @10,ADATSAVE                                        0504
*         UADSADAT = RDATSAVE;        /* INSERT OFFSET TO COUSIN DFD */
         L     @10,RDATSAVE                                        0505
         ST    @10,UADSADAT(,DNOBPTR)                              0505
*PRADF:   /* LABEL FOR BRANCH POINT.                                 */
*         UADSAPTR = ODFPTR;          /* REF DATAFLD OF 1ST OBLK     */
PRADF    L     @10,ODFPTR                                          0506
         ST    @10,UADSAPTR                                        0506
*         /* CHECK WHETHER THIS DATA FIELD CAN BE FREED.             */
*         IF UADSACTR = 1                                          0507
*           THEN                      /* YES,                        */
         CLI   UADSACTR(@10),1                                     0507
         BNE   @RF00507                                            0507
*             DO;                                                  0508
*               AREAOFST = ADATSAVE;  /* OFFSET TO AREA TO BE FREED  */
         L     @09,ADATSAVE                                        0509
         ST    @09,AREAOFST                                        0509
*               AREALNTH = 45+UADSALEN;/* LENGTH TO BE FREED         */
         LA    @09,45                                              0510
         SLR   @07,@07                                             0510
         IC    @07,UADSALEN(,@10)                                  0510
         AR    @09,@07                                             0510
         STH   @09,AREALNTH                                        0510
*               CALL IKJFRSP;         /* GO FREE THE DATAFLD         */
         BAL   @14,IKJFRSP                                         0511
*             END;                                                 0512
*           ELSE                      /* NO,                         */
*             UADSACTR = UADSACTR-1;  /* DECREMENT THE USE CTR       */
         B     @RC00507                                            0513
@RF00507 L     @10,UADSAPTR                                        0513
         SLR   @09,@09                                             0513
         IC    @09,UADSACTR(,@10)                                  0513
         BCTR  @09,0                                               0513
         STC   @09,UADSACTR(,@10)                                  0513
*         GOTO ACHNPR1;               /* GO TO THE PRUNING SECTION   */
         B     ACHNPR1                                             0514
*NACNF1:  /* THE NEW ACCTNMBR DOES NOT EXIST IN THIS TREE. CREATE A  */
*         /* NEW DATA FIELD FOR IT.                                  */
*         DNOBPTR = OACSAVE;          /* REF THE 1ST OBLK AGAIN      */
NACNF1   L     DNOBPTR,OACSAVE                                     0515
*         UADSAPTR = ODFPTR;          /* REF ITS DATA FIELD          */
         L     @10,ODFPTR                                          0516
         ST    @10,UADSAPTR                                        0516
*         ADATSAVE = UADSADAT;        /* SAVE OFFSET TO ITS DATAFLD  */
         L     @10,UADSADAT(,DNOBPTR)                              0517
         ST    @10,ADATSAVE                                        0517
*         NACDFLG = '1'B;             /* SET FLAG FOR LOGIC FLOW     */
         OI    NACDFLG,B'00001000'                                 0518
*         GOTO NEWACDF;               /* GO CREATE A NEW DATAFLD     */
         B     NEWACDF                                             0519
*NACNF2:  /* RETURN POINT AFTER A NEW DATA FIELD HAS BEEN CREATED.   */
*         UADSADRF =                  /* SET THE DRIVER FIELD IN THE */
*           UADSADRF&&UADSADRF;       /* DATA FIELD TO ZERO          */
NACNF2   L     @10,UADSAPTR                                        0520
         XC    UADSADRF(40,@10),UADSADRF(@10)                      0520
*         NACDFLG = '0'B;             /* RESET THE CONTROL FLAG      */
         NI    NACDFLG,B'11110111'                                 0521
*         GOTO PRADF;                 /* GO FREE THE OLD DATAFLD     */
         B     PRADF                                               0522
*CHTWSR1: /* THE PROCNAME CHAINS UNDER THE ACCTNMBRS OF THIS LOCAL   */
*         /* ACCTNMBR CHAIN MUST BE COMPARED TO MAKE SURE THAT NO    */
*         /* TWINS EXIST. THESE CHAINS WILL BE MERGED INTO ONE AND   */
*         /* ONE OF EACH PAIR OF TWINS MUST BE PRUNED. IF THE TWINS  */
*         /* DO NOT HAVE IDENTICAL DATA FIELDS, HOWEVER, THEN THE    */
*         /* MERGE IS NOT POSSIBLE & AN ERROR MSG WILL BE ISSUED.    */
*         ACTWIN1 = DNOBPTR;          /* REF THE 1ST ACCTNMBR OBLK   */
CHTWSR1  LR    ACTWIN1,DNOBPTR                                     0523
*         ACTWIN2 = HEDBPTR+UADSANEX; /* REF ITS BROTHER. THEIR PROC-
*                                        NAME CHAINS WILL BE COMPARD */
         LR    ACTWIN2,HEDBPTR                                     0524
         SLR   @07,@07                                             0524
         ICM   @07,7,UADSANEX(DNOBPTR)                             0524
         AR    ACTWIN2,@07                                         0524
*         ALLACFLG = '1'B;            /* SET FLAG FOR LOGIC FLOW     */
         OI    ALLACFLG,B'00100000'                                0525
*         /* GO TO THE TWIN SEARCH SECTION & PRUNE ONE OF EACH PAIR  */
*         /* OF TWINS THAT ARE FOUND.                                */
*         GOTO PRTWSRCH;                                           0526
         B     PRTWSRCH                                            0526
*CHTWSR2: /* RETURN POINT AFTER TWIN SEARCH AND PRUNING.             */
*         DNOBPTR = ACTWIN2;          /* REF THE 2ND OF THE TWO ACCT-
*                                        NMBRS WHOSE PROCNAME CHAINS
*                                        WHERE JUST COMPARED         */
CHTWSR2  LR    DNOBPTR,ACTWIN2                                     0527
*         /* DOES THIS 2ND ACCTNMBR HAVE MORE BROTHERS?              */
*         IF AFLG01 = '0'B                                         0528
*           THEN                      /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0528
         BNZ   @RF00528                                            0528
*             DO;                                                  0529
*               ACTWIN2 =             /* REF ITS BROTHER FOR THE     */
*                 HEDBPTR+UADSANEX;   /* NEXT COMPARISON OF PROCS    */
         LR    ACTWIN2,HEDBPTR                                     0530
         SLR   @07,@07                                             0530
         ICM   @07,7,UADSANEX(DNOBPTR)                             0530
         AR    ACTWIN2,@07                                         0530
*               /* GO TO THE TWIN SEARCH SECTION AGAIN.              */
*               GOTO PRTWSRCH;                                     0531
         B     PRTWSRCH                                            0531
*             END;                                                 0532
*         /* END OF CHAIN HAS BEEN REACHED. REF THE 1ST OF THE TWO   */
*         /* ACCTNMBRS AGAIN. THIS PROCESS WILL CONTINUE UNTIL EVERY */
*         /* PROCNAME CHAIN UNDER THIS PASSWORD HAS BEEN COMPARED    */
*         /* TO ALL OTHERS.                                          */
*         DNOBPTR = ACTWIN1;                                       0533
@RF00528 LR    DNOBPTR,ACTWIN1                                     0533
*         DNOBPTR = HEDBPTR+UADSANEX; /* REF ITS BROTHER             */
         LR    @10,HEDBPTR                                         0534
         SLR   @09,@09                                             0534
         ICM   @09,7,UADSANEX(DNOBPTR)                             0534
         AR    @10,@09                                             0534
         LR    DNOBPTR,@10                                         0534
*         /* ARE THERE MORE BROTHERS?                                */
*         IF AFLG01 = '0'B                                         0535
*           THEN                      /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0535
         BZ    @RT00535                                            0535
*             GOTO CHTWSR1;           /* CONTINUE THE PROCESS        */
*         /* THE SEARCH FOR & PRUNING OF POSSIBLE PROCNAME TWINS     */
*         /* HAS BEEN COMPLETED. ALL PROCNAME CHAINS UNDER THIS      */
*         /* PASSWORD WILL NOW BE MERGED INTO ONE CHAIN.             */
*         DNOBPTR = OACSAVE;          /* REF 1ST ACCTNMBR OBLK       */
         L     DNOBPTR,OACSAVE                                     0537
*CHMRG2:  /* ANY MORE ACCTNMBRS IN THIS CHAIN?                       */
*         IF AFLG01 = '1'B                                         0538
*           THEN                      /* NO, THE MERGE IS COMPLETE   */
CHMRG2   TM    AFLG01(DNOBPTR),B'10000000'                         0538
         BNO   @RF00538                                            0538
*             DO;                                                  0539
*               DNOBPTR = OACSAVE;    /* REF 1ST ACCTNMBR IN CHAIN   */
         L     DNOBPTR,OACSAVE                                     0540
*               GOTO NACLS;           /* START THE PRUNING PROCESS   */
         B     NACLS                                               0541
*             END;                                                 0542
*         /* IT IS POSSIBLE THAT AN ACCTNMBR HAS NO PROCS LEFT. IF   */
*         /* SO, CONTINUE WITH THE NEXT ACCTNMBR.                    */
*         IF UADSASUB ^= 0                                         0543
*           THEN                      /* YES PROCS LEFT,             */
@RF00538 L     @10,UADSASUB(,DNOBPTR)                              0543
         LTR   @10,@10                                             0543
         BZ    @RF00543                                            0543
*             DO;                                                  0544
*             /* REF THE 1ST PROCNAME OBLK UNDER THIS ACCTNMBR.      */
*             DROBPTR = HEDBPTR+UADSASUB;                          0545
         AR    @10,HEDBPTR                                         0545
         LR    DROBPTR,@10                                         0545
*             /* FIND THE END OF THIS PROCNAME CHAIN & SET THE CHAIN */
*             /* FLAG TO '0'B. THIS MERGES IT WITH THE NEXT CHAIN.   */
*             DO WHILE FLGR01 = '0'B; /* END OF CHAIN?               */
         B     @DE00546                                            0546
@DL00546 DS    0H                                                  0547
*               DROBPTR =             /* REF THE NEXT PROC BROTHER   */
*                 HEDBPTR+UADSRNEX;                                0547
         LR    @10,HEDBPTR                                         0547
         SLR   @09,@09                                             0547
         ICM   @09,7,UADSRNEX(DROBPTR)                             0547
         AR    @10,@09                                             0547
         LR    DROBPTR,@10                                         0547
*               END;                                               0548
@DE00546 TM    FLGR01(DROBPTR),B'10000000'                         0548
         BZ    @DL00546                                            0548
*             FLGR01 = '0'B;          /* SET CHAIN FLAG TO ZERO      */
         NI    FLGR01(DROBPTR),B'01111111'                         0549
*             SUBOFS = DROBPTR;       /* SAVE ADDR OF THIS OBLK      */
         ST    DROBPTR,SUBOFS                                      0550
*             END;                                                 0551
*         DNOBPTR = HEDBPTR+UADSANEX; /* REF NEXT ACCTNMBR IN CHAIN  */
@RF00543 LR    @10,HEDBPTR                                         0552
         SLR   @09,@09                                             0552
         ICM   @09,7,UADSANEX(DNOBPTR)                             0552
         AR    @10,@09                                             0552
         LR    DNOBPTR,@10                                         0552
*         /* IF THIS IS THE LAST ACCTNMBR IN THIS LOCAL CHAIN AND    */
*         /* THERE ARE NO PROCS LEFT UNDER IT, THEN THE CHAIN FLAG   */
*         /* IN THE LAST PROC OBLK OF THE PREVIOUS CHAIN MUST BE     */
*         /* SET TO '1'.                                             */
*         IF AFLG01 = '1'B            /* LAST ACCTNMBR IN LOC CHAIN? */
*           THEN                      /* YES,                        */
         TM    AFLG01(DNOBPTR),B'10000000'                         0553
         BNO   @RF00553                                            0553
*             /* ANY PROCS LEFT UNDER THIS ACCTNMBR?                 */
*             IF UADSASUB = 0                                      0554
*               THEN                  /* NO,                         */
         L     @10,UADSASUB(,DNOBPTR)                              0554
         LTR   @10,@10                                             0554
         BNZ   @RF00554                                            0554
*                 DO;                                              0555
*                   DROBPTR = SUBOFS; /* REF LAST EXISTING PROC      */
         L     DROBPTR,SUBOFS                                      0556
*                   FLGR01 = '1'B;    /* SET ITS CHAIN FLAG TO '1' TO
*                                        INDICATE END OF CHAIN       */
         OI    FLGR01(DROBPTR),B'10000000'                         0557
*                 END;                                             0558
*         GOTO CHMRG2;                /* GO CHECK WHERE TO CONTINUE  */
         B     CHMRG2                                              0559
*ACNEXT2: /* DETERMINE WHERE PROCESSING IS TO CONTINUE. IF THERE ARE */
*         /* MORE PASSWORDS TO BE PROCESSED IN THIS TREE, THEN       */
*         /* REFERENCE THE NEXT PASSWORD AND CONTINUE. IF NOT, THEN  */
*         /* RETURN TO IKJEFA20 TO WRITE THIS TREE INTO THE UADS.    */
*         DPOBPTR = NLPWOBAD;         /* REF PASSWORD JUST PROCESSED */
ACNEXT2  LR    DPOBPTR,NLPWOBAD                                    0560
*         /* IF A PASSWORD WAS SPECIFIED, OR THERE ARE NO MORE PASS- */
*         /* WORDS IN THE CHAIN, THEN ALL NECESSARY CHANGES HAVE     */
*         /* BEEN MADE TO THIS TREE.                                 */
*         IF PASSWD(1) ^= '*'         /* PASSWORD SPECIFIED?         */
*           PFLG01 = '1'B            /* OR END OF CHAIN?            */
*           THEN                      /* YES, ONE OF THE ABOVE       */
         L     @10,NODELPTR(,CTRLTABP)                             0561
         CLI   PASSWD(@10),C'*'                                    0561
         BNE   @RT00561                                            0561
         TM    PFLG01(DPOBPTR),B'10000000'                         0561
         BO    @RT00561                                            0561
*             GOTO CHGEOK;            /* GO SET INDICATORS & RETURN  */
*         DPOBPTR = HEDBPTR+UADSPNEX; /* REF THE NEXT PASSWD OBLK    */
         LR    @10,HEDBPTR                                         0563
         SLR   @09,@09                                             0563
         ICM   @09,7,UADSPNEX(DPOBPTR)                             0563
         AR    @10,@09                                             0563
         LR    DPOBPTR,@10                                         0563
*         NLPWOBAD = DPOBPTR;         /* SAVE ADDR OF THIS OBLK      */
         LR    NLPWOBAD,DPOBPTR                                    0564
*         GOTO CHALLAC;               /* CONTINUE UNDER NEXT PASSWRD */
         B     CHALLAC                                             0565
*CHGEOK:  /* THIS TREE HAS BEEN CHANGED SUCCESSFULLY. SET APPROPRI-  */
*         /* ATE INDICATORS AND RETURN TO CHANGE (IKJEFA20).         */
*         MSGNMBR = 0;                /* ALL REQUIRED CHANGES TO THIS
*                                        TREE HAVE BEEN MADE         */
CHGEOK   MVI   MSGNMBR(CTRLTABP),X'00'                             0566
*WORKEND: /* THIS ROUTINE HAS COMPLETED PROCESSING. RETURN TO        */
*         /* CHANGE (IKJEFA20) WITH EITHER A REQUEST TO WRITE THIS   */
*         /* TREE BACK INTO THE UADS, OR A REQUEST TO PERFORM        */
*         /* ANOTHER SEARCH, OR A REQUEST TO ISSUE AN ERROR MESSAGE. */
*         RETURN;                                                  0567
         B     @EL00001                                            0567
*DLACLS:  /***********************************************************/
*         /* THIS SUBROUTINE WILL SEARCH FOR AN ACCTNMBR IN A        */
*         /* LOCAL ACCTNMBR CHAIN.                                   */
*         /***********************************************************/
*         PROC;                                                    0568
DLACLS   STM   @14,@02,12(@13)                                     0568
         STM   @04,@08,36(@13)                                     0568
         STM   @10,@12,60(@13)                                     0568
*         /* BEGINNING OF THE SEARCH LOOP (LOCAL CHAIN).             */
*         LOOPFLG = '0'B;             /* RESET LOOP FLAG             */
         NI    LOOPFLG,B'11111011'                                 0569
*         DO WHILE LOOPFLG = '0'B;    /* ANY BROTHERS?               */
         B     @DE00570                                            0570
@DL00570 DS    0H                                                  0571
*           UADSAPTR = HEDBPTR+UADSADAT;/* REF ACCTNMBR DATAFLD      */
         LR    @10,HEDBPTR                                         0571
         A     @10,UADSADAT(,DNOBPTR)                              0571
         ST    @10,UADSAPTR                                        0571
*           /* COMPARE LENGTH OF THE NEW ACCTNMBR TO LENGTH OF UADS  */
*           /* ACCTNMBR. AFTER FINDING TWO EQUAL LENGTHS, COMPARE THE*/
*           /* ACCOUNT NUMBERS.                                      */
*           /* COMPARE THE NEW ACCTNMBR TO THE UADS ACCTNMBR         */
*           IF UADSALEN = DACTLEN                                  0572
*            & UADSANUM(1:DACTLEN)                                 0572
*               = DACCTNO(1:DACTLEN)                               0572
*                 THEN                /* THE NEW ACCTNMBR EXISTS IN
*                                        THE LOCAL CHAIN.            */
         L     @07,DATALPTR(,CTRLTABP)                             0572
         CLC   UADSALEN(1,@10),DACTLEN(@07)                        0572
         BNE   @RF00572                                            0572
         SLR   @05,@05                                             0572
         IC    @05,DACTLEN(,@07)                                   0572
         BCTR  @05,0                                               0572
         EX    @05,@SC00311                                        0572
         BNE   @RF00572                                            0572
*                   DO;                                            0573
*                   ACTWIN2 = DNOBPTR;/* SAVE ADDR OF THIS OBLK      */
         LR    ACTWIN2,DNOBPTR                                     0574
*                   RETURN;           /* GO BACK TO POINT OF CALL    */
@EL00002 DS    0H                                                  0575
@EF00002 DS    0H                                                  0575
@ER00002 LM    @14,@02,12(@13)                                     0575
         LM    @04,@08,36(@13)                                     0575
         LM    @10,@12,60(@13)                                     0575
         BR    @14                                                 0575
*                   END;                                           0576
*           /* THE NEW ACCTNMBR HAS NOT BEEN FOUND YET. IF THERE     */
*           /* ARE MORE ACCTNMBRS IN THIS CHAIN, THEN CONTINUE THE   */
*           /* SEARCH.                                               */
*           IF AFLG01 = '1'B          /* IS THIS THE END OF CHAIN?   */
*             THEN                    /* YES,                        */
@RF00572 TM    AFLG01(DNOBPTR),B'10000000'                         0577
         BNO   @RF00577                                            0577
*               LOOPFLG = '1'B;       /* TERMINATE LOOP              */
         OI    LOOPFLG,B'00000100'                                 0578
*             ELSE                                                 0579
*               DNOBPTR = HEDBPTR+    /* REF NEXT ACCTNMBR OBLK      */
*                 UADSANEX;                                        0579
         B     @RC00577                                            0579
@RF00577 LR    @10,HEDBPTR                                         0579
         SLR   @07,@07                                             0579
         ICM   @07,7,UADSANEX(DNOBPTR)                             0579
         AR    @10,@07                                             0579
         LR    DNOBPTR,@10                                         0579
*           END;                                                   0580
@RC00577 DS    0H                                                  0580
@DE00570 TM    LOOPFLG,B'00000100'                                 0580
         BZ    @DL00570                                            0580
*         /* THE NEW ACCTNMBR DOES NOT EXIST IN THIS LOCAL CHAIN.    */
*         ACTWIN2 = 0;                /* 0- ACCTNMBR NOT FOUND       */
         SLR   ACTWIN2,ACTWIN2                                     0581
*         END DLACLS;                 /* GO BACK TO POINT OF CALL    */
         B     @EL00002                                            0582
*DLACTS:  /***********************************************************/
*         /* THIS SUBROUTINE WILL SEARCH FOR AN ACCTNMBR IN THE      */
*         /* TOTAL LATERAL CHAIN.                                    */
*         /***********************************************************/
*         PROC;                                                    0583
DLACTS   STM   @14,@12,12(@13)                                     0583
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF THE 1ST PASSWORD OBLK   */
         LR    DPOBPTR,HEDBPTR                                     0584
         A     DPOBPTR,UADSPWD1(,HEDBPTR)                          0584
*         DNOBPTR = HEDBPTR+UADSPSUB; /* REF THE 1ST PROCNAME OBLK   */
         LR    DNOBPTR,HEDBPTR                                     0585
         A     DNOBPTR,UADSPSUB(,DPOBPTR)                          0585
*         /* BEGINNING OF THE SEARCH LOOP.                           */
*         DO WHILE DNOBPTR ^= HEDBPTR;/* MORE ACCTNMBRS?             */
         B     @DE00586                                            0586
@DL00586 DS    0H                                                  0587
*           UADSAPTR = HEDBPTR+UADSADAT;/* REF THE ACCTNMBR DATAFLD  */
         L     @10,UADSADAT(,DNOBPTR)                              0587
         LR    @07,HEDBPTR                                         0587
         AR    @07,@10                                             0587
         ST    @07,UADSAPTR                                        0587
*           /* IS THIS LENGTH EQUAL TO THE DATALIST ACCTNMBR LENGTH? */
*           /* COMPARE THE DATALIST ACCTNMBR TO THE UADS ACCTNMBR    */
*           IF UADSALEN = DACTLEN                                  0588
*            & UADSANUM(1:DACTLEN)                                 0588
*               = DACCTNO(1:DACTLEN)                               0588
*                 THEN                /* THE DATALIST ACCTNMBR EXISTS
*                                        IN THIS COUSIN CHAIN        */
         L     @05,DATALPTR(,CTRLTABP)                             0588
         CLC   UADSALEN(1,@07),DACTLEN(@05)                        0588
         BNE   @RF00588                                            0588
         SLR   @02,@02                                             0588
         IC    @02,DACTLEN(,@05)                                   0588
         BCTR  @02,0                                               0588
         EX    @02,@SC00313                                        0588
         BNE   @RF00588                                            0588
*                   DO;                                            0589
*                   CSNPTR = DNOBPTR; /* SAVE ADDR OF THIS OBLK      */
         ST    DNOBPTR,CSNPTR                                      0590
*                   RDATSAVE = UADSADAT;/* SAVE OFFSET TO THIS DFLD  */
         ST    @10,RDATSAVE                                        0591
*                   NDFPTR = UADSAPTR;/* SAVE ADDR OF THIS DATAFLD   */
         ST    @07,NDFPTR                                          0592
*                   RETURN;           /* GO BACK TO POINT OF CALL    */
@EL00003 DS    0H                                                  0593
@EF00003 DS    0H                                                  0593
@ER00003 LM    @14,@12,12(@13)                                     0593
         BR    @14                                                 0593
*                   END;                                           0594
*           /* THE DESIRED ACCTNMBR HAS NOT BEEN FOUND YET. IF THERE */
*           /* ARE MORE ACCTNMBRS IN THE TOTAL CHAIN, THEN CONTINUE  */
*           /* THE SEARCH.                                           */
*           DNOBPTR = HEDBPTR+UADSANEX;/* REF NEXT ACCTNMBR OBLK      *
@RF00588 LR    @10,HEDBPTR                                         0595
         SLR   @07,@07                                             0595
         ICM   @07,7,UADSANEX(DNOBPTR)                             0595
         AR    @10,@07                                             0595
         LR    DNOBPTR,@10                                         0595
*           END;                                                   0596
@DE00586 CR    DNOBPTR,HEDBPTR                                     0596
         BNE   @DL00586                                            0596
*         CSNPTR = 0;                 /* 0- ACCTNMBR NOT FOUND       */
         SLR   @10,@10                                             0597
         ST    @10,CSNPTR                                          0597
*         /*RESTORE REGISTER 14 AND RETURN.                          */
*         END DLACTS;                 /* RETURN TO POINT OF CALL     */
         B     @EL00003                                            0598
*IKJFRSP: /***********************************************************/
*         /* THIS SUBROUTINE WILL INTERFACE WITH THE FREESPACE       */
*         /* ROUTINE (IKJEFA54) AND CHECK ITS RETURN CODE. IF        */
*         /* FREESPACE WAS SUCCESSFUL, CONTROL WILL BE PASSED BACK   */
*         /* TO THE POINT OF CALL. IF NOT, CONTROL WILL BE RETURNED  */
*         /* TO THE CHANGE CP (IKJEFA20) WHICH WILL ISSUE THE        */
*         /* APPROPRIATE ERROR MESSAGE.                              */
*         /***********************************************************/
*         PROC;                                                    0599
IKJFRSP  STM   @14,@12,@SA00004                                    0599
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REG      */
*         R1 = ADDR(GETFREE);         /* PTR TO FREESPACE PARMLIST   */
         LA    R1,GETFREE                                          0601
*         CALL IKJEFA54;              /* GO TO THE FREESPACE ROUTINE */
         L     @15,@CV00108                                        0602
         BALR  @14,@15                                             0602
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */
*         RETCODE = R15;              /* ASSIGN THE RETURN CODE      */
         ST    R15,RETCODE(,CTRLTABP)                              0605
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */
*         IF RETCODE ^= 0                                          0607
*           THEN                      /* FREESPACE UNSUCCESSFUL      */
         L     @10,RETCODE(,CTRLTABP)                              0607
         LTR   @10,@10                                             0607
         BZ    @RF00607                                            0607
*             DO;                                                  0608
*               MSGNMBR = 24;         /* SET ERROR MSG NUMBER        */
         MVI   MSGNMBR(CTRLTABP),X'18'                             0609
*               RETURN TO WORKEND;    /* CHANGE CP WILL ISSUE THE  0610
*                                        ERROR MSG & CONTINUE WITH 0610
*                                        THE NEXT USERID, IF ANY     */
         LA    @14,WORKEND                                         0610
         LM    @15,@12,@SA00004+4                                  0610
         BR    @14                                                 0610
*             END;                                                 0611
*         END IKJFRSP;                                             0612
@EL00004 DS    0H                                                  0612
@EF00004 DS    0H                                                  0612
@ER00004 LM    @14,@12,@SA00004                                    0612
         BR    @14                                                 0612
*         END IKJEFA22                                             0613
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        *
*;                                                                 0613
         B     @EL00001                                            0613
@DATA    DS    0H
@CH00055 DC    H'12'
@SM00304 MVC   UADSANUM(0,@10),DACCTNO(@09)
@SC00311 CLC   UADSANUM(0,@10),DACCTNO(@07)
@SC00313 CLC   UADSANUM(0,@07),DACCTNO(@05)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00004 DS    0F
         DS    15F
IKJEFA22 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
UADSAPTR DS    A
DLPWOBAD DS    A
OACSAVE  DS    A
RNEXSAVE DS    A
PNEXSAVE DS    A
ADATSAVE DS    A
RDATSAVE DS    A
ODFPTR   DS    A
NDFPTR   DS    A
LASTOB   DS    A
ACTWIN3  DS    A
PRTWIN1  DS    A
PRTWIN2  DS    A
CSNSAVE  DS    A
CSNPTR   DS    A
SUBOFS   DS    A
GETFREE  DS    CL12
         ORG   GETFREE
READBUFF DS    AL4
NUMBLOKS DS    AL2
AREALNTH DS    AL2
AREAOFST DS    AL4
         ORG   GETFREE+12
PRCOMP   DS    CL8
CFLAGS   DS    CL1
         ORG   CFLAGS
FLGSAVE  DS    BL1
FLDFLG   EQU   CFLAGS+0
ALLACFLG EQU   CFLAGS+0
ACTWSRF  EQU   CFLAGS+0
NACDFLG  EQU   CFLAGS+0
LOOPFLG  EQU   CFLAGS+0
LOOPFLG2 EQU   CFLAGS+0
ACPRFLG  EQU   CFLAGS+0
         ORG   CFLAGS+1
IKJEFA22 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00107 DC    V(IKJEFA53)
@CV00108 DC    V(IKJEFA54)
         DS    0D
@CC00240 DC    C'* '
IKJEFA22 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFA22 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
PRUNOFS  EQU   @07
ACSNOFS  EQU   @07
ACTWIN2  EQU   @09
ACTWIN1  EQU   @10
NEWDFPTR EQU   @02
ANEXSAVE EQU   @02
NLPWOBAD EQU   @08
CTRLTABP EQU   @06
UADSRPTR EQU   @03
UADSPPTR EQU   @02
DROBPTR  EQU   @02
DNOBPTR  EQU   @03
DPOBPTR  EQU   @05
HEDBPTR  EQU   @04
R1       EQU   @01
R15      EQU   @15
DHED     EQU   0
UADSMHDR EQU   DHED
UADSBN01 EQU   UADSMHDR+12
UADSATTR EQU   DHED+16
UADSPWD1 EQU   DHED+24
DPOB     EQU   0
PFLG01   EQU   DPOB
UADSPNEX EQU   DPOB+1
UADSPSUB EQU   DPOB+4
UADSPDAT EQU   DPOB+8
DNOB     EQU   0
AFLG01   EQU   DNOB
UADSANEX EQU   DNOB+1
UADSASUB EQU   DNOB+4
UADSADAT EQU   DNOB+8
DROB     EQU   0
FLGR01   EQU   DROB
UADSRNEX EQU   DROB+1
UADSRDAT EQU   DROB+8
DPOBD    EQU   0
UADSPPWD EQU   DPOBD+4
DNOBD    EQU   0
UADSACTR EQU   DNOBD
UADSADRF EQU   DNOBD+4
UADSALEN EQU   DNOBD+44
UADSANUM EQU   DNOBD+45
DROBD    EQU   0
UADSRCTR EQU   DROBD
UADSRNAM EQU   DROBD+4
CTRLTAB  EQU   0
DATALPTR EQU   CTRLTAB+8
NODELPTR EQU   CTRLTAB+12
BLKCNT   EQU   CTRLTAB+16
HEADADDR EQU   CTRLTAB+17
PASSADDR EQU   CTRLTAB+20
ACCTADDR EQU   CTRLTAB+24
RETCODE  EQU   CTRLTAB+32
CHLEVL   EQU   CTRLTAB+36
SRCHIND  EQU   CTRLTAB+37
MSGNMBR  EQU   CTRLTAB+38
TRCHGE   EQU   CTRLTAB+39
NLSTTAB  EQU   0
PASSWD   EQU   NLSTTAB+9
ACCTNO   EQU   NLSTTAB+18
DLSTTAB  EQU   0
DPASSWD  EQU   DLSTTAB+9
DACTLEN  EQU   DLSTTAB+17
DACCTNO  EQU   DLSTTAB+18
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00027 EQU   DLSTTAB+76
@NM00026 EQU   DLSTTAB+68
@NM00025 EQU   DLSTTAB+66
@NM00024 EQU   DLSTTAB+58
@NM00023 EQU   DLSTTAB+1
@NM00022 EQU   DLSTTAB
@NM00021 EQU   NLSTTAB+58
@NM00020 EQU   NLSTTAB+17
@NM00019 EQU   NLSTTAB+1
@NM00018 EQU   NLSTTAB
@NM00017 EQU   CTRLTAB+39
@NM00016 EQU   CTRLTAB+39
@NM00015 EQU   CTRLTAB+28
@NM00014 EQU   CTRLTAB+4
@NM00013 EQU   CTRLTAB
UADSUNAM EQU   DROBD+16
UADSRSIZ EQU   DROBD+14
@NM00012 EQU   DROBD+12
@NM00011 EQU   DROBD+1
@NM00010 EQU   DNOBD+1
@NM00009 EQU   DPOBD+1
UADSPCTR EQU   DPOBD
@NM00008 EQU   DROB+4
@NM00007 EQU   DROB
@NM00006 EQU   DNOB
@NM00005 EQU   DPOB
@NM00004 EQU   DHED+40
UADSDEST EQU   DHED+32
UADSPERP EQU   DHED+28
UADSUPTP EQU   DHED+20
UADSINST EQU   DHED+18
@NM00003 EQU   UADSATTR
USATR03  EQU   UADSATTR
USATR02  EQU   UADSATTR
USATR01  EQU   UADSATTR
USATR00  EQU   UADSATTR
UADSMAXC EQU   UADSMHDR+14
@NM00002 EQU   UADSBN01+1
UADSEXPF EQU   UADSBN01+1
UADSNUSP EQU   UADSBN01+1
@NM00001 EQU   UADSBN01
UADSUSER EQU   UADSMHDR+4
UADSFSQP EQU   UADSMHDR+2
UADSBLNG EQU   UADSMHDR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00030 EQU   ACLEVL
@RT00032 EQU   CHALLPW
@RT00055 EQU   CHGEOK
@RT00121 EQU   ACMERG2
@RT00138 EQU   ACMERG2
@RT00142 EQU   ACMERG1
@RT00193 EQU   PRTWSR3
@RT00219 EQU   CHTWSR2
@RF00219 EQU   PRMERGE
@RT00235 EQU   PRPRUN3
@RT00254 EQU   MRGNEXT
@RT00261 EQU   PRMERG5
@RT00278 EQU   PRMERG5
@RT00282 EQU   PRMERG2
@RT00295 EQU   ACCHGE2
@RT00323 EQU   ACPRUN3
@RT00341 EQU   CHKACDF
@RT00346 EQU   PWPRUNE
@RF00346 EQU   ACTWSR1
@RT00352 EQU   CHALLAC
@RT00366 EQU   ACCHGE1
@RT00383 EQU   CHGEOK
@RT00409 EQU   NACNF2
@RT00411 EQU   ACNEXT
@RT00430 EQU   FREACDF
@RF00440 EQU   FREACDF
@RT00447 EQU   CHTWSR1
@RT00451 EQU   NACTS
@RT00457 EQU   ACNEXT2
@RT00495 EQU   NACNF1
@RC00507 EQU   ACHNPR1
@RT00535 EQU   CHTWSR1
@RF00554 EQU   CHMRG2
@RF00553 EQU   CHMRG2
@RT00561 EQU   CHGEOK
WORKEND  EQU   @EL00001
@RF00607 EQU   @EL00004
@PB00004 EQU   @EL00001
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEFA22

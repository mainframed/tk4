         TITLE 'IKJEFA30  --  ACCOUNT/DELETE COMMAND PROCEDURE         *
                        '
IKJEFA30 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFA30  74.071'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*          ACCTPLP = R1;              /* SAVE INPUT REGISTER 1       */
         LR    ACCTPLP,R1                                          0044
*          RFY R1 UNRSTD;             /* RELEASE PARM POINTER        */
*          DELECF = '0'B;             /* CLEAR DELETE CONTROL FLAGS  */
         MVI   DELECF,B'00000000'                                  0046
*          IOPLPTR = ADDR(PLOUT);     /* INITIALIZE PUTLINE POINTER  */
         LA    IOPLPTR,PLOUT                                       0047
*          PLOUT = ACCTPL;            /* INITIALIZE COMMUNICATION PL */
         MVC   PLOUT(16),ACCTPL(ACCTPLP)                           0048
*          IOPLIOPB = ADDR(PTPBK);    /* POINT TO MULTILINE PARM     */
         LA    @10,PTPBK                                           0049
         ST    @10,IOPLIOPB(,IOPLPTR)                              0049
*          UIDLPTR  =  0;             /* CLEAR UDL PTR               */
         SLR   @10,@10                                             0050
         ST    @10,UIDLPTR(,ACCTPLP)                               0050
*          /* INITIALIZE COMMUNICATION REGION                        */
*          COMAREA = COMAREA && COMAREA; /* CLEAR PARM BLOCK         */
         XC    COMAREA(11),COMAREA                                 0051
*          DPL = DPL&&DPL;            /* CLEAR DELETE POINT LIST     */
         XC    DPL(121),DPL                                        0052
*          NDLSTPDE = NDLSTPDE&&NDLSTPDE;/* CLEAR DUMMY PDE AREA     */
         XC    NDLSTPDE(36),NDLSTPDE                               0053
*          /* INITIALIZE PARAMETER BLOCKS FOR ENQUEUE, OPEN, CLOSE,  */
*          /*            DEQUEUE AND DATA CONTROL BLOCK              */
*          CPLS(1:MCPLLNG) = MCPLS(1:MCPLLNG);                     0054
         L     @05,MCPLLNG                                         0054
         BCTR  @05,0                                               0054
         EX    @05,@SM00437                                        0054
*          DIRDCB = MDIRDCB;          /* MOVE DIRECTORY DCB TO DIRWA */
         MVC   DIRDCB(88),MDIRDCB                                  0055
*          /* INITIALIZE READ/WRITE PARAMETER BLOCK                  */
*          ACIOPTR = ADDR(ACIOPARM);  /* POINT TO PARAMETER BLOCK    */
         LA    @05,ACIOPARM                                        0056
         ST    @05,ACIOPTR                                         0056
*          ACIOPARM = ACIOPARM&&ACIOPARM;/* CLEAR PARM BLOCK         */
         XC    ACIOPARM(24),ACIOPARM                               0057
*          ACIODCBA = ADDR(DELDCB);   /* SET PTR TO UADS DCB         */
         LA    @05,DELDCB                                          0058
         STCM  @05,7,ACIODCBA                                      0058
*          ACIOPUTL = ACCTPLP;        /* SET PTR TO ACCOUNT  P L     */
         ST    ACCTPLP,ACIOPUTL                                    0059
*          MSGID = '8';               /* SET DELETE IDENTIFIER       */
         MVI   MSGID,C'8'                                          0060
*          /* INITIALIZE PARSE PARAMETER CONTROL LIST (PCL) FR. MODEL*/
*          /* PCL MUST BE MOVED INTO DYNAMIC STORAGE SINCE IT WILL BE*/
*          /* MODIFIED IN THE NODELIST VALIDITY CK EXIT RTNE-NLSTEXIT*/
*          PCLPTR = 0;                /* SET PTR T0 0                */
         ST    @10,PCLPTR                                          0061
*          RFY R0 RSTD;               /* RESERVE REG. FOR GETMAIN    */
*          R0=PCLLNGTH;               /* SET LENGTH = PCL SIZE       */
         L     @10,PCLMDLAD                                        0063
         LH    R0,PCLLNGTH(,@10)                                   0063
*          PLENGTH=R0;                /* SAVE LENGTH FOR FREEMAIN    */
         ST    R0,PLENGTH                                          0064
*          /* USE OS/360 GETMAIN MACRO TO OBTAIN WORK AREA.          */
*          GEN (GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,GMLST))          0065
*            SETS(PCLPTR) REFS(R0,GMLST);                          0065
         GETMAIN EC,LV=(R0),A=PCLPTR,MF=(E,GMLST)
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE=R15;              /* SAVE GETMAIN RETURN CODE    */
         LR    RETNCODE,R15                                        0067
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE^=0             /* GETMAIN FAILED?             */
*            THEN                     /* YES,                        */
         LTR   RETNCODE,RETNCODE                                   0069
         BNZ   @RT00069                                            0069
*              GOTO NOSPAZ;           /* GO PUT OUT MESSAGE & LEAVE  */
*          RFY (R1,R14,R15) RSTD;     /* RESTRICT WORK REGISTERS     */
*          R0=PCLPTR;                 /* GET TO ADDRESS              */
         L     R0,PCLPTR                                           0072
*          R1=PLENGTH;                /* LOAD R1 WITH LENGTH         */
         L     @10,PLENGTH                                         0073
         LR    R1,@10                                              0073
*          R14=PCLMDLAD;              /* GET FROM ADDRESS            */
         L     R14,PCLMDLAD                                        0074
*          R15=PLENGTH;               /* LOAD R15 WITH LENGTH        */
         LR    R15,@10                                             0075
*          GEN (MVCL  R0,R14)         /* MOVE PCL TO GOTTEN CORE     */
*            REFS(R0,R1,R14,R15);                                  0076
         MVCL  R0,R14
*          RFY (R0,R1,R14,R15) UNRSTD;/* RELEASE WORK REGISTERS      */
*          PPLPTR=ADDR(PARSLIST);     /* ESTABLISH PPL ADDRESSABLTY  */
         LA    @10,PARSLIST                                        0078
         ST    @10,PPLPTR                                          0078
*          EXITADD=ADDR(NLSTEXIT);    /* POINT TO ADD'S EXIT         */
         LA    @15,NLSTEXIT                                        0079
         ST    @15,EXITADD                                         0079
*          NODEPTR=ADDR(NLSTTAB);     /* POINT TO THE NODELIST TAB   */
         LA    @15,NLSTTAB                                         0080
         ST    @15,NODEPTR                                         0080
*          CMDIND=3;                  /* INDICATE DEL CMD NODELIST   */
         MVI   CMDIND,X'03'                                        0081
*          RFY R13 RSTD;              /* RESTRICT SAVE AREA POINTER  */
*          SAVARAD=R13;               /* POINT TO DELETE'S SAVEAREA  */
         ST    R13,SAVARAD                                         0083
*          /* INITIALIZE PARSE PARAMETER LIST                        */
*          DELPDLAD = 0;              /* INIT PTR TO 0               */
         SLR   @15,@15                                             0084
         ST    @15,DELPDLAD                                        0084
*          PARSLIST(1:12)=ACCTPL;     /* FIRST THREE WORDS FROM    0085
*                                        ACCOUNT PARAMETER LIST      */
         MVC   PARSLIST(12),ACCTPL(ACCTPLP)                        0085
*          PPLPCL=PCLPTR;             /* ADDRESS OF DYNAMIC PCL      */
         L     @15,PCLPTR                                          0086
         ST    @15,PPLPCL(,@10)                                    0086
*          PPLANS=ADDR(DELPDLAD);     /* ADDPDLAD WILL CONTAIN ADD.
*                                        OF PDL AFTER PARSE EXECUTES */
         LA    @15,DELPDLAD                                        0087
         ST    @15,PPLANS(,@10)                                    0087
*          PPLCBUF=CMDBUFAD;          /* ADDR OF ADD COMMAND BUFFER  */
         L     @15,CMDBUFAD(,ACCTPLP)                              0088
         ST    @15,PPLCBUF(,@10)                                   0088
*          PPLUWA=ADDR(VCHKPL);       /* ADDRESS OF EXIT ROUTINE   0089
*                                          PARAMETER LIST            */
         LA    @15,VCHKPL                                          0089
         ST    @15,PPLUWA(,@10)                                    0089
*          /*  LINK TO PARSE SERVICE ROUTINE                         */
*          GEN (LINK  EP=IKJPARS,MF=(E,PARSLIST))                  0090
*            FLOWS(IKJEFA55,NLSTEXIT) REFS(PARSLIST);              0090
         LINK  EP=IKJPARS,MF=(E,PARSLIST)
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE=R15;              /* SAVE RETURN CODE            */
         LR    RETNCODE,R15                                        0092
*          RFY R15 UNRSTD;            /* RELEASE THE RETURN CODE REG */
*          IF RETNCODE ^= 0           /* PARSE SUCCESSFUL?           */
*            THEN                     /* NO,                         */
         LTR   RETNCODE,RETNCODE                                   0094
         BZ    @RF00094                                            0094
*              DO;                                                 0095
*              /* CHECK THE PARSE RETURN CODE.                       */
*              IF RETNCODE = 20       /* DID THE VALIDITY CHECK ROUTINE
*                                          DISCOVER THE ERROR        */
*                THEN                 /* YES,                        */
         CH    RETNCODE,@CH00355                                   0096
         BNE   @RF00096                                            0096
*                  RETNCODE = EXITRTCD;/* SAVE THE VALIDITY CODE     */
         L     RETNCODE,EXITRTCD                                   0097
*              IF RETNCODE = 16       /* CHK FOR NO SPACE CODE       */
*                THEN                 /* YES,                        */
@RF00096 CH    RETNCODE,@CH00044                                   0098
         BE    @RT00098                                            0098
*                  GOTO  NOSPAZ;      /* GO TO ISSUE NO SPACE MSG    */
*              IF RETNCODE = 4 ×      /* NO PROMPT? OR               */
*                RETNCODE = 8         /* ATTENTION INTERUPT?         */
*                THEN                 /* YES,                        */
         CH    RETNCODE,@CH00066                                   0100
         BE    @RT00100                                            0100
         CH    RETNCODE,@CH00046                                   0100
         BNE   @RF00100                                            0100
@RT00100 DS    0H                                                  0101
*                  DO;                                             0101
*                  DELERR = '1'B;     /* SET NO SUCCESS MESSAGE FLAG */
         OI    DELERR,B'00100000'                                  0102
*                  GOTO  DOCLOS;      /* GO TO EXIT                  */
         B     DOCLOS                                              0103
*                  END;                                            0104
*              MSGNO  =  20;          /* PARSE COMMAND SYSTEM ERROR  */
@RF00100 MVC   MSGNO(2),@CH00355                                   0105
*              GOTO  SYSERRD;         /* GO TO ISSUE MESSAGE         */
         B     SYSERRD                                             0106
*              END;                                                0107
*          IF DATAKEY(16) = '1'B      /* IS DATA LIST PRESENT?       */
*            THEN                     /* YES                         */
@RF00094 L     @10,DELPDLAD                                        0108
         TM    DATAKEY+1(@10),B'00000001'                          0108
         BNO   @RF00108                                            0108
*              DATLIN = '1'B;         /* SET DATALIST FLAG           */
         OI    DATLIN,B'01000000'                                  0109
*          UPDE = ADDR(USRID);        /* SAVE USERID PDE             */
@RF00108 LA    @10,USRID                                           0110
         ST    @10,UPDE                                            0110
*          ULEN = USRLEN;             /* SAVE LENGTH OF USERID       */
         SLR   @10,@10                                             0111
         IC    @10,USRLEN                                          0111
         STH   @10,ULEN                                            0111
*          IF NUMOFLV > 1             /* IS PASSWORD PRESENT?        */
*            THEN                     /* YES                         */
         CLI   NUMOFLV,1                                           0112
         BNH   @RF00112                                            0112
*              DO;                                                 0113
*              PWDNTR = '1'B;         /* SET PASSWORD FLAG           */
         OI    PWDNTR,B'00000100'                                  0114
*              PPDE = ADDR(PASSWD);   /* SAVE PASSWORD PDE           */
         LA    @10,PASSWD                                          0115
         ST    @10,PPDE                                            0115
*              END;                                                0116
*          IF NUMOFLV > 2             /* IS ACCTNMBR PRESENT?        */
*            THEN                     /* YES                         */
@RF00112 CLI   NUMOFLV,2                                           0117
         BNH   @RF00117                                            0117
*              DO;                                                 0118
*              ACNNTR = '1'B;         /* SET ACCTNMBR FLAG           */
         OI    ACNNTR,B'10000000'                                  0119
*              APDE = ADDR(ACCTNO);   /* SAVE ACCTNMBR PDE           */
         LA    @10,ACCTNO                                          0120
         ST    @10,APDE                                            0120
*              END;                                                0121
*          DPLPTR = ADDR(DPL);        /* POINT TO DELETE POINT LIST  */
@RF00117 LA    @10,DPL                                             0122
         ST    @10,DPLPTR                                          0122
*          /* USERID ENTRY SYNTAX CHECK                              */
*          IF PWDNTR = '0'B           /* CHK FOR PASSWD ENTRY OR     */
*           & DATLIN = '0'B           /* DATALIST ENTRY              */
*            THEN                     /* NEITHER,                    */
         TM    PWDNTR,B'01000100'                                  0123
         BNZ   @RF00123                                            0123
*              DADP = ADDR(DUSRID1);  /* SET ASSIGNED DELETE POINT   */
         LA    @10,DUSRID1                                         0124
         ST    @10,DADP                                            0124
*          DUSRID1 = ADDR(UPDE);      /* SET PTR TO FIRST NAME PDE   */
@RF00123 LA    @10,UPDE                                            0125
         ST    @10,DUSRID1                                         0125
*          DUSRIDN = ADDR(UPDE);      /* SET PTR TO CURRENT NAME PDE */
         ST    @10,DUSRIDN                                         0126
*          IF USRID(1) = '*'          /* WAS * ENTERED FOR USERID?   */
*            THEN                     /* YES,                        */
         CLI   USRID,C'*'                                          0127
         BNE   @RF00127                                            0127
*              DUCLSF1 = '1'B;        /* SET FLAG FOR ORIGINAL *     */
         OI    DUCLSF1,B'10000000'                                 0128
*            ELSE                                                  0129
*              DO;                                                 0129
         B     @RC00127                                            0129
@RF00127 DS    0H                                                  0130
*              DUSRDTN = 1;           /* SET TOTAL NAME COUNT        */
         LA    @10,1                                               0130
         STH   @10,DUSRDTN                                         0130
*              DUSRDCN = 1;           /* SET CURRENT NAME NUMBER     */
         STH   @10,DUSRDCN                                         0131
*              END;                                                0132
*          /* PASSWORD ENTRY SYNTAX CHECK                            */
*          /* CHK IF PASSWORD ENTERED                                */
*          IF PWDNTR = '0'B           /* CHK ENTRY FLAG              */
*            THEN                     /* NO,                         */
@RC00127 TM    PWDNTR,B'00000100'                                  0133
         BZ    @RT00133                                            0133
*              GOTO  DATLCHK;         /* GO TO CHK FOR DATA LIST     */
*          IF ACNNTR = '0'B           /* CHK FOR ACCTNMBR ENTRY OR   */
*           & DATLIN = '0'B           /* DATALIST ENTRY              */
*            THEN                     /* NEITHER,                    */
         TM    ACNNTR,B'11000000'                                  0135
         BNZ   @RF00135                                            0135
*              DADP = ADDR(DPASWD1);  /* SET ASSIGNED DP             */
         LA    @10,DPASWD1                                         0136
         ST    @10,DADP                                            0136
*          DPASWD1 = ADDR(PPDE);      /* SET PTR TO FIRST PASSWORD   */
@RF00135 LA    @10,PPDE                                            0137
         ST    @10,DPASWD1                                         0137
*          DPASWDN = ADDR(PPDE);      /* SET PTR TO CURRENT NAME PDE */
         ST    @10,DPASWDN                                         0138
*          IF PASSWD(1) = '*'         /* WAS * ENTERED FOR PASSWORD  */
*            THEN                     /* YES,                        */
         CLI   PASSWD,C'*'                                         0139
         BNE   @RF00139                                            0139
*              DPCLSF1 = '1'B;        /* SET * (NOT NAME) FLAG       */
         OI    DPCLSF1,B'10000000'                                 0140
*            ELSE                     /* NO, NOT ASTERISK            */
*              DO;                                                 0141
         B     @RC00139                                            0141
@RF00139 DS    0H                                                  0142
*              PLEN = 8;              /* SET LENGTH OF PASSWORD      */
         MVC   PLEN(2),@CH00046                                    0142
*              DPSWDTN = 1;           /* SET TOTAL PSWD COUNT TO 1   */
         LA    @10,1                                               0143
         STH   @10,DPSWDTN                                         0143
*              DPSWDCN = 1;           /* SET CURRENT PSWD NMBR TO 1  */
         STH   @10,DPSWDCN                                         0144
*              END;                                                0145
*          /* ACCOUNT NUMBER ENTRY SYNTAX CHECK                      */
*          IF ACNNTR = '0'B           /* WAS ACCNT NUM SPECIFIED?    */
*            THEN                     /* NO,                         */
@RC00139 TM    ACNNTR,B'10000000'                                  0146
         BZ    @RT00146                                            0146
*              GOTO  DATLCHK;         /* GO TO CHK FOR DATA LIST     */
*          IF DATLIN = '0'B           /* WAS DATALIST ENTERED        */
*            THEN                     /* NO,                         */
         TM    DATLIN,B'01000000'                                  0148
         BNZ   @RF00148                                            0148
*              DADP = ADDR(DACCTN1);  /* SET ASSIGNED DP             */
         LA    @10,DACCTN1                                         0149
         ST    @10,DADP                                            0149
*          DACCTN1 = ADDR(APDE);      /* SET PTR TO FIRST NAME PDE   */
@RF00148 LA    @10,APDE                                            0150
         ST    @10,DACCTN1                                         0150
*          DACCTNN = ADDR(APDE);      /* SET PTR TO CURRENT NAME PDE */
         ST    @10,DACCTNN                                         0151
*          IF ACCTNO(1:2) = '* '      /* WAS * ENTERED FOR ACCT NMBR?*/
*            THEN                     /* YES,                        */
         CLC   ACCTNO(2),@CC00361                                  0152
         BNE   @RF00152                                            0152
*              DACLSF1 = '1'B;        /* SET * (NOT NAME) FLAG       */
         OI    DACLSF1,B'10000000'                                 0153
*            ELSE                     /* NO, NOT ASTERISK            */
*              DO;                                                 0154
         B     @RC00152                                            0154
@RF00152 DS    0H                                                  0155
*              ALEN = ACTLEN;         /* GET LENGTH OF ACCT NO.      */
         SLR   @10,@10                                             0155
         IC    @10,ACTLEN                                          0155
         STH   @10,ALEN                                            0155
*              DACCTTN = 1;           /* SET TOTAL ACCT COUNT TO 1   */
         LA    @10,1                                               0156
         STH   @10,DACCTTN                                         0156
*              DACCTCN = 1;           /* SET CURRENT ACCT NMBR TO 1  */
         STH   @10,DACCTCN                                         0157
*              END;                                                0158
*DATLCHK:  /* PROCESS DATALIST IF ANY DATALIST ENTRY                 */
*          IF DATLIN = '1'B           /* IF DATA LIST PRESENT        */
*            THEN                                                  0159
@RC00152 DS    0H                                                  0159
DATLCHK  TM    DATLIN,B'01000000'                                  0159
         BNO   @RF00159                                            0159
*              DO;                                                 0160
*              IF ACNNTR = '1'B       /* IF ACCT NUM SUPPLIED        */
*                THEN                 /* YES,                        */
         TM    ACNNTR,B'10000000'                                  0161
         BNO   @RF00161                                            0161
*                  DO;                                             0162
*                  PDEPTR = ADDR(PROCPDE);/* PTR TO DATALIST BUFFER  */
         L     PDEPTR,DELPDLAD                                     0163
         LA    PDEPTR,PROCPDE(,PDEPTR)                             0163
*                  DADP = ADDR(DROCNM1);/* SET ASSIGNED DELETE POINT */
         LA    @10,DROCNM1                                         0164
         ST    @10,DADP                                            0164
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */
         BAL   @14,COLLCT                                          0165
*                  GOTO  DENQ;        /* GO TO ENQUEUE ON SYSUADS    */
         B     DENQ                                                0166
*                  END;                                            0167
*              IF PWDNTR = '1'B       /* WAS PASSWORD SUPPLIED?      */
*                THEN                 /* YES,                        */
@RF00161 TM    PWDNTR,B'00000100'                                  0168
         BNO   @RF00168                                            0168
*                  DO;                                             0169
*                  PDEPTR = ADDR(ACCTPDE);/* PTR TO DATALIST BUFFER  */
         L     PDEPTR,DELPDLAD                                     0170
         LA    PDEPTR,ACCTPDE(,PDEPTR)                             0170
*                  DADP = ADDR(DACCTN1);/* SET ASSIGNED DP           */
         LA    @10,DACCTN1                                         0171
         ST    @10,DADP                                            0171
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */
         BAL   @14,COLLCT                                          0172
*                  GOTO  DENQ;        /* GO TO ENQUEUE ON SYSUADS    */
         B     DENQ                                                0173
*                  END;                                            0174
*                ELSE                 /* NO,                         */
*                  DO;                                             0175
@RF00168 DS    0H                                                  0176
*                  PDEPTR = ADDR(PASSPDE);/* PTR TO DATALIST BUFFER  */
         L     PDEPTR,DELPDLAD                                     0176
         LA    PDEPTR,PASSPDE(,PDEPTR)                             0176
*                  DADP = ADDR(DPASWD1);/* SET ASSIGNED DP           */
         LA    @10,DPASWD1                                         0177
         ST    @10,DADP                                            0177
*                  CALL  COLLCT;      /* GO TO COLLECT COUNT         */
         BAL   @14,COLLCT                                          0178
*                  END;                                            0179
*              END;                                                0180
*DENQ:     /* ENQUEUE SYSUADS-OPEN                                   */
*          DCDP = DADP;               /* FROM ASSIGNED DP            */
@RF00159 DS    0H                                                  0181
DENQ     L     @10,DADP                                            0181
         ST    @10,DCDP                                            0181
*          GEN (ENQ   ,MF=(E,NQOPN))                               0182
*            REFS(EQNAM1,ERNAM1,NQOPN);                            0182
         ENQ   ,MF=(E,NQOPN)
*          ENQFLG = '1'B;             /* SET ENQUEUE FLAG            */
         OI    ENQFLG,B'00010000'                                  0183
*          /* CHK IF USERID ENTERED AS ASTERISK, IF SO, OPEN DCB     */
*          /*      FOR DIRECTORY READ                                */
*          /* ESTABLISH DSECT ADDRESSABILITY                         */
*          RFY R2 RSTD;               /* RESTRICT DSECT REGISTER     */
*          GEN (USING IHADCB,R2)                                   0185
*            REFS(R2);                                             0185
         USING IHADCB,R2
*          IF DUCLSF1 = '1'B          /* CHK FOR ASTERISK FLAG       */
*            THEN                     /* YES, OPEN DCB               */
         TM    DUCLSF1,B'10000000'                                 0186
         BNO   @RF00186                                            0186
*              DO;                                                 0187
*              R2 = ADDR(DIRDCB);     /* SET PTR TO DCB              */
         LA    R2,DIRDCB                                           0188
*              /* ISSUE OPEN                                         */
*              GEN (OPEN  ((R2),INPUT),MF=(E,DLOPNL))              0189
*                REFS(DLOPNL,R2);                                  0189
         OPEN  ((R2),INPUT),MF=(E,DLOPNL)
*              IF DCBOFLG = '0'B      /* WAS OPEN SUCCESFUL?         */
*                THEN                 /* NO,                         */
         TM    DCBOFLG,B'00010000'                                 0190
         BNZ   @RF00190                                            0190
*                  DO;                                             0191
*                  MSGNO  =  3;       /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00211                                   0192
*                  GOTO  ERRMSG;      /* GO TO SET ERROR MESSAGE     */
         B     ERRMSG                                              0193
*                  END;                                            0194
*              /* DO PRIME-READ TO IDENTIFY FIRST MEMBER NAME        */
*              ACIOFL03  =  '1'B;     /* SET WORK AREA INDICATOR     */
@RF00190 OI    ACIOFL03,B'00100000'                                0195
*              ACIODRCT = ADDR(DIRWA);/* PTR TO DIRECTORY WORK AREA  */
         LA    @10,DIRWA                                           0196
         ST    @10,ACIODRCT                                        0196
*              END;                                                0197
*            ELSE                     /* USERID WAS SPECIFIED        */
*              DO;                                                 0198
         B     @RC00186                                            0198
@RF00186 DS    0H                                                  0199
*              ACIOMPTR = ADDR(USRID);/* PTR TO SPECIFIC USERID      */
         LA    @10,USRID                                           0199
         ST    @10,ACIOMPTR                                        0199
*              USRID(USRLEN+1) = '0'; /* ZERO FOR FIRST MEMBER       */
         SLR   @10,@10                                             0200
         IC    @10,USRLEN                                          0200
         LA    @03,USRID(@10)                                      0200
         MVI   0(@03),C'0'                                         0200
*              END;                                                0201
*          R2 = ADDR(DELDCB);         /* SET PTR TO DCB              */
@RC00186 LA    R2,DELDCB                                           0202
*          /* OPEN UADS DCB FOR READ/WRITE MEMBER                    */
*          GEN (OPEN  ((R2),UPDAT),MF=(E,DLOPNL))                  0203
*            REFS(DLOPNL,R2);                                      0203
         OPEN  ((R2),UPDAT),MF=(E,DLOPNL)
*          IF DCBOFLG = '0'B          /* WAS OPEN SUCCESSFUL?        */
*            THEN                     /* NO,                         */
         TM    DCBOFLG,B'00010000'                                 0204
         BNZ   @RF00204                                            0204
*              DO;                                                 0205
*              MSGNO  =  3;           /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00211                                   0206
*              GOTO  ERRMSG;          /* GO TO SET ERROR MESSAGE     */
         B     ERRMSG                                              0207
*              END;                                                0208
*          /* DROP DSECT ADDRESSABILITY                             */
*          GEN REFS(R2) (DROP R2);                                 0209
@RF00204 DS    0H                                                  0209
         DROP R2
*          RFY R2 UNRSTD;             /* RELEASE DSECT POINTER       */
*          GOTO READ;                 /* SKIP CHECK FOR MORE USERS   */
         B     READ                                                0211
*QUITCHK:  /* CHECK IF USERID WAS SPECIFIED AS '*'                   */
*          IF DUCLSF1 = '0'B          /* USERID WAS SPECIFIED        */
*            THEN                     /* YES,                        */
QUITCHK  TM    DUCLSF1,B'10000000'                                 0212
         BZ    @RT00212                                            0212
*              GOTO  DELCHK;          /* TERMINATE DELETE ACTIVITY   */
*READ:     /* CHK IF TERMINATION IS INDICATED BY ACCOUNT             */
*          IF ATTENTN = '1'B          /* CHK ECB COMPLETE FLAG       */
*            THEN                     /* YES,                        */
READ     L     @10,ACCTECBP(,ACCTPLP)                              0214
         TM    ATTENTN(@10),B'01000000'                            0214
         BO    @RT00214                                            0214
*              GOTO  DOCLOS;          /* TERMINATE DELETE ACTIVITY   */
*          /* CHK IF NECESSARY TO FREE READ BUFFER                   */
*          IF RDDONE = '1'B           /* CHK FOR READ BUFFER FLAG    */
*            THEN                     /* NO,                         */
         TM    RDDONE,B'00000010'                                  0216
         BNO   @RF00216                                            0216
*              DO;                                                 0217
*              ACIOFL05 = '0'B;       /* SET NO-WRITE FLAG           */
         NI    ACIOFL05,B'11110111'                                0218
*              CALL DOWRITE;          /* GO TO FREE READ BUFFER      */
         BAL   @14,DOWRITE                                         0219
*              END;                                                0220
*          CALL DOREAD;               /* READ USER                   */
@RF00216 BAL   @14,DOREAD                                          0221
*          /* ENQUEUE ON THE USER NAME.  IF ENQUEUE FAILS, GO TO ISSUE
*          ERROR TERMINATION MESSAGE.  IF ENQUEUE SUCCEEDS, WRITE  0222
*          REVISED MEMBER BACK INTO UADS.   DEQUEUE THE MEMBER     0222
*          NAME AND GO TO CHECK IF MORE ACTIVITY IS SCHEDULED BY   0222
*          THIS COMMAND ENTRY                                        */
*          /* ENQUEUE SYSUADS-MEMBERNAME                             */
*          GEN  (ENQ   (,USRLEN),MF=(E,NQMBR))                     0222
*            REFS(EQNAM1,NQMBR,USRLEN);                            0222
         ENQ   (,USRLEN),MF=(E,NQMBR)
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0224
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE ^= 0           /* IS CODE UNSUCCESSFUL CODE   */
*            THEN                                                  0226
         LTR   RETNCODE,RETNCODE                                   0226
         BZ    @RF00226                                            0226
*              DO;                                                 0227
*              IF RCLC1 = 4           /* IF USERID ALREADY ENQUEUED  */
*                THEN                 /* YES,                        */
         CLI   RCLC1(RETNCODE),4                                   0228
         BE    @RT00228                                            0228
*                  GOTO  ENQERR;      /* INDICATE USERID ACTIVE      */
*                ELSE                 /* BAD RETURN CODE FROM ENQUEUE*/
*                  DO;                                             0230
*                  RETNCODE = RCLC1;  /* SAVE ENQUEUE RETURN CODE    */
         SLR   @10,@10                                             0231
         IC    @10,RCLC1(,RETNCODE)                                0231
         LR    RETNCODE,@10                                        0231
*                  MSGNO = 18;        /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00376                                   0232
*                  GOTO SYSERRD;      /* GO TO ISSUE ERROR MESSAGE   */
         B     SYSERRD                                             0233
*                  END;                                            0234
*              END;                                                0235
*          IF DADP = ADDR(DUSRID1)    /* IS USERID THE DELETE LEVEL? */
*            THEN                     /* YES                         */
@RF00226 LA    @10,DUSRID1                                         0236
         C     @10,DADP                                            0236
         BNE   @RF00236                                            0236
*              DO;                                                 0237
*              CALL DELSTO;           /* STOW DELETE THE USERID      */
         BAL   @14,DELSTO                                          0238
*              GOTO DOCLOS;           /* GO TO TERMINATION           */
         B     DOCLOS                                              0239
*              END;                                                0240
*          RFY R1 RSTD;               /* RESTRICT REG 1              */
@RF00236 DS    0H                                                  0242
*          R1  =  ADDR(COMAREA);      /* POINT TO COMMUNICATION AREA */
         LA    R1,COMAREA                                          0242
*          CALL IKJEFA32;             /* FIND DELETE POINT           */
         L     @15,@CV00070                                        0243
         BALR  @14,@15                                             0243
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0246
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF MSGNO ^= 0              /* IS CODE SUCCESSFUL CODE     */
*            THEN                     /* NO,                         */
         LH    @10,MSGNO                                           0248
         LTR   @10,@10                                             0248
         BZ    @RF00248                                            0248
*              DO;                                                 0249
*              ACIOFL05 = '0'B;       /* CLEAR WRITE REQUEST FLAG    */
         NI    ACIOFL05,B'11110111'                                0250
*              CALL DOWRITE;          /* GO TO FREE/DEQUEUE          */
         BAL   @14,DOWRITE                                         0251
*              IF MSGNO = 25          /* WAS SYSTEM ERROR DETECTED   */
*                THEN                 /* YES,                        */
         LH    @10,MSGNO                                           0252
         CH    @10,@CH00378                                        0252
         BE    @RT00252                                            0252
*                  GOTO SYSERRD;                                   0253
*              /* CHK FOR USERID ASTERISK ENTRY                      */
*              IF DUCLSF1 = '1'B      /* CHK FOR USERID ASTERISK     */
*                THEN                 /* YES,                        */
         TM    DUCLSF1,B'10000000'                                 0254
         BO    @RT00254                                            0254
*                  GOTO  READ;        /* GO TO GET NEXT MEMBER       */
*              IF MSGNO = 10          /* WAS PASSWORD NOT SUPPORTED? */
*               × MSGNO = 11          /* OR ACCNT NUM NOT SUPPORTED? */
*                THEN                 /* YES,                        */
         CH    @10,@CH00379                                        0256
         BE    @RT00256                                            0256
         CH    @10,@CH00380                                        0256
         BNE   @RF00256                                            0256
@RT00256 DS    0H                                                  0257
*                  DO;                                             0257
*                  CALL MSGFNDR;      /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0258
*                  TMSGTIL1 = USRLEN+4;/* SET LENGTH OF INSERT       */
         SLR   @10,@10                                             0259
         IC    @10,USRLEN                                          0259
         LA    @15,4                                               0259
         ALR   @15,@10                                             0259
         STH   @15,TMSGTIL1                                        0259
*                  TMSGTIO1 = 26;     /* SET TEXT OFFSET             */
         MVC   TMSGTIO1(2),@CH00382                                0260
*                  TMSGTIN1(1:USRLEN) = USRID;/* INSERT NAME IN SEG  */
         BCTR  @10,0                                               0261
         EX    @10,@SM00445                                        0261
*                  SEGPTR13 = ADDR(TMSGTIX1);/* SET PTR TO SEGMENT   */
         LA    @10,TMSGTIX1                                        0262
         ST    @10,SEGPTR13                                        0262
*                  GOTO  MSGNGRM;     /* GO TO ERROR EXIT            */
         B     MSGNGRM                                             0263
*                  END;                                            0264
*              GOTO DELCHK;           /* CHECK RESULTS               */
         B     DELCHK                                              0265
*              END;                                                0266
*          ACIOFL05  =  '1'B;         /* SET WRITE REQUEST FLAG      */
@RF00248 OI    ACIOFL05,B'00001000'                                0267
*          IF DELUSER = '1'B          /* CHK FOR USERID DELETION     */
*            THEN                     /* NONE                        */
         TM    DELUSER,B'10000000'                                 0268
         BNO   @RF00268                                            0268
*              CALL DELSTO;           /* GO TO DELETE MEMBER         */
         BAL   @14,DELSTO                                          0269
*            ELSE                     /* SUBLEVEL REMAINS            */
*              CALL DOWRITE;          /* GO TO WRITE UPDATED MEMBER  */
         B     @RC00268                                            0270
@RF00268 BAL   @14,DOWRITE                                         0270
*          GOTO QUITCHK;              /* GO TO TEST FOR MORE USERIDS */
         B     QUITCHK                                             0271
*DELCHK:   /* EP TO INDICATE DELETE STATUS OF NAME ITEM              */
*          /* CHK FOR PASSWORD SUPPORT FAILURE                       */
*          IF DUCLSF1 = '1'B          /* CHK FOR USERID = *          */
*           & DPCLSF1 = '0'B          /* AND FOR SPECIFIC PASSWORD   */
*           & GPWDSP = '0'B           /* AND SUPPORT FLAG NOT SET    */
*            THEN                     /* YES,                        */
DELCHK   TM    DUCLSF1,B'10000000'                                 0272
         BNO   @RF00272                                            0272
         TM    DPCLSF1,B'10000000'                                 0272
         BNZ   @RF00272                                            0272
         TM    GPWDSP,B'01000000'                                  0272
         BNZ   @RF00272                                            0272
*              DO;                                                 0273
*              MSGNO = 12;            /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00130                                   0274
*              GOTO ERRMSG;           /* GO TO ISSUE ERROR MSG       */
         B     ERRMSG                                              0275
*              END;                                                0276
*          /* CHK FOR ACCOUNT NUMBER SUPPORT FAILURE                 */
*          IF DUCLSF1 = '1'B          /* CHK FOR USERID = *          */
*           & DACLSF1 = '0'B          /* AND FOR SPECIFIC ACCTNUM    */
*           & GACNSP = '0'B           /* AND SUPPORT FLAG NOT SET    */
*            THEN                     /* YES,                        */
@RF00272 TM    DUCLSF1,B'10000000'                                 0277
         BNO   @RF00277                                            0277
         TM    DACLSF1,B'10000000'                                 0277
         BNZ   @RF00277                                            0277
         TM    GACNSP,B'00100000'                                  0277
         BNZ   @RF00277                                            0277
*              DO;                                                 0278
*              MSGNO = 13;            /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00042                                   0279
*              GOTO ERRMSG;           /* GO TO ISSUE ERROR MSG       */
         B     ERRMSG                                              0280
*              END;                                                0281
*          DNMIDP = ADDR(DPASWD1);    /* SET PROTO-DPL PTR TO LEVEL  */
@RF00277 LA    DNMIDP,DPASWD1                                      0282
*          MSGNO = 15;                /* SET PASSWORD MESSAGE INDEX  */
         MVC   MSGNO(2),@CH00109                                   0283
*          DO WHILE DNMIDP <= DADP;   /* LOOP FOR EACH LEVEL         */
         B     @DE00284                                            0284
@DL00284 DS    0H                                                  0285
*            TSTCTN = 0;              /* CLEAR TEST COUNTER          */
         SLR   TSTCTN,TSTCTN                                       0285
*            PDEPTR = NAMID1;         /* SET PDE PTR TO INITIAL PDE  */
         L     PDEPTR,NAMID1(,DNMIDP)                              0286
*            DO WHILE TSTCTN < NMDTN1 /* LOOP FOR ALL ITEMS          */
*             & NMFLG11 = '0'B;       /* WITH NAME SUPPLIED          */
         B     @DE00287                                            0287
@DL00287 DS    0H                                                  0288
*              TSTCTN = TSTCTN+1;     /* STEP COUNTER                */
         AH    TSTCTN,@CH00032                                     0288
*              IF NAMFLGF = '0'B      /* CHK FOR SUCCESSFUL FIND     */
*                THEN                 /* NO,                         */
         TM    NAMFLGF(PDEPTR),B'00000010'                         0289
         BNZ   @RF00289                                            0289
*                  DO;                                             0290
*                  DELERR = '1'B;     /* SET ERROR FLAG              */
         OI    DELERR,B'00100000'                                  0291
*                  CALL  MSGFNDR;     /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0292
*                  /* SET UP NAME IMAGE                              */
*                  TMSGTIL1 = NAMLNG+4; /* EXTRACT LENGTH            */
         SLR   @10,@10                                             0293
         ICM   @10,3,NAMLNG(PDEPTR)                                0293
         LA    @15,4                                               0293
         ALR   @15,@10                                             0293
         STH   @15,TMSGTIL1                                        0293
*                  TMSGTIO1 = 11;     /* SET INSERTION OFFSET        */
         MVC   TMSGTIO1(2),@CH00380                                0294
*                  TMSGTIN1(1:NAMLNG) = NAMPTRC; /* SET NAME IN SEG  */
         BCTR  @10,0                                               0295
         L     @01,NAMPTR1(,PDEPTR)                                0295
         EX    @10,@SM00448                                        0295
*                  SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG */
         LA    @10,TMSGTIX1                                        0296
         ST    @10,SEGPTR13                                        0296
*                  CALL DOPUTL;       /* GO TO ISSUE ERROR MSG       */
         BAL   @14,DOPUTL                                          0297
*                  END;                                            0298
*              PDEPTR = NPTRNEX;      /* POINT TO NEXT PDE           */
@RF00289 SLR   @10,@10                                             0299
         ICM   @10,7,NPTRNEX(PDEPTR)                               0299
         LR    PDEPTR,@10                                          0299
*            END;                                                  0300
@DE00287 SLR   @10,@10                                             0300
         ICM   @10,3,NMDTN1(DNMIDP)                                0300
         CLR   TSTCTN,@10                                          0300
         BNL   @DC00287                                            0300
         TM    NMFLG11(DNMIDP),B'10000000'                         0300
         BZ    @DL00287                                            0300
@DC00287 DS    0H                                                  0301
*            IF DELERR = '1'B         /* HAS AN ERROR BEEN DETECTED? */
*              THEN                   /* YES,                        */
         TM    DELERR,B'00100000'                                  0301
         BO    @RT00301                                            0301
*                GOTO DOCLOS;         /* GO TO TERMINATION           */
*            MSGNO = MSGNO+1;         /* INCREMENT MESSAGE NUMBER    */
         LA    @10,1                                               0303
         AH    @10,MSGNO                                           0303
         STH   @10,MSGNO                                           0303
*            DNMIDP = DNMIDP+LSPAN;   /* STEP TO THE NEXT LEVEL      */
         AL    DNMIDP,LSPAN                                        0304
*            END;                                                  0305
@DE00284 C     DNMIDP,DADP                                         0305
         BNH   @DL00284                                            0305
*          GOTO DOCLOS;               /* GO TO TERMINATION           */
         B     DOCLOS                                              0306
*NOSPAZ:   /* GETMAIN FAILURE INDICATOR                              */
*          /* CHK IF USERID ENTRY WAS ASTERISK                       */
*          IF DUCLSF1 = '0'B          /* CHK FOR ASTERISK            */
*           × ACIOLINK = 0            /* OR BLDL FAILED              */
*            THEN                     /* NO,                         */
NOSPAZ   TM    DUCLSF1,B'10000000'                                 0307
         BZ    @RT00307                                            0307
         L     @10,ACIOLINK                                        0307
         LTR   @10,@10                                             0307
         BNZ   @RF00307                                            0307
@RT00307 DS    0H                                                  0308
*              DO;                                                 0308
*              MSGNO = 1;             /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00032                                   0309
*              CALL  MSGFNDR;         /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0310
*              GOTO  MSGNGRM;         /* GO TO ERROR EXIT            */
         B     MSGNGRM                                             0311
*              END;                                                0312
*          MSGNO = 22;                /* SET MESSAGE INDEX           */
@RF00307 MVC   MSGNO(2),@CH00387                                   0313
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0314
*          TMSGTIL1 = USRLEN+4;       /* SET LENGTH OF INSERT        */
         SLR   @10,@10                                             0315
         IC    @10,USRLEN                                          0315
         LA    @05,4                                               0315
         ALR   @05,@10                                             0315
         STH   @05,TMSGTIL1                                        0315
*          TMSGTIO1 = 37;             /* SET TEXT OFFSET             */
         MVC   TMSGTIO1(2),@CH00388                                0316
*          TMSGTIN1(1:USRLEN) = USRID;/* INSERT NAME IN SEGMENT      */
         BCTR  @10,0                                               0317
         EX    @10,@SM00445                                        0317
*          SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO SEGMENT          */
         LA    @10,TMSGTIX1                                        0318
         ST    @10,SEGPTR13                                        0318
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */
         BAL   @14,DOPUTL                                          0319
*          GOTO  QUITCHK;             /* GO TO EXIT                  */
         B     QUITCHK                                             0320
*ENQERR:   /* INDICATE ENQUEUE FAILURE                               */
*          MSGNO  = 6;                /* SET MESSAGE INDEX           */
ENQERR   MVC   MSGNO(2),@CH00389                                   0321
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0322
*          TMSGTIL1 = USRLEN+4;       /* SET LENGTH OF INSERT        */
         SLR   @10,@10                                             0323
         IC    @10,USRLEN                                          0323
         LA    @15,4                                               0323
         ALR   @15,@10                                             0323
         STH   @15,TMSGTIL1                                        0323
*          TMSGTIO1 = 35;             /* SET INSERTION OFFSET        */
         MVC   TMSGTIO1(2),@CH00391                                0324
*          TMSGTIN1(1:USRLEN) =       /* SET NAME IN SEGMENT AREA    */
*            USRID(1:USRLEN);                                      0325
         BCTR  @10,0                                               0325
         EX    @10,@SM00445                                        0325
*          SEGPTR12 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEGMENT     */
         LA    @10,TMSGTIX1                                        0326
         ST    @10,SEGPTR12                                        0326
*          IF DUCLSF1 = '0'B          /* CHK FOR USERID ASTERISK     */
*            THEN                     /* NO,                         */
         TM    DUCLSF1,B'10000000'                                 0327
         BZ    @RT00327                                            0327
*              GOTO  MSGNGRM;         /* GO TO ERROR EXIT            */
*          CALL  DOPUTL;              /* GO TO ISSUE MESSAGE         */
         BAL   @14,DOPUTL                                          0329
*          GOTO  QUITCHK;             /* GO TO GET NEXT MEMBER       */
         B     QUITCHK                                             0330
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*  S Y S E R R D :   CALL MSGFNDR TO OBTAIN PTR TO THE MESSAGE    */
* /*     SEGMENT LIST.  UNPACK THE THREE RETURN CODE CHARACTERS      */
* /*     OUT OF THE RETURN CODE SAVE AREA (RETNCODE)  INTO THE       */
* /*     INSERT TEXT AREA (TMSGTIN1) AND TRANSLATE THEM INTO EBCDIC  */
* /*     CHARACTERS.                                                 */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*SYSERRD:  /* SYSTEM ERROR MESSAGE ROUTINE EP                        */
*          CALL MSGFNDR;              /* GO TO LOCATE MESSAGE        */
SYSERRD  BAL   @14,MSGFNDR                                         0331
*          RFY R1 RSTD;               /* RESTRICT REG 1              */
*          R1 = RETNCODE;             /* GET RETURN CODE             */
         LR    R1,RETNCODE                                         0333
*          /* UNPACK AND TRANSLATE HEXIDECIMAL CHARACTERS            */
*          CVD  (RETNCODE,DBLWORD);                                0334
         CVD   RETNCODE,DBLWORD                                    0334
*          UNPK (TMSGTIN1(1:2),DBLWORD(6:8));                      0335
         UNPK  TMSGTIN1(2),DBLWORD+5(3)                            0335
*          TMSGTIN1(2) = TMSGTIN1(2)×'F0'X;                        0336
         OI    TMSGTIN1+1,X'F0'                                    0336
*          SEGPTR23 = ADDR(TMSGTIX1); /* SET MESSAGE POINTER         */
         LA    @10,TMSGTIX1                                        0337
         ST    @10,SEGPTR23                                        0337
*          TMSGTIL1 = 6;              /* SET LENGTH OF SEGMENT       */
         MVC   TMSGTIL1(2),@CH00389                                0338
*          TMSGTIO1 = 22;             /* SET INSERT OFFSET           */
         MVC   TMSGTIO1(2),@CH00387                                0339
*          GOTO MSGNGRM;              /* GO TO ISSUE MESSAGE         */
         B     MSGNGRM                                             0340
*ERRMSG:   /* ENTRY POINT TO ISSUE ERROR MESSAGE                     */
*          CALL MSGFNDR;              /* BUILD MESSAGE               */
ERRMSG   BAL   @14,MSGFNDR                                         0341
*MSGNGRM:  /* ENTRY POINT TO ISSUE COMPLETED ERROR MESSAGE           */
*          CALL  DOPUTL;              /* GO TO ISSUE MESSAGE         */
MSGNGRM  BAL   @14,DOPUTL                                          0342
*          DELERR = '1'B;             /* SET NO SUCCESS MESSAGE FLAG */
         OI    DELERR,B'00100000'                                  0343
*DOCLOS:   /* EP TO DO CLOSE UADS DCB AND DIRECTORY DCB              */
*          /* CHK IF NECESSARY TO FREE READ BUFFER                   */
*          IF RDDONE = '1'B           /* CHK FOR READ BUFFER FLAG    */
*            THEN                     /* NO,                         */
DOCLOS   TM    RDDONE,B'00000010'                                  0344
         BNO   @RF00344                                            0344
*              DO;                                                 0345
*              ACIOFL05 = '0'B;       /* SET NO-WRITE FLAG           */
         NI    ACIOFL05,B'11110111'                                0346
*              CALL DOWRITE;          /* GO TO FREE READ BUFFER      */
         BAL   @14,DOWRITE                                         0347
*              END;                                                0348
*          IF DELPDLAD ^= 0           /* IS THERE A PDL TO FREE?     */
*            THEN                     /* YES,                        */
@RF00344 L     @10,DELPDLAD                                        0349
         LTR   @10,@10                                             0349
         BZ    @RF00349                                            0349
*              /* ISSUE IKJRLSA MACRO TO RELEASE PDL                 */
*              GEN (IKJRLSA DELPDLAD) /* FREE THE PDL SPACE          */
*                REFS(DELPDLAD);                                   0350
         IKJRLSA DELPDLAD
*          DELPDLAD = 0;              /* CLEAR PDL POINTER           */
@RF00349 SLR   @10,@10                                             0351
         ST    @10,DELPDLAD                                        0351
*          IF PCLPTR ^= 0             /* IS THERE A PCL TO FREE?     */
*            THEN                     /* YES,                        */
         C     @10,PCLPTR                                          0352
         BE    @RF00352                                            0352
*              /* ISSUE FREEMAIN MACRO TO RELEASE DYNAMIC PCL        */
*              GEN (FREEMAIN A=PCLPTR,MF=(E,FMLST))                0353
*                REFS(FMLST,PCLPTR,PLENGTH);                       0353
         FREEMAIN A=PCLPTR,MF=(E,FMLST)
*          PCLPTR = 0;                /* CLEAR PCL POINTER           */
@RF00352 SLR   @10,@10                                             0354
         ST    @10,PCLPTR                                          0354
*          RFY R2 RSTD;               /* RESTRICT DSECT REGISTER     */
*          /* ESTABLISH DESECT ADDRESSABILITY                        */
*          GEN (USING IHADCB,R2)      /* ESTABLISH DSECT ADDRESSABILI*/
*            REFS(R2);                                             0356
         USING IHADCB,R2
*          R2 = ADDR(DIRDCB);         /* SET PTR TO DCB              */
         LA    R2,DIRDCB                                           0357
*          IF DCBOFLG = '1'B          /* CHK FOR OPEN FLAG IN DCB    */
*            THEN                     /* YES, CLOSE                  */
         TM    DCBOFLG,B'00010000'                                 0358
         BNO   @RF00358                                            0358
*              /* CLOSE DIRECTORY DCB                                */
*              GEN (CLOSE ((R2),),MF=(E,DLCLSL))                   0359
*                REFS(DLCLSL,R2);                                  0359
         CLOSE ((R2),),MF=(E,DLCLSL)
*          R2 = ADDR(DELDCB);         /* SET PTR TO UADS DCB         */
@RF00358 LA    R2,DELDCB                                           0360
*          IF DCBOFLG = '1'B          /* CHK FOR OPEN FLAG IN DCB    */
*            THEN                     /* YES, CLOSE                  */
         TM    DCBOFLG,B'00010000'                                 0361
         BNO   @RF00361                                            0361
*              /* CLOSE UADS DCB                                     */
*              GEN (CLOSE ((R2),),MF=(E,DLCLSL))                   0362
*                REFS(DLCLSL,R2);                                  0362
         CLOSE ((R2),),MF=(E,DLCLSL)
*          /* DROP DSECT ADDRESSABILITY                              */
*          GEN (DROP R2);                                          0363
@RF00361 DS    0H                                                  0363
         DROP R2
*          RFY R2 UNRSTD;             /* RELEASE DSECT POINTER       */
*          IF ENQFLG = '1'B           /* IS UADS ENQUEUED?           */
*            THEN                     /* YES,                        */
         TM    ENQFLG,B'00010000'                                  0365
         BNO   @RF00365                                            0365
*              GEN (DEQ   (,ERNAM1,8),MF=(E,DQLST))                0366
*                REFS(DQLST,EQNAM1,ERNAM1); /* DEQ SYSIKJUA-OPENUADS */
         DEQ   (,ERNAM1,8),MF=(E,DQLST)
*          IF DELERR = '1'B           /* CHK FOR ERROR FLAG          */
*            THEN                     /* YES,                        */
@RF00365 TM    DELERR,B'00100000'                                  0367
         BNO   @RF00367                                            0367
*              ACCTECB = '40FFFFFF'X;/* POST ACCOUNT ECB WITH ERR*/
         L     @10,ACCTECBP(,ACCTPLP)                              0368
         MVC   ACCTECB(4,@10),@CF00399                             0368
*            ELSE                                                  0369
*              IF DUCLSF1='1'B        /* IS USERID *?                */
*               × DELUSER='0'B        /* OR NO USERID DELETED?       */
*                THEN                 /* YES,                        */
         B     @RC00367                                            0369
@RF00367 TM    DUCLSF1,B'10000000'                                 0369
         BO    @RT00369                                            0369
         TM    DELUSER,B'10000000'                                 0369
         BNZ   @RF00369                                            0369
@RT00369 DS    0H                                                  0370
*                  DO;                /* ISSUE DELETED MESSAGE       */
*                  MSGNO = 8;         /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00046                                   0371
*                  CALL  MSGFNDR;     /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0372
*                  CALL  DOPUTL;      /* GO TO ISSUE PUTLINE         */
         BAL   @14,DOPUTL                                          0373
*                  END;                                            0374
*          RETURN CODE(0);            /* GO TO EXIT TO CALLER        */
@RF00369 DS    0H                                                  0375
@RC00367 L     @13,4(,@13)                                         0375
         L     @00,@SIZDATD                                        0375
         LR    @01,@11                                             0375
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                             0375
         L     @14,12(,@13)                                        0375
         LM    @00,@12,20(@13)                                     0375
         BR    @14                                                 0375
*          /* END OF DELETE  C P                                     */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*                                                                 */
* /*  D E L S T O :   EXECUTE STOW-DELETE TO REMOVE A DELETED        */
* /*    USERID MEMBER FROM THE UADS DIRECTORY                        */
* /*                                                                 */
* /*    FORM THE FIRST UADS-TYPE USERID NAME BY ADDING A CHARACTER   */
* /*    OF ZERO  DIRECTLY AFTER  THE BASIC NAME  CHARACTER STRING.   */
* /*    EXECUTE A STOW-DELETE ON THAT MODIFIED NAME.  IF THE STOW    */
* /*    IS SUCCESSFUL (RETURN CODE OF 0), ADD A VALUE OF 1 TO THE    */
* /*    APPENDED CHARACTER  IN THE USERID NAME  AND RE-ISSUE THE     */
* /*    STOW-DELETE.  REPEAT THIS SUCCESSFUL PROCESS UNTIL 9 MEMBER  */
* /*    BLOCKS (APPENDED CHARACTER 9) HAVE BEEN REMOVED,  THEN GO    */
* /*    TO DOBLDU TO EXIT                                            */
* /*                                                                 */
* /*    IF A RETURN CODE OF 8 IS RETURNED BEFORE NINE MEMBERS HAVE   */
* /*    BEEN REMOVED, CHECK IF APPENDED CHARACTER IS ZERO (FIRST     */
* /*    MEMBER) SIGNIFYING NO SUCH MEMBER NAME EXISTS IN THE UADS.   */
* /*    IF YES, GO TO ISSUE AN ERROR MESSAGE AND RETURN.  IF EXTENT  */
* /*    CHARACTER IS NOT ZERO, ALL MEMBER NAMES OF THAT USERID HAVE  */
* /*    BEEN REMOVED FROM THE DIRECTORY.  GO TO DOBLDU TO RETURN     */
* /*                                                                 */
* /*    IF RETURN CODE IS OTHER THAN 8,  ISSUE THE SYSTEM COMMAND    */
* /*    ERROR MESSAGE WITH STOW ERROR CODE                           */
* /*                                                                 */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*DELSTO:   /* EP TO STOW AND BUILD UDL ROUTINE                       */
*          PROC ;                                                  0376
@EL00001 L     @13,4(,@13)                                         0376
@EF00001 L     @00,@SIZDATD                                        0376
         LR    @01,@11                                             0376
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0376
         BR    @14                                                 0376
@PB00001 DS    0H                                                  0376
DELSTO   STM   @14,@03,@SA00002                                    0376
         STM   @05,@12,@SA00002+24                                 0376
*          STOLST = MEMNAME;          /* SET UP USERID NAME          */
         L     @10,ACIOLINK                                        0377
         MVC   STOLST(8),MEMNAME(@10)                              0377
*          /* SET UP NAME IMAGE                                      */
*          TMSGTIL1 = USRLEN+4;       /* EXTRACT LENGTH              */
         SLR   @05,@05                                             0378
         IC    @05,USRLEN                                          0378
         LA    @00,4                                               0378
         ALR   @00,@05                                             0378
         STH   @00,TMSGTIL1                                        0378
*          TMSGTIN1(1:USRLEN) = MEMNAME; /* SET NAME IN SEG.         */
         BCTR  @05,0                                               0379
         EX    @05,@SM00450                                        0379
*          /* DELETE CURRENT USERID FROM UADS                        */
*          /* EXECUTE STOW-DELETE                                    */
*          DO WHILE RETNCODE = 0;                                  0380
         B     @DE00380                                            0380
@DL00380 DS    0H                                                  0381
*            GEN (STOW  DELDCB,STOLST,D)                           0381
*              REFS(DELDCB,STOLST);                                0381
         STOW  DELDCB,STOLST,D
*            RFY R15 RSTD;            /* RESTRICT RETURN CODE REG    */
*            RETNCODE = R15;          /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0383
*            RFY R15 UNRSTD;          /* RELEASE RETURN CODE REG     */
*            STOLST(USRLEN+1) =                                    0385
*             STOLST(USRLEN+1)+1;     /* INCREMENT EXTENT NUMBER     */
         SLR   @10,@10                                             0385
         IC    @10,USRLEN                                          0385
         LA    @05,1                                               0385
         SLR   @00,@00                                             0385
         IC    @00,STOLST(@10)                                     0385
         ALR   @05,@00                                             0385
         STC   @05,STOLST(@10)                                     0385
*          END;                                                    0386
@DE00380 LTR   RETNCODE,RETNCODE                                   0386
         BZ    @DL00380                                            0386
*          IF RETNCODE ^= 8           /* CHK FOR FAILURE TO FIND ID  */
*            THEN                     /* YES,                        */
         CH    RETNCODE,@CH00046                                   0387
         BE    @RF00387                                            0387
*              DO;                                                 0388
*              IF RETNCODE = 16       /* IS THIS AN I/O ERROR        */
*                THEN                 /* YES                         */
         CH    RETNCODE,@CH00044                                   0389
         BNE   @RF00389                                            0389
*                  DO;                                             0390
*                  MSGNO = 7;         /* PUT OUT ERROR MESSAGE       */
         MVC   MSGNO(2),@CH00159                                   0391
*                  RETURN TO ERRMSG;  /* GO TO ISSUE MESSAGE         */
         LA    @14,ERRMSG                                          0392
         LM    @15,@03,@SA00002+4                                  0392
         LM    @05,@12,@SA00002+24                                 0392
         BR    @14                                                 0392
*                  END;                                            0393
*                ELSE                                              0394
*                  DO;                /* INVALID STOW RETURN CODE    */
@RF00389 DS    0H                                                  0395
*                  MSGNO = 14;        /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00403                                   0395
*                  RETURN TO  SYSERRD;/* GO TO ISSUE MESSAGE         */
         LA    @14,SYSERRD                                         0396
         LM    @15,@03,@SA00002+4                                  0396
         LM    @05,@12,@SA00002+24                                 0396
         BR    @14                                                 0396
*                  END;                                            0397
*              END;                                                0398
*          IF STOLST(USRLEN+1) = '0'  /* CHK IF FIRST EXTENT         */
*            THEN                     /* YES,                        */
@RF00387 SLR   @10,@10                                             0399
         IC    @10,USRLEN                                          0399
         LA    @15,STOLST(@10)                                     0399
         CLI   0(@15),C'0'                                         0399
         BNE   @RF00399                                            0399
*              DO;                                                 0400
*              MSGNO = 5;             /* SET USERID MESSAGE INDEX    */
         MVC   MSGNO(2),@CH00183                                   0401
*              CALL  MSGFNDR;         /* THEN LOCATE MESSAGE TEXT    */
         BAL   @14,MSGFNDR                                         0402
*              TMSGTIO1 = 11;         /* SET INSERTION OFFSET        */
         MVC   TMSGTIO1(2),@CH00380                                0403
*              SEGPTR13 = ADDR(TMSGTIX1);/* SET PTR TO NAME SEG.     */
         LA    @10,TMSGTIX1                                        0404
         ST    @10,SEGPTR13                                        0404
*              RETURN TO MSGNGRM;     /* GO TO ISSUE MESSAGE         */
         LA    @14,MSGNGRM                                         0405
         LM    @15,@03,@SA00002+4                                  0405
         LM    @05,@12,@SA00002+24                                 0405
         BR    @14                                                 0405
*              END;                                                0406
*          ACIOFL05 = '0'B;           /* CLEAR WRITE REQUEST FLAG    */
@RF00399 NI    ACIOFL05,B'11110111'                                0407
*          CALL DOWRITE;              /* CALL IKJEFA52 TO FREE CORE  */
         BAL   @14,DOWRITE                                         0408
*          IF DELUSER = '0'B          /* IS USERID THE DELETE LEVEL? */
*            THEN                     /* YES,                        */
         TM    DELUSER,B'10000000'                                 0409
         BZ    @RT00409                                            0409
*              GOTO DOBLDU;           /* SKIP USERID DELETED MESSAGE */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*     ISSUE THE USERID DELETED MESSAGE.                           */
* /*     IF THE USERID IS AN ASTERISK, BACKSPACE AND REREAD THE      */
* /*     DIRECTORY.                                                  */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*          /* ISSUE USERID DELETED MESSAGE                           */
*          MSGNO  =  9;               /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00405                                   0411
*          CALL  MSGFNDR;             /* GO TO LOCATE MESSAGE TEXT   */
         BAL   @14,MSGFNDR                                         0412
*          TMSGTIO1 = 17;             /* SET INSERT OFFSET           */
         MVC   TMSGTIO1(2),@CH00406                                0413
*          SEGPTR12 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG.        */
         LA    @10,TMSGTIX1                                        0414
         ST    @10,SEGPTR12                                        0414
*          CALL  DOPUTL;              /* GO TO ISSUE PUTLINE         */
         BAL   @14,DOPUTL                                          0415
*          IF DUCLSF1 = '0'B          /* USERID WAS SPECIFIED        */
*            THEN                     /* YES,                        */
         TM    DUCLSF1,B'10000000'                                 0416
         BZ    @RT00416                                            0416
*              GOTO  DOBLDU;          /* GO TO CREATE THE UIDL       */
*          NEXTNAME = NEXTUSER;       /* SAVE THE USERID OF THE NEXT
*                                        USER TO BE PROCESSED        */
         L     @10,ACIOMPTR                                        0418
         MVC   NEXTNAME(8),NEXTUSER(@10)                           0418
*BKSP:     /* SET TO REREAD PDS DIRECTORY BLOCK                      */
*          GEN REFS(DIRDCB) (BSP   DIRDCB);                        0419
BKSP     BSP   DIRDCB
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0421
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE ^= 0           /* CHK FOR ZERO CODE           */
*            THEN                     /* NO,                         */
         LTR   RETNCODE,RETNCODE                                   0423
         BZ    @RF00423                                            0423
*              DO;                                                 0424
*              MSGNO = 27;            /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00409                                   0425
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */
         LA    @14,SYSERRD                                         0426
         LM    @15,@03,@SA00002+4                                  0426
         LM    @05,@12,@SA00002+24                                 0426
         BR    @14                                                 0426
*              END;                                                0427
*          ACIOFL06 = '1'B;           /* READ DIRECTORY ONLY FLAG    */
@RF00423 OI    ACIOFL06,B'00000100'                                0428
*          ACIODRCT = ADDR(DIRWA);    /* SET PTR TO WORK AREA        */
         LA    @10,DIRWA                                           0429
         ST    @10,ACIODRCT                                        0429
*          CALL  DOREAD;              /* GO TO GET DIRECTORY BLOCK   */
         BAL   @14,DOREAD                                          0430
*          ACIOFL06 = '0'B;           /* CLEAR DIRECTORY ONLY FLAG   */
         NI    ACIOFL06,B'11111011'                                0431
*          DIRBDAP = ADDR(DIRBNAM1);  /* SET DYN PTR TO 1ST NAME     */
         LA    DIRBDAP,DIRBNAM1                                    0432
*          /* CHK IF NEXT NAME IN CURRENT BLOCK                      */
*          IF DIRBNAM > NEXTNAME      /* CHK IF 1ST NAME HIGHER      */
*            THEN                     /* YES,                        */
         CLC   DIRBNAM(8,DIRBDAP),NEXTNAME                         0433
         BH    @RT00433                                            0433
*              GOTO  BKSP;            /* GO TO GET PREVIOUS BLOCK    */
*          /* IF CURRENT NEXT NAME FOUND, GO TO READ MEMBER          */
*          DO WHILE DIRBNAM ^= NEXTNAME;/* CHK FOR FIRST LEVEL       */
         B     @DE00435                                            0435
@DL00435 DS    0H                                                  0436
*            DIRBDAP = DIRBDAP+       /* POINT TO NEXT ITEM          */
*              (DIRBC & '1F'X)*2+12;                               0436
         LA    @10,31                                              0436
         SLR   @03,@03                                             0436
         IC    @03,DIRBC(,DIRBDAP)                                 0436
         NR    @10,@03                                             0436
         ALR   @10,@10                                             0436
         ALR   @10,DIRBDAP                                         0436
         AH    @10,@CH00130                                        0436
         LR    DIRBDAP,@10                                         0436
*            END;                                                  0437
@DE00435 CLC   DIRBNAM(8,DIRBDAP),NEXTNAME                         0437
         BNE   @DL00435                                            0437
*          ACIOMPTR = DIRBDAP;        /* SET PTR TO CURRENT NAME     */
         ST    DIRBDAP,ACIOMPTR                                    0438
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*  DOBLDU:  SET THE DELETED FLAG IN THE USERID PDE.  EXECUTE      */
* /*    GETMAIN TO GET SPACE FOR THE USER IDENTITY LIST (UDL).  IF   */
* /*    GETMAIN FAILS, GO TO ISSUE THE INSUFFICIENT MAIN STORAGE     */
* /*    ERROR MESSAGE.  LOCATE THE NEXT SEQUENTIAL POSITION IN UDL   */
* /*    CHAIN AND LINK IN NEW ENTRY.                                 */
* /*                                                                 */
* /*    BUILD THE ENTRY FROM DELETE INDICATOR FLAG, A COUNT OF THE   */
* /*    DELETED MEMBER NAMES INCLUDED IN THIS ENTRY, AND THE CHAR-   */
* /*    ACTER STRINGS FOR THE NAMES                                  */
* /*                                                                 */
* /*    RETURN TO CALLER                                             */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*DOBLDU:   /* SET USERID DELETED FLAG AND STOW-DONE FLAG             */
*          /* GET SPACE FOR UDL ENTRY                                */
*          /* ISSUE GETMAIN                                          */
*          GEN  (GETMAIN  ,A=GOTMNP,MF=(E,BLDUDL))                 0439
*             REFS(GOTMNP,BLDUDL);                                 0439
DOBLDU   GETMAIN  ,A=GOTMNP,MF=(E,BLDUDL)
*          /* CHK FOR SUCCESSFUL GETMAIN                             */
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0441
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE = 4            /* CHK FOR FAILURE CODE        */
*            THEN                     /* YES,                        */
         CH    RETNCODE,@CH00066                                   0443
         BNE   @RF00443                                            0443
*              RETURN TO  NOSPAZ;     /* GO TO ISSUE NO SPACE MSG    */
         LA    @14,NOSPAZ                                          0444
         LM    @15,@03,@SA00002+4                                  0444
         LM    @05,@12,@SA00002+24                                 0444
         BR    @14                                                 0444
*          GOTMSPZ = '0'B;            /* CLEAR FIRST 8 BYTES OF NEW
*                                           UDL ENTRY                */
@RF00443 L     @10,GOTMNP                                          0445
         XC    GOTMSPZ+1(7,@10),GOTMSPZ+1(@10)                     0445
         MVI   GOTMSPZ(@10),B'00000000'                            0445
*          IF UIDLPTR = 0             /* IS THIS THE FIRST UIDL?     */
*            THEN                     /* YES,                        */
         L     @07,UIDLPTR(,ACCTPLP)                               0446
         LTR   @07,@07                                             0446
         BNZ   @RF00446                                            0446
*              UIDLPTR = GOTMNP;      /* INIT UIDL PTR               */
         ST    @10,UIDLPTR(,ACCTPLP)                               0447
*            ELSE                     /* NO,                         */
*              DO;                                                 0448
         B     @RC00446                                            0448
@RF00446 DS    0H                                                  0449
*              UIDLCHP = UIDLPTR;     /* INITIALIZE WITH FIRST PTR   */
         L     UIDLCHP,UIDLPTR(,ACCTPLP)                           0449
*              /* LOCATE NEXT POSITION IN UDL CHAIN                  */
*              RFY DUIDL BASED(UIDLCHP);                           0450
*              DO WHILE UIDLNEX ^= 0; /* 0 = LAST PTR                */
         B     @DE00451                                            0451
@DL00451 DS    0H                                                  0452
*                UIDLCHP = UIDLNEX;   /* STEP PTR                    */
         L     UIDLCHP,UIDLNEX(,UIDLCHP)                           0452
*                END;                                              0453
@DE00451 L     @10,UIDLNEX(,UIDLCHP)                               0453
         LTR   @10,@10                                             0453
         BNZ   @DL00451                                            0453
*              UIDLNEX = GOTMNP;      /* SET NEW SPACE LOC IN PTR    */
         L     @10,GOTMNP                                          0454
         ST    @10,UIDLNEX(,UIDLCHP)                               0454
*              END;                                                0455
*          RFY DUIDL BASED(GOTMNP);                                0456
@RC00446 DS    0H                                                  0457
*          UIDDEL = '1'B;             /* SET DELETE RESULT FLAG      */
         L     @10,GOTMNP                                          0457
         OI    UIDDEL(@10),B'01000000'                             0457
*          UIDLCT = 1;                /* SET MEMBER COUNT            */
         MVC   UIDLCT(2,@10),@CH00032                              0458
*          UIDUSER(1) = USRID(1:USRLEN);/* SET MEMBER NAME IN ENTRY  */
         MVI   UIDUSER+1(@10),C' '                                 0459
         MVC   UIDUSER+2(6,@10),UIDUSER+1(@10)                     0459
         SLR   @07,@07                                             0459
         IC    @07,USRLEN                                          0459
         BCTR  @07,0                                               0459
         EX    @07,@SM00453                                        0459
*          END  DELSTO;               /* RETURN TO CALLER            */
@EL00002 DS    0H                                                  0460
@EF00002 DS    0H                                                  0460
@ER00002 LM    @14,@03,@SA00002                                    0460
         LM    @05,@12,@SA00002+24                                 0460
         BR    @14                                                 0460
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*                                                                 */
* /*  M S G F N D R :   EP TO LOCATE ERROR MESSAGE ROUTINE.          */
* /*    FORM A POINTER TO THE MESSAGE OFFSET BY SUBTRACTING 2 FROM   */
* /*    TH SUM OF THE LOCATION OF THE MESSAGE CSECT (ANDXL) AND THE  */
* /*    THE VALUE OF THE MESSAGE INDEX NUMBER (MSGN0) TIMES 2.       */
* /*    ADD THAT LOCATED OFFSET VALUE (MOFFNC) TO THE LOCATION OF    */
* /*    THE MESSAGE CSECT (ANDXL) TO FORM A POINTER TO THE MESSAGE   */
* /*    SEGMENT LIST IN MSGPTR.  RETURN TO CALLER                    */
* /*                                                                 */
* /*    AT ENTRY, MSGNO CONTAINS THE MESSAGE INDEX NUMBER            */
* /*                                                                 */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*MSGFNDR: /* LOCATE MESSAGE TEXT ROUTINE EP                          */
*         PROC ;                                                   0461
MSGFNDR  STM   @14,@12,12(@13)                                     0461
*         MSGFIND = (MSGNO*2)+        /* FORM PTR TO OFFSET          */
*              ADDR(ANDXL)-2;                                      0462
         LH    MSGFIND,MSGNO                                       0462
         ALR   MSGFIND,MSGFIND                                     0462
         L     @10,@CV00069                                        0462
         ALR   MSGFIND,@10                                         0462
         BCTR  MSGFIND,0                                           0462
         BCTR  MSGFIND,0                                           0462
*         MSGPTR = MOFFSET +          /* FORM PTR TO TEXT            */
*              ADDR(ANDXL);                                        0463
         L     MSGPTR,@CV00069                                     0463
         AH    MSGPTR,MOFFSET(,MSGFIND)                            0463
*         MINDX = (SGNO1*4)+8;        /* NUMBER OF BYTES IN MSGHEADR */
         LA    @10,8                                               0464
         L     MINDX,SGNO1(,MSGPTR)                                0464
         SLA   MINDX,2                                             0464
         ALR   MINDX,@10                                           0464
*         AMSGHDR1(1:MINDX) =         /* TRANSFER MSG HEADER TO..    */
*           PTRMASK1;                 /* ..DYNAMIC HEADER AREA       */
         LR    @15,MINDX                                           0465
         BCTR  @15,0                                               0465
         EX    @15,@SM00455                                        0465
*         /* IF THIS IS NOT A MULTI-LEVEL MESSAGE, THEN BYPASS THE   */
*         /* MESSAGE HEADER TRANSFER.                                */
*         IF NXTLADR1 ^= '0'B                                      0466
*           THEN                      /* YES, MULTI-LEVEL MSG        */
         L     @03,NXTLADR1(,MSGPTR)                               0466
         LTR   @03,@03                                             0466
         BZ    @RF00466                                            0466
*             DO;                                                  0467
*             LEVPTR1 = ADDR(AMSGHDR2);/* POINT TO 2ND LEVEL MSG     */
         LA    @00,AMSGHDR2                                        0468
         ST    @00,LEVPTR1                                         0468
*             MINDX = (SGNO2*4)+8;    /* NUMBER OF BYTES IN MSGHEADR */
         L     @15,NXTLADR1(,MSGPTR)                               0469
         L     MINDX,SGNO2(,@15)                                   0469
         SLA   MINDX,2                                             0469
         ALR   MINDX,@10                                           0469
*             AMSGHDR2(1:MINDX) =     /* TRANSFER MSG HEADER TO..    */
*               PTRMASK2;             /* ..DYNAMIC HEADER AREA       */
         LR    @10,MINDX                                           0470
         BCTR  @10,0                                               0470
         EX    @10,@SM00457                                        0470
*             END;                                                 0471
*         END  MSGFNDR;               /* RETURN TO CALLER            */
@EL00003 DS    0H                                                  0472
@EF00003 DS    0H                                                  0472
@ER00003 LM    @14,@12,12(@13)                                     0472
         BR    @14                                                 0472
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*                                                                 */
* /*  C O L L C T :   INITIALIZE COUNTER (NAMCTR) TO ZERO.  CLEAR    */
* /*     DELETE CONTROL FLAGS IN EACH PDE AND STEP NAMCTR BY 1 FOR   */
* /*     EACH PDE IN CHAIN.  SAVE ACCUMULATED COUNT IN TOTAL COUNT   */
* /*     FIELD (NMDTN1)  AND  CURRENT COUNT FIELD (NMDCN1)  FOR      */
* /*     CURRENT LEVEL OF DPL                                        */
* /*                                                                 */
* /*     AT ENTRY,  DNMIDP  POINTS  TO CURRENT LEVEL OF DPL  AND     */
* /*     NAMPTR POINTS TO FIRST PDE OF CURRENT CHAIN                 */
* /*                                                                 */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*COLLCT:   /* NAME OF PDE COUNT COLLECTOR ROUTINE                    */
*          PROC ;                                                  0473
COLLCT   STM   @14,@12,12(@13)                                     0473
*          DNMIDP = DADP;             /* SET POINTER TO DPL LEVEL    */
         L     DNMIDP,DADP                                         0474
*          NAMCTR = 1;                /* INITIALIZE COUNTER          */
         LA    NAMCTR,1                                            0475
*          NAMID1 = PDEPTR;           /* SET PTR TO 1ST PDE          */
         ST    PDEPTR,NAMID1(,DNMIDP)                              0476
*          NAMIDN1 = PDEPTR;          /* SET PTR TO CURRENT PDE      */
         ST    PDEPTR,NAMIDN1(,DNMIDP)                             0477
*          DO WHILE NPTRNEX ^= 0;     /* CHECK FOR END OF LIST       */
         B     @DE00478                                            0478
@DL00478 DS    0H                                                  0479
*            NAMCTR = NAMCTR+1;       /* STEP COUNTER                */
         AH    NAMCTR,@CH00032                                     0479
*            NAMFLGD = '0'B;          /* CLEAR DELETED FLAG          */
         NI    NAMFLGD(PDEPTR),B'11111110'                         0480
*            PDEPTR = NPTRNEX;        /* STEP PTR TO NEXT ELEMENT    */
         SLR   @10,@10                                             0481
         ICM   @10,7,NPTRNEX(PDEPTR)                               0481
         LR    PDEPTR,@10                                          0481
*            END;                                                  0482
@DE00478 ICM   @10,7,NPTRNEX(PDEPTR)                               0482
         BNZ   @DL00478                                            0482
*          NMDTN1 = NAMCTR;           /* SAVE TOTAL COUNT            */
         STH   NAMCTR,NMDTN1(,DNMIDP)                              0483
*          NMDCN1 = 1;                /* SET CURRENT COUNT           */
         MVC   NMDCN1(2,DNMIDP),@CH00032                           0484
*          /* RETURN TO CALLER                                       */
*          END  COLLCT;                                            0485
@EL00004 DS    0H                                                  0485
@EF00004 DS    0H                                                  0485
@ER00004 LM    @14,@12,12(@13)                                     0485
         BR    @14                                                 0485
*DOPUTL:   /* SET UP FOR PUTLINE SERVICE ROUTINE                     */
*          PROC ;                                                  0486
DOPUTL   STM   @14,@03,@SA00005                                    0486
         STM   @05,@12,@SA00005+24                                 0486
*          PTPBOPUT = ADDR(AMSGHDR1); /* POINT TO OLDS               */
         L     @10,PTPBPTR(,IOPLPTR)                               0487
         LA    @05,AMSGHDR1                                        0487
         ST    @05,PTPBOPUT(,@10)                                  0487
*          /* CREATE LINK TO PUTLINE                                 */
*          GEN (PUTLINE ,MF=(E,PLOUT))                             0488
*              REFS(PLOUT);                                        0488
         PUTLINE ,MF=(E,PLOUT)
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0490
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE > 8            /* CHK FOR SUCESSFUL PUTLINE   */
*            THEN                     /* NO,                         */
         CH    RETNCODE,@CH00046                                   0492
         BNH   @RF00492                                            0492
*              DO;                                                 0493
*              IF PLFAIL = '0'B       /* CHK FOR PREVIOUS FAILURE    */
*                THEN                 /* NO,                         */
         TM    PLFAIL,B'00001000'                                  0494
         BNZ   @RF00494                                            0494
*                  DO;                                             0495
*                  PLFAIL = '1'B;     /* SET PUTLINE FAILURE FLAG    */
         OI    PLFAIL,B'00001000'                                  0496
*                  IF RETNCODE = 16   /* INSUFFICIENT SPACE?         */
*                    THEN             /* YES,                        */
         CH    RETNCODE,@CH00044                                   0497
         BNE   @RF00497                                            0497
*                      RETURN TO  NOSPAZ; /* GO ISSUE NO SPACE MSG   */
         LA    @14,NOSPAZ                                          0498
         LM    @15,@03,@SA00005+4                                  0498
         LM    @05,@12,@SA00005+24                                 0498
         BR    @14                                                 0498
*                  MSGNO = 2;         /* SET MESSAGE INDEX           */
@RF00497 MVC   MSGNO(2),@CH00037                                   0499
*                  RETURN TO SYSERRD; /* TO ISSUE SYSTEM ERROR MSG   */
         LA    @14,SYSERRD                                         0500
         LM    @15,@03,@SA00005+4                                  0500
         LM    @05,@12,@SA00005+24                                 0500
         BR    @14                                                 0500
*                  END;                                            0501
*              END;                                                0502
@RF00494 DS    0H                                                  0503
*          PLFAIL = '0'B;             /* CLEAR PUTLINE FAILURE FLAG  */
@RF00492 NI    PLFAIL,B'11110111'                                  0503
*          END  DOPUTL;               /* RETURN TO CALLER            */
@EL00005 DS    0H                                                  0504
@EF00005 DS    0H                                                  0504
@ER00005 LM    @14,@03,@SA00005                                    0504
         LM    @05,@12,@SA00005+24                                 0504
         BR    @14                                                 0504
*DOREAD:   /* EP TO READ SPECIFIED USER MEMBER                       */
*          PROC ;                                                  0505
DOREAD   STM   @14,@03,@SA00006                                    0505
         STM   @05,@12,@SA00006+24                                 0505
*          ACIOFL05 = '0'B;           /* CLEAR WRITE FLAG            */
         NI    ACIOFL05,B'11110111'                                0506
*          RFY R1 RSTD;               /* RESTRICT REG 1              */
*          R1 = ADDR(ACIOPARM);       /* PTR TO READ  PARAMETER BLOCK*/
         LA    R1,ACIOPARM                                         0508
*          /* LINK TO READ ROUTINE                                   */
*          CALL  IKJEFA51;            /* GO TO READ ROUTINE          */
         L     @15,@CV00071                                        0509
         BALR  @14,@15                                             0509
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */
*          /* CHK FOR SUCCESSFUL OPERATION                           */
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0512
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          /* CHK FOR ORIGINAL USERID ASTERISK ENTRY                 */
*          IF DUCLSF1 = '1'B          /* CHK FOR ASTERISK FLAG       */
*           & ACIOLINK ^= 0           /* AND BLDL OK                 */
*            THEN                     /* YES,                        */
         TM    DUCLSF1,B'10000000'                                 0514
         BNO   @RF00514                                            0514
         L     @10,ACIOLINK                                        0514
         LTR   @10,@10                                             0514
         BZ    @RF00514                                            0514
*              DO;                                                 0515
*              USRID = MEMNAME;       /* RESERVE NEW MEMBER NAME     */
         MVC   USRID(8),MEMNAME(@10)                               0516
*              USRLEN = 8;            /* INITIALIZE LENGTH COUNT     */
         MVI   USRLEN,X'08'                                        0517
*              /* FIND LENGTH OF NEW NAME                            */
*              DO WHILE USRID(USRLEN) = ' ';/* TEST FOR BLANK        */
         B     @DE00518                                            0518
@DL00518 DS    0H                                                  0519
*                USRLEN = USRLEN-1;   /* STEP LENGTH COUNT           */
         SLR   @10,@10                                             0519
         IC    @10,USRLEN                                          0519
         BCTR  @10,0                                               0519
         STC   @10,USRLEN                                          0519
*                END;                                              0520
@DE00518 SLR   @10,@10                                             0520
         IC    @10,USRLEN                                          0520
         LA    @05,USRID-1(@10)                                    0520
         CLI   0(@05),C' '                                         0520
         BE    @DL00518                                            0520
*              USRLEN = USRLEN-1;     /* STEP PAST INDEX             */
         BCTR  @10,0                                               0521
         STC   @10,USRLEN                                          0521
*              END;                                                0522
*          IF RETNCODE ^= 0           /* CHK FOR SUCCESS CODE        */
*            THEN                                                  0523
@RF00514 LTR   RETNCODE,RETNCODE                                   0523
         BZ    @RF00523                                            0523
*              DO;                                                 0524
*              IF RETNCODE = 4        /* CHK FOR NOT FOUND AND       */
*               & DUCLSF1 = '0'B      /*   SPECIFIC USER ENTERED     */
*                THEN                 /* YES,                        */
         CH    RETNCODE,@CH00066                                   0525
         BNE   @RF00525                                            0525
         TM    DUCLSF1,B'10000000'                                 0525
         BNZ   @RF00525                                            0525
*                  DO;                                             0526
*                  MSGNO = 5;         /* SET USERID MESSAGE INDEX    */
         MVC   MSGNO(2),@CH00183                                   0527
*                  CALL  MSGFNDR;     /* THEN LOCATE MESSAGE TEXT    */
         BAL   @14,MSGFNDR                                         0528
*                  /* SET UP NAME IMAGE                              */
*                  TMSGTIL1 = USRLEN+4;/* EXTRACT LENGTH             */
         LA    @10,4                                               0529
         SLR   @15,@15                                             0529
         IC    @15,USRLEN                                          0529
         ALR   @10,@15                                             0529
         STH   @10,TMSGTIL1                                        0529
*                  TMSGTIO1 = 11;     /* SET INSERTION OFFSET        */
         MVC   TMSGTIO1(2),@CH00380                                0530
*                  TMSGTIN1 = USRID;  /* SET NAME IN SEG.            */
         MVC   TMSGTIN1(8),USRID                                   0531
*                  SEGPTR13 = ADDR(TMSGTIX1); /* SET PTR TO NAME SEG.*/
         LA    @10,TMSGTIX1                                        0532
         ST    @10,SEGPTR13                                        0532
*                  RETURN TO MSGNGRM; /* GO TO ISSUE ERROR MSG       */
         LA    @14,MSGNGRM                                         0533
         LM    @15,@03,@SA00006+4                                  0533
         LM    @05,@12,@SA00006+24                                 0533
         BR    @14                                                 0533
*                  END;                                            0534
*              IF RETNCODE = 8        /* CHK FOR BLDL I/O ERR        */
*                THEN                 /* YES,                        */
@RF00525 CH    RETNCODE,@CH00046                                   0535
         BNE   @RF00535                                            0535
*                  DO;                                             0536
*                  MSGNO = 4;         /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH00066                                   0537
*                  RETURN TO ERRMSG;  /* GO TO ISSUE ERROR MSG       */
         LA    @14,ERRMSG                                          0538
         LM    @15,@03,@SA00006+4                                  0538
         LM    @05,@12,@SA00006+24                                 0538
         BR    @14                                                 0538
*                  END;                                            0539
*              IF RETNCODE = 12       /* CHK FOR GETMAIN FAILURE     */
*                THEN                                              0540
@RF00535 CH    RETNCODE,@CH00130                                   0540
         BNE   @RF00540                                            0540
*                  RETURN TO  NOSPAZ; /* GO TO ISSUE MESSAGE         */
         LA    @14,NOSPAZ                                          0541
         LM    @15,@03,@SA00006+4                                  0541
         LM    @05,@12,@SA00006+24                                 0541
         BR    @14                                                 0541
*              IF RETNCODE = 20       /* CHK FOR ERROR CODE          */
*                THEN                 /* YES,                        */
@RF00540 CH    RETNCODE,@CH00355                                   0542
         BNE   @RF00542                                            0542
*                  DO;                /* IKJEFA51 ISSUED MESSAGE     */
*                  DELERR = '1'B;     /* SET NO SUCCESS MESSAGE FLAG */
         OI    DELERR,B'00100000'                                  0544
*                  RETURN TO  DOCLOS; /* GO TO EXIT                  */
         LA    @14,DOCLOS                                          0545
         LM    @15,@03,@SA00006+4                                  0545
         LM    @05,@12,@SA00006+24                                 0545
         BR    @14                                                 0545
*                  END;                                            0546
*              IF RETNCODE = 24       /* CHK FOR EOF CODE            */
*                THEN                 /* YES,                        */
@RF00542 CH    RETNCODE,@CH00124                                   0547
         BNE   @RF00547                                            0547
*                  RETURN TO DELCHK;  /* FINISHED, GO TO EXIT        */
         LA    @14,DELCHK                                          0548
         LM    @15,@03,@SA00006+4                                  0548
         LM    @05,@12,@SA00006+24                                 0548
         BR    @14                                                 0548
*              /* ISSUE READ ERROR MESSAGE                       */
*              MSGNO = 24;            /* SET MESSAGE INDEX           */
@RF00547 MVC   MSGNO(2),@CH00124                                   0549
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */
         LA    @14,SYSERRD                                         0550
         LM    @15,@03,@SA00006+4                                  0550
         LM    @05,@12,@SA00006+24                                 0550
         BR    @14                                                 0550
*              END;                                                0551
*          IF ACIOFL06 = '1'B         /* DIRECTORY READ?             */
*            THEN                     /* YES,                        */
@RF00523 TM    ACIOFL06,B'00000100'                                0552
         BO    @RT00552                                            0552
*              RETURN;                                             0553
*          RDDONE = '1'B;             /* SET READ DONE FLAG          */
         OI    RDDONE,B'00000010'                                  0554
*          END DOREAD;                                             0555
@EL00006 DS    0H                                                  0555
@EF00006 DS    0H                                                  0555
@ER00006 LM    @14,@03,@SA00006                                    0555
         LM    @05,@12,@SA00006+24                                 0555
         BR    @14                                                 0555
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*                                                                 */
* /*  D O W R I T E:                                                 */
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*DOWRITE:   /* EP TO WRITE NEW MEMBER                                */
*          PROC ;                                                  0556
DOWRITE  STM   @14,@03,@SA00007                                    0556
         STM   @05,@12,@SA00007+24                                 0556
*          RFY R1 RSTD;               /* RESTRICT REG 1              */
*          R1  =  ADDR(ACIOPARM);     /* SET PTR TO WRITE  P B       */
         LA    R1,ACIOPARM                                         0558
*          CALL  IKJEFA52;            /* GO TO WRITE ROUTINE         */
         L     @15,@CV00072                                        0559
         BALR  @14,@15                                             0559
*          RFY R1 UNRSTD;             /* RELEASE REG 1               */
*          RFY R15 RSTD;              /* RESTRICT RETURN CODE REG    */
*          RETNCODE = R15;            /* RESERVE RETURN CODE         */
         LR    RETNCODE,R15                                        0562
*          RFY R15 UNRSTD;            /* RELEASE RETURN CODE REG     */
*          IF RETNCODE ^= 0           /* CHK FOR ERROR               */
*            THEN                     /* YES,                        */
         LTR   RETNCODE,RETNCODE                                   0564
         BZ    @RF00564                                            0564
*              DO;                                                 0565
*              /* WRITE UNSUCCESSFUL, WAS ERROR MESSAGE ISSUED?      */
*              IF RETNCODE = 20       /* MESSAGE WAS ISSUED          */
*                THEN                                              0566
         CH    RETNCODE,@CH00355                                   0566
         BNE   @RF00566                                            0566
*                  RETURN TO  DOCLOS; /* GO TO EXIT                  */
         LA    @14,DOCLOS                                          0567
         LM    @15,@03,@SA00007+4                                  0567
         LM    @05,@12,@SA00007+24                                 0567
         BR    @14                                                 0567
*              MSGNO = 26;            /* SET MESSAGE INDEX           */
@RF00566 MVC   MSGNO(2),@CH00382                                   0568
*              RETURN TO  SYSERRD;    /* GO TO ISSUE MESSAGE         */
         LA    @14,SYSERRD                                         0569
         LM    @15,@03,@SA00007+4                                  0569
         LM    @05,@12,@SA00007+24                                 0569
         BR    @14                                                 0569
*              END;                                                0570
*          IF ACIOFL05 = '1'B         /* CHK FOR WRITE FLAG          */
*            THEN                     /* YES,                        */
@RF00564 TM    ACIOFL05,B'00001000'                                0571
         BNO   @RF00571                                            0571
*              WRTDON = '1'B;         /* SET WORK DONE FLAG          */
         OI    WRTDON,B'00000001'                                  0572
*          RDDONE = '0'B;             /* CLEAR READ OK FLAG          */
@RF00571 NI    RDDONE,B'11111101'                                  0573
*          GEN (DEQ   (,USRLEN,0),MF=(E,DQLST))                    0574
*            REFS(DQLST,EQNAM1,USRLEN); /* DEQ SYSUADS-MEMBERNAME    */
         DEQ   (,USRLEN,0),MF=(E,DQLST)
*          END DOWRITE;                                            0575
@EL00007 DS    0H                                                  0575
@EF00007 DS    0H                                                  0575
@ER00007 LM    @14,@03,@SA00007                                    0575
         LM    @05,@12,@SA00007+24                                 0575
         BR    @14                                                 0575
*NLSTEXIT: /**********************************************************/
*          /* NLSTEXIT: CONTROL PASSED HERE FROM IKJEFA55 TO ALLOW   */
*          /* MODIFICATION OF THE PARSE PCL DEPENDING ON THE NUMBER  */
*          /* OF ITEMS IN THE NODELIST                               */
*          /**********************************************************/
*          PROC OPTIONS(NOSAVEAREA);                               0576
NLSTEXIT STM   @14,@12,12(@13)                                     0576
*          /* FIX UP ADDRESSABILITY                                  */
*         RFY (R1,R2) RSTD;                                        0577
*         R2 = R1;                    /* GET SAVE AREA PTR           */
         LR    R2,R1                                               0578
*         GEN (LM  R2,R12,28(R2));    /* RESTORE REGISTERS           */
         LM  R2,R12,28(R2)
*         SAVE13 = R13;               /* SAVE IKJEFA55 SAVEAREA PTR  */
         LR    SAVE13,R13                                          0580
*         R13 = R1;                   /* SET SAVE AREA PTR           */
         LR    R13,R1                                              0581
*         RFY (R1,R2) UNRSTD;                                      0582
*         SUBFPTR = PCLPTR+DATSUBFO;  /* POINT TO DATA SUBFIELD OFF. */
         L     @10,PCLPTR                                          0583
         LH    SUBFPTR,DATSUBFO                                    0583
         ALR   SUBFPTR,@10                                         0583
*         DATAPTR = PCLPTR+DATAOF;    /* POINT TO DATA KEYWORD PCE   */
         AH    @10,DATAOF                                          0584
         LR    DATAPTR,@10                                         0584
*         IF NUMOFLV = 1              /* IS THE DELETE LEVEL USERID? */
*           THEN                      /* YES,                        */
         CLI   NUMOFLV,1                                           0585
         BNE   @RF00585                                            0585
*             DO;                                                  0586
*             SUBFOF = PASUBOF;       /* SET SUBFIELD OFFSET TO    0587
*                                        PASSWORD IKJSUBF & IKJIDENT */
         LH    @10,PASUBOF                                         0587
         STH   @10,SUBFOF(,SUBFPTR)                                0587
*             IF USRID(1) ^= '*'      /* IS THE USERID AN ASTERISK?  */
*               THEN                  /* NO,                         */
         CLI   USRID,C'*'                                          0588
         BE    @RF00588                                            0588
*                 DATAFLG(5) = '0'B;  /* TURN OFF DEFAULT BIT FOR THE
*                                        'DATA' KEYWORD - THIS MAKES
*                                        THE KEYWORD OPTIONAL        */
         NI    DATAFLG(DATAPTR),B'11110111'                        0589
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */
         B     CLEANUP                                             0590
*             END;                                                 0591
*         IF NUMOFLV = 2              /* IS THE DELETE LEVEL PASSWD? */
*           THEN                      /* YES,                        */
@RF00585 CLI   NUMOFLV,2                                           0592
         BNE   @RF00592                                            0592
*             DO;                                                  0593
*             SUBFOF = ACSUBOF;       /* SET SUBFIELD OFFSET TO    0594
*                                        ACCTNMBR IKJSUBF & IKJIDENT */
         LH    @10,ACSUBOF                                         0594
         STH   @10,SUBFOF(,SUBFPTR)                                0594
*             IF PASSWD(1) ^= '*'     /* IS THE PASSWORD AN ASTERISK?*/
*               THEN                  /* NO,                         */
         CLI   PASSWD,C'*'                                         0595
         BE    @RF00595                                            0595
*                 DATAFLG(5) = '0'B;  /* MAKE THE 'DATA' KEYWORD   0596
*                                        OPTIONAL                    */
         NI    DATAFLG(DATAPTR),B'11110111'                        0596
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */
         B     CLEANUP                                             0597
*             END;                                                 0598
*         IF NUMOFLV = 3              /* IS THE DELETE LEVEL ACCTNM? */
*           THEN                      /* YES,                        */
@RF00592 CLI   NUMOFLV,3                                           0599
         BNE   @RF00599                                            0599
*             DO;                                                  0600
*             IF ACCTNO(1:2) ^= '* '  /* IS THE ACCTNMBR AN ASTERISK?*/
*               THEN                  /* NO,                         */
         CLC   ACCTNO(2),@CC00361                                  0601
         BE    @RF00601                                            0601
*                 DATAFLG(5) = '0'B;  /* MAKE THE 'DATA' KEYWORD   0602
*                                        OPTIONAL                    */
         NI    DATAFLG(DATAPTR),B'11110111'                        0602
*             GOTO CLEANUP;           /* GO CLEAN UP AND EXIT        */
         B     CLEANUP                                             0603
*             END;                                                 0604
*CLEANUP: /* THE PARSE PCL HAS BEEN MODIFIED TO MATCH THE NODELIST   */
*         PCEPTR = PCLPTR+SUBFOF;     /* POINT TO ACTIVE PCE         */
@RF00599 DS    0H                                                  0605
CLEANUP  LH    PCEPTR,SUBFOF(,SUBFPTR)                             0605
         AL    PCEPTR,PCLPTR                                       0605
*         PCELNG = PCLLNGTH-1;        /* POINT TO END OF PCL TO TELL
*                                        PARSE THIS IS THE ONLY PCE  */
         L     @10,PCLMDLAD                                        0606
         LH    @10,PCLLNGTH(,@10)                                  0606
         BCTR  @10,0                                               0606
         STH   @10,PCELNG(,PCEPTR)                                 0606
*         R13 = SAVE13;               /* ADDR OF CALLER'S SAVE AREA  */
         LR    R13,SAVE13                                          0607
*         RETURN CODE(0);                                          0608
         SLR   @15,@15                                             0608
         L     @14,12(,@13)                                        0608
         LM    @00,@12,20(@13)                                     0608
         BR    @14                                                 0608
*         END NLSTEXIT;                                            0609
*         END IKJEFA30                                             0610
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJEFUDL)                                        *
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        *
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        *
*/*%INCLUDE SYSLIB  (IKJPTPB )                                        *
*;                                                                 0610
@DATA    DS    0H
@CH00032 DC    H'1'
@CH00037 DC    H'2'
@CH00211 DC    H'3'
@CH00066 DC    H'4'
@CH00183 DC    H'5'
@CH00389 DC    H'6'
@CH00159 DC    H'7'
@CH00046 DC    H'8'
@CH00405 DC    H'9'
@CH00379 DC    H'10'
@CH00380 DC    H'11'
@CH00130 DC    H'12'
@CH00042 DC    H'13'
@CH00403 DC    H'14'
@CH00109 DC    H'15'
@CH00044 DC    H'16'
@CH00406 DC    H'17'
@CH00376 DC    H'18'
@CH00355 DC    H'20'
@CH00387 DC    H'22'
@CH00124 DC    H'24'
@CH00378 DC    H'25'
@CH00382 DC    H'26'
@CH00409 DC    H'27'
@CH00391 DC    H'35'
@CH00388 DC    H'37'
@SM00437 MVC   CPLS(0),MCPLS
@SM00445 MVC   TMSGTIN1(0),USRID
@SM00448 MVC   TMSGTIN1(0),NAMPTRC(@01)
@SM00450 MVC   TMSGTIN1(0),MEMNAME(@10)
@SM00453 MVC   UIDUSER(0,@10),USRID
@SM00455 MVC   AMSGHDR1(0),PTRMASK1(MSGPTR)
@SM00457 MVC   AMSGHDR2(0),PTRMASK2(@15)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00007 DS    14F
@SA00006 DS    14F
@SA00002 DS    14F
@SA00005 DS    14F
IKJEFA30 CSECT
         DS    0F
@CF00399 DC    XL4'40FFFFFF'
@DATD    DSECT
         DS    0D
GOTMNP   DS    A
DELPDLAD DS    A
LEVLP    DS    A
VCHKPL   DS    CL26
         ORG   VCHKPL
EXITADD  DS    AL4
EXITRTCD DS    AL4
NODEPTR  DS    AL4
@NM00005 DS    AL4
PPLPTR   DS    AL4
SAVARAD  DS    AL4
CMDIND   DS    FL1
NUMOFLV  DS    FL1
         ORG   VCHKPL+26
NLSTTAB  DS    CL66
         ORG   NLSTTAB
USRLEN   DS    FL1
USRID    DS    CL8
PASSWD   DS    CL8
ACTLEN   DS    FL1
ACCTNO   DS    CL40
@NM00006 DS    CL8
         ORG   NLSTTAB+66
COMAREA  DS    CL11
         ORG   COMAREA
DPLPTR   DS    AL4
ACIOPTR  DS    AL4
MSGNO    DS    AL2
DELUSER  DS    BL1
GPWDSP   EQU   COMAREA+10
GACNSP   EQU   COMAREA+10
         ORG   COMAREA+11
         DS    CL1
DPL      DS    CL121
         ORG   DPL
DADP     DS    AL4
DCDP     DS    AL4
DUSRID1  DS    AL4
DUSRIDN  DS    AL4
@NM00007 DS    AL4
@NM00008 DS    AL4
@NM00009 DS    AL4
@NM00010 DS    CL1
         ORG   @NM00010
DUCLSF1  DS    BL1
         ORG   DPL+29
@NM00011 DS    AL3
DUSRDTN  DS    AL2
DUSRDCN  DS    AL2
DPASWD1  DS    AL4
DPASWDN  DS    AL4
@NM00012 DS    CL12
@NM00013 DS    CL1
         ORG   @NM00013
DPCLSF1  DS    BL1
         ORG   DPL+57
@NM00014 DS    AL3
DPSWDTN  DS    AL2
DPSWDCN  DS    AL2
DACCTN1  DS    AL4
DACCTNN  DS    AL4
@NM00015 DS    CL12
@NM00016 DS    CL1
         ORG   @NM00016
DACLSF1  DS    BL1
         ORG   DPL+85
@NM00017 DS    AL3
DACCTTN  DS    AL2
DACCTCN  DS    AL2
DROCNM1  DS    AL4
@NM00018 DS    AL4
@NM00019 DS    CL12
@NM00020 DS    CL1
@NM00021 DS    AL3
@NM00022 DS    AL2
@NM00023 DS    AL2
@NM00024 DS    BL1
         ORG   DPL+121
         DS    CL3
ACIOPARM DS    CL24
         ORG   ACIOPARM
@NM00046 DS    BL1
ACIOFL03 EQU   ACIOPARM+0
@NM00047 EQU   ACIOPARM+0
ACIOFL05 EQU   ACIOPARM+0
ACIOFL06 EQU   ACIOPARM+0
@NM00048 EQU   ACIOPARM+0
ACIODCBA DS    AL3
ACIOMPTR DS    AL4
ACIODRCT DS    AL4
ACIOLINK DS    AL4
@NM00049 DS    AL1
@NM00050 DS    AL3
ACIOPUTL DS    AL4
         ORG   ACIOPUTL
MSGID    DS    CL1
         ORG   ACIOPARM+24
NEXTNAME DS    CL8
DIRWA    DS    CL344
         ORG   DIRWA
DIRDCB   DS    CL88
@NM00055 DS    CL256
         ORG   @NM00055
@NM00056 DS    CL2
DIRBNAM1 DS    CL8
         ORG   DIRWA+344
STOLST   DS    CL8
DELECF   DS    CL1
         ORG   DELECF
ACNNTR   DS    BL1
DATLIN   EQU   DELECF+0
DELERR   EQU   DELECF+0
ENQFLG   EQU   DELECF+0
PLFAIL   EQU   DELECF+0
PWDNTR   EQU   DELECF+0
RDDONE   EQU   DELECF+0
WRTDON   EQU   DELECF+0
         ORG   DELECF+1
         DS    CL7
DBLWORD  DS    CL8
PLOUT    DS    CL16
AMSGHDR1 DS    CL32
         ORG   AMSGHDR1
LEVPTR1  DS    AL4
@NM00060 DS    2A
SEGPTR12 DS    AL4
SEGPTR13 DS    AL4
@NM00061 DS    3A
         ORG   AMSGHDR1+32
AMSGHDR2 DS    CL32
         ORG   AMSGHDR2
@NM00062 DS    AL4
@NM00063 DS    3A
SEGPTR23 DS    AL4
@NM00064 DS    3A
         ORG   AMSGHDR2+32
TMSGTIX1 DS    CL12
         ORG   TMSGTIX1
TMSGTIL1 DS    AL2
TMSGTIO1 DS    AL2
TMSGTIN1 DS    CL8
         ORG   TMSGTIX1+12
PARSLIST DS    CL28
@NM00065 DS    CL8
         ORG   @NM00065
PCLPTR   DS    AL4
PLENGTH  DS    AL4
         ORG   @NM00065+8
NDLSTPDE DS    CL36
         ORG   NDLSTPDE
UPDE     DS    AL4
ULEN     DS    FL2
@NM00066 DS    BL2
@NM00067 DS    AL4
PPDE     DS    AL4
PLEN     DS    FL2
@NM00068 DS    BL2
@NM00069 DS    AL4
APDE     DS    AL4
ALEN     DS    FL2
@NM00070 DS    BL2
@NM00071 DS    AL4
         ORG   NDLSTPDE+36
IKJEFA30 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00069 DC    V(ANDXL)
@CV00070 DC    V(IKJEFA32)
@CV00071 DC    V(IKJEFA51)
@CV00072 DC    V(IKJEFA52)
@CV00073 DC    V(IKJEFA55)
         DS    0D
LSPAN    DC    AL4(DPASWD1-DUSRID1)
PCLMDLAD DC    AL4(PCLMODEL)
DATAOF   DC    AL2(DATAPCE-PCLSTART)
ACSUBOF  DC    AL2(ACCTPCE-PCLSTART+1)
PASUBOF  DC    AL2(PASSPCE-PCLSTART+1)
DATSUBFO DC    AL2(SUBFPCES-PCLSTART-2)
@CC00361 DC    C'* '
EQNAM1   DC    CL8'SYSIKJUA'
ERNAM1   DC    CL8'OPENUADS'
@DATD    DSECT
IKJEFA30 CSECT
         EXTRN ACCTEXTR                 ADDR OF PARSE VALIDCK EXIT
         EXTRN IKJEFA55                 ADDR OF PARSE VALIDCK EXIT
         EXTRN PASSEXTR                 ADDR OF PARSE VALIDCK EXIT
         EXTRN PROCEXTR                 ADDR OF PARSE VALIDCK EXIT
PCLMODEL CSECT
PCLSTART EQU   *
PCLMODEL IKJPARM  DSECT=DELPDLD
NODEPDE  IKJPOSIT PSTRING,PROMPT='(NODELIST)',VALIDCK=IKJEFA55,        *
               HELP=('NODELIST - FORMAT IS (USERID / PASSWORD / ACCOUNT*
                NUMBER)')
DATAPCE  EQU      *
DATAPDE  IKJKEYWD DEFAULT='DATA'
         IKJNAME  'DATA',SUBFLD=PROCSUB
SUBFPCES EQU   *
PROCSUB  IKJSUBF
PROCD    IKJIDENT 'DATALIST-PROCEDURE NAME',LIST,MAXLNTH=8,            *
               FIRST=ANY,OTHER=ALPHANUM,VALIDCK=PROCEXTR,              *
               PROMPT='DATALIST- PROCEDURE NAME'
ACCTPCE  EQU   *
ACCTSUB  IKJSUBF
ACCTD    IKJIDENT 'DATALIST-ACCOUNT NUMBER',LIST,MAXLNTH=40,FIRST=ANY, *
               OTHER=ANY,VALIDCK=ACCTEXTR,PROMPT='DATALIST-ACCOUNT NUMB*
               ER'
PASSPCE  EQU      *
PASSSUB  IKJSUBF
PASSD    IKJIDENT 'DATALIST-PASSWORD',LIST,MAXLNTH=8,FIRST=ANY,        *
               OTHER=ALPHANUM,VALIDCK=PASSEXTR,PROMPT='DATALIST-PASSWOR*
               D'
         IKJENDP
@DATD    DSECT
IKJEFA30 CSECT
MCPLS    DS    0F
         CLOSE (,REREAD),MF=L         FOR CLOSE
         DCB   DSORG=PO,DDNAME=SYSUADS,MACRF=(R,W),RECFM=FB,NCP=10
         DEQ   (EQNAM1,ERNAM1,8,SYSTEM),RET=HAVE,MF=L    FOR DEQ
         ENQ   (EQNAM1,,E,0,SYSTEM),RET=USE,MF=L         FOR USER ENQ
         ENQ   (EQNAM1,ERNAM1,E,8,SYSTEM),RET=HAVE,MF=L  FOR OPEN ENQ
         FREEMAIN V,SP=1,MF=L         FOR FREEMAIN
         GETMAIN  EC,LV=16,SP=1,MF=L
         GETMAIN  VC,SP=1,MF=L        FOR GETMAIN
         OPEN  (,),MF=L               FOR OPEN
         PUTLINE  OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L   FOR PUTLINE
MCPLLNG  DC    A(*-MCPLS)             LENGTH OF MODEL PARAMETER BLOCKS
MDIRDCB  DCB   DDNAME=SYSUADS,DSORG=PS,MACRF=(R),RECFM=F,BLKSIZE=256
         DCBD  DSORG=PO               MASK FOR UADS DCB
@DATD    DSECT                        RE-ESTABLISH AUTOMATIC DSECT
CPLS     DS    0F
DLCLSL   CLOSE (,),MF=L               FOR CLOSE
DELDCB   DCB   DSORG=PO,DDNAME=SYSUADS,MACRF=(R,W),RECFM=FB,NCP=10
DQLST    DEQ   (,,,),MF=L             FOR DEQUEUE
NQMBR    ENQ   (,,,,),MF=L            FOR USER ENQUEUE
NQOPN    ENQ   (,,,,),MF=L            FOR OPEN ENQUEUE
FMLST    FREEMAIN V,MF=L              FOR FREEMAIN
BLDUDL   GETMAIN  EC,LV=16,MF=L
GMLST    GETMAIN  VC,MF=L             FOR GETMAIN
DLOPNL   OPEN  (,),MF=L               FOR OPEN
PTPBK    PUTLINE  ,MF=L               FOR PUTLINE
IKJEFA30 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFA30 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SUBFPTR  EQU   @04
DATAPTR  EQU   @03
PCEPTR   EQU   @02
SAVE13   EQU   @06
MINDX    EQU   @03
MSGPTR   EQU   @02
MSGFIND  EQU   @03
RETNCODE EQU   @04
TSTCTN   EQU   @05
NAMCTR   EQU   @04
UIDLCHP  EQU   @02
DIRBDAP  EQU   @02
PDEPTR   EQU   @02
DNMIDP   EQU   @03
ACCTPLP  EQU   @06
IOPLPTR  EQU   @07
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
R12      EQU   @12
DUIDL    EQU   0
UIDLNEX  EQU   DUIDL
UIDLSWS  EQU   DUIDL+4
UIDDEL   EQU   UIDLSWS
UIDLCT   EQU   DUIDL+6
UIDUSER  EQU   DUIDL+8
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
PPL      EQU   0
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
PTPB     EQU   0
PTPBOPUT EQU   PTPB+4
ACCTPL   EQU   0
ACCTECBP EQU   ACCTPL+8
CMDBUFAD EQU   ACCTPL+12
UIDLPTR  EQU   ACCTPL+16
ACCTECB  EQU   0
ATTENTN  EQU   ACCTECB
@NM00025 EQU   0
NAMID1   EQU   @NM00025
NAMIDN1  EQU   @NM00025+4
@NM00026 EQU   @NM00025+8
NMFLG11  EQU   @NM00026
@NM00033 EQU   @NM00025+24
NMDTN1   EQU   @NM00033
NMDCN1   EQU   @NM00033+2
NAMPDE   EQU   0
NAMPTR1  EQU   NAMPDE
NAMLNG   EQU   NAMPDE+4
NAMFLGF  EQU   NAMPDE+6
NAMFLGD  EQU   NAMPDE+6
NPTRNEX  EQU   NAMPDE+9
NAMPTRC  EQU   0
NEXTUSER EQU   0
@NM00051 EQU   0
DIRBNAM  EQU   @NM00051
DIRBC    EQU   @NM00051+11
@NM00053 EQU   0
MEMNAME  EQU   @NM00053+4
GOTMSPZ  EQU   0
@NM00057 EQU   0
RCLC1    EQU   @NM00057+3
MOFFSET  EQU   0
PTRMASK1 EQU   0
NXTLADR1 EQU   PTRMASK1
SGNO1    EQU   PTRMASK1+4
PTRMASK2 EQU   0
SGNO2    EQU   PTRMASK2+4
PCLLNGTH EQU   0
PCELNG   EQU   0
DATAFLG  EQU   0
SUBFOF   EQU   0
@NM00072 EQU   0
DATAKEY  EQU   @NM00072+16
PROCPDE  EQU   @NM00072+20
ACCTPDE  EQU   @NM00072+32
PASSPDE  EQU   @NM00072+44
DCBOFLG  EQU   DCBOFLGS
PTPBPTR  EQU   IOPLIOPB
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00085 EQU   DCBOFLGS
@NM00084 EQU   @NM00072+52
@NM00083 EQU   @NM00072+50
@NM00082 EQU   @NM00072+48
@NM00081 EQU   @NM00072+40
@NM00080 EQU   @NM00072+38
@NM00079 EQU   @NM00072+36
@NM00078 EQU   @NM00072+28
@NM00077 EQU   @NM00072+26
@NM00076 EQU   @NM00072+24
@NM00075 EQU   @NM00072+18
@NM00074 EQU   @NM00072+8
@NM00073 EQU   @NM00072
@NM00059 EQU   PTRMASK2
@NM00058 EQU   @NM00057
@NM00054 EQU   @NM00053
@NM00052 EQU   @NM00051+8
@NM00045 EQU   NAMPDE+8
@NM00044 EQU   NAMPDE+7
@NM00043 EQU   NAMPDE+6
@NM00042 EQU   NAMPDE+6
@NM00041 EQU   @NM00025+54
@NM00040 EQU   @NM00025+52
@NM00039 EQU   @NM00025+49
@NM00038 EQU   @NM00025+48
@NM00037 EQU   @NM00025+48
@NM00036 EQU   @NM00025+36
@NM00035 EQU   @NM00025+32
@NM00034 EQU   @NM00025+28
@NM00032 EQU   @NM00025+21
@NM00031 EQU   @NM00025+20
@NM00030 EQU   @NM00026+8
@NM00029 EQU   @NM00026+4
@NM00028 EQU   @NM00026+1
@NM00027 EQU   @NM00026
@NM00004 EQU   ACCTECB
@NM00003 EQU   ACCTPL
PTPBFLN  EQU   PTPB+8
@NM00002 EQU   PTPB
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
@NM00001 EQU   UIDLSWS
UIDCHG   EQU   UIDLSWS
UIDADD   EQU   UIDLSWS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00069 EQU   NOSPAZ
@RT00098 EQU   NOSPAZ
@RT00133 EQU   DATLCHK
@RT00146 EQU   DATLCHK
@RT00212 EQU   DELCHK
@RT00214 EQU   DOCLOS
@RT00228 EQU   ENQERR
@RT00252 EQU   SYSERRD
@RT00254 EQU   READ
@RF00256 EQU   DELCHK
@RC00268 EQU   QUITCHK
@RT00301 EQU   DOCLOS
@RT00327 EQU   MSGNGRM
@RT00409 EQU   DOBLDU
@RT00416 EQU   DOBLDU
@RT00433 EQU   BKSP
@RF00466 EQU   @EL00003
@RT00552 EQU   @EL00006
@RF00588 EQU   CLEANUP
@RF00595 EQU   CLEANUP
@RF00601 EQU   CLEANUP
@PB00008 EQU   @EL00001
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEFA30

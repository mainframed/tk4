         TITLE 'ALLOCATION REQUEST PROCESSOR                           *
                        '
IKJEFD32 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFD32  76.167'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0001
*/*                    END OF CVT MACRO                              */
*                                                                  0093
*                                                                  0093
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      REQTYPE                                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE DETERMINES THE TYPE OF ALLOCATION REQUEST      */
*/*      BEING MADE, AND ROUTES CONTROL TO THE APPROPRIATE           */
*/*      PROCESSOR.                                                  */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      IF THE REQUEST IS FOR A DUMMY DATA SET, INVOKE DMMYREQ.     */
*/*      IF REQUEST IF FOR A TERMINAL, INVOKE TERMREQ.  IF REQUEST   */
*/*      IF FOR SYSOUT DATA SET, INVOKE SYSOTREQ. OTHERWISE,         */
*/*      DETERMINE DATA SET STATUS AND INVOKE APPROPRIATE ROUTINE.   */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      REQUEST PROCESSED                                           */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/********************************************************************/
*                                                                  0093
*REQTYPE:                                                          0093
*   AWAPTR=R1;                      /* PTR TO WORKAREA               */
REQTYPE  LR    AWAPTR,R1                                           0093
*   INC=ADDNUM+1;                   /* ADDBLOCK SUBSCRIPT            */
         L     @10,GTPLPTR(,AWAPTR)                                0094
         L     @10,GTPLABLK(,@10)                                  0094
         LA    INC,1                                               0094
         MVC   @TF00001(2),ADDNUM(@10)                             0094
         AH    INC,@TF00001                                        0094
*   IF DSPDE=2 THEN                 /* IF DUMMY SPECIFIED,           */
         L     @10,PTRPDL(,AWAPTR)                                 0095
         CLC   DSPDE(2,@10),@CH00066                               0095
         BNE   @RF00095                                            0095
*     CALL DMMYREQ;                 /* INVOKE DUMMY PROCESSOR        */
         BAL   @14,DMMYREQ                                         0096
*   ELSE                                                           0097
*     IF DSPDE=1&                   /* IF * ENTERED AS               */
*         DSNPRES='1'B&             /* DSNAME,                       */
*         DSNTERM='*' THEN          /* INVOKE TERMINAL               */
         B     @RC00095                                            0097
@RF00095 L     @10,PTRPDL(,AWAPTR)                                 0097
         CLC   DSPDE(2,@10),@CH00033                               0097
         BNE   @RF00097                                            0097
         TM    DSNPRES(@10),B'10000000'                            0097
         BNO   @RF00097                                            0097
         L     @10,DSNPTR(,@10)                                    0097
         CLI   DSNTERM(@10),C'*'                                   0097
         BNE   @RF00097                                            0097
*       CALL TERMREQ;               /* PROCESSOR                     */
         BAL   @14,TERMREQ                                         0098
*     ELSE                                                         0099
*       IF STATSPDE=5 THEN          /* IF SYSOUT ENTERED,            */
         B     @RC00097                                            0099
@RF00097 L     @10,PTRPDL(,AWAPTR)                                 0099
         CLC   STATSPDE(2,@10),@CH00047                            0099
         BNE   @RF00099                                            0099
*         CALL SYSOTREQ;            /* INVOKE SYSOUT PROC.           */
         BAL   @14,SYSOTREQ                                        0100
*       ELSE                                                       0101
*         DO;                       /*                       @Y30LPKH*/
         B     @RC00099                                            0101
@RF00099 DS    0H                                                  0102
*           IF VOLPDE=2 THEN        /* IF MSVGP SPEC         @Y30LPKH*/
         L     @10,PTRPDL(,AWAPTR)                                 0102
         CLC   VOLPDE(2,@10),@CH00066                              0102
         BNE   @RF00102                                            0102
*             KEYLIST(8)=DALMSVGP;  /* SET KEY               @Y30LPKH*/
         L     @10,GTPLPTR(,AWAPTR)                                0103
         L     @10,GTPLKLST(,@10)                                  0103
         MVC   KEYLIST+14(2,@10),@CH00746                          0103
*           IF STATSPDE=<2 THEN     /* IF STATUS OLD OR SHR          */
@RF00102 L     @10,PTRPDL(,AWAPTR)                                 0104
         LH    @10,STATSPDE(,@10)                                  0104
         C     @10,@CF00066                                        0104
         BH    @RF00104                                            0104
*             CALL OLDDS;           /* INVOKE PROCESSOR              */
         BAL   @14,OLDDS                                           0105
*           ELSE                                                   0106
*             IF STATSPDE=3 THEN    /* STATUS MOD,                   */
         B     @RC00104                                            0106
@RF00104 L     @10,PTRPDL(,AWAPTR)                                 0106
         CLC   STATSPDE(2,@10),@CH00323                            0106
         BNE   @RF00106                                            0106
*               CALL MODDS;         /* INVOKE MOD PROCESSOR          */
         BAL   @14,MODDS                                           0107
*             ELSE                  /* ELSE,                         */
*               CALL NEWDS;         /* INVOKE NEW PROCESSOR          */
         B     @RC00106                                            0108
@RF00106 BAL   @14,NEWDS                                           0108
*         END;                                                     0109
@RC00106 DS    0H                                                  0109
@RC00104 DS    0H                                                  0110
*   IF RBCODE12='1'B THEN           /* IF ERROR OCCURRED,            */
@RC00099 DS    0H                                                  0110
@RC00097 DS    0H                                                  0110
@RC00095 TM    RBCODE12(AWAPTR),B'10000000'                        0110
         BNO   @RF00110                                            0110
*     RETCODE=12;                   /* SET RETURN CODE TO 12         */
         L     @10,REGSAVE(,R13)                                   0111
         MVC   RETCODE(4,@10),@CF01435                             0111
*   ELSE                            /* ELSE                          */
*     RETCODE=0;                    /* RETURN CODE 0                 */
         B     @RC00110                                            0112
@RF00110 L     @10,REGSAVE(,R13)                                   0112
         SLR   @15,@15                                             0112
         ST    @15,RETCODE(,@10)                                   0112
*   RETURN;                                                        0113
@EL00001 L     @13,4(,@13)                                         0113
@EF00001 L     @00,@SIZDATD                                        0113
         LR    @01,@11                                             0113
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0113
         BR    @14                                                 0113
*                                                                  0114
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      NEWDS                                                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE ALLOCATES A DATA SET HAVING A STATUS OF NEW.   */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      EXTRANEOUS PARAMETERS ARE IGNORED. IF DISPOSITION WAS NOT   */
*/*      SPECIFIED, AND DSNAME WAS NOT SPECIFIED, SET DISPOSITION TO */
*/*      DELETE. ELSE, SET DISPOSITION TO CATALOG. INVOKE IKJEFD33   */
*/*      TO PROCESS SPACE PARAMETERS. SET TRACKS OR CYLINDERS KEY IN */
*/*      KEY LIST, WHICHEVER IS APPROPRIATE. INVOKE GENTRANS. IF     */
*/*      GENTRANS SUCCESSFUL, INVOKE DYNAMIC ALLOCATION.             */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*      GENTRANS PARAMETER LIST                                     */
*/*      DYNAMIC ALLOCATION REQUEST BLOCK                            */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - FAILURE IN GENTRANS OR ALLOCATION            */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/*                                                                  */
*/*        IF TRACKS WAS SPECIFIED, THE KEY PASSED TO GENTRANS IS    */
*/*        THE TRACKS KEY. OTHERWISE, THE KEY IS FOR CYLINDERS. IF   */
*/*        BLOCK OR AVBLOCK WAS ENTERED, THE CYLINDERS KEY WILL NOT  */
*/*        BE LOOKED AT.                                             */
*/********************************************************************/
*                                                                  0114
*NEWDS:                                                            0114
*   PROC;                                                          0114
         B     @EL00001                                            0114
NEWDS    STM   @14,@12,@SA00002                                    0114
*   I=1;                            /* INITIALIZE SUBSCRIPT          */
*                                                                  0115
         LA    I,1                                                 0115
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0116
*   DO WHILE(CONT='0'B);                                           0116
         B     @DE00116                                            0116
@DL00116 DS    0H                                                  0117
*     IF NEWEXT(I)='00'X THEN       /* IF END OF LIST,               */
         LA    @10,NEWEXT-1(I)                                     0117
         CLI   0(@10),X'00'                                        0117
         BNE   @RF00117                                            0117
*       CONT='1'B;                  /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0118
*     ELSE                          /* ELSE,                         */
*       DO;                         /* GET ADDRESS OF PDE            */
         B     @RC00117                                            0119
@RF00117 DS    0H                                                  0120
*         EXTRAN=ADDR(ALLOCPDL)+NEWEXT(I);                         0120
         SLR   EXTRAN,EXTRAN                                       0120
         IC    EXTRAN,NEWEXT-1(I)                                  0120
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0120
*         PDEEXT=0;                 /* SET PDE TO 0                  */
         SLR   @10,@10                                             0121
         STH   @10,PDEEXT(,EXTRAN)                                 0121
*         I=I+1;                    /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0122
*       END;                                                       0123
*   END;                            /* END DO-WHILE                  */
@RC00117 DS    0H                                                  0124
@DE00116 TM    CONT(AWAPTR),B'00010000'                            0124
         BZ    @DL00116                                            0124
*   CONT='0'B;                      /* RE-SET SWITCH                 */
         NI    CONT(AWAPTR),B'11101111'                            0125
*   IF DISPPDE=0 THEN               /* IF DISP NOT SPECIFIED         */
         L     @10,PTRPDL(,AWAPTR)                                 0126
         LH    @07,DISPPDE(,@10)                                   0126
         LTR   @07,@07                                             0126
         BNZ   @RF00126                                            0126
*     DO;                           /* AND                           */
*       IF DSPDE=1 THEN             /* IF DSNAME ENTERED,            */
         CLC   DSPDE(2,@10),@CH00033                               0128
         BNE   @RF00128                                            0128
*         DISPPDE=3;                /* DEFAULT CATALOG               */
         MVC   DISPPDE(2,@10),@CH00323                             0129
*       ELSE                        /* IF DSNAME NOT ENTERED         */
*         DISPPDE=2;                /* DEFAULT DELETE                */
         B     @RC00128                                            0130
@RF00128 L     @10,PTRPDL(,AWAPTR)                                 0130
         MVC   DISPPDE(2,@10),@CH00066                             0130
*     END;                                                         0131
@RC00128 DS    0H                                                  0132
*   R1=AWAPTR;                      /* WORKAREA PTR IN REG 1         */
@RF00126 LR    R1,AWAPTR                                           0132
*   CALL IKJEFD33;                  /* PROCESS SPACE PARAMETERS      */
         L     @15,@CV00339                                        0133
         BALR  @14,@15                                             0133
*   IF RBCODE12='0'B THEN           /* IF ERROR OCCURRED,            */
         TM    RBCODE12(AWAPTR),B'10000000'                        0134
         BNZ   @RF00134                                            0134
*     DO;                                                          0135
*       INC=ADDNUM+1;               /* SET ADDBLOCK SUBSCRIPT        */
         L     @10,GTPLPTR(,AWAPTR)                                0136
         L     @07,GTPLABLK(,@10)                                  0136
         LA    INC,1                                               0136
         MVC   @TF00001(2),ADDNUM(@07)                             0136
         AH    INC,@TF00001                                        0136
*       IF BLOKPDE=3 THEN           /* IF TRK ENTERED, GET           */
         L     @07,PTRPDL(,AWAPTR)                                 0137
         CLC   BLOKPDE(2,@07),@CH00323                             0137
         BNE   @RF00137                                            0137
*         KEYLIST(9)=DALTRK;        /* KEY IN KEYLIST                */
         L     @10,GTPLKLST(,@10)                                  0138
         MVC   KEYLIST+16(2,@10),@CH00572                          0138
*       ELSE                        /* ELSE                          */
*         KEYLIST(9)=DALCYL;        /* CYL KEY IN KEYLIST            */
         B     @RC00137                                            0139
@RF00137 L     @10,GTPLPTR(,AWAPTR)                                0139
         L     @10,GTPLKLST(,@10)                                  0139
         MVC   KEYLIST+16(2,@10),@CH00574                          0139
*       CALL TRANSRTN;              /* TRANSLATE PARAMETERS          */
@RC00137 BAL   @14,TRANSRTN                                        0140
*       IF RBCODE12='0'B THEN       /* IF SUCCESSFUL,                */
         TM    RBCODE12(AWAPTR),B'10000000'                        0141
         BNZ   @RF00141                                            0141
*         DO;                                                      0142
*           CALL DYNSVC;            /* INVOKE ALLOCATION             */
         BAL   @14,DYNSVC                                          0143
*           IF RCODESV>0 THEN       /* IF ALLOC FAILED,              */
         L     @10,RCODESV(,AWAPTR)                                0144
         LTR   @10,@10                                             0144
         BNP   @RF00144                                            0144
*             DO;                   /* AND                           */
*               IF S99ERROR='0410'X THEN/* IF FILE IN USE,           */
         L     @10,PTRS99RB(,AWAPTR)                               0146
         CLC   S99ERROR(2,@10),@CB01444                            0146
         BNE   @RF00146                                            0146
*                 DO;                                              0147
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0148
*                   CALL IKJEFD36;  /* PROMPT FOR OPTION             */
         L     @15,@CV00342                                        0149
         BALR  @14,@15                                             0149
*                 END;                                             0150
*               ELSE                /* OTHER ERROR,                  */
*                 DO;                                              0151
         B     @RC00146                                            0151
@RF00146 DS    0H                                                  0152
*                   RBCODE12='1'B;  /* INDICATE ALLOC FAILED         */
         OI    RBCODE12(AWAPTR),B'10000000'                        0152
*                   ENTRYCD=1;      /* CODE FOR DYNALLOC ERR         */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0153
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0154
*                   CALL IKJEFD35;  /* ISSUE ERROR MESSAGE           */
         L     @15,@CV00340                                        0155
         BALR  @14,@15                                             0155
*                 END;                                             0156
*             END;                                                 0157
*         END;                                                     0158
*     END;                                                         0159
*   END NEWDS;                                                     0160
@EL00002 DS    0H                                                  0160
@EF00002 DS    0H                                                  0160
@ER00002 LM    @14,@12,@SA00002                                    0160
         BR    @14                                                 0160
*                                                                  0161
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      TERMREQ                                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE HANDLES REQUESTS FOR TERMINAL DATA SET         */
*/*      ALLOCATION.                                                 */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      EXTRANEOUS PARAMETERS ARE MARKED NOT ENTERED IN THE PDL.    */
*/*      IF BLOCK WAS ENTERED INVOKE IKJEFD33 TO SET UP DCB BLOCK    */
*/*      SIZE TEXT UNIT.  SET UP THE TEXT UNIT WHICH                 */
*/*      INDICATES TERMINAL ALLOCATION, AND MARK DATASET NOT         */
*/*      ENTERED IN THE PDL. INVOKE GENTRANS. IF GENTRANS SUCCESSFUL */
*/*      INVOKE DYNAMIC ALLOCATION.                                  */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - FAILURE IN GENTRANS OR ALLOCATION            */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/*                                                                  */
*/*        THE TEXT UNIT SPECIFYING TERMINAL ALLOCATION MUST BE SET  */
*/*        UP SINCE GENTRANS DOES NOT RECOGNIZE A DATA SET NAME OF   */
*/*        ASTERISK (*).                                             */
*/********************************************************************/
*                                                                  0161
*TERMREQ:                                                          0161
*   PROC;                                                          0161
TERMREQ  STM   @14,@12,@SA00003                                    0161
*   I=1;                            /* INITIALIZE SUBSCRIPT          */
*                                                                  0162
         LA    I,1                                                 0162
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0163
*   DO WHILE(CONT='0'B);                                           0163
         B     @DE00163                                            0163
@DL00163 DS    0H                                                  0164
*     IF TERMEXT(I)='00'X THEN      /* IF END OF LIST,               */
         LA    @10,TERMEXT-1(I)                                    0164
         CLI   0(@10),X'00'                                        0164
         BNE   @RF00164                                            0164
*       CONT='1'B;                  /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0165
*     ELSE                          /* ELSE,                         */
*       DO;                         /* GET ADDRESS OF PDE            */
         B     @RC00164                                            0166
@RF00164 DS    0H                                                  0167
*         EXTRAN=ADDR(ALLOCPDL)+TERMEXT(I);                        0167
         SLR   EXTRAN,EXTRAN                                       0167
         IC    EXTRAN,TERMEXT-1(I)                                 0167
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0167
*         PDEEXT=0;                 /* SET PDE TO 0                  */
         SLR   @10,@10                                             0168
         STH   @10,PDEEXT(,EXTRAN)                                 0168
*         I=I+1;                    /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0169
*       END;                                                       0170
*   END;                                                           0171
@RC00164 DS    0H                                                  0171
@DE00163 TM    CONT(AWAPTR),B'00010000'                            0171
         BZ    @DL00163                                            0171
*   CONT='0'B;                                                     0172
         NI    CONT(AWAPTR),B'11101111'                            0172
*   IF BLOKPDE=1 THEN               /* IF BLOCK ENTERED,             */
         L     @10,PTRPDL(,AWAPTR)                                 0173
         CLC   BLOKPDE(2,@10),@CH00033                             0173
         BNE   @RF00173                                            0173
*     DO;                                                          0174
*       R1=AWAPTR;                  /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0175
*       CALL IKJEFD33;              /* PROCESS PARM                  */
         L     @15,@CV00339                                        0176
         BALR  @14,@15                                             0176
*       INC=ADDNUM+1;               /* SET ADDBLOCK SUBSCRIPT        */
         L     @10,GTPLPTR(,AWAPTR)                                0177
         L     @10,GTPLABLK(,@10)                                  0177
         LA    INC,1                                               0177
         MVC   @TF00001(2),ADDNUM(@10)                             0177
         AH    INC,@TF00001                                        0177
*     END;                                                         0178
*   BLOKPDE=0;                      /* MARK BLOCK NOT ENTERED        */
@RF00173 SLR   @10,@10                                             0179
         L     @07,PTRPDL(,AWAPTR)                                 0179
         STH   @10,BLOKPDE(,@07)                                   0179
*   ADDNUM=ADDNUM+1;                /* INCREMENT ENTRY CTR           */
         L     @05,GTPLPTR(,AWAPTR)                                0180
         L     @05,GTPLABLK(,@05)                                  0180
         LA    @02,1                                               0180
         MVC   @TF00001(2),ADDNUM(@05)                             0180
         LH    @15,@TF00001                                        0180
         ALR   @15,@02                                             0180
         ST    @15,@TF00001                                        0180
         MVC   ADDNUM(2,@05),@TF00001+2                            0180
*   ADLKEY=DALTERM;                 /* TERMINAL KEY IN TEXT          */
         L     @15,TXT(,AWAPTR)                                    0181
         MVC   ADLKEY(2,@15),@CH00638                              0181
*   ADLNBR=0;                       /* SET NUMBER ZERO               */
         STH   @10,ADLNBR(,@15)                                    0182
*   ADDTEXT(INC)=TXT;               /* TEXT PTR IN ADDRESS LIST      */
         LR    @14,INC                                             0183
         SLA   @14,2                                               0183
         ST    @15,@TF00001                                        0183
         ALR   @05,@14                                             0183
         MVC   ADDTEXT-4(4,@05),@TF00001                           0183
*   TXT=TXT+4;                      /* INCREMENT TEXT PTR            */
         AL    @15,@CF00321                                        0184
         ST    @15,TXT(,AWAPTR)                                    0184
*   INC=INC+1;                      /* INCREMENT SUBSCRIPT           */
         ALR   INC,@02                                             0185
*   DSPDE=0;                        /* MARK DATASET NOT ENTERED      */
         STH   @10,DSPDE(,@07)                                     0186
*   CALL TRANSRTN;                  /* TRANSLATE PARAMETERS          */
         BAL   @14,TRANSRTN                                        0187
*   IF RBCODE12='0'B THEN           /* IF TRANSLATE SUCCESSFUL,      */
         TM    RBCODE12(AWAPTR),B'10000000'                        0188
         BNZ   @RF00188                                            0188
*     DO;                           /* THEN                          */
*       CALL DYNSVC;                /* INVOKE DYN ALLOCATION         */
         BAL   @14,DYNSVC                                          0190
*       IF RCODESV>0 THEN           /* IF ALLOCATION FAILED,         */
         L     @10,RCODESV(,AWAPTR)                                0191
         LTR   @10,@10                                             0191
         BNP   @RF00191                                            0191
*         DO;                       /* DETERMINE IF FILE IN USE      */
*           IF S99ERROR='0410'X THEN                               0193
         L     @10,PTRS99RB(,AWAPTR)                               0193
         CLC   S99ERROR(2,@10),@CB01444                            0193
         BNE   @RF00193                                            0193
*             DO;                   /* YES -                         */
*               R1=AWAPTR;          /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0195
*               CALL IKJEFD36;      /* PROMPT FOR OPTION             */
         L     @15,@CV00342                                        0196
         BALR  @14,@15                                             0196
*             END;                                                 0197
*           ELSE                    /* NO -                          */
*             DO;                   /* THEN,                         */
         B     @RC00193                                            0198
@RF00193 DS    0H                                                  0199
*               RBCODE12='1'B;      /* INDICATE ALLOCATE FAILED      */
         OI    RBCODE12(AWAPTR),B'10000000'                        0199
*               ENTRYCD=1;          /* CODE FOR DYNALLOC ERR         */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0200
*               R1=AWAPTR;          /* WORKAREA PTR IN REG 1 ISSUE 0201
*                                      ERROR MESSAGE                 */
         LR    R1,AWAPTR                                           0201
*               CALL IKJEFD35;                                     0202
         L     @15,@CV00340                                        0202
         BALR  @14,@15                                             0202
*             END;                                                 0203
*         END;                                                     0204
*     END;                                                         0205
*   END TERMREQ;                                                   0206
@EL00003 DS    0H                                                  0206
@EF00003 DS    0H                                                  0206
@ER00003 LM    @14,@12,@SA00003                                    0206
         BR    @14                                                 0206
*                                                                  0207
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      SYSOTREQ                                                    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE PROCESSES REQUESTS FOR A SYSOUT DATA SET.      */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      EXTRANEOUS PARAMETERS ARE MARKED NOT ENTERED IN THE PDL.    */
*/*      IF BLOCK IS ENTERED INVOKE IKJEFD33 TO SET UP               */
*/*      THE TEXT UNIT FOR DCB BLOCK SIZE FROM THE BLOCK VALUE       */
*/*      IF NOHOLD WAS ENTERED, MARK THE HOLD PARAMETER              */
*/*      NOT ENTERED IN THE PDL. IF SYSOUT CLASS WAS NOT SPECIFIED,  */
*/*      SET UP THE TEXT UNIT TO INDICATE CLASS DEFAULT AND MARK     */
*/*      THE SYSOUT PARAMETER NOT ENTERED IN THE PDL. INVOKE         */
*/*      GENTRANS TO TRANSLATE THE PARAMETERS. IF GENTRANS SUCCESSFUL*/
*/*      INVOKE DYNAMIC ALLOCATION. IF ALLOCATION FAILED BECAUSE     */
*/*      OF FILE IN USE, INVOKE IKJEFD36 TO PROMPT THE USER FOR      */
*/*      THE OPTION. ELSE, INVOKE IKJEFD35 TO ISSUE AN ERROR MESSAGE */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - ERROR IN GENTRANS OR ALLOCATION              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/*                                                                  */
*/*        IF THE CLASS SUBFIELD WAS NOT ENTERED, THE TEXT UNIT FOR  */
*/*        SYSOUT MUST BE SET UP SINCE GENTRANS EXPECTS THE SUBFIELD */
*/*        TO BE PRESENT, AND WILL FLAG IT AS AN ERROR IF IT IS NOT. */
*/********************************************************************/
*                                                                  0207
*SYSOTREQ:                                                         0207
*   PROC;                                                          0207
SYSOTREQ STM   @14,@12,@SA00004                                    0207
*   I=1;                            /* INITIALIZE SUBSCRIPT          */
*                                                                  0208
         LA    I,1                                                 0208
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*   DO WHILE(CONT='0'B);                                           0209
         B     @DE00209                                            0209
@DL00209 DS    0H                                                  0210
*     IF SYSOTEXT(I)='00'X THEN     /* IF END OF LIST,               */
         LA    @10,SYSOTEXT-1(I)                                   0210
         CLI   0(@10),X'00'                                        0210
         BNE   @RF00210                                            0210
*       CONT='1'B;                  /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0211
*     ELSE                          /* ELSE,                         */
*       DO;                         /* GET ADDRESS OF PDE            */
         B     @RC00210                                            0212
@RF00210 DS    0H                                                  0213
*         EXTRAN=ADDR(ALLOCPDL)+SYSOTEXT(I);                       0213
         SLR   EXTRAN,EXTRAN                                       0213
         IC    EXTRAN,SYSOTEXT-1(I)                                0213
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0213
*         PDEEXT=0;                 /* SET PDE TO 0                  */
         SLR   @10,@10                                             0214
         STH   @10,PDEEXT(,EXTRAN)                                 0214
*         I=I+1;                    /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0215
*       END;                                                       0216
*   END;                            /* END DO-WHILE                  */
@RC00210 DS    0H                                                  0217
@DE00209 TM    CONT(AWAPTR),B'00010000'                            0217
         BZ    @DL00209                                            0217
*   CONT='0'B;                      /* RESET SWITCH                  */
         NI    CONT(AWAPTR),B'11101111'                            0218
*   IF SPACEPDE>0×                  /* IF SPACE OR                   */
*       BLOKPDE>0 THEN              /* BLOCK ENTERED THEN            */
         SLR   @10,@10                                             0219
         L     @07,PTRPDL(,AWAPTR)                                 0219
         CH    @10,SPACEPDE(,@07)                                  0219
         BL    @RT00219                                            0219
         CH    @10,BLOKPDE(,@07)                                   0219
         BNL   @RF00219                                            0219
@RT00219 DS    0H                                                  0220
*     DO;                                                          0220
*       R1=AWAPTR;                  /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0221
*       CALL IKJEFD33;              /* PROCESS SPACE                 */
         L     @15,@CV00339                                        0222
         BALR  @14,@15                                             0222
*       INC=ADDNUM+1;               /* SET ADDBLOCK SUBSCRIPT        */
         L     @10,GTPLPTR(,AWAPTR)                                0223
         L     @07,GTPLABLK(,@10)                                  0223
         LA    INC,1                                               0223
         MVC   @TF00001(2),ADDNUM(@07)                             0223
         AH    INC,@TF00001                                        0223
*       IF BLOKPDE=3 THEN                                          0224
         L     @07,PTRPDL(,AWAPTR)                                 0224
         CLC   BLOKPDE(2,@07),@CH00323                             0224
         BNE   @RF00224                                            0224
*         KEYLIST(9)=DALTRK;                                       0225
         L     @10,GTPLKLST(,@10)                                  0225
         MVC   KEYLIST+16(2,@10),@CH00572                          0225
*       ELSE                                                       0226
*         KEYLIST(9)=DALCYL;                                       0226
         B     @RC00224                                            0226
@RF00224 L     @10,GTPLPTR(,AWAPTR)                                0226
         L     @10,GTPLKLST(,@10)                                  0226
         MVC   KEYLIST+16(2,@10),@CH00574                          0226
*     END;                                                         0227
@RC00224 DS    0H                                                  0228
*   IF RBCODE12='0'B THEN                                          0228
@RF00219 TM    RBCODE12(AWAPTR),B'10000000'                        0228
         BNZ   @RF00228                                            0228
*     DO;                                                          0229
*       IF HOLDPDE=2 THEN           /* IF NOHOLD SPECIFIED,          */
         L     @10,PTRPDL(,AWAPTR)                                 0230
         CLC   HOLDPDE(2,@10),@CH00066                             0230
         BNE   @RF00230                                            0230
*         HOLDPDE=0;                /* MARK NOT ENTERED              */
         SLR   @07,@07                                             0231
         STH   @07,HOLDPDE(,@10)                                   0231
*       IF CLASPRES='0'B THEN       /* IF CLASS NOT ENTERED,         */
@RF00230 L     @10,PTRPDL(,AWAPTR)                                 0232
         TM    CLASPRES(@10),B'10000000'                           0232
         BNZ   @RF00232                                            0232
*         DO;                       /* THEN                          */
*           ADDNUM=ADDNUM+1;        /* INCREMENT TEXT COUNTER        */
         L     @07,GTPLPTR(,AWAPTR)                                0234
         L     @07,GTPLABLK(,@07)                                  0234
         LA    @05,1                                               0234
         MVC   @TF00001(2),ADDNUM(@07)                             0234
         LH    @02,@TF00001                                        0234
         ALR   @02,@05                                             0234
         ST    @02,@TF00001                                        0234
         MVC   ADDNUM(2,@07),@TF00001+2                            0234
*           ADLKEY=DALSYSOU;        /* SET UP TEXT - KEY,            */
         L     @02,TXT(,AWAPTR)                                    0235
         MVC   ADLKEY(2,@02),@CH00606                              0235
*           ADLNBR=0;               /* AND NUMBER                    */
         SLR   @15,@15                                             0236
         STH   @15,ADLNBR(,@02)                                    0236
*           ADDTEXT(INC)=TXT;       /* PUT ADDRESS IN LIST           */
         LR    @14,INC                                             0237
         SLA   @14,2                                               0237
         ST    @02,@TF00001                                        0237
         ALR   @07,@14                                             0237
         MVC   ADDTEXT-4(4,@07),@TF00001                           0237
*           TXT=TXT+4;              /* INCREMENT TEXT PTR            */
         AL    @02,@CF00321                                        0238
         ST    @02,TXT(,AWAPTR)                                    0238
*           INC=INC+1;              /* INCREMENT ADDR SUBSCRIPT      */
         ALR   INC,@05                                             0239
*           STATSPDE=0;             /* MARK SYSOUT NOT ENTERED       */
         STH   @15,STATSPDE(,@10)                                  0240
*         END;                                                     0241
*       CALL TRANSRTN;              /* TRANSLATE PARAMETERS          */
@RF00232 BAL   @14,TRANSRTN                                        0242
*       IF RBCODE12='0'B THEN       /* IF TRANSLATE SUCCESSFUL,      */
         TM    RBCODE12(AWAPTR),B'10000000'                        0243
         BNZ   @RF00243                                            0243
*         DO;                       /* THEN                          */
*           CALL DYNSVC;            /* INVOKE DYN ALLOCATION         */
         BAL   @14,DYNSVC                                          0245
*           IF RCODESV>0 THEN       /* IF ALLOCATION FAILED,         */
         L     @10,RCODESV(,AWAPTR)                                0246
         LTR   @10,@10                                             0246
         BNP   @RF00246                                            0246
*             DO;                   /* AND IF FILE IN USE,           */
*               IF S99ERROR='0410'X THEN                           0248
         L     @10,PTRS99RB(,AWAPTR)                               0248
         CLC   S99ERROR(2,@10),@CB01444                            0248
         BNE   @RF00248                                            0248
*                 DO;                                              0249
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0250
*                   CALL IKJEFD36;  /* PROMPT USER FOR OPTION        */
         L     @15,@CV00342                                        0251
         BALR  @14,@15                                             0251
*                 END;                                             0252
*               ELSE                                               0253
*                 DO;               /* OTHERWISE,                    */
         B     @RC00248                                            0253
@RF00248 DS    0H                                                  0254
*                   RBCODE12='1'B;  /* INDICATE ALLOC FAILED         */
         OI    RBCODE12(AWAPTR),B'10000000'                        0254
*                   ENTRYCD=1;      /* CODE FOR DYNALLOC ERR         */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0255
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0256
*                   CALL IKJEFD35;  /* INVOKE DAIRFAIL               */
         L     @15,@CV00340                                        0257
         BALR  @14,@15                                             0257
*                 END;                                             0258
*             END;                                                 0259
*         END;                                                     0260
*     END;                                                         0261
*   END SYSOTREQ;                                                  0262
@EL00004 DS    0H                                                  0262
@EF00004 DS    0H                                                  0262
@ER00004 LM    @14,@12,@SA00004                                    0262
         BR    @14                                                 0262
*                                                                  0263
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      DMMYREQ                                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE ALLOCATES A DUMMY DATA SET.                    */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      EXTRANEOUS PARAMETERS ARE MARKED NOT ENTERED IN THE PDL.    */
*/*      IF BLOCK WAS ENTERED INVOKE IKJEFD33 TO SET UP THE          */
*/*      TEXT UNIT FOR DCB BLOCK SIZE. INVOKE GENTRANS. IF GENTRANS  */
*/*      SUCCESSFUL, INVOKE DYNAMIC ALLOCATION. IF DYNAMIC           */
*/*      ALLOCATION FAILED BECAUSE OF FILE IN USE, CALL ROUTINE      */
*/*      IKJEFD36 TO PROMPT FOR OPTION. ELSE, INVOKE IKJEFD35        */
*/*      TO ISSUE ERROR MESSAGE.                                     */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - FAILURE IN GENTRANS OR ALLOCATION            */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/********************************************************************/
*                                                                  0263
*DMMYREQ:                                                          0263
*   PROC;                                                          0263
DMMYREQ  STM   @14,@12,@SA00005                                    0263
*   I=1;                            /* INITIALIZE SUBSCRIPT          */
*                                                                  0264
         LA    I,1                                                 0264
*   /*****************************************************************/
*   /*                                                               */
*   /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0265
*   DO WHILE(CONT='0'B);                                           0265
         B     @DE00265                                            0265
@DL00265 DS    0H                                                  0266
*     IF DMMYEXT(I)='00'X THEN      /* IF END OF LIST,               */
         LA    @10,DMMYEXT-1(I)                                    0266
         CLI   0(@10),X'00'                                        0266
         BNE   @RF00266                                            0266
*       CONT='1'B;                  /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0267
*     ELSE                          /* ELSE,                         */
*       DO;                         /* GET ADDRESS OF PDE            */
         B     @RC00266                                            0268
@RF00266 DS    0H                                                  0269
*         EXTRAN=ADDR(ALLOCPDL)+DMMYEXT(I);                        0269
         SLR   EXTRAN,EXTRAN                                       0269
         IC    EXTRAN,DMMYEXT-1(I)                                 0269
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0269
*         PDEEXT=0;                 /* SET PDE TO 0                  */
         SLR   @10,@10                                             0270
         STH   @10,PDEEXT(,EXTRAN)                                 0270
*         I=I+1;                    /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0271
*       END;                                                       0272
*   END;                            /* END DO-WHILE                  */
@RC00266 DS    0H                                                  0273
@DE00265 TM    CONT(AWAPTR),B'00010000'                            0273
         BZ    @DL00265                                            0273
*   CONT='0'B;                      /* RESET SWITCH                  */
         NI    CONT(AWAPTR),B'11101111'                            0274
*   IF BLOKPDE=1 THEN               /* IF BLOCK ENTERED,             */
         L     @10,PTRPDL(,AWAPTR)                                 0275
         CLC   BLOKPDE(2,@10),@CH00033                             0275
         BNE   @RF00275                                            0275
*     DO;                                                          0276
*       R1=AWAPTR;                  /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0277
*       CALL IKJEFD33;              /* PROCESS PARAMETER             */
         L     @15,@CV00339                                        0278
         BALR  @14,@15                                             0278
*       INC=ADDNUM+1;               /* SET ADDBLOCK SUBSCRIPT        */
         L     @10,GTPLPTR(,AWAPTR)                                0279
         L     @10,GTPLABLK(,@10)                                  0279
         LA    INC,1                                               0279
         MVC   @TF00001(2),ADDNUM(@10)                             0279
         AH    INC,@TF00001                                        0279
*     END;                                                         0280
*   IF RBCODE12='0'B THEN           /* IF NO ERROR OCCURRED,         */
@RF00275 TM    RBCODE12(AWAPTR),B'10000000'                        0281
         BNZ   @RF00281                                            0281
*     DO;                           /* THEN,                         */
*       BLOKPDE=0;                  /* MARK BLOCK NOT ENTERED        */
         L     @10,PTRPDL(,AWAPTR)                                 0283
         SLR   @07,@07                                             0283
         STH   @07,BLOKPDE(,@10)                                   0283
*       CALL TRANSRTN;              /* TRANSLATE PARAMETERS          */
         BAL   @14,TRANSRTN                                        0284
*       IF RBCODE12='0'B THEN       /* IF TRANSLATE SUCCESSFUL,      */
         TM    RBCODE12(AWAPTR),B'10000000'                        0285
         BNZ   @RF00285                                            0285
*         DO;                       /* THEN                          */
*           CALL DYNSVC;            /* INVOKE DYN ALLOCATION         */
         BAL   @14,DYNSVC                                          0287
*           IF RCODESV>0 THEN       /* IF ALLOCATION FAILED,         */
         L     @10,RCODESV(,AWAPTR)                                0288
         LTR   @10,@10                                             0288
         BNP   @RF00288                                            0288
*             DO;                   /* THEN IF FILE IN USE,          */
*               IF S99ERROR='0410'X THEN                           0290
         L     @10,PTRS99RB(,AWAPTR)                               0290
         CLC   S99ERROR(2,@10),@CB01444                            0290
         BNE   @RF00290                                            0290
*                 DO;                                              0291
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1 PROMPT
*                                      FOR OPTION                    */
         LR    R1,AWAPTR                                           0292
*                   CALL IKJEFD36;                                 0293
         L     @15,@CV00342                                        0293
         BALR  @14,@15                                             0293
*                 END;                                             0294
*               ELSE                                               0295
*                 DO;               /* OTHER ERROR -                 */
         B     @RC00290                                            0295
@RF00290 DS    0H                                                  0296
*                   RBCODE12='1'B;  /* SET ALLOC FAILED INDICATOR    */
         OI    RBCODE12(AWAPTR),B'10000000'                        0296
*                   ENTRYCD=1;      /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0297
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1 ISSUE 0298
*                                      ERROR MESSAGE                 */
         LR    R1,AWAPTR                                           0298
*                   CALL IKJEFD35;                                 0299
         L     @15,@CV00340                                        0299
         BALR  @14,@15                                             0299
*                 END;                                             0300
*             END;                                                 0301
*         END;                                                     0302
*     END;                                                         0303
*   END DMMYREQ;                                                   0304
@EL00005 DS    0H                                                  0304
@EF00005 DS    0H                                                  0304
@ER00005 LM    @14,@12,@SA00005                                    0304
         BR    @14                                                 0304
*                                                                  0305
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      MODDS                                                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE HANDLES REQUESTS FOR ALLOCATION OF MOD DATA    */
*/*      SETS.                                                       */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      IF DATA SET NAME NOT ENTERED, PROMPT THE USER. MARK         */
*/*      EXTRANEOUS PARAMETERS NOT ENTERED IN PDL. IF DISPOSITION    */
*/*      NOT ENTERED, DETERMINE WHETHER DEFAULT SHOULD BE KEEP OR    */
*/*      CATALOG.  IF SPACE PARAMETERS HAVE BEEN ENTERED,            */
*/*      INVOKE IKJEFD33 TO PROCESS THEM. SET APPROPRIATE            */
*/*      TRACKS OR CYLINDERS KEY IN KEY LIST. INVOKE GENTRANS        */
*/*      TO TRANSLATE PARAMETERS. IF GENTRANS SUCCESSFUL, INVOKE     */
*/*      DYNAMIC ALLOCATION. IF ALLOCATION FAILED, DETERMINE         */
*/*      IF FILE IN USE. IF SO, PROMPT THE USER TO SPECIFY THE       */
*/*      OPTION. ELSE, ISSUE ERROR MESSAGE.                          */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - ERROR IN GENTRANS OR ALLOCATION              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/********************************************************************/
*                                                                  0305
*MODDS:                                                            0305
*   PROC;                                                          0305
MODDS    STM   @14,@12,@SA00006                                    0305
*   IF DSPDE=0 THEN                 /* IF DSN NOT ENTERED,           */
         L     @10,PTRPDL(,AWAPTR)                                 0306
         LH    @10,DSPDE(,@10)                                     0306
         LTR   @10,@10                                             0306
         BNZ   @RF00306                                            0306
*     DO;                           /* THEN                          */
*       CALL PRMPDSN;               /* PROMPT FOR DSNAME             */
         BAL   @14,PRMPDSN                                         0308
*       IF RBCODE12='0'B THEN                                      0309
         TM    RBCODE12(AWAPTR),B'10000000'                        0309
         BNZ   @RF00309                                            0309
*         DO;                                                      0310
*           DSPDE=1;                /* MARK DS KEYWORD ENTERED       */
         L     @10,PTRPDL(,AWAPTR)                                 0311
         MVC   DSPDE(2,@10),@CH00033                               0311
*           DSOVRLAY='1'B;          /* INDICATE PDL TO BE FREED      */
         OI    DSOVRLAY(AWAPTR),B'01000000'                        0312
*           SAVDSPDL=PMPTPDL;       /* SAVE PDL PTR          @YM04998*/
*                                                                  0313
         L     @07,PMPTPDL(,AWAPTR)                                0313
         ST    @07,SAVDSPDL                                        0313
*           /*********************************************************/
*           /*                                                       */
*           /* DETERMINE LENGTH OF PDE TO BE COPIED, AND OVERLAY     */
*           /* ORIGINAL PDE WITH PROMPT PDE.                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0314
*           MOVELEN=ADDR(DDNMEPDE)-ADDR(DSNPDE);                   0314
         LA    MOVELEN,28                                          0314
*           DSNPDE(1:MOVELEN)=DSNAMPDE(1:MOVELEN);                 0315
         LR    @15,MOVELEN                                         0315
         BCTR  @15,0                                               0315
         EX    @15,@SM01509                                        0315
*         END;                                                     0316
*     END;                                                         0317
@RF00309 DS    0H                                                  0318
*   IF RBCODE12='0'B THEN           /* IF NO ERROR FOUND,            */
@RF00306 TM    RBCODE12(AWAPTR),B'10000000'                        0318
         BNZ   @RF00318                                            0318
*     DO;                           /* CONTINUE -                    */
*       I=1;                        /* INITIALIZE SUBSCRIPT          */
*                                                                  0320
         LA    I,1                                                 0320
*       /*************************************************************/
*       /*                                                           */
*       /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0321
*       DO WHILE(CONT='0'B);                                       0321
         B     @DE00321                                            0321
@DL00321 DS    0H                                                  0322
*         IF NEWEXT(I)='00'X THEN   /* IF END OF LIST,               */
         LA    @10,NEWEXT-1(I)                                     0322
         CLI   0(@10),X'00'                                        0322
         BNE   @RF00322                                            0322
*           CONT='1'B;              /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0323
*         ELSE                      /* ELSE,                         */
*           DO;                     /* GET ADDRESS OF PDE            */
         B     @RC00322                                            0324
@RF00322 DS    0H                                                  0325
*             EXTRAN=ADDR(ALLOCPDL)+NEWEXT(I);                     0325
         SLR   EXTRAN,EXTRAN                                       0325
         IC    EXTRAN,NEWEXT-1(I)                                  0325
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0325
*             PDEEXT=0;             /* SET PDE TO 0                  */
         SLR   @10,@10                                             0326
         STH   @10,PDEEXT(,EXTRAN)                                 0326
*             I=I+1;                /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0327
*           END;                                                   0328
*       END;                        /* END DO-WHILE                  */
@RC00322 DS    0H                                                  0329
@DE00321 TM    CONT(AWAPTR),B'00010000'                            0329
         BZ    @DL00321                                            0329
*       CONT='0'B;                  /* RESET SWITCH                  */
         NI    CONT(AWAPTR),B'11101111'                            0330
*       CALL CHKDISP;               /* DEFAULT               @YM02616*/
         BAL   @14,CHKDISP                                         0331
*       IF RBCODE12='0'B THEN                                      0332
         TM    RBCODE12(AWAPTR),B'10000000'                        0332
         BNZ   @RF00332                                            0332
*         DO;                                                      0333
*           R1=AWAPTR;              /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0334
*           CALL IKJEFD33;          /* PROCESS SPACE PARAMETERS      */
         L     @15,@CV00339                                        0335
         BALR  @14,@15                                             0335
*           INC=ADDNUM+1;           /* SET ADDBLOCK SUBSCRIPT        */
         L     @10,GTPLPTR(,AWAPTR)                                0336
         L     @07,GTPLABLK(,@10)                                  0336
         LA    INC,1                                               0336
         MVC   @TF00001(2),ADDNUM(@07)                             0336
         AH    INC,@TF00001                                        0336
*           IF BLOKPDE=3 THEN       /* IF TRACKS ENTERED,            */
         L     @07,PTRPDL(,AWAPTR)                                 0337
         CLC   BLOKPDE(2,@07),@CH00323                             0337
         BNE   @RF00337                                            0337
*             KEYLIST(9)=DALTRK;    /* INDICATE IN KEYLIST           */
         L     @10,GTPLKLST(,@10)                                  0338
         MVC   KEYLIST+16(2,@10),@CH00572                          0338
*           ELSE                    /* ELSE                          */
*             KEYLIST(9)=DALCYL;    /* INDICATE CYL IN KEYLIST       */
         B     @RC00337                                            0339
@RF00337 L     @10,GTPLPTR(,AWAPTR)                                0339
         L     @10,GTPLKLST(,@10)                                  0339
         MVC   KEYLIST+16(2,@10),@CH00574                          0339
*           CALL TRANSRTN;          /* TRANSLATE PARAMETERS          */
@RC00337 BAL   @14,TRANSRTN                                        0340
*           IF RBCODE12='0'B THEN   /* IF TRANSLATE SUCCESSFUL       */
         TM    RBCODE12(AWAPTR),B'10000000'                        0341
         BNZ   @RF00341                                            0341
*             DO;                   /* THEN                          */
*               CALL DYNSVC;        /* INVOKE DYN ALLOCATION         */
         BAL   @14,DYNSVC                                          0343
*               IF RCODESV>0 THEN   /* IF RETURN CODE NON-ZERO       */
         L     @10,RCODESV(,AWAPTR)                                0344
         LTR   @10,@10                                             0344
         BNP   @RF00344                                            0344
*                 DO;               /* THEN DETERMINE IF FILE IN USE */
*                   IF S99ERROR='0410'X THEN                       0346
         L     @10,PTRS99RB(,AWAPTR)                               0346
         CLC   S99ERROR(2,@10),@CB01444                            0346
         BNE   @RF00346                                            0346
*                     DO;           /* YES -                         */
*                       R1=AWAPTR;  /* WORKAREA PTR IN REG 1 PROMPT
*                                      FOR OPTION                    */
         LR    R1,AWAPTR                                           0348
*                       CALL IKJEFD36;                             0349
         L     @15,@CV00342                                        0349
         BALR  @14,@15                                             0349
*                     END;                                         0350
*                   ELSE                                           0351
*                     DO;           /* NO -                          */
         B     @RC00346                                            0351
@RF00346 DS    0H                                                  0352
*                       RBCODE12='1'B;/* INDICATE ALLOC FAILED       */
         OI    RBCODE12(AWAPTR),B'10000000'                        0352
*                       ENTRYCD=1;  /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0353
*                       R1=AWAPTR;  /* WORKAREA PTR IN REG 1 ISSUE 0354
*                                      ERROR MESSAGE                 */
         LR    R1,AWAPTR                                           0354
*                       CALL IKJEFD35;                             0355
         L     @15,@CV00340                                        0355
         BALR  @14,@15                                             0355
*                     END;                                         0356
*                 END;                                             0357
@RC00346 DS    0H                                                  0358
*             END;                                                 0358
@RF00344 DS    0H                                                  0359
*           IF DSOVRLAY='1'B THEN   /* IF PDL TO FREE,               */
@RF00341 TM    DSOVRLAY(AWAPTR),B'01000000'                        0359
         BNO   @RF00359                                            0359
*             DO;                   /* THEN                          */
*               DSOVRLAY='0'B;      /* TURN OFF INDICATOR            */
         NI    DSOVRLAY(AWAPTR),B'10111111'                        0361
*               RFY                                                0362
*                 R5 RSTD;          /* RESTRICT REG 5                */
*               R5=ADDR(SAVDSPDL);  /* PDL ADDR IN REG 5     @YM04998*/
         LA    R5,SAVDSPDL                                         0363
*               GEN(IKJRLSA (5));   /* RELEASE PDL                   */
         IKJRLSA (5)
*               RFY                                                0365
*                 R5 UNRSTD;        /* UNRESTRICT REG 5              */
*             END;                                                 0366
*         END;                                                     0367
*     END;                                                         0368
*   END MODDS;                                                     0369
@EL00006 DS    0H                                                  0369
@EF00006 DS    0H                                                  0369
@ER00006 LM    @14,@12,@SA00006                                    0369
         BR    @14                                                 0369
*                                                                  0370
*/********************************************************************
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* SEGMENT NAME -                                            @YM02616
*                                                                    */
*/*      CHKDISP                                              @YM02616
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* FUNCTION -                                                @YM02616
*                                                                    */
*/*      THIS ROUTINE DETERMINES THE DEFAULT DISPOSITION      @YM02616
*                                                                    */
*/*      FOR MOD DATA SETS.                                   @YM02616
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* OPERATION -                                               @YM02616
*                                                                    */
*/*      IF VOLUME WAS SPECIFIED, THE DEFAULT DISPOSITION IS  @YM02616
*                                                                    */
*/*      KEEP. OTHERWISE, INVOKE DAIR WITH ENTRY CODE '04' TO @YM02616
*                                                                    */
*/*      DETERMINE IF THE DATA SET EXISTS. IF SO, THE DEFAULT @YM02616
*                                                                    */
*/*      DISPOSITION IS KEEP. IF NOT, THE DEFAULT DISPOSITION @YM02616
*                                                                    */
*/*      IS CATALOG.                                          @YM02616
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* INPUT -                                                   @YM02616
*                                                                    */
*/*      PTR TO PDL                                           @YM02616
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* OUTPUT -                                                  @YM02616
*                                                                    */
*/*      DEFUALT DISPOSITION SET IN PDL                       @YM02616
*                                                                    */
*/*                                                           @YM02616
*                                                                    */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION     @YM02616
*                                                                    */
*/*        AND CAN BE INCORPORATED AS AN INCLUDED CODE        @YM02616
*                                                                    */
*/*        SEGMENT WHEN THE INCLUDE FUNCTION HAS RECEIVED A   @YM02616
*                                                                    */
*/*        STANDARD DEFINITION.                               @YM02616
*                                                                    */
*/********************************************************************
*                                                                    */
*                                                                  0370
*CHKDISP:                                                          0370
*   PROC;                                                          0370
CHKDISP  STM   @14,@12,@SA00007                                    0370
*   DAPLPTR=ADDR(DAPLAREA);         /* PTR TO DAPL           @YM02616*/
         LA    DAPLPTR,DAPLAREA                                    0371
*   DAPLUPT=CPPLUPT;                /* UPT IN DAPL           @YM02616*/
         L     @10,CPPLPTR(,AWAPTR)                                0372
         L     @15,CPPLUPT(,@10)                                   0372
         ST    @15,DAPLUPT(,DAPLPTR)                               0372
*   DAPLECT=CPPLECT;                /* ECT IN DAPL           @YM02616*/
         L     @15,CPPLECT(,@10)                                   0373
         ST    @15,DAPLECT(,DAPLPTR)                               0373
*   DAPLECB=ADDR(COMMECB);          /* ECB IN DAPL           @YM02616*/
         LA    @15,COMMECB(,AWAPTR)                                0374
         ST    @15,DAPLECB(,DAPLPTR)                               0374
*   DAPLPSCB=CPPLPSCB;              /* PSCB IN DAPL          @YM02616*/
         L     @10,CPPLPSCB(,@10)                                  0375
         ST    @10,DAPLPSCB(,DAPLPTR)                              0375
*   DAPB0PTR=ADDR(DAIRAREA);        /* PTR TO DAPB04         @YM02616
*                                      ZERO DAPB04           @YM02616*/
         LA    DAPB0PTR,DAIRAREA                                   0376
*   DAIRAREA=DAIRAREA&&DAIRAREA;                                   0377
         XC    DAIRAREA(16),DAIRAREA                               0377
*   DAIRDSBF=' ';                   /* BLANK DSN BUFFER      @YM02616*/
         MVI   DAIRDSBF+1,C' '                                     0378
         MVC   DAIRDSBF+2(44),DAIRDSBF+1                           0378
         MVI   DAIRDSBF,C' '                                       0378
*   DA04CD='0004'X;                 /* FUNCTION CODE         @YM02616*/
         MVC   DA04CD(2,DAPB0PTR),@CB00566                         0379
*   DAIRDSLN=DSNLENGH;              /* LENGTH OF DSNAME      @YM02616
*                                      MOVE DSN TO BUFFER    @YM02616*/
         L     @10,PTRPDL(,AWAPTR)                                 0380
         LH    @15,DSNLENGH(,@10)                                  0380
         ST    @15,@TF00001                                        0380
         MVC   DAIRDSLN(2),@TF00001+2                              0380
*   DAIRDSN(1:DSNLENGH)=DSNBUF(1:DSNLENGH);                        0381
         BCTR  @15,0                                               0381
         L     @10,DSNPTR(,@10)                                    0381
         EX    @15,@SM01512                                        0381
*   DAIRDSPT=ADDR(DAIRDSBF);        /* GET DSNAME ADDRESS    @YM02616*/
         LA    DAIRDSPT,DAIRDSBF                                   0382
*   DA04PDSN=DAIRDSPT;              /* PTR TO DSNAME         @YM02616*/
         ST    DAIRDSPT,DA04PDSN(,DAPB0PTR)                        0383
*   DAPLDAPB=DAPB0PTR;              /* PTR TO DAPB04         @YM02616*/
         ST    DAPB0PTR,DAPLDAPB(,DAPLPTR)                         0384
*   R1=DAPLPTR;                     /* PTR IN REG 1          @YM02616
*                                      INVOKE DAIR           @Y30LPKH*/
         LR    R1,DAPLPTR                                          0385
*   DO;                             /* CALLTSSR EP(IKJDAIR)          */
*     RESPECIFY                                                    0387
*       GPR01P RSTD;                                               0387
*     IF CVTDAIR=0 THEN                                            0388
         L     @10,CVTPTR                                          0388
         L     @10,CVTDAIR(,@10)                                   0388
         LTR   @10,@10                                             0388
         BNZ   @RF00388                                            0388
*       GEN(LINK EP=IKJDAIR);                                      0389
         LINK EP=IKJDAIR
*     ELSE                                                         0390
*       CALL CVTDAIR;                                              0390
         B     @RC00388                                            0390
@RF00388 L     @10,CVTPTR                                          0390
         L     @15,CVTDAIR(,@10)                                   0390
         BALR  @14,@15                                             0390
*     RESPECIFY                                                    0391
*       GPR01P UNRSTD;                                             0391
@RC00388 DS    0H                                                  0392
*   END;                                                           0392
*   RCODESV=R15;                    /* SAVE DAIR RETURN COD@YM02616  */
         ST    R15,RCODESV(,AWAPTR)                                0393
*   IF RCODESV=0 THEN               /* IF DAIR SUCCESSFUL    @OZ05962*/
         L     @10,RCODESV(,AWAPTR)                                0394
         LTR   @10,@10                                             0394
         BNZ   @RF00394                                            0394
*     DO;                           /* THEN                  @OZ05962*/
*       IF DA04CAT='1'B×            /* IF DS IN CATALOG      @YM02616*/
*           DA04DSE='1'B THEN       /* OR IN DSE THEN        @YM02616*/
         TM    DA04CAT(DAPB0PTR),B'00000110'                       0396
         BZ    @RF00396                                            0396
*         DSEXISTS='1'B;            /* SHOW DATASET EXISTS   @OZ05962*/
         OI    DSEXISTS(AWAPTR),B'00100000'                        0397
*       IF DISPPDE=0 THEN           /* IF DISP NOT SPEC      @OZ05962*/
@RF00396 L     @10,PTRPDL(,AWAPTR)                                 0398
         LH    @02,DISPPDE(,@10)                                   0398
         LTR   @02,@02                                             0398
         BNZ   @RF00398                                            0398
*         DO;                       /* THEN                  @OZ05962*/
*           IF VOLPDE=1×            /* IF VOL SPECIFIED      @OZ05962*/
*               DSEXISTS='1'B THEN  /* OR DATASET OLD        @OZ05962*/
         CLC   VOLPDE(2,@10),@CH00033                              0400
         BE    @RT00400                                            0400
         TM    DSEXISTS(AWAPTR),B'00100000'                        0400
         BNO   @RF00400                                            0400
@RT00400 DS    0H                                                  0401
*             DISPPDE=1;            /* DEFAULT DISP TO KEEP  @OZ05962*/
         L     @10,PTRPDL(,AWAPTR)                                 0401
         MVC   DISPPDE(2,@10),@CH00033                             0401
*           ELSE                    /* OTHERWISE             @OZ05962*/
*             DISPPDE=3;            /* DEFAULT DISP CATLG    @OZ05962*/
         B     @RC00400                                            0402
@RF00400 L     @10,PTRPDL(,AWAPTR)                                 0402
         MVC   DISPPDE(2,@10),@CH00323                             0402
*         END;                      /*                       @OZ05962*/
*     END;                          /*                       @OZ05962*/
*   ELSE                            /* IF DAIR FAILED        @OZ05962*/
*     DO;                           /* THEN                  @OZ05962*/
         B     @RC00394                                            0405
@RF00394 DS    0H                                                  0406
*       IF(RCODESV^=8)×             /* IF NOT CATLG ERROR    @OZ05962*/
*           (RCODESV=8&DA04CTRC^=8) THEN/*                   @OZ05962*/
         LA    @10,8                                               0406
         L     @05,RCODESV(,AWAPTR)                                0406
         CR    @05,@10                                             0406
         BNE   @RT00406                                            0406
         CR    @05,@10                                             0406
         BNE   @RF00406                                            0406
         CH    @10,DA04CTRC(,DAPB0PTR)                             0406
         BE    @RF00406                                            0406
@RT00406 DS    0H                                                  0407
*         DO;                       /* INVOKE DAIRFAIL       @OZ05962*/
*           RBCODE12='1'B;          /* INDICATE ERROR        @YM02616
*                                      GET ADDR OF DAPB      @YM02616*/
         OI    RBCODE12(AWAPTR),B'10000000'                        0408
*           DFDAPLP=ADDR(DAPB04);   /* GET ADDR OF RET CODE@YM02616  */
         ST    DAPB0PTR,DFDAPLP                                    0409
*           DFRCP=ADDR(RCODESV);    /* GET ADDR OF MSG RTN   @YM02616*/
         LA    @10,RCODESV(,AWAPTR)                                0410
         ST    @10,DFRCP                                           0410
*           DFJEFF02=ADDR(ADMSG);   /* GET ADDR OF ID        @YM02616*/
         LA    @10,ADMSG                                           0411
         ST    @10,DFJEFF02                                        0411
*           DFIDP=ADDR(CALLERNO);                                  0412
         LA    @10,CALLERNO                                        0412
         ST    @10,DFIDP                                           0412
*           GENERATE;                                              0413
*                                      /* LOAD DAIRFAIL RTN   @YM02616*
                     LOAD EP=IKJEFF18
*           R1=ADDR(DFPARMS);                                      0414
         LA    R1,DFPARMS                                          0414
*           CALL R0;                /* INVOKE DAIRFAIL       @YM02616*/
         LR    @15,R0                                              0415
         BALR  @14,@15                                             0415
*           GENERATE;                                              0416
*                                      /* DELETE DAIRFAIL RTN @YM02616*
                     DELETE EP=IKJEFF18
*         END;                      /*                       @YM02616*/
*       ELSE                        /* DS NOT CATALOGED      @ZA10491*/
*         DISPPDE=3;                /* DEFAULT DISP=CATLG    @ZA10491*/
         B     @RC00406                                            0418
@RF00406 L     @10,PTRPDL(,AWAPTR)                                 0418
         MVC   DISPPDE(2,@10),@CH00323                             0418
*     END;                                                         0419
*   END CHKDISP;                                                   0420
@EL00007 DS    0H                                                  0420
@EF00007 DS    0H                                                  0420
@ER00007 LM    @14,@12,@SA00007                                    0420
         BR    @14                                                 0420
*                                                                  0421
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      OLDDS                                                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE PROCESSES REQUESTS FOR AN OLD DATA SET.        */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      IF DSNAME IS NOT SPECIFIED, THE USER IS PROMPTED TO ENTER   */
*/*      A DSNAME. EXTRANEOUS PARAMETERS ARE MARKED NOT ENTERED IN   */
*/*      THE PDL. IF DISPOSITION WAS OMITTED, INDICATE KEEP IN THE   */
*/*      PDL. INVOKE GENTRANS TO TRANSLATE THE PARAMETERS. IF        */
*/*      GENTRANS SUCCESSFUL, INVOKE DYNAMIC ALLOCATION. IF DYNAMIC  */
*/*      ALLOCATION INDICATES FILE IN USE, GO TO PROMPT THE USER     */
*/*      FOR THE OPTION. IF DATA SET COULD NOT BE FOUND, PROMPT FOR  */
*/*      A NEW DSNAME, AND RE-INVOKE DYNAMIC ALLOCATION.             */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PDL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - ERROR IN GENTRANS OR ALLOCATION              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/********************************************************************/
*                                                                  0421
*OLDDS:                                                            0421
*   PROC;                                                          0421
OLDDS    STM   @14,@12,@SA00008                                    0421
*   IF DSPDE=0 THEN                 /* IF DSN NOT ENTERED,           */
         L     @10,PTRPDL(,AWAPTR)                                 0422
         LH    @10,DSPDE(,@10)                                     0422
         LTR   @10,@10                                             0422
         BNZ   @RF00422                                            0422
*     DO;                           /* THEN                          */
*       CALL PRMPDSN;               /* PROMPT FOR NEW DSNAME         */
         BAL   @14,PRMPDSN                                         0424
*       IF RBCODE12='0'B THEN       /* IF PROMPT SUCCESSFUL,         */
         TM    RBCODE12(AWAPTR),B'10000000'                        0425
         BNZ   @RF00425                                            0425
*         DO;                       /* THEN,                         */
*           DSPDE=1;                /* INDICATE DSN ENTERED          */
         L     @10,PTRPDL(,AWAPTR)                                 0427
         MVC   DSPDE(2,@10),@CH00033                               0427
*           DSOVRLAY='1'B;          /* INDICATE PDE OVERLAID         */
*                                                                  0428
         OI    DSOVRLAY(AWAPTR),B'01000000'                        0428
*           /*********************************************************/
*           /*                                                       */
*           /* DETERMINE LENGTH OF PDE TO BE COPIED, AND OVERLAY     */
*           /* ORIGINAL PDE WITH PROMPT PDE.                         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0429
*           MOVELEN=ADDR(DDNMEPDE)-ADDR(DSNPDE);                   0429
         LA    MOVELEN,28                                          0429
*           DSNPDE(1:MOVELEN)=DSNAMPDE(1:MOVELEN);                 0430
         LR    @07,MOVELEN                                         0430
         BCTR  @07,0                                               0430
         L     @05,PMPTPDL(,AWAPTR)                                0430
         EX    @07,@SM01515                                        0430
*         END;                                                     0431
*     END;                                                         0432
@RF00425 DS    0H                                                  0433
*   IF RBCODE12='0'B THEN           /* IF NO ERROR FOUND,            */
@RF00422 TM    RBCODE12(AWAPTR),B'10000000'                        0433
         BNZ   @RF00433                                            0433
*     DO;                           /* CONTINUE                      */
*       I=1;                        /* INITIALIZE SUBSCRIPT          */
*                                                                  0435
         LA    I,1                                                 0435
*       /*************************************************************/
*       /*                                                           */
*       /* MARK EXTRANEOUS PARAMETERS NOT ENTERED IN PDL             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0436
*       DO WHILE(CONT='0'B);                                       0436
         B     @DE00436                                            0436
@DL00436 DS    0H                                                  0437
*         IF OLDEXT(I)='00'X THEN   /* IF END OF LIST,               */
         LA    @10,OLDEXT-1(I)                                     0437
         CLI   0(@10),X'00'                                        0437
         BNE   @RF00437                                            0437
*           CONT='1'B;              /* EXIT DO-WHILE                 */
         OI    CONT(AWAPTR),B'00010000'                            0438
*         ELSE                      /* ELSE,                         */
*           DO;                     /* GET ADDRESS OF PDE            */
         B     @RC00437                                            0439
@RF00437 DS    0H                                                  0440
*             EXTRAN=ADDR(ALLOCPDL)+OLDEXT(I);                     0440
         SLR   EXTRAN,EXTRAN                                       0440
         IC    EXTRAN,OLDEXT-1(I)                                  0440
         AL    EXTRAN,PTRPDL(,AWAPTR)                              0440
*             PDEEXT=0;             /* SET PDE TO 0                  */
         SLR   @10,@10                                             0441
         STH   @10,PDEEXT(,EXTRAN)                                 0441
*             I=I+1;                /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0442
*           END;                                                   0443
*       END;                        /* END DO-WHILE                  */
@RC00437 DS    0H                                                  0444
@DE00436 TM    CONT(AWAPTR),B'00010000'                            0444
         BZ    @DL00436                                            0444
*       CONT='0'B;                  /* RESET SWITCH                  */
         NI    CONT(AWAPTR),B'11101111'                            0445
*       IF DISPPDE=0 THEN           /* IF DISP NOT ENTERED,          */
         L     @10,PTRPDL(,AWAPTR)                                 0446
         LH    @07,DISPPDE(,@10)                                   0446
         LTR   @07,@07                                             0446
         BNZ   @RF00446                                            0446
*         DISPPDE=1;                /* INDICATE DEFAULT OF KEEP      */
         MVC   DISPPDE(2,@10),@CH00033                             0447
*       CALL TRANSRTN;              /* TRANSLATE PARAMETERS          */
@RF00446 BAL   @14,TRANSRTN                                        0448
*       IF RBCODE12='0'B THEN       /* IF TRANSLATE SUCCESSFUL       */
         TM    RBCODE12(AWAPTR),B'10000000'                        0449
         BNZ   @RF00449                                            0449
*         DO;                       /* THEN                          */
*           IF DSOVRLAY='1'B THEN   /* IF 2ND PDL TO FREE,           */
         TM    DSOVRLAY(AWAPTR),B'01000000'                        0451
         BNO   @RF00451                                            0451
*             DO;                   /* THEN                          */
*               DSOVRLAY='0'B;      /* TURN OFF INDICATOR            */
         NI    DSOVRLAY(AWAPTR),B'10111111'                        0453
*               RFY                                                0454
*                 R5 RSTD;          /* RESTRICT REG 5                */
*               R5=ADDR(PMPTPDL);   /* PDL ADDRESS IN REG 5          */
         LA    R5,PMPTPDL(,AWAPTR)                                 0455
*               GEN(IKJRLSA (5));   /* RELEASE PDL                   */
         IKJRLSA (5)
*               RFY                                                0457
*                 R5 UNRSTD;        /* UNRESTRICT REG 5              */
*             END;                                                 0458
*           CALL DYNSVC;            /* INVOKE DYNAMIC ALLOCATION     */
@RF00451 BAL   @14,DYNSVC                                          0459
*           IF RCODESV>0 THEN       /* IF RETURN CODE NON-ZERO       */
         L     @10,RCODESV(,AWAPTR)                                0460
         LTR   @10,@10                                             0460
         BNP   @RF00460                                            0460
*             DO;                   /* CHECK IF FILE IN USE          */
*               IF S99ERROR='0410'X THEN                           0462
         L     @10,PTRS99RB(,AWAPTR)                               0462
         CLC   S99ERROR(2,@10),@CB01444                            0462
         BNE   @RF00462                                            0462
*                 DO;               /* YES -                         */
*                   R1=AWAPTR;      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0464
*                   CALL IKJEFD36;  /* PROMPT FOR OPTION             */
         L     @15,@CV00342                                        0465
         BALR  @14,@15                                             0465
*                 END;                                             0466
*               ELSE                /* NO - CHECK IF DSN NOT FOUND   */
*                 IF S99ERROR='1708'X THEN                         0467
         B     @RC00462                                            0467
@RF00462 L     @10,PTRS99RB(,AWAPTR)                               0467
         CLC   S99ERROR(2,@10),@CB01467                            0467
         BNE   @RF00467                                            0467
*                   DO;             /* YES -                         */
*                     ENTRYCD=1;    /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0469
*                     R1=AWAPTR;    /* WORKAREA PTR IN REG 1 ISSUE 0470
*                                      NOT FOUND MSG                 */
         LR    R1,AWAPTR                                           0470
*                     CALL IKJEFD35;                               0471
         L     @15,@CV00340                                        0471
         BALR  @14,@15                                             0471
*                     CALL PRMPDSN; /* PROMPT FOR DSNAME             */
         BAL   @14,PRMPDSN                                         0472
*                     IF RBCODE12='0'B THEN                        0473
         TM    RBCODE12(AWAPTR),B'10000000'                        0473
         BNZ   @RF00473                                            0473
*                       CALL DSNADDT;/* PROCESS NEW DSNAME           */
         BAL   @14,DSNADDT                                         0474
*                   END;                                           0475
*                 ELSE                                             0476
*                   DO;             /* OTHERWISE,                    */
         B     @RC00467                                            0476
@RF00467 DS    0H                                                  0477
*                     RBCODE12='1'B;/* INDICATE ALLOC FAILED         */
         OI    RBCODE12(AWAPTR),B'10000000'                        0477
*                     ENTRYCD=1;    /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0478
*                     R1=AWAPTR;    /* WORKAREA PTR IN REG 1 ISSUE 0479
*                                      ERROR MESSAGE                 */
         LR    R1,AWAPTR                                           0479
*                     CALL IKJEFD35;                               0480
         L     @15,@CV00340                                        0480
         BALR  @14,@15                                             0480
*                   END;                                           0481
*             END;                                                 0482
*         END;                                                     0483
*     END;                                                         0484
*   END OLDDS;                                                     0485
@EL00008 DS    0H                                                  0485
@EF00008 DS    0H                                                  0485
@ER00008 LM    @14,@12,@SA00008                                    0485
         BR    @14                                                 0485
*                                                                  0486
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      DSNADDT                                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE BUILDS THE TEXT UNIT FOR THE DSNAME ENTERED    */
*/*      ON THE PROMPT AND RE-INVOKES DYNAMIC ALLOCATION.            */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      INVOKE GENTRANS, PASSING THE SECONDARY PCL AND PDL. IF      */
*/*      GENTRANS FAILED, ISSUE ERROR MESSAGE. ELSE, FREE THE        */
*/*      SECONDARY PDL. COPY THE POINTERS TO THE NEW TEXT UNITS      */
*/*      INTO THE ORIGINAL ADDRESS LIST. INVOKE DYNAMIC ALLOCATION.  */
*/*      IF ALLOCATION INDICATES FILE IN USE, GO TO PROMPT FOR       */
*/*      OPTION. IF DSNAME NOT FOUND, PROMPT FOR NEW DSNAME AND      */
*/*      REPEAT ABOVE PROCEDURE. ELSE, ISSUE ERROR MSG. FREE THE     */
*/*      STORAGE USED TO BUILD THE SECONDARY TEXT UNITS.             */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PROMPT PCL                                           */
*/*      PTR TO PROMPT PDL                                           */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - ALLOCATION SUCCESSFUL                        */
*/*                 1 - ERROR IN GENTRANS OR ALLOCATION              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/*                                                                  */
*/*        IF THE DSNAME COULD NOT BE FOUND, AND THE USER IS         */
*/*        PROMPTED TO REENTER DSNAME, THEN THE TEXT UNITS FOR THE   */
*/*        OTHER PARAMETERS HAVE ALREADY BEEN BUILT. GENTRANS IS     */
*/*        INVOKED TO TRANSLATE ONLY THE DSNAME ENTERED ON THE       */
*/*        PROMPT. THE TEXT UNITS BUILT ARE PUT INTO THE ORIGINAL    */
*/*        LIST OF TEXT UNITS.                                       */
*/********************************************************************/
*                                                                  0486
*DSNADDT:                                                          0486
*   PROC;                                                          0486
DSNADDT  STM   @14,@12,@SA00009                                    0486
*DSNAD1:                                                           0487
*   S99ERROR=S99ERROR&&S99ERROR;    /* ZERO ERROR FIELD              */
DSNAD1   L     @10,PTRS99RB(,AWAPTR)                               0487
         XC    S99ERROR(2,@10),S99ERROR(@10)                       0487
*   GTPLPDL=PMPTPDL;                /* SET PDL PTR                   */
         L     @10,GTPLPTR(,AWAPTR)                                0488
         L     @07,PMPTPDL(,AWAPTR)                                0488
         ST    @07,GTPLPDL(,@10)                                   0488
*   GTPLPCL=PPLPCL;                 /* SET PCL PTR                   */
         L     @07,PPLPTR(,AWAPTR)                                 0489
         L     @07,PPLPCL(,@07)                                    0489
         ST    @07,GTPLPCL(,@10)                                   0489
*   GTPLKLST=ADDR(DSNKLIST);        /* PTR TO KEYLIST                */
         LA    @07,DSNKLIST                                        0490
         ST    @07,GTPLKLST(,@10)                                  0490
*   GTPLTBLE=0;                     /* NO KEYWORD TABLE              */
         SLR   @07,@07                                             0491
         ST    @07,GTPLTBLE(,@10)                                  0491
*   GTPLABLK=0;                     /* NO ADDITIONAL BLOCK           */
         ST    @07,GTPLABLK(,@10)                                  0492
*   GTPLOUTA=0;                     /* ZERO PTR TO TEXT              */
         ST    @07,GTPLOUTA(,@10)                                  0493
*   R1=GTPLPTR;                     /* GTPL ADDR IN REG 1            */
         LR    R1,@10                                              0494
*   GEN(LINK EP=IKJCB831);          /* INVOKE GENTRANS               */
         LINK EP=IKJCB831
*   RCODESV=R15;                    /* SAVE RETURN CODE              */
         ST    R15,RCODESV(,AWAPTR)                                0496
*   IF RCODESV>0 THEN               /* IF GENTRANS FAILED            */
         L     @10,RCODESV(,AWAPTR)                                0497
         LTR   @10,@10                                             0497
         BNP   @RF00497                                            0497
*     DO;                           /* THEN                          */
*       RBCODE12='1'B;              /* INDICATE ALLOC FAILED         */
         OI    RBCODE12(AWAPTR),B'10000000'                        0499
*       ENTRYCD=3;                  /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00323                          0500
*       R1=AWAPTR;                  /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0501
*       CALL IKJEFD35;              /* ISSUE SYSTEM ERROR MSG        */
         L     @15,@CV00340                                        0502
         BALR  @14,@15                                             0502
*     END;                                                         0503
*   ELSE                                                           0504
*     DO;                           /* IF GENTRANS SUCCESSFUL,       */
         B     @RC00497                                            0504
@RF00497 DS    0H                                                  0505
*       RFY                                                        0505
*         R5 RSTD;                  /* RESTRICT REG 5                */
*       R5=ADDR(PMPTPDL);           /* PDL PTR IN REG 5              */
         LA    R5,PMPTPDL(,AWAPTR)                                 0506
*       GEN(IKJRLSA (5));           /* RELEASE 2ND PDL               */
         IKJRLSA (5)
*       RFY                                                        0508
*         R5 UNRSTD;                /* UNRESTRICT REG 5              */
*       TEXTPTR2=GTPLOUTA;          /* SAVE PTR TO TEXT              */
         L     @10,GTPLPTR(,AWAPTR)                                0509
         L     TEXTPTR2,GTPLOUTA(,@10)                             0509
*       TUDSN=ADDRLST2(3);          /* NEW DSN TEXT POINTER          */
         L     @10,ADDRLST2+8(,TEXTPTR2)                           0510
         ST    @10,TUDSN(,GTPLOUT1)                                0510
*       TUMBR=ADDRLST2(4);          /* NEW MEMBER TEXT POINTER       */
         L     @10,ADDRLST2+12(,TEXTPTR2)                          0511
         ST    @10,TUMBR(,GTPLOUT1)                                0511
*       TUPSWD=ADDRLST2(5);         /* NEW PSWORD TEXT POINTER       */
         L     @10,ADDRLST2+16(,TEXTPTR2)                          0512
         ST    @10,TUPSWD(,GTPLOUT1)                               0512
*       TUPSWDND='0'B;              /* ZERO HIGH ORDER BIT           */
         NI    TUPSWDND(GTPLOUT1),B'01111111'                      0513
*       CALL DYNSVC;                /* INVOKE DYN ALLOCATION         */
         BAL   @14,DYNSVC                                          0514
*       IF RCODESV>0 THEN           /* IF ALLOCATION FAILED,         */
         L     @10,RCODESV(,AWAPTR)                                0515
         LTR   @10,@10                                             0515
         BNP   @RF00515                                            0515
*         DO;                       /* THEN CHECK IF FILE IN USE,    */
*           IF S99ERROR='0410'X THEN                               0517
         L     @10,PTRS99RB(,AWAPTR)                               0517
         CLC   S99ERROR(2,@10),@CB01444                            0517
         BNE   @RF00517                                            0517
*             DO;                   /* YES -                         */
*               R1=AWAPTR;          /* WORKAREA PTR IN REG 1 PROMPT
*                                      FOR OPTION                    */
         LR    R1,AWAPTR                                           0519
*               CALL IKJEFD36;                                     0520
         L     @15,@CV00342                                        0520
         BALR  @14,@15                                             0520
*             END;                                                 0521
*           ELSE                    /* NO - CHECK IF DSN NOT FOUND   */
*             IF S99ERROR='1708'X THEN                             0522
         B     @RC00517                                            0522
@RF00517 L     @10,PTRS99RB(,AWAPTR)                               0522
         CLC   S99ERROR(2,@10),@CB01467                            0522
         BNE   @RF00522                                            0522
*               DO;                 /* YES -                         */
*                 ENTRYCD=1;        /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0524
*                 R1=AWAPTR;        /* WORKAREA PTR IN REG 1 ISSUE 0525
*                                      NOT FOUND MSG                 */
         LR    R1,AWAPTR                                           0525
*                 CALL IKJEFD35;                                   0526
         L     @15,@CV00340                                        0526
         BALR  @14,@15                                             0526
*                 CALL PRMPDSN;     /* PROMPT FOR NEW DSNAME         */
         BAL   @14,PRMPDSN                                         0527
*                 IF RBCODE12='0'B THEN                            0528
         TM    RBCODE12(AWAPTR),B'10000000'                        0528
         BZ    @RT00528                                            0528
*                   GO TO DSNAD1;   /* PROCESS NEW DSNAME            */
*               END;                                               0530
*             ELSE                                                 0531
*               DO;                 /* NO -                          */
         B     @RC00522                                            0531
@RF00522 DS    0H                                                  0532
*                 RBCODE12='1'B;    /* INDICATE ALLOC FAILED         */
         OI    RBCODE12(AWAPTR),B'10000000'                        0532
*                 ENTRYCD=1;        /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00033                          0533
*                 R1=AWAPTR;        /* WORKAREA PTR IN REG 1 ISSUE 0534
*                                      ERROR MSG                     */
         LR    R1,AWAPTR                                           0534
*                 CALL IKJEFD35;                                   0535
         L     @15,@CV00340                                        0535
         BALR  @14,@15                                             0535
*               END;                                               0536
*         END;                                                     0537
@RC00522 DS    0H                                                  0537
@RC00517 DS    0H                                                  0538
*       R0=ADDRLST2(1);             /* GET SUBPOOL AND LENGTH        */
@RF00515 L     R0,ADDRLST2(,TEXTPTR2)                              0538
*       R1=TEXTPTR2;                /* AND ADDR OF TEXT STORAGE      */
         LR    R1,TEXTPTR2                                         0539
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE TEXT STORAGE            */
         FREEMAIN R,LV=(0),A=(1)
*       GTPLOUTA=GTPLOUT1;          /* RESET TEXT PTR                */
         L     @10,GTPLPTR(,AWAPTR)                                0541
         ST    GTPLOUT1,GTPLOUTA(,@10)                             0541
*     END;                                                         0542
*   END DSNADDT;                                                   0543
@EL00009 DS    0H                                                  0543
@EF00009 DS    0H                                                  0543
@ER00009 LM    @14,@12,@SA00009                                    0543
         BR    @14                                                 0543
*                                                                  0544
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      PRMPDSN                                                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE INVOKES PARSE TO PROMPT THE USER FOR A         */
*/*      DATA SET NAME.                                              */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      SET UP PARSE PARAMETER LIST. INVOKE PARSE. IF PARSE         */
*/*      FAILED, ISSUE ERROR MESSAGE.                                */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO PCL                                                  */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      PTR TO PROMPT PDL                                           */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION AND CAN    */
*/*        BE INCORPORATED AS AN INCLUDED CODE SEGMENT WHEN THE      */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION.      */
*/********************************************************************/
*                                                                  0544
*PRMPDSN:                                                          0544
*   PROC;                                                          0544
PRMPDSN  STM   @14,@12,@SA00010                                    0544
*   ENTRYCD=3;                      /* INDICATE PROMPT FOR DSN       */
         MVC   ENTRYCD(2,AWAPTR),@CH00323                          0545
*   R1=AWAPTR;                      /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0546
*   CALL IKJEFD37;                  /* INVOKE PARSE                  */
         L     @15,@CV00341                                        0547
         BALR  @14,@15                                             0547
*   IF RCODESV>0 THEN               /* IF PARSE FAILED,              */
         L     @10,RCODESV(,AWAPTR)                                0548
         LTR   @10,@10                                             0548
         BNP   @RF00548                                            0548
*     DO;                           /* THEN,                         */
*       IF AWARSV1='1'B THEN        /* IF MSG ALREADY ISSUED,        */
         TM    AWARSV1(AWAPTR),B'00000010'                         0550
         BNO   @RF00550                                            0550
*         AWARSV1='0'B;             /* TURN OFF INDICATOR            */
         NI    AWARSV1(AWAPTR),B'11111101'                         0551
*       ELSE                                                       0552
*         DO;                       /* OTHERWISE,                    */
         B     @RC00550                                            0552
@RF00550 DS    0H                                                  0553
*           ENTRYCD=2;              /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00066                          0553
*           R1=AWAPTR;              /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0554
*           CALL IKJEFD35;          /* ISSUE ERROR MESSAGE           */
         L     @15,@CV00340                                        0555
         BALR  @14,@15                                             0555
*         END;                                                     0556
*     END;                                                         0557
*   ELSE                                                           0558
*     DO;                                                          0558
         B     @RC00548                                            0558
@RF00548 DS    0H                                                  0559
*       IF MBRPRES1='1'B&           /* IF MEMBER SPECIFIED           */
*           DISPPDE=2 THEN          /* AND DISP OF DELETE            */
         L     @10,PMPTPDL(,AWAPTR)                                0559
         TM    MBRPRES1(@10),B'10000000'                           0559
         BNO   @RF00559                                            0559
         L     @02,PTRPDL(,AWAPTR)                                 0559
         CLC   DISPPDE(2,@02),@CH00066                             0559
         BNE   @RF00559                                            0559
*         DO;                                                      0560
*           ENTRYCD=5;              /* SET ENTRY CODE COPY NEW DSNAME
*                                      INTO PDE                      */
         MVC   ENTRYCD(2,AWAPTR),@CH00047                          0561
*           MOVELEN=ADDR(DDNMEPDE)-ADDR(DSNPDE);                   0562
         LA    MOVELEN,28                                          0562
*           DSNPDE(1:MOVELEN)=DSNAMPDE(1:MOVELEN);                 0563
         L     @15,PTRPDL(,AWAPTR)                                 0563
         LR    @14,MOVELEN                                         0563
         BCTR  @14,0                                               0563
         EX    @14,@SM01519                                        0563
*           R1=AWAPTR;              /* WORKAREA PTR IN REG 1 ISSUE 0564
*                                      ERROR MESSAGE                 */
         LR    R1,AWAPTR                                           0564
*           CALL IKJEFD35;                                         0565
         L     @15,@CV00340                                        0565
         BALR  @14,@15                                             0565
*           RFY                                                    0566
*             R5 RSTD;              /* RESTRICT REG 5                */
*           R5=ADDR(PMPTPDL);       /* PDL ADDRESS IN REG 5          */
         LA    R5,PMPTPDL(,AWAPTR)                                 0567
*           GEN(IKJRLSA (5));       /* RELEASE PDL                   */
         IKJRLSA (5)
*           RFY                                                    0569
*             R5 UNRSTD;            /* UNRESTRICT REG 5              */
*         END;                                                     0570
*     END;                                                         0571
*   END PRMPDSN;                                                   0572
@EL00010 DS    0H                                                  0572
@EF00010 DS    0H                                                  0572
@ER00010 LM    @14,@12,@SA00010                                    0572
         BR    @14                                                 0572
*                                                                  0573
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      TRANSRTN                                                    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE INVOKES THE GENERALIZED TRANSLATE ROUTINE AND  */
*/*      CHECKS ITS RETURN CODE.                                     */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      THE TEXT UNIT FOR PERMANENT ALLOCATION IS SET UP IN THE     */
*/*      ADDITIONAL BLOCK OF TEXT TO BE PASSED.  THE POINTER TO THE  */
*/*      GENTRANS PARAMETER LIST IS PUT IN REGISTER 1 AND GENTRANS   */
*/*      IS INVOKED.  IF THE RETURN CODE FROM GENTRANS IS NON-ZERO,  */
*/*      AN INDICATOR IS SET. ELSE, THE TEXT POINTER RETURNED BY     */
*/*      GENTRANS IS PUT INTO THE DYNAMIC ALLOCATION REQUEST BLOCK.  */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      PTR TO GENTRANS PARAMETER LIST                              */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RBCODE12 = 0 - GENTRANS SUCCESSFUL                          */
*/*               = 1 - GENTRANS FAILED                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0573
*TRANSRTN:                                                         0573
*   PROC;                                                          0573
TRANSRTN STM   @14,@05,@SA00011                                    0573
         STM   @07,@12,@SA00011+32                                 0573
*   ADLKEY=DALPERMA;                /* PERM ALLOC TEXT - KEY         */
         L     @10,TXT(,AWAPTR)                                    0574
         MVC   ADLKEY(2,@10),@CH00722                              0574
*   ADLNBR=0;                       /* NUMBER                        */
         SLR   @07,@07                                             0575
         STH   @07,ADLNBR(,@10)                                    0575
*   ADDTEXT(INC)=TXT;               /* ADDRESS IN LIST               */
         LR    @07,INC                                             0576
         SLA   @07,2                                               0576
         L     @05,GTPLPTR(,AWAPTR)                                0576
         L     @02,GTPLABLK(,@05)                                  0576
         ST    @10,@TF00001                                        0576
         ALR   @07,@02                                             0576
         MVC   ADDTEXT-4(4,@07),@TF00001                           0576
*   ADDNUM=ADDNUM+1;                /* INCREMENT ENTRIES CTR         */
         LA    @07,1                                               0577
         MVC   @TF00001(2),ADDNUM(@02)                             0577
         LH    @15,@TF00001                                        0577
         ALR   @15,@07                                             0577
         ST    @15,@TF00001                                        0577
         MVC   ADDNUM(2,@02),@TF00001+2                            0577
*   INC=INC+1;                      /* INCREMENT SUBSCRIPT           */
         ALR   INC,@07                                             0578
*   TXT=TXT+4;                      /* INCREMENT TEXT PTR            */
         AL    @10,@CF00321                                        0579
         ST    @10,TXT(,AWAPTR)                                    0579
*   ADLKEY=DALRTORG;                /* RETURN DSORG KEY              */
         MVC   ADLKEY(2,@10),@CH00732                              0580
*   ADLNBR=1;                       /* RETURN DSORG NUMBER           */
         STH   @07,ADLNBR(,@10)                                    0581
*   ADLLEN=2;                       /* RETURN DSORG LENGTH           */
         MVC   ADLLEN(2,@10),@CH00066                              0582
*   ADDTEXT(INC)=TXT;               /* ADDRESS IN LIST               */
         LR    @14,INC                                             0583
         SLA   @14,2                                               0583
         ST    @10,@TF00001                                        0583
         ALR   @14,@02                                             0583
         MVC   ADDTEXT-4(4,@14),@TF00001                           0583
*   TXT=TXT+8;                      /* INCREMENT TEXT PTR            */
         AL    @10,@CF00099                                        0584
         ST    @10,TXT(,AWAPTR)                                    0584
*   INC=INC+1;                      /* INCREMENT SUBSCRIPT           */
         ALR   INC,@07                                             0585
*   ADDNUM=ADDNUM+1;                /* INCREMENT ENTRIES CTR         */
         ALR   @15,@07                                             0586
         ST    @15,@TF00001                                        0586
         MVC   ADDNUM(2,@02),@TF00001+2                            0586
*   R1=GTPLPTR;                     /* PARM LIST IN REG 1            */
         LR    R1,@05                                              0587
*   GEN(LINK EP=IKJCB831);          /* INVOKE GENTRANS               */
         LINK EP=IKJCB831
*   RCODESV=R15;                    /* SAVE RETURN CODE              */
         ST    R15,RCODESV(,AWAPTR)                                0589
*   IF RCODESV>0 THEN               /* IF GENTRANS FAILED,           */
         L     @10,RCODESV(,AWAPTR)                                0590
         LTR   @10,@10                                             0590
         BNP   @RF00590                                            0590
*     DO;                                                          0591
*       ENTRYCD=3;                  /* SET ENTRY CODE                */
         MVC   ENTRYCD(2,AWAPTR),@CH00323                          0592
*       R1=AWAPTR;                  /* WORKAREA PTR IN REG 1         */
         LR    R1,AWAPTR                                           0593
*       CALL IKJEFD35;              /* ISSUE ERROR MSG               */
         L     @15,@CV00340                                        0594
         BALR  @14,@15                                             0594
*     END;                                                         0595
*   ELSE                            /* OTHERWISE,                    */
*     DO;                                                          0596
         B     @RC00590                                            0596
@RF00590 DS    0H                                                  0597
*       S99TXTPP=GTPLOUTA+8;        /* PUT TEXT PTR IN RB            */
         L     @10,PTRS99RB(,AWAPTR)                               0597
         L     @07,GTPLPTR(,AWAPTR)                                0597
         L     @07,GTPLOUTA(,@07)                                  0597
         LA    @02,8                                               0597
         ALR   @02,@07                                             0597
         ST    @02,S99TXTPP(,@10)                                  0597
*       GTPLOUT1=GTPLOUTA;          /* SAVE TEXT PTR                 */
         LR    GTPLOUT1,@07                                        0598
*     END;                                                         0599
*   END TRANSRTN;                                                  0600
@EL00011 DS    0H                                                  0600
@EF00011 DS    0H                                                  0600
@ER00011 LM    @14,@05,@SA00011                                    0600
         LM    @07,@12,@SA00011+32                                 0600
         BR    @14                                                 0600
*                                                                  0601
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -                                                   */
*/*      DYNSVC                                                      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*      THIS ROUTINE ISSUES SVC 99 TO INVOKE DYNAMIC ALLOCATION.    */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*      THE DYNALLOC MACRO IS ISSUED. ON RETURN, THE RETURN CODE IN */
*/*      REGISTER 15 IS SAVED.                                       */
*/*                                                                  */
*/* INPUT -                                                          */
*/*      WORKAREA                                                    */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*      RETURN CODE = 0 - ALLOCATION SUCCESSFUL                     */
*/*                 ^= 0 - ERROR                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0601
*DYNSVC:                                                           0601
*   PROC;                                                          0601
DYNSVC   STM   @14,@12,12(@13)                                     0601
*   R1=ADDR(S99RBPTR);              /* REQ BLOCK PTR IN REG1         */
         LA    R1,S99RBPTR                                         0602
*   S99RBPTR=PTRS99RB;              /* PTR TO REQUEST BLOCK          */
         L     @10,PTRS99RB(,AWAPTR)                               0603
         ST    @10,S99RBPTR                                        0603
*   S99RBPND='1'B;                  /* LAST REQ BLOCK                */
*                                                                  0604
         OI    S99RBPND,B'10000000'                                0604
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73082                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0605
*   SVC(99);                        /* INVOKE DYN ALLOCATION         */
         SVC   99                                                  0605
*   RCODESV=R15;                    /* SAVE RETURN CODE              */
         ST    R15,RCODESV(,AWAPTR)                                0606
*   END DYNSVC;                                                    0607
@EL00012 DS    0H                                                  0607
@EF00012 DS    0H                                                  0607
@ER00012 LM    @14,@12,12(@13)                                     0607
         BR    @14                                                 0607
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00P PTR(31) REG(0),                                       0608
*     GPR01P PTR(31) REG(1),                                       0608
*     GPR02P PTR(31) REG(2),                                       0608
*     GPR03P PTR(31) REG(3),                                       0608
*     GPR04P PTR(31) REG(4),                                       0608
*     GPR05P PTR(31) REG(5),                                       0608
*     GPR06P PTR(31) REG(6),                                       0608
*     GPR07P PTR(31) REG(7),                                       0608
*     GPR08P PTR(31) REG(8),                                       0608
*     GPR09P PTR(31) REG(9),                                       0608
*     GPR14P PTR(31) REG(14),                                      0608
*     GPR15P PTR(31) REG(15);                                      0608
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0609
*     I031F FIXED(31) BASED,                                       0609
*     I031P PTR(31) BASED,                                         0609
*     I015F FIXED(15) BASED,                                       0609
*     I015P PTR(15) BASED,                                         0609
*     I008P PTR(8) BASED,                                          0609
*     I001C CHAR(1) BASED;          /*                       @Y30LPKH*/
*   END IKJEFD32                                                   0610
*                                                                  0610
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJZT430)                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */
*/*%INCLUDE SYSLIB  (IKJDAPL )                                       */
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */
*/*%INCLUDE SYSLIB  (IKJDAP04)                                       */
*/*%INCLUDE SYSLIB  (IKJZB831)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*                                                                  0610
*       ;                                                          0610
@DATA    DS    0H
@CH00323 DC    H'3'
@CH00047 DC    H'5'
@CH00572 DC    XL2'0007'
@CH00574 DC    XL2'0008'
@CH00606 DC    XL2'0018'
@CH00638 DC    XL2'0028'
@CH00722 DC    XL2'0052'
@CH00732 DC    XL2'0057'
@CH00746 DC    XL2'005E'
@SM01509 MVC   DSNPDE(0,@10),DSNAMPDE(@07)
@SM01512 MVC   DAIRDSN(0),DSNBUF(@10)
@SM01515 MVC   DSNPDE(0,@10),DSNAMPDE(@05)
@SM01519 MVC   DSNPDE(0,@15),DSNAMPDE(@10)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SAV001  EQU   @SA00001
@SA00005 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00008 DS    15F
@SA00006 DS    15F
@SA00002 DS    15F
@SA00011 DS    14F
@SA00010 DS    15F
@SA00007 DS    15F
@SA00009 DS    15F
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
@TEMPS   EQU   @ZTEMPS
@L       EQU   @ZLEN
IKJEFD32 CSECT
         DS    0F
@CF00033 DC    F'1'
@CH00033 EQU   @CF00033+2
@CF00066 DC    F'2'
@CH00066 EQU   @CF00066+2
@CF00321 DC    F'4'
@CF00099 DC    F'8'
@CF01435 DC    F'12'
@DATD    DSECT
         DS    0D
SAVDSPDL DS    A
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
S99TUFP  DS    A
DAPLAREA DS    CL20
DAIRAREA DS    CL16
DFPARMS  DS    CL20
         ORG   DFPARMS
DFS99RBP DS    AL4
         ORG   DFS99RBP
DFDAPLP  DS    AL4
         ORG   DFPARMS+4
DFRCP    DS    AL4
DFJEFF02 DS    AL4
DFIDP    DS    AL4
DFCPPLP  DS    AL4
         ORG   DFPARMS+20
DAIRDSBF DS    CL46
         ORG   DAIRDSBF
DAIRDSLN DS    FL2
DAIRDSN  DS    CL44
         ORG   DAIRDSBF+46
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
@DATEND  EQU   *
IKJEFD32 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@SIZ001  EQU   @SIZDATD
@CV00339 DC    V(IKJEFD33)
@CV00340 DC    V(IKJEFD35)
@CV00341 DC    V(IKJEFD37)
@CV00342 DC    V(IKJEFD36)
         DS    0D
ADMSG    DC    F'0'
CALLERNO DC    H'1'
@CB00566 DC    X'0004'
@CB01444 DC    X'0410'
@CB01467 DC    X'1708'
PATCH32  DC    25F'0'
DSNKLIST DC    XL2'0002'
         DC    XL2'0000'
TERMEXT  DC    X'0C'
         DC    X'0E'
         DC    X'12'
         DC    X'14'
         DC    X'18'
         DC    X'1A'
         DC    X'1C'
         DC    X'1E'
         DC    X'20'
         DC    X'22'
         DC    X'24'
         DC    X'26'
         DC    X'28'
         DC    X'2A'
         DC    X'2C'
         DC    X'2E'
         DC    X'00'
SYSOTEXT DC    X'08'
         DC    X'0E'
         DC    X'14'
         DC    X'26'
         DC    X'20'
         DC    X'22'
         DC    X'24'
         DC    X'28'
         DC    X'2E'
         DC    X'00'
         DS    1XL1
OLDEXT   DC    X'10'
         DC    X'12'
         DC    X'14'
         DC    X'18'
         DC    X'1A'
         DC    X'2C'
         DC    X'00'
         DS    1XL1
NEWEXT   DC    X'18'
         DC    X'1A'
         DC    X'00'
DMMYEXT  DC    X'0C'
         DC    X'0E'
         DC    X'12'
         DC    X'14'
         DC    X'18'
         DC    X'1A'
         DC    X'1C'
         DC    X'1E'
         DC    X'20'
         DC    X'22'
         DC    X'24'
         DC    X'26'
         DC    X'28'
         DC    X'2A'
         DC    X'2C'
         DC    X'2E'
         DC    X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
@0       EQU   00
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
INC      EQU   @04
GTPLOUT1 EQU   @06
DAIRDSPT EQU   @02
DAPLPTR  EQU   @05
DAPB0PTR EQU   @04
EXTRAN   EQU   @05
MOVELEN  EQU   @02
TEXTPTR2 EQU   @04
AWAPTR   EQU   @03
I        EQU   @02
R0       EQU   @00
R1       EQU   @01
R5       EQU   @05
R13      EQU   @13
R15      EQU   @15
GPR01P   EQU   @01
GPR00P   EQU   @00
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR08P   EQU   @08
GPR09P   EQU   @09
GPR14P   EQU   @14
GPR15P   EQU   @15
R14      EQU   @14
CVTPTR   EQU   16
REGSAVE  EQU   4
RETCODE  EQU   16
ALLOCWA  EQU   0
CPPLPTR  EQU   ALLOCWA
PTRPDL   EQU   ALLOCWA+4
GTPLPTR  EQU   ALLOCWA+8
SWITCH   EQU   ALLOCWA+12
RBCODE12 EQU   SWITCH
DSOVRLAY EQU   SWITCH
CONT     EQU   SWITCH
AWARSV1  EQU   SWITCH
SWITCH2  EQU   ALLOCWA+13
DSEXISTS EQU   SWITCH2
ENTRYCD  EQU   ALLOCWA+14
TXT      EQU   ALLOCWA+16
PTRS99RB EQU   ALLOCWA+20
RCODESV  EQU   ALLOCWA+24
VCFLAGS  EQU   ALLOCWA+36
PMPTPDL  EQU   ALLOCWA+40
CMDTWO   EQU   ALLOCWA+60
COMMECB  EQU   ALLOCWA+160
PPLPTR   EQU   ALLOCWA+172
ALLOCPDL EQU   0
DSPDE    EQU   ALLOCPDL+8
STATSPDE EQU   ALLOCPDL+12
VOLPDE   EQU   ALLOCPDL+14
BLOKPDE  EQU   ALLOCPDL+16
SPACEPDE EQU   ALLOCPDL+18
HOLDPDE  EQU   ALLOCPDL+26
DISPPDE  EQU   ALLOCPDL+46
DSNPDE   EQU   ALLOCPDL+48
DSNPTR   EQU   DSNPDE
DSNLENGH EQU   DSNPDE+4
DSNFLAGS EQU   DSNPDE+6
DSNPRES  EQU   DSNFLAGS
MBRPTR   EQU   DSNPDE+8
MBRFLAGS EQU   DSNPDE+14
PASSPTR  EQU   DSNPDE+16
PASSFLAG EQU   DSNPDE+22
DDNMEPDE EQU   ALLOCPDL+76
DDNPTR   EQU   DDNMEPDE
DDNFLAGS EQU   DDNMEPDE+6
CLASPDE  EQU   ALLOCPDL+84
CLASPTR  EQU   CLASPDE
CLASFLG  EQU   CLASPDE+6
CLASPRES EQU   CLASFLG
SERPDE   EQU   ALLOCPDL+92
SERPTR   EQU   SERPDE
SERFLAGS EQU   SERPDE+6
BLKPDE   EQU   ALLOCPDL+104
BLKPTR   EQU   BLKPDE
BLKFLAGS EQU   BLKPDE+6
ABLKPDE  EQU   ALLOCPDL+112
ABLKPTR  EQU   ABLKPDE
ABLKFLG  EQU   ABLKPDE+6
SPACPDE  EQU   ALLOCPDL+120
SPACEPTR EQU   SPACPDE
SPACEFLG EQU   SPACPDE+6
SPACPDE2 EQU   ALLOCPDL+128
SPACPTR2 EQU   SPACPDE2
SPACFLG2 EQU   SPACPDE2+6
DIRECPDE EQU   ALLOCPDL+136
DIRPTR   EQU   DIRECPDE
DIRFLAGS EQU   DIRECPDE+6
ATTRPDE  EQU   ALLOCPDL+144
ATTRPTR  EQU   ATTRPDE
ATTRFLAG EQU   ATTRPDE+6
USIDPDE  EQU   ALLOCPDL+152
USIDPTR  EQU   USIDPDE
USIDFLAG EQU   USIDPDE+6
UTYPPDE  EQU   ALLOCPDL+160
UTYPPTR  EQU   UTYPPDE
UTYPFLAG EQU   UTYPPDE+6
UNCNTPDE EQU   ALLOCPDL+168
UCNTPTR  EQU   UNCNTPDE
UCNTFLAG EQU   UNCNTPDE+6
POSTPDE  EQU   ALLOCPDL+180
POSPTR   EQU   POSTPDE
POSFLAG  EQU   POSTPDE+6
MXVOLPDE EQU   ALLOCPDL+188
MXVOLPTR EQU   MXVOLPDE
MXVOLFLG EQU   MXVOLPDE+6
VOLSQPDE EQU   ALLOCPDL+196
VOLSQPTR EQU   VOLSQPDE
VOLSQFLG EQU   VOLSQPDE+6
MSVGPDE  EQU   ALLOCPDL+204
MSVGPTR  EQU   MSVGPDE
MSVGFLG  EQU   MSVGPDE+6
DSNBUF   EQU   0
DSNTERM  EQU   DSNBUF
CPPL     EQU   0
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
PPL      EQU   0
PPLPCL   EQU   PPL+12
DSNPDE1  EQU   0
DSNAMPDE EQU   DSNPDE1+8
DSNPTR1  EQU   DSNAMPDE
DSNFLG1  EQU   DSNAMPDE+6
MBRPTR1  EQU   DSNAMPDE+8
MBRFLG1  EQU   DSNAMPDE+14
MBRPRES1 EQU   MBRFLG1
PSWDPTR1 EQU   DSNAMPDE+16
@NM00013 EQU   DSNAMPDE+22
ADDRLST2 EQU   0
PDEEXT   EQU   0
DAPL     EQU   0
DAPLUPT  EQU   DAPL
DAPLECT  EQU   DAPL+4
DAPLECB  EQU   DAPL+8
DAPLPSCB EQU   DAPL+12
DAPLDAPB EQU   DAPL+16
DFID     EQU   0
@NM00017 EQU   DFID
DAPB04   EQU   0
DA04CD   EQU   DAPB04
DA04FLG  EQU   DAPB04+2
DA04CAT  EQU   DA04FLG
DA04DSE  EQU   DA04FLG
DA04CTRC EQU   DAPB04+6
DA04PDSN EQU   DAPB04+8
DA04CTL  EQU   DAPB04+12
TEXTRET  EQU   0
TUDSN    EQU   TEXTRET+8
TUMBR    EQU   TEXTRET+12
TUPSWD   EQU   TEXTRET+16
TUPSWDND EQU   TUPSWD
KEYLIST  EQU   0
TEXTCORE EQU   0
ADDNUM   EQU   TEXTCORE
ADDTEXT  EQU   TEXTCORE+4
ADLTEXT  EQU   0
ADLKEY   EQU   ADLTEXT
ADLNBR   EQU   ADLTEXT+2
ADLLEN   EQU   ADLTEXT+4
GTPL     EQU   0
GTPLPDL  EQU   GTPL
GTPLPCL  EQU   GTPL+4
GTPLKLST EQU   GTPL+8
GTPLTBLE EQU   GTPL+12
GTPLABLK EQU   GTPL+16
GTPLOUTA EQU   GTPL+20
S99RB    EQU   0
S99FLAG1 EQU   S99RB+2
S99FLG11 EQU   S99FLAG1
S99RSC   EQU   S99RB+4
S99ERROR EQU   S99RSC
S99TXTPP EQU   S99RB+8
S99FLAG2 EQU   S99RB+16
S99FLG21 EQU   S99FLAG2
S99FLG22 EQU   S99FLAG2+1
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUENT EQU   S99TUNIT+4
S99TUFLD EQU   0
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   -256
CVTRELNO EQU   CVTFIX+252
ABLKBUF  EQU   0
ATTRBUF  EQU   0
BLKBUF   EQU   0
BUFRDSN  EQU   0
BUFRMBR  EQU   0
BUFRPASS EQU   0
CLASSBUF EQU   0
DDNBUF   EQU   0
DFMSGWTP EQU   0
DFRC     EQU   0
DIRBUF   EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
MBRBUF   EQU   0
MSVGBUF  EQU   0
MXVOLBUF EQU   0
PASSBUF  EQU   0
POSTBUF  EQU   0
SERBUF   EQU   0
SPACBUF2 EQU   0
SPACEBUF EQU   0
UCNTBUF  EQU   0
USIDBUF  EQU   0
UTYPBUF  EQU   0
VSEQBUF  EQU   0
INPARMS  EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTDAIR  EQU   CVTS01+384
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
*                                      START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00036 EQU   CVTFIX+248
@NM00035 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
S99TUPRM EQU   S99TUFLD+2
S99TULEN EQU   S99TUFLD
S99TUPAR EQU   S99TUENT+2
S99TULNG EQU   S99TUENT
S99TUNUM EQU   S99TUNIT+2
S99TUKEY EQU   S99TUNIT
S99TUPND EQU   S99TUP
S99TUPLN EQU   S99TUPTR
S99FLG24 EQU   S99FLAG2+3
S99FLG23 EQU   S99FLAG2+2
S99PCINT EQU   S99FLG22
S99UDEVT EQU   S99FLG22
S99MOUNT EQU   S99FLG21
S99CATLG EQU   S99FLG21
S99TIONQ EQU   S99FLG21
S99OFFLN EQU   S99FLG21
S99WTUNT EQU   S99FLG21
S99NORES EQU   S99FLG21
S99WTDSN EQU   S99FLG21
S99WTVOL EQU   S99FLG21
S99RSV01 EQU   S99RB+12
S99INFO  EQU   S99RSC+2
S99FLG12 EQU   S99FLAG1+1
S99JBSYS EQU   S99FLG11
S99NOMNT EQU   S99FLG11
S99NOCNV EQU   S99FLG11
S99ONCNV EQU   S99FLG11
S99VERB  EQU   S99RB+1
S99RBLN  EQU   S99RB
ADLPARM  EQU   ADLTEXT+6
ADDUNIT  EQU   TEXTCORE+36
@NM00034 EQU   TEXTCORE+2
TURTDSO  EQU   TEXTRET+100
TURTDDN  EQU   TEXTRET+96
TUDISP   EQU   TEXTRET+92
TURND    EQU   TEXTRET+88
TURLSE   EQU   TEXTRET+84
TUVSEQ   EQU   TEXTRET+80
TUPRIV   EQU   TEXTRET+76
TUMAXV   EQU   TEXTRET+72
TUPOS    EQU   TEXTRET+68
TULABL   EQU   TEXTRET+64
TUUCNT   EQU   TEXTRET+60
TUUNIT   EQU   TEXTRET+56
TUHOLD   EQU   TEXTRET+52
TUDEST   EQU   TEXTRET+48
TUUSING  EQU   TEXTRET+44
TUDIR    EQU   TEXTRET+40
TUSPACE  EQU   TEXTRET+36
TUBLOK   EQU   TEXTRET+32
TUVOL    EQU   TEXTRET+28
TUSTATS  EQU   TEXTRET+24
TUFILE   EQU   TEXTRET+20
ENTRYNBR EQU   TEXTRET+4
SBPLSIZE EQU   TEXTRET
DA04DSO  EQU   DAPB04+15
@NM00033 EQU   DAPB04+13
@NM00032 EQU   DA04CTL
@NM00031 EQU   DA04CTL
@NM00030 EQU   DA04CTL
@NM00029 EQU   DA04CTL
@NM00028 EQU   DA04CTL
DA04UID  EQU   DA04CTL
@NM00027 EQU   DA04CTL
@NM00026 EQU   DA04CTL
@NM00025 EQU   DAPB04+4
@NM00024 EQU   DA04FLG
@NM00023 EQU   DA04FLG
@NM00022 EQU   DA04FLG
@NM00021 EQU   DA04FLG
@NM00020 EQU   DA04FLG
@NM00019 EQU   DA04FLG
IDNUM    EQU   DFID+1
@NM00018 EQU   @NM00017
DFWTP    EQU   @NM00017
@NM00016 EQU   DSNAMPDE+24
@NM00015 EQU   DSNAMPDE+23
@NM00014 EQU   @NM00013
PSWDPRS1 EQU   @NM00013
PSWDLEN1 EQU   DSNAMPDE+20
@NM00012 EQU   DSNAMPDE+15
@NM00011 EQU   MBRFLG1
MBRLEN1  EQU   DSNAMPDE+12
@NM00010 EQU   DSNAMPDE+7
@NM00009 EQU   DSNFLG1
QUALIF   EQU   DSNFLG1
ONPRESDS EQU   DSNFLG1
DSNLEN1  EQU   DSNAMPDE+4
@NM00008 EQU   DSNPDE1+4
@NM00007 EQU   DSNPDE1
PPLUWA   EQU   PPL+24
PPLCBUF  EQU   PPL+20
PPLANS   EQU   PPL+16
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
CPPLCBUF EQU   CPPL
MSVGRSV2 EQU   MSVGPDE+7
MSVGRSV1 EQU   MSVGFLG
MSVGPRES EQU   MSVGFLG
MSVGLEN  EQU   MSVGPDE+4
VOLRSV2  EQU   VOLSQPDE+7
VOLRSV1  EQU   VOLSQFLG
VOLPRES  EQU   VOLSQFLG
VOLSQLEN EQU   VOLSQPDE+4
MXVRSV2  EQU   MXVOLPDE+7
MXVRSV1  EQU   MXVOLFLG
MXVPRES  EQU   MXVOLFLG
MXVOLLEN EQU   MXVOLPDE+4
POSRSV2  EQU   POSTPDE+7
POSRSV1  EQU   POSFLAG
POSPRES  EQU   POSFLAG
POSLEN   EQU   POSTPDE+4
LABLRSV1 EQU   ALLOCPDL+178
LABELPDE EQU   ALLOCPDL+176
UCNTRSV2 EQU   UNCNTPDE+7
UCNTRSV1 EQU   UCNTFLAG
UCNTPRES EQU   UCNTFLAG
UCNTLEN  EQU   UNCNTPDE+4
UTYPRSV2 EQU   UTYPPDE+7
UTYPRSV1 EQU   UTYPFLAG
UTYPPRES EQU   UTYPFLAG
UTYPLEN  EQU   UTYPPDE+4
USIDRSV2 EQU   USIDPDE+7
USIDRSV1 EQU   USIDFLAG
USIDPRES EQU   USIDFLAG
USIDLEN  EQU   USIDPDE+4
ATTRRSV2 EQU   ATTRPDE+7
ATTRRSV1 EQU   ATTRFLAG
ATTRPRES EQU   ATTRFLAG
ATTRLEN  EQU   ATTRPDE+4
DIRRSV2  EQU   DIRECPDE+7
DIRRSV1  EQU   DIRFLAGS
DIRPRES  EQU   DIRFLAGS
DIRLEN   EQU   DIRECPDE+4
SPCRSV22 EQU   SPACPDE2+7
SPCRSV12 EQU   SPACFLG2
SPCPRES2 EQU   SPACFLG2
SPACLEN2 EQU   SPACPDE2+4
SPACRSV2 EQU   SPACPDE+7
SPACRSV1 EQU   SPACEFLG
SPACPRES EQU   SPACEFLG
SPACELEN EQU   SPACPDE+4
ABLKRSV2 EQU   ABLKPDE+7
ABLKRSV1 EQU   ABLKFLG
ABLKPRES EQU   ABLKFLG
ABLKLEN  EQU   ABLKPDE+4
BLKRSV2  EQU   BLKPDE+7
BLKRSV1  EQU   BLKFLAGS
BLKPRES  EQU   BLKFLAGS
BLKLEN   EQU   BLKPDE+4
SERNEXT  EQU   SERPDE+8
SERRSV2  EQU   SERPDE+7
SERRSV1  EQU   SERFLAGS
SERPRES  EQU   SERFLAGS
SERLEN   EQU   SERPDE+4
CLASRSV2 EQU   CLASPDE+7
CLASRSV1 EQU   CLASFLG
CLASLEN  EQU   CLASPDE+4
DDNRSV2  EQU   DDNMEPDE+7
DDNRSV1  EQU   DDNFLAGS
DDNPRES  EQU   DDNFLAGS
DDNLEN   EQU   DDNMEPDE+4
DSNNEXT  EQU   DSNPDE+24
PASSRSV2 EQU   DSNPDE+23
PASSRSV1 EQU   PASSFLAG
PASSPRES EQU   PASSFLAG
PASSLEN  EQU   DSNPDE+20
MBRRSV2  EQU   DSNPDE+15
MBRRSV1  EQU   MBRFLAGS
MBRPRES  EQU   MBRFLAGS
MBRLEN   EQU   DSNPDE+12
DSNRSV2  EQU   DSNPDE+7
DSNRSV1  EQU   DSNFLAGS
DSNQUOT  EQU   DSNFLAGS
RNDPDE   EQU   ALLOCPDL+44
RLSEPDE  EQU   ALLOCPDL+42
VSEQPDE  EQU   ALLOCPDL+40
PRIVPDE  EQU   ALLOCPDL+38
MAXVPDE  EQU   ALLOCPDL+36
POSPDE   EQU   ALLOCPDL+34
LABLPDE  EQU   ALLOCPDL+32
UCNTPDE  EQU   ALLOCPDL+30
UNITPDE  EQU   ALLOCPDL+28
DESTPDE  EQU   ALLOCPDL+24
USINGPDE EQU   ALLOCPDL+22
DIRPDE   EQU   ALLOCPDL+20
FILEPDE  EQU   ALLOCPDL+10
@NM00006 EQU   ALLOCPDL+4
@NM00005 EQU   ALLOCPDL
FIRSTPTR EQU   ALLOCWA+176
NBLKBUF1 EQU   ALLOCWA+164
PDLADDR3 EQU   ALLOCWA+156
PPLTWO   EQU   ALLOCWA+128
CMDTWOBF EQU   CMDTWO+4
CMDTWOOF EQU   CMDTWO+2
CMDTWOLN EQU   CMDTWO
Q        EQU   ALLOCWA+56
P        EQU   ALLOCWA+52
MSGPTR   EQU   ALLOCWA+48
PRCODE   EQU   ALLOCWA+44
@NM00004 EQU   ALLOCWA+38
NCLASBUF EQU   ALLOCWA+37
@NM00003 EQU   VCFLAGS
SPACE2   EQU   VCFLAGS
SPACE1   EQU   VCFLAGS
AVBLK    EQU   VCFLAGS
PTRMSGS  EQU   ALLOCWA+32
DSNCTR   EQU   ALLOCWA+30
VLISTCTR EQU   ALLOCWA+28
@NM00002 EQU   SWITCH2
@NM00001 EQU   SWITCH2
FIRSTPDE EQU   SWITCH
ASTRSK   EQU   SWITCH
TERMOPT  EQU   SWITCH
PROMPT   EQU   SWITCH
*                                      END UNREFERENCED COMPONENTS
@RC00110 EQU   @EL00001
@RF00134 EQU   @EL00002
@RF00141 EQU   @EL00002
@RF00144 EQU   @EL00002
@RC00146 EQU   @EL00002
@RF00188 EQU   @EL00003
@RF00191 EQU   @EL00003
@RC00193 EQU   @EL00003
@RF00228 EQU   @EL00004
@RF00243 EQU   @EL00004
@RF00246 EQU   @EL00004
@RC00248 EQU   @EL00004
@RF00281 EQU   @EL00005
@RF00285 EQU   @EL00005
@RF00288 EQU   @EL00005
@RC00290 EQU   @EL00005
@RF00318 EQU   @EL00006
@RF00332 EQU   @EL00006
@RF00359 EQU   @EL00006
@RC00394 EQU   @EL00007
@RC00406 EQU   @EL00007
@RF00433 EQU   @EL00008
@RF00449 EQU   @EL00008
@RF00460 EQU   @EL00008
@RC00467 EQU   @EL00008
@RC00462 EQU   @EL00008
@RT00528 EQU   DSNAD1
@RC00497 EQU   @EL00009
@RC00548 EQU   @EL00010
@RF00559 EQU   @EL00010
@RC00590 EQU   @EL00011
@RF00398 EQU   @RC00394
@RC00400 EQU   @RC00394
@RF00473 EQU   @RC00467
@RC00550 EQU   @RC00548
@EL01    EQU   @EL00001
@ENDDATA EQU   *
         END   IKJEFD32,(C'PLS1902',0701,76167)

         TITLE 'IKJEFE11 - WHEN/END COMMAND PROCESSOR                  *
                        '
IKJEFE11 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFE11  73.333'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   CPPLPTR=R1;                     /* SAVE ADDRESS TO CPPL          */
         LR    CPPLPTR,R1                                          0051
*   RFY                                                            0052
*     R1 UNRSTD;                                                   0052
*   IKJWHEN=IKJWHEN&&IKJWHEN;       /* CLEAR WORK AREA               */
         XC    IKJWHEN(88),IKJWHEN                                 0053
*   PPLPTR=ADDR(WHPL);              /* ADDRESS TO COMMON PARM LIST   */
         LA    @10,WHPL                                            0054
         ST    @10,PPLPTR                                          0054
*   STPBPTR=ADDR(WHPBLOCK);         /* ADDR TO STACK CONTROL BLK     */
         LA    STPBPTR,WHPBLOCK                                    0055
*   PPLUPT=CPPLUPT;                 /* UPT POINTER                   */
         L     @06,CPPLUPT(,CPPLPTR)                               0056
         ST    @06,PPLUPT(,@10)                                    0056
*   PPLECT=CPPLECT;                 /* ECT POINTER                   */
         L     @06,CPPLECT(,CPPLPTR)                               0057
         ST    @06,PPLECT(,@10)                                    0057
*   PPLECB=ADDR(WHATTECB);          /* ATTN ECB FOR SERV RTN         */
         LA    @06,WHATTECB                                        0058
         ST    @06,PPLECB(,@10)                                    0058
*   PPLPCL=ADDR(IKJPARSE);          /* PARSE PARM LIST PTR           */
         L     @06,@CV00059                                        0059
         ST    @06,PPLPCL(,@10)                                    0059
*   PPLANS=ADDR(WHPARANS);          /* PARSE ANSWER POINTER          */
         LA    @06,WHPARANS                                        0060
         ST    @06,PPLANS(,@10)                                    0060
*   PPLCBUF=CPPLCBUF;               /* COMMAND BUFFER PTR            */
         L     @06,CPPLCBUF(,CPPLPTR)                              0061
         ST    @06,PPLCBUF(,@10)                                   0061
*   WHCMD=COMMAND;                  /* SAVE COMMAND NAME             */
*                                                                  0062
         MVC   WHCMD(8),@CC00174                                   0062
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF COMMAND IS WHEN OR END - IF COMMAND IS END THEN  */
*   /* DELETE THE TOP COMMAND PROCEDURE AND RETURN TO CALLER         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0063
*   IF ECTPCMD(1:CON4)=ENDCHK       /* CHECK FOR END COMMAND         */
*     THEN                                                         0063
         L     @10,ECTPTR(,CPPLPTR)                                0063
         CLC   ECTPCMD(4,@10),@CC00172                             0063
         BNE   @RF00063                                            0063
*     DO;                                                          0064
*       WHEND=YES;                  /* SET END INDICATOR GO          */
         OI    WHEND,B'10000000'                                   0065
*       CALL DELETE;                /* DELETE CURRENT STCK           */
         BAL   @14,DELETE                                          0066
*     END;                          /* ELEM                          */
*   ELSE                                                           0068
*     DO;                                                          0068
*                                                                  0068
         B     @RC00063                                            0068
@RF00063 DS    0H                                                  0069
*       /*************************************************************/
*       /*                                                           */
*       /* WHEN COMMAND PROCESSING                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0069
*       IF ECTRCDF=ABCHECK          /* CHECK ECT RETURN CODE TO      */
*         THEN                      /* SEE IF PREVIOUS CP HAS        */
         L     @10,ECTPTR(,CPPLPTR)                                0069
         CLI   ECTRCDF(@10),X'80'                                  0069
         BNE   @RF00069                                            0069
*         DO;                       /* ABENDED--IF SO, SEND MSG      */
*           IF ECTRTCD//CON4096=CON0/* IS THERE A USER ABEND         */
*             THEN                  /* IF NOT--                      */
         SLR   @06,@06                                             0071
         ICM   @06,7,ECTRTCD(@10)                                  0071
         LR    @00,@06                                             0071
         SRDA  @00,32                                              0071
         D     @00,@CF00096                                        0071
         LTR   @00,@00                                             0071
         BNZ   @RF00071                                            0071
*             DO;                   /* CALCULATE SYSTEM ABEND IN     */
*               WHRCODE2=ECTRTCD/CON4096;                          0073
         SRL   @06,12                                              0073
         LR    WHRCODE2,@06                                        0073
*               WHMSG2=CON24;       /* HIGH ORDER 12 BITS OF         */
         MVI   WHMSG2,X'18'                                        0074
*             END;                  /* ECTRTCD AND PUT IN 2ND MSG    */
*           ELSE                                                   0076
*             DO;                   /* CALCULATE USER ABEND IN       */
         B     @RC00071                                            0076
@RF00071 DS    0H                                                  0077
*               WHRCODE2=ECTRTCD//CON4096;                         0077
         L     @10,ECTPTR(,CPPLPTR)                                0077
         SLR   @00,@00                                             0077
         ICM   @00,7,ECTRTCD(@10)                                  0077
         SRDA  @00,32                                              0077
         D     @00,@CF00096                                        0077
         LR    WHRCODE2,@00                                        0077
*               WHMSG2=CON20;       /* LOW ORDER 12 BITS OF          */
         MVI   WHMSG2,X'14'                                        0078
*             END;                  /* ECTRTCD AND PUT IN 2ND MSG    */
*           WHMSG1=CON16;           /* SET FIRST LEVEL MSG AND       */
@RC00071 MVI   WHMSG1,X'10'                                        0080
*           WHCMD=ECTPCMD;          /* COMMAND ENTERED IS VAR PART   */
         L     @10,ECTPTR(,CPPLPTR)                                0081
         MVC   WHCMD(8),ECTPCMD(@10)                               0081
*         END;                                                     0082
*       ELSE                                                       0083
*         DO;                                                      0083
*                                                                  0083
         B     @RC00069                                            0083
@RF00069 DS    0H                                                  0084
*           /*********************************************************/
*           /*                                                       */
*           /* SAVE THE FIRST CHARACTER OF THE NEXT COMMAND IF IT    */
*           /* WOULD BE OVERLAID BY INSERTING THE PARSE DELIMETER.   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0084
*           CODEBASE=R11;           /* SAVE CODE REG FOR VALID EXIT  */
         ST    R11,CODEBASE                                        0084
*           DATABASE=R12;           /* SAVE DATA REG FOR VALID EXIT  */
         ST    R12,DATABASE                                        0085
*           DO I=1 TO CPLEN-CON4 WHILE CPCOMM(I)^=LFPAREN;/* SEARCH
*                                      FOR                           */
         LA    I,1                                                 0086
         B     @DE00086                                            0086
@DL00086 L     @10,CPPLCBUF(,CPPLPTR)                              0086
         ALR   @10,I                                               0086
         CLI   CPCOMM-1(@10),C'('                                  0086
         BE    @DC00086                                            0086
*           END;                    /* A LEFT PAREN                  */
         AH    I,@CH00033                                          0087
@DE00086 L     @10,CPPLCBUF(,CPPLPTR)                              0087
         LH    @10,CPLEN(,@10)                                     0087
         SH    @10,@CH00068                                        0087
         CR    I,@10                                               0087
         BNH   @DL00086                                            0087
@DC00086 DS    0H                                                  0088
*           IF I<CPLEN-CON4 THEN    /* IF NOT AT END OF BUFFER THEN  */
         L     @10,CPPLCBUF(,CPPLPTR)                              0088
         LH    @10,CPLEN(,@10)                                     0088
         SH    @10,@CH00068                                        0088
         CR    I,@10                                               0088
         BNL   @RF00088                                            0088
*             DO;                   /* FIND RIGHT PAREN              */
*               DO I=I TO CPLEN-CON4 WHILE CPCOMM(I)^=RTPAREN;     0090
         B     @DE00090                                            0090
@DL00090 L     @10,CPPLCBUF(,CPPLPTR)                              0090
         ALR   @10,I                                               0090
         CLI   CPCOMM-1(@10),C')'                                  0090
         BE    @DC00090                                            0090
*               END;                                               0091
         AH    I,@CH00033                                          0091
@DE00090 L     @10,CPPLCBUF(,CPPLPTR)                              0091
         LH    @10,CPLEN(,@10)                                     0091
         SH    @10,@CH00068                                        0091
         CR    I,@10                                               0091
         BNH   @DL00090                                            0091
@DC00090 DS    0H                                                  0092
*               IF I<CPLEN-CON4 THEN/* IF NOT AT END OF BUFFER THEN  */
         L     @10,CPPLCBUF(,CPPLPTR)                              0092
         LH    @06,CPLEN(,@10)                                     0092
         LR    @04,@06                                             0092
         SH    @04,@CH00068                                        0092
         CR    I,@04                                               0092
         BNL   @RF00092                                            0092
*                 DO;               /* SAVE NEXT CHARACTER IN BUF    */
*                   I=CON1+I;       /* AND INSERT A SEMI-COLON TO    */
         AH    I,@CH00033                                          0094
*                   WHCHAR=CPCOMM(I);/* TERMINATE THE PARSE SCAN     */
         LR    @04,@10                                             0095
         ALR   @04,I                                               0095
         MVC   WHCHAR(1),CPCOMM-1(@04)                             0095
*                   CPCOMM(I)=SEMI;                                0096
         LR    @04,@10                                             0096
         ALR   @04,I                                               0096
         MVI   CPCOMM-1(@04),C';'                                  0096
*                   WHLEN=CPLEN-(I+CON3);/* COMMAND LENGTH - THREE IS
*                                      ADDED TO I CTR TO TAKE INTO 0097
*                                      ACCOUNT THE LENGTH OFFSET   0097
*                                      FIELDS MINUS ONE FOR THE FIRST
*                                      POSITION                      */
         LA    @04,3                                               0097
         ALR   @04,I                                               0097
         SLR   @06,@04                                             0097
         STH   @06,WHLEN                                           0097
*                   WHCOMM=ADDR(CPCOMM(I));/* START OF COMMAND       */
         LA    @10,CPCOMM-1(I,@10)                                 0098
         ST    @10,WHCOMM                                          0098
*                 END;                                             0099
*             END;                                                 0100
@RF00092 DS    0H                                                  0101
*           PPLUWA=ADDR(VCPARMS);   /* VALID EXIT PARMS              */
@RF00088 L     @10,PPLPTR                                          0101
         LA    @06,VCPARMS                                         0101
         ST    @06,PPLUWA(,@10)                                    0101
*           RFY                                                    0102
*             R1 RSTD;                                             0102
*           R1=PPLPTR;              /* PARSE PARM LIST               */
         LR    R1,@10                                              0103
*           DO;                     /* LINK EP(IKJPARS)              */
*             I00601='00'X;         /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        0105
*             I00602=ADDR(IKJPARS); /* ADDR OF EP/DE                 */
         LA    @10,@CC00108                                        0106
         STCM  @10,7,I00602                                        0106
*             I00604=0;             /* DCB PTR                       */
         SLR   @10,@10                                             0107
         STCM  @10,7,I00604                                        0107
*             I00603='00'X;         /* ERRET FLAG                    */
         MVI   I00603,X'00'                                        0108
*             RESPECIFY                                            0109
*              (GPR15P) RESTRICTED;                                0109
*             GPR15P=ADDR(I006);    /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         0110
*             SVC(6);               /* ISSUE LINK SVC                */
         SVC   6                                                   0111
*             RESPECIFY                                            0112
*              (GPR15P) UNRESTRICTED;                              0112
*           END;                    /* LINK EP(IKJPARS)              */
*           RFY                                                    0114
*             R1 UNRSTD;                                           0114
*           RFY                                                    0115
*             R15 RSTD;                                            0115
*           WHRCODE2=R15;           /* SAVE RETURN CODE              */
         LR    WHRCODE2,R15                                        0116
*           RFY                                                    0117
*             R15 UNRSTD;                                          0117
*           IF WHRCODE2^=CON0       /* IF EQUAL TO ZERO DETERMINE    */
*             THEN                  /* CONDITION CODE OF RELATION    */
         LTR   WHRCODE2,WHRCODE2                                   0118
         BZ    @RF00118                                            0118
*             DO;                                                  0119
*                                                                  0119
*               /*****************************************************/
*               /*                                                   */
*               /* DIAGNOSE RETURN CODE FROM PARSE. CLEAN UP AND     */
*               /* RETURN TO TMP. RETURN CODE 4 YEILDS NO MSG.       */
*               /* OTHERWISE PUT OUT COMMAND SYSTEM ERROR MSG.       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0120
*               WHRET=YES;          /* USED FOR STACK FLUSH          */
         OI    WHRET,B'01000000'                                   0120
*               IF WHRCODE2=CON4    /* USER IN NO PROMPT MODE?       */
*                 THEN              /* YES                           */
         CH    WHRCODE2,@CH00068                                   0121
         BNE   @RF00121                                            0121
*                 WHBYPASS=YES;     /* INDICATE NO MSG NEEDED        */
         OI    WHBYPASS,B'00100000'                                0122
*               WHMSG2=CON4;        /* SECOND LEVEL MSG-PARSE ERR    */
@RF00121 MVI   WHMSG2,X'04'                                        0123
*             END;                                                 0124
*           ELSE                                                   0125
*             DO;                                                  0125
*                                                                  0125
         B     @RC00118                                            0125
@RF00118 DS    0H                                                  0126
*               /*****************************************************/
*               /*                                                   */
*               /* GETCCODE - COMPARE THE ECT RETURN CODE TO THE CODE*/
*               /* THAT WAS SPECIFIED BY THE USER . A COMPARE EQUAL  */
*               /* SETS A CONDITION CODE ZERO, A COMPARE WHERE THE   */
*               /* ECT RETURN CODE IS LOW SETS A CONDITION CODE ONE  */
*               /* AND A COMPARE WHERE THE ECT RETURN CODE IS HIGH   */
*               /* SETS A CONDITION CODE OF THREE. THE CCODES TABLE  */
*               /* HAS THE VALID CONDITION CODES FOR EACH OF THE     */
*               /* COMPARISON OPERATOR.                              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0126
*               T4=WHWORK1;         /* INIT T4 FOR COND CODE OFFSET  */
         L     T4,WHWORK1                                          0126
*               T4=T4+CON1;         /* IN CCODES TABLE--INDEX WAS SET
*                                      IN PARSE VALIDITY CHECK     0127
*                                      ROUTINE                       */
         LA    @10,1                                               0127
         ALR   T4,@10                                              0127
*               T3=CCODES(T4);      /* SAVE COND CODE INDICATOR      */
         SLR   T3,T3                                               0128
         IC    T3,CCODES-1(T4)                                     0128
*               T4=T4+CON1;         /* SET INDEX FOR NEXT CODE       */
         ALR   T4,@10                                              0129
*               T4=CCODES(T4);      /* GET SECOND COND CODE INDIC    */
*                                                                  0130
         SLR   @09,@09                                             0130
         IC    @09,CCODES-1(T4)                                    0130
         LR    T4,@09                                              0130
*               /*****************************************************/
*               /*                                                   */
*               /* FIND THE CONDITION CODE THAT RESULTS WHEN THE     */
*               /* PREVIOUS COMMAND PROCESSOR'S RETURN CODE IS       */
*               /* COMPARED TO THE USER SUPPLIED VALUE AND DETERMINE */
*               /* IF THE RELATIONAL OPERATOR IS SATISFIED           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0131
*               WORK1=WORK1&&WORK1; /* CLEAR SCRATCH PAD AREA        */
         XC    WORK1(8),WORK1                                      0131
*               I=CON5-PDENUML;     /* OFFSET IN WORK AREA           */
         L     @09,WHPARANS                                        0132
         LA    I,5                                                 0132
         SLR   @06,@06                                             0132
         ICM   @06,3,PDENUML(@09)                                  0132
         SLR   I,@06                                               0132
*               WHWORK2(I:CON4)=PDENUM->NUMBER;/* GET VALUE TO PACK  */
         LA    @06,WHWORK2-1(I)                                    0133
         LA    @15,4                                               0133
         SLR   @15,I                                               0133
         L     @09,PDENUM(,@09)                                    0133
         EX    @15,@SM00322                                        0133
*               PACK(WHWORK2,WHWORK2);                             0134
         PACK  WHWORK2(4),WHWORK2(4)                               0134
*               CVB(I,WHWORK2);     /* PUT IN SAME FORMAT AS ECT     */
         XC    @TS00001(8),@TS00001                                0135
         MVC   @TS00001+4(4),WHWORK2                               0135
         CVB   I,@TS00001                                          0135
*               WHWORK2F=I;         /* SAVE THE NUMBER FOR COMPARE   */
         ST    I,WHWORK2F                                          0136
*               WHWORK1=ECTRTCD;    /* LAST CP'S RETURN CODE         */
         L     @09,ECTPTR(,CPPLPTR)                                0137
         SLR   @06,@06                                             0137
         ICM   @06,7,ECTRTCD(@09)                                  0137
         ST    @06,WHWORK1                                         0137
*               IF WHWORK1C(2:CON4)=WHWORK2(2:CON4) THEN           0138
         CLC   WHWORK1C+1(3),WHWORK2+1                             0138
         BNE   @RF00138                                            0138
*                 I=CON1;                                          0139
         LR    I,@10                                               0139
*               ELSE                                               0140
*                 IF WHWORK1C(2:4)<WHWORK2(2:CON4) THEN            0140
         B     @RC00138                                            0140
@RF00138 CLC   WHWORK1C+1(3),WHWORK2+1                             0140
         BNL   @RF00140                                            0140
*                   I=CON2;                                        0141
         LA    I,2                                                 0141
*                 ELSE                                             0142
*                   I=CON3;                                        0142
         B     @RC00140                                            0142
@RF00140 LA    I,3                                                 0142
*               IF T4=I×T3=I        /* IF COND. OPER. IS SATISFIED 0143
*                                      TAKE CURR ELEMENT FROM INPUT
*                                      STACK                         */
*                 THEN                                             0143
@RC00140 DS    0H                                                  0143
@RC00138 CR    T4,I                                                0143
         BE    @RT00143                                            0143
         CR    T3,I                                                0143
         BNE   @RF00143                                            0143
@RT00143 DS    0H                                                  0144
*                 DO;                                              0144
*                   CALL DELETE;    /* DELETE THE CURRENT PROCEDURE  */
         BAL   @14,DELETE                                          0145
*                   IF WHRCODE2=CON0 THEN                          0146
         SLR   @10,@10                                             0146
         CR    WHRCODE2,@10                                        0146
         BNE   @RF00146                                            0146
*                     DO;                                          0147
*                                                                  0147
*                       /*********************************************/
*                       /*                                           */
*                       /* ADDELEM - IF THE DELETE OF THE TOP ELEMENT*/
*                       /* WAS SUCCESSFUL THEN PLACE THE ACTION      */
*                       /* COMMAND ON THE TOP OF THE INPUT STACK AS A*/
*                       /* PROCEDURE ELEMENT WITH THE NOLIST AND     */
*                       /* PROMPT OPTIONS                            */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0148
*                       IF WHCOMM^=CON0 THEN                       0148
         C     @10,WHCOMM                                          0148
         BE    @RF00148                                            0148
*                         DO;       /* FREE PDL BUILT BY PARSE       */
*                           WHLEN=LSDLEN+WHLEN+CON4;/* SP 78 CORE FOR
*                                      LSD AND COMM                  */
         LA    @10,20                                              0150
         AH    @10,WHLEN                                           0150
         STH   @10,WHLEN                                           0150
*                           WHSUBP=CON78;/* INSERT SUBPOOL NUMBER    */
         MVI   WHSUBP,X'4E'                                        0151
*                           RFY                                    0152
*                             R0 RSTD;                             0152
*                           R0=WHGETM;/* SUBPOOL AND COMMD LENGTH    */
         L     R0,WHGETM                                           0153
*                           GENERATE(GETMAIN R,LV=(0));            0154
         GETMAIN R,LV=(0)
*                           RFY                                    0155
*                             R0 UNRSTD;                           0155
*                           RFY                                    0156
*                             R1 RSTD;                             0156
*                           LSDPTR=R1;/* SAVE PTR TO LSD             */
         LR    LSDPTR,R1                                           0157
*                           RFY                                    0158
*                             R1 UNRSTD;                           0158
*                           LSDCLEAR=LSDCLEAR&&LSDCLEAR;/* CLEAR   0159
*                                      GOTTEN CORE                   */
         XC    LSDCLEAR(20,LSDPTR),LSDCLEAR(LSDPTR)                0159
*                           WHWORK1=LSDPTR+LSDLEN;/* BEGINNING OF  0160
*                                      COMMAND BUFF                  */
         LA    @10,16                                              0160
         LR    @09,LSDPTR                                          0160
         ALR   @09,@10                                             0160
         ST    @09,WHWORK1                                         0160
*                           WHLEN=WHLEN-LSDLEN;/* LENGTH OF COMMAND
*                                      BUFFER                        */
         LCR   @10,@10                                             0161
         AH    @10,WHLEN                                           0161
         STH   @10,WHLEN                                           0161
*                           CBUF2LEN=WHLEN;/* COMMAND LENGTH         */
         STH   @10,CBUF2LEN(,@09)                                  0162
*                           LSDTOTLN=WHLEN;/* SAVE INDICATOR FOR   0163
*                                      FREEMAIN                      */
         STH   @10,LSDTOTLN(,LSDPTR)                               0163
*                           LSDADATA=WHWORK1;/* FILL IN LSD WITH BUFF
*                                      PTR                           */
         ST    @09,LSDADATA(,LSDPTR)                               0164
*                           LSDANEXT=LSDADATA;/* PTR TO NEXT IS SAME
*                                      AS FIRST--ONLY ONE ELEMENT    */
         ST    @09,LSDANEXT(,LSDPTR)                               0165
*                           WHWORK1=WHWORK1+CON4;/* INDEX PAST HEADER*/
*                                                                  0166
         AH    @09,@CH00068                                        0166
         ST    @09,WHWORK1                                         0166
*                           /*****************************************/
*                           /*                                       */
*                           /* MOVE NEXT COMMAND TO SUBPOOL 78       */
*                           /*                                       */
*                           /*****************************************/
*                                                                  0167
*                           COMMBUF1(1)=WHCHAR;/* RESTORE CHARACTER
*                                      OVERLAID BY THE SEMI COLON    */
         L     @06,WHCOMM                                          0167
         MVC   COMMBUF1(1,@06),WHCHAR                              0167
*                           COMMBUF2(1:WHLEN-CON4)=WHCOMM->COMMBUF1(1:
*                               WHLEN-CON4);                       0168
*                                                                  0168
         SH    @10,@CH00083                                        0168
         EX    @10,@SM00324                                        0168
*                           /*****************************************/
*                           /*                                       */
*                           /* ADD COMMAND TO INPUT STACK            */
*                           /*                                       */
*                           /*****************************************/
*                                                                  0169
*                           WHWORK1=ADDR(COMMBUF2);/* ADDR OF COMMD
*                                      TO BE ADDED                   */
         ST    @09,WHWORK1                                         0169
*                           STPB=STPB&&STPB;/* CLEAR PARM BLOCK      */
         XC    STPB(16,STPBPTR),STPB(STPBPTR)                      0170
*                           RFY                                    0171
*                            (R1,                                  0171
*                             R6) RSTD;                            0171
*                           R1=STPLPTR;/* PARM PTR FOR STACK         */
         L     R1,STPLPTR                                          0172
*                           R6=LSDPTR;/* SET UP REG 2 FOR STACK      */
         LR    R6,LSDPTR                                           0173
*                           GEN                                    0174
*(STACK STORAGE=((6),PROCN,PROMPT),MF=(E,(1)));                    0174
         STACK STORAGE=((6),PROCN,PROMPT),MF=(E,(1))
*                           RFY                                    0175
*                            (R1,                                  0175
*                             R6) UNRSTD;                          0175
*                           RFY                                    0176
*                             R15 RSTD;                            0176
*                           WHRCODE2=R15;/* PROC SUCCESSFULLY ADDED? */
         LR    WHRCODE2,R15                                        0177
*                           RFY                                    0178
*                             R15 UNRSTD;                          0178
*                           IF WHRCODE2^=CON0 THEN                 0179
         LTR   WHRCODE2,WHRCODE2                                   0179
         BZ    @RF00179                                            0179
*                             DO;   /* FREE PDL SET UP BY PARSE      */
*                               WHRET=YES;/* USED FOR STACK FLUSH    */
         OI    WHRET,B'01000000'                                   0181
*                               WHMSG2=CON8;/* I/O ERROR WHEN ADDING
*                                      NEW COMMAND PROC TO STACK     */
         MVI   WHMSG2,X'08'                                        0182
*                               WHLEN=WHLEN+LSDLEN;/* GET TOTAL    0183
*                                      LENGTH OF CORE                */
         LA    @10,16                                              0183
         AH    @10,WHLEN                                           0183
         STH   @10,WHLEN                                           0183
*                               RFY                                0184
*                                (R0,                              0184
*                                 R1) RSTD;                        0184
*                               R0=WHGETM;/* AND SUBPOOL FOR ERROR   */
         L     R0,WHGETM                                           0185
*                               R1=LSDPTR;/* IN STACK ROUTINE        */
         LR    R1,LSDPTR                                           0186
*                               GENERATE(FREEMAIN R,LV=(0),A=(1)); 0187
         FREEMAIN R,LV=(0),A=(1)
*                               RFY                                0188
*                                (R0,                              0188
*                                 R1) UNRSTD;                      0188
*                             END;  /* ISSUE MESSAGE TO USER         */
*                         END;                                     0190
@RF00179 DS    0H                                                  0191
*                     END;                                         0191
@RF00148 DS    0H                                                  0192
*                 END;                                             0192
@RF00146 DS    0H                                                  0193
*             END;                                                 0193
*                                                                  0193
@RF00143 DS    0H                                                  0194
*           /*********************************************************/
*           /*                                                       */
*           /* FREEPDL                                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0194
*           GEN(IKJRLSA WHPARANS);  /* FREE PARSE PARM LIST          */
@RC00118 DS    0H                                                  0194
         IKJRLSA WHPARANS
*         END;                                                     0195
*     END;                                                         0196
*                                                                  0196
@RC00069 DS    0H                                                  0197
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT CODE                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0197
*   IF WHMSG^=CON0&WHBYPASS=NO      /* IF NO MESSAGE THEN            */
*     THEN                                                         0197
@RC00063 SLR   @10,@10                                             0197
         ICM   @10,3,WHMSG                                         0197
         LTR   @10,@10                                             0197
         BZ    @RF00197                                            0197
         TM    WHBYPASS,B'00100000'                                0197
         BNZ   @RF00197                                            0197
*     DO;                           /* SET RC AND FREE WORK AREA   0198
*                                      RETURN TO TMP                 */
*       WHRCODE=WHRCODE2;           /* PASS RETURN CODE FOR POSSIBLE
*                                      USE IN MESSAGE                */
         ST    WHRCODE2,WHRCODE                                    0199
*       RFY                                                        0200
*         R1 RSTD;                                                 0200
*       R1=ADDR(IKJWHEN);           /* SAVE WORK AREA POINTER        */
         LA    R1,IKJWHEN                                          0201
*       RFY                                                        0202
*         R1 UNRSTD;                                               0202
*       CALL IKJEFE15;                                             0203
         L     @15,@CV00060                                        0203
         BALR  @14,@15                                             0203
*     END;                                                         0204
*   IF WHRET=YES THEN               /* WHEN ERROR                    */
@RF00197 TM    WHRET,B'01000000'                                   0205
         BNO   @RF00205                                            0205
*     DO;                                                          0206
*       STPLSTPB=STPBPTR;           /* PTR TO STACK PARM BLOCK       */
         L     @10,STPLPTR                                         0207
         ST    STPBPTR,STPLSTPB(,@10)                              0207
*       STPB=STPB&&STPB;            /* CLEAR STACK PARAMETER BLOCK   */
         XC    STPB(16,STPBPTR),STPB(STPBPTR)                      0208
*       R1=STPLPTR;                 /* SET UP FOR STACK MACRO        */
         LR    R1,@10                                              0209
*       GENERATE;                                                  0210
         STACK DELETE=ALL,MF=(E,(1))
         TCLEARQ INPUT
*     END;                                                         0211
*   RETURN CODE(ECTRTCD);                                          0212
*                                                                  0212
@RF00205 L     @10,ECTPTR(,CPPLPTR)                                0212
         SLR   @04,@04                                             0212
         ICM   @04,7,ECTRTCD(@10)                                  0212
         L     @13,4(,@13)                                         0212
         L     @00,@SIZDATD                                        0212
         LR    @01,@12                                             0212
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@04                                             0212
         L     @14,12(,@13)                                        0212
         LM    @00,@12,20(@13)                                     0212
         BR    @14                                                 0212
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING IS THE PARSE CONTROL LIST FOR THE WHEN COMMAND  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   GEN DATA DEFS(PARS);                                           0213
*                                                                  0213
*   /*****************************************************************/
*   /*                                                               */
*   /* DELETE                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0214
*DELETE:                                                           0214
*   PROC;                                                          0214
@EL00001 L     @13,4(,@13)                                         0214
@EF00001 L     @00,@SIZDATD                                        0214
         LR    @01,@12                                             0214
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0214
         BR    @14                                                 0214
@PB00001 DS    0H                                                  0214
DELETE   STM   @14,@07,@SA00002                                    0214
         STM   @09,@12,@SA00002+40                                 0214
*   STPLSTPB=STPBPTR;               /* PTR TO STACK PARM BLOCK       */
         L     @10,STPLPTR                                         0215
         ST    STPBPTR,STPLSTPB(,@10)                              0215
*   STPB=STPB&&STPB;                /* CLEAR STACK PARAMETER BLOCK   */
         XC    STPB(16,STPBPTR),STPB(STPBPTR)                      0216
*   RFY                                                            0217
*     R1 RSTD;                                                     0217
*   R1=STPLPTR;                     /* SET UP FOR STACK MACRO        */
         LR    R1,@10                                              0218
*   RFY                                                            0219
*     R1 UNRSTD;                                                   0219
*   GENERATE;                                                      0220
*                                  /*DELETE ELEMENT FROM INPUT STACK */
         STACK DELETE=PROC,MF=(E,(1))
*   RFY                                                            0221
*     R15 RSTD;                                                    0221
*   WHRCODE2=R15;                   /* SAVE RETURN CODE              */
         LR    WHRCODE2,R15                                        0222
*   RFY                                                            0223
*     R15 UNRSTD;                                                  0223
*   IF WHRCODE2^=CON0               /* IF ERROR ENCOUNTERED WHILE    */
*     THEN                          /* DELETING ELEMENT FROM         */
         LTR   WHRCODE2,WHRCODE2                                   0224
         BZ    @RF00224                                            0224
*     DO;                           /* INPUT STACK ISSUE DIAGNOSTIC
*                                      ELSE PROCESS OPERANDS         */
*       WHRET=YES;                  /* USED FOR STACK FLUSH          */
         OI    WHRET,B'01000000'                                   0226
*       WHMSG2=CON8;                /* 2ND LEV--STACK DELET ERR      */
         MVI   WHMSG2,X'08'                                        0227
*     END;                          /* ISSUE MESSAGE TO USER         */
*   END DELETE;                                                    0229
*                                                                  0229
@EL00002 DS    0H                                                  0229
@EF00002 DS    0H                                                  0229
@ER00002 LM    @14,@07,@SA00002                                    0229
         LM    @09,@12,@SA00002+40                                 0229
         BR    @14                                                 0229
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE - PARSE VALIDITY CHECK EXIT USED TO SYNTAX CHECK THE  */
*   /* RELATIONAL OPERATOR                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0230
*COMPARE:                                                          0230
*   PROC OPTIONS(NOSAVEAREA);                                      0230
COMPARE  STM   @14,@12,12(@13)                                     0230
*   DCL                                                            0231
*     1 SAVEVAL BASED(VALWORK),     /* DUMMY TO ACCESS REGS OF OF  0231
*                                      IKJEFE11 BEFORE GOING TO PARSE*/
*      2 CDEBASE PTR(31),           /* REGISTER 11                   */
*      2 DATBASE PTR(31);           /* REGISTER 12                   */
*   R11=CDEBASE;                    /* RESTORE BASE REG              */
         L     @15,VALWORK(,R1)                                    0232
         L     R11,CDEBASE(,@15)                                   0232
*   R12=DATBASE;                    /* RESTORE ADDR TO WORK AREA     */
*                                                                  0233
         L     R12,DATBASE(,@15)                                   0233
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE COUNTERS AND RETURN CODE FOR SCAN THROUGH          */
*   /* CONDITIONAL OPERATOR TABLE FOR MATCH ON COMMAND AND AND TABLE */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   SAVRCPAR=CON0;                  /* INIT TO VALID RELAT. OPER     */
         SLR   @10,@10                                             0234
         ST    @10,SAVRCPAR(,R13)                                  0234
*   T4=CON0;                        /* INITIALIZE INDEX TO ZERO      */
         LR    T4,@10                                              0235
*   I=CON1;                                                        0236
         LA    I,1                                                 0236
*   DO J=CON7 TO 0 BY-1;            /* SEARCH FOR OPERATION          */
         LA    J,7                                                 0237
@DL00237 DS    0H                                                  0238
*     DO K=CON1 TO 0 BY-1;          /* SEARCH 2 LIKE ENTRIES         */
*                                                                  0238
         LA    K,1                                                 0238
@DL00238 DS    0H                                                  0239
*       /*************************************************************/
*       /*                                                           */
*       /* VERIFY THAT THE CONDITIONAL OPERATOR SPECIFIED ON THE     */
*       /* COMMAND IS ONE OF THOSE INDICATED IN THE CONDITIONAL      */
*       /* OPERATOR TABLE                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0239
*       WHWORK2H=PDEOP(1:PDEOPERL); /* PUT OPERATOR IN 2 BYTE AREA 0239
*                                      FOR COMPARE (SOME OPERATORS 0239
*                                      ARE ONLY 1 BYTE)              */
         MVI   WHWORK2H+1,C' '                                     0239
         L     @10,VALPDE(,R1)                                     0239
         SLR   @07,@07                                             0239
         ICM   @07,3,PDEOPERL(@10)                                 0239
         BCTR  @07,0                                               0239
         L     @10,PDEOPER(,@10)                                   0239
         EX    @07,@SM00326                                        0239
*       IF OPERTAB(I:I+1)=WHWORK2H THEN                            0240
         LA    @10,OPERTAB-1(I)                                    0240
         CLC   0(2,@10),WHWORK2H                                   0240
         BE    @RT00240                                            0240
*         GOTO GOODOPER;            /* RETURN TO PARSE FOR SCAN OF 0241
*                                      REST OF COMMAND               */
*       ELSE                                                       0242
*         I=I+CON2;                 /* SCAN ENTIRE TABLE UNTIL A   0242
*                                      MATCH IS FOUND -- IF NON IS 0242
*                                      FOUND ISSUE DIAGNOSTIC        */
         AH    I,@CH00072                                          0242
*     END;                                                         0243
         BCTR  K,0                                                 0243
         LTR   K,K                                                 0243
         BNM   @DL00238                                            0243
*     T4=T4+CON2;                   /* UPDATE INDEX VALUE            */
         AH    T4,@CH00072                                         0244
*   END;                                                           0245
*                                                                  0245
         BCTR  J,0                                                 0245
         LTR   J,J                                                 0245
         BNM   @DL00237                                            0245
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE RETURN CODE TO REFLECT WHETHER OR NOT THE CONDIT      */
*   /* OPERATOR IS VALID--0=VALID 4=INVALID                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0246
*   SAVRCPAR=CON4;                  /* INDICATE INVAL REL OPER       */
         MVC   SAVRCPAR(4,R13),@CF00068                            0246
*GOODOPER:                                                         0247
*   ;                                                              0247
GOODOPER DS    0H                                                  0248
*   WHWORK1=T4;                     /* SAVE OFFSET IN CCODES TABLE   */
         ST    T4,WHWORK1                                          0248
*   RETURN;                         /* RETURN TO PARSE               */
@EL00003 DS    0H                                                  0249
@EF00003 DS    0H                                                  0249
@ER00003 LM    @14,@12,12(@13)                                     0249
         BR    @14                                                 0249
*   END COMPARE;                                                   0250
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR01P PTR(31) REG(1),                                       0251
*     GPR15P PTR(31) REG(15);                                      0251
*   DCL                                                            0252
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        0253
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0254
*     I031F FIXED(31) BASED,                                       0254
*     I031P PTR(31) BASED,                                         0254
*     I015F FIXED(15) BASED,                                       0254
*     I015P PTR(15) BASED,                                         0254
*     I008P PTR(8) BASED,                                          0254
*     I001C CHAR(1) BASED;                                         0254
*   END IKJEFE11                                                   0255
*                                                                  0255
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJWHEN )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IKJSTPL )                                       */
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */
*                                                                  0255
*       ;                                                          0255
@DATA    DS    0H
@CH00033 DC    H'1'
@CH00072 DC    H'2'
@CH00083 DC    H'5'
@SM00322 MVC   0(0,@06),NUMBER(@09)
@SM00324 MVC   COMMBUF2(0,@09),COMMBUF1(@06)
@SM00326 MVC   WHWORK2H(0),PDEOP(@10)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    14F
IKJEFE11 CSECT
         DS    0F
@CF00068 DC    F'4'
@CH00068 EQU   @CF00068+2
@CF00096 DC    F'4096'
@DATD    DSECT
         DS    0D
PPLPTR   DS    A
OPERPTR  DS    A
WHENRET  DS    F
         DS    0D
@TS00001 DS    CL8
WORK1    DS    CL8
         ORG   WORK1
WHWORK1  DS    AL4
         ORG   WHWORK1
WHWORK1C DS    CL4
         ORG   WORK1+4
WHWORK2F DS    FL4
         ORG   WHWORK2F
WHWORK2  DS    CL4
         ORG   WHWORK2
WHWORK2H DS    CL2
         ORG   WORK1+8
VCPARMS  DS    CL8
         ORG   VCPARMS
CODEBASE DS    AL4
DATABASE DS    AL4
         ORG   VCPARMS+8
IKJWHEN  DS    CL88
         ORG   IKJWHEN
WHPL     DS    CL28
WHPBLOCK DS    CL20
WHPARANS DS    AL4
WHATTECB DS    CL4
WHMSG    DS    AL2
         ORG   WHMSG
WHMSG1   DS    AL1
WHMSG2   DS    AL1
         ORG   IKJWHEN+58
WHSWI    DS    BL1
         ORG   WHSWI
WHEND    DS    BL1
WHRET    EQU   WHSWI+0
WHBYPASS EQU   WHSWI+0
         ORG   IKJWHEN+59
WHCHAR   DS    CL1
WHENWAS  DS    AL4
WHRCODE  DS    AL4
WHCOMM   DS    AL4
WHCMD    DS    CL8
WHGETM   DS    AL4
         ORG   WHGETM
WHSUBP   DS    AL1
WHFILL   DS    AL1
WHLEN    DS    AL2
         ORG   IKJWHEN+84
WHWASIZ  DS    AL4
         ORG   IKJWHEN+88
ILIST    DS    CL12
IKJEFE11 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00059 DC    V(IKJPARSE)
@CV00060 DC    V(IKJEFE15)
         DS    0D
@CC00172 DC    C'END '
@CC00108 DC    C'IKJPARS '
@CC00174 DC    C'COMMAND '
OPERTAB  DS    CL48
         ORG   OPERTAB
@NM00001 DC    CL2'EQ'
@NM00002 DC    CL2'= '
@NM00003 DC    CL2'LT'
@NM00004 DC    CL2'< '
@NM00005 DC    CL2'GT'
@NM00006 DC    CL2'> '
@NM00007 DC    CL2'NE'
@NM00008 DC    CL2'^='
@NM00009 DC    CL2'LE'
@NM00010 DC    CL2'<='
@NM00011 DC    CL2'GE'
@NM00012 DC    CL2'>='
@NM00013 DC    CL2'NG'
@NM00014 DC    CL2'^>'
@NM00015 DC    CL2'NL'
@NM00016 DC    CL2'^<'
CCODES   DS    CL16
         ORG   CCODES
@NM00017 DC    X'01'
@NM00018 DC    X'01'
@NM00019 DC    X'02'
@NM00020 DC    X'02'
@NM00021 DC    X'03'
@NM00022 DC    X'03'
@NM00023 DC    X'02'
@NM00024 DC    X'03'
@NM00025 DC    X'01'
@NM00026 DC    X'02'
@NM00027 DC    X'01'
@NM00028 DC    X'03'
@NM00029 DC    X'01'
@NM00030 DC    X'02'
@NM00031 DC    X'01'
@NM00032 DC    X'03'
         ORG   OPERTAB+48
IKJEFE11 CSECT
PARS     EQU *
IKJPARSE IKJPARM
IKJRC    IKJKEYWD  DEFAULT='SYSRC'
         IKJNAME  'SYSRC',SUBFLD=IKJCOMP
IKJCOMP  IKJSUBF
IKJOPER  IKJIDENT ' OPERATOR',FIRST=ANY,OTHER=ANY,                     *
               MAXLNTH=2,VALIDCK=COMPARE,                              *
               PROMPT='1 OR 2 CHARACTER OPERATOR',                     *
               HELP='VALID OPERATOR: EQ  NE  LT  GT  NL  NG  LE  GE'
IKJNUM   IKJIDENT 'NUMERIC',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=4,     *
               PROMPT=' 1 TO 4 DIGIT INTEGER',                         *
               HELP=' 1 TO 4 CHARACTER NUMERIC VALUE TO WHICH PREVIOUS *
               COMMAND RETURN CODE WILL BE COMPARED'
         IKJENDP
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFE11 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
LSDPTR   EQU   @03
STPBPTR  EQU   @07
WHRCODE2 EQU   @08
K        EQU   @06
J        EQU   @05
I        EQU   @02
T4       EQU   @03
T3       EQU   @04
CPPLPTR  EQU   @05
R11      EQU   @11
R12      EQU   @12
R0       EQU   @00
R1       EQU   @01
R6       EQU   @06
R13      EQU   @13
R15      EQU   @15
GPR15P   EQU   @15
GPR01P   EQU   @01
R14      EQU   @14
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
CPPL     EQU   0
CPPLCBUF EQU   CPPL
CPPLUPT  EQU   CPPL+4
CPPLECT  EQU   CPPL+12
PPL      EQU   0
PPLUPT   EQU   PPL
PPLECT   EQU   PPL+4
PPLECB   EQU   PPL+8
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
ECT      EQU   0
ECTRCDF  EQU   ECT
ECTRTCD  EQU   ECT+1
ECTPCMD  EQU   ECT+12
ECTSWS   EQU   ECT+28
STPL     EQU   0
STPLSTPB EQU   STPL+12
STPB     EQU   0
LSD      EQU   0
LSDADATA EQU   LSD
LSDTOTLN EQU   LSD+6
LSDANEXT EQU   LSD+8
LSDCLEAR EQU   0
SAVECURR EQU   0
SAVRCPAR EQU   SAVECURR+16
PARSPDL  EQU   0
PDENUM   EQU   PARSPDL+20
PDENUML  EQU   PARSPDL+24
NUMBER   EQU   0
VALIDPAR EQU   0
VALPDE   EQU   VALIDPAR
VALWORK  EQU   VALIDPAR+4
VALIDPDL EQU   0
PDEOPER  EQU   VALIDPDL
PDEOPERL EQU   VALIDPDL+4
PDEOP    EQU   0
COMMBUF1 EQU   0
COMMBUF2 EQU   0
CPPARM1  EQU   0
CPLEN    EQU   CPPARM1
CPCOMM   EQU   CPPARM1+4
SAVEVAL  EQU   0
CDEBASE  EQU   SAVEVAL
DATBASE  EQU   SAVEVAL+4
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
CPPARM   EQU   0
STPLPTR  EQU   PPLPTR
ECTPTR   EQU   CPPLECT
CBUF2LEN EQU   COMMBUF2
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
I00605   EQU   I006+8
CPOFFSET EQU   CPPARM1+2
@NM00043 EQU   PDEOP
PDEOPERF EQU   VALIDPDL+6
PDENUMF  EQU   PARSPDL+26
@NM00042 EQU   PARSPDL+18
@NM00041 EQU   PARSPDL+16
@NM00040 EQU   PARSPDL+12
@NM00039 EQU   PARSPDL+10
PDERC    EQU   PARSPDL+8
@NM00038 EQU   PARSPDL+4
PDECHAIN EQU   PARSPDL
@NM00037 EQU   SAVECURR+8
LASTSAV  EQU   SAVECURR+4
@NM00036 EQU   SAVECURR
LSDRSVRD EQU   LSD+12
LSDRCLEN EQU   LSD+4
STPBOTDD EQU   STPB+12
STPBINDD EQU   STPB+8
STPBALSD EQU   STPB+4
@NM00035 EQU   STPB
STPLECB  EQU   STPL+8
STPLECT  EQU   STPL+4
STPLUPT  EQU   STPL
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
@NM00034 EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00033 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
CPPLPSCB EQU   CPPL+8
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00224 EQU   @EL00002
@RT00240 EQU   GOODOPER
@PB00003 EQU   @EL00001
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEFE11

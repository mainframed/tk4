         TITLE ' IKJEFE01 - EXEC CONTROL MODULE'
         LCLA  &T,&SPN                                            0001
.@001    ANOP                                                     0001
IKJEFE01 CSECT ,                                                  0001
         ST    @E,12(0,@D)                                        0001
         ST    @0,20(0,@D)                                        0001
         STM   @2,@C,28(@D)                                       0001
         BALR  @B,0                                               0001
@PSTART  DS    0H                                                 0001
         USING @PSTART+00000,@B                                   0001
         LR    @C,@1                                              0001
         L     @0,@SIZ001                                         0001
         GETMAIN  R,LV=(0)                                        0001
         XR    @C,@1                                              0001
         XR    @1,@C                                              0001
         XR    @C,@1                                              0001
         USING @DATD+00000,@C                                     0001
         L     @0,20(0,@D)                                        0001
         XC    @TEMPS(@L),@TEMPS                                  0001
         ST    @D,@SAV001+4                                       0001
         LA    @F,@SAV001                                         0001
         ST    @F,8(0,@D)                                         0001
         LR    @D,@F                                              0001
&SPN     SETA  1
         DS    0H
*         CPPLPTR = R1;                       /* SET POINTER TO CPPL  *
         ST    @1,E01DATDF+232                                    0070
*         CLARE = ''B;                        /* INITIALIZE SWITCHES
*                                                 ZERO
*                                                     OUT
*                                                        WORK
*                                                           AREAS
*                                                INITIALIZE
*                                                  ATAB AND
*                                                   FTAB POINTERS
*                                                    AND
*                                                     WORKAREAS       *
         XC    CLARE(44),CLARE                                    0071
*         RETCDAR = KON0;                     /* RET CDE AREA   Y01676*
         LH    @F,KON0                                            0072
         ST    @F,E01DATDF+280                                    0072
*         CBUFLSAV  = CBUFLNG;                /* SAVE CMD BFR LENGTH  *
         L     @8,E01DATDF+232                                    0073
         L     @8,0(0,@8)          CBUFPTR                        0073
         MVC   E01DATDF+358(2),0(@8)                              0073
*         RESTRICT (R2,R4);                   /* RESTRICT REGS        *
*         STPRM(1)  = R12;                    /* SAVE BSL BASE REG    *
         ST    @C,E01DATDF+236                                    0075
*         STPRM(2)  = R13;                    /* SAVE BSL SAVE REG    *
         ST    @D,E01DATDF+240                                    0076
*         STPRM(3)  = R11;                    /* SAVE BSL BASE REG    *
         ST    @B,E01DATDF+244                                    0077
*         R4  = ADDR(STPRM(1));               /* POINT TO STAE PARMS  *
         LA    @4,E01DATDF+236                                    0078
*         R2 = ADDR(SHTDWN);                  /* STAE EXIT ADDRESS    *
         LA    @2,SHTDWN                                          0079
*         GEN;
         MVC   RSTAE,STAEL                  MOVE LIST FORM OF STAE
         LA    R1,RSTAE                     LOAD ADDRESS OF LIST FORM
         STAE  (R2),PARAM=(R4),MF=(E,(1))   ABEND EXIT MACRO
         LTR   R15,R15                      TEST RETURN CODE
         BNZ   E01CNT40                     BRANCH IF UNSUCCESSFUL
         DS    0H
*         RELEASE (R2,R4);                    /* RELEASE  REGS        *
*  /*                                                                 *
*         PPLPTR  = ADDR(CBCOR);              /* INITIALIZE PTR TO
*                                                  SERVICE ROUTINE
*                                                   PARM BLOCK        *
         LA    @F,E01DATDF+252                                    0082
         ST    @F,E01DATDF+248                                    0082
*         RESTRICT (R2);
*         GEN (LA    R2,DCBPD);               /* MOVE DCB             *
         LA    R2,DCBPD
         DS    0H
*         DCBAR = DCBP;                       /* MODEL TO DYNAMIC CORE*
         MVC   E01DATDF(88),0(@2)                                 0085
*         RELEASE (R2);
*         GMNMAX  = KON2048;                  /* SET MAX FOR GETMAIN  *
         LH    @F,KON2048                                         0087
         ST    @F,E01DATDF+144                                    0087
*         GMNMIN  = KON48;                    /* SET MIN FOR GETMAIN  *
         LH    @F,KON48                                           0088
         ST    @F,E01DATDF+140                                    0088
*         GEN;
         MVC   RCLO,CLOL                     MOVE LIST FORM OF CLOSE
         DS    0H
*
* /********************************************************************
**/* P SET UP INTERFACE TO SCANNING ROUTINE */
**/* D (YES,,NO,%D1) IS THIS AN IMPLICIT EXEC? */
**/* S IKJSCAN: LINK TO COMMAND SCAN */
**/* P (,E01CNT03) STORE MEMBERNAME IN E01DATDF (SEE PROLOGUE) */
* /********************************************************************
*         /************************************************************
*         /*SETTUP INTERFACE AND LINK TO COMMAND SCAN TO              *
*         /*THE FIRST WORD IN THE COMMAND BUFFER                      *
*         /************************************************************
*         CSPLFLG  = ADDR(SRECB);             /* SET FLAGS TO 0       *
         LA    @F,E01DATDF+276                                    0090
         L     @9,CSPLPTR                                         0090
         ST    @F,12(0,@9)                                        0090
*         CSPLUPT  = CPPLUPT;                 /* INITIALIZE           *
         L     @6,E01DATDF+232                                    0091
         MVC   0(4,@9),4(@6)                                      0091
*         CSPLECB  = ADDR(SRECB);             /*  POINTER TO ECB      *
         LA    @F,E01DATDF+276                                    0092
         ST    @F,8(0,@9)                                         0092
*         SRECB = KON0;                       /*  ECB                 *
         LH    @F,KON0                                            0093
         ST    @F,E01DATDF+276                                    0093
*         CSPLECT  = CPPLECT;                 /*  POINTER TO ECT      *
         MVC   4(4,@9),12(@6)                                     0094
*         CSPLCBUF  = CPPLCBUF;               /* POINTER TO CMD BUFFER*
         MVC   20(4,@9),0(@6)                                     0095
*         CSPLOA  = ADDR(SP78ADDR);           /* SET ADDR OF ANSWER
*                                                  AREA               *
         LA    @F,E01DATDF+156                                    0096
         ST    @F,16(0,@9)                                        0096
*         R1  = PPLPTR;                       /* POINT TO PARM LIST   *
         L     @1,E01DATDF+248                                    0097
*         IF CBUFOFF = KON0                   /* IF THIS IS AN IMPLI- *
*           THEN                              /* CIT INVOCATION       *
         LH    @F,KON0                                            0098
         MVC   @TEMP2+2(2),2(@8)                                  0098
         C     @F,@TEMP2                                          0098
         BC    07,@9FF                                            0098
*             DO;
*               GEN(LINK  EP=IKJSCAN);        /* LINK TO CMD SCAN     *
         LINK  EP=IKJSCAN
         DS    0H
*               E01SW1 = '1'B;                /* SET IMPLICIT SW ON   *
         OI    E01DATDF+202,B'10000000'                           0101
*               MMNAMAR  = IMPMEM(1:CSOALNM); /* MOVE MEMBER NAME     *
         L     @7,CSPLPTR                                         0102
         L     @7,16(0,@7)         CSOAPTR                        0102
         LH    @4,4(0,@7)                                         0102
         BCTR  @4,0                                               0102
         L     @5,0(0,@7)          CSOA                           0102
         LR    @E,@5                                              0102
         LA    @A,E01DATDF+96                                     0102
         MVI   0(@A),C' '                                         0102
         MVC   1(007,@A),0(@A)                                    0102
         EX    @4,@MVC                                            0102
*               GOTO E01CNT03;                /* BYPASS               *
         BC    15,E01CNT03                                        0103
*             END;                            /*   DSNAME PARSE       *
*
* /********************************************************************
**/*%D1: P REDUCE BUFFER LENGTH-SO ONLY PARSE DSNAME*/
**/*E01SCN03: P SET UP INTERFACE TO PARSE */
**/* S IKJPARS: LINK TO PARSE FOR DATA SET NAME */
**/* D (NO,,YES,E01CNT03:LT) WERE PARMS CORRECT ? */
**/* P (,E01MML05) REQUEST TERMINATION */
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE HANDLES EXPLICIT INVOCATIONS               *
*         /*BY INTERFACING WITH PARSE TO OBTAIN THE DSNAME            *
*         /************************************************************
*         TEM01 = CBUFLNG - KON4;             /* OBTAIN NO. OF BYTES
*                                                TO BE SCANNED        *
@9FF     LH    @F,KON4                                            0105
         LCR   @F,@F                                              0105
         L     @8,E01DATDF+232                                    0105
         L     @8,0(0,@8)          CBUFPTR                        0105
         MVC   @TEMP2+2(2),0(@8)                                  0105
         A     @F,@TEMP2                                          0105
         ST    @F,TEM01                                           0105
*          DO TEM02 = CBUFOFF + KON1 TO TEM01;/* REDUCE THE
*                                                BUFFER LENGTH -AVOID *
         LH    @F,KON1                                            0106
         MVC   @TEMP2+2(2),2(@8)                                  0106
         A     @F,@TEMP2                                          0106
         BC    15,@DO9FD                                          0106
*           IF CBUFDATA(TEM02) = KBLNK ×      /* PARSING       PARMS  *
*              CBUFDATA(TEM02) = KTAB  ×      /* OTHER THAN DSNAME TO *
*              CBUFDATA(TEM02) =  KCOM        /* AVOID UNWANTED MSGS  *
*             THEN
@DO9FE   L     @8,TEM02                                           0107
         L     @9,E01DATDF+232                                    0107
         L     @9,0(0,@9)          CBUFPTR                        0107
         LA    @A,3(@8,@9)                                        0107
         CLC   0(1,@A),KBLNK                                      0107
         BC    08,@9FA                                            0107
         CLC   0(1,@A),KTAB                                       0107
         BC    08,@9F9                                            0107
         CLC   0(1,@A),KCOM                                       0107
         BC    07,@9F8                                            0107
*               GOTO  E01SCN03;               /* FROM PARSE           *
         BC    08,E01SCN03                                        0108
*         END;
* E01SCN03: CBUFLNG = TEM02 + KON3;           /* SET NEW BUFFER LENGTH*
@9F8     L     @F,TEM02                                           0109
         AH    @F,@D1                                             0109
@DO9FD   ST    @F,TEM02                                           0109
         C     @F,TEM01                                           0109
         BC    12,@DO9FE                                          0109
E01SCN03 LH    @F,KON3                                            0110
         A     @F,TEM02                                           0110
         L     @8,E01DATDF+232                                    0110
         L     @8,0(0,@8)          CBUFPTR                        0110
         STH   @F,0(0,@8)                                         0110
*         PPLANS  = ADDR(PDLPTR);             /* SET POINTER TO ANS
*                                                PLACE POINTER        *
         LA    @F,E01DATDF+308                                    0111
         L     @9,E01DATDF+248                                    0111
         ST    @F,16(0,@9)                                        0111
*         PPLPCL = ADDR(DSNMPARS);            /* ADDRESS OF PCL       *
         L     @6,@V1              ADDRESS OF DSNMPARS            0112
         ST    @6,12(0,@9)                                        0112
*         R1  = PPLPTR;                       /* SET POINTER TO PARM
*                                                BLOCK                *
         L     @1,E01DATDF+248                                    0113
*         GEN(LINK  EP=IKJPARS            LINK TO PARSE);
         LINK  EP=IKJPARS            LINK TO PARSE
         DS    0H
*         CNVA = R15;                         /* SAVE RETURN CODE     *
         STH   @F,E01DATDF+200                                    0115
*         IF CNVA ^= KON0                     /* IF CORRECT PARMS     *
*           THEN                              /* COULD NOT BE OBTAINED*
         LH    @F,KON0                                            0116
         CH    @F,E01DATDF+200                                    0116
         BC    08,@9F7                                            0116
*             IF CNVA = KON4                  /* CHECK IF IT WAS DUE  *
*               THEN                          /* BEING IN NO PROMPT   *
         LH    @F,KON4                                            0117
         CH    @F,E01DATDF+200                                    0117
         BC    07,@9F6                                            0117
*                 DO;                         /* MODE - IF SO GO TO   *
*                   E01SW9 = '1'B;            /* TERMINATE WITHOUT    *
         OI    E01DATDF+203,B'10000000'                           0119
*                   GOTO E01CNT16;            /* PUTTING OUT MESSAGE  *
         BC    15,E01CNT16                                        0120
*                 END;
*               ELSE                          /* OTHERWISE            *
*                 DO;                         /* INDICATE THE SYSTEM
*                                                ERROR MESSAGE        *
*                   LVL1NO = KON24;           /* FOR FIRST LEVEL      *
@9F6     MVC   E01DATDF+304(2),KON24                              0123
*                   LVL2NO = KON2;            /* AND PARSE RETURN     *
         MVC   E01DATDF+306(2),KON2                               0124
*                   VARSGLNG = KONX00;        /* CODE FOR SECOND LEVEL*
         MVC   E01DATDF+296(1),KONSTRUC                           0125
*                   ADPTR1 = KON0;            /* INDICATE TERMINATION *
         LH    @F,KON0                                            0126
         ST    @F,E01DATDF+88                                     0126
*                   GOTO E01MML10;            /* AFTER THE MSG AND GO *
         BC    15,E01MML10                                        0127
*                 END;                        /* TO PUT MESSAGE       *
*         PDLPTR = PDLPTR + KON8;             /* UPDATE PAST PDL CHAIN
*                                                WORDS                *
@9F5     EQU   *                                                  0129
@9F7     LH    @F,KON8                                            0129
         A     @F,E01DATDF+308                                    0129
         ST    @F,E01DATDF+308                                    0129
*         CBUFLNG = CBUFLSAV;                 /* RESTORE BFR LENGTH   *
         L     @8,E01DATDF+232                                    0130
         L     @8,0(0,@8)          CBUFPTR                        0130
         MVC   0(2,@8),E01DATDF+358                               0130
*
* /********************************************************************
**/*E01CNT03: S IKJEFE05: OBTAIN SYMBOLIC PARM DEFINITION */
**/* D (NO,,YES,%D2) IS THIS AN EXPLICIT EXEC ?*/
**/* M RELEASE PARSE DESCRIPTOR LIST */
**/*%D2: D (YES,E01CNT16:BT,NO,) HAS AN ERROR OCCURRED? */
**/*E01SPD95: D (NO,E01MML05,YES,) DOES # OF POS ON INVO = # ON PROC?*/
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE INVOKES MODULE IKJEFE05 TO DEFINE THE      *
*         /*SYMBOLIC PARAMETERS OF THE PROCEDURE VIA                  *
*         /*THE 'PROC' STATEMENT AND CHECKS FOR A SUCCESSFULL         *
*         /*DEFINITION                                                *
*         /************************************************************
* E01CNT03:    ;
*         R1 = ADDR(E01DATDF);                /* SET REG1 POINTING TO *
E01CNT03 LA    @1,E01DATDF                                        0132
*         CALL IKJEFE05;                      /* PARM BLOCK AND CALL
*                                                E05 TO OBTAIN SYM.
*                                                PARM DEFINITION      *
         L     @F,@V2              ADDRESS OF IKJEFE05            0133
         BALR  @E,@F                                              0133
*         RESTRICT (R2,R3,R4,R5);
*         IF E01SW1 = '0'B                    /* IF THIS IS EXPLICIT  *
*           THEN                              /*  EXEC                *
         TM    E01DATDF+202,B'10000000'                           0135
         BC    05,@9F4                                            0135
*             DO;                             /*   THEN               *
*               PDLPTR = PDLPTR - KON24;      /*  RESET PDL POINTER   *
         L     @F,E01DATDF+308                                    0137
         SH    @F,KON24                                           0137
         ST    @F,E01DATDF+308                                    0137
*               R1 = ADDR(PDLPTR);            /* REG2 POINTS TO PDL
*                                                POINTER              *
         LA    @1,E01DATDF+308                                    0138
*               GEN(IKJRLSA (R1));            /* RELEASE PDL          *
         IKJRLSA (R1)
         DS    0H
*             END;                            /*                      *
*         R1 = R3;                            /* SET R1 POINTING TO
*                                                FTAB START           *
@9F4     LR    @1,@3                                              0141
*         IF E01SW9 = '1'B                    /* IF AN ERROR OCCURRED *
*           THEN                              /*  GO TO START         *
         TM    E01DATDF+203,B'10000000'                           0142
*             GOTO E01CNT16;                  /*   TERMINATION        *
         BC    01,E01CNT16                                        0143
* E01SPD95: ;                                 /* RETURN POINT IF NO   *
*         IF POSSPC ^= POSCNT                 /* MORE PARAMETERS ARE
*                                                FOUND - IF NUMBER OF
*                                                POSITIONALS FOUND IS
*                                                NOT EQUAL TO NUMBER
*                                                SPECIFIED IT IS AN
*                                                ERROR                *
*           THEN                              /* THEN                 *
E01SPD95 L     @F,E01DATDF+132                                    0145
         C     @F,E01DATDF+168                                    0145
         BC    08,@9F3                                            0145
*             DO;                             /*  SET UP PROPER       *
*               LVL1NO = KON9;                /*  INDICATORS FOR THE  *
         MVC   E01DATDF+304(2),KON9                               0147
*               LVL2NO = KON1;                /*  MESSAGE MODULE      *
         MVC   E01DATDF+306(2),KON1                               0148
*               VARSGLN2 = KONX00;            /* NO 2ND LVL VARIABLE  *
         MVC   E01DATDF+300(1),KONSTRUC                           0149
*               VARSGLNG = KONX00;            /* NO 1ST LVL VARIABLE  *
         MVC   E01DATDF+296(1),KONSTRUC                           0150
*               IF ABLK1 = KON0               /* IF THERE IS NO ATAB  *
*                 THEN                        /*  OR FTAB BYPASS      *
         LH    @F,KON0                                            0151
         C     @F,E01DATDF+284                                    0151
         BC    07,@9F2                                            0151
*                   ADPTR1 = ADDR(E01CNT07);  /* HOUSEKEEPING    M1848*
         LA    @F,E01CNT07                                        0152
         ST    @F,E01DATDF+88                                     0152
         BC    15,@9F1                                            0153
*                 ELSE                        /* ELSE SET HOUSEKEEPING*
*                   ADPTR1 = ADDR(E01SPD96);  /*  RETURN ADDRESS      *
@9F2     LA    @F,E01SPD96                                        0153
         ST    @F,E01DATDF+88                                     0153
*               GOTO E01MML10;                /*  AND EXIT TO PUT OUT *
         BC    15,E01MML10                                        0154
*             END;                            /*  MESSAGE AND TERM.   *
*
* /********************************************************************
**/*E01SPD96: D (YES,,NO,E01CNT07) IS THERE AN ATAB AND/OR FTAB? */
**/* D (YES,,NO,E01CNT05) IS THERE 8 UNUSED BYTES IN ATAB? */
**/* S IKJEFE03: FREE RESIDUAL UNUSED IN ATAB */
**/*E01CNT05: P CALCULATE ATAB AND FTAB LENGTH */
**/*E01CNT07: D (NO,,YES,E01CNT16:LT) WAS THERE AN ERROR? */
**/* S IKJEFE02: PERFORM PARSING OF INVOCATION STMT */
**/* D (NO,,YES,E01CNT16:LT) WAS AN ERROR IN PARSING? */
**/* D (YES,,NO,E01CNT15:LT) IS THERE AN ATAB AND/OR FTAB? */
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE PERFORMS HOUSEKEEPING FOR ATAB             *
*         /*AND FTAB BLOCKS BEFORE  GOING TO MODULE E02.              *
*         /************************************************************
* E01SPD96: IF ATABIND = KON0                 /* IF THERE IS NO ATAB/ *
*             THEN                            /*   FTAB BYPASS HOUSE- *
@9F3     EQU   *                                                  0156
E01SPD96 LH    @F,KON0                                            0156
         C     @F,E01DATDF+172                                    0156
*               GOTO E01CNT07;                /*   KEEPING            *
         BC    08,E01CNT07                                        0157
*         R5->ATABFLGS = R5->ATABFLGS × KONX20;
         OC    4(1,@5),KONSTRUC+2                                 0158
*                                             /* SET BIT TO INDICATE
*                                                LAST ELEMENT         *
*         CNVC  = R5->ATABELNC;               /* ALIGN LENGTH         *
         MVC   E01DATDF+200(2),5(@5)                              0159
*         R5 = R5 + CNVA + KON7;              /* UPDATE PTR PAST ELMT*/
         LH    @F,KON7                                            0160
         AH    @F,E01DATDF+200                                    0160
         AR    @5,@F                                              0160
*         ATABIND  = R4;                      /* STORE ATAB BLCK ADDR *
         ST    @4,E01DATDF+172                                    0161
*         ATABCUR  = R5;                      /* STORE ATAB ELMT ADDR *
         ST    @5,E01DATDF+176                                    0162
*         FTABIND  = R1;                      /* STORE FTAB BLCK ADDR *
         ST    @1,E01DATDF+180                                    0163
*         FTABCUR  = R2;                      /* STORE FTAB ELMT ADDR *
         ST    @2,E01DATDF+184                                    0164
*         IF (R4 + R4->ATABLNG - R5) ^> KON7  /* IF THERE ARE NOT 8   *
*           THEN                              /* UNUSED BYTES IN ATAB *
         LCR   @F,@5                                              0165
         A     @F,8(0,@4)                                         0165
         AR    @F,@4                                              0165
         CH    @F,KON7                                            0165
*             GOTO E01CNT05;                  /* BYPASS FREEMAIN      *
         BC    12,E01CNT05                                        0166
*         GEN;
         LA    5,7(5)               IF NOT ON DOUBLE WRD
         SRA   5,3                  BOUNDARY
         SLA   5,3                  ADJUST STARTING ADDR
         DS    0H
*         TSTLNG  = R5;                       /* STORE FOR FREEMAIN
*                                                ADDRESS              *
         ST    @5,E01DATDF+136                                    0168
*         REGSAV(2)  = R1;                    /* SAVE REG1            *
         ST    @1,E01DATDF+208                                    0169
*         R1  = ADDR(E01DATDF);               /* SET REG1 POINTING TO
*                                                PARMS                *
         LA    @1,E01DATDF                                        0170
*         R3  = R4 + R4 -> ATABLNG - R5;      /* SET AMT TO BE FREED  *
         LCR   @F,@5                                              0171
         A     @F,8(0,@4)                                         0171
         AR    @F,@4                                              0171
         LR    @3,@F                                              0171
*         R4  = KON1;                         /* SET SUBPOOL INDICATOR*
         LH    @4,KON1                                            0172
*         E01SW13  = '1'B;                    /* SET FREEMAIN SWITCH  *
         OI    E01DATDF+203,B'00001000'                           0173
*         CALL  IKJEFE03;                     /* PERFORM FREEMAIN     *
         L     @F,@V3              ADDRESS OF IKJEFE03            0174
         BALR  @E,@F                                              0174
*         E01SW13  = '0'B;                    /* RESET FREEMAIN SWITCH*
         NI    E01DATDF+203,B'11110111'                           0175
*         R1  = REGSAV(2);                    /* RESTORE REG1         *
         L     @1,E01DATDF+208                                    0176
*         RELEASE  (R2,R3,R4,R5);
* E01CNT05:   ;                               /* RETURN POINT FROM    *
*         ATABLNG = ATABCUR - ATABIND;        /*   FREEMAIN SET NEW
*                                                  ATAB LENGTH        *
E01CNT05 L     @F,E01DATDF+176                                    0179
         S     @F,E01DATDF+172                                    0179
         L     @8,E01DATDF+172                                    0179
         ST    @F,8(0,@8)                                         0179
*         FTABDLNG  = FTABCUR - FTABIND;      /* SET NUMBER OF BYTES  *
         L     @F,E01DATDF+184                                    0180
         S     @F,E01DATDF+180                                    0180
         L     @9,E01DATDF+180                                    0180
         STH   @F,10(0,@9)                                        0180
* E01CNT07:  ;                                /* IN USE               *
*         IF E01SW9 = '1'B                    /* IF AN ERROR WAS FOUND*
*           THEN                              /*  THEN GO TO          *
E01CNT07 TM    E01DATDF+203,B'10000000'                           0182
*             GOTO E01CNT16;                  /*  START TERMINATION   *
         BC    01,E01CNT16                                        0183
*         R1  = ADDR(E01DATDF);               /* SET PTR TO PARAMETERS
*                                                USED COMMONLY        *
         LA    @1,E01DATDF                                        0184
*         CALL  IKJEFE02;                     /* PERFORM PARSING OF
*                                                THE INVOCATION STMT  *
         L     @F,@V4              ADDRESS OF IKJEFE02            0185
         BALR  @E,@F                                              0185
*         IF E01SW9 = '1'B  × E01SW11 = '1'B  /* IF AN ERROR OCCURRED *
*           THEN                              /*  DURING PARSING TAKE *
         TM    E01DATDF+203,B'10000000'                           0186
         BC    01,@9F0                                            0186
         TM    E01DATDF+203,B'00100000'                           0186
         BC    12,@9EF                                            0186
*             GOTO     E01CNT16;              /*  ERROR EXIT          *
         BC    03,E01CNT16                                        0187
*         IF E01SW3 = '1'B   × ATABIND = KON0 /* IF THERE ARE NO ATAB *
*           THEN                              /*  FTAB BLOCKS BYPASS  *
@9EF     TM    E01DATDF+202,B'00100000'                           0188
         BC    01,@9EE                                            0188
         LH    @F,KON0                                            0188
         C     @F,E01DATDF+172                                    0188
         BC    07,@9ED                                            0188
*             GOTO E01CNT15;                  /* HOUSEKEEPING         *
         BC    15,E01CNT15                                        0189
*
* /********************************************************************
**/*E01CNT10: D (YES,E01CNT12:LT,NO,E01CNT13:BT) IS THER 8 UNUSED BYTES
**/*IN FTAB? */
**/*E01CNT12: S IKJEFE03: FREE RESIDUAL UNUSED IN FTAB */
**/*E01CNT13: D (YES,,NO,E01CNT10:RT) IS THIS THE LAST FTAB BLOCK? */
**/*E01CNT15: S IKJEFE03: READ PROC INTO STORAGE WITH PARM SUBST */
* /********************************************************************
*         /************************************************************
*         /*THE FOLLOWING CODE RELEASES ANY UNUSED PORTION            *
*         /*OF THE FTAB BLOCK THEN CALLS IKJEFE03 TO PLACE            *
*         /*THE PROCEDURE INTO SUB-POOL 78 AND REPLACE                *
*         /*SYMBOLIC PARAMETERS WITH THEIR VALUES                     *
*         /************************************************************
* E01CNT10: IF FTABLNG - FTABDLNG ^> KON7     /* IF THERE ARE NOT 8   *
*             THEN                            /* UNUSED BYTES IN FTAB *
@9ED     EQU   *                                                  0190
E01CNT10 L     @8,E01DATDF+180                                    0190
         LH    @F,10(0,@8)                                        0190
         LCR   @F,@F                                              0190
         AH    @F,8(0,@8)                                         0190
         CH    @F,KON7                                            0190
*               GOTO  E01CNT13;               /* BYPASS FREEMAIN      *
         BC    12,E01CNT13                                        0191
*         FTABCUR  = FTABIND + FTABDLNG;      /* POINT TO FIRST UNUSED*
         LH    @F,10(0,@8)                                        0192
         A     @F,E01DATDF+180                                    0192
         ST    @F,E01DATDF+184                                    0192
*         GEN;
         TM    FTABCUR+3,X'07'       BYTE IN FTAB
         BC    8,E01CNT12            IF NOT ON DOUBLE WRD
         NI    FTABCUR+3,X'F8'       ADJUST STARTING ADDR
         L     @E,FTABCUR            CORRESPONDINGLY AND
         LA    @E,8(@E)              STORE FOR FREEMAIN
         ST    @E,FTABCUR            ROUTINE
         DS    0H
* E01CNT12: TEM01 = KON0;                     /* SET SUBPOOL INDICATOR*
E01CNT12 LH    @F,KON0                                            0194
         ST    @F,TEM01                                           0194
*         REGSAV(2)  = R1;                    /* SAVE REG1            *
         ST    @1,E01DATDF+208                                    0195
*         RESTRICT  (R3,R4);
*         R1  = ADDR(E01DATDF);               /* SET REG1 POINTING TO
*                                                PARMS                *
         LA    @1,E01DATDF                                        0197
*         R4  = KON1;                         /* SET SUBPOOL INDICATOR*
         LH    @4,KON1                                            0198
*         R3  = FTABLNG + FTABIND - FTABCUR;  /* SET AMT TO BE FREED  *
         L     @3,E01DATDF+184                                    0199
         LCR   @3,@3                                              0199
         A     @3,E01DATDF+180                                    0199
         L     @2,E01DATDF+180                                    0199
         AH    @3,8(0,@2)                                         0199
*         TSTLNG  = FTABCUR;                  /* SET ADDRESS          *
         MVC   E01DATDF+136(4),E01DATDF+184                       0200
*         E01SW13  = '1'B;                    /* SET FREEMAIN SWITCH  *
         OI    E01DATDF+203,B'00001000'                           0201
*         CALL  IKJEFE03;                     /* PERFORM FREEMAIN     *
         L     @F,@V3              ADDRESS OF IKJEFE03            0202
         BALR  @E,@F                                              0202
*         R1  = REGSAV(2);                    /* RESTORE REG1         *
         L     @1,E01DATDF+208                                    0203
*         RELEASE  (R3,R4);
*         E01SW13  = '0'B;                    /* RESET FREEMAIN SWITCH*
         NI    E01DATDF+203,B'11110111'                           0205
*         FTABLNG  = FTABCUR - FTABIND;       /* SET NEW LENGTH OF BLK*
         L     @F,E01DATDF+184                                    0206
         S     @F,E01DATDF+180                                    0206
         L     @8,E01DATDF+180                                    0206
         STH   @F,8(0,@8)                                         0206
* E01CNT13: IF  FTABNXT ^= KON0               /* IF THIS NOT LAST     *
*             THEN                            /*  BLOCK               *
E01CNT13 LH    @F,KON0                                            0207
         L     @8,E01DATDF+180                                    0207
         C     @F,4(0,@8)                                         0207
         BC    08,@9EC                                            0207
*               DO;                           /*  FIND NEXT           *
*                 FTABIND  = FTABNXT;         /*   DO FREEMAIN        *
         MVC   E01DATDF+180(4),4(@8)                              0209
*                 GOTO  E01CNT10;             /*   AGAIN              *
         BC    15,E01CNT10                                        0210
*               END;                          /*                      *
* E01CNT15:     ;                             /* RETURN FROM FREEMAIN *
@9EC     EQU   *                                                  0212
*         R1  = ADDR(E01DATDF);               /* SET PARM PTR         *
E01CNT15 LA    @1,E01DATDF                                        0213
*         CALL  IKJEFE03;                     /* READ PROCEDURE INTO
*                                                MAIN STORAGE WITH
*                                                SUBSTITUTION         *
         L     @F,@V3              ADDRESS OF IKJEFE03            0214
         BALR  @E,@F                                              0214
*
* /********************************************************************
**/*E01CNT16: D (YES,,NO,E01CNT17:RT) IS THIS TERMINATION OF ABEND? */
**/* D (YES,,NO,E01CNT17:RT) IS THERE ANY S.P. 78 CORE GOTTEN? */
**/* P CALCULATE AMT OF CORE TO BE FREE FOR BLOCKS */
**/* S IKJEFE03: PERFORM FREEMAIN */
**/* D (YES,,NO,E01CNT16:RT) HAVE ALL BLOCKS BEEN FREED? */
**/*E01CNT17: D (YES,,NO,E01CNT25) IS DATA SET OPEN? */
**/* M CLOSE DATA SET */
**/*E01CNT25: D (YES,,NO,E01CNT37:LL) IS THERE ATAB OR FTAB? */
**/*E01CNT27: P GET TO THE FIRST BLOCK OF FTAB (ATAB)*/
**/*E01CNT30: S IKJEFE03: PERFORM FREEMAIN OF BLOCK */
**/*E01CNT35: D (YES,,NO,E01CNT30:LT) HAVE BLOCKS OF FTAB (ATAB) BEEN
**/*FREED?*/
**/* D (NO,,YES,E01CNT37) ARE ALL ATAB BLOCKS FREED? */
**/* P (,E01CNT27:RT) MAKE ATAB BLOCKS LOOK LIKE FTAB AND RECYCLE TO
**/*FREE*/
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE STARTS TERMINATION PROCESSING              *
*         /*- NORMAL AND ABNORMAL - IF THE TERMINATION IS             *
*         /*BY AN ERROR THEN ALL SP78 CORE GOTTEN BY EXEC IS          *
*         /*FREED. THEN IF THE DATA SET CONTAINING THE                *
*         /*COMMAND PROCEDURE IS OPEN IT IS CLOSED. AFTER THIS        *
*         /*THE CORE OBTAINED FOR FTAB AND ATAB BLOCKS IS FREED.      *
*         /************************************************************
* E01CNT16: CBUFLNG  = CBUFLSAV;              /* RESTORE CMD BFR
*                                                LENGTH               *
E01CNT16 L     @8,E01DATDF+232                                    0215
         L     @8,0(0,@8)          CBUFPTR                        0215
         MVC   0(2,@8),E01DATDF+358                               0215
*          IF  E01SW9 = '0'B & E01SW5 = '0'B  /* IF TERM SW OFF AND   *
*            THEN                             /* WE ARE NOT ABENDING  *
         TM    E01DATDF+203,B'10000000'                           0216
         BC    05,@9EB                                            0216
         TM    E01DATDF+202,B'00001000'                           0216
*              GOTO E01CNT17;                 /* BYPASS FREEING OF
*                                                S.P. 78 CORE         *
         BC    10,E01CNT17                                        0217
*         IF E01SW12  ^= '1'B                 /* IF WE HAVE NO        *
*           THEN                              /*  SUBPOOL 78          *
@9EA     EQU   *                                                  0218
@9EB     TM    E01DATDF+203,B'00010000'                           0218
*             GOTO E01CNT17;                  /*    CORE BYPASS FREEMN*
         BC    12,E01CNT17                                        0219
*         REGSAV(2)  = R1;                    /* SAVE REG1            *
         ST    @1,E01DATDF+208                                    0220
*         R1  = ADDR(E01DATDF);               /* SET REG1 POINTING TO
*                                                PARMS                *
         LA    @1,E01DATDF                                        0221
*         RESTRICT  (R3,R4);
*         R3  = SP78ADDR -> ATABNXT;          /* SET AMT TO BE FREED  *
         L     @2,E01DATDF+156                                    0223
         L     @3,4(0,@2)                                         0223
*         TSTLNG = SP78ADDR;                  /*  SET FREEMAIN ADDRESS*
         MVC   E01DATDF+136(4),E01DATDF+156                       0224
*         IF  SP78ADDR = ADDGMN               /* IF THIS IS THE LAST  *
*           THEN                              /*   ATAB BLOCK INDICATE*
         L     @F,E01DATDF+148                                    0225
         C     @F,E01DATDF+156                                    0225
         BC    07,@9E9                                            0225
*             DO;                             /*  THE ACTUAL LENGTH   *
*               R3 = AMTGMN;                  /*  AND INDICATE LAST   *
         L     @3,E01DATDF+152                                    0227
*               SP78ADDR = KON0;              /*      BY SETTING PTR  *
         LH    @F,KON0                                            0228
         ST    @F,E01DATDF+156                                    0228
         BC    15,@9E8                                            0230
*             END;                            /*   TO ZERO            *
*           ELSE                              /* OTHERWISE - SET PTR  *
*             SP78ADDR = SP78ADDR -> ATABLST; /*   TO NEXT BLOCK      *
@9E9     L     @2,E01DATDF+156                                    0230
         MVC   E01DATDF+156(4),0(@2)                              0230
*         R4  = KON78;                        /* SET SUBPOOL INDICATOR*
@9E8     LH    @4,KON78                                           0231
*         E01SW13 = '1'B;                     /* SET   FREEMAIN SWITCH*
         OI    E01DATDF+203,B'00001000'                           0232
*         CALL  IKJEFE03;                     /* PERFORM FREEMAIN     *
         L     @F,@V3              ADDRESS OF IKJEFE03            0233
         BALR  @E,@F                                              0233
*         R1  = REGSAV(2);                    /* RESTORE REG1         *
         L     @1,E01DATDF+208                                    0234
*         RELEASE  (R3,R4);
*         E01SW13 = '0'B;                     /*RESET  FREEMAIN SWITCH*
         NI    E01DATDF+203,B'11110111'                           0236
*         IF  SP78ADDR ^= KON0                /* IF LAST BLOCK HAS NOT*
*           THEN                              /*   BEEN PROCESSED     *
         LH    @F,KON0                                            0237
         C     @F,E01DATDF+156                                    0237
*             GOTO E01CNT16;                  /*    RECYCLE           *
         BC    07,E01CNT16                                        0238
*         /*                                                    A42620*
*         E01SW12 = '0'B;                     /*ELSE INDICATE FINISHED*
         NI    E01DATDF+203,B'11101111'                           0239
* E01CNT17: IF (DCBOFLGS & KONX10) ^= KONX10  /*IF DATA SET NOT OPENED*
*             THEN                            /* OR ALREADY CLOSED    *
E01CNT17 MVC   @CTEMP2(1),KONSTRUC+1                              0240
         NC    @CTEMP2(1),DCBD+48                                 0240
         CLC   @CTEMP2(1),KONSTRUC+1                              0240
*               GOTO  E01CNT25;               /*  BYPASS THE CLOSE    *
         BC    07,E01CNT25                                        0241
*         RESTRICT (R2);
*         R2 = ADDR(DCBAR);                   /* LOAD ADDRESS OF DCB  *
         LA    @2,E01DATDF                                        0243
*         R1 = ADDR(RCLO);                    /* REG1 = ADDR OF LIST  *
         LA    @1,RCLO                                            0244
*         GEN;
          CLOSE     ((2)),MF=(E,(1))          CLOSE  THE  DATA  SET
          FREEPOOL  (2)            FREE   THE  BUFFER  POOL
         DS    0H
*         RELEASE (R2);
* E01CNT25: IF  ATABIND = KON0                /* IF THERE IS NO ATAB- *
*             THEN                            /*  FTAB BYPASS FREEMAIN*
E01CNT25 LH    @F,KON0                                            0247
         C     @F,E01DATDF+172                                    0247
*               GOTO E01CNT37;                /* GO TO PERFORM STACK  *
         BC    08,E01CNT37                                        0248
* E01CNT27: IF  FTABLST  ^= KON0              /* IF THIS IS NOT FIRST *
*             THEN
E01CNT27 LH    @F,KON0                                            0249
         L     @8,E01DATDF+180                                    0249
         C     @F,0(0,@8)                                         0249
         BC    08,@9E7                                            0249
*               DO;                           /* BLOCK OF FTAB  STEP  *
*                 FTABIND = FTABLST;          /* THROUGH UNTIL FIRST  *
         MVC   E01DATDF+180(4),0(@8)                              0251
*                 GOTO E01CNT27;              /* BLOCK IS REACHED     *
         BC    15,E01CNT27                                        0252
*               END;                          /*                      *
* E01CNT30: FTABCUR = FTABNXT;                /* SAVE PTR TO NEXT BLCK*
@9E7     EQU   *                                                  0254
E01CNT30 L     @8,E01DATDF+180                                    0254
         MVC   E01DATDF+184(4),4(@8)                              0254
*         IF ATABIND = KON0                   /* IF WE ARE FREEING    *
*           THEN                              /* ATAB NOW ALTER LENGTH*
         LH    @F,KON0                                            0255
         C     @F,E01DATDF+172                                    0255
         BC    07,@9E6                                            0255
*             FTABLNG = FTABDLNG;             /* FIELD TO LOOK LIKE
*                                                FTAB LENGTH FIELD    *
         MVC   8(2,@8),10(@8)                                     0256
*         REGSAV(2)  = R1;                    /* SAVE REG1            *
@9E6     ST    @1,E01DATDF+208                                    0257
*         R1  = ADDR(E01DATDF);               /* SET REG1 POINTING TO
*                                                PARMS                *
         LA    @1,E01DATDF                                        0258
*         RESTRICT  (R3,R4);
*         R3  = FTABLNG;                      /* SET AM TO BE FREED   *
         LH    @3,8(0,@8)                                         0260
*         R4  = KON1;                         /* SET SUBPOOL INDICATOR*
         LH    @4,KON1                                            0261
*         TSTLNG  = FTABIND;                  /* ADDR OF BLOCK TO BE
*                                                FREED                *
         MVC   E01DATDF+136(4),E01DATDF+180                       0262
*         E01SW13  ='1'B;                     /* SET FREEMAIN SWITCH  *
         OI    E01DATDF+203,B'00001000'                           0263
*         CALL  IKJEFE03;                     /* PERFORM FREEMAIN     *
         L     @F,@V3              ADDRESS OF IKJEFE03            0264
         BALR  @E,@F                                              0264
*         RELEASE  (R3,R4);
*         R1  = REGSAV(2);                    /* RESTORE REG1         *
         L     @1,E01DATDF+208                                    0266
*         E01SW13  ='0'B;                     /* RESET FREEMAIN SWITCH*
         NI    E01DATDF+203,B'11110111'                           0267
* E01CNT35: IF FTABCUR ^= KON0                /* IF THAT WAS NOT LAST *
*             THEN                            /*  BLOCK               *
E01CNT35 LH    @F,KON0                                            0268
         C     @F,E01DATDF+184                                    0268
         BC    08,@9E5                                            0268
*               DO;                           /*  UPDATE              *
*                 FTABIND = FTABCUR;          /*  POINTERS AND        *
         MVC   E01DATDF+180(4),E01DATDF+184                       0270
*                 GOTO E01CNT30;              /*        DO NEXT       *
         BC    15,E01CNT30                                        0271
*               END;
*         IF ATABIND ^= KON0                  /* IF ATAB HAS NOT YET  *
*           THEN
@9E5     LH    @F,KON0                                            0273
         C     @F,E01DATDF+172                                    0273
         BC    08,@9E4                                            0273
*             DO;                             /* BEEN FREED  MAKE IT  *
*               FTABIND = ATABIND;            /* LOOK LIKE FTAB AND   *
         MVC   E01DATDF+180(4),E01DATDF+172                       0275
*               ATABIND = KON0;               /* LOOP THROUGH         *
         LH    @F,KON0                                            0276
         ST    @F,E01DATDF+172                                    0276
*               GOTO  E01CNT27;               /* AGAIN                *
         BC    15,E01CNT27                                        0277
*             END;                            /*                      *
*
* /********************************************************************
**/*E01CNT37: D (NO,,YES,E01CNT40) IS THIS A TERM OR ABEND? */
**/* D (NO,E01CNT39:RT,YES,) DID DATASET CONTAIN PROCEDURE ? */
**/* D (YES,E01CNT38,NO,) WAS 'LIST' REQUESTED WITH STACK ? */
**/* D (YES,E01STKPR,NO,) WAS 'PROMPT' REQUESTED WITH STACK ? */
**/* M  (,E01CNT39:LT) STACK PROCEDURE */
**/*E01CNT38:  M (,E01CNT39:LT) STACK PROCEDURE WITH LIST OPTION */
**/*E01STKPR:  M  STACK PROCEDURE WITH PROMPT OPTION */
**/*E01CNT39: D (NO,E01CNT40:LT,YES,) WAS STACK SUCCESSFUL? */
**/*%D5:  R RETURN TO CALLER */
**/*E01CNT40: P FLUSH STACK */
**/* P FLUSH THE INPUT QUEUE */
**/* D (YES,,NO,%D5:LT) ARE WE IN AN ABEND? */
**/* P (,%D5:LT) SET RETURN CODE AND TRY STAE RECOVERY*/
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE STACKS THE COMMAND PROCEDURE               *
*         /*IF THE TERMINATION IS NORMAL OR FLUSHES THE               *
*         /*STACK IF THE TERMINATION IS DUE TO AN ERROR.              *
*         /*ALSO IF THERE WAS AN ERROR THE GETLINE INPUT              *
*         /*QUEUE IS FLUSHED. RETURN IS THEN MADE TO THE TMP.         *
*         /************************************************************
* E01CNT37: IF  E01SW5  =  '1'B ×             /* IF THIS  IS AN ABEND *
*            E01SW9   =  '1'B                 /*  OR TERM SW  IS ON   *
*             THEN                            /*  WE MUST FLUSH SO    *
@9E4     EQU   *                                                  0279
E01CNT37 TM    E01DATDF+202,B'00001000'                           0279
         BC    01,@9E3                                            0279
         TM    E01DATDF+203,B'10000000'                           0279
         BC    12,@9E2                                            0279
*               GOTO E01CNT40;                /*  GO TO STACK DELETE  *
         BC    03,E01CNT40                                        0280
*         IF E01SW12 = '0'B                   /* IF THERE WAS NO PROC-*
*           THEN                              /*  EDURE IN THE DATA   *
@9E2     TM    E01DATDF+203,B'00010000'                           0281
         BC    05,@9E1                                            0281
*             DO;                             /*  SET THEN            *
*               TSTLNG = KON0;                /*  DUMMY UP THE RETURN *
         LH    @F,KON0                                            0283
         ST    @F,E01DATDF+136                                    0283
*               GOTO E01CNT39;                /*  CODE AREA AND BYPASS*
         BC    15,E01CNT39                                        0284
*             END;                            /*  STACKING OPERATION  *
*         SRECB  = KON0;                      /* CLEAR ECB            *
@9E1     LH    @F,KON0                                            0286
         ST    @F,E01DATDF+276                                    0286
*         STDLDAP  = SP78ADDR + KON16;        /* SET POINTER TO THE   *
         LH    @F,KON16                                           0287
         A     @F,E01DATDF+156                                    0287
         L     @8,E01DATDF+156                                    0287
         ST    @F,0(0,@8)                                         0287
*         STDLRL  = KON0;                     /*  PROC - SET RECORD
*                                                 TO ZERO TO INDICATE
*                                                 VARIABLE LENGTH     *
         MVC   4(2,@8),KON0                                       0288
*         STDLTL  = SP78LNGT - KON16;         /* SET TOTAL PROC LENGTH*
         L     @F,E01DATDF+160                                    0289
         SH    @F,KON16                                           0289
         STH   @F,6(0,@8)                                         0289
*         STDLNBP = STDLDAP;                  /*SET FIST BYTE AT START
*                                               OF PROC               *
         MVC   8(4,@8),0(@8)                                      0290
*         RESTRICT (R2,R4);
*         R4  = ADDR(RSTCK);                  /* REG2 POINTS TO LIST
*                                                FORM                 *
         LA    @4,RSTCK                                           0292
*         R2  = ADDR(STDL);                   /* PTR TO DESCRIPTOR LST*
         LR    @2,@8                                              0293
*         R1  = PPLPTR;                       /* REG1 POINTS TO SRCT  *
         L     @1,E01DATDF+248                                    0294
*         GEN(MVC   RSTCK,STCKL     PUT LIST INTO GOTTEN CORE);
         MVC   RSTCK,STCKL     PUT LIST INTO GOTTEN CORE
         DS    0H
*         IF  E01SW6 = '1'B                   /* IF PROMPT THEN Y01676*
*           THEN                              /* BYPASS NOPRMPT Y01676*
         TM    E01DATDF+202,B'00000100'                           0296
*             GOTO E01STKPR;                  /* PROCESSING     Y01676*
         BC    01,E01STKPR                                        0297
*         IF  E01SW16 = '1'B                  /* IF LIST THEN   Y01676*
*           THEN                              /* BYPASS LIST    Y01676*
         TM    E01DATDF+203,B'00000001'                           0298
*             GOTO E01CNT38;                  /* PROCESSING     Y01676*
         BC    01,E01CNT38                                        0299
*         GEN(STACK PARM=(R4),STORAGE=((R2),PROCN),MF=(E,(1)));
         STACK PARM=(R4),STORAGE=((R2),PROCN),MF=(E,(1))
         DS    0H
*         TSTLNG  = R15;                      /* SAVE RETURN CODE     *
         ST    @F,E01DATDF+136                                    0301
*         GOTO  E01CNT39;                     /* BYPASS STACK WITH
*                                                LIST OPTION          *
         BC    15,E01CNT39                                        0302
* E01CNT38: ;                                 /* LABEL FOR STACK WITH
*                                                LIST OPTION          *
*         GEN(STACK PARM=(R4),STORAGE=((R2),PROCL),MF=(E,(1)));
E01CNT38 STACK PARM=(R4),STORAGE=((R2),PROCL),MF=(E,(1))
         DS    0H
*         TSTLNG  = R15;                      /* SAVE RETURN CODE     *
         ST    @F,E01DATDF+136                                    0305
*         GOTO  E01CNT39;                     /* BYPASS STACK WITH
*                                                PROMPT OPTION  Y01676*
         BC    15,E01CNT39                                        0306
* E01STKPR: ;                                 /* PROMPT PROCESSING
*                                                               Y01676*
*         IF E01SW16 = '1'B
*           THEN
E01STKPR TM    E01DATDF+203,B'00000001'                           0308
*             GO TO E01STKPL;
         BC    01,E01STKPL                                        0309
*         GEN(STACK PARM=(R4),STORAGE=((R2),PROCN,PROMPT),MF=(E,(1))
         STACK PARM=(R4),STORAGE=((R2),PROCN,PROMPT),MF=(E,(1))
         DS    0H
*         TSTLNG  = R15;                      /* SAVE RET CODE  Y01676*
         ST    @F,E01DATDF+136                                    0311
*         GO TO E01CNT39;
         BC    15,E01CNT39                                        0312
* E01STKPL:  ;
*         GEN(STACK PARM=(R4),STORAGE=((R2),PROCL,PROMPT),MF=(E,(1))
E01STKPL STACK PARM=(R4),STORAGE=((R2),PROCL,PROMPT),MF=(E,(1))
         DS    0H
*         TSTLNG  = R15;                      /* SAVE RET CODE  Y01676*
         ST    @F,E01DATDF+136                                    0315
* E01CNT39: IF  TSTLNG ^= KON0                /* IF STACK WAS         *
*             THEN                            /* NOT SUCCESSFUL      */
E01CNT39 LH    @F,KON0                                            0316
         C     @F,E01DATDF+136                                    0316
         BC    08,@9E0                                            0316
*               DO;                           /*                      *
*                 RETCDAR  = KON20;           /* SET RETURN CODE TO 20*
         LH    @F,KON20                                           0318
         ST    @F,E01DATDF+280                                    0318
*                 CNVC = TSTLNGC(3:4);        /* SAVE RETURN CODE     *
         MVC   E01DATDF+200(2),E01DATDF+138                       0319
*                 LVL1NO = KON24;             /* INDICATE SYSTEM ERROR*
         MVC   E01DATDF+304(2),KON24                              0320
*                 LVL2NO = KON1;              /* MSG FOR 1ST LEVEL AND*
         MVC   E01DATDF+306(2),KON1                               0321
*                 VARSGLNG = KONX00;          /* AND STACK RETURN CODE*
         MVC   E01DATDF+296(1),KONSTRUC                           0322
*                 ADPTR1 = ADDR(E01CNT16);    /* AS 2ND LEVEL -
*                                                E01CNT16 IS RETURN
*                                                POINT AFTER
*                                                MSG            YM2699*
         LA    @F,E01CNT16                                        0323
         ST    @F,E01DATDF+88                                     0323
*                 GOTO  E01MML10;             /* AND GO TO PUT MSG    *
         BC    15,E01MML10                                        0324
*               END;                          /*                      *
*         R15  = KON0;                        /* ELSE RETURN CODE IS 0*
@9E0     LH    @F,KON0                                            0326
*         RETURN;                             /* AND GO TO CALLER     *
         BC    15,@EL01                                           0327
* E01CNT40:  ;                                /* SET OPERATION TO
*                                                  FLUSH STACK        *
*         R2  = ADDR(RSTCK);                  /* PTR TO DESCRIPTOR LST*
E01CNT40 LA    @2,RSTCK                                           0329
*         R1  = PPLPTR;                       /* REG1 POINTS TO SRCT  *
         L     @1,E01DATDF+248                                    0330
*         GEN;
         MVC   RSTCK,STCKL          MOVE LIST FORM OF MACRO
         STACK PARM=(R2),DELETE=ALL,MF=(E,(1))
         DS    0H
*         IF  RETCDAR ^= KON16 & RETCDAR ^= KON20
*           THEN                              /* IF RETURN CODE HAS NOT
         LH    @F,KON16                                           0332
         C     @F,E01DATDF+280                                    0332
         BC    08,@9DF                                            0332
         LH    @F,KON20                                           0332
         C     @F,E01DATDF+280                                    0332
         BC    08,@9DE                                            0332
*             RETCDAR = KON12;                /* BEEN SET  SET IT TO 12
         LH    @F,KON12                                           0333
         ST    @F,E01DATDF+280                                    0333
*         R1  = PPLPTR;                       /* SET POINTER TO PARM
*                                                BLOCK                *
@9DE     EQU   *                                                  0334
@9DF     L     @1,E01DATDF+248                                    0334
*         GEN;
         TCLEARQ INPUT                       FLUSH THE INPUT QUEUE
         DS    0H
*         RELEASE (R2,R4);
*         IF E01SW5 = '1'B                    /* IF WE ARE IN AN ABEND*
*           THEN                              /*  THEN                *
         TM    E01DATDF+202,B'00001000'                           0337
         BC    12,@9DD                                            0337
*             DO;
*               R15  = KON0;                  /* SET STAE RETURN CODE *
         LH    @F,KON0                                            0339
*               R14 = REGSAV(3);              /*SET STAE RETURN ADDRESS
         L     @E,E01DATDF+212                                    0340
*               GEN(BR    R14                 RETURN TO STAE);
         BR    R14                 RETURN TO STAE
         DS    0H
         BC    15,@9DC                                            0343
*             END;
*           ELSE                              /* TO INDICATE NO RETRY *
*             R15 = RETCDAR;                  /* ELSE SET RETURN CODE
*                                                FOR TMP              *
@9DD     L     @F,E01DATDF+280                                    0343
*         RETURN;                             /* AND RETURN           *
         BC    15,@EL01                                           0344
*
* /********************************************************************
**/*E01MML05: P WHEN COMMAND IS > 256 SET LENGTH TO 256 */
**/*E01MML10: S IKJEFE04: LINK TO MESSAGE MODULE */
**/* D (YES,,NO,E01CNT16:RT) WAS MESSAGE PUT OUT? */
**/* D (NO,,YES,E01CNT16:RT) WAS TERMINATION REQUESTED ? */
**/* D (NO,E01CNT05:LT,YES,E01SPD96:RT) IS THERE AN ATAB BLOCK? */
**/*IKJEFE01: END */
* /********************************************************************
*         /************************************************************
*         /*FOLLOWING CODE SETS UP THE PARAMETERS NECESSARY           *
*         /*FOR PUTTING A MESSAGE TO THE TERMINAL THEN                *
*         /*CALLS MODULE IKJEFE04 TO PUT THE MESSAGE                  *
*         /*ON RETURN THE RETURN CODE IS CHECKED TO INSURE            *
*         /*THAT THE MESSAGE WAS PUT OUT SUCCESSFULLY                 *
*         /*THEN EITHER TERMINATION IS STARTED OR RETURN IS           *
*         /*MADE TO THE CALLER DEPENDING ON WHICH OPTION              *
*         /*THE CALLER SPECIFIED.                                     *
*         /************************************************************
* E01MML10: REGSAV(1) = R1;                   /* SAVE REGISTER 1      *
E01MML10 ST    @1,E01DATDF+204                                    0345
*         R1 =  ADDR(E01DATDF);               /* REG1 = ADDR OF PARMS
*                                                SET                  *
         LA    @1,E01DATDF                                        0346
*         E01SW9 = '1'B;                      /*TERMINATE SWITCH ON   *
         OI    E01DATDF+203,B'10000000'                           0347
*         GEN   (LINK  EP=IKJEFE04         LINK TO MSG MODULE);
         LINK  EP=IKJEFE04         LINK TO MSG MODULE
         DS    0H
*         R1 = REGSAV(1);                     /* RESTORE REG1         *
         L     @1,E01DATDF+204                                    0349
*         IF RETCDAR = KON16                  /* IF MSG WAS NOT OUTPUT*
*           THEN                              /*  THEN                *
         LH    @F,KON16                                           0350
         C     @F,E01DATDF+280                                    0350
*             GOTO E01CNT16;                  /* START TERMINATION    *
         BC    08,E01CNT16                                        0351
*         IF ADPTR1 = KON0                    /* IF TERMINATION WAS   *
*           THEN
         LH    @F,KON0                                            0352
         C     @F,E01DATDF+88                                     0352
*             DO;                             /* REQUESTED            *
*               GOTO E01CNT16;                /*     START TERMINATION*
         BC    08,E01CNT16                                        0354
*             END;                            /*                      *
*         GOTO INDAD1;                        /* ELSE RETURN TO CALLER*
@9DB     L     @8,E01DATDF+88                                     0356
         BCR   15,@8                                              0356
*
*         /************************************************************
*         /*FOLLOWING IS THE STAE EXIT ROUTINE. IT SETS               *
*         /*UP ADDRESSABILITY, SETS ON THE ABEND SWITCH AND           *
*         /*GOES TO COMMENCE TERMINATION.                             *
*         /************************************************************
* SHTDWN:    ;
*         GEN;
SHTDWN   EQU   *                                                  0358
         L      R12,0(R1)          PLACE ADDR OF STAE PARM LIST IN R12
         L      R11,8(R12)         RESTORE BASE REG11
         L      R13,4(R12)         RESTORE SAVE REG13
         L      R12,0(R12)         RESTORE BASE REG12
         DS    0H
*         REGSAV(3) = R14;
         ST    @E,E01DATDF+212                                    0359
*         E01SW5  = '1'B;                     /* SET ABEND SW ON */
         OI    E01DATDF+202,B'00001000'                           0360
*         GOTO  E01CNT16;                     /* AND GO TO TERMINATION*
         BC    15,E01CNT16                                        0361
*         /************************************************************
*         /* FOLLOWING IS A PARSE MACRO FOR THE DSNAME                *
*         /************************************************************
*         GEN;
DSNMPARS       IKJPARM   DSECT=PARSPDLA
POSNM1         IKJPOSIT  DSNAME,PROMPT='DATA SET NAME'
               IKJENDP
         DS    0H
*         /************************************************************
*         /* FOLLOWING IS A MODEL DCB                                 *
*         /************************************************************
*         GEN;
DCBPD    DCB   DDNAME=SYSPROC,DEVD=DA,DSORG=PO,MACRF=R,EXLST=DCBEXTS,  C
               KEYLEN=0
         DS    0H
*         /************************************************************
*         /*FOLLOWING ARE LIST FORM OF MACROS USED BY EXEC            *
*         /************************************************************
*         GEN;
SSTCK    EQU   *
STCKL    STACK MF=L                 LIST FORM OF STACK MACRO
ESTCK    EQU   *
SCLO     EQU   *
CLOL     CLOSE (DCBP),MF=L         LIST FORM OF CLOSE MACRO
ECLO     EQU   *
SSTAE    EQU   *
STAEL    STAE  MF=L                LIST FORM OF STAE MACRO
ESTAE    EQU   *
         DS    0H
*         /************************************************************
*         /* FOLLOWING ARE AREAS OF DYNAMIC CORE WHICH ARE USED       *
*         /* TO HOLD PARAMETERS FOR SYSTEM FUNCTIONS                  *
*         /************************************************************
*         GENERATE DATA;
*         END
* /* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.
* /*%INCLUDE SYSLIB  (IKJCPPL )
* /*%INCLUDE SYSLIB  (IKJPPL  )
* /*%INCLUDE SYSLIB  (IKJCSPL )
* /*%INCLUDE SYSLIB  (IKJCSOA )
* ;
@EL01    L     @D,4(0,@D)                                         0366
         LR    @1,@C                                              0366
         L     @0,@SIZ001                                         0366
         FREEMAIN R,LV=(0),A=(1)                                  0366
         L     @E,12(0,@D)                                        0366
         L     @0,20(0,@D)                                        0366
         LM    @2,@C,28(@D)                                       0366
         BCR   15,@E                                              0366
@DATA1   EQU   *
@0       EQU   00                  EQUATES FOR REGISTERS 0-15
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
@D1      DC    H'1'
@MVC     MVC   0(1,@A),0(@E)
@V1      DC    V(DSNMPARS)
@V2      DC    V(IKJEFE05)
@V3      DC    V(IKJEFE03)
@V4      DC    V(IKJEFE02)
         DS    0F
@SIZ001  DC    AL1(&SPN)
         DC    AL3(@DATEND-@DATD)
         DS    0F
         DS    0D
@DATA    EQU   *
DUMPARM  EQU   00000000            FULLWORD INTEGER
R1       EQU   00000001            FULLWORD POINTER REGISTER
R2       EQU   00000002            FULLWORD POINTER REGISTER
R3       EQU   00000003            FULLWORD POINTER REGISTER
R4       EQU   00000004            FULLWORD POINTER REGISTER
R5       EQU   00000005            FULLWORD POINTER REGISTER
R11      EQU   00000011            FULLWORD POINTER REGISTER
R12      EQU   00000012            FULLWORD POINTER REGISTER
R13      EQU   00000013            FULLWORD POINTER REGISTER
R15      EQU   00000015            FULLWORD POINTER REGISTER
R14      EQU   00000014            FULLWORD POINTER REGISTER
KON0     EQU   *                   HALFWORD INTEGER
         DC    FL2'0'
KON1     EQU   *                   HALFWORD INTEGER
         DC    FL2'1'
KON2     EQU   *                   HALFWORD INTEGER
         DC    FL2'2'
KON3     EQU   *                   HALFWORD INTEGER
         DC    FL2'3'
KON4     EQU   *                   HALFWORD INTEGER
         DC    FL2'4'
KON7     EQU   *                   HALFWORD INTEGER
         DC    FL2'7'
KON8     EQU   *                   HALFWORD INTEGER
         DC    FL2'8'
KON9     EQU   *                   HALFWORD INTEGER
         DC    FL2'9'
KON12    EQU   *                   HALFWORD INTEGER
         DC    FL2'12'
KON16    EQU   *                   HALFWORD INTEGER
         DC    FL2'16'
KON20    EQU   *                   HALFWORD INTEGER
         DC    FL2'20'
KON24    EQU   *                   HALFWORD INTEGER
         DC    FL2'24'
KON48    EQU   *                   HALFWORD INTEGER
         DC    FL2'48'
KON78    EQU   *                   HALFWORD INTEGER
         DC    FL2'78'
KON2048  EQU   *                   HALFWORD INTEGER
         DC    FL2'2048'
KONSTRUC EQU   @DATA+00000032      4 BYTE(S) ON WORD
         ORG   KONSTRUC+00000000
KONX00   EQU   *                   1 BYTE(S)
         DC    X'00'
KONX10   EQU   *                   1 BYTE(S)
         DC    X'10'
KONX20   EQU   *                   1 BYTE(S)
         DC    X'20'
KONXFF   EQU   *                   1 BYTE(S)
         DC    X'FF'
KBLNK    EQU   *                   1 BYTE(S)
         DC    C' '
KCOM     EQU   *                   1 BYTE(S)
         DC    C','
KTAB     EQU   *                   1 BYTE(S)
         DC    X'05'
KPERD    EQU   *                   1 BYTE(S)
         DC    C'.'
DCBP     EQU   00000000            88 BYTE(S) ON DWORD
ATAB     EQU   00000000            12 BYTE(S) ON WORD
ATABLST  EQU   ATAB+00000000       FULLWORD POINTER
ATABNXT  EQU   ATAB+00000004       FULLWORD POINTER
ATABLNG  EQU   ATAB+00000008       FULLWORD INTEGER
ATABELMT EQU   00000000            263 BYTE(S) ON WORD
FTABPTR  EQU   ATABELMT+00000000   4 BYTE(S)
FTABPTRB EQU   ATABELMT+00000000   32 BIT(S)
ATABFLGS EQU   ATABELMT+00000004   1 BYTE(S)
ATABELNC EQU   ATABELMT+00000005   2 BYTE(S)
ATABDAT  EQU   ATABELMT+00000007   256 BYTE(S)
FTAB     EQU   00000000            12 BYTE(S) ON WORD
FTABLST  EQU   FTAB+00000000       FULLWORD POINTER
FTABNXT  EQU   FTAB+00000004       FULLWORD POINTER
FTABLNG  EQU   FTAB+00000008       HALFWORD INTEGER
FTABDLNG EQU   FTAB+00000010       HALFWORD INTEGER
FTABELMT EQU   00000000            260 BYTE(S) ON WORD
FTABELNG EQU   FTABELMT+00000000   4 BYTE(S)
FTABDAT  EQU   FTABELMT+00000004   256 BYTE(S)
STDL     EQU   00000000            12 BYTE(S) ON WORD
STDLDAP  EQU   STDL+00000000       FULLWORD POINTER
STDLRL   EQU   STDL+00000004       HALFWORD INTEGER
STDLTL   EQU   STDL+00000006       HALFWORD INTEGER
STDLNBP  EQU   STDL+00000008       FULLWORD POINTER
DCBEXTS  EQU   @DATA+00000040      4 BYTE(S) ON WORD
A00010   EQU   *                   1 BYTE(S)
         DC    X'85'
A00011   EQU   *                   3  BYTE  POINTER ON WORD+1
         DC    VL3(E05OPEX)
CPPL     EQU   00000000            16 BYTE(S) ON WORD
CPPLCBUF EQU   CPPL+00000000       FULLWORD POINTER
CPPLUPT  EQU   CPPL+00000004       FULLWORD POINTER
CPPLPSCB EQU   CPPL+00000008       FULLWORD POINTER
CPPLECT  EQU   CPPL+00000012       FULLWORD POINTER
CBUFPTR  EQU   00000000            FULLWORD POINTER
CBUF     EQU   00000000            5 BYTE(S) ON WORD
CBUFLNG  EQU   CBUF+00000000       HALFWORD POINTER
CBUFOFF  EQU   CBUF+00000002       HALFWORD POINTER
CBUFDATA EQU   CBUF+00000004       1 BYTE(S)
PPL      EQU   00000000            28 BYTE(S) ON WORD
PPLUPT   EQU   PPL+00000000        FULLWORD POINTER
PPLECT   EQU   PPL+00000004        FULLWORD POINTER
PPLECB   EQU   PPL+00000008        FULLWORD POINTER
PPLPCL   EQU   PPL+00000012        FULLWORD POINTER
PPLANS   EQU   PPL+00000016        FULLWORD POINTER
PPLCBUF  EQU   PPL+00000020        FULLWORD POINTER
PPLUWA   EQU   PPL+00000024        FULLWORD POINTER
CSPL     EQU   00000000            24 BYTE(S) ON WORD
CSPLUPT  EQU   CSPL+00000000       FULLWORD POINTER
CSPLECT  EQU   CSPL+00000004       FULLWORD POINTER
CSPLECB  EQU   CSPL+00000008       FULLWORD POINTER
CSPLFLG  EQU   CSPL+00000012       FULLWORD POINTER
CSPLOA   EQU   CSPL+00000016       FULLWORD POINTER
CSPLCBUF EQU   CSPL+00000020       FULLWORD POINTER
CSOAPTR  EQU   00000016            FULLWORD POINTER
CSOA     EQU   00000000            8 BYTE(S) ON WORD
CSOACNM  EQU   CSOA+00000000       FULLWORD POINTER
CSOALNM  EQU   CSOA+00000004       HALFWORD INTEGER
CSOAFLG  EQU   CSOA+00000006       1 BYTE(S)
CSOAVWP  EQU   CSOA+00000006       1 BIT(S)
CSOAVNP  EQU   CSOA+00000006       1 BIT(S)
CSOAQM   EQU   CSOA+00000006       1 BIT(S)
CSOANOC  EQU   CSOA+00000006       1 BIT(S)
CSOABAD  EQU   CSOA+00000006       1 BIT(S)
A00012   EQU   CSOA+00000006       1 BIT(S)
A00013   EQU   CSOA+00000006       1 BIT(S)
A00014   EQU   CSOA+00000006       1 BIT(S)
A00015   EQU   CSOA+00000007       1 BYTE(S)
DSNPDL   EQU   00000000            8 BYTE(S) ON WORD
PTRDSN   EQU   DSNPDL+00000000     FULLWORD POINTER
DSNLNG   EQU   DSNPDL+00000004     HALFWORD INTEGER
DSNFLG   EQU   DSNPDL+00000006     1 BYTE(S)
DSNNUL   EQU   DSNPDL+00000006     1 BIT(S)
DSNQTE   EQU   DSNPDL+00000006     1 BIT(S)
A00016   EQU   DSNPDL+00000006     6 BIT(S)
A00017   EQU   DSNPDL+00000007     1 BYTE(S)
PDLDNAM  EQU   00000000            44 BYTE(S)
IMPMEM   EQU   00000000            8 BYTE(S) ON WORD
         ORG   @DATA
         DS    00000044C
@L       EQU   2
@DATD    DSECT
@SAV001  EQU   @DATD+00000000      72 BYTE(S) ON WORD
TEM01    EQU   @DATD+00000072      FULLWORD INTEGER
TEM02    EQU   @DATD+00000076      FULLWORD INTEGER
TEM03    EQU   @DATD+00000080      FULLWORD INTEGER
E01DATDF EQU   @DATD+00000088      362 BYTE(S) ON DWORD
DCBAR    EQU   E01DATDF+00000000   88 BYTE(S) ON DWORD
ADPTR1   EQU   E01DATDF+00000088   FULLWORD POINTER
ADPTR2   EQU   E01DATDF+00000092   FULLWORD POINTER
MMNAMAR  EQU   E01DATDF+00000096   8 BYTE(S) ON WORD
RDECB    EQU   E01DATDF+00000104   20 BYTE(S) ON WORD
A00000   EQU   E01DATDF+00000104   6 BYTE(S)
DECLNGTH EQU   E01DATDF+00000110   HALFWORD INTEGER
A00001   EQU   E01DATDF+00000112   8 BYTE(S)
DECIOBPT EQU   E01DATDF+00000120   FULLWORD POINTER
LINPTR1  EQU   E01DATDF+00000124   FULLWORD POINTER
EOLCNT   EQU   E01DATDF+00000128   FULLWORD INTEGER
POSCNT   EQU   E01DATDF+00000132   FULLWORD INTEGER
TSTLNG   EQU   E01DATDF+00000136   FULLWORD INTEGER
TSTLNGC  EQU   E01DATDF+00000136   4 BYTE(S)
GMNMIN   EQU   E01DATDF+00000140   FULLWORD INTEGER
GMNMAX   EQU   E01DATDF+00000144   FULLWORD INTEGER
ADDGMN   EQU   E01DATDF+00000148   FULLWORD POINTER
AMTGMN   EQU   E01DATDF+00000152   FULLWORD INTEGER
SP78ADDR EQU   E01DATDF+00000156   FULLWORD POINTER
SP78LNGT EQU   E01DATDF+00000160   FULLWORD POINTER
RDXCNV   EQU   E01DATDF+00000164   FULLWORD INTEGER
A00002   EQU   E01DATDF+00000164   3 BYTE(S)
DDIG     EQU   E01DATDF+00000167   1 BYTE(S)
POSSPC   EQU   E01DATDF+00000168   FULLWORD INTEGER
ATABIND  EQU   E01DATDF+00000172   FULLWORD POINTER
ATABCUR  EQU   E01DATDF+00000176   FULLWORD POINTER
FTABIND  EQU   E01DATDF+00000180   FULLWORD POINTER
FTABCUR  EQU   E01DATDF+00000184   FULLWORD POINTER
VALCNT   EQU   E01DATDF+00000188   FULLWORD INTEGER
KWOCNT   EQU   E01DATDF+00000192   HALFWORD INTEGER
KWWCNT   EQU   E01DATDF+00000194   HALFWORD INTEGER
KWOBYT   EQU   E01DATDF+00000196   HALFWORD INTEGER
KWWBYT   EQU   E01DATDF+00000198   HALFWORD INTEGER
CNVA     EQU   E01DATDF+00000200   HALFWORD INTEGER
CNVC     EQU   E01DATDF+00000200   2 BYTE(S)
E01BINSW EQU   E01DATDF+00000202   2 BYTE(S) ON HWORD
E01SW1   EQU   E01DATDF+00000202   1 BIT(S)
E01SW2   EQU   E01DATDF+00000202   1 BIT(S)
E01SW3   EQU   E01DATDF+00000202   1 BIT(S)
E01SW4   EQU   E01DATDF+00000202   1 BIT(S)
E01SW5   EQU   E01DATDF+00000202   1 BIT(S)
E01SW6   EQU   E01DATDF+00000202   1 BIT(S)
E01SW7   EQU   E01DATDF+00000202   1 BIT(S)
E01SW8   EQU   E01DATDF+00000202   1 BIT(S)
E01SW9   EQU   E01DATDF+00000203   1 BIT(S)
E01SW10  EQU   E01DATDF+00000203   1 BIT(S)
E01SW11  EQU   E01DATDF+00000203   1 BIT(S)
E01SW12  EQU   E01DATDF+00000203   1 BIT(S)
E01SW13  EQU   E01DATDF+00000203   1 BIT(S)
E01SW14  EQU   E01DATDF+00000203   1 BIT(S)
E01SW15  EQU   E01DATDF+00000203   1 BIT(S)
E01SW16  EQU   E01DATDF+00000203   1 BIT(S)
REGSAV   EQU   E01DATDF+00000204   3*FULLWORD INTEGER
LATAB    EQU   E01DATDF+00000216   FULLWORD POINTER
LFTAB    EQU   E01DATDF+00000220   FULLWORD POINTER
BFAPTR   EQU   E01DATDF+00000224   FULLWORD INTEGER
BFBPTR   EQU   E01DATDF+00000228   FULLWORD POINTER
CPPLPTR  EQU   E01DATDF+00000232   FULLWORD POINTER
STPRM    EQU   E01DATDF+00000236   3*FULLWORD INTEGER
PPLPTR   EQU   E01DATDF+00000248   FULLWORD POINTER
CBCOR    EQU   E01DATDF+00000252   24 BYTE(S)
SRECB    EQU   E01DATDF+00000276   FULLWORD INTEGER
RETCDAR  EQU   E01DATDF+00000280   FULLWORD INTEGER
ABLK1    EQU   E01DATDF+00000284   FULLWORD POINTER
EOB      EQU   E01DATDF+00000288   FULLWORD POINTER
RCDST    EQU   E01DATDF+00000292   FULLWORD POINTER
VARSGLNG EQU   E01DATDF+00000296   1 BYTE(S)
VARSGADR EQU   E01DATDF+00000297   3  BYTE  POINTER ON WORD+1
VARSGLN2 EQU   E01DATDF+00000300   1 BYTE(S)
VARSGAD2 EQU   E01DATDF+00000301   3  BYTE  POINTER ON WORD+1
LVL1NO   EQU   E01DATDF+00000304   HALFWORD INTEGER
LVL2NO   EQU   E01DATDF+00000306   HALFWORD INTEGER
PDLPTR   EQU   E01DATDF+00000308   FULLWORD POINTER
DRDNPTR  EQU   E01DATDF+00000312   46 BYTE(S) ON WORD
DSNARLNG EQU   E01DATDF+00000312   HALFWORD INTEGER
DSNARLCH EQU   E01DATDF+00000312   2 BYTE(S)
DSNAMAR  EQU   E01DATDF+00000314   44 BYTE(S)
CBUFLSAV EQU   E01DATDF+00000358   HALFWORD INTEGER
CBUFLSAC EQU   E01DATDF+00000358   2 BYTE(S)
POSBYT   EQU   E01DATDF+00000360   HALFWORD INTEGER
DCBD     EQU   @DATD+00000088      88 BYTE(S) ON DWORD
A00003   EQU   DCBD+00000000       26 BYTE(S)
DCBDSORG EQU   DCBD+00000026       2 BYTE(S)
A00004   EQU   DCBD+00000028       5 BYTE(S)
DCBEODAD EQU   DCBD+00000033       3  BYTE  POINTER ON WORD+1
DCBRECFM EQU   DCBD+00000036       1 BYTE(S)
DCBRCFF  EQU   DCBD+00000036       1 BIT(S)
DCBRCFV  EQU   DCBD+00000036       1 BIT(S)
DCBEXLST EQU   DCBD+00000037       3  BYTE  POINTER ON WORD+1
DCBDDNAM EQU   DCBD+00000040       8 BYTE(S)
DCBOFLGS EQU   DCBD+00000048       1 BYTE(S)
A00005   EQU   DCBD+00000049       1 BYTE(S)
DCBMACR  EQU   DCBD+00000050       2 BYTE(S)
A00006   EQU   DCBD+00000052       5 BYTE(S)
DCBSYNAD EQU   DCBD+00000057       3  BYTE  POINTER ON WORD+1
A00007   EQU   DCBD+00000060       2 BYTE(S)
DCBBLKSI EQU   DCBD+00000062       HALFWORD INTEGER
A00008   EQU   DCBD+00000064       18 BYTE(S)
DCBLRECL EQU   DCBD+00000082       HALFWORD INTEGER
A00009   EQU   DCBD+00000084       4 BYTE(S)
CLARE    EQU   @DATD+00000252      352 BIT(S) ON BYTE
CSPLPTR  EQU   @DATD+00000336      FULLWORD POINTER
         DS    00000450C
@TEMPS   DS    0F
@TEMP2   DC    F'0'
@CTEMP2  DS    CL001
         CNOP   0,4
RSTCK    DS    CL(ESTCK-SSTCK)     AREA FOR STACK MACRO
          CNOP  0,4
RCLO      DS    CL(ECLO-SCLO)      AREA FOR CLOSE MACRO
          CNOP  0,4
RSTAE    DS    CL(ESTAE-SSTAE)     AREA FOR STAE MACRO
@DATD    DSECT
@DATEND  EQU   *
IKJEFE01 CSECT ,
@9FA     EQU   E01SCN03
@9F9     EQU   E01SCN03
@9F1     EQU   E01MML10
@9F0     EQU   E01CNT16
@9EE     EQU   E01CNT15
@9E3     EQU   E01CNT40
@9DC     EQU   @EL01
         END

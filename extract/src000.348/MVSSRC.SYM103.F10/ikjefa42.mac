         TITLE 'IKJEFA42  --  LIST FORMATTING ROUTINE                  *
                        '
IKJEFA42 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFA42  78.174'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*         CTABPTR = R1;               /* SET BASE PTR FOR THE LIST 0042
*                                        CONTROL TABLE               */
         LR    CTABPTR,R1                                          0042
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REGISTER  */
*         /* ASSIGN GENERATED PARAMETER BLOCKS TO DYNAMIC STORAGE    */
*         CPLS(1:MCPLNG) = MCPLS(1:MCPLNG);                        0044
         L     @07,MCPLNG                                          0044
         BCTR  @07,0                                               0044
         EX    @07,@SM00496                                        0044
*         /* BUILD THE PARAMETER LIST FOR 'PUTLINE'                  */
*         IOPLPTR = ADDR(PLPLIST);    /* POINT TO PUTLILE PB         */
         LA    IOPLPTR,PLPLIST                                     0045
*         PLPLIST(1:12) = ACCTPL(1:12);/* ADDR OF THE UPT, ECT & ECB */
         L     @07,ACCTPLP(,CTABPTR)                               0046
         MVC   PLPLIST(12),ACCTPL(@07)                             0046
*         IOPLIOPB = ADDR(PBLOK);     /* ADDR OF THE PARM BLOCK    0047
*                                        THE PUTLINE SERVICE RTNE    */
         LA    @07,PBLOK                                           0047
         ST    @07,IOPLIOPB(,IOPLPTR)                              0047
*         OUTAPTR = ADDR(OUTPAREA);   /* SET PTR TO START OF OUTPUT
*                                        LINE                        */
         LA    OUTAPTR,OUTPAREA                                    0048
*         /* TRANSFER PTRS FROM CONTROL TABLE TO NEW VARIABLES.      */
*         ACIOPTR = RWPLADR;          /* SET BASE PTR FOR R/D PLIST  */
         L     @07,RWPLADR(,CTABPTR)                               0049
         ST    @07,ACIOPTR                                         0049
*         /* SET INITIAL VALUES.                                     */
*         OPASIZE = 1000;             /* STARTING-SIZE OF THE OPAREA */
         LA    OPASIZE,1000                                        0050
*         INDIC = '0'B;               /* INITIALIZE CONTROL FLAGS    */
         MVI   INDIC+1,X'00'                                       0051
         MVI   INDIC,B'00000000'                                   0051
*         LEVL = 0;                   /* SET LEVEL TO 0: THIS IS THE
*                                        FIRST USERID TO BE PROCESSED
*                                        FOR THIS COMMAND            */
         SLR   LEVL,LEVL                                           0052
*         MSGNO = 0;                  /* INDICATE NORMAL COMPLETION  */
         SLR   MSGNO,MSGNO                                         0053
*         /* GENERATE LABELS FOR THE DCB BLOCK                       */
*         RFY R2 RSTD;                                             0054
*         GEN (USING IHADCB,R2)                                    0055
*           REFS(R2);                                              0055
         USING IHADCB,R2
*         /* PREPARE TO OPEN THE BPAM DCB.                           */
*         R2 = ADDR(UADBLOC);         /* SET BASE PTR FOR LABLES     */
         LA    R2,UADBLOC                                          0056
*         GEN (OPEN  ((R2),),MF=(E,OPENBLK))                       0057
*           REFS(R2,OPENBLK);                                      0057
         OPEN  ((R2),),MF=(E,OPENBLK)
*         /* IF OPEN WAS NOT SUCCESSFUL, SET THE ERROR MSG NUMBER    */
*         /* AND RETURN TO IKJEFA40.                                 */
*         IF DCBOFLAG = '0'B          /* WAS 'OPEN' SUCCESSFUL?      */
*           THEN                      /* NO,                         */
         TM    DCBOFLAG,B'00010000'                                0058
         BNZ   @RF00058                                            0058
*             DO;                                                  0059
*               MSGNO = 8;            /* SET MSG NUMBER              */
         LA    MSGNO,8                                             0060
*               GOTO CLEANUP;         /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0061
*             END;                                                 0062
*         ACIODCBA = R2;              /* POINT TO BPAM DCB IN ACIOPAR*/
@RF00058 L     @09,ACIOPTR                                         0063
         STCM  R2,7,ACIODCBA(@09)                                  0063
*         RFY R2 UNRSTD;                                           0064
*         /***********************************************************/
*         /* DOES THE COMMAND NODELIST SPECIFY A USERID OR AN        */
*         /* ASTERISK? IF USERID, GET THE SPECIFIED USERID TREE BY   */
*         /* CALLING THE 'READ' ROUTINE (IKJEFA51). IF ASTERISK THE  */
*         /* READ RTNE WILL PROCESS THE DIRECTORY AND READ ONE USERID *
*         /* TREE AT A TIME INTO A TREE BUFFER.                      */
*         /***********************************************************/
*         IF USRID(1) ^= '*'          /* IS A USERID SPECIFIED IN  0065
*                                        THE NODELIST?               */
*           THEN                      /* YES                         */
         L     @07,NODELADR(,CTABPTR)                              0065
         CLI   USRID(@07),C'*'                                     0065
         BE    @RF00065                                            0065
*             DO;                                                  0066
*             USIND = '0'B;           /* SET INDICATOR TO 0: NO MORE
*                                        USERIDS TO BE PROCESSED     */
         NI    USIND,B'01111111'                                   0067
*             ACIOMPTR = ADDR(USRID); /* SET PTR TO THE USERID       */
         LA    @15,USRID(,@07)                                     0068
         ST    @15,ACIOMPTR(,@09)                                  0068
*             USRID(USRLEN+1) = '0';  /* SET INDEX LEVEL             */
         SLR   @09,@09                                             0069
         IC    @09,USRLEN(,@07)                                    0069
         ALR   @07,@09                                             0069
         MVI   USRID(@07),C'0'                                     0069
*             GOTO READ;              /* GET THE SPECIFIED USERID  0070
*                                        TREE FROM THE UADS          */
         B     READ                                                0070
*             END;                                                 0071
*         /* THE NODELIST USERID = '*', THEN ACIOMPTR IN THE PARMLIST*/
*         /* POINTS TO A MEMBER NAME IN THE DIRECTORY WORK AREA.     */
*         ACIOMPTR = 0;               /* SET MEMBER NAME PTR TO 0    */
@RF00065 L     @09,ACIOPTR                                         0072
         SLR   @07,@07                                             0072
         ST    @07,ACIOMPTR(,@09)                                  0072
*         USIND = '1'B;               /* MORE USERS TO BE PROCESSED  */
         OI    USIND,B'10000000'                                   0073
*         ACIOFL03 = '1'B;            /* DIRECTORY READ REQUESTED    */
         OI    ACIOFL03(@09),B'00100000'                           0074
*         GOTO READ;                  /* READ THE DIRECTORY & FIRST
*                                        USERID                      */
         B     READ                                                0075
*MORUS:   /* BEFORE REQUESTING A USERID TREE, CHECK WHETHER THE      */
*         /* BUFFER FOR A PREVIOUSLY USED TREE HAS TO BE FREED.      */
*         IF FREEFLG = '1'B                                        0076
*           THEN                      /* YES, BUFFER MUST BE FREED   */
MORUS    TM    FREEFLG,B'00000100'                                 0076
         BNO   @RF00076                                            0076
*             DO;                                                  0077
*               RFY R1 RSTD;          /* RESTRICT PARAMETER REG      */
*               R1 = ADDR(ACIOPARM);  /* PTR TO READ/WRITE PARMLIST  */
         L     R1,ACIOPTR                                          0079
*               /* PASS CONTROL TO THE WRITE RTNE TO DO THE FREEMAIN */
*               CALL IKJEFA52;                                     0080
         L     @15,@CV00143                                        0080
         BALR  @14,@15                                             0080
*               RFY R1 UNRSTD;        /* RELEASE PARAMETER REG       */
*               FREEFLG = '0'B;       /* SET FLAG TO 0- BUFFER FREED */
         NI    FREEFLG,B'11111011'                                 0082
*             END;                                                 0083
*         /* CHECK FOR MORE USERIDS TO BE PROCESSED.                 */
*         IF USIND = '0'B                                          0084
*           THEN                      /* ARE THERE MORE USERIDS?     */
@RF00076 TM    USIND,B'10000000'                                   0084
         BZ    @RT00084                                            0084
*             GOTO DATACHK;           /* NO                          */
*         IF OPASIZE < 12             /* ENOUGH SPACE?               */
*           THEN                      /* NO,                         */
         C     OPASIZE,@CF00236                                    0086
         BNL   @RF00086                                            0086
*             CALL PUTDATA;           /* GO TO PUT OUT THE LAST DATA */
         BAL   @14,PUTDATA                                         0087
*         IF NEXTUSER = '1'B          /* NEW USER PROCESSING @ZA26793*/
*           THEN                      /* IF YES                      */
@RF00086 TM    NEXTUSER,B'00100000'                                0088
         BNO   @RF00088                                            0088
*             DO;                     /* WRITE BLANK LINE SEPERATOR  */
*             NEXTUSER = '0'B;        /* RESET FLG           @ZA26793*/
         NI    NEXTUSER,B'11011111'                                0090
*             USIDDATA(9) = ' ';      /* BLANK OUT FIRST CHARACTER   */
         MVI   USIDDATA+8(OUTAPTR),C' '                            0091
*             NEXTLN1 = OUTAPTR+12;   /* PTR TO THE NEXT OUTPUT LINE */
         LA    @09,12                                              0092
         LR    @07,OUTAPTR                                         0092
         ALR   @07,@09                                             0092
         ST    @07,NEXTLN1(,OUTAPTR)                               0092
*             USLNL1 = 5;             /* LENGTH OF THIS LINE         */
         MVC   USLNL1(2,OUTAPTR),@CH00174                          0093
*             USBYTE1 = 0;            /* REQUIRED BY 'PUTLINE'       */
         SLR   @07,@07                                             0094
         STH   @07,USBYTE1(,OUTAPTR)                               0094
*             OPASIZE = OPASIZE-12;   /* SUBTRACT THE SPACE USED     */
         SLR   OPASIZE,@09                                         0095
*             OUTAPTR = OUTAPTR+12;   /* INCREMENT THE ADDRESS OF THE*/
         ALR   OUTAPTR,@09                                         0096
*             END;                    /* OUTPUT BUFFER               */
*READ:    /* CHECK WHETHER THE ECB WAS POSTED (ATTENTION INTERRUPT)  */
*         IF ATTENTN = '1'B                                        0098
*           THEN                      /* YES,                        */
@RF00088 DS    0H                                                  0098
READ     L     @09,ACCTPLP(,CTABPTR)                               0098
         L     @09,ACCTECBP(,@09)                                  0098
         TM    ATTENTN(@09),B'01000000'                            0098
         BO    @RT00098                                            0098
*             GOTO CLEANUP;           /* GO CLEAN UP & RETURN        */
*         /* PREPARE TO CALL THE READ ROUTINE                        */
*         RFY R1 RSTD;                /* RESTRICT PARAMETER REG      */
*         R1 = ADDR(ACIOPARM);        /* 'READ' EXPECTS THE ADDRESS
*                                        OF THE PARMLIST IN REG1     */
         L     R1,ACIOPTR                                          0101
*         CALL  IKJEFA51;                                          0102
         L     @15,@CV00142                                        0102
         BALR  @14,@15                                             0102
*         RFY R1 UNRSTD;              /* RELEASE PARAMETER REG       */
*         RFY R15 RSTD;               /* RESTRICT RETURN CODE REG    */
*         RTNCODE = R15;              /* ASSIGN THE RETURN CODE      */
         LR    RTNCODE,R15                                         0105
*         RFY R15 UNRSTD;             /* RELEASE RETURN CODE REG     */
*         IF USIND = '1'B &           /* IF USERID IS '*' AND        */
*           ACIOLINK ^= 0             /*   ACIOLINK HAS BEEN SET     */
*           THEN                                                   0107
         TM    USIND,B'10000000'                                   0107
         BNO   @RF00107                                            0107
         L     @09,ACIOPTR                                         0107
         L     @09,ACIOLINK(,@09)                                  0107
         LTR   @09,@09                                             0107
         BZ    @RF00107                                            0107
*             DO;                                                  0108
*             USRID = MEMNAME;        /* GET NAME FROM BLDL LIST     */
         L     @07,NODELADR(,CTABPTR)                              0109
         MVC   USRID(8,@07),MEMNAME(@09)                           0109
*             USRLEN = 8;             /* GET MAXIMUM LENGTH OF USERID*/
         MVI   USRLEN(@07),X'08'                                   0110
*             DO WHILE USRID(USRLEN) = ' '; /* IS CHAR A BLANK       */
         B     @DE00111                                            0111
@DL00111 DS    0H                                                  0112
*               USRLEN = USRLEN-1;    /* DECREMENT USERID LENGTH     */
         L     @09,NODELADR(,CTABPTR)                              0112
         SLR   @07,@07                                             0112
         IC    @07,USRLEN(,@09)                                    0112
         BCTR  @07,0                                               0112
         STC   @07,USRLEN(,@09)                                    0112
*               END;                                               0113
@DE00111 L     @09,NODELADR(,CTABPTR)                              0113
         SLR   @07,@07                                             0113
         IC    @07,USRLEN(,@09)                                    0113
         ST    @07,@TF00001                                        0113
         ALR   @07,@09                                             0113
         CLI   USRID-1(@07),C' '                                   0113
         BE    @DL00111                                            0113
*             USRLEN = USRLEN-1;      /* DECREMENT FOR SEQ. CHAR     */
         L     @07,@TF00001                                        0114
         BCTR  @07,0                                               0114
         STC   @07,USRLEN(,@09)                                    0114
*             END;                                                 0115
*         /* CHECK THE READ RETURN CODE.                             */
*         IF RTNCODE = 0              /* WAS READ SUCCESSFUL?        */
*           THEN                      /* YES,                        */
@RF00107 LTR   RTNCODE,RTNCODE                                     0116
         BZ    @RT00116                                            0116
*             GOTO READOK;            /* CONTINUE                    */
*         IF RTNCODE = 4              /* SPECIFIED USERID NOT FOUND? */
*          & USIND = '0'B             /* AND USERID WAS SPECIFIED    */
*           THEN                      /* YES,                        */
         LA    @09,4                                               0118
         CR    RTNCODE,@09                                         0118
         BNE   @RF00118                                            0118
         TM    USIND,B'10000000'                                   0118
         BNZ   @RF00118                                            0118
*             DO;                                                  0119
*               MSGNO = 4;            /* SET MSG NUMBER              */
         LR    MSGNO,@09                                           0120
*               GOTO CLEANUP;         /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0121
*             END;                                                 0122
*         IF RTNCODE = 8              /* BLDL I/O ERROR?             */
*           THEN                      /* YES,                        */
@RF00118 C     RTNCODE,@CF00040                                    0123
         BNE   @RF00123                                            0123
*             DO;                                                  0124
*               MSGNO = 9;            /* SET MSG NUMBER              */
         LA    MSGNO,9                                             0125
*               GOTO CLEANUP;         /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0126
*             END;                                                 0127
*         IF RTNCODE = 12             /* NOT ENOUGH MAIN STORAGE?    */
*           THEN                      /* YES,                        */
@RF00123 C     RTNCODE,@CF00236                                    0128
         BNE   @RF00128                                            0128
*             DO;                                                  0129
*             /* IF NODELIST USERID IS ASTERISK, THEN ISSUE THE MSG  */
*             /* FOR THIS USERID & CONTINUE PROCESSING. OTHERWISE,   */
*             /* SET THE ERROR MSG NUMBER & RETURN.                  */
*             IF USIND = '1'B         /* WAS USERID '*'?             */
*              & ACIOLINK ^= 0        /* AND BLDL IS VALID           */
*               THEN                  /* YES,                        */
         TM    USIND,B'10000000'                                   0130
         BNO   @RF00130                                            0130
         L     @07,ACIOPTR                                         0130
         L     @07,ACIOLINK(,@07)                                  0130
         LTR   @07,@07                                             0130
         BNZ   @RT00130                                            0130
*                 GOTO MPREP;         /* GO CONSTRUCT THE MSG        */
*               ELSE                  /* NO,                         */
*                 MSGNO = 2;          /* SET THE ERROR MSG NUMBER    */
@RF00130 LA    MSGNO,2                                             0132
*             GOTO CLEANUP;           /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0133
*             END;                                                 0134
*         IF RTNCODE = 24             /* END OF THE DIRECTORY?       */
*           THEN                      /* YES,                        */
@RF00128 C     RTNCODE,@CF00077                                    0135
         BE    @RT00135                                            0135
*             GOTO DATACHK;           /* PUT OUT ANY REMAINING DATA  */
*         IF RTNCODE = 20             /* I/O ERROR WITH MSG          */
*           THEN                      /* YES,                        */
         LA    @04,20                                              0137
         CR    RTNCODE,@04                                         0137
         BNE   @RF00137                                            0137
*             MSGNO = 20;             /* SET ERROR MSG NUMBER        */
         LR    MSGNO,@04                                           0138
*           ELSE                      /* NO, THEREFORE I/O ERROR     */
*             MSGNO = 14;             /* SET ERROR MSG NUMBER        */
         B     @RC00137                                            0139
@RF00137 LA    MSGNO,14                                            0139
*         GOTO CLEANUP;               /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0140
*READOK:  /* A USERID TREE IS NOW IN WORKING STORAGE.                */
*         NOPWDFLG = '0'B;            /* INITIALIZE PWD SUPPORT FLG  */
READOK   DS    0H                                                  0142
*         NOACTFLG = '0'B;            /* INIT ACCTNMBR SUPPORT FLAG  */
*         FREEFLG = '1'B;             /* TREE BUFFER MUST BE FREED   */
         OI    FREEFLG,B'00000100'                                 0143
         NI    NOPWDFLG,B'11111100'                                0143
*         HEDBPTR = ACIOBUFR;         /* ADDR OF THE BUFFER INTO WHICH
*                                        THE USERID TREE WAS READ    */
         L     @07,ACIOPTR                                         0144
         L     HEDBPTR,ACIOBUFR-1(,@07)                            0144
         LA    HEDBPTR,0(,HEDBPTR)                                 0144
*         UPTPTR = HEDBPTR+UADSUPTP;  /* REFERENCE THE CURRENT UPT   */
         LR    @07,HEDBPTR                                         0145
         AL    @07,UADSUPTP(,HEDBPTR)                              0145
         ST    @07,UPTPTR                                          0145
*         DPOBPTR = HEDBPTR+UADSPWD1; /* REF 1ST PWORD OFFSET BLOCK  */
         LR    DPOBPTR,HEDBPTR                                     0146
         AL    DPOBPTR,UADSPWD1(,HEDBPTR)                          0146
*         LEVL = 1;                   /* FORMATTING WILL START AT THE
*                                        USERID LEVEL                */
         LA    LEVL,1                                              0147
*         /* DOES THE LIST NODELIST SPECIFY A PASSWORD OR AN         */
*         /* ASTERISK? IF ASTERISK, REFERENCE THE FIRST PASSWORD IN  */
*         /* THE LATERAL CHAIN. IF PASSWORD, GO TO THE PASSWORD      */
*         /* SEARCH LOOP.                                            */
*         IF PASSWD(1) ^= '*'         /* IS A PASSWORD SPECIFIED IN
*                                        THE NODELIST?               */
*           THEN                      /* YES                         */
         L     @07,NODELADR(,CTABPTR)                              0148
         CLI   PASSWD(@07),C'*'                                    0148
         BE    @RF00148                                            0148
*             /* IF PASSWORDS ARE NOT SUPPORTED, THEN THE COMMAND    */
*             /* IS INVALID FOR THIS USERID.                         */
*             IF UADSPDAT = 0                                      0149
*               THEN                  /* CMMD INVALID FOR THIS USER  */
         L     @07,UADSPDAT(,DPOBPTR)                              0149
         LTR   @07,@07                                             0149
         BZ    @RT00149                                            0149
*                 GOTO MORUS;         /* CHECK FOR MORE USERS        */
*               ELSE                  /* PASSWDS ARE SUPPORTED       */
*                 GOTO PWSRCH;        /* SEARCH THE LATERAL CHAIN FOR
*                                        THIS PASSWORD               */
         B     PWSRCH                                              0151
*         /* AN ASTERISK WAS SPECIFIED IN THE PASSWORD POSITION.     */
*         /* IF THE PASSWORD LEVEL IS NOT SUPPORTED, THE OFFSET TO   */
*         /* THE FIRST DATA FIELD WILL BE ZERO.                      */
*         IF UADSPDAT = 0                                          0152
*           THEN                      /* PWD LEVEL NOT SUPPORTED     */
@RF00148 L     @07,UADSPDAT(,DPOBPTR)                              0152
         LTR   @07,@07                                             0152
         BNZ   @RF00152                                            0152
*             DO;                                                  0153
*               NOPWDFLG = '1'B;      /* SET NO-SUPPORT FLAG         */
*               PWIND = '0'B;         /* NO MORE PASSWORDS           */
         OI    NOPWDFLG,B'00000010'                                0155
         NI    PWIND,B'10111111'                                   0155
*               GOTO PWFOUND;         /* GO TO THE ACCTNMBR LEVEL    */
         B     PWFOUND                                             0156
*             END;                                                 0157
*PWLEVL:  /* AN ASTERISK WAS SPECIFIED IN THE PASSWORD POSITION OF   */
*         /* THE NODELIST. CHECK THE PTR TO THE NEXT OFFSET BLOCK    */
*         /* AND SET THE PASSWORD INDICATOR (PWIND).                 */
*         /* IS THIS THE LAST PASSWORD UNDER THIS USERID?            */
*         IF UADSPNEX = 0                                          0158
*           THEN                      /* YES, END OF LATERAL CHAIN   */
@RF00152 DS    0H                                                  0158
PWLEVL   L     @07,UADSPNEX-1(,DPOBPTR)                            0158
         LA    @07,0(,@07)                                         0158
         LTR   @07,@07                                             0158
         BNZ   @RF00158                                            0158
*             PWIND = '0'B;           /* SET INDICATOR TO 0: NO MORE
*                                        PASSWORDS IN THIS CHAIN     */
         NI    PWIND,B'10111111'                                   0159
*           ELSE                      /* NO, THERE ARE MORE PASSWRDS */
*             DO;                                                  0160
         B     @RC00158                                            0160
@RF00158 DS    0H                                                  0161
*               PWIND = '1'B;         /* SET INDICATOR TO 1: ADDITIO-
*                                        NAL PASSWORDS IN THIS CHAIN */
         OI    PWIND,B'01000000'                                   0161
*               PWDBROTH =                                         0162
*                 HEDBPTR+UADSPNEX;   /* SET PTR TO NEXT PASSWORD  0162
*                                        OFFSET BLOCK IN THIS CHAIN  */
         LR    @07,HEDBPTR                                         0162
         L     @15,UADSPNEX-1(,DPOBPTR)                            0162
         LA    @15,0(,@15)                                         0162
         ALR   @07,@15                                             0162
         ST    @07,PWDBROTH                                        0162
*             END;                                                 0163
*         UADSPPTR = HEDBPTR+UADSPDAT;/* REF PASSWORD DATA BLOCK     */
*                                                                  0164
@RC00158 LR    @07,HEDBPTR                                         0164
         AL    @07,UADSPDAT(,DPOBPTR)                              0164
         ST    @07,UADSPPTR                                        0164
*         /* CHECK THE LEVEL AT WHICH DATA FORMATTING IS TO BE CON-  */
*         /* TINUED. IF IT IS GREATER THAN 2 (PASSWORD LEVEL), IT    */
*         /* MUST BE RESET TO 2 AT THIS POINT.                       */
*         IF LEVL > 2                 /* IS LEVL > 2 (ACCTNMBR OR  0165
*                                        PROCNAME)?                  */
*           THEN                      /* YES, RESET IT TO 2, INDI-   */
         LA    @07,2                                               0165
         CR    LEVL,@07                                            0165
         BNH   @RF00165                                            0165
*             LEVL = 2;               /* ..CATING PASSWORD LEVEL     */
         LR    LEVL,@07                                            0166
*PWFOUND: /* REFERENCE 1ST ACCTNMBR OBLK UNDER CURRENT PASSWORD.     */
*         DNOBPTR = HEDBPTR+UADSPSUB;                              0167
@RF00165 DS    0H                                                  0167
PWFOUND  LR    DNOBPTR,HEDBPTR                                     0167
         AL    DNOBPTR,UADSPSUB(,DPOBPTR)                          0167
*         /* DOES THE LIST NODELIST SPECIFY AN ACCOUNT NUMBER OR     */
*         /* AN ASTERISK? IF ASTERISK, REFERENCE THE FIRST ACCOUNT   */
*         /* NUMBER IN THE LATERAL CHAIN. IF AN ACCOUNT NUMBER WAS   */
*         /* SPECIFIED, GO TO THE ACCTNMBR SEARCH LOOP.              */
*         IF ACCTNO(1:2) ^= '* '      /* ACCTNMBR SPECIFIED ?        */
*           THEN                      /* YES                         */
         L     @02,NODELADR(,CTABPTR)                              0168
         CLC   ACCTNO(2,@02),@CC00407                              0168
         BE    @RF00168                                            0168
*             /* IF ACCTNMBRS ARE NOT SUPPORTED FOR THIS USERID,     */
*             /* THEN THE COMMAND IS INVALID FOR THIS USERID.        */
*             IF UADSADAT = 0                                      0169
*               THEN                  /* CMND INVALID FOR THIS USER  */
         L     @02,UADSADAT(,DNOBPTR)                              0169
         LTR   @02,@02                                             0169
         BZ    @RT00169                                            0169
*                 GOTO MORUS;         /* CHECK FOR MORE USERS        */
*               ELSE                  /* ACCTNMBRS ARE SUPPORTED     */
*                 GOTO ACSRCH;        /* SEARCH THE LATERAL CHAIN  0171
*                                        FOR THIS ACCTNMBR           */
         B     ACSRCH                                              0171
*         /* AN ASTERISK WAS SPECIFIED IN THE ACCTNMBR POSITION.     */
*         /* IF THE ACCTNMBR LEVEL IS NOT SUPPORTED, THE OFFSET TO   */
*         /* THE FIRST DATA FIELD WILL BE ZERO.                      */
*         IF UADSADAT = 0                                          0172
*           THEN                      /* ACTNBR LEVEL NOT SUPPORTED  */
@RF00168 L     @02,UADSADAT(,DNOBPTR)                              0172
         LTR   @02,@02                                             0172
         BNZ   @RF00172                                            0172
*             DO;                                                  0173
*               NOACTFLG = '1'B;      /* SET NO-SUPPORT FLAG         */
*               ACIND = '0'B;         /* NO MORE ACCTNMBRS           */
         OI    NOACTFLG,B'00000001'                                0175
         NI    ACIND,B'11011111'                                   0175
*               GOTO ACFOUND;         /* GO TO THE PROCNAME LEVEL    */
         B     ACFOUND                                             0176
*             END;                                                 0177
*ACLEVL:  /* AN ASTERISK WAS SPECIFIED IN THE ACCOUNT NUMBER POSI-   */
*         /* TION OF THE NODELIST. CHECK THE CHAIN FLAG IN THE OFF-  */
*         /* SET BLOCK AND SET THE ACCTNMBR INDICATOR (ACIND).       */
*         /* IS THIS THE LAST ACCOUNT NUMBER UNDER THIS PASSWORD?    */
*         IF AFLG01 = '1'B                                         0178
*           THEN                      /* YES, END OF LATERAL CHAIN   */
@RF00172 DS    0H                                                  0178
ACLEVL   TM    AFLG01(DNOBPTR),B'10000000'                         0178
         BNO   @RF00178                                            0178
*             ACIND = '0'B;           /* SET INDICATOR TO 0: NO MORE
*                                        ACCTNMBRS IN THIS CHAIN     */
         NI    ACIND,B'11011111'                                   0179
*           ELSE                      /* NO, THERE ARE MORE ACTNMBRS */
*             DO;                                                  0180
         B     @RC00178                                            0180
@RF00178 DS    0H                                                  0181
*               ACIND = '1'B;         /* SET INDICATOR TO 1: ADDITIO-
*                                        NAL ACCTNMBRS IN THIS CHAIN */
         OI    ACIND,B'00100000'                                   0181
*               ACTBROTH =                                         0182
*                 HEDBPTR+UADSANEX;   /* SET PTR TO NEXT ACCTNMBR  0182
*                                        OFFSET BLOCK IN THIS CHAIN  */
         LR    @02,HEDBPTR                                         0182
         L     @15,UADSANEX-1(,DNOBPTR)                            0182
         LA    @15,0(,@15)                                         0182
         ALR   @02,@15                                             0182
         ST    @02,ACTBROTH                                        0182
*             END;                                                 0183
*         UADSAPTR = HEDBPTR+UADSADAT;/* REF ACCTNMBR DATA BLOCK     */
@RC00178 LR    @02,HEDBPTR                                         0184
         AL    @02,UADSADAT(,DNOBPTR)                              0184
         ST    @02,UADSAPTR                                        0184
*ACFOUND: /* REFERENCE THE 1ST PROCNAME OBLK UNDER CURRENT ACCTNMBR. */
*         DROBPTR = HEDBPTR+UADSASUB;                              0185
ACFOUND  LR    DROBPTR,HEDBPTR                                     0185
         AL    DROBPTR,UADSASUB(,DNOBPTR)                          0185
*         /* DOES THE 'LIST' NODELIST SPECIFY A PROCNAME OR AN AS-   */
*         /* TERISK? IF ASTERISK, REFERENCE THE FIRST PROCNAME IN    */
*         /* THE LATERAL CHAIN. IF A PROCNAME WAS SPECIFIED, GO TO   */
*         /* THE PROCNAME SEARCH LOOP.                               */
*         IF PROCNM(1) ^= '*'         /* IS A PROCNAME SPECIFIED IN
*                                        THE NODELIST?               */
*           THEN                      /* YES                         */
         L     @07,NODELADR(,CTABPTR)                              0186
         CLI   PROCNM(@07),C'*'                                    0186
         BNE   @RT00186                                            0186
*             GOTO PRSRCH;            /* SEARCH THE LATERAL CHAIN  0187
*                                        FOR THIS PROCNAME           */
*PRLEVL:  /* AN ASTERISK WAS SPECIFIED IN THE PROCNAME POSITION OF   */
*         /* THE NODELIST. CHECK THE CHAIN FLAG IN THE OFFSET BLOCK  */
*         /* AND SET THE PROCNAME INDICATOR (PRIND).                 */
*         /* IS THIS THE LAST PROCNAME UNDER THIS ACCOUNT NUMBER?    */
*         IF FLGR01 = '1'B                                         0188
*           THEN                      /* YES, END OF LATERAL CHAIN   */
PRLEVL   TM    FLGR01(DROBPTR),B'10000000'                         0188
         BNO   @RF00188                                            0188
*             PRIND = '0'B;           /* SET INDICATOR TO 0: NO MORE
*                                        PROCNAMES IN THIS CHAIN     */
         NI    PRIND,B'11101111'                                   0189
*           ELSE                      /* NO, THERE ARE MORE PROCNAMS */
*             DO;                                                  0190
         B     @RC00188                                            0190
@RF00188 DS    0H                                                  0191
*               PRIND = '1'B;         /* SET INDICATOR TO 1: ADDITIO-
*                                        NAL PROCNAMES IN THIS CHAIN */
         OI    PRIND,B'00010000'                                   0191
*               PROBROTH =                                         0192
*                 HEDBPTR+UADSRNEX;   /* SET PTR TO NEXT PROCNAME  0192
*                                        OFFSET BLOCK IN THIS CHAIN  */
         LR    @07,HEDBPTR                                         0192
         L     @15,UADSRNEX-1(,DROBPTR)                            0192
         LA    @15,0(,@15)                                         0192
         ALR   @07,@15                                             0192
         ST    @07,PROBROTH                                        0192
*             END;                                                 0193
*         UADSRPTR = HEDBPTR+UADSRDAT;/* REF THE PROCNAME DATA FIELD */
@RC00188 LR    @07,HEDBPTR                                         0194
         AL    @07,UADSRDAT(,DROBPTR)                              0194
         ST    @07,UADSRPTR                                        0194
*PRFOUND: /* IT MUST NOW BE DETERMINED AT WHICH LEVEL THE FORMATTING */
*         /* OF DATA IN THE OPAREA IS TO START                       */
*         VALDAT = '1'B;              /* 1 - A VALID PROCNAME, AND 0195
*                                        THEREFORE A VALID VERTICAL
*                                        BRANCH, HAS BEEN FOUND.     */
PRFOUND  OI    VALDAT,B'00001000'                                  0195
*         NEXTUSER = '1'B;           /*INDICATE NEW USER     @ZA26793*/
         OI    NEXTUSER,B'00100000'                                0196
*         /* IS THE FORMATTING OF DATA TO START AT THE PROCNAME      */
*         /* LEVEL (PRLOOP)?                                         */
*         IF LEVL = 4                                              0197
*           THEN                      /* YES                         */
         C     LEVL,@CF00049                                       0197
         BE    @RT00197                                            0197
*             GOTO PRLOOP;            /* FORMAT THE PROCNAME DATA    */
*         /* IS THE FORMATTING OF DATA TO START AT THE ACCTNUMBER    */
*         /* LEVEL (ACLOOP)?                                         */
*         IF LEVL = 3                                              0199
*           THEN                      /* YES                         */
         C     LEVL,@CF00219                                       0199
         BE    @RT00199                                            0199
*             GOTO ACLOOP;            /* START FORMATTING DATA AT THE
*                                        ACCTNMBR LEVEL              */
*         /* IS THE FORMATTING OF DATA TO START AT THE PASSWORD      */
*         /* LEVEL (PWLOOP)?                                         */
*         IF LEVL = 2                                              0201
*           THEN                      /* YES                         */
         C     LEVL,@CF00113                                       0201
         BE    @RT00201                                            0201
*             GOTO PWLOOP;            /* START FORMATTING DATA AT THE
*                                        PASSWORD LEVEL              */
*         GOTO USLOOP;                /* START FORMATTING DATA AT THE
*                                        USERID LEVEL                */
         B     USLOOP                                              0203
*PRRTRN:  /* ON RETURN FROM THE PROCNAME DATA FORMATTING LOOP, IT    */
*         /* MUST BE ASCERTAINED WHERE PROCESSING IS TO CONTINUE.    */
*         /* MORE PROCNAMES TO BE PROCESSED UNDER THIS ACCTNUMBER?   */
*         IF PRIND = '1'B                                          0204
*           THEN                      /* YES                         */
PRRTRN   TM    PRIND,B'00010000'                                   0204
         BNO   @RF00204                                            0204
*             DO;                                                  0205
*               LEVL = 4;             /* SET LEVEL TO 4: PROCNAME    */
         LA    LEVL,4                                              0206
*               DROBPTR = PROBROTH;   /* REFERENCE THE PROCNAME    0207
*                                        BROTHER OFFSET BLOCK        */
         L     DROBPTR,PROBROTH                                    0207
*               GOTO PRLEVL;          /* PROCESS THE NEXT PROCNAME 0208
*                                        IN THIS LATERAL CHAIN       */
         B     PRLEVL                                              0208
*             END;                                                 0209
*         /* MORE ACCTNUMBERS TO BE PROCESSED UNDER THIS PASSWORD?   */
*         IF ACIND = '1'B                                          0210
*           THEN                      /* YES                         */
@RF00204 TM    ACIND,B'00100000'                                   0210
         BNO   @RF00210                                            0210
*             DO;                                                  0211
*               LEVL = 3;             /* SET LEVEL TO 3: ACCTNMBR    */
         LA    LEVL,3                                              0212
*               DNOBPTR = ACTBROTH;   /* REFERENCE THE ACCTNMBR    0213
*                                        BROTHER OFFSET BLOCK        */
         L     DNOBPTR,ACTBROTH                                    0213
*               GOTO ACLEVL;          /* PROCESS THE NEXT ACCTNMBR 0214
*                                        IN THIS LATERAL CHAIN       */
         B     ACLEVL                                              0214
*             END;                                                 0215
*         /* MORE PASSWORDS TO BE PROCESSED UNDER THIS USERID?       */
*         IF PWIND = '1'B                                          0216
*           THEN                      /* YES                         */
@RF00210 TM    PWIND,B'01000000'                                   0216
         BNO   @RF00216                                            0216
*             DO;                                                  0217
*               LEVL = 2;             /* SET LEVEL TO 2: PASSWORD    */
         LA    LEVL,2                                              0218
*               DPOBPTR = PWDBROTH;   /* REFERENCE THE PASSWORD    0219
*                                        BROTHER OFFSET BLOCK        */
         L     DPOBPTR,PWDBROTH                                    0219
*               GOTO PWLEVL;          /* PROCESS THE NEXT PASSWORD 0220
*                                        IN THIS LATERAL CHAIN       */
         B     PWLEVL                                              0220
*             END;                                                 0221
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */
         B     MORUS                                               0222
*         /********************************************************* */
*         /*                                                         */
*         /*                   SEARCH LOOPS                          */
*         /*                                                         */
*         /********************************************************* */
*PWSRCH:  /* SEARCH FOR THE PASSWORD SPECIFIED IN THE NODELIST       */
*         /* OF THE LIST COMMAND                                     */
*         UADSPPTR = HEDBPTR+UADSPDAT;/* REFERENCE THE PASSWORD DATA
*                                        BLOCK IN THE UADS           */
PWSRCH   LR    @07,HEDBPTR                                         0223
         AL    @07,UADSPDAT(,DPOBPTR)                              0223
         ST    @07,UADSPPTR                                        0223
*         /* COMPARE THE UADS-PASSWORD TO THE NODELIST-PASSWORD      */
*         IF UADSPPWD = PASSWD        /* ARE THEY EQUAL?             */
*           THEN                      /* YES, THE SPECIFIED PASSWORD
*                                        HAS BEEN FOUND              */
         L     @01,NODELADR(,CTABPTR)                              0224
         CLC   UADSPPWD(8,@07),PASSWD(@01)                         0224
         BNE   @RF00224                                            0224
*             DO;                                                  0225
*               PWIND = '0'B;         /* NO MORE PASSWORDS TO BE PRO-
*                                        CESSED UNDER THIS USERID    */
         NI    PWIND,B'10111111'                                   0226
*               PWFNDFLG = '1'B;      /* 1- PASSWD FOUND AS SPECIFD  */
         OI    PWFNDFLG,B'10000000'                                0227
*               GOTO PWFOUND;         /* THE NODELIST-PASSWORD IS  0228
*                                        VALID, START PROCESSING THE
*                                        ACCTNMBR                    */
         B     PWFOUND                                             0228
*             END;                                                 0229
*         /* CHECK THE PTR TO THE NEXT PASSWORD OFFSET BLOCK. IF IT  */
*         /* IS ZERO, INDICATING END OF THE CHAIN, THEN THE SPECI-   */
*         /* FIED PASSWORD DOES NOT EXIST UNDER THIS USERID.         */
*         IF UADSPNEX ^= 0            /* MORE PASSWORDS UNDER THIS 0230
*                                        USERID?                     */
*           THEN                      /* YES, CONTINUE THE SEARCH    */
@RF00224 L     @07,UADSPNEX-1(,DPOBPTR)                            0230
         LA    @07,0(,@07)                                         0230
         LTR   @07,@07                                             0230
         BZ    @RF00230                                            0230
*             DO;                                                  0231
*               DPOBPTR =             /* ADDR OF NEXT OFFSET BLOCK = */
*                 HEDBPTR+UADSPNEX;   /* ..ADDR OF USERID HEADER + 0232
*                                        OFFSET TO BROTHER           */
         ALR   @07,HEDBPTR                                         0232
         LR    DPOBPTR,@07                                         0232
*               GOTO PWSRCH;          /* REENTER THE SEARCH LOOP AND
*                                        COMPARE THE NEXT PASSWORD   */
         B     PWSRCH                                              0233
*             END;                                                 0234
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */
         B     MORUS                                               0235
*         /********************************************************* */
*ACSRCH:  /* SEARCH FOR THE ACCOUNT-NUMBER SPECIFIED IN THE NODELIST */
*         /* OF THE LIST COMMAND.                                    */
*         /********************************************************* */
*         UADSAPTR =                  /* REFERENCE THE ACCTNMBR DATA */
*           HEDBPTR+UADSADAT;         /* ..BLOCK IN THE UADS         */
ACSRCH   LR    @02,HEDBPTR                                         0236
         AL    @02,UADSADAT(,DNOBPTR)                              0236
         ST    @02,UADSAPTR                                        0236
*         /* COMPARE THE LENGTHS IN THE DATA BLOCK AND NODELIST. IF  */
*         /* THE LENGTHS ARE NOT EQUAL, A COMPARISON OF THE ACCOUNT- */
*         /* NUMBERS IS UNNECESSARY                                  */
*         IF UADSALEN = ACTLEN        /* LENGTHS EQUAL?              */
*           THEN                      /* YES                         */
         L     @15,NODELADR(,CTABPTR)                              0237
         CLC   UADSALEN(1,@02),ACTLEN(@15)                         0237
         BNE   @RF00237                                            0237
*             /* COMPARE THE ACCTNMBR IN THE UADS DATA BLOCK TO THE  */
*             /* NODELIST-ACCTNMBR                                   */
*             IF UADSANUM(1:UADSALEN)= /* ACCTNMBRS EQUAL?           */
*                ACCTNO(1:UADSALEN)                                0238
*               THEN                  /* THEY ARE EQUAL              */
         SLR   @14,@14                                             0238
         IC    @14,UADSALEN(,@02)                                  0238
         BCTR  @14,0                                               0238
         EX    @14,@SC00508                                        0238
         BNE   @RF00238                                            0238
*                 DO;                                              0239
*                   ACIND = '0'B;     /* IND = 0: NO MORE ACCTNMBRS
*                                        TO BE PROCESSED UNDER THIS
*                                        PASSWORD                    */
         NI    ACIND,B'11011111'                                   0240
*                   ACFNDFLG = '1'B;  /* 1- ACTNO FOUND AS SPECIFIED */
         OI    ACFNDFLG,B'01000000'                                0241
*                   GOTO ACFOUND;     /* THE SPECIFIED ACCTNMBR HAS
*                                        BEEN FOUND. START PROCESSING
*                                        THE PROCNAME                */
         B     ACFOUND                                             0242
*                 END;                                             0243
*         /* CHECK THE CHAIN FLAG IN THE OFFSET BLOCK: ARE THERE     */
*         /* MORE ACCOUNT NUMBERS IN THIS LATERAL CHAIN?             */
*         IF AFLG01 = '0'B            /* MORE ACCTNMBRS?             */
*           THEN                      /* YES                         */
@RF00238 DS    0H                                                  0244
@RF00237 TM    AFLG01(DNOBPTR),B'10000000'                         0244
         BNZ   @RF00244                                            0244
*             DO;                                                  0245
*               DNOBPTR =             /* REFERENCE THE NEXT OFFSET   */
*                 HEDBPTR+UADSANEX;   /* BLOCK IN THIS CHAIN         */
         LR    @02,HEDBPTR                                         0246
         L     @15,UADSANEX-1(,DNOBPTR)                            0246
         LA    @15,0(,@15)                                         0246
         ALR   @02,@15                                             0246
         LR    DNOBPTR,@02                                         0246
*               GOTO ACSRCH;          /* CONTINUE THE SEARCH         */
         B     ACSRCH                                              0247
*             END;                                                 0248
*         /* CHECK THE PASSWORD INDICATOR: ARE THERE MORE PASSWORDS  */
*         /* TO BE PROCESSED UNDER THIS USERID?                      */
*         IF PWIND = '1'B             /* ANY MORE PASSWORDS?         */
*           THEN                      /* YES,                        */
@RF00244 TM    PWIND,B'01000000'                                   0249
         BNO   @RF00249                                            0249
*             DO;                                                  0250
*               DPOBPTR = PWDBROTH;   /* REFERENCE THE NEXT PASSWORD
*                                        OFFSET BLOCK (BROTHER)      */
         L     DPOBPTR,PWDBROTH                                    0251
*               GOTO PWLEVL;          /* CONTINUE THE SEARCH FOR THIS
*                                        ACCTNMBR UNDER THE NEXT PASS-
*                                        WORD                        */
         B     PWLEVL                                              0252
*             END;                                                 0253
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */
         B     MORUS                                               0254
*         /********************************************************* */
*PRSRCH:  /* SEARCH FOR THE PROCEDURE NAME SPECIFIED IN THE NODELIST */
*         /* OF THE 'LIST' COMMAND                                   */
*         UADSRPTR =                  /* REFERENCE THE PROCNAME DATA */
*           HEDBPTR+UADSRDAT;         /* ..BLOCK IN THE UADS         */
PRSRCH   LR    @07,HEDBPTR                                         0255
         AL    @07,UADSRDAT(,DROBPTR)                              0255
         ST    @07,UADSRPTR                                        0255
*         /* COMPARE THE UADS-PROCNAME WITH THE NODELIST-PROCNAME    */
*         IF UADSRNAM = PROCNM        /* PROCNAMES EQUAL?            */
*           THEN                      /* YES                         */
         L     @01,NODELADR(,CTABPTR)                              0256
         CLC   UADSRNAM(8,@07),PROCNM(@01)                         0256
         BNE   @RF00256                                            0256
*             DO;                                                  0257
*               PRIND = '0'B;         /* THE SPECIFIED PROCNAME HAS
*                                        BEEN FOUND. NO MORE PROCNAMES
*                                        TO BE PROCESSED IN THIS LATE-
*                                        RAL CHAIN                   */
         NI    PRIND,B'11101111'                                   0258
*               GOTO PRFOUND;         /* CHECK WHERE THE FORMATTING
*                                        OF DATA IS TO BEGIN         */
         B     PRFOUND                                             0259
*             END;                                                 0260
*         /* CHECK THE CHAIN FLAG IN THE OFFSET BLOCK: ARE THERE     */
*         /* MORE PROCNAMES IN THIS LATERAL CHAIN?                   */
*         IF FLGR01 = '0'B            /* ANY PROCNAME BROTHERS?      */
*           THEN                      /* YES                         */
@RF00256 TM    FLGR01(DROBPTR),B'10000000'                         0261
         BNZ   @RF00261                                            0261
*             DO;                                                  0262
*               DROBPTR =             /* REFERENCE THE NEXT PROCNAME */
*                 HEDBPTR+UADSRNEX;   /* ..OFFSET BLOCK              */
         LR    @07,HEDBPTR                                         0263
         L     @15,UADSRNEX-1(,DROBPTR)                            0263
         LA    @15,0(,@15)                                         0263
         ALR   @07,@15                                             0263
         LR    DROBPTR,@07                                         0263
*               GOTO PRSRCH;          /* COMPARE THE NEXT UADS PROC-
*                                        NAME WITH THE NODELIST PROC-
*                                        NAME                        */
         B     PRSRCH                                              0264
*             END;                                                 0265
*         /* CHECK THE ACCTNMBR INDICATOR: ARE THERE MORE ACCTNMBRS  */
*         /* TO BE PROCESSED UNDER THIS PASSWORD?                    */
*         IF ACIND = '1'B             /* MORE ACCTNUMBERS?           */
*           THEN                      /* YES                         */
@RF00261 TM    ACIND,B'00100000'                                   0266
         BNO   @RF00266                                            0266
*             DO;                                                  0267
*               DNOBPTR = ACTBROTH;   /* REFERENCE THE NEXT ACCTNMBR
*                                        OFFSET BLOCK IN THIS CHAIN  */
         L     DNOBPTR,ACTBROTH                                    0268
*               GOTO ACLEVL;          /* GO SEARCH FOR THIS PROCNAME
*                                        UNDER THE NEXT ACCTNMBR     */
         B     ACLEVL                                              0269
*             END;                                                 0270
*         /* CHECK THE PASSWORD INDICATOR: ARE THERE MORE PASSWORDS  */
*         /* TO BE PROCESSED UNDER THIS USERID?                      */
*         IF PWIND = '1'B             /* MORE PASSWORDS?             */
*           THEN                      /* YES                         */
@RF00266 TM    PWIND,B'01000000'                                   0271
         BNO   @RF00271                                            0271
*             DO;                                                  0272
*               DPOBPTR = PWDBROTH;   /* REFERENCE THE NEXT PASSWORD
*                                        OFFSET BLOCK IN THIS CHAIN  */
         L     DPOBPTR,PWDBROTH                                    0273
*               GOTO PWLEVL;          /* GO SEARCH FOR THIS PROCNAME
*                                        UNDER THE NEXT PASSWORD     */
         B     PWLEVL                                              0274
*             END;                                                 0275
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */
         B     MORUS                                               0276
*         /********************************************************* */
*         /*                                                         */
*         /*                 FORMATTING OF DATA                      */
*         /*                                                         */
*USLOOP:  /* THE USLOOP WILL EXTRACT THE USERID DATA FROM THE UADS   */
*         /* AND FORMAT IT IN AN OUTPUT AREA. THE FIRST TWO WORDS    */
*         /* OF EACH LINE ARE REQUIRED BY 'PUTLINE' AND ARE NOT PART */
*         /* OF THE OUTPUT. THE DATA CONSISTS OF THE FOLLOWING: THE  */
*         /* USERID, THE USER ATTRIBUTES (IN WORDS ), THE INSTALLA-  */
*         /* TION ATTRIBUTES (IN HEX), THE MAXIMUM CORE SIZE AND THE */
*         /* USER PROFILE TABLE (IN HEX).                            */
*         /* IS THERE SPACE IN THE OPAREA FOR THE USERID DATA?       */
*         /********************************************************* */
*         IF OPASIZE < LENGTH(USIDDATA) /* ENOUGH SPACE FOR DATA?    */
*           THEN                      /* NO, SEND THE FORMATTED DATA
*                                        TO 'PUTLINE' AND RETURN TO
*                                        USLOOP                      */
USLOOP   C     OPASIZE,@CF00486                                    0277
         BNL   @RF00277                                            0277
*             CALL PUTDATA;           /* SEND THE DATA TO 'PUTLINE'  */
         BAL   @14,PUTDATA                                         0278
*         USIDDATA(1:256) = ' ';      /* BLANK OUT LINE              */
@RF00277 MVI   USIDDATA+1(OUTAPTR),C' '                            0279
         MVC   USIDDATA+2(254,OUTAPTR),USIDDATA+1(OUTAPTR)         0279
         MVI   USIDDATA(OUTAPTR),C' '                              0279
*         USIDDATA(256:LNUSID) =      /* BLANK OUT REMAINDER         */
*           USIDDATA(1:LNUSID);                                    0280
         LH    @09,LNUSID                                          0280
         SL    @09,@CF00329                                        0280
         MVC   @TS00001(256),USIDDATA(OUTAPTR)                     0280
         EX    @09,@SM00510                                        0280
*         NEXTLN1 = ADDR(NEXTLN2);    /* THE FIRST WORD OF EACH LINE
*                                        IS A PTR TO THE NEXT LINE   */
         LA    @09,NEXTLN2(,OUTAPTR)                               0281
         ST    @09,NEXTLN1(,OUTAPTR)                               0281
*         USLNL1 = LNUSLIN1-4;        /* LENGTH OF THIS LINE, EXCLUD-
*                                        ING THE FULL-WORD PTR       */
         SLR   @09,@09                                             0282
         IC    @09,LNUSLIN1                                        0282
         SL    @09,@CF00049                                        0282
         STH   @09,USLNL1(,OUTAPTR)                                0282
*         USBYTE1 = 0;                /* THESE TWO BYTES ARE REQUIRED
*                                        BY 'PUTLINE'                */
         SLR   @09,@09                                             0283
         STH   @09,USBYTE1(,OUTAPTR)                               0283
*         BUFUSID(1:USRLEN) = UADSUSER;/* INSERT THE USERID          */
         L     @09,NODELADR(,CTABPTR)                              0284
         SLR   @07,@07                                             0284
         IC    @07,USRLEN(,@09)                                    0284
         BCTR  @07,0                                               0284
         EX    @07,@SM00512                                        0284
*         USCONST1 =                  /* CONSTANT TEXT               */
*           '  USER ATTRIBUTES:  ';                                0285
         MVC   USCONST1(20,OUTAPTR),@CC00428                       0285
*         /* DOES THE USER HAVE OPERATOR CAPABILITY?                 */
*         IF USATR00 = '0'B                                        0286
*           THEN                      /* NO                          */
         TM    USATR00(HEDBPTR),B'10000000'                        0286
         BNZ   @RF00286                                            0286
*             OPERATTR = 'NOOPER';    /* INSERT 'NOOPER' IN THE TEXT */
         MVC   OPERATTR(6,OUTAPTR),@CC00430                        0287
*           ELSE                      /* YES                         */
*             OPERATTR = '  OPER';    /* INSERT 'OPER'               */
         B     @RC00286                                            0288
@RF00286 MVC   OPERATTR(6,OUTAPTR),@CC00431                        0288
*         /* DOES THE USER HAVE ACCOUNT CAPABILITY?                  */
*         IF USATR01 = '0'B                                        0289
*           THEN                      /* NO                          */
@RC00286 TM    USATR01(HEDBPTR),B'01000000'                        0289
         BNZ   @RF00289                                            0289
*             ACCTATTR = 'NOACCT';    /* INSERT 'NOACCT' IN THE TEXT */
         MVC   ACCTATTR(6,OUTAPTR),@CC00432                        0290
*           ELSE                      /* YES                         */
*             ACCTATTR = '  ACCT';    /* INSERT 'ACCT'               */
         B     @RC00289                                            0291
@RF00289 MVC   ACCTATTR(6,OUTAPTR),@CC00433                        0291
*         /* DOES THE USER HAVE JCL CAPABILITY?                      */
*         IF USATR02 = '0'B                                        0292
*           THEN                      /* NO                          */
@RC00289 TM    USATR02(HEDBPTR),B'00100000'                        0292
         BNZ   @RF00292                                            0292
*             JCLATTR = 'NOJCL';      /* INSERT 'NOJCL' IN THE TEXT  */
         MVC   JCLATTR(5,OUTAPTR),@CC00434                         0293
*           ELSE                      /* YES                         */
*             JCLATTR = '  JCL';      /* INSERT 'JCL'                */
         B     @RC00292                                            0294
@RF00292 MVC   JCLATTR(5,OUTAPTR),@CC00435                         0294
*         /* DOES THE USER HAVE MOUNT CAPABILITY?              Y02678*/
*         IF USATR03 = '0'B                                        0295
*           THEN                      /* NO                          */
@RC00292 TM    USATR03(HEDBPTR),B'00010000'                        0295
         BNZ   @RF00295                                            0295
*             MONTATTR = 'NOMOUNT';   /* INSERT 'NOMOUNT' IN THE TEXT
*                                                              Y02678*/
         MVC   MONTATTR(7,OUTAPTR),@CC00436                        0296
*           ELSE                      /* YES                         */
*             MONTATTR = '  MOUNT';   /* INSERT 'MOUNT'        Y02678*/
         B     @RC00295                                            0297
@RF00295 MVC   MONTATTR(7,OUTAPTR),@CC00437                        0297
*         NEXTLN2 = ADDR(NEXTLN3);    /* PTR TO THE NEXT OUTPUT LINE */
@RC00295 LA    @09,NEXTLN3(,OUTAPTR)                               0298
         ST    @09,NEXTLN2(,OUTAPTR)                               0298
*         USLNL2 = LNUSLIN2-4;        /* LENGTH OF THIS LINE         */
         LA    @09,4                                               0299
         SLR   @07,@07                                             0299
         IC    @07,LNUSLIN2                                        0299
         SLR   @07,@09                                             0299
         STH   @07,USLNL2(,OUTAPTR)                                0299
*         USBYTE2 = 0;                /* REQUIRED BY 'PUTLINE'       */
         SLR   @07,@07                                             0300
         STH   @07,USBYTE2(,OUTAPTR)                               0300
*         USCONST2 =                  /* CONSTANT TEXT               */
*           'INSTALLATION ATTRIBUTES, IN HEX: ';                   0301
         MVC   USCONST2(33,OUTAPTR),@CC00438                       0301
*         /* TRANSLATE THE INSTALLATION ATTRIBUTES.                  */
*         UNPK (INSTATTR,ATTRBIN);    /* UNPACK INSTALLATION DATA    */
         UNPK  INSTATTR(5,OUTAPTR),ATTRBIN(3,HEDBPTR)              0302
*         TR (INSTATTR(1:5),HEXREP);  /* TRANSLATE DATA TO BCD       */
         TR    INSTATTR(5,OUTAPTR),HEXREP                          0303
*         INSTATTR(5) = ' ';          /* BLANK OUT EXTRA CHAR        */
         MVI   INSTATTR+4(OUTAPTR),C' '                            0304
*         NEXTLN3 = ADDR(NEXTLN4);    /* PTR TO THE NEXT OUTPUT LINE */
         LA    @02,NEXTLN4(,OUTAPTR)                               0305
         ST    @02,NEXTLN3(,OUTAPTR)                               0305
*         USLNL3 = LNUSLIN3-4;        /* LENGTH OF THIS LINE         */
         LCR   @09,@09                                             0306
         SLR   @02,@02                                             0306
         IC    @02,LNUSLIN3                                        0306
         ALR   @09,@02                                             0306
         STH   @09,USLNL3(,OUTAPTR)                                0306
*         USBYTE3 = 0;                /* REQUIRED BY 'PUTLINE'       */
         STH   @07,USBYTE3(,OUTAPTR)                               0307
*         USCONS3A = 'MAXSIZE: ';     /* CONSTANT TEXT               */
         MVC   USCONS3A(9,OUTAPTR),@CC00443                        0308
*         /* MAXSIZE = 0 MEANS 'NOLIM'.                              */
*         IF UADSMAXC = 0                                          0309
*           THEN                      /* YES, MAXSIZE = NOLIM        */
         LH    @09,UADSMAXC(,HEDBPTR)                              0309
         N     @09,@CF00514                                        0309
         LTR   @09,@09                                             0309
         BNZ   @RF00309                                            0309
*             DO;                                                  0310
*             USMAXSZ = 'NOLIM';      /* INSERT 'NOLIM'              */
         MVC   USMAXSZ(5,OUTAPTR),@CC00445                         0311
*             USCONS3B = '          ';/* BLANK OUT 'K BYTES'         */
         MVC   USCONS3B(10,OUTAPTR),@CC00446                       0312
*             END;                                                 0313
*           ELSE                                                   0314
*             DO;                                                  0314
         B     @RC00309                                            0314
@RF00309 DS    0H                                                  0315
*             /* CONVERT THE REGION SIZE GIVEN IN UADS TO DECIMAL    */
*             CVD (UADSMAXC,CVDAREA); /* CONVERT TO PACKED DECIMAL   */
         LH    @09,UADSMAXC(,HEDBPTR)                              0315
         N     @09,@CF00514                                        0315
         CVD   @09,CVDAREA                                         0315
*             UNPK (USMAXSZ(1:5),CVDAREA(6:8));/*CONVERT TO ZONED DEC*/
         UNPK  USMAXSZ(5,OUTAPTR),CVDAREA+5(3)                     0316
*             USMAXSZ(5)=USMAXSZ(5)'F0'X;/* REMOVE SIGN             */
         OI    USMAXSZ+4(OUTAPTR),X'F0'                            0317
*             USCONS3B = 'K BYTES   ';/* CONSTANT TEXT               */
         MVC   USCONS3B(10,OUTAPTR),@CC00450                       0318
*             BCNT = 1;               /* INITIALIZE THE BYTE COUNT   */
         LA    BCNT,1                                              0319
*             /* SUPPRESS LEADING ZEROS.                             */
*             DO WHILE USMAXSZ(BCNT) = '0';                        0320
         B     @DE00320                                            0320
@DL00320 DS    0H                                                  0321
*               USMAXSZ(BCNT) = ' ';  /* SUPPRESS IT                 */
         LR    @09,OUTAPTR                                         0321
         ALR   @09,BCNT                                            0321
         MVI   USMAXSZ-1(@09),C' '                                 0321
*               BCNT = BCNT+1;        /* INCREMENT THE BYTE COUNT    */
         LA    BCNT,1(,BCNT)                                       0322
*             END;                                                 0323
@DE00320 LR    @09,OUTAPTR                                         0323
         ALR   @09,BCNT                                            0323
         CLI   USMAXSZ-1(@09),C'0'                                 0323
         BE    @DL00320                                            0323
*           END;                                                   0324
*         NEXTLN4 = ADDR(NEXTLN5);    /* PTR TO THE NEXT OUTPUT LINE */
@RC00309 LA    @09,NEXTLN5(,OUTAPTR)                               0325
         ST    @09,NEXTLN4(,OUTAPTR)                               0325
*         USLNL4 = LNUSLIN4-4;        /* LENGTH OF THIS LINE         */
         LA    @09,4                                               0326
         SLR   @07,@07                                             0326
         IC    @07,LNUSLIN4                                        0326
         SLR   @07,@09                                             0326
         STH   @07,USLNL4(,OUTAPTR)                                0326
*         USBYTE4 = 0;                /* REQUIRED BY 'PUTLINE'       */
         SLR   @07,@07                                             0327
         STH   @07,USBYTE4(,OUTAPTR)                               0327
*         USCONST4 =                  /* CONSTANT TEXT               */
*           'USER PROFILE TABLE: ';                                0328
         MVC   USCONST4(20,OUTAPTR),@CC00452                       0328
*         NEXTLN5 = ADDR(NEXTLN6);    /* PTR TO THE NEXT OUTPUT LINE */
         LA    @02,NEXTLN6(,OUTAPTR)                               0329
         ST    @02,NEXTLN5(,OUTAPTR)                               0329
*         USLNL5 = LNUSLIN5-4;        /* LENGTH OF THIS LINE         */
         LCR   @09,@09                                             0330
         SLR   @02,@02                                             0330
         IC    @02,LNUSLIN5                                        0330
         ALR   @09,@02                                             0330
         STH   @09,USLNL5(,OUTAPTR)                                0330
*         USBYTE5 = 0;                /* REQUIRED BY 'PUTLINE'       */
         STH   @07,USBYTE5(,OUTAPTR)                               0331
*         /* TRANSLATE THE INSTALLATION ATTRIBUTES.                  */
*         UPTBIN(1:16) = UPT;         /* COPY UPT INTO WORK AREA     */
         L     @09,UPTPTR                                          0332
         MVC   UPTBIN(16),UPT(@09)                                 0332
*         UNPK (UPTHEX(1:15),UPTBIN(1:8));                         0333
         UNPK  UPTHEX(15,OUTAPTR),UPTBIN(8)                        0333
*         UNPK (UPTHEX(15:29),UPTBIN(8:15));                       0334
         UNPK  UPTHEX+14(15,OUTAPTR),UPTBIN+7(8)                   0334
*         UNPK (UPTHEX(29:33),UPTBIN(15:17));                      0335
         UNPK  UPTHEX+28(5,OUTAPTR),UPTBIN+14(3)                   0335
*         TR (UPTHEX(1:33),HEXREP);                                0336
         TR    UPTHEX(33,OUTAPTR),HEXREP                           0336
*         UPTHEX(33) = ' ';           /* BLANK OUT EXTRA CHAR        */
         MVI   UPTHEX+32(OUTAPTR),C' '                             0337
*         IF UADSEXPF = '1'B          /* IS UADS EXPANDED?           */
*           THEN                      /* YES,                        */
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0338
         BNO   @RF00338                                            0338
*             UPTUSID = UPTPREFX;     /* GET USERID PREFIX          1*/
         MVC   UPTUSID(7,OUTAPTR),UPTPREFX(@09)                    0339
*         NEXTLN6 = OUTAPTR+LNUSID;   /* PTR TO THE NEXT OUTPUT LINE
*                                                              Y02678*/
@RF00338 LR    @09,OUTAPTR                                         0340
         AH    @09,LNUSID                                          0340
         ST    @09,NEXTLN6(,OUTAPTR)                               0340
*         USLNL6 = LNUSLIN6-4;        /* LENGTH OF THIS LINE   Y02678*/
         SLR   @09,@09                                             0341
         IC    @09,LNUSLIN6                                        0341
         SL    @09,@CF00049                                        0341
         STH   @09,USLNL6(,OUTAPTR)                                0341
*         USBYTE6 = 0;                /* REQUIRED BY 'PUTLINE' Y02678*/
         SLR   @09,@09                                             0342
         STH   @09,USBYTE6(,OUTAPTR)                               0342
*         USCONST6 =                  /* TEXT                  Y02678*/
*           'DESTINATION  =  ';                                    0343
         MVC   USCONST6(16,OUTAPTR),@CC00455                       0343
*         IF UADSEXPF = '1'B          /* IS UADS IN NEW FORMAT?      */
*          & UADSDEST(1) ^= '00'X     /* AND DESTINATION SPECIFIED?  */
*           THEN                      /* YES,                        */
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0344
         BNO   @RF00344                                            0344
         CLI   UADSDEST(HEDBPTR),X'00'                             0344
         BE    @RF00344                                            0344
*             DESTINAT = UADSDEST;    /* INSERT DESTINATION    Y02678*/
         MVI   DESTINAT+8(OUTAPTR),C' '                            0345
         MVC   DESTINAT+9(13,OUTAPTR),DESTINAT+8(OUTAPTR)          0345
         MVC   DESTINAT(8,OUTAPTR),UADSDEST(HEDBPTR)               0345
*           ELSE                      /* NO, OLD UADS                */
*             DESTINAT = 'CENTRAL SITE DEFAULT';/* DEFAULT     Y02678
*                                        DESTINATION         @ZA19964*/
         B     @RC00344                                            0346
@RF00344 MVI   DESTINAT+20(OUTAPTR),C' '                           0346
         MVI   DESTINAT+21(OUTAPTR),C' '                           0346
         MVC   DESTINAT(20,OUTAPTR),@CC00458                       0346
*         OPASIZE = OPASIZE-LNUSID;   /* SUBTRACT THE SPACE USED BY
*                                        THE USERID DATA FROM THE  0347
*                                        SPACE AVAILABLE IN THE OUT-
*                                        PUT AREA                    */
@RC00344 LH    @09,LNUSID                                          0347
         SLR   OPASIZE,@09                                         0347
*         OUTAPTR = OUTAPTR+LNUSID;   /* INCREMENT THE ADDRESS OF THE
*                                        OUTPUT BUFFER         Y02678*/
         ALR   OUTAPTR,@09                                         0348
*         IF OPASIZE < LENGTH(PERFLIN1)/* ENOUGH SPACE?              */
*           THEN                      /* NO,                         */
         C     OPASIZE,@CF00369                                    0349
         BNL   @RF00349                                            0349
*             CALL PUTDATA;           /* GO TO PUT OUT THE LAST DATA
*                                                              Y02678*/
         BAL   @14,PUTDATA                                         0350
*         PERFLIN1 = ' ';             /* BLANK OUT LINE        Y02678*/
@RF00349 MVI   PERFLIN1+1(OUTAPTR),C' '                            0351
         MVC   PERFLIN1+2(42,OUTAPTR),PERFLIN1+1(OUTAPTR)          0351
         MVI   PERFLIN1(OUTAPTR),C' '                              0351
*         /* START FORMATTING THE PERFORMANCE DATA.            Y02678*/
*         PFNEXTL1 = OUTAPTR+LNPFLIN1;/* PTR TO THE NEXT OUTPUT LINE
*                                                              Y02678*/
         SLR   @09,@09                                             0352
         IC    @09,LNPFLIN1                                        0352
         LR    @07,OUTAPTR                                         0352
         ALR   @07,@09                                             0352
         ST    @07,PFNEXTL1(,OUTAPTR)                              0352
*         PFLINEL1 = LNPFLIN1-4;      /* LENGTH OF THIS LINE   Y02678*/
         LR    @07,@09                                             0353
         SL    @07,@CF00049                                        0353
         STH   @07,PFLINEL1(,OUTAPTR)                              0353
*         PFBYTE1 = 0;                /* REQUIRED BY 'PUTLINE' Y02678*/
         SLR   @07,@07                                             0354
         STH   @07,PFBYTE1(,OUTAPTR)                               0354
*         OPASIZE = OPASIZE-LNPFLIN1; /* SUBTRACT THE SPACE USED BY
*                                        THE PERFORMANCE DATA FROM THE
*                                        SPACE AVAILABLE IN THE OUT-
*                                        PUT AREA              Y02678*/
         SLR   OPASIZE,@09                                         0355
*         IF UADSEXPF = '0'B         /* IF THIS IS OLD USER FORMAT  */
*          UADSPERP = 0               /* OR NOPERFORMANGE GROUPS     */
*           THEN                      /* SPECIFIED             Y02678*/
         TM    UADSEXPF(HEDBPTR),B'01000000'                       0356
         BZ    @RT00356                                            0356
         C     @07,UADSPERP(,HEDBPTR)                              0356
         BNE   @RF00356                                            0356
@RT00356 DS    0H                                                  0357
*             DO;                                                  0357
*             PFCONST1 =              /* INSERT TEXT           Y02678*/
*               'NO PERFORMANCE GROUPS';                           0358
         MVC   PFCONST1(21,OUTAPTR),@CC00460                       0358
*             OUTAPTR = OUTAPTR+      /* INCREMENT THE ADDRESS OF    */
*                LNPFLIN1;            /* THE OUTPUT BUFFER     Y02678*/
         SLR   @09,@09                                             0359
         IC    @09,LNPFLIN1                                        0359
         ALR   OUTAPTR,@09                                         0359
*             GOTO PWLOOP;            /* GO TO LIST PASSWORDS  Y02678*/
         B     PWLOOP                                              0360
*             END;                                                 0361
*         PFCONST1 = 'PERFORMANCE GROUPS:  ';/* INSERT TEXT    Y02678*/
@RF00356 MVC   PFCONST1(21,OUTAPTR),@CC00462                       0362
*         OUTAPTR = OUTAPTR+LNPFLIN1; /* INCREMENT THE ADDRESS OF THE
*                                        OUTPUT BUFFER         Y02678*/
         SLR   @09,@09                                             0363
         IC    @09,LNPFLIN1                                        0363
         ALR   OUTAPTR,@09                                         0363
*         NUM = 1;                    /* INIT GROUP NUMBER     Y02678*/
         LA    NUM,1                                               0364
*         PERFPTR = HEDBPTR+UADSPERP; /* INIT PTR TO PERF GROUPS   0365
*                                                              Y02678*/
         LR    @09,HEDBPTR                                         0365
         AL    @09,UADSPERP(,HEDBPTR)                              0365
         ST    @09,PERFPTR                                         0365
*         TESTBYTE = '80'X;           /* TURN ON HIGH ORDER BIT    0366
*                                                              Y02678*/
         MVI   TESTBYTE,X'80'                                      0366
*         DO WHILE NUM < 256;         /* LOOP TILL END OF GROUPS   0367
*                                                              Y02678*/
         B     @DE00367                                            0367
@DL00367 DS    0H                                                  0368
*           IF OPASIZE < LNPFLIN2     /* IS THERE ENOUGH ROOM?       */
*             THEN                    /* NO,                         */
         SLR   @09,@09                                             0368
         IC    @09,LNPFLIN2                                        0368
         CR    OPASIZE,@09                                         0368
         BNL   @RF00368                                            0368
*               CALL PUTDATA;         /* WRITE THE BUFFER OUT  Y02678*/
         BAL   @14,PUTDATA                                         0369
*           PERFLIN2 = ' ';           /* BLANK OUT THE LINE    Y02678*/
@RF00368 MVI   PERFLIN2+1(OUTAPTR),C' '                            0370
         MVC   PERFLIN2+2(66,OUTAPTR),PERFLIN2+1(OUTAPTR)          0370
         MVI   PERFLIN2(OUTAPTR),C' '                              0370
*           PFNEXTL2 = OUTAPTR+LNPFLIN2;/* POINT TO NEXT LINE  Y02678*/
         SLR   @09,@09                                             0371
         IC    @09,LNPFLIN2                                        0371
         LR    @15,OUTAPTR                                         0371
         ALR   @15,@09                                             0371
         ST    @15,PFNEXTL2(,OUTAPTR)                              0371
*           PFLINEL2 = LNPFLIN2-4;    /* INSERT LENGTH OF THIS LINE
*                                                              Y02678*/
         SL    @09,@CF00049                                        0372
         STH   @09,PFLINEL2(,OUTAPTR)                              0372
*           PFBYTE2 = 0;              /* SET TO 0 FOR PUTLINE  Y02678*/
         SLR   @09,@09                                             0373
         STH   @09,PFBYTE2(,OUTAPTR)                               0373
*           GRPTR = ADDR(PFCONST2);   /* INIT PTR FOR GROUP NUMBER TO
*                                        START OF LINE         Y02678*/
         LA    GRPTR,PFCONST2(,OUTAPTR)                            0374
*           DO WHILE GRPTR < PFNEXTL2 /* TEST FOR FULL LINE          */
*            & NUM < 256;             /* OR END OF GROUPS      Y02678*/
         B     @DE00375                                            0375
@DL00375 DS    0H                                                  0376
*             IF TESTBYTE = 0         /* IS THIS BYTE FINISHED?      */
*               THEN                  /* YES,                        */
         CLI   TESTBYTE,0                                          0376
         BNE   @RF00376                                            0376
*                 DO;                 /* SET UP TO TEST NEXT BYTE  0377
*                                                              Y02678*/
*                 TESTBYTE = '80'X;   /* RESET TEST BYTE       Y02678*/
         MVI   TESTBYTE,X'80'                                      0378
*                 PERFPTR = PERFPTR+1;/* POINT TO NEXT BYTE    Y02678*/
         LA    @09,1                                               0379
         AL    @09,PERFPTR                                         0379
         ST    @09,PERFPTR                                         0379
*                 END;                                             0380
*             IF (TESTBYTE & PERFGRP) ^= 0/* IS THIS BIT ON?         */
*               THEN                  /* YES,                        */
@RF00376 SLR   @09,@09                                             0381
         IC    @09,TESTBYTE                                        0381
         L     @01,PERFPTR                                         0381
         SLR   @00,@00                                             0381
         IC    @00,PERFGRP(,@01)                                   0381
         NR    @09,@00                                             0381
         LTR   @09,@09                                             0381
         BZ    @RF00381                                            0381
*                 DO;                 /* PRINT GROUP NUMBER    Y02678*/
*                 /* CONVERT THE GROUP NUMBER TO DECIMAL       Y02678*/
*                 CVD (NUM,CVDAREA); /* CONVERT TO PACKED DECIMAL  0383
*                                                              Y02678*/
         CVD   NUM,CVDAREA                                         0383
*                 UNPK (GROUP(1:4),CVDAREA(7:8));/* CONVERT TO ZONED
*                                                   DECIMAL    Y02678*/
         UNPK  GROUP(4,GRPTR),CVDAREA+6(2)                         0384
*                 GROUP(4)=GROUP(4)'F0'X;/* REMOVE SIGN       Y02678*/
         OI    GROUP+3(GRPTR),X'F0'                                0385
*                 BYTEP = GRPTR;      /* INIT PTR TO FIRST CHARY02678*/
         LR    BYTEP,GRPTR                                         0386
*                 DO WHILE GCHAR = '0';/* LOOP TO SUPRESS LEADING  0387
*                                         ZEROS                Y02678*/
         B     @DE00387                                            0387
@DL00387 DS    0H                                                  0388
*                   GCHAR = ' ';      /* SUPPRESS IT           Y02678*/
         MVI   GCHAR(BYTEP),C' '                                   0388
*                   BYTEP = BYTEP+1;  /* INCREMENT THE BYTE COUNT  0389
*                                                              Y02678*/
         AL    BYTEP,@CF00032                                      0389
*                   END;                                           0390
@DE00387 CLI   GCHAR(BYTEP),C'0'                                   0390
         BE    @DL00387                                            0390
*                 GRPTR = GRPTR+4;    /* INCREMENT POSITION IN THE 0391
*                                        OUTPUT LINE           Y02678*/
         AL    GRPTR,@CF00049                                      0391
*                 END;                                             0392
*             TESTBYTE = TESTBYTE/2;  /* SHIFT TEST BIT TO RIGHT   0393
*                                                              Y02678*/
@RF00381 SLR   @09,@09                                             0393
         IC    @09,TESTBYTE                                        0393
         SRL   @09,1                                               0393
         STC   @09,TESTBYTE                                        0393
*             NUM = NUM+1;            /* INCREMENT GROUP NUM.  Y02678*/
         LA    NUM,1(,NUM)                                         0394
*             END;                                                 0395
@DE00375 C     GRPTR,PFNEXTL2(,OUTAPTR)                            0395
         BNL   @DC00375                                            0395
         CL    NUM,@CF00329                                        0395
         BL    @DL00375                                            0395
@DC00375 DS    0H                                                  0396
*           OUTAPTR = OUTAPTR+LNPFLIN2;/* INCREMENT OUTPUT AREA ADDRESS
*                                                              Y02678*/
         SLR   @09,@09                                             0396
         IC    @09,LNPFLIN2                                        0396
         ALR   OUTAPTR,@09                                         0396
*           OPASIZE = OPASIZE-LNPFLIN2;/* DECREMENT REMAINING LENGTH OF
*                                         BUFFER               Y02678*/
         SLR   OPASIZE,@09                                         0397
*           END;                                                   0398
@DE00367 CL    NUM,@CF00329                                        0398
         BL    @DL00367                                            0398
*PWLOOP:  /* PWLOOP WILL EXTRACT THE PASSWORD DATA FROM THE UADS     */
*         /* AND FORMAT IT IN AN OUTPUT AREA. THE DATA CONSISTS      */
*         /* OF THE PASSWORD. THE FIRST TWO WORDS OF THE LINE ARE    */
*         /* REQUIRED BY 'PUTLINE' AND ARE NOT PART OF THE OUTPUT    */
*         /* IS THERE SPACE IN THE OPAREA FOR THE PASSWORD DATA?     */
*         IF OPASIZE < LENGTH(PWDDATA)/* ENOUGH SPACE FOR DATA?      */
*           THEN                      /* NO, SEND THE DATA TO 'PUT-
*                                        LINE' AND RETURN TO PWLOOP  */
PWLOOP   C     OPASIZE,@CF00077                                    0399
         BNL   @RF00399                                            0399
*             CALL PUTDATA;           /* SEND THE DATA TO 'PUTLINE'  */
         BAL   @14,PUTDATA                                         0400
*         PWDDATA = ' ';              /* BLANK OUT LINE              */
@RF00399 MVI   PWDDATA+1(OUTAPTR),C' '                             0401
         MVC   PWDDATA+2(22,OUTAPTR),PWDDATA+1(OUTAPTR)            0401
         MVI   PWDDATA(OUTAPTR),C' '                               0401
*         BUFACAD = OUTAPTR+LNPWD;    /* PTR TO THE NEXT OUTPUT LINE */
         SLR   @09,@09                                             0402
         IC    @09,LNPWD                                           0402
         LR    @07,OUTAPTR                                         0402
         ALR   @07,@09                                             0402
         ST    @07,BUFACAD(,OUTAPTR)                               0402
*         PWLINEL = LNPWD-4;          /* LENGTH OF THIS LINE         */
         SL    @09,@CF00049                                        0403
         STH   @09,PWLINEL(,OUTAPTR)                               0403
*         PWBYTE = 0;                 /* REQUIRED BY 'PUTLINE'       */
         SLR   @09,@09                                             0404
         STH   @09,PWBYTE(,OUTAPTR)                                0404
*         /* CHECK WHETHER THE PASSWORD LEVEL IS SUPPORTED.          */
*         IF NOPWDFLG = '1'B                                       0405
*           THEN                      /* NO,                         */
         TM    NOPWDFLG,B'00000010'                                0405
         BNO   @RF00405                                            0405
*             BUFPWD(1:3) = '(*)';    /* PUT OUT '*' IN PWD POSITION */
         MVC   BUFPWD(3,OUTAPTR),@CC00466                          0406
*           ELSE                      /* YES,                        */
*             BUFPWD = UADSPPWD;      /* INSERT THE PASSWORD         */
         B     @RC00405                                            0407
@RF00405 L     @09,UADSPPTR                                        0407
         MVC   BUFPWD(8,OUTAPTR),UADSPPWD(@09)                     0407
*         OPASIZE = OPASIZE-LNPWD;    /* SUBTRACT THE SPACE USED BY
*                                        THE USERID DATA FROM THE  0408
*                                        SPACE AVAILABLE IN THE OUT-
*                                        PUT AREA                    */
@RC00405 SLR   @09,@09                                             0408
         IC    @09,LNPWD                                           0408
         SLR   OPASIZE,@09                                         0408
*         OUTAPTR = OUTAPTR+LNPWD;    /* INCREMENT THE ADDRESS OF THE
*                                        OUTPUT BUFFER               */
         ALR   OUTAPTR,@09                                         0409
*ACLOOP:  /* ACLOOP WILL EXTRACT THE ACCOUNT-NUMBER DATA FROM THE    */
*         /* UADS AND FORMAT IT IN AN OUTPUT AREA. THE DATA CON-     */
*         /* SISTS OF THE ACCOUNT-NUMBER. THE FIRST TWO WORDS OF     */
*         /* EACH LINE ARE REQUIRED BY 'PUTLINE' AND ARE NOT PART    */
*         /* OF THE OUTPUT.                                          */
*         /* IS THERE SPACE IN THE OPAREA FOR THE ACCOUNT NUMBER     */
*         /* DATA?                                                   */
*         IF OPASIZE < LENGTH(ACCTDATA)/* ENOUGH SPACE?              */
*           THEN                      /* NO, SEND THE DATA TO 'PUT-
*                                        LINE AND RETURN TO ACLOOP   */
ACLOOP   C     OPASIZE,@CF00490                                    0410
         BNL   @RF00410                                            0410
*             CALL PUTDATA;           /* SEND THE DATA TO 'PUTLINE'  */
         BAL   @14,PUTDATA                                         0411
*         ACCTDATA = ' ';             /* BLANK OUT LINE              */
@RF00410 MVI   ACCTDATA+1(OUTAPTR),C' '                            0412
         MVC   ACCTDATA+2(58,OUTAPTR),ACCTDATA+1(OUTAPTR)          0412
         MVI   ACCTDATA(OUTAPTR),C' '                              0412
*         BUFPRAD = OUTAPTR+LNACCT;   /* PTR TO THE NEXT OUTPUT LINE */
         SLR   @09,@09                                             0413
         IC    @09,LNACCT                                          0413
         LR    @07,OUTAPTR                                         0413
         ALR   @07,@09                                             0413
         ST    @07,BUFPRAD(,OUTAPTR)                               0413
*         ACLINEL = LNACCT-4;         /* LENGTH OF THIS LINE         */
         SL    @09,@CF00049                                        0414
         STH   @09,ACLINEL(,OUTAPTR)                               0414
*         ACBYTE = 0;                 /* REQUIRED BY 'PUTLINE'       */
         SLR   @09,@09                                             0415
         STH   @09,ACBYTE(,OUTAPTR)                                0415
*         /* CHECK WHETHER THE ACCTNMBR LEVEL IS SUPPORTED.          */
*         IF NOACTFLG = '1'B                                       0416
*           THEN                      /* NO,                         */
         TM    NOACTFLG,B'00000001'                                0416
         BNO   @RF00416                                            0416
*             DO;                                                  0417
*               BUFACTN(1:3) = '(*)'; /* PUT OUT AN '*' IN THE ACTNBR
*                                        POSITION OF THE OUTPUT      */
         MVC   BUFACTN(3,OUTAPTR),@CC00466                         0418
*             END;                                                 0419
*           ELSE                      /* YES,                        */
*             BUFACTN(1:UADSALEN) =   /* INSERT THE ACCTNMBR         */
*               UADSANUM;                                          0420
         B     @RC00416                                            0420
@RF00416 L     @09,UADSAPTR                                        0420
         SLR   @07,@07                                             0420
         IC    @07,UADSALEN(,@09)                                  0420
         BCTR  @07,0                                               0420
         EX    @07,@SM00515                                        0420
*         OPASIZE = OPASIZE-LNACCT;   /* SUBTRACT THE SPACE USED BY
*                                        THE ACCTNO DATA FROM THE  0421
*                                        SPACE AVAILABLE IN THE OUT-
*                                        PUT AREA                    */
@RC00416 SLR   @09,@09                                             0421
         IC    @09,LNACCT                                          0421
         SLR   OPASIZE,@09                                         0421
*         OUTAPTR = OUTAPTR+LNACCT;   /* INCREMENT THE ADDRESS OF THE
*                                        OUTPUT BUFFER               */
         ALR   OUTAPTR,@09                                         0422
*PRLOOP:  /* PRLOOP WILL EXTRACT THE PROCEDURE-NAME DATA FROM THE    */
*         /* UADS AND FORMAT IT IN AN OUTPUT AREA. THE DATA CON-     */
*         /* SISTS OF THE PROCEDURE NAME, THE PROCEDURE SIZE AND THE */
*         /* GENERIC UNIT NAME. THE FIRST TWO LINES OF EACH LINE ARE */
*         /* REQUIRED BY 'PUTLINE' AND ARE NOT PART OF THE OUTPUT.   */
*         /* IS THERE SPACE IN THE OPAREA FOR THE PROCEDURE DATA?    */
*         IF OPASIZE < LENGTH(PROCDATA)/* ENOUGH SPACE?              */
*           THEN                      /* NO,                         */
PRLOOP   C     OPASIZE,@CF00491                                    0423
         BNL   @RF00423                                            0423
*             CALL PUTDATA;           /* GO TO PUT OUT THE LAST DATA */
         BAL   @14,PUTDATA                                         0424
*         PROCDATA = ' ';             /* BLANK OUT LINE              */
@RF00423 MVI   PROCDATA+1(OUTAPTR),C' '                            0425
         MVC   PROCDATA+2(62,OUTAPTR),PROCDATA+1(OUTAPTR)          0425
         MVI   PROCDATA(OUTAPTR),C' '                              0425
*         /* START FORMATTING THE PROCNAME DATA.                     */
*         PRNEXTL1 = OUTAPTR+LNPROC;  /* PTR TO THE NEXT OUTPUT LINE */
         SLR   @09,@09                                             0426
         IC    @09,LNPROC                                          0426
         LR    @07,OUTAPTR                                         0426
         ALR   @07,@09                                             0426
         ST    @07,PRNEXTL1(,OUTAPTR)                              0426
*         PRLINEL1 = LNPROC-4;        /* LENGTH OF THIS LINE         */
         SL    @09,@CF00049                                        0427
         STH   @09,PRLINEL1(,OUTAPTR)                              0427
*         PRBYTE1 = 0;                /* REQUIRED BY 'PUTLINE'       */
         SLR   @09,@09                                             0428
         STH   @09,PRBYTE1(,OUTAPTR)                               0428
*         BUFPROC = UADSRNAM;         /* INSERT THE PROCEDURE NAME   */
         L     @09,UADSRPTR                                        0429
         MVC   BUFPROC(8,OUTAPTR),UADSRNAM(@09)                    0429
*         PRCONST1 = '  PROCSIZE= ';  /* CONSTANT TEXT               */
         MVC   PRCONST1(12,OUTAPTR),@CC00469                       0430
*         PRCONST2 = 'K, ';           /* CONSTANT TEXT               */
         MVC   PRCONST2(3,OUTAPTR),@CC00471                        0431
*         /* INSERT ONE ZERO IF PROCSIZE = 0. LEADING ZEROS WILL BE  */
*         /* SUPPRESSED.                                             */
*         IF UADSRSIZ = 0                                          0432
*           THEN                      /* YES, PROCSIZE = 0           */
         LH    @09,UADSRSIZ(,@09)                                  0432
         N     @09,@CF00514                                        0432
         LTR   @09,@09                                             0432
         BNZ   @RF00432                                            0432
*               PRSIZE = '    0';     /* INSERT ONE ZERO             */
         MVC   PRSIZE(5,OUTAPTR),@CC00472                          0433
*           ELSE                                                   0434
*             DO;                                                  0434
         B     @RC00432                                            0434
@RF00432 DS    0H                                                  0435
*             /* CONVERT PROCSIZE GIVEN IN UADS TO DECIMAL FORM      */
*             CVD (UADSRSIZ,CVDAREA); /* CONVERT TO PACKED DECIMAL   */
         L     @09,UADSRPTR                                        0435
         LH    @09,UADSRSIZ(,@09)                                  0435
         N     @09,@CF00514                                        0435
         CVD   @09,CVDAREA                                         0435
*             UNPK (PRSIZE(1:5),CVDAREA(6:8));/*CONVERT TO ZONED DEC.*/
         UNPK  PRSIZE(5,OUTAPTR),CVDAREA+5(3)                      0436
*             PRSIZE(5)=PRSIZE(5)'F0'X;/* REMOVE SIGN               */
         OI    PRSIZE+4(OUTAPTR),X'F0'                             0437
*             BCNT = 1;               /* INITIALIZE THE BYTE COUNT   */
         LA    BCNT,1                                              0438
*             /* SUPPRESS LEADING ZEROS.                             */
*             DO WHILE PRSIZE(BCNT) = '0';                         0439
         B     @DE00439                                            0439
@DL00439 DS    0H                                                  0440
*               PRSIZE(BCNT) = ' ';   /* SUPPRESS IT                 */
         LR    @09,OUTAPTR                                         0440
         ALR   @09,BCNT                                            0440
         MVI   PRSIZE-1(@09),C' '                                  0440
*               BCNT = BCNT+1;        /* INCREMENT THE BYTE COUNT    */
         LA    BCNT,1(,BCNT)                                       0441
*             END;                                                 0442
@DE00439 LR    @09,OUTAPTR                                         0442
         ALR   @09,BCNT                                            0442
         CLI   PRSIZE-1(@09),C'0'                                  0442
         BE    @DL00439                                            0442
*           END;                                                   0443
*         PRCONST3 = 'UNIT NAME= ';   /* CONSTANT TEXT               */
@RC00432 MVC   PRCONST3(11,OUTAPTR),@CC00473                       0444
*         IF UADSUNAM(1) = ' '                                     0445
*           THEN                      /* NO UNIT NAME IS SPECIFIED   */
         L     @09,UADSRPTR                                        0445
         CLI   UADSUNAM(@09),C' '                                  0445
         BNE   @RF00445                                            0445
*             UNITNAME = '(NONE)  ';  /* PUT OUT (NONE)              */
         MVC   UNITNAME(8,OUTAPTR),@CC00475                        0446
*           ELSE                                                   0447
*             UNITNAME = UADSUNAM;    /* INSERT THE UNIT NAME        */
         B     @RC00445                                            0447
@RF00445 L     @09,UADSRPTR                                        0447
         MVC   UNITNAME(8,OUTAPTR),UADSUNAM(@09)                   0447
*         OPASIZE = OPASIZE-LNPROC;   /* SUBTRACT THE SPACE USED BY
*                                        THE USERID DATA FROM THE  0448
*                                        SPACE AVAILABLE IN THE OUT-
*                                        PUT AREA                    */
@RC00445 SLR   @09,@09                                             0448
         IC    @09,LNPROC                                          0448
         SLR   OPASIZE,@09                                         0448
*         OUTAPTR = OUTAPTR+LNPROC;   /* INCREMENT THE ADDRESS OF THE
*                                        OUTPUT BUFFER               */
         ALR   OUTAPTR,@09                                         0449
*         GOTO PRRTRN;                /* GO CHECK WHERE PROCESSING IS
*                                        TO CONTINUE                 */
         B     PRRTRN                                              0450
*MPREP:   /* CONTROL PASSED HERE WHEN A MESSAGE WITH USERID INSER-   */
*         /* TION HAS TO BE PUT OUT.                                 */
*         MSGNO = 3;                  /* SET THE MSG NUMBER          */
MPREP    LA    MSGNO,3                                             0451
*         MSGFIND = (MSGNO*2)-2       /* CALCULATE ADDR OF OFFSET TO */
*           +ADDR(LSTMSG);            /* MSG IN THE MSG CSECT        */
         LR    MSGFIND,MSGNO                                       0452
         ALR   MSGFIND,MSGFIND                                     0452
         BCTR  MSGFIND,0                                           0452
         BCTR  MSGFIND,0                                           0452
         L     @09,@CV00141                                        0452
         ALR   MSGFIND,@09                                         0452
*         MSGPTR = MOFFSET            /* CALCULATE ADDR OF MSG       */
*           +ADDR(LSTMSG);            /* ..HEADER IN THE MSG CSECT   */
         L     MSGPTR,@CV00141                                     0453
         AH    MSGPTR,MOFFSET(,MSGFIND)                            0453
*         MINDX = (SGNO1*4)+8;        /* DETERMINE SIZE OF MSG OLDS  */
         L     MINDX,SGNO1(,MSGPTR)                                0454
         SLA   MINDX,2                                             0454
         AL    MINDX,@CF00040                                      0454
*         AMSGHDR1(1:MINDX) =         /* TRANSFER MSG HEADER TO..    */
*           PTRMASK1;                 /* ..DYNAMIC HEADER AREA       */
         LR    @09,MINDX                                           0455
         BCTR  @09,0                                               0455
         EX    @09,@SM00517                                        0455
*         SEGPTR13 = ADDR(INSRT1);    /* SET PTR TO ACTIVE INSERT    */
         LA    @09,INSRT1                                          0456
         ST    @09,SEGPTR13                                        0456
*         INSRTL1 = USRLEN+4;         /* LENGTH OF MSG SEGMENT       */
         L     @09,NODELADR(,CTABPTR)                              0457
         SLR   @07,@07                                             0457
         IC    @07,USRLEN(,@09)                                    0457
         LA    @01,4(,@07)                                         0457
         STH   @01,INSRTL1                                         0457
*         INSRTO1 = 10;               /* INIT SEGMENT OFFSET         */
         MVC   INSRTO1(2),@CH00059                                 0458
*         INSRTT1 = USRID(1:USRLEN);  /* INSERT THE USERID           */
         MVI   INSRTT1+1,C' '                                      0459
         MVC   INSRTT1+2(38),INSRTT1+1                             0459
         BCTR  @07,0                                               0459
         EX    @07,@SM00519                                        0459
*         GEN (PUTLINE OUTPUT=(AMSGHDR1,,MULTLVL,INFOR),MF=(E,PLPLIST))
*           REFS(AMSGHDR1,PLPLIST);                                0460
         PUTLINE OUTPUT=(AMSGHDR1,,MULTLVL,INFOR),MF=(E,PLPLIST)
*         RFY R15 RSTD;                                            0461
*         RTNCODE = R15;              /* SAVE THE RETURN CODE        */
         LR    RTNCODE,R15                                         0462
*         RFY R15 UNRSTD;                                          0463
*         /* CHECK THE PUTLINE RETURN CODE.                          */
*         IF RTNCODE ^= 0             /* SUCCESSFUL?                 */
*           THEN                      /* NO,                         */
         LTR   RTNCODE,RTNCODE                                     0464
         BZ    @RF00464                                            0464
*             DO;                                                  0465
*PUTERR:      IF RTNCODE = 4                                       0466
*               THEN                  /* YES,                        */
PUTERR   C     RTNCODE,@CF00049                                    0466
         BE    @RT00466                                            0466
*                 GOTO CLEANUP;       /* GO CLEAN UP & RETURN        */
*             /* GETMAIN FAILURE?                                    */
*             IF RTNCODE = 16                                      0468
*               THEN                  /* YES,                        */
         C     RTNCODE,@CF00042                                    0468
         BNE   @RF00468                                            0468
*                 MSGNO = 2;          /* 'NOT ENOUGH SPACE'          */
         LA    MSGNO,2                                             0469
*               ELSE                                               0470
*                 MSGNO = 13;         /* 'PUTLINE FAILURE'           */
         B     @RC00468                                            0470
@RF00468 LA    MSGNO,13                                            0470
*             GOTO CLEANUP;           /* GO CLEAN UP & RETURN        */
         B     CLEANUP                                             0471
*             END;                                                 0472
*         GOTO MORUS;                 /* CHECK FOR MORE USERS        */
         B     MORUS                                               0473
*DATACHK: /* IS THERE ANY DATA LEFT TO BE PUT OUT?                   */
*         IF OPASIZE ^= 1000                                       0474
*           THEN                      /* NO, FORMATTED DATA IS LEFT
*                                        IN THE OUTPUT AREA          */
DATACHK  C     OPASIZE,@CF00386                                    0474
         BE    @RF00474                                            0474
*             CALL PUTDATA;           /* SEND THE DATA TO 'PUTLINE'  */
         BAL   @14,PUTDATA                                         0475
*         /* CHECK WHETHER A VALID BRANCH HAS BEEN FOUND.            */
*         IF VALDAT = '1'B                                         0476
*           THEN                      /* YES,                        */
@RF00474 TM    VALDAT,B'00001000'                                  0476
         BO    @RT00476                                            0476
*             GOTO CLEANUP;           /* CLEANUP AND RETURN          */
*         /* CHECK WHETHER THE SPECIFIED PASSWORD WAS FOUND.         */
*         IF PASSWD(1:2) ^= '* '      /* WAS PASSWORD SPECIFIED?     */
*          & PWFNDFLG = '0'B          /* AND NOT FOUND?              */
*           THEN                      /* YES,                        */
         L     @09,NODELADR(,CTABPTR)                              0478
         CLC   PASSWD(2,@09),@CC00407                              0478
         BE    @RF00478                                            0478
         TM    PWFNDFLG,B'10000000'                                0478
         BNZ   @RF00478                                            0478
*             DO;                                                  0479
*               MSGNO = 5;            /* SET ERRMSG NUMBER: 'SPECIFIED
*                                        PASSWORD NOT FOUND'         */
         LA    MSGNO,5                                             0480
*               GOTO CLEANUP;         /* CLEAN UP & RETURN           */
         B     CLEANUP                                             0481
*             END;                                                 0482
*         /* THE PASSWORD WAS FOUND. THIS MEANS THAT EITHER THE      */
*         /* SPECIFIED ACCTNMBR OR PROCNAME WAS NOT FOUND.           */
*         IF ACCTNO(1:2) ^= '* '      /* ACTNO SPECIFIED?            */
*          & ACFNDFLG = '0'B          /* ACTNO FOUND?                */
*           THEN                      /* NO,                         */
@RF00478 L     @09,NODELADR(,CTABPTR)                              0483
         CLC   ACCTNO(2,@09),@CC00407                              0483
         BE    @RF00483                                            0483
         TM    ACFNDFLG,B'01000000'                                0483
         BNZ   @RF00483                                            0483
*             MSGNO = 6;              /* SET ERRMSG NUMBER: 'SPECIFIED
*                                        ACCTNMBR NOT FOUND'         */
         LA    MSGNO,6                                             0484
*           ELSE                                                   0485
*             IF PROCNM(1:2) ^= '* '  /* WAS A PROC SPECIFIED?       */
*               THEN                  /* YES,                        */
         B     @RC00483                                            0485
@RF00483 L     @09,NODELADR(,CTABPTR)                              0485
         CLC   PROCNM(2,@09),@CC00407                              0485
         BE    @RF00485                                            0485
*                 MSGNO = 7;          /* SET ERRMSG NUMBER: 'SPECIFIED
*                                        PROCNAME NOT FOUND'         */
         LA    MSGNO,7                                             0486
*CLEANUP: /* THE LIST FORMATTING ROUTINE HAS COMPLETED PROCESSING.   */
*         /* PERFORM THE NECESSARY CLEANUP & RETURN TO THE LIST CP.  */
*         /* TRANSFER THE MESSAGE NUMBER INTO THE CONTROL TABLE.     */
*         IF MSGNO = 3                /* HAS GETMAIN ERROR OCCURRED? */
*          & VALDAT = '0'B            /* HAS WORK BEEN DONE?         */
*           THEN                      /* NO WORK DONE,               */
@RF00485 DS    0H                                                  0487
@RC00483 DS    0H                                                  0487
CLEANUP  C     MSGNO,@CF00219                                      0487
         BNE   @RF00487                                            0487
         TM    VALDAT,B'00001000'                                  0487
         BNZ   @RF00487                                            0487
*             MSGNO = 30;             /* SET MESSAGE NUMBER          */
         LA    MSGNO,30                                            0488
*         MSGNMBR = MSGNO;                                         0489
@RF00487 ST    MSGNO,MSGNMBR(,CTABPTR)                             0489
*         /* CHECK WHETHER THE TREE BUFFER HAS TO BE FREED.          */
*         IF FREEFLG = '1'B                                        0490
*           THEN                      /* NO,                         */
         TM    FREEFLG,B'00000100'                                 0490
         BNO   @RF00490                                            0490
*             DO;                                                  0491
*             RFY R1 RSTD;                                         0492
*             R1 = ACIOPTR;           /* ADDR OF WRITE PARMLIST      */
         L     R1,ACIOPTR                                          0493
*             /* THE WRITE RTNE WILL FREE THE READ BUFFER.           */
*             CALL IKJEFA52;                                       0494
         L     @15,@CV00143                                        0494
         BALR  @14,@15                                             0494
*             RFY R1 UNRSTD;                                       0495
*             END;                                                 0496
*         IF ACIODCBA ^= 0            /* IS THERE A BPAM DCB?        */
*           THEN                      /* YES,                        */
@RF00490 L     @01,ACIOPTR                                         0497
         L     @15,ACIODCBA-1(,@01)                                0497
         LA    @15,0(,@15)                                         0497
         LTR   @15,@15                                             0497
         BZ    @RF00497                                            0497
*             DO;                                                  0498
*             /* CHECK THE OPEN FLAG IN THE UADS DCB. IF THE DCB IS  */
*             /* OPEN (FLAG=1), THE 'CLOSE' MACRO WILL BE ISSUED.    */
*             RFY R2 RSTD;            /* RESTRICT DCB REGISTER       */
*             R2 = ACIODCBA;          /* LOAD ADDR OF DCB INTO REG2  */
         LR    R2,@15                                              0500
*             IF DCBOFLAG = '1'B      /* IS THE UADS DCB OPEN?       */
*               THEN                  /* YES,                        */
         TM    DCBOFLAG,B'00010000'                                0501
         BNO   @RF00501                                            0501
*                 GEN (CLOSE ((R2)),MF=(E,CLOSDYN))                0502
*                   REFS(CLOSDYN,R2);                              0502
         CLOSE ((R2)),MF=(E,CLOSDYN)
*             END;                                                 0503
@RF00501 DS    0H                                                  0504
*/* RETURN TO THE CALLER, IKJEFA40.                                  */
*         RETURN CODE(RTNCODE);                                    0504
@RF00497 L     @13,4(,@13)                                         0504
         L     @00,@SIZDATD                                        0504
         LR    @01,@11                                             0504
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0504
         L     @14,12(,@13)                                        0504
         LM    @00,@12,20(@13)                                     0504
         BR    @14                                                 0504
*PUTDATA: /********************************************************* */
*         /*                                                         */
*         /*           PUT THE DATA EXTRACTED FROM THE               */
*         /*              UADS OUT TO THE TERMINAL                   */
*         /*                                                         */
*         /***********************************************************/
*         PROC;                                                    0505
PUTDATA  STM   @14,@03,@SA00002                                    0505
         ST    @05,@SA00002+24                                     0505
         STM   @07,@09,@SA00002+28                                 0505
         STM   @11,@12,@SA00002+40                                 0505
*         /* BEFORE PASSING CONTROL TO PUTLINE, CHECK THE ATTENTION  */
*         /* EXIT BIT IN THE ECB.                                    */
*         IF ATTENTN = '1'B                                        0506
*           THEN                      /* THE EXIT BIT IS ON,         */
         L     @09,ACCTPLP(,CTABPTR)                               0506
         L     @09,ACCTECBP(,@09)                                  0506
         TM    ATTENTN(@09),B'01000000'                            0506
         BNO   @RF00506                                            0506
*             RETURN TO CLEANUP;      /* GO CLEAN UP & RETURN        */
         LA    @14,CLEANUP                                         0507
         LM    @15,@03,@SA00002+4                                  0507
         L     @05,@SA00002+24                                     0507
         LM    @07,@09,@SA00002+28                                 0507
         LM    @11,@12,@SA00002+40                                 0507
         BR    @14                                                 0507
*         NEXTLN1 = 0;                /* PTR TO NEXT LINE = 0        */
@RF00506 SLR   @09,@09                                             0508
         ST    @09,NEXTLN1(,OUTAPTR)                               0508
*         USLNL1 = 4;                 /* COUNT = 4                   */
         MVC   USLNL1(2,OUTAPTR),@CH00049                          0509
*         GEN (PUTLINE OUTPUT=(OUTPAREA,,MULTLIN,DATA),MF=(E,PLPLIST))
*           REFS(PLPLIST,OUTPAREA);                                0510
         PUTLINE OUTPUT=(OUTPAREA,,MULTLIN,DATA),MF=(E,PLPLIST)
*         RFY R15 RSTD;                                            0511
*         RTNCODE = R15;              /* SAVE THE RETURN CODE        */
         LR    RTNCODE,R15                                         0512
*         RFY R15 UNRSTD;                                          0513
*         /* CHECK THE PUTLINE RETURN CODE.                          */
*         IF RTNCODE ^= 0             /* WAS PUTLINE SUCCESSFUL?     */
*           THEN                      /* NO, CHECK THE CODE          */
         LTR   RTNCODE,RTNCODE                                     0514
         BZ    @RF00514                                            0514
*             RETURN TO PUTERR;                                    0515
         LA    @14,PUTERR                                          0515
         LM    @15,@03,@SA00002+4                                  0515
         L     @05,@SA00002+24                                     0515
         LM    @07,@09,@SA00002+28                                 0515
         LM    @11,@12,@SA00002+40                                 0515
         BR    @14                                                 0515
*         OUTAPTR = ADDR(OUTPAREA);   /* RESET POINTER TO START OF 0516
*                                        OUTPUT BUFFER               */
@RF00514 LA    OUTAPTR,OUTPAREA                                    0516
*         OPASIZE = 1000;             /* RESET SIZE TO 1000          */
         LA    OPASIZE,1000                                        0517
*         END PUTDATA;                                             0518
@EL00002 DS    0H                                                  0518
@EF00002 DS    0H                                                  0518
@ER00002 LM    @14,@03,@SA00002                                    0518
         L     @05,@SA00002+24                                     0518
         LM    @07,@09,@SA00002+28                                 0518
         LM    @11,@12,@SA00002+40                                 0518
         BR    @14                                                 0518
*         END IKJEFA42                                             0519
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        *
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*;                                                                 0519
@DATA    DS    0H
@CH00174 DC    H'5'
@CH00059 DC    H'10'
@SM00496 MVC   CPLS(0),MCPLS
@SC00508 CLC   UADSANUM(0,@02),ACCTNO(@15)
@SM00510 MVC   USIDDATA+255(0,OUTAPTR),@TS00001
@SM00512 MVC   BUFUSID(0,OUTAPTR),UADSUSER(HEDBPTR)
@SM00515 MVC   BUFACTN(0,OUTAPTR),UADSANUM(@09)
@SM00517 MVC   AMSGHDR1(0),PTRMASK1(MSGPTR)
@SM00519 MVC   INSRTT1(0),USRID(@09)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    12F
@TF00001 DS    F
IKJEFA42 CSECT
         DS    0F
@CF00032 DC    F'1'
@CF00113 DC    F'2'
@CF00219 DC    F'3'
@CF00049 DC    F'4'
@CH00049 EQU   @CF00049+2
@CF00040 DC    F'8'
@CF00236 DC    F'12'
@CF00042 DC    F'16'
@CF00077 DC    F'24'
@CF00369 DC    F'44'
@CF00490 DC    F'60'
@CF00491 DC    F'64'
@CF00329 DC    F'256'
@CF00486 DC    F'334'
@CF00386 DC    F'1000'
@CF00514 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
UADSPPTR DS    A
UADSAPTR DS    A
UADSRPTR DS    A
UPTPTR   DS    A
ACIOPTR  DS    A
PWDBROTH DS    A
ACTBROTH DS    A
PROBROTH DS    A
PERFPTR  DS    A
TESTBYTE DS    FL1
@TS00001 DS    CL256
INDIC    DS    CL2
         ORG   INDIC
USIND    DS    BL1
PWIND    EQU   INDIC+0
ACIND    EQU   INDIC+0
PRIND    EQU   INDIC+0
VALDAT   EQU   INDIC+0
FREEFLG  EQU   INDIC+0
NOPWDFLG EQU   INDIC+0
NOACTFLG EQU   INDIC+0
PWFNDFLG DS    BL1
ACFNDFLG EQU   INDIC+1
NEXTUSER EQU   INDIC+1
         ORG   INDIC+2
UPTBIN   DS    CL17
OUTPAREA DS    CL1008
CVDAREA  DS    CL8
PLPLIST  DS    CL16
AMSGHDR1 DS    CL32
         ORG   AMSGHDR1
@NM00051 DS    AL4
@NM00052 DS    3A
SEGPTR13 DS    AL4
@NM00053 DS    3A
         ORG   AMSGHDR1+32
INSRT1   DS    CL44
         ORG   INSRT1
INSRTL1  DS    AL2
INSRTO1  DS    AL2
INSRTT1  DS    CL40
         ORG   INSRT1+44
IKJEFA42 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00141 DC    V(LSTMSG)
@CV00142 DC    V(IKJEFA51)
@CV00143 DC    V(IKJEFA52)
         DS    0D
LNUSID   DC    AL2(334)
LNUSLIN1 DC    AL1(72)
LNUSLIN2 DC    AL1(60)
LNUSLIN3 DC    AL1(44)
LNUSLIN4 DC    AL1(40)
LNUSLIN5 DC    AL1(60)
LNUSLIN6 DC    AL1(58)
LNPFLIN1 DC    AL1(44)
LNPFLIN2 DC    AL1(68)
LNPWD    DC    AL1(24)
LNACCT   DC    AL1(60)
LNPROC   DC    AL1(64)
@CC00438 DC    C'INSTALLATION ATTRIBUTES, IN HEX: '
@CC00460 DC    C'NO PERFORMANCE GROUPS'
@CC00462 DC    C'PERFORMANCE GROUPS:  '
@CC00428 DC    C'  USER ATTRIBUTES:  '
@CC00452 DC    C'USER PROFILE TABLE: '
@CC00458 DC    C'CENTRAL SITE DEFAULT'
@CC00455 DC    C'DESTINATION  =  '
@CC00469 DC    C'  PROCSIZE= '
@CC00473 DC    C'UNIT NAME= '
@CC00446 DC    C'          '
@CC00450 DC    C'K BYTES   '
@CC00443 DC    C'MAXSIZE: '
@CC00475 DC    C'(NONE)  '
@CC00436 DC    C'NOMOUNT'
@CC00437 DC    C'  MOUNT'
@CC00430 DC    C'NOOPER'
@CC00431 DC    C'  OPER'
@CC00432 DC    C'NOACCT'
@CC00433 DC    C'  ACCT'
@CC00434 DC    C'NOJCL'
@CC00435 DC    C'  JCL'
@CC00445 DC    C'NOLIM'
@CC00472 DC    C'    0'
@CC00466 DC    C'(*)'
@CC00471 DC    C'K, '
@CC00407 DC    C'* '
HEXREP   DS    CL256
         ORG   HEXREP
@NM00048 DC    240CL1' '
@NM00049 DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
         ORG   HEXREP+256
@DATD    DSECT
IKJEFA42 CSECT
MCPLS    DS   0D
         CLOSE (,REREAD),MF=L
         PUTLINE OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L
         DCB   DDNAME=SYSUADS,RECFM=FB,DSORG=PO,MACRF=(R)
         OPEN  (,INPUT),MF=L
MCPLNG   DC    A(*-MCPLS)               LENGTH OF MODEL PARAMETER LIST
         DCBD  DSORG=(BS),DEVD=(DA)
@DATD    DSECT                          REESTABLISH AUTOMATIC DSECT
CPLS     DS    0D
CLOSDYN  CLOSE (,REREAD),MF=L
PBLOK    PUTLINE OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L
UADBLOC  DCB   DDNAME=SYSUADS,RECFM=FB,DSORG=PO,MACRF=(R)
OPENBLK  OPEN  (,INPUT),MF=L
IKJEFA42 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFA42 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MINDX    EQU   @03
MSGNO    EQU   @08
MSGPTR   EQU   @02
MSGFIND  EQU   @03
RTNCODE  EQU   @10
NUM      EQU   @07
GRPTR    EQU   @02
BYTEP    EQU   @09
OPASIZE  EQU   @06
OUTAPTR  EQU   @04
LEVL     EQU   @09
BCNT     EQU   @02
CTABPTR  EQU   @05
IOPLPTR  EQU   @02
DROBPTR  EQU   @02
DNOBPTR  EQU   @07
DPOBPTR  EQU   @02
HEDBPTR  EQU   @03
R1       EQU   @01
R2       EQU   @02
R15      EQU   @15
DHED     EQU   0
UADSMHDR EQU   DHED
UADSUSER EQU   UADSMHDR+4
UADSBN01 EQU   UADSMHDR+12
UADSEXPF EQU   UADSBN01+1
UADSMAXC EQU   UADSMHDR+14
UADSATTR EQU   DHED+16
USATR00  EQU   UADSATTR
USATR01  EQU   UADSATTR
USATR02  EQU   UADSATTR
USATR03  EQU   UADSATTR
UADSINST EQU   DHED+18
UADSUPTP EQU   DHED+20
UADSPWD1 EQU   DHED+24
UADSPERP EQU   DHED+28
UADSDEST EQU   DHED+32
DPOB     EQU   0
UADSPNEX EQU   DPOB+1
UADSPSUB EQU   DPOB+4
UADSPDAT EQU   DPOB+8
DNOB     EQU   0
AFLG01   EQU   DNOB
UADSANEX EQU   DNOB+1
UADSASUB EQU   DNOB+4
UADSADAT EQU   DNOB+8
DROB     EQU   0
FLGR01   EQU   DROB
UADSRNEX EQU   DROB+1
UADSRDAT EQU   DROB+8
DPOBD    EQU   0
UADSPPWD EQU   DPOBD+4
DNOBD    EQU   0
UADSALEN EQU   DNOBD+44
UADSANUM EQU   DNOBD+45
DROBD    EQU   0
UADSRNAM EQU   DROBD+4
UADSRSIZ EQU   DROBD+14
UADSUNAM EQU   DROBD+16
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTPREFX EQU   UPT+16
ACCTPL   EQU   0
ACCTECBP EQU   ACCTPL+8
@NM00019 EQU   0
ATTENTN  EQU   @NM00019
CTAB     EQU   0
ACCTPLP  EQU   CTAB
NODELADR EQU   CTAB+4
RWPLADR  EQU   CTAB+8
MSGNMBR  EQU   CTAB+12
NLSTTAB  EQU   0
USRLEN   EQU   NLSTTAB
USRID    EQU   NLSTTAB+1
PASSWD   EQU   NLSTTAB+9
ACTLEN   EQU   NLSTTAB+17
ACCTNO   EQU   NLSTTAB+18
PROCNM   EQU   NLSTTAB+58
ACIOPARM EQU   0
@NM00021 EQU   ACIOPARM
ACIOFL03 EQU   @NM00021
ACIODCBA EQU   ACIOPARM+1
ACIOMPTR EQU   ACIOPARM+4
ACIOLINK EQU   ACIOPARM+12
ACIOBUFR EQU   ACIOPARM+17
@NM00028 EQU   0
MEMNAME  EQU   @NM00028+4
GROUP    EQU   0
PERFGRP  EQU   0
GCHAR    EQU   0
USIDDATA EQU   0
USIDLIN1 EQU   USIDDATA
NEXTLN1  EQU   USIDLIN1
USLNL1   EQU   USIDLIN1+4
USBYTE1  EQU   USIDLIN1+6
BUFUSID  EQU   USIDLIN1+11
USCONST1 EQU   USIDLIN1+18
OPERATTR EQU   USIDLIN1+38
ACCTATTR EQU   USIDLIN1+46
JCLATTR  EQU   USIDLIN1+54
MONTATTR EQU   USIDLIN1+61
USIDLIN2 EQU   USIDDATA+72
NEXTLN2  EQU   USIDLIN2
USLNL2   EQU   USIDLIN2+4
USBYTE2  EQU   USIDLIN2+6
USCONST2 EQU   USIDLIN2+20
INSTATTR EQU   USIDLIN2+53
USIDLIN3 EQU   USIDDATA+132
NEXTLN3  EQU   USIDLIN3
USLNL3   EQU   USIDLIN3+4
USBYTE3  EQU   USIDLIN3+6
USCONS3A EQU   USIDLIN3+20
USMAXSZ  EQU   USIDLIN3+29
USCONS3B EQU   USIDLIN3+34
USIDLIN4 EQU   USIDDATA+176
NEXTLN4  EQU   USIDLIN4
USLNL4   EQU   USIDLIN4+4
USBYTE4  EQU   USIDLIN4+6
USCONST4 EQU   USIDLIN4+20
USIDLIN5 EQU   USIDDATA+216
NEXTLN5  EQU   USIDLIN5
USLNL5   EQU   USIDLIN5+4
USBYTE5  EQU   USIDLIN5+6
UPTHEX   EQU   USIDLIN5+20
UPTUSID  EQU   USIDLIN5+53
USIDLIN6 EQU   USIDDATA+276
NEXTLN6  EQU   USIDLIN6
USLNL6   EQU   USIDLIN6+4
USBYTE6  EQU   USIDLIN6+6
USCONST6 EQU   USIDLIN6+20
DESTINAT EQU   USIDLIN6+36
PERFLIN1 EQU   0
PFNEXTL1 EQU   PERFLIN1
PFLINEL1 EQU   PERFLIN1+4
PFBYTE1  EQU   PERFLIN1+6
PFCONST1 EQU   PERFLIN1+20
PERFLIN2 EQU   0
PFNEXTL2 EQU   PERFLIN2
PFLINEL2 EQU   PERFLIN2+4
PFBYTE2  EQU   PERFLIN2+6
PFCONST2 EQU   PERFLIN2+20
PWDDATA  EQU   0
BUFACAD  EQU   PWDDATA
PWLINEL  EQU   PWDDATA+4
PWBYTE   EQU   PWDDATA+6
BUFPWD   EQU   PWDDATA+13
ACCTDATA EQU   0
BUFPRAD  EQU   ACCTDATA
ACLINEL  EQU   ACCTDATA+4
ACBYTE   EQU   ACCTDATA+6
BUFACTN  EQU   ACCTDATA+15
PROCDATA EQU   0
PRNEXTL1 EQU   PROCDATA
PRLINEL1 EQU   PROCDATA+4
PRBYTE1  EQU   PROCDATA+6
BUFPROC  EQU   PROCDATA+17
PRCONST1 EQU   PROCDATA+25
PRSIZE   EQU   PROCDATA+37
PRCONST2 EQU   PROCDATA+42
PRCONST3 EQU   PROCDATA+45
UNITNAME EQU   PROCDATA+56
MOFFSET  EQU   0
PTRMASK1 EQU   0
SGNO1    EQU   PTRMASK1+4
DCBOFLAG EQU   DCBOFLGS
ATTRBIN  EQU   UADSINST
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00054 EQU   DCBOFLGS
@NM00050 EQU   PTRMASK1
@NM00047 EQU   PROCDATA+8
@NM00046 EQU   ACCTDATA+8
@NM00045 EQU   PWDDATA+21
@NM00044 EQU   PWDDATA+8
@NM00043 EQU   PERFLIN2+8
@NM00042 EQU   PERFLIN1+41
@NM00041 EQU   PERFLIN1+8
@NM00040 EQU   USIDLIN6+8
@NM00039 EQU   USIDLIN5+8
@NM00038 EQU   USIDLIN4+8
@NM00037 EQU   USIDLIN3+8
@NM00036 EQU   USIDLIN2+58
@NM00035 EQU   USIDLIN2+8
@NM00034 EQU   USIDLIN1+68
@NM00033 EQU   USIDLIN1+59
@NM00032 EQU   USIDLIN1+52
@NM00031 EQU   USIDLIN1+44
@NM00030 EQU   USIDLIN1+8
@NM00029 EQU   @NM00028
@NM00027 EQU   ACIOPARM+21
@NM00026 EQU   ACIOPARM+20
@NM00025 EQU   ACIOPARM+16
@NM00024 EQU   ACIOPARM+8
@NM00023 EQU   @NM00021
@NM00022 EQU   @NM00021
@NM00020 EQU   @NM00019
@NM00018 EQU   ACCTPL+16
@NM00017 EQU   ACCTPL+12
@NM00016 EQU   ACCTPL
UPTPREFL EQU   UPT+23
@NM00015 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00014 EQU   UPT
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
@NM00013 EQU   DROBD+12
@NM00012 EQU   DROBD+1
UADSRCTR EQU   DROBD
UADSADRF EQU   DNOBD+4
@NM00011 EQU   DNOBD+1
UADSACTR EQU   DNOBD
@NM00010 EQU   DPOBD+1
UADSPCTR EQU   DPOBD
@NM00009 EQU   DROB+4
@NM00008 EQU   DROB
@NM00007 EQU   DNOB
@NM00006 EQU   DPOB
PFLG01   EQU   DPOB
@NM00005 EQU   DHED+44
UADSSOUT EQU   DHED+43
UADSSUBM EQU   DHED+42
UADSSUBC EQU   DHED+41
UADSSUBH EQU   DHED+40
@NM00004 EQU   UADSATTR
USATR04  EQU   UADSATTR
@NM00003 EQU   UADSATTR
@NM00002 EQU   UADSBN01+1
UADSXUSD EQU   UADSBN01+1
UADSXBLK EQU   UADSBN01+1
UADSNUSP EQU   UADSBN01+1
@NM00001 EQU   UADSBN01
UADSFSQP EQU   UADSMHDR+2
UADSBLNG EQU   UADSMHDR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00084 EQU   DATACHK
@RT00098 EQU   CLEANUP
@RT00116 EQU   READOK
@RT00130 EQU   MPREP
@RT00135 EQU   DATACHK
@RC00137 EQU   CLEANUP
@RT00149 EQU   MORUS
@RF00149 EQU   PWSRCH
@RT00169 EQU   MORUS
@RF00169 EQU   ACSRCH
@RT00186 EQU   PRSRCH
@RT00197 EQU   PRLOOP
@RT00199 EQU   ACLOOP
@RT00201 EQU   PWLOOP
@RF00216 EQU   MORUS
@RF00230 EQU   MORUS
@RF00249 EQU   MORUS
@RF00271 EQU   MORUS
@RT00466 EQU   CLEANUP
@RC00468 EQU   CLEANUP
@RF00464 EQU   MORUS
@RT00476 EQU   CLEANUP
@ENDDATA EQU   *
         END   IKJEFA42,(C'PLS1031',0701,78174)

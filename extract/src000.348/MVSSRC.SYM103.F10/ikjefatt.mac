         TITLE 'IKJEFATT          ATTRIB COMMAND PROCESSOR             *
                        '
         TITLE 'IKJEFATT        ATTRIB COMMAND PROCESSOR'
IKJEFATT CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IKJEFATT  77.124'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @11,0                                               0002
@PSTART  DS    0H                                                  0002
         USING @PSTART,@11                                         0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0002
         USING @DATD,@12                                           0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @12,8(,@13)                                         0002
         LR    @13,@12                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0002
*                                      AND INPUT REGISTER            */
*   CPPLPTR=R1;                     /* ADDRESS OF TMP INPUT SET UP 0100
*                                      SERVICE ROUTINE PARMS         */
         ST    R1,CPPLPTR                                          0100
*   RESPECIFY                                                      0101
*    (R1) UNRSTD;                   /* FREE INPUT REGISTER           */
*   SERVRPTR=ADDR(SERTEPRM);        /* ADDRESSIBILITY TO POINTERS    */
         LA    @10,SERTEPRM                                        0102
         ST    @10,SERVRPTR                                        0102
*   ADUPT=CPPLUPT;                  /* PTR TO UPT                    */
         L     @10,CPPLPTR                                         0103
         MVC   ADUPT(4),CPPLUPT(@10)                               0103
*   ADECT=CPPLECT;                  /* PTR TO ECT                    */
         MVC   ADECT(4),CPPLECT(@10)                               0104
*   ADECB=ADDR(COMMECB);            /* PTR TO ECB                    */
         LA    @10,COMMECB                                         0105
         ST    @10,ADECB                                           0105
*   COMMECB=0;                      /* ZERO OUT THE COMMUNICATION ECB*/
         SLR   @10,@10                                             0106
         ST    @10,COMMECB                                         0106
*   RTRNCODE=0;                     /* INITIALIZE THE RTRNCODE       */
         L     @06,RGSVAREA(,R13)                                  0107
         ST    @10,RTRNCODE(,@06)                                  0107
*   PARMCORE=PARMCORE&&PARMCORE;    /* ZERO OUT PARM CORE            */
         XC    PARMCORE(153),PARMCORE                              0108
*   GTPLPTR=ADDR(PARMCORE);         /* ADDRESSIBILITY TO GENTRANS LST*/
         LA    @10,PARMCORE                                        0109
         ST    @10,GTPLPTR                                         0109
*   GTPLABLK=ADDR(ADBKAREA);        /* SET THE ADDRESS OF ADDBLOCK TO
*                                      THE BEGINNING OF GOTTEN CORE
*                                      PLUS LENGTH OF GENTRANS LIST  */
         LA    @06,ADBKAREA                                        0110
         ST    @06,GTPLABLK(,@10)                                  0110
*   ADDBKLN=7;                      /* NUMBER OF ADDBLOCK ADDRESSES  */
*                                                                  0111
         MVC   ADDBKLN(2,@06),@CH00065                             0111
*   /*****************************************************************/
*   /*                                                               */
*   /* DIVIDE THE CORE INTO TEXT UNITS AND OBTAIN THEIR              */
*   /* ADDRESSIBILITY                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0112
*   DO D=1 TO 7 BY 1;                                              0112
         LA    @10,1                                               0112
         ST    @10,D                                               0112
@DL00112 DS    0H                                                  0113
*     ADBKPTR(D)=ADDR(TEXTAREA)+((D-1)*11);                        0113
         LR    @06,@10                                             0113
         SLA   @06,2                                               0113
         L     @02,GTPLPTR                                         0113
         L     @02,GTPLABLK(,@02)                                  0113
         LA    @15,TEXTAREA                                        0113
         LR    @14,@10                                             0113
         BCTR  @14,0                                               0113
         MH    @14,@CH00034                                        0113
         ALR   @15,@14                                             0113
         ST    @15,ADBKPTR-4(@06,@02)                              0113
*   END;                                                           0114
         AH    @10,@CH00033                                        0114
         ST    @10,D                                               0114
         CH    @10,@CH00065                                        0114
         BNH   @DL00112                                            0114
*   GEN(EJECT);                                                    0115
*                                                                  0115
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* SCANNING THE COMMAND . SET UP THE PROPER PARAMETERS FOR THE   */
*   /* IKJPARSE SERVICE RTN. . INVOKE IKJPARSE TO SCAN THE COMMAND. .*/
*   /* VALIDITY CHECK DEN, BUFOFF, BLKSIZE, BUFL, KEYLEN, BUFNO, AND */
*   /* LRECL IN PARSE VALIDITY CHECK EXITS. . UPON RETURN,           */
*   /* INTERROGATE THE RETURN CODE. .0 INDICATES THAT IKJPARSE WAS   */
*   /* SUCCESSFUL .>O INDICATES A FAILURE .IF IKJPARSE DID NOT ISSUE */
*   /* A DIAGNOSTIC, DO SO PRIOR TO TERMINATING .TERMINATE           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0116
*   PPLPCL=ADCNATTR;                /* ADDRESS OF ATTRIB PCL         */
         L     @10,PPLPTR                                          0116
         MVC   PPLPCL(4,@10),ADCNATTR                              0116
*   PPLANS=ADDR(PDLADDR);           /* ADDRESS OF ANSWER PLACE       */
         LA    @06,PDLADDR                                         0117
         ST    @06,PPLANS(,@10)                                    0117
*   PPLCBUF=CPPLCBUF;               /* PTR TO COMMAND BUFFER         */
         L     @06,CPPLPTR                                         0118
         MVC   PPLCBUF(4,@10),CPPLCBUF(@06)                        0118
*   GENERATE;                                                      0119
    STM R2,R12,VALCKWA                 STORE MAINLINE ATTR REGS
*   PPLUWA=ADDR(VALCKWA);           /* PTR TO WORK AREA              */
         L     @10,PPLPTR                                          0120
         LA    @06,VALCKWA                                         0120
         ST    @06,PPLUWA(,@10)                                    0120
*   RESPECIFY                                                      0121
*    (R1) RSTD;                     /* RESTRICT R1 USAGE FOR PTR     */
*   R1=PPLPTR;                      /* SERVICE ROUTINE PARM LIST     */
         LR    R1,@10                                              0122
*   GEN(LINK EP=IKJPARS)                                           0123
*   REFS(R1);                       /* LINK TO PARSE TO SCAN BUFFER  */
         LINK EP=IKJPARS
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R15) RESTRICTED;              /* RETURN CODE REG RESTRICTED    */
*   RESPECIFY                                                      0125
*    (R1) UNRSTD;                   /* FREE R1 USAGE FOR COMPILER    */
*   RCODESV=R15;                    /* SAVE RETURN CODE              */
         ST    R15,RCODESV                                         0126
*   RESPECIFY                       /* FREE REGISTER FOR COMPILER    */
*    (R15) UNRSTD;                  /* REGISTER 15 FREED             */
*   IF RCODESV^=0                   /* A O INDICATES PARSE COMPLETED */
*     THEN                          /* PARSE COMPLETED OK SO,        */
         L     @10,RCODESV                                         0128
         LTR   @10,@10                                             0128
         BZ    @RF00128                                            0128
*     DO;                           /* SKIP THE ERROR CODE PATHS     */
*       IF RCODESV=4                /* IF RETURN CODE=4 FROM PARSE,  */
*         THEN                      /* WHICH INDICATES NOPROMPT USER */
         CH    @10,@CH00266                                        0130
         BNE   @RF00130                                            0130
*         RTRNCODE=12;              /* TWELVE RETURN CODE TO THE TMP */
         L     @10,RGSVAREA(,R13)                                  0131
         MVC   RTRNCODE(4,@10),@CF00035                            0131
*       ELSE                        /* OTHERWISE ISSUE MESSAGE THAT  */
*         DO;                       /* ATTRIB CAN NOT CONTINUE       */
         B     @RC00130                                            0132
@RF00130 DS    0H                                                  0133
*           SEG1=ADDR(MSG01);       /* 1ST LEVEL OF MESSAGE          */
         LA    @10,MSG01                                           0133
         ST    @10,SEG1                                            0133
*           SEG2=0;                 /* END OF 1ST LEVEL MSG.         */
         SLR   @10,@10                                             0134
         ST    @10,SEG2                                            0134
*           IF RCODESV=16           /* INDICATE NOT ENOUGH MAIN      */
*             THEN                  /* STORAGE                       */
         CLC   RCODESV(4),@CF00444                                 0135
         BNE   @RF00135                                            0135
*             DO;                   /* PUT OUT MESSAGE TO EFFECT     */
*               SEG1=ADDR(MSG02);   /* NOT ENOUGH MAIN STORAGE       */
         LA    @06,MSG02                                           0137
         ST    @06,SEG1                                            0137
*               SEG3=0;             /* END OF MESSAGE                */
         ST    @10,SEG3                                            0138
*             END;                  /* END OF STORAGE MSG-GO ISSUE IT*/
*           ELSE                    /* OTHERWISE IT WAS AN I/O ERROR */
*             DO;                   /* SO BUILD A GENERALIZED MSG    */
         B     @RC00135                                            0140
@RF00135 DS    0H                                                  0141
*               SEG3=ADDR(MSG04);   /* MESSAGE ID SEGMENT OF MESSAGE */
         LA    @10,MSG04                                           0141
         ST    @10,SEG3                                            0141
*               SEG4=ADDR(PARSE);   /* 'PARSE' SEGMENT               */
         LA    @10,PARSE                                           0142
         ST    @10,SEG4                                            0142
*               SEG5=ADDR(MSG03);   /* 'RETURN CODE IS' SEGMENT      */
         LA    @10,MSG03                                           0143
         ST    @10,SEG5                                            0143
*               SEG6=ADDR(RTCDLEN); /* DECIMAL RETURN CODE SEGMENT   */
         LA    @10,RTCDLEN                                         0144
         ST    @10,SEG6                                            0144
*               SEG7=0;             /* END OF SECOND LEVEL MESSAGE   */
         SLR   @10,@10                                             0145
         ST    @10,SEG7                                            0145
*               RFY                                                0146
*                (R4) RSTD;         /* RESTRICT CVD REGISTER         */
*               R4=RCODESV;         /* SET RETURN CODE IN REG 4      */
         L     R4,RCODESV                                          0147
*               CVD(R4,UNPACK);     /* CONVERT TO DECIMAL            */
         CVD   R4,UNPACK                                           0148
*               UNPK(RTCDAREA,UNPACK);/* UNPACK TO ZONED DECIMAL     */
         UNPK  RTCDAREA(8),UNPACK(8)                               0149
*               RFY                                                0150
*                (R4) UNRSTD;       /* REGISTER 4 NO LONGER NEEDED   */
*               FZERO=FZERO×'F0'X;  /* 'OR' IN F IN LAST BYTE        */
         OI    FZERO,X'F0'                                         0151
*               RTCDLEN=4;          /* LENGTH OF RETURN CODE         */
         MVC   RTCDLEN(2),@CH00266                                 0152
*             END;                  /* END GENERALIZED MSG-GO ISSUE  */
*           RTRNCODE=12;            /* INDICATE TO TMP ATTRIB FAILED */
@RC00135 L     @10,RGSVAREA(,R13)                                  0154
         MVC   RTRNCODE(4,@10),@CF00035                            0154
*           CALL PUTINTFC;          /* ISSUE THE APPROPRIATE MESSAGE */
         BAL   @14,PUTINTFC                                        0155
*         END;                      /* END MESSAGE PROCESSING        */
*     END;                          /* END OF ERROR PROCESSING       */
*                                                                  0158
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP INTERFACE TO AND USE GENTRANS TO BUILD THE TEXT UNITS. */
*   /* . SET UP INTERFACE TO THE GENTRANS ROUTINE. . GO TO THE       */
*   /* GENTRANS ROUTINE. . CHECK THE RETURN CODE. . IF IT FAILED THEN*/
*   /* ISSUE THE APPROPRIATE MESSAGE IF NECESSARY.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0158
*   ELSE                            /* NO ERROR--CONTINUE PROCESSING */
*     DO;                           /* INITIALIZE FOR GENTRANS       */
         B     @RC00128                                            0158
@RF00128 DS    0H                                                  0159
*       RFY                                                        0159
*         S99TUNIT BASED(ADBKPTR(1));/* PICK UP PROPER TEXT UNIT     */
*       S99TUKEY=DALDUMMY;          /* FILL IN THE KEY FOR DUMMY     */
         L     @10,GTPLPTR                                         0160
         L     @10,GTPLABLK(,@10)                                  0160
         L     @06,ADBKPTR(,@10)                                   0160
         MVC   S99TUKEY(2,@06),@CB00515                            0160
*       S99TUNUM=0;                 /* NUMBER OF LENGTH+PARM ENTRIES */
         SLR   @02,@02                                             0161
         ST    @02,@TF00001                                        0161
         MVC   S99TUNUM(2,@06),@TF00001+2                          0161
*       RFY                                                        0162
*         S99TUNIT BASED(ADBKPTR(2));/* PICK UP PROPER TEXT UNIT     */
*       S99TUKEY=DALPERMA;          /* FILL IN THE KEY FOR         0163
*                                      PERMANENTLY ALLOCATED         */
         L     @06,ADBKPTR+4(,@10)                                 0163
         MVC   S99TUKEY(2,@06),@CB00607                            0163
*       S99TUNUM=0;                 /* NUMBER OF LENGTH+PARM ENTRIES */
         SLR   @02,@02                                             0164
         ST    @02,@TF00001                                        0164
         MVC   S99TUNUM(2,@06),@TF00001+2                          0164
*       IF DSORGWD=1                /* WAS DSORG SPECIFIED?          */
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */
         LA    @06,1                                               0165
         L     @02,PDLADDR                                         0165
         CH    @06,DSORGWD(,@02)                                   0165
         BNE   @RF00165                                            0165
*         DO;                       /* DO THE FOLLOWING:             */
*           RFY                                                    0167
*             S99TUNIT BASED(ADBKPTR(7));/* PICK UP THE RIGHT TEXT 0167
*                                      UNIT                          */
*           S99TUKEY=DALDSORG;      /* FILL IN THE KEY FOR DATA SET
*                                      ORGANIZATION                  */
         L     @10,ADBKPTR+24(,@10)                                0168
         MVC   S99TUKEY(2,@10),@CB00563                            0168
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0169
*           S99TULNG=2;             /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00063                            0170
*           IF DSORGSUB=1 THEN      /* IS THE DSORG DA?              */
         CH    @06,DSORGSUB(,@02)                                  0171
         BNE   @RF00171                                            0171
*             S99TUPAR(1:2)='2000'X;/* STORE PROPER CODE IN TEXT UNIT*/
         MVC   S99TUPAR(2,@10),@CB00869                            0172
*           ELSE                    /* DA IS NOT SPECIFIED           */
*             IF DSORGSUB=2 THEN    /* IS THE DSORG DAU?             */
         B     @RC00171                                            0173
@RF00171 L     @10,PDLADDR                                         0173
         CLC   DSORGSUB(2,@10),@CH00063                            0173
         BNE   @RF00173                                            0173
*               S99TUPAR(1:2)='2100'X;/* STORE PROPER CODE IN TEXT 0174
*                                      UNIT                          */
         L     @10,GTPLPTR                                         0174
         L     @10,GTPLABLK(,@10)                                  0174
         L     @10,ADBKPTR+24(,@10)                                0174
         MVC   S99TUPAR(2,@10),@CB00870                            0174
*             ELSE                  /* DA AND DAU ARE NOT SPECIFIED  */
*               IF DSORGSUB=3 THEN  /* IS THE DSORG PO?              */
         B     @RC00173                                            0175
@RF00173 L     @10,PDLADDR                                         0175
         CLC   DSORGSUB(2,@10),@CH00293                            0175
         BNE   @RF00175                                            0175
*                 S99TUPAR(1:2)='0200'X;/* STORE PROPER CODE IN TEXT */
         L     @10,GTPLPTR                                         0176
         L     @10,GTPLABLK(,@10)                                  0176
         L     @10,ADBKPTR+24(,@10)                                0176
         MVC   S99TUPAR(2,@10),@CB00871                            0176
*               ELSE                /* DA,PO,DAU ARE NOT SPECIFIED   */
*                 IF DSORGSUB=4 THEN/* IS THE DSORG POU?             */
         B     @RC00175                                            0177
@RF00175 L     @10,PDLADDR                                         0177
         CLC   DSORGSUB(2,@10),@CH00266                            0177
         BNE   @RF00177                                            0177
*                   S99TUPAR(1:2)='0300'X;/* STORE PROPER CODE IN  0178
*                                      TEXT                          */
         L     @10,GTPLPTR                                         0178
         L     @10,GTPLABLK(,@10)                                  0178
         L     @10,ADBKPTR+24(,@10)                                0178
         MVC   S99TUPAR(2,@10),@CB00872                            0178
*                 ELSE              /* DA,DAU,PO,POU NOT SPECIFIED   */
*                   IF DSORGSUB=5 THEN/* IS THE DSORG PS?            */
         B     @RC00177                                            0179
@RF00177 L     @10,PDLADDR                                         0179
         CLC   DSORGSUB(2,@10),@CH00250                            0179
         BNE   @RF00179                                            0179
*                     S99TUPAR(1:2)='4000'X;/* STORE PROPER CODE IN
*                                      TEXT                          */
         L     @10,GTPLPTR                                         0180
         L     @10,GTPLABLK(,@10)                                  0180
         L     @10,ADBKPTR+24(,@10)                                0180
         MVC   S99TUPAR(2,@10),@CB00873                            0180
*                   ELSE            /* MUST BE DSORG OF PSU          */
*                     S99TUPAR(1:2)='4100'X;/* STORE PROPER CODE IN
*                                      TEXT                          */
         B     @RC00179                                            0181
@RF00179 L     @10,GTPLPTR                                         0181
         L     @10,GTPLABLK(,@10)                                  0181
         L     @10,ADBKPTR+24(,@10)                                0181
         MVC   S99TUPAR(2,@10),@CB00874                            0181
*           DSORGWD=0;              /* LET GENTRANS THINK THAT DSORG
*                                      WASN'T SPECIFIED              */
@RC00179 DS    0H                                                  0182
@RC00177 DS    0H                                                  0182
@RC00175 DS    0H                                                  0182
@RC00173 DS    0H                                                  0182
@RC00171 L     @10,PDLADDR                                         0182
         SLR   @06,@06                                             0182
         STH   @06,DSORGWD(,@10)                                   0182
*         END;                      /* END DSORG PROCESSING          */
*       DENSITWD=0;                 /* LET GENTRANS THINK THAT     0184
*                                      DENSITY WASN'T SPECIFIED IF IT
*                                      WAS                           */
@RF00165 SLR   @10,@10                                             0184
         L     @06,PDLADDR                                         0184
         STH   @10,DENSITWD(,@06)                                  0184
*       LRECLKWD=0;                 /* LET GENTRANS THINK THAT LRECL
*                                      WASN'T SPECIFIED IF IT WAS    */
         STH   @10,LRECLKWD(,@06)                                  0185
*       IF EXPDTKWD=1               /* WAS EXPDT SPECIFIED?          */
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */
         CLC   EXPDTKWD(2,@06),@CH00033                            0186
         BNE   @RF00186                                            0186
*         EXPDTKWD=0;               /* LET GENTRANS THINK THAT EXPDT
*                                      WASN'T SPECIFIED              */
         STH   @10,EXPDTKWD(,@06)                                  0187
*       IF RETPDWD=2                /* WAS RETPD SPECIFIED?          */
*         THEN                      /* YES, WAS SPECIFIED ON THE CMD */
@RF00186 L     @10,PDLADDR                                         0188
         CLC   RETPDWD(2,@10),@CH00063                             0188
         BNE   @RF00188                                            0188
*         DO;                       /* ZERO OUT EXPDT IF SPECIFIED   */
*           RFY                                                    0190
*             S99TUNIT BASED(ADBKPTR(5));/* GET RIGHT TEXT UNIT      */
*           S99TUKEY=ZEROKEY;       /* ZERO OUT THE KEY IN TEXT UNIT */
         L     @10,GTPLPTR                                         0191
         L     @10,GTPLABLK(,@10)                                  0191
         L     @10,ADBKPTR+16(,@10)                                0191
         MVC   S99TUKEY(2,@10),@CB00751                            0191
*         END;                      /* END SPECIAL PROC. FOR RETPD   */
*       BUFOFFWD=0;                 /* LET GENTRANS THINK THAT BUFOFF
*                                      WASN'T SPECIFIED IF IT WAS    */
@RF00188 L     @10,PDLADDR                                         0193
         SLR   @06,@06                                             0193
         STH   @06,BUFOFFWD(,@10)                                  0193
*       GTPLPDL=PDLADDR;            /* ADDRESS OF ANSWER PLACE       */
         L     @06,GTPLPTR                                         0194
         ST    @10,GTPLPDL(,@06)                                   0194
*       GTPLPCL=ADCNATTR;           /* ADDRESS OF ATTRIB'S PCL       */
         MVC   GTPLPCL(4,@06),ADCNATTR                             0195
*       IF TRTCHWD=2 THEN           /* WAS TRTCH, NOT KEYLENGTH    0196
*                                      SPECIFIED?                    */
         CLC   TRTCHWD(2,@10),@CH00063                             0196
         BNE   @RF00196                                            0196
*         GTPLKLST=ADDR(KYLIST);    /* ADDRESS OF THE KEYLIST TABLE  */
         LA    @10,KYLIST                                          0197
         ST    @10,GTPLKLST(,@06)                                  0197
*       ELSE                        /* KEYLENGTH WAS SPECIFIED       */
*         GTPLKLST=ADDR(KEYLIST);   /* ADDRESS OF THE KEYLIST TABLE  */
         B     @RC00196                                            0198
@RF00196 LA    @10,KEYLIST                                         0198
         L     @06,GTPLPTR                                         0198
         ST    @10,GTPLKLST(,@06)                                  0198
*       GTPLTBLE=ADDR(KEYTABLE);    /* ADDRESS OF THE KEYTABLE LIST  */
@RC00196 L     @10,GTPLPTR                                         0199
         LA    @06,KEYTABLE                                        0199
         ST    @06,GTPLTBLE(,@10)                                  0199
*       RESPECIFY                                                  0200
*        (R1) RSTD;                 /* RESTRICT R1 USAGE AS PTR      */
*       R1=GTPLPTR;                 /* SERVICE ROUTINE PARM LIST     */
         LR    R1,@10                                              0201
*       RESPECIFY                   /* RESTRICT REGISTER USAGE       */
*        (R15) RESTRICTED;          /* RETURN CODE REG RESTRICTED    */
*       GEN(LINK EP=IKJCB831)                                      0203
*       REFS(R1);                   /* LINK TO GENTRANS TO BUILD THE
*                                      TEXT UNITS                    */
         LINK EP=IKJCB831
*       RESPECIFY                                                  0204
*        (R1) UNRSTD;               /* FREE R1 USAGE FOR COMPILER    */
*       RCODESV=R15;                /* SAVE GENTRANS RETURN CODE     */
         ST    R15,RCODESV                                         0205
*       RESPECIFY                   /* RELEASE REG FOR COMPILER      */
*        (R15) UNRSTD;              /* FREE REGISTER 15              */
*       IF RCODESV^=0               /* WAS GENTRANS SUCCESSFUL?      */
*         THEN                      /* IT WAS NOT SUCCESSFUL SO      */
         L     @10,RCODESV                                         0207
         SLR   @06,@06                                             0207
         CR    @10,@06                                             0207
         BE    @RF00207                                            0207
*         DO;                       /* CLEAN UP, ISSUE MESSAGE IF  0208
*                                      NECESSARY AND RETURN TO TMP   */
*           SEG1=ADDR(MSG01);       /* OTHERWISE ISSUE MESSAGE THAT
*                                      ATTRIB CAN NOT CONTINUE       */
         LA    @02,MSG01                                           0209
         ST    @02,SEG1                                            0209
*           SEG2=0;                 /* END OF 1ST LEVEL MSG.         */
         ST    @06,SEG2                                            0210
*           IF RCODESV=12           /* INDICATE NOT ENOUGH MAIN      */
*             THEN                  /* PUT OUT MESSAGE TO THAT EFFECT*/
         CH    @10,@CH00035                                        0211
         BNE   @RF00211                                            0211
*             DO;                   /* SET UP MESSAGE BY INDICATING: */
*               SEG1=ADDR(MSG02);   /* NOT ENOUGH MAIN STORAGE       */
         LA    @10,MSG02                                           0213
         ST    @10,SEG1                                            0213
*               SEG3=0;             /* END OF MESSAGE                */
         ST    @06,SEG3                                            0214
*             END;                  /* END MSG SETUP-GO ISSUE IT     */
*           ELSE                    /* OTHERWISE, THE ERROR WAS A    */
*             DO;                   /* RESULT OF AN INVALID PARM LIST
*                                      OR AN UNSUPPORTED PARM IN PCL */
         B     @RC00211                                            0216
@RF00211 DS    0H                                                  0217
*               SEG3=ADDR(MSG04);   /* MESSAGE ID SEGMENT OF MESSAGE */
         LA    @10,MSG04                                           0217
         ST    @10,SEG3                                            0217
*               SEG4=ADDR(GENTRANS);/* 'GENTRANS' MESSAGE SEGMENT    */
         LA    @10,GENTRANS                                        0218
         ST    @10,SEG4                                            0218
*               SEG5=ADDR(MSG03);   /* 'RETURN CODE IS' SEGMENT      */
         LA    @10,MSG03                                           0219
         ST    @10,SEG5                                            0219
*               SEG6=ADDR(RTCDLEN); /* DECIMAL RETURN CODE           */
         LA    @10,RTCDLEN                                         0220
         ST    @10,SEG6                                            0220
*               SEG7=0;             /* END OF SECOND LEVEL MESSAGE   */
         SLR   @10,@10                                             0221
         ST    @10,SEG7                                            0221
*               RFY                                                0222
*                (R4) RSTD;         /* RESTRICT CVD REGISTER         */
*               R4=RCODESV;         /* SET RETURN CODE IN REGISTER 4 */
         L     R4,RCODESV                                          0223
*               CVD(R4,UNPACK);     /* CONVERT TO DECIMAL            */
         CVD   R4,UNPACK                                           0224
*               UNPK(RTCDAREA,UNPACK);/* UNPACK TO ZONED DECIMAL     */
         UNPK  RTCDAREA(8),UNPACK(8)                               0225
*               RFY                                                0226
*                (R4) UNRSTD;       /* REGISTER 4 IS NO LONGER NEEDED*/
*               FZERO=FZERO×'F0'X;  /* 'OR' IN F IN THE LAST BYTE    */
         OI    FZERO,X'F0'                                         0227
*               RTCDLEN=4;          /* LENGHT OF RETURN CODE         */
         MVC   RTCDLEN(2),@CH00266                                 0228
*             END;                  /* END OF GENERAL MESSAGE        */
*           RTRNCODE=12;            /* INDICATE TO TMP ATTRIB FAILED */
@RC00211 L     @10,RGSVAREA(,R13)                                  0230
         MVC   RTRNCODE(4,@10),@CF00035                            0230
*           CALL PUTINTFC;          /* ISSUE THE MESSAGE             */
         BAL   @14,PUTINTFC                                        0231
*           R3=ADDR(PDLADDR);       /* PDL ADDRESS                   */
         LA    R3,PDLADDR                                          0232
*           GENERATE;                                              0233
*                                   /* FREE THE PDL RETURNED BY PARSE*/
             IKJRLSA (3)               MACRO TO FREE PDLS
*         END;                      /* END OF FAILING PROCESSING     */
*                                                                  0235
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP DYNAMIC ALLOCATION INTERFACE TO PLACE ATTRIBUTES ON*/
*       /* ATTRIB CHAIN. . COMPLETE DYNAMIC ALLOCATION PARAMETER     */
*       /* LIST. . INVOKE DYNAMIC ALLOCATION. . CHECK THE DYNAMIC    */
*       /* ALLOCATION RETURN CODE. . IF DYNAMIC ALLOCATION IS        */
*       /* UNSUCCESSFUL THEN: .LINK TO DAIRFAIL TO ISSUE MESSAGE.    */
*       /* .RETURN TO THE TMP WITH A FAILING RETURN CODE.            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0235
*       ELSE                        /* NO ERROR SO CONTINUE          */
*         DO;                       /* BUILD THE PARM LIST AND GO  0235
*                                      DYNAMIC ALLOCATION            */
         B     @RC00207                                            0235
@RF00207 DS    0H                                                  0236
*           S99RBPTR=ADDR(S99RB);   /* ADDRESS OF THE REQUEST BLOCK  */
         LA    @10,S99RB                                           0236
         ST    @10,S99RBPTR                                        0236
*           S99RBPND='1'B;          /* SET THE HIGH ORDER BIT ON     */
         OI    S99RBPND,B'10000000'                                0237
*           S99RB=S99RB&&S99RB;     /* ZERO OUT THE REQUEST BLOCK    */
         XC    S99RB(20),S99RB                                     0238
*           S99RBLN=LENGTH(S99RB);  /* LENGTH OF THE REQUEST BLOCK   */
         MVI   S99RBLN,X'14'                                       0239
*           S99VERB=S99VRBAL;       /* FUNCTION TO BE PERFORMED      */
         MVI   S99VERB,X'01'                                       0240
*           S99TXTPP=ADDR(TXDTPTR); /* POINTER TO THE POINTERS TO THE
*                                      UNITS                         */
         L     @10,GTPLPTR                                         0241
         L     @10,GTPLOUTA(,@10)                                  0241
         LA    @10,TXDTPTR(,@10)                                   0241
         ST    @10,S99TXTPP                                        0241
*           RESPECIFY               /* RESTRICT REGISTER USAGE       */
*            (R1,                   /* RESTRICT INPUT REG USAGE      */
*             R15) RESTRICTED;      /* RESTRICT RETURN CODE REG      */
*           R1=ADDR(S99RBPTR);      /* ADDRESS OF POINTER TO RB      */
*                                                                  0243
         LA    R1,S99RBPTR                                         0243
*           /*********************************************************/
*           /*                                                       */
*           /* MACDATE Y-2 73082                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0244
*           SVC(99);                /* SVC 99 TO BUILD THE ATTR-LIST */
         SVC   99                                                  0244
*           RCODESV=R15;            /* SAVE SVC 99'S RETURN CODE     */
         ST    R15,RCODESV                                         0245
*           RESPECIFY               /* RELEASE REGS FOR COMPILER USE */
*            (R1,                   /* RELEASE INPUT REGISTER        */
*             R15) UNRESTRICTED;    /* RELEASE RETURN CODE REG       */
*           IF RCODESV^=0           /* WAS ALLOCATION UNSUCCESSFUL?  */
*             THEN                  /* YES,                          */
         L     @10,RCODESV                                         0247
         LTR   @10,@10                                             0247
         BZ    @RF00247                                            0247
*             DO;                   /* SVC 99 WAS NOT SUCCESSFUL SO  */
*               DFCPPLP=CPPLPTR;    /* MOVE CPPL POINTER IN PARMLIST */
         MVC   DFCPPLP(4),CPPLPTR                                  0249
*               DFIDP=ADDR(CALLERID);/* ADDRESS OF THE CALLER ID     */
         LA    @10,CALLERID                                        0250
         ST    @10,DFIDP                                           0250
*               DFJEFF02=ADDR(MSGWTR);/* MSG WRITER ADDRESS IS     0251
*                                      UNKNOWN                       */
         LA    @10,MSGWTR                                          0251
         ST    @10,DFJEFF02                                        0251
*               DFRCP=ADDR(RCODESV);/* POINTER TO DYNAMIC ALLOCATION
*                                      RETURN CODE                   */
         LA    @10,RCODESV                                         0252
         ST    @10,DFRCP                                           0252
*               DFS99RBP=S99RBPTR;  /* POINTER TO DYNAMIC ALLOCATION
*                                      REQUEST BLOCK                 */
         MVC   DFS99RBP(4),S99RBPTR                                0253
*               RESPECIFY           /* RESTRICT REGISTER USAGE       */
*                (R1) RESTRICTED;   /* RESTRICT INPUT REGISTER       */
*               R1=ADDR(DFPARMS);   /* LOAD ADDRESS OF PARMLIST IN R1*/
         LA    R1,DFPARMS                                          0255
*               GEN(LINK EP=IKJEFF18);/* ISSUE DIAGNOSTIC MESSAGE    */
         LINK EP=IKJEFF18
*               RESPECIFY           /* RELEASE REG FOR COMPILER USE  */
*                (R1) UNRESTRICTED; /* RELEASE INPUT REGISTER        */
*               RTRNCODE=12;        /* SET A FAILING RETURN CODE     */
         L     @10,RGSVAREA(,R13)                                  0258
         MVC   RTRNCODE(4,@10),@CF00035                            0258
*             END;                  /* END OF DAIR RETURN CODE CHECK */
*           R3=ADDR(PDLADDR);       /* PDL ADDRESS                   */
@RF00247 LA    R3,PDLADDR                                          0260
*           GENERATE;                                              0261
*                                   /* FREE THE PDL RETURNED BY PARSE*/
        IKJRLSA (3)                    MACRO TO FREE PDLS
*           RESPECIFY                                              0262
*            (R3,                                                  0262
*             R4,                                                  0262
*             R5) RSTD;             /* RESTRICT REGS FOR FREEMAIN    */
*           R3=TXDTLNGH;            /* LENGTH OF CORE TO BE FREED    */
         L     @10,GTPLPTR                                         0263
         L     @10,GTPLOUTA(,@10)                                  0263
         L     R3,TXDTLNGH-1(,@10)                                 0263
         LA    R3,0(,R3)                                           0263
*           R4=GTPLOUTA;            /* ADDRESS OF THE CORE TO FREE   */
         LR    R4,@10                                              0264
*           R5=TXDTSBPL;            /* SUBPOOL NUMBER                */
         SLR   R5,R5                                               0265
         IC    R5,TXDTSBPL(,@10)                                   0265
*           GEN(FREEMAIN R,LV=(3),A=(4),SP=(5))                    0266
*           REFS(R3,R4,R5);         /* FREE THE GENTRANS CORE        */
         FREEMAIN R,LV=(3),A=(4),SP=(5)
*           RESPECIFY                                              0267
*            (R3,                                                  0267
*             R4,                                                  0267
*             R5) UNRSTD;           /* RELEASE REGS FOR COMPILER USE */
*         END;                                                     0268
*     END;                                                         0269
@RC00207 DS    0H                                                  0270
*   GEN(EJECT);                                                    0270
*                                                                  0270
@RC00128 DS    0H                                                  0270
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN: 1) IF ERROR RETURN, REG 15 WILL CONTAIN A 12 2) IF    */
*   /* SUCCESSFUL RETURN, REG 15 WILL BE SET TO ZERO 3) RETURN TO TMP*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   IF RTRNCODE=12 THEN             /* IF RETURN CODE 12 DO THE      */
         L     @10,RGSVAREA(,R13)                                  0271
         CLC   RTRNCODE(4,@10),@CF00035                            0271
         BNE   @RF00271                                            0271
*     DO;                           /* FOLLOWING AND THEN EXIT       */
*       RESPECIFY                                                  0273
*        (R2) RESTRICTED;           /* RESTRICT PARAMETER REGISTER   */
*       R2=ADDR(STACKLSD);          /* REG 2 ADDRESS OF STACK LIST   */
         LA    R2,STACKLSD                                         0274
*       RESPECIFY                   /* RESTRICT REGISTER USAGE       */
*        (R1,                       /* RESTRICT INPUT REGISTER       */
*         R15) RESTRICTED;          /* RESTRICT RETURN CODE REG      */
*       R1=STPLPTR;                 /* REG1 STACK PARM LIST          */
         L     R1,STPLPTR                                          0276
*       STACKLSD=STACKLST;          /* LENGTH OF STACK PARM BLOCK    */
         MVC   STACKLSD(20),STACKLST                               0277
*       GEN(STACK PARM=(R2),DELETE=ALL,MF=(E,(1)));                0278
         STACK PARM=(R2),DELETE=ALL,MF=(E,(1))
*       RCODESV=R15;                /* SAVE RETURN CODE              */
         ST    R15,RCODESV                                         0279
*       RESPECIFY                   /* RELEASE REGISTER USAGE        */
*        (R1,                       /* RELEASE INPUT REGISTER        */
*         R15) UNRESTRICTED;        /* RELEASE RETURN CODE REG       */
*       GEN(TCLEARQ INPUT);         /* CLEAR GETLINE INPUT QUEUE     */
         TCLEARQ INPUT
*       RESPECIFY                                                  0282
*        (R2) UNRESTRICTED;         /* RELEASE REGISTER 2            */
*     END;                          /* END FAILURE EXIT PROCESSING   */
*   RETURN;                         /* RETURN TO THE CALLER(TMP)     */
@EL00001 L     @13,4(,@13)                                         0284
@EF00001 L     @00,@SIZDATD                                        0284
         LR    @01,@12                                             0284
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0284
         BR    @14                                                 0284
*   GEN(EJECT);                                                    0285
*                                                                  0285
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE CONVERTS EBCDIC INTEGERS TO BINARY FORM       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0286
*   RESPECIFY                                                      0286
*    (R1,                                                          0286
*     R5,                                                          0286
*     R15) RSTD;                    /* RESTRICT R1,R5,R14 FOR OWN USE*/
*CONVERT:                           /* CONVERT ENTRANCE              */
*   R5=VALUELEN-1;                  /* SUBTRACT 1 FROM NO. INTEGERS  */
CONVERT  LH    R5,VALUELEN(,R7)                                    0287
         BCTR  R5,0                                                0287
*   R1=VALUEPTR;                    /* PTR TO VALUE                  */
         L     R1,VALUEPTR(,R7)                                    0288
*CONVERTA:                          /* ENTER WHEN I SET UP REGISTERS */
*   GENERATE;                                                      0289
CONVERTA DS    0H                                                  0289
    EX  R5,PACDEC                   CONVERT INTEGER TO PACKED DECIMAL
    CVB R1,DECSIZE                  CONVERT INTEGER TO BINARY FORM
*   RESPECIFY                                                      0290
*    (R1,                                                          0290
*     R5) UNRESTRICTED;             /* REGISTERS 1,5 NO LONGER NEEDED*/
*   RESPECIFY                       /* RESTRICT REGISTER USAGEN      */
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */
*   GO TO RETPOINT;                 /* RETURN TO CALLER              */
         BR    R14                                                 0292
*   RESPECIFY                       /* RELEASE REG FOR COMPILER      */
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDR REG       */
*   GENERATE;                                                      0294
PACDEC PACK DECSIZE(AEIGHT),AZER(EIN,R1) CONVERT TO PACKED DECIMAL
AEIGHT EQU 8                           LENGTH OF EIGHT
EIN    EQU 1                           1
AZER   EQU 0                           OFFSET OF 0
*   GEN(EJECT);                                                    0295
*                                                                  0295
         EJECT
*/********************************************************************/
*/* PUTINTFC ROUTINE:                                                */
*/*    FORMATS MESSAGES TO BE PUT OUT TO THE TERMINAL AND ISSUES     */
*/*    THE CALL TO THE PUTLINE SERVICE ROUTINE. INPUT IS A LIST      */
*/*    OF SEGMENT ADDRESSES, THE SEGMENTS MAKE UP THE MESSAGE.       */
*/*    THE END OF THE LIST IS SIGNIFIED BY A WORD OF ZEROS.          */
*/********************************************************************/
*                                                                  0296
*PUTINTFC:                                                         0296
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */
PUTINTFC DS    0H                                                  0297
*   R14SAVE3=R14;                   /* SAVE RETURN ADDRESS           */
         ST    R14,R14SAVE3                                        0297
*   RESPECIFY                                                      0298
*    (I,                                                           0298
*     X,                                                           0298
*     Y) RESTRICTED;                /* RESTRICT REGISTERS 6,5,4, AND */
*   RESPECIFY                                                      0299
*    (R2) RESTRICTED;               /* 2 FOR FORMATTING MESSAGES     */
*   RESPECIFY                       /* RELEASE REG FOR COMPILER USE  */
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDRESS REG    */
*   I=0;                            /* TABLE SUBSCRIPT INITIALIZE    */
         SLR   I,I                                                 0301
*   Y=ADDR(FORMTBUF);               /* PTR TO MESSAGE BUFFER         */
         LA    Y,FORMTBUF                                          0302
*   ADSEG1=ADDR(MSGBUFER);          /* PTR TO COMPLETE MSG BUFFER    */
         LA    @14,MSGBUFER                                        0303
         ST    @14,ADSEG1                                          0303
*   SEGNUM1=1;                      /* NUMBER OF SEGMENTS            */
         MVC   SEGNUM1(4),@CF00033                                 0304
*   R2=ADDR(RETURNX);               /* RETURN POINT ADDRESS          */
         LA    R2,RETURNX                                          0305
*   GO TO FRMTLOOP;                 /* FORMAT MESSAGE SS             */
         B     FRMTLOOP                                            0306
*RETURNX:                                                          0307
*   Y=Y-ADDR(FORMTBUF);             /* DETERMINE LENGTH OF MESG      */
RETURNX  LA    @14,FORMTBUF                                        0307
         SLR   Y,@14                                               0307
*   Y=Y+4;                          /* ACCOUNT FOR HEADER LENGTH     */
         AH    Y,@CH00266                                          0308
*   LENOFMSG=Y;                     /* STORE IN PARM LIST            */
         STH   Y,LENOFMSG                                          0309
*   OFFSET=0;                       /* OFFSET FOR SEGMENT            */
         SLR   @14,@14                                             0310
         STH   @14,OFFSET                                          0310
*   I=I+1;                          /* INCREMENT SUBSCRIPT           */
         AL    I,@CF00033                                          0311
*   X=SEGTABLE(I);                  /* NEXT SEGMENT ADDRESS          */
         LR    @10,I                                               0312
         SLA   @10,2                                               0312
         LA    @03,MSGSGMTS                                        0312
         AL    @03,@CF00948                                        0312
         L     X,SEGTABLE(@10,@03)                                 0312
*   IF X=0 THEN                     /* IF 0, THEN NO 2ND LEVEL       */
         CR    X,@14                                               0313
         BNE   @RF00313                                            0313
*     DO;                           /* MESSAGE, SO                   */
*       PTRLEVL2=PDECMPRE;          /* INDICATE NO 2ND LEVEL         */
         MVC   PTRLEVL2(4),PDECMPRE                                0315
*       GO TO PUTISSUE;             /* ISSUE PUTLINE                 */
         B     PUTISSUE                                            0316
*     END;                          /* END MESSAGE ROUTINE           */
*   PTRLEVL2=ADDR(LEVELTWO);        /* ADDRESS OF 2ND LEVEL          */
@RF00313 LA    @14,LEVELTWO                                        0318
         ST    @14,PTRLEVL2                                        0318
*   SEGNUM2=1;                      /* SEGMENT NUMBER                */
         MVC   SEGNUM2(4),@CF00033                                 0319
*   Y=ADDR(FORMBUF2);               /* BUFFER ADDRESS                */
         LA    Y,FORMBUF2                                          0320
*   ADSEG2=ADDR(MSGBUF2);           /* MESSAGE BUFFER 2              */
         LA    @14,MSGBUF2                                         0321
         ST    @14,ADSEG2                                          0321
*   ADNEXT=PDECMPRE;                /* INDICATE NO 3RD LEVEL         */
         MVC   ADNEXT(4),PDECMPRE                                  0322
*   R2=ADDR(RETURNY);               /* RETURN ADDRESS                */
         LA    R2,RETURNY                                          0323
*   GO TO FRMT1;                    /* FORMAT MESSAGE                */
         B     FRMT1                                               0324
*   RESPECIFY                                                      0325
*    (R2) RESTRICTED;               /* RESTRICT REG 2 FOR MY USE     */
*FRMTLOOP:                                                         0326
*   I=I+1;                          /* INCREMENT SUBSCRIPT           */
FRMTLOOP AL    I,@CF00033                                          0326
*   X=SEGTABLE(I);                  /* PTR TO MESSAGE SEGMENT        */
         LR    @14,I                                               0327
         SLA   @14,2                                               0327
         LA    @10,MSGSGMTS                                        0327
         AL    @10,@CF00948                                        0327
         L     X,SEGTABLE(@14,@10)                                 0327
*   IF X=0 THEN                     /* IF 0, END OF SEGMENT TEST     */
         LTR   X,X                                                 0328
         BZ    @RT00328                                            0328
*     GO TO FRMTEND;                /* BRANCH TO R2POINT VIA FRMTEND */
*FRMT1:                                                            0330
*   MSGBUF(1:MESSLEN)=              /* MOVE SEGMENT OF MESSAGE       */
*       MESSTXT(1:MESSLEN);                                        0330
FRMT1    LH    @14,MESSLEN(,X)                                     0330
         LR    @10,@14                                             0330
         BCTR  @10,0                                               0330
         EX    @10,@SM00949                                        0330
*   Y=Y+MESSLEN;                    /* INCREMENT POINTER             */
         ALR   Y,@14                                               0331
*   GO TO FRMTLOOP;                 /* CONTINUE WITH MESSAGE         */
         B     FRMTLOOP                                            0332
*FRMTEND:                                                          0333
*   GO TO R2POINT;                  /* RETURN                        */
FRMTEND  BR    R2                                                  0333
*RETURNY:                                                          0334
*   Y=Y-ADDR(FORMBUF2);             /* LENGTH OF MESSAGE             */
RETURNY  LA    @14,FORMBUF2                                        0334
         SLR   Y,@14                                               0334
*   Y=Y+4;                          /* ACCOUNT FOR HEADER LTH        */
         AH    Y,@CH00266                                          0335
*   LENMSG2=Y;                      /* STORE IN PARM LIST            */
         STH   Y,LENMSG2                                           0336
*   OFFSET2=0;                      /* OFFSET                        */
         SLR   @14,@14                                             0337
         STH   @14,OFFSET2                                         0337
*   RESPECIFY                                                      0338
*    (R2) UNRESTRICTED;             /* RELEASE REGISTERS 6,5,4, AND  */
*   RESPECIFY                                                      0339
*    (I,                                                           0339
*     X,                                                           0339
*     Y) UNRESTRICTED;              /* 2 FOR COMPILERS USE           */
*PUTISSUE:                          /* ISSUE THE PUTLINE MACRO       */
*   PSIZE=PUTLEN;                   /* SIZE OF PUTLINE LIST          */
PUTISSUE MVC   PSIZE(3),PUTLEN+1                                   0340
*   SUBPOOLN='01'X;                 /* SUBPOOL ONE SPECIFIED         */
         MVI   SUBPOOLN,X'01'                                      0341
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R0,                           /* RESTRICT REQUEST REGISTER     */
*     R1) RESTRICTED;               /* RESTRICT CORE ADDR REGISTER   */
*   R0=CORE;                        /* LOAD SIZE AND SUBPOOL NBR.    */
         L     R0,CORE                                             0343
*   GENERATE;                                                      0344
*                                   /* GET CORE FOR PUTLINE LIST     */
               GETMAIN R,LV=(0)
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */
*    (R0) UNRSTD;                   /* RELEASE GETMAIN INPUT REG     */
*   IOPLIOPB=R1;                    /* ADDRESS OF CORE IN IOPL       */
         L     @14,IOPLPTR                                         0346
         ST    R1,IOPLIOPB(,@14)                                   0346
*   R1=IOPLPTR;                     /* ADDRESS OF IOPL IN R1         */
         LR    R1,@14                                              0347
*   COREGOT(1:PUTLEN)=PUTLIST(1:PUTLEN);/* MOVE MESSAGE              */
         L     @14,IOPLPTR                                         0348
         L     @14,IOPLIOPB(,@14)                                  0348
         L     @10,PUTLEN                                          0348
         BCTR  @10,0                                               0348
         EX    @10,@SM00951                                        0348
*   OUTADDR=ADDR(MSGPARMS);         /* LOAD THE MESSAGE ADDRESS      */
         LA    @10,MSGPARMS                                        0349
         ST    @10,OUTADDR(,@14)                                   0349
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R15) RESTRICTED;              /* RESTRICT RETURN CODE REG      */
*   GENERATE;                                                      0351
*                                   /* ISSUE MESSAGE WITH PUTLINE    */
               PUTLINE MF=(E,(1))
*   RCODESV=R15;                    /* SAVE RETURN CODE              */
         ST    R15,RCODESV                                         0352
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R0,                           /* RESTRICT REQUEST REGISTER     */
*     R1) RESTRICTED;               /* RESTRICT INPUT REG            */
*   RESPECIFY                       /* RELEASE REG FOR COMPILER      */
*    (R15) UNRSTD;                  /* RELEASE RETURN CODE REG       */
*   R0=CORE;                        /* LOAD FREEMAIN PARM REGS       */
         L     R0,CORE                                             0355
*   R1=IOPLIOPB;                    /* ADDRESS OF PUTLIST            */
         L     @10,IOPLPTR                                         0356
         L     R1,IOPLIOPB(,@10)                                   0356
*   GENERATE;                                                      0357
*                                   /* FREE PUTLIST CORE             */
               FREEMAIN R,LV=(0),A=(1)
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R14) RESTRICTED;              /* RESTRICT RETURN ADDR REG      */
*   RESPECIFY                       /* RELEASE REGISTERS FOR COMPILER*/
*    (R0,                           /* RELEASE FREEMAIN INPUT REG    */
*     R1) UNRSTD;                   /* RELEASE FREEMAIN INPUT REG    */
*   R14=R14SAVE3;                   /* RESTORE RETURN POINT          */
         L     R14,R14SAVE3                                        0360
*   GO TO RETPOINT;                 /* RETURN TO CALLER VIA REG 14   */
         BR    R14                                                 0361
*   RESPECIFY                       /* RELEASE REG FOR COMPILER USE  */
*    (R14) UNRESTRICTED;            /* RELEASE RETURN ADDRESS REG    */
*   GENERATE;                                                      0363
PUTLIST  PUTLINE OUTPUT=(PUTLIST,MULTLVL),MF=L
PUTEND   EQU   *                       END OF PUTLIST IS HERE
PUTLEN   DC    A(PUTEND-PUTLIST)       LENGTH OF PUTLIST
PUTADCON DC    A(PUTLIST)              ADDRESS OF PUTLIST
*   GEN(EJECT);                                                    0364
*                                                                  0364
         EJECT
*/********************************************************************/
*/* THE FOLLOWING IS THE PARSE CONTROL LIST FOR THE ATTRIB COMMAND.  */
*/********************************************************************/
*                                                                  0365
*   GENERATE;                                                      0365
IKJEFAT1 IKJPARM DSECT=PCL
ATTRNAME IKJIDENT  'ATTR-LIST-NAME',                                   X
               MAXLNTH=8,                                              X
               FIRST=ALPHA,OTHER=ALPHANUM,                             X
               PROMPT='ATTR-LIST-NAME',                                X
               VALIDCK=ATTRNMCK,                                       X
               HELP='A CORRECT NONDUPLICATE ATTR-LIST-NAME'
BFALN    IKJKEYWD
         IKJNAME    'BFALN',SUBFLD=ALLIGN
BFTEK    IKJKEYWD
         IKJNAME    'BFTEK',SUBFLD=TYPE
BLKSIZE  IKJKEYWD
         IKJNAME    'BLKSIZE',SUBFLD=SIZE
BUFL     IKJKEYWD
         IKJNAME    'BUFL',SUBFLD=BUFLNGTH
BUFNO    IKJKEYWD
         IKJNAME    'BUFNO',SUBFLD=BUFNBR
BUFOFF   IKJKEYWD
         IKJNAME    'BUFOFF',SUBFLD=BFFLNGTH
EROPT    IKJKEYWD
         IKJNAME    'EROPT',SUBFLD=OPTIONS
KEYTRTCH IKJKEYWD
         IKJNAME    'KEYLEN',SUBFLD=KEYLNGTH
         IKJNAME    'TRTCH',SUBFLD=TRTCHLTH
LRECL    IKJKEYWD
         IKJNAME    'LRECL',SUBFLD=RECLNGTH
NCP      IKJKEYWD
         IKJNAME    'NCP',SUBFLD=NUMBER
OPTCD    IKJKEYWD
         IKJNAME    'OPTCD',SUBFLD=CODE
RECFM    IKJKEYWD
         IKJNAME    'RECFM',SUBFLD=FORMAT
INOUT    IKJKEYWD
         IKJNAME    'INPUT'
         IKJNAME    'OUTPUT'
EXPRETOT IKJKEYWD
         IKJNAME    'EXPDT',SUBFLD=DATE
         IKJNAME    'RETPD',SUBFLD=DAYS
DIAGNS   IKJKEYWD
         IKJNAME    'DIAGNS',SUBFLD=DIAGNSS
DENSITY  IKJKEYWD
         IKJNAME    'DEN',SUBFLD=DENS
LIMCT    IKJKEYWD
         IKJNAME    'LIMCT',SUBFLD=LIMLNGTH
DSORG    IKJKEYWD
         IKJNAME    'DSORG',SUBFLD=ORGANIZA
ALLIGN   IKJSUBF
BFALNFLD IKJKEYWD
         IKJNAME   'F'
         IKJNAME   'D'
TYPE     IKJSUBF
BFTEKFLD IKJKEYWD
         IKJNAME   'S'
         IKJNAME   'E'
         IKJNAME   'A'
         IKJNAME   'R'
SIZE     IKJSUBF
BLKSZFLD IKJIDENT  'BLOCKSIZE',                                        X
               MAXLNTH=5,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='BLOCKSIZE',                                     X
               VALIDCK=BLKBUFCK,                                       X
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'
BFFLNGTH IKJSUBF
BFFLNFLD IKJIDENT   'BUFFER OFFSET',                                   X
               MAXLNTH=2,                                              X
               FIRST=ALPHANUM,OTHER=NUMERIC,                           X
               PROMPT='BUFFER OFFSET',                                 X
               VALIDCK=BUFCK,                                          X
               HELP='A DECIMAL NUMBER FROM 0 TO 99 OR A CHARACTER L'
BUFLNGTH IKJSUBF
BUFLNFLD IKJIDENT   'BUFFER LENGTH',                                   X
               MAXLNTH=5,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='BUFFER LENGTH',                                 X
               VALIDCK=BLKBUFCK,                                       X
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'
BUFNBR   IKJSUBF
BUFNBFLD IKJIDENT   'BUFFER NUMBER',                                   X
               MAXLNTH=3,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='NUMBER OF BUFFERS',                             X
               VALIDCK=KEYBUFCK,                                       X
               HELP='A DECIMAL NUMBER FROM 0 TO 255'
KEYLNGTH IKJSUBF
KEYLNFLD IKJIDENT   'KEY LENGTH',                                      X
               MAXLNTH=3,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='KEY LENGTH',                                    X
               VALIDCK=KEYBUFCK,                                       X
               HELP='A DECIMAL NUMBER FROM 0 TO 255'
RECLNGTH IKJSUBF
RECLNFLD IKJIDENT   'LOGICAL RECORD LENGTH',                           X
               MAXLNTH=5,                                              X
               FIRST=ALPHANUM,OTHER=NUMERIC,                           X
               PROMPT='LOGICAL RECORD LENGTH',                         X
               VALIDCK=LRECLCK,                                        X
               HELP='A DECIMAL NUMBER FROM 0 TO 32760 OR A CHARACTER X'
NUMBER   IKJSUBF
NUMBEFLD IKJIDENT   'MAXIMUM NUMBER OF READ OR WRITE MACROS',          X
               MAXLNTH=2,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='MAXIMUM NUMBER OF READ OR WRITE MACROS',        X
               HELP='A DECIMAL NUMBER FROM 0 TO 99'
DATE     IKJSUBF
DATEFLD  IKJIDENT   'EXPIRATION DATE',                                 X
               MAXLNTH=5,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='EXPIRATION DATE',                               X
               VALIDCK=EXPDTCK,                                        X
               HELP='A JULIAN DATE IN YYDDD FORMAT'
DAYS     IKJSUBF
DAYSFLD  IKJIDENT   'RETENTION PERIOD',                                X
               MAXLNTH=4,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='RETENTION PERIOD',                              X
               HELP='A DECIMAL NUMBER FROM 0 TO 9999'
DENS     IKJSUBF
DENFLD   IKJIDENT   'MAGNETIC TAPE DENSITY',                           X
               MAXLNTH=1,                                              X
               FIRST=NUMERIC,                                          X
               PROMPT='MAGNETIC TAPE DENSITY',                         X
               VALIDCK=DENSCK,                                         X
               HELP='A NUMBER FROM 0 TO 4'
LIMLNGTH IKJSUBF
LIMLNFLD IKJIDENT   'SEARCH LENGTH',                                   X
               MAXLNTH=5,                                              X
               FIRST=NUMERIC,OTHER=NUMERIC,                            X
               PROMPT='SEARCH LENGTH',                                 X
               VALIDCK=BLKBUFCK,                                       X
               HELP='A DECIMAL NUMBER FROM 0 TO 32760'
OPTIONS  IKJSUBF
OPTIOFLD IKJKEYWD
         IKJNAME    'SKP'
         IKJNAME    'ACC'
         IKJNAME    'ABE'
TRTCHLTH IKJSUBF
TRTCHFLD IKJKEYWD
         IKJNAME    'C'
         IKJNAME    'E'
         IKJNAME    'ET'
         IKJNAME    'T'
CODE     IKJSUBF
CODEFLD1 IKJKEYWD
         IKJNAME    'C'
CODEFLD2 IKJKEYWD
         IKJNAME    'T'
CODEFLD3 IKJKEYWD
         IKJNAME    'W'
CODEFLD4 IKJKEYWD
         IKJNAME    'Q'
CODEFLD5 IKJKEYWD
         IKJNAME    'A'
CODEFLD6 IKJKEYWD
         IKJNAME    'B'
CODEFLD7 IKJKEYWD
         IKJNAME    'E'
CODEFLD8 IKJKEYWD
         IKJNAME    'F'
CODEFLD9 IKJKEYWD
         IKJNAME    'H'
CODEFL10 IKJKEYWD
         IKJNAME    'Z'
CODEFL11 IKJKEYWD
         IKJNAME    'R'
DIAGNSS  IKJSUBF
DIAGNFLD IKJKEYWD
         IKJNAME    'TRACE'
ORGANIZA IKJSUBF
ORGANFLD IKJKEYWD
         IKJNAME    'DA'
         IKJNAME    'DAU'
         IKJNAME    'PO'
         IKJNAME    'POU'
         IKJNAME    'PS'
         IKJNAME    'PSU'
FORMAT   IKJSUBF
FORMFLD1 IKJKEYWD
         IKJNAME    'A'
FORMFLD2 IKJKEYWD
         IKJNAME    'B'
FORMFLD3 IKJKEYWD
         IKJNAME    'F'
FORMFLD4 IKJKEYWD
         IKJNAME    'M'
FORMFLD5 IKJKEYWD
         IKJNAME    'S'
FORMFLD6 IKJKEYWD
         IKJNAME    'T'
FORMFLD7 IKJKEYWD
         IKJNAME    'U'
FORMFLD8 IKJKEYWD
         IKJNAME    'V'
FORMFLD9 IKJKEYWD
         IKJNAME    'D'
         IKJENDP
ADCNATTR DC    A(IKJEFAT1)             ADDRESS OF PARSE PCL
*   GENERATE;                                                      0366
         DS   0F
LISTB    EQU  *                        START ADDRESS STACK PARM LIST
STACKLST STACK MF=L
LISTE    EQU  *                        END OF STACK LIST
*   GEN(EJECT);                                                    0367
*                                                                  0367
         EJECT
*/********************************************************************/
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR DEN         */
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */
*/*        FOR DEN.  THE RANGE OF VALUES IS FROM ZERO TO FOUR.       */
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */
*/********************************************************************/
*                                                                  0368
*DENSCK:                            /* ENTRY POINT FOR DENSITY NUMBER
*                                      VALIDITY CHECK EXIT ROUTINE   */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00002                                            0368
DENSCK   STM   @14,@12,12(@13)                                     0368
*   RESPECIFY                                                      0369
*    (R1,                                                          0369
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */
*   GENERATE;                                                      0370
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
AEIGHTT  EQU 8                       OFFSET OF EIGHT
AFOR     EQU 4                       OFFSET OF 4
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0371
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0372
         L     R7,PDEADR(,@10)                                     0372
*   CALL CONVERT;                   /* GO CONVERT VALUE TO BINARY    */
         BAL   @14,CONVERT                                         0373
*   CDENSITY=R1;                    /* SAVE THE CONVERTED DENSITY    */
         ST    R1,CDENSITY                                         0374
*   IF CDENSITY>4 THEN              /* IF VALUE EXCEEDS FOUR         */
         L     @10,CDENSITY                                        0375
         LA    @06,4                                               0375
         CR    @10,@06                                             0375
         BNH   @RF00375                                            0375
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/
         L     @10,RGSVAREA(,R13)                                  0376
         ST    @06,RTRNCODE(,@10)                                  0376
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* DO THE FOLLOWING:             */
         B     @RC00375                                            0377
@RF00375 DS    0H                                                  0378
*       RTRNCODE=0;                 /* INDICATE ACCEPTABLE VALUE     */
         SLR   @10,@10                                             0378
         L     @06,RGSVAREA(,R13)                                  0378
         ST    @10,RTRNCODE(,@06)                                  0378
*       RFY                                                        0379
*         S99TUNIT BASED(ADBKPTR(3));/* PICK UP PROPER TEXT UNIT     */
*       S99TUKEY=DALDEN;            /* FILL IN THE KEY FOR DENSITY   */
         L     @06,GTPLPTR                                         0380
         L     @06,GTPLABLK(,@06)                                  0380
         L     @06,ADBKPTR+8(,@06)                                 0380
         MVC   S99TUKEY(2,@06),@CB00561                            0380
*       S99TUNUM=1;                 /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@06),@CH00033                            0381
*       S99TULNG=1;                 /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@06),@CH00033                            0382
*       IF CDENSITY=0 THEN          /* IS THE DENSITY EQUAL TO ZERO  */
         C     @10,CDENSITY                                        0383
         BNE   @RF00383                                            0383
*         S99TUPAR(1)='03'X;        /* STORE PROPER KEY IN TEXT UNIT */
         MVI   S99TUPAR(@06),X'03'                                 0384
*       ELSE                        /* NOT A DENSITY OF 0            */
*         IF CDENSITY=1 THEN        /* IS THE DENSITY EQUAL TO ONE   */
         B     @RC00383                                            0385
@RF00383 CLC   CDENSITY(4),@CF00033                                0385
         BNE   @RF00385                                            0385
*           S99TUPAR(1)='43'X;      /* STORE PROPER KEY IN TEXT UNIT */
         L     @10,GTPLPTR                                         0386
         L     @10,GTPLABLK(,@10)                                  0386
         L     @10,ADBKPTR+8(,@10)                                 0386
         MVI   S99TUPAR(@10),X'43'                                 0386
*         ELSE                      /* NOT A DENSITY OF 0 OR 1       */
*           IF CDENSITY=2 THEN      /* IS THE DENSITY EQUAL TO TWO   */
         B     @RC00385                                            0387
@RF00385 CLC   CDENSITY(4),@CF00063                                0387
         BNE   @RF00387                                            0387
*             S99TUPAR(1)='83'X;    /* STORE PROPER KEY IN TEXT UNIT */
         L     @10,GTPLPTR                                         0388
         L     @10,GTPLABLK(,@10)                                  0388
         L     @10,ADBKPTR+8(,@10)                                 0388
         MVI   S99TUPAR(@10),X'83'                                 0388
*           ELSE                    /* NOT A DENSITY OF 0, 1 OR 2    */
*             IF CDENSITY=3 THEN    /* IS THE DENSITY EQUAL TO THREE */
         B     @RC00387                                            0389
@RF00387 CLC   CDENSITY(4),@CF00293                                0389
         BNE   @RF00389                                            0389
*               S99TUPAR(1)='C3'X;  /* STORE PROPER KEY IN TEXT UNIT */
         L     @10,GTPLPTR                                         0390
         L     @10,GTPLABLK(,@10)                                  0390
         L     @10,ADBKPTR+8(,@10)                                 0390
         MVI   S99TUPAR(@10),X'C3'                                 0390
*             ELSE                  /* NOT A DENSITY OF 0, 1, 2 OR 3 */
*               S99TUPAR(1)='D3'X;  /* STORE PROPER KEY IN TEXT UNIT */
         B     @RC00389                                            0391
@RF00389 L     @10,GTPLPTR                                         0391
         L     @10,GTPLABLK(,@10)                                  0391
         L     @10,ADBKPTR+8(,@10)                                 0391
         MVI   S99TUPAR(@10),X'D3'                                 0391
*     END;                          /* END ACCEPTABLE VALUE        0392
*                                      PROCESSING                    */
@RC00389 DS    0H                                                  0392
@RC00387 DS    0H                                                  0392
@RC00385 DS    0H                                                  0392
@RC00383 DS    0H                                                  0393
*   RESPECIFY                                                      0393
*    (R1,                                                          0393
*     R7) UNRESTRICTED;             /* RELEASE REGS 1,7 FOR COMPILER */
@RC00375 DS    0H                                                  0394
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END OF DEN PARSE VALIDITY   0395
*                                      CHECK EXIT                    */
@EL00002 DS    0H                                                  0395
@EF00002 DS    0H                                                  0395
@ER00002 LM    @14,@12,12(@13)                                     0395
         BR    @14                                                 0395
@PB00002 DS    0H                                                  0396
*   GEN(EJECT);                                                    0396
*                                                                  0396
         EJECT
*/********************************************************************/
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR BUFL,       */
*/*  BLKSIZE, AND LIMCT.                                             */
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */
*/*        FOR BUFL, LIMCT, AND BLKSIZE. THE MAXIMUM VALUE IS 32,760.*/
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */
*/********************************************************************/
*                                                                  0397
*BLKBUFCK:                          /* ENTRY POINT FOR BUFLN, LIMCT,
*                                      AND BLKSIZE VALUE VALIDITY  0397
*                                      CHECK EXIT ROUTINE            */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00003                                            0397
BLKBUFCK STM   @14,@12,12(@13)                                     0397
*   RESPECIFY                                                      0398
*    (R1,                                                          0398
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */
*   GENERATE;                                                      0399
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0400
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0401
         L     R7,PDEADR(,@10)                                     0401
*   CALL CONVERT;                   /* GO CONVERT VALUE TO BINARY    */
         BAL   @14,CONVERT                                         0402
*   IF R1>32760 THEN                /* IF VALUE EXCEEDS 32,760       */
         CH    R1,@CH00908                                         0403
         BNH   @RF00403                                            0403
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/
         L     @10,RGSVAREA(,R13)                                  0404
         MVC   RTRNCODE(4,@10),@CF00266                            0404
*   ELSE                            /* OTHERWISE                     */
*     RTRNCODE=0;                   /* INDICATE ACCEPTABLE VALUE     */
         B     @RC00403                                            0405
@RF00403 L     @10,RGSVAREA(,R13)                                  0405
         SLR   @06,@06                                             0405
         ST    @06,RTRNCODE(,@10)                                  0405
*   RESPECIFY                                                      0406
*    (R1,                                                          0406
*     R7) UNRESTRICTED;             /* RELEASE REGS 1,7 FOR COMPILER */
@RC00403 DS    0H                                                  0407
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END BUFL, LIMCT, AND BLKSIZE
*                                      PARSE VALIDITY CHECK EXIT     */
@EL00003 DS    0H                                                  0408
@EF00003 DS    0H                                                  0408
@ER00003 LM    @14,@12,12(@13)                                     0408
         BR    @14                                                 0408
@PB00003 DS    0H                                                  0409
*   GEN(EJECT);                                                    0409
*                                                                  0409
         EJECT
*/********************************************************************/
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR KEYLEN      */
*/*  AND BUFNO SUBFIELDS.                                            */
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */
*/*        FOR KEYLEN OR BUFNO. THE MAXIMUM VALUE IS 255.            */
*/*      . IF THE LIMIT IS EXCEEDED PARSE WILL PROMPT THE USER,      */
*/*        OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */
*/********************************************************************/
*                                                                  0410
*KEYBUFCK:                          /* ENTRY POINT FOR KEYLEN AND  0410
*                                      BUFNO VALUE VALIDITY CHECK  0410
*                                      EXIT ROUTINE                  */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00004                                            0410
KEYBUFCK STM   @14,@12,12(@13)                                     0410
*   GENERATE;                                                      0411
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   RESPECIFY                                                      0412
*    (R1,                                                          0412
*     R7) RESTRICTED;               /* RESTRICT REGS 1,7 FOR MY USE  */
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0413
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0414
         L     R7,PDEADR(,@10)                                     0414
*   CALL CONVERT;                   /* CONVERT VALUE TO BINARY       */
         BAL   @14,CONVERT                                         0415
*   IF R1>255 THEN                  /* IF VALUE EXCEEDS 255          */
         CH    R1,@CH00913                                         0416
         BNH   @RF00416                                            0416
*     RTRNCODE=4;                   /* INDICATE A FAILING RETURN CODE*/
         L     @10,RGSVAREA(,R13)                                  0417
         MVC   RTRNCODE(4,@10),@CF00266                            0417
*   ELSE                            /* OTHERWISE                     */
*     RTRNCODE=0;                   /* INDICATE ACCEPT VALUE         */
         B     @RC00416                                            0418
@RF00416 L     @10,RGSVAREA(,R13)                                  0418
         SLR   @06,@06                                             0418
         ST    @06,RTRNCODE(,@10)                                  0418
*   RESPECIFY                                                      0419
*    (R1,                                                          0419
*     R7) UNRESTRICTED;             /* RELEASE REG 1,7 FOR COMPILER  */
@RC00416 DS    0H                                                  0420
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END OF KEYLNCK AND BUFNO PARSE
*                                      VALIDITY CHECK EXIT           */
@EL00004 DS    0H                                                  0421
@EF00004 DS    0H                                                  0421
@ER00004 LM    @14,@12,12(@13)                                     0421
         BR    @14                                                 0421
@PB00004 DS    0H                                                  0422
*   GEN(EJECT);                                                    0422
*                                                                  0422
         EJECT
*/********************************************************************/
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR LRECL.      */
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */
*/*        FOR LRECL. MAXIMUM VALUE IS 32,760 UNLESS LRECL(X) IS     */
*/*        SPECIFIED.                                                */
*/*      . IF THE LIMIT IS EXCEEDED  OR AN X IS NOT SPECIFIED, THEN  */
*/*        PARSE WILL PROMPT THE USER, OTHERWISE, THE VALUE WILL BE  */
*/*        ACCEPTED.                                                 */
*/********************************************************************/
*                                                                  0423
*LRECLCK:                           /* ENTRY POINT FOR LRECL VALUE 0423
*                                      VALIDITY CHECK EXIT ROUTINE   */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00005                                            0423
LRECLCK  STM   @14,@12,12(@13)                                     0423
*   RESPECIFY                                                      0424
*    (R1,                                                          0424
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */
*   GENERATE;                                                      0425
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0426
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0427
         L     R7,PDEADR(,@10)                                     0427
*   IF LRECLX=CHARX THEN            /* TEST FOR CHAR X               */
         L     @10,VALUEPTR(,R7)                                   0428
         CLC   LRECLX(1,@10),CHARX                                 0428
         BNE   @RF00428                                            0428
*     DO;                           /* X IS SPECIFIED IN THE FIRST   */
*       IF VALUELEN=1 THEN          /* POSITION, IS THAT ALL?        */
         CLC   VALUELEN(2,R7),@CH00033                             0430
         BNE   @RF00430                                            0430
*         DO;                       /* ONLY AN "X" WAS SPECIFIED SO  */
*           RFY                                                    0432
*             S99TUNIT BASED(ADBKPTR(4));/* PICK UP THE RIGHT TEXT 0432
*                                      UNIT                          */
*           S99TUKEY=DALLRECL;      /* FILL IN THE KEY FOR LRECL     */
         L     @10,GTPLPTR                                         0433
         L     @10,GTPLABLK(,@10)                                  0433
         L     @10,ADBKPTR+12(,@10)                                0433
         MVC   S99TUKEY(2,@10),@CB00575                            0433
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0434
*           S99TULNG=2;             /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00063                            0435
*           S99TUPAR(1:2)='8000'X;  /* STORE GIVEN VALUE IN TEXT UNIT*/
         MVC   S99TUPAR(2,@10),@CB00920                            0436
*           RTRNCODE=0;             /* ACCEPT VALUE RETURN CODE      */
         L     @10,RGSVAREA(,R13)                                  0437
         SLR   @06,@06                                             0437
         ST    @06,RTRNCODE(,@10)                                  0437
*         END;                      /* CHECK NEXT FIELD              */
*       ELSE                        /* "X" IN FIRST CHAR BUT FIELD   */
*         RTRNCODE=4;               /* IS TOO LONG, SO SET A RETURN  */
         B     @RC00430                                            0439
@RF00430 L     @10,RGSVAREA(,R13)                                  0439
         MVC   RTRNCODE(4,@10),@CF00266                            0439
*     END;                          /* CODE FOR PARSE AND RETURN     */
*   ELSE                            /* OTHERWISE, NO X WAS SPECIFIED */
*     DO;                           /* CHECK TO SEE THAT THE FIRST   */
         B     @RC00428                                            0441
@RF00428 DS    0H                                                  0442
*       IF HALFLREC^='1111'B THEN   /* CHARACTER IS NUMERIC          */
         L     @10,VALUEPTR(,R7)                                   0442
         TM    HALFLREC(@10),B'11110000'                           0442
         BO    @RF00442                                            0442
*         RTRNCODE=4;               /* SET ERROR RETURN CODE         */
         L     @10,RGSVAREA(,R13)                                  0443
         MVC   RTRNCODE(4,@10),@CF00266                            0443
*       ELSE                        /* OTHERWISE, IT WAS NUMERIC SO  */
*         DO;                       /* DO THE FOLLOWING:             */
         B     @RC00442                                            0444
@RF00442 DS    0H                                                  0445
*           CALL CONVERT;           /* CONVERT VALUE TO BINARY       */
         BAL   @14,CONVERT                                         0445
*           IF R1>32760 THEN        /* SEE IF GREATER THAN 32760     */
         CH    R1,@CH00908                                         0446
         BNH   @RF00446                                            0446
*             RTRNCODE=4;           /* YES, INDICATE BAD RETURN CODE */
         L     @10,RGSVAREA(,R13)                                  0447
         MVC   RTRNCODE(4,@10),@CF00266                            0447
*           ELSE                    /* OTHERWISE THE VALUE IS WITHIN */
*             DO;                   /* THE VALID NUMERIC RANGE       */
         B     @RC00446                                            0448
@RF00446 DS    0H                                                  0449
*               RTRNCODE=0;         /* INDICATE ACCEPT VALUE         */
         L     @10,RGSVAREA(,R13)                                  0449
         SLR   @06,@06                                             0449
         ST    @06,RTRNCODE(,@10)                                  0449
*               RFY                                                0450
*                 S99TUNIT BASED(ADBKPTR(4));/* PICK UP THE RIGHT  0450
*                                      TEXT UNIT                     */
*               S99TUKEY=DALLRECL;  /* FILL IN THE KEY FOR LRECL     */
         L     @10,GTPLPTR                                         0451
         L     @10,GTPLABLK(,@10)                                  0451
         L     @10,ADBKPTR+12(,@10)                                0451
         MVC   S99TUKEY(2,@10),@CB00575                            0451
*               S99TUNUM=1;         /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0452
*               S99TULNG=2;         /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00063                            0453
*               S99TUPAR(1:2)=R1;   /* PLACE GIVEN VALUE INTO TEXT   */
         ST    R1,@TF00001                                         0454
         MVC   S99TUPAR(2,@10),@TF00001+2                          0454
*             END;                  /* RETURN TO PARSE               */
*         END;                      /* END VALID NUMERIC TESTING     */
@RC00446 DS    0H                                                  0457
*     END;                          /* END OF ALL NUMERIC TESTING    */
@RC00442 DS    0H                                                  0458
*   RESPECIFY                                                      0458
*    (R1,                                                          0458
*     R7) UNRESTRICTED;             /* RELEASE REG 1.7 FOR COMPILER  */
@RC00428 DS    0H                                                  0459
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END OF LRECL PARSE VALIDITY 0460
*                                      CHECK EXIT                    */
@EL00005 DS    0H                                                  0460
@EF00005 DS    0H                                                  0460
@ER00005 LM    @14,@12,12(@13)                                     0460
         BR    @14                                                 0460
@PB00005 DS    0H                                                  0461
*   GEN(EJECT);                                                    0461
*                                                                  0461
         EJECT
*/********************************************************************/
*/*  PARSE VALIDITY CHECK ROUTINE FOR EXPDT.                         */
*/*      . THIS ROUTINE PERFORMS CHECKING ON VALUES SUPPLIED FOR     */
*/*        EXPDT. THE VALUE MUST BE 5 CHARACTERS.                    */
*/*      . THE DAY VALUE MUST BE LESS THAN 366.                      */
*/*      . IF THE LENGTH IS LESS THAN 5 OR THE DAY VALUE IS          */
*/*        INVALID, PARSE WILL PROMPT THE USER.                      */
*/*      . OTHERWISE, THE VALUE WILL BE ACCEPTED.                    */
*/********************************************************************/
*                                                                  0462
*EXPDTCK:                           /* ENTRY POINT FOR EXPDT VALUE 0462
*                                      VALIDITY CHECK EXIT ROUTINE   */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00006                                            0462
EXPDTCK  STM   @14,@12,12(@13)                                     0462
*   RESPECIFY                                                      0463
*    (R1,                                                          0463
*     R5,                                                          0463
*     R7) RSTD;                     /* RESTRICT R1,R5,R7 FOR MY USE  */
*   GENERATE;                                                      0464
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0465
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0466
         L     R7,PDEADR(,@10)                                     0466
*   IF VALUELEN<5 THEN              /* IF EXPDT IS LESS THAN 5       */
         LH    @10,VALUELEN(,R7)                                   0467
         CH    @10,@CH00250                                        0467
         BNL   @RF00467                                            0467
*     RTRNCODE=4;                   /* INDICATE FAILING RETURN CODE  */
         L     @10,RGSVAREA(,R13)                                  0468
         MVC   RTRNCODE(4,@10),@CF00266                            0468
*   ELSE                            /* OTHERWISE, LENGTH IS CORRECT  */
*     DO;                           /* SO DO THE FOLLOWING           */
         B     @RC00467                                            0469
@RF00467 DS    0H                                                  0470
*       R5=2;                       /* ONLY CONVERT DAYS NOT YEAR    */
         LA    @10,2                                               0470
         LR    R5,@10                                              0470
*       R1=VALUEPTR+2;              /* YEAR MAY GO TO 99             */
         AL    @10,VALUEPTR(,R7)                                   0471
         LR    R1,@10                                              0471
*       CALL CONVERTA;              /* CONVERT DAYS TO BINARY        */
         BAL   @14,CONVERTA                                        0472
*       IF R1>366×R1=0              /* IF VALUE EXCEEDS 366 DAYS     */
*         THEN                      /* OR 0 DAYS             @ZA19313*/
         CH    R1,@CH00928                                         0473
         BH    @RT00473                                            0473
         LTR   R1,R1                                               0473
         BNZ   @RF00473                                            0473
@RT00473 DS    0H                                                  0474
*         RTRNCODE=4;               /* INDICATE FAILING RETURN CODE  */
         L     @10,RGSVAREA(,R13)                                  0474
         MVC   RTRNCODE(4,@10),@CF00266                            0474
*       ELSE                        /* VALUE IS ACCEPTABLE           */
*         DO;                       /* SO DO THE FOLLOWING:          */
         B     @RC00473                                            0475
@RF00473 DS    0H                                                  0476
*           RTRNCODE=0;             /* INDICATE ACCEPT VALUE         */
         L     @10,RGSVAREA(,R13)                                  0476
         SLR   @06,@06                                             0476
         ST    @06,RTRNCODE(,@10)                                  0476
*           RFY                                                    0477
*             S99TUNIT BASED(ADBKPTR(5));/* PICK UP THE RIGHT TEXT 0477
*                                      UNIT                          */
*           S99TUKEY=DALEXPDT;      /* FILL IN THE KEY FOR EXPDT     */
         L     @10,GTPLPTR                                         0478
         L     @10,GTPLABLK(,@10)                                  0478
         L     @10,ADBKPTR+16(,@10)                                0478
         MVC   S99TUKEY(2,@10),@CB00511                            0478
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0479
*           S99TULNG=5;             /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00250                            0480
*           S99TUPAR(1:5)=VALNAME(1:5);/* STORE VALUE                */
         L     @06,VALUEPTR(,R7)                                   0481
         MVC   S99TUPAR(5,@10),VALNAME(@06)                        0481
*         END;                      /* END OF VALID DATE PROCESSING  */
*     END;                          /* END OF EXPDT DATE PROCESSING  */
@RC00473 DS    0H                                                  0484
*   RESPECIFY                                                      0484
*    (R1,                                                          0484
*     R5,                                                          0484
*     R7) UNRSTD;                   /* RELEASE REG 7,1,5 FOR COMPILER*/
@RC00467 DS    0H                                                  0485
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END OF EXPDT PARSE VALIDITY 0486
*                                      CHECK EXIT                    */
@EL00006 DS    0H                                                  0486
@EF00006 DS    0H                                                  0486
@ER00006 LM    @14,@12,12(@13)                                     0486
         BR    @14                                                 0486
@PB00006 DS    0H                                                  0487
*   GEN(EJECT);                                                    0487
*                                                                  0487
         EJECT
*/********************************************************************/
*/*  MAXIMUM VALUE PARSE VALIDITY CHECK EXIT ROUTINE FOR BUFOFF.     */
*/*      . THIS ROUTINE PERFORMS LIMIT CHECKING ON VALUES SUPPLIED   */
*/*        FOR BUFOFF. MAXIMUM VALUE IS 99 UNLESS BUFOFF(L) IS       */
*/*        SPECIFIED.                                                */
*/*      . IF THE LIMIT IS EXCEEDED OR AN L IS NOT SPECIFIED, THEN   */
*/*        PARSE WILL PROMPT THE USER, OTHERWISE, THE VALUE WILL BE  */
*/*        ACCEPTED.                                                 */
*/********************************************************************/
*                                                                  0488
*BUFCK:                             /* ENTRY POINT FOR BUFOFF VALUE
*                                      VALIDITY CHECK EXIT ROUTINE   */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00007                                            0488
BUFCK    STM   @14,@12,12(@13)                                     0488
*   RESPECIFY                                                      0489
*    (R1,                                                          0489
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */
*   GENERATE;                                                      0490
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0491
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0492
         L     R7,PDEADR(,@10)                                     0492
*   IF BUFOFFL=CHARL THEN           /* TEST FOR CHAR L               */
         L     @10,VALUEPTR(,R7)                                   0493
         CLC   BUFOFFL(1,@10),CHARL                                0493
         BNE   @RF00493                                            0493
*     DO;                           /* L IS SPECIFIED IN THE FIRST   */
*       IF VALUELEN=1 THEN          /* POSITION, IS THAT ALL?        */
         CLC   VALUELEN(2,R7),@CH00033                             0495
         BNE   @RF00495                                            0495
*         DO;                       /* ONLY AN "N" WAS SPECIFIED SO  */
*           RFY                                                    0497
*             S99TUNIT BASED(ADBKPTR(6));/* PICK UP THE RIGHT TEXT 0497
*                                      UNIT                          */
*           S99TUKEY=DALBUFOF;      /* FILL IN THE KEY FOR BUFOFF    */
         L     @10,GTPLPTR                                         0498
         L     @10,GTPLABLK(,@10)                                  0498
         L     @10,ADBKPTR+20(,@10)                                0498
         MVC   S99TUKEY(2,@10),@CB00549                            0498
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0499
*           S99TULNG=1;             /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00033                            0500
*           S99TUPAR(1)='80'X;      /* STORE GIVEN VALUE IN TEXT UNIT*/
         MVI   S99TUPAR(@10),X'80'                                 0501
*           RTRNCODE=0;             /* ACCEPT VALUE                  */
         L     @10,RGSVAREA(,R13)                                  0502
         SLR   @06,@06                                             0502
         ST    @06,RTRNCODE(,@10)                                  0502
*         END;                      /* CHECK NEXT FIELD              */
*       ELSE                        /* "L" IN FIRST CHAR BUT FIELD   */
*         RTRNCODE=4;               /* IS TOO LONG, SO SET A RETURN  */
         B     @RC00495                                            0504
@RF00495 L     @10,RGSVAREA(,R13)                                  0504
         MVC   RTRNCODE(4,@10),@CF00266                            0504
*     END;                          /* FOR PARSE AND RETURN          */
*   ELSE                            /* OTHERWISE,NO L WAS SPECIFIED  */
*     DO;                           /* CHECK TO SEE THAT THE FIRST   */
         B     @RC00493                                            0506
@RF00493 DS    0H                                                  0507
*       IF HALFLREC^='1111'B THEN   /* CHARACTER IS NUMERIC          */
         L     @10,VALUEPTR(,R7)                                   0507
         TM    HALFLREC(@10),B'11110000'                           0507
         BO    @RF00507                                            0507
*         RTRNCODE=4;               /* SET ERROR RETURN CODE         */
         L     @10,RGSVAREA(,R13)                                  0508
         MVC   RTRNCODE(4,@10),@CF00266                            0508
*       ELSE                        /* OTHERWISE, IT WAS NUMERIC SO  */
*         DO;                       /* DO THE FOLLOWING:             */
         B     @RC00507                                            0509
@RF00507 DS    0H                                                  0510
*           CALL CONVERT;           /* CONVERT VALUE TO BINARY       */
         BAL   @14,CONVERT                                         0510
*           RTRNCODE=0;             /* INDICATE ACCEPT VALUE         */
         L     @10,RGSVAREA(,R13)                                  0511
         SLR   @06,@06                                             0511
         ST    @06,RTRNCODE(,@10)                                  0511
*           RFY                                                    0512
*             S99TUNIT BASED(ADBKPTR(6));/* PICK UP THE RIGHT TEXT 0512
*                                      UNIT                          */
*           S99TUKEY=DALBUFOF;      /* FILL IN THE KEY FOR BUFOFF    */
         L     @10,GTPLPTR                                         0513
         L     @10,GTPLABLK(,@10)                                  0513
         L     @10,ADBKPTR+20(,@10)                                0513
         MVC   S99TUKEY(2,@10),@CB00549                            0513
*           S99TUNUM=1;             /* NUMBER OF LENGTH+PARM ENTRIES */
         MVC   S99TUNUM(2,@10),@CH00033                            0514
*           S99TULNG=1;             /* LENGTH OF FIRST PARM          */
         MVC   S99TULNG(2,@10),@CH00033                            0515
*           S99TUPAR(1)=R1;         /* STORE GIVEN VALUE IN TEXT UNIT*/
         STC   R1,S99TUPAR(,@10)                                   0516
*         END;                      /* END VALID NUMERIC TESTING     */
*     END;                          /* END OF ALL NUMERIC TESTING    */
@RC00507 DS    0H                                                  0519
*   RESPECIFY                                                      0519
*    (R1,                                                          0519
*     R7) UNRESTRICTED;             /* RELEASE REG 7,1 FOR COMPILER  */
@RC00493 DS    0H                                                  0520
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* END OF BUFOFF PARSE VALIDITY
*                                      CHECK EXIT                    */
@EL00007 DS    0H                                                  0521
@EF00007 DS    0H                                                  0521
@ER00007 LM    @14,@12,12(@13)                                     0521
         BR    @14                                                 0521
@PB00007 DS    0H                                                  0522
*   GEN(EJECT);                                                    0522
*                                                                  0522
         EJECT
*/********************************************************************/
*/*  ATTR-LIST-NAME PARSE VALIDITY CHECK EXIT ROUTINE.               */
*/*     . SETS UP INTERFACE WITH DYNAMIC ALLOCATION TO DETERMINE     */
*/*       IF THE ATTR-LIST-NAME IS UNIQUE.                           */
*/*     . IF DYNAMIC ALLOCATION DOES NOT FIND THE ATTR-LIST-NAME     */
*/*       THEN A SUCCESSFUL RETURN CODE WILL BE RETURNED TO PARSE.   */
*/*     . IF DYNAMIC ALLOCATION FIND A MATCH TO THE ATTR-LIST-       */
*/*       NAME THEN A RETURN CODE WILL BE PASSED TO PARSE INDICAT-   */
*/*       ING TO WRITE AN ERROR MESSAGE TO THE USER AND PROMPT FOR   */
*/*       A NEW NAME.                                                */
*/********************************************************************/
*                                                                  0523
*ATTRNMCK:                          /* ENTRY POINT FOR ATTR-LIST-NAME
*                                      VALIDITY CHECK EXIT ROUTINE   */
*   PROC OPTIONS(NOSAVEAREA);       /* SAVE PARSE REGISTERS          */
         B     @PB00008                                            0523
ATTRNMCK STM   @14,@12,12(@13)                                     0523
*   RESPECIFY                                                      0524
*    (R1,                                                          0524
*     R7) RESTRICTED;               /* RESTRICT REG 1,7 FOR MY USE   */
*   GENERATE;                                                      0525
    L  R14,AFOR(R1)                  LOAD THE PTR TO THE MAINLINE REGS
    LM R2,R12,AZER(R14)              RESTORE MAINLINE WORK REGISTERS
    LA R14,SAVEAR01                  LOAD THE ADDR OF PROC SAVE AREA
    ST R13,AFOR(R14)                 ADDR OF PARSE SAVE AREA IN MINE
    ST R14,AEIGHTT(R13)              ADDR OF MY SAVE AREA IN PARSES
    LR R13,R14                       NOW USE MY SAVE AREA
*   VALPARMS=R1;                    /* INITIALIZE VALIDITY CHECK     */
         ST    R1,VALPARMS                                         0526
*   R7=PDEADR;                      /* PARAMETERS                    */
         L     @10,VALPARMS                                        0527
         L     R7,PDEADR(,@10)                                     0527
*   S99RBPTR=ADDR(S99RB);           /* ADDRESS OF THE REQUEST BLOCK  */
         LA    @10,S99RB                                           0528
         ST    @10,S99RBPTR                                        0528
*   S99RBPND='1'B;                  /* INDICATE THE END OF THIS LIST */
         OI    S99RBPND,B'10000000'                                0529
*   S99RB=S99RB&&S99RB;             /* ZERO OUT THE REQUEST BLOCK    */
         XC    S99RB(20),S99RB                                     0530
*   S99TXTPP=ADDR(ATNMCORE);        /* POINTER TO THE POINTERS TO THE
*                                      TEXT UNITS                    */
         LA    @10,ATNMCORE                                        0531
         ST    @10,S99TXTPP                                        0531
*   RFY                                                            0532
*     S99TUP BASED(S99TXTPP);       /* GET ADDRESSIBILITY TO THE   0532
*                                      RIGHT TEXT UNIT POINTER       */
*   S99TUP=ADDR(ATNMCORE)+4;        /* ADDRESSIBILITY TO THE CORE    */
         LA    @06,4                                               0533
         ALR   @06,@10                                             0533
         ST    @06,S99TUP(,@10)                                    0533
*   S99TUPND='1'B;                  /* SET THE HIGH ORDER BIT ON     */
         OI    S99TUPND(@10),B'10000000'                           0534
*   RFY                                                            0535
*     S99TUNIT BASED(S99TUP);       /* GET ADDRESSIBILITY TO THE TEXT
*                                      UNIT                          */
*   S99TUKEY=DINDDNAM;              /* SET THE PROPER TEXT KEY       */
         L     @10,S99TUP(,@10)                                    0536
         MVC   S99TUKEY(2,@10),@CB00445                            0536
*   S99TUNUM=1;                     /* TEXT NUMBER OF ONE            */
         MVC   S99TUNUM(2,@10),@CH00033                            0537
*   S99TULNG=VALUELEN;              /* LENGTH OF PARM FIELD          */
         LH    @06,VALUELEN(,R7)                                   0538
         ST    @06,@TF00001                                        0538
         MVC   S99TULNG(2,@10),@TF00001+2                          0538
*   S99TUPAR(1:VALUELEN)=VALNAME(1:VALUELEN);/* MOVE THE NAME IN     */
         BCTR  @06,0                                               0539
         L     @15,VALUEPTR(,R7)                                   0539
         EX    @06,@SM00953                                        0539
*   S99RBLN=LENGTH(S99RB);          /* LENGTH OF THE REQUEST BLOCK   */
         MVI   S99RBLN,X'14'                                       0540
*   S99VERB=S99VRBIN;               /* FUNCTION TO BE PERFORMED      */
         MVI   S99VERB,X'07'                                       0541
*   R1=ADDR(S99RBPTR);              /* ADDRESS OF POINTER TO RB      */
         LA    R1,S99RBPTR                                         0542
*   RESPECIFY                       /* RESTRICT REGISTER USAGE       */
*    (R15) RESTRICTED;              /* RESTRICT RETURN CODE REG      */
*                                                                  0543
*   /*****************************************************************/
*   /*                                                               */
*   /* MACDATE Y-2 73082                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0544
*   SVC(99);                        /* SVC 99 TO CHECK THE ATTR-LIST
*                                      NAME                          */
         SVC   99                                                  0544
*   RCODESV=R15;                    /* SAVE SVC 99 RETURN CODE       */
         ST    R15,RCODESV                                         0545
*   RESPECIFY                       /* RELEASE REGISTER FOR COMPILER */
*    (R15) UNRSTD;                  /* RELEASE RETURN CODE REG       */
*   IF RCODESV=0 THEN               /* DYNAMIC ALLOCATION SUCCESSFUL?*/
         L     @10,RCODESV                                         0547
         LTR   @10,@10                                             0547
         BNZ   @RF00547                                            0547
*     RTRNCODE=4;                   /* A MATCH OF ATTRNAME WAS FOUND */
         L     @10,RGSVAREA(,R13)                                  0548
         MVC   RTRNCODE(4,@10),@CF00266                            0548
*   ELSE                            /* COULD BE AN ERROR OR NO MATCH */
*     IF S99ERROR^='0438'X          /* WAS IT AN DYNAMIC ALLOC ERROR?*/
*       THEN                        /* IT WAS AN ERROR               */
         B     @RC00547                                            0549
@RF00547 CLC   S99ERROR(2),@CB00946                                0549
         BE    @RF00549                                            0549
*       DO;                         /* LET DAIRFAIL ISSUE ERROR MSG  */
*         DFCPPLP=CPPLPTR;          /* MOVE CPPL POINTER IN PARMLIST */
         MVC   DFCPPLP(4),CPPLPTR                                  0551
*         DFJEFF02=ADDR(MSGWTR);    /* MSG WRITER ADDRESS IS UNKNOWN */
         LA    @10,MSGWTR                                          0552
         ST    @10,DFJEFF02                                        0552
*         DFIDP=ADDR(CALLERID);     /* ADDRESS OF THE CALLER ID      */
         LA    @10,CALLERID                                        0553
         ST    @10,DFIDP                                           0553
*         DFRCP=ADDR(RCODESV);      /* POINTER TO DYNAMIC ALLOCATION
*                                      RETURN CODE                   */
         LA    @10,RCODESV                                         0554
         ST    @10,DFRCP                                           0554
*         DFS99RBP=S99RBPTR;        /* POINTER TO DYNAMIC ALLOCATION
*                                      REQUEST BLOCK                 */
         MVC   DFS99RBP(4),S99RBPTR                                0555
*         R1=ADDR(DFPARMS);         /* LOAD ADDRESS OF PARMLIST IN R1*/
         LA    R1,DFPARMS                                          0556
*         GEN(LINK EP=IKJEFF18);    /* ISSUE DIAGNOSTIC MESSAGE      */
         LINK EP=IKJEFF18
*         RTRNCODE=12;              /* SET A FAILING RETURN CODE     */
         L     @10,RGSVAREA(,R13)                                  0558
         MVC   RTRNCODE(4,@10),@CF00035                            0558
*       END;                        /* END OF DAIRFAIL PROCESSING    */
*     ELSE                          /* NO MATCH OF ATTR-LIST-NAME    */
*       RTRNCODE=0;                 /* SUCCESSFUL PARSE RETURN CODE  */
         B     @RC00549                                            0560
@RF00549 L     @10,RGSVAREA(,R13)                                  0560
         SLR   @06,@06                                             0560
         ST    @06,RTRNCODE(,@10)                                  0560
*   RESPECIFY                                                      0561
*    (R1,                                                          0561
*     R7) UNRSTD;                   /* RELEASE REG 1, 7 FOR COMPILER */
@RC00549 DS    0H                                                  0561
@RC00547 DS    0H                                                  0562
*   GEN(L R13,SAVEAR01+AFOR);       /* RESTORE PARSE REGISTER 13     */
         L R13,SAVEAR01+AFOR
*   END;                            /* RETURN TO PARSE               */
@EL00008 DS    0H                                                  0563
@EF00008 DS    0H                                                  0563
@ER00008 LM    @14,@12,12(@13)                                     0563
         BR    @14                                                 0563
@PB00008 DS    0H                                                  0564
*   GEN(EJECT);                                                    0564
*                                                                  0564
         EJECT
*/*IKJEFATT: CHART                                                   */
*/*HEADER                                                          0565
*/*                             IKJEFATT                           0565
*/*                       8-17-72                                  0565
*/*                  ATTRIB COMMAND PROCESSOR                      0565
*/*                             PAGE #                               */
*/*IKJEFATT: E ENTRY TO ATTRIB FROM TMP                              */
*/*          M INITIALIZE                                            */
*/*          L GETMAIN CORE FOR TEXT UNITS, ETC.                     */
*/*          M SET UP FOR PARSE AND VALIDITY CHECK EXIT ROUTINES     */
*/*          L PARSE TO SYNTAX CHECK OPERANDS                        */
*/*          D (NO,,YES,%PARSEOK) PARSE SUCCESSFUL?                  */
*/*          P INDICATE COMMAND ERROR TO TMP                         */
*/*%ERRPATH: D (NO,,YES,%A1) PARSE RC=4,USER IN PROMPT MODE?         */
*/*          L PUTLINE TO ISSUE ERROR MESSAGE                        */
*/*%A1:      D (YES,,NO,%M2) ERROR RETURN CODE?                      */
*/*          L IKJSTACK TO FLUSH COMMAND STACK                       */
*/*%M2:      R RETURN TO THE TMP                                     */
*/*%PARSEOK: D (NO,%A3,YES,) DEN,DSORG, LRECL,EXPDT, OR BUFOFF SPEC? */
*/*          P BUILD A TEXT UNIT FOR SPECIFIED ONES                  */
*/*          P INDICATE IN PARSE OUTPUT--VALUES NOT FOUND            */
*/*%A3:      P BUILD A TEXT UNIT FOR DUMMY AND PERM ALLOC            */
*/*          M SET UP FOR GENTRANS                                   */
*/*          L GENTRANS TO BUILD TEXT UNITS FROM PDE                 */
*/*          D (NO,%M1,YES,) GENTRANS SUCCESSFUL?                    */
*/*%A4:      M SET UP FOR SVC 99, ALLOCATION                         */
*/*          L SVC 99 -> DUMMY ALLOCATION WITH ATTRIBUTES            */
*/*          D (NO,,YES,%A5) ALLOCATION SUCCESSFUL?                  */
*/*          M SET UP FOR DAIRFAIL                                   */
*/*          L DAIRFAIL TO DOCUMENT ERROR TO THE USER                */
*/*          P INDICATE COMMAND ERROR TO TMP                         */
*/*%M3:      L (,%A1) FREEMAIN PDL AND OTHER GETMAINED CORE          */
*/*%A5:      P (,%M3) INDICATE COMMAND SUCCESSFUL TO THE TMP         */
*/*%M1:      L PUTLINE TO ISSUE ERROR MESSAGE                        */
*/*          L (,%A1) FREEMAIN GENTRANS CORE                         */
*/*ATTRNMCK: E ENTRY FROM PARSE                                      */
*/*          P BUILD A TEXT UNIT TO GO TO SVC 99                     */
*/*          P BUILD A PARAMETER LIST FOR SVC 99                     */
*/*          L SVC 99 -> INFORMATION RETRIEVAL                       */
*/*          D (NO,%M4,YES,) WAS SVC 99 SUCCESSFUL?                  */
*/*          D (NO,,YES,%NGA1) IS THE NAME A DUPLICATE ?             */
*/*          P (,%RA2) INDICATE TO PARSE NAME IS VALID               */
*/*%M4:      L DAIRFAIL TO DOCUMENT ERROR TO THE USER                */
*/*          P (,%RA2) SET FAILING RETURN CODE TO PARSE              */
*/*%NGA1:    P INDICATE TO PARSE NAME IS INVALID                     */
*/*%RA2:     R RETURN TO PARSE                                       */
*/*BLKBUFCK: E ENTRY FROM PARSE                                      */
*/*          D (NO,,YES,%NG1) SUPPLIED VALUE EXCEED LIMIT?           */
*/*          P (,%R2) INDICATE TO PARSE VALUE IS VALID               */
*/*%NG1:     P INDICATE TO PARSE VALUE IS INVALID                    */
*/*%R2:      R RETURN TO PARSE                                       */
*/*KEYBUFCK: E ENTRY FROM PARSE                                      */
*/*          D (NO,,YES,%NG2) SUPPLIED VALUE EXCEED LIMIT?           */
*/*          P (,%R3) INDICATE TO PARSE VALUE IS VALID               */
*/*%NG2:     P INDICATE TO PARSE VALUE IS INVALID                    */
*/*%R3:      R RETURN TO PARSE                                       */
*/*DENSCK:   E ENTRY FROM PARSE                                      */
*/*          D (NO,,YES,%NG3) SUPPLIED VALUE EXCEED LIMIT?           */
*/*          P INDICATE VALID VALUE IN TEXT UNIT                     */
*/*          P (,%R4) INDICATE TO PARSE VALUE IS VALID               */
*/*%NG3:     P INDICATE TO PARSE VALUE IS INVALID                    */
*/*%R4:      R RETURN TO PARSE                                       */
*/*EXPDTCK:  E ENTRY FROM PARSE                                      */
*/*          D (NO,,YES,%NG4) NUMBER LENGTH LESS THAN 5?             */
*/*          D (YES,,NO,%NG4) DAY NUMBER VALID?                      */
*/*          P INDICATE VALID DAY AND YEAR IN TEXT UNIT              */
*/*          P (,%R5) INDICATE TO PARSE VALUE IS VALID               */
*/*%NG4:     P INDICATE TO PARSE VALUE IS INVALID                    */
*/*%R5:      R RETURN TO PARSE                                       */
*/*LRECLCK:  E ENTRY FROM PARSE                                      */
*/*          D (NO,%B1,YES,) THE VALUE IS X ?                        */
*/*          D (NO,%B2,YES,) THE VALUE IS ONLY ONE DIGIT LONG?       */
*/*          P INDICATE A VALID CHARACTER X IN TEXT UNIT             */
*/*%B3:      P INDICATE TO PARSE THAT THE VALUE IS VALID             */
*/*%B4:      R RETURN TO PARSE                                       */
*/*%B1:      D (NO,,YES,%B5) IS THE FIRST CHARACTER NUMERIC?         */
*/*%B2:      P (,%B4) INDICATE TO PARSE THAT THE VALUE IS INVALID    */
*/*%B5:      D (NO,%B6,YES,%B2) SUPPLIED VALUE EXCEED LIMIT?         */
*/*%B6:      P (,%B3) INDICATE A VALID NUMBER IN TEXT UNIT           */
*/*BUFCK:    E ENTRY FROM PARSE                                      */
*/*          D (NO,%T1,YES,) THE VALUE IS L ?                        */
*/*          D (NO,%T2,YES,) THE VALUE IS ONLY ONE DIGIT LONG?       */
*/*          P INDICATE A VALID CHARACTER L IN TEXT UNIT             */
*/*%T3:      P INDICATE TO PARSE THAT THE VALUE IS VALID             */
*/*%T4:      R RETURN TO PARSE                                       */
*/*%T1:      D (NO,,YES,%T5) IS THE FIRST CHARACTER NUMERIC?         */
*/*%T2:      P (,%T4) INDICATE TO PARSE THAT THE VALUE IS INVALID    */
*/*%T5:      P (,%T3) INDICATE A VALID NUMBER IN TEXT UNIT           */
*/*IKJEFATT: END                                                     */
*                                                                  0565
*   END IKJEFATT                                                   0565
*                                                                  0565
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJZB831)                                       */
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */
*/*%INCLUDE SYSLIB  (IKJSTPL )                                       */
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */
*                                                                  0565
*       ;                                                          0565
         B     @EL00001                                            0565
@DATA    DS    0H
@CH00250 DC    H'5'
@CH00065 DC    H'7'
@CH00034 DC    H'11'
@CH00913 DC    H'255'
@CH00928 DC    H'366'
@CH00908 DC    H'32760'
@SM00949 MVC   MSGBUF(0,Y),MESSTXT(X)
@SM00951 MVC   COREGOT(0,@14),PUTLIST
@SM00953 MVC   S99TUPAR(0,@10),VALNAME(@15)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJEFATT CSECT
         DS    0F
@CF00033 DC    F'1'
@CH00033 EQU   @CF00033+2
@CF00063 DC    F'2'
@CH00063 EQU   @CF00063+2
@CF00293 DC    F'3'
@CH00293 EQU   @CF00293+2
@CF00266 DC    F'4'
@CH00266 EQU   @CF00266+2
@CF00035 DC    F'12'
@CH00035 EQU   @CF00035+2
@CF00444 DC    F'16'
@CF00948 DC    F'-4'
@DATD    DSECT
         DS    0D
SERVRPTR DS    A
GTPLPTR  DS    A
VALPARMS DS    A
CPPLPTR  DS    A
RCODESV  DS    F
CDENSITY DS    F
S99TUFP  DS    A
R14SAVE3 DS    F
D        DS    F
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
WORKAREA DS    CL209
         ORG   WORKAREA
PARSPARM DS    CL4
         ORG   PARSPARM
PDLADDR  DS    AL4
         ORG   WORKAREA+4
SCORE    DS    CL20
SERTEPRM DS    CL28
         ORG   SERTEPRM
ADUPT    DS    AL4
ADECT    DS    AL4
ADECB    DS    AL4
@NM00002 DS    AL4
@NM00003 DS    AL4
@NM00004 DS    AL4
@NM00005 DS    AL4
         ORG   WORKAREA+52
COMMECB  DS    FL4
PARMCORE DS    CL153
         ORG   PARMCORE
GTPLAREA DS    CL24
ADBKAREA DS    CL32
TEXTAREA DS    CL77
ATNMCORE DS    CL20
         ORG   WORKAREA+209
         DS    CL3
CORE     DS    CL4
         ORG   CORE
SUBPOOLN DS    CL1
PSIZE    DS    AL3
         ORG   CORE+4
STACKLSD DS    CL20
MSGPARMS DS    CL202
         ORG   MSGPARMS
LEVELONE DS    CL12
         ORG   LEVELONE
PTRLEVL2 DS    AL4
SEGNUM1  DS    AL4
ADSEG1   DS    AL4
         ORG   MSGPARMS+12
LEVELTWO DS    CL12
         ORG   LEVELTWO
ADNEXT   DS    AL4
SEGNUM2  DS    AL4
ADSEG2   DS    AL4
         ORG   MSGPARMS+24
MSGBUFER DS    CL124
         ORG   MSGBUFER
LENOFMSG DS    FL2
OFFSET   DS    FL2
FORMTBUF DS    CL120
         ORG   MSGPARMS+148
MSGBUF2  DS    CL54
         ORG   MSGBUF2
LENMSG2  DS    FL2
OFFSET2  DS    FL2
FORMBUF2 DS    CL50
         ORG   MSGPARMS+202
         DS    CL2
MSGSGMTS DS    CL40
         ORG   MSGSGMTS
SEG1     DS    AL4
SEG2     DS    AL4
SEG3     DS    AL4
SEG4     DS    AL4
SEG5     DS    AL4
SEG6     DS    AL4
SEG7     DS    AL4
SEG8     DS    AL4
SEG9     DS    AL4
SEGEND   DS    AL4
         ORG   MSGSGMTS+40
RTCDAREA DS    CL8
         ORG   RTCDAREA
@NM00016 DS    CL2
RTCDLEN  DS    FL2
RETDEC   DS    CL4
         ORG   RETDEC
@NM00017 DS    CL3
FZERO    DS    CL1
         ORG   RTCDAREA+8
UNPACK   DS    CL8
S99RB    DS    CL20
         ORG   S99RB
S99RBLN  DS    CL1
S99VERB  DS    CL1
S99FLAG1 DS    CL2
         ORG   S99FLAG1
S99FLG11 DS    CL1
         ORG   S99FLG11
S99ONCNV DS    BL1
S99NOCNV EQU   S99FLG11+0
S99NOMNT EQU   S99FLG11+0
S99JBSYS EQU   S99FLG11+0
         ORG   S99FLAG1+1
S99FLG12 DS    CL1
         ORG   S99RB+4
S99RSC   DS    CL4
         ORG   S99RSC
S99ERROR DS    CL2
S99INFO  DS    CL2
         ORG   S99RB+8
S99TXTPP DS    AL4
S99RSV01 DS    FL4
S99FLAG2 DS    CL4
         ORG   S99FLAG2
S99FLG21 DS    CL1
         ORG   S99FLG21
S99WTVOL DS    BL1
S99WTDSN EQU   S99FLG21+0
S99NORES EQU   S99FLG21+0
S99WTUNT EQU   S99FLG21+0
S99OFFLN EQU   S99FLG21+0
S99TIONQ EQU   S99FLG21+0
S99CATLG EQU   S99FLG21+0
S99MOUNT EQU   S99FLG21+0
         ORG   S99FLAG2+1
S99FLG22 DS    CL1
         ORG   S99FLG22
S99UDEVT DS    BL1
S99PCINT EQU   S99FLG22+0
         ORG   S99FLAG2+2
S99FLG23 DS    CL1
S99FLG24 DS    CL1
         ORG   S99RB+20
DFPARMS  DS    CL20
         ORG   DFPARMS
DFS99RBP DS    AL4
         ORG   DFS99RBP
DFDAPLP  DS    AL4
         ORG   DFPARMS+4
DFRCP    DS    AL4
DFJEFF02 DS    AL4
DFIDP    DS    AL4
DFCPPLP  DS    AL4
         ORG   DFPARMS+20
DECSIZE  DS    CL8
VALCKWA  DS    10A
SAVEAR01 DS    18A
IKJEFATT CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
MSGWTR   DC    F'0'
CALLERID DC    H'50'
@CB00445 DC    X'0001'
@CB00511 DC    X'0022'
@CB00515 DC    X'0024'
@CB00549 DC    X'0035'
@CB00561 DC    X'003B'
@CB00563 DC    X'003C'
@CB00575 DC    X'0042'
@CB00607 DC    X'0052'
@CB00751 DC    X'0000'
@CB00869 DC    X'2000'
@CB00870 DC    X'2100'
@CB00871 DC    X'0200'
@CB00872 DC    X'0300'
@CB00873 DC    X'4000'
@CB00874 DC    X'4100'
@CB00920 DC    X'8000'
@CB00946 DC    X'0438'
PDECMPRE DC    X'FF000000'
CHARX    DC    CL1'X'
CHARL    DC    CL1'L'
MSG01    DS    CL33
         ORG   MSG01
MSGO1LEN DC    H'31'
MSGO1TXT DC    CL31'IKJ60743I COMMAND SYSTEM ERROR+'
         ORG   MSG01+33
         DS    CL1
MSG02    DS    CL54
         ORG   MSG02
MSGO2LEN DC    H'52'
MSGO2TXT DC    CL52'IKJ60741I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMANC
               D'
         ORG   MSG02+54
MSG03    DS    CL20
         ORG   MSG03
MSG03LEN DC    H'18'
MSG03TXT DC    CL18' RETURN CODE IS '
         ORG   MSG03+20
MSG04    DS    CL12
         ORG   MSG04
MSG06LEN DC    H'10'
MSG06TXT DC    CL10'IKJ60639I '
         ORG   MSG04+12
PARSE    DS    CL7
         ORG   PARSE
@NM00012 DC    H'5'
@NM00013 DC    CL5'PARSE'
         ORG   PARSE+7
         DS    CL1
GENTRANS DS    CL10
         ORG   GENTRANS
@NM00014 DC    H'8'
@NM00015 DC    CL8'GENTRANS'
         ORG   GENTRANS+10
KEYTABLE DS    CL70
         ORG   KEYTABLE
BFALNTAB DS    CL6
         ORG   BFALNTAB
BFALNKEY DC    X'002E'
BFALNCNT DC    AL2(2)
BFALNF   DC    X'01'
BFALND   DC    X'02'
         ORG   KEYTABLE+6
BFTEKTAB DS    CL8
         ORG   BFTEKTAB
BFTEKKEY DC    X'002F'
BFTEKCNT DC    AL2(4)
BFTEKS   DC    X'40'
BFTEKE   DC    X'10'
BFTEKA   DC    X'60'
BFTEKR   DC    X'20'
         ORG   KEYTABLE+14
EROPTTAB DS    CL7
         ORG   EROPTTAB
EROPTKEY DC    X'003D'
EROPTCNT DC    AL2(3)
EROPTSKP DC    X'40'
EROPTACC DC    X'80'
EROPTABE DC    X'20'
         ORG   KEYTABLE+21
OPTCDTAB DS    CL15
         ORG   OPTCDTAB
OPTCDKEY DC    X'0045'
OPTCDCNT DC    AL2(11)
OPTCDC   DC    X'20'
OPTCDT   DC    X'02'
OPTCDW   DC    X'80'
OPTCDQ   DC    X'08'
OPTCDA   DC    X'08'
OPTCDB   DC    X'40'
OPTCDE   DC    X'20'
OPTCDF   DC    X'10'
OPTCDH   DC    X'10'
OPTCDZ   DC    X'04'
OPTCDR   DC    X'01'
         ORG   KEYTABLE+36
TRTCHTAB DS    CL8
         ORG   TRTCHTAB
TRTCHKEY DC    X'004F'
TRTCHCNT DC    AL2(4)
TRTCHC   DC    X'13'
TRTCHE   DC    X'23'
TRTCHET  DC    X'2B'
TRTCHT   DC    X'3B'
         ORG   KEYTABLE+44
INOUTTAB DS    CL6
         ORG   INOUTTAB
INOUTKEY DC    X'0021'
INOUTCNT DC    AL2(2)
INPUTSET DC    X'80'
OUTPTSET DC    X'40'
         ORG   KEYTABLE+50
DIAGNTAB DS    CL5
         ORG   DIAGNTAB
DIAGNKEY DC    X'0054'
DIAGNCNT DC    AL2(1)
DIAGNSTR DC    X'00'
         ORG   KEYTABLE+55
RECFMTAB DS    CL13
         ORG   RECFMTAB
RECFMKEY DC    X'0049'
RECFMCNT DC    AL2(9)
RECFMA   DC    X'04'
RECFMB   DC    X'10'
RECFMF   DC    X'80'
RECFMM   DC    X'02'
RECFMS   DC    X'08'
RECFMT   DC    X'20'
RECFMU   DC    X'C0'
RECFMV   DC    X'40'
RECFMD   DC    X'20'
         ORG   KEYTABLE+68
ENDTAB   DC    X'FFFF'
         ORG   KEYTABLE+70
KEYLIST  DS    CL76
         ORG   KEYLIST
KEYATTRM DC    X'0001'
KEYATTRS DC    X'0000'
KEYBFALM DC    X'0000'
KEYBFALS DC    X'002E'
KEYBFTEM DC    X'0000'
KEYBFTES DC    X'002F'
KEYBLKSM DC    X'0000'
KEYBLKSS DC    X'0030'
KEYBUFLM DC    X'0000'
KEYBUFLS DC    X'0032'
KEYBUFNM DC    X'0000'
KEYBUFNS DC    X'0034'
KEYBUFOM DC    X'0000'
KEYBUFOS DC    X'0035'
KEYEROPM DC    X'0000'
KEYEROPS DC    X'003D'
KEYKEYLM DC    X'0000'
KEYKEYLS DC    X'0040'
KEYLRECM DC    X'0000'
KEYLRECS DC    X'0042'
KEYNCPM  DC    X'0000'
KEYNCPS  DC    X'0044'
KEYOPTCM DC    X'0000'
KEYOPTCS DC    X'0045'
KEYRECFM DC    X'0000'
KEYRECFS DC    X'0049'
KEYINOTM DC    X'0021'
KEYINOTS DC    X'0000'
KEYRETPM DC    X'0000'
KEYRETPS DC    X'0023'
KEYDIAGM DC    X'0000'
KEYDIAGS DC    X'0054'
KEYDENM  DC    X'0000'
KEYDENS  DC    X'003B'
KEYLIMCM DC    X'0000'
KEYLIMCS DC    X'0041'
KEYDSORM DC    X'0000'
KEYDSORS DC    X'003C'
         ORG   KEYLIST+76
KYLIST   DS    CL76
         ORG   KYLIST
KYATTRM  DC    X'0001'
KYATTRS  DC    X'0000'
KYBFALM  DC    X'0000'
KYBFALS  DC    X'002E'
KYBFTEM  DC    X'0000'
KYBFTES  DC    X'002F'
KYBLKSM  DC    X'0000'
KYBLKSS  DC    X'0030'
KYBUFLM  DC    X'0000'
KYBUFLS  DC    X'0032'
KYBUFNM  DC    X'0000'
KYBUFNS  DC    X'0034'
KYBUFOM  DC    X'0000'
KYBUFOS  DC    X'0035'
KYEROPM  DC    X'0000'
KYEROPS  DC    X'003D'
KYTRTCM  DC    X'0000'
KYTRTCS  DC    X'004F'
KYLRECM  DC    X'0000'
KYLRECS  DC    X'0042'
KYNCPM   DC    X'0000'
KYNCPS   DC    X'0044'
KYOPTCM  DC    X'0000'
KYOPTCS  DC    X'0045'
KYRECFM  DC    X'0000'
KYRECFS  DC    X'0049'
KYINOTM  DC    X'0021'
KYINOTS  DC    X'0000'
KYRETPM  DC    X'0000'
KYRETPS  DC    X'0023'
KYDIAGM  DC    X'0000'
KYDIAGS  DC    X'0054'
KYDENM   DC    X'0000'
KYDENS   DC    X'003B'
KYLIMCM  DC    X'0000'
KYLIMCS  DC    X'0041'
KYDSORM  DC    X'0000'
KYDSORS  DC    X'003C'
         ORG   KYLIST+76
IKJEFATT CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFATT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R7       EQU   @07
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
I        EQU   @06
X        EQU   @05
Y        EQU   @04
R11      EQU   @11
R12      EQU   @12
GTPL     EQU   0
GTPLPDL  EQU   GTPL
GTPLPCL  EQU   GTPL+4
GTPLKLST EQU   GTPL+8
GTPLTBLE EQU   GTPL+12
GTPLABLK EQU   GTPL+16
GTPLOUTA EQU   GTPL+20
ADDBLOCK EQU   0
ADDBKLN  EQU   ADDBLOCK
ADBKPTR  EQU   ADDBLOCK+4
ATTRPDL  EQU   0
ATNPDE   EQU   ATTRPDL+8
ATNFLAGS EQU   ATNPDE+6
BUFOFFWD EQU   ATTRPDL+26
KEYLEKWD EQU   ATTRPDL+30
TRTCHWD  EQU   KEYLEKWD
LRECLKWD EQU   ATTRPDL+32
INPUTKWD EQU   ATTRPDL+40
EXPDTKWD EQU   ATTRPDL+42
RETPDWD  EQU   EXPDTKWD
DENSITWD EQU   ATTRPDL+46
DSORGWD  EQU   ATTRPDL+50
BLKSISUB EQU   ATTRPDL+56
BLKSFLAG EQU   BLKSISUB+6
BUFOFSUB EQU   ATTRPDL+64
BUFFFLAG EQU   BUFOFSUB+6
BUFLSUB  EQU   ATTRPDL+72
BUFLFLAG EQU   BUFLSUB+6
BUFNOSUB EQU   ATTRPDL+80
BUFNFLAG EQU   BUFNOSUB+6
KEYLESUB EQU   ATTRPDL+88
KEYLFLAG EQU   KEYLESUB+6
LRECLSUB EQU   ATTRPDL+96
LRECFLAG EQU   LRECLSUB+6
NCPSUB   EQU   ATTRPDL+104
NCPFLAG  EQU   NCPSUB+6
EXPDTSUB EQU   ATTRPDL+112
EXPDFLAG EQU   EXPDTSUB+6
RETPD    EQU   ATTRPDL+120
RETPFLAG EQU   RETPD+6
DENSUB   EQU   ATTRPDL+128
DENFLAG  EQU   DENSUB+6
LIMCTSUB EQU   ATTRPDL+136
LIMCFLAG EQU   LIMCTSUB+6
DSORGSUB EQU   ATTRPDL+172
EXITLIST EQU   0
PDEADR   EQU   EXITLIST
VALUEPDE EQU   0
VALUEPTR EQU   VALUEPDE
VALUELEN EQU   VALUEPDE+4
VALNAME  EQU   0
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
COREGOT  EQU   0
OUTADDR  EQU   4
RGSVAREA EQU   4
RTRNCODE EQU   16
RETPOINT EQU   0
LRECLX   EQU   0
HALFLREC EQU   LRECLX
BUFOFFL  EQU   0
R2POINT  EQU   0
STPL     EQU   0
STPLSTPB EQU   STPL+12
STPB     EQU   0
@NM00008 EQU   STPB
MSGBUF   EQU   0
MESSAGES EQU   0
MESSLEN  EQU   MESSAGES
MESSTXT  EQU   MESSAGES+2
SEGTABLE EQU   0
CPPL     EQU   0
CPPLCBUF EQU   CPPL
CPPLUPT  EQU   CPPL+4
CPPLECT  EQU   CPPL+12
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUP   EQU   0
S99TUPND EQU   S99TUP
S99TUNIT EQU   0
S99TUKEY EQU   S99TUNIT
S99TUNUM EQU   S99TUNIT+2
S99TUENT EQU   S99TUNIT+4
S99TULNG EQU   S99TUENT
S99TUPAR EQU   S99TUENT+2
S99TUFLD EQU   0
PPL      EQU   0
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
TEXTDATA EQU   0
TXDTSBPL EQU   TEXTDATA
TXDTLNGH EQU   TEXTDATA+1
TXDTPTR  EQU   TEXTDATA+8
DFID     EQU   0
@NM00019 EQU   DFID
DFMSGWTP EQU   0
DFRC     EQU   0
TMCTPARM EQU   0
IOPLPTR  EQU   SERVRPTR
STPLPTR  EQU   SERVRPTR
PPLPTR   EQU   SERVRPTR
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IDNUM    EQU   DFID+1
@NM00020 EQU   @NM00019
DFWTP    EQU   @NM00019
@NM00018 EQU   TEXTDATA+6
TXDTNUMB EQU   TEXTDATA+4
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
S99TUPRM EQU   S99TUFLD+2
S99TULEN EQU   S99TUFLD
S99TUPLN EQU   S99TUPTR
CPPLPSCB EQU   CPPL+8
STPBMBRN EQU   STPB+16
STPBOTDD EQU   STPB+12
STPBINDD EQU   STPB+8
STPBALSD EQU   STPB+4
@NM00011 EQU   @NM00008+1
SPBFLUSH EQU   @NM00008+1
@NM00010 EQU   @NM00008+1
@NM00009 EQU   @NM00008
STPLECB  EQU   STPL+8
STPLECT  EQU   STPL+4
STPLUPT  EQU   STPL
HALFBUFO EQU   BUFOFFL
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
VALUEFLG EQU   VALUEPDE+6
VALMSG   EQU   EXITLIST+8
USERWORD EQU   EXITLIST+4
RECFSUB9 EQU   ATTRPDL+190
RECFSUB8 EQU   ATTRPDL+188
RECFSUB7 EQU   ATTRPDL+186
RECFSUB6 EQU   ATTRPDL+184
RECFSUB5 EQU   ATTRPDL+182
RECFSUB4 EQU   ATTRPDL+180
RECFSUB3 EQU   ATTRPDL+178
RECFSUB2 EQU   ATTRPDL+176
RECFSUB1 EQU   ATTRPDL+174
DIAGNSUB EQU   ATTRPDL+170
OPTCSU11 EQU   ATTRPDL+168
OPTCSU10 EQU   ATTRPDL+166
OPTCSUB9 EQU   ATTRPDL+164
OPTCSUB8 EQU   ATTRPDL+162
OPTCSUB7 EQU   ATTRPDL+160
OPTCSUB6 EQU   ATTRPDL+158
OPTCSUB5 EQU   ATTRPDL+156
OPTCSUB4 EQU   ATTRPDL+154
OPTCSUB3 EQU   ATTRPDL+152
OPTCSUB2 EQU   ATTRPDL+150
OPTCSUB1 EQU   ATTRPDL+148
TRTCHSUB EQU   ATTRPDL+146
EROPTSUB EQU   ATTRPDL+144
LIMCRESV EQU   LIMCTSUB+7
RSVLIMCT EQU   LIMCFLAG
LIMCPRES EQU   LIMCFLAG
LIMCLEN  EQU   LIMCTSUB+4
LIMCPTR  EQU   LIMCTSUB
DENRESV  EQU   DENSUB+7
RSVDEN   EQU   DENFLAG
DENPRES  EQU   DENFLAG
DENLEN   EQU   DENSUB+4
DENPTR   EQU   DENSUB
RETPRESV EQU   RETPD+7
RSVRETPD EQU   RETPFLAG
RETPPRES EQU   RETPFLAG
RETPLEN  EQU   RETPD+4
RETPPTR  EQU   RETPD
EXPDRESV EQU   EXPDTSUB+7
RSVEXPDT EQU   EXPDFLAG
EXPDPRES EQU   EXPDFLAG
EXPDTLEN EQU   EXPDTSUB+4
EXPDPTR  EQU   EXPDTSUB
NCPRESV  EQU   NCPSUB+7
RSVNCP   EQU   NCPFLAG
NCPPRES  EQU   NCPFLAG
NCPLEN   EQU   NCPSUB+4
NCPPTR   EQU   NCPSUB
LRELRESV EQU   LRECLSUB+7
LRECRESV EQU   LRECFLAG
LRECPRES EQU   LRECFLAG
LRECLLEN EQU   LRECLSUB+4
LRECLPTR EQU   LRECLSUB
KEYLRESV EQU   KEYLESUB+7
RSVKEYLE EQU   KEYLFLAG
KEYLPRES EQU   KEYLFLAG
KEYLLEN  EQU   KEYLESUB+4
KEYLEPTR EQU   KEYLESUB
BUFNRESV EQU   BUFNOSUB+7
RSVBUFNO EQU   BUFNFLAG
BUFNPRES EQU   BUFNFLAG
BUFNOLEN EQU   BUFNOSUB+4
BUFNOPTR EQU   BUFNOSUB
BUFLRESV EQU   BUFLSUB+7
RSVBUFL  EQU   BUFLFLAG
BUFLPRES EQU   BUFLFLAG
BUFLLEN  EQU   BUFLSUB+4
BUFLPTR  EQU   BUFLSUB
BUFFRESV EQU   BUFOFSUB+7
RSVBUFOF EQU   BUFFFLAG
BUFFPRES EQU   BUFFFLAG
BUFOFLEN EQU   BUFOFSUB+4
BUFOFPTR EQU   BUFOFSUB
BLKSRESV EQU   BLKSISUB+7
RSVBLKSI EQU   BLKSFLAG
BLKSPRES EQU   BLKSFLAG
BLKSILEN EQU   BLKSISUB+4
BLKSIPTR EQU   BLKSISUB
BFTEKSUB EQU   ATTRPDL+54
BFALNSUB EQU   ATTRPDL+52
LIMCTWD  EQU   ATTRPDL+48
DIAGNSWD EQU   ATTRPDL+44
OUTPTWD  EQU   INPUTKWD
RECFMKWD EQU   ATTRPDL+38
OPTCDKWD EQU   ATTRPDL+36
NCPKWD   EQU   ATTRPDL+34
EROPTKWD EQU   ATTRPDL+28
BUFNOKWD EQU   ATTRPDL+24
BUFLKWD  EQU   ATTRPDL+22
BLKSIKWD EQU   ATTRPDL+20
BFTEKWD  EQU   ATTRPDL+18
BFALNKWD EQU   ATTRPDL+16
ATTRRSVD EQU   ATNPDE+7
RSVATN   EQU   ATNFLAGS
ATNPRES  EQU   ATNFLAGS
ATNLEN   EQU   ATNPDE+4
ATNPTR   EQU   ATNPDE
@NM00007 EQU   ATTRPDL+4
@NM00006 EQU   ATTRPDL
@NM00001 EQU   ADDBLOCK+2
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00130 EQU   @RC00128
@RF00271 EQU   @EL00001
@RT00328 EQU   FRMTEND
@RC00430 EQU   @RC00428
@RC00495 EQU   @RC00493
@ENDDATA EQU   *
         END   IKJEFATT,(C'PLS2104',0701,77124)

         TITLE 'IFCETRN6 FOR EREP SUPPORT OF 3705/27RN'
         GBLC  &CSECT,&DSECT
         PROLOG NAME=IFCETRN6
         DSGEN (RECT,8),(OPSYS,8),(SWITCH,24),(RCDID,8),(SPARE1,16)
         DSGEN (DATE,32),(TIME,32)
         DSGEN (SPARE2,8),(CPUSER,24),(MODEL,16),(SPARE3,16)
         DSGEN (CUA,16),(NETNAME,64)
         DSGEN (NETADR,16),(LIBADR,16),(RECMD,8),(RECID,8)
         DSGEN (ISBOX,8),(BTUMOD,8),(RSVD,32)
         DSGEN (REG100,1),(REG101,1),(REG102,1),                       C
               (REG103,1),(REG104,1),(REG105,1),(REG106,1),(REG107,1), C
               (REG108,1),(REG109,1),(REG110,1),(REG111,1),(REG112,1), C
               (REG113,1),(REG114,1),(REG115,1),(REG200,1),(REG201,1), C
               (REG202,1),(REG203,1),(REG204,1),(REG205,1),(REG206,1), C
               (REG207,1),(REG208,1),(REG209,1),(REG210,1),(REG211,1), C
               (REG212,1),(REG213,1),(REG214,1),(REG215,1),(REG300,1), C
               (REG301,1),(REG302,1),(REG303,1),(REG304,1),(REG305,1), C
               (REG306,1),(REG307,1),(REG308,1),(REG309,1),(REG310,1), C
               (REG311,1),(REG312,1),(REG313,1),(REG314,1),(REG315,1)
         DSGEN (REG400,1),(REG401,1),(REG402,1),(REG403,1),(REG404,1), C
               (REG405,1),(REG406,1),(REG407,1),(REG408,1),(REG409,1), C
               (REG410,1),(REG411,1),(REG412,1),(REG413,1),(REG414,1), C
               (REG415,1),(REG500,1),(REG501,1),(REG502,1),(REG503,1), C
               (REG504,1),(REG505,1),(REG506,1),(REG507,1),(REG508,1), C
               (REG509,1),(REG510,1),(REG511,1),(REG512,1),(REG513,1), C
               (REG514,1),(REG515,1)                           @D3502BL
         DSGEN (REG600,1),(REG601,1),(REG602,1),(REG603,1),(REG604,1), C
               (REG605,1),(REG606,1),(REG607,1),(REG608,1),(REG609,1), C
               (REG610,1),(REG611,1),(REG612,1),(REG613,1),(REG614,1), C
               (REG615,1),(REG700,1),(REG701,1),(REG702,1),(REG703,1), C
               (REG704,1),(REG705,1),(REG706,1),(REG707,1),(REG708,1), C
               (REG709,1),(REG710,1),(REG711,1),(REG712,1),(REG713,1), C
               (REG714,1),(REG715,1)                           @D3502BL
         DSGEN (REG800,1),(REG801,1),(REG802,1),(REG803,1),(REG804,1), C
               (REG805,1),(REG806,1),(REG807,1),(REG808,1),(REG809,1), C
               (REG810,1),(REG811,1),(REG812,1),(REG813,1),(REG814,1), C
               (REG815,1),(REG900,1),(REG901,1),(REG902,1),(REG903,1), C
               (REG904,1),(REG905,1),(REG906,1),(REG907,1),(REG908,1), C
               (REG909,1),(REG910,1),(REG911,1),(REG912,1),(REG913,1), C
               (REG914,1),(REG915,1)                           @D3502BL
         DSGEN (REG1000,1),(REG1001,1),(REG1002,1),(REG1003,1),        C
               (REG1004,1),(REG1005,1),(REG1006,1),(REG1007,1),        C
               (REG1008,1),(REG1009,1),(REG1010,1),(REG1011,1),        C
               (REG1012,1),(REG1013,1),(REG1014,1),(REG1015,1) @D3502BL
         DSGEN (REG1100,1),(REG1101,1),(REG1102,1),(REG1103,1),        C
               (REG1104,1),(REG1105,1),(REG1106,1),(REG1107,1),        C
               (REG1108,1),(REG1109,1),(REG1110,1),(REG1111,1),        C
               (REG1112,1),(REG1113,1),(REG1114,1),(REG1115,1) @D3502BL
         DSGEN (REG1200,1),(REG1201,1),(REG1202,1),(REG1203,1),        C
               (REG1204,1),(REG1205,1),(REG1206,1),(REG1207,1),        C
               (REG1208,1),(REG1209,1),(REG1210,1),(REG1211,1),        C
               (REG1212,1),(REG1213,1),(REG1214,1),(REG1215,1) @D3502BL
         DSGEN (REG1300,1),(REG1301,1),(REG1302,1),(REG1303,1),        C
               (REG1304,1),(REG1305,1),(REG1306,1),(REG1307,1),        C
               (REG1308,1),(REG1309,1),(REG1310,1),(REG1311,1),        C
               (REG1312,1),(REG1313,1),(REG1314,1),(REG1315,1) @D3502BL
         DSGEN (REG1400,1),(REG1401,1),(REG1402,1),(REG1403,1),        C
               (REG1404,1),(REG1405,1),(REG1406,1),(REG1407,1),        C
               (REG1408,1),(REG1409,1),(REG1410,1),(REG1411,1),        C
               (REG1412,1),(REG1413,1),(REG1414,1),(REG1415,1) @D3502BL
         DSGEN (REG1500,1),(REG1501,1),(REG1502,1),(REG1503,1),        C
               (REG1504,1),(REG1505,1),(REG1506,1),(REG1507,1),        C
               (REG1508,1),(REG1509,1),(REG1510,1),(REG1511,1),        C
               (REG1512,1),(REG1513,1),(REG1514,1),(REG1515,1) @D3502BL
         DSGEN (RMSSCBIE,16)                                   @D3502BL
         DSGEN (RMSSCBNT,16)                                   @D3502BL
         DSGEN (RMSSCBBI,16)                                   @D3502BL
         DSGEN (RMSSCBNR,16)                                   @D3502BL
         DSGEN (RMSSCBIA,16)                                   @D3502BL
         DSGEN (RMSSCBNI,16)                                   @D3502BL
         DSGEN (RMSSCBRY,16,EQU,REG900)                        @D3502BL
         EJECT                                                 @D3502BL
&CSECT   CSECT                                                 @D3502BL
XSAVE    DC    2F'0'                                           @D3502BL
ZERO     DC    X'000000'                                       @D3502BL
WORK     DC    D'0'                                            @D3502BL
H01      EQU   X'01'                                           @D3502BL
H02      EQU   X'02'                                           @D3502BL
H03      EQU   X'03'                                           @D3502BL
H04      EQU   X'04'                                           @D3502BL
H05      EQU   X'05'                                           @D3502BL
H07      EQU   X'07'                                           @D3502BL
H08      EQU   X'08'                                           @D3502BL
H10      EQU   X'10'                                           @D3502BL
H20      EQU   X'20'                                           @D3502BL
H40      EQU   X'40'                                           @D3502BL
H70      EQU   X'70'                                           @D3502BL
H80      EQU   X'80'                                           @D3502BL
L21      EQU   21                                              @D3502BL
L23      EQU   23                                              @D3502BL
L24      EQU   24                                              @D3502BL
L25      EQU   25                                              @D3502BL
L26      EQU   26                                              @D3502BL
L27      EQU   27                                              @D3502BL
L28      EQU   28                                              @D3502BL
L29      EQU   29                                              @D3502BL
L33      EQU   23                                              @D3502BL
L31      EQU   31                                              @D3502BL
L35      EQU   35                                              @D3502BL
         EJECT                                                 @D3502BL
***********************************************************************
**                       SPECIAL ROUTINES                            **
***********************************************************************
CCBIT6   TM    REG1314,H02                                     @D3502BL
         BO    SECOND                                          @D3502BL
         MVC   L0(L3,R3),PRI                                   @D3502BL
         BR    R14                                             @D3502BL
SECOND   MVC   L0(L3,R3),SEC                                   @D3502BL
         BR    R14                                             @D3502BL
         SPACE 3                                               @D3502BL
LINKERR  TM    RECMD,1                        LINK ERROR?      @D3502BL
         BZR   R14                            YES...CARRY ON   @D3502BL
         XR    R15,R15                        DON'T PRINT THIS LINE
         BR    R14                            RETURN           @D3502BL
         SPACE 3                                               @D3502BL
STNERR   TM    RECMD,1                        STATION ERROR?   @D3502BL
         BOR   R14                            YES...CARRY ON   @D3502BL
         XR    R15,R15                        DON'T PRINT THIS LINE
         BR    R14                            RETURN           @D3502BL
         SPACE 3                                               @D3502BL
LXBSTAT  TM    L0(R4),X'80'                                    @D3502BL
         BO    TEST1                                           @D3502BL
         TM    L0(R4),X'9E'                                    @D3502BL
         BZ    INCFM                                           @D3502BL
NOPRT    XR    R15,R15                                         @D3502BL
         BR    R14                                             @D3502BL
INCFM    MVC   L0(L35,R3),TOIFR                                @D3502BL
         BR    R14                                             @D3502BL
TEST1    TM    L0(R4),X'7E'                                    @D3502BL
         BNZ   TEST2                                           @D3502BL
         MVC   L0(L26,R3),TONR                                 @D3502BL
         BR    R14                                             @D3502BL
TEST2    TM    L0(R4),X'5E'                                    @D3502BL
         BZ    INCFM                                           @D3502BL
         TM    L0(R4),X'F0'                                    @D3502BL
         BNO   TEST3                                           @D3502BL
         MVC   L0(L31,R3),SMIE                                 @D3502BL
         BR    R14                                             @D3502BL
TEST3    TM    L0(R4),X'E0'                                    @D3502BL
         BNO   NOPRT                                           @D3502BL
         MVC   L0(L28,R3),STHE                                 @D3502BL
         BR    R14                                             @D3502BL
TOIFR    DC    C'TIME-OUT, INCOMPLETE FRAME RECEIVED'          @D3502BL
TONR     DC    C'TIME-OUT, NOTHING RECEIVED'                   @D3502BL
SMIE     DC    C'SUSPECTED MODEM INTERFACE ERROR'              @D3502BL
STHE     DC    C'SUSPECTED TCU HARDWARE ERROR'                 @D3502BL
         SPACE 3                                               @D3502BL
MOVNAME  MVC   L0(L8,R3),L0(R4)                                @D3502BL
         BR    R14                                             @D3502BL
         SPACE 3                                               @D3502BL
ISMOD03  STM   R5,R6,XSAVE                                     @D3502BL
         TM    L0(R4),H03                                      @D3502BL
         BOR   R14                                             @D3502BL
         LA    R5,SKIPLN03-4                                   @D3502BL
         LA    R6,SKIPLB03-1                                   @D3502BL
         STM   R5,R6,XR9PTR                                    @D3502BL
RSTRREGS LM    R5,R6,XSAVE                                     @D3502BL
         BR    R14                                             @D3502BL
         SPACE 3                                               @D3502BL
RTNR     ST    R6,XSAVE                                        @D3502BL
         SR    R6,R6                                           @D3502BL
         IC    R6,L0(R4)                                       @D3502BL
         SLL   R6,L28                                          @D3502BL
         SRL   R6,L29                                          @D3502BL
CONVRT   CVD   R6,WORK                                         @D3502BL
         UNPK  L0(L2,R3),WORK+L6(L2)                           @D3502BL
         MVZ   L1(L1,R3),L0(R3)                                @D3502BL
         L     R6,XSAVE                                        @D3502BL
         BR    R14                                             @D3502BL
         SPACE 3                                               @D3502BL
RTNS     ST    R6,XSAVE                                        @D3502BL
         SR    R6,R6                                           @D3502BL
         IC    R6,L0(R4)                                       @D3502BL
         SRL   R6,L5                                           @D3502BL
         B     CONVRT                                          @D3502BL
*                                                              @D3502BL
PRI      DC    C'PRI'                                          @D3502BL
SEC      DC    C'SEC'                                          @D3502BL
         DC    X'01'                                           @D3502BL
         DC    X'000B0B00'                                     @D3502BL
         EJECT                                                 @D3502BL
         ENTRIES ,                                             @D3502BL
         LINE  (23,23),(2,31),SKIP=2                           @D3502BL
         HEX   NETADR,0,2B                                     @D3502BL
         ROUTINE  NETNAME,MOVNAME                              @D3502BL
         LABEL 'NETWORK ADDRESS','NETWORK NAME'                @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         ROUTINE RECMD,LINKERR                                 @D3502BL
         LABEL 'RECORD TYPE - PERMANENT SDLC LINK ERROR'       @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         ROUTINE RECMD,STNERR                                  @D3502BL
         LABEL 'RECORD TYPE - PERMANENT SDLC STATION ERROR'    @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (2,1)                                           @D3502BL
         ROUTINE REG408,LXBSTAT                                @D3502BL
         LABEL ''                                              @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (23,23)                                         @D3502BL
         HEX   LIBADR,0,2B                                     @D3502BL
         LABEL 'LIB ADDR'                                      @D3502BL
         SPACE 3                                               @D3502BL
         LINE  ,(3),SKIP=2                                     @D3502BL
         LABEL 'LINK INFORMATION'                              @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (31,40),(4,37),SKIP=1                           @D3502BL
         HEX   (REG1300,0,1B),(REG200,0,1B),(REG400,0,2B)      @D3502BL
         LABEL 'CCB CONTROL FLG','LXB COMMAND','LXB FINAL ERROR STATUS'
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         HEX   (REG1308,0,1B),(REG208,0,2B),(REG500,0,1B)      @D3502BL
         LABEL 'CCB LINE TYPE','LXB MODIFIERS','LXB FINAL ERR EXT STATU*
               S'                                              @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (71,40),(41,37)                                 @D3502BL
         HEX   (REG308,0,1B),(REG508,0,2B)                     @D3502BL
         LABEL 'LXB IMMED. CTL CMD','LXB INITIAL ERROR STATUS' @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (111),(78),SKIP=2                               @D3502BL
         HEX   (REG608,0,1B)                                   @D3502BL
         LABEL 'LXB INITIAL ERR EXT STATUS'                    @D3502BL
         SPACE 3                                               @D3502BL
         LINE  ,(4,27)                                         @D3502BL
         LABEL 'FINAL ERR BIT DECODE','FINAL ERR EXT STAT','INITIAL ERR*
                BIT DECODE','INITIAL ERR EXT STAT'             @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (26,27),(4,27),SKIP=1                           @D3502BL
         BIN   (REG400),(REG500),(REG508),(REG608)             @D3502BL
         LABEL 'EXTENDED ERR STAT FLG','OVERRUN/UNDERRUN FLAG','EXTENDEC
               D ERR STAT FLG','OVERRUN/UNDERRUN FLAG'         @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         BIN   (REG401),(REG504),(REG509),(REG612)             @D3502BL
         LABEL 'FORMAT EXCEPTION FLG','BLOCK OVERRUN','FORMAT EXCEPTIONC
                FLG','BLOCK OVERRUN'                           @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         BIN   (REG402),(REG506),(REG510),(REG614)             @D3502BL
         LABEL ,'ABORT',,'ABORT'                               @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         BIN   (REG403),(REG507),(REG511),(REG615)             @D3502BL
         LABEL 'DATA CHECK','MONITOR COUNT OVERFLO','DATA CHECK','MONITC
               OR COUNT OVERFLO'                               @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (26,54),(4,54)                                  @D3502BL
         BIN   (REG415),(REG607)                               @D3502BL
         LABEL 'SDLC POLL FINAL BIT','SDLC POLL FINAL BIT'     @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         ROUTINE   RECMD,ISMOD03                               @D3502BL
         LABEL ''                                              @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (8),(2,10),SKIP=2                               @D3502BL
         ROUTINE   REG1314,CCBIT6                              @D3502BL
         LABEL 'LOCAL','STATION INFORMATION'                   @D3502BL
         SPACE 3                                               @D3502BL
         LINE  (31,40),(4,34),SKIP=1                           @D3502BL
         HEX   (REG1000,0,1B)                                  @D3502BL
         CONVT (RMSSCBNT,2,4)                                  @D3502BL
         LABEL 'SCB STATION TYPE','TOTAL TRANSMISSION CNT'     @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         HEX   (ISBOX,0,2B)                                    @D3502BL
         CONVT (RMSSCBBI,2,4)                                  @D3502BL
         LABEL 'SCB SERV. SEEKING CMD FLGS','I FORMAT RECEIVE CNT'
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         HEX   (REG100,0,1B)                                   @D3502BL
         CONVT (RMSSCBNR,2,4)                                  @D3502BL
         LABEL 'SCB OUTPUT CONTROL FLAGS','S FORMAT RECEIVE CNT'
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         HEX   (REG1008,0,1B)                                  @D3502BL
         CONVT (RMSSCBIE,2,4)                                  @D3502BL
         LABEL 'XMTD BLU CMD FLD','I FORMAT RECEIVE ERRORS'    @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         HEX   (REG808,0,1B)                                   @D3502BL
         CONVT (RMSSCBIA,2,4)                                  @D3502BL
         LABEL 'RCVD BLU CMD FLD','I FORMAT FRAMES ACKNOWLEDGED'
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         ROUTINE   REG1200,RTNR                                @D3502BL
         CONVT (RMSSCBNI,2,4)                                  @D3502BL
         LABEL 'N(R)','I FORMAT TOTAL RETRANSMISSIONS'         @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         ROUTINE   REG1208,RTNR                                @D3502BL
         CONVT (RMSSCBRY,2,4)                                  @D3502BL
         LABEL 'N(S)','TOTAL RETRY COUNT'                      @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         CONVT REG1100,1,3                                     @D3502BL
         LABEL 'SCB CRNT OUTSTANDING CNT'                      @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         CONVT REG1108,1,3                                     @D3502BL
         LABEL 'SCB PASS COUNT'                                @D3502BL
         SPACE 3                                               @D3502BL
         LINE ,                                                @D3502BL
         CONVT REG700,2,6                                      @D3502BL
         LABEL 'SCB I-FORMAT TRANSMIT CNT'                     @D3502BL
         SPACE 3                                               @D3502BL
SKIPLN03 LINE  ,,SKIP=1                                        @D3502BL
SKIPLB03 LABEL ''                                              @D3502BL
         SPACE 3                                               @D3502BL
         ETEPILOG RLEN=3C
         END

         TITLE 'IFCEEDIT-EDIT MODULE FOR IFCEREP0'
IFCEEDIT CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCEEDIT  79.010'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*
*        THESE ARE USED FOR LENGH VALUES
*
L0       EQU   0
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L5       EQU   5
L6       EQU   6
L7       EQU   7
L8       EQU   8
L12      EQU   12
L14      EQU   14
L15      EQU   15
L16      EQU   16
L17      EQU   17
L18      EQU   18
L20      EQU   20
L24      EQU   24
L27      EQU   27                      FJD
L28      EQU   28
L29      EQU   29
L32      EQU   32
L119     EQU   119
L127     EQU   127
*
*        FOR MASKS
*
*
HEX01    EQU   X'01'
HEX02    EQU   X'02'
HEX08    EQU   X'08'
HEX09    EQU   X'09'
HEX0A    EQU   X'0A'
HEX0B    EQU   X'0B'
HEX0C    EQU   X'0C'
HEX0D    EQU   X'0D'
HEX0E    EQU   X'0E'
HEX0F    EQU   X'0F'
HEX7F    EQU   X'7F'
HEX80    EQU   X'80'
HEXFE    EQU   X'FE'
HEXFF    EQU   X'FF'
*
*        MISC
*
STAR     EQU   C'*'
DOLLAR   EQU   C'$'
BLANK    EQU   C' '
         B     @PB00002                                            0092
PRINTIT  STM   @14,@12,@SA00002                                    0092
*  SWAPR2 = R2;                   /* SAVE R2                 @Z427VLS*/
         ST    R2,SWAPR2                                           0093
*  R2 = SAVER2;                   /* COMMUNICATIONS ADDRESS  @Z427VLS*/
         L     R2,SAVER2                                           0094
*  MOVETOLN = MOVELINE;           /* OUTPUT LINE             @Z427VLS*/
         MVC   MOVETOLN(133),MOVELINE                              0095
*  PRINTADR = ADDR(DUMBUFF);                               /*@Z427VLS*/
         LA    @10,DUMBUFF                                         0096
         L     @01,SAVER2                                          0096
         ST    @10,PRINTADR(,@01)                                  0096
*  CALL IOHND(RITEPRTR);                                   /*@Z427VLS*/
         L     @10,SAVER2                                          0097
         L     @15,ADIOHND(,@10)                                   0097
         LA    @01,@AL00097                                        0097
         BALR  @14,@15                                             0097
*  PRBUFF = DUMBUFF(3:120);                                /*@Z427VLS*/
         MVI   PRBUFF+118,C' '                                     0098
         MVC   PRBUFF+119(14),PRBUFF+118                           0098
         MVC   PRBUFF(118),DUMBUFF+2                               0098
*  R2 = SWAPR2;                                            /*@Z427VLS*/
         L     R2,SWAPR2                                           0099
* END;                                                     /*@Z427VLS*/
@EL00002 DS    0H                                                  0100
@EF00002 DS    0H                                                  0100
@ER00002 LM    @14,@12,@SA00002                                    0100
         BR    @14                                                 0100
@PB00002 DS    0H                                                  0101
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      SET UP PRIOR TO PROCESSING                          @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*        SAVER2 = R2;                                      /*@Z427VLS*/
         ST    R2,SAVER2                                           0101
*         SAVER7 = R7;                                     /*@Z427VLS*/
         ST    R7,SAVER7                                           0102
*        EDPRBUF=ADDR(PRBUFF);          /* SAVE PRINT BUFF PTR       */
         LA    @10,PRBUFF                                          0103
         ST    @10,EDPRBUF                                         0103
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      SET UP FOR TABLE                                    @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDPR0000:    ;                                            /*@Z427VLS*/
EDPR0000 DS    0H                                                  0105
*        R3 = ADDR(PRBUFF);                                /*@Z427VLS*/
         LA    R3,PRBUFF                                           0105
*        R2 = SAVER7;                                      /*@Z427VLS*/
         L     R2,SAVER7                                           0106
*        EDSPBASE=R9;                   /* SAVE TABLE PTR    @Z427VLS*/
         ST    R9,EDSPBASE                                         0107
*        GEN(L     R9,L0(R9));          /* SET PTR TO ENTRIES        */
         L     R9,L0(R9)
*        GEN(MVC   EDFORM(L8),L0(R9));  /* SAVE FORMAT 1 & 2 @Z427VLS*/
         MVC   EDFORM(L8),L0(R9)
*        GEN(MVC   EDLBBASE(L4),L8(R9));/* SAVE LABEL PTR    @Z427VLS*/
         MVC   EDLBBASE(L4),L8(R9)
*        GEN(SH    R2,L12(R9));         /* DECREMENT BY DISP IF ANY  */
         SH    R2,L12(R9)
*        GEN(LA    R9,L14(R9));         /* BUMP TO FIRST TRUE ENTRY  */
         LA    R9,L14(R9)
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      DETERMINE SUBROUTINE TO PROCESS ENTRY FOUND-SPECIAL @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDPR0001:    ;                         /*                   @Z427VLS*/
EDPR0001 DS    0H                                                  0114
*        IF COUNT='FF'X                 /* IS TABLE DONE     @Z427VLS*/
*              THEN                     /* IF YES EXIT       @Z427VLS*/
         CLI   COUNT(R9),X'FF'                                     0114
         BE    @RT00114                                            0114
*                   GOTO EDDONE;        /* IF NO CONTINUE    @Z427VLS*/
*        IF COUNT^='FE'X                /* IS ANOTHER TABLE  @Z427VLS*/
*              THEN                     /* WANTED            @Z427VLS*/
         CLI   COUNT(R9),X'FE'                                     0116
         BNE   @RT00116                                            0116
*                   GOTO EDPR0002;      /* BR-IF NO          @Z427VLS*/
*        GEN(MVC   EDLOAD(L8),L1(R9));  /* PICK UP NAME OF NEEDED TBL*/
         MVC   EDLOAD(L8),L1(R9)
*        DUMSW = OFF;                                      /*@Z427VLS*/
         NI    DUMSW,B'10111111'                                   0119
*        IF DEBUG1 = ON THEN  /*PRINT THE NAME OF THE EDIT MODULE */
         L     @10,SAVER2                                          0120
         TM    DEBUG1(@10),B'01000000'                             0120
         BNO   @RF00120                                            0120
*         DO;                 /*THAT IS PRODUCING THE FOLLOWING   */
*          BUG1(8:15) = EDLOAD;/*LINES OF PRINT              @0001VLS*/
         MVC   BUG1+7(8),EDLOAD                                    0122
*          PRBUFF = BUG1;    /*MOVE THE LINE OF INFO TO PRINT BUFFER*/
         MVI   PRBUFF+50,C' '                                      0123
         MVC   PRBUFF+51(82),PRBUFF+50                             0123
         MVC   PRBUFF(50),BUG1                                     0123
*          CALL PRINTIT;     /*GO PRINT THE MODULE NAME      @0001VLS*/
         BAL   @14,PRINTIT                                         0124
*         END;                                             /*@0001VLS*/
*        DO I = 1 BY 1 TO EDITNUM                                  0126
*          WHILE (DUMSW = OFF);         /* SEARCH FOR NAME IN TABLE  */
@RF00120 LA    @10,1                                               0126
         ST    @10,I                                               0126
         B     @DE00126                                            0126
@DL00126 TM    DUMSW,B'01000000'                                   0126
         BNZ   @DC00126                                            0126
*           IF EDLOAD = LOADNAME(I) THEN                           0127
         MH    @10,@CH00064                                        0127
         L     @01,SAVER2                                          0127
         L     @01,ADEDITB(,@01)                                   0127
         ALR   @01,@10                                             0127
         AL    @01,@CF00675                                        0127
         CLC   EDLOAD(8),LOADNAME-4(@01)                           0127
         BNE   @RF00127                                            0127
*             DO;                                          /*@Z427VLS*/
*               R9 = LOADPTR (I);       /* SET UP ENTRY POINTER      */
         L     @01,SAVER2                                          0129
         L     @01,ADEDITB(,@01)                                   0129
         L     R9,LOADPTR-12(@10,@01)                              0129
*               DUMSW = ON;                                /*@Z427VLS*/
         OI    DUMSW,B'01000000'                                   0130
*             END;                                         /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
@RF00127 LA    @10,1                                               0132
         AL    @10,I                                               0132
         ST    @10,I                                               0132
@DE00126 L     @01,SAVER2                                          0132
         L     @01,ADEDITB(,@01)                                   0132
         CH    @10,EDITNUM(,@01)                                   0132
         BNH   @DL00126                                            0132
@DC00126 DS    0H                                                  0133
*        IF DUMSW = OFF THEN                                       0133
         TM    DUMSW,B'01000000'                                   0133
         BNZ   @RF00133                                            0133
*          DO;                                             /*@Z427VLS*/
*            EDITNUM = EDITNUM + 1;     /* NEXT ENTRY        @Z427VLS*/
         L     @10,SAVER2                                          0135
         L     @10,ADEDITB(,@10)                                   0135
         L     @01,SAVER2                                          0135
         L     @01,ADEDITB(,@01)                                   0135
         LA    @00,1                                               0135
         AH    @00,EDITNUM(,@01)                                   0135
         STH   @00,EDITNUM(,@10)                                   0135
*            LOADNAME(EDITNUM) = EDLOAD;  /* NEW NAME        @Z427VLS*/
         L     @10,SAVER2                                          0136
         L     @10,ADEDITB(,@10)                                   0136
         LH    @10,EDITNUM(,@10)                                   0136
         MH    @10,@CH00064                                        0136
         L     @01,SAVER2                                          0136
         L     @01,ADEDITB(,@01)                                   0136
         ALR   @01,@10                                             0136
         AL    @01,@CF00675                                        0136
         MVC   LOADNAME-4(8,@01),EDLOAD                            0136
*             GEN (LOADEREP EPLOC=EDLOAD);  /* LOAD IT       @G51DGVS*/
         LOADEREP EPLOC=EDLOAD
*            LOADPTR(EDITNUM) = R0;       /* ENTRY POINT     @Z427VLS*/
         L     @10,SAVER2                                          0138
         L     @01,ADEDITB(,@10)                                   0138
         LH    @10,EDITNUM(,@01)                                   0138
         MH    @10,@CH00064                                        0138
         L     @01,SAVER2                                          0138
         L     @01,ADEDITB(,@01)                                   0138
         ST    R0,LOADPTR-12(@10,@01)                              0138
*            R9 = R0;                                      /*@Z427VLS*/
         LR    R9,R0                                               0139
*          END;                                            /*@Z427VLS*/
*        GOTO  EDPR0000 ;               /* LOOP BACK TO SET UP AGAIN */
         B     EDPR0000                                            0141
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      END OF TABLE ROUTINE   BLOCK GENERATE FOR SPECIAL HNDLING   */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDDONE :     ;                                            /*@Z427VLS*/
EDDONE   DS    0H                                                  0143
*GENERATE ;                                                /*@Z427VLS*/
         MVC   EDFORM1(L6),L1(R9)       PICK UP DUMP VALUES
EDDONE1  BAL   R9,EDHEXDMP              NO-DUMP RECORD IN HEX
         L     R9,EDSPBASE              PICK UP TABLE ADDRESS
         B     EDEND                    EXIT
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      DETERMINE NORMAL ENTRY TYPE                         @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDPR0002:    ;                                            /*@Z427VLS*/
EDPR0002 DS    0H                                                  0145
*        R8=ADDR(EDPR0004);             /* ADDR OF RETURN POINT      */
         LA    R8,EDPR0004                                         0145
*        R3=R3+EDFORM(1);               /* SET PTR INTO PRNT BUFF    */
         AH    R3,EDFORM                                           0146
*        R12=COUNT;                     /* PICK UP ENTRY COUNT       */
         SLR   R12,R12                                             0147
         IC    R12,COUNT(,R9)                                      0147
*        R9=R9+1 ;                      /* BUMP PTR OVER COUNT       */
         AL    R9,@CF00051                                         0148
*        IF R12=0                       /* IF COUNT ZERO-NULL LINE   */
*              THEN                     /* NOTHING TO DO THIS LINE   */
         LTR   R12,R12                                             0149
         BZ    @RT00149                                            0149
*                   GOTO EDPR0005;      /* GO TO END OF SECTION      */
*EDPR0003:    ;                         /*                   @Z427VLS*/
EDPR0003 DS    0H                                                  0152
*/*                                                          @Z427VLS*/
*/*      BLOCK GENERATE FOR TM INST EARLY BSL WOULD NOT WORK @Z427VLS*/
*/*                                                          @Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
         CLC   L0(2,R9),HEX0017         IS ENTRY SYSREL        @D35UGFD
         BE    EDSYSREL                 YES                    @D35UGFD
         TM    L1(R9),HEX08             IS ENTRY 2 BYTE BIN
         BZ    EDBIN2                   YES
         TM    L1(R9),HEX0F             IS ENTRY  FORMAT 2
         BO    EDFORMT2                 YES
         TM    L1(R9),HEX0E             IS ENTRY  FORMAT 1
         BO    EDFORMT1                 YES
         TM    L1(R9),HEX0D             IS ENTRY SPECIAL RTNE
         BO    EDSPCRTN                 YES
         TM    L1(R9),HEX0C             IS ENTRY 4 BYTE BIN
         BO    EDBIN4                   YES
         TM    L1(R9),HEX0B             IS ENTRY CARRIAGE CNTRL
         BO    EDCCLOOP                 YES
         TM    L1(R9),HEX0A             IS ENTRY HEX
         BO    EDHEX                    YES
         TM    L1(R9),HEX09             IS IT CONVERT TO DEC ENTRY
         BO    EDCONV                   YES
*        R9=R9+4 ;                      /* NO IGNORE ENTRY   @Z427VLS*/
         AL    R9,@CF00060                                         0153
*EDPR0004 :    ;                                           /*@Z427VLS*/
EDPR0004 DS    0H                                                  0155
*        R12=R12-1 ;                    /* DECREMENT ENTRY COUNT     */
         BCTR  R12,0                                               0155
*        IF R12^=0                      /* IS LINE DONE ALL ENTRIES  */
*              THEN                     /* PROCESSED         @Z427VLS*/
         LTR   R12,R12                                             0156
         BNZ   @RT00156                                            0156
*                   GOTO EDPR0003;      /* BR-NO MORE TO DO  @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      SETUP TO PLACE LABELS ONTO PRINT BUFF               @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*RESPECIFY (R4,R6,R7,R8) RESTRICTED;                       /*@Z427VLS*/
*EDPR0005:    ;                         /* SET UP            @Z427VLS*/
EDPR0005 DS    0H                                                  0160
*        R3=EDPRBUF ;                   /* PICK UP BUFF ADDR @Z427VLS*/
         L     R3,EDPRBUF                                          0160
*        R4=R3  ;                       /* SET WORK REG      @Z427VLS*/
         LR    R4,R3                                               0161
*        R3=R3-2;                       /* DECREMENT TO START OF BUFF*/
         BCTR  R3,0                                                0162
         BCTR  R3,0                                                0162
*        R4=R4+EDFORM(3);               /* ADD IN FORMAT 2 CONSTANT  */
         AH    R4,EDFORM+4                                         0163
*        R8=EDLBBASE;                   /* SET LABEL PTR     @Z427VLS*/
         L     R8,EDLBBASE                                         0164
*EDLBLOOP:    ;                                            /*@Z427VLS*/
EDLBLOOP DS    0H                                                  0166
*        R7=R8;                         /* SET RUNNING PTR   @Z427VLS*/
         LR    R7,R8                                               0166
*        R6=0 ;                         /* SET COUNT OF CHARS        */
         SLR   R6,R6                                               0167
*EDLBLP01:    ;                                            /*@Z427VLS*/
EDLBLP01 DS    0H                                                  0169
*        IF LABELST='*' ×               /* IS CHAR BEING INDEXED     */
*           LABELST='$'                 /* THE * OR $ MARKING END OF */
*              THEN                     /* A LABEL           @Z427VLS*/
         CLI   LABELST(R7),C'*'                                    0169
         BE    @RT00169                                            0169
         CLI   LABELST(R7),C'$'                                    0169
         BE    @RT00169                                            0169
*                   GOTO EDLBLP02;      /* BR-YES            @Z427VLS*/
*        R6=R6+1;                       /*  BUMP R6 BY 1     @Z427VLS*/
         LA    @10,1                                               0171
         ALR   R6,@10                                              0171
*        R7=R7+1;                       /*  BUMP PTR TO NEXT CHAR    */
         ALR   R7,@10                                              0172
*        GOTO EDLBLP01;                 /*  BACK TO DO COMPARE       */
         B     EDLBLP01                                            0173
*EDLBLP02:    ;                         /*                   @Z427VLS*/
EDLBLP02 DS    0H                                                  0175
*        IF NOPRINT='1'B                /*  IS NO PRINT SWITCH SET   */
*              THEN                     /*  IF YES SKIP TO LP03      */
         TM    NOPRINT,B'10000000'                                 0175
         BO    @RT00175                                            0175
*                   GOTO EDLBLP03;      /*                   @Z427VLS*/
*        IF R6=0                        /*  IF COUNT(R6) IS ZERO     */
*              THEN                     /*  ALSO SKIP TO LP03        */
         LTR   R6,R6                                               0177
         BZ    @RT00177                                            0177
*                   GOTO EDLBLP03;      /*                   @Z427VLS*/
*        R6=R6-1;                       /*  IF NOT THEN DECREMENT    */
         BCTR  R6,0                                                0179
*        GEN(EX    R6,EDLBMOVE);        /*  COUNT FOR EX TO MOVE LABL*/
         EX    R6,EDLBMOVE
*EDLBLP03:    ;                         /*                   @Z427VLS*/
EDLBLP03 DS    0H                                                  0182
*        IF LABELST='$'                 /*  IS IT END OF LINE VERSUS */
*              THEN                     /*  END OF LABEL     @Z427VLS*/
         CLI   LABELST(R7),C'$'                                    0182
         BE    @RT00182                                            0182
*                   GOTO EDLBLP04;      /*  BR-END OF LINE   @Z427VLS*/
*        R8=R7+1;                       /*  SET R8 TO START NXT LABEL*/
         LA    R8,1                                                0184
         ALR   R8,R7                                               0184
*        R4=R4+EDFORM(4);               /*  BUMP BUFF PTR BY FORMT2  */
         AH    R4,EDFORM+6                                         0185
*        GOTO EDLBLOOP;                 /*  LOOP BACK TO GET NXT LBL */
         B     EDLBLOOP                                            0186
*EDLBLP04:    ;                         /*  LINE SET ENTRY   @Z427VLS*/
EDLBLP04 DS    0H                                                  0188
*        IF NOPRINT='1'B                /*  IS NO PRINT ON   @Z427VLS*/
*              THEN                     /*  IF YES           @Z427VLS*/
         TM    NOPRINT,B'10000000'                                 0188
         BO    @RT00188                                            0188
*                   GOTO NOPUT;         /*  SKIP PUT         @Z427VLS*/
*        CALL PRINTIT;                                     /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0190
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CLEAR PRINT BUFF WITH BLANKS   BLOCK GENERATE       @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*NOPUT  :     ;                                            /*@Z427VLS*/
NOPUT    DS    0H                                                  0192
*GENERATE ;                                                /*@Z427VLS*/
         MVC   L1(L1,R3),L0(R3)         RESET CHARIAGE CONTROL
         MVI   L2(R3),BLANK             SET IN BLANK
         MVC   L3(L119,R3),L2(R3)       BLANK OUT LINE
*                                                                    *
*        OTHER  CLEANUP                                              *
*                                                                    *
         NI    FLAGS,HEX7F              TURN OF NO PRINT FLAG
         LA    R8,L1(R7)                BUMP R8 TO NEXT LABEL
         LA    R3,L2(R3)                BUMP R3 TO PRINT BUFF
         ST    R8,EDLBBASE              SAVE R8 PTR TO NXT LABEL
         B     EDPR0001                 RETURN TO TOP OF LOOP
EDLBMOVE MVC   L0(L0,R4),L0(R8)
*        RESPECIFY(R6,R7) UNRESTRICTED;                    /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CARRIAGE CONTROL LOOP  CHANGE CC CHAR ON THE PRINT LINE     */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDCCLOOP:    ;                                            /*@Z427VLS*/
EDCCLOOP DS    0H                                                  0195
*        R4=EDPRBUF;                    /* PICK UP PTR TO PRINT BUFF */
         L     R4,EDPRBUF                                          0195
*        R4=R4-2 ;                      /* BACK OFF TO CARRIAGE CNTRL*/
         BCTR  R4,0                                                0196
         BCTR  R4,0                                                0196
*        SAVECC=CC ;                    /* FIELDS AND SAVE CURRENT CC*/
         MVC   SAVECC(1),CC                                        0197
*        IF BEFFLD1='00'X               /* IF FIELD 1 IS ZERO        */
*              THEN                     /* THE CURRENT CC IS TO BE   */
         CLI   BEFFLD1(R9),X'00'                                   0198
         BE    @RT00198                                            0198
*                   GOTO EDCCLP1;       /* USED WITHOUT CHANGE       */
*        CC=BEFFLD1;                    /* IF NOT ZERO MOVE IN FIELD */
         MVC   CC(1),BEFFLD1(R9)                                   0200
*EDCCLP1:      ;                        /*                   @Z427VLS*/
EDCCLP1  DS    0H                                                  0202
*        IF BEFFLD2='00'X               /* IF FIELD 2 IS ZERO        */
*              THEN                     /* THE SAVED CC IS TO BE LEFT*/
         CLI   BEFFLD2(R9),X'00'                                   0202
         BE    @RT00202                                            0202
*                   GOTO EDCCLP2;       /* ALONE             @Z427VLS*/
*        SAVECC=BEFFLD2;                /* IF NOT ZERO IT IS TO BE   */
         MVC   SAVECC(1),BEFFLD2(R9)                               0204
*EDCCLP2:      ;                        /* OVERLAYED         @Z427VLS*/
EDCCLP2  DS    0H                                                  0206
*        R9=R9+4 ;                      /* BUMP ENTRY PTR OVER ENTRY */
         AL    R9,@CF00060                                         0206
*        GOTO R8 ;                      /* RETURN            @Z427VLS*/
         BR    R8                                                  0207
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CONVERT LOOP CONVERT BINARY TO DECIMAL              @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*        RESPECIFY (R5,R6,R7) RESTRICTED;                  /*@Z427VLS*/
*EDCONV  :     ;                                           /*@Z427VLS*/
EDCONV   DS    0H                                                  0210
*        R4=NOFFSET;                    /* PICK UP DATA OFFSET       */
         SLR   R4,R4                                               0210
         ICM   R4,3,NOFFSET(R9)                                    0210
*        GEN(SRL   R4,L4);              /* DROP OFF SIGN     @Z427VLS*/
         SRL   R4,L4
*        R4=R4+R2;                      /* COMPUTE ADDRESS OF DATA   */
         ALR   R4,R2                                               0212
*        R5=0;                          /*                   @Z427VLS*/
         SLR   R5,R5                                               0213
*        R6=NIN;                        /* PICK UP NUMBER OF CHARS IN*/
         SLR   R6,R6                                               0214
         IC    R6,NIN(,R9)                                         0214
*CONVLOOP:     ;                                           /*@Z427VLS*/
CONVLOOP DS    0H                                                  0216
*        GEN(SLL   R5,L8);              /* SHIFT DATA ONE BYTE LEFT  */
         SLL   R5,L8
*        GEN(IC    R5,L0(R4));          /* PICK UP A BYTE OF DATA    */
         IC    R5,L0(R4)
*        R4=R4+1;                       /* BUMP DATA POINTER TO NXT  */
         AL    R4,@CF00051                                         0218
*        GEN(BCT   R6,CONVLOOP);        /* LOOP TILL ALL PICKED UP   */
         BCT   R6,CONVLOOP
*        GEN(CVD   R5,DBLWORK);         /* CONVERT TO DECIMAL        */
         CVD   R5,DBLWORK
*        GEN(UNPK  WORK(L8),DBLWORK(L8));         /* UNPACK DECIMAL  */
         UNPK  WORK(L8),DBLWORK(L8)
*        GEN(MVZ   WORK+L7(L1),WORK);   /* SET UP PROPER SIGN        */
         MVZ   WORK+L7(L1),WORK
*        R4=NOUT;                       /* PICK UP NBR OF CHARS OUT  */
         SLR   R4,R4                                               0223
         IC    R4,NOUT(,R9)                                        0223
*        Y=9-R4;                                           /*@ZA24135*/
         LA    @10,9                                               0224
         SLR   @10,R4                                              0224
         STH   @10,Y                                               0224
*        X=R4-1;                                           /*@ZA24135*/
         LR    @15,R4                                              0225
         BCTR  @15,0                                               0225
         STH   @15,X                                               0225
*        R4=R3-ADDR(PRBUFF)+1;                             /*@ZA24135*/
         LA    R4,PRBUFF                                           0226
         LCR   R4,R4                                               0226
         ALR   R4,R3                                               0226
         AL    R4,@CF00051                                         0226
*        PRBUFF(R4:R4+X)=WORK(Y:8);     /* MOVE DATA TO PRINT BUFF   */
         LA    @01,PRBUFF-1(R4)                                    0227
         LA    @14,WORK-1(@10)                                     0227
         EX    @15,@SM00677                                        0227
*        R9=R9+4;                       /* BUMP POINTER TO NEXT ENTRY*/
         AL    R9,@CF00060                                         0228
*        R3=R3+EDFORM(2);               /* BUMP PTR TO NEXT COLUMN   */
         AH    R3,EDFORM+2                                         0229
*        GOTO  R8;                      /* RETURN TO MAINLINE        */
         BR    R8                                                  0230
*        RESPECIFY (R5,R6,R7) UNRESTRICTED;                /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      FORMAT ROUTINE RESET THE COLUMN BOUNDARIES/SPACING  VALUE   */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*        RESPECIFY (R5) RESTRICTED;                        /*@Z427VLS*/
*EDFORMT1:    ;                         /* FORMAT 1 ENTRY    @Z427VLS*/
EDFORMT1 DS    0H                                                  0234
*        R4=1;                          /* SET INDEX TO 1    @Z427VLS*/
         LA    R4,1                                                0234
*        GOTO  EDFORMLP ;               /* GOTO COMMON       @Z427VLS*/
         B     EDFORMLP                                            0235
*EDFORMT2:     ;                        /* FORMAT 2 ENTRY    @Z427VLS*/
EDFORMT2 DS    0H                                                  0237
*        R4=3 ;                         /* SET INDEX TO 3    @Z427VLS*/
         LA    R4,3                                                0237
*EDFORMLP:    ;                         /*        COMMON     @Z427VLS*/
EDFORMLP DS    0H                                                  0239
*        R5=BEFFLD1;                    /* PICK UP VALUE IN FLD 1    */
         SLR   R5,R5                                               0239
         IC    R5,BEFFLD1(,R9)                                     0239
*        IF R5=0                        /* IF IT IS ZERO     @Z427VLS*/
*              THEN                     /* NO CHANGE TO      @Z427VLS*/
         LTR   R5,R5                                               0240
         BZ    @RT00240                                            0240
*                   GOTO EDFRMLP1;      /* COLUMN START VALUE        */
*        R5=R5-1 ;                      /* DECREMENT BY 1    @Z427VLS*/
         BCTR  R5,0                                                0242
*        IF R4=3                        /* IF FORMAT 2 ENTRY CHANGE  */
*              THEN                     /* DOES NO AFFECT PRESENT    */
         C     R4,@CF00073                                         0243
         BE    @RT00243                                            0243
*                   GOTO EDFRMLP0;      /* IF FORMAT C MUST RESET R3 */
*        R3=EDPRBUF;                    /* RESET  STARTING  COL POS  */
         L     R3,EDPRBUF                                          0245
*        R3=R3+R5;                      /* B4 ADDING OFFSET TO PRNTBF*/
         ALR   R3,R5                                               0246
*EDFRMLP0:    ;                         /*                   @Z427VLS*/
EDFRMLP0 DS    0H                                                  0248
*        EDFORM(R4)=R5;                 /* SAVE VALUE        @Z427VLS*/
         LR    @10,R4                                              0248
         ALR   @10,@10                                             0248
         STH   R5,EDFORM-2(@10)                                    0248
*EDFRMLP1:    ;                                            /*@Z427VLS*/
EDFRMLP1 DS    0H                                                  0250
*        R5=BEFFLD2 ;                   /* PICK UP SPACING VALUE     */
         SLR   R5,R5                                               0250
         IC    R5,BEFFLD2(,R9)                                     0250
*        IF R5=0                        /* IF VALUE IS ZERO  @Z427VLS*/
*              THEN                     /* SPACEING DOES NOT @Z427VLS*/
         LTR   R5,R5                                               0251
         BZ    @RT00251                                            0251
*                   GOTO EDFRMLP2;      /* CHANGE            @Z427VLS*/
*        R4=R4+1;                       /* IF NOT ZERO BUMP TO 2ND   */
         AL    R4,@CF00051                                         0253
*        EDFORM(R4)=R5;                 /* HALF OF FORMAT & SAVE     */
         LR    @10,R4                                              0254
         ALR   @10,@10                                             0254
         STH   R5,EDFORM-2(@10)                                    0254
*EDFRMLP2:                              /*                   @Z427VLS*/
*        R9=R9+4;                       /* BUMP POINTER TO NXT ENTRY */
EDFRMLP2 AL    R9,@CF00060                                         0255
*        GOTO R8;                       /* EXIT              @Z427VLS*/
         BR    R8                                                  0256
*        RESPECIFY (R5) UNRESTRICTED;                      /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      SPECIAL ENTRY   PASSES CONTROL TO SPECIAL SECTION OF TABLE  */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*EDSPCRTN:    ;                                            /*@Z427VLS*/
EDSPCRTN DS    0H                                                  0259
*        RESPECIFY (R5,R6,R7,R8) RESTRICTED;               /*@Z427VLS*/
*        R4=0 ;                         /* ZERO WORK REG     @Z427VLS*/
         SLR   R4,R4                                               0260
*        GEN(IC    R4,L0(R9));          /* PICK UP           @Z427VLS*/
         IC    R4,L0(R9)
*        GEN(SLL   R4,L8);              /* 12 BIT            @Z427VLS*/
         SLL   R4,L8
*        GEN(IC    R4,L1(R9));          /* ADDRESS           @Z427VLS*/
         IC    R4,L1(R9)
*        GEN(SRL   R4,L4);              /* OFFSET            @Z427VLS*/
         SRL   R4,L4
*        R4=R4+R2 ;                     /* ADD R2 PTR INTO REC       */
         ALR   R4,R2                                               0265
*        R6=DOFFSET ;                   /* PICK UP SPEC RTN OFFSET   */
         SLR   R6,R6                                               0266
         ICM   R6,3,DOFFSET(R9)                                    0266
*        GEN(SRDL  R6,L12);             /* SHIFT 12 BIT OFFSET TO R7 */
         SRDL  R6,L12
*        GEN(SRL   R7,L20);             /* R6 HAS SPACE VALUE(SPEC)  */
         SRL   R7,L20
*        R5=R6 ;                        /* SET WORK REG      @Z427VLS*/
         LR    R5,R6                                               0269
*        R6=R9 ;                        /* SAVE CURRENT ENTRY PTR    */
         LR    R6,R9                                               0270
*        R9=EDSPBASE;                   /* PICK UP TABLE BASE        */
         L     R9,EDSPBASE                                         0271
*        EDSPSV9=R6 ;                   /* SAVE CURR PTR IN TABLE    */
         STCM  R6,15,EDSPSV9(R9)                                   0272
*        LABELPTR=EDLBBASE;             /* SAVE CURR LBL PTR IN TABLE*/
         MVC   LABELPTR(4,R9),EDLBBASE                             0273
*        R7=R7+R9 ;                     /* COMPUTE OFFSET TO SPEC RTN*/
         ALR   R7,R9                                               0274
*        R15=R7 ;                       /* LOAD R15          @Z427VLS*/
         LR    R15,R7                                              0275
*        RESPECIFY (R0) RESTRICTED;                        /*@Z427VLS*/
*        R0 = EDPRBUF - 1;                                 /*@Z427VLS*/
         L     R0,EDPRBUF                                          0277
         BCTR  R0,0                                                0277
*        GEN(L R1,SAVER2);                                 /*@D35UGHS*/
         L R1,SAVER2
*        GEN(L R10,SAVER7);                                /*@D35UGHS*/
         L R10,SAVER7
*        GEN(BALR  R14,R15);            /* BALR TO SPECIAL RTN IN TBL*/
         BALR  R14,R15
*        RESPECIFY (R0) UNRESTRICTED;                      /*@Z427VLS*/
*        R5=R15 ;                       /* SAVE RTN CODE     @Z427VLS*/
         LR    R5,R15                                              0282
*        EDLBBASE=LABELPTR;             /* RESET LABEL PTR   @Z427VLS*/
         MVC   EDLBBASE(4),LABELPTR(R9)                            0283
*        R9=EDSPSV9 ;                   /* RESET R9 WITH CURR ENTRY  */
         ICM   R9,15,EDSPSV9(R9)                                   0284
*        R9=R9+4;                       /* PTR AND BUMP TO NXT ENTRY */
         AL    R9,@CF00060                                         0285
*        R3=R3+EDFORM(2);               /* BUMP TO NEXT COLUMN       */
         AH    R3,EDFORM+2                                         0286
*        IF R5=0                        /* IF RETURN CODE    @Z427VLS*/
*              THEN                     /* IS 0 THEN         @Z427VLS*/
         LTR   R5,R5                                               0287
         BNZ   @RF00287                                            0287
*                   NOPRINT='1'B ;      /* NOPRINT HAS BEEN REQUESTED*/
         OI    NOPRINT,B'10000000'                                 0288
*              ELSE                     /* IF NOT ZERO       @Z427VLS*/
*                   NOPRINT='0'B ;      /* NOPRINT SW IS OFF @Z427VLS*/
         B     @RC00287                                            0289
@RF00287 NI    NOPRINT,B'01111111'                                 0289
*        GOTO R8 ;                      /* RETURN            @Z427VLS*/
@RC00287 BR    R8                                                  0290
*        RESPECIFY (R5,R6,R7) UNRESTRICTED;                /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      HEX ENTRY ROUTINE   PRINT OUT DATA IN HEX           @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*        RESPECIFY (R1,R5,R6,R7) RESTRICTED;               /*@Z427VLS*/
*EDHEX  :     ;                                            /*@Z427VLS*/
EDHEX    DS    0H                                                  0294
*        EDSPSV8=R8;                    /* SAVE RTN POINT    @Z427VLS*/
         ST    R8,EDSPSV8                                          0294
*        R1=R3;                         /* SET PTR FOR WORK  @Z427VLS*/
         LR    R1,R3                                               0295
*        R4=0 ;                         /* ZERO R4           @Z427VLS*/
         SLR   R4,R4                                               0296
*        GEN(IC    R4,L0(R9));          /* PICK UP           @Z427VLS*/
         IC    R4,L0(R9)
*        GEN(SLL   R4,L8);              /* 12 BIT            @Z427VLS*/
         SLL   R4,L8
*        GEN(IC    R4,L1(R9));          /* OFFSET            @Z427VLS*/
         IC    R4,L1(R9)
*        GEN(SRL   R4,L4);              /* TO ADD TO REC     @Z427VLS*/
         SRL   R4,L4
*        R4=R4+R2;                      /* ADD OFFSET-PTR INTO REC   */
         ALR   R4,R2                                               0301
*        R6=0 ;                         /*                   @Z427VLS*/
         SLR   R6,R6                                               0302
*        GEN(IC    R6,L3(R9));          /* PICK UP NUMBER    @Z427VLS*/
         IC    R6,L3(R9)
*        GEN(SRL   R6,L4);              /* OF CHARS TO DO    @Z427VLS*/
         SRL   R6,L4
*        IF R6=0                        /* IF NO. OF CHARS   @Z427VLS*/
*              THEN                     /* IS ZERO           @Z427VLS*/
         LTR   R6,R6                                               0305
         BZ    @RT00305                                            0305
*                   GOTO EDHLOOP3;      /* SKIP TO LOOP3     @Z427VLS*/
*        R8=ADDR(CHARTAB);              /* SET PTR TO EBCDIC CHARS   */
         LA    R8,CHARTAB                                          0307
*EDHLOOP:    ;                          /*                   @Z427VLS*/
EDHLOOP  DS    0H                                                  0309
*        R5=0;                          /*                   @Z427VLS*/
         SLR   R5,R5                                               0309
*        GEN(IC    R5,L2(R9));          /* PICK UP SPACEING BTWN CHAR*/
         IC    R5,L2(R9)
*        R7=127 ;                       /* SET VALUE 7F FOR ANDING   */
         LA    R7,127                                              0311
*        GEN(NR    R5,R7);              /* DROP OF UNUSED BITS       */
         NR    R5,R7
*        IF ACMIN^='1'B                 /* IF SWITCH SET VALUE IS A  */
*              THEN                     /* NEGATIVE OFFSET   @Z427VLS*/
         TM    ACMIN(R9),B'10000000'                               0313
         BNO   @RT00313                                            0313
*                   GOTO EDHLOOP0;      /* SWITCH OFF IS SPACE VALUE */
*        R1=R1-R5 ;                     /* ON-DECREMENT WORK PTR TO  */
         SLR   R1,R5                                               0315
*        R5=0 ;                         /* BUFFER & SET SPACE VALUE=0*/
         SLR   R5,R5                                               0316
*EDHLOOP0:    ;                         /*                   @Z427VLS*/
EDHLOOP0 DS    0H                                                  0318
*        GEN(TM    L3(R9),HEX01);       /* IS RIGHT HALF ONLY ASKED  */
         TM    L3(R9),HEX01
*        GEN(BZ    EDHLOOP1);           /* FOR IF SW OFF-BR-YES      */
         BZ    EDHLOOP1
*        R7=0 ;                         /* IF ON LEFT HALF WANTED    */
         SLR   R7,R7                                               0320
*        GEN(IC    R7,L0(R4));          /* PICK UP BYTE INDEXED TO   */
         IC    R7,L0(R4)
*        GEN(SRL   R7,L4);              /* DROP RIGHT HALF   @Z427VLS*/
         SRL   R7,L4
*        R7=R7+R8;                      /* INDEX INTO CHAR TABLE     */
         ALR   R7,R8                                               0323
*        GEN(MVC   L0(L0,R1),L0(R7));   /* MOVE IN INDEXED CHAR      */
         MVC   L0(L0,R1),L0(R7)
*EDHLOOP1:    ;                         /*                   @Z427VLS*/
EDHLOOP1 DS    0H                                                  0326
*        GEN(TM    L3(R9),HEX02);       /* IS LEFT HALF ONLY ASKED   */
         TM    L3(R9),HEX02
*        GEN(BZ    EDHLOOP2);           /* FOR IF SW OFF-BR-YES      */
         BZ    EDHLOOP2
*        GEN(IC    R7,L0(R4));          /* IF ON RIGHT HALF WANTED   */
         IC    R7,L0(R4)
*        GEN(SLL   R7,L28);             /* PICK UP INDEXED BYTE &    */
         SLL   R7,L28
*        GEN(SRL   R7,L28);             /* DROP UNUSED BITS E        */
         SRL   R7,L28
*        R7=R7+R8;                      /* INDEX INTO CHAR TABLE     */
         ALR   R7,R8                                               0331
*        GEN(MVC   L1(L1,R1),L0(R7));   /* MOVE IN INDEXED CHAR      */
         MVC   L1(L1,R1),L0(R7)
*EDHLOOP2:    ;                         /*                   @Z427VLS*/
EDHLOOP2 DS    0H                                                  0334
*        R4=R4+1 ;                      /* BUMP PTR TO NEXT INPUT CHR*/
         AL    R4,@CF00051                                         0334
*        R1=R1+R5+2;                    /* BUMP OUT BUFF PTR BY 2+   */
         LR    @10,R1                                              0335
         ALR   @10,R5                                              0335
         AL    @10,@CF00071                                        0335
         LR    R1,@10                                              0335
*        R6=R6-1;                       /* SPACING VALUE DECREMENT LP*/
         BCTR  R6,0                                                0336
*        IF R6^=0                       /* COUNT IF IT IS NOT ZERO   */
*              THEN                     /* LOOP BACK TO      @Z427VLS*/
         LTR   R6,R6                                               0337
         BNZ   @RT00337                                            0337
*                   GOTO EDHLOOP0;      /* LOOP0             @Z427VLS*/
*EDHLOOP3:    ;                         /* IF IS ZERO DONE   @Z427VLS*/
EDHLOOP3 DS    0H                                                  0340
*        R9=R9+4;                       /* BUMP TO NEXT ENTRY        */
         AL    R9,@CF00060                                         0340
*        R3=R3+EDFORM(2);               /* BUMR BUFF PTR TO NXT COL  */
         AH    R3,EDFORM+2                                         0341
*        R8=EDSPSV8;                    /* RESTORE R8        @Z427VLS*/
         L     R8,EDSPSV8                                          0342
*        GOTO R8;                       /* RETURN            @Z427VLS*/
         BR    R8                                                  0343
*        RESPECIFY (R1,R5,R6,R7) UNRESTRICTED;             /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @D35UGFD*/
*/*      SYSREL    ROUTINE   PRINT OUT SYSTEM & RELEASE LEVEL@D35UGFD*/
*/*                                                          @D35UGFD*/
*/********************************************************************/
*        RESPECIFY (R1,R5,R6,R7) RESTRICTED;               /*@D35UGFD*/
*EDSYSREL:    ;                                            /*@D35UGFD*/
EDSYSREL DS    0H                                                  0347
*        EDSPSV8=R8;                    /* SAVE RTN POINT    @D35UGFD*/
         ST    R8,EDSPSV8                                          0347
*        R1=R3;                         /* SET PTR FOR WORK  @D35UGFD*/
         LR    R1,R3                                               0348
*        R1=EDPRBUF;                    /* SET PTR TO PRINT BUFFER   */
         L     R1,EDPRBUF                                          0349
*        R4=1 ;                         /* SET R4 TO SYSREL OFFSET   */
         LA    R4,1                                                0350
*                                       /* IN INPUT RECORD   @D35UGFD*/
*        R4=R4+R2;                      /* ADD OFFSET-PTR INTO REC   */
         ALR   R4,R2                                               0351
*        R6=0 ;                         /*                   @D35UGFD*/
         SLR   R6,R6                                               0352
*        GEN(IC R6,L0(R4));          /* PICK UP SYS + REL.@D35UGFD*/
         IC R6,L0(R4)
*        GEN(SRDL  R6,L5);              /* PUT REL LVL IN REG 7      */
         SRDL  R6,L5
*        GEN(SLL   R6,L2);              /* MULT. SYS VALUE BY 4      */
         SLL   R6,L2
*        GEN(LA    R6,RELTAB(R6));      /* INDEX  INTO SYS TABLE     */
         LA    R6,RELTAB(R6)
*        GEN(SRL   R7,L27);             /* MOVE VALUE TO LOW ORDER   */
         SRL   R7,L27
*        IF DOSCONST  = R6->SYSNAM      /* IS SYSTEM NAME DOS ?      */
*        THEN                           /* YES - DO                  */
         CLC   DOSCONST(4),SYSNAM(R6)                              0358
         BNE   @RF00358                                            0358
*        DO;                            /*                   @D35UGFD*/
*          R7 = R7 + 26;                /* MUST ADD 26    */       0360
         AL    R7,@CF00658                                         0360
*          IF R7 >  THIRTY4             /* GREATER THAN REL 34 ?  */
*          THEN                         /* YES - DO       */       0361
         C     R7,THIRTY4                                          0361
         BNH   @RF00361                                            0361
*            R7 = R7 - 34;              /* MUST SUBT 34  */        0362
         SL    R7,@CF00573                                         0362
*        END;                           /* END DOS ONLY CODE @D35UGFD*/
@RF00361 DS    0H                                                  0364
*         R5 = SYSSTART;           /* PICK UP SYS NAME START POS. */
@RF00358 SLR   R5,R5                                               0364
         IC    R5,SYSSTART(,R9)                                    0364
*         R1 = R1 + R5;           /* POINT TO SYS NAME O/P AREA   */
         ALR   R1,R5                                               0365
*         SYSSTUF = R6 ->SYSNAM;  /* MOVE SYS NAME TO PRINT BUFFER */
         MVC   SYSSTUF(4,R1),SYSNAM(R6)                            0366
*         R1 = R1 + 5;           /* POINT TO LABEL O/P AREA   */   0367
         AL    R1,@CF00076                                         0367
*         SYSSTUF = RELCONST;     /* MOVE REL LABELTO PRINT BUFFER */
         MVC   SYSSTUF(4,R1),RELCONST                              0368
*         R1 = R1 + 8;           /* POINT TO REL # O/P AREA   */   0369
         AL    R1,@CF00062                                         0369
*          IF R7 >  0                   /* DOES REL NUM EXIST  ?  */
*          THEN                         /* YES - DO       */       0370
         LTR   R7,R7                                               0370
         BNP   @RF00370                                            0370
*          DO;                                                     0371
*            GEN(CVD   R7,WORK);        /* CONV REL LEVEL*/        0372
         CVD   R7,WORK
*            GEN(UNPK  L0(L2,R1),WORK+L6(L2));/* UNPK INTO PRINT BUF */
         UNPK  L0(L2,R1),WORK+L6(L2)
*            GEN(MVZ   L1(L1,R1),L0(R1));     /* MOVE ZONES          */
         MVZ   L1(L1,R1),L0(R1)
*          END;                         /* END GREATER THAN 34 CODE */
*          ELSE                         /* NO REL NUM     */       0376
*          DO;                                                     0376
         B     @RC00370                                            0376
@RF00370 DS    0H                                                  0377
*            SYSSTUF = NONE;            /* MOVE NONE TO REL LVL  */
         MVC   SYSSTUF(4,R1),NONE                                  0377
*          END;                         /* END NO REL NUM.     CODE */
*        R9=R9+4;                       /* BUMP TO NEXT ENTRY        */
@RC00370 AL    R9,@CF00060                                         0379
*        R8=EDSPSV8;                    /* RESTORE R8        @D35UGFD*/
         L     R8,EDSPSV8                                          0380
*        GOTO R8;                       /* RETURN            @D35UGFD*/
         BR    R8                                                  0381
*        RESPECIFY (R1,R5,R6,R7) UNRESTRICTED;             /*@D35UGFD*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      BINARY ENTRIES (2/4 BYTE)  PRINTS OUT BINARY BITS(MAX 32)   */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*        RESPECIFY (R1,R5,R6,R7) RESTRICTED;               /*@Z427VLS*/
*EDBIN2 :     ;                         /* TWO BYTE ENTRY POINT      */
EDBIN2   DS    0H                                                  0385
*        EDSPSV8=R8 ;                   /* SAVE RTN PTR      @Z427VLS*/
         ST    R8,EDSPSV8                                          0385
*        EDSPSV5=2;                     /* SET IN NO. OF BYTE ENTRY  */
         MVC   EDSPSV5(4),@CF00071                                 0386
*        GEN(IC    R4,L1(R9));          /* PICK UP SHIFT CHARACTER   */
         IC    R4,L1(R9)
*        GEN(SLL   R4,L29);             /* DROP ALL BUT LOW  @Z427VLS*/
         SLL   R4,L29
*        GEN(SRL   R4,L29);             /* ORDER 3 BITS      @Z427VLS*/
         SRL   R4,L29
*        R8=R3;                         /* SET PTR OF BUFF TO WORK R8*/
         LR    R8,R3                                               0390
*        R7=1 ;                         /* SET NO. OF CHARS TO DO    */
         LA    R7,1                                                0391
*        GOTO EDOFFSET ;                /* BR-COMMON         @Z427VLS*/
         B     EDOFFSET                                            0392
*EDBIN4 :     ;                         /* 4 BYTE ENTRY POINT        */
EDBIN4   DS    0H                                                  0394
*        EDSPSV8=R8;                    /* SAVE RTN ADDR     @Z427VLS*/
         ST    R8,EDSPSV8                                          0394
*        EDSPSV5=4 ;                    /* SET VALUE TO INDICATE 4   */
         MVC   EDSPSV5(4),@CF00060                                 0395
*        R4=0 ;                         /* BYTE ENTRY        @Z427VLS*/
         SLR   R4,R4                                               0396
*        GEN(IC    R4,L3(R9));          /* PICK UP SHIFT & NO. CHAR  */
         IC    R4,L3(R9)
*        R7=R4 ;                        /* SAVE VALUE IN R7  @Z427VLS*/
         LR    R7,R4                                               0398
*        GEN(SLL   R4,L29);             /* DROP ALL BUT LAST 3 BITS  */
         SLL   R4,L29
*        GEN(SRL   R4,L29);             /* SHIFT VALUE       @Z427VLS*/
         SRL   R4,L29
*        GEN(SRL   R7,L4);              /* R7 HAS NO. OF CHARS TO DO */
         SRL   R7,L4
*        GEN(IC    R5,L2(R9));          /* PICK UP SPACE BTWN CHAR   */
         IC    R5,L2(R9)
*        R6=127 ;                       /* AND OFF ALL       @Z427VLS*/
         LA    R6,127                                              0403
*        GEN(NR    R5,R6);              /* UNUSED BITS       @Z427VLS*/
         NR    R5,R6
*        R8=R3 ;                        /* SET PTR TO BUFF IN WORK   */
         LR    R8,R3                                               0405
*        IF ACMIN^='1'B                 /* IF BIT IS OFF VALUE IN R5 */
*              THEN                     /* IS SPACE BETWEEN CHARS    */
         TM    ACMIN(R9),B'10000000'                               0406
         BNO   @RT00406                                            0406
*                   GOTO EDBIN4A;       /* IF IT IS ON VALUE A NEG   */
*        R8=R8-R5;                      /* OFFSET TO BE DECREMENTED  */
         SLR   R8,R5                                               0408
*        R5=0 ;                         /* THEN SPACE BTWN=0 @Z427VLS*/
         SLR   R5,R5                                               0409
*EDBIN4A:     ;                         /*                   @Z427VLS*/
EDBIN4A  DS    0H                                                  0411
*        IF R7=0                        /* ANY CHARS TO DO   @Z427VLS*/
*              THEN                     /* IF VALUE ZERO     @Z427VLS*/
         LTR   R7,R7                                               0411
         BZ    @RT00411                                            0411
*                   GOTO EDBLOOPD;      /* SKIP              @Z427VLS*/
*EDOFFSET:    ;                         /*                   @Z427VLS*/
EDOFFSET DS    0H                                                  0414
*        R6=0 ;                         /*                   @Z427VLS*/
         SLR   R6,R6                                               0414
*        GEN(IC    R6,R0(R9));          /* PICK UP           @Z427VLS*/
         IC    R6,R0(R9)
*        GEN(SLL   R6,L8);              /* 12 BIT            @Z427VLS*/
         SLL   R6,L8
*        GEN(IC    R6,L1(R9));          /* OFFSET INTO       @Z427VLS*/
         IC    R6,L1(R9)
*        GEN(SRL   R6,L4);              /* INPUT RECORD      @Z427VLS*/
         SRL   R6,L4
*        R6=R6+R2;                      /* SET UP PTR TO INDEXED BITS*/
         ALR   R6,R2                                               0419
*        R1=ADDR(CHARTAB);              /* SET PTR TO EBCDIC CHARS   */
         LA    R1,CHARTAB                                          0420
*        GEN(MVC   BINCHARS(L4),L0(R6));/* MOVE OVER 4 BYTES @Z427VLS*/
         MVC   BINCHARS(L4),L0(R6)
*/*                                                          @Z427VLS*/
*/*      BLOCK=GENERATE  FOR SPECIAL HANDLING                @Z427VLS*/
*/*                                                          @Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
         L     R15,BINCHARS             PICK UP CHARS
         LTR   R4,R4                    IS SHIFTING REQUESTED
         BZ    EDBLOOP                  BR-NO
EDSHIFT  SLL   R15,L1                   YES DROP OFF HI ORDER BITS
         BCT   R4,EDSHIFT               AS SPECIFIED
EDBLOOP  SR    R14,R14
         SLDL  R14,L1                   BRING 1 BIT TO R14
         AR    R14,R1                   INDEX INTO CHARS
         MVC   L0(L1,R8),L0(R14)        MOVE INDEXED CHAR TO BUFF
         AR    R8,R5                    ADD IN SPACING VALUE
         LA    R8,L1(R8)                PLUS 1 MORE
         BCT   R7,EDBLOOP               LOOP TILL DONE
*EDBLOOPD:    ;                         /*                   @Z427VLS*/
EDBLOOPD DS    0H                                                  0424
*        R9=R9+EDSPSV5;                 /* BUMP OVER ENTRY TO NEXT   */
         AL    R9,EDSPSV5                                          0424
*        R3=R3+EDFORM(2);               /* BUMP BUFF PTR TO NXT COL  */
         AH    R3,EDFORM+2                                         0425
*        R8=EDSPSV8;                    /* RESET RTN ADDR    @Z427VLS*/
         L     R8,EDSPSV8                                          0426
*        GOTO R8 ;                      /* RETURN            @Z427VLS*/
         BR    R8                                                  0427
*        RESPECIFY (R1,R5,R6,R7) UNRESTRICTED;             /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      HEX DUMP ROUTINE-PROVIDE A HEX DUMP  BLOCK GEN FOR EASE     */
*/*                                                 OF CODING & SPACE*/
*/********************************************************************/
*EDHEXDMP:    ;                                            /*@Z427VLS*/
EDHEXDMP DS    0H                                                  0430
*GENERATE REFS(RECLNGTH);                                  /*@VS48704*/
*        R2    PTR TO RECORD
*        R3    PTR TO PRINT BUFF
*        R9    RETURN REG
*
         CLC   EDFORM1(L2),ZERO         ANY DUMP WANTED
         BCR   L8,R9                    BR-NO
         BCTR  R3,R0                    POINT TO CARRIAGE CONTROL CHAR
         ST    R3,EDBUFSVE              SAVE REGS
         ST    R9,EDDMPSVE              FOR RETURN
         L     R4,SAVER2                GET ADDRESS OF COMTABLE
         LH    R4,RECLNGTH(R4)          GET SIZE OF RECORD FROM COMTBL
         LH    R5,EDFORM1+L2            PICK UP OFFSET TO LOGOUT SECT
         LH    R6,EDFORM1+L4            PICK ADDR TO USE ON DUMP
         AR    R4,R2                    SET R4 TO END OF RECORD
         AR    R5,R2                    SET R5 TO END OF STANDARD SECT
*
*              HEADER MESSAGE OF HEX DUMP
*
         MVC   L4(L18,R3),EDHEXMSG      PUT OUT MESSAGE
*        CALL PRINTIT;                                     /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0431
*    GENERATE;                                             /*@Z427VLS*/
         MVI   L4(R3),BLANK             CLEAR
         MVC   L5(L17,R3),L4(R3)        BUFFER
*
*              HEADER MESSAGE OF HEADER
*
         MVC   L4(L6,R3),EDHDMSG        SET HDR ON FIRST LINE OF DUMP
*
EDHDMP01 CR    R2,R5                    IS REGULAR SECT DONE
         BNL   EDHDMP02                 BR-YES
         BAL   R9,EDHDMP05              BR TO SETUP LINE WITH NO ADDR
         L     R3,EDBUFSVE              RESET R3
*        CALL  PRINTIT;                                    /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0433
*   GENERATE;                                              /*@Z427VLS*/
         MVI   L1(R3),BLANK             BLANK
         MVC   L2(L119,R3),L1(R3)       LINE
         B     EDHDMP01                 LOOP TILL DONE
*
*
*
EDHDMP02 EQU   *
*        CALL  PRINTIT;                                    /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0435
*     GENERATE;                                            /*@Z427VLS*/
EDHDMPA  EQU   *
         BAL   R9,EDHDMP03              BR TO SETUP LINE WITH ADDR
         LA    R6,L32(R6)               UP INPUT PTR
         L     R3,EDBUFSVE              RESET R3
*        CALL  PRINTIT;                                    /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0437
*     GENERATE;                                            /*@Z427VLS*/
         MVI   L1(R3),BLANK             BLANK
         MVC   L2(L119,R3),L1(R3)       LINE
         CR    R2,R4                    DONE WITH REC
         BL    EDHDMPA                  NO LOOP
         L     R9,EDDMPSVE              YES RESTORE RTN ADDR
         BR    R9                       RTN
*
EDHDMP03 LA    R7,CHARTAB               PICK UP PTR TO CHARACTERS
         LA    R10,L4                   NUMBER OF BITS TO CONVERT
         LR    R15,R6                   NUMBER OF ADDR TO CONVERT
         SLL   R15,L16                  MOVE NUMBER TO HI END
EDHDMP04 SR    R14,R14                  MOVE 4 BITS TO R14
         SLDL  R14,L4                   INDEX INTO CHARACTERS
         AR    R14,R7                   TO FIND PROPER ONE
         MVC   L8(L1,R3),L0(R14)        THEN MOVE IT INTO BUFF
         LA    R3,L1(R3)                BUMP BUFF PTR
         BCT   R10,EDHDMP04             LOOP TILL DONE
         L     R3,EDBUFSVE              PICK UP BUFF PTR
         LR    R5,R4                    SET END OF AREA PTR
EDHDMP05 LA    R7,CHARTAB               SET PTR TO CHARS
         LA    R10,L2                   NO. DBL WDS PER LINE
         LA    R8,L4                    NO. WDS PER DBL WDS
         LR    R1,R8                    NO. BYTES PER WORD
EDHDMP06 CR    R2,R5                    DONE YET
         BNL   EDHDMP07                 BR-YES
         IC    R15,L0(R2)               PICK UP CHAR
         SLL   R15,L24                  MOVE TO HI END
         SR    R14,R14                  ZERO R14
         SLDL  R14,L4                   MOVE 4 BITS TO R14
         AR    R14,R7                   INDEX TO CHAR
         MVC   L14(L1,R3),L0(R14)       MOVE INDEXED CHAR TO BUFF
         SR    R14,R14                  ZERO R14
         SLDL  R14,L4                   MOVE LAST 4 BITS TO R14
         AR    R14,R7
         MVC   L15(L1,R3),L0(R14)
         LA    R3,L2(R3)
         LA    R2,L1(R2)
         BCT   R1,EDHDMP06
         LA    R1,L4
         LA    R3,L4(R3)
         BCT   R8,EDHDMP06
         LA    R8,L4
         LA    R3,L4(R3)
         BCT   R10,EDHDMP06
EDHDMP07 BR    R9
EDHEXMSG DC    CL18'HEX DUMP OF RECORD'
EDHDMSG  DC    CL6'HEADER'
EDBUFSVE DS    F
EDFORM1  DS    3H
ZERO     DC    H'0'
*/********************************************************************/
*EDEND  :     ;                                            /*@Z427VLS*/
*  RETURN;                                                 /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0440
@EF00001 DS    0H                                                  0440
@ER00001 L     @14,12(,@13)                                        0440
         LM    @00,@12,20(@13)                                     0440
         BR    @14                                                 0440
*        END                                               /*@Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 0441
         B     @EL00001                                            0441
@DATA    DS    0H
@CH00064 DC    H'12'
@SM00677 MVC   0(0,@01),0(@14)
         DS    0F
@AL00097 DC    A(@CF00071+2)           LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
         DS    0F
@CF00051 DC    F'1'
@CF00071 DC    F'2'
@CH00071 EQU   @CF00071+2
@CF00073 DC    F'3'
@CF00060 DC    F'4'
@CF00076 DC    F'5'
@CF00062 DC    F'8'
@CF00658 DC    F'26'
@CF00573 DC    F'34'
@CF00675 DC    F'-8'
         DS    0D
SAVER2   DS    F
EDSPSV8  DS    F
EDPRBUF  DS    F
EDLBBASE DS    F
EDSPBASE DS    F
EDSPSV5  DS    F
SWAPR2   DS    F
SAVER7   DS    F
THIRTY4  DC    F'34'
RELOFFST DC    F'16'
I        DC    F'0'
BINCHARS DS    F
EDDMPSVE DS    F
EDPRDCB  DS    F
SYNAD    DS    F
X        DS    H
Y        DS    H
BBLANK   DC    CL1' '
EDLOAD   DS    CL8
         DS    CL7
WORK     DS    CL8
DUMBUFF  DC    CL134' '
         ORG   DUMBUFF
DDTYPE   DC    CL1'0'
MOVETOLN DS    CL133
         ORG   MOVETOLN
SPACING  DC    X'09'
         ORG   DUMBUFF+134
BUFFER   DS    CL122
         ORG   BUFFER
SAVECC   DS    BL1
MOVELINE DS    CL133
         ORG   MOVELINE
CC       DC    X'09'
PRBUFF   DC    CL133' '
         ORG   BUFFER+135
NONE     DC    CL4'NONE'
DOSCONST DC    CL4'DOS '
RELCONST DC    CL4'REL.'
FLAGS    DC    X'00'
         ORG   FLAGS
NOPRINT  DS    BL1
DUMSW    EQU   FLAGS+0
         ORG   FLAGS+1
BUG1     DC    CL50'DEBUG1          IS PRODUCING THE FOLLOWING LINE(S)'
         DS    CL4
DBLWORK  DS    CL8
EDDEL    DS    CL8
SUPERZAP DC    3CL10'SUPERZAP'
EDFORM   DS    4H
PATCH    DC    20H'0'
CHARTAB  DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
IFCEEDIT CSECT
         DC    S(SUPERZAP)
IFCEEDIT CSECT
HEX0017  DC    X'0017'                                         @D35UGFD
RELTAB   DS    0C                                              @D35UGFD
         DC    C'OS  '                                         @D35UGFD
         DC    C'DOS '                                         @D35UGFD
         DC    C'VS 1'                                         @D35UGFD
         DC    C'V370'                                         @D35UGFD
         DC    C'VS 2'                                         @D35UGFD
         DC    C'    '                                         @D35UGFD
         DC    C'    '                                         @D35UGFD
         DC    C'    '                                         @D35UGFD
IFCEEDIT CSECT
    DC  S(PATCH)
IFCEEDIT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
IOHND    EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
DEBUG    EQU   PARM+4
DEBUG1   EQU   DEBUG
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECLNGTH EQU   CCHHRLNG+6
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRBASE  EQU   SHAREIO+1
SHRCUCPU EQU   SHAREIO+8
EDITLOAD EQU   0
EDITNUM  EQU   EDITLOAD
EDITABLE EQU   EDITLOAD+4
LOADNAME EQU   EDITABLE
LOADPTR  EQU   EDITABLE+8
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
COUNT    EQU   0
DUMMY    EQU   0
B2ENTRY  EQU   0
ACENTRY  EQU   0
@NM00013 EQU   ACENTRY
@NM00014 EQU   ACENTRY+2
ACMIN    EQU   @NM00014
@NM00015 EQU   ACENTRY+3
BEFEN    EQU   0
@NM00016 EQU   BEFEN
BEFFLD1  EQU   BEFEN+2
BEFFLD2  EQU   BEFEN+3
DENTRY   EQU   0
@NM00018 EQU   DENTRY
DOFFSET  EQU   DENTRY+2
SYSRELE  EQU   0
@NM00019 EQU   SYSRELE
SYSSTART EQU   SYSRELE+2
SYSSTUF  EQU   0
SYSNAM   EQU   0
NINENTRY EQU   0
NOFFSET  EQU   NINENTRY
NIN      EQU   NINENTRY+2
NOUT     EQU   NINENTRY+3
LABELST  EQU   0
FRDTLD   EQU   0
EDSPSV9  EQU   FRDTLD+12
LABELPTR EQU   FRDTLD+16
IFCMSG   EQU   0
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FIRSTMOD EQU   FRDTLD+4
@NM00020 EQU   FRDTLD
NSIGN    EQU   NOFFSET+1
NRECA    EQU   NOFFSET
SSIGN    EQU   @NM00019+1
SRECA    EQU   @NM00019
DADDR    EQU   DOFFSET
DSHIFT   EQU   DOFFSET
DSIGN    EQU   @NM00018+1
DRECA    EQU   @NM00018
BEFSIGN  EQU   @NM00016+1
@NM00017 EQU   @NM00016
ACSHFT   EQU   @NM00015
ACNO     EQU   @NM00015
ACSPAC   EQU   @NM00014
ACSIGN   EQU   @NM00013+1
ACRECA   EQU   @NM00013
B2SHIFT  EQU   B2ENTRY+1
B2RECA   EQU   B2ENTRY
FLAG     EQU   DUMMY+1
@NM00012 EQU   DUMMY
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
SHARLET  EQU   SHAREIO+15
SHRCUAAH EQU   SHRCUCPU+5
SHRCUAAL EQU   SHRCUCPU+3
SHARSERA EQU   SHRCUCPU
SHRCUABH EQU   SHRBASE+5
SHRCUABL EQU   SHRBASE+3
SHARSERB EQU   SHRBASE
SHAREFLG EQU   SHAREIO
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
LINECT   EQU   PARM+120
@NM00009 EQU   CCHHRLNG+5
RECCCHHR EQU   CCHHRLNG
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SORTNUM  EQU   PARM+84
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG4   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00114 EQU   EDDONE
@RT00116 EQU   EDPR0002
@RF00133 EQU   EDPR0000
@RT00149 EQU   EDPR0005
@RT00156 EQU   EDPR0003
@RT00169 EQU   EDLBLP02
@RT00175 EQU   EDLBLP03
@RT00177 EQU   EDLBLP03
@RT00182 EQU   EDLBLP04
@RT00188 EQU   NOPUT
@RT00198 EQU   EDCCLP1
@RT00202 EQU   EDCCLP2
@RT00240 EQU   EDFRMLP1
@RT00243 EQU   EDFRMLP0
@RT00251 EQU   EDFRMLP2
@RT00305 EQU   EDHLOOP3
@RT00313 EQU   EDHLOOP0
@RT00337 EQU   EDHLOOP0
@RT00406 EQU   EDBIN4A
@RT00411 EQU   EDBLOOPD
EDEND    EQU   @EL00001
@ENDDATA EQU   *
         END   IFCEEDIT

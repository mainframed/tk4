         TITLE 'IFCEVENT-EVENT HISTORY PROCESSING'
IFCEVENT CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCEVENT  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @10,0                                               0001
@PSTART  LA    @11,4095(,@10)                                      0001
         LA    @12,4095(,@11)                                      0001
         LA    @04,4095(,@12)                                      0001
         USING @PSTART,@10                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@12                                    0001
         USING @PSTART+12285,@04                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0209
TEMPLATE STM   @14,@12,@SA00002                                    0209
*  SPACING = UPSPACE;                                      /*@Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0210
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0211
*  SPACING = DOUBLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0212
*  TOPTEMP = LINE01;             /*MOVE THE TOP LINE OF TEMPLATE IN  */
         MVC   TOPTEMP(23),LINE01                                  0213
*  CALL PRINTIT;                 /*PRINT OUT THE HEADING FOR TEMPLATE*/
         BAL   @14,PRINTIT                                         0214
*  DO N = 1 BY 1 TO 9;           /*PRINT 9 PAIR OF LINES     @Z427VLS*/
         LA    @06,1                                               0215
         ST    @06,N                                               0215
@DL00215 DS    0H                                                  0216
*    GEN(MVI  TIME1,X'40');                                /*@Z427VLS*/
         MVI  TIME1,X'40'
*    GEN(MVC  TIME1+1(130),TIME1);                         /*@Z427VLS*/
         MVC  TIME1+1(130),TIME1
*    SPACING = SINGLE;                                     /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0218
*    CALL PRINTIT;               /*PRINT SEPT LINE           @Z427VLS*/
         BAL   @14,PRINTIT                                         0219
*    LINE002 = LINE02;           /*MOVE COMMON PART OF LINE IN       */
         MVC   LINE002(20),LINE02                                  0220
*    R8 = ADDRTAB1(N);           /*WHERE THE DATA IS AT      @Z427VLS*/
         L     @06,N                                               0221
         SLA   @06,2                                               0221
         L     R8,ADDRTAB1-4(@06)                                  0221
*    R9 = NUMCHAR1(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         L     R9,NUMCHAR1-4(@06)                                  0222
*    GEN(EX   R9,EXECMVC);       /*EXEC THE MOVE CHAR        @Z427VLS*/
         EX   R9,EXECMVC
*    SPACING = DOUBLE;                                     /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0224
*    CALL PRINTIT;               /*GO PRINT THE DATA         @Z427VLS*/
         BAL   @14,PRINTIT                                         0225
*    DUPLICAT  = LINE04;         /*MOVE IN THE COMMON PART OF MESSAGE*/
         MVC   DUPLICAT(33),LINE04                                 0226
*    R8 = ADDRTAB2(N);           /*SET UP WHERE THE DATA IS  @Z427VLS*/
         L     @06,N                                               0227
         SLA   @06,2                                               0227
         L     R8,ADDRTAB2-4(@06)                                  0227
*    R9 = NUMCHAR2(N);           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         L     R9,NUMCHAR2-4(@06)                                  0228
*    GEN(EX    R9,EXECMVC2);     /*EXEC THE MVC INSTRUCTION  @Z427VLS*/
         EX    R9,EXECMVC2
*    SPACING = DOUBLE;           /*SET TO SINGLE SPACE ON THIS LINE  */
         MVC   SPACING(1),DOUBLE                                   0230
*    CALL PRINTIT;               /*GO RPINT THE BUFFER       @Z427VLS*/
         BAL   @14,PRINTIT                                         0231
*   END;                                                   /*@Z427VLS*/
         LA    @06,1                                               0232
         AL    @06,N                                               0232
         ST    @06,N                                               0232
         C     @06,@CF00085                                        0232
         BNH   @DL00215                                            0232
*   SPACING = SINGLE;                                      /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   0233
*   MDROBRLN = MDRLINE;          /*SET UP SECOND HALF OF OUTPUT      */
         MVC   MDROBRLN(35),MDRLINE                                0234
*   CALL PRINTIT;                /*GO PRINT THE THIRD LINE FOR THIS  */
         BAL   @14,PRINTIT                                         0235
*    GENERATE DATA;                                        /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@EL00002 DS    0H                                                  0237
@EF00002 DS    0H                                                  0237
@ER00002 LM    @14,@12,@SA00002                                    0237
         BR    @14                                                 0237
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE BINARY NUMBER IN ITEM BINWORD TO   */
*/*    PRINTABLE IF THE NUMBER (CONVERTED) IS > THAN THE NUMBER OF   */
*/*    CHARACTERS REQUESTED (IN ITEM BNDECNUM) A NINE WILL BE PLACED */
*/*    IN EACH PRINT POSITION                                @Z427VLS*/
*/*                                                          @Z427VLS*/
*CONVBIN:  PROC;                                           /*@Z427VLS*/
CONVBIN  STM   @14,@12,@SA00003                                    0238
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @Z427VLS*/
         L     R8,BINWORD                                          0239
* GEN(CVD   R8,DBLWORD);         /*CONVERT THE NUMBER        @Z427VLS*/
         CVD   R8,DBLWORD
* GEN(UNPK   WORK(8),DBLWORD);   /*UNPACK THE CONVERTED NUMBER       */
         UNPK   WORK(8),DBLWORD
* GEN(OI    WORK+7,X'F0');       /*INSURE SIGN IS NO PROBLEM @Z427VLS*/
         OI    WORK+7,X'F0'
* SWITCH2 = OFF;                 /*CLEAR THE SWITCH PRIOR TO START   */
         NI    SWITCH2,B'10111111'                                 0243
* DO L = 1 BY 1 TO 7 WHILE (SWITCH2 = OFF);                /*@Z427VLS*/
         LA    @06,1                                               0244
         ST    @06,L                                               0244
@DL00244 TM    SWITCH2,B'01000000'                                 0244
         BNZ   @DC00244                                            0244
*  IF WORKOVER(L)  = 'F0'X       /*IS IT A 0 IF SO MAKE IT A BLANK   */
*    THEN                                                          0245
         LA    @05,WORKOVER-1(@06)                                 0245
         CLI   0(@05),X'F0'                                        0245
         BNE   @RF00245                                            0245
*      WORKOVER(L) = '40'X;      /*SET TO A BLANK            @Z427VLS*/
         LA    @05,WORKOVER-1(@06)                                 0246
         MVI   0(@05),X'40'                                        0246
*    ELSE                                                          0247
*      SWITCH2 = ON;             /*SET SWITCH TO TERMINATE DO LOOP   */
         B     @RC00245                                            0247
@RF00245 OI    SWITCH2,B'01000000'                                 0247
* END;                                                     /*@Z427VLS*/
@RC00245 LA    @06,1                                               0248
         AL    @06,L                                               0248
         ST    @06,L                                               0248
         C     @06,@CF00082                                        0248
         BNH   @DL00244                                            0248
@DC00244 DS    0H                                                  0249
* IF (TEN   - L) > BNDECNUM      /*IS THE CONVERTED NUMBER TO LARGE  */
*    THEN                                                          0249
         L     @06,TEN                                             0249
         SL    @06,L                                               0249
         C     @06,BNDECNUM                                        0249
         BNH   @RF00249                                            0249
*      DO;                                                 /*@Z427VLS*/
*        GEN(MVI   WORKOVER,X'F9');  /*SET FIRST NINE IN THE MEASSAGE*/
         MVI   WORKOVER,X'F9'
*        GEN(MVC   WORKOVER+1(7),WORKOVER);/*FILL WITH NINES @Z427VLS*/
         MVC   WORKOVER+1(7),WORKOVER
*      END;                                                /*@Z427VLS*/
* R8 = ADDR(WORKOVER) + (8-BNDECNUM);/*SET WHERE TO MOVE FROM ADDRESS*/
@RF00249 LA    R8,WORKOVER                                         0254
         L     @06,BNDECNUM                                        0254
         LA    @05,8                                               0254
         SLR   @05,@06                                             0254
         ALR   R8,@05                                              0254
* R9 = BNDECNUM - ONE;           /*NUMBER OF BYTES TO MOVE   @Z427VLS*/
         SL    @06,ONE                                             0255
         LR    R9,@06                                              0255
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* R6 = DECADDR;                  /*ADDRESS TO MOVE TO        @Z427VLS*/
         L     R6,DECADDR                                          0257
* GEN(EX    R9,MVCDATA);         /*MOVE DATA TO REQUESTED LOCATION   */
         EX    R9,MVCDATA
* GENERATE DATA;                                           /*@Z427VLS*/
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0261
@EF00003 DS    0H                                                  0261
@ER00003 LM    @14,@12,@SA00003                                    0261
         BR    @14                                                 0261
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE HEX DATA INTO PRINTABLE    @Z427VLS*/
*/*                                                          @Z427VLS*/
*/*    IF IT IS NECESSARY TO CONVERT ONLY 1/2 OF FIRST BYTE(CUA FOR  */
*/*    EXP. THEN THE USER SHOULD SET THE SWITCH1 TO THEON CONDITION  */
*CONVERT: PROC;                                            /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     0262
* DO P = NUMBER BY -1 TO 1;      /*# = # OF BYTES TO CONVERT TO PRINT*/
         L     @06,NUMBER                                          0263
         ST    @06,P                                               0263
         B     @DE00263                                            0263
@DL00263 DS    0H                                                  0264
*   R8 = NEXTBYTE(P);            /*LOAD THE NEXT BYTE TO CONVERT     */
         L     @05,NEXTBY                                          0264
         BCTR  @05,0                                               0264
         SLR   R8,R8                                               0264
         IC    R8,NEXTBYTE(@06,@05)                                0264
*   X =  TWO * P;                /*OUTPUT INDEX MUST BE TWICE INPUT  */
         L     @01,TWO                                             0265
         MR    @00,@06                                             0265
         ST    @01,X                                               0265
*   SRDL  (R8,FOUR);             /*MOVE 1/2 IN TO NEXT REG   @Z427VLS*/
         SRDL  R8,4                                                0266
*   SRL   (R9,TWOEIGHT);         /*SHIFT THE REG 28 BITS     @Z427VLS*/
         L     @05,TWOEIGHT                                        0267
         SRL   R9,0(@05)                                           0267
*   R9  =  R9 + NUMBER1;         /*INSURE INDEX BY 0 DOES NOT AFFECT */
         L     @05,NUMBER1                                         0268
         ALR   R9,@05                                              0268
*   R8  =  R8 + NUMBER1;         /*SAME                      @Z427VLS*/
         ALR   R8,@05                                              0269
*   IF SWITCH1 = ON & P = ONE    /*DO WE NOT PUT THE HALF BYTE OUT   */
*    THEN                                                          0270
         TM    SWITCH1,B'10000000'                                 0270
         BNO   @RF00270                                            0270
         C     @06,ONE                                             0270
         BNE   @RF00270                                            0270
*     SWITCH1 = OFF;             /*TURN OFF THE SWITCH       @Z427VLS*/
         NI    SWITCH1,B'01111111'                                 0271
*    ELSE                                                          0272
*     ADDNUM(X-ONE) = CHARS(R8);/*PUT THE PRINT CHAR INTO THE OUTPUT*/
         B     @RC00270                                            0272
@RF00270 L     @06,X                                               0272
         SL    @06,ONE                                             0272
         L     @05,ADDNXT                                          0272
         ALR   @05,@06                                             0272
         BCTR  @05,0                                               0272
         LA    @06,CHARS-1(R8)                                     0272
         MVC   ADDNUM(1,@05),0(@06)                                0272
*     ADDNUM(X)  = CHARS(R9);   /*FINSH THE BYTE             @Z427VLS*/
@RC00270 L     @06,ADDNXT                                          0273
         AL    @06,X                                               0273
         BCTR  @06,0                                               0273
         LA    @05,CHARS-1(R9)                                     0273
         MVC   ADDNUM(1,@06),0(@05)                                0273
* END;                                                     /*@Z427VLS*/
         SLR   @06,@06                                             0274
         BCTR  @06,0                                               0274
         AL    @06,P                                               0274
         ST    @06,P                                               0274
@DE00263 LTR   @06,@06                                             0274
         BP    @DL00263                                            0274
*END;                                                      /*@Z427VLS*/
@EL00004 DS    0H                                                  0275
@EF00004 DS    0H                                                  0275
@ER00004 LM    @14,@12,12(@13)                                     0275
         BR    @14                                                 0275
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL ADD TOTALS OF EACH TYPE RECORD AND PRINT THE   */
*/*    TOTALS                                                @Z427VLS*/
*/*    THIS PROC IS BASED ON THERE BEING 23 MINOR TYPES OF RECORDS   */
*/*    (UNDER THE 9 MAIN) ANY CHANGE IN THE NUMBER OF TYPES WILL     */
*/*    RESULT IN BAD THINGS                                  @Z427VLS*/
*/*    ALL 23 LENGHT ITEMS WILL JUST NEED THERE LENGTH ADJUSTED ALSO */
*/*    THE TYPES WILL NEED ADJUSTING AND THE TYPE COUNTERS THESE ARE */
*/*    NOT IN A TABLE AND START AFTER ITEM NUMCHAR2          @Z427VLS*/
*/*                                                          @Z427VLS*/
*PRTTOTAL:  PROC;                                          /*@Z427VLS*/
PRTTOTAL STM   @14,@12,@SA00005                                    0276
* SPACING = UPSPACE;             /*START ON A FRESH PAGE     @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0277
* CALL PRINTIT;                                            /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0278
*  SWITCH5 = ON;    /*SET TO UP SPACE DURING TOTALS IF REQ   @0001VLS*/
         OI    SWITCH5,B'00001000'                                 0279
* SPACING = DOUBLE;              /*RESET TO SINGLE SPACING   @Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   0280
* Z = ONE;                       /*SET INDEX TO STEP THROUGH @Z427VLS*/
         L     @06,ONE                                             0281
         ST    @06,Z                                               0281
* TOTALHD2 = TOTALHD1;           /*MOVE IN WORDS RECORD TYPES        */
         MVC   TOTALHD2(12),TOTALHD1                               0282
* RESPECIFY (R6) RESTRICTED;                               /*@Z427VLS*/
* R6 = ADDR(TOTALHD3) ;                                    /*@Z427VLS*/
         LA    R6,TOTALHD3                                         0284
* R8 = ADDR(TIME1) + 26;                                   /*@Z427VLS*/
         LA    R8,TIME1                                            0285
         AL    R8,@CF01168                                         0285
* R9 = 7     + SIX * EVNUM;                                /*@Z427VLS*/
         L     @05,EVPTR(,R2)                                      0286
         L     R9,SIX                                              0286
         MH    R9,EVNUM(,@05)                                      0286
         AL    R9,@CF00082                                         0286
* GEN(EX  R9,MOVECHAR);                                    /*@Z427VLS*/
         EX  R9,MOVECHAR
* RESPECIFY (R6) UNRESTRICTED;                             /*@Z427VLS*/
* CALL PRINTIT;                  /*PRINT THE HEADING FOR THE TOTALS  */
         BAL   @14,PRINTIT                                         0289
* SPACING = SINGLE;              /*PRINT THE HEADING FOR THE TOTALS  */
         MVC   SPACING(1),SINGLE                                   0290
* DO J = 1 BY 1 TO 9 ;           /*MAIN LOOP FOR 9 TYPES OF RECORDS  */
         LA    @06,1                                               0291
         ST    @06,J                                               0291
@DL00291 DS    0H                                                  0292
*  DO  WHILE(LETTER(Z) = LETTER1);                         /*@Z427VLS*/
         B     @DE00292                                            0292
@DL00292 DS    0H                                                  0293
*   BNDECNUM = SIX;              /*SET FOR SIX CHARACTERS OUT        */
         L     @06,SIX                                             0293
         ST    @06,BNDECNUM                                        0293
*   TOTALNME = NMETOTAL(Z);      /*WILL MOVE IN 7 CHAR SUBNAME       */
         L     @06,Z                                               0294
         MH    @06,@CH00082                                        0294
         LA    @05,NMETOTAL-7(@06)                                 0294
         MVC   TOTALNME(7),0(@05)                                  0294
*   BINWORD = ZERO;              /*SET TO 0 PRIOR TO START   @Z427VLS*/
         SLR   @06,@06                                             0295
         ST    @06,BINWORD                                         0295
*   DO K = 1 BY 1 TO EVNUM;   /*EVNUM# OF CPUS FOUND THIS JOB  */  0296
         LA    @06,1                                               0296
         ST    @06,K                                               0296
         B     @DE00296                                            0296
@DL00296 DS    0H                                                  0297
*    BINWORD = COUNT(Z,K) + BINWORD;/*ADD UP THE TOTAL THIS SUBTYPE  */
         L     @05,Z                                               0297
         SLA   @05,4                                               0297
         ALR   @05,@06                                             0297
         SLA   @05,2                                               0297
         L     @05,COUNT-68(@05)                                   0297
         AL    @05,BINWORD                                         0297
         ST    @05,BINWORD                                         0297
*   END;                                                   /*@Z427VLS*/
         AL    @06,@CF00055                                        0298
         ST    @06,K                                               0298
@DE00296 L     @05,EVPTR(,R2)                                      0298
         CH    @06,EVNUM(,@05)                                     0298
         BNH   @DL00296                                            0298
*   TOTAL = TOTAL + BINWORD;     /*SAVE TO HAVE THE TOTAL OF THIS LNE*/
         L     @06,BINWORD                                         0299
         L     @05,TOTAL                                           0299
         ALR   @05,@06                                             0299
         ST    @05,TOTAL                                           0299
*   TOTOFTOT = TOTOFTOT + BINWORD;                         /*@Z427VLS*/
         AL    @06,TOTOFTOT                                        0300
         ST    @06,TOTOFTOT                                        0300
*   DECADDR = ADDR(TOTALVAL);    /*SET WHERE TO PUT CONVERTED VALUE  */
         LA    @06,TOTALVAL                                        0301
         ST    @06,DECADDR                                         0301
*   CALL CONVBIN;                /*GO CONVERT THE ITEM TO PRINTABLE  */
         BAL   @14,CONVBIN                                         0302
*   BNDECNUM = FIVE;             /*CHANGE INDIVIDUAL ITEMS TO 5 CHAR */
         L     @06,FIVE                                            0303
         ST    @06,BNDECNUM                                        0303
*   DECADDR = DECADDR + SEVEN;   /*MOVE DOWN THE PRINT LINE BY 7 CHAR*/
         L     @06,DECADDR                                         0304
         AL    @06,SEVEN                                           0304
         ST    @06,DECADDR                                         0304
*   DO K = 1 BY 1 TO EVNUM;   /*SET BY FILTER 4 TO # OF CPUS @Z427VLS*/
         LA    @06,1                                               0305
         ST    @06,K                                               0305
         B     @DE00305                                            0305
@DL00305 DS    0H                                                  0306
*    BINWORD = COUNT(Z,K);       /*PULL UP THE FIRST COUNT   @Z427VLS*/
         L     @05,Z                                               0306
         SLA   @05,4                                               0306
         ALR   @05,@06                                             0306
         SLA   @05,2                                               0306
         L     @05,COUNT-68(@05)                                   0306
         ST    @05,BINWORD                                         0306
*    TOTALS(K) = TOTALS(K) + BINWORD;/*CPU TOTALS FOR THIS LINE      */
         SLA   @06,2                                               0307
         L     @03,TOTALS-4(@06)                                   0307
         ALR   @03,@05                                             0307
         ST    @03,TOTALS-4(@06)                                   0307
*   SUBTOT(K) = SUBTOT(K) + BINWORD;/*FOR OVER ALL TOTAL     @Z427VLS*/
         AL    @05,SUBTOT-4(@06)                                   0308
         ST    @05,SUBTOT-4(@06)                                   0308
*    CALL CONVBIN;               /*GO CONVERT TO PRINTABLE 5 CHARS   */
         BAL   @14,CONVBIN                                         0309
*    DECADDR = DECADDR + SIX;    /*MOVE DOWN PRINT TO NEXT CPU       */
         L     @06,DECADDR                                         0310
         AL    @06,SIX                                             0310
         ST    @06,DECADDR                                         0310
*   END;                                                   /*@Z427VLS*/
         LA    @06,1                                               0311
         AL    @06,K                                               0311
         ST    @06,K                                               0311
@DE00305 L     @05,EVPTR(,R2)                                      0311
         CH    @06,EVNUM(,@05)                                     0311
         BNH   @DL00305                                            0311
*   CALL PRINTIT;                /*PRINT TOTAL AND INDIVIDULE COUNT  */
         BAL   @14,PRINTIT                                         0312
*   Z = Z + ONE;                 /*MOVE TO THE NEXT SUB CASE @Z427VLS*/
         L     @06,Z                                               0313
         AL    @06,ONE                                             0313
         ST    @06,Z                                               0313
*  END;                                                    /*@Z427VLS*/
@DE00292 L     @06,Z                                               0314
         LA    @05,LETTER-1(@06)                                   0314
         CLC   0(1,@05),LETTER1                                    0314
         BE    @DL00292                                            0314
*  CPU12 = EVLETTER(PTR);                                  /*@Z427VLS*/
         L     @05,PTR                                             0315
         MH    @05,@CH00080                                        0315
         L     @03,EVPTR(,R2)                                      0315
         ALR   @03,@05                                             0315
         MVC   CPU12(1),EVLETTER-6(@03)                            0315
*  LETTER1 = LETTER(Z);          /*CHANGE THE CONTROL CHARACTER      */
         LA    @05,LETTER-1(@06)                                   0316
         MVC   LETTER1(1),0(@05)                                   0316
*  BINWORD = TOTAL;              /*SET TO CONVERT THE TOTAL FOR LINE */
         L     @06,TOTAL                                           0317
         ST    @06,BINWORD                                         0317
*  BNDECNUM = SIX;               /*LET TOTAL HAVE SIX PLACES OUT     */
         L     @06,SIX                                             0318
         ST    @06,BNDECNUM                                        0318
*  TOTALNM1 = TOTHEAD(J);        /*MOVE IN WORDS TO DESCRIBE THE LINE*/
         L     @06,J                                               0319
         MH    @06,@CH00850                                        0319
         LA    @05,TOTHEAD-22(@06)                                 0319
         MVC   TOTALNM1(22),0(@05)                                 0319
*  DECADDR = ADDR(TOTALVAL);     /*WHERE TO PUT THE DATA     @Z427VLS*/
         LA    @06,TOTALVAL                                        0320
         ST    @06,DECADDR                                         0320
*  CALL CONVBIN;                 /*CONVERT THE NUMBER TO PRINTABLE   */
         BAL   @14,CONVBIN                                         0321
*  BNDECNUM = FIVE;              /*CHANGE BACK TO ONLY 5 CHARS OUT   */
         L     @06,FIVE                                            0322
         ST    @06,BNDECNUM                                        0322
*  DECADDR = DECADDR + SEVEN;    /*MOVE DOWN THE PRINT LINE  @Z427VLS*/
         L     @06,DECADDR                                         0323
         AL    @06,SEVEN                                           0323
         ST    @06,DECADDR                                         0323
*  DO K = 1 BY 1 TO EVNUM;    /*PROCESS THROUGH ALL CPUS     @Z427VLS*/
         LA    @06,1                                               0324
         ST    @06,K                                               0324
         B     @DE00324                                            0324
@DL00324 DS    0H                                                  0325
*   BINWORD = TOTALS(K);         /*GET TOTAL FOR EACH CPU    @Z427VLS*/
         SLA   @06,2                                               0325
         L     @06,TOTALS-4(@06)                                   0325
         ST    @06,BINWORD                                         0325
*   CALL CONVBIN;                /*CONVERT THIS TO PRINTABLE @Z427VLS*/
         BAL   @14,CONVBIN                                         0326
*   DECADDR = DECADDR + SIX;     /*MOVE DOWN THE PRINT LINE FOR NEXT */
         L     @06,DECADDR                                         0327
         AL    @06,SIX                                             0327
         ST    @06,DECADDR                                         0327
*  END;                                                    /*@Z427VLS*/
         LA    @06,1                                               0328
         AL    @06,K                                               0328
         ST    @06,K                                               0328
@DE00324 L     @05,EVPTR(,R2)                                      0328
         CH    @06,EVNUM(,@05)                                     0328
         BNH   @DL00324                                            0328
*  CALL PRINTIT;                 /*GO PRINT THE TOTALS FOR EACH CPU  */
         BAL   @14,PRINTIT                                         0329
*  TOTAL = ZERO;                 /*SET ITEM TO ZERO          @Z427VLS*/
         SLR   @06,@06                                             0330
         ST    @06,TOTAL                                           0330
*  SPACING = DOUBLE;             /*MAKE THE OUTPTU LOOK BETTER       */
         MVC   SPACING(1),DOUBLE                                   0331
*  CALL PRINTIT;                 /*WITH A GAP BETWEEN SECTIONS       */
         BAL   @14,PRINTIT                                         0332
*  SPACING = SINGLE;             /*RETURN THE SPAVING TO 1 SPACE     */
         MVC   SPACING(1),SINGLE                                   0333
*  GEN(MVI   TOTALS,X'00');      /*SET FIRST BYTE TO ZERO    @Z427VLS*/
         MVI   TOTALS,X'00'
*  GEN(MVC   TOTALS+1(63),TOTALS);/*RIPPLE THE 0 THROUGH THE ARRAY   */
         MVC   TOTALS+1(63),TOTALS
* END;                                                     /*@Z427VLS*/
         LA    @06,1                                               0336
         AL    @06,J                                               0336
         ST    @06,J                                               0336
         C     @06,@CF00085                                        0336
         BNH   @DL00291                                            0336
* MVCOVER = OVERTOT;     /*MOVE IN THE WORDS DESCRIBING THIS GRAND   */
         MVC   MVCOVER(16),OVERTOT                                 0337
* BINWORD = TOTOFTOT;    /*PICK UP OVER ALL TOTAL            @Z427VLS*/
         L     @06,TOTOFTOT                                        0338
         ST    @06,BINWORD                                         0338
* BNDECNUM = SIX;        /*SET UP TO DO SIX BYTES OF PRINTABLE       */
         L     @06,SIX                                             0339
         ST    @06,BNDECNUM                                        0339
* DECADDR = ADDR(TOTALVAL);/*ADDRESS OF WHERE TO PUT CONVERTED VALUE */
         LA    @06,TOTALVAL                                        0340
         ST    @06,DECADDR                                         0340
* CALL CONVBIN;          /*GO CONVERT THE DATA TO PRINTABLE  @Z427VLS*/
         BAL   @14,CONVBIN                                         0341
* BNDECNUM = FIVE;       /*RESET TO = LAST GROUP             @Z427VLS*/
         L     @06,FIVE                                            0342
         ST    @06,BNDECNUM                                        0342
* DECADDR = DECADDR + SEVEN;/*ADJUST DOWN THE PRINT LINE     @Z427VLS*/
         L     @06,DECADDR                                         0343
         AL    @06,SEVEN                                           0343
         ST    @06,DECADDR                                         0343
* DO K = 1 BY 1 TO EVNUM;                                  /*@Z427VLS*/
         LA    @06,1                                               0344
         ST    @06,K                                               0344
         B     @DE00344                                            0344
@DL00344 DS    0H                                                  0345
*  BINWORD = SUBTOT(K);  /*PICK UP THE NEXT OVER ALL TOTAL   @Z427VLS*/
         SLA   @06,2                                               0345
         L     @06,SUBTOT-4(@06)                                   0345
         ST    @06,BINWORD                                         0345
*  CALL CONVBIN;         /*GO AND CONVERT THE ITEM TO BINARY @Z427VLS*/
         BAL   @14,CONVBIN                                         0346
*  DECADDR = DECADDR + SIX ;/* MOVE DOWN THE LINE FOR THE NEXT TOTAL */
         L     @06,DECADDR                                         0347
         AL    @06,SIX                                             0347
         ST    @06,DECADDR                                         0347
* END;                                                     /*@Z427VLS*/
         LA    @06,1                                               0348
         AL    @06,K                                               0348
         ST    @06,K                                               0348
@DE00344 L     @05,EVPTR(,R2)                                      0348
         CH    @06,EVNUM(,@05)                                     0348
         BNH   @DL00344                                            0348
* CALL PRINTIT;          /*AT LAST THE LAST TOTAL LINE       @Z427VLS*/
         BAL   @14,PRINTIT                                         0349
* GENERATE DATA;                                           /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00005 DS    0H                                                  0351
@EF00005 DS    0H                                                  0351
@ER00005 LM    @14,@12,@SA00005                                    0351
         BR    @14                                                 0351
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL BUILD THE MAIN HEADING FOR THE OUTPUT  @Z427VLS*/
*/*                                                          @Z427VLS*/
*MAINHEAD: PROC;                                           /*@Z427VLS*/
MAINHEAD STM   @14,@12,@SA00006                                    0352
*  SPACING = UPSPACE;         /*TIME FOR A NEW PAGE          @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0353
*  CALL PRINTIT;              /*SKIP TO CHANNEL ONE          @Z427VLS*/
         BAL   @14,PRINTIT                                         0354
*  SPACING = SINGLE;          /*RETURN TO PRINT AND SKIP ONE LINE    */
         MVC   SPACING(1),SINGLE                                   0355
*  HEAD01 = LINE01;           /*MOVE IN THE MAIN HEADING EVENT H--   */
         MVC   HEAD01(13),LINE01                                   0356
*  DAYSDATE = DATENOW;        /*PARM PROCESSOR SHOULD HAVE FILLED THS*/
         MVC   DAYSDATE(6),DATENOW(R2)                             0357
*  TODAYDT = REPORTDY;        /*MOVE WORDS 'REPORT DATE TO PRINT LINE*/
         MVC   TODAYDT(12),REPORTDY                                0358
*  CALL PRINTIT;              /*GO PRINT THE FIRST LINE      @Z427VLS*/
         BAL   @14,PRINTIT                                         0359
*  NUMBER = ONE;              /*SET FOR ONE BYTE TO BE CONVERTED     */
         L     @06,ONE                                             0360
         ST    @06,NUMBER                                          0360
*  NEXTBY = ADDR(EVSYEAR);    /*SET UP THE ADDRESS OF THE DATE       */
         LA    @06,EVSYEAR(,R2)                                    0361
         ST    @06,NEXTBY                                          0361
*  ADDNXT = ADDR(DATEYR);     /*SET UP WHERE TO PUT THE CONVERTED DAY*/
         LA    @06,DATEYR                                          0362
         ST    @06,ADDNXT                                          0362
*  CALL CONVERT;              /*GO CONVERT THE DATE          @Z427VLS*/
         BAL   @14,CONVERT                                         0363
*  NUMBER = TWO;              /*SET UP TO CONVERT TWO BYTES OF DATA  */
         L     @06,TWO                                             0364
         ST    @06,NUMBER                                          0364
*  SWITCH1 = ON;              /*SET TO DROP THE 1/2 BYTE     @Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0365
*  SRL(EVSDAY,FOUR);          /*CHUCK THE F IN LAST 1/2 BYTE @Z427VLS*/
         LH    @06,EVSDAY(,R2)                                     0366
         N     @06,@CF01587                                        0366
         SRL   @06,4                                               0366
         STH   @06,EVSDAY(,R2)                                     0366
*  NEXTBY = ADDR(EVSDAY);     /*SET UP WHERE TO GET THE DAY  @Z427VLS*/
         LA    @06,EVSDAY(,R2)                                     0367
         ST    @06,NEXTBY                                          0367
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */
         LA    @06,DATEDAY                                         0368
         BCTR  @06,0                                               0368
         ST    @06,ADDNXT                                          0368
*  CALL CONVERT;              /*GO CONVERT THE DAY TO PRINTABLE      */
         BAL   @14,CONVERT                                         0369
*  HEDDATE = HEADDATE;        /*MOVE IN THE DATA TO THE PRINT LINE   */
         MVC   HEDDATE(18),HEADDATE                                0370
*  CALL PRINTIT;              /*GO PRINT THE FROM DAY YEAR   @Z427VLS*/
         BAL   @14,PRINTIT                                         0371
*  FROMTO = TO;               /*CHANGE THE WORD (FROM) TO (TO)       */
         MVC   FROMTO(5),TO                                        0372
*  SWITCH1 = ON;              /*SET SO ONE HALF OF A BYTE IS DROPPED */
         OI    SWITCH1,B'10000000'                                 0373
*  NEXTBY = ADDR(EVDAY);      /*ADDRESS OF DATA              @Z427VLS*/
         L     @06,EVPTR(,R2)                                      0374
         LA    @05,EVDAY(,@06)                                     0374
         ST    @05,NEXTBY                                          0374
*  ADDNXT = ADDR(DATEDAY)-1;  /*SET WHERE TO PUT CONVERTED DAY       */
         LA    @05,DATEDAY                                         0375
         BCTR  @05,0                                               0375
         ST    @05,ADDNXT                                          0375
*  SRL(EVDAY,FOUR);           /*MOVE THE F OUT OF THE DAY FIELD      */
         SLR   @05,@05                                             0376
         ICM   @05,3,EVDAY(@06)                                    0376
         SRL   @05,4                                               0376
         STCM  @05,3,EVDAY(@06)                                    0376
*  CALL CONVERT;              /*CHANGE THE LAST DAY TO PRINTABLE     */
         BAL   @14,CONVERT                                         0377
*  NUMBER =  ONE;             /*SET UP TO DO JUST ONE BYTE   @Z427VLS*/
         L     @06,ONE                                             0378
         ST    @06,NUMBER                                          0378
*  NEXTBY = ADDR(EVYEAR);     /*SET UP THE ADDRESS OF THE LAST YEAR  */
         L     @06,EVPTR(,R2)                                      0379
         ST    @06,NEXTBY                                          0379
*  ADDNXT = ADDR(DATEYR);     /*SET UP ADDRESS WHERE TO PUT THE YEAR */
         LA    @06,DATEYR                                          0380
         ST    @06,ADDNXT                                          0380
*  CALL CONVERT;              /*CONVERT THE LAST RECORD DATE TO PRINT*/
         BAL   @14,CONVERT                                         0381
*  HEDDATE = HEADDATE;        /*MOVE THE DATA TO THE PRINT LINE      */
         MVC   HEDDATE(18),HEADDATE                                0382
*  CALL PRINTIT;              /*GO PRINT THE TO DATE INFORMATION     */
         BAL   @14,PRINTIT                                         0383
*END;                                                      /*@Z427VLS*/
@EL00006 DS    0H                                                  0384
@EF00006 DS    0H                                                  0384
@ER00006 LM    @14,@12,@SA00006                                    0384
         BR    @14                                                 0384
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL PRINT THE NEW DATE WHEN CALLED,FROM THE RECORD */
*/*                                                          @Z427VLS*/
*NEWDATE: PROC;                                            /*@Z427VLS*/
NEWDATE  STM   @14,@12,@SA00007                                    0385
*  IF DEBUG24 ^= ON THEN      /*IF SO DO NOT WANT SPACE      @Z427VLS*/
         TM    DEBUG24(R2),B'10000000'                             0386
         BO    @RF00386                                            0386
*   CALL PRINTIT;             /*UPSPACE ONE LINE FOR LOOKS   @Z427VLS*/
         BAL   @14,PRINTIT                                         0387
*  LASTDATE = LRTDATE;        /*CHANGE THE BREAKPOINT TO THE NEW DATE*/
@RF00386 MVC   LASTDATE(4),LRTDATE(R7)                             0388
*  NUMBER = ONE;              /*SET UP TO CONVERT 1 BYTE OF HEX      */
         L     @06,ONE                                             0389
         ST    @06,NUMBER                                          0389
*  NEXTBY = ADDR(LRTYEAR);    /*SET UP ADDRESS OF WHERE TO PUT IT    */
         LA    @06,LRTYEAR(,R7)                                    0390
         ST    @06,NEXTBY                                          0390
*  ADDNXT = ADDR(YEARJUL);    /*SET UP ADDRESS OF THE YEAR IN RECORD */
         LA    @06,YEARJUL                                         0391
         ST    @06,ADDNXT                                          0391
*  CALL CONVERT;              /*GO FORMATE THE YEAR FOR PRINTING     */
         BAL   @14,CONVERT                                         0392
*  NUMBER= TWO;               /*SET UP TO CONVERT THE JULIAN DATE    */
         L     @06,TWO                                             0393
         ST    @06,NUMBER                                          0393
*  SWITCH1 = ON;                                           /*@Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0394
*  TABLECHH = LRTDAY;         /*MOVE SO WE CAN SHIFT OUT THE 'F'X */
         MVC   TABLECHH(2),LRTDAY(R7)                              0395
*  SRL(TABLECHH,FOUR);        /*SHIFT OUT THE F IN THE DATE  @0001VLS*/
         SLR   @06,@06                                             0396
         ICM   @06,3,TABLECHH                                      0396
         SRL   @06,4                                               0396
         STCM  @06,3,TABLECHH                                      0396
*  NEXTBY = ADDR(TABLECHH);   /*SET UP WHERE THE INFO TO CONVERT IS*/
         LA    @06,TABLECHH                                        0397
         ST    @06,NEXTBY                                          0397
*  ADDNXT = ADDR(DAYJUL);     /*SET UP ADDRESS OF WHERE TO PUT DATA  */
         LA    @06,DAYJUL                                          0398
         ST    @06,ADDNXT                                          0398
*  CALL CONVERT;              /*CONVERT THE DATA TO PRINTABLE        */
         BAL   @14,CONVERT                                         0399
*  NEWDATEO = NEWDATEH;       /*MOVE THE LINE TO THE PRINT BUFFER    */
         MVC   NEWDATEO(12),NEWDATEH                               0400
*  IF DEBUG24 ^= ON THEN      /*IF TRUE ONLY ONE LINE OUT    @Z427VLS*/
         TM    DEBUG24(R2),B'10000000'                             0401
         BO    @RF00401                                            0401
*  DO;                                                     /*@Z427VLS*/
*  GEN(MVI  TIME1+13,X'40');                               /*@Z427VLS*/
         MVI  TIME1+13,X'40'
*  GEN(MVC  TIME1+14(120),TIME1+13);                       /*@Z427VLS*/
         MVC  TIME1+14(120),TIME1+13
*   SPACING = DOUBLE ;        /*SET SPACING TO DOUBLE FOR THIS LINE  */
         MVC   SPACING(1),DOUBLE                                   0405
*  END;                                                    /*@Z427VLS*/
*  MYLINECT = MYLINECT + ONE; /*ADJUST FOR THE DOUBLE SPACING        */
@RF00401 LH    @06,MYLINECT                                        0407
         AL    @06,ONE                                             0407
         STH   @06,MYLINECT                                        0407
*  CALL PRINTIT;              /*GO PRINT THE NEW DAY YEAR    @Z427VLS*/
         BAL   @14,PRINTIT                                         0408
*  SPACING = SINGLE;          /*RETURN THE SPACING TO NORMAL(ONE)    */
         MVC   SPACING(1),SINGLE                                   0409
*END;                                                      /*@Z427VLS*/
@EL00007 DS    0H                                                  0410
@EF00007 DS    0H                                                  0410
@ER00007 LM    @14,@12,@SA00007                                    0410
         BR    @14                                                 0410
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL SETUP LINKAGE TO ACCESS I/O SERVICE PRINT      */
*/*                                                          @Z427VLS*/
*PRINTIT: PROC;                                            /*@Z427VLS*/
PRINTIT  STM   @14,@12,@SA00008                                    0411
*  PRINTADR = ADDR(PRTLINE);                               /*@Z427VLS*/
         LA    @06,PRTLINE                                         0412
         ST    @06,PRINTADR(,R2)                                   0412
*  CALL IOHND(RITEPRTR);      /*PASS CONTROL TO I/O HANDLER  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0413
         LA    @01,@AL00413                                        0413
         BALR  @14,@15                                             0413
*  IF SPACING = SINGLE        /*SINGLE SPACING REQUESTED     @Z427VLS*/
*   THEN                                                           0414
         CLC   SPACING(1),SINGLE                                   0414
         BNE   @RF00414                                            0414
*    MYLINECT = MYLINECT + ONE;                            /*@Z427VLS*/
         LH    @06,MYLINECT                                        0415
         AL    @06,ONE                                             0415
         STH   @06,MYLINECT                                        0415
*   ELSE                                                           0416
*    IF SPACING = DOUBLE      /*DOUBLE SPACING REQUESTED     @Z427VLS*/
*     THEN                                                         0416
         B     @RC00414                                            0416
@RF00414 CLC   SPACING(1),DOUBLE                                   0416
         BNE   @RF00416                                            0416
*      MYLINECT = MYLINECT + TWO;                          /*@Z427VLS*/
         LH    @06,MYLINECT                                        0417
         AL    @06,TWO                                             0417
         STH   @06,MYLINECT                                        0417
*     ELSE                                                         0418
*      IF SPACING = TRIPLE    /*RIGHT U GUESSED TRIPLE SPACING REQUES*/
*       THEN                                                       0418
         B     @RC00416                                            0418
@RF00416 CLC   SPACING(1),TRIPLE                                   0418
         BNE   @RF00418                                            0418
*        MYLINECT = MYLINECT + THREE;/*ELSE IT'S AN UPSPACE  @Z427VLS*/
         LH    @06,MYLINECT                                        0419
         LA    @06,3(,@06)                                         0419
         STH   @06,MYLINECT                                        0419
*       ELSE                                                       0420
*        IF SPACING = UPSPACE     /*IF TRUE LINECT MUST BE RESET     */
*           THEN                                                   0420
         B     @RC00418                                            0420
@RF00418 CLC   SPACING(1),UPSPACE                                  0420
         BNE   @RF00420                                            0420
*             MYLINECT = ZERO;                             /*@Z427VLS*/
         SLR   @06,@06                                             0421
         STH   @06,MYLINECT                                        0421
* IF SWITCH5 = ON & MYLINECT=> LINECT THEN/*HEADING FOR SUMMARY*/  0422
@RF00420 DS    0H                                                  0422
@RC00418 DS    0H                                                  0422
@RC00416 DS    0H                                                  0422
@RC00414 TM    SWITCH5,B'00001000'                                 0422
         BNO   @RF00422                                            0422
         LH    @06,MYLINECT                                        0422
         CH    @06,LINECT(,R2)                                     0422
         BL    @RF00422                                            0422
*  DO;                                                     /*@Z427VLS*/
*   KEEPSP = SPACING;                                      /*@Z427VLS*/
         MVC   KEEPSP(1),SPACING                                   0424
*   SPACING = UPSPACE;                                     /*@Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0425
*   PRINTADR = ADDR(PRTLINE);                              /*@Z427VLS*/
         LA    @06,PRTLINE                                         0426
         ST    @06,PRINTADR(,R2)                                   0426
*   CALL IOHND(RITEPRTR);                                  /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0427
         LA    @01,@AL00427                                        0427
         BALR  @14,@15                                             0427
*MYLINECT = THREE;                                         /*@0001VLS*/
         MVC   MYLINECT(2),@CH00075                                0428
*RESPECIFY (R6) RESTRICTED;                                /*@0001VLS*/
*  SPACING = SINGLE;                                       /*@0001VLS*/
         MVC   SPACING(1),SINGLE                                   0430
*  TOTALHD2 = TOTALHD1;     /*MOVE IN THE FIRST PART OF THE HEADING  */
         MVC   TOTALHD2(12),TOTALHD1                               0431
* R6 = ADDR(TOTALHD3);    /*WHERE THE HEADING IS AT          @0001VLS*/
         LA    R6,TOTALHD3                                         0432
* R8 = ADDR(TIME1) + 26;  /*WHERE TO MOVE THE LINE TO        @0001VLS*/
         LA    R8,TIME1                                            0433
         AL    R8,@CF01168                                         0433
* R9 = 7 + SIX * EVNUM;   /*HOW MANY BYTES TO MOVE INTO THE HEADING*/
         L     @05,EVPTR(,R2)                                      0434
         L     R9,SIX                                              0434
         MH    R9,EVNUM(,@05)                                      0434
         AL    R9,@CF00082                                         0434
* GEN(EX  R9,MOVECHAR);   /*MOVE THE CHARACTERS INTO THE PRINT BUFF*/
         EX  R9,MOVECHAR
*RESPECIFY (R6) UNRESTRICTED;                              /*@0001VLS*/
*PRINTADR = ADDR(PRTLINE);    /*TELL I/O WHERE THE BUFFER IS AT*/  0437
         LA    @06,PRTLINE                                         0437
         ST    @06,PRINTADR(,R2)                                   0437
*CALL IOHND(RITEPRTR);        /*GO WRITE THE HEADING TO THE BUFFER*/
         L     @15,ADIOHND(,R2)                                    0438
         LA    @01,@AL00438                                        0438
         BALR  @14,@15                                             0438
*   SPACING = KEEPSP;                                      /*@Z427VLS*/
         MVC   SPACING(1),KEEPSP                                   0439
*  END;                                                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00008 DS    0H                                                  0441
@EF00008 DS    0H                                                  0441
@ER00008 LM    @14,@12,@SA00008                                    0441
         BR    @14                                                 0441
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * * * * */
*/*    THIS PROC WILL CONVERT THE TIME IN THE RECORD TO PRINTABLE    */
*/*                                                          @Z427VLS*/
*TIME:  PROC;                                              /*@Z427VLS*/
TIME     STM   @14,@12,@SA00009                                    0442
*  NEXTBY  =  ADDR(LRTTIME);     /*SET POINTER TO POINT TO TIME FIELD*/
         LA    @06,LRTTIME(,R7)                                    0443
         ST    @06,NEXTBY                                          0443
*  NUMBER = ONE;                 /*CONVERT 1 TO ALLOW FOR SPACES     */
         L     @06,ONE                                             0444
         ST    @06,NUMBER                                          0444
*  ADDNXT = ADDR(TIME1);         /*SET POINTER TO START OF OUTPUT    */
         LA    @06,TIME1                                           0445
         ST    @06,ADDNXT                                          0445
*  DO R = 4 BY -1 TO 1;          /*CONV HR'S MINS SECONDS    @Z427VLS*/
         LA    @06,4                                               0446
         ST    @06,R                                               0446
@DL00446 DS    0H                                                  0447
*    CALL CONVERT;               /*CONVERT THE BYTE OF DATA  @Z427VLS*/
         BAL   @14,CONVERT                                         0447
*    NEXTBY = NEXTBY + ONE;      /*MOVE TO THE NEXT FIELD    @Z427VLS*/
         L     @06,NEXTBY                                          0448
         AL    @06,ONE                                             0448
         ST    @06,NEXTBY                                          0448
*    ADDNXT = ADDNXT + THREE;    /*ALLOW FOR BLANK BETWEEN EACH FIELD*/
         LA    @06,3                                               0449
         AL    @06,ADDNXT                                          0449
         ST    @06,ADDNXT                                          0449
*  END;                                                    /*@Z427VLS*/
         SLR   @06,@06                                             0450
         BCTR  @06,0                                               0450
         AL    @06,R                                               0450
         ST    @06,R                                               0450
         LTR   @06,@06                                             0450
         BP    @DL00446                                            0450
*END;                                                      /*@Z427VLS*/
@EL00009 DS    0H                                                  0451
@EF00009 DS    0H                                                  0451
@ER00009 LM    @14,@12,@SA00009                                    0451
         BR    @14                                                 0451
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL MOVE THE DATA FOR EACH TYPE OF RECORD INTO    */
* /*    THE PRINT LINE                                       @Z427VLS*/
*MOVEDATA:  PROC;                                          /*@Z427VLS*/
MOVEDATA STM   @14,@12,@SA00010                                    0452
*/*EREPCASE (CURRENT) VALUES(1,2,3,4,5,6,7,8,9,10,11)*/            0453
* DCL  I0001   FIXED(15);                                          0453
* I0001 = 0;                                                       0454
         SLR   I0001,I0001                                         0454
* IF CURRENT = 1 THEN                                              0455
         CLC   CURRENT(4),@CF00055                                 0455
         BNE   @RF00455                                            0455
*      I0001 = 4 ;                                                 0456
         LA    I0001,4                                             0456
* IF CURRENT = 2 THEN                                              0457
@RF00455 CLC   CURRENT(4),@CF00073                                 0457
         BNE   @RF00457                                            0457
*      I0001 = 8 ;                                                 0458
         LA    I0001,8                                             0458
* IF CURRENT = 3 THEN                                              0459
@RF00457 CLC   CURRENT(4),@CF00075                                 0459
         BNE   @RF00459                                            0459
*      I0001 = 12 ;                                                0460
         LA    I0001,12                                            0460
* IF CURRENT = 4 THEN                                              0461
@RF00459 CLC   CURRENT(4),@CF00035                                 0461
         BNE   @RF00461                                            0461
*      I0001 = 16 ;                                                0462
         LA    I0001,16                                            0462
* IF CURRENT = 5 THEN                                              0463
@RF00461 CLC   CURRENT(4),@CF00078                                 0463
         BNE   @RF00463                                            0463
*      I0001 = 20 ;                                                0464
         LA    I0001,20                                            0464
* IF CURRENT = 6 THEN                                              0465
@RF00463 CLC   CURRENT(4),@CF00080                                 0465
         BNE   @RF00465                                            0465
*      I0001 = 24 ;                                                0466
         LA    I0001,24                                            0466
* IF CURRENT = 7 THEN                                              0467
@RF00465 CLC   CURRENT(4),@CF00082                                 0467
         BNE   @RF00467                                            0467
*      I0001 = 28 ;                                                0468
         LA    I0001,28                                            0468
* IF CURRENT = 8 THEN                                              0469
@RF00467 CLC   CURRENT(4),@CF00065                                 0469
         BNE   @RF00469                                            0469
*      I0001 = 32 ;                                                0470
         LA    I0001,32                                            0470
* IF CURRENT = 9 THEN                                              0471
@RF00469 CLC   CURRENT(4),@CF00085                                 0471
         BNE   @RF00471                                            0471
*      I0001 = 36 ;                                                0472
         LA    I0001,36                                            0472
* IF CURRENT = 10 THEN                                             0473
@RF00471 CLC   CURRENT(4),@CF00032                                 0473
         BNE   @RF00473                                            0473
*      I0001 = 40 ;                                                0474
         LA    I0001,40                                            0474
* IF CURRENT = 11 THEN                                             0475
@RF00473 CLC   CURRENT(4),@CF00033                                 0475
         BNE   @RF00475                                            0475
*      I0001 = 44 ;                                                0476
         LA    I0001,44                                            0476
* GENERATE;                                                        0477
@RF00475 DS    0H                                                  0477
    B    L00010(I0001)
L00010 B    L000112
    B    L00011
    B    L00012
    B    L00013
    B    L00014
    B    L00015
    B    L00016
    B    L00017
    B    L00018
    B    L00019
    B    L000110
    B    L000111
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MCH TYPE RECORDS           @Z427VLS*/
*                                                                  0478
*/*EREPSUB  */                                                     0478
*L00011:                                                           0478
*     DO;                                               /*@Z427VLS*/
L00011   DS    0H                                                  0479
*    CALL TIME;                     /*MOVE THE TIME INTO THE PRINT L */
         BAL   @14,TIME                                            0479
*    JOBNAME1 = MCHJOBID;           /*MOVE THE JOB NAME INTO PRINT L */
         MVC   JOBNAME1(8),MCHJOBID(R7)                            0480
*    CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER      @0001VLS*/
         L     @06,PTR                                             0481
         LR    @05,@06                                             0481
         MH    @05,@CH00080                                        0481
         L     @03,EVPTR(,R2)                                      0481
         ALR   @03,@05                                             0481
         MVC   CPU12(1),EVLETTER-6(@03)                            0481
*    IF MCHSYSTR = ON               /*DID IT TERMINATE THE SYSTEM    */
*      THEN                         /*YES BIT IS ON          @Z427VLS*/
         TM    MCHSYSTR(R7),B'10000000'                            0482
         BNO   @RF00482                                            0482
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = MCHTRM;          /*SET TYPE = TO  MCH-TRM @Z427VLS*/
         MVC   RECTYP1(7),MCHTRM                                   0484
*        MCHTRMCT(PTR) = MCHTRMCT(PTR) + ONE;              /*@Z427VLS*/
         SLA   @06,2                                               0485
         L     @05,MCHTRMCT-4(@06)                                 0485
         AL    @05,ONE                                             0485
         ST    @05,MCHTRMCT-4(@06)                                 0485
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0487
*       DO;                                                /*@Z427VLS*/
         B     @RC00482                                            0487
@RF00482 DS    0H                                                  0488
*        RECTYP1 = MCH;             /*SET TO PLAIN   MCH     @Z427VLS*/
         MVC   RECTYP1(7),MCH                                      0488
*        MCHCT(PTR) = MCHCT(PTR) + ONE;                    /*@Z427VLS*/
         L     @06,PTR                                             0489
         SLA   @06,2                                               0489
         L     @05,MCHCT-4(@06)                                    0489
         AL    @05,ONE                                             0489
         ST    @05,MCHCT-4(@06)                                    0489
*       END;                                               /*@Z427VLS*/
*    NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT   */
@RC00482 L     @06,ONE                                             0491
         ST    @06,NUMBER                                          0491
*    ADDNXT = ADDR(PSWMCH) ;        /*SET UP BASE FOR OUTPUT ADDRESS */
         LA    @06,PSWMCH                                          0492
         ST    @06,ADDNXT                                          0492
*    NEXTBY = ADDR(MCHMOD);         /*SET BASE TO POINT TO MCH MODLE */
         LA    @06,MCHMOD(,R7)                                     0493
         ST    @06,NEXTBY                                          0493
*    CALL CONVERT;                  /*GO CONVERT THE MODLE TO PRINT  */
         BAL   @14,CONVERT                                         0494
*    NUMBER = EIGHT;                /*SET UP # OF BYTES TO CONVERT   */
         MVC   NUMBER(4),@CF00065                                  0495
*    ADDNXT  = ADDR(PSWMCH);        /*SET BASE TO POINT TO START ADD */
         LA    @06,PSWMCH                                          0496
         ST    @06,ADDNXT                                          0496
*    NEXTBY = ADDR(MCHOPSW);        /*SET BASE POINTER TO DATA ADDRES*/
         LA    @06,MCHOPSW(,R7)                                    0497
         ST    @06,NEXTBY                                          0497
*    CALL CONVERT;                  /*CALL PROGRAM TO CONVERT DATA   */
         BAL   @14,CONVERT                                         0498
*IF  LRTKEY1 = '13'X &                                             0499
*    (LRTERRID & '10'X) = '10'X THEN                               0499
         CLI   LRTKEY1(R7),X'13'                                   0499
         BNE   @RF00499                                            0499
         MVC   @TS00001(1),LRTERRID(R7)                            0499
         NI    @TS00001,X'10'                                      0499
         CLI   @TS00001,X'10'                                      0499
         BNE   @RF00499                                            0499
* DO;                                                      /*@0098VLS*/
* NUMBER = 10;   /*ERRORID1 HAS 10 BYTES                     @0098VLS*/
         LA    @06,10                                              0501
         ST    @06,NUMBER                                          0501
* ADDNXT = ADDR(ERRORID1); /*ADDRESS IN THE OUTPUT LINE TO PLACE IT*/
         LA    @05,ERRORID1                                        0502
         ST    @05,ADDNXT                                          0502
* NEXTBY = ADDR(RERR);/*ADDRESS OF ERRORID1(R7 + RECLNGTH  - 10*/  0503
         LR    @05,R7                                              0503
         AH    @05,RECLNGTH(,R2)                                   0503
         SLR   @05,@06                                             0503
         ST    @05,NEXTBY                                          0503
* CALL CONVERT; /*GO CONVERT THE ITEM TO PRINTABLE           @0098VLS*/
         BAL   @14,CONVERT                                         0504
* END;                                                     /*@0098VLS*/
* ELSE                                                             0506
* ERRORNA = NOTAPPLY; /*PUT IN THE WORDS NOT AVAIBLE         @0098VLS*/
*                                                                  0506
         B     @RC00499                                            0506
@RF00499 MVC   ERRORNA(8),NOTAPPLY                                 0506
*/*EREPSEND  */                                                    0507
*       GO TO L000113;                                             0507
         B     L000113                                             0507
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL CCH TYPE RECORDS           @Z427VLS*/
*                                                                  0509
*/*EREPSUB  */                                                     0509
*L00012:                                                           0509
*     DO;                                               /*@Z427VLS*/
L00012   DS    0H                                                  0510
*      CALL TIME;                    /*GO CONVERT THIS RECORDS TIME  */
         BAL   @14,TIME                                            0510
*     DO;                                                  /*@G64XXJS*/
*/* ANY ONLINE PROCESSORS                                    @G64XXJS*/
*      IF CCHMOD > '0168'X & CCHMOD ^= '3062'X & CCHNOCS ^= ZERO   0512
*         THEN                                                     0512
         CLC   CCHMOD(2,R7),@CB01420                               0512
         BNH   @RF00512                                            0512
         CLC   CCHMOD(2,R7),@CB01421                               0512
         BE    @RF00512                                            0512
         LA    @06,CCHLOG(,R7)                                     0512
         SLR   @05,@05                                             0512
         ICM   @05,3,CCHLOGLN(R7)                                  0512
         ALR   @06,@05                                             0512
         LH    @06,CCHNOCS(,@06)                                   0512
         LTR   @06,@06                                             0512
         BZ    @RF00512                                            0512
*          DO;                                             /*@G64XXJS*/
*/* MOVE CSID INTO PRINTLINE                                 @G64XXJS*/
*/* SET UP NUMBER OF BYTES TO CONVERT                        @G64XXJS*/
*/* SET UP CHANNEL SET ID TO PRINT                           @G64XXJS*/
*           SENSEA3(1:5) = CSID;                           /*@G64XXJS*/
         MVC   SENSEA3(5),@CC01355                                 0514
*           NUMBER = 1;                                    /*@G64XXJS*/
         LA    @06,1                                               0515
         ST    @06,NUMBER                                          0515
*           ADDNXT = ADDR(SENSEA3) + FIVE;                 /*@G64XXJS*/
         LA    @05,SENSEA3                                         0516
         AL    @05,FIVE                                            0516
         ST    @05,ADDNXT                                          0516
*           DO J = 1 BY 1 TO CCHNOCS WHILE(J <= 16);       /*@G64XXJS*/
         ST    @06,J                                               0517
         B     @DE00517                                            0517
@DL00517 C     @06,@CF00088                                        0517
         BH    @DC00517                                            0517
*/* FOR EACH ONLINE PROCESSOR, GET ADDRESS OF CHANNEL        @G64XXJS*/
*/* SET ID. CONVERT CHANNEL SET ID TO PRINTABLE. PLACE       @G64XXJS*/
*/* IN TRAILING COMMA. STEP TO NEXT CHANNEL SET ID           @G64XXJS*/
*/* PRINT POSITION. BLANK OUT LAST COMMA.                    @G64XXJS*/
*            NEXTBY = ADDR(CCHCSAD(J)) + ONE;              /*@G64XXJS*/
         SLA   @06,2                                               0518
         LA    @05,CCHLOG(,R7)                                     0518
         SLR   @03,@03                                             0518
         ICM   @03,3,CCHLOGLN(R7)                                  0518
         ALR   @05,@03                                             0518
         LA    @06,CCHCSAD-4(@06,@05)                              0518
         AL    @06,ONE                                             0518
         ST    @06,NEXTBY                                          0518
*            CALL CONVERT;                                 /*@G64XXJS*/
         BAL   @14,CONVERT                                         0519
*            ADDNUM(3) = COMMA;                            /*@G64XXJS*/
         L     @06,ADDNXT                                          0520
         MVI   ADDNUM+2(@06),C','                                  0520
*            ADDNXT = ADDNXT + 3;                          /*@G64XXJS*/
         AL    @06,@CF00075                                        0521
         ST    @06,ADDNXT                                          0521
*           END;                                           /*@G64XXJS*/
         LA    @06,1                                               0522
         AL    @06,J                                               0522
         ST    @06,J                                               0522
@DE00517 LA    @05,CCHLOG(,R7)                                     0522
         SLR   @03,@03                                             0522
         ICM   @03,3,CCHLOGLN(R7)                                  0522
         ALR   @05,@03                                             0522
         CH    @06,CCHNOCS(,@05)                                   0522
         BNH   @DL00517                                            0522
@DC00517 DS    0H                                                  0523
*           ADDNXT = ADDNXT - 1;                           /*@G64XXJS*/
         L     @06,ADDNXT                                          0523
         BCTR  @06,0                                               0523
         ST    @06,ADDNXT                                          0523
*           ADDNUM(1) = BLANK;                             /*@G64XXJS*/
         MVC   ADDNUM(1,@06),BLANK                                 0524
*          END;                                            /*@G64XXJS*/
*     END;                                                 /*@G64XXJS*/
@RF00512 DS    0H                                                  0527
*      JOBNAME1 = CCHJOBID;          /*MOVE THE JOB NAME INTO PRINT  */
         MVC   JOBNAME1(8),CCHJOBID(R7)                            0527
*      IF CCHRINC = ON                                             0528
*         THEN                                                     0528
         TM    CCHRINC(R7),B'10000000'                             0528
         BNO   @RF00528                                            0528
*          DO;                                             /*@Z427VLS*/
*           RECTYP1 = CCHINC;        /*MAKE PRINT READ CCH-INC       */
         MVC   RECTYP1(7),CCHINC                                   0530
*           CCHINCCT(PTR) = CCHINCCT(PTR) + ONE;           /*@Z427VLS*/
         L     @06,PTR                                             0531
         SLA   @06,2                                               0531
         L     @05,CCHINCCT-4(@06)                                 0531
         AL    @05,ONE                                             0531
         ST    @05,CCHINCCT-4(@06)                                 0531
*          END;                                            /*@Z427VLS*/
*         ELSE                                                     0533
*          DO;                                             /*@Z427VLS*/
         B     @RC00528                                            0533
@RF00528 DS    0H                                                  0534
*            IF CCHRCRH = ON         /*IS IT A CCH-CRH TYPE RECORD   */
*               THEN                                               0534
         TM    CCHRCRH(R7),B'00001000'                             0534
         BNO   @RF00534                                            0534
*                DO;                                       /*@Z427VLS*/
*                  RECTYP1 = CCHCRH; /*MAKE PRINT READ CCH-CHR       */
         MVC   RECTYP1(7),CCHCRH                                   0536
*                  CCHCRHCT(PTR) = CCHCRHCT(PTR) + ONE;    /*@Z427VLS*/
         L     @06,PTR                                             0537
         SLA   @06,2                                               0537
         L     @05,CCHCRHCT-4(@06)                                 0537
         AL    @05,ONE                                             0537
         ST    @05,CCHCRHCT-4(@06)                                 0537
*                END;                                      /*@Z427VLS*/
*               ELSE                                               0539
*                DO;                                       /*@Z427VLS*/
         B     @RC00534                                            0539
@RF00534 DS    0H                                                  0540
*                  RECTYP1 = CCH;    /*MAKE IT PLAIN CCH     @Z427VLS*/
         MVC   RECTYP1(7),CCH                                      0540
*                  CCHCT(PTR) = CCHCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0541
         SLA   @06,2                                               0541
         L     @05,CCHCT-4(@06)                                    0541
         AL    @05,ONE                                             0541
         ST    @05,CCHCT-4(@06)                                    0541
*                END;                                      /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
@RC00534 DS    0H                                                  0544
*      NUMBER = TWO;                  /*SET TO CONVERT 2 BYTES       */
@RC00528 L     @06,TWO                                             0544
         ST    @06,NUMBER                                          0544
*      CPU12 = EVLETTER(PTR);         /*INSERT THE CPU LETTER SET BY */
         L     @06,PTR                                             0545
         MH    @06,@CH00080                                        0545
         L     @05,EVPTR(,R2)                                      0545
         ALR   @05,@06                                             0545
         MVC   CPU12(1),EVLETTER-6(@05)                            0545
*                                     /*IFCFILT4 FOR THIS SERIAL MOD */
*      ADDNXT = ADDR(CUA11);          /*SET UP THE CUA TO PRINT      */
         LA    @06,CUA11                                           0546
         ST    @06,ADDNXT                                          0546
*      NEXTBY = ADDR(CCHCUA);         /*ADDRESS OF WHERE CUA IS      */
         LA    @06,CCHCUA(,R7)                                     0547
         ST    @06,NEXTBY                                          0547
*      SWITCH1 = ON;                  /*SET NOT TO USE FIRST 1/2 BYTE*/
         OI    SWITCH1,B'10000000'                                 0548
*      CALL CONVERT;                  /*GO CONVERT CUA TO PRINTABLE  */
         BAL   @14,CONVERT                                         0549
*      DEVCOMP = CCHCODE2;            /*PUT DEVICE IN COMMON AREA    */
         MVC   DEVCOMP(2),CCHCODE2(R7)                             0550
*      CALL DODEVICE;                 /*CALL PROC TO BUILD DEVICE NME*/
         BAL   @14,DODEVICE                                        0551
*     NUMBER = EIGHT;      /*SET UP FOR THE CSW              @ZA19014*/
         MVC   NUMBER(4),@CF00065                                  0552
*     ADDNXT = ADDR(CSW1); /*WHERE TO PLACE THE CONVER CSW   @ZA19014*/
         LA    @06,CSW1                                            0553
         ST    @06,ADDNXT                                          0553
*     NEXTBY = ADDR(CCHCSW);/*WHERE TO GET THE CSW TO CONVE  @ZA19014*/
         LA    @06,CCHCSW(,R7)                                     0554
         ST    @06,NEXTBY                                          0554
*     CALL CONVERT;       /*GO CONVERT THE CSW TO PRINTABLE  @ZA19014*/
*                                                                  0555
         BAL   @14,CONVERT                                         0555
*/*EREPSEND  */                                                    0556
*       GO TO L000113;                                             0556
         B     L000113                                             0556
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL OBR TYPE RECORDS           @Z427VLS*/
* /*                                                         @Z427VLS*/
*                                                                  0558
*/*EREPSUB  */                                                     0558
*L00013:                                                           0558
*     DO;                                               /*@Z427VLS*/
L00013   DS    0H                                                  0559
*   CALL TIME;                        /*GO CONVERT THIS RECORDS TIME */
         BAL   @14,TIME                                            0559
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0560
*   NUMBER = TWO;                     /*SET # OF BYTES TO CONVERT    */
         L     @06,TWO                                             0561
         ST    @06,NUMBER                                          0561
*   CPU12 = EVLETTER(PTR) ;           /*INSERT THE CPU LETTER        */
         L     @06,PTR                                             0562
         MH    @06,@CH00080                                        0562
         L     @05,EVPTR(,R2)                                      0562
         ALR   @05,@06                                             0562
         MVC   CPU12(1),EVLETTER-6(@05)                            0562
*   SWITCH1 = ON;                     /*SET TO NOT DO FIRST 1/2 BYTE */
         OI    SWITCH1,B'10000000'                                 0563
*   ADDNXT = ADDR(CUA11);             /*ADDRESS OF WHERE TO PUT DATA */
         LA    @06,CUA11                                           0564
         ST    @06,ADDNXT                                          0564
*   IF SHORTSW = ON                   /*IS THIS A SHORT OBR  @Z427VLS*/
*     THEN                                                         0565
         TM    SHORTSW(R7),B'00100000'                             0565
         BNO   @RF00565                                            0565
*      DO;                                                 /*@Z427VLS*/
*    IF (OBRSDEV2 & 'F000'X) = '8000'X THEN                        0567
         MVC   @TS00001(2),OBRSDEV2(R7)                            0567
         NC    @TS00001(2),@CB01425                                0567
         CLC   @TS00001(2),@CB00198                                0567
         BNE   @RF00567                                            0567
*        VOLUME1 = OBRVOL;            /*MOVE IN THE OBR VOLUME ID    */
         MVC   VOLUME1(6),OBRVOL(R7)                               0568
*       DEVICE1 = HH1;                /*WILL SET THE ITEM BACK TO    */
@RF00567 MVC   DEVICE1(4),HH1                                      0569
*                                     /*BLANKS               @Z427VLS*/
*       NEXTBY = ADDR(OBRSCUA) + ONE; /*ADDRESS OF CUA IN SHORT OBR  */
         LA    @06,OBRSCUA(,R7)                                    0570
         AL    @06,ONE                                             0570
         ST    @06,NEXTBY                                          0570
*       DEVCOMP = OBRSDEV2;           /*SHORT OBR DEVICE     @Z427VLS*/
         MVC   DEVCOMP(2),OBRSDEV2(R7)                             0571
*       JOBNAME1 = NOTAPPLY;                               /*@Z427VLS*/
         MVC   JOBNAME1(8),NOTAPPLY                                0572
*      END;                                                /*@Z427VLS*/
*     ELSE                                                         0574
*      DO;                                                 /*@Z427VLS*/
         B     @RC00565                                            0574
@RF00565 DS    0H                                                  0575
*       IF OBRCLASS = '80'X THEN                                   0575
         CLI   OBRCLASS(R7),X'80'                                  0575
         BNE   @RF00575                                            0575
*        VOLUME1 = OBRVOL;                                 /*@Z427VLS*/
         MVC   VOLUME1(6),OBRVOL(R7)                               0576
*       IF ((OBRDEV = '2009'X)  (OBRDEV = '200D'X)) &     /*@ZA36018*/
*          ((OBRCODE2 & '08'X) = '08'X) THEN               /*@ZA36018*/
@RF00575 CLC   OBRDEV(2,R7),@CB01427                               0577
         BE    @GL00006                                            0577
         CLC   OBRDEV(2,R7),@CB01428                               0577
         BNE   @RF00577                                            0577
@GL00006 MVC   @TS00001(1),OBRCODE2(R7)                            0577
         NI    @TS00001,X'08'                                      0577
         CLI   @TS00001,X'08'                                      0577
         BNE   @RF00577                                            0577
*          LETTERV = 'V';                                  /*@Z427VLS*/
         MVI   LETTERV,C'V'                                        0578
*      IF DEBUG29 = ON THEN  /*USE SECONDARY CUA RATHER THAN PRIMARY*/
@RF00577 TM    DEBUG29(R2),B'00000100'                             0579
         BNO   @RF00579                                            0579
*       NEXTBY = ADDR(OBRSECUA) + 1;/*ADDRESS OF THE SECONDARY CUA*/
         LA    @06,OBRSECUA(,R7)                                   0580
         AL    @06,@CF00055                                        0580
         ST    @06,NEXTBY                                          0580
*      ELSE                                                        0581
*       NEXTBY = ADDR(OBRPCUA) + ONE; /*ADDRESS OF LONG OBR CUA      */
         B     @RC00579                                            0581
@RF00579 LA    @06,OBRPCUA(,R7)                                    0581
         AL    @06,ONE                                             0581
         ST    @06,NEXTBY                                          0581
*       DEVCOMP = OBRDEV;             /*LONG OBR DEVICE TYPE @Z427VLS*/
@RC00579 MVC   DEVCOMP(2),OBRDEV(R7)                               0582
*   JOBNAME1 = OBRJOBID;              /*MOVE THE NAME INTO PRINT LINE*/
         MVC   JOBNAME1(8),OBRJOBID(R7)                            0583
*    IF LRTKEY1 ='36'X    /*WILL ALWAYS HAVE A TERMINAL NAME    */
*     ((LRTKEY1 = '34'X  LRTKEY1 = '32'X) & OBRTCAM = '0F'X) THEN 0584
         CLI   LRTKEY1(R7),X'36'                                   0584
         BE    @RT00584                                            0584
         CLI   LRTKEY1(R7),X'34'                                   0584
         BE    @GL00009                                            0584
         CLI   LRTKEY1(R7),X'32'                                   0584
         BNE   @RF00584                                            0584
@GL00009 CLI   OBRTCAM(R7),X'0F'                                   0584
         BNE   @RF00584                                            0584
@RT00584 DS    0H                                                  0585
*       TERMNAME = OBRTERMN;    /*MOVE TERMINAL NAME TO PRT BUFFER*/
         MVC   TERMNAME(8),OBRTERMN(R7)                            0585
*      END;                                                /*@Z427VLS*/
@RF00584 DS    0H                                                  0587
*   CALL CONVERT;                     /*GO CONVERT 1 & 1/2 BYTES     */
@RC00565 BAL   @14,CONVERT                                         0587
*   CALL DODEVICE;                    /*GO PROCESS THE DEVICE        */
         BAL   @14,DODEVICE                                        0588
*    IF (DEVTYPE1 = '3410'  DEVTYPE1 = '3420') THEN       /*@ZA34787*/
         CLC   DEVTYPE1(4),@CC01435                                0589
         BE    @RT00589                                            0589
         CLC   DEVTYPE1(4),@CC01436                                0589
         BNE   @RF00589                                            0589
@RT00589 DS    0H                                                  0590
*        DEVTYPE1 = '34XX';    /*CHANGE 3410,3420 TO 34XX    @ZA34787*/
         MVC   DEVTYPE1(4),@CC01437                                0590
* IF(SDRCOUNT = OFF &          /*END OF DAY COUNTER FLAG OFF @0001VLS*/
*    OBRTEMP  = OFF &          /*IT IS NOT AN TEMP OBR       @0001VLS*/
*    SHORTSW  = OFF &          /*IT IS NOT A SHORT OBR       @0001VLS*/
*    DISMOUNT = OFF ) &        /*IT IS NOT A DISMOUNT RECORD @0001VLS*/
*    OBRSEN1 ^= '40'X         /*AND NOT A INTERVENTION REQUIRED */ 0591
*    THEN                      /*IT MUST BE A OBR-PERM  ERROR   */ 0591
@RF00589 TM    SDRCOUNT(R7),B'11100100'                            0591
         BNZ   @RF00591                                            0591
         LA    @06,64                                              0591
         ALR   @06,R7                                              0591
         SLR   @05,@05                                             0591
         IC    @05,OBRDEVDC(,R7)                                   0591
         SLA   @05,3                                               0591
         ALR   @06,@05                                             0591
         SLR   @05,@05                                             0591
         IC    @05,OBRLSDRC(,R7)                                   0591
         ALR   @06,@05                                             0591
         CLI   OBRSEN1(@06),X'40'                                  0591
         BE    @RF00591                                            0591
*    DO;                                                   /*@ZA19014*/
*     CALL OBRISPRM; /*CALL THE OBR PERM PROC TO BUILD  LINE @ZA19014*/
         BAL   @14,OBRISPRM                                        0593
*     OBRPRMCT(PTR) = OBRPRMCT(PTR) + ONE;               /*  @ZA19014*/
         L     @06,PTR                                             0594
         SLA   @06,2                                               0594
         L     @05,OBRPRMCT-4(@06)                                 0594
         AL    @05,ONE                                             0594
         ST    @05,OBRPRMCT-4(@06)                                 0594
*     RECTYP1 = OBRPRM; /*MOVE IN THE OBR IS PERMENT NAME    @ZA19014*/
         MVC   RECTYP1(7),OBRPRM                                   0595
*    END;                                                  /*@ZA19014*/
*    ELSE                                                          0597
*     IF SDRCOUNT = ON                /*IS IT AN OBR END OF DAY      */
*      THEN                                                        0597
         B     @RC00591                                            0597
@RF00591 TM    SDRCOUNT(R7),B'10000000'                            0597
         BNO   @RF00597                                            0597
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = OBREOD;            /*SET UP THE NAME FOR EOD      */
         MVC   RECTYP1(7),OBREOD                                   0599
*        OBREODCT(PTR) = OBREODCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0600
         SLA   @06,2                                               0600
         L     @05,OBREODCT-4(@06)                                 0600
         AL    @05,ONE                                             0600
         ST    @05,OBREODCT-4(@06)                                 0600
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0602
*      IF SHORTSW = ON THEN                                        0602
         B     @RC00597                                            0602
@RF00597 TM    SHORTSW(R7),B'00100000'                             0602
         BNO   @RF00602                                            0602
*       DO;                                                /*@ZA19014*/
*        RECTYP1 = OBRSHT;     /*SET TYPE TO OBR SHORT       @ZA19014*/
         MVC   RECTYP1(7),OBRSHT                                   0604
*        OBRSHTCT(PTR) = OBRSHTCT(PTR) + ONE;           /*   @ZA19014*/
         L     @06,PTR                                             0605
         SLA   @06,2                                               0605
         L     @05,OBRSHTCT-4(@06)                                 0605
         AL    @05,ONE                                             0605
         ST    @05,OBRSHTCT-4(@06)                                 0605
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0607
*         IF OBRTEMP = ON THEN                                     0607
         B     @RC00602                                            0607
@RF00602 TM    OBRTEMP(R7),B'01000000'                             0607
         BNO   @RF00607                                            0607
*          DO;                                             /*@ZA19014*/
*           RECTYP1 = OBRTMP; /*MAKE THE LABLE A OBR TEMP    @ZA19014*/
         MVC   RECTYP1(7),OBRTMP                                   0609
*           OBRTMPCT(PTR) = OBRTMPCT(PTR) + ONE;      /*     @ZA19014*/
         L     @06,PTR                                             0610
         SLA   @06,2                                               0610
         L     @05,OBRTMPCT-4(@06)                                 0610
         AL    @05,ONE                                             0610
         ST    @05,OBRTMPCT-4(@06)                                 0610
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0612
*           IF DISMOUNT = ON          /*WAS IT A DISMOUNT OBR        */
*            THEN                                                  0612
         B     @RC00607                                            0612
@RF00607 TM    DISMOUNT(R7),B'00000100'                            0612
         BNO   @RF00612                                            0612
*             DO;                                          /*@Z427VLS*/
*              RECTYP1 = OBRDMT ;                          /*@Z427VLS*/
         MVC   RECTYP1(7),OBRDMT                                   0614
*              OBRDMTCT(PTR) = OBRDMTCT(PTR) + ONE;        /*@Z427VLS*/
         L     @06,PTR                                             0615
         SLA   @06,2                                               0615
         L     @05,OBRDMTCT-4(@06)                                 0615
         AL    @05,ONE                                             0615
         ST    @05,OBRDMTCT-4(@06)                                 0615
*             END;                                         /*@Z427VLS*/
*            ELSE                                                  0617
*             DO;                     /*IS A ODD OBR         @Z427VLS*/
         B     @RC00612                                            0617
@RF00612 DS    0H                                                  0618
*              RECTYP1 = OBR;         /*SET NAME TO JUST PLAIN OBR   */
         MVC   RECTYP1(7),OBR                                      0618
*              OBRCT(PTR) = OBRCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0619
         SLA   @06,2                                               0619
         L     @05,OBRCT-4(@06)                                    0619
         AL    @05,ONE                                             0619
         ST    @05,OBRCT-4(@06)                                    0619
*              ADDNXT = ADDR(CSW1);   /*SET UP FOR CSW OUTPUT        */
         LA    @06,CSW1                                            0620
         ST    @06,ADDNXT                                          0620
*              NEXTBY = ADDR(OBRSTAT);/*SET UP WHERE TO GET THE DATA */
         LA    @06,OBRSTAT(,R7)                                    0621
         ST    @06,NEXTBY                                          0621
*              CALL CONVERT;          /*GO CONVERT THE NUM # STILL 2 */
         BAL   @14,CONVERT                                         0622
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/
         MVC   NUMBER(4),@CF00055                                  0623
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */
         LA    @06,CMD1                                            0624
         ST    @06,ADDNXT                                          0624
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */
         LA    @06,OBRSRDS(,R7)                                    0625
         ST    @06,NEXTBY                                          0625
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */
         BAL   @14,CONVERT                                         0626
*             END;                                         /*@Z427VLS*/
*                                                                  0627
*/*EREPSEND  */                                                    0628
*       GO TO L000113;                                             0628
         B     L000113                                             0628
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL SFT TYPE RECORDS           @Z427VLS*/
* /*                                                         @Z427VLS*/
*                                                                  0630
*/*EREPSUB  */                                                     0630
*L00014:                                                           0630
*     DO;                                               /*@Z427VLS*/
L00014   DS    0H                                                  0631
*   CALL TIME;                     /*GO AND SET UP THE TIME  FROM REC*/
         BAL   @14,TIME                                            0631
*   JOBNAME1 = SFTJOBID;           /*MOVE IN THE JOB NAME    @Z427VLS*/
         MVC   JOBNAME1(8),SFTJOBID(R7)                            0632
*   NUMBER = EIGHT;               /*NUMBER OF BYTES TO CHANGE       */
         MVC   NUMBER(4),@CF00065                                  0633
*   ADDNXT = ADDR(PSWMCH);        /*WHERE TO PUT THE CONVERTED DATA */
         LA    @06,PSWMCH                                          0634
         ST    @06,ADDNXT                                          0634
*   NEXTBY = ADDR(SFTPROGC);      /*WHERE IN THE RECORD TO GET DATA */
         LA    @06,SFTPROGC(,R7)                                   0635
         ST    @06,NEXTBY                                          0635
*   CALL CONVERT;                 /*GO AND CONVERT THE DATA  @Z427VLS*/
         BAL   @14,CONVERT                                         0636
*   RCYRYXIT = SFTREXN;                                    /*@Z427VLS*/
         MVC   RCYRYXIT(8),SFTREXN(R7)                             0637
*   COMPMOD = SFTMODN;                                     /*@Z427VLS*/
         MVC   COMPMOD(8),SFTMODN(R7)                              0638
*   CSECTID = SFTCSECT;                                    /*@Z427VLS*/
         MVC   CSECTID(8),SFTCSECT(R7)                             0639
* NUMBER = 4;                /*REASON CODE HAS 4 BYTES OF INFO*/   0640
         LA    @06,4                                               0640
         ST    @06,NUMBER                                          0640
* ADDNXT = ADDR(REASON) -2; /*LOCATION IN THE PRINT LINE     @0098VLS*/
         LA    @05,REASON                                          0641
         BCTR  @05,0                                               0641
         BCTR  @05,0                                               0641
         ST    @05,ADDNXT                                          0641
* NEXTBY = ADDR(SFTABNDC) + 4;/*WHERE INFO IS                @0098VLS*/
         LA    @05,SFTABNDC(,R7)                                   0642
         ALR   @05,@06                                             0642
         ST    @05,NEXTBY                                          0642
* CALL CONVERT;                                            /*@0098VLS*/
         BAL   @14,CONVERT                                         0643
* IF (LRTERRID & '20'X) = '20'X THEN                               0644
         MVC   @TS00001(1),LRTERRID(R7)                            0644
         NI    @TS00001,X'20'                                      0644
         CLI   @TS00001,X'20'                                      0644
         BNE   @RF00644                                            0644
*  DO;                                                     /*@0098VLS*/
*   NUMBER = 10;  /*ERROR ID IS TEN BYTES LONG               @0098VLS*/
         LA    @06,10                                              0646
         ST    @06,NUMBER                                          0646
*   ADDNXT = ADDR(ERRORID1); /*WHERE IN THE LINE TO PUT IT   @0098VLS*/
         LA    @05,ERRORID1                                        0647
         ST    @05,ADDNXT                                          0647
*   NEXTBY = ADDR(RERR);/*LOCATION OF THE ERROR ID(R7 + RECLNGTH + 10*/
         LR    @05,R7                                              0648
         AH    @05,RECLNGTH(,R2)                                   0648
         SLR   @05,@06                                             0648
         ST    @05,NEXTBY                                          0648
*   CALL CONVERT;   /*CONVERT TO PRINTABLE                   @0098VLS*/
         BAL   @14,CONVERT                                         0649
*  END;                                                    /*@0098VLS*/
* ELSE                                                             0651
*  ERRORNA = NOTAPPLY;   /*PUT THE WORDS DOES NOT APPLY      @0098VLS*/
         B     @RC00644                                            0651
@RF00644 MVC   ERRORNA(8),NOTAPPLY                                 0651
*   IF SFTKEY1 = '40'X                                             0652
*    THEN                                                          0652
@RC00644 CLI   SFTKEY1(R7),X'40'                                   0652
         BNE   @RF00652                                            0652
*     DO;                                                  /*@Z427VLS*/
*      RECTYP1  = SFTABN;                                  /*@Z427VLS*/
         MVC   RECTYP1(7),SFTABN                                   0654
*      SFTABNCT(PTR) = SFTABNCT(PTR) + ONE;                /*@Z427VLS*/
         L     @06,PTR                                             0655
         SLA   @06,2                                               0655
         L     @05,SFTABNCT-4(@06)                                 0655
         AL    @05,ONE                                             0655
         ST    @05,SFTABNCT-4(@06)                                 0655
*     END;                                                 /*@Z427VLS*/
*    ELSE                                                          0657
*     IF SFTKEY1 = '42'X                                           0657
*      THEN                                                        0657
         B     @RC00652                                            0657
@RF00652 CLI   SFTKEY1(R7),X'42'                                   0657
         BNE   @RF00657                                            0657
*       DO;                                                /*@Z427VLS*/
*        RECTYP1 = SFTPI;                                  /*@Z427VLS*/
         MVC   RECTYP1(7),SFTPI                                    0659
*        SFTPICT(PTR) = SFTPICT(PTR) + ONE;                /*@Z427VLS*/
         L     @06,PTR                                             0660
         SLA   @06,2                                               0660
         L     @05,SFTPICT-4(@06)                                  0660
         AL    @05,ONE                                             0660
         ST    @05,SFTPICT-4(@06)                                  0660
*       END;                                               /*@Z427VLS*/
*      ELSE                                                        0662
*       IF SFTKEY1 = '44'X                                         0662
*        THEN                                                      0662
         B     @RC00657                                            0662
@RF00657 CLI   SFTKEY1(R7),X'44'                                   0662
         BNE   @RF00662                                            0662
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = SFTRST;                               /*@Z427VLS*/
         MVC   RECTYP1(7),SFTRST                                   0664
*          SFTRSTCT(PTR) = SFTRSTCT(PTR) + ONE;            /*@Z427VLS*/
         L     @06,PTR                                             0665
         SLA   @06,2                                               0665
         L     @05,SFTRSTCT-4(@06)                                 0665
         AL    @05,ONE                                             0665
         ST    @05,SFTRSTCT-4(@06)                                 0665
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0667
*         IF SFTKEY1 = '48'X                                       0667
*          THEN                                                    0667
         B     @RC00662                                            0667
@RF00662 CLI   SFTKEY1(R7),X'48'                                   0667
         BNE   @RF00667                                            0667
*           DO;                                            /*@Z427VLS*/
*            RECTYP1 = SFTMCH;                             /*@Z427VLS*/
         MVC   RECTYP1(7),SFTMCH                                   0669
*            SFTMCHCT(PTR) = SFTMCHCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0670
         SLA   @06,2                                               0670
         L     @05,SFTMCHCT-4(@06)                                 0670
         AL    @05,ONE                                             0670
         ST    @05,SFTMCHCT-4(@06)                                 0670
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0672
*            IF SFTKEY1 = '4F'X      /*SHORT RECORD SOFT     @ZA27247*/
*             THEN                                                 0672
         B     @RC00667                                            0672
@RF00667 CLI   SFTKEY1(R7),X'4F'                                   0672
         BNE   @RF00672                                            0672
*              DO;                                         /*@ZA27247*/
*               RECTYP1 = SFT;                             /*@ZA27247*/
         MVC   RECTYP1(7),SFT                                      0674
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/
         L     @06,PTR                                             0675
         SLA   @06,2                                               0675
         L     @05,SFTCT-4(@06)                                    0675
         AL    @05,ONE                                             0675
         ST    @05,SFTCT-4(@06)                                    0675
*               GENERATE;                                  /*@ZA27247*/
                 MVC JOBNAME1,=CL8' '
                 MVC LOSTSOFT(54),LOSTMSG
*              END;                                        /*@ZA27247*/
*             ELSE                                                 0678
*              DO;                                         /*@ZA27247*/
         B     @RC00672                                            0678
@RF00672 DS    0H                                                  0679
*               RECTYP1 = SFT;                             /*@ZA27247*/
         MVC   RECTYP1(7),SFT                                      0679
*               SFTCT(PTR) = SFTCT(PTR) + ONE;             /*@ZA27247*/
         L     @06,PTR                                             0680
         SLA   @06,2                                               0680
         L     @05,SFTCT-4(@06)                                    0680
         AL    @05,ONE                                             0680
         ST    @05,SFTCT-4(@06)                                    0680
*              END;                                        /*@ZA27247*/
*   CPU12 = EVLETTER(PTR);                                 /*@Z427VLS*/
*                                                                  0682
@RC00672 DS    0H                                                  0682
@RC00667 DS    0H                                                  0682
@RC00662 DS    0H                                                  0682
@RC00657 DS    0H                                                  0682
@RC00652 L     @06,PTR                                             0682
         MH    @06,@CH00080                                        0682
         L     @05,EVPTR(,R2)                                      0682
         ALR   @05,@06                                             0682
         MVC   CPU12(1),EVLETTER-6(@05)                            0682
*/*EREPSEND  */                                                    0683
*       GO TO L000113;                                             0683
         B     L000113                                             0683
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL IPL TYPE RECORDS           @Z427VLS*/
*                                                                  0685
*/*EREPSUB  */                                                     0685
*L00015:                                                           0685
*     DO;                                               /*@Z427VLS*/
L00015   DS    0H                                                  0686
*     CALL TIME;                     /*CONVERT THE TIME FOR THIS REC */
         BAL   @14,TIME                                            0686
*     RECTYP1 = IPL;                 /*PUT IN THE TYPE OF RECORD     */
         MVC   RECTYP1(7),IPL                                      0687
*     IPLCT(PTR) = IPLCT(PTR) + ONE; /*ADD ONE TO THE IPL COUNTER    */
         L     @06,PTR                                             0688
         LR    @05,@06                                             0688
         SLA   @05,2                                               0688
         L     @03,ONE                                             0688
         L     @15,IPLCT-4(@05)                                    0688
         ALR   @15,@03                                             0688
         ST    @15,IPLCT-4(@05)                                    0688
*     CPU12 = EVLETTER(PTR);         /*MOVE IN THE CPU  LETTER       */
         MH    @06,@CH00080                                        0689
         L     @05,EVPTR(,R2)                                      0689
         ALR   @05,@06                                             0689
         MVC   CPU12(1),EVLETTER-6(@05)                            0689
*     REASON = IPLREAS;              /*MOVE IN THE IPL REASON@ZA24916*/
         MVI   REASON+2,C' '                                       0690
         MVC   REASON+3(3),REASON+2                                0690
         MVC   REASON(2),IPLREAS(R7)                               0690
*     NUMBER = ONE;                  /*SET UP # OF BYTES TO CONVERT  */
         ST    @03,NUMBER                                          0691
*     ADDNXT = ADDR(SSYS);           /*SET ADDRESS OF REASON CODE    */
         LA    @06,SSYS                                            0692
         ST    @06,ADDNXT                                          0692
*     NEXTBY = ADDR(IPLSYSID);       /*SET ADD OF WHERE IN RECORD ID */
         LA    @06,IPLSYSID(,R7)                                   0693
         ST    @06,NEXTBY                                          0693
*     CALL CONVERT;                  /*GO CONVERT TO PRINTABLE       */
         BAL   @14,CONVERT                                         0694
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/
*                                                                  0695
         MVC   JOBNAME1(8),NOTAPPLY                                0695
*/*EREPSEND  */                                                    0696
*       GO TO L000113;                                             0696
         B     L000113                                             0696
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL DDR TYPE RECORDS           @Z427VLS*/
*                                                                  0698
*/*EREPSUB  */                                                     0698
*L00016:                                                           0698
*     DO;                                               /*@Z427VLS*/
L00016   DS    0H                                                  0699
*    CALL TIME;                 /*MOVE THE TIME INTO THE LINE       */
         BAL   @14,TIME                                            0699
*     IF DDRDEPSW = '20'X        /*WAS IT AN OPERATOR REQUEST        */
*        THEN                    /*YES IT WAS                @Z427VLS*/
         CLI   DDRDEPSW(R7),X'20'                                  0700
         BNE   @RF00700                                            0700
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = DDROPR;     /*MOVE DDR-OPR INTO THE PRINT LINE  */
         MVC   RECTYP1(7),DDROPR                                   0702
*          DDROPRCT(PTR) = DDROPRCT(PTR) + ONE;            /*@Z427VLS*/
         L     @06,PTR                                             0703
         SLA   @06,2                                               0703
         L     @05,DDROPRCT-4(@06)                                 0703
         AL    @05,ONE                                             0703
         ST    @05,DDROPRCT-4(@06)                                 0703
*          JOBNAME1 = DDRJOBID;  /*MOVE IN THE JOB NAME      @Z427VLS*/
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0704
*         END;                                             /*@Z427VLS*/
*        ELSE                                                      0706
*         DO;                                              /*@Z427VLS*/
         B     @RC00700                                            0706
@RF00700 DS    0H                                                  0707
*          IF DDRDEPSW = '10'X   /*WAS IT A SYSTEM REQUESTED IPL     */
*            THEN                                                  0707
         CLI   DDRDEPSW(R7),X'10'                                  0707
         BNE   @RF00707                                            0707
*             DO;                                          /*@Z427VLS*/
*              RECTYP1 = DDRSYS; /*MOVE DDR-SYS INTO THE PRINT LINE  */
         MVC   RECTYP1(7),DDRSYS                                   0709
*              DDRSYSCT(PTR) = DDRSYSCT(PTR) + ONE;        /*@Z427VLS*/
         L     @06,PTR                                             0710
         SLA   @06,2                                               0710
         L     @05,DDRSYSCT-4(@06)                                 0710
         AL    @05,ONE                                             0710
         ST    @05,DDRSYSCT-4(@06)                                 0710
*             END;                                         /*@Z427VLS*/
*            ELSE                                                  0712
*             DO;                                          /*@Z427VLS*/
         B     @RC00707                                            0712
@RF00707 DS    0H                                                  0713
*              RECTYP1 = DDR;    /*MOVE JUST PLAIN DDR IN TO PRINT   */
         MVC   RECTYP1(7),DDR                                      0713
*              DDRCT(PTR) = DDRCT(PTR) + ONE;              /*@Z427VLS*/
         L     @06,PTR                                             0714
         SLA   @06,2                                               0714
         L     @05,DDRCT-4(@06)                                    0714
         AL    @05,ONE                                             0714
         ST    @05,DDRCT-4(@06)                                    0714
*             END;                                         /*@Z427VLS*/
*         END;                                             /*@Z427VLS*/
@RC00707 DS    0H                                                  0717
*     IF(DDRDEPSW & 'F0'X) = '10'X THEN                            0717
@RC00700 MVC   @TS00001(1),DDRDEPSW(R7)                            0717
         NI    @TS00001,X'F0'                                      0717
         CLI   @TS00001,X'10'                                      0717
         BNE   @RF00717                                            0717
*      JOBNAME1 = DDRJOBID;      /*THEN MOVE IN THE JOB NAME @Z427VLS*/
         MVC   JOBNAME1(8),DDRJOBID(R7)                            0718
*     CPU12 = EVLETTER(PTR);     /*MOVE IN CPU LETTER        @Z427VLS*/
@RF00717 L     @06,PTR                                             0719
         MH    @06,@CH00080                                        0719
         L     @05,EVPTR(,R2)                                      0719
         ALR   @05,@06                                             0719
         MVC   CPU12(1),EVLETTER-6(@05)                            0719
*     DEVCOMP = DDRDEV2;         /*SET UP THE DEVICE TYPE    @Z427VLS*/
         MVC   DEVCOMP(2),DDRDEV2(R7)                              0720
*     CALL DODEVICE;             /*PROCESS THE DEVICE NAME   @Z427VLS*/
         BAL   @14,DODEVICE                                        0721
*     DEVSAVE = DEVTYPE1;        /*SAVE THIS TO MOVE INTO THE PRINT  */
         MVC   DEVSAVE(4),DEVTYPE1                                 0722
*     DEVCOMP = DDRCODE2;        /*SET UP THE FROM DEVICE TYPE       */
         MVC   DEVCOMP(2),DDRCODE2(R7)                             0723
*     CALL DODEVICE;             /*CONVERT THE FROM DEVICE   @Z427VLS*/
         BAL   @14,DODEVICE                                        0724
*     SWITCH1 = ON;              /*SET FOR 1 & 1/2 BYTES OUT OF CONV */
         OI    SWITCH1,B'10000000'                                 0725
*     NUMBER = 2;                /*SET UP TO PROCESS TWO BYTES       */
         MVC   NUMBER(4),@CF00073                                  0726
*     NEXTBY = ADDR(DDRFCUA)+1; /*WHERE TO GET THE CUA       @Z427VLS*/
         LA    @06,DDRFCUA(,R7)                                    0727
         AL    @06,@CF00055                                        0727
         ST    @06,NEXTBY                                          0727
*     ADDNXT = ADDR(CUA11);      /*WHERE TO PUT THE CUA      @Z427VLS*/
         LA    @06,CUA11                                           0728
         ST    @06,ADDNXT                                          0728
*     CALL CONVERT;              /*PUT FROM CUA IN TO LINE   @Z427VLS*/
         BAL   @14,CONVERT                                         0729
*     SWITCH1= ON;               /*SAME DO 1 & 1/2 BYTES     @Z427VLS*/
         OI    SWITCH1,B'10000000'                                 0730
*     NEXTBY = ADDR(DDRTOCUA)+1; /*WHERE TO PUT TO CUA       @Z427VLS*/
         LA    @06,DDRTOCUA(,R7)                                   0731
         AL    @06,@CF00055                                        0731
         ST    @06,NEXTBY                                          0731
*     ADDNXT = ADDR(TOCUA);                                /*@Z427VLS*/
         LA    @06,TOCUA                                           0732
         ST    @06,ADDNXT                                          0732
*     CALL CONVERT;                                        /*@Z427VLS*/
         BAL   @14,CONVERT                                         0733
*     GEN(MVC   CMD1(12),DDRSPEC);                         /*@Z427VLS*/
         MVC   CMD1(12),DDRSPEC
*     VOLUME1 = DDRVOL1;/*VOLUME FROM ID                     @Z427VLS*/
         MVC   VOLUME1(6),DDRVOL1(R7)                              0735
*     IF DDRVOL2 ^= BLANK1 THEN  /*WILL BE BLANK IF NOT ANY TO VOLUME*/
         CLC   DDRVOL2(6,R7),BLANK1                                0736
         BE    @RF00736                                            0736
*     DO;                                                  /*@Z427VLS*/
*     GEN(MVC   BB1(2),TOO);     /*MOVE WORD TO INTO THE LINE        */
         MVC   BB1(2),TOO
*     R9 = ADDR(DDRVOL2);                                  /*@Z427VLS*/
         LA    R9,DDRVOL2(,R7)                                     0739
*     GEN(MVC  BB1+3(6),0(R9));                            /*@Z427VLS*/
         MVC  BB1+3(6),0(R9)
*     END;                                                 /*@Z427VLS*/
*                                                                  0741
*/*EREPSEND  */                                                    0742
*       GO TO L000113;                                             0742
         B     L000113                                             0742
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MIH TYPE RECORDS           @Z427VLS*/
*                                                                  0744
*/*EREPSUB  */                                                     0744
*L00017:                                                           0744
*     DO;                                               /*@Z427VLS*/
L00017   DS    0H                                                  0745
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */
         BAL   @14,TIME                                            0745
*     IF MIHMOD > '0168'X & MIHMOD ^= '3062'X  /*303X CPU    @G64XXJS*/
*       THEN                                                       0746
         CLC   MIHMOD(2,R7),@CB01420                               0746
         BNH   @RF00746                                            0746
         CLC   MIHMOD(2,R7),@CB01421                               0746
         BE    @RF00746                                            0746
*         DO;                                              /*@G64XXJS*/
*          SENSEA1(1:5) = CSID;   /*MOVE CSID INTO PRINTLINE @G64XXJS*/
         MVC   SENSEA1(5),@CC01355                                 0748
*          NUMBER = 1;    /*SET UP NUMBER OF BYTES TO CONVERT*/    0749
         MVC   NUMBER(4),@CF00055                                  0749
*          ADDNXT = ADDR(SENSEA1) + FIVE;  /*SET UP CSID TO PRINT*/
         LA    @06,SENSEA1                                         0750
         AL    @06,FIVE                                            0750
         ST    @06,ADDNXT                                          0750
*          NEXTBY = ADDR(MIHCSID);  /*ADDR OF CHANNEL SET ID @G64XXJS*/
         LA    @06,MIHCSID(,R7)                                    0751
         ST    @06,NEXTBY                                          0751
*          CALL CONVERT;   /*CONVERT CHANNEL SET ID TO PRINTABLE*/ 0752
         BAL   @14,CONVERT                                         0752
*         END;                                             /*@G64XXJS*/
*     JOBNAME1 = MIHJOBID;      /*SET UP THE TYPE OF RECORD ONLY 1   */
@RF00746 MVC   JOBNAME1(8),MIHJOBID(R7)                            0754
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE CPU LETTER FILT4 BUILT */
         L     @06,PTR                                             0755
         LR    @05,@06                                             0755
         MH    @05,@CH00080                                        0755
         L     @03,EVPTR(,R2)                                      0755
         ALR   @03,@05                                             0755
         MVC   CPU12(1),EVLETTER-6(@03)                            0755
*     VOLUME1 = MIHVOL;         /*MOVE IN THE VOLUME NAME    @Z427VLS*/
         MVC   VOLUME1(6),MIHVOL(R7)                               0756
*     IF MIHCEBIT = ON          /*WAS RECORD CAUSED BY CONTROL END   */
*       THEN                                                       0757
         TM    MIHCEBIT(R7),B'10000000'                            0757
         BNO   @RF00757                                            0757
*         DO;                                              /*@Z427VLS*/
*          RECTYP1 = MIHCE;     /*MAKE THE RECORD TYPE MIH-CE        */
         MVC   RECTYP1(7),MIHCE                                    0759
*          MIHCECT(PTR) = MIHCECT(PTR) + ONE;              /*@Z427VLS*/
         SLA   @06,2                                               0760
         L     @05,MIHCECT-4(@06)                                  0760
         AL    @05,ONE                                             0760
         ST    @05,MIHCECT-4(@06)                                  0760
*         END;                                             /*@Z427VLS*/
*       ELSE                                                       0762
*        DO;                                               /*@Z427VLS*/
         B     @RC00757                                            0762
@RF00757 DS    0H                                                  0763
*         IF MIHDEBIT = ON      /*WAS RECORD FROM DEVICE END @Z427VLS*/
*           THEN                                                   0763
         TM    MIHDEBIT(R7),B'01000000'                            0763
         BNO   @RF00763                                            0763
*            DO;                                           /*@Z427VLS*/
*             RECTYP1 = MIHDE;  /*SET RECORD NAME TO MIH-DE  @Z427VLS*/
         MVC   RECTYP1(7),MIHDE                                    0765
*             MIHDECT(PTR) = MIHDECT(PTR) + ONE;           /*@Z427VLS*/
         L     @06,PTR                                             0766
         SLA   @06,2                                               0766
         L     @05,MIHDECT-4(@06)                                  0766
         AL    @05,ONE                                             0766
         ST    @05,MIHDECT-4(@06)                                  0766
*            END;                                          /*@Z427VLS*/
*           ELSE                                                   0768
*            DO;                                           /*@Z427VLS*/
         B     @RC00763                                            0768
@RF00763 DS    0H                                                  0769
*             RECTYP1 = MIH;    /*SET TO PLAIN MIH TYPE RECORD       */
         MVC   RECTYP1(7),MIH                                      0769
*             MIHCT(PTR) = MIHCT(PTR) + ONE;               /*@Z427VLS*/
         L     @06,PTR                                             0770
         SLA   @06,2                                               0770
         L     @05,MIHCT-4(@06)                                    0770
         AL    @05,ONE                                             0770
         ST    @05,MIHCT-4(@06)                                    0770
*            END;                                          /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
@RC00763 DS    0H                                                  0773
*     SWITCH1 = ON;             /*SET TO DROP LAST 1/2 BYTE  @Z427VLS*/
@RC00757 OI    SWITCH1,B'10000000'                                 0773
*     NUMBER = 2 ;              /*SET UP TO PROCESS 2 BYTES OF DATA  */
         MVC   NUMBER(4),@CF00073                                  0774
*     NEXTBY = ADDR(MIHCUA)+ONE;/*LOCATION OF CUA IN THE RECORD      */
         LA    @06,MIHCUA(,R7)                                     0775
         AL    @06,ONE                                             0775
         ST    @06,NEXTBY                                          0775
*     ADDNXT = ADDR(CUA11);     /*ADDRESS OF WHERE TO PUT CONVERTED  */
         LA    @06,CUA11                                           0776
         ST    @06,ADDNXT                                          0776
*     CALL CONVERT;             /*GO CHANGE THE FORMAT OF THE CUA    */
         BAL   @14,CONVERT                                         0777
*     DEVCOMP = MIHCODE2;       /*SET UP THE DEVICE TO CHANGE        */
         MVC   DEVCOMP(2),MIHCODE2(R7)                             0778
*     CALL DODEVICE;            /*PROCESS THE DEVICE NAME    @Z427VLS*/
*                                                                  0779
         BAL   @14,DODEVICE                                        0779
*/*EREPSEND  */                                                    0780
*       GO TO L000113;                                             0780
         B     L000113                                             0780
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL EOD TYPE RECORDS           @Z427VLS*/
*                                                                  0782
*/*EREPSUB  */                                                     0782
*L00018:                                                           0782
*     DO;                                               /*@Z427VLS*/
L00018   DS    0H                                                  0783
*     CALL TIME;                /*GO FORMAT THE TIME FROM THE RECORD */
         BAL   @14,TIME                                            0783
*     CPU12 = EVLETTER(PTR);    /*MOVE IN THE LETTER FILT4 ASSIGNED  */
         L     @06,PTR                                             0784
         LR    @05,@06                                             0784
         MH    @05,@CH00080                                        0784
         L     @03,EVPTR(,R2)                                      0784
         ALR   @03,@05                                             0784
         MVC   CPU12(1),EVLETTER-6(@03)                            0784
*     RECTYP1 = EOD;            /*SET THE RECORD TYPE TO PLAIN EOD   */
         MVC   RECTYP1(7),EOD                                      0785
*     EODCT(PTR) = EODCT(PTR) + ONE;                       /*@Z427VLS*/
         SLA   @06,2                                               0786
         L     @05,EODCT-4(@06)                                    0786
         AL    @05,ONE                                             0786
         ST    @05,EODCT-4(@06)                                    0786
*     JOBNAME1 = NOTAPPLY;                                 /*@Z427VLS*/
*                                                                  0787
         MVC   JOBNAME1(8),NOTAPPLY                                0787
*/*EREPSEND  */                                                    0788
*       GO TO L000113;                                             0788
         B     L000113                                             0788
*     END;                                              /*@Z427VLS*/
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MDR TYPE RECORDS           @Z427VLS*/
*                                                                  0790
*/*EREPSUB  */                                                     0790
*L00019:                                                           0790
*     DO;                                               /*@Z427VLS*/
L00019   DS    0H                                                  0791
*    CALL TIME;                     /*GO FORMAT THE TIME FROM RECORD */
         BAL   @14,TIME                                            0791
*    CPU12 = EVLETTER(PTR);         /*MOVE IN THE LETTER FILT4 BUILT */
         L     @06,PTR                                             0792
         MH    @06,@CH00080                                        0792
         L     @05,EVPTR(,R2)                                      0792
         ALR   @05,@06                                             0792
         MVC   CPU12(1),EVLETTER-6(@05)                            0792
*    SWITCH1 = ON;                  /*SET SWITCH SO 1/2 BYTE IS DROP */
         OI    SWITCH1,B'10000000'                                 0793
*    NUMBER = TWO;                  /*SET TO PROCESS TWO BYTES       */
         L     @06,TWO                                             0794
         ST    @06,NUMBER                                          0794
*    ADDNXT = ADDR(CUA11);          /*SET UP THE ADDRESS TO PUT IT   */
         LA    @06,CUA11                                           0795
         ST    @06,ADDNXT                                          0795
*    NEXTBY = ADDR(TPRCUA);         /*SET UP WHERE TO FIND THE DATA  */
         LA    @06,TPRCUA(,R7)                                     0796
         ST    @06,NEXTBY                                          0796
*    CALL CONVERT;                  /*GO CONVERT THE DATA TO PRINT   */
         BAL   @14,CONVERT                                         0797
* DEVTYPE1 = UKNO;                                         /*@G51DGGB*/
         MVC   DEVTYPE1(4),UKNO                                    0798
* CALL IFCDEVIC(32,TPRDEV,DEVTYPE1);                       /*@G51DGGB*/
         MVC   @AL00001(12),@AL00799                               0799
         LA    @06,TPRDEV(,R7)                                     0799
         ST    @06,@AL00001+4                                      0799
         L     @15,@CV01456                                        0799
         LA    @01,@AL00001                                        0799
         BALR  @14,@15                                             0799
*    JOBNAME1 = NOTAPPLY;           /*DOES NOT APPLY FOR MDR RECORDS */
         MVC   JOBNAME1(8),NOTAPPLY                                0800
*    IF TPRDEV = '01'X             /*IS THIS A DASD DEVICE  @Z427VLS*/
*       TPRDEV = '02'X                                            0801
*       TPRDEV = '09'X                                            0801
*       TPRDEV = '0A'X                                            0801
*       TPRDEV = '0E'X                                            0801
*       TPRDEV = '11'X                                            0801
*       TPRDEV = '12'X                                             0801
*         THEN                                                     0801
         CLI   TPRDEV(R7),X'01'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'02'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'09'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'0A'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'0E'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'11'                                    0801
         BE    @RT00801                                            0801
         CLI   TPRDEV(R7),X'12'                                    0801
         BNE   @RF00801                                            0801
@RT00801 DS    0H                                                  0802
*           DO;                                            /*@Z427VLS*/
*    VOLUME1 = TPRVOL;              /*PUT IN THE VOLID       @Z427VLS*/
         MVC   VOLUME1(6),TPRVOL(R7)                               0803
*            RECTYP1 = MDRDAS;                             /*@Z427VLS*/
         MVC   RECTYP1(7),MDRDAS                                   0804
*            MDRDASCT(PTR) = MDRDASCT(PTR) + ONE;          /*@Z427VLS*/
         L     @06,PTR                                             0805
         SLA   @06,2                                               0805
         L     @05,MDRDASCT-4(@06)                                 0805
         AL    @05,ONE                                             0805
         ST    @05,MDRDASCT-4(@06)                                 0805
*            NUMBER = 16;            /*NUMBER OF BYTES TO DO @Z427VLS*/
         MVC   NUMBER(4),@CF00088                                  0806
*            NEXTBY = ADDR(TPRVOL) + (TPRBUFC &'0F'X) + 14;/*@Z427VLS*/
         LA    @06,TPRVOL(,R7)                                     0807
         LA    @05,15                                              0807
         SLR   @03,@03                                             0807
         IC    @03,TPRBUFC(,R7)                                    0807
         NR    @05,@03                                             0807
         ALR   @06,@05                                             0807
         AL    @06,@CF01462                                        0807
         ST    @06,NEXTBY                                          0807
*            ADDNXT = ADDR(TEMPSAVE);/*ADDRESS OF WHERE TO PUT IT    */
         LA    @06,TEMPSAVE                                        0808
         ST    @06,ADDNXT                                          0808
*            CALL CONVERT;           /*GO CONVERT TO PRINTABLE       */
         BAL   @14,CONVERT                                         0809
*            GENERATE;                                     /*@Z427VLS*/
              MVC  SENSEA3(8),TEMPSAVE
              MVC  SENSEA4(8),TEMPSAVE+8
              MVC  SENSEA5(8),TEMPSAVE+16
              MVC  SENSEA6(8),TEMPSAVE+24
*           END;                                           /*@Z427VLS*/
*          ELSE                                                    0812
*           DO;                                            /*@Z427VLS*/
         B     @RC00801                                            0812
@RF00801 DS    0H                                                  0813
*           MDRCT(PTR) = MDRCT(PTR) + ONE;                 /*@Z427VLS*/
         L     @06,PTR                                             0813
         SLA   @06,2                                               0813
         L     @05,MDRCT-4(@06)                                    0813
         AL    @05,ONE                                             0813
         ST    @05,MDRCT-4(@06)                                    0813
*           RECTYP1 = MDR;                                 /*@Z427VLS*/
         MVC   RECTYP1(7),MDR                                      0814
*           END;                                           /*@Z427VLS*/
*                                                                  0815
*/*EREPSEND  */                                                    0816
*       GO TO L000113;                                             0816
         B     L000113                                             0816
*     END;                                              /*@Z427VLS*/
*/*EREPSUB  */                                                     0818
*L000110:                                                          0818
*   DO;                                                 /*@G51DGGB*/
L000110  DS    0H                                                  0819
* CALL FRAME;                                              /*@G51DGGB*/
         BAL   @14,FRAME                                           0819
*/*EREPSEND  */                                                    0820
*     GO TO L000113;                                               0820
         B     L000113                                             0820
*   END;                                                /*@G51DGGB*/
*/*EREPSUB  */                                                     0822
*L000111:                                                          0822
*   DO;                                                 /*@G51DGGB*/
L000111  DS    0H                                                  0823
* CALL FRAME;                                              /*@G51DGGB*/
         BAL   @14,FRAME                                           0823
*/*EREPSEND  */                                                    0824
*     GO TO L000113;                                               0824
         B     L000113                                             0824
*   END;                                                /*@G51DGGB*/
*/*EREPCEND  */                                                    0826
*L000112:;                                                         0826
*L000113:;                                                /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00010 DS    0H                                                  0828
@EF00010 DS    0H                                                  0828
@ER00010 LM    @14,@12,@SA00010                                    0828
         BR    @14                                                 0828
*OBRISPRM: PROC;                                           /*@Z427VLS*/
OBRISPRM STM   @14,@12,@SA00011                                    0829
* /*******************************************************************/
*/** * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL PROCESS ALL OBR RECORDS WITH PERM ERROR       */
*       GEN(MVI  TEMPSAVE,X'40');                          /*@Z427VLS*/
         MVI  TEMPSAVE,X'40'
*       GEN(MVC  TEMPSAVE+1(71),TEMPSAVE);                 /*@Z427VLS*/
         MVC  TEMPSAVE+1(71),TEMPSAVE
*              NUMBER = 1;            /*SET UP TO DO 1 BYTE  @Z427VLS*/
         MVC   NUMBER(4),@CF00055                                  0832
*              ADDNXT = ADDR(CMD1);   /*SET UP FOR CCW FIRST BYTE    */
         LA    @06,CMD1                                            0833
         ST    @06,ADDNXT                                          0833
*              NEXTBY = ADDR(OBRSRDS);/*ADDRESS OF WHERE THE DATA IS */
         LA    @06,OBRSRDS(,R7)                                    0834
         ST    @06,NEXTBY                                          0834
*              CALL CONVERT;          /*GO CONVERT THE CCMDTTO PRINT */
         BAL   @14,CONVERT                                         0835
*       NUMBER = 2;                                        /*@Z427VLS*/
         MVC   NUMBER(4),@CF00073                                  0836
*       ADDNXT = ADDR(CSW1);          /*SET UP TO CONVERT THE CSW    */
         LA    @06,CSW1                                            0837
         ST    @06,ADDNXT                                          0837
*       NEXTBY = ADDR(OBRSTAT);       /*ADDRESS OF DATA TO CONVERT   */
         LA    @06,OBRSTAT(,R7)                                    0838
         ST    @06,NEXTBY                                          0838
*       CALL CONVERT;                 /*CALL TO CONVERT THE DATA     */
         BAL   @14,CONVERT                                         0839
*       NEXTBY = ADDR(OBRVOL) + EIGHT * OBRDEVDC  + OBRLSDRC;      0840
         LA    @06,OBRVOL(,R7)                                     0840
         SLR   @05,@05                                             0840
         IC    @05,OBRDEVDC(,R7)                                   0840
         SLA   @05,3                                               0840
         ALR   @06,@05                                             0840
         SLR   @05,@05                                             0840
         IC    @05,OBRLSDRC(,R7)                                   0840
         ALR   @06,@05                                             0840
         ST    @06,NEXTBY                                          0840
*       ADDNXT = ADDR(TEMPSAVE) ;     /*SET UP SPECIAL TO CONVERT TO */
         LA    @06,TEMPSAVE                                        0841
         ST    @06,ADDNXT                                          0841
*       NUMBER = OBRSBCNT;            /*SET UP NUMBER OF SENSE BYTES */
         SLR   @06,@06                                             0842
         ICM   @06,3,OBRSBCNT(R7)                                  0842
         ST    @06,NUMBER                                          0842
*       IF NUMBER > 40 THEN                                        0843
         LA    @05,40                                              0843
         CR    @06,@05                                             0843
         BNH   @RF00843                                            0843
*         NUMBER = 40;                                     /*@Z427VLS*/
         ST    @05,NUMBER                                          0844
*       CALL CONVERT;                 /*GO AND CONVERT THE NUMBERS   */
@RF00843 BAL   @14,CONVERT                                         0845
*       GENERATE;                                          /*@Z427VLS*/
          MVC    SENSEA1(8),TEMPSAVE
          MVC    SENSEA2(8),TEMPSAVE+8
          MVC    SENSEA3(8),TEMPSAVE+16
          MVC    SENSEA4(8),TEMPSAVE+24
          MVC    SENSEA5(8),TEMPSAVE+32
          MVC    SENSEA6(8),TEMPSAVE+40
          MVC    SENSEA7(8),TEMPSAVE+48
          MVC    SENSEA8(8),TEMPSAVE+56
*       IF OBRSBCNT ^> 24 THEN       /*HAVE WE MESSED UP REST OF LINE*/
         CLC   OBRSBCNT(2,R7),@CH00227                             0847
         BH    @RF00847                                            0847
*         DO;                                              /*@Z427VLS*/
*          IF OBRDEVDC ^= ZERO THEN  /*IF NO DEV DEP INFO DONT MOVE  */
         CLI   OBRDEVDC(R7),0                                      0849
         BE    @RF00849                                            0849
*           DO;                                            /*@Z427VLS*/
*            IF OBRCLASS = '80'X                                  0851
*                    OBRDEV = '0843'X                             0851
*               OBRDEV   = '0842'X                                0851
*               OBRCLASS = '20'X THEN                              0851
         CLI   OBRCLASS(R7),X'80'                                  0851
         BE    @RT00851                                            0851
         CLC   OBRDEV(2,R7),@CB01474                               0851
         BE    @RT00851                                            0851
         CLC   OBRDEV(2,R7),@CB01475                               0851
         BE    @RT00851                                            0851
         CLI   OBRCLASS(R7),X'20'                                  0851
         BNE   @RF00851                                            0851
@RT00851 DS    0H                                                  0852
*                 VOLUME1 = OBRVOL;                        /*@Z427VLS*/
         MVC   VOLUME1(6),OBRVOL(R7)                               0852
*           END;                                           /*@Z427VLS*/
@RF00851 DS    0H                                                  0854
*          IF OBRCLASS = '20'X THEN                                0854
@RF00849 CLI   OBRCLASS(R7),X'20'                                  0854
         BNE   @RF00854                                            0854
*           DO;                                            /*@Z427VLS*/
*           TEMPSAVE = TEMPSAVE && TEMPSAVE;/*CLEAR AREA     @Z427VLS*/
         XC    TEMPSAVE(84),TEMPSAVE                               0856
*           NUMBER = SEVEN;          /*SET UP TO CONVERT 7 BYTES     */
         L     @06,SEVEN                                           0857
         ST    @06,NUMBER                                          0857
*           NEXTBY = ADDR(OBRSEEK)+3;/*ADDRESS OF WHERE TO PUT DATA  */
         LA    @06,OBRSEEK(,R7)                                    0858
         AL    @06,@CF00075                                        0858
         ST    @06,NEXTBY                                          0858
*           ADDNXT = ADDR(TEMPSAVE); /*WHERE IT'S ALL AT     @Z427VLS*/
         LA    @06,TEMPSAVE                                        0859
         ST    @06,ADDNXT                                          0859
*           CALL CONVERT;            /*GO CONVERT THE DATA TO PRINT  */
         BAL   @14,CONVERT                                         0860
*           GENERATE;                                      /*@Z427VLS*/
              MVC    BB1(4),TEMPSAVE
              MVC    CC1(4),TEMPSAVE+4
              MVC    HH1(4),TEMPSAVE+8
              MVC    R111(2),TEMPSAVE+12
*           END;                                           /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
@EL00011 DS    0H                                                  0864
@EF00011 DS    0H                                                  0864
@ER00011 LM    @14,@12,@SA00011                                    0864
         BR    @14                                                 0864
*DODEVICE: PROC;                                           /*@Z427VLS*/
DODEVICE STM   @14,@12,@SA00012                                    0865
* DEVTYPE1 = UKNO;                  /*IF NO MATCH TELL EVERYONE      */
         MVC   DEVTYPE1(4),UKNO                                    0866
* CALL IFCDEVIC(22,DEVCOMP,DEVTYPE1);                      /*@G51DGGB*/
         L     @15,@CV01456                                        0867
         LA    @01,@AL00867                                        0867
         BALR  @14,@15                                             0867
*END;                                                      /*@Z427VLS*/
@EL00012 DS    0H                                                  0868
@EF00012 DS    0H                                                  0868
@ER00012 LM    @14,@12,@SA00012                                    0868
         BR    @14                                                 0868
*FRAME: PROC;                                              /*@G51DGGB*/
FRAME    STM   @14,@12,@SA00013                                    0869
* DCL FRAMEMCH  CHAR(7) INIT('FRM-MCH');                   /*@G51DGGB*/
* DCL FRAMECCH  CHAR(7) INIT('FRM-CCH');                   /*@G51DGGB*/
* DCL FRMTEMP  CHAR(7) INIT(' ');                          /*@G51DGGB*/
* DCL LAST CHAR(1) BASED(R7+6);                            /*@G51DGGB*/
* CALL TIME;            /*PUT THE TIME IN THE PRINTLINE      @G51DGGB*/
         BAL   @14,TIME                                            0874
* CPU12  = EVLETTER(PTR);                                  /*@G51DGGB*/
         L     @06,PTR                                             0875
         MH    @06,@CH00080                                        0875
         L     @05,EVPTR(,R2)                                      0875
         ALR   @05,@06                                             0875
         MVC   CPU12(1),EVLETTER-6(@05)                            0875
* IF CURRENT = 10 THEN                                             0876
         CLC   CURRENT(4),@CF00032                                 0876
         BNE   @RF00876                                            0876
*  RECTYP1 = FRAMEMCH;                                     /*@G51DGGB*/
         MVC   RECTYP1(7),FRAMEMCH                                 0877
* ELSE                                                             0878
*  RECTYP1 = FRAMECCH;                                     /*@G51DGGB*/
         B     @RC00876                                            0878
@RF00876 MVC   RECTYP1(7),FRAMECCH                                 0878
* NUMBER = THREE ;          /*SET FOR THREE BYTES TO BE CONVERTED*/
@RC00876 MVC   NUMBER(4),@CF00075                                  0879
* ADDNXT = ADDR(FRMTEMP);   /*ADDRESS OF THE TEMPORARY LOCATION  */
         LA    @06,FRMTEMP                                         0880
         ST    @06,ADDNXT                                          0880
* NEXTBY = R7 + 1865;       /*THE INFO IS IN THE LAST LINE OF THE */
         LA    @06,1865                                            0881
         ALR   @06,R7                                              0881
         ST    @06,NEXTBY                                          0881
* CALL CONVERT;             /*CONVERT THEE FRAME INFO TO PRINTABLE*/
         BAL   @14,CONVERT                                         0882
* GEN(MVC CUA12+2(2),FRMTEMP);/*MOVE THE GROUP NUMBER        @G51DGGB*/
         MVC CUA12+2(2),FRMTEMP
* GEN(MVC CUA12+10(2),FRMTEMP+2);/*MOVE THE FRAME NUMBER     @G51DGGB*/
         MVC CUA12+10(2),FRMTEMP+2
* GEN(MVC CUA12+19(2),FRMTEMP+4);/*MOVE THE EC LEVEL INTO THE PRINT L*/
         MVC CUA12+19(2),FRMTEMP+4
* BNDECNUM = 2;                                            /*@G51DGGB*/
         MVC   BNDECNUM(4),@CF00073                                0886
* BINWORD = LAST;                                          /*@G51DGGB*/
         SLR   @06,@06                                             0887
         IC    @06,LAST+6(,R7)                                     0887
         ST    @06,BINWORD                                         0887
* DECADDR= ADDR(SENSEA2);                                  /*@G51DGGB*/
         LA    @06,SENSEA2                                         0888
         ST    @06,DECADDR                                         0888
* CALL CONVBIN;                                            /*@G51DGGB*/
         BAL   @14,CONVBIN                                         0889
* IF (LRTSMS & '80'X) = '00'X THEN                                 0890
         MVC   @TS00001(1),LRTSMS(R7)                              0890
         NI    @TS00001,X'80'                                      0890
         CLI   @TS00001,X'00'                                      0890
         BNE   @RF00890                                            0890
*  GEN(MVI  SENSEA3,X'5C');                                /*@G51DGGB*/
         MVI  SENSEA3,X'5C'
*END;                                                      /*@G51DGGB*/
@EL00013 DS    0H                                                  0892
@EF00013 DS    0H                                                  0892
@ER00013 LM    @14,@12,@SA00013                                    0892
         BR    @14                                                 0892
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE WHICH HEADING TO PRINT      @Z427VLS*/
*HEADING:  PROC;                                           /*@Z427VLS*/
HEADING  STM   @14,@12,@SA00014                                    0893
*  IF MYLINECT > LINECT - TWO THEN   /*IS IT TIME FOR A NEW HEADING  */
         LH    @06,LINECT(,R2)                                     0894
         SL    @06,TWO                                             0894
         CH    @06,MYLINECT                                        0894
         BNL   @RF00894                                            0894
*      DO;                                                 /*@Z427VLS*/
*       MYLINECT = MINUS1;           /*RESET THE COUNT TO -1 @Z427VLS*/
         L     @06,MINUS1                                          0896
         STH   @06,MYLINECT                                        0896
*       SPACING = UPSPACE;           /*UP TO A NEW PAGE      @Z427VLS*/
         MVC   SPACING(1),UPSPACE                                  0897
*       CALL PRINTIT;                /*SPACE TO A NEW PAGE   @Z427VLS*/
         BAL   @14,PRINTIT                                         0898
*       SPACING = SINGLE;            /*RETURN TO NORMAL CC CONTROL   */
         MVC   SPACING(1),SINGLE                                   0899
*      END;                                                /*@Z427VLS*/
* IF DEBUG5 = ON                 /*DO THEY WANT HEADING FOR EACH REC */
*   THEN                                                           0901
@RF00894 TM    DEBUG5(R2),B'00000100'                              0901
         BNO   @RF00901                                            0901
*     CALL BUGHEAD;              /*GO DETERMINE THE TYPE OF HEADING  */
         BAL   @14,BUGHEAD                                         0902
*   ELSE                                                           0903
*     CALL TYPEHEAD;             /*GO OUTPUT THE NORMAL HEADING      */
         B     @RC00901                                            0903
@RF00901 BAL   @14,TYPEHEAD                                        0903
* DUPLICAT = LINE04;                 /*THIS PART OF HEADING IS STAND */
@RC00901 MVC   DUPLICAT(33),LINE04                                 0904
* CALL PRINTIT;                  /*PRINT OUT HEADING SELECTED        */
         BAL   @14,PRINTIT                                         0905
*IF DEBUG5 = OFF &            /*PUT DATE AT THE TOP OF THE PAGE */ 0906
*   Y ^= ZERO THEN            /*NOT FIRST TIME THROUGH       @0001VLS*/
         TM    DEBUG5(R2),B'00000100'                              0906
         BNZ   @RF00906                                            0906
         L     @06,Y                                               0906
         LTR   @06,@06                                             0906
         BZ    @RF00906                                            0906
* CALL NEWDATE;               /*PRINT THE DATE OF CURRENT RECORD*/ 0907
         BAL   @14,NEWDATE                                         0907
*END;                                                      /*@Z427VLS*/
@EL00014 DS    0H                                                  0908
@EF00014 DS    0H                                                  0908
@ER00014 LM    @14,@12,@SA00014                                    0908
         BR    @14                                                 0908
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MCH TYPE HEADERS           @Z427VLS*/
*MCHHEDER:  PROC;                                          /*@Z427VLS*/
MCHHEDER STM   @14,@12,12(@13)                                     0909
*DCL PSWMCH1 CHAR(77) DEFINED(PSWMCH);                     /*@0098VLS*/
*PSWMCH1 = LINE8;                                          /*@0098VLS*/
         MVC   PSWMCH1(77),LINE8                                   0911
*END;                                                      /*@Z427VLS*/
@EL00015 DS    0H                                                  0912
@EF00015 DS    0H                                                  0912
@ER00015 LM    @14,@12,12(@13)                                     0912
         BR    @14                                                 0912
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL CHH TYPE HEADERS           @Z427VLS*/
*CCHHEDER: PROC;                                           /*@Z427VLS*/
CCHHEDER STM   @14,@12,12(@13)                                     0913
*   CCHFINSH = LINE1;             /*SET UP REST OF CCH HEADING       */
         MVC   CCHFINSH(18),LINE1                                  0914
*END;                                                      /*@Z427VLS*/
@EL00016 DS    0H                                                  0915
@EF00016 DS    0H                                                  0915
@ER00016 LM    @14,@12,12(@13)                                     0915
         BR    @14                                                 0915
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL OBR TYPE HEADERS           @Z427VLS*/
*OBRHEDER: PROC;                                           /*@Z427VLS*/
OBRHEDER STM   @14,@12,12(@13)                                     0916
*   OBRFINSH = LINE5;             /*SET UP THE REST OF OBR HEADING   */
         MVC   OBRFINSH(98),LINE5                                  0917
*END;                                                      /*@Z427VLS*/
@EL00017 DS    0H                                                  0918
@EF00017 DS    0H                                                  0918
@ER00017 LM    @14,@12,12(@13)                                     0918
         BR    @14                                                 0918
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL SFT TYPE HEADERS           @Z427VLS*/
*SFTHEDER: PROC;                                           /*@Z427VLS*/
SFTHEDER STM   @14,@12,12(@13)                                     0919
* SFTFINSH = LINE66;                                       /*@0098VLS*/
         MVC   SFTFINSH(78),LINE66                                 0920
*END;                                                      /*@Z427VLS*/
@EL00018 DS    0H                                                  0921
@EF00018 DS    0H                                                  0921
@ER00018 LM    @14,@12,12(@13)                                     0921
         BR    @14                                                 0921
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL IPL TYPE HEADERS           @Z427VLS*/
*IPLHEDER: PROC;                                           /*@Z427VLS*/
IPLHEDER STM   @14,@12,12(@13)                                     0922
*   IPLFINSH = LINE7;             /*SET UP THE REST OF IPL HEADING   */
         MVC   IPLFINSH(17),LINE7                                  0923
*END;                                                      /*@Z427VLS*/
@EL00019 DS    0H                                                  0924
@EF00019 DS    0H                                                  0924
@ER00019 LM    @14,@12,12(@13)                                     0924
         BR    @14                                                 0924
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL DDR TYPE HEADERS           @Z427VLS*/
*DDRHEDER: PROC;                                           /*@Z427VLS*/
DDRHEDER STM   @14,@12,@SA00020                                    0925
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF IPL HEADING   */
         MVC  CUA12(104),LINE3
*END;                                                      /*@Z427VLS*/
@EL00020 DS    0H                                                  0927
@EF00020 DS    0H                                                  0927
@ER00020 LM    @14,@12,@SA00020                                    0927
         BR    @14                                                 0927
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MIH TYPE HEADERS           @Z427VLS*/
*MIHHEDER: PROC;                                           /*@Z427VLS*/
MIHHEDER STM   @14,@12,@SA00021                                    0928
*   GEN(MVC  CUA12(104),LINE3);   /*SET UP THE REST OF DDR HEADING   */
         MVC  CUA12(104),LINE3
*END;                                                      /*@Z427VLS*/
@EL00021 DS    0H                                                  0930
@EF00021 DS    0H                                                  0930
@ER00021 LM    @14,@12,@SA00021                                    0930
         BR    @14                                                 0930
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL EOD TYPE HEADERS           @Z427VLS*/
*EODHEDER: PROC;                                           /*@Z427VLS*/
EODHEDER STM   @14,@12,12(@13)                                     0931
*    /*NOTHING IS REQUIRED AT THIS TIME                      @Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00022 DS    0H                                                  0932
@EF00022 DS    0H                                                  0932
@ER00022 LM    @14,@12,12(@13)                                     0932
         BR    @14                                                 0932
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL HANDLE ALL MDR TYPE HEADERS           @Z427VLS*/
*MDRHEDER: PROC;                                           /*@Z427VLS*/
MDRHEDER STM   @14,@12,12(@13)                                     0933
*   NEWMDR   = LINE3;        /*SAME AS DDR TYPE RECORD       @Z427VLS*/
         MVC   NEWMDR(104),LINE3                                   0934
*END;                                                      /*@Z427VLS*/
@EL00023 DS    0H                                                  0935
@EF00023 DS    0H                                                  0935
@ER00023 LM    @14,@12,12(@13)                                     0935
         BR    @14                                                 0935
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL MDR & OBR TYPE HEADERS     @Z427VLS*/
*MDROBRHD: PROC;                                           /*@Z427VLS*/
MDROBRHD STM   @14,@12,@SA00024                                    0936
*   LINE44 = LINE4;                                        /*@Z427VLS*/
         MVC   LINE44(82),LINE4                                    0937
*   CALL PRINTIT;            /*THIS ONE HAS AN EXTRA LINE    @Z427VLS*/
         BAL   @14,PRINTIT                                         0938
*   MDROBRLN = MDRLINE;      /*SET UP THE SECOND LINE OF OUTPUT      */
         MVC   MDROBRLN(35),MDRLINE                                0939
*END;                                                      /*@Z427VLS*/
@EL00024 DS    0H                                                  0940
@EF00024 DS    0H                                                  0940
@ER00024 LM    @14,@12,@SA00024                                    0940
         BR    @14                                                 0940
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS CASE WILL HANDLE ALL STANDARD HEADERS           @Z427VLS*/
*COMMONHD: PROC;                                           /*@Z427VLS*/
COMMONHD STM   @14,@12,@SA00025                                    0941
*   LINE0006 = LINE6;        /*SET UP THE FIRST OF COMMON HEADER     */
         MVC   LINE0006(78),LINE6                                  0942
*   CALL PRINTIT;            /*GO PRINT THE LINE             @Z427VLS*/
         BAL   @14,PRINTIT                                         0943
*   OBRFINSH = LINE5;        /*SET UP THE SECOND LINE        @Z427VLS*/
         MVC   OBRFINSH(98),LINE5                                  0944
*END;                                                      /*@Z427VLS*/
@EL00025 DS    0H                                                  0945
@EF00025 DS    0H                                                  0945
@ER00025 LM    @14,@12,@SA00025                                    0945
         BR    @14                                                 0945
* /***************************************************************/
* /*    THIS PROC WILL OUTPUT THE FRAME HEADER               @G51DGGB*/
*FRMHEDER: PROC;                                           /*@G51DGGB*/
FRMHEDER STM   @14,@12,12(@13)                                     0946
*DCL LINEFRAM CHAR(43)                                             0947
* INIT('GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG');     /*@G51DGGB*/
*DCL LINEFRM1 CHAR(43) DEFINED(CUA12);                     /*@G51DGGB*/
* LINEFRM1 = LINEFRAM;      /*MOVE THE FRAME HEADER IN TO THE LINE*/
         MVC   LINEFRM1(43),LINEFRAM                               0949
*END;                                                      /*@G51DGGB*/
@EL00026 DS    0H                                                  0950
@EF00026 DS    0H                                                  0950
@ER00026 LM    @14,@12,12(@13)                                     0950
         BR    @14                                                 0950
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE WHICH TYPE HEADING TO PRINT @Z427VLS*/
* /*                                                         @Z427VLS*/
*BUGHEAD: PROC;                                            /*@Z427VLS*/
BUGHEAD  STM   @14,@12,@SA00027                                    0951
*  R8 = CURRENT;                       /*PICK UP THE RECORD TYPE     */
         L     R8,CURRENT                                          0952
*  IF R8 = ONE                         /*IS IT A MCH RECORD  @Z427VLS*/
*    THEN                                                          0953
         C     R8,ONE                                              0953
         BNE   @RF00953                                            0953
*      CALL MCHHEDER;                  /*GO SET UP MCH HEADER        */
         BAL   @14,MCHHEDER                                        0954
*    ELSE                                                          0955
*     IF R8 = TWO                      /*IS IT A CCH TYPE RECORD     */
*      THEN                                                        0955
         B     @RC00953                                            0955
@RF00953 C     R8,TWO                                              0955
         BNE   @RF00955                                            0955
*       CALL CCHHEDER;                 /*GO SET UP CCH HEADER        */
         BAL   @14,CCHHEDER                                        0956
*      ELSE                                                        0957
*       IF R8 = THREE                  /*IS IT MCH TYPE RECORD       */
*        THEN                                                      0957
         B     @RC00955                                            0957
@RF00955 C     R8,@CF00075                                         0957
         BNE   @RF00957                                            0957
*         CALL OBRHEDER;               /*GO FORMATE THE OBR HEADER   */
         BAL   @14,OBRHEDER                                        0958
*        ELSE                                                      0959
*         IF R8 = FOUR                 /*IS IT A SOFTWARE RECORD     */
*          THEN                                                    0959
         B     @RC00957                                            0959
@RF00957 C     R8,@CF00035                                         0959
         BNE   @RF00959                                            0959
*           CALL SFTHEDER;             /*FORMATE THE SOFTWARE HEADER */
         BAL   @14,SFTHEDER                                        0960
*          ELSE                                                    0961
*           IF R8 = FIVE               /*IS THE RECORD AN IPL TYPE   */
*            THEN                                                  0961
         B     @RC00959                                            0961
@RF00959 C     R8,FIVE                                             0961
         BNE   @RF00961                                            0961
*             CALL IPLHEDER;           /*FORMATE IPL HEADER  @Z427VLS*/
         BAL   @14,IPLHEDER                                        0962
*            ELSE                                                  0963
*             IF R8 = SIX              /*IS THE RECORD AN DDR RECORD */
*              THEN                                                0963
         B     @RC00961                                            0963
@RF00961 C     R8,SIX                                              0963
         BNE   @RF00963                                            0963
*               CALL DDRHEDER;         /*FORMAT HEADER FOR DDR RECORD*/
         BAL   @14,DDRHEDER                                        0964
*              ELSE                                                0965
*               IF R8 = SEVEN          /*IS THE RECORD AN MIH RECORD */
*                THEN                                              0965
         B     @RC00963                                            0965
@RF00963 C     R8,SEVEN                                            0965
         BNE   @RF00965                                            0965
*                 CALL MIHHEDER;       /*FORMAT TH HEADER FOR MIH REC*/
         BAL   @14,MIHHEDER                                        0966
*                ELSE                                              0967
*                 IF R8 = EIGHT        /*IS THE RECORD AN EOD RECORD */
*                  THEN                                            0967
         B     @RC00965                                            0967
@RF00965 C     R8,@CF00065                                         0967
         BNE   @RF00967                                            0967
*                   CALL EODHEDER;     /*FORMAT FOR EOD RRECORD      */
         BAL   @14,EODHEDER                                        0968
*                  ELSE                                            0969
*                   IF R8 = NINE       /*IS RECORD AN MDR TYPE       */
*                    THEN                                          0969
         B     @RC00967                                            0969
@RF00967 C     R8,@CF00085                                         0969
         BNE   @RF00969                                            0969
*                     CALL MDRHEDER;   /*FORMAT FOR AN MDR TYPE      */
         BAL   @14,MDRHEDER                                        0970
*                     ELSE                                         0971
*                      IF R8 = TEN  /*REC IS A MCF TYPE RECORD*/  0971
*                         R8 = 11     THEN/*IS A CCF TYPE OF RECORD*/
         B     @RC00969                                            0971
@RF00969 C     R8,TEN                                              0971
         BE    @RT00971                                            0971
         C     R8,@CF00033                                         0971
         BNE   @RF00971                                            0971
@RT00971 DS    0H                                                  0972
*                          CALL FRMHEDER; /*PRINT THE FRAME HEADER*/
         BAL   @14,FRMHEDER                                        0972
*                    ELSE                                          0973
*                     CALL COMMONHD;   /*SHOULD NOT OCCUR BUT JUST IN*/
         B     @RC00971                                            0973
@RF00971 BAL   @14,COMMONHD                                        0973
*END;                                                      /*@Z427VLS*/
@EL00027 DS    0H                                                  0974
@EF00027 DS    0H                                                  0974
@ER00027 LM    @14,@12,@SA00027                                    0974
         BR    @14                                                 0974
* /*******************************************************************/
* /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
* /*    THIS PROC WILL DETERMINE THE HEADING TO USE IN NORMAL OPERATI*/
*TYPEHEAD: PROC;                                           /*@Z427VLS*/
TYPEHEAD STM   @14,@12,@SA00028                                    0975
*  RTYP =(RECTYPE & 'FF80'X);                              /*@G51DGGB*/
         L     @06,@CF01557                                        0976
         LH    @05,RECTYPE(,R2)                                    0976
         N     @05,@CF01587                                        0976
         NR    @06,@05                                             0976
         ST    @06,RTYP                                            0976
*  IF RTYP = '8000'X                   /*IS IT AN MDR TYPE   @Z427VLS*/
*   THEN                                                           0977
         C     @06,@CF00198                                        0977
         BNE   @RF00977                                            0977
*    CALL MCHHEDER;                    /*FORMAT FOR AN MCH RECORD    */
         BAL   @14,MCHHEDER                                        0978
*   ELSE                                                           0979
*    IF RTYP = '4000'X                 /*IS THE RECORD AN CCH TYPE   */
*     THEN                                                         0979
         B     @RC00977                                            0979
@RF00977 CLC   RTYP(4),@CF01558                                    0979
         BNE   @RF00979                                            0979
*      CALL CCHHEDER;                  /*FORMAT HEADER FOR AN CCH    */
         BAL   @14,CCHHEDER                                        0980
*     ELSE                                                         0981
*      IF RTYP = '2000'X               /*IS THE RECORD TYPE AN OBR   */
*       THEN                                                       0981
         B     @RC00979                                            0981
@RF00979 CLC   RTYP(4),@CF01559                                    0981
         BNE   @RF00981                                            0981
*        CALL OBRHEDER;                /*FORMAT FOR AN OBR RECORD    */
         BAL   @14,OBRHEDER                                        0982
*       ELSE                                                       0983
*        IF RTYP = '1000'X                                         0983
*         THEN                                                     0983
         B     @RC00981                                            0983
@RF00981 CLC   RTYP(4),@CF01560                                    0983
         BNE   @RF00983                                            0983
*          CALL SFTHEDER;              /*FORMAT FOR SFT TYPE @Z427VLS*/
         BAL   @14,SFTHEDER                                        0984
*         ELSE                                                     0985
*          IF RTYP = '0800'X                                       0985
*           THEN                                                   0985
         B     @RC00983                                            0985
@RF00983 CLC   RTYP(4),@CF01561                                    0985
         BNE   @RF00985                                            0985
*            CALL IPLHEDER;            /*FORMAT FOR IPL RECORD       */
         BAL   @14,IPLHEDER                                        0986
*           ELSE                                                   0987
*            IF RTYP = '0400'X         /*IS THE RECORD SELECTION DDR */
*             THEN                                                 0987
         B     @RC00985                                            0987
@RF00985 CLC   RTYP(4),@CF01562                                    0987
         BNE   @RF00987                                            0987
*              CALL DDRHEDER;          /*FORMAT FOR AN DDR TYPE      */
         BAL   @14,DDRHEDER                                        0988
*             ELSE                                                 0989
*              IF RTYP = '0200'X       /*IS THE RECORD SELECTION MIH */
*               THEN                                               0989
         B     @RC00987                                            0989
@RF00987 CLC   RTYP(4),@CF01563                                    0989
         BNE   @RF00989                                            0989
*                CALL MIHHEDER;        /*FORMAT FOR AN MIH TYPE      */
         BAL   @14,MIHHEDER                                        0990
*               ELSE                                               0991
*                IF RTYP = '0100'X     /*IS THE RECORD SELECTION EOD */
*                 THEN                                             0991
         B     @RC00989                                            0991
@RF00989 CLC   RTYP(4),@CF00102                                    0991
         BNE   @RF00991                                            0991
*                  CALL EODHEDER;      /*FORMAT FOR AN EOD TYPE      */
         BAL   @14,EODHEDER                                        0992
*                 ELSE                                             0993
*                  IF RTYP = '0080'X                               0993
*                   THEN                                           0993
         B     @RC00991                                            0993
@RF00991 CLC   RTYP(4),@CF01564                                    0993
         BNE   @RF00993                                            0993
*                    CALL MDRHEDER;    /*FORMAT FOR AN MDR TYPE      */
         BAL   @14,MDRHEDER                                        0994
*                   ELSE                                           0995
*                    IF RTYP = '2080'X                             0995
*                     THEN                                         0995
         B     @RC00993                                            0995
@RF00993 CLC   RTYP(4),@CF01565                                    0995
         BNE   @RF00995                                            0995
*                      CALL MDROBRHD;  /*FORMAT FOR COMB MDR-OBR TYPE*/
         BAL   @14,MDROBRHD                                        0996
*                     ELSE                                         0997
*                      IF DEBUG47 = ON                            0997
*                         DEBUG46 = ON THEN                        0997
         B     @RC00995                                            0997
@RF00995 TM    DEBUG47(R2),B'00000011'                             0997
         BZ    @RF00997                                            0997
*                          CALL FRMHEDER;                  /*@G51DGGB*/
         BAL   @14,FRMHEDER                                        0998
*                     ELSE                                         0999
*                      CALL COMMONHD;  /*JUST COMMON OLD HEADING     */
         B     @RC00997                                            0999
@RF00997 BAL   @14,COMMONHD                                        0999
*END;                                                      /*@Z427VLS*/
*                                                                  1000
@EL00028 DS    0H                                                  1000
@EF00028 DS    0H                                                  1000
@ER00028 LM    @14,@12,@SA00028                                    1000
         BR    @14                                                 1000
*/********************************************************************/
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*    THIS PROC WILL DEVELOPE THE TABLE OF CPU SERIAL AND MODEL     */
*/*    NUMBERS AND PRINT IT. THIS WILL BE THE LAST THING PRINTED     */
*/*                                                          @Z427VLS*/
*CPUINFO: PROC;                                            /*@Z427VLS*/
CPUINFO  STM   @14,@12,@SA00029                                    1001
*  SPACING = DOUBLE ;                                      /*@Z427VLS*/
         MVC   SPACING(1),DOUBLE                                   1002
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1003
*  CPULINE1 = CPULINE;           /*SET UP THE HEADING FOR CPU SERIAL */
         MVC   CPULINE1(24),CPULINE                                1004
*  CALL PRINTIT;                 /*GO AND PRINT IT           @Z427VLS*/
         BAL   @14,PRINTIT                                         1005
*  SPACING = SINGLE;                                       /*@Z427VLS*/
         MVC   SPACING(1),SINGLE                                   1006
*  DO I = 1 BY 1 TO EVNUM;    /*SET UP TO PROCESS ALL CPUS   @Z427VLS*/
         LA    @06,1                                               1007
         ST    @06,I                                               1007
         B     @DE01007                                            1007
@DL01007 DS    0H                                                  1008
*   CPUTYPE = EVLETTER(I);       /*SET IN ACTUAL LETTER      @Z427VLS*/
         MH    @06,@CH00080                                        1008
         L     @05,EVPTR(,R2)                                      1008
         ST    @06,@TF00001                                        1008
         ALR   @06,@05                                             1008
         MVC   CPUTYPE(1),EVLETTER-6(@06)                          1008
*   NUMBER= TWO;                 /*SET FOR TWO BYTES         @Z427VLS*/
         L     @06,TWO                                             1009
         ST    @06,NUMBER                                          1009
*   ADDNXT = ADDR(CPUMODEL);     /*WHERE THE INFO IS TO BE PLACED    */
         LA    @06,CPUMODEL                                        1010
         ST    @06,ADDNXT                                          1010
*   NEXTBY = ADDR(EVMODEL(I));   /*ADDRESS WHERE THE DATA IS @Z427VLS*/
         L     @06,@TF00001                                        1011
         LA    @06,EVMODEL-6(@06,@05)                              1011
         ST    @06,NEXTBY                                          1011
*   CALL CONVERT;                /*GO AND CONVERT THE DATA   @Z427VLS*/
         BAL   @14,CONVERT                                         1012
*   ADDNXT = ADDR(CPUSERAL);     /*WHERE TO PUT THE SERIAL DATA      */
         LA    @06,CPUSERAL                                        1013
         ST    @06,ADDNXT                                          1013
*   NEXTBY = ADDR(EVSERIAL(I));  /*WHERE THE SERIAL INFO IS KEPT     */
         L     @06,I                                               1014
         MH    @06,@CH00080                                        1014
         L     @05,EVPTR(,R2)                                      1014
         LA    @06,EVSERIAL-6(@06,@05)                             1014
         ST    @06,NEXTBY                                          1014
*   NUMBER = THREE;              /*SET UP FOR THREE IN SIX OUT       */
         MVC   NUMBER(4),@CF00075                                  1015
*   CALL CONVERT ;               /*GO CONVERT THE SERIAL TO PRINTABLE*/
         BAL   @14,CONVERT                                         1016
*   PRTLINE1 = CPUDATA;          /*MOVE CPU DATA TO THE PRINT LINE   */
         MVI   PRTLINE1+22,C' '                                    1017
         MVC   PRTLINE1+23(79),PRTLINE1+22                         1017
         MVC   PRTLINE1(22),CPUDATA                                1017
*   CALL PRINTIT;                /*GO PRINT WHAT WE FOUND    @Z427VLS*/
         BAL   @14,PRINTIT                                         1018
*  END;                                                    /*@Z427VLS*/
         LA    @06,1                                               1019
         AL    @06,I                                               1019
         ST    @06,I                                               1019
@DE01007 L     @05,EVPTR(,R2)                                      1019
         CH    @06,EVNUM(,@05)                                     1019
         BNH   @DL01007                                            1019
*  SPACING = SINGLE;             /*RESTORE SPACING CONTROL TO 1      */
         MVC   SPACING(1),SINGLE                                   1020
* END;                                                     /*@Z427VLS*/
@EL00029 DS    0H                                                  1021
@EF00029 DS    0H                                                  1021
@ER00029 LM    @14,@12,@SA00029                                    1021
         BR    @14                                                 1021
*/********************************************************************/
*/*       THIS PROC WILL DETERMINE THE INDEX FOR ALL FOLLOWING WORK  */
*/*       IT IS BASED ON MATCHING THE SERIAL AND CPU WITH EV TABLE   */
* CPULETER: PROC;                                          /*@Z427VLS*/
CPULETER STM   @14,@12,12(@13)                                     1022
*   SWITCH3 = OFF;               /*TURN THE SWITCH OFF PRIOR TO START*/
         NI    SWITCH3,B'11011111'                                 1023
*   PTR = ZERO;                  /*START AT ZERO             @Z427VLS*/
         SLR   @06,@06                                             1024
         ST    @06,PTR                                             1024
*   DO S = 1 BY 1 TO 16 WHILE(SWITCH3 = OFF);          /*    @ZA19014*/
         LA    @06,1                                               1025
         ST    @06,S                                               1025
@DL01025 TM    SWITCH3,B'00100000'                                 1025
         BNZ   @DC01025                                            1025
*     IF EVSERIAL(S) = LRTCPUS   /*DO THE SERIALS MATCH      @Z427VLS*/
*        &  EVMODEL(S) = LRTMODEL/*AND THE MODEL # MATCHES   @Z427VLS*/
*          THEN                                                    1026
         LR    @05,@06                                             1026
         MH    @05,@CH00080                                        1026
         L     @03,EVPTR(,R2)                                      1026
         ST    @05,@TF00001                                        1026
         ALR   @05,@03                                             1026
         CLC   EVSERIAL-6(3,@05),LRTCPUS(R7)                       1026
         BNE   @RF01026                                            1026
         AL    @03,@TF00001                                        1026
         CLC   EVMODEL-6(2,@03),LRTMODEL(R7)                       1026
         BNE   @RF01026                                            1026
*           DO;                                            /*@Z427VLS*/
*            PTR = S;            /*SET THE INDEX FOR FOLLOWING PROCS */
         ST    @06,PTR                                             1028
*            SWITCH3 = ON;       /* SET TO EXIT THE LOOP     @Z427VLS*/
         OI    SWITCH3,B'00100000'                                 1029
*           END;                                           /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
@RF01026 LA    @06,1                                               1031
         AL    @06,S                                               1031
         ST    @06,S                                               1031
         C     @06,@CF00088                                        1031
         BNH   @DL01025                                            1031
@DC01025 DS    0H                                                  1032
*                                /*FILT4 DROPS THE BALL BUT JUST IN -*/
* END;                                                     /*@Z427VLS*/
@EL00030 DS    0H                                                  1032
@EF00030 DS    0H                                                  1032
@ER00030 LM    @14,@12,12(@13)                                     1032
         BR    @14                                                 1032
@PB00030 DS    0H                                                  1033
*/********************************************************************/
*/********************************************************************/
*/*******************PRIME LOOP***************************************/
*/*                                                          @Z427VLS*/
* IF DEBUG4 = ON THEN           /*PRINT NAME AND COMPILE DATE        */
         TM    DEBUG4(R2),B'00001000'                              1033
         BNO   @RF01033                                            1033
* DO;                                                      /*@Z427VLS*/
*  R9 = R10 -27;                                           /*@Z427VLS*/
         LR    R9,R10                                              1035
         SL    R9,@CF01574                                         1035
*  GEN(MVC  TIME1(16),0(R9));    /*MOVE IN NAME & COMPILE DATE      */
         MVC  TIME1(16),0(R9)
*  CALL PRINTIT;                                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1037
* END;                                                     /*@Z427VLS*/
* DDNAME = '0';                 /*DIRECT BACK TO NORMAL DD SET      */
@RF01033 MVI   DDNAME,C'0'                                         1039
* IF DEBUG6 ^= ON & DEBUG24 ^= ON THEN                             1040
         TM    DEBUG6(R2),B'00000010'                              1040
         BO    @RF01040                                            1040
         TM    DEBUG24(R2),B'10000000'                             1040
         BO    @RF01040                                            1040
* DO;                                                      /*@Z427VLS*/
*IF DEBUG47 ^= ON THEN                                             1042
         TM    DEBUG47(R2),B'00000001'                             1042
         BO    @RF01042                                            1042
* CALL TEMPLATE;                /*GO PRINT OUT THE TEMPLATE  @Z427VLS*/
         BAL   @14,TEMPLATE                                        1043
* CALL MAINHEAD;                /*GO PRINT MAIN HEADING      @Z427VLS*/
@RF01042 BAL   @14,MAINHEAD                                        1044
* IF DEBUG5 ^= ON THEN                                             1045
         TM    DEBUG5(R2),B'00000100'                              1045
         BO    @RF01045                                            1045
*  CALL HEADING;                                           /*@Z427VLS*/
         BAL   @14,HEADING                                         1046
* END;                                                     /*@Z427VLS*/
@RF01045 DS    0H                                                  1048
* DO Y = 1 BY 1 TO SORTNUM;     /*SET UP INDEX TO PROCESS ALL ITEMS  */
@RF01040 LA    @06,1                                               1048
         ST    @06,Y                                               1048
         B     @DE01048                                            1048
@DL01048 DS    0H                                                  1049
*  RECCCHHR = SORTCCHR(Y);      /*SET UP FOR THE DIRECT READ @Z427VLS*/
         MH    @06,@CH00032                                        1049
         L     @05,SORTADR(,R2)                                    1049
         ALR   @05,@06                                             1049
         AL    @05,@CF01590                                        1049
         MVC   RECCCHHR(5,R2),SORTCCHR-5(@05)                      1049
*  CALL IOHND(READIRCT);                                   /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    1050
         LA    @01,@AL01050                                        1050
         BALR  @14,@15                                             1050
*  IF R15 = ZERO THEN           /*DON'T PROCESS IF READ ERROR        */
         LTR   R15,R15                                             1051
         BNZ   @RF01051                                            1051
*   DO;                                                    /*@Z427VLS*/
*    R8 = LRTKEY1;              /*PICK UP THE RECORD TYPE    @Z427VLS*/
         SLR   R8,R8                                               1053
         IC    R8,LRTKEY1(,R7)                                     1053
*    SRL (R8,FOUR);             /*DROP THE UNWANTED BITS FROM THE TYP*/
         SRL   R8,4                                                1054
*    CURRENT = R8;              /*SAVE FOR AN INDEX VALUE    @Z427VLS*/
         ST    R8,CURRENT                                          1055
*  IF(DEBUG5 = ON              /*PRINT HEADING FOR EACH RECORD      */
*  MYLINECT > LINECT) &         /*CHECK IF NEW PAGE IS REQUIRED*/  1056
*     DEBUG24 ^= ON                                                1056
*     THEN                                                         1056
         TM    DEBUG5(R2),B'00000100'                              1056
         BO    @GL00027                                            1056
         LH    @06,MYLINECT                                        1056
         CH    @06,LINECT(,R2)                                     1056
         BNH   @RF01056                                            1056
@GL00027 TM    DEBUG24(R2),B'10000000'                             1056
         BO    @RF01056                                            1056
*       CALL HEADING;           /*GO PRINT THE HEADING       @Z427VLS*/
         BAL   @14,HEADING                                         1057
*  CALL CPULETER;                                          /*@Z427VLS*/
@RF01056 BAL   @14,CPULETER                                        1058
*  IF LASTDATE ^= LRTDATE & DEBUG6 = OFF                           1059
*     THEN                                                         1059
         CLC   LASTDATE(4),LRTDATE(R7)                             1059
         BE    @RF01059                                            1059
         TM    DEBUG6(R2),B'00000010'                              1059
         BNZ   @RF01059                                            1059
*       CALL NEWDATE;           /*GO PRINT THE NEW DATE      @Z427VLS*/
         BAL   @14,NEWDATE                                         1060
*  IF PTR ^= ZERO THEN          /*DON'T LET A ZERO INDEX SLIP BY     */
@RF01059 L     @06,PTR                                             1061
         LTR   @06,@06                                             1061
         BZ    @RF01061                                            1061
*   DO;                                                    /*@Z427VLS*/
*    CALL MOVEDATA;             /*MOVE THE DATA INTO THE PRINT LINE  */
         BAL   @14,MOVEDATA                                        1063
*    IF DEBUG6 = OFF & DEBUG24 = OFF THEN  /* IF TRUE DON'T PRINT    */
         TM    DEBUG6(R2),B'00000010'                              1064
         BNZ   @RF01064                                            1064
         TM    DEBUG24(R2),B'10000000'                             1064
         BNZ   @RF01064                                            1064
*      CALL PRINTIT;            /*GO PRINT OUT THE DATA LINE @Z427VLS*/
         BAL   @14,PRINTIT                                         1065
*   END;                                                   /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
* ELSE                                                             1068
*  BADRECRD = BADRECRD + ONE;   /*ADD 1 TO NUMBER OF READ FAILURES   */
         B     @RC01051                                            1068
@RF01051 L     @06,BADRECRD                                        1068
         AL    @06,ONE                                             1068
         ST    @06,BADRECRD                                        1068
* IF DEBUG17 = ON &R15 = ZERO THEN/*   WANTS A HEX DUMP OF EACH REC. */
@RC01051 TM    DEBUG17(R2),B'01000000'                             1069
         BNO   @RF01069                                            1069
         SLR   @14,@14                                             1069
         CR    R15,@14                                             1069
         BNE   @RF01069                                            1069
*  DO;                                                     /*@Z427VLS*/
*   MYLINECT = ZERO;            /*DON'T LET UP SPACE GET IN ACTION   */
         STH   @14,MYLINECT                                        1071
*   NUMBER = 66;                                           /*@Z427VLS*/
         LA    @06,66                                              1072
         ST    @06,NUMBER                                          1072
*   ADDNXT = ADDR(TIME1);                                  /*@Z427VLS*/
         LA    @05,TIME1                                           1073
         ST    @05,ADDNXT                                          1073
*   NEXTBY = R7;                                           /*@Z427VLS*/
         ST    R7,NEXTBY                                           1074
*   DO T = 66 BY 66 TO RECLNGTH;                           /*@Z427VLS*/
         ST    @06,T                                               1075
         B     @DE01075                                            1075
@DL01075 DS    0H                                                  1076
*    CALL CONVERT;                                         /*@Z427VLS*/
         BAL   @14,CONVERT                                         1076
*    NEXTBY = NEXTBY + 66;                                 /*@Z427VLS*/
         LA    @06,66                                              1077
         AL    @06,NEXTBY                                          1077
         ST    @06,NEXTBY                                          1077
*    CALL PRINTIT;                                         /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1078
*   END;                                                   /*@Z427VLS*/
         LA    @06,66                                              1079
         AL    @06,T                                               1079
         ST    @06,T                                               1079
@DE01075 CH    @06,RECLNGTH(,R2)                                   1079
         BNH   @DL01075                                            1079
*   NUMBER = RECLNGTH - (T-66);                            /*@Z427VLS*/
         L     @06,T                                               1080
         SL    @06,@CF01576                                        1080
         LCR   @06,@06                                             1080
         AH    @06,RECLNGTH(,R2)                                   1080
         ST    @06,NUMBER                                          1080
*   IF NUMBER > ZERO THEN                                          1081
         LTR   @06,@06                                             1081
         BNP   @RF01081                                            1081
*    DO;                                                   /*@Z427VLS*/
*     CALL CONVERT;                                        /*@Z427VLS*/
         BAL   @14,CONVERT                                         1083
*     CALL PRINTIT;                                        /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1084
*    END;                                                  /*@Z427VLS*/
*   CALL PRINTIT;               /*BLANK LINE TO MAKE MORE READABLE   */
@RF01081 BAL   @14,PRINTIT                                         1086
*  END;                                                    /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
@RF01069 LA    @06,1                                               1088
         AL    @06,Y                                               1088
         ST    @06,Y                                               1088
@DE01048 C     @06,SORTNUM(,R2)                                    1088
         BNH   @DL01048                                            1088
*IF DEBUG47 ^= ON THEN                                             1089
         TM    DEBUG47(R2),B'00000001'                             1089
         BO    @RF01089                                            1089
* CALL PRTTOTAL;         /*GO  PRINT THE SUMMRY TABLE        @G51DGGB*/
         BAL   @14,PRTTOTAL                                        1090
*CALL CPUINFO;                  /*GO PRINT THE CUP SERIAL LETTER TAB */
@RF01089 BAL   @14,CPUINFO                                         1091
* IF BADRECRD ^= ZERO THEN                                         1092
         L     @06,BADRECRD                                        1092
         LTR   @06,@06                                             1092
         BZ    @RF01092                                            1092
*  DO;                                                     /*@Z427VLS*/
*   CALL IFCMSG(63,ADDR(BADREC));                          /*@Z427VLS*/
         LA    @06,BADREC                                          1094
         ST    @06,@AFTEMPS                                        1094
         L     @15,ADIFCMSG(,R2)                                   1094
         LA    @01,@AL01094                                        1094
         BALR  @14,@15                                             1094
*   BINWORD = BADRECRD;         /*SET UP THE BINARY COUNT TO CONVERT */
         L     @06,BADRECRD                                        1095
         ST    @06,BINWORD                                         1095
*   DECADDR = ADDR(NUMFAIL);    /*SET UP ADDRESS OF WHERE TO PUT IT  */
         LA    @06,NUMFAIL                                         1096
         ST    @06,DECADDR                                         1096
*   BNDECNUM = SIX;             /*NUMBER OF CHARS TO PRINT   @Z427VLS*/
         L     @06,SIX                                             1097
         ST    @06,BNDECNUM                                        1097
*   CALL CONVBIN;               /*GO CONVERT THE NUMBER TO PRINTABLE */
         BAL   @14,CONVBIN                                         1098
*   CALL PRINTIT;               /*PRINT THE BAD RECORD COUNT MESSAGE */
         BAL   @14,PRINTIT                                         1099
*  END;                                                    /*@Z427VLS*/
* IF DEBUG12 = ON THEN          /*USER WANTS TO ABEND        @Z427VLS*/
@RF01092 TM    DEBUG12(R2),B'00001000'                             1101
         BNO   @RF01101                                            1101
* GEN(ABEND 444,DUMP);                                     /*@Z427VLS*/
         ABEND 444,DUMP
*/********************************************************************/
*/********************************************************************/
*RETURN;                                                   /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         1103
@EF00001 DS    0H                                                  1103
@ER00001 L     @14,12(,@13)                                        1103
         LM    @00,@12,20(@13)                                     1103
         BR    @14                                                 1103
*END                                                       /*@Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 1104
         B     @EL00001                                            1104
@DATA    DS    0H
@CH00227 DC    H'24'
         DS    0F
@AL00413 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00427 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00438 DC    A(@CF00073+2)           LIST WITH   1 ARGUMENT(S)
@AL00799 DC    A(@CF01409)             LIST WITH   3 ARGUMENT(S)
@AL01050 DC    A(@CF00080+2)           LIST WITH   1 ARGUMENT(S)
         DC    A(DEVTYPE1)
@AL00867 DC    A(@CF00850)             LIST WITH   3 ARGUMENT(S)
         DC    A(DEVCOMP)
         DC    A(DEVTYPE1)
@AL01094 DC    A(@CF01577)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00008 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00007 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00011 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00027 DS    15F
@SA00028 DS    15F
@SA00020 DS    15F
@SA00021 DS    15F
@SA00024 DS    15F
@SA00025 DS    15F
@SA00029 DS    15F
@SA00012 DS    0F
         DS    15F
@AL00001 DS    3A
@TF00001 DS    F
@AFTEMPS DS    1F
         DS    0F
@CF00055 DC    F'1'
@CF00073 DC    F'2'
@CH00073 EQU   @CF00073+2
@CF00075 DC    F'3'
@CH00075 EQU   @CF00075+2
@CF00035 DC    F'4'
@CF00078 DC    F'5'
@CF00080 DC    F'6'
@CH00080 EQU   @CF00080+2
@CF00082 DC    F'7'
@CH00082 EQU   @CF00082+2
@CF00065 DC    F'8'
@CF00085 DC    F'9'
@CF00032 DC    F'10'
@CH00032 EQU   @CF00032+2
@CF00033 DC    F'11'
@CF01462 DC    F'14'
@CF00088 DC    F'16'
@CF00850 DC    F'22'
@CH00850 EQU   @CF00850+2
@CF01168 DC    F'26'
@CF01574 DC    F'27'
@CF01409 DC    F'32'
@CF01577 DC    F'63'
@CF01576 DC    F'66'
@CF01590 DC    F'-5'
@CF01587 DC    XL4'0000FFFF'
@CF00102 DC    XL4'0100'
@CF00198 DC    XL4'8000'
@CF01557 DC    XL4'FF80'
@CF01558 DC    XL4'4000'
@CF01559 DC    XL4'2000'
@CF01560 DC    XL4'1000'
@CF01561 DC    XL4'0800'
@CF01562 DC    XL4'0400'
@CF01563 DC    XL4'0200'
@CF01564 DC    XL4'0080'
@CF01565 DC    XL4'2080'
@CV01456 DC    V(IFCDEVIC)
         DS    0D
PTR      DC    F'0'
L8       DC    F'8'
J        DC    F'0'
TOTOFTOT DC    F'0'
BADRECRD DC    F'0'
TEN      DC    F'10'
FIVE     DC    F'5'
ONE      DC    F'1'
TWOEIGHT DC    F'28'
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
BINWORD  DC    F'0'
NUMBER1  DC    F'1'
BNDECNUM DC    F'0'
DECADDR  DC    F'0'
I        DC    F'0'
NUMBER   DC    F'0'
TWO      DC    F'2'
CURRENT  DC    F'0'
MINUS1   DC    F'-1'
TOTAL    DC    F'0'
X        DC    F'0'
K        DC    F'0'
Z        DC    F'0'
SIX      DC    F'6'
M        DC    F'0'
N        DC    F'0'
L        DC    F'0'
P        DC    F'0'
R        DC    F'0'
S        DC    F'0'
T        DC    F'0'
Y        DC    F'0'
SEVEN    DC    F'7'
RTYP     DC    F'0'
MYLINECT DC    H'1000'
@TS00001 DS    CL2
@CC01355 DC    C'CSID='
@CC01435 DC    C'3410'
@CC01436 DC    C'3420'
@CC01437 DC    C'34XX'
@CB00198 DC    X'8000'
@CB01420 DC    X'0168'
@CB01421 DC    X'3062'
@CB01425 DC    X'F000'
@CB01427 DC    X'2009'
@CB01428 DC    X'200D'
@CB01474 DC    X'0843'
@CB01475 DC    X'0842'
LINE01   DC    CL23'EVENT HISTORY TEMPLATE '
LINE02   DC    CL20'FOR RECORD TYPES:  '
LINE03   DC    CL12'MCH, MCH-TRM'
LINE04   DC    CL33'   TIME     JOBNAME  RECTYP  CPU '
LINE06   DC    CL21'CCH, CCH-INC, CCH-CRH'
LINE08   DC    CL3'OBR'
LINE10   DC    CL74'OBR-DMT, OBR-EOD, DDR, DDR-OPR, DDR-SYS, MIH MIH-CEC
               , MIH-DE, MDR         '
LINE12   DC    CL16'OBR-PRM, OBR-TMP'
LINE14   DC    CL38'SFT, SFT-ABN, SFT-MCH, SFT-PI, SFT-RST'
LINE16   DC    CL3'IPL'
LINE18   DC    CL3'EOD'
DEVCOMP  DC    CL2'  '
LOSTMSG  DC    CL54'LOST RECORD SUMMARY  TYPE=4F (SHORT SOFT RECORD)   C
                  '
PRTLINE  DC    CL154' '
         ORG   PRTLINE
DDNAME   DC    CL1'1'
SPACING  DC    X'09'
TIME1    DS    CL11
@NM00085 DS    CL1
JOBNAME1 DS    CL8
@NM00086 DS    CL1
RECTYP1  DS    CL7
@NM00087 DS    CL1
CPU11    DS    CL1
CPU12    DS    CL1
@NM00088 DS    CL1
CUA11    DS    CL1
CUA12    DS    CL1
@NM00089 DS    CL2
@NM00090 DS    CL1
LETTERV  DS    CL1
DEVICE1  DS    CL4
@NM00091 DS    CL2
CMD1     DS    CL2
@NM00092 DS    CL1
CSW1     DS    CL4
VLETTER  DS    CL1
@NM00093 DS    CL1
SENSEA1  DS    CL8
@NM00094 DS    CL1
SENSEA2  DS    CL8
@NM00095 DS    CL1
SENSEA3  DS    CL8
@NM00096 DS    CL1
SENSEA4  DS    CL8
@NM00097 DS    CL1
SENSEA5  DS    CL8
@NM00098 DS    CL1
SENSEA6  DS    CL8
@NM00099 DS    CL1
VOLUME1  DS    CL6
         ORG   VOLUME1
SENSEA7  DS    CL1
         ORG   PRTLINE+115
@NM00100 DS    CL1
BB1      DS    CL4
         ORG   BB1
@NM00101 DS    CL2
SENSEA8  DS    CL2
         ORG   PRTLINE+120
@NM00102 DS    CL1
CC1      DS    CL4
@NM00103 DS    CL1
HH1      DS    CL4
         ORG   HH1
@NM00104 DS    CL2
SENSEA9  DS    CL2
         ORG   PRTLINE+130
@NM00105 DS    CL1
R111     DS    CL2
         ORG   PRTLINE+154
UPSPACE  DC    X'89'
SINGLE   DC    X'09'
DOUBLE   DC    X'11'
TRIPLE   DC    X'19'
DDRSPEC  DS    CL12
         ORG   DDRSPEC
@NM00106 DC    CL3'TO '
TOCUA    DC    CL3'   '
@NM00107 DC    CL2'  '
DEVSAVE  DS    CL4
         ORG   DDRSPEC+12
TOO      DC    CL2'TO'
UKNO     DC    CL4'UKNO'
REPORTDY DC    CL12'REPORT DATE '
HEADDATE DS    CL18
         ORG   HEADDATE
@NM00109 DC    CL7'PERIOD '
FROMTO   DC    CL5'FROM '
DATE     DS    CL6
         ORG   DATE
DATEDAY  DC    CL3'   '
@NM00110 DC    CL1' '
DATEYR   DC    CL2'  '
         ORG   HEADDATE+18
TO       DC    CL5'  TO '
NOTAPPLY DC    CL8'  N/A   '
BLANK    DC    CL6'      '
BLANK1   DC    X'000000000000'
KEEPSP   DC    CL1' '
LINE8    DC    CL78'                     PSW-MCH /PROG-EC              C
                                 ERROR-ID '
LINE1    DC    CL18'CUA DEVICE     CSW'
LINE2    DC    CL18'CUA DEVICE CMD CSW'
LINE3    DC    CL104'CUA DEVICE                                        C
                                       VOLUME/TERMINAL NAME        '
LINE5    DC    CL98'CUA DEVICE CMD CSW  SENSE    04  06   08  10   12  C
               14   16  18   20  22   VOLUME B B  C C  H H  R'
LINE66   DC    CL78'          REASON     PSW-MCH /PROG-EC   RCYRYXIT  CC
               OMP/MOD  CSECTID  ERROR-ID '
LINE7    DC    CL17'   SSYS ID REASON'
LINE6    DC    CL78'   SSYS ID  REASON   PSW-MCH /PROG-EC   RCYRYXIT  CC
               OMP/MOD  CSECTID  ERROR-ID'
LINE4    DC    CL87'CUA DEVICE                             BYTES    DATC
               A CK  SEEKS  OVERRUN   VOLUME'
@NM00122 DS    CL182
         ORG   @NM00122
MCH      DC    CL7'MCH    '
MCHTRM   DC    CL7'MCH-TRM'
CCH      DC    CL7'CCH    '
CCHINC   DC    CL7'CCH-INC'
CCHCRH   DC    CL7'CCH-CRH'
OBR      DC    CL7'OBR    '
OBRSHT   DC    CL7'OBR-SHT'
OBRDMT   DC    CL7'OBR-DMT'
OBREOD   DC    CL7'OBR-EOD'
OBRTMP   DC    CL7'OBR-TMP'
OBRPRM   DC    CL7'OBR-PRM'
SFT      DC    CL7'SFT    '
SFTABN   DC    CL7'SFT-ABN'
SFTMCH   DC    CL7'SFT-MCH'
SFTPI    DC    CL7'SFT-PI '
SFTRST   DC    CL7'SFT-RST'
IPL      DC    CL7'IPL    '
DDR      DC    CL7'DDR    '
DDROPR   DC    CL7'DDR-OPR'
DDRSYS   DC    CL7'DDR-SYS'
MIH      DC    CL7'MIH    '
MIHCE    DC    CL7'MIH-CE '
MIHDE    DC    CL7'MIH-DE '
EOD      DC    CL7'EOD    '
MDR      DC    CL7'MDR    '
MDRDAS   DC    CL7'MDR-DAS'
         ORG   @NM00122+182
         DS    CL3
ALLCTS   DS    CL1664
         ORG   ALLCTS
MCHCT    DC    16F'0'
MCHTRMCT DC    16F'0'
CCHCT    DC    16F'0'
CCHINCCT DC    16F'0'
CCHCRHCT DC    16F'0'
OBRCT    DC    16F'0'
OBRSHTCT DC    16F'0'
OBRDMTCT DC    16F'0'
OBREODCT DC    16F'0'
OBRTMPCT DC    16F'0'
OBRPRMCT DC    16F'0'
SFTCT    DC    16F'0'
SFTABNCT DC    16F'0'
SFTMCHCT DC    16F'0'
SFTPICT  DC    16F'0'
SFTRSTCT DC    16F'0'
IPLCT    DC    16F'0'
DDRCT    DC    16F'0'
DDROPRCT DC    16F'0'
DDRSYSCT DC    16F'0'
MIHCT    DC    16F'0'
MIHCECT  DC    16F'0'
MIHDECT  DC    16F'0'
EODCT    DC    16F'0'
MDRCT    DC    16F'0'
MDRDASCT DC    16F'0'
         ORG   ALLCTS+1664
LASTDATE DC    CL4'    '
TABLECHH DC    CL2'  '
TOTALHD1 DC    CL12'RECORD TYPES'
TOTALHD3 DC    CL107' TOTAL  CPU-A CPU-B CPU-C CPU-D CPU-E CPU-F CPU-G C
               CPU-H CPU-I CPU-J CPU-K CPU-L CPU-M CPU-N CPU-O CPU-P   C
                '
CHARS    DC    CL16'0123456789ABCDEF'
         DS    CL3
WORK     DS    CL8
TEMPSAVE DC    CL84' '
SWITCHE  DC    AL1(0)
         ORG   SWITCHE
SWITCH1  DS    BL1
SWITCH2  EQU   SWITCHE+0
SWITCH3  EQU   SWITCHE+0
SWITCH4  EQU   SWITCHE+0
SWITCH5  EQU   SWITCHE+0
         ORG   SWITCHE+1
LETTER1  DC    CL1'M'
CPULINE  DC    CL24'CPU   MODEL   SERIAL NO.'
CPUDATA  DC    CL22' '
         ORG   CPUDATA
@NM00126 DS    CL1
CPUTYPE  DS    CL1
@NM00127 DS    CL5
CPUMODEL DS    CL3
@NM00128 DS    CL6
CPUSERAL DS    CL6
         ORG   CPUDATA+22
NEWDATEH DS    CL12
         ORG   NEWDATEH
@NM00129 DC    CL5'DATE '
DAYJUL   DC    CL3'   '
@NM00130 DC    CL2'  '
YEARJUL  DC    CL2'  '
         ORG   NEWDATEH+12
OVERTOT  DC    CL16' OVER ALL TOTALS'
MDRLINE  DC    CL35'RD/SRCHD COR/RTRY  CNT/ERR COM/DATA'
FRAMEMCH DC    CL7'FRM-MCH'
FRAMECCH DC    CL7'FRM-CCH'
FRMTEMP  DC    CL7' '
LINEFRAM DC    CL43'GROUP   FRAME   EC LEVEL    SEQ #  LASTFLAG'
         DS    CL5
DBLWORD  DS    CL8
SUPERZAP DC    3CL10'SUPERZAP'
TOTHEAD  DC    CL22'MACHINE CHECK         '
         DC    CL22'CHANNEL CHECK         '
         DC    CL22'OUTBOARD              '
         DC    CL22'SOFTWARE              '
         DC    CL22'SYSTEM INITIALIZATION '
         DC    CL22'SYSTEM RECONFIGURATION'
         DC    CL22'MISSING INTERRUPT     '
         DC    CL22'SYSTEM TERMINATION    '
         DC    CL22'BUFFER OFFLOAD        '
ADDRTAB1 DC    AL4(LINE03)
         DC    AL4(LINE06)
         DC    AL4(LINE08)
         DC    AL4(LINE10)
         DC    AL4(LINE12)
         DC    AL4(LINE14)
         DC    AL4(LINE16)
         DC    AL4(LINE18)
         DC    AL4(MDRDAS)
NUMCHAR1 DC    A(11)
         DC    A(20)
         DC    A(2)
         DC    A(73)
         DC    A(15)
         DC    A(37)
         DC    A(2)
         DC    A(2)
         DC    A(6)
ADDRTAB2 DC    AL4(LINE8)
         DC    AL4(LINE1)
         DC    AL4(LINE2)
         DC    AL4(LINE3)
         DC    AL4(LINE5)
         DC    AL4(LINE66)
         DC    AL4(LINE7)
         DC    AL4(LINE6)
         DC    AL4(LINE4)
NUMCHAR2 DC    A(77)
         DC    A(17)
         DC    A(17)
         DC    A(103)
         DC    A(97)
         DC    A(77)
         DC    A(16)
         DC    A(0)
         DC    A(79)
SUBTOT   DC    16F'0'
PATCH    DC    20F'0'
TOTALS   DC    16F'0'
LETTER   DC    CL1'M'
         DC    CL1'M'
         DC    CL1'C'
         DC    CL1'C'
         DC    CL1'C'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'O'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'S'
         DC    CL1'I'
         DC    CL1'D'
         DC    CL1'D'
         DC    CL1'D'
         DC    CL1'M'
         DC    CL1'M'
         DC    CL1'M'
         DC    CL1'E'
         DC    CL1'M'
         DC    CL1'M'
IFCEVENT CSECT
         DC    S(SUPERZAP)
IFCEVENT CSECT
     DC  S(PATCH)    SET UP THE ADDRESSABILITY FOR THE PATCH AREA
IFCEVENT CSECT
EXECMVC  MVC RECTYP1(0),0(R8)
EXECMVC2 MVC   CUA12(0),0(R8)
IFCEVENT CSECT
MVCDATA  MVC   R0(R0,R6),0(R8)
IFCEVENT CSECT
MOVECHAR   MVC  R0(0,R8),0(R6)
IFCEVENT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
I0001    EQU   @03
R2       EQU   @02
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R15      EQU   @15
R0       EQU   @00
R1       EQU   @01
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG12  EQU   DEBUG+1
DEBUG17  EQU   DEBUG+2
DEBUG24  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUGA   EQU   PARM+8
DEBUG46  EQU   DEBUGA+1
DEBUG47  EQU   DEBUGA+1
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
EVSYEAR  EQU   STRTDATE
EVSDAY   EQU   STRTDATE+1
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
RECLNGTH EQU   CCHHRLNG+6
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVYEAR   EQU   EVSTOP
EVDAY    EQU   EVSTOP+1
EVNUM    EQU   EVTABLE+4
EVKEY    EQU   EVTABLE+6
EVMODEL  EQU   EVKEY
EVSERIAL EQU   EVKEY+2
EVLETTER EQU   EVKEY+5
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRBASE  EQU   SHAREIO+1
SHRCUCPU EQU   SHAREIO+8
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
LRTREC   EQU   0
LRTKEY   EQU   LRTREC
LRTKEY1  EQU   LRTKEY
LRTSMS   EQU   LRTREC+2
LRTERRID EQU   LRTREC+3
@NM00016 EQU   LRTREC+4
LRTDT    EQU   LRTREC+8
LRTDATE  EQU   LRTDT
LRTYRDAY EQU   LRTDATE+1
LRTYEAR  EQU   LRTYRDAY
LRTDAY   EQU   LRTYRDAY+1
LRTTIME  EQU   LRTDT+4
LRTCPU   EQU   LRTREC+16
LRTCPMOD EQU   LRTCPU+1
LRTCPUS  EQU   LRTCPMOD
LRTMODEL EQU   LRTCPMOD+3
MCHREC   EQU   0
MCHHEAD  EQU   MCHREC
MCHKEY   EQU   MCHHEAD
MCHSMS   EQU   MCHHEAD+2
MCHSYSTR EQU   MCHSMS+1
MCHCPUID EQU   MCHHEAD+16
MCHMOD   EQU   MCHCPUID+4
MCHJOBID EQU   MCHREC+32
MCHOPSW  EQU   MCHREC+40
CCHREC   EQU   0
CCHHEAD  EQU   CCHREC
CCHKEY   EQU   CCHHEAD
CCHSMS   EQU   CCHHEAD+2
CCHRCRH  EQU   CCHSMS
CCHRINC  EQU   CCHSMS+1
CCHCPUID EQU   CCHHEAD+16
CCHMOD   EQU   CCHCPUID+4
CCHJOBID EQU   CCHREC+24
CCHCSW   EQU   CCHREC+56
CCHCODE  EQU   CCHREC+68
CCHCODE2 EQU   CCHCODE+2
CCHCUA   EQU   CCHREC+74
CCHMP    EQU   CCHREC+76
CCHLOG   EQU   CCHREC+80
OBRREC   EQU   0
OBRHEAD  EQU   OBRREC
OBRKEY   EQU   OBRHEAD
OBRSMS   EQU   OBRHEAD+2
MISCSW   EQU   OBRSMS
OBRSUBTP EQU   OBRSMS+1
SDRCOUNT EQU   OBRSUBTP
OBRTEMP  EQU   OBRSUBTP
SHORTSW  EQU   OBRSUBTP
DISMOUNT EQU   OBRSUBTP
OBRCPUID EQU   OBRHEAD+16
OBRJOBID EQU   OBRREC+24
OBRSDEV2 EQU   OBRJOBID+2
OBRSCUA  EQU   OBRJOBID+5
OBRFCCW  EQU   OBRREC+32
OBRSRDS  EQU   OBRFCCW
OBRCSW   EQU   OBRREC+40
OBRSTAT  EQU   OBRCSW+4
OBRDEVDC EQU   OBRREC+48
OBRSECUA EQU   OBRREC+49
OBRCODE  EQU   OBRREC+52
OBRDEV   EQU   OBRCODE+2
OBRCLASS EQU   OBRDEV
OBRLSDRC EQU   OBRREC+56
OBRPCUA  EQU   OBRREC+57
OBRSBCNT EQU   OBRREC+62
OBRVOL   EQU   OBRREC+64
OBRSEEK  EQU   OBRREC+70
OBRTCAM  EQU   OBRSEEK
OBRTERMN EQU   OBRSEEK+2
SFTREC   EQU   0
SFTHEAD  EQU   SFTREC
SFTKEY   EQU   SFTHEAD
SFTKEY1  EQU   SFTKEY
SFTCPUID EQU   SFTHEAD+16
SFTJOBID EQU   SFTREC+24
SFTSDWA  EQU   SFTREC+32
SFTABNDC EQU   SFTSDWA
SFTAEC1  EQU   SFTSDWA+96
SFTPROGC EQU   SFTAEC1+8
SFTFLGS  EQU   SFTSDWA+232
SFTRECP  EQU   SFTSDWA+292
SFTMODN  EQU   SFTRECP
SFTCSECT EQU   SFTRECP+8
SFTREXN  EQU   SFTRECP+16
IPLREC   EQU   0
IPLHEAD  EQU   IPLREC
IPLKEY   EQU   IPLHEAD
IPLCPUID EQU   IPLHEAD+16
IPLSYSID EQU   IPLREC+24
IPLREAS  EQU   IPLREC+28
IPLSTIME EQU   IPLREC+52
DDRREC   EQU   0
DDRHEAD  EQU   DDRREC
DDRKEY   EQU   DDRHEAD
DDRSMS   EQU   DDRHEAD+2
DDRDEPSW EQU   DDRSMS+1
DDRCPUID EQU   DDRHEAD+16
@NM00051 EQU   DDRREC+24
DDRJOBID EQU   @NM00051
DDRVOL1  EQU   @NM00051+8
DDRVOL2  EQU   @NM00051+14
DDRFCUA  EQU   DDRREC+45
DDRFDEV  EQU   DDRREC+48
DDRCODE2 EQU   DDRFDEV+2
DDRTOCUA EQU   DDRREC+53
DDRTODEV EQU   DDRREC+56
DDRDEV2  EQU   DDRTODEV+2
MIHREC   EQU   0
MIHHEAD  EQU   MIHREC
MIHKEY   EQU   MIHHEAD
@NM00053 EQU   MIHHEAD+4
MIHCEBIT EQU   @NM00053
MIHDEBIT EQU   @NM00053
MIHCSID  EQU   MIHHEAD+5
MIHCPUID EQU   MIHHEAD+16
MIHMOD   EQU   MIHCPUID+4
@NM00056 EQU   MIHREC+24
MIHJOBID EQU   @NM00056
MIHCUA   EQU   MIHREC+35
MIHVOL   EQU   MIHREC+38
MIHDEV   EQU   MIHREC+44
MIHCODE2 EQU   MIHDEV+2
EODREC   EQU   0
EODHEAD  EQU   EODREC
EODKEY   EQU   EODHEAD
EODCPUID EQU   EODHEAD+16
TPRREC   EQU   0
TPRHEAD  EQU   TPRREC
TPRKEY   EQU   TPRHEAD
TPRDEV   EQU   TPRHEAD+4
TPRBUFC  EQU   TPRHEAD+5
TPRCPUID EQU   TPRHEAD+16
TPRCUA   EQU   TPRREC+24
@NM00064 EQU   TPRREC+26
TPRVOL   EQU   @NM00064
MCFREC   EQU   0
MCFHEAD  EQU   MCFREC
MCFKEY   EQU   MCFHEAD
MCFSMS   EQU   MCFHEAD+2
@NM00072 EQU   MCFHEAD+16
MCFSMO   EQU   MCFHEAD+17
CCFREC   EQU   0
CCFHEAD  EQU   CCFREC
CCFKEY   EQU   CCFHEAD
CCFSMS   EQU   CCFHEAD+2
@NM00080 EQU   CCFHEAD+16
CCFSMO   EQU   CCFHEAD+17
RERR     EQU   0
OBRSENSE EQU   0
OBRSEN1  EQU   OBRSENSE+1
NEXTBYTE EQU   0
ADDNUM   EQU   0
@NM00133 EQU   0
CCHNOCS  EQU   @NM00133+6
CCHMPIF  EQU   @NM00133+8
CCHCSAD  EQU   CCHMPIF
LAST     EQU   0
@NM00083 EQU   OBRCODE
OBRCODE2 EQU   @NM00083+1
NEWMDR   EQU   TIME1
LINE002  EQU   TIME1
TOPTEMP  EQU   TIME1+53
DUPLICAT EQU   TIME1
CCHFINSH EQU   CUA12
OBRFINSH EQU   CUA12
SFTFINSH EQU   CUA12
IPLFINSH EQU   CUA12
HEAD01   EQU   TIME1
TODAYDT  EQU   CUA11
TERMNAME EQU   VOLUME1
DEVTYPE1 EQU   DEVICE1
DAYSDATE EQU   TIME1+44
HEDDATE  EQU   CUA11
TOTALNM1 EQU   TIME1
PRTLINE1 EQU   TIME1
SSYS     EQU   PRTLINE1+37
REASON   EQU   PRTLINE1+46
PSWMCH   EQU   PRTLINE1+53
RCYRYXIT EQU   PRTLINE1+72
COMPMOD  EQU   PRTLINE1+82
CSECTID  EQU   PRTLINE1+92
ERRORID1 EQU   PRTLINE1+102
LINE0006 EQU   TIME1+32
BADREC   EQU   TIME1
NUMFAIL  EQU   TIME1+8
LINE44   EQU   CUA12
ERRORNA  EQU   ERRORID1
TOTALHD2 EQU   TIME1
WORKOVER EQU   WORK
HEADTOTL EQU   TIME1
RECNAME  EQU   HEADTOTL
TOTALVAL EQU   HEADTOTL+26
NMETOTAL EQU   MCH
TOTALNME EQU   RECNAME+4
COUNT    EQU   MCHCT
CPULINE1 EQU   TIME1
MVCOVER  EQU   TIME1
NEWDATEO EQU   TIME1
MDROBRLN EQU   TIME1+71
@NM00131 EQU   CCHMP
CCHLOGLN EQU   @NM00131+2
PSWMCH1  EQU   PSWMCH
LINEFRM1 EQU   CUA12
BADCOUNT EQU   TIME1
DDRFINSH EQU   CUA12
HEAD1    EQU   LINE01
LINE004  EQU   CUA12
LINE006  EQU   TIME1+54
LOSTSOFT EQU   SENSEA1
ODDMOVE  EQU   TIME1
RECCOUNT EQU   MCHCT
TOTALHD4 EQU   TOTALVAL
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00132 EQU   @NM00131
@NM00125 EQU   HEADTOTL+36
CPUA1    EQU   HEADTOTL+32
FORTOTAL EQU   TOTALVAL+1
@NM00124 EQU   TOTALVAL
@NM00123 EQU   HEADTOTL+22
RTYPE    EQU   RECNAME
@NM00121 EQU   PRTLINE1+100
@NM00120 EQU   PRTLINE1+90
@NM00119 EQU   PRTLINE1+80
@NM00118 EQU   PRTLINE1+70
PROGEC   EQU   PRTLINE1+62
@NM00117 EQU   PRTLINE1+61
@NM00116 EQU   PRTLINE1+52
@NM00115 EQU   PRTLINE1+41
@NM00114 EQU   PRTLINE1+30
RECTYP2  EQU   PRTLINE1+23
@NM00113 EQU   PRTLINE1+22
JOBNAME2 EQU   PRTLINE1+14
@NM00112 EQU   PRTLINE1+13
TIME2    EQU   PRTLINE1+2
@NM00111 EQU   PRTLINE1
YR       EQU   DAYSDATE+4
@NM00108 EQU   DAYSDATE+3
DAY      EQU   DAYSDATE
@NM00084 EQU   @NM00083
@NM00135 EQU   CCHMPIF+2
@NM00134 EQU   @NM00133+2
CCHFOOTS EQU   @NM00133
OBRSEN0  EQU   OBRSENSE
CCFFRAME EQU   CCFREC+24
@NM00082 EQU   CCFHEAD+22
CCFMOD   EQU   CCFSMO+3
CCFSER   EQU   CCFSMO
CCFVER   EQU   @NM00080
@NM00081 EQU   @NM00080
CCFTIMD  EQU   CCFHEAD+12
CCFDAT   EQU   CCFHEAD+8
@NM00079 EQU   CCFHEAD+7
CCFCNT   EQU   CCFHEAD+6
@NM00078 EQU   CCFHEAD+4
@NM00077 EQU   CCFSMS+1
CCFCPU   EQU   CCFSMS+1
CCFMP    EQU   CCFSMS+1
@NM00076 EQU   CCFSMS
CCFTIM   EQU   CCFSMS
@NM00075 EQU   CCFSMS
CCFTRU   EQU   CCFSMS
CCFTOD   EQU   CCFSMS
CCFLST   EQU   CCFSMS
CCFKEY2  EQU   CCFKEY+1
CCFKEY1  EQU   CCFKEY
MCFFRAME EQU   MCFREC+24
@NM00074 EQU   MCFHEAD+22
MCFMOD   EQU   MCFSMO+3
MCFSER   EQU   MCFSMO
MCFVER   EQU   @NM00072
@NM00073 EQU   @NM00072
MCFTIMD  EQU   MCFHEAD+12
MCFDAT   EQU   MCFHEAD+8
@NM00071 EQU   MCFHEAD+7
MCFCNT   EQU   MCFHEAD+6
@NM00070 EQU   MCFHEAD+4
@NM00069 EQU   MCFSMS+1
MCFCPU   EQU   MCFSMS+1
MCFMP    EQU   MCFSMS+1
@NM00068 EQU   MCFSMS
MCFTIM   EQU   MCFSMS
@NM00067 EQU   MCFSMS
MCFTRU   EQU   MCFSMS
MCFTOD   EQU   MCFSMS
MCFLST   EQU   MCFSMS
MCFKEY2  EQU   MCFKEY+1
MCFKEY1  EQU   MCFKEY
RMSSCBRY EQU   TPRREC+58
DVBSDRE  EQU   TPRREC+56
@NM00066 EQU   TPRREC+39
TPRMODE  EQU   TPRREC+38
TPRLINAD EQU   TPRREC+36
@NM00065 EQU   TPRREC+34
TPRCEL   EQU   TPRCPUID+6
TPRMODEL EQU   TPRCPUID+4
TPRSER   EQU   TPRCPUID+1
@NM00063 EQU   TPRCPUID
TPRTIME  EQU   TPRHEAD+12
TPRDATE  EQU   TPRHEAD+8
@NM00062 EQU   TPRHEAD+6
TPRLENGT EQU   TPRBUFC
@NM00061 EQU   TPRBUFC
TPRSMS   EQU   TPRHEAD+2
TPRKEY2  EQU   TPRKEY+1
TPRKEY1  EQU   TPRKEY
EODCEL   EQU   EODCPUID+6
EODMODEL EQU   EODCPUID+4
EODSER   EQU   EODCPUID+1
@NM00060 EQU   EODCPUID
EODTIME  EQU   EODHEAD+12
EODDATE  EQU   EODHEAD+8
@NM00059 EQU   EODHEAD+5
EODDEV   EQU   EODHEAD+4
EODSMS   EQU   EODHEAD+2
EODKEY2  EQU   EODKEY+1
EODKEY1  EQU   EODKEY
MIHTYPE  EQU   MIHCODE2+1
MIHCLASS EQU   MIHCODE2
@NM00058 EQU   MIHDEV
@NM00057 EQU   @NM00056+8
MIHCEL   EQU   MIHCPUID+6
MIHSER   EQU   MIHCPUID+1
@NM00055 EQU   MIHCPUID
MIHTIME  EQU   MIHHEAD+12
MIHDATE  EQU   MIHHEAD+8
@NM00054 EQU   MIHHEAD+6
MIHSMS   EQU   MIHHEAD+2
MIHKEY2  EQU   MIHKEY+1
MIHKEY1  EQU   MIHKEY
DDRDEV1  EQU   DDRTODEV
@NM00052 EQU   DDRREC+52
DDRTYPE  EQU   DDRCODE2+1
DDRCLASS EQU   DDRCODE2
DDRCODE1 EQU   DDRFDEV
DDRPHD   EQU   @NM00051+20
DDRCEL   EQU   DDRCPUID+6
DDRMOD   EQU   DDRCPUID+4
DDRSER   EQU   DDRCPUID+1
@NM00050 EQU   DDRCPUID
DDRTIME  EQU   DDRHEAD+12
DDRDATE  EQU   DDRHEAD+8
@NM00049 EQU   DDRHEAD+4
@NM00048 EQU   DDRSMS
DDRKEY2  EQU   DDRKEY+1
DDRKEY1  EQU   DDRKEY
IPLSHSEC EQU   IPLSTIME+3
IPLSSEC  EQU   IPLSTIME+2
IPLSMIN  EQU   IPLSTIME+1
IPLSHOUR EQU   IPLSTIME
IPLSDATE EQU   IPLREC+48
IPLTEMP  EQU   IPLREC+46
IPLHIGH  EQU   IPLREC+42
IPLCHAN  EQU   IPLREC+32
@NM00047 EQU   IPLREC+30
@NM00046 EQU   IPLREC+25
IPLCEL   EQU   IPLCPUID+6
IPLMOD   EQU   IPLCPUID+4
IPLSER   EQU   IPLCPUID+1
@NM00045 EQU   IPLCPUID
IPLTIME  EQU   IPLHEAD+12
IPLDATE  EQU   IPLHEAD+8
@NM00044 EQU   IPLHEAD+4
IPLSMS   EQU   IPLHEAD+2
IPLKEY2  EQU   IPLKEY+1
IPLKEY1  EQU   IPLKEY
SFTXDATA EQU   SFTREC+434
SFTLVARA EQU   SFTREC+432
@NM00043 EQU   SFTSDWA+238
SFTLCPUA EQU   SFTSDWA+236
SFTERRD  EQU   SFTFLGS+3
SFTERRC  EQU   SFTFLGS+2
SFTERRB  EQU   SFTFLGS+1
SFTERRA  EQU   SFTFLGS
@NM00042 EQU   SFTSDWA+136
SFTAAEC1 EQU   SFTSDWA+120
@NM00041 EQU   SFTSDWA+112
@NM00040 EQU   SFTAEC1
@NM00039 EQU   SFTSDWA+88
SFTGRSV  EQU   SFTSDWA+24
SFTCEL   EQU   SFTCPUID+6
SFTMOD   EQU   SFTCPUID+4
SFTSER   EQU   SFTCPUID+1
@NM00038 EQU   SFTCPUID
SFTTIME  EQU   SFTHEAD+12
SFTDATE  EQU   SFTHEAD+8
@NM00037 EQU   SFTHEAD+4
SFTSMS   EQU   SFTHEAD+2
SFTKEY2  EQU   SFTKEY+1
OBR34CT2 EQU   OBRTERMN+5
OBR34CT1 EQU   OBRTERMN+4
@NM00036 EQU   OBRTERMN
@NM00035 EQU   OBRSEEK+1
OBRRETRY EQU   OBRREC+60
OBRTYPE  EQU   OBRDEV+1
OBRCODE1 EQU   OBRCODE
@NM00034 EQU   OBRCSW
OBRSDRS2 EQU   OBRSRDS
OBRSDRS1 EQU   OBRSRDS
OBRSSDRC EQU   OBRJOBID+4
OBRSDEV1 EQU   OBRJOBID
OBRCEL   EQU   OBRCPUID+6
OBRMOD   EQU   OBRCPUID+4
OBRSER   EQU   OBRCPUID+1
@NM00033 EQU   OBRCPUID
OBRTIME  EQU   OBRHEAD+12
OBRDATE  EQU   OBRHEAD+8
@NM00032 EQU   OBRHEAD+4
@NM00031 EQU   OBRSUBTP
@NM00030 EQU   OBRSUBTP
@NM00029 EQU   MISCSW
TRUNC    EQU   MISCSW
@NM00028 EQU   MISCSW
OBRKEY2  EQU   OBRKEY+1
OBRKEY1  EQU   OBRKEY
@NM00027 EQU   CCHREC+73
CCHID    EQU   CCHREC+72
CCHTYPE  EQU   CCHCODE2+1
CCHCLASS EQU   CCHCODE2
CCHCODE1 EQU   CCHCODE
CCHECSW  EQU   CCHREC+64
CCHFCCW  EQU   CCHREC+48
CCHATIO  EQU   CCHREC+32
CCHCEL   EQU   CCHCPUID+6
CCHSER   EQU   CCHCPUID+1
@NM00026 EQU   CCHCPUID
CCHTIME  EQU   CCHHEAD+12
CCHDATE  EQU   CCHHEAD+8
@NM00025 EQU   CCHHEAD+4
@NM00024 EQU   CCHSMS
@NM00023 EQU   CCHSMS
CCHKEY2  EQU   CCHKEY+1
CCHKEY1  EQU   CCHKEY
MCHLOG   EQU   MCHREC+48
MCHPGMID EQU   MCHREC+24
MCHCEL   EQU   MCHCPUID+6
MCHSER   EQU   MCHCPUID+1
@NM00022 EQU   MCHCPUID
MCHTIME  EQU   MCHHEAD+12
MCHDATE  EQU   MCHHEAD+8
@NM00021 EQU   MCHHEAD+4
@NM00020 EQU   MCHSMS
MCHKEY2  EQU   MCHKEY+1
MCHKEY1  EQU   MCHKEY
LRTMCEL  EQU   LRTCPU+6
@NM00019 EQU   LRTCPU
LRTHSECS EQU   LRTTIME+3
LRTSEC   EQU   LRTTIME+2
LRTMIN   EQU   LRTTIME+1
LRTHOUR  EQU   LRTTIME
LRTDATE0 EQU   LRTDATE
@NM00018 EQU   @NM00016+3
LRTCNT   EQU   @NM00016+2
@NM00017 EQU   @NM00016
LRTDSMNT EQU   LRTERRID
@NM00015 EQU   LRTERRID
LRTSHRT  EQU   LRTERRID
@NM00014 EQU   LRTERRID
@NM00013 EQU   LRTSMS
LRTIMCNV EQU   LRTSMS
@NM00012 EQU   LRTSMS
LRTRUNC  EQU   LRTSMS
LRNS     EQU   LRTSMS
LRTNLAST EQU   LRTSMS
LRTKEY2  EQU   LRTKEY+1
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+15
SHRCUAAH EQU   SHRCUCPU+5
SHRCUAAL EQU   SHRCUCPU+3
SHARSERA EQU   SHRCUCPU
SHRCUABH EQU   SHRBASE+5
SHRCUABL EQU   SHRBASE+3
SHARSERB EQU   SHRBASE
SHAREFLG EQU   SHAREIO
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00422 EQU   @EL00008
L000113  EQU   @EL00010
L000112  EQU   @EL00010
@RF00847 EQU   @EL00011
@RF00854 EQU   @EL00011
@RF00890 EQU   @EL00013
@RF00906 EQU   @EL00014
@RC00971 EQU   @EL00027
@RC00969 EQU   @EL00027
@RC00967 EQU   @EL00027
@RC00965 EQU   @EL00027
@RC00963 EQU   @EL00027
@RC00961 EQU   @EL00027
@RC00959 EQU   @EL00027
@RC00957 EQU   @EL00027
@RC00955 EQU   @EL00027
@RC00953 EQU   @EL00027
@RC00997 EQU   @EL00028
@RC00995 EQU   @EL00028
@RC00993 EQU   @EL00028
@RC00991 EQU   @EL00028
@RC00989 EQU   @EL00028
@RC00987 EQU   @EL00028
@RC00985 EQU   @EL00028
@RC00983 EQU   @EL00028
@RC00981 EQU   @EL00028
@RC00979 EQU   @EL00028
@RC00977 EQU   @EL00028
@PB00029 EQU   @PB00030
@RF01061 EQU   @RC01051
@RF01064 EQU   @RC01051
@RF01101 EQU   @EL00001
@RC00499 EQU   L000113
@RC00612 EQU   L000113
@RC00607 EQU   L000113
@RC00602 EQU   L000113
@RC00597 EQU   L000113
@RC00591 EQU   L000113
@RF00736 EQU   L000113
@RC00801 EQU   L000113
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCEVENT

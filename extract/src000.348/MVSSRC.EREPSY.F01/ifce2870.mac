         TITLE '****  2870 CHANNEL EDIT  ****'
         SPACE 2
         MACRO
         PARITY &ENTRY,&REPEAT,&SPACES,&PBITS=,&DISP=,&OFFBYTE=
         GBLC  &ITEM(1500),&DSECT
         GBLA  &SHIFT(1500),&ITEMNBR
         LCLA  &IBITS,&NDX,&ISHIFT
         DC    AL4(&ENTRY)
         DC    AL1(&REPEAT)
         DC    AL1(&SPACES)
         AIF   ('&PBITS' EQ '').HARDCD
.LOOP    ANOP
&NDX     SETA  &NDX+1
         AIF   ('&ITEM(&NDX)' EQ '&PBITS').FOUND
         AIF   (&NDX LT &ITEMNBR).LOOP
         MNOTE *,'PARITY GROUP NOT FOUND'
         MEXIT
.FOUND   ANOP
&ISHIFT  SETA  &SHIFT(&NDX)
         DC    AL.12(&PBITS-&DSECT),AL.4(&ISHIFT)
         AGO   .OUT
.HARDCD  ANOP
&ISHIFT  SETA  &OFFBYTE
         DC    AL.12(&DISP),AL.4(&ISHIFT)
.OUT     ANOP
         MEND
         GBLC  &DSECT,&CSECT
&CSECT   SETC  'IFCE2870'
&DSECT   SETC  'C2870'
IFCE2870 CSECT
C2870    DSECT
DUM      EQU   *
         DSGEN (XKEY,8),(XRELN,8),(XSWS8,9),(XSWS9,1),(XSWS10,1),      C
               (XSWS11,1),                                             C
               (XSWS12,1),(XSWS13,1),(XSWS14,1),(XSWS15,1)
         DSGEN (XDUM1,13),(XCRH,1),(XDUM3,18)                  @Z30CIMC
         DSGEN (XDATE,32)
         DSGEN (XTIME,32)
         DSGEN (XDUM2,8),(XSER,24)
         DSGEN (XMOD,16),(MCEL,16)
         DSGEN (XJOBN,64)
         DSGEN (XAIO1,16),(XAIO2,16),(XAIO3,16),(XAIO4,16)
         DSGEN (XAIO5,16),(XAIO6,16),(XAIO7,16),(XAIO8,16)
         DSGEN (XFCCWCC,8),(XFCCWDA,24),(XFCCWFL,8),(XFCCW0,8),        C
               (XFCCWCT,16)
         DSGEN (XCSWK,8),(XCSWCA,24)
         DSGEN (XCSWUS0,1),(XCSWUS1,1),(XCSWUS2,1),(XCSWUS3,1),        *
               (XCSWUS4,1),(XCSWUS5,1),(XCSWUS6,1),(XCSWUS7,1),        *
               (XCSWCS0,1),(XCSWCS1,1),(XCSWCS2,1),(XCSWCS3,1),        *
               (XCSWCS4,1),(XCSWCS5,1),(XCSWCS6,1),(XCSWCS7,1),        *
               (XCSWCT,16)
         DSGEN (XECSW,32)
         DSGEN (XDEVT1,16),(XDEVT2,16)
         DSGEN (XCHID,8),(XCUA,24)
         DSGEN (XMPIN,32)
         ORG   XMPIN                                           @YL02021
         DSGEN (VCUA,16),(VLGSZ,16)                            @YL02021
MPX01    DSGEN (MPXKEYW1,4),(MPXILEN,1),(MPXHLTBT,1),(MPXOPCOD,2),     X
               (MPXDADR,24)
         SPACE 2
MPX01A   DSGEN (MPXFLAGS,7),(MPXPREF,1),(MPXDAPC,1),                   X
               (MPXCNCK,1),(MPXPECK,1),(MPXPROCK,1),(MPXDTACK,1),      X
               (MPXBTCT,1),(MPXCNTPO,1),(MPXCNT7,1),(MPXBYCNT,16)
         SPACE 2
MPX02    DSGEN (MPXKEYW2,4),(DUM70,4),(MPXCOMAD,24)
         SPACE 2
MPX02A   DSGEN (MPXUCWP,8),(MPXCMAD,24)
         SPACE 2
MPX03    DSGEN (MPXCAW,1),(MPXCCWR,1),(MPXCCWIN,1),(MPXDTARQ,1),       X
               (MPXGOIO,1),(MPXTSTIO,1),(MPXHLTIO,1),(MPXPSIO,1),      X
               (MPXMOD1,1),(MPXMOD2,1),(MPXMOD3,1),(MPXMOD4,1),        X
               (DUM71,1),(MPXMOD6,1),(MPXMOD7,1),(DUM72,1),(MPXMOD9,1),X
               (MPXMOD10,1),(MPXMOD11,1),(DUM73,1),(MPXMCBCP,1),       X
               (MPXCNLAD,3),(MPXUNAD,8)
         SPACE 2
MPX03A   DSGEN (SELRST,1),(,2),(DISIN,1),(W3UCWCK,1),(,2),(MPXSECCK,1),X
               (MPXW0UCB,1),(MPXW2UCB,1),(MPXLSA,1),(MPXSTOR,1),       X
               (MPXCBTCT,1),(MPXTOUT,1),(MPXPRI,1),(DUM75,1),          X
               (MPXUADCK,1),(MPXCOMCK,1),(MPXBYCTC,1),(MPXINSEL,1),    X
               (MPXNOP,1),(MPXERSEQ,1),(MPXADI,1),(MPXSTI,1),          X
               (MPXBCP,1),(MPXBC4,1),(MPXBC2,1),(MPXBC1,1),(MPXILI,1), X
               (MPXDATAC,1),(MPXCHCK,1),(DUM76,1)
         DSGEN (VCCHPR0,1,1,9),(VCCHPR,1,10,16)                @YM2954P
         DSGEN (VCCHPR1,16,EQU,VCCHPR01)                       @YM2954P
         DSGEN (VDUM,24),(VFLAG,8),(VNOPRO,16)                 @YM2954P
         DSGEN (VPROC01,16),(VCHST01,16),(VPROC02,16),(VCHST02,16),    X
               (VPROC03,16),(VCHST03,16),(VPROC04,16),(VCHST04,16),    X
               (VPROC05,16),(VCHST05,16),(VPROC06,16),(VCHST06,16),    X
               (VPROC07,16),(VCHST07,16),(VPROC08,16),(VCHST08,16),    X
               (VPROC09,16),(VCHST09,16),(VPROC10,16),(VCHST10,16),    X
               (VPROC11,16),(VCHST11,16),(VPROC12,16),(VCHST12,16),    X
               (VPROC13,16),(VCHST13,16),(VPROC14,16),(VCHST14,16),    X
               (VPROC15,16),(VCHST15,16),(VPROC16,16),(VCHST16,16)
         EJECT
*
IFCEP000 DSECT
         DS    CL6
         DS    CL1
         DS    CL1
XPRTBUF  DS    15CL8
         DS    5CL8
         DS    3CL8
         DS    CL8
XSWITCH  DS    CL4
*
*      ROUTINE BRANCH TABLE
*
         DS    CL112
*
*      LOAD MODULE ENTRYPOINT NAMES
*
         DS    CL56
*
*      READ/WRITE BUFFER
*
XMCH     DC    XL2'00'
XCNTBUF  DS    CL8
XKEYBUF  DS    CL2
XDADBUF  DS    197CL8
XDUMMY   DS    CL1
         SPACE 3
ERPIB    DSECT                                                    19032
SOFWFLGS DS    CL1                 PROGRAM FLAGS FIELD IN ERPIB   19032
PROBERR  DS    CL1                 PROBABLE SOURCE OF ERROR FIELD 19032
VALFLAGS DS    CL1                 VALIDITY FLAGS FIELD           19032
CMPLBITS DS    CL1                 TERM AND RETRY CODES FIELD     19032
MPINFOFD DS    CL2                 MULTI-PROCESSING INFO FIELD    19032
CHSMS    DS    CL2                 CHANNEL STATUS FIELD           19032
         EJECT
IFCE2870 CSECT
ENTRYPTR DC    A(FORMAT1)
TABLNAME DC    CL8'IFCE2870'
REG9     DS    F
LP       DS    F
SPCLCODE EQU   *
SKIPPER  EQU   *
         BR    14
         SPACE 2
***********************************************************************
*                                                                     *
*                                                                     *
*    ROUTINE TO PICK UP THE CHANNEL ADDRESS WHICH IS NOT ON A BYTE    *
*   BOUNDRY, CONVERT IT TO HEX AND STORE IT IN THE PRINT BUFFER.      *
*                                                                     *
*                                                                     *
***********************************************************************
         SPACE 2
@CHANADR DS    0F
         USING *,15
         STM   14,12,12(13)        SAVE THE REGS
         MVC   MYWORK(1),0(4)
         NI    MYWORK,X'07'
         OI    MYWORK,X'F0'
         S     3,ONE
         MVC   0(1,3),MYWORK
         LM    14,12,12(13)        RESTORE THE REGS
         BR    14                  RETURN
*
         DROP  R15
         USING IFCE2870,R9
         USING C2870,R2
SETSOURC STM   R5,R8,XSAVE              SAVE REGS
         XC    NOPRO(4),NOPRO           CLEAR
         CLI   L0(R4),HEX20             TEST REC SOURCE
         BE    SETCCH                   CCH NORMAL
         CLI   L0(R4),HEX21             TEST SOURCE
         BE    SETCCH                   CCH VS2(MVM)
         CLI   L0(R4),HEX22
         BE    SETCCHC                  CHH CONVERTED
         CLI   L0(R4),HEX28
         BE    SETSER1                  SER1 CHAN REC
         CLI   L0(R4),HEX2A
         BE    SETSER1C                 SER1 CHAN REC CONVERTED
         CLI   L0(R4),HEX29
         BE    SETSER0                  SER0 CHAN REC
SETSER0C MVC   CSER0A(L9),CONVERTD      SET CONVERTED MSG
SETSER0  LA    R5,CSER0                 SET SER0 MSG PTR
         B     SETSRC
SETSER1C MVC   CSER1A(L9),CONVERTD      SET CONVERTED MSG
SETSER1  LA    R5,CSER1                 SET SERC MSG PTR
         B     SETSRC
SETCCHC  MVC   CCCHA(L9),CONVERTD       SET CONV MSG
SETCCH   LA    R5,CCCH                  SET CCH PTR
SETSRC   MVC   L0(L14,R3),L0(R5)        MOVE SOURCE TO LINE
         B     RETURN                   RETURN
*
ALLFFF   STM   R5,R8,SSAVE              SAVE REGS                43068
AG       CLC   L0(L4,R4),HFFF           IS WORD ALL FF"S         43068
         BNE   OK                       BR - NO                  43068
         L     R5,NOLOGPTR              POINT AROUND           @YM2954P
         ST    R5,REG9                   LOGOUT LINES          @YM2954P
         L     R5,NOLOGLAB                AND                  @YM2954P
         ST    R5,LP                       LABELS              @YM2954P
         MVC   L0(L21,R3),NOLOG
OK       EQU   *
OV       LM    R5,R8,SSAVE              RESTORE REGS             43068
         BR    R14                      EXIT                     43068
SSAVE    DC    4F'0'                    SMALL SAVE AREA          43068
HFFF     DC    X'FFFFFFFF'                                       43068
*
CRHACT   STM   R5,R8,XSAVE                                     @Z30CIMC
         TM    L0(R4),HEX04        CHANNEL RECONFIG ACTIVE     @Z30CIMC
         BO    RETURN              RETURN IF YES               @Z30CIMC
         L     R5,NOCRH            BYPASS CRH MESSAGE PRINTOUT @Z30CIMC
         ST    R5,REG9                                         @Z30CIMC
         L     R5,NOCRH1                                       @Z30CIMC
         ST    R5,LP                                           @Z30CIMC
         B     RETURN                                          @Z30CIMC
SETPGMN  MVC   L0(L8,R3),L0(R4)         MOVE 8 CHAR NAME TO BUFF
         BR    R14
*
SPACER2  LA    R3,L2(R3)                BUMP R3 PTR BY 2
         BR    R14
*
SETHEX   STM   R5,R8,XSAVE              SAVE REGS
         LA    R8,CHARS                 CHAR TABLE PTR
         IC    R7,L0(R4)                PICK UP CHAR
         SLL   R7,L24                   MOVE IT TO HI POS
         SR    R6,R6
         SLDL  R6,L4                    MOVE 4 BITS TO R6
         AR    R6,R8                    INDEX FOR CHARS
         MVC   L0(L1,R3),L0(R6)         MOVE CHAR TO BUFF
         SR    R6,R6
         SLDL  R6,L4                    MOVE LAST 4 BITS TO R6
         AR    R6,R8                    INDEX INTO TABLE
         MVC   L1(L1,R3),L0(R6)         MOVE CHAR
         B     RETURN
*
*
*
*                              SET ACTIVE  I/O UNITS
SETAIO   STM   R5,R8,XSAVE              SAVE REGS
         LR    R5,R3                    SET R5 TO BUFFER
         SH    R5,H43                   POINT R5 TO BEGGIN OF DATA
         SR    R7,R7
         LA    R6,L8                    LOOP COUNT
SETAIOLP CLC   L0(L4,R5),CZEROS         TEST FOR ALL ZEROS
         BE    BLANKOUT                 BE-TO BLANK OUT ZEROS
SETAIOL1 LA    R5,L5(R5)                BUMP COUNT
         BCT   R6,SETAIOLP              LOOP TILL 8 TESTS
         CH    R7,H8                    ARE ALL ACTIVE IO ZERO
         BNE   RETURN                   NO RETURN
         LR    R5,R3                    YES
         SH    R5,H43                   PUT IN NONE
         MVC   L0(L4,R5),NONE           INTO PRINT BUFF
         B     RETURN
BLANKOUT MVC   L0(L4,R5),BLANKS         MOVE IN BLANKS
         LA    R7,L1(R7)                COUNT # OF ZERO FLDS
         B     SETAIOL1                 LOOP
RETURN   LM    R5,R8,XSAVE
         BR    R14
*
*
CHKSW9   TM    L1(R4),HEX40             TEST SWITCHES
CHECKCC  BZ    NOPRT                    IF SWITCHES OFF
         BR    R14                      DONOT PRINT
CHKSW10  TM    L1(R4),HEX20             R15 RETURNED ZERO
         B     CHECKCC                  STOPS PRINTING
CHKSW11  TM    L1(R4),HEX10
         B     CHECKCC
CHKSW12  TM    L1(R4),HEX08
         B     CHECKCC
CHKSW13  TM    L1(R4),HEX04
         B     CHECKCC
CHKSW14  TM    L1(R4),HEX02
         B     CHECKCC
CHKSW15  TM    L1(R4),HEX01
         B     CHECKCC
NOPRT    SR    R15,R15
         BR    R14
*
SETDATE  UNPK  XWORK(L8),L0(L4,R4)      UNPACL DATE
         MVZ   XWORK+L7(L1),XWORK       SET ZONE
         MVC   L0(L3,R3),XWORK+L5       MOVE DAY
         MVC  L6(L2,R3),XWORK+L3
         BR    R14                      RETURN
*
CONVTIME TM    L0(R4),HEX48             TEST FOR NS/BIN CLOCK
         BZ    BINCLOCK                 ZERO IS BINARY CLOCK
         BO    RETURNB                  ONES IS FOR CONV TIME
         TM    L0(R4),HEX40             IF ON IS N/S CLOCK
         BO    NSCLOCK                  IF OFF TIME OK
RETURNB  BR    R14                      RETURN
*
         USING C2870,R2
ISITVS2  STM   R5,R8,XSAVE             SAVE REGS               @YL02021
         L     R5,DUMPIT                LOCATION OF DUMP PARMS @YM2954P
         MVC   L0(L2,R5),LOGSIZV2       VS 2 RECORD SIZE       @YM2954P
         CLI   XKEY,HEX21              IS IT VS2               @YL02021
         BE    RETURN                  YES                     @YL02021
         MVC   L0(L2,R5),LOGSIZV1       VS 1 RECORD SIZE       @YM2954P
         SR    R15,R15                 ELIM. LABEL             @YL02021
         B     RETURN                                          @YL02021
VS2TEST  STM   R5,R8,XSAVE             SAVE REGS               @YL02021
         CLI   XKEY,HEX21              IS IT VS2               @YL02021
         BE    RETURN                                          @YL02021
         B     COMPL                    SET UP FOR DUMP AND RET
PROC     STM   R5,R8,XSAVE             SAVE REGS               @YL02021
         SR    R5,R5                   CLEAR REG 5             @YL02021
         L     R5,NOPRO                PLACE THE NO. OF PROC. IN REG 5
         LA    R5,1(R5)                ADD ONE TO REG. 5       @YL02021
         ST    R5,NOPRO                PLACE BACK IN CORE      @YL02021
         CLC   VNOPRO(2),NOPRO+2       COMP. WITH ACTUAL NO. OF PROC.
         BL    COMPL                   FINISHED                @YL02021
         LR    R5,R3                                           @YL02021
         LA    R6,L47                   ADJUST OFFSET          @YM2954P
         SR    R5,R6                                           @YL02021
         MVC   L0(L17,R5),MSGA                                 @YL02021
         MVC   L27(L16,R5),MSGB                                @YM2954P
PROCBIN  LH    R4,L0(R4)           FETCH DATA                  @YM2954P
         SLL   R4,L15                   POSITION DATA
         LA    R6,L46              LENGTH OF LABEL             @YM2954P
         AR    R5,R6               SET UP POINTER              @YM2954P
         LA    R6,L16                   CHANGE COUNT           @YM2954P
TESTIT   SLL   R4,L1                    POSITION CHANNEL IND   @YM2954P
         LTR   R4,R4                    TEST FOR ON LINE       @YM2954P
         BNM   CHANACT                  BRANCH ON LINE         @YM2954P
PRINT    LA    R5,L3(R5)                UP DATE PRINT PTR
         BCT   R6,TESTIT           NEXT CHANNEL                @YM2954P
         B     RETURN                                          @YM2954P
CHANACT  MVI   L0(R5),C'X'         MOVE X TO PRINT             @YM2954P
         B     PRINT                    NEXT CHANNEL           @YM2954P
COMPL    SR    R15,R15                 CLEAR LABEL             @YL02021
         L     R5,DUMP                 LOAD ADDE OF DUMP       @YL02021
         ST    R5,REG9                                         @YL02021
         L     R5,DUMP1                                        @Z30CIMC
         ST    R5,LP                                           @Z30CIMC
         B     RETURN                                          @YL02021
NOPRO    DC    F'00'                                           @YL02021
MSGA     DC    C'PROCESSOR ADDRESS'                            @YL02021
MSGB     DC    C'CHANNELS ON LINE'                             @YM2954P
LOGSIZV1 DC    XL2'68'                                         @YM2954P
LOGSIZV2 DC    XL2'B0'                                         @YM2954P
DUMPIT   DC    A(DUMPSIZE)                                     @YM2954P
NSCLOCK  STM   R14,R12,L12(R13)         SAVE REGS
         NI    L0(R4),HEXBF
         MVC   XWORK(L8),XDATE          MOVE DATE
         LM    R4,R5,XWORK
         SRDL  R4,L12                   POSITION FOR MICRO SECS
         D     R4,MILLION               CONVERT TO SECONDS
         SRA   R4,L19                   POSITION FOR ROUNDING
         AR    R5,R4                    UP TO NXT SECONDS
         SR    R4,R4
         D     R4,SIXTY                 CONVERT TO NINS
         CVD   R4,XWORK                 CONVERT IT
         LH    R6,XWORK+L6              PICK UP SECONDS
         SRL   R6,L4                    SHIFT OFF ZONE
         STC   R6,XDATE+L6              STORE SECONDS IN  REC
         MVI   XDATE+L7,HEX00           ZERO OUT TH'S
         SR    R4,R4
         D     R4,SIXTY                 CONVERT TO HRS
         CVD   R4,XWORK                 CONVERT REMAINDER MINUTES
         LH    R6,XWORK+L6              PICK UP
         SRL   R6,L4                    DROP ZONE
         STC   R6,XDATE+L5              STORE MINUTES
         SR    R4,R4
         D     R4,T24                   DIVIDE TO GET DAYS
         CVD   R4,XWORK                 CONV REM
         LH    R6,XWORK+L6              PICK UP
         SRL   R6,L4                    DROP ZONE
         STC   R6,XDATE+L4              STORE HRS
         LA    R4,L60                   STARTINY YEAR 1960
         LA    R6,L1                    INC OF 1
LEAPYEAR LA    R7,L3(R4)                ADD 3 YRS
         S     R5,LPYEAR                DAYS IN LEAP YEAR 366
         BZ    THISYEAR                 BR-THIS YR+1
         BM    OVERSHOT                 BR-TOOFAR
         BXLE  R4,R6,REGYEAR            UPDATE YEAR BY ONE
REGYEAR  S     R5,RGYEAR                DAYS IN RG YEAR 365
         BZ    THISYEAR                 BR-YEAR+1
         BM    OVERSHT1                 BR-TOO FAR
         BXLE  R4,R6,REGYEAR            UPDATE AND TRY AGAIN
         B     LEAPYEAR
OVERSHOT A     R5,LPYEAR                ADD BACK LEAP YEAR
         B     THISYEAR                 & USE
OVERSHT1 A     R5,RGYEAR                ADD BACK REG YEAR
         B     THISYER                  & USE
THISYEAR AR    R4,R6                    ADD 1
THISYER  AR    R5,R6                    ADD 1
         CVD   R5,XWORK                 CONVERT DAYS
         MVC   XDATE+L2(L2),XWORK+L6    MOVE DAYS
         CVD   R4,XWORK                 CONVERT YEAR
         LH    R6,XWORK+L6              PICK UP
         SRL   R6,L4                    DROP ZONE
         STC   R6,XDATE+L1              PUT YEAR
         MVI   XDATE,HEX00              SET TO ZERO
RETURNC  OI    XSWS8,HEX08              TURN ON PACKED SWITCH
         LM    R14,R12,L12(R13)         RETURN
         BR    R14
*
*
BINCLOCK STM   R14,R12,L12(R13)         SAVE REGS
         LR    R8,R2                    SAVE RECORD POINTER       P6566
         L     R3,XTIME                 PICK UP TIME IN BIN
         LTR   R3,R3                    TEST FOR ZERO
         BZ    RETURNC                  YES-RETURN
         SRL   R3,L1                    CONVERT
         M     R2,CONSTG                     TO
         D     R2,CONSTH                       DECIMAL
         LA    R4,L32                   BIT COUNTER
         MVI   TIMDIV+L3,DIV1           INITIAL DIVISOR (0A)
BCLOCKA  SR    R2,R2                    CLEAR
         D     R2,TIMDIV                DEVOLP DIGIT-REMAINDER
         LR    R0,R2                    SAVE REM
         SRDL  R0,L4                    SHIFT 4BITS
         SH    R4,H4                    DEC BY 4
         LTR   R3,R3                    DONE
         BZ    BCLOCKB                  BR-YES
         CH    R4,H24                   BITS LESS 24
         BNL   BCLOCKA                  BR-NO
         XI    TIMDIV+L3,DIV2           ALT DIV (0A XI 0C=06)
         B     BCLOCKA
BCLOCKB  SRL   R1,L0(R4)                MOVE TO FINAL POS
         LR    R2,R8                    RESTORE RECORD POINTER    P6566
         ST    R1,XTIME                 STORE BACK
         B     RETURNC
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
L12      EQU   12
L14      EQU   14
L27      EQU   27                                              @YM2954P
L46      EQU   46                                              @YM2954P
L47      EQU   47                                              @YM2954P
L17      EQU   17                                              @YL02021
L19      EQU   19
L24      EQU   24
L25      EQU   25                                              @YL02021
L32      EQU   32
L44      EQU   44                                              @YL02021
L60      EQU   60
L66      EQU   66                                              @YL02021
HEXBF    EQU   X'BF'
HEX48    EQU   X'48'
HEX02    EQU   X'02'
HEX04    EQU   X'04'
HEX08    EQU   X'08'
HEX10    EQU   X'10'
HEX20    EQU   X'20'
HEX21    EQU   X'21'                                           @YL02021
HEX40    EQU   X'40'
HEX22    EQU   X'22'
HEX28    EQU   X'28'
HEX2A    EQU   X'2A'
HEX29    EQU   X'29'
HEX01    EQU   X'01'
HEX00    EQU   X'00'
DIV1     EQU   X'0A'
DIV2     EQU   X'0C'
L0       EQU   0
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L5       EQU   5
L6       EQU   6
L7       EQU   7
L8       EQU   8
L9       EQU   9
L10      EQU   10
XWORK    DS    D
XSAVE    DS    4F
CONSTG   DC    X'00030D40'
CONSTH   DC    X'024AE062'
MILLION  DC    F'1000000'
SIXTY    DC    F'60'
T24      DC    F'24'
LPYEAR   DC    F'366'
RGYEAR   DC    F'365'
TIMDIV   DC    F'1'
H4       DC    H'4'
H8       DC    H'8'
H24      DC    H'24'
H43      DC    H'43'
CHARS    DC    C'0123456789ABCDEF'
NONE     DC    C'NONE'
CONVERTD DC    C'CONVERTED'
CZEROS   DC    C'0000'
BLANKS   DC    C'    '
CCCH     DC    CL5'CCH'
CCCHA    DC    CL9' '
CSER1    DC    CL5'SER1'
CSER1A   DC    CL9' '
CSER0    DC    CL5'SER0'
CSER0A   DC    CL9' '
MYWORK   DC    F'0'
ONE      DC    F'1'
VS2FLG   DC    X'00'                                           @YL02021
DUMP     DC    A(DMPSPACE-4)                                   @Z30CIMC
DUMP1    DC    A(DMPSPC1-1)                                    @Z30CIMC
         EJECT
****    NUMERICAL EQUATES
L13      EQU   13
L15      EQU   15
L16      EQU   16
L20      EQU   20
L21      EQU   21
L22      EQU   22
L26      EQU   26
L31      EQU   31
L40      EQU   40
X01      EQU   X'01'
X02      EQU   X'02'
X04      EQU   X'04'
X08      EQU   X'08'
X09      EQU   X'09'
X10      EQU   X'10'
X20      EQU   X'20'
X30      EQU   X'30'
X40      EQU   X'40'
X80      EQU   X'80'
****    ADDRESS EQUATES
AD0      EQU   0
AD4      EQU   4
AD12     EQU   12
AD13     EQU   13
AD14     EQU   14
AD15     EQU   15
AD16     EQU   16
AD20     EQU   20
AD37     EQU   37
AD41     EQU   41
AD45     EQU   45
AD55     EQU   55
AD63     EQU   63
AD69     EQU   69
AD108    EQU   108
****    CONDITION CODE EQUATES
CC1      EQU   1
CC7      EQU   7
CC8      EQU   8
IFCASR01 DS    0H
         USING *,R15
         STM   R14,R12,12(R13)          SAVE REGISTERS
         CLI   XKEY,HEX21                                      @YL02021
         BNE   CONTIN                                          @YL02021
         OI    VS2FLG,X01                                      @YL02021
CONTIN   ST    R13,SVR13                                       @YL02021
         L     R11,NXENTRY              LOAD SUBROUTINE RETURN ADR
         LTR   R11,R11                  TEST FOR INITIAL ENTRY
         BZ    IFCASR02                 BRANCH IF 0-INITIAL ENTRY
         LM    R12,R10,MYSAVE           RELOAD SUBROUTINE REGS
         BR    R11                      CONTINUE PROCESSING
IFCASR02 DS    0H
         SH    R3,TWOX                  SUBTRACT 2 FROM PRNT BFR ADR
         MVC   L0(L1,R3),L1(R3)         MOVE PRINTER CNTRL CHAR
         LA    R3,L1(R3)                INCREMENT PRNT BFR ADR
         USING XDADBUF,R4
         USING XPRTBUF,R3
         USING XKEYBUF,R2
NEWMOVE  CLI   XKEYBUF+1,REL19          RELEASE 19                19E03
         BE    NEWMOVE1                 BRANCH--YES               19E03
         MVC   CSWORD(8),XDADBUF+54     MOVE CSW                  19E03
         MVC   ERPIBFLD(4),XDADBUF+62   MOVE ERPIB                19E03
         MVC   MULTISYS(4),XDADBUF+74   MOVE CHANSTAT INFO        19E03
         B     CONTINUE                 CONTINUE                  19E03
NEWMOVE1 MVC   CSWORD(8),XDADBUF+46     MOVE CSW                  19E03
         MVC   ERPIBFLD(4),XDADBUF+54   MOVE ERPIB                19E03
         MVC   MULTISYS(4),XDADBUF+66   MOVE CHANSTAT INFO        19E03
CONTINUE LA    R9,ERPIBFLD              DSECT ADDRESSIBILITY      19E03
         USING ERPIB,R9
         MVI   SETUPBFR+1,C'*'                                     MP
         MVC   SETUPBFR+2(78),SETUPBFR+1                           MP
         BAL   BRANPRT,XWRTPRT    MOVE BORDER TO BUFFER AND WRITE  MP
         L     R6,VS2                                          @YL02021
         CLI   0(R6),X'01'                                     @YL02021
         BE    DUMMYTST                                        @YL02021
         MVI   SETUPBFR,C'-'           SKIP TWO SPACES             MP
         TM    MPINFOFD,MSBIT      IS MULTI-SYSTEM BIT SET        19032
         BZ    DUMMYTST      IFNOT,CKECK FOR ENTRANCE FROM ASR01   MP
         LA    SETUPADR,SETUPBFR       ADDRESS OF PRINT BUFFER     MP
         MVC   24(24,SETUPADR),MSHEAD   MOVE MULTI-SYSTEM HDR TO BUFMP
         BAL   BRANPRT,XWRTPRT     WRITE HEADER                    MP
         MVI   SETUPBFR+1,C'*'                                     MP
         MVI   VDSTAR,C'*'                                         MP
         BAL   BRANPRT,XWRTPRT     WRITE LINE DIVIDER              MP
*                                                                  MP
*                                                                  MP
*              THIS ROUTINE FORMATS AND PRINTS A MESSAGE           MP
*              CONTAINING THE ID OF THE FAILING CPU AND            MP
*              THE STATUS OF THE MULTI-PROCESSING SYSTEM           MP
*                                                                  MP
*                                                                  MP
         MVC   10(12,SETUPADR),MSCPUID  MOVE CPUID MESSAGE TO BUFFERMP
         MVC   30(15,SETUPADR),MSCPUST  MOVE CPU STATUS MESSAGE    MP
         MVI   0(SETUPADR),C'-'    SKIP TWO SPACES AFTER LINE      MP
         TM    MPINFOFD,ID         TEST FOR WHICH CPU             19032
         BZ    STATEST       SKIP CPU ID                           MP
         MVI   14(SETUPADR),C'2'   INSERT CPUID=CPU2               MP
STATEST  IC    R1,MPINFOFD         GET MS BYTE IN MPINFO          19032
         SLL   R1,30               CLEAR FOR CPUSTAT               MP
         LTR   R1,R1               TEST FOR ZERO,NEGATIVE OR POSITIVEMP
         BC    12,SHARED           IS STATUS NOT PARTITION         MP
         MVC   45(11,SETUPADR),PART     STATUS WAS PARTITIONED     MP
         B     CHANTEST      GO FOR CHANNEL STATUS                 MP
SHARED   MVC   45(6,SETUPADR),SHAR      SHARED STATUS              MP
         BE    CHANTEST                 WAS CPU RECONFIGURED OUT   MP
         MVC   51(21,SETUPADR),RECON    YES                        MP
         EJECT
*                                                                  MP
*                                                                  MP
*              THIS ROUTINE TESTS A TWO BYTE FIELD                 MP
*              MPINFO FIELD                          TO DETERMINE
*              THE CHANNEL STATUS FOR BOTH CPUS AND FORMAT         MP
*              A MESSAGE TO INDICATE THAT STATUS                   MP
*                                                                  MP
*                                                                  MP
CHANTEST BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP
         MVI   0(SETUPADR),C'-'         SKIP TWO SPACES            MP
         MVC   10(27,SETUPADR),CHCNFIG  CHANNEL CONFIGURATION MESSAGEMP
         LA    UPKREG,0                                            MP
         TM    MPINFOFD,ID         WAS CPUID=CPU2                 19032
         BZ    CCHMOVE                 NO                          MP
         MVI   14(SETUPADR),C'2'        YES, ENTER ID 2            MP
CCHMOVE  BAL   BRANPRT,XWRTPRT          PRINT MESSAGE              MP
         LA    R1,7                     LOOP CONTROL               MP
         LA    R2,14(SETUPADR)          PTR TO SLOT FOR 'OFF' MESSAGEMP
         IC    R5,CHSMS(UPKREG)         GET CHANNEL STATUS BYTE    MP
         MVC   10(55,SETUPADR),CHTAB    GET LIST OF CHANNELS       MP
         SLL   R5,24                    POSITION BYTE FOR BIT TESTINGMP
MSLOOP   LTR   R5,R5         IS BIT ON (NEGATIVE REG) OR OFF       MP
         BC    10,MSUPDT                NO                         MP
         MVC   0(3,R2),OFF              CHANNEL OFFLINE            MP
MSUPDT   SLL   R5,1                     MOVE TO NEXT CHANNEL BIT   MP
         LA    R2,8(R2)                 UPDATE MESSAGE POINTER     MP
         BCT   R1,MSLOOP                EXIT AFTER 7-BITS PROCESSED MP
MSREND   BAL   BRANPRT,XWRTPRT          WRITE CHANNEL STATUS MESSAGEMP
         LTR   UPKREG,UPKREG            TEST FOR SECOND TIME THROUGH MP
         BC    7,PRTHD                  BOTH BYTES OF CHANSTAT PRINTED
         LA    UPKREG,1(UPKREG)         PTR TO 2ND.BYTE OF CHANSTATMP
         MVC   10(27,SETUPADR),CHCNFIG  MOVE IN CHANNEL CONFIGURATIONMP
*                                       MESSAGE                    MP
         MVI   0(SETUPADR),C'0'         SKIP SPACE AFTER NEXT MESSAGEMP
         TM    MPINFOFD,ID         ESTABLISH CPUID                19032
         BO    CCHMOVE                  BRANCH IF CPUID=CPU2       MP
         MVI   14(SETUPADR),C'2'        PUT CPU2 IN MESSAGE        MP
         B     CCHMOVE       PRINT MESSAGE                         MP
PRTHD    MVI   SETUPBFR+1,C'*'             SETUP TO PRINT DIVIDER
         MVC   2(78,SETUPADR),1(SETUPADR)
         MVI   SETUPBFR,C'0'               SPACE FIRST
         BAL   BRANPRT,XWRTPRT             PRINT DIVIDER
DUMMYTST LA    SETUPADR,SETUPBFR   GET ADDR OF BUFFER FOR PRINT    MP
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR DUMMY ERPIB     19032
         BNE   MSCONT                   CONTINUE IF MEANINGFUL ERPIB MP
         MVI   0(SETUPADR),C'-'         SKIP 2 LINES               MP
         MVC   10(17,SETUPADR),MSNERPIB ERPIB NOT CREATED MESSAGE  MP
         BAL   BRANPRT,XWRTPRT          PRINT INFORMATION          MP
         B     RETCNTL       RETURN CONTROL                        MP
*                                                                  MP
         EJECT
MSCONT   EQU   *                                                   MP
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*                          INSTRUCTION ANALYSIS                       *
*        THIS PROGRAM SECTION WILL INSPECT THE FIRST FOUR(4) BITS IN  *
*        THE FIRST BYTE  OF THE              ERPIB AREA, TO DETERMINE *
*        THE INSTRUCTION CAUSING THE ERROR.                           *
         LA    SETUPADR,SETUPBFR       SET UP HEADER BOARDER.
         MVC   SETUPBFR+27(25),HEADER    SET UP HEADER MESSAGE
         MVI   0(SETUPADR),C'0'          SPACE ONE LINE
         BAL   BRANPRT,XWRTPRT
*                                                                     *
*                            TEST FOR INTERRUPT                       *
*                                                                     *
         TM    SOFWFLGS,X'40'          INTERRUPT TEST.
         BZ    INST
         MVC   SETUPBFR(42),ERRINT     BUFFER INTERRUPT MESSAGE.
         B     RITEOUT
*                                                                     *
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*                                                                     *
*        BITS 32-35 WILL BE TESTED                                    *
*                                                                     *
INST     MVC   SETUPBFR(33),CAUSERR    TYPE-INST ERROR HEADER.
         TM    SOFWFLGS,X'80'          TEST FOR SIO INSTRUCTION ERROR.
         BO    PRTERSIO                BRANCH TO SETUP PRINT BUFFER.
         TM    SOFWFLGS,X'20'          TEST FOR TIO INSTRUCTION.
         BO    PRTERTIO                BRANCH TO SETUP PRINT BUFFER.
*                                                                     *
PRTERHIO MVC   SET1(3),ERRHIO          MOVE HIO LABEL INTO BUFFER.
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.
*                                                                     *
PRTERSIO MVC   SET1(3),ERRSIO          MOVE SIO LABEL INTO BUFFER.
         B     RITEOUT                 PREPARE TO WRITE MESSAGE.
*                                                                     *
PRTERTIO MVC   SET1(3),ERRTIO          MOVE TIO LABEL INTO BUFFER.
*                                                                     *
RITEOUT  BAL   BRANPRT,XWRTPRT         WRITE OUT APPROPRIATE MESSAGE.
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*        THE FOLLOWING PROGRAM SECTION WILL INSPECT THE ERPIBFLD
*        TO DETERMINE IF AN ERPIB IS PRESENT.   IF  ONE IS
*        NOT FOUND, CONTROL WILL BE RETURNED.
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
         OC    ERPIBFLD+1(3),ERPIBFLD+1  TEST FOR  ERPIB PRESENT  19032
         BZ    NONEXIST                WRITE MSG TO INDICATE NONEXISTS.
         B     TEST1         TEST COMPLETION CODE                  MP
SETVD    EQU   XPRTBUF+33                                          MP
*                         UCB ADDRESS NON-EXISTANT
NONEXIST MVC   SETUPBFR(45),NOUCB        SET UP MSG FOR NO UCB
         BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.
         B     RETCNTL                 RETURN TO CONTROL.
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*        THE FOLLOWING PROGRAM SECTION WILL TEST  BYTE 5     OF THE
*        ERPIB FOR A NO RETRY BIT SETTING. IF ON, CONTROL IS RETURNED
*        AFTER MESSAGE IS PRINTED OUT.
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*                       OUTPUT RETRY CODE VALUE
*
*   *    *    *    *    *    *    *    *    *    *    *    *    *    *
*                            TEST SOFTWARE FLAGS
TEST     MVC   SETUPBFR(32),RETCDVAL     BUFFER THE BASIC MESSAGE
         IC    REG,CMPLBITS        CONTENTS OF BYTE 8 INTO R3     19032
         TM    VALFLAGS,X'10'            TEST FOR VALID RETRY CODE
         BO    VALFLG              IF VALID, GO SETUP MESSAGE
         MVC   33(43,SETUPADR),NOTVM  SETUP NOT ASSESSABLE MESSAGE
         B     BUFITA           GO PRINT IT
VALFLG   N     REG,MASK            GET RID OF UNNEED BITS
         STC   REG,RCMSG+12        STORE NO. IN RETRY CODE MSG
         OI    RCMSG+12,X'F0'      MAKE PRINTABLE
         MH    REG,CONST
         LA    REG,MSGSTRT(REG)    SET UP MSG INDEX
         MVC   33(44,SETUPADR),0(REG)  MOVE MSG TO BUFFER
BUFIT    BAL   BRANPRT,XWRTPRT     PRINT IT
         MVC   34(14,SETUPADR),RCMSG  MOVE RETRY MSG TO BUFFER
BUFITA   BAL   BRANPRT,XWRTPRT
         TM    CMPLBITS,X'08'      IS DISCONNECT IN SET           19032
         BNO   NOTDISIN            NO, SKIP MSG                   19032
         MVC   SETUPBFR(23),DISCIN SET UP MSG                     19032
         BAL   BRANPRT,XWRTPRT     PRINT MSG                      19032
NOTDISIN EQU   *                                                  19032
*
*                                  TEST NO-RETRY BIT
         TM    SOFWFLGS,X'01'          IF NORETRY BIT IS NOT ON,BRANCH
*                                      TO PRINT VALID INDICATOR MSG.
         BZ    VALIDIND
         MVC   SETUPBFR(28),NORETRY    INDICATES THAT THE BIT WAS ON.
         BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.
         B     RETCNTL                 RETURN CONTROL.
VALIDIND MVC   SETUPBFR(29),VALIDITY   RECORDED DATA HEADING TO BUFFER
         BAL   BRANPRT,XWRTPRT         INDICATOR HEADER.
*
*                                  TEST VALID RETRY CODE
*
*
*                            TEST COUNT BIT
         MVC   SETUPBFR(42),VALCOUNT   BUFFER THE BASIC MESSAGE.
         TM    SOFWFLGS,X'02'          TEST COUNT VALIDITY.
         BZ    INVCOUNT                IF OFF, PRINT INVALID MSG.
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
INVCOUNT BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.
*
*                            TEST FOR SENSE DATA STORED
*
         MVC   SETUPBFR(43),SENSDATA   BUFFER THE BASIC MESSAGE.
         TM    SOFWFLGS,X'04'          TEST SENSE BIT.
         BZ    NOSTORE                 IF OFF BRANCH TO WRITE NOSTORE.
         MVC   33(10,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
NOSTORE  BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.
*                            TEST UNIT STATUS BIT
         MVC   SETUPBFR(42),INVALUN    BUFFER THE BASIC MESSAGE.
         TM    VALFLAGS,X'08'          TEST FOR VALID UNIT STATUS.
         BZ    WRTOUT                  UNIT STATUS INVALID.
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
WRTOUT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.
*
*                            TEST COMMAND ADDRESS BIT
*
         MVC   SETUPBFR(42),INVALCAD   MOVE INVALID COM MSG TO BUFFER.
         TM    VALFLAGS,X'04'          TEST FOR VALID COMMAND ADDRESS.
         BZ    PTOUT                   COMMAND ADDRESS INVALID.
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
PTOUT    BAL   BRANPRT,XWRTPRT         WRITE THE MESSAGE.
*
*                            TEST CHANNEL ADDRESS BIT
*
         MVC   SETUPBFR(42),INVALCHA   MOVE INVALID CHN MSG TO BFR.
         TM    VALFLAGS,X'02'          TEST FOR VALID CHANNEL ADDRESS.
         BZ    OUTWRT                  INVALID CHANNEL ADDRESS.
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
OUTWRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.
*
*                            TEST FOR VALID DEVICE ADDRESS
*
         MVC   SETUPBFR(42),INVALDVA   MOVE INVALID DVC ADDR MSG TO BFR
         TM    VALFLAGS,X'01'          TEST FOR VALID DEVICE ADDRESS.
         BZ    OUTPRT                  INVALID DEVICE ADDRESS.
         MVC   33(9,SETUPADR),37(SETUPADR) MODIFY THE BASIC MESSAGE.
OUTPRT   BAL   BRANPRT,XWRTPRT         WRITE MESSAGE.
*
*        PROBABLE SOURCE OF ERROR
*
         MVC   SETUPBFR(29),PSOERR      INSERT BASE MSG IN BUFFER
         CLI   PROBERR,X'80'            TEST FOR CPU ERROR
         BE    CPUER                    BRANCH TO SET UP CPU ERR MSG
         CLI   PROBERR,X'40'            TEST FOR CHANNEL ERROR
         BE    CHNER                    BRANCH TO SETUP CHANNEL ERROR
         CLI   PROBERR,X'20'       TEST FOR SCU ERROR             19032
         BE    SCUER               YES- GO SET UP FOR SCU ERRMSG  19032
         CLI   PROBERR,X'10'            TEST FOR STORAGE ERROR
         BE    STORGER                  GO SETUP STORAGE ERROR MSG
         CLI   PROBERR,X'08'            TEST FOR I/O INTERFACE ERROR
         BE    INFER                    GO SETUP I/O INTF ERROR MSG
         MVC   30(25,SETUPADR),NOTVM    SETUP NOT ASSESSABLE MESSAGE
         B     WPRMSG                   GO PRINT MSG
CPUER    MVC   30(3,SETUPADR),CPUERMSG  BUFFER CPU ERROR MESSAGE
         B     WPRMSG                   GO PRINT
CHNER    MVC   30(7,SETUPADR),CHANERMS  SETUP CHANNEL ERROR MESSAGE
         B     WPRMSG                   GO PRINT
SCUER    MVC   30(20,SETUPADR),SCUERMS  SET UP SCU MSG            19032
         B     WPRMSG                   GO PRINT IT               19032
STORGER  MVC   30(7,SETUPADR),STOGERMS  SETUP STORAGE ERROR MESSAGE
         B     WPRMSG                   GO PRINT
INFER    MVC   30(13,SETUPADR),IOINFER  SET UP INTERFACE ERROR MESSAGE
WPRMSG   BAL   BRANPRT,XWRTPRT          PRINT MESSAGE
         B     RETCNTL
*
*                            TEST COMPLETION CODE
*
TEST1    MVC   SETUPBFR(23),COMCODE    INSERT COMPLETION CODE MESSAGE
*                                      IN PRINT BUFFER.
         TM    CMPLBITS,X'C0'          TEST FOR COMPLETION CODE '3'.
         BO    SYSRET                  BRANCH FOR SYS RESET MSG OUTPUT.
         TM    CMPLBITS,X'80'          TEST FOR COMPLETION CODE '2'
         BO    SELRET                  BRANCH FOR SEL RESET MSG OUTPUT.
         TM    CMPLBITS,X'40'          TEST FOR COMPLETION CODE '1'
         BO    FORENDSQ                BRANCH FOR FORCED END MSG OUTPUT
*
*                            INTERFACE DISCONNECT
*
         MVC   SET2(29),INTDISCN      SET UP INTERFACE DISCONNECT MSG
         B     WRITER                  MESSAGE AND WRITE IT OUT.
*
*                            SYSTEM RESET
*
SYSRET   MVC   SET2(21),SYSRES        SETUP  THE SYSTEM RESET MSG AND
         B     WRITER                  WRITE IT OUT.
*
*                            SELECTIVE RESET
*
SELRET   MVC   SET2(24),SELRES          SETUP SELECTIVE RESET  MSG AND
         B     WRITER                  AND WRITE IT OUT.
*
*                            FORCED ENDING SEQUENCE
*
FORENDSQ MVC   SET2(31),FORCEND         SETUP FORCE END MESSAGE AND
*                                      WRITE IT OUT.
*
*                            OUTPUT OF COMPLETION
*                              CODE MESSAGES
*
WRITER   BAL   BRANPRT,XWRTPRT
         B     TEST
*
*                                 RETURN CONTROL
*
RETCNTL  EQU   *                                                  19032
         MVI   SETUPBFR+1,C'*'
         MVC   2(78,SETUPADR),1(SETUPADR)
         MVI   0(SETUPADR),C'-'         SETUP TO SPACE TWICE
         BAL   BRANPRT,XWRTPRT
         TM    CSWORD+5,X'06'           TEST FOR CHN OR INTF CTL CHK
         BC    8,MSG                   NO, PRINT LOGOUT MESSAGE.
FIN1     DS    0C
         LA    R0,0                     ZERO WORK REGISTER
         ST    R0,NXENTRY               CLEAR ENTRY POINTER
         L     R13,SVR13                RESTORE REG 13
         LM    R14,R12,12(R13)          RESTORE REGISTERS
         BR    R14                      RETURN
*
*                            PRINT NO-LOGOUT MESSAGE
*
MSG      MVC   SETUPBFR+1(78),ERMSG     MESSAGE IN BUFFER
         BAL   BRANPRT,XWRTPRT
         L     R0,NOLOGPTR              POINT                  @YM2954P
         L     R1,RG9PTR                 AROUND                @YM2954P
         ST    R0,AD0(R1)                 LOGOUT               @YM2954P
         L     R0,NOLOGLAB                 LINES               @YM2954P
         L     R1,LPPTR                     AND                @YM2954P
         ST    R0,AD0(R1)                    LABELS            @YM2954P
         B     FIN1
*                                                                  MP
         SPACE
****    ROUTINE TO RETURN CONTROL TO CONTROL MODULE
XWRTPRT  DS    0C
         ST    BRANPRT,NXENTRY          STORE LINK ADDRESS
         STM   R12,R10,MYSAVE           SAVE SUBROUTINE REGS
         L     R0,RTNPTR                LOAD ADCON FOR RETURN POINTER
         L     R1,RG9PTR                LOAD POINTER TO REG9
         ST    R0,AD0(R1)               STORE RETURN POINTER
         L     R0,LBLPTR                LOAD POINTER TO LABEL
         L     R1,LPPTR                 LOAD POINTER TO LP
         ST    R0,AD0(R1)               STORE LABEL POINTER
         MVI   L0(R3),X09               SET CARRIAGE CTL CHAR
         L     R13,SVR13                RESTORE REG 13
         LM    R14,R12,12(R13)          RESTORE REGISTERS
         BR    R14                      RETURN
*
*                            STORAGE
*
         DS    0F
TYPE     EQU   XDADBUF+5                                           MP
ENVCH    EQU   XDADBUF+56                                          MP
ENVMS    EQU   XDADBUF+63                                          MP
GPRMS    EQU   XDADBUF+248                                         MP
ONEVD    EQU   X'01'                                               MP
TWEN     EQU   X'20'                                               MP
EIGHTY   EQU   X'80'                                               MP
VDSTAR   EQU   XPRTBUF+79                                          MP
PLACE    EQU   ENVCH+32                                            MP
F252     EQU   252                                                 MP
FROMVD   EQU   GPRMS+32                                            MP
OCTVD    EQU     80                                                MP
AREAVD   EQU   GPRMS+92                                            MP
ID       EQU   X'08'                                               MP
MSBIT    EQU   X'10'                                                MP
K0       EQU   0                                                  19E03
K1       EQU   1                                                  19E03
K2       EQU   2                                                  19E03
K4       EQU   4                                                  19E03
K8       EQU   8                                                  19E03
K10      EQU   10                                                 19E03
K20      EQU   20                                                 19E02
K21      EQU   21                                                 19E02
K24      EQU   24                                                 19E03
FOXDOG   EQU   X'FD'                                              19E03
REL19    EQU   19                                                 19E02
XPRTBUF1 EQU   XPRTBUF+1                                          19E03
*
SETUPBFR EQU   XPRTBUF
CSWORD   DC    D'0'                CSW LOCATION                   19032
ERPIBFLD DC    F'0'                LAST HALF ERPIB                19032
MULTISYS DC    F'0'                MULTI-PROCESSING INFO          19032
MASK     DC    F'7'
NXENTRY  DC    F'0'
MYSAVE   DS    15F
SVR13    DS    1F
VS2      DC    A(VS2FLG)                                       @YL02021
RTNPTR   DC    A(PRTERPIB-4)
RG9PTR   DC    A(REG9)
LBLPTR   DC    A(LABELEND-1)
LPPTR    DC    A(LP)
NOLOGPTR DC    A(VS2LINE-4)                                    @YM2954P
NOLOGLAB DC    A(VS2LAB-1)                                     @YM2954P
NOCRH    DC    A(NOTCRH-4)                                     @Z30CIMC
NOCRH1   DC    A(NOTCRH1-1)                                    @Z30CIMC
CONST    DC    H'44'
TWOX     DC    H'2'
SET1     EQU   SETUPBFR+22
SET2     EQU   SETUPBFR+21
*
*                            REGISTERS
REG      EQU   11
UPKREG   EQU   6                       ADDRESSES UNPACK AREA.
SETUPADR EQU   7                       ADDRESSES PRINT BUFFER.
PRTABREG EQU   8                       ADDRESSES CONVERSION TABLE.
BASEREG  EQU   9                       BASE REGISTER.
BRANPRT  EQU   11                      ADDRESSES PRINT ROUTINE.
CLEAREG  EQU   12
SAVADDR  EQU   13                      ADDRESSES REGISTER SAVE AREA.
BRANADDR EQU   14                      BRANCH REGISTER.
XLABELP  EQU   LP
WORK     EQU   XWORK
*
*                            MESSAGES
*
*
CAUSERR  DC    C'   CSW STORED BY  --             '
ERRINT   DC    C'   CSW STORED BY  INTERRUPT               '
ERRSIO   DC    C'SIO'
ERRTIO   DC    C'TIO'
ERRHIO   DC    C'HIO'
NOUCB    DC    C'   NO ADDITIONAL ERROR INFORMATION AVAILABLE.'
COMCODE  DC    C'   TERMINATION BY  --  '
SYSRES   DC    C' SYSTEM RESET- CODE 3'
SELRES   DC    C' SELECTIVE RESET- CODE 2'
FORCEND  DC    C' FORCED ENDING SEQUENCE- CODE 1'
INTDISCN DC    C' INTERFACE DISCONNECT- CODE 0'
RETCDVAL DC    C'   TIME CHANNEL DETECTED ERROR -'
RCMSG    DC    C'RETRY CODE    '
MSGSTRT  DC    C' WHILE EXECUTING TIO                        '
         DC    C' BETWEEN COMMAND OUT AND UNIT STATUS RETURN '
         DC    C' COMMAND ACCEPTED BUT BEFORE DATA TRANSFER  '
         DC    C' SOME DATA TRANSFER-CSW COMMAND ADR UPDATED '
         DC    C' COMMAND REJECTED OR COMMAND OUT NOT SENT   '
         DC    C' COMMAND ACCEPTED-DATA TRANSFER UNDETERMINED'
         DC    C' COULD NOT BE ASSESSED                      '
NOTVM    DC    C' COULD NOT BE ASSESSED                      '
NORETRY  DC    C'   PROGRAM ASSESSED NO RETRY'
DISCIN   DC    C'   DISCONNECT IN ISSUED'                         19032
VALIDITY DC    C'   VALIDITY OF RECORDED DATA '
VALCOUNT DC    C'            COUNT              = NOT VALID'
SENSDATA DC    C'            SENSE DATA         = NOT STORED'
INVALUN  DC    C'            UNIT STATUS        = NOT VALID'
INVALCAD DC    C'            COMMAND ADDRESS    = NOT VALID'
INVALCHA DC    C'            CHANNEL ADDRESS    = NOT VALID'
INVALDVA DC    C'            DEVICE ADDRESS     = NOT VALID'
PSOERR   DC    C'   PROBABLE SOURCE OF ERROR- '
CPUERMSG DC    C'CPU'
CHANERMS DC    C'CHANNEL'
SCUERMS  DC    C'STORAGE CONTROL UNIT'                            19032
STOGERMS DC    C'STORAGE'
IOINFER  DC    C'CONTROL UNIT '
HEADER   DC    C' CHANNEL  ERROR  ANALYSIS'
ERMSG    DC    C'CHANNEL CTRL OR I/F CTRL CHECK '
         DC    C'NOT INDICATED IN CSW-NO LOGOUT'
         DC    C' WITH THIS RECORD'
NOLOG    DC    C'CHANNEL FAILED TO LOG'
MSHEAD   DC    C'MULTI-SYSTEM INFORMATION'              MESSAGES   MP
MSCPUID  DC    C'CPU 1 FAILED'                           FOR        MP
MSCPUST  DC    C'CPU STATUS WAS '              ONLY THE            MP
PART     DC    C'PARTITIONED'                           M65MP TO BE  MP
SHAR     DC    C'SHARED'                        ONLY                MP
RECON    DC    C' BUT RECONFIGURED OUT'                 WRITTEN ON  MP
CHCNFIG  DC    C'CPU 1 CHANNEL CONFIGURATION'            SEC       MP
CHTAB    DC    C'CH0--ON CH1--ON CH2--ON CH3--ON CH4--ON'  *       MP
         DC    C' CH5--ON CH6--ON'                    STORAGE  FOR   MP
MSNERPIB DC    C'ERPIB NOT CREATED'         EREP RECORDS           MP
OFF      DC    C'OFF'                         CONSTANTS            MP
         DC    C'LINE   '                       MESSAGES            MP
LEVELVD  EQU    3            MODULE LEVEL INDICATOR                MP
         DROP  R15
         EJECT
FORMAT1  DC    F'0'
FORMAT2  DC    F'0'
LABELPTR DC    A(LABLAREA)
DISP     DC    FL2'0'
         EJECT
         SPACE 2
* * * * * * * * * 2870 MPX CHANNEL DATA FORMATTER * * * * * * * * *
         SPACE 2
         DC    X'01'
         DC         X'000B8B00'         SKIP TO CHANNEL 1
         LABEL ' '
*
         LINE       (9,40),(1,35),SKIP=2
         HEX        XMOD,0,2B
         HEX        XSER,0,3B
         LABEL      'MODEL','SERIAL NO.'
*
         LINE  (10,)
         SYSRELN    XRELN,1                                    @D35UGFD
         LABEL      ''                                         @D35UGFD
         LINE       (21,40)
         ROUTINE    XKEY,SETSOURC
         LABEL      '--- RECORD SOURCE -','TYPE - INBOARD'
*
         LINE
         ROUTINE    XJOBN,SETPGMN
         LABEL      'JOB NAME'
*
         LINE       ,(8,40),SKIP=1
         ROUTINE    XSWS8,CONVTIME
         LABEL      'DAY  YEAR','HH MM SS.TH'
         LINE       (8,40),(1,40),SKIP=2
         ROUTINE    XDATE,SETDATE
         HEX        XTIME,1,4B
         LABEL      'DATE _','TIME _'
*
         LINE       (23,1),(1,1)
         HEX        XCUA,0,3B
         LABEL      'CHANNEL/UNIT ADDRESS'
         LINE  (30,1),(1,1),SKIP=2                             @YL02021
         ROUTINE   XKEY,ISITVS2                                @YL02021
         HEX   VCUA                                            @YL02021
         LABEL 'ADDR. STORED IN LOC 184'                       @YL02021
*
         LINE       ,(14,1),SKIP=1
         ROUTINE    XKEY,SKIPPER
         LABEL      'CC   DA    FL     CT'
         LINE       (14,3),(1,1),SKIP=2
         HEX        XFCCWCC,0,1B
         HEX        XFCCWDA,0,3B
         ROUTINE    XKEY,SPACER2
         HEX        XFCCWFL,0,1B
         HEX        XFCCW0,0,1B
         HEX        XFCCWCT,0,2B
         LABEL      'FAILING CCW'
*
         LINE       ,(14,1),SKIP=1
         ROUTINE    XKEY,SKIPPER
         LABEL      'K    CA    US CS  CT'
         LINE       (14,3),(1,1),SKIP=2
         HEX        XCSWK,0,1B
         HEX        XCSWCA,0,3B
         ROUTINE    XKEY,SPACER2
         ROUTINE    XCSWUS0,SETHEX
         ROUTINE    XCSWCS0,SETHEX
         HEX        XCSWCT,0,2B
         LABEL      'CSW'
*
         LINE       ,(2,38),SKIP=1
         ROUTINE    XKEY,SKIPPER
         LABEL      'UNIT STATUS','CHANNEL STATUS'
*
         LINE       (21,38),(3,38)
         BIN        XCSWUS0
         BIN        XCSWCS0
         LABEL      'ATTENTION','PRGM-CTLD IRPT'
         LINE
         BIN        XCSWUS1
         BIN        XCSWCS1
         LABEL      'STATUS MODIFIER','INCORRECT LENGTH'
         LINE
         BIN        XCSWUS2
         BIN        XCSWCS2
         LABEL      'CONTROL UNIT END','PROGRAM CHECK'
         LINE
         BIN        XCSWUS3
         BIN        XCSWCS3
         LABEL      'BUSY','PROTECTION CHECK'
         LINE
         BIN        XCSWUS4
         BIN        XCSWCS4
         LABEL      'CHANNEL END','CHAN DATA CHECK'
         LINE
         BIN        XCSWUS5
         BIN        XCSWCS5
         LABEL      'DEVICE END','CHAN CTRL CHECK'
         LINE
         BIN        XCSWUS6
         BIN        XCSWCS6
         LABEL      'UNIT CHECK','I/F CTRL CHECK'
         LINE       ,,SKIP=2
         BIN        XCSWUS7
         BIN        XCSWCS7
         LABEL      'UNIT EXCEPTION','CHAINING CHECK'
*
         LINE       ,(1,1),SKIP=1
         ROUTINE    XKEY,SKIPPER
         LABEL      'I/O UNIT FOUND BUSY'
         LINE       (27,5),(2,1),SKIP=2
         HEX        XAIO1
         HEX        XAIO2
         HEX        XAIO3
         HEX        XAIO4
         HEX        XAIO5
         HEX        XAIO6
         HEX        XAIO7
         HEX        XAIO8
         ROUTINE    XKEY,SETAIO
         LABEL      'CHANNEL/UNIT ADDR'
*
         LINE       ,(1,1),SKIP=1
         LABEL      '--- CHANNEL TYPE ---'
         LINE       ,(8,1),SKIP=2
         LABEL      '2870'
         LINE       ,(1,1),SKIP=1
         LABEL      'HEADER SENSE SWITCHES FOUND ON'
         LINE       ,(2,1)
         ROUTINE    XSWS8,CHKSW9
         LABEL      'RECORD INCOMPLETE'
         LINE
         ROUTINE    XSWS8,CHKSW10
         LABEL      'SYSTEM TERMINATED'
         LINE
         ROUTINE    XSWS8,CHKSW11
         LABEL      'UNSUPPORTED CHANNEL'
         LINE
         ROUTINE    XSWS8,CHKSW12
         LABEL      'CUA ILLEGAL'
         LINE
         ROUTINE    XSWS8,CHKSW13
         LABEL      'PORTION OF RECORD HAS BEEN DESTROYED'
         LINE
         ROUTINE    XSWS8,CHKSW14
         LABEL      'ERP WERE IN PROGRESS'
         LINE
         ROUTINE    XKEY,SKIPPER                                 P0417
         LABEL      ' '                                          P0417
PRTERPIB LINE       (1,1),(1,1),SKIP=1
         ROUTINE    XSWS8,IFCASR01
LABELEND LABEL      ''
         LINE
         ROUTINE MPXKEYW1,ALLFFF                                 43068
         LABEL ''
         LINE  ,(1,1),SKIP=2
         LABEL '2870 MPX CHANNEL'
         LINE  (45,),(22,),SKIP=1
         HEX   MPXKEYW1,,1L
         LABEL 'KEY-CCW'
         LINE
         HEX   MPXDADR,,3B
         LABEL 'DATA ADR'
         LINE
         BIN   MPXFLAGS,,7
         LABEL 'FLAGS'
         LINE
         HEX   MPXBYCNT,,2B
         LABEL 'BYTE COUNT'
         LINE
         HEX   MPXKEYW2,,1L
         LABEL 'KEY-CAW'
         LINE
         HEX   MPXCOMAD,,3B
         LABEL 'COMMAND ADR'
         LINE
         HEX   MPXUCWP,,1B
         LABEL 'UCW PARITY'
         LINE
         HEX   MPXCMAD,,3B
         LABEL 'RESID CMND ADR'
         LINE
         ROUTINE MPXCNLAD,@CHANADR
         LABEL 'CHANNEL ADD'
         LINE  (45,),(22,),SKIP=2
         HEX   MPXUNAD,,1B
         LABEL 'UNIT ADD'
         LINE  ,(2,),SKIP=2
         LABEL 'OPS'
         LINE  (18,20),(1,20),SKIP=2
         BIN   MPXILEN
         BIN  MPXHLTBT
         BIN   MPXOPCOD
         LABEL 'INCORRECT LEN','HALT I-O BIT','OPERATION CODE'
         LINE  ,(2,),SKIP=2
         LABEL 'STATUS'
         LINE  (18,20),(1,20),SKIP=1
         BIN   MPXPREF
         BIN   MPXPECK
         BIN   MPXBTCT
         LABEL 'PREFETCH','PRG CHK','BYTE CT (MSC)'
         LINE
         BIN   MPXDAPC
         BIN   MPXPROCK
         BIN   MPXCNTPO
         LABEL 'DT ADR PRG CHK','PROT CHK','COUNT P0 (SSC)'
         LINE  (18,20),(1,20),SKIP=2
         BIN   MPXCNCK
         BIN   MPXDTACK
         BIN   MPXCNT7
         LABEL 'CTRL CHK','DATA CHK','COUNT 7 (SSC)'
         LINE  ,(2,),SKIP=2
         LABEL 'CONTROL TRIGGERS'
         LINE  (18,20),(1,20),SKIP=1
         BIN   MPXCAW
         BIN   MPXTSTIO
         BIN   MPXMOD3
         BIN   MPXMOD10
         LABEL 'CAW','TEST I/O','MODE 3','MODE 10'
         LINE
         BIN   MPXCCWR
         BIN  MPXHLTIO
         BIN   MPXMOD4
         BIN   MPXMOD11
         LABEL 'CCW REQD','HALT I/O','MODE 4','MODE 11'
         LINE
         BIN   MPXCCWIN
         BIN   MPXPSIO
         BIN   MPXMOD6
         BIN   MPXMCBCP
         LABEL 'CCW IN CHAN','PSEUDO SIO','MODE 6','MC BC PARITY'
         LINE
         BIN   MPXDTARQ
         BIN   MPXMOD1
         BIN   MPXMOD7
         BIN   DUM71                                           @YM6454P
         LABEL 'DATA REQ','MODE 1','MODE 7','TRG 1 NO-OP'      @YM6454P
         LINE  (18,20),(1,20),SKIP=2
         BIN   MPXGOIO
         BIN   MPXMOD2
         BIN   MPXMOD9
         LABEL 'START I/O','MODE 2','MODE 9'
         LINE  ,(1,),SKIP=2
         LABEL 'MAIN CHANNEL CHECKS'
         LINE  (18,20),(1,20),SKIP=1
         BIN   MPXW0UCB
         BIN   MPXLSA
         BIN   MPXCBTCT
         BIN   MPXPRI
         LABEL 'WORD 0 UCW','LS ADR','BYTE CT','PRIORITY'
        LINE ,,SKIP=1                                          @YM6454P
         BIN   MPXW2UCB
         BIN   MPXSTOR
         BIN   MPXTOUT
         BIN   DUM75                                           @YM6454P
         LABEL 'WORD 2 UCB','STOR','TIMEOUT','IDA FETCH'       @YM6454P
        LINE ,,SKIP=2                                          @YM6454P
         BIN  W3UCWCK                                          @YM6454P
         BIN  SELRST                                           @YM6454P
         BIN  DISIN                                            @YM6454P
         LABEL 'WORD 3 UCW','SEL RESET','DISCONNECT IN'        @YM6454P
         LINE  ,(2,),SKIP=2
         LABEL 'SUB CHANNEL'
         LINE  (18,20),(1,20),SKIP=1
         BIN   MPXUADCK
         BIN   MPXBYCTC
         BIN   MPXNOP
         BIN   MPXADI
         LABEL 'UNIT ADR','BYTE CT (SSC)','NO RESPONSE','AD-I'
         LINE  ,,SKIP=2
         BIN   MPXCOMCK
         BIN   MPXINSEL
         BIN   MPXERSEQ
         BIN   MPXSTI
         LABEL 'CMND','ICRCT SELN','ICRCT TAG SEQ','ST-I'
         LINE  ,(2,),SKIP=2
         LABEL 'SELECTOR SUB CHANNEL'
         LINE  (18,20),(1,20),SKIP=1
         BIN   MPXBCP
         BIN   MPXBC2
         BIN   MPXILI
         BIN   MPXCHCK
         LABEL 'BC P','BC 2','ILI','CHAIN CHK'
         LINE
         BIN   MPXBC4
         BIN   MPXBC1
         BIN   MPXDATAC
         LABEL 'BC 4','BC 1','DATA CHK'
VS2LINE  LINE  ,,SKIP=1                                        @YM2954P
         ROUTINE   XCHID,VS2TEST                               @YL02021
VS2LAB   LABEL ''                                              @YM2954P
         LINE  (30),(1),SKIP=2                                 @YM2954P
         HEX   VCCHPR1                                         @YM2954P
         LABEL 'CCH FOOTPRINTS'                                @YM2954P
         LINE  (50,1),(20,1),SKIP=1                            @YM2954P
         BIN   VCCHPR01                                        @YM2954P
         LABEL 'IOS GPRS SAVED'                                @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR02                                        @YM2954P
         LABEL 'UCB ADDRESS ZERO'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR03                                        @YM2954P
         LABEL 'ERPIB EXISTS'                                  @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR04                                        @YM2954P
         LABEL 'IGFCCHSI ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR05                                        @YM2954P
         LABEL 'IGFCCHII ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR06                                        @YM2954P
         LABEL 'IGFCCHFE ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR07                                        @YM2954P
         LABEL 'IGFC60 ENTERED'                                @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR08                                        @YM2954P
         LABEL 'IGFC70 ENTERED'                                @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR09                                        @YM2954P
         LABEL 'IGDC80 ENTERED'                                @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR10                                        @YM2954P
         LABEL 'IGFCIC ENTERED'                                @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR11                                        @YM2954P
         LABEL 'IGFCCHRD ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR12                                        @YM2954P
         LABEL 'IGFCCHMP ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR13                                        @YM2954P
         LABEL 'IGFCCHUC ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR14                                        @YM2954P
         LABEL 'IGFCCHAS ENTERED'                              @YM2954P
         LINE  ,                                               @YM2954P
         BIN   VCCHPR15                                        @YM2954P
         LABEL 'IGFCCHIO ENTERED'                              @YM2954P
         LINE  ,,SKIP=2                                        @YM2954P
         BIN   VCCHPR16                                        @YM2954P
         LABEL 'IGFCCHEX ENTERED'                              @YM2954P
         LINE  ,(30,30),SKIP=2                                 @YM2954P
         ROUTINE    XCHID,SKIPPER                              @YM2954P
         LABEL 'MULTIPROCESSING INFORMATION'                   @YM2954P
         LINE  ,(22,40),SKIP=2                                 @Z30CIMC
         ROUTINE XCRH,CRHACT                                   @Z30CIMC
         LABEL 'CHANNEL RECONFIGURATION HARDWARE IS ACTIVE'    @Z30CIMC
NOTCRH   LINE  ,(49,1),SKIP=1                                  @Z30CIMC
NOTCRH1  LABEL '0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15'
         LINE  (25,25),(30,30),SKIP=1                          @YM2954P
         HEX   (VPROC01)                                       @YM2954P
         ROUTINE    VCHST01,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC02)                                       @YM2954P
         ROUTINE    VCHST02,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC03)                                       @YM2954P
         ROUTINE    VCHST03,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC04)                                       @YM2954P
         ROUTINE    VCHST04,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC05)                                       @YM2954P
         ROUTINE    VCHST05,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC06)                                       @YM2954P
         ROUTINE    VCHST06,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC07)                                       @YM2954P
         ROUTINE    VCHST07,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC08)                                       @YM2954P
         ROUTINE    VCHST08,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC09)                                       @YM2954P
         ROUTINE    VCHST09,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC10)                                       @YM2954P
         ROUTINE    VCHST10,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC11)                                       @YM2954P
         ROUTINE    VCHST11,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC12)                                       @YM2954P
         ROUTINE    VCHST12,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC13)                                       @YM2954P
         ROUTINE    VCHST13,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC14)                                       @YM2954P
         ROUTINE    VCHST14,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC15)                                       @YM2954P
         ROUTINE    VCHST15,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
         LINE  ,                                               @YM2954P
         HEX   (VPROC16)                                       @YM2954P
         ROUTINE    VCHST16,PROC                               @YM2954P
         LABEL ''                                              @YM2954P
DMPSPACE LINE  ,,SKIP=2                                        @Z30CIMC
         ROUTINE XDUM1,SKIPPER                                 @Z30CIMC
DMPSPC1  LABEL ''                                              @Z30CIMC
DUMPCODE DC    XL1'FF'                                         @YM2954P
DUMPSIZE DC    XL2'1E8'                                        @YM2954P
         DC    XL2'18'                                         @YM2954P
ADDRLABL DC    XL2'0'                                          @YM2954P
LABLAREA EQU   *                                               @YM2954P
         LSTART ,                                              @YM2954P
         END   ENTRYPTR                                        @YM2954P

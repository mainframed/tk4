         TITLE 'IKJCT469 TSO OUTPUT CP - PARSE && INITIALIZATION       *
                         '
IKJCT469 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJCT469  76.056'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0087
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*                  ***  B E G I N    C O D E  ***                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0087
*   KEY1=YES;                       /* INDICATE KEY 1 FOR MSG WRITER */
         OI    KEY1,B'10000000'                                    0087
*/********************************************************************/
*/*                         ZERO OUTCOMTB                            */
*/********************************************************************/
*                                                                  0088
*   OUTCOMTB(1:256)=OUTCOMTB(1:256)&&OUTCOMTB(1:256);              0088
         XC    OUTCOMTB(256),OUTCOMTB                              0088
*   OUTCOMTB(257:LENGTH(OUTCOMTB))=OUTCOMTB(257:LENGTH(OUTCOMTB))&&
*       OUTCOMTB(257:LENGTH(OUTCOMTB));                            0089
*                                                                  0089
         XC    OUTCOMTB+256(56),OUTCOMTB+256                       0089
*/********************************************************************/
*/*                      ZERO ESTAE WORK AREA                        */
*/********************************************************************/
*                                                                  0090
*   ESTAEWA(1:256)=ESTAEWA(1:256)&&ESTAEWA(1:256);                 0090
         XC    ESTAEWA(256),ESTAEWA                                0090
*   ESTAEWA(257:LENGTH(ESTAEWA))=ESTAEWA(257:LENGTH(ESTAEWA))&&ESTAEWA(
*       257:LENGTH(ESTAEWA));                                      0091
*                                                                  0091
         XC    ESTAEWA+256(84),ESTAEWA+256                         0091
*/********************************************************************/
*/*                  SET UP ESTAE EXIT TO IKJCT460                   */
*/********************************************************************/
*                                                                  0092
*   EWAPTR=ADDR(ESTAEWA);           /* DYNAMIC CORE FOR ESTAE EXIT   */
         LA    @14,ESTAEWA                                         0092
         ST    @14,EWAPTR                                          0092
*   REG2=ADDR(IKJCT460);            /* ESTAE MOD TO GET CONTROL      */
         L     REG2,@CV00625                                       0093
*   GEN(EXTRN IKJCT460);                                           0094
         EXTRN IKJCT460
*   GEN REFS(ESTALSTD,ESTAEXC,ESTALSTD,STICESTA);                  0095
         MVC   ESTALSTD(ESTAELTH),STICESTA
ESTAEXC  ESTAE  (2),PARAM=OUTCOMTB,TERM=YES,MF=(E,ESTALSTD)
*   OUTRTCD=REG15;                  /* SAVE RETURN CODE FROM ESTAE 0096
*                                      SVC                           */
         STH   REG15,OUTRTCD                                       0096
*   IF OUTRTCD^=ZERO THEN           /* IF NON ZERO RETURN CODE       */
         LH    @14,OUTRTCD                                         0097
         LTR   @14,@14                                             0097
         BZ    @RF00097                                            0097
*     DO;                                                          0098
*       OUTMSGID=40;                /* ISSUE ESTAE ERROR MSG         */
         MVI   OUTMSGID,X'28'                                      0099
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG WRITER               */
         LA    @14,OUTCOMTB                                        0100
         ST    @14,@AL00001                                        0100
         L     @15,@CV00621                                        0100
         LA    @01,@AL00001                                        0100
         BALR  @14,@15                                             0100
*       ERROR=YES;                  /* INDICATE ERROR                */
         OI    ERROR,B'00001000'                                   0101
*       OUTRTCD=BADERROR;           /* STOP PROCCESING               */
         MVC   OUTRTCD(2),@CH00150                                 0102
*     END;                                                         0103
*   ELSE                                                           0104
*     ;                                                            0104
@RF00097 DS    0H                                                  0105
*   IF ERROR=NO THEN                /* NO ERROR YET, CONTINUE      0105
*                                      PROCESSING                    */
         TM    ERROR,B'00001000'                                   0105
         BNZ   @RF00105                                            0105
*     DO;                                                          0106
*                                                                  0106
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE SOME OUTCOMTB AND SSOB FIELDS                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0107
*       OUTCPPL=ADDR(FIBCPPLC);     /* INCOMING PARM IS THE FIB    0107
*                                      PARMLIST                      */
         L     @14,@PC00001                                        0107
         LA    @10,FIBCPPLC(,@14)                                  0107
         ST    @10,OUTCPPL                                         0107
*       OUTCMDNM=FIBECTCN;          /* COMMAND NAME FROM ECT VIA   0108
*                                      SVC100                        */
         MVC   OUTCMDNM(8),FIBECTCN(@14)                           0108
*       OUTSOBH=ADDR(SSOB);         /* ADDR OF SSOB TO OUTCOMTB      */
         LA    @14,SSOB                                            0109
         ST    @14,OUTSOBH                                         0109
*       OUTSOBSO=ADDR(SSSO);        /* ADDR SYSOUT PROCESS MAP IN  0110
*                                      OUTCOMTB                      */
         LA    @14,SSSO                                            0110
         ST    @14,OUTSOBSO                                        0110
*       SSOBSSIB=ZERO;              /* SET SUBSYSTEM NAME TO ZERO    */
         SLR   @14,@14                                             0111
         ST    @14,SSOBSSIB                                        0111
*       SSOBLEN=LENGTH(SSOB);       /* LENGTH OF SSOB HEADER         */
         MVC   SSOBLEN(2),@CH00236                                 0112
*       SSOBID='SSOB';              /* CONTROL BLOCK IDENTIFIER      */
*                                                                  0113
         MVC   SSOBID(4),@CC00738                                  0113
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD THE IOPL PARM LIST, USED GENERALLY BY OTHER MODULES */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0114
*       IOPLPTR=ADDR(IOPLAREA);     /* CONTIG. TO OUTCOMTB           */
         LA    @14,IOPLAREA                                        0114
         ST    @14,IOPLPTR                                         0114
*       IOPLUPT=CPPLUPT;            /* PUT UPT ADDR IN IOPL          */
         MVC   IOPLUPT(4,@14),CPPLUPT(@10)                         0115
*       IOPLECT=CPPLECT;            /* PUT ECT ADDR IN IOPL          */
         MVC   IOPLECT(4,@14),CPPLECT(@10)                         0116
*       IOPLECB=ADDR(OUTATTN);      /* PUT ECB ADDR IN IOPL          */
         LA    @10,OUTATTN                                         0117
         ST    @10,IOPLECB(,@14)                                   0117
*     END;                                                         0118
*   IF ERROR=NO THEN                /* NO ERROR YET, CONTINUE      0119
*                                      PROCESSING                    */
@RF00105 TM    ERROR,B'00001000'                                   0119
         BNZ   @RF00119                                            0119
*     DO;                                                          0120
*                                                                  0120
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD THE PPL TO PASS TO IKJPARS                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0121
*       PPLPTR=ADDR(PPLAREA);       /* BUILD PPL HERE                */
         LA    PPLPTR,PPLAREA                                      0121
*       PPLECT=CPPLECT;             /* .....                         */
         L     @14,OUTCPPL                                         0122
         MVC   PPLECT(4,PPLPTR),CPPLECT(@14)                       0122
*       PPLUPT=CPPLUPT;             /* .....                         */
         MVC   PPLUPT(4,PPLPTR),CPPLUPT(@14)                       0123
*       PPLECB=ADDR(OUTATTN);       /* .....                         */
         LA    @10,OUTATTN                                         0124
         ST    @10,PPLECB(,PPLPTR)                                 0124
*       PPLANS=ADDR(OUTPDL);        /* .....                         */
         LA    @10,OUTPDL                                          0125
         ST    @10,PPLANS(,PPLPTR)                                 0125
*       PPLPCL=PCLADCON;            /* .....                         */
         MVC   PPLPCL(4,PPLPTR),PCLADCON                           0126
*       PPLCBUF=CPPLCBUF;           /* .....                         */
         MVC   PPLCBUF(4,PPLPTR),CPPLCBUF(@14)                     0127
*       PPLUWA=ZERO;                /* .....                         */
*                                                                  0128
         SLR   @14,@14                                             0128
         ST    @14,PPLUWA(,PPLPTR)                                 0128
*       /*************************************************************/
*       /*                                                           */
*       /* LINK TO PARSE                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0129
*       KEY1=NO;                    /* INDICATE NO LONGER IN KEY1    */
         NI    KEY1,B'01111111'                                    0129
*       GEN(MODESET EXTKEY=SUPR);   /* KEY 0 FOR PARSE               */
         MODESET EXTKEY=SUPR
*       REG1=ADDR(PPL);             /* PASS THE PPL TO IKJPARS       */
         LR    REG1,PPLPTR                                         0131
*       GEN(LINK  EP=IKJPARS);      /* LINK TO IKJPARS               */
         LINK  EP=IKJPARS
*       OUTRTCD=REG15;              /* SAVE IKJPARS' RETURN CODE     */
         STH   REG15,OUTRTCD                                       0133
*       GEN(MODESET EXTKEY=SCHED);  /* RETURN TO KEY 1               */
         MODESET EXTKEY=SCHED
*       KEY1=YES;                   /* INDICATE BACK IN KEY1         */
*                                                                  0135
         OI    KEY1,B'10000000'                                    0135
*       /*************************************************************/
*       /*                                                           */
*       /* ANALYZE PARSE RETURN CODE. IF NO ERRORS GO CHECK FOR      */
*       /* CONFLICTING KEYWORDS.                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0136
*       IF OUTRTCD^=ZERO THEN       /* IF SOME ERROR, THEN           */
         LH    @14,OUTRTCD                                         0136
         LTR   @14,@14                                             0136
         BZ    @RF00136                                            0136
*         DO;                                                      0137
*           IF OUTRTCD=4 THEN       /* IF RETURN CODE OF 4 PARSE     */
         CH    @14,@CH00067                                        0138
         BNE   @RF00138                                            0138
*             ERROR=YES;            /* WAS UNABLE TO PROMPT          */
         OI    ERROR,B'00001000'                                   0139
*           ELSE                    /* ANY OTHER ERROR CODES WILL    */
*             DO;                   /* BE FIELDED BY '67             */
         B     @RC00138                                            0140
@RF00138 DS    0H                                                  0141
*               OUTMSGID=12;        /* INDICATE PARSE ERROR MSG ID   */
         MVI   OUTMSGID,X'0C'                                      0141
*               CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER          */
         LA    @14,OUTCOMTB                                        0142
         ST    @14,@AL00001                                        0142
         L     @15,@CV00621                                        0142
         LA    @01,@AL00001                                        0142
         BALR  @14,@15                                             0142
*             END;                                                 0143
*           OUTRTCD=BADERROR;       /* OUTPUT'S ERROR CODE           */
@RC00138 MVC   OUTRTCD(2),@CH00150                                 0144
*           ERROR=YES;              /* INDICATE ERROR FOR OTHER MODS */
         OI    ERROR,B'00001000'                                   0145
*         END;                                                     0146
*       ELSE                        /* IF PARSE DETECTED NO ERRORS   */
*         DO;                       /* ESTABLISH ASSEMBLER         0147
*                                      ADDRESSABILITY FOR PDL LABELS */
         B     @RC00136                                            0147
@RF00136 DS    0H                                                  0148
*           PDLBASE=OUTPDL;                                        0148
         L     PDLBASE,OUTPDL                                      0148
*           GEN(USING IKJPARMD,PDLBASE);                           0149
         USING IKJPARMD,PDLBASE
*           CALL SYNTAX;            /* VALIDATE CORRECT SYNTAX AND 0150
*                                      AND SET UP OUTCOMTB SWITCHES  */
         BAL   @14,SYNTAX                                          0150
*         END;                                                     0151
*     END;                          /* END PARSE PROCESSING          */
@RC00136 DS    0H                                                  0153
*                                                                  0153
*/********************************************************************/
*/*                  GO TO THE INSTALLATION EXIT                     */
*/********************************************************************/
*                                                                  0153
*   IF OUTRTCD=ZERO&ERROR=NO THEN   /* IF NO ERRORS THUS FAR         */
@RF00119 LH    @14,OUTRTCD                                         0153
         LTR   @14,@14                                             0153
         BNZ   @RF00153                                            0153
         TM    ERROR,B'00001000'                                   0153
         BNZ   @RF00153                                            0153
*     CALL SECURITY;                /* CALL INSTALLATION EXIT        */
         BAL   @14,SECURITY                                        0154
*                                                                  0155
*/********************************************************************/
*/*  IF PRINT SPECIFIED:                                             */
*/*              SET UP STAX ENVIRONMENT                             */
*/*              ALLOCATE THE PRINT DATASET                          */
*/*              OPEN THE PRINT DATASET                              */
*/*              GET CORE FOR BUFFERS                                */
*/********************************************************************/
*                                                                  0155
*   IF OUTRTCD=ZERO&ERROR=NO&PRINT=YES&JOBCOUNT>ZERO THEN/* NO ERRORS
*                                      YET & PRINT SPECIFIED AND JOBS
*                                      LEFT TO PROCESS               */
@RF00153 SLR   @14,@14                                             0155
         CH    @14,OUTRTCD                                         0155
         BNE   @RF00155                                            0155
         TM    ERROR,B'00001000'                                   0155
         BNZ   @RF00155                                            0155
         TM    PRINT,B'00000010'                                   0155
         BNO   @RF00155                                            0155
         CH    @14,JOBCOUNT                                        0155
         BNL   @RF00155                                            0155
*     DO;                                                          0156
*                                                                  0156
*       /*************************************************************/
*       /*                                                           */
*       /* CREATE STAX ENVIRONMENT                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0157
*       STAXLSTD(1:STAXLTH)=STICSTAX(1:STAXLTH);/* MAP STAX LIST IN
*                                      DYNAMIC CORE                  */
         L     @14,STAXLTH                                         0157
         BCTR  @14,0                                               0157
         EX    @14,@SM00787                                        0157
*       STXMSG='';                  /* BLANK STAX MSG AREA           */
         MVI   STXMSG,C' '                                         0158
         MVC   STXMSG+1(7),STXMSG                                  0158
*       MODEMSG=OUTCMDNM;           /* GET NAME GIVEN TO 'OUTPUT' CP
*                                      FROM ECT VIA SVC 100          */
         MVC   MODEMSG(8),OUTCMDNM                                 0159
*       REG2=ADDR(IKJCT472);        /* ADDR OF ATTN HANDLER MODULE   */
         L     REG2,@CV00622                                       0160
*       GEN REFS(STAXEX,STAXLSTD,OUTCOMTB);                        0161
STAXEX STAX (2),OBUF=(STXMSG,8),USADDR=OUTCOMTB,                       *
               MF=(E,STAXLSTD)
*       OUTRTCD=REG15;              /* SAVE RETURN CODE FROM STAX    */
         STH   REG15,OUTRTCD                                       0162
*       IF OUTRTCD^=ZERO THEN       /* IF NONZERO RETURN CODE        */
         LH    @14,OUTRTCD                                         0163
         LTR   @14,@14                                             0163
         BZ    @RF00163                                            0163
*         DO;                                                      0164
*           OUTMSGID=44;            /* STAX ERROR MSGID              */
         MVI   OUTMSGID,X'2C'                                      0165
*           CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER               */
         LA    @14,OUTCOMTB                                        0166
         ST    @14,@AL00001                                        0166
         L     @15,@CV00621                                        0166
         LA    @01,@AL00001                                        0166
         BALR  @14,@15                                             0166
*           ERROR=YES;              /* INDICATE ERROR AND QUIT       */
         OI    ERROR,B'00001000'                                   0167
*           OUTRTCD=BADERROR;       /* PREPARE RETURN CODE 12        */
         MVC   OUTRTCD(2),@CH00150                                 0168
*         END;                                                     0169
*       ELSE                        /* ATTENTION ENVIRONMENT CREATED,
*                                      CONTINUE                      */
*                                                                  0170
*         /***********************************************************/
*         /*                                                         */
*         /* ALLOCATE THE PRINT DATA SET                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0170
*         DO;                                                      0170
         B     @RC00163                                            0170
@RF00163 DS    0H                                                  0171
*           STRCTNUM=ONE;           /* SET STRUCTURE SUBSCRIPT IN  0171
*                                      OCMTB FOR THE PRINT DATASET   */
         MVC   STRCTNUM(4),@CF00033                                0171
*           CALL IKJCT473(ADDR(OUTCOMTB));/* CALL THE ALLOC/UNALLOC
*                                      MODULE.                       */
         LA    @14,OUTCOMTB                                        0172
         ST    @14,@TF00001                                        0172
         LA    @14,@TF00001                                        0172
         ST    @14,@AL00001                                        0172
         L     @15,@CV00624                                        0172
         LA    @01,@AL00001                                        0172
         BALR  @14,@15                                             0172
*           IF OUTRTCD^=ZERO×ERROR=YES×NOMEMNAM(STRCTNUM)=YES THEN/*
*                                      IF '73 DETECTED ANY ERRORS    */
         LH    @14,OUTRTCD                                         0173
         LTR   @14,@14                                             0173
         BNZ   @RT00173                                            0173
         TM    ERROR,B'00001000'                                   0173
         BO    @RT00173                                            0173
         L     @14,STRCTNUM                                        0173
         MH    @14,@CH00236                                        0173
         LA    @10,NOMEMNAM-20(@14)                                0173
         TM    0(@10),B'00000010'                                  0173
         BNO   @RF00173                                            0173
@RT00173 DS    0H                                                  0174
*             DO;                                                  0174
*               ERROR=YES;          /* TURN ON ERROR SWITCH          */
         OI    ERROR,B'00001000'                                   0175
*               OUTRTCD=BADERROR;   /* SET ERROR RETURN CODE,END   0176
*                                      OUTPUT                        */
         MVC   OUTRTCD(2),@CH00150                                 0176
*             END;                                                 0177
*           ELSE                    /* IF NO ERRORS IN ALLOC,      0178
*                                      CONTINUE                      */
*                                                                  0178
*             /*******************************************************/
*             /*                                                     */
*             /* OPEN THE PRINT DATASET                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0178
*             DO;                                                  0178
         B     @RC00173                                            0178
@RF00173 DS    0H                                                  0179
*               DCBPTR=ADDR(DCBOUTD);/* BASE DCB DSECT ON DYNAMIC DCB*/
         LA    @14,DCBOUTD                                         0179
         ST    @14,DCBPTR                                          0179
*               OUTDCB(STRCTNUM)=DCBPTR;/* MAKE DCB ADDR KNOWN TO  0180
*                                      OTHER MODS                    */
         L     @10,STRCTNUM                                        0180
         MH    @10,@CH00236                                        0180
         ST    @14,OUTDCB-20(@10)                                  0180
*               DCBOUTD(1:DCBLTH)=DCBOUT(1:DCBLTH);/* MAP DCB INTO 0181
*                                      DYNAMIC CORE                  */
         L     @09,DCBLTH                                          0181
         BCTR  @09,0                                               0181
         EX    @09,@SM00789                                        0181
*               IF NEWDS(STRCTNUM)=YES/* IF ALLOCATED DS IS NEW AND  */
*                   &TERM=YES THEN  /* IF TERMINAL ALLOCATED         */
         LA    @09,NEWDS-20(@10)                                   0182
         TM    0(@09),B'00000100'                                  0182
         BNO   @RF00182                                            0182
         TM    TERM,B'00001000'                                    0182
         BNO   @RF00182                                            0182
*                 DO;                                              0183
*                   DCBLRECL=132;   /* DEFAULT LRECL                 */
         LA    @10,132                                             0184
         STH   @10,DCBLRECL+72(,@14)                               0184
*                   DCBBLKSI=132;   /* DEFAULT BLOCKSIZE             */
         STH   @10,DCBBLKSI+52(,@14)                               0185
*                   DCBRECFM='98'X; /* RECFM IS FBS                  */
         MVI   DCBRECFM+28(@14),X'98'                              0186
*                 END;                                             0187
*               ELSE                /* IF NOT A TERMINAL             */
*                 DO;                                              0188
         B     @RC00182                                            0188
@RF00182 DS    0H                                                  0189
*                   DCBEXLST=ADDR(OPENEXAD);/* PROVIDE EXIT LIST     */
         LA    @14,OPENEXAD                                        0189
         L     @10,DCBPTR                                          0189
         ST    @14,DCBEXLST+28(,@10)                               0189
*                   FLAG='85'X;     /* INDICATE END OF LIST AND DCB
*                                      EXIT                          */
         MVI   FLAG,X'85'                                          0190
*                   ADDREXIT=ADDR(OPENEXIT);/* PTR TO OPEN EXIT      */
         LA    @14,OPENEXIT                                        0191
         ST    @14,@TF00001                                        0191
         MVC   ADDREXIT(3),@TF00001+1                              0191
*                 END;                                             0192
*               DCBDDNAM=PRINTDDN(STRCTNUM);/* PUT DDNAME IN DCB     */
@RC00182 L     @14,DCBPTR                                          0193
         L     @10,STRCTNUM                                        0193
         MH    @10,@CH00236                                        0193
         LA    @09,PRINTDDN-20(@10)                                0193
         MVC   DCBDDNAM+40(8,@14),0(@09)                           0193
*               GEN(OPEN (DCBOUTD,(OUTPUT)),MF=(E,OPENLSTD));      0194
         OPEN (DCBOUTD,(OUTPUT)),MF=(E,OPENLSTD)
*               IF DCBOFOPN^=YES THEN/* OPEN UNSUCCESSFUL            */
         L     @14,DCBPTR                                          0195
         TM    DCBOFOPN+40(@14),B'00010000'                        0195
         BO    @RF00195                                            0195
*                 DO;                                              0196
*                   OUTMSGID=106;   /* ISSUE MSG 309I                */
         MVI   OUTMSGID,X'6A'                                      0197
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER       */
         LA    @14,OUTCOMTB                                        0198
         ST    @14,@AL00001                                        0198
         L     @15,@CV00621                                        0198
         LA    @01,@AL00001                                        0198
         BALR  @14,@15                                             0198
*                   OUTRTCD=BADERROR;/* END 'OUTPUT'                 */
         MVC   OUTRTCD(2),@CH00150                                 0199
*                   ERROR=YES;      /* SET ERROR SWITCH ON           */
         OI    ERROR,B'00001000'                                   0200
*                 END;                                             0201
*               ELSE                /* PRINT DS OPENED OK            */
*                                                                  0202
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET DCB ATTRIB SWITCHES IN OUTCOMTB & GET PRINT */
*                 /* BUFFERS                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0202
*                 DO;                                              0202
         B     @RC00195                                            0202
@RF00195 DS    0H                                                  0203
*                   DSOPEN(STRCTNUM)=YES;/* INDICATE DATASET OPEN    */
         L     @14,STRCTNUM                                        0203
         MH    @14,@CH00236                                        0203
         LA    @10,DSOPEN-20(@14)                                  0203
         OI    0(@10),B'00100000'                                  0203
*                   IF DCBRECL='01'B THEN/* RECFM=VAR                */
         L     @10,DCBPTR                                          0204
         TM    DCBRECL+28(@10),B'01000000'                         0204
         BNO   @RF00204                                            0204
         TM    DCBRECL+28(@10),B'10000000'                         0204
         BNZ   @RF00204                                            0204
*                     OUTRECV(STRCTNUM)=YES;/* INDICATE VAR LEN RCD  */
         LA    @10,OUTRECV-20(@14)                                 0205
         OI    0(@10),B'00010000'                                  0205
*                   ELSE            /* RCD NOT VAR OR UNDEF          */
*                     OUTRECV(STRCTNUM)=NO;/* MAKE SURE BIT IS OFF   */
         B     @RC00204                                            0206
@RF00204 L     @14,STRCTNUM                                        0206
         MH    @14,@CH00236                                        0206
         LA    @10,OUTRECV-20(@14)                                 0206
         NI    0(@10),B'11101111'                                  0206
*                   IF DCBRECL='11'B THEN/* UNDEFINED REC INDICATED  */
@RC00204 L     @14,DCBPTR                                          0207
         TM    DCBRECL+28(@14),B'11000000'                         0207
         BNO   @RF00207                                            0207
*                     DO;                                          0208
*                       OUTRECUN(STRCTNUM)=YES;/* INDICATE UNDEFINED
*                                      RECL                          */
         L     @10,STRCTNUM                                        0209
         MH    @10,@CH00236                                        0209
         LA    @09,OUTRECUN-20(@10)                                0209
         OI    0(@09),B'00000001'                                  0209
*                       DCBLRECL=132;/* DEFAULT ALL RECORDS TO 132 0210
*                                      CHARACTERS                    */
         MVC   DCBLRECL+72(2,@14),@CH00742                         0210
*                     END;                                         0211
*                   ELSE            /* IF LRECL DEFINED              */
*                     OUTRECUN(STRCTNUM)=NO;/* MAKE SURE BIT IS OFF  */
         B     @RC00207                                            0212
@RF00207 L     @14,STRCTNUM                                        0212
         MH    @14,@CH00236                                        0212
         LA    @10,OUTRECUN-20(@14)                                0212
         NI    0(@10),B'11111110'                                  0212
*                   OUTBUFL(STRCTNUM)=DCBLRECL;/* LTH OF 'PUT' BUF 0213
*                                      FOR '71                       */
@RC00207 L     @14,STRCTNUM                                        0213
         MH    @14,@CH00236                                        0213
         L     @10,DCBPTR                                          0213
         LH    @10,DCBLRECL+72(,@10)                               0213
         STH   @10,OUTBUFL-20(@14)                                 0213
*                   REG2=DCBLRECL;  /* LENGTH FOR GETMAIN            */
         LR    REG2,@10                                            0214
*                   GEN(GETMAIN R,LV=(2),SP=1);                    0215
         GETMAIN R,LV=(2),SP=1
*                   OUTBUFA(STRCTNUM)=REG1;/* ADR OF 'PUT' BUF FOR 0216
*                                      '71                           */
         L     @14,STRCTNUM                                        0216
         MH    @14,@CH00236                                        0216
         ST    REG1,OUTBUFA-20(@14)                                0216
*                   NEEDFREE(STRCTNUM)=YES;/* NEED FREEMAIN OF PRINT
*                                      BUFFER BEFORE END             */
         LA    @10,NEEDFREE-20(@14)                                0217
         OI    0(@10),B'00001000'                                  0217
*                 END;              /* END OF GET BUF DO GROUP       */
*             END;                  /* END OF OPEN DO GROUP          */
@RC00195 DS    0H                                                  0220
*         END;                      /* END OF ALLOC DO GROUP         */
@RC00173 DS    0H                                                  0221
*     END;                          /* END OF STAX DO GROUP. ALSO END
*                                      OF PRINT ONLY PROCESSING.     */
@RC00163 DS    0H                                                  0222
*                                                                  0222
*/********************************************************************/
*/*      GO TO ROUTINE WHICH LOOPS TO IKJCT462 TO PROCESS JOBS       */
*/********************************************************************/
*                                                                  0222
*   IF OUTRTCD=ZERO&ERROR=NO&JOBCOUNT>ZERO THEN/* NO ERRORS AND THERE
*                                      ARE JOBS TO PROCESS           */
@RF00155 SLR   @14,@14                                             0222
         CH    @14,OUTRTCD                                         0222
         BNE   @RF00222                                            0222
         TM    ERROR,B'00001000'                                   0222
         BNZ   @RF00222                                            0222
         CH    @14,JOBCOUNT                                        0222
         BNL   @RF00222                                            0222
*     CALL JBPROCES;                /* CALL LOOP THAT CALLS '62      */
         BAL   @14,JBPROCES                                        0223
*   ELSE                                                           0224
*     ;                                                            0224
@RF00222 DS    0H                                                  0225
*                                                                  0225
*/********************************************************************/
*/*          CLEAN UP AND RETURN                                     */
*/********************************************************************/
*                                                                  0225
*   GEN(IKJRLSA OUTPDL);            /* RELEASE PARSE CORE            */
         IKJRLSA OUTPDL
*   IF PRINT=YES THEN               /* THIS WAS A PRINT REQUEST      */
         TM    PRINT,B'00000010'                                   0226
         BNO   @RF00226                                            0226
*     DO;                                                          0227
*       IF NEEDFREE(STRCTNUM)=YES THEN/* CORE GOTTEN FOR BUFFER      */
         L     @14,STRCTNUM                                        0228
         MH    @14,@CH00236                                        0228
         LA    @10,NEEDFREE-20(@14)                                0228
         TM    0(@10),B'00001000'                                  0228
         BNO   @RF00228                                            0228
*         DO;                                                      0229
*           NEEDFREE(STRCTNUM)=NO;  /* TURN FLAG OFF                 */
         LA    @10,NEEDFREE-20(@14)                                0230
         NI    0(@10),B'11110111'                                  0230
*           REG1=OUTBUFA(STRCTNUM); /* PUT CORE ADDR IN REG          */
         L     REG1,OUTBUFA-20(@14)                                0231
*           REG2=OUTBUFL(STRCTNUM); /* LEN OF BUF TO FREE            */
         LH    REG2,OUTBUFL-20(@14)                                0232
*           GEN(FREEMAIN R,LV=(2),A=(1),SP=1);/* FREE THE GOTTEN CORE*/
         FREEMAIN R,LV=(2),A=(1),SP=1
*         END;                                                     0234
*       IF DSOPEN(STRCTNUM)=YES THEN/* IF THE DCB WAS OPENED         */
@RF00228 L     @14,STRCTNUM                                        0235
         MH    @14,@CH00236                                        0235
         LA    @10,DSOPEN-20(@14)                                  0235
         TM    0(@10),B'00100000'                                  0235
         BNO   @RF00235                                            0235
*         DO;                                                      0236
*           DSOPEN(STRCTNUM)=NO;                                   0237
         LA    @10,DSOPEN-20(@14)                                  0237
         NI    0(@10),B'11011111'                                  0237
*           IF SYNADERR=NO THEN     /* NO PREVIOUS SYNAD ERRORS      */
         TM    SYNADERR,B'10000000'                                0238
         BNZ   @RF00238                                            0238
*             GEN(CLOSE (DCBOUTD),MF=(E,CLOSLSTD));/* CLOSE DCB      */
         CLOSE (DCBOUTD),MF=(E,CLOSLSTD)
*           ELSE                                                   0240
*             ;                     /* SYNAD ERROR, SKIP CLOSE       */
@RF00238 DS    0H                                                  0241
*         END;                                                     0241
*       IF DSALLOC(STRCTNUM)=YES THEN/* IF DATASET ALLOCATED         */
@RF00235 L     @14,STRCTNUM                                        0242
         MH    @14,@CH00236                                        0242
         LA    @10,DSALLOC-20(@14)                                 0242
         TM    0(@10),B'01000000'                                  0242
         BNO   @RF00242                                            0242
*         DO;                                                      0243
*           DSALLOC(STRCTNUM)=NO;   /* TURN OFF BIT WHETHER UNALC OR
*                                      NOT SO ESTAE WON'T ATTEMPT  0244
*                                      UNALC                         */
         LA    @10,DSALLOC-20(@14)                                 0244
         NI    0(@10),B'10111111'                                  0244
*           IF SYNADERR=NO THEN     /* NO SYNAD ERROR, SO DS WAS   0245
*                                      CLOSED, THEREFORE CAN BE UNALC*/
         TM    SYNADERR,B'10000000'                                0245
         BNZ   @RF00245                                            0245
*             DO;                                                  0246
*               UNALCALL=YES;       /* TURN ON UNALLOC REQST BIT     */
         OI    UNALCALL,B'00100000'                                0247
*               CALL IKJCT473(ADDR(OUTCOMTB));/* CALL '73 TO UNALLOC
*                                      DS                            */
         LA    @14,OUTCOMTB                                        0248
         ST    @14,@TF00001                                        0248
         LA    @14,@TF00001                                        0248
         ST    @14,@AL00001                                        0248
         L     @15,@CV00624                                        0248
         LA    @01,@AL00001                                        0248
         BALR  @14,@15                                             0248
*             END;                                                 0249
*           ELSE                                                   0250
*             ;                     /* SYNAD ERROR, DS COULD NOT BE
*                                      CLOSED, SO DON'T UNALC        */
@RF00245 DS    0H                                                  0251
*         END;                                                     0251
*     END;                                                         0252
@RF00242 DS    0H                                                  0253
*   RETURN CODE(OUTRTCD);           /* RETURN TO CALLER W/ RC        */
@RF00226 LH    @10,OUTRTCD                                         0253
         L     @13,4(,@13)                                         0253
         L     @00,@SIZDATD                                        0253
         LR    @01,@11                                             0253
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0253
         L     @14,12(,@13)                                        0253
         LM    @00,@12,20(@13)                                     0253
         BR    @14                                                 0253
*                                                                  0254
*/********************************************************************/
*/*                                                                  */
*/*         OPEN EXIT   -   FILL IN PRINT DS DCB DEFAULT VALUES      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0254
*OPENEXIT:                                                         0254
*   RFY                                                            0254
*     REG14 RSTD;                                                  0254
OPENEXIT DS    0H                                                  0255
*   IF DCBRECFM=ZERO THEN           /* IF DCBRECFM FIELD IS ZERO     */
         L     @10,DCBPTR                                          0255
         LA    @09,28                                              0255
         ALR   @09,@10                                             0255
         CLI   DCBRECFM(@09),0                                     0255
         BNE   @RF00255                                            0255
*     DO;                           /* ASSUME LRECL AND BLOCKS NEEDED*/
*       DCBLRECL=132;               /* STANDARD SYSOUT PRINTER LINE  */
         MVC   DCBLRECL+72(2,@10),@CH00742                         0257
*       DCBRECFM='98'X;             /* RECFM = FBS                   */
         MVI   DCBRECFM(@09),X'98'                                 0258
*       DCBBLKSI=3036;              /* 23 RECORDS PER BLOCK          */
         MVC   DCBBLKSI+52(2,@10),@CH00751                         0259
*     END;                                                         0260
*   GEN(BR  REG14);                 /* BRANCH BACK TO OPEN (ADDR   0261
*                                      PLACED IN REG14 PRIOR TO    0261
*                                      ENTRY)                        */
@RF00255 DS    0H                                                  0261
         BR  REG14
*   RFY                                                            0262
*     REG14 UNRSTD;                                                0262
*                                                                  0263
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*  B E G I N     I N T E R N A L     S U B R O U T I N E S         */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0263
*                                                                  0263
*/********************************************************************/
*/* SYNTAX:                                                          */
*/*   THIS ROUTINE EXAMINES THE PDL RETURNED BY IKJPARS, AND REJECTS */
*/*   THE COMMAND IF TWO OR MORE CONFLICTING KEYWORDS ARE            */
*/*   PRESENT.  IT WILL CONSTRUCT THE NECESSARY DEFAULTS             */
*/*   FOR OMITTED KEYWORDS, E.G., PRINT(*) IF ONLY JOB               */
*/*   NAMES AND 'CLASS' WERE ENTERED (DEFINED BY 'PRINTING' BIT).    */
*/*   IF A CONFLICT IS DETECTED A MSG WILL BE WRITEN (VIA IKJCT467)  */
*/*   AND 'OUTPUT' PROCCESING WILL BE TERMINATED.                    */
*/*   IF NO ERRORS ARE DETECTED, THEN SET SWITCHES AND FIELDS IN     */
*/*   OUTCOMTB TO REFLECT THE SYNTAX ENTERED.                        */
*/*                                                                  */
*/*   NOTE -- THE FOLLOWING NOTATION IS USED: PDE'S BEGIN WITH       */
*/*   'P', EXCEPT FOR SUBFIELDS WHICH BEGIN WITH 'S'                 */
*/*                                                                  */
*/*                                                                  */
*/*    KEY TO DETERMINING WHAT OPERANDS THE USER ENTERED BY          */
*/*    ANALYZING THE PARSE PDE'S:                                    */
*/*                 PCLASS=0   'CLASS' NOT ENTERED                   */
*/*                       =1   'CLASS' ENTERED                       */
*/*                 PPRINT=0   'PRINT' NOT ENTERED                   */
*/*                       =1   'PRINT' ENTERED                       */
*/*                 PHERE=0    'HERE'/'BEGIN'/'NEXT' NOT ENTERED     */
*/*                      =1    'NEXT' ENTERED                        */
*/*                      =2    'HERE' ENTERED                        */
*/*                      =3    'BEGIN' ENTERED                       */
*/*                 PPAUSE=0   'PAUSE'/'NOPAUSE' NOT ENTERED         */
*/*                       =1   'PAUSE' ENTERED                       */
*/*                       =2   'NOPAUSE' ENTERED                     */
*/*                 PKEEP=0    'KEEP'/'NOKEEP' NOT ENTERED           */
*/*                      =1    'KEEP' ENTERED                        */
*/*                      =2    'NOKEEP' ENTERED                      */
*/*                 PHOLD=0    'HOLD'/'NOHOLD' NOT ENTERED           */
*/*                      =1    'HOLD' ENTERED                        */
*/*                      =2    'NOHOLD' ENTERED                      */
*/*                 PDELETE=0  'DELETE' NOT ENTERED                  */
*/*                        =1  'DELETE' ENTERED                      */
*/*                 PNEWCL=0   'NEWCLASS' NOT ENTERED                */
*/*                       =1   'NEWCLASS' ENTERED                    */
*/*                 PDEST=0    'DEST' NOT ENTERED                    */
*/*                      =1    'DEST' ENTERED                        */
*/********************************************************************/
*                                                                  0263
*SYNTAX:                                                           0263
*   PROC;                                                          0263
@EL00001 L     @13,4(,@13)                                         0263
@EF00001 L     @00,@SIZDATD                                        0263
         LR    @01,@11                                             0263
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0263
         BR    @14                                                 0263
SYNTAX   STM   @14,@12,@SA00002                                    0263
*   SYNSW=NO;                       /* INITIALIZE SWITCHES OFF       */
         MVI   SYNSW,B'00000000'                                   0264
*/********************************************************************/
*/*          INIT SYNTAX SWITCHES TO REFLECT WHAT USER ENTERED       */
*/********************************************************************/
*                                                                  0265
*   IF PPRINT=ONE×PHERE>=ONE×PPAUSE>=ONE×PKEEP>=ONE THEN/* PRINT, OR
*                                      NEXT/HERE/BEGIN, OR         0265
*                                      PAUSE/NOPAUSE,OR KEEP/NOKEEP
*                                      ENTERED - INDICATES USER WANTS
*                                      TO 'PRINT'                    */
         LA    @14,1                                               0265
         CH    @14,PPRINT                                          0265
         BE    @RT00265                                            0265
         CH    @14,PHERE                                           0265
         BNH   @RT00265                                            0265
         CH    @14,PPAUSE                                          0265
         BNH   @RT00265                                            0265
         CH    @14,PKEEP                                           0265
         BH    @RF00265                                            0265
@RT00265 DS    0H                                                  0266
*     PRINTING=YES;                                                0266
         OI    PRINTING,B'10000000'                                0266
*   IF PDEST=ONE×PNEWCL=ONE THEN    /* DEST, OR NEWCLASS ENTERED - 0267
*                                      INDICATES USER WANTS TO ROUTE
*                                      DATASETS                      */
@RF00265 LA    @14,1                                               0267
         CH    @14,PDEST                                           0267
         BE    @RT00267                                            0267
         CH    @14,PNEWCL                                          0267
         BNE   @RF00267                                            0267
@RT00267 DS    0H                                                  0268
*     ROUTING=YES;                                                 0268
         OI    ROUTING,B'01000000'                                 0268
*   IF PRINTING=NO&PHOLD>=ONE THEN  /* NO OTHER PRINT OPERANDS SO  0269
*                                      HOLD/NOHOLD FOR ROUTING       */
@RF00267 TM    PRINTING,B'10000000'                                0269
         BNZ   @RF00269                                            0269
         LH    @14,PHOLD                                           0269
         CH    @14,@CH00033                                        0269
         BL    @RF00269                                            0269
*     ROUTING=YES;                                                 0270
*                                                                  0270
         OI    ROUTING,B'01000000'                                 0270
*/********************************************************************/
*/*     CHECK FOR CONFLICTING KEYWORD   E R R O R  C A S E S         */
*/********************************************************************/
*                                                                  0271
*   IF PRINTING=YES&ROUTING=YES THEN/* PRINT AND ROUTE               */
@RF00269 TM    PRINTING,B'11000000'                                0271
         BNO   @RF00271                                            0271
*     SYNERROR=YES;                 /* CONFLICTING KEYWORDS - CAN'T
*                                      PRINT AND ROUTE               */
         OI    SYNERROR,B'00100000'                                0272
*   ELSE                            /* CHECK FURTHER                 */
*     IF PRINTING=YES&PDELETE=ONE THEN/* PRINT AND DELETE            */
         B     @RC00271                                            0273
@RF00271 TM    PRINTING,B'10000000'                                0273
         BNO   @RF00273                                            0273
         CLC   PDELETE(2),@CH00033                                 0273
         BNE   @RF00273                                            0273
*       SYNERROR=YES;               /* CONFLICTING KEYWORDS - CAN'T
*                                      PRINT AND DELETE              */
         OI    SYNERROR,B'00100000'                                0274
*     ELSE                          /* CHECK FURTHER                 */
*       IF ROUTING=YES&PDELETE=ONE THEN/* ROUTE AND DELETE           */
         B     @RC00273                                            0275
@RF00273 TM    ROUTING,B'01000000'                                 0275
         BNO   @RF00275                                            0275
         CLC   PDELETE(2),@CH00033                                 0275
         BNE   @RF00275                                            0275
*         SYNERROR=YES;             /* CONFLICTING KEYWORDS - CAN'T
*                                      ROUTE AND DELETE              */
         OI    SYNERROR,B'00100000'                                0276
*       ELSE                        /* CHECK FURTHER                 */
*         IF PDELETE=ONE&PHOLD>=ONE THEN/* DELETE & HOLD/NOHOLD      */
         B     @RC00275                                            0277
@RF00275 LA    @14,1                                               0277
         CH    @14,PDELETE                                         0277
         BNE   @RF00277                                            0277
         CH    @14,PHOLD                                           0277
         BH    @RF00277                                            0277
*           SYNERROR=YES;           /* CONFLICTING KEYWORDS - CAN'T
*                                      USE HOLD/NOHOLD WITH DELETE   */
         OI    SYNERROR,B'00100000'                                0278
*         ELSE                      /* CHECK FURTHER                 */
*           IF PRINTING=YES&PKEEP^=ONE&PHOLD=>ONE THEN/* CONFLICTING
*                                      KEYWORDS - PRINT REQUEST WITH
*                                      NOKEEP ENTERED OR DEFAULTED,
*                                      AND HOLD/NOHOLD ENTERED       */
         B     @RC00277                                            0279
@RF00277 TM    PRINTING,B'10000000'                                0279
         BNO   @RF00279                                            0279
         LA    @14,1                                               0279
         CH    @14,PKEEP                                           0279
         BE    @RF00279                                            0279
         CH    @14,PHOLD                                           0279
         BH    @RF00279                                            0279
*             SYNERROR=YES;                                        0280
         OI    SYNERROR,B'00100000'                                0280
*           ELSE                                                   0281
*             ;                     /* NO OTHER CONFLICTS            */
@RF00279 DS    0H                                                  0282
*   IF SYNERROR=YES THEN            /* IF SYNTAX ERRORS DETECTED     */
@RC00277 DS    0H                                                  0282
@RC00275 DS    0H                                                  0282
@RC00273 DS    0H                                                  0282
@RC00271 TM    SYNERROR,B'00100000'                                0282
         BNO   @RF00282                                            0282
*     DO;                                                          0283
*       OUTRTCD=BADERROR;           /* SET ERROR CODE                */
         MVC   OUTRTCD(2),@CH00150                                 0284
*       OUTMSGID=145;               /* CONFLICTING KEYWORDS MSG 341I */
         MVI   OUTMSGID,X'91'                                      0285
*       CALL IKJCT467(OUTCOMTB);    /* CALL MSG WRITER               */
         LA    @14,OUTCOMTB                                        0286
         ST    @14,@AL00001                                        0286
         L     @15,@CV00621                                        0286
         LA    @01,@AL00001                                        0286
         BALR  @14,@15                                             0286
*     END;                                                         0287
*   ELSE                            /* IF NO SYNTAX ERRORS           */
*     DO;                                                          0288
*                                                                  0288
         B     @RC00282                                            0288
@RF00282 DS    0H                                                  0289
*       /*************************************************************/
*       /*                                                           */
*       /* SET DEFAULT VALUES IN PDL, SYNTAX NOW HAS NO DETECTABLE   */
*       /* ERRORS. IF ROUTING OR DELETING IS NOT SPECIFICALLY        */
*       /* ENTERED, THEN PRINTING IS BEING DONE. IF 'PRINT' WAS NOT  */
*       /* ENTERED, THEN THE DEFAULT IS 'PRINT(*)'. NOTE: IF THE USER*/
*       /* ENTERS 'OUTPUT JOBNAME NOHOLD', IT IS TREATED AS A ROUTING*/
*       /* REQUEST, NOT AS A PRINT REQUEST.                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0289
*       IF ROUTING=NO&PDELETE=ZERO THEN/* IF PRINT REQUEST           */
         TM    ROUTING,B'01000000'                                 0289
         BNZ   @RF00289                                            0289
         SLR   @14,@14                                             0289
         CH    @14,PDELETE                                         0289
         BNE   @RF00289                                            0289
*         DO;                       /* SET PRINT DEFAULTS            */
*           IF PPRINT=ZERO THEN     /* IF 'PRINT' NOT ENTERED, THEN  */
         CH    @14,PPRINT                                          0291
         BNE   @RF00291                                            0291
*             DO;                                                  0292
*               PPRINT=ONE;         /* INDICATE PRINT IN PDL         */
         MVC   PPRINT(2),@CH00033                                  0293
*               DSPDE(1:LENGTH(DSPDE))=DFLTPRNT;/* DEFAULT TO      0294
*                                      'PRINT(*)'                    */
         LA    @14,SPRINT                                          0294
         MVC   DSPDE(24,@14),DFLTPRNT                              0294
*             END;                                                 0295
*           IF PHERE=ZERO THEN      /* IF NEITHER HERE, NEXT, OR   0296
*                                      BEGIN                         */
@RF00291 LH    @14,PHERE                                           0296
         LTR   @14,@14                                             0296
         BNZ   @RF00296                                            0296
*             PHERE=2;              /* DEFAULT TO 'HERE'             */
         MVC   PHERE(2),@CH00082                                   0297
*           IF PPAUSE=ZERO THEN     /* IF NEITHER PAUSE OR NOPAUSE,  */
@RF00296 LH    @14,PPAUSE                                          0298
         LTR   @14,@14                                             0298
         BNZ   @RF00298                                            0298
*             PPAUSE=2;             /* DEFAULT TO 'NOPAUSE'          */
         MVC   PPAUSE(2),@CH00082                                  0299
*           IF PKEEP=ZERO THEN      /* IF NEITHER KEEP NOR NOKEEP,   */
@RF00298 LH    @14,PKEEP                                           0300
         LTR   @14,@14                                             0300
         BNZ   @RF00300                                            0300
*             PKEEP=2;              /* DEFAULT TO 'NOKEEP'           */
         MVC   PKEEP(2),@CH00082                                   0301
*           IF PKEEP=ONE&PHOLD=ZERO THEN/* IF HOLD NOT SPECIFIED WITH
*                                      KEEP, DEFAULT TO NOHOLD       */
@RF00300 CLC   PKEEP(2),@CH00033                                   0302
         BNE   @RF00302                                            0302
         LH    @14,PHOLD                                           0302
         LTR   @14,@14                                             0302
         BNZ   @RF00302                                            0302
*             PHOLD=2;                                             0303
         MVC   PHOLD(2),@CH00082                                   0303
*         END;                                                     0304
*       ELSE                                                       0305
*         ;                         /* ROUTING OR DELETE REQUEST - 0305
*                                      ROUTING DEFAULT (NOHOLD), DONE
*                                      AUTOMATICALLY - SEE BELOW     */
@RF00289 DS    0H                                                  0306
*                                                                  0306
*       /*************************************************************/
*       /*                                                           */
*       /* SET SWITCHES/VALUES IN OUTCOMTB TO INDICATE TOTAL SYNTAX  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0306
*       IF PPRINT=ONE THEN          /* IF PARSE INDICATES PRINT    0306
*                                      SPECIFIED                     */
@RC00289 CLC   PPRINT(2),@CH00033                                  0306
         BNE   @RF00306                                            0306
*         PRINT=YES;                /* INDICATE PRINT IN OUTCOMTB    */
         OI    PRINT,B'00000010'                                   0307
*       IF PPAUSE=ONE THEN          /* PAUSE .....                   */
@RF00306 CLC   PPAUSE(2),@CH00033                                  0308
         BNE   @RF00308                                            0308
*         PAUSE=YES;                /* INDICATE PAUSE                */
         OI    PAUSE,B'10000000'                                   0309
*       IF PNEWCL=ONE THEN          /* NEW CLASS .....               */
@RF00308 CLC   PNEWCL(2),@CH00033                                  0310
         BNE   @RF00310                                            0310
*         NEWCLASS=YES;             /* INDICATE NEW CLASS            */
         OI    NEWCLASS,B'00000001'                                0311
*       IF PHOLD=ONE THEN           /* HOLD .....                    */
@RF00310 CLC   PHOLD(2),@CH00033                                   0312
         BNE   @RF00312                                            0312
*         HOLD=YES;                 /* INDICATE HOLD                 */
         OI    HOLD,B'01000000'                                    0313
*       IF PHERE=ONE THEN           /* NEXT .....                    */
@RF00312 CLC   PHERE(2),@CH00033                                   0314
         BNE   @RF00314                                            0314
*         NEXT=YES;                 /* INDICATE NEXT                 */
         OI    NEXT,B'00001000'                                    0315
*       ELSE                        /* ELSE HERE OR BEGIN            */
*         IF PHERE=2 THEN           /* HERE .....                    */
         B     @RC00314                                            0316
@RF00314 CLC   PHERE(2),@CH00082                                   0316
         BNE   @RF00316                                            0316
*           HERE=YES;               /* INDICATE HERE                 */
         OI    HERE,B'00100000'                                    0317
*         ELSE                      /* MUST BE BEGIN                 */
*           IF PHERE=3 THEN         /* BEGIN .....                   */
         B     @RC00316                                            0318
@RF00316 CLC   PHERE(2),@CH00257                                   0318
         BNE   @RF00318                                            0318
*             BEGIN=YES;            /* INDICATE BEGIN                */
         OI    BEGIN,B'00010000'                                   0319
*       IF PKEEP=ONE THEN           /* KEEP .....                    */
@RF00318 DS    0H                                                  0320
@RC00316 DS    0H                                                  0320
@RC00314 CLC   PKEEP(2),@CH00033                                   0320
         BNE   @RF00320                                            0320
*         KEEP=YES;                 /* INDICATE KEEP                 */
         OI    KEEP,B'10000000'                                    0321
*       IF PDELETE=ONE THEN         /* DELETE .....                  */
@RF00320 CLC   PDELETE(2),@CH00033                                 0322
         BNE   @RF00322                                            0322
*         DELETE=YES;               /* INDICATE DELETE               */
         OI    DELETE,B'00000100'                                  0323
*       IF PDEST=ONE THEN           /* DEST .....                    */
@RF00322 CLC   PDEST(2),@CH00033                                   0324
         BNE   @RF00324                                            0324
*         DO;                                                      0325
*           DEST=YES;               /* INDICATE DEST                 */
         OI    DEST,B'01000000'                                    0326
*           ODESTPDE=ADDR(SDEST);   /* PUT DEST PDE IN OUTCOMTB      */
         LA    @14,SDEST                                           0327
         ST    @14,ODESTPDE                                        0327
*         END;                                                     0328
*       IF PCLASS=ONE THEN          /* IF CLASS NOT DEFAULTED        */
@RF00324 CLC   PCLASS(2),@CH00033                                  0329
         BNE   @RF00329                                            0329
*         OUTCPDE1=ADDR(SCLASS);    /* PUT CURRENT CLASS PDE IN    0330
*                                      OUTCOMTB                      */
         LA    @14,SCLASS                                          0330
         ST    @14,OUTCPDE1                                        0330
*       ELSE                        /* IF NO CLASS ENTERED           */
*         OUTCPDE1=ZERO;            /* ZERO PDE POINTER              */
         B     @RC00329                                            0331
@RF00329 SLR   @14,@14                                             0331
         ST    @14,OUTCPDE1                                        0331
*       IF PNEWCL=ONE THEN          /* IF NEW CLASS SPECIFIED        */
@RC00329 CLC   PNEWCL(2),@CH00033                                  0332
         BNE   @RF00332                                            0332
*         ONEWCPDE=ADDR(SNEWCL);    /* PUT PDE ADDR IN OUTCOMTB      */
         LA    @14,SNEWCL                                          0333
         ST    @14,ONEWCPDE                                        0333
*       IF PPRINT=ONE THEN          /* IF PRINT SPECIFIED OR       0334
*                                      DEFAULTED                     */
@RF00332 CLC   PPRINT(2),@CH00033                                  0334
         BNE   @RF00334                                            0334
*         DO;                                                      0335
*           OPRDSPDE=ADDR(SPRINT);  /* PUT PRINT DSNAME PDE IN     0336
*                                      OUTCOMTB                      */
         LA    @14,SPRINT                                          0336
         ST    @14,OPRDSPDE                                        0336
*           IF DSNAME='*' THEN      /* AND '*' SPECIFEID OR DEFAULTED*/
         MVC   @TF00001(4),DSNAMEAD(@14)                           0337
         L     @14,@TF00001                                        0337
         CLI   DSNAME(@14),C'*'                                    0337
         BNE   @RF00337                                            0337
*             TERM=YES;             /* INDICATES THAT THE PRINTER IS
*                                      A TERMINAL                    */
         OI    TERM,B'00001000'                                    0338
*         END;                                                     0339
@RF00337 DS    0H                                                  0340
*       OUTJBPDE=ADDR(PJOBNAME);    /* PUT JOB NAME PDE IN OUTCOMTB  */
@RF00334 LA    @14,PJOBNAME                                        0340
         ST    @14,OUTJBPDE                                        0340
*     END;                                                         0341
*   END SYNTAX;                                                    0342
@EL00002 DS    0H                                                  0342
@EF00002 DS    0H                                                  0342
@ER00002 LM    @14,@12,@SA00002                                    0342
         BR    @14                                                 0342
*                                                                  0343
*/****************************************************************** */
*/*  SECURITY:                                                       */
*/*     THE FOLLOWING ROUTINE WILL PASS CONTROL TO AN INSTALLATION   */
*/*         EXIT FOR SECURITY CHECKING AS THE INSTALLATION DESIRES   */
*/*         ( IBM PROVIDES IKJEFF53 FOR THIS PURPOSE )               */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0343
*SECURITY:                                                         0343
*   PROC;                                                          0343
SECURITY STM   @14,@12,@SA00003                                    0343
*   DCL                                                            0344
*     USERLIST CHAR(20),            /* OUTPUT CP EXTENSION TO THE  0344
*                                      INSTALLATION EXIT PARM LIST   */
*     LOOP BIT(1),                  /* SWITCH FOR LOOPING            */
*     QUIT BIT(1);                  /* SWITCH FOR LOOPING            */
*   USERLIST(1:16)=OUTPLIST;        /* USER LIST OF PDES             */
         MVC   USERLIST(16),OUTPLIST                               0345
*   USERLIST(17:18)=OUTKEYWD;       /* USER KEYWORDS ENTERED         */
         MVC   USERLIST+16(2),OUTKEYWD                             0346
*   JOBASE=OUTJBPDE;                /* BASE JOB PDE DSECT            */
         L     JOBASE,OUTJBPDE                                     0347
*   JOBCOUNT=ZERO;                  /* INIT JOB COUNTER TO ZERO      */
         SLR   @14,@14                                             0348
         STH   @14,JOBCOUNT                                        0348
*   QUIT=NO;                        /* INIT LOOP SW TO ALLOW FIRST 0349
*                                      TIME THROUGH                  */
         NI    QUIT,B'01111111'                                    0349
*   RFY                                                            0350
*     JOBPDE BASED(JOBASE);         /* BASE FOR PDE DSECT            */
*/********************************************************************/
*/*  'DOWHILE' LOOP TO:                                              */
*/*     LOOP THROUGH THE JOB PDE CHAIN, CALLING THE INSTALLATION     */
*/*     EXIT FOR EACH JOBNAME IN ORDER TO VERIFY IT.                 */
*/********************************************************************/
*                                                                  0351
*   DO WHILE JOBASE^=ENDCHAIN&QUIT=NO;/* LOOP TO THE EXIT TO VERIFY
*                                      JOBS UNTIL: NO MORE JOBS,   0351
*                                      ERROR IN IKJCT467, ABORT RC OR
*                                      UNKNOWN RC FROM EXIT          */
         B     @DE00351                                            0351
@DL00351 DS    0H                                                  0352
*     PARMLIST=PARMLIST&&PARMLIST;  /* ZERO OUT PARMLIST             */
         XC    PARMLIST(40),PARMLIST                               0352
*     JOBNAMEP=JBNAMEAD;            /* FILL IN PARMLIST              */
         MVC   JOBNAMEP(4),JBNAMEAD(JOBASE)                        0353
*     NAMELENP=ADDR(JBNMLTH);       /* .....                         */
         LA    @14,JBNMLTH(,JOBASE)                                0354
         ST    @14,NAMELENP                                        0354
*     USERIDP=ADDR(FIBPSCBU);       /* .....                         */
         L     @14,@PC00001                                        0355
         LA    @10,FIBPSCBU(,@14)                                  0355
         ST    @10,USERIDP                                         0355
*     IDLENPTR=ADDR(FIBPSCBL);      /* .....                         */
         LA    @14,FIBPSCBL(,@14)                                  0356
         ST    @14,IDLENPTR                                        0356
*     CODEP=ADDR(IEOUTPUT);         /* .....                         */
         LA    @14,@CH00041+1                                      0357
         ST    @14,CODEP                                           0357
*     JOBIDP=JBIDADR;               /* .....                         */
         MVC   JOBIDP(4),JBIDADR(JOBASE)                           0358
*     JIDLENP=ADDR(JBIDLTH);        /* .....                         */
         LA    @14,JBIDLTH(,JOBASE)                                0359
         ST    @14,JIDLENP                                         0359
*     IEOUTPLP=ADDR(USERLIST);      /* .....                         */
         LA    @14,USERLIST                                        0360
         ST    @14,IEOUTPLP                                        0360
*     LOOP=YES;                     /* ALLOW FIRST TIME THROUGH      */
         OI    LOOP,B'10000000'                                    0361
*/********************************************************************/
*/*  INTERNAL 'DOWHILE' LOOP TO:                                     */
*/*     RETURN TO IKJEFF53 WITH THE SAME JOBNAME AFTER RC OF 4 OR 8. */
*/*     THAT IS, GO BACK TO THE EXIT WITH THE SAME JOBNAME AFTER     */
*/*     COMPLETING EXIT'S REQUEST TO ISSUE A MSG FOR THAT JOBNAME.   */
*/********************************************************************/
*                                                                  0362
*     DO WHILE LOOP=YES×RETCODE=4×RETCODE=8;/* LOOP WITH SAME JOBNAME*/
         B     @DE00362                                            0362
@DL00362 DS    0H                                                  0363
*       REG1=ADDR(PARMLIST);        /* PARM FOR IKJEFF53             */
         LA    REG1,PARMLIST                                       0363
*       GEN(LINK EP=IKJEFF53);      /* CALL SECURITY EXIT            */
         LINK EP=IKJEFF53
*       RETCODE=REG15;              /* SAVE RETURN CODE              */
         ST    REG15,RETCODE                                       0365
*                                                                  0366
*       /*************************************************************/
*       /*                                                           */
*       /* ANALYZE THE EXIT RETURN CODE                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0366
*       IF RETCODE^=ZERO THEN       /* IF ANY ERROR                  */
         L     @14,RETCODE                                         0366
         LTR   @14,@14                                             0366
         BZ    @RF00366                                            0366
*         DO;                                                      0367
*           IF RETCODE=4×RETCODE=8 THEN/* SECURITY EXIT WANTS TO PASS
*                                      MSG TO USER                   */
*                                                                  0368
         CH    @14,@CH00067                                        0368
         BE    @RT00368                                            0368
         CH    @14,@CH00041                                        0368
         BNE   @RF00368                                            0368
@RT00368 DS    0H                                                  0369
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN CODE 4 OR 8                                  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0369
*             DO;                                                  0369
*               OUTXRPLY=ZERO;      /* ZERO USER REPLY PTR           */
         SLR   @14,@14                                             0370
         ST    @14,OUTXRPLY                                        0370
*               IF RETCODE=4 THEN   /* EXIT WANTS TO PROMPT          */
         CLC   RETCODE(4),@CF00067                                 0371
         BNE   @RF00371                                            0371
*                 OUTMSGID=123;     /* PUTGET                        */
         MVI   OUTMSGID,X'7B'                                      0372
*               ELSE                /* ISSUE MSG W/NO REPLY          */
*                 OUTMSGID=124;     /* PUTLINE                       */
         B     @RC00371                                            0373
@RF00371 MVI   OUTMSGID,X'7C'                                      0373
*               OUTXMSG=MESSAGEP;   /* PUT EXIT MSG IN OUTCOMTB      */
@RC00371 MVC   OUTXMSG(4),MESSAGEP                                 0374
*               CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER          */
         LA    @14,OUTCOMTB                                        0375
         ST    @14,@AL00001                                        0375
         L     @15,@CV00621                                        0375
         LA    @01,@AL00001                                        0375
         BALR  @14,@15                                             0375
*               IF ERROR=YES THEN   /* MSG HANDLER COULD NOT PUTLINE
*                                      MSG OR ELSE COULD NOT GET   0376
*                                      REPLY FROM PUTGET PROMPT      */
         TM    ERROR,B'00001000'                                   0376
         BNO   @RF00376                                            0376
*                 DO;                                              0377
*                   QUIT=YES;       /* INDICATE QUIT LOOP WHICH CALLS
*                                      INSTALLATION EXIT             */
         OI    QUIT,B'10000000'                                    0378
*                   LOOP=NO;        /* QUIT LOOP WITH SAME JOBNAME   */
         NI    LOOP,B'01111111'                                    0379
*                   RETCODE=BADERROR;/* SET ERROR RC                 */
         MVC   RETCODE(4),@CF00150                                 0380
*                 END;                                             0381
*               ELSE                /* MSG OUT SUCCESSFULLY          */
*                 DO;                                              0382
         B     @RC00376                                            0382
@RF00376 DS    0H                                                  0383
*                   IF RETCODE=4 THEN/* REPLY REQUESTED              */
         CLC   RETCODE(4),@CF00067                                 0383
         BNE   @RF00383                                            0383
*                     REPLYP=OUTXRPLY;/* PASS REPLY TO EXIT          */
         MVC   REPLYP(4),OUTXRPLY                                  0384
*                   LOOP=YES;       /* LOOP BACK TO '53 WITH REPLY   */
@RF00383 OI    LOOP,B'10000000'                                    0385
*                 END;                                             0386
*             END;                                                 0387
*           ELSE                    /* NONZERO RC OTHER THAN 4 OR 8  */
*                                                                  0388
*             /*******************************************************/
*             /*                                                     */
*             /* RETURN CODE 12, 16, UNKNOWN                         */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0388
*             DO;                                                  0388
         B     @RC00368                                            0388
@RF00368 DS    0H                                                  0389
*               LOOP=NO;            /* AFTER THESE RCS DON'T LOOP TO
*                                      53 AGAIN WITH THIS JOBNAME    */
         NI    LOOP,B'01111111'                                    0389
*               IF RETCODE=12 THEN  /* USER DOES NOT HAVE ACCESS TO
*                                      THIS DATA SET                 */
         CLC   RETCODE(4),@CF00150                                 0390
         BNE   @RF00390                                            0390
*                 DO;                                              0391
*                   JBNTFND=ON;     /* FLAG JOB AS INELIGIBLE        */
         OI    JBNTFND(JOBASE),B'10000000'                         0392
*                   RETCODE=ZERO;   /* PASS BACK ZERO RETCODE TO GET
*                                      NEXT JOBNAME                  */
         SLR   @14,@14                                             0393
         ST    @14,RETCODE                                         0393
*                 END;                                             0394
*               ELSE                /* IF RC=16 OR UNKNOWN           */
*                 DO;                                              0395
         B     @RC00390                                            0395
@RF00390 DS    0H                                                  0396
*                   IF RETCODE=16 THEN/* EXIT WANTS TO ABORT THIS  0396
*                                      JOBNAME                       */
         CLC   RETCODE(4),@CF00115                                 0396
         BNE   @RF00396                                            0396
*                     RETCODE=BADERROR;/* STOP PROCESSING            */
         MVC   RETCODE(4),@CF00150                                 0397
*                   ELSE            /* IF RETCODE NOT 4,8,12,OR 16,
*                                      IT IS UNDEFINED               */
*                     DO;                                          0398
         B     @RC00396                                            0398
@RF00396 DS    0H                                                  0399
*                       OUTRTCD=RETCODE;                           0399
         MVC   OUTRTCD(2),RETCODE+2                                0399
*                       OUTMSGID=142;/* UNKNOWN RETURN CODE MSG      */
         MVI   OUTMSGID,X'8E'                                      0400
*                       CALL IKJCT467(OUTCOMTB);/* CALL MSG HANDLER  */
         LA    @14,OUTCOMTB                                        0401
         ST    @14,@AL00001                                        0401
         L     @15,@CV00621                                        0401
         LA    @01,@AL00001                                        0401
         BALR  @14,@15                                             0401
*                     END;                                         0402
*                   QUIT=YES;       /* INDICATE END LOOP JBNM PDE'S  */
@RC00396 OI    QUIT,B'10000000'                                    0403
*                   RETCODE=BADERROR;/* ERROR RC                     */
         MVC   RETCODE(4),@CF00150                                 0404
*                 END;                                             0405
*             END;                                                 0406
@RC00390 DS    0H                                                  0407
*           OUTRTCD=RETCODE;        /* RETURN CODE FOR MAIN PROC     */
@RC00368 MVC   OUTRTCD(2),RETCODE+2                                0407
*         END;                      /* END OF PROCESSING FOR NONZERO
*                                      INST EXIT RC                  */
*                                                                  0408
*       /*************************************************************/
*       /*                                                           */
*       /* EXIT RETURN CODE 0                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0409
*       ELSE                        /* IF 53'S RC WAS ZERO           */
*         DO;                                                      0409
         B     @RC00366                                            0409
@RF00366 DS    0H                                                  0410
*           LOOP=NO;                /* DO NOT LOOP TO 53 AGAIN WITH
*                                      THIS JOBNAME                  */
         NI    LOOP,B'01111111'                                    0410
*           OUTRTCD=ZERO;           /* SET RC FOR CODE THAT CALLED 0411
*                                      THIS SUBRTN (IN CASE THIS WAS
*                                      LAST JOB IN LIST SO ABOUT TO
*                                      EXIT FROM THIS SUBRTN)        */
         SLR   @14,@14                                             0411
         STH   @14,OUTRTCD                                         0411
*         END;                                                     0412
*     END;                          /* END DO WHILE LOOP WITH SAME 0413
*                                      JOBNAME                       */
*                                                                  0413
@RC00366 DS    0H                                                  0413
@DE00362 TM    LOOP,B'10000000'                                    0413
         BO    @DL00362                                            0413
         L     @14,RETCODE                                         0413
         CH    @14,@CH00067                                        0413
         BE    @DL00362                                            0413
         CH    @14,@CH00041                                        0413
         BE    @DL00362                                            0413
*     /***************************************************************/
*     /*                                                             */
*     /* THIS CODE EXECUTED WHEN DONE LOOPING TO EXIT WITH THE SAME  */
*     /* JOBNAME                                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0414
*     IF JBNTFND=OFF THEN           /* JOBNAME OK                    */
         TM    JBNTFND(JOBASE),B'10000000'                         0414
         BNZ   @RF00414                                            0414
*       JOBCOUNT=JOBCOUNT+ONE;      /* INCREMENT JOB COUNTER BY 1    */
         LH    @14,JOBCOUNT                                        0415
         LA    @14,1(,@14)                                         0415
         STH   @14,JOBCOUNT                                        0415
*     JOBASE=NEXTPDE;               /* INCRE DSECT OVER NEXT DPE     */
@RF00414 L     JOBASE,NEXTPDE(,JOBASE)                             0416
*   END;                            /* END LOOP THRU JOB PDE CHAIN   */
@DE00351 CL    JOBASE,@CF00706                                     0417
         BE    @DC00351                                            0417
         TM    QUIT,B'10000000'                                    0417
         BZ    @DL00351                                            0417
@DC00351 DS    0H                                                  0418
*   END SECURITY;                   /* RETURN TO MAJOR ROUTINE       */
@EL00003 DS    0H                                                  0418
@EF00003 DS    0H                                                  0418
@ER00003 LM    @14,@12,@SA00003                                    0418
         BR    @14                                                 0418
*                                                                  0419
*/********************************************************************/
*/* JBPROCES:                                                        */
*/*                                                                  */
*/*  THE FOLLOWING ROUTINE WILL CALL IKJCT462 WITH THE INFORMATION   */
*/*     REQUIRED TO HANDLE THE JOB SPECIFIED IN THE REQUESTED        */
*/*     MANOR.                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0419
*JBPROCES:                                                         0419
*   PROC;                                                          0419
JBPROCES STM   @14,@12,@SA00004                                    0419
*   DCL                                                            0420
*     CLASPTR PTR(31),              /* BASE FOR CLASS PDE DSECT      */
*     CLASS CHAR(1) BASED(CLASNMAD),/* CLASS POINTED TO BY PDE       */
*     NEXTJOB BIT(1);               /* SWITCH - NEXT JOBNAME REQUEST */
*   RFY                                                            0421
*     JOBPDE BASED(OUTJBPDE);       /* RESPECIFY BASE FOR DSECT      */
*/********************************************************************/
*/*     GROUP REQUEST (DELETE OR ROUTE).  PROCESS JOBS               */
*/********************************************************************/
*                                                                  0422
*   IF PRINT=NO THEN                /* DELETE OR ROUTING REQUESTED   */
         TM    PRINT,B'00000010'                                   0422
         BNZ   @RF00422                                            0422
*     DO;                                                          0423
*       RFY                                                        0424
*         CLASSPDE BASED(CLASPTR);  /* BASE DSECT FOR CLASS PDE ON   */
*       CLASPTR=OUTCPDE1;           /* FIRST CLASS IN CHAIN          */
         L     CLASPTR,OUTCPDE1                                    0425
*       NEXTJOB=NO;                 /* SET SWITCH OFF                */
         NI    NEXTJOB,B'01111111'                                 0426
*       WORKDONE=NO;                /* INIT BEFORE STARTING EACH JOB */
*                                                                  0427
         NI    WORKDONE,B'11101111'                                0427
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESS UNTIL NO JOBS LEFT OR AN ERROR OCCURRS            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0428
*       DO WHILE OUTJBPDE^=ENDCHAIN&ERROR=NO;                      0428
         B     @DE00428                                            0428
@DL00428 DS    0H                                                  0429
*         IF JBNTFND=ON THEN        /* INSTALLATION EXIT FOUND JOB 0429
*                                      INELIGIBLE FOR PROCESSING     */
         L     @14,OUTJBPDE                                        0429
         TM    JBNTFND(@14),B'10000000'                            0429
         BNO   @RF00429                                            0429
*           NEXTJOB=YES;            /* INDICATE TO PROCESS NEXT JOB  */
         OI    NEXTJOB,B'10000000'                                 0430
*         IF NEXTJOB=YES THEN       /* IF NEXT JOBNAME REQUESTED     */
@RF00429 TM    NEXTJOB,B'10000000'                                 0431
         BNO   @RF00431                                            0431
*           DO;                                                    0432
*             NEXTJOB=NO;           /* TURN OFF REQUEST BIT          */
         NI    NEXTJOB,B'01111111'                                 0433
*             WORKDONE=NO;          /* REINIT SINCE STARTING NEW JOB.
*                                      '62 USES THIS BIT FOR GROUP 0434
*                                      REQUESTS TO SEE IF MSG NEEDED */
         NI    WORKDONE,B'11101111'                                0434
*             OUTJBPDE=NEXTPDE;     /* MAP NEXT JOB WITH DSECT       */
         L     @14,OUTJBPDE                                        0435
         L     @14,NEXTPDE(,@14)                                   0435
         ST    @14,OUTJBPDE                                        0435
*             CLASPTR=OUTCPDE1;     /* START WITH 1ST CLASS AGAIN    */
         L     CLASPTR,OUTCPDE1                                    0436
*           END;                                                   0437
*         ELSE                      /* IF CURRENT JOB OK, CONTINUE   */
*           DO;                                                    0438
         B     @RC00431                                            0438
@RF00431 DS    0H                                                  0439
*             CLASBUFF='';          /* BLANK CLASS BUFFER            */
         MVI   CLASBUFF,C' '                                       0439
         MVC   CLASBUFF+1(7),CLASBUFF                              0439
*             CLASSCNT=ZERO;        /* ZERO CLASS COUNT              */
*                                                                  0440
         SLR   CLASSCNT,CLASSCNT                                   0440
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE USER SPECIFIED ONE OR MORE CLASSES, FILL THE */
*             /* CLASSLIST UNTIL EITHER 8 CLASSES IN THE LIST OR NO  */
*             /* MORE USER CLASSES TO PUT IN THE LIST.               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0441
*             DO WHILE CLASSCNT<8&CLASPTR^=ENDCHAIN&CLASPTR^=0;    0441
         B     @DE00441                                            0441
@DL00441 DS    0H                                                  0442
*               CLASSCNT=CLASSCNT+ONE;/* INCREMENT INDEX             */
         AL    CLASSCNT,@CF00033                                   0442
*               CLASBUFF(CLASSCNT)=CLASS;/* PUT CLASS IN BUFFER      */
         LA    @14,CLASBUFF-1(CLASSCNT)                            0443
         L     @10,CLASNMAD(,CLASPTR)                              0443
         MVC   0(1,@14),CLASS(@10)                                 0443
*               CLASPTR=CLASSNXT;   /* REPOSITION CLASS PDE DSECT    */
         L     CLASPTR,CLASSNXT(,CLASPTR)                          0444
*             END;                  /* IF END OF CLASS PDE CHAIN     */
@DE00441 CH    CLASSCNT,@CH00041                                   0445
         BNL   @DC00441                                            0445
         CL    CLASPTR,@CF00706                                    0445
         BE    @DC00441                                            0445
         LTR   CLASPTR,CLASPTR                                     0445
         BNZ   @DL00441                                            0445
@DC00441 DS    0H                                                  0446
*             IF CLASPTR=ENDCHAIN×CLASPTR=0 THEN/* NO MORE CLASSES 0446
*                                      AFTER THIS TO MATCH UP, OR USE
*                                      CLASS DEFAULT                 */
         CL    CLASPTR,@CF00706                                    0446
         BE    @RT00446                                            0446
         LTR   CLASPTR,CLASPTR                                     0446
         BNZ   @RF00446                                            0446
@RT00446 DS    0H                                                  0447
*               ENDLIST=YES;        /* INDICATE LAST CALL TO '62 FOR
*                                      THIS JOB                      */
         OI    ENDLIST,B'00001000'                                 0447
*             CALL IKJCT462(ADDR(OUTCOMTB));/* CALL '62 TO PROCESS 0448
*                                      JOB                           */
@RF00446 LA    @14,OUTCOMTB                                        0448
         ST    @14,@TF00001                                        0448
         LA    @14,@TF00001                                        0448
         ST    @14,@AL00001                                        0448
         L     @15,@CV00623                                        0448
         LA    @01,@AL00001                                        0448
         BALR  @14,@15                                             0448
*             RETCODE=REG15;        /* SAVE RETURN CODE              */
         ST    REG15,RETCODE                                       0449
*             IF RETCODE>4 THEN     /* IF >4 SERIOUS ERROR           */
         L     @14,RETCODE                                         0450
         CH    @14,@CH00067                                        0450
         BNH   @RF00450                                            0450
*               ERROR=YES;          /* INDICATE ERROR                */
         OI    ERROR,B'00001000'                                   0451
*             IF RETCODE=4×ENDLIST=YES THEN/* END OF CLASS CHAIN     */
@RF00450 CLC   RETCODE(4),@CF00067                                 0452
         BE    @RT00452                                            0452
         TM    ENDLIST,B'00001000'                                 0452
         BNO   @RF00452                                            0452
@RT00452 DS    0H                                                  0453
*               DO;                 /* OR '62 WANTS NEXT JOB         */
*                 NEXTJOB=YES;      /* GET NEXT JOBNAME              */
         OI    NEXTJOB,B'10000000'                                 0454
*                 ENDLIST=NO;       /* TURN OFF SWITCH               */
         NI    ENDLIST,B'11110111'                                 0455
*               END;                                               0456
*           END;                    /* END PROCESSING OF ELIGIBLE JOB*/
@RF00452 DS    0H                                                  0458
*       END;                        /* END DO WHILE LOOP OF JOB PDES */
@RC00431 DS    0H                                                  0458
@DE00428 CLC   OUTJBPDE(4),@CF00706                                0458
         BE    @DC00428                                            0458
         TM    ERROR,B'00001000'                                   0458
         BZ    @DL00428                                            0458
@DC00428 DS    0H                                                  0459
*     END;                          /* END PROCESSING PRINT REQUEST  */
*                                                                  0460
*/********************************************************************/
*/*   PRINT REQUEST.    PROCESS THE JOBS FOR 'PRINT'                 */
*/********************************************************************/
*                                                                  0460
*   ELSE                            /* ELSE PRINT SPECIFIED          */
*     DO WHILE OUTJBPDE^=ENDCHAIN&ENDSW=NO&ERROR=NO;/* LOOP THRU JOB
*                                      PDE'S UNLESS ERROR OR EARLY 0460
*                                      END                           */
         B     @RC00422                                            0460
@RF00422 B     @DE00460                                            0460
@DL00460 DS    0H                                                  0461
*       WORKDONE=NO;                /* INIT SWITCH BEFORE PROCESSING
*                                      A JOB                         */
         NI    WORKDONE,B'11101111'                                0461
*       IF JBNTFND=OFF THEN         /* IF JOB/JOBCLASS GOOD          */
         L     @14,OUTJBPDE                                        0462
         TM    JBNTFND(@14),B'10000000'                            0462
         BNZ   @RF00462                                            0462
*         DO;                                                      0463
*           RETCODE=ZERO;           /* INIT RETCODE TO ZERO          */
         SLR   @14,@14                                             0464
         ST    @14,RETCODE                                         0464
*           OUTCLPDE=OUTCPDE1;      /* REBASE CLASS PDE DSECT        */
         MVC   OUTCLPDE(4),OUTCPDE1                                0465
*           RFY                                                    0466
*             CLASSPDE BASED(OUTCLPDE);/* .....                      */
*           DO WHILE OUTCLPDE^=ENDCHAIN&RETCODE=ZERO&ENDSW=NO&ERROR=NO;
         B     @DE00467                                            0467
@DL00467 DS    0H                                                  0468
*                                   /* LOOP THRU CLASS PDE'S ONCE FOR
*                                      EACH JOB                      */
*             CLASBUFF='';          /* BLANK CLASS BUFFER            */
*                                                                  0468
         MVI   CLASBUFF,C' '                                       0468
         MVC   CLASBUFF+1(7),CLASBUFF                              0468
*             /*******************************************************/
*             /*                                                     */
*             /* IF CLASS DEFAULTED, CALL '62 THIS WAY               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0469
*             IF OUTCLPDE=ZERO THEN /* IF CLASS PDE PTR ZERO         */
         L     @14,OUTCLPDE                                        0469
         LTR   @14,@14                                             0469
         BNZ   @RF00469                                            0469
*               DO;                 /* ALL HELD CLASSES WILL BE    0470
*                                      SEARCHED                      */
*                 CALL IKJCT462(ADDR(OUTCOMTB));/* CALL '62          */
         LA    @14,OUTCOMTB                                        0471
         ST    @14,@TF00001                                        0471
         LA    @14,@TF00001                                        0471
         ST    @14,@AL00001                                        0471
         L     @15,@CV00623                                        0471
         LA    @01,@AL00001                                        0471
         BALR  @14,@15                                             0471
*                 RETCODE=REG15;    /* SAVE RETURN CODE              */
         ST    REG15,RETCODE                                       0472
*                 IF RETCODE>4 THEN /* IF '62'S RC IS GREATER THAN 4
*                                      IT'S EITHER UNKNOWN OR ERROR  */
         L     @14,RETCODE                                         0473
         CH    @14,@CH00067                                        0473
         BNH   @RF00473                                            0473
*                   ERROR=YES;                                     0474
         OI    ERROR,B'00001000'                                   0474
*                 ELSE              /* PRINT REQUEST PROCESSED OK FOR
*                                      ALL HELD DATASETS OF JOB      */
*                   RETCODE=4;      /* GET NEXT JOBNAME              */
         B     @RC00473                                            0475
@RF00473 MVC   RETCODE(4),@CF00067                                 0475
*               END;                                               0476
*                                                                  0476
*             /*******************************************************/
*             /*                                                     */
*             /* IF CLASS SPECIFIED CALL '62 THIS WAY                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0477
*             ELSE                                                 0477
*               DO;                                                0477
         B     @RC00469                                            0477
@RF00469 DS    0H                                                  0478
*                 CLASBUFF(ONE)=CLASS;/* INSERT ONE CLASS NAME       */
         L     @14,OUTCLPDE                                        0478
         L     @14,CLASNMAD(,@14)                                  0478
         MVC   CLASBUFF(1),CLASS(@14)                              0478
*                 CALL IKJCT462(ADDR(OUTCOMTB));/* CALL JOB PROCESSOR*/
         LA    @14,OUTCOMTB                                        0479
         ST    @14,@TF00001                                        0479
         LA    @14,@TF00001                                        0479
         ST    @14,@AL00001                                        0479
         L     @15,@CV00623                                        0479
         LA    @01,@AL00001                                        0479
         BALR  @14,@15                                             0479
*                 RETCODE=REG15;    /* SAVE RETURN CODE              */
         ST    REG15,RETCODE                                       0480
*                 IF RETCODE>4 THEN /* CHECK RETURN CODE, IF ERROR   */
         L     @14,RETCODE                                         0481
         CH    @14,@CH00067                                        0481
         BNH   @RF00481                                            0481
*                   ERROR=YES;      /* TURN ON ERROR SWITCH          */
         OI    ERROR,B'00001000'                                   0482
*                 ELSE              /* NO ERROR                      */
*                   OUTCLPDE=CLASSNXT;/* INCREMENT CLASS PTR         */
         B     @RC00481                                            0483
@RF00481 L     @14,OUTCLPDE                                        0483
         L     @14,CLASSNXT(,@14)                                  0483
         ST    @14,OUTCLPDE                                        0483
*               END;                                               0484
@RC00481 DS    0H                                                  0485
*           END;                    /* END DO WHILE LOOP OF CLASS  0485
*                                      PDE'S FOR A JOB               */
*                                                                  0485
@RC00469 DS    0H                                                  0485
@DE00467 CLC   OUTCLPDE(4),@CF00706                                0485
         BE    @DC00467                                            0485
         L     @14,RETCODE                                         0485
         LTR   @14,@14                                             0485
         BNZ   @DC00467                                            0485
         TM    ENDSW,B'00011000'                                   0485
         BZ    @DL00467                                            0485
@DC00467 DS    0H                                                  0486
*           /*********************************************************/
*           /*                                                       */
*           /* THIS CODE IS EXECUTED WHEN THERE ARE NO MORE CLASSES  */
*           /* TO PROCESS FOR THIS JOB, OR WHEN THERE WILL BE NO MORE*/
*           /* CALLS TO '62 FOR THIS JOB FOR SOME OTHER REASON       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0486
*           IF SUBSYS=YES&ERROR=NO&ENDSW=NO THEN/* IN MIDDLE OF    0486
*                                      PROCESSING A SET OF DATA SETS.
*                                      SINCE NO EARLY TERMINATION, 0486
*                                      '62 HAS NOT ISSUED THE CLEAN
*                                      UP CALL TO THE SUBSYSTEM FOR
*                                      THIS JOB.                     */
         TM    SUBSYS,B'10000000'                                  0486
         BNO   @RF00486                                            0486
         TM    ERROR,B'00011000'                                   0486
         BNZ   @RF00486                                            0486
*             DO;                   /* SO ISSUE CLEAN UP CALL        */
*               NOWORK=ON;          /* INDICATE NO MORE PROCESSING 0488
*                                      FOR THIS JOB                  */
         OI    NOWORK,B'00000010'                                  0488
*               CALL IKJCT462(ADDR(OUTCOMTB));/* FINAL CALL SO '62 0489
*                                      CAN TELL SUBSYS THAT DONE WITH
*                                      JOB                           */
         LA    @14,OUTCOMTB                                        0489
         ST    @14,@TF00001                                        0489
         LA    @14,@TF00001                                        0489
         ST    @14,@AL00001                                        0489
         L     @15,@CV00623                                        0489
         LA    @01,@AL00001                                        0489
         BALR  @14,@15                                             0489
*               NOWORK=OFF;                                        0490
         NI    NOWORK,B'11111101'                                  0490
*             END;                                                 0491
*         END;                      /* END OF PROCESSING ELIGIBLE JOB*/
*       ELSE                                                       0493
*         ;                         /* THIS JOB NOT ELIGIBLE FOR   0493
*                                      PROCESSING, GET NEXT JOB.     */
@RF00462 DS    0H                                                  0494
*/********************************************************************/
*/*    THIS CODE IS EXECUTED WHEN THERE ARE NO MORE CLASSES TO       */
*/*    MATCH UP WITH THE CURRENT JOB, OR IF THE CURRENT JOB WAS      */
*/*    INELIGIBLE                                                    */
*/********************************************************************/
*                                                                  0494
*       OUTJBPDE=NEXTPDE;           /* GO TO NEXT JOB IN PDE CHAIN   */
@RC00462 L     @14,OUTJBPDE                                        0494
         L     @14,NEXTPDE(,@14)                                   0494
         ST    @14,OUTJBPDE                                        0494
*       WORKDONE=NO;                /* REINIT SWITCH FOR '62 BEFORE
*                                      PROCESSING NEXT JOB           */
         NI    WORKDONE,B'11101111'                                0495
*       RETCODE=ZERO;                                              0496
         SLR   @14,@14                                             0496
         ST    @14,RETCODE                                         0496
*     END;                          /* END DO WHILE LOOP OF JOB PDE'S*/
@DE00460 CLC   OUTJBPDE(4),@CF00706                                0497
         BE    @DC00460                                            0497
         TM    ENDSW,B'00011000'                                   0497
         BZ    @DL00460                                            0497
@DC00460 DS    0H                                                  0498
*                                                                  0498
*/********************************************************************/
*/*      DONE PROCESSING ALL JOBS.  RETURN TO CALLER.                */
*/********************************************************************/
*                                                                  0498
*   IF ERROR=YES THEN               /* IF ANY ERRORS                 */
@RC00422 TM    ERROR,B'00001000'                                   0498
         BNO   @RF00498                                            0498
*     OUTRTCD=BADERROR;             /* SET RETURN CODE TO 12         */
         MVC   OUTRTCD(2),@CH00150                                 0499
*   END JBPROCES;                   /* RETURN TO MAIN PROC           */
@EL00004 DS    0H                                                  0500
@EF00004 DS    0H                                                  0500
@ER00004 LM    @14,@12,@SA00004                                    0500
         BR    @14                                                 0500
*   END IKJCT469                                                   0501
*                                                                  0501
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJEFFB2)                                       */
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFIE)                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*                                                                  0501
*       ;                                                          0501
@DATA    DS    0H
@CH00082 DC    H'2'
@CH00257 DC    H'3'
@CH00041 DC    H'8'
@CH00236 DC    H'20'
@CH00742 DC    H'132'
@CH00751 DC    H'3036'
@SM00787 MVC   STAXLSTD(0),STICSTAX
@SM00789 MVC   DCBOUTD(0),DCBOUT
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00004 DS    0F
@SA00002 DS    0F
         DS    15F
@AL00001 DS    1A
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJCT469 CSECT
         DS    0F
@CF00033 DC    F'1'
@CH00033 EQU   @CF00033+2
@CF00067 DC    F'4'
@CH00067 EQU   @CF00067+2
@CF00150 DC    F'12'
@CH00150 EQU   @CF00150+2
@CF00115 DC    F'16'
@CF00706 DC    XL4'FF000000'
@DATD    DSECT
         DS    0D
DCBPTR   DS    A
OPENEXAD DS    AL4
         ORG   OPENEXAD
FLAG     DS    AL1
ADDREXIT DS    AL3
         ORG   OPENEXAD+4
RETCODE  DS    F
ECTPTR   DS    A
OUTP     DS    A
JOBCOUNT DS    H
         DS    CL2
OUTCOMTB DS    CL312
         ORG   OUTCOMTB
OUTCPPL  DS    AL4
OUTMSGID DS    CL1
OUTFLAGS DS    CL1
         ORG   OUTFLAGS
KEY1     DS    BL1
         ORG   OUTCOMTB+6
OUTRTCD  DS    FL2
OUTMACN  DS    CL8
OUTCMDNM DS    CL8
OUTATTN  DS    AL4
         ORG   OUTATTN
@NM00004 DS    BL1
POSTED   EQU   OUTATTN+0
         ORG   OUTCOMTB+28
OUTEXTRA DS    CL4
OUTEMPMN DS    CL8
OUTSOBH  DS    AL4
OUTSOBSO DS    AL4
OUTRPL   DS    AL4
OUTRPLL  DS    FL4
OUTACB   DS    AL4
OUTACBL  DS    FL4
OUTEMPSB DS    AL4
OUTHOLD  DS    CL8
OUTBKNEW DS    CL8
OUTBKAPX DS    CL8
OUTBKCNT DS    FL4
STRCTNUM DS    FL4
O73PARM  DS    CL20
         ORG   O73PARM+0
OUTDCB   DS    AL4
PRINTDDN DS    CL8
OUTBUFA  DS    AL4
@NM00005 DS    FL4
         ORG   @NM00005+0
@NM00006 DS    CL1
@NM00007 DS    BL1
DSALLOC  EQU   @NM00005+1
DSOPEN   EQU   @NM00005+1
OUTRECV  EQU   @NM00005+1
NEEDFREE EQU   @NM00005+1
NEWDS    EQU   @NM00005+1
NOMEMNAM EQU   @NM00005+1
OUTRECUN EQU   @NM00005+1
OUTBUFL  DS    FL2
         ORG   OUTCOMTB+140
OUTRECA  DS    AL4
OUTRECL  DS    FL2
OUTKEYWD DS    CL2
         ORG   OUTKEYWD
PAUSE    DS    BL1
HOLD     EQU   OUTKEYWD+0
HERE     EQU   OUTKEYWD+0
BEGIN    EQU   OUTKEYWD+0
NEXT     EQU   OUTKEYWD+0
DELETE   EQU   OUTKEYWD+0
PRINT    EQU   OUTKEYWD+0
NEWCLASS EQU   OUTKEYWD+0
KEEP     DS    BL1
DEST     EQU   OUTKEYWD+1
SUBCONT  EQU   OUTKEYWD+1
SUBHERE  EQU   OUTKEYWD+1
SUBBEGN  EQU   OUTKEYWD+1
SUBNEXT  EQU   OUTKEYWD+1
         ORG   OUTCOMTB+148
OUTSW    DS    BL2
         ORG   OUTSW
SUBSYS   DS    BL1
SUBCMODE EQU   OUTSW+0
UNALCALL EQU   OUTSW+0
ENDSW    EQU   OUTSW+0
ERROR    EQU   OUTSW+0
ENDKEEP  EQU   OUTSW+0
NOWORK   EQU   OUTSW+0
HASPABND EQU   OUTSW+0
SYNADERR DS    BL1
OPENED   EQU   OUTSW+1
NONTERM  EQU   OUTSW+1
WORKDONE EQU   OUTSW+1
ENDLIST  EQU   OUTSW+1
         ORG   OUTCOMTB+150
OUTIDSSW DS    BL1
         ORG   OUTIDSSW
POINT    DS    BL1
@NM00008 EQU   OUTIDSSW+0
@NM00009 EQU   OUTIDSSW+0
EODSW    EQU   OUTIDSSW+0
TERM     EQU   OUTIDSSW+0
ALLOC    EQU   OUTIDSSW+0
INTRPMSG EQU   OUTIDSSW+0
@NM00010 EQU   OUTIDSSW+0
         ORG   OUTCOMTB+152
OUTDARB  DS    AL4
OUTDAIR  DS    AL4
OUTPDL   DS    AL4
OUTXMSG  DS    AL4
         ORG   OUTXMSG
OUTSYNMS DS    AL4
         ORG   OUTCOMTB+168
OUTXRPLY DS    AL4
OUTTCBH  DS    AL4
OHELPECB DS    AL4
OUTSBPDL DS    AL4
OUTSBBUF DS    AL4
OUTSTAE  DS    2A
OUTWORK  DS    12F
CLASBUFF DS    CL8
OSYSODDN DS    CL8
OUTPLIST DS    CL16
         ORG   OUTPLIST
OUTCPDE1 DS    AL4
OPRDSPDE DS    AL4
ONEWCPDE DS    AL4
ODESTPDE DS    AL4
         ORG   OUTCOMTB+276
OUTJBPDE DS    AL4
OUTCLPDE DS    AL4
OSVDSPDE DS    AL4
EWAPTR   DS    AL4
IOPLPTR  DS    AL4
IOPLAREA DS    CL16
         ORG   OUTCOMTB+312
PARMLIST DS    CL40
         ORG   PARMLIST
JOBNAMEP DS    AL4
NAMELENP DS    AL4
USERIDP  DS    AL4
IDLENPTR DS    AL4
MESSAGEP DS    AL4
REPLYP   DS    AL4
CODEP    DS    AL4
JOBIDP   DS    AL4
JIDLENP  DS    AL4
IEOUTPLP DS    AL4
         ORG   IEOUTPLP
IEHIGH   DS    BL1
         ORG   PARMLIST+40
SSOB     DS    CL20
         ORG   SSOB
SSOBID   DS    CL4
SSOBLEN  DS    FL2
SSOBFUNC DS    FL2
SSOBSSIB DS    AL4
SSOBRETN DS    AL4
SSOBINDV DS    AL4
         ORG   SSOB+20
SSSO     DS    CL120
         ORG   SSSO
SSSOLEN  DS    FL2
SSSOUFLG DS    BL1
         ORG   SSSOUFLG
SSSOSETC DS    BL1
SSSODELC EQU   SSSOUFLG+0
SSSOROUT EQU   SSSOUFLG+0
SSSOHOLD EQU   SSSOUFLG+0
SSSORLSE EQU   SSSOUFLG+0
@NM00013 EQU   SSSOUFLG+0
         ORG   SSSO+3
@NM00014 DS    AL1
SSSOFLG1 DS    BL1
         ORG   SSSOFLG1
SSSOSHLD DS    BL1
SSSOSCLS EQU   SSSOFLG1+0
SSSOSDST EQU   SSSOFLG1+0
SSSOSJBN EQU   SSSOFLG1+0
SSSOSJBI EQU   SSSOFLG1+0
SSSOSPGM EQU   SSSOFLG1+0
SSSOSFRM EQU   SSSOFLG1+0
@NM00015 EQU   SSSOFLG1+0
         ORG   SSSO+5
SSSOFLG2 DS    BL1
         ORG   SSSOFLG2
SSSOCTRL DS    BL1
SSSOCHKP EQU   SSSOFLG2+0
@NM00016 EQU   SSSOFLG2+0
         ORG   SSSO+6
SSSOCOPY DS    FL2
SSSOJOBN DS    CL8
SSSOJOBI DS    CL8
SSSOCLAS DS    CL1
@NM00017 DS    CL3
SSSODEST DS    CL8
SSSOPGMN DS    CL8
SSSORBA  DS    CL8
SSSODSN  DS    CL44
SSSOFORM DS    CL4
SSSOCLSL DS    CL8
SSSOWTRC DS    AL4
SSSODSID DS    CL8
         ORG   SSSO+120
ESTAEWA  DS    CL340
SYNSW    DS    BL1
         ORG   SYNSW
PRINTING DS    BL1
ROUTING  EQU   SYNSW+0
SYNERROR EQU   SYNSW+0
         ORG   SYNSW+1
STXMSG   DS    CL8
         ORG   STXMSG
MODEMSG  DS    CL8
         ORG   STXMSG+8
         DS    CL3
PPLAREA  DS    CL28
USERLIST DS    CL20
LOOP     DS    BL1
QUIT     DS    BL1
NEXTJOB  DS    BL1
IKJCT469 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00621 DC    V(IKJCT467)
@CV00622 DC    V(IKJCT472)
@CV00623 DC    V(IKJCT462)
@CV00624 DC    V(IKJCT473)
@CV00625 DC    V(IKJCT460)
         DS    0D
@CC00738 DC    C'SSOB'
PATCH69  DS    CL300
         ORG   PATCH69
PACHINIT DC    60CL5'ZAP69'
         ORG   PATCH69+300
DFLTPRNT DS    CL24
         ORG   DFLTPRNT
@NM00049 DC    AL4(DFLTNAME)
@NM00050 DC    X'00018000'
@NM00051 DC    4F'0'
         ORG   DFLTPRNT+24
DFLTNAME DC    CL1'*'
IKJCT469 CSECT
PCLADCON DC    V(IKJCT4PO)               VCON FOR OUTPUT CP PCL
IKJCT4PO IKJPARM
PJOBNAME IKJPOSIT JOBNAME,                                             X
               LIST,                                                   X
               PROMPT='JOBNAME OR JOBNAME(JOBID)',                     X
               HELP='JOBNAME OF PREVIOUSLY SUBMITTED JOB'
*
PCLASS   IKJKEYWD
         IKJNAME 'CLASS',SUBFLD=CLASSUB
*
PPRINT   IKJKEYWD
         IKJNAME 'PRINT',SUBFLD=PRINTSUB
*
PKEEP    IKJKEYWD
         IKJNAME 'KEEP'
         IKJNAME 'NOKEEP'
*
PNEWCL   IKJKEYWD
         IKJNAME 'NEWCLASS',SUBFLD=NEWCLSUB
*
PDELETE  IKJKEYWD
         IKJNAME 'DELETE'
*
PHOLD    IKJKEYWD
         IKJNAME 'HOLD'
         IKJNAME 'NOHOLD'
*
PDEST    IKJKEYWD
         IKJNAME 'DEST',SUBFLD=DESTSUB
*
PHERE    IKJKEYWD
         IKJNAME 'NEXT'
         IKJNAME 'HERE'
         IKJNAME 'BEGIN'
*
PPAUSE   IKJKEYWD
         IKJNAME  'PAUSE'
         IKJNAME  'NOPAUSE'
*
*        B E G I N   S U B F I E L D S
*
CLASSUB  IKJSUBF
SCLASS   IKJIDENT 'CLASSNAME',LIST,FIRST=NONATNUM,MAXLNTH=1,           *
               PROMPT='CLASS NAME'
*
PRINTSUB IKJSUBF
SPRINT   IKJPOSIT  DSTHING,USID,DEFAULT='*',                           *
               HELP='DSNAME(MEMBERNAME) /PASSWORD'
*
NEWCLSUB IKJSUBF
SNEWCL   IKJIDENT 'NEW CLASSNAME',FIRST=NONATNUM,MAXLNTH=1,            *
               PROMPT='NEW CLASSNAME'
*
DESTSUB  IKJSUBF
SDEST    IKJPOSIT USERID,                                              *
               PROMPT='REMOTE STATION ID FOR THE DEST KEYWORD'
*
         IKJENDP
IKJCT469 CSECT
DCBOUT    DCB   DSORG=PS,MACRF=PM,BFTEK=S
OPENLIST  OPEN  (0,(OUTPUT)),MF=L
CLOSLIST  CLOSE (0),MF=L
TEMPLTH   EQU   *
DCBLTH    DC    A(TEMPLTH-DCBOUT)           LEN DCB, OPEN & CLOSE LSTS
STICSTAX  STAX  MF=L
TEMPLTH1  EQU   *
STAXLTH   DC    A(TEMPLTH1-STICSTAX)        LEN STAX LIST
STICESTA  ESTAE  MF=L
ESTAELTH  EQU  *-STICESTA
@DATD    DSECT
DCBOUTD   DCB   DSORG=PS,MACRF=PM,BFTEK=S
OPENLSTD  OPEN  (0,(OUTPUT)),MF=L
CLOSLSTD  CLOSE (0),MF=L
STAXLSTD  STAX  MF=L
ESTALSTD  ESTAE   MF=L
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT469 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CLASPTR  EQU   @04
JOBASE   EQU   @04
CLASSCNT EQU   @05
PPLPTR   EQU   @04
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG14    EQU   @14
REG15    EQU   @15
PDLBASE  EQU   @02
MESSAGE  EQU   0
IEREPLY  EQU   0
IEOUTPL  EQU   0
@NM00011 EQU   IEOUTPL+16
IESYNTAX EQU   @NM00011
CPPL     EQU   0
CPPLCBUF EQU   CPPL
CPPLUPT  EQU   CPPL+4
CPPLECT  EQU   CPPL+12
PPL      EQU   0
PPLUPT   EQU   PPL
PPLECT   EQU   PPL+4
PPLECB   EQU   PPL+8
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
IOPL     EQU   0
IOPLUPT  EQU   IOPL
IOPLECT  EQU   IOPL+4
IOPLECB  EQU   IOPL+8
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
DCBRECL  EQU   DCBRECLA
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBLRECL EQU   IHADCS38+10
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00042 EQU   IHADCS40+12
DCBEROPT EQU   @NM00042
JOBPDE   EQU   0
JBNAMEAD EQU   JOBPDE
JBNTFND  EQU   JBNAMEAD
JBNMLTH  EQU   JOBPDE+4
JBIDADR  EQU   JOBPDE+8
JBIDLTH  EQU   JOBPDE+12
NEXTPDE  EQU   JOBPDE+16
CLASSPDE EQU   0
CLASNMAD EQU   CLASSPDE
CLASSNXT EQU   CLASSPDE+8
DSPDE    EQU   0
DSNAMEAD EQU   DSPDE
DSNAME   EQU   0
CLASS    EQU   0
CMNDCODE EQU   0
IDLENGTH EQU   0
IEJOBID  EQU   0
IEJOBNM  EQU   0
JIDLEN   EQU   0
JOBID    EQU   0
JOBNAME  EQU   0
JOBNAMEL EQU   0
USERID   EQU   0
FIBCPARM EQU   0
FIBPSCBU EQU   FIBCPARM+4
FIBPSCBL EQU   FIBCPARM+11
FIBCPPLC EQU   FIBCPARM+12
FIBECTCN EQU   FIBCPARM+28
FIBFLAGS EQU   FIBCPARM+36
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FIBCMDBF EQU   FIBCPARM+52
@NM00003 EQU   FIBCPARM+48
@NM00002 EQU   FIBCPARM+44
FIBCUSER EQU   FIBCPARM+40
@NM00001 EQU   FIBCPARM+38
FIBECTNO EQU   FIBFLAGS
FIBCPPLE EQU   FIBCPARM+24
FIBCPPLP EQU   FIBCPARM+20
FIBCPPLU EQU   FIBCPARM+16
FIBCID   EQU   FIBCPARM+2
FIBCLEN  EQU   FIBCPARM
@NM00048 EQU   CLASSPDE+4
@NM00047 EQU   JOBPDE+14
@NM00046 EQU   JOBPDE+6
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00045 EQU   IHADCS40+16
@NM00044 EQU   @NM00042+1
@NM00043 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00041 EQU   IHADCS40+10
@NM00040 EQU   IHADCS40+9
@NM00039 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00038 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
@NM00037 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00036 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00035 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00034 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00033 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00032 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00031 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
@NM00030 EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00029 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00028 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00027 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBIFPCT EQU   DCBIFLGS
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00026 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBIBPCT EQU   DCBIFLG
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00025 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00024 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00023 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00022 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
DCBDSGMQ EQU   DCBDSRG1
DCBDSGCQ EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00021 EQU   IHADCS01+5
@NM00020 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00019 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00018 EQU   IHADCB
IOPLIOPB EQU   IOPL+12
CPPLPSCB EQU   CPPL+8
@NM00012 EQU   IESYNTAX+1
IEDEST   EQU   IESYNTAX+1
IEKEEP   EQU   IESYNTAX+1
IENCLASS EQU   IESYNTAX
IEPRINT  EQU   IESYNTAX
IEDELETE EQU   IESYNTAX
IENEXT   EQU   IESYNTAX
IEBEGIN  EQU   IESYNTAX
IEHERE   EQU   IESYNTAX
IEHOLD   EQU   IESYNTAX
IEPAUSE  EQU   IESYNTAX
DESTPDE  EQU   IEOUTPL+12
NEWCPDE  EQU   IEOUTPL+8
PRDSPDE  EQU   IEOUTPL+4
CLASPDE1 EQU   IEOUTPL
IERTEXT  EQU   IEREPLY+2
IEREPLYL EQU   IEREPLY
MSGTEXT  EQU   MESSAGE+2
MSGLENGT EQU   MESSAGE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00302 EQU   @RC00289
@RC00282 EQU   @EL00002
@RC00376 EQU   @RC00368
@RC00473 EQU   @RC00469
@RF00486 EQU   @RC00462
@RF00498 EQU   @EL00004
@PB00004 EQU   @EL00001
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJCT469,(C'PLS1855',0701,76056)

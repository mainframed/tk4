         TITLE 'IEEVSND4 - OPERATOR SEND COMMAND CLEANUP ROUTINE       *
                        '
IEEVSND4 CSECT ,                                                   0001
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0001
         MODID BRANCH=YES
REGS     DS    0H                                                  0062
         EJECT
*   COMPTR=R1;                      /* SET BASE FOR COMMON DATA AREA */
         LR    COMPTR,R1                                           0068
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*          E     X     I     T     C     O     D     E             */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0069
*EXITCODE:                          /* CLEANUP AND END PROCESSING    */
*   IF FANYINV='1'B                 /* TEST ROUTING FLAG SET IN SND2 */
*     THEN                          /* ON, ROUTE CONTROL TO ANYINV   */
EXITCODE TM    FANYINV(COMPTR),B'01000000'                         0069
         BO    @RT00069                                            0069
*     GOTO ANYINV;                  /* SET UP FOR MSGF         Y02676*/
*   IF FMSG1='1'B                   /* TEST IF MSG1 TO BE ISSUED     */
*     THEN                          /* YES, SOME USERIDS INVALID     */
         TM    FMSG1(COMPTR),B'00001000'                           0071
         BO    @RT00071                                            0071
*     GOTO MSG1OUT;                 /* GOTO ISSUE MSG 1              */
*   IF FMSG2='1'B                   /* TEST IF MSG2 TO BE ISSUED     */
*     THEN                          /* YES, SOME SPECIFIED USERIDS 0073
*                                      NOT LOGGED ON WITH 'NOW' PARM */
         TM    FMSG2(COMPTR),B'10000000'                           0073
         BO    @RT00073                                            0073
*     GOTO INV2;                    /* GOTO ISSUE MSG 2              */
*   IF FMSG3='1'B                   /* TEST IF MSG3 TO BE ISSUED     */
*     THEN                          /* YES, SYNTAX ERROR IN CMD      */
         TM    FMSG3(COMPTR),B'01000000'                           0075
         BO    @RT00075                                            0075
*     GOTO ERRSYN;                  /* GOTO ISSUE MSG 3              */
*   IF FMSG4='1'B                   /* TEST IF MSG4 TO BE ISSUED     */
*     THEN                          /* YES, BROADCAST DATA SET FULL  */
         TM    FMSG4(COMPTR),B'00100000'                           0077
         BO    @RT00077                                            0077
*     GOTO ERR4;                    /* GOTO ISSUE MSG 4              */
*   IF FMSG6='1'B                   /* TEST IF MSG6 TO BE ISSUED     */
*     THEN                          /* YES, BROADCAST MSG NOT FOUND  */
         TM    FMSG6(COMPTR),B'00001000'                           0079
         BO    @RT00079                                            0079
*     GOTO WMSG6;                   /* GOTO ISSUE MSG 6              */
*   IF FMSG8='1'B                   /* TEST IF MSG8 TO BE ISSUED     */
*     THEN                          /* YES, BROADCAST MSG ADDED TO DS*/
         TM    FMSG8(COMPTR),B'00000100'                           0081
         BO    @RT00081                                            0081
*     GOTO MSG8OUT;                 /* GOTO ISSUE MSG 8              */
*   IF FMSGA='1'B                   /* TEST IF MSGA TO BE ISSUED     */
*     THEN                          /* YES, MSG TEXT TRUNCATED       */
         TM    FMSGA(COMPTR),B'00000001'                           0083
         BO    @RT00083                                            0083
*     GOTO MSGAOUT;                 /* ISSUE WARNING MSG TO SENDER   */
*   IF FOVER20='1'B                 /* TEST IF MSGF REQUIRED   Y02676*/
*     THEN                          /* YES, OVER 20 USERIDS    Y02676*/
         TM    FOVER20(COMPTR),B'00000010'                         0085
         BO    @RT00085                                            0085
*     GOTO MSGEOUT;                 /* ISSUE WARNING MSG       Y02676*/
*   IF FBADTPUT='1'B                /* TEST IF TPUT ERROR FOUND      */
*     THEN                          /* YES, TPUT ERROR FOUND         */
         TM    FBADTPUT(COMPTR),B'00000001'                        0087
         BO    @RT00087                                            0087
*     GOTO BADTPUT;                 /* ISSUE WARNING MSG TO SENDER   */
*   IF FBADIO='1'B                  /* TEST IF IO ERROR FOUND        */
*     THEN                          /* YES, IO ERROR FOUND           */
         TM    FBADIO(COMPTR),B'00000100'                          0089
         BO    @RT00089                                            0089
*     GOTO BADIO;                   /* ISSUE WARNING MSG TO SENDER   */
*   IF FBADRITA='1'B                /* TEST IF BAD WRITE 'DA'        */
*     THEN                          /* YES, BAD 'WRITE IN FREE SPACE'*/
         TM    FBADRITA(COMPTR),B'00000010'                        0091
         BO    @RT00091                                            0091
*     GOTO BADRITA;                 /* ISSUE WARNING MSG TO SENDER   */
*EXIT3:                                                            0093
*   RETURN;                                                        0093
@EL00001 L     @13,4(,@13)                                         0093
@EF00001 L     @00,@SIZDATD                                        0093
         LR    @01,@12                                             0093
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0093
         BR    @14                                                 0093
*                                                                  0094
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*                 SET UP MSG 'INVALID USERID(S) ---'               */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0094
*ANYINV:                            /* REJECT SYNTACTICALLY INVALID
*                                      USERIDS                 Y02676*/
*   FANYINV='0'B;                   /* TURN OFF ROUTING FLAG         */
ANYINV   NI    FANYINV(COMPTR),B'10111111'                         0094
*   GMTEXT(1:MSGFLNG)=MSGFTEXT;     /* COPY MSGF TEXT          Y02676*/
         L     @10,@CA00171                                        0095
         L     @10,MSGFP-MSGTABLE(,@10)                            0095
         SLR   @02,@02                                             0095
         IC    @02,MSGFLNG(,@10)                                   0095
         LR    @15,@02                                             0095
         BCTR  @15,0                                               0095
         EX    @15,@SM00468                                        0095
*   GMTEXT(MSGFLNG+1:MSGFLNG+M1IND+1)=MSG1EXT(1:M1IND-1);/*    Y02676
*                                      APPEND INSERT           Y02676*/
         LA    @01,GMTEXT(@02)                                     0096
         SLR   @15,@15                                             0096
         IC    @15,M1IND(,COMPTR)                                  0096
         EX    @15,@SM00470                                        0096
*   GMNUM=MSGFWTN;                  /* SET MSG ID              Y02676*/
         MVI   GMNUM+7,C' '                                        0097
         MVI   GMNUM+8,C' '                                        0097
         MVC   GMNUM(7),MSGFWTN(@10)                               0097
*   GENLNG=MSGFLNG+WTNLNG+M1IND-1;  /*                         Y02676
*                                      COMPUTE MESSAGE LENGTH  Y02676*/
         MVC   @ZT00003+3(1),WTNLNG                                0098
         AL    @02,@ZT00003                                        0098
         ALR   @02,@15                                             0098
         BCTR  @02,0                                               0098
         STH   @02,GENLNG                                          0098
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG       Y02676*/
         B     WARNMSG                                             0099
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*            SET UP MSG 'UNDEFINED USERID(S) ---'                  */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0100
*MSG1OUT:                           /* ISSUE 'UNDEFINED USERS' MSG   */
*   M1IND=1;                        /* INITIALIZE INDEX TO INSERT  0100
*                                      AREA                    Y02676*/
MSG1OUT  MVI   M1IND(COMPTR),X'01'                                 0100
*IDLP1:                                                            0101
*   DO J=1 TO IDCNT;                /* SCAN ENTIRE USERID TABLE TO 0101
*                                      CHK FOR ANY INVALID USERIDS 0101
*                                                              SPEC'D
*                                      CHECK FOR BLANK USERID ENTRY  */
IDLP1    LA    @10,1                                               0101
         B     @DE00101                                            0101
@DL00101 DS    0H                                                  0102
*     IF IDUSRID(J,1:7)^=BLNKID(1:7)/* IS THIS ENTRY BLANK           */
*       THEN                        /* NO, THIS ENTRY IS NOT BLANK   */
         SLA   @10,3                                               0102
         ALR   @10,COMPTR                                          0102
         CLC   IDUSRID-8(7,@10),BLNKID                             0102
         BE    @RF00102                                            0102
*IDLP2:                                                            0103
*       DO;                         /* MOVE USERID INTO MSG AREA     */
IDLP2    DS    0H                                                  0104
*IDLP3:                                                            0104
*         DO K=1 TO 7;              /* SCAN 1 ENTRY IN USERID TABLE  */
IDLP3    LA    @10,1                                               0104
         STC   @10,K                                               0104
@DL00104 DS    0H                                                  0105
*           IF IDUSRID(J,K)=' '     /* IS THIS CHAR A BLANK          */
*             THEN                  /* YES, END OF THIS USERID       */
         SLR   @02,@02                                             0105
         IC    @02,J                                               0105
         SLA   @02,3                                               0105
         ALR   @02,@10                                             0105
         ST    @02,@TF00001                                        0105
         ALR   @02,COMPTR                                          0105
         CLI   IDUSRID-9(@02),C' '                                 0105
         BE    @RT00105                                            0105
*             GOTO IDLP4;           /* GO TO GET NEXT USERID ENTRY   */
*           MSG1EXT(M1IND)=IDUSRID(J,K);/* MOVE THIS CHAR OF USERID
*                                      TO MSG AREA                   */
         SLR   @02,@02                                             0107
         IC    @02,M1IND(,COMPTR)                                  0107
         ALR   @02,COMPTR                                          0107
         LR    @01,COMPTR                                          0107
         AL    @01,@TF00001                                        0107
         MVC   MSG1EXT-1(1,@02),IDUSRID-9(@01)                     0107
*           M1IND=M1IND+1;          /* BUMP INDEX TO MSG TEXT        */
         SLR   @02,@02                                             0108
         IC    @02,M1IND(,COMPTR)                                  0108
         AH    @02,@CH00047                                        0108
         STC   @02,M1IND(,COMPTR)                                  0108
*         END IDLP3;                /* END OF MOVING 1 USERID        */
         AH    @10,@CH00047                                        0109
         STC   @10,K                                               0109
         CH    @10,@CH00118                                        0109
         BNH   @DL00104                                            0109
*IDLP4:                                                            0110
*         MSG1EXT(M1IND)=' ';       /* INSERT BLANK BETWEEN ID'S     */
IDLP4    SLR   @10,@10                                             0110
         IC    @10,M1IND(,COMPTR)                                  0110
         ALR   @10,COMPTR                                          0110
         MVI   MSG1EXT-1(@10),C' '                                 0110
*         M1IND=M1IND+1;            /* BUMP INDEX TO MSG TEXT        */
         SLR   @10,@10                                             0111
         IC    @10,M1IND(,COMPTR)                                  0111
         AH    @10,@CH00047                                        0111
         STC   @10,M1IND(,COMPTR)                                  0111
*       END IDLP2;                  /* END OF 1 USERID ENTRY         */
*   END IDLP1;                      /* END OF USERID TABLE SCAN      */
@RF00102 LA    @10,1                                               0113
         MVC   @ZT00003+3(1),J                                     0113
         AL    @10,@ZT00003                                        0113
@DE00101 STC   @10,J                                               0113
         MVC   @ZT00003+3(1),IDCNT(COMPTR)                         0113
         C     @10,@ZT00003                                        0113
         BNH   @DL00101                                            0113
*   FMSG1='0'B;                     /* TURN OFF MSG 1 FLAG           */
         NI    FMSG1(COMPTR),B'11110111'                           0114
*   GMTEXT(1:MSG1LNG)=MSG1TEXT;     /* BEGINNING MSG1 TEXT PUT     0115
*                                      INVALID USERIDS INTO MSG1     */
         L     @10,@CA00171                                        0115
         L     @10,MSG1P-MSGTABLE(,@10)                            0115
         SLR   @02,@02                                             0115
         IC    @02,MSG1LNG(,@10)                                   0115
         LR    @15,@02                                             0115
         BCTR  @15,0                                               0115
         EX    @15,@SM00473                                        0115
*   GMTEXT(MSG1LNG+1:MSG1LNG+M1IND+1)=MSG1EXT(1:M1IND-1);          0116
         LA    @01,GMTEXT(@02)                                     0116
         SLR   @15,@15                                             0116
         IC    @15,M1IND(,COMPTR)                                  0116
         EX    @15,@SM00470                                        0116
*   GMNUM=MSG1WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0117
         MVI   GMNUM+8,C' '                                        0117
         MVC   GMNUM(7),MSG1WTN(@10)                               0117
*   GENLNG=MSG1LNG+WTNLNG+M1IND-1;  /* SET LENGTH MSG TEXT PLUS MSG
*                                      ID PLUS USERIDS               */
         MVC   @ZT00003+3(1),WTNLNG                                0118
         AL    @02,@ZT00003                                        0118
         ALR   @02,@15                                             0118
         BCTR  @02,0                                               0118
         STH   @02,GENLNG                                          0118
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG           0119
*                                                                    */
         B     WARNMSG                                             0119
*                                                                  0120
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*                                                                  */
*/*               SET UP MSG 'USERS....NOT LOGGED ON'                */
*/*                                                                  */
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0120
*INV2:                              /* 'NOW' SPEC'D BUT NOT ALL USERS
*                                      SPECIFIED WERE LOGGED ON      */
*   FMSG2='0'B;                     /* TURN OFF MSG 2 FLAG           */
INV2     NI    FMSG2(COMPTR),B'01111111'                           0120
*   M=1;                            /* INIT INDEX TO MSG TEXT        */
         LA    @10,1                                               0121
         STC   @10,M                                               0121
*   GMTEXT(M:MSG2BEGL)=MSG2BEG;     /* SET BEGINNING MSG2 TEXT       */
         LA    @02,GMTEXT-1(@10)                                   0122
         L     @15,@CA00171                                        0122
         L     @15,MSG2P-MSGTABLE(,@15)                            0122
         SLR   @14,@14                                             0122
         IC    @14,MSG2BEGL(,@15)                                  0122
         LR    @09,@14                                             0122
         SLR   @09,@10                                             0122
         EX    @09,@SM00476                                        0122
*   GMTEXT(MSG2BEGL+1)=' ';         /* INSERT BLANK BEFORE USERIDS   */
         LA    @02,GMTEXT(@14)                                     0123
         MVI   0(@02),C' '                                         0123
*   M=M+MSG2BEGL+1;                 /* BUMP INDEX PAST MSG2 BEGINNING*/
         LA    @02,1                                               0124
         ALR   @10,@14                                             0124
         ALR   @10,@02                                             0124
         STC   @10,M                                               0124
*   DO J=1 TO IDCNT;                /* SCAN ENTIRE USRIDTAB          */
         B     @DE00125                                            0125
@DL00125 DS    0H                                                  0126
*     IF IDUSRID(J)^=BLNKID         /* CHECK FOR NON-BLANK ENTRY   0126
*                                                              Y02676*/
*       THEN                                                       0126
         SLA   @02,3                                               0126
         ST    @02,@TF00001                                        0126
         ALR   @02,COMPTR                                          0126
         CLC   IDUSRID-8(8,@02),BLNKID                             0126
         BE    @RF00126                                            0126
*       DO;                         /* MOVE USERID ENTRY TO MSG TEXT */
*         GMTEXT(M:M+6)=IDUSRID(J); /* MOVE USERID FROM USRIDTAB TO
*                                      MSG2 TEXT                     */
         SLR   @10,@10                                             0128
         IC    @10,M                                               0128
         LA    @02,GMTEXT-1(@10)                                   0128
         LR    @01,COMPTR                                          0128
         AL    @01,@TF00001                                        0128
         MVC   0(7,@02),IDUSRID-8(@01)                             0128
*         GMTEXT(M+7)=' ';          /* INSERT BLANK BETWEEN USERIDS  */
         LA    @02,GMTEXT+6(@10)                                   0129
         MVI   0(@02),C' '                                         0129
*         M=M+8;                    /* BUMP INDEX TO MSG TEXT        */
         AH    @10,@CH00042                                        0130
         STC   @10,M                                               0130
*       END;                                                       0131
*   END;                                                           0132
@RF00126 LA    @02,1                                               0132
         MVC   @ZT00003+3(1),J                                     0132
         AL    @02,@ZT00003                                        0132
@DE00125 STC   @02,J                                               0132
         MVC   @ZT00003+3(1),IDCNT(COMPTR)                         0132
         C     @02,@ZT00003                                        0132
         BNH   @DL00125                                            0132
*   GMTEXT(M:M+MSG2ENDL)=MSG2END;   /* SET MSG2 END TEXT             */
         SLR   @10,@10                                             0133
         IC    @10,M                                               0133
         LA    @02,GMTEXT-1(@10)                                   0133
         L     @15,@CA00171                                        0133
         L     @15,MSG2P-MSGTABLE(,@15)                            0133
         SLR   @14,@14                                             0133
         IC    @14,MSG2ENDL(,@15)                                  0133
         EX    @14,@SM00478                                        0133
*   M=M+MSG2ENDL;                   /* SET M TO END OF MSG2          */
         ALR   @10,@14                                             0134
         STC   @10,M                                               0134
*   GMNUM=MSG2WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0135
         MVI   GMNUM+8,C' '                                        0135
         MVC   GMNUM(7),MSG2WTN(@15)                               0135
*   GENLNG=M+WTNLNG-1;              /* SET LENGTH MSG TEXT + MSG ID  */
         MVC   @ZT00003+3(1),WTNLNG                                0136
         AL    @10,@ZT00003                                        0136
         BCTR  @10,0                                               0136
         STH   @10,GENLNG                                          0136
*   GOTO WARNMSG;                   /* GOTO GIVE WARNING MSG -     0137
*                                      'USERIDS ....... NOT LOGGED 0137
*                                      ON' AND END PROCESSING        */
         B     WARNMSG                                             0137
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*                                                                  */
*/*                SET UP MSG 'BROADCAST MSGNO = XXXX'               */
*/*                                                                  */
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0138
*MSG8OUT:                           /* GIVE CONFIRMATION MSG       0138
*                                      SPECIFYING THE BROADCAST MSGNO
*                                      OF MSG JUST ADDED TO NOTICES
*                                      SECTION WITH 'SEND' MSG TEXT  */
*   FMSG8='0'B;                     /* TURN OFF MSG 8 FLAG           */
MSG8OUT  NI    FMSG8(COMPTR),B'11111011'                           0138
*   GMTEXT(1:MSG8LNG)=MSG8TEXT;     /* SET MSG TEXT                  */
         L     @10,@CA00171                                        0139
         L     @10,MSG8P-MSGTABLE(,@10)                            0139
         SLR   @02,@02                                             0139
         IC    @02,MSG8LNG(,@10)                                   0139
         BCTR  @02,0                                               0139
         EX    @02,@SM00481                                        0139
*   RESTRICT(R5);                   /* RESTRICT REG 5 FOR 'GEN' USE  */
*   R5=CBCMSGNO;                    /* PUT BC MSG NO. INTO REGISTER  */
         LH    R5,CBCMSGNO(,COMPTR)                                0141
*   GEN;                                                           0142
          CVD   R5,WORK8            CONVERT BC MSG NO. TO DECIMAL
          UNPK  WORK4(4),WORK8+4(4) UNPACK INTO EBCDIC FORM
          MVZ   WORK4+3,WORK4+2     SIGN BYTE PRINTABLE
*   RELEASE(R5);                    /* RELEASE REG 5 FOR COMPILER USE*/
*   MSG8INS=WORK4;                  /* PUT BC MSGNO INTO MSG TEXT    */
         MVC   MSG8INS(4),WORK4                                    0144
*   GMNUM=MSG8WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0145
         MVI   GMNUM+8,C' '                                        0145
         L     @10,@CA00171                                        0145
         L     @10,MSG8P-MSGTABLE(,@10)                            0145
         MVC   GMNUM(7),MSG8WTN(@10)                               0145
*   GENLNG=MSG8LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         SLR   @02,@02                                             0146
         IC    @02,MSG8LNG(,@10)                                   0146
         MVC   @ZT00003+3(1),WTNLNG                                0146
         AL    @02,@ZT00003                                        0146
         STH   @02,GENLNG                                          0146
*   GOTO WARNMSG;                   /* ISSUE CONFIRMATION MSG GIVING
*                                      BROADCAST MSGNO OF MSG JUST 0147
*                                      ADDED TO NOTICES SECTION      */
         B     WARNMSG                                             0147
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*                                                                  */
*/*      SET UP MSG  'MESSAGE TEXT TRUNCATED TO 115 CHARACTERS'      */
*/*                                                                  */
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0148
*MSGAOUT:                           /* ISSUE 'MSG TEXT TRUNCATED'  0148
*                                      MESSAGE                       */
*   FMSGA='0'B;                     /* TURN OFF MSGA FLAG            */
MSGAOUT  NI    FMSGA(COMPTR),B'11111110'                           0148
*   GENLNG=MSGALNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         L     @10,@CA00171                                        0149
         L     @10,MSGAP-MSGTABLE(,@10)                            0149
         SLR   @02,@02                                             0149
         IC    @02,MSGALNG(,@10)                                   0149
         SLR   @15,@15                                             0149
         IC    @15,WTNLNG                                          0149
         ALR   @15,@02                                             0149
         STH   @15,GENLNG                                          0149
*   GMTEXT(1:MSGALNG)=MSGATEXT;     /* SET MSG TEXT                  */
         BCTR  @02,0                                               0150
         EX    @02,@SM00484                                        0150
*   GMNUM=MSGAWTN;                  /* SET MSG ID FOR CONSOLE WTO    */
         MVI   GMNUM+7,C' '                                        0151
         MVI   GMNUM+8,C' '                                        0151
         MVC   GMNUM(7),MSGAWTN(@10)                               0151
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG TO SENDER   */
         B     WARNMSG                                             0152
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*                                                                  */
*/*      SET UP MSG 'NO SPACE IN BROADCAST DATA SET FOR NOTICES'     */
*/*                                                     MAIL   '     */
*/*                                                                  */
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0153
*ERR4:                              /* SET UP WARNING MESSAGE - NO 0153
*                                      SPACE IN BROADCAST DATA SET 0153
*                                      FOR NOTICES / MAIL            */
*   FMSG4='0'B;                     /* TURN OFF MSG 4 FLAG           */
ERR4     NI    FMSG4(COMPTR),B'11011111'                           0153
*   GMNUM=MSG4WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0154
         MVI   GMNUM+8,C' '                                        0154
         L     @10,@CA00171                                        0154
         L     @10,MSG4P-MSGTABLE(,@10)                            0154
         MVC   GMNUM(7),MSG4WTN(@10)                               0154
*   GENLNG=MSG4LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         SLR   @02,@02                                             0155
         IC    @02,MSG4LNG(,@10)                                   0155
         MVC   @ZT00003+3(1),WTNLNG                                0155
         AL    @02,@ZT00003                                        0155
         STH   @02,GENLNG                                          0155
*   GMTEXT=MSG4TEXT;                /* SET MESSAGE TEXT              */
         MVI   GMTEXT+35,C' '                                      0156
         MVC   GMTEXT+36(173),GMTEXT+35                            0156
         MVC   GMTEXT(35),MSG4TEXT(@10)                            0156
*   IF FMAILFL='1'B                 /* CHK RETCODE FOR WRITE'DA' ERR */
*     THEN                          /* USER MAIL SECTION IS FULL     */
*                                                                  0157
         TM    FMAILFL(COMPTR),B'00000010'                         0157
         BNO   @RF00157                                            0157
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT 'MAIL' IN WARNING MSG                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0158
*     GMTEXT(MSG4SECT:MSG4SECT+8)=MSG4MAIL;                        0158
         SLR   @02,@02                                             0158
         IC    @02,MSG4SECT(,@10)                                  0158
         LA    @01,GMTEXT-1(@02)                                   0158
         MVI   5(@01),C' '                                         0158
         MVC   6(3,@01),5(@01)                                     0158
         MVC   0(5,@01),MSG4MAIL(@10)                              0158
*   ELSE                            /* BROADCAST NOTICES SECTION FULL*/
*                                                                  0159
*     /***************************************************************/
*     /*                                                             */
*     /* INSERT 'NOTICES' IN WARNING MSG                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0159
*     GMTEXT(MSG4SECT:MSG4SECT+8)=MSG4NOTI;                        0159
         B     @RC00157                                            0159
@RF00157 L     @10,@CA00171                                        0159
         L     @10,MSG4P-MSGTABLE(,@10)                            0159
         SLR   @02,@02                                             0159
         IC    @02,MSG4SECT(,@10)                                  0159
         LA    @01,GMTEXT-1(@02)                                   0159
         MVI   8(@01),C' '                                         0159
         MVC   0(8,@01),MSG4NOTI(@10)                              0159
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE TO SENDER*/
         B     WARNMSG                                             0160
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*/*                                                                  */
*/*                SET UP MSG 'NO BROADCAST MESSAGE'                 */
*/*                                                                  */
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **/
*                                                                  0161
*WMSG6:                             /* SET UP WARNING MESSAGE - NO 0161
*                                      BROADCAST MESSAGES            */
*   FMSG6='0'B;                     /* TURN OFF MSG 6 FLAG           */
WMSG6    NI    FMSG6(COMPTR),B'11110111'                           0161
*   GMNUM=MSG6WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0162
         MVI   GMNUM+8,C' '                                        0162
         L     @10,@CA00171                                        0162
         L     @10,MSG6P-MSGTABLE(,@10)                            0162
         MVC   GMNUM(7),MSG6WTN(@10)                               0162
*   GMTEXT(1:MSG6LNG)=MSG6TEXT;     /* SET MSG TEXT                  */
         SLR   @02,@02                                             0163
         IC    @02,MSG6LNG(,@10)                                   0163
         LR    @15,@02                                             0163
         BCTR  @15,0                                               0163
         EX    @15,@SM00487                                        0163
*   GENLNG=MSG6LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         MVC   @ZT00003+3(1),WTNLNG                                0164
         AL    @02,@ZT00003                                        0164
         STH   @02,GENLNG                                          0164
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE TO SENDER*/
*                                                                  0165
         B     WARNMSG                                             0165
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE 'SYNTAX ERROR' MESSAGE TO SENDER.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0166
*ERRSYN:                            /* SET UP SYNTAX ERROR MSG       */
*   FMSG3='0'B;                     /* TURN OFF MSG 3 FLAG           */
ERRSYN   NI    FMSG3(COMPTR),B'10111111'                           0166
*   GMNUM=MSG3WTN;                  /* SET UP MSG ID                 */
         MVI   GMNUM+7,C' '                                        0167
         MVI   GMNUM+8,C' '                                        0167
         L     @10,@CA00171                                        0167
         L     @10,MSG3P-MSGTABLE(,@10)                            0167
         MVC   GMNUM(7),MSG3WTN(@10)                               0167
*   GMTEXT(1:MSG3LNG)=MSG3TEXT;     /* SET MSG TEXT                  */
         SLR   @02,@02                                             0168
         IC    @02,MSG3LNG(,@10)                                   0168
         LR    @15,@02                                             0168
         BCTR  @15,0                                               0168
         EX    @15,@SM00489                                        0168
*   GENLNG=MSG3LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         MVC   @ZT00003+3(1),WTNLNG                                0169
         AL    @02,@ZT00003                                        0169
         STH   @02,GENLNG                                          0169
*   GOTO WARNMSG;                   /* ISSUE WARNING MSG AND END     */
         B     WARNMSG                                             0170
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*       SET UP MSG 'USERIDS AFTER 20TH IGNORED'                    */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0171
*MSGEOUT:                                                          0171
*   FOVER20='0'B;                   /* RESET ERROR MSG FLAG    Y02676*/
MSGEOUT  NI    FOVER20(COMPTR),B'11111101'                         0171
*   GMNUM=MSGEWTN;                  /* COPY MSG NUMBER         Y02676*/
         MVI   GMNUM+7,C' '                                        0172
         MVI   GMNUM+8,C' '                                        0172
         L     @10,@CA00171                                        0172
         L     @10,MSGEP-MSGTABLE(,@10)                            0172
         MVC   GMNUM(7),MSGEWTN(@10)                               0172
*   GENLNG=MSGELNG+WTNLNG;          /* CALC MSG LENGTH         Y02676*/
         SLR   @02,@02                                             0173
         IC    @02,MSGELNG(,@10)                                   0173
         MVC   @ZT00003+3(1),WTNLNG                                0173
         AL    @02,@ZT00003                                        0173
         STH   @02,GENLNG                                          0173
*   GMTEXT=MSGETEXT;                /* COPY MESSAGE TEXT       Y02676*/
         MVI   GMTEXT+1,C' '                                       0174
         MVC   GMTEXT+2(207),GMTEXT+1                              0174
         MVC   GMTEXT(1),MSGETEXT(@10)                             0174
*   GOTO WARNMSG;                   /* ISSUE ERROR MSG         Y02676*/
         B     WARNMSG                                             0175
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*               SET UP MSG 'BROADCAST DATA SET NOT USABLE,         */
*/*                       CANNOT OPEN DATA SET                       */
*/*                          I/O SYNAD ERROR                         */
*/*                        INSTALLATION MUST REFORMAT'               */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0176
*BADRITA:                           /* 'WRITE IN FREE SPACE' NOT   0176
*                                      SUCCESSFUL                    */
*   FBADRITA='0'B;                  /* TURN OFF BAD WRITE FLAG       */
BADRITA  NI    FBADRITA(COMPTR),B'11111101'                        0176
*   RETC=SDIORC;                    /* SET RETURN CODE FROM COMMON   */
         SLR   @10,@10                                             0177
         IC    @10,SDIORC(,COMPTR)                                 0177
         ST    @10,RETC                                            0177
*   IF RETC=DSFULL                  /* TEST RETCODE FOR DATA SET FULL*/
*     THEN                                                         0178
         MVC   @ZT00003+3(1),DSFULL                                0178
         C     @10,@ZT00003                                        0178
         BNE   @RF00178                                            0178
*     DO;                                                          0179
*       FMAILFL='1'B;               /* SET FLAG FOR MAIL SECTION FULL*/
         OI    FMAILFL(COMPTR),B'00000010'                         0180
*       GOTO ERR4;                  /* GIVE WARNING MESSAGE - NO   0181
*                                      SPACE IN BROADCAST DATA SET 0181
*                                      FOR MAIL                      */
         B     ERR4                                                0181
*     END;                                                         0182
*BADIO:                             /* TEST RETURN CODE FROM IO RTN  */
*   RETC=SDIORC;                    /* SET RC FROM COMMON      YM4914*/
@RF00178 DS    0H                                                  0183
BADIO    SLR   @10,@10                                             0183
         IC    @10,SDIORC(,COMPTR)                                 0183
         ST    @10,RETC                                            0183
*   FBADIO='0'B;                    /* TURN OFF FLAG FOR BAD IO      */
         NI    FBADIO(COMPTR),B'11111011'                          0184
*NOTUSABL:                          /* SET UP WARNING MESSAGE -    0185
*                                      BROADCAST DATE SET NOT USABLE */
*   FMSG5='0'B;                     /* TURN OFF MSG 5 FLAG           */
NOTUSABL NI    FMSG5(COMPTR),B'11101111'                           0185
*   IF RETC=OPENERR                 /* OPEN ERROR              Y02676*/
*     THEN                          /* YES, USE MSG10          Y02676*/
         L     @10,RETC                                            0186
         MVC   @ZT00003+3(1),OPENERR                               0186
         C     @10,@ZT00003                                        0186
         BNE   @RF00186                                            0186
*     DO;                                                          0187
*       GMNUM=MSG10WTN;             /* SET MSG NUMBER          Y02676*/
         MVI   GMNUM+7,C' '                                        0188
         MVI   GMNUM+8,C' '                                        0188
         L     @10,@CA00171                                        0188
         L     @10,MSG10P-MSGTABLE(,@10)                           0188
         MVC   GMNUM(7),MSG10WTN(@10)                              0188
*       GMTEXT(1:MSG10LNG)=MSG10TXT;/* COPY TEXT               Y02676*/
         SLR   @02,@02                                             0189
         IC    @02,MSG10LNG(,@10)                                  0189
         LR    @15,@02                                             0189
         BCTR  @15,0                                               0189
         EX    @15,@SM00494                                        0189
*       GENLNG=MSG10LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/
         MVC   @ZT00003+3(1),WTNLNG                                0190
         AL    @02,@ZT00003                                        0190
         STH   @02,GENLNG                                          0190
*       GOTO WARNMSG;               /* ISSUE ERROR MESSAGE     Y02676*/
         B     WARNMSG                                             0191
*     END;                                                         0192
*   IF RETC=IOERR                   /* I/O ERROR               Y02676*/
*     THEN                          /* YES, USE MSG11          Y02676*/
@RF00186 L     @10,RETC                                            0193
         MVC   @ZT00003+3(1),IOERR                                 0193
         C     @10,@ZT00003                                        0193
         BNE   @RF00193                                            0193
*     DO;                           /*                         Y02676*/
*       GMNUM=MSG11WTN;             /* COPY MSG NUMBER         Y02676*/
         MVI   GMNUM+7,C' '                                        0195
         MVI   GMNUM+8,C' '                                        0195
         L     @10,@CA00171                                        0195
         L     @10,MSG11P-MSGTABLE(,@10)                           0195
         MVC   GMNUM(7),MSG11WTN(@10)                              0195
*       GMTEXT(1:MSG11LNG)=MSG11TXT;/* COPY TEXT               Y02676*/
         SLR   @02,@02                                             0196
         IC    @02,MSG11LNG(,@10)                                  0196
         LR    @15,@02                                             0196
         BCTR  @15,0                                               0196
         EX    @15,@SM00496                                        0196
*       GENLNG=MSG11LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/
         MVC   @ZT00003+3(1),WTNLNG                                0197
         AL    @02,@ZT00003                                        0197
         STH   @02,GENLNG                                          0197
*       GOTO WARNMSG;               /* ISSUE ERROR MSG         Y02676*/
         B     WARNMSG                                             0198
*     END;                                                         0199
*   IF RETC=BADFMT                  /* BAD FORMAT              Y02676*/
*     THEN                          /* YES, USE MSG12          Y02676*/
@RF00193 L     @10,RETC                                            0200
         MVC   @ZT00003+3(1),BADFMT                                0200
         C     @10,@ZT00003                                        0200
         BNE   @RF00200                                            0200
*     DO;                                                          0201
*       GMNUM=MSG12WTN;             /* COPY MSG NUMBER         Y02676*/
         MVI   GMNUM+7,C' '                                        0202
         MVI   GMNUM+8,C' '                                        0202
         L     @10,@CA00171                                        0202
         L     @10,MSG12P-MSGTABLE(,@10)                           0202
         MVC   GMNUM(7),MSG12WTN(@10)                              0202
*       GMTEXT(1:MSG12LNG)=MSG12TXT;/* COPY TEXT               Y02676*/
         SLR   @02,@02                                             0203
         IC    @02,MSG12LNG(,@10)                                  0203
         LR    @15,@02                                             0203
         BCTR  @15,0                                               0203
         EX    @15,@SM00498                                        0203
*       GENLNG=MSG12LNG+WTNLNG;     /* SET MSG LENGTH          Y02676*/
         MVC   @ZT00003+3(1),WTNLNG                                0204
         AL    @02,@ZT00003                                        0204
         STH   @02,GENLNG                                          0204
*       GOTO WARNMSG;               /* ISSUE ERROR MSG         Y02676*/
         B     WARNMSG                                             0205
*     END;                                                         0206
*   ELSE                            /* SEND CANNOT EXECUTE     Y02676*/
*     GOTO BADSEND;                 /* ISSUE ERROR MESSAGE     Y02676*/
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*/*                                                                  */
*/*               SET UP MSG 'SEND CANNOT EXECUTE'                   */
*/*                                                                  */
*/*  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
*                                                                  0208
*BADTPUT:                                                          0208
*   IF RETC='08'X×RETC='0C'X        /* TERMINAL SENDER HIT ATTN OR IS
*                                      IN NO INTERCOM          Y02676*/
*     THEN                          /* YES, NOT REAL ERROR     Y02676*/
BADTPUT  L     @10,RETC                                            0208
         CH    @10,@CH00278                                        0208
         BE    @RT00208                                            0208
         CH    @10,@CH00451                                        0208
         BE    @RT00208                                            0208
*     GOTO EXITCODE;                /* IGNORE ERROR            Y02676*/
*BADTPUT1:                                                         0210
*   FBADTPUT='0'B;                  /* TURN OFF BAD TPUT FLAG        */
BADTPUT1 NI    FBADTPUT(COMPTR),B'11111110'                        0210
*BADSEND:                           /* SET UP MESSAGE 'SEND CANNOT 0211
*                                      EXECUTE'                      */
*   IF FBADSEND='1'B                /* TEST IF PREVIOUS SEND ERROR   */
*     THEN                          /* YES, TERMINATE FAST           */
BADSEND  TM    FBADSEND(COMPTR),B'00100000'                        0211
         BO    @RT00211                                            0211
*     GOTO EXIT3;                                                  0212
*   ELSE                                                           0213
*     FBADSEND='1'B;                /* SET FLAG FOR SEND ERROR       */
         OI    FBADSEND(COMPTR),B'00100000'                        0213
*   GMNUM=MSG9WTN;                  /* SET MSG ID                    */
         MVI   GMNUM+7,C' '                                        0214
         MVI   GMNUM+8,C' '                                        0214
         L     @10,@CA00171                                        0214
         L     @10,MSG9P-MSGTABLE(,@10)                            0214
         MVC   GMNUM(7),MSG9WTN(@10)                               0214
*   GMTEXT(1:MSG9LNG)=MSG9TEXT;     /* SET MSG TEXT                  */
         SLR   @02,@02                                             0215
         IC    @02,MSG9LNG(,@10)                                   0215
         LR    @15,@02                                             0215
         BCTR  @15,0                                               0215
         EX    @15,@SM00501                                        0215
*   GENLNG=MSG9LNG+WTNLNG;          /* SET LENGTH MSG TEXT + MSG ID  */
         MVC   @ZT00003+3(1),WTNLNG                                0216
         AL    @02,@ZT00003                                        0216
         STH   @02,GENLNG                                          0216
*   GOTO WARNMSG;                   /* GIVE WARNING MESSAGE THAT SEND
*                                      CANNOT EXECUTE                */
         B     WARNMSG                                             0217
*CHKSRC:                            /* CHECK CSCB TO LEARN IF SEND 0218
*                                      COM. CAME FROM CONSOLE OR   0218
*                                      TERMINAL IN OPERATOR MODE     */
*   IF CHASID=0                     /* TEST ASID FIELD FOR 0, Y02676
*                                      INDICATING SEND FROM CONSOLE  */
*     THEN                          /* SEND CAME FROM OPERATOR     0218
*                                      CONSOLE                       */
CHKSRC   L     @10,CSCBPTR-1(,COMPTR)                              0218
         LA    @10,0(,@10)                                         0218
         LH    @10,CHASID(,@10)                                    0218
         LTR   @10,@10                                             0218
         BNZ   @RF00218                                            0218
*     FCONSOL='1'B;                 /* SET FLAG FOR CONSOLE          */
         OI    FCONSOL(COMPTR),B'01000000'                         0219
*   ELSE                            /* SEND CAME FROM OPERATR      0220
*                                      TERMINAL                      */
*     FTERM='1'B;                   /* SET FLAG FOR TERMINAL         */
         B     @RC00218                                            0220
@RF00218 OI    FTERM(COMPTR),B'10000000'                           0220
*   GOTO SRCBK;                     /* CONTINUE                    0221
*                                                                    */
         B     SRCBK                                               0221
*WARNMSG:                           /* GIVE WARNING MSG TO ISSUER OF
*                                      'SEND'                        */
*   IF FSOURCE='00'B                /* HAS SOURCE OF SEND COMMAND  0222
*                                      BEEN DETERMINED               */
*     THEN                                                         0222
WARNMSG  TM    FSOURCE(COMPTR),B'11000000'                         0222
         BZ    @RT00222                                            0222
*     GOTO CHKSRC;                  /* GO TO FIND SOURCE OF SEND COM.*/
*SRCBK:                             /* SOURCE OF SEND CMD HAS BEEN 0224
*                                      FOUND                         */
*   IF FCONSOL='1'B                 /* CHECK IF SENDER WAS OP.CONSOLE*/
*     THEN                          /* CMD CAME FROM OPERATOR CONSOLE*/
SRCBK    TM    FCONSOL(COMPTR),B'01000000'                         0224
         BNO   @RF00224                                            0224
*     DO;                           /* SET UP FOR WTO                */
*       GMSAVE=GENTEXT;             /* SAVE MSG TEXT AND MSG ID      */
         MVC   GMSAVE(210),GENTEXT                                 0226
*       IF GENLNG>WTOMAX            /* IF WARN MSG LENGTH > 72       */
*         THEN                      /* YES, MSG LENGTH > 72          */
         SLR   @10,@10                                             0227
         IC    @10,WTOMAX                                          0227
         CH    @10,GENLNG                                          0227
         BNL   @RF00227                                            0227
*         WTOLNG=WTOMAX+4;          /* SET WTO PARMLIST LENG TO MAX  */
         AH    @10,@CH00135                                        0228
         STH   @10,WTOLNG                                          0228
*       ELSE                                                       0229
*         WTOLNG=GENLNG+4;          /* SET LENGTH OF WTO PARM LIST   */
         B     @RC00227                                            0229
@RF00227 LA    @10,4                                               0229
         AH    @10,GENLNG                                          0229
         STH   @10,WTOLNG                                          0229
*       GENTEXT(1:WTOLNG-4)=GMSAVE(1:WTOLNG-4);/* MOVE TEXT          */
@RC00227 LH    @10,WTOLNG                                          0230
         SH    @10,@CH00222                                        0230
         EX    @10,@SM00505                                        0230
*/*                                                                  */
*/*   THE FOLLOWING CODE COPIES FIELDS FROM THE STATIC WTO PARMLIST  */
*/*   TO THE DYNAMIC WTO LIST, 'WTOLIST'.  THIS CODE MUST CHANGE IF  */
*/*   THE LIST FORM EXPANSION OF THE WTO MACRO CHANGES.              */
*/*                                                                  */
*                                                                  0231
*       GEN( MVC WTOMCSFL(2),WTOL+2 );/* SET MCS FLAGS TO INDIC    0231
*                                      CONSOLE ID IN REG 0           */
          MVC WTOMCSFL(2),WTOL+2
*       RESTRICT(R5,R6);            /* RESTRICT COMPILER USE OF REGS */
*       R5=WTOLNG;                  /* R5 = 1 BYTE PAST MSG TEXT IN
*                                      WTO LIST BUFFER AREA          */
         LH    R5,WTOLNG                                           0233
*       R5=R5+ADDR(WTOLIST);        /* R5 = ADDR DESCRIPTOR CODE   0234
*                                      FIELD IN DYNAMIC WTO LIST     */
         LA    @10,WTOLIST                                         0234
         ALR   R5,@10                                              0234
*       R6=ADDR(WTOL)+5;            /* R6 = ADDR DESCRIPTOR CODE IN
*                                      STATIC WTO PARM LIST          */
         LA    R6,WTOL                                             0235
         AH    R6,@CH00222                                         0235
*       GEN( MVC 0(4,R5),0(R6) );   /* MOVE DESCRIPTOR CODES AND   0236
*                                      ROUTING CODES AFTER THE MSG 0236
*                                      TEXT IN WTO LIST              */
          MVC 0(4,R5),0(R6)
*       RELEASE(R5,R6);             /* RELEASE COMPILER USE OF REGS  */
*       R1=ADDR(WTOLIST);           /* SET REG1 = ADDR WTO PARMLIST  */
         LA    R1,WTOLIST                                          0238
*       R0=CHUCMP;                  /* PUT CONSOLE ID INTO REG 0 FOR
*                                      WTO TO CONSOLE ISSUING 'SEND' */
         L     @10,CSCBPTR-1(,COMPTR)                              0239
         LA    @10,0(,@10)                                         0239
         SLR   R0,R0                                               0239
         IC    R0,CHUCMP(,@10)                                     0239
*       GEN(WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER    );         0240
         WTO   ,MF=(E,(1))    ISSUE WTO TO SENDER
*       GMBEG=WTOMAX+1;             /* SET BEGINNING FOR NEXT WTO    */
         LA    @10,1                                               0241
         SLR   @02,@02                                             0241
         IC    @02,WTOMAX                                          0241
         ALR   @02,@10                                             0241
         STC   @02,GMBEG                                           0241
*       WTOCNT=(GENLNG-9)/WTOMAX2;  /* COUNT OF WTO'S NEEDED         */
         SLR   @02,@02                                             0242
         IC    @02,WTOMAX2                                         0242
         LH    @15,GENLNG                                          0242
         SH    @15,@CH00149                                        0242
         LR    @00,@15                                             0242
         SRDA  @00,32                                              0242
         DR    @00,@02                                             0242
         STC   @01,WTOCNT                                          0242
*       WTOREM=(GENLNG-9)//WTOMAX2; /* WTOREM = REMAINDER            */
         LR    @04,@15                                             0243
         SRDA  @04,32                                              0243
         DR    @04,@02                                             0243
         STC   @04,WTOREM                                          0243
*       IF WTOREM^=0                /* TEST IF REMAINDER IS NONZERO  */
*         THEN                      /* YES, THERE IS A REMAINDER     */
         CLI   WTOREM,0                                            0244
         BE    @RF00244                                            0244
*         WTOCNT=WTOCNT+1;          /* ADD 1 TO CNT OF WTO'S NEEDED  */
         ALR   @01,@10                                             0245
         STC   @01,WTOCNT                                          0245
*WTOLOOP2:                          /* ISSUE ANOTHER WTO             */
*       WTOCNT=WTOCNT-1;            /* DECREMENT CNT OF WTO'S NEEDED */
@RF00244 DS    0H                                                  0246
WTOLOOP2 SLR   @10,@10                                             0246
         IC    @10,WTOCNT                                          0246
         BCTR  @10,0                                               0246
         STC   @10,WTOCNT                                          0246
*       IF WTOCNT=0                 /* HAVE ALL WTO'S BEEN ISSUED    */
*         THEN                      /* YES, ENTIRE MSG IS PUT OUT    */
         CLI   WTOCNT,0                                            0247
         BE    @RT00247                                            0247
*         GOTO ROUTER;              /* GOTO ROUTE CONTROL            */
*       ELSE                                                       0249
*         ;                         /* ISSUE ANOTHER WTO             */
*       IF GENLNG>GMBEG+WTOMAX2     /* IS MSG LENGTH MORE THAN CAN BE
*                                      PUT OUT IN 1 MORE WTO         */
*         THEN                      /* YES, 2 MORE WTO'S NEEDED      */
         SLR   @10,@10                                             0250
         IC    @10,WTOMAX2                                         0250
         SLR   @02,@02                                             0250
         IC    @02,GMBEG                                           0250
         ALR   @02,@10                                             0250
         CH    @02,GENLNG                                          0250
         BNL   @RF00250                                            0250
*         GMEND=WTOMAX2;            /* SET END OF WTO MSG TO MAX     */
         STC   @10,GMEND                                           0251
*       ELSE                        /* NO, 1 MORE WTO WILL DO IT     */
*         GMEND=GENLNG-GMBEG+1;     /* SET END OF MSG TO REMAINDER   */
*                                                                  0252
         B     @RC00250                                            0252
@RF00250 LH    @10,GENLNG                                          0252
         MVC   @ZT00003+3(1),GMBEG                                 0252
         SL    @10,@ZT00003                                        0252
         AH    @10,@CH00047                                        0252
         STC   @10,GMEND                                           0252
*       /*************************************************************/
*       /*                                                           */
*       /* PUT MSG INTO WTO PARMLIST                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0253
*       GMTEXT(1:GMEND)=GMSAVE(GMBEG:GMBEG+GMEND-1);               0253
@RC00250 SLR   @10,@10                                             0253
         IC    @10,GMEND                                           0253
         LR    @02,@10                                             0253
         BCTR  @02,0                                               0253
         SLR   @01,@01                                             0253
         IC    @01,GMBEG                                           0253
         LA    @15,GMSAVE-1(@01)                                   0253
         EX    @02,@SM00507                                        0253
*       WTOLNG=GMEND+4+9;           /* SET WTO PARMLIST LENGTH       */
         AH    @10,@CH00466                                        0254
         STH   @10,WTOLNG                                          0254
*/*                                                                  */
*/*   THE FOLLOWING CODE COPIES FIELDS FROM THE STATIC WTO PARMLIST  */
*/*   TO THE DYNAMIC WTO LIST, 'WTOLIST'.  THIS CODE MUST CHANGE IF  */
*/*   THE LIST FORM EXPANSION OF THE WTO MACRO CHANGES.              */
*/*                                                                  */
*                                                                  0255
*       GEN( MVC WTOMCSFL(2),WTOL+2 );/* SET MCS FLAGS TO SAY CONSOLE
*                                      ID IN REG 0                   */
          MVC WTOMCSFL(2),WTOL+2
*       RESTRICT(R5,R6);            /* RESTRICT COMPILER USE OF REGS */
*       R5=WTOLNG;                  /* R5 = 1 BYTE PAST MSG TEXT IN
*                                      WTO LIST BUFFER AREA          */
         LH    R5,WTOLNG                                           0257
*       R5=R5+ADDR(WTOLIST);        /* R5 = ADDR DESCRIPTOR CODE   0258
*                                      FIELD IN DYNAMIC WTO LIST     */
         LA    @10,WTOLIST                                         0258
         ALR   R5,@10                                              0258
*       R6=ADDR(WTOL)+5;            /* R6 = ADDR DESCRIPTOR CODE IN
*                                      STATIC WTO PARM LIST          */
         LA    R6,WTOL                                             0259
         AH    R6,@CH00222                                         0259
*       GEN( MVC 0(4,R5),0(R6) );   /* MOVE DESCRIPTOR CODES AND   0260
*                                      ROUTING CODES AFTER THE MSG 0260
*                                      TEXT IN WTO LIST              */
          MVC 0(4,R5),0(R6)
*       RELEASE(R5,R6);             /* RELEASE COMPILER USE OF REGS  */
*       R1=ADDR(WTOLIST);           /* SET REG1 = ADDR WTO PARMLIST  */
         LA    R1,WTOLIST                                          0262
*       R0=CHUCMP;                  /* PUT CONSOLE ID INTO REG 0 FOR
*                                      WTO TO CONSOLE ISSUING 'SEND' */
         L     @10,CSCBPTR-1(,COMPTR)                              0263
         LA    @10,0(,@10)                                         0263
         SLR   R0,R0                                               0263
         IC    R0,CHUCMP(,@10)                                     0263
*       GEN;                                                       0264
              WTO   ,MF=(E,(1))          ISSUE WTO TO SENDER
*       GMBEG=GMBEG+GMEND;          /* BUMP GMBEG FOR NEXT WTO       */
         SLR   @10,@10                                             0265
         IC    @10,GMBEG                                           0265
         MVC   @ZT00003+3(1),GMEND                                 0265
         AL    @10,@ZT00003                                        0265
         STC   @10,GMBEG                                           0265
*       GOTO WTOLOOP2;              /* CHECK IF ANOTHER WTO NEEDED   */
         B     WTOLOOP2                                            0266
*     END;                                                         0267
*   ELSE                            /* SOURCE OF SEND IS A TERMINAL  */
*     DO;                           /* SET UP FOR TPUT               */
@RF00224 DS    0H                                                  0269
*       RECTJID=CHASID;             /* SET ASID IN HI Y02676 ORDER 0269
*                                      HALF OF REG 0 FOR TPUT        */
         L     @10,CSCBPTR-1(,COMPTR)                              0269
         LA    @10,0(,@10)                                         0269
         MVC   RECTJID(2),CHASID(@10)                              0269
*       R1=ADDR(GENTEXT);           /* REG1 = MSGTEXT ADDR FOR TPUT  */
         LA    R1,GENTEXT                                          0270
*       R0=TPUTREG0;                /* REG0 = ASID - HI ORDER AND  0271
*                                      BUFFER SIZE - LO ORDER        */
         L     R0,TPUTREG0                                         0271
*       GEN;                                                       0272
                TPUT  (1),(0),R     ISSUE TPUT TO OPERATOR TERMINAL
*       RETC=R15;                   /* SAVE RETURN CODE FROM TPUT    */
         ST    R15,RETC                                            0273
*       IF RETC^=0                  /* CHECK RETURN CODE FROM TPUT   */
*         THEN                      /* IF UNSUCCESSFUL TPUT          */
         L     @10,RETC                                            0274
         LTR   @10,@10                                             0274
         BNZ   @RT00274                                            0274
*         GOTO BADTPUT;             /* ANALYZE ERROR CONDITION       */
*     END;                                                         0276
*ROUTER:                            /* ROUTE CONTROL TO PROPER RTN   */
*   GOTO EXITCODE;                  /* END PROCESSING              0277
*                                                                    */
         B     EXITCODE                                            0277
*   GEN;                                                           0278
LISTBEG   DS    0F                     BEGINNING OF LIST FORMS
*  THE FOLLOWING WTO LIST FORM MUST NOT CHANGE WITHOUT CHANGING THE
*  CODE THAT MOVES THESE FIELDS INTO THE DYNAMIC 'WTOLIST' AREA
WTOL     WTO  'M',MF=L,DESC=5,MCSFLAG=(REG0)
LISTEND  EQU   *                       END OF LIST FORMS
SPARE    DC    50X'00'              PATCH AREA
*   END IEEVSND4                                                   0279
*                                                                  0279
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */
*                                                                  0279
*       ;                                                          0279
         B     @EL00001                                            0279
@DATA    DS    0H
@CH00047 DC    H'1'
@CH00135 DC    H'4'
@CH00222 DC    H'5'
@CH00118 DC    H'7'
@CH00042 DC    H'8'
@CH00149 DC    H'9'
@CH00466 DC    H'13'
@CH00278 DC    XL2'08'
@CH00451 DC    XL2'0C'
@SM00468 MVC   GMTEXT(0),MSGFTEXT(@10)
@SM00470 MVC   0(0,@01),MSG1EXT(COMPTR)
@SM00473 MVC   GMTEXT(0),MSG1TEXT(@10)
@SM00476 MVC   0(0,@02),MSG2BEG(@15)
@SM00478 MVC   0(0,@02),MSG2END(@15)
@SM00481 MVC   GMTEXT(0),MSG8TEXT(@10)
@SM00484 MVC   GMTEXT(0),MSGATEXT(@10)
@SM00487 MVC   GMTEXT(0),MSG6TEXT(@10)
@SM00489 MVC   GMTEXT(0),MSG3TEXT(@10)
@SM00494 MVC   GMTEXT(0),MSG10TXT(@10)
@SM00496 MVC   GMTEXT(0),MSG11TXT(@10)
@SM00498 MVC   GMTEXT(0),MSG12TXT(@10)
@SM00501 MVC   GMTEXT(0),MSG9TEXT(@10)
@SM00505 MVC   GENTEXT(0),GMSAVE
@SM00507 MVC   GMTEXT(0),0(@15)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SAV001  EQU   @SA00001
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
@TEMPS   EQU   @ZTEMPS
@L       EQU   @ZLEN
IEEVSND4 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
TPUTREG0 DS    FL4
         ORG   TPUTREG0
RECTJID  DS    FL2
GENLNG   DS    FL2
         ORG   TPUTREG0+4
RETC     DS    A
WTOCNT   DS    AL1
WTOREM   DS    AL1
GMBEG    DS    AL1
GMEND    DS    AL1
J        DS    AL1
K        DS    AL1
M        DS    AL1
         DS    CL1
WTOLIST  DS    CL223
         ORG   WTOLIST
WTOLNG   DS    FL2
WTOMCS   DS    FL2
         ORG   WTOMCS
WTOMCSFL DS    BL1
         ORG   WTOLIST+4
GENTEXT  DS    CL219
         ORG   GENTEXT
GMNUM    DS    CL9
GMTEXT   DS    CL209
         ORG   WTOLIST+223
GMSAVE   DS    CL210
         DS    CL3
WORK4    DS    CL4
WORK8    DS    CL8
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
@DATEND  EQU   *
IEEVSND4 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@SIZ001  EQU   @SIZDATD
@CA00171 DC    A(MSGTABLE)
         DS    0D
WTOMAX   DC    AL1(72)
WTOMAX2  DC    AL1(63)
WTNLNG   DC    AL1(9)
WTODESC  DC    X'08000000'
BLNKID   DC    CL8'        '
SDERR    DC    X'80'
NOCORE   DC    X'40'
BADFMT   DC    X'10'
IOERR    DC    X'08'
OPENERR  DC    X'02'
DSFULL   DC    X'01'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
@0       EQU   00
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
COMPTR   EQU   @03
R0       EQU   @00
R1       EQU   @01
R5       EQU   @05
R6       EQU   @06
R15      EQU   @15
         EXTRN MSGTABLE
COMMON   EQU   0
COMMONA  EQU   COMMON
MSGFLAGS EQU   COMMONA+3
FMSG2    EQU   MSGFLAGS
FMSG3    EQU   MSGFLAGS
FMSG4    EQU   MSGFLAGS
FMSG5    EQU   MSGFLAGS
FMSG6    EQU   MSGFLAGS
FMSG8    EQU   MSGFLAGS
FMSGA    EQU   MSGFLAGS
FLAGS    EQU   COMMONA+4
FANYINV  EQU   FLAGS
FBADSEND EQU   FLAGS
FOVER20  EQU   FLAGS
@NM00002 EQU   FLAGS+1
FMAILFL  EQU   @NM00002
@NM00003 EQU   FLAGS+2
@NM00004 EQU   FLAGS+3
FSOURCE  EQU   @NM00004
FTERM    EQU   FSOURCE
FCONSOL  EQU   FSOURCE
FMSG1    EQU   @NM00004
FBADIO   EQU   @NM00004
FBADRITA EQU   @NM00004
FBADTPUT EQU   @NM00004
M1IND    EQU   COMMONA+8
IDCNT    EQU   COMMONA+12
SDIORC   EQU   COMMONA+16
CSCBPTR  EQU   COMMONA+21
CBCMSGNO EQU   COMMONA+32
MSG1EXT  EQU   COMMONA+36
COMMONB  EQU   COMMON+160
COMMONC  EQU   COMMON+284
IDUSRID  EQU   COMMONC
SDIOPARM EQU   COMMON+452
@NM00006 EQU   SDIOPARM
@NM00007 EQU   SDIOPARM+1
MSG1     EQU   0
MSG1WTN  EQU   MSG1+9
MSG1LNG  EQU   MSG1+20
MSG1TEXT EQU   MSG1+21
MSG2     EQU   0
MSG2WTN  EQU   MSG2+9
MSG2BEGL EQU   MSG2+16
MSG2BEG  EQU   MSG2+17
MSG2ENDL EQU   MSG2+25
MSG2END  EQU   MSG2+26
MSG3     EQU   0
MSG3WTN  EQU   MSG3+9
MSG3LNG  EQU   MSG3+16
MSG3TEXT EQU   MSG3+17
MSG4     EQU   0
MSG4WTN  EQU   MSG4+9
MSG4LNG  EQU   MSG4+16
MSG4TEXT EQU   MSG4+17
MSG4SECT EQU   MSG4+52
MSG4MAIL EQU   MSG4+53
MSG4NOTI EQU   MSG4+58
MSGE     EQU   0
MSGEWTN  EQU   MSGE+9
MSGELNG  EQU   MSGE+16
MSGETEXT EQU   MSGE+17
MSGF     EQU   0
MSGFWTN  EQU   MSGF+9
MSGFLNG  EQU   MSGF+16
MSGFTEXT EQU   MSGF+17
MSG10    EQU   0
MSG10WTN EQU   MSG10+9
MSG10LNG EQU   MSG10+16
MSG10TXT EQU   MSG10+17
MSG11    EQU   0
MSG11WTN EQU   MSG11+9
MSG11LNG EQU   MSG11+16
MSG11TXT EQU   MSG11+17
MSG12    EQU   0
MSG12WTN EQU   MSG12+9
MSG12LNG EQU   MSG12+16
MSG12TXT EQU   MSG12+17
MSG6     EQU   0
MSG6WTN  EQU   MSG6+9
MSG6LNG  EQU   MSG6+16
MSG6TEXT EQU   MSG6+17
MSG8     EQU   0
MSG8WTN  EQU   MSG8+9
MSG8LNG  EQU   MSG8+16
MSG8TEXT EQU   MSG8+17
MSG9     EQU   0
MSG9WTN  EQU   MSG9+9
MSG9LNG  EQU   MSG9+16
MSG9TEXT EQU   MSG9+17
MSGA     EQU   0
MSGAWTN  EQU   MSGA+9
MSGALNG  EQU   MSGA+16
MSGATEXT EQU   MSGA+17
CHAIN    EQU   0
CHFLG    EQU   CHAIN+4
CHSTS    EQU   CHFLG+2
CHACT    EQU   CHFLG+3
CHKEY    EQU   CHAIN+8
CHPKE    EQU   CHAIN+28
CHUCMP   EQU   CHAIN+29
CHTJID   EQU   CHAIN+30
CHASID   EQU   CHTJID
CHACT1   EQU   CHAIN+35
CHASM    EQU   CHAIN+40
CHCIBP   EQU   CHASM+4
CHRGNSZ  EQU   CHASM+8
CHSHORT  EQU   CHASM+24
CHSWT    EQU   CHSHORT
COMMONPT EQU   0
MSG1P    EQU   MSGTABLE
MSG2P    EQU   MSGTABLE+4
MSG3P    EQU   MSGTABLE+8
MSG4P    EQU   MSGTABLE+12
MSG6P    EQU   MSGTABLE+20
MSG8P    EQU   MSGTABLE+28
MSG9P    EQU   MSGTABLE+32
MSGAP    EQU   MSGTABLE+36
MSGEP    EQU   MSGTABLE+52
MSGFP    EQU   MSGTABLE+56
MSG10P   EQU   MSGTABLE+60
MSG11P   EQU   MSGTABLE+64
MSG12P   EQU   MSGTABLE+68
MSG8INS  EQU   GMTEXT+18
CHAINS01 EQU   CHASM
CHTYPE   EQU   CHAINS01+124
CHTRSTAT EQU   CHAINS01+125
CHCSYSO  EQU   CHAINS01+134
MSG5P    EQU   MSGTABLE+16
*                                      START UNREFERENCED COMPONENTS
CHLAST   EQU   CHAINS01+136
CHSPA    EQU   CHAINS01+135
CHUSERID EQU   CHCSYSO
CHJB     EQU   CHCSYSO
CHDUMP   EQU   CHCSYSO
CHQUE    EQU   CHCSYSO
CHHOLD   EQU   CHCSYSO
CHOUT    EQU   CHCSYSO
CHINN    EQU   CHCSYSO
CHALL    EQU   CHCSYSO
CHINC    EQU   CHAINS01+132
CHPEND   EQU   CHAINS01+128
CHARID   EQU   CHAINS01+127
CHCNID   EQU   CHAINS01+126
@NM00026 EQU   CHTRSTAT
CHTSL    EQU   CHTRSTAT
CHTS     EQU   CHTRSTAT
CHINITL  EQU   CHTRSTAT
CHINIT   EQU   CHTRSTAT
CHJOBSL  EQU   CHTRSTAT
CHJOBS   EQU   CHTRSTAT
CHDEF    EQU   CHTYPE
CHHIAR   EQU   CHTYPE
CHARSV29 EQU   CHTYPE
CHARSV28 EQU   CHTYPE
CHARSV27 EQU   CHTYPE
CHARSV26 EQU   CHTYPE
CHARSV25 EQU   CHTYPE
CHDSTAT  EQU   CHTYPE
CHBUF    EQU   CHAINS01
CHARSV16 EQU   CHSHORT+108
CHARSV15 EQU   CHSHORT+104
CHJSCBVS EQU   CHSHORT+100
CHUSCVS  EQU   CHSHORT+96
@NM00025 EQU   CHSHORT+92
@NM00024 EQU   CHSHORT+88
CHSQA    EQU   CHSHORT+52
CHQPA    EQU   CHSHORT+16
CHJCL    EQU   CHSHORT+12
CHSPC    EQU   CHSHORT+8
CHSPB    EQU   CHSHORT+4
CHTCB    EQU   CHSHORT+1
CHARSV23 EQU   CHSWT
CHARSV22 EQU   CHSWT
CHARSV21 EQU   CHSWT
CHAC     EQU   CHSWT
CHPSF    EQU   CHSWT
CHPSD    EQU   CHSWT
CHJCT    EQU   CHSWT
CHARSV20 EQU   CHSWT
CHCECB   EQU   CHASM+20
CHECB    EQU   CHASM+16
CHRGNAD  EQU   CHASM+12
CHARSV18 EQU   CHRGNSZ+1
CHRPRTY  EQU   CHRGNSZ
@NM00023 EQU   CHCIBP
CHEND    EQU   CHCIBP
CHECBP   EQU   CHASM
CHDER    EQU   CHAIN+36
CHARSV10 EQU   CHACT1
CHARSV09 EQU   CHACT1
CHARSV08 EQU   CHACT1
CHARSV07 EQU   CHACT1
CHARSV06 EQU   CHACT1
CHARSV05 EQU   CHACT1
CHARSV04 EQU   CHACT1
CHRDWTR  EQU   CHACT1
CHARSV30 EQU   CHAIN+34
CHQID    EQU   CHAIN+32
CHTRKID  EQU   CHPKE
CHCIBCTR EQU   CHAIN+27
CHUNIT   EQU   CHAIN+24
CHCLS    EQU   CHAIN+16
CHPARM   EQU   CHKEY
CHIFY    EQU   CHACT
CHAIFX   EQU   CHACT
CHCLD    EQU   CHACT
CHCL     EQU   CHACT
CHDSI    EQU   CHACT
CHDISC   EQU   CHACT
CHTERM   EQU   CHACT
CHSWAP   EQU   CHACT
CHABTERM EQU   CHSTS
CHFC     EQU   CHSTS
CHDL     EQU   CHSTS
CHAD     EQU   CHSTS
CHQSPC   EQU   CHSTS
CHSOUT   EQU   CHSTS
CHSYS    EQU   CHSTS
CHAP     EQU   CHSTS
CHSZE    EQU   CHFLG+1
CHVCD    EQU   CHFLG
CHPTR    EQU   CHAIN
@NM00022 EQU   MSGA
@NM00021 EQU   MSG9
@NM00020 EQU   MSG8
@NM00019 EQU   MSG6
@NM00018 EQU   MSG12
@NM00017 EQU   MSG11
@NM00016 EQU   MSG10
@NM00015 EQU   MSGF
@NM00014 EQU   MSGE
@NM00013 EQU   MSG4+66
@NM00012 EQU   MSG4
@NM00011 EQU   MSG3
@NM00010 EQU   MSG2
@NM00009 EQU   MSG1+16
@NM00008 EQU   MSG1
PARMRCD1 EQU   COMMON+480
PARMDCB  EQU   COMMON+476
PARMLMCT EQU   COMMON+472
PARMDDNM EQU   SDIOPARM+12
PARMIOAD EQU   SDIOPARM+8
PARMRBA  EQU   SDIOPARM+4
PARMFDBK EQU   SDIOPARM+3
PARMKEY  EQU   SDIOPARM+2
P2DEVAD  EQU   @NM00007
P2DEL    EQU   @NM00007
P2CLOSE  EQU   @NM00007
P2WRDAF  EQU   @NM00007
P2WRDI   EQU   @NM00007
P1READ1  EQU   @NM00006
P1CREATE EQU   @NM00006
P1READ   EQU   @NM00006
P1OPEN   EQU   @NM00006
@NM00005 EQU   COMMONC+167
OPERID   EQU   COMMONC+160
COMBUF   EQU   COMMONB
CBCCONID EQU   COMMONA+34
ACCESSOR EQU   COMMONA+29
TEXTLENG EQU   COMMONA+28
COMBUFP  EQU   COMMONA+25
COMI     EQU   COMMONA+24
TBEG     EQU   COMMONA+20
RETVATT1 EQU   COMMONA+17
IDTBL    EQU   COMMONA+13
MSG1EXTP EQU   COMMONA+9
FWTO2    EQU   @NM00004
FERRSYN  EQU   @NM00004
FERRID   EQU   @NM00003
FTEXT    EQU   @NM00003
FALL     EQU   @NM00003
FLOGON   EQU   @NM00003
FNOW     EQU   @NM00003
FLIST    EQU   @NM00003
FLISTALL EQU   @NM00003
FDEL     EQU   @NM00003
FCNS     EQU   @NM00002
FUSER    EQU   @NM00002
FBRDCST  EQU   @NM00002
FMN      EQU   @NM00002
FADDBC   EQU   @NM00002
FYESBCM  EQU   @NM00002
FNOMSG   EQU   @NM00002
FLISTING EQU   FLAGS
FENDUSL  EQU   FLAGS
FUPUSD   EQU   FLAGS
FCHNMSG  EQU   FLAGS
FOPEN    EQU   FLAGS
FMSG9    EQU   MSGFLAGS
VALCNT   EQU   COMMONA+2
TPUTRC   EQU   COMMONA+1
@NM00001 EQU   COMMONA
*                                      END UNREFERENCED COMPONENTS
@RT00069 EQU   ANYINV
@RT00071 EQU   MSG1OUT
@RT00073 EQU   INV2
@RT00075 EQU   ERRSYN
@RT00077 EQU   ERR4
@RT00079 EQU   WMSG6
@RT00081 EQU   MSG8OUT
@RT00083 EQU   MSGAOUT
@RT00085 EQU   MSGEOUT
@RT00087 EQU   BADTPUT
@RT00089 EQU   BADIO
@RT00091 EQU   BADRITA
EXIT3    EQU   @EL00001
@RT00105 EQU   IDLP4
@RC00157 EQU   WARNMSG
@RF00200 EQU   BADSEND
@RT00208 EQU   EXITCODE
@RT00211 EQU   EXIT3
@RC00218 EQU   SRCBK
@RT00222 EQU   CHKSRC
@RT00274 EQU   BADTPUT
ROUTER   EQU   EXITCODE
@RT00247 EQU   ROUTER
@EL01    EQU   @EL00001
@ENDDATA EQU   *
         END   IEEVSND4

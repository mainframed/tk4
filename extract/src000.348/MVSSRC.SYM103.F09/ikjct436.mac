         TITLE 'IKJCT436, EXEC EXECUTOR MODULE - PHASE II PART II      *
                        '
IKJCT436 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJCT436  77.084'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         L     @00,@SIZDATD                                        0001
         IKJEXEC  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         MVC   @PC00001(20),0(@01)                                 0001
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*                                                                  0103
*   /*****************************************************************/
*   /*                                                               */
*   /* START EXECUTABLE CODE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0103
*   ERROR=F0;                       /* SET ERROR INDICATOR CLEAR     */
         SLR   @15,@15                                             0103
         ST    @15,ERROR                                           0103
*   GETLST=''B;                     /* CLEAR MACRO LISTS             */
         XC    GETLST(10),GETLST                                   0104
*   FRELST=''B;                     /*                               */
         XC    FRELST(10),FRELST                                   0105
*   DO;                             /* GETMAIN (EC) MF(M,GETLST)     */
*     GETLST04='20'X;               /* TYPE                          */
         MVI   GETLST04,X'20'                                      0107
*   END;                            /* GETMAIN (EC) MF(M,GETLST)     */
*   DO;                             /* FREEMAIN (E) MF(M,FRELST)     */
*     FRELST05='00'X;               /* SET TYPE                      */
         MVI   FRELST05,X'00'                                      0110
*   END;                            /* FREEMAIN (E) MF(M,FRELST)     */
*   STACKD(1:MACLEN)=STACKC(1:MACLEN);/* COPY ALL MACROS TO GOT CORE */
         L     @15,MACLEN                                          0112
         BCTR  @15,0                                               0112
         EX    @15,@SM02640                                        0112
*   IF OPCODE>=OPENCODE&OPCODE<=PUTCODE THEN/* IF FILE OPERATION     */
         L     @15,OLDLINE(,COMONPTR)                              0113
         CLI   OPCODE(@15),18                                      0113
         BL    @RF00113                                            0113
         CLI   OPCODE(@15),21                                      0113
         BH    @RF00113                                            0113
*     DO;                           /* SET UP STAE ENVIRONMENT       */
*       RFY                                                        0115
*        (R2,                                                      0115
*         R15) RSTD;                /* RESTRICT REGS                 */
*       STM(R0,R15,STAEREGS);       /* SAVE REGISTERS                */
         STM   R0,R15,STAEREGS(COMONPTR)                           0116
*       R2=ADDR(STAERTN);           /* GET ADDR OF STAE RTN          */
         LA    R2,STAERTN                                          0117
*       GEN REFS(R2,STAEL) FLOWS(STAERTN)/* SET UP STAE ROUTINE      */
*           (STAE (2),PARAM=(8),PURGE=NONE,MF=(E,STAEL));          0118
         STAE (2),PARAM=(8),PURGE=NONE,MF=(E,STAEL)
*       IF R15=F0 THEN              /* IS STAE PROTECTED             */
         LTR   R15,R15                                             0119
         BNZ   @RF00119                                            0119
*         STAECNTL=YES;             /* REMEMBER THIS FACT            */
         OI    STAECNTL(COMONPTR),B'00100000'                      0120
*       RFY                                                        0121
*        (R2,                                                      0121
*         R15) UNRSTD;              /* RELEASE REGS                  */
@RF00119 DS    0H                                                  0122
*     END;                          /* END LOOP                      */
*   IF OPCODE>DIM(VECTOR) THEN      /* IF A BAD OPCODE               */
@RF00113 L     @01,OLDLINE(,COMONPTR)                              0123
         CLI   OPCODE(@01),22                                      0123
         BNH   @RF00123                                            0123
*     ERROR=E999;                   /* SET THE ERROR CODE            */
         MVC   ERROR(4),@CF00619                                   0124
*   ELSE                            /* OTHERWISE                     */
*     CALL ROUTINE;                 /* CALL THE OPERATION            */
         B     @RC00123                                            0125
@RF00123 L     @01,OLDLINE(,COMONPTR)                              0125
         SLR   @14,@14                                             0125
         IC    @14,OPCODE(,@01)                                    0125
         SLA   @14,2                                               0125
         L     @15,VECTOR(@14)                                     0125
         BALR  @14,@15                                             0125
*   IF STABND=YES THEN              /* BYPASS CODE IF NOT RETRY      */
@RC00123 TM    STABND(COMONPTR),B'00010000'                        0126
         BNO   @RF00126                                            0126
*     DO;                           /*                               */
*       RFY                                                        0128
*         R1 RSTD;                  /* RESTRICT REG 1                */
*RETRYRTN:                                                         0129
*       COMONPTR=BASEPTR;           /* LOAD BASE REG FOR COMMON      */
RETRYRTN L     COMONPTR,BASEPTR(,R1)                               0129
*       RFY                                                        0130
*         R1 UNRSTD;                /* RELEASE REG 1                 */
*       LM(R0,R15,STAEREGS);        /* LOAD ALL REGS                 */
         LM    R0,R15,STAEREGS(COMONPTR)                           0131
*       STAECNTL=NO;                /* SET NOSTAE                    */
         NI    STAECNTL(COMONPTR),B'11011111'                      0132
*       ERROR=ERCOM;                /*                               */
         L     @15,ERCOM(,COMONPTR)                                0133
         ST    @15,ERROR                                           0133
*       RCABEND=YES;                /* SET ABEND SWITCH              */
         OI    RCABEND(COMONPTR),B'10000000'                       0134
*     END;                          /* END SKIPPED CODE              */
*   IF STAECNTL=YES THEN            /* IF AN ACTIVE STAE             */
@RF00126 TM    STAECNTL(COMONPTR),B'00100000'                      0136
         BNO   @RF00136                                            0136
*     DO;                           /*                               */
*       STAECNTL=NO;                /* CLEAR BIT                     */
         NI    STAECNTL(COMONPTR),B'11011111'                      0138
*       GEN REFS(STAEL)(STAE 0,MF=(E,STAEL));                      0139
         STAE 0,MF=(E,STAEL)
*     END;                                                         0140
*   RETURN CODE(ERROR);             /* RETURN TO CALLER              */
@RF00136 L     @07,ERROR                                           0141
         L     @13,4(,@13)                                         0141
         L     @00,@SIZDATD                                        0141
         LR    @01,@09                                             0141
         IKJEXEC  R,LV=(0),A=(1)
         LR    @15,@07                                             0141
         L     @14,12(,@13)                                        0141
         LM    @00,@12,20(@13)                                     0141
         BR    @14                                                 0141
*STAERTN:                                                          0142
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0142
@EL00001 L     @13,4(,@13)                                         0142
@EF00001 L     @00,@SIZDATD                                        0142
         LR    @01,@09                                             0142
         IKJEXEC  R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0142
         BR    @14                                                 0142
STAERTN  DS    0H                                                  0143
*   DCL                                                            0143
*     REGAREAS CHAR(48) DEF(STAEREGS) POS(9);                      0143
*   RFY                                                            0144
*    (R0,                                                          0144
*     R1,                                                          0144
*     R14,                                                         0144
*     R15) RSTD;                    /* RESTRICT REGS                 */
*   COMONPTR=BASEPTR;               /* PICK UP COMON BASE            */
         L     COMONPTR,BASEPTR(,R1)                               0145
*   LM(R2,R12,REGAREAS);            /* LOAD MOST REGS                */
         LM    R2,R12,REGAREAS(COMONPTR)                           0146
*   ERCOM=ABCODE;                   /* GET ABEND CODE                */
         L     @07,ABCODE-1(,R1)                                   0147
         LA    @07,0(,@07)                                         0147
         ST    @07,ERCOM(,COMONPTR)                                0147
*   R0=ADDR(RETRYRTN);              /* GET RETRY ROUTINE ADDR        */
         LA    R0,RETRYRTN                                         0148
*   R15=E4;                         /* SET RC TO SUPVSR              */
         LA    R15,4                                               0149
*   RFY                                                            0150
*    (R0,                                                          0150
*     R1,                                                          0150
*     R14,                                                         0150
*     R15) UNRSTD;                  /* RELEASE REGS                  */
*   END STAERTN;                                                   0151
@EL00002 DS    0H                                                  0151
@EF00002 DS    0H                                                  0151
@ER00002 BR    @14                                                 0151
*                                                                  0152
*   /*****************************************************************/
*   /*                                                               */
*   /* COMLINK: THIS ROUTINE SET UP PART 1 REGS AND GOES TO THE      */
*   /* APPROPRIATE ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0152
*COMLINK:                                                          0152
*   PROC(WTG) OPTIONS(SAVEAREA);    /* ROUTINE LINKAGE               */
COMLINK  STM   @14,@12,12(@13)                                     0152
         ST    @13,@SA00003+4                                      0152
         LA    @14,@SA00003                                        0152
         ST    @14,8(,@13)                                         0152
         LR    @13,@14                                             0152
         MVC   @PC00003(4),0(@01)                                  0152
*   DCL                                                            0153
*     WTG FIXED(31),                /* WHERE TO GO                   */
*     COMRTN LABEL BASED(R15) VALRG(*);/* ROUTINE OUTSIDE            */
*   RFY                                                            0154
*    (R1,                                                          0154
*     R15) RSTD;                    /* RESTRICT REG 15               */
*   R15=ROUTINES(WTG);              /* LOAD ROUTINE ADDR             */
         L     @14,@PC00003                                        0155
         L     @14,WTG(,@14)                                       0155
         SLA   @14,2                                               0155
         L     @07,@CA00138                                        0155
         AL    @07,@CF02645                                        0155
         L     R15,ROUTINES-ROUTINES(@14,@07)                      0155
*   R1=R1+F4;                       /* POINT TO REAL PARM LIST       */
         AL    R1,@CF00109                                         0156
*   STM(R9,R12,REGAREA2);           /* SAVE REGS                     */
         STM   R9,R12,REGAREA2(COMONPTR)                           0157
*   LM(R9,R12,REGAREA);             /* LOAD REGISTERS                */
         LM    R9,R12,REGAREA(COMONPTR)                            0158
*   CALL COMRTN;                    /* CALL COMMON RTN               */
         BALR  @14,@15                                             0159
*   LM(R9,R12,REGAREA2);            /* RESTORE REGS                  */
         LM    R9,R12,REGAREA2(COMONPTR)                           0160
*   ERROR=ERCOM;                    /* SET ERROR                     */
         L     @14,ERCOM(,COMONPTR)                                0161
         ST    @14,ERROR                                           0161
*   RFY                                                            0162
*    (R1,                                                          0162
*     R15) UNRSTD;                  /* RELEASE REG 15                */
*   END COMLINK;                    /* END COMMON LINK               */
@EL00003 L     @13,4(,@13)                                         0163
@EF00003 DS    0H                                                  0163
@ER00003 LM    @14,@12,12(@13)                                     0163
         BR    @14                                                 0163
*                                                                  0164
*   /*****************************************************************/
*   /*                                                               */
*   /* TSO FUNCTION                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0164
*TSORTN:                                                           0164
*   PROC;                           /* ROUTINE FOR TSO CMDS          */
TSORTN   STM   @14,@12,@SA00004                                    0164
*   LASTTSO=GTPBLINE;               /* SAVE POINTER TO LAST TSO      */
         L     @01,LSDPTR(,COMONPTR)                               0165
         L     @01,LSDEXEC(,@01)                                   0165
         L     @15,@PC00001+12                                     0165
         L     @00,GTPBLINE(,@15)                                  0165
         ST    @00,LASTTSO(,@01)                                   0165
*   CALL GETRC;                     /* GET LAST RETURN CODE          */
         BAL   @14,GETRC                                           0166
*   IF ERROR=F0 THEN                /* IF OK THEN                    */
         L     @15,ERROR                                           0167
         LTR   @15,@15                                             0167
         BNZ   @RF00167                                            0167
*     DO;                           /* SET ECTRTCD FIELD             */
*       ECTRTCD=CNVTANS;            /* CODE FROM LASTCC              */
         L     @15,@PC00001+4                                      0169
         MVC   ECTRTCD(3,@15),CNVTANS+1(COMONPTR)                  0169
*       IF RCABEND=YES THEN         /* IF CODE IS ABEND              */
         TM    RCABEND(COMONPTR),B'10000000'                       0170
         BNO   @RF00170                                            0170
*         ECTRCDF=ABNDFLG;          /* SET ECT ABEND FLAG            */
         MVI   ECTRCDF(@15),X'80'                                  0171
*       ELSE                        /* OTHERWISE                     */
*         ECTRCDF=''B;              /* CLEAR ABEND FLAG              */
         B     @RC00170                                            0172
@RF00170 L     @15,@PC00001+4                                      0172
         MVI   ECTRCDF(@15),X'00'                                  0172
*     END;                          /*                               */
@RC00170 DS    0H                                                  0174
*   RCABEND=NO;                     /* CLEAR INTERNAL FLAG           */
@RF00167 NI    RCABEND(COMONPTR),B'01111111'                       0174
*   END TSORTN;                     /* END TSO ROUTINE               */
@EL00004 DS    0H                                                  0175
@EF00004 DS    0H                                                  0175
@ER00004 LM    @14,@12,@SA00004                                    0175
         BR    @14                                                 0175
*                                                                  0176
*   /*****************************************************************/
*   /*                                                               */
*   /* GO TO FUNCTION                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0176
*GOTORTN:                                                          0176
*INTGTORN:                                                         0176
*   PROC;                           /* GO TO ROUTINE                 */
GOTORTN  DS    0H                                                  0176
INTGTORN STM   @14,@12,@SA00005                                    0176
*   IF OPCODE=IGOTO THEN            /* IF INTERNAL GOTO              */
         L     @15,OLDLINE(,COMONPTR)                              0177
         CLI   OPCODE(@15),15                                      0177
         BNE   @RF00177                                            0177
*     DO;                           /* USE FLSEPATH                  */
*       ERROR=E4;                   /* SET UP TO GET ANOTHER LINE    */
         MVC   ERROR(4),@CF00109                                   0179
*       NOLASTCC=YES;               /* SKIP LASTCC UPDATE    @ZA03879*/
         L     @14,LSDPTR(,COMONPTR)                               0180
         L     @01,LSDEXEC(,@14)                                   0180
         OI    NOLASTCC(@01),B'01000000'                           0180
*       LSDANEXT=FLSEPATH;          /* POINT LSDANEXT TO NEW LINE    */
         MVC   LSDANEXT(4,@14),FLSEPATH(@15)                       0181
*     END;                          /* END INTERNAL GO TO            */
*   ELSE                            /* NORMAL GO TO                  */
*     DO;                           /* FIND LABEL TO GO TO           */
         B     @RC00177                                            0183
@RF00177 DS    0H                                                  0184
*       I=MYO2;                     /* START OF SCAN FOR LABEL       */
         L     @15,MYO2(,COMONPTR)                                 0184
         ST    @15,I(,COMONPTR)                                    0184
*       CALL COMLINK(FINDWORD);     /* FIND LABEL                    */
         LA    @01,@AL00185                                        0185
         BAL   @14,COMLINK                                         0185
*       IF SEPS=YES THEN            /* OF NO LABEL ON GOTO CMD       */
         TM    SEPS(COMONPTR),B'10000000'                          0186
         BNO   @RF00186                                            0186
*         ERROR=E956;               /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00611                                   0187
*       ELSE                        /* IF SOMETHING FOUND            */
*         IF LEN=F0×LEN>F8 THEN     /* IF INCORRECT LENGTH           */
         B     @RC00186                                            0188
@RF00186 L     @15,LEN(,COMONPTR)                                  0188
         LTR   @15,@15                                             0188
         BZ    @RT00188                                            0188
         C     @15,@CF00087                                        0188
         BNH   @RF00188                                            0188
@RT00188 DS    0H                                                  0189
*           ERROR=E948;             /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00607                                   0189
*         ELSE                      /* OTHERWISE FIND LABEL          */
*           DO;                     /*                               */
         B     @RC00188                                            0190
@RF00188 DS    0H                                                  0191
*             CALL COMLINK(LOCATE,C(BEGIN),LEN,F4);/* FIND LABEL     */
         LA    @15,@CF00121                                        0191
         ST    @15,@AL00001                                        0191
         L     @01,BEGIN(,COMONPTR)                                0191
         L     @15,BUFBASE(,COMONPTR)                              0191
         LA    @15,C-1(@01,@15)                                    0191
         ST    @15,@AL00001+4                                      0191
         LA    @15,LEN(,COMONPTR)                                  0191
         ST    @15,@AL00001+8                                      0191
         LA    @15,@CF00109                                        0191
         ST    @15,@AL00001+12                                     0191
         LA    @01,@AL00001                                        0191
         BAL   @14,COMLINK                                         0191
*             IF ERROR=F0 THEN      /* IF LABEL FOUND                */
         L     @15,ERROR                                           0192
         LTR   @15,@15                                             0192
         BNZ   @RF00192                                            0192
*               DO;                 /* PROCESS                       */
*                 ERROR=E4;         /* SET UP TO GET ANOTHER LINE    */
         MVC   ERROR(4),@CF00109                                   0194
*                 LSDANEXT=SNTVLPTR;/* GO TO NEW LINE                */
         L     @01,LSDPTR(,COMONPTR)                               0195
         L     @15,SNTELPTR(,COMONPTR)                             0195
         L     @00,SNTVLPTR(,@15)                                  0195
         ST    @00,LSDANEXT(,@01)                                  0195
*               END;                                               0196
*             ELSE                  /* OTHERWISE LABEL NOT FOUND     */
*               ERROR=E952;         /* SET ERROR CODE                */
         B     @RC00192                                            0197
@RF00192 MVC   ERROR(4),@CF00609                                   0197
*           END;                                                   0198
*     END;                                                         0199
*   END GOTORTN;                                                   0200
@EL00005 DS    0H                                                  0200
@EF00005 DS    0H                                                  0200
@ER00005 LM    @14,@12,@SA00005                                    0200
         BR    @14                                                 0200
*                                                                  0201
*   /*****************************************************************/
*   /*                                                               */
*   /* ELSE/END FUNCTION                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0201
*ELSERTN:                                                          0201
*ENDRTN:                                                           0201
*   PROC OPTIONS(NOSAVE);           /* ELSE-END ROUTINE              */
ELSERTN  DS    0H                                                  0201
ENDRTN   DS    0H                                                  0202
*   ERROR=E4;                       /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00109                                   0202
*   NOLASTCC=YES;                   /* SKIP LASTCC UPDATE    @ZA03879*/
         L     @01,LSDPTR(,COMONPTR)                               0203
         L     @01,LSDEXEC(,@01)                                   0203
         OI    NOLASTCC(@01),B'01000000'                           0203
*   END ELSERTN;                    /* END OF ELSE-END               */
@EL00006 DS    0H                                                  0204
@EF00006 DS    0H                                                  0204
@ER00006 BR    @14                                                 0204
*                                                                  0205
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN FUNCTION                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0205
*RETRTN:                                                           0205
*   PROC;                                                          0205
RETRTN   STM   @14,@12,12(@13)                                     0205
*   ERROR=E4;                       /* GET ANOTHER COMMAND           */
         MVC   ERROR(4),@CF00109                                   0206
*   IF(ERRCMD=YES&ERRRANGE=YES)×    /* RETURN IS NOP UNLESS IN       */
*       (ATTNCMD=YES&ATRANGE=YES) THEN/* ERROR OR ATTN RANGE         */
         L     @01,LSDPTR(,COMONPTR)                               0207
         L     @01,LSDEXEC(,@01)                                   0207
         TM    ERRCMD(@01),B'01000000'                             0207
         BNO   @GL00003                                            0207
         TM    ERRRANGE(COMONPTR),B'00000100'                      0207
         BO    @RT00207                                            0207
@GL00003 L     @01,LSDPTR(,COMONPTR)                               0207
         L     @01,LSDEXEC(,@01)                                   0207
         TM    ATTNCMD(@01),B'00000001'                            0207
         BNO   @RF00207                                            0207
         TM    ATRANGE(COMONPTR),B'00000010'                       0207
         BNO   @RF00207                                            0207
@RT00207 DS    0H                                                  0208
*     LSDANEXT=RETPTR;              /*                               */
         L     @15,LSDPTR(,COMONPTR)                               0208
         L     @01,LSDEXEC(,@15)                                   0208
         L     @14,RETPTR(,@01)                                    0208
         ST    @14,LSDANEXT(,@15)                                  0208
*   END RETRTN;                                                    0209
@EL00007 DS    0H                                                  0209
@EF00007 DS    0H                                                  0209
@ER00007 LM    @14,@12,12(@13)                                     0209
         BR    @14                                                 0209
*                                                                  0210
*   /*****************************************************************/
*   /*                                                               */
*   /* IF FUNCTION                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*IFRTN:                                                            0210
*   PROC OPTIONS(SAVEAREA);         /* IF ROUTINE                    */
IFRTN    STM   @14,@12,12(@13)                                     0210
         ST    @13,@SA00008+4                                      0210
         LA    @14,@SA00008                                        0210
         ST    @14,8(,@13)                                         0210
         LR    @13,@14                                             0210
*   CLEN=LL-(F7+FREEAMT+MYO2);      /* EXPR LNTH (THEN IS LAST FOUR) */
         L     @15,BUFBASE(,COMONPTR)                              0211
         LA    @14,7                                               0211
         AL    @14,FREEAMT(,COMONPTR)                              0211
         L     @07,MYO2(,COMONPTR)                                 0211
         ALR   @14,@07                                             0211
         LCR   @14,@14                                             0211
         AH    @14,LL(,@15)                                        0211
         STH   @14,CLEN(,COMONPTR)                                 0211
*   TYPE=RELAT;                     /* SET RELATIONAL ENTRY          */
         MVC   TYPE(4,COMONPTR),@CF00091                           0212
*   RFY                                                            0213
*    (R15) RSTD;                    /* RESTRICT REG 15               */
*   CALL IKJCT434(C(MYO2),CLEN,TYPE,OUTA1);/* EVALUATE               */
         L     @14,BUFBASE(,COMONPTR)                              0214
         LA    @14,C-1(@07,@14)                                    0214
         ST    @14,@AL00001                                        0214
         LA    @14,CLEN(,COMONPTR)                                 0214
         ST    @14,@AL00001+4                                      0214
         LA    @14,TYPE(,COMONPTR)                                 0214
         ST    @14,@AL00001+8                                      0214
         LA    @14,OUTA1                                           0214
         ST    @14,@AL00001+12                                     0214
         L     @15,@CV00128                                        0214
         LA    @01,@AL00001                                        0214
         BALR  @14,@15                                             0214
*   ERROR=R15;                      /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0215
*   RFY                                                            0216
*    (R15) UNRSTD;                  /* RELEASE REG 15                */
*   IF ERROR=E4 THEN                /* IF FALSE                      */
         L     @15,ERROR                                           0217
         C     @15,@CF00109                                        0217
         BNE   @RF00217                                            0217
*     LSDANEXT=FLSEPATH;            /* BRANCH TO FALSE PATH          */
         L     @01,LSDPTR(,COMONPTR)                               0218
         L     @15,OLDLINE(,COMONPTR)                              0218
         MVC   LSDANEXT(4,@01),FLSEPATH(@15)                       0218
*   ELSE                            /* OTHERWISE                     */
*     IF ERROR=F0 THEN              /* IF OK                         */
         B     @RC00217                                            0219
@RF00217 L     @15,ERROR                                           0219
         LTR   @15,@15                                             0219
         BNZ   @RF00219                                            0219
*       ERROR=E4;                   /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00109                                   0220
*   END IFRTN;                                                     0221
@EL00008 L     @13,4(,@13)                                         0221
@EF00008 DS    0H                                                  0221
@ER00008 LM    @14,@12,12(@13)                                     0221
         BR    @14                                                 0221
*                                                                  0222
*   /*****************************************************************/
*   /*                                                               */
*   /* WRITE/WRITER FUNCTION                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0222
*WRITERTN:                                                         0222
*WRRRTN:                                                           0222
*   PROC;                                                          0222
WRITERTN DS    0H                                                  0222
WRRRTN   STM   @14,@12,@SA00009                                    0222
*   VLPTR=ADDR(C(MYO2))-F4;         /* CAUSE OVERLAY OF CMD          */
         L     @15,MYO2(,COMONPTR)                                 0223
         L     @14,BUFBASE(,COMONPTR)                              0223
         LA    @07,C-1(@15,@14)                                    0223
         SL    @07,@CF00109                                        0223
         ST    @07,VLPTR                                           0223
*   VLPTR->LL=LL-(MYO2-F1);         /* SET NEW LL                    */
         BCTR  @15,0                                               0224
         LCR   @15,@15                                             0224
         AH    @15,LL(,@14)                                        0224
         STH   @15,LL(,@07)                                        0224
*   VLPTR->OO=F0;                   /* ZERO OFFSET                   */
         SLR   @06,@06                                             0225
         STH   @06,OO(,@07)                                        0225
*   IF OPCODE=WRITE THEN            /* IF WRITE                      */
         L     @01,OLDLINE(,COMONPTR)                              0226
         CLI   OPCODE(@01),4                                       0226
         BNE   @RF00226                                            0226
*     N=F2;                         /* PRINT ASIS                    */
         MVC   N(4),@CF00091                                       0227
*   ELSE                            /* OTHERWISE                     */
*     N=F0;                         /* PRINT EDIT                    */
         B     @RC00226                                            0228
@RF00226 SLR   @15,@15                                             0228
         ST    @15,N                                               0228
*   CALL COMLINK(PRINT,VLPTR,N);    /* PRINT LINE                    */
@RC00226 LA    @15,@CF00109                                        0229
         ST    @15,@AL00001                                        0229
         LA    @15,VLPTR                                           0229
         ST    @15,@AL00001+4                                      0229
         LA    @15,N                                               0229
         ST    @15,@AL00001+8                                      0229
         LA    @01,@AL00001                                        0229
         BAL   @14,COMLINK                                         0229
*   ERROR=E4;                       /* SET UP TO GET NEW LINE        */
         MVC   ERROR(4),@CF00109                                   0230
*   END WRITERTN;                                                  0231
@EL00009 DS    0H                                                  0231
@EF00009 DS    0H                                                  0231
@ER00009 LM    @14,@12,@SA00009                                    0231
         BR    @14                                                 0231
*                                                                  0232
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FUNCTION                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0232
*SETRTN:                                                           0232
*   PROC OPTIONS(SAVEAREA);                                        0232
SETRTN   STM   @14,@12,12(@13)                                     0232
         ST    @13,@SA00010+4                                      0232
         LA    @14,@SA00010                                        0232
         ST    @14,8(,@13)                                         0232
         LR    @13,@14                                             0232
*   CLEN=LL-(F3+MYO2+FREEAMT);      /* LENGTH OF EXPRESSION          */
         L     @15,BUFBASE(,COMONPTR)                              0233
         L     @14,MYO2(,COMONPTR)                                 0233
         LA    @07,3                                               0233
         ALR   @07,@14                                             0233
         AL    @07,FREEAMT(,COMONPTR)                              0233
         LCR   @07,@07                                             0233
         AH    @07,LL(,@15)                                        0233
         STH   @07,CLEN(,COMONPTR)                                 0233
*   TYPE=F0;                        /* SET TYPE FUNCTION             */
         SLR   @07,@07                                             0234
         ST    @07,TYPE(,COMONPTR)                                 0234
*   RFY                                                            0235
*    (R15) RSTD;                    /* RESTRICT REG 15               */
*   CALL IKJCT434(C(MYO2),CLEN,TYPE,OUTA1);/* CALL EVALUATION        */
         L     @07,BUFBASE(,COMONPTR)                              0236
         LA    @14,C-1(@14,@07)                                    0236
         ST    @14,@AL00001                                        0236
         LA    @14,CLEN(,COMONPTR)                                 0236
         ST    @14,@AL00001+4                                      0236
         LA    @14,TYPE(,COMONPTR)                                 0236
         ST    @14,@AL00001+8                                      0236
         LA    @14,OUTA1                                           0236
         ST    @14,@AL00001+12                                     0236
         L     @15,@CV00128                                        0236
         LA    @01,@AL00001                                        0236
         BALR  @14,@15                                             0236
*   ERROR=R15;                      /* SAVE RETURN CODE              */
         ST    R15,ERROR                                           0237
*   RFY                                                            0238
*    (R15) UNRSTD;                  /* RELEASE REG 15                */
*   IF ERROR=E832 THEN              /* IF MAX VAL EXCEEDED   @ZA04832*/
         L     @15,ERROR                                           0239
         LA    @14,832                                             0239
         CR    @15,@14                                             0239
         BNE   @RF00239                                            0239
*     DO;                           /*                       @ZA04832*/
*       ERRSAV=E832;                /* SAVE ERROR CODE       @ZA04832*/
         LR    ERRSAV,@14                                          0241
*       ERROR=F0;                   /* INDICATE NO ERROR     @ZA04832*/
         SLR   @03,@03                                             0242
         ST    @03,ERROR                                           0242
*     END;                          /*                       @ZA04832*/
*   ELSE                            /* ELSE SET CODE TO      @ZA04832*/
*     ERRSAV=E4;                    /* GET ANOTHER LINE      @ZA04832*/
         B     @RC00239                                            0244
@RF00239 LA    ERRSAV,4                                            0244
*   IF ERROR=F0 THEN                /* IF SET OK                     */
@RC00239 L     @03,ERROR                                           0245
         LTR   @03,@03                                             0245
         BNZ   @RF00245                                            0245
*     DO;                           /* UPDATE VARIABLE               */
*       I=MYO2;                     /* START OF SCAN                 */
         L     @03,MYO2(,COMONPTR)                                 0247
         ST    @03,I(,COMONPTR)                                    0247
*       SEPS=NO;                    /* CLEAR SWITCH                  */
         NI    SEPS(COMONPTR),B'01111111'                          0248
*       CALL COMLINK(SCANWORD);     /* SCAN THE VARIABLE             */
         LA    @01,@AL00249                                        0249
         BAL   @14,COMLINK                                         0249
*       IF ENDDLM=NO×LEN=F0 THEN    /* INVALID VARIABLE              */
         TM    ENDDLM(COMONPTR),B'01000000'                        0250
         BZ    @RT00250                                            0250
         L     @03,LEN(,COMONPTR)                                  0250
         LTR   @03,@03                                             0250
         BNZ   @RF00250                                            0250
@RT00250 DS    0H                                                  0251
*         ERROR=E940;               /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00603                                   0251
*       ELSE                        /* OTHERWISE                     */
*         CALL COMLINK(LOCATE,C(BEGIN),LEN,F8);/* LOCATE VARIABLE    */
         B     @RC00250                                            0252
@RF00250 LA    @03,@CF00121                                        0252
         ST    @03,@AL00001                                        0252
         L     @03,BEGIN(,COMONPTR)                                0252
         L     @01,BUFBASE(,COMONPTR)                              0252
         LA    @03,C-1(@03,@01)                                    0252
         ST    @03,@AL00001+4                                      0252
         LA    @03,LEN(,COMONPTR)                                  0252
         ST    @03,@AL00001+8                                      0252
         LA    @03,@CF00087                                        0252
         ST    @03,@AL00001+12                                     0252
         LA    @01,@AL00001                                        0252
         BAL   @14,COMLINK                                         0252
*       IF ERROR=F0 THEN            /* IF VARIABLE FOUND             */
@RC00250 L     @03,ERROR                                           0253
         LTR   @03,@03                                             0253
         BNZ   @RF00253                                            0253
*         CALL COMLINK(UPDATE,ANSWER,EVAL(CLEN));/* UPDATE VARIABLE  */
         LA    @03,@CF00087                                        0254
         ST    @03,@AL00001                                        0254
         L     @03,ANSPTR(,COMONPTR)                               0254
         ST    @03,@AL00001+4                                      0254
         LH    @03,CLEN(,COMONPTR)                                 0254
         ST    @03,@AFTEMPS                                        0254
         LA    @03,@AFTEMPS                                        0254
         ST    @03,@AL00001+8                                      0254
         LA    @01,@AL00001                                        0254
         BAL   @14,COMLINK                                         0254
*       IF ERROR=F0 THEN            /* IF UPDATE SUCCESSFUL          */
@RF00253 L     @03,ERROR                                           0255
         LTR   @03,@03                                             0255
         BNZ   @RF00255                                            0255
*         ERROR=ERRSAV;             /* WILL BE E4 OR 3832    @ZA04832*/
         ST    ERRSAV,ERROR                                        0256
*       IF LEN=6&C(BEGIN:BEGIN+5)=LASTCC&ERINCNTL=NO THEN/*  @ZA03878*/
@RF00255 CLC   LEN(4,COMONPTR),@CF00146                            0257
         BNE   @RF00257                                            0257
         L     @01,BEGIN(,COMONPTR)                                0257
         L     @15,BUFBASE(,COMONPTR)                              0257
         ALR   @15,@01                                             0257
         CLC   C-1(6,@15),@CC00439                                 0257
         BNE   @RF00257                                            0257
         L     @01,LSDPTR(,COMONPTR)                               0257
         L     @15,LSDEXEC(,@01)                                   0257
         TM    ERINCNTL(@15),B'00001000'                           0257
         BNZ   @RF00257                                            0257
*         NOLASTCC=YES;             /* SKIP LASTCC UPDATE    @ZA03878*/
         OI    NOLASTCC(@15),B'01000000'                           0258
*     END;                          /*                               */
*   END SETRTN;                     /*                               */
@EL00010 L     @13,4(,@13)                                         0260
@EF00010 DS    0H                                                  0260
@ER00010 LM    @14,@12,12(@13)                                     0260
         BR    @14                                                 0260
*                                                                  0261
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL FUNCTION                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*CTLRTN:                                                           0261
*   PROC OPTIONS(SAVEAREA);                                        0261
CTLRTN   STM   @14,@12,12(@13)                                     0261
         ST    @13,@SA00011+4                                      0261
         LA    @14,@SA00011                                        0261
         ST    @14,8(,@13)                                         0261
         LR    @13,@14                                             0261
*   IF CTMAIN=YES THEN              /* MAIN ?                        */
         L     @01,OLDLINE(,COMONPTR)                              0262
         TM    CTMAIN(@01),B'00001000'                             0262
         BNO   @RF00262                                            0262
*     DO;                           /* PROCESS                       */
*       CMAIN=YES;                  /* SET MAIN OPTION               */
*       NOFLUSH=YES;                /* FORCE NOFLUSH                 */
         L     @01,LSDPTR(,COMONPTR)                               0265
         L     @01,LSDEXEC(,@01)                                   0265
         OI    CMAIN(@01),B'00100100'                              0265
*     END;                          /*                               */
*   ELSE                            /* OTHERWISE CHECK FOR         0267
*                                      FLISH/NOFLUSH                 */
*     IF CMAIN=NO THEN              /* IF MAIN DO NOT CHANGE FLUSH   */
         B     @RC00262                                            0267
@RF00262 L     @01,LSDPTR(,COMONPTR)                               0267
         L     @15,LSDEXEC(,@01)                                   0267
         TM    CMAIN(@15),B'00000100'                              0267
         BNZ   @RF00267                                            0267
*       DO;                         /*                               */
*         IF CFLUSH=YES THEN        /* FLUSH ?                       */
         L     @01,OLDLINE(,COMONPTR)                              0269
         TM    CFLUSH(@01),B'10000000'                             0269
         BNO   @RF00269                                            0269
*           NOFLUSH=NO;             /* TURN OFF NO FLUSH             */
         NI    NOFLUSH(@15),B'11011111'                            0270
*         IF CNOFLUSH=YES THEN      /* NOFLUSH ?                     */
@RF00269 L     @01,OLDLINE(,COMONPTR)                              0271
         TM    CNOFLUSH(@01),B'01000000'                           0271
         BNO   @RF00271                                            0271
*           NOFLUSH=YES;            /* TURN ON NOFLUSH               */
         L     @01,LSDPTR(,COMONPTR)                               0272
         L     @01,LSDEXEC(,@01)                                   0272
         OI    NOFLUSH(@01),B'00100000'                            0272
*       END;                        /*                               */
@RF00271 DS    0H                                                  0274
*   IF CPROMPT=YES THEN             /* PROMPT ?                      */
@RF00267 DS    0H                                                  0274
@RC00262 L     @01,OLDLINE(,COMONPTR)                              0274
         TM    CPROMPT(@01),B'00100000'                            0274
         BNO   @RF00274                                            0274
*     INSPROM=YES;                  /* TURN ON PROMPT BIT            */
         L     @15,@PC00001+4                                      0275
         L     @01,ECTIOWA(,@15)                                   0275
         L     @01,IOSTELM(,@01)                                   0275
         OI    INSPROM(@01),B'00000100'                            0275
*   IF CNOPROM=YES THEN             /* NOPROMPT ?                    */
@RF00274 L     @01,OLDLINE(,COMONPTR)                              0276
         TM    CNOPROM(@01),B'00010000'                            0276
         BNO   @RF00276                                            0276
*     INSPROM=NO;                   /* TURN OFF PROMPT               */
         L     @15,@PC00001+4                                      0277
         L     @01,ECTIOWA(,@15)                                   0277
         L     @01,IOSTELM(,@01)                                   0277
         NI    INSPROM(@01),B'11111011'                            0277
*   IF CLIST=YES THEN               /* LIST ?                        */
@RF00276 L     @01,OLDLINE(,COMONPTR)                              0278
         TM    CLIST(@01),B'00001000'                              0278
         BNO   @RF00278                                            0278
*     INSLIST=YES;                  /* TURN ON LIST                  */
         L     @15,@PC00001+4                                      0279
         L     @01,ECTIOWA(,@15)                                   0279
         L     @01,IOSTELM(,@01)                                   0279
         OI    INSLIST(@01),B'00000001'                            0279
*   IF CNOLIST=YES THEN             /* NOLIST ?                      */
@RF00278 L     @01,OLDLINE(,COMONPTR)                              0280
         TM    CNOLIST(@01),B'00000100'                            0280
         BNO   @RF00280                                            0280
*     INSLIST=NO;                   /* TURN OFF LIST                 */
         L     @15,@PC00001+4                                      0281
         L     @01,ECTIOWA(,@15)                                   0281
         L     @01,IOSTELM(,@01)                                   0281
         NI    INSLIST(@01),B'11111110'                            0281
*   IF CCONLST=YES THEN             /* CONLST ?                      */
@RF00280 L     @01,OLDLINE(,COMONPTR)                              0282
         TM    CCONLST(@01),B'00000010'                            0282
         BNO   @RF00282                                            0282
*     CONLST=YES;                   /* TURN ON CONLST                */
         L     @01,LSDPTR(,COMONPTR)                               0283
         L     @01,LSDEXEC(,@01)                                   0283
         OI    CONLST(@01),B'10000000'                             0283
*   IF CNOCONLS=YES THEN            /* NOCONLST ?                    */
@RF00282 L     @01,OLDLINE(,COMONPTR)                              0284
         TM    CNOCONLS(@01),B'00000001'                           0284
         BNO   @RF00284                                            0284
*     CONLST=NO;                    /* TURN OFF CONLST               */
         L     @01,LSDPTR(,COMONPTR)                               0285
         L     @01,LSDEXEC(,@01)                                   0285
         NI    CONLST(@01),B'01111111'                             0285
*   IF CSYMLST=YES THEN             /* SYMLIST ?                     */
@RF00284 L     @01,OLDLINE(,COMONPTR)                              0286
         TM    CSYMLST(@01),B'10000000'                            0286
         BNO   @RF00286                                            0286
*     SYMLST=YES;                   /* TURN ON SYMLIST               */
         L     @01,LSDPTR(,COMONPTR)                               0287
         L     @01,LSDEXEC(,@01)                                   0287
         OI    SYMLST(@01),B'00010000'                             0287
*   IF CNOSYMLS=YES THEN            /* NOSYMLIST ?                   */
@RF00286 L     @01,OLDLINE(,COMONPTR)                              0288
         TM    CNOSYMLS(@01),B'01000000'                           0288
         BNO   @RF00288                                            0288
*     SYMLST=NO;                    /* TURN OFF SYMLIST              */
         L     @01,LSDPTR(,COMONPTR)                               0289
         L     @01,LSDEXEC(,@01)                                   0289
         NI    SYMLST(@01),B'11101111'                             0289
*   IF CNOMSG=YES THEN              /* NOMSG SPECIFIED               */
@RF00288 L     @01,OLDLINE(,COMONPTR)                              0290
         TM    CNOMSG(@01),B'00010000'                             0290
         BNO   @RF00290                                            0290
*     NOMSG=YES;                    /* TURN ON NOMSG                 */
         L     @01,LSDPTR(,COMONPTR)                               0291
         L     @01,LSDEXEC(,@01)                                   0291
         OI    NOMSG(@01),B'00000010'                              0291
*   IF CMSG=YES THEN                /* MSG SPECIFIED                 */
@RF00290 L     @01,OLDLINE(,COMONPTR)                              0292
         TM    CMSG(@01),B'00100000'                               0292
         BNO   @RF00292                                            0292
*     NOMSG=NO;                     /* TURN OFF NOMSG                */
         L     @01,LSDPTR(,COMONPTR)                               0293
         L     @01,LSDEXEC(,@01)                                   0293
         NI    NOMSG(@01),B'11111101'                              0293
*                                                                  0294
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO OPTIONS, PRINT WHAT IS IN EFFECT                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   IF COPTN=NOOPTION THEN          /* IF NO CONTROL OPTIONS         */
@RF00292 L     @01,OLDLINE(,COMONPTR)                              0294
         CLC   COPTN(2,@01),@CB00535                               0294
         BNE   @RF00294                                            0294
*     DO;                           /* LIST OPTIONS IN EFFECT        */
*       DO I=DIM(OLD) TO F3 BY-F1;  /* INIT OLD TO ALL NO SEGMENTS   */
         LA    @15,18                                              0296
         ST    @15,I(,COMONPTR)                                    0296
@DL00296 DS    0H                                                  0297
*         OLD(I)=ADDR(NOBUF);       /* ADDRESS OF 'NO'               */
         L     @15,I(,COMONPTR)                                    0297
         SLA   @15,2                                               0297
         L     @14,@CA00341                                        0297
         ST    @14,OLD-4(@15)                                      0297
*       END;                        /* DONE                          */
         SLR   @15,@15                                             0298
         BCTR  @15,0                                               0298
         AL    @15,I(,COMONPTR)                                    0298
         ST    @15,I(,COMONPTR)                                    0298
         C     @15,@CF00136                                        0298
         BNL   @DL00296                                            0298
*       I=F2;                       /* INIT TO SECOND ELEMENT        */
         LA    @15,2                                               0299
         ST    @15,I(,COMONPTR)                                    0299
*       OLD(I)=ADDR(MASTER);        /* POINT TO MESSAGE ID           */
         LR    @14,@15                                             0300
         SLA   @14,2                                               0300
         L     @07,@CA00340                                        0300
         ST    @07,OLD-4(@14)                                      0300
*       I=I+F1;                     /* INCREMENT INDEX               */
         LA    @14,1                                               0301
         ALR   @15,@14                                             0301
         ST    @15,I(,COMONPTR)                                    0301
*       IF NOFLUSH=YES THEN         /* IF NOFLUSH IS OFF             */
         L     @01,LSDPTR(,COMONPTR)                               0302
         L     @01,LSDEXEC(,@01)                                   0302
         TM    NOFLUSH(@01),B'00100000'                            0302
         BNO   @RF00302                                            0302
*         I=I+F1;                   /* INCREMENT I                   */
         ALR   @15,@14                                             0303
         ST    @15,I(,COMONPTR)                                    0303
*       OLD(I)=ADDR(FLUSH);         /* FLUSH KEYWORD                 */
@RF00302 L     @15,I(,COMONPTR)                                    0304
         LR    @14,@15                                             0304
         SLA   @14,2                                               0304
         L     @07,@CA00346                                        0304
         ST    @07,OLD-4(@14)                                      0304
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @14,1                                               0305
         ALR   @15,@14                                             0305
         ST    @15,I(,COMONPTR)                                    0305
*       IF INSPROM=NO THEN          /* IF PROMPT NOT IN EFFECT       */
         L     @07,@PC00001+4                                      0306
         L     @01,ECTIOWA(,@07)                                   0306
         L     @01,IOSTELM(,@01)                                   0306
         TM    INSPROM(@01),B'00000100'                            0306
         BNZ   @RF00306                                            0306
*         I=I+F1;                   /* INCREMENT I                   */
         ALR   @15,@14                                             0307
         ST    @15,I(,COMONPTR)                                    0307
*       OLD(I)=ADDR(PROMPT);        /* PROMPT KEYWORD                */
@RF00306 L     @15,I(,COMONPTR)                                    0308
         LR    @14,@15                                             0308
         SLA   @14,2                                               0308
         L     @07,@CA00345                                        0308
         ST    @07,OLD-4(@14)                                      0308
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @14,1                                               0309
         ALR   @15,@14                                             0309
         ST    @15,I(,COMONPTR)                                    0309
*       IF INSLIST=NO THEN          /* IF LIST NOT IN EFFECT         */
         L     @07,@PC00001+4                                      0310
         L     @01,ECTIOWA(,@07)                                   0310
         L     @01,IOSTELM(,@01)                                   0310
         TM    INSLIST(@01),B'00000001'                            0310
         BNZ   @RF00310                                            0310
*         I=I+F1;                   /* INCREMENT I                   */
         ALR   @15,@14                                             0311
         ST    @15,I(,COMONPTR)                                    0311
*       OLD(I)=ADDR(LISTBUF);       /* LIST KEYWORD                  */
@RF00310 L     @15,I(,COMONPTR)                                    0312
         LR    @14,@15                                             0312
         SLA   @14,2                                               0312
         L     @07,@CA00344                                        0312
         ST    @07,OLD-4(@14)                                      0312
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @14,1                                               0313
         ALR   @15,@14                                             0313
         ST    @15,I(,COMONPTR)                                    0313
*       IF CONLST=NO THEN           /* IF CONLIST NOT IN EFFECT      */
         L     @01,LSDPTR(,COMONPTR)                               0314
         L     @01,LSDEXEC(,@01)                                   0314
         TM    CONLST(@01),B'10000000'                             0314
         BNZ   @RF00314                                            0314
*         I=I+F1;                   /* INCREMENT I                   */
         ALR   @15,@14                                             0315
         ST    @15,I(,COMONPTR)                                    0315
*       OLD(I)=ADDR(CONLIST);       /* CONLST KEYWORD                */
@RF00314 L     @15,I(,COMONPTR)                                    0316
         LR    @14,@15                                             0316
         SLA   @14,2                                               0316
         L     @07,@CA00343                                        0316
         ST    @07,OLD-4(@14)                                      0316
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @14,1                                               0317
         ALR   @15,@14                                             0317
         ST    @15,I(,COMONPTR)                                    0317
*       IF SYMLST=NO THEN           /* IF SYMLIST NOT IN EFFECT      */
         L     @01,LSDPTR(,COMONPTR)                               0318
         L     @01,LSDEXEC(,@01)                                   0318
         TM    SYMLST(@01),B'00010000'                             0318
         BNZ   @RF00318                                            0318
*         I=I+F1;                   /* INCREMENT I                   */
         ALR   @15,@14                                             0319
         ST    @15,I(,COMONPTR)                                    0319
*       OLD(I)=ADDR(SYMLIST);       /* SYMLIST SEGMENT               */
@RF00318 L     @15,I(,COMONPTR)                                    0320
         LR    @14,@15                                             0320
         SLA   @14,2                                               0320
         L     @07,@CA00342                                        0320
         ST    @07,OLD-4(@14)                                      0320
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @14,1                                               0321
         ALR   @15,@14                                             0321
         ST    @15,I(,COMONPTR)                                    0321
*       IF NOMSG=YES THEN           /* IF NOMSG IN EFFECT            */
         L     @01,LSDPTR(,COMONPTR)                               0322
         L     @01,LSDEXEC(,@01)                                   0322
         TM    NOMSG(@01),B'00000010'                              0322
         BNO   @RF00322                                            0322
*         I=I+F1;                   /* GET A NO                      */
         ALR   @15,@14                                             0323
         ST    @15,I(,COMONPTR)                                    0323
*       OLD(I)=ADDR(MSGBUF);        /* 'MSG' SEGMENT                 */
@RF00322 L     @15,I(,COMONPTR)                                    0324
         LR    @14,@15                                             0324
         SLA   @14,2                                               0324
         L     @07,@CA00348                                        0324
         ST    @07,OLD-4(@14)                                      0324
*       IF CMAIN=YES THEN           /* IF MAIN IN EFFECT             */
         L     @01,LSDPTR(,COMONPTR)                               0325
         L     @01,LSDEXEC(,@01)                                   0325
         TM    CMAIN(@01),B'00000100'                              0325
         BNO   @RF00325                                            0325
*         DO;                       /* MAIN IN EFFECT                */
*           I=I+1;                  /* INCREMENT I                   */
         AL    @15,@CF00042                                        0327
         ST    @15,I(,COMONPTR)                                    0327
*           OLD(I)=ADDR(MAINBUF);   /* 'MAIN'                        */
         SLA   @15,2                                               0328
         L     @14,@CA00347                                        0328
         ST    @14,OLD-4(@15)                                      0328
*         END;                                                     0329
*       OLD(F1)=I-F1;               /* NUMBER OF MESSAGE SEGMENTS    */
@RF00325 L     @15,I(,COMONPTR)                                    0330
         BCTR  @15,0                                               0330
         ST    @15,OLD                                             0330
*       IOPL(4)=ADDR(PLBLK);        /* PUTLINE BLOCK                 */
         LA    @15,PLBLK                                           0331
         ST    @15,IOPL+12(,COMONPTR)                              0331
*       RFY                                                        0332
*        (R1,                                                      0332
*         R2,                                                      0332
*         R15) RSTD;                /* RESTRICT REG 15               */
*       R1=ADDR(IOPL);              /* GET IOPL ADDR                 */
         LR    R1,COMONPTR                                         0333
*       R2=ADDR(OLD);               /* GET ADDR OF OLD               */
         LA    R2,OLD                                              0334
*       R15=ADDR(IKJEFT40);         /* ADDRESS OF PUTLINE            */
         L     R15,@CV00130                                        0335
*       GEN REFS(R1,R2,R15)                                        0336
*           (PUTLINE OUTPUT=((2),SINGLE),MF=(E,(1)),ENTRY=(15));   0336
         PUTLINE OUTPUT=((2),SINGLE),MF=(E,(1)),ENTRY=(15)
*       RFY                                                        0337
*        (R1,                                                      0337
*         R2,                                                      0337
*         R15) UNRSTD;              /* RELEASE REG 15                */
*     END;                                                         0338
*   ERROR=E4;                       /* GET ANOTHER LINE              */
@RF00294 MVC   ERROR(4),@CF00109                                   0339
*   END CTLRTN;                                                    0340
@EL00011 L     @13,4(,@13)                                         0340
@EF00011 DS    0H                                                  0340
@ER00011 LM    @14,@12,12(@13)                                     0340
         BR    @14                                                 0340
*                                                                  0341
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR FUNCTION                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*ERRRTN:                                                           0341
*   PROC;                                                          0341
ERRRTN   STM   @14,@12,12(@13)                                     0341
*   IF ERROFF=YES×NOERROR=YES THEN  /* OFF OR NOTHING SPECIFIED ?    */
         L     @01,OLDLINE(,COMONPTR)                              0342
         TM    ERROFF(@01),B'11000000'                             0342
         BZ    @RF00342                                            0342
*     DO;                           /*                               */
*       ERACTSTR=F0;                /* NO START                      */
         SLR   @15,@15                                             0344
         L     @01,LSDPTR(,COMONPTR)                               0344
         L     @14,LSDEXEC(,@01)                                   0344
         ST    @15,ERACTSTR(,@14)                                  0344
*       ERACTEND=F0;                /* NO END                        */
         ST    @15,ERACTEND(,@14)                                  0345
*       ERRCMD=NO;                  /* TURN OFF ERRCMD SWITCH        */
         NI    ERRCMD(@14),B'10111111'                             0346
*     END;                          /*                               */
*   IF ERROFF=NO THEN               /* IF ERROR OFF NOT SPECIFIED    */
@RF00342 L     @15,OLDLINE(,COMONPTR)                              0348
         TM    ERROFF(@15),B'10000000'                             0348
         BNZ   @RF00348                                            0348
*     DO;                           /* SET UP ERROR ACTION           */
*       ERRCMD=YES;                 /* TURN ON ERRCMD SWITCH         */
         L     @14,LSDPTR(,COMONPTR)                               0350
         L     @07,LSDEXEC(,@14)                                   0350
         OI    ERRCMD(@07),B'01000000'                             0350
*       IF NOERROR=NO THEN          /* IF ERROR ACTION SPECIF        */
         TM    NOERROR(@15),B'01000000'                            0351
         BNZ   @RF00351                                            0351
*         DO;                       /* SET LIMITS OF ACTION          */
*           ERACTSTR=LSDANEXT;      /* START OF ERROR ACTION         */
         L     @06,LSDANEXT(,@14)                                  0353
         ST    @06,ERACTSTR(,@07)                                  0353
*           ERACTEND=ENDERACT;      /* END OF ERROR ACTION           */
         ICM   @06,15,ENDERACT(@15)                                0354
         ST    @06,ERACTEND(,@07)                                  0354
*           LSDANEXT=ENDERACT;      /* GO AROUND ERROR ACTION        */
         ST    @06,LSDANEXT(,@14)                                  0355
*         END;                      /*                               */
*     END;                                                         0357
@RF00351 DS    0H                                                  0358
*   ERROR=E4;                       /* GET ANOTHER LINE              */
@RF00348 MVC   ERROR(4),@CF00109                                   0358
*   END ERRRTN;                                                    0359
@EL00012 DS    0H                                                  0359
@EF00012 DS    0H                                                  0359
@ER00012 LM    @14,@12,12(@13)                                     0359
         BR    @14                                                 0359
*                                                                  0360
*   /*****************************************************************/
*   /*                                                               */
*   /* ATTENTION FUNCTION                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*ATTNRTN:                                                          0360
*   PROC;                           /* ATTENTION ROUTINE             */
ATTNRTN  STM   @14,@12,@SA00013                                    0360
*   IF ERROFF=YES×NOERROR=YES THEN  /* OFF OR NOTHING SPECIFIED ?    */
         L     @01,OLDLINE(,COMONPTR)                              0361
         TM    ERROFF(@01),B'11000000'                             0361
         BZ    @RF00361                                            0361
*     DO;                           /*                               */
*       IF ATTNCMD=YES THEN                                        0363
         L     @01,LSDPTR(,COMONPTR)                               0363
         L     @01,LSDEXEC(,@01)                                   0363
         TM    ATTNCMD(@01),B'00000001'                            0363
         BNO   @RF00363                                            0363
*         DO;                       /* CHECK FOR EXTRANEOUS ATTN   0364
*                                      OFF'S IF=NO THEN EXTRANEOUS 0364
*                                                            @ZA08099*/
*           RFY                                                    0365
*             R2 RSTD;              /*                       @ZA08099*/
*           R2=ADDR(STAXDT);        /*                       @ZA08099*/
         LA    R2,STAXDT                                           0366
*           STAXDT(1:LENSTAX)=STAXCT(1:LENSTAX);/* MOVE CSECT TO   0367
*                                      DSECT                 @ZA08099*/
         L     @03,LENSTAX                                         0367
         BCTR  @03,0                                               0367
         EX    @03,@SM02657                                        0367
*           STXATTOF=YES;           /* SET FLAG TO DECREMENT ATTN  0368
*                                      COUNT IN RCTDCLST     @ZA08099*/
         OI    STXATTOF,B'00000100'                                0368
*           GEN REFS(STAXDT)(STAX     MF=(E,(R2)));/*        @ZA08099*/
         STAX     MF=(E,(R2))
*           RFY                                                    0370
*             R2 UNRSTD;            /*                       @ZA08099*/
*         END;                      /*                       @ZA08099*/
*       ATACTSTR=F0;                /* NO START                      */
@RF00363 SLR   @15,@15                                             0372
         L     @01,LSDPTR(,COMONPTR)                               0372
         L     @14,LSDEXEC(,@01)                                   0372
         ST    @15,ATACTSTR(,@14)                                  0372
*       ATACTEND=F0;                /* NO END                        */
         ST    @15,ATACTEND(,@14)                                  0373
*       ATTNCMD=NO;                 /* TURN OFF ATTN SWITCH          */
         NI    ATTNCMD(@14),B'11111110'                            0374
*     END;                          /*                               */
*   ELSE                            /* OTHEWISE                      */
*     DO;                           /* SET UP ATTN ACTION            */
         B     @RC00361                                            0376
@RF00361 DS    0H                                                  0377
*       IF ATTNCMD=NO THEN                                         0377
         L     @01,LSDPTR(,COMONPTR)                               0377
         L     @01,LSDEXEC(,@01)                                   0377
         TM    ATTNCMD(@01),B'00000001'                            0377
         BNZ   @RF00377                                            0377
*         DO;                       /* CHECK FOR ATTN ALREADY IN   0378
*                                      EFFECT IF NO, THEN INCREMENT
*                                      COUNT TO RCTDCLST. IF YES,  0378
*                                      THEN LEAVE COUNT AS IS.     0378
*                                                            @ZA08099*/
*           RFY                                                    0379
*             R2 RSTD;              /*                       @ZA08099*/
*           R2=ADDR(STAXDT);        /*                       @ZA08099*/
         LA    R2,STAXDT                                           0380
*           STAXDT(1:LENSTAX)=STAXCT(1:LENSTAX);/* MOVE CSECT TO   0381
*                                      DSECT                 @ZA08099*/
         L     @03,LENSTAX                                         0381
         BCTR  @03,0                                               0381
         EX    @03,@SM02657                                        0381
*           STXATTON=YES;           /* SET FLAG TO INCREMENT COUNTER
*                                                            @ZA08099*/
         OI    STXATTON,B'00001000'                                0382
*           GEN REFS(STAXDT)(STAX     MF=(E,(R2)));/*        @ZA08099*/
         STAX     MF=(E,(R2))
*           RFY                                                    0384
*             R2 UNRSTD;            /*                       @ZA08099*/
*         END;                      /*                       @ZA08099*/
*       ATTNCMD=YES;                /* TURN ON ATTN D SWITCH         */
@RF00377 L     @15,LSDPTR(,COMONPTR)                               0386
         L     @14,LSDEXEC(,@15)                                   0386
         OI    ATTNCMD(@14),B'00000001'                            0386
*       ATACTSTR=LSDANEXT;          /* START OF ATTN ACTION          */
         L     @07,LSDANEXT(,@15)                                  0387
         ST    @07,ATACTSTR(,@14)                                  0387
*       ATACTEND=ENDERACT;          /* END OF ATTN ACTION            */
         L     @01,OLDLINE(,COMONPTR)                              0388
         ICM   @07,15,ENDERACT(@01)                                0388
         ST    @07,ATACTEND(,@14)                                  0388
*       LSDANEXT=ENDERACT;          /* GO AROUND ATTN ACTION         */
         ST    @07,LSDANEXT(,@15)                                  0389
*     END;                                                         0390
*   ERROR=E4;                       /* GET ANOTHER LINE              */
@RC00361 MVC   ERROR(4),@CF00109                                   0391
*   END ATTNRTN;                                                   0392
@EL00013 DS    0H                                                  0392
@EF00013 DS    0H                                                  0392
@ER00013 LM    @14,@12,@SA00013                                    0392
         BR    @14                                                 0392
*                                                                  0393
*   /*****************************************************************/
*   /*                                                               */
*   /* DO FUNCTION                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0393
*DORTN:                                                            0393
*   PROC OPTIONS(SAVEAREA);                                        0393
DORTN    STM   @14,@12,12(@13)                                     0393
         ST    @13,@SA00014+4                                      0393
         LA    @14,@SA00014                                        0393
         ST    @14,8(,@13)                                         0393
         LR    @13,@14                                             0393
*   IF DOWHILE=YES THEN             /* WHILE SPECIFIED               */
         L     @01,OLDLINE(,COMONPTR)                              0394
         TM    DOWHILE(@01),B'10000000'                            0394
         BNO   @RF00394                                            0394
*     DO;                           /* PROCESS EXPRESSION            */
*       CLEN=LL-(F3+FREEAMT+MYO2);  /* SET LENGTH                    */
         L     @15,BUFBASE(,COMONPTR)                              0396
         LA    @14,3                                               0396
         AL    @14,FREEAMT(,COMONPTR)                              0396
         L     @07,MYO2(,COMONPTR)                                 0396
         ALR   @14,@07                                             0396
         LCR   @14,@14                                             0396
         AH    @14,LL(,@15)                                        0396
         STH   @14,CLEN(,COMONPTR)                                 0396
*       TYPE=2;                     /* SET RELATIONAL                */
         MVC   TYPE(4,COMONPTR),@CF00091                           0397
*       RFY                                                        0398
*        (R15) RSTD;                /* RESTRICT REG 15               */
*       CALL IKJCT434(C(MYO2),CLEN,TYPE,OUTA1);/* CALL EVALUATION    */
         L     @14,BUFBASE(,COMONPTR)                              0399
         LA    @14,C-1(@07,@14)                                    0399
         ST    @14,@AL00001                                        0399
         LA    @14,CLEN(,COMONPTR)                                 0399
         ST    @14,@AL00001+4                                      0399
         LA    @14,TYPE(,COMONPTR)                                 0399
         ST    @14,@AL00001+8                                      0399
         LA    @14,OUTA1                                           0399
         ST    @14,@AL00001+12                                     0399
         L     @15,@CV00128                                        0399
         LA    @01,@AL00001                                        0399
         BALR  @14,@15                                             0399
*       ERROR=R15;                  /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0400
*       RFY                                                        0401
*        (R15) UNRSTD;              /* RELEASE REG 15                */
*       IF ERROR=E4 THEN            /* IF FALSE                      */
         L     @15,ERROR                                           0402
         C     @15,@CF00109                                        0402
         BNE   @RF00402                                            0402
*         LSDANEXT=DDFLSE;          /* DO FALSE PATH                 */
         L     @01,LSDPTR(,COMONPTR)                               0403
         L     @15,OLDLINE(,COMONPTR)                              0403
         MVC   LSDANEXT(4,@01),DDFLSE(@15)                         0403
*     END;                                                         0404
@RF00402 DS    0H                                                  0405
*   IF ERROR=F0 THEN                /* IF TRUE FROM EVAL             */
@RF00394 L     @15,ERROR                                           0405
         LTR   @15,@15                                             0405
         BNZ   @RF00405                                            0405
*     ERROR=E4;                     /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00109                                   0406
*   END DORTN;                                                     0407
@EL00014 L     @13,4(,@13)                                         0407
@EF00014 DS    0H                                                  0407
@ER00014 LM    @14,@12,12(@13)                                     0407
         BR    @14                                                 0407
*                                                                  0408
*   /*****************************************************************/
*   /*                                                               */
*   /* READ FUNCTION READ FUNCTION                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0408
*READRTN:                                                          0408
*READDRTN:                                                         0408
*   PROC OPTIONS(SAVEAREA);                                        0408
READRTN  DS    0H                                                  0408
READDRTN STM   @14,@12,12(@13)                                     0408
         ST    @13,@SA00015+4                                      0408
         LA    @14,@SA00015                                        0408
         ST    @14,8(,@13)                                         0408
         LR    @13,@14                                             0408
*   READEND=F0;                     /* INIT TO ZERO                  */
         SLR   READEND,READEND                                     0409
*   IF OPCODE=READ THEN             /* READ GOES TO TERMINAL         */
         L     @07,OLDLINE(,COMONPTR)                              0410
         CLI   OPCODE(@07),12                                      0410
         BNE   @RF00410                                            0410
*     DO;                           /* ISSUE A GETLINE               */
*       GEN(TCLEARQ INPUT);         /* CLEAR INPUT BUFFERS           */
         TCLEARQ INPUT
*       IOPL(4)=ADDR(GETBLK);       /* GETLINE PARM BLOCK            */
         LA    @07,GETBLK                                          0413
         ST    @07,IOPL+12(,COMONPTR)                              0413
*       IF PARMDEFR=YES THEN        /* IF OK TO CHANGE               */
         L     @07,@PC00001+16                                     0414
         TM    PARMDEFR(@07),B'10000000'                           0414
         BNO   @RF00414                                            0414
*         GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));                  0415
         STAX MF=(E,DEFERNO)
*       RFY                                                        0416
*        (R1,                                                      0416
*         R15) RSTD;                /* RESTRICT REG 15               */
@RF00414 DS    0H                                                  0417
*       R1=ADDR(IOPL);              /* GETLINE PARM LIST             */
         LR    R1,COMONPTR                                         0417
*       CALL IKJGETL;               /* GET A LINE FROM TERMINAL      */
         L     @15,@CV00131                                        0418
         BALR  @14,@15                                             0418
*       ERROR=R15;                  /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0419
*       IF PARMDEFR=YES THEN        /* IF OK TO CHANGE STATUS        */
         L     @14,@PC00001+16                                     0420
         TM    PARMDEFR(@14),B'10000000'                           0420
         BNO   @RF00420                                            0420
*         GEN REFS(DEFERYES)(STAX MF=(E,DEFERYES));                0421
         STAX MF=(E,DEFERYES)
*       RFY                                                        0422
*        (R1,                                                      0422
*         R15) UNRSTD;              /* RELEASE REG 15                */
@RF00420 DS    0H                                                  0423
*       IF ERROR=F0 THEN            /* IF GETLINE OK                 */
         L     @07,ERROR                                           0423
         LTR   @07,@07                                             0423
         BNZ   @RF00423                                            0423
*         DO;                       /* FOLD TO UPPER CASE            */
*           READEND=GLL-F4;         /* SET END OF SCAN               */
         ICM   @01,15,GLINE                                        0425
         LH    READEND,GLL(,@01)                                   0425
         SL    READEND,@CF00109                                    0425
*           DO I=READEND TO F1 BY-F1;/* FOLD TO UPPER CASE           */
         LR    @07,READEND                                         0426
         ST    @07,I(,COMONPTR)                                    0426
         B     @DE00426                                            0426
@DL00426 DS    0H                                                  0427
*             TR(GC(I),TRTABUP);    /* TRANSLATE TO NORMAL CHARS     */
         L     @07,I(,COMONPTR)                                    0427
         ICM   @01,15,GLINE                                        0427
         ALR   @01,@07                                             0427
         L     @07,@CA00173                                        0427
         TR    GC-1(1,@01),TRTABUP-TRTABUP(@07)                    0427
*           END;                    /*                               */
         SLR   @07,@07                                             0428
         BCTR  @07,0                                               0428
         AL    @07,I(,COMONPTR)                                    0428
         ST    @07,I(,COMONPTR)                                    0428
@DE00426 LTR   @07,@07                                             0428
         BP    @DL00426                                            0428
*         END;                                                     0429
*     END;                                                         0430
*   ELSE                            /* OTHERWISE GET FROM SYSDVAL    */
*     DO;                           /* GO GET IT                     */
         B     @RC00410                                            0431
@RF00410 DS    0H                                                  0432
*       CALL COMLINK(LOCATE,SYSDVAL,LENGTH(SYSDVAL),F0);/* LOC DVAL  */
         LA    @01,@AL00432                                        0432
         BAL   @14,COMLINK                                         0432
*       GLINE=SNTVLPTR;             /* POINT TO VALUE                */
         L     @07,SNTELPTR(,COMONPTR)                             0433
         L     @07,SNTVLPTR(,@07)                                  0433
         STCM  @07,15,GLINE                                        0433
*       READEND=SVTLNG;             /* SET READ LENGTH               */
         LH    READEND,SVTLNG(,@07)                                0434
*     END;                          /*                               */
*   IF ERROR=F0&READCNT=F0 THEN     /* IF READ W/O OPERANDS          */
@RC00410 SLR   @07,@07                                             0436
         C     @07,ERROR                                           0436
         BNE   @RF00436                                            0436
         L     @01,OLDLINE(,COMONPTR)                              0436
         ICM   @15,12,READCNT(@01)                                 0436
         SRA   @15,16                                              0436
         CR    @07,@15                                             0436
         BNE   @RF00436                                            0436
*     DO;                           /*                               */
*       CALL COMLINK(LOCATE,SYSDVAL,LENGTH(SYSDVAL),F0);/* LOC DVAL  */
         LA    @01,@AL00438                                        0438
         BAL   @14,COMLINK                                         0438
*       IF ERROR=F0 THEN            /* IF SYSDVAL FOUND              */
         L     @07,ERROR                                           0439
         LTR   @07,@07                                             0439
         BNZ   @RF00439                                            0439
*         CALL COMLINK(UPDATE,GC,EVAL(GLL-F4));/* UPDATE TO LINE     */
         LA    @07,@CF00087                                        0440
         ST    @07,@AL00001                                        0440
         ICM   @07,15,GLINE                                        0440
         LA    @15,GC(,@07)                                        0440
         ST    @15,@AL00001+4                                      0440
         LH    @07,GLL(,@07)                                       0440
         SL    @07,@CF00109                                        0440
         ST    @07,@AFTEMPS+4                                      0440
         LA    @07,@AFTEMPS+4                                      0440
         ST    @07,@AL00001+8                                      0440
         LA    @01,@AL00001                                        0440
         BAL   @14,COMLINK                                         0440
*     END;                          /*                               */
@RF00439 DS    0H                                                  0442
*   IF ERROR<=E4 THEN               /* IF GETLINE OK                 */
@RF00436 L     @07,ERROR                                           0442
         C     @07,@CF00109                                        0442
         BH    @RF00442                                            0442
*     DO;                           /* PROCESS VALUES                */
*       N=F1;                       /* START AT BEGINNING            */
         LA    @07,1                                               0444
         ST    @07,N                                               0444
*       ERROR=F0;                   /* RESET ERROR INCASE            */
         SLR   @15,@15                                             0445
         ST    @15,ERROR                                           0445
*       DO COUNT=1 TO READCNT WHILE ERROR=F0;/* PROCESS ALL VALUES   */
         LA    @15,1                                               0446
         LR    COUNT,@15                                           0446
         B     @DE00446                                            0446
@DL00446 L     @15,ERROR                                           0446
         LTR   @15,@15                                             0446
         BNZ   @DC00446                                            0446
*         SEPS=YES;                 /* PASS SEPARATORS               */
         OI    SEPS(COMONPTR),B'10000000'                          0447
*         DO WHILE SEPS=YES&N<=READEND;/* DO UNTIL END SEPS          */
         B     @DE00448                                            0448
@DL00448 DS    0H                                                  0449
*           IF GC(N)^=BLANK&GC(N)^=TAB THEN/* IF BLANK OR TAB        */
         ICM   @15,15,GLINE                                        0449
         L     @14,N                                               0449
         ALR   @14,@15                                             0449
         CLI   GC-1(@14),C' '                                      0449
         BE    @RF00449                                            0449
         L     @14,N                                               0449
         ALR   @14,@15                                             0449
         CLI   GC-1(@14),X'05'                                     0449
         BE    @RF00449                                            0449
*             IF N<READEND&GC(N:N+F1)=OPENCMT THEN/* IF A COMMENT    */
         L     @14,N                                               0450
         CR    @14,READEND                                         0450
         BNL   @RF00450                                            0450
         ALR   @15,@14                                             0450
         CLC   GC-1(2,@15),@CC00422                                0450
         BNE   @RF00450                                            0450
*               DO N=N+F4 TO READEND WHILE GC(N-2:N-F1)^=CLOSCMT;/*  */
         AL    @14,@CF00109                                        0451
         B     @DE00451                                            0451
@DL00451 ICM   @01,15,GLINE                                        0451
         ALR   @01,@14                                             0451
         CLC   GC-3(2,@01),@CC00424                                0451
         BE    @DC00451                                            0451
*               END;                /*                               */
         AL    @14,@CF00042                                        0452
@DE00451 ST    @14,N                                               0452
         CR    @14,READEND                                         0452
         BNH   @DL00451                                            0452
@DC00451 DS    0H                                                  0453
*             ELSE                  /* IF NOT A COMMENT              */
*               IF SKPCOMMA=YES&GC(N)=COMMA THEN/* COMMA TO LOOK AT  */
         B     @RC00450                                            0453
@RF00450 TM    SKPCOMMA(COMONPTR),B'00001000'                      0453
         BNO   @RF00453                                            0453
         L     @15,N                                               0453
         ICM   @01,15,GLINE                                        0453
         ALR   @01,@15                                             0453
         CLI   GC-1(@01),C','                                      0453
         BNE   @RF00453                                            0453
*                 DO;               /*                               */
*                   SKPCOMMA=NO;    /* RESET SKIP COMMA SW           */
         NI    SKPCOMMA(COMONPTR),B'11110111'                      0455
*                   N=N+1;          /* LOOK AT NEXT CHAR             */
         AL    @15,@CF00042                                        0456
         ST    @15,N                                               0456
*                 END;              /*                               */
*               ELSE                /* OTHERWISE                     */
*                 SEPS=NO;          /* END OF SEPARATORS             */
         B     @RC00453                                            0458
@RF00453 NI    SEPS(COMONPTR),B'01111111'                          0458
*           ELSE                    /* IF BLANK OF TAB               */
*             N=N+F1;               /* INDEX N                       */
         B     @RC00449                                            0459
@RF00449 LA    @15,1                                               0459
         AL    @15,N                                               0459
         ST    @15,N                                               0459
*         END;                      /*                               */
@RC00449 DS    0H                                                  0460
@DE00448 TM    SEPS(COMONPTR),B'10000000'                          0460
         BNO   @DC00448                                            0460
         C     READEND,N                                           0460
         BNL   @DL00448                                            0460
@DC00448 DS    0H                                                  0461
*                                                                  0461
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS VALUE FOUND                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0461
*         IF SEPS=YES THEN          /* IF ALL SEPARATORS             */
         TM    SEPS(COMONPTR),B'10000000'                          0461
         BNO   @RF00461                                            0461
*           BEGIN=N;                /* BEGIN AT SAME FOR ZERO LEN    */
         L     @15,N                                               0462
         ST    @15,BEGIN(,COMONPTR)                                0462
*         ELSE                      /* CONTINUE                      */
*           IF GC(N)=COMMA THEN     /* IF A COMMA                    */
         B     @RC00461                                            0463
@RF00461 L     @15,N                                               0463
         ICM   @01,15,GLINE                                        0463
         ALR   @01,@15                                             0463
         CLI   GC-1(@01),C','                                      0463
         BNE   @RF00463                                            0463
*             DO;                   /* PROCESS NULL ELEMENT          */
*               N=N+F1;             /* SKIP TO NEXT CHAR             */
         AL    @15,@CF00042                                        0465
         ST    @15,N                                               0465
*               BEGIN=N;            /* CAUSE NULL ELEM               */
         ST    @15,BEGIN(,COMONPTR)                                0466
*             END;                                                 0467
*           ELSE                    /* OTHERWISE                     */
*             DO;                   /* PROCESS THE STRING            */
         B     @RC00463                                            0468
@RF00463 DS    0H                                                  0469
*               SKPCOMMA=YES;       /* PROCESS COMMA AS BLANK        */
         OI    SKPCOMMA(COMONPTR),B'00001000'                      0469
*               IF GC(N)=QUOTE THEN /* IF A QUOTE                    */
         L     @15,N                                               0470
         ICM   @01,15,GLINE                                        0470
         ALR   @01,@15                                             0470
         CLI   GC-1(@01),C''''                                     0470
         BNE   @RF00470                                            0470
*                 DO;               /* PROCESS QSTRING               */
*                   N=N+F1;         /* SKIP BEGIN QUOTE              */
         AL    @15,@CF00042                                        0472
         ST    @15,N                                               0472
*                   BEGIN=N;        /* THIS IS BEGIN OF QSTRING      */
         ST    @15,BEGIN(,COMONPTR)                                0473
*                   DO N=N TO READEND WHILE GC(N)^=QUOTE×/*          */
*                         (N<READEND&GC(N:N+F1)=DQUOTE);/* FIND END  */
         B     @DE00474                                            0474
@DL00474 ICM   @14,15,GLINE                                        0474
         ALR   @15,@14                                             0474
         CLI   GC-1(@15),C''''                                     0474
         BNE   @DB00474                                            0474
         L     @15,N                                               0474
         CR    @15,READEND                                         0474
         BNL   @DC00474                                            0474
         ALR   @14,@15                                             0474
         CLC   GC-1(2,@14),@CC00464                                0474
         BNE   @DC00474                                            0474
@DB00474 DS    0H                                                  0475
*                     IF GC(N:N+F1)=DQUOTE THEN/* IF DOUBLE QUOTE    */
         ICM   @15,15,GLINE                                        0475
         L     @14,N                                               0475
         ALR   @14,@15                                             0475
         CLC   GC-1(2,@14),@CC00464                                0475
         BNE   @RF00475                                            0475
*                       DO;         /* SQUASH IT OUT                 */
*                         RFY                                      0477
*                          (R2,                                    0477
*                           R3,                                    0477
*                           R4,                                    0477
*                           R5) RSTD;/* RESTRICT REGS                */
*                         R2=ADDR(GC(N));/* POINT TO 'TO'            */
         L     @14,N                                               0478
         LA    R2,GC-1(@14,@15)                                    0478
*                         R4=R2+F1; /* + 1                           */
         LA    @15,1                                               0479
         LR    R4,R2                                               0479
         ALR   R4,@15                                              0479
*                         R5=READEND-N×BLANKS;/* LENGTH OF 'FROM'    */
         LCR   @14,@14                                             0480
         ALR   @14,READEND                                         0480
         O     @14,@CF00417                                        0480
         LR    R5,@14                                              0480
*                         R3=R5+F1; /* LENGTH OF 'TO'                */
         ALR   @15,R5                                              0481
         LR    R3,@15                                              0481
*                         MVCL(R2,R4);/* SQUASH QUOTE                */
         MVCL  R2,R4                                               0482
*                         READEND=READEND-F1;/* DECREMENT END OF BFR */
         BCTR  READEND,0                                           0483
*                         RFY                                      0484
*                          (R2,                                    0484
*                           R3,                                    0484
*                           R4,                                    0484
*                           R5) UNRSTD;/* RELEASE 2-5                */
*                       END;                                       0485
*                   END;                                           0486
@RF00475 LA    @15,1                                               0486
         AL    @15,N                                               0486
         ST    @15,N                                               0486
@DE00474 CR    @15,READEND                                         0486
         BNH   @DL00474                                            0486
@DC00474 DS    0H                                                  0487
*                   IF N<=READEND THEN/* IF NOT END MUST BE QUOTE    */
         C     READEND,N                                           0487
         BL    @RF00487                                            0487
*                     SKIP1=YES;    /* CAUSE SKIP OVER QUOTE         */
         OI    SKIP1(COMONPTR),B'01000000'                         0488
*                 END;                                             0489
*               ELSE                /* OTHERWISE                     */
*                 IF GC(N)=LPAREN THEN/* PROCESS PSTRING IF ONE      */
         B     @RC00470                                            0490
@RF00470 L     @15,N                                               0490
         ICM   @01,15,GLINE                                        0490
         ALR   @01,@15                                             0490
         CLI   GC-1(@01),C'('                                      0490
         BNE   @RF00490                                            0490
*                   DO;             /*                               */
*                     N=N+F1;       /* SKIP PAREN                    */
         LA    @03,1                                               0492
         ALR   @15,@03                                             0492
         ST    @15,N                                               0492
*                     BEGIN=N;      /* BEGINNING OF STRING           */
         ST    @15,BEGIN(,COMONPTR)                                0493
*                     PCTR=F1;      /* PAREN COUNTER TO 1            */
         LR    PCTR,@03                                            0494
*                     DO N=N TO READEND WHILE PCTR>F0;/* FIND CLOS 0495
*                                      ')'                           */
         B     @DE00495                                            0495
@DL00495 LTR   PCTR,PCTR                                           0495
         BNP   @DC00495                                            0495
*                       IF GC(N)=LPAREN THEN/* IF ANOTHER OPEN       */
         ICM   @03,15,GLINE                                        0496
         ALR   @03,@15                                             0496
         CLI   GC-1(@03),C'('                                      0496
         BNE   @RF00496                                            0496
*                         PCTR=PCTR+F1;/* ADD ONE TO PCTR            */
         AL    PCTR,@CF00042                                       0497
*                       ELSE        /*                               */
*                         IF GC(N)=RPAREN THEN/* IF CLOSE PAREN      */
         B     @RC00496                                            0498
@RF00496 L     @03,N                                               0498
         ICM   @01,15,GLINE                                        0498
         ALR   @01,@03                                             0498
         CLI   GC-1(@01),C')'                                      0498
         BNE   @RF00498                                            0498
*                           DO;     /*                               */
*                             PCTR=PCTR-F1;/* DECREMENT PCTR         */
         BCTR  PCTR,0                                              0500
*                             IF PCTR=F0 THEN/* IF AT END OF PSTRING */
         LTR   PCTR,PCTR                                           0501
         BNZ   @RF00501                                            0501
*                               DO; /*                               */
*                                 N=N-F1;/* BACK UP ONE              */
         BCTR  @03,0                                               0503
         ST    @03,N                                               0503
*                                 SKIP1=YES;/* CAUSE SKIP OVER PAREN */
         OI    SKIP1(COMONPTR),B'01000000'                         0504
*                               END;/*                               */
*                           END;                                   0506
@RF00501 DS    0H                                                  0507
*                     END;                                         0507
@RF00498 DS    0H                                                  0507
@RC00496 LA    @15,1                                               0507
         AL    @15,N                                               0507
         ST    @15,N                                               0507
@DE00495 CR    @15,READEND                                         0507
         BNH   @DL00495                                            0507
@DC00495 DS    0H                                                  0508
*                   END;                                           0508
*                 ELSE                                             0509
*                   DO;             /* PROCESS CHAR STRING           */
         B     @RC00490                                            0509
@RF00490 DS    0H                                                  0510
*                     BEGIN=N;      /* SAVE START                    */
         L     @15,N                                               0510
         ST    @15,BEGIN(,COMONPTR)                                0510
*                     DO N=N TO READEND WHILE GC(N)^=BLANK&/* ^ BLANK*/
*                           GC(N)^=COMMA&GC(N)^=TAB&/*               */
*                           (N=READEND×GC(N:N+F1)^=OPENCMT);/*       */
         B     @DE00511                                            0511
@DL00511 ICM   @14,15,GLINE                                        0511
         ALR   @15,@14                                             0511
         CLI   GC-1(@15),C' '                                      0511
         BE    @DC00511                                            0511
         L     @15,N                                               0511
         ALR   @15,@14                                             0511
         CLI   GC-1(@15),C','                                      0511
         BE    @DC00511                                            0511
         L     @15,N                                               0511
         ALR   @15,@14                                             0511
         CLI   GC-1(@15),X'05'                                     0511
         BE    @DC00511                                            0511
         L     @15,N                                               0511
         CR    @15,READEND                                         0511
         BE    @DB00511                                            0511
         ALR   @14,@15                                             0511
         CLC   GC-1(2,@14),@CC00422                                0511
         BE    @DC00511                                            0511
@DB00511 DS    0H                                                  0512
*                     END;                                         0512
         LA    @15,1                                               0512
         AL    @15,N                                               0512
         ST    @15,N                                               0512
@DE00511 CR    @15,READEND                                         0512
         BNH   @DL00511                                            0512
@DC00511 DS    0H                                                  0513
*                   END;                                           0513
*             END;                                                 0514
@RC00490 DS    0H                                                  0514
@RC00470 DS    0H                                                  0515
*         SNTELPTR=READNAME(COUNT); /* GET VARIABLE                  */
@RC00463 DS    0H                                                  0515
@RC00461 LR    @15,COUNT                                           0515
         SLA   @15,2                                               0515
         L     @01,OLDLINE(,COMONPTR)                              0515
         ALR   @01,@15                                             0515
         ICM   @00,15,READNAME-4(@01)                              0515
         ST    @00,SNTELPTR(,COMONPTR)                             0515
*         IF SNTGLOB=YES THEN       /* IF GLOBAL VARIABLE            */
         LR    @01,@00                                             0516
         TM    SNTGLOB(@01),B'10000000'                            0516
         BNO   @RF00516                                            0516
*           CALL COMLINK(GLOCATE);  /* LOCATE GLOBAL VARIABLE        */
         LA    @01,@AL00517                                        0517
         BAL   @14,COMLINK                                         0517
*         IF ERROR=F0 THEN          /* IF FOUND THEN                 */
@RF00516 L     @15,ERROR                                           0518
         LTR   @15,@15                                             0518
         BNZ   @RF00518                                            0518
*           CALL COMLINK(UPDATE,GC(BEGIN),EVAL(N-BEGIN));/* UPDATE   */
         LA    @15,@CF00087                                        0519
         ST    @15,@AL00001                                        0519
         L     @15,BEGIN(,COMONPTR)                                0519
         ICM   @14,15,GLINE                                        0519
         LA    @14,GC-1(@15,@14)                                   0519
         ST    @14,@AL00001+4                                      0519
         LCR   @15,@15                                             0519
         AL    @15,N                                               0519
         ST    @15,@AFTEMPS+4                                      0519
         LA    @15,@AFTEMPS+4                                      0519
         ST    @15,@AL00001+8                                      0519
         LA    @01,@AL00001                                        0519
         BAL   @14,COMLINK                                         0519
*         IF SKIP1=YES THEN         /* SKIP ONE BYTE ?               */
@RF00518 TM    SKIP1(COMONPTR),B'01000000'                         0520
         BNO   @RF00520                                            0520
*           DO;                     /* YES -                         */
*             SKIP1=NO;             /* RESET SWITCH                  */
         NI    SKIP1(COMONPTR),B'10111111'                         0522
*             N=N+F1;               /* SKIP BYTE                     */
         LA    @15,1                                               0523
         AL    @15,N                                               0523
         ST    @15,N                                               0523
*           END;                    /*                               */
*       END;                        /*                               */
@RF00520 AL    COUNT,@CF00042                                      0525
@DE00446 L     @01,OLDLINE(,COMONPTR)                              0525
         ICM   @15,12,READCNT(@01)                                 0525
         SRA   @15,16                                              0525
         CR    COUNT,@15                                           0525
         BNH   @DL00446                                            0525
@DC00446 DS    0H                                                  0526
*       IF ERROR=F0 THEN            /* IF UPDATE SUCCESSFUL          */
         L     @15,ERROR                                           0526
         LTR   @15,@15                                             0526
         BNZ   @RF00526                                            0526
*         ERROR=E4;                 /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00109                                   0527
*       IF OPCODE=READ THEN         /* IF A GETLINE ISSUED,FREE BFR  */
@RF00526 L     @01,OLDLINE(,COMONPTR)                              0528
         CLI   OPCODE(@01),12                                      0528
         BNE   @RF00528                                            0528
*         DO;                       /* FREEMAIN LV(GLL) A(GLINE)   0529
*                                      SP(1) MF(E,FRELST)            */
*           RESPECIFY                                              0530
*            (GPR01P) RESTRICTED;                                  0530
*           FRELST02=GLL;           /* LENGTH                        */
         ICM   @15,15,GLINE                                        0531
         LH    @00,GLL(,@15)                                       0531
         STCM  @00,7,FRELST02                                      0531
*           FRELST04=ADDR(GLINE);   /* ADDR OF ADDR LIST             */
         LA    @00,GLINE                                           0532
         STCM  @00,7,FRELST04                                      0532
*           FRELST06=1;             /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'01'                                      0533
*           GPR01P=ADDR(FRELST);    /* REG1 POINTS TO LIST           */
         LA    GPR01P,FRELST                                       0534
*           SVC(5);                 /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0535
*           RESPECIFY                                              0536
*            (GPR01P) UNRESTRICTED;                                0536
*         END;                      /* FREEMAIN LV(GLL) A(GLINE)   0537
*                                      SP(1) MF(E,FRELST)            */
*     END;                                                         0538
*   ELSE                            /* GETLINE FAIL                  */
*     ERROR=E324;                   /* SET ERROR CODE                */
         B     @RC00442                                            0539
@RF00442 MVC   ERROR(4),@CF00555                                   0539
*   END READRTN;                                                   0540
@EL00015 L     @13,4(,@13)                                         0540
@EF00015 DS    0H                                                  0540
@ER00015 LM    @14,@12,12(@13)                                     0540
         BR    @14                                                 0540
*                                                                  0541
*   /*****************************************************************/
*   /*                                                               */
*   /* TERMINAL INPUT WITH DELIMETERS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0541
*TERMRTN:                                                          0541
*   PROC OPTIONS(SAVEAREA);                                        0541
TERMRTN  STM   @14,@12,12(@13)                                     0541
         ST    @13,@SA00016+4                                      0541
         LA    @14,@SA00016                                        0541
         ST    @14,8(,@13)                                         0541
         LR    @13,@14                                             0541
*   CONTINU=NO;                     /* FORCE RETURN TO GETLINE       */
         NI    CONTINU(COMONPTR),B'10111111'                       0542
*   I=MYO2;                         /* START OF SCAN                 */
         L     @15,MYO2(,COMONPTR)                                 0543
         ST    @15,I(,COMONPTR)                                    0543
*   SEPS=NO;                        /* INIT SEPS OFF                 */
         NI    SEPS(COMONPTR),B'01111111'                          0544
*   IF C(I-F1)=COMMA THEN           /* IF NULL AND STRINGS           */
         L     @14,BUFBASE(,COMONPTR)                              0545
         ALR   @15,@14                                             0545
         CLI   C-2(@15),C','                                       0545
         BNE   @RF00545                                            0545
*     DO;                           /* ADD NULL TO LIST              */
*       DELIMPTR(1)=ADDR(C(I-F1));  /* GET ADDR OF DELIM             */
         L     @15,I(,COMONPTR)                                    0547
         LA    @15,C-2(@15,@14)                                    0547
         ST    @15,DELIMPTR                                        0547
*       DELIMLEN(1)=F0;             /* SET NULL LENGTH               */
         SLR   @15,@15                                             0548
         ST    @15,DELIMLEN                                        0548
*       N=F2;                       /* START AT NEXT SLOT            */
         MVC   N(4),@CF00091                                       0549
*     END;                          /*                               */
*   ELSE                            /* OTHERWISE                     */
*     N=F1;                         /* START AT FIRST SLOT           */
         B     @RC00545                                            0551
@RF00545 MVC   N(4),@CF00042                                       0551
*   DO N=N TO DIM(DELIMTAB) WHILE SEPS=NO&/* NOT ALL SEPARATORS &    */
*         ERROR=F0;                 /* NO ERROR YET                  */
@RC00545 L     @15,N                                               0552
         B     @DE00552                                            0552
@DL00552 TM    SEPS(COMONPTR),B'10000000'                          0552
         BNZ   @DC00552                                            0552
         L     @15,ERROR                                           0552
         LTR   @15,@15                                             0552
         BNZ   @DC00552                                            0552
*     CALL COMLINK(SKIPSEPS);       /* SKIP ALL SEPARATORS           */
         LA    @01,@AL00553                                        0553
         BAL   @14,COMLINK                                         0553
*     DELIMPTR(N)=ADDR(C(I));       /* POINT TO STRING BEGINNING     */
         L     @15,N                                               0554
         SLA   @15,3                                               0554
         L     @01,I(,COMONPTR)                                    0554
         L     @14,BUFBASE(,COMONPTR)                              0554
         LA    @14,C-1(@01,@14)                                    0554
         ST    @14,DELIMPTR-8(@15)                                 0554
*     DO DELIMLEN(N)=F0 BY F1 WHILE SEPS=NO&/* NOT ALL DELIMS        */
*           I<=LL-(F4+FREEAMT)&C(I)^=COMMA&/* NOT A DELIMETER OR     */
*           C(I)^=BLANK&C(I)^=TAB&  /* END OF BUFFER                 */
*           (I=LL-(F4+FREEAMT)×C(I:I+1)^=OPENCMT);/*                 */
         SLR   @15,@15                                             0555
         L     @14,N                                               0555
         SLA   @14,3                                               0555
         ST    @15,DELIMLEN-8(@14)                                 0555
         B     @DE00555                                            0555
@DL00555 DS    0H                                                  0556
*       I=I+F1;                     /* INCREMENT I                   */
         LA    @15,1                                               0556
         AL    @15,I(,COMONPTR)                                    0556
         ST    @15,I(,COMONPTR)                                    0556
*     END;                          /*                               */
         L     @14,N                                               0557
         SLA   @14,3                                               0557
         LA    @15,1                                               0557
         AL    @15,DELIMLEN-8(@14)                                 0557
         L     @14,N                                               0557
         SLA   @14,3                                               0557
         ST    @15,DELIMLEN-8(@14)                                 0557
@DE00555 TM    SEPS(COMONPTR),B'10000000'                          0557
         BNZ   @DC00555                                            0557
         L     @15,I(,COMONPTR)                                    0557
         L     @14,BUFBASE(,COMONPTR)                              0557
         LA    @07,4                                               0557
         AL    @07,FREEAMT(,COMONPTR)                              0557
         LCR   @07,@07                                             0557
         AH    @07,LL(,@14)                                        0557
         CR    @15,@07                                             0557
         BH    @DC00555                                            0557
         ALR   @15,@14                                             0557
         CLI   C-1(@15),C','                                       0557
         BE    @DC00555                                            0557
         L     @06,I(,COMONPTR)                                    0557
         ALR   @06,@14                                             0557
         CLI   C-1(@06),C' '                                       0557
         BE    @DC00555                                            0557
         L     @06,I(,COMONPTR)                                    0557
         ALR   @06,@14                                             0557
         CLI   C-1(@06),X'05'                                      0557
         BE    @DC00555                                            0557
         L     @06,I(,COMONPTR)                                    0557
         CR    @06,@07                                             0557
         BE    @DL00555                                            0557
         ALR   @14,@06                                             0557
         CLC   C-1(2,@14),@CC00422                                 0557
         BNE   @DL00555                                            0557
@DC00555 DS    0H                                                  0558
*     IF DELIMLEN(N)>F256 THEN      /* IF DELIMETER IS TOO LONG      */
         L     @15,N                                               0558
         SLA   @15,3                                               0558
         L     @15,DELIMLEN-8(@15)                                 0558
         C     @15,@CF00174                                        0558
         BNH   @RF00558                                            0558
*       ERROR=E316;                 /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00551                                   0559
*   END;                            /*                               */
@RF00558 LA    @15,1                                               0560
         AL    @15,N                                               0560
         ST    @15,N                                               0560
@DE00552 C     @15,@CF00316                                        0560
         BNH   @DL00552                                            0560
@DC00552 DS    0H                                                  0561
*   IF ERROR=F0&SEPS=NO THEN        /* IF TOO MANY DELIMETERS        */
         L     @15,ERROR                                           0561
         LTR   @15,@15                                             0561
         BNZ   @RF00561                                            0561
         TM    SEPS(COMONPTR),B'10000000'                          0561
         BNZ   @RF00561                                            0561
*     ERROR=E328;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00557                                   0562
*   N=MAX(F1,N-F2);                 /* DECREMENT N                   */
@RF00561 L     @15,N                                               0563
         BCTR  @15,0                                               0563
         BCTR  @15,0                                               0563
         LA    @14,1                                               0563
         CR    @15,@14                                             0563
         BNL   *+6
         LR    @15,@14                                             0563
         ST    @15,N                                               0563
*   IF ERROR=F0&ECTBKGRD=YES THEN   /* TERMIN INVALID IN BACKGROUND  */
         L     @15,ERROR                                           0564
         LTR   @15,@15                                             0564
         BNZ   @RF00564                                            0564
         L     @15,@PC00001+4                                      0564
         TM    ECTBKGRD(@15),B'00000010'                           0564
         BNO   @RF00564                                            0564
*     ERROR=E972;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00617                                   0565
*   IF ERROR=F0 THEN                /* IF OK SO FAR                  */
@RF00564 L     @15,ERROR                                           0566
         LTR   @15,@15                                             0566
         BNZ   @RF00566                                            0566
*     DO;                           /*                               */
*       GETLEN=F2;                  /* TWO BYTES FOR TOTAL LENGTH    */
         LA    GETLEN,2                                            0568
*       DO I=1 TO N;                /* NUM OF DELIMS                 */
         LA    @03,1                                               0569
         B     @DE00569                                            0569
@DL00569 DS    0H                                                  0570
*         GETLEN=GETLEN+DELIMLEN(I)+F2;/* ADD LENGTH OF DELIM+HEAD   */
         L     @03,I(,COMONPTR)                                    0570
         SLA   @03,3                                               0570
         LR    @15,GETLEN                                          0570
         AL    @15,DELIMLEN-8(@03)                                 0570
         AL    @15,@CF00091                                        0570
         LR    GETLEN,@15                                          0570
*       END;                        /*                               */
         LA    @03,1                                               0571
         AL    @03,I(,COMONPTR)                                    0571
@DE00569 ST    @03,I(,COMONPTR)                                    0571
         C     @03,N                                               0571
         BNH   @DL00569                                            0571
*       DO;                         /* GETMAIN LV(GETLEN) A(DATAPTR)
*                                      SP(78) MF(E,GETLST)         0572
*                                      RTCD(ERROR)                   */
*         RESPECIFY                                                0573
*          (GPR01P,                                                0573
*           GPR15F) RESTRICTED;                                    0573
*         GETLST01=GETLEN;          /* LENGTH                        */
         ST    GETLEN,GETLST01                                     0574
*         GETLST03=ADDR(DATAPTR);   /* ADDR OF ADDR LIST             */
         LA    @14,DATAPTR                                         0575
         STCM  @14,7,GETLST03                                      0575
*         GETLST05=78;              /* SUBPOOL VALUE                 */
         MVI   GETLST05,X'4E'                                      0576
*         GPR01P=ADDR(GETLST);      /* REG1 POINTS TO LIST           */
         LA    GPR01P,GETLST                                       0577
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0578
*         ERROR=GPR15F;             /* SET RETURN CODE               */
         ST    GPR15F,ERROR                                        0579
*         RESPECIFY                                                0580
*          (GPR01P,                                                0580
*           GPR15F) UNRESTRICTED;                                  0580
*       END;                        /* GETMAIN LV(GETLEN) A(DATAPTR)
*                                      SP(78) MF(E,GETLST)         0581
*                                      RTCD(ERROR)                   */
*       IF ERROR^=F0 THEN           /* GETMAIN ERROR ?               */
         L     @03,ERROR                                           0582
         LTR   @03,@03                                             0582
         BZ    @RF00582                                            0582
*         ERROR=E16;                /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00082                                   0583
*       ELSE                        /* OTHER WISE GETMAIN OK         */
*         DO;                       /* FILL IN GOTTEN CORE           */
         B     @RC00582                                            0584
@RF00582 DS    0H                                                  0585
*           EXDLMPTR=DATAPTR;       /* POINT TO AREA                 */
         L     @03,DATAPTR                                         0585
         L     @01,LSDPTR(,COMONPTR)                               0585
         L     @01,LSDEXEC(,@01)                                   0585
         ST    @03,EXDLMPTR(,@01)                                  0585
*           DLL=GETLEN;             /* FILL IN TOTAL LENGTH          */
         STH   GETLEN,DLL(,@03)                                    0586
*           DATAPTR=DATAPTR+F2;     /* SKIP FIRST DLL                */
         AL    @03,@CF00091                                        0587
         ST    @03,DATAPTR                                         0587
*           DO I=1 TO N;            /* MOVE DELIMS INTO BUFFER       */
         LA    @15,1                                               0588
         B     @DE00588                                            0588
@DL00588 DS    0H                                                  0589
*             DLL=DELIMLEN(I)+F2;   /* DELIM LL                      */
         L     @15,DATAPTR                                         0589
         L     @14,I(,COMONPTR)                                    0589
         SLA   @14,3                                               0589
         L     @07,DELIMLEN-8(@14)                                 0589
         LA    @06,2                                               0589
         ALR   @06,@07                                             0589
         STH   @06,DLL(,@15)                                       0589
*             IF DELIMLEN(I)>F0 THEN/* ATLEAST ONE DELIMETER         */
         LTR   @07,@07                                             0590
         BNP   @RF00590                                            0590
*               DC(1:DELIMLEN(I))=DELIMCH(1:DELIMLEN(I));/* COPY     */
         BCTR  @07,0                                               0591
         L     @01,DELIMPTR-8(@14)                                 0591
         EX    @07,@SM02661                                        0591
*             DATAPTR=DATAPTR+DLL;  /* POINT TO NEXT RECORD          */
@RF00590 L     @15,DATAPTR                                         0592
         LH    @14,DLL(,@15)                                       0592
         ALR   @14,@15                                             0592
         ST    @14,DATAPTR                                         0592
*           END;                    /*                               */
         LA    @15,1                                               0593
         AL    @15,I(,COMONPTR)                                    0593
@DE00588 ST    @15,I(,COMONPTR)                                    0593
         C     @15,N                                               0593
         BNH   @DL00588                                            0593
*           EXINSAVE=INSCODE;       /* SAVE CURRENT STACK OPTIONS    */
         L     @01,LSDPTR(,COMONPTR)                               0594
         L     @01,LSDEXEC(,@01)                                   0594
         L     @15,@PC00001+4                                      0594
         L     @15,ECTIOWA(,@15)                                   0594
         L     @15,IOSTELM(,@15)                                   0594
         MVC   EXINSAVE(1,@01),INSCODE(@15)                        0594
*           INSCODE=TERMDLM;        /* SET TO TERMINAL-EXEC          */
         MVI   INSCODE(@15),X'88'                                  0595
*           ERROR=E4;               /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00109                                   0596
*         END;                      /*                               */
*     END;                          /*                               */
*   END TERMRTN;                                                   0599
@EL00016 L     @13,4(,@13)                                         0599
@EF00016 DS    0H                                                  0599
@ER00016 LM    @14,@12,12(@13)                                     0599
         BR    @14                                                 0599
*                                                                  0600
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE RETURN CODE FROM &LASTCC                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*GETRC:                                                            0600
*   PROC;                                                          0600
GETRC    STM   @14,@12,@SA00017                                    0600
*   CALL COMLINK(LOCATE,LASTCC,LENGTH(LASTCC),F0);/*                 */
         LA    @01,@AL00601                                        0601
         BAL   @14,COMLINK                                         0601
*   IF ERROR=F0 THEN                /* LOCATE OK ?                   */
         L     @15,ERROR                                           0602
         LTR   @15,@15                                             0602
         BNZ   @RF00602                                            0602
*     DO;                           /* YES - CONVERT TO BINARY       */
*       ANSPTR=ADDR(SVTDATA);       /* POINT TO VALUE                */
         L     @01,SNTELPTR(,COMONPTR)                             0604
         L     @15,SNTVLPTR(,@01)                                  0604
         LA    @14,SVTDATA(,@15)                                   0604
         ST    @14,ANSPTR(,COMONPTR)                               0604
*       CLEN=SVTLNG;                /* LENGTH OF VALUE               */
         LH    @15,SVTLNG(,@15)                                    0605
         STH   @15,CLEN(,COMONPTR)                                 0605
*       IF CLEN=F4&ANSWER(1)=CCS THEN/* IF SYSTEM ABEND CODE         */
         C     @15,@CF00109                                        0606
         BNE   @RF00606                                            0606
         CLI   ANSWER(@14),C'S'                                    0606
         BNE   @RF00606                                            0606
*         DO;                       /*                               */
*           OUTA1(1:3)=ANSWER(2:4); /* COPY ANSWER                   */
         MVC   OUTA1(3),ANSWER+1(@14)                              0608
*           DO I=F3 TO F1 BY-F1;    /* RE-FOLD ANSWER                */
         LA    @15,3                                               0609
         ST    @15,I(,COMONPTR)                                    0609
@DL00609 DS    0H                                                  0610
*             IF(OUTA1(I)<CC0×OUTA1(I)>CC9)&/* NOT ZERO TO NINE      */
*                 (OUTA1(I)<CCA×OUTA1(I)>CCF) THEN/* NOT A-F         */
         L     @15,I(,COMONPTR)                                    0610
         LA    @14,OUTA1-1(@15)                                    0610
         CLI   0(@14),C'0'                                         0610
         BL    @GL00030                                            0610
         LA    @14,OUTA1-1(@15)                                    0610
         CLI   0(@14),C'9'                                         0610
         BNH   @RF00610                                            0610
@GL00030 L     @15,I(,COMONPTR)                                    0610
         LA    @14,OUTA1-1(@15)                                    0610
         CLI   0(@14),C'A'                                         0610
         BL    @RT00610                                            0610
         LA    @14,OUTA1-1(@15)                                    0610
         CLI   0(@14),C'F'                                         0610
         BNH   @RF00610                                            0610
@RT00610 DS    0H                                                  0611
*               ERROR=E964;         /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00615                                   0611
*             ELSE                  /* OTHERWISE                     */
*               IF OUTFX(I)<F239 THEN/* IF 'A'-'F'                   */
         B     @RC00610                                            0612
@RF00610 L     @15,I(,COMONPTR)                                    0612
         SLR   @14,@14                                             0612
         IC    @14,OUTFX-1(@15)                                    0612
         C     @14,@CF00516                                        0612
         BNL   @RF00612                                            0612
*                 OUTFX(I)=OUTFX(I)+F57;/* FOLD BACK                 */
         AL    @14,@CF00514                                        0613
         STC   @14,OUTFX-1(@15)                                    0613
*           END;                    /*                               */
@RF00612 DS    0H                                                  0614
@RC00610 SLR   @15,@15                                             0614
         BCTR  @15,0                                               0614
         AL    @15,I(,COMONPTR)                                    0614
         ST    @15,I(,COMONPTR)                                    0614
         LTR   @15,@15                                             0614
         BP    @DL00609                                            0614
*           PACK(AREA(1:4),OUTA1(1:4));/* PACK NUMBERS               */
         PACK  AREA(4),OUTA1(4)                                    0615
*           CNVTANS=AREA(1:3);      /* GET CODE                      */
         SLR   @15,@15                                             0616
         ICM   @15,7,AREA                                          0616
         ST    @15,CNVTANS(,COMONPTR)                              0616
*           RCABEND=YES;            /* SET ABEND FLAG                */
         OI    RCABEND(COMONPTR),B'10000000'                       0617
*           CNVTANS=CNVTANS*F4096;  /* SHIFT OVER 12 BITS            */
         SLA   @15,12                                              0618
         ST    @15,CNVTANS(,COMONPTR)                              0618
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE                     */
*         DO;                       /* PROCESS USER ABENDS AND RETCD */
         B     @RC00606                                            0620
@RF00606 DS    0H                                                  0621
*           IF CLEN=F5&ANSWER(1)=CCU THEN/* IF USERABEND             */
         LH    @15,CLEN(,COMONPTR)                                 0621
         C     @15,@CF00121                                        0621
         BNE   @RF00621                                            0621
         L     @14,ANSPTR(,COMONPTR)                               0621
         CLI   ANSWER(@14),C'U'                                    0621
         BNE   @RF00621                                            0621
*             DO;                   /* SET UP CONVERT PARMS          */
*               RCABEND=YES;        /* SET ABEND SWITCH              */
         OI    RCABEND(COMONPTR),B'10000000'                       0623
*               CLEN=CLEN-F1;       /* DECREMENT CLEN                */
         BCTR  @15,0                                               0624
         STH   @15,CLEN(,COMONPTR)                                 0624
*               ANSPTR=ANSPTR+F1;   /* INCREMENT ADDR                */
         AL    @14,@CF00042                                        0625
         ST    @14,ANSPTR(,COMONPTR)                               0625
*             END;                  /*                               */
*           CALL COMLINK(CONVERT);  /* CONVERT TO BINARY             */
@RF00621 LA    @01,@AL00627                                        0627
         BAL   @14,COMLINK                                         0627
*         END;                      /*                               */
*       IF ERROR^=F0 THEN           /* IF CONVERT NOT OK THEN        */
@RC00606 L     @15,ERROR                                           0629
         LTR   @15,@15                                             0629
         BZ    @RF00629                                            0629
*         ERROR=E964;               /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00615                                   0630
*     END;                          /*                               */
*   ELSE                            /* OTHER WISE                    */
*     ERROR=E999;                   /* SET INTERNAL CLIST ERROR      */
         B     @RC00602                                            0632
@RF00602 MVC   ERROR(4),@CF00619                                   0632
*   END GETRC;                                                     0633
@EL00017 DS    0H                                                  0633
@EF00017 DS    0H                                                  0633
@ER00017 LM    @14,@12,@SA00017                                    0633
         BR    @14                                                 0633
*                                                                  0634
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FUNCTION                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0634
*EXITRTN:                                                          0634
*   PROC OPTIONS(SAVEAREA);                                        0634
EXITRTN  STM   @14,@12,12(@13)                                     0634
         ST    @13,@SA00018+4                                      0634
         LA    @14,@SA00018                                        0634
         ST    @14,8(,@13)                                         0634
         LR    @13,@14                                             0634
*   CONTINU=NO;                     /* FORCE A RETURN TO GETLINE     */
         NI    CONTINU(COMONPTR),B'10111111'                       0635
*   SEPS=NO;                        /* INIT SEPS SWITCH              */
         NI    SEPS(COMONPTR),B'01111111'                          0636
*   IF ERRCMD=YES&ERRRANGE=YES THEN /* IF IN AN ERROR ACTION RANGE   */
         L     @01,LSDPTR(,COMONPTR)                               0637
         L     @01,LSDEXEC(,@01)                                   0637
         TM    ERRCMD(@01),B'01000000'                             0637
         BNO   @RF00637                                            0637
         TM    ERRRANGE(COMONPTR),B'00000100'                      0637
         BNO   @RF00637                                            0637
*     CALL GETRC;                   /* GET VALUE OF LASTCC           */
         BAL   @14,GETRC                                           0638
*   ELSE                            /* OTHERWISE                     */
*     CNVTANS=F0;                   /* TEMP ECTRTCD                  */
         B     @RC00637                                            0639
@RF00637 SLR   @15,@15                                             0639
         ST    @15,CNVTANS(,COMONPTR)                              0639
*   I=MYO2;                         /* START OF SCAN                 */
@RC00637 L     @15,MYO2(,COMONPTR)                                 0640
         ST    @15,I(,COMONPTR)                                    0640
*   DO WHILE ERROR=F0&SEPS=NO;      /* DO UNTIL DONE                 */
         B     @DE00641                                            0641
@DL00641 DS    0H                                                  0642
*     CALL COMLINK(FINDWORD);       /* FIND A WORD                   */
         LA    @01,@AL00642                                        0642
         BAL   @14,COMLINK                                         0642
*     MATCH=NO;                     /* RESET MATCH SWITCH            */
         NI    MATCH(COMONPTR),B'11101111'                         0643
*     IF SEPS=NO&(LEN>F4×LEN=F0) THEN/* IF LENGTH IS TOO LONG        */
         TM    SEPS(COMONPTR),B'10000000'                          0644
         BNZ   @RF00644                                            0644
         L     @15,LEN(,COMONPTR)                                  0644
         C     @15,@CF00109                                        0644
         BH    @RT00644                                            0644
         LTR   @15,@15                                             0644
         BNZ   @RF00644                                            0644
@RT00644 DS    0H                                                  0645
*       ERROR=E304;                 /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00545                                   0645
*     ELSE                          /* IF LENGTH IS OK               */
*       DO N=1 TO DIM(KYW) WHILE SEPS=NO&MATCH=NO;/* CHECK KEYWORD   */
         B     @RC00644                                            0646
@RF00644 LA    @15,1                                               0646
         ST    @15,N                                               0646
@DL00646 TM    SEPS(COMONPTR),B'10010000'                          0646
         BNZ   @DC00646                                            0646
*         IF KYW(N,1:LEN)=C(BEGIN:BEGIN-1+LEN) THEN/* KYWWORD MATCH  */
         LR    @14,@15                                             0647
         SLA   @14,2                                               0647
         L     @07,BEGIN(,COMONPTR)                                0647
         L     @06,BUFBASE(,COMONPTR)                              0647
         LR    @05,@07                                             0647
         BCTR  @05,0                                               0647
         AL    @05,LEN(,COMONPTR)                                  0647
         SLR   @05,@07                                             0647
         LA    @01,KYW-4(@14)                                      0647
         ALR   @06,@07                                             0647
         EX    @05,@SC02663                                        0647
         BNE   @RF00647                                            0647
*           DO;                     /*                               */
*             MATCH=YES;            /* FOUND A VALID KEYWORD         */
         OI    MATCH(COMONPTR),B'00010000'                         0649
*             IF N=F1 THEN          /* IF CODE KYWWORD               */
         C     @15,@CF00042                                        0650
         BNE   @RF00650                                            0650
*               DO;                 /* FIND VALUE                    */
*                 CALL COMLINK(SKIPSEPS);/* SKIP SEPARATORS          */
         LA    @01,@AL00652                                        0652
         BAL   @14,COMLINK                                         0652
*                 IF SEPS=YES×C(I)^=LPAREN THEN/* IF NO OPEN PAREN   */
         TM    SEPS(COMONPTR),B'10000000'                          0653
         BO    @RT00653                                            0653
         L     @01,I(,COMONPTR)                                    0653
         L     @15,BUFBASE(,COMONPTR)                              0653
         ALR   @15,@01                                             0653
         CLI   C-1(@15),C'('                                       0653
         BE    @RF00653                                            0653
@RT00653 DS    0H                                                  0654
*                   ERROR=E308;     /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00547                                   0654
*                 ELSE              /* IF OPEN PAREN                 */
*                   DO;             /* PROCESS VALUE                 */
         B     @RC00653                                            0655
@RF00653 DS    0H                                                  0656
*                     BUFPTR=ADDR(C(I-F1));/* BASE BUF               */
         L     @03,I(,COMONPTR)                                    0656
         L     @01,BUFBASE(,COMONPTR)                              0656
         LA    @15,C-2(@03,@01)                                    0656
         ST    @15,BUFPTR(,COMONPTR)                               0656
*                     CSAVE=BUF(1:F2);/* SAVE BUFFER                 */
         MVC   CSAVE(2),BUF(@15)                                   0657
*                     BUF(1:F2)=XEQUAL;/* DUMMY ASSIGN STMT          */
         MVC   BUF(2,@15),@CC00426                                 0658
*                     PCTR=F1;      /* INIT PAREN COUNTER            */
         LA    @15,1                                               0659
         LR    PCTR,@15                                            0659
*                     DO I=I+F1 TO LL-(F4+FREEAMT) WHILE PCTR>F0;/*  */
         ALR   @03,@15                                             0660
         B     @DE00660                                            0660
@DL00660 LTR   PCTR,PCTR                                           0660
         BNP   @DC00660                                            0660
*                       IF C(I)=LPAREN THEN/* IF AN OPEN PAREN       */
         L     @03,I(,COMONPTR)                                    0661
         L     @01,BUFBASE(,COMONPTR)                              0661
         ALR   @01,@03                                             0661
         CLI   C-1(@01),C'('                                       0661
         BNE   @RF00661                                            0661
*                         PCTR=PCTR+F1;/* ADD 1 TO PCTR              */
         AL    PCTR,@CF00042                                       0662
*                       ELSE        /* OTHERWISE                     */
*                         IF C(I)=RPAREN THEN/* IF A CLOSE PAREN     */
         B     @RC00661                                            0663
@RF00661 L     @03,I(,COMONPTR)                                    0663
         L     @01,BUFBASE(,COMONPTR)                              0663
         ALR   @01,@03                                             0663
         CLI   C-1(@01),C')'                                       0663
         BNE   @RF00663                                            0663
*                           PCTR=PCTR-F1;/* DECREMENT PCTR           */
         BCTR  PCTR,0                                              0664
*                     END;          /*                               */
@RF00663 DS    0H                                                  0665
@RC00661 LA    @03,1                                               0665
         AL    @03,I(,COMONPTR)                                    0665
@DE00660 ST    @03,I(,COMONPTR)                                    0665
         L     @01,BUFBASE(,COMONPTR)                              0665
         LA    @00,4                                               0665
         AL    @00,FREEAMT(,COMONPTR)                              0665
         LCR   @00,@00                                             0665
         AH    @00,LL(,@01)                                        0665
         CR    @03,@00                                             0665
         BNH   @DL00660                                            0665
@DC00660 DS    0H                                                  0666
*                     IF PCTR=F0 THEN/* LENGTH(NORMAL CASE)  @ZA03880*/
         LTR   PCTR,PCTR                                           0666
         BNZ   @RF00666                                            0666
*                       CLEN=ADDR(C(I))-(BUFPTR+F1);/*       @ZA03880*/
         L     @01,I(,COMONPTR)                                    0667
         L     @15,BUFBASE(,COMONPTR)                              0667
         LA    @15,C-1(@01,@15)                                    0667
         LA    @14,1                                               0667
         AL    @14,BUFPTR(,COMONPTR)                               0667
         SLR   @15,@14                                             0667
         STH   @15,CLEN(,COMONPTR)                                 0667
*                     ELSE          /* LENGTH(NO RT PAREN)   @ZA03880*/
*                       CLEN=ADDR(C(I))-BUFPTR;/*            @ZA03880*/
         B     @RC00666                                            0668
@RF00666 L     @01,I(,COMONPTR)                                    0668
         L     @15,BUFBASE(,COMONPTR)                              0668
         LA    @15,C-1(@01,@15)                                    0668
         SL    @15,BUFPTR(,COMONPTR)                               0668
         STH   @15,CLEN(,COMONPTR)                                 0668
*                     TYPE=F0;      /* SET ASSIGN TYPE               */
@RC00666 SLR   @15,@15                                             0669
         ST    @15,TYPE(,COMONPTR)                                 0669
*                     RFY                                          0670
*                      (R15) RSTD;  /* RESTRICT RETURN CODE REG      */
*                     CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* CALL   0671
*                                      EVALUATE                      */
         L     @14,BUFPTR(,COMONPTR)                               0671
         ST    @14,@AL00001                                        0671
         LA    @14,CLEN(,COMONPTR)                                 0671
         ST    @14,@AL00001+4                                      0671
         LA    @14,TYPE(,COMONPTR)                                 0671
         ST    @14,@AL00001+8                                      0671
         LA    @14,OUTA1                                           0671
         ST    @14,@AL00001+12                                     0671
         L     @15,@CV00128                                        0671
         LA    @01,@AL00001                                        0671
         BALR  @14,@15                                             0671
*                     ERROR=R15;    /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0672
*                     RFY                                          0673
*                      (R15) UNRSTD;/* RELEASE RETURN CODE REG       */
*                     BUF(1:F2)=CSAVE;/* RESTORE BUFFER              */
         L     @01,BUFPTR(,COMONPTR)                               0674
         MVC   BUF(2,@01),CSAVE                                    0674
*                     RCABEND=NO;   /* CLEAR ABEND FLAG              */
         NI    RCABEND(COMONPTR),B'01111111'                       0675
*                     IF ERROR=F0 THEN/* IF EVALUATE OK              */
         L     @15,ERROR                                           0676
         LTR   @15,@15                                             0676
         BNZ   @RF00676                                            0676
*                       CALL COMLINK(CONVERT);/* CONVERT ANSWER      */
         LA    @01,@AL00677                                        0677
         BAL   @14,COMLINK                                         0677
*                   END;            /*                               */
*               END;                                               0679
*             ELSE                  /* OTHERWISE                     */
*               IF N=F2 THEN        /* IF QUIT                       */
         B     @RC00650                                            0680
@RF00650 CLC   N(4),@CF00091                                       0680
         BNE   @RF00680                                            0680
*                 QUIT=YES;         /* SET QUIT SWITCH               */
         OI    QUIT(COMONPTR),B'00100000'                          0681
*           END;                                                   0682
@RF00680 DS    0H                                                  0682
@RC00650 DS    0H                                                  0683
*       END;                                                       0683
@RF00647 LA    @15,1                                               0683
         AL    @15,N                                               0683
         ST    @15,N                                               0683
         C     @15,@CF00091                                        0683
         BNH   @DL00646                                            0683
@DC00646 DS    0H                                                  0684
*     IF ERROR=F0&MATCH=NO&SEPS=NO THEN/* IF NOT A VALID KYWD        */
@RC00644 L     @15,ERROR                                           0684
         LTR   @15,@15                                             0684
         BNZ   @RF00684                                            0684
         TM    MATCH(COMONPTR),B'10010000'                         0684
         BNZ   @RF00684                                            0684
*       ERROR=E304;                 /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00545                                   0685
*   END;                                                           0686
@RF00684 DS    0H                                                  0686
@DE00641 L     @15,ERROR                                           0686
         LTR   @15,@15                                             0686
         BNZ   @DC00641                                            0686
         TM    SEPS(COMONPTR),B'10000000'                          0686
         BZ    @DL00641                                            0686
@DC00641 DS    0H                                                  0687
*   IF ERROR=F0 THEN                /* IF OK SO FAR                  */
         L     @15,ERROR                                           0687
         LTR   @15,@15                                             0687
         BNZ   @RF00687                                            0687
*     DO;                           /* DELETE AN ELEMENT OR          */
*       ECTRTCD=CNVTANS;            /* SET ECT RETURN CODE FIELD     */
         L     @15,@PC00001+4                                      0689
         MVC   ECTRTCD(3,@15),CNVTANS+1(COMONPTR)                  0689
*       IF RCABEND=YES THEN         /* IF DEFAULT IS ABEND           */
         TM    RCABEND(COMONPTR),B'10000000'                       0690
         BNO   @RF00690                                            0690
*         ECTRCDF=ABNDFLG;          /* SET ABEND CODE                */
         MVI   ECTRCDF(@15),X'80'                                  0691
*       ELSE                        /* OTHERWISE                     */
*         ECTRCDF=''B;              /* CLEAR ABEND CODE              */
         B     @RC00690                                            0692
@RF00690 L     @15,@PC00001+4                                      0692
         MVI   ECTRCDF(@15),X'00'                                  0692
*       ERROR=E4;                   /* FLUSH THE STACK               */
@RC00690 MVC   ERROR(4),@CF00109                                   0693
*       CMAIN=NO;                   /* CLEAR MAIN OPTION             */
*       NOFLUSH=NO;                 /* CLEAR NOFLUSH                 */
         L     @01,LSDPTR(,COMONPTR)                               0695
         L     @01,LSDEXEC(,@01)                                   0695
         NI    CMAIN(@01),B'11011011'                              0695
*       RFY                                                        0696
*        (R1) RSTD;                 /* RESTRICT PARM REG             */
*       R1=ADDR(IOPL);              /* PARM LIST                     */
         LR    R1,COMONPTR                                         0697
*       IF SUSPENDI^=F0 THEN        /* IF THERE ARE SUSPENDED ELMTS
*                                                            @ZA08099*/
         L     @15,@PC00001+16                                     0698
         ICM   @14,15,SUSPENDI(@15)                                0698
         LTR   @14,@14                                             0698
         BZ    @RF00698                                            0698
*         DO;                       /* THEN DELETE THEM      @ZA08099*/
*           EXITSTMT=YES;           /* GETLINE INDICATOR OF EXIT   0700
*                                                            @ZA08099*/
         OI    EXITSTMT(@15),B'00100000'                           0700
*           IOPL(4)=ADDR(STACKD);   /* ONE AT A TIME         @ZA08099*/
         LA    @03,STACKD                                          0701
         ST    @03,IOPL+12(,COMONPTR)                              0701
*           DLBASE=IOSTELM;         /* CURRENT ELMT          @ZA08099*/
         L     @15,@PC00001+4                                      0702
         L     @15,ECTIOWA(,@15)                                   0702
         L     DLBASE,IOSTELM(,@15)                                0702
*           IOSTELM=SUSPENDI;       /* FIRST ELMT TO DELETE  @ZA08099*/
         ST    @14,IOSTELM(,@15)                                   0703
*           DO WHILE DLBASE^=IOSTELM;/*                      @ZA08099*/
         B     @DE00704                                            0704
@DL00704 DS    0H                                                  0705
*             RFY                                                  0705
*               LSD BASED(INSADLSD);/*                       @ZA08099*/
*             IF INSEXEC=YES THEN   /* IGNORE MAIN CLIST     @ZA08099*/
         L     @03,@PC00001+4                                      0706
         L     @03,ECTIOWA(,@03)                                   0706
         L     @03,IOSTELM(,@03)                                   0706
         TM    INSEXEC(@03),B'00001000'                            0706
         BNO   @RF00706                                            0706
*               CMAIN=NO;           /*                       @ZA08099*/
         L     @03,INSADLSD-1(,@03)                                0707
         L     @03,LSDEXEC(,@03)                                   0707
         NI    CMAIN(@03),B'11111011'                              0707
*             CALL IKJEFT30;        /* REMOVE ELEMENT        @ZA08099
*                                      STACK SERRTN ADJUSTS IOSTELM
*                                                            @ZA08099*/
@RF00706 L     @15,@CV00129                                        0708
         BALR  @14,@15                                             0708
*             RFY                                                  0709
*               LSD BASED(LSDPTR);  /*                       @ZA08099*/
*           END;                    /*                       @ZA08099*/
@DE00704 L     @03,@PC00001+4                                      0710
         L     @03,ECTIOWA(,@03)                                   0710
         C     DLBASE,IOSTELM(,@03)                                0710
         BNE   @DL00704                                            0710
*         END;                      /*                       @ZA08099*/
*       IF QUIT=YES THEN            /* IF FLUSHING                   */
@RF00698 TM    QUIT(COMONPTR),B'00100000'                          0712
         BNO   @RF00712                                            0712
*         IOPL(4)=ADDR(STFLUSH);    /* FLUSH PARM BLOCK              */
         LA    @00,STFLUSH                                         0713
         ST    @00,IOPL+12(,COMONPTR)                              0713
*       ELSE                        /* OTHERWISE ONLY DELETE         */
*         IOPL(4)=ADDR(STACKD);     /* PARM BLOCK                    */
         B     @RC00712                                            0714
@RF00712 LA    @00,STACKD                                          0714
         ST    @00,IOPL+12(,COMONPTR)                              0714
*       CALL IKJEFT30;              /* THE TOP ELEMENT               */
@RC00712 L     @15,@CV00129                                        0715
         BALR  @14,@15                                             0715
*       RFY                                                        0716
*        (R1) UNRSTD;               /* RELEASE PARM REG              */
*     END;                                                         0717
*   RCABEND=NO;                     /* INSURE ABEND FLAG IS NOT ON   */
@RF00687 NI    RCABEND(COMONPTR),B'01111111'                       0718
*   END EXITRTN;                                                   0719
@EL00018 L     @13,4(,@13)                                         0719
@EF00018 DS    0H                                                  0719
@ER00018 LM    @14,@12,12(@13)                                     0719
         BR    @14                                                 0719
*                                                                  0720
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE FILENAME ON FILEDCBS CHAIN                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0720
*LOCFILE:                                                          0720
*   PROC;                                                          0720
LOCFILE  STM   @14,@01,@SA00019                                    0720
         STM   @03,@12,@SA00019+16                                 0720
*   I=MYO2;                         /* START OF SCAN                 */
         L     @03,MYO2(,COMONPTR)                                 0721
         ST    @03,I(,COMONPTR)                                    0721
*   PREVFILE=ADDR(FILEDCBS);        /* POINT TO START OF CHAIN       */
         L     @01,LSDPTR(,COMONPTR)                               0722
         L     PREVFILE,LSDEXEC(,@01)                              0722
         LA    PREVFILE,FILEDCBS(,PREVFILE)                        0722
*   CALL COMLINK(FINDFILE);         /* FIND DDNAME           @ZA17843*/
         LA    @01,@AL00723                                        0723
         BAL   @14,COMLINK                                         0723
*   IF SEPS=YES×LEN=F0×LEN>F8 THEN  /* IF INVALID                    */
         TM    SEPS(COMONPTR),B'10000000'                          0724
         BO    @RT00724                                            0724
         L     @03,LEN(,COMONPTR)                                  0724
         LTR   @03,@03                                             0724
         BZ    @RT00724                                            0724
         C     @03,@CF00087                                        0724
         BNH   @RF00724                                            0724
@RT00724 DS    0H                                                  0725
*     ERROR=E332;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00559                                   0725
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* FIND FILE ON WUE              */
         B     @RC00724                                            0726
@RF00724 DS    0H                                                  0727
*       NAMESAV=C(BEGIN:BEGIN-F1+LEN);/* SAVE FILE NAME              */
         MVI   NAMESAV+1,C' '                                      0727
         MVC   NAMESAV+2(6),NAMESAV+1                              0727
         L     @03,BEGIN(,COMONPTR)                                0727
         LR    @15,@03                                             0727
         BCTR  @15,0                                               0727
         L     @14,LEN(,COMONPTR)                                  0727
         ALR   @15,@14                                             0727
         SLR   @15,@03                                             0727
         L     @01,BUFBASE(,COMONPTR)                              0727
         ALR   @01,@03                                             0727
         EX    @15,@SM02665                                        0727
*       NAMELEN=LEN;                /* SAVE NAME LENGTH              */
         ST    @14,NAMELEN                                         0728
*       MATCH=NO;                   /* INIT SWITCH                   */
         NI    MATCH(COMONPTR),B'11101111'                         0729
*       FILEPTR=FILEDCBS;           /* START AT FILEDCBS             */
         L     @03,LSDPTR(,COMONPTR)                               0730
         L     @03,LSDEXEC(,@03)                                   0730
         L     @03,FILEDCBS(,@03)                                  0730
         ST    @03,FILEPTR                                         0730
*       DO WHILE FILEPTR^=F0&MATCH=NO;/* DO UNTIL FOUND              */
         B     @DE00731                                            0731
@DL00731 DS    0H                                                  0732
*         IF FILENAME=NAMESAV THEN  /* IF FOUND                      */
         L     @03,FILEPTR                                         0732
         CLC   FILENAME(8,@03),NAMESAV                             0732
         BNE   @RF00732                                            0732
*           MATCH=YES;              /* EXIT                          */
         OI    MATCH(COMONPTR),B'00010000'                         0733
*         ELSE                      /* OTHERWISE                     */
*           DO;                     /* GET NEXT FILE PTR             */
         B     @RC00732                                            0734
@RF00732 DS    0H                                                  0735
*             PREVFILE=FILEPTR;     /* SAVE PREVIOUS                 */
         L     @15,FILEPTR                                         0735
         LR    PREVFILE,@15                                        0735
*             FILEPTR=NEXTFILE;     /* GET NEXT                      */
         L     @03,NEXTFILE(,@15)                                  0736
         ST    @03,FILEPTR                                         0736
*           END;                    /*                               */
*       END;                        /*                               */
@RC00732 DS    0H                                                  0738
@DE00731 L     @03,FILEPTR                                         0738
         LTR   @03,@03                                             0738
         BZ    @DC00731                                            0738
         TM    MATCH(COMONPTR),B'00010000'                         0738
         BZ    @DL00731                                            0738
@DC00731 DS    0H                                                  0739
*     END;                          /*                               */
*   END LOCFILE;                    /* END LOCATE FILE               */
@EL00019 DS    0H                                                  0740
@EF00019 DS    0H                                                  0740
@ER00019 LM    @14,@01,@SA00019                                    0740
         LM    @03,@12,@SA00019+16                                 0740
         BR    @14                                                 0740
*                                                                  0741
*   /*****************************************************************/
*   /*                                                               */
*   /* OPEN A FILE AND PLACE ON FILE DCB CHAIN                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0741
*OPENRTN:                                                          0741
*   PROC;                                                          0741
OPENRTN  STM   @14,@12,@SA00020                                    0741
*   CALL LOCFILE;                   /* GET FILE NAME TO USE          */
         BAL   @14,LOCFILE                                         0742
*   IF ERROR=F0&MATCH=YES THEN      /* IF FILE ALREADY OPEN          */
         L     @15,ERROR                                           0743
         LTR   @15,@15                                             0743
         BNZ   @RF00743                                            0743
         TM    MATCH(COMONPTR),B'00010000'                         0743
         BNO   @RF00743                                            0743
*     ERROR=E336;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00561                                   0744
*   IF ERROR=F0 THEN                /* IF OK SO FAR                  */
@RF00743 L     @15,ERROR                                           0745
         LTR   @15,@15                                             0745
         BNZ   @RF00745                                            0745
*     DO;                           /* PROCESS OPEN                  */
*       DO;                         /* GETMAIN                     0747
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 0747
*                                      A(FILEPTR) SP(78) MF(E,GETLST)*/
*         RESPECIFY                                                0748
*          (GPR01P) RESTRICTED;                                    0748
*         GETLST01=LENGTH(FILEBLOK)+DCBLEN;/* LENGTH                 */
         LA    @00,20                                              0749
         AL    @00,DCBLEN                                          0749
         ST    @00,GETLST01                                        0749
*         GETLST03=ADDR(FILEPTR);   /* ADDR OF ADDR LIST             */
         LA    @00,FILEPTR                                         0750
         STCM  @00,7,GETLST03                                      0750
*         GETLST05=78;              /* SUBPOOL VALUE                 */
         MVI   GETLST05,X'4E'                                      0751
*         GPR01P=ADDR(GETLST);      /* REG1 POINTS TO LIST           */
         LA    GPR01P,GETLST                                       0752
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0753
*         RESPECIFY                                                0754
*          (GPR01P) UNRESTRICTED;                                  0754
*       END;                        /* GETMAIN                     0755
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 0755
*                                      A(FILEPTR) SP(78) MF(E,GETLST)
*                                      FILEBLOK                      */
*       IF ERROR^=F0 THEN           /* IF GETMAIN FAILED             */
         L     @15,ERROR                                           0756
         LTR   @15,@15                                             0756
         BZ    @RF00756                                            0756
*         ERROR=E16;                /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00082                                   0757
*       ELSE                        /* OTHERWISE                     */
*         DO;                       /* CONTINUE WITH OPEN            */
         B     @RC00756                                            0758
@RF00756 DS    0H                                                  0759
*           FILEBLOK=''B;           /* CLEAR FILEBLOK                */
         L     @15,FILEPTR                                         0759
         XC    FILEBLOK(20,@15),FILEBLOK(@15)                      0759
*           FILENAME=NAMESAV;       /* SET DDNAME IN FILEBLOK        */
         MVC   FILENAME(8,@15),NAMESAV                             0760
*           CALL COMLINK(FINDWORD); /* FIND OPEN OPTION              */
         LA    @01,@AL00761                                        0761
         BAL   @14,COMLINK                                         0761
*           IF SEPS=NO&(LEN=F0×LEN>F6) THEN/* IF INVALID OPTION      */
         TM    SEPS(COMONPTR),B'10000000'                          0762
         BNZ   @RF00762                                            0762
         L     @15,LEN(,COMONPTR)                                  0762
         LTR   @15,@15                                             0762
         BZ    @RT00762                                            0762
         C     @15,@CF00146                                        0762
         BNH   @RF00762                                            0762
@RT00762 DS    0H                                                  0763
*             ERROR=E340;           /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00563                                   0763
*           ELSE                    /* OTHERWISE                     */
*             DO;                   /* CONTINUE WITH PROCESSING      */
         B     @RC00762                                            0764
@RF00762 DS    0H                                                  0765
*               IF SEPS=YES THEN    /* IF NO OPTION                  */
         TM    SEPS(COMONPTR),B'10000000'                          0765
         BNO   @RF00765                                            0765
*                 DO;               /* DEFAULT TO INPUT              */
*                   KEYINDX=F2;     /* SET TO TWO                    */
         LA    KEYINDX,2                                           0767
*                   MATCH=YES;      /* OPTION FOUND                  */
         OI    MATCH(COMONPTR),B'00010000'                         0768
*                 END;              /*                               */
*               ELSE                /* OTHERWISE                     */
*                 DO KEYINDX=F1 TO DIM(KEYNAME) WHILE MATCH=NO;    0770
         B     @RC00765                                            0770
@RF00765 LA    KEYINDX,1                                           0770
@DL00770 TM    MATCH(COMONPTR),B'00010000'                         0770
         BNZ   @DC00770                                            0770
*                   IF KEYNAME(KEYINDX,1:LEN)=/* IF:KEYWORD IS       */
*                       C(BEGIN:BEGIN-F1+LEN) THEN/* A MATCH         */
         LR    @05,KEYINDX                                         0771
         SLA   @05,4                                               0771
         L     @15,BEGIN(,COMONPTR)                                0771
         L     @14,BUFBASE(,COMONPTR)                              0771
         LR    @07,@15                                             0771
         BCTR  @07,0                                               0771
         AL    @07,LEN(,COMONPTR)                                  0771
         SLR   @07,@15                                             0771
         LA    @01,KEYNAME-16(@05)                                 0771
         ALR   @14,@15                                             0771
         EX    @07,@SC02667                                        0771
         BNE   @RF00771                                            0771
*                     MATCH=YES;    /* YES WE FOUND OPEN TYPE        */
         OI    MATCH(COMONPTR),B'00010000'                         0772
*                 END;              /*                               */
@RF00771 AL    KEYINDX,@CF00042                                    0773
         C     KEYINDX,@CF00136                                    0773
         BNH   @DL00770                                            0773
@DC00770 DS    0H                                                  0774
*               IF MATCH=NO THEN    /* IF NOT FOUND                  */
@RC00765 TM    MATCH(COMONPTR),B'00010000'                         0774
         BNZ   @RF00774                                            0774
*                 ERROR=E344;       /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00565                                   0775
*               ELSE                /* OTHERWISE                     */
*                 DO;               /* CONTINUE WITH OPEN            */
*                                                                  0776
         B     @RC00774                                            0776
@RF00774 DS    0H                                                  0777
*                   /*************************************************/
*                   /*                                               */
*                   /* DETERMINE IF DATA SET HAS EVER BEEN USED--    */
*                   /*                                       @ZA15726*/
*                   /* SEARCH DSAB CHAIN FOR PROPER TIOT ENTRY.      */
*                   /*                                       @ZA15726*/
*                   /* FROM TIOT ENTRY, GET UCB TO FIND VOLID.       */
*                   /*                                       @ZA15726*/
*                   /* ISSUE 'RDJFCB' TO GET PROPER JFCB.    @ZA15726*/
*                   /* FROM JFCB, GET DSNAME.                @ZA15726*/
*                   /* ISSUE 'OBTAIN' FOR FORMAT 1 DSCB.     @ZA15726*/
*                   /* FROM DSCB, CHECK 'DS1LSTAR' FIELD     @ZA15726*/
*                   /* FOR ZERO(DATA SET NEVER WRITTEN INTO) @ZA15726*/
*                   /* IF 'DS1LSTAR' IS ZERO, SET 'EMPTY' FLAG TO    */
*                   /*                                       @ZA15726*/
*                   /* PROHIBIT ISSUING 'GET' UNTIL AT LEAST @ZA15726*/
*                   /* ONE 'PUT' HAS BEEN DONE.              @ZA15726*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0777
*                   BYPASS='0'B;    /* INIT BYPASS FLAG      @ZA15726*/
*                   EXIT='0'B;      /* INIT LOOP CONTROL     @ZA15726*/
         NI    BYPASS,B'00111111'                                  0778
*                   DSABPTR=QDBFELMP;/* INIT DSAB POINTER    @ZA15726*/
*                                                                  0779
         L     @05,CVTPTR                                          0779
         L     @05,CURTCBP(,@05)                                   0779
         L     @05,TCBPTR(,@05)                                    0779
         L     @05,TCBJSCB(,@05)                                   0779
         L     @05,JSCDSABQ(,@05)                                  0779
         L     DSABPTR,QDBFELMP(,@05)                              0779
*                   /*************************************************/
*                   /*                                               */
*                   /* SEARCH DSAB CHAIN UNTIL TIOT ENTRY FOUND      */
*                   /*                                       @ZA15726*/
*                   /* OR END OF CHAIN(ERROR)                @ZA15726*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0780
*                   DO WHILE(DSABPTR^=0&EXIT='0'B);                0780
         B     @DE00780                                            0780
@DL00780 DS    0H                                                  0781
*                     IF TIOEDDNM=NAMESAV/* TIOT ENTRY FOUND?      0781
*                                                            @ZA15726*/
*                       THEN                                       0781
         L     @05,DSABTIOT(,DSABPTR)                              0781
         SL    @05,@CF00181                                        0781
         CLC   TIOEDDNM(8,@05),NAMESAV                             0781
         BNE   @RF00781                                            0781
*                       DO;         /* YES                   @ZA15726*/
*                         EXIT='1'B;/* EXIT FROM LOOP        @ZA15726*/
         OI    EXIT,B'10000000'                                    0783
*                         IF TIOFERT^=0 THEN/* IF UCBPTR     @ZA15726*/
         L     @03,TIOFERT                                         0784
         LTR   @03,@03                                             0784
         BZ    @RF00784                                            0784
*                           VOLID=UCBVOLI;/* SAVE VOLID FROM UCB   0785
*                                                            @ZA15726*/
         L     @05,TIOEFSRT-1(,@05)                                0785
         MVC   VOLID(6),UCBVOLI(@05)                               0785
*                         ELSE                                     0786
*                           BYPASS='1'B;/* SKIP CHECK, OK    @ZA15726*/
         B     @RC00784                                            0786
@RF00784 OI    BYPASS,B'01000000'                                  0786
*                       END;        /* END ENTRY FOUND       @ZA15726*/
*                     ELSE          /*                       @ZA15726*/
*                       DSABPTR=DSABFCHN;/* GO TO NEXT DSAB  @ZA15726*/
         B     @RC00781                                            0788
@RF00781 L     DSABPTR,DSABFCHN(,DSABPTR)                          0788
*                   END;            /* END DSAB LOOP         @ZA15726*/
@RC00781 DS    0H                                                  0789
@DE00780 LTR   DSABPTR,DSABPTR                                     0789
         BZ    @DC00780                                            0789
         TM    EXIT,B'10000000'                                    0789
         BZ    @DL00780                                            0789
@DC00780 DS    0H                                                  0790
*                   IF EXIT='0'B    /* IF FILE NOT FOUND     @ZA15726*/
*                     THEN          /*                       @ZA15726*/
         TM    EXIT,B'10000000'                                    0790
         BNZ   @RF00790                                            0790
*                     ERROR=E332;   /* FILE NOT ALLOCATED    @ZA15726*/
         MVC   ERROR(4),@CF00559                                   0791
*                   ELSE                                           0792
*                     DO;           /* CONTINUE WITH OBTAIN  @ZA15726*/
         B     @RC00790                                            0792
@RF00790 DS    0H                                                  0793
*                       IF BYPASS='1'B THEN/* SKIP CHECK?    @ZA15726*/
         TM    BYPASS,B'01000000'                                  0793
         BNO   @RF00793                                            0793
*                         EMPTY='0'B;/* YES                  @ZA15726*/
         L     @05,FILEPTR                                         0794
         NI    EMPTY(@05),B'11101111'                              0794
*                       ELSE                                       0795
*                         DO;       /* NO                    @ZA15726*/
         B     @RC00793                                            0795
@RF00793 DS    0H                                                  0796
*                           DCBPTR=ADDR(DCBAREA);/* POINT TO DCB   0796
*                                                            @ZA15726*/
         L     @05,FILEPTR                                         0796
         LA    DCBPTR,DCBAREA(,@05)                                0796
*                           DCBAREA(1:DCBLEN)=DCBI(1:DCBLEN);/*    0797
*                                                            @ZA15726*/
         L     @15,DCBLEN                                          0797
         BCTR  @15,0                                               0797
         EX    @15,@SM02669                                        0797
*                           DCBDDNAM=NAMESAV;/* FILL IN DCB DDNAME 0798
*                                                            @ZA15726*/
         MVC   DCBDDNAM+40(8,DCBPTR),NAMESAV                       0798
*                           EXITPARM='87'X;/* JFCB EXIT ROUTINE    0799
*                                                            @ZA15726*/
         MVI   EXITPARM,X'87'                                      0799
*                           EXITADDR=ADDR(OURJFCB);/* JFCB AREA    0800
*                                                            @ZA15726*/
         LA    @05,OURJFCB                                         0800
         STCM  @05,7,EXITADDR                                      0800
*                           DCBEXLSA=ADDR(EXITPRMS);/* FILL IN DCB 0801
*                                                            @ZA15726*/
         LA    @05,EXITPRMS                                        0801
         STCM  @05,7,DCBEXLSA+28(DCBPTR)                           0801
*                           RDJL=RDJC;/* COPY RDJFCB LIST FORM     0802
*                                                            @ZA15726*/
         MVC   RDJL(4),RDJC                                        0802
*                           RDJL(2:4)=DCBPTR;/* STORE DCB PTR      0803
*                                                            @ZA15726*/
         STCM  DCBPTR,7,RDJL+1                                     0803
*                           GEN(RDJFCB MF=(E,RDJL));/* READ JFCB   0804
*                                                            @ZA15726*/
         RDJFCB MF=(E,RDJL)
*                           JFCBPTR=ADDR(OURJFCB);/* COPY OF JFCB  0805
*                                                            @ZA15726*/
         LA    JFCBPTR,OURJFCB                                     0805
*                           DSNAME=JFCBDSNM;/* SAVE DSNAME   @ZA15726*/
         MVC   DSNAME(44),JFCBDSNM(JFCBPTR)                        0806
*                           OBTNLST=OBTLIST;/* COPY OBTAIN PARMS   0807
*                                                            @ZA15726*/
         MVC   OBTNLST(16),OBTLIST                                 0807
*                           DSNPTR=ADDR(DSNAME);/* PTR TO DSNAME   0808
*                                                            @ZA15726*/
         LA    @05,DSNAME                                          0808
         ST    @05,DSNPTR                                          0808
*                           VOLPTR=ADDR(VOLID);/* PTR TO VOLID     0809
*                                                            @ZA15726*/
         LA    @05,VOLID                                           0809
         ST    @05,VOLPTR                                          0809
*                           WKPTR=ADDR(WKAREA);/* PTR TO WORK AREA 0810
*                                                            @ZA15726*/
         LA    @05,WKAREA                                          0810
         ST    @05,WKPTR                                           0810
*                           GEN(OBTAIN OBTNLST);/* OBTAIN DSCB     0811
*                                                            @ZA15726*/
         OBTAIN OBTNLST
*                           IF R15^=0/* OBTAIN FAILED        @ZA15726*/
*                             THEN  /*                       @ZA15726*/
         LTR   R15,R15                                             0812
         BZ    @RF00812                                            0812
*                             ERROR=E332;/* INVALID FILENAME @ZA15726*/
         MVC   ERROR(4),@CF00559                                   0813
*                           ELSE                                   0814
*                             DO;   /* CONTINUE WITH DS CHECKS     0814
*                                                            @ZA15726*/
         B     @RC00812                                            0814
@RF00812 DS    0H                                                  0815
*                               F1PTR=ADDR(WKAREA)-44;/* PTR TO DATA
*                                      PORTION OF DSCB       @ZA15726*/
         LA    F1PTR,WKAREA                                        0815
         SL    F1PTR,@CF00238                                      0815
*                               IF DS1LSTAR=0/* DATA SET UNUSED    0816
*                                                            @ZA15726*/
*                                 THEN                             0816
         ICM   @05,7,DS1LSTAR(F1PTR)                               0816
         BNZ   @RF00816                                            0816
*                                 EMPTY='1'B;/* MARK AS EMPTY      0817
*                                                            @ZA15726*/
         L     @05,FILEPTR                                         0817
         OI    EMPTY(@05),B'00010000'                              0817
*                               ELSE                               0818
*                                 EMPTY='0'B;/* MARK AS ALREADY USED
*                                                            @ZA15726*/
         B     @RC00816                                            0818
@RF00816 L     @05,FILEPTR                                         0818
         NI    EMPTY(@05),B'11101111'                              0818
*                             END;  /* END EMPTY CHECK       @ZA15726*/
@RC00816 DS    0H                                                  0820
*                         END;      /* END EMPTY CHECK       @ZA15726*/
@RC00812 DS    0H                                                  0821
*                       IF ERROR=F0 THEN/* STILL OK?         @ZA15726*/
@RC00793 L     @05,ERROR                                           0821
         LTR   @05,@05                                             0821
         BNZ   @RF00821                                            0821
*                         DO;       /* YES                   @ZA15726*/
*                           KEYINDX=KEYINDX-F1;/* DECREMENT KEYINDX
*                                      BY 1                          */
         BCTR  KEYINDX,0                                           0823
*                           DCBPTR=ADDR(DCBAREA);/* POINT TO DCB     */
         L     @05,FILEPTR                                         0824
         LA    DCBPTR,DCBAREA(,@05)                                0824
*                           DCBAREA(1:DCBLEN)=DCBC(1:DCBLEN);/* COPY
*                                      DCB                           */
         L     @02,DCBLEN                                          0825
         BCTR  @02,0                                               0825
         LR    @15,KEYINDX                                         0825
         SLA   @15,4                                               0825
         L     @01,PTRDCB-16(@15)                                  0825
         EX    @02,@SM02671                                        0825
*                           DCBDDNAM=NAMESAV;/* FILL IN DCB DDNAME   */
         MVC   DCBDDNAM+40(8,DCBPTR),NAMESAV                       0826
*                           EXITPARM=DCBEXIT;/* DCB EXIT ROUTINE     */
         MVI   EXITPARM,X'85'                                      0827
*                           EXITADDR=ADDR(OPENEXIT);/* ROUTINE FOR 0828
*                                      EXIT                          */
         LA    @02,OPENEXIT                                        0828
         STCM  @02,7,EXITADDR                                      0828
*                           DCBEXLSA=ADDR(EXITPRMS);/* FILL IN DCB   */
         LA    @02,EXITPRMS                                        0829
         STCM  @02,7,DCBEXLSA+28(DCBPTR)                           0829
*                           DCBSYNA=ADDR(SYNADXT);/* ADDR OF SYNAD 0830
*                                      EXIT                          */
         LA    @02,SYNADXT                                         0830
         STCM  @02,7,DCBSYNA+52(DCBPTR)                            0830
*                           OPENL(1:OPENLEN)=OPENC(1:OPENLEN);/* COPY
*                                      OPEN LIST                     */
         L     @02,OPENLEN                                         0831
         BCTR  @02,0                                               0831
         L     @01,PTROPEN-16(@15)                                 0831
         EX    @02,@SM02673                                        0831
*                           FLAGS=FLAGS×KEYFLGS(KEYINDX);/* SET FLAGS
*                                                            @ZA15726*/
         LA    @02,KEYFLGS-16(@15)                                 0832
         OC    FLAGS(2,@05),0(@02)                                 0832
*                           OPENL(2:4)=DCBPTR;/* PLACE INTO OPEN LIST*/
         STCM  DCBPTR,7,OPENL+1                                    0833
*                           GEN FLOWS(OPENEXIT)(OPEN   MF=(E,OPENL));
         OPEN   MF=(E,OPENL)
*                           MINBFLEN=DCBLRECL;/* SET MINIMUM BUFFER
*                                      LENGTH                        */
         LH    @02,DCBLRECL+72(,DCBPTR)                            0835
         L     @01,FILEPTR                                         0835
         STH   @02,MINBFLEN(,@01)                                  0835
*                           IF DCBOFOPN=NO THEN/* IF DCB DID NOT OPEN*/
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0836
         BNZ   @RF00836                                            0836
*                             ERROR=E348;/* SET ERROR CODE           */
         MVC   ERROR(4),@CF00567                                   0837
*                           ELSE    /* OTHERWISE                     */
*                             DO;   /* INSURE NAME IN TABLE          */
         B     @RC00836                                            0838
@RF00836 DS    0H                                                  0839
*                               CALL COMLINK(LOCATE,NAMESAV,NAMELEN,F8)
*                                   ;/* ADD                          */
         LA    @02,@CF00121                                        0839
         ST    @02,@AL00001                                        0839
         LA    @02,NAMESAV                                         0839
         ST    @02,@AL00001+4                                      0839
         LA    @02,NAMELEN                                         0839
         ST    @02,@AL00001+8                                      0839
         LA    @02,@CF00087                                        0839
         ST    @02,@AL00001+12                                     0839
         LA    @01,@AL00001                                        0839
         BAL   @14,COMLINK                                         0839
*                               IF ERROR=F0 THEN/* IF IN TABLE       */
         L     @02,ERROR                                           0840
         LTR   @02,@02                                             0840
         BNZ   @RF00840                                            0840
*                                 DO;/* INSURE DATA LENGTH           */
*                                   NODATA=YES;/* SET NODATA SWITCH  */
         OI    NODATA(COMONPTR),B'01000000'                        0842
*                                   CALL COMLINK(UPDATE,NAMESAV,EVAL(
*                                       MINBFLEN));                0843
         LA    @02,@CF00087                                        0843
         ST    @02,@AL00001                                        0843
         LA    @02,NAMESAV                                         0843
         ST    @02,@AL00001+4                                      0843
         L     @02,FILEPTR                                         0843
         LH    @02,MINBFLEN(,@02)                                  0843
         ST    @02,@AFTEMPS+8                                      0843
         LA    @02,@AFTEMPS+8                                      0843
         ST    @02,@AL00001+8                                      0843
         LA    @01,@AL00001                                        0843
         BAL   @14,COMLINK                                         0843
*                                   NODATA=NO;/* RESET SWITCH        */
         NI    NODATA(COMONPTR),B'10111111'                        0844
*                                 END;/*                             */
*                               IF ERROR^=F0 THEN/* IF A BAD RC FROM
*                                      LOC/UPDT                      */
@RF00840 L     @02,ERROR                                           0846
         LTR   @02,@02                                             0846
         BZ    @RF00846                                            0846
*                                 DO;/* CLOSE DOWN THE DCB           */
*                                   CLOSL(2:4)=DCBPTR;/* SET DCB ADDR*/
         STCM  DCBPTR,7,CLOSL+1                                    0848
*                                   GEN(CLOSE   MF=(E,CLOSL));/*     */
         CLOSE   MF=(E,CLOSL)
*                                 END;/*                             */
*                               ELSE                               0851
*                                 SNTNOSCN=YES;/* RE-SCAN NOT ALLOWED*/
         B     @RC00846                                            0851
@RF00846 L     @01,SNTELPTR(,COMONPTR)                             0851
         OI    SNTNOSCN(@01),B'00001000'                           0851
*                             END;  /*                       @ZA15726*/
@RC00846 DS    0H                                                  0853
*                         END;      /*                       @ZA15726*/
@RC00836 DS    0H                                                  0854
*                     END;          /*                               */
@RF00821 DS    0H                                                  0855
*                 END;              /*                               */
@RC00790 DS    0H                                                  0856
*             END;                  /*                               */
@RC00774 DS    0H                                                  0857
*           IF ERROR^=F0 THEN       /* IF ANY ERROR                  */
@RC00762 L     @15,ERROR                                           0857
         LTR   @15,@15                                             0857
         BZ    @RF00857                                            0857
*             DO;                   /* FREEMAIN                    0858
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 0858
*                                      A(FILEPTR) SP(78) MF(E,FRELST)*/
*               RESPECIFY                                          0859
*                (GPR01P) RESTRICTED;                              0859
*               FRELST02=LENGTH(FILEBLOK)+DCBLEN;/* LENGTH           */
         L     @15,DCBLEN                                          0860
         LA    @15,20(,@15)                                        0860
         STCM  @15,7,FRELST02                                      0860
*               FRELST04=ADDR(FILEPTR);/* ADDR OF ADDR LIST          */
         LA    @00,FILEPTR                                         0861
         STCM  @00,7,FRELST04                                      0861
*               FRELST06=78;        /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'4E'                                      0862
*               GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST           */
         LA    GPR01P,FRELST                                       0863
*               SVC(5);             /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0864
*               RESPECIFY                                          0865
*                (GPR01P) UNRESTRICTED;                            0865
*             END;                  /* FREEMAIN                    0866
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 0866
*                                      A(FILEPTR) SP(78) MF(E,FRELST)*/
*           ELSE                    /* OTHERWISE                     */
*             DO;                   /* CHAIN TO EXECDATA             */
         B     @RC00857                                            0867
@RF00857 DS    0H                                                  0868
*               NEXTFILE=FILEDCBS;  /* PLACE CURRENT CHAIN           */
         L     @15,FILEPTR                                         0868
         L     @01,LSDPTR(,COMONPTR)                               0868
         L     @14,LSDEXEC(,@01)                                   0868
         L     @07,FILEDCBS(,@14)                                  0868
         ST    @07,NEXTFILE(,@15)                                  0868
*               FILEDCBS=FILEPTR;   /* INSERT NEW FILEBLOK           */
         ST    @15,FILEDCBS(,@14)                                  0869
*               ERROR=E4;           /* SET GET NEXT RECORD           */
         MVC   ERROR(4),@CF00109                                   0870
*             END;                  /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
*   END OPENRTN;                    /* END OF OPEN RTN               */
@EL00020 DS    0H                                                  0874
@EF00020 DS    0H                                                  0874
@ER00020 LM    @14,@12,@SA00020                                    0874
         BR    @14                                                 0874
*                                                                  0875
*   /*****************************************************************/
*   /*                                                               */
*   /* GET A RECORD FROM SPECIFIED FILE AND PLACE IN DDVARIABLE      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0875
*GETRTN:                                                           0875
*   PROC;                           /* GET A RECORD ROUTINE          */
GETRTN   STM   @14,@12,@SA00021                                    0875
*   CALL LOCFILE;                   /* GET FILENAME                  */
         BAL   @14,LOCFILE                                         0876
*   IF ERROR=F0&(MATCH=NO×OKGET=NO) /* IF FILENAME NOT FOUND,        */
*     THEN                                                         0877
         L     @15,ERROR                                           0877
         LTR   @15,@15                                             0877
         BNZ   @RF00877                                            0877
         TM    MATCH(COMONPTR),B'00010000'                         0877
         BZ    @RT00877                                            0877
         L     @01,FILEPTR                                         0877
         TM    OKGET(@01),B'01000000'                              0877
         BNZ   @RF00877                                            0877
@RT00877 DS    0H                                                  0878
*     ERROR=E352;                   /* OR OKGET OFF SET ERROR CODE   */
         MVC   ERROR(4),@CF00569                                   0878
*   IF ERROR=F0&EMPTY=YES THEN      /* FILE EMPTY            @ZA15726*/
@RF00877 L     @15,ERROR                                           0879
         LTR   @15,@15                                             0879
         BNZ   @RF00879                                            0879
         L     @01,FILEPTR                                         0879
         TM    EMPTY(@01),B'00010000'                              0879
         BNO   @RF00879                                            0879
*     ERROR=E400;                   /* SET END OF FILE       @ZA15726*/
         MVC   ERROR(4),@CF00581                                   0880
*   IF ERROR=F0 THEN                /* IF ALL OK                     */
@RF00879 L     @15,ERROR                                           0881
         LTR   @15,@15                                             0881
         BNZ   @RF00881                                            0881
*     DO;                           /* CONTINUE PROCESS              */
*       DCBPTR=ADDR(DCBAREA);       /* POINT TO DCB TO USE           */
         L     DCBPTR,FILEPTR                                      0883
         LA    DCBPTR,DCBAREA(,DCBPTR)                             0883
*       IF DCBOFOPN=NO THEN         /* IF DCB NOT OPEN               */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0884
         BNZ   @RF00884                                            0884
*         ERROR=E356;               /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00571                                   0885
*       ELSE                        /* OTHERWISE                     */
*         DO;                       /* CONTINUE                      */
         B     @RC00884                                            0886
@RF00884 DS    0H                                                  0887
*           CALL COMLINK(LOCATE,NAMESAV,NAMELEN,F0);/* FIND NAME     */
         LA    @02,@CF00121                                        0887
         ST    @02,@AL00001                                        0887
         LA    @02,NAMESAV                                         0887
         ST    @02,@AL00001+4                                      0887
         LA    @02,NAMELEN                                         0887
         ST    @02,@AL00001+8                                      0887
         LA    @02,@CF00430                                        0887
         ST    @02,@AL00001+12                                     0887
         LA    @01,@AL00001                                        0887
         BAL   @14,COMLINK                                         0887
*           IF ERROR=F0 THEN        /* IF FOUND                      */
         L     @02,ERROR                                           0888
         LTR   @02,@02                                             0888
         BNZ   @RF00888                                            0888
*             DO;                   /* CONTINUE                      */
*               DCBEODA=ADDR(EOF);  /* SET EOF RETURN POINT          */
         LA    @02,EOF                                             0890
         STCM  @02,7,DCBEODA+28(DCBPTR)                            0890
*               ERROR=E400;         /* SET END OF FILE RC            */
         MVC   ERROR(4),@CF00581                                   0891
*               RFY                                                0892
*                (R1,                                              0892
*                 R2) RSTD;         /* RESTRICT REG 1,2              */
*               R2=DCBPTR;          /* ADDR OF DCB                   */
         LR    R2,DCBPTR                                           0893
*               GEN REFS(R2) SETS(R1) FLOWS(EOF,SYNADXT)(GET (R2));
         GET (R2)
*               PTRA=R1;            /* SET BASE OF I/O BFRS          */
         LR    PTRA,R1                                             0895
*               RFY                                                0896
*                (R1,                                              0896
*                 R2) UNRSTD;       /* RELEASE REGISTER 1,2          */
*               ERROR=F0;           /* NOT END OF FILE               */
         SLR   @05,@05                                             0897
         ST    @05,ERROR                                           0897
*               CURREC=PTRA;        /* SAVE CURRENT RECORD POINTER   */
         L     @05,FILEPTR                                         0898
         ST    PTRA,CURREC(,@05)                                   0898
*               IF DCBRECL=V THEN   /* IF RECFM=V X X                */
         TM    DCBRECL+28(DCBPTR),B'01000000'                      0899
         BNO   @RF00899                                            0899
         TM    DCBRECL+28(DCBPTR),B'10000000'                      0899
         BNZ   @RF00899                                            0899
*                 DO;               /* ACCOUNT FOR LL00              */
*                   SVTLNG=DCBLRECL-4;/* LENGTH FOR MOVE             */
         L     @05,SNTELPTR(,COMONPTR)                             0901
         L     @05,SNTVLPTR(,@05)                                  0901
         LA    @02,4                                               0901
         LH    @15,DCBLRECL+72(,DCBPTR)                            0901
         SLR   @15,@02                                             0901
         STH   @15,SVTLNG(,@05)                                    0901
*                   PTRA=PTRA+F4;   /* SKIP LL OO FIELDS             */
         ALR   PTRA,@02                                            0902
*                 END;              /* END RECFM=V X X PROCESS       */
*               ELSE                /* IF RECFM=F OR RECFM= U        */
*                 SVTLNG=DCBLRECL;  /* SET LENGTH                    */
         B     @RC00899                                            0904
@RF00899 L     @05,SNTELPTR(,COMONPTR)                             0904
         L     @05,SNTVLPTR(,@05)                                  0904
         LH    @02,DCBLRECL+72(,DCBPTR)                            0904
         STH   @02,SVTLNG(,@05)                                    0904
*               SVTLNG=MIN(SVTLNG,MINBFLEN);/* DONT CLOBBER VTAB     */
@RC00899 L     @05,SNTELPTR(,COMONPTR)                             0905
         L     @05,SNTVLPTR(,@05)                                  0905
         L     @15,FILEPTR                                         0905
         LH    @14,SVTLNG(,@05)                                    0905
         LH    @07,MINBFLEN(,@15)                                  0905
         CR    @14,@07                                             0905
         BNH   *+6
         LR    @14,@07                                             0905
         STH   @14,SVTLNG(,@05)                                    0905
*               CALL MOVE(BFR,SVTDATA,SVTLNG,MINBFLEN);/* BFR COPY   */
         ST    PTRA,@AL00001                                       0906
         LA    @14,SVTDATA(,@05)                                   0906
         ST    @14,@AL00001+4                                      0906
         ST    @05,@AL00001+8                                      0906
         LA    @05,MINBFLEN(,@15)                                  0906
         ST    @05,@AL00001+12                                     0906
         LA    @01,@AL00001                                        0906
         BAL   @14,MOVE                                            0906
*EOF:                                                              0907
*               IF ERROR^=F0 THEN   /* IF END OF FILE OCCURRED       */
EOF      L     @15,ERROR                                           0907
         LTR   @15,@15                                             0907
         BZ    @RF00907                                            0907
*                 OKGET=NO;         /* NO MORE GETS ALLOWED          */
         L     @01,FILEPTR                                         0908
         NI    OKGET(@01),B'10111111'                              0908
*             END;                  /*                               */
@RF00907 DS    0H                                                  0910
*         END;                      /*                               */
@RF00888 DS    0H                                                  0911
*     END;                          /*                               */
@RC00884 DS    0H                                                  0912
*   IF ERROR=F0 THEN                /* IF ALL OK                     */
@RF00881 L     @15,ERROR                                           0912
         LTR   @15,@15                                             0912
         BNZ   @RF00912                                            0912
*     ERROR=E4;                     /* GET ANOTHER RECORD            */
         MVC   ERROR(4),@CF00109                                   0913
*   END GETRTN;                     /* END OF GET A RECORD           */
@EL00021 DS    0H                                                  0914
@EF00021 DS    0H                                                  0914
@ER00021 LM    @14,@12,@SA00021                                    0914
         BR    @14                                                 0914
*                                                                  0915
*   /*****************************************************************/
*   /*                                                               */
*   /* PLACE DDVARIABLE INTO OUTPUT FILE                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0915
*PUTRTN:                                                           0915
*   PROC;                                                          0915
PUTRTN   STM   @14,@12,@SA00022                                    0915
*   CALL LOCFILE;                   /* GET THE FILE NAME             */
         BAL   @14,LOCFILE                                         0916
*   IF ERROR=F0&(MATCH=NO×OKPUT=NO×(OKGET=NO&OKUPDATE=YES)) THEN/*   */
         L     @15,ERROR                                           0917
         LTR   @15,@15                                             0917
         BNZ   @RF00917                                            0917
         TM    MATCH(COMONPTR),B'00010000'                         0917
         BZ    @RT00917                                            0917
         L     @15,FILEPTR                                         0917
         TM    OKPUT(@15),B'10000000'                              0917
         BZ    @RT00917                                            0917
         TM    OKUPDATE(@15),B'00100000'                           0917
         BNO   @RF00917                                            0917
         TM    OKGET(@15),B'01000000'                              0917
         BNZ   @RF00917                                            0917
@RT00917 DS    0H                                                  0918
*     ERROR=E360;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00573                                   0918
*   IF ERROR=F0 THEN                /* IF OK SO FAR                  */
@RF00917 L     @15,ERROR                                           0919
         LTR   @15,@15                                             0919
         BNZ   @RF00919                                            0919
*     DO;                           /* PROCESS                       */
*       DCBPTR=ADDR(DCBAREA);       /* POINT TO DCB                  */
         L     DCBPTR,FILEPTR                                      0921
         LA    DCBPTR,DCBAREA(,DCBPTR)                             0921
*       IF DCBOFOPN=NO THEN         /* IF DCB IS NOT OPEN            */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0922
         BNZ   @RF00922                                            0922
*         ERROR=E364;               /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00575                                   0923
*       ELSE                        /* OTHERWISE                     */
*         DO;                       /* CONTINUE                      */
         B     @RC00922                                            0924
@RF00922 DS    0H                                                  0925
*           CALL COMLINK(LOCATE,NAMESAV,NAMELEN,F0);/* FIND VARIABLE */
         LA    @02,@CF00121                                        0925
         ST    @02,@AL00001                                        0925
         LA    @02,NAMESAV                                         0925
         ST    @02,@AL00001+4                                      0925
         LA    @02,NAMELEN                                         0925
         ST    @02,@AL00001+8                                      0925
         LA    @02,@CF00430                                        0925
         ST    @02,@AL00001+12                                     0925
         LA    @01,@AL00001                                        0925
         BAL   @14,COMLINK                                         0925
*           IF ERROR=F0 THEN        /* IF VARIABLE FOUND             */
         L     @02,ERROR                                           0926
         LTR   @02,@02                                             0926
         BNZ   @RF00926                                            0926
*             DO;                   /* PUT THE RECORD                */
*               ERROR=E4;           /* GET ANOTHER COMMAND           */
         MVC   ERROR(4),@CF00109                                   0928
*               IF OKUPDATE=YES THEN/* IF IN UPDATE MODE             */
         L     @02,FILEPTR                                         0929
         TM    OKUPDATE(@02),B'00100000'                           0929
         BNO   @RF00929                                            0929
*                 CALL PUTXRTN;     /* RETURN UPDATED RECORD         */
         BAL   @14,PUTXRTN                                         0930
*               ELSE                /* OTHERWISE                     */
*                 CALL PUTAREC;     /* CALL NORMAL PUT               */
         B     @RC00929                                            0931
@RF00929 BAL   @14,PUTAREC                                         0931
*               EMPTY=NO;           /* FILE NOT EMPTY        @ZA15726*/
@RC00929 L     @01,FILEPTR                                         0932
         NI    EMPTY(@01),B'11101111'                              0932
*             END;                  /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
*   END PUTRTN;                     /* END PUTRTN                    */
@EL00022 DS    0H                                                  0936
@EF00022 DS    0H                                                  0936
@ER00022 LM    @14,@12,@SA00022                                    0936
         BR    @14                                                 0936
*                                                                  0937
*   /*****************************************************************/
*   /*                                                               */
*   /* PUTAREC:THE PUTRTN IS USED TO PUT A LINE OUT TO A DATASET.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0937
*PUTAREC:                                                          0937
*   PROC;                           /* THIS IS THE PUTRTN            */
PUTAREC  STM   @14,@12,@SA00023                                    0937
*   SAVLL=SVTLNG;                   /* SAVE SVTLNG                   */
         L     @07,SNTELPTR(,COMONPTR)                             0938
         L     @07,SNTVLPTR(,@07)                                  0938
         LH    @02,SVTLNG(,@07)                                    0938
         LR    SAVLL,@02                                           0938
*   SAVOO=SVTORIG;                  /* SAVE SVTORIG                  */
         LH    SAVOO,SVTORIG(,@07)                                 0939
*   IF DCBRECL=V THEN               /* PROCESS FOR RECFM=V           */
         TM    DCBRECL+28(DCBPTR),B'01000000'                      0940
         BNO   @RF00940                                            0940
         TM    DCBRECL+28(DCBPTR),B'10000000'                      0940
         BNZ   @RF00940                                            0940
*     DO;                           /* PROCESS VARIABLE              */
*       PTRA=SNTVLPTR;              /* POINT TO LENGTH FIELD(SVTLNG) */
         LR    PTRA,@07                                            0942
*       SVTLNG=SVTLNG+F4;           /* ADD FOUR FOR PUT              */
         AL    @02,@CF00109                                        0943
         STH   @02,SVTLNG(,@07)                                    0943
*       SVTORIG=F0;                 /* SET SVTORIG TO ZERO FOR PUT   */
         SLR   @02,@02                                             0944
         STH   @02,SVTORIG(,@07)                                   0944
*     END;                          /*                               */
*   ELSE                            /* OTHERWISE                     */
*     PTRA=ADDR(SVTDATA);           /* POINT DIRECTLY TO SVTDATA     */
         B     @RC00940                                            0946
@RF00940 L     @07,SNTELPTR(,COMONPTR)                             0946
         L     PTRA,SNTVLPTR(,@07)                                 0946
         LA    PTRA,SVTDATA(,PTRA)                                 0946
*   RFY                                                            0947
*    (R0,                                                          0947
*     R2) RSTD;                     /* RESTRICT FOR PUT              */
@RC00940 DS    0H                                                  0948
*   R0=PTRA;                        /* SET OUTAREA ADDRESS           */
         LR    R0,PTRA                                             0948
*   R2=DCBPTR;                      /* LOAD DCB ADDR                 */
         LR    R2,DCBPTR                                           0949
*   GEN REFS(R0,R2) FLOWS(SYNADXT)(PUT    (R2),(R0));/* ISSUE PUT    */
         PUT    (R2),(R0)
*   RFY                                                            0951
*    (R0,                                                          0951
*     R2) UNRSTD;                   /* RELEASE REG ZERO              */
*   SVTORIG=SAVOO;                  /* RESTORE ORIG                  */
         L     @07,SNTELPTR(,COMONPTR)                             0952
         L     @07,SNTVLPTR(,@07)                                  0952
         STH   SAVOO,SVTORIG(,@07)                                 0952
*   SVTLNG=SAVLL;                   /*                               */
         STH   SAVLL,SVTLNG(,@07)                                  0953
*   END PUTAREC;                    /* END PUT PROCESSING            */
@EL00023 DS    0H                                                  0954
@EF00023 DS    0H                                                  0954
@ER00023 LM    @14,@12,@SA00023                                    0954
         BR    @14                                                 0954
*                                                                  0955
*   /*****************************************************************/
*   /*                                                               */
*   /* PUTXRTN: THE PUTXRTN TELLS THE ACCESS METHOD TO PLACE AN      */
*   /* UPDATED RECORD BACK INTO THE DATASET. THIS OPTION IS USED WITH*/
*   /* OPENFILE XXXXXXXX,UPDATE.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0955
*PUTXRTN:                                                          0955
*   PROC;                           /* PUTXRTN                       */
PUTXRTN  STM   @14,@12,@SA00024                                    0955
*   PTRA=CURREC;                    /* GET LAST RECORD READ          */
         L     @02,FILEPTR                                         0956
         L     PTRA,CURREC(,@02)                                   0956
*   IF PTRA=0 THEN                  /* IF ZERO (NO LAST RECORD)      */
         LTR   PTRA,PTRA                                           0957
         BNZ   @RF00957                                            0957
*     ERROR=E372;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00579                                   0958
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* PUT BACK RECORD               */
         B     @RC00957                                            0959
@RF00957 DS    0H                                                  0960
*       IF DCBRECL=V THEN           /* FOR VARIABLE RECORDS          */
         TM    DCBRECL+28(DCBPTR),B'01000000'                      0960
         BNO   @RF00960                                            0960
         TM    DCBRECL+28(DCBPTR),B'10000000'                      0960
         BNZ   @RF00960                                            0960
*         DO;                       /*                               */
*           OUTLEN=DCBLRECL-4;      /* SET OUTPUT MOVE LENGTH        */
         LA    @05,4                                               0962
         LH    @02,DCBLRECL+72(,DCBPTR)                            0962
         SLR   @02,@05                                             0962
         STH   @02,OUTLEN                                          0962
*           PTRA=PTRA+F4;           /* DONT OVERLAY LL/OO            */
         ALR   PTRA,@05                                            0963
*         END;                      /*                               */
*       ELSE                        /* FOR RECFM = FIXED             */
*         OUTLEN=DCBLRECL;          /* SET MAX LENGTH                */
         B     @RC00960                                            0965
@RF00960 LH    @05,DCBLRECL+72(,DCBPTR)                            0965
         STH   @05,OUTLEN                                          0965
*       CALL MOVE(SVTDATA,BFR,SVTLNG,OUTLEN);/* COPY UPDATES BACK    */
@RC00960 L     @05,SNTELPTR(,COMONPTR)                             0966
         L     @05,SNTVLPTR(,@05)                                  0966
         LA    @02,SVTDATA(,@05)                                   0966
         ST    @02,@AL00001                                        0966
         ST    PTRA,@AL00001+4                                     0966
         ST    @05,@AL00001+8                                      0966
         LA    @05,OUTLEN                                          0966
         ST    @05,@AL00001+12                                     0966
         LA    @01,@AL00001                                        0966
         BAL   @14,MOVE                                            0966
*       RFY                                                        0967
*        (R2) RSTD;                 /* RESTRICT REG 2                */
*       R2=DCBPTR;                  /* GET DCB ADDR                  */
         LR    R2,DCBPTR                                           0968
*       GEN REFS(R2) FLOWS(SYNADXT)(PUTX    (R2));/* ISSUE PUTX      */
         PUTX    (R2)
*       RFY                                                        0970
*        (R2) UNRSTD;               /* RELEASE REG 2                 */
*     END;                                                         0971
*   END PUTXRTN;                                                   0972
@EL00024 DS    0H                                                  0972
@EF00024 DS    0H                                                  0972
@ER00024 LM    @14,@12,@SA00024                                    0972
         BR    @14                                                 0972
*                                                                  0973
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE: THE MOVE ROUTINE IS USED TO MOVE I/O BUFFERS AROUND.    */
*   /* THIS ROUTINE DECLARES ITS OWN REGISTERS TO KEEP THE SEPARATE  */
*   /* FROM MAINLINE PROCESSING                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0973
*MOVE:                                                             0973
*   PROC(FROM,TO,LENFR,LENTO);      /* MOVE ROUTINE                  */
MOVE     STM   @14,@12,@SA00025                                    0973
         MVC   @PC00025(16),0(@01)                                 0973
*   DCL                             /*                               */
*     FROM CHAR(*),                 /* FROM BUFFER                   */
*     TO CHAR(*),                   /* TO BUFFER                     */
*     LENFR FIXED(15),              /* NUMBER OF BYTES TO MOVE       */
*     LENTO FIXED(15);              /* NUMBER OF BYTES TO MOVE       */
*   RFY                                                            0975
*    (R2,                                                          0975
*     R3,                                                          0975
*     R4,                                                          0975
*     R5) RSTD;                     /* RESTRICT REGS FOR MVCL        */
*   R2=ADDR(TO(1));                 /* ADDRESS OF TO BUFFER          */
         L     R2,@PC00025+4                                       0976
*   R4=ADDR(FROM(1));               /* ADDRESS OF FROM BUFFER        */
         L     R4,@PC00025                                         0977
*   R3=LENTO;                       /* NUMBER OF BYTES TO MOVE       */
         L     @15,@PC00025+12                                     0978
         LH    R3,LENTO(,@15)                                      0978
*   R5=BLANKS×LENFR;                /* SET LEN AND PADD CHAR         */
         L     @15,@PC00025+8                                      0979
         LH    R5,LENFR(,@15)                                      0979
         O     R5,@CF00417                                         0979
*   GEN(MVCL  R2,R4);               /* ISSUE MVCL INSTRUCTION        */
         MVCL  R2,R4
*   RFY                                                            0981
*    (R2,                                                          0981
*     R3,                                                          0981
*     R4,                                                          0981
*     R5) UNRSTD;                   /* RELEASE REGS                  */
*   END MOVE;                       /*                               */
@EL00025 DS    0H                                                  0982
@EF00025 DS    0H                                                  0982
@ER00025 LM    @14,@12,@SA00025                                    0982
         BR    @14                                                 0982
*                                                                  0983
*   /*****************************************************************/
*   /*                                                               */
*   /* CLOSE DOWN THE FILEDCB                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*CLOSRTN:                                                          0983
*   PROC;                           /* CLOSE ROUTINE                 */
CLOSRTN  STM   @14,@12,@SA00026                                    0983
*   CALL LOCFILE;                   /* GET FILENAME                  */
         BAL   @14,LOCFILE                                         0984
*   IF ERROR=F0&MATCH=NO THEN       /* IF DDNAME NOT OPEN            */
         L     @03,ERROR                                           0985
         LTR   @03,@03                                             0985
         BNZ   @RF00985                                            0985
         TM    MATCH(COMONPTR),B'00010000'                         0985
         BNZ   @RF00985                                            0985
*     ERROR=E368;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00577                                   0986
*   IF ERROR=F0 THEN                /* IF OK SO FAR                  */
@RF00985 L     @03,ERROR                                           0987
         LTR   @03,@03                                             0987
         BNZ   @RF00987                                            0987
*     DO;                           /* CONTINUE                      */
*       PREVFILE->NEXTFILE=NEXTFILE;/* UNCHAIN FILEBLOK              */
         L     @15,FILEPTR                                         0989
         L     @14,NEXTFILE(,@15)                                  0989
         ST    @14,NEXTFILE(,PREVFILE)                             0989
*       DCBPTR=ADDR(DCBAREA);       /* POINT TO DCB                  */
         LA    DCBPTR,DCBAREA(,@15)                                0990
*       IF DCBOFOPN=YES THEN        /* IF THE DCB IS OPEN            */
         TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0991
         BNO   @RF00991                                            0991
*         DO;                       /*                               */
*           CLOSL(2:4)=DCBPTR;      /* SET DCB ADDR IN CLOSE LIST    */
         STCM  DCBPTR,7,CLOSL+1                                    0993
*           GEN(CLOSE    MF=(E,CLOSL));/* ISSUE CLOSE                */
         CLOSE    MF=(E,CLOSL)
*         END;                      /*                               */
*       IF DCBOFOPN=NO THEN         /* AS LONG AS DCB IS CLOSED      */
@RF00991 TM    DCBOFOPN+40(DCBPTR),B'00010000'                     0996
         BNZ   @RF00996                                            0996
*         DO;                       /* FREE ALL STG FOR IT   @ZA09978*/
*           RFY                                                    0998
*            (R2) RSTD;             /* RESERVE REGISTER      @ZA09978*/
*           R2=DCBPTR;              /* POINT TO DCB          @ZA09978*/
         LR    R2,DCBPTR                                           0999
*           GEN REFS(R2)(FREEPOOL  (R2));/* FREE BUFFER POOL @ZA09978*/
         FREEPOOL  (R2)
*           RFY                                                    1001
*            (R2) UNRSTD;           /* RELEASE REGISTER      @ZA09978*/
*           DO;                     /* FREEMAIN                    1002
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 1002
*                                      A(FILEPTR) SP(78) MF(E,FRELST)*/
*             RESPECIFY                                            1003
*              (GPR01P) RESTRICTED;                                1003
*             FRELST02=LENGTH(FILEBLOK)+DCBLEN;/* LENGTH             */
         L     @15,DCBLEN                                          1004
         LA    @15,20(,@15)                                        1004
         STCM  @15,7,FRELST02                                      1004
*             FRELST04=ADDR(FILEPTR);/* ADDR OF ADDR LIST            */
         LA    @00,FILEPTR                                         1005
         STCM  @00,7,FRELST04                                      1005
*             FRELST06=78;          /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'4E'                                      1006
*             GPR01P=ADDR(FRELST);  /* REG1 POINTS TO LIST           */
         LA    GPR01P,FRELST                                       1007
*             SVC(5);               /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   1008
*             RESPECIFY                                            1009
*              (GPR01P) UNRESTRICTED;                              1009
*           END;                    /* FREEMAIN                    1010
*                                      LV(LENGTH(FILEBLOK)+DCBLEN) 1010
*                                      A(FILEPTR) SP(78) MF(E,FRELST)*/
*         END;                      /*                       @ZA09978*/
*       ERROR=E4;                   /* GET ANOTHER COMMAND           */
@RF00996 MVC   ERROR(4),@CF00109                                   1012
*     END;                          /*                               */
*   END CLOSRTN;                    /* END OF CLOSE ROUTINE          */
@EL00026 DS    0H                                                  1014
@EF00026 DS    0H                                                  1014
@ER00026 LM    @14,@12,@SA00026                                    1014
         BR    @14                                                 1014
*                                                                  1015
*   /*****************************************************************/
*   /*                                                               */
*   /* THE OPEN EXIT CANNOT SAVE REGISTERS IN REG 13 SAVEAREA SO THIS*/
*   /* ROUTINE USES ITS OWN SAVEAREA CALLED MYSAVAREA. THE PURPOSE OF*/
*   /* THIS EXIT IS TO DEFAULT OR CORRECT DCB PARAMETERS ON THE      */
*   /* OUTPUT DCB                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1015
*OPENEXIT:                                                         1015
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1015
OPENEXIT DS    0H                                                  1016
*   RFY                                                            1016
*     R14 RSTD;                                                    1016
*   IF DCBRECL=NOTDEF×DCBRECL=U THEN/* IF DCBRECL IS NOT DEFINED     */
         LA    @15,28                                              1017
         ALR   @15,DCBPTR                                          1017
         TM    DCBRECL(@15),B'11000000'                            1017
         BZ    @RT01017                                            1017
         TM    DCBRECL(@15),B'11000000'                            1017
         BNO   @RF01017                                            1017
@RT01017 DS    0H                                                  1018
*     DCBRECL=F;                    /*                               */
         NI    DCBRECL+28(DCBPTR),B'10111111'                      1018
         OI    DCBRECL+28(DCBPTR),B'10000000'                      1018
*   IF DCBRECL=V THEN               /* FOR RECFM=V                   */
@RF01017 LA    @15,28                                              1019
         ALR   @15,DCBPTR                                          1019
         TM    DCBRECL(@15),B'01000000'                            1019
         BNO   @RF01019                                            1019
         TM    DCBRECL(@15),B'10000000'                            1019
         BNZ   @RF01019                                            1019
*     DO;                           /* CHECK BLKSIZE                 */
*       IF DCBBLKSI=F0 THEN         /* IF BLKSIZE = 0 AND LRECL = 0  */
         SLR   @02,@02                                             1021
         LA    @07,52                                              1021
         ALR   @07,DCBPTR                                          1021
         CH    @02,DCBBLKSI(,@07)                                  1021
         BNE   @RF01021                                            1021
*         IF DCBLRECL=F0 THEN       /* DEFAULT TO RECFM = VBA        */
         LA    @06,72                                              1022
         ALR   @06,DCBPTR                                          1022
         CH    @02,DCBLRECL(,@06)                                  1022
         BNE   @RF01022                                            1022
*           DO;                     /*                               */
*             DCBRECL=F;            /*                               */
         NI    DCBRECL(@15),B'10111111'                            1024
         OI    DCBRECL(@15),B'10000000'                            1024
*             DCBRECBR=B;           /*                               */
         OI    DCBRECBR(@15),B'00010000'                           1025
*             DCBBLKSI=DEFBLKSI;    /* SET BLKSI TO 3360             */
         MVC   DCBBLKSI(2,@07),@CH00102                            1026
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 80               */
         MVC   DCBLRECL(2,@06),@CH00104                            1027
*           END;                    /*                               */
*         ELSE                                                     1029
*           DCBBLKSI=DCBLRECL+F4;   /* SET BLKSI TO LREC + 4         */
         B     @RC01022                                            1029
@RF01022 LA    @15,4                                               1029
         AH    @15,DCBLRECL+72(,DCBPTR)                            1029
         STH   @15,DCBBLKSI+52(,DCBPTR)                            1029
*       ELSE                        /* IF BLKSI NOT = 0 AND          */
*         IF DCBLRECL=F0 THEN       /* AND LRECL IS 0 SET LRECL      */
         B     @RC01021                                            1030
@RF01021 LA    @15,72                                              1030
         ALR   @15,DCBPTR                                          1030
         LH    @02,DCBLRECL(,@15)                                  1030
         LTR   @02,@02                                             1030
         BNZ   @RF01030                                            1030
*           DCBLRECL=DCBBLKSI-F4;   /* TO BLKSI-4                    */
         LH    @02,DCBBLKSI+52(,DCBPTR)                            1031
         SL    @02,@CF00109                                        1031
         STH   @02,DCBLRECL(,@15)                                  1031
*         ELSE                      /* OTHERWISE COMPUTE CORRECTIONS */
*           DO;                     /* IF MORE THAN ONE LRECL CAN FIT*/
         B     @RC01030                                            1032
@RF01030 DS    0H                                                  1033
*             DCBBLKSI=MAX(DCBBLKSI,DCBLRECL+F4);/* GET DEF BLKSI    */
         LA    @15,52                                              1033
         ALR   @15,DCBPTR                                          1033
         LH    @02,DCBLRECL+72(,DCBPTR)                            1033
         LA    @07,4                                               1033
         ALR   @07,@02                                             1033
         LH    @06,DCBBLKSI(,@15)                                  1033
         CR    @06,@07                                             1033
         BNL   *+6
         LR    @06,@07                                             1033
         STH   @06,DCBBLKSI(,@15)                                  1033
*             IF DCBBLKSI/DCBLRECL>F1 THEN/* SET RECFM TO XBX        */
         SRDA  @06,32                                              1034
         DR    @06,@02                                             1034
         C     @07,@CF00042                                        1034
         BNH   @RF01034                                            1034
*               DCBRECBR=B;         /* COMPUTE PROPER BLKSIZE        */
         OI    DCBRECBR+28(DCBPTR),B'00010000'                     1035
*           END;                                                   1036
@RF01034 DS    0H                                                  1037
*     END;                          /* END RECFM V                   */
@RC01030 DS    0H                                                  1037
@RC01021 DS    0H                                                  1038
*   IF DCBRECL=F&DCBRECBR^=B THEN   /* FOR UNBLOCKED RECFM=F         */
@RF01019 LA    @15,28                                              1038
         ALR   @15,DCBPTR                                          1038
         TM    DCBRECL(@15),B'10000000'                            1038
         BNO   @RF01038                                            1038
         TM    DCBRECL(@15),B'01000000'                            1038
         BNZ   @RF01038                                            1038
         TM    DCBRECBR(@15),B'00010000'                           1038
         BO    @RF01038                                            1038
*     DO;                           /* IF DCBLRECL AND DCBBLK = 0    */
*       IF DCBBLKSI=F0 THEN         /* FORCE DEFAULT OF RECFM= VBA   */
         SLR   @02,@02                                             1040
         LA    @07,52                                              1040
         ALR   @07,DCBPTR                                          1040
         CH    @02,DCBBLKSI(,@07)                                  1040
         BNE   @RF01040                                            1040
*         IF DCBLRECL=F0 THEN       /*                               */
         LA    @06,72                                              1041
         ALR   @06,DCBPTR                                          1041
         CH    @02,DCBLRECL(,@06)                                  1041
         BNE   @RF01041                                            1041
*           DO;                     /*                               */
*             DCBRECBR=B;           /*                               */
         OI    DCBRECBR(@15),B'00010000'                           1043
*             DCBBLKSI=DEFBLKSI;    /* SET BLKSIZE TO 3556           */
         MVC   DCBBLKSI(2,@07),@CH00102                            1044
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 148              */
         MVC   DCBLRECL(2,@06),@CH00104                            1045
*           END;                    /*                               */
*         ELSE                      /* OTHER WISE MAKE BLK = LRECL   */
*           DCBBLKSI=DCBLRECL;                                     1047
         B     @RC01041                                            1047
@RF01041 LH    @15,DCBLRECL+72(,DCBPTR)                            1047
         STH   @15,DCBBLKSI+52(,DCBPTR)                            1047
*       ELSE                        /* OR LRECL = BLK                */
*         DCBLRECL=DCBBLKSI;                                       1048
         B     @RC01040                                            1048
@RF01040 LH    @15,DCBBLKSI+52(,DCBPTR)                            1048
         STH   @15,DCBLRECL+72(,DCBPTR)                            1048
*     END;                          /* IF BLOCKED FIXED              */
@RC01040 DS    0H                                                  1050
*   IF DCBRECL=F&DCBRECBR=B THEN    /* AND DCBLRECL AND DCBBLKSI = 0 */
@RF01038 LA    @15,28                                              1050
         ALR   @15,DCBPTR                                          1050
         TM    DCBRECL(@15),B'10000000'                            1050
         BNO   @RF01050                                            1050
         TM    DCBRECL(@15),B'01000000'                            1050
         BNZ   @RF01050                                            1050
         TM    DCBRECBR(@15),B'00010000'                           1050
         BNO   @RF01050                                            1050
*     DO;                           /* SET DEFAULTS OF RECFM= VBA    */
*       IF DCBBLKSI=F0 THEN         /*                               */
         SLR   @02,@02                                             1052
         LA    @07,52                                              1052
         ALR   @07,DCBPTR                                          1052
         CH    @02,DCBBLKSI(,@07)                                  1052
         BNE   @RF01052                                            1052
*         IF DCBLRECL=F0 THEN       /*                               */
         LA    @06,72                                              1053
         ALR   @06,DCBPTR                                          1053
         CH    @02,DCBLRECL(,@06)                                  1053
         BNE   @RF01053                                            1053
*           DO;                     /*                               */
*             DCBRECBR=B;           /*                               */
         OI    DCBRECBR(@15),B'00010000'                           1055
*             DCBBLKSI=DEFBLKSI;    /* SET DEFAULT BLKSI OF 3360     */
         MVC   DCBBLKSI(2,@07),@CH00102                            1056
*             DCBLRECL=DEFLRECL;    /* SET LRECL TO 80               */
         MVC   DCBLRECL(2,@06),@CH00104                            1057
*           END;                    /*                               */
*         ELSE                      /*                               */
*           DCBBLKSI=DCBLRECL;      /* IF BLK = 0, COPY LRECL        */
         B     @RC01053                                            1059
@RF01053 LH    @15,DCBLRECL+72(,DCBPTR)                            1059
         STH   @15,DCBBLKSI+52(,DCBPTR)                            1059
*       ELSE                                                       1060
*         IF DCBLRECL=F0 THEN       /* IF LRECL= 0, COPY BLK         */
         B     @RC01052                                            1060
@RF01052 LA    @15,72                                              1060
         ALR   @15,DCBPTR                                          1060
         LH    @02,DCBLRECL(,@15)                                  1060
         LTR   @02,@02                                             1060
         BNZ   @RF01060                                            1060
*           DCBLRECL=DCBBLKSI;      /* IF NEITHER IS ZERO,           */
         LH    @02,DCBBLKSI+52(,DCBPTR)                            1061
         STH   @02,DCBLRECL(,@15)                                  1061
*         ELSE                      /* COMPUTE BLKSIZE               */
*           DCBBLKSI=MAX((DCBBLKSI/DCBLRECL),F1)*DCBLRECL;         1062
         B     @RC01060                                            1062
@RF01060 LA    @15,52                                              1062
         ALR   @15,DCBPTR                                          1062
         LH    @02,DCBLRECL+72(,DCBPTR)                            1062
         LH    @00,DCBBLKSI(,@15)                                  1062
         SRDA  @00,32                                              1062
         DR    @00,@02                                             1062
         LA    @00,1                                               1062
         CR    @01,@00                                             1062
         BNL   *+6
         LR    @01,@00                                             1062
         MR    @00,@02                                             1062
         STH   @01,DCBBLKSI(,@15)                                  1062
*     END;                                                         1063
*   RFY                                                            1064
*     R14 UNRSTD;                                                  1064
*   END OPENEXIT;                   /* END OF OPEN EXIT- RETURN TO 1065
*                                      DATA MANAGEMENT               */
@EL00027 DS    0H                                                  1065
@EF00027 DS    0H                                                  1065
@ER00027 BR    @14                                                 1065
*                                                                  1066
*   /*****************************************************************/
*   /*                                                               */
*   /* SYNAD ERROR MESSAGE WRITER                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1066
*SYNADXT:                                                          1066
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1066
SYNADXT  DS    0H                                                  1067
*   DCL                                                            1067
*     SYNSAVE CHAR(12),                                            1067
*     SYNMSTXT CHAR(30) CONSTANT('IKJ56542I EXEC FILE I/O ERROR-'),
*     SYNMSG CHAR(30) BASED(R1) POS(9);                            1067
*   RFY                                                            1068
*    (R1,                                                          1068
*     R2,                                                          1068
*     R14,                                                         1068
*     R15) RSTD;                                                   1068
*   GEN(SYNADAF ACSMETH=QSAM);      /* GET SYNAD MESSAGE             */
         SYNADAF ACSMETH=QSAM
*   STM(R0,R15,SYNREGS);            /* SAVE ALL REGISTERS            */
         STM   R0,R15,SYNREGS(COMONPTR)                            1070
*   R15=ADDR(IKJEFT40);             /* GO TO PUTLINE                 */
         L     R15,@CV00130                                        1071
*   R2=R1+F4;                       /* SKIP BLOCK LENGTH             */
         LA    R2,4                                                1072
         ALR   R2,R1                                               1072
*   SYNSAVE=SYNMSG(1:12);           /* SAVE BIT DATA                 */
         MVC   SYNSAVE(12),SYNMSG(R1)                              1073
*   SYNMSG=SYNMSTXT;                /* ADD CLIST ERROR               */
         MVC   SYNMSG(30,R1),@CC02619                              1074
*   R1=ADDR(IOPL);                  /* GET ADDR OF IOPL              */
         LR    R1,COMONPTR                                         1075
*   GEN(PUTLINE OUTPUT=((2),DATA),ENTRY=(15),MF=(E,(1)));          1076
         PUTLINE OUTPUT=((2),DATA),ENTRY=(15),MF=(E,(1))
*   SYNMSG(1:12)=SYNSAVE;           /* RESTORE BITS                  */
         MVC   SYNMSG(12,R1),SYNSAVE                               1077
*   LM(R0,R15,SYNREGS);             /* RESTORE ALL REGS              */
         LM    R0,R15,SYNREGS(COMONPTR)                            1078
*   GEN(SYNADRLS);                  /* RELEASE MESSAGE               */
         SYNADRLS
*   RFY                                                            1080
*    (R1,                                                          1080
*     R2,                                                          1080
*     R14,                                                         1080
*     R15) UNRSTD;                  /* RELEASE REGISTERS             */
*   END SYNADXT;                                                   1081
@EL00028 DS    0H                                                  1081
@EF00028 DS    0H                                                  1081
@ER00028 BR    @14                                                 1081
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR15F FIXED(31) REG(15),                                    1082
*     GPR01P PTR(31) REG(1);                                       1082
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1083
*     I031F FIXED(31) BASED,                                       1083
*     I031P PTR(31) BASED,                                         1083
*     I015F FIXED(15) BASED,                                       1083
*     I015P PTR(15) BASED,                                         1083
*     I008P PTR(8) BASED,                                          1083
*     I001C CHAR(1) BASED;                                         1083
*   END IKJCT436                                                   1084
*                                                                  1084
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */
*/*%INCLUDE SYSLIB  (IHAQDB  )                                       */
*/*%INCLUDE SYSLIB  (IHADSAB )                                       */
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */
*                                                                  1084
*       ;                                                          1084
@DATA    DS    0H
@CH00104 DC    H'80'
@CH00102 DC    H'3360'
@SM02640 MVC   STACKD(0),STACKC
@SM02657 MVC   STAXDT(0),STAXCT
@SM02661 MVC   DC(0,@15),DELIMCH(@01)
@SC02663 CLC   0(0,@01),C-1(@06)
@SM02665 MVC   NAMESAV(0),C-1(@01)
@SC02667 CLC   0(0,@01),C-1(@14)
@SM02669 MVC   DCBAREA(0,@05),DCBI
@SM02671 MVC   DCBAREA(0,@05),DCBC(@01)
@SM02673 MVC   OPENL(0),OPENC(@01)
         DS    0F
@AL00185 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00642 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00761 DC    A(@CF00042)             LIST WITH   1 ARGUMENT(S)
@AL00249 DC    A(@CF00091)             LIST WITH   1 ARGUMENT(S)
@AL00432 EQU   *                       LIST WITH   4 ARGUMENT(S)
@AL00438 DC    A(@CF00121)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00443)
@AL00627 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00677 DC    A(@CF00148)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00430)
@AL00553 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00652 DC    A(@CF00136)             LIST WITH   1 ARGUMENT(S)
@AL00601 DC    A(@CF00121)             LIST WITH   4 ARGUMENT(S)
         DC    A(@CC00439)
@AL00517 DC    A(@CF00146)             LIST WITH   1 ARGUMENT(S)
         DC    A(@CF00430)
@AL00723 DC    A(@CF00139)             LIST WITH   1 ARGUMENT(S)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    5F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00008 DS    18F
@SA00009 DS    15F
@SA00018 DS    18F
@SA00014 DS    18F
@SA00011 DS    18F
@SA00016 DS    18F
@SA00015 DS    18F
@SA00010 DS    18F
@SA00013 DS    15F
@SA00020 DS    15F
@SA00026 DS    15F
@SA00021 DS    15F
@SA00022 DS    15F
@SA00003 DS    18F
@PC00003 DS    1F
@SA00017 DS    15F
@SA00019 DS    14F
@SA00025 DS    15F
@PC00025 DS    4F
@SA00024 DS    15F
@SA00023 DS    15F
@AL00001 DS    4A
@AFTEMPS DS    3F
IKJCT436 CSECT
         DS    0F
@CF00430 DC    F'0'
@CF00042 DC    F'1'
@CF00091 DC    F'2'
@CF00136 DC    F'3'
@CF00109 DC    F'4'
@CF00121 DC    F'5'
@CF00146 DC    F'6'
@CF00148 DC    F'7'
@CF00087 DC    F'8'
@CF00139 DC    F'9'
@CF00082 DC    F'16'
@CF00181 DC    F'24'
@CF00238 DC    F'44'
@CF00514 DC    F'57'
@CF00316 DC    F'65'
@CF00516 DC    F'239'
@CF00174 DC    F'256'
@CF00545 DC    F'304'
@CF00547 DC    F'308'
@CF00551 DC    F'316'
@CF00555 DC    F'324'
@CF00557 DC    F'328'
@CF00559 DC    F'332'
@CF00561 DC    F'336'
@CF00563 DC    F'340'
@CF00565 DC    F'344'
@CF00567 DC    F'348'
@CF00569 DC    F'352'
@CF00571 DC    F'356'
@CF00573 DC    F'360'
@CF00575 DC    F'364'
@CF00577 DC    F'368'
@CF00579 DC    F'372'
@CF00581 DC    F'400'
@CF00603 DC    F'940'
@CF00607 DC    F'948'
@CF00609 DC    F'952'
@CF00611 DC    F'956'
@CF00615 DC    F'964'
@CF00617 DC    F'972'
@CF00619 DC    F'999'
@CF02645 DC    F'-4'
@CF00417 DC    XL4'40000000'
@DATD    DSECT
         DS    0D
ERROR    DS    F
N        DS    F
NAMELEN  DS    F
ECTPTR   DS    A
DATAPTR  DS    A
FILEPTR  DS    A
VLPTR    DS    A
SNTABPTR DS    A
SVTABPTR DS    A
QDBPTR   DS    A
TIOTPTR  DS    A
UCBPTR   DS    A
TIOFERT  DS    F
OUTLEN   DS    H
OUTA1    DS    CL17
         DS    CL1
AREA     DS    CL16
CSAVE    DS    CL2
         DS    CL2
EXITPRMS DS    CL4
         ORG   EXITPRMS
EXITPARM DS    BL1
EXITADDR DS    AL3
         ORG   EXITPRMS+4
@NM00005 DS    CL1
         ORG   @NM00005
EXIT     DS    BL1
BYPASS   EQU   @NM00005+0
         ORG   @NM00005+1
DSNAME   DS    CL44
VOLID    DS    CL6
         DS    CL1
WKAREA   DS    CL140
OURJFCB  DS    CL176
GETLST   DS    CL10
         ORG   GETLST
GETLST01 DS    AL4
GETLST02 DS    CL1
GETLST03 DS    AL3
GETLST04 DS    CL1
GETLST05 DS    AL1
         ORG   GETLST+10
         DS    CL2
FRELST   DS    CL10
         ORG   FRELST
FRELST01 DS    AL1
FRELST02 DS    AL3
FRELST03 DS    AL1
FRELST04 DS    AL3
FRELST05 DS    BL1
FRELST06 DS    AL1
         ORG   FRELST+10
         DS    CL2
OBTNLST  DS    CL16
         ORG   OBTNLST
@NM00019 DS    FL4
DSNPTR   DS    AL4
VOLPTR   DS    AL4
WKPTR    DS    AL4
         ORG   OBTNLST+16
SYNSAVE  DS    CL12
OLD      DS    18A
DELIMTAB DS    CL8
         ORG   DELIMTAB+0
DELIMPTR DS    AL4
DELIMLEN DS    FL4
         ORG   DELIMTAB+520
IKJCT436 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00128 DC    V(IKJCT434)
@CV00129 DC    V(IKJEFT30)
@CV00130 DC    V(IKJEFT40)
@CV00131 DC    V(IKJGETL)
@CA00138 DC    A(ROUTINES)
@CA00173 DC    A(TRTABUP)
@CA00340 DC    A(MASTER)
@CA00341 DC    A(NOBUF)
@CA00342 DC    A(SYMLIST)
@CA00343 DC    A(CONLIST)
@CA00344 DC    A(LISTBUF)
@CA00345 DC    A(PROMPT)
@CA00346 DC    A(FLUSH)
@CA00347 DC    A(MAINBUF)
@CA00348 DC    A(MSGBUF)
         DS    0D
@CC02619 DC    C'IKJ56542I EXEC FILE I/O ERROR-'
@CC00443 DC    C'SYSDVAL'
@CC00439 DC    C'LASTCC'
@CC00422 DC    C'/*'
@CC00424 DC    C'*/'
@CC00426 DC    C'X='
@CC00464 DC    C''''''
@CB00535 DC    X'0000'
CHR      DC    CL4'CHAR'
NUM      DC    CL3'NUM'
KYW      DC    CL4'CODE'
         DC    CL4'QUIT'
VECTOR   DC    AL4(TSORTN)
         DC    AL4(GOTORTN)
         DC    AL4(IFRTN)
         DC    AL4(ELSERTN)
         DC    AL4(WRITERTN)
         DC    AL4(WRRRTN)
         DC    AL4(EXITRTN)
         DC    AL4(DORTN)
         DC    AL4(ENDRTN)
         DC    AL4(CTLRTN)
         DC    AL4(ERRRTN)
         DC    AL4(TERMRTN)
         DC    AL4(READRTN)
         DC    AL4(SETRTN)
         DC    AL4(RETRTN)
         DC    AL4(INTGTORN)
         DC    AL4(READDRTN)
         DC    AL4(ATTNRTN)
         DC    AL4(OPENRTN)
         DC    AL4(CLOSRTN)
         DC    AL4(GETRTN)
         DC    AL4(PUTRTN)
@NM00013 DS    CL16
         ORG   @NM00013+0
KEYNAME  DC    CL6'INPUT'
KEYFLGS  DC    X'40'
         DC    XL1'0'
PTRDCB   DC    AL4(DCBI)
PTROPEN  DC    AL4(OPENI)
         ORG   @NM00013+16
         ORG   @NM00013+16
         DC    CL6'OUTPUT'
         DC    X'80'
         DC    XL1'0'
         DC    AL4(DCBO)
         DC    AL4(OPENO)
         ORG   @NM00013+32
         ORG   @NM00013+32
         DC    CL6'UPDATE'
         DC    X'E0'
         DC    XL1'0'
         DC    AL4(DCBU)
         DC    AL4(OPENU)
         ORG   @NM00013+48
IKJCT436 CSECT
*                                                        /* @ZA08099*/
STAXCT   STAX MF=L                                       /* @ZA08099*/
LENSTAX    DC    A(*-STAXCT)                             /* @ZA08099*/
IKJCT436 CSECT
*                                                        /* @ZA15726*/
STACKC  STACK    DELETE=TOP,MF=L
        STACK    DELETE=ALL,MF=L
        GETLINE  INPUT=TERM,MF=L
        PUTLINE  MF=L
        STAX     DEFER=NO,MF=L
        STAX     DEFER=YES,MF=L
        OPEN     (,),MF=L
        CLOSE    (,),MF=L
        STAE     MF=L
MACLEN  DC       A(MACLEN-STACKC)
DCBI   DCB  DDNAME=DUMMY,MACRF=GL,DSORG=PS
DCBO   DCB  DDNAME=DUMMY,MACRF=PM,DSORG=PS
DCBU   DCB  DDNAME=DUMMY,MACRF=(GL,PM),DSORG=PS
DCBLEN DC   A(DCBLEN-DCBU)
OPENI  OPEN (,(INPUT)),MF=L
OPENO  OPEN (,(OUTPUT)),MF=L
OPENU  OPEN (,(UPDAT)),MF=L
OPENLEN DC  A(OPENLEN-OPENU)
OBTLIST CAMLST SEARCH,0,0,0                             /* @ZA15726*/
RDJC   RDJFCB (DCBI),MF=L                               /* @ZA15726*/
@DATD    DSECT
*                                                        /* @ZA08099*/
STAXDT   STAX MF=L                                       /* @ZA08099*/
@DATD    DSECT
*                                                        /* @ZA15726*/
STACKD  STACK    DELETE=TOP,MF=L
STFLUSH STACK    DELETE=ALL,MF=L
GETBLK  GETLINE  INPUT=TERM,MF=L
PLBLK   PUTLINE  MF=L
DEFERNO STAX     DEFER=NO,MF=L
DEFERYES STAX    DEFER=YES,MF=L
OPENL   OPEN     (,),MF=L
CLOSL   CLOSE    (,),MF=L
STAEL   STAE     MF=L
RDJL    RDJFCB   (DCBI),MF=L                            /* @ZA15726*/
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT436 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DSABPTR  EQU   @02
F1PTR    EQU   @02
JFCBPTR  EQU   @02
DLBASE   EQU   @02
DCBPTR   EQU   @03
PREVFILE EQU   @02
PTRA     EQU   @04
READEND  EQU   @06
PCTR     EQU   @02
GETLEN   EQU   @02
KEYINDX  EQU   @04
ERRSAV   EQU   @02
SAVOO    EQU   @06
SAVLL    EQU   @05
COUNT    EQU   @07
R12      EQU   @12
R11      EQU   @11
R10      EQU   @10
R9       EQU   @09
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R14      EQU   @14
R15      EQU   @15
COMONPTR EQU   @08
GPR01P   EQU   @01
GPR15F   EQU   @15
         EXTRN ROUTINES
         EXTRN TRTABUP
         EXTRN MASTER
         EXTRN NOBUF
         EXTRN SYMLIST
         EXTRN CONLIST
         EXTRN LISTBUF
         EXTRN PROMPT
         EXTRN FLUSH
         EXTRN MAINBUF
         EXTRN MSGBUF
CVTPTR   EQU   16
CURTCBP  EQU   0
ANSWER   EQU   0
DELIMCH  EQU   0
BUF      EQU   0
BFR      EQU   0
DCBC     EQU   0
OPENC    EQU   0
@NM00001 EQU   0
BASEPTR  EQU   @NM00001
ABCODE   EQU   @NM00001+5
@NM00003 EQU   0
TCBPTR   EQU   @NM00003+4
ROUTINE  EQU   0
@NM00011 EQU   0
GLL      EQU   @NM00011
GC       EQU   @NM00011+4
@NM00012 EQU   0
DLL      EQU   @NM00012
DC       EQU   @NM00012+2
FILEBLOK EQU   0
NEXTFILE EQU   FILEBLOK
CURREC   EQU   FILEBLOK+4
FILENAME EQU   FILEBLOK+8
FLAGS    EQU   FILEBLOK+16
OKPUT    EQU   FLAGS
OKGET    EQU   FLAGS
OKUPDATE EQU   FLAGS
EMPTY    EQU   FLAGS
MINBFLEN EQU   FILEBLOK+18
DCBAREA  EQU   FILEBLOK+20
EXECDATA EQU   0
LASTTSO  EQU   EXECDATA+12
@NM00020 EQU   EXECDATA+16
EXINSAVE EQU   @NM00020
ERACTSTR EQU   EXECDATA+20
ERACTEND EQU   EXECDATA+24
RETPTR   EQU   EXECDATA+28
EXDATFLG EQU   EXECDATA+32
@NM00021 EQU   EXDATFLG
CONLST   EQU   @NM00021
ERRCMD   EQU   @NM00021
NOFLUSH  EQU   @NM00021
SYMLST   EQU   @NM00021
ERINCNTL EQU   @NM00021
CMAIN    EQU   @NM00021
NOMSG    EQU   @NM00021
ATTNCMD  EQU   @NM00021
NOLASTCC EQU   @NM00021+1
EXDLMPTR EQU   EXECDATA+40
ATACTSTR EQU   EXECDATA+44
ATACTEND EQU   EXECDATA+48
FILEDCBS EQU   EXECDATA+56
SNTAB    EQU   0
SNTELEM  EQU   0
SNTVLPTR EQU   SNTELEM
SNTFLAGS EQU   SNTELEM+4
SNTNOSCN EQU   SNTFLAGS
SNTGLOB  EQU   SNTFLAGS+1
SVTAB    EQU   0
SVTELEM  EQU   0
SVTLNG   EQU   SVTELEM
SVTORIG  EQU   SVTELEM+2
SVTDATA  EQU   SVTELEM+4
@NM00024 EQU   0
LL       EQU   @NM00024
OO       EQU   @NM00024+2
O2       EQU   @NM00024+4
C        EQU   O2
@NM00025 EQU   0
@NM00027 EQU   0
INSCODE  EQU   @NM00027
INSEXEC  EQU   INSCODE
INSPROM  EQU   INSCODE
INSLIST  EQU   INSCODE
INSADLSD EQU   @NM00027+1
@NM00030 EQU   0
IOSTELM  EQU   @NM00030
@NM00032 EQU   0
OPCODE   EQU   @NM00032+6
FLSEPATH EQU   @NM00032+7
COMAREA  EQU   0
@NM00038 EQU   COMAREA
IOPL     EQU   @NM00038
BUFPTR   EQU   @NM00038+16
SNTELPTR EQU   @NM00038+20
OLDLINE  EQU   @NM00038+28
BUFBASE  EQU   @NM00038+32
NEWBASE  EQU   @NM00038+36
LSDPTR   EQU   @NM00038+40
TYPE     EQU   @NM00038+44
CNVTANS  EQU   @NM00038+48
CLEN     EQU   @NM00038+52
MYO2     EQU   @NM00038+56
BEGIN    EQU   @NM00038+60
I        EQU   @NM00038+64
LEN      EQU   @NM00038+68
FREEAMT  EQU   @NM00038+72
ERCOM    EQU   @NM00038+76
REGAREA  EQU   @NM00038+80
REGAREA2 EQU   @NM00038+96
SWSAREA  EQU   @NM00038+112
SW2AREA  EQU   @NM00038+117
STAEREGS EQU   @NM00038+118
SYNREGS  EQU   @NM00038+182
LSD      EQU   0
LSDANEXT EQU   LSD+8
LSDEXEC  EQU   LSD+12
ECT      EQU   0
ECTRCDF  EQU   ECT
ECTRTCD  EQU   ECT+1
ECTIOWA  EQU   ECT+4
ECTSWS   EQU   ECT+28
ECTBKGRD EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
IHADCB   EQU   0
IHADCS00 EQU   0
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   0
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   0
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   0
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEODA  EQU   DCBEODAD+1
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
DCBRECL  EQU   DCBRECLA
DCBRECBR EQU   DCBRECFM
DCBEXLSA EQU   DCBEXLST+1
IHADCS24 EQU   0
DCBDDNAM EQU   IHADCS24
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   0
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS26 EQU   0
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS27 EQU   0
DCBGET   EQU   IHADCS27
DCBPUT   EQU   DCBGET
DCBGETA  EQU   DCBPUT+1
IHADCS36 EQU   0
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBSYNA  EQU   DCBSYNAD+1
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   0
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   0
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   0
DCBEOBR  EQU   IHADCS38
DCBLRECL EQU   IHADCS38+10
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
IHADCS40 EQU   0
DCBEOBAD EQU   IHADCS40
DCBCCCW  EQU   IHADCS40+4
DCBRECAD EQU   DCBCCCW
DCBRECBT EQU   DCBRECAD
DCBRCREL EQU   DCBRECBT
@NM00071 EQU   IHADCS40+12
DCBEROPT EQU   @NM00071
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
QDB      EQU   0
QDBFELMP EQU   QDB+12
DSAB     EQU   0
DSABFCHN EQU   DSAB+4
DSABTIOT EQU   DSAB+16
DSABGIDP EQU   DSAB+24
DSABANMP EQU   DSAB+28
DSABORG  EQU   DSAB+32
DSABORG1 EQU   DSABORG
DSABORG2 EQU   DSABORG+1
DSABFLG1 EQU   DSAB+34
DSABFLG2 EQU   DSAB+35
DSABFLG3 EQU   DSAB+36
DSABFLG4 EQU   DSAB+37
DSABANMI EQU   0
DSABGIDL EQU   0
TIOT1    EQU   0
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00093 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
IECSDSF1 EQU   0
IECSDSL1 EQU   0
DS1LSTAR EQU   IECSDSL1+98
COMRTN   EQU   0
SYNMSG   EQU   8
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
UCBBGN   EQU   0
UPTX     EQU   0
ECTX     EQU   0
ECB      EQU   0
GTPB     EQU   0
GTPBLINE EQU   GTPB+4
PARM433  EQU   0
@NM00034 EQU   PARM433
PARMDEFR EQU   @NM00034
EXITSTMT EQU   @NM00034
SUSPENDI EQU   PARM433+4
WTG      EQU   0
FROM     EQU   0
TO       EQU   0
LENFR    EQU   0
LENTO    EQU   0
OUTFX    EQU   OUTA1
ANSPTR   EQU   TYPE
GLINE    EQU   GETBLK+4
NAMESAV  EQU   AREA
COPTN    EQU   FLSEPATH
CFLUSH   EQU   COPTN
CNOFLUSH EQU   COPTN
CPROMPT  EQU   COPTN
CNOPROM  EQU   COPTN
CLIST    EQU   COPTN
CNOLIST  EQU   COPTN
CCONLST  EQU   COPTN
CNOCONLS EQU   COPTN
CSYMLST  EQU   COPTN+1
CNOSYMLS EQU   COPTN+1
CMSG     EQU   COPTN+1
CNOMSG   EQU   COPTN+1
CTMAIN   EQU   COPTN+1
@NM00006 EQU   FLSEPATH
@NM00007 EQU   @NM00006
ERROFF   EQU   @NM00007
NOERROR  EQU   @NM00007
ENDERACT EQU   @NM00006+1
@NM00008 EQU   FLSEPATH
@NM00009 EQU   @NM00008
DOWHILE  EQU   @NM00009
DDFLSE   EQU   @NM00008+1
@NM00010 EQU   FLSEPATH
READCNT  EQU   @NM00010
READNAME EQU   @NM00010+2
STAXPARM EQU   STAXDT
@NM00015 EQU   STAXPARM+16
STXATTON EQU   @NM00015
STXATTOF EQU   @NM00015
SWS      EQU   SWSAREA
SEPS     EQU   SWS+1
ENDDLM   EQU   SWS+1
QUIT     EQU   SWS+1
MATCH    EQU   SWS+1
SKPCOMMA EQU   SWS+1
SKIP1    EQU   SWS+2
ERRRANGE EQU   SWS+2
ATRANGE  EQU   SWS+2
RCABEND  EQU   SWS+3
NODATA   EQU   SWS+3
STAECNTL EQU   SWS+3
STABND   EQU   SWS+3
SW2      EQU   SW2AREA
CONTINU  EQU   SW2
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCDSABQ EQU   JSCBSEC3+60
JSCSCT   EQU   JSCBSEC3+68
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
TIOENTRY EQU   TIOT1+24
TIOESTTA EQU   TIOENTRY+1
TIOERLOC EQU   TIOENTRY+2
TIOELINK EQU   TIOERLOC+1
TIOESYOT EQU   TIOELINK
TIOEDDNM EQU   TIOENTRY+4
TIOESTTC EQU   TIOENTRY+15
TIOESTTB EQU   TIOENTRY+16
TIOEFSRT EQU   TIOENTRY+17
POOLSTAR EQU   TIOENTRY+20
TIOEDEVE EQU   TIOESTTB
TIOSTTB  EQU   TIOEDEVE
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00092 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
REGAREAS EQU   STAEREGS+8
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBSPNM EQU   JFCBS001+45
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00097 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00096 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00095 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00092
UCBSKPFG EQU   @NM00092
UCBRIPND EQU   @NM00092
UCBRTIAC EQU   @NM00092
UCBRSV79 EQU   @NM00092
UCBRSV78 EQU   @NM00092
UCBRSV77 EQU   @NM00092
UCBOLTEP EQU   @NM00092
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00091 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
TIOUCBP  EQU   TIOEDEVE+1
TIOVERF  EQU   TIOSTTB
TIOUNLD  EQU   TIOSTTB
TIOMNTD  EQU   TIOSTTB
TIOSETU  EQU   TIOSTTB
TIOVLSR  EQU   TIOSTTB
TIOPVIO  EQU   TIOSTTB
TIOREQD  EQU   TIOSTTB
TIOUSED  EQU   TIOSTTB
TIOTFEND EQU   POOLSTAR+16
TIOPSLOT EQU   POOLSTAR+13
TIOPSTTB EQU   POOLSTAR+12
TIOPPOOL EQU   POOLSTAR+4
TIOPNSRT EQU   POOLSTAR+3
@NM00089 EQU   POOLSTAR+2
TIOPNSLT EQU   POOLSTAR+1
@NM00088 EQU   POOLSTAR
TIOSVERF EQU   TIOESTTB
TIOSUNLD EQU   TIOESTTB
TIOSMNTD EQU   TIOESTTB
TIOSSETU EQU   TIOESTTB
TIOSVLSR EQU   TIOESTTB
TIOSPVIO EQU   TIOESTTB
TIOSREQD EQU   TIOESTTB
TIOSUSED EQU   TIOESTTB
TIOSBALS EQU   TIOESTTC
TIOSBALP EQU   TIOESTTC
TIOSVOLS EQU   TIOESTTC
TIOSVOLP EQU   TIOESTTC
TIOSAFFS EQU   TIOESTTC
TIOSAFFP EQU   TIOESTTC
TIOSDEFR EQU   TIOESTTC
TIOSDKCR EQU   TIOESTTC
TIOEJFCB EQU   TIOENTRY+12
TIOTREM  EQU   TIOELINK
TIOESSDS EQU   TIOESYOT
TIOESYIN EQU   TIOELINK
TIOEQNAM EQU   TIOELINK
TIOEDYNM EQU   TIOELINK
TIOTTERM EQU   TIOELINK
TIOTRV01 EQU   TIOELINK
TIOSYOUT EQU   TIOELINK
TIOEWTCT EQU   TIOERLOC
TIOSDSP2 EQU   TIOESTTA
TIOSDSP1 EQU   TIOESTTA
TIOSLABL EQU   TIOESTTA
TIOSDADS EQU   TIOESTTA
TIOSJBLB EQU   TIOESTTA
TIOSPLTS EQU   TIOESTTA
TIOSPLTP EQU   TIOESTTA
TIOSLTYP EQU   TIOESTTA
TIOELNGH EQU   TIOENTRY
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00082 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00081 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
RECURSE  EQU   SW2
CORE     EQU   SW2
BACKUP   EQU   SWS+2
LISTED   EQU   SWS+2
FOLD     EQU   SWS+2
LISTONLY EQU   SWS+2
SENTINAL EQU   SWS+2
INSTHEN  EQU   SWS+1
NOAMPER  EQU   SWS+1
SYSUPDTE EQU   SWS+1
EXITC    EQU   SWS
ALPHA    EQU   SWS
LEAP     EQU   SWS
RANGE    EQU   SWS
WAIT     EQU   SWS
FREESW   EQU   SWS
EXITB    EQU   SWS
EXITA    EQU   SWS
@NM00018 EQU   STAXPARM+17
@NM00017 EQU   @NM00015
@NM00016 EQU   @NM00015
@NM00014 EQU   STAXPARM
@NM00036 EQU   @NM00034+1
@NM00035 EQU   @NM00034
EOCLIST  EQU   @NM00034
@NM00026 EQU   GTPB
ECBCBIT  EQU   ECB
@NM00037 EQU   ECB
DS1END   EQU   IECSDSL1+140
DS1PTRDS EQU   IECSDSL1+135
DS1EXT3  EQU   IECSDSL1+125
DS1EXT2  EQU   IECSDSL1+115
DS1EXT1  EQU   IECSDSL1+105
@NM00101 EQU   IECSDSL1+103
DS1TRBAL EQU   IECSDSL1+101
DS1SCALO EQU   IECSDSL1+94
DS1DSIND EQU   IECSDSL1+93
DS1RKP   EQU   IECSDSL1+91
DS1KEYL  EQU   IECSDSL1+90
DS1LRECL EQU   IECSDSL1+88
DS1BLKL  EQU   IECSDSL1+86
DS1OPTCD EQU   IECSDSL1+85
DS1RECFM EQU   IECSDSL1+84
DS1DSORG EQU   IECSDSL1+82
@NM00100 EQU   IECSDSL1+75
DS1SYSCD EQU   IECSDSL1+62
@NM00099 EQU   IECSDSL1+61
DS1NOBDB EQU   IECSDSL1+60
DS1NOEPV EQU   IECSDSL1+59
DS1EXPDT EQU   IECSDSL1+56
DS1CREDT EQU   IECSDSL1+53
DS1VOLSQ EQU   IECSDSL1+51
DS1DSSN  EQU   IECSDSL1+45
DS1FMTID EQU   IECSDSL1+44
DS1DSNAM EQU   IECSDSL1
@NM00098 EQU   IECSDSF1
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00094 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00093
UCBHALI  EQU   @NM00093
UCBRSV09 EQU   @NM00093
UCBRSV08 EQU   @NM00093
UCBRSV07 EQU   @NM00093
UCBRSV06 EQU   @NM00093
UCBRSV05 EQU   @NM00093
UCBRSV04 EQU   @NM00093
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00090 EQU   UCB
TIOCSTEP EQU   TIOT1+8
TIOCNJOB EQU   TIOT1
DSABGRID EQU   DSABGIDL+4
DSABLLEN EQU   DSABGIDL
DSABANAM EQU   DSABANMI+1
DSABANML EQU   DSABANMI
DSABRS04 EQU   DSAB+68
DSABSIOT EQU   DSAB+64
DSABRS03 EQU   DSAB+62
DSABDCBM EQU   DSAB+56
DSABSSCM EQU   DSAB+52
DSABSSNM EQU   DSAB+48
DSABPTTR EQU   DSAB+44
DSABTCBP EQU   DSAB+40
DSABRS02 EQU   DSAB+38
@NM00087 EQU   DSABFLG4
DSABCKSI EQU   DSABFLG4
DSABCKVL EQU   DSABFLG4
DSABCKDS EQU   DSABFLG4
@NM00086 EQU   DSABFLG3
DSABJSCT EQU   DSABFLG3
DSABCATL EQU   DSABFLG3
DSABVMSC EQU   DSABFLG3
DSABVAM  EQU   DSABFLG3
DSABPASS EQU   DSABFLG3
DSABDEFR EQU   DSABFLG3
@NM00085 EQU   DSABFLG2
DSABUNAL EQU   DSABFLG2
DSABIRM  EQU   DSABFLG2
DSABOPEN EQU   DSABFLG2
DSABNUSE EQU   DSABFLG1
DSABCATM EQU   DSABFLG1
DSABPCAT EQU   DSABFLG1
DSABDCAT EQU   DSABFLG1
DSABCONV EQU   DSABFLG1
DSABDCNV EQU   DSABFLG1
DSABPALC EQU   DSABFLG1
DSABDALC EQU   DSABFLG1
@NM00084 EQU   DSABORG2
DSABTR   EQU   DSABORG2
DSABAM   EQU   DSABORG2
@NM00083 EQU   DSABORG2
DSABTQ   EQU   DSABORG2
DSABTX   EQU   DSABORG2
DSABGS   EQU   DSABORG2
DSABU    EQU   DSABORG1
DSABPO   EQU   DSABORG1
DSABMQ   EQU   DSABORG1
DSABCQ   EQU   DSABORG1
DSABCX   EQU   DSABORG1
DSABDA   EQU   DSABORG1
DSABPS   EQU   DSABORG1
DSABIS   EQU   DSABORG1
DSABSSVA EQU   DSAB+21
DSABRS01 EQU   DSAB+20
DSABOPCT EQU   DSAB+14
DSABLNTH EQU   DSAB+12
DSABBCHN EQU   DSAB+8
DSABID   EQU   DSAB
QDBRV002 EQU   QDB+28
QDBPRDS  EQU   QDB+26
QDBPRSZ  EQU   QDB+24
QDBBPTDS EQU   QDB+22
QDBFPTDS EQU   QDB+20
QDBLELMP EQU   QDB+16
QDBNELMS EQU   QDB+8
QDBRV001 EQU   QDB+6
QDBATTR  EQU   QDB+4
QDBQDB   EQU   QDB
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00080 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00079 EQU   IEZJSCB
@NM00078 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00077 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00076 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00075 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
DCBEOB   EQU   IHADCS40+20
DCBPRECL EQU   IHADCS40+18
@NM00074 EQU   IHADCS40+16
@NM00073 EQU   @NM00071+1
@NM00072 EQU   DCBEROPT
DCBERABE EQU   DCBEROPT
DCBERSKP EQU   DCBEROPT
DCBERACC EQU   DCBEROPT
@NM00070 EQU   IHADCS40+10
@NM00069 EQU   IHADCS40+9
@NM00068 EQU   IHADCS40+8
DCBRECA  EQU   DCBRECAD+1
@NM00067 EQU   DCBRECBT
DCBRCFGT EQU   DCBRCREL
DCBRCTRU EQU   DCBRCREL
DCBLCCW  EQU   DCBEOBAD
DCBNOTE  EQU   DCBCNTRL
@NM00066 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00065 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00064 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00063 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00062 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00061 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00060 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
DCBOPTJ  EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBPUTA  EQU   DCBGETA
@NM00059 EQU   DCBPUT
DCBREADA EQU   DCBWRITA
@NM00058 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00057 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00056 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00055 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00054 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00053 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00052 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00051 EQU   DCBDSRG1
@NM00050 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00049 EQU   IHADCS01+5
@NM00048 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00047 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
@NM00046 EQU   IHADCB
@NM00045 EQU   ECT+52
@NM00044 EQU   ECT+48
@NM00043 EQU   ECT+44
@NM00042 EQU   ECTSWS2+1
@NM00041 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00040 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
LSDTOTLN EQU   LSD+6
LSDRCLEN EQU   LSD+4
LSDADATA EQU   LSD
DYNAREA  EQU   COMAREA+300
@NM00039 EQU   @NM00038+54
EXECDPTR EQU   @NM00038+24
@NM00033 EQU   @NM00032
@NM00031 EQU   @NM00030+4
@NM00029 EQU   INSCODE
@NM00028 EQU   INSCODE
INSTERM  EQU   INSCODE
NEWC     EQU   @NM00025+4
NEWOO    EQU   @NM00025+2
NEWLL    EQU   @NM00025
SVTELFST EQU   SVTAB+16
SVTABFRE EQU   SVTAB+12
SVTABUSE EQU   SVTAB+8
SVTABLNG EQU   SVTAB+4
SVTABNXT EQU   SVTAB
SNTDATA  EQU   SNTELEM+8
SNTLNG   EQU   SNTELEM+6
@NM00023 EQU   SNTFLAGS+1
SNTLAST  EQU   SNTFLAGS
SNTEVAL  EQU   SNTFLAGS
SNTNAUTH EQU   SNTFLAGS
SNTLABEL EQU   SNTFLAGS
SNTKEYW  EQU   SNTFLAGS
SNTKEY   EQU   SNTFLAGS
SNTPOSIT EQU   SNTFLAGS
SNTGVAL  EQU   SNTVLPTR
SNTELFST EQU   SNTAB+12
SNTABUSE EQU   SNTAB+8
SNTABLNG EQU   SNTAB+4
SNTABNXT EQU   SNTAB
@NM00022 EQU   EXECDATA+60
RETPTR2  EQU   EXECDATA+52
GEXECCNT EQU   EXECDATA+36
ATINCNTL EQU   @NM00021+1
GEXECDAT EQU   EXECDATA+8
SVTABFST EQU   EXECDATA+4
SNTABFST EQU   EXECDATA
GOO      EQU   @NM00011+2
@NM00004 EQU   @NM00003
@NM00002 EQU   @NM00001+4
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00177 EQU   @EL00005
@RC00188 EQU   @EL00005
@RC00186 EQU   @EL00005
@RC00192 EQU   @EL00005
@RF00207 EQU   @EL00007
@RF00219 EQU   @EL00008
@RC00217 EQU   @EL00008
@RF00245 EQU   @EL00010
@RF00257 EQU   @EL00010
@RF00405 EQU   @EL00014
@RF00423 EQU   @RC00410
@RC00453 EQU   @RC00449
@RC00450 EQU   @RC00449
@RF00487 EQU   @RC00470
@RC00442 EQU   @EL00015
@RF00566 EQU   @EL00016
@RC00582 EQU   @EL00016
@RC00602 EQU   @EL00017
@RC00653 EQU   @RC00650
@RF00676 EQU   @RC00650
@RC00724 EQU   @EL00019
@RC00784 EQU   @RC00781
@RF00745 EQU   @EL00020
@RC00756 EQU   @EL00020
@RC00857 EQU   @EL00020
@RF00912 EQU   @EL00021
@RF00919 EQU   @EL00022
@RC00922 EQU   @EL00022
@RF00926 EQU   @EL00022
@RC00957 EQU   @EL00024
@RF00987 EQU   @EL00026
@RC01022 EQU   @RC01021
@RC01041 EQU   @RC01040
@RF01050 EQU   @EL00027
@RC01060 EQU   @EL00027
@RC01052 EQU   @EL00027
@RF00528 EQU   @RC00442
@RF00629 EQU   @RC00602
@RC01053 EQU   @RC01052
@ENDDATA EQU   *
         END   IKJCT436,(C'PLS1750',0701,77084)

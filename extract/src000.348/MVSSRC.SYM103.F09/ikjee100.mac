         TITLE 'IKJEE100 - OPERATOR COMMAND PROCESSOR                  *
                        '
         TITLE 'IKJEE100 - OPERATOR COMMAND PROCESSOR'
         EJECT
IKJEE100 CSECT ,                                                   0003
@MAINENT DS    0H                                                  0003
         USING *,@15                                               0003
         B     @PROLOG                                             0003
         DC    AL1(16)                                             0003
         DC    C'IKJEE100  75.350'                                 0003
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0003
         STM   @00,@12,20(@13)                                     0003
         BALR  @08,0                                               0003
@PSTART  LA    @11,4095(,@08)                                      0003
         USING @PSTART,@08                                         0003
         USING @PSTART+4095,@11                                    0003
         L     @00,@SIZDATD                                        0003
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0003
         USING @DATD,@12                                           0003
         ST    @13,@SA00001+4                                      0003
         LM    @00,@01,20(@13)                                     0003
         ST    @12,8(,@13)                                         0003
         LR    @13,@12                                             0003
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0003
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
         EJECT
*   SAVECPPL=R1;                    /* SAVE PARAMETER ADDR           */
         ST    R1,SAVECPPL                                         0179
*   RESPECIFY                                                      0180
*    (R1) UNRSTD;                   /* FREE REG FOR COMPILER USAGE   */
*   EXITERR='0'B;                   /* INITIALIZE THE EXIT ERROR FLG */
*                                                                  0181
         NI    EXITERR,B'11011111'                                 0181
*   /*****************************************************************/
*   /*                                                               */
*   /* THE SERVICE ROUTINES - PUTLINE, GETLINE, STACK AND PTGET ARE  */
*   /* LOADED. THE STACK AND GETLINE SERVICE ROUTINES ARE USED ONLY  */
*   /* BY THE ATTENTION EXIT ROUTINE, IKJEE150. THE ENTRY POINT      */
*   /* ADDRESSES ARE PASSED TO THE EXIT ROUTINE FOR ITS USE ALL ENTRY*/
*   /* POINT ADDRESSES OF THE SERVICE ROUTINES ARE SAVED IN THE      */
*   /* OPERATOR'S WORKAREA AND USED FOR BRANCHING DIRECTLY TO THE    */
*   /* ROUTINE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0182
*   RESPECIFY                                                      0182
*    (R0) RESTRICTED;               /* RESTRICT USAGE ACROSS MACROS  */
*   GEN(LOAD EP=IKJPTGT);           /* LOAD PUTGET SERVICE ROUTINE   */
         LOAD EP=IKJPTGT
*   WORK2=R0;                       /* SAVE ENTRY POINT OF PUTGET SR */
         ST    R0,WORK2                                            0184
*   GEN(LOAD EP=IKJPUTL);           /* LOAD PUTLINE SERVICE ROUTINE  */
         LOAD EP=IKJPUTL
*   WORK6=R0;                       /* SAVE ENTRY POINT PF PUTLINE SR*/
         ST    R0,WORK6                                            0186
*   GEN(LOAD EP=IKJSTCK);           /* LOAD STACK SERVICE ROUTINE    */
         LOAD EP=IKJSTCK
*   PTRSTACK=R0;                    /* SAVE ENTRY PNT OF STACK SR    */
         ST    R0,PTRSTACK                                         0188
*   GEN(LOAD EP=IKJGETL);           /* LOAD GETLINE SERVICE ROUTINE  */
         LOAD EP=IKJGETL
*   GETLPTR=R0;                     /* SAVE ENTRY PNT OF GETLINE SR  */
         ST    R0,GETLPTR                                          0190
*   RESPECIFY                                                      0191
*    (R0) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*                                                                  0191
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION OF FIBPARMS PARAMETER LIST                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0192
*   FIBMAINP=ADDR(FIBPARMS);        /* PICK UP THE ADDRESS OF SVC  0192
*                                      LIST                          */
         LA    @10,FIBPARMS                                        0192
         ST    @10,FIBMAINP                                        0192
*   FIBPARMS=FIBPARMS&&FIBPARMS;    /* CLEAR THE LIST                */
         XC    FIBPARMS(32),FIBPARMS                               0193
*   FIBCPPL=SAVECPPL;               /* INITIALIZE PARAMETER LIST TO
*                                      SVC 100 WITH ADDR OF CPPL     */
         MVC   FIBCPPL(4),SAVECPPL                                 0194
*   FIBID=FIBOPER;                  /* CODE FOR OPERATOR CALL TO SVC */
         MVC   FIBID(2),@CH01132                                   0195
*   FIBUSER=ADDR(CALLPARM);         /* ADDRESS OF OPERATOR EXTENSION */
         LA    @10,CALLPARM                                        0196
         ST    @10,FIBUSER                                         0196
*   CALLPARM=CALLPARM&&CALLPARM;    /* CLEAR THE EXTENSION LIST      */
         XC    CALLPARM(24),CALLPARM                               0197
*   FIBHIGH='1'B;                   /* END OF THE PARMAMETER LIST    */
         OI    FIBHIGH,B'10000000'                                 0198
*   FIBLEN=LENGTH(CALLPARM);        /* CALCULATE LENGTH OF EXTENSION */
         MVC   FIBLEN(2),@CH00041                                  0199
*   RECURSON=ZEROS;                 /* RESET THE STAE RECURSION CNTR */
         MVC   RECURSON(2),ZEROS+2                                 0200
*   GEN(EJECT);                                                    0201
*                                                                  0201
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE MULTI-LEVEL MESSAGE CHAIN FOR LATER USE BY PUTGET  */
*   /* AND PUTLINE SERVICE ROUTINES                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0202
*BEGNAGAN:                                                         0202
*   IOPLUPT=CPPLUPT;                /* INITIALIZE SERVICE RTNS       */
BEGNAGAN LA    @10,SRPARM                                          0202
         L     @09,SAVECPPL                                        0202
         MVC   IOPLUPT(4,@10),CPPLUPT(@09)                         0202
*   IOPLECT=CPPLECT;                /* PARAMETERS                    */
         MVC   IOPLECT(4,@10),CPPLECT(@09)                         0203
*   IOPLECB=ADDR(CPECB);            /* ADDR OF CP'S ECB              */
         LA    @07,CPECB                                           0204
         ST    @07,IOPLECB(,@10)                                   0204
*   NXTLVMSG=ADDR(ENDCHAIN);        /* CHAIN 1ST AND 2ND LEVEL MSGS  */
         LA    @10,ENDCHAIN                                        0205
         ST    @10,NXTLVMSG                                        0205
*   ENDCHAIN=LASTLVL;               /* SET END OF CHAIN INDICATOR    */
         MVC   ENDCHAIN(4),LASTLVL                                 0206
*   NOMSGSG1=ONE;                   /* ONE MESSAGE SEGMENT FOR 1ST 0207
*                                      LEV                           */
         MVC   @TF00001(4),ONE                                     0207
         L     @10,@TF00001                                        0207
         ST    @10,NOMSGSG1                                        0207
*   NOMSGSG2=ONE;                   /* 1 MSG SEG FOR 2ND LEVEL MSG   */
         ST    @10,NOMSGSG2                                        0208
*   MSGSEG1=ADDR(BUFR1);            /* POINT TO FIRST LEVEL TEXT     */
         LA    @10,BUFR1                                           0209
         ST    @10,MSGSEG1                                         0209
*   MSGSEG2=ADDR(BUFR2);            /* POINT TO SECOND LEVEL TEXT    */
         LA    @10,BUFR2                                           0210
         ST    @10,MSGSEG2                                         0210
*   NOMSG='0'B;                     /* CLEAR FLAG                    */
         NI    NOMSG,B'10111111'                                   0211
*   TERMID=ZEROS;                   /* CLEAR ASID FIELD IN PARMLIST
*                                      TO SVC 100                    */
*                                                                  0212
         L     @10,ZEROS                                           0212
         STH   @10,TERMID                                          0212
*   /*****************************************************************/
*   /*                                                               */
*   /* THE PARAMETER LIST FOR THE ATTENTION AND STAE/STAI EXIT       */
*   /* ROUTINES IS INITIALIZED STAE RETRY ROUTINE USES THIS CODE WHEN*/
*   /* OPERATOR OR ONE OF ITS SUBCOMMANDS HAS ABENDED TO REINITIALIZE*/
*   /* ALL PARAMETER BLOCKS AND ESTABLISH ANOTHER STAE ENVIRONMENT   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   CSOAPTR=ADDR(CMDSCAN);          /* ADDR OF CMDSCAN OUTPUT AREA   */
         LA    @15,CMDSCAN                                         0213
         ST    @15,CSOAPTR                                         0213
*   PTRCPPL=SAVECPPL;               /* ADDR OF CPPL                  */
         ST    @09,PTRCPPL                                         0214
*   PTRCPECB=ADDR(CPECB);           /* ADDR OF CP ECB                */
         ST    @07,PTRCPECB                                        0215
*   CPECB=ZEROS;                    /* CLEAR CP'S ECB                */
         ST    @10,CPECB                                           0216
*   PTRPUTL=WORK6;                  /* ADDR OF PUTLINE SR            */
         MVC   PTRPUTL(4),WORK6                                    0217
*   PTRGETL=GETLPTR;                /* ADDR OF GETLINE SR            */
         MVC   PTRGETL(4),GETLPTR                                  0218
*   STAEAREA=ADDR(STAEWORK);        /* ADDR OF STAE EXIT RTN W/A     */
         LA    @09,STAEWORK                                        0219
         ST    @09,STAEAREA                                        0219
*   ATTNAREA=ADDR(ATTNWORK);        /* ADDR OF ATTN EXIT RTN W/A     */
         LA    @09,ATTNWORK                                        0220
         ST    @09,ATTNAREA                                        0220
*   ATTNSAVE=ADDR(ATTNSA);          /* ADDR OF ATTN EXIT REGSAVE     */
         LA    @09,ATTNSA                                          0221
         ST    @09,ATTNSAVE                                        0221
*   STAESAVE=ADDR(STAESA);          /* ADDR OF STAE EXIT REGSAVE     */
         LA    @09,STAESA                                          0222
         ST    @09,STAESAVE                                        0222
*   EXITFLAG=ZEROS;                 /* CLEAR FLAGS                   */
         STC   @10,EXITFLAG                                        0223
*   REGISTR8=R8;                    /* SAVE DATA BASE                */
         ST    R8,REGISTR8                                         0224
*   RESPECIFY                                                      0225
*    (R11) RSTD;                    /* RESTRICT REGISTER USAGE       */
*   BASE100=R11;                    /* SAVE BASE REG                 */
         ST    R11,BASE100                                         0226
*   RESPECIFY                                                      0227
*    (R11) UNRSTD;                  /* FREE FOR THE COMPILER         */
*   ATCHECB=ZEROS;                  /* ZERO OUT ATTACH HELP ECB      */
         ST    @10,ATCHECB                                         0228
*   ATTACHCB=ADDR(ATCHECB);         /* POINT TO HELP ECB FOR ATTN    */
         LA    @09,ATCHECB                                         0229
         ST    @09,ATTACHCB                                        0229
*   RESPECIFY                                                      0230
*    (R13) RSTD;                    /* RESTRICT REGISTER USAGE       */
*   SAVE13=R13;                     /* SAVE REGISTER FOR LATER STAE
*                                      RETRY ROUTINE                 */
         ST    R13,SAVE13                                          0231
*   RESPECIFY                                                      0232
*    (R13) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   RESPECIFY                                                      0233
*    (R12) RSTD;                    /* RESTRICT REGISTER USAGE       */
*   WORKADDR=R12;                   /* ESTABLISH WORKAREA ADDRESSING
*                                      FOR STAE ROUTINE              */
         ST    R12,WORKADDR                                        0234
*   RESPECIFY                                                      0235
*    (R12) UNRSTD;                  /* FREE REGISTER FOR COMPILER    */
*   ATTNBUFF=ZEROS;                 /* INDICATE THAT NO BUFFERS HAVE
*                                      BEEN GOTTEN FOR ATTENTION YET */
         ST    @10,ATTNBUFF                                        0236
*   BUFFPTR=ZEROS;                  /* INITIALIZE BUFFPTR TO ZERO AS
*                                      THERE ARE NO BUFFERS GOTTEN 0237
*                                      YET                           */
*                                                                  0237
         ST    @10,BUFFPTR                                         0237
*   /*****************************************************************/
*   /*                                                               */
*   /* A STAE ENVIRONMENT IS CREATED FOR THE OPERATOR CP AND ITS     */
*   /* SUBCOMMANDS. THE STAE EXIT ROUTINE IS IKJEE1A0 AND THE ADDRESS*/
*   /* OF EXITPARM IS PASSED AS A PARAMETER TO THE STAE EXIT ROUTINE.*/
*   /* THE STAE IS REQUESTED ACROSS XCTL'S TO PROTECT SVC 100        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   STAELIST=STAELST;               /* MOVE STAE PARAMETER LIST TO 0238
*                                      WORKAREA                      */
         MVI   STAELIST+12,C' '                                    0238
         MVC   STAELIST+13(7),STAELIST+12                          0238
         MVC   STAELIST(12),STAELST                                0238
*   R5=ADDR(EXITPARM);              /* POINT TO EXIT PARM LIST       */
         LA    R5,EXITPARM                                         0239
*   GEN;                                                           0240
     STAE  XCTL=YES,PARAM=(5),MF=(E,STAELIST)
*   RESPECIFY                                                      0241
*    (R15) RSTD;                    /* RESTRICT REGISTER USAGE       */
*   IF R15^=ZEROS                   /* IF A STAE ENVIRONMENT COULD 0242
*                                      NOT                           */
*     THEN                          /* BE CREATED, THEN SET UP INPUT */
         C     R15,ZEROS                                           0242
         BE    @RF00242                                            0242
*     DO;                           /* FOR MESSAGE RTN TO ISSUE ERROR
*                                      MSG AND RETURN TO THE TMP     */
*       R6=R15;                     /* SAVE RETURN CODE IN R6        */
         LR    R6,R15                                              0244
*       RESPECIFY                                                  0245
*        (R15) UNRSTD;              /* FREE REG FOR COMPILER         */
*       MSGSEG2B=ADDR(STAESEG);     /* INITIALIZE PUTLINE PARM LIST  */
         LA    @10,STAESEG                                         0246
         ST    @10,MSGSEG2B                                        0246
*       GO TO MSGRTN4;              /* GO PUT OUT MSG & RETURN TO TMP*/
         B     MSGRTN4                                             0247
*     END;                                                         0248
*   GEN(EJECT);                                                    0249
*                                                                  0249
@RF00242 DS    0H                                                  0249
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING SCHEDULES AN ATTENTION EXIT ROUTINE TO BE GIVEN */
*   /* CONTROL WHEN THE USER PRESSES THE ATTENTION KEY WHILE IN      */
*   /* OPERATOR MODE. THE ATTENTION EXIT ROUTINE FOR OPERATOR IS     */
*   /* IKJEE150. THE ADDRESS OF THE WORK AREA IS PASSED AS A         */
*   /* PARAMETER TO THE EXIT ROUTINE. A MODE MESSAGE IS SPECIFIED TO */
*   /* BE PUT TO THE TERMINAL WHEN AN ATTENTION INTERRUPT OCCURS TO  */
*   /* IDENTIFY THE MODULE IN CONTROL. IT ALSO SPECIFIES A REQUEST TO*/
*   /* GET THE NEXT LINE OF INPUT FROM THE TERMINAL. ALL TERMINAL    */
*   /* INPUT AND OUTPUT BUFFERS ARE RELEASED AND ANY PREVIOUS STAX   */
*   /* FOR THIS TASK WILL BE SUPERSEDED.                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*   STAXAREA=STAXL;                 /* MOVE STAX PARMS TO DYNAMIC  0250
*                                      STORAGE                       */
         MVC   STAXAREA(20),STAXL                                  0250
*   MODESEG(1:4)=ATTNMSG;           /* INITIALIZE MSG ISSUED WHEN    */
         MVC   MODESEG(4),ATTNMSG                                  0251
*   MODETEXT(1:8)=ECTPCMD;          /* ATTENTION IS ENTERED, COMMAND
*                                      NAME IS TAKEN FROM ECT        */
         L     @10,SAVECPPL                                        0252
         L     @10,ECTPTR(,@10)                                    0252
         MVC   MODETEXT(8),ECTPCMD(@10)                            0252
*   RFY                                                            0253
*    (R1,                                                          0253
*     R3,                                                          0253
*     R4,                                                          0253
*     R5,                                                          0253
*     R7,                                                          0253
*     R9) RSTD;                     /* RESTRICT REGISTERS FOR MY USE */
*   RFY                                                            0254
*    (R6) RSTD;                     /* RESTRICT REGISTERS FOR MY USE */
*   R7=ADDR(IKJEE150);              /* ADDRESS OF ATTENTION EXIT     */
         L     R7,@CA00383                                         0255
*   R5=ADDR(MODETEXT);              /* ADDRESS OF OUTPUT MSG         */
         LA    R5,MODETEXT                                         0256
*   R6=ADDR(EXITPARM);              /* ADDRESS OF WORKAREA           */
         LA    R6,EXITPARM                                         0257
*   R4=ADDR(AXTEXT);                /* BUFFER ADDRESS FOR INPUT LINE */
         LA    R4,AXTEXT                                           0258
*   R1=ADDR(STAXAREA);              /* ADDR OF PARMLIST              */
         LA    R1,STAXAREA                                         0259
*   R3=EIGHT;                       /* VALUE OF EIGHT                */
         LA    R3,8                                                0260
*   R9=BUFLEN;                      /* BUFFER LENGTH                 */
         LA    R9,132                                              0261
*   GEN;                                                           0262
     STAX  (7),OBUF=((5),(3)),IBUF=((4),(9)),USADDR=(6),MF=(E,(1))
*   RFY                                                            0263
*    (R1,                                                          0263
*     R3,                                                          0263
*     R4,                                                          0263
*     R5,                                                          0263
*     R7,                                                          0263
*     R9) UNRSTD;                   /* FREE REGISTERS FOR COMPILER   */
*                                                                  0264
*   /*****************************************************************/
*   /*                                                               */
*   /* . IF THERE ARE OPERANDS ON THE OPER CMD, TELL THE USER THEY   */
*   /* ARE NOT ALLOWED . PREPARE PARAMETER LIST FOR SVC 100 TO TEST  */
*   /* FOR OPERATOR ABILITY FOR USER . ISSUE SVC 100 . CHECK RETURN  */
*   /* CODES FROM SVC 100 - 00 - TERMINAL USER HAS OPERATOR ABILITY  */
*   /* 80 - TERMINAL USER DOES NOT HAVE OPERATOR ABILITY             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0264
*   IF ECTNOPD^='1'B                /* OPER CMD HAS NO OPERANDS      */
*     THEN                                                         0264
         L     @10,SAVECPPL                                        0264
         L     @10,ECTPTR(,@10)                                    0264
         TM    ECTNOPD(@10),B'10000000'                            0264
         BNO   @RT00264                                            0264
*     GO TO MSGRTN1;                /* OPERANDS EXIST ON OPERATOR CMD*/
*TESTABIL:                                                         0266
*   CALL CLEAR;                     /* CLEAR INPUT AND OUTPUT BUFFERS*/
TESTABIL BAL   @14,CLEAR                                           0266
*   AUTHCHK='1'B;                   /* FLAG INDICATES TO ONLY TEST 0267
*                                      OPERATOR ABILITY              */
*   CMDCHK='0'B;                    /* RESET CMD CHECK FLAG TO ZERO  */
*   OFFGETBF='0'B;                  /* RESET BUFFER FLAG TO ZERO     */
         OI    AUTHCHK,B'10000000'                                 0269
         NI    CMDCHK,B'10101111'                                  0269
*   RESPECIFY                                                      0270
*    (R1,                                                          0270
*     R15) RSTD;                    /* RESTRICT REGS ACROSS SVC      */
*   R1=ADDR(FIBMAINP);              /* POINT TO PARM LIST TO SVC 100 */
         LA    R1,FIBMAINP                                         0271
*   SVC(100);                       /* SVC FOR FIB, PROF AND OPER TSO
*                                      COMMANDS....IKJEFFS0 PL/S   0272
*                                      MACRO                         */
         SVC   100                                                 0272
*   IF R15^=FIBOKRC                 /* TERMINAL USER HAVE OPERATOR-  */
*     THEN                          /* ABILITY, CONTINUE PROCESSING  */
         LTR   R15,R15                                             0273
         BNZ   @RT00273                                            0273
*     GO TO MSGRTN2;                /* OTHERWISE, GO TO MSGRTN2      */
*   RESPECIFY                                                      0275
*    (R1,                                                          0275
*     R15) UNRSTD;                  /* FREE REGS FOR COMPILER USAGE  */
*   GEN(EJECT);                                                    0276
*                                                                  0276
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP PARAMETERS FOR MESSAGE ROUTINE: ISSUE MODE MESSAGE     */
*   /* THROUGH PUT/GET PREPARE TO RECEIVE COMMAND FROM USER MODE     */
*   /* MESSAGE = OPERATOR OR OPER MESSAGE ROUTINE = PUT/GET          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0277
*   CALL CLEAR;                     /* CLEAR INPUT/OUTPUT BUFFERS    */
         BAL   @14,CLEAR                                           0277
*   LNGBUF1=LNGMSG2A;               /* INITIALIZE LENGTH OF MODE MSG */
         MVC   LNGBUF1(2),LNGMSG2A                                 0278
*   OUTBUFF1(1)=BLANK;              /* NO MESSAGE IDENTIFIER         */
         MVC   OUTBUFF1(1),BLANK                                   0279
*   OUTBUFF1(2:9)=ECTPCMD;          /* PUT CMD NAME IN BUFFER        */
         L     @10,SAVECPPL                                        0280
         L     @10,ECTPTR(,@10)                                    0280
         MVC   OUTBUFF1+1(8),ECTPCMD(@10)                          0280
*   GO TO SCAN;                     /* GO TO CALL COMMAND SCAN TO  0281
*                                      LINE OF INPUT RECEIVED        */
         B     SCAN                                                0281
*OPERABIL:                                                         0282
*                                                                  0282
*/*                                                                0282
*    THE MODE MESSAGE OPERATOR IS ONLY PUT TO THE TERMINAL WHEN    0282
*    OPERATOR MODE IS FIRST ENTERED, AFTER AN ATTENTION HAS BEEN   0282
*    ENTERED, OR OPERATOR OR ONE OF ITS SUBCOMMANDS HAS ABENDED.   0282
*    ON ALL OTHER CALLS TO PUTGET, A ZERO ADDRESS IS PASSED        0282
*    INDICATING NOT TO PUT OUT A MODE MESSAGE BUT GET ANOTHER      0282
*    LINE OF INPUT.                                                0282
*                                                                    */
*                                                                  0282
*   NOMSG='1'B;                     /* INDICATE NO MSG TO PUT OUT    */
OPERABIL OI    NOMSG,B'01000000'                                   0282
*   GEN(EJECT);                                                    0283
*                                                                  0283
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* . BRANCH TO PUTGET ROUTINE TO ISSUE MODE MESSAGE IF NECESSARY,*/
*   /* AND GET A LINE OF INPUT FROM THE TERMINAL . BRANCH TO COMMAND */
*   /* SCAN ROUTINE TO LOCATE THE COMMAND IN THE COMMAND BUFFER .    */
*   /* TEST COMMAND SCAN FLAGS TO DETERMINE THE INPUT RECEIVED FROM  */
*   /* THE USER                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0284
*SCAN:                                                             0284
*   RECURSON=ZEROS;                 /* RESET THE STAE RECURSION CNTR */
SCAN     MVC   RECURSON(2),ZEROS+2                                 0284
*   CALL PUTGTRTN;                  /* GO TO PUTGET SUBRTN TO PUT  0285
*                                      MODE MSG TO TERMINAL IF     0285
*                                      INDICATED AND GET A LINE OF 0285
*                                      INPUT                         */
         BAL   @14,PUTGTRTN                                        0285
*   SYNCHK='1'B;                    /* FLAG IN CMD SCAN PARMLST IN-
*                                      INDICATING NOT TO SYNTAX CHECK
*                                      COMMAND NAME                  */
         OI    SYNCHK,B'10000000'                                  0286
*   CSPLFLG=ADDR(FLAGWORD);         /* PTR TO CMDSCAN FLAGWORD       */
         LA    @10,SRPARM                                          0287
         LA    @09,FLAGWORD                                        0287
         ST    @09,CSPLFLG(,@10)                                   0287
*   CSPLCBUF=ADDR(CMDBUFFR);        /* PTR TO COMMAND BUFFER         */
         MVC   CSPLCBUF(4,@10),WORK7                               0288
*   CSPLOA=CSOAPTR;                 /* PTR TO CMDSCAN OUTPUT AREA    */
         MVC   CSPLOA(4,@10),CSOAPTR                               0289
*   RESPECIFY                                                      0290
*    (R1,                                                          0290
*     R15) RSTD;                    /* RESTRICT REGISTER USAGE       */
*   R1=ADDR(SRPARM);                /* ADDR OF CMDSCAN PARMS         */
         LR    R1,@10                                              0291
*   GEN REFS(R1);                                                  0292
     LINK EP=IKJSCAN               LINK TO COMMAND SCAN SERVICE ROUTINE
*   RESPECIFY                                                      0293
*    (R1) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*   IF R15^=ZEROS                   /* TEST FOR INVALID PARAMETERS 0294
*                                      FROM COMMAND SCAN             */
*     THEN                          /* IF ERROR, SAVE RETURN CODE    */
         C     R15,ZEROS                                           0294
         BE    @RF00294                                            0294
*     DO;                           /* AND GO TO ERROR MSG RTN       */
*       R6=R15;                     /* SAVE THE RETURN CODE          */
         LR    R6,R15                                              0296
*       RESPECIFY                                                  0297
*        (R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*       MSGSEG2B=ADDR(CMDSCNSG);    /* POINT TO COMMAND SCAN SEG     */
         LA    @10,CMDSCNSG                                        0298
         ST    @10,MSGSEG2B                                        0298
*       GO TO MSGRTN4;              /* GO ISSUE THE MESSAGE          */
         B     MSGRTN4                                             0299
*     END;                          /* END OF CMD SCAN FAIL        0300
*                                      PROCESSING                    */
*SCANTEST:                          /* BRANCH ADDRESS WHEN A NEW   0301
*                                      COMMAND IS ENTERED DURING AN
*                                      ATTENTION EXIT AND THE CP ECB
*                                      IS POSTED. COMMAND WAS SCANNED
*                                      BY COMMAND SCAN IN THE      0301
*                                      ATTENTION EXIT RTN.           */
*   IF CSOANOC='1'B                 /* CHECK FOR AN EMPTY BUFFER     */
*     THEN                                                         0301
@RF00294 DS    0H                                                  0301
SCANTEST L     @10,CSOAPTR                                         0301
         TM    CSOANOC(@10),B'00010000'                            0301
         BO    @RT00301                                            0301
*     GO TO OPERABIL;               /* BUFFER EMPTY - GO GET ANOTHER
*                                      LINE OF INPUT                 */
*   IF CSOABAD='1'B                 /* CHK FOR SYNTACTICALLY INVAL 0303
*                                      CMD                           */
*     THEN                          /* SYNTACTICALLY INVALID COMMAND */
         TM    CSOABAD(@10),B'00001000'                            0303
         BO    @RT00303                                            0303
*     GO TO MSGRTN3;                /* GO TO PUT ERROR MSG TO      0304
*                                      TERMINAL                      */
*/*                                                                0305
*    A SYNTACTICALLY VALID COMMAND NAME HAS BEEN FOUND, CONTINUE   0305
*    PROCESSING OF THE COMMAND                                     0305
*                                                                    */
*                                                                  0305
*   IF CSOALNM<EIGHT                /* IF CMD LENGTH IS LESS THAN 8  */
*     THEN                          /* MOVE SUBCOMMAND NAME INTO     */
         LH    @09,CSOALNM(,@10)                                   0305
         CH    @09,@CH00035                                        0305
         BNL   @RF00305                                            0305
*     ECTSCMD=CMDNAME(1:CSOALNM);   /* ECT FOR USE ON ABEND CONDITION*/
         L     @07,SAVECPPL                                        0306
         L     @07,ECTPTR(,@07)                                    0306
         MVI   ECTSCMD+1(@07),C' '                                 0306
         MVC   ECTSCMD+2(6,@07),ECTSCMD+1(@07)                     0306
         BCTR  @09,0                                               0306
         L     @10,CSOACNM(,@10)                                   0306
         EX    @09,@SM01347                                        0306
*   ELSE                            /* ELSE MOVE FIRST EIGHT BYTES OF*/
*     ECTSCMD=CMDNAME(1:8);         /* SUBCOMMAND NAME INTO ECT      */
         B     @RC00305                                            0307
@RF00305 L     @10,SAVECPPL                                        0307
         L     @10,ECTPTR(,@10)                                    0307
         L     @09,CSOAPTR                                         0307
         L     @09,CSOACNM(,@09)                                   0307
         MVC   ECTSCMD(8,@10),CMDNAME(@09)                         0307
*   IF CMDNAME(1:3)=ENDCMD(1:3)&CSOALNM=THREE/* END COMMAND? TEST  0308
*                                      COMMAND ENTERED BY USER       */
*     THEN                          /* REQUEST TP TERMINATE OPERATOR */
@RC00305 L     @10,CSOAPTR                                         0308
         L     @09,CSOACNM(,@10)                                   0308
         CLC   CMDNAME(3,@09),ENDCMD                               0308
         BNE   @RF00308                                            0308
         CLC   CSOALNM(2,@10),@CH00251                             0308
         BNE   @RF00308                                            0308
*     DO;                           /* MODE. GO TO STOP ANY ACTIVE MN
*                                      FUNCTIONS AND RETURN TO TMP   */
*       R6=ZEROS;                   /* SET RETURN CODE               */
         L     R6,ZEROS                                            0310
*       GO TO EXITA;                /* GO TO RETURN TO TMP           */
         B     EXITA                                               0311
*     END;                          /* END OF END CMD CHECK          */
*   IF CMDNAME(1:4)=HELPCMD(1:4)&CSOALNM=FOUR/* IF USER REQUESTED    */
*     THEN                          /* HELP INFO,                    */
@RF00308 L     @10,CSOAPTR                                         0313
         L     @09,CSOACNM(,@10)                                   0313
         CLC   CMDNAME(4,@09),HELPCMD                              0313
         BNE   @RF00313                                            0313
         CLC   CSOALNM(2,@10),@CH00049                             0313
         BE    @RT00313                                            0313
*     GO TO HELP;                   /* GO TO ATTACH HELP CP          */
*   IF CMDNAME(1)=HELPCMD(1)&CSOALNM=UNO/* CHECK FOR HELP            */
*     THEN                          /* ABBREVIATION,                 */
@RF00313 L     @10,CSOAPTR                                         0315
         L     @09,CSOACNM(,@10)                                   0315
         CLC   CMDNAME(1,@09),HELPCMD                              0315
         BNE   @RF00315                                            0315
         CLC   CSOALNM(2,@10),@CH00057                             0315
         BE    @RT00315                                            0315
*     GO TO HELP;                   /* GO TO ATTACH HELP CP          */
*   IF CMDNAME(1:8)=MONITOR×CMDNAME(1:3)=MN×/* MONITOR CMD?          */
*       CMDNAME(1:8)=DISPLAY×CMDNAME(1:2)=D×/* DISPLAY COMMAND?      */
*       CMDNAME(1:7)=STOPMN×CMDNAME(1:3)=PM×/* STOPMN COMMAND?       */
*       CMDNAME(1:5)=SEND×CMDNAME(1:3)=SE×/* SEND COMMAND?           */
*       CMDNAME(1:7)=CANCEL×CMDNAME(1:2)=C/* CANCEL COMMAND?         */
*     THEN                          /* ABOVE CMD FOUND-MUST HAVE   0317
*                                      VALID                         */
@RF00315 L     @10,CSOAPTR                                         0317
         L     @10,CSOACNM(,@10)                                   0317
         CLC   CMDNAME(8,@10),MONITOR                              0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(3,@10),MN                                   0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(8,@10),DISPLAY                              0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(2,@10),D                                    0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(7,@10),STOPMN                               0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(3,@10),PM                                   0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(5,@10),SEND                                 0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(3,@10),SE                                   0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(7,@10),CANCEL                               0317
         BE    @RT00317                                            0317
         CLC   CMDNAME(2,@10),C                                    0317
         BNE   @RF00317                                            0317
@RT00317 DS    0H                                                  0318
*     DO;                           /* CMD BEFORE CHECKING FOR     0318
*                                      OPERAND PRESENCE.             */
*       IF CSOAVNP='1'B THEN        /* THE ABOVE MUST HAVE OPERANDS  */
         L     @10,CSOAPTR                                         0319
         TM    CSOAVNP(@10),B'01000000'                            0319
         BO    @RT00319                                            0319
*         GO TO MSGRTN7;            /* NO OPERAND,ISSUE ERROR MSG    */
*     END;                          /* END OF OPERAND CHECK          */
*   ELSE                            /* THE COMMAND WAS INVALID SO    */
*     GO TO MSGRTN3;                /* ISSUE APPROPRIATE ERROR     0322
*                                      MESSAGE                       */
*   GEN(EJECT);                                                    0323
*                                                                  0323
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE CREATES A WTO MESSAGE THAT IS TO BE WRITTEN*/
*   /* TO THE MASTER CONSOLE OPERATOR WHENEVER A COMMAND IS GOTTEN AT*/
*   /* A TERMINAL. THE FORMAT OF THE MESSAGE IS MESSAGE ID TEXT      */
*   /* USERID IEF425I DISPLAY A SMITH IF THE TEXT IS LONGER THAT 56  */
*   /* (WTO MESSAGE IS RESTRICTED TO 72 CHARACTERS IN LENGTH)        */
*   /* ADDITIONAL LINES ARE WRITTEN OUT                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0324
*   WTOLNGTH=LNGBUFFR-FOUR;         /* CALCULATE LENGTH OF TEXT ONLY */
         L     @10,WORK7                                           0324
         LH    @10,LNGBUFFR(,@10)                                  0324
         SH    @10,@CH00049                                        0324
         ST    @10,WTOLNGTH                                        0324
*BLNKLOOP:                                                         0325
*                                                                  0325
*/*                                                                0325
*    STARTING SEARCH FROM END OF BUFFER, FIND LAST CHARACTER IN    0325
*    BUFFER, EXCLUDING TRAILING BLANKS                             0325
*                                                                    */
*                                                                  0325
*   IF CMDDATE(WTOLNGTH)=BLANK      /* IF TRAILING CHARACTER IS BLANK*/
*     THEN                          /* YES, IT IS BLANK              */
BLNKLOOP L     @10,WTOLNGTH                                        0325
         L     @09,WORK7                                           0325
         ALR   @09,@10                                             0325
         CLC   CMDDATE-1(1,@09),BLANK                              0325
         BNE   @RF00325                                            0325
*     DO;                           /* DO:                           */
*       WTOLNGTH=WTOLNGTH-UNO;      /* DECREMENT POINTER TO POINT TO
*                                      NEXT CHARACTER                */
         BCTR  @10,0                                               0327
         ST    @10,WTOLNGTH                                        0327
*       GO TO BLNKLOOP;             /* GO TO CHECK CHARACTER         */
         B     BLNKLOOP                                            0328
*     END;                          /* END BLANK CHARACTER PROCESSING*/
*   WTOLNGTH=WTOLNGTH+UNO;          /* LAST CHARACTER FOUND--ALLOW 0330
*                                      FOR ONE BLANK                 */
@RF00325 LA    @10,1                                               0330
         L     @09,WTOLNGTH                                        0330
         ALR   @09,@10                                             0330
         ST    @09,WTOLNGTH                                        0330
*   WTOPTR=UNO;                     /* INITIALIZE OFFSET INTO BUFFER */
         ST    @10,WTOPTR                                          0331
*REWTO:                                                            0332
*   CALL CLEAR;                     /* BLANK OUT BUFFER              */
REWTO    BAL   @14,CLEAR                                           0332
*   LNGOFF1=MCSFLG;                 /* INITIALIZE MCS FLAGS IN WTO 0333
*                                      EXPANSION TO MASTER CONSOLE,
*                                      INFORMATIONAL          YM08131*/
         MVC   LNGOFF1(2),MCSFLG                                   0333
*   OUTBUFF1(1:8)=CNSLID;           /* MOVE IN MESSAGE ID            */
         MVC   OUTBUFF1(8),CNSLID                                  0334
*/*                                                                0335
*    LENGTH OF INPUT COMMAND MUST BE CHECKED BECAUSE A MESSAGE TO  0335
*    CONSOLE SHOULD NOT BE GREATER THAN 72 CHARACTERS.  THEREFORE  0335
*    THE LIMIT TO THE LENGTH OF TEXT ON EACH LINE IS 56.  THE      0335
*    COMMAND MUST ALSO BE TRANSLATED TO UPPER CASE FOR THE WTO.    0335
*                                                                    */
*                                                                  0335
*   IF WTOLNGTH>FIVESEVN            /* IF THE LENGTH IS GREATER THAN */
*     THEN                          /* 57 ( INCLUDING BLANK SEPARATOR*/
         L     @10,WTOLNGTH                                        0335
         CH    @10,@CH00437                                        0335
         BNH   @RF00335                                            0335
*     DO;                           /* BETWEEN USERID AND TEXT) SO A
*                                      A MULTI-LINE WTO IS DONE      */
*       LNGBUF1=SEVENSIX;           /* TOTAL LENGTH OF BUFFER      0337
*                                      INCLUDING LENGTH, MCS FLAGS,
*                                      TEXT, MSG ID AND USERID       */
         MVC   LNGBUF1(2),@CH00439                                 0337
*       OUTBUFF1(9:64)=CMDDATE(WTOPTR:WTOPTR+SIXTHREE);/* MOVE TEXT
*                                      1NTO BUFFER                   */
         L     @10,WORK7                                           0338
         AL    @10,WTOPTR                                          0338
         MVC   OUTBUFF1+8(56),CMDDATE-1(@10)                       0338
*       OUTBUFF1(66:72)=PSCBUSER;   /* MOVE USERID                   */
         L     @10,SAVECPPL                                        0339
         L     @10,PSCBPTR(,@10)                                   0339
         MVC   OUTBUFF1+65(7),PSCBUSER(@10)                        0339
*       OUTBUFF1(73:76)=DESCODE;    /* ZERO OUT WORD FOLLOWING TEXT
*                                      FOR MCS ROUTING AND DESCRIPTOR
*                                      CODE                   YM08131*/
         MVC   OUTBUFF1+72(4),DESCODE                              0340
*       R6=FIVEFIVE;                /* SET LENGTH TO BE TRANSLATED   */
         LA    R6,55                                               0341
*       RESPECIFY                                                  0342
*        (R1) RSTD;                 /* RESTRICT REG FOR WTO          */
*       R1=ADDR(OUTBUFF1)+EIGHT;    /* GET ADDRESS OF COMMAND TEXT   */
         LA    R1,OUTBUFF1                                         0343
         AH    R1,@CH00035                                         0343
*       GEN(EX R6,EXTRNSLT);        /* TRANSLATE TO UPPER CASE       */
         EX R6,EXTRNSLT
*       R1=ADDR(BUFR1);             /* POINT TO WTO PARAMETER LIST   */
         LA    R1,BUFR1                                            0345
*       GEN(WTO MF=(E,(1)));        /* WRITE COMMAND TO CONSOLE      */
         WTO MF=(E,(1))
*       RESPECIFY                                                  0347
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*       WTOLNGTH=WTOLNGTH-FIVESIX;  /* DECREMENT TOTAL LENGTH OF TEXT
*                                      TO BE WRITTEN OUT             */
         LA    @10,56                                              0348
         L     @09,WTOLNGTH                                        0348
         SLR   @09,@10                                             0348
         ST    @09,WTOLNGTH                                        0348
*       WTOPTR=WTOPTR+FIVESIX;      /* INCREMENT OFFSET INTO TEXT    */
         AL    @10,WTOPTR                                          0349
         ST    @10,WTOPTR                                          0349
*       GO TO REWTO;                /* GO TO WRITE REMAINING TEXT    */
         B     REWTO                                               0350
*     END;                          /* END OF WTO-LENGTH >57         */
*   ELSE                            /* WTO WITH LENGTH <57           */
*     DO;                           /* WTO MESSAGE                   */
@RF00335 DS    0H                                                  0353
*       LNGBUF1=WTOLNGTH+NINETEEN;  /* INITIALIZE TOTAL LENGTH OF WTO
*                                      BUFFER TO SUM OF LENGTH OF  0353
*                                      TEXT EXCLUDING TRAILING     0353
*                                      BLANKS, LENGTH FIELD, MCS   0353
*                                      FLANGS, MSG ID, AND USERID    */
         L     @10,WTOLNGTH                                        0353
         LA    @09,19(,@10)                                        0353
         STH   @09,LNGBUF1                                         0353
*       OUTBUFF1(9:WTOLNGTH+EIGHT)=CMDDATE(WTOPTR:WTOPTR+WTOLNGTH-UNO);
         LR    @09,@10                                             0354
         BCTR  @09,0                                               0354
         L     @07,WORK7                                           0354
         AL    @07,WTOPTR                                          0354
         EX    @09,@SM01349                                        0354
*                                   /* MOVE TEXT INTO BUFFER         */
*       OUTBUFF1(WTOLNGTH+NINE:WTOLNGTH+FIFTEEN)=PSCBUSER;/* MOVE IN
*                                      USERID                        */
         LA    @07,OUTBUFF1+8(@10)                                 0355
         L     @01,SAVECPPL                                        0355
         L     @01,PSCBPTR(,@01)                                   0355
         MVC   0(7,@07),PSCBUSER(@01)                              0355
*       OUTBUFF1(WTOLNGTH+SIXTEEN:WTOLNGTH+NINETEEN)=DESCODE;/* MOVE
*                                      IN FLAGS--ROUTING AND       0356
*                                      DESCRIPTOR CODES       YM08131*/
         L     @07,DESCODE                                         0356
         ST    @07,@TF00001                                        0356
         LA    @01,OUTBUFF1+15(@10)                                0356
         MVC   0(4,@01),@TF00001                                   0356
*       R6=WTOLNGTH-UNO;            /* SET LENGTH TO BE TRANSLATED   */
         LR    R6,@09                                              0357
*       RESPECIFY                                                  0358
*        (R1) RSTD;                 /* RESTRICT REG FOR WTO          */
*       R1=ADDR(OUTBUFF1)+EIGHT;    /* GET ADDRESS OF COMMAND TEXT   */
         LA    R1,OUTBUFF1                                         0359
         AH    R1,@CH00035                                         0359
*       GEN(EX R6,EXTRNSLT);        /* TRANSLATE TO UPPER CASE       */
         EX R6,EXTRNSLT
*       R1=ADDR(BUFR1);             /* POINT TO WTO PARAMETER LIST   */
         LA    R1,BUFR1                                            0361
*       GEN(WTO MF=(E,(1)));                                       0362
         WTO MF=(E,(1))
*       RESPECIFY                                                  0363
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*     END;                                                         0364
*   GEN(EJECT);                                                    0365
*                                                                  0365
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* .PREPARE PARAMETER LIST TO ISSUE SVC 100 TO VALIDITY CHECK    */
*   /* OPERATOR COMMANDS .BEFORE PROCESSING CURRENT COMMAND CHECK CP */
*   /* ECB TO DETERMINE IF ATTENTION EXIT WAS TAKEN AND A NEW COMMAND*/
*   /* WAS ENTERED                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*INIT100:                                                          0366
*   RFY                                                            0366
*    (R4,                                                          0366
*     R5) RSTD;                     /* RESTRICT BEFORE BRANCHING     */
INIT100  DS    0H                                                  0367
*   ABUFFER=ADDR(CMDBUFFR);         /* GET ADDR OF COMMAND BUFFER    */
         L     @10,WORK7                                           0367
         ST    @10,ABUFFER                                         0367
*   R5=ADDR(CMDBUFFR)+BFOFFSET+FOUR;/* CALCULATE ADDR OF OPERAND IN
*                                      COMMAND BUFFER                */
         LH    R5,BFOFFSET(,@10)                                   0368
         ALR   R5,@10                                              0368
         AH    R5,@CH00049                                         0368
*   ACMDNAME=CSOACNM;               /* POINT TO COMMAND IN BUFFER    */
         L     @09,CSOAPTR                                         0369
         L     @09,CSOACNM(,@09)                                   0369
         ST    @09,ACMDNAME                                        0369
*   R4=ADDR(CMDBUFFR)+LNGBUFFR;     /* PTR TO END OF BUFFER          */
         LH    R4,LNGBUFFR(,@10)                                   0370
         ALR   R4,@10                                              0370
*   AOPRND=R5;                      /* PTR TO OPERAND                */
         ST    R5,AOPRND                                           0371
*   R6=ZEROS;                       /* INITIALIZE COUNTER TO LENGTH
*                                      OF OPERAND                    */
         L     R6,ZEROS                                            0372
*   IF CMDNAME(1:5)^=SEND&CMDNAME(1:3)^=SE/* SEND COMMAND?           */
*     THEN                          /* THE COMMAND IS MN,PM,C, OR D  */
         CLC   CMDNAME(5,@09),SEND                                 0373
         BE    @RF00373                                            0373
         CLC   CMDNAME(3,@09),SE                                   0373
         BE    @RF00373                                            0373
*     CALL CLNGOP;                  /* THEN GO TRANSLATE THE OPERAND */
         BAL   @14,CLNGOP                                          0374
*   IF ECBBIT1='1'B                 /* WHEN ECB IS POSTED            */
*     THEN                          /* THEN GO                       */
@RF00373 TM    ECBBIT1,B'01000000'                                 0375
         BO    @RT00375                                            0375
*     GO TO ATTN;                   /* PROCESS NEW COMMAND           */
*   AUTHCHK='0'B;                   /* SET FLAGS TO VALIDITY CHECK   */
*   CMDCHK='1'B;                    /* COMMAND ENTERED               */
         OI    CMDCHK,B'01000000'                                  0378
         NI    AUTHCHK,B'01111111'                                 0378
*   RESPECIFY                                                      0379
*    (R1,                                                          0379
*     R15) RSTD;                    /* RESTRICT REGS ACROSS SVC      */
*   R1=ADDR(FIBMAINP);              /* POINT TO PARAMETER LIST       */
         LA    R1,FIBMAINP                                         0380
*   SVC(100);                       /* SVC FOR FIB, PROF AND OPER TSO
*                                      COMMANDS....IKJEFFS0 PL/S   0381
*                                      MACRO                         */
         SVC   100                                                 0381
*   R6=R15;                         /* SAVE RETURN CODE FOR TESTING  */
         LR    R6,R15                                              0382
*   RESPECIFY                                                      0383
*    (R1,                                                          0383
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   RFY                                                            0384
*    (R4,                                                          0384
*     R5) UNRSTD;                   /* FREE FOR THE COMPILER         */
*   IF R6=FIBOKRC                   /* INDICATES SVC IS SUCCESSFUL   */
*     THEN                          /* VALID COMMAND PROCESSED, GO   */
         LTR   R6,R6                                               0385
         BZ    @RT00385                                            0385
*     GO TO OPERABIL;               /* TO GET ANOTHER COMMAND        */
*   IF R6=FIBOPCMD                  /* INDICATES INVALID SUBCOMMAND  */
*     THEN                          /* GO TO ISSUE ERROR MSG AND GET */
         CH    R6,@CH00049                                         0387
         BE    @RT00387                                            0387
*     GO TO MSGRTN3;                /* ANOTHER COMMAND               */
*   IF R6=FIBOPOPD                  /* INDICATES INVALID OPERAND     */
*     THEN                          /* GO TO ISSUE ERROR MSG AND GET */
         CH    R6,@CH00035                                         0389
         BE    @RT00389                                            0389
*     GO TO MSGRTN5;                /* LINE OF INPUT                 */
*   ELSE                            /* FAILED WITH UNUSUAL RETURN  0391
*                                      CODE                          */
*     DO;                           /* PUT OUT GENERALIZED MESSAGE   */
*       MSGSEG2B=ADDR(SVC100SG);    /* INDICATE AN SVC ERROR IN MSG  */
         LA    @10,SVC100SG                                        0392
         ST    @10,MSGSEG2B                                        0392
*       GO TO MSGRTN4;              /* GO PUT OUT THE MESSAGE        */
         B     MSGRTN4                                             0393
*     END;                          /* END GENERALIZED MSG PROCESSING*/
*   GEN(EJECT);                                                    0395
*                                                                  0395
         EJECT
*/********************************************************************/
*/*      MESSAGE FORMATTING ROUTINES--                               */
*/*      . MOVES THE MESSAGES INTO THE BUFFERS                       */
*/*      . CALLS PUTLRTN TO ISSUE THE MESSAGE                        */
*/*      . BRANCHES TO APPROPRIATE SPOT TO CONTINUE OR TERMINATE     */
*/********************************************************************/
*/*                                                                0396
*    ROUTINE 1 INITIALIZES THE WARNING MESSAGE WHEN DATA HAS BEEN  0396
*    ENTERED ON THE OPERATOR COMMAND                               0396
*      IKJ550001I DATA IGNORED IN THE OPERAND FIELD                0396
*                                                                    */
*                                                                  0396
*MSGRTN1:                                                          0396
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */
MSGRTN1  BAL   @14,CLEAR                                           0396
*   LNGBUF1=LNGMSG1A;               /* INITIALIZE LNG OF 1ST M2051   */
         MVC   LNGBUF1(2),LNGMSG1A                                 0397
*   LNGBUF2=LNGMSG1B;               /* AND 2ND LVL MESSAGES          */
         MVC   LNGBUF2(2),LNGMSG1B                                 0398
*   RESPECIFY                                                      0399
*    (R7,                                                          0399
*     R9) UNRESTRICTED;             /* ALLOW CMPLR USE OF REGS 7,9   */
*   OUTBUFF1(1:44)=MSG0011;         /* INITIALIZE 1ST LVL MSG TEXT   */
         MVC   OUTBUFF1(44),MSG0011                                0400
*   OUTBUFF2(1:50)=MSG0012;         /* INITIALIZE 2ND LEVEL MSG TEXT */
         MVC   OUTBUFF2(50),MSG0012                                0401
*   ECTNOPD='0'B;                   /* TURN OFF ECT BIT SPECIFYING 0402
*                                      OPERANDS ON CMD - FOR CASE OF
*                                      RETRY ON ABEND CONDITION TO 0402
*                                      AVOID PUTTING MESSAGE OUT     */
         L     @10,SAVECPPL                                        0402
         L     @10,ECTPTR(,@10)                                    0402
         NI    ECTNOPD(@10),B'01111111'                            0402
*   CALL PUTLRTN;                   /* GO TO PUTLINE RTN             */
         BAL   @14,PUTLRTN                                         0403
*   GO TO TESTABIL;                 /* GO TO TEST FOR OPERATOR     0404
*                                      ABILITY                       */
         B     TESTABIL                                            0404
*   GEN(EJECT);                                                    0405
*                                                                  0405
         EJECT
*/*                                                                0406
*    TERMINAL USER IS NOT ELIGIBLE TO ISSUE OPERATOR COMMAND,      0406
*    ISSUE ERROR MESSAGE TO TERMINAL AND RETURN TO TMP             0406
*      IKJ55000I OPERATOR COMMAND NOT AUTHORIZED FOR               0406
*                                                                    */
*                                                                  0406
*MSGRTN2:                                                          0406
*   LNGBUF1=LNGMSG0A;               /* INITIALIZE LENGTH OF 1ST      */
MSGRTN2  MVC   LNGBUF1(2),LNGMSG0A                                 0406
*   LNGBUF2=LNGMSG0B;               /* AND 2ND LEVEL MESSAGES        */
         MVC   LNGBUF2(2),LNGMSG0B                                 0407
*   OUTBUFF1(1:54)=MSG0001;         /* MOVE 1ST LVL MSG TO BUFR      */
         MVC   OUTBUFF1(54),MSG0001                                0408
*   OUTBUFF1(47:50)=PSCBUSER(1:4);  /* MOVE USER ID INTO             */
         L     @10,SAVECPPL                                        0409
         L     @10,PSCBPTR(,@10)                                   0409
         MVC   OUTBUFF1+46(4),PSCBUSER(@10)                        0409
*   OUTBUFF1(51:53)=PSCBUSER(5:7);  /* MSG TEXT                      */
         MVC   OUTBUFF1+50(3),PSCBUSER+4(@10)                      0410
*   OUTBUFF2(1:66)=MSG0002;         /* MOVE 2ND LVL MSG TO BUFR      */
         MVC   OUTBUFF2(66),MSG0002                                0411
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */
         BAL   @14,PUTLRTN                                         0412
*   R6=ZEROS;                       /* SET RETURN CODE               */
         L     R6,ZEROS                                            0413
*   GO TO EXITA;                    /* RETURN TO THE TMP             */
         B     EXITA                                               0414
*   GEN(EJECT);                                                    0415
*                                                                  0415
         EJECT
*/*                                                                0416
*    ROUTINE 3 INITIALIZES THE ERROR MESSAGE FOR INVALID COMMANDS  0416
*      IKJ550003I INVALID SUBCOMMAND                               0416
*                                                                    */
*                                                                  0416
*MSGRTN3:                                                          0416
*   CALL CLEAR;                     /* BLANK OUT BUFFER              */
MSGRTN3  BAL   @14,CLEAR                                           0416
*   IF CSOALNM>MSGLEN-LNGMSG3A      /* IF LENGTH OF 1ST LEVEL MSG IS */
*     THEN                          /* GREATER THAN LENGTH OF BUFFER */
         L     @10,CSOAPTR                                         0417
         LA    @09,136                                             0417
         SH    @09,LNGMSG3A                                        0417
         CH    @09,CSOALNM(,@10)                                   0417
         BNL   @RF00417                                            0417
*     DO;                           /* SUBCOMMAND WILL BE TRUNCATED  */
*       RESPECIFY                                                  0419
*        (R4) RSTD;                 /* RESTRICT REGISTER USAGE       */
*       R4=BUFLEN;                  /* SET END OF BUFFER LIMIT       */
         LA    R4,132                                              0420
*       CSOALNM=MSGLEN-LNGMSG3A;    /* INITIALIZE MAXIMUM LENGTH     */
         STH   @09,CSOALNM(,@10)                                   0421
*     END;                          /* SUBCOMMAND TO BE WRITTEN OUT  */
*   ELSE                            /* CALCULATE END OF SUBCMD NAME
*                                      IN                            */
*     R4=CSOALNM+THIRTY;            /* OUTPUT BUFFER                 */
         B     @RC00417                                            0423
@RF00417 LA    R4,30                                               0423
         L     @10,CSOAPTR                                         0423
         AH    R4,CSOALNM(,@10)                                    0423
*   OUTBUFF1(1:28)=MSG0031;         /* MOVE MSG IKJ55003I TO BUFFER  */
@RC00417 MVC   OUTBUFF1(28),MSG0031                                0424
*   OUTBUFF1(30:R4)=CMDNAME;        /* MOVE SUBCOMMAND NAME TO MSG   */
         LR    @10,R4                                              0425
         SH    @10,@CH00424                                        0425
         L     @09,CSOAPTR                                         0425
         L     @07,CSOACNM(,@09)                                   0425
         EX    @10,@SM01352                                        0425
*   LNGBUF1=LNGMSG3A+CSOALNM;       /* INITIALIZE LNG OF 1ST LEVEL 0426
*                                      MSG                           */
         LH    @10,LNGMSG3A                                        0426
         AH    @10,CSOALNM(,@09)                                   0426
         STH   @10,LNGBUF1                                         0426
*   LNGBUF2=LNGMSG3B;               /* INITIALIZE LNG OF 2ND LEVEL 0427
*                                      MSG                           */
         MVC   LNGBUF2(2),LNGMSG3B                                 0427
*   OUTBUFF1(R4)=PLUSSIGN;          /* PUT PLUS SIGN AT END OF MSG TO
*                                      INDICATE 2ND LEVEL MSG EXISTS */
         LA    @10,OUTBUFF1-1(R4)                                  0428
         MVC   0(1,@10),PLUSSIGN                                   0428
*   RESPECIFY                                                      0429
*    (R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*   OUTBUFF2(1:90)=MSG0032;         /* INITIALIZE 2ND LEVEL MSG TEXT */
         MVI   OUTBUFF2+78,C' '                                    0430
         MVC   OUTBUFF2+79(11),OUTBUFF2+78                         0430
         MVC   OUTBUFF2(78),MSG0032                                0430
*   CALL PUTLRTN;                   /* GO TO PUTLINE ROUTINE         */
         BAL   @14,PUTLRTN                                         0431
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0432
*                                      INPUT                         */
         B     OPERABIL                                            0432
*   GEN(EJECT);                                                    0433
*                                                                  0433
         EJECT
*/*                                                                0434
*    THE FOLLOWING ROUTINE IS ENTERED WHEN OPERATOR COMMAND        0434
*    PROCESSOR DETERMINED AN INVALID CONDITION IN PROCESSING AND   0434
*    WOULD NOT CONTINUE. OPERATOR CP ISSUES AN ERROR MESSAGE TO    0434
*    THE TERMINAL, RESETS THE INPUT SOURCE STACK TO THE TERMINAL,  0434
*    CLEARS THE INPUT QUEUE OF ANY TYPED AHEAD COMMANDS AND        0434
*    RETURNS TO THE TMP WITH AN ERROR RETURN CODE IN REGISTER 15.  0434
*      IKJ55004I COMMAND SYSTEM ERROR+                             0434
*      IKJ55004I 'SERVICE RTN' ERROR RETURN CODE IS XXX            0434
*                                                                    */
*                                                                  0434
*MSGRTN4:                                                          0434
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */
MSGRTN4  BAL   @14,CLEAR                                           0434
*   OUTBUFF1(1:31)=MSG0041;         /* MOVE MSG TEXT TO BUFR MOVE  0435
*                                      SUBCMD NAME TO MSG            */
         MVC   OUTBUFF1(31),MSG0041                                0435
*   LNGBUF1=LNGMSG4A;               /* INITIALIZE 1ST LVL MSGLN M2051*/
         MVC   LNGBUF1(2),LNGMSG4A                                 0436
*   NOMSGSG2=FOUR;                  /* INITIALIZE PTPB FOR 4 SEGMENTS
*                                      ON SECOND LVL MESSAGE         */
         MVC   NOMSGSG2(4),@CF00049                                0437
*   MSGSEG2=ADDR(MSGIDHDR);         /* INITIALIZE POINTERS TO SEGMENT*/
         LA    @10,MSGIDHDR                                        0438
         ST    @10,MSGSEG2                                         0438
*   MSGSEG2C=ADDR(MSG0042);         /* BLOCKS--THE MESSAGE ID, THE   */
         LA    @10,MSG0042                                         0439
         ST    @10,MSGSEG2C                                        0439
*   MSGSEG2D=ADDR(RTCDESEG);        /* TEXT, AND THE RETURN CODE     */
         LA    @10,RTCDESEG                                        0440
         ST    @10,MSGSEG2D                                        0440
*   RESPECIFY                                                      0441
*    (R1,                                                          0441
*     R4) RSTD;                     /* RESTRICT REGS FOR CONVERT     */
*   R4=ADDR(TEXT);                  /* INITIALIZE REGISTER FOR       */
         LA    R4,TEXT                                             0442
*   R1=ADDR(BUFR2)+EIGHT;           /* CONVERTING RETURN CODE        */
         LA    R1,BUFR2                                            0443
         AH    R1,@CH00035                                         0443
*   GEN;                                                           0444
     XC 0(H16,R1),0(R1)              CLEAR AREA
     CVD   R6,0(R1)                  CONVERT ERROR RETURN CODE TO
*                                    PACKED DECIMAL FORMAT
     UNPK  0(H5,R1),H6(H3,R1)        UNPACK RETURN CODE
     MVC   0(H3,R4),0(R1)            MOVE TO MESSAGE SEGMENT
H16 EQU  16                          LENGTH OF TWENTY
H5  EQU  5                           LENGTH OF FIVE
H6  EQU  6                           DISPLACEMENT OF 6
H3  EQU  3                           LENGTH OF THREE
*   RESPECIFY                                                      0445
*    (R1,                                                          0445
*     R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*   HEADER=RTCDE;                   /* MOVE SEGMENT HEADER FOR RETURN
*                                      CODE SEGMENT TO AREA          */
         MVC   HEADER(4),RTCDE                                     0446
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */
         BAL   @14,PUTLRTN                                         0447
*   IOPLIOPB=ADDR(STPB);            /* ADDRESS OF STACK PARAMETER BLK*/
         LA    @10,SRPARM                                          0448
         LA    @09,IOBLOCK                                         0448
         ST    @09,IOPLIOPB(,@10)                                  0448
*   STPB=STKL;                      /* MOVE STACK PARAMETERS         */
         MVC   STPB(20,@09),STKL                                   0449
*   RESPECIFY                                                      0450
*    (R1,                                                          0450
*     R15) RSTD;                    /* RESTRICT REGS ACROSS STACK    */
*   R1=ADDR(IOPL);                  /* ADDRESS IO SERVICE ROUTINES 0451
*                                      PARAMETER LIST                */
         LR    R1,@10                                              0451
*   R15=PTRSTACK;                   /* ENTRY POINT OF STACK          */
         L     R15,PTRSTACK                                        0452
*   GEN(STACK ENTRY=(15),MF=(E,(1)));/* RESET INPUT SOURCE TO THE  0453
*                                      TERMINAL                      */
         STACK ENTRY=(15),MF=(E,(1))
*   RESPECIFY                                                      0454
*    (R1,                                                          0454
*     R15) UNRSTD;                  /* FREE REGS FOR COMPILER        */
*   GEN(TCLEARQ INPUT);             /* CLEAR OUT ANY TYPED AHEAD   0455
*                                      INPUT FROM THE TERMINAL       */
         TCLEARQ INPUT
*   R6=TWELVE;                      /* ERROR RETURN CODE PASSED TO 0456
*                                      TMP INDICATING ERROR IN     0456
*                                      OPERATOR PROCESSING           */
         LA    R6,12                                               0456
*   GO TO EXITA;                    /* GO TO RETURN TO TMP           */
         B     EXITA                                               0457
*   GEN(EJECT);                                                    0458
*                                                                  0458
         EJECT
*/*                                                                0459
*    ROUTINE 5 INITIALIZES THE ERROR MESSAGE FOR INVALID OPERANDS  0459
*    ON STOPMN, MONITOR, CANCEL, OR DISPLAY COMMANDS               0459
*      IKJ55005I INVALID OPERAND                                   0459
*                                                                    */
*                                                                  0459
*MSGRTN5:                                                          0459
*   CALL CLEAR;                     /* CLEAR OUTPUT BUFFERS          */
MSGRTN5  BAL   @14,CLEAR                                           0459
*   RESPECIFY                                                      0460
*    (R5) RSTD;                     /* RESTRICT REGISTER USAGE       */
*   R5=AOPRND;                      /* POINT TO OPERAND IN BUFFER    */
         L     R5,AOPRND                                           0461
*   OUTBUFF1(1:25)=MSG0051;         /* INITIALIZE BUFFER WITH 1ST  0462
*                                      LEVEL MESSAGE TEXT            */
         MVC   OUTBUFF1(25),MSG0051                                0462
*   R6=LNGOPRND;                    /* CALCULATE LENGTH OF OPERAND   */
         L     R6,LNGOPRND                                         0463
*   IF R6>BUFLEN-LNGMSG5A           /* IF LENGTH OF 1ST LEVEL MESSAGE
*                                      > ONE LINE (LENGTH OF BUFFER) */
*     THEN                          /* INITIALIZE REGISTERS SUCH THAT*/
         LA    @10,132                                             0464
         LH    @09,LNGMSG5A                                        0464
         LR    @07,@10                                             0464
         SLR   @07,@09                                             0464
         CR    R6,@07                                              0464
         BNH   @RF00464                                            0464
*     DO;                           /* ONLY 132 CHAR WILL BE MOVED 0465
*                                      INTO THE BUFFER               */
*       RESPECIFY                                                  0466
*        (R4) RSTD;                 /* RESTRICT REGISTER USAGE       */
*       R4=BUFLEN;                  /* TRUNCATE MESSAGE ATE LENGTH OF
*                                      BUFFER                        */
         LR    R4,@10                                              0467
*       R6=MSGLEN-LNGMSG5A;         /* FOR INITIALIZATION OF LENGTH
*                                      OF                            */
         LCR   @09,@09                                             0468
         AH    @09,@CH00426                                        0468
         LR    R6,@09                                              0468
*     END;                          /* BUFFER                        */
*   ELSE                            /* CALCULATE OFFSET IN BUFFER FOR*/
*     R4=R6+TWOSEVEN;               /* END OF OPERAND                */
         B     @RC00464                                            0470
@RF00464 LA    R4,27                                               0470
         ALR   R4,R6                                               0470
*   OUTBUFF1(27:R4)=OPERAND(1:R6);  /* MOVE OPERAND INTO MSG TEXT    */
@RC00464 LR    @10,R4                                              0471
         SH    @10,@CH00429                                        0471
         EX    @10,@SM01354                                        0471
*   OUTBUFF1(R4)=PLUSSIGN;          /* PUT PLUS SIGN AT END OF MSG TO
*                                      INDICATE 2ND LEVEL MSG EXISTS */
         LA    @10,OUTBUFF1-1(R4)                                  0472
         MVC   0(1,@10),PLUSSIGN                                   0472
*   RESPECIFY                                                      0473
*    (R4,                                                          0473
*     R5) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*   LNGBUF1=LNGMSG5A+R6;            /* INITIALIZE 1ST AND 2ND        */
         LR    @10,R6                                              0474
         AH    @10,LNGMSG5A                                        0474
         STH   @10,LNGBUF1                                         0474
*   LNGBUF2=LNGMSG5B;               /* LEVEL MESSAGE LENGTH          */
         MVC   LNGBUF2(2),LNGMSG5B                                 0475
*   OUTBUFF2(1:84)=MSG0052;         /* MOVE 2ND LVL MSG TEXT TO    0476
*                                      BUFFER                        */
         MVC   OUTBUFF2(84),MSG0052                                0476
*   CALL PUTLRTN;                   /* GO TO PUTLINE SUBROUTINE      */
         BAL   @14,PUTLRTN                                         0477
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0478
*                                      INPUT                         */
         B     OPERABIL                                            0478
*   GEN(EJECT);                                                    0479
*                                                                  0479
         EJECT
*/*                                                                0480
*    MESSAGES ISSUED WHEN OPERATOR SUBCOMMAND HAS NO OPERAND       0480
*      IKJ5006I MISSING OPERAND+                                   0480
*                                                                    */
*                                                                  0480
*MSGRTN7:                                                          0480
*   CALL CLEAR;                     /* BLANK OUT MESSAGE BUFFERS     */
MSGRTN7  BAL   @14,CLEAR                                           0480
*   OUTBUFF1(1:26)=MSG0061;         /* FIRST LEVEL MESSAGE           */
         MVC   OUTBUFF1(26),MSG0061                                0481
*   OUTBUFF2(1:49)=MSG0062;         /* SECOND LEVEL MESSAGE          */
         MVC   OUTBUFF2(49),MSG0062                                0482
*   LNGBUF1=LNGMSG6A;               /* INDICATE LENGTH OF MSG        */
         MVC   LNGBUF1(2),LNGMSG6A                                 0483
*   LNGBUF2=LNGMSG6B;               /* INDICATE LENGTH OF MSG        */
         MVC   LNGBUF2(2),LNGMSG6B                                 0484
*   CALL PUTLRTN;                   /* USE PUTLINE TO ISSUE MSG TO 0485
*                                      THE TERMINAL                  */
         BAL   @14,PUTLRTN                                         0485
*   GO TO OPERABIL;                 /* GO GET ANOTHER COMMAND        */
         B     OPERABIL                                            0486
*   GEN(EJECT);                                                    0487
*                                                                  0487
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE IS ENTERED WHEN A HELP COMMAND WAS      */
*   /* ISSUED, REQUESTING ADDITIONAL INFORMATION. THE HELP CP IS     */
*   /* ATTACHED                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*HELP:                                                             0488
*   RESPECIFY                                                      0488
*    (R4) RSTD;                     /* RESTRICT REG FOR ATTACH       */
HELP     DS    0H                                                  0489
*   R4=ADDR(ATCHECB);               /* GET ADDR OF ATTACH ECB        */
         LA    R4,ATCHECB                                          0489
*   ATTCHPRM=ATTCHPRM&&ATTCHPRM;    /* CLEAR ATTACH PARMLIST WO WA   */
         XC    ATTCHPRM(60),ATTCHPRM                               0490
*   CPPLCBUF=ADDR(CMDBUFFR);        /* INITIALIZE CPPL WITH PTR TO 0491
*                                      OPERATOR'S COMMAND BUFFER     */
         L     @10,SAVECPPL                                        0491
         MVC   CPPLCBUF(4,@10),WORK7                               0491
*   ATCHECB=ZEROS;                  /* CLEAR ATTACH ECB              */
         MVC   ATCHECB(4),ZEROS                                    0492
*   RESPECIFY                                                      0493
*    (R5,                                                          0493
*     R1,                                                          0493
*     R15) RSTD;                    /* RESTRICT REGS FOR ATTACH      */
*   R5=ADDR(EXITPARM);              /* POINT TO EXIT PARM LIST       */
         LA    R5,EXITPARM                                         0494
*   R6=ADDR(IKJEE1A2);              /* ADDRESS OF THE STAE ROUTINE   */
         L     R6,@CV00382                                         0495
*   R1=SAVECPPL;                    /* POINT TO CPPL                 */
         LR    R1,@10                                              0496
*   R15=ADDR(ATTCHPRM);             /* POINT TO ATTACH PARMLIST      */
         LA    R15,ATTCHPRM                                        0497
*   GEN;                                                           0498
     ATTACH EP=HELP,ECB=(4),STAI=((R6),(5)),SHSPV=78,SF=(E,(15))
*   R6=R15;                         /* SAVE THE RETURN CODE          */
         LR    R6,R15                                              0499
*   WORK3=R1;                       /* SAVE ATTACH TCB PTR           */
         ST    R1,WORK3                                            0500
*   RESPECIFY                                                      0501
*    (R1,                                                          0501
*     R15) UNRSTD;                  /* FREE FOR THE COMPILER         */
*   IF R6^=ZEROS                    /* INVALID RETURN CODE?          */
*     THEN                          /* YES,                          */
         C     R6,ZEROS                                            0502
         BE    @RF00502                                            0502
*     DO;                           /* PUT OUT GENERALIZED ERROR MSG */
*       MSGSEG2B=ADDR(STAISEG);     /* INDICATE TYPE FOR 2ND LEVEL   */
         LA    @10,STAISEG                                         0504
         ST    @10,MSGSEG2B                                        0504
*       GO TO MSGRTN4;              /* PUT OUT ERROR MESSAGE         */
         B     MSGRTN4                                             0505
*     END;                          /* END MSG PROCESSING            */
*   GEN(WAIT ECB=(4));              /* WAIT FOR HELP CP TO COMPLETE  */
@RF00502 DS    0H                                                  0507
         WAIT ECB=(4)
*   RESPECIFY                                                      0508
*    (R4) UNRSTD;                   /* FREE FOR COMPILER USAGE       */
*   IF ECBCC=ZEROS                  /* SUBTASK WAS SUCCESSFUL?       */
*     THEN                          /* YES,                          */
         L     @10,ECBCC-1                                         0509
         LA    @10,0(,@10)                                         0509
         C     @10,ZEROS                                           0509
         BNE   @RF00509                                            0509
*     DO;                           /* DETACH IT                     */
*       RESPECIFY                                                  0511
*        (R1) RSTD;                 /* RESTRICT REG FOR DETACH       */
*       R1=ADDR(WORK3);             /* GET HELP TCB ADDR             */
         LA    R1,WORK3                                            0512
*       GEN(DETACH (1));            /* DETACH THE HELP TCB           */
         DETACH (1)
*       RESPECIFY                                                  0514
*        (R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*     END;                          /* END DETACH PROCESSING         */
*/*                                                                0516
*    INVOKE THE DAIR SERVICE ROUTINE TO MARK ANY DATA SETS         0516
*    ALLOCATED BY HELP AS ALLOCATABLE BEFORE DETACHING IT.         0516
*                                                                    */
*                                                                  0516
*   DAPLPSCB=CPPLPSCB;              /* PUT PSCB ADDR IN PARMLIST     */
@RF00509 LA    @10,SRPARM                                          0516
         L     @09,SAVECPPL                                        0516
         MVC   DAPLPSCB(4,@10),CPPLPSCB(@09)                       0516
*   DAPLDAPB=ADDR(DAIRPARM);        /* LINK 2C BLOCK TO DAIR PARM  0517
*                                      LIST                          */
         LA    @09,DAIRPARM                                        0517
         ST    @09,DAPLDAPB(,@10)                                  0517
*   DA2CFLG='0000'X;                /* SET FLAG FIELD TO ZERO        */
         SLR   @07,@07                                             0518
         STH   @07,DA2CFLG(,@09)                                   0518
*   DA2CCD='002C'X;                 /* INDICATE CODE 2C              */
         MVC   DA2CCD(2,@09),@CB01310                              0519
*   DA2CTCB=WORK3;                  /* GET HELP TCB ADDR             */
         MVC   DA2CTCB(4,@09),WORK3                                0520
*   RESPECIFY                                                      0521
*    (R1,                                                          0521
*     R15) RSTD;                    /* RESTRICT REGS ACROSS DAIR     */
*   R1=ADDR(SRPARM);                /* OBTAIN DAIR'S PARAMETER LIST  */
         LR    R1,@10                                              0522
*   GEN(LINK EP=IKJEFD00);          /* LINK TO DAIR                  */
         LINK EP=IKJEFD00
*   R6=R15;                         /* SAVE THE DAIR RETURN CODE     */
         LR    R6,R15                                              0524
*   RESPECIFY                                                      0525
*    (R1,                                                          0525
*     R15) UNRSTD;                  /* FREE FOR COMPILER             */
*   IF R6^=ZEROS                    /* CHECK RETURN CODE FOR       0526
*                                      SUCCESSFUL COMPLETION         */
*     THEN                          /* NON SUCCESSFUL DAIR RETURN  0526
*                                      CODE                          */
         C     R6,ZEROS                                            0526
         BE    @RF00526                                            0526
*     DO;                           /* PUT OUT GENERALIZED MESSAGE   */
*       MSGSEG2B=ADDR(DAIRSEG);     /* INITIALIZE POINTER TO DAIR  0528
*                                      MESSAGE SEGMENT FOR ERROR MSG */
         LA    @10,DAIRSEG                                         0528
         ST    @10,MSGSEG2B                                        0528
*       GO TO MSGRTN4;              /* GO TO ERROR MSG RTN           */
         B     MSGRTN4                                             0529
*     END;                          /* END OF DAIR FAILING PROCESSING*/
*   IF ECBBIT1='1'B                 /* CHECK IF ATTN OCCURED         */
*     THEN                          /* YES,                          */
@RF00526 TM    ECBBIT1,B'01000000'                                 0531
         BO    @RT00531                                            0531
*     GO TO ATTN;                   /* GO TO PROCESS NEW COMMAND     */
*   GO TO OPERABIL;                 /* GO TO GET ANOTHER LINE OF   0533
*                                      INPUT                         */
         B     OPERABIL                                            0533
*   GEN(EJECT);                                                    0534
*                                                                  0534
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* LEAVING OPERATOR MODE - CLEAN-UP TIME . TURN OFF ALL MONITOR  */
*   /* BITS BY CALLING ENDRTN . FREE ANY GETMAIND BUFFER BY CALLING  */
*   /* ENDRTN . TURN OFF THE EXTRA BUFFER BIT IN THE TSB . DELETE ANY*/
*   /* LOADED SERVICE ROUTINES . RETURN TO THE TMP WITH RETURN CODE  */
*   /* IN REGISTER 15                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0535
*EXITA:                                                            0535
*   IF EXITERR='0'B THEN            /* HAS USER BEEN THROUGH ENDRTN? */
EXITA    TM    EXITERR,B'00100000'                                 0535
         BNZ   @RF00535                                            0535
*     CALL ENDRTN;                  /* GENERALIZED END PROCESSING    */
         BAL   @14,ENDRTN                                          0536
*   GEN;                                                           0537
@RF00535 DS    0H                                                  0537
*                                  /* DELETE THE I/O SERVICE ROUTINES*/
     DELETE EP=IKJPUTL
     DELETE EP=IKJPTGT
     DELETE EP=IKJSTCK
     DELETE EP=IKJGETL
     STAE  0                                               @ZA08125
*   RETURN CODE(R6);                /* RETURN TO TMP         @ZA08115*/
         L     @13,4(,@13)                                         0538
         L     @00,@SIZDATD                                        0538
         LR    @01,@12                                             0538
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@06                                             0538
         L     @14,12(,@13)                                        0538
         LM    @00,@12,20(@13)                                     0538
         BR    @14                                                 0538
*   GEN(EJECT);                                                    0539
*                                                                  0539
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* ROUTINE USED TO CALL ENDRTN FROM OPERATOR STAE ROUTINE        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0540
*ENDRN:                             /* ROUTINE TO CALL ENDRTN        */
*   RESPECIFY                                                      0540
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */
ENDRN    DS    0H                                                  0541
*   SVER14=R14;                     /* RETURN ADDRESS TO THE CALLER  */
         ST    R14,SVER14                                          0541
*   RESPECIFY                                                      0542
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   CALL ENDRTN;                    /* CALL ENDROUTINE               */
         BAL   @14,ENDRTN                                          0543
*   RESPECIFY                                                      0544
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */
*   R14=SVER14;                     /* RESTORE RETURN ADDRESS        */
         L     R14,SVER14                                          0545
*   RETURN;                         /* RETURN TO CALLER              */
@EL00001 L     @13,4(,@13)                                         0546
@EF00001 L     @00,@SIZDATD                                        0546
         LR    @01,@12                                             0546
         FREEMAIN R,LV=(0),A=(1)
@ER00001 L     @14,12(,@13)                                        0546
         LM    @00,@12,20(@13)                                     0546
         BR    @14                                                 0546
*   RESPECIFY                                                      0547
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   GEN(EJECT);                                                    0548
*                                                                  0548
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* STAE RETRY ROUTINE R1 = ADDR OF STAE WORKAREA OFFSET 0 - STAE */
*   /* EXIT ROUTINE PARMLIST CONTAINING ADDR TO WORKAREA AND ADDR OF */
*   /* PARMLST IN STAE EXIT ROUTINE PARAMETER LIST . OFFSET 56 - BASE*/
*   /* REGISTER TO IKJEE100 . OFFSET 60 - ADDRESSIBILITY TO WORKAREA */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0549
*IKJEE101:                                                         0549
*   RESPECIFY                                                      0549
*    (R0,                                                          0549
*     R1,                                                          0549
*     R13) RSTD;                    /* RESTRICT REGISTER USAGE       */
IKJEE101 DS    0H                                                  0550
*   GEN;                                                           0550
     L     R4,0(R1)                 ESTABLISH ADDR. TO PARLIST
     L     R8,52(R4)                RESTORE DATA BASE REGISTER
     LM    R11,R12,56(R4)           RESTORE BASE REG AND ADDRESSIBILITY
*                                   TO WORKAREA
H52 EQU  52                         DISPLACEMENT OF 52
H56 EQU  56                         DISPLACEMENT OF 56
*   R13=SAVE13;                     /* RESTORE REGISTER 13           */
         L     R13,SAVE13                                          0551
*   R0=CIV;                         /* LENGTH OF STAE W/A TO BE FREED*/
*                                                                  0552
         LA    R0,104                                              0552
*   /*****************************************************************/
*   /*                                                               */
*   /* R1 CONTAINS ADDR OF AREA                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   GEN(FREEMAIN R,LV=(0),A=(1));   /* ISSUE FREEMIAN                */
         FREEMAIN R,LV=(0),A=(1)
*   RESPECIFY                                                      0554
*    (R0,                                                          0554
*     R1,                                                          0554
*     R13) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   GO TO BEGNAGAN;                 /* RETURN TO MAINLINE            */
         B     BEGNAGAN                                            0555
*   GEN(EJECT);                                                    0556
*                                                                  0556
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING MACROS GENERATE THE PARAMETER LISTS FOR THE I/O */
*   /* ROUTINES - GETLINE, PUTLINE, PUTGET MACRO OPTION MEANING      */
*   /* GETLINE ISTACK INPUT LINE TO BE OBTAINED FROM CURRENTLY ACTIVE*/
*   /* INPUT SOURCE LOGICAL LOGICAL INPUT LINE TO BE OBTAINED EDIT   */
*   /* ADDITIONAL EDITING ON LINE WAIT IWAIT IF INPUT BUFFER NOT     */
*   /* AVAILABLE PUTLINE TERM OUTPUT LINE PUT TO TERMINAL MULTLVL    */
*   /* OUTPUT LINE IS OF MULTIPLE LEVEL INFOR OUTPUT LINE IS AN      */
*   /* INFORMATIONAL MSG EDIT SAME WAIT OWAIT IF OUTPUT BUFFERS NOT  */
*   /* AVAILABLE NOHOLD PROCESSING CONTINUES FOLLOWING THE PLACING OF*/
*   /* OUTPUT ON OUTPUT QUEUE NO BREAK INPUT HAS PRECEDENCE OVER     */
*   /* OUTPUT,I.E. MSG IS PLACED ON OUTPUT QUEUE TO BE PRINTED WHEN  */
*   /* USER IS NOT ENTERING A LINE PUTGET SINGLE OUTPUT LINE IS OF   */
*   /* SINGLE LINE MODE OUTPUT LINE IS A MODE MESSAGE                */
*   /* TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK) EXPLAINED UNDER PUTLINE    */
*   /* TERMGET=(EDIT,WAIT) EXPLAINED UNDER GETLINE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0557
*   GEN;                                                           0557
PUTLIST1 PUTLINE ,MF=L
PGLIST   PUTGET ,MF=L
         EXTRN IKJEE1A0
STAELST  STAE IKJEE1A0,MF=L
STAXL    STAX 0,MF=L
STKL     STACK DELETE=ALL,MF=L
*   GEN(EJECT);                                                    0558
*                                                                  0558
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ROUTINE GETS CONTROL WHEN AN ATTN EXIT IS TAKEN */
*   /* AND A NEW COMMAND IS ENTERED TO SUPERCEDE THE CURRENT COMMAND.*/
*   /* THE CPECB WAS POSTED BY THE ATTN EXIT ROUTINE. THE POINTERS TO*/
*   /* THE COMMAND BUFFER AND COMMAND SCAN OUTPUT AREA ARE ADJUSTED  */
*   /* TO THE DATA FOR THE NEW COMMAND. PROCESSING FOR THE NEW       */
*   /* COMMAND BEGINS AT CHECKING THE OUTPUT FROM COMMAND SCAN       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0559
*ATTN:                                                             0559
*   CPECB=ZEROS;                    /* CLEAR OPERATOR CP'S ECB       */
ATTN     MVC   CPECB(4),ZEROS                                      0559
*   WORK7=PTRWORK7;                 /* ADJUST PTR TO COMMAND BUFFER  */
         MVC   WORK7(4),PTRWORK7                                   0560
*   CSOAPTR=PTRSCAN;                /* ADJUST PTR TO CMD SCAN OUTPUT
*                                      AREA                          */
         MVC   CSOAPTR(4),PTRSCAN                                  0561
*   GO TO SCANTEST;                 /* PROCESS NEW COMMAND           */
         B     SCANTEST                                            0562
*                                                                  0563
*/********************************************************************/
*/*  ROUTINE TO CALCULATE LENGTH OF OPERAND ON MONITOR, STOPMN,      */
*/*  CANCEL, OR DISPLAY COMMANDS AND THEN TRANSLATE THE OPERAND      */
*/*  TO UPPER CASE.                                                  */
*/********************************************************************/
*                                                                  0563
*   GEN(EJECT);                                                    0563
         EJECT
*CLNGOP:                                                           0564
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PROC TO CAL LENGTH          */
         B     @PB00002                                            0564
CLNGOP   DS    0H                                                  0565
*   RFY                                                            0565
*    (R4,                                                          0565
*     R5) RSTD;                     /* RESTRICT INPUT/OUTPUT       0565
*                                      REGISTERS                     */
*LOOPSRCH:                                                         0566
*   IF OPERAND(1)=BLANK             /* IF NEXT CHARACTER IS BLANK    */
*     THEN                          /* SCAN COMPLETE, GO TO TRANSLATE
*                                      OPERAND TO UPPER CASE         */
LOOPSRCH CLC   OPERAND(1,R5),BLANK                                 0566
         BNE   @RF00566                                            0566
*     DO;                                                          0567
*       LNGOPRND=R6;                /* GET LENGTH OF OPERAND         */
         ST    R6,LNGOPRND                                         0568
*       R6=R6-UNO;                  /* DECREMENT FOR EXECUTE         */
         BCTR  R6,0                                                0569
*       RESPECIFY                                                  0570
*        (R1) RSTD;                 /* RESTRICT REG 1 USAGE          */
*       R1=AOPRND;                  /* POINT TO BEGINNING OF OPERAND */
         L     R1,AOPRND                                           0571
*       GEN;                                                       0572
           EX R6,EXTRNSLT           EXECUTE TRANSLATE INSTR
*       RESPECIFY                                                  0573
*        (R1) UNRSTD;               /* FREE REG FOR COMPILER         */
*       RETURN;                     /* RETURN TO CALLING ROUTINE     */
@EL00002 DS    0H                                                  0574
@EF00002 DS    0H                                                  0574
@ER00002 BR    @14                                                 0574
*     END;                                                         0575
*   ELSE                            /* NON BLANK OPERAND             */
*     DO;                                                          0576
@RF00566 DS    0H                                                  0577
*       R6=R6+UNO;                  /* INCREMENT POINTER IN BUFFER   */
         LA    @10,1                                               0577
         ALR   R6,@10                                              0577
*       R5=R5+UNO;                  /* INCREMENT LENGTH OF OPERAND   */
         ALR   R5,@10                                              0578
*       GO TO LOOPSRCH;             /* CONTINUE LOOPING              */
         B     LOOPSRCH                                            0579
*     END;                                                         0580
*   RFY                                                            0581
*    (R4,                                                          0581
*     R5) UNRSTD;                   /* FREE INPUT/OUTPUT REGISTERS   */
*   GENERATE;                                                      0582
EXTRNSLT TR   0(*-*,R1),UPPERTAB    TO CONVERT TO UPPERTABP
*   END CLNGOP;                                                    0583
         B     @EL00002                                            0583
@PB00002 DS    0H                                                  0584
*   GEN(EJECT);                                                    0584
*                                                                  0584
         EJECT
*/********************************************************************/
*/*  THE FOLLOWING ROUTINE PROCESSES THE END COMMAND, A REQUEST      */
*/*  TO TERMINATE OPERATOR MODE.  ANY ACTIVE MONITOR FUNCTIONS       */
*/*  ARE STOPPED AND CONTROL RETURNS TO THE TMP WITH A RETURN        */
*/*  CODE OF 0 IN REGISTER 15.  ANY OUTSTANDING CMD BUFFERS MUST     */
*/*  BE FREED BEFORE GIVING UP CONTROL AND RETURNING.                */
*/********************************************************************/
*                                                                  0585
*ENDRTN:                                                           0585
*   PROC OPTIONS(NOSAVEAREA);       /* END ROUTINE PROCEDURE         */
         B     @PB00003                                            0585
ENDRTN   STM   @14,@12,12(@13)                                     0585
*   RESPECIFY                                                      0586
*    (R6,                                                          0586
*     R8) RESTRICTED;                                              0586
*   IF BUFFPTR^=ZEROS               /* DOES IKJEE100 HAVE BUFFER TO
*                                      BE FREED?                     */
*     THEN                          /* YES,                          */
         L     @10,BUFFPTR                                         0587
         C     @10,ZEROS                                           0587
         BE    @RF00587                                            0587
*     DO;                                                          0588
*       WORK1=SUBPOOL1;             /* PUT SUBPOOL NUMBER IN HIGH  0589
*                                      ORDER BYTE                    */
         MVC   WORK1(4),SUBPOOL1                                   0589
*       WORK1(3:4)=BUFFAREA(1:2);   /* GET LENGTH TO BE FREED        */
         MVC   WORK1+2(2),BUFFAREA(@10)                            0590
*       RESPECIFY                                                  0591
*        (R0,                                                      0591
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */
*       R0=WORK1;                                                  0592
         L     R0,WORK1                                            0592
*       R1=BUFFPTR;                 /* GET ADDRESS OF AREA           */
         LR    R1,@10                                              0593
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE BUFFER AREA         */
         FREEMAIN R,LV=(0),A=(1)
*       RESPECIFY                                                  0595
*        (R0,                                                      0595
*         R1) UNRSTD;               /* FREE REGS FOR COMPILER USAGE  */
*       BUFFPTR=ZEROS;              /* NO BUFFER TO BE FREED         */
         MVC   BUFFPTR(4),ZEROS                                    0596
*     END;                                                         0597
*   IF ATTNBUFF^=ZEROS              /* DOES STAE HAVE CMD BUFFER TO
*                                      BE FREED?                     */
*     THEN                          /* YES, IT HAS ONE TO BE FREED   */
@RF00587 L     @10,ATTNBUFF                                        0598
         C     @10,ZEROS                                           0598
         BE    @RF00598                                            0598
*     DO;                                                          0599
*       WORK1=SUBPOOL1;             /* PUT SUBPOOL NUMBER IN HIGH  0600
*                                      ORDER BYTE                    */
         MVC   WORK1(4),SUBPOOL1                                   0600
*       RESPECIFY                                                  0601
*        (R0,                                                      0601
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */
*       R1=ATTNBUFF;                /* GET ADDRESS OF AREA TO BE   0602
*                                      FREED                         */
         LR    R1,@10                                              0602
*       GEN(MVC WORK1+2(2),0(R1));  /* UPDATE LENGTH TO BE FREED     */
         MVC WORK1+2(2),0(R1)
*       R0=WORK1;                                                  0604
         L     R0,WORK1                                            0604
*       GEN(FREEMAIN R,LV=(0),A=(1));                              0605
         FREEMAIN R,LV=(0),A=(1)
*       RESPECIFY                                                  0606
*        (R0,                                                      0606
*         R1) UNRSTD;               /* FREE REGS FOR CONPILER USAGE  */
*       ATTNBUFF=ZEROS;             /* ATTN HAS NO MORE COMMAND    0607
*                                      BUFFERS OUTSTANDING           */
         MVC   ATTNBUFF(4),ZEROS                                   0607
*     END;                                                         0608
*   RESPECIFY                                                      0609
*    (R4,                                                          0609
*     R5) RESTRICTED;                                              0609
@RF00598 DS    0H                                                  0610
*   IF FSTFLG='1'B                  /* WHEN EXTRA BUFFERS INDICATOR  */
*     THEN                          /* IN TSB IS ON                  */
         TM    FSTFLG,B'00001000'                                  0610
         BNO   @RF00610                                            0610
*     DO;                           /* YES, IT IS ON SO:             */
*       OFFGETBF='1'B;              /* SET FLAG IN CALLPARM FOR SVC
*                                      100 TO TURN IT OFF            */
*       AUTHCHK='0'B;               /* CALL IS NOT FOR AUTHORITY CK  */
         OI    OFFGETBF,B'00010000'                                0613
         NI    AUTHCHK,B'01111111'                                 0613
*       RESPECIFY                                                  0614
*        (R1,                                                      0614
*         R15) RSTD;                /* RESTRICT ACROSS SVC           */
*       R1=ADDR(FIBMAINP);          /* POINT TO PARAMETER LIST       */
         LA    R1,FIBMAINP                                         0615
*       SVC(100);                   /* SVC FOR FIB, PROF AND OPER TSO
*                                      COMMANDS....IKJEFFS0 PL/S   0616
*                                      MACRO                         */
         SVC   100                                                 0616
*       R6=R15;                     /* SAVE RETURN CODE IN R6        */
         LR    R6,R15                                              0617
*       RESPECIFY                                                  0618
*        (R1,                                                      0618
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*       IF R6^=FIBOKRC THEN         /* WAS SVC 100 SUCCESSFUL ?      */
         LTR   R6,R6                                               0619
         BZ    @RF00619                                            0619
*         DO;                       /* THE SVC WAS UNSUCCESSFUL      */
*           IF ECTATRM='1'B         /* TEST IF END RTN RECEIVED    0621
*                                      CONTROL FROM STAE ON DETACH 0621
*                                      FROM TMP                      */
*             THEN                  /* YES, AND SVC 100 UNSUCCESSFUL,*/
         L     @10,SAVECPPL                                        0621
         L     @10,ECTPTR(,@10)                                    0621
         TM    ECTATRM(@10),B'00100000'                            0621
         BO    @RT00621                                            0621
*             RETURN;               /* RETURN TO STAE TO TERMINATE   */
*           ELSE                    /* NO, BUT SVC 100 UNSUCCESSFUL, */
*             DO;                   /* PREPARE TO PUT OUT MESSAGE    */
*               MSGSEG2B=ADDR(SVC100SG);/* POINT TO MESSAGE SEGMENT  */
         LA    @10,SVC100SG                                        0624
         ST    @10,MSGSEG2B                                        0624
*               EXITERR='1'B;       /* DO NOT ENTER ENDRTN AGAIN     */
         OI    EXITERR,B'00100000'                                 0625
*               GO TO MSGRTN4;      /* GO PUT OUT ERROR MESSAGE      */
         B     MSGRTN4                                             0626
*             END;                                                 0627
*         END;                      /* END UNSUCCESSFUL PROCESSING   */
*     END;                          /* END OF GETBF BIT ON PROCESSING*/
*   RETURN;                         /* RETURN TO CALLER              */
@EL00003 DS    0H                                                  0630
@EF00003 DS    0H                                                  0630
@ER00003 LM    @14,@12,12(@13)                                     0630
         BR    @14                                                 0630
*   END ENDRTN;                                                    0631
         B     @EL00003                                            0631
@PB00003 DS    0H                                                  0632
*   GEN(EJECT);                                                    0632
*                                                                  0632
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE TO PUT A LINE TO TERMINAL                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0633
*PUTLRTN:                                                          0633
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PUTLINE ROUTINE             */
         B     @PB00004                                            0633
PUTLRTN  DS    0H                                                  0634
*   RESPECIFY                                                      0634
*    (R4,                                                          0634
*     R5,                                                          0634
*     R6,                                                          0634
*     R8,                                                          0634
*     R14) RESTRICTED;                                             0634
*   SAVE14=R14;                     /* SAVE THE RETURN ADDRESS       */
         ST    R14,SAVE14                                          0635
*   RESPECIFY                                                      0636
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   IOPLIOPB=ADDR(IOBLOCK);         /* ADDR OF PUTLINE BLOCK         */
         LA    @10,SRPARM                                          0637
         LA    @09,IOBLOCK                                         0637
         ST    @09,IOPLIOPB(,@10)                                  0637
*   PTPB(1:12)=PUTLIST1;            /* CLEAR PUTLINE PARM BLOCK      */
         MVC   PTPB(12,@09),PUTLIST1                               0638
*   LNGOFF1=ZEROS;                  /* CLEAR MSG1 OFFSET FIELD       */
         L     @09,ZEROS                                           0639
         STH   @09,LNGOFF1                                         0639
*   LNGOFF2=ZEROS;                  /* CLEAR MSG2 OFFSET FIELD       */
         STH   @09,LNGOFF2                                         0640
*   R5=ADDR(NXTLVMSG);              /* ADDRESS OUTPUT DESCRIPTOR     */
         LA    R5,NXTLVMSG                                         0641
*   RESPECIFY                                                      0642
*    (R1,                                                          0642
*     R15) RSTD;                    /* RESTRICT REGS ACROSS MACRO    */
*   R1=ADDR(SRPARM);                /* GET PARM LIST ADDR            */
         LR    R1,@10                                              0643
*   R15=WORK6;                      /* GET PUTLINE ADDRESS           */
         L     R15,WORK6                                           0644
*/*                                                                0645
*    USE PUTLINE TO ISSUE FIRST LEVEL MSG                          0645
*                                                                    */
*                                                                  0645
*   GEN(PUTLINE OUTPUT=((5),MULTLVL),ENTRY=(15),MF=(E,(1)));       0645
*                                                                  0645
         PUTLINE OUTPUT=((5),MULTLVL),ENTRY=(15),MF=(E,(1))
*/*                                                                0646
*    TEST RETURN CODES OF PUTLINE                                  0646
*      00 - SUCCESSFUL COMPLETION                                  0646
*      04 - PROCESSING INTERRUPTED BY ATTENTION                    0646
*      08 - NOWAIT SPECIFIED - OUTPUT NOT SENT                     0646
*      12 - INVALID PARAMETERS                                     0646
*      16 - NO SPACE AVAILABLE (GETMAIN FAILURE)                   0646
*                                                                    */
*                                                                  0646
*   R6=R15;                         /* SAVE RETURN CODE FOR TESTING  */
         LR    R6,R15                                              0646
*   RESPECIFY                                                      0647
*    (R1,                                                          0647
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   IF R6=ZEROS                     /* WAS PUTLINE SUCCESSFUL?       */
*     THEN                          /* YES,                          */
         C     R6,ZEROS                                            0648
         BNE   @RF00648                                            0648
*     DO;                                                          0649
*       RESPECIFY                                                  0650
*        (R14) RSTD;                /* RESTRICT RETURN ADDR REG      */
*       R14=SAVE14;                 /* RESTORE RETURN ADDR           */
         L     R14,SAVE14                                          0651
*       RETURN;                     /* RETURN TO CALLER              */
@EL00004 DS    0H                                                  0652
@EF00004 DS    0H                                                  0652
@ER00004 BR    @14                                                 0652
*       RESPECIFY                                                  0653
*        (R14) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*     END;                          /* END SUCCESSFUL PROCESSING     */
*   IF R6=FOUR                      /* WAS AN ATTENTION ENTERED?     */
*     THEN                          /* ATTN EXIT RTN POSTED CP ECB GO*/
@RF00648 CH    R6,@CH00049                                         0655
         BE    @RT00655                                            0655
*     GO TO ATTN;                   /* PROCESS NEW COMMAND ENTERED   */
*   IOPLIOPB=ADDR(STPB);            /* ADDRESS OF STACK PARAMETER BLK*/
         LA    @10,SRPARM                                          0657
         LA    @09,IOBLOCK                                         0657
         ST    @09,IOPLIOPB(,@10)                                  0657
*   STPB=STKL;                      /* MOVE STACK PARAMETERS         */
         MVC   STPB(20,@09),STKL                                   0658
*   RESPECIFY                                                      0659
*    (R1,                                                          0659
*     R15) RSTD;                    /* RESTRICT REGS ACROSS MACRO    */
*   R1=ADDR(IOPL);                  /* ADDRESS IO SERVICE ROUTINES 0660
*                                      PARAMETER LIST                */
         LR    R1,@10                                              0660
*   R15=PTRSTACK;                   /* ENTRY POINT OF STACK          */
         L     R15,PTRSTACK                                        0661
*   GEN(STACK ENTRY=(15),MF=(E,(1)));/* RESET INPUT SOURCE TO THE  0662
*                                      TERMINAL                      */
         STACK ENTRY=(15),MF=(E,(1))
*   RESPECIFY                                                      0663
*    (R1,                                                          0663
*     R15) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*   GEN(TCLEARQ INPUT);             /* CLEAR OUT ANY TYPED AHEAD   0664
*                                      INPUT FROM THE TERMINAL       */
         TCLEARQ INPUT
*   R6=TWELVE;                      /* ERROR RETURN CODE PASSED TO 0665
*                                      TMP INDICATING ERROR IN     0665
*                                      OPERATOR PROCESSING           */
         LA    R6,12                                               0665
*   GO TO EXITA;                    /* GO TO RETURN TO TMP           */
         B     EXITA                                               0666
*   END PUTLRTN;                    /* END OF PUTLRTN PROCEDURE      */
@PB00004 DS    0H                                                  0668
*   GEN(EJECT);                                                    0668
*                                                                  0668
         EJECT
*/********************************************************************/
*/*                                                                  */
*/* PUT AND GET A LINE PROCEDURE                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0669
*PUTGTRTN:                                                         0669
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* PUTGET ROUTINE              */
         B     @PB00005                                            0669
PUTGTRTN DS    0H                                                  0670
*   RESPECIFY                                                      0670
*    (R4,                                                          0670
*     R5,                                                          0670
*     R6,                                                          0670
*     R8) RESTRICTED;                                              0670
*   RESPECIFY                                                      0671
*    (R14) RSTD;                    /* RESTRICT RETURN ADDR REG      */
*   SAVE14=R14;                     /* SAVE THE RETURN ADDRESS       */
         ST    R14,SAVE14                                          0672
*   RESPECIFY                                                      0673
*    (R14) UNRSTD;                  /* FREE FOR COMPILER USAGE       */
*REPUT:                                                            0674
*   IOPLIOPB=ADDR(IOBLOCK);         /* ADDR OF PUTGET PARMS          */
REPUT    LA    @10,SRPARM                                          0674
         LA    @09,IOBLOCK                                         0674
         ST    @09,IOPLIOPB(,@10)                                  0674
*   PGPB(1:16)=PGLIST;                                             0675
         MVC   PGPB(16,@09),PGLIST                                 0675
*   IF NOMSG='1'B                   /* CHECK IF NO MSG SHOULD BE   0676
*                                      ISSUED                        */
*     THEN                          /* YES,                          */
         TM    NOMSG,B'01000000'                                   0676
         BNO   @RF00676                                            0676
*     DO;                                                          0677
*       RESPECIFY                                                  0678
*        (R1,                                                      0678
*         R15) RSTD;                /* RESTRICT REGS ACROSS MACRO    */
*       R1=ADDR(SRPARM);            /* GET PARM LIST ADDR            */
         LR    R1,@10                                              0679
*       R15=WORK2;                  /* ENTRY PNT ADDR OF PUTGET      */
         L     R15,WORK2                                           0680
*       GEN(PUTGET OUTPUT=(0,MODE),ENTRY=(15),MF=(E,(1)));         0681
         PUTGET OUTPUT=(0,MODE),ENTRY=(15),MF=(E,(1))
*       R6=R15;                     /* SAVE RETURN CODE FOR TESTING  */
         LR    R6,R15                                              0682
*       RESPECIFY                                                  0683
*        (R1,                                                      0683
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*     END;                                                         0684
*   ELSE                            /* NO,                           */
*     DO;                                                          0685
         B     @RC00676                                            0685
@RF00676 DS    0H                                                  0686
*       LNGOFF1=ZEROS;              /* INITIALIZE OFFSET LENGTHS IN
*                                      BUFFERS                       */
         L     @10,ZEROS                                           0686
         STH   @10,LNGOFF1                                         0686
*       LNGOFF2=ZEROS;                                             0687
         STH   @10,LNGOFF2                                         0687
*       R4=ADDR(NOMSGSG1);                                         0688
         LA    R4,NOMSGSG1                                         0688
*       RESPECIFY                                                  0689
*        (R1,                                                      0689
*         R15) RSTD;                /* RESTRICT REGS ACROSS MACRO    */
*       R1=ADDR(SRPARM);            /* GET PARM LIST ADDR            */
         LA    R1,SRPARM                                           0690
*       R15=WORK2;                  /* ENTRY PT ADDR OF PUTGET       */
         L     R15,WORK2                                           0691
*       GEN(PUTGET OUTPUT=((R4),MODE),ENTRY=(15),MF=(E,(1)));      0692
         PUTGET OUTPUT=((R4),MODE),ENTRY=(15),MF=(E,(1))
*       R6=R15;                     /* SAVE RETURN CODE FOR TESTING  */
         LR    R6,R15                                              0693
*       RESPECIFY                                                  0694
*        (R1,                                                      0694
*         R15) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*     END;                                                         0695
*                                                                  0695
*/*                                                                0696
*    TEST RETURN CODES FROM PUTGET                                 0696
*      00 - SUCCESSFUL COMPLETION                                  0696
*      04 - INPUT LINE RETURNED IS NOT FROM TERMINAL               0696
*      08 - NO INPUT RETURNED - ATTENTION INTERRUPT OCCURRED AND   0696
*              COMMUNICATIONS ECB IS POSTED                        0696
*      12 - NO INPUT LINE RETURNED                                 0696
*              INPUT IS NOT FROM TERMINAL, SECOND LEVEL MESSAGES   0696
*              ARE CHAINED AND THE USER HAS SPECIFIED NO PAUSE     0696
*      16 - NOWAIT SPECIFIED - OUTPUT NOT SENT                     0696
*      20 - NOWAIT SPECIFIED - NO INPUT RETURNED                   0696
*      24 - INVALID PARAMETERS                                     0696
*      28 - NO SPACE AVAILABLE (GETMAIN FAILURE)                   0696
*                                                                    */
*                                                                  0696
*   IF BUFFPTR^=ZEROS               /* ARE THERE BUFFERS TO BE FREED */
*     THEN                          /* YES, THERE ARE                */
@RC00676 L     @10,BUFFPTR                                         0696
         C     @10,ZEROS                                           0696
         BE    @RF00696                                            0696
*     DO;                                                          0697
*       WORK1(3:4)=BUFFAREA(1:2);   /* GET LNGTH TO BE FREED         */
         MVC   WORK1+2(2),BUFFAREA(@10)                            0698
*       RESPECIFY                                                  0699
*        (R0,                                                      0699
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */
*       R0=WORK1;                                                  0700
         L     R0,WORK1                                            0700
*       R1=BUFFPTR;                 /* GET ADDRESS OF BUFFER         */
         LR    R1,@10                                              0701
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE BUFFER              */
         FREEMAIN R,LV=(0),A=(1)
*       RESPECIFY                                                  0703
*        (R0,                                                      0703
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*       BUFFPTR=ZEROS;              /* NO BUFFERS TO BE FREED        */
         MVC   BUFFPTR(4),ZEROS                                    0704
*     END;                                                         0705
*   IF R6=ZEROS×R6=FOUR             /* WAS PUTGET SUCCESSFUL ?       */
*     THEN                          /* YES,                          */
@RF00696 C     R6,ZEROS                                            0706
         BE    @RT00706                                            0706
         CH    R6,@CH00049                                         0706
         BNE   @RF00706                                            0706
@RT00706 DS    0H                                                  0707
*     DO;                           /* MOVE INPUT TO OWN BUFFER      */
*       WORK7=PGPBIBUF;             /* CMD BUFFER BASED ON PTR TO  0708
*                                      PUTGET BUFFER                 */
         LA    @10,IOBLOCK                                         0708
         L     @10,PGPBIBUF(,@10)                                  0708
         ST    @10,WORK7                                           0708
*/*                                                                0709
*          GET OWN BUFFER AREA AND MOVE COMMAND BUFFER INTO IT TO  0709
*          ENSURE COMMAND IS DELIMITED BY BLANKS FOR SVC 34 SYNTAX 0709
*          CHECK. FREE BUFFER OBTAINED BY PUTGET                   0709
*                                                                    */
*                                                                  0709
*       WORK1=SUBPOOL1;             /* SET SUBPOOL NUMBER            */
         MVC   WORK1(4),SUBPOOL1                                   0709
*       WORK1(3:4)=LNGBUFFR+EIGHT;  /* SET TO NEXT DOUBLEWORD LEN TO
*                                      ALLOW FOR TRAILING BLANK      */
         LA    @09,8                                               0710
         AH    @09,LNGBUFFR(,@10)                                  0710
         ST    @09,@TF00001                                        0710
         MVC   WORK1+2(2),@TF00001+2                               0710
*       RESPECIFY                                                  0711
*        (R0,                                                      0711
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */
*       R0=WORK1;                                                  0712
         L     R0,WORK1                                            0712
*       GEN(GETMAIN R,LV=(0));      /* GET NEEDED BUFFER AREA        */
         GETMAIN R,LV=(0)
*       BUFFPTR=R1;                 /* SAVE THE ADDRESS              */
         ST    R1,BUFFPTR                                          0714
*       RESPECIFY                                                  0715
*        (R0,                                                      0715
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*       BUFFAREA(1:LNGBUFFR)=CMDBUFFR(1:LNGBUFFR);/* MOVE CMD INTO 0716
*                                      NEW AREA                      */
         L     @10,BUFFPTR                                         0716
         L     @09,WORK7                                           0716
         LH    @07,LNGBUFFR(,@09)                                  0716
         LR    @15,@07                                             0716
         BCTR  @15,0                                               0716
         EX    @15,@SM01357                                        0716
*       BUFFAREA(LNGBUFFR+UNO:LNGBUFFR+EIGHT)='';/* BLANK OUT REST   */
         ALR   @07,@10                                             0717
         MVI   BUFFAREA(@07),C' '                                  0717
         MVC   BUFFAREA+1(7,@07),BUFFAREA(@07)                     0717
*       BUFFAREA(1:2)=LNGBUFFR+EIGHT;/* SET THE NEW LENGTH           */
         L     @09,WORK7                                           0718
         LH    @09,LNGBUFFR(,@09)                                  0718
         LA    @07,8                                               0718
         ALR   @07,@09                                             0718
         ST    @07,@TF00001                                        0718
         MVC   BUFFAREA(2,@10),@TF00001+2                          0718
*       WORK1=SUBPOOL1;             /* SET SUBPOOL NUMBER TO 1       */
         MVC   WORK1(4),SUBPOOL1                                   0719
*       WORK1(3:4)=LNGBUFFR;        /* GET LENGTH FROM BUFFER HEADER */
         ST    @09,@TF00001                                        0720
         MVC   WORK1+2(2),@TF00001+2                               0720
*       RESPECIFY                                                  0721
*        (R0,                                                      0721
*         R1) RSTD;                 /* RESTRICT REGS ACROSS MACRO    */
*       R0=WORK1;                                                  0722
         L     R0,WORK1                                            0722
*       R1=PGPBIBUF;                /* GET ADDRESS OF BUFFER         */
         LA    @10,IOBLOCK                                         0723
         L     R1,PGPBIBUF(,@10)                                   0723
*       GEN(FREEMAIN R,LV=(0),A=(1));/* FREE BUFFER                  */
         FREEMAIN R,LV=(0),A=(1)
*       RESPECIFY                                                  0725
*        (R0,                                                      0725
*         R1) UNRSTD;               /* FREE FOR COMPILER USAGE       */
*       WORK7=BUFFPTR;              /* RESET CMDBUFFR BASE VALUE     */
         MVC   WORK7(4),BUFFPTR                                    0726
*       RESPECIFY                                                  0727
*        (R14) RSTD;                /* RESTRICT RETURN ADDR REG      */
*       R14=SAVE14;                 /* RESTOR RETURN ADDRESS         */
         L     R14,SAVE14                                          0728
*       RETURN;                     /* RETURN TO CALLER              */
@EL00005 DS    0H                                                  0729
@EF00005 DS    0H                                                  0729
@ER00005 BR    @14                                                 0729
*       RESPECIFY                                                  0730
*        (R14) UNRSTD;              /* FREE FOR COMPILER USAGE       */
*     END;                                                         0731
*   IF R6=EIGHT                     /* WAS THERE AN ATTENTION ?      */
*     THEN                          /* ATTEN EXIT RTN POSTED CPECB GO*/
@RF00706 CH    R6,@CH00035                                         0732
         BE    @RT00732                                            0732
*     GO TO ATTN;                   /* PROCESS NEW COMMAND ENTERED   */
*   IF R6=TWELVE                    /* NO INPUT ?                    */
*     THEN                          /* DELETE 2ND LVL MSG CHAIN      */
         CH    R6,@CH00037                                         0734
         BNE   @RF00734                                            0734
*     DO;                                                          0735
*       ECTMSGF='1'B;               /* SETS SWITCH TO DELETE 2ND   0736
*                                      LEVEL MESSAGE CHAIN           */
         L     @10,SAVECPPL                                        0736
         L     @10,ECTPTR(,@10)                                    0736
         MVI   ECTMSGF(@10),B'10000000'                            0736
*       GO TO REPUT;                /* RETURN TO REISSUE PUTGET      */
         B     REPUT                                               0737
*     END;                                                         0738
*   MSGSEG2B=ADDR(PTGTSEG);         /* INITIALIZE PTPB FOR ERROR MSG
*                                      FOR PUTLINE                   */
@RF00734 LA    @10,PTGTSEG                                         0739
         ST    @10,MSGSEG2B                                        0739
*   GO TO MSGRTN4;                  /* GO TO PUT OUT ERROR MSG       */
         B     MSGRTN4                                             0740
*   END PUTGTRTN;                   /* END OF PUTGET PROCEDURE       */
@PB00005 DS    0H                                                  0742
*   GEN(EJECT);                                                    0742
*                                                                  0742
         EJECT
*/********************************************************************/
*/*                                                                  */
*/*  PROCEDURE TO CLEAR A BUFFER                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0743
*CLEAR:                                                            0743
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/* BUFFER CLEARING PROC        */
         B     @PB00006                                            0743
CLEAR    DS    0H                                                  0744
*   RESPECIFY                                                      0744
*    (R4,                                                          0744
*     R5,                                                          0744
*     R6,                                                          0744
*     R8) RESTRICTED;                                              0744
*   OUTBUFF1=BLANK;                 /* CLEAR FIRST OUTPUT BUFFER     */
         MVI   OUTBUFF1+1,C' '                                     0745
         MVC   OUTBUFF1+2(130),OUTBUFF1+1                          0745
         MVC   OUTBUFF1(1),BLANK                                   0745
*   OUTBUFF2=OUTBUFF1;              /* CLEAR THE SECOND OUTPUT BUFFER*/
         MVC   OUTBUFF2(132),OUTBUFF1                              0746
*   END CLEAR;                      /* END OF CLEAR PROCEDURE        */
@EL00006 DS    0H                                                  0747
@EF00006 DS    0H                                                  0747
@ER00006 BR    @14                                                 0747
*/*IKJEE100:     CHART                                               */
*/*HEADER                                                          0748
*/*                                                                0748
*/*                                             PAGE #             0748
*/*                                                                0748
*/*                                                                  */
*/*E ENTRY                                                           */
*/*P INITIALIZE NUMBER OF TITLES                                     */
*/*%A5: I READ A FILE FROM TAPE                                      */
*/* P INCREMENT NUMBER OF TITLES                                     */
*/* D (YES,SORT,NO,) END OF INPUT?                                   */
*/* P INITIALIZE POSITION IN TITLE                                   */
*/*%A1: P INITIALIZE POSITION IN KEYWORD                             */
*/*%A2: P INCREMENT POSITION IN TITLE                                */
*/* P INCREMENT POSITION IN KEYWORD                                  */
*/* D (YES,,NO,%A2) WORD DELIMITER?                                  */
*/* D (YES,%A1,NO,) KEYWORD POSITION = 1 & = DELIMITER ?             */
*/* P DECREMENT BOTH COUNTERS BY ONE                                 */
*/* P INITIALIZE DICTIONARY POSITION TO BEGINNING                    */
*/*%A3: P INCREMENT DICTIONARY POSITION BY LENGTH                    */
*/* P INITIALIZE ARRAY OF CORRESPONDING DICTIONARY WORD LENGTHS      */
*/* D (YES,%A4,NO,) MATCH OF DICTIONARY WORD?                        */
*/* P PICK UP LENGTH OF NEXT DICTIONARY WORD                         */
*/* D (YES,,NO,%A3) END OF DICTIONARY ?                              */
*/* P PLACE THE KEYWORD LENGTH IN FIRST PART OF OUTFILE              */
*/* P PLACE TITLE WORDS BEFORE COMPARISON WORD ON LEFT SIDE          */
*/* P PLACE REMAINDER OF TITLE ON RIGHT SIDE OF OUTFILE              */
*/*%A4: D (YES,%A5,NO,) HIT THE END OF PRESENT TITLE?                */
*/* P (,%A1) INCREMENT TO NEXT WORD                                  */
*/*SORT: D (YES,PRINT,NO,) END OF TITLES-- I> NO. OF TITLES?         */
*/* D (YES,,NO,%B1) IS KEYWORD(I) < KEYWORD(I+1) ?                   */
*/* P EXCHANGE TITLE(I) AND TITLE(I+1)                               */
*/* P (,SORT) RESET I TO THE BEGINNING                               */
*/*%B1: P (,SORT) INCREMENT I BY ONE                                 */
*/*PRINT: I PRINT THE SORTED LIST OMITTING THE LENGTHS               */
*/*IKJEE100:    END                                                  */
*                                                                  0748
*   END IKJEE100                    /* END OF IKJEE100 (OPERATOR)    */
*                                                                  0748
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEZATTCH)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJEFFIB)                                       */
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */
*/*%INCLUDE SYSLIB  (IKJPGPB )                                       */
*/*%INCLUDE SYSLIB  (IKJPTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJCSPL )                                       */
*/*%INCLUDE SYSLIB  (IKJCSOA )                                       */
*/*%INCLUDE SYSLIB  (IKJDAPL )                                       */
*/*%INCLUDE SYSLIB  (IKJDAP2C)                                       */
*/*%INCLUDE SYSLIB  (IKJSTPB )                                       */
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFS0)                                       */
*                                                                  0748
*       ;                                                          0748
         B     @EL00001                                            0748
@DATA    DS    0H
@CH00057 DC    H'1'
@CH00251 DC    H'3'
@CH00035 DC    H'8'
@CH00037 DC    H'12'
@CH00041 DC    H'24'
@CH00429 DC    H'27'
@CH00424 DC    H'30'
@CH00437 DC    H'57'
@CH00439 DC    H'76'
@CH00426 DC    H'136'
@CH01132 DC    XL2'0004'
@SM01347 MVC   ECTSCMD(0,@07),CMDNAME(@10)
@SM01349 MVC   OUTBUFF1+8(0),CMDDATE-1(@07)
@SM01352 MVC   OUTBUFF1+29(0),CMDNAME(@07)
@SM01354 MVC   OUTBUFF1+26(0),OPERAND(R5)
@SM01357 MVC   BUFFAREA(0,@10),CMDBUFFR(@09)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJEE100 CSECT
         DS    0F
@CF00049 DC    F'4'
@CH00049 EQU   @CF00049+2
@DATD    DSECT
         DS    0D
BUFFPTR  DS    A
ATCHECB  DS    F
ATTCHPTR DS    A
WTOPTR   DS    F
WTOLNGTH DS    F
SAVECPPL DS    A
SAVE13   DS    F
SAVE14   DS    F
SVER14   DS    A
FIBMAINP DS    AL4
         ORG   FIBMAINP
FIBHIGH  DS    BL1
         ORG   FIBMAINP+4
CSOAPTR  DS    A
FIBPTR   DS    A
ENDNAME  DS    H
         DS    CL2
SRPARM   DS    CL24
IOBLOCK  DS    CL20
DAIRPARM DS    CL8
CMDSCAN  DS    CL8
STAXAREA DS    CL20
WORKAREA DS    CL36
         ORG   WORKAREA
WORK1    DS    CL4
WORK2    DS    FL4
WORK3    DS    AL4
WORK4    DS    FL4
WORK5    DS    FL4
WORK7    DS    AL4
WORK6    DS    AL4
WORKFLGS DS    CL1
         ORG   WORKFLGS
@NM00001 DS    BL1
NOMSG    EQU   WORKFLGS+0
EXITERR  EQU   WORKFLGS+0
ENDCMDFG EQU   WORKFLGS+0
         ORG   WORKAREA+32
GETLPTR  DS    AL4
         ORG   WORKAREA+36
AXBUF    DS    CL136
         ORG   AXBUF
AXLEN    DS    FL2
AXOFF    DS    FL2
AXTEXT   DS    CL132
         ORG   AXBUF+136
MODESEG  DS    CL26
         ORG   MODESEG
MODELEN  DS    FL2
MODEOFF  DS    FL2
MODETEXT DS    CL22
         ORG   MODESEG+26
FLAGWORD DS    CL4
         ORG   FLAGWORD
SYNCHK   DS    BL1
NOFLAG   EQU   FLAGWORD+0
RESWORD  DS    AL3
         ORG   FLAGWORD+4
         DS    CL2
MSGCHAIN DS    CL36
         ORG   MSGCHAIN
NXTLVMSG DS    AL4
NOMSGSG1 DS    FL4
MSGSEG1  DS    AL4
ENDCHAIN DS    FL4
NOMSGSG2 DS    FL4
MSGSEG2  DS    AL4
MSGSEG2B DS    AL4
MSGSEG2C DS    AL4
MSGSEG2D DS    AL4
         ORG   MSGCHAIN+36
         DS    CL4
BUFR1    DS    CL136
         ORG   BUFR1
LNGBUF1  DS    FL2
LNGOFF1  DS    FL2
OUTBUFF1 DS    CL132
         ORG   BUFR1+136
BUFR2    DS    CL136
         ORG   BUFR2
LNGBUF2  DS    FL2
LNGOFF2  DS    FL2
OUTBUFF2 DS    CL132
         ORG   BUFR2+136
EXITPARM DS    CL68
         ORG   EXITPARM
PTRCPPL  DS    AL4
PTRCPECB DS    AL4
PTRPUTL  DS    AL4
PTRGETL  DS    AL4
STAEAREA DS    AL4
ATTNAREA DS    AL4
PTRWORK7 DS    AL4
PTRSCAN  DS    AL4
@NM00002 DS    FL4
         ORG   @NM00002
EXITFLAG DS    BL1
         ORG   EXITFLAG
RSVD1    DS    BL1
RSVD2    EQU   EXITFLAG+0
@NM00003 EQU   EXITFLAG+0
NOWORK   EQU   EXITFLAG+0
         ORG   @NM00002+1
@NM00004 DS    CL1
RECURSON DS    FL2
         ORG   EXITPARM+36
PTRSTACK DS    AL4
ATTNSAVE DS    AL4
STAESAVE DS    AL4
ATTACHCB DS    AL4
REGISTR8 DS    AL4
BASE100  DS    AL4
WORKADDR DS    AL4
ATTNBUFF DS    AL4
         ORG   EXITPARM+68
         DS    CL4
STAEWORK DS    CL88
ATTNWORK DS    CL80
ATTNSA   DS    CL72
STAESA   DS    CL80
RTCDESEG DS    CL7
         ORG   RTCDESEG
HEADER   DS    FL4
TEXT     DS    CL3
         ORG   RTCDESEG+7
         DS    CL1
ATTCHPRM DS    CL60
STAELIST DS    CL20
CPECB    DS    CL4
         ORG   CPECB
ECBBIT0  DS    BL1
ECBBIT1  EQU   CPECB+0
ECBBITS  EQU   CPECB+0
ECBCC    DS    CL3
         ORG   CPECB+4
FIBPARMS DS    CL32
         ORG   FIBPARMS
FIBCPPL  DS    AL4
FIBUSER  DS    AL4
FIBCODE  DS    AL4
FIBMACRO DS    CL8
FIBID    DS    FL2
FIBLEN   DS    FL2
@NM00023 DS    AL4
@NM00024 DS    AL4
         ORG   FIBPARMS+32
CALLPARM DS    CL24
         ORG   CALLPARM
AOPRND   DS    AL4
LNGOPRND DS    FL4
ACMDNAME DS    AL4
ABUFFER  DS    AL4
CNTRLFLG DS    FL2
         ORG   CNTRLFLG
AUTHCHK  DS    BL1
CMDCHK   EQU   CNTRLFLG+0
@NM00025 EQU   CNTRLFLG+0
OFFGETBF EQU   CNTRLFLG+0
FSTFLG   EQU   CNTRLFLG+0
         ORG   CALLPARM+18
TERMID   DS    FL2
@NM00026 DS    AL4
         ORG   CALLPARM+24
IKJEE100 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00382 DC    V(IKJEE1A2)
@CA00383 DC    A(IKJEE150)
@CV00381 DC    V(IKJEE1A0)
         DS    0D
RTCDE    DC    XL4'0007000A'
ZEROS    DC    XL4'00000000'
DESCODE  DC    XL4'00004100'
LNGMSG4A DC    XL2'24'
LNGMSG0A DC    XL2'3A'
LNGMSG0B DC    XL2'46'
LNGMSG1A DC    XL2'30'
LNGMSG1B DC    XL2'36'
LNGMSG2A DC    XL2'0D'
LNGMSG3A DC    XL2'22'
LNGMSG3B DC    XL2'5E'
LNGMSG5A DC    XL2'1F'
LNGMSG5B DC    XL2'58'
LNGMSG6A DC    XL2'1E'
LNGMSG6B DC    XL2'35'
@CB01310 DC    X'002C'
MSG0001  DC    CL54'IKJ55000I OPERATOR COMMAND NOT AUTHORIZED FOR      C
                 +'
MSG0002  DC    CL66'IKJ55000I YOUR INSTALLATION MUST AUTHORIZE USE OF OC
               PERATOR COMMAND'
MSG0011  DC    CL44'IKJ55001I DATA IGNORED IN THE OPERAND FIELD+'
MSG0012  DC    CL50'IKJ55001I OPERATOR COMMAND SHOULD HAVE NO OPERANDS'
MSG0031  DC    CL28'IKJ55003I INVALID SUBCOMMAND'
MSG0032  DC    CL78'IKJ55003I OPERATOR SUBCOMMANDS ARE CANCEL×DISPLAY×MC
               ONITOR×SEND×STOPMN×END×HELP'
MSG0051  DC    CL25'IKJ55005I INVALID OPERAND'
MSG0052  DC    CL84'IKJ55005I OPERAND SYNTACTICALLY INCORRECT OR VALID C
               ONLY FROM SYSTEM OPERATOR CONSOLE'
MSG0061  DC    CL26'IKJ5006I MISSING OPERAND+'
MSG0062  DC    CL49'IKJ55006I OPERATOR SUBCOMMANDS MUST HAVE OPERANDS'
MSG0041  DC    CL31'IKJ55004I COMMAND SYSTEM ERROR+'
         DS    CL3
@NM00005 DS    CL14
         ORG   @NM00005
MSGIDHDR DC    XL4'000E0000'
MSGIDTXT DC    CL10'IKJ55004I'
         ORG   @NM00005+14
         DS    CL2
@NM00006 DS    CL11
         ORG   @NM00006
SVC100SG DC    XL4'000B000A'
SVC100TX DC    CL7'SVC100 '
         ORG   @NM00006+11
         DS    CL1
@NM00007 DS    CL11
         ORG   @NM00007
PTGTSEG  DC    XL4'000B000A'
PTGTTXT  DC    CL7'PUTGET '
         ORG   @NM00007+11
         DS    CL1
@NM00008 DS    CL9
         ORG   @NM00008
DAIRSEG  DC    XL4'0009000A'
DAIRTXT  DC    CL5'DAIR '
         ORG   @NM00008+9
         DS    CL3
@NM00009 DS    CL9
         ORG   @NM00009
STAESEG  DC    XL4'0009000A'
STAETXT  DC    CL5'STAE '
         ORG   @NM00009+9
         DS    CL3
@NM00010 DS    CL17
         ORG   @NM00010
CMDSCNSG DC    XL4'0011000A'
CMDSCNTX DC    CL13'COMMAND SCAN '
         ORG   @NM00010+17
         DS    CL3
@NM00011 DS    CL9
         ORG   @NM00011
STAISEG  DC    XL4'0009000A'
STAITXT  DC    CL5'STAI '
         ORG   @NM00011+9
         DS    CL3
@NM00012 DS    CL18
         ORG   @NM00012
MSG0042  DC    XL4'0012000A'
MSG42TXT DC    CL14'ERROR CODE IS '
         ORG   @NM00012+18
LASTLVL  DC    X'FF000000'
ONE      DC    X'00000001'
MCSFLG   DC    X'A000'
ATTNMSG  DS    CL4
         ORG   ATTNMSG
ATTNLEN  DC    H'12'
ATTNOFF  DC    H'0'
         ORG   ATTNMSG+4
CNSLID   DC    CL8'IKJ000I '
BLANK    DC    CL1' '
FLGNOCHK DC    X'80'
ENDCMD   DC    CL3'END'
HELPCMD  DC    CL4'HELP'
COMMA    DC    CL1','
PLUSSIGN DC    CL1'+'
STOPMN   DC    CL7'STOPMN '
PM       DC    CL3'PM '
DISPLAY  DC    CL8'DISPLAY '
D        DC    CL2'D '
MONITOR  DC    CL8'MONITOR '
MN       DC    CL3'MN '
CANCEL   DC    CL7'CANCEL '
C        DC    CL2'C '
SEND     DC    CL5'SEND '
SE       DC    CL3'SE '
         DS    CL1
SUBPOOL1 DC    X'01000000'
IKJEE100 CSECT
UPPERTAB DC 256AL1(*-UPPERTAB)       GENERATE BASIC TABLE
         ORG  UPPERTAB+C'A'-X'40'    POSITION INST. CTR. TO SMALL A-Z
         DC   (C'Z'-C'A'+1)AL1(*-UPPERTAB+X'40') RAISE LOWER TO UPPER
         ORG  UPPERTAB+256           RESET INSTRUCTION COUNTER
@DATD    DSECT
*                                  /* PATCH AREA FOR THE MODULE      */
PTCHAREA DC CL50'OOOOOOOOOOOOOOPATCH AREA FOR OPERATOROOOOOOOOOOOOO'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEE100 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
         ENTRY ENDRN
         ENTRY IKJEE101
         EXTRN IKJEE150
BUFFAREA EQU   0
CMDBUFFR EQU   0
LNGBUFFR EQU   CMDBUFFR
BFOFFSET EQU   CMDBUFFR+2
CMDDATE  EQU   CMDBUFFR+4
ATTCHLST EQU   0
ATPGNADA EQU   ATTCHLST
ATDEFLAG EQU   ATPGNADA
ATDCBADA EQU   ATTCHLST+4
ATECBADR EQU   ATTCHLST+8
ATECBFLG EQU   ATECBADR
ATGSFLDA EQU   ATTCHLST+12
ATGSFLAG EQU   ATGSFLDA
ATSHFLDA EQU   ATTCHLST+16
ATSHFLAG EQU   ATSHFLDA
ATETXRA  EQU   ATTCHLST+20
ATROLL   EQU   ATETXRA
ATINDS2  EQU   ATROLL
ATINDS   EQU   ATTCHLST+27
ATJSCBAD EQU   ATTCHLST+36
ATSTAIAD EQU   ATTCHLST+40
ATSTAIEX EQU   ATTCHLST+44
ATSTAIF  EQU   ATSTAIEX
ATFLAGS1 EQU   ATTCHLST+52
OPERAND  EQU   0
CVTPTR   EQU   0
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
CPPL     EQU   0
CPPLCBUF EQU   CPPL
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
PSCB     EQU   0
PSCBUSER EQU   PSCB
PSCBATR1 EQU   PSCB+16
ECT      EQU   0
ECTMSGF  EQU   ECT+8
ECTPCMD  EQU   ECT+12
ECTSCMD  EQU   ECT+20
ECTSWS   EQU   ECT+28
ECTNOPD  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
IOPL     EQU   0
IOPLUPT  EQU   IOPL
IOPLECT  EQU   IOPL+4
IOPLECB  EQU   IOPL+8
IOPLIOPB EQU   IOPL+12
PGPB     EQU   0
PGPBIBUF EQU   PGPB+12
PTPB     EQU   0
CSPL     EQU   0
CSPLFLG  EQU   CSPL+12
CSPLOA   EQU   CSPL+16
CSPLCBUF EQU   CSPL+20
CSOA     EQU   0
CSOACNM  EQU   CSOA
CSOALNM  EQU   CSOA+4
CSOAFLG  EQU   CSOA+6
CSOAVNP  EQU   CSOAFLG
CSOANOC  EQU   CSOAFLG
CSOABAD  EQU   CSOAFLG
DAPL     EQU   0
DAPLPSCB EQU   DAPL+12
DAPLDAPB EQU   DAPL+16
DAPB2C   EQU   0
DA2CCD   EQU   DAPB2C
DA2CFLG  EQU   DAPB2C+2
DA2CTCB  EQU   DAPB2C+4
STPB     EQU   0
@NM00039 EQU   STPB
CMDNAME  EQU   0
ATMCT    EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
PSCBPTR  EQU   CPPLPSCB
ECTPTR   EQU   CPPLECT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTRV612 EQU   CVTS01+664
CVTRV611 EQU   CVTS01+660
CVTRV610 EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTRV608 EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTRV519 EQU   CVTS01+92
CVTRV327 EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
STPBMBRN EQU   STPB+16
STPBOTDD EQU   STPB+12
STPBINDD EQU   STPB+8
STPBALSD EQU   STPB+4
@NM00042 EQU   @NM00039+1
SPBFLUSH EQU   @NM00039+1
@NM00041 EQU   @NM00039+1
@NM00040 EQU   @NM00039
DA2CDDN  EQU   DAPB2C+8
DAPLECB  EQU   DAPL+8
DAPLECT  EQU   DAPL+4
DAPLUPT  EQU   DAPL
@NM00038 EQU   CSOA+7
@NM00037 EQU   CSOAFLG
@NM00036 EQU   CSOAFLG
CSOAEXEC EQU   CSOAFLG
CSOAQM   EQU   CSOAFLG
CSOAVWP  EQU   CSOAFLG
CSPLECB  EQU   CSPL+8
CSPLECT  EQU   CSPL+4
CSPLUPT  EQU   CSPL
PTPBFLN  EQU   PTPB+8
PTPBOPUT EQU   PTPB+4
@NM00035 EQU   PTPB
@NM00034 EQU   PGPB
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
@NM00033 EQU   ECTSWS
ECTSMSG  EQU   ECT+9
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
PSCBDEST EQU   PSCB+40
@NM00032 EQU   PSCB+36
@NM00031 EQU   PSCB+32
@NM00030 EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00029 EQU   PSCBATR1
@NM00028 EQU   PSCBATR1
@NM00027 EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
PSCBUSRL EQU   PSCB+7
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00022 EQU   CVTFIX+248
@NM00021 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRSV37 EQU   CVTDMSR
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
ATTNSHLV EQU   ATTCHLST+56
ATTPLNG  EQU   ATTCHLST+54
@NM00020 EQU   ATTCHLST+53
@NM00019 EQU   ATFLAGS1
ATNSHRSP EQU   ATFLAGS1
ATTASKLB EQU   ATTCHLST+48
ATSTAIXT EQU   ATSTAIEX+1
ATPURGE  EQU   ATSTAIF
ATSYNCH  EQU   ATSTAIF
ATESTAI  EQU   ATSTAIF
ATTERM   EQU   ATSTAIF
@NM00018 EQU   ATSTAIF
ATSTAIA  EQU   ATSTAIAD+1
ATTID    EQU   ATSTAIAD
ATJSCBA  EQU   ATJSCBAD+1
ATLSQA   EQU   ATJSCBAD
ATPRGNM  EQU   ATTCHLST+28
ATMODE   EQU   ATINDS
ATJSTCB  EQU   ATINDS
ATSVAREA EQU   ATINDS
ATSZERO  EQU   ATINDS
ATKEY    EQU   ATINDS
ATJPQ    EQU   ATINDS
ATJSCB   EQU   ATINDS
ATDISP   EQU   ATINDS
ATLPMOD  EQU   ATTCHLST+26
ATDPMOD  EQU   ATTCHLST+24
ATETXRB  EQU   ATETXRA+1
ATRLLOUT EQU   ATINDS2
ATRLABLE EQU   ATINDS2
@NM00017 EQU   ATINDS2
ATEXTN   EQU   ATINDS2
ATNFPRSA EQU   ATINDS2
ATNTQE   EQU   ATINDS2
ATSHFLDB EQU   ATSHFLDA+1
ATSHARSP EQU   ATSHFLAG
@NM00016 EQU   ATSHFLAG
ATGSFLDB EQU   ATGSFLDA+1
ATGIVESP EQU   ATGSFLAG
@NM00015 EQU   ATGSFLAG
ATECBADB EQU   ATECBADR+1
ATTSTAI  EQU   ATECBFLG
ATTSKLB  EQU   ATECBFLG
ATLOGON  EQU   ATECBFLG
ATEXTN2  EQU   ATECBFLG
@NM00014 EQU   ATECBFLG
ATDCBADB EQU   ATDCBADA+1
ATHARCHY EQU   ATDCBADA
ATPGNADB EQU   ATPGNADA+1
@NM00013 EQU   ATDEFLAG
ATDENTRY EQU   ATDEFLAG
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00264 EQU   MSGRTN1
@RT00273 EQU   MSGRTN2
@RT00301 EQU   OPERABIL
@RT00303 EQU   MSGRTN3
@RT00313 EQU   HELP
@RT00315 EQU   HELP
@RT00319 EQU   MSGRTN7
@RF00317 EQU   MSGRTN3
@RT00375 EQU   ATTN
@RT00385 EQU   OPERABIL
@RT00387 EQU   MSGRTN3
@RT00389 EQU   MSGRTN5
@RT00531 EQU   ATTN
@RT00621 EQU   @EL00003
@RF00610 EQU   @EL00003
@RF00619 EQU   @EL00003
@RT00655 EQU   ATTN
@RT00732 EQU   ATTN
@PB00006 EQU   @EL00001
@ENDDATA EQU   *
         END   IKJEE100,(C'PLS1814',0701,75350)

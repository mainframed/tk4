         TITLE 'IKJCT434, EXEC EVALUATION ROUTINE                      *
                        '
IKJCT434 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJCT434  75.349'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @10,@01                                             0001
         USING @DATD,@10                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @10,8(,@13)                                         0001
         LR    @13,@10                                             0001
         MVC   @PC00001(16),0(@01)                                 0001
*                                                                  0012
*   /*****************************************************************/
*   /*                                                               */
*   /* START EXECUTABLE CODE, QUE GETMAIN, AND SETUP                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0012
*   IF CLEN<F1 THEN                 /* IF LENGTH TOO SMALL           */
         L     @08,@PC00001+4                                      0012
         LH    @08,CLEN(,@08)                                      0012
         LTR   @08,@08                                             0012
         BP    @RF00012                                            0012
*     ERROR=E840;                   /* SET ERROR CODE                */
         LA    ERROR,840                                           0013
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* GET CORE                      */
         B     @RC00012                                            0014
@RF00012 DS    0H                                                  0015
*       HOWMUCH=F2*(LENGTH(QUE)+LENGTH(VQUE))*(CLEN+F1);/* CALC STG  */
         L     @15,@PC00001+4                                      0015
         LA    HOWMUCH,1                                           0015
         AH    HOWMUCH,CLEN(,@15)                                  0015
         SLA   HOWMUCH,5                                           0015
*       DO;                         /* GETMAIN (EC) LV(HOWMUCH)    0016
*                                      A(QBASE) SP(F1) RTCD(ERROR)   */
*         RESPECIFY                                                0017
*          (GPR01P,                                                0017
*           GPR15F) RESTRICTED;                                    0017
*         I004=I004&&I004;          /* INIT LIST                     */
         XC    I004(10),I004                                       0018
*         I00404='20'X;             /* TYPE                          */
         MVI   I00404,X'20'                                        0019
*         I00401=HOWMUCH;           /* LENGTH                        */
         ST    HOWMUCH,I00401                                      0020
*         I00403=ADDR(QBASE);       /* ADDR OF ADDR LIST             */
         LA    @14,QBASE                                           0021
         STCM  @14,7,I00403                                        0021
*         I00405=F1;                /* SUBPOOL VALUE                 */
         MVI   I00405,X'01'                                        0022
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0023
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0024
*         ERROR=GPR15F;             /* SET RETURN CODE               */
         LR    ERROR,GPR15F                                        0025
*         RESPECIFY                                                0026
*          (GPR01P,                                                0026
*           GPR15F) UNRESTRICTED;                                  0026
*       END;                        /* GETMAIN (EC) LV(HOWMUCH)    0027
*                                      A(QBASE) SP(F1) RTCD(ERROR)   */
*       IF ERROR^=F0 THEN           /* IF A GETMAIN ERROR            */
         LTR   ERROR,ERROR                                         0028
         BZ    @RF00028                                            0028
*         ERROR=E16;                /* SET ERROR CODE                */
         LA    ERROR,16                                            0029
*     END;                          /*                               */
@RF00028 DS    0H                                                  0031
*   IF ERROR^=F0 THEN               /* IF NOT ENOUGH STORAGE         */
@RC00012 LTR   ERROR,ERROR                                         0031
         BNZ   @RT00031                                            0031
*     GO TO NOFREEXT;               /* DO NOT ISSUE FREEMAIN AND EXIT*/
*   SEARCH=SOPER;                   /* INIT SEARCH SO FIRST IS DATA  */
         MVI   SEARCH,X'01'                                        0033
*   SWS=''B;                        /* CLEAR ALL SWITCHES            */
         XC    SWS(2),SWS                                          0034
*   IF TYPE=RELAT THEN              /* CHECK WHICH OPER LIMIT TO USE */
         L     @08,@PC00001+8                                      0035
         CLC   TYPE(4,@08),@CF00058                                0035
         BNE   @RF00035                                            0035
*     DO;                           /* ALLOW A NULL ELEMENT BEFORE   */
*       NULLELEM=YES;               /* EXCLUSIVE OPERATOR            */
         OI    NULLELEM,B'01000000'                                0037
*       X=DIM(OPS);                 /* VALID OPERATORS TO MAXIMUM-   */
         LA    X,28                                                0038
*     END;                          /*                               */
*   ELSE                            /* OTHERWISE SET TO NUMBER OF  0040
*                                      VALID                         */
*     X=ASGNONLY;                   /* ASSIGNMENT OPERATORS          */
         B     @RC00035                                            0040
@RF00035 LA    X,10                                                0040
*   ERROR=F0;                       /* CLEAR COUNTERS AND ERROR IND  */
@RC00035 SLR   ERROR,ERROR                                         0041
*   MAXX=F0;                        /*                               */
         SLR   MAXX,MAXX                                           0042
*   PCTR=F0;                        /*                               */
         SLR   PCTR,PCTR                                           0043
*   N=F1;                           /* SET N TO LOOK AT FIRST        */
         LA    @08,1                                               0044
         ST    @08,N                                               0044
*                                                                  0045
*   /*****************************************************************/
*   /*                                                               */
*   /* QUE BUILDER AND SYNTAX CHECKER                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0045
*   DO I=F1 BY F1 WHILE EXITA=NO&ERROR=F0;/* DO UNTIL DONE OR ERROR  */
         LR    I,@08                                               0045
         B     @DE00045                                            0045
@DL00045 DS    0H                                                  0046
*     CALL SKIPRTN;                 /* SKIP DELIMITERS               */
         BAL   @14,SKIPRTN                                         0046
*     IF N>=CLEN THEN               /* IF AT END OF LINE OR BEYOND   */
         L     @08,@PC00001+4                                      0047
         L     @04,N                                               0047
         CH    @04,CLEN(,@08)                                      0047
         BL    @RF00047                                            0047
*       EXITA=YES;                  /* SET EXIT SWITCH TO TERMINATE
*                                      SCAN                          */
         OI    EXITA,B'01000000'                                   0048
*     IF N<=CLEN THEN               /* IF NOT PAST END OF LINE ,   0049
*                                      CONTINUE                      */
@RF00047 L     @08,@PC00001+4                                      0049
         L     @04,N                                               0049
         CH    @04,CLEN(,@08)                                      0049
         BH    @RF00049                                            0049
*       DO;                         /*                               */
*         MAXX=I;                   /* SAVE CURRENT COUNT OF ELEMENTS*/
         LR    MAXX,I                                              0051
*         SEARCH=SEARCH&&FLIP;      /* FLIP SEARCH ARGUMENT          */
         XI    SEARCH,X'01'                                        0052
*         MATCH=NO;                 /* RESET MATCH SWITCH            */
         NI    MATCH,B'11111101'                                   0053
*         NULLREQ=NO;               /* RESET NULL REQUIRED SWITCH    */
         NI    NULLREQ,B'11011111'                                 0054
*         QFLGS(I)=QFLGS(I)&&QFLGS(I);/* CLEAR FLAGS ON QUE ELEMENT  */
         LR    @08,I                                               0055
         SLA   @08,3                                               0055
         L     @04,QBASE                                           0055
         ALR   @04,@08                                             0055
         BCTR  @04,0                                               0055
         XC    QFLGS-7(1,@04),QFLGS-7(@04)                         0055
*         DO K=F1 TO X WHILE MATCH=NO&NULLREQ=NO&/* DO UNTIL @ZM30968*/
*               ERROR=F0;           /* OP FOUND OR IS NO OPER        */
         LA    K,1                                                 0056
         B     @DE00056                                            0056
@DL00056 TM    MATCH,B'00000010'                                   0056
         BNZ   @DC00056                                            0056
         TM    NULLREQ,B'00100000'                                 0056
         BNZ   @DC00056                                            0056
         LTR   ERROR,ERROR                                         0056
         BNZ   @DC00056                                            0056
*           IF OPS(K,1:OPLEN(K))=C(N:N+OPLEN(K)-F1)&/* VALID OP OR   */
*               (PCONCAT=NO×(K^=RPAREN&K^=LPAREN)) THEN/* NOT PSTRNG */
         LR    @08,K                                               0057
         SLA   @08,4                                               0057
         L     @15,@PC00001                                        0057
         LH    @14,OPLEN-16(@08)                                   0057
         BCTR  @14,0                                               0057
         LA    @01,OPS-16(@08)                                     0057
         AL    @15,N                                               0057
         BCTR  @15,0                                               0057
         EX    @14,@SC00376                                        0057
         BNE   @RF00057                                            0057
         TM    PCONCAT,B'00010000'                                 0057
         BZ    @RT00057                                            0057
         C     K,@CF00091                                          0057
         BE    @RF00057                                            0057
         C     K,@CF00067                                          0057
         BE    @RF00057                                            0057
@RT00057 DS    0H                                                  0058
*             DO;                   /* IS FOUND, PERFORM OPERATOR  0058
*                                      SYNTAX CHECK                  */
*               IF SEARCH=SDATA&K^=LPAREN&(K^=RPAREN×/* IF PREFIX    */
*                   NULLELEM=YES)&K^=PLUS&K^=MINUS THEN/*            */
         CLI   SEARCH,X'00'                                        0059
         BNE   @RF00059                                            0059
         C     K,@CF00067                                          0059
         BE    @RF00059                                            0059
         C     K,@CF00091                                          0059
         BNE   @GL00007                                            0059
         TM    NULLELEM,B'01000000'                                0059
         BNO   @RF00059                                            0059
@GL00007 C     K,@CF00082                                          0059
         BE    @RF00059                                            0059
         C     K,@CF00058                                          0059
         BE    @RF00059                                            0059
*                 IF NULLELEM=YES THEN/* IF NULL ELEMENT ALLOWED     */
         TM    NULLELEM,B'01000000'                                0060
         BNO   @RF00060                                            0060
*                   DO;             /* THEN BUILD IT                 */
*                     NULLELEM=NO;  /* NO MORE NULLELEMS ALL         */
         NI    NULLELEM,B'10111111'                                0062
*                     EXITA=NO;     /* RESCAN OPER IF NECESSARY      */
         NI    EXITA,B'10111111'                                   0063
*                     NULLREQ=YES;  /* FORCE NULL ELEMENT            */
         OI    NULLREQ,B'00100000'                                 0064
*                   END;            /*                               */
*                 ELSE              /* IF NO NULLELEMENT ALLOWED     */
*                   ERROR=E804;     /* SET INVALID PREFEX RETURN CODE*/
         B     @RC00060                                            0066
@RF00060 LA    ERROR,804                                           0066
*                                                                  0067
*               /*****************************************************/
*               /*                                                   */
*               /* PARENTHESIS CHECK                                 */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0067
*               ELSE                /* IF NOT A PREFEX OPERATOR      */
*                 DO;               /* CHECK TO SEE IF OPERATOR IS   */
         B     @RC00059                                            0067
@RF00059 DS    0H                                                  0068
*                   IF K=RPAREN×K=LPAREN THEN/* IF A PAREN, CHECK TO
*                                      SEE                           */
         C     K,@CF00091                                          0068
         BE    @RT00068                                            0068
         C     K,@CF00067                                          0068
         BNE   @RF00068                                            0068
@RT00068 DS    0H                                                  0069
*                     DO;           /* IF ONE IS VALID AT THIS TIME  */
*                       IF K=LPAREN THEN/* IF AN OPEN PAREN          */
         C     K,@CF00067                                          0070
         BNE   @RF00070                                            0070
*                         DO;       /* AND WE NEED AN OPERATOR, THEN */
*                           IF SEARCH=SOPER THEN/* SET THE ERROR CODE*/
         CLI   SEARCH,X'01'                                        0072
         BNE   @RF00072                                            0072
*                             PCTR=-F1;/* CAUSE RESCAN OF BFR        */
         SLR   PCTR,PCTR                                           0073
         BCTR  PCTR,0                                              0073
*                           ELSE    /* OTHERWISE IT IS VALID         */
*                             DO;   /*                               */
         B     @RC00072                                            0074
@RF00072 DS    0H                                                  0075
*                               PCTR=PCTR+F1;/* INCREMENT PAREN COUNT*/
         AL    PCTR,@CF00082                                       0075
*                               SEARCH=SEARCH&&FLIP;/* FLIP SEARCH 0076
*                                      ARG                           */
         XI    SEARCH,X'01'                                        0076
*                             END;  /*                               */
*                         END;      /*                               */
*                       ELSE        /*                               */
*                         DO;       /* IF IT IS A RIGHT PAREN AND  0079
*                                      SEARCH IS                     */
         B     @RC00070                                            0079
@RF00070 DS    0H                                                  0080
*                           IF SEARCH=SDATA THEN/* FOR DATA THEN SET */
         CLI   SEARCH,X'00'                                        0080
         BNE   @RF00080                                            0080
*                             PCTR=-F1;/* CAUSE RESCAN OF BFR        */
         SLR   PCTR,PCTR                                           0081
         BCTR  PCTR,0                                              0081
*                           ELSE    /* OTHERWISE IT IS VALID         */
*                             DO;   /*                               */
         B     @RC00080                                            0082
@RF00080 DS    0H                                                  0083
*                               PCTR=PCTR-F1;/* DECREMENT PAREN    0083
*                                      COUNTER                       */
         BCTR  PCTR,0                                              0083
*                               SEARCH=SEARCH&&FLIP;/* FLIP SEARCH 0084
*                                      ARG                           */
         XI    SEARCH,X'01'                                        0084
*                             END;  /*                               */
*                         END;      /*                               */
@RC00080 DS    0H                                                  0087
*                     END;          /*                               */
@RC00070 DS    0H                                                  0088
*                   IF PCTR<F0 THEN /* IF A PAREN ERROR , USE AS DATA*/
@RF00068 LTR   PCTR,PCTR                                           0088
         BNM   @RF00088                                            0088
*                     DO;           /* AND RESET SCAN TO BEGIN       */
*                       I=F0;       /* START AT FIRST ELEMENT        */
         SLR   I,I                                                 0090
*                       PCTR=F0;    /* RESET PCTR TO ZERO            */
         SLR   PCTR,PCTR                                           0091
*                       MAXX=F0;    /* RESET MAXX                    */
         SLR   MAXX,MAXX                                           0092
*                       IF TYPE=RELAT THEN/* RESET NULLELEM          */
         L     @08,@PC00001+8                                      0093
         CLC   TYPE(4,@08),@CF00058                                0093
         BNE   @RF00093                                            0093
*                         NULLELEM=YES;/* TURN IT ON                 */
         OI    NULLELEM,B'01000000'                                0094
*                       ELSE        /* OTHERWISE                     */
*                         NULLELEM=NO;/* TURN IT OFF                 */
         B     @RC00093                                            0095
@RF00093 NI    NULLELEM,B'10111111'                                0095
*                       OPFND=NO;   /* RESET OPFOUND                 */
@RC00093 DS    0H                                                  0097
*                       PCONCAT=YES;/* PAREN AS DATA SWITCH          */
         OI    PCONCAT,B'00010000'                                 0097
         NI    OPFND,B'01111111'                                   0097
*                       SEARCH=SOPER;/* INIT SCAN TYPE               */
         MVI   SEARCH,X'01'                                        0098
*                       N=F1;       /* START AT FIRST CHAR           */
         MVC   N(4),@CF00082                                       0099
*                       MATCH=YES;  /* SKIP FOLLOWING SECTIONS       */
         OI    MATCH,B'00000010'                                   0100
*                     END;          /*                               */
*                   ELSE            /* OTHERWISE BUILD OPER ELEMENT  */
*                     DO;           /*                               */
*                                                                  0102
         B     @RC00088                                            0102
@RF00088 DS    0H                                                  0103
*                       /*********************************************/
*                       /*                                           */
*                       /* BUILD OPERATOR ELEMENT                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0103
*                       QFLGS(I)=OPFLG(K);/* COPY FLAGS FROM TABLE   */
         L     @08,QBASE                                           0103
         LR    @15,I                                               0103
         SLA   @15,3                                               0103
         ST    @15,@TF00001                                        0103
         ALR   @15,@08                                             0103
         BCTR  @15,0                                               0103
         LR    @14,K                                               0103
         SLA   @14,4                                               0103
         LA    @01,OPFLG-16(@14)                                   0103
         MVC   QFLGS-7(1,@15),0(@01)                               0103
*                       QSTREN(I)=OPSTR(K);/* FILL IN THE STRENGTH OF
*                                      THE OP                        */
         LH    @15,OPSTR-16(@14)                                   0104
         L     @01,@TF00001                                        0104
         BCTR  @01,0                                               0104
         BCTR  @01,0                                               0104
         STC   @15,QSTREN-6(@01,@08)                               0104
*                       QLEN(I)=OPLEN(K);/* FILL IN THE LENGTH OF THE
*                                      OPER                          */
         LH    @15,OPLEN-16(@14)                                   0105
         L     @14,@TF00001                                        0105
         AL    @14,@CF00381                                        0105
         STH   @15,QLEN-4(@14,@08)                                 0105
*                       MATCH=YES;  /* SET THE FACT THAT WE HAVE AN
*                                      OP                            */
         OI    MATCH,B'00000010'                                   0106
*                       QVAL(I)=K;  /* SET THE OPCODE INDEX INTO QUE */
         L     @01,@TF00001                                        0107
         AL    @08,@CF00382                                        0107
         ST    K,QVAL(@01,@08)                                     0107
*                       N=N+OPLEN(K);/* UPDATE N TO POINT PAST     0108
*                                      OPERATOR                      */
         AL    @15,N                                               0108
         ST    @15,N                                               0108
*                       IF SEARCH=SDATA&(K=PLUS×K=MINUS) THEN/*      */
         CLI   SEARCH,X'00'                                        0109
         BNE   @RF00109                                            0109
         C     K,@CF00082                                          0109
         BE    @RT00109                                            0109
         C     K,@CF00058                                          0109
         BNE   @RF00109                                            0109
@RT00109 DS    0H                                                  0110
*                         DO;       /* MAKE OPERATOR A PREFIX OPER   */
*                           QPREFX(I)=YES;/* SET THE PREFIX BIT      */
         L     @08,QBASE                                           0111
         LR    @15,I                                               0111
         SLA   @15,3                                               0111
         ST    @15,@TF00001                                        0111
         ALR   @15,@08                                             0111
         BCTR  @15,0                                               0111
         OI    QPREFX-7(@15),B'00010000'                           0111
*                           QSTREN(I)=F4+F2;/* SET THE STRENGTH      */
         LA    @15,6                                               0112
         L     @14,@TF00001                                        0112
         BCTR  @14,0                                               0112
         BCTR  @14,0                                               0112
         STC   @15,QSTREN-6(@14,@08)                               0112
*                           SEARCH=SEARCH&&FLIP;/* CONTINUE SCAN FOR */
         XI    SEARCH,X'01'                                        0113
*                           IF I>F1&QPREFX(I-F1)=YES THEN/* 2 PREFXS */
         LA    @15,1                                               0114
         CR    I,@15                                               0114
         BNH   @RF00114                                            0114
         LR    @01,@08                                             0114
         AL    @01,@TF00001                                        0114
         AL    @01,@CF00384                                        0114
         TM    QPREFX-7(@01),B'00010000'                           0114
         BNO   @RF00114                                            0114
*                             DO;   /* MAKE ONLY ONE PREFIX OUT OF 2 */
*                               I=I-F1;/* DECREMENT I TO REUSE ELEMT */
         BCTR  I,0                                                 0116
*                               IF QVAL(I)=K THEN/* IF THE SAME      */
         LR    @14,I                                               0117
         SLA   @14,3                                               0117
         LA    @01,0(@14,@08)                                      0117
         AL    @01,@CF00382                                        0117
         C     K,QVAL(,@01)                                        0117
         BNE   @RF00117                                            0117
*                                 QVAL(I)=PLUS;/* ASSIGN PLUS        */
         AL    @08,@CF00382                                        0118
         ST    @15,QVAL(@14,@08)                                   0118
*                               ELSE/* OTHERWISE DOUBLE PREFX IS     */
*                                 QVAL(I)=MINUS;/* MINUS             */
         B     @RC00117                                            0119
@RF00117 LR    @08,I                                               0119
         SLA   @08,3                                               0119
         LA    @15,2                                               0119
         L     @14,QBASE                                           0119
         AL    @14,@CF00382                                        0119
         ST    @15,QVAL(@08,@14)                                   0119
*                             END;  /*                               */
@RC00117 DS    0H                                                  0121
*                         END;      /* DATA                          */
@RF00114 DS    0H                                                  0122
*                                                                  0122
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK FOR MULTIPLE EXCLUSIVE OPERATORS    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0122
*                       IF TYPE=NUMBR THEN/* IF NUMBER ENTRY         */
@RF00109 L     @08,@PC00001+8                                      0122
         L     @08,TYPE(,@08)                                      0122
         LTR   @08,@08                                             0122
         BNZ   @RF00122                                            0122
*                         DO;       /* MAKE SURE EXCLUSIVE OPER IS 0123
*                                      1ST                           */
*                           IF OPFND=NO&QEXCLU(I)=NO THEN/* IF NO  0124
*                                      GOOD                          */
         TM    OPFND,B'10000000'                                   0124
         BNZ   @RF00124                                            0124
         LR    @08,I                                               0124
         SLA   @08,3                                               0124
         L     @01,QBASE                                           0124
         ALR   @01,@08                                             0124
         BCTR  @01,0                                               0124
         TM    QEXCLU-7(@01),B'00001000'                           0124
         BNZ   @RF00124                                            0124
*                             ERROR=E820;/* SET ERROR CODE           */
         LA    ERROR,820                                           0125
*                           ELSE    /* IF OK SO FAR , CHECK TO SEE   */
*                             IF QEXCLU(I)=YES THEN/* IF ONE ALREADY
*                                      FOUND                         */
         B     @RC00124                                            0126
@RF00124 LR    @08,I                                               0126
         SLA   @08,3                                               0126
         L     @01,QBASE                                           0126
         ALR   @01,@08                                             0126
         BCTR  @01,0                                               0126
         TM    QEXCLU-7(@01),B'00001000'                           0126
         BNO   @RF00126                                            0126
*                               IF OPFND=YES THEN/* IF SO THEN SYNTAX
*                                      ERROR                         */
         TM    OPFND,B'10000000'                                   0127
         BNO   @RF00127                                            0127
*                                 ERROR=E824;/* SET ERROR CODE       */
         LA    ERROR,824                                           0128
*                               ELSE/* OTHERWISE SET THAT WE HAVE ONE*/
*                                 DO;/*                              */
         B     @RC00127                                            0129
@RF00127 DS    0H                                                  0130
*                                   OPFND=YES;/* SET SWITCH          */
*                                   NULLELEM=YES;/* ALLOW NULL     0131
*                                      ELEMENTS                      */
         OI    OPFND,B'11000000'                                   0131
*                                 END;/*                             */
*                         END;      /*                               */
*                       ELSE        /* IF RELATIONAL ENTRY           */
*                         IF QEXCLU(I)=YES THEN/* AND OPER IS      0134
*                                      EXCLUSIVE                     */
         B     @RC00122                                            0134
@RF00122 LR    @08,I                                               0134
         SLA   @08,3                                               0134
         L     @01,QBASE                                           0134
         ALR   @01,@08                                             0134
         BCTR  @01,0                                               0134
         TM    QEXCLU-7(@01),B'00001000'                           0134
         BNO   @RF00134                                            0134
*                           IF OPFND=YES THEN/* AND WE ALREADY HAVE
*                                      ONE                           */
         TM    OPFND,B'10000000'                                   0135
         BNO   @RF00135                                            0135
*                             ERROR=E828;/* SET ERROR CODE           */
         LA    ERROR,828                                           0136
*                           ELSE    /* IF FIRST ONE, SET SWITCH TO   */
*                             DO;   /*                               */
         B     @RC00135                                            0137
@RF00135 DS    0H                                                  0138
*                               OPFND=YES;/* INDICATE SO             */
*                               NULLELEM=YES;/*                      */
         OI    OPFND,B'11000000'                                   0139
*                             END;  /*                               */
*                         ELSE      /* OTHERWISE CHECK FOR AND/OR    */
*                           IF QCOMB(I)=YES THEN/* IF AND/OR         */
         B     @RC00134                                            0141
@RF00134 LR    @08,I                                               0141
         SLA   @08,3                                               0141
         L     @01,QBASE                                           0141
         ALR   @01,@08                                             0141
         BCTR  @01,0                                               0141
         TM    QCOMB-7(@01),B'00000001'                            0141
         BNO   @RF00141                                            0141
*                             IF OPFND=YES THEN/* OK HERE            */
         TM    OPFND,B'10000000'                                   0142
         BNO   @RF00142                                            0142
*                               DO; /* PROCESS                       */
*                                 OPFND=NO;/* RESET OPFND            */
*                                 NULLELEM=YES;/* RESET NULL         */
         OI    NULLELEM,B'01000000'                                0145
         NI    OPFND,B'01111111'                                   0145
*                               END;/*                               */
*                             ELSE  /* OTHERWISE                     */
*                               ERROR=E808;/* AND/OR NOT ALLOWED     */
         B     @RC00142                                            0147
@RF00142 LA    ERROR,808                                           0147
*                     END;          /*                               */
@RC00142 DS    0H                                                  0148
@RF00141 DS    0H                                                  0148
@RC00134 DS    0H                                                  0148
@RC00122 DS    0H                                                  0149
*                 END;              /*                               */
@RC00088 DS    0H                                                  0150
*             END;                  /*                               */
@RC00059 DS    0H                                                  0151
*         END;                      /*                               */
@RF00057 AL    K,@CF00082                                          0151
@DE00056 CR    K,X                                                 0151
         BNH   @DL00056                                            0151
@DC00056 DS    0H                                                  0152
*         IF SEARCH=SOPER&MATCH=NO&ERROR=F0 THEN/* DOUBLE DATA ?     */
         CLI   SEARCH,X'01'                                        0152
         BNE   @RF00152                                            0152
         TM    MATCH,B'00000010'                                   0152
         BNZ   @RF00152                                            0152
         LTR   ERROR,ERROR                                         0152
         BNZ   @RF00152                                            0152
*           DO;                     /* IF SO AND TYPE IS RELAT OR  0153
*                                      OPER FOUND                    */
*             IF TYPE=RELAT×OPFND=YES THEN/*                         */
         L     @08,@PC00001+8                                      0154
         CLC   TYPE(4,@08),@CF00058                                0154
         BE    @RT00154                                            0154
         TM    OPFND,B'10000000'                                   0154
         BNO   @RF00154                                            0154
@RT00154 DS    0H                                                  0155
*               DO;                 /* RESET SEARCH AND SET CONCAT 0155
*                                      SWITCH                        */
*                 SEARCH=SEARCH&&FLIP;/*                             */
         XI    SEARCH,X'01'                                        0156
*                 CONCAT=YES;       /*                               */
         OI    CONCAT,B'00000001'                                  0157
*               END;                /*                               */
*             ELSE                  /* OTHERWISE DOUBLE DATA NOT   0159
*                                      VALID                         */
*               ERROR=E800;         /* SET ERROR CODE                */
         B     @RC00154                                            0159
@RF00154 LA    ERROR,800                                           0159
*           END;                    /*                               */
*                                                                  0160
@RC00154 DS    0H                                                  0161
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS DATA ELEMENT                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0161
*         IF MATCH=NO THEN          /* IF CURRENT VARIABLE NOT AN  0161
*                                      OPERATOR                      */
@RF00152 TM    MATCH,B'00000010'                                   0161
         BNZ   @RF00161                                            0161
*           DO;                     /* PROCESS DATA ELEMENT          */
*             CALL SKIPRTN;         /* SKIP DELIMITERS               */
         BAL   @14,SKIPRTN                                         0163
*             EXITB=NO;             /* INIT EXIT SWITCH              */
         NI    EXITB,B'11101111'                                   0164
*             NSAVE=N;              /* SAVE CURRENT INDEX            */
         L     @04,N                                               0165
         LR    NSAVE,@04                                           0165
*             QPTR(I)=ADDR(C(N));   /* POINT TO BEGINNING OF DATA    */
         LR    @15,I                                               0166
         SLA   @15,3                                               0166
         L     @14,@PC00001                                        0166
         BCTR  @14,0                                               0166
         LA    @04,C(@04,@14)                                      0166
         L     @01,QBASE                                           0166
         AL    @01,@CF00382                                        0166
         ST    @04,QPTR(@15,@01)                                   0166
*             DO N=N BY 1 WHILE EXITB=NO;/* DO UNTIL END OR DELIM    */
         B     @DE00167                                            0167
@DL00167 DS    0H                                                  0168
*               DO K=1 TO X WHILE EXITB=NO;/* FIND A DELIMETER       */
         LA    K,1                                                 0168
         B     @DE00168                                            0168
@DL00168 TM    EXITB,B'00010000'                                   0168
         BNZ   @DC00168                                            0168
*                 IF N>CLEN×        /* IF PAST END OF BUFFER OR      */
*                     NULLREQ=YES×  /* IF A NULL ELEMENT IS REQUIRED */
*                     ((CONCAT=NO×N-NSAVE^=F0)&/* CONCAT OR NON ZERO */
*                     (PCONCAT=NO×  /* NOT IN PAREN SKIP             */
*                     (K^=RPAREN&K^=LPAREN))&/* OR NOT PARENS        */
*                     ENDDLM(K)=C(N)) THEN/* A DELIMETER             */
         L     @15,N                                               0169
         L     @14,@PC00001+4                                      0169
         CH    @15,CLEN(,@14)                                      0169
         BH    @RT00169                                            0169
         TM    NULLREQ,B'00100000'                                 0169
         BO    @RT00169                                            0169
         TM    CONCAT,B'00000001'                                  0169
         BZ    @GL00022                                            0169
         SLR   @15,NSAVE                                           0169
         LTR   @15,@15                                             0169
         BZ    @RF00169                                            0169
@GL00022 TM    PCONCAT,B'00010000'                                 0169
         BZ    @GL00021                                            0169
         C     K,@CF00091                                          0169
         BE    @RF00169                                            0169
         C     K,@CF00067                                          0169
         BE    @RF00169                                            0169
@GL00021 L     @15,@PC00001                                        0169
         LA    @01,ENDDLM-1(K)                                     0169
         AL    @15,N                                               0169
         BCTR  @15,0                                               0169
         CLC   0(1,@01),C(@15)                                     0169
         BNE   @RF00169                                            0169
@RT00169 DS    0H                                                  0170
*                   DO;             /* SET THE LENGTH OF DATA        */
*                     NSAVE=N-NSAVE;/*                               */
         L     @15,N                                               0171
         SLR   @15,NSAVE                                           0171
         LR    NSAVE,@15                                           0171
*                     EXITB=YES;    /* FALL OUT OF LOOP              */
         OI    EXITB,B'00010000'                                   0172
*                   END;            /*                               */
*               END;                /*                               */
@RF00169 AL    K,@CF00082                                          0174
@DE00168 CR    K,X                                                 0174
         BNH   @DL00168                                            0174
@DC00168 DS    0H                                                  0175
*             END;                  /*                               */
         LA    @04,1                                               0175
         AL    @04,N                                               0175
         ST    @04,N                                               0175
@DE00167 TM    EXITB,B'00010000'                                   0175
         BZ    @DL00167                                            0175
*             N=N-F1;               /* RESET N                       */
         L     @04,N                                               0176
         BCTR  @04,0                                               0176
         ST    @04,N                                               0176
*             QLEN(I)=NSAVE;        /* SET LENGTH OF DATA ITEM       */
         L     @04,QBASE                                           0177
         LR    @15,I                                               0177
         SLA   @15,3                                               0177
         LA    @01,0(@15,@04)                                      0177
         AL    @01,@CF00381                                        0177
         STH   NSAVE,QLEN-4(,@01)                                  0177
*             IF NSAVE=F0 THEN      /* IF A NULL ELEMENT             */
         LTR   NSAVE,NSAVE                                         0178
         BNZ   @RF00178                                            0178
*               QSTREN(I)=F1;       /* FORCE ALPHA                   */
         LA    @08,1                                               0179
         BCTR  @04,0                                               0179
         BCTR  @04,0                                               0179
         STC   @08,QSTREN-6(@15,@04)                               0179
*             ELSE                  /* OTHERWISE                     */
*               QSTREN(I)=F0;       /* INIT TO NUMERIC UNTIL CHECK   */
         B     @RC00178                                            0180
@RF00178 LR    @08,I                                               0180
         SLA   @08,3                                               0180
         SLR   @04,@04                                             0180
         L     @01,QBASE                                           0180
         BCTR  @01,0                                               0180
         BCTR  @01,0                                               0180
         STC   @04,QSTREN-6(@08,@01)                               0180
*                                                                  0181
*             /*******************************************************/
*             /*                                                     */
*             /* PERFORM CONCATENATION                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0181
*             IF CONCAT=YES THEN    /* IF CONCAT REQUIRED THEN       */
@RC00178 TM    CONCAT,B'00000001'                                  0181
         BNO   @RF00181                                            0181
*               DO;                 /*                               */
*                 CONCAT=NO;        /* RESET CONCAT SWITCH           */
         NI    CONCAT,B'11111110'                                  0183
*                 QLEN(I-F1)=QPTR(I)+QLEN(I)-QPTR(I-F1);/* RESET   0184
*                                      LNGTH                         */
         L     @08,QBASE                                           0184
         LR    @04,I                                               0184
         SLA   @04,3                                               0184
         LA    @01,0(@04,@08)                                      0184
         AL    @01,@CF00381                                        0184
         LH    @15,QLEN-4(,@01)                                    0184
         LA    @14,0(@04,@08)                                      0184
         AL    @14,@CF00382                                        0184
         AL    @15,QPTR(,@14)                                      0184
         LA    @14,0(@04,@08)                                      0184
         AL    @14,@CF00388                                        0184
         SL    @15,QPTR(,@14)                                      0184
         AL    @08,@CF00389                                        0184
         STH   @15,QLEN-4(@04,@08)                                 0184
*                 I=I-F1;           /* DECREMENT I TO RE-USE ELEMENT */
         BCTR  I,0                                                 0185
*                 MAXX=MAXX-F1;     /* DECREMENT MAXX                */
         BCTR  MAXX,0                                              0186
*               END;                /*                               */
*             DO K=1 TO QLEN(I);    /* CHECK FOR                     */
@RF00181 LA    K,1                                                 0188
         B     @DE00188                                            0188
@DL00188 DS    0H                                                  0189
*               IF QCHAR(K)<'0'×QCHAR(K)>'9' THEN/* IF ANY CHAR IS   */
         LR    @08,I                                               0189
         SLA   @08,3                                               0189
         L     @01,QBASE                                           0189
         AL    @01,@CF00382                                        0189
         L     @08,QPTR(@08,@01)                                   0189
         LR    @01,@08                                             0189
         ALR   @01,K                                               0189
         BCTR  @01,0                                               0189
         CLI   QCHAR(@01),C'0'                                     0189
         BL    @RT00189                                            0189
         ALR   @08,K                                               0189
         BCTR  @08,0                                               0189
         CLI   QCHAR(@08),C'9'                                     0189
         BNH   @RF00189                                            0189
@RT00189 DS    0H                                                  0190
*                 QSTREN(I)=F1;     /* ALPHA, SET STRENGTH TO ONE    */
         LR    @08,I                                               0190
         SLA   @08,3                                               0190
         LA    @15,1                                               0190
         L     @14,QBASE                                           0190
         BCTR  @14,0                                               0190
         BCTR  @14,0                                               0190
         STC   @15,QSTREN-6(@08,@14)                               0190
*             END;                  /*                               */
@RF00189 AL    K,@CF00082                                          0191
@DE00188 LR    @08,I                                               0191
         SLA   @08,3                                               0191
         L     @01,QBASE                                           0191
         AL    @01,@CF00381                                        0191
         CH    K,QLEN-4(@08,@01)                                   0191
         BNH   @DL00188                                            0191
*           END;                    /*                               */
*       END;                        /*                               */
@RF00161 DS    0H                                                  0194
*   END;                            /*                               */
@RF00049 AL    I,@CF00082                                          0194
@DE00045 TM    EXITA,B'01000000'                                   0194
         BNZ   @DC00045                                            0194
         LTR   ERROR,ERROR                                         0194
         BZ    @DL00045                                            0194
@DC00045 DS    0H                                                  0195
*                                                                  0195
*   /*****************************************************************/
*   /*                                                               */
*   /* MISC SYNTAX CHECKING                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*   IF ERROR=F0 THEN                /* IF NO ERROR SO FAR            */
         SLR   @08,@08                                             0195
         CR    ERROR,@08                                           0195
         BNE   @RF00195                                            0195
*     IF SEARCH=SOPER THEN          /* IF AN OPER ON END OF STMT     */
         CLI   SEARCH,X'01'                                        0196
         BNE   @RF00196                                            0196
*       IF NULLELEM=YES THEN        /* IF NULL ELEMENT IS REQUIRED   */
         TM    NULLELEM,B'01000000'                                0197
         BNO   @RF00197                                            0197
*         DO;                       /* A NULL ELEMENT                */
*           MAXX=MAXX+F1;           /* INCREMENT MAXX                */
         LA    @07,1                                               0199
         ALR   MAXX,@07                                            0199
*           QLEN(MAXX)=F0;          /* ZERO LENGTH                   */
         L     @02,QBASE                                           0200
         LR    @15,MAXX                                            0200
         SLA   @15,3                                               0200
         LA    @01,0(@15,@02)                                      0200
         AL    @01,@CF00381                                        0200
         STH   @08,QLEN-4(,@01)                                    0200
*           QPTR(MAXX)=ADDR(C(1));  /* SET VALID ADDRESS             */
         L     @08,@PC00001                                        0201
         LA    @01,0(@15,@02)                                      0201
         AL    @01,@CF00382                                        0201
         ST    @08,QPTR(,@01)                                      0201
*           QSTREN(MAXX)=F1;        /* SET ALPHA BIT                 */
         LA    @08,0(@15,@02)                                      0202
         BCTR  @08,0                                               0202
         BCTR  @08,0                                               0202
         STC   @07,QSTREN-6(,@08)                                  0202
*           QFLGS(MAXX)=QFLGS(MAXX)&&QFLGS(MAXX);/* ZERO FLAGS       */
         ALR   @02,@15                                             0203
         BCTR  @02,0                                               0203
         XC    QFLGS-7(1,@02),QFLGS-7(@02)                         0203
*         END;                                                     0204
*       ELSE                        /* OTHERWISE                     */
*         ERROR=E816;               /* OTHER ERROR, SET ERROR CODE   */
         B     @RC00197                                            0205
@RF00197 LA    ERROR,816                                           0205
*   IF ERROR=F0 THEN                /* IF STILL OK                   */
@RC00197 DS    0H                                                  0206
@RF00196 DS    0H                                                  0206
@RF00195 LTR   ERROR,ERROR                                         0206
         BNZ   @RF00206                                            0206
*     IF MAXX<3 THEN                /* IF INSUFFICIENT OPERANDS      */
         C     MAXX,@CF00234                                       0207
         BNL   @RF00207                                            0207
*       ERROR=E840;                 /* SET ERROR CODE                */
         LA    ERROR,840                                           0208
*     ELSE                          /*                               */
*       IF OPFND=NO THEN            /* IF NO VALID OPERATORS FOUND   */
         B     @RC00207                                            0209
@RF00207 TM    OPFND,B'10000000'                                   0209
         BNZ   @RF00209                                            0209
*         ERROR=E844;               /* SET ERROR CODE                */
         LA    ERROR,844                                           0210
*   IF ERROR^=F0 THEN               /* IF ERROR UP TO THIS POINT,  0211
*                                      TERMINATE                     */
@RF00209 DS    0H                                                  0211
@RC00207 DS    0H                                                  0211
@RF00206 LTR   ERROR,ERROR                                         0211
         BNZ   @RT00211                                            0211
*     GO TO EXIT;                   /* PROCESSINT AND RETURN         */
*                                                                  0213
*   /*****************************************************************/
*   /*                                                               */
*   /* POLISH SCAN SECTION                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   OUTQDX=F1;                      /* INIT HORIZONTAL QUE INDEX     */
         LA    @08,1                                               0213
         LR    OUTQDX,@08                                          0213
*   VINDX=F0;                       /* INIT VERTICAL QUE INDEX       */
         SLR   VINDX,VINDX                                         0214
*   DO N=1 TO MAXX;                 /* SORT ALL OF QUE               */
         B     @DE00215                                            0215
@DL00215 DS    0H                                                  0216
*     IF QOPER(N)=NO THEN           /* IF CURRENT ELEMENT IS DATA    */
         L     @07,QBASE                                           0216
         LR    @05,@08                                             0216
         SLA   @05,3                                               0216
         ST    @05,@TF00001                                        0216
         ALR   @05,@07                                             0216
         BCTR  @05,0                                               0216
         TM    QOPER-7(@05),B'10000000'                            0216
         BNZ   @RF00216                                            0216
*       DO;                         /* COPY TO OUTPUT HORIZ QUE      */
*                                                                  0217
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS DATA ELEMENT                                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0218
*         OUTQUE(OUTQDX)=QUE(N);    /* COPY ELEMENT                  */
         LR    @15,OUTQDX                                          0218
         SLA   @15,3                                               0218
         ALR   @15,@07                                             0218
         AL    @15,@CF00382                                        0218
         LR    @01,@07                                             0218
         AL    @01,@TF00001                                        0218
         AL    @01,@CF00382                                        0218
         MVC   @TS00001(8),QUE(@01)                                0218
         MVC   OUTQUE(8,@15),@TS00001                              0218
*         OUTQDX=OUTQDX+F1;         /* INCREMENT OUTQUE INDEX        */
         AL    OUTQDX,@CF00082                                     0219
*         I=N;                      /* USE I                         */
         LR    I,@08                                               0220
*         DO X=QLEN(I) TO 1 BY-1;   /* DO YOUR THING                 */
         L     @08,QBASE                                           0221
         LR    @15,I                                               0221
         SLA   @15,3                                               0221
         AL    @08,@CF00381                                        0221
         LH    X,QLEN-4(@15,@08)                                   0221
         B     @DE00221                                            0221
@DL00221 DS    0H                                                  0222
*           TR(QCHAR(X),TRTABUP);   /* FOLD TO NORMAL CHARS          */
         LR    @08,I                                               0222
         SLA   @08,3                                               0222
         L     @01,QBASE                                           0222
         AL    @01,@CF00382                                        0222
         L     @08,QPTR(@08,@01)                                   0222
         ALR   @08,X                                               0222
         BCTR  @08,0                                               0222
         L     @15,@CA00071                                        0222
         TR    QCHAR(1,@08),TRTABUP-TRTABUP(@15)                   0222
*         END;                      /*                               */
         BCTR  X,0                                                 0223
@DE00221 LTR   X,X                                                 0223
         BP    @DL00221                                            0223
*       END;                        /*                               */
*     ELSE                          /* IF CURRENT ELEMENT IS AN    0225
*                                      OPERATOR                      */
*       DO;                         /* SEE IF THE OPERATOR IS A LEFT
*                                      PAREN                         */
         B     @RC00216                                            0225
@RF00216 DS    0H                                                  0226
*         IF QVAL(N)=LPAREN THEN    /* IF IT IS, THEN WE ADD THIS TO
*                                      VERT                          */
         L     @08,QBASE                                           0226
         L     @07,N                                               0226
         SLA   @07,3                                               0226
         LA    @05,0(@07,@08)                                      0226
         AL    @05,@CF00382                                        0226
         L     @05,QVAL(,@05)                                      0226
         C     @05,@CF00067                                        0226
         BNE   @RF00226                                            0226
*           DO;                     /* QUE AND GO GET NEXT ELEMENT   */
*             VINDX=VINDX+F1;       /* INCREMENT VERTICAL INDEX      */
         LA    @05,1                                               0228
         ALR   VINDX,@05                                           0228
*             VQUE(VINDX)=QUE(N);   /* COPY ELEMENT TO VERTICAL QUE  */
         LR    @15,VINDX                                           0229
         SLA   @15,3                                               0229
         L     @14,@PC00001+4                                      0229
         AH    @05,CLEN(,@14)                                      0229
         SLA   @05,4                                               0229
         ALR   @05,@08                                             0229
         ALR   @05,@15                                             0229
         AL    @05,@CF00382                                        0229
         ALR   @08,@07                                             0229
         AL    @08,@CF00382                                        0229
         MVC   VQUE(8,@05),QUE(@08)                                0229
*           END;                    /*                               */
*         ELSE                      /* IF NOT A LEFT PAREN, CHECK IF
*                                      IT IS                         */
*           IF QVAL(N)=RPAREN THEN  /* A RIGHT PAREN. IF IT IS, THEN
*                                      EMPTY                         */
         B     @RC00226                                            0231
@RF00226 L     @08,N                                               0231
         SLA   @08,3                                               0231
         L     @07,QBASE                                           0231
         AL    @07,@CF00382                                        0231
         L     @08,QVAL(@08,@07)                                   0231
         C     @08,@CF00091                                        0231
         BNE   @RF00231                                            0231
*             DO;                   /* VERTICAL QUE DOWN TO LEFT   0232
*                                      PAREN                         */
*               DO WHILE VVAL(VINDX)^=LPAREN;/* DO UNTIL LEFT PAREN  */
         B     @DE00233                                            0233
@DL00233 DS    0H                                                  0234
*                 CALL POPUP;       /* POP OPERATOR OFF VERTICLE QUE */
         BAL   @14,POPUP                                           0234
*               END;                /*                               */
@DE00233 LR    @08,VINDX                                           0235
         SLA   @08,3                                               0235
         L     @07,@PC00001+4                                      0235
         LA    @05,1                                               0235
         AH    @05,CLEN(,@07)                                      0235
         SLA   @05,4                                               0235
         AL    @05,QBASE                                           0235
         AL    @05,@CF00382                                        0235
         L     @08,VVAL(@08,@05)                                   0235
         C     @08,@CF00067                                        0235
         BNE   @DL00233                                            0235
*               VINDX=VINDX-F1;     /* THROUGH AWAY LEFT PAREN AND 0236
*                                      GET NEW                       */
         BCTR  VINDX,0                                             0236
*             END;                  /* ELEMENT                       */
*           ELSE                    /* IF NEITHER PAREN, THEN      0238
*                                      DETERMINE                     */
*                                                                  0238
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS OPERATOR                                    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0238
*             DO;                   /* WHERE TO PUT OPERATOR         */
         B     @RC00231                                            0238
@RF00231 DS    0H                                                  0239
*               PUSH=NO;            /* DO UNTIL OPERATOR IS ON VERT
*                                      QUE                           */
         NI    PUSH,B'11110111'                                    0239
*               DO WHILE PUSH=NO;   /*                               */
         B     @DE00240                                            0240
@DL00240 DS    0H                                                  0241
*                 IF VINDX=F0×VVAL(VINDX)=LPAREN THEN/* IF VERT EMPTY*/
         LTR   VINDX,VINDX                                         0241
         BZ    @RT00241                                            0241
         LR    @08,VINDX                                           0241
         SLA   @08,3                                               0241
         L     @07,@PC00001+4                                      0241
         LA    @05,1                                               0241
         AH    @05,CLEN(,@07)                                      0241
         SLA   @05,4                                               0241
         AL    @05,QBASE                                           0241
         AL    @05,@CF00382                                        0241
         L     @08,VVAL(@08,@05)                                   0241
         C     @08,@CF00067                                        0241
         BNE   @RF00241                                            0241
@RT00241 DS    0H                                                  0242
*                   PUSH=YES;       /* OR LAST VERT LPAREN, PUSH OPER
*                                      NOW                           */
         OI    PUSH,B'00001000'                                    0242
*                 ELSE              /* OR IF NEW STRENGTH > OLD    0243
*                                      STRENGTH PUSH                 */
*                   IF QSTREN(N)>VSTREN(VINDX) THEN/* NOW            */
         B     @RC00241                                            0243
@RF00241 L     @08,QBASE                                           0243
         L     @07,N                                               0243
         SLA   @07,3                                               0243
         LR    @05,VINDX                                           0243
         SLA   @05,3                                               0243
         L     @15,@PC00001+4                                      0243
         LA    @14,1                                               0243
         AH    @14,CLEN(,@15)                                      0243
         SLA   @14,4                                               0243
         ALR   @14,@08                                             0243
         BCTR  @08,0                                               0243
         BCTR  @08,0                                               0243
         SLR   @15,@15                                             0243
         IC    @15,QSTREN-6(@07,@08)                               0243
         BCTR  @14,0                                               0243
         BCTR  @14,0                                               0243
         SLR   @08,@08                                             0243
         IC    @08,VSTREN-6(@05,@14)                               0243
         CR    @15,@08                                             0243
         BNH   @RF00243                                            0243
*                     PUSH=YES;     /*                               */
         OI    PUSH,B'00001000'                                    0244
*                   ELSE            /* IF NONE OF THE ABOVE, POP OPER
*                                      OFF VERT                      */
*                     CALL POPUP;   /* AND TRY TO PUSH AGAIN         */
         B     @RC00243                                            0245
@RF00243 BAL   @14,POPUP                                           0245
*               END;                /*                               */
@RC00243 DS    0H                                                  0246
@RC00241 DS    0H                                                  0246
@DE00240 TM    PUSH,B'00001000'                                    0246
         BZ    @DL00240                                            0246
*               VINDX=VINDX+F1;     /* INCREMENT VERTICAL INDEX      */
         LA    @08,1                                               0247
         ALR   VINDX,@08                                           0247
*               VQUE(VINDX)=QUE(N); /* COPY (PUSH) CURRENT OPER ON 0248
*                                      VERT                          */
         LR    @07,VINDX                                           0248
         SLA   @07,3                                               0248
         L     @05,QBASE                                           0248
         L     @15,@PC00001+4                                      0248
         AH    @08,CLEN(,@15)                                      0248
         SLA   @08,4                                               0248
         ALR   @08,@05                                             0248
         ALR   @08,@07                                             0248
         AL    @08,@CF00382                                        0248
         L     @07,N                                               0248
         SLA   @07,3                                               0248
         ALR   @05,@07                                             0248
         AL    @05,@CF00382                                        0248
         MVC   VQUE(8,@08),QUE(@05)                                0248
*             END;                  /* QUE                           */
*       END;                        /*                               */
@RC00231 DS    0H                                                  0250
@RC00226 DS    0H                                                  0251
*   END;                            /*                               */
@RC00216 LA    @08,1                                               0251
         AL    @08,N                                               0251
@DE00215 ST    @08,N                                               0251
         CR    @08,MAXX                                            0251
         BNH   @DL00215                                            0251
*   DO WHILE VINDX^=F0;             /* IF OPERATORS ARE LEFT ON VERT */
         B     @DE00252                                            0252
@DL00252 DS    0H                                                  0253
*     IF VVAL(VINDX)=LPAREN THEN    /* QUE, THROW AWAY LEFT PARENS   */
         LR    @08,VINDX                                           0253
         SLA   @08,3                                               0253
         L     @07,@PC00001+4                                      0253
         LA    @05,1                                               0253
         AH    @05,CLEN(,@07)                                      0253
         SLA   @05,4                                               0253
         AL    @05,QBASE                                           0253
         AL    @05,@CF00382                                        0253
         L     @08,VVAL(@08,@05)                                   0253
         C     @08,@CF00067                                        0253
         BNE   @RF00253                                            0253
*       VINDX=VINDX-F1;             /*                               */
         BCTR  VINDX,0                                             0254
*     ELSE                          /* OTHERWISE                     */
*       CALL POPUP;                 /* POP OPERATOR OFF VERTICAL QUE */
         B     @RC00253                                            0255
@RF00253 BAL   @14,POPUP                                           0255
*   END;                            /*                               */
@RC00253 DS    0H                                                  0256
@DE00252 LTR   VINDX,VINDX                                         0256
         BNZ   @DL00252                                            0256
*   MAXX=OUTQDX-F1;                 /* SET MAXX TO NUMBER OF ELEMENTS*/
         LR    MAXX,OUTQDX                                         0257
         BCTR  MAXX,0                                              0257
*   QEND(MAXX)=YES;                 /* TURN ON END OF PROCESSING BIT */
         LR    @08,MAXX                                            0258
         SLA   @08,3                                               0258
         L     @07,QBASE                                           0258
         ALR   @07,@08                                             0258
         BCTR  @07,0                                               0258
         OI    QEND-7(@07),B'00000010'                             0258
*   EXITA=NO;                       /* RESET EXITA SWITCH            */
         NI    EXITA,B'10111111'                                   0259
*   OUTPTR=ADDR(OUTAREA);           /* POINT TO OUTAREA FOR UNPK ETC.*/
         L     OUTPTR,@PC00001+12                                  0260
*   DO WHILE EXITA=NO&ERROR=F0;     /* DO UNTIL DONE OR ERROR        */
         B     @DE00261                                            0261
@DL00261 DS    0H                                                  0262
*     OPFND=NO;                     /* RESET OPFND SWITCH            */
*                                                                  0262
         NI    OPFND,B'01111111'                                   0262
*     /***************************************************************/
*     /*                                                             */
*     /* FIND OPERATOR                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0263
*     DO I=1 TO MAXX WHILE OPFND=NO;/* FIND NON PROCESSED OPERATOR   */
         LA    I,1                                                 0263
         B     @DE00263                                            0263
@DL00263 TM    OPFND,B'10000000'                                   0263
         BNZ   @DC00263                                            0263
*       IF QSKIP(I)=NO&QOPER(I)=YES THEN/* IF NON PROCESSED OPERATOR */
         LR    @08,I                                               0264
         SLA   @08,3                                               0264
         L     @07,QBASE                                           0264
         ALR   @07,@08                                             0264
         BCTR  @07,0                                               0264
         TM    QOPER-7(@07),B'10000000'                            0264
         BNO   @RF00264                                            0264
         TM    QSKIP-7(@07),B'00100000'                            0264
         BNZ   @RF00264                                            0264
*         OPFND=YES;                /* SET SWITCH                    */
         OI    OPFND,B'10000000'                                   0265
*     END;                          /*                               */
@RF00264 AL    I,@CF00082                                          0266
@DE00263 CR    I,MAXX                                              0266
         BNH   @DL00263                                            0266
@DC00263 DS    0H                                                  0267
*     K=I-F1;                       /* SAVE INDEX TO OPERATOR        */
         LR    K,I                                                 0267
         BCTR  K,0                                                 0267
*     IF QEND(K)=YES THEN           /* IF LAST OPERATION,SET EXIT    */
         LR    @08,K                                               0268
         SLA   @08,3                                               0268
         L     @07,QBASE                                           0268
         ALR   @07,@08                                             0268
         BCTR  @07,0                                               0268
         TM    QEND-7(@07),B'00000010'                             0268
         BNO   @RF00268                                            0268
*       EXITA=YES;                  /* SWITCH                        */
         OI    EXITA,B'01000000'                                   0269
*     CALL LOAD;                    /* LOAD DATA FOR PROCESSING      */
@RF00268 BAL   @14,LOAD                                            0270
*     IF ERROR=F0 THEN              /* IF LOAD SUCCESSFUL, PROCESS   */
         LTR   ERROR,ERROR                                         0271
         BNZ   @RF00271                                            0271
*       DO;                         /*                               */
*                                                                  0272
*         /***********************************************************/
*         /*                                                         */
*         /* PERFORM FUNCTION                                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0273
*         ANS=FALSE;                /* RESET FALSE SWITCH            */
         NI    ANS,B'11111011'                                     0273
*         CALL ROUTINE;             /* CALL ROUTINE TO PROCESS DATA  */
         LR    @08,K                                               0274
         SLA   @08,3                                               0274
         L     @07,QBASE                                           0274
         AL    @07,@CF00382                                        0274
         L     @08,QVAL(@08,@07)                                   0274
         SLA   @08,4                                               0274
         L     @15,VECTOR-16(@08)                                  0274
         BALR  @14,@15                                             0274
*         IF TYPE=RELAT&(QEXCLU(K)=YES×QCOMB(K)=YES) THEN/* UPDATE   */
         L     @08,@PC00001+8                                      0275
         CLC   TYPE(4,@08),@CF00058                                0275
         BNE   @RF00275                                            0275
         L     @08,QBASE                                           0275
         LR    @07,K                                               0275
         SLA   @07,3                                               0275
         ST    @07,@TF00001                                        0275
         ALR   @07,@08                                             0275
         BCTR  @07,0                                               0275
         TM    QEXCLU-7(@07),B'00001001'                           0275
         BZ    @RF00275                                            0275
*           DO;                     /* PROCESS TRUE/FALSE            */
*             IF QNOT(K)=YES THEN   /* IF 'NOT' IS SPECIFIED, REVERSE*/
         AL    @08,@TF00001                                        0277
         BCTR  @08,0                                               0277
         TM    QNOT-7(@08),B'00000100'                             0277
         BNO   @RF00277                                            0277
*               IF ANS=TRUE THEN    /* IF ANSWER IS TRUE, SET FALSE  */
         TM    ANS,B'00000100'                                     0278
         BNO   @RF00278                                            0278
*                 ANS=FALSE;        /*                               */
         NI    ANS,B'11111011'                                     0279
*               ELSE                /* OTHERWISE MAKE IT TRUE        */
*                 ANS=TRUE;         /*                               */
         B     @RC00278                                            0280
@RF00278 OI    ANS,B'00000100'                                     0280
*             IF ANS=TRUE THEN      /* IF ANS IS TRUE THEN           */
@RC00278 DS    0H                                                  0281
@RF00277 TM    ANS,B'00000100'                                     0281
         BNO   @RF00281                                            0281
*               QVAL(K)=F0;         /* SAVE A TRUE ANSWER            */
         LR    @08,K                                               0282
         SLA   @08,3                                               0282
         SLR   @07,@07                                             0282
         L     @05,QBASE                                           0282
         AL    @05,@CF00382                                        0282
         ST    @07,QVAL(@08,@05)                                   0282
*             ELSE                  /* OTHERWISE                     */
*               QVAL(K)=F4;         /* STORE A FALSE ANSWER          */
         B     @RC00281                                            0283
@RF00281 LR    @08,K                                               0283
         SLA   @08,3                                               0283
         LA    @07,4                                               0283
         L     @05,QBASE                                           0283
         AL    @05,@CF00382                                        0283
         ST    @07,QVAL(@08,@05)                                   0283
*             QSTREN(K)=F2;         /* CHANGE STRENGTH               */
@RC00281 L     @08,QBASE                                           0284
         LR    @07,K                                               0284
         SLA   @07,3                                               0284
         LA    @05,2                                               0284
         LA    @01,0(@07,@08)                                      0284
         BCTR  @01,0                                               0284
         BCTR  @01,0                                               0284
         STC   @05,QSTREN-6(,@01)                                  0284
*             QTEMP(K)=YES;         /* SET TEMP SWITCH               */
         ALR   @08,@07                                             0285
         BCTR  @08,0                                               0285
         OI    QTEMP-7(@08),B'01000000'                            0285
*           END;                                                   0286
*       END;                        /*                               */
@RF00275 DS    0H                                                  0288
*   END;                            /*                               */
@RF00271 DS    0H                                                  0288
@DE00261 TM    EXITA,B'01000000'                                   0288
         BNZ   @DC00261                                            0288
         LTR   ERROR,ERROR                                         0288
         BZ    @DL00261                                            0288
@DC00261 DS    0H                                                  0289
*                                                                  0289
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE CORE USED AND EXIT TO CALLER                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   IF TYPE=RELAT&ERROR=F0 THEN     /* IF RELATIONAL ENTRY, SET    0289
*                                      APPRO-                        */
         L     @08,@PC00001+8                                      0289
         CLC   TYPE(4,@08),@CF00058                                0289
         BNE   @RF00289                                            0289
         LTR   ERROR,ERROR                                         0289
         BNZ   @RF00289                                            0289
*     IF ANS=FALSE THEN             /* RETURN CODE                   */
         TM    ANS,B'00000100'                                     0290
         BNZ   @RF00290                                            0290
*       ERROR=E4;                   /*                               */
         LA    ERROR,4                                             0291
*   TYPE=OUTPTR;                    /* SET OUTPUT ADDR FOR CALLER    */
@RF00290 DS    0H                                                  0292
@RF00289 L     @08,@PC00001+8                                      0292
         ST    OUTPTR,TYPE(,@08)                                   0292
*   IF TOOBIG=YES THEN              /* IF MAX VALUE EXCEEDED @ZA04832*/
         TM    TOOBIG,B'00000100'                                  0293
         BNO   @RF00293                                            0293
*     ERROR=E832;                   /* MAX VAL EXCEEDED CODE @ZA04832*/
         LA    ERROR,832                                           0294
*EXIT:                                                             0295
*   DO;                             /* FREEMAIN (E) LV(HOWMUCH)    0295
*                                      A(QBASE) SP(F1)               */
@RF00293 DS    0H                                                  0295
EXIT     DS    0H                                                  0296
*     RESPECIFY                                                    0296
*      (GPR01P) RESTRICTED;                                        0296
*     I005=I005&&I005;              /* INIT LIST                     */
         XC    I005(10),I005                                       0297
*     I00505='00'X;                 /* SET TYPE                      */
         MVI   I00505,X'00'                                        0298
*     I00502=HOWMUCH;               /* LENGTH                        */
         STCM  HOWMUCH,7,I00502                                    0299
*     I00504=ADDR(QBASE);           /* ADDR OF ADDR LIST             */
         LA    @07,QBASE                                           0300
         STCM  @07,7,I00504                                        0300
*     I00506=F1;                    /* SUBPOOL VALUE                 */
         MVI   I00506,X'01'                                        0301
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I005                                         0302
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0303
*     RESPECIFY                                                    0304
*      (GPR01P) UNRESTRICTED;                                      0304
*   END;                            /* FREEMAIN (E) LV(HOWMUCH)    0305
*                                      A(QBASE) SP(F1) FREE QUES     */
*NOFREEXT:                                                         0306
*   RETURN CODE(ERROR);             /* RETURN TO CALLER WITH ERROR 0306
*                                      CODE                          */
NOFREEXT L     @13,4(,@13)                                         0306
         L     @00,@SIZDATD                                        0306
         LR    @01,@10                                             0306
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@06                                             0306
         L     @14,12(,@13)                                        0306
         LM    @00,@12,20(@13)                                     0306
         BR    @14                                                 0306
*                                                                  0307
*   /*****************************************************************/
*   /*                                                               */
*   /* LOAD ROUTINE                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0307
*LOAD:                                                             0307
*   PROC;                                                          0307
@EL00001 L     @13,4(,@13)                                         0307
@EF00001 L     @00,@SIZDATD                                        0307
         LR    @01,@10                                             0307
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0307
         BR    @14                                                 0307
LOAD     STM   @14,@05,12(@13)                                     0307
         STM   @07,@12,48(@13)                                     0307
*   VINDX=F2;                       /* SET UP VARIABLE COUNTER       */
         LA    VINDX,2                                             0308
*   DO I=K-1 TO 1 BY-1 WHILE VINDX>F0;/* SEARCH BACKWARDS FOR TWO  0309
*                                      DATA                          */
         LR    I,K                                                 0309
         BCTR  I,0                                                 0309
         B     @DE00309                                            0309
@DL00309 LTR   VINDX,VINDX                                         0309
         BNP   @DC00309                                            0309
*     IF QSKIP(I)=NO THEN           /* ELEMENTS THAT ARE ELIGIBLE    */
         L     @07,QBASE                                           0310
         LR    @03,I                                               0310
         SLA   @03,3                                               0310
         ALR   @03,@07                                             0310
         BCTR  @03,0                                               0310
         TM    QSKIP-7(@03),B'00100000'                            0310
         BNZ   @RF00310                                            0310
*       DO;                         /*                               */
*         V(VINDX)=I;               /* SET V1 OR V2 TO CURRENT INDEX */
         LR    @03,VINDX                                           0312
         SLA   @03,2                                               0312
         ST    I,V-4(@03)                                          0312
*         IF QPREFX(K)=YES THEN     /* IF A PREFIX OPERATOR          */
         LR    @03,K                                               0313
         SLA   @03,3                                               0313
         ALR   @07,@03                                             0313
         BCTR  @07,0                                               0313
         TM    QPREFX-7(@07),B'00010000'                           0313
         BNO   @RF00313                                            0313
*           VINDX=F0;               /* USE ONLY ONE DATA ELEMENT     */
         SLR   VINDX,VINDX                                         0314
*         ELSE                      /* OTHERWISE                     */
*           VINDX=VINDX-F1;         /* DECREMENT INDEX               */
         B     @RC00313                                            0315
@RF00313 BCTR  VINDX,0                                             0315
*         QSKIP(I)=YES;             /* CAUSE SKIPPING OF THIS ELEMENT*/
@RC00313 LR    @07,I                                               0316
         SLA   @07,3                                               0316
         L     @03,QBASE                                           0316
         ALR   @03,@07                                             0316
         BCTR  @03,0                                               0316
         OI    QSKIP-7(@03),B'00100000'                            0316
*       END;                        /*                               */
*   END;                            /* V1 AND V2 POINT TO TWO DATA 0318
*                                      ELEMENTS (PREFIX ONLY V2)     */
@RF00310 BCTR  I,0                                                 0318
@DE00309 LTR   I,I                                                 0318
         BP    @DL00309                                            0318
@DC00309 DS    0H                                                  0319
*   IF(QPREFX(K)=NO&(V1^=F1×TYPE=RELAT)&QSTREN(V1)=F1)×/* IF ALPHA   */
*       QSTREN(V2)=F1 THEN          /* IN A DATA ELEMENT             */
         LR    @07,K                                               0319
         SLA   @07,3                                               0319
         L     @05,QBASE                                           0319
         ALR   @05,@07                                             0319
         BCTR  @05,0                                               0319
         TM    QPREFX-7(@05),B'00010000'                           0319
         BNZ   @GL00032                                            0319
         CLC   V1(4),@CF00082                                      0319
         BNE   @GL00033                                            0319
         L     @07,@PC00001+8                                      0319
         CLC   TYPE(4,@07),@CF00058                                0319
         BNE   @GL00032                                            0319
@GL00033 L     @07,V1                                              0319
         SLA   @07,3                                               0319
         L     @05,QBASE                                           0319
         BCTR  @05,0                                               0319
         BCTR  @05,0                                               0319
         SLR   @15,@15                                             0319
         IC    @15,QSTREN-6(@07,@05)                               0319
         C     @15,@CF00082                                        0319
         BE    @RT00319                                            0319
@GL00032 L     @07,V2                                              0319
         SLA   @07,3                                               0319
         L     @05,QBASE                                           0319
         BCTR  @05,0                                               0319
         BCTR  @05,0                                               0319
         SLR   @15,@15                                             0319
         IC    @15,QSTREN-6(@07,@05)                               0319
         C     @15,@CF00082                                        0319
         BNE   @RF00319                                            0319
@RT00319 DS    0H                                                  0320
*     DO;                           /* CAUSE ALPHA MODE TO BE USED   */
*       ALPHA=YES;                  /* SET ALPHA SWITCH              */
         OI    ALPHA,B'10000000'                                   0321
*       IF QTEMP(V2)=YES×(QPREFX(K)=NO&QTEMP(V1)=YES) THEN/* IF    0322
*                                      EITHER DATA ELEMENT HAS A   0322
*                                      TEMPORARY VALUE, ALPHA MODE IS
*                                      IN ERROR                      */
         L     @07,QBASE                                           0322
         L     @05,V2                                              0322
         SLA   @05,3                                               0322
         ALR   @05,@07                                             0322
         BCTR  @05,0                                               0322
         TM    QTEMP-7(@05),B'01000000'                            0322
         BO    @RT00322                                            0322
         LR    @05,K                                               0322
         SLA   @05,3                                               0322
         ALR   @05,@07                                             0322
         BCTR  @05,0                                               0322
         TM    QPREFX-7(@05),B'00010000'                           0322
         BNZ   @RF00322                                            0322
         L     @05,V1                                              0322
         SLA   @05,3                                               0322
         ALR   @07,@05                                             0322
         BCTR  @07,0                                               0322
         TM    QTEMP-7(@07),B'01000000'                            0322
         BNO   @RF00322                                            0322
@RT00322 DS    0H                                                  0323
*         ERROR=E848;               /* SET ERROR CODE                */
         LA    ERROR,848                                           0323
*       ELSE                        /* OTHERWISE                     */
*         IF QPREFX(K)=YES THEN     /* IF A PREFIX OPERATOR          */
         B     @RC00322                                            0324
@RF00322 LR    @07,K                                               0324
         SLA   @07,3                                               0324
         L     @05,QBASE                                           0324
         ALR   @05,@07                                             0324
         BCTR  @05,0                                               0324
         TM    QPREFX-7(@05),B'00010000'                           0324
         BNO   @RF00324                                            0324
*           ERROR=E868;             /* SET THE ERROR CODE            */
         LA    ERROR,868                                           0325
*     END;                          /*                               */
*                                                                  0327
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS NUMERIC                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0327
*   ELSE                            /* IF NUMERIC                    */
*     DO;                           /*                               */
         B     @RC00319                                            0327
@RF00319 DS    0H                                                  0328
*       ALPHA=NO;                   /* SET ALPHA SWITCH              */
         NI    ALPHA,B'01111111'                                   0328
*       DO VINDX=2 TO 1 BY-1;       /* SET UP TO CONVERT CHARACTER   */
         LA    VINDX,2                                             0329
@DL00329 DS    0H                                                  0330
*         I=V(VINDX);               /* TO BINARY FOR ARITHMETIC      */
         LR    @07,VINDX                                           0330
         SLA   @07,2                                               0330
         L     I,V-4(@07)                                          0330
*         IF(QPREFX(K)=YES&VINDX=F1)×(I=F1&TYPE=NUMBR) THEN/*        */
         LR    @07,K                                               0331
         SLA   @07,3                                               0331
         L     @03,QBASE                                           0331
         ALR   @03,@07                                             0331
         BCTR  @03,0                                               0331
         TM    QPREFX-7(@03),B'00010000'                           0331
         BNO   @GL00038                                            0331
         C     VINDX,@CF00082                                      0331
         BE    @RT00331                                            0331
@GL00038 C     I,@CF00082                                          0331
         BNE   @RF00331                                            0331
         L     @07,@PC00001+8                                      0331
         L     @07,TYPE(,@07)                                      0331
         LTR   @07,@07                                             0331
         BNZ   @RF00331                                            0331
@RT00331 DS    0H                                                  0332
*           V(1)=F0;                /* SET RETURN TO ZERO            */
         SLR   @07,@07                                             0332
         ST    @07,V                                               0332
*         ELSE                      /* OTHERWISE LOAD NORMALLY       */
*           DO;                     /*                               */
*                                                                  0333
         B     @RC00331                                            0333
@RF00331 DS    0H                                                  0334
*             /*******************************************************/
*             /*                                                     */
*             /* LOAD VALUES INTO V1 AND V2 - V1 AND V2 HAVE VALUES  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0334
*             IF QTEMP(I)=NO THEN   /* IF NOT A TEMP, MUST PACK      */
         L     @07,QBASE                                           0334
         LR    @03,I                                               0334
         SLA   @03,3                                               0334
         ST    @03,@TF00001                                        0334
         ALR   @03,@07                                             0334
         BCTR  @03,0                                               0334
         TM    QTEMP-7(@03),B'01000000'                            0334
         BNZ   @RF00334                                            0334
*               IF QLEN(I)>LENGTH(MAXVAL)×(QLEN(I)=LENGTH(MAXVAL)&/* */
*                   QCHAR(1:LENGTH(MAXVAL))>MAXVAL) THEN/* TOO BIG   */
         LA    @03,10                                              0335
         L     @01,@TF00001                                        0335
         AL    @01,@CF00381                                        0335
         LH    @15,QLEN-4(@01,@07)                                 0335
         CR    @15,@03                                             0335
         BH    @RT00335                                            0335
         CR    @15,@03                                             0335
         BNE   @RF00335                                            0335
         L     @03,@TF00001                                        0335
         AL    @07,@CF00382                                        0335
         L     @07,QPTR(@03,@07)                                   0335
         CLC   QCHAR(10,@07),@CC00118                              0335
         BNH   @RF00335                                            0335
@RT00335 DS    0H                                                  0336
*                 ERROR=E872;       /* IF NUMBER WILL CAUSE CVB TO 0336
*                                      0C9                           */
         LA    ERROR,872                                           0336
*               ELSE                /* SET ERROR CODE                */
*                 DO;               /*                               */
         B     @RC00335                                            0337
@RF00335 DS    0H                                                  0338
*                   OUTAREA=ZERO;   /* ZERO ALL OF PACKAREA          */
         L     @07,@PC00001+12                                     0338
         MVC   OUTAREA(17,@07),@CC00114                            0338
*                   OUTAREA(17-QLEN(I):16)=QCHAR(1:QLEN(I));/* RIGHT
*                                      JUSTIFY                       */
         L     @03,QBASE                                           0339
         LR    @15,I                                               0339
         SLA   @15,3                                               0339
         LA    @14,17                                              0339
         LA    @01,0(@15,@03)                                      0339
         AL    @01,@CF00381                                        0339
         SH    @14,QLEN-4(,@01)                                    0339
         ST    @14,@TF00001                                        0339
         ALR   @14,@07                                             0339
         BCTR  @14,0                                               0339
         LA    @09,16                                              0339
         SL    @09,@TF00001                                        0339
         AL    @03,@CF00382                                        0339
         L     @03,QPTR(@15,@03)                                   0339
         EX    @09,@SM00396                                        0339
*                   PACK(WORKAREA,OUTAREA(1:16));/* NUMBER TO BE   0340
*                                      PACKED                        */
         PACK  WORKAREA(8),OUTAREA(16,@07)                         0340
*                   CVB(V(VINDX),WORKAREA);/* CONVERT NUMBER TO    0341
*                                      BINARY                        */
         CVB   @07,WORKAREA                                        0341
         LR    @03,VINDX                                           0341
         SLA   @03,2                                               0341
         ST    @07,V-4(@03)                                        0341
*                 END;              /* END PACK LOGIC                */
*             ELSE                  /* IF NUMBER IS STORED BINARILY  */
*               V(VINDX)=QVAL(I);   /* JUST RETREIVE                 */
         B     @RC00334                                            0343
@RF00334 LR    @07,VINDX                                           0343
         SLA   @07,2                                               0343
         LR    @03,I                                               0343
         SLA   @03,3                                               0343
         L     @01,QBASE                                           0343
         AL    @01,@CF00382                                        0343
         L     @03,QVAL(@03,@01)                                   0343
         ST    @03,V-4(@07)                                        0343
*             QSKIP(I)=YES;         /* CAUSE SKIPPING OF THIS ELEMENT*/
@RC00334 LR    @07,I                                               0344
         SLA   @07,3                                               0344
         L     @03,QBASE                                           0344
         ALR   @03,@07                                             0344
         BCTR  @03,0                                               0344
         OI    QSKIP-7(@03),B'00100000'                            0344
*           END;                    /*                               */
*       END;                        /*                               */
@RC00331 BCTR  VINDX,0                                             0346
         LTR   VINDX,VINDX                                         0346
         BP    @DL00329                                            0346
*     END;                          /*                               */
*   QOPER(K)=NO;                    /* MAKE CURRENT ELEMENT A DATA EL*/
@RC00319 LR    @07,K                                               0348
         SLA   @07,3                                               0348
         L     @05,QBASE                                           0348
         ALR   @05,@07                                             0348
         BCTR  @05,0                                               0348
         NI    QOPER-7(@05),B'01111111'                            0348
*   END LOAD;                       /* END OF LOAD PROC              */
@EL00002 DS    0H                                                  0349
@EF00002 DS    0H                                                  0349
@ER00002 LM    @14,@05,12(@13)                                     0349
         LM    @07,@12,48(@13)                                     0349
         BR    @14                                                 0349
*                                                                  0350
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD ROUTINE - ADD TWO NUMBERS TOGETHER                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0350
*ADDRTN:                                                           0350
*   PROC;                                                          0350
ADDRTN   STM   @14,@05,@SA00003                                    0350
         STM   @07,@12,@SA00003+32                                 0350
*   IF ALPHA=YES THEN               /* IF DATA IS ALPHA              */
         TM    ALPHA,B'10000000'                                   0351
         BNO   @RF00351                                            0351
*     ERROR=E852;                   /* SET ERROR CODE                */
         LA    ERROR,852                                           0352
*   ELSE                            /* OTHERWISE PROCESS             */
*     DO;                           /*                               */
         B     @RC00351                                            0353
@RF00351 DS    0H                                                  0354
*       RFY                                                        0354
*        (R1) RSTD;                 /* RESTRICT WORK REG     @ZA04832*/
*       GEN REFS(V1,V2,R1)          /*                       @ZA04832*/
*           SETS(V1,R1);                                           0355
*                                  /*                       @ZA04832*/
        L     R1,V1                LOAD V1                  @ZA04832*/
        A     R1,V2                ADD V2 TO V1             @ZA04832*/
        ST    R1,V1                SAVE SUM IN V1           @ZA04832*/
*       RFY                                                        0356
*        (R1) UNRSTD;               /* MAKE WORK REG AVAIL   @ZA04832*/
*       BC(OVERFLOW,AOFLOW);        /* DETECT F.P. OVERFLOW  @ZA04832*/
         BC    1,AOFLOW                                            0357
*ADD2:                                                             0358
*       QVAL(K)=V1;                 /* SAVE SUM IN TEMP AREA @ZA04832*/
ADD2     L     @07,QBASE                                           0358
         LR    @05,K                                               0358
         SLA   @05,3                                               0358
         L     @15,V1                                              0358
         LA    @14,0(@05,@07)                                      0358
         AL    @14,@CF00382                                        0358
         ST    @15,QVAL(,@14)                                      0358
*       QTEMP(K)=YES;               /* TURN ON TEMP BIT              */
         ALR   @07,@05                                             0359
         BCTR  @07,0                                               0359
         OI    QTEMP-7(@07),B'01000000'                            0359
*       RETURN;                     /*                       @ZA04832*/
@EL00003 DS    0H                                                  0360
@EF00003 DS    0H                                                  0360
@ER00003 LM    @14,@05,@SA00003                                    0360
         LM    @07,@12,@SA00003+32                                 0360
         BR    @14                                                 0360
*     END;                          /*                               */
*AOFLOW:                                                           0362
*   TOOBIG=YES;                     /* INDICATE OVERFLOW     @ZA04832*/
@RC00351 DS    0H                                                  0362
AOFLOW   OI    TOOBIG,B'00000100'                                  0362
*   GOTO ADD2;                      /* CONTINUE EVALUATION   @ZA04832*/
         B     ADD2                                                0363
*   END ADDRTN;                     /* END ADD PROC                  */
*                                                                  0365
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBTRACT ROUTINE - SUBTRACTS TWO NUMBERS                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0365
*SUBRTN:                                                           0365
*   PROC;                                                          0365
SUBRTN   STM   @14,@05,@SA00004                                    0365
         STM   @07,@12,@SA00004+32                                 0365
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */
         TM    ALPHA,B'10000000'                                   0366
         BNO   @RF00366                                            0366
*     ERROR=E856;                   /* SET ERROR CODE                */
         LA    ERROR,856                                           0367
*   ELSE                            /* OTHERWISE PROCESS NORMALLY    */
*     DO;                           /*                               */
         B     @RC00366                                            0368
@RF00366 DS    0H                                                  0369
*       RFY                                                        0369
*        (R1) RSTD;                 /* RESTRICT WORK REG     @ZA04832*/
*       GEN REFS(V1,V2,R1)          /*                       @ZA04832*/
*           SETS(V1,R1);                                           0370
*                                  /*                       @ZA04832*/
        L     R1,V1                LOAD V1                  @ZA04832*/
        S     R1,V2                SUBTRACT V2 FROM V1      @ZA04832*/
        ST    R1,V1                SAVE DIFFERENCE IN V1    @ZA04832*/
*       RFY                                                        0371
*        (R1) UNRSTD;               /* MAKE WORK REG AVAIL   @ZA04832*/
*       BC(OVERFLOW,SOFLOW);        /* DETECT F.P. OVERFLOW  @ZA04832*/
         BC    1,SOFLOW                                            0372
*SUB2:                                                             0373
*       QVAL(K)=V1;                 /* SAVE DIF IN TEMP AREA @ZA04832*/
SUB2     L     @07,QBASE                                           0373
         LR    @05,K                                               0373
         SLA   @05,3                                               0373
         L     @15,V1                                              0373
         LA    @14,0(@05,@07)                                      0373
         AL    @14,@CF00382                                        0373
         ST    @15,QVAL(,@14)                                      0373
*       QTEMP(K)=YES;               /* TURN ON TEMP BIT              */
         ALR   @07,@05                                             0374
         BCTR  @07,0                                               0374
         OI    QTEMP-7(@07),B'01000000'                            0374
*       RETURN;                     /*                       @ZA04832*/
@EL00004 DS    0H                                                  0375
@EF00004 DS    0H                                                  0375
@ER00004 LM    @14,@05,@SA00004                                    0375
         LM    @07,@12,@SA00004+32                                 0375
         BR    @14                                                 0375
*     END;                          /*                               */
*SOFLOW:                                                           0377
*   TOOBIG=YES;                     /* INDICATE OVERFLOW     @ZA04832*/
@RC00366 DS    0H                                                  0377
SOFLOW   OI    TOOBIG,B'00000100'                                  0377
*   GOTO SUB2;                      /* CONTINUE EVALUATION   @ZA04832*/
         B     SUB2                                                0378
*   END SUBRTN;                     /* END SUB PROC                  */
*                                                                  0380
*   /*****************************************************************/
*   /*                                                               */
*   /* MULTIPLY ROUTINE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0380
*MULRTN:                                                           0380
*   PROC;                                                          0380
MULRTN   STM   @14,@05,@SA00005                                    0380
         STM   @07,@12,@SA00005+32                                 0380
*   IF ALPHA=YES THEN               /* IF ALPHA DATA THEN            */
         TM    ALPHA,B'10000000'                                   0381
         BNO   @RF00381                                            0381
*     ERROR=E860;                   /* SET ERROR CODE                */
         LA    ERROR,860                                           0382
*   ELSE                            /* OTHERWISE PROCESS MORMALLY    */
*     DO;                           /* TURN ON TEMP BIT              */
         B     @RC00381                                            0383
@RF00381 DS    0H                                                  0384
*       QTEMP(K)=YES;               /*                               */
         L     @07,QBASE                                           0384
         LR    @05,K                                               0384
         SLA   @05,3                                               0384
         ST    @05,@TF00001                                        0384
         ALR   @05,@07                                             0384
         BCTR  @05,0                                               0384
         OI    QTEMP-7(@05),B'01000000'                            0384
*       IF QLEN(K)=F1 THEN          /* IF MULTIPLY                   */
         L     @05,@TF00001                                        0385
         AL    @07,@CF00381                                        0385
         LH    @07,QLEN-4(@05,@07)                                 0385
         C     @07,@CF00082                                        0385
         BNE   @RF00385                                            0385
*         DO;                       /*                               */
*           RFY                                                    0387
*            (R0,                                                  0387
*             R1) RSTD;             /*                       @ZA04832*/
*           GEN REFS(V1,V2,R0,R1,MVCK)/*                     @ZA04832*/
*               SETS(V1,R0,R1,MVCK);                               0388
*                                      /*                   @ZA04832*/
        L     R1,V1                LOAD MULTIPLICAND        @ZA04832
        M     R0,V2                MULTIPLY BY MULTIPLIER   @ZA04832
        ST    R1,V1                STORE PRODUCT            @ZA04832
        ST    R0,MVCK              STORE HI-ORDER REG       @ZA04832
*           RFY                                                    0389
*            (R0,                                                  0389
*             R1) UNRSTD;           /*                       @ZA04832*/
*           IF V1>=0 THEN           /* IF POSITIVE PRODUCT   @ZA04832*/
         SLR   @07,@07                                             0390
         C     @07,V1                                              0390
         BH    @RF00390                                            0390
*             DO;                   /*                       @ZA04832*/
*               IF MVCK^=0 THEN     /* VALIDITY CK POS #     @ZA04832*/
         C     @07,MVCK                                            0392
         BE    @RF00392                                            0392
*                 TOOBIG=YES;       /* PRODUCT TOO LARGE     @ZA04832*/
         OI    TOOBIG,B'00000100'                                  0393
*             END;                  /*                       @ZA04832*/
*           ELSE                    /* FOR NEGATIVE PRODUCTS @ZA04832*/
*             DO;                   /*                       @ZA04832*/
         B     @RC00390                                            0395
@RF00390 DS    0H                                                  0396
*               IF MVCK^=ALLONES THEN/* VALIDITY CK NEG #    @ZA04832*/
         CLC   MVCK(4),@CF00107                                    0396
         BE    @RF00396                                            0396
*                 TOOBIG=YES;       /* PRODUCT TOO LARGE     @ZA04832*/
         OI    TOOBIG,B'00000100'                                  0397
*             END;                  /*                       @ZA04832*/
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE DO EXPONENTIATION   */
*         DO;                       /*                               */
         B     @RC00385                                            0400
@RF00385 DS    0H                                                  0401
*           IF V2<=F0 THEN          /* IF POWER IS TOO SMALL, DEFAULT*/
         L     @07,V2                                              0401
         LTR   @07,@07                                             0401
         BP    @RF00401                                            0401
*             V1=F1;                /* AS POWER OF ZERO (1)          */
         MVC   V1(4),@CF00082                                      0402
*           ELSE                    /* OTHERWISE COMPUTE POWER       */
*             DO;                   /*                               */
         B     @RC00401                                            0403
@RF00401 DS    0H                                                  0404
*               N=V1;               /* MULTIPLY AS MANY TIMES AS     */
         L     @07,V1                                              0404
         ST    @07,N                                               0404
*               DO I=1 TO V2-1;     /* NECESSARY (POWER TIMES)       */
         LA    I,1                                                 0405
         B     @DE00405                                            0405
@DL00405 DS    0H                                                  0406
*                 RFY                                              0406
*                  (R0,                                            0406
*                   R1) RSTD;       /*                       @ZA04832*/
*                 GEN REFS(V1,N,R0,R1,MVCK)/*                @ZA04832*/
*                     SETS(V1,R0,R1,MVCK);                         0407
*                                           /*              @ZA04832*/
        L     R1,V1                LOAD MULTIPLICAND        @ZA04832
        M     R0,N                 MULTIPLY BY MULTIPLIER   @ZA04832
        ST    R1,V1                STORE PRODUCT            @ZA04832
        ST    R0,MVCK              STORE HI-ORDER REG       @ZA04832
*                 RFY                                              0408
*                  (R0,                                            0408
*                   R1) UNRSTD;     /*                       @ZA04832*/
*                 IF V1>=0 THEN     /* IF POSITIVE PRODUCT   @ZA04832*/
         SLR   @07,@07                                             0409
         C     @07,V1                                              0409
         BH    @RF00409                                            0409
*                   DO;             /*                       @ZA04832*/
*                     IF MVCK^=0 THEN/* VALIDITY CK POS #    @ZA04832*/
         C     @07,MVCK                                            0411
         BE    @RF00411                                            0411
*                       TOOBIG=YES; /* PRODUCT TOO LARGE     @ZA04832*/
         OI    TOOBIG,B'00000100'                                  0412
*                   END;            /*                       @ZA04832*/
*                 ELSE              /* FOR NEGATIVE PRODUCTS @ZA04832*/
*                   DO;             /*                       @ZA04832*/
         B     @RC00409                                            0414
@RF00409 DS    0H                                                  0415
*                     IF MVCK^=ALLONES×/* VALIDITY CK NEG #  @ZA04832*/
*                         V1=MAXNEG THEN/* -2**31 TOO BIG    @ZA04832*/
         CLC   MVCK(4),@CF00107                                    0415
         BNE   @RT00415                                            0415
         CLC   V1(4),@CF00105                                      0415
         BNE   @RF00415                                            0415
@RT00415 DS    0H                                                  0416
*                       TOOBIG=YES; /* PRODUCT TOO LARGE     @ZA04832*/
         OI    TOOBIG,B'00000100'                                  0416
*                   END;            /*                       @ZA04832*/
@RF00415 DS    0H                                                  0418
*               END;                /*                               */
@RC00409 AL    I,@CF00082                                          0418
@DE00405 L     @07,V2                                              0418
         BCTR  @07,0                                               0418
         CR    I,@07                                               0418
         BNH   @DL00405                                            0418
*             END;                  /*                               */
*         END;                      /*                               */
@RC00401 DS    0H                                                  0421
*       QVAL(K)=V1;                 /* STORE RESULTS IN TEMP AREA    */
@RC00385 LR    @07,K                                               0421
         SLA   @07,3                                               0421
         L     @05,V1                                              0421
         L     @01,QBASE                                           0421
         AL    @01,@CF00382                                        0421
         ST    @05,QVAL(@07,@01)                                   0421
*     END;                          /*                               */
*   END MULRTN;                     /* END MULTIPLY PROC             */
@EL00005 DS    0H                                                  0423
@EF00005 DS    0H                                                  0423
@ER00005 LM    @14,@05,@SA00005                                    0423
         LM    @07,@12,@SA00005+32                                 0423
         BR    @14                                                 0423
*                                                                  0424
*   /*****************************************************************/
*   /*                                                               */
*   /* DIVIDE ROUTINE - DIVIDES TWO NUMBERS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0424
*DIVRTN:                                                           0424
*   PROC;                                                          0424
DIVRTN   STM   @14,@05,12(@13)                                     0424
         STM   @07,@12,48(@13)                                     0424
*   IF ALPHA=YES×V2=F0 THEN         /* IF ALPHA DATA OR DIVIDE BY 0  */
         TM    ALPHA,B'10000000'                                   0425
         BO    @RT00425                                            0425
         L     @07,V2                                              0425
         LTR   @07,@07                                             0425
         BNZ   @RF00425                                            0425
@RT00425 DS    0H                                                  0426
*     ERROR=E864;                   /* SET ERROR CODE                */
         LA    ERROR,864                                           0426
*   ELSE                            /* OTHERWISE PROCESS             */
*     DO;                           /*                               */
         B     @RC00425                                            0427
@RF00425 DS    0H                                                  0428
*       IF QLEN(K)=F1 THEN          /* IF NORMAL DIVIDE              */
         LR    @07,K                                               0428
         SLA   @07,3                                               0428
         L     @05,QBASE                                           0428
         AL    @05,@CF00381                                        0428
         LH    @07,QLEN-4(@07,@05)                                 0428
         C     @07,@CF00082                                        0428
         BNE   @RF00428                                            0428
*         V1=V1/V2;                 /* STORE QUOTIENT IN TEMPAREA    */
         L     @00,V1                                              0429
         SRDA  @00,32                                              0429
         D     @00,V2                                              0429
         ST    @01,V1                                              0429
*       ELSE                        /* IF REMAINDER                  */
*         V1=V1//V2;                /* STORE REMAINDER IN TEMPAREA   */
         B     @RC00428                                            0430
@RF00428 L     @00,V1                                              0430
         SRDA  @00,32                                              0430
         D     @00,V2                                              0430
         ST    @00,V1                                              0430
*       QVAL(K)=V1;                 /* SAVE ANS IN TEMP AREA         */
@RC00428 L     @07,QBASE                                           0431
         LR    @05,K                                               0431
         SLA   @05,3                                               0431
         L     @15,V1                                              0431
         LA    @14,0(@05,@07)                                      0431
         AL    @14,@CF00382                                        0431
         ST    @15,QVAL(,@14)                                      0431
*       QTEMP(K)=YES;               /* SET TEMP BIT                  */
         ALR   @07,@05                                             0432
         BCTR  @07,0                                               0432
         OI    QTEMP-7(@07),B'01000000'                            0432
*     END;                          /*                               */
*   END DIVRTN;                     /* END DIVIDE PROC               */
@EL00006 DS    0H                                                  0434
@EF00006 DS    0H                                                  0434
@ER00006 LM    @14,@05,12(@13)                                     0434
         LM    @07,@12,48(@13)                                     0434
         BR    @14                                                 0434
*                                                                  0435
*   /*****************************************************************/
*   /*                                                               */
*   /* ASSIGN ROUTINE                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0435
*ASSIGN:                                                           0435
*   PROC;                                                          0435
ASSIGN   STM   @14,@01,@SA00007                                    0435
         STM   @03,@12,@SA00007+16                                 0435
*   IF TYPE=RELAT THEN              /* IF RELATIONAL ENTRY           */
         L     @03,@PC00001+8                                      0436
         CLC   TYPE(4,@03),@CF00058                                0436
         BNE   @RF00436                                            0436
*     CALL ASSIGNR;                 /* CALL RELATIONAL ASSIGN        */
         BAL   @14,ASSIGNR                                         0437
*   ELSE                            /* OTHERWISE GET READY TO STORE  */
*     DO;                           /* ANSWER                        */
         B     @RC00436                                            0438
@RF00436 DS    0H                                                  0439
*       IF ALPHA=YES THEN           /* IF ALPHA DATA                 */
         TM    ALPHA,B'10000000'                                   0439
         BNO   @RF00439                                            0439
*         DO;                       /* SET RETURN POINTER TO DATA    */
*           OUTPTR=QPTR(V2);        /* SET POINTER                   */
         L     @15,QBASE                                           0441
         L     @14,V2                                              0441
         SLA   @14,3                                               0441
         LA    @01,0(@14,@15)                                      0441
         AL    @01,@CF00382                                        0441
         L     OUTPTR,QPTR(,@01)                                   0441
*           CLEN=QLEN(V2);          /* SET LENGTH OF DATA            */
         L     @03,@PC00001+4                                      0442
         AL    @15,@CF00381                                        0442
         LH    @15,QLEN-4(@14,@15)                                 0442
         STH   @15,CLEN(,@03)                                      0442
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE UNPACK INTO USER    */
*         DO;                       /* PROVIDED OUTAREA              */
         B     @RC00439                                            0444
@RF00439 DS    0H                                                  0445
*           CVD(V2,WORKAREA);       /* CONVERT NUMBER TO DECIMAL     */
         L     @03,V2                                              0445
         CVD   @03,WORKAREA                                        0445
*           UNPK(OUTAREA(2:17),WORKAREA);/* UNPACK DECIMAL INTO ZONED*/
         L     @03,@PC00001+12                                     0446
         UNPK  OUTAREA+1(16,@03),WORKAREA(8)                       0446
*           OUTAREA(17)=OUTAREA(17)×'0';/* INSURE LAST ZONE          */
         OI    OUTAREA+16(@03),C'0'                                0447
*           DO CLEN=16 TO 2 BY-1 WHILE OUTAREA(2)='0';/* STRIP LEAD  */
         LA    @03,16                                              0448
         L     @15,@PC00001+4                                      0448
         STH   @03,CLEN(,@15)                                      0448
@DL00448 L     @03,@PC00001+12                                     0448
         CLI   OUTAREA+1(@03),C'0'                                 0448
         BNE   @DC00448                                            0448
*             OUTAREA(2:16)=OUTAREA(3:17);/* ZEROS AND LEFT JUSTIFY  */
         MVC   @TS00001(15),OUTAREA+2(@03)                         0449
         MVC   OUTAREA+1(15,@03),@TS00001                          0449
*           END;                    /*                               */
         L     @15,@PC00001+4                                      0450
         SLR   @03,@03                                             0450
         BCTR  @03,0                                               0450
         AH    @03,CLEN(,@15)                                      0450
         L     @15,@PC00001+4                                      0450
         STH   @03,CLEN(,@15)                                      0450
         C     @03,@CF00058                                        0450
         BNL   @DL00448                                            0450
@DC00448 DS    0H                                                  0451
*           IF V2<F0 THEN           /* IF NEGATIVE RESULT            */
         L     @03,V2                                              0451
         LTR   @03,@03                                             0451
         BNM   @RF00451                                            0451
*             DO;                   /*                               */
*               OUTAREA(1)='-';     /* MOVE IN MINUS SIGN            */
         L     @03,@PC00001+12                                     0453
         MVI   OUTAREA(@03),C'-'                                   0453
*               CLEN=CLEN+F1;       /* ADD ONE TO LENGTH             */
         L     @03,@PC00001+4                                      0454
         LA    @15,1                                               0454
         AH    @15,CLEN(,@03)                                      0454
         STH   @15,CLEN(,@03)                                      0454
*             END;                  /*                               */
*           ELSE                    /* IF POSITIVE NUMBER            */
*             OUTAREA(1:16)=OUTAREA(2:17);/* MOVE DOWN TO LEFT       */
         B     @RC00451                                            0456
@RF00451 L     @03,@PC00001+12                                     0456
         MVC   @TS00001(16),OUTAREA+1(@03)                         0456
         MVC   OUTAREA(16,@03),@TS00001                            0456
*         END;                      /*                               */
*     END;                          /*                               */
*   END ASSIGN;                     /* END ASSIGN PROC               */
@EL00007 DS    0H                                                  0459
@EF00007 DS    0H                                                  0459
@ER00007 LM    @14,@01,@SA00007                                    0459
         LM    @03,@12,@SA00007+16                                 0459
         BR    @14                                                 0459
*                                                                  0460
*   /*****************************************************************/
*   /*                                                               */
*   /* POPUP PROC - POPS AN OPERATOR OFF VERTICAL QUE                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0460
*POPUP:                                                            0460
*   PROC;                                                          0460
POPUP    STM   @14,@01,12(@13)                                     0460
         ST    @03,32(,@13)                                        0460
         STM   @05,@12,40(@13)                                     0460
*   OUTQUE(OUTQDX)=VQUE(VINDX);     /* COPY VERT QUE ELEMENT TO HORIZ*/
         L     @05,QBASE                                           0461
         LR    @03,OUTQDX                                          0461
         SLA   @03,3                                               0461
         ALR   @03,@05                                             0461
         AL    @03,@CF00382                                        0461
         LR    @15,VINDX                                           0461
         SLA   @15,3                                               0461
         LA    @14,1                                               0461
         L     @09,@PC00001+4                                      0461
         LH    @09,CLEN(,@09)                                      0461
         ALR   @09,@14                                             0461
         SLA   @09,4                                               0461
         ALR   @05,@09                                             0461
         ALR   @05,@15                                             0461
         AL    @05,@CF00382                                        0461
         MVC   OUTQUE(8,@03),VQUE(@05)                             0461
*   VINDX=VINDX-F1;                 /* QUE AND DECREMENT VERT INDEX  */
         BCTR  VINDX,0                                             0462
*   OUTQDX=OUTQDX+F1;               /* INCREMENT OUTQUE INDEX        */
         ALR   OUTQDX,@14                                          0463
*   END POPUP;                      /* END POPUP PROC                */
@EL00008 DS    0H                                                  0464
@EF00008 DS    0H                                                  0464
@ER00008 LM    @14,@01,12(@13)                                     0464
         L     @03,32(,@13)                                        0464
         LM    @05,@12,40(@13)                                     0464
         BR    @14                                                 0464
*                                                                  0465
*   /*****************************************************************/
*   /*                                                               */
*   /* LESS THAN ROUTINE                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0465
*LTRTN:                                                            0465
*   PROC;                                                          0465
LTRTN    STM   @14,@12,@SA00009                                    0465
*   IF ALPHA=YES THEN               /* IF ALPHA DATA,                */
         TM    ALPHA,B'10000000'                                   0466
         BNO   @RF00466                                            0466
*     DO;                           /*                               */
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */
         BAL   @14,COMPR                                           0468
*       BC(11,FLSE);                /* BRANCH IF NOT LESS THAN       */
         BC    11,FLSE                                             0469
*       ANS=TRUE;                   /* SET TRUE SWITCH               */
         OI    ANS,B'00000100'                                     0470
*FLSE:                                                             0471
*       ;                           /* TARGET FOR BRANCH             */
FLSE     DS    0H                                                  0472
*     END;                          /*                               */
*   ELSE                            /*                               */
*     IF V1<V2 THEN                 /* IF NUMERIC, PERFORM NUMERIC   */
         B     @RC00466                                            0473
@RF00466 L     @15,V1                                              0473
         C     @15,V2                                              0473
         BNL   @RF00473                                            0473
*       ANS=TRUE;                   /* COMPARISON - SET TRUE IF SO   */
         OI    ANS,B'00000100'                                     0474
*   END LTRTN;                      /* END LESS THAN ROUTINE         */
@EL00009 DS    0H                                                  0475
@EF00009 DS    0H                                                  0475
@ER00009 LM    @14,@12,@SA00009                                    0475
         BR    @14                                                 0475
*                                                                  0476
*   /*****************************************************************/
*   /*                                                               */
*   /* GREATER THAN ROUTINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*GTRTN:                                                            0476
*   PROC;                                                          0476
GTRTN    STM   @14,@12,@SA00010                                    0476
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */
         TM    ALPHA,B'10000000'                                   0477
         BNO   @RF00477                                            0477
*     DO;                           /*                               */
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */
         BAL   @14,COMPR                                           0479
*       BC(13,FLSE2);               /* BRANCH IF FALSE               */
         BC    13,FLSE2                                            0480
*       ANS=TRUE;                   /* SET TRUE OF TRUE              */
         OI    ANS,B'00000100'                                     0481
*FLSE2:                                                            0482
*       ;                           /* TARGET FOR BRANCH             */
FLSE2    DS    0H                                                  0483
*     END;                          /*                               */
*   ELSE                            /* IF NUMERIC PERFORM            */
*     IF V1>V2 THEN                 /* NUMERIC COMPARE               */
         B     @RC00477                                            0484
@RF00477 L     @15,V1                                              0484
         C     @15,V2                                              0484
         BNH   @RF00484                                            0484
*       ANS=TRUE;                   /* SET TO TRUE IF SO             */
         OI    ANS,B'00000100'                                     0485
*   END GTRTN;                      /* END GREATER THAN              */
@EL00010 DS    0H                                                  0486
@EF00010 DS    0H                                                  0486
@ER00010 LM    @14,@12,@SA00010                                    0486
         BR    @14                                                 0486
*                                                                  0487
*   /*****************************************************************/
*   /*                                                               */
*   /* LESS THAN OR EQUAL PROC                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0487
*LERTN:                                                            0487
*   PROC;                                                          0487
LERTN    STM   @14,@12,@SA00011                                    0487
*   CALL LTRTN;                     /* CALL LESSTHAN ROUTINE         */
         BAL   @14,LTRTN                                           0488
*   IF ANS=FALSE THEN               /* IF NOT TRUE , TRY EQUAL       */
         TM    ANS,B'00000100'                                     0489
         BNZ   @RF00489                                            0489
*     CALL ASSIGNR;                 /* ROUTINE                       */
         BAL   @14,ASSIGNR                                         0490
*   END LERTN;                      /* END LESS THAN PROC            */
@EL00011 DS    0H                                                  0491
@EF00011 DS    0H                                                  0491
@ER00011 LM    @14,@12,@SA00011                                    0491
         BR    @14                                                 0491
*                                                                  0492
*   /*****************************************************************/
*   /*                                                               */
*   /* GREATER THAN OR EQUAL ROUTINE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*GERTN:                                                            0492
*   PROC;                                                          0492
GERTN    STM   @14,@12,@SA00012                                    0492
*   CALL GTRTN;                     /* CALL GREATER THAN ROUTINE     */
         BAL   @14,GTRTN                                           0493
*   IF ANS=FALSE THEN               /* IF ANS NOT TRUE, THEN TRY     */
         TM    ANS,B'00000100'                                     0494
         BNZ   @RF00494                                            0494
*     CALL ASSIGNR;                 /* EQUAL ROUTINE                 */
         BAL   @14,ASSIGNR                                         0495
*   END GERTN;                      /* END GREATER THAN OR EQUAL     */
@EL00012 DS    0H                                                  0496
@EF00012 DS    0H                                                  0496
@ER00012 LM    @14,@12,@SA00012                                    0496
         BR    @14                                                 0496
*                                                                  0497
*   /*****************************************************************/
*   /*                                                               */
*   /* EQUAL ROUTINE                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0497
*ASSIGNR:                                                          0497
*   PROC;                                                          0497
ASSIGNR  STM   @14,@12,@SA00013                                    0497
*   IF ALPHA=YES THEN               /* IF ALPHA DATA                 */
         TM    ALPHA,B'10000000'                                   0498
         BNO   @RF00498                                            0498
*     DO;                           /*                               */
*       CALL COMPR;                 /* CALL COMPARE ROUTINE          */
         BAL   @14,COMPR                                           0500
*       BC(7,FLSE3);                /* BRANCH IF FALSE               */
         BC    7,FLSE3                                             0501
*       ANS=TRUE;                   /* SET TRUE IF SO                */
         OI    ANS,B'00000100'                                     0502
*FLSE3:                                                            0503
*       ;                           /* TARGET FOR BRANCH             */
FLSE3    DS    0H                                                  0504
*     END;                          /*                               */
*   ELSE                            /* IF NUMERIC DATA PERFORM       */
*     IF V1=V2 THEN                 /* NUMERIC COMPARE               */
         B     @RC00498                                            0505
@RF00498 CLC   V1(4),V2                                            0505
         BNE   @RF00505                                            0505
*       ANS=TRUE;                   /* SET TRUE IF SO                */
         OI    ANS,B'00000100'                                     0506
*   END ASSIGNR;                    /* END EQUAL PROC                */
@EL00013 DS    0H                                                  0507
@EF00013 DS    0H                                                  0507
@ER00013 LM    @14,@12,@SA00013                                    0507
         BR    @14                                                 0507
*                                                                  0508
*   /*****************************************************************/
*   /*                                                               */
*   /* AND RELATIONAL ROUTINE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*ANDRTN:                                                           0508
*   PROC;                                                          0508
ANDRTN   STM   @14,@12,12(@13)                                     0508
*   IF V1=F0&V2=F0 THEN             /* IF BOTHE TRUE THEN            */
         SLR   @15,@15                                             0509
         C     @15,V1                                              0509
         BNE   @RF00509                                            0509
         C     @15,V2                                              0509
         BNE   @RF00509                                            0509
*     ANS=TRUE;                     /* SET TRUE ANS                  */
         OI    ANS,B'00000100'                                     0510
*   END ANDRTN;                                                    0511
@EL00014 DS    0H                                                  0511
@EF00014 DS    0H                                                  0511
@ER00014 LM    @14,@12,12(@13)                                     0511
         BR    @14                                                 0511
*                                                                  0512
*   /*****************************************************************/
*   /*                                                               */
*   /* OR RELATIONAL ROUTINE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*ORRTN:                                                            0512
*   PROC;                                                          0512
ORRTN    STM   @14,@12,12(@13)                                     0512
*   IF V1=F0×V2=F0 THEN             /* IF EITHER TRUE                */
         SLR   @15,@15                                             0513
         C     @15,V1                                              0513
         BE    @RT00513                                            0513
         C     @15,V2                                              0513
         BNE   @RF00513                                            0513
@RT00513 DS    0H                                                  0514
*     ANS=TRUE;                     /* SET TRUE ANS                  */
         OI    ANS,B'00000100'                                     0514
*   END ORRTN;                      /* END                           */
@EL00015 DS    0H                                                  0515
@EF00015 DS    0H                                                  0515
@ER00015 LM    @14,@12,12(@13)                                     0515
         BR    @14                                                 0515
*                                                                  0516
*   /*****************************************************************/
*   /*                                                               */
*   /* COMPARE FUNCTION FOR ALPHA DATA                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*COMPR:                                                            0516
*   PROC;                                                          0516
COMPR    STM   @14,@12,12(@13)                                     0516
*   RFY                                                            0517
*    (R2,                                                          0517
*     R3,                                                          0517
*     R4,                                                          0517
*     R5) RSTD;                     /* RESTRICT REGISTERS            */
*   R2=QPTR(V1);                    /* ADDR OF 'A'                   */
         L     @15,QBASE                                           0518
         L     @14,V1                                              0518
         SLA   @14,3                                               0518
         LA    @01,0(@14,@15)                                      0518
         AL    @01,@CF00382                                        0518
         L     R2,QPTR(,@01)                                       0518
*   R4=QPTR(V2);                    /* ADDR OF 'B'                   */
         L     @09,V2                                              0519
         SLA   @09,3                                               0519
         LA    @01,0(@09,@15)                                      0519
         AL    @01,@CF00382                                        0519
         L     R4,QPTR(,@01)                                       0519
*   R3=QLEN(V1);                    /* LENGTH OF 'A'                 */
         AL    @14,@CF00381                                        0520
         LH    R3,QLEN-4(@14,@15)                                  0520
*   R5=QLEN(V2)×BLANKS;             /* LENGTH OF 'B' AND PAD CHAR    */
         AL    @15,@CF00381                                        0521
         LH    R5,QLEN-4(@09,@15)                                  0521
         O     R5,@CF00103                                         0521
*   CLCL(R2,R4);                    /* ISSUE COMPARE LONG            */
         CLCL  R2,R4                                               0522
*   RFY                                                            0523
*    (R2,                                                          0523
*     R3,                                                          0523
*     R4,                                                          0523
*     R5) UNRSTD;                   /* RELEASE REGISTERS             */
*   END COMPR;                      /* END COMPARE PROC              */
@EL00016 DS    0H                                                  0524
@EF00016 DS    0H                                                  0524
@ER00016 LM    @14,@12,12(@13)                                     0524
         BR    @14                                                 0524
*                                                                  0525
*   /*****************************************************************/
*   /*                                                               */
*   /* SEPARATOR SEPARATOR ROUTINE                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0525
*SKIPRTN:                                                          0525
*   PROC;                                                          0525
SKIPRTN  STM   @14,@12,12(@13)                                     0525
*   SEPS=YES;                       /* SKIP ALL DELIMETERS           */
         OI    SEPS,B'00100000'                                    0526
*   DO WHILE SEPS=YES&N<=CLEN;      /*                               */
         B     @DE00527                                            0527
@DL00527 DS    0H                                                  0528
*     IF C(N)^=' '&C(N)^=','&C(N)^='05'X THEN/* IF NOT A DELIMETER   */
         L     @15,N                                               0528
         L     @14,@PC00001                                        0528
         ALR   @15,@14                                             0528
         BCTR  @15,0                                               0528
         CLI   C(@15),C' '                                         0528
         BE    @RF00528                                            0528
         L     @15,N                                               0528
         ALR   @15,@14                                             0528
         BCTR  @15,0                                               0528
         CLI   C(@15),C','                                         0528
         BE    @RF00528                                            0528
         L     @15,N                                               0528
         ALR   @15,@14                                             0528
         BCTR  @15,0                                               0528
         CLI   C(@15),X'05'                                        0528
         BE    @RF00528                                            0528
*       IF N<CLEN&C(N:N+F1)='/*' THEN/* IF AN OPEN COMMENT           */
         L     @15,N                                               0529
         L     @09,@PC00001+4                                      0529
         CH    @15,CLEN(,@09)                                      0529
         BNL   @RF00529                                            0529
         ALR   @14,@15                                             0529
         BCTR  @14,0                                               0529
         CLC   C(2,@14),@CC00354                                   0529
         BNE   @RF00529                                            0529
*         DO;                       /*                               */
*           DO N=N+4 TO CLEN WHILE C(N-2:N-1)^='*/';/* SKIP COMMENT  */
         AL    @15,@CF00085                                        0531
         B     @DE00531                                            0531
@DL00531 L     @14,@PC00001                                        0531
         ALR   @14,@15                                             0531
         AL    @14,@CF00398                                        0531
         CLC   C(2,@14),@CC00355                                   0531
         BE    @DC00531                                            0531
*           END;                                                   0532
         AL    @15,@CF00082                                        0532
@DE00531 ST    @15,N                                               0532
         L     @14,@PC00001+4                                      0532
         CH    @15,CLEN(,@14)                                      0532
         BNH   @DL00531                                            0532
@DC00531 DS    0H                                                  0533
*         END;                                                     0533
*       ELSE                        /* IF NOT A DELIMETER, END SKIP  */
*         SEPS=NO;                  /*                               */
         B     @RC00529                                            0534
@RF00529 NI    SEPS,B'11011111'                                    0534
*     ELSE                          /* IF A SEPARATOR, INCREMENT     */
*       N=N+F1;                     /* INDEX                         */
         B     @RC00528                                            0535
@RF00528 LA    @15,1                                               0535
         AL    @15,N                                               0535
         ST    @15,N                                               0535
*   END;                                                           0536
@RC00528 DS    0H                                                  0536
@DE00527 TM    SEPS,B'00100000'                                    0536
         BNO   @DC00527                                            0536
         L     @15,@PC00001+4                                      0536
         L     @14,N                                               0536
         CH    @14,CLEN(,@15)                                      0536
         BNH   @DL00527                                            0536
@DC00527 DS    0H                                                  0537
*   END SKIPRTN;                                                   0537
@EL00017 DS    0H                                                  0537
@EF00017 DS    0H                                                  0537
@ER00017 LM    @14,@12,12(@13)                                     0537
         BR    @14                                                 0537
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR15F FIXED(31) REG(15),                                    0538
*     GPR01P PTR(31) REG(1);                                       0538
*   DCL                                                            0539
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */
*      2 I00401 PTR(31),            /* LENGTH                        */
*      2 I00402 CHAR(1),            /* HIARCHY                       */
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */
*   DCL                                                            0540
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */
*       3 I00501 PTR(8),            /* RESERVED                      */
*       3 I00502 PTR(24),           /* LENGTH                        */
*       3 I00503 PTR(8),            /* RESERVED                      */
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */
*   DECLARE                                                        0541
*     ILIST CHAR(10) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0542
*     I031F FIXED(31) BASED,                                       0542
*     I031P PTR(31) BASED,                                         0542
*     I015F FIXED(15) BASED,                                       0542
*     I015P PTR(15) BASED,                                         0542
*     I008P PTR(8) BASED,                                          0542
*     I001C CHAR(1) BASED;                                         0542
*   END IKJCT434;                                                  0543
@DATA    DS    0H
@SC00376 CLC   0(0,@01),C(@15)
@SM00396 MVC   OUTAREA(0,@14),QCHAR(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    4F
@SA00003 DS    14F
@SA00004 DS    14F
@SA00005 DS    14F
@SA00007 DS    14F
@SA00012 DS    15F
@SA00011 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00013 DS    15F
@TF00001 DS    F
IKJCT434 CSECT
         DS    0F
@CF00082 DC    F'1'
@CF00058 DC    F'2'
@CF00234 DC    F'3'
@CF00085 DC    F'4'
@CF00091 DC    F'7'
@CF00067 DC    F'8'
@CF00388 DC    F'-16'
@CF00389 DC    F'-12'
@CF00384 DC    F'-9'
@CF00382 DC    F'-8'
@CF00381 DC    F'-4'
@CF00398 DC    F'-3'
@CF00103 DC    XL4'40000000'
@CF00105 DC    XL4'80000000'
@CF00107 DC    XL4'FFFFFFFF'
@DATD    DSECT
         DS    0D
QBASE    DS    A
N        DS    F
MVCK     DS    F
@TS00001 DS    CL16
         DS    CL4
WORKAREA DS    CL8
SEARCH   DS    BL1
SWS      DS    CL2
         ORG   SWS
ALPHA    DS    BL1
EXITA    EQU   SWS+0
SEPS     EQU   SWS+0
EXITB    EQU   SWS+0
PUSH     EQU   SWS+0
ANS      EQU   SWS+0
MATCH    EQU   SWS+0
CONCAT   EQU   SWS+0
OPFND    DS    BL1
NULLELEM EQU   SWS+1
NULLREQ  EQU   SWS+1
PCONCAT  EQU   SWS+1
PENDPREF EQU   SWS+1
TOOBIG   EQU   SWS+1
         ORG   SWS+2
         DS    CL5
ILIST    DS    CL10
         DS    CL2
V        DS    2F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT434 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CA00071 DC    A(TRTABUP)
         DS    0D
@CC00114 DC    C'00000000000000000'
@CC00118 DC    C'2147483647'
@CC00354 DC    C'/*'
@CC00355 DC    C'*/'
         DS    CL1
@NM00004 DS    CL16
         ORG   @NM00004+0
OPS      DC    CL7'+'
OPFLG    DC    X'80'
OPSTR    DC    H'3'
OPLEN    DC    H'1'
VECTOR   DC    AL4(ADDRTN)
         ORG   @NM00004+16
         ORG   @NM00004+16
         DC    CL7'-'
         DC    X'80'
         DC    H'3'
         DC    H'1'
         DC    AL4(SUBRTN)
         ORG   @NM00004+32
         ORG   @NM00004+32
         DC    CL7'**'
         DC    X'80'
         DC    H'5'
         DC    H'2'
         DC    AL4(MULRTN)
         ORG   @NM00004+48
         ORG   @NM00004+48
         DC    CL7'//'
         DC    X'80'
         DC    H'5'
         DC    H'2'
         DC    AL4(DIVRTN)
         ORG   @NM00004+64
         ORG   @NM00004+64
         DC    CL7'*'
         DC    X'80'
         DC    H'4'
         DC    H'1'
         DC    AL4(MULRTN)
         ORG   @NM00004+80
         ORG   @NM00004+80
         DC    CL7'/'
         DC    X'80'
         DC    H'4'
         DC    H'1'
         DC    AL4(DIVRTN)
         ORG   @NM00004+96
         ORG   @NM00004+96
         DC    CL7')'
         DC    X'80'
         DC    H'2'
         DC    H'1'
         DC    A(0)
         ORG   @NM00004+112
         ORG   @NM00004+112
         DC    CL7'('
         DC    X'80'
         DC    H'2'
         DC    H'1'
         DC    A(0)
         ORG   @NM00004+128
         ORG   @NM00004+128
         DC    CL7'='
         DC    X'88'
         DC    H'2'
         DC    H'1'
         DC    AL4(ASSIGN)
         ORG   @NM00004+144
         ORG   @NM00004+144
         DC    CL7'EQ'
         DC    X'88'
         DC    H'2'
         DC    H'3'
         DC    AL4(ASSIGN)
         ORG   @NM00004+160
         ORG   @NM00004+160
         DC    CL7'>='
         DC    X'88'
         DC    H'2'
         DC    H'2'
         DC    AL4(GERTN)
         ORG   @NM00004+176
         ORG   @NM00004+176
         DC    CL7'<='
         DC    X'88'
         DC    H'2'
         DC    H'2'
         DC    AL4(LERTN)
         ORG   @NM00004+192
         ORG   @NM00004+192
         DC    CL7'LT'
         DC    X'88'
         DC    H'2'
         DC    H'3'
         DC    AL4(LTRTN)
         ORG   @NM00004+208
         ORG   @NM00004+208
         DC    CL7'GT'
         DC    X'88'
         DC    H'2'
         DC    H'3'
         DC    AL4(GTRTN)
         ORG   @NM00004+224
         ORG   @NM00004+224
         DC    CL7'LE'
         DC    X'88'
         DC    H'2'
         DC    H'3'
         DC    AL4(LERTN)
         ORG   @NM00004+240
         ORG   @NM00004+240
         DC    CL7'GE'
         DC    X'88'
         DC    H'2'
         DC    H'3'
         DC    AL4(GERTN)
         ORG   @NM00004+256
         ORG   @NM00004+256
         DC    CL7'<'
         DC    X'88'
         DC    H'2'
         DC    H'1'
         DC    AL4(LTRTN)
         ORG   @NM00004+272
         ORG   @NM00004+272
         DC    CL7'>'
         DC    X'88'
         DC    H'2'
         DC    H'1'
         DC    AL4(GTRTN)
         ORG   @NM00004+288
         ORG   @NM00004+288
         DC    CL7'NE'
         DC    X'8C'
         DC    H'2'
         DC    H'3'
         DC    AL4(ASSIGNR)
         ORG   @NM00004+304
         ORG   @NM00004+304
         DC    CL7'NL'
         DC    X'8C'
         DC    H'2'
         DC    H'3'
         DC    AL4(LTRTN)
         ORG   @NM00004+320
         ORG   @NM00004+320
         DC    CL7'NG'
         DC    X'8C'
         DC    H'2'
         DC    H'3'
         DC    AL4(GTRTN)
         ORG   @NM00004+336
         ORG   @NM00004+336
         DC    CL7'^='
         DC    X'8C'
         DC    H'2'
         DC    H'2'
         DC    AL4(ASSIGNR)
         ORG   @NM00004+352
         ORG   @NM00004+352
         DC    CL7'^<'
         DC    X'8C'
         DC    H'2'
         DC    H'2'
         DC    AL4(LTRTN)
         ORG   @NM00004+368
         ORG   @NM00004+368
         DC    CL7'^>'
         DC    X'8C'
         DC    H'2'
         DC    H'2'
         DC    AL4(GTRTN)
         ORG   @NM00004+384
         ORG   @NM00004+384
         DC    CL7'AND'
         DC    X'81'
         DC    H'1'
         DC    H'4'
         DC    AL4(ANDRTN)
         ORG   @NM00004+400
         ORG   @NM00004+400
         DC    CL7'OR'
         DC    X'81'
         DC    H'0'
         DC    H'3'
         DC    AL4(ORRTN)
         ORG   @NM00004+416
         ORG   @NM00004+416
         DC    CL7'&&'
         DC    X'81'
         DC    H'1'
         DC    H'1'
         DC    AL4(ANDRTN)
         ORG   @NM00004+432
         ORG   @NM00004+432
         DC    CL7'×'
         DC    X'81'
         DC    H'0'
         DC    H'1'
         DC    AL4(ORRTN)
         ORG   @NM00004+448
ENDDLM   DC    CL1'+'
         DC    CL1'-'
         DC    CL1'/'
         DC    CL1'*'
         DC    CL1','
         DC    CL1' '
         DC    CL1')'
         DC    CL1'('
         DC    CL1'='
         DC    X'05'
         DC    CL1'^'
         DC    CL1'&&'
         DC    CL1'×'
         DC    CL1'<'
         DC    CL1'>'
         DC    13CL1' '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
OUTQDX   EQU   @04
VINDX    EQU   @02
MAXX     EQU   @03
K        EQU   @04
PCTR     EQU   @02
ERROR    EQU   @06
X        EQU   @07
HOWMUCH  EQU   @09
NSAVE    EQU   @08
I        EQU   @05
OUTPTR   EQU   @02
R12      EQU   @12
R11      EQU   @11
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
GPR01P   EQU   @01
GPR15F   EQU   @15
         EXTRN TRTABUP
QCHAR    EQU   0
QUE      EQU   0
QPTR     EQU   QUE
QVAL     EQU   QPTR
QLEN     EQU   QUE+4
QSTREN   EQU   QUE+6
QFLGS    EQU   QUE+7
QOPER    EQU   QFLGS
QTEMP    EQU   QFLGS
QSKIP    EQU   QFLGS
QPREFX   EQU   QFLGS
QEXCLU   EQU   QFLGS
QNOT     EQU   QFLGS
QEND     EQU   QFLGS
QCOMB    EQU   QFLGS
ROUTINE  EQU   0
VQUE     EQU   0
VVAL     EQU   VQUE
VSTREN   EQU   VQUE+6
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
C        EQU   0
CLEN     EQU   0
TYPE     EQU   0
OUTAREA  EQU   0
OUTQUE   EQU   QUE
@NM00003 EQU   V
V1       EQU   @NM00003
V2       EQU   @NM00003+4
I004     EQU   ILIST
I00401   EQU   I004
I00403   EQU   I004+5
I00404   EQU   I004+8
I00405   EQU   I004+9
I005     EQU   ILIST
I00502   EQU   I005+1
I00504   EQU   I005+5
I00505   EQU   I005+8
I00506   EQU   I005+9
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
I00503   EQU   I005+4
I00501   EQU   I005
I00402   EQU   I004+4
@NM00002 EQU   VQUE+7
@NM00001 EQU   VQUE+4
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00031 EQU   NOFREEXT
@RC00060 EQU   @RC00059
@RC00072 EQU   @RC00070
@RC00127 EQU   @RC00122
@RF00126 EQU   @RC00122
@RC00124 EQU   @RC00122
@RC00135 EQU   @RC00134
@RT00211 EQU   EXIT
@RF00324 EQU   @RC00319
@RC00322 EQU   @RC00319
@RC00335 EQU   @RC00334
@RC00390 EQU   @RC00385
@RF00396 EQU   @RC00385
@RF00411 EQU   @RC00409
@RC00381 EQU   @EL00005
@RC00425 EQU   @EL00006
@RC00436 EQU   @EL00007
@RC00439 EQU   @EL00007
@RC00451 EQU   @EL00007
@RF00473 EQU   @EL00009
@RC00466 EQU   @EL00009
@RF00484 EQU   @EL00010
@RC00477 EQU   @EL00010
@RF00489 EQU   @EL00011
@RF00494 EQU   @EL00012
@RF00505 EQU   @EL00013
@RC00498 EQU   @EL00013
@RF00509 EQU   @EL00014
@RF00513 EQU   @EL00015
@RC00529 EQU   @RC00528
@RF00392 EQU   @RC00390
@ENDDATA EQU   *
         END   IKJCT434,(C'PLS1932',0701,75349)

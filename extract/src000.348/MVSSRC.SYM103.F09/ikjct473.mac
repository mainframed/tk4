         TITLE 'IKJCT473 OUTPUT CP ALLOC/UNALLOC                       *
                        '
IKJCT473 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJCT473  74.107'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                    */
*                                                                  0027
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*                       B E G I N  C O D E                         */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0027
*   OCMTBPTR=OUTP;                  /* PUT BASE IN REG FOR EFFICIENCY*/
         L     @14,@PC00001                                        0027
         L     OCMTBPTR,OUTP(,@14)                                 0027
*   OUTDAIR=ADDR(DAPLSTRG);         /* ADDR OF DAIR PARMLIST IN    0028
*                                      OUTCOMTB FOR '67              */
         LA    @14,DAPLSTRG                                        0028
         ST    @14,OUTDAIR(,OCMTBPTR)                              0028
*   IF SUBCMODE=YES THEN            /* SUBCMD MODE, SO SAVE DS TO  0029
*                                      PROCESS                       */
         TM    SUBCMODE(OCMTBPTR),B'01000000'                      0029
         BNO   @RF00029                                            0029
*     PDEBASE=OSVDSPDE;             /* SET DSNAME PDE BASE ON SAVE 0030
*                                      PDE                           */
         L     PDEBASE,OSVDSPDE(,OCMTBPTR)                         0030
*   ELSE                            /* NOT SUBCMD MODE, MUST BE PRINT
*                                      DS                            */
*     PDEBASE=OPRDSPDE;             /* SET DSNAME PDE BASE ON PRINT
*                                      PDE                           */
*                                                                  0031
         B     @RC00029                                            0031
@RF00029 L     PDEBASE,OPRDSPDE(,OCMTBPTR)                         0031
*   /*****************************************************************/
*   /*                                                               */
*   /* FILL IN DAIR PARAMETER LIST                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0032
*   DAIRPTR=ADDR(DAIRAREA);         /* BASE DAIR PARM BLOCKS - 04 &
*                                      08                            */
@RC00029 LA    DAIRPTR,DAIRAREA                                    0032
*   DAPB1PTR=ADDR(DAPBAREA);        /* BASE DAIR PARM BLOCKS - 1C &
*                                      18                            */
         LA    DAPB1PTR,DAPBAREA                                   0033
*   DAPLPTR=ADDR(DAPLSTRG);         /* BASE DAPL                     */
         LA    DAPLPTR,DAPLSTRG                                    0034
*   DAPL=DAPL&&DAPL;                /* ZERO DAPL                     */
         XC    DAPL(20,DAPLPTR),DAPL(DAPLPTR)                      0035
*   DAPLUPT=CPPLUPT;                /* FILL IN DAPL                  */
         L     @14,OUTCPPL(,OCMTBPTR)                              0036
         MVC   DAPLUPT(4,DAPLPTR),CPPLUPT(@14)                     0036
*   DAPLECT=CPPLECT;                /* .....                         */
         MVC   DAPLECT(4,DAPLPTR),CPPLECT(@14)                     0037
*   DAPLECB=ADDR(OUTATTN);          /* .....                         */
         LA    @10,OUTATTN(,OCMTBPTR)                              0038
         ST    @10,DAPLECB(,DAPLPTR)                               0038
*   DAPLPSCB=CPPLPSCB;              /* .....                         */
*                                                                  0039
         MVC   DAPLPSCB(4,DAPLPTR),CPPLPSCB(@14)                   0039
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE CORE FOR DAIR PARM BLOCKS - 04/08 & 18/1C. KEEP 08 */
*   /* AND 18 BLOCKS SEPARATE, SO THAT FOR A SEQUENCE OF: SEARCH(04),*/
*   /* ALLOC(08), UNALLOC(18), AND REALLOC(08), CERTAIN FIELDS OF THE*/
*   /* 08 BLOCK NEED NOT BE REINIT BY THE OVERHEAD OF A SEARCH(04).  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0040
*   DAPB08='';                      /* FIRST BLANK THE ENTIRE BLOCK  */
         MVI   DAPB08(DAIRPTR),C' '                                0040
         MVC   DAPB08+1(83,DAIRPTR),DAPB08(DAIRPTR)                0040
*   DAPB08(1:8)=DAPB08(1:8)&&DAPB08(1:8);/* THEN ZERO SELECT FLDS    */
         XC    DAPB08(8,DAIRPTR),DAPB08(DAIRPTR)                   0041
*   DAPB08(37:52)=DAPB08(37:52)&&DAPB08(37:52);                    0042
         XC    DAPB08+36(16,DAIRPTR),DAPB08+36(DAIRPTR)            0042
*   DAPB08(69:76)=DAPB08(69:76)&&DAPB08(69:76);                    0043
         XC    DAPB08+68(8,DAIRPTR),DAPB08+68(DAIRPTR)             0043
*   DAPB18='';                      /* FIRST BLANK THE ENTIRE BLOCK  */
         MVI   DAPB18(DAPB1PTR),C' '                               0044
         MVC   DAPB18+1(39,DAPB1PTR),DAPB18(DAPB1PTR)              0044
*   DAPB18(1:8)=DAPB18(1:8)&&DAPB18(1:8);/* THEN ZERO SELECT FIELDS
*                                                                    */
         XC    DAPB18(8,DAPB1PTR),DAPB18(DAPB1PTR)                 0045
*                                                                  0046
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*  DETERMINE THE REASON FOR CALLING THIS DAIR INTERFACE MODULE     */
*/*  AND SET BITS TO REQUEST THAT FUNCTION.                          */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0046
*   SWITCHES=SWITCHES&&SWITCHES;    /* INIT THE FUNTION SWITCHES     */
         XC    SWITCHES(1),SWITCHES                                0046
*   IF UNALCALL=YES THEN            /* UNALLOCATION REQUESTED        */
         TM    UNALCALL(OCMTBPTR),B'00100000'                      0047
         BNO   @RF00047                                            0047
*     DO;                                                          0048
*       UNALCALL=NO;                                               0049
         NI    UNALCALL(OCMTBPTR),B'11011111'                      0049
*       ENTRY18=YES;                                               0050
         OI    ENTRY18,B'00100000'                                 0050
*     END;                                                         0051
*   ELSE                            /* CHECK TO SEE WHICH ALLOCATION */
*     IF SUBCMODE=NO&TERM=YES THEN  /* NOT SAVE DS, BUT PRINT TERM   */
         B     @RC00047                                            0052
@RF00047 TM    SUBCMODE(OCMTBPTR),B'01000000'                      0052
         BNZ   @RF00052                                            0052
         TM    TERM(OCMTBPTR),B'00001000'                          0052
         BNO   @RF00052                                            0052
*       ENTRY1C=YES;                                               0053
         OI    ENTRY1C,B'00010000'                                 0053
*     ELSE                          /* PRINT DS TO ALLOC             */
*       DO;                                                        0054
         B     @RC00052                                            0054
@RF00052 DS    0H                                                  0055
*         ENTRY04=YES;                                             0055
*         ENTRY08=YES;                                             0056
         OI    ENTRY04,B'11000000'                                 0056
*       END;                                                       0057
*                                                                  0058
*/********************************************************************/
*/*                                                                  */
*/*                                                                  */
*/*  PROCESS THE INITIAL REQUEST AS WELL AS ANY SUBSEQUENT           */
*/*  REQUESTS WHICH OCCUR.  FOR INSTANCE, THE DSORG OF THE           */
*/*  ALLOCATED DATASET MAY NOT BE ACCEPTABLE, SO UNALLOCATE          */
*/*  IT AFTER ISSUING AN ERROR MESSAGE.                              */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0058
*   DO WHILE ENTRY04=YES×ENTRY08=YES×ENTRY18=YES×ENTRY1C=YES;      0058
*                                                                  0058
@RC00052 DS    0H                                                  0058
@RC00047 B     @DE00058                                            0058
@DL00058 DS    0H                                                  0059
*/********************************************************************/
*/* ENTRY CODE 18                                                    */
*/*        UNALLOCATE THE DATASET                                    */
*/********************************************************************/
*                                                                  0059
*     IF ENTRY18=YES THEN                                          0059
         TM    ENTRY18,B'00100000'                                 0059
         BNO   @RF00059                                            0059
*       DO;                                                        0060
*         ENTRY18=OFF;                                             0061
         NI    ENTRY18,B'11011111'                                 0061
*         DA18CD=DA18;              /* TELL DAIR TO UNALLOCATE       */
         MVC   DA18CD(2,DAPB1PTR),@CB00318                         0062
*         DA18FLG=DA18FLG&&DA18FLG; /* CLEAR FLAG RETURN FIELD       */
         XC    DA18FLG(2,DAPB1PTR),DA18FLG(DAPB1PTR)               0063
*         DA18PDSN=ZERO;                                           0064
         SLR   @14,@14                                             0064
         ST    @14,DA18PDSN(,DAPB1PTR)                             0064
*         DA18DDN=PRINTDDN(STRCTNUM);/* TELL DAIR DDNAME TO UNALLOC  */
         L     @14,STRCTNUM(,OCMTBPTR)                             0065
         MH    @14,@CH00300                                        0065
         ALR   @14,OCMTBPTR                                        0065
         MVC   DA18DDN(8,DAPB1PTR),PRINTDDN-20(@14)                0065
*         DA18DPS2=ZERO;                                           0066
         MVI   DA18DPS2(DAPB1PTR),X'00'                            0066
*         DA18CTL=ZERO;                                            0067
         MVI   DA18CTL(DAPB1PTR),X'00'                             0067
*         DA18JBNM='';                                             0068
         MVI   DA18JBNM(DAPB1PTR),C' '                             0068
         MVC   DA18JBNM+1(7,DAPB1PTR),DA18JBNM(DAPB1PTR)           0068
*         DAPLDAPB=ADDR(DAPBAREA);  /* DAPL POINTS TO DAIR BLD       */
         LA    @14,DAPBAREA                                        0069
         ST    @14,DAPLDAPB(,DAPLPTR)                              0069
*         REG1=DAPLPTR;             /* PARAM FOR DAIR                */
         LR    REG1,DAPLPTR                                        0070
*         GEN(LINK EP=IKJDAIR);     /* LINK TO DAIR                  */
         LINK EP=IKJDAIR
*         OUTRTCD=REG15;            /* SAVE DAIR RETURN CODE         */
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0072
*         IF OUTRTCD^=ZERO THEN                                    0073
         LH    @14,OUTRTCD(,OCMTBPTR)                              0073
         LTR   @14,@14                                             0073
         BZ    @RF00073                                            0073
*           DO;                                                    0074
*             OUTMSGID=16;          /* ISSUE DAIRFAIL MSG            */
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0075
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */
         ST    OCMTBPTR,@AL00001                                   0076
         L     @15,@CV00338                                        0076
         LA    @01,@AL00001                                        0076
         BALR  @14,@15                                             0076
*             OUTRTCD=ERRCDE;                                      0077
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0077
*           END;                                                   0078
*         ELSE                      /* DAIR TC=0                     */
*           DSALLOC(STRCTNUM)=NO;   /* INDICATE NO LONGER ALLOC      */
         B     @RC00073                                            0079
@RF00073 L     @14,STRCTNUM(,OCMTBPTR)                             0079
         MH    @14,@CH00300                                        0079
         ALR   @14,OCMTBPTR                                        0079
         NI    DSALLOC-20(@14),B'10111111'                         0079
*       END;                        /* END UNALLOC REQUEST PROCESSING
*                                                                    */
@RC00073 DS    0H                                                  0081
*                                                                  0081
*/********************************************************************/
*/*   ENTRY CODE 1C                                                  */
*/*       ALLOCATE A TERMINAL FOR PRINT DATASET                      */
*/********************************************************************/
*                                                                  0081
*     IF ENTRY1C=YES THEN                                          0081
@RF00059 TM    ENTRY1C,B'00010000'                                 0081
         BNO   @RF00081                                            0081
*       DO;                                                        0082
*         ENTRY1C=OFF;                                             0083
         NI    ENTRY1C,B'11101111'                                 0083
*         DA1CCD=DA1C;              /* DAIR ENTRY CODE 1C            */
         MVC   DA1CCD(2,DAPB1PTR),@CB00320                         0084
*         DAPLDAPB=ADDR(DAPBAREA);  /* DAPL POINTS TO PARM BLK       */
         LA    @14,DAPBAREA                                        0085
         ST    @14,DAPLDAPB(,DAPLPTR)                              0085
*         REG1=DAPLPTR;             /* DAIR PARAMETER LIST           */
         LR    REG1,DAPLPTR                                        0086
*         GEN(LINK EP=IKJDAIR);     /* LINK TO DAIR TO ALLOC TERM    */
         LINK EP=IKJDAIR
*         OUTRTCD=REG15;            /* SAVE DAIR RETURN CODE         */
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0088
*         IF OUTRTCD^=ZERO THEN     /* IF ANY ERRORS                 */
         LH    @14,OUTRTCD(,OCMTBPTR)                              0089
         LTR   @14,@14                                             0089
         BZ    @RF00089                                            0089
*           DO;                                                    0090
*             OUTMSGID=16;          /* PROVIDE DAIRFAIL CODE         */
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0091
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */
         ST    OCMTBPTR,@AL00001                                   0092
         L     @15,@CV00338                                        0092
         LA    @01,@AL00001                                        0092
         BALR  @14,@15                                             0092
*             ERROR=YES;            /* INDICATE SERIOUS ERROR        */
         OI    ERROR(OCMTBPTR),B'00001000'                         0093
*             OUTRTCD=ERRCDE;       /* INDICATE TERMINATION OF OUTPUT*/
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0094
*           END;                                                   0095
*         ELSE                      /* NO DAIR ERRORS                */
*           DO;                                                    0096
         B     @RC00089                                            0096
@RF00089 DS    0H                                                  0097
*             NEWDS(STRCTNUM)=YES;  /* INDICATE DEFAULT LRECL NEEDED */
         L     @14,STRCTNUM(,OCMTBPTR)                             0097
         MH    @14,@CH00300                                        0097
         ST    @14,@TF00001                                        0097
         ALR   @14,OCMTBPTR                                        0097
         OI    NEWDS-20(@14),B'00000100'                           0097
*             PRINTDDN(STRCTNUM)=DA1CDDN;/* SAVE DDNAME              */
         LR    @14,OCMTBPTR                                        0098
         AL    @14,@TF00001                                        0098
         MVC   PRINTDDN-20(8,@14),DA1CDDN(DAPB1PTR)                0098
*             DSALLOC(STRCTNUM)=YES;/* INDICATE A DS ALLOCATED       */
         LR    @14,OCMTBPTR                                        0099
         AL    @14,@TF00001                                        0099
         OI    DSALLOC-20(@14),B'01000000'                         0099
*           END;                                                   0100
*       END;                        /* END ALLOC TERMINAL PROCESSING
*                                                                    */
@RC00089 DS    0H                                                  0102
*                                                                  0102
*/********************************************************************/
*/*   ENTRY CODE 04                                                  */
*/*         SEARCH THE ALLOCATED DATASETS AND CATALOG TO SEE IF      */
*/*         THE DATASET EXISTS                                       */
*/********************************************************************/
*                                                                  0102
*     IF ENTRY04=YES THEN                                          0102
@RF00081 TM    ENTRY04,B'10000000'                                 0102
         BNO   @RF00102                                            0102
*       DO;                                                        0103
*         ENTRY04=OFF;                                             0104
*                                                                  0104
         NI    ENTRY04,B'01111111'                                 0104
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK THE DATASET NAME LENGTH - CAN'T BE >44 CHARS WHEN */
*         /* QUALIFIED                                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0105
*         IF(DSNLTH1>36&DSNFLG1^=DSNQUO)×(DSNLTH1>44&DSNFLG1=DSNQUO)
*           THEN                    /* DSN>36 & NOT QUOTED OR DSN>44
*                                      AND QUOTED                    */
*                                                                  0105
         LH    @14,DSNLTH1(,PDEBASE)                               0105
         CH    @14,@CH00382                                        0105
         BNH   @GL00002                                            0105
         CLI   DSNFLG1(PDEBASE),192                                0105
         BNE   @RT00105                                            0105
@GL00002 LH    @14,DSNLTH1(,PDEBASE)                               0105
         CH    @14,@CH00358                                        0105
         BNH   @RF00105                                            0105
         CLI   DSNFLG1(PDEBASE),192                                0105
         BNE   @RF00105                                            0105
@RT00105 DS    0H                                                  0106
*           /*********************************************************/
*           /*                                                       */
*           /* ERROR - FULLY QUALIFIED DSNAME IS OR WILL BE > 44     */
*           /* CHARACTERS                                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0106
*           DO;                                                    0106
*             SWITCHES=SWITCHES&&SWITCHES;/* HALT FURTHER DAIR CALLS */
         XC    SWITCHES(1),SWITCHES                                0107
*             OUTMSGID=110;         /* DSNAME TOO LONG MSG           */
         MVI   OUTMSGID(OCMTBPTR),X'6E'                            0108
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */
         ST    OCMTBPTR,@AL00001                                   0109
         L     @15,@CV00338                                        0109
         LA    @01,@AL00001                                        0109
         BALR  @14,@15                                             0109
*             IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS AND TERMINAL 0110
*                                      INPUT                         */
         TM    ERROR(OCMTBPTR),B'00001000'                         0110
         BNZ   @RF00110                                            0110
         TM    NONTERM(OCMTBPTR),B'00100000'                       0110
         BNZ   @RF00110                                            0110
*               NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR INDICATOR,
*                                      BUT GIVE USER ANOTHER CHANCE
*                                      IF IN SUBCMD MODE             */
         L     @14,STRCTNUM(,OCMTBPTR)                             0111
         MH    @14,@CH00300                                        0111
         ALR   @14,OCMTBPTR                                        0111
         OI    NOMEMNAM-20(@14),B'00000010'                        0111
*             ELSE                  /* IF IN CLIST OR NOPROMPT MODE  */
*               DO;                                                0112
         B     @RC00110                                            0112
@RF00110 DS    0H                                                  0113
*                 ERROR=YES;        /* TERMINATE OUTPUT              */
         OI    ERROR(OCMTBPTR),B'00001000'                         0113
*                 OUTRTCD=ERRCDE;   /* INDICATE ERROR CONDITIONS     */
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0114
*               END;                                               0115
*           END;                                                   0116
*         ELSE                      /* DSNAME CORRECT LENGTH         */
*                                                                  0117
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP AND SEARCH THE ALLOCATED DATASETS AND THE      */
*           /* CATALOG FOR THE DATASET NAME TO BE ALLOCATED - ENTRY  */
*           /* 04                                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0117
*           DO;                                                    0117
         B     @RC00105                                            0117
@RF00105 DS    0H                                                  0118
*             QUALDSNL=DSNLTH1;     /* GET DSNAME LENGTH FROM PDE    */
         LH    @14,DSNLTH1(,PDEBASE)                               0118
         STH   @14,QUALDSNL                                        0118
*             QUALDSNM='';          /* BLANK DATASET NAME FIELD      */
         MVI   QUALDSNM,C' '                                       0119
         MVC   QUALDSNM+1(43),QUALDSNM                             0119
*             QUALDSNM=NAME(1:DSNLTH1);/* MOVE DSN                   */
         MVI   QUALDSNM+1,C' '                                     0120
         MVC   QUALDSNM+2(42),QUALDSNM+1                           0120
         LR    @10,@14                                             0120
         BCTR  @10,0                                               0120
         L     @07,DSNAMEAD(,PDEBASE)                              0120
         EX    @10,@SM00407                                        0120
*             IF DSNFLG1^=DSNQUO THEN/* IF DSNAME NOT IN QUOTES IT IS
*                                      NOT QUALIFIED                 */
         CLI   DSNFLG1(PDEBASE),192                                0121
         BE    @RF00121                                            0121
*               DO;                 /* ADD QUALIFIER                 */
*                 QUALDSNM(DSNLTH1+1:DSNLTH1+8)=OUTLIST;/* APPEND  0123
*                                      .OUTLIST                      */
         LA    @10,QUALDSNM(@14)                                   0123
         MVC   0(8,@10),@CC00333                                   0123
*                 QUALDSNL=QUALDSNL+8;/* ADD LTH OF QUALIFIER        */
         AH    @14,@CH00045                                        0124
         STH   @14,QUALDSNL                                        0124
*               END;                                               0125
*             DA04CD=DA04;          /* DAIR ENTRY CODE TO CHECK    0126
*                                      STATUS OF DATASET             */
@RF00121 MVC   DA04CD(2,DAIRPTR),@CB00314                          0126
*             DA04PDSN=ADDR(QUALNAME);/* INSERT ADDR OF FULLY      0127
*                                      QUALIFIED DSNAME              */
         LA    @14,QUALNAME                                        0127
         ST    @14,DA04PDSN(,DAIRPTR)                              0127
*             DAPB04(13:16)=ZERO;   /* ZERO THE DAIR FLAGS           */
         SLR   @14,@14                                             0128
         ST    @14,@TF00001                                        0128
         MVC   DAPB04+12(4,DAIRPTR),@TF00001                       0128
*             DAPLDAPB=ADDR(DAIRAREA);/* DAPL POINTS TO PARM BLK     */
         LA    @14,DAIRAREA                                        0129
         ST    @14,DAPLDAPB(,DAPLPTR)                              0129
*             REG1=DAPLPTR;         /* LOAD DAIR PARAMETER LIST      */
         LR    REG1,DAPLPTR                                        0130
*             GEN(LINK EP=IKJDAIR); /* LINK TO DAIR FOR DS STATUS    */
         LINK EP=IKJDAIR
*             OUTRTCD=REG15;        /* SAVE RETURN CODE            0132
*                                                                    */
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0132
*                                                                  0133
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK THE RESULTS OF DAIR ENTRY 04 TO DETERMINE IF  */
*             /* THE DATASET IS NEW OR OLD. SET UP TO ALLOCATE THE   */
*             /* DATASET ACCORDINGLY (NEW/CATLOG OR OLD/KEEP). IF    */
*             /* ERRORS IN DSORG ARE DETECTED IKJCT463 WILL ISSUE    */
*             /* MODE FOR NEW DATASET NAME (IF IN SUBCMD MODE) OR    */
*             /* IKJCT469 WILL END AND RETURN TO THE TMP. NOTE: IF   */
*             /* THE DATASET IS ALLOCATED BEFORE THE DSORG ERROR IS  */
*             /* DETECTED THE DATASET IS FIRST UNALLOCATED BEFORE    */
*             /* RETURNING                                           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0133
*             IF OUTRTCD=ZERO THEN  /* DAIR RC=0 INDICATES DS WAS  0133
*                                      FOUND ON ENTRY 04. DS IS OLD. */
*                                                                  0133
         LH    @14,OUTRTCD(,OCMTBPTR)                              0133
         LTR   @14,@14                                             0133
         BNZ   @RF00133                                            0133
*               /*****************************************************/
*               /*                                                   */
*               /* DATASET IS OLD (WAS ALLOCATED OR FOUND IN         */
*               /* CATALOG). SET SOME FIELDS IN PARM BLK FOR 08 ENTRY*/
*               /* TO DAIR.                                          */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0134
*               DO;                                                0134
*                 IF DA04CAT=YES×DA04DSE=YES THEN/* DS FOUND IN CATLG
*                                      OR IS ALLOCATED               */
         TM    DA04CAT(DAIRPTR),B'00000110'                        0135
         BZ    @RF00135                                            0135
*                   DO;             /* SET UP FOR ENTRY CODE 08      */
*                     DA08OLD=YES;  /* SET STATUS TO OLD             */
         OI    DA08OLD(DAIRPTR),B'00000001'                        0137
*                     DA08KEEP=YES; /* NORMAL UNALLOC - KEEP         */
         OI    DA08KEEP(DAIRPTR),B'00001000'                       0138
*                     DA08KEP=YES;  /* IF ABEND UNALLOC - KEEP       */
         OI    DA08KEP(DAIRPTR),B'00001000'                        0139
*                   END;                                           0140
*                 IF DA04DSE=YES THEN/* DSN ALLOCATED                */
*                                                                  0141
@RF00135 TM    DA04DSE(DAIRPTR),B'00000010'                        0141
         BNO   @RF00141                                            0141
*                   /*************************************************/
*                   /*                                               */
*                   /* DATASET IS ALREADY ALLOCATED CHECK FOR AN     */
*                   /* ACCEPTABLE DSORG (PO/PS). IF DSORG IS PO,     */
*                   /* CHECK FOR MEMBER NAME. NOTE: THESE FLAGS SET  */
*                   /* ONLY IF DS IS ALLOCATED, NOT IF FOUND IN      */
*                   /* CATALOG.                                      */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0142
*                   DO;                                            0142
*                                                                  0142
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK FOR AN ACCEPTABLE DSORG               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0143
*                     IF DA04DSO^=PO&DA04DSO^=PS THEN/* DSORG NOT PO
*                                      OR PS                         */
         CLI   DA04DSO(DAIRPTR),X'02'                              0143
         BE    @RF00143                                            0143
         CLI   DA04DSO(DAIRPTR),X'40'                              0143
         BE    @RF00143                                            0143
*                       DO;                                        0144
*                         SWITCHES=SWITCHES&&SWITCHES;/* HALT FURTHER
*                                      DAIR PROCESSING               */
         XC    SWITCHES(1),SWITCHES                                0145
*                         OUTMSGID=126;/* DSORG NOT SUPPORTED MSG    */
         MVI   OUTMSGID(OCMTBPTR),X'7E'                            0146
*                         CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER */
         ST    OCMTBPTR,@AL00001                                   0147
         L     @15,@CV00338                                        0147
         LA    @01,@AL00001                                        0147
         BALR  @14,@15                                             0147
*                         IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS &
*                                      INPUT FROM TERM               */
         TM    ERROR(OCMTBPTR),B'00001000'                         0148
         BNZ   @RF00148                                            0148
         TM    NONTERM(OCMTBPTR),B'00100000'                       0148
         BNZ   @RF00148                                            0148
*                           NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME   0149
*                                      ERROR INDICATOR, BUT GIVE USER
*                                      ANOTHER CHANCE IF SUBCMD MODE */
         L     @14,STRCTNUM(,OCMTBPTR)                             0149
         MH    @14,@CH00300                                        0149
         ALR   @14,OCMTBPTR                                        0149
         OI    NOMEMNAM-20(@14),B'00000010'                        0149
*                         ELSE      /* ERROR OR INPUT FROM CLIST     */
*                           DO;                                    0150
         B     @RC00148                                            0150
@RF00148 DS    0H                                                  0151
*                             ERROR=YES;/* INDICATE SERIOUS ERROR    */
         OI    ERROR(OCMTBPTR),B'00001000'                         0151
*                             OUTRTCD=ERRCDE;/* TERMINATION RETURN 0152
*                                      CODE                          */
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0152
*                           END;                                   0153
*                       END;                                       0154
*                     ELSE          /* DSORG ACCEPTABLE, CK MEMBER 0155
*                                      NAME                          */
*                                                                  0155
*                       /*********************************************/
*                       /*                                           */
*                       /* CHECK IF MEMBER NAME PRESENT FOR PO       */
*                       /* DATASET                                   */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0155
*                       IF DA04DSO=PO&DSNFLG2^=DSM THEN/* PARTITIONED
*                                      DS W/ NO MEMBER NAME IN PDE   */
         B     @RC00143                                            0155
@RF00143 CLI   DA04DSO(DAIRPTR),X'02'                              0155
         BNE   @RF00155                                            0155
         CLI   DSNFLG2(PDEBASE),128                                0155
         BE    @RF00155                                            0155
*                         DO;                                      0156
*                           OUTMSGID=107;/* MSG THAT TEMPNAME      0157
*                                      DEFAULTS                      */
         MVI   OUTMSGID(OCMTBPTR),X'6B'                            0157
*                           CALL IKJCT467(OUTCOMTB);/* CALL MSG    0158
*                                      WRITER                        */
         ST    OCMTBPTR,@AL00001                                   0158
         L     @15,@CV00338                                        0158
         LA    @01,@AL00001                                        0158
         BALR  @14,@15                                             0158
*                           DSNFLG2=DSNFLG2×DSM;/* SET PDE FLAG FOR
*                                      MEMBER NAME                   */
         LA    @14,128                                             0159
         MVC   @ZT00003+3(1),DSNFLG2(PDEBASE)                      0159
         O     @14,@ZT00003                                        0159
         STC   @14,DSNFLG2(,PDEBASE)                               0159
*                           DSNLTH2=8;/* LENGTH OF MEMBER NAME       */
         MVC   DSNLTH2(2,PDEBASE),@CH00045                         0160
*                           DSNMEMAD=ADDR(OUTEMPMN);/* PDE POINTS TO
*                                      MEMBERNAME                    */
         LA    @14,OUTEMPMN(,OCMTBPTR)                             0161
         ST    @14,DSNMEMAD(,PDEBASE)                              0161
*                           MEMNAME=DEFAULT;/* DEFAULT MEMBERNAME    */
         MVC   MEMNAME(8,@14),@CC00335                             0162
*                         END;                                     0163
*                   END;            /* END DSORG CHECK FOR ALLOCATED
*                                      DS                            */
*               END;                /* END OF PROCESSING FOR OLD DS
*                                                                    */
*                                                                  0166
*             /*******************************************************/
*             /*                                                     */
*             /* DATASET IS NOT OLD, CHECK DAIR RETURN CODE FURTHER  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0166
*             ELSE                  /* CHECK DAIR RC FURTHER         */
*               IF OUTRTCD=8&DA08CTRC=NOTINCAT THEN/* RTCD OF 8    0166
*                                      INDICATES ERROR CATLG MNGMT 0166
*                                      AND CTRC=8 INDICATES DS NOT 0166
*                                      FOUND IN CATLG                */
*                                                                  0166
         B     @RC00133                                            0166
@RF00133 CLC   OUTRTCD(2,OCMTBPTR),@CH00045                        0166
         BNE   @RF00166                                            0166
         CLC   DA08CTRC(2,DAIRPTR),@CH00316                        0166
         BNE   @RF00166                                            0166
*                 /***************************************************/
*                 /*                                                 */
*                 /* DATASET IS NEW. PREPARE PARM BLK FOR 08 DAIR    */
*                 /* ENTRY                                           */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0167
*                 DO;                                              0167
*                   OUTRTCD=ZERO;   /* CLEAR RETURN CODE AREA        */
         SLR   @14,@14                                             0168
         STH   @14,OUTRTCD(,OCMTBPTR)                              0168
*                   DA08NEW=YES;    /* SET STATUS NEW                */
         OI    DA08NEW(DAIRPTR),B'00000100'                        0169
*                   DA08ABKL=YES;   /* REQUEST SPACE IN BLOCKS       */
*                   DA08RLSE=YES;   /* AND RELEASE ANY NOT USED      */
         OI    DA08ABKL(DAIRPTR),B'01010000'                       0171
*                   DA08PQTY=PRIMSPCE;/* DEFAULT PRIMARY SPACE     0172
*                                      REQUEST                       */
         MVC   DA08PQTY(4,DAIRPTR),@CF00300                        0172
*                   DA08SQTY=SECSPCE;/* DEFAULT SECONDARY SPACE    0173
*                                      REQUEST                       */
         MVC   DA08SQTY(4,DAIRPTR),@CF00300                        0173
*                   DA08BLK=BLOCKSZ;/* SET DEFAULT BLOCKSIZE FOR   0174
*                                      SPACE REQUEST                 */
         MVC   DA08BLK(4,DAIRPTR),@CF00304                         0174
*                   DA08CAT=YES;    /* SET DISP TO CATALOG           */
         OI    DA08CAT(DAIRPTR),B'00000010'                        0175
*                   IF DSNLTH2>ZERO THEN/* IF MEMBER NAME PRESENT    */
         CH    @14,DSNLTH2(,PDEBASE)                               0176
         BNL   @RF00176                                            0176
*                     DA08DQTY=DIRSPCE;/* ALLOCATE ONE DIRECTORY   0177
*                                      BLOCK                         */
         MVC   DA08DQTY(4,DAIRPTR),@CF00033                        0177
*                   DA08CATL=YES;   /* ABEND DISPOSITION IS CATLG    */
@RF00176 OI    DA08CATL(DAIRPTR),B'00000010'                       0178
*                   NEWDS(STRCTNUM)=YES;/* INDICATE NEW DATASET FOR
*                                      DEFAULTS                      */
         L     @14,STRCTNUM(,OCMTBPTR)                             0179
         MH    @14,@CH00300                                        0179
         ALR   @14,OCMTBPTR                                        0179
         OI    NEWDS-20(@14),B'00000100'                           0179
*                 END;              /* END OF NEW DATASET PROCESSING */
*               ELSE                /* NONZERO RC FROM DAIR OTHER  0181
*                                      THAN 8                        */
*                                                                  0181
*                 /***************************************************/
*                 /*                                                 */
*                 /* DAIR ERROR ON ENTRY 04                          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0181
*                 DO;                                              0181
         B     @RC00166                                            0181
@RF00166 DS    0H                                                  0182
*                   SWITCHES=SWITCHES&&SWITCHES;                   0182
         XC    SWITCHES(1),SWITCHES                                0182
*                   OUTMSGID=16;    /* DAIR ERROR MSG                */
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0183
*                   CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER       */
         ST    OCMTBPTR,@AL00001                                   0184
         L     @15,@CV00338                                        0184
         LA    @01,@AL00001                                        0184
         BALR  @14,@15                                             0184
*                   IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & INPUT
*                                      FROM TERM                     */
         TM    ERROR(OCMTBPTR),B'00001000'                         0185
         BNZ   @RF00185                                            0185
         TM    NONTERM(OCMTBPTR),B'00100000'                       0185
         BNZ   @RF00185                                            0185
*                     NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR   0186
*                                      INDICATOR, BUT GIVE USER    0186
*                                      ANOTHER CHANCE IF SUBCMD MODE */
         L     @14,STRCTNUM(,OCMTBPTR)                             0186
         MH    @14,@CH00300                                        0186
         ALR   @14,OCMTBPTR                                        0186
         OI    NOMEMNAM-20(@14),B'00000010'                        0186
*                   ELSE            /* ERROR OR CLIST INPUT          */
*                     DO;                                          0187
         B     @RC00185                                            0187
@RF00185 DS    0H                                                  0188
*                       ERROR=YES;  /* INDICATE SERIOUS ERROR        */
         OI    ERROR(OCMTBPTR),B'00001000'                         0188
*                       OUTRTCD=ERRCDE;/* TERMINATION RETURN CODE    */
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0189
*                     END;                                         0190
*                 END;                                             0191
@RC00185 DS    0H                                                  0192
*           END;                    /* END OF 04 SEARCH              */
@RC00166 DS    0H                                                  0192
@RC00133 DS    0H                                                  0193
*       END;                        /* END OF ALL 04 PROCESSING    0193
*                                                                    */
@RC00105 DS    0H                                                  0194
*                                                                  0194
*/****************************************************************** */
*/*   ENTRY CODE 08                                                  */
*/*        ALLOCATE THE DATASET                                      */
*/****************************************************************** */
*                                                                  0194
*     IF ENTRY08=YES THEN                                          0194
@RF00102 TM    ENTRY08,B'01000000'                                 0194
         BNO   @RF00194                                            0194
*       DO;                         /* ALLOCATE THE DATASET          */
*         ENTRY08=OFF;                                             0196
         NI    ENTRY08,B'10111111'                                 0196
*         DA08CD=DA08;              /* FUNCTION CODE TO ALLOCATE     */
         MVC   DA08CD(2,DAIRPTR),@CB00316                          0197
*         DA08FLG=ZERO;             /* ZERO FIELDS                   */
         SLR   @14,@14                                             0198
         ST    @14,@TF00001                                        0198
         MVC   DA08FLG(2,DAIRPTR),@TF00001+2                       0198
*         DA08DARC=ZERO;            /* .....                         */
         SLR   @14,@14                                             0199
         STH   @14,DA08DARC(,DAIRPTR)                              0199
*         DA08CTRC=ZERO;            /* .....                         */
         STH   @14,DA08CTRC(,DAIRPTR)                              0200
*         DA08DDN='';               /* BLANK FIELDS                  */
         MVI   DA08DDN(DAIRPTR),C' '                               0201
         MVC   DA08DDN+1(7,DAIRPTR),DA08DDN(DAIRPTR)               0201
*         DA08UNIT='';              /* .....                         */
         MVI   DA08UNIT(DAIRPTR),C' '                              0202
         MVC   DA08UNIT+1(7,DAIRPTR),DA08UNIT(DAIRPTR)             0202
*         DA08SER='';               /* .....                         */
         MVI   DA08SER(DAIRPTR),C' '                               0203
         MVC   DA08SER+1(7,DAIRPTR),DA08SER(DAIRPTR)               0203
*         DA08MNM='';               /* .....                         */
         MVI   DA08MNM(DAIRPTR),C' '                               0204
         MVC   DA08MNM+1(7,DAIRPTR),DA08MNM(DAIRPTR)               0204
*         DA08PSWD='';              /* .....                         */
         MVI   DA08PSWD(DAIRPTR),C' '                              0205
         MVC   DA08PSWD+1(7,DAIRPTR),DA08PSWD(DAIRPTR)             0205
*         IF DSNLTH3>ZERO THEN      /* PASSWORD PRESENT              */
         CH    @14,DSNLTH3(,PDEBASE)                               0206
         BNL   @RF00206                                            0206
*           DA08PSWD=PASSWORD;      /* MOVE INTO DAIR BLOCK          */
         L     @14,DSNPASAD(,PDEBASE)                              0207
         MVC   DA08PSWD(8,DAIRPTR),PASSWORD(@14)                   0207
*         IF DSNFLG2=DSM THEN       /* MEMBER NAME SPECIFIED         */
@RF00206 CLI   DSNFLG2(PDEBASE),128                                0208
         BNE   @RF00208                                            0208
*           DA08MNM(1:DSNLTH2)=MEMNAME;/* MOVE INTO MEMBER NAME FIELD*/
         LH    @14,DSNLTH2(,PDEBASE)                               0209
         BCTR  @14,0                                               0209
         L     @10,DSNMEMAD(,PDEBASE)                              0209
         EX    @14,@SM00410                                        0209
*         DAPLDAPB=ADDR(DAIRAREA);  /* DAPL POINTS TO PARM BLK       */
@RF00208 LA    @14,DAIRAREA                                        0210
         ST    @14,DAPLDAPB(,DAPLPTR)                              0210
*         REG1=DAPLPTR;             /* PARAMETER FOR IKJDAIR         */
         LR    REG1,DAPLPTR                                        0211
*         GEN(LINK EP=IKJDAIR);     /* CALL DAIR ROUTINE             */
         LINK EP=IKJDAIR
*         OUTRTCD=REG15;            /* SAVE RETURN CODE FROM DAIR    */
         STH   REG15,OUTRTCD(,OCMTBPTR)                            0213
*         IF OUTRTCD^=ZERO THEN     /* NON-ZERO INDICATES DAIR ERROR */
*                                                                  0214
         LH    @14,OUTRTCD(,OCMTBPTR)                              0214
         LTR   @14,@14                                             0214
         BZ    @RF00214                                            0214
*           /*********************************************************/
*           /*                                                       */
*           /* DAIR ERROR ON ENTRY 08                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0215
*           DO;                                                    0215
*             OUTMSGID=16;          /* DAIR ERROR MSG                */
         MVI   OUTMSGID(OCMTBPTR),X'10'                            0216
*             CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER             */
         ST    OCMTBPTR,@AL00001                                   0217
         L     @15,@CV00338                                        0217
         LA    @01,@AL00001                                        0217
         BALR  @14,@15                                             0217
*             IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & INPUT FROM 0218
*                                      TERM                          */
         TM    ERROR(OCMTBPTR),B'00001000'                         0218
         BNZ   @RF00218                                            0218
         TM    NONTERM(OCMTBPTR),B'00100000'                       0218
         BNZ   @RF00218                                            0218
*               NOMEMNAM(STRCTNUM)=YES;/* SET INDICATOR THAT ALLOC 0219
*                                      FAILED, BUT GIVE USER ANOTHER
*                                      CHANCE IF IN SUBCMD MODE      */
         L     @14,STRCTNUM(,OCMTBPTR)                             0219
         MH    @14,@CH00300                                        0219
         ALR   @14,OCMTBPTR                                        0219
         OI    NOMEMNAM-20(@14),B'00000010'                        0219
*             ELSE                  /* ERROR OR CLIST INPUT          */
*               DO;                                                0220
         B     @RC00218                                            0220
@RF00218 DS    0H                                                  0221
*                 ERROR=YES;        /* INDICATE SERIOUS ERROR        */
         OI    ERROR(OCMTBPTR),B'00001000'                         0221
*                 OUTRTCD=ERRCDE;   /* TERMINATION RETURN CODE       */
         MVC   OUTRTCD(2,OCMTBPTR),@CH00134                        0222
*               END;                                               0223
*           END;                                                   0224
*         ELSE                      /* NO DAIR ERROR                 */
*                                                                  0225
*           /*********************************************************/
*           /*                                                       */
*           /* DATASET ALLOCATED                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0225
*           DO;                                                    0225
         B     @RC00214                                            0225
@RF00214 DS    0H                                                  0226
*             DSALLOC(STRCTNUM)=YES;/* INDICATE DATASET ALLOCATED    */
         L     @14,STRCTNUM(,OCMTBPTR)                             0226
         MH    @14,@CH00300                                        0226
         ST    @14,@TF00001                                        0226
         ALR   @14,OCMTBPTR                                        0226
         OI    DSALLOC-20(@14),B'01000000'                         0226
*             PRINTDDN(STRCTNUM)=DA08DDN;/* PASS DDNAME FOR OPEN     */
*                                                                  0227
         LR    @14,OCMTBPTR                                        0227
         AL    @14,@TF00001                                        0227
         MVC   PRINTDDN-20(8,@14),DA08DDN(DAIRPTR)                 0227
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR AN ACCEPTABLE DSORG - THIS CHECK CANNOT BE*/
*             /* MADE AFTER DAIR ENTRY 04 UNLESS DS WAS ALLOCATED    */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0228
*             IF DA08DSO^=PO&DA08DSO^=PS THEN/* DATASET IS NOT     0228
*                                      PARTITIONED OR SEQUENTIAL     */
         CLI   DA08DSO(DAIRPTR),X'02'                              0228
         BE    @RF00228                                            0228
         CLI   DA08DSO(DAIRPTR),X'40'                              0228
         BE    @RF00228                                            0228
*               DO;                                                0229
*                 OUTMSGID=126;     /* ISSUE IMPROPER DSORG MSG      */
         MVI   OUTMSGID(OCMTBPTR),X'7E'                            0230
*                 CALL IKJCT467(OUTCOMTB);/* ISSUE MSG               */
         ST    OCMTBPTR,@AL00001                                   0231
         L     @15,@CV00338                                        0231
         LA    @01,@AL00001                                        0231
         BALR  @14,@15                                             0231
*                 IF ERROR=NO&NONTERM=NO THEN/* NO ERRORS & TERM   0232
*                                      INPUT                         */
         TM    ERROR(OCMTBPTR),B'00001000'                         0232
         BNZ   @RF00232                                            0232
         TM    NONTERM(OCMTBPTR),B'00100000'                       0232
         BNZ   @RF00232                                            0232
*                   NOMEMNAM(STRCTNUM)=YES;/* SET DSNAME ERROR     0233
*                                      INDICATOR, BUT GIVE USER    0233
*                                      ANOTHER CHANCE IF SUBCMD MODE */
         L     @14,STRCTNUM(,OCMTBPTR)                             0233
         MH    @14,@CH00300                                        0233
         ALR   @14,OCMTBPTR                                        0233
         OI    NOMEMNAM-20(@14),B'00000010'                        0233
*                 ELSE              /* ERROR OR CLIST INPUT          */
*                   ERROR=YES;      /* INDICATE ERROR                */
         B     @RC00232                                            0234
@RF00232 OI    ERROR(OCMTBPTR),B'00001000'                         0234
*                 UNALCALL=YES;     /* INDICATE UNALLOCATION NEEDED  */
@RC00232 OI    UNALCALL(OCMTBPTR),B'00100000'                      0235
*                 ENTRY18=YES;      /* RETURN TO BEGINNING TO UNALLOC*/
         OI    ENTRY18,B'00100000'                                 0236
*               END;                                               0237
*                                                                  0237
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF MEMBER NAME PRESENT FOR PO DATASET - THIS  */
*             /* CHECK CANNOT BE MADE AFTER DAIR ENTRY 04, UNLESS DS */
*             /* WAS ALLOCATED                                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0238
*             ELSE                                                 0238
*               DO;                                                0238
         B     @RC00228                                            0238
@RF00228 DS    0H                                                  0239
*                 IF DA08DSO=PO&DSNFLG2^=DSM THEN/* PARTITIONED WITH
*                                      NO MEMBER NAME SUPPLIED       */
         CLI   DA08DSO(DAIRPTR),X'02'                              0239
         BNE   @RF00239                                            0239
         CLI   DSNFLG2(PDEBASE),128                                0239
         BE    @RF00239                                            0239
*                   DO;                                            0240
*                     OUTMSGID=107; /* MISSING MEMBER, DEFAULT USED  */
         MVI   OUTMSGID(OCMTBPTR),X'6B'                            0241
*                     CALL IKJCT467(OUTCOMTB);/* CALL MSG WRITER     */
         ST    OCMTBPTR,@AL00001                                   0242
         L     @15,@CV00338                                        0242
         LA    @01,@AL00001                                        0242
         BALR  @14,@15                                             0242
*                     DSNFLG2=DSNFLG2×DSM;/* SET PDE BIT FOR MEMBER  */
         LA    @14,128                                             0243
         MVC   @ZT00003+3(1),DSNFLG2(PDEBASE)                      0243
         O     @14,@ZT00003                                        0243
         STC   @14,DSNFLG2(,PDEBASE)                               0243
*                     DSNLTH2=8;    /* LENGTH MEMBERNAME             */
         MVC   DSNLTH2(2,PDEBASE),@CH00045                         0244
*                     DSNMEMAD=ADDR(OUTEMPMN);/* PDE POINTS TO     0245
*                                      MEMBERNAME                    */
         LA    @14,OUTEMPMN(,OCMTBPTR)                             0245
         ST    @14,DSNMEMAD(,PDEBASE)                              0245
*                     MEMNAME=DEFAULT;/* DEFAULT MEMBERNAME          */
         MVC   MEMNAME(8,@14),@CC00335                             0246
*                     ENTRY18=YES;                                 0247
*                     ENTRY08=YES;                                 0248
         OI    ENTRY18,B'01100000'                                 0248
*                   END;                                           0249
*               END;                                               0250
@RF00239 DS    0H                                                  0251
*           END;                    /* END OF DSORG/MEMBER NAME CHECK*/
@RC00228 DS    0H                                                  0252
*       END;                        /* END OF 08 ALLOCATE PROCESSING */
@RC00214 DS    0H                                                  0253
*   END;                            /* END DOWHILE TO PROCESS DAIR 0253
*                                      REQUESTS                    0253
*                                                                    */
@RF00194 DS    0H                                                  0253
@DE00058 TM    ENTRY04,B'11110000'                                 0253
         BNZ   @DL00058                                            0253
*                                                                  0254
*/********************************************************************/
*/*                     RETURN TO CALLER                             */
*/********************************************************************/
*                                                                  0254
*ENDRETRN:                                                         0254
*   RETURN CODE(OUTRTCD);           /* RETURN TO CALLER              */
ENDRETRN LH    @10,OUTRTCD(,OCMTBPTR)                              0254
         L     @13,4(,@13)                                         0254
         L     @00,@SIZDATD                                        0254
         LR    @01,@11                                             0254
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0254
         L     @14,12(,@13)                                        0254
         LM    @00,@12,20(@13)                                     0254
         BR    @14                                                 0254
*   END IKJCT473                                                   0255
*                                                                  0255
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJOCMTB)                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJDAPL )                                       */
*/*%INCLUDE SYSLIB  (IKJDAP04)                                       */
*/*%INCLUDE SYSLIB  (IKJDAP08)                                       */
*/*%INCLUDE SYSLIB  (IKJDAP1C)                                       */
*/*%INCLUDE SYSLIB  (IKJDAP18)                                       */
*                                                                  0255
*       ;                                                          0255
@DATA    DS    0H
@CH00045 DC    H'8'
@CH00134 DC    H'12'
@CH00382 DC    H'36'
@CH00358 DC    H'44'
@CH00316 DC    XL2'0008'
@SM00407 MVC   QUALDSNM(0),NAME(@07)
@SM00410 MVC   DA08MNM(0,DAIRPTR),MEMNAME(@10)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@AL00001 DS    1A
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJCT473 CSECT
         DS    0F
@CF00033 DC    F'1'
@CF00300 DC    F'20'
@CH00300 EQU   @CF00300+2
@CF00304 DC    F'3156'
@DATD    DSECT
         DS    0D
DAIRAREA DS    CL84
DAPBAREA DS    CL40
DAPLSTRG DS    CL20
QUALNAME DS    CL46
         ORG   QUALNAME
QUALDSNL DS    FL2
QUALDSNM DS    CL44
         ORG   QUALNAME+46
SWITCHES DS    BL1
         ORG   SWITCHES
ENTRY04  DS    BL1
ENTRY08  EQU   SWITCHES+0
ENTRY18  EQU   SWITCHES+0
ENTRY1C  EQU   SWITCHES+0
@NM00068 EQU   SWITCHES+0
         ORG   SWITCHES+1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT473 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00338 DC    V(IKJCT467)
         DS    0D
@CC00333 DC    C'.OUTLIST'
@CC00335 DC    C'TEMPNAME'
@CB00314 DC    X'0004'
@CB00316 DC    X'0008'
@CB00318 DC    X'0018'
@CB00320 DC    X'001C'
PATCH73  DS    CL100
         ORG   PATCH73
PTCHINIT DC    20CL5'ZAP73'
         ORG   PATCH73+100
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
PDEBASE  EQU   @04
DAPB1PTR EQU   @06
DAIRPTR  EQU   @02
DAPLPTR  EQU   @05
OCMTBPTR EQU   @03
REG1     EQU   @01
REG15    EQU   @15
OUTCOMTB EQU   0
OUTCPPL  EQU   OUTCOMTB
OUTMSGID EQU   OUTCOMTB+4
OUTFLAGS EQU   OUTCOMTB+5
OUTRTCD  EQU   OUTCOMTB+6
OUTATTN  EQU   OUTCOMTB+24
OUTEMPMN EQU   OUTCOMTB+32
STRCTNUM EQU   OUTCOMTB+96
O73PARM  EQU   OUTCOMTB+100
PRINTDDN EQU   O73PARM+4
@NM00002 EQU   O73PARM+16
DSALLOC  EQU   @NM00002+1
NEWDS    EQU   @NM00002+1
NOMEMNAM EQU   @NM00002+1
OUTKEYWD EQU   OUTCOMTB+146
OUTSW    EQU   OUTCOMTB+148
SUBCMODE EQU   OUTSW
UNALCALL EQU   OUTSW
ERROR    EQU   OUTSW
NONTERM  EQU   OUTSW+1
OUTIDSSW EQU   OUTCOMTB+150
TERM     EQU   OUTIDSSW
OUTDAIR  EQU   OUTCOMTB+156
OUTXMSG  EQU   OUTCOMTB+164
OUTPLIST EQU   OUTCOMTB+260
OPRDSPDE EQU   OUTPLIST+4
OSVDSPDE EQU   OUTCOMTB+284
CPPL     EQU   0
CPPLUPT  EQU   CPPL+4
CPPLPSCB EQU   CPPL+8
CPPLECT  EQU   CPPL+12
DAPL     EQU   0
DAPLUPT  EQU   DAPL
DAPLECT  EQU   DAPL+4
DAPLECB  EQU   DAPL+8
DAPLPSCB EQU   DAPL+12
DAPLDAPB EQU   DAPL+16
DAPB04   EQU   0
DA04CD   EQU   DAPB04
DA04FLG  EQU   DAPB04+2
DA04CAT  EQU   DA04FLG
DA04DSE  EQU   DA04FLG
DA04PDSN EQU   DAPB04+8
DA04CTL  EQU   DAPB04+12
DA04DSO  EQU   DAPB04+15
DAPB08   EQU   0
DA08CD   EQU   DAPB08
DA08FLG  EQU   DAPB08+2
DA08DARC EQU   DAPB08+4
DA08CTRC EQU   DAPB08+6
DA08DDN  EQU   DAPB08+12
DA08UNIT EQU   DAPB08+20
DA08SER  EQU   DAPB08+28
DA08BLK  EQU   DAPB08+36
DA08PQTY EQU   DAPB08+40
DA08SQTY EQU   DAPB08+44
DA08DQTY EQU   DAPB08+48
DA08MNM  EQU   DAPB08+52
DA08PSWD EQU   DAPB08+60
DA08DSP1 EQU   DAPB08+68
DA08NEW  EQU   DA08DSP1
DA08OLD  EQU   DA08DSP1
DA08DPS2 EQU   DAPB08+69
DA08KEEP EQU   DA08DPS2
DA08CAT  EQU   DA08DPS2
DA08DPS3 EQU   DAPB08+70
DA08KEP  EQU   DA08DPS3
DA08CATL EQU   DA08DPS3
DA08CTL  EQU   DAPB08+71
DA08ABKL EQU   DA08CTL
DA08RLSE EQU   DA08CTL
DA08DSO  EQU   DAPB08+75
DAPB1C   EQU   0
DA1CCD   EQU   DAPB1C
DA1CCTL  EQU   DAPB1C+7
DA1CDDN  EQU   DAPB1C+8
DAPB18   EQU   0
DA18CD   EQU   DAPB18
DA18FLG  EQU   DAPB18+2
DA18PDSN EQU   DAPB18+8
DA18DDN  EQU   DAPB18+12
DA18DPS2 EQU   DAPB18+30
DA18CTL  EQU   DAPB18+31
DA18JBNM EQU   DAPB18+32
DSNPDE   EQU   0
DSNAMEAD EQU   DSNPDE
DSNLTH1  EQU   DSNPDE+4
DSNFLG1  EQU   DSNPDE+6
DSNMEMAD EQU   DSNPDE+8
DSNLTH2  EQU   DSNPDE+12
DSNFLG2  EQU   DSNPDE+14
DSNPASAD EQU   DSNPDE+16
DSNLTH3  EQU   DSNPDE+20
NAME     EQU   0
MEMNAME  EQU   0
PASSWORD EQU   0
OUTP     EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00067 EQU   DSNPDE+23
DSNFLG3  EQU   DSNPDE+22
@NM00066 EQU   DSNPDE+15
@NM00065 EQU   DSNPDE+7
@NM00064 EQU   DA18CTL
@NM00063 EQU   DA18CTL
@NM00062 EQU   DA18CTL
@NM00061 EQU   DA18CTL
DA18PERM EQU   DA18CTL
DA18UID  EQU   DA18CTL
@NM00060 EQU   DA18CTL
@NM00059 EQU   DA18CTL
DA18UCAT EQU   DA18DPS2
DA18CAT  EQU   DA18DPS2
DA18DEL  EQU   DA18DPS2
DA18KEEP EQU   DA18DPS2
@NM00058 EQU   DA18DPS2
@NM00057 EQU   DA18DPS2
@NM00056 EQU   DA18DPS2
@NM00055 EQU   DA18DPS2
DA18SCLS EQU   DAPB18+28
DA18MNM  EQU   DAPB18+20
DA18CTRC EQU   DAPB18+6
DA18DARC EQU   DAPB18+4
@NM00054 EQU   DA18FLG
@NM00053 EQU   DA18FLG
@NM00052 EQU   DA18FLG
@NM00051 EQU   DA18FLG
@NM00050 EQU   DA18FLG
@NM00049 EQU   DA18FLG
@NM00048 EQU   DA18FLG
DA18FPE  EQU   DA18FLG
DA1CALN  EQU   DAPB1C+16
@NM00047 EQU   DA1CCTL
DA1CATRL EQU   DA1CCTL
@NM00046 EQU   DA1CCTL
DA1CPERM EQU   DA1CCTL
@NM00045 EQU   DA1CCTL
@NM00044 EQU   DAPB1C+6
DA1CDARC EQU   DAPB1C+4
DA1CFLG  EQU   DAPB1C+2
DA08ALN  EQU   DAPB08+76
@NM00043 EQU   DAPB08+72
@NM00042 EQU   DA08CTL
DA08ATRL EQU   DA08CTL
DA08DMMY EQU   DA08CTL
DA08PERM EQU   DA08CTL
DA08UID  EQU   DA08CTL
DA08TRKS EQU   DA08CTL
DA08UNCT EQU   DA08DPS3
DA08DELE EQU   DA08DPS3
@NM00041 EQU   DA08DPS3
@NM00040 EQU   DA08DPS3
@NM00039 EQU   DA08DPS3
@NM00038 EQU   DA08DPS3
DA08UCAT EQU   DA08DPS2
DA08DEL  EQU   DA08DPS2
@NM00037 EQU   DA08DPS2
@NM00036 EQU   DA08DPS2
@NM00035 EQU   DA08DPS2
@NM00034 EQU   DA08DPS2
DA08MOD  EQU   DA08DSP1
DA08SHR  EQU   DA08DSP1
@NM00033 EQU   DA08DSP1
@NM00032 EQU   DA08DSP1
@NM00031 EQU   DA08DSP1
@NM00030 EQU   DA08DSP1
DA08PDSN EQU   DAPB08+8
@NM00029 EQU   DA08FLG
@NM00028 EQU   DA08FLG
@NM00027 EQU   DA08FLG
@NM00026 EQU   DA08FLG
@NM00025 EQU   DA08FLG
@NM00024 EQU   DA08FLG
@NM00023 EQU   DA08FLG
DA08FPE  EQU   DA08FLG
@NM00022 EQU   DAPB04+13
@NM00021 EQU   DA04CTL
@NM00020 EQU   DA04CTL
@NM00019 EQU   DA04CTL
@NM00018 EQU   DA04CTL
@NM00017 EQU   DA04CTL
DA04UID  EQU   DA04CTL
@NM00016 EQU   DA04CTL
@NM00015 EQU   DA04CTL
DA04CTRC EQU   DAPB04+6
@NM00014 EQU   DAPB04+4
@NM00013 EQU   DA04FLG
@NM00012 EQU   DA04FLG
@NM00011 EQU   DA04FLG
@NM00010 EQU   DA04FLG
@NM00009 EQU   DA04FLG
@NM00008 EQU   DA04FLG
CPPLCBUF EQU   CPPL
IOPLAREA EQU   OUTCOMTB+296
IOPLPTR  EQU   OUTCOMTB+292
EWAPTR   EQU   OUTCOMTB+288
OUTCLPDE EQU   OUTCOMTB+280
OUTJBPDE EQU   OUTCOMTB+276
ODESTPDE EQU   OUTPLIST+12
ONEWCPDE EQU   OUTPLIST+8
OUTCPDE1 EQU   OUTPLIST
OSYSODDN EQU   OUTCOMTB+252
CLASBUFF EQU   OUTCOMTB+244
OUTWORK  EQU   OUTCOMTB+196
OUTSTAE  EQU   OUTCOMTB+188
OUTSBBUF EQU   OUTCOMTB+184
OUTSBPDL EQU   OUTCOMTB+180
OHELPECB EQU   OUTCOMTB+176
OUTTCBH  EQU   OUTCOMTB+172
OUTXRPLY EQU   OUTCOMTB+168
OUTSYNMS EQU   OUTXMSG
OUTPDL   EQU   OUTCOMTB+160
OUTDARB  EQU   OUTCOMTB+152
@NM00007 EQU   OUTIDSSW
INTRPMSG EQU   OUTIDSSW
ALLOC    EQU   OUTIDSSW
EODSW    EQU   OUTIDSSW
@NM00006 EQU   OUTIDSSW
@NM00005 EQU   OUTIDSSW
POINT    EQU   OUTIDSSW
ENDLIST  EQU   OUTSW+1
WORKDONE EQU   OUTSW+1
OPENED   EQU   OUTSW+1
SYNADERR EQU   OUTSW+1
HASPABND EQU   OUTSW
NOWORK   EQU   OUTSW
ENDKEEP  EQU   OUTSW
ENDSW    EQU   OUTSW
SUBSYS   EQU   OUTSW
SUBNEXT  EQU   OUTKEYWD+1
SUBBEGN  EQU   OUTKEYWD+1
SUBHERE  EQU   OUTKEYWD+1
SUBCONT  EQU   OUTKEYWD+1
DEST     EQU   OUTKEYWD+1
KEEP     EQU   OUTKEYWD+1
NEWCLASS EQU   OUTKEYWD
PRINT    EQU   OUTKEYWD
DELETE   EQU   OUTKEYWD
NEXT     EQU   OUTKEYWD
BEGIN    EQU   OUTKEYWD
HERE     EQU   OUTKEYWD
HOLD     EQU   OUTKEYWD
PAUSE    EQU   OUTKEYWD
OUTRECL  EQU   OUTCOMTB+144
OUTRECA  EQU   OUTCOMTB+140
OUTBUFL  EQU   @NM00002+2
OUTRECUN EQU   @NM00002+1
NEEDFREE EQU   @NM00002+1
OUTRECV  EQU   @NM00002+1
DSOPEN   EQU   @NM00002+1
@NM00004 EQU   @NM00002+1
@NM00003 EQU   @NM00002
OUTBUFA  EQU   O73PARM+12
OUTDCB   EQU   O73PARM
OUTBKCNT EQU   OUTCOMTB+92
OUTBKAPX EQU   OUTCOMTB+84
OUTBKNEW EQU   OUTCOMTB+76
OUTHOLD  EQU   OUTCOMTB+68
OUTEMPSB EQU   OUTCOMTB+64
OUTACBL  EQU   OUTCOMTB+60
OUTACB   EQU   OUTCOMTB+56
OUTRPLL  EQU   OUTCOMTB+52
OUTRPL   EQU   OUTCOMTB+48
OUTSOBSO EQU   OUTCOMTB+44
OUTSOBH  EQU   OUTCOMTB+40
OUTEXTRA EQU   OUTCOMTB+28
POSTED   EQU   OUTATTN
@NM00001 EQU   OUTATTN
OUTCMDNM EQU   OUTCOMTB+16
OUTMACN  EQU   OUTCOMTB+8
KEY1     EQU   OUTFLAGS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00110 EQU   @RC00105
@RF00141 EQU   @RC00133
@RF00155 EQU   @RC00133
@RC00143 EQU   @RC00133
@RC00218 EQU   @RC00214
@RC00148 EQU   @RC00143
@ENDDATA EQU   *
         END   IKJCT473

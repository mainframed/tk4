         TITLE 'IKJCT433, EXEC CONTROL MODULE - PHASE II PART I        *
                        '
IKJCT433 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IKJCT433  77.215'                                 0001
IKJUPDT  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00356-IKJUPDT)
         ENTRY IKJUPDT
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         L     @00,@SIZDATD                                        0001
         IKJEXEC  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @15,@01,16(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 MVC   @PC00001(20),0(@01)                                 0001
*                                                                  0035
*   /*****************************************************************/
*   /*                                                               */
*   /* START OF EXECUTABLE CODE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0035
*   CALL INTSETUP;                  /* INIT MAIN SWITCHES - VARIABLES*/
         BAL   @14,INTSETUP                                        0035
*   OLDLINE=GTPBLINE;               /* POINT TO OLD RECORD           */
         L     @15,@PC00001+12                                     0036
         L     @15,GTPBLINE(,@15)                                  0036
         ST    @15,OLDLINE(,COMONPTR)                              0036
*   SCANLIM=F0;                     /* CLEAR SCAN LIMIT              */
         SLR   @15,@15                                             0037
         ST    @15,SCANLIM                                         0037
*   ERCOM=F0;                       /* INIT ERROR COUNTER (COMMON)   */
         ST    @15,ERCOM(,COMONPTR)                                0038
*   CONTINU=YES;                    /* ALLOW CONTINUING              */
         OI    CONTINU(COMONPTR),B'01000000'                       0039
*   STM(R9,R12,REGAREA);            /* SAVE PHASE2 PART 1 REGS       */
         STM   R9,R12,REGAREA(COMONPTR)                            0040
*   DO WHILE CONTINU=YES;           /* PROCESS UNTIL DONE            */
         B     @DE00041                                            0041
@DL00041 DS    0H                                                  0042
*     EXECDPTR=LSDEXEC;             /* BASE EXEC DATA ON PTR IN LSD  */
         L     @01,LSDPTR(,COMONPTR)                               0042
         L     @15,LSDEXEC(,@01)                                   0042
         ST    @15,EXECDPTR(,COMONPTR)                             0042
*     ERROR=F0;                     /* INIT ERROR COUNTER TO ZERO    */
         SLR   @14,@14                                             0043
         ST    @14,ERROR                                           0043
*     SWS=''B;                      /* CLEAR INIT SWITCHES           */
         XC    SWS(5,COMONPTR),SWS(COMONPTR)                       0044
*     NEWBASE=MIN(BUFBASE,NEWBASE); /* POINTER TO OLD BUFFER IF ONE  */
         L     @14,BUFBASE(,COMONPTR)                              0045
         L     @07,NEWBASE(,COMONPTR)                              0045
         CR    @14,@07                                             0045
         BNH   *+6
         LR    @14,@07                                             0045
         ST    @14,NEWBASE(,COMONPTR)                              0045
*     BUFBASE=GTPBLINE;             /* SET BASE TO LINE PASSED       */
         L     @14,@PC00001+12                                     0046
         L     @14,GTPBLINE(,@14)                                  0046
         ST    @14,BUFBASE(,COMONPTR)                              0046
*     IF GTPBLINE>=ERACTSTR&GTPBLINE<ERACTEND&/* IF ERROR ACTIVE     */
*         ERINCNTL=YES THEN         /* AND WITHIN RANGE              */
         C     @14,ERACTSTR(,@15)                                  0047
         BL    @RF00047                                            0047
         C     @14,ERACTEND(,@15)                                  0047
         BNL   @RF00047                                            0047
         TM    ERINCNTL(@15),B'00001000'                           0047
         BNO   @RF00047                                            0047
*       ERRRANGE=YES;               /* SET ERROR RANGE INDICATOR     */
         OI    ERRRANGE(COMONPTR),B'00000100'                      0048
*     ELSE                          /* OTHERWISE                     */
*       IF ERINCNTL=YES THEN        /* IF DROPPING OUT OF ERROR      */
         B     @RC00047                                            0049
@RF00047 L     @15,EXECDPTR(,COMONPTR)                             0049
         TM    ERINCNTL(@15),B'00001000'                           0049
         BNO   @RF00049                                            0049
*         DO;                       /* SWAP RETURN POINTERS          */
*           RETPTR=RETPTR&&RETPTR2; /*                               */
         L     @14,RETPTR2(,@15)                                   0051
         L     @07,RETPTR(,@15)                                    0051
         XR    @07,@14                                             0051
         ST    @07,RETPTR(,@15)                                    0051
*           RETPTR2=RETPTR2&&RETPTR;/*                               */
         XR    @14,@07                                             0052
         ST    @14,RETPTR2(,@15)                                   0052
*           RETPTR=RETPTR&&RETPTR2; /*                               */
         XR    @07,@14                                             0053
         ST    @07,RETPTR(,@15)                                    0053
*           ERINCNTL=NO;            /* RESET SWITCH                  */
         NI    ERINCNTL(@15),B'11110111'                           0054
*         END;                      /*                               */
*     IF GTPBLINE>=ATACTSTR&GTPBLINE<ATACTEND&/* IF ERROR ACTIVE     */
*         ATINCNTL=YES THEN         /* AND WITHIN RANGE              */
@RF00049 DS    0H                                                  0056
@RC00047 L     @15,@PC00001+12                                     0056
         L     @15,GTPBLINE(,@15)                                  0056
         L     @14,EXECDPTR(,COMONPTR)                             0056
         C     @15,ATACTSTR(,@14)                                  0056
         BL    @RF00056                                            0056
         C     @15,ATACTEND(,@14)                                  0056
         BNL   @RF00056                                            0056
         TM    ATINCNTL(@14),B'10000000'                           0056
         BNO   @RF00056                                            0056
*       ATRANGE=YES;                /* SET ERROR RANGE INDICATOR     */
         OI    ATRANGE(COMONPTR),B'00000010'                       0057
*     ELSE                          /* OTHERWISE                     */
*       IF ATINCNTL=YES THEN        /* IF DROPPING OUT OF ERROR      */
         B     @RC00056                                            0058
@RF00056 L     @15,EXECDPTR(,COMONPTR)                             0058
         TM    ATINCNTL(@15),B'10000000'                           0058
         BNO   @RF00058                                            0058
*         DO;                       /* SWAP RETURN POINTERS          */
*           RETPTR=RETPTR&&RETPTR2; /*                               */
         L     @14,RETPTR2(,@15)                                   0060
         L     @07,RETPTR(,@15)                                    0060
         XR    @07,@14                                             0060
         ST    @07,RETPTR(,@15)                                    0060
*           RETPTR2=RETPTR2&&RETPTR;/*                               */
         XR    @14,@07                                             0061
         ST    @14,RETPTR2(,@15)                                   0061
*           RETPTR=RETPTR&&RETPTR2; /*                               */
         XR    @07,@14                                             0062
         ST    @07,RETPTR(,@15)                                    0062
*           ATINCNTL=NO;            /* RESET SWITCH                  */
         NI    ATINCNTL(@15),B'01111111'                           0063
*         END;                      /*                               */
*     IF ECTATTN=YES THEN           /* IF TMP ATTN ENTRY      @Z30969*/
@RF00058 DS    0H                                                  0065
@RC00056 L     @15,@PC00001+4                                      0065
         TM    ECTATTN(@15),B'00000001'                            0065
         BNO   @RF00065                                            0065
*       DO;                         /* PROCESS                       */
*         ECTATTN=NO;               /* RESET ENTRY                   */
         NI    ECTATTN(@15),B'11111110'                            0067
*         ATINCNTL=YES;             /* SET CNTL BIT                  */
         L     @01,EXECDPTR(,COMONPTR)                             0068
         OI    ATINCNTL(@01),B'10000000'                           0068
*         CALL RETUPDT(GTPBLINE);   /* SET RETURN POINTER            */
         L     @15,@PC00001+12                                     0069
         LA    @15,GTPBLINE(,@15)                                  0069
         ST    @15,@AL00001                                        0069
         LA    @01,@AL00001                                        0069
         BAL   @14,RETUPDT                                         0069
*         LSDANEXT=ATACTSTR;        /* BRANCH TO ACTION START        */
         L     @15,LSDPTR(,COMONPTR)                               0070
         L     @14,EXECDPTR(,COMONPTR)                             0070
         L     @14,ATACTSTR(,@14)                                  0070
         ST    @14,LSDANEXT(,@15)                                  0070
*         ERROR=E4;                 /* GET ANOTHER COMMAND           */
         MVC   ERROR(4),@CF00107                                   0071
*         GTPBLINE=LSDANEXT;        /* SAVE LSDANEXT         @ZA08099*/
         L     @07,@PC00001+12                                     0072
         ST    @14,GTPBLINE(,@07)                                  0072
*         LSDANEXT=LSDANEXT+LSDANEXT->LL;/* UPDATE LSD POINTER     0073
*                                                            @ZA08099*/
         LH    @07,LL(,@14)                                        0073
         ALR   @07,@14                                             0073
         ST    @07,LSDANEXT(,@15)                                  0073
*         GOTO FASTCYCL;            /* START MAIN LOOP AGAIN @ZA08099*/
         B     FASTCYCL                                            0074
*       END;                        /*                               */
*                                                                  0076
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS RETURN CODES                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0076
*     ERRSAV=ECTRTCD;               /* SAVE ECT RETURN CODE          */
@RF00065 L     @15,@PC00001+4                                      0076
         L     @14,ECTRTCD-1(,@15)                                 0076
         LA    @14,0(,@14)                                         0076
         ST    @14,ERRSAV                                          0076
*     IF ECTRCDF=ABNDFLG THEN       /* IF CODE IS ABEND              */
         CLI   ECTRCDF(@15),X'80'                                  0077
         BNE   @RF00077                                            0077
*       RCABEND=YES;                /* USE ABEND CONVERSION          */
         OI    RCABEND(COMONPTR),B'10000000'                       0078
*     IF ERRSAV^=F0 THEN            /* IF TSO CMD ENDED IN ERROR     */
@RF00077 L     @15,ERRSAV                                          0079
         LTR   @15,@15                                             0079
         BZ    @RF00079                                            0079
*       DO;                         /*                               */
*         IF ERRCMD=NO THEN         /* AN NO ERROR IN EFFECT         */
         L     @01,EXECDPTR(,COMONPTR)                             0081
         TM    ERRCMD(@01),B'01000000'                             0081
         BNZ   @RF00081                                            0081
*           CALL RCUPDT;            /* UPDATE LASTCC AND MAXCC       */
         BAL   @14,RCUPDT                                          0082
*         ELSE                      /* OTHERWISE                     */
*           DO;                     /* CHECK IF ERROR ALREADY IN CNTL*/
         B     @RC00081                                            0083
@RF00081 DS    0H                                                  0084
*             IF ERRRANGE=YES THEN  /* IF IT IS THEN SET ERROR CODE  */
         TM    ERRRANGE(COMONPTR),B'00000100'                      0084
         BNO   @RF00084                                            0084
*               IF GTPBLINE^=ERACTSTR THEN/* NOT FIRST ERROR CMD     */
         L     @15,@PC00001+12                                     0085
         L     @01,EXECDPTR(,COMONPTR)                             0085
         CLC   GTPBLINE(4,@15),ERACTSTR(@01)                       0085
         BE    @RF00085                                            0085
*                 DO;               /* MUST HAVE BEEN A TSO COMMAND  */
*                   BACKUP=YES;     /* BACK UP AND LIST LAST TSO     */
         OI    BACKUP(COMONPTR),B'00000001'                        0087
*                   ERROR=E908;     /*                               */
         MVC   ERROR(4),@CF00785                                   0088
*                 END;              /*                               */
*               ELSE                                               0090
*                 ;                 /* OTHERWISE NOTHING             */
@RF00085 DS    0H                                                  0091
*             ELSE                  /* OTHERWISE GIVE ERRACTION CNTL */
*               DO;                 /*                               */
         B     @RC00084                                            0091
@RF00084 DS    0H                                                  0092
*                 CALL RCUPDT;      /* PROCESS MAXCC AND LASTCC      */
         BAL   @14,RCUPDT                                          0092
*                 IF ERACTSTR^=F0 THEN/* IF A ERROR ACTION SPECIFIED */
         L     @15,EXECDPTR(,COMONPTR)                             0093
         L     @14,ERACTSTR(,@15)                                  0093
         LTR   @14,@14                                             0093
         BZ    @RF00093                                            0093
*                   DO;             /* GO TO ERRACTION               */
*                     ERINCNTL=YES; /* SET ERROR IN CONTROL          */
         OI    ERINCNTL(@15),B'00001000'                           0095
*                     CALL RETUPDT(GTPBLINE);/* UPDATE RETURN POINT  */
         L     @15,@PC00001+12                                     0096
         LA    @15,GTPBLINE(,@15)                                  0096
         ST    @15,@AL00001                                        0096
         LA    @01,@AL00001                                        0096
         BAL   @14,RETUPDT                                         0096
*                     LSDANEXT=ERACTSTR;/* UPDATE LSD NEXT CMD       */
         L     @01,LSDPTR(,COMONPTR)                               0097
         L     @15,EXECDPTR(,COMONPTR)                             0097
         L     @00,ERACTSTR(,@15)                                  0097
         ST    @00,LSDANEXT(,@01)                                  0097
*                     ERROR=E4;     /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00107                                   0098
*                     GOTO FASTEXIT;/* GET NEXT COMMAND              */
         B     FASTEXIT                                            0099
*                   END;            /*                               */
*                 ELSE              /* IF NO ERROR ACTION, SET UP    */
*                   IF INSLIST=NO THEN/* TSO NOT ALREADY LISTED      */
@RF00093 L     @15,@PC00001+4                                      0101
         L     @01,ECTIOWA(,@15)                                   0101
         L     @01,IOSTELM(,@01)                                   0101
         TM    INSLIST(@01),B'00000001'                            0101
         BNZ   @RF00101                                            0101
*                     BACKUP=YES;   /* BACKUP TO LIST TSO            */
         OI    BACKUP(COMONPTR),B'00000001'                        0102
*               END;                /*                               */
@RF00101 DS    0H                                                  0104
*             IF BACKUP=YES THEN    /* BACK UP AND LIST ?            */
@RC00084 TM    BACKUP(COMONPTR),B'00000001'                        0104
         BNO   @RF00104                                            0104
*               DO;                 /* YES -                         */
*                 LSDANEXT=GTPBLINE;/* BACK UP LSD COMMAND POINTER   */
         L     @01,LSDPTR(,COMONPTR)                               0106
         L     @15,@PC00001+12                                     0106
         L     @00,GTPBLINE(,@15)                                  0106
         ST    @00,LSDANEXT(,@01)                                  0106
*                 GTPBLINE=LASTTSO; /* GET TSO COMMAND               */
         L     @01,EXECDPTR(,COMONPTR)                             0107
         L     @14,LASTTSO(,@01)                                   0107
         ST    @14,GTPBLINE(,@15)                                  0107
*                 BUFBASE=LASTTSO;  /* POINT BUFFER TO LAST TSO CMD  */
         ST    @14,BUFBASE(,COMONPTR)                              0108
*                 LISTONLY=YES;     /* LIST COMMAND ONLY             */
         OI    LISTONLY(COMONPTR),B'00100000'                      0109
*               END;                /*                               */
*           END;                    /*                               */
@RF00104 DS    0H                                                  0112
*         ECTRTCD=F0;               /* ZERO ECT RETURN CODE          */
@RC00081 L     @15,@PC00001+4                                      0112
         SLR   @14,@14                                             0112
         STCM  @14,7,ECTRTCD(@15)                                  0112
*         ECTRCDF=''B;              /* ZERO ABEND FLAG IF ON         */
         MVI   ECTRCDF(@15),X'00'                                  0113
*       END;                        /*                               */
*     ELSE                          /* IF RETURN CODE WAS ZERO       */
*       IF ERRRANGE=NO THEN         /* AND NOT IN ERROR RANGE        */
         B     @RC00079                                            0115
@RF00079 TM    ERRRANGE(COMONPTR),B'00000100'                      0115
         BNZ   @RF00115                                            0115
*         CALL RCUPDT;              /* UPDATE RETURN CODES           */
         BAL   @14,RCUPDT                                          0116
*     RCABEND=NO;                   /* INSURE ABEND CLEAR            */
@RF00115 DS    0H                                                  0117
@RC00079 NI    RCABEND(COMONPTR),B'01111111'                       0117
*                                                                  0118
*     /***************************************************************/
*     /*                                                             */
*     /* SYMBOLIC SUBSTITUTION INITIALIZATION                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0118
*     OLDLINE=GTPBLINE;             /* BASE FOR OLD LINE WITH PARMS  */
         L     @15,@PC00001+12                                     0118
         L     @15,GTPBLINE(,@15)                                  0118
         ST    @15,OLDLINE(,COMONPTR)                              0118
*     V2=F0;                        /* INIT TO ZERO                  */
         SLR   @15,@15                                             0119
         ST    @15,V2                                              0119
*     MYO2=O2-OO+F1;                /* SET OFFSET TO START OF SCAN   */
         L     @15,BUFBASE(,COMONPTR)                              0120
         LH    @14,OO(,@15)                                        0120
         LH    @15,O2(,@15)                                        0120
         SLR   @15,@14                                             0120
         AL    @15,@CF00042                                        0120
         ST    @15,MYO2(,COMONPTR)                                 0120
*     IF CORE=NO THEN               /* IF NO CORE HAS BEEN GOTTEN    */
         TM    CORE(COMONPTR),B'10000000'                          0121
         BNZ   @RF00121                                            0121
*       CALL GETMORE(EVAL(-OO));    /* GETMAIN FOR NEW BUFFER        */
         LCR   @14,@14                                             0122
         ST    @14,@AFTEMPS+4                                      0122
         LA    @15,@AFTEMPS+4                                      0122
         ST    @15,@AL00001                                        0122
         LA    @01,@AL00001                                        0122
         BAL   @14,GETMORE                                         0122
*     ELSE                          /* IF OTHER THAN FIRST LOOP      */
*       IF LL>NEWLL THEN            /* IF NEW LINE BIGGER THAN GOTTEN*/
         B     @RC00121                                            0123
@RF00121 L     @01,BUFBASE(,COMONPTR)                              0123
         L     @15,NEWBASE(,COMONPTR)                              0123
         LH    @15,NEWLL(,@15)                                     0123
         CH    @15,LL(,@01)                                        0123
         BNL   @RF00123                                            0123
*         DO;                       /* CORE, GET MORE CORE           */
*           DO;                     /* FREEMAIN LV(NEWLL*2)        0125
*                                      A(NEWBASE) SP(1) MF(E,FRELST) */
*             RESPECIFY                                            0126
*              (GPR01P) RESTRICTED;                                0126
*             FRELST02=NEWLL*2;     /* LENGTH                        */
         ALR   @15,@15                                             0127
         STCM  @15,7,FRELST02                                      0127
*             FRELST04=ADDR(NEWBASE);/* ADDR OF ADDR LIST            */
         LA    @00,NEWBASE(,COMONPTR)                              0128
         STCM  @00,7,FRELST04                                      0128
*             FRELST06=1;           /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'01'                                      0129
*             GPR01P=ADDR(FRELST);  /* REG1 POINTS TO LIST           */
         LA    GPR01P,FRELST                                       0130
*             SVC(5);               /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0131
*             RESPECIFY                                            0132
*              (GPR01P) UNRESTRICTED;                              0132
*           END;                    /* FREEMAIN LV(NEWLL*2)        0133
*                                      A(NEWBASE) SP(1) MF(E,FRELST) */
*           CORE=NO;                /* YES WE HAVE NO CORE TODAY     */
         NI    CORE(COMONPTR),B'01111111'                          0134
*           CALL GETMORE(EVAL(-OO));/* MINIMUM CORE REQIRED          */
         L     @01,BUFBASE(,COMONPTR)                              0135
         LH    @15,OO(,@01)                                        0135
         LCR   @15,@15                                             0135
         ST    @15,@AFTEMPS+4                                      0135
         LA    @15,@AFTEMPS+4                                      0135
         ST    @15,@AL00001                                        0135
         LA    @01,@AL00001                                        0135
         BAL   @14,GETMORE                                         0135
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE                     */
*         FREEAMT=NEWLL-(LL-OO);    /* SET FREEAMT                   */
         B     @RC00123                                            0137
@RF00123 L     @01,NEWBASE(,COMONPTR)                              0137
         L     @15,BUFBASE(,COMONPTR)                              0137
         LH    @14,LL(,@15)                                        0137
         SH    @14,OO(,@15)                                        0137
         LCR   @14,@14                                             0137
         AH    @14,NEWLL(,@01)                                     0137
         ST    @14,FREEAMT(,COMONPTR)                              0137
*                                                                  0138
*     /***************************************************************/
*     /*                                                             */
*     /* COPY INPUT BUFFER TO GOTTEN BUFFER                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0138
*     RFY                                                          0138
*      (R2,                                                        0138
*       R3,                                                        0138
*       R4,                                                        0138
*       R5) RSTD;                   /* RESTRICT REGS FOR MVCL        */
@RC00123 DS    0H                                                  0138
@RC00121 DS    0H                                                  0139
*     R2=(ADDR(NEWC(1)));           /* POINTER TO 'TO' BUFFER        */
         L     @15,NEWBASE(,COMONPTR)                              0139
         LA    R2,NEWC(,@15)                                       0139
*     R4=ADDR(C(OO+1));             /* POINTER TO 'FROM' BUFFER      */
         L     @14,BUFBASE(,COMONPTR)                              0140
         LH    @07,OO(,@14)                                        0140
         LA    R4,C(@07,@14)                                       0140
*     R3=NEWLL-F4;                  /* LENGTH OF 'TO' BUFFER         */
         LA    @06,4                                               0141
         LH    R3,NEWLL(,@15)                                      0141
         SLR   R3,@06                                              0141
*     R5=(LL-(F4+OO))×BLANKS;       /* LENGTH OF 'FROM' BUFFER AND 0142
*                                      PADDING CHARACTER FOR MVCL    */
         ALR   @07,@06                                             0142
         LCR   @07,@07                                             0142
         AH    @07,LL(,@14)                                        0142
         O     @07,@CF00622                                        0142
         LR    R5,@07                                              0142
*     MVCL(R2,R4);                  /* MOVE TO NEW BUFFER            */
         MVCL  R2,R4                                               0143
*     RFY                                                          0144
*      (R2,                                                        0144
*       R3,                                                        0144
*       R4,                                                        0144
*       R5) UNRSTD;                 /* RELEASE REGISTERS             */
*     BUFBASE=NEWBASE;              /* POINT TO GOTTEN BUFFER        */
         L     @15,NEWBASE(,COMONPTR)                              0145
         ST    @15,BUFBASE(,COMONPTR)                              0145
*     OO=F0;                        /* ZERO OFFSET FIELD             */
         SLR   @14,@14                                             0146
         STH   @14,OO(,@15)                                        0146
*     NEWBASE=NEWBASE+LL;           /* POINT TO NEW BUFFER           */
         LH    @07,LL(,@15)                                        0147
         ALR   @15,@07                                             0147
         ST    @15,NEWBASE(,COMONPTR)                              0147
*     IF ERROR=E16 THEN             /* IF A GETMAIN ERROR OCCURRED   */
         L     @06,ERROR                                           0148
         C     @06,@CF00104                                        0148
         BE    @RT00148                                            0148
*       GO TO FASTEXIT;             /* PROCESS ERROR MSG AND QUIT    */
*     CORE=YES;                     /* CORE HAS BEEN GOTTEN          */
         OI    CORE(COMONPTR),B'10000000'                          0150
*     NEWLL=LL;                     /* INIT LENGTH                   */
         STH   @07,NEWLL(,@15)                                     0151
*     NEWOO=F0;                     /* INIT OFFSET                   */
         STH   @14,NEWOO(,@15)                                     0152
*     IF ERROR=F0 THEN              /* IF OK SO FAR                  */
         CR    @06,@14                                             0153
         BNE   @RF00153                                            0153
*       DO;                         /* LOCATE SYSDLM                 */
*         CALL LOCATE(SYSSCAN,LENGTH(SYSSCAN),F0);/* LOCATE SYSSCAN  */
         LA    @01,@AL00155                                        0155
         BAL   @14,LOCATE                                          0155
*         IF ERROR=F0 THEN          /* IF LOCATE SUCCESSFUL          */
         L     @15,ERROR                                           0156
         LTR   @15,@15                                             0156
         BNZ   @RF00156                                            0156
*           DO;                     /* PROCESS VALUE                 */
*             ANSPTR=ADDR(SVTDATA); /* POINT TO SCAN DATA            */
         L     @01,SNTELPTR(,COMONPTR)                             0158
         L     @15,SNTVLPTR(,@01)                                  0158
         LA    @14,SVTDATA(,@15)                                   0158
         ST    @14,ANSPTR(,COMONPTR)                               0158
*             CLEN=SVTLNG;          /* LENGTH OF SCAN NUMBER         */
         LH    @15,SVTLNG(,@15)                                    0159
         STH   @15,CLEN(,COMONPTR)                                 0159
*             CALL CONVERT;         /* CONVERT TO USABLE FORM        */
         BAL   @14,CONVERT                                         0160
*             SCANLIM=V2;           /* SET SCAN LIMIT                */
         L     @15,V2                                              0161
         ST    @15,SCANLIM                                         0161
*             IF ERROR^=F0 THEN     /* VONVERT OK                    */
         L     @15,ERROR                                           0162
         LTR   @15,@15                                             0162
         BZ    @RF00162                                            0162
*               ERROR=E960;         /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00811                                   0163
*           END;                    /*                               */
*         ELSE                      /* OTHERWISE                     */
*           ERROR=E999;             /* SET ERROR CODE                */
         B     @RC00156                                            0165
@RF00156 MVC   ERROR(4),@CF00817                                   0165
*       END;                                                       0166
@RC00156 DS    0H                                                  0167
*     IF SYMLST=YES THEN            /* SYMBOL LIST SPECIFIED ?       */
@RF00153 L     @01,EXECDPTR(,COMONPTR)                             0167
         TM    SYMLST(@01),B'00010000'                             0167
         BNO   @RF00167                                            0167
*       CALL CMDLST;                /* LIST COMMAND                  */
         BAL   @14,CMDLST                                          0168
*     IF OPCODE=IFCODE THEN         /* ON IF CMD, REMOVE 'THEN'      */
@RF00167 L     @01,OLDLINE(,COMONPTR)                              0169
         CLI   OPCODE(@01),2                                       0169
         BNE   @RF00169                                            0169
*       FREEAMT=FREEAMT+F4;         /* LOGICALLY REMOVE THEN         */
         LA    @15,4                                               0170
         AL    @15,FREEAMT(,COMONPTR)                              0170
         ST    @15,FREEAMT(,COMONPTR)                              0170
*                                                                  0171
*     /***************************************************************/
*     /*                                                             */
*     /* SYMBOLIC SUBSTITUTION MAINLINE                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0171
*     DO Z=1 TO SCANLIM WHILE EXITA=NO&ERROR=F0;/* SUB TO SCANLIM OR
*                                      DONE                          */
@RF00169 LA    @15,1                                               0171
         B     @DE00171                                            0171
@DL00171 TM    EXITA(COMONPTR),B'10000000'                         0171
         BNZ   @DC00171                                            0171
         L     @15,ERROR                                           0171
         LTR   @15,@15                                             0171
         BNZ   @DC00171                                            0171
*       EXITA=YES;                  /* CAUSE END UNLESS INSERT HAS 0172
*                                      BEEN CALLED AT LEAST ONCE     */
         OI    EXITA(COMONPTR),B'10000000'                         0172
*       DO I=MYO2 TO LL-(F4+FREEAMT) WHILE ERROR=F0;/* SCAN RECORD   */
         L     @15,MYO2(,COMONPTR)                                 0173
         B     @DE00173                                            0173
@DL00173 L     @15,ERROR                                           0173
         LTR   @15,@15                                             0173
         BNZ   @DC00173                                            0173
*         IF C(I)=AMPSAND THEN      /* IF AN AMPERSAND               */
         L     @15,I(,COMONPTR)                                    0174
         L     @14,BUFBASE(,COMONPTR)                              0174
         ALR   @14,@15                                             0174
         CLI   C-1(@14),C'&&'                                      0174
         BNE   @RF00174                                            0174
*           DO;                     /*                               */
*             I=I+F1;               /* SKIP AMPERSAND                */
         AL    @15,@CF00042                                        0176
         ST    @15,I(,COMONPTR)                                    0176
*             V=I;                  /* SAVE START OF VARIABLE        */
         ST    @15,V                                               0177
*             CALL SCANWORD;        /* SCAN FOR VALID CHARS          */
         BAL   @14,SCANWORD                                        0178
*             IF C(I)=PERIOD THEN   /* IF A CONCAT '.', SQUASH IT OUT*/
         L     @01,I(,COMONPTR)                                    0179
         L     @15,BUFBASE(,COMONPTR)                              0179
         ALR   @15,@01                                             0179
         CLI   C-1(@15),C'.'                                       0179
         BNE   @RF00179                                            0179
*               CALL SQUASH;        /* GET RID OF PERIOD             */
         BAL   @14,SQUASH                                          0180
*             IF LEN=F0 THEN        /* IF ONLY AN AMPERSAND          */
@RF00179 L     @15,LEN(,COMONPTR)                                  0181
         LTR   @15,@15                                             0181
         BNZ   @RF00181                                            0181
*               IF C(I)^=AMPSAND THEN/* IF NOT DOUBLE AMPERSANDS     */
         L     @01,I(,COMONPTR)                                    0182
         L     @15,BUFBASE(,COMONPTR)                              0182
         ALR   @15,@01                                             0182
         CLI   C-1(@15),C'&&'                                      0182
         BE    @RF00182                                            0182
*                 ERROR=E900;       /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00781                                   0183
*               ELSE                                               0184
*                 ;                 /* OTHERWISE NOTHING             */
@RF00182 DS    0H                                                  0185
*             ELSE                  /* OTHERWISE SUBSTITUTE VALUE    */
*               CALL INSERT;        /* CALL INSERT ROUTINE           */
         B     @RC00181                                            0185
@RF00181 BAL   @14,INSERT                                          0185
*           END;                                                   0186
*         ELSE                      /* IF NOT AN & CHECK FOR COMMENT */
*           IF I<LL-(FREEAMT+F4)&C(I:I+F1)=OPENCMT THEN/*            */
         B     @RC00174                                            0187
@RF00174 L     @15,I(,COMONPTR)                                    0187
         L     @14,BUFBASE(,COMONPTR)                              0187
         LA    @07,4                                               0187
         AL    @07,FREEAMT(,COMONPTR)                              0187
         LCR   @07,@07                                             0187
         AH    @07,LL(,@14)                                        0187
         CR    @15,@07                                             0187
         BNL   @RF00187                                            0187
         ALR   @14,@15                                             0187
         CLC   C-1(2,@14),@CC00628                                 0187
         BNE   @RF00187                                            0187
*             DO I=I+F3 TO LL-(F4+FREEAMT) WHILE C(I-F1:I)^=CLOSCMT;
         AL    @15,@CF00054                                        0188
         B     @DE00188                                            0188
@DL00188 L     @01,I(,COMONPTR)                                    0188
         L     @15,BUFBASE(,COMONPTR)                              0188
         ALR   @15,@01                                             0188
         CLC   C-2(2,@15),@CC00630                                 0188
         BE    @DC00188                                            0188
*                                   /*                               */
*             END;                  /* FIND END OF COMMENT           */
         LA    @15,1                                               0189
         AL    @15,I(,COMONPTR)                                    0189
@DE00188 ST    @15,I(,COMONPTR)                                    0189
         L     @14,BUFBASE(,COMONPTR)                              0189
         LA    @07,4                                               0189
         AL    @07,FREEAMT(,COMONPTR)                              0189
         LCR   @07,@07                                             0189
         AH    @07,LL(,@14)                                        0189
         CR    @15,@07                                             0189
         BNH   @DL00188                                            0189
@DC00188 DS    0H                                                  0190
*       END;                                                       0190
@RF00187 DS    0H                                                  0190
@RC00174 LA    @15,1                                               0190
         AL    @15,I(,COMONPTR)                                    0190
@DE00173 ST    @15,I(,COMONPTR)                                    0190
         L     @14,BUFBASE(,COMONPTR)                              0190
         LA    @07,4                                               0190
         AL    @07,FREEAMT(,COMONPTR)                              0190
         LCR   @07,@07                                             0190
         AH    @07,LL(,@14)                                        0190
         CR    @15,@07                                             0190
         BNH   @DL00173                                            0190
@DC00173 DS    0H                                                  0191
*     END;                                                         0191
         LA    @15,1                                               0191
         AL    @15,Z                                               0191
@DE00171 ST    @15,Z                                               0191
         C     @15,SCANLIM                                         0191
         BNH   @DL00171                                            0191
@DC00171 DS    0H                                                  0192
*                                                                  0192
*     /***************************************************************/
*     /*                                                             */
*     /* ACCESS METHOD SERVICES COMPATABILITY CHECK - LASTCC AND     */
*     /* MAXCC ARE ALLOWED WITHOUT & ON THE LEFT OF THE OPERATOR     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0192
*     IF OPCODE=IFCODE×OPCODE=DOCODE THEN/* IF OR DO COMMANDS        */
         L     @15,OLDLINE(,COMONPTR)                              0192
         CLI   OPCODE(@15),2                                       0192
         BE    @RT00192                                            0192
         CLI   OPCODE(@15),7                                       0192
         BNE   @RF00192                                            0192
@RT00192 DS    0H                                                  0193
*       DO;                         /* MAKE CHECK                    */
*         I=MYO2;                   /* START OF SCAN                 */
         L     @15,MYO2(,COMONPTR)                                 0194
         ST    @15,I(,COMONPTR)                                    0194
*         CALL FINDWORD;            /* FIND A WORD                   */
         BAL   @14,FINDWORD                                        0195
*         IF SEPS=NO THEN           /* IF NOT ALL SEPARATORS         */
         TM    SEPS(COMONPTR),B'10000000'                          0196
         BNZ   @RF00196                                            0196
*           IF(LEN=LENGTH(LASTCC)&  /* LASTCC LENGTH                 */
*               C(BEGIN:BEGIN+LENGTH(LASTCC)-F1)=LASTCC)×/* LASTCC   */
*               (LEN=LENGTH(MAXCC)& /* MAXCC LENGTH                  */
*               C(BEGIN:BEGIN+LENGTH(MAXCC)-F1)=MAXCC) THEN/* MAXCC  */
         CLC   LEN(4,COMONPTR),@CF00248                            0197
         BNE   @GL00008                                            0197
         L     @01,BEGIN(,COMONPTR)                                0197
         L     @15,BUFBASE(,COMONPTR)                              0197
         ALR   @15,@01                                             0197
         CLC   C-1(6,@15),@CC00643                                 0197
         BE    @RT00197                                            0197
@GL00008 CLC   LEN(4,COMONPTR),@CF00052                            0197
         BNE   @RF00197                                            0197
         L     @01,BEGIN(,COMONPTR)                                0197
         L     @15,BUFBASE(,COMONPTR)                              0197
         ALR   @15,@01                                             0197
         CLC   C-1(5,@15),@CC00641                                 0197
         BNE   @RF00197                                            0197
@RT00197 DS    0H                                                  0198
*             DO;                   /* PROCESS                       */
*               V=BEGIN;            /* BACK UP ONE FOR INSERT        */
         L     @15,BEGIN(,COMONPTR)                                0199
         ST    @15,V                                               0199
*               NOAMPER=YES;        /* INDICATE NO AMPERSAND         */
         OI    NOAMPER(COMONPTR),B'00000010'                       0200
*               CALL INSERT;        /* INSERT VALUE HERE             */
         BAL   @14,INSERT                                          0201
*             END;                                                 0202
*         IF OPCODE=IFCODE THEN     /* ON OF STMT                    */
@RF00197 DS    0H                                                  0203
@RF00196 L     @01,OLDLINE(,COMONPTR)                              0203
         CLI   OPCODE(@01),2                                       0203
         BNE   @RF00203                                            0203
*           DO;                     /* RE-INSERT 'THEN'              */
*             V=LL-(F3+FREEAMT);    /* SET START OF AREA             */
         L     @01,BUFBASE(,COMONPTR)                              0205
         LA    @00,3                                               0205
         AL    @00,FREEAMT(,COMONPTR)                              0205
         LCR   @00,@00                                             0205
         AH    @00,LL(,@01)                                        0205
         ST    @00,V                                               0205
*             I=V;                  /* SET END AREA                  */
         ST    @00,I(,COMONPTR)                                    0206
*             LEN=F0;               /* SET ZERO LENGTH TO REMOVE     */
         SLR   @15,@15                                             0207
         ST    @15,LEN(,COMONPTR)                                  0207
*             NOAMPER=YES;          /* NO AMPERSAND ON VARIABLE      */
*             INSTHEN=YES;          /* INSERT THEN TO INSERT         */
         OI    NOAMPER(COMONPTR),B'00000011'                       0209
*             ERRSAV=ERROR;         /* SAVE ERROR CODE               */
         L     @14,ERROR                                           0210
         ST    @14,ERRSAV                                          0210
*             ERROR=F0;             /* CLEAR ERROR IF ANY            */
         ST    @15,ERROR                                           0211
*             CALL INSERT;          /* INSERT THEN                   */
         BAL   @14,INSERT                                          0212
*             ERROR=ERRSAV;         /* RESTORE ERROR CONDITION       */
         L     @15,ERRSAV                                          0213
         ST    @15,ERROR                                           0213
*           END;                    /*                               */
*       END;                        /*                               */
@RF00203 DS    0H                                                  0216
*                                                                  0216
*     /***************************************************************/
*     /*                                                             */
*     /* CONTROL COMMAND LIST                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0216
*     EXECDPTR=LSDEXEC;             /* RESET EXEC DATA POINTER       */
@RF00192 L     @01,LSDPTR(,COMONPTR)                               0216
         L     @15,LSDEXEC(,@01)                                   0216
         ST    @15,EXECDPTR(,COMONPTR)                             0216
*     IF ERROR=F0 THEN              /* IF OK SO FAR                  */
         L     @15,ERROR                                           0217
         LTR   @15,@15                                             0217
         BNZ   @RF00217                                            0217
*       DO I=1 TO LL-(F4+FREEAMT);  /* DO UNTIL END OF BUFFER        */
         LA    @15,1                                               0218
         B     @DE00218                                            0218
@DL00218 DS    0H                                                  0219
*         IF I<LL-(F4+FREEAMT)&     /* NOT BEFORE END OF BUFFER      */
*             (C(I:I+F1)=DAMPSAND×  /* DOUBLE AMPERSAND              */
*             C(I:I+F1)=FDMPSAND) THEN/* FOLDED AMPERSANDS           */
         L     @15,I(,COMONPTR)                                    0219
         L     @14,BUFBASE(,COMONPTR)                              0219
         LA    @07,4                                               0219
         AL    @07,FREEAMT(,COMONPTR)                              0219
         LCR   @07,@07                                             0219
         AH    @07,LL(,@14)                                        0219
         CR    @15,@07                                             0219
         BNL   @RF00219                                            0219
         ALR   @15,@14                                             0219
         CLC   C-1(2,@15),@CC00662                                 0219
         BE    @RT00219                                            0219
         L     @15,I(,COMONPTR)                                    0219
         ALR   @14,@15                                             0219
         CLC   C-1(2,@14),@CB00664                                 0219
         BNE   @RF00219                                            0219
@RT00219 DS    0H                                                  0220
*           CALL SQUASH;            /* SQUASH OUT THE EXTRA AMPERSAND*/
         BAL   @14,SQUASH                                          0220
*         IF OPCODE^=IFCODE&OPCODE^=DOCODE&/* NOT IF AND NOT DO      */
*             OPCODE^=SETCODE THEN  /* AND NOT SET                   */
@RF00219 L     @15,OLDLINE(,COMONPTR)                              0221
         CLI   OPCODE(@15),2                                       0221
         BE    @RF00221                                            0221
         CLI   OPCODE(@15),7                                       0221
         BE    @RF00221                                            0221
         CLI   OPCODE(@15),13                                      0221
         BE    @RF00221                                            0221
*           DO;                     /* FOLD TO UPPER CASE            */
*             FOLD=NO;              /* RESET FOLD INDICATOR          */
         NI    FOLD(COMONPTR),B'11101111'                          0223
*             TR(C(I),TRTABUP);     /* FOLD TO NORMAL CHARACTERS     */
         L     @01,I(,COMONPTR)                                    0224
         L     @15,BUFBASE(,COMONPTR)                              0224
         ALR   @15,@01                                             0224
         TR    C-1(1,@15),TRTABUP                                  0224
*           END;                    /*                               */
*       END;                                                       0226
@RF00221 LA    @15,1                                               0226
         AL    @15,I(,COMONPTR)                                    0226
@DE00218 ST    @15,I(,COMONPTR)                                    0226
         L     @14,BUFBASE(,COMONPTR)                              0226
         LA    @07,4                                               0226
         AL    @07,FREEAMT(,COMONPTR)                              0226
         LCR   @07,@07                                             0226
         AH    @07,LL(,@14)                                        0226
         CR    @15,@07                                             0226
         BNH   @DL00218                                            0226
*     IF LISTONLY=YES×              /* BACKUP LIST OF TSO COMMAND    */
*         (ERROR>E16&(ERACTSTR=F0×ERRRANGE=YES))×/* A SEVERE ERROR   */
*         (CONLST=YES&(OPCODE^=F0×ERROR>E16)) THEN/* CONLIST         */
@RF00217 TM    LISTONLY(COMONPTR),B'00100000'                      0227
         BO    @RT00227                                            0227
         L     @15,ERROR                                           0227
         C     @15,@CF00104                                        0227
         BNH   @GL00015                                            0227
         L     @01,EXECDPTR(,COMONPTR)                             0227
         L     @15,ERACTSTR(,@01)                                  0227
         LTR   @15,@15                                             0227
         BZ    @RT00227                                            0227
         TM    ERRRANGE(COMONPTR),B'00000100'                      0227
         BO    @RT00227                                            0227
@GL00015 L     @01,EXECDPTR(,COMONPTR)                             0227
         TM    CONLST(@01),B'10000000'                             0227
         BNO   @RF00227                                            0227
         L     @01,OLDLINE(,COMONPTR)                              0227
         CLI   OPCODE(@01),0                                       0227
         BNE   @RT00227                                            0227
         L     @15,ERROR                                           0227
         C     @15,@CF00104                                        0227
         BNH   @RF00227                                            0227
@RT00227 DS    0H                                                  0228
*       DO;                                                        0228
*         LISTED=YES;               /* COMMAND ALREADY LISTED        */
         OI    LISTED(COMONPTR),B'00001000'                        0229
*         CALL CMDLST;              /* LIST COMMAND                  */
         BAL   @14,CMDLST                                          0230
*         IF LISTONLY=YES&ERROR=F0 THEN/* IF LISTED OK               */
         TM    LISTONLY(COMONPTR),B'00100000'                      0231
         BNO   @RF00231                                            0231
         L     @15,ERROR                                           0231
         LTR   @15,@15                                             0231
         BNZ   @RF00231                                            0231
*           ERROR=E4;               /* GET ANOTHER LINE              */
         MVC   ERROR(4),@CF00107                                   0232
*       END;                                                       0233
@RF00231 DS    0H                                                  0234
*                                                                  0234
*     /***************************************************************/
*     /*                                                             */
*     /* FUNCTION CALL AND NEXT COMMAND UPDATE                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0234
*     IF ERROR=F0 THEN              /* IF OK UP TO NOW               */
@RF00227 L     @15,ERROR                                           0234
         LTR   @15,@15                                             0234
         BNZ   @RF00234                                            0234
*       DO;                         /* CALL FUNCTION                 */
*         RFY                                                      0236
*          (R15) RSTD;              /* RESTRICT REG 15               */
*         CALL IKJCT436(UPTX,ECTX,ECB,GTPB,PARM433);/* CALL FUNCTION */
         L     @14,@PC00001                                        0237
         ST    @14,@AL00001                                        0237
         L     @14,@PC00001+4                                      0237
         ST    @14,@AL00001+4                                      0237
         L     @14,@PC00001+8                                      0237
         ST    @14,@AL00001+8                                      0237
         L     @14,@PC00001+12                                     0237
         ST    @14,@AL00001+12                                     0237
         L     @14,@PC00001+16                                     0237
         ST    @14,@AL00001+16                                     0237
         L     @15,@CV00099                                        0237
         LA    @01,@AL00001                                        0237
         BALR  @14,@15                                             0237
*         ERROR=R15;                /* SET ERROR CODE                */
         ST    R15,ERROR                                           0238
*         RFY                                                      0239
*          (R15) UNRSTD;            /* RELEASE REG 15                */
*       END;                        /*                               */
*     ERCOM=F0;                     /* CLEAR COMMON ERROR FOR MSGOUT */
@RF00234 SLR   @15,@15                                             0241
         ST    @15,ERCOM(,COMONPTR)                                0241
*     IF PARMDEFR=YES THEN          /* IF OK TO CHANGE STATUS        */
         L     @15,@PC00001+16                                     0242
         TM    PARMDEFR(@15),B'10000000'                           0242
         BNO   @RF00242                                            0242
*       GEN REFS(DEFERNO)(STAX MF=(E,DEFERNO));/* ALLOW ATTNS        */
         STAX MF=(E,DEFERNO)
*     IF ECBCBIT=YES THEN           /* IF ATTN POSTED                */
@RF00242 L     @15,@PC00001+8                                      0244
         TM    ECBCBIT(@15),B'01000000'                            0244
         BNO   @RF00244                                            0244
*       ERROR=E8;                   /* SET ATTN CODE                 */
         MVC   ERROR(4),@CF00094                                   0245
*     IF PARMDEFR=YES THEN          /* IF OK TO CHANGE STATUS        */
@RF00244 L     @15,@PC00001+16                                     0246
         TM    PARMDEFR(@15),B'10000000'                           0246
         BNO   @RF00246                                            0246
*       GEN REFS(DEFERYES)(STAX MF=(E,DEFERYES));/* NO ATTNS AGAIN   */
         STAX MF=(E,DEFERYES)
*     IF ERROR^=E4 THEN             /* IF NOT A CONTINU RETURN CODE  */
@RF00246 CLC   ERROR(4),@CF00107                                   0248
         BE    @RF00248                                            0248
*       CONTINU=NO;                 /* DON''T CONTINUE               */
         NI    CONTINU(COMONPTR),B'10111111'                       0249
*     IF CONTINU=YES THEN           /* IF OK TO CONTINUE             */
@RF00248 TM    CONTINU(COMONPTR),B'01000000'                       0250
         BNO   @RF00250                                            0250
*       DO;                         /* CHECK FOR END OF CLIST        */
*         ECDACBLK=LSDADATA;        /* POINT TO FIRST BLOCK          */
         L     @01,LSDPTR(,COMONPTR)                               0252
         L     @15,LSDADATA(,@01)                                  0252
         ST    @15,ECDACBLK                                        0252
*         DO WHILE ECDACBK2^=F0&CONTINU=YES;/* FIND NEXT BLOCK       */
         B     @DE00253                                            0253
@DL00253 DS    0H                                                  0254
*           IF CURID=COMPRID&       /* IF IDS MATCH                  */
*               CURADDR>=ECDACBK2+COMPRLNG THEN/* AND AT END         */
         L     @15,LSDPTR(,COMONPTR)                               0254
         L     @14,ECDACBLK                                        0254
         CLC   CURID(1,@15),COMPRID(@14)                           0254
         BNE   @RF00254                                            0254
         L     @07,ECDACBK2-1                                      0254
         LA    @07,0(,@07)                                         0254
         AL    @07,COMPRLNG(,@14)                                  0254
         L     @06,CURADDR-1(,@15)                                 0254
         LA    @06,0(,@06)                                         0254
         CR    @07,@06                                             0254
         BH    @RF00254                                            0254
*             IF COMPRNXT=F0 THEN   /* IF NO MORE BLOCKS     @ZA08099*/
         L     @15,COMPRNXT-1(,@14)                                0255
         LA    @15,0(,@15)                                         0255
         LTR   @15,@15                                             0255
         BNZ   @RF00255                                            0255
*               DO;                 /*                       @ZA08099*/
*                 EOCLIST=YES;      /* END OF THIS CLIST     @ZA08099*/
         L     @15,@PC00001+16                                     0257
         OI    EOCLIST(@15),B'01000000'                            0257
*                 CONTINU=NO;       /* DISSALLOW CONTINUE            */
         NI    CONTINU(COMONPTR),B'10111111'                       0258
*               END;                /*                       @ZA08099*/
*             ELSE                  /* OTHERWISE                     */
*               DO;                 /* GO TO NEXT BLOCK              */
         B     @RC00255                                            0260
@RF00255 DS    0H                                                  0261
*                 CURADDR=COMPRNXT+LENGTH(COMPROC);/* UPDATE LSD     */
         L     @15,LSDPTR(,COMONPTR)                               0261
         L     @14,ECDACBLK                                        0261
         LA    @07,12                                              0261
         L     @06,COMPRNXT-1(,@14)                                0261
         LA    @06,0(,@06)                                         0261
         ALR   @07,@06                                             0261
         STCM  @07,7,CURADDR(@15)                                  0261
*                 CURID=COMPRID+1;  /* INCREMENT BLOCK ID            */
         LA    @07,1                                               0262
         SLR   @06,@06                                             0262
         IC    @06,COMPRID(,@14)                                   0262
         ALR   @07,@06                                             0262
         STC   @07,CURID(,@15)                                     0262
*                 ECDACBLK=F0;      /* END SCAN                      */
         SLR   @15,@15                                             0263
         ST    @15,ECDACBLK                                        0263
*               END;                /*                               */
*           ELSE                    /* OTHERWISE                     */
*             ECDACBLK=COMPRPTR;    /* CHECK NEXT BLOCK              */
         B     @RC00254                                            0265
@RF00254 L     @01,ECDACBLK                                        0265
         L     @15,COMPRPTR(,@01)                                  0265
         ST    @15,ECDACBLK                                        0265
*         END;                      /*                               */
@RC00254 DS    0H                                                  0266
@DE00253 L     @15,ECDACBK2-1                                      0266
         LA    @15,0(,@15)                                         0266
         LTR   @15,@15                                             0266
         BZ    @DC00253                                            0266
         TM    CONTINU(COMONPTR),B'01000000'                       0266
         BO    @DL00253                                            0266
@DC00253 DS    0H                                                  0267
*         IF CONTINU=YES THEN       /* IF CONTINUING                 */
         TM    CONTINU(COMONPTR),B'01000000'                       0267
         BNO   @RF00267                                            0267
*           DO;                     /* UPDATE POINTERS               */
*             GTPBLINE=LSDANEXT;    /* SAVE LSDANEXT                 */
         L     @15,@PC00001+12                                     0269
         L     @14,LSDPTR(,COMONPTR)                               0269
         L     @07,LSDANEXT(,@14)                                  0269
         ST    @07,GTPBLINE(,@15)                                  0269
*             LSDANEXT=LSDANEXT+LSDANEXT->LL;/* UPDATE LSD POINTER   */
         LH    @15,LL(,@07)                                        0270
         ALR   @15,@07                                             0270
         ST    @15,LSDANEXT(,@14)                                  0270
*           END;                    /*                               */
*       END;                        /*                               */
@RF00267 DS    0H                                                  0273
*FASTCYCL:                                                         0273
*   END;                            /*                       @ZA08099*/
@RF00250 DS    0H                                                  0273
FASTCYCL DS    0H                                                  0273
@DE00041 TM    CONTINU(COMONPTR),B'01000000'                       0273
         BO    @DL00041                                            0273
*                                                                  0274
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CODE UPDATE IF ERROR AND STACK FLUSH IF NEEDED         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*FASTEXIT:                                                         0274
*   IF ERROR>E8 THEN                /* IF AN ERROR OCCURRED          */
FASTEXIT L     @15,ERROR                                           0274
         C     @15,@CF00094                                        0274
         BNH   @RF00274                                            0274
*     DO;                           /* PROCESS ERROR CONDITION       */
*       IF ERROR=E16 THEN           /* IF A GETMAIN FAIL             */
         C     @15,@CF00104                                        0276
         BNE   @RF00276                                            0276
*         QUIT=YES;                 /* FLUSH STACK                   */
         OI    QUIT(COMONPTR),B'00100000'                          0277
*       ELSE                        /* OTHERWISE                     */
*         QUIT=NO;                  /* DONT FLUSH -- YET             */
         B     @RC00276                                            0278
@RF00276 NI    QUIT(COMONPTR),B'11011111'                          0278
*       ERRSAV=ERROR;               /* SAVE ERROR CODE               */
@RC00276 L     @15,ERROR                                           0279
         ST    @15,ERRSAV                                          0279
*       ERROR=F0;                   /* SET ERROR TO ZERO TO          */
         SLR   @15,@15                                             0280
         ST    @15,ERROR                                           0280
*       CALL RCUPDT;                /* SET RETURN CODE INDICATORS    */
         BAL   @14,RCUPDT                                          0281
*       IF ERRCMD=YES THEN          /* ID ERROR COMMAND IN EFFECT    */
         L     @01,EXECDPTR(,COMONPTR)                             0282
         TM    ERRCMD(@01),B'01000000'                             0282
         BNO   @RF00282                                            0282
*         IF ERRRANGE=YES THEN      /* IF IN AN ERROR RANGE          */
         TM    ERRRANGE(COMONPTR),B'00000100'                      0283
         BNO   @RF00283                                            0283
*           DO;                     /*                               */
*             IF ERRSAV^=E908 THEN  /* NOT ALREADY A RECURSE MSG     */
         CLC   ERRSAV(4),@CF00785                                  0285
         BE    @RF00285                                            0285
*               RECURSE=YES;        /* SET RECURSIVE ERROR BIT       */
         OI    RECURSE(COMONPTR),B'00100000'                       0286
*             QUIT=YES;             /* FLUSH STACK                   */
@RF00285 OI    QUIT(COMONPTR),B'00100000'                          0287
*           END;                    /*                               */
*         ELSE                      /* IF NOT IN ERRANGE             */
*           IF ERACTSTR^=F0 THEN    /* IF NO ERACTSTR                */
         B     @RC00283                                            0289
@RF00283 L     @15,EXECDPTR(,COMONPTR)                             0289
         L     @14,ERACTSTR(,@15)                                  0289
         LTR   @14,@14                                             0289
         BZ    @RF00289                                            0289
*             DO;                   /*                               */
*               ERINCNTL=YES;       /* SET ERROR IN CONTROL          */
         OI    ERINCNTL(@15),B'00001000'                           0291
*               CALL RETUPDT(LSDANEXT);/* UPDATE RETURN POINT        */
         L     @01,LSDPTR(,COMONPTR)                               0292
         LA    @15,LSDANEXT(,@01)                                  0292
         ST    @15,@AL00001                                        0292
         LA    @01,@AL00001                                        0292
         BAL   @14,RETUPDT                                         0292
*               LSDANEXT=ERACTSTR;  /* SET GOTO ADDR                 */
         L     @01,LSDPTR(,COMONPTR)                               0293
         L     @15,EXECDPTR(,COMONPTR)                             0293
         L     @00,ERACTSTR(,@15)                                  0293
         ST    @00,LSDANEXT(,@01)                                  0293
*             END;                  /*                               */
*           ELSE                    /* OTHERWISE                     */
*             IF LISTED=NO THEN     /* IF COMMAND NOT LISTED         */
         B     @RC00289                                            0295
@RF00289 TM    LISTED(COMONPTR),B'00001000'                        0295
         BNZ   @RF00295                                            0295
*               DO;                 /* LIST COMMAND IN ERROR         */
*                 LISTED=YES;       /* SAY WE HAVE LISTED COMMAND    */
         OI    LISTED(COMONPTR),B'00001000'                        0297
*                 CALL CMDLST;      /* LIST COMMAND                  */
         BAL   @14,CMDLST                                          0298
*               END;                /*                               */
*             ELSE                                                 0300
*               ;                   /* NOTHING                       */
@RF00295 DS    0H                                                  0301
*       ELSE                        /* IF NO ERRCMD                  */
*         QUIT=YES;                 /* FLUSH STACK                   */
         B     @RC00282                                            0301
@RF00282 OI    QUIT(COMONPTR),B'00100000'                          0301
*       IF QUIT=YES×LISTED=YES THEN /* FLUSH STACK ?                 */
@RC00282 TM    QUIT(COMONPTR),B'00100000'                          0302
         BO    @RT00302                                            0302
         TM    LISTED(COMONPTR),B'00001000'                        0302
         BNO   @RF00302                                            0302
@RT00302 DS    0H                                                  0303
*         DO;                       /* IF SO PRINT ERROR MSG         */
*           IF LISTED=NO THEN       /* IF NOT ALREADY LISTED         */
         TM    LISTED(COMONPTR),B'00001000'                        0304
         BNZ   @RF00304                                            0304
*             CALL CMDLST;          /* LIST COMMAND                  */
         BAL   @14,CMDLST                                          0305
*           IF QUIT=YES THEN        /* GOING TO FLUSH ?              */
@RF00304 TM    QUIT(COMONPTR),B'00100000'                          0306
         BNO   @RF00306                                            0306
*             NOMSG=NO;             /* ALLOW MESSAGE TO GO OUT       */
         L     @01,EXECDPTR(,COMONPTR)                             0307
         NI    NOMSG(@01),B'11111101'                              0307
*           CALL MSGOUT;            /* PUT OUT SELECTED MESSAGE      */
@RF00306 BAL   @14,MSGOUT                                          0308
*           IF RECURSE=YES THEN     /* A RECURSIVE ERROR ?           */
         TM    RECURSE(COMONPTR),B'00100000'                       0309
         BNO   @RF00309                                            0309
*             DO;                   /* BUILD CORRECT MESSAGE         */
*               ERRSAV=E908;        /* SET RECURSIVE ERROR           */
         MVC   ERRSAV(4),@CF00785                                  0311
*               CALL MSGOUT;        /* PUT OUT RECURSIVE MESSAGE     */
         BAL   @14,MSGOUT                                          0312
*             END;                  /*                               */
*           IF QUIT=YES THEN        /* FLUSH THE STACK               */
@RF00309 TM    QUIT(COMONPTR),B'00100000'                          0314
         BNO   @RF00314                                            0314
*             DO;                   /* FLUSH IT                      */
*               ECTRTCD=ERRSAV;     /* SET ECT RETURN CODE FIELD     */
         L     @15,@PC00001+4                                      0316
         MVC   ECTRTCD(3,@15),ERRSAV+1                             0316
*               ECTRCDF=''B;        /* CLEAR ABEND FLAG              */
         MVI   ECTRCDF(@15),X'00'                                  0317
*               NOFLUSH=NO;         /* TURN OFF NOFLUSH OPTION       */
*               CMAIN=NO;           /* TURN OFF MAIN OPTION          */
         L     @01,EXECDPTR(,COMONPTR)                             0319
         NI    NOFLUSH(@01),B'11011011'                            0319
*               IOPL(4)=ADDR(STFLUSH);/* PUTLINE PARM BLOCK          */
         LA    @15,STFLUSH                                         0320
         ST    @15,IOPL+12(,COMONPTR)                              0320
*               RFY                                                0321
*                (R1) RSTD;         /* RESTRICT REG ONE              */
*               R1=ADDR(IOPL);      /* LOAD PARM ADDRESS             */
         LR    R1,COMONPTR                                         0322
*               CALL IKJEFT30;      /* FLUSH STACK                   */
         L     @15,@CV00100                                        0323
         BALR  @14,@15                                             0323
*               RFY                                                0324
*                (R1) UNRSTD;       /* RELEASE REG ONE               */
*             END;                  /*                               */
*         END;                      /*                               */
@RF00314 DS    0H                                                  0327
*       ERROR=E4;                   /* SET OK TO GET ANOTHER COMMAND */
@RF00302 MVC   ERROR(4),@CF00107                                   0327
*     END;                          /*                               */
*                                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE BUFFERS AS REQUIRED                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*   IF CORE=YES THEN                /* NO GETMAIN ERROR YET          */
@RF00274 TM    CORE(COMONPTR),B'10000000'                          0329
         BNO   @RF00329                                            0329
*     DO;                           /* FREE PARTS OF OR ALL BUFFERS  */
*       IF ERROR=F0 THEN            /* IF ALL OK                     */
         L     @15,ERROR                                           0331
         LTR   @15,@15                                             0331
         BNZ   @RF00331                                            0331
*         DO;                       /* FREEMAIN EXCESS PART OF BUFFER*/
*           FREEADDR(1)=(BUFBASE+LL-FREEAMT+7)/8*8;/* CALC FREE ADDR */
         L     @15,BUFBASE(,COMONPTR)                              0333
         LH    @14,LL(,@15)                                        0333
         LR    @00,@15                                             0333
         ALR   @00,@14                                             0333
         L     @07,FREEAMT(,COMONPTR)                              0333
         SLR   @00,@07                                             0333
         AL    @00,@CF00208                                        0333
         SRDA  @00,32                                              0333
         D     @00,@CF00094                                        0333
         SLA   @01,3                                               0333
         ST    @01,FREEADDR                                        0333
*           FREELEN(1)=LL-(FREEADDR(1)-BUFBASE);/* CALC FREE LENGTH  */
         SLR   @01,@15                                             0334
         LCR   @01,@01                                             0334
         ALR   @01,@14                                             0334
         ST    @01,FREELEN                                         0334
*           LL=LL-FREEAMT;          /* ADJUST BUFFER LL              */
         SLR   @14,@07                                             0335
         STH   @14,LL(,@15)                                        0335
*           GTPBLINE=BUFBASE;       /* PUT LINE ADDR IN CALLERS AREA */
         L     @14,@PC00001+12                                     0336
         ST    @15,GTPBLINE(,@14)                                  0336
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE FREE OBTAINED BUFFER*/
*         DO;                       /*                               */
         B     @RC00331                                            0338
@RF00331 DS    0H                                                  0339
*           FREEADDR(1)=BUFBASE;    /* BUFFER ADDRESS                */
         L     @15,BUFBASE(,COMONPTR)                              0339
         ST    @15,FREEADDR                                        0339
*           FREELEN(1)=LL;          /* BUFFER LENGTH                 */
         LH    @15,LL(,@15)                                        0340
         ST    @15,FREELEN                                         0340
*         END;                      /*                               */
*       FREEADDR(2)=NEWBASE;        /* ALTERNATE BUFFER ALWAYS FREED */
@RC00331 L     @15,NEWBASE(,COMONPTR)                              0342
         ST    @15,FREEADDR+4                                      0342
*       FREELEN(2)=NEWLL×FREELAST;  /* LENGTH OF ALTERNATE BUFFER    */
         LH    @15,NEWLL(,@15)                                     0343
         O     @15,@CF00097                                        0343
         ST    @15,FREELEN+4                                       0343
*       DO;                         /* FREEMAIN (L) LA(FREELEN(1)) 0344
*                                      A(FREEADDR(1)) SP(F1)       0344
*                                      MF(E,FRELST)                  */
*         RESPECIFY                                                0345
*          (GPR01P) RESTRICTED;                                    0345
*         FRELST05='80'X;           /* SET TYPE                      */
         MVI   FRELST05,X'80'                                      0346
*         FRELST02=ADDR(FREELEN(1));/* ADDR OF LENGTH LIST           */
         LA    @00,FREELEN                                         0347
         STCM  @00,7,FRELST02                                      0347
*         FRELST04=ADDR(FREEADDR(1));/* ADDR OF ADDR LIST            */
         LA    @00,FREEADDR                                        0348
         STCM  @00,7,FRELST04                                      0348
*         FRELST06=F1;              /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'01'                                      0349
*         GPR01P=ADDR(FRELST);      /* REG1 POINTS TO LIST           */
         LA    GPR01P,FRELST                                       0350
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0351
*         RESPECIFY                                                0352
*          (GPR01P) UNRESTRICTED;                                  0352
*       END;                        /* FREEMAIN (L) LA(FREELEN(1)) 0353
*                                      A(FREEADDR(1)) SP(F1)       0353
*                                      MF(E,FRELST)                  */
*     END;                                                         0354
*   RETURN CODE(ERROR);             /* RETURN TO GETLINE             */
@RF00329 L     @07,ERROR                                           0355
         L     @13,4(,@13)                                         0355
         L     @00,@SIZDATD                                        0355
         LR    @01,@09                                             0355
         IKJEXEC  R,LV=(0),A=(1)
         LR    @15,@07                                             0355
         L     @14,12(,@13)                                        0355
         LM    @00,@12,20(@13)                                     0355
         BR    @14                                                 0355
*                                                                  0356
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE ONLY ENTRY                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0356
*IKJUPDT:                                                          0356
*   ENTRY(UPTX,ECTX,ECB,UPLIST);    /*                               */
@EP00356 MVC   @PC00001(12),0(@01)                                 0356
         MVC   @PC00001+20(4),12(@01)                              0356
*   SWS=''B;                        /* CLEAR MOST SWITCHES           */
         XC    SWS(5,COMONPTR),SWS(COMONPTR)                       0357
*   CALL INTSETUP;                  /* INIT VARIABLES                */
         BAL   @14,INTSETUP                                        0358
*   SYSUPDTE=YES;                   /* INDICATE SYSTEM UPDATE        */
         OI    SYSUPDTE(COMONPTR),B'00000100'                      0359
*   CALL LOCATE(LCVAL,LCVALLEN,F0); /* LOCATE VARIABLE               */
         L     @15,@PC00001+20                                     0360
         L     @01,LCVALPTR(,@15)                                  0360
         ST    @01,@AL00001                                        0360
         LA    @15,LCVALLEN(,@15)                                  0360
         ST    @15,@AL00001+4                                      0360
         LA    @15,@CF00439                                        0360
         ST    @15,@AL00001+8                                      0360
         LA    @01,@AL00001                                        0360
         BAL   @14,LOCATE                                          0360
*   IF ERROR=F0 THEN                /* IF FOUND                      */
         L     @15,ERROR                                           0361
         LTR   @15,@15                                             0361
         BNZ   @RF00361                                            0361
*     CALL UPDATE(UPVAL,UPVALLEN);  /* UPDATE THE VARIABLE           */
         L     @15,@PC00001+20                                     0362
         L     @01,UPVALPTR(,@15)                                  0362
         ST    @01,@AL00001                                        0362
         LA    @15,UPVALLEN(,@15)                                  0362
         ST    @15,@AL00001+4                                      0362
         LA    @01,@AL00001                                        0362
         BAL   @14,UPDATE                                          0362
*   RETURN CODE(ERROR);             /* RETURN TO GETLINE             */
@RF00361 L     @07,ERROR                                           0363
         L     @13,4(,@13)                                         0363
         L     @00,@SIZDATD                                        0363
         LR    @01,@09                                             0363
         IKJEXEC  R,LV=(0),A=(1)
         LR    @15,@07                                             0363
         L     @14,12(,@13)                                        0363
         LM    @00,@12,20(@13)                                     0363
         BR    @14                                                 0363
*                                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION ROUTINE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*INTSETUP:                                                         0364
*   PROC;                                                          0364
@EL00001 L     @13,4(,@13)                                         0364
@EF00001 L     @00,@SIZDATD                                        0364
         LR    @01,@09                                             0364
         IKJEXEC  R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0364
         BR    @14                                                 0364
INTSETUP STM   @14,@12,12(@13)                                     0364
*   STFLUSH(1:MACLEN)=STACKL(1:MACLEN);/* COPY LIST MACROS           */
         L     @15,MACLEN                                          0365
         BCTR  @15,0                                               0365
         EX    @15,@SM01094                                        0365
*   IOPL(1)=ADDR(UPT);              /* ADDR OF UPT                   */
         L     @15,@PC00001                                        0366
         ST    @15,IOPL(,COMONPTR)                                 0366
*   IOPL(2)=ADDR(ECT);              /* ADDR OF ECT                   */
         L     @15,@PC00001+4                                      0367
         ST    @15,IOPL+4(,COMONPTR)                               0367
*   IOPL(3)=ADDR(ECB);              /* ADDR OF ECB                   */
         L     @14,@PC00001+8                                      0368
         ST    @14,IOPL+8(,COMONPTR)                               0368
*   ERROR=F0;                       /* ZERO ERROR INDICATOR          */
         SLR   @14,@14                                             0369
         ST    @14,ERROR                                           0369
*   ERCOM=F0;                       /* ZERO ERROR INDICATOR (COMMON) */
         ST    @14,ERCOM(,COMONPTR)                                0370
*   FREEAMT=F0;                     /* ZERO AMOUNT THAT IS FREE      */
         ST    @14,FREEAMT(,COMONPTR)                              0371
*   FREEADDR(1)=F0;                 /* INIT FREEMAIN ADDR TO 0       */
         ST    @14,FREEADDR                                        0372
*   FREELEN(1)=F0;                  /* INIT FREEMAIN LENGTH TO 0     */
         ST    @14,FREELEN                                         0373
*   SW2=''B;                        /* TURN OFF LOOP SWITCHES        */
         MVI   SW2(COMONPTR),X'00'                                 0374
*   FRELST=''B;                     /* CLEAR FREEMAIN LIST AREA      */
         XC    FRELST(10),FRELST                                   0375
*   GETLST=''B;                     /* CLEAR GETMIAN LIST AREA       */
         XC    GETLST(10),GETLST                                   0376
*   LSDPTR=INSADLSD;                /* POINT TO LSD                  */
         L     @01,ECTIOWA(,@15)                                   0377
         L     @01,IOSTELM(,@01)                                   0377
         L     @15,INSADLSD-1(,@01)                                0377
         LA    @15,0(,@15)                                         0377
         ST    @15,LSDPTR(,COMONPTR)                               0377
*   DO;                             /* GETMAIN (EC) MF(M,GETLST)     */
*     GETLST04='20'X;               /* TYPE                          */
         MVI   GETLST04,X'20'                                      0379
*   END;                            /* GETMAIN (EC) MF(M,GETLST) SET
*                                      TYPE OF GETMAIN               */
*   DO;                             /* FREEMAIN (E) MF(M,FRELST)     */
*     FRELST05='00'X;               /* SET TYPE                      */
         MVI   FRELST05,X'00'                                      0382
*   END;                            /* FREEMAIN (E) MF(M,FRELST) SET
*                                      TYPE OF FREEMAIN              */
*   END INTSETUP;                                                  0384
@EL00002 DS    0H                                                  0384
@EF00002 DS    0H                                                  0384
@ER00002 LM    @14,@12,12(@13)                                     0384
         BR    @14                                                 0384
*                                                                  0385
*   /*****************************************************************/
*   /*                                                               */
*   /* MESSAGE OUTPUT ROUTINE                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0385
*MSGOUT:                                                           0385
*   PROC OPTIONS(SAVEAREA);                                        0385
MSGOUT   STM   @14,@12,12(@13)                                     0385
         ST    @13,@SA00003+4                                      0385
         LA    @14,@SA00003                                        0385
         ST    @14,8(,@13)                                         0385
         LR    @13,@14                                             0385
*   MATCH=NO;                       /* RESET MATCH SWITCH            */
         NI    MATCH(COMONPTR),B'11101111'                         0386
*   IF RCABEND=YES THEN             /* FOR AN ABEND ERROR            */
         TM    RCABEND(COMONPTR),B'10000000'                       0387
         BNO   @RF00387                                            0387
*     I=MSGDIM;                     /* GET INTERNAL ERROR MSG        */
         L     @15,@CA00231                                        0388
         LH    @15,MSGDIM-MSGTABL(,@15)                            0388
         ST    @15,I(,COMONPTR)                                    0388
*   ELSE                            /* OTHERWISE START FROM BEGINNING*/
*     I=F1;                         /*                               */
         B     @RC00387                                            0389
@RF00387 MVC   I(4,COMONPTR),@CF00042                              0389
*   DO I=I TO MSGDIM WHILE MATCH=NO;/* NOT FOUND?-TRY HERE           */
@RC00387 L     @15,I(,COMONPTR)                                    0390
         B     @DE00390                                            0390
@DL00390 TM    MATCH(COMONPTR),B'00010000'                         0390
         BNZ   @DC00390                                            0390
*     IF(ERRSAV>=IDA(I)&ERRSAV<=IDC(I))×I=MSGDIM THEN/* A MATCH      */
         L     @15,ERRSAV                                          0391
         L     @14,I(,COMONPTR)                                    0391
         MH    @14,@CH00216                                        0391
         L     @07,@CA00231                                        0391
         LA    @01,0(@14,@07)                                      0391
         AL    @01,@CF01096                                        0391
         CH    @15,IDA-MSGTABL-2(,@01)                             0391
         BL    @GL00025                                            0391
         AL    @07,@CF01097                                        0391
         CH    @15,IDC-MSGTABL-4(@14,@07)                          0391
         BNH   @RT00391                                            0391
@GL00025 L     @15,@CA00231                                        0391
         L     @14,I(,COMONPTR)                                    0391
         CH    @14,MSGDIM-MSGTABL(,@15)                            0391
         BNE   @RF00391                                            0391
@RT00391 DS    0H                                                  0392
*       DO;                         /* FILL IN OLD                   */
*         MATCH=YES;                /* TERMINATE SCAN FOR MESSAGE    */
         OI    MATCH(COMONPTR),B'00010000'                         0393
*         N=SEGNUM(I);              /* GET CURRENT NUMBER OF SEGMENTS*/
         L     @15,I(,COMONPTR)                                    0394
         MH    @15,@CH00216                                        0394
         L     @14,@CA00231                                        0394
         LA    @01,0(@15,@14)                                      0394
         BCTR  @01,0                                               0394
         BCTR  @01,0                                               0394
         SLR   @00,@00                                             0394
         IC    @00,SEGNUM-MSGTABL-10(,@01)                         0394
         ST    @00,N                                               0394
*         OLD(3)=MSGSEG1(I);        /* FIRST SEGMENT                 */
         LA    @01,0(@15,@14)                                      0395
         AL    @01,@CF01099                                        0395
         L     @01,MSGSEG1-MSGTABL-7(,@01)                         0395
         LA    @01,0(,@01)                                         0395
         ST    @01,OLD+8                                           0395
*         OLD(4)=MSGSEG2(I);        /* SECOND SEGMENT IF ONE         */
         BCTR  @14,0                                               0396
         BCTR  @14,0                                               0396
         L     @01,MSGSEG2-MSGTABL-11(@15,@14)                     0396
         LA    @01,0(,@01)                                         0396
         ST    @01,OLD+12                                          0396
*         IF RECURSE=YES&ERRSAV=E908 THEN/* IF ALSO TYPE ERROR       */
         TM    RECURSE(COMONPTR),B'00100000'                       0397
         BNO   @RF00397                                            0397
         CLC   ERRSAV(4),@CF00785                                  0397
         BNE   @RF00397                                            0397
*           DO;                     /* FILL IN OLD                   */
*             OLD(2)=N+F1;          /* SET COUNT                     */
         AL    @00,@CF00042                                        0399
         ST    @00,OLD+4                                           0399
*             OLD(5)=OLD(4);        /* GET ROOM FOR ALSO             */
         L     @15,OLD+12                                          0400
         ST    @15,OLD+16                                          0400
*             OLD(4)=ADDR(ALSO);    /* GET ADDR OF ALSO              */
         L     @15,@CA00229                                        0401
         ST    @15,OLD+12                                          0401
*           END;                    /*                               */
*         ELSE                      /* OTHERWISE                     */
*           OLD(2)=N;               /* NUMBER OF SEGMENTS            */
         B     @RC00397                                            0403
@RF00397 L     @15,N                                               0403
         ST    @15,OLD+4                                           0403
*         IF SECLEVEL(I)=YES THEN   /* IF PROCESSING REQ SECOND LVL  */
@RC00397 L     @15,I(,COMONPTR)                                    0404
         MH    @15,@CH00216                                        0404
         L     @14,@CA00231                                        0404
         ALR   @14,@15                                             0404
         AL    @14,@CF01099                                        0404
         TM    SECLEVEL-MSGTABL-6(@14),B'10000000'                 0404
         BNO   @RF00404                                            0404
*           DO;                     /* BUILD SECOND LEVEL MSG        */
*             OLD(1)=ADDR(OLD2);    /* POINT TO SECOND LEVEL         */
         LA    @15,OLD2                                            0406
         ST    @15,OLD                                             0406
*             OLD2(1)=F0;           /* NO THIRD LEVEL MESSAGE        */
         SLR   @15,@15                                             0407
         ST    @15,OLD2                                            0407
*             OLD2(2)=F1;           /* ONE SEGMENT                   */
         MVC   OLD2+4(4),@CF00042                                  0408
*             OLD2(3)=ADDR(MYSEG);  /* MESSAGE                       */
         LA    @15,MYSEG                                           0409
         ST    @15,OLD2+8                                          0409
*             MYSEG=MSTRLV2(1:LENGTH(MYSEG));/* COPY MSG TO GOTTEN   */
         L     @15,@CA00230                                        0410
         MVC   MYSEG(35),MSTRLV2-MSTRLV2(@15)                      0410
*             CALL LOCATE(LASTCC,LENGTH(LASTCC),F0);/* LOCATE LASTCC */
         LA    @01,@AL00411                                        0411
         BAL   @14,LOCATE                                          0411
*             IF ERROR=F0&SVTLNG>F0 THEN/* IF LOCATE OK              */
         SLR   @15,@15                                             0412
         C     @15,ERROR                                           0412
         BNE   @RF00412                                            0412
         L     @01,SNTELPTR(,COMONPTR)                             0412
         L     @14,SNTVLPTR(,@01)                                  0412
         LH    @07,SVTLNG(,@14)                                    0412
         CR    @07,@15                                             0412
         BNH   @RF00412                                            0412
*               DO;                 /* FILL IN CODE                  */
*                 N=MIN(SVTLNG,F5); /* SAVE LENGTH (MAX OF 5)        */
         LA    @06,5                                               0414
         CR    @07,@06                                             0414
         BNH   *+6
         LR    @07,@06                                             0414
         ST    @07,N                                               0414
*                 IF SVTDATA(1)=CCS×SVTDATA(1)=CCU THEN/* ABEND CD   */
         CLI   SVTDATA(@14),C'S'                                   0415
         BE    @RT00415                                            0415
         CLI   SVTDATA(@14),C'U'                                   0415
         BNE   @RF00415                                            0415
@RT00415 DS    0H                                                  0416
*                   DO;             /* ABEND CODE ?                  */
*                     N=MIN(SVTLNG,F5);/* SAVE LENGTH (MAX OF 5)     */
         L     @01,SNTELPTR(,COMONPTR)                             0417
         L     @15,SNTVLPTR(,@01)                                  0417
         LH    @14,SVTLNG(,@15)                                    0417
         LA    @07,5                                               0417
         CR    @14,@07                                             0417
         BNH   *+6
         LR    @14,@07                                             0417
         ST    @14,N                                               0417
*                     OUTCD=SVTDATA(1:N);/* OK ALL CHARS             */
         MVI   OUTCD+1,C' '                                        0418
         MVC   OUTCD+2(3),OUTCD+1                                  0418
         BCTR  @14,0                                               0418
         EX    @14,@SM01100                                        0418
*                   END;            /*                               */
*                 ELSE              /* OTHERWISE                     */
*                   DO;             /* DONT OVERLAY THE 'E'          */
         B     @RC00415                                            0420
@RF00415 DS    0H                                                  0421
*                     N=MIN(SVTLNG,F3);/* MAX NUMBER LENGTH          */
         L     @01,SNTELPTR(,COMONPTR)                             0421
         L     @15,SNTVLPTR(,@01)                                  0421
         LH    @14,SVTLNG(,@15)                                    0421
         LA    @07,3                                               0421
         CR    @14,@07                                             0421
         BNH   *+6
         LR    @14,@07                                             0421
         ST    @14,N                                               0421
*                     OUTCD(5-N:4)=SVTDATA(1:N);/* ON NUMBERS        */
         LCR   @14,@14                                             0422
         AL    @14,@CF00052                                        0422
         LA    @01,OUTCD-1(@14)                                    0422
         LCR   @14,@14                                             0422
         AL    @14,@CF00107                                        0422
         EX    @14,@SM01102                                        0422
*                   END;            /*                               */
*               END;                /*                               */
*           END;                    /*                               */
*         ELSE                      /* OTHERWISE                     */
*           OLD(1)=F0;              /* NO SECOUND LEVEL MESSAGE      */
         B     @RC00404                                            0426
@RF00404 SLR   @15,@15                                             0426
         ST    @15,OLD                                             0426
*       END;                        /*                               */
@RC00404 DS    0H                                                  0428
*   END;                            /*                               */
@RF00391 LA    @15,1                                               0428
         AL    @15,I(,COMONPTR)                                    0428
         ST    @15,I(,COMONPTR)                                    0428
@DE00390 L     @14,@CA00231                                        0428
         CH    @15,MSGDIM-MSGTABL(,@14)                            0428
         BNH   @DL00390                                            0428
@DC00390 DS    0H                                                  0429
*   IOPL(4)=ADDR(PUTMLVL);          /* PUTLINE LIST FORM             */
         LA    @15,PUTMLVL                                         0429
         ST    @15,IOPL+12(,COMONPTR)                              0429
*   RFY                                                            0430
*    (R1,                                                          0430
*     R2,                                                          0430
*     R15) RSTD;                    /* RESTRICT ENTRY REG            */
*   R1=ADDR(IOPL);                  /* GET ADDR OF IOPL              */
         LR    R1,COMONPTR                                         0431
*   R2=ADDR(OLD);                   /* GET ADDR OF OLD               */
         LA    R2,OLD                                              0432
*   R15=ADDR(IKJEFT40);             /* ENTRY TO PUTLINE              */
         L     R15,@CV00101                                        0433
*   GEN REFS(R1,R2,R15)                                            0434
*       (PUTLINE OUTPUT=((2),MULTLVL),MF=(E,(1)),ENTRY=(15));      0434
         PUTLINE OUTPUT=((2),MULTLVL),MF=(E,(1)),ENTRY=(15)
*   RFY                                                            0435
*    (R1,                                                          0435
*     R2,                                                          0435
*     R15) UNRSTD;                  /* RELEASE REG 15                */
*   END MSGOUT;                                                    0436
@EL00003 L     @13,4(,@13)                                         0436
@EF00003 DS    0H                                                  0436
@ER00003 LM    @14,@12,12(@13)                                     0436
         BR    @14                                                 0436
*                                                                  0437
*   /*****************************************************************/
*   /*                                                               */
*   /* INSERT MAINLINE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0437
*INSERT:                                                           0437
*   PROC;                                                          0437
INSERT   STM   @14,@12,@SA00004                                    0437
*   IF INSTHEN=NO THEN              /* AS LONG AS NOT INSERT THEN    */
         TM    INSTHEN(COMONPTR),B'00000001'                       0438
         BNZ   @RF00438                                            0438
*     CALL LOCATE(C(V),LEN,F0);     /* LOCATE SYMBOLIC VARIABLE      */
         L     @01,BUFBASE(,COMONPTR)                              0439
         L     @15,V                                               0439
         LA    @15,C-1(@15,@01)                                    0439
         ST    @15,@AL00001                                        0439
         LA    @15,LEN(,COMONPTR)                                  0439
         ST    @15,@AL00001+4                                      0439
         LA    @15,@CF00439                                        0439
         ST    @15,@AL00001+8                                      0439
         LA    @01,@AL00001                                        0439
         BAL   @14,LOCATE                                          0439
*   IF ERROR=F0 THEN                /* IF VARIABLE FOUND             */
@RF00438 L     @15,ERROR                                           0440
         LTR   @15,@15                                             0440
         BNZ   @RF00440                                            0440
*     DO;                           /*                               */
*       IF NOAMPER=NO THEN          /* IF AMPERSAND PRESENT          */
         TM    NOAMPER(COMONPTR),B'00000010'                       0442
         BNZ   @RF00442                                            0442
*         DO;                       /* RESET V TO AMPERSAND AND      */
*           V=V-F1;                 /* ADD THE LENGTH OF AN          */
         L     @15,V                                               0444
         BCTR  @15,0                                               0444
         ST    @15,V                                               0444
*           LEN=LEN+F1;             /* AMPERSAND TO LEN              */
         LA    @15,1                                               0445
         AL    @15,LEN(,COMONPTR)                                  0445
         ST    @15,LEN(,COMONPTR)                                  0445
*         END;                      /*                               */
*       IF INSTHEN=YES THEN         /* IF IN INSERT THEN MODE        */
@RF00442 TM    INSTHEN(COMONPTR),B'00000001'                       0447
         BNO   @RF00447                                            0447
*         DO;                       /* POINT TO THEN                 */
*           INSRTDA=ADDR(CTHEN);    /* ADDR OF THEN                  */
         LA    @15,@CC00727                                        0449
         ST    @15,INSRTDA                                         0449
*           INSRTLN=LENGTH(CTHEN);  /* LENGTH OF THEN                */
         MVC   INSRTLN(4),@CF00107                                 0450
*         END;                      /*                               */
*       ELSE                        /* OTHERWISE                     */
*         DO;                       /* GET VARIABLES INSERT DATA     */
         B     @RC00447                                            0452
@RF00447 DS    0H                                                  0453
*           INSRTLN=SVTLNG;         /* GET INSERT LENGTH             */
         L     @15,SNTELPTR(,COMONPTR)                             0453
         L     @14,SNTVLPTR(,@15)                                  0453
         LH    @07,SVTLNG(,@14)                                    0453
         ST    @07,INSRTLN                                         0453
*           INSRTDA=ADDR(SVTDATA);  /* GET POINTER TO INSERT DATA    */
         LA    @14,SVTDATA(,@14)                                   0454
         ST    @14,INSRTDA                                         0454
*           IF SNTEVAL=YES THEN     /* IF EVALUATION REQUIRED        */
         TM    SNTEVAL(@15),B'00000010'                            0455
         BNO   @RF00455                                            0455
*             CALL IMVALRTN;        /* CALL ROUTINE TO PROCESS EVAL  */
         BAL   @14,IMVALRTN                                        0456
*         END;                                                     0457
@RF00455 DS    0H                                                  0458
*       EXITA=NO;                   /* SAY WE HAVE INSERTED DATA     */
@RC00447 NI    EXITA(COMONPTR),B'01111111'                         0458
*       IF ERROR=F0&WAIT=NO THEN    /* IF NO ERROR FROM BUILT IN FUNC*/
         L     @15,ERROR                                           0459
         LTR   @15,@15                                             0459
         BNZ   @RF00459                                            0459
         TM    WAIT(COMONPTR),B'00010000'                          0459
         BNZ   @RF00459                                            0459
*         DO;                       /* PERFORM INSERT                */
*           IF INSRTLN-LEN>FREEAMT THEN/* IF INSERT DATA IS GREATER  */
         L     @15,INSRTLN                                         0461
         SL    @15,LEN(,COMONPTR)                                  0461
         L     @14,FREEAMT(,COMONPTR)                              0461
         CR    @15,@14                                             0461
         BNH   @RF00461                                            0461
*             CALL GETMORE(INSRTLN-LEN-FREEAMT);/* GET BIGGER BUFFER */
         SLR   @15,@14                                             0462
         ST    @15,@AFTEMPS                                        0462
         LA    @15,@AFTEMPS                                        0462
         ST    @15,@AL00001                                        0462
         LA    @01,@AL00001                                        0462
         BAL   @14,GETMORE                                         0462
*           ELSE                    /* OTHERWISE UPDATE FREE AMOUNT  */
*             FREEAMT=FREEAMT-(INSRTLN-LEN);/* UPDATE FREEAMT        */
         B     @RC00461                                            0463
@RF00461 L     @15,INSRTLN                                         0463
         SL    @15,LEN(,COMONPTR)                                  0463
         LCR   @15,@15                                             0463
         AL    @15,FREEAMT(,COMONPTR)                              0463
         ST    @15,FREEAMT(,COMONPTR)                              0463
*           IF ERROR=F0 THEN        /* NO ERROR FROM GETMORE         */
@RC00461 L     @15,ERROR                                           0464
         LTR   @15,@15                                             0464
         BNZ   @RF00464                                            0464
*             DO;                   /*                               */
*               RFY                                                0466
*                (R2,                                              0466
*                 R3,                                              0466
*                 R4,                                              0466
*                 R5) RSTD;         /* RESTRICT REGISTERS            */
*               R2=ADDR(NEWC);      /* POINT TO NEW BUFFER           */
         L     R2,NEWBASE(,COMONPTR)                               0467
         LA    R2,NEWC(,R2)                                        0467
*               R3=V-F1;            /* LENGTH OF FIRST PART          */
         L     R3,V                                                0468
         BCTR  R3,0                                                0468
*               R4=ADDR(C);         /* POINT TO OLD BUFFER           */
         L     R4,BUFBASE(,COMONPTR)                               0469
         LA    R4,C(,R4)                                           0469
*               R5=R3;              /* SAME LENGTH                   */
         LR    R5,R3                                               0470
*               MVCL(R2,R4);        /* MOVE FIRST PART OF BUFFER     */
         MVCL  R2,R4                                               0471
*               KPTR=R2;            /* SAVE LOC IN BUFFER WHERE DATA
*                                      IS GOING                      */
         ST    R2,KPTR                                             0472
*               R3=INSRTLN;         /* LENGTH OF SYMBOLIC VARIABLE   */
         L     R3,INSRTLN                                          0473
*               R4=INSRTDA;         /* POINT TO SUBSTITUTE DATA      */
         L     R4,INSRTDA                                          0474
*               R5=R3;              /* EQUAL LENGTH                  */
         LR    R5,R3                                               0475
*               MVCL(R2,R4);        /* MOVE IN DATA (R2 UPDATED BY 0476
*                                      MVCL)                         */
         MVCL  R2,R4                                               0476
*               R3=NEWLL-(INSRTLN+V+F3);/* TO LENGTH - ALREADY MOVED */
         L     @15,NEWBASE(,COMONPTR)                              0477
         LA    @14,3                                               0477
         L     R3,INSRTLN                                          0477
         AL    R3,V                                                0477
         ALR   R3,@14                                              0477
         LCR   R3,R3                                               0477
         AH    R3,NEWLL(,@15)                                      0477
*               R4=ADDR(C(I));      /* POINT TO RESUME BUFFER        */
         L     @07,I(,COMONPTR)                                    0478
         L     @06,BUFBASE(,COMONPTR)                              0478
         LA    R4,C-1(@07,@06)                                     0478
*               R5=(LL-(I+F3))×BLANKS;/* THE REMAINING SEGMENT AND 0479
*                                      PAD                           */
         ALR   @07,@14                                             0479
         LCR   @07,@07                                             0479
         AH    @07,LL(,@06)                                        0479
         O     @07,@CF00622                                        0479
         LR    R5,@07                                              0479
*               I=R2-(ADDR(NEWC));  /* POINT I TO RESUME SEGMENT     */
         LA    @15,NEWC(,@15)                                      0480
         LCR   @15,@15                                             0480
         ALR   @15,R2                                              0480
         ST    @15,I(,COMONPTR)                                    0480
*               MVCL(R2,R4);        /* MOVE RESUME PART OF BUFFER    */
         MVCL  R2,R4                                               0481
*               RFY                                                0482
*                (R2,                                              0482
*                 R3,                                              0482
*                 R4,                                              0482
*                 R5) UNRSTD;       /* RELEASE REGISTERS             */
*               IF SNTNOSCN=YES THEN/* IF NO RESCAN ALLOWED          */
         L     @01,SNTELPTR(,COMONPTR)                             0483
         TM    SNTNOSCN(@01),B'00001000'                           0483
         BNO   @RF00483                                            0483
*                 DO K=INSRTLN TO F1 BY-F1;                        0484
         L     @15,INSRTLN                                         0484
         ST    @15,K                                               0484
         B     @DE00484                                            0484
@DL00484 DS    0H                                                  0485
*                   FOLD=YES;       /* FOLD TO SPECIAL CHARS         */
         OI    FOLD(COMONPTR),B'00010000'                          0485
*                   IF KPTR->INSRTCHR(K)=AMPSAND THEN/* NO RESCAN    */
         L     @14,KPTR                                            0486
         ALR   @15,@14                                             0486
         BCTR  @15,0                                               0486
         CLI   INSRTCHR(@15),C'&&'                                 0486
         BNE   @RF00486                                            0486
*                     KPTR->INSRTCHR(K)=NOSCNAMP;/* REQUIRES SPECIAL
*                                      FOLDED NO-RESCAN AMPERSAND    */
         L     @15,K                                               0487
         ALR   @14,@15                                             0487
         BCTR  @14,0                                               0487
         MVI   INSRTCHR(@14),X'03'                                 0487
*                   ELSE                                           0488
*                     TR(KPTR->INSRTCHR(K),TRTABDN);               0488
         B     @RC00486                                            0488
@RF00486 L     @01,KPTR                                            0488
         AL    @01,K                                               0488
         BCTR  @01,0                                               0488
         TR    INSRTCHR(1,@01),TRTABDN                             0488
*                 END;                                             0489
*                                                                  0489
@RC00486 SLR   @15,@15                                             0489
         BCTR  @15,0                                               0489
         AL    @15,K                                               0489
         ST    @15,K                                               0489
@DE00484 LTR   @15,@15                                             0489
         BP    @DL00484                                            0489
*               /*****************************************************/
*               /*                                                   */
*               /* FREE OLD BUFFER IF A NEW ONE WAS GOTTEN           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0490
*               IF FREESW=YES THEN  /* IF FREEMAIN NECESSARY         */
@RF00483 TM    FREESW(COMONPTR),B'00100000'                        0490
         BNO   @RF00490                                            0490
*                 DO;               /*                               */
*                   DO;             /* FREEMAIN LV(FREELEN(1))     0492
*                                      A(FREEADDR) SP(1) MF(E,FRELST)*/
*                     RESPECIFY                                    0493
*                      (GPR01P) RESTRICTED;                        0493
*                     FRELST02=FREELEN(1);/* LENGTH                  */
         MVC   FRELST02(3),FREELEN+1                               0494
*                     FRELST04=ADDR(FREEADDR);/* ADDR OF ADDR LIST   */
         LA    @00,FREEADDR                                        0495
         STCM  @00,7,FRELST04                                      0495
*                     FRELST06=1;   /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'01'                                      0496
*                     GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST     */
         LA    GPR01P,FRELST                                       0497
*                     SVC(5);       /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0498
*                     RESPECIFY                                    0499
*                      (GPR01P) UNRESTRICTED;                      0499
*                   END;            /* FREEMAIN LV(FREELEN(1))     0500
*                                      A(FREEADDR) SP(1) MF(E,FRELST)*/
*                   BUFBASE=NEWBASE;/* RESET POINTER TO BUFFER       */
         L     @15,NEWBASE(,COMONPTR)                              0501
         ST    @15,BUFBASE(,COMONPTR)                              0501
*                   NEWBASE=NEWBASE+LL;/* POINT TO NEW FREE BUFFER   */
         LH    @14,LL(,@15)                                        0502
         ALR   @15,@14                                             0502
         ST    @15,NEWBASE(,COMONPTR)                              0502
*                   NEWLL=LL;       /* INIT LENGTH                   */
         STH   @14,NEWLL(,@15)                                     0503
*                   NEWOO=F0;       /* INIT OFFSET                   */
         SLR   @14,@14                                             0504
         STH   @14,NEWOO(,@15)                                     0504
*                   FREESW=NO;      /* RESET FREESWITCH              */
         NI    FREESW(COMONPTR),B'11011111'                        0505
*                 END;                                             0506
*               ELSE                /* OTHERWISE                     */
*                 DO;                                              0507
         B     @RC00490                                            0507
@RF00490 DS    0H                                                  0508
*                   BUFBASE=BUFBASE&&NEWBASE;/* SWAP BUFFER POINTERS */
         L     @15,NEWBASE(,COMONPTR)                              0508
         L     @14,BUFBASE(,COMONPTR)                              0508
         XR    @14,@15                                             0508
         ST    @14,BUFBASE(,COMONPTR)                              0508
*                   NEWBASE=NEWBASE&&BUFBASE;/*                      */
         XR    @15,@14                                             0509
         ST    @15,NEWBASE(,COMONPTR)                              0509
*                   BUFBASE=BUFBASE&&NEWBASE;/*                      */
         XR    @14,@15                                             0510
         ST    @14,BUFBASE(,COMONPTR)                              0510
*                 END;                                             0511
*             END;                                                 0512
*         END;                                                     0513
*       ELSE                        /* OTHERWISE                     */
*         WAIT=NO;                  /* TURN OFFF WAIT                */
         B     @RC00459                                            0514
@RF00459 NI    WAIT(COMONPTR),B'11101111'                          0514
*     END;                                                         0515
*   END INSERT;                                                    0516
@EL00004 DS    0H                                                  0516
@EF00004 DS    0H                                                  0516
@ER00004 LM    @14,@12,@SA00004                                    0516
         BR    @14                                                 0516
*                                                                  0517
*   /*****************************************************************/
*   /*                                                               */
*   /* GET BIGGER BUFFER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0517
*GETMORE:                                                          0517
*   PROC(MINIMUM);                                                 0517
GETMORE  STM   @14,@12,12(@13)                                     0517
         MVC   @PC00005(4),0(@01)                                  0517
*   DCL                                                            0518
*     MINIMUM FIXED(31);                                           0518
*   HOWMUCH=F16*((GAS+MINIMUM+LL)/F8);/* CALCULATE HOWMUCH TO GET    */
         L     @15,@PC00005                                        0519
         LA    @00,200                                             0519
         AL    @00,MINIMUM(,@15)                                   0519
         L     @15,BUFBASE(,COMONPTR)                              0519
         LH    @14,LL(,@15)                                        0519
         ALR   @00,@14                                             0519
         SRDA  @00,32                                              0519
         D     @00,@CF00094                                        0519
         SLA   @01,4                                               0519
         ST    @01,HOWMUCH                                         0519
*   IF CORE=YES THEN                /* IF ALREADY CORE               */
         TM    CORE(COMONPTR),B'10000000'                          0520
         BNO   @RF00520                                            0520
*     DO;                           /* FIND ADDR OF OLD CORE         */
*       FREESW=YES;                 /* ALLOW FREEMAIN                */
         OI    FREESW(COMONPTR),B'00100000'                        0522
*       FREEADDR(1)=MIN(BUFBASE,NEWBASE);/* GET LOW ADDR FOR FREE    */
         L     @07,NEWBASE(,COMONPTR)                              0523
         CR    @15,@07                                             0523
         BNH   *+6
         LR    @15,@07                                             0523
         ST    @15,FREEADDR                                        0523
*       FREELEN(1)=LL*F2;           /* AMOUNT TO FREE                */
         ALR   @14,@14                                             0524
         ST    @14,FREELEN                                         0524
*     END;                          /*                               */
*   DO;                             /* GETMAIN LV(HOWMUCH) A(NEWBASE)
*                                      SP(1) MF(E,GETLST)          0526
*                                      RTCD(RETURNCD)                */
@RF00520 DS    0H                                                  0527
*     RESPECIFY                                                    0527
*      (GPR01P,                                                    0527
*       GPR15F) RESTRICTED;                                        0527
*     GETLST01=HOWMUCH;             /* LENGTH                        */
         L     @14,HOWMUCH                                         0528
         ST    @14,GETLST01                                        0528
*     GETLST03=ADDR(NEWBASE);       /* ADDR OF ADDR LIST             */
         LA    @14,NEWBASE(,COMONPTR)                              0529
         STCM  @14,7,GETLST03                                      0529
*     GETLST05=1;                   /* SUBPOOL VALUE                 */
         MVI   GETLST05,X'01'                                      0530
*     GPR01P=ADDR(GETLST);          /* REG1 POINTS TO LIST           */
         LA    GPR01P,GETLST                                       0531
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0532
*     RETURNCD=GPR15F;              /* SET RETURN CODE               */
         ST    GPR15F,RETURNCD                                     0533
*     RESPECIFY                                                    0534
*      (GPR01P,                                                    0534
*       GPR15F) UNRESTRICTED;                                      0534
*   END;                            /* GETMAIN LV(HOWMUCH) A(NEWBASE)
*                                      SP(1) MF(E,GETLST)          0535
*                                      RTCD(RETURNCD)                */
*   IF ERROR=F0&RETURNCD^=F0 THEN   /* GETMAIN FAIL                  */
         SLR   @15,@15                                             0536
         C     @15,ERROR                                           0536
         BNE   @RF00536                                            0536
         L     @14,RETURNCD                                        0536
         CR    @14,@15                                             0536
         BE    @RF00536                                            0536
*     DO;                           /* AND PROCESS ORIG BUFFER       */
*       IF CORE=NO THEN             /* POINT TO ORIG BUFFER          */
         TM    CORE(COMONPTR),B'10000000'                          0538
         BNZ   @RF00538                                            0538
*         NEWBASE=BUFBASE;          /* FOR SQUASH                    */
         L     @15,BUFBASE(,COMONPTR)                              0539
         ST    @15,NEWBASE(,COMONPTR)                              0539
*       ERROR=E16;                  /* SET ERROR CODE                */
@RF00538 MVC   ERROR(4),@CF00104                                   0540
*     END;                                                         0541
*   ELSE                                                           0542
*     DO;                           /*                               */
         B     @RC00536                                            0542
@RF00536 DS    0H                                                  0543
*       NEWLL=HOWMUCH/F2;           /* SET NEW LL                    */
         L     @15,NEWBASE(,COMONPTR)                              0543
         L     @00,HOWMUCH                                         0543
         SRDA  @00,32                                              0543
         D     @00,@CF00062                                        0543
         STH   @01,NEWLL(,@15)                                     0543
*       FREEAMT=NEWLL-(LL+MINIMUM); /* RESET FREEAMT                 */
         L     @14,BUFBASE(,COMONPTR)                              0544
         L     @07,@PC00005                                        0544
         LH    @06,LL(,@14)                                        0544
         AL    @06,MINIMUM(,@07)                                   0544
         SLR   @01,@06                                             0544
         ST    @01,FREEAMT(,COMONPTR)                              0544
*       NEWOO=F0;                   /* INIT OFFSET TO ZERO           */
         SLR   @14,@14                                             0545
         STH   @14,NEWOO(,@15)                                     0545
*     END;                          /*                               */
*   END GETMORE;                                                   0547
@EL00005 DS    0H                                                  0547
@EF00005 DS    0H                                                  0547
@ER00005 LM    @14,@12,12(@13)                                     0547
         BR    @14                                                 0547
*                                                                  0548
*   /*****************************************************************/
*   /*                                                               */
*   /* REMOVE ONE CHARACTER FROM BUFFER                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0548
*SQUASH:                                                           0548
*   PROC;                                                          0548
SQUASH   STM   @14,@12,12(@13)                                     0548
*   RFY                                                            0549
*    (R2,                                                          0549
*     R3,                                                          0549
*     R4,                                                          0549
*     R5) RSTD;                     /* RESTRICT REGISTERS            */
*   R2=ADDR(C(I));                  /* ADDRESS OF 'TO'               */
         L     @15,I(,COMONPTR)                                    0550
         L     @14,BUFBASE(,COMONPTR)                              0550
         LA    R2,C-1(@15,@14)                                     0550
*   R4=ADDR(C(I+F1));               /* ADDRESS OF 'FROM'             */
         LA    R4,C(@15,@14)                                       0551
*   R3=LL-(I+F3);                   /* LENGTH OF 'TO'                */
         AL    @15,@CF00054                                        0552
         LCR   @15,@15                                             0552
         AH    @15,LL(,@14)                                        0552
         LR    R3,@15                                              0552
*   R5=(R3-F1)×BLANKS;              /* LENGTH OF 'FROM' AND PADDING
*                                      CHARACTER FOR LONGER 'TO' AREA*/
         LR    R5,R3                                               0553
         BCTR  R5,0                                                0553
         O     R5,@CF00622                                         0553
*   MVCL(R2,R4);                    /* SQUASH BUFFER                 */
         MVCL  R2,R4                                               0554
*   RFY                                                            0555
*    (R2,                                                          0555
*     R3,                                                          0555
*     R4,                                                          0555
*     R5) UNRSTD;                   /* RELEASE REGISTERS             */
*   FREEAMT=FREEAMT+F1;             /* ADD REMOVED BYTE TO FREEAMT   */
         LA    @15,1                                               0556
         AL    @15,FREEAMT(,COMONPTR)                              0556
         ST    @15,FREEAMT(,COMONPTR)                              0556
*   END SQUASH;                                                    0557
@EL00006 DS    0H                                                  0557
@EF00006 DS    0H                                                  0557
@ER00006 LM    @14,@12,12(@13)                                     0557
         BR    @14                                                 0557
*                                                                  0558
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN POINTER UPDATE ROUTINE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0558
*RETUPDT:                                                          0558
*   PROC(NEXTCMD);                                                 0558
RETUPDT  STM   @14,@12,12(@13)                                     0558
         MVC   @PC00007(4),0(@01)                                  0558
*   DCL                                                            0559
*     NEXTCMD FIXED(31);            /* THE NEXT COMMAND AFTER THE ONE
*                                      INTERRUPTED FROM              */
*   RETPTR2=RETPTR;                 /* SWAP AND SAVE RETURN          */
         L     @15,EXECDPTR(,COMONPTR)                             0560
         L     @14,RETPTR(,@15)                                    0560
         ST    @14,RETPTR2(,@15)                                   0560
*   RETPTR=NEXTCMD;                 /* SAVE ANSWER                   */
         L     @14,@PC00007                                        0561
         L     @14,NEXTCMD(,@14)                                   0561
         ST    @14,RETPTR(,@15)                                    0561
*   END RETUPDT;                    /*                               */
@EL00007 DS    0H                                                  0562
@EF00007 DS    0H                                                  0562
@ER00007 LM    @14,@12,12(@13)                                     0562
         BR    @14                                                 0562
*                                                                  0563
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBSTRING FUNCTION                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0563
*SUBSTRTN:                                                         0563
*   PROC OPTIONS(SAVEAREA);                                        0563
SUBSTRTN STM   @14,@12,12(@13)                                     0563
         ST    @13,@SA00008+4                                      0563
         LA    @14,@SA00008                                        0563
         ST    @14,8(,@13)                                         0563
         LR    @13,@14                                             0563
*   CALL WAITRTN;                   /* CHECK IF '&' VARIABLE IN RNGE */
         BAL   @14,WAITRTN                                         0564
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK TO PROCEED THEN         */
         TM    WAIT(COMONPTR),B'00010000'                          0565
         BNZ   @RF00565                                            0565
         L     @15,ERROR                                           0565
         LTR   @15,@15                                             0565
         BNZ   @RF00565                                            0565
*     DO;                           /* GET RANGE TO PROCESS          */
*       CSAVE=C(I-F1:I);            /* SAVE ORIGINAL BUFFER          */
         L     @15,I(,COMONPTR)                                    0567
         L     @14,BUFBASE(,COMONPTR)                              0567
         ALR   @15,@14                                             0567
         MVC   CSAVE(2),C-2(@15)                                   0567
*       C(I-F1:I)=XEQUAL;           /* MAKE RANGE LOOK LINE SET STMT */
         L     @15,I(,COMONPTR)                                    0568
         ALR   @15,@14                                             0568
         MVC   C-2(2,@15),@CC00632                                 0568
*       BUFPTR=ADDR(C(I-F1));       /* POINT TO DUMMY SET STATEMENT  */
         L     @15,I(,COMONPTR)                                    0569
         LA    @15,C-2(@15,@14)                                    0569
         ST    @15,BUFPTR(,COMONPTR)                               0569
*       DO CLEN=F3 TO M-I+F1 WHILE BUF(CLEN)^=COLON&BUF(CLEN)^=COMMA;
         LA    @15,3                                               0570
         B     @DE00570                                            0570
@DL00570 LH    @15,CLEN(,COMONPTR)                                 0570
         L     @14,BUFPTR(,COMONPTR)                               0570
         ALR   @15,@14                                             0570
         BCTR  @15,0                                               0570
         CLI   BUF(@15),C':'                                       0570
         BE    @DC00570                                            0570
         LH    @15,CLEN(,COMONPTR)                                 0570
         ALR   @14,@15                                             0570
         BCTR  @14,0                                               0570
         CLI   BUF(@14),C','                                       0570
         BE    @DC00570                                            0570
*                                   /*                               */
*       END;                        /* AND LENGTH OF DUMMY STMT      */
         LA    @15,1                                               0571
         AH    @15,CLEN(,COMONPTR)                                 0571
@DE00570 STH   @15,CLEN(,COMONPTR)                                 0571
         L     @14,M                                               0571
         SL    @14,I(,COMONPTR)                                    0571
         AL    @14,@CF00042                                        0571
         CR    @15,@14                                             0571
         BNH   @DL00570                                            0571
@DC00570 DS    0H                                                  0572
*       IF BUF(CLEN)=':' THEN       /* IF COLON FOUND, THE SET RANGE */
         LH    @01,CLEN(,COMONPTR)                                 0572
         L     @15,BUFPTR(,COMONPTR)                               0572
         ALR   @15,@01                                             0572
         BCTR  @15,0                                               0572
         CLI   BUF(@15),C':'                                       0572
         BNE   @RF00572                                            0572
*         RANGE=YES;                /* SWITCH                        */
         OI    RANGE(COMONPTR),B'00001000'                         0573
*       ELSE                        /* CHECK FOR STRING DELIM        */
*         IF BUF(CLEN)=COMMA THEN   /* IF IT IS                      */
         B     @RC00572                                            0574
@RF00572 LH    @15,CLEN(,COMONPTR)                                 0574
         L     @14,BUFPTR(,COMONPTR)                               0574
         ALR   @15,@14                                             0574
         BCTR  @15,0                                               0574
         CLI   BUF(@15),C','                                       0574
         BNE   @RF00574                                            0574
*           DO;                     /* INIT INSERT START AND LENGTH  */
*             INSRTDA=ADDR(BUF(CLEN+F1));/* BEGIN OF STRING          */
         LH    @15,CLEN(,COMONPTR)                                 0576
         LA    @15,BUF(@15,@14)                                    0576
         ST    @15,INSRTDA                                         0576
*             INSRTLN=ADDR(C(M))-INSRTDA;/* LENGTH OF STRING         */
         L     @01,BUFBASE(,COMONPTR)                              0577
         L     @14,M                                               0577
         LA    @14,C-1(@14,@01)                                    0577
         SLR   @14,@15                                             0577
         ST    @14,INSRTLN                                         0577
*             RANGE=NO;             /* RE-INIT RANGE SWITCH  @ZA24504*/
         NI    RANGE(COMONPTR),B'11110111'                         0578
*           END;                    /*                               */
*       IF ERROR=F0 THEN            /* IF OK UNTIL NOW               */
@RF00574 DS    0H                                                  0580
@RC00572 SLR   @15,@15                                             0580
         C     @15,ERROR                                           0580
         BNE   @RF00580                                            0580
*         DO;                       /* THEN CONTINUE                 */
*           CLEN=CLEN-F1;           /* DECREMENT CLEN FROM DO INCR   */
         LH    @14,CLEN(,COMONPTR)                                 0582
         BCTR  @14,0                                               0582
         STH   @14,CLEN(,COMONPTR)                                 0582
*           TYPE=F0;                /* ALLOW ONLY NUMERIC STMT       */
         ST    @15,TYPE(,COMONPTR)                                 0583
*           LEN1=CLEN;              /* SAVE LENGTH OF FIRST STMT     */
         ST    @14,LEN1                                            0584
*           RFY                                                    0585
*            (R15) RSTD;            /* RESTRICT R15 FOR RETURNCD     */
*           CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS EXPRESSOIN */
         L     @14,BUFPTR(,COMONPTR)                               0586
         ST    @14,@AL00001                                        0586
         LA    @14,CLEN(,COMONPTR)                                 0586
         ST    @14,@AL00001+4                                      0586
         LA    @14,TYPE(,COMONPTR)                                 0586
         ST    @14,@AL00001+8                                      0586
         LA    @14,OUTA1                                           0586
         ST    @14,@AL00001+12                                     0586
         L     @15,@CV00098                                        0586
         LA    @01,@AL00001                                        0586
         BALR  @14,@15                                             0586
*           ERROR=R15;              /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0587
*           C(I-F1:I)=CSAVE;        /* RESTORE ORIGINAL BUFFER       */
         L     @14,I(,COMONPTR)                                    0588
         L     @01,BUFBASE(,COMONPTR)                              0588
         ALR   @01,@14                                             0588
         MVC   C-2(2,@01),CSAVE                                    0588
*           RFY                                                    0589
*            (R15) UNRSTD;          /* RELEASE R15                   */
*                                                                  0590
*           /*********************************************************/
*           /*                                                       */
*           /* PROCESS SUBSTRING                                     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0590
*           IF ERROR=F0 THEN        /* IF OK                         */
         L     @15,ERROR                                           0590
         LTR   @15,@15                                             0590
         BNZ   @RF00590                                            0590
*             DO;                   /* CONVERT ANSWER TO USEABLE     */
*               CALL CONVERT;       /* FORM                          */
         BAL   @14,CONVERT                                         0592
*               V1=V2;              /* SET START OF RANGE            */
         L     @15,V2                                              0593
         ST    @15,V1                                              0593
*               IF ERROR=F0&RANGE=YES THEN/* IF RANGE, THEN FIND   0594
*                                      VALUE 2                       */
         L     @15,ERROR                                           0594
         LTR   @15,@15                                             0594
         BNZ   @RF00594                                            0594
         TM    RANGE(COMONPTR),B'00001000'                         0594
         BNO   @RF00594                                            0594
*                 DO;               /*                               */
*                   BUFPTR=ADDR(BUF(LEN1));/* POINT TO DUMMY STMT  0596
*                                      NUMBER 2                      */
         L     @01,BUFPTR(,COMONPTR)                               0596
         L     @15,LEN1                                            0596
         BCTR  @01,0                                               0596
         LA    @15,BUF(@15,@01)                                    0596
         ST    @15,BUFPTR(,COMONPTR)                               0596
*                   CSAVE=BUF(F1:F2);/* SAVE ORIGINAL BUFFER         */
         MVC   CSAVE(2),BUF(@15)                                   0597
*                   BUF(F1:F2)=XEQUAL;/* CREATE DUMMY STMT           */
         MVC   BUF(2,@15),@CC00632                                 0598
*                   DO CLEN=F3 TO M-(I+LEN1)+F2 WHILE BUF(CLEN)^=COMMA;
         LA    @15,3                                               0599
         B     @DE00599                                            0599
@DL00599 LH    @01,CLEN(,COMONPTR)                                 0599
         L     @15,BUFPTR(,COMONPTR)                               0599
         ALR   @15,@01                                             0599
         BCTR  @15,0                                               0599
         CLI   BUF(@15),C','                                       0599
         BE    @DC00599                                            0599
*                   END;                                           0600
         LA    @15,1                                               0600
         AH    @15,CLEN(,COMONPTR)                                 0600
@DE00599 STH   @15,CLEN(,COMONPTR)                                 0600
         L     @14,I(,COMONPTR)                                    0600
         AL    @14,LEN1                                            0600
         LCR   @14,@14                                             0600
         AL    @14,M                                               0600
         AL    @14,@CF00062                                        0600
         CR    @15,@14                                             0600
         BNH   @DL00599                                            0600
@DC00599 DS    0H                                                  0601
*                   INSRTDA=ADDR(BUF(CLEN+1));/* POINT TO INSERT DATA*/
         LH    @15,CLEN(,COMONPTR)                                 0601
         L     @14,BUFPTR(,COMONPTR)                               0601
         LA    @07,BUF(@15,@14)                                    0601
         ST    @07,INSRTDA                                         0601
*                   INSRTLN=ADDR(C(M))-INSRTDA;/* GET LENGTH OF DATA */
         L     @01,BUFBASE(,COMONPTR)                              0602
         L     @06,M                                               0602
         LA    @06,C-1(@06,@01)                                    0602
         SLR   @06,@07                                             0602
         ST    @06,INSRTLN                                         0602
*                   CLEN=CLEN-F1;   /* BACK PAST COMMA               */
         BCTR  @15,0                                               0603
         STH   @15,CLEN(,COMONPTR)                                 0603
*                   TYPE=F0;        /* ALLOW ONLY NUMERIC            */
         SLR   @15,@15                                             0604
         ST    @15,TYPE(,COMONPTR)                                 0604
*                   RFY                                            0605
*                    (R15) RSTD;    /* RESTRICT R15 FOR RETURN CODE  */
*                   CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS  0606
*                                      NUMBER 2                      */
         ST    @14,@AL00001                                        0606
         LA    @14,CLEN(,COMONPTR)                                 0606
         ST    @14,@AL00001+4                                      0606
         LA    @14,TYPE(,COMONPTR)                                 0606
         ST    @14,@AL00001+8                                      0606
         LA    @14,OUTA1                                           0606
         ST    @14,@AL00001+12                                     0606
         L     @15,@CV00098                                        0606
         LA    @01,@AL00001                                        0606
         BALR  @14,@15                                             0606
*                   ERROR=R15;      /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0607
*                   BUF(F1:F2)=CSAVE;/* RESTORE OLD BUFFER           */
         L     @14,BUFPTR(,COMONPTR)                               0608
         MVC   BUF(2,@14),CSAVE                                    0608
*                   RFY                                            0609
*                    (R15) UNRSTD;  /* RELEASE R15                   */
*                   IF ERROR=F0 THEN/* IF OKAY                       */
         L     @15,ERROR                                           0610
         LTR   @15,@15                                             0610
         BNZ   @RF00610                                            0610
*                     DO;           /* CHECK FOR VALID RANGE         */
*                       CALL CONVERT;/* CONVERT NUMBER 2 TO USABLE   */
         BAL   @14,CONVERT                                         0612
*                       IF ERROR=F0&V1>V2 THEN/* FORM AND CHECK RANGE*/
         L     @15,ERROR                                           0613
         LTR   @15,@15                                             0613
         BNZ   @RF00613                                            0613
         L     @15,V1                                              0613
         C     @15,V2                                              0613
         BNH   @RF00613                                            0613
*                         ERROR=E912;/* SET ERROR CODE               */
         MVC   ERROR(4),@CF00787                                   0614
*                     END;          /*                               */
@RF00613 DS    0H                                                  0616
*                 END;                                             0616
@RF00610 DS    0H                                                  0617
*               IF ERROR=F0 THEN    /* IF EVERYTHING STILL OK        */
@RF00594 SLR   @15,@15                                             0617
         C     @15,ERROR                                           0617
         BNE   @RF00617                                            0617
*                 IF V2>INSRTLN×V1=F0 THEN/* IF OUTSIDE RANGE, SET 0618
*                                      ERROR                         */
         L     @14,V2                                              0618
         C     @14,INSRTLN                                         0618
         BH    @RT00618                                            0618
         C     @15,V1                                              0618
         BNE   @RF00618                                            0618
@RT00618 DS    0H                                                  0619
*                   ERROR=E932;     /* INDICATOR                     */
         MVC   ERROR(4),@CF00797                                   0619
*                 ELSE              /*                               */
*                   DO;             /* SET UP INSERT INFO            */
         B     @RC00618                                            0620
@RF00618 DS    0H                                                  0621
*                     INSRTLN=V2-V1+F1;/* LENGTH OF INSERT DATA      */
         LA    @15,1                                               0621
         L     @14,V1                                              0621
         L     @07,V2                                              0621
         SLR   @07,@14                                             0621
         ALR   @07,@15                                             0621
         ST    @07,INSRTLN                                         0621
*                     INSRTDA=INSRTDA+V1-F1;/* POINTER TO INSERT DATA*/
         AL    @14,INSRTDA                                         0622
         BCTR  @14,0                                               0622
         ST    @14,INSRTDA                                         0622
*                     DO I=1 TO INSRTLN;/* NUMBER OF CHARS           */
         B     @DE00623                                            0623
@DL00623 DS    0H                                                  0624
*                       TR(INSRTCHR(I),TRTABDN);/* FOLD TO SPCL CHRS */
         L     @01,I(,COMONPTR)                                    0624
         L     @15,INSRTDA                                         0624
         ALR   @15,@01                                             0624
         BCTR  @15,0                                               0624
         TR    INSRTCHR(1,@15),TRTABDN                             0624
*                     END;          /*                               */
         LA    @15,1                                               0625
         AL    @15,I(,COMONPTR)                                    0625
@DE00623 ST    @15,I(,COMONPTR)                                    0625
         C     @15,INSRTLN                                         0625
         BNH   @DL00623                                            0625
*                     I=M+F1;       /* POINT I TO RESUME DATA        */
         LA    @15,1                                               0626
         AL    @15,M                                               0626
         ST    @15,I(,COMONPTR)                                    0626
*                   END;            /*                               */
*             END;                  /*                               */
*         END;                      /*                               */
*     END;                          /*                               */
*   END SUBSTRTN;                   /*                               */
@EL00008 L     @13,4(,@13)                                         0631
@EF00008 DS    0H                                                  0631
@ER00008 LM    @14,@12,12(@13)                                     0631
         BR    @14                                                 0631
*                                                                  0632
*   /*****************************************************************/
*   /*                                                               */
*   /* WAIT ROUTINE                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0632
*WAITRTN:                                                          0632
*   PROC;                                                          0632
WAITRTN  STM   @14,@12,12(@13)                                     0632
*   PCTR=F1;                        /* INIT PAREN COUNTER            */
         MVC   PCTR(4),@CF00042                                    0633
*   SENTINAL=NO;                    /* CLEAR SWITCH                  */
*   FOLD=YES;                       /* INDICATE POSSIBLE FOLD        */
         OI    FOLD(COMONPTR),B'00010000'                          0635
         NI    SENTINAL(COMONPTR),B'01111111'                      0635
*   M=I;                            /* START OF PSTRING SCAN         */
         L     @15,I(,COMONPTR)                                    0636
         ST    @15,M                                               0636
*   IF M>LL-(FREEAMT+F4)×(C(M)^=LPAREN&/* PAST BFR OR NO '('         */
*       C(M)^=SENTNLL) THEN         /* OR LEFT SENTINAL              */
         L     @14,BUFBASE(,COMONPTR)                              0637
         LA    @07,4                                               0637
         AL    @07,FREEAMT(,COMONPTR)                              0637
         LCR   @07,@07                                             0637
         AH    @07,LL(,@14)                                        0637
         CR    @15,@07                                             0637
         BH    @RT00637                                            0637
         ALR   @15,@14                                             0637
         CLI   C-1(@15),C'('                                       0637
         BE    @RF00637                                            0637
         L     @15,M                                               0637
         ALR   @14,@15                                             0637
         CLI   C-1(@14),X'01'                                      0637
         BE    @RF00637                                            0637
@RT00637 DS    0H                                                  0638
*     ERROR=E936;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00799                                   0638
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* FIND END OF BIF               */
         B     @RC00637                                            0639
@RF00637 DS    0H                                                  0640
*       IF C(M)=SENTNLL THEN        /* IF SENTINAL PROCESSING        */
         L     @01,BUFBASE(,COMONPTR)                              0640
         AL    @01,M                                               0640
         CLI   C-1(@01),X'01'                                      0640
         BNE   @RF00640                                            0640
*         SENTINAL=YES;             /* SETIN SWITCH                  */
         OI    SENTINAL(COMONPTR),B'10000000'                      0641
*       ELSE                        /* OTHERWISE                     */
*         C(M)=SENTNLL;             /* FLAG AS SENTINAL PROCESS      */
         B     @RC00640                                            0642
@RF00640 L     @01,BUFBASE(,COMONPTR)                              0642
         AL    @01,M                                               0642
         MVI   C-1(@01),X'01'                                      0642
*       DO M=M+F1 TO LL-(F4+FREEAMT) WHILE PCTR>F0;/* FIND END OF BF */
@RC00640 LA    @15,1                                               0643
         AL    @15,M                                               0643
         B     @DE00643                                            0643
@DL00643 L     @14,PCTR                                            0643
         LTR   @14,@14                                             0643
         BNP   @DC00643                                            0643
*         IF M<LL-(F4+FREEAMT)&C(M:M+F1)=DAMPSAND THEN/* NOT D AMP   */
         L     @14,BUFBASE(,COMONPTR)                              0644
         LA    @07,4                                               0644
         AL    @07,FREEAMT(,COMONPTR)                              0644
         LCR   @07,@07                                             0644
         AH    @07,LL(,@14)                                        0644
         CR    @15,@07                                             0644
         BNL   @RF00644                                            0644
         ALR   @14,@15                                             0644
         CLC   C-1(2,@14),@CC00662                                 0644
         BNE   @RF00644                                            0644
*           M=M+F1;                 /* SKIP OVER                     */
         AL    @15,@CF00042                                        0645
         ST    @15,M                                               0645
*         ELSE                      /* CHECK IF A SINGLE AMPERSAND   */
*           IF C(M)=AMPSAND THEN    /* IF IT IS THEN                 */
         B     @RC00644                                            0646
@RF00644 L     @01,BUFBASE(,COMONPTR)                              0646
         AL    @01,M                                               0646
         CLI   C-1(@01),C'&&'                                      0646
         BNE   @RF00646                                            0646
*             WAIT=YES;             /* SET WAIT SWITCH               */
         OI    WAIT(COMONPTR),B'00010000'                          0647
*           ELSE                    /* OTHERWISE                     */
*             IF C(M)=SENTNLR THEN  /* IF A SENTINAL                 */
         B     @RC00646                                            0648
@RF00646 L     @15,M                                               0648
         L     @01,BUFBASE(,COMONPTR)                              0648
         ALR   @01,@15                                             0648
         CLI   C-1(@01),X'02'                                      0648
         BNE   @RF00648                                            0648
*               DO;                 /* CHECK IF SENTINAL MODE        */
*                 PCTR=F0;          /* TERMINATE SCAN                */
         SLR   @14,@14                                             0650
         ST    @14,PCTR                                            0650
*                 IF SENTINAL=NO THEN/* IF IN SENTINAL MODE          */
         TM    SENTINAL(COMONPTR),B'10000000'                      0651
         BNZ   @RF00651                                            0651
*                   M=M-F1;         /* DONT COUNT SENTINAL           */
         BCTR  @15,0                                               0652
         ST    @15,M                                               0652
*               END;                /* IF A CLOSE PAREN              */
*             ELSE                  /* IF NOT SENTINAL               */
*               IF SENTINAL=NO THEN /* IF IN SENTINAL MODE           */
         B     @RC00648                                            0654
@RF00648 TM    SENTINAL(COMONPTR),B'10000000'                      0654
         BNZ   @RF00654                                            0654
*                 DO;               /* SKIP PAREN CHECK              */
*                   IF C(M)=RPAREN THEN/* IF A CLOSE PAREN           */
         L     @15,M                                               0656
         L     @14,BUFBASE(,COMONPTR)                              0656
         ALR   @15,@14                                             0656
         CLI   C-1(@15),C')'                                       0656
         BNE   @RF00656                                            0656
*                     DO;           /* DECREMENT COUNT               */
*                       PCTR=PCTR-F1;/*                              */
         L     @15,PCTR                                            0658
         BCTR  @15,0                                               0658
         ST    @15,PCTR                                            0658
*                       IF PCTR=F0 THEN/* IF PAREN COUNT IS ZERO     */
         LTR   @15,@15                                             0659
         BNZ   @RF00659                                            0659
*                         C(M)=SENTNLR;/* PAREN TO SENTINAL          */
         L     @15,M                                               0660
         ALR   @14,@15                                             0660
         MVI   C-1(@14),X'02'                                      0660
*                     END;          /*                               */
*                   ELSE            /* OTHERWISE                     */
*                     IF C(M)=LPAREN THEN/* IF AN OPEN PAREN         */
         B     @RC00656                                            0662
@RF00656 L     @01,BUFBASE(,COMONPTR)                              0662
         AL    @01,M                                               0662
         CLI   C-1(@01),C'('                                       0662
         BNE   @RF00662                                            0662
*                       PCTR=PCTR+F1;/* INCREMENT THE PAREN COUNT    */
         LA    @15,1                                               0663
         AL    @15,PCTR                                            0663
         ST    @15,PCTR                                            0663
*                 END;              /*                               */
@RF00662 DS    0H                                                  0664
@RC00656 DS    0H                                                  0665
*       END;                        /*                               */
@RF00654 DS    0H                                                  0665
@RC00648 DS    0H                                                  0665
@RC00646 DS    0H                                                  0665
@RC00644 LA    @15,1                                               0665
         AL    @15,M                                               0665
@DE00643 ST    @15,M                                               0665
         L     @14,BUFBASE(,COMONPTR)                              0665
         LA    @07,4                                               0665
         AL    @07,FREEAMT(,COMONPTR)                              0665
         LCR   @07,@07                                             0665
         AH    @07,LL(,@14)                                        0665
         CR    @15,@07                                             0665
         BNH   @DL00643                                            0665
@DC00643 DS    0H                                                  0666
*     END;                          /*                               */
*   LEN=M-V;                        /* ADJUST LEN FOR WHOLE BIF      */
@RC00637 L     @15,M                                               0667
         LR    @14,@15                                             0667
         SL    @14,V                                               0667
         ST    @14,LEN(,COMONPTR)                                  0667
*   IF PCTR=F0 THEN                 /* IF CLOSE PAREN FOUND          */
         L     @14,PCTR                                            0668
         LTR   @14,@14                                             0668
         BNZ   @RF00668                                            0668
*     M=M-F1;                       /* DECREMENT M                   */
         BCTR  @15,0                                               0669
         ST    @15,M                                               0669
*   END WAITRTN;                                                   0670
@EL00009 DS    0H                                                  0670
@EF00009 DS    0H                                                  0670
@ER00009 LM    @14,@12,12(@13)                                     0670
         BR    @14                                                 0670
*                                                                  0671
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT ROUTINE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0671
*CONVERT:                                                          0671
*   PROC;                                                          0671
CONVERT  STM   @14,@12,12(@13)                                     0671
*   DCL                                                            0672
*     NDX FIXED(31);                /* INDEX TO ANSWER               */
*   AREA=ZEROS;                     /* PLACE ZEROS IN AREA           */
         MVC   AREA(16),@CC00619                                   0673
*   IF ANSWER(F1)=MINUS THEN        /* IF ANSWER IS NEGATIVE         */
         L     @01,ANSPTR(,COMONPTR)                               0674
         CLI   ANSWER(@01),C'-'                                    0674
         BNE   @RF00674                                            0674
*     ERCOM=E920;                   /* SET ERROR CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00791                          0675
*   ELSE                            /* OTHERWISE OK                  */
*     DO;                           /* BUILD PACKAREA                */
         B     @RC00674                                            0676
@RF00674 DS    0H                                                  0677
*       IF CLEN<F1×CLEN>F16 THEN    /* IF ANS NOT NUMERIC OR NULL    */
         LH    @15,CLEN(,COMONPTR)                                 0677
         LTR   @15,@15                                             0677
         BNP   @RT00677                                            0677
         C     @15,@CF00104                                        0677
         BNH   @RF00677                                            0677
@RT00677 DS    0H                                                  0678
*         ERCOM=E924;               /* SET ERROR CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00793                          0678
*       ELSE                        /* IF OK THEN MOVE INTO AREA     */
*         AREA(F17-CLEN:F16)=ANSWER(F1:CLEN);/* MOVE IN VARIABLE   0679
*                                      ANSWER                        */
         B     @RC00677                                            0679
@RF00677 LA    @15,17                                              0679
         SH    @15,CLEN(,COMONPTR)                                 0679
         LA    @14,AREA-1(@15)                                     0679
         LCR   @15,@15                                             0679
         AL    @15,@CF00104                                        0679
         L     @01,ANSPTR(,COMONPTR)                               0679
         EX    @15,@SM01104                                        0679
*       DO NDX=F16 TO F1 BY-F1 WHILE ERCOM=F0;/* CHECK FOR ALPHA   0680
*                                      ANSWER                        */
@RC00677 LA    @15,16                                              0680
         ST    @15,NDX                                             0680
@DL00680 L     @14,ERCOM(,COMONPTR)                                0680
         LTR   @14,@14                                             0680
         BNZ   @DC00680                                            0680
*         IF AREA(NDX)<CC0×AREA(NDX)>CC9 THEN/*                      */
         LA    @14,AREA-1(@15)                                     0681
         CLI   0(@14),C'0'                                         0681
         BL    @RT00681                                            0681
         LA    @14,AREA-1(@15)                                     0681
         CLI   0(@14),C'9'                                         0681
         BNH   @RF00681                                            0681
@RT00681 DS    0H                                                  0682
*           ERCOM=E916;             /* SET ERROR CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00789                          0682
*       END;                                                       0683
@RF00681 SLR   @15,@15                                             0683
         BCTR  @15,0                                               0683
         AL    @15,NDX                                             0683
         ST    @15,NDX                                             0683
         LTR   @15,@15                                             0683
         BP    @DL00680                                            0683
@DC00680 DS    0H                                                  0684
*       IF ERCOM=F0 THEN            /* IF NO ERROR SO FAR            */
         L     @15,ERCOM(,COMONPTR)                                0684
         LTR   @15,@15                                             0684
         BNZ   @RF00684                                            0684
*         DO;                       /* PACK INTO USABLE FORM         */
*           PACK(WORKAREA,AREA);    /* ISSUE PACK                    */
         PACK  WORKAREA(8),AREA(16)                                0686
*           CVB(V2,WORKAREA);       /* ISSUE CONVERT TO BINARY       */
         CVB   @15,WORKAREA                                        0687
         ST    @15,V2                                              0687
*           CNVTANS=V2;             /* PLACE IN COMMON AREA          */
         ST    @15,CNVTANS(,COMONPTR)                              0688
*         END;                      /*                               */
*     END;                                                         0690
@RF00684 DS    0H                                                  0691
*   ERROR=ERCOM;                    /* SAVE ERROR FIR INT USE        */
@RC00674 L     @15,ERCOM(,COMONPTR)                                0691
         ST    @15,ERROR                                           0691
*   END CONVERT;                                                   0692
@EL00010 DS    0H                                                  0692
@EF00010 DS    0H                                                  0692
@ER00010 LM    @14,@12,12(@13)                                     0692
         BR    @14                                                 0692
*                                                                  0693
*   /*****************************************************************/
*   /*                                                               */
*   /* IMMEDIATE VALUE NEEDED                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0693
*IMVALRTN:                                                         0693
*   PROC;                                                          0693
IMVALRTN STM   @14,@12,@SA00011                                    0693
*   INDEX=F0;                       /* INIT INDEX                    */
         SLR   @15,@15                                             0694
         ST    @15,INDEX                                           0694
*   DO N=1 TO DIM(IMMDATA) WHILE INDEX=F0;/* FIND BUILT IN FUNCTION  */
         LA    @15,1                                               0695
         ST    @15,N                                               0695
@DL00695 L     @14,INDEX                                           0695
         LTR   @14,@14                                             0695
         BNZ   @DC00695                                            0695
*     IF IMMLEN(N)=SNTLNG&          /* SAME LENGTH                   */
*         IMMDATA(N,1:SNTLNG)=C(V+F1:V+SNTLNG) THEN/* SAME TEXT      */
         LR    @14,@15                                             0696
         SLA   @14,4                                               0696
         L     @01,SNTELPTR(,COMONPTR)                             0696
         LH    @07,SNTLNG(,@01)                                    0696
         CH    @07,IMMLEN-16(@14)                                  0696
         BNE   @RF00696                                            0696
         L     @01,BUFBASE(,COMONPTR)                              0696
         BCTR  @07,0                                               0696
         LA    @06,IMMDATA-16(@14)                                 0696
         AL    @01,V                                               0696
         EX    @07,@SC01106                                        0696
         BNE   @RF00696                                            0696
*       INDEX=N;                    /* SET INDEX TO ROUTINE          */
         ST    @15,INDEX                                           0697
*   END;                                                           0698
@RF00696 LA    @15,1                                               0698
         AL    @15,N                                               0698
         ST    @15,N                                               0698
         C     @15,@CF00174                                        0698
         BNH   @DL00695                                            0698
@DC00695 DS    0H                                                  0699
*   IF INDEX=F0 THEN                /* IF NO MATCH                   */
         L     @15,INDEX                                           0699
         LTR   @15,@15                                             0699
         BNZ   @RF00699                                            0699
*     ERROR=E999;                   /* SET ERROR CODE                */
         MVC   ERROR(4),@CF00817                                   0700
*   ELSE                            /* CHECK FOR &STR                */
*     CALL ROUTINE;                 /* PROCESS IMVAL                 */
         B     @RC00699                                            0701
@RF00699 L     @14,INDEX                                           0701
         SLA   @14,4                                               0701
         L     @15,VECTOR-16(@14)                                  0701
         BALR  @14,@15                                             0701
*   END;                                                           0702
@EL00011 DS    0H                                                  0702
@EF00011 DS    0H                                                  0702
@ER00011 LM    @14,@12,@SA00011                                    0702
         BR    @14                                                 0702
*                                                                  0703
*   /*****************************************************************/
*   /*                                                               */
*   /* TIME BUILT IN FUNCTION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0703
*TIMERTN:                                                          0703
*   PROC;                                                          0703
TIMERTN  STM   @14,@12,@SA00012                                    0703
*   RFY                                                            0704
*    (R0) RSTD;                     /* RESTRICT TIME REGISTER        */
*   GEN SETS(R0)(TIME DEC);         /* ISSUE TIME MACRO              */
         TIME DEC
*   TEMPA=R0;                       /* SAVE TIME OF DAY              */
         ST    R0,TEMPA                                            0706
*   RFY                                                            0707
*    (R0) UNRSTD;                   /* RELEASE REGISTER              */
*   UNPK(TIMEOUT,TEMPA);            /* UNPACK TIME                   */
         UNPK  TIMEOUT(7),TEMPA(4)                                 0708
*   OUT1=HRS;                       /* HOURS                         */
         MVC   OUT1(2),HRS                                         0709
*   OUT2=MINUTES;                   /* MINUTES                       */
         MVC   OUT2(2),MINUTES                                     0710
*   OUT3=SEC;                       /* SECONDS                       */
         MVC   OUT3(2),SEC                                         0711
*   DELIM1=COLON;                   /* SEPARATE TIME ELEMENTS WITH   */
         MVI   DELIM1,C':'                                         0712
*   DELIM2=COLON;                   /* A COLON                       */
         MVI   DELIM2,C':'                                         0713
*   INSRTDA=ADDR(TIMEDATE);         /* POINT TO INSERT DATA          */
         LA    @15,TIMEDATE                                        0714
         ST    @15,INSRTDA                                         0714
*   INSRTLN=LENGTH(TIMEDATE);       /* SET LENGTH OF INSERT DATA     */
         MVC   INSRTLN(4),@CF00094                                 0715
*   END TIMERTN;                                                   0716
@EL00012 DS    0H                                                  0716
@EF00012 DS    0H                                                  0716
@ER00012 LM    @14,@12,@SA00012                                    0716
         BR    @14                                                 0716
*                                                                  0717
*   /*****************************************************************/
*   /*                                                               */
*   /* DATE BUILT IN FUNCTION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0717
*DATERTN:                                                          0717
*   PROC;                                                          0717
DATERTN  STM   @14,@12,@SA00013                                    0717
*   RFY                                                            0718
*    (R1) RSTD;                     /* RESTRICT DATE REG             */
*   GEN SETS(R1)(TIME DEC);         /* ISSUE TIME MACRO              */
         TIME DEC
*   TEMPA=R1;                       /* SAVE DATE                     */
         ST    R1,TEMPA                                            0720
*   RFY                                                            0721
*    (R1) UNRSTD;                   /* RELEASE DATE REGISTER         */
*   UNPK(DATEOUT,TEMPA);            /* UNPACK DATE                   */
         UNPK  DATEOUT(5),TEMPA(4)                                 0722
*   PACK(WORKAREA,YR);              /* CONVERT YEAR TO USEABLE FORM  */
         PACK  WORKAREA(8),YR(2)                                   0723
*   CVB(YEAR,WORKAREA);             /*                               */
         CVB   @15,WORKAREA                                        0724
         ST    @15,YEAR                                            0724
*   PACK(WORKAREA,DYS);             /* CONVERT DAYS TO USEABLE FORM  */
         PACK  WORKAREA(8),DYS(3)                                  0725
*   CVB(DAYS,WORKAREA);             /*                               */
         CVB   @14,WORKAREA                                        0726
         ST    @14,DAYS                                            0726
*   IF YEAR//F4=F0 THEN             /* IF A LEAP YEAR, SET LEAP      */
         LR    @00,@15                                             0727
         SRDA  @00,32                                              0727
         D     @00,@CF00107                                        0727
         LTR   @00,@00                                             0727
         BNZ   @RF00727                                            0727
*     LEAP=YES;                     /* YEAR SWITCH                   */
         OI    LEAP(COMONPTR),B'00000100'                          0728
*   ELSE                            /* IF NOT, TURN IT OFF           */
*     LEAP=NO;                      /*                               */
         B     @RC00727                                            0729
@RF00727 NI    LEAP(COMONPTR),B'11111011'                          0729
*   DO MONTH=1 TO DIM(DAYIN) WHILE DAYS>F0;/* SUBTRACT DAYS OF EACH
*                                      MONTH                         */
@RC00727 LA    @15,1                                               0730
         ST    @15,MONTH                                           0730
@DL00730 L     @14,DAYS                                            0730
         LTR   @14,@14                                             0730
         BNP   @DC00730                                            0730
*     DAYS=DAYS-DAYIN(MONTH);       /* UNTIL DAYS GOES NEGATIVE      */
         LR    @07,@15                                             0731
         ALR   @07,@07                                             0731
         SH    @14,DAYIN-2(@07)                                    0731
         ST    @14,DAYS                                            0731
*     IF MONTH=2&LEAP=YES THEN      /* IF LEAP YEAR, ADJUST FOR      */
         C     @15,@CF00062                                        0732
         BNE   @RF00732                                            0732
         TM    LEAP(COMONPTR),B'00000100'                          0732
         BNO   @RF00732                                            0732
*       DAYS=DAYS-F1;               /* EXTRA DAY IN FEBRUARY         */
         BCTR  @14,0                                               0733
         ST    @14,DAYS                                            0733
*   END;                            /*                               */
@RF00732 LA    @15,1                                               0734
         AL    @15,MONTH                                           0734
         ST    @15,MONTH                                           0734
         C     @15,@CF00216                                        0734
         BNH   @DL00730                                            0734
@DC00730 DS    0H                                                  0735
*   MONTH=MONTH-F1;                 /* ADJUST MONTH                  */
         L     @15,MONTH                                           0735
         BCTR  @15,0                                               0735
         ST    @15,MONTH                                           0735
*   DAYS=DAYS+DAYIN(MONTH);         /* ADD BACK DAYS                 */
         LR    @14,@15                                             0736
         ALR   @14,@14                                             0736
         LH    @14,DAYIN-2(@14)                                    0736
         AL    @14,DAYS                                            0736
         ST    @14,DAYS                                            0736
*   IF LEAP=YES&MONTH=FEBRUARY THEN /* IF LEAP YEAR, READJUST DAYS   */
         TM    LEAP(COMONPTR),B'00000100'                          0737
         BNO   @RF00737                                            0737
         C     @15,@CF00062                                        0737
         BNE   @RF00737                                            0737
*     DAYS=DAYS+F1;                 /*                               */
         AL    @14,@CF00042                                        0738
         ST    @14,DAYS                                            0738
*   CVD(MONTH,WORKAREA);            /* CONVERT MONTH AND DAY TO      */
@RF00737 L     @15,MONTH                                           0739
         CVD   @15,WORKAREA                                        0739
*   UNPK(OUT1,WORKAREA);            /* PRINTABLE FORM                */
         UNPK  OUT1(2),WORKAREA(8)                                 0740
*   OUT1(2)=OUT1(2)×CC0;            /* INSURE PRINTABLE CHAR         */
         OI    OUT1+1,C'0'                                         0741
*   CVD(DAYS,WORKAREA);             /* DITTO FOR DAYS                */
         L     @15,DAYS                                            0742
         CVD   @15,WORKAREA                                        0742
*   UNPK(OUT2,WORKAREA);            /*                               */
         UNPK  OUT2(2),WORKAREA(8)                                 0743
*   OUT2(2)=OUT2(2)×CC0;            /*                               */
         OI    OUT2+1,C'0'                                         0744
*   OUT3=YR;                        /* GET YEAR                      */
         MVC   OUT3(2),YR                                          0745
*   DELIM1=SLASH;                   /* SET DATE DELIMITERS TO SLASH  */
         MVI   DELIM1,C'/'                                         0746
*   DELIM2=SLASH;                   /*                               */
         MVI   DELIM2,C'/'                                         0747
*   INSRTDA=ADDR(TIMEDATE);         /* POINT TO INSERT DATA          */
         LA    @15,TIMEDATE                                        0748
         ST    @15,INSRTDA                                         0748
*   INSRTLN=LENGTH(TIMEDATE);       /* SET INSERT DATA LENGTH        */
         MVC   INSRTLN(4),@CF00094                                 0749
*   END DATERTN;                                                   0750
@EL00013 DS    0H                                                  0750
@EF00013 DS    0H                                                  0750
@ER00013 LM    @14,@12,@SA00013                                    0750
         BR    @14                                                 0750
*                                                                  0751
*   /*****************************************************************/
*   /*                                                               */
*   /* LENGTH BUILT IN FUNCTION                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0751
*LENGRTN:                                                          0751
*   PROC;                                                          0751
LENGRTN  STM   @14,@12,@SA00014                                    0751
*   CALL SETUP;                     /* CHECK IF TO WAIT AND CALL     */
         BAL   @14,SETUP                                           0752
*   IF ERROR=F0&WAIT=NO THEN        /* EVALUATE P-STRING             */
         L     @15,ERROR                                           0753
         LTR   @15,@15                                             0753
         BNZ   @RF00753                                            0753
         TM    WAIT(COMONPTR),B'00010000'                          0753
         BNZ   @RF00753                                            0753
*     DO;                           /*                               */
*       CVD(CLEN,WORKAREA);         /* GET LENGTH IN PRINTABLE       */
         LH    @15,CLEN(,COMONPTR)                                 0755
         CVD   @15,WORKAREA                                        0755
*       UNPK(AREA,WORKAREA);        /* FORM FOR TABLE                */
         UNPK  AREA(16),WORKAREA(8)                                0756
*       AREA(16)=AREA(16)×CC0;      /* INSURE NO SIGN                */
         OI    AREA+15,C'0'                                        0757
*       DO I=F16 TO F2 BY-F1 WHILE AREA(1)=CC0;/* LEFT JUSTIFY       */
         LA    @15,16                                              0758
         ST    @15,I(,COMONPTR)                                    0758
@DL00758 CLI   AREA,C'0'                                           0758
         BNE   @DC00758                                            0758
*         AREA(1:F15)=AREA(2:F16);  /* SHIFT BUFFER TO LEFT          */
         MVC   @TS00001(15),AREA+1                                 0759
         MVC   AREA(15),@TS00001                                   0759
*       END;                        /*                               */
         SLR   @15,@15                                             0760
         BCTR  @15,0                                               0760
         AL    @15,I(,COMONPTR)                                    0760
         ST    @15,I(,COMONPTR)                                    0760
         C     @15,@CF00062                                        0760
         BNL   @DL00758                                            0760
@DC00758 DS    0H                                                  0761
*       INSRTDA=ADDR(AREA);         /* POINT TO INSERT LENGTH        */
         LA    @15,AREA                                            0761
         ST    @15,INSRTDA                                         0761
*       INSRTLN=I;                  /* GET LENGTH OF LENGTH          */
         L     @15,I(,COMONPTR)                                    0762
         ST    @15,INSRTLN                                         0762
*       I=M+F1;                     /* POINT TO RESUME DATA          */
         LA    @15,1                                               0763
         AL    @15,M                                               0763
         ST    @15,I(,COMONPTR)                                    0763
*     END;                          /*                               */
*   END LENGRTN;                                                   0765
@EL00014 DS    0H                                                  0765
@EF00014 DS    0H                                                  0765
@ER00014 LM    @14,@12,@SA00014                                    0765
         BR    @14                                                 0765
*                                                                  0766
*   /*****************************************************************/
*   /*                                                               */
*   /* EVAL BUILT IN FUNCTION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0766
*EVALRTN:                                                          0766
*   PROC;                                                          0766
EVALRTN  STM   @14,@12,@SA00015                                    0766
*   CALL SETUP;                     /* CHECK IF TO WAIT AND PSTR     */
         BAL   @14,SETUP                                           0767
*   IF ERROR=F0&WAIT=NO THEN        /* OK TO PROCESS                 */
         L     @15,ERROR                                           0768
         LTR   @15,@15                                             0768
         BNZ   @RF00768                                            0768
         TM    WAIT(COMONPTR),B'00010000'                          0768
         BNZ   @RF00768                                            0768
*     DO;                           /*                               */
*       INSRTDA=ADDR(ANSWER);       /* ANSWER OF EVALUATION          */
         L     @15,ANSPTR(,COMONPTR)                               0770
         ST    @15,INSRTDA                                         0770
*       INSRTLN=CLEN;               /* LENGTH OF ANSWER              */
         LH    @15,CLEN(,COMONPTR)                                 0771
         ST    @15,INSRTLN                                         0771
*       I=M+F1;                     /* POINT TO RESUME DATA          */
         LA    @15,1                                               0772
         AL    @15,M                                               0772
         ST    @15,I(,COMONPTR)                                    0772
*     END;                          /*                               */
*   END EVALRTN;                    /* END OF EVAL BIF               */
@EL00015 DS    0H                                                  0774
@EF00015 DS    0H                                                  0774
@ER00015 LM    @14,@12,@SA00015                                    0774
         BR    @14                                                 0774
*                                                                  0775
*   /*****************************************************************/
*   /*                                                               */
*   /* DATATYPE ROUTINE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0775
*DATYRTN:                                                          0775
*   PROC;                                                          0775
DATYRTN  STM   @14,@12,@SA00016                                    0775
*   ALPHA=NO;                       /* RESET ALPHA SWITCH            */
         NI    ALPHA(COMONPTR),B'11111101'                         0776
*   CALL SETUP;                     /* CHECK TO SEE IF TO WAIT AND   */
         BAL   @14,SETUP                                           0777
*   IF ERROR=F0&WAIT=NO THEN        /* EVALUATE STRING               */
         L     @15,ERROR                                           0778
         LTR   @15,@15                                             0778
         BNZ   @RF00778                                            0778
         TM    WAIT(COMONPTR),B'00010000'                          0778
         BNZ   @RF00778                                            0778
*     DO;                           /*                               */
*       DO I=CLEN TO F1 BY-F1 WHILE ALPHA=NO;/* CHECK IF ANY ALPHA   */
         LH    @15,CLEN(,COMONPTR)                                 0780
         ST    @15,I(,COMONPTR)                                    0780
         B     @DE00780                                            0780
@DL00780 TM    ALPHA(COMONPTR),B'00000010'                         0780
         BNZ   @DC00780                                            0780
*         IF ANSWER(I)<CC0×ANSWER(I)>CC9 THEN/* IF AN ALPHA CHAR     */
         L     @15,I(,COMONPTR)                                    0781
         L     @14,ANSPTR(,COMONPTR)                               0781
         ALR   @15,@14                                             0781
         BCTR  @15,0                                               0781
         CLI   ANSWER(@15),C'0'                                    0781
         BL    @RT00781                                            0781
         L     @15,I(,COMONPTR)                                    0781
         ALR   @14,@15                                             0781
         BCTR  @14,0                                               0781
         CLI   ANSWER(@14),C'9'                                    0781
         BNH   @RF00781                                            0781
@RT00781 DS    0H                                                  0782
*           IF I^=F1×ANSWER(I)^=MINUS THEN/* IF NOT NEGATIVE         */
         L     @15,I(,COMONPTR)                                    0782
         C     @15,@CF00042                                        0782
         BNE   @RT00782                                            0782
         L     @01,ANSPTR(,COMONPTR)                               0782
         ALR   @01,@15                                             0782
         BCTR  @01,0                                               0782
         CLI   ANSWER(@01),C'-'                                    0782
         BE    @RF00782                                            0782
@RT00782 DS    0H                                                  0783
*             ALPHA=YES;            /* SET ALPHA SWITCH              */
         OI    ALPHA(COMONPTR),B'00000010'                         0783
*       END;                        /*                               */
@RF00782 DS    0H                                                  0784
@RF00781 SLR   @15,@15                                             0784
         BCTR  @15,0                                               0784
         AL    @15,I(,COMONPTR)                                    0784
         ST    @15,I(,COMONPTR)                                    0784
@DE00780 LTR   @15,@15                                             0784
         BP    @DL00780                                            0784
@DC00780 DS    0H                                                  0785
*       IF ALPHA=YES×CLEN=F0 THEN   /* IF DATATYPE IS ALPHA THEN     */
         TM    ALPHA(COMONPTR),B'00000010'                         0785
         BO    @RT00785                                            0785
         LH    @15,CLEN(,COMONPTR)                                 0785
         LTR   @15,@15                                             0785
         BNZ   @RF00785                                            0785
@RT00785 DS    0H                                                  0786
*         DO;                       /* POINT TO 'CHAR' AND ITS LENGTH*/
*           INSRTDA=ADDR(CHR);      /*                               */
         LA    @15,CHR                                             0787
         ST    @15,INSRTDA                                         0787
*           INSRTLN=LENGTH(CHR);    /*                               */
         MVC   INSRTLN(4),@CF00107                                 0788
*         END;                      /*                               */
*       ELSE                        /* IF NOT ALPHA, POINT INSERT    */
*         DO;                       /* TO 'NUM' AND ITS LENGTH       */
         B     @RC00785                                            0790
@RF00785 DS    0H                                                  0791
*           INSRTDA=ADDR(NUM);      /*                               */
         LA    @15,NUM                                             0791
         ST    @15,INSRTDA                                         0791
*           INSRTLN=LENGTH(NUM);    /*                               */
         MVC   INSRTLN(4),@CF00054                                 0792
*         END;                      /*                               */
*       I=M+F1;                     /* POINT TO RESUME DATA          */
@RC00785 LA    @15,1                                               0794
         AL    @15,M                                               0794
         ST    @15,I(,COMONPTR)                                    0794
*     END;                          /*                               */
*   END DATYRTN;                                                   0796
@EL00016 DS    0H                                                  0796
@EF00016 DS    0H                                                  0796
@ER00016 LM    @14,@12,@SA00016                                    0796
         BR    @14                                                 0796
*                                                                  0797
*   /*****************************************************************/
*   /*                                                               */
*   /* USERID PREFIX ROUTINE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0797
*PREFRTN:                                                          0797
*   PROC;                                                          0797
PREFRTN  STM   @14,@12,12(@13)                                     0797
*   INSRTDA=ADDR(UPTPREFX);         /* POINT TO PREFIX               */
         L     @15,@PC00001                                        0798
         LA    @14,UPTPREFX(,@15)                                  0798
         ST    @14,INSRTDA                                         0798
*   INSRTLN=UPTPREFL;               /* GET PREFIX LENGTH             */
         SLR   @14,@14                                             0799
         IC    @14,UPTPREFL(,@15)                                  0799
         ST    @14,INSRTLN                                         0799
*   END PREFRTN;                                                   0800
@EL00017 DS    0H                                                  0800
@EF00017 DS    0H                                                  0800
@ER00017 LM    @14,@12,12(@13)                                     0800
         BR    @14                                                 0800
*                                                                  0801
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSPCMD ROUTINE GET SYSTEM PRIMARY COMMAND NAME               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0801
*SYSPRTN:                                                          0801
*   PROC;                                                          0801
SYSPRTN  STM   @14,@12,12(@13)                                     0801
*   INSRTDA=ADDR(ECTPCMD);          /* POINT TO PRIMARY NAME         */
         L     @15,@PC00001+4                                      0802
         LA    @15,ECTPCMD(,@15)                                   0802
         ST    @15,INSRTDA                                         0802
*   DO INSRTLN=F8 TO F2 BY-F1 WHILE INSRTCHR(INSRTLN)=BLANK;       0803
         LA    @15,8                                               0803
         ST    @15,INSRTLN                                         0803
@DL00803 L     @01,INSRTDA                                         0803
         ALR   @01,@15                                             0803
         BCTR  @01,0                                               0803
         CLI   INSRTCHR(@01),C' '                                  0803
         BNE   @DC00803                                            0803
*   END;                            /* SCAN FOR LAST NON BLANK       */
         BCTR  @15,0                                               0804
         ST    @15,INSRTLN                                         0804
         C     @15,@CF00062                                        0804
         BNL   @DL00803                                            0804
@DC00803 DS    0H                                                  0805
*   END SYSPRTN;                                                   0805
@EL00018 DS    0H                                                  0805
@EF00018 DS    0H                                                  0805
@ER00018 LM    @14,@12,12(@13)                                     0805
         BR    @14                                                 0805
*                                                                  0806
*   /*****************************************************************/
*   /*                                                               */
*   /* SYSSCMD ROUTINE GET SYSTEM SECONDARY COMMAND NAME             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0806
*SYSSRTN:                                                          0806
*   PROC;                                                          0806
SYSSRTN  STM   @14,@12,12(@13)                                     0806
*   INSRTDA=ADDR(ECTSCMD);          /* POINT TO SECONDARY NAME       */
         L     @15,@PC00001+4                                      0807
         LA    @15,ECTSCMD(,@15)                                   0807
         ST    @15,INSRTDA                                         0807
*   DO INSRTLN=F8 TO F2 BY-F1 WHILE INSRTCHR(INSRTLN)=BLANK;       0808
         LA    @15,8                                               0808
         ST    @15,INSRTLN                                         0808
@DL00808 L     @01,INSRTDA                                         0808
         ALR   @01,@15                                             0808
         BCTR  @01,0                                               0808
         CLI   INSRTCHR(@01),C' '                                  0808
         BNE   @DC00808                                            0808
*   END;                            /* SCAN FOR LAST NON BLANK       */
         BCTR  @15,0                                               0809
         ST    @15,INSRTLN                                         0809
         C     @15,@CF00062                                        0809
         BNL   @DL00808                                            0809
@DC00808 DS    0H                                                  0810
*   END SYSSRTN;                                                   0810
@EL00019 DS    0H                                                  0810
@EF00019 DS    0H                                                  0810
@ER00019 LM    @14,@12,12(@13)                                     0810
         BR    @14                                                 0810
*                                                                  0811
*   /*****************************************************************/
*   /*                                                               */
*   /* EVALUATION SETUP                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0811
*SETUP:                                                            0811
*   PROC OPTIONS(SAVEAREA);                                        0811
SETUP    STM   @14,@12,12(@13)                                     0811
         ST    @13,@SA00020+4                                      0811
         LA    @14,@SA00020                                        0811
         ST    @14,8(,@13)                                         0811
         LR    @13,@14                                             0811
*   CALL WAITRTN;                   /* CHECK FOR & IN P-STRING       */
         BAL   @14,WAITRTN                                         0812
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK TO PROCESS              */
         TM    WAIT(COMONPTR),B'00010000'                          0813
         BNZ   @RF00813                                            0813
         SLR   @15,@15                                             0813
         C     @15,ERROR                                           0813
         BNE   @RF00813                                            0813
*     DO;                           /*                               */
*       BUFPTR=ADDR(C(I-F1));       /* POINT TO DUMMY BUFFER         */
         L     @14,I(,COMONPTR)                                    0815
         L     @01,BUFBASE(,COMONPTR)                              0815
         LA    @07,C-2(@14,@01)                                    0815
         ST    @07,BUFPTR(,COMONPTR)                               0815
*       CSAVE=BUF(F1:F2);           /* SAVE ORIGINAL BUFFER          */
         MVC   CSAVE(2),BUF(@07)                                   0816
*       BUF(F1:F2)=XEQUAL;          /* MAKE DUMMY STATEMENT          */
         MVC   BUF(2,@07),@CC00632                                 0817
*       CLEN=M-I+F1;                /* SET LENGTH OF DUMMY STMT      */
         LCR   @14,@14                                             0818
         AL    @14,M                                               0818
         AL    @14,@CF00042                                        0818
         STH   @14,CLEN(,COMONPTR)                                 0818
*       TYPE=F0;                    /* NUMERIC ASSIGNMENT            */
         ST    @15,TYPE(,COMONPTR)                                 0819
*       RFY                                                        0820
*        (R15) RSTD;                /* RESTRICT RETURN CODE REG      */
*       CALL IKJCT434(BUF,CLEN,TYPE,OUTA1);/* PROCESS EXPRESSION     */
         ST    @07,@AL00001                                        0821
         LA    @14,CLEN(,COMONPTR)                                 0821
         ST    @14,@AL00001+4                                      0821
         LA    @14,TYPE(,COMONPTR)                                 0821
         ST    @14,@AL00001+8                                      0821
         LA    @14,OUTA1                                           0821
         ST    @14,@AL00001+12                                     0821
         L     @15,@CV00098                                        0821
         LA    @01,@AL00001                                        0821
         BALR  @14,@15                                             0821
*       ERROR=R15;                  /* SAVE ERROR CODE               */
         ST    R15,ERROR                                           0822
*       BUF(F1:F2)=CSAVE;           /* RESTORE BUFFER                */
         L     @14,BUFPTR(,COMONPTR)                               0823
         MVC   BUF(2,@14),CSAVE                                    0823
*       RFY                                                        0824
*        (R15) UNRSTD;              /* RELEASE RETURN CODE REG       */
*     END;                                                         0825
*   END SETUP;                                                     0826
@EL00020 L     @13,4(,@13)                                         0826
@EF00020 DS    0H                                                  0826
@ER00020 LM    @14,@12,12(@13)                                     0826
         BR    @14                                                 0826
*                                                                  0827
*   /*****************************************************************/
*   /*                                                               */
*   /* SYMBOLIC VARIABLE LOCATE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0827
*LOCATE:                                                           0827
*   PROC(NAME,NAML,FUNC);                                          0827
LOCATE   STM   @14,@12,@SA00021                                    0827
         MVC   @PC00021(12),0(@01)                                 0827
*   DCL                                                            0828
*     NAME CHAR(*),                                                0828
*     NAML FIXED(31),                                              0828
*     FUNC FIXED(31);                                              0828
*   EXECDPTR=LSDEXEC;               /* RESET EXEC DATA POINTER       */
         L     @01,LSDPTR(,COMONPTR)                               0829
         L     @15,LSDEXEC(,@01)                                   0829
         ST    @15,EXECDPTR(,COMONPTR)                             0829
*   SNTABPTR=SNTABFST;              /* POINT TO FIRST SNTAB          */
         L     @15,SNTABFST(,@15)                                  0830
         ST    @15,SNTABPTR                                        0830
*   SNTELPTR=ADDR(SNTELFST);        /* POINT TO FIRST NAME ENTRY     */
         LA    @15,SNTELFST(,@15)                                  0831
         ST    @15,SNTELPTR(,COMONPTR)                             0831
*   EXITB=NO;                       /* CLEAR EXITB                   */
         NI    EXITB(COMONPTR),B'10111111'                         0832
*   IF NAML>F252 THEN               /* IF NAME IS TOO LONG           */
         L     @15,@PC00021+4                                      0833
         L     @15,NAML(,@15)                                      0833
         C     @15,@CF00433                                        0833
         BNH   @RF00833                                            0833
*     ERCOM=E940;                   /* SET ERCOM CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00801                          0834
*   DO WHILE EXITB=NO&ERCOM=F0;     /* SEARCH TABLE UNTIL FOUND OR 0835
*                                      UNTIL AN ERCOM OCCURS         */
@RF00833 B     @DE00835                                            0835
@DL00835 DS    0H                                                  0836
*     IF NAML=SNTLNG&NAME(1:NAML)=SNTDATA(1:SNTLNG) THEN/* IF FOUND  */
         L     @15,@PC00021+4                                      0836
         L     @14,SNTELPTR(,COMONPTR)                             0836
         LH    @07,SNTLNG(,@14)                                    0836
         C     @07,NAML(,@15)                                      0836
         BNE   @RF00836                                            0836
         L     @06,@PC00021                                        0836
         BCTR  @07,0                                               0836
         EX    @07,@SC01109                                        0836
         BNE   @RF00836                                            0836
*       EXITB=YES;                  /* SET FOUND SWITCH              */
         OI    EXITB(COMONPTR),B'01000000'                         0837
*     ELSE                          /* OTHERWISE UPDATE POINTER      */
*       IF SNTLAST=YES THEN         /* IF END OF TABLE               */
         B     @RC00836                                            0838
@RF00836 L     @01,SNTELPTR(,COMONPTR)                             0838
         TM    SNTLAST(@01),B'00000001'                            0838
         BNO   @RF00838                                            0838
*         IF SNTABNXT=F0 THEN       /* AND NO MORE TABLES            */
         L     @01,SNTABPTR                                        0839
         L     @15,SNTABNXT(,@01)                                  0839
         LTR   @15,@15                                             0839
         BNZ   @RF00839                                            0839
*           IF FUNC=F8 THEN         /* IF VARIABLE TO BE ADDED       */
         L     @15,@PC00021+8                                      0840
         CLC   FUNC(4,@15),@CF00094                                0840
         BNE   @RF00840                                            0840
*             DO;                   /* ADD NAME TO TABLE             */
*               CALL NAMEADD;       /* ADD NAME TO TABLE             */
         BAL   @14,NAMEADD                                         0842
*               EXITB=YES;          /* CAUSE TERMINATION             */
         OI    EXITB(COMONPTR),B'01000000'                         0843
*             END;                  /*                               */
*           ELSE                    /* OTHERWISE                     */
*             ERCOM=E904;           /* SET NOT FOUND RETURN CODE     */
         B     @RC00840                                            0845
@RF00840 MVC   ERCOM(4,COMONPTR),@CF00783                          0845
*         ELSE                      /*                               */
*           DO;                     /* IF NOT THE END, UPDATE TO NEXT*/
         B     @RC00839                                            0846
@RF00839 DS    0H                                                  0847
*             SNTABPTR=SNTABNXT;    /* TABLE                         */
         L     @01,SNTABPTR                                        0847
         L     @15,SNTABNXT(,@01)                                  0847
         ST    @15,SNTABPTR                                        0847
*             SNTELPTR=ADDR(SNTELFST);/* POINT TO FIRST NAME ENTRY IN*/
         LA    @15,SNTELFST(,@15)                                  0848
         ST    @15,SNTELPTR(,COMONPTR)                             0848
*           END;                    /* NEXT TABLE                    */
*       ELSE                        /* NO MOE TABLES AND NOT FOUND   */
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* UPDATE POINTER */
         B     @RC00838                                            0850
@RF00838 L     @15,SNTELPTR(,COMONPTR)                             0850
         LH    @14,SNTLNG(,@15)                                    0850
         ALR   @14,@15                                             0850
         AL    @14,@CF00094                                        0850
         ST    @14,SNTELPTR(,COMONPTR)                             0850
*   END;                                                           0851
@RC00838 DS    0H                                                  0851
@RC00836 DS    0H                                                  0851
@DE00835 TM    EXITB(COMONPTR),B'01000000'                         0851
         BNZ   @DC00835                                            0851
         L     @15,ERCOM(,COMONPTR)                                0851
         LTR   @15,@15                                             0851
         BZ    @DL00835                                            0851
@DC00835 DS    0H                                                  0852
*   IF ERCOM=F0&((FUNC^=F4&SNTLABEL=YES)×/* IF A LABEL WAS FOUND WHEN*/
*       (FUNC=F4&SNTLABEL=NO)) THEN /* IT SHOULDNT, THEN SET         */
         L     @15,ERCOM(,COMONPTR)                                0852
         LTR   @15,@15                                             0852
         BNZ   @RF00852                                            0852
         L     @15,@PC00021+8                                      0852
         CLC   FUNC(4,@15),@CF00107                                0852
         BE    @GL00055                                            0852
         L     @01,SNTELPTR(,COMONPTR)                             0852
         TM    SNTLABEL(@01),B'00010000'                           0852
         BO    @RT00852                                            0852
@GL00055 L     @15,@PC00021+8                                      0852
         CLC   FUNC(4,@15),@CF00107                                0852
         BNE   @RF00852                                            0852
         L     @01,SNTELPTR(,COMONPTR)                             0852
         TM    SNTLABEL(@01),B'00010000'                           0852
         BNZ   @RF00852                                            0852
@RT00852 DS    0H                                                  0853
*     ERCOM=E944;                   /* ERCOM INDICATOR               */
         MVC   ERCOM(4,COMONPTR),@CF00803                          0853
*   IF ERCOM=F0&SNTGLOB=YES THEN    /* IF A GLOBAL VARIABLE          */
@RF00852 L     @15,ERCOM(,COMONPTR)                                0854
         LTR   @15,@15                                             0854
         BNZ   @RF00854                                            0854
         L     @01,SNTELPTR(,COMONPTR)                             0854
         TM    SNTGLOB(@01),B'10000000'                            0854
         BNO   @RF00854                                            0854
*     CALL GLOCATE;                 /* DO A GLOBAL SEARCH            */
         BAL   @14,GLOCATE                                         0855
*   ERROR=ERCOM;                    /*                               */
@RF00854 L     @15,ERCOM(,COMONPTR)                                0856
         ST    @15,ERROR                                           0856
*                                                                  0857
*   /*****************************************************************/
*   /*                                                               */
*   /* NAME TABLE UPDATE - ADD A NAME ENTRY                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0857
*NAMEADD:                                                          0857
*   PROC;                                                          0857
         B     @PB00022                                            0857
NAMEADD  STM   @14,@12,12(@13)                                     0857
*   IF NAML>F31 THEN                /* IF NAME TOO LONG              */
         L     @15,@PC00021+4                                      0858
         L     @15,NAML(,@15)                                      0858
         C     @15,@CF00059                                        0858
         BNH   @RF00858                                            0858
*     ERCOM=E940;                   /* SET ERCOM CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00801                          0859
*   ELSE                            /* OTHERWISE                     */
*     IF NAML+LENGTH(SNTELEM)>SNTABLNG-SNTABUSE THEN/* IF NO ROOM  0860
*                                      LEFT                          */
         B     @RC00858                                            0860
@RF00858 L     @15,@PC00021+4                                      0860
         L     @15,NAML(,@15)                                      0860
         LA    @14,8                                               0860
         ALR   @14,@15                                             0860
         L     @07,SNTABPTR                                        0860
         L     @06,SNTABLNG(,@07)                                  0860
         LR    @05,@06                                             0860
         SL    @05,SNTABUSE(,@07)                                  0860
         CR    @14,@05                                             0860
         BNH   @RF00860                                            0860
*       DO;                         /* GET ANOTHER TABLE             */
*         NEWLNG=MAX(SNTABLNG,NAML+LENGTH(SNTELEM)+LENGTH(SNTAB)+GAS);
         AL    @15,@CF00419                                        0862
         CR    @06,@15                                             0862
         BNL   *+6
         LR    @06,@15                                             0862
         ST    @06,NEWLNG                                          0862
*         DO;                       /* GETMAIN LV(NEWLNG) A(SNTSAVE)
*                                      SP(78) MF(E,GETLST)         0863
*                                      RTCD(ERCOM)                   */
*           RESPECIFY                                              0864
*            (GPR01P,                                              0864
*             GPR15F) RESTRICTED;                                  0864
*           GETLST01=NEWLNG;        /* LENGTH                        */
         ST    @06,GETLST01                                        0865
*           GETLST03=ADDR(SNTSAVE); /* ADDR OF ADDR LIST             */
         LA    @14,SNTSAVE                                         0866
         STCM  @14,7,GETLST03                                      0866
*           GETLST05=78;            /* SUBPOOL VALUE                 */
         MVI   GETLST05,X'4E'                                      0867
*           GPR01P=ADDR(GETLST);    /* REG1 POINTS TO LIST           */
         LA    GPR01P,GETLST                                       0868
*           SVC(4);                 /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0869
*           ERCOM=GPR15F;           /* SET RETURN CODE               */
         ST    GPR15F,ERCOM(,COMONPTR)                             0870
*           RESPECIFY                                              0871
*            (GPR01P,                                              0871
*             GPR15F) UNRESTRICTED;                                0871
*         END;                      /* GETMAIN LV(NEWLNG) A(SNTSAVE)
*                                      SP(78) MF(E,GETLST)         0872
*                                      RTCD(ERCOM)                   */
*         IF ERCOM^=F0 THEN         /* IF GETMAIN ERCOM              */
         L     @15,ERCOM(,COMONPTR)                                0873
         LTR   @15,@15                                             0873
         BZ    @RF00873                                            0873
*           ERCOM=E16;              /* SET ERCOM CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00104                          0874
*         ELSE                      /* OTHERWISE                     */
*           DO;                     /* CHAIN NEW TABLE               */
         B     @RC00873                                            0875
@RF00873 DS    0H                                                  0876
*             RFY                                                  0876
*               SNTAB BASED(SNTSAVE);/* RESET BASE FOR NEW TABLE     */
*             SNTABNXT=F0;          /* NO NEXT TABLE                 */
         L     @15,SNTSAVE                                         0877
         SLR   @14,@14                                             0877
         ST    @14,SNTABNXT(,@15)                                  0877
*             SNTABLNG=NEWLNG;      /* LENGTH OG THIS TABLE          */
         L     @14,NEWLNG                                          0878
         ST    @14,SNTABLNG(,@15)                                  0878
*             SNTABUSE=LENGTH(SNTAB);/* LENGTH OF HEADER             */
         MVC   SNTABUSE(4,@15),@CF00216                            0879
*             RFY                                                  0880
*               SNTAB BASED(SNTABPTR);/* RESTORE BASE                */
*             SNTABNXT=SNTSAVE;     /* CHAIN NEW TABLE               */
         L     @14,SNTABPTR                                        0881
         ST    @15,SNTABNXT(,@14)                                  0881
*             SNTABPTR=SNTSAVE;     /* SET BASE TO NEW TABLE         */
         ST    @15,SNTABPTR                                        0882
*           END;                    /*                               */
*       END;                        /*                               */
*     ELSE                          /* NOT A NEW TABLE               */
*       SNTLAST=NO;                 /* CLEAR OLD LAST SWITCH         */
         B     @RC00860                                            0885
@RF00860 L     @01,SNTELPTR(,COMONPTR)                             0885
         NI    SNTLAST(@01),B'11111110'                            0885
*   IF ERCOM=F0 THEN                /* IF NO GETMAIN ERCOM           */
@RC00860 DS    0H                                                  0886
@RC00858 L     @15,ERCOM(,COMONPTR)                                0886
         LTR   @15,@15                                             0886
         BNZ   @RF00886                                            0886
*     DO;                           /* ADD ENTRY                     */
*       SNTELPTR=SNTABPTR+SNTABUSE; /* POINT TO NEW SLOT             */
         L     @15,SNTABPTR                                        0888
         L     @14,SNTABUSE(,@15)                                  0888
         LR    @07,@15                                             0888
         ALR   @07,@14                                             0888
         ST    @07,SNTELPTR(,COMONPTR)                             0888
*       SNTFLAGS=''B;               /* CLEAR FLAGS                   */
         XC    SNTFLAGS(2,@07),SNTFLAGS(@07)                       0889
*       SNTKEYW=YES;                /* KEYWORD WITH VALUE            */
*       SNTLAST=YES;                /* NOW LAST ELEMENT              */
         OI    SNTKEYW(@07),B'00100001'                            0891
*       SNTVLPTR=SVTABFST+LENGTH(SVTAB);/* POINT TO NULL ELEMENT     */
         L     @01,EXECDPTR(,COMONPTR)                             0892
         LA    @06,16                                              0892
         AL    @06,SVTABFST(,@01)                                  0892
         ST    @06,SNTVLPTR(,@07)                                  0892
*       SNTLNG=NAML;                /* LENGTH OF NAME                */
         L     @06,@PC00021+4                                      0893
         L     @06,NAML(,@06)                                      0893
         STH   @06,SNTLNG(,@07)                                    0893
*       SNTDATA(1:NAML)=NAME(1:NAML);/* NAME                         */
         LR    @05,@06                                             0894
         BCTR  @05,0                                               0894
         L     @04,@PC00021                                        0894
         EX    @05,@SM01111                                        0894
*       SNTABUSE=SNTABUSE+NAML+LENGTH(SNTELEM);/* AMOUNT IN USE      */
         ALR   @14,@06                                             0895
         AL    @14,@CF00094                                        0895
         ST    @14,SNTABUSE(,@15)                                  0895
*     END;                          /*                               */
*   END NAMEADD;                                                   0897
@EL00022 DS    0H                                                  0897
@EF00022 DS    0H                                                  0897
@ER00022 LM    @14,@12,12(@13)                                     0897
         BR    @14                                                 0897
*   END LOCATE;                                                    0898
@EL00021 DS    0H                                                  0898
@EF00021 DS    0H                                                  0898
@ER00021 LM    @14,@12,@SA00021                                    0898
         BR    @14                                                 0898
*                                                                  0899
*   /*****************************************************************/
*   /*                                                               */
*   /* GLOBAL LOCATE FUNCTION                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0899
*GLOCATE:                                                          0899
*   PROC;                                                          0899
GLOCATE  STM   @14,@12,12(@13)                                     0899
*   SNTSAVE=SNTELPTR;               /* SAVE NAME POINTER             */
         L     @15,SNTELPTR(,COMONPTR)                             0900
         ST    @15,SNTSAVE                                         0900
*   EXECDPTR=GEXECDAT;              /* POINT TO GLOBAL EXEC          */
         L     @01,EXECDPTR(,COMONPTR)                             0901
         L     @15,GEXECDAT(,@01)                                  0901
         ST    @15,EXECDPTR(,COMONPTR)                             0901
*   SNTABPTR=SNTABFST;              /* POINT TO FIRST NAME TABLE     */
         L     @15,SNTABFST(,@15)                                  0902
         ST    @15,SNTABPTR                                        0902
*   SNTELPTR=ADDR(SNTELFST);        /* BEGIN OF GLOBAL NAMES         */
         LA    @15,SNTELFST(,@15)                                  0903
         ST    @15,SNTELPTR(,COMONPTR)                             0903
*   EXITB=NO;                       /* TURN OFF EXIT SWITCH          */
         NI    EXITB(COMONPTR),B'10111111'                         0904
*   DO WHILE EXITB=NO&ERCOM=F0;     /* FIND GLOBAL VARIABLE          */
         B     @DE00905                                            0905
@DL00905 DS    0H                                                  0906
*     IF SNTLNG=F4&                 /* IF LENGTH IS FOUR             */
*         SNTSAVE->SNTGVAL=SNTDATA(1:F4) THEN/* MATCH                */
         L     @15,SNTELPTR(,COMONPTR)                             0906
         CLC   SNTLNG(2,@15),@CH00107                              0906
         BNE   @RF00906                                            0906
         L     @01,SNTSAVE                                         0906
         CLC   SNTGVAL(4,@01),SNTDATA(@15)                         0906
         BNE   @RF00906                                            0906
*       EXITB=YES;                  /* EXIT LOCATE                   */
         OI    EXITB(COMONPTR),B'01000000'                         0907
*     ELSE                          /* OTHERWISE                     */
*       IF SNTLAST=YES THEN         /* LAST NAME ?                   */
         B     @RC00906                                            0908
@RF00906 L     @01,SNTELPTR(,COMONPTR)                             0908
         TM    SNTLAST(@01),B'00000001'                            0908
         BNO   @RF00908                                            0908
*         IF SNTABNXT=F0 THEN       /* NO MORE TABLES ?              */
         L     @01,SNTABPTR                                        0909
         L     @15,SNTABNXT(,@01)                                  0909
         LTR   @15,@15                                             0909
         BNZ   @RF00909                                            0909
*           ERCOM=E312;             /* SET ERCOM CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00747                          0910
*         ELSE                      /* OTHERWISE                     */
*           DO;                     /* SCAN NEXT TABLE               */
         B     @RC00909                                            0911
@RF00909 DS    0H                                                  0912
*             SNTABPTR=SNTABNXT;    /* BASE NEXT TABLE               */
         L     @01,SNTABPTR                                        0912
         L     @15,SNTABNXT(,@01)                                  0912
         ST    @15,SNTABPTR                                        0912
*             SNTELPTR=ADDR(SNTELFST);/* POINT TO FIRST NAME         */
         LA    @15,SNTELFST(,@15)                                  0913
         ST    @15,SNTELPTR(,COMONPTR)                             0913
*           END;                    /*                               */
*       ELSE                        /* OTHERWISE                     */
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* GET NEXT       */
         B     @RC00908                                            0915
@RF00908 L     @15,SNTELPTR(,COMONPTR)                             0915
         LH    @14,SNTLNG(,@15)                                    0915
         ALR   @14,@15                                             0915
         AL    @14,@CF00094                                        0915
         ST    @14,SNTELPTR(,COMONPTR)                             0915
*   END;                            /*                               */
@RC00908 DS    0H                                                  0916
@RC00906 DS    0H                                                  0916
@DE00905 TM    EXITB(COMONPTR),B'01000000'                         0916
         BNZ   @DC00905                                            0916
         L     @15,ERCOM(,COMONPTR)                                0916
         LTR   @15,@15                                             0916
         BZ    @DL00905                                            0916
@DC00905 DS    0H                                                  0917
*   ERROR=ERCOM;                                                   0917
         L     @15,ERCOM(,COMONPTR)                                0917
         ST    @15,ERROR                                           0917
*   END GLOCATE;                    /*                               */
@EL00023 DS    0H                                                  0918
@EF00023 DS    0H                                                  0918
@ER00023 LM    @14,@12,12(@13)                                     0918
         BR    @14                                                 0918
*                                                                  0919
*   /*****************************************************************/
*   /*                                                               */
*   /* SYMBOLIC VARIABLE UPDATE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0919
*UPDATE:                                                           0919
*   PROC(VALUE,VALLEN);             /* UPDATE A VTAB ELEMENT         */
UPDATE   STM   @14,@12,12(@13)                                     0919
         MVC   @PC00024(8),0(@01)                                  0919
*   DCL                                                            0920
*     VALUE CHAR(*),                                               0920
*     VALLEN FIXED(31);                                            0920
*   SVTABPTR=SVTABFST;              /* POIT TO CURRENT VTAB          */
         L     @01,EXECDPTR(,COMONPTR)                             0921
         L     @15,SVTABFST(,@01)                                  0921
         ST    @15,SVTABPTR                                        0921
*   IF SNTNAUTH=YES&SYSUPDTE=NO THEN/* IF AN UNAUTHORIZED VARIABLE   */
         L     @01,SNTELPTR(,COMONPTR)                             0922
         TM    SNTNAUTH(@01),B'00000100'                           0922
         BNO   @RF00922                                            0922
         TM    SYSUPDTE(COMONPTR),B'00000100'                      0922
         BNZ   @RF00922                                            0922
*     ERCOM=E300;                   /* SET ERCOM CODE                */
         MVC   ERCOM(4,COMONPTR),@CF00741                          0923
*   ELSE                            /* OTHERWISE                     */
*     DO;                           /* UPDATE VARIABLE               */
         B     @RC00922                                            0924
@RF00922 DS    0H                                                  0925
*       IF VALLEN>SVTORIG THEN      /* IF A NEW SLOT IS NEEDED       */
         L     @15,@PC00024+4                                      0925
         L     @15,VALLEN(,@15)                                    0925
         L     @14,SNTELPTR(,COMONPTR)                             0925
         L     @01,SNTVLPTR(,@14)                                  0925
         CH    @15,SVTORIG(,@01)                                   0925
         BNH   @RF00925                                            0925
*         DO;                                                      0926
*           IF VALLEN+LENGTH(SVTELEM)>SVTABLNG-SVTABUSE THEN/* IF NEW
*                                      TABLE                         */
         LA    @07,4                                               0927
         ALR   @07,@15                                             0927
         L     @06,SVTABPTR                                        0927
         L     @05,SVTABLNG(,@06)                                  0927
         L     @04,SVTABUSE(,@06)                                  0927
         LR    @03,@05                                             0927
         SLR   @03,@04                                             0927
         CR    @07,@03                                             0927
         BNH   @RF00927                                            0927
*             DO;                   /* IS NEEDED, GET ONE            */
*               SNTSAVE=SNTELPTR;   /* SAVE NAME POINTER             */
         ST    @14,SNTSAVE                                         0929
*               EXITC=NO;           /* TURN OFF SWITCH               */
         NI    EXITC(COMONPTR),B'11111110'                         0930
*               NEWLNG=MAX(SVTABLNG+VALLEN+GAS,/* OLD SIZE + GAS     */
*                   (SVTABUSE-SVTABFRE)*F3/F2);/* 1.5 TIMES USED     */
         ALR   @05,@15                                             0931
         AL    @05,@CF00353                                        0931
         SL    @04,SVTABFRE(,@06)                                  0931
         LR    @01,@04                                             0931
         M     @00,@CF00054                                        0931
         D     @00,@CF00062                                        0931
         CR    @05,@01                                             0931
         BNL   *+6
         LR    @05,@01                                             0931
         ST    @05,NEWLNG                                          0931
*               DO;                 /* GETMAIN LV(NEWLNG) A(SVTABPTR)
*                                      SP(78) MF(E,GETLST)         0932
*                                      RTCD(ERCOM)                   */
*                 RESPECIFY                                        0933
*                  (GPR01P,                                        0933
*                   GPR15F) RESTRICTED;                            0933
*                 GETLST01=NEWLNG;  /* LENGTH                        */
         ST    @05,GETLST01                                        0934
*                 GETLST03=ADDR(SVTABPTR);/* ADDR OF ADDR LIST       */
         LA    @14,SVTABPTR                                        0935
         STCM  @14,7,GETLST03                                      0935
*                 GETLST05=78;      /* SUBPOOL VALUE                 */
         MVI   GETLST05,X'4E'                                      0936
*                 GPR01P=ADDR(GETLST);/* REG1 POINTS TO LIST         */
         LA    GPR01P,GETLST                                       0937
*                 SVC(4);           /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0938
*                 ERCOM=GPR15F;     /* SET RETURN CODE               */
         ST    GPR15F,ERCOM(,COMONPTR)                             0939
*                 RESPECIFY                                        0940
*                  (GPR01P,                                        0940
*                   GPR15F) UNRESTRICTED;                          0940
*               END;                /* GETMAIN LV(NEWLNG) A(SVTABPTR)
*                                      SP(78) MF(E,GETLST)         0941
*                                      RTCD(ERCOM)                   */
*               IF ERCOM^=F0 THEN   /* IF GETMAIN FAILS              */
         L     @15,ERCOM(,COMONPTR)                                0942
         LTR   @15,@15                                             0942
         BZ    @RF00942                                            0942
*                 DO;               /* TERMINATE UPDATE              */
*                   ERCOM=E16;      /* SET ERCOM CODE                */
         LA    @15,16                                              0944
         ST    @15,ERCOM(,COMONPTR)                                0944
*                   ERROR=ERCOM;    /* SET INT ERROR                 */
         ST    @15,ERROR                                           0945
*                   RETURN;         /* RETURN                        */
@EL00024 DS    0H                                                  0946
@EF00024 DS    0H                                                  0946
@ER00024 LM    @14,@12,12(@13)                                     0946
         BR    @14                                                 0946
*                 END;              /*                               */
*               ELSE                /* OTHERWISE                     */
*                 DO;               /* SET UP AND COPY TABLE         */
@RF00942 DS    0H                                                  0949
*                   SVTABNXT=SVTABFST;/* POINT TO OLD TABLE          */
         L     @15,SVTABPTR                                        0949
         L     @14,EXECDPTR(,COMONPTR)                             0949
         L     @07,SVTABFST(,@14)                                  0949
         ST    @07,SVTABNXT(,@15)                                  0949
*                   SVTABFRE=F0;    /* NO FREE SAPCE IN TABLE        */
         SLR   @07,@07                                             0950
         ST    @07,SVTABFRE(,@15)                                  0950
*                   SVTABLNG=NEWLNG;/* LENGTH OF THIS TABLE          */
         L     @06,NEWLNG                                          0951
         ST    @06,SVTABLNG(,@15)                                  0951
*                   SVTABUSE=LENGTH(SVTAB)+LENGTH(NULELEM);/* INIT 0952
*                                      USED                          */
         MVC   SVTABUSE(4,@15),@CF00255                            0952
*                   SVTABFST=SVTABPTR;/* INIT EXEC DATA POINTER      */
         ST    @15,SVTABFST(,@14)                                  0953
*                   SNTABPTR=SNTABFST;/* POINT TO FIRST NAME TAB     */
         L     @14,SNTABFST(,@14)                                  0954
         ST    @14,SNTABPTR                                        0954
*                   SNTELPTR=ADDR(SNTELFST);/* GET ADDR OF FIRST NAME*/
         LA    @14,SNTELFST(,@14)                                  0955
         ST    @14,SNTELPTR(,COMONPTR)                             0955
*                   RFY                                            0956
*                    (R2,                                          0956
*                     R3,                                          0956
*                     R4,                                          0956
*                     R5) RSTD;     /* RESTRICT REGS                 */
*                   EXITC=NO;       /* RESET EXIT SWITCH             */
         NI    EXITC(COMONPTR),B'11111110'                         0957
*                   R2=ADDR(SVTELFST)+LENGTH(NULELEM);/* GET FIRST 0958
*                                      ALAIL SLOT                    */
         LA    R2,SVTELFST(,@15)                                   0958
         AL    R2,@CF00107                                         0958
*                   NULELEM=NULVAL; /* INIT NULL ELEMENT             */
         ST    @07,NULELEM(,@15)                                   0959
*                   DO WHILE EXITC=NO;/* MOVE UNTIL END OF TABLE     */
         B     @DE00960                                            0960
@DL00960 DS    0H                                                  0961
*                     IF SNTELPTR^=SNTSAVE&SNTLABEL=NO&/* OK TO COPY */
*                         SNTGLOB=NO THEN/* ELEMENT ?                */
         L     @15,SNTELPTR(,COMONPTR)                             0961
         C     @15,SNTSAVE                                         0961
         BE    @RF00961                                            0961
         TM    SNTLABEL(@15),B'00010000'                           0961
         BNZ   @RF00961                                            0961
         TM    SNTGLOB(@15),B'10000000'                            0961
         BNZ   @RF00961                                            0961
*                       DO;         /* YES-MOVE INTO NEW TABLE       */
*                         IF SVTORIG=F0 THEN/* IF ORIGINALLY NULL    */
         L     @01,SNTVLPTR(,@15)                                  0963
         LH    @14,SVTORIG(,@01)                                   0963
         LTR   @14,@14                                             0963
         BNZ   @RF00963                                            0963
*                           SNTVLPTR=ADDR(NULELEM);/* POINT TO NULL
*                                      ELEM                          */
         L     @01,SVTABPTR                                        0964
         LA    @14,NULELEM(,@01)                                   0964
         ST    @14,SNTVLPTR(,@15)                                  0964
*                         ELSE      /* OTHERWISE ASSIGN A SLOT       */
*                           DO;     /* IN NEW TABLE                  */
         B     @RC00963                                            0965
@RF00963 DS    0H                                                  0966
*                             R3=SVTORIG+LENGTH(SVTELEM);/* LENGTH OF
*                                      MOVE                          */
         LA    @15,4                                               0966
         L     @14,SNTELPTR(,COMONPTR)                             0966
         L     @07,SNTVLPTR(,@14)                                  0966
         LH    @06,SVTORIG(,@07)                                   0966
         LR    R3,@06                                              0966
         ALR   R3,@15                                              0966
*                             R4=SNTVLPTR;/* POINT TO OLD DATA       */
         LR    R4,@07                                              0967
*                             R5=R3;/* GET FROM LENGTH               */
         LR    R5,R3                                               0968
*                             SVTABFRE=SVTABFRE+SVTORIG-SVTLNG;/*  0969
*                                      UPDATE FREE                   */
         L     @01,SVTABPTR                                        0969
         L     @00,SVTABFRE(,@01)                                  0969
         ALR   @00,@06                                             0969
         SH    @00,SVTLNG(,@07)                                    0969
         ST    @00,SVTABFRE(,@01)                                  0969
*                             SVTABUSE=SVTABUSE+SVTORIG+LENGTH(SVTELEM)
*                                 ;                                0970
         AL    @06,SVTABUSE(,@01)                                  0970
         ALR   @06,@15                                             0970
         ST    @06,SVTABUSE(,@01)                                  0970
*                             SNTVLPTR=R2;/* RESET VALUE POINTER     */
         ST    R2,SNTVLPTR(,@14)                                   0971
*                             MVCL(R2,R4);/* COPY INT NEW TABLE      */
         MVCL  R2,R4                                               0972
*                           END;                                   0973
*                       END;        /*                               */
@RC00963 DS    0H                                                  0975
*                     IF SNTLAST=YES THEN/* IF LAST IN TABLE         */
@RF00961 L     @01,SNTELPTR(,COMONPTR)                             0975
         TM    SNTLAST(@01),B'00000001'                            0975
         BNO   @RF00975                                            0975
*                       IF SNTABNXT=F0 THEN/* AND NO MORE TABLES     */
         L     @01,SNTABPTR                                        0976
         L     @15,SNTABNXT(,@01)                                  0976
         LTR   @15,@15                                             0976
         BNZ   @RF00976                                            0976
*                         EXITC=YES;/* END COPY                      */
         OI    EXITC(COMONPTR),B'00000001'                         0977
*                       ELSE        /* RESET TO NEW TABLE            */
*                         DO;       /*                               */
         B     @RC00976                                            0978
@RF00976 DS    0H                                                  0979
*                           SNTABPTR=SNTABNXT;/* RESET BASE          */
         L     @01,SNTABPTR                                        0979
         L     @15,SNTABNXT(,@01)                                  0979
         ST    @15,SNTABPTR                                        0979
*                           SNTELPTR=ADDR(SNTELFST);/* RESET EL PTR  */
         LA    @15,SNTELFST(,@15)                                  0980
         ST    @15,SNTELPTR(,COMONPTR)                             0980
*                         END;      /*                               */
*                     ELSE          /* OTHERWISE                     */
*                       SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);  0982
         B     @RC00975                                            0982
@RF00975 L     @15,SNTELPTR(,COMONPTR)                             0982
         LH    @14,SNTLNG(,@15)                                    0982
         ALR   @14,@15                                             0982
         AL    @14,@CF00094                                        0982
         ST    @14,SNTELPTR(,COMONPTR)                             0982
*                   END;            /*                               */
@RC00975 DS    0H                                                  0983
@DE00960 TM    EXITC(COMONPTR),B'00000001'                         0983
         BZ    @DL00960                                            0983
*                   RFY                                            0984
*                    (R2,                                          0984
*                     R3,                                          0984
*                     R4,                                          0984
*                     R5) UNRSTD;   /* RELEASE REGS                  */
*                   SNTELPTR=SNTSAVE;/* RESTORE SNTELPTR             */
         L     @15,SNTSAVE                                         0985
         ST    @15,SNTELPTR(,COMONPTR)                             0985
*                   SNTABPTR=SNTABFST;/* RESTORE TABLE POINTER       */
         L     @01,EXECDPTR(,COMONPTR)                             0986
         L     @15,SNTABFST(,@01)                                  0986
         ST    @15,SNTABPTR                                        0986
*                   DO;             /* FREEMAIN                    0987
*                                      LV(SVTABNXT->SVTABLNG)      0987
*                                      A(SVTABNXT) SP(78)          0987
*                                      MF(E,FRELST)                  */
*                     RESPECIFY                                    0988
*                      (GPR01P) RESTRICTED;                        0988
*                     FRELST02=SVTABNXT->SVTABLNG;/* LENGTH          */
         L     @15,SVTABPTR                                        0989
         L     @14,SVTABNXT(,@15)                                  0989
         MVC   FRELST02(3),SVTABLNG+1(@14)                         0989
*                     FRELST04=ADDR(SVTABNXT);/* ADDR OF ADDR LIST   */
         STCM  @15,7,FRELST04                                      0990
*                     FRELST06=78;  /* SUBPOOL VALUE                 */
         MVI   FRELST06,X'4E'                                      0991
*                     GPR01P=ADDR(FRELST);/* REG1 POINTS TO LIST     */
         LA    GPR01P,FRELST                                       0992
*                     SVC(5);       /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0993
*                     RESPECIFY                                    0994
*                      (GPR01P) UNRESTRICTED;                      0994
*                   END;            /* FREEMAIN                    0995
*                                      LV(SVTABNXT->SVTABLNG)      0995
*                                      A(SVTABNXT) SP(78)          0995
*                                      MF(E,FRELST)                  */
*                   SVTABNXT=F0;    /* BREAK CHAIN                   */
         L     @01,SVTABPTR                                        0996
         SLR   @00,@00                                             0996
         ST    @00,SVTABNXT(,@01)                                  0996
*                 END;              /*                               */
*             END;                  /*                               */
*           SNTVLPTR=SVTABPTR+SVTABUSE;/* ASSIGN NEW SLOT            */
@RF00927 L     @01,SNTELPTR(,COMONPTR)                             0999
         L     @15,SVTABPTR                                        0999
         L     @14,SVTABUSE(,@15)                                  0999
         LR    @00,@15                                             0999
         ALR   @00,@14                                             0999
         ST    @00,SNTVLPTR(,@01)                                  0999
*           SVTORIG=VALLEN;         /* SET LENGTH OF VALUE           */
         L     @01,@PC00024+4                                      1000
         L     @01,VALLEN(,@01)                                    1000
         LR    @07,@00                                             1000
         STH   @01,SVTORIG(,@07)                                   1000
*           SVTLNG=VALLEN;          /*                               */
         LR    @07,@00                                             1001
         STH   @01,SVTLNG(,@07)                                    1001
*           SVTABUSE=SVTABUSE+VALLEN+LENGTH(SVTELEM);/*              */
         ALR   @14,@01                                             1002
         AL    @14,@CF00107                                        1002
         ST    @14,SVTABUSE(,@15)                                  1002
*         END;                      /*                               */
*       SVTABFRE=SVTABFRE+SVTLNG-VALLEN;/* ADJUST FREE AREA          */
@RF00925 L     @15,SVTABPTR                                        1004
         L     @01,SNTELPTR(,COMONPTR)                             1004
         L     @14,SNTVLPTR(,@01)                                  1004
         LH    @07,SVTLNG(,@14)                                    1004
         AL    @07,SVTABFRE(,@15)                                  1004
         L     @06,@PC00024+4                                      1004
         SL    @07,VALLEN(,@06)                                    1004
         ST    @07,SVTABFRE(,@15)                                  1004
*       IF NODATA=YES THEN          /* IF NODATA SPECIFIED           */
         TM    NODATA(COMONPTR),B'01000000'                        1005
         BNO   @RF01005                                            1005
*         SVTLNG=F0;                /* CURRENT LENGTH IS ZERO        */
         SLR   @15,@15                                             1006
         STH   @15,SVTLNG(,@14)                                    1006
*       ELSE                        /* OTHERWISE                     */
*         SVTLNG=VALLEN;            /* SET NEW LENGTH                */
         B     @RC01005                                            1007
@RF01005 L     @01,SNTELPTR(,COMONPTR)                             1007
         L     @01,SNTVLPTR(,@01)                                  1007
         L     @15,@PC00024+4                                      1007
         L     @00,VALLEN(,@15)                                    1007
         STH   @00,SVTLNG(,@01)                                    1007
*       RFY                                                        1008
*        (R2,                                                      1008
*         R3,                                                      1008
*         R4,                                                      1008
*         R5) RSTD;                 /* RESTRICT REGS                 */
@RC01005 DS    0H                                                  1009
*       R2=ADDR(SVTDATA);           /*                               */
         L     @01,SNTELPTR(,COMONPTR)                             1009
         L     @15,SNTVLPTR(,@01)                                  1009
         LA    R2,SVTDATA(,@15)                                    1009
*       R3=SVTORIG;                 /* ALWAYS CLEAR OR MOVE TO ALL   */
         LH    R3,SVTORIG(,@15)                                    1010
*       R4=ADDR(VALUE);             /* POINT TO NEW DATA             */
         L     R4,@PC00024                                         1011
*       R5=SVTLNG×BLANKS;           /* ONLY MOVE WHAT SVTLNG SAYS    */
         LH    R5,SVTLNG(,@15)                                     1012
         O     R5,@CF00622                                         1012
*       MVCL(R2,R4);                /* MOVE NEW DATA                 */
         MVCL  R2,R4                                               1013
*       RFY                                                        1014
*        (R2,                                                      1014
*         R3,                                                      1014
*         R4,                                                      1014
*         R5) UNRSTD;               /* RELEASE REGS                  */
*     END;                          /*                               */
*   EXECDPTR=LSDEXEC;               /* RESET EXEC DATA POINTER       */
@RC00922 L     @01,LSDPTR(,COMONPTR)                               1016
         L     @15,LSDEXEC(,@01)                                   1016
         ST    @15,EXECDPTR(,COMONPTR)                             1016
*   ERROR=ERCOM;                                                   1017
         L     @15,ERCOM(,COMONPTR)                                1017
         ST    @15,ERROR                                           1017
*   END UPDATE;                     /* END OF UPDATE                 */
         B     @EL00024                                            1018
*                                                                  1019
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CODE UPDATE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1019
*RCUPDT:                                                           1019
*   PROC;                                                          1019
RCUPDT   STM   @14,@12,@SA00025                                    1019
*   IF NOLASTCC=YES THEN            /* IF SKIP LASTCC UPDATE @ZA03879*/
         L     @15,EXECDPTR(,COMONPTR)                             1020
         TM    NOLASTCC(@15),B'01000000'                           1020
         BNO   @RF01020                                            1020
*     NOLASTCC=NO;                  /* TURN OFF FLAG         @ZA03879*/
         NI    NOLASTCC(@15),B'10111111'                           1021
*   ELSE                            /*                       @ZA03879*/
*     DO;                           /* NORMAL UPDATE         @ZA03879*/
         B     @RC01020                                            1022
@RF01020 DS    0H                                                  1023
*       IF RCABEND=YES&ERRSAV//F4096=F0 THEN/* IF SYSTEM ABEND CODE  */
         TM    RCABEND(COMONPTR),B'10000000'                       1023
         BNO   @RF01023                                            1023
         L     @15,ERRSAV                                          1023
         LR    @00,@15                                             1023
         SRDA  @00,32                                              1023
         D     @00,@CF00725                                        1023
         LTR   @00,@00                                             1023
         BNZ   @RF01023                                            1023
*         DO;                       /* DETRIMINE TYPE                */
*           AREA(1:4)=ERRSAV;       /* PREPARE FOR UNPAK             */
         STCM  @15,15,AREA                                         1025
*           UNPK(OUTA1(2:8),AREA(1:5));/* UNPACK ABEND CODE          */
         UNPK  OUTA1+1(7),AREA(5)                                  1026
*           DO I=F7 TO F2 BY-F1;    /* TRANSLATE FA-FF TO C1-C5      */
         LA    @15,7                                               1027
         ST    @15,I(,COMONPTR)                                    1027
@DL01027 DS    0H                                                  1028
*             IF OUTFX(I)>F249 THEN /* DECIMAL OF F9 (FA-FF IS >)    */
         L     @15,I(,COMONPTR)                                    1028
         SLR   @14,@14                                             1028
         IC    @14,OUTFX-1(@15)                                    1028
         C     @14,@CF00402                                        1028
         BNH   @RF01028                                            1028
*               OUTFX(I)=OUTFX(I)-F57;/* SUBTRACT 39 (FA-39=C1)      */
         SL    @14,@CF00288                                        1029
         STC   @14,OUTFX-1(@15)                                    1029
*           END;                    /* DONE TRANSLATE                */
@RF01028 SLR   @15,@15                                             1030
         BCTR  @15,0                                               1030
         AL    @15,I(,COMONPTR)                                    1030
         ST    @15,I(,COMONPTR)                                    1030
         C     @15,@CF00062                                        1030
         BNL   @DL01027                                            1030
*           OUTA1(1)=CCS;           /* INSERT S FOR SYSTEM           */
         MVI   OUTA1,C'S'                                          1031
*           LEN=F4;                 /* LENGTH OF ANSWER              */
         MVC   LEN(4,COMONPTR),@CF00107                            1032
*         END;                      /*                               */
*       ELSE                        /* NORMAL PROCESSING             */
*         DO;                       /*                               */
         B     @RC01023                                            1034
@RF01023 DS    0H                                                  1035
*           CVD(ERRSAV,WORKAREA);   /* CONVERT CODE TO PRINTABLE     */
         L     @15,ERRSAV                                          1035
         CVD   @15,WORKAREA                                        1035
*           UNPK(OUTA1(1:16),WORKAREA);/*                            */
         UNPK  OUTA1(16),WORKAREA(8)                               1036
*           OUTA1(16)=OUTA1(16)×CC0;/* INSURE PRINTABLE CHARS        */
         OI    OUTA1+15,C'0'                                       1037
*           IF RCABEND=YES THEN     /* IF USER ABEND CODE            */
         TM    RCABEND(COMONPTR),B'10000000'                       1038
         BNO   @RF01038                                            1038
*             DO;                   /*                               */
*               LEN=F5;             /* LENGTH IS FIVE                */
         MVC   LEN(4,COMONPTR),@CF00052                            1040
*               OUTA1(1)=CCU;       /* SET U TYPE                    */
         MVI   OUTA1,C'U'                                          1041
*               OUTA1(2:5)=OUTA1(13:16);/* MOVE OVER CHARS           */
         MVC   OUTA1+1(4),OUTA1+12                                 1042
*             END;                  /*                               */
*           ELSE                    /* OTHERWISE GET CODE            */
*             DO LEN=F16 TO F2 BY-F1 WHILE OUTA1(1)=CC0;/* LZ      1044
*                                      SUPPRESS                      */
         B     @RC01038                                            1044
@RF01038 LA    @15,16                                              1044
         ST    @15,LEN(,COMONPTR)                                  1044
@DL01044 CLI   OUTA1,C'0'                                          1044
         BNE   @DC01044                                            1044
*               OUTA1(1:15)=OUTA1(2:16);/* SHIFT DOWN BUFFER         */
         MVC   @TS00001(15),OUTA1+1                                1045
         MVC   OUTA1(15),@TS00001                                  1045
*             END;                  /*                               */
         SLR   @15,@15                                             1046
         BCTR  @15,0                                               1046
         AL    @15,LEN(,COMONPTR)                                  1046
         ST    @15,LEN(,COMONPTR)                                  1046
         C     @15,@CF00062                                        1046
         BNL   @DL01044                                            1046
@DC01044 DS    0H                                                  1047
*         END;                      /*                               */
@RC01038 DS    0H                                                  1048
*       CALL LOCATE(LASTCC,LENGTH(LASTCC),F0);/* LOCATE LASTCC       */
@RC01023 LA    @01,@AL01048                                        1048
         BAL   @14,LOCATE                                          1048
*       IF ERROR=F0 THEN            /* IF LOCATE OK                  */
         L     @15,ERROR                                           1049
         LTR   @15,@15                                             1049
         BNZ   @RF01049                                            1049
*         DO;                       /* PROCESS UPDATE                */
*           CALL UPDATE(OUTA1,LEN); /* UPDATE LASTCC                 */
         LA    @15,OUTA1                                           1051
         ST    @15,@AL00001                                        1051
         LA    @15,LEN(,COMONPTR)                                  1051
         ST    @15,@AL00001+4                                      1051
         LA    @01,@AL00001                                        1051
         BAL   @14,UPDATE                                          1051
*           CALL LOCATE(MAXCC,LENGTH(MAXCC),F0);/* LOCATE MAXCC      */
         LA    @01,@AL01052                                        1052
         BAL   @14,LOCATE                                          1052
*           IF ERROR=F0&SVTLNG<LEN×(SVTLNG=/* MX SMALLER ?           */
*               LEN&SVTDATA(1:LEN)<OUTA1(1:LEN)) THEN/* UPDATE       */
         L     @15,ERROR                                           1053
         LTR   @15,@15                                             1053
         BNZ   @GL00065                                            1053
         L     @01,SNTELPTR(,COMONPTR)                             1053
         L     @01,SNTVLPTR(,@01)                                  1053
         LH    @15,SVTLNG(,@01)                                    1053
         C     @15,LEN(,COMONPTR)                                  1053
         BL    @RT01053                                            1053
@GL00065 L     @01,SNTELPTR(,COMONPTR)                             1053
         L     @15,SNTVLPTR(,@01)                                  1053
         L     @14,LEN(,COMONPTR)                                  1053
         CH    @14,SVTLNG(,@15)                                    1053
         BNE   @RF01053                                            1053
         BCTR  @14,0                                               1053
         EX    @14,@SC01113                                        1053
         BNL   @RF01053                                            1053
@RT01053 DS    0H                                                  1054
*             CALL UPDATE(OUTA1,LEN);/* UPDATE MAXCC                 */
         LA    @15,OUTA1                                           1054
         ST    @15,@AL00001                                        1054
         LA    @15,LEN(,COMONPTR)                                  1054
         ST    @15,@AL00001+4                                      1054
         LA    @01,@AL00001                                        1054
         BAL   @14,UPDATE                                          1054
*         END;                      /*                               */
@RF01053 DS    0H                                                  1056
*       IF ERROR^=F0&ERROR^=E16 THEN/* ERROR FINDIN OR UPDATIN CC S  */
@RF01049 L     @15,ERROR                                           1056
         LTR   @15,@15                                             1056
         BZ    @RF01056                                            1056
         C     @15,@CF00104                                        1056
         BE    @RF01056                                            1056
*         ERROR=E999;               /* SET INTERNAL CLIST ERROR      */
         MVC   ERROR(4),@CF00817                                   1057
*     END;                          /* END NORMAL UPDATE     @ZA03879*/
*   END RCUPDT;                                                    1059
@EL00025 DS    0H                                                  1059
@EF00025 DS    0H                                                  1059
@ER00025 LM    @14,@12,@SA00025                                    1059
         BR    @14                                                 1059
*                                                                  1060
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT SUB FUNCTION                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1060
*PRINT:                                                            1060
*   PROC(LINEADDR,TERMPUT) OPTIONS(SAVEAREA);                      1060
PRINT    STM   @14,@12,12(@13)                                     1060
         ST    @13,@SA00026+4                                      1060
         LA    @14,@SA00026                                        1060
         ST    @14,8(,@13)                                         1060
         LR    @13,@14                                             1060
         MVC   @PC00026(8),0(@01)                                  1060
*   DCL                                                            1061
*     TERMPUT FIXED(31),                                           1061
*     LINEADDR PTR(31),                                            1061
*     ASIS FIXED(31) CONSTANT(2);                                  1061
*   IOPL(4)=ADDR(PLBLK);            /* ADDR OF PARM BLOCK            */
         LA    @15,PLBLK                                           1062
         ST    @15,IOPL+12(,COMONPTR)                              1062
*   CLEN=LINEADDR->LL;              /* SAVE ORIGINAL LENGTH          */
         L     @15,@PC00026                                        1063
         L     @15,LINEADDR(,@15)                                  1063
         LH    @14,LL(,@15)                                        1063
         STH   @14,CLEN(,COMONPTR)                                 1063
*   LINEADDR->LL=LINEADDR->LL-FREEAMT;/* REDUCE TOTAL LENGTH         */
         SL    @14,FREEAMT(,COMONPTR)                              1064
         STH   @14,LL(,@15)                                        1064
*   IF LINEADDR->LL=F4 THEN         /* IF LL=4 THEN SET LL=5         */
         C     @14,@CF00107                                        1065
         BNE   @RF01065                                            1065
*     LINEADDR->LL=F5;              /* TO FOOL TCAM (FOR C/R)        */
         MVC   LL(2,@15),@CH00052                                  1066
*   RFY                                                            1067
*    (R1,                                                          1067
*     R4,                                                          1067
*     R15) RSTD;                    /* RESTRICT REGS                 */
@RF01065 DS    0H                                                  1068
*   R15=ADDR(IKJEFT40);             /* ADDR OF T40                   */
         L     R15,@CV00101                                        1068
*   R1=ADDR(IOPL);                  /* LOAD REG 1                    */
         LR    R1,COMONPTR                                         1069
*   R4=LINEADDR;                    /* POINTER TO LINE TO PRINT      */
         L     @14,@PC00026                                        1070
         L     R4,LINEADDR(,@14)                                   1070
*   IF TERMPUT=ASIS THEN            /* PUTLINE ASIS                  */
         L     @14,@PC00026+4                                      1071
         CLC   TERMPUT(4,@14),@CF00062                             1071
         BNE   @RF01071                                            1071
*     GEN                                                          1072
*(PUTLINE OUTPUT=((R4),DATA),TERMPUT=ASIS,MF=(E,(1)),ENTRY=(15));  1072
         PUTLINE OUTPUT=((R4),DATA),TERMPUT=ASIS,MF=(E,(1)),ENTRY=(15)
*   ELSE                            /* OTHERWISE PRINT EDIT          */
*     GEN                                                          1073
*(PUTLINE OUTPUT=((R4),DATA),TERMPUT=EDIT,MF=(E,(1)),ENTRY=(15));  1073
         B     @RC01071                                            1073
@RF01071 DS    0H                                                  1073
         PUTLINE OUTPUT=((R4),DATA),TERMPUT=EDIT,MF=(E,(1)),ENTRY=(15)
*   RFY                                                            1074
*    (R1,                                                          1074
*     R4,                                                          1074
*     R15) UNRSTD;                  /* FREE REGS                     */
@RC01071 DS    0H                                                  1075
*   LINEADDR->LL=CLEN;              /* RESTORE LENGTH                */
         L     @15,@PC00026                                        1075
         L     @01,LINEADDR(,@15)                                  1075
         LH    @00,CLEN(,COMONPTR)                                 1075
         STH   @00,LL(,@01)                                        1075
*   END PRINT;                                                     1076
@EL00026 L     @13,4(,@13)                                         1076
@EF00026 DS    0H                                                  1076
@ER00026 LM    @14,@12,12(@13)                                     1076
         BR    @14                                                 1076
*                                                                  1077
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMAND LIST ROUTINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1077
*CMDLST:                                                           1077
*   PROC;                                                          1077
CMDLST   STM   @14,@12,@SA00027                                    1077
*   IF OPCODE^=IGOTO THEN           /* AS LONG AS NOT INTERNAL GOTO  */
         L     @01,OLDLINE(,COMONPTR)                              1078
         CLI   OPCODE(@01),15                                      1078
         BE    @RF01078                                            1078
*     DO;                           /* LIST COMMAND                  */
*       IF FOLD=NO THEN             /* FOLD INTO UPPER CASE ?        */
         TM    FOLD(COMONPTR),B'00010000'                          1080
         BNZ   @RF01080                                            1080
*         CALL PRINT(BUFBASE,F0);   /* NO- PRINT OK                  */
         LA    @15,BUFBASE(,COMONPTR)                              1081
         ST    @15,@AL00001                                        1081
         LA    @15,@CF00439                                        1081
         ST    @15,@AL00001+4                                      1081
         LA    @01,@AL00001                                        1081
         BAL   @14,PRINT                                           1081
*       ELSE                        /* YES- FOLD TO UPPER CASE       */
*         DO;                       /* BEFORE PRINTING               */
         B     @RC01080                                            1082
@RF01080 DS    0H                                                  1083
*           DO I=1 TO LL-(F4+FREEAMT);/* FOLD TO UPPER CASE          */
         LA    @15,1                                               1083
         B     @DE01083                                            1083
@DL01083 DS    0H                                                  1084
*             NEWC(I)=C(I);         /* COPY TO NEW BUFFER            */
         L     @15,I(,COMONPTR)                                    1084
         L     @14,NEWBASE(,COMONPTR)                              1084
         ALR   @15,@14                                             1084
         L     @07,I(,COMONPTR)                                    1084
         L     @06,BUFBASE(,COMONPTR)                              1084
         ALR   @06,@07                                             1084
         MVC   NEWC-1(1,@15),C-1(@06)                              1084
*             TR(NEWC(I),TRTABUP);  /* TRANSLATE TO UPPER CASE       */
         ALR   @14,@07                                             1085
         TR    NEWC-1(1,@14),TRTABUP                               1085
*           END;                    /*                               */
         LA    @15,1                                               1086
         AL    @15,I(,COMONPTR)                                    1086
@DE01083 ST    @15,I(,COMONPTR)                                    1086
         L     @14,BUFBASE(,COMONPTR)                              1086
         LA    @07,4                                               1086
         AL    @07,FREEAMT(,COMONPTR)                              1086
         LCR   @07,@07                                             1086
         AH    @07,LL(,@14)                                        1086
         CR    @15,@07                                             1086
         BNH   @DL01083                                            1086
*           CALL PRINT(NEWBASE,F0); /* PRINT FOLDED LINE             */
         LA    @15,NEWBASE(,COMONPTR)                              1087
         ST    @15,@AL00001                                        1087
         LA    @15,@CF00439                                        1087
         ST    @15,@AL00001+4                                      1087
         LA    @01,@AL00001                                        1087
         BAL   @14,PRINT                                           1087
*         END;                      /*                               */
*     END;                                                         1089
*   END CMDLST;                                                    1090
@EL00027 DS    0H                                                  1090
@EF00027 DS    0H                                                  1090
@ER00027 LM    @14,@12,@SA00027                                    1090
         BR    @14                                                 1090
*                                                                  1091
*   /*****************************************************************/
*   /*                                                               */
*   /* STRING BUILT IN FUNCTION                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*STRRTN:                                                           1091
*   PROC;                                                          1091
STRRTN   STM   @14,@12,@SA00028                                    1091
*   CALL WAITRTN;                   /* CHECK FOR WAIT                */
         BAL   @14,WAITRTN                                         1092
*   IF WAIT=NO&ERROR=F0 THEN        /* IF OK                         */
         TM    WAIT(COMONPTR),B'00010000'                          1093
         BNZ   @RF01093                                            1093
         L     @15,ERROR                                           1093
         LTR   @15,@15                                             1093
         BNZ   @RF01093                                            1093
*     DO;                           /* PROCESS                       */
*       PCTR=F1;                    /* INIT PCTR                     */
         LA    @15,1                                               1095
         ST    @15,PCTR                                            1095
*       INSRTDA=ADDR(C(I+1));       /* POINT TO VALUE                */
         L     @01,I(,COMONPTR)                                    1096
         L     @14,BUFBASE(,COMONPTR)                              1096
         LA    @07,C(@01,@14)                                      1096
         ST    @07,INSRTDA                                         1096
*       INSRTLN=ADDR(C(M))-INSRTDA; /* FIND LENGTH OF STRING         */
         L     @01,M                                               1097
         LA    @06,C-1(@01,@14)                                    1097
         SLR   @06,@07                                             1097
         ST    @06,INSRTLN                                         1097
*       DO I=1 TO INSRTLN;          /*                               */
         B     @DE01098                                            1098
@DL01098 DS    0H                                                  1099
*         TR(INSRTCHR(I),TRTABDN);  /* FOLD TO SPCL CHR              */
         L     @01,I(,COMONPTR)                                    1099
         L     @15,INSRTDA                                         1099
         ALR   @15,@01                                             1099
         BCTR  @15,0                                               1099
         TR    INSRTCHR(1,@15),TRTABDN                             1099
*       END;                                                       1100
         LA    @15,1                                               1100
         AL    @15,I(,COMONPTR)                                    1100
@DE01098 ST    @15,I(,COMONPTR)                                    1100
         C     @15,INSRTLN                                         1100
         BNH   @DL01098                                            1100
*       I=M+F1;                     /* POINT TO RESUME DATA          */
         LA    @15,1                                               1101
         AL    @15,M                                               1101
         ST    @15,I(,COMONPTR)                                    1101
*     END;                                                         1102
*   END STRRTN;                                                    1103
@EL00028 DS    0H                                                  1103
@EF00028 DS    0H                                                  1103
@ER00028 LM    @14,@12,@SA00028                                    1103
         BR    @14                                                 1103
*                                                                  1104
*   /*****************************************************************/
*   /*                                                               */
*   /* SEPARATOR FLUSH ROUTINE                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1104
*SKIPSEPS:                                                         1104
*   PROC;                                                          1104
SKIPSEPS STM   @14,@12,12(@13)                                     1104
*   SEPS=YES;                       /* SKIP ALL DELIMETERS           */
         OI    SEPS(COMONPTR),B'10000000'                          1105
*   WORDPTR=BUFBASE;                /* POINT TO BUFFER               */
         L     @15,BUFBASE(,COMONPTR)                              1106
         ST    @15,WORDPTR                                         1106
*   WI=I;                           /* GET I                         */
         L     @15,I(,COMONPTR)                                    1107
         ST    @15,WI                                              1107
*   DO WHILE SEPS=YES&WI<=WLL-(F4+FREEAMT);/*                        */
         B     @DE01108                                            1108
@DL01108 DS    0H                                                  1109
*     IF W(WI)^=BLANK&W(WI)^=COMMA&W(WI)^=TAB THEN/* NOT DELIM       */
         L     @15,WORDPTR                                         1109
         L     @14,WI                                              1109
         ALR   @14,@15                                             1109
         CLI   W-1(@14),C' '                                       1109
         BE    @RF01109                                            1109
         L     @14,WI                                              1109
         ALR   @14,@15                                             1109
         CLI   W-1(@14),C','                                       1109
         BE    @RF01109                                            1109
         L     @14,WI                                              1109
         ALR   @14,@15                                             1109
         CLI   W-1(@14),X'05'                                      1109
         BE    @RF01109                                            1109
*       IF WI<WLL-(F4+FREEAMT)&W(WI:WI+F1)=OPENCMT THEN/* CMT        */
         L     @14,WI                                              1110
         LA    @07,4                                               1110
         L     @06,FREEAMT(,COMONPTR)                              1110
         ALR   @06,@07                                             1110
         LCR   @06,@06                                             1110
         AH    @06,WLL(,@15)                                       1110
         CR    @14,@06                                             1110
         BNL   @RF01110                                            1110
         ALR   @15,@14                                             1110
         CLC   W-1(2,@15),@CC00628                                 1110
         BNE   @RF01110                                            1110
*         DO;                       /*                               */
*           DO WI=WI+F4 TO WLL-(F4+FREEAMT) WHILE/*                  */
*                 W(WI-F2:WI-F1)^=CLOSCMT;/*                         */
         ALR   @14,@07                                             1112
         B     @DE01112                                            1112
@DL01112 L     @01,WORDPTR                                         1112
         ALR   @01,@14                                             1112
         CLC   W-3(2,@01),@CC00630                                 1112
         BE    @DC01112                                            1112
*           END;                    /* FIND CLOSE COMMENT            */
         AL    @14,@CF00042                                        1113
@DE01112 ST    @14,WI                                              1113
         LA    @15,4                                               1113
         AL    @15,FREEAMT(,COMONPTR)                              1113
         LCR   @15,@15                                             1113
         L     @01,WORDPTR                                         1113
         AH    @15,WLL(,@01)                                       1113
         CR    @14,@15                                             1113
         BNH   @DL01112                                            1113
@DC01112 DS    0H                                                  1114
*         END;                                                     1114
*       ELSE                        /* IF NOT A DELIMETER, END SKIP  */
*         SEPS=NO;                  /*                               */
         B     @RC01110                                            1115
@RF01110 NI    SEPS(COMONPTR),B'01111111'                          1115
*     ELSE                          /* IF A SEPARATOR, INCREMENT     */
*       WI=WI+F1;                   /* INDEX                         */
         B     @RC01109                                            1116
@RF01109 LA    @15,1                                               1116
         AL    @15,WI                                              1116
         ST    @15,WI                                              1116
*   END;                                                           1117
@RC01109 DS    0H                                                  1117
@DE01108 TM    SEPS(COMONPTR),B'10000000'                          1117
         BNO   @DC01108                                            1117
         LA    @15,4                                               1117
         AL    @15,FREEAMT(,COMONPTR)                              1117
         LCR   @15,@15                                             1117
         L     @14,WORDPTR                                         1117
         AH    @15,WLL(,@14)                                       1117
         C     @15,WI                                              1117
         BNL   @DL01108                                            1117
@DC01108 DS    0H                                                  1118
*   I=WI;                           /* SET I                         */
         L     @15,WI                                              1118
         ST    @15,I(,COMONPTR)                                    1118
*   END SKIPSEPS;                                                  1119
@EL00029 DS    0H                                                  1119
@EF00029 DS    0H                                                  1119
@ER00029 LM    @14,@12,12(@13)                                     1119
         BR    @14                                                 1119
*                                                                  1120
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND A WORD ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1120
*FINDWORD:                                                         1120
*   PROC;                                                          1120
FINDWORD STM   @14,@12,@SA00030                                    1120
*   CALL SKIPSEPS;                  /* SKIP SEPARATORS               */
         BAL   @14,SKIPSEPS                                        1121
*SCANWORD:                                                         1122
*   ENTRY;                          /* SCANWORD ENTRY                */
         B     @EC01122                                            1122
SCANWORD STM   @14,@12,@SA00030                                    1122
@EC01122 DS    0H                                                  1123
*   BEGIN=I;                        /* BEGIN OF KYWWORD              */
         L     @15,I(,COMONPTR)                                    1123
         ST    @15,BEGIN(,COMONPTR)                                1123
*   WI=I;                           /* GET I                         */
         ST    @15,WI                                              1124
*   ENDDLM=YES;                     /* INIT ENDDLM TO YES            */
         OI    ENDDLM(COMONPTR),B'01000000'                        1125
*   WORDPTR=BUFBASE;                /* SET BASE                      */
         L     @14,BUFBASE(,COMONPTR)                              1126
         ST    @14,WORDPTR                                         1126
*   IF SEPS=NO THEN                 /* IF ALL SEPARATORS             */
         TM    SEPS(COMONPTR),B'10000000'                          1127
         BNZ   @RF01127                                            1127
*     DO;                                                          1128
*       DO WI=WI TO LL-(F4+FREEAMT) WHILE/* CHECK FOR VALID CHARS    */
*             (W(WI)>=CCA&W(WI)<=CCI)×/* A TO I                      */
*             (W(WI)>=CCJ&W(WI)<=CCR)×/* J TO R                      */
*             (W(WI)>=CCS&W(WI)<=CCZ)×/* S TO Z                      */
*             (WI^=BEGIN&W(WI)>=CC0&W(WI)<=CC9);/* 0 TO 9            */
         B     @DE01129                                            1129
@DL01129 L     @14,WORDPTR                                         1129
         ALR   @15,@14                                             1129
         CLI   W-1(@15),C'A'                                       1129
         BL    @GL00076                                            1129
         L     @15,WI                                              1129
         ALR   @14,@15                                             1129
         CLI   W-1(@14),C'I'                                       1129
         BNH   @DB01129                                            1129
@GL00076 L     @15,WORDPTR                                         1129
         L     @14,WI                                              1129
         ALR   @14,@15                                             1129
         CLI   W-1(@14),C'J'                                       1129
         BL    @GL00075                                            1129
         L     @14,WI                                              1129
         ALR   @15,@14                                             1129
         CLI   W-1(@15),C'R'                                       1129
         BNH   @DB01129                                            1129
@GL00075 L     @15,WORDPTR                                         1129
         L     @14,WI                                              1129
         ALR   @14,@15                                             1129
         CLI   W-1(@14),C'S'                                       1129
         BL    @GL00074                                            1129
         L     @14,WI                                              1129
         ALR   @15,@14                                             1129
         CLI   W-1(@15),C'Z'                                       1129
         BNH   @DB01129                                            1129
@GL00074 L     @15,WI                                              1129
         C     @15,BEGIN(,COMONPTR)                                1129
         BE    @DC01129                                            1129
         L     @14,WORDPTR                                         1129
         ALR   @15,@14                                             1129
         CLI   W-1(@15),C'0'                                       1129
         BL    @DC01129                                            1129
         L     @15,WI                                              1129
         ALR   @14,@15                                             1129
         CLI   W-1(@14),C'9'                                       1129
         BH    @DC01129                                            1129
@DB01129 DS    0H                                                  1130
*       END;                        /*                               */
         LA    @15,1                                               1130
         AL    @15,WI                                              1130
         ST    @15,WI                                              1130
@DE01129 L     @14,BUFBASE(,COMONPTR)                              1130
         LA    @07,4                                               1130
         AL    @07,FREEAMT(,COMONPTR)                              1130
         LCR   @07,@07                                             1130
         AH    @07,LL(,@14)                                        1130
         CR    @15,@07                                             1130
         BNH   @DL01129                                            1130
@DC01129 DS    0H                                                  1131
*       IF WI<=WLL-(F4+FREEAMT)&W(WI)^=BLANK&/* NOT END OF BFR AND NT*/
*           W(WI)^=COMMA&W(WI)^=TAB&(OPCODE^=SETCODE×W(WI)^=EQUAL)&/**/
*           (WI=WLL-(F4+FREEAMT)×W(WI:WI+F1)^=OPENCMT) THEN/* NOT CMT*/
         L     @15,WI                                              1131
         L     @14,WORDPTR                                         1131
         LA    @07,4                                               1131
         AL    @07,FREEAMT(,COMONPTR)                              1131
         LCR   @07,@07                                             1131
         AH    @07,WLL(,@14)                                       1131
         CR    @15,@07                                             1131
         BH    @RF01131                                            1131
         ALR   @15,@14                                             1131
         CLI   W-1(@15),C' '                                       1131
         BE    @RF01131                                            1131
         L     @15,WI                                              1131
         ALR   @15,@14                                             1131
         CLI   W-1(@15),C','                                       1131
         BE    @RF01131                                            1131
         L     @15,WI                                              1131
         ALR   @15,@14                                             1131
         CLI   W-1(@15),X'05'                                      1131
         BE    @RF01131                                            1131
         L     @01,OLDLINE(,COMONPTR)                              1131
         CLI   OPCODE(@01),13                                      1131
         BNE   @GL00082                                            1131
         L     @15,WI                                              1131
         ALR   @14,@15                                             1131
         CLI   W-1(@14),C'='                                       1131
         BE    @RF01131                                            1131
@GL00082 L     @15,WI                                              1131
         L     @14,WORDPTR                                         1131
         LA    @07,4                                               1131
         AL    @07,FREEAMT(,COMONPTR)                              1131
         LCR   @07,@07                                             1131
         AH    @07,WLL(,@14)                                       1131
         CR    @15,@07                                             1131
         BE    @RT01131                                            1131
         ALR   @14,@15                                             1131
         CLC   W-1(2,@14),@CC00628                                 1131
         BE    @RF01131                                            1131
@RT01131 DS    0H                                                  1132
*         ENDDLM=NO;                /* SET NOT VALID DELIMETER       */
         NI    ENDDLM(COMONPTR),B'10111111'                        1132
*     END;                          /*                               */
@RF01131 DS    0H                                                  1134
*   I=WI;                           /* RESTORE I                     */
@RF01127 L     @15,WI                                              1134
         ST    @15,I(,COMONPTR)                                    1134
*   LEN=I-BEGIN;                    /* GET LENGTH OF KYWWORD         */
         SL    @15,BEGIN(,COMONPTR)                                1135
         ST    @15,LEN(,COMONPTR)                                  1135
*   END FINDWORD;                                                  1136
@EL00030 DS    0H                                                  1136
@EF00030 DS    0H                                                  1136
@ER00030 LM    @14,@12,@SA00030                                    1136
         BR    @14                                                 1136
*                                                                  1137
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND A FILE ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1137
*FINDFILE:                                                         1137
*   PROC;                           /*                       @ZA17843*/
FINDFILE STM   @14,@12,@SA00031                                    1137
*   CALL SKIPSEPS;                  /* SKIP SEPARATORS       @ZA17843*/
         BAL   @14,SKIPSEPS                                        1138
*   BEGIN=I;                        /* BEGIN OF KYWWORD      @ZA17843*/
         L     @15,I(,COMONPTR)                                    1139
         ST    @15,BEGIN(,COMONPTR)                                1139
*   WI=I;                           /* GET I                 @ZA17843*/
         ST    @15,WI                                              1140
*   ENDDLM=YES;                     /* INIT ENDDLM TO YES    @ZA17843*/
         OI    ENDDLM(COMONPTR),B'01000000'                        1141
*   WORDPTR=BUFBASE;                /* SET BASE              @ZA17843*/
         L     @14,BUFBASE(,COMONPTR)                              1142
         ST    @14,WORDPTR                                         1142
*   IF SEPS=NO THEN                 /* IF ALL SEPARATORS     @ZA17843*/
         TM    SEPS(COMONPTR),B'10000000'                          1143
         BNZ   @RF01143                                            1143
*     DO;                           /*                       @ZA17843*/
*       DO WI=WI TO LL-(F4+FREEAMT) WHILE/* CHAR CHECK       @ZA17843*/
*             (W(WI)>=CCA&W(WI)<=CCI)×/* A TO I              @ZA17843*/
*             (W(WI)>=CCJ&W(WI)<=CCR)×/* J TO R              @ZA17843*/
*             (W(WI)>=CCS&W(WI)<=CCZ)×/* S TO Z              @ZA17843*/
*             (W(WI)=CC$×W(WI)=CC@×W(WI)=CC#)×/* NATIONALS   @ZA17843*/
*             (WI^=BEGIN&W(WI)>=CC0&W(WI)<=CC9);/* 0 TO 9    @ZA17843*/
         B     @DE01145                                            1145
@DL01145 L     @14,WORDPTR                                         1145
         ALR   @15,@14                                             1145
         CLI   W-1(@15),C'A'                                       1145
         BL    @GL00092                                            1145
         L     @15,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'I'                                       1145
         BNH   @DB01145                                            1145
@GL00092 L     @15,WORDPTR                                         1145
         L     @14,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'J'                                       1145
         BL    @GL00091                                            1145
         L     @14,WI                                              1145
         ALR   @15,@14                                             1145
         CLI   W-1(@15),C'R'                                       1145
         BNH   @DB01145                                            1145
@GL00091 L     @15,WORDPTR                                         1145
         L     @14,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'S'                                       1145
         BL    @GL00090                                            1145
         L     @14,WI                                              1145
         ALR   @15,@14                                             1145
         CLI   W-1(@15),C'Z'                                       1145
         BNH   @DB01145                                            1145
@GL00090 L     @15,WORDPTR                                         1145
         L     @14,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'$'                                       1145
         BE    @DB01145                                            1145
         L     @14,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'@'                                       1145
         BE    @DB01145                                            1145
         L     @14,WI                                              1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'#'                                       1145
         BE    @DB01145                                            1145
         L     @14,WI                                              1145
         C     @14,BEGIN(,COMONPTR)                                1145
         BE    @DC01145                                            1145
         ALR   @14,@15                                             1145
         CLI   W-1(@14),C'0'                                       1145
         BL    @DC01145                                            1145
         L     @14,WI                                              1145
         ALR   @15,@14                                             1145
         CLI   W-1(@15),C'9'                                       1145
         BH    @DC01145                                            1145
@DB01145 DS    0H                                                  1146
*       END;                        /*                       @ZA17843*/
         LA    @15,1                                               1146
         AL    @15,WI                                              1146
         ST    @15,WI                                              1146
@DE01145 L     @14,BUFBASE(,COMONPTR)                              1146
         LA    @07,4                                               1146
         AL    @07,FREEAMT(,COMONPTR)                              1146
         LCR   @07,@07                                             1146
         AH    @07,LL(,@14)                                        1146
         CR    @15,@07                                             1146
         BNH   @DL01145                                            1146
@DC01145 DS    0H                                                  1147
*       IF WI<=WLL-(F4+FREEAMT)&W(WI)^=BLANK&/* BUFFER END?  @ZA17843*/
*           W(WI)^=COMMA&W(WI)^=TAB&(OPCODE^=SETCODE×W(WI)^=EQUAL)&/**/
*           (WI=WLL-(F4+FREEAMT)×W(WI:WI+F1)^=OPENCMT) THEN/*      1147
*                                                            @ZA17843*/
         L     @15,WI                                              1147
         L     @14,WORDPTR                                         1147
         LA    @07,4                                               1147
         AL    @07,FREEAMT(,COMONPTR)                              1147
         LCR   @07,@07                                             1147
         AH    @07,WLL(,@14)                                       1147
         CR    @15,@07                                             1147
         BH    @RF01147                                            1147
         ALR   @15,@14                                             1147
         CLI   W-1(@15),C' '                                       1147
         BE    @RF01147                                            1147
         L     @15,WI                                              1147
         ALR   @15,@14                                             1147
         CLI   W-1(@15),C','                                       1147
         BE    @RF01147                                            1147
         L     @15,WI                                              1147
         ALR   @15,@14                                             1147
         CLI   W-1(@15),X'05'                                      1147
         BE    @RF01147                                            1147
         L     @01,OLDLINE(,COMONPTR)                              1147
         CLI   OPCODE(@01),13                                      1147
         BNE   @GL00100                                            1147
         L     @15,WI                                              1147
         ALR   @14,@15                                             1147
         CLI   W-1(@14),C'='                                       1147
         BE    @RF01147                                            1147
@GL00100 L     @15,WI                                              1147
         L     @14,WORDPTR                                         1147
         LA    @07,4                                               1147
         AL    @07,FREEAMT(,COMONPTR)                              1147
         LCR   @07,@07                                             1147
         AH    @07,WLL(,@14)                                       1147
         CR    @15,@07                                             1147
         BE    @RT01147                                            1147
         ALR   @14,@15                                             1147
         CLC   W-1(2,@14),@CC00628                                 1147
         BE    @RF01147                                            1147
@RT01147 DS    0H                                                  1148
*         ENDDLM=NO;                /* SET NOT VALID DELIMET @ZA17843*/
         NI    ENDDLM(COMONPTR),B'10111111'                        1148
*     END;                          /*                       @ZA17843*/
@RF01147 DS    0H                                                  1150
*   I=WI;                           /* RESTORE I             @ZA17843*/
@RF01143 L     @15,WI                                              1150
         ST    @15,I(,COMONPTR)                                    1150
*   LEN=I-BEGIN;                    /* GET LENGTH OF KYWWORD @ZA17843*/
         SL    @15,BEGIN(,COMONPTR)                                1151
         ST    @15,LEN(,COMONPTR)                                  1151
*   END FINDFILE;                   /*                       @ZA17843*/
@EL00031 DS    0H                                                  1152
@EF00031 DS    0H                                                  1152
@ER00031 LM    @14,@12,@SA00031                                    1152
         BR    @14                                                 1152
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR15F FIXED(31) REG(15),                                    1153
*     GPR01P PTR(31) REG(1);                                       1153
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1154
*     I031F FIXED(31) BASED,                                       1154
*     I031P PTR(31) BASED,                                         1154
*     I015F FIXED(15) BASED,                                       1154
*     I015P PTR(15) BASED,                                         1154
*     I008P PTR(8) BASED,                                          1154
*     I001C CHAR(1) BASED;                                         1154
*   END IKJCT433                                                   1155
*                                                                  1155
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */
*                                                                  1155
*       ;                                                          1155
@DATA    DS    0H
@SM01094 MVC   STFLUSH(0),STACKL
@SM01100 MVC   OUTCD(0),SVTDATA(@15)
@SM01102 MVC   0(0,@01),SVTDATA(@15)
@SM01104 MVC   0(0,@14),ANSWER(@01)
@SC01106 CLC   0(0,@06),C(@01)
@SC01109 CLC   NAME(0,@06),SNTDATA(@14)
@SM01111 MVC   SNTDATA(0,@07),NAME(@04)
@SC01113 CLC   SVTDATA(0,@15),OUTA1
         DS    0F
@AL00155 DC    A(@CC00645)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00208)
         DC    A(@CF00439)
@AL00411 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01048 DC    A(@CC00643)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00248)
         DC    A(@CF00439)
@AL01052 DC    A(@CC00641)             LIST WITH   3 ARGUMENT(S)
         DC    A(@CF00052)
         DC    A(@CF00439)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    6F
@SA00028 DS    15F
@SA00015 DS    15F
@SA00008 DS    18F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00014 DS    15F
@SA00016 DS    15F
@SA00030 DS    15F
@SA00026 DS    18F
@PC00026 DS    2F
@SA00021 DS    15F
@PC00021 DS    3F
@PC00024 DS    2F
@SA00031 DS    15F
@PC00007 DS    1F
@SA00025 DS    15F
@PC00005 DS    1F
@SA00027 DS    15F
@SA00004 DS    15F
@SA00003 DS    18F
@SA00011 DS    15F
@SA00020 DS    18F
@AL00001 DS    5A
@AFTEMPS DS    2F
IKJCT433 CSECT
         DS    0F
@CF00439 DC    F'0'
@CF00042 DC    F'1'
@CF00062 DC    F'2'
@CF00054 DC    F'3'
@CF00107 DC    F'4'
@CH00107 EQU   @CF00107+2
@CF00052 DC    F'5'
@CH00052 EQU   @CF00052+2
@CF00248 DC    F'6'
@CF00208 DC    F'7'
@CF00094 DC    F'8'
@CF00174 DC    F'10'
@CF00216 DC    F'12'
@CH00216 EQU   @CF00216+2
@CF00104 DC    F'16'
@CF00255 DC    F'20'
@CF00059 DC    F'31'
@CF00288 DC    F'57'
@CF00353 DC    F'200'
@CF00419 DC    F'220'
@CF00402 DC    F'249'
@CF00433 DC    F'252'
@CF00741 DC    F'300'
@CF00747 DC    F'312'
@CF00781 DC    F'900'
@CF00783 DC    F'904'
@CF00785 DC    F'908'
@CF00787 DC    F'912'
@CF00789 DC    F'916'
@CF00791 DC    F'920'
@CF00793 DC    F'924'
@CF00797 DC    F'932'
@CF00799 DC    F'936'
@CF00801 DC    F'940'
@CF00803 DC    F'944'
@CF00811 DC    F'960'
@CF00817 DC    F'999'
@CF00725 DC    F'4096'
@CF01096 DC    F'-10'
@CF01097 DC    F'-8'
@CF01099 DC    F'-6'
@CF00097 DC    XL4'80000000'
@CF00622 DC    XL4'40000000'
@DATD    DSECT
         DS    0D
ECTPTR   DS    A
WORDPTR  DS    A
SNTSAVE  DS    A
KPTR     DS    A
K        DS    A
UPTPTR   DS    A
INSRTDA  DS    A
RETURNCD DS    F
ERROR    DS    F
INDEX    DS    F
NEWLNG   DS    F
LEN1     DS    F
WI       DS    F
M        DS    F
N        DS    F
Z        DS    F
ERRSAV   DS    F
INSRTLN  DS    F
V1       DS    F
V2       DS    F
YEAR     DS    F
MONTH    DS    F
DAYS     DS    F
PCTR     DS    F
V        DS    F
SCANLIM  DS    F
HOWMUCH  DS    F
ECDACBLK DS    AL4
         ORG   ECDACBLK
@NM00003 DS    AL1
ECDACBK2 DS    AL3
         ORG   ECDACBLK+4
SNTABPTR DS    A
SVTABPTR DS    A
NDX      DS    F
@TS00001 DS    CL15
OUTA1    DS    CL17
AREA     DS    CL16
CSAVE    DS    CL2
         DS    CL2
WORKAREA DS    CL8
FRELST   DS    CL10
         ORG   FRELST
FRELST01 DS    AL1
FRELST02 DS    AL3
FRELST03 DS    AL1
FRELST04 DS    AL3
FRELST05 DS    BL1
FRELST06 DS    AL1
         ORG   FRELST+10
         DS    CL2
GETLST   DS    CL10
         ORG   GETLST
GETLST01 DS    AL4
GETLST02 DS    CL1
GETLST03 DS    AL3
GETLST04 DS    CL1
GETLST05 DS    AL1
         ORG   GETLST+10
         DS    CL2
MYSEG    DS    CL35
         ORG   MYSEG
@NM00001 DS    FL4
@NM00002 DS    CL26
OUTCD    DS    CL5
         ORG   MYSEG+35
TIMEDATE DS    CL8
         ORG   TIMEDATE
OUT1     DS    CL2
DELIM1   DS    CL1
OUT2     DS    CL2
DELIM2   DS    CL1
OUT3     DS    CL2
         ORG   TIMEDATE+8
         DS    CL1
OLD      DS    5A
OLD2     DS    3A
FREEADDR DS    2F
FREELEN  DS    2F
IKJCT433 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00098 DC    V(IKJCT434)
@CV00099 DC    V(IKJCT436)
@CV00100 DC    V(IKJEFT30)
@CV00101 DC    V(IKJEFT40)
@CA00229 DC    A(ALSO)
@CA00230 DC    A(MSTRLV2)
@CA00231 DC    A(MSGTABL)
@CV00102 DC    V(IKJEFT55)
         DS    0D
@CC00619 DC    C'0000000000000000'
@CC00645 DC    C'SYSSCAN'
@CC00643 DC    C'LASTCC'
@CC00641 DC    C'MAXCC'
@CC00727 DC    C'THEN'
@CC00628 DC    C'/*'
@CC00630 DC    C'*/'
@CC00632 DC    C'X='
@CC00662 DC    C'&&&&'
@CB00664 DC    X'1010'
CHR      DC    CL4'CHAR'
NUM      DC    CL3'NUM'
TRTABUP  DS    CL256
         ORG   TRTABUP
@NM00011 DC    AL1(64)
         DC    AL1(77)
         DC    AL1(93)
         DC    AL1(80)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(8)
         DC    AL1(9)
         DC    AL1(10)
         DC    AL1(11)
         DC    AL1(76)
         DC    AL1(77)
         DC    AL1(78)
         DC    AL1(79)
         DC    AL1(80)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(19)
         DC    AL1(20)
         DC    AL1(21)
         DC    AL1(22)
         DC    AL1(23)
         DC    AL1(24)
         DC    AL1(25)
         DC    AL1(26)
         DC    AL1(27)
         DC    AL1(92)
         DC    AL1(93)
         DC    AL1(30)
         DC    AL1(95)
         DC    AL1(96)
         DC    AL1(97)
         DC    AL1(34)
         DC    AL1(35)
         DC    AL1(36)
         DC    AL1(37)
         DC    AL1(38)
         DC    AL1(39)
         DC    AL1(40)
         DC    AL1(41)
         DC    AL1(42)
         DC    AL1(107)
         DC    AL1(44)
         DC    AL1(45)
         DC    AL1(110)
         DC    AL1(47)
         DC    AL1(48)
         DC    AL1(49)
         DC    AL1(50)
         DC    AL1(51)
         DC    AL1(52)
         DC    AL1(53)
         DC    AL1(54)
         DC    AL1(55)
         DC    AL1(56)
         DC    AL1(57)
         DC    AL1(58)
         DC    AL1(59)
         DC    AL1(60)
         DC    AL1(61)
         DC    AL1(126)
         DC    AL1(63)
         DC    AL1(64)
         DC    AL1(65)
         DC    AL1(66)
         DC    AL1(67)
         DC    AL1(68)
         DC    AL1(69)
         DC    AL1(70)
         DC    AL1(71)
         DC    AL1(72)
         DC    AL1(73)
         DC    AL1(74)
         DC    AL1(75)
         DC    AL1(76)
         DC    AL1(77)
         DC    AL1(78)
         DC    AL1(79)
         DC    AL1(80)
         DC    AL1(81)
         DC    AL1(82)
         DC    AL1(83)
         DC    AL1(84)
         DC    AL1(85)
         DC    AL1(86)
         DC    AL1(87)
         DC    AL1(88)
         DC    AL1(89)
         DC    AL1(90)
         DC    AL1(91)
         DC    AL1(92)
         DC    AL1(93)
         DC    AL1(94)
         DC    AL1(95)
         DC    AL1(96)
         DC    AL1(97)
         DC    AL1(98)
         DC    AL1(99)
         DC    AL1(100)
         DC    AL1(101)
         DC    AL1(102)
         DC    AL1(103)
         DC    AL1(104)
         DC    AL1(105)
         DC    AL1(106)
         DC    AL1(107)
         DC    AL1(108)
         DC    AL1(109)
         DC    AL1(110)
         DC    AL1(111)
         DC    AL1(112)
         DC    AL1(113)
         DC    AL1(114)
         DC    AL1(115)
         DC    AL1(116)
         DC    AL1(117)
         DC    AL1(118)
         DC    AL1(119)
         DC    AL1(120)
         DC    AL1(121)
         DC    AL1(122)
         DC    AL1(123)
         DC    AL1(124)
         DC    AL1(125)
         DC    AL1(126)
         DC    AL1(127)
         DC    AL1(128)
         DC    AL1(193)
         DC    AL1(194)
         DC    AL1(195)
         DC    AL1(196)
         DC    AL1(197)
         DC    AL1(198)
         DC    AL1(199)
         DC    AL1(200)
         DC    AL1(201)
         DC    AL1(138)
         DC    AL1(139)
         DC    AL1(140)
         DC    AL1(141)
         DC    AL1(142)
         DC    AL1(143)
         DC    AL1(144)
         DC    AL1(209)
         DC    AL1(210)
         DC    AL1(211)
         DC    AL1(212)
         DC    AL1(213)
         DC    AL1(214)
         DC    AL1(215)
         DC    AL1(216)
         DC    AL1(217)
         DC    AL1(154)
         DC    AL1(155)
         DC    AL1(156)
         DC    AL1(157)
         DC    AL1(158)
         DC    AL1(159)
         DC    AL1(160)
         DC    AL1(161)
         DC    AL1(226)
         DC    AL1(227)
         DC    AL1(228)
         DC    AL1(229)
         DC    AL1(230)
         DC    AL1(231)
         DC    AL1(232)
         DC    AL1(233)
         DC    AL1(170)
         DC    AL1(171)
         DC    AL1(172)
         DC    AL1(173)
         DC    AL1(174)
         DC    AL1(175)
         DC    AL1(240)
         DC    AL1(241)
         DC    AL1(242)
         DC    AL1(243)
         DC    AL1(244)
         DC    AL1(245)
         DC    AL1(246)
         DC    AL1(247)
         DC    AL1(248)
         DC    AL1(249)
         DC    AL1(186)
         DC    AL1(187)
         DC    AL1(188)
         DC    AL1(189)
         DC    AL1(190)
         DC    AL1(191)
         DC    AL1(192)
         DC    AL1(193)
         DC    AL1(194)
         DC    AL1(195)
         DC    AL1(196)
         DC    AL1(197)
         DC    AL1(198)
         DC    AL1(199)
         DC    AL1(200)
         DC    AL1(201)
         DC    AL1(202)
         DC    AL1(203)
         DC    AL1(204)
         DC    AL1(205)
         DC    AL1(206)
         DC    AL1(207)
         DC    AL1(208)
         DC    AL1(209)
         DC    AL1(210)
         DC    AL1(211)
         DC    AL1(212)
         DC    AL1(213)
         DC    AL1(214)
         DC    AL1(215)
         DC    AL1(216)
         DC    AL1(217)
         DC    AL1(218)
         DC    AL1(219)
         DC    AL1(220)
         DC    AL1(221)
         DC    AL1(222)
         DC    AL1(223)
         DC    AL1(224)
         DC    AL1(225)
         DC    AL1(226)
         DC    AL1(227)
         DC    AL1(228)
         DC    AL1(229)
         DC    AL1(230)
         DC    AL1(231)
         DC    AL1(232)
         DC    AL1(233)
         DC    AL1(234)
         DC    AL1(235)
         DC    AL1(236)
         DC    AL1(237)
         DC    AL1(238)
         DC    AL1(239)
         DC    AL1(240)
         DC    AL1(241)
         DC    AL1(242)
         DC    AL1(243)
         DC    AL1(244)
         DC    AL1(245)
         DC    AL1(246)
         DC    AL1(247)
         DC    AL1(248)
         DC    AL1(249)
         DC    AL1(250)
         DC    AL1(251)
         DC    AL1(252)
         DC    AL1(253)
         DC    AL1(254)
         DC    AL1(255)
         ORG   TRTABUP+256
TRTABDN  DS    CL256
         ORG   TRTABDN
@NM00012 DC    AL1(0)
         DC    AL1(1)
         DC    AL1(2)
         DC    AL1(3)
         DC    AL1(4)
         DC    AL1(5)
         DC    AL1(6)
         DC    AL1(7)
         DC    AL1(8)
         DC    AL1(9)
         DC    AL1(10)
         DC    AL1(11)
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(14)
         DC    AL1(15)
         DC    AL1(16)
         DC    AL1(17)
         DC    AL1(18)
         DC    AL1(19)
         DC    AL1(20)
         DC    AL1(21)
         DC    AL1(22)
         DC    AL1(23)
         DC    AL1(24)
         DC    AL1(25)
         DC    AL1(26)
         DC    AL1(27)
         DC    AL1(28)
         DC    AL1(29)
         DC    AL1(30)
         DC    AL1(31)
         DC    AL1(32)
         DC    AL1(33)
         DC    AL1(34)
         DC    AL1(35)
         DC    AL1(36)
         DC    AL1(37)
         DC    AL1(38)
         DC    AL1(39)
         DC    AL1(40)
         DC    AL1(41)
         DC    AL1(42)
         DC    AL1(43)
         DC    AL1(44)
         DC    AL1(45)
         DC    AL1(46)
         DC    AL1(47)
         DC    AL1(48)
         DC    AL1(49)
         DC    AL1(50)
         DC    AL1(51)
         DC    AL1(52)
         DC    AL1(53)
         DC    AL1(54)
         DC    AL1(55)
         DC    AL1(56)
         DC    AL1(57)
         DC    AL1(58)
         DC    AL1(59)
         DC    AL1(60)
         DC    AL1(61)
         DC    AL1(62)
         DC    AL1(63)
         DC    AL1(0)
         DC    AL1(65)
         DC    AL1(66)
         DC    AL1(67)
         DC    AL1(68)
         DC    AL1(69)
         DC    AL1(70)
         DC    AL1(71)
         DC    AL1(72)
         DC    AL1(73)
         DC    AL1(74)
         DC    AL1(75)
         DC    AL1(12)
         DC    AL1(13)
         DC    AL1(14)
         DC    AL1(15)
         DC    AL1(16)
         DC    AL1(81)
         DC    AL1(82)
         DC    AL1(83)
         DC    AL1(84)
         DC    AL1(85)
         DC    AL1(86)
         DC    AL1(87)
         DC    AL1(88)
         DC    AL1(89)
         DC    AL1(90)
         DC    AL1(91)
         DC    AL1(28)
         DC    AL1(29)
         DC    AL1(94)
         DC    AL1(31)
         DC    AL1(32)
         DC    AL1(33)
         DC    AL1(98)
         DC    AL1(99)
         DC    AL1(100)
         DC    AL1(101)
         DC    AL1(102)
         DC    AL1(103)
         DC    AL1(104)
         DC    AL1(105)
         DC    AL1(106)
         DC    AL1(43)
         DC    AL1(108)
         DC    AL1(109)
         DC    AL1(46)
         DC    AL1(111)
         DC    AL1(112)
         DC    AL1(113)
         DC    AL1(114)
         DC    AL1(115)
         DC    AL1(116)
         DC    AL1(117)
         DC    AL1(118)
         DC    AL1(119)
         DC    AL1(120)
         DC    AL1(121)
         DC    AL1(122)
         DC    AL1(123)
         DC    AL1(124)
         DC    AL1(125)
         DC    AL1(62)
         DC    AL1(127)
         DC    AL1(128)
         DC    AL1(129)
         DC    AL1(130)
         DC    AL1(131)
         DC    AL1(132)
         DC    AL1(133)
         DC    AL1(134)
         DC    AL1(135)
         DC    AL1(136)
         DC    AL1(137)
         DC    AL1(138)
         DC    AL1(139)
         DC    AL1(140)
         DC    AL1(141)
         DC    AL1(142)
         DC    AL1(143)
         DC    AL1(144)
         DC    AL1(145)
         DC    AL1(146)
         DC    AL1(147)
         DC    AL1(148)
         DC    AL1(149)
         DC    AL1(150)
         DC    AL1(151)
         DC    AL1(152)
         DC    AL1(153)
         DC    AL1(154)
         DC    AL1(155)
         DC    AL1(156)
         DC    AL1(157)
         DC    AL1(158)
         DC    AL1(159)
         DC    AL1(160)
         DC    AL1(161)
         DC    AL1(162)
         DC    AL1(163)
         DC    AL1(164)
         DC    AL1(165)
         DC    AL1(166)
         DC    AL1(167)
         DC    AL1(168)
         DC    AL1(169)
         DC    AL1(170)
         DC    AL1(171)
         DC    AL1(172)
         DC    AL1(173)
         DC    AL1(174)
         DC    AL1(175)
         DC    AL1(176)
         DC    AL1(177)
         DC    AL1(178)
         DC    AL1(179)
         DC    AL1(180)
         DC    AL1(181)
         DC    AL1(182)
         DC    AL1(183)
         DC    AL1(184)
         DC    AL1(185)
         DC    AL1(186)
         DC    AL1(187)
         DC    AL1(188)
         DC    AL1(189)
         DC    AL1(190)
         DC    AL1(191)
         DC    AL1(192)
         DC    AL1(129)
         DC    AL1(130)
         DC    AL1(131)
         DC    AL1(132)
         DC    AL1(133)
         DC    AL1(134)
         DC    AL1(135)
         DC    AL1(136)
         DC    AL1(137)
         DC    AL1(202)
         DC    AL1(203)
         DC    AL1(204)
         DC    AL1(205)
         DC    AL1(206)
         DC    AL1(207)
         DC    AL1(208)
         DC    AL1(145)
         DC    AL1(146)
         DC    AL1(147)
         DC    AL1(148)
         DC    AL1(149)
         DC    AL1(150)
         DC    AL1(151)
         DC    AL1(152)
         DC    AL1(153)
         DC    AL1(218)
         DC    AL1(219)
         DC    AL1(220)
         DC    AL1(221)
         DC    AL1(222)
         DC    AL1(223)
         DC    AL1(224)
         DC    AL1(225)
         DC    AL1(162)
         DC    AL1(163)
         DC    AL1(164)
         DC    AL1(165)
         DC    AL1(166)
         DC    AL1(167)
         DC    AL1(168)
         DC    AL1(169)
         DC    AL1(234)
         DC    AL1(235)
         DC    AL1(236)
         DC    AL1(237)
         DC    AL1(238)
         DC    AL1(239)
         DC    AL1(176)
         DC    AL1(177)
         DC    AL1(178)
         DC    AL1(179)
         DC    AL1(180)
         DC    AL1(181)
         DC    AL1(182)
         DC    AL1(183)
         DC    AL1(184)
         DC    AL1(185)
         DC    AL1(250)
         DC    AL1(251)
         DC    AL1(252)
         DC    AL1(253)
         DC    AL1(254)
         DC    AL1(255)
         ORG   TRTABDN+256
         DS    CL1
@NM00007 DS    CL16
         ORG   @NM00007+0
IMMLEN   DC    AL2(3)
IMMDATA  DC    CL10'STR'
VECTOR   DC    AL4(STRRTN)
         ORG   @NM00007+16
         ORG   @NM00007+16
         DC    AL2(4)
         DC    CL10'EVAL'
         DC    AL4(EVALRTN)
         ORG   @NM00007+32
         ORG   @NM00007+32
         DC    AL2(6)
         DC    CL10'SUBSTR'
         DC    AL4(SUBSTRTN)
         ORG   @NM00007+48
         ORG   @NM00007+48
         DC    AL2(7)
         DC    CL10'SYSTIME'
         DC    AL4(TIMERTN)
         ORG   @NM00007+64
         ORG   @NM00007+64
         DC    AL2(7)
         DC    CL10'SYSDATE'
         DC    AL4(DATERTN)
         ORG   @NM00007+80
         ORG   @NM00007+80
         DC    AL2(6)
         DC    CL10'LENGTH'
         DC    AL4(LENGRTN)
         ORG   @NM00007+96
         ORG   @NM00007+96
         DC    AL2(8)
         DC    CL10'DATATYPE'
         DC    AL4(DATYRTN)
         ORG   @NM00007+112
         ORG   @NM00007+112
         DC    AL2(7)
         DC    CL10'SYSPREF'
         DC    AL4(PREFRTN)
         ORG   @NM00007+128
         ORG   @NM00007+128
         DC    AL2(7)
         DC    CL10'SYSPCMD'
         DC    AL4(SYSPRTN)
         ORG   @NM00007+144
         ORG   @NM00007+144
         DC    AL2(7)
         DC    CL10'SYSSCMD'
         DC    AL4(SYSSRTN)
         ORG   @NM00007+160
DAYIN    DC    H'31'
         DC    H'28'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'31'
         DC    H'30'
         DC    H'31'
         DC    H'30'
         DC    H'31'
ROUTINES DC    AL4(FINDWORD)
         DC    AL4(SCANWORD)
         DC    AL4(SKIPSEPS)
         DC    AL4(PRINT)
         DC    AL4(LOCATE)
         DC    AL4(GLOCATE)
         DC    AL4(CONVERT)
         DC    AL4(UPDATE)
         DC    AL4(FINDFILE)
IKJCT433 CSECT
STACKL   STACK   DELETE=ALL,MF=L
         PUTLINE MF=L
         PUTLINE MF=L
         STAX    DEFER=NO,MF=L
         STAX    DEFER=YES,MF=L
MACLEN DC A(MACLEN-STACKL)
@DATD    DSECT
STFLUSH  STACK   DELETE=ALL,MF=L
PLBLK    PUTLINE MF=L
PUTMLVL  PUTLINE MF=L
DEFERNO  STAX    DEFER=NO,MF=L
DEFERYES STAX    DEFER=YES,MF=L
IKJCT433 CSECT
         DS   0H
PATCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT433 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R12      EQU   @12
R11      EQU   @11
R10      EQU   @10
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R9       EQU   @09
R15      EQU   @15
COMONPTR EQU   @08
GPR01P   EQU   @01
GPR15F   EQU   @15
         ENTRY ROUTINES
         ENTRY TRTABUP
         EXTRN ALSO
         EXTRN MSTRLV2
         EXTRN MSGTABL
INSRTCHR EQU   0
ANSWER   EQU   0
BUF      EQU   0
ROUTINE  EQU   0
@NM00005 EQU   0
WLL      EQU   @NM00005
W        EQU   @NM00005+4
UPVAL    EQU   0
LCVAL    EQU   0
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTPREFX EQU   UPT+16
UPTPREFL EQU   UPT+23
ECT      EQU   0
ECTRCDF  EQU   ECT
ECTRTCD  EQU   ECT+1
ECTIOWA  EQU   ECT+4
ECTPCMD  EQU   ECT+12
ECTSCMD  EQU   ECT+20
ECTSWS   EQU   ECT+28
ECTATTN  EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
LSD      EQU   0
LSDADATA EQU   LSD
LSDANEXT EQU   LSD+8
LSDEXEC  EQU   LSD+12
EXECDATA EQU   0
SNTABFST EQU   EXECDATA
SVTABFST EQU   EXECDATA+4
GEXECDAT EQU   EXECDATA+8
LASTTSO  EQU   EXECDATA+12
@NM00022 EQU   EXECDATA+16
ERACTSTR EQU   EXECDATA+20
ERACTEND EQU   EXECDATA+24
RETPTR   EQU   EXECDATA+28
EXDATFLG EQU   EXECDATA+32
@NM00023 EQU   EXDATFLG
CONLST   EQU   @NM00023
ERRCMD   EQU   @NM00023
NOFLUSH  EQU   @NM00023
SYMLST   EQU   @NM00023
ERINCNTL EQU   @NM00023
CMAIN    EQU   @NM00023
NOMSG    EQU   @NM00023
ATINCNTL EQU   @NM00023+1
NOLASTCC EQU   @NM00023+1
ATACTSTR EQU   EXECDATA+44
ATACTEND EQU   EXECDATA+48
RETPTR2  EQU   EXECDATA+52
COMPROC  EQU   0
COMPRPTR EQU   COMPROC
COMPRID  EQU   COMPRPTR
COMPRNXT EQU   COMPRPTR+1
COMPRLNG EQU   COMPROC+4
SNTAB    EQU   0
SNTABNXT EQU   SNTAB
SNTABLNG EQU   SNTAB+4
SNTABUSE EQU   SNTAB+8
SNTELFST EQU   SNTAB+12
SNTELEM  EQU   0
SNTVLPTR EQU   SNTELEM
SNTGVAL  EQU   SNTVLPTR
SNTFLAGS EQU   SNTELEM+4
SNTKEYW  EQU   SNTFLAGS
SNTLABEL EQU   SNTFLAGS
SNTNOSCN EQU   SNTFLAGS
SNTNAUTH EQU   SNTFLAGS
SNTEVAL  EQU   SNTFLAGS
SNTLAST  EQU   SNTFLAGS
SNTGLOB  EQU   SNTFLAGS+1
SNTLNG   EQU   SNTELEM+6
SNTDATA  EQU   SNTELEM+8
SVTAB    EQU   0
SVTABNXT EQU   SVTAB
SVTABLNG EQU   SVTAB+4
SVTABUSE EQU   SVTAB+8
SVTABFRE EQU   SVTAB+12
SVTELFST EQU   SVTAB+16
SVTELEM  EQU   0
SVTLNG   EQU   SVTELEM
SVTORIG  EQU   SVTELEM+2
SVTDATA  EQU   SVTELEM+4
@NM00026 EQU   0
LL       EQU   @NM00026
OO       EQU   @NM00026+2
O2       EQU   @NM00026+4
C        EQU   O2
@NM00027 EQU   0
NEWLL    EQU   @NM00027
NEWOO    EQU   @NM00027+2
NEWC     EQU   @NM00027+4
@NM00029 EQU   0
INSCODE  EQU   @NM00029
INSLIST  EQU   INSCODE
INSADLSD EQU   @NM00029+1
@NM00032 EQU   0
IOSTELM  EQU   @NM00032
@NM00034 EQU   0
OPCODE   EQU   @NM00034+6
COMAREA  EQU   0
@NM00040 EQU   COMAREA
IOPL     EQU   @NM00040
BUFPTR   EQU   @NM00040+16
SNTELPTR EQU   @NM00040+20
EXECDPTR EQU   @NM00040+24
OLDLINE  EQU   @NM00040+28
BUFBASE  EQU   @NM00040+32
NEWBASE  EQU   @NM00040+36
LSDPTR   EQU   @NM00040+40
TYPE     EQU   @NM00040+44
CNVTANS  EQU   @NM00040+48
CLEN     EQU   @NM00040+52
MYO2     EQU   @NM00040+56
BEGIN    EQU   @NM00040+60
I        EQU   @NM00040+64
LEN      EQU   @NM00040+68
FREEAMT  EQU   @NM00040+72
ERCOM    EQU   @NM00040+76
REGAREA  EQU   @NM00040+80
SWSAREA  EQU   @NM00040+112
SW2AREA  EQU   @NM00040+117
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
MSGDIM   EQU   MSGTABL
@NM00009 EQU   MSGTABL+2
IDA      EQU   @NM00009
IDC      EQU   @NM00009+2
@NM00010 EQU   @NM00009+4
SECLEVEL EQU   @NM00010
MSGSEG1  EQU   @NM00009+5
SEGNUM   EQU   @NM00009+8
MSGSEG2  EQU   @NM00009+9
UPTX     EQU   0
ECTX     EQU   0
ECB      EQU   0
ECBCBIT  EQU   ECB
GTPB     EQU   0
GTPBLINE EQU   GTPB+4
PARM433  EQU   0
@NM00036 EQU   PARM433
PARMDEFR EQU   @NM00036
EOCLIST  EQU   @NM00036
UPLIST   EQU   0
LCVALPTR EQU   UPLIST
LCVALLEN EQU   UPLIST+4
UPVALPTR EQU   UPLIST+8
UPVALLEN EQU   UPLIST+12
MINIMUM  EQU   0
NEXTCMD  EQU   0
NAME     EQU   0
NAML     EQU   0
FUNC     EQU   0
VALUE    EQU   0
VALLEN   EQU   0
LINEADDR EQU   0
TERMPUT  EQU   0
OUTFX    EQU   OUTA1
NULELEM  EQU   SVTELFST
ANSPTR   EQU   TYPE
@NM00004 EQU   LSDANEXT
CURID    EQU   @NM00004
CURADDR  EQU   @NM00004+1
@NM00008 EQU   AREA
TEMPA    EQU   @NM00008
TIMEOUT  EQU   @NM00008+4
HRS      EQU   TIMEOUT
MINUTES  EQU   TIMEOUT+2
SEC      EQU   TIMEOUT+4
DATEOUT  EQU   TIMEOUT
YR       EQU   DATEOUT
DYS      EQU   DATEOUT+2
SWS      EQU   SWSAREA
EXITA    EQU   SWS
EXITB    EQU   SWS
FREESW   EQU   SWS
WAIT     EQU   SWS
RANGE    EQU   SWS
LEAP     EQU   SWS
ALPHA    EQU   SWS
EXITC    EQU   SWS
SEPS     EQU   SWS+1
ENDDLM   EQU   SWS+1
QUIT     EQU   SWS+1
MATCH    EQU   SWS+1
SYSUPDTE EQU   SWS+1
NOAMPER  EQU   SWS+1
INSTHEN  EQU   SWS+1
SENTINAL EQU   SWS+2
LISTONLY EQU   SWS+2
FOLD     EQU   SWS+2
LISTED   EQU   SWS+2
ERRRANGE EQU   SWS+2
ATRANGE  EQU   SWS+2
BACKUP   EQU   SWS+2
RCABEND  EQU   SWS+3
NODATA   EQU   SWS+3
SW2      EQU   SW2AREA
CORE     EQU   SW2
CONTINU  EQU   SW2
RECURSE  EQU   SW2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
STABND   EQU   SWS+3
STAECNTL EQU   SWS+3
SKIP1    EQU   SWS+2
SKPCOMMA EQU   SWS+1
SUSPENDI EQU   PARM433+4
@NM00038 EQU   @NM00036+1
@NM00037 EQU   @NM00036
EXITSTMT EQU   @NM00036
@NM00028 EQU   GTPB
@NM00039 EQU   ECB
DYNAREA  EQU   COMAREA+300
SYNREGS  EQU   @NM00040+182
STAEREGS EQU   @NM00040+118
REGAREA2 EQU   @NM00040+96
@NM00041 EQU   @NM00040+54
FLSEPATH EQU   @NM00034+7
@NM00035 EQU   @NM00034
@NM00033 EQU   @NM00032+4
@NM00031 EQU   INSCODE
INSPROM  EQU   INSCODE
INSEXEC  EQU   INSCODE
@NM00030 EQU   INSCODE
INSTERM  EQU   INSCODE
@NM00025 EQU   SNTFLAGS+1
SNTKEY   EQU   SNTFLAGS
SNTPOSIT EQU   SNTFLAGS
COMRCDS  EQU   COMPROC+12
COMPRUSE EQU   COMPROC+8
@NM00024 EQU   EXECDATA+60
FILEDCBS EQU   EXECDATA+56
EXDLMPTR EQU   EXECDATA+40
GEXECCNT EQU   EXECDATA+36
ATTNCMD  EQU   @NM00023
EXINSAVE EQU   @NM00022
LSDTOTLN EQU   LSD+6
LSDRCLEN EQU   LSD+4
@NM00021 EQU   ECT+52
@NM00020 EQU   ECT+48
@NM00019 EQU   ECT+44
@NM00018 EQU   ECTSWS2+1
@NM00017 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00016 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
@NM00015 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
@NM00014 EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00013 EQU   UPT
@NM00006 EQU   @NM00005+2
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00148 EQU   FASTEXIT
@RF00162 EQU   @RC00156
@RC00181 EQU   @RC00174
@RC00255 EQU   @RC00254
@RC00289 EQU   @RC00282
@RC00283 EQU   @RC00282
@RF00412 EQU   @RC00404
@RC00415 EQU   @RC00404
@RF00440 EQU   @EL00004
@RC00459 EQU   @EL00004
@RC00536 EQU   @EL00005
@RF00565 EQU   @EL00008
@RF00580 EQU   @EL00008
@RF00590 EQU   @EL00008
@RC00618 EQU   @EL00008
@RF00617 EQU   @EL00008
@RF00651 EQU   @RC00648
@RF00659 EQU   @RC00656
@RF00668 EQU   @EL00009
@RC00699 EQU   @EL00011
@RF00753 EQU   @EL00014
@RF00768 EQU   @EL00015
@RF00778 EQU   @EL00016
@RF00813 EQU   @EL00020
@RC00839 EQU   @RC00838
@RC00873 EQU   @RC00860
@RF00886 EQU   @EL00022
@PB00022 EQU   @EL00021
@RC00909 EQU   @RC00908
@RC00976 EQU   @RC00975
@RC01020 EQU   @EL00025
@RF01056 EQU   @EL00025
@RF01078 EQU   @EL00027
@RC01080 EQU   @EL00027
@RF01093 EQU   @EL00028
@RC01110 EQU   @RC01109
@RF00464 EQU   @RC00459
@RC00490 EQU   @RC00459
@RC00840 EQU   @RC00839
@ENDDATA EQU   *
         END   IKJCT433,(C'PLS1154',0701,77215)

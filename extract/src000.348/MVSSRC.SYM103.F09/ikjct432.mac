         TITLE 'IKJCT432 - EXEC RECORD SCAN ROUTINE                    *
                        '
IKJCT432 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJCT432  77.215'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @09,0                                               0001
@PSTART  LA    @10,4095(,@09)                                      0001
         LA    @11,4095(,@10)                                      0001
         USING @PSTART,@09                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@11                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @12,8(,@13)                                         0001
         LR    @13,@12                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   PARMPTR=R1;                     /* ADDR OF 432 PARM LIST         */
         LR    PARMPTR,R1                                          0084
*   RFY                                                            0085
*    (R1) UNRSTD;                   /* RELEASE R1                    */
*   STMT=OFF;                       /* RESET STMT SWITCH             */
         NI    STMT,B'01111111'                                    0086
*   ECDAPTR=ECDAPTR2;               /* POINTER TO ECDA               */
         L     ECDAPTR,ECDAPTR2(,PARMPTR)                          0087
*   RLENGTH=ECDAIREC->RECLEN-FOUR;  /* REMOVE LL LENGTH              */
         L     @14,ECDAIREC(,ECDAPTR)                              0088
         LH    @14,RECLEN(,@14)                                    0088
         SL    @14,@CF00072                                        0088
         ST    @14,RLENGTH                                         0088
*   OC=ZERO;                        /* ZERO OUT OPCODE               */
         L     @14,ECDACNXT(,ECDAPTR)                              0089
         MVI   OC(@14),X'00'                                       0089
*   CALL CMDSCAN;                   /* CALL COMMAND SCAN ROUTINE TO
*                                      CHECK INPUT RECORD            */
         BAL   @14,CMDSCAN                                         0090
*   IF LABLADD=ZERO THEN            /* IF NO LABEL                   */
         L     @14,LABLADD                                         0091
         LTR   @14,@14                                             0091
         BZ    @RT00091                                            0091
*     GOTO CMDCHKS;                 /* ELSE GO CHECK COMMAND NAME    */
*                                                                  0092
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LABEL IS SYNTATICALLY CORRECT. CALL THE SYMBOLIC NAME     */
*   /* TABLE ROUTINE TO ADD THE LABEL TO THE TABLE.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0093
*   PARMADR=LABLADD;                /* ADDRESS OF THE LABEL          */
         ST    @14,PARMADR                                         0093
*   PARMLNG=LABLLEN;                /* LENGTH OF LABEL               */
         L     @14,LABLLEN                                         0094
         ST    @14,PARMLNG                                         0094
*   PARMTYPE=LABL;                  /* INDICATE IT IS A LABEL        */
         MVC   PARMTYPE(2),@CH00033                                0095
*   CALL SYNTAB(NTUPTPRM);          /* CALL SYNTAB                   */
         LA    @14,NTUPTPRM                                        0096
         ST    @14,@AL00001                                        0096
         LA    @01,@AL00001                                        0096
         BAL   @14,SYNTAB                                          0096
*   IF R15^=ZERO THEN               /* IF SYNTAB ROUTINE FAILED      */
         LTR   R15,R15                                             0097
         BNZ   @RT00097                                            0097
*     GO TO SPCLEXIT;               /* THEN RETURN TO THE CALLER     */
*CMDCHKS:                                                          0099
*   IF CMDADD=ZERO THEN             /* NEXT CHECK RECORD FOR A       */
CMDCHKS  SLR   @14,@14                                             0099
         C     @14,CMDADD                                          0099
         BNE   @RF00099                                            0099
*     DO;                           /* COMMAND NAME -IF NOT FOUND    */
*       IF LABLADD^=ZERO THEN       /* AND THERE WAS A LABEL,        */
         L     @06,LABLADD                                         0101
         CR    @06,@14                                             0101
         BE    @RF00101                                            0101
*         DO;                                                      0102
*           EXMSGID=M532;           /* THEN ISSUE MESSAGE            */
         MVC   EXMSGID(4),@CC00491                                 0103
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0104
*           MVAR(2)=LABLADD;        /* LABEL WILL APPEAR IN MESSAGE  */
         ST    @06,MVAR+4                                          0105
*           MVARLEN(2)=LABLLEN;     /* VARIABLE LENGTH               */
         L     @14,LABLLEN                                         0106
         STC   @14,MVARLEN+4                                       0106
*           STMT=ONS;               /* STATEMENT NUMBER REQUESTED    */
         OI    STMT,B'10000000'                                    0107
*           CALL MSGRTN;            /* ISSUE MESSAGE                 */
         BAL   @14,MSGRTN                                          0108
*         END;                                                     0109
*       R15=ZERO;                   /* SET THE RC = 0                */
@RF00101 SLR   R15,R15                                             0110
*       NULLINE=ONS;                /* SET THE NULL LINE FLAG      0111
*                                                            @ZA05505*/
         OI    NULLINE(PARMPTR),B'00001000'                        0111
*       GO TO SPCLEXIT;             /* RETURN AS LINE WAS NULL       */
         B     SPCLEXIT                                            0112
*     END;                                                         0113
*   OC=ZERO;                        /* ZERO OUT OPCODE FIELD         */
@RF00099 L     @14,ECDACNXT(,ECDAPTR)                              0114
         MVI   OC(@14),X'00'                                       0114
*   IF TSODISG=ON THEN              /* IF IT IS A TSO COMMAND IN     */
         TM    TSODISG,B'00100000'                                 0115
         BO    @RT00115                                            0115
*     GOTO TSOCALL;                 /* DISGUISE (%,&) THEN BRANCH    */
*                                                                  0116
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT USE THEN LENGTH OF THE COMMAND NAME TO BRANCH TO THE     */
*   /* PROPER CALLING ROUTINES. A LENGTH OF GREATER THAN 8 ON A      */
*   /* RECORD WITH A LABEL WILL RESULT IN AN ERROR--IF THERE IS NO   */
*   /* LABEL THEN ASSUME IT IS A TSO COMMAND A COMMAND WITH A LENGTH */
*   /* OF 1 TO 4 MAY BE AN ALTERNATE END. IF IT IS THEN GIVE CONTROL */
*   /* TO THE END ROUTINE                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0117
*   IF CMDLEN=ECDAELNG THEN         /* NO---                         */
         LH    @14,ECDAELNG(,ECDAPTR)                              0117
         C     @14,CMDLEN                                          0117
         BNE   @RF00117                                            0117
*     IF COMMAND(1:CMDLEN)=         /*                               */
*         ECDAAEND(1:ECDAELNG) THEN /* YES--CALL END ROUTINE.        */
         BCTR  @14,0                                               0118
         L     @06,CMDADD                                          0118
         EX    @14,@SC00853                                        0118
         BNE   @RF00118                                            0118
*       CALL ENDCMD;                /* CALL END                      */
*                                                                  0119
         BAL   @14,ENDCMD                                          0119
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COMMAND WAS NOT AN END OR ALTERNATE END THEN BRANCH TO     */
*   /* PROPER CALL ROUTINES WHICH WILL PASS CONTROL TO PROPER COMMAND*/
*   /* ROUTINES. A LENGTH OF 1 IS ASSUMED TO BE TSO                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0120
*   GOTO ROUTINE;                   /* BRANCH TO PROPER ROUTINE      */
*                                                                  0120
@RF00118 DS    0H                                                  0120
@RF00117 L     @14,CMDLEN                                          0120
         SLA   @14,2                                               0120
         L     @14,ROUTE-4(@14)                                    0120
         BR    @14                                                 0120
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING ARE THE CALLING ROUTINES ENTERED ACCORDING TO   */
*   /* THE LENGTH OF THE COMMAND LENGTH OF 2 WILL BE IF,DO OR TSO    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0121
*LENGTH2:                                                          0121
*   IF COMMAND(1:TWO)=CIF THEN      /* IF ?                          */
LENGTH2  L     @14,CMDADD                                          0121
         CLC   COMMAND(2,@14),@CC00527                             0121
         BNE   @RF00121                                            0121
*     CALL IFCMD;                   /* IF                            */
         BAL   @14,IFCMD                                           0122
*   IF COMMAND(1:TWO)=DOO THEN      /* DO COMMAND?                   */
@RF00121 L     @14,CMDADD                                          0123
         CLC   COMMAND(2,@14),@CC00412                             0123
         BNE   @RF00123                                            0123
*     CALL DOCMD;                   /* YES                           */
         BAL   @14,DOCMD                                           0124
*TSOCALL:                                                          0125
*   CALL COMCMD;                    /* NO---TSO                      */
@RF00123 DS    0H                                                  0125
TSOCALL  BAL   @14,COMCMD                                          0125
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
*                                                                  0126
         B     COMNEXIT                                            0126
*   /*****************************************************************/
*   /*                                                               */
*   /* LENGTH OF 3 WILL BE SET COMMAND OR TSO. END WAS CHECKED       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0127
*LENGTH3:                                                          0127
*   IF COMMAND(1:THREE)=SET THEN    /* SET?                          */
LENGTH3  L     @14,CMDADD                                          0127
         CLC   COMMAND(3,@14),@CC00539                             0127
         BNE   @RF00127                                            0127
*     CALL SETCMD;                  /* SET COMMAND                   */
         BAL   @14,SETCMD                                          0128
*   CALL COMCMD;                    /* TSO                           */
@RF00127 BAL   @14,COMCMD                                          0129
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
*                                                                  0130
         B     COMNEXIT                                            0130
*   /*****************************************************************/
*   /*                                                               */
*   /* LENGTH OF 4 WILL BE GOTO,ELSE,READ,EXIT,SETC,DATA OR TSO      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0131
*LENGTH4:                                                          0131
*   IF COMMAND(1:FOUR)=GOTOS THEN   /* GOTO ?                        */
LENGTH4  L     @14,CMDADD                                          0131
         CLC   COMMAND(4,@14),@CC00541                             0131
         BNE   @RF00131                                            0131
*     DO;                           /* GOTO COMMAND                  */
*       OC=OPONE;                   /* GOTO OPCODE = 01              */
         L     @14,ECDACNXT(,ECDAPTR)                              0133
         MVI   OC(@14),X'01'                                       0133
*       CALL COMCMD;                /* GOTO                          */
         BAL   @14,COMCMD                                          0134
*       GOTO COMNEXIT;              /* CALL COMMON EXIT              */
         B     COMNEXIT                                            0135
*     END;                                                         0136
*   IF COMMAND(1:FOUR)=CELSE THEN   /* ELSE ?                        */
@RF00131 L     @14,CMDADD                                          0137
         CLC   COMMAND(4,@14),@CC00529                             0137
         BNE   @RF00137                                            0137
*     CALL ELSECMD;                 /* ELSE                          */
         BAL   @14,ELSECMD                                         0138
*   IF COMMAND(1:FOUR)=READS THEN   /* READ ?                        */
@RF00137 L     @14,CMDADD                                          0139
         CLC   COMMAND(4,@14),@CC00545                             0139
         BNE   @RF00139                                            0139
*     DO;                           /*                               */
*       CALL READCMD;               /* READ                          */
         BAL   @14,READCMD                                         0141
*       GO TO SPCLEXIT;             /* GO TO SPCLEXIT                */
         B     SPCLEXIT                                            0142
*     END;                                                         0143
*   IF COMMAND(1:FOUR)=ATTN THEN    /* ATTN ?                        */
@RF00139 L     @14,CMDADD                                          0144
         CLC   COMMAND(4,@14),@CC00416                             0144
         BNE   @RF00144                                            0144
*     DO;                           /* ATTENTION CMD                 */
*       OC=OPATTN;                  /* SET OP CODE                   */
         L     @14,ECDACNXT(,ECDAPTR)                              0146
         MVI   OC(@14),X'11'                                       0146
*       CALL ERRORCMD;              /* ATTN USES ERROR CMD PROCESS   */
         BAL   @14,ERRORCMD                                        0147
*     END;                                                         0148
*   IF COMMAND(1:FOUR)=CDATA THEN   /* DATA ?                        */
@RF00144 L     @14,CMDADD                                          0149
         CLC   COMMAND(4,@14),@CC00533                             0149
         BNE   @RF00149                                            0149
*     CALL DATACMD;                 /* DATA                          */
         BAL   @14,DATACMD                                         0150
*   IF COMMAND(1:FOUR)=EXITS THEN   /* EXIT ?                        */
@RF00149 L     @14,CMDADD                                          0151
         CLC   COMMAND(4,@14),@CC00547                             0151
         BNE   @RF00151                                            0151
*     OC=OPSIX;                     /* EXIT OPCODE = 06              */
         L     @14,ECDACNXT(,ECDAPTR)                              0152
         MVI   OC(@14),X'06'                                       0152
*   CALL COMCMD;                    /* EXIT OR TSO CALL COMCMD       */
@RF00151 BAL   @14,COMCMD                                          0153
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
*                                                                  0154
         B     COMNEXIT                                            0154
*   /*****************************************************************/
*   /*                                                               */
*   /* LENGTH OF 5 WILL BE ERROR,WRITE OR TSO COMMAND                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0155
*LENGTH5:                                                          0155
*   IF COMMAND(1:FIVE)=ERROR THEN   /* ERROR ?                       */
LENGTH5  L     @14,CMDADD                                          0155
         CLC   COMMAND(5,@14),@CC00549                             0155
         BNE   @RF00155                                            0155
*     CALL ERRORCMD;                /* ERROR                         */
         BAL   @14,ERRORCMD                                        0156
*   IF COMMAND(1:FIVE)=WRITE THEN   /* WRITE ?                       */
@RF00155 L     @14,CMDADD                                          0157
         CLC   COMMAND(5,@14),@CC00551                             0157
         BNE   @RF00157                                            0157
*     OC=OPFIVE;                    /* WRITE-- OPCODE = 05           */
         L     @14,ECDACNXT(,ECDAPTR)                              0158
         MVI   OC(@14),X'05'                                       0158
*   CALL COMCMD;                    /* WRITE AND TSO CALL COMCMD     */
@RF00157 BAL   @14,COMCMD                                          0159
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
         B     COMNEXIT                                            0160
*LENGTH6:                                                          0161
*   IF COMMAND(1:SIX)=GLOBALS THEN  /* GLOBAL COMMAND                */
LENGTH6  L     @14,CMDADD                                          0161
         CLC   COMMAND(6,@14),@CC00553                             0161
         BNE   @RF00161                                            0161
*     DO;                           /*                               */
*       OC=OPGLOB;                                                 0163
         L     @14,ECDACNXT(,ECDAPTR)                              0163
         MVI   OC(@14),X'FF'                                       0163
*       CALL READCMD;               /* USES THE READ CMDND           */
         BAL   @14,READCMD                                         0164
*       GO TO SPCLEXIT;             /* GO TO SPECIAL EXIT            */
         B     SPCLEXIT                                            0165
*     END;                                                         0166
*   IF COMMAND(1:SIX)=TERMIN THEN   /* TERMIN COMMAND                */
@RF00161 L     @14,CMDADD                                          0167
         CLC   COMMAND(6,@14),@CC00555                             0167
         BNE   @RF00167                                            0167
*     OC=OP11;                      /* TERMIN OP CODE = 13           */
         L     @14,ECDACNXT(,ECDAPTR)                              0168
         MVI   OC(@14),X'0B'                                       0168
*   IF COMMAND(1:SIX)=RETURNS THEN  /* RETURN COMMAND                */
@RF00167 L     @14,CMDADD                                          0169
         CLC   COMMAND(6,@14),@CC00557                             0169
         BNE   @RF00169                                            0169
*     OC=OPEASY;                    /* RETURN OP CODE =0E            */
         L     @14,ECDACNXT(,ECDAPTR)                              0170
         MVI   OC(@14),X'0E'                                       0170
*   CALL COMCMD;                    /* WRITER,TERMIN AND TSO         */
@RF00169 BAL   @14,COMCMD                                          0171
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
         B     COMNEXIT                                            0172
*LENGTH7:                                                          0173
*   IF COMMAND(1:SEVEN)=CENDATA THEN/* ENDDATA ?                     */
LENGTH7  L     @14,CMDADD                                          0173
         CLC   COMMAND(7,@14),@CC00535                             0173
         BNE   @RF00173                                            0173
*     DO;                           /* ENDATA COMMAND ISSUE A MESSAGE*/
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0175
*       EXMSGID=M534;               /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00495                                 0176
*       MVAR(2)=ADDR(CENDATA);      /* FIRST INSERT                  */
         LA    @14,@CC00535                                        0177
         ST    @14,MVAR+4                                          0177
*       MVARLEN(2)=LENGTH(CENDATA); /* LENGTH OF FIRST INSERT        */
         MVI   MVARLEN+4,X'07'                                     0178
*       MVAR(3)=ADDR(CDATA);        /* SECOND INSERT                 */
         LA    @14,@CC00533                                        0179
         ST    @14,MVAR+8                                          0179
*       MVARLEN(3)=LENGTH(CDATA);   /* LENGTH OF SECOND INSERT       */
         MVI   MVARLEN+8,X'04'                                     0180
*       STMT=ONS;                   /* STATEMENT NUMBER REQUESTED    */
         OI    STMT,B'10000000'                                    0181
*       CALL MSGRTN;                /* ISSUE MESSAGE                 */
         BAL   @14,MSGRTN                                          0182
*       RETURN CODE(ZERO) TO SPCLEXIT;/* RETURN                      */
         L     @13,4(,@13)                                         0183
         L     @00,@SIZDATD                                        0183
         LR    @01,@12                                             0183
         FREEMAIN R,LV=(0),A=(1)
         LA    @14,SPCLEXIT                                        0183
         SLR   @15,@15                                             0183
         LM    @00,@12,20(@13)                                     0183
         BR    @14                                                 0183
*     END;                                                         0184
*   IF COMMAND(1:SEVEN)=CONTROL THEN/* CONTROL ?                     */
@RF00173 L     @14,CMDADD                                          0185
         CLC   COMMAND(7,@14),@CC00559                             0185
         BNE   @RF00185                                            0185
*     CALL CNTRLCMD;                /* CONTROL                       */
         BAL   @14,CNTRLCMD                                        0186
*   IF COMMAND(1:SEVEN)=WRITENR THEN/* IF WRITENR COMMAND            */
@RF00185 L     @14,CMDADD                                          0187
         CLC   COMMAND(7,@14),@CC00561                             0187
         BNE   @RF00187                                            0187
*     OC=OPFOUR;                    /* WRITE NO RETURN OC = 04       */
         L     @14,ECDACNXT(,ECDAPTR)                              0188
         MVI   OC(@14),X'04'                                       0188
*   IF COMMAND(1:SEVEN)=GETFILE THEN/* GETFILE COMMAND               */
@RF00187 L     @14,CMDADD                                          0189
         CLC   COMMAND(7,@14),@CC00422                             0189
         BNE   @RF00189                                            0189
*     OC=OPGFILE;                   /* GETFILE OP CODE = 14          */
         L     @14,ECDACNXT(,ECDAPTR)                              0190
         MVI   OC(@14),X'14'                                       0190
*   IF COMMAND(1:SEVEN)=PUTFILE THEN/* PUTFILE COMMAND               */
@RF00189 L     @14,CMDADD                                          0191
         CLC   COMMAND(7,@14),@CC00424                             0191
         BNE   @RF00191                                            0191
*     OC=OPPFILE;                   /* PUTFILE OP CODE = 15          */
         L     @14,ECDACNXT(,ECDAPTR)                              0192
         MVI   OC(@14),X'15'                                       0192
*   CALL COMCMD;                    /* COMMON CMD ROUTINE            */
@RF00191 BAL   @14,COMCMD                                          0193
*   GOTO COMNEXIT;                  /* EXIT THRU COMMON EXIT         */
         B     COMNEXIT                                            0194
*LENGTH8:                                                          0195
*   IF COMMAND(1:EIGHT)=READDVAL THEN/* IF READ D COMMAND            */
LENGTH8  L     @14,CMDADD                                          0195
         CLC   COMMAND(8,@14),@CC00537                             0195
         BNE   @RF00195                                            0195
*     DO;                           /* PROCESS AS READ COMMAND       */
*       CALL READCMD;               /* CALL READ PROCESSOR           */
         BAL   @14,READCMD                                         0197
*       GOTO SPCLEXIT;              /* EXIT                          */
         B     SPCLEXIT                                            0198
*     END;                                                         0199
*   IF COMMAND(1:EIGHT)=OPENFILE THEN/* OPENFILE                     */
@RF00195 L     @14,CMDADD                                          0200
         CLC   COMMAND(8,@14),@CC00418                             0200
         BNE   @RF00200                                            0200
*     OC=OPOFILE;                   /* OPENFILE OP CODE = 12         */
         L     @14,ECDACNXT(,ECDAPTR)                              0201
         MVI   OC(@14),X'12'                                       0201
*   IF COMMAND(1:EIGHT)=CLOSFILE THEN/* CLOSE FILE                   */
@RF00200 L     @14,CMDADD                                          0202
         CLC   COMMAND(8,@14),@CC00420                             0202
         BNE   @RF00202                                            0202
*     OC=OPCFILE;                   /* CLOSFILE OP CODE = 13         */
         L     @14,ECDACNXT(,ECDAPTR)                              0203
         MVI   OC(@14),X'13'                                       0203
*   CALL COMCMD;                    /* ANYTHING ELSE CALL COMCMD     */
@RF00202 BAL   @14,COMCMD                                          0204
*   GOTO COMNEXIT;                  /* CALL COMMON EXIT              */
*                                                                  0205
         B     COMNEXIT                                            0205
*   /*****************************************************************/
*   /*                                                               */
*   /* WHEN CONTROL IS RETURNED TO COMMON EXIT THEN THE MOVE ROUTINE */
*   /* IS CALLED TO MOVE A RECORD TO THE STORAGE AREA                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0206
*COMNEXIT:                                                         0206
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */
COMNEXIT BAL   @14,MOVERTN                                         0206
*SPCLEXIT:                                                         0207
*   IF RCODE^=FOUR&RCODE^=TWENTY THEN                              0207
SPCLEXIT C     RCODE,@CF00072                                      0207
         BE    @RF00207                                            0207
         C     RCODE,@CF00357                                      0207
         BE    @RF00207                                            0207
*     DO WHILE ECDAIREC->OO^=0;     /* UPDATE ECDA                   */
         B     @DE00208                                            0208
@DL00208 DS    0H                                                  0209
*       ECDAIREC=ECDAIREC-ECDAIREC->OO;/* ADJUST BUFFER              */
         L     @14,ECDAIREC(,ECDAPTR)                              0209
         LR    @08,@14                                             0209
         SH    @08,OO(,@14)                                        0209
         ST    @08,ECDAIREC(,ECDAPTR)                              0209
*     END;                                                         0210
@DE00208 L     @14,ECDAIREC(,ECDAPTR)                              0210
         LH    @14,OO(,@14)                                        0210
         LTR   @14,@14                                             0210
         BNZ   @DL00208                                            0210
*   RETURN CODE(R15);               /* RETURN (SPECIAL EXIT ALSO)    */
@RF00207 LR    @08,@15                                             0211
         L     @13,4(,@13)                                         0211
         L     @00,@SIZDATD                                        0211
         LR    @01,@12                                             0211
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@08                                             0211
         L     @14,12(,@13)                                        0211
         LM    @00,@12,20(@13)                                     0211
         BR    @14                                                 0211
*                                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* THE MOVE ROUTINE IS USED BY A NUMBER OF OTHER ROUTINES TO MOVE*/
*   /* DATA INTO THE COMMAND PROCEDURE AREA. IF SPACE RUNS OUT IN THE*/
*   /* STORAGE AREA- MOVE WILL DO A GETMAIN FOR A NEW STORAGE AREA.  */
*   /* AT THE BEGINNING OF EACH STORAGE AREA THE LENGTH OF THE       */
*   /* CURRENT STORAGE AREA AND THE ADDRESS OF OF THE NEXT ARE SAVED.*/
*   /* THE ONLY ERROR FROM MOVE MAY BE A GETMAIN FAILURE.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0212
*MOVERTN:                                                          0212
*   PROC;                                                          0212
MOVERTN  STM   @14,@12,@SA00002                                    0212
*   IF NOTEXEC=ON THEN                                             0213
         TM    NOTEXEC(ECDAPTR),B'01000000'                        0213
         BO    @RT00213                                            0213
*     RETURN;                       /* RETURN-PROC NOT EXECUTIBLE    */
*                                                                  0214
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRST CHECK FOR ENOUGH ROOM FOR THE MOVE--IF NOT ENOUGH THEN  */
*   /* DO A GETMAIN FOR THE NEXT AND RE-INITIALIZE ALL APPROPRIATE   */
*   /* POINTERS AND DATA & FREE UNUSED SPACE.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*   IF COMPRLNG-COMPRUSE<DATALEN+LL+MAXPREFX THEN/* ENOUGH ROOM      */
         L     @14,ECDACBLK(,ECDAPTR)                              0215
         L     @08,COMPRLNG(,@14)                                  0215
         SL    @08,COMPRUSE(,@14)                                  0215
         L     @14,ECDACNXT(,ECDAPTR)                              0215
         LH    @14,LL(,@14)                                        0215
         AL    @14,DATALEN                                         0215
         LA    @06,12                                              0215
         ALR   @06,@14                                             0215
         CR    @08,@06                                             0215
         BNL   @RF00215                                            0215
*     DO;                           /* NO-- DO A GETMAIN FOR RECORD
*                                      SIZE UP TO NEXT 4K BDY OR 2 0216
*                                      TIMES LAST GETMAIN            */
*       GETBYTE=MAX((DATALEN+LL+SIXK)/FOURK*FOURK,TWO*ECDACPGM);   0217
         LR    @00,@14                                             0217
         AL    @00,@CF00388                                        0217
         SRDA  @00,32                                              0217
         D     @00,@CF00390                                        0217
         SLA   @01,12                                              0217
         L     GETBYTE,ECDACPGM(,ECDAPTR)                          0217
         ALR   GETBYTE,GETBYTE                                     0217
         CR    @01,GETBYTE                                         0217
         BNL   *+6
         LR    @01,GETBYTE                                         0217
         LR    GETBYTE,@01                                         0217
*       GETBYTE=MIN(GETBYTE,MAXCPGM);/* MAX GM SIZE IS 32K           */
         L     @14,@CF00477                                        0218
         CR    GETBYTE,@14                                         0218
         BNH   *+6
         LR    GETBYTE,@14                                         0218
*       ECDACPGM=GETBYTE;           /* SAVE SIZE OF NEW BLOCK        */
         ST    GETBYTE,ECDACPGM(,ECDAPTR)                          0219
*       DO;                         /* GETMAIN (EC) LV(GETBYTE)    0220
*                                      A(GTMNPTR) SP(78) RTCD(R15)   */
*         RESPECIFY                                                0221
*          (GPR01P,                                                0221
*           GPR15F) RESTRICTED;                                    0221
*         I004=I004&&I004;          /* INIT LIST                     */
         XC    I004(10),I004                                       0222
*         I00404='20'X;             /* TYPE                          */
         MVI   I00404,X'20'                                        0223
*         I00401=GETBYTE;           /* LENGTH                        */
         ST    GETBYTE,I00401                                      0224
*         I00403=ADDR(GTMNPTR);     /* ADDR OF ADDR LIST             */
         LA    @14,GTMNPTR                                         0225
         STCM  @14,7,I00403                                        0225
*         I00405=78;                /* SUBPOOL VALUE                 */
         MVI   I00405,X'4E'                                        0226
*         GPR01P=ADDR(I004);        /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0227
*         SVC(4);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0228
*         R15=GPR15F;               /* SET RETURN CODE               */
*         RESPECIFY                                                0230
*          (GPR01P,                                                0230
*           GPR15F) UNRESTRICTED;                                  0230
*       END;                        /* GETMAIN (EC) LV(GETBYTE)    0231
*                                      A(GTMNPTR) SP(78) RTCD(R15)   */
*/*                                                                  */
*                                                                  0232
*       IF R15^=ZERO THEN           /* IF GETMAIN FAILED THEN        */
         LTR   R15,R15                                             0232
         BZ    @RF00232                                            0232
*         DO;                       /* ISSUE A MESSAGE               */
*           EXMSGID=M511;           /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00481                                 0234
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0235
*           STMT=ONS;               /* STAMTMENT NUMBERS REQUESTED   */
         OI    STMT,B'10000000'                                    0236
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0237
*           RETURN CODE(TWELVE);    /* AND RETURN WITH A RTCD=12     */
         LA    @15,12                                              0238
         L     @14,@SA00002                                        0238
         LM    @00,@12,@SA00002+8                                  0238
         BR    @14                                                 0238
*         END;                                                     0239
*       WORKPTR=ECDACBLK;           /* SAVE CURRENT BLOCK PTR        */
@RF00232 L     @14,ECDACBLK(,ECDAPTR)                              0240
         ST    @14,WORKPTR                                         0240
*       COMPRNXT=GTMNPTR;           /* INIT @ OF NEXT STORAGE BLK    */
         L     @06,GTMNPTR                                         0241
         STCM  @06,7,COMPRNXT(@14)                                 0241
*       X=COMPRID;                  /* IN PREVIOUS,SAVE BLK NUM.     */
         SLR   X,X                                                 0242
         IC    X,COMPRID(,@14)                                     0242
*       ECDACBLK=GTMNPTR;           /* ADDRESS NEW BLOCK             */
         ST    @06,ECDACBLK(,ECDAPTR)                              0243
*       COMPRID=X+ONE;              /* UPDATE BLOCK NUMBER           */
         LA    @14,1                                               0244
         ALR   @14,X                                               0244
         STC   @14,COMPRID(,@06)                                   0244
*       ECDAIDS=COMPRID;            /* STORE ID IN ECDACBLK          */
         STC   @14,ECDAIDS(,ECDAPTR)                               0245
*       COMPRNXT=ZERO;              /* POINTER TO NEXT               */
         L     @14,ECDACBLK(,ECDAPTR)                              0246
         SLR   @08,@08                                             0246
         STCM  @08,7,COMPRNXT(@14)                                 0246
*       COMPRLNG=GETBYTE;           /* LENGTH OF BLOCK               */
         ST    GETBYTE,COMPRLNG(,@14)                              0247
*       COMPRUSE=TWELVE;            /* # OF BYTES NOT IN USE - LENGTH
*                                      MINUS HEADER LENGTH           */
*                                                                  0248
         LA    @08,12                                              0248
         ST    @08,COMPRUSE(,@14)                                  0248
*       /*************************************************************/
*       /*                                                           */
*       /* NEXT MOVE PREFIX OF CURRENT STOARGE RECORD INTO THE NEW   */
*       /* BLOCK AND RE-ADJUST # OF BYTES UNUSED IN OLD BLOCK        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0249
*       RFY                                                        0249
*        (R2,                                                      0249
*         R3,                                                      0249
*         R4,                                                      0249
*         R5) RSTD;                 /* FROM OLD BLOCK                */
*       R4=ADDR(CPHEADER);          /* ADDR OF DATA IN OLD BLOCK     */
         L     @06,ECDACNXT(,ECDAPTR)                              0250
         LR    R4,@06                                              0250
*       R5=LL;                      /* AMOUNT OF DATA IN OLD BLOCK   */
         LH    R5,LL(,@06)                                         0251
*       R2=ECDACBLK+TWELVE;         /* NEW DATA ADDRESS              */
         ALR   @14,@08                                             0252
         LR    R2,@14                                              0252
*       R3=R5;                      /* SAME AS OLD LENGTH            */
         LR    R3,R5                                               0253
*       MVCL(R2,R4);                /* MOVE THE DATA                 */
         MVCL  R2,R4                                               0254
*       RFY                                                        0255
*        (R2,                                                      0255
*         R3,                                                      0255
*         R4,                                                      0255
*         R5) UNRSTD;               /* RELEASE REGS                  */
*                                                                  0255
*       /*************************************************************/
*       /*                                                           */
*       /* NEXT FREE ANY UNUSED SPACE IN OLD BLOCK                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0256
*       ECDACNXT=(ECDACNXT+SEVEN)/EIGHT*EIGHT;/* DOUBLE WORD         */
         LA    @00,7                                               0256
         AL    @00,ECDACNXT(,ECDAPTR)                              0256
         SRDA  @00,32                                              0256
         D     @00,@CF00088                                        0256
         SLA   @01,3                                               0256
         ST    @01,ECDACNXT(,ECDAPTR)                              0256
*       DO;                         /* FREEMAIN (EC) LV(WORKPTR->COMP
*                                      RLNG-(ECDACNXT-WORKPTR))    0257
*                                      A(ECDACNXT) SP(78)            */
*         RESPECIFY                                                0258
*          (GPR01P) RESTRICTED;                                    0258
*         I005=I005&&I005;          /* INIT LIST                     */
         XC    I005(10),I005                                       0259
*         I00505='20'X;             /* SET TYPE                      */
         MVI   I00505,X'20'                                        0260
*         I00502=WORKPTR->COMPRLNG-(ECDACNXT-WORKPTR);/* LENGTH      */
         L     @14,WORKPTR                                         0261
         L     @08,ECDACNXT(,ECDAPTR)                              0261
         SLR   @08,@14                                             0261
         LCR   @08,@08                                             0261
         AL    @08,COMPRLNG(,@14)                                  0261
         STCM  @08,7,I00502                                        0261
*         I00504=ADDR(ECDACNXT);    /* ADDR OF ADDR LIST             */
         LA    @14,ECDACNXT(,ECDAPTR)                              0262
         STCM  @14,7,I00504                                        0262
*         I00506=78;                /* SUBPOOL VALUE                 */
         MVI   I00506,X'4E'                                        0263
*         GPR01P=ADDR(I005);        /* REG1 POINTS TO LIST           */
         LA    GPR01P,I005                                         0264
*         SVC(5);                   /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   0265
*         RESPECIFY                                                0266
*          (GPR01P) UNRESTRICTED;                                  0266
*       END;                        /* FREEMAIN (EC) LV(WORKPTR->COMP
*                                      RLNG-(ECDACNXT-WORKPTR))    0267
*                                      A(ECDACNXT) SP(78) FREEMAIN   */
*       WORKPTR->COMPRLNG=          /* UPDATE LENGTH OF OLD BLOCK    */
*           WORKPTR->COMPRUSE;                                     0268
         L     @14,WORKPTR                                         0268
         L     @08,COMPRUSE(,@14)                                  0268
         ST    @08,COMPRLNG(,@14)                                  0268
*       ECDACNXT=ECDACBLK+TWELVE;   /* UPDATE @ OF CURRENT RECORD    */
         LA    @14,12                                              0269
         AL    @14,ECDACBLK(,ECDAPTR)                              0269
         ST    @14,ECDACNXT(,ECDAPTR)                              0269
*     END;                                                         0270
*                                                                  0270
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT COMMON CODE BEGINS FOR THE MOVE ROUTINE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0271
*   RFY                                                            0271
*    (R2,                                                          0271
*     R3,                                                          0271
*     R4,                                                          0271
*     R5) RSTD;                     /* RESTRICT REGS FOR MVCL        */
@RF00215 DS    0H                                                  0272
*   R2=ECDACNXT+LL;                 /* RECEIVER                      */
         L     @14,ECDACNXT(,ECDAPTR)                              0272
         LH    R2,LL(,@14)                                         0272
         ALR   R2,@14                                              0272
*   R3=DATALEN;                     /* LENGTH                        */
         L     @14,DATALEN                                         0273
         LR    R3,@14                                              0273
*   R4=DATAADD;                     /* SOURCE                        */
         L     R4,DATAADD                                          0274
*   R5=DATALEN;                     /* LENGTH                        */
         LR    R5,@14                                              0275
*   MVCL(R2,R4);                    /* MOVE IN RECORD                */
         MVCL  R2,R4                                               0276
*   RFY                                                            0277
*    (R3,                                                          0277
*     R4,                                                          0277
*     R5) UNRSTD;                   /* FREE REGS                     */
*   LL=LL+DATALEN;                  /* UPDATE LL FIELD               */
         L     @14,ECDACNXT(,ECDAPTR)                              0278
         LH    @08,LL(,@14)                                        0278
         AL    @08,DATALEN                                         0278
         STH   @08,LL(,@14)                                        0278
*   IF OC=OPNOMOVE THEN             /* IF IT IS A READ(DVAL) RECORD  */
         CLI   OC(@14),254                                         0279
         BNE   @RF00279                                            0279
*     RETURN CODE(ZERO);            /* THEN RETURN                   */
         SLR   @15,@15                                             0280
         L     @14,@SA00002                                        0280
         LM    @00,@12,@SA00002+8                                  0280
         BR    @14                                                 0280
*   COMPRUSE=COMPRUSE+LL;           /* INCREMENT BLKNUSE             */
@RF00279 L     @14,ECDACBLK(,ECDAPTR)                              0281
         L     @08,ECDACNXT(,ECDAPTR)                              0281
         LH    @06,LL(,@08)                                        0281
         L     @03,COMPRUSE(,@14)                                  0281
         ALR   @03,@06                                             0281
         ST    @03,COMPRUSE(,@14)                                  0281
*   ECDACPRE=ECDACNXT;              /* OTHER WISE UPATE PREVIOUS @   */
         ST    @08,ECDACPRE(,ECDAPTR)                              0282
*   ECDACNXT=ECDACNXT+LL;           /* UPDATE @ OF NEXT (R2 HAS      */
         ALR   @08,@06                                             0283
         ST    @08,ECDACNXT(,ECDAPTR)                              0283
*   RFY                                                            0284
*    (R2) UNRSTD;                   /* @ FROM MVCL)                  */
*   RETURN CODE(ZERO);              /* RETURN RTCODE=0               */
         SLR   @15,@15                                             0285
         L     @14,@SA00002                                        0285
         LM    @00,@12,@SA00002+8                                  0285
         BR    @14                                                 0285
*   END MOVERTN;                                                   0286
@EL00002 DS    0H                                                  0286
@EF00002 DS    0H                                                  0286
@ER00002 LM    @14,@12,@SA00002                                    0286
         BR    @14                                                 0286
*                                                                  0287
*/********************************************************************/
*/*                                                                  */
*/*     COMMAND SCAN ROUTINE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0287
*CMDSCAN:                                                          0287
*   PROC;                                                          0287
CMDSCAN  STM   @14,@12,@SA00003                                    0287
*   TRIP=ZERO;                      /* ZERO OUT PASS COUNT           */
         SLR   TRIP,TRIP                                           0288
*   COUNT=ZERO;                     /* ZERO CHARACTER COUNT          */
         SLR   COUNT,COUNT                                         0289
*   SCANLIST=SCANLIST&&SCANLIST;    /* ZERO SCAN OUTPUT FIELD        */
         XC    SCANLIST(17),SCANLIST                               0290
*   SCANPTR=ECDAIREC;               /* SET UP SCAN POINTER           */
         L     @14,ECDAIREC(,ECDAPTR)                              0291
         ST    @14,SCANPTR                                         0291
*AGAIN:                                                            0292
*   TRIP=TRIP+ONE;                  /* KEEP NUMBER OF PASSES         */
*                                                                  0292
AGAIN    AL    TRIP,@CF00033                                       0292
*   /*****************************************************************/
*   /*                                                               */
*   /* FIRST SKIP SEPERATORS (COMMA,TAB,BLANK)TO FIND START OF LABEL */
*   /* OR COMMAND.                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*SKIP:                                                             0293
*   COUNT=COUNT+ONCE;               /* INCREMENT TO NEXT CHAR.       */
SKIP     AL    COUNT,@CF00033                                      0293
*   IF COUNT>RLENGTH THEN           /* HAVE WE REACHED END OF        */
         C     COUNT,RLENGTH                                       0294
         BH    @RT00294                                            0294
*     RETURN;                       /* RECORD--YES THEN RETURN       */
*   CALL FINDPARM;                  /* CHECK FOR SEPERATORS          */
         BAL   @14,FINDPARM                                        0296
*   IF COUNT>RLENGTH THEN           /* IF AT END OF BUFFER           */
         C     COUNT,RLENGTH                                       0297
         BH    @RT00297                                            0297
*     RETURN;                       /* RETURN                        */
*   COUNT=COUNT+ONCE;               /* SET FOR NEXT CHARACTER        */
         LA    @14,1                                               0299
         ALR   COUNT,@14                                           0299
*   LENTH=ONE;                      /* KEEP TRACK OF LENGTH          */
         ST    @14,LENTH                                           0300
*   IF ALPHA=OFF THEN               /* WAS FIRST CHAR ALPHABETIC?    */
         TM    ALPHA,B'10000000'                                   0301
         BNZ   @RF00301                                            0301
*     DO;                           /* NO THEN CHECK FOR PERCENT     */
*       CMDADD=ADDR(RECORD(COUNT-1));/* ADDR OF COMMAND              */
         L     @14,SCANPTR                                         0303
         LA    @14,RECORD-2(COUNT,@14)                             0303
         ST    @14,CMDADD                                          0303
*       CALL FINDEND;               /* FIND END OF COMMAND           */
         BAL   @14,FINDEND                                         0304
*       CMDLEN=LENTH;               /* LENGTH OF COMMAND NAME        */
         L     @14,LENTH                                           0305
         ST    @14,CMDLEN                                          0305
*       IF COLONB=ON THEN           /* IF COLON AFTER NAME           */
         TM    COLONB,B'00100000'                                  0306
         BNO   @RF00306                                            0306
*         DO;                       /*                               */
*LABEND:                                                           0308
*           LENTH=ONE;              /* SET LENGTH TO TWO             */
LABEND   LA    @14,1                                               0308
         ST    @14,LENTH                                           0308
*           COUNT=COUNT+ONE;        /* INCREMENT COUNT               */
         ALR   COUNT,@14                                           0309
*           CALL FINDEND;           /* FIND END                      */
         BAL   @14,FINDEND                                         0310
*           CMDLEN=CMDLEN+LENTH;    /* MODIFY LENGTH OF COMMAND      */
         L     @14,CMDLEN                                          0311
         AL    @14,LENTH                                           0311
         ST    @14,CMDLEN                                          0311
*         END;                                                     0312
*TSOCMD:                                                           0313
*       TSODISG=ONS;                /* MUST BE A TSO COMMAND IN      */
@RF00306 DS    0H                                                  0313
TSOCMD   OI    TSODISG,B'00100000'                                 0313
*       RETURN CODE(ZERO);          /* RETURN TO MAINLINE            */
         SLR   @15,@15                                             0314
         L     @14,@SA00003                                        0314
         LM    @00,@12,@SA00003+8                                  0314
         BR    @14                                                 0314
*     END;                                                         0315
*                                                                  0315
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT FIRST CHARACTER WAS ALPHABETIC. NEXT CALL       */
*   /* FINDEND ROUTINE TO SCAN TO THE NEXT SEPARATOR. THE REMAINING  */
*   /* LOGIC WILL BE BASED ON WHETHER A COMMAND NAME IS FOUND OR     */
*   /* WHETHER A LABEL IS FOUND.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0316
*   CALL FINDEND;                   /* CALL FINDEND ROUTINE          */
@RF00301 BAL   @14,FINDEND                                         0316
*   IF COLONB=OFF THEN              /* IS IT A LABEL(COLON)?         */
         TM    COLONB,B'00100000'                                  0317
         BNZ   @RF00317                                            0317
*     DO;                           /* NO---CHECK IT AS A COMMAND    */
*       CMDLEN=LENTH;               /* CMD NAME IS OK-PUT LENGTH     */
         L     @14,LENTH                                           0319
         ST    @14,CMDLEN                                          0319
*       CMDADD=ADDR(RECORD(COUNT-LENTH+ONE));/* ADDR OF CMD NAME     */
         LR    @08,COUNT                                           0320
         SLR   @08,@14                                             0320
         L     @06,SCANPTR                                         0320
         LA    @08,RECORD(@08,@06)                                 0320
         ST    @08,CMDADD                                          0320
*       IF LENTH>EIGHTNOTALPNU=ONS THEN/* IF BAD SYNTAX,ASSUME TSO  */
         C     @14,@CF00088                                        0321
         BH    @RT00321                                            0321
         TM    NOTALPNU,B'10000000'                                0321
         BO    @RT00321                                            0321
*         GOTO TSOCMD;              /* GO TO IT                      */
*       RETURN;                     /* RETURN                        */
@EL00003 DS    0H                                                  0323
@EF00003 DS    0H                                                  0323
@ER00003 LM    @14,@12,@SA00003                                    0323
         BR    @14                                                 0323
*     END;                                                         0324
*                                                                  0324
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT IT IS KNOWN THAT THE NAME ENDED WITH A COLON.   */
*   /* THEREFORE ASSUME IT IS A LABEL. IF A LABEL HAS BEEN FOUND     */
*   /* PREVIOUSLY THEN TREAT IT AS AN INVLAID COMMAND. ALSO VALIDITY */
*   /* CHECK THE LABEL FOR CORRECT LENGTH IF EVERYTHING IS OK THEN   */
*   /* UPDATE THE LABEL INFORMATION IN THE SCAN OUTPUT FIELDS AND    */
*   /* THEN CHECK FOR A COMMAND NAME.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0325
*   IF TRIP=TWOLENTH>EIGHTNOTALPNU=ONS THEN/* INVALID LABEL OR CMD */
@RF00317 C     TRIP,@CF00074                                       0325
         BE    @RT00325                                            0325
         L     @14,LENTH                                           0325
         C     @14,@CF00088                                        0325
         BH    @RT00325                                            0325
         TM    NOTALPNU,B'10000000'                                0325
         BNO   @RF00325                                            0325
@RT00325 DS    0H                                                  0326
*     DO;                           /* TREAT AS TSO                  */
*       CMDLEN=LENTH+ONE;           /* COMMAND LENGTH                */
         LA    @14,1                                               0327
         AL    @14,LENTH                                           0327
         ST    @14,CMDLEN                                          0327
*       CMDADD=ADDR(RECORD(COUNT-CMDLEN+ONE));/* POINT TO BAD COMMAND*/
         LCR   @14,@14                                             0328
         ALR   @14,COUNT                                           0328
         L     @08,SCANPTR                                         0328
         LA    @14,RECORD(@14,@08)                                 0328
         ST    @14,CMDADD                                          0328
*       GOTO LABEND;                /* PROCESS AS TSO                */
         B     LABEND                                              0329
*     END;                                                         0330
*   LABLLEN=LENTH;                  /* PUT LENGTH IN OUTPUT FIELD    */
@RF00325 L     @14,LENTH                                           0331
         ST    @14,LABLLEN                                         0331
*   LABLADD=ADDR(RECORD(COUNT-LENTH));/* ADDR OF LABEL               */
         LCR   @14,@14                                             0332
         ALR   @14,COUNT                                           0332
         L     @06,SCANPTR                                         0332
         LA    @14,RECORD-1(@14,@06)                               0332
         ST    @14,LABLADD                                         0332
*   GOTO AGAIN;                     /* SCAN MORE                     */
         B     AGAIN                                               0333
*   END CMDSCAN;                                                   0334
         B     @EL00003                                            0334
*                                                                  0335
*/********************************************************************/
*/*                                                                  */
*/*     CHARACTER CHECK ROUTINE                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0335
*CHARCHK:                                                          0335
*   PROC;                                                          0335
*                                                                  0335
CHARCHK  STM   @14,@12,12(@13)                                     0335
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL DETERMINE WHETHER THE CHARACTER IS          */
*   /* ALPHABETIC,NUMERIC,COLON,PRECENT SIGN,AMPERSAND,SEPARATOR     */
*   /* (THIS ROUTINE REWRITTEN - - - - - - - - - - - - - - -@ZM30993)*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0336
*   SCANBYTE=ZERO;                  /* ZERO OUT WORK BYTE            */
         SLR   @14,@14                                             0336
         STCM  @14,3,SCANBYTE                                      0336
*   IF RECORD(COUNT)^<A&RECORD(COUNT)^>IRECORD(COUNT)^<J&RECORD(COUNT)
*       ^>RRECORD(COUNT)^<S&RECORD(COUNT)^>Z THEN                 0337
         L     @14,SCANPTR                                         0337
         LR    @08,@14                                             0337
         ALR   @08,COUNT                                           0337
         CLI   RECORD-1(@08),C'A'                                  0337
         BL    @GL00006                                            0337
         ALR   @14,COUNT                                           0337
         CLI   RECORD-1(@14),C'I'                                  0337
         BNH   @RT00337                                            0337
@GL00006 L     @14,SCANPTR                                         0337
         LR    @08,@14                                             0337
         ALR   @08,COUNT                                           0337
         CLI   RECORD-1(@08),C'J'                                  0337
         BL    @GL00005                                            0337
         ALR   @14,COUNT                                           0337
         CLI   RECORD-1(@14),C'R'                                  0337
         BNH   @RT00337                                            0337
@GL00005 L     @14,SCANPTR                                         0337
         LR    @08,@14                                             0337
         ALR   @08,COUNT                                           0337
         CLI   RECORD-1(@08),C'S'                                  0337
         BL    @RF00337                                            0337
         ALR   @14,COUNT                                           0337
         CLI   RECORD-1(@14),C'Z'                                  0337
         BH    @RF00337                                            0337
@RT00337 DS    0H                                                  0338
*     DO;                                                          0338
*       ALPHA=ONS;                                                 0339
         OI    ALPHA,B'10000000'                                   0339
*       RETURN;                                                    0340
@EL00004 DS    0H                                                  0340
@EF00004 DS    0H                                                  0340
@ER00004 LM    @14,@12,12(@13)                                     0340
         BR    @14                                                 0340
*     END;                                                         0341
*   IF RECORD(COUNT)^<FOXZERO&RECORD(COUNT)^>FOXNINE THEN          0342
@RF00337 L     @14,SCANPTR                                         0342
         LR    @08,@14                                             0342
         ALR   @08,COUNT                                           0342
         CLI   RECORD-1(@08),C'0'                                  0342
         BL    @RF00342                                            0342
         ALR   @14,COUNT                                           0342
         CLI   RECORD-1(@14),C'9'                                  0342
         BH    @RF00342                                            0342
*     DO;                                                          0343
*       NUMERIC=ONS;                                               0344
         OI    NUMERIC,B'01000000'                                 0344
*       RETURN;                                                    0345
         B     @EL00004                                            0345
*     END;                                                         0346
*   NALPHNUM=ONS;                   /* INDICATE NON-ALPHANUMERIC     */
@RF00342 OI    NALPHNUM,B'00000001'                                0347
*   IF RECORD(COUNT)=BLANKRECORD(COUNT)=COMMARECORD(COUNT)=TAB THEN
         L     @14,SCANPTR                                         0348
         LR    @08,@14                                             0348
         ALR   @08,COUNT                                           0348
         CLI   RECORD-1(@08),C' '                                  0348
         BE    @RT00348                                            0348
         LR    @08,@14                                             0348
         ALR   @08,COUNT                                           0348
         CLI   RECORD-1(@08),C','                                  0348
         BE    @RT00348                                            0348
         SLR   @08,@08                                             0348
         IC    @08,RECORD-1(COUNT,@14)                             0348
         C     @08,@CF00371                                        0348
         BNE   @RF00348                                            0348
@RT00348 DS    0H                                                  0349
*     DO;                                                          0349
*       SEPAR=ONS;                                                 0350
         OI    SEPAR,B'00000100'                                   0350
*       RETURN;                                                    0351
         B     @EL00004                                            0351
*     END;                                                         0352
*   IF RECORD(COUNT)=AMPER THEN                                    0353
@RF00348 L     @14,SCANPTR                                         0353
         ALR   @14,COUNT                                           0353
         CLI   RECORD-1(@14),C'&&'                                 0353
         BNE   @RF00353                                            0353
*     AMPERSND=ONS;                                                0354
         OI    AMPERSND,B'00001000'                                0354
*   ELSE                                                           0355
*     IF RECORD(COUNT)=OPN THEN                                    0355
         B     @RC00353                                            0355
@RF00353 L     @14,SCANPTR                                         0355
         ALR   @14,COUNT                                           0355
         CLI   RECORD-1(@14),C'('                                  0355
         BNE   @RF00355                                            0355
*       OPAREN=ONS;                                                0356
         OI    OPAREN,B'10000000'                                  0356
*     ELSE                                                         0357
*       IF RECORD(COUNT)=CLSE THEN                                 0357
         B     @RC00355                                            0357
@RF00355 L     @14,SCANPTR                                         0357
         ALR   @14,COUNT                                           0357
         CLI   RECORD-1(@14),C')'                                  0357
         BNE   @RF00357                                            0357
*         CPAREN=ONS;                                              0358
         OI    CPAREN,B'01000000'                                  0358
*       ELSE                                                       0359
*         IF RECORD(COUNT)=COLON THEN                              0359
         B     @RC00357                                            0359
@RF00357 L     @14,SCANPTR                                         0359
         ALR   @14,COUNT                                           0359
         CLI   RECORD-1(@14),C':'                                  0359
         BNE   @RF00359                                            0359
*           COLONB=ONS;                                            0360
         OI    COLONB,B'00100000'                                  0360
*         ELSE                                                     0361
*           IF RECORD(COUNT)=PERCENT THEN                          0361
         B     @RC00359                                            0361
@RF00359 L     @14,SCANPTR                                         0361
         ALR   @14,COUNT                                           0361
         CLI   RECORD-1(@14),C'%'                                  0361
         BNE   @RF00361                                            0361
*             PERCENTB=ONS;                                        0362
         OI    PERCENTB,B'00010000'                                0362
*           ELSE                                                   0363
*             IF COUNT+ONE^>RLENGTH THEN                           0363
         B     @RC00361                                            0363
@RF00361 LA    @14,1                                               0363
         ALR   @14,COUNT                                           0363
         C     @14,RLENGTH                                         0363
         BH    @RF00363                                            0363
*               IF RECORD(COUNT:COUNT+ONE)=SLASHAST THEN           0364
         L     @14,SCANPTR                                         0364
         ALR   @14,COUNT                                           0364
         CLC   RECORD-1(2,@14),@CC00455                            0364
         BNE   @RF00364                                            0364
*                 SLASH=ONS;                                       0365
         OI    SLASH,B'00000010'                                   0365
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00004                                            0366
*   END CHARCHK;                                                   0367
         B     @EL00004                                            0367
*                                                                  0368
*/********************************************************************/
*/*                                                                  */
*/*     SEPERATOR SCAN ROUTINE                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0368
*FINDEND:                                                          0368
*   PROC;                                                          0368
*                                                                  0368
FINDEND  STM   @14,@01,@SA00005                                    0368
         STM   @03,@12,@SA00005+16                                 0368
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE WILL SCAN TO THE NEXT SEPARATOR                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0369
*   ENDWORD=ZERO;                   /* ZERO OUT WORK BYTE            */
         MVI   ENDWORD,X'00'                                       0369
*   IF AMPERSND=ONS THEN            /* SAVE INDICATIONS OF WHETHER   */
         TM    AMPERSND,B'00001000'                                0370
         BNO   @RF00370                                            0370
*     WASAMPER=ONS;                 /* FIRST CHARACTER WAS AN        */
         OI    WASAMPER,B'00100000'                                0371
*   ELSE                                                           0372
*     IF PERCENTB=ONS THEN          /*                       @ZM30993*/
         B     @RC00370                                            0372
@RF00370 TM    PERCENTB,B'00010000'                                0372
         BNO   @RF00372                                            0372
*       WASPRCNT=ONS;               /* AMPERSAND OR A PERCENT SIGN   */
         OI    WASPRCNT,B'01000000'                                0373
*NEXT:                                                             0374
*   IF COUNT>RLENGTH THEN           /* THE INDEX---IF WE ARE AT      */
@RF00372 DS    0H                                                  0374
@RC00370 DS    0H                                                  0374
NEXT     C     COUNT,RLENGTH                                       0374
         BNH   @RF00374                                            0374
*     DO;                           /* THE END OF THE RECORD THEN    */
*       COUNT=COUNT-ONCE;           /* RETURN---ELSE UP LENGTH AND   */
         BCTR  COUNT,0                                             0376
*       RETURN;                     /* GO CHECK NEXT CHARACTER       */
@EL00005 DS    0H                                                  0377
@EF00005 DS    0H                                                  0377
@ER00005 LM    @14,@01,@SA00005                                    0377
         LM    @03,@12,@SA00005+16                                 0377
         BR    @14                                                 0377
*     END;                                                         0378
*   CALL CHARCHK;                   /* CALL CHARCHK ROUTINE          */
@RF00374 BAL   @14,CHARCHK                                         0379
*   IF COLONB=ONSSEPAR=ONSSLASH=ONS THEN/* HAS THE END BEEN FOUND? */
         TM    COLONB,B'00100110'                                  0380
         BZ    @RF00380                                            0380
*     DO;                           /* YES                           */
*       IF COLONB=OFF THEN          /* IF IT WAS COMMENT OR A        */
         TM    COLONB,B'00100000'                                  0382
         BNZ   @RF00382                                            0382
*         COUNT=COUNT-ONCE;         /* SEPARATOR THEN THE CHAR.      */
         BCTR  COUNT,0                                             0383
*       RETURN;                     /* INDEX HAS TO BE BACKED UP     */
         B     @EL00005                                            0384
*     END;                          /* RETURN TO CALLER              */
*   IF OC=OPNINE THEN               /* IF CONTROL COMMAND            */
@RF00380 L     @14,ECDACNXT(,ECDAPTR)                              0386
         CLI   OC(@14),9                                           0386
         BNE   @RF00386                                            0386
*     IF OPAREN=ONSCPAREN=ONS THEN /* A CLOSE OR OPEN PAREN         */
         TM    OPAREN,B'11000000'                                  0387
         BZ    @RF00387                                            0387
*       DO;                         /* PROCESS                       */
*         COUNT=COUNT-ONE;          /* DECREMENT COUNT               */
         BCTR  COUNT,0                                             0389
*         RETURN;                   /* RETURN                        */
         B     @EL00005                                            0390
*       END;                        /* END                           */
*   LENTH=LENTH+ONCE;               /* LENGTH                        */
@RF00387 DS    0H                                                  0392
@RF00386 LA    @14,1                                               0392
         AL    @14,LENTH                                           0392
         ST    @14,LENTH                                           0392
*   IF NALPHNUM=ONS THEN            /* INDICATE THERE WAS A NON-     */
         TM    NALPHNUM,B'00000001'                                0393
         BNO   @RF00393                                            0393
*     NOTALPNU=ONS;                 /* ALPHANUMERIC                  */
         OI    NOTALPNU,B'10000000'                                0394
*   COUNT=COUNT+ONCE;               /* IF END NOT FOUND THEN UP      */
@RF00393 AL    COUNT,@CF00033                                      0395
*   GOTO NEXT;                      /* CHECK NEXT                    */
         B     NEXT                                                0396
*   END FINDEND;                                                   0397
         B     @EL00005                                            0397
*                                                                  0398
*/********************************************************************/
*/*                                                                  */
*/*     COMMENT  ROUTINE                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0398
*COMMENTS:                                                         0398
*   PROC;                                                          0398
*                                                                  0398
COMMENTS STM   @14,@01,12(@13)                                     0398
         STM   @03,@12,32(@13)                                     0398
*   /*****************************************************************/
*   /*                                                               */
*   /* WHEN A COMMENT HAS BEEN FOUND BY THE MAIN SCAN ROUTINE THIS   */
*   /* SUB-ROUTINE WILL SCAN TO THE END OF THE COMMENT OR TO THE END */
*   /* OF THE RECORD---WHICH EVER OCCURS FIRST.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*COMSCN:                                                           0399
*   COUNT=COUNT+ONCE;               /* INCREMENT TO NEXT CHARACTER   */
COMSCN   LA    @14,1                                               0399
         ALR   COUNT,@14                                           0399
*   IF COUNT=RLENGTH THEN           /* REACH END OF INPUT?           */
         C     COUNT,RLENGTH                                       0400
         BNE   @RF00400                                            0400
*     DO;                           /* YES-THEN RETURN---FIRST       */
*       COUNT=COUNT+ONCE;           /* CHARACHER THEN SET COUNT      */
         ALR   COUNT,@14                                           0402
*       RETURN;                     /* GREATER THAN RECLEN SO SCAN   */
@EL00006 DS    0H                                                  0403
@EF00006 DS    0H                                                  0403
@ER00006 LM    @14,@01,12(@13)                                     0403
         LM    @03,@12,32(@13)                                     0403
         BR    @14                                                 0403
*     END;                          /* WILL KNOW WE REACHED END      */
*   IF RECORD(COUNT:COUNT+ONE)=ASTSLASH THEN/* END OF COMMENT?       */
@RF00400 L     @14,SCANPTR                                         0405
         ALR   @14,COUNT                                           0405
         CLC   RECORD-1(2,@14),@CC00457                            0405
         BNE   @RF00405                                            0405
*     DO;                           /* YES---THEN SET COUNT TO END   */
*       COUNT=COUNT+TWO;            /* OF COMMENT AND RETURN         */
         AL    COUNT,@CF00074                                      0407
*       RETURN;                     /* RETURN                        */
         B     @EL00006                                            0408
*     END;                                                         0409
*   GOTO COMSCN;                    /* SCAN FURTHER                  */
         B     COMSCN                                              0410
*   END COMMENTS;                   /* END OF COMMENT ROUTINE        */
*                                                                  0412
*/********************************************************************/
*/*                                                                  */
*/*   PARAMETER LOCATE ROUTINE                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0412
*FINDPARM:                                                         0412
*   PROC;                                                          0412
FINDPARM STM   @14,@01,@SA00007                                    0412
         STM   @04,@12,@SA00007+16                                 0412
*CALLCHAR:                                                         0413
*   CALL CHARCHK;                   /* CALL CHARACTER CHECK ROUTINE  */
CALLCHAR BAL   @14,CHARCHK                                         0413
*   IF SEPAR=ON THEN                /* SEPARATOR FOUND?              */
         TM    SEPAR,B'00000100'                                   0414
         BNO   @RF00414                                            0414
*     DO;                           /* YES.                          */
*       COUNT=COUNT+ONE;            /* INCREMENT TO NEXT CHARACTER.  */
         AL    COUNT,@CF00033                                      0416
*       IF COUNT>RLENGTH THEN       /* AT END OF BUFFER?             */
         C     COUNT,RLENGTH                                       0417
         BH    @RT00417                                            0417
*         GOTO LEAVE;               /* YES--RETURN                   */
*       GOTO CALLCHAR;              /* NO--CHECK NEXT CHARACTER.     */
         B     CALLCHAR                                            0419
*     END;                                                         0420
*   IF SLASH=ON THEN                /* COMMENT FOUND?                */
@RF00414 TM    SLASH,B'00000010'                                   0421
         BNO   @RF00421                                            0421
*     DO;                           /* YES                           */
*       CALL COMMENTS;              /* CALL COMMENT ROUTINE          */
         BAL   @14,COMMENTS                                        0423
*       IF COUNT>RLENGTH THEN       /* AT END OF BUFFER ?            */
         C     COUNT,RLENGTH                                       0424
         BH    @RT00424                                            0424
*         GOTO LEAVE;               /* YES--RETURN                   */
*       GOTO CALLCHAR;              /* GO CHECK NEXT CHARACTER       */
         B     CALLCHAR                                            0426
*     END;                                                         0427
*LEAVE:                                                            0428
*   LINCOUNT=COUNT;                 /* CHAR INDEX AT END OF SCAN     */
@RF00421 DS    0H                                                  0428
LEAVE    LR    LINCOUNT,COUNT                                      0428
*   IF COUNT>RLENGTH THEN           /* IF AT END OF BUFFER           */
         C     COUNT,RLENGTH                                       0429
         BNH   @RF00429                                            0429
*     SEPS=ONS;                     /* ALL SEPARATORS                */
         OI    SEPS,B'10000000'                                    0430
*   ELSE                            /* ELSE                          */
*     IF OC=OPNINE THEN             /* CONTROL COMMAND ?             */
         B     @RC00429                                            0431
@RF00429 L     @14,ECDACNXT(,ECDAPTR)                              0431
         CLI   OC(@14),9                                           0431
         BNE   @RF00431                                            0431
*       DO;                         /* PROCESS                       */
*         LENTH=ZERO;               /* SET LENTH TO ONE              */
         SLR   @14,@14                                             0433
         ST    @14,LENTH                                           0433
*         IF OPAREN=ONSCPAREN=ONS THEN/* OPEN OR CLOSE PAREN        */
         TM    OPAREN,B'11000000'                                  0434
         BNZ   @RT00434                                            0434
*           RETURN;                 /* EXIT                          */
*         CALL FINDEND;             /* FIND END OF STRING            */
         BAL   @14,FINDEND                                         0436
*       END;                                                       0437
*   RETURN;                         /* RETURN                        */
@EL00007 DS    0H                                                  0438
@EF00007 DS    0H                                                  0438
@ER00007 LM    @14,@01,@SA00007                                    0438
         LM    @04,@12,@SA00007+16                                 0438
         BR    @14                                                 0438
*   END FINDPARM;                                                  0439
         B     @EL00007                                            0439
*                                                                  0440
*/********************************************************************/
*/*                                                                  */
*/*     IF  ROUTINE                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0440
*IFCMD:                                                            0440
*   PROC;                                                          0440
IFCMD    STM   @14,@03,@SA00008                                    0440
         STM   @05,@12,@SA00008+24                                 0440
*   OC=TWO;                         /* INITIALIZE OP CODE TO 2       */
         L     @14,ECDACNXT(,ECDAPTR)                              0441
         MVI   OC(@14),X'02'                                       0441
*   LINEPTR=ECDAIREC+FOUR;          /* INITIALIZE WORK POINTER       */
         LA    LINEPTR,4                                           0442
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0442
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* PAST CMD NAME AND LOOK FOR    */
*       -LINEPTR;                   /* PARAMETERS(FIRST NON-         */
         L     LINCOUNT,CMDADD                                     0443
         AL    LINCOUNT,CMDLEN                                     0443
         AL    LINCOUNT,@CF00033                                   0443
         SLR   LINCOUNT,LINEPTR                                    0443
*SCANIF:                                                           0444
*   IF LINCOUNT>RLENGTH THEN        /* SEPARATOR.LINCOUNT IS USED    */
SCANIF   C     LINCOUNT,RLENGTH                                    0444
         BNH   @RF00444                                            0444
*     DO;                           /* FOR STOPPING AT END OF        */
*BADIF:                                                            0446
*       EXMSGID=M533;               /* MESSAGE ID                    */
BADIF    MVC   EXMSGID(4),@CC00493                                 0446
*       STMT=ONS;                   /* STATEMENT NUMBERS REQUESTED   */
         OI    STMT,B'10000000'                                    0447
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0448
*       RCODE=ZERO;                 /* RECORD. IF NO PARAMETERS      */
         SLR   RCODE,RCODE                                         0449
*       NOTEXEC=ON;                 /* THEN ISSUE A MESSAGE,SET      */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0450
*EXIT1:                                                            0451
*       RETURN CODE(RCODE) TO SPCLEXIT;/* PROC NOT EXECUTABLE AND    */
EXIT1    LA    @14,SPCLEXIT                                        0451
         LR    @15,RCODE                                           0451
         LM    @00,@03,@SA00008+8                                  0451
         LM    @05,@12,@SA00008+24                                 0451
         BR    @14                                                 0451
*     END;                          /* RETURN                        */
*   COUNT=LINCOUNT;                 /* CHARACTER INDEX               */
@RF00444 LR    COUNT,LINCOUNT                                      0453
*   CALL FINDPARM;                  /* FINDPARM ROUTINE              */
         BAL   @14,FINDPARM                                        0454
*   IF LINCOUNT>RLENGTH THEN        /* PARAMETERS FOUND?             */
         C     LINCOUNT,RLENGTH                                    0455
         BH    @RT00455                                            0455
*     GOTO BADIF;                   /* NO -- INVALID IF COMMAND.     */
*   O2O2=LINCOUNT+SEVEN-ONE;        /* WHEN FIRST PARAMETER IS       */
         L     @14,ECDACNXT(,ECDAPTR)                              0457
         LR    @06,LINCOUNT                                        0457
         SL    @06,@CF00838                                        0457
         STH   @06,O2O2(,@14)                                      0457
*   LL=ELEVEN;                      /* FOUND PUT OFFSET IN RECORD    */
         MVC   LL(2,@14),@CH00392                                  0458
*   OO=CMDADD-LINEPTR+SEVEN;        /* SET LL TO 11 & PUT IN         */
         L     @06,CMDADD                                          0459
         SLR   @06,LINEPTR                                         0459
         AL    @06,@CF00149                                        0459
         STH   @06,OO(,@14)                                        0459
*   FALSEP=ZERO;                    /* OFFSET TO COMMAND NAME        */
         SLR   @06,@06                                             0460
         STCM  @06,15,FALSEP(@14)                                  0460
*THNAGN:                                                           0461
*   IF LINCOUNT+THREE>RLENGTH THEN  /* BAD IF --NO THEN              */
THNAGN   LA    @14,3                                               0461
         ALR   @14,LINCOUNT                                        0461
         C     @14,RLENGTH                                         0461
         BH    @RT00461                                            0461
*     GOTO BADIF;                   /* LEAVE                         */
*   IF LINE(LINCOUNT:LINCOUNT+ONE)=SLASHAST THEN/* COMMENT?          */
         LR    @14,LINEPTR                                         0463
         ALR   @14,LINCOUNT                                        0463
         BCTR  @14,0                                               0463
         CLC   LINE(2,@14),@CC00455                                0463
         BNE   @RF00463                                            0463
*     DO;                           /* YES--                         */
*       COUNT=LINCOUNT;             /* SET UP CHARACTER INDEX        */
         LR    COUNT,LINCOUNT                                      0465
*       CALL COMMENTS;              /* CALL COMMENT ROUTINE          */
         BAL   @14,COMMENTS                                        0466
*       LINCOUNT=COUNT;             /* INDEX PAST COMMENT            */
         LR    LINCOUNT,COUNT                                      0467
*       GOTO THNAGN;                /* GO CHECK FOR THEN             */
         B     THNAGN                                              0468
*     END;                                                         0469
*   IF LINE(LINCOUNT:LINCOUNT+THREE)^=/* NEXT LOCATE THE THEN WHICH  */
*       THENS THEN                  /* MARKS END OF FIRST RECORD     */
@RF00463 LR    @14,LINEPTR                                         0470
         ALR   @14,LINCOUNT                                        0470
         BCTR  @14,0                                               0470
         CLC   LINE(4,@14),@CC00398                                0470
         BE    @RF00470                                            0470
*     DO;                           /* TO BE SENT TO THE MOVE RTN    */
*TRYAGN:                                                           0472
*       LINCOUNT=LINCOUNT+ONE;      /* OTHERWISE UPDATE CHAR COUNT   */
TRYAGN   AL    LINCOUNT,@CF00033                                   0472
*       GOTO THNAGN;                /* THEN ISSUE A MESSAGE          */
         B     THNAGN                                              0473
*     END;                          /* SET PROC NOT EXECUTABLE AND 0474
*                                      RETURN. WHEN THEN IS FOUND    */
*   IF LINCOUNT+FOUR^>RLENGTH THEN  /* SEE IF NEXT CHARACTER IS      */
@RF00470 LA    @14,4                                               0475
         ALR   @14,LINCOUNT                                        0475
         C     @14,RLENGTH                                         0475
         BH    @RF00475                                            0475
*     DO;                           /* A SEPERATOR IF NOT AT END OF  */
*       COUNT=LINCOUNT+FOUR;        /* BUFFER.                       */
         LR    COUNT,@14                                           0477
*       CALL CHARCHK;               /* CALL CHARACTER CHECK ROUTINE  */
         BAL   @14,CHARCHK                                         0478
*       IF SEPAR=OFF&SLASH=OFF&OPAREN=OFF THEN/* COMMENT,SEPAR,(     */
         TM    SEPAR,B'00000110'                                   0479
         BNZ   @RF00479                                            0479
         TM    OPAREN,B'10000000'                                  0479
         BNZ   @RF00479                                            0479
*         IF ALPHA=ONSNUMERIC=ONS /* LOOK FOR EMBEDDED..   @ZA20629*/
*             CPAREN=ONS THEN       /* THEN IN VARIABLE NME  @ZA20629*/
         TM    ALPHA,B'11000000'                                   0480
         BNZ   @RT00480                                            0480
         TM    CPAREN,B'01000000'                                  0480
         BO    @RT00480                                            0480
*           GOTO TRYAGN;            /* LOOK FOR A REAL THEN  @ZA20629*/
*         ELSE                                                     0482
*           GOTO BADIF;             /* NO INVALID IF COMMAND @ZA20629*/
         B     BADIF                                               0482
*     END;                                                         0483
@RF00479 DS    0H                                                  0484
*   COUNT=LINCOUNT-ONE;             /* RESET COUNT                   */
@RF00475 LR    COUNT,LINCOUNT                                      0484
         BCTR  COUNT,0                                             0484
*   CALL CHARCHK;                   /* WHAT IS IT ?                  */
         BAL   @14,CHARCHK                                         0485
*   IF SEPAR=OFF&CPAREN=OFF&LINE(COUNT-ONE:COUNT)^=ASTSLASH THEN   0486
         TM    SEPAR,B'00000100'                                   0486
         BNZ   @RF00486                                            0486
         TM    CPAREN,B'01000000'                                  0486
         BNZ   @RF00486                                            0486
         LR    @14,LINEPTR                                         0486
         ALR   @14,COUNT                                           0486
         BCTR  @14,0                                               0486
         BCTR  @14,0                                               0486
         CLC   LINE(2,@14),@CC00457                                0486
         BNE   @RT00486                                            0486
*     GOTO TRYAGN;                  /* TRY AGAIN                     */
*   DATALEN=LINCOUNT+THREE;         /* COMPUTE LENGTH OF RECORD      */
@RF00486 LA    @14,3                                               0488
         ALR   @14,LINCOUNT                                        0488
         ST    @14,DATALEN                                         0488
*   DATAADD=LINEPTR;                /* FOR MOVE RTN.AND GET ADDR     */
         ST    LINEPTR,DATAADD                                     0489
*   CALL MOVERTN;                   /* OF DATA TO BE MOVED           */
         BAL   @14,MOVERTN                                         0490
*   RCODE=R15;                      /* SAVE RETURN CODE OF MOVERTN   */
         LR    RCODE,R15                                           0491
*   IF RCODE^=ZERO THEN             /* IF RCODE IS NON ZERO THEN     */
         LTR   RCODE,RCODE                                         0492
         BNZ   @RT00492                                            0492
*     GOTO EXIT1;                   /* RETURN WITH THE RETURN CODE TO
*                                      SPECIAL EXIT                  */
*   NEWSAVE=ECDACPRE;               /* SAVE ADDRESS OF IF STMT FOR 0494
*                                      FALSE PATH UPDATE             */
*                                                                  0494
         L     @14,ECDACPRE(,ECDAPTR)                              0494
         ST    @14,NEWSAVE                                         0494
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THE FIRST STORAGE RECORD HAS BEEN BUILT FOR THE */
*   /* IF STATEMENT. NEXT WE WILL BUILD A STORAGE RECORD FOR THE     */
*   /* OBJECT OF THE THEN. FIRST MAKE THE SECOND PART OF THE INPUT   */
*   /* RECORD LOOK LIKE ANY OTHER RECORD(FIRST 4 BYTES CONTAINING THE*/
*   /* LENGTH AND OFFSET OF THE RECORD) AND RE-INVOKE THE RECORD SCAN*/
*   /* ROUTINE. WHEN CONTROL IS RETURNED THE RECORD WILL HAVE BEEN   */
*   /* BUILT UNLESS AN ERROR HAS OCCURED.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0495
*   SAVEIREC=ECDAIREC;              /* SAVE IREC POINTER             */
         L     SAVEIREC,ECDAIREC(,ECDAPTR)                         0495
*   ECDAIREC=ADDR(LINE(LINCOUNT));  /* UPDATE POINTER IN COMMON      */
         LR    @14,LINEPTR                                         0496
         BCTR  @14,0                                               0496
         LA    @14,LINE(LINCOUNT,@14)                              0496
         ST    @14,ECDAIREC(,ECDAPTR)                              0496
*   ECDAIREC->OO=ECDAIREC-SAVEIREC; /* OFFSET BACK TO BEGIN BFR      */
         LR    @06,@14                                             0497
         SLR   @06,SAVEIREC                                        0497
         STH   @06,OO(,@14)                                        0497
*   ECDAIREC->RECLEN=               /* DATA AREA. RECORD HEADER      */
*       RECLEN-(LINCOUNT+FOUR-ONE); /* WILL OVERLAY THE THEN         */
         LR    @06,LINCOUNT                                        0498
         SL    @06,@CF00839                                        0498
         LCR   @06,@06                                             0498
         L     @05,SCANPTR                                         0498
         AH    @06,RECLEN(,@05)                                    0498
         STH   @06,RECLEN(,@14)                                    0498
*   PARMS=PARMS&&PARMS;             /* BUILD IKJCT432 PARM LIST      */
         XC    PARMS(12),PARMS                                     0499
*   PARM1=ECDAPTR;                  /* ZERO PARM TWO                 */
         ST    ECDAPTR,PARM1                                       0500
*   RFY                                                            0501
*    (R1) RSTD;                     /* RESTRICT REG 1                */
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */
         LA    R1,PARMS                                            0502
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */
         L     @15,@CA00028                                        0503
         BALR  @14,@15                                             0503
*   RFY                                                            0504
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */
*   RCODE=R15;                      /* IF RCODE IS GREATER THAN 8    */
         LR    RCODE,R15                                           0505
*   IF RCODE^=ZERO THEN             /* THEN RETURN TO SPECIAL        */
         LTR   RCODE,RCODE                                         0506
         BZ    @RF00506                                            0506
*     DO;                           /* EXIT                          */
*       IF RCODE=FOUR THEN          /* UPDATE FALSE PATH PTR ON      */
         C     RCODE,@CF00072                                      0508
         BNE   @RF00508                                            0508
*         NEWSAVE->FALSEP=ECDACNXT; /* END OF FILE                   */
         L     @14,NEWSAVE                                         0509
         MVC   FALSEP(4,@14),ECDACNXT(ECDAPTR)                     0509
*       GOTO OUT;                                                  0510
         B     OUT                                                 0510
*     END;                                                         0511
*   IF RETFLAG2=ONS THEN            /* IF A DO LOOP MUST BE CLOSED   */
@RF00506 TM    RETFLAG2,B'00100000'                                0512
         BNO   @RF00512                                            0512
*     DO;                           /* BEFORE CONTINUING THEN RETURN */
*       RETFLAG=ONS;                /* PROPAGATING FLAGS             */
         OI    RETFLAG(PARMPTR),B'00100000'                        0514
*       IF ENDFLAG2=ONS THEN        /* END FLAG                      */
         TM    ENDFLAG2,B'10000000'                                0515
         BNO   @RF00515                                            0515
*         ENDFLAG=ONS;              /* ON                            */
         OI    ENDFLAG(PARMPTR),B'10000000'                        0516
*       NEWSAVE->FALSEP=FALEND2;    /* UPDATE FALSE PATH TO END STMT */
@RF00515 L     @14,FALEND2                                         0517
         L     @06,NEWSAVE                                         0517
         STCM  @14,15,FALSEP(@06)                                  0517
*       FALEND=FALEND2;             /* PROPAGATE FALSE PATH END      */
         ST    @14,FALEND(,PARMPTR)                                0518
*       GOTO OUT;                   /* LEAVE                         */
         B     OUT                                                 0519
*     END;                                                         0520
*                                                                  0520
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THE ENTIRE IF COMMAND HAS BEEN PROCESSED. THE   */
*   /* COMMON DATA AREA POINTERS HAVE BEEN UPDATED AND THE ONLY      */
*   /* REQUIREMENT LEFT IS TO BUILD AN INTERNAL GOTO WHICH WILL BE   */
*   /* NEEDED IN THE EVENT THE NEXT INPUT RECORD IS AN ELSE COMMAND. */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0521
*   LL=ELEVEN;                      /* LENGTH OF INTERNAL GOTO       */
@RF00512 L     @14,ECDACNXT(,ECDAPTR)                              0521
         MVC   LL(2,@14),@CH00392                                  0521
*   OO=SEVEN;                       /* 11 IS ALSO OFFSET FOR CMD     */
         LA    @06,7                                               0522
         STH   @06,OO(,@14)                                        0522
*   O2O2=SEVEN;                     /* NAME AND PARM FIELD           */
         STH   @06,O2O2(,@14)                                      0523
*   OC=GOCODE;                      /* PUT IN OP CODE                */
         MVI   OC(@14),X'0F'                                       0524
*   DATAADD=ZERO;                   /* ZERO OUT MOVE PARM LIST       */
         SLR   @14,@14                                             0525
         ST    @14,DATAADD                                         0525
*   DATALEN=ZERO;                   /* MOVE WILL NOT MOVE ANYTHING   */
         ST    @14,DATALEN                                         0526
*   CALL MOVERTN;                   /* BUT WILL JUST UPDATE PTRS     */
         BAL   @14,MOVERTN                                         0527
*   RCODE=R15;                      /* DID MOVE GO OK ?              */
         LR    RCODE,R15                                           0528
*   IF RCODE^=ZERO THEN             /* NO--- THEN RETURN             */
         LTR   RCODE,RCODE                                         0529
         BNZ   @RT00529                                            0529
*     GOTO EXIT1;                   /* LEAVE                         */
*   ECDACPRE->FALSEP=ECDACNXT;      /* UPDATE INTERNAL GOTO ADDRESS  */
         L     @14,ECDACPRE(,ECDAPTR)                              0531
         L     @06,ECDACNXT(,ECDAPTR)                              0531
         STCM  @06,15,FALSEP(@14)                                  0531
*   NEWSAVE->FALSEP=ECDACNXT;       /* UPDATE IF STMT FALSE PATH     */
         L     @14,NEWSAVE                                         0532
         STCM  @06,15,FALSEP(@14)                                  0532
*   RCODE=ZERO;                     /* ZERO RETCODE                  */
*                                                                  0533
         SLR   RCODE,RCODE                                         0533
*   /*****************************************************************/
*   /*                                                               */
*   /* GETALINE WILL BE USED IN ORDER TO ASSURE THAT FALSE PATH      */
*   /* POINTERS ARE CORRECT FOR NESTED IF GROUPS                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0534
*   NULINE=ONS;                     /* SET NULLINE TO FORCE ONE    0534
*                                      EXECUTION MINIMUM     @ZA05505*/
         OI    NULINE,B'00001000'                                  0534
*   DO WHILE(NULINE=ONS);           /* SKIP TO NEXT COMMAND  @ZA05505*/
         B     @DE00535                                            0535
@DL00535 DS    0H                                                  0536
*     NULINE=OFF;                   /* RESET NULL LINE SWITCH - IT 0536
*                                      WILL BE SET AGAIN IF RECORD 0536
*                                      READ IS A NULL LINE   @ZA05505*/
         NI    NULINE,B'11110111'                                  0536
*     CALL GETALINE;                /* CALL GETALINE ROUTINE         */
         BAL   @14,GETALINE                                        0537
*     RCODE=R15;                    /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0538
*     IF RCODE^=ZERO THEN           /* RETURN CODE ZERO?             */
         SLR   @14,@14                                             0539
         CR    RCODE,@14                                           0539
         BNE   @RT00539                                            0539
*       GOTO OUT;                   /* NO---RETURN                   */
*     SAVENEXT=ECDACNXT;            /* SAVE NEXT RECORD ADDR         */
         L     SAVENEXT,ECDACNXT(,ECDAPTR)                         0541
*     PARM1=ECDAPTR;                /* SET UP 432 PARM LIST          */
         ST    ECDAPTR,PARM1                                       0542
*     PARM2=ZERO;                   /*                               */
         ST    @14,PARM2                                           0543
*     IFFLAG2=ON;                   /* INDICATE IF TO ELSE CMD.      */
         OI    IFFLAG2,B'01000000'                                 0544
*     RFY                                                          0545
*      (R1) RSTD;                   /* RESTRICT REG 1                */
*     R1=ADDR(PARMS);               /* ADDR OF PARM LIST             */
         LA    R1,PARMS                                            0546
*     CALL IKJCT432;                /* CALL 432                      */
         L     @15,@CA00028                                        0547
         BALR  @14,@15                                             0547
*     RFY                                                          0548
*      (R1) UNRSTD;                 /* RELEASE                       */
*     RCODE=R15;                    /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0549
*     IF ELSFLAG2=OFFRETFLAG2=ONS THEN/* PROPAGATE FLAG IF THE      */
         TM    RETFLAG2,B'00100000'                                0550
         BNZ   @RT00550                                            0550
         TM    ELSFLAG2,B'00010000'                                0550
         BO    @RF00550                                            0550
@RT00550 DS    0H                                                  0551
*       DO;                         /* STMT WAS AN END STMT          */
*         RETFLAG=ONS;              /* INDICATE A DO LOOP MUST BE    */
         OI    RETFLAG(PARMPTR),B'00100000'                        0552
*         IF ENDFLAG2=ONS THEN                                     0553
         TM    ENDFLAG2,B'10000000'                                0553
         BNO   @RF00553                                            0553
*           ENDFLAG=ONS;            /* CLOSED                        */
         OI    ENDFLAG(PARMPTR),B'10000000'                        0554
*         IF ELSFLAG2=ONS THEN      /* SET FALSE PATH END            */
@RF00553 TM    ELSFLAG2,B'00010000'                                0555
         BNO   @RF00555                                            0555
*           FALEND=FALEND2;                                        0556
         L     @14,FALEND2                                         0556
         ST    @14,FALEND(,PARMPTR)                                0556
*         ELSE                      /* TO THE LOGICAL END            */
*           FALEND=SAVENEXT;                                       0557
         B     @RC00555                                            0557
@RF00555 ST    SAVENEXT,FALEND(,PARMPTR)                           0557
*       END;                                                       0558
@RC00555 DS    0H                                                  0559
*   END;                            /*                       @ZA05505*/
@RF00550 DS    0H                                                  0559
@DE00535 TM    NULINE,B'00001000'                                  0559
         BO    @DL00535                                            0559
*OUT:                                                              0560
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN TO SPECIAL EXIT        */
OUT      LA    @14,SPCLEXIT                                        0560
         LR    @15,RCODE                                           0560
         LM    @00,@03,@SA00008+8                                  0560
         LM    @05,@12,@SA00008+24                                 0560
         BR    @14                                                 0560
*   END IFCMD;                                                     0561
*                                                                  0562
*/********************************************************************/
*/*                                                                  */
*/*     ELSE  ROUTINE                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0562
*ELSECMD:                                                          0562
*   PROC;                                                          0562
ELSECMD  STM   @14,@03,@SA00009                                    0562
         STM   @05,@12,@SA00009+24                                 0562
*   TRUESAV=ECDACPRE;               /* SAVE PTR TO PREVIOUS RECORD   */
         L     TRUESAV,ECDACPRE(,ECDAPTR)                          0563
*   IF IFFLAG=OFF THEN              /* WAS IT AN IF COMMAND?         */
         TM    IFFLAG(PARMPTR),B'01000000'                         0564
         BNZ   @RF00564                                            0564
*     DO;                           /* --IF NOT IT IS AN ERROR       */
*       EXMSGID=M534;               /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00495                                 0566
*       MVAR(2)=ADDR(CELSE);        /* ELSE INSERT                   */
         LA    @14,@CC00529                                        0567
         ST    @14,MVAR+4                                          0567
*       MVARLEN(2)=LENGTH(CELSE);   /* LENGTH                        */
         MVI   MVARLEN+4,X'04'                                     0568
*       MVAR(3)=ADDR(CIF);          /* IF INSERT                     */
         LA    @14,@CC00527                                        0569
         ST    @14,MVAR+8                                          0569
*       MVARLEN(3)=LENGTH(CIF);     /* LENGTH OF INSERT              */
         MVI   MVARLEN+8,X'02'                                     0570
*       STMT=ONS;                   /* STATEMENT NUMBER REQUESTED    */
         OI    STMT,B'10000000'                                    0571
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0572
*       RCODE=ZERO;                 /* ISSUE A MESSAGE TO USER       */
         SLR   RCODE,RCODE                                         0573
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE AND   */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0574
*BADELSE:                                                          0575
*       RETURN CODE(RCODE)          /* RETURN VIA THE SPECIAL EXIT   */
*           TO SPCLEXIT;            /*                               */
BADELSE  LA    @14,SPCLEXIT                                        0575
         LR    @15,RCODE                                           0575
         LM    @00,@03,@SA00009+8                                  0575
         LM    @05,@12,@SA00009+24                                 0575
         BR    @14                                                 0575
*     END;                                                         0576
*   ELSFLAG=ONS;                    /* ELSE STMT PROCESSED           */
@RF00564 OI    ELSFLAG(PARMPTR),B'00010000'                        0577
*   OC=THREE;                       /* PUT OPCODE IN RECORD PREFIX   */
         L     @14,ECDACNXT(,ECDAPTR)                              0578
         MVI   OC(@14),X'03'                                       0578
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* PUT IN OFFSET TO ELSE         */
         L     @06,CMDADD                                          0579
         LA    @04,4                                               0579
         L     @03,ECDAIREC(,ECDAPTR)                              0579
         ALR   @03,@04                                             0579
         LR    @02,@06                                             0579
         SLR   @02,@03                                             0579
         AL    @02,@CF00250                                        0579
         STH   @02,OO(,@14)                                        0579
*   O2O2=OO+FOUR;                   /* OFFSET PAST ELSE              */
         ALR   @02,@04                                             0580
         STH   @02,O2O2(,@14)                                      0580
*   LL=SEVEN;                       /* LENGTH OF PREFIX              */
         MVC   LL(2,@14),@CH00149                                  0581
*   DATAADD=ECDAIREC+FOUR;          /* ADDRESS OF ELSE FOR MOVERTN   */
         ST    @03,DATAADD                                         0582
*   DATALEN=(CMDADD+FOUR)-DATAADD;  /* LENGTH OF MOVE                */
         ALR   @06,@04                                             0583
         SLR   @06,@03                                             0583
         ST    @06,DATALEN                                         0583
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */
         BAL   @14,MOVERTN                                         0584
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0585
*   IF RCODE^=ZERO THEN             /* IF OTHER THAN ZERO THEN       */
         LTR   RCODE,RCODE                                         0586
         BNZ   @RT00586                                            0586
*     GOTO BADELSE;                 /* RETURN                        */
*                                                                  0587
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THE ELSE PORTION OF THE COMMAND HAS BEEN        */
*   /* PROCESSED. NEXT SET UP THE INPUT RECORD AND CALL THE RECORD   */
*   /* SCAN ROUTINE TO PROCESS THE OBJECT OF THE ELSE.               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0588
*   CMDADD->RECLEN=RECLEN-(CMDADD-ECDAIREC);/* START AT ELSE. LENGTH */
         L     @14,CMDADD                                          0588
         L     @06,ECDAIREC(,ECDAPTR)                              0588
         LR    @03,@14                                             0588
         SLR   @03,@06                                             0588
         L     @01,SCANPTR                                         0588
         LH    @01,RECLEN(,@01)                                    0588
         SLR   @01,@03                                             0588
         STH   @01,RECLEN(,@14)                                    0588
*   SAVEIREC=ECDAIREC;              /* SAVE IREC POINTER             */
         LR    SAVEIREC,@06                                        0589
*   CMDADD->OO=CMDADD-ECDAIREC;     /* OFFSET TO BEGIN OF BFR        */
         STH   @03,OO(,@14)                                        0590
*   ECDAIREC=CMDADD;                /* UPDATE INPUT POINTER          */
         ST    @14,ECDAIREC(,ECDAPTR)                              0591
*   PARMS=PARMS&&PARMS;             /* BUILD PARM LIST               */
         XC    PARMS(12),PARMS                                     0592
*   PARM1=ECDAPTR;                  /* ZERO PARM TWO                 */
         ST    ECDAPTR,PARM1                                       0593
*   RFY                                                            0594
*    (R1) RSTD;                     /* RESTRICT REG 1                */
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */
         LA    R1,PARMS                                            0595
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */
         L     @15,@CA00028                                        0596
         BALR  @14,@15                                             0596
*   RFY                                                            0597
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0598
*   IF RCODE<=FOUR THEN             /* IF RETURN CODE IS NOT LESS    */
         C     RCODE,@CF00072                                      0599
         BH    @RF00599                                            0599
*     DO;                           /* THAN FOUR THEN RETURN         */
*       IF RETFLAG2=ONS THEN        /* PROPAGATE END OF DO LOOP FLAG */
         TM    RETFLAG2,B'00100000'                                0601
         BNO   @RF00601                                            0601
*         DO;                                                      0602
*           RETFLAG=ONS;            /* IF ON                         */
         OI    RETFLAG(PARMPTR),B'00100000'                        0603
*           IF ENDFLAG2=ONS THEN                                   0604
         TM    ENDFLAG2,B'10000000'                                0604
         BNO   @RF00604                                            0604
*             ENDFLAG=ONS;          /* PROP END FLAG IF ON           */
         OI    ENDFLAG(PARMPTR),B'10000000'                        0605
*           FALEND=FALEND2;         /* PROPAGATE THE FALSE PATH END  */
@RF00604 L     @14,FALEND2                                         0606
         ST    @14,FALEND(,PARMPTR)                                0606
*           TRUESAV->FALSEP=FALEND2;/* SET TO LAST STMT PROCESSED    */
         STCM  @14,15,FALSEP(TRUESAV)                              0607
*         END;                                                     0608
*       ELSE                        /* OTHERWISE SET TO NEXT STMT    */
*         TRUESAV->FALSEP=ECDACNXT; /* SAVE ADDR                     */
         B     @RC00601                                            0609
@RF00601 MVC   FALSEP(4,TRUESAV),ECDACNXT(ECDAPTR)                 0609
*     END;                                                         0610
@RC00601 DS    0H                                                  0611
*   RETURN CODE(RCODE) TO SPCLEXIT; /* ADDRESS IN PREVIOUS RECORD AND
*                                      RETURN                        */
@RF00599 LA    @14,SPCLEXIT                                        0611
         LR    @15,RCODE                                           0611
         LM    @00,@03,@SA00009+8                                  0611
         LM    @05,@12,@SA00009+24                                 0611
         BR    @14                                                 0611
*   END ELSECMD;                                                   0612
*                                                                  0613
*/********************************************************************/
*/*                                                                  */
*/*     COMMON (TSO)  ROUTINE                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0613
*COMCMD:                                                           0613
*   PROC;                                                          0613
COMCMD   STM   @14,@12,@SA00010                                    0613
*   LL=SEVEN;                       /* UPDATE LL FIELD               */
         L     @14,ECDACNXT(,ECDAPTR)                              0614
         MVC   LL(2,@14),@CH00149                                  0614
*   OO=CMDADD-ECDAIREC-FOUR+THREE;  /* UPDATE OO FIELD WHICH         */
         L     @08,CMDADD                                          0615
         L     @06,ECDAIREC(,ECDAPTR)                              0615
         LR    @04,@08                                             0615
         SLR   @04,@06                                             0615
         BCTR  @04,0                                               0615
         STH   @04,OO(,@14)                                        0615
*   O2O2=ZERO;                      /* IS OFFSET TO COMMAND NAME NEXT
*                                      UPDATE O2O2 WHICH IS          */
         SLR   @04,@04                                             0616
         STH   @04,O2O2(,@14)                                      0616
*   LINEPTR=ECDAIREC+FOUR;          /* OFFSET TO FIRST PARAMETER     */
         AL    @06,@CF00072                                        0617
         LR    LINEPTR,@06                                         0617
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* FIRST GET BEGINNING OF        */
*       -LINEPTR;                   /* SEARCH.(LINCOUNT)             */
         AL    @08,CMDLEN                                          0618
         AL    @08,@CF00033                                        0618
         SLR   @08,LINEPTR                                         0618
         LR    LINCOUNT,@08                                        0618
*SCANER:                                                           0619
*   IF LINCOUNT>RLENGTH THEN        /* IF NO PARMS THEN SET O2O2     */
SCANER   C     LINCOUNT,RLENGTH                                    0619
         BNH   @RF00619                                            0619
*     DO;                           /* TO END OF BUFFER              */
*SET02:                                                            0621
*       O2O2=LINCOUNT+THREE-ONE;    /*                               */
SET02    L     @14,ECDACNXT(,ECDAPTR)                              0621
         LR    @08,LINCOUNT                                        0621
         SL    @08,@CF00840                                        0621
         STH   @08,O2O2(,@14)                                      0621
*       GOTO COMRET;                /* AND RETURN                    */
         B     COMRET                                              0622
*     END;                                                         0623
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */
@RF00619 LR    COUNT,LINCOUNT                                      0624
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */
         BAL   @14,FINDPARM                                        0625
*   O2O2=LINCOUNT+THREE-ONE;        /* HAVE FOUND FIRST PARM ADD3 FOR
*                                      CORRECT OFFSET                */
*                                                                  0626
         L     @14,ECDACNXT(,ECDAPTR)                              0626
         LR    @08,LINCOUNT                                        0626
         SL    @08,@CF00840                                        0626
         STH   @08,O2O2(,@14)                                      0626
*   /*****************************************************************/
*   /*                                                               */
*   /* IF COMMAND IS WRITE OR WRITER THEN HAVE O2O2 POINT IMMEDIATELY*/
*   /* AFTER THE COMMAND NAME.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0627
*COMRET:                                                           0627
*   IF OC=OPFOUROC=OPFIVE THEN                                    0627
COMRET   L     @14,ECDACNXT(,ECDAPTR)                              0627
         CLI   OC(@14),4                                           0627
         BE    @RT00627                                            0627
         CLI   OC(@14),5                                           0627
         BNE   @RF00627                                            0627
@RT00627 DS    0H                                                  0628
*     DO;                           /* PROCESS WRITE O2O2            */
*       COUNT=OO+CMDLEN-TWO;        /* POINT AFTER CMDNAME           */
         L     @14,ECDACNXT(,ECDAPTR)                              0629
         LH    @08,OO(,@14)                                        0629
         AL    @08,CMDLEN                                          0629
         LR    COUNT,@08                                           0629
         BCTR  COUNT,0                                             0629
         BCTR  COUNT,0                                             0629
*       IF COUNT>RLENGTH THEN       /* IF AT END OF BFR              */
         C     COUNT,RLENGTH                                       0630
         BNH   @RF00630                                            0630
*         O2O2=OO+CMDLEN;           /* AFTER COMMAND NAME            */
         STH   @08,O2O2(,@14)                                      0631
*       ELSE                        /* OTHERWISE                     */
*         DO;                                                      0632
         B     @RC00630                                            0632
@RF00630 DS    0H                                                  0633
*           O2O2=COUNT+THREE;       /* INIT O2O2                     */
         L     @14,ECDACNXT(,ECDAPTR)                              0633
         LA    @08,3                                               0633
         ALR   @08,COUNT                                           0633
         STH   @08,O2O2(,@14)                                      0633
*           IF LINE(COUNT:COUNT+ONE)=SLASHAST THEN/* IF AN OPEN    0634
*                                      COMMENT                       */
         LR    @14,LINEPTR                                         0634
         ALR   @14,COUNT                                           0634
         BCTR  @14,0                                               0634
         CLC   LINE(2,@14),@CC00455                                0634
         BNE   @RF00634                                            0634
*             DO;                   /*                               */
*               CALL COMMENTS;      /* SKIP COMMENTS                 */
         BAL   @14,COMMENTS                                        0636
*               O2O2=COUNT+TWO;     /* SET TO END OF BFR             */
         L     @14,ECDACNXT(,ECDAPTR)                              0637
         LA    @08,2                                               0637
         ALR   @08,COUNT                                           0637
         STH   @08,O2O2(,@14)                                      0637
*             END;                                                 0638
*         END;                                                     0639
@RF00634 DS    0H                                                  0640
*     END;                                                         0640
@RC00630 DS    0H                                                  0641
*   IF OC=ZERO THEN                 /* IF TSO COMMAND,MAKE O2O2 SAME */
@RF00627 L     @14,ECDACNXT(,ECDAPTR)                              0641
         CLI   OC(@14),0                                           0641
         BNE   @RF00641                                            0641
*     O2O2=OO;                      /* AS OO                         */
         LH    @08,OO(,@14)                                        0642
         STH   @08,O2O2(,@14)                                      0642
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF DATA FOR MOVE RTN     */
@RF00641 LA    @14,4                                               0643
         AL    @14,ECDAIREC(,ECDAPTR)                              0643
         ST    @14,DATAADD                                         0643
*   DATALEN=RLENGTH;                /* LENGTH OF DATA TO BE MOVED    */
         L     @14,RLENGTH                                         0644
         ST    @14,DATALEN                                         0644
*   RETURN CODE(ZERO);              /* RETURN (MOVE DONE AT EXIT)    */
         SLR   @15,@15                                             0645
         L     @14,@SA00010                                        0645
         LM    @00,@12,@SA00010+8                                  0645
         BR    @14                                                 0645
*   END COMCMD;                                                    0646
*                                                                  0647
*/********************************************************************/
*/*                                                                  */
*/*     END  ROUTINE                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0647
*ENDCMD:                                                           0647
*   PROC;                                                          0647
ENDCMD   STM   @14,@12,@SA00011                                    0647
*   ECDANDO=ECDANDO-ONE;            /* LOWER THE DO COUNT BY 1       */
         LH    @14,ECDANDO(,ECDAPTR)                               0648
         BCTR  @14,0                                               0648
         STH   @14,ECDANDO(,ECDAPTR)                               0648
*   IF ECDANDO<ZERO THEN            /* IF DO COUNT GOES NEGATIVE     */
         LTR   @14,@14                                             0649
         BNM   @RF00649                                            0649
*     DO;                           /* THEN ASSUME IT IS A TSO CMD   */
*       IF CMDLEN^=THREE           /* OR AN ALTERNATE END. AN       */
*           COMMAND(1:THREE)^=CEND THEN/* ALTERNATE END AND NO OPEN  */
         CLC   CMDLEN(4),@CF00250                                  0651
         BNE   @RT00651                                            0651
         L     @14,CMDADD                                          0651
         CLC   COMMAND(3,@14),@CC00187                             0651
         BE    @RF00651                                            0651
@RT00651 DS    0H                                                  0652
*         DO;                       /* DO IS ILLEGAL. ISSUE A MESSAGE*/
*           EXMSGID=M534;           /* TO THE USER                   */
         MVC   EXMSGID(4),@CC00495                                 0653
*           MVAR(2)=ADDR(ECDAAEND); /* POINT TO ALTERNATE END        */
         LA    @14,ECDAAEND(,ECDAPTR)                              0654
         ST    @14,MVAR+4                                          0654
*           MVARLEN(2)=ECDAELNG;    /* LENGTH OF ALTERNATE END       */
         LH    @14,ECDAELNG(,ECDAPTR)                              0655
         STC   @14,MVARLEN+4                                       0655
*           MVAR(3)=ADDR(CDO);      /* POINT TO DO                   */
         LA    @14,@CC00412                                        0656
         ST    @14,MVAR+8                                          0656
*           MVARLEN(3)=LENGTH(CDO); /* LENGTH OF DO                  */
         MVI   MVARLEN+8,X'02'                                     0657
*           STMT=ONS;               /* STATEMENT NUMBERS REQ         */
         OI    STMT,B'10000000'                                    0658
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0659
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0660
*           RETURN CODE(ZERO) TO SPCLEXIT;/* AND RETURN              */
         LA    @14,SPCLEXIT                                        0661
         SLR   @15,@15                                             0661
         LM    @00,@12,@SA00011+8                                  0661
         BR    @14                                                 0661
*         END;                                                     0662
*       ECDANDO=ZERO;               /* IF IT IS A TSO COMMAND        */
@RF00651 SLR   @14,@14                                             0663
         STH   @14,ECDANDO(,ECDAPTR)                               0663
*       CALL COMCMD;                /* ZERO THE DO COUNT,CALL        */
         BAL   @14,COMCMD                                          0664
*       RETURN;                     /* RETURN                        */
@EL00011 DS    0H                                                  0665
@EF00011 DS    0H                                                  0665
@ER00011 LM    @14,@12,@SA00011                                    0665
         BR    @14                                                 0665
*     END;                          /* COMCMD (TSO) AND RETURN       */
*                                                                  0666
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT IT IS KNOWN THAT THE COMMAND IS A VALID END OR  */
*   /* ALTERNATE END COMMAND                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0667
*   ENDFLAG=ON;                     /* SET END FLAG FOR DO ROUTINE   */
@RF00649 OI    ENDFLAG(PARMPTR),B'10000000'                        0667
*   OC=OPEIGHT;                     /* SET OPCODE IN DATA AREA       */
         L     @14,ECDACNXT(,ECDAPTR)                              0668
         MVI   OC(@14),X'08'                                       0668
*   O2O2=RLENGTH+THREE;             /* SET OFFSET TO END OF RECORD   */
         L     @06,RLENGTH                                         0669
         LA    @05,3                                               0669
         LR    @04,@06                                             0669
         ALR   @04,@05                                             0669
         STH   @04,O2O2(,@14)                                      0669
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* SET OFFSET TO E IN END        */
         LA    @04,4                                               0670
         AL    @04,ECDAIREC(,ECDAPTR)                              0670
         L     @03,CMDADD                                          0670
         SLR   @03,@04                                             0670
         ALR   @03,@05                                             0670
         STH   @03,OO(,@14)                                        0670
*   LL=SEVEN;                       /* LENGTH OF PREFIX              */
         MVC   LL(2,@14),@CH00149                                  0671
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF END OR MOVE RTN       */
         ST    @04,DATAADD                                         0672
*   DATALEN=RLENGTH;                /* LENGTH OF END FOR MOVE        */
         ST    @06,DATALEN                                         0673
*   END ENDCMD;                     /* END OF END ROUTINE            */
         B     @EL00011                                            0674
*                                                                  0675
*/********************************************************************/
*/*                                                                  */
*/*     DO  ROUTINE                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0675
*DOCMD:                                                            0675
*   PROC;                                                          0675
DOCMD    STM   @14,@03,@SA00012                                    0675
         STM   @05,@12,@SA00012+24                                 0675
*   OC=OPSEVEN;                     /* INIT OPCODE FIELD             */
         L     @14,ECDACNXT(,ECDAPTR)                              0676
         MVI   OC(@14),X'07'                                       0676
*   FLGS=ZERO;                      /* ZERO OUT FLAG FIELD           */
         MVI   FLGS(@14),X'00'                                     0677
*   ECDANDO=ECDANDO+ONE;            /* UPDATE DO COUNT BY 1          */
*                                                                  0678
         LA    @08,1                                               0678
         LH    @06,ECDANDO(,ECDAPTR)                               0678
         ALR   @06,@08                                             0678
         STH   @06,ECDANDO(,ECDAPTR)                               0678
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT DETERMINE IF THIS IS A SIMPLE DO STATEMENT OR A DO WHILE */
*   /* STATEMENT. FOR A DO WHILE THE WHOLE STATEMENT WILL BE MOVED   */
*   /* INTO THE CLIST PARM AREA(INCLUDING THE OBJECT OF THE WHILE    */
*   /* STATEMENT)--OTHERWISE JUST THE DO WILL BE MOVED               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0679
*   LINEPTR=ECDAIREC+FOUR;          /* FIND FIRST NON-SEPARATOR      */
         LA    LINEPTR,4                                           0679
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0679
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* AFTER DO AND SEE IF IT IS     */
*       -LINEPTR;                   /* A WHILE STATEMENT             */
         L     LINCOUNT,CMDADD                                     0680
         AL    LINCOUNT,CMDLEN                                     0680
         ALR   LINCOUNT,@08                                        0680
         SLR   LINCOUNT,LINEPTR                                    0680
*   LL=EIGHT;                       /* LENGTH OF PREFIX              */
         MVC   LL(2,@14),@CH00088                                  0681
*SCANDO:                                                           0682
*   IF LINCOUNT>RLENGTH THEN        /* DO NOT GO PAST END OF         */
SCANDO   C     LINCOUNT,RLENGTH                                    0682
         BNH   @RF00682                                            0682
*     DO;                           /* RECORD.                       */
*SCANDO2:                                                          0684
*       IF FLGS=EIGHTY THEN         /* END. IF DO WHILE AND NO       */
SCANDO2  L     @14,ECDACNXT(,ECDAPTR)                              0684
         CLI   FLGS(@14),128                                       0684
         BNE   @RF00684                                            0684
*         DO;                       /* OPERANDS THEN NOTIFY USER AND */
*           EXMSGID=M536;           /* TREAT AS NORMAL               */
         MVC   EXMSGID(4),@CC00497                                 0686
*           STMT=ONS;               /* STMATMENT NUMBERS REQUIRED    */
         OI    STMT,B'10000000'                                    0687
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0688
*           FLGS=ZERO;              /* END STATEMENT.                */
         L     @14,ECDACNXT(,ECDAPTR)                              0689
         MVI   FLGS(@14),X'00'                                     0689
*           LL=EIGHT;               /* LENGTH OF REC PREFIX          */
         MVC   LL(2,@14),@CH00088                                  0690
*         END;                                                     0691
*       GOTO REGDO;                 /* RECORD.IF END IS REACHED      */
         B     REGDO                                               0692
*     END;                                                         0693
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */
@RF00682 LR    COUNT,LINCOUNT                                      0694
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */
         BAL   @14,FINDPARM                                        0695
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER            */
         L     @14,RLENGTH                                         0696
         CR    LINCOUNT,@14                                        0696
         BH    @RT00696                                            0696
*     GOTO SCANDO2;                 /* YES--THEN BRANCH              */
*   IF FLGS=EIGHTY THEN             /* WAS SCAN FOR WHILE PARMS?     */
         L     @08,ECDACNXT(,ECDAPTR)                              0698
         CLI   FLGS(@08),128                                       0698
         BE    @RT00698                                            0698
*     GOTO REGDO;                   /* YES--RETURN TO WHILE CODE     */
*   IF LINCOUNT+FOUR>RLENGTH THEN   /* ARE NON-SEPARATORS A WHILE?   */
         LA    @06,4                                               0700
         ALR   @06,LINCOUNT                                        0700
         CR    @06,@14                                             0700
         BH    @RT00700                                            0700
*     GOTO DOBAD;                   /* PUT OUT WARNING MSG   @ZM30996*/
*   IF LINE(LINCOUNT:LINCOUNT+FOUR)=/* MATCH ON WHILE?               */
*       WHILES THEN                 /*                               */
         LR    @14,LINEPTR                                         0702
         ALR   @14,LINCOUNT                                        0702
         BCTR  @14,0                                               0702
         CLC   LINE(5,@14),@CC00430                                0702
         BNE   @RF00702                                            0702
*     DO;                           /* YES--IT IS A DO WHILE         */
*       FALSEP2=ZERO;               /* RESERVE FALSE APTH ADDR       */
         SLR   @14,@14                                             0704
         STCM  @14,15,FALSEP2(@08)                                 0704
*       FLGS=EIGHTY;                /* INDICATE WHILE IN FLAGS       */
         MVI   FLGS(@08),X'80'                                     0705
*       LL=TWELVE;                  /* SET PREFIX LENGTH TO 12       */
         MVC   LL(2,@08),@CH00359                                  0706
*       LINCOUNT=LINCOUNT+FIVE;     /* SET TO LOOK FOR WHILE OPERANDS*/
         AL    LINCOUNT,@CF00371                                   0707
*       GOTO SCANDO;                /* SCAN DO STMT                  */
         B     SCANDO                                              0708
*     END;                                                         0709
*DOBAD:                                                            0710
*   EXMSGID=M526;                   /* INVALID KEYWORD       @ZM30996*/
@RF00702 DS    0H                                                  0710
DOBAD    MVC   EXMSGID(4),@CC00515                                 0710
*   STMT=ONS;                       /* STMT NUMBER IN MSG    @ZM30996*/
         OI    STMT,B'10000000'                                    0711
*   MVAR(2)=ADDR(LINE(LINCOUNT));   /* LOC OF INVALID KYWD   @ZM30996*/
         LR    @14,LINEPTR                                         0712
         BCTR  @14,0                                               0712
         LA    @14,LINE(LINCOUNT,@14)                              0712
         ST    @14,MVAR+4                                          0712
*   MVARLEN(2)=MIN(5,RLENGTH-LINCOUNT+1);/* LENGTH OF INSERT @ZM30996*/
         L     @14,RLENGTH                                         0713
         SLR   @14,LINCOUNT                                        0713
         AL    @14,@CF00033                                        0713
         LA    @08,5                                               0713
         CR    @14,@08                                             0713
         BNH   *+6
         LR    @14,@08                                             0713
         STC   @14,MVARLEN+4                                       0713
*   CALL MSGRTN;                    /* SEND MSG              @ZM30996*/
         BAL   @14,MSGRTN                                          0714
*   FLGS=ZERO;                      /* INDICATE ORDINARY DO  @ZM30996*/
         L     @14,ECDACNXT(,ECDAPTR)                              0715
         MVI   FLGS(@14),X'00'                                     0715
*   LL=EIGHT;                       /* REC PREFIX 4 SIMPLE DO@ZM30996*/
         MVC   LL(2,@14),@CH00088                                  0716
*REGDO:                                                            0717
*   O2O2=LINCOUNT-ONE+LL-FOUR;      /* SET UP O2O2 FIELD             */
REGDO    L     @14,ECDACNXT(,ECDAPTR)                              0717
         LA    @08,4                                               0717
         LR    @06,LINCOUNT                                        0717
         BCTR  @06,0                                               0717
         AH    @06,LL(,@14)                                        0717
         SLR   @06,@08                                             0717
         STH   @06,O2O2(,@14)                                      0717
*   OO=CMDADD-ECDAIREC;             /* INIT VALUE FOR OO             */
         L     @06,CMDADD                                          0718
         SL    @06,ECDAIREC(,ECDAPTR)                              0718
         STH   @06,OO(,@14)                                        0718
*   IF FLGS=EIGHTY THEN             /* IF DO WHILE PROCESSING        */
         CLI   FLGS(@14),128                                       0719
         BNE   @RF00719                                            0719
*     OO=OO+FOUR;                   /* ALLOW FOR FALSE PATH PTR      */
         ALR   @06,@08                                             0720
         STH   @06,OO(,@14)                                        0720
*   DATAADD=ECDAIREC+FOUR;          /* SET UP FOR MOVE. ADDR AND     */
@RF00719 LA    @14,4                                               0721
         AL    @14,ECDAIREC(,ECDAPTR)                              0721
         ST    @14,DATAADD                                         0721
*   DATALEN=RLENGTH;                /* LENGTH OF DATA                */
         L     @14,RLENGTH                                         0722
         ST    @14,DATALEN                                         0722
*   CALL MOVERTN;                   /* CALL MOVE ROUTINE             */
         BAL   @14,MOVERTN                                         0723
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0724
*   IF RCODE^=ZERO THEN             /* MOVE FAIL?                    */
         LTR   RCODE,RCODE                                         0725
         BZ    @RF00725                                            0725
*     RETURN CODE(RCODE) TO SPCLEXIT;/* YES---RETURN                 */
         LA    @14,SPCLEXIT                                        0726
         LR    @15,RCODE                                           0726
         LM    @00,@03,@SA00012+8                                  0726
         LM    @05,@12,@SA00012+24                                 0726
         BR    @14                                                 0726
*   DOBASE=ECDACPRE;                /* SAVE ADDRESS OF DO STMT FOR 0727
*                                      FALSE PATH UPDATE LATER       */
@RF00725 L     DOBASE,ECDACPRE(,ECDAPTR)                           0727
*GETAGN:                                                           0728
*   CALL GETALINE;                  /* GETALINE ROUTINE              */
GETAGN   BAL   @14,GETALINE                                        0728
*   RCODE=R15;                      /* DID GETALINE FAIL             */
         LR    RCODE,R15                                           0729
*   IF RCODE^=ZERO THEN                                            0730
         LTR   RCODE,RCODE                                         0730
         BZ    @RF00730                                            0730
*     DO;                           /* YES --                        */
*       IF RCODE=FOUR THEN          /* WAS IT END OF FILE?           */
         C     RCODE,@CF00072                                      0732
         BNE   @RF00732                                            0732
*         DO;                       /* YES-- ISSUE MESSAGE TO USER   */
*OPENDO:                                                           0734
*           EXMSGID=M537;           /* FOR OPEN DO GROUP             */
OPENDO   MVC   EXMSGID(4),@CC00499                                 0734
*           MVAR(1)=ADDR(CDO);      /* INSERT                        */
         LA    @14,@CC00412                                        0735
         ST    @14,MVAR                                            0735
*           MVARLEN(1)=LENGTH(CDO); /* LENGTH OF INSERT              */
         MVI   MVARLEN,X'02'                                       0736
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0737
*         END;                                                     0738
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
@RF00732 OI    NOTEXEC(ECDAPTR),B'01000000'                        0739
*       RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                     */
         LA    @14,SPCLEXIT                                        0740
         LR    @15,RCODE                                           0740
         LM    @00,@03,@SA00012+8                                  0740
         LM    @05,@12,@SA00012+24                                 0740
         BR    @14                                                 0740
*     END;                                                         0741
*                                                                  0741
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT THE NEXT INPUT RECORD IS READY FOR PROCESS SET  */
*   /* UP FLAGS AND POINTERS AND CALL RECORD SCAN ROUTINE            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0742
*   PARM1=ECDAPTR;                  /* BUILD 432 PARM LIST           */
@RF00730 ST    ECDAPTR,PARM1                                       0742
*   PARM2=ZERO;                     /* ZERO PARM 2                   */
         SLR   @14,@14                                             0743
         ST    @14,PARM2                                           0743
*   RFY                                                            0744
*    (R1) RSTD;                     /* RESTRICT REG 1                */
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */
         LA    R1,PARMS                                            0745
*   CALL IKJCT432;                  /* REINVOKE 432                  */
         L     @15,@CA00028                                        0746
         BALR  @14,@15                                             0746
*   RFY                                                            0747
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0748
*   IF RCODE^=ZERO THEN             /* ERROR--YES THEN ISSUE MSG     */
         SLR   @14,@14                                             0749
         CR    RCODE,@14                                           0749
         BNE   @RT00749                                            0749
*     GOTO OPENDO;                  /* AND RETURN                    */
*   IF ENDFLAG2=OFF THEN            /* HAS AN END STATEMENT BEEN     */
         TM    ENDFLAG2,B'10000000'                                0751
         BZ    @RT00751                                            0751
*     GOTO GETAGN;                  /* REACHED-NO--GET NEXT RECORD   */
*   IF DOBASE->FLGS=EIGHTY THEN     /* WAS DO STATEMENT A DO WHILE   */
         CLI   FLGS(DOBASE),128                                    0753
         BNE   @RF00753                                            0753
*     DO;                           /* YES--THEN GENERATE AN         */
*       LL=ELEVEN;                  /* INTERNAL GOTO, LL FIELD       */
         L     @08,ECDACNXT(,ECDAPTR)                              0755
         MVC   LL(2,@08),@CH00392                                  0755
*       OO=SEVEN;                   /* OO FILED                      */
         LA    @06,7                                               0756
         STH   @06,OO(,@08)                                        0756
*       O2O2=SEVEN;                 /* O2O2 FIELD                    */
         STH   @06,O2O2(,@08)                                      0757
*       OC=GOCODE;                  /* SET OPCODE                    */
         MVI   OC(@08),X'0F'                                       0758
*       FALSEP=DOBASE;              /* GOTO ADDRESS                  */
         STCM  DOBASE,15,FALSEP(@08)                               0759
*       DATAADD=ZERO;               /* CALL MOVE RTN TO UPDATE       */
         ST    @14,DATAADD                                         0760
*       DATALEN=ZERO;               /* POINTERS WITHOUT ACTUALLY     */
         ST    @14,DATALEN                                         0761
*       CALL MOVERTN;               /* MOVING ANY DATA               */
         BAL   @14,MOVERTN                                         0762
*       RCODE=R15;                  /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0763
*       DOBASE->FALSEP2=ECDACNXT;   /* UPDATE FALSE PATH ADDRESS     */
         MVC   FALSEP2(4,DOBASE),ECDACNXT(ECDAPTR)                 0764
*     END;                          /* IN ORIGINAL DO WHILE          */
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN. END OF DO.            */
@RF00753 LA    @14,SPCLEXIT                                        0766
         LR    @15,RCODE                                           0766
         LM    @00,@03,@SA00012+8                                  0766
         LM    @05,@12,@SA00012+24                                 0766
         BR    @14                                                 0766
*   END DOCMD;                                                     0767
*                                                                  0768
*/********************************************************************/
*/*                                                                  */
*/*     ERROR  ROUTINE                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0768
*ERRORCMD:                                                         0768
*   PROC;                                                          0768
ERRORCMD STM   @14,@03,@SA00013                                    0768
         STM   @05,@12,@SA00013+24                                 0768
*   IF OC^=OPATTN THEN              /* IF NOT THE ATTENTION CMD      */
         L     @14,ECDACNXT(,ECDAPTR)                              0769
         CLI   OC(@14),17                                          0769
         BE    @RF00769                                            0769
*     OC=OP10;                      /* SET OPCODE IN CP AREA TO 12   */
         MVI   OC(@14),X'0A'                                       0770
*   FLGS=ZERO;                      /* ZERO OUT FLAG FIELD           */
@RF00769 L     @14,ECDACNXT(,ECDAPTR)                              0771
         MVI   FLGS(@14),X'00'                                     0771
*   LL=EIGHT;                       /* LENGTH OF PREFIX              */
         MVC   LL(2,@14),@CH00088                                  0772
*   O2O2=RLENGTH+FOUR;              /* OFFSET TO END OF ERROR/ATTN   */
         LA    @08,4                                               0773
         L     @06,RLENGTH                                         0773
         ALR   @06,@08                                             0773
         STH   @06,O2O2(,@14)                                      0773
*   OO=CMDADD-ECDAIREC;             /* OFFSET TO E OF ERROR/ATTN     */
*                                                                  0774
         L     @06,CMDADD                                          0774
         L     @02,ECDAIREC(,ECDAPTR)                              0774
         LR    @01,@06                                             0774
         SLR   @01,@02                                             0774
         STH   @01,OO(,@14)                                        0774
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT DETERMINE IF OFF WAS SPECIFIED ON THE ERROR STATEMENT IF */
*   /* IT WAS SET APPROPRIATE FLAGS AND EXIT VIA COMMON EXIT.        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0775
*   LINEPTR=ECDAIREC+FOUR;          /* POINTER TO DATA               */
         ALR   @02,@08                                             0775
         LR    LINEPTR,@02                                         0775
*   LINCOUNT=(CMDADD+CMDLEN+ONE)    /* GET FIRST CHARACTER TO        */
*       -LINEPTR;                   /* CHECK AFTER ERROR/ATTN        */
         AL    @06,CMDLEN                                          0776
         AL    @06,@CF00033                                        0776
         SLR   @06,LINEPTR                                         0776
         LR    LINCOUNT,@06                                        0776
*OFFAGN:                                                           0777
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD? IF SO       */
OFFAGN   C     LINCOUNT,RLENGTH                                    0777
         BNH   @RF00777                                            0777
*     DO;                           /* NO OPERANDS                   */
*OFFAGN2:                                                          0779
*       FLGS=FORTY;                 /* SET FLAG TO HEX FORTY         */
OFFAGN2  L     @14,ECDACNXT(,ECDAPTR)                              0779
         MVI   FLGS(@14),X'40'                                     0779
*       GOTO NOOPS;                 /* GO TO MOVE CODE               */
         B     NOOPS                                               0780
*     END;                                                         0781
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */
@RF00777 LR    COUNT,LINCOUNT                                      0782
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */
         BAL   @14,FINDPARM                                        0783
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER ?          */
         L     @14,RLENGTH                                         0784
         CR    LINCOUNT,@14                                        0784
         BH    @RT00784                                            0784
*     GOTO OFFAGN2;                 /* YES--GO SET NO OPERAND BIT    */
*   IF LINCOUNT+TWO>RLENGTH THEN    /* OFF SPECIFIED??               */
         LA    @08,2                                               0786
         ALR   @08,LINCOUNT                                        0786
         CR    @08,@14                                             0786
         BH    @RT00786                                            0786
*     GOTO NOOFF;                   /* NO--SKIP OFF CODE             */
*   IF LINE(LINCOUNT:LINCOUNT+TWO)= /* FIRST NON-SEPAR FOUND--IS     */
*       OFFS THEN                   /* IT OFF?                       */
         LR    @14,LINEPTR                                         0788
         ALR   @14,LINCOUNT                                        0788
         BCTR  @14,0                                               0788
         CLC   LINE(3,@14),@CC00414                                0788
         BNE   @RF00788                                            0788
*     DO;                           /* YES                           */
*       FLGS=EIGHTY;                /* SET FLAG BYTE TO HEX 80       */
         L     @14,ECDACNXT(,ECDAPTR)                              0790
         MVI   FLGS(@14),X'80'                                     0790
*NOOPS:                                                            0791
*       DATAADD=ECDAIREC+FOUR;      /* SET UP FOR MOVE OF ERROR/ATTN */
NOOPS    LA    @14,4                                               0791
         AL    @14,ECDAIREC(,ECDAPTR)                              0791
         ST    @14,DATAADD                                         0791
*       DATALEN=RLENGTH;            /* AT COMMON EXIT                */
         L     @14,RLENGTH                                         0792
         ST    @14,DATALEN                                         0792
*       RETURN CODE(ZERO) TO COMNEXIT;/* RETURN VIA COMMON EXIT.     */
         LA    @14,COMNEXIT                                        0793
         SLR   @15,@15                                             0793
         LM    @00,@03,@SA00013+8                                  0793
         LM    @05,@12,@SA00013+24                                 0793
         BR    @14                                                 0793
*     END;                                                         0794
*NOOFF:                                                            0795
*   DATAADD=ECDAIREC+FOUR;          /* OFF NOT SPECIFIED. GO TO      */
@RF00788 DS    0H                                                  0795
NOOFF    LA    @14,4                                               0795
         L     @08,ECDAIREC(,ECDAPTR)                              0795
         ALR   @08,@14                                             0795
         ST    @08,DATAADD                                         0795
*   DATALEN=CMDADD+CMDLEN-(ECDAIREC+FOUR);/* MOVE ROUTINE TO MOVE IN */
         L     @06,CMDADD                                          0796
         AL    @06,CMDLEN                                          0796
         SLR   @06,@08                                             0796
         ST    @06,DATALEN                                         0796
*   LL=LL+FOUR;                     /* SAVE ROOM FOR FALSE PTR       */
         L     @08,ECDACNXT(,ECDAPTR)                              0797
         LH    @06,LL(,@08)                                        0797
         ALR   @06,@14                                             0797
         STH   @06,LL(,@08)                                        0797
*   OO=OO+FOUR;                     /* '' ''                         */
         AH    @14,OO(,@08)                                        0798
         STH   @14,OO(,@08)                                        0798
*   FALSEP2=ZERO;                   /* ZERO POINTER FOR NOW          */
         SLR   @14,@14                                             0799
         STCM  @14,15,FALSEP2(@08)                                 0799
*   CALL MOVERTN;                   /* ERROR                         */
         BAL   @14,MOVERTN                                         0800
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0801
*   IF RCODE^=ZERO THEN             /* OK? IF NOT RETURN.            */
         LTR   RCODE,RCODE                                         0802
         BZ    @RF00802                                            0802
*     RETURN CODE(RCODE) TO SPCLEXIT;/*                              */
         LA    @14,SPCLEXIT                                        0803
         LR    @15,RCODE                                           0803
         LM    @00,@03,@SA00013+8                                  0803
         LM    @05,@12,@SA00013+24                                 0803
         BR    @14                                                 0803
*   O2O2=LL-FOUR;                   /* BACK DOWN TO CORRECT LENGTH   */
@RF00802 L     @14,ECDACNXT(,ECDAPTR)                              0804
         LH    @08,LL(,@14)                                        0804
         SL    @08,@CF00072                                        0804
         STH   @08,O2O2(,@14)                                      0804
*   ERRBASE=ECDACPRE;               /* SAVE BASE TO ERROR/ATTN STMT  */
*                                                                  0805
         L     ERRBASE,ECDACPRE(,ECDAPTR)                          0805
*   /*****************************************************************/
*   /*                                                               */
*   /* NEXT SET UP TO CALL RECORD SCAN ROUTINE TO PROCESS THE OBJECT */
*   /* OF THE ERROR COMMAND. MAKE THE OBJECT OF THE ERROR COMMAND    */
*   /* LOOK LIKE ANY INPUT RECORD AND UPDATE CDA.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0806
*   IF OC^=OPATTN THEN              /* DONT ADD ONE IF ATTN          */
         CLI   OC(@14),17                                          0806
         BE    @RF00806                                            0806
*     CMDADD=CMDADD+ONE;            /* OVERLAY ERROR/ATTN WITH HDR   */
         LA    @14,1                                               0807
         AL    @14,CMDADD                                          0807
         ST    @14,CMDADD                                          0807
*   CMDADD->RECLEN=RECLEN-(CMDADD-ECDAIREC);/* SET RECORD LEN        */
@RF00806 L     @14,CMDADD                                          0808
         LR    @08,@14                                             0808
         SL    @08,ECDAIREC(,ECDAPTR)                              0808
         L     @06,SCANPTR                                         0808
         LH    @06,RECLEN(,@06)                                    0808
         SLR   @06,@08                                             0808
         STH   @06,RECLEN(,@14)                                    0808
*   CMDADD->OO=CMDADD-ECDAIREC;     /* SAVE OFFSET TO NEW LL         */
         STH   @08,OO(,@14)                                        0809
*   ECDAIREC=CMDADD;                /* UPDATE INPUT RECORD ADDRESS   */
         ST    @14,ECDAIREC(,ECDAPTR)                              0810
*   PARM1=ECDAPTR;                  /* BUILD PARM LIST               */
         ST    ECDAPTR,PARM1                                       0811
*   PARM2=ZERO;                     /* ZERO FLAGS                    */
         SLR   @14,@14                                             0812
         ST    @14,PARM2                                           0812
*   RFY                                                            0813
*    (R1) RSTD;                     /* RESTRICT REG 1                */
*   R1=ADDR(PARMS);                 /* LOAD PARM LIST ADDR           */
         LA    R1,PARMS                                            0814
*   CALL IKJCT432;                  /* CALL RECORD SCAN ROUTINE      */
         L     @15,@CA00028                                        0815
         BALR  @14,@15                                             0815
*   RFY                                                            0816
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0817
*   ERRBASE->FALSEP2=ECDACNXT;      /* GO AROUND ACTION              */
         MVC   FALSEP2(4,ERRBASE),ECDACNXT(ECDAPTR)                0818
*   RETURN CODE(RCODE) TO SPCLEXIT; /* RETURN TO CALLER              */
         LA    @14,SPCLEXIT                                        0819
         LR    @15,RCODE                                           0819
         LM    @00,@03,@SA00013+8                                  0819
         LM    @05,@12,@SA00013+24                                 0819
         BR    @14                                                 0819
*   END ERRORCMD;                                                  0820
*                                                                  0821
*/********************************************************************/
*/*                                                                  */
*/*     DATA   ROUTINE                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0821
*DATACMD:                                                          0821
*   PROC;                                                          0821
*                                                                  0821
DATACMD  STM   @14,@03,@SA00014                                    0821
         STM   @05,@12,@SA00014+24                                 0821
*   /*****************************************************************/
*   /*                                                               */
*   /* THE DATA ROUTINE PROCESSES ALL STATEMENTS BETWEEN DATA AND    */
*   /* ENDDATA STATEMENTS AS TSO COMMANDS. EACH ADDITIONAL RECORD IS */
*   /* OBTAINED THROUGH THE GETALINE ROUTINE IF AN ERROR OCCURS AN   */
*   /* APPROPRIATE MESSAGE WILL BE ISSUED AND CONTROL RETURNED TO    */
*   /* CALLER WITH ERROR RETURN CODE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0822
*NEXTREC:                                                          0822
*   CALL GETALINE;                  /* GET NEXT RECORD               */
NEXTREC  BAL   @14,GETALINE                                        0822
*   RCODE=R15;                      /* END OF FILE? OR OTHER ERROR   */
         LR    RCODE,R15                                           0823
*   IF RCODE^=ZERO THEN                                            0824
         LTR   RCODE,RCODE                                         0824
         BZ    @RF00824                                            0824
*     DO;                           /* NON-ZERO RETCODE?             */
*       IF RCODE=FOUR THEN          /* END OF FILE (RC=16)           */
         C     RCODE,@CF00072                                      0826
         BNE   @RF00826                                            0826
*         DO;                       /* YES 1 ISSUE MESSAGE           */
*           MVAR(1)=ADDR(CDATA);    /* INSERT                        */
         LA    @14,@CC00533                                        0828
         ST    @14,MVAR                                            0828
*           MVARLEN(1)=LENGTH(CDATA);/* LENGTH OF INSERT             */
         MVI   MVARLEN,X'04'                                       0829
*           EXMSGID=M537;           /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00499                                 0830
*           CALL MSGRTN;            /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0831
*         END;                                                     0832
*       RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                     */
@RF00826 LA    @14,SPCLEXIT                                        0833
         LR    @15,RCODE                                           0833
         LM    @00,@03,@SA00014+8                                  0833
         LM    @05,@12,@SA00014+24                                 0833
         BR    @14                                                 0833
*     END;                                                         0834
*   RLENGTH=ECDAIREC->RECLEN-FOUR;  /* SET UP LENGTH FOR CMD SCAN    */
@RF00824 L     @14,ECDAIREC(,ECDAPTR)                              0835
         LH    @14,RECLEN(,@14)                                    0835
         SL    @14,@CF00072                                        0835
         ST    @14,RLENGTH                                         0835
*   CALL CMDSCAN;                   /* CALL COMMAND SCAN             */
         BAL   @14,CMDSCAN                                         0836
*   IF CMDADD^=ZERO&                /* SEE IF COMMAND NAME WAS FOUND */
*       LABLADD=0&                  /* WITH NO LABEL PRESENT AND     */
*       CMDLEN=SEVEN&               /* IF SO WAS IT AN               */
*       COMMAND(1:SEVEN)=CENDATA THEN/* ENDDATA STATEMENT --YES--    */
         L     @14,CMDADD                                          0837
         SLR   @08,@08                                             0837
         CR    @14,@08                                             0837
         BE    @RF00837                                            0837
         C     @08,LABLADD                                         0837
         BNE   @RF00837                                            0837
         CLC   CMDLEN(4),@CF00149                                  0837
         BNE   @RF00837                                            0837
         CLC   COMMAND(7,@14),@CC00535                             0837
         BNE   @RF00837                                            0837
*     RETURN CODE(ZERO) TO SPCLEXIT;/* --RETURN VIA SPECIALEXIT      */
         LA    @14,SPCLEXIT                                        0838
         LR    @15,@08                                             0838
         LM    @00,@03,@SA00014+8                                  0838
         LM    @05,@12,@SA00014+24                                 0838
         BR    @14                                                 0838
*   LL=SEVEN;                       /* SET UP LENGTH IN PREFIX       */
@RF00837 L     @14,ECDACNXT(,ECDAPTR)                              0839
         MVC   LL(2,@14),@CH00149                                  0839
*   OC=ZERO;                        /* PUT IN TSO OPCODE             */
*                                                                  0840
         MVI   OC(@14),X'00'                                       0840
*   /*****************************************************************/
*   /*                                                               */
*   /* FOR SETTING UP OO AND O2O2 OFFSET FIELDS FIRST DETERMINE IF A */
*   /* COMMAND NAME HAD BEEN FOUND--IF ONE WAS NOT FOUND THEN SET    */
*   /* OFFSETS TO THE END OF THE BUFFER.OTHERWISE OO WILL BE THE     */
*   /* OFFSET TO THE COMMAND AND O2O2 THE OFFSET TO THE FIRST        */
*   /* PARAMETER(IF FOUND--OTHERWISE TO END OF BUFFER).              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0841
*   OO=THREE;                       /* SET OFFSET TO BEGINNING OF BUF*/
         LA    @08,3                                               0841
         STH   @08,OO(,@14)                                        0841
*   O2O2=OO;                        /* O2O2 OFFSET SAME AS OO        */
         STH   @08,O2O2(,@14)                                      0842
*   DATAADD=ECDAIREC+FOUR;          /* ADDR OF DATA FOR MOVE RTN     */
         LA    @14,4                                               0843
         AL    @14,ECDAIREC(,ECDAPTR)                              0843
         ST    @14,DATAADD                                         0843
*   DATALEN=RLENGTH;                /* LENGTH OF DATA                */
         L     @14,RLENGTH                                         0844
         ST    @14,DATALEN                                         0844
*   CALL MOVERTN;                   /* MOVE ROUTINE                  */
         BAL   @14,MOVERTN                                         0845
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           0846
*   IF RCODE^=ZERO THEN             /* IF RETURN CODE IS NON ZERO    */
         LTR   RCODE,RCODE                                         0847
         BZ    @RF00847                                            0847
*     RETURN CODE(RCODE) TO SPCLEXIT;/* THEN RETURN WITH RETCODE     */
         LA    @14,SPCLEXIT                                        0848
         LR    @15,RCODE                                           0848
         LM    @00,@03,@SA00014+8                                  0848
         LM    @05,@12,@SA00014+24                                 0848
         BR    @14                                                 0848
*   GOTO NEXTREC;                   /* ELSE GET NEXT RECORD          */
         B     NEXTREC                                             0849
*   END DATACMD;                                                   0850
*                                                                  0851
*/********************************************************************/
*/*                                                                  */
*/*     SET  ROUTINE                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0851
*SETCMD:                                                           0851
*   PROC;                                                          0851
SETCMD   STM   @14,@12,@SA00015                                    0851
*   OC=DOG;                         /* SET OPCODE TO 0D              */
         L     @14,ECDACNXT(,ECDAPTR)                              0852
         MVI   OC(@14),X'0D'                                       0852
*   LL=SEVEN;                       /* MOVE IN PREFIX LENGTH         */
         MVC   LL(2,@14),@CH00149                                  0853
*   LINEPTR=ECDAIREC+FOUR;          /* NEXT FIND SYMBOLIC PARM       */
         LA    @08,4                                               0854
         AL    @08,ECDAIREC(,ECDAPTR)                              0854
         LR    LINEPTR,@08                                         0854
*   OO=CMDADD-(ECDAIREC+FOUR)+THREE;/* SET OO FIELD                  */
         L     @06,CMDADD                                          0855
         LCR   @08,@08                                             0855
         ALR   @08,@06                                             0855
         AL    @08,@CF00250                                        0855
         STH   @08,OO(,@14)                                        0855
*   LINCOUNT=(CMDADD+CMDLEN+1)-LINEPTR;/* GET CHARACTER INDEX        */
         AL    @06,CMDLEN                                          0856
         AL    @06,@CF00033                                        0856
         SLR   @06,LINEPTR                                         0856
         LR    LINCOUNT,@06                                        0856
*SETSCN:                                                           0857
*   IF LINCOUNT>RLENGTH THEN        /* END OF RECORD?                */
SETSCN   C     LINCOUNT,RLENGTH                                    0857
         BNH   @RF00857                                            0857
*     DO;                           /* YES--NO SYMBOLIC PARMS IS   0858
*                                      CAUSE FOR FAILURE--ISSUE      */
*SETSCN2:                                                          0859
*       EXMSGID=M538;               /* MESSAGE ID                    */
SETSCN2  MVC   EXMSGID(4),@CC00501                                 0859
*       STMT=ONS;                   /* STATEMENT NUMBERS REQUIRED    */
         OI    STMT,B'10000000'                                    0860
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0861
*       NOTEXEC=ON;                 /* MESSAGE,SET PROC NOT          */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0862
*       RETURN CODE(ZERO) TO SPCLEXIT;/* EXECUTABLE AND RETURN       */
         LA    @14,SPCLEXIT                                        0863
         SLR   @15,@15                                             0863
         LM    @00,@12,@SA00015+8                                  0863
         BR    @14                                                 0863
*     END;                                                         0864
*   COUNT=LINCOUNT;                 /* SET CHARACTER INDEX           */
@RF00857 LR    COUNT,LINCOUNT                                      0865
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */
         BAL   @14,FINDPARM                                        0866
*   IF LINCOUNT>RLENGTH THEN        /* PAST END OF BUFFER?           */
         C     LINCOUNT,RLENGTH                                    0867
         BH    @RT00867                                            0867
*     GOTO SETSCN2;                 /* YES---ERROR                   */
*   IF AMPERSND=ON THEN             /* IF FIRST IS AMPERSAND         */
         TM    AMPERSND,B'00001000'                                0869
         BNO   @RF00869                                            0869
*     LINCOUNT=LINCOUNT+ONE;        /* INCREMENT BY ONE              */
         AL    LINCOUNT,@CF00033                                   0870
*   O2O2=ADDR(LINE(LINCOUNT))-LINEPTR+THREE;/* UPDATE 0202 FIELD     */
@RF00869 L     @14,ECDACNXT(,ECDAPTR)                              0871
         LR    @08,LINEPTR                                         0871
         BCTR  @08,0                                               0871
         LA    @08,LINE(LINCOUNT,@08)                              0871
         SLR   @08,LINEPTR                                         0871
         AL    @08,@CF00250                                        0871
         STH   @08,O2O2(,@14)                                      0871
*   DATAADD=LINEPTR;                /* SET UP FOR MOVE ROUTINE IN    */
         ST    LINEPTR,DATAADD                                     0872
*   DATALEN=RLENGTH;                /* COMMON EXIT                   */
         L     @14,RLENGTH                                         0873
         ST    @14,DATALEN                                         0873
*   RETURN CODE(ZERO) TO COMNEXIT;  /* RETURN TO COMMON EXIT         */
         LA    @14,COMNEXIT                                        0874
         SLR   @15,@15                                             0874
         LM    @00,@12,@SA00015+8                                  0874
         BR    @14                                                 0874
*   END SETCMD;                                                    0875
*                                                                  0876
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL ROUTINE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0876
*CNTRLCMD:                                                         0876
*   PROC;                                                          0876
CNTRLCMD STM   @14,@12,@SA00016                                    0876
*   OC=OPNINE;                      /* SET OP CODE                   */
         L     @14,ECDACNXT(,ECDAPTR)                              0877
         MVI   OC(@14),X'09'                                       0877
*   CNTLFLG=''B;                    /* ZERO CONTROL FLAGS            */
         XC    CNTLFLG(2,@14),CNTLFLG(@14)                         0878
*   OO=CMDADD-(ECDAIREC+FOUR)+FIVE; /* SET OO TO CONTROL             */
         LA    @08,5                                               0879
         L     @06,CMDADD                                          0879
         LA    @03,4                                               0879
         AL    @03,ECDAIREC(,ECDAPTR)                              0879
         LR    @01,@06                                             0879
         SLR   @01,@03                                             0879
         ALR   @01,@08                                             0879
         STH   @01,OO(,@14)                                        0879
*   LL=NINER;                       /* SET TOTAL LENGTH              */
         MVC   LL(2,@14),@CH00171                                  0880
*   O2O2=RLENGTH+FIVE;              /* POINT TO END OF BUFFER        */
         AL    @08,RLENGTH                                         0881
         STH   @08,O2O2(,@14)                                      0881
*   LINEPTR=ECDAIREC+FOUR;          /* POINT TO LINE                 */
         LR    LINEPTR,@03                                         0882
*   COUNT=(CMDADD+CMDLEN)-LINEPTR;  /* POINT AFTER CMD NAME          */
         AL    @06,CMDLEN                                          0883
         SLR   @06,LINEPTR                                         0883
         LR    COUNT,@06                                           0883
*   SEPS=OFF;                       /* TURN OFF SEPARATOR SWITCH     */
         NI    SEPS,B'01111111'                                    0884
*   DO WHILE SEPS=OFF;              /* PROCESS UNTIL END             */
         B     @DE00885                                            0885
@DL00885 DS    0H                                                  0886
*     EXACT=OFF;                    /* SET SWITCH                    */
*     AMBIG=OFF;                    /* SET SWITCH                    */
*     MATCH=OFF;                    /* SET SWITCH                    */
         NI    EXACT,B'10001111'                                   0888
*     COUNT=COUNT+ONE;              /* UP PAST LAST CHAR CHECKED     */
         AL    COUNT,@CF00033                                      0889
*     CALL FINDPARM;                /* FIND A WORD                   */
         BAL   @14,FINDPARM                                        0890
*     IF SEPS=OFF THEN              /* OFFT ALL SEPARATORS           */
         TM    SEPS,B'10000000'                                    0891
         BNZ   @RF00891                                            0891
*       DO;                         /* PROCESS KYWD FOUND            */
*         INDEX=ZERO;               /* ZERO INDEX COUNTER            */
         SLR   @14,@14                                             0893
         ST    @14,INDEX                                           0893
*         DO ICTR=1 TO DIM(TABLE) WHILE EXACT=OFF;/* FIND IF KEY IS
*                                      VALID                         */
         LA    ICTR,1                                              0894
@DL00894 TM    EXACT,B'01000000'                                   0894
         BNZ   @DC00894                                            0894
*           IF LENTH<=KEYLEN(ICTR)& /* IF LENGTH ^ GT THAN TABL      */
*               LINE(LINCOUNT:COUNT)=KEYWRD(ICTR,1:LENTH) THEN     0895
         L     @14,LENTH                                           0895
         LR    @06,ICTR                                            0895
         MH    @06,@CH00043                                        0895
         LA    @01,KEYLEN-15(@06)                                  0895
         ICM   @01,12,0(@01)                                       0895
         SRA   @01,16                                              0895
         CR    @14,@01                                             0895
         BH    @RF00895                                            0895
         LR    @00,@14                                             0895
         BCTR  @00,0                                               0895
         LR    @14,LINEPTR                                         0895
         ALR   @14,LINCOUNT                                        0895
         BCTR  @14,0                                               0895
         ST    @01,@TF00001                                        0895
         LA    @01,KEYWRD-15(@06)                                  0895
         LR    @06,@00                                             0895
         EX    @06,@SC00861                                        0895
         BNE   @RF00895                                            0895
*             DO;                   /* EVEN A PARTIAL MATCH ?        */
*               IF LENTH=KEYLEN(ICTR) THEN/* IF AN EXACT MATCH       */
         L     @14,LENTH                                           0897
         C     @14,@TF00001                                        0897
         BNE   @RF00897                                            0897
*                 EXACT=ONS;        /* KEYWORD WAS FOUND             */
         OI    EXACT,B'01000000'                                   0898
*               ELSE                /* OTHERWISE                     */
*                 IF MATCH=ONS THEN /* IF ONE PARTIAL ALREADY        */
         B     @RC00897                                            0899
@RF00897 TM    MATCH,B'00100000'                                   0899
         BNO   @RF00899                                            0899
*                   AMBIG=ONS;      /* SET AMBIGUOUS SWITCH          */
         OI    AMBIG,B'00010000'                                   0900
*                 ELSE              /* IF OFFN OF THE ABOVE          */
*                   MATCH=ONS;      /* AT LEAST A PARTIAL MATCH      */
         B     @RC00899                                            0901
@RF00899 OI    MATCH,B'00100000'                                   0901
*               INDEX=ICTR;         /* SAVE CURRENT INDEX            */
@RC00899 DS    0H                                                  0902
@RC00897 ST    ICTR,INDEX                                          0902
*             END;                                                 0903
*         END;                                                     0904
@RF00895 AL    ICTR,@CF00033                                       0904
         C     ICTR,@CF00169                                       0904
         BNH   @DL00894                                            0904
@DC00894 DS    0H                                                  0905
*         IF INDEX=DIM(TABLE) THEN  /* END KEY WORD ?                */
         CLC   INDEX(4),@CF00169                                   0905
         BNE   @RF00905                                            0905
*           DO;                     /* PROCESS VALUE                 */
*             COUNT=COUNT+ONE;      /* SKIP LAST CHAR CHECKED        */
         AL    COUNT,@CF00033                                      0907
*             CALL FINDPARM;        /* FIND NEXT WORD                */
         BAL   @14,FINDPARM                                        0908
*             IF OPAREN=OFF THEN    /* IF NOT AN '(' ERROR           */
         TM    OPAREN,B'10000000'                                  0909
         BNZ   @RF00909                                            0909
*               CALL ENDMSG;        /* PUT OUT ERROR MSG             */
         BAL   @14,ENDMSG                                          0910
*             ELSE                  /* OTHER WISE                    */
*               DO;                 /* FIND VALUE                    */
         B     @RC00909                                            0911
@RF00909 DS    0H                                                  0912
*                 COUNT=COUNT+ONE;  /* INCREMENT PAST '('            */
         AL    COUNT,@CF00033                                      0912
*                 CALL FINDPARM;    /* FIND NEXT PARM                */
         BAL   @14,FINDPARM                                        0913
*                 IF SEPS=ONSLENTH>FOURNOTALPNU=ONS THEN/* INVALID */
         TM    SEPS,B'10000000'                                    0914
         BO    @RT00914                                            0914
         L     @14,LENTH                                           0914
         C     @14,@CF00072                                        0914
         BH    @RT00914                                            0914
         TM    NOTALPNU,B'10000000'                                0914
         BNO   @RF00914                                            0914
@RT00914 DS    0H                                                  0915
*                   CALL ENDMSG;    /* PUT OUT ERROR MESSAGE         */
         BAL   @14,ENDMSG                                          0915
*                 ELSE              /* OTHER WISE                    */
*                   DO;             /* UPDATE ALTERNATE END          */
         B     @RC00914                                            0916
@RF00914 DS    0H                                                  0917
*                     ECDAELNG=LENTH;/* SET LENGTH                   */
         L     @14,LENTH                                           0917
         STH   @14,ECDAELNG(,ECDAPTR)                              0917
*                     ECDAAEND='';  /* CLEAR OLD END                 */
         MVI   ECDAAEND(ECDAPTR),C' '                              0918
         MVC   ECDAAEND+1(3,ECDAPTR),ECDAAEND(ECDAPTR)             0918
*                     ECDAAEND(1:LENTH)=LINE(LINCOUNT:COUNT);/*      */
         BCTR  @14,0                                               0919
         LR    @08,LINEPTR                                         0919
         ALR   @08,LINCOUNT                                        0919
         BCTR  @08,0                                               0919
         EX    @14,@SM00863                                        0919
*                   END;                                           0920
*                 COUNT=COUNT+ONE;  /* SKIP PAST LAST CHAR           */
@RC00914 AL    COUNT,@CF00033                                      0921
*                 CALL FINDPARM;    /* FIND NEXT PARM                */
         BAL   @14,FINDPARM                                        0922
*                 DO WHILE SEPS=OFF&CPAREN=OFF;/* DO GROUP           */
         B     @DE00923                                            0923
@DL00923 DS    0H                                                  0924
*                   CALL ENDMSG;    /* PRINT ERROR MSG               */
         BAL   @14,ENDMSG                                          0924
*                   COUNT=COUNT+ONE;/* SKIP OVER LAST                */
         AL    COUNT,@CF00033                                      0925
*                   CALL FINDPARM;  /* FIND NEXT PARM                */
         BAL   @14,FINDPARM                                        0926
*                 END;                                             0927
@DE00923 TM    SEPS,B'10000000'                                    0927
         BNZ   @DC00923                                            0927
         TM    CPAREN,B'01000000'                                  0927
         BZ    @DL00923                                            0927
@DC00923 DS    0H                                                  0928
*               END;                                               0928
*           END;                                                   0929
@RC00909 DS    0H                                                  0930
*         IF EXACT=ONS(MATCH=ONS&AMBIG=OFF) THEN/* OK OK OK         */
@RF00905 TM    EXACT,B'01000000'                                   0930
         BO    @RT00930                                            0930
         TM    MATCH,B'00100000'                                   0930
         BNO   @RF00930                                            0930
         TM    AMBIG,B'00010000'                                   0930
         BNZ   @RF00930                                            0930
@RT00930 DS    0H                                                  0931
*           DO;                     /* OK OK OK                      */
*             CNTLFLG=CNTLFLGMASK1(INDEX);/* TURN ON FLAGS          */
         L     @14,ECDACNXT(,ECDAPTR)                              0932
         L     @08,INDEX                                           0932
         MH    @08,@CH00043                                        0932
         LA    @06,MASK1-15(@08)                                   0932
         OC    CNTLFLG(2,@14),0(@06)                               0932
*             CNTLFLG=CNTLFLG&MASK2(INDEX);/* TURN ON FLAGS          */
         LA    @06,MASK2-15(@08)                                   0933
         NC    CNTLFLG(2,@14),0(@06)                               0933
*           END;                                                   0934
*         ELSE                      /* ELSE                          */
*           DO;                                                    0935
         B     @RC00930                                            0935
@RF00930 DS    0H                                                  0936
*             IF AMBIG=ONS THEN     /* AMBIGUOUS                     */
         TM    AMBIG,B'00010000'                                   0936
         BNO   @RF00936                                            0936
*               EXMSGID=M528;       /* AMBIGUOUS                     */
         MVC   EXMSGID(4),@CC00517                                 0937
*             ELSE                  /* OTHERWISE                     */
*               EXMSGID=M526;       /* INVALID                       */
         B     @RC00936                                            0938
@RF00936 MVC   EXMSGID(4),@CC00515                                 0938
*             MVAR(2)=ADDR(LINE(LINCOUNT));/* BAD GUY                */
@RC00936 LR    @14,LINEPTR                                         0939
         BCTR  @14,0                                               0939
         LA    @14,LINE(LINCOUNT,@14)                              0939
         ST    @14,MVAR+4                                          0939
*             NOTEXEC=ONS;          /* SET PROC NOT EXEC             */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0940
*             MVARLEN(2)=MAX(ONE,LENTH);/* BAD GUYS LENGTH           */
         L     @14,LENTH                                           0941
         LA    @08,1                                               0941
         CR    @14,@08                                             0941
         BNL   *+6
         LR    @14,@08                                             0941
         STC   @14,MVARLEN+4                                       0941
*             STMT=ONS;             /* STATEMENT NUMBERS REQUIRED    */
         OI    STMT,B'10000000'                                    0942
*             CALL MSGRTN;          /* ISSUE MESSAGE                 */
         BAL   @14,MSGRTN                                          0943
*           END;                                                   0944
*       END;                                                       0945
@RC00930 DS    0H                                                  0946
*   END;                                                           0946
@RF00891 DS    0H                                                  0946
@DE00885 TM    SEPS,B'10000000'                                    0946
         BZ    @DL00885                                            0946
*   DATAADD=ECDAIREC+FOUR;          /* DATA ADDRESS                  */
         LA    @14,4                                               0947
         AL    @14,ECDAIREC(,ECDAPTR)                              0947
         ST    @14,DATAADD                                         0947
*   DATALEN=RLENGTH;                /* DATA LENGTH                   */
         L     @14,RLENGTH                                         0948
         ST    @14,DATALEN                                         0948
*   RETURN CODE(ZERO) TO COMNEXIT;  /* RETURN TO MAINLINE            */
         LA    @14,COMNEXIT                                        0949
         SLR   @15,@15                                             0949
         LM    @00,@12,@SA00016+8                                  0949
         BR    @14                                                 0949
*   END CNTRLCMD;                                                  0950
*ENDMSG:                                                           0951
*   PROC;                                                          0951
ENDMSG   STM   @14,@12,@SA00017                                    0951
*   NOTEXEC=ONS;                    /* SET PROC NOT EXEC             */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0952
*   STMT=ONS;                       /* STMT SWITCH ON                */
         OI    STMT,B'10000000'                                    0953
*   IF SEPS=OFF THEN                /* END OF BUFFER?                */
         TM    SEPS,B'10000000'                                    0954
         BNZ   @RF00954                                            0954
*     DO;                           /* YES                           */
*       EXMSGID=M544;               /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00519                                 0956
*       MVAR(2)=ADDR(LINE(LINCOUNT));/* SET MESSAGE INSERT           */
         LR    @14,LINEPTR                                         0957
         BCTR  @14,0                                               0957
         LA    @14,LINE(LINCOUNT,@14)                              0957
         ST    @14,MVAR+4                                          0957
*       MVARLEN(2)=MAX(ONE,LENTH);  /* INSERT LENGTH                 */
         L     @14,LENTH                                           0958
         LA    @08,1                                               0958
         CR    @14,@08                                             0958
         BNL   *+6
         LR    @14,@08                                             0958
         STC   @14,MVARLEN+4                                       0958
*     END;                                                         0959
*   ELSE                            /* ELSE ISSUE                    */
*     EXMSGID=M543;                 /* END MESSAGE                   */
         B     @RC00954                                            0960
@RF00954 MVC   EXMSGID(4),@CC00509                                 0960
*   CALL MSGRTN;                    /* CALL MSGRTN                   */
@RC00954 BAL   @14,MSGRTN                                          0961
*   END ENDMSG;                                                    0962
@EL00017 DS    0H                                                  0962
@EF00017 DS    0H                                                  0962
@ER00017 LM    @14,@12,@SA00017                                    0962
         BR    @14                                                 0962
*                                                                  0963
*/********************************************************************/
*/*                                                                  */
*/*     READ ROUTINE                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0963
*READCMD:                                                          0963
*   PROC;                                                          0963
READCMD  STM   @14,@03,@SA00018                                    0963
         STM   @05,@12,@SA00018+24                                 0963
*   IF OC^=OPGLOB THEN              /* GLOBAL PROCESS                */
         L     @14,ECDACNXT(,ECDAPTR)                              0964
         CLI   OC(@14),255                                         0964
         BE    @RF00964                                            0964
*     OC=OPNOMOVE;                  /* SET OP CODE FOR NO MOVE       */
         MVI   OC(@14),X'FE'                                       0965
*   RCODE=ZERO;                     /* ZERO OUT RETURN CODE          */
@RF00964 SLR   RCODE,RCODE                                         0966
*   PARMCNT=ZERO;                   /* SET PARAMETER COUNT TO ZERO   */
         L     @14,ECDACNXT(,ECDAPTR)                              0967
         SLR   @08,@08                                             0967
         STCM  @08,3,PARMCNT(@14)                                  0967
*   LL=NINER;                       /* SET PREFIX LENGTH             */
         MVC   LL(2,@14),@CH00171                                  0968
*   LINEPTR=ECDAIREC+FOUR;          /* POINTER TO DATA               */
         LA    LINEPTR,4                                           0969
         AL    LINEPTR,ECDAIREC(,ECDAPTR)                          0969
*   LINCOUNT=(CMDADD+CMDLEN)        /* SET UP INDEX TO FIRST         */
*       -LINEPTR+ONE;               /* CHARACTER AFTER CMD NAME      */
         L     LINCOUNT,CMDADD                                     0970
         AL    LINCOUNT,CMDLEN                                     0970
         SLR   LINCOUNT,LINEPTR                                    0970
         AL    LINCOUNT,@CF00033                                   0970
*NXTPARM:                                                          0971
*   TRIP=ONE;                       /* USED FOR ERROR INDICATIONS    */
NXTPARM  LA    @14,1                                               0971
         LR    TRIP,@14                                            0971
*   IF OC=OPGLOB THEN               /* GLOBAL ?                      */
         L     @08,ECDACNXT(,ECDAPTR)                              0972
         CLI   OC(@08),255                                         0972
         BE    @RT00972                                            0972
*     GO TO GLOB2;                  /* BRANCH                        */
*   IF PARMCNT+ONE>TWO56 THEN       /* CANNOT HAVE MORE THAN         */
         ICM   @08,12,PARMCNT(@08)                                 0974
         SRA   @08,16                                              0974
         ALR   @14,@08                                             0974
         C     @14,@CF00479                                        0974
         BNH   @RF00974                                            0974
*     DO;                           /* 256 PARAMETERS ON READ CMD    */
*       EXMSGID=M539;               /* ISSUE A MSG TO USER           */
         MVC   EXMSGID(4),@CC00503                                 0976
*       STMT=ONS;                   /* STATEMENT NUMBER REQUIRED     */
         OI    STMT,B'10000000'                                    0977
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */
         BAL   @14,MSGRTN                                          0978
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        0979
*       RETURN CODE(ZERO);          /* RETURN                        */
         SLR   @15,@15                                             0980
         L     @14,@SA00018                                        0980
         LM    @00,@03,@SA00018+8                                  0980
         LM    @05,@12,@SA00018+24                                 0980
         BR    @14                                                 0980
*     END;                                                         0981
*GLOB2:                                                            0982
*   X=ZERO;                         /* USED FOR AMPERSAND CHECKS     */
@RF00974 DS    0H                                                  0982
GLOB2    SLR   X,X                                                 0982
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD?             */
         C     LINCOUNT,RLENGTH                                    0983
         BNH   @RF00983                                            0983
*     DO;                           /* YES--SET UP FOR MOVE RTN      */
*MOVEOUT:                                                          0985
*       IF OC=OPGLOB THEN           /* GLOBAL                        */
MOVEOUT  L     @14,ECDACNXT(,ECDAPTR)                              0985
         CLI   OC(@14),255                                         0985
         BNE   @RF00985                                            0985
*         RETURN CODE(RCODE) TO SPCLEXIT;/* RETURN                   */
         LA    @14,SPCLEXIT                                        0986
         LR    @15,RCODE                                           0986
         LM    @00,@03,@SA00018+8                                  0986
         LM    @05,@12,@SA00018+24                                 0986
         BR    @14                                                 0986
*       DATAADD=LINEPTR;            /* ADDRESS OF DATA AND           */
@RF00985 ST    LINEPTR,DATAADD                                     0987
*       DATALEN=RLENGTH;            /* LENGTH OF DATA TO BE MOVED    */
         L     @14,RLENGTH                                         0988
         ST    @14,DATALEN                                         0988
*       O2O2=(LL-FOUR)+RLENGTH;     /* OFFSET TO END OF RECORD       */
         L     @08,ECDACNXT(,ECDAPTR)                              0989
         LA    @06,4                                               0989
         LH    @05,LL(,@08)                                        0989
         SLR   @05,@06                                             0989
         ALR   @14,@05                                             0989
         STH   @14,O2O2(,@08)                                      0989
*       OO=(LL-FOUR)+(CMDADD-(ECDAIREC+FOUR));/* OFFSET TO R IN READ */
         AL    @06,ECDAIREC(,ECDAPTR)                              0990
         LCR   @06,@06                                             0990
         AL    @06,CMDADD                                          0990
         ALR   @05,@06                                             0990
         STH   @05,OO(,@08)                                        0990
*       IF CMDLEN=EIGHT THEN        /* IF READ DVAL                  */
         CLC   CMDLEN(4),@CF00088                                  0991
         BNE   @RF00991                                            0991
*         OC=OPSXTEEN;              /* OP 16                         */
         MVI   OC(@08),X'10'                                       0992
*       ELSE                        /* OTHERWISE THE OP CODE IS 12   */
*         OC=OP12;                                                 0993
         B     @RC00991                                            0993
@RF00991 L     @14,ECDACNXT(,ECDAPTR)                              0993
         MVI   OC(@14),X'0C'                                       0993
*       RETURN CODE(RCODE) TO COMNEXIT;/* RETURN VIA COMMON EXIT     */
@RC00991 LA    @14,COMNEXIT                                        0994
         LR    @15,RCODE                                           0994
         LM    @00,@03,@SA00018+8                                  0994
         LM    @05,@12,@SA00018+24                                 0994
         BR    @14                                                 0994
*     END;                                                         0995
*   COUNT=LINCOUNT;                 /* SET UP FOR CHARCHK ROUTINE    */
@RF00983 LR    COUNT,LINCOUNT                                      0996
*   CALL FINDPARM;                  /* CALL FINDPARM ROUTINE         */
         BAL   @14,FINDPARM                                        0997
*   IF LINCOUNT>RLENGTH THEN                                       0998
         C     LINCOUNT,RLENGTH                                    0998
         BH    @RT00998                                            0998
*     GOTO MOVEOUT;                 /* PARM NOT FOUND                */
*   PARMADR=ADDR(LINE(LINCOUNT));   /* NO--SAVE ADDRESS OF PARM      */
         LR    @14,LINEPTR                                         1000
         BCTR  @14,0                                               1000
         LA    @14,LINE(LINCOUNT,@14)                              1000
         ST    @14,PARMADR                                         1000
*   IF AMPERSND=ON THEN             /* IF FIRST CHARACTER IS AN      */
         TM    AMPERSND,B'00001000'                                1001
         BNO   @RF01001                                            1001
*     DO;                           /* AMPERSAND THEN INDICATE SO.   */
*       X=OPGLOB;                   /* BY SETTING WORK BYTE AND GO   */
         LA    X,255                                               1003
*       GOTO NXTCHR;                /* CHECK NEXT CHARACTER.         */
         B     NXTCHR                                              1004
*     END;                                                         1005
*   IF ALPHA=OFF THEN               /* IS FIRST CHARACTER ALPHA.?    */
@RF01001 TM    ALPHA,B'10000000'                                   1006
         BNZ   @RF01006                                            1006
*     DO;                           /* NO--                          */
*BADCHR:                                                           1008
*       X=ZERO;                     /* ISSUE A MESSAGE               */
BADCHR   SLR   X,X                                                 1008
*       COUNT=LINCOUNT;             /* CHARACTER INDEX               */
         LR    COUNT,LINCOUNT                                      1009
*       CALL FINDEND;               /* FIND END OF PARM              */
         BAL   @14,FINDEND                                         1010
*       LINCOUNT=COUNT+ONE;         /* INCREMENT PAST END OF PARM    */
         LA    LINCOUNT,1                                          1011
         ALR   LINCOUNT,COUNT                                      1011
*       EXMSGID=B540;               /* INVALID PARM MSG              */
         MVC   EXMSGID(4),@CC00507                                 1012
*BADCHR2:                                                          1013
*       STMT=ONS;                   /* STMT SWITCH ON                */
BADCHR2  OI    STMT,B'10000000'                                    1013
*       MVAR(2)=PARMADR;            /* ADDR OF MSG VARIABLE          */
         L     @14,PARMADR                                         1014
         ST    @14,MVAR+4                                          1014
*       MVARLEN(2)=ADDR(LINE(LINCOUNT))-PARMADR;/* LENGTH            */
         LR    @08,LINEPTR                                         1015
         BCTR  @08,0                                               1015
         LA    @08,LINE(LINCOUNT,@08)                              1015
         SLR   @08,@14                                             1015
         STC   @08,MVARLEN+4                                       1015
*       IF ADDR(LINE(LINCOUNT))-PARMADR>ONE27 THEN/* TRUNCATE LEN    */
         C     @08,@CF00475                                        1016
         BNH   @RF01016                                            1016
*         MVARLEN(2)=ONE27;         /* LENGTH                        */
         MVI   MVARLEN+4,X'7F'                                     1017
*       CALL MSGRTN;                /* MESSAGE ROUTINE               */
@RF01016 BAL   @14,MSGRTN                                          1018
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1019
*       GOTO NXTPARM;               /* LOOK FOR NEXT PARM            */
         B     NXTPARM                                             1020
*     END;                                                         1021
*   IF LINCOUNT=RLENGTH THEN        /* IF AT END OF BFR              */
@RF01006 C     LINCOUNT,RLENGTH                                    1022
         BNE   @RF01022                                            1022
*     DO;                           /*                               */
*       PARMLNG=ONE;                /* SET PARMLNG = 1               */
         LA    @14,1                                               1024
         ST    @14,PARMLNG                                         1024
*       LINCOUNT=LINCOUNT+ONE;      /* UPDATE PAST BUFFER END        */
         ALR   LINCOUNT,@14                                        1025
*       GO TO PARMEND;              /* FINI                          */
         B     PARMEND                                             1026
*     END;                          /*                               */
*NXTCHR:                                                           1028
*   LINCOUNT=LINCOUNT+ONE;          /* GET NEXT CHARACTER INDEX      */
@RF01022 DS    0H                                                  1028
NXTCHR   AL    LINCOUNT,@CF00033                                   1028
*   IF LINCOUNT>RLENGTH THEN        /* AT END OF RECORD?             */
         C     LINCOUNT,RLENGTH                                    1029
         BH    @RT01029                                            1029
*     GOTO MOVEOUT;                 /* YES---LEAVE                   */
*   COUNT=LINCOUNT;                 /* SET UP FOR CHARCHK ROUTINE    */
         LR    COUNT,LINCOUNT                                      1031
*   CALL CHARCHK;                   /* CALL CHARCHK ROUTINE          */
         BAL   @14,CHARCHK                                         1032
*   IF X=OPGLOB&ALPHA=OFF THEN      /* FIRST CHAR AMPERSAND AND      */
         C     X,@CF00374                                          1033
         BNE   @RF01033                                            1033
         TM    ALPHA,B'10000000'                                   1033
         BZ    @RT01033                                            1033
*     GOTO BADCHR;                  /* SECOND NOT ALPHA?--ERROR      */
*   X=ZERO;                         /* TURN OFF I FOR REST OF CHKS   */
@RF01033 SLR   X,X                                                 1035
*   IF SEPAR=ONSLASH=ON THEN       /* IF A SEPERATOR                */
         TM    SEPAR,B'00000110'                                   1036
         BNZ   @RT01036                                            1036
*     GO TO FOUND;                  /* PROCESS THIS VARIABLE         */
*   IF NALPHNUM=ON THEN             /* IF CHARACTER IS NOT ALPHA-    */
         TM    NALPHNUM,B'00000001'                                1038
         BO    @RT01038                                            1038
*     GOTO BADCHR;                  /* NUMERIC THEN IT IS AN ERROR   */
*   IF RLENGTH^=LINCOUNT THEN                                      1040
         C     LINCOUNT,RLENGTH                                    1040
         BNE   @RT01040                                            1040
*     GOTO NXTCHR;                  /* NO--CHECK NEXT CHARACTER.     */
*   LINCOUNT=LINCOUNT+ONE;          /* INCREMENT PAST END            */
         AL    LINCOUNT,@CF00033                                   1042
*FOUND:                                                            1043
*   SAVEPTR=ADDR(LINE(LINCOUNT));   /* YES--COMPUTE LENGTH OF PARM   */
FOUND    LR    SAVEPTR,LINEPTR                                     1043
         BCTR  SAVEPTR,0                                           1043
         LA    SAVEPTR,LINE(LINCOUNT,SAVEPTR)                      1043
*   PARMLNG=SAVEPTR-PARMADR;        /* SET UP FOR SYNTAB RTN--WITH   */
         L     @14,PARMADR                                         1044
         LR    @08,SAVEPTR                                         1044
         SLR   @08,@14                                             1044
         ST    @08,PARMLNG                                         1044
*   IF PARMADR->LINE(1)=AMPER THEN  /* IF VARIABLE STARTS WITH &     */
         CLI   LINE(@14),C'&&'                                     1045
         BNE   @RF01045                                            1045
*     DO;                           /* UPDATE SYNTAM PARMS           */
*       PARMADR=PARMADR+ONE;        /* UP ONE                        */
         AL    @14,@CF00033                                        1047
         ST    @14,PARMADR                                         1047
*       PARMLNG=PARMLNG-ONE;        /* DOWN ONE                      */
         BCTR  @08,0                                               1048
         ST    @08,PARMLNG                                         1048
*     END;                                                         1049
*   IF(OC^=OPGLOB&PARMLNG>TWO52)   /* CHECK FOR INVALID LENGTHS OF  */
*       (OC=OPGLOB&PARMLNG>THIRTY1) THEN/* SYMPARMS ON GLOBAL AND    */
@RF01045 L     @14,ECDACNXT(,ECDAPTR)                              1050
         CLI   OC(@14),255                                         1050
         BE    @GL00028                                            1050
         L     @14,PARMLNG                                         1050
         C     @14,@CF00473                                        1050
         BH    @RT01050                                            1050
@GL00028 L     @14,ECDACNXT(,ECDAPTR)                              1050
         CLI   OC(@14),255                                         1050
         BNE   @RF01050                                            1050
         L     @14,PARMLNG                                         1050
         C     @14,@CF00041                                        1050
         BNH   @RF01050                                            1050
@RT01050 DS    0H                                                  1051
*     DO;                           /* READ COMMANDS                 */
*       EXMSGID=A540;               /* MESSAGE ID                    */
         MVC   EXMSGID(4),@CC00505                                 1052
*       GOTO BADCHR2;               /* GO ISSUE MESSAGE              */
         B     BADCHR2                                             1053
*     END;                                                         1054
*PARMEND:                                                          1055
*   IF OC=OPGLOB THEN               /* GLOBAL PROCESSING ?           */
@RF01050 DS    0H                                                  1055
PARMEND  L     @14,ECDACNXT(,ECDAPTR)                              1055
         CLI   OC(@14),255                                         1055
         BNE   @RF01055                                            1055
*     PARMTYPE=GLOBAL;              /* YES - SET PARMTYPE TO 2       */
         MVC   PARMTYPE(2),@CH00074                                1056
*   ELSE                            /* NO - SET PARMTYPE TO ZERO     */
*     PARMTYPE=KEYW;                /* LENGTH AND POINTER TO PARM    */
         B     @RC01055                                            1057
@RF01055 MVC   PARMTYPE(2),@CH00250                                1057
*   CALL SYNTAB(NTUPTPRM);          /* CALL SYNTAB                   */
@RC01055 LA    @14,NTUPTPRM                                        1058
         ST    @14,@AL00001                                        1058
         LA    @01,@AL00001                                        1058
         BAL   @14,SYNTAB                                          1058
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           1059
*   IF RCODE^=ZERO THEN             /* NON-ZERO RETURN CODE?         */
         LTR   RCODE,RCODE                                         1060
         BZ    @RF01060                                            1060
*     DO;                           /* YES-- ISSUE MESSAGE           */
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1062
*       GOTO NXTPARM;               /* GO LOOK FOR NEXT PARM         */
         B     NXTPARM                                             1063
*     END;                                                         1064
*   IF OC=OPGLOB THEN               /* GLOBAL ?                      */
@RF01060 L     @14,ECDACNXT(,ECDAPTR)                              1065
         CLI   OC(@14),255                                         1065
         BE    @RT01065                                            1065
*     GO TO NXTPARM;                /* GET NEXT PARM                 */
*   DATAADD=ADDR(PARMRADR);         /* SET UP FOR MOVE OF @ OF       */
         LA    @14,PARMRADR                                        1067
         ST    @14,DATAADD                                         1067
*   DATALEN=FOUR;                   /* SYNTAB ELEMENT TO STORAGE     */
         MVC   DATALEN(4),@CF00072                                 1068
*   CALL MOVERTN;                   /* RECORD. CALL MOVE ROUTINE     */
         BAL   @14,MOVERTN                                         1069
*   RCODE=R15;                      /* SAVE RETURN CODE              */
         LR    RCODE,R15                                           1070
*   IF RCODE^=ZERO THEN             /* NON-ZERO RETURN CODE?         */
         LTR   RCODE,RCODE                                         1071
         BZ    @RF01071                                            1071
*     DO;                           /* YES ISSUE MESSAGE             */
*       NOTEXEC=ON;                 /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1073
*       GOTO NXTPARM;               /* GO CHECK NEXT PARM            */
         B     NXTPARM                                             1074
*     END;                                                         1075
*   PARMCNT=PARMCNT+ONE;            /* INCREMENT PARM COUNT BY 1     */
@RF01071 L     @14,ECDACNXT(,ECDAPTR)                              1076
         LA    @08,1                                               1076
         ICM   @06,12,PARMCNT(@14)                                 1076
         SRA   @06,16                                              1076
         ALR   @08,@06                                             1076
         STCM  @08,3,PARMCNT(@14)                                  1076
*   GOTO NXTPARM;                   /* GO CHECK NEXT PARAMETER       */
         B     NXTPARM                                             1077
*   END READCMD;                                                   1078
*SYNTAB:                                                           1079
*   PROC;                                                          1079
*                                                                  1079
SYNTAB   STM   @14,@12,@SA00019                                    1079
*/********************************************************************/
*/*                                                                  */
*/*     SYNTAB ROUTINE                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1080
*   PARMRADR=CON0;                  /* ZERO ELEMENT RETURN ADDR      */
         SLR   @14,@14                                             1080
         ST    @14,PARMRADR                                        1080
*   SNTABPTR=SNTABFST;              /* SET BASE TO FIRST SNTAB       */
         L     @14,ECDALSD(,ECDAPTR)                               1081
         L     @14,LSDEXEC(,@14)                                   1081
         L     SNTABPTR,SNTABFST(,@14)                             1081
*   SVTABPTR=SVTABFST;              /* AND SVTAB                     */
         L     @14,SVTABFST(,@14)                                  1082
         ST    @14,SVTABPTR                                        1082
*   SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR                   */
         LA    SNTELPTR,12                                         1083
         ALR   SNTELPTR,SNTABPTR                                   1083
*   ENDPTR=ECDALNEL+ECDALNEL->SNTLNG+LENGTH(SNTELEM);/* FIND END OF
*                                      CURRENT SNTAB                 */
*                                                                  1084
         L     @14,ECDALNEL(,ECDAPTR)                              1084
         LH    ENDPTR,SNTLNG(,@14)                                 1084
         ALR   ENDPTR,@14                                          1084
         AL    ENDPTR,@CF00088                                     1084
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE IF SYBMOLIC PARAMETER IS ALREADY DEFINED            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1085
*   CYCLE=CON1;                     /* INDICATOR                     */
         LA    CYCLE,1                                             1085
*   DO WHILE SNTELPTR^=ENDPTR&CYCLE=CON1;/* DO WHILE                 */
         B     @DE01086                                            1086
@DL01086 DS    0H                                                  1087
*     IF SNTLNG=PARMLNG&            /* IF THE CURRENT ELEMENT IS     */
*         SNTDATA(1:SNTLNG)=PARMDAT(1:SNTLNG) THEN/* THE SAME LENGTH,
*                                      CHECK THE NAME - WHEN EQUAL   */
         LH    @14,SNTLNG(,SNTELPTR)                               1087
         C     @14,PARMLNG                                         1087
         BNE   @RF01087                                            1087
         BCTR  @14,0                                               1087
         L     @08,PARMADR                                         1087
         EX    @14,@SC00865                                        1087
         BNE   @RF01087                                            1087
*       CYCLE=CON0;                 /* TERMINATE THE LOOP            */
         SLR   CYCLE,CYCLE                                         1088
*     ELSE                          /* UPDATE TO THE NEXT SNTAB ELMT */
*                                                                  1089
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE TO NEXT SNTAB ELEMENT                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1089
*       IF SNTLAST=ON THEN          /* IF THIS IS LAST ELEMENT IN    */
         B     @RC01087                                            1089
@RF01087 TM    SNTLAST(SNTELPTR),B'00000001'                       1089
         BNO   @RF01089                                            1089
*         DO;                       /* THIS SNTAB THE LOCATE NEXT    */
*           SNTABPTR=SNTABNXT;      /* TABLE AND ITS FIRST ELEMENT   */
         L     SNTABPTR,SNTABNXT(,SNTABPTR)                        1091
*           SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR           */
         LA    SNTELPTR,12                                         1092
         ALR   SNTELPTR,SNTABPTR                                   1092
*         END;                                                     1093
*       ELSE                        /* OTHERWISE GET NEXT ELEMENT    */
*         SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);/* ELEMENT PTR    */
         B     @RC01089                                            1094
@RF01089 LR    @14,SNTELPTR                                        1094
         AH    @14,SNTLNG(,SNTELPTR)                               1094
         AL    @14,@CF00088                                        1094
         LR    SNTELPTR,@14                                        1094
*   END;                                                           1095
@RC01089 DS    0H                                                  1095
@RC01087 DS    0H                                                  1095
@DE01086 CR    SNTELPTR,ENDPTR                                     1095
         BE    @DC01086                                            1095
         C     CYCLE,@CF00033                                      1095
         BE    @DL01086                                            1095
@DC01086 DS    0H                                                  1096
*   IF CYCLE=CON0 THEN              /* IF THE PARM WAS ALREADY       */
         LTR   CYCLE,CYCLE                                         1096
         BNZ   @RF01096                                            1096
*     DO;                           /* DEFINED AND WE ARE CALLED     */
*       IF PARMTYPE^=KEYW THEN      /* PLACE A LABEL OR A GLOBAL     */
         LH    @14,PARMTYPE                                        1098
         C     @14,@CF00250                                        1098
         BE    @RF01098                                            1098
*         DO;                       /* IN THE SNTAB THEN IT IS AN  1099
*                                      ERROR---ISSUE MESSAGE, RETURN */
*           STMT=ONS;               /* STATEMENT NUMBER REQUITED     */
         OI    STMT,B'10000000'                                    1100
*           NOTEXEC=ON;             /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1101
*           IF PARMTYPE=LABL THEN   /* IF LABEL WAS SEARCH ARGUMNT   */
         C     @14,@CF00033                                        1102
         BNE   @RF01102                                            1102
*             EXMSGID=M531;         /* USE MESSAGE IKJ56531          */
         MVC   EXMSGID(4),@CC00485                                 1103
*           ELSE                    /* OTHERWISE USE GLOBAL MESSAGE  */
*             EXMSGID=A530;         /* MSG ID                        */
         B     @RC01102                                            1104
@RF01102 MVC   EXMSGID(4),@CC00487                                 1104
*           MVAR(2)=PARMADR;        /* ADDR OF MSG VARIABLE          */
@RC01102 L     @14,PARMADR                                         1105
         ST    @14,MVAR+4                                          1105
*           MVARLEN(2)=PARMLNG;     /* LENGTH OF MSG VARIABLE        */
         L     @14,PARMLNG                                         1106
         STC   @14,MVARLEN+4                                       1106
*           CALL MSGRTN;            /* CALL MSG RTN                  */
         BAL   @14,MSGRTN                                          1107
*         END;                                                     1108
*       ELSE                        /* IF CALLED ONLY TO LOCATE A    */
*         PARMRADR=SNTELPTR;        /* SYMBOLIC PARM THEN RETURN     */
         B     @RC01098                                            1109
@RF01098 ST    SNTELPTR,PARMRADR                                   1109
*       RETURN CODE(CON0);          /* WITH ITS ADDRESS              */
@RC01098 SLR   @15,@15                                             1110
         L     @14,@SA00019                                        1110
         LM    @00,@12,@SA00019+8                                  1110
         BR    @14                                                 1110
*     END;                                                         1111
*   ELSE                            /* ELSE                          */
*     IF PARMLNG>THIRTY1 THEN       /* NEW PARMS CANNOT BE GREATER   */
@RF01096 L     @14,PARMLNG                                         1112
         C     @14,@CF00041                                        1112
         BNH   @RF01112                                            1112
*       DO;                         /* THAN 31 - IF SO ISSUE         */
*         STMT=ONS;                 /* MESSAGE AND RETURN            */
         OI    STMT,B'10000000'                                    1114
*         MVAR(2)=PARMADR;          /* PTR TO MSG VARIABLE           */
         L     @08,PARMADR                                         1115
         ST    @08,MVAR+4                                          1115
*         IF PARMLNG>ONE27 THEN     /* TRUNCATE LEN TO 127           */
         C     @14,@CF00475                                        1116
         BNH   @RF01116                                            1116
*           MVARLEN(2)=ONE27;       /* LENGTH OF MSG VARIABLE        */
         MVI   MVARLEN+4,X'7F'                                     1117
*         ELSE                      /* OTHERWISE USE THE PARM LEN    */
*           MVARLEN(2)=PARMLNG;     /* LENGTH OF MSG VARIABLE        */
         B     @RC01116                                            1118
@RF01116 L     @14,PARMLNG                                         1118
         STC   @14,MVARLEN+4                                       1118
*         NOTEXEC=ONS;              /* SET PROC NOT EXECUTABLE       */
@RC01116 OI    NOTEXEC(ECDAPTR),B'01000000'                        1119
*         EXMSGID=C540;             /* MSG ID                        */
         MVC   EXMSGID(4),@CC00511                                 1120
*         CALL MSGRTN;              /* CALL MSG RTN                  */
         BAL   @14,MSGRTN                                          1121
*         RETURN CODE(CON0);        /* RETURN                        */
         SLR   @15,@15                                             1122
         L     @14,@SA00019                                        1122
         LM    @00,@12,@SA00019+8                                  1122
         BR    @14                                                 1122
*       END;                                                       1123
*                                                                  1123
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NAME WAS NOT IN SYNTAB THEN CREATE AN ENTRY                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1124
*   IF NOTEXEC=OFF THEN             /* IF NO ERRORS YET, CONTINUE    */
@RF01112 TM    NOTEXEC(ECDAPTR),B'01000000'                        1124
         BNZ   @RF01124                                            1124
*     DO;                           /* WITH A TABLE UPDATE           */
*       IF((PARMTYPE^=GLOBAL&SNTABLNG-SNTABUSE<PARMLNG+LENGTH(SNTELEM))
*           (PARMTYPE=GLOBAL&NESTED=ON&SNTABLNG-SNTABUSE<PARMLNG+ 1126
*           LENGTH(SNTELEM))(PARMTYPE=GLOBAL&NESTED=OFF&SNTABLNG- 1126
*           SNTABUSE<PARMLNG+LENGTH(ECDAGCNT)+LENGTH(SNTELEM)*TWO))
*         THEN                                                     1126
         CLC   PARMTYPE(2),@CH00074                                1126
         BE    @GL00034                                            1126
         L     @14,SNTABLNG(,SNTABPTR)                             1126
         SL    @14,SNTABUSE(,SNTABPTR)                             1126
         LA    @08,8                                               1126
         AL    @08,PARMLNG                                         1126
         CR    @14,@08                                             1126
         BL    @RT01126                                            1126
@GL00034 CLC   PARMTYPE(2),@CH00074                                1126
         BNE   @GL00033                                            1126
         TM    NESTED(ECDAPTR),B'00000010'                         1126
         BNO   @GL00033                                            1126
         L     @14,SNTABLNG(,SNTABPTR)                             1126
         SL    @14,SNTABUSE(,SNTABPTR)                             1126
         LA    @08,8                                               1126
         AL    @08,PARMLNG                                         1126
         CR    @14,@08                                             1126
         BL    @RT01126                                            1126
@GL00033 CLC   PARMTYPE(2),@CH00074                                1126
         BNE   @RF01126                                            1126
         TM    NESTED(ECDAPTR),B'00000010'                         1126
         BNZ   @RF01126                                            1126
         L     @14,SNTABLNG(,SNTABPTR)                             1126
         SL    @14,SNTABUSE(,SNTABPTR)                             1126
         LA    @08,20                                              1126
         AL    @08,PARMLNG                                         1126
         CR    @14,@08                                             1126
         BNL   @RF01126                                            1126
@RT01126 DS    0H                                                  1127
*         DO;                       /* DO GROUP                      */
*           ECDALNEL->SNTLAST=ON;   /* IF NO SPACE IS AVAILABLE IN   */
         L     @14,ECDALNEL(,ECDAPTR)                              1128
         OI    SNTLAST(@14),B'00000001'                            1128
*           FREEADR=(SNTABPTR+SNTABUSE/* PRESENT THEN GET A NEW TAB  */
*               +SEVEN)/EIGHT*EIGHT;/*                               */
         L     @14,SNTABUSE(,SNTABPTR)                             1129
         LR    @00,SNTABPTR                                        1129
         ALR   @00,@14                                             1129
         AL    @00,@CF00149                                        1129
         SRDA  @00,32                                              1129
         D     @00,@CF00088                                        1129
         SLA   @01,3                                               1129
         ST    @01,FREEADR                                         1129
*           FREEAMT=SNTABPTR+SNTABLNG-FREEADR;/*                     */
         LR    FREEAMT,SNTABPTR                                    1130
         AL    FREEAMT,SNTABLNG(,SNTABPTR)                         1130
         SLR   FREEAMT,@01                                         1130
*           SNTABLNG=SNTABUSE;      /*                               */
         ST    @14,SNTABLNG(,SNTABPTR)                             1131
*           DO;                     /* FREEMAIN (E) LV(FREEAMT)    1132
*                                      A(FREEADR) SP(78)             */
*             RESPECIFY                                            1133
*              (GPR01P) RESTRICTED;                                1133
*             I005=I005&&I005;      /* INIT LIST                     */
         XC    I005(10),I005                                       1134
*             I00505='00'X;         /* SET TYPE                      */
         MVI   I00505,X'00'                                        1135
*             I00502=FREEAMT;       /* LENGTH                        */
         STCM  FREEAMT,7,I00502                                    1136
*             I00504=ADDR(FREEADR); /* ADDR OF ADDR LIST             */
         LA    @14,FREEADR                                         1137
         STCM  @14,7,I00504                                        1137
*             I00506=78;            /* SUBPOOL VALUE                 */
         MVI   I00506,X'4E'                                        1138
*             GPR01P=ADDR(I005);    /* REG1 POINTS TO LIST           */
         LA    GPR01P,I005                                         1139
*             SVC(5);               /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   1140
*             RESPECIFY                                            1141
*              (GPR01P) UNRESTRICTED;                              1141
*           END;                    /* FREEMAIN (E) LV(FREEAMT)    1142
*                                      A(FREEADR) SP(78) FREEMAIN    */
*           GETAMT=(SNTABLNG+FREEAMT+LENGTH(SNTELEM)*TWO+PARMLNG+LENGTH
*               (ECDAGCNT)+SEVEN)/EIGHT*EIGHT;/* AMOUNT              */
         LR    @00,FREEAMT                                         1143
         AL    @00,SNTABLNG(,SNTABPTR)                             1143
         AL    @00,@CF00191                                        1143
         AL    @00,PARMLNG                                         1143
         AL    @00,@CF00392                                        1143
         SRDA  @00,32                                              1143
         D     @00,@CF00088                                        1143
         SLA   @01,3                                               1143
         LR    GETAMT,@01                                          1143
*           RFY                                                    1144
*             R15 RSTD;             /* RESTRICT R15                  */
*           DO;                     /* GETMAIN (EC) LV(GETAMT)     1145
*                                      A(GETADR) SP(78)              */
*             RESPECIFY                                            1146
*              (GPR01P) RESTRICTED;                                1146
*             I004=I004&&I004;      /* INIT LIST                     */
         XC    I004(10),I004                                       1147
*             I00404='20'X;         /* TYPE                          */
         MVI   I00404,X'20'                                        1148
*             I00401=GETAMT;        /* LENGTH                        */
         ST    GETAMT,I00401                                       1149
*             I00403=ADDR(GETADR);  /* ADDR OF ADDR LIST             */
         LA    @14,GETADR                                          1150
         STCM  @14,7,I00403                                        1150
*             I00405=78;            /* SUBPOOL VALUE                 */
         MVI   I00405,X'4E'                                        1151
*             GPR01P=ADDR(I004);    /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         1152
*             SVC(4);               /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   1153
*             RESPECIFY                                            1154
*              (GPR01P) UNRESTRICTED;                              1154
*           END;                    /* GETMAIN (EC) LV(GETAMT)     1155
*                                      A(GETADR) SP(78) GETMAIN      */
*           IF R15^=CON0 THEN       /* IF GETMAIN FAILS THEN         */
         LTR   R15,R15                                             1156
         BZ    @RF01156                                            1156
*             DO;                   /* NOTIFY USER AND RETURN        */
*               RFY                                                1158
*                 R15 UNRSTD;       /* RELEASE R15                   */
*               EXMSGID=M511;       /* MSG ID                        */
         MVC   EXMSGID(4),@CC00481                                 1159
*               NOTEXEC=ON;         /* SET PROC NOT EXECUTABLE       */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1160
*               CALL MSGRTN;        /* CALL MSGRTN                   */
         BAL   @14,MSGRTN                                          1161
*               RETURN CODE(CON16); /* RETURN                        */
         LA    @15,16                                              1162
         L     @14,@SA00019                                        1162
         LM    @00,@12,@SA00019+8                                  1162
         BR    @14                                                 1162
*             END;                                                 1163
*           GETADR->SNTABNXT=CON0;  /* ADDR OF NEXT TABLE            */
@RF01156 L     @06,GETADR                                          1164
         SLR   @05,@05                                             1164
         ST    @05,SNTABNXT(,@06)                                  1164
*           GETADR->SNTABLNG=GETAMT;/* AMOUNT OF GOTTEN CORE         */
         ST    GETAMT,SNTABLNG(,@06)                               1165
*           GETADR->SNTABUSE=LENGTH(SNTAB);/* LENGTH OF TABLE        */
         LA    @08,12                                              1166
         ST    @08,SNTABUSE(,@06)                                  1166
*           SNTABNXT=GETADR;        /* ADDR OF NEXT TABLE            */
         ST    @06,SNTABNXT(,SNTABPTR)                             1167
*           SNTABPTR=SNTABNXT;      /* PTR TO NEXT TABLE             */
         LR    SNTABPTR,@06                                        1168
*           SNTELPTR=SNTABPTR+LENGTH(SNTAB);/* ELEMENT PTR           */
         ALR   @08,SNTABPTR                                        1169
         LR    SNTELPTR,@08                                        1169
*         END;                                                     1170
*                                                                  1170
*       /*************************************************************/
*       /*                                                           */
*       /* PLACE NAME OF PARAMETER IN SNTAB                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1171
*       SNTFLAGS=SNTFLAGS&&SNTFLAGS;/* FLAGS                         */
@RF01126 XC    SNTFLAGS(2,SNTELPTR),SNTFLAGS(SNTELPTR)             1171
*       SNTDATA(1:PARMLNG)=PARMDAT(1:PARMLNG);/* DATA                */
         L     @08,PARMLNG                                         1172
         LR    @06,@08                                             1172
         BCTR  @06,0                                               1172
         L     @05,PARMADR                                         1172
         EX    @06,@SM00867                                        1172
*       SNTLNG=PARMLNG;             /* LENGTH                        */
         STH   @08,SNTLNG(,SNTELPTR)                               1173
*       SNTABUSE=SNTABUSE+SNTLNG+LENGTH(SNTELEM);/* AMOUNT USED      */
         AL    @08,SNTABUSE(,SNTABPTR)                             1174
         AL    @08,@CF00088                                        1174
         ST    @08,SNTABUSE(,SNTABPTR)                             1174
*       PARMRADR=SNTELPTR;          /* SEND BACK ELEMENT PTR         */
         ST    SNTELPTR,PARMRADR                                   1175
*       IF PARMTYPE=LABL THEN       /* IF PARAMETER IS A LABEL       */
         CLC   PARMTYPE(2),@CH00033                                1176
         BNE   @RF01176                                            1176
*         DO;                       /* THEN PLACE ITS ADDRESS IN     */
*           SNTLABEL=ON;            /* VALUE PTR                     */
         OI    SNTLABEL(SNTELPTR),B'00010000'                      1178
*           SNTVLPTR=ECDACNXT;      /* VALUE PTR                     */
         L     @08,ECDACNXT(,ECDAPTR)                              1179
         ST    @08,SNTVLPTR(,SNTELPTR)                             1179
*         END;                                                     1180
*       ELSE                        /* DETERMINE IF PARM IS A        */
*         IF PARMTYPE^=GLOBAL THEN  /* KEYWORD OR GLOBAL?            */
         B     @RC01176                                            1181
@RF01176 CLC   PARMTYPE(2),@CH00074                                1181
         BE    @RF01181                                            1181
*           DO;                     /* -KEYWORD---PUT VALUE IN       */
*             SNTKEYW=ON;           /* VALUE POINTER                 */
         OI    SNTKEYW(SNTELPTR),B'00100000'                       1183
*             SNTVLPTR=ADDR(SVTELFST);/* VALUE PTR                   */
         L     @08,SVTABPTR                                        1184
         LA    @08,SVTELFST(,@08)                                  1184
         ST    @08,SNTVLPTR(,SNTELPTR)                             1184
*           END;                                                   1185
*         ELSE                      /* ELSE                          */
*           DO;                                                    1186
         B     @RC01181                                            1186
@RF01181 DS    0H                                                  1187
*             SNTGLOB=ON;           /* GLOBAL                        */
         OI    SNTGLOB(SNTELPTR),B'10000000'                       1187
*             SNTGVAL=ECDAGCNT;     /* SAVE THE CURRENT GLOBAL VALUE */
         L     @08,ECDAGCNT(,ECDAPTR)                              1188
         ST    @08,SNTGVAL(,SNTELPTR)                              1188
*             IF NESTED=OFF THEN    /* IF THIS IS THE FIRST NESTED   */
         TM    NESTED(ECDAPTR),B'00000010'                         1189
         BNZ   @RF01189                                            1189
*               DO;                 /* LEVEL, THEN CREATE A GLOBAL 1190
*                                      NAME ENTRY IN THE SNTAB       */
*                 SNTELPTR=SNTELPTR+SNTLNG+LENGTH(SNTELEM);        1191
         LA    @08,8                                               1191
         LR    @06,SNTELPTR                                        1191
         AH    @06,SNTLNG(,SNTELPTR)                               1191
         ALR   @06,@08                                             1191
         LR    SNTELPTR,@06                                        1191
*                 SNTDATA(1:LENGTH(GLOBVAL))=GLOBVAL;/* MOVE IN THE
*                                      NEW NAME                      */
         MVC   SNTDATA(4,SNTELPTR),GLOBVAL(ECDAPTR)                1192
*                 SNTFLAGS=SNTFLAGS&&SNTFLAGS;/* NO FLAGS SET        */
         XC    SNTFLAGS(2,SNTELPTR),SNTFLAGS(SNTELPTR)             1193
*                 SNTVLPTR=ADDR(SVTELFST);/* VALUE IS INITIALLY NULL */
         L     @06,SVTABPTR                                        1194
         LA    @06,SVTELFST(,@06)                                  1194
         ST    @06,SNTVLPTR(,SNTELPTR)                             1194
*                 SNTLNG=LENGTH(GLOBVAL);/* LENGTH                   */
         LA    @06,4                                               1195
         STH   @06,SNTLNG(,SNTELPTR)                               1195
*                 SNTABUSE=SNTABUSE+SNTLNG+LENGTH(SNTELEM);/* USED   */
         AL    @06,SNTABUSE(,SNTABPTR)                             1196
         ALR   @06,@08                                             1196
         ST    @06,SNTABUSE(,SNTABPTR)                             1196
*               END;                                               1197
*           END;                                                   1198
@RF01189 DS    0H                                                  1199
*       ECDALNEL=SNTELPTR;          /* ELEMENT PTR                   */
@RC01181 DS    0H                                                  1199
@RC01176 ST    SNTELPTR,ECDALNEL(,ECDAPTR)                         1199
*     END;                                                         1200
*   IF PARMTYPE=GLOBAL THEN         /* IF PARM WAS A GLOBAL THEN     */
@RF01124 CLC   PARMTYPE(2),@CH00074                                1201
         BNE   @RF01201                                            1201
*     DO;                                                          1202
*       IF NESTED=ONS&ECDAGCNT>GEXECDAT->GEXECCNT THEN/* MAKE SURE WE
*                                      DONT HAVE TOO MANY            */
         TM    NESTED(ECDAPTR),B'00000010'                         1203
         BNO   @RF01203                                            1203
         L     @08,ECDALSD(,ECDAPTR)                               1203
         L     @08,LSDEXEC(,@08)                                   1203
         L     @08,GEXECDAT(,@08)                                  1203
         L     @06,ECDAGCNT(,ECDAPTR)                              1203
         C     @06,GEXECCNT(,@08)                                  1203
         BNH   @RF01203                                            1203
*         DO;                                                      1204
*           NOTEXEC=ON;             /* COMMAND PROC NOT EXECUTABLE   */
         OI    NOTEXEC(ECDAPTR),B'01000000'                        1205
*           EXMSGID=M535;           /* MESSAGE TO BE ISSUED          */
         MVC   EXMSGID(4),@CC00489                                 1206
*           STMT=ONS;               /* STATEMENT NUMBERS REQ         */
         OI    STMT,B'10000000'                                    1207
*           CALL MSGRTN;            /* ISSUE MESSAGE                 */
         BAL   @14,MSGRTN                                          1208
*         END;                                                     1209
*       ECDAGCNT=ECDAGCNT+ONE;      /* UP THE GLOBAL COUNT BY ONE    */
@RF01203 LA    @08,1                                               1210
         AL    @08,ECDAGCNT(,ECDAPTR)                              1210
         ST    @08,ECDAGCNT(,ECDAPTR)                              1210
*     END;                                                         1211
*   RETURN CODE(CON0);              /* RETURN                        */
@RF01201 SLR   @15,@15                                             1212
         L     @14,@SA00019                                        1212
         LM    @00,@12,@SA00019+8                                  1212
         BR    @14                                                 1212
*   END SYNTAB;                                                    1213
*                                                                  1214
*/********************************************************************/
*/* GETALINE ROUTINE - THE GETALINE ROUTINE ISSUES DATA SET I/O      */
*/*                   GETLINES FOR THE CLIST RECORDS FROM THE        */
*/*                   INPUT DATA SET                                 */
*/********************************************************************/
*                                                                  1214
*GETALINE:                                                         1214
*   PROC;                                                          1214
GETALINE STM   @14,@12,@SA00020                                    1214
*   DO WHILE ECDAIREC->OO^=0;       /* DO GROUP                      */
         B     @DE01215                                            1215
@DL01215 DS    0H                                                  1216
*     ECDAIREC=ECDAIREC-ECDAIREC->OO;/* ADJUST POINTER IN BFR FREE 1216
*                                      THE PREVIOUS BUFFER           */
         L     @08,ECDAIREC(,ECDAPTR)                              1216
         LR    @06,@08                                             1216
         SH    @06,OO(,@08)                                        1216
         ST    @06,ECDAIREC(,ECDAPTR)                              1216
*   END;                                                           1217
@DE01215 L     @08,ECDAIREC(,ECDAPTR)                              1217
         LH    @06,OO(,@08)                                        1217
         LTR   @06,@06                                             1217
         BNZ   @DL01215                                            1217
*   DO;                             /* FREEMAIN (E)                1218
*                                      LV(ECDAIREC->RECLEN)        1218
*                                      A(ECDAIREC) SP(1)             */
*     RESPECIFY                                                    1219
*      (GPR01P) RESTRICTED;                                        1219
*     I005=I005&&I005;              /* INIT LIST                     */
         XC    I005(10),I005                                       1220
*     I00505='00'X;                 /* SET TYPE                      */
         MVI   I00505,X'00'                                        1221
*     I00502=ECDAIREC->RECLEN;      /* LENGTH                        */
         LH    @08,RECLEN(,@08)                                    1222
         STCM  @08,7,I00502                                        1222
*     I00504=ADDR(ECDAIREC);        /* ADDR OF ADDR LIST             */
         LA    @08,ECDAIREC(,ECDAPTR)                              1223
         STCM  @08,7,I00504                                        1223
*     I00506=1;                     /* SUBPOOL VALUE                 */
         MVI   I00506,X'01'                                        1224
*     GPR01P=ADDR(I005);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I005                                         1225
*     SVC(5);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   5                                                   1226
*     RESPECIFY                                                    1227
*      (GPR01P) UNRESTRICTED;                                      1227
*   END;                            /* FREEMAIN (E)                1228
*                                      LV(ECDAIREC->RECLEN)        1228
*                                      A(ECDAIREC) SP(1) NOT FIRST 1228
*                                      READ                          */
*   RFY                                                            1229
*    (R1,                                                          1229
*     R15) RSTD;                    /* RESTRICT R1,R15               */
*   R1=ECDASPTR;                    /* IOPL ADDR                     */
         L     R1,ECDASPTR(,ECDAPTR)                               1230
*   R15=ECDAGETL;                   /* LOAD GETLINE ADDR             */
         L     R15,ECDAGETL(,ECDAPTR)                              1231
*   GEN(GETLINE MF=(E,(1)),ENTRY=(15));/* GET THE NEXT RECORD        */
         GETLINE MF=(E,(1)),ENTRY=(15)
*   SRETCDE=R15;                    /* SAVE THE RETURN CODE          */
         ST    R15,SRETCDE                                         1233
*   RFY                                                            1234
*    (R1,                                                          1234
*     R15) UNRSTD;                  /* RELEASE                       */
*   IF SRETCDE^=FOUR&               /* IF RETURN CODE ABNORMAL       */
*       SRETCDE^=CON16 THEN         /* THEN NOTIFY USER AND TAKE     */
         L     @08,SRETCDE                                         1235
         C     @08,@CF00072                                        1235
         BE    @RF01235                                            1235
         C     @08,@CF00191                                        1235
         BE    @RF01235                                            1235
*     DO;                           /* THE ERROR EXIT                */
*       MVAR(1)=ADDR(GETLIN);       /* INSERTION VARIABLES           */
         LA    @08,@CC00564                                        1237
         ST    @08,MVAR                                            1237
*       MVARLEN(1)=LENGTH(GETLIN);  /* LENGTH OF MSG VARIABLE        */
         MVI   MVARLEN,X'07'                                       1238
*       MVAR(2)=ADDR(SRETCDE);      /* REURN CODE WILL BE IN MESSAGE */
         LA    @08,SRETCDE                                         1239
         ST    @08,MVAR+4                                          1239
*       MVARLEN(2)=LENGTH(SRETCDE); /* LENGTH OF MSG VARIABLE        */
         MVI   MVARLEN+4,X'04'                                     1240
*       MVARHEX(2)=ON;              /* MSG SWITCH                    */
         OI    MVARHEX+4,B'10000000'                               1241
*       EXMSGID=M524;               /* MSG ID                        */
         MVC   EXMSGID(4),@CC00483                                 1242
*       CALL MSGRTN;                /* ISSUE MESSAGE                 */
         BAL   @14,MSGRTN                                          1243
*       SRETCDE=TWENTY;             /* RETURN CODE OF 20             */
         MVC   SRETCDE(4),@CF00357                                 1244
*     END;                                                         1245
*   ELSE                            /* 4 OR 16 IS NORMAL             */
*     IF SRETCDE=FOUR THEN          /* RECORD WAS FOUND              */
         B     @RC01235                                            1246
@RF01235 CLC   SRETCDE(4),@CF00072                                 1246
         BNE   @RF01246                                            1246
*       DO;                                                        1247
*         ECDALCTR=ECDALCTR+CON1;   /* UP LINE COUNT                 */
         LA    @08,1                                               1248
         AL    @08,ECDALCTR(,ECDAPTR)                              1248
         ST    @08,ECDALCTR(,ECDAPTR)                              1248
*         SRETCDE=ZERO;             /* CONVERT TO NORMAL RETURN      */
         SLR   @08,@08                                             1249
         ST    @08,SRETCDE                                         1249
*       END;                                                       1250
*     ELSE                          /* END OF FILE                   */
*       SRETCDE=FOUR;               /* END OF FILE RETURN CODE       */
         B     @RC01246                                            1251
@RF01246 MVC   SRETCDE(4),@CF00072                                 1251
*   ECDAIREC=GTPBIBUF;              /* UPDATE TO INPUT RECORD        */
@RC01246 DS    0H                                                  1252
@RC01235 L     @08,ECDASPTR(,ECDAPTR)                              1252
         L     @08,IOPLIOPB(,@08)                                  1252
         L     @08,GTPBIBUF(,@08)                                  1252
         ST    @08,ECDAIREC(,ECDAPTR)                              1252
*   RETURN CODE(SRETCDE);           /* RETURN                        */
         L     @15,SRETCDE                                         1253
         L     @14,@SA00020                                        1253
         LM    @00,@12,@SA00020+8                                  1253
         BR    @14                                                 1253
*   END GETALINE;                   /* END OF GETLINE ROUTINE        */
*                                                                  1255
*   /*****************************************************************/
*   /*                                                               */
*   /* MSGRTN - THE MESSAGE ROUTINE BUILDS THE IKJEFF02 PARAMETER    */
*   /* LIST AND THEN INVOKES IKJEFF02 TO ISSUE A MESSAGE             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1255
*MSGRTN:                                                           1255
*   PROC OPTIONS(SAVEAREA);                                        1255
MSGRTN   STM   @14,@12,12(@13)                                     1255
         ST    @13,@SA00021+4                                      1255
         LA    @14,@SA00021                                        1255
         ST    @14,8(,@13)                                         1255
         LR    @13,@14                                             1255
*   ECB=ZERO;                       /* ZERO ECB                      */
         SLR   @08,@08                                             1256
         ST    @08,ECB                                             1256
*   MSGTABLE=MSGTABLE&&MSGTABLE;    /* INITIALIZE IKJEFF02 PARMLIST  */
         XC    MSGTABLE(56),MSGTABLE                               1257
*   LISTPTR=ADDR(MSGCSECT);         /* START OF MESSAGE PARMS        */
         LA    @08,MSGCSECT                                        1258
         ST    @08,LISTPTR                                         1258
*   TMCTPTR=CPPLPTR;                /* ADDRESS OF THE CPPL           */
         L     @08,CPPLPTR(,ECDAPTR)                               1259
         ST    @08,TMCTPTR                                         1259
*   ECBPTR=ADDR(ECB);               /* DUMMY ECB ADDRESS             */
         LA    @08,ECB                                             1260
         ST    @08,ECBPTR                                          1260
*   MSGCSECT=ADDR(IKJCT435);        /* IKJCT435 IS MESSAGE CSECT     */
         L     @08,@CV00340                                        1261
         ST    @08,MSGCSECT                                        1261
*   MTPUTLSW=ON;                    /* PUTLINE MESSAGE REUESTED      */
         OI    MTPUTLSW,B'01000000'                                1262
*   MSGID=EXMSGID;                  /* ID OF THE MESSAGE TO BE ISSUED*/
         MVC   MSGID(4),EXMSGID                                    1263
*   IF STMT=ONS THEN                /* STATEMENT NUMBER REQ ?        */
         TM    STMT,B'10000000'                                    1264
         BNO   @RF01264                                            1264
*     DO;                           /* --YUP--                       */
*       STMT=OFF;                   /* RESET SWITCH                  */
         NI    STMT,B'01111111'                                    1266
*       MVAR(1)=ADDR(AREAA);        /* INSERT                        */
         LA    @08,AREAA                                           1267
         ST    @08,MVAR                                            1267
*       AREAA=CSTMT;                /* 'STMT'                        */
         MVI   AREAA+4,C' '                                        1268
         MVC   AREAA(4),@CC00543                                   1268
*       CVD(ECDALCTR,WORKAREA);     /* CONVERT TO DECIMAL            */
         L     @08,ECDALCTR(,ECDAPTR)                              1269
         CVD   @08,WORKAREA                                        1269
*       UNPK(AREAB,WORKAREA);       /* CONVERT TO PRINTABLE          */
         UNPK  AREAB(8),WORKAREA(8)                                1270
*       AREAB(LENGTH(AREAB))=AREAB(LENGTH(AREAB))FOXZERO;/*         */
         OI    AREAB+7,C'0'                                        1271
*       DO ICTR=LENGTH(AREAB) TO 2 BY-1 WHILE AREAB(1)=FOXZERO;/*    */
         LA    ICTR,8                                              1272
@DL01272 CLI   AREAB,C'0'                                          1272
         BNE   @DC01272                                            1272
*         AREAB(1:LENGTH(AREAB)-1)=AREAB(2:LENGTH(AREAB));/*         */
         MVC   @TS00001(7),AREAB+1                                 1273
         MVC   AREAB(7),@TS00001                                   1273
*       END;                                                       1274
         BCTR  ICTR,0                                              1274
         C     ICTR,@CF00074                                       1274
         BNL   @DL01272                                            1274
@DC01272 DS    0H                                                  1275
*       MVARLEN(1)=LENGTH(AREAA)+ICTR;/* LENGTH OF MSG VARIABLE      */
         LA    @06,5                                               1275
         ALR   @06,ICTR                                            1275
         STC   @06,MVARLEN                                         1275
*     END;                                                         1276
*   DO ICTR=1 TO DIM(MVAR);         /* MVAR HAS BEEN PREVIOUSLY SET  */
@RF01264 LA    ICTR,1                                              1277
@DL01277 DS    0H                                                  1278
*     MTINSRT(ICTR)=MVAR(ICTR);     /* MVAR HAS BEEN PREVIOUSLY SET  */
         LR    @06,ICTR                                            1278
         SLA   @06,2                                               1278
         L     @15,MVAR-4(@06)                                     1278
         ST    @15,MTINSRT-4(@06)                                  1278
*   END;                                                           1279
         AL    ICTR,@CF00033                                       1279
         C     ICTR,@CF00250                                       1279
         BNH   @DL01277                                            1279
*   RFY                                                            1280
*    (R1) RSTD;                     /* RESTRICT REG 1                */
*   R1=ADDR(MSGTABLE);              /* ADDRESS OF MSGTABLE           */
         LA    R1,MSGTABLE                                         1281
*   DO;                             /* LINK EP(IKJEFF02)             */
*     I00601='00'X;                 /* EP/DE FLAG                    */
         MVI   I00601,X'00'                                        1283
*     I00602=ADDR(IKJEFF02);        /* ADDR OF EP/DE                 */
         LA    @08,@CC00566                                        1284
         STCM  @08,7,I00602                                        1284
*     I00604=0;                     /* DCB PTR                       */
         SLR   @08,@08                                             1285
         STCM  @08,7,I00604                                        1285
*     I00603='00'X;                 /* ERRET FLAG                    */
         MVI   I00603,X'00'                                        1286
*     RESPECIFY                                                    1287
*      (GPR15P) RESTRICTED;                                        1287
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */
         LA    GPR15P,I006                                         1288
*     SVC(6);                       /* ISSUE LINK SVC                */
         SVC   6                                                   1289
*     RESPECIFY                                                    1290
*      (GPR15P) UNRESTRICTED;                                      1290
*   END;                            /* LINK EP(IKJEFF02) USE IKJEFF02
*                                      TO ISSUE MESSAGE              */
*   RFY                                                            1292
*    (R1) UNRSTD;                   /* RELEASE REG 1                 */
*   END MSGRTN;                     /* END OF MSGRTN                 */
@EL00021 L     @13,4(,@13)                                         1293
@EF00021 DS    0H                                                  1293
@ER00021 LM    @14,@12,12(@13)                                     1293
         BR    @14                                                 1293
*                                                                  1294
*   /*****************************************************************/
*   /*                                                               */
*   /* PATCH AREA                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1294
*   DCL                                                            1294
*     PATCHES FIXED(31) STATIC;                                    1294
*   GEN DATA DEFS(PATCHES);                                        1295
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR15F FIXED(31) REG(15),                                    1296
*     GPR01P PTR(31) REG(1),                                       1296
*     GPR15P PTR(31) REG(15);                                      1296
*   DCL                                                            1297
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */
*      2 I00401 PTR(31),            /* LENGTH                        */
*      2 I00402 CHAR(1),            /* HIARCHY                       */
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */
*   DCL                                                            1298
*     1 I005 DEF(ILIST) BDY(WORD),  /* LIST FOR FREEMAIN             */
*       3 I00501 PTR(8),            /* RESERVED                      */
*       3 I00502 PTR(24),           /* LENGTH                        */
*       3 I00503 PTR(8),            /* RESERVED                      */
*       3 I00504 PTR(24),           /* ADDR OF ADDR LIST             */
*       3 I00505 BIT(8),            /* TYPE OF FREEMAIN              */
*       3 I00506 PTR(8);            /* SUBPOOL VALUE                 */
*   DCL                                                            1299
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */
*      2 I00602 PTR(24),            /* EP/DE PTR                     */
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */
*      2 I00604 PTR(24),            /* DCB PTR                       */
*      2 I00605 PTR(31);            /* ERRET PTR                     */
*   DECLARE                                                        1300
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1301
*     I031F FIXED(31) BASED,                                       1301
*     I031P PTR(31) BASED,                                         1301
*     I015F FIXED(15) BASED,                                       1301
*     I015P PTR(15) BASED,                                         1301
*     I008P PTR(8) BASED,                                          1301
*     I001C CHAR(1) BASED;                                         1301
*   END IKJCT432                                                   1302
*                                                                  1302
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJLSD  )                                       */
*/*%INCLUDE SYSLIB  (IKJIOPL )                                       */
*/*%INCLUDE SYSLIB  (IKJEXEC )                                       */
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */
*                                                                  1302
*       ;                                                          1302
@EL00001 L     @13,4(,@13)                                         1302
@EF00001 L     @00,@SIZDATD                                        1302
         LR    @01,@12                                             1302
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     1302
         BR    @14                                                 1302
@DATA    DS    0H
@CH00171 DC    H'9'
@CH00359 DC    H'12'
@CH00043 DC    H'15'
@SC00853 CLC   COMMAND(0,@06),ECDAAEND(ECDAPTR)
@SC00861 CLC   LINE(0,@14),0(@01)
@SM00863 MVC   ECDAAEND(0,ECDAPTR),LINE(@08)
@SC00865 CLC   SNTDATA(0,SNTELPTR),PARMDAT(@08)
@SM00867 MVC   SNTDATA(0,SNTELPTR),PARMDAT(@05)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00019 DS    15F
@SA00021 DS    18F
@SA00011 DS    15F
@SA00008 DS    14F
@SA00012 DS    14F
@SA00010 DS    15F
@SA00015 DS    15F
@SA00009 DS    14F
@SA00018 DS    14F
@SA00013 DS    14F
@SA00014 DS    14F
@SA00016 DS    15F
@SA00002 DS    15F
@SA00007 DS    13F
@SA00005 DS    14F
@SA00020 DS    15F
@SA00017 DS    15F
@AL00001 DS    1A
@TF00001 DS    F
IKJCT432 CSECT
         DS    0F
@CF00033 DC    F'1'
@CH00033 EQU   @CF00033+2
@CF00074 DC    F'2'
@CH00074 EQU   @CF00074+2
@CF00250 DC    F'3'
@CH00250 EQU   @CF00250+2
@CF00072 DC    F'4'
@CF00371 DC    F'5'
@CF00149 DC    F'7'
@CH00149 EQU   @CF00149+2
@CF00088 DC    F'8'
@CH00088 EQU   @CF00088+2
@CF00392 DC    F'11'
@CH00392 EQU   @CF00392+2
@CF00169 DC    F'14'
@CF00191 DC    F'16'
@CF00357 DC    F'20'
@CF00041 DC    F'31'
@CF00475 DC    F'127'
@CF00473 DC    F'252'
@CF00374 DC    F'255'
@CF00479 DC    F'256'
@CF00390 DC    F'4096'
@CF00388 DC    F'6144'
@CF00477 DC    F'36864'
@CF00838 DC    F'-6'
@CF00839 DC    F'-3'
@CF00840 DC    F'-2'
@DATD    DSECT
         DS    0D
LSDPTR   DS    A
IOPLPTR  DS    A
SVTABPTR DS    A
NEWSAVE  DS    A
GTMNPTR  DS    A
WORKPTR  DS    A
SCANPTR  DS    A
LENTH    DS    F
RLENGTH  DS    A
INDEX    DS    F
SRETCDE  DS    F
FREEADR  DS    A
GETADR   DS    A
ECB      DS    F
@TS00001 DS    CL7
@NM00008 DS    CL1
         ORG   @NM00008
SEPS     DS    BL1
EXACT    EQU   @NM00008+0
MATCH    EQU   @NM00008+0
AMBIG    EQU   @NM00008+0
         ORG   @NM00008+1
MSGTABLE DS    CL56
         ORG   MSGTABLE
LISTPTR  DS    AL4
TMCTPTR  DS    AL4
         ORG   TMCTPTR
MTCPPL   DS    AL4
         ORG   MSGTABLE+8
ECBPTR   DS    AL4
@NM00009 DS    AL4
         ORG   @NM00009
MTHIGH   DS    BL1
         ORG   MSGTABLE+16
MSGCSECT DS    AL4
SW       DS    AL1
         ORG   SW
MTNOIDSW DS    BL1
MTPUTLSW EQU   SW+0
MTWTOSW  EQU   SW+0
MTHEXSW  EQU   SW+0
MTKEY1SW EQU   SW+0
MTJOBISW EQU   SW+0
MTWTPSW  EQU   SW+0
MTNHEXSW EQU   SW+0
         ORG   MSGTABLE+21
RETMSG   DS    AL3
SW2      DS    AL1
         ORG   SW2
MT2OLDSW DS    BL1
MTDOMSW  EQU   SW2+0
MTNOXQSW EQU   SW2+0
MTNPLMSW EQU   SW2+0
MTPGMSW  EQU   SW2+0
@NM00010 EQU   SW2+0
         ORG   MSGTABLE+25
@NM00011 DS    AL3
MTOLDPTR DS    AL4
@NM00012 DS    AL4
@NM00013 DS    AL4
MSGID    DS    CL4
MTINSRTS DS    CL12
         ORG   MTINSRTS
MTINSRT  DS    CL4
         ORG   MTINSRT+0
MTLEN    DS    AL1
         ORG   MTLEN+0
MTHIGHL  DS    BL1
         ORG   MTINSRT+1
MTADDR   DS    AL3
         ORG   MSGTABLE+56
SCANLIST DS    CL17
         ORG   SCANLIST
LABLADD  DS    AL4
LABLLEN  DS    AL4
CMDADD   DS    AL4
CMDLEN   DS    AL4
FLAGS    DS    CL1
         ORG   FLAGS
LABLBAD  DS    BL1
CMDBAD   EQU   FLAGS+0
TSODISG  EQU   FLAGS+0
         ORG   SCANLIST+17
         DS    CL3
NAMELIST DS    CL12
         ORG   NAMELIST
NAMEPTR  DS    AL4
NAMELEN  DS    FL2
NAMEFLAG DS    FL2
         ORG   NAMEFLAG
LABELBIT DS    BL1
         ORG   NAMELIST+8
ANSWER   DS    AL4
         ORG   NAMELIST+12
NTUPTPRM DS    CL14
         ORG   NTUPTPRM
PARMADR  DS    AL4
PARMLNG  DS    FL4
PARMRADR DS    AL4
PARMTYPE DS    FL2
         ORG   NTUPTPRM+14
EXMSGID  DS    CL4
         DS    CL2
MOVELIST DS    CL8
         ORG   MOVELIST
DATAADD  DS    AL4
DATALEN  DS    FL4
         ORG   MOVELIST+8
SCANBYTE DS    CL2
         ORG   SCANBYTE
ALPHA    DS    BL1
NUMERIC  EQU   SCANBYTE+0
COLONB   EQU   SCANBYTE+0
PERCENTB EQU   SCANBYTE+0
AMPERSND EQU   SCANBYTE+0
SEPAR    EQU   SCANBYTE+0
SLASH    EQU   SCANBYTE+0
NALPHNUM EQU   SCANBYTE+0
OPAREN   DS    BL1
CPAREN   EQU   SCANBYTE+1
@NM00016 EQU   SCANBYTE+1
         ORG   SCANBYTE+2
ENDWORD  DS    CL1
         ORG   ENDWORD
NOTALPNU DS    BL1
WASPRCNT EQU   ENDWORD+0
WASAMPER EQU   ENDWORD+0
@NM00017 EQU   ENDWORD+0
         ORG   ENDWORD+1
@NM00018 DS    CL13
         ORG   @NM00018
AREAA    DS    CL5
AREAB    DS    CL8
         ORG   @NM00018+13
         DS    CL4
WORKAREA DS    CL8
STMT     DS    BL1
         DS    CL3
PARMS    DS    CL12
         ORG   PARMS
PARM1    DS    AL4
PARM2    DS    CL4
         ORG   PARM2
FLAG1    DS    CL1
         ORG   FLAG1
ENDFLAG2 DS    BL1
IFFLAG2  EQU   FLAG1+0
RETFLAG2 EQU   FLAG1+0
ELSFLAG2 EQU   FLAG1+0
NULINE   EQU   FLAG1+0
         ORG   PARMS+8
FALEND2  DS    AL4
         ORG   PARMS+12
ILIST    DS    CL12
MVAR     DS    AL4
         ORG   MVAR+0
MVARLEN  DS    AL1
         ORG   MVARLEN+0
MVARHEX  DS    BL1
         ORG   MVAR+12
IKJCT432 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CA00028 DC    A(IKJCT432)
@CV00340 DC    V(IKJCT435)
         DS    0D
@CC00418 DC    C'OPENFILE'
@CC00420 DC    C'CLOSFILE'
@CC00537 DC    C'READDVAL'
@CC00566 DC    C'IKJEFF02'
@CC00422 DC    C'GETFILE'
@CC00424 DC    C'PUTFILE'
@CC00535 DC    C'ENDDATA'
@CC00559 DC    C'CONTROL'
@CC00561 DC    C'WRITENR'
@CC00564 DC    C'GETLINE'
@CC00553 DC    C'GLOBAL'
@CC00555 DC    C'TERMIN'
@CC00557 DC    C'RETURN'
@CC00430 DC    C'WHILE'
@CC00549 DC    C'ERROR'
@CC00551 EQU   @CC00561
@CC00398 DC    C'THEN'
@CC00416 DC    C'ATTN'
@CC00481 DC    C'M511'
@CC00483 DC    C'M524'
@CC00485 DC    C'M531'
@CC00487 DC    C'A530'
@CC00489 DC    C'M535'
@CC00491 DC    C'M532'
@CC00493 DC    C'M533'
@CC00495 DC    C'M534'
@CC00497 DC    C'M536'
@CC00499 DC    C'M537'
@CC00501 DC    C'M538'
@CC00503 DC    C'M539'
@CC00505 DC    C'A540'
@CC00507 DC    C'B540'
@CC00509 DC    C'M543'
@CC00511 DC    C'C540'
@CC00515 DC    C'M526'
@CC00517 DC    C'M528'
@CC00519 DC    C'M544'
@CC00529 DC    C'ELSE'
@CC00533 DC    C'DATA'
@CC00541 DC    C'GOTO'
@CC00543 DC    C'STMT'
@CC00545 EQU   @CC00537
@CC00547 DC    C'EXIT'
@CC00187 EQU   @CC00535
@CC00414 DC    C'OFF'
@CC00539 DC    C'SET'
@CC00412 DC    C'DO'
@CC00455 DC    C'/*'
@CC00457 DC    C'*/'
@CC00527 DC    C'IF'
TABLE    DS    CL15
         ORG   TABLE+0
KEYWRD   DC    CL9'FLUSH'
KEYLEN   DC    AL2(5)
MASK1    DC    X'8000'
MASK2    DC    X'BFFF'
         ORG   TABLE+15
         ORG   TABLE+15
         DC    CL9'NOFLUSH'
         DC    AL2(7)
         DC    X'4000'
         DC    X'7FFF'
         ORG   TABLE+30
         ORG   TABLE+30
         DC    CL9'PROMPT'
         DC    AL2(6)
         DC    X'2000'
         DC    X'EFFF'
         ORG   TABLE+45
         ORG   TABLE+45
         DC    CL9'NOPROMPT'
         DC    AL2(8)
         DC    X'1000'
         DC    X'DFFF'
         ORG   TABLE+60
         ORG   TABLE+60
         DC    CL9'LIST'
         DC    AL2(4)
         DC    X'0800'
         DC    X'FBFF'
         ORG   TABLE+75
         ORG   TABLE+75
         DC    CL9'NOLIST'
         DC    AL2(6)
         DC    X'0400'
         DC    X'F7FF'
         ORG   TABLE+90
         ORG   TABLE+90
         DC    CL9'CONLIST'
         DC    AL2(7)
         DC    X'0200'
         DC    X'FEFF'
         ORG   TABLE+105
         ORG   TABLE+105
         DC    CL9'NOCONLIST'
         DC    AL2(9)
         DC    X'0100'
         DC    X'FDFF'
         ORG   TABLE+120
         ORG   TABLE+120
         DC    CL9'SYMLIST'
         DC    AL2(7)
         DC    X'0080'
         DC    X'FFBF'
         ORG   TABLE+135
         ORG   TABLE+135
         DC    CL9'NOSYMLIST'
         DC    AL2(9)
         DC    X'0040'
         DC    X'FF7F'
         ORG   TABLE+150
         ORG   TABLE+150
         DC    CL9'MSG'
         DC    AL2(3)
         DC    X'0020'
         DC    X'FFFE'
         ORG   TABLE+165
         ORG   TABLE+165
         DC    CL9'NOMSG'
         DC    AL2(5)
         DC    X'0010'
         DC    X'FFFD'
         ORG   TABLE+180
         ORG   TABLE+180
         DC    CL9'MAIN'
         DC    AL2(4)
         DC    X'0008'
         DC    X'FFFF'
         ORG   TABLE+195
         ORG   TABLE+195
         DC    CL9'END'
         DC    AL2(3)
         DC    X'0004'
         DC    X'FFFF'
         ORG   TABLE+210
         DS    CL2
ROUTE    DC    AL4(TSOCALL)
         DC    AL4(LENGTH2)
         DC    AL4(LENGTH3)
         DC    AL4(LENGTH4)
         DC    AL4(LENGTH5)
         DC    AL4(LENGTH6)
         DC    AL4(LENGTH7)
         DC    AL4(LENGTH8)
IKJCT432 CSECT
         DS   0H
PATCHES DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJCT432 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FREEAMT  EQU   @05
GETAMT   EQU   @08
CYCLE    EQU   @03
ENDPTR   EQU   @05
SAVEIREC EQU   @02
ICTR     EQU   @08
COUNT    EQU   @02
TRIP     EQU   @08
GETBYTE  EQU   @04
X        EQU   @08
PARMPTR  EQU   @08
ERRBASE  EQU   @05
DOBASE   EQU   @05
SAVENEXT EQU   @05
TRUESAV  EQU   @05
SAVEPTR  EQU   @02
RCODE    EQU   @04
LINCOUNT EQU   @03
LINEPTR  EQU   @05
SNTELPTR EQU   @02
SNTABPTR EQU   @04
ECDAPTR  EQU   @07
R9       EQU   @09
R10      EQU   @10
R11      EQU   @11
R15      EQU   @15
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
GPR01P   EQU   @01
GPR15F   EQU   @15
GPR15P   EQU   @15
LSD      EQU   0
LSDEXEC  EQU   LSD+12
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
ECDA     EQU   0
ECDACPPL EQU   ECDA
ECDALSD  EQU   ECDA+12
ECDAIREC EQU   ECDA+16
ECDACBLK EQU   ECDA+20
ECDACPRE EQU   ECDA+24
ECDACNXT EQU   ECDA+28
ECDASPTR EQU   ECDA+32
ECDALCTR EQU   ECDA+36
ECDALNEL EQU   ECDA+40
ECDAGCNT EQU   ECDA+44
ECDANDO  EQU   ECDA+48
ECDAELNG EQU   ECDA+50
ECDAAEND EQU   ECDA+52
ECDAFLAG EQU   ECDA+56
NOTEXEC  EQU   ECDAFLAG
NESTED   EQU   ECDAFLAG
ECDAGETL EQU   ECDA+60
ECDACPGM EQU   ECDA+68
ECDAINME EQU   ECDA+72
EXECDATA EQU   0
SNTABFST EQU   EXECDATA
SVTABFST EQU   EXECDATA+4
GEXECDAT EQU   EXECDATA+8
@NM00004 EQU   EXECDATA+16
EXDATFLG EQU   EXECDATA+32
@NM00005 EQU   EXDATFLG
GEXECCNT EQU   EXECDATA+36
COMPROC  EQU   0
COMPRPTR EQU   COMPROC
COMPRID  EQU   COMPRPTR
COMPRNXT EQU   COMPRPTR+1
COMPRLNG EQU   COMPROC+4
COMPRUSE EQU   COMPROC+8
SNTAB    EQU   0
SNTABNXT EQU   SNTAB
SNTABLNG EQU   SNTAB+4
SNTABUSE EQU   SNTAB+8
SNTELEM  EQU   0
SNTVLPTR EQU   SNTELEM
SNTGVAL  EQU   SNTVLPTR
SNTFLAGS EQU   SNTELEM+4
SNTKEYW  EQU   SNTFLAGS
SNTLABEL EQU   SNTFLAGS
SNTLAST  EQU   SNTFLAGS
SNTGLOB  EQU   SNTFLAGS+1
SNTLNG   EQU   SNTELEM+6
SNTDATA  EQU   SNTELEM+8
SVTAB    EQU   0
SVTELFST EQU   SVTAB+16
SVTELEM  EQU   0
CPPL     EQU   0
RET      EQU   0
LINE     EQU   0
PARMBLOC EQU   0
ECDAPTR2 EQU   PARMBLOC
FLAAGS   EQU   PARMBLOC+4
FLAG     EQU   FLAAGS
ENDFLAG  EQU   FLAG
IFFLAG   EQU   FLAG
RETFLAG  EQU   FLAG
ELSFLAG  EQU   FLAG
NULLINE  EQU   FLAG
FALEND   EQU   PARMBLOC+8
COMMAND  EQU   0
CPHEADER EQU   0
LL       EQU   CPHEADER
OO       EQU   CPHEADER+2
O2O2     EQU   CPHEADER+4
OC       EQU   CPHEADER+6
SCANIN   EQU   0
RECLEN   EQU   SCANIN
RECORD   EQU   SCANIN+4
ROUTINE  EQU   0
GTPBIBUF EQU   4
PARMDAT  EQU   0
COMREC   EQU   0
INPUT    EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
MSGECB   EQU   0
MSGTMCT  EQU   0
OPTION   EQU   0
APARM    EQU   0
CPPLPTR  EQU   ECDACPPL
ECDAIDS  EQU   ECDACBLK
FALSEP   EQU   OC+1
FALSEP2  EQU   OC+2
FLGS     EQU   OC+1
CNTLFLG  EQU   OC+1
PARMCNT  EQU   OC+1
GLOBVAL  EQU   ECDAGCNT
I004     EQU   ILIST
I00401   EQU   I004
I00403   EQU   I004+5
I00404   EQU   I004+8
I00405   EQU   I004+9
I005     EQU   ILIST
I00502   EQU   I005+1
I00504   EQU   I005+5
I00505   EQU   I005+8
I00506   EQU   I005+9
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
I00605   EQU   I006+8
I00503   EQU   I005+4
I00501   EQU   I005
I00402   EQU   I004+4
@NM00015 EQU   SCANIN+2
@NM00014 EQU   CPHEADER+7
RETCHAR  EQU   RET+2
RETSIZE  EQU   RET
CPPLECT  EQU   CPPL+12
CPPLPSCB EQU   CPPL+8
CPPLUPT  EQU   CPPL+4
CPPLCBUF EQU   CPPL
SVTDATA  EQU   SVTELEM+4
SVTORIG  EQU   SVTELEM+2
SVTLNG   EQU   SVTELEM
SVTABFRE EQU   SVTAB+12
SVTABUSE EQU   SVTAB+8
SVTABLNG EQU   SVTAB+4
SVTABNXT EQU   SVTAB
@NM00007 EQU   SNTFLAGS+1
SNTEVAL  EQU   SNTFLAGS
SNTNAUTH EQU   SNTFLAGS
SNTNOSCN EQU   SNTFLAGS
SNTKEY   EQU   SNTFLAGS
SNTPOSIT EQU   SNTFLAGS
SNTELFST EQU   SNTAB+12
COMRCDS  EQU   COMPROC+12
@NM00006 EQU   EXECDATA+60
FILEDCBS EQU   EXECDATA+56
RETPTR2  EQU   EXECDATA+52
ATACTEND EQU   EXECDATA+48
ATACTSTR EQU   EXECDATA+44
EXDLMPTR EQU   EXECDATA+40
NOLASTCC EQU   @NM00005+1
ATINCNTL EQU   @NM00005+1
ATTNCMD  EQU   @NM00005
NOMSG    EQU   @NM00005
CMAIN    EQU   @NM00005
ERINCNTL EQU   @NM00005
SYMLST   EQU   @NM00005
NOFLUSH  EQU   @NM00005
ERRCMD   EQU   @NM00005
CONLST   EQU   @NM00005
RETPTR   EQU   EXECDATA+28
ERACTEND EQU   EXECDATA+24
ERACTSTR EQU   EXECDATA+20
EXINSAVE EQU   @NM00004
LASTTSO  EQU   EXECDATA+12
ECDAILNG EQU   ECDAINME
ECDAGDAT EQU   ECDA+64
@NM00003 EQU   ECDA+58
SP78BLK  EQU   ECDAFLAG
@NM00002 EQU   ECDAFLAG
@NM00001 EQU   ECDAFLAG
SP78CORE EQU   ECDAFLAG
IMPLICIT EQU   ECDAFLAG
ECDAEANS EQU   ECDA+8
ECDAGADD EQU   ECDA+4
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
LSDANEXT EQU   LSD+8
LSDTOTLN EQU   LSD+6
LSDRCLEN EQU   LSD+4
LSDADATA EQU   LSD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00091 EQU   CMDCHKS
@RT00097 EQU   SPCLEXIT
@RT00115 EQU   TSOCALL
@RT00213 EQU   @EL00002
@RT00294 EQU   @EL00003
@RT00297 EQU   @EL00003
@RT00321 EQU   TSOCMD
@RF00364 EQU   @EL00004
@RF00363 EQU   @EL00004
@RC00361 EQU   @EL00004
@RC00359 EQU   @EL00004
@RC00357 EQU   @EL00004
@RC00355 EQU   @EL00004
@RC00353 EQU   @EL00004
@RF00382 EQU   @EL00005
@RF00405 EQU   COMSCN
@RT00417 EQU   LEAVE
@RT00424 EQU   LEAVE
@RT00434 EQU   @EL00007
@RF00431 EQU   @EL00007
@RC00429 EQU   @EL00007
@RT00455 EQU   BADIF
@RT00461 EQU   BADIF
@RT00480 EQU   TRYAGN
@RF00480 EQU   BADIF
@RT00486 EQU   TRYAGN
@RT00492 EQU   EXIT1
@RF00508 EQU   OUT
@RT00529 EQU   EXIT1
@RT00539 EQU   OUT
@RT00586 EQU   BADELSE
@RF00684 EQU   REGDO
@RT00696 EQU   SCANDO2
@RT00698 EQU   REGDO
@RT00700 EQU   DOBAD
@RT00749 EQU   OPENDO
@RT00751 EQU   GETAGN
@RT00784 EQU   OFFAGN2
@RT00786 EQU   NOOFF
@RF00847 EQU   NEXTREC
@RT00867 EQU   SETSCN2
@RT00972 EQU   GLOB2
@RT00998 EQU   MOVEOUT
@RT01029 EQU   MOVEOUT
@RT01033 EQU   BADCHR
@RT01036 EQU   FOUND
@RT01038 EQU   BADCHR
@RT01040 EQU   NXTCHR
@RT01065 EQU   NXTPARM
@ENDDATA EQU   *
         END   IKJCT432,(C'PLS1055',0701,77215)

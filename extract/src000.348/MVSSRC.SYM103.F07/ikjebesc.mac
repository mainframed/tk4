         TITLE 'IKJEBESC - SCAN SUBCMD OF EDIT COMMAND - FIRST LOAD    *
                        '
IKJEBESC CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEBESC  74.207'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @06,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@06                                    0001
*                                                                  0072
* /*                   END OF CVT MACRO                              */
*                                                                  0073
*          /***********************************************************
*          /* RESTRICT COMPILER'S USE OF REGISTERS.                   *
*          /***********************************************************
*                                                                  0073
*           COMMREG = PARMREG1;      /* GET ADDR OF IKJEBECA         */
*                                                                  0073
         LR    COMMREG,PARMREG1                                    0073
*           RESPECIFY (GPR13P,GPR15P) RSTD;                        0074
*           GPR15P = CANXTSVA;       /* SAVE AREA FOR THIS MODULE    */
         L     GPR15P,CANXTSVA(,COMMREG)                           0075
*           EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS     */
         LA    @14,4                                               0076
         ALR   @14,GPR15P                                          0076
         ST    GPR13P,CASAVPTR(,@14)                               0076
*                                    /* SAVEAREA BKWD PTR            */
*           EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER   */
         LA    @14,8                                               0077
         ALR   @14,GPR13P                                          0077
         ST    GPR15P,CASAVPTR(,@14)                               0077
*                                    /* FWD PTR                      */
*           GPR13P = GPR15P;         /* NEW SAVEAREA ADDR            */
         LR    GPR13P,GPR15P                                       0078
*           CANXTSVA = GPR13P + 72;   /* UPDATE NEX-SAVE-AREA PTR    */
         LA    @14,72                                              0079
         ALR   @14,GPR13P                                          0079
         ST    @14,CANXTSVA(,COMMREG)                              0079
*           RESPECIFY (GPR13P,GPR15P) UNRSTD;                      0080
*                                                                  0080
*           DATAREG = ADDR(CASCWKA);   /* SET BASE REG FOR WORK AREA */
         LA    DATAREG,CASCWKA(,COMMREG)                           0081
*           GEN( USING @DATD,DATAREG);   /* SET ADDRESSABILITY TO    */
          USING @DATD,DATAREG
*                                    /* CASCWKA                      */
*          RESPECIFY (PARMREG1,        /* PT TO PARAMETER LIST.       *
*                    BINRYREG,         /* BINARY VALUE.               *
*                    COMMREG,          /* PT TO COMMUNICATION AREA.   *
*                    BASEREG,          /* PROGRAM BASE REGISTER.      *
*                    BASEREG2,         /* 2ND PROGRAM BASE REGISTER   *
*                    DATAREG) RSTD;    /* WORK AREA BASE REGISTER.    *
*                                                                  0083
*          SCRETCD=0;                  /* INITLZ NORMAL RETURN CODE.  *
         SLR   @12,@12                                             0084
         ST    @12,SCRETCD                                         0084
*                                                                  0085
*          /***********************************************************
*          /* OPERAND PROCESSING.                                     *
*          /***********************************************************
*                                                                  0085
*          /* IS DATA SET TYPE A VALID ONE FOR SCANNING -             *
*                                                                  0085
*          IF CASCAN^='1'B THEN        /* DSTYPE CAN'T BE SCANNED.    *
         TM    CASCAN(COMMREG),B'01000000'                         0085
         BO    @RF00085                                            0085
*            DO;                       /* PREPARE AND ISSUE MESSAGE.  *
*              MSGPTR=0;               /* NO 2ND LEVEL INSERTIONS.    *
         ST    @12,MSGPTR(,COMMREG)                                0087
*              MSGLEN=LENGTH(CADSTYPE) /* LNG OF 2ND 1ST-LEVEL INSERT.*
*                +LENGTH(MSGLEN)                                   0088
*                +LENGTH(MSGOFF);                                  0088
         MVC   MSGLEN(2,COMMREG),@CH00151                          0088
*              MSGOFF=23;              /* OFFSET TO INSERTION.        *
         MVC   MSGOFF(2,COMMREG),@CH01192                          0089
*              MSGTEXT=CADSTYPE;       /* TEXT OF INSERTION.          *
         MVI   MSGTEXT+8(COMMREG),C' '                             0090
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0090
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0090
*              MSGPTR2=ADDR(MSGAREA);  /* PT TO 2ND INSERT INTO HEADER
*                                         OF 1ST INSERT.              *
         LA    @08,MSGAREA(,COMMREG)                               0091
         ST    @08,MSGPTR2                                         0091
*              MSGLEN2=LENGTH('SCAN')   /* LNG OF 1ST INSERTION.      *
*                +LENGTH(MSGLEN2)                                  0092
*                +LENGTH(MSGOFF2);                                 0092
         LA    MSGLEN2,8                                           0092
*              MSGOFF2=10;             /* OFFSET TO INSERTION.        *
         LA    MSGOFF2,10                                          0093
*              MSGTEXT2='SCAN';        /* TEXT OF INSERTION.          *
         MVC   MSGTEXT2(4),@CC01193                                0094
*              RELMSG1 =1796;          /* RELATIVE MSG NO.            *
         MVC   RELMSG1(2),@CH01194                                 0095
*              RELMSG2 =0;             /* NO 2ND-LEVEL MSG.           *
         STH   @12,RELMSG2                                         0096
*              LEV1INS =ADDR(MSGPTR2); /* PT TO UST-LEVEL INSERTION.  *
         LA    LEV1INS,MSGPTR2                                     0097
*              LEV2INS =0;             /* NO 2ND-LEVEL INSERTION.     *
         LR    LEV2INS,@12                                         0098
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  *
         LA    RETCDREG,SENDMSG                                    0099
*              CALL SENDMSG;           /* GO TO ISSUE IKJEBEML MACRO. *
         BAL   @14,SENDMSG                                         0100
*              GOTO FCNINCMP;          /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FCNINCMP                                            0101
*            END;                      /* END MESSAGE ISSUANCE.       *
*          ELSE;                       /* DSTYPE CAN BE SCANNED.      *
*                                                                  0103
@RF00085 DS    0H                                                  0104
*          /* IS SYNTAX CHECKER RECOVERY IN PROGRESS.                 *
*                                                                  0104
*          IF CASCRC20='0'B THEN       /* NOT SYNTAX CHECKER RECOVERY.*
         TM    CASCRC20(COMMREG),B'00001000'                       0104
         BNZ   @RF00104                                            0104
*            DO;                       /* BEGIN STATUS-CHECKING.      *
*              CALL CHKNAME;           /* GO TO EXAMINE CHECKER NAME. *
*                                                                  0106
         BAL   @14,CHKNAME                                         0106
*              /* WAS SYNTAX CHECKER FOUND TO BE OPERATIONAL -        *
*                                                                  0107
*              IF RETCDREG^=0 THEN       /* CHECKER INOPERATIVE.      *
         LTR   RETCDREG,RETCDREG                                   0107
         BNZ   @RT00107                                            0107
*                GOTO NOSCNEXT;        /* RETURN TO CALLER.           *
*              ELSE;                   /* CHECKER OPERATIONAL.        *
*            END;                      /* END OF STATUS-CHECKING.     *
*          ELSE;                       /* SYNTAX CHECKER RECOVERY.    *
@RF00104 DS    0H                                                  0112
*          ENDSW='0'B;                 /* SET INTERNAL SW TO IND THAT
*                                         NO END OF ANY LINE RANGE HAS
*                                         BEEN ENCOUNTERED.           *
*                                                                  0112
         NI    ENDSW,B'10111111'                                   0112
*          /* IS THIS A SPECIAL CALL FROM THE CONTROLLER BECAUSE      *
*          /* 'SCAN' WAS ENTERED ON THE EDIT COMMAND,OR BECAUSE THE   *
*          /* DATA SET TYPE REQUIRES A RUN-TIME DATA SET,OR BECAUSE   *
*          /* A SYNTAX CHECKER FAILED AND IS TO BE RECOVERED -        *
*                                                                  0113
*          IF CAINITSC='1'B THEN       /* SPECIAL CALL FR CONTROLLER. *
         TM    CAINITSC(COMMREG),B'00001000'                       0113
         BO    @RT00113                                            0113
*            GOTO ONSPEC;              /* PROCEED AS IF 'SCAN ON' WERE
*                                         SPECIFIED.                  *
*          ELSE                        /* NOT A SPECIAL CALL FROM  0115
*                                         CONTROLLER.                 *
*                                                                  0115
*            /* IS THIS A SPECIAL CALL FOR END PROCESSING -           *
*                                                                  0115
*            IF CAENDSC='1'B THEN      /* SPECIAL CALL FOR CLEANUP.   *
         TM    CAENDSC(COMMREG),B'00000100'                        0115
         BO    @RT00115                                            0115
*              GOTO OFFSPEC;           /* PROCEED AS IF 'SCAN OFF' WERE
*                                         SPECIFIED.                  *
*            ELSE;                     /* NOT A SPECIAL CALL FOR   0117
*                                         CLEANUP.                    *
*                                                                  0117
*          /* WERE ANY OPERANDS SPECIFIED ON THE SUBCOMMAND -         *
*                                                                  0118
*          IF CAOPERND='1'B THEN       /* OPERAND(S) SPECIFIED.       *
         TM    CAOPERND(COMMREG),B'10000000'                       0118
         BNO   @RF00118                                            0118
*            DO;                       /* BEGIN PREPARATION OF PARSE
*                                         PARAMETER LIST, CALL OF  0119
*                                         PARSE, AND DIAGNOSIS OF  0119
*                                         RETURN CODE.                *
*              PPLPTR=ADDR(CATMPLST);  /* SET PT TO PARAMETER LIST.   *
         LA    @12,CATMPLST(,COMMREG)                              0120
         LR    PPLPTR,@12                                          0120
*              PPLPCL=ADDR(IKJEBSC1);  /* SET PT TO PARAMETER CONTROL
*                                         LIST.                       *
         L     @07,@CV00525                                        0121
         ST    @07,PPLPCL(,PPLPTR)                                 0121
*              PPLANS=ADDR(CAPTPRSD);  /* SET PT TO ANSWER PLACE.     *
         LA    @07,CAPTPRSD(,COMMREG)                              0122
         ST    @07,PPLANS(,PPLPTR)                                 0122
*              PPLCBUF=CAPTIBFR;       /* SET PT TO SUBCOMMAND BUFFER.*
         MVC   PPLCBUF(4,PPLPTR),CAPTIBFR(COMMREG)                 0123
*              PPLUWA=0;               /* NO VALIDITY EXIT ROUTINE.   *
         SLR   @07,@07                                             0124
         ST    @07,PPLUWA(,PPLPTR)                                 0124
*              RFY (PARMREG0,RETCDREG) RSTD;                       0125
*              LKLIBPTR=0;             /* NO  DCB ADDRESS SPECIFIED.  *
         LR    LKLIBPTR,@07                                        0126
*              DO; /*CALLTSSR EP(IKJPARS)MF(E,CATMPLST)*/          0127
*                RESPECIFY GPR01P RSTD;                            0128
*                GPR01P = ADDR(CATMPLST);                          0129
         LR    GPR01P,@12                                          0129
*                IF CVTPARS = 0                                    0130
*                  THEN                                            0130
         L     @14,CVTPTR                                          0130
         C     @07,CVTPARS(,@14)                                   0130
         BNE   @RF00130                                            0130
*                    GEN(LINK EP=IKJPARS);                         0131
         LINK EP=IKJPARS
*                  ELSE                                            0132
*                    CALL CVTPARS;                                 0132
         B     @RC00130                                            0132
@RF00130 L     @12,CVTPTR                                          0132
         L     @15,CVTPARS(,@12)                                   0132
         BALR  @14,@15                                             0132
*                RESPECIFY GPR01P UNRSTD;                          0133
@RC00130 DS    0H                                                  0134
*              END;                                                0134
*              RFY (PARMREG0,RETCDREG) UNRSTD;                     0135
*              RETCODE=RETCDREG;       /* PRESERVE RETURN CODE.       *
*                                                                  0136
         LR    RETCODE,RETCDREG                                    0136
*              /* WAS PARSING SUCCESSFUL -                            *
*                                                                  0137
*              IF RETCODE=0 THEN       /* PARSING SUCCESSFUL.         *
         SLR   @08,@08                                             0137
         CR    RETCODE,@08                                         0137
         BE    @RT00137                                            0137
*                GOTO ONTEST;          /* TEST FOR 'ON' OPERAND.      *
*              ELSE;                   /* PARSING UNSUCCESSFUL.       *
*                                                                  0139
*              /* WERE INVALID PARAMETERS SENT TO THE PARSING ROUTINE-*
*                                                                  0140
*              IF RETCODE=12 THEN       /* BAD PARAMETERS.            *
         CH    RETCODE,@CH00151                                    0140
         BNE   @RF00140                                            0140
*                DO;                   /* PREPARE AND ISSUE MESSAGE.  *
*                  RELMSG1 =271;       /* 1ST-LEVEL MSG NO.           *
         MVC   RELMSG1(2),@CH01202                                 0142
*                  RELMSG2 =1;         /* 2ND-LEVEL MSG NO.           *
         MVC   RELMSG2(2),@CH00039                                 0143
*                  LEV1INS =0;         /* NO 1ST-LEVEL INSERTION.     *
         LR    LEV1INS,@08                                         0144
*                  LEV2INS =ADDR(MSGAREA); /* PT TO 1ST 2ND-LEVEL  0145
*                                             INSERTION.              *
         LA    LEV2INS,MSGAREA(,COMMREG)                           0145
*                  MSGPTR=ADDR(MSGPTR2); /* PT TO 2ND 2ND-LEVEL    0146
*                                           INSERTION.                *
         LA    @12,MSGPTR2                                         0146
         ST    @12,MSGPTR(,COMMREG)                                0146
*                  MSGOFF=10;          /* OFFSET TO UST INSERTION.    *
         MVC   MSGOFF(2,COMMREG),@CH00387                          0147
*                  MSGLEN=LENGTH('PARSE')/*                        0148
*                                         LNG OF 1ST INSERTION.       *
*                    +LENGTH(MSGLEN)                               0148
*                    +LENGTH(MSGOFF);                              0148
         MVC   MSGLEN(2,COMMREG),@CH01286                          0148
*                  MSGTEXT='PARSE';    /* TEXT OF 1ST INSERTION.      *
         MVI   MSGTEXT+5(COMMREG),C' '                             0149
         MVC   MSGTEXT+6(66,COMMREG),MSGTEXT+5(COMMREG)            0149
         MVC   MSGTEXT(5,COMMREG),@CC01203                         0149
*                  MSGPTR2=0;          /* NO 3RD INSERTION.           *
         ST    @08,MSGPTR2                                         0150
*                  MSGOFF2=22;         /* OFFSET TO 2ND INSERTION.    *
         LA    MSGOFF2,22                                          0151
*                  MSGLEN2=LENGTH('12')     /* LNG OF  2ND INSERTION. *
*                    +LENGTH(MSGLEN2)                              0152
*                    +LENGTH(MSGOFF2);                             0152
         LA    MSGLEN2,6                                           0152
*                  MSGTEXT2='12';      /* TEXT OF 2ND INSERTION.      *
         MVI   MSGTEXT2+2,C' '                                     0153
         MVI   MSGTEXT2+3,C' '                                     0153
         MVC   MSGTEXT2(2),@CC01205                                0153
*                  RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SEND ROUTINE. *
         LA    RETCDREG,SENDMSG                                    0154
*                  CALL SENDMSG;       /* GO TO ISSUE IKJEBEML MACRO. *
         BAL   @14,SENDMSG                                         0155
*                  GOTO FCNINCMP;      /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FCNINCMP                                            0156
*                END;                  /* END OF MESSAGE-ISSUANCE.    *
*              ELSE;                   /* NOT BAD PARAMETERS.         *
*                                                                  0158
@RF00140 DS    0H                                                  0159
*              /* WAS NOT ENOUGH STORAGE AVAILABLE FOR PARSING.       *
*                                                                  0159
*              IF RETCODE=16 THEN       /* NOT ENOUGH CORE.           *
*                                                                  0159
         CH    RETCODE,@CH00241                                    0159
         BNE   @RF00159                                            0159
*                /* CONTROL BRANCHES HERE WHEN RETURN CODES ARE       *
*                /* RECEIVED INDICATING INSUFFICIENT STORAGE.         *
*                                                                  0160
*                DO;                   /* PREPARE AND ISSUE MESSAGE.  *
*                  MSGPTR=0;           /* ONLY 1 INSERTION.           *
         SLR   @12,@12                                             0161
         ST    @12,MSGPTR(,COMMREG)                                0161
*                  MSGLEN=CASCMDLN     /* LNG OF INSERTION.           *
*                    +LENGTH(MSGLEN)                               0162
*                    +LENGTH(MSGOFF);                              0162
         LA    @08,4                                               0162
         AH    @08,CASCMDLN(,COMMREG)                              0162
         STH   @08,MSGLEN(,COMMREG)                                0162
*                  MSGOFF=45;          /* OFFSET TO INSERTION.        *
         MVC   MSGOFF(2,COMMREG),@CH01206                          0163
*                  MSGTEXT=            /* TEXT OF INSERTION.          *
*                    CAPTSCMD->LINENUM;                            0164
         MVI   MSGTEXT+8(COMMREG),C' '                             0164
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0164
         L     @08,CAPTSCMD(,COMMREG)                              0164
         MVC   MSGTEXT(8,COMMREG),LINENUM(@08)                     0164
*                  RELMSG1 =270;       /* RELATIVE MSG NO.            *
         MVC   RELMSG1(2),@CH01207                                 0165
*                  RELMSG2 =0;         /* NO 2ND-LEVEL MSG.           *
         STH   @12,RELMSG2                                         0166
*                  LEV1INS =ADDR(MSGAREA); /* PT TO INSERT.           *
         LA    LEV1INS,MSGAREA(,COMMREG)                           0167
*                  LEV2INS =0;         /* NO 2ND-LEVEL INSERT.        *
         LR    LEV2INS,@12                                         0168
*                  RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SNEDING RTN.  *
         LA    RETCDREG,SENDMSG                                    0169
*                  CALL SENDMSG;       /* GO TO ISSUE IKJEBEML MACRO. *
         BAL   @14,SENDMSG                                         0170
*                  GOTO FCNINCMP;      /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FCNINCMP                                            0171
*                END;                  /* END MESSAGE-ISSUANCE.       *
*              ELSE;                   /* NOT INSUFFICIENT CORE, BUT
*                                         ATTN ISSUED OR UNABLE TO 0173
*                                         PROMPT USER.                *
*                                                                  0173
@RF00159 DS    0H                                                  0174
*              /* WAS PARSE UNABLE TO PROMPT USER -                   *
*                                                                  0174
*              IF RETCODE=4 THEN        /* UNABLE TO PROMPT.          *
         CH    RETCODE,@CH00452                                    0174
         BE    @RT00174                                            0174
*                GOTO FCNINCMP;        /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
*              ELSE                    /* ATTN WAS ISSUED.            *
*                GOTO SCANEXIT;        /* CLEANUP AND RETURN.         *
         B     SCANEXIT                                            0176
*            END;                      /* END PARSING AND RETURN   0177
*                                         CODE DIAGNOSIS.             *
*          ELSE                        /* NO SUBCOMMAND OPERAND(S).   *
*            GOTO TOTLSCAN;            /* TRANSFER CONTROL TO 2ND LOAD
*                                         MODULE TO SCAN ENTIRE DATA
*                                         SET.                        *
*                                                                  0178
*ONTEST:   /* PARSING OF SUBCOMMAND OPERAND(S) SUCCESSFUL.  WAS THE   *
*          /* 'ON' KEYWORD SPECIFIED -                                *
*                                                                  0179
*          IF KEYWD=1 THEN             /* 'SCAN ON' SPECIFIED.        *
ONTEST   L     @12,CAPTPRSD(,COMMREG)                              0179
         CLC   KEYWD(2,@12),@CH00039                               0179
         BNE   @RF00179                                            0179
*                                                                  0180
*          /***********************************************************
*          /* 'SCAN ON' PROCESSING.                                   *
*          /***********************************************************
*                                                                  0180
*ONSPEC:   /* A SPECIAL CALL FROM THE CONTROLLER FOR INITIAL SYNTAX   *
*          /* CHECKER PROCESSING OR FOR SYNTAX CHECKER RECOVERY       *
*          /* RESULTS IN 'SCAN ON' PROCESSING.                        *
*                                                                  0180
*            DO;                       /* BEGIN 'SCAN ON' PROCESSING. *
*                                                                  0180
ONSPEC   DS    0H                                                  0181
*              /* IS SYNTAX CHECKER RECOVERY IN PROGRESS -            *
*                                                                  0181
*              IF CASCRC20='1'B THEN   /* SYNTAX CHECKER RECOVERY.    *
         TM    CASCRC20(COMMREG),B'00001000'                       0181
         BO    @RT00181                                            0181
*                GOTO FNLENTRY;        /* CLEAN UP AND DELETE SYNTAX
*                                         CHECKER BEFORE RELOADING AND
*                                         INITIALIZING IT.            *
*              ELSE;                   /* NOT SYNTAX CHECKER RECOVERY.*
*                                                                  0183
*RECOVER:      /* DURING SYNTAX CHECKER RECOVERY CONTROL RETURNS HERE *
*              /* AFTER CLEAN UP AND DELETION OF CHECKER.             *
*                                                                  0184
*              /* IS THIS AN ITF(INTERACTIVE TERMINAL FACILITY) DATA  *
*              /* SET, REQUIRING A RUN-TIME DATA SET IN PARALLEL WITH *
*              /* THE UTILITY DATA SET -                              *
*                                                                  0184
*              IF CADSCODE^=CABASIC                                0184
*                & CADSCODE^=CAIPLI THEN /* NOT AN ITF DATA SET.      *
RECOVER  CLI   CADSCODE(COMMREG),X'20'                             0184
         BE    @RF00184                                            0184
         CLI   CADSCODE(COMMREG),X'21'                             0184
         BE    @RF00184                                            0184
*                DO;                   /* BEGIN NON-ITF 'SCAN ON'  0185
*                                         PROCESSING.                 *
*                                                                  0185
*                  /* IS SCANNING ALREADY IN EFFECT, AND IS SYNTAX    *
*                  /* CHECKER RECOVERY NOT IN PROGRESS -              *
*                                                                  0186
*                  IF CASCANSW='1'B                                0186
*                    &CASCRC20='0'B THEN   /* SCAN ALREADY ON AND NOT
*                                             RECOVERY.               *
         TM    CASCANSW(COMMREG),B'00010000'                       0186
         BNO   @RF00186                                            0186
         TM    CASCRC20(COMMREG),B'00001000'                       0186
         BZ    @RT00186                                            0186
*                    GOTO SCANEXIT;    /* CLEAN UP AND RETURN.        *
*                  ELSE;               /* SCAN NOT YET ON, OR RECOVERY
*                                         IN PROGRESS.                *
*                                                                  0188
@RF00186 DS    0H                                                  0189
*                  /* IS THIS CALL DUE TO A 'SCAN ON' SUBCOMMAND, OR  *
*                  /* IS THIS SYNTAX CHECKER RECOVERY -               *
*                                                                  0189
*                  IF CAINITSC='0'B                                0189
*                    ×CASCRC20='1'B THEN  /* NOT A SPECIAL CALL FROM
*                                            CONTROLLER, OR RECOVERY
*                                            IN PROGRESS.             *
         TM    CAINITSC(COMMREG),B'00001000'                       0189
         BZ    @RT00189                                            0189
         TM    CASCRC20(COMMREG),B'00001000'                       0189
         BNO   @RF00189                                            0189
@RT00189 DS    0H                                                  0190
*                    DO;               /* BEGIN LOADING OF SYNTAX  0190
*                                         CHECKER IF NECESSARY.       *
*                                                                  0190
*                      /* IS THE CHECKER ALREADY LOADED AND INITIA-   *
*                      /* LIZED FROM A PREVIOUS RECOVERY(THIS IS      *
*                      /* POSSIBLE ONLY WHEN 'SCAN ON' SUBCOMMAND HAS *
*                      /* BEEN ENTERED, FOR IF RECOVERY IS NOW IN     *
*                      /* PROGRESS THE CHECKER HAS JUST BEEN DELETED)-*
*                                                                  0191
*                      IF CAPTCHK^=0 THEN /* CHECKER ALREADY LOADED.  *
         ICM   @12,15,CAPTCHK(COMMREG)                             0191
         BNZ   @RT00191                                            0191
*                        GOTO SETON;   /* SET SWITCHES AND RETURN.    *
*                      ELSE;           /* CHECKER NOT YET LOADED.     *
*                      RFY PARMREG0 RSTD;                          0194
*                      PARMREG0=                                   0195
*                        ADDR(CASYNAME); /* SET PT TO ENTRY NAME.     *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0195
*                      GEN (LOAD EPLOC=(0));/* GET USABLE COPY OF  0196
*                                              SYNTAX CHECKER.        *
         LOAD EPLOC=(0)
*                      CAPTCHK=PARMREG0; /* SAVE PT TO ENTRY POINT.   *
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0197
*                      RFY PARMREG0 UNRSTD;                        0198
*                    END;              /* END SYNTAX CHECKER LOADING. *
*                  ELSE;               /* THIS IS A SPECIAL CALL FROM
*                                         THE CONTROLLER BUT RECOVERY
*                                         IS NOT IN PROGRESS.  I.E.,
*                                         THE CONTROLLER HAS LOADED
*                                         THE CHECKER BECAUSE 'SCAN'
*                                         WAS SPECIFIED ON THE EDIT
*                                         COMMAND, BUT AN INITIAL ENTRY
*                                         OF THE CHECKER MUST BE MADE.*
@RF00189 DS    0H                                                  0201
*                  CALL INITPLST;      /* INITIALIZE INTERFACE.       *
         BAL   @14,INITPLST                                        0201
*                  PARMREG1=ADDR(CASYNLST); /* SET PT TO ADDRESS LIST.*
         LA    PARMREG1,CASYNLST(,COMMREG)                         0202
*                  CALL CHECKER;       /* INITIAL ENTRY TO SYNTAX  0203
*                                         CHECKER, NO LINES FURNISHED
*                                         FOR SCANNING.               *
         L     @15,CAPTCHK(,COMMREG)                               0203
         BALR  @14,@15                                             0203
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       *
         LR    RETCODE,RETCDREG                                    0204
*                  CASYNMS1=0;         /* REINITLZ 1ST-LEVEL MSG PT.  *
         SLR   @08,@08                                             0205
         ST    @08,CASYNMS1(,COMMREG)                              0205
*                  CASYNMS2=0;         /* REINITLZ 2ND-LEVEL MSG PT.  *
*                                                                  0206
         ST    @08,CASYNMS2(,COMMREG)                              0206
*                  /* WAS INITIAL CALL OF SYNTAX CHECKER SUCCESSFUL - *
*                                                                  0207
*                  IF RETCODE^=0 THEN       /* ERROR DURING INIT CALL.*
*                                                                  0207
         CR    RETCODE,@08                                         0207
         BE    @RF00207                                            0207
*                    /* WAS NOT ENOUGH STORAGE AVAILABLE -            *
*                                                                  0208
*                    IF RETCODE=16 THEN       /* NOT ENOUGH CORE.     *
         CH    RETCODE,@CH00241                                    0208
         BE    @RT00208                                            0208
*                      GOTO INITERR;   /* BRANCH TO TREAT INOPERATIVE
*                                         SYNTAX CHECKER (CONTROL USED
*                                         TO BRANCH TO 'NOCORMSG', BUT
*                                         THIS CAUSED A NON-INITIALIZED
*                                         COPY OF THE SYNTAX CHECKER TO
*                                         REMAIN IN CORE).            *
*                    ELSE              /* ERROR NOT INSUFFICIENT CORE.*
*                                                                  0210
*INITERR:              /* CONTROL COMES HERE WHENEVER A SYNTAX CHECKER*
*                      /* BECOMES INOPERATIVE DURING AN INITIAL ENTRY.*
*                                                                  0210
*                      DO;             /* BEGIN CLEAN UP AND DELETION
*                                         OF SYNTAX CHECKER.          *
INITERR  DS    0H                                                  0211
*                        FIRSTENT='1'B; /* SET BIT IN SYNTAX CHECKER
*                                          COMMUNICATION AREA TO INDI-
*                                          CATE NOT FIRST ENTRY.      *
*                        LASTENT='1'B;  /* SET BIT IN SYNTAX CHECKER
*                                          COMMUNICATION AREA TO INDI-
*                                          CATE FINAL ENTRY.          *
         OI    FIRSTENT(COMMREG),B'10100000'                       0212
*                        CASYNBFR=0;   /* NO LINES TO BE SCANNED.     *
         SLR   @12,@12                                             0213
         ST    @12,CASYNBFR(,COMMREG)                              0213
*                        PARMREG1=                                 0214
*                          ADDR(CASYNLST); /* SET PT TO ADDRESS LIST. *
         LA    PARMREG1,CASYNLST(,COMMREG)                         0214
*                        RETCDREG=CAPTCHK; /* SET PT TO ENTRY POINT.  *
         L     @12,CAPTCHK(,COMMREG)                               0215
         LR    RETCDREG,@12                                        0215
*                        CALL CHECKER; /* FINAL ENTRY TO SYNTAX CHECKER
*                                         NO LINES TO BE SCANNED.     *
         LR    @15,@12                                             0216
         BALR  @14,@15                                             0216
*                        PARMREG0=                                 0217
*                          ADDR(CASYNAME); /* SET PT TO ENTRY NAME.   *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0217
*                        GEN (DELETE EPLOC=(PARMREG0)); /* FREE CORE. *
         DELETE EPLOC=(PARMREG0)
*                        CAPTCHK=0;    /* INDICATE NO CHECKER LOADED. *
         SLR   @12,@12                                             0219
         ST    @12,CAPTCHK(,COMMREG)                               0219
*                        CASYNAME=                                 0220
*                          'FFFFFFFFFFFFFFFF'X;/*                  0220
*                                         INDICATE CHECKER NOT OPERA-
*                                         TIVE(AS OPPOSED TO NOT IN
*                                         SYSTEM) BY SETTING ITS NAME
*                                         TO BINARY ONES.             *
         MVC   CASYNAME(8,COMMREG),@CB01218                        0220
*                        CASCANSW='0'B;   /* TURN OFF SCAN SWITCH.    *
*                        CAPROMPT='0'B;   /* TURN OFF PORMPT SWITCH.  *
         NI    CASCANSW(COMMREG),B'11001111'                       0222
*                        CASCRC20='1'B;  /* SET RECOVERY SWITCH ON,
*                                           BECAUSE CONTROLLER WILL
*                                           REVERSE IT SETTING AND RE-
*                                           CALL THIS MODULE, AND THIS
*                                           MODULE WILL THEN CHECK THE
*                                           SYNTAX CHECKER NAME AND
*                                           ISSUE A DIAGNOSTIC.       *
         OI    CASCRC20(COMMREG),B'00001000'                       0223
*                        SCRETCD=16;      /* SET RET CODE TO INDICATE
*                                            CHECKER MALFUNCTION.     *
         MVC   SCRETCD(4),@CF00241                                 0224
*                        GOTO SCANEXIT; /* CLEAN UP AND RETURN.       *
         B     SCANEXIT                                            0225
*                      END;            /* END SYNTAX CHECKER DELETION.*
*                  ELSE                /* NO ERROR DURING INITIAL CALL
*                                         OF SYNTAX CHECKER.          *
*                    DO;               /* INITIALIZATION OR RECOVERY OF
*                                         CHECKER IS COMPLETE, SO BEGIN
*                                         SETTING SWITCHES.           *
@RF00207 DS    0H                                                  0228
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CHECKER COM
*                                         AREA TO IND FUTURE ENTRIES
*                                         ARE NOT INITIAL ONES.       *
*                      INCOMPST='0'B;  /* SET BIT IN SYNTAX CKR COMM
*                                         AREA TO REQUEST THAT ANY 0229
*                                         POTENTIALLY INCOMPLETE STATE-
*                                         MENTS BE DIAGNOSED AS THEY
*                                         STAND.                      *
*                                                                  0229
         OI    FIRSTENT(COMMREG),B'10000000'                       0229
         NI    INCOMPST(COMMREG),B'11101111'                       0229
*                      /* IS SYNTAX CHECKER RECOVERY IN PROGRESS -    *
*                                                                  0230
*                      IF CASCRC20='0'B THEN   /* NOT RECOVERY.       *
         TM    CASCRC20(COMMREG),B'00001000'                       0230
         BZ    @RT00230                                            0230
*                        GOTO SETON;   /* SET SWS TO IND SCAN IN   0231
*                                         EFFECT.                     *
*                      ELSE            /* RECOVERY IN PROGRESS.       *
*                        GOTO SWITCHON;/* SET SWS TO IND SCAN IN EFFECT
*                                         IF IT WAS IN EFFECT BEFORE A
*                                         SYNTAX CHECKER FAILURE   0232
*                                         CAUSED RECOVERY TO BE    0232
*                                         UNDERTAKEN.                 *
         B     SWITCHON                                            0232
*                    END;              /* END SWITCH-SETTING WHICH 0233
*                                         FOLLOWS SYNTAX CHECKER   0233
*                                         INITIALIZATION OR RECOVERY. *
*                END;                  /* END OF NON-ITF 'SCAN ON' 0234
*                                         PROCESSING.                 *
*              ELSE                    /* ITF DATA SET TYPE, REQUIRING
*                                         A RUN-TIME DATA SET.        *
*                DO;                   /* BEGIN ITF 'SCAN ON'      0235
*                                         PROCESSING.                 *
*                                                                  0235
@RF00184 DS    0H                                                  0236
*                  /* IS THIS SPECIAL CALL FROM THE CONTROLLER TO     *
*                  /* INITLZ THE CHECKER FOR AN ITF DATA SET, OR TO   *
*                  /* LOAD AND INITLZ THE CHECKER FOR RECOVERY -      *
*                                                                  0236
*                  IF CAINITSC='0'B THEN   /* NOT A SPECIAL CALL.     *
         TM    CAINITSC(COMMREG),B'00001000'                       0236
         BZ    @RT00236                                            0236
*                    GOTO SETON;       /* SIMPLY SET SWS TO IND SCAN IN
*                                         EFFECT, SINCE CHECKER HAS
*                                         ALREADY BEEN LOADED AND  0237
*                                         INITLZD DURING COMMAND   0237
*                                         PROCESSING.                 *
*                  ELSE;               /* SPECIAL CALL FR CONTROLLER. *
*                                                                  0238
*                  /* IS THE CHECKER ALREADY LOADED (THIS WILL BE THE *
*                  /* CASE WHEN, AND ONLY WHEN, THIS IS A SPECIAL     *
*                  /* CALL FROM THE CONTROLLER FOR INITIAL SYNTAX     *
*                  /* CHECKER PROCESSING, FOR IF RECOVERY IS NOW IN   *
*                  /* PROGRESS THE CHECKER HAS BEEN DELETED.) -       *
*                                                                  0239
*                  IF CAPTCHK=0 THEN   /* ITF CHECKER NOT LOADED.     *
         ICM   @12,15,CAPTCHK(COMMREG)                             0239
         BNZ   @RF00239                                            0239
*                    DO;               /* BEGIN ITF CHECKER LOADING.  *
*                      RFY PARMREG0 RSTD;                          0241
*                      PARMREG0=                                   0242
*                        ADDR(CASYNAME); /* SET PT TO ENTRY NAME.     *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0242
*                      GEN (LOAD EPLOC=(0));/* LOAD CHECKER.          *
         LOAD EPLOC=(0)
*                      CAPTCHK=PARMREG0; /* SAVE ENTRY POINT ADDRESS. *
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0244
*                      RFY PARMREG0 UNRSTD;                        0245
*                    END;              /* END ITF CHECKER LOADING.    *
*                  ELSE;               /* ITF CHECKER ALREADY LOADED. *
@RF00239 DS    0H                                                  0248
*                  CALL INITPLST;      /* INITIALIZE INTERFACE.       *
         BAL   @14,INITPLST                                        0248
*                  PARMREG1=ADDR(CASYNLST); /* SET PT TO ADDRESS LIST.*
         LA    PARMREG1,CASYNLST(,COMMREG)                         0249
*                  CALL CHECKER;       /* INITIAL ENTRY OF ITF SYNTAX
*                                         CHECKER, NO LINES FURNISHED
*                                         FOR SCANNING.               *
         L     @15,CAPTCHK(,COMMREG)                               0250
         BALR  @14,@15                                             0250
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       *
         LR    RETCODE,RETCDREG                                    0251
*                  CASYNMS1=0;         /* RE-INITLZ 1ST-LEVEL MSG PT. *
         SLR   @08,@08                                             0252
         ST    @08,CASYNMS1(,COMMREG)                              0252
*                  CASYNMS2=0;         /* RE-INITLZ 2ND-LEVEL MSG PT. *
*                                                                  0253
         ST    @08,CASYNMS2(,COMMREG)                              0253
*                  /* WAS INITIAL CALL TO ITF SUCCESSFUL -            *
*                                                                  0254
*                  IF RETCODE^=0 THEN       /* ERROR IN INITIAL CALL. *
         CR    RETCODE,@08                                         0254
         BNE   @RT00254                                            0254
*                    GOTO INITERR;     /* CLEAN UP AND DELETE ITF  0255
*                                         SYNTAX CHECKER.             *
*                  ELSE                /* INITIAL CALL TO ITF OK.     *
*                    DO;               /* BEGIN UPDATING  INTERFACE.  *
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CKR COMM
*                                         AREA TO IND THAT FUTURE CALLS
*                                         ARE NOT INITIAL ONES.       *
*                      INCOMPST='0'B;  /* SET BIT IN SYNTAX CKR COMM
*                                         AREA TO IND THAT NEXT CALL
*                                         DOESN'T FOLLOW RET CODE 12. *
         OI    FIRSTENT(COMMREG),B'10000000'                       0258
         NI    INCOMPST(COMMREG),B'11101111'                       0258
*                    END;              /* END UPDATING OF INTERFACE.  *
*                                                                  0260
*          /***********************************************************
*          /* TRANSLATION OF LINES INTO RUN-TIME FORM.                *
*          /***********************************************************
*                                                                  0260
*                  /* LINES MUST BE SENT TO SYNTAX CHECKER ONE AT A   *
*                  /* TIME FOR TRANSLATION INTO RUN-TIME FORM.        *
*                                                                  0260
*                  KEYPTR=0;           /* NO KEY SPEC FOR READ-1ST.   *
         ST    @08,KEYPTR                                          0260
*                  UTCODE='04'X;       /* OPTION CODE FOR 'READ 1ST'. *
         MVI   UTCODE,X'04'                                        0261
*                  DCBPTR=CAPTCDCB;    /* PT TO CURRENT UTILITY DCB.  *
         MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0262
*                  AREAPTR=                                        0263
*                    ADDR(UTBUFFER);   /* PT TO INPUT BUFFER.         *
         LA    @08,UTBUFFER(,COMMREG)                              0263
         ST    @08,AREAPTR                                         0263
*                  PLISTEND='1'B;      /* MARK END OF PARAMETER LIST. *
         OI    PLISTEND,B'10000000'                                0264
*                  GEN;                /* CALL ACCESS METHOD FOR READ.*
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        C
               MF=(E,SRPLIST)          INVOKE ACCESS METHOD FOR READ.
*                  RETCODE=RETCDREG;   /* PRESERVE RETURN CODE.       *
*                                                                  0266
         LR    RETCODE,RETCDREG                                    0266
*                  /* CHECK   FOR I/O ERROR.                          *
*                                                                  0267
*                  IF RETCODE=8 THEN        /* I/O ERROR ON UTILITY.  *
*                                                                  0267
         CH    RETCODE,@CH00044                                    0267
         BNE   @RF00267                                            0267
*IOERROR:            /* CONTROL COMES HERE AFTER ANY UTILITY I/O ERR. *
*                                                                  0268
*                    DO;               /* BEGIN I/O ERROR CLEANUP.    *
IOERROR  DS    0H                                                  0269
*                      SCRETCD=12;     /* SET RET CODE FOR CONTROLLER.*
         MVC   SCRETCD(4),@CF00151                                 0269
*                      INPUTCD='0'B;   /* RESET OPTION WORD BIT TO IND
*                                         NOT INPUT LINES.            *
         NI    INPUTCD(COMMREG),B'01111111'                        0270
*                      GOTO SCANEXIT;  /* CLEAN UP AND EXIT.          *
         B     SCANEXIT                                            0271
*                    END;              /* END CLEANUP AFTER I/O ERROR.*
*                  ELSE                /* NO I/O ERROR ON UTILITY.    *
*                                                                  0273
*                    /* ARE THERE NO RECORDS IN DATA SET -            *
*                                                                  0273
*                    IF RETCODE=4 THEN        /* EMPTY DATA SET.      *
@RF00267 CH    RETCODE,@CH00452                                    0273
         BE    @RT00273                                            0273
*                      GOTO SWITCHON;  /* SET SWITCHES CONDITIONALLY. *
*                    ELSE;             /* 1ST RECORD FOUND.           *
*                  INPUTCD='1'B;       /* SET OPTION WORD BIT TO IND
*                                         THAT AN INPUT LINE IS TO BE
*                                         TRANSLATED.                 *
*                                                                  0276
         OI    INPUTCD(COMMREG),B'10000000'                        0276
*                  /* WAS 'SCAN' KEYWORD ON EDIT COMMAND -            *
*                                                                  0277
*                  IF CASCANON='1'B THEN  /* 'SCAN' SPECIFIED.        *
         TM    CASCANON(COMMREG),B'00100000'                       0277
         BNO   @RF00277                                            0277
*                    SCANOPT='0'B;     /* SET OPTION WORD BIT TO IND
*                                         SCANNING IN EFFECT, ANY MSGS
*                                         SHOULD BE ISSUED.           *
         NI    SCANOPT(COMMREG),B'11111110'                        0278
*                  ELSE                /* 'NOSCAN' SPECIFIED OR    0279
*                                         DEFAULTED.                  *
*                    SCANOPT='1'B;     /* SET OPTION WORD BIT TO IND
*                                         SCANNING NOT IN EFFECT, ANY
*                                         MSGS SHOULD BE QUEUED FOR
*                                         ISSUANCE AT RUN TIME.       *
         B     @RC00277                                            0279
@RF00277 OI    SCANOPT(COMMREG),B'00000001'                        0279
*                  CASYNBFR=ADDR(SYNBUFFR);/* SET PT TO BUFFER.       *
*                                                                  0280
@RC00277 LA    @12,SYNBUFFR(,COMMREG)                              0280
         ST    @12,CASYNBFR(,COMMREG)                              0280
*CALLCHKR:         /* CONTROL REPEATEDLY LOOPS BACK TO THIS POINT TO  *
*                  /* SEND SINGLE LINES TO ITF PROCESSOR FOR          *
*                  /* TRANSLATION.                                    *
*                                                                  0281
*                  RECNO=1;            /* SET NO. OF RCDS IN BUFFER.  *
CALLCHKR MVI   RECNO(COMMREG),X'01'                                0281
*                  CHAINPTR=0;         /* NO BUFFERS CHAINED TO THIS
*                                         ONE.                        *
*                                                                  0282
         SLR   @12,@12                                             0282
         STCM  @12,7,CHAINPTR(COMMREG)                             0282
*                  /* TEST RECORD FORMAT.                             *
*                                                                  0283
*                  IF CARECFM='0'B THEN   /* RECFM=VB.                *
         TM    CARECFM(COMMREG),B'01000000'                        0283
         BNZ   @RF00283                                            0283
*                    RECORD(1:LL)=     /* MOVE DATA,HEADER INTO BFR.  *
*                      UTBUFFER(1+LENGTH(KEY):LL);                 0284
         SLR   @12,@12                                             0284
         ICM   @12,3,LL(COMMREG)                                   0284
         BCTR  @12,0                                               0284
         EX    @12,@SM01386                                        0284
*                  ELSE                /* RECFM=FB.                   *
*                    RECORD(1:LL-4)=                               0285
*                      LINE;           /* MOVE ONLY DATA INTO BUFFER. *
         B     @RC00283                                            0285
@RF00283 SLR   @12,@12                                             0285
         ICM   @12,3,LL(COMMREG)                                   0285
         SH    @12,@CH00138                                        0285
         EX    @12,@SM01388                                        0285
*                  PARMREG1=ADDR(CASYNLST);/* SET PT TO ADDRESS LIST. *
@RC00283 LA    PARMREG1,CASYNLST(,COMMREG)                         0286
*                  CALL CHECKER;       /* INVOKE ITF PROCESSOR FOR 0287
*                                         TRANSLATION OF A LINE.      *
         L     @15,CAPTCHK(,COMMREG)                               0287
         BALR  @14,@15                                             0287
*                  RETCODE=RETCDREG;   /* PRESERVE RET CODE FOR TESTS.*
*                                                                  0288
         LR    RETCODE,RETCDREG                                    0288
*                  /* HAS ITF PROCESSOR BECOME INOPERATIVE (DUE TO    *
*                  /* NOT ENOUGH CORE OR CHECKER FAILURE) -           *
*                                                                  0289
*                  IF RETCODE>=16 THEN       /* PROCESSOR INOPERATIVE.*
         CH    RETCODE,@CH00241                                    0289
         BNL   @RT00289                                            0289
*                    GOTO INITERR;     /* CLEAN UP AND DELETE ITF  0290
*                                         PROCESSOR.                  *
*                  ELSE                /* PROCESSOR STILL OPERATIVE.  *
*                    UTCODE='02'X;     /* SET ACCESS METHOD OPTION CODE
*                                        TO READ NEXT RECORD.         *
         MVI   UTCODE,X'02'                                        0291
*                  GEN;                /* ISSUE MACRO TO READ NEXT.   *
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        C
               MF=(E,SRPLIST)          INVOKE ACCESS METHOD.
*                  RETCODE=RETCDREG;   /* PRESERVE RET CODE.          *
*                                                                  0293
         LR    RETCODE,RETCDREG                                    0293
*                  /* CHECK FOR I/O ERROR ON UTILITY DATA SET.        *
*                                                                  0294
*                  IF RETCODE=8 THEN        /* I/O ERROR.             *
         CH    RETCODE,@CH00044                                    0294
         BE    @RT00294                                            0294
*                    GOTO IOERROR;     /* SET RET CODE AND CLEAN UP.  *
*                  ELSE;               /* NO I/O ERROR ENCOUNTERED.   *
*                                                                  0296
*                  /* WERE NO MORE RECORDS FOUND -                    *
*                                                                  0297
*                  IF RETCODE=4 THEN        /* END OF DATA,        0297
*                                              TRANSLATION COMPLETE.  *
         CH    RETCODE,@CH00452                                    0297
         BNE   @RF00297                                            0297
*                    DO;               /* DECIDE FINAL ACTION.        *
*                      INPUTCD='0'B;   /* SET BIT IN OPTION WORD TO IND
*                                         NEXT CALL NOT FOR INPUT  0299
*                                         TRANSLATION.                *
*                                                                  0299
         NI    INPUTCD(COMMREG),B'01111111'                        0299
*SWITCHON:             /* CONTROL COMES HERE WHENEVER 'SCAN ON'       *
*                      /* PROCESSING IS COMPLETE, TO CONDITIONALLY    *
*                      /* SET THE SCAN AND PROMPT SWITCHES IN EDIT'S  *
*                      /* COMMUNICATION AREA.                         *
*                                                                  0300
*                      /* WAS THE 'SCAN' KEYWORD SPEC ON THE EDIT     *
*                      /* COMMAND, OR WAS SCAN 'ON' BEFORE SYNTAX     *
*                      /* CHECKER RECOVERY -                          *
*                                                                  0300
*                      IF CASCANON='1'B THEN  /* SCAN IS TO BE 'ON'.  *
SWITCHON TM    CASCANON(COMMREG),B'00100000'                       0300
         BO    @RT00300                                            0300
*                        GOTO SETON;   /* TURN ON SCANNING.           *
*                      ELSE            /* SCAN IS TO BE 'OFF'.        *
*                        GOTO RECOVMSG;/* ISSUE RECOVERY MESSAGE IF
*                                         THIS WAS RECOVERY.          *
         B     RECOVMSG                                            0302
*                    END;              /* FINAL ACTION DECIDED.       *
*                  ELSE                /* ANOTHER RECORD TO BE     0304
*                                         TRANSLATED.                 *
*                    GOTO CALLCHKR;    /* LOOP BACK TO SEND A LINE.   *
*                END;                  /* END OF ITF 'SCAN ON'     0305
*                                         PROCESSING.                 *
*                                                                  0305
*SETON:        /* CONTROL COMES HERE WHENEVER SCANNING OF INPUT LINES *
*              /* IS TO BE PUT INTO EFFECT.                           *
*                                                                  0306
*              CASCANSW='1'B;          /* SET SW IN COMMUNICATION AREA
*                                         TO IND THAT SCANNING OF  0306
*                                         INPUT IS IN EFFECT.         *
SETON    DS    0H                                                  0307
*              CAPROMPT='1'B;          /* TURN ON PROMPT SW FOR INPUT.*
         OI    CASCANSW(COMMREG),B'00110000'                       0307
*              CASCANON='1'B;          /* SET SW TO REMEMBER SCANNING
*                                         IN EFFECT, IN CASE OF SYNTAX
*                                         CHECKER FAILURE, RECOVERY.  *
         OI    CASCANON(COMMREG),B'00100000'                       0308
*              SCANOPT='0'B;           /* SET OPTION WORD BIT TO IND
*                                         SCAN 'ON'.                  *
         NI    SCANOPT(COMMREG),B'11111110'                        0309
*              GOTO RECOVMSG;          /* ISSUE MESSAGE IF THIS IS 0310
*                                         SUCCESSFUL RECOVERY.        *
         B     RECOVMSG                                            0310
*            END;                      /* END OF 'SCAN ON' PROCESSING.*
*          ELSE;                       /* 'SCAN ON' NOT SPECIFIED.    *
*                                                                  0312
@RF00179 DS    0H                                                  0313
*          /* WAS THE 'OFF' KEYWORD SPECIFIED -                       *
*                                                                  0313
*          IF KEYWD=2 THEN             /* 'SCAN OFF SPECIFIED.        *
         L     @12,CAPTPRSD(,COMMREG)                              0313
         CLC   KEYWD(2,@12),@CH00088                               0313
         BNE   @RF00313                                            0313
*          /***********************************************************
*          /* 'SCAN OFF' PROCESSING.                                  *
*          /***********************************************************
*                                                                  0314
*OFFSPEC:    /* A SPECIAL CALL FOR END PORCESSING FOR SYNTAX CHECKER  *
*            /* CLEANUP AND DELETION RESULTS IN 'SCAN OFF' PROCESSING.*
*                                                                  0314
*            DO;                       /* BEGIN 'SCAN OFF' PROCESSING.*
*                                                                  0314
OFFSPEC  DS    0H                                                  0315
*              /* IS THIS AN ITF DATA SET, REQUIRING THE PROCESSOR'S  *
*              /* PRESENCE FOR MAINTENANCE OF A RUN-TIME DATA SET -   *
*                                                                  0315
*              IF CADSCODE=CABASIC                                 0315
*                ×CADSCODE=CAIPLI THEN /* ITF DATA SET TYPE.          *
*                                                                  0315
         CLI   CADSCODE(COMMREG),X'20'                             0315
         BE    @RT00315                                            0315
         CLI   CADSCODE(COMMREG),X'21'                             0315
         BNE   @RF00315                                            0315
@RT00315 DS    0H                                                  0316
*                /* IS THIS A SPECIAL CALL FOR END PROCESSING -       *
*                                                                  0316
*                IF CAENDSC='0'B THEN   /* NOT END PROCESSING.        *
         TM    CAENDSC(COMMREG),B'00000100'                        0316
         BZ    @RT00316                                            0316
*                  GOTO SETOFF;        /* ONLY TURN OFF SWITCHES, FOR
*                                         PROCESSOR IS NEEDED TO KEEP
*                                         RUN-TIME DATA SET CURRENT.  *
*                ELSE                  /* END PROCESSING. FREE CORE
*                                         TAKEN BY PROCESSOR IF IT IS
*                                         LOADED.                     *
*                  GOTO PREFINAL;      /* TEST FOR CHECKER LOADED.    *
         B     PREFINAL                                            0318
*              ELSE                    /* NOT ITF DATA SET TYPE.      *
*                DO;                   /* BEGIN NON-ITS 'SCAN OFF' 0319
*                                         PROCESSING.                 *
*                                                                  0319
@RF00315 DS    0H                                                  0320
*                  /* IS SCANNING ALREADY 'OFF' -                     *
*                                                                  0320
*                  IF CASCANSW='0'B THEN   /* SCAN IS 'OFF'.          *
         TM    CASCANSW(COMMREG),B'00010000'                       0320
         BZ    @RT00320                                            0320
*                    GOTO SCANEXIT;    /* CLEAN UP AND RETURN.        *
*                  ELSE;               /* SCAN IS NOT YET 'OFF'.      *
*                                                                  0322
*PREFINAL:         /* FIND OUT IF CHECKER IS LOADED BEFORE TRYING TO  *
*                  /* DELETE IT.                                      *
*                                                                  0323
*                 IF CAPTCHK^=0 THEN   /* CHECKER IS LOADED.          *
*                                                                  0323
PREFINAL ICM   @12,15,CAPTCHK(COMMREG)                             0323
         BZ    @RF00323                                            0323
*FNLENTRY:           /* CONTROL COMES HERE DURING SYNTAX CHECKER      *
*                    /* RECOVERY FOR CLEAN UP AND DELETION OF CHECKER *
*                    /* PRIOR TO RELOADING.                           *
*                                                                  0324
*                    DO;               /* BEGIN FINAL CALL, DELETION. *
FNLENTRY DS    0H                                                  0325
*                      CASYNBFR=0;     /* NO LINES SENT FOR CHECKING. *
         SLR   @12,@12                                             0325
         ST    @12,CASYNBFR(,COMMREG)                              0325
*                      FIRSTENT='1'B;  /* SET BIT IN SYNTAX CKR COMM
*                                         AREA TO IND NOT A 1ST ENTRY.*
*                      LASTENT='1'B;   /* SET BIT TO IND FINAL ENTRY. *
         OI    FIRSTENT(COMMREG),B'10100000'                       0327
*                      PARMREG1=                                   0328
*                        ADDR(CASYNLST);/* SET PT TO ADDRESS LIST.    *
         LA    PARMREG1,CASYNLST(,COMMREG)                         0328
*                      CALL CHECKER;   /* INVOKE SYNTAX CHECKER FOR
*                                         FINAL ENTRY.                *
         L     @15,CAPTCHK(,COMMREG)                               0329
         BALR  @14,@15                                             0329
*                      PARMREG0=                                   0330
*                        ADDR(CASYNAME);/* SET PT TO ENTRY NAME.      *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0330
*                      GEN (DELETE EPLOC=(PARMREG0));/* DELETE CKR.   *
         DELETE EPLOC=(PARMREG0)
*                      CAPTCHK=0;      /* IND CHECKER NOT LOADED.     *
         SLR   @12,@12                                             0332
         ST    @12,CAPTCHK(,COMMREG)                               0332
*                    END;              /* FINAL CALL AND DELETION ARE
*                                         COMPLEAT.                   *
*                  ELSE;               /* CHECKER WAS NOT LOADED, SO
*                                         DELETION WAS SKIPPED.       *
*                                                                  0334
@RF00323 DS    0H                                                  0335
*                  /* IS RECOVERY IN PROGRESS -                       *
*                                                                  0335
*                  IF CASCRC20='1'B THEN  /* RECOVERY GOING ON.       *
         TM    CASCRC20(COMMREG),B'00001000'                       0335
         BO    @RT00335                                            0335
*                    GOTO RECOVER;     /* RELOAD AND REINITLZ CHECKER.*
*                  ELSE;               /* THIS IS NOT RECOVERY.       *
*                                                                  0337
*SETOFF:           /* CONTROL COMES HERE TO TURN OFF SCANNING.        *
*                                                                  0338
*                  CASCANSW='0'B;      /* SET SW IN EDIT COMMUNICATION
*                                         AREA TO IND SCANNING IN  0338
*                                         EFFECT.                     *
SETOFF   DS    0H                                                  0339
*                  CAPROMPT='0'B;      /* TURN OFF PROMPT SWITCH FOR
*                                         INPUT.                      *
         NI    CASCANSW(COMMREG),B'11001111'                       0339
*                  CASCANON='0'B;      /* SET SW TO REMEMBER SCAN OFF
*                                         IN CASE OF SYNTAX CHECKER
*                                         FAILURE AND RECOVERY.       *
         NI    CASCANON(COMMREG),B'11011111'                       0340
*                  SCANOPT='1'B;       /* SET OPTION WORD BIT TO IND
*                                         SCANNING NOT IN EFFECT.     *
         OI    SCANOPT(COMMREG),B'00000001'                        0341
*                  GOTO SCANEXIT;      /* CLEAN UP AND RETURN.        *
         B     SCANEXIT                                            0342
*                END;                  /* NON-ITF 'SCAN OFF'       0343
*                                         PROCESSING COMPLEAT.        *
*            END;                      /* END 'SCAN OFF' PROCESSING.  *
*          ELSE;                       /* NEITHER 'ON' NOR 'OFF' WAS
*                                         SPECIFIED.                  *
@RF00313 DS    0H                                                  0346
*          /***********************************************************
*          /* PROCESSING FOR NO KEYWORD SPECIFIED.                    *
*          /***********************************************************
*                                                                  0346
*          /* WAS A LINE NO. SPECIFIED BUT DATA SET NOT LINE-NUMBERED-*
*                                                                  0346
*          IF CANONUM='1'B                                         0346
*            &LNSTART->LINENUM(1)                                  0346
*            ^='*' THEN                /* INVALID REFERENCE BY     0346
*                                         LINE NUMBER.                *
         TM    CANONUM(COMMREG),B'00000001'                        0346
         BNO   @RF00346                                            0346
         L     @12,CAPTPRSD(,COMMREG)                              0346
         L     @12,LNSTART(,@12)                                   0346
         CLI   LINENUM(@12),C'*'                                   0346
         BE    @RF00346                                            0346
*            DO;                       /* BEGIN MESSAGE SET-UP.       *
*              RELMSG1 =1288;          /* SET 1ST-LEVEL MSG NO.       *
         MVC   RELMSG1(2),@CH01235                                 0348
*              RELMSG2 =0;             /* NO 2ND LEVEL MSG.           *
         SLR   @12,@12                                             0349
         STH   @12,RELMSG2                                         0349
*              LEV1INS =0;             /* NO INSERTIONS.              *
         LR    LEV1INS,@12                                         0350
*              LEV2INS =0;             /* DITTO.                      *
         LR    LEV2INS,@12                                         0351
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  *
         LA    RETCDREG,SENDMSG                                    0352
*              CALL SENDMSG;           /* INVOKE MSG-SENDING ROUTINE. *
         BAL   @14,SENDMSG                                         0353
*              GOTO FCNINCMP;          /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FCNINCMP                                            0354
*            END;                      /* END OF MESSAGE SET-UP.      *
*          ELSE;                       /* NO INVALID REFERENCE BY LINE
*                                         NUMBER.                     *
*                                                                  0356
@RF00346 DS    0H                                                  0357
*TOTLSCAN:;/* CONTROL COMES HERE WHEN NO OPERANDS ARE SPECIFIED (I.E.,*
TOTLSCAN DS    0H                                                  0358
*          /* THE WHOLE DATA SET IS TO BE SCANNED.                    *
*                                                                  0358
*          CALL WHOLSCAN;                                          0358
         BAL   @14,WHOLSCAN                                        0358
*          GOTO SCANEXIT;             /*  RETURN TO CALLER            *
*                                                                  0359
         B     SCANEXIT                                            0359
*RECOVMSG: /* CONTROL COMES HERE AFTER 'SCAN ON' PROCESSING TO ISSUE  *
*          /* THE RECOVERY MESSAGE IS NECESSARY.                      *
*                                                                  0360
*          /* IS RECOVERY IN PROGRESS -                               *
*                                                                  0360
*          IF CASCRC20='1'B THEN       /* RECOVERY.                   *
RECOVMSG TM    CASCRC20(COMMREG),B'00001000'                       0360
         BNO   @RF00360                                            0360
*            DO;                       /* BEGIN RECOVERY NOTIFICATION.*
*              CASCRC20='0'B;          /* IND RECOVERY IS OVER.       *
         NI    CASCRC20(COMMREG),B'11110111'                       0362
*              IF CADSCODE=CAIPLI×CADSCODE=CABASIC THEN /*      A50466*
         CLI   CADSCODE(COMMREG),X'21'                             0363
         BE    @RT00363                                            0363
         CLI   CADSCODE(COMMREG),X'20'                             0363
         BNE   @RF00363                                            0363
@RT00363 DS    0H                                                  0364
*                DO;                   /* IF ITF SEND MSG       A50466*
*                                      /* IKJ52368I             A50466*
*                RELMSG1 =1801;        /* SET FIRST-LVL MSG NO. A50466*
         MVC   RELMSG1(2),@CH01238                                 0365
*                RELMSG2 =0;           /* NO SECOND-LEVEL MSG   A50466*
         SLR   @12,@12                                             0366
         STH   @12,RELMSG2                                         0366
*                LEV1INS =0;           /* NO INSERTIONS         A50466*
         LR    LEV1INS,@12                                         0367
*                LEV2INS =0;           /* NO INSERTIONS         A50466*
         LR    LEV2INS,@12                                         0368
*                RETCDREG=ADDR(SENDMSG); /* ADDRESS OF MSG RTN  A50466*
         LA    RETCDREG,SENDMSG                                    0369
*                CALL SENDMSG;         /* INVOKE MSG ROUTINE    A50466*
         BAL   @14,SENDMSG                                         0370
*                END;                  /* END IKJ52368 PROCESS  A50466*
*              ELSE DO;                /* IF NOT ITF, SEND MSG  A50466*
         B     @RC00363                                            0372
@RF00363 DS    0H                                                  0373
*                                      /* IKJ52367I             A50466*
*              MSGPTR=0;               /* ONLY 1 INSERT.              *
         SLR   @12,@12                                             0373
         ST    @12,MSGPTR(,COMMREG)                                0373
*              MSGOFF=10;              /* OFFSET TO INSERT.           *
         MVC   MSGOFF(2,COMMREG),@CH00387                          0374
*              MSGTEXT=CADSTYPE;       /* INSERTION TEXT.             *
         MVI   MSGTEXT+8(COMMREG),C' '                             0375
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0375
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0375
*              /* REMOVE TRAILING BLANKS FROM DATA SET TYPE NAME.     *
*              DO I=LENGTH(CADSTYPE)                               0376
*                TO 1 BY -1;           /* REMOVE TRAILING BLANKS.     *
*                                                                  0376
         LA    I,8                                                 0376
@DL00376 DS    0H                                                  0377
*                /* IS THIS CHARACTER A BLANK -                       *
*                                                                  0377
*                IF MSGTEXT(I)                                     0377
*                  ^=' ' THEN          /* LAST NON-BLANK FOUND.       *
         LR    @12,COMMREG                                         0377
         ALR   @12,I                                               0377
         CLI   MSGTEXT-1(@12),C' '                                 0377
         BNE   @RT00377                                            0377
*                  GOTO CALC;          /* COMPUTE LNG OF INSERTION.   *
*                ELSE;                 /* CHARACTER IS A BLANK. CON-
*                                         TINUE SEARCHING.            *
*              END;                    /* END OF TRAILING BLANK    0380
*                                         REMOVAL.                    *
*                                                                  0380
         BCTR  I,0                                                 0380
         LTR   I,I                                                 0380
         BP    @DL00376                                            0380
*CALC:         /* CONTROL COMES HERE AFTER LAST NON-BLANK IN MESSAGE  *
*              /* INSERTION IS FOUND.                                 *
*                                                                  0381
*              MSGLEN=I+LENGTH(MSGLEN)+LENGTH(MSGOFF);/* SET LENGTH.  *
CALC     LA    @12,4                                               0381
         ALR   @12,I                                               0381
         STH   @12,MSGLEN(,COMMREG)                                0381
*              RELMSG1 =1792;          /* SET 1ST-LEVEL MSG NO.       *
         MVC   RELMSG1(2),@CH01243                                 0382
*              RELMSG2 =1;             /* SET 2ND-LEVEL MSG NO.       *
         MVC   RELMSG2(2),@CH00039                                 0383
*              LEV1INS =0;             /* NO 1ST-LEVEL INSERTION.     *
         SLR   LEV1INS,LEV1INS                                     0384
*              LEV2INS =ADDR(MSGPTR);  /* SET PT TO 2ND-LEVEL INSERT. *
         LA    LEV2INS,MSGPTR(,COMMREG)                            0385
*              RETCDREG=ADDR(SENDMSG); /* PT TO MSG-SENDING ROUTINE.  *
         LA    RETCDREG,SENDMSG                                    0386
*              CALL SENDMSG;           /* INVOKE MSG-SENDING ROUTINE. *
         BAL   @14,SENDMSG                                         0387
*              END;                    /* END IKJ52367I PROCESS A50466*
*            END;                      /* END RECOVERY NOTIFICATION.  *
*          ELSE;                       /* NOT RECOVERY.               *
*                                                                  0390
@RF00360 DS    0H                                                  0391
*SCANEXIT: /* CONTROL COMES HERE BEFORE RETURNING TO CALLER WHENEVER  *
*          /* THERE MAY BE A PARSE PDL TO BE FREED.                   *
*                                                                  0391
*          IF CAFREEDL='1'B THEN       /* NO PDL TO BE FREED.         *
@RC00360 DS    0H                                                  0391
SCANEXIT TM    CAFREEDL(COMMREG),B'10000000'                       0391
         BO    @RT00391                                            0391
*            GOTO NOSCNEXT;            /* RETURN TO CALLER WITH R.C.  *
*          ELSE                        /* PDL MUST BE FREED.          *
*            PARMREG1=ADDR(CAPTPRSD);  /* SET ADDRESS OF ANSWER PLACE.*
         LA    PARMREG1,CAPTPRSD(,COMMREG)                         0393
*          GEN ( IKJRLSA (PARMREG1));  /* FREE PDL CORE.              *
*                                                                  0394
          IKJRLSA (PARMREG1)
*NOSCNEXT: /* CONTROL COMES HERE WHENEVER CONTROL IS TO BE RETURNED   *
*          /* TO THE CALLER BUT NO PDL NEEDS TO BE FREED.             *
*                                                                  0395
*          CAFREEDL='1'B;              /* IND NO PDL TO BE FREED.     *
NOSCNEXT OI    CAFREEDL(COMMREG),B'10000000'                       0395
*          RETCDREG=SCRETCD;           /* PUT RET CODE IN REGISTER.   *
*                                                                  0396
         L     RETCDREG,SCRETCD                                    0396
*           RESPECIFY (GPR12P,GPR13P) RSTD;                        0397
*           CANXTSVA = GPR13P;       /* UPDATE NEXT-SAVE-AREA PTR    */
         ST    GPR13P,CANXTSVA(,COMMREG)                           0398
*           GPR12P = GPR13P;         /* SAVE PRESENT SAVE-AREA ADDR  */
         LR    GPR12P,GPR13P                                       0399
*           GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD       */
         L     @08,CASAVPTR+4(,GPR13P)                             0400
         LR    GPR13P,@08                                          0400
*                                    /* SAVE-AREA PTR                */
*           RESPECIFY CASAVE BASED(GPR12P); /* CHANGE BASE FOR       */
*                                    /* SAVE-AREA                    */
*           CASAVE = CASAVE && CASAVE; /* ZERO OUT THIS SAVE-AREA    */
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0402
*           RESPECIFY CASAVE BASED;                                0403
*           RETURN CODE(RETCDREG);   /* RETURN WITH RETURN CODE      */
         L     @14,12(,@13)                                        0404
         LM    @00,@12,20(@13)                                     0404
         BR    @14                                                 0404
*           RESPECIFY (GPR12P,GPR13P) UNRSTD;                      0405
*                                         /*   RETURN TO CALLER.   0406
* */                                                               0406
*                                                                  0406
*FCNINCMP: /* CONTROL COMES HERE WHEN THIS MODULE'S FUNCTION HAS NOT  *
*          /* BEEN COMPLETED (DUE TO PARSE UNABLE                     *
*          /* TO PROMPT, OR OTHER MALFUNCTION.)                       *
*                                                                  0406
*          SCRETCD=8;                  /* IND FUNCTION INCOMPLETE.    *
FCNINCMP MVC   SCRETCD(4),@CF00044                                 0406
*          GOTO SCANEXIT;              /* FREE PDL IF NECESSARY AND
*                                         RETURN TO CALLER.           *
         B     SCANEXIT                                            0407
*          /***********************************************************
*          /* PARAMETER CONTROL LIST(PCL) FOR PARSING OPERANDS.       *
*          /***********************************************************
*                                                                  0408
*          GEN DATA DEFS(SCANPCE);                                 0408
*CHKNAME:  /***********************************************************
*          /*                                                         *
*          /* THIS SUBROUTINE CHECKS THE STATUS OF THE APPROPRIATE    *
*          /* SYNTAX CHECKER OR PREPROCESSOR AS FOLLOWS:              *
*          /*                                                         *
*          /*      1.  CHECKER OPERATIONAL - SET RETURN CODE OF 0.    *
*          /*                                                         *
*          /*      2.  CHECKER NOT IN SYSTEM - NOTIFY USER AND SET    *
*          /*          RETURN CODE OF 4.                              *
*          /*                                                         *
*          /*      3.  CHECKER NOT OPERATIONAL - NOTIFY USER AND SET  *
*          /*          RETURN CODE OF 4.                              *
*          /*                                                         *
*          /***********************************************************
*                                                                  0409
*          PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0409
*                                                                  0409
@EL00001 DS    0H                                                  0409
@EF00001 DS    0H                                                  0409
@ER00001 LM    @14,@12,12(@13)                                     0409
         BR    @14                                                 0409
CHKNAME  DS    0H                                                  0410
*       RESPECIFY (COMMREG,            /* COMMUNICATION AREA ADDRESS. *
*                  BASEREG,            /* PROGRAM BASE REGISTER.      *
*                  BASEREG2,           /* 2ND PROGRAM BASE REGISTER.  *
*                  DATAREG) RSTD;      /* WORK AREA BASE REGISTER.    *
*          CHKPTR = RETREG;            /* SAVE RETURN POINT           *
         ST    RETREG,CHKPTR                                       0411
*          RETCODE=0;                  /* INITLZ NORMAL RETURN CODE.  *
*                                                                  0412
         SLR   RETCODE,RETCODE                                     0412
*          /* IS SYNTAX CHECKER IN SYSTEM AND OPERATIVE -             *
*                                                                  0413
*          IF CASYNAME='0000000000000000'X                         0413
*            ×CASYNAME='FFFFFFFFFFFFFFFF'X THEN/*                  0413
*                                         NOT IN SYSTEM AND OPERATIVE.*
         CLC   CASYNAME(8,COMMREG),@CB01255                        0413
         BE    @RT00413                                            0413
         CLC   CASYNAME(8,COMMREG),@CB01218                        0413
         BNE   @RF00413                                            0413
@RT00413 DS    0H                                                  0414
*            DO;                       /* BEGIN DIAGNOSIS.            *
*              RELMSG1 =1797;          /* RELATIVE MESSAGE NUMBER.    *
         MVC   RELMSG1(2),@CH01257                                 0415
*              LEV2INS =0;             /* NO 2ND-LEVEL INSERTION.     *
         SLR   @12,@12                                             0416
         LR    LEV2INS,@12                                         0416
*              MSGPTR=0;               /* NO THIRD INSERTION.         *
         ST    @12,MSGPTR(,COMMREG)                                0417
*              MSGOFF=29;              /* OFFSET TO INSERTION.        *
         MVC   MSGOFF(2,COMMREG),@CH01258                          0418
*              MSGTEXT=CADSTYPE;       /* INSERTION TEXT FOR MESSAGE. *
         MVI   MSGTEXT+8(COMMREG),C' '                             0419
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0419
         MVC   MSGTEXT(8,COMMREG),CADSTYPE(COMMREG)                0419
*              /* REMOVE TRAILING BLANKS FROM DATA SET TYPE NAME.     *
*              DO I=LENGTH(CADSTYPE)                               0420
*                TO 1 BY -1;           /* REMOVE TRAILING BLANKS.     *
*                                                                  0420
         LA    I,8                                                 0420
@DL00420 DS    0H                                                  0421
*                /* CHECK IF LAST NON-BLANK CHARACTER FOUND.          *
*                                                                  0421
*                IF MSGTEXT(I)^=' ' THEN   /* FOUND.                  *
         LR    @12,COMMREG                                         0421
         ALR   @12,I                                               0421
         CLI   MSGTEXT-1(@12),C' '                                 0421
         BNE   @RT00421                                            0421
*                  GOTO OUT;           /* CALC LNG OF INSERT FOR MSG. *
*                ELSE;                 /* NOT FOUND.                  *
*              END;                    /* END BLANK-REMOVAL LOOP.     *
*                                                                  0424
         BCTR  I,0                                                 0424
         LTR   I,I                                                 0424
         BP    @DL00420                                            0424
*OUT:          /* CONTROL COMES HERE WHEN LAST NON-BLANK CHARACTER IN *
*              /* DATA SET TYPE MESSAGE INSERTION IS FOUND.           *
*                                                                  0425
*              MSGLEN=I+4;             /* LNG OF MESSAGE INSERTION.   *
OUT      LA    @12,4                                               0425
         ALR   @12,I                                               0425
         STH   @12,MSGLEN(,COMMREG)                                0425
*              MSGPTR2=ADDR(MSGAREA);  /* CHAIN INSERTIONS.           *
         LA    @12,MSGAREA(,COMMREG)                               0426
         ST    @12,MSGPTR2                                         0426
*              MSGLEN2=LENGTH('SCAN')+4;         /* LNG OF 1ST INSERT.*
         LA    MSGLEN2,8                                           0427
*              MSGOFF2=10;             /* OFFSET TO INSERTION.        *
         LA    MSGOFF2,10                                          0428
*              MSGTEXT2='SCAN';        /* TEXT OF MSG INSERTION.      *
         MVC   MSGTEXT2(4),@CC01193                                0429
*              LEV1INS =ADDR(MSGPTR2); /* PT TO INSERTION CHAIN.      *
*                                                                  0430
         LA    LEV1INS,MSGPTR2                                     0430
*              /* CHECK IF SYNTAX CHECKER NOT IN SYSTEM.              *
*                                                                  0431
*              IF CASYNAME='0000000000000000'X THEN/*              0431
*                                           YES.                      *
         CLC   CASYNAME(8,COMMREG),@CB01255                        0431
         BNE   @RF00431                                            0431
*                RELMSG2 =1;           /* SELECT 2ND-LEVEL MESSAGE.   *
         MVC   RELMSG2(2),@CH00039                                 0432
*              ELSE                    /* NO.                         *
*                RELMSG2 =2;           /* CHECKER NOT OPERATIONAL.    *
*                                                                  0433
         B     @RC00431                                            0433
@RF00431 MVC   RELMSG2(2),@CH00088                                 0433
*              /* CHECK IF THIS IS FINAL ENTRY FOR EDIT.              *
*                                                                  0434
*              IF CAENDSC='0'B THEN    /* NO, NOT FINAL ENTRY.        *
@RC00431 TM    CAENDSC(COMMREG),B'00000100'                        0434
         BNZ   @RF00434                                            0434
*                DO;                   /* ISSUE MESSAGE.              *
*                  RETCDREG=ADDR(SENDMSG);/* PT TO MSG-SENDING RTN.   *
         LA    RETCDREG,SENDMSG                                    0436
*                  CALL SENDMSG;       /* GO TO SEND MSG TO USER.     *
         BAL   @14,SENDMSG                                         0437
*                  CAPTCHK=0;          /* INITLZ PT TO CHECKER TO 0.  *
*                                                                  0438
         SLR   @12,@12                                             0438
         ST    @12,CAPTCHK(,COMMREG)                               0438
*                  /* CHECK IF INPUT SOURCE IS AN IN-CORE PROCEDURE.  *
*                                                                  0439
*                  IF CAINPROC='1'B THEN  /* IN A PROCEDURE.          *
         TM    CAINPROC(COMMREG),B'00000100'                       0439
         BNO   @RF00439                                            0439
*                    SCRETCD=12;       /* SET RET CODE FOR CONTROLLER
*                                         WHICH WILL FORCE CLEARING OF
*                                         INPUT QUEUE.                *
         MVC   SCRETCD(4),@CF00151                                 0440
*                  ELSE                /* NOT IN A PROCEDURE, OR, IT IS
*                                         NOT YET KNOWN WHETHER IN A
*                                         PROCEDURE.                  *
*                    /* CLEAR INPUT QUEUE.  CONTROLLER CANNOT CLEAR   *
*                    /* QUEUE BECAUSE THIS MODULE IS GOING TO SEND A  *
*                    /* RET CODE ZERO TO CONTROLLER.                  *
*                    GEN (TCLEARQ INPUT);                          0441
         B     @RC00439                                            0441
@RF00439 DS    0H                                                  0441
         TCLEARQ INPUT
*                END;                  /* MESSAGE ISSUED.             *
*              ELSE;                   /* YES, FINAL ENTRY.           *
@RF00434 DS    0H                                                  0444
*              RETCODE=4;              /* SET UNNATURAL RETURN CODE.  *
@RC00434 LA    RETCODE,4                                           0444
*            END;                      /* END OF DIAGNOSIS.           *
*          ELSE;                       /* IN SYSTEM AND OPERATIVE.    *
@RF00413 DS    0H                                                  0447
*          RETCDREG=RETCODE;           /* MOVE RET CODE TO REGISTER.  *
         LR    RETCDREG,RETCODE                                    0447
*          RETREG = CHKPTR;            /* RESTORE RETURN POINT        *
         L     RETREG,CHKPTR                                       0448
*          RETURN;                     /* RETURN TO CALLING POINT     *
@EL00002 DS    0H                                                  0449
@EF00002 DS    0H                                                  0449
@ER00002 BR    @14                                                 0449
*          END CHKNAME;                /* STATUS-CHECKING COMPLETE.   *
*SENDMSG:  /***********************************************************
*          /*                                                         *
*          /* THIS SUBROUTINE USES THE EDIT MACRO IKJEBEML TO SEND    *
*          /* MESSAGES TO THE USER.  ALL POINTERS AND VALUES ARE      *
*          /* PASSED TO THIS SUBROUTINE IN REGISTERS 3, 4, 5, AND 6.  *
*          /* THE FORM OF THE MACRO IS AS FOLLOWS:                    *
*          /*       IKJEBEML LEV1MSG#,LEV2MSG#,LEV1INSERT,LEV2INSERT, *
*          /*                MF=(E,PARMLISTAREA)                      *
*          /*                                                         *
*          /***********************************************************
*                                                                  0451
*          PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0451
*                                                                  0451
SENDMSG  DS    0H                                                  0452
*          RESPECIFY (LEV1INS,LEV2INS) RSTD;                       0452
*          SENDPTR = RETREG;           /* SAVE RETURN POINT ADDRESS   *
         LR    SENDPTR,RETREG                                      0453
*          GEN REFS(LEV1INS,LEV2INS);  /* CALL MESSAGE-SELECT ROUTINE.*
CALLBEMS IKJEBEML ,,(LEV1INS),(LEV2INS),MF=(E,SRPLIST)
*          RESPECIFY (LEV1INS,LEV2INS) UNRSTD;                     0455
*          RETREG = SENDPTR;           /* RESTORE RETURN POINT ADDRESS*
         LR    RETREG,SENDPTR                                      0456
*          RETURN;                     /* RETURN TO CALLER            *
@EL00003 DS    0H                                                  0457
@EF00003 DS    0H                                                  0457
@ER00003 BR    @14                                                 0457
*          END SENDMSG;                /* MESSAGE HAS BEEN SENT       *
*                                                                  0458
*/*********************************************************************
*/* THIS SUBROUTINE INTERFACES WITH THE APPROPRIATE SYNTAX CHECKER,   *
*/* WHICH SCANS THE LINES PASSED FOR SYNTAX ERRORS AND, IF ONE IS     *
*/* FOUND, RETURNS A POINTER TO THE PROPER ERROR MESSAGE, WHICH       *
*/* THIS SUBROUTINE IN TURN SENDS TO THE USER VIA IKJEBEMS (MESSAGE   *
*/* SELECTION SERVICE ROUTINE) USING RELATIVE MESSAGE NUMBER ZERO.    *
*/* THIS SUBROUTINE LOADS AND INITIALIZES THE APPROPRIATE SYNTAX      *
*/* CHECKER, IF NECESSARY, AND PERFORMS A CONDITIONAL VARIABLE        *
*/* LENGTH GETMAIN FOR BUFFERS TO BE PASSED TO THE CHECKER.  THIS     *
*/* BUFFER IS REFILLED (OR ANOTHER BUFFER IS CHAINED TO IT) AFTER     *
*/* EACH CALL TO THE CHECKER UNTIL THE LINE RANGE IS EXHAUSTED.       *
*/* AFTER COMPLETION OF THE SCANNING OPERATION, THE CHECKER IS        *
*/* DELETED IF NECESSARY AND ANY BUFFER(S) FOTTEN IS/ARE FREED.       *
*/* IF THERE IS A PARAMETER DESCRIPTOR LIST IT IS RELEASED AND        *
*/* CONTROL IS RETURNED TO THE CALLER VIA IKJEBESC.                   *
*/*********************************************************************
*WHOLSCAN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                        0459
WHOLSCAN DS    0H                                                  0460
*          /***********************************************************
*          /* RESTRICT COMPILER'S USE OF REGISTERS.                   *
*          /***********************************************************
*                                                                  0460
*          RESPECIFY (PARMREG1,        /* PT TO PARAMETER LIST.       *
*                    BINRYREG,         /* BINARY VALUE.               *
*                    COMMREG,          /* PT TO COMMUNICATION AREA.   *
*                    BASEREG,          /* PROGRAM BASE REGISTER.      *
*                    BASEREG2,         /* PROGRAM 2ND BASE REGISTER   *
*                    DATAREG) RSTD;    /* WORK AREA BASE REGISTER.    *
*                                                                  0460
*          WHOLPTR = RETREG;           /* SAVE RETURN POINT           *
         ST    RETREG,WHOLPTR                                      0461
*          RC12SW = '0'B;              /* INIT BUFFER CONTROL SWITCH  *
         NI    RC12SW,B'01111111'                                  0462
*          /***********************************************************
*          /* CHECK IF SYNTAX CHECKER ALREADY LOADED                  *
*          /***********************************************************
*          IF CAPTCHK = 0 THEN         /* IF NO, LOAD AND INITLZ IT.  *
         ICM   @12,15,CAPTCHK(COMMREG)                             0463
         BNZ   @RF00463                                            0463
*            DO;                       /* BEGIN LOADING AND INITLZTN. *
*              RFY PARMREG0 RSTD;                                  0465
*              PARMREG0 = ADDR(CASYNAME);/*SET PT TO ENTRY NAME.      *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0466
*              /* LOAD CHECKER.                                       *
*              GEN (LOAD EPLOC=(0));                               0467
         LOAD EPLOC=(0)
*              CAPTCHK = PARMREG0;     /* SAVE ENTRY PT ADDRESS.      *
         ST    PARMREG0,CAPTCHK(,COMMREG)                          0468
*              CALL INITPLST;          /* INITLZ INTERFACE.           *
         BAL   @14,INITPLST                                        0469
*              PARMREG1 = ADDR(CASYNLST);/* SET PT TO PARM LIST.      *
         LA    PARMREG1,CASYNLST(,COMMREG)                         0470
*              CALL CHECKER;           /* INITIAL CALL.               *
         L     @15,CAPTCHK(,COMMREG)                               0471
         BALR  @14,@15                                             0471
*              RETCODE = RETCDREG;     /* SAVE RETURN CODE.           *
         LR    RETCODE,RETCDREG                                    0472
*              CASYNMS1 = 0;           /* RESET MESSAGE               *
         SLR   @08,@08                                             0473
         ST    @08,CASYNMS1(,COMMREG)                              0473
*              CASYNMS2 = 0;           /*  POINTERS TO ZERO.          *
         ST    @08,CASYNMS2(,COMMREG)                              0474
*              RFY PARMREG0 UNRSTD;                                0475
*              /*******************************************************
*              /* CHECK FOR SUCCESSFUL INITIAL CALL.                  *
*              /*******************************************************
*              IF RETCODE ^= 0 THEN       /* UNSUCCESSFUL INIT CALL.  *
         CR    RETCODE,@08                                         0476
         BE    @RF00476                                            0476
*                DO;                   /* INDICATE RECOVERY NECESSARY.*
*                  SCRETCD = 16;       /* CHECKER BECAME INOPERATIVE. *
         MVC   SCRETCD(4),@CF00241                                 0478
*                  GO TO SCNEXIT;      /* RETURN FOR RECOVERY.        *
         B     SCNEXIT                                             0479
*                END;                  /* RECOVERY INDICATED.         *
*            END;                      /* INITIALIZATION COMPLETE.    *
@RF00476 DS    0H                                                  0482
*          /***********************************************************
*          /* GETMAIN TWO K BYTES FOR SYNTAX CHECKER BUFFER           *
*          /***********************************************************
*          GETMNLO = 260;              /* MINIMUM BUFFER REQUIRED.    *
@RF00463 MVC   GETMNLO(4),@CF00296                                 0482
*          GETMNHI = 2048;             /* MAXIMUM BUFFER DESIRED.     *
         MVC   GETMNHI(4),@CF01268                                 0483
*          GETLST01 = ADDR(GETMNLO);   /* SET PT TO SIZE REQUEST.     *
*                                                                  0484
*                                                                  0484
*                                                                  0484
         LA    @12,GETMNLO                                         0484
         ST    @12,GETLST01                                        0484
*          SUBPOOL = 1;                /* SET SUBPOOL NUMBER.         *
         MVI   SUBPOOL,X'01'                                       0485
*          /* ISSUE VARIABLE CONDITIONAL GETMAIN FOR BUFFERS          *
*          DO; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF(E
*GETLST) RTCD(RETCDREG)*/                                          0486
*          RESPECIFY (GPR01P,GPR15F) RESTRICTED;                   0487
*          GETLST04 = 'E0'X; /* TYPE */                            0488
         MVI   GETLST04,X'E0'                                      0488
*          GETLST03 = ADDR(GETBUFF); /* ADDR OF ADDR LIST */       0489
         LA    @14,GETBUFF                                         0489
         STCM  @14,7,GETLST03                                      0489
*          GETLST05 = SUBPOOL; /* SUBPOOL VALUE */                 0490
         MVC   GETLST05(1),SUBPOOL                                 0490
*          GPR01P = ADDR(GETLST); /* REG1 POINTS TO LIST */        0491
         LA    GPR01P,GETLST                                       0491
*          SVC(4);/* STANDARD-FORM OF GETMAIN*/                    0492
         SVC   4                                                   0492
*          RETCDREG = GPR15F; /* SET RETURN CODE */                0493
*          RESPECIFY (GPR01P,GPR15F) UNRESTRICTED;                 0494
*          END; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF(
*,GETLST) RTCD(RETCDREG)*/                                         0495
*          RETCODE = RETCDREG;         /* SAVE RETURN CODE.           *
         LR    RETCODE,RETCDREG                                    0496
*          /***********************************************************
*          /* CHECK IF GETMAIN AREA OBTAINED                          *
*          /***********************************************************
*          IF RETCODE ^= 0 THEN        /* BUFFER NOT OBTAINED.        *
         LTR   RETCODE,RETCODE                                     0497
         BZ    @RF00497                                            0497
*            DO;                       /* BEGIN USER NOTIFICATION.    *
*NOCORE:       /* CONTROL COMES HERE TO ISSUE 'NOT ENOUGH MAIN STORGE'*
*              MSGPTR = 0;             /* NO 2ND INSERTION.           *
NOCORE   SLR   @12,@12                                             0499
         ST    @12,MSGPTR(,COMMREG)                                0499
*              MSGLEN = CASCMDLN + 4;       /* INSERTION LENGTH.      *
         LA    @08,4                                               0500
         AH    @08,CASCMDLN(,COMMREG)                              0500
         STH   @08,MSGLEN(,COMMREG)                                0500
*              MSGOFF = 45;            /* INSERTION OFFSET.           *
         MVC   MSGOFF(2,COMMREG),@CH01206                          0501
*              MSGTEXT = CAPTSCMD->LINENUM;/* INSERTION TEXT.         *
         MVI   MSGTEXT+8(COMMREG),C' '                             0502
         MVC   MSGTEXT+9(63,COMMREG),MSGTEXT+8(COMMREG)            0502
         L     @08,CAPTSCMD(,COMMREG)                              0502
         MVC   MSGTEXT(8,COMMREG),LINENUM(@08)                     0502
*              RELMSG1  = 270;         /* MSG NO.                     *
         MVC   RELMSG1(2),@CH01207                                 0503
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           *
         STH   @12,RELMSG2                                         0504
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERT.              *
         LA    LEV1INS,MSGAREA(,COMMREG)                           0505
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERT.        *
         LR    LEV2INS,@12                                         0506
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     *
         LA    RETCDREG,SENDMSG                                    0507
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             *
         BAL   @14,SENDMSG                                         0508
*              SCRETCD=8;              /* IND FUNCTION INCOMPLETE.    *
         MVC   SCRETCD(4),@CF00044                                 0509
*              GO TO DELTMOD;          /* GOTO DELETE CHECKER.        *
         B     DELTMOD                                             0510
*            END;                      /* USER NOTIFIED.              *
*          DCBPTR = CAPTCDCB;          /* INIT DCB PTR FOR IKJEBEUT   *
@RF00497 MVC   DCBPTR(3),CAPTCDCB+1(COMMREG)                       0512
*          AREAPTR = ADDR(UTBUFFER);   /* INIT BUFFER PTR FOR IKJEBEUT*
         LA    @12,UTBUFFER(,COMMREG)                              0513
         ST    @12,AREAPTR                                         0513
*          PLISTEND = '1'B;            /* MARK END OF PARAMETER LIST  *
         OI    PLISTEND,B'10000000'                                0514
*          RECRDKEY = CACURNUM;        /* SAVE CURRENT REFERENCE LINE *
         MVC   RECRDKEY(4),CACURNUM(COMMREG)                       0515
*          TOTALINE = 0;               /* INITLZ NO. OF LINES PASSED. *
         SLR   @12,@12                                             0516
         LR    TOTALINE,@12                                        0516
*          TOTALINX = 0;               /* INITLZ PREVIOUS NO. PASSED. *
         ST    @12,TOTALINX                                        0517
*          RECRDNO = 0;                /* NO LINES IN BUFFER YET.     *
         SLR   @07,@07                                             0518
         ICM   @07,7,BUFFPTR                                       0518
         MVI   RECRDNO(@07),X'00'                                  0518
*          FORWDPTR = 0;               /* NO BUFFERS CHAINED YET.     *
         STCM  @12,7,FORWDPTR(@07)                                 0519
*          CASYNBFR = BUFFPTR;         /**SET PT TO BUFFER CHAIN     **
         ST    @07,CASYNBFR(,COMMREG)                              0520
*          SNSYNBFR = CASYNBFR;        /* SAVE CASYNBFR               *
         ST    @07,SNSYNBFR                                        0521
*          CURBFPTR = BUFFPTR;         /* SET CURRENT BUFFER POSITION
*                                         PTR TO BEGINNING OF BUFFER  *
         LR    CURBFPTR,@07                                        0522
*          ENDBFPTR = BUFFPTR + GETMNLEN; /* INIT END PTR OF BUFFER   *
         L     @05,GETMNLEN                                        0523
         ALR   @07,@05                                             0523
         STCM  @07,7,ENDBFPTR                                      0523
*          FREEAREA(1:4) = GETBUFF;    /* INIT FREEMAIN AREA PTR      *
         MVC   FREEAREA(4,COMMREG),GETBUFF                         0524
*          FREELEN(1:4) = GETMNLEN;    /* INIT FREEMAIN LENGTH        *
         ST    @05,FREELEN(,COMMREG)                               0525
*          FREEPTR = ADDR(FREEAREA);   /* INIT PTR TO CURRENT BUFFAREA*
         LA    @07,FREEAREA(,COMMREG)                              0526
         STCM  @07,7,FREEPTR                                       0526
*          FREELNPT = ADDR(FREELEN);   /* INIT PTR TO CURRENT LENGTH  *
         LA    @07,FREELEN(,COMMREG)                               0527
         STCM  @07,7,FREELNPT                                      0527
*          FREELNPT->HIORDBIT = '1'B;  /* SET END OF LIST MARKER      *
         OI    HIORDBIT(@07),B'10000000'                           0528
*          /***********************************************************
*          /* CHECK IF SCAN OF WHOLE DATA SET SPECIFIED               *
*          /***********************************************************
*          IF CAOPERND = '1'B THEN     /* LINE RANGE SPECIFIED.       *
         TM    CAOPERND(COMMREG),B'10000000'                       0529
         BO    @RT00529                                            0529
*            GO TO PARTLSCN;           /* GOTO SCAN LINE RANGE.       *
*          /* READ FIRST RECORD IN DATA SET                           *
*          KEYPTR = 0;                 /* NO KEY REQUIRED.            *
         SLR   @07,@07                                             0531
         ST    @07,KEYPTR                                          0531
*          UTCODE = '04'X;             /* SET CODE TO READ FIRST LINE *
         MVI   UTCODE,X'04'                                        0532
*          RETCDREG = ADDR(READRTN);   /* SET PT TO READ ROUTINE.     *
         LA    RETCDREG,READRTN                                    0533
*          CALL READRTN;               /* CALL IKJEBEUT TO READ LINE  *
         BAL   @14,READRTN                                         0534
*          /***********************************************************
*          /* CHECK IF I/O ERROR OCCURRED IN EDIT DATA SET            *
*          /***********************************************************
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       *
         CH    RETCODE,@CH00044                                    0535
         BNE   @RF00535                                            0535
*            DO;                       /* NOTIFY CALLER.              *
*IOERR:        /* CONTROL COMES HERE TO SET I/O ERROR RET CODE.       *
*              SCRETCD = 12;           /* SET RET CODE.               *
IOERR    MVC   SCRETCD(4),@CF00151                                 0537
*              GO TO CLEANUP;          /* RETURN TO CALLER.           *
         B     CLEANUP                                             0538
*            END;                      /* CALLER NOTIFIED.            *
*          /***********************************************************
*          /* CHECK IF RECORD EXISTS(WITH READ BEGIN IMPLIES EMPTY DS)*
*          /***********************************************************
*          IF RETCODE = 4 THEN         /* NO LINES IN DATA SET.       *
@RF00535 CH    RETCODE,@CH00452                                    0540
         BNE   @RF00540                                            0540
*            DO;                       /* NOTIFY USER.                *
*EMPTY: ;      /* CONTROL COMES HERE TO ISSUE 'NO LINES IN DATA SET'. *
EMPTY    DS    0H                                                  0543
*              RELMSG1  = 1287;        /* MSG NO.                     *
         MVC   RELMSG1(2),@CH01281                                 0543
*              RELMSG2  = 0;           /* NO 2ND LEVEL.               *
         SLR   @12,@12                                             0544
         STH   @12,RELMSG2                                         0544
*              LEV2INS  = 0;           /* NO                          *
         LR    LEV2INS,@12                                         0545
*              LEV1INS  = 0;           /*  INSERTIONS.                *
         LR    LEV1INS,@12                                         0546
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     *
         LA    RETCDREG,SENDMSG                                    0547
*              CALL SENDMSG;           /* GO TO ISSUE MSG.            *
         BAL   @14,SENDMSG                                         0548
*              GO TO CLEANUP;          /* RETURN TO CALLER.           *
         B     CLEANUP                                             0549
*            END;                      /* USER NOTIFIED.              *
*          COUNT = '7FFFFFFF'X;        /* INIT COUNT TO MAXIMUM VALUE *
@RF00540 L     @12,@CF01282                                        0551
         ST    @12,COUNT                                           0551
*          LNUMBER2 = '7FFFFFFF'X;     /* INIT LINENUM RANGE TO MAX   *
         ST    @12,LNUMBER2                                        0552
*          GO TO MOVEREC;              /* BRANCH TO MOVE LINE INTO BFR*
         B     MOVEREC                                             0553
*PARTLSCN: /***********************************************************
*          /* CHECK IF LINE NUMBER(S) SPECIFIED                       *
*          /***********************************************************
*          IF LNSTART->LINENUM(1)^='*' THEN          /* NUMBER(S) SPEC*
PARTLSCN L     @12,CAPTPRSD(,COMMREG)                              0554
         L     @07,LNSTART(,@12)                                   0554
         CLI   LINENUM(@07),C'*'                                   0554
         BE    @RF00554                                            0554
*            DO;                       /* BEGIN CONVERSION AND READ.  *
*              PACKAREA = '00000000';  /* INITLZ AREA TO C'00000000'. *
         MVC   PACKAREA(8),@CC01285                                0556
*              /* PUT CHARACTER NO. IN PACK AREA.                     *
*              PACKAREA(9-LNSTARTL:8) = LNSTART->LINENUM;          0557
         LA    @05,9                                               0557
         SH    @05,LNSTARTL(,@12)                                  0557
         LA    @12,PACKAREA-1(@05)                                 0557
         LCR   @05,@05                                             0557
         AH    @05,@CH00044                                        0557
         EX    @05,@SM01393                                        0557
*              CALL CONVERT;           /* GO TO CONVERT TO BINARY.    *
         BAL   @14,CONVERT                                         0558
*              LNUMBER1 = BINRYREG;    /* SAVE LINENUM1.              *
         ST    BINRYREG,LNUMBER1                                   0559
*              COUNT = '7FFFFFFF'X;    /* SET COUNT GT 99999999.      *
         MVC   COUNT(4),@CF01282                                   0560
*              /*******************************************************
*              /* CHECK IF LINE NO. RANGE SPECIFIED.                  *
*              /*******************************************************
*              IF LNENDF = '0'B THEN   /* 2ND NO. NOT SPEC.           *
         L     @12,CAPTPRSD(,COMMREG)                              0561
         TM    LNENDF(@12),B'10000000'                             0561
         BNZ   @RF00561                                            0561
*                DO;                   /* SET RANGE TO 1ST LINE NO.   *
*                  LNUMBER2 = LNUMBER1;/* SINGLE LINE RANGE.          *
         L     @12,LNUMBER1                                        0563
         ST    @12,LNUMBER2                                        0563
*                  GO TO READKEY;      /* GOTO BEGIN READING RECORDS. *
         B     READKEY                                             0564
*                END;                  /* RANGE SET TO 1 LINE.        *
*              PACKAREA = '00000000';  /* INITLZ 2ND LINE NO. TO C'0'.*
@RF00561 MVC   PACKAREA(8),@CC01285                                0566
*              /* PUT CHARACTER NO. IN PACKAREA.                      *
*              PACKAREA(9-LNENDL:8) = LNEND->LINENUM;              0567
         L     @12,CAPTPRSD(,COMMREG)                              0567
         LA    @07,9                                               0567
         SH    @07,LNENDL(,@12)                                    0567
         LA    @05,PACKAREA-1(@07)                                 0567
         LCR   @07,@07                                             0567
         AH    @07,@CH00044                                        0567
         L     @12,LNEND(,@12)                                     0567
         EX    @07,@SM01395                                        0567
*              CALL CONVERT;           /* GOTO CONVERT TO BINARY.     *
         BAL   @14,CONVERT                                         0568
*              LNUMBER2 = BINRYREG;    /* SAVE LINENUM2.              *
         ST    BINRYREG,LNUMBER2                                   0569
*              /*******************************************************
*              /* CHECK IF LINE NO. RANGE IS VALID.                   *
*              /*******************************************************
*              IF LNUMBER2 < LNUMBER1 THEN /* INVALID RANGE.          *
         L     @12,LNUMBER2                                        0570
         C     @12,LNUMBER1                                        0570
         BNL   @RF00570                                            0570
*                DO;                   /* NOTIFY USER.                *
*                  RELMSG1  = 1289;    /* MSG NO.                     *
         MVC   RELMSG1(2),@CH01288                                 0572
*                  RELMSG2  = 0;       /* NO 2ND LEVEL.               *
         SLR   @12,@12                                             0573
         STH   @12,RELMSG2                                         0573
*                  LEV1INS  = 0;       /* NO                          *
         LR    LEV1INS,@12                                         0574
*                  LEV2INS  = 0;       /*  INSERTIONS.                *
         LR    LEV2INS,@12                                         0575
*                  RETCDREG =ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.  *
         LA    RETCDREG,SENDMSG                                    0576
*                  CALL SENDMSG;       /* ISSUE MSG.                  *
         BAL   @14,SENDMSG                                         0577
*                  GOTO FNINCMP;       /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FNINCMP                                             0578
*                END;                  /* USER NOTIFIED.              *
*READKEY:      /*******************************************************
*              /* READ RECORD BY LINE NUMBER KEY.                     *
*              /*******************************************************
*              KEYPTR = ADDR(LNUMBER1);/* SET PT TO KEY.              *
@RF00570 DS    0H                                                  0580
READKEY  LA    @07,LNUMBER1                                        0580
         ST    @07,KEYPTR                                          0580
*              UTCODE = '00'X;         /* READ CURRENT OPTION.        *
         MVI   UTCODE,X'00'                                        0581
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    *
         LA    RETCDREG,READRTN                                    0582
*              CALL READRTN;           /* GO TO READ RCD.             *
         BAL   @14,READRTN                                         0583
*              GO TO CHKRETCD;         /* GOTO CHECK RETURN CODE.     *
         B     CHKRETCD                                            0584
*            END;                      /* END OF CONVERSION AND READ. *
*          /***********************************************************
*          /* CHECK IF COUNT SPECIFIED ON SCAN SUBCOMMAND             *
*          /***********************************************************
*          IF LNENDF = '0'B THEN       /* NO COUNT SPECIFIED.         *
@RF00554 L     @12,CAPTPRSD(,COMMREG)                              0586
         TM    LNENDF(@12),B'10000000'                             0586
         BNZ   @RF00586                                            0586
*            COUNT = 1;                /* SET COUNT TO 1.             *
         MVC   COUNT(4),@CF00039                                   0587
*          ELSE                        /* COUNT SPECIFIED.            *
*            DO;                       /* BEGIN CONVERSION.           *
         B     @RC00586                                            0588
@RF00586 DS    0H                                                  0589
*              PACKAREA = '00000000';  /* SET PACK AREA TO C'0'.      *
         MVC   PACKAREA(8),@CC01285                                0589
*              /* PUT CHARACTER COINT VALUE IN PACKAREA.              *
*              PACKAREA(9-LNENDL:8) = LNEND->LINENUM;              0590
         L     @12,CAPTPRSD(,COMMREG)                              0590
         LA    @07,9                                               0590
         SH    @07,LNENDL(,@12)                                    0590
         LA    @05,PACKAREA-1(@07)                                 0590
         LCR   @07,@07                                             0590
         AH    @07,@CH00044                                        0590
         L     @12,LNEND(,@12)                                     0590
         EX    @07,@SM01395                                        0590
*              CALL CONVERT;           /* GOTO CONVERT TO BINARY.     *
         BAL   @14,CONVERT                                         0591
*              COUNT = BINRYREG;       /* SAVE COINT.                 *
         ST    BINRYREG,COUNT                                      0592
*            END;                      /* CONVERSION DONE.            *
*          LNUMBER2 = '7FFFFFFF'X;     /* SET LINENUM1                *
@RC00586 L     @12,@CF01282                                        0594
         ST    @12,LNUMBER2                                        0594
*          LNUMBER1 = LNUMBER2 - 1;    /*  AND LINENUM2               *
         LR    @07,@12                                             0595
         BCTR  @07,0                                               0595
         ST    @07,LNUMBER1                                        0595
*          LNUMBER2 = '7FFFFFFF'X;     /*   GREATER THAN 99999999.    *
         ST    @12,LNUMBER2                                        0596
*          /***********************************************************
*          /* CHECK IF CURRENT REFERENCE LINE SET TO ZERO             *
*          /***********************************************************
*          IF CACURNUM = 0 THEN        /*      *=0.                   *
         SLR   @12,@12                                             0597
         C     @12,CACURNUM(,COMMREG)                              0597
         BNE   @RF00597                                            0597
*            DO;                       /* BEGIN READ 1ST RCD.         *
*              KEYPTR = 0;             /* NO KEY NEEDED.              *
         SLR   @07,@07                                             0599
         ST    @07,KEYPTR                                          0599
*              UTCODE = '04'X;         /* READ 1ST OPTION.            *
         MVI   UTCODE,X'04'                                        0600
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    *
         LA    RETCDREG,READRTN                                    0601
*              CALL READRTN;           /* GOTO READ 1ST RCD.          *
         BAL   @14,READRTN                                         0602
*              /*******************************************************
*              /* CHECK FOR I/O ERROR ON UTILITY.                     *
*              /*******************************************************
*              IF RETCODE = 8 THEN        /* I/O ERROR                *
         CH    RETCODE,@CH00044                                    0603
         BE    @RT00603                                            0603
*                GO TO IOERR;          /* GOTO ISSUE MSG.             *
*              /*******************************************************
*              /* CHECK IF RCD EXISTS(W/ READ 1ST IMPLIES EMPTY D.S.  *
*              /*******************************************************
*              IF RETCODE = 4 THEN        /* NO RCDS IN DATA SET.     *
         CH    RETCODE,@CH00452                                    0605
         BE    @RT00605                                            0605
*                GO TO EMPTY;          /* GOTO ISSUE 'NO LINES' MSG.  *
*              GO TO MOVEREC;          /* GOTO SET UP BUFFER.         *
         B     MOVEREC                                             0607
*            END;                      /* 1ST RCD READ.               *
*          /* READ CURRENT REFERENCE RECORD.                          *
*          KEYPTR = ADDR(CACURNUM);    /* INIT PTR TO KEY             *
@RF00597 LA    @07,CACURNUM(,COMMREG)                              0609
         ST    @07,KEYPTR                                          0609
*          UTCODE = '00'X;             /* SET CODE TO READ BY KEY     *
         MVI   UTCODE,X'00'                                        0610
*          RETCDREG = ADDR(READRTN);   /* SET ADDR OF ENTRY POINT.    *
         LA    RETCDREG,READRTN                                    0611
*          CALL READRTN;               /* READ CURR REFERENCE RCD.    *
         BAL   @14,READRTN                                         0612
*CHKRETCD: /***********************************************************
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    *
*          /***********************************************************
*          IF RETCODE = 8 THEN         /* I/O ERROR.                  *
CHKRETCD CH    RETCODE,@CH00044                                    0613
         BE    @RT00613                                            0613
*            GO TO IOERR;              /* GOTO INFORM CALLER.         *
*          /***********************************************************
*          /* CHECK IF RECORD EXISTS                                  *
*          /***********************************************************
*          IF RETCODE = 4 THEN         /* RCD NOT FOUND.              *
         CH    RETCODE,@CH00452                                    0615
         BE    @RT00615                                            0615
*            GO TO MORESCN;            /* GOTO TEST IF MSG NECESSARY. *
*MOVEREC:  /* CONTROL COMES HERE TO MOVE A RCD INTO THE BUFFER.       *
*          RECRDKEY = KEY;             /* SAVE NEW CURRENT LINE VALUE.*
MOVEREC  MVC   RECRDKEY(4),KEY(COMMREG)                            0617
*          /***********************************************************
*          /* CHECK IF FIXED LENGTH RECORD FORMAT                     *
*          /***********************************************************
*          IF CARECFM = '1'B THEN      /* RECFM = F.                  *
         TM    CARECFM(COMMREG),B'01000000'                        0618
         BNO   @RF00618                                            0618
*            DO;                       /* MOVE FIXED LNG RCD (DATA    *
*              CURBFPTR->RECRD(1:LL-4) = LINE;               /* ONLY).*
         SLR   @12,@12                                             0620
         ICM   @12,3,LL(COMMREG)                                   0620
         LR    @07,@12                                             0620
         SH    @07,@CH00138                                        0620
         EX    @07,@SM01397                                        0620
*              LL = LL - 4;            /* UPDATE LL FIELD.            *
         SH    @12,@CH00452                                        0621
         STH   @12,LL(,COMMREG)                                    0621
*            END;                      /* FIXED LNG RCD MOVED.        *
*          ELSE                        /* RECFM = V. MOVE DATA AND    *
*            CURBFPTR->RECRD(1:LL) = LL;          /*   CONTROL WORD.  *
         B     @RC00618                                            0623
@RF00618 SLR   @12,@12                                             0623
         ICM   @12,3,LL(COMMREG)                                   0623
         BCTR  @12,0                                               0623
         EX    @12,@SM01399                                        0623
*          /* CONTROL COMES HERE TO CONTINUE FILLING BUFFER.          *
*          CURBFPTR = CURBFPTR + LL;    /* UPDATE PT TO NEXT AVAILABLE
*                                          SPACE IN BUFFER.           *
@RC00618 SLR   @12,@12                                             0624
         ICM   @12,3,LL(COMMREG)                                   0624
         ALR   CURBFPTR,@12                                        0624
*          RECRDNO = RECRDNO + 1;       /* UPDATE LINE COUNT BY 1.    *
         SLR   @12,@12                                             0625
         ICM   @12,7,BUFFPTR                                       0625
         LA    @07,1                                               0625
         SLR   @05,@05                                             0625
         IC    @05,RECRDNO(,@12)                                   0625
         ALR   @07,@05                                             0625
         STC   @07,RECRDNO(,@12)                                   0625
*          /***********************************************************
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     *
*          /***********************************************************
*          IF KEY = LNUMBER2 × COUNT = TOTALINE + RECRDNO THEN /*NO MOR
*                                                                LINES*
         CLC   KEY(4,COMMREG),LNUMBER2                             0626
         BE    @RT00626                                            0626
         ALR   @07,TOTALINE                                        0626
         C     @07,COUNT                                           0626
         BNE   @RF00626                                            0626
@RT00626 DS    0H                                                  0627
*            DO;                       /* BEGIN CHECKING.             *
*              ENDSW = '1'B;           /* IND NO MORE LINES TO CHECK. *
         OI    ENDSW,B'01000000'                                   0628
*              GO TO SYNCHK;           /* GOTO CALL CHECKER.          *
         B     SYNCHK                                              0629
*            END;                      /* LINE(S) CHECKED.            *
*          KEYPTR = 0;                 /* PREPARE TO READ NEXT LINE.  *
@RF00626 SLR   @07,@07                                             0631
         ST    @07,KEYPTR                                          0631
*          UTCODE = '02'X;             /* OPTION CODE.                *
         MVI   UTCODE,X'02'                                        0632
*          RETCDREG = ADDR(READRTN);   /* ADDRESS OF ENTRY POINT.     *
         LA    RETCDREG,READRTN                                    0633
*          CALL READRTN;               /* READ NEXT RECORD            *
         BAL   @14,READRTN                                         0634
*          /***********************************************************
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    *
*          /***********************************************************
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       *
         CH    RETCODE,@CH00044                                    0635
         BE    @RT00635                                            0635
*            GO TO IOERR;              /* GOTO NOTIFY CALLER.         *
*          /***********************************************************
*          /* CHECK IF RECORD EXISTS(WITH READ NEXT IMPLIES EOD)      *
*          /***********************************************************
*          IF RETCODE = 4 THEN         /* NO MORE RCDS ON DATA SET.   *
         CH    RETCODE,@CH00452                                    0637
         BNE   @RF00637                                            0637
*            DO;                       /* BEGIN CHECKING.             *
*ENDDATA:      /* CONTROL COMES HERE TO SET INTERNAL SWITCH.          *
*              ENDSW = '1'B;           /* IND NO MORE LINES TO CHECK. *
ENDDATA  OI    ENDSW,B'01000000'                                   0639
*              GO TO SYNCHK;           /* GOTO CALL CHECKER.          *
         B     SYNCHK                                              0640
*            END;                      /* LINE(S) CHECKED.            *
*          /***********************************************************
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     *
*          /***********************************************************
*SCNMORE:  /* CONTROL COMES HERE TO SEE IF THERE IS MORE TO BE SCANNED*
*          IF KEY > LNUMBER2 × COUNT = TOTALINE + RECRDNO THEN /*NO MOR
*                                                                LINES*
@RF00637 DS    0H                                                  0642
SCNMORE  L     @12,KEY(,COMMREG)                                   0642
         C     @12,LNUMBER2                                        0642
         BH    @RT00642                                            0642
         SLR   @12,@12                                             0642
         ICM   @12,7,BUFFPTR                                       0642
         LR    @07,TOTALINE                                        0642
         SLR   @05,@05                                             0642
         IC    @05,RECRDNO(,@12)                                   0642
         ALR   @07,@05                                             0642
         C     @07,COUNT                                           0642
         BE    @RT00642                                            0642
*            GO TO ENDDATA;            /* GO TO SET SWITCH.           *
*          /***********************************************************
*          /* CHECK IF BUFFER AREA FILLED                             *
*          /***********************************************************
*          IF ENDBFPTR > CURBFPTR + CALRECL + 4 THEN        /*NOT FULL*
         LR    @12,CURBFPTR                                        0644
         AH    @12,CALRECL(,COMMREG)                               0644
         AH    @12,@CH00452                                        0644
         SLR   @07,@07                                             0644
         ICM   @07,7,ENDBFPTR                                      0644
         CR    @12,@07                                             0644
         BL    @RT00644                                            0644
*            GO TO MOVEREC;            /* GO TO BRING IN NEXT RCD.    *
*          ELSE                        /* BUFFER FULL.                *
*            GO TO SYNCHK;             /* GOTO CALL CHECKER.          *
         B     SYNCHK                                              0646
*MORESCN:  /***********************************************************
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     *
*          /***********************************************************
*          IF LNUMBER1 = LNUMBER2 × COUNT = 1 THEN     /* NO  MORE    *
MORESCN  CLC   LNUMBER1(4),LNUMBER2                                0647
         BE    @RT00647                                            0647
         CLC   COUNT(4),@CF00039                                   0647
         BNE   @RF00647                                            0647
@RT00647 DS    0H                                                  0648
*            DO;                       /* TELL USER 'LINE NOT FOUND'. *
*NOLINE:       /* CONTROL COMES HERE TO ISSUE 'LINE NOT FOUND' MSG.   *
*              MSGPTR = 0;             /* ONLY 1 INSERT.              *
NOLINE   SLR   @12,@12                                             0649
         ST    @12,MSGPTR(,COMMREG)                                0649
*              MSGLEN = LNSTARTL + 4;       /* LNG OF INSERT.         *
         L     @08,CAPTPRSD(,COMMREG)                              0650
         LH    @07,LNSTARTL(,@08)                                  0650
         LA    @05,4                                               0650
         ALR   @05,@07                                             0650
         STH   @05,MSGLEN(,COMMREG)                                0650
*              MSGOFF = 22;            /* OFFSET TO INSERT.           *
         MVC   MSGOFF(2,COMMREG),@CH01204                          0651
*              MSGTEXT(1:LNSTARTL) = LNSTART->LINENUM;    /*MSG TEXT. *
         BCTR  @07,0                                               0652
         L     @08,LNSTART(,@08)                                   0652
         EX    @07,@SM01402                                        0652
*              RELMSG1  = 1290;        /* MSG NO.                     *
         MVC   RELMSG1(2),@CH01303                                 0653
*              RELMSG2  = 0;           /* NO 2ND LEVEL.               *
         STH   @12,RELMSG2                                         0654
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERT.              *
         LA    LEV1INS,MSGAREA(,COMMREG)                           0655
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERT.        *
         LR    LEV2INS,@12                                         0656
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     *
         LA    RETCDREG,SENDMSG                                    0657
*              CALL SENDMSG;           /* GOTO ISSUE MESSAGE.         *
         BAL   @14,SENDMSG                                         0658
*              GOTO FNINCMP;           /* INDICATE FUNCTION INCOMPLETE
*                                         AND RETURN TO CALLER.       *
         B     FNINCMP                                             0659
*            END;                      /* USER TOLD.                  *
*          UTCODE = '02'X;             /* SET CODE TO READ NEXT LINE  *
@RF00647 MVI   UTCODE,X'02'                                        0661
*          RETCDREG = ADDR(READRTN);   /* ADDRESS OF ENTRY POINT.     *
         LA    RETCDREG,READRTN                                    0662
*          CALL READRTN;               /* READ NEXT RECORD            *
         BAL   @14,READRTN                                         0663
*          /***********************************************************
*          /* CHECK FOR I/O ERROR IN EDIT DATA SET                    *
*          /***********************************************************
*          IF RETCODE = 8 THEN         /* I/O ERROR ON UTILITY.       *
         CH    RETCODE,@CH00044                                    0664
         BE    @RT00664                                            0664
*            GO TO IOERR;              /* GOTO NOTIFY CALLER.         *
*          /***********************************************************
*          /* CHECK IF RECORD EXISTS(HERE IMPLIES NO LINES IN RANGE)  *
*          /***********************************************************
*          IF RETCODE = 4 THEN         /* NO LINES IN RANGE.          *
         CH    RETCODE,@CH00452                                    0666
         BE    @RT00666                                            0666
*            GOTO NOLINE;              /* GOTO ISSUE MESSAGE.         *
*          ELSE                        /* A RCD WAS FOUND.            *
*            GO TO SCNMORE;            /*GOTO SEE IF SCAN SHOULD CONT.*
         B     SCNMORE                                             0668
*          /* ******************************************************* *
*          /** SEE WHETHER THIS ENTRY FOLLOWS A RETURN CODE 12       **
*          /* ******************************************************* *
*SYNCHK:   /* CONTROL COMES HERE TO PREPARE TO CALL CHECKER.          *
*          IF RC12SW = '1'B THEN       /* R.C. 12 WAS JUST RECEIVED.  *
SYNCHK   TM    RC12SW,B'10000000'                                  0669
         BNO   @RF00669                                            0669
*            ENTRYCD(1:4)='1001'B;           /*SET ENTRY CODE BIT 3.  *
         NI    ENTRYCD(COMMREG),B'10011111'                        0670
         OI    ENTRYCD(COMMREG),B'10010000'                        0670
*          ELSE                        /* NORMAL ENTRY.               *
*            ENTRYCD(1:4)='1000'B;           /*SET NORMAL ENTRY CODE. *
         B     @RC00669                                            0671
@RF00669 NI    ENTRYCD(COMMREG),B'10001111'                        0671
         OI    ENTRYCD(COMMREG),B'10000000'                        0671
*          INCOMP = '1'B;              /* SET BIT TO RETURN RC = 12   *
@RC00669 OI    INCOMP(COMMREG),B'00010000'                         0672
*          /***********************************************************
*          /* CHECK IF DATA SET TYPE IS BASIC OR IPLI                 *
*          /***********************************************************
*          IF CADSCODE = CABASIC × CADSCODE = CAIPLI THEN /* ITF.     *
         CLI   CADSCODE(COMMREG),X'20'                             0673
         BE    @RT00673                                            0673
         CLI   CADSCODE(COMMREG),X'21'                             0673
         BNE   @RF00673                                            0673
@RT00673 DS    0H                                                  0674
*            DO;                       /* SET ITF OPTIONS.            *
*              CODE2(1:5) = '00010'B;     /* IND THAT RCDS HAVE ALREADY
*                                            BEEN TRANSLATED.         *
         NI    CODE2(COMMREG),B'00010111'                          0675
         OI    CODE2(COMMREG),B'00010000'                          0675
*              SCANOPT = '0'B;         /* IND SCAN IN EFFECT.         *
         NI    SCANOPT(COMMREG),B'11111110'                        0676
*            END;                      /* OPTIONS SET.                *
*          /***********************************************************
*          /* ARE WE CONTINUING AFTER A RETURN CODE 12 -              *
*          /***********************************************************
*          IF RC12SW ^= '1'B THEN      /* NOT AFTER R.C. 12.          *
@RF00673 TM    RC12SW,B'10000000'                                  0678
         BO    @RF00678                                            0678
*            DO;                       /* FINISH BUFFER SETUP.        *
*              FORWDPTR = 0;           /* NO CHAINED BUFFERS.         *
         SLR   @12,@12                                             0680
         ICM   @12,7,BUFFPTR                                       0680
         SLR   @07,@07                                             0680
         STCM  @07,7,FORWDPTR(@12)                                 0680
*              BUFFBYTE = '00'X;       /* ZERO HI-ORDER BYTE.         *
         MVI   BUFFBYTE,X'00'                                      0681
*              CASYNBFR = GETBUFF;     /* INITLZ BFR PT IN PARM LIST. *
         L     @12,GETBUFF                                         0682
         ST    @12,CASYNBFR(,COMMREG)                              0682
*              SNSYNBFR = CASYNBFR;    /* SAVE CASYNBFR.              *
         ST    @12,SNSYNBFR                                        0683
*            END;                      /* BUFFER SETUP COMPLETED.     *
*CHKRCALL: /* CONTROL COMES HERE FOR THE ACTUAL CALL OF THE CHECKER.  *
*          PARMREG1 = ADDR(CASYNLST);  /* SET PT TO PARM LIST.        *
@RF00678 DS    0H                                                  0685
CHKRCALL LA    PARMREG1,CASYNLST(,COMMREG)                         0685
*          CALL CHECKER;               /* CALL SYNTX CHECKER          *
         L     @15,CAPTCHK(,COMMREG)                               0686
         BALR  @14,@15                                             0686
*          RETCODE = RETCDREG;         /* SAVE CHECKER RETURN CODE    *
         LR    RETCODE,RETCDREG                                    0687
*          /***********************************************************
*          /* CHECK IF SYNTAX ERROR FOUND - BUFFER CHECKING INCOMPLETE*
*          /***********************************************************
*          IF RETCODE = 8 THEN         /* ERROR.                      *
         CH    RETCODE,@CH00044                                    0688
         BNE   @RF00688                                            0688
*            DO;                       /* BEGIN MSG PROCESSING.       *
*              /* CHECK IF ERROR MSG SENT BY SYNTAX CHECKER -         *
*              IF CASYNMS1 = 0 THEN    /* MSG ALREADY SENT.           *
         SLR   @12,@12                                             0690
         C     @12,CASYNMS1(,COMMREG)                              0690
         BE    @RT00690                                            0690
*                GO TO SKIPMSG8;       /* SKIP FURTHER MSG PROCESSING.*
*              MSGPTR = 0;             /* ONLY 1 INSERTION.           *
         ST    @12,MSGPTR(,COMMREG)                                0692
*              MSGLEN = 76;            /* LNG OF INSERT.              *
         MVC   MSGLEN(2,COMMREG),@CH01311                          0693
*              MSGOFF = 0;             /* OFFSET TO INSERT.           *
         STH   @12,MSGOFF(,COMMREG)                                0694
*              MSGTEXT = SYNMSG1 -> ERRORMSG;/* TEXT OF MESSAGE.      *
         L     @12,SYNMSG1(,COMMREG)                               0695
         MVC   MSGTEXT(72,COMMREG),ERRORMSG(@12)                   0695
*              /* ARE RCDS 'NONUM' -                                  *
*              IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.            *
         TM    CANONUM(COMMREG),B'00000001'                        0696
         BNO   @RF00696                                            0696
*                DO;                   /* FIX LINE NO. IN MSG.        *
*                  PARMREG1 = ADDR(MSGTEXT);/* SET PT TO TEXT.        *
         LA    PARMREG1,MSGTEXT(,COMMREG)                          0698
*                  CALL FIXLINO;       /* GOTO FIXING ROUTINE.        *
         BAL   @14,FIXLINO                                         0699
*                END;                  /* FIXED.                      *
*              RELMSG1  = 1280;        /* MSG NO.                     *
@RF00696 MVC   RELMSG1(2),@CH01312                                 0701
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           *
         SLR   @12,@12                                             0702
         STH   @12,RELMSG2                                         0702
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERTION.           *
         LA    LEV1INS,MSGAREA(,COMMREG)                           0703
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERTION.     *
         LR    LEV2INS,@12                                         0704
*              /* IS THERE A 2ND LEVEL MSG PRESENT -                  *
*              IF CASYNMS2 ^= 0 THEN   /* 2ND LEVEL MSG EXISTS.       *
         C     @12,CASYNMS2(,COMMREG)                              0705
         BE    @RF00705                                            0705
*                DO;                   /* BEGIN 2ND LEVEL SETUP.      *
*                  LEV2PTR = 0;        /* ONLY 1 INSERTION.           *
         ST    @12,LEV2PTR(,COMMREG)                               0707
*                  LEV2LEN = 76;       /* MSG LNG.                    *
         MVC   LEV2LEN(2,COMMREG),@CH01311                         0708
*                  LEV2OFF = 0;        /* OFFSET TO INSERT.           *
         STH   @12,LEV2OFF(,COMMREG)                               0709
*                  LEV2TEXT = SYNMSG2 -> ERRORMSG;/* MSG TEXT.        *
         L     @12,SYNMSG2(,COMMREG)                               0710
         MVC   LEV2TEXT(72,COMMREG),ERRORMSG(@12)                  0710
*                  /* ARE RCDS 'NONUM' -                              *
*                  IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.        *
         TM    CANONUM(COMMREG),B'00000001'                        0711
         BNO   @RF00711                                            0711
*                    DO;               /* FIX LINE NO. IN MSG.        *
*                      PARMREG1 = ADDR(LEV2TEXT);/* SET PT TO TEXT.   *
         LA    PARMREG1,LEV2TEXT(,COMMREG)                         0713
*                      CALL FIXLINO;   /* CALL FIXING ROUTINE.        *
         BAL   @14,FIXLINO                                         0714
*                    END;              /* FIXED.                      *
*                  RELMSG2  = 1;       /* 2ND LEVEL MSG NO.           *
@RF00711 MVC   RELMSG2(2),@CH00039                                 0716
*                  LEV2INS  = ADDR(LEV2MSG);/* PT TO 2ND LEVEL INSERT.*
         LA    LEV2INS,LEV2MSG(,COMMREG)                           0717
*                END;                  /* 2ND LEVEL SETUP DONE.       *
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     *
@RF00705 LA    RETCDREG,SENDMSG                                    0719
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             *
         BAL   @14,SENDMSG                                         0720
*SKIPMSG8: ;   /*******************************************************
SKIPMSG8 DS    0H                                                  0722
*              /* CHECK IF ATTENTION HAS BEEN ISSUED.                 *
*              /*******************************************************
*              IF CAATTNIS = '1'B THEN  /* ATTN HIT.                  *
         TM    CAATTNIS(COMMREG),B'01000000'                       0722
         BO    @RT00722                                            0722
*                GO TO CLEANUP;        /* RETURN TO CALLER.           *
*              CONTCHK = '1'B;         /* IND CONTINUE SCANNING.      *
         OI    CONTCHK(COMMREG),B'01000000'                        0724
*              SYNMSG2 = 0;            /* RESET MSG PT TO 0.          *
         SLR   @12,@12                                             0725
         ST    @12,SYNMSG2(,COMMREG)                               0725
*              GO TO CHKRCALL;         /* RECALL CHECKER.             *
         B     CHKRCALL                                            0726
*            END;                      /* MSG PROCESSING COMPLETE.    *
*          /***********************************************************
*          /* CHECK IF SYNTAX ERROR FOUND - BUFFER CHECKING COMPLETE  *
*          /***********************************************************
*          IF RETCODE = 4 THEN         /* ERROR.                      *
@RF00688 CH    RETCODE,@CH00452                                    0728
         BNE   @RF00728                                            0728
*            DO;                       /* BEGIN MSG PROCESSING.       *
*              /* CHECK IF ERROR MSG SENT BY SYNTAX CHECKER -         *
*              IF CASYNMS1 = 0 THEN    /* MSG ALREADY SENT.           *
         SLR   @12,@12                                             0730
         C     @12,CASYNMS1(,COMMREG)                              0730
         BE    @RT00730                                            0730
*                GO TO CHKATTN;        /* SKIP FURTHER MSG PROCESSING.*
*              MSGPTR = 0;             /* ONLY 1 INSERTION.           *
         ST    @12,MSGPTR(,COMMREG)                                0732
*              MSGLEN = 76;            /* LNG OF INSERT.              *
         MVC   MSGLEN(2,COMMREG),@CH01311                          0733
*              MSGOFF = 0;             /* OFFSET TO INSERT.           *
         STH   @12,MSGOFF(,COMMREG)                                0734
*              MSGTEXT = SYNMSG1 -> ERRORMSG;/* TEXT OF MESSAGE.      *
         L     @12,SYNMSG1(,COMMREG)                               0735
         MVC   MSGTEXT(72,COMMREG),ERRORMSG(@12)                   0735
*              /* ARE RCDS 'NONUM' -                                  *
*              IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.            *
         TM    CANONUM(COMMREG),B'00000001'                        0736
         BNO   @RF00736                                            0736
*                DO;                   /* FIX LINE NO. IN MSG.        *
*                  PARMREG1 = ADDR(MSGTEXT);/* SET PT TO TEXT.        *
         LA    PARMREG1,MSGTEXT(,COMMREG)                          0738
*                  CALL FIXLINO;       /* GOTO FIXING ROUTINE.        *
         BAL   @14,FIXLINO                                         0739
*                END;                  /* FIXED.                      *
*              RELMSG1  = 1280;        /* MSG NO.                     *
@RF00736 MVC   RELMSG1(2),@CH01312                                 0741
*              RELMSG2  = 0;           /* NO 2ND LEVEL MSG.           *
         SLR   @12,@12                                             0742
         STH   @12,RELMSG2                                         0742
*              LEV1INS  = ADDR(MSGAREA);/* PT TO INSERTION.           *
         LA    LEV1INS,MSGAREA(,COMMREG)                           0743
*              LEV2INS  = 0;           /* NO 2ND LEVEL INSERTION.     *
         LR    LEV2INS,@12                                         0744
*              /* IS THERE A 2ND LEVEL MSG PRESENT -                  *
*              IF CASYNMS2 ^= 0 THEN   /* 2ND LEVEL MSG EXISTS.       *
         C     @12,CASYNMS2(,COMMREG)                              0745
         BE    @RF00745                                            0745
*                DO;                   /* BEGIN 2ND LEVEL SETUP.      *
*                  LEV2PTR = 0;        /* ONLY 1 INSERTION.           *
         ST    @12,LEV2PTR(,COMMREG)                               0747
*                  LEV2LEN = 76;       /* MSG LNG.                    *
         MVC   LEV2LEN(2,COMMREG),@CH01311                         0748
*                  LEV2OFF = 0;        /* OFFSET TO INSERT.           *
         STH   @12,LEV2OFF(,COMMREG)                               0749
*                  LEV2TEXT = SYNMSG2 -> ERRORMSG;/* MSG TEXT.        *
         L     @12,SYNMSG2(,COMMREG)                               0750
         MVC   LEV2TEXT(72,COMMREG),ERRORMSG(@12)                  0750
*                  /* ARE RCDS 'NONUM' -                              *
*                  IF CANONUM = '1'B THEN  /* UNNUMBERED RCDS.        *
         TM    CANONUM(COMMREG),B'00000001'                        0751
         BNO   @RF00751                                            0751
*                    DO;               /* FIX LINE NO. IN MSG.        *
*                      PARMREG1 = ADDR(LEV2TEXT);/* SET PT TO TEXT.   *
         LA    PARMREG1,LEV2TEXT(,COMMREG)                         0753
*                      CALL FIXLINO;   /* CALL FIXING ROUTINE.        *
         BAL   @14,FIXLINO                                         0754
*                    END;              /* FIXED.                      *
*                  RELMSG2  = 1;       /* 2ND LEVEL MSG NO.           *
@RF00751 MVC   RELMSG2(2),@CH00039                                 0756
*                  LEV2INS  = ADDR(LEV2MSG);/* PT TO 2ND LEVEL INSERT.*
         LA    LEV2INS,LEV2MSG(,COMMREG)                           0757
*                END;                  /* 2ND LEVEL SETUP DONE.       *
*              RETCDREG = ADDR(SENDMSG);/* SET PT TO MSG ROUTINE.     *
@RF00745 LA    RETCDREG,SENDMSG                                    0759
*              CALL SENDMSG;           /* GOTO ISSUE MSG.             *
         BAL   @14,SENDMSG                                         0760
*              GO TO CHKATTN;          /* TEST ATTN BIT.              *
         B     CHKATTN                                             0761
*            END;                      /* MSG PROCESSING COMPLETE.    *
*          /***********************************************************
*          /* CHECK IF LAST STATEMENT IN BUFFER SENT IS INCOMPLETE    *
*          /***********************************************************
*          IF RETCODE = 12 THEN        /* LAST STMT POTENTIALLY       *
@RF00728 CH    RETCODE,@CH00151                                    0763
         BNE   @RF00763                                            0763
*            DO;                       /* INCOMPLETE.                 *
*              /* DO MORE LINES REMAIN TO BE SYNTAX-CHECKED -         *
*              IF ENDSW = '1'B THEN    /* NO MORE LINES, CALL CHECKER *
         TM    ENDSW,B'01000000'                                   0765
         BNO   @RF00765                                            0765
*                DO;                   /* TO DIAGNOSE LAST STMT.      *
*                  CONTCHK = '0'B;     /* NO FURTHER CHECKING.        *
*                  INCOMPST = '1'B;    /* DIAGNOSE INCOMPLETE STMT.   *
         OI    INCOMPST(COMMREG),B'00010000'                       0768
         NI    CONTCHK(COMMREG),B'10111111'                        0768
*                  GO TO CHKRCALL;     /* GOTO RECALL CHECKER.        *
         B     CHKRCALL                                            0769
*                END;                  /* END OF DIAGNOSIS.           *
*              ELSE                    /* MORE LINES TO CHECK.        *
*                DO;                   /* GET OR CHAIN A NEW BUFFER.  *
@RF00765 DS    0H                                                  0772
*                  TOTALINE = TOTALINE + RECRDNO;/* INCR NO. LL PASSED*
         SLR   @12,@12                                             0772
         ICM   @12,7,BUFFPTR                                       0772
         SLR   @07,@07                                             0772
         IC    @07,RECRDNO(,@12)                                   0772
         ALR   TOTALINE,@07                                        0772
*                  /* IF HI-ORDER BIT OF STMT COUNT IS ON, ADJUST     *
*                  /* TOTALINE TO CORRECT VALUE.                      *
*                  IF FREEBIT = '1'B THEN  /* 'FREEABLE' BIT IS ON.   *
         TM    FREEBIT(@12),B'10000000'                            0773
         BNO   @RF00773                                            0773
*                    TOTALINE = TOTALINE - 128;     /* ADDED TOO MUCH.*
         SH    TOTALINE,@CH01315                                   0774
*                  CALL MOREBFRS;      /* GO GET MORE BUFFER AREA.    *
@RF00773 BAL   @14,MOREBFRS                                        0775
*                  GO TO MOVEREC;      /* GOTO BRING IN MORE RCDS.    *
         B     MOVEREC                                             0776
*                END;                  /* BUFFER HANDLING COMPLETE.   *
*            END;                      /* INCOMPLETE STMT HANDLED.    *
*          /* ******************************************************* *
*          /** CHECK IF SYNTAX CHECKER IS OPERATIONAL.               **
*          /* ******************************************************* *
*          IF RETCODE = 20 THEN        /* INOPERATIVE.                *
@RF00763 CH    RETCODE,@CH00142                                    0779
         BNE   @RF00779                                            0779
*            DO;                       /* SET UP FOR RECOVERY.        *
*              SCRETCD = 16;           /* IND RECOVERY TO BE TRIED.   *
         MVC   SCRETCD(4),@CF00241                                 0781
*              GO TO CLEANUP;          /* RETURN TO CALLER.           *
         B     CLEANUP                                             0782
*            END;                      /* READY FOR RECOVERY.         *
*          /***********************************************************
*          /* CHECK IF ATTENTION HAS BEEN ISSUED                      *
*          /***********************************************************
*CHKATTN:  /* CONTROL COMES HERE TO CHECK FOR ATTN.                   *
*          IF CAATTNIS = '1'B THEN     /* ATTN ISSUED.                *
@RF00779 DS    0H                                                  0784
CHKATTN  TM    CAATTNIS(COMMREG),B'01000000'                       0784
         BO    @RT00784                                            0784
*            GO TO CLEANUP;            /* CLEAN UP AND RETURN.        *
*          /***********************************************************
*          /* CHECK IF MORE LINES TO SYNTAX CHECK                     *
*          /***********************************************************
*          IF ENDSW = '0'B THEN        /* MORE LINES TO BE CHECKED.   *
         TM    ENDSW,B'01000000'                                   0786
         BNZ   @RF00786                                            0786
*            DO;                       /* RESET BUFFER POINTERS.      *
*              TOTALINE = TOTALINE + RECRDNO;/*INCR NO. LINES SENT.   *
         SLR   @12,@12                                             0788
         ICM   @12,7,BUFFPTR                                       0788
         SLR   @07,@07                                             0788
         IC    @07,RECRDNO(,@12)                                   0788
         ALR   TOTALINE,@07                                        0788
*              /* IF HI-ORDER BIT OF STMT COUNT IS ON,ADJUST TOTALINE.*
*              IF FREEBIT = '1'B THEN  /* ADDED 128 TOO MUCH,         *
         TM    FREEBIT(@12),B'10000000'                            0789
         BNO   @RF00789                                            0789
*                TOTALINE = TOTALINE - 128;     /* COMPENSATE FOR IT. *
         SH    TOTALINE,@CH01315                                   0790
*              TOTALINX = TOTALINE;    /* UPDATE LAST NO. LINES SENT. *
@RF00789 ST    TOTALINE,TOTALINX                                   0791
*              /* CHECK IF THIS IS AFTER A R.C. 12.                   *
*              IF RC12SW = '1'B THEN   /* FOLLOWS RET CODE 12.        *
         TM    RC12SW,B'10000000'                                  0792
         BNO   @RF00792                                            0792
*                DO;                   /* RESET POINTERS AND SWITCH.  *
*                  BUFFPTR = FREEAREA(1:4);           /*RESET PT TO 1ST
*                                                       BUFFER GOTTEN.*
         MVC   BUFFPTR(3),FREEAREA+1(COMMREG)                      0794
*                  GETMNLEN = FREELEN(1:4);           /*RESET BFR LNG.*
         MVC   GETMNLEN(4),FREELEN(COMMREG)                        0795
*                  RC12SW = '0'B;      /* R.C. 12 PROCESSING DONE.    *
         NI    RC12SW,B'01111111'                                  0796
*                END;                  /* POINTERS AND SWITCH RESET.  *
*              CURBFPTR = BUFFPTR;     /* SET WORKING PT TO BFR BEGNG.*
@RF00792 SLR   @12,@12                                             0798
         ICM   @12,7,BUFFPTR                                       0798
         LR    CURBFPTR,@12                                        0798
*              ENDBFPTR = BUFFPTR + GETMNLEN;/* SET PT TO END OF BFR. *
         LR    @07,@12                                             0799
         AL    @07,GETMNLEN                                        0799
         STCM  @07,7,ENDBFPTR                                      0799
*              RECRDNO = 0;            /* NO LINES SENT YET.          *
         MVI   RECRDNO(@12),X'00'                                  0800
*              CASYNBFR = BUFFPTR;     /* SET PT TO BFR CHAIN.        *
         ST    @12,CASYNBFR(,COMMREG)                              0801
*              SNSYNBFR = CASYNBFR;    /* SAVE THIS POINTER.          *
         ST    @12,SNSYNBFR                                        0802
*              GO TO MOVEREC;          /* GO BRING RCD INTO BFR.      *
         B     MOVEREC                                             0803
*            END;                      /* BUFFER POINTERS RESET.      *
*CLEANUP:  /***********************************************************
*          /* SCAN COMPETED - CLEAN UP AND EXIT PROCESSING            *
*          /***********************************************************
*          CACURNUM = RECRDKEY;        /* SET NEW CURRENT REF. LINE   *
@RF00786 DS    0H                                                  0805
CLEANUP  MVC   CACURNUM(4,COMMREG),RECRDKEY                        0805
*          SYNMSG2 = 0;                /* RE-INIT MESSAGE PTR TO ZERO.*
         SLR   @12,@12                                             0806
         ST    @12,SYNMSG2(,COMMREG)                               0806
*          BINRYREG = ADDR(FREEAREA);  /* FREEMAIN BUFFER AREAS       *
         LA    BINRYREG,FREEAREA(,COMMREG)                         0807
*          PARMREG0 = ADDR(FREELEN);   /* ADDRESS OF LIST OF LENGTHS. *
         LA    PARMREG0,FREELEN(,COMMREG)                          0808
*          PARMREG1 = ADDR(GETLST);    /* ADDRESS OF PARAMETER LIST.  *
         LA    PARMREG1,GETLST                                     0809
*          /* FREE THE BUFFERS.                                       *
*          GEN (FREEMAIN L,LA=(0),A=(4),SP=1,MF=(E,(1)));          0810
         FREEMAIN L,LA=(0),A=(4),SP=1,MF=(E,(1))
*          /***********************************************************
*          /* CHECK IF 'NOSCAN' SPECIFIED ON EDIT COMMAND             *
*          /***********************************************************
*          IF CASCANON = '0'B THEN     /* SCANNING IS NOT IN EFFECT.  *
         TM    CASCANON(COMMREG),B'00100000'                       0811
         BNZ   @RF00811                                            0811
*            SCANOPT = '1'B;           /* SET NOSCAN OPTION.          *
         OI    SCANOPT(COMMREG),B'00000001'                        0812
*DELTMOD:  /***********************************************************
*          /* CHECK IF SYNTAX CHECKER MODULE MUST BE DELETED          *
*          /***********************************************************
*          IF CASCANSW = '0'B                                      0813
*             & CADSCODE ^= CABASIC                                0813
*             & CADSCODE ^= CAIPLI                                 0813
*             & SCRETCD ^= 16 THEN       /* CHECKER MUST BE DELETED.  *
@RF00811 DS    0H                                                  0813
DELTMOD  TM    CASCANSW(COMMREG),B'00010000'                       0813
         BNZ   @RF00813                                            0813
         CLI   CADSCODE(COMMREG),X'20'                             0813
         BE    @RF00813                                            0813
         CLI   CADSCODE(COMMREG),X'21'                             0813
         BE    @RF00813                                            0813
         CLC   SCRETCD(4),@CF00241                                 0813
         BE    @RF00813                                            0813
*            DO;                       /* PERFORM FINAL ENTRY,DELETE. *
*              LASTENT = '1'B;         /* FINAL ENTRY CODE.           *
         OI    LASTENT(COMMREG),B'00100000'                        0815
*              CASYNBFR = 0;           /* NO SCANNING TO BE DONE.     *
         SLR   @12,@12                                             0816
         ST    @12,CASYNBFR(,COMMREG)                              0816
*              PARMREG1 = ADDR(CASYNLST);/* SET PT TO PARM LIDT.      *
         LA    PARMREG1,CASYNLST(,COMMREG)                         0817
*              RFY (PARMREG0,RETCDREG) RSTD;                       0818
*              RETCDREG = CAPTCHK;     /* SET PT TO CHECKER.          *
         L     @12,CAPTCHK(,COMMREG)                               0819
         LR    RETCDREG,@12                                        0819
*              CALL CHECKER;           /* FINAL ENTRY.                *
         LR    @15,@12                                             0820
         BALR  @14,@15                                             0820
*              PARMREG0 = ADDR(CASYNAME);/* SET PT TO ENTRY NAME.     *
         LA    PARMREG0,CASYNAME(,COMMREG)                         0821
*              /* DELETE THE SYNTAX CHECKER.                          *
*              GEN (DELETE EPLOC=(0));                             0822
         DELETE EPLOC=(0)
*              CAPTCHK = 0;            /* ZERO CHECKER POINTER.       *
         SLR   @14,@14                                             0823
         ST    @14,CAPTCHK(,COMMREG)                               0823
*              RFY (PARMREG0,RETCDREG) UNRSTD;                     0824
*            END;                      /* FINAL ENTRY,DELETION DONE.  *
*SCNEXIT:  /***********************************************************
*          /* CHECK IF IKJPARS CALLED TO SCAN OPERANDS                *
*          /***********************************************************
*          IF CAFREEDL = '0'B THEN     /* PDL EXISTS.                 *
@RF00813 DS    0H                                                  0826
SCNEXIT  TM    CAFREEDL(COMMREG),B'10000000'                       0826
         BNZ   @RF00826                                            0826
*            DO;                       /* FREE PDL.                   *
*              PARMREG1 = ADDR(CAPTPRSD);/* SET PT TO ANSWER PLACE.   *
         LA    PARMREG1,CAPTPRSD(,COMMREG)                         0828
*              CAFREEDL = '1'B;        /* IND PDL FREED.              *
         OI    CAFREEDL(COMMREG),B'10000000'                       0829
*              /* RELEASE THE PARAMETER DESCRIPTOR LIST.              *
*              GEN (IKJRLSA (1));                                  0830
         IKJRLSA (1)
*            END;                      /* PDL NOW FREED.              *
*          /***********************************************************
*          /* CHECK IF VERIFY SWITCH IS ON.                           *
*          /***********************************************************
*          IF CAVRFYSW = '1'B THEN     /* VERIFICATION IN EFFECT      *
@RF00826 TM    CAVRFYSW(COMMREG),B'01000000'                       0832
         BNO   @RF00832                                            0832
*            DO;                       /* PREPARE VERIFY LONE.        *
*              AREAPTR = ADDR(CATEMPBF);/* SET PT TO                  *
         LA    @08,CATEMPBF(,COMMREG)                              0834
         ST    @08,AREAPTR                                         0834
*              AREAPTR = AREAPTR + 12;      /* INPUT BFR.             *
         AH    @08,@CH00151                                        0835
         ST    @08,AREAPTR                                         0835
*              PLISTEND = '1'B;        /* MARK END OF PARM LIST.      *
         OI    PLISTEND,B'10000000'                                0836
*              KEYPTR = ADDR(CACURNUM);/* SET PT TO KEY.              *
         LA    @08,CACURNUM(,COMMREG)                              0837
         ST    @08,KEYPTR                                          0837
*              UTCODE = '00'X;         /* 'READ CURRENT' OPTION.      *
         MVI   UTCODE,X'00'                                        0838
*              RETCDREG = ADDR(READRTN);/* SET PT TO READ ROUTINE.    *
         LA    RETCDREG,READRTN                                    0839
*              CALL READRTN;           /* GOTO READ RCD.              *
         BAL   @14,READRTN                                         0840
*              /* WAS READ SUCCESSFUL -                               *
*              IF RETCODE ^= 0 THEN        /* RCD NOT FOUND.          *
         LTR   RETCODE,RETCODE                                     0841
         BNZ   @RT00841                                            0841
*                GO TO NOSCEXT;        /* RETURN TO CALLER.           *
*              CALNTOVF = '1'B;        /* IND LINE TO BE VERIFIED.    *
         OI    CALNTOVF(COMMREG),B'10000000'                       0843
*            END;                      /* LINE READY FOR VERIFICATION.*
*NOSCEXT:  RETCDREG = SCRETCD;         /* SET RETURN CODE IN REG 15   *
@RF00832 DS    0H                                                  0845
NOSCEXT  L     RETCDREG,SCRETCD                                    0845
*          GOTO RETCNTL;                                           0846
         B     RETCNTL                                             0846
*FNINCMP:  /* CONTROL COMES HERE WHEN THIS MODULE'S FUNCTION CANNOT   *
*          /* BE COMPLETED AND A SPECIAL RETURN CODE MUST BE SET.     *
*                                                                  0847
*          SCRETCD=8;                  /* IND FUNCTION INCOMPLETE.    *
FNINCMP  MVC   SCRETCD(4),@CF00044                                 0847
*          GOTO CLEANUP;               /* GOTO EXIT PROCESSING.       *
         B     CLEANUP                                             0848
*RETCNTL:  RETREG = WHOLPTR;           /* RESTORE RETURN POINT        *
RETCNTL  L     RETREG,WHOLPTR                                      0849
*          RETURN;                                                 0850
@EL00004 DS    0H                                                  0850
@EF00004 DS    0H                                                  0850
@ER00004 BR    @14                                                 0850
*          END WHOLSCAN;                                           0851
*CONVERT:  PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0852
CONVERT  ST    @14,12(,@13)                                        0852
*          /***********************************************************
*          /*                                                         *
*          /* THIS SUBROUTINE CONVERTS THE LINE NUMBER OR COUNT       *
*          /* OPERANDS FROM ZONED DECIMAL TO BINARY.  THE BINARY      *
*          /* VALUE IS RETURNED TO THE CALLER IN REGISTER 4.          *
*          /*                                                         *
*          /***********************************************************
*          GENERATE;                                               0853
         PACK  PACKAREA(8),PACKAREA(8) PACK LINE
*                                      NUMBER OR COINT.
         CVB   BINRYREG,PACKAREA       CONVERT LINE NUM OR COUNT
*                                      TO BINARY
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    *
@EL00005 DS    0H                                                  0854
@EF00005 DS    0H                                                  0854
@ER00005 L     @14,12(,@13)                                        0854
         BR    @14                                                 0854
*          END CONVERT;                /* END OF CONVERSION.          *
*FIXLINO:  PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0856
FIXLINO  ST    @14,12(,@13)                                        0856
*          /***********************************************************
*          /* THIS SUBROUTINE CHANGES THE LINE IDENTIFIER IN A SYNTAX *
*          /* CHECKER ERROR MESSAGE FOR A NON-LINE-NUMBERED DATA SET  *
*          /* TO A TRUE RELATIVE LINE NUMBER.                         *
*          /***********************************************************
*          GENERATE;                                               0857
         PACK  PACKAREA(8),8(8,PARMREG1) PACK
*                                      SEQUENCE NUMBER FROM MSG.
         CVB   BINRYREG,PACKAREA
*        BINRYREG = BINRYREG + TOTALINX;                           0858
         AL    BINRYREG,TOTALINX                                   0858
*        GEN;                                                      0859
         CVD   BINRYREG,PACKAREA
         UNPK  8(8,PARMREG1),PACKAREA(8) UNPACK
*                                      SEQUENCE NUMBER INTO MSG.
         OI    8+8-1(PARMREG1),C'0'
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    *
@EL00006 DS    0H                                                  0860
@EF00006 DS    0H                                                  0860
@ER00006 L     @14,12(,@13)                                        0860
         BR    @14                                                 0860
*          END FIXLINO;                /* END OF CONVERSION.          *
*INITPLST: PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0862
INITPLST ST    @14,12(,@13)                                        0862
*          /***********************************************************
*          /*                                                         *
*          /* THIS SUBROUTINE INITIALIZES THE SYNTAX CHECKER          *
*          /* PARAMETER LIST FOR INITIAL ENTRY.  WORDS TWO AND THREE  *
*          /* OF THE LIST ARE PERMANENTLY INITIALIZED TO POINT TO THE *
*          /* SYNTAX CHECKER WORK AREA AND OPTION WORD.  THE MESSAGE  *
*          /* POINTERS IN THE WORK AREA ARE INITIALIZED TO ZERO AND   *
*          /* THE OPTIONS WORD IS COMPLETELY INITIALIZED FOR THE      *
*          /* SPECIFIED DATA SET TYPE.  WORD ONE OF THE PARAMETER LIST*
*          /* IS INITIALIZED TO ZERO FOR FIRST ENTRY, BUT WILL CHANGE *
*          /* WITH EACH SUBSEQUENT CALL TO THE SYNTAX CHECKER.        *
*          /*                                                         *
*          /***********************************************************
*          /* RESTRICT COMPILER USE OF PTRS TO IKJEBECA AND WORK AREA *
*          /* AND TO PROGRAM BASE REGISTER                            *
*          RESPECIFY(COMMREG,          /* PT TO COMM AREA.            *
*                    BASEREG,          /* PROGRAM BASE REG.           *
*                    DATAREG) RSTD;    /* WORKAREA BASE REG.          *
*          CASYNBFR = 0;               /* ZERO BUFFER POINTER.        *
         SLR   @12,@12                                             0864
         ST    @12,CASYNBFR(,COMMREG)                              0864
*          CASYNPWA = ADDR(CASYNWA);   /* INIT PTR TO WORK AREA       *
         LA    @08,CASYNWA(,COMMREG)                               0865
         ST    @08,CASYNPWA(,COMMREG)                              0865
*          CASYNPTO = ADDR(CASYNOPT);  /* INIT PTR TO OPTION WORD     *
         LA    @08,CASYNOPT(,COMMREG)                              0866
         ST    @08,CASYNPTO(,COMMREG)                              0866
*          BYTE = '80'X;               /* MARK END OF PARM LIST.      *
         MVI   BYTE(COMMREG),X'80'                                 0867
*          FIRSTENT = '0'B;            /* MARK AS FIRST ENTRY         *
*          CONTCHK = '0'B;             /* SET FOR NO CONTINUE CHECKING*
*          LASTENT = '0'B;             /* MARK AS NOT LAST ENTRY      *
         NI    FIRSTENT(COMMREG),B'00011111'                       0870
*          CASYNMS1 = 0;               /* ZERO 1ST LEVEL MESSAGE PTR. *
         ST    @12,CASYNMS1(,COMMREG)                              0871
*          CASYNMS2 = 0;               /* ZERO 2ND LEVEL MESSAGE PTR. *
         ST    @12,CASYNMS2(,COMMREG)                              0872
*          CODE1AN2 = CACHKOPT;        /* SET DATA-SET-TYPE-DEPENDENT
*                                         VALUES IN OPT WORD.   A45714*
         MVC   CODE1AN2(2,COMMREG),CACHKOPT(COMMREG)               0873
*          /***********************************************************
*          /* CHECK IF LOGICAL RECORD LENGTH FIXED                    *
*          /***********************************************************
*          IF CARECFM = '1'B THEN      /* RECFM = F.                  *
         TM    CARECFM(COMMREG),B'01000000'                        0874
         BNO   @RF00874                                            0874
*            DO;                       /* IND LRECL,RECFM IN OPT. WD. *
*              RECORDLN = CALRECL - 4;       /* SUBTRACT CNTL WD LNG. *
         LH    @12,CALRECL(,COMMREG)                               0876
         SH    @12,@CH00452                                        0876
         STC   @12,RECORDLN(,COMMREG)                              0876
*              RECLN = '0'B;           /* FIXED LNG OPTION.           *
         NI    RECLN(COMMREG),B'11110111'                          0877
*            END;                      /* LRECL,RECFM SET.            *
*          ELSE                        /* RECFM = V.                  *
*            DO;                       /* IND RECFM IN OPTION WORD.   *
         B     @RC00874                                            0879
@RF00874 DS    0H                                                  0880
*              RECORDLN = '00'X;       /* NO LRECL SPECIFIED(VAR LNG).*
         MVI   RECORDLN(COMMREG),X'00'                             0880
*              RECLN = '1'B;           /* VARIABLE LNG OPTION.        *
         OI    RECLN(COMMREG),B'00001000'                          0881
*            END;                      /* RECFM SET.                  *
*          /****************************************************A45714*
*          /* CHECK IF 'CHAR48' WAS SPECIFIED ON THE EDIT CMD.  A45714*
*          /****************************************************A45714*
*          IF CACHAR48 = '1'B THEN     /* 'CHAR48' SPECIFIED.   A45714*
@RC00874 TM    CACHAR48(COMMREG),B'01000000'                       0883
         BNO   @RF00883                                            0883
*            CHAR4860 = '1'B;          /* SET SWITCH IN OPTION WORD TO
*                                         INDICATE 'CHAR48'.    A45714*
         OI    CHAR4860(COMMREG),B'10000000'                       0884
*          /***********************************************************
*          /* CHECK IF DATA SET IS LINE NUMBERED                      *
*          /***********************************************************
*          IF CANONUM = '1'B THEN      /* NONUM DATA.                 *
@RF00883 TM    CANONUM(COMMREG),B'00000001'                        0885
         BNO   @RF00885                                            0885
*            LNUM = '1'B;              /* SET NONUM OPTION.           *
         OI    LNUM(COMMREG),B'01000000'                           0886
*          ELSE                        /* NUM DATA.                   *
*            LNUM = '0'B;              /* SET NUM OPTION.             *
         B     @RC00885                                            0887
@RF00885 NI    LNUM(COMMREG),B'10111111'                           0887
*          INCOMP = '1'B;              /* SET BIT FOR CHECKER TO RETURN
*                                         WITH RC=12 IF LAST STATEMENT
*                                         IN BUFFER INCOMPLETE        *
@RC00885 OI    INCOMP(COMMREG),B'00010000'                         0888
*          /***********************************************************
*          /* CHECK IF 'FREE' SPECIFIED ON EDIT COMMAND               *
*          /***********************************************************
*          IF CAFREE = '1'B THEN       /* FREE-FORM SOURCE.           *
         TM    CAFREE(COMMREG),B'10000000'                         0889
         BNO   @RF00889                                            0889
*            RECFORM = '1'B;           /* SET FREE OPTION.            *
         OI    RECFORM(COMMREG),B'00000100'                        0890
*          ELSE                        /* STANDARD FORM SOURCE.       *
*            RECFORM = '0'B;           /* SET FIXED OPTION.           *
         B     @RC00889                                            0891
@RF00889 NI    RECFORM(COMMREG),B'11111011'                        0891
*          MSGLN = '1'B;               /* SET BIT FOR SHORT MESSAGES  *
@RC00889 OI    MSGLN(COMMREG),B'00000010'                          0892
*          /***********************************************************
*          /* CHECK IF 'NOSCAN' SPECIFIED ON EDIT COMMAND             *
*          /***********************************************************
*          IF CASCANON = '0'B THEN     /* SCANNING NOT IN EFFECT.     *
         TM    CASCANON(COMMREG),B'00100000'                       0893
         BNZ   @RF00893                                            0893
*            SCANOPT = '1'B;           /* SET NOSCAN OPTION.          *
         OI    SCANOPT(COMMREG),B'00000001'                        0894
*          ELSE                        /* SCANNING IS IN EFFECT.      *
*            SCANOPT = '0'B;           /* SET SCAN OPTION.            *
         B     @RC00893                                            0895
@RF00893 NI    SCANOPT(COMMREG),B'11111110'                        0895
*          RETURN;                     /* GO BACK TO MAIN PROGRAM.    *
@EL00007 DS    0H                                                  0896
@EF00007 DS    0H                                                  0896
@ER00007 L     @14,12(,@13)                                        0896
         BR    @14                                                 0896
*          END INITPLST;               /* END OF INITIAL PLIST SETUP. *
         B     @EL00007                                            0897
*MOREBFRS: PROC OPTIONS(NOSAVEAREA,SAVE(14));                      0898
MOREBFRS ST    @14,12(,@13)                                        0898
*          /***********************************************************
*          /**      THIS SUBROUTINE IS ENTERED WHEN LINES REMAIN TO  **
*          /** BE SCANNED AFTER RET CODE 12 IS RETURNED BY A SYNTAX  **
*          /** CHECKER, TO ADD A BUFFER TO THE EXISTING CHAIN OR TO  **
*          /** FORM A NEW BUFFER CHAIN.                              **
*          /** THE PROCEDURE -                                       **
*          /**      MOVE THE BUFFER POINTER ALONG THE CHAIN UNTIL    **
*          /** THE FIRST NON-FREEABLE BUFFER IS ENCOUNTERED, OR, IF  **
*          /** THE WHOLE CHAIN IS FREEABLE, TO THE LAST BUFFER IN    **
*          /** THE CHAIN.  IF THE WHOLE CHAIN WAS FREEABLE RESET THE **
*          /** CURRENT BUFFER POINTER TO THE BEGINNING OF THE LAST   **
*          /** BUFFER, SET T0 ZERO THE NO. OF LINES IN THE BUFFER,   **
*          /** SET THE SWITCH INDICATING RECOVERY FROM RET CODE 12,  **
*          /** AND RETURN.                                           **
*          /**      IF THE WHOLE CHAIN WAS NOT FREEABLE, SEARCH      **
*          /** AMONGST THE BUFFERS GOTTEN SO FAR FOR A FREEABLE      **
*          /** BUFFER.  IF NONE IS FOUND GETMAIN A NEW ONE AND ADD   **
*          /** ITS ADDRESS & LENGTH TO THE APPROPRIATE LISTS.        **
*          /**      ONCE A BUFFER IS FOUND OR OBTAINED, TURN OFF ITS **
*          /** FREEABLE BIT, SET NO. OF LINES IN IT TO ZERO, ZERO    **
*          /** ITS FORWARD POINTER, ADD IT TO THE END OF THE EXIST-  **
*          /** ING CHAIN, UPDATE WORKING BUFFER POINTERS, INDICATE   **
*          /** RETURN CODE 12 RECOVERY, AND RETURN.                  **
*          /* ******************************************************* *
*          RESPECIFY(COMMREG,          /* PT TO COMM AREA.            *
*                    BASEREG,          /* PROGRAM BASE REG.           *
*                    BASEREG2,         /* PROGRAM 2ND BASE REGISTER   *
*                    DATAREG) RSTD;    /* WORKAREA BASE REG.          *
*          /* ******************************************************* *
*          /** SEE IF CASYNBFR POINTS TO A FREEABLE BUFFER.          **
*          /* ******************************************************* *
*          CASYNBFR = SNSYNBFR;        /* RESTORE CASYNBFR.     A50469*
         MVC   CASYNBFR(4,COMMREG),SNSYNBFR                        0900
*          /* THEN PERFORM THE TEST.                                  *
*CUTLINKS: IF CASYNBFR->FREEBIT='1'B THEN  /* BFR REUSABLE.     A50469*
CUTLINKS L     @12,CASYNBFR(,COMMREG)                              0901
         TM    FREEBIT(@12),B'10000000'                            0901
         BNO   @RF00901                                            0901
*            DO;                       /* RESET PT TO BUFFER CHAIN TO
*                                         NEAREST NON-FREEABLE BFR OR
*                                         TO END OF CHAIN.            *
*              TEMPTR=CASYNBFR->FORWDPTR;/* GET FORWARD PT FR CURR BFR*
         MVC   TEMPTR(3),FORWDPTR(@12)                             0903
*              TEMPBYTE='00'X;         /* ZERO HI-ORDER BYTE.         *
         MVI   TEMPBYTE,X'00'                                      0904
*              /* SEE IF END-OF-CHAIN HAS BEEN REACHED.               *
*              IF TEMPWORD='00000000'X THEN/*                      0905
*                                           END OF CHAIN.             *
         CLC   TEMPWORD(4),@CB01340                                0905
         BNE   @RF00905                                            0905
*                DO;                   /* REUSE THIS BUFFER,          *
*                  CURBFPTR=CASYNBFR;  /* RESET CURR BFR PT.          *
         LR    CURBFPTR,@12                                        0907
*                  RECRDNO=0;          /* NO LINES IN BUFFER YET.     *
         SLR   @12,@12                                             0908
         ICM   @12,7,BUFFPTR                                       0908
         MVI   RECRDNO(@12),X'00'                                  0908
*                  GO TO RECOVER1;     /* GO TO CONTINUE.             *
         B     RECOVER1                                            0909
*                END;                  /* BUFFER REUSED.              *
*              ELSE                    /* THERE ARE MORE BFRS IN CHAIN*
*                DO;                   /* TRY NEXT BUFFER.            *
@RF00905 DS    0H                                                  0912
*                  CASYNBFR=CASYNBFR->FORWDPTR;/* ADVANCE POINTER.    *
         L     @12,CASYNBFR(,COMMREG)                              0912
         SLR   @07,@07                                             0912
         ICM   @07,7,FORWDPTR(@12)                                 0912
         ST    @07,CASYNBFR(,COMMREG)                              0912
*                  TEMPWORD=CASYNBFR;  /* ZERO                        *
         ST    @07,TEMPWORD                                        0913
*                  TEMPBYTE='00'X;     /*  HI-ORDER                   *
         MVI   TEMPBYTE,X'00'                                      0914
*                  CASYNBFR=TEMPWORD;  /*   BYTE.                     *
         MVC   CASYNBFR(4,COMMREG),TEMPWORD                        0915
*                  GO TO CUTLINKS;     /* LOOP TO TEST NEXT 'FREE' BIT*
         B     CUTLINKS                                            0916
*                END;                  /* NEXT BFR TRIED.             *
*            END;                      /* PT TO BFR CHAIN NOW RESET.  *
*          ELSE;                       /* BUFFER NOT REUSABLE. FALL
*                                         THRU TO FIND A FREE BUFFER. *
@RF00901 DS    0H                                                  0920
*          TEMPTR='00000000'X;         /* INITLZ SUBSCRIPT TO ZERO.   *
         SLR   @12,@12                                             0920
         STCM  @12,7,TEMPTR                                        0920
*CHAINTRY: /* CONTROL LOOPS BACK TO HERE DURING SEARCH FOR A FREE BFR.*
*          FORWDPTR=FREEAREA(TEMPTR+2:TEMPTR+4);           /*TRY A BFR*
CHAINTRY SLR   @12,@12                                             0921
         ICM   @12,7,BUFFPTR                                       0921
         SLR   @07,@07                                             0921
         ICM   @07,7,TEMPTR                                        0921
         L     @07,FREEAREA(@07,COMMREG)                           0921
         LA    @07,0(,@07)                                         0921
         STCM  @07,7,FORWDPTR(@12)                                 0921
*          /* ******************************************************* *
*          /** SEE IF THIS BUFFER IS FREE TO BE USED.                **
*          /* ******************************************************* *
*          IF FORWDPTR->FREEBIT='1'B THEN  /* THIS BFR IS FREE.       *
         TM    FREEBIT(@07),B'10000000'                            0922
         BO    @RT00922                                            0922
*            GO TO FOUNDONE;           /* GO TO ADD IT TO CHAIN.      *
*          ELSE                        /* THIS BFR IS NOT FREE.       *
*FLAGTEST:   /* SEE IF END OF LIST OF BFRS HAS BEEN REACHED.          *
*            IF FREELEN(TEMPTR+1)>='80'X THEN        /* END OF LIST.  *
FLAGTEST SLR   @12,@12                                             0924
         ICM   @12,7,TEMPTR                                        0924
         ALR   @12,COMMREG                                         0924
         CLI   FREELEN(@12),X'80'                                  0924
         BNL   @RT00924                                            0924
*              GO TO GETNEW;           /* MUST OBTAIN A NEW BFR.      *
*            ELSE                      /* LIST NOT YET EXHAUSTED.     *
*              DO;                     /* MOVE ON TO NEXT BFR IN LIST.*
*                TEMPTR=TEMPTR+4;       /* BUMP PT BY A WORD.        .*
         SLR   @12,@12                                             0927
         ICM   @12,7,TEMPTR                                        0927
         AH    @12,@CH00452                                        0927
         STCM  @12,7,TEMPTR                                        0927
*                GO TO CHAINTRY;       /* GO SEE IF NEXT BFR IS FREE. *
         B     CHAINTRY                                            0928
*              END;                    /* NEXT BFR TRIED.             *
*FOUNDONE: /* CONTROL COMES HERE WHEN A BFR IS FOUND TO ADD TO CHAIN. *
*          FORWDPTR->RECRDNO=0;        /* NO LINES IN BFR YET (THIS
*                                         ALSO TURNS OFF FREEABLE BIT.*
FOUNDONE SLR   @12,@12                                             0930
         ICM   @12,7,BUFFPTR                                       0930
         SLR   @07,@07                                             0930
         ICM   @07,7,FORWDPTR(@12)                                 0930
         MVI   RECRDNO(@07),X'00'                                  0930
*          FORWDPTR->FORWDPTR='00000000'X;/*                       0931
*                                         IND END-OF-CHAIN.           *
         SLR   @12,@12                                             0931
         STCM  @12,7,FORWDPTR(@07)                                 0931
*          GETBUFF=FORWDPTR;           /* UPDATE CURR BFR POINTER.    *
         ST    @07,GETBUFF                                         0932
*          CURBFPTR=BUFFPTR;           /* SET PT TO BEGNG OF BFR.     *
         SLR   CURBFPTR,CURBFPTR                                   0933
         ICM   CURBFPTR,7,BUFFPTR                                  0933
*          ENDBFPTR=CURBFPTR+FREELEN(TEMPTR+2:TEMPTR+4);           0934
         SLR   @12,@12                                             0934
         ICM   @12,7,TEMPTR                                        0934
         LR    @07,CURBFPTR                                        0934
         L     @12,FREELEN(@12,COMMREG)                            0934
         LA    @12,0(,@12)                                         0934
         ALR   @07,@12                                             0934
         STCM  @07,7,ENDBFPTR                                      0934
*          GO TO RECOVER1;             /* GO TO CONTINUE.             *
         B     RECOVER1                                            0935
*GETNEW:   /* CONTROL COMES HERE WHEN A NEW BUFFER MUST BE OBTAINED.  *
*          FREELNPT->HIORDBIT='0'B;    /* ERASE OLD END-OF-LIST MARKER*
GETNEW   SLR   @12,@12                                             0936
         ICM   @12,7,FREELNPT                                      0936
         NI    HIORDBIT(@12),B'01111111'                           0936
*          FREELNPT=FREELNPT+4;        /* ADD A WORD TO END OF LIST.  *
         LA    @07,4                                               0937
         ALR   @12,@07                                             0937
         STCM  @12,7,FREELNPT                                      0937
*          FREEPTR=FREEPTR+4;          /* ADD A WORD TO END OF LIST.  *
         SLR   @12,@12                                             0938
         ICM   @12,7,FREEPTR                                       0938
         ALR   @07,@12                                             0938
         STCM  @07,7,FREEPTR                                       0938
*          GETMNLO=260;                /* MINIMUM BFR AREA FOR SCAN.  *
         MVC   GETMNLO(4),@CF00296                                 0939
*          GETMNHI=4096;               /* MAXIMUM BFR AREA FOR SCAN.  *
         MVC   GETMNHI(4),@CF01350                                 0940
*          LOAMTPTR=ADDR(GETMNLO);     /* SET PT TO SIZE REQUEST.     *
         LA    @12,GETMNLO                                         0941
         ST    @12,LOAMTPTR                                        0941
*          LOCTNPTR=ADDR(GETBUFF);     /* SET PT TO ADDRESS PLACE.    *
         LA    @12,GETBUFF                                         0942
         ST    @12,LOCTNPTR                                        0942
*          TEMPTR=BUFFPTR;             /* SAVE BUFFER POINTER.        *
         MVC   TEMPTR(3),BUFFPTR                                   0943
*          SUBPOOL=1;                  /* SUBPOOL REQUEST.            *
         MVI   SUBPOOL,X'01'                                       0944
*           DO; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF(
*,GETLST) RTCD(RETCDREG)*/                                         0945
*           RESPECIFY (GPR01P,GPR15F) RESTRICTED;                  0946
*           GETLST04 = 'E0'X; /* TYPE */                           0947
         MVI   GETLST04,X'E0'                                      0947
*           GETLST03 = ADDR(GETBUFF); /* ADDR OF ADDR LIST */      0948
         LA    @14,GETBUFF                                         0948
         STCM  @14,7,GETLST03                                      0948
*           GETLST05 = SUBPOOL; /* SUBPOOL VALUE */                0949
         MVC   GETLST05(1),SUBPOOL                                 0949
*           GPR01P = ADDR(GETLST); /* REG1 POINTS TO LIST */       0950
         LA    GPR01P,GETLST                                       0950
*           SVC(4);/* STANDARD-FORM OF GETMAIN*/                   0951
         SVC   4                                                   0951
*           RETCDREG = GPR15F; /* SET RETURN CODE */               0952
*           RESPECIFY (GPR01P,GPR15F) UNRESTRICTED;                0953
*           END; /*GETMAIN (VC)  LV(GETMNLEN) A(GETBUFF) SP(SUBPOOL) MF
*E,GETLST) RTCD(RETCDREG)*/                                        0954
*          RETCODE=RETCDREG;           /* SAVE RET CODE.              *
         LR    RETCODE,RETCDREG                                    0955
*          /* CHECK IF AREA OBTAINED.                                 *
*          IF RETCODE=4 THEN           /* CORE NOT GOTTEN.            *
         LA    @07,4                                               0956
         CR    RETCODE,@07                                         0956
         BNE   @RF00956                                            0956
*            DO;                       /* RESTORE LIST.               *
*              FREELNPT=FREELNPT-4;       /* REMOVE LAST WORD.        *
         LCR   @07,@07                                             0958
         SLR   @12,@12                                             0958
         ICM   @12,7,FREELNPT                                      0958
         ALR   @07,@12                                             0958
         STCM  @07,7,FREELNPT                                      0958
*              FREELNPT->HIORDBIT='1'B; /* MARK END OF LIST.          *
         OI    HIORDBIT(@07),B'10000000'                           0959
*              RETURN TO NOCORE;       /* GO TO ISSUE MSG.            *
         LA    @14,NOCORE                                          0960
         BR    @14                                                 0960
*            END;                      /* LIST RESTORED.              *
*          ELSE;                       /* CORE GOTTEN.                *
@RF00956 DS    0H                                                  0963
*          TEMPTR->FORWDPTR=BUFFPTR;   /* ADD NEW BFR TO CHAIN.       *
         SLR   @12,@12                                             0963
         ICM   @12,7,BUFFPTR                                       0963
         SLR   @07,@07                                             0963
         ICM   @07,7,TEMPTR                                        0963
         STCM  @12,7,FORWDPTR(@07)                                 0963
*          CURBFPTR=BUFFPTR;           /* UPDATE PT TO CURR BFR.      *
         LR    CURBFPTR,@12                                        0964
*          RECRDNO=0;                  /* NO LINES IN BFR YET.        *
         MVI   RECRDNO(@12),X'00'                                  0965
*          FORWDPTR='00000000'X;       /* IND END OF CHAIN.           *
         SLR   @07,@07                                             0966
         STCM  @07,7,FORWDPTR(@12)                                 0966
*          ENDBFPTR=BUFFPTR+GETMNLEN;  /* SET PT TO END OF BFR.       *
         L     @07,GETMNLEN                                        0967
         ALR   @12,@07                                             0967
         STCM  @12,7,ENDBFPTR                                      0967
*          FREEPTR->AREA=GETBUFF;      /* ADD ADDRESS AND LNG OF NEW  *
         SLR   @12,@12                                             0968
         ICM   @12,7,FREEPTR                                       0968
         MVC   AREA(4,@12),GETBUFF                                 0968
*          FREELNPT->AREA=GETMNLEN;    /*  BFR TO LISTS.              *
         SLR   @12,@12                                             0969
         ICM   @12,7,FREELNPT                                      0969
         ST    @07,AREA(,@12)                                      0969
*          FREELNPT->HIORDBIT='1'B;    /* MARK END OF LIST.           *
         OI    HIORDBIT(@12),B'10000000'                           0970
*RECOVER1: /* CONTROL COMES HERE JUST BEFORE CONTINUING AFTER R.C. 12.*
*          RC12SW='1'B;                /* IND R.C. 12 WAS ISSUED.     *
RECOVER1 OI    RC12SW,B'10000000'                                  0971
*          RETURN;                     /* CONTINUE CHECKING.          *
@EL00008 DS    0H                                                  0972
@EF00008 DS    0H                                                  0972
@ER00008 L     @14,12(,@13)                                        0972
         BR    @14                                                 0972
*          END MOREBFRS;               /* RETURN TO CALLING POINT.    *
*READRTN:  PROC OPTIONS(NOSAVEAREA,NOSAVE);                        0974
READRTN  DS    0H                                                  0975
*          /***********************************************************
*          /*                                                         *
*          /* THIS SUBROUTINE PERFORMS ALL THE READ OPERATIONS FROM   *
*          /* THE EDIT DATA SET.   THE IKJEBESH MACRO IS USED TO CALL *
*          /* IKJEBEUT(EDIT ACCESS METHOD INTERFACE) VIA THE SERVICE  *
*          /* ROUTINE HANDLER.  THE PARAMETER LIST PASSED TO IKJEBEUT *
*          /* IS INITIATIZED BY THE CALLER AND THE RETURN CODE FROM   *
*          /* IKJEBEUT IS SAVED IN AREA RETCODE.                      *
*          /*                                                         *
*          /***********************************************************
*          READPTR = RETREG;           /* SAVE RETURN POINT ADDRESS   *
         LR    READPTR,RETREG                                      0975
*          GENERATE;                                               0976
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),UTPLIST),        X
               MF=(E,SRPLIST)
*          RETCODE = RETCDREG;         /* PRESERVE RETURN CODE.       *
         LR    RETCODE,RETCDREG                                    0977
*          RETREG = READPTR;           /* RESTORE RETURN POINT ADDRESS*
         LR    RETREG,READPTR                                      0978
*          RETURN;                     /* RETURN TO CALLER            *
@EL00009 DS    0H                                                  0979
@EF00009 DS    0H                                                  0979
@ER00009 BR    @14                                                 0979
*          END READRTN;                /* END OF IKJEBEUT INVOKATION. *
*                                                                  0980
*                                                                  0980
*           DECLARE /*GENERAL PURPOSE REGISTERS */                 0981
*             GPR15F FIXED(31) REG(15),                            0981
*             GPR00P PTR(31) REG(0),                               0981
*             GPR01P PTR(31) REG(1),                               0981
*             GPR02P PTR(31) REG(2),                               0981
*             GPR03P PTR(31) REG(3),                               0981
*             GPR04P PTR(31) REG(4),                               0981
*             GPR05P PTR(31) REG(5),                               0981
*             GPR06P PTR(31) REG(6),                               0981
*             GPR07P PTR(31) REG(7),                               0981
*             GPR08P PTR(31) REG(8),                               0981
*             GPR09P PTR(31) REG(9),                               0981
*             GPR12P PTR(31) REG(12),                              0981
*             GPR13P PTR(31) REG(13),                              0981
*             GPR14P PTR(31) REG(14),                              0981
*             GPR15P PTR(31) REG(15);                              0981
*                                                                  0981
*           /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */         0982
*             DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBE
*V*/          DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COM
*O AREA*/     DECLARE DATAREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT S
*BCOMMAND WORK AREA*/                                              0982
*             DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/
*                                                                  0985
*           DECLARE /* COMMON VARIABLES */                         0986
*             I256C CHAR(256) BASED,                               0986
*             I031F FIXED(31) BASED,                               0986
*             I031P PTR(31)   BASED,                               0986
*             I015F FIXED(15) BASED,                               0986
*             I015P PTR(15)   BASED,                               0986
*             I008P PTR(8)    BASED,                               0986
*             I001C CHAR(1)   BASED;                               0986
*          END IKJEBESC                                            0987
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        *
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        *
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*;                                                                 0987
@DATA    DS    0H
@CH00088 DC    H'2'
@CH00452 DC    H'4'
@CH00138 DC    H'5'
@CH01286 DC    H'9'
@CH00387 DC    H'10'
@CH00142 DC    H'20'
@CH01204 DC    H'22'
@CH01192 DC    H'23'
@CH01258 DC    H'29'
@CH01206 DC    H'45'
@CH01311 DC    H'76'
@CH01315 DC    H'128'
@CH01207 DC    H'270'
@CH01202 DC    H'271'
@CH01312 DC    H'1280'
@CH01281 DC    H'1287'
@CH01235 DC    H'1288'
@CH01288 DC    H'1289'
@CH01303 DC    H'1290'
@CH01243 DC    H'1792'
@CH01194 DC    H'1796'
@CH01257 DC    H'1797'
@CH01238 DC    H'1801'
@SM01386 MVC   RECORD(0,COMMREG),UTBUFFER+4(COMMREG)
@SM01388 MVC   RECORD(0,COMMREG),LINE(COMMREG)
@SM01393 MVC   0(0,@12),LINENUM(@07)
@SM01395 MVC   0(0,@05),LINENUM(@12)
@SM01397 MVC   RECRD(0,CURBFPTR),LINE(COMMREG)
@SM01399 MVC   RECRD(0,CURBFPTR),LL(COMMREG)
@SM01402 MVC   MSGTEXT(0,COMMREG),LINENUM(@08)
@DATD    DSECT
         DS    0F
IKJEBESC CSECT
         DS    0F
@CF00039 DC    F'1'
@CH00039 EQU   @CF00039+2
@CF00044 DC    F'8'
@CH00044 EQU   @CF00044+2
@CF00151 DC    F'12'
@CH00151 EQU   @CF00151+2
@CF00241 DC    F'16'
@CH00241 EQU   @CF00241+2
@CF00296 DC    F'260'
@CF01268 DC    F'2048'
@CF01350 DC    F'4096'
@CF01282 DC    XL4'7FFFFFFF'
@DATD    DSECT
         DS    0D
SNSYNBFR DS    A
CHKPTR   DS    A
WHOLPTR  DS    A
SCRETCD  DS    F
RECRDKEY DS    F
TOTALINX DS    F
LNUMBER1 DS    F
LNUMBER2 DS    F
COUNT    DS    F
MSGPTR2  DS    A
PARSEPTR DS    A
         DS    CL1
ENDBFPTR DS    AL3
         DS    CL1
FREEPTR  DS    AL3
         DS    CL1
FREELNPT DS    AL3
TEMPCOD2 DS    AL1
         DS    CL3
GETLST   DS    CL10
         ORG   GETLST
GETLST01 DS    AL4
GETLST02 DS    CL1
GETLST03 DS    AL3
GETLST04 DS    CL1
GETLST05 DS    AL1
         ORG   GETLST+10
         DS    CL2
PACKAREA DS    CL8
UTPLIST  DS    CL12
         ORG   UTPLIST
UTCODE   DS    CL1
DCBPTR   DS    AL3
KEYPTR   DS    AL4
AREAPTR  DS    AL4
         ORG   AREAPTR
PLISTEND DS    BL1
         ORG   UTPLIST+12
SRPLIST  DS    CL40
         ORG   SRPLIST
RELMSG1  DS    FL2
RELMSG2  DS    FL2
SRPLIST2 DS    CL36
         ORG   SRPLIST+40
@NM00023 DS    CL8
         ORG   @NM00023
GETMNLO  DS    FL4
GETMNHI  DS    FL4
         ORG   @NM00023+8
@NM00024 DS    CL8
         ORG   @NM00024
GETBUFF  DS    AL4
         ORG   GETBUFF
BUFFBYTE DS    CL1
BUFFPTR  DS    AL3
         ORG   @NM00024+4
GETMNLEN DS    FL4
         ORG   @NM00024+8
GETMNLST DS    CL10
         ORG   GETMNLST
LOAMTPTR DS    AL4
LOCTNPTR DS    AL4
GETMNCD  DS    CL1
SUBPOOL  DS    AL1
         ORG   GETMNLST+10
         DS    CL2
TEMPWORD DS    CL4
         ORG   TEMPWORD
TEMPBYTE DS    CL1
TEMPTR   DS    AL3
         ORG   TEMPWORD+4
@NM00025 DS    CL1
         ORG   @NM00025
RC12SW   DS    BL1
ENDSW    EQU   @NM00025+0
         ORG   @NM00025+1
MSGTEXT2 DS    CL4
         DS    CL3
XCTLLIST DS    CL8
IKJEBESC CSECT
         NOPR  ((@ENDDATD-@DATD)/673*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00525 DC    V(IKJEBSC1)
         DS    0D
@CC01285 DC    C'00000000'
@CC01203 DC    C'PARSE'
@CC01193 DC    C'SCAN'
@CC01205 DC    C'12'
@CB01218 DC    X'FFFFFFFFFFFFFFFF'
@CB01255 DC    X'0000000000000000'
@CB01340 EQU   @CB01255
SCPARSNM DC    CL8'IKJPARS '
IKJEBESC CSECT
IKJEBSC1 IKJPARM
LINENUMB IKJIDENT 'LINE NUMBER',ASTERISK,MAXLNTH=8,FIRST=NUMERIC,      X
               OTHER=NUMERIC
LINECT   IKJIDENT 'LINE NUMBER OR COUNT',MAXLNTH=8,FIRST=NUMERIC,      X
               OTHER=NUMERIC
KEYWORD  IKJKEYWD
         IKJNAME 'ON'
         IKJNAME 'OFF'
         IKJENDP
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEBESC CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGOFF2  EQU   @05
MSGLEN2  EQU   @05
TOTALINE EQU   @08
RETCODE  EQU   @12
SENDPTR  EQU   @12
READPTR  EQU   @03
LKLIBPTR EQU   @08
PPLPTR   EQU   @05
CURBFPTR EQU   @02
I        EQU   @05
BASEREG2 EQU   @06
PARMREG0 EQU   @00
PARMREG1 EQU   @01
BINRYREG EQU   @04
BASEREG  EQU   @11
LEV1INS  EQU   @02
LEV2INS  EQU   @03
RETREG   EQU   @14
RETCDREG EQU   @15
COMMREG  EQU   @09
GPR13P   EQU   @13
GPR15P   EQU   @15
DATAREG  EQU   @10
GPR01P   EQU   @01
GPR12P   EQU   @12
GPR15F   EQU   @15
GPR00P   EQU   @00
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR08P   EQU   @08
GPR09P   EQU   @09
GPR14P   EQU   @14
SAVEREG  EQU   @13
CVTPTR   EQU   16
IKJEBECA EQU   0
CAPTPRSD EQU   IKJEBECA+36
CAPRSPDL EQU   CAPTPRSD
CAFREEDL EQU   CAPRSPDL
CAPTIBFR EQU   IKJEBECA+40
CAOPERND EQU   CAPTIBFR
CAPTSCMD EQU   IKJEBECA+44
CASCMDLN EQU   IKJEBECA+48
CAPTCDCB EQU   IKJEBECA+52
CAPTCHK  EQU   IKJEBECA+72
CAATTN   EQU   IKJEBECA+120
CAATTNIS EQU   CAATTN
CACFLAG  EQU   IKJEBECA+124
CACFLAG1 EQU   CACFLAG
CALNTOVF EQU   CACFLAG1
CAVRFYSW EQU   CACFLAG1
CAPROMPT EQU   CACFLAG1
CASCANSW EQU   CACFLAG1
CAINITSC EQU   CACFLAG1
CAENDSC  EQU   CACFLAG1
CANONUM  EQU   CACFLAG1
CACFLAG2 EQU   CACFLAG+1
CARECFM  EQU   CACFLAG2
CASCANON EQU   CACFLAG2
CACFLAG3 EQU   CACFLAG+2
CAIMFLG  EQU   CACFLAG3
CACFLAG4 EQU   CACFLAG+3
CASCRC20 EQU   CACFLAG4
CAINPROC EQU   CACFLAG4
CACFLAG5 EQU   CACFLAG+4
CACFLAG6 EQU   CACFLAG+5
CAFREE   EQU   CACFLAG6
CACHAR48 EQU   CACFLAG6
CAPD     EQU   IKJEBECA+152
CADSTYPE EQU   CAPD
CASYNAME EQU   CAPD+32
CADSCODE EQU   CAPD+40
CADSATTR EQU   CAPD+41
CASCAN   EQU   CADSATTR
CADSATR2 EQU   CAPD+42
CACHKOPT EQU   CAPD+56
CAPTPDXT EQU   IKJEBECA+228
CALRECL  EQU   IKJEBECA+232
CAEDFLAG EQU   IKJEBECA+236
CAEDFLG2 EQU   IKJEBECA+237
CASAFLAG EQU   IKJEBECA+376
CASAFLG2 EQU   IKJEBECA+377
CACURNUM EQU   IKJEBECA+456
CASYNLST EQU   IKJEBECA+496
CASYNBFR EQU   CASYNLST
CASYNPWA EQU   CASYNLST+4
CASYNPTO EQU   CASYNLST+8
CASYNWA  EQU   IKJEBECA+508
CASYNMS1 EQU   CASYNWA+4
CASYNMS2 EQU   CASYNWA+8
CASYNOPT EQU   IKJEBECA+524
CASYNSW  EQU   CASYNOPT+3
CATMPLST EQU   IKJEBECA+528
CAMAWKA  EQU   IKJEBECA+596
MACFLAGS EQU   CAMAWKA+28
MACFLAG2 EQU   CAMAWKA+29
CAMODEMG EQU   IKJEBECA+928
CASCWKA  EQU   IKJEBECA+1448
CABFRPL  EQU   IKJEBECA+2120
CATEMPBF EQU   IKJEBECA+2648
CANXTSVA EQU   IKJEBECA+3896
IKJEBECX EQU   0
PARSEPDL EQU   0
@NM00028 EQU   PARSEPDL+8
LNSTART  EQU   @NM00028
LNSTARTL EQU   @NM00028+4
@NM00029 EQU   @NM00028+6
@NM00031 EQU   PARSEPDL+16
LNEND    EQU   @NM00031
LNENDL   EQU   @NM00031+4
@NM00032 EQU   @NM00031+6
LNENDF   EQU   @NM00032
@NM00034 EQU   PARSEPDL+24
KEYWD    EQU   @NM00034
LINENUM  EQU   0
AREA     EQU   0
HIORDBIT EQU   AREA
ERRORMSG EQU   0
FIRSTBFR EQU   0
RECRDNO  EQU   FIRSTBFR
FREEBIT  EQU   RECRDNO
FORWDPTR EQU   FIRSTBFR+1
RECRD    EQU   FIRSTBFR+4
CHECKER  EQU   0
PPL      EQU   0
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
CASAVPTR EQU   0
CASAVE   EQU   0
DSNAME   EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
BYTE     EQU   CASYNPTO
CHKWORKA EQU   CASYNWA
@NM00035 EQU   CHKWORKA
ENTRYCD  EQU   @NM00035
FIRSTENT EQU   ENTRYCD
CONTCHK  EQU   ENTRYCD
LASTENT  EQU   ENTRYCD
INCOMPST EQU   ENTRYCD
SYNMSG1  EQU   CHKWORKA+4
SYNMSG2  EQU   CHKWORKA+8
OPTIONWD EQU   CASYNOPT
CODE1AN2 EQU   OPTIONWD
INPUTCD  EQU   CODE1AN2+1
RECORDLN EQU   OPTIONWD+2
SWITCHES EQU   OPTIONWD+3
CHAR4860 EQU   SWITCHES
LNUM     EQU   SWITCHES
INCOMP   EQU   SWITCHES
RECLN    EQU   SWITCHES
RECFORM  EQU   SWITCHES
MSGLN    EQU   SWITCHES
SCANOPT  EQU   SWITCHES
MRGCODE  EQU   INPUTCD
CODE2    EQU   MRGCODE
BUFFAREA EQU   CABFRPL
UTBUFFER EQU   BUFFAREA
KEY      EQU   UTBUFFER
LL       EQU   UTBUFFER+4
LINE     EQU   UTBUFFER+8
SYNBUFFR EQU   BUFFAREA+264
RECNO    EQU   SYNBUFFR
CHAINPTR EQU   SYNBUFFR+1
RECORD   EQU   SYNBUFFR+4
FREEAREA EQU   BUFFAREA+524
FREELEN  EQU   BUFFAREA+624
MSGAREA  EQU   SYNBUFFR
MSGPTR   EQU   MSGAREA
MSGLEN   EQU   MSGAREA+4
MSGOFF   EQU   MSGAREA+6
MSGTEXT  EQU   MSGAREA+8
LEV2MSG  EQU   MSGAREA+84
LEV2PTR  EQU   LEV2MSG
LEV2LEN  EQU   LEV2MSG+4
LEV2OFF  EQU   LEV2MSG+6
LEV2TEXT EQU   LEV2MSG+8
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTPARS  EQU   CVTS01+176
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
*                                      START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTRV612 EQU   CVTS01+664
CVTRV611 EQU   CVTS01+660
CVTRV610 EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTRV608 EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTRV603 EQU   CVTS01+628
CVTRV602 EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTRV301 EQU   CVTS01+475
CVTRV300 EQU   CVTS01+474
CVTRV299 EQU   CVTS01+473
CVTRV298 EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTRV519 EQU   CVTS01+92
CVTRV327 EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00043 EQU   BUFFAREA+523
DATA     EQU   RECORD+4
OFFST    EQU   RECORD+2
LNGTH    EQU   RECORD
@NM00042 EQU   BUFFAREA+263
OFFSET   EQU   UTBUFFER+6
@NM00041 EQU   SWITCHES
@NM00040 EQU   CODE1AN2+1
RUNCD    EQU   CODE1AN2+1
RENUMCB  EQU   CODE1AN2+1
@NM00039 EQU   CODE1AN2+1
DELTCD   EQU   CODE1AN2+1
CODE1    EQU   CODE1AN2
@NM00038 EQU   CHKWORKA+12
@NM00037 EQU   @NM00035+1
@NM00036 EQU   ENTRYCD
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00045 EQU   CVTFIX+248
@NM00044 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRSV37 EQU   CVTDMSR
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
RECDATA  EQU   RECRD+4
OFFSETV  EQU   RECRD+2
LEN      EQU   RECRD
@NM00033 EQU   @NM00031+7
@NM00030 EQU   @NM00028+7
LNSTARTF EQU   @NM00029
@NM00027 EQU   PARSEPDL+4
@NM00026 EQU   PARSEPDL
CXDATEXT EQU   IKJEBECX
CAPDEXT  EQU   IKJEBECA+3984
CADSNRC2 EQU   IKJEBECA+3928
CADSNOF2 EQU   IKJEBECA+3926
CADSNLN2 EQU   IKJEBECA+3924
CADSNPT2 EQU   IKJEBECA+3920
@NM00022 EQU   IKJEBECA+3900
CASVAREA EQU   IKJEBECA+3176
CAFIBFR  EQU   IKJEBECA+1188
CAAEDCB  EQU   IKJEBECA+1096
CALDROP  EQU   IKJEBECA+1064
CAATNWKA EQU   IKJEBECA+956
CAATNBUF EQU   IKJEBECA+952
CAMODETX EQU   CAMODEMG+12
CAMODEOF EQU   CAMODEMG+10
CAMODELN EQU   CAMODEMG+8
CAMODEPT EQU   CAMODEMG+4
CAMODEIS EQU   CAMODEMG
CASRWKA  EQU   IKJEBECA+728
CAMSWKA  EQU   IKJEBECA+628
@NM00021 EQU   CAMAWKA+30
@NM00020 EQU   MACFLAG2
MATABLE1 EQU   MACFLAG2
@NM00019 EQU   MACFLAGS
MAENDPRC EQU   MACFLAGS
MAABBREV EQU   MACFLAGS
MAECTMOD EQU   MACFLAGS
@NM00018 EQU   CAMAWKA
CASTAEPL EQU   IKJEBECA+576
CASTAXPL EQU   IKJEBECA+556
CASRPLST EQU   CATMPLST+12
CAPTECB  EQU   CATMPLST+8
CAPTECT  EQU   CATMPLST+4
CAPTUPT  EQU   CATMPLST
CASYNSCN EQU   CASYNSW
CASYNML  EQU   CASYNSW
CASYNSF  EQU   CASYNSW
CASYNRFM EQU   CASYNSW
CASYNIS  EQU   CASYNSW
@NM00017 EQU   CASYNSW
CASYNLN  EQU   CASYNSW
@NM00016 EQU   CASYNSW
CASYNRCL EQU   CASYNOPT+2
CASYNCD2 EQU   CASYNOPT+1
CASYNCD1 EQU   CASYNOPT
CASYNTEM EQU   CASYNWA+12
CASYNWAP EQU   CASYNWA+1
CASYNECD EQU   CASYNWA
@NM00015 EQU   IKJEBECA+484
CARECNO  EQU   IKJEBECA+480
CAINSAVE EQU   IKJEBECA+476
@NM00014 EQU   IKJEBECA+472
CAIMLINC EQU   IKJEBECA+468
CAIMLLNO EQU   IKJEBECA+464
CAINCRE  EQU   IKJEBECA+460
CANXTREC EQU   IKJEBECA+452
CASTNUM  EQU   IKJEBECA+448
CASAPSWD EQU   IKJEBECA+440
CASADDN  EQU   IKJEBECA+432
CASAMEMB EQU   IKJEBECA+424
CASADSN  EQU   IKJEBECA+380
CASADSNL EQU   IKJEBECA+378
CASADQTY EQU   CASAFLG2
CASANCTG EQU   CASAFLG2
CASAALOC EQU   CASAFLAG
CASAUNCG EQU   CASAFLAG
CASADSOR EQU   CASAFLAG
CASAMEM  EQU   CASAFLAG
CASADISP EQU   CASAFLAG
CASAINCP EQU   CASAFLAG
CASAFNCP EQU   CASAFLAG
CASAVEDS EQU   CASAFLAG
CADSNREC EQU   IKJEBECA+320
CADSNOFF EQU   IKJEBECA+318
CADSNLEN EQU   IKJEBECA+316
CADSNPTR EQU   IKJEBECA+312
CAEDTSIZ EQU   IKJEBECA+308
CAEDPSWD EQU   IKJEBECA+300
CAEDDDN  EQU   IKJEBECA+292
CAEDMEMB EQU   IKJEBECA+284
CAEDDSN  EQU   IKJEBECA+240
CAEDDSNL EQU   IKJEBECA+238
CAEDPRTC EQU   CAEDFLG2
CAEDALOC EQU   CAEDFLAG
CAEDUNCG EQU   CAEDFLAG
CAEDDSOR EQU   CAEDFLAG
CAEDMEM  EQU   CAEDFLAG
CAEDDISP EQU   CAEDFLAG
CAEDINCP EQU   CAEDFLAG
CAEDFNCP EQU   CAEDFLAG
CAEDITDS EQU   CAEDFLAG
CABLK2   EQU   IKJEBECA+234
@NM00013 EQU   IKJEBECA+226
CAPDEND  EQU   CAPD+82
CADATEXT EQU   CAPD+74
CAEXTNAM EQU   CAPD+66
CAPRNAME EQU   CAPD+58
CAULRLMX EQU   CAPD+54
CAULRLDF EQU   CAPD+52
CAVLRLMX EQU   CAPD+50
CAVLRLDF EQU   CAPD+48
CAFLRLMX EQU   CAPD+46
CAFLRLDF EQU   CAPD+44
CARECFMD EQU   CAPD+43
@NM00012 EQU   CADSATR2
CAINLIST EQU   CADSATR2
CARUNDS  EQU   CADSATR2
CAOBJGEN EQU   CADSATR2
CADSNDEF EQU   CADSATR2
CALINTAB EQU   CADSATR2
@NM00011 EQU   CADSATTR
CALRECLX EQU   CADSATTR
CALNNUM  EQU   CADSATTR
CADSCONT EQU   CADSATTR
CACAPSDF EQU   CADSATTR
CACAPSRQ EQU   CADSATTR
CARUN    EQU   CADSATTR
CATABS   EQU   CAPD+20
CALENGTH EQU   CAPD+19
CALINE   EQU   CAPD+18
CABLKS   EQU   CAPD+16
CADSQUAL EQU   CAPD+8
@NM00010 EQU   CACFLAG+8
CAPLIRTM EQU   CACFLAG+7
CAPLILFM EQU   CACFLAG+6
@NM00009 EQU   CACFLAG6
CACHAR60 EQU   CACFLAG6
@NM00008 EQU   CACFLAG5
CAEDLNDP EQU   CACFLAG5
CADSUSED EQU   CACFLAG4
CARECURS EQU   CACFLAG4
CAABEND  EQU   CACFLAG4
CATPUTVF EQU   CACFLAG4
CAPTGTBF EQU   CACFLAG4
CAFINDIS EQU   CACFLAG4
@NM00007 EQU   CAIMFLG
CAIMINPT EQU   CAIMFLG
CAIMSFPT EQU   CAIMFLG
CAIMCIN  EQU   CAIMFLG
CAIMIR   EQU   CAIMFLG
CAIMSC   EQU   CAIMFLG
CAIMINS  EQU   CAIMFLG
CAIMPT   EQU   CAIMFLG
@NM00006 EQU   CACFLAG2
CASEQCOL EQU   CACFLAG2
CAMODMSG EQU   CACFLAG2
CADSMODS EQU   CACFLAG2
CACAPS   EQU   CACFLAG1
@NM00005 EQU   CAATTN
@NM00004 EQU   IKJEBECA+118
CAMAXBLK EQU   IKJEBECA+116
@NM00003 EQU   IKJEBECA+88
CAPTICLN EQU   IKJEBECA+84
CAPTICDS EQU   IKJEBECA+80
CAPTNBFR EQU   IKJEBECA+76
CACORELN EQU   IKJEBECA+68
CAPTCORE EQU   IKJEBECA+64
CAUTILNO EQU   IKJEBECA+60
CAPTPDCB EQU   IKJEBECA+56
@NM00002 EQU   IKJEBECA+50
CAPTRTRY EQU   IKJEBECA+32
CAPTMSGM EQU   IKJEBECA+28
CAPTUT   EQU   IKJEBECA+24
CAPTMS   EQU   IKJEBECA+20
CAPTLE   EQU   IKJEBECA+16
CAPTAT   EQU   IKJEBECA+12
CAPTAE   EQU   IKJEBECA+8
@NM00001 EQU   IKJEBECA+4
CAPTTMP  EQU   IKJEBECA
*                                      END UNREFERENCED COMPONENTS
@RT00107 EQU   NOSCNEXT
@RT00113 EQU   ONSPEC
@RT00115 EQU   OFFSPEC
@RT00137 EQU   ONTEST
@RT00174 EQU   FCNINCMP
@RF00174 EQU   SCANEXIT
@RF00118 EQU   TOTLSCAN
@RT00181 EQU   FNLENTRY
@RT00186 EQU   SCANEXIT
@RT00191 EQU   SETON
@RT00208 EQU   INITERR
@RT00230 EQU   SETON
@RF00230 EQU   SWITCHON
@RT00236 EQU   SETON
@RT00254 EQU   INITERR
@RT00273 EQU   SWITCHON
@RT00289 EQU   INITERR
@RT00294 EQU   IOERROR
@RT00300 EQU   SETON
@RF00300 EQU   RECOVMSG
@RF00297 EQU   CALLCHKR
@RT00316 EQU   SETOFF
@RF00316 EQU   PREFINAL
@RT00320 EQU   SCANEXIT
@RT00335 EQU   RECOVER
@RT00377 EQU   CALC
@RC00363 EQU   @RC00360
@RT00391 EQU   NOSCNEXT
@RT00421 EQU   OUT
@RC00439 EQU   @RC00434
@RT00529 EQU   PARTLSCN
@RT00603 EQU   IOERR
@RT00605 EQU   EMPTY
@RT00613 EQU   IOERR
@RT00615 EQU   MORESCN
@RT00635 EQU   IOERR
@RT00642 EQU   ENDDATA
@RT00644 EQU   MOVEREC
@RF00644 EQU   SYNCHK
@RT00664 EQU   IOERR
@RT00666 EQU   NOLINE
@RF00666 EQU   SCNMORE
@RT00690 EQU   SKIPMSG8
@RT00722 EQU   CLEANUP
@RT00730 EQU   CHKATTN
@RT00784 EQU   CLEANUP
@RT00841 EQU   NOSCEXT
@RC00893 EQU   @EL00007
@RT00922 EQU   FOUNDONE
@RT00924 EQU   GETNEW
@PB00009 EQU   @EL00001
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEBESC,(C'PLS0016',0603,74207)

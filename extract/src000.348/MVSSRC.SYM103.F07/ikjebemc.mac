         TITLE 'IKJEBEMC - MOVE/COPY SUBCOMMAND OF EDIT                *
                        '
IKJEBEMC CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IKJEBEMC  75.328'                                 0001
IKJEBEMM DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00059-IKJEBEMM)
         ENTRY IKJEBEMM
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*   COMMREG = GPR01P;                /* GET ADDR OF IKJEBECA         */
         LR    COMMREG,GPR01P                                      0036
*   RESPECIFY (GPR01P) UNRSTD;                                     0037
*                                                                  0037
*   RESPECIFY (GPR13P,GPR15P) RSTD;                                0038
*   GPR15P = CANXTSVA;               /* SAVE AREA FOR THIS MODULE    */
         L     GPR15P,CANXTSVA(,COMMREG)                           0039
*   EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS SAVEAREA    */
         LA    @14,4                                               0040
         ALR   @14,GPR15P                                          0040
         ST    GPR13P,CASAVPTR(,@14)                               0040
*                                    /* BKWD PTR                     */
*   EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER FWD PTR   */
         LA    @14,8                                               0041
         ALR   @14,GPR13P                                          0041
         ST    GPR15P,CASAVPTR(,@14)                               0041
*   GPR13P = GPR15P;                 /* NEW SAVEAREA ADDR            */
         LR    GPR13P,GPR15P                                       0042
*   CANXTSVA = GPR13P + 72;          /* UPDATE NEX-SAVE-AREA PTR     */
         LA    @14,72                                              0043
         ALR   @14,GPR13P                                          0043
         ST    @14,CANXTSVA(,COMMREG)                              0043
*   RESPECIFY (GPR13P,GPR15P) UNRSTD;                              0044
*                                                                  0044
*   DATDREG = ADDR(CASCWKA);         /* SET BASE REG FOR WORK AREA   */
         LA    DATDREG,CASCWKA(,COMMREG)                           0045
*   GEN( USING @DATD,DATDREG);       /* SET ADDRESSABILITY TO        */
          USING @DATD,DATDREG
*                                    /* CASCWKA                      */
*                                                                  0047
*                                                                  0047
*                                                                  0047
*                                                                  0047
*                                                                  0047
*   STATUS = CONTINUE;              /* INITIAL CONTINUE STATUS       */
         SLR   STATUS,STATUS                                       0047
*   COMMAND = COPY;                 /* INDICATE COPY                 */
*                                                                  0048
         MVI   COMMAND,X'02'                                       0048
*   CALL MAINLINE;                  /* CALL THE MAINLINE             */
*                                                                  0049
*                                                                  0049
*                                                                  0049
*                                                                  0049
*                                                                  0049
*                                                                  0049
         BAL   @14,MAINLINE                                        0049
*   RESPECIFY (GPR12P,GPR13P) RSTD;                                0050
*   CANXTSVA = GPR13P;               /* UPDATE NEXT-SAVE-AREA PTR    */
         ST    GPR13P,CANXTSVA(,COMMREG)                           0051
*   GPR12P = GPR13P;                 /* SAVE PRESENT SAVE-AREA ADDR  */
         LR    GPR12P,GPR13P                                       0052
*   GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD SAVE-AREA PTR */
         L     @08,CASAVPTR+4(,GPR13P)                             0053
         LR    GPR13P,@08                                          0053
*   RESPECIFY CASAVE BASED(GPR12P);  /* CHANGE BASE FOR SAVE-AREA    */
*   CASAVE = CASAVE && CASAVE;       /* ZERO OUT THIS SAVE-AREA      */
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0055
*   RESPECIFY CASAVE BASED;                                        0056
*   RETURN CODE(RETCODE);            /* RETURN WITH RETURN CODE      */
         L     @15,RETCODE                                         0057
         L     @14,12(,@13)                                        0057
         LM    @00,@12,20(@13)                                     0057
         BR    @14                                                 0057
*   RESPECIFY (GPR12P,GPR13P) UNRSTD;                              0058
*                                                                  0058
*/********************************************************************/
*/*                                                                  */
*/*ENTRY POINT-                                                      */
*/*          FOR MOVE                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INDICATE THAT THE COMMAND IS A MOVE AND CALL MAINLINE   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0059
*IKJEBEMM:                                                         0059
*   ENTRY;                                                         0059
@EP00059 DS    0H                                                  0060
*   RESPECIFY (GPR01P) RSTD;                                       0060
*   COMMREG = GPR01P;                /* GET ADDR OF IKJEBECA         */
         LR    COMMREG,GPR01P                                      0061
*   RESPECIFY (GPR01P) UNRSTD;                                     0062
*                                                                  0062
*   RESPECIFY (GPR13P,GPR15P) RSTD;                                0063
*   GPR15P = CANXTSVA;               /* SAVE AREA FOR THIS MODULE    */
         L     GPR15P,CANXTSVA(,COMMREG)                           0064
*   EVAL(GPR15P + 4) -> CASAVPTR = GPR13P;   /* SET THIS SAVEAREA    */
         LA    @14,4                                               0065
         ALR   @14,GPR15P                                          0065
         ST    GPR13P,CASAVPTR(,@14)                               0065
*                                    /* BKWD PTR                     */
*   EVAL(GPR13P + 8) -> CASAVPTR = GPR15P;   /* SET CALLER FWD PTR   */
         LA    @14,8                                               0066
         ALR   @14,GPR13P                                          0066
         ST    GPR15P,CASAVPTR(,@14)                               0066
*   GPR13P = GPR15P;                 /* NEW SAVEAREA ADDR            */
         LR    GPR13P,GPR15P                                       0067
*   CANXTSVA = GPR13P + 72;          /* UPDATE NEX-SAVE-AREA PTR     */
         LA    @14,72                                              0068
         ALR   @14,GPR13P                                          0068
         ST    @14,CANXTSVA(,COMMREG)                              0068
*   RESPECIFY (GPR13P,GPR15P) UNRSTD;                              0069
*                                                                  0069
*   DATDREG = ADDR(CASCWKA);         /* SET BASE REG FOR WORK AREA   */
         LA    DATDREG,CASCWKA(,COMMREG)                           0070
*   GEN( USING @DATD,DATDREG);       /* SET ADDRESSABILITY TO        */
          USING @DATD,DATDREG
*                                    /* CASCWKA                      */
*                                                                  0072
*                                                                  0072
*                                                                  0072
*                                                                  0072
*                                                                  0072
*   STATUS = CONTINUE;              /* INITIAL CONTINUE STATUS       */
         SLR   STATUS,STATUS                                       0072
*   COMMAND = MOVE;                 /* INDICATE MOVE                 */
*                                                                  0073
         MVI   COMMAND,X'01'                                       0073
*   CALL MAINLINE;                  /* START MOVE PROCESSING         */
*                                                                  0074
*                                                                  0074
*                                                                  0074
*                                                                  0074
*                                                                  0074
*                                                                  0074
         BAL   @14,MAINLINE                                        0074
*   RESPECIFY (GPR12P,GPR13P) RSTD;                                0075
*   CANXTSVA = GPR13P;               /* UPDATE NEXT-SAVE-AREA PTR    */
         ST    GPR13P,CANXTSVA(,COMMREG)                           0076
*   GPR12P = GPR13P;                 /* SAVE PRESENT SAVE-AREA ADDR  */
         LR    GPR12P,GPR13P                                       0077
*   GPR13P = (GPR13P + 4) -> CASAVPTR; /* GET BACKWARD SAVE-AREA PTR */
         L     @08,CASAVPTR+4(,GPR13P)                             0078
         LR    GPR13P,@08                                          0078
*   RESPECIFY CASAVE BASED(GPR12P);  /* CHANGE BASE FOR SAVE-AREA    */
*   CASAVE = CASAVE && CASAVE;       /* ZERO OUT THIS SAVE-AREA      */
         XC    CASAVE(72,GPR12P),CASAVE(GPR12P)                    0080
*   RESPECIFY CASAVE BASED;                                        0081
*   RETURN CODE(RETCODE);            /* RETURN WITH RETURN CODE      */
         L     @15,RETCODE                                         0082
         L     @14,12(,@13)                                        0082
         LM    @00,@12,20(@13)                                     0082
         BR    @14                                                 0082
*   RESPECIFY (GPR12P,GPR13P) UNRSTD;                              0083
*                                                                  0083
*/********************************************************************/
*/*                                                                  */
*/*MAINLINE-                                                         */
*/*          FOR MOVE/COPY                                           */
*/*                                                                  */
*/*      INIT-                                                       */
*/*          INITIALIZE THE REQUIRED ITEMS                           */
*/*                                                                  */
*/*      CHECK-                                                      */
*/*          CHECK FOR THOSE SPECIFIC CASES THAT WILL CAUSE          */
*/*          TERMINATION IMMEDIATELY                                 */
*/*                                                                  */
*/*      OPERANDS-                                                   */
*/*          OBTAIN THE VALUES FROM THE INPUT LINE REQUIRED TO DO    */
*/*          THE MOVE/COPY                                           */
*/*                                                                  */
*/*      DATAEXIT-                                                   */
*/*          INVOKE THE INSTALLATION EXIT IF THERE IS ONE            */
*/*                                                                  */
*/*      MOVECOPY-                                                   */
*/*          PERFORM THE ACTUAL MOVE/COPY                            */
*/*                                                                  */
*/*      IPLIEXIT-                                                   */
*/*          HANDLE IPLI DATA SETS                                   */
*/*                                                                  */
*/*      CLEANUP-                                                    */
*/*          FREE PDL AND UTILITY DATASET IF GOTTEN                  */
*/*                                                                  */
*/*      HANDLERR-                                                   */
*/*          HANDLE ANY ERRORS THAT MAY HAVE OCCURRED                */
*/*                                                                  */
*/********************************************************************/
*MAINLINE:                                                         0084
*        PROC OPTIONS(NOSAVE);                                     0084
*                                                                  0084
MAINLINE DS    0H                                                  0085
*    RESPECIFY (GPR14P) RSTD;                                      0085
*    MAINLI14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,MAINLI14                                     0086
*    RESPECIFY (GPR14P) UNRSTD;                                    0087
*                                                                  0087
*    CALL INIT;                      /*DO INITIALIZATION             */
*                                                                  0088
         BAL   @14,INIT                                            0088
*    CALL CHECK;                     /* LOOK FOR TERMINATING CASES   */
*                                                                  0089
         BAL   @14,CHECK                                           0089
*    IF STATUS = CONTINUE            /* CONTINUE FROM CHECK          */
*      THEN DO;                      /*   YES - CONTINUE FROM CHECK  */
*                                                                  0090
         LTR   STATUS,STATUS                                       0090
         BNZ   @RF00090                                            0090
*        CALL OPERANDS;              /* HANDLE OPERANDS              */
*                                                                  0092
         BAL   @14,OPERANDS                                        0092
*        IF STATUS = CONTINUE        /* CONTINUE FROM OPERANDS       */
*          THEN DO;                  /*   YES - DO MOVE OR COPY      */
         LTR   STATUS,STATUS                                       0093
         BNZ   @RF00093                                            0093
*            IF CXDATEXT ^= NODAEXIT  & /* IF THERE IS A DATA EXIT   */
*               CADSCODE = CAVBASIC     /* AND ARE EDITTING VSBASIC  */
*              THEN                  /* THEN GO TO USERS DATA EXIT   */
         L     @08,CAPTPDXT(,COMMREG)                              0095
         CLC   CXDATEXT(8,@08),@CB01330                            0095
         BE    @RF00095                                            0095
         CLI   CADSCODE(COMMREG),X'1E'                             0095
         BNE   @RF00095                                            0095
*                CALL DATAEXIT;      /* INVOKE USERS DATA EXIT       */
*                                                                  0096
         BAL   @14,DATAEXIT                                        0096
*            IF STATUS = CONTINUE    /* CAN MOVE/COPY CONTINUE       */
*              THEN DO;              /* THEN CONTINUE WITH MOVE/COPY */
@RF00095 LTR   STATUS,STATUS                                       0097
         BNZ   @RF00097                                            0097
*                CALL MOVECOPY;      /* PERFORM THE MOVE/COPY        */
*                                                                  0099
         BAL   @14,MOVECOPY                                        0099
*                IF STATUS = CONTINUE &     /*TCONTINUE FROM M/C ... */
*                   CADSCODE = CAIPLI       /* ... & IS IT IPLI DS   */
*                  THEN                     /* THEN HANDLE IPLI DS   */
         LTR   STATUS,STATUS                                       0100
         BNZ   @RF00100                                            0100
         CLI   CADSCODE(COMMREG),X'21'                             0100
         BNE   @RF00100                                            0100
*                    CALL IPLIEXIT;         /* INVOKE IPLI INTEFFACE */
         BAL   @14,IPLIEXIT                                        0101
*                END;                                              0102
@RF00100 DS    0H                                                  0103
*            END;                                                  0103
@RF00097 DS    0H                                                  0104
*        END;                                                      0104
*                                                                  0104
@RF00093 DS    0H                                                  0105
*    CALL CLEANUP;                   /* PERFORM CLEAN UP             */
*                                                                  0105
@RF00090 BAL   @14,CLEANUP                                         0105
*    IF STATUS ^= CONTINUE &         /* WERE THERE ANY ERRORS        */
*       STATUS ^= TERMNOER           /* DO THEY HAVE ERROR MSGS      */
*      THEN                          /*   YES - THERE WERE ERRORS    */
         LTR   STATUS,STATUS                                       0106
         BZ    @RF00106                                            0106
         C     STATUS,@CF00890                                     0106
         BE    @RF00106                                            0106
*        CALL HANDLERR;              /* HANDLE ANY ERRORS            */
*                                                                  0107
         BAL   @14,HANDLERR                                        0107
*    RESPECIFY (GPR14P) RSTD;        /* RESTORE REG 14               */
@RF00106 DS    0H                                                  0109
*    GPR14P = MAINLI14;                                            0109
         L     GPR14P,MAINLI14                                     0109
*    RESPECIFY (GPR14P) UNRSTD;                                    0110
*                                                                  0110
*END MAINLINE;                                                     0111
@EL00002 DS    0H                                                  0111
@EF00002 DS    0H                                                  0111
@ER00002 BR    @14                                                 0111
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          INIT PART 1                                             */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INITIALIZE VARIALBLES                                   */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          SET DEFAULT VALUES FOR VARIABLES AND BITS               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0112
*INIT:                                                             0112
*        PROC OPTIONS(NOSAVE);                                     0112
*                                                                  0112
INIT     DS    0H                                                  0113
*    RESPECIFY (GPR14P) RSTD;                                      0113
*    INIT14 = GPR14P;                /* SAVE REG 14                  */
         LR    INIT14,GPR14P                                       0114
*    RESPECIFY (GPR14P) UNRSTD;                                    0115
*                                                                  0115
*    CAPTPRSD = ZERO;                /* INDICATE NO PDL              */
         SLR   @08,@08                                             0116
         ST    @08,CAPTPRSD(,COMMREG)                              0116
*    THECOUNT = ZERO;                /* TENTATIVE NUMBER OF LINES    */
         ST    @08,THECOUNT                                        0117
*    FIRSTREC = ZERO;                /* TENTATIVE KEY OF FIRST REC   */
         ST    @08,FIRSTREC                                        0118
*    VERIFY = ZERO;                  /* LINE TO VERIFY IS LINE 0     */
         ST    @08,VERIFY                                          0119
*    RETCODE = ZERO;                 /* RETURN CODE IS ZERO          */
         ST    @08,RETCODE                                         0120
*    INSRTKEY = ZERO;                /* DEFAULT VALUE FOR INSERT PT  */
         ST    @08,INSRTKEY                                        0121
*    LIMITKEY = ZERO;                /* DEFAULT FOR LIMIT OF MOVE    */
*                                                                  0122
         ST    @08,LIMITKEY                                        0122
*    THEBITS = ''B;                  /* ZERO THE CONTROL BITS        */
*                                                                  0123
         MVI   THEBITS,X'00'                                       0123
*    THEINCR = CAINCRE;              /* DEFAULT IF NOT SET ON COMMAND*/
*                                                                  0124
         L     @08,CAINCRE(,COMMREG)                               0124
         ST    @08,THEINCR                                         0124
*    FIRSTKEY = CACURNUM;            /* DEFAULT FOR FIRST LINE MOVED */
         L     @08,CACURNUM(,COMMREG)                              0125
         ST    @08,FIRSTKEY                                        0125
*    ORIGFRST = CACURNUM;            /* FIRST LINE AS ENTERED ON CMND*/
         ST    @08,ORIGFRST                                        0126
*    LASTKEY = CACURNUM;             /* DEFAULT VALUE FOR LAST KEY   */
         ST    @08,LASTKEY                                         0127
*    NEWKEY = CACURNUM;              /* DEFAULT NEW KEY FOR FIRST LIN*/
*                                                                  0128
         LR    NEWKEY,@08                                          0128
*    TYPE = STRING;                  /* DEFAULT TYPE OF STRING       */
         MVI   TYPE,X'03'                                          0129
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          INIT PART 2                                             */
*/*                                                                  */
*/*OPERATION CONTINUED-                                              */
*/*          INITIALIZE THE VARIOUS PARAMETER LISTS THAT WILL BE     */
*/*          USED BY IKJEBEUT                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0130
*    UTPARMP = ADDR(READPARM);       /* PARMS  TO READ                *
         LA    UTPARMP,READPARM                                    0130
*    UTCODE = CAUTREAD;              /* CODE TO READ A SPECIFIC KEY  */
         MVI   UTCODE(UTPARMP),X'00'                               0131
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */
         L     @08,CAPTCDCB(,COMMREG)                              0132
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0132
*    UTKEYPTR = ADDR(THEKEY);        /* READ REC WITH KEY = THEKEY   */
         LA    @06,THEKEY(,COMMREG)                                0133
         ST    @06,UTKEYPTR(,UTPARMP)                              0133
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */
         LA    @05,THEBUFFR(,COMMREG)                              0134
         ST    @05,UTBUFPTR(,UTPARMP)                              0134
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0135
         OI    UTEOL3(UTPARMP),B'10000000'                         0135
*    UTPARMP = ADDR(READFRST);       /* PARMS TO READ FIRST RECORD   */
         LA    UTPARMP,READFRST                                    0136
*    UTCODE = CAUTFRST;              /* CODE TO READ FIRST           */
         MVI   UTCODE(UTPARMP),X'04'                               0137
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0138
*    UTKEYPTR = ADDR(THEKEY);        /* NO KEY REQUIRED              */
         ST    @06,UTKEYPTR(,UTPARMP)                              0139
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */
         ST    @05,UTBUFPTR(,UTPARMP)                              0140
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0141
         OI    UTEOL3(UTPARMP),B'10000000'                         0141
*    UTPARMP = ADDR(READNEXT);       /* PARMS TO READ NEXT  RECORD   */
         LA    UTPARMP,READNEXT                                    0142
*    UTCODE = CAUTNEXT;              /* CODE TO READ FIRST           */
         MVI   UTCODE(UTPARMP),X'02'                               0143
*    UTDCBPTR = CAPTCDCB;            /* CURREND DATA SET DCB         */
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0144
*    UTKEYPTR = ADDR(THEKEY);        /* READ NEXT AFTER THEKEY       */
         ST    @06,UTKEYPTR(,UTPARMP)                              0145
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */
         ST    @05,UTBUFPTR(,UTPARMP)                              0146
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0147
         OI    UTEOL3(UTPARMP),B'10000000'                         0147
*    UTPARMP = ADDR(READPREV);       /* PARMS TO READ PREVIOUS REC   */
         LA    UTPARMP,READPREV                                    0148
*    UTCODE = CAUTPREV;              /* CODE TO READ PREVIOUS RECORD */
         MVI   UTCODE(UTPARMP),X'01'                               0149
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0150
*    UTKEYPTR = ADDR(THEKEY);        /* READ RECORD BEFORE THEKEY    */
         ST    @06,UTKEYPTR(,UTPARMP)                              0151
*    UTBUFPTR = ADDR(THEBUFFR);      /* THE INPUT BUFFER             */
         ST    @05,UTBUFPTR(,UTPARMP)                              0152
*    UTEOL3 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0153
         OI    UTEOL3(UTPARMP),B'10000000'                         0153
*    UTPARMP = ADDR(WRITEREC);       /* PARMS TO WRITE THEKEY        */
         LA    UTPARMP,WRITEREC                                    0154
*    UTCODE = CAUTWRT;               /* CODE TO WRITE THEKEY         */
         MVI   UTCODE(UTPARMP),X'20'                               0155
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0156
*    UTKEYPTR = ADDR(THEBUFFR);      /* THIS POINTS TO BUFFER NOT KEY*/
         ST    @05,UTKEYPTR(,UTPARMP)                              0157
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0158
         OI    UTEOL2(UTPARMP),B'10000000'                         0158
*    UTPARMP = ADDR(DELETKEY);       /* PARMS TO DELETE THEKEY       */
         LA    UTPARMP,DELETKEY                                    0159
*    UTCODE = CAUTDELT;              /* CODE TO DELETE THEKEY        */
         MVI   UTCODE(UTPARMP),X'10'                               0160
*    UTDCBPTR = CAPTCDCB;            /* CURRENT DATA SET DCB         */
         STCM  @08,7,UTDCBPTR(UTPARMP)                             0161
*    UTKEYPTR = ADDR(THEKEY);        /* THEKEY TO DELETE             */
         ST    @06,UTKEYPTR(,UTPARMP)                              0162
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0163
         OI    UTEOL2(UTPARMP),B'10000000'                         0163
*    RESPECIFY (GPR14P) RSTD;                                      0164
*    GPR14P = INIT14;                /* RESTORE REG 14               */
         LR    GPR14P,INIT14                                       0165
*    RESPECIFY (GPR14P) UNRSTD;                                    0166
*                                                                  0166
*END INIT;                                                         0167
@EL00003 DS    0H                                                  0167
@EF00003 DS    0H                                                  0167
@ER00003 BR    @14                                                 0167
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          CHECK                                                   */
*/*                                                                  */
*/*FUNTCTION-                                                        */
*/*          CHECK FOR SPECIFIC CASES WHICH WILL REQUIRE IMMEDIATE   */
*/*          TERMINATION OF MOVE/COPY                                */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF THE DATASET TYPE IS BASIC THEN WE HAVE EN ERROR      */
*/*                                                                  */
*/*          IF THE COMMAND WAS A MOVE WITHOUT ANY OPERANDS THEN DO  */
*/*          NOTHING BECAUSE WE WILL ONLY RENUMBER THE LINE.         */
*/*                                                                  */
*/*          IF THERE ARE NO RECORDS IN THE DATASET THEN WE HAVE     */
*/*          AND ERROR.                                              */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          MSG52580---CANNOT HANDLE BASIC TYPE DATA SETS           */
*/*          TERMNOER---A MOVE WITH NO OPERANDS WILL DO NOTHING      */
*/*          MSG52501---THE DATA SET IS EMPTY                        */
*/*                                                                  */
*/********************************************************************/
*CHECK:                                                            0168
*        PROC OPTIONS(NOSAVE);                                     0168
*                                                                  0168
CHECK    DS    0H                                                  0169
*    RESPECIFY (GPR14P) RSTD;                                      0169
*    CHECK14 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,CHECK14                                      0170
*    RESPECIFY (GPR14P) UNRSTD;                                    0171
*                                                                  0171
*    STATUS = CONTINUE;              /* TENTATIVE CONTINUE STATUS    */
*                                                                  0172
         SLR   STATUS,STATUS                                       0172
*    IF CADSCODE = CABASIC           /* IF A BASIC DATA SET          */
*      THEN STATUS = MSG52580;       /* INDICATE BASIC ERROR IN STATUS*
*                                                                  0173
*                                                                  0173
         CLI   CADSCODE(COMMREG),X'20'                             0173
         BNE   @RF00173                                            0173
         LH    STATUS,MSG52580                                     0174
*      ELSE                          /* NOT A BASIC DATA SET         */
*        IF COMMAND = MOVE &         /* IF IT IS A MOVE AND ...      */
*           CAOPERND = NO            /* ... WITHOUT OPERANDS         */
*          THEN STATUS = TERMNOER;   /* TERMINATE WITHOUT MESSAGE    */
*                                                                  0175
*                                                                  0175
         B     @RC00173                                            0175
@RF00173 CLI   COMMAND,1                                           0175
         BNE   @RF00175                                            0175
         TM    CAOPERND(COMMREG),B'10000000'                       0175
         BNZ   @RF00175                                            0175
         LA    STATUS,32                                           0176
*          ELSE DO;                  /* NOT A NULL MOVE              */
         B     @RC00175                                            0177
@RF00175 DS    0H                                                  0178
*            UTPARMP = ADDR(READFRST); /* WANT TO READ FIRST REC     */
         LA    UTPARMP,READFRST                                    0178
*            CALL READ;              /* READ THE FIRST RECORD        */
*                                                                  0179
         BAL   @14,READ                                            0179
*            FIRSTREC = THEKEY;      /* SAVE KEY OF FIRST RECORD     */
*                                                                  0180
         L     @08,THEKEY(,COMMREG)                                0180
         ST    @08,FIRSTREC                                        0180
*            IF STATUS = NORECORD    /* IF NO REC FOUND FOR FIRST REC*/
*              THEN STATUS = MSG52501; /* THEN WE HAVE  EMPTY DATASET*/
         C     STATUS,@CF00055                                     0181
         BNE   @RF00181                                            0181
         LH    STATUS,MSG52501                                     0182
*            END;                                                  0183
*                                                                  0183
@RF00181 DS    0H                                                  0184
*    RESPECIFY (GPR14P) RSTD;                                      0184
@RC00175 DS    0H                                                  0184
@RC00173 DS    0H                                                  0185
*    GPR14P = CHECK14;               /* RESTORE REG 14               */
         L     GPR14P,CHECK14                                      0185
*    RESPECIFY (GPR14P) UNRSTD;                                    0186
*                                                                  0186
*END CHECK;                                                        0187
@EL00004 DS    0H                                                  0187
@EF00004 DS    0H                                                  0187
@ER00004 BR    @14                                                 0187
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          OPERANDS                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          TO SET THE VALUES REQUIRED TO DO THE MOVE/COPY          */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          DEFAULT VALUES WERE SET IN INIT                         */
*/*                                                                  */
*/*      PARSE-                                                      */
*/*          IF THERE ARE OPERANDS THEN INVOKE PARSE TO PARSE THE    */
*/*          SUBCOMMAND                                              */
*/*                                                                  */
*/*      SETTYPE-                                                    */
*/*          DO WE HAVE A STRING AND COUNT TYPE OR A LINE NUMBER     */
*/*          TYPE OF MOVE COPY                                       */
*/*                                                                  */
*/*      SETFIRST-                                                   */
*/*          DETERMINE THE KEY OF THE FIRST RECORD TO BE MOVE/COPIED */
*/*                                                                  */
*/*      SETLAST-                                                    */
*/*          DETERMINE THE KEY OF THE LAST RECORD TO BE MOVE/COPIED  */
*/*                                                                  */
*/*      SETNEW-                                                     */
*/*          DETERMINE THE NEW KEY OF THE FIRST RECORD THAT IS TO    */
*/*          BE MOVE/COPIED                                          */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          TERMNOER---TERMINATE W/O ERR MSG WHEN ATTN IS ISSUED    */
*/*                                                                  */
*/********************************************************************/
*OPERANDS:                                                         0188
*        PROC OPTIONS(NOSAVE);                                     0188
*                                                                  0188
OPERANDS DS    0H                                                  0189
*    RESPECIFY (GPR14P) RSTD;                                      0189
*    OPERAN14=GPR14P;               /* SAVE REGISTER 14              */
         ST    GPR14P,OPERAN14                                     0190
*    RESPECIFY (GPR14P) UNRSTD;                                    0191
*    IF CAOPERND = YES              /* ARE THERE OPERANDS TO PARSE   */
*      THEN                         /*   YES - WE HAVE OPERANDS      */
         TM    CAOPERND(COMMREG),B'10000000'                       0192
         BNO   @RF00192                                            0192
*        CALL PARSE;                /* PARSE THE OPERANDS            */
*                                                                  0193
         BAL   @14,PARSE                                           0193
*    IF STATUS = CONTINUE &         /* IF PARSE EXECUTED OK          */
*       CAATTNIS = YES              /* AND ATTENTION WAS HIT         */
*      THEN STATUS = TERMNOER;      /* TERMINATE WITHOUT MESSAGE     */
*                                                                  0194
@RF00192 LTR   STATUS,STATUS                                       0194
         BNZ   @RF00194                                            0194
         TM    CAATTNIS(COMMREG),B'01000000'                       0194
         BNO   @RF00194                                            0194
         LA    STATUS,32                                           0195
*    IF STATUS = CONTINUE           /* CAN WE CONTINUE FROM PARSE    */
*      THEN DO;                     /* GET VALUES FROM OPERANDS      */
@RF00194 LTR   STATUS,STATUS                                       0196
         BNZ   @RF00196                                            0196
*        CALL SETTYPE;              /* STRING OR LINENUM MOVE/COPY   */
*                                                                  0198
*                                                                  0198
         BAL   @14,SETTYPE                                         0198
*        IF STATUS = CONTINUE       /* CAN WE CONTINUE FROM SETTYPE  */
*          THEN DO;                 /* YES - GET FIRST, LAST AND NEW*/
         LTR   STATUS,STATUS                                       0199
         BNZ   @RF00199                                            0199
*            CALL SETFIRST;         /* GET VALUE FOR FIRST           */
*                                                                  0201
*                                                                  0201
         BAL   @14,SETFIRST                                        0201
*            IF STATUS = CONTINUE   /* CAN WE CONTINUE FROM SETFIRST */
*              THEN DO;             /* YES - GET LAST AND NEW        */
         LTR   STATUS,STATUS                                       0202
         BNZ   @RF00202                                            0202
*                CALL SETLAST;      /* GET VALUE FOR LAST            */
*                                                                  0204
*                                                                  0204
         BAL   @14,SETLAST                                         0204
*                IF STATUS = CONTINUE  /* CAN WE CONTINUE            */
*                  THEN             /* YES - WE CAN GET NEW          */
         LTR   STATUS,STATUS                                       0205
         BNZ   @RF00205                                            0205
*                    CALL SETNEW;   /* GET VALUE FOR NEW             */
         BAL   @14,SETNEW                                          0206
*                END;                                              0207
@RF00205 DS    0H                                                  0208
*            END;                                                  0208
@RF00202 DS    0H                                                  0209
*        END;                                                      0209
*                                                                  0209
@RF00199 DS    0H                                                  0210
*   RESPECIFY GPR14P RSTD;                                         0210
@RF00196 DS    0H                                                  0211
*   GPR14P=OPERAN14;                                               0211
         L     GPR14P,OPERAN14                                     0211
*   RESPECIFY (GPR14P) UNRSTD;                                     0212
*                                                                  0212
*END OPERANDS;                                                     0213
@EL00005 DS    0H                                                  0213
@EF00005 DS    0H                                                  0213
@ER00005 BR    @14                                                 0213
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          PARSE                                                   */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INVOKE PARSE TO SYNTAX CHECK THE OPERANDS               */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          SET UP THE PARSE PARAMETERS,INCLUDING THE VALIDITY      */
*/*          CHECK EXIT AND THEN USE CALLTSSR TO INVOKE PARSE.       */
*/*                                                                  */
*/*          IF ONLY TWO OPERANDS WERE ENTERED THEN THERE IS NO      */
*/*          THIRD PCE.IN THE 2-OPERAND CASE WE COPY PCE-2 TO PCE-3  */
*/*          AND THEN INDICATE THAT PCE-2 IS NOT PRESENT,I.E.NO      */
*/*          SECOND OPERAND BUT A THIRD OPERAND IS PRESENT.          */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          LINESTRG---BOTH LINE AND STRING VALUES WERE ENTERED     */
*/*          TERMNOER---RC=4=NOPROMPT,TERMINATE WITHOUT ERR MSG      */
*/*          PARSERR---RC>4 FROM PARSE.                              */
*/*                                                                  */
*/********************************************************************/
*PARSE:                                                            0214
*        PROC OPTIONS(NOSAVE);                                     0214
*                                                                  0214
PARSE    DS    0H                                                  0215
*    RESPECIFY (GPR14P) RSTD;                                      0215
*    PARSE14 = GPR14P;               /* SAVE REG 14                  */
         LR    PARSE14,GPR14P                                      0216
*    RESPECIFY (GPR14P) UNRSTD;                                    0217
*                                                                  0217
*    PPLPTR=ADDR(CATMPLST);         /* INITIALIZE PARSE PARMS        */
         LA    PPLPTR,CATMPLST(,COMMREG)                           0218
*    PPLPCL=ADDR(IKJEBE1);          /* ADDR OF MACRO CREATED PCL     */
         L     @06,@CV01317                                        0219
         ST    @06,PPLPCL(,PPLPTR)                                 0219
*    PPLANS=ADDR(CAPTPRSD);         /* PTR TO PTR OF PARSE RETURN PDL*/
         LA    @06,CAPTPRSD(,COMMREG)                              0220
         ST    @06,PPLANS(,PPLPTR)                                 0220
*    PPLCBUF=CAPTIBFR;              /* PTR TO INPUT BUFFER           */
         L     @06,CAPTIBFR(,COMMREG)                              0221
         ST    @06,PPLCBUF(,PPLPTR)                                0221
*    PPLUWA=ADDR(VALPARMS);         /* ADDR OF VALIDITY CK EXIT      */
*                                                                  0222
         LA    @06,VALPARMS                                        0222
         ST    @06,PPLUWA(,PPLPTR)                                 0222
*    RESPECIFY (GPR02P,GPR12P) RSTD;                               0223
*    STM(GPR02P,GPR12P,VALPARMS);   /* SAVE REGS FOR INCRCK          */
         STM   GPR02P,GPR12P,VALPARMS                              0224
*    RESPECIFY (GPR02P,GPR12P) UNRSTD;                             0225
*                                                                  0225
*    RESPECIFY (GPR15P) RSTD;                                      0226
*    DO; /*CALLTSSR EP(IKJPARS)MF(E,PPL)*/                         0227
*      RESPECIFY GPR01P RSTD;                                      0228
*      GPR01P = ADDR(PPL);                                         0229
         LR    GPR01P,PPLPTR                                       0229
*      IF CVTPARS = 0                                              0230
*        THEN                                                      0230
         L     @14,CVTPTR                                          0230
         L     @14,CVTPARS(,@14)                                   0230
         LTR   @14,@14                                             0230
         BNZ   @RF00230                                            0230
*          GEN(LINK EP=IKJPARS);                                   0231
         LINK EP=IKJPARS
*        ELSE                                                      0232
*          CALL CVTPARS;                                           0232
         B     @RC00230                                            0232
@RF00230 L     @06,CVTPTR                                          0232
         L     @15,CVTPARS(,@06)                                   0232
         BALR  @14,@15                                             0232
*      RESPECIFY GPR01P UNRSTD;                                    0233
@RC00230 DS    0H                                                  0234
*    END;                                                          0234
*    STATUS = GPR15P;                /* SAVE PARSE EXECUTION STATUS  */
         LR    STATUS,GPR15P                                       0235
*    RESPECIFY (GPR15P) UNRSTD;                                    0236
*                                                                  0236
*    IF STATUS = CONTINUE            /* PARSE FINISH OK              */
*      THEN DO;                      /*   YES- PARSE FINISHED OK     */
         LTR   STATUS,STATUS                                       0237
         BNZ   @RF00237                                            0237
*        PDLPTR = CAPTPRSD;          /* GET ADDR OF PDL              */
         L     PDLPTR,CAPTPRSD(,COMMREG)                           0239
*        GEN REFS(PDLPTR) (USING IKJPRMD1,PDLPTR); /* PDL ADDRESSING */
         USING IKJPRMD1,PDLPTR
*        IF FIRSTLF = YES &          /* LINE MOVE/COPY ...           */
*           FIRSTSF = YES            /* ... AND STRING MOVE/COPY     */
*          THEN STATUS = LINESTRG;   /* LINE & STRING MOVE/COPY      */
         TM    FIRSTLF,B'10000000'                                 0241
         BNO   @RF00241                                            0241
         TM    FIRSTSF,B'10000000'                                 0241
         BNO   @RF00241                                            0241
         L     STATUS,LINESTRG                                     0242
*          ELSE                      /* EVERYTHING IS STILL OK       */
*            IF LASTF = YES &        /* LAST VALUE ENTERED ...       */
*               NEWF = NO           /* ... NO NEW VALUE ENTERED    */
*              THEN DO;              /*   YES - BOTH NOT ENTERED     */
         B     @RC00241                                            0243
@RF00241 TM    LASTF,B'10000000'                                   0243
         BNO   @RF00243                                            0243
         TM    NEWF,B'10000000'                                    0243
         BNZ   @RF00243                                            0243
*                NEW = LAST;        /* NEW BECOMES LAST            */
         MVC   NEW(8),LAST                                         0245
*                LASTF = NO;         /* FORCE DEFAULT FOR LAST       */
         NI    LASTF,B'01111111'                                   0246
*                END;                                              0247
*        END;                                                      0248
*      ELSE                          /* NON ZERO CODE FROM PARSE     */
*        IF STATUS = NOPROMPT        /* TERM IN NO PROMPT MODE       */
*          THEN STATUS = TERMNOER;   /* TERMINATE WITHOUT ERR MSGS   */
         B     @RC00237                                            0249
@RF00237 C     STATUS,@CF00055                                     0249
         BNE   @RF00249                                            0249
         LA    STATUS,32                                           0250
*          ELSE PARSERR = YES;       /* INDICATE A PARSE ERROR       */
*                                                                  0251
         B     @RC00249                                            0251
@RF00249 OI    PARSERR,B'01000000'                                 0251
*    RESPECIFY (GPR14P) RSTD;                                      0252
@RC00249 DS    0H                                                  0252
@RC00237 DS    0H                                                  0253
*    GPR14P = PARSE14;               /* RESTORE REG 14               */
         LR    GPR14P,PARSE14                                      0253
*    RESPECIFY (GPR01P,GPR14P) UNRSTD;                             0254
*                                                                  0254
*END PARSE;                                                        0255
@EL00006 DS    0H                                                  0255
@EF00006 DS    0H                                                  0255
@ER00006 BR    @14                                                 0255
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETTYPE                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          DETERMINE WETHER WE HAVE A STRING OR LINENUM MOVE/COPY  */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*      TYPE=STRING-                                                */
*/*          COPY WITH NO OPERANDS                                   */
*/*          FIRST OPERAND=ASTERISK                                  */
*/*          FIRST OPERAND=A STRING                                  */
*/*                                                                  */
*/*      TYPE=LINENUM-                                               */
*/*          WHEN THE FIRST OPERAND IS A NUMBER                      */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          MSG52502--LINE NUMBER MOVE/COPY WITH NONUM DATA SET     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0256
*SETTYPE:                                                          0256
*        PROC OPTIONS(NOSAVE);                                     0256
*                                                                  0256
SETTYPE  DS    0H                                                  0257
*    RESPECIFY (GPR14P) RSTD;                                      0257
*    SETTYP14 = GPR14P;              /* SAVE REG 14                  */
         LR    SETTYP14,GPR14P                                     0258
*    RESPECIFY (GPR14P) UNRSTD;                                    0259
*                                                                  0259
*    STATUS = CONTINUE;              /* TENTATIVE CONTINUE STATUS    */
*                                                                  0260
         SLR   STATUS,STATUS                                       0260
*    IF CAOPERND = NO               /* COPY WITH NO OPERANDS        */
*                                                                  0261
*      (CAOPERND = YES &             /* DOES OPERANDS EXIST          */
*       FIRSTLF = YES &              /* IS FIRST A LINE              */
*       FIRSTVAL(1) = STAR)         /* IS VALUE FOR LINE A STAR     */
*                                                                  0261
*       FIRSTSF = YES                /* IS STRING ENTERED FOR 1ST OP */
*                                                                  0261
*      THEN                          /*   YES - STRING MOVE/COPY     */
         TM    CAOPERND(COMMREG),B'10000000'                       0261
         BZ    @RT00261                                            0261
         TM    CAOPERND(COMMREG),B'10000000'                       0261
         BNO   @GL00008                                            0261
         TM    FIRSTLF,B'10000000'                                 0261
         BNO   @GL00008                                            0261
         L     @08,FIRSTLP                                         0261
         CLI   FIRSTVAL(@08),C'*'                                  0261
         BE    @RT00261                                            0261
@GL00008 TM    FIRSTSF,B'10000000'                                 0261
         BNO   @RF00261                                            0261
@RT00261 DS    0H                                                  0262
*        TYPE = STRING;              /* THEN TYPE IS STRING          */
*                                                                  0262
         MVI   TYPE,X'03'                                          0262
*      ELSE                          /* NOT A STRING, MUST BE LINE   */
*        IF CANONUM = YES            /* IS IT A NONUM TYPE DATA SET  */
*          THEN                      /*   YES - LINENUM WITH NONUM   */
         B     @RC00261                                            0263
@RF00261 TM    CANONUM(COMMREG),B'00000001'                        0263
         BNO   @RF00263                                            0263
*            STATUS = MSG52502;      /* INDICATE ERROR IN STATUS     */
*                                                                  0264
         LH    STATUS,MSG52502                                     0264
*          ELSE                      /* WE HAVE A LINENUM MOVE/COPY  */
*            TYPE = LINENUM;         /* SET THE TYPE TO LINENUM      */
*                                                                  0265
         B     @RC00263                                            0265
@RF00263 MVI   TYPE,X'04'                                          0265
*    RESPECIFY (GPR14P) RSTD;                                      0266
@RC00263 DS    0H                                                  0266
@RC00261 DS    0H                                                  0267
*    GPR14P = SETTYP14;              /* RESTORE REG 14               */
         LR    GPR14P,SETTYP14                                     0267
*    RESPECIFY (GPR14P) UNRSTD;                                    0268
*                                                                  0268
*END SETTYPE;                                                      0269
@EL00007 DS    0H                                                  0269
@EF00007 DS    0H                                                  0269
@ER00007 BR    @14                                                 0269
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETFIRST                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          GET VALUE FOR THE FIRST LINE TO BE MOVE/COPIED          */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*      NO FIRST OPERAND-                                           */
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */
*/*                                                                  */
*/*      STRING ENTERED-                                             */
*/*          CALL IKJEBESE TO FIND THE STRING                        */
*/*                                                                  */
*/*      ASTERISK ENTERED-                                           */
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */
*/*                                                                  */
*/*      NUMBER ENTERED-                                             */
*/*          USE THE NUMBER ENTERED AS THE FIRST OPERAND             */
*/*                                                                  */
*/*          THE LINE ENTERED DOES NOT HAVE TO EXIST,IF IT DOES NOT  */
*/*          EXIST THEN USE THE NEXT GREATER KEY THAT DOES EXIST AS  */
*/*          THE FIRST LINE TO BE MOVED OR COPIED.                   */
*/*                                                                  */
*/*NOTES-                                                            */
*/*          DEFAULT IS SET IN INIT                                  */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          NOFIRST---NO RECORDS WITH KEY>=FIRSTKEY.                */
*/*          EUTERR---I/O ERROR INDICATIONS FROM IKJEBEUT.           */
*/*                                                                  */
*/********************************************************************/
*SETFIRST:                                                         0270
*        PROC OPTIONS(NOSAVE);                                     0270
*                                                                  0270
SETFIRST DS    0H                                                  0271
*   RESPECIFY (GPR14P) RSTD;                                       0271
*   SETFIR14 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,SETFIR14                                     0272
*   RESPECIFY (GPR14P) UNRSTD;                                     0273
*                                                                  0273
*   STATUS = CONTINUE;               /* INDICATE TENTATIVE CONTINUE  */
*                                                                  0274
         SLR   STATUS,STATUS                                       0274
*   IF CAOPERND = YES                /* ARE THERE OPERANDS           */
*     THEN                           /* YES: COULD BE LINE OR STRING */
         TM    CAOPERND(COMMREG),B'10000000'                       0275
         BNO   @RF00275                                            0275
*     IF FIRSTSF = YES               /* AND IS IT A STRING           */
*       THEN CALL IKJEBESE;          /* GET LINE NUMBER FROM EBESE   */
*                                                                  0276
         TM    FIRSTSF,B'10000000'                                 0276
         BNO   @RF00276                                            0276
         BAL   @14,IKJEBESE                                        0277
*       ELSE                         /* NO STRING ENTERED            */
*         IF FIRSTLF = YES &         /* IS THE FIRST ENTERED         */
*            FIRSTVAL(1) ^= STAR     /* AND VALUE IS A NUMBER        */
*           THEN DO;                 /* USE NUMBER ENTERED           */
         B     @RC00276                                            0278
@RF00276 TM    FIRSTLF,B'10000000'                                 0278
         BNO   @RF00278                                            0278
         L     @08,FIRSTLP                                         0278
         CLI   FIRSTVAL(@08),C'*'                                  0278
         BE    @RF00278                                            0278
*             PACKAREA = FOXZERO;    /* ZERO OUT THE FIELD           */
         MVC   PACKAREA(8),FOXZERO                                 0280
*             PACKAREA(9-FIRSTLL:8) =  /* MOVE INTO THE RIGHT SIDE...*/
*                 FIRSTVAL;          /* ...THE VALUE ENTERED         */
         LA    @03,9                                               0281
         SH    @03,FIRSTLL                                         0281
         LA    @01,PACKAREA-1(@03)                                 0281
         LCR   @03,@03                                             0281
         AL    @03,@CF00061                                        0281
         EX    @03,@SM01522                                        0281
*             PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED   */
         PACK  PACKAREA(8),PACKAREA(8)                             0282
*             CVB(FIRSTKEY,PACKAREA);  /* CONVERT: PACKED TO BINARY  */
         CVB   @08,PACKAREA                                        0283
         ST    @08,FIRSTKEY                                        0283
*             END;                                                 0284
*                                                                  0284
*    ORIGFRST = FIRSTKEY;            /* ORIGINAL VALUE AS ENTERED    */
*                                                                  0285
@RF00278 DS    0H                                                  0285
@RC00276 DS    0H                                                  0285
@RF00275 L     @08,FIRSTKEY                                        0285
         ST    @08,ORIGFRST                                        0285
*    IF CAOPERND = NO               /* IF NO OPERANDS WERE ENTERED  */
*       FIRSTSF = NO                 /* OR IF NO STRING WERE ENTERED */
*      THEN DO;                      /* SEE IF LINE EXISTS           */
         TM    CAOPERND(COMMREG),B'10000000'                       0286
         BZ    @RT00286                                            0286
         TM    FIRSTSF,B'10000000'                                 0286
         BNZ   @RF00286                                            0286
@RT00286 DS    0H                                                  0287
*        UTPARMP = ADDR(READPARM);   /* PARMS TO READ A KEY          */
         LA    UTPARMP,READPARM                                    0288
*        THEKEY = FIRSTKEY;          /* WANT TO READ KEY = FIRSTKEY  */
         L     @08,FIRSTKEY                                        0289
         ST    @08,THEKEY(,COMMREG)                                0289
*        CALL READ;                  /* SEE IF THE RECORD EXISTS     */
*                                                                  0290
         BAL   @14,READ                                            0290
*        IF STATUS = NORECORD        /* IF RECORD NOT FOUND          */
*          THEN DO;                  /* TRY READING THE NEXT ONE     */
         C     STATUS,@CF00055                                     0291
         BNE   @RF00291                                            0291
*            STATUS = CONTINUE;      /* RESET STATUS SO WE CAN GO ON */
         SLR   STATUS,STATUS                                       0293
*            UTPARMP = ADDR(READNEXT); /* PARMS TO READ NEXT RECORD  */
         LA    UTPARMP,READNEXT                                    0294
*            CALL READ;              /* READ NEXT RECORD             */
*                                                                  0295
         BAL   @14,READ                                            0295
*            IF STATUS = CONTINUE    /* DID WE GET NEXT RECORD       */
*              THEN FIRSTKEY = THEKEY; /* THEKEY = KEY OF NEXT REC   */
         LTR   STATUS,STATUS                                       0296
         BNZ   @RF00296                                            0296
         L     @08,THEKEY(,COMMREG)                                0297
         ST    @08,FIRSTKEY                                        0297
*              ELSE                  /* CHECK FOR NO RECORD FOUND    */
*                IF STATUS = NORECORD /* IF NO RECORD FOUND          */
*                  THEN STATUS = NOFIRST; /* NO-FIRST-RECORD ERROR   */
         B     @RC00296                                            0298
@RF00296 C     STATUS,@CF00055                                     0298
         BNE   @RF00298                                            0298
         L     STATUS,NOFIRST                                      0299
*            END;                                                  0300
@RF00298 DS    0H                                                  0300
@RC00296 DS    0H                                                  0301
*       END;                                                       0301
@RF00291 DS    0H                                                  0302
*   RESPECIFY GPR14P RSTD;                                         0302
@RF00286 DS    0H                                                  0303
*   GPR14P = SETFIR14;               /* RESTORE REG 14               */
         L     GPR14P,SETFIR14                                     0303
*   RESPECIFY (GPR14P) UNRSTD;                                     0304
*                                                                  0304
*END SETFIRST;                                                     0305
@EL00008 DS    0H                                                  0305
@EF00008 DS    0H                                                  0305
@ER00008 BR    @14                                                 0305
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETLAST                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          GET VALUE FOR THE LAST LINE TO BE MOVE/COPIED           */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*      NO SECOND OPERAND-                                          */
*/*          STRING TYPE---USE VALUE OF 1                            */
*/*          LINENUM TYPE---USE VALUE OF FIRSTKEY                    */
*/*                                                                  */
*/*      STRING TYPE-                                                */
*/*          SECOND OPERAND IS A COUNT OF N RECORDS TO BE            */
*/*          MOVE/COPIED.USE THE KEY OF THE NTH RECORD               */
*/*                                                                  */
*/*      LINENUM TYPE-                                               */
*/*          USE THE NUMBER ENTERED AS THE SECOND OPERAND            */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          BADLAST---ASTERISK IS NOT ALLOWED                       */
*/*          BADLAST---0 WITH A STRING MOVE/COPY IS NOT ALLOWED      */
*/*                                                                  */
*/********************************************************************/
*SETLAST:                                                          0306
*        PROC OPTIONS(NOSAVE);                                     0306
*                                                                  0306
SETLAST  DS    0H                                                  0307
*    RESPECIFY (GPR14P) RSTD;                                      0307
*    SETLAS14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,SETLAS14                                     0308
*    RESPECIFY (GPR14P) UNRSTD;                                    0309
*                                                                  0309
*    IF TYPE = STRING               /* IF THIS IS A STRING MOVE/COPY */
*      THEN LASTKEY = ONE;          /* THEN DEFAULT COUNT IS ONE     */
         CLI   TYPE,3                                              0310
         BNE   @RF00310                                            0310
         MVC   LASTKEY(4),@CF00063                                 0311
*      ELSE LASTKEY = FIRSTKEY;     /* DEFAULT FOR LAST LINE MOVED   */
*                                                                  0312
         B     @RC00310                                            0312
@RF00310 L     @08,FIRSTKEY                                        0312
         ST    @08,LASTKEY                                         0312
*    IF CAOPERND = YES &             /* ARE THERE OPERANDS           */
*       LASTF = YES                  /* AND WAS THE LAST ONE ENTERED */
*      THEN                          /*   YES - HAVE VALUE FOR LAST  */
@RC00310 TM    CAOPERND(COMMREG),B'10000000'                       0313
         BNO   @RF00313                                            0313
         TM    LASTF,B'10000000'                                   0313
         BNO   @RF00313                                            0313
*        IF LASTVAL(1) ^= STAR       /* IF VALUE IS A NUMBER         */
*          THEN DO;                  /* USE NUMBER ENTERED           */
         L     @08,LASTP                                           0314
         CLI   LASTVAL(@08),C'*'                                   0314
         BE    @RF00314                                            0314
*            PACKAREA = FOXZERO;     /* ZERO OUT THE FIELD           */
         MVC   PACKAREA(8),FOXZERO                                 0316
*            PACKAREA(9-LASTL:8) =   /* MOVE   INTO THE RIGHT SIDE...*/
*                LASTVAL;            /* ...THE VALUE ENTERED         */
         LA    @03,9                                               0317
         SH    @03,LASTL                                           0317
         LA    @01,PACKAREA-1(@03)                                 0317
         LCR   @03,@03                                             0317
         AL    @03,@CF00061                                        0317
         EX    @03,@SM01524                                        0317
*            PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED    */
         PACK  PACKAREA(8),PACKAREA(8)                             0318
*            CVB(LASTKEY,PACKAREA);    /* CONVERT: PACKED TO BINARY  */
         CVB   @08,PACKAREA                                        0319
         ST    @08,LASTKEY                                         0319
*            END;                                                  0320
*                                                                  0320
*          ELSE                      /* THE VALUE IS AN ASTERISK     */
*            STATUS = BADLAST2;      /* INDICATE AN ERROR            */
*                                                                  0321
         B     @RC00314                                            0321
@RF00314 L     STATUS,BADLAST2                                     0321
*    IF TYPE = STRING                /* IF STRING MOVE/COPY          */
*      THEN                          /*   YES - LASTKEY = A COUNT    */
@RC00314 DS    0H                                                  0322
@RF00313 CLI   TYPE,3                                              0322
         BNE   @RF00322                                            0322
*        IF LASTKEY > ONE            /* IS COUNT GREATER THAN ONE    */
*          THEN DO;                  /*   YES - GET KEY OF NTH LINE  */
         L     @08,LASTKEY                                         0323
         C     @08,@CF00063                                        0323
         BNH   @RF00323                                            0323
*            COUNT = LASTKEY;        /* SET COUNT FOR RELINENM       */
         ST    @08,COUNT                                           0325
*            THECOUNT = LASTKEY;     /* SAVE COUNT FOR NEWUTIL       */
         ST    @08,THECOUNT                                        0326
*            THEKEY = FIRSTKEY;      /* START FROM KEY = FIRSTKEY    */
*                                                                  0327
         L     @08,FIRSTKEY                                        0327
         ST    @08,THEKEY(,COMMREG)                                0327
*            CALL RELINENM;          /* FIND RELATIVE LINE NUMBER    */
*                                                                  0328
         BAL   @14,RELINENM                                        0328
*            IF STATUS = CONTINUE    /* IF STATUS IS OK              */
*              THEN LASTKEY = THEKEY;/* GET KEY OF NTH LINE          */
         LTR   STATUS,STATUS                                       0329
         BNZ   @RF00329                                            0329
         L     @08,THEKEY(,COMMREG)                                0330
         ST    @08,LASTKEY                                         0330
*            END;                                                  0331
*                                                                  0331
*          ELSE                      /* VALUE IS ONE OR ZERO         */
*            IF LASTKEY = ONE        /* RELATIVE LINE NUM OF ONE     */
*              THEN LASTKEY = FIRSTKEY; /* MOVE/COPY ONLY ONE LINE   */
         B     @RC00323                                            0332
@RF00323 CLC   LASTKEY(4),@CF00063                                 0332
         BNE   @RF00332                                            0332
         L     @08,FIRSTKEY                                        0333
         ST    @08,LASTKEY                                         0333
*              ELSE STATUS = BADLAST1; /* INDICATE BAD VALUE         */
*                                                                  0334
         B     @RC00332                                            0334
@RF00332 L     STATUS,BADLAST1                                     0334
*    RESPECIFY GPR14P RSTD;                                        0335
@RC00332 DS    0H                                                  0335
@RC00323 DS    0H                                                  0335
@RF00322 DS    0H                                                  0336
*    GPR14P = SETLAS14;              /* RESTORE REG 14               */
         L     GPR14P,SETLAS14                                     0336
*    RESPECIFY (GPR14P) UNRSTD;                                    0337
*                                                                  0337
*END SETLAST;                                                      0338
@EL00009 DS    0H                                                  0338
@EF00009 DS    0H                                                  0338
@ER00009 BR    @14                                                 0338
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETNEW PART 1                                           */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          NEWKEY IS WHERE THE LINES FROM FIRSTKEY TO LASTKEY      */
*/*          WILL BE MOVE/COPIED TO                                  */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*      NO THIRD OPERAND-                                           */
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */
*/*                                                                  */
*/*      NUMBER ENTERED-                                             */
*/*          FOR NONUM DS---THIRD OPERAND IS A COUNT OF N RECORDS    */
*/*          FROM THE BEGINNING OF THE DATASET.USE THE KEY OF THE    */
*/*          NTH RECORD.                                             */
*/*          FOR NUM DS---US THE NUMBER ENTERED                      */
*/*                                                                  */
*/*      ASTERISK ENTERED-                                           */
*/*          USE CURRENT LINE NUMBER--THE DEFAULT VALUE              */
*/*                                                                  */
*/*NOTES-                                                            */
*/*          DEFAULTS ARE SET IN INIT                                */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          LINERNG---THE NEW LINE IS BEWTEEN FIRST AND LAST LINES  */
*/*          EUTERR----I/O ERRORS PASSED ON FROM IKJEBEUT            */
*/*                                                                  */
*/********************************************************************/
*SETNEW:                                                           0339
*        PROC OPTIONS(NOSAVE);                                     0339
*                                                                  0339
SETNEW   DS    0H                                                  0340
*    RESPECIFY (GPR14P) RSTD;                                      0340
*    SETNEW14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,SETNEW14                                     0341
*    RESPECIFY (GPR14P) UNRSTD;                                    0342
*                                                                  0342
*    IF CAOPERND = YES   &           /* IF THERE ARE OPERANDS        */
*       NEWF = YES                  /* AND NEW WAS ENTERED  */     0343
*      THEN                                                        0343
         TM    CAOPERND(COMMREG),B'10000000'                       0343
         BNO   @RF00343                                            0343
         TM    NEWF,B'10000000'                                    0343
         BNO   @RF00343                                            0343
*        IF NEWVAL(1) ^= STAR       /* IF ASTERISK NOT ENTERED      */
*          THEN DO;                  /* GET VALUE ENTERED            */
         L     @08,NEWP                                            0344
         CLI   NEWVAL(@08),C'*'                                    0344
         BE    @RF00344                                            0344
*            PACKAREA = FOXZERO;     /* ZERO OUT THE FIELD           */
         MVC   PACKAREA(8),FOXZERO                                 0346
*            PACKAREA(9-NEWL:8) =    /* MOVE   INTO THE RIGHT SIDE...*/
*                NEWVAL;             /* ...THE VALUE ENTERED         */
         LA    @03,9                                               0347
         SH    @03,NEWL                                            0347
         LA    @01,PACKAREA-1(@03)                                 0347
         LCR   @03,@03                                             0347
         AL    @03,@CF00061                                        0347
         EX    @03,@SM01526                                        0347
*            PACK(PACKAREA,PACKAREA); /* CONVERT: ZONED TO PACKED    */
         PACK  PACKAREA(8),PACKAREA(8)                             0348
*            CVB(NEWKEY,PACKAREA);     /* CONVERT: PACKED TO BINARY  */
*                                                                  0349
         CVB   NEWKEY,PACKAREA                                     0349
*            IF CANONUM = YES &      /* IF NO LINE NUMBERS FOR DS    */
*               NEWKEY > ONE         /* AND NUMBER IS GREATER THAN 1 */
*              THEN DO;              /* GET KEY OF NTH LINE          */
         TM    CANONUM(COMMREG),B'00000001'                        0350
         BNO   @RF00350                                            0350
         C     NEWKEY,@CF00063                                     0350
         BNH   @RF00350                                            0350
*                COUNT = NEWKEY ;    /* N = NEWKEY                   */
         ST    NEWKEY,COUNT                                        0352
*                THEKEY = FIRSTREC;  /* NTH LINE AFTER FIRST RECORD  */
         L     @08,FIRSTREC                                        0353
         ST    @08,THEKEY(,COMMREG)                                0353
*                CALL RELINENM;      /* GET RELATIVE LINE NUMBER     */
*                                                                  0354
         BAL   @14,RELINENM                                        0354
*                IF STATUS = CONTINUE /* IF THE COUNTING WENT OK */
*                  THEN NEWKEY = THEKEY;/* USE KEY OF THE NTH LINE   */
         LTR   STATUS,STATUS                                       0355
         BNZ   @RF00355                                            0355
         L     NEWKEY,THEKEY(,COMMREG)                             0356
*                END;                                              0357
*                                                                  0357
*              ELSE                  /* VALUE IS ZERO OR ONE         */
*                IF CANONUM = YES &  /* IF NO LINE NUMBERS FOR DS    */
*                   NEWKEY = ONE     /* IS THE VALUE ONE             */
*                  THEN NEWKEY = FIRSTREC; /* MOVE AFTER FIRST LINE  */
         B     @RC00350                                            0358
@RF00350 TM    CANONUM(COMMREG),B'00000001'                        0358
         BNO   @RF00358                                            0358
         C     NEWKEY,@CF00063                                     0358
         BNE   @RF00358                                            0358
         L     NEWKEY,FIRSTREC                                     0359
*            END;                                                  0360
*                                                                  0360
*          ELSE                                                    0361
*            IF NEWKEY = ZERO  &     /* = 0 = CACURNUM               */
*               FIRSTLF = YES &      /* AND WAS LINE NUMBER ENTERED  */
*               FIRSTVAL(1) = STAR   /* BUT ENTERED AS ASTERISK      */
*              THEN NEWKEY = FIRSTREC; /* MOVE/COPY AFTER FIRST REC  */
         B     @RC00344                                            0361
@RF00344 LTR   NEWKEY,NEWKEY                                       0361
         BNZ   @RF00361                                            0361
         TM    FIRSTLF,B'10000000'                                 0361
         BNO   @RF00361                                            0361
         L     @08,FIRSTLP                                         0361
         CLI   FIRSTVAL(@08),C'*'                                  0361
         BNE   @RF00361                                            0361
         L     NEWKEY,FIRSTREC                                     0362
*              ELSE;                 /* NULL ELSE FOR THIS IF        */
@RF00361 DS    0H                                                  0364
*      ELSE                          /* NO OPERANDS OR NO NEW KEY    */
*        IF NEWKEY = ZERO            /* AND CACURNUM = ZERO = NEWKEY */
*          THEN NEWKEY = FIRSTREC;   /* MOVE/COPY AFTER FIRST LINE   */
         B     @RC00343                                            0364
@RF00343 LTR   NEWKEY,NEWKEY                                       0364
         BNZ   @RF00364                                            0364
         L     NEWKEY,FIRSTREC                                     0365
*          ELSE;                     /* JUST A NULL ELSE             */
@RF00364 DS    0H                                                  0367
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETNEW PART 2                                           */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          CALL SETLIMIT TO GET A VALUE FOR THE LIMIT OF THE       */
*/*          MOVE/COPY                                               */
*/*                                                                  */
*/*          IF THERE IS A RECORD WITH KEY=NEWKEY THEN THE VALUE     */
*/*          FOR INSRTKEY IS NEWKEY AND NEWKEY IS INCREMENTED BY     */
*/*          THEINCR.                                                */
*/*                                                                  */
*/*          IF THE RECORD DOES NOT EXIST THEN WE CAN USE NEWKEY AS  */
*/*          THE KEY OF THE FIRST LINE MOVE/COPIED AND THE VALUE     */
*/*          FOR INSRTKEY IS THE KEY OF THE RECORD PREVIOUS TO THE   */
*/*          KEY OF NEWKEY                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0367
*    IF STATUS = CONTINUE &          /* IF NO ERRORS SO FAR          */
*       FIRSTKEY =< NEWKEY  &        /* IS NEW BETWEEN FIRST */    0367
*       NEWKEY  < LASTKEY            /* AND LAST RECORD              */
*      THEN STATUS = LINERNG;        /* THEN WE HAVE LINE RANGE ERROR*/
*                                                                  0367
@RC00343 LTR   STATUS,STATUS                                       0367
         BNZ   @RF00367                                            0367
         C     NEWKEY,FIRSTKEY                                     0367
         BL    @RF00367                                            0367
         C     NEWKEY,LASTKEY                                      0367
         BNL   @RF00367                                            0367
         L     STATUS,LINERNG                                      0368
*      ELSE DO;                      /* NOT MOVING WITHIN THE RANGE  */
         B     @RC00367                                            0369
@RF00367 DS    0H                                                  0370
*        CALL SETLIMIT;              /* SET LIMIT FOR MOVE/COPY      */
*                                                                  0370
         BAL   @14,SETLIMIT                                        0370
*        UTPARMP = ADDR(READPARM);   /*  WANT TO READ SPECIFIC KEY   */
         LA    UTPARMP,READPARM                                    0371
*        THEKEY = NEWKEY ;           /* THEKEY = NEWKEY              */
         ST    NEWKEY,THEKEY(,COMMREG)                             0372
*        CALL READ;                  /* READ THE KEY                 */
*                                                                  0373
         BAL   @14,READ                                            0373
*        IF STATUS = CONTINUE        /* IF THE RECORD EXISTS         */
*          THEN DO;                  /* THERE IS RECORD WITH THE KEY */
         LTR   STATUS,STATUS                                       0374
         BNZ   @RF00374                                            0374
*            INSRTKEY = NEWKEY;      /* FOR DATAEXIT, INSERT AFTER   */
         ST    NEWKEY,INSRTKEY                                     0376
*            NEWKEY = NEWKEY + THEINCR; /* CALCULATE NEW NEWKEY      */
         AL    NEWKEY,THEINCR                                      0377
*            END;                                                  0378
*                                                                  0378
*          ELSE                      /* MAYBE I/O ERROR OR NO RECORD */
*            IF STATUS = NORECORD    /* IF THE RECORD DOESN'T EXIST  */
*              THEN DO;              /* NO RECORD WITH KEY=NEWKEY    */
         B     @RC00374                                            0379
@RF00374 C     STATUS,@CF00055                                     0379
         BNE   @RF00379                                            0379
*                STATUS = CONTINUE;  /* RESET STATUS TO CONTINUE     */
*                                                                  0381
         SLR   STATUS,STATUS                                       0381
*                UTPARMP = ADDR(READPREV); /* WANT TO GET PREVIOUS   */
         LA    UTPARMP,READPREV                                    0382
*                THEKEY = NEWKEY;          /* PREVIOUS TO NEWKEY     */
         ST    NEWKEY,THEKEY(,COMMREG)                             0383
*                CALL READ;                /* GET PREVIOUS RECORD    */
         BAL   @14,READ                                            0384
*                INSRTKEY = THEKEY;        /* FOR DATAEXIT, INSERT PT*/
*                                                                  0385
         L     @08,THEKEY(,COMMREG)                                0385
         ST    @08,INSRTKEY                                        0385
*                IF STATUS = NORECORD      /* NO PREVIOUS RECORD     */
*                  THEN DO;                /* I.E. AT TOP OF DS      */
         C     STATUS,@CF00055                                     0386
         BNE   @RF00386                                            0386
*                    STATUS = CONTINUE;    /* RESET CONTINUE STATUS  */
         SLR   STATUS,STATUS                                       0388
*                    INSRTKEY = ZERO;      /* INDICATE TOP OF DS     */
         SLR   @08,@08                                             0389
         ST    @08,INSRTKEY                                        0389
*                    END;                                          0390
*               END;                                               0391
@RF00386 DS    0H                                                  0392
*        END;                                                      0392
*                                                                  0392
@RF00379 DS    0H                                                  0392
@RC00374 DS    0H                                                  0393
*   RESPECIFY GPR14P RSTD;                                         0393
@RC00367 DS    0H                                                  0394
*   GPR14P = SETNEW14;               /* RESTORE REG 14               */
         L     GPR14P,SETNEW14                                     0394
*   RESPECIFY (GPR14P) UNRSTD;                                     0395
*                                                                  0395
*END SETNEW;                                                       0396
@EL00010 DS    0H                                                  0396
@EF00010 DS    0H                                                  0396
@ER00010 BR    @14                                                 0396
*/********************************************************************/
*/*                                                                  */
*/*SETLIMIT-                                                         */
*/*          SETLIMIT                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          DETERMINE THE LIMIT FOR THE MOVE/COPY.IN OTHER WORDS    */
*/*          FIND THE KEY FOR THE RECORD BEFORE WHICH ALL LINES ARE  */
*/*          TO BE MOVE/COPIED.                                      */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF A LINENUMBER WAS ENTERED FOR THE FIRST LINE TO BE    */
*/*          MOVE/COPIED AND WE ARE TRYING TO MOVE/COPY TO THE THE   */
*/*          TOP OF THE DATASET THEN THE LIMIT IS LINE ZERO.THE TOP  */
*/*          OF THE DATASET,I.E.BEFORE THE FIRST LINE,IS WHEN AN     */
*/*          ASTERISK WAS ENTERED AND THE CURRENT LINE POINTER IS    */
*/*          ZERO.                                                   */
*/*                                                                  */
*/*          IF A RECORD EXISTS AFTER THE RECORD WHOSE KEY=NEWKEY    */
*/*          THEN THE KEY OF THE THAT RECORD IS THE LIMIT FOR THE    */
*/*          MOVE/COPY:                                              */
*/*                                                                  */
*/*          IF THERE ARE NO RECORDS AFTER THE RECORD WHOSE          */
*/*          KEY=NEWKEY THEN THE LIMIT IS END OF FILE,I.E.THERE IS   */
*/*          NO LIMIT.                                               */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          THERE ARE NO ERRORS SET IN SETLIMIT BUT SOME MAY BE     */
*/*          PASSED ON FROM IKJEBEUT TO SETNEW                       */
*/*                                                                  */
*/********************************************************************/
*SETLIMIT:                                                         0397
*        PROC OPTIONS(NOSAVE);                                     0397
*                                                                  0397
SETLIMIT DS    0H                                                  0398
*    RESPECIFY (GPR14P) RSTD;                                      0398
*    SETLIM14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,SETLIM14                                     0399
*    RESPECIFY (GPR14P) UNRSTD;                                    0400
*                                                                  0400
*    IF (CANONUM = YES &             /* IF NON LINE NUMBERED DS      */
*        NEWKEY = ZERO)             /* RELATIVE LINE # IS ZERP      */
*                                                                  0401
*       (CAOPERND = YES &            /* IF THERE ARE OPERANDS        */
*       NEWKEY      = ZERO &         /* MOVE/COPY TO LINE 0          */
*       NEWF = YES &                 /* AND VALUE WAS ENTERED        */
*       NEWVAL(1) = STAR&            /* '*' = CACURNUM = 0           */
*       FIRSTLF = YES &              /* AND LINE VALUE WAS ENTERED   */
*       FIRSTVAL(1) ^= '*')          /* AND NOT MOVE/COPY FROM STAR  */
*     THEN LIMITKEY = FIRSTREC;      /* WILL MOVE/COPY BEFORE FIRST  */
*                                                                  0401
         TM    CANONUM(COMMREG),B'00000001'                        0401
         BNO   @GL00022                                            0401
         LTR   NEWKEY,NEWKEY                                       0401
         BZ    @RT00401                                            0401
@GL00022 TM    CAOPERND(COMMREG),B'10000000'                       0401
         BNO   @RF00401                                            0401
         LTR   NEWKEY,NEWKEY                                       0401
         BNZ   @RF00401                                            0401
         TM    NEWF,B'10000000'                                    0401
         BNO   @RF00401                                            0401
         L     @08,NEWP                                            0401
         CLI   NEWVAL(@08),C'*'                                    0401
         BNE   @RF00401                                            0401
         TM    FIRSTLF,B'10000000'                                 0401
         BNO   @RF00401                                            0401
         L     @08,FIRSTLP                                         0401
         CLI   FIRSTVAL(@08),C'*'                                  0401
         BE    @RF00401                                            0401
@RT00401 DS    0H                                                  0402
         L     @08,FIRSTREC                                        0402
         ST    @08,LIMITKEY                                        0402
*     ELSE DO;                       /* FIND NEXT AFTER NEWKEY       */
         B     @RC00401                                            0403
@RF00401 DS    0H                                                  0404
*       UTPARMP = ADDR(READNEXT);    /* READ NEXT AFTER NEWKEY       */
         LA    UTPARMP,READNEXT                                    0404
*       THEKEY = NEWKEY ;            /* WANT KEY AFTER KEY = NEWKEY  */
         ST    NEWKEY,THEKEY(,COMMREG)                             0405
*       CALL READ;                   /* READ THE NEXT RECORD         */
*                                                                  0406
         BAL   @14,READ                                            0406
*       IF STATUS = CONTINUE         /* IF WE FOUND REC AFTER NEWKEY */
*         THEN LIMITKEY = THEKEY;    /* THEN THIS IS KEY IS NEW LIMIT*/
*                                                                  0407
         LTR   STATUS,STATUS                                       0407
         BNZ   @RF00407                                            0407
         L     @08,THEKEY(,COMMREG)                                0408
         ST    @08,LIMITKEY                                        0408
*         ELSE                       /* NON CONTINUE FROM IKJEBEUT   */
*           IF STATUS = NORECORD     /* IF NO RECORD I.E. EOF        */
*             THEN DO;               /* LIMIT WILL BE END OF FILE    */
         B     @RC00407                                            0409
@RF00407 C     STATUS,@CF00055                                     0409
         BNE   @RF00409                                            0409
*               STATUS = CONTINUE;   /* WE CAN CONTINUE              */
         SLR   STATUS,STATUS                                       0411
*               LIMITKEY = EOF;      /* LIMIT IS END OF FILE         */
         MVC   LIMITKEY(4),@CF01325                                0412
*               END;                                               0413
*         END;                                                     0414
*                                                                  0414
@RF00409 DS    0H                                                  0414
@RC00407 DS    0H                                                  0415
*    RESPECIFY (GPR14P) RSTD;                                      0415
@RC00401 DS    0H                                                  0416
*    GPR14P = SETLIM14;              /* RESTORE REG 14               */
         L     GPR14P,SETLIM14                                     0416
*    RESPECIFY (GPR14P) UNRSTD;                                    0417
*                                                                  0417
*END SETLIMIT;                                                     0418
@EL00011 DS    0H                                                  0418
@EF00011 DS    0H                                                  0418
@ER00011 BR    @14                                                 0418
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          MOVE/COPY PART 1                                        */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          DO THE MOVE OR COPY                                     */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          READ THE FIRST LINE TO BE MOVED OR COPIED.IT HAS A KEY  */
*/*          OF OLDKEY.ENTER THE WRITE-DELETE-READ LOOP              */
*/*                                                                  */
*/*          WRITE THE LINE WITH A KEY OF NEWKEY.FOR A MOVE DELETE   */
*/*          THE LINE WITH THE KEY OF OLDKEY.READ THE NEXT LINE      */
*/*          AFTER THE LINE WITH THE KEY OF OLDKEY.UPDATE THE        */
*/*          VARIABLE OF OLDKEY WITH THEKEY OF THE NEXT RECORD.      */
*/*          UPDATE NEWKEY BY THEINCR.                               */
*/*                                                                  */
*/*          AFTER THE LOOP THE KEY TO BE VERIFIED IS THE NEWKEY     */
*/*          DECREMENTED BY THEINCR BECAUSE THE VARIABLE OF NEWKEY   */
*/*          IS INCREMENTED AND EXTRA TIME.                          */
*/*                                                                  */
*/*LOOP TERMINATION-                                                 */
*/*          NORMAL END---CONTINUE STATUS                            */
*/*          NEWUTIL----WANTED TO MOVE PAST THE LIMIT                */
*/*          NON-CONTINUE----BAD RETURN CODE FROM IKJEBEUT           */
*/*          CAATTNIS----ATTENTION IS ISSUED                         */
*/*                                                                  */
*/********************************************************************/
*MOVECOPY:                                                         0419
*        PROC;                                                     0419
*                                                                  0419
MOVECOPY STM   @14,@05,@SA00012                                    0419
         STM   @07,@12,@SA00012+32                                 0419
*    OLDKEY = FIRSTKEY;              /* KEY TO BE MOVE/COPIED        */
         L     OLDKEY,FIRSTKEY                                     0420
*    UTPARMP = ADDR(READPARM);       /* READ A SPECIFIC KEY          */
         LA    UTPARMP,READPARM                                    0421
*    THEKEY = OLDKEY;                /* THE KEY WE WANT TO READ      */
         ST    OLDKEY,THEKEY(,COMMREG)                             0422
*    CALL READ;                      /* READ THE FIRST RECORD        */
*                                                                  0423
         BAL   @14,READ                                            0423
*    DO WHILE STATUS = CONTINUE &    /* AS LONG AS WE CAN CONTINUE   */
*             NEWKEY  < LIMITKEY &   /* AND HAVE NOT PASSED OUR LIMIT*/
*             OLDKEY =< LASTKEY &    /* THEKEY STILL IN THE RANGE    */
*             CAATTNIS = NO;         /* ATTENTION NOT ISSUED         */
*                                                                  0424
         B     @DE00424                                            0424
@DL00424 DS    0H                                                  0425
*      UTPARMP = ADDR(WRITEREC);     /* WRITE TOTHEKEY = NEWKEY      */
         LA    UTPARMP,WRITEREC                                    0425
*      THEKEY = NEWKEY;              /* WRITE WITH A NEW KEY         */
         ST    NEWKEY,THEKEY(,COMMREG)                             0426
*      CALL WRITE;                   /* CALL IKJEBEUT FOR THE WRITE  */
*                                                                  0427
         BAL   @14,WRITE                                           0427
*      IF COMMAND = MOVE             /* IS THIS A MOVE               */
*        THEN                        /*   YES - MOVE IMPLIES DELETE  */
         CLI   COMMAND,1                                           0428
         BNE   @RF00428                                            0428
*          CALL DELETREC;            /* THEN DELETE THE OLD KEY      */
*                                                                  0429
         BAL   @14,DELETREC                                        0429
*      UTPARMP = ADDR(READNEXT);     /* READNEXT AFTER FIRSTKEY      */
@RF00428 LA    UTPARMP,READNEXT                                    0430
*      THEKEY = OLDKEY;              /* READ NEXT AFTER THE OLD KEY  */
         ST    OLDKEY,THEKEY(,COMMREG)                             0431
*      CALL READ;                    /* READ THE NEXT RECORD         */
         BAL   @14,READ                                            0432
*      OLDKEY = THEKEY;              /* THE NEXT KEY FOR MOVE/COPY   */
*                                                                  0433
         L     OLDKEY,THEKEY(,COMMREG)                             0433
*      NEWKEY  = NEWKEY  + THEINCR;  /* NEW KEY FOR RECORD JUST READ */
         AL    NEWKEY,THEINCR                                      0434
*    END;                                                          0435
*                                                                  0435
@DE00424 LTR   STATUS,STATUS                                       0435
         BNZ   @DC00424                                            0435
         C     NEWKEY,LIMITKEY                                     0435
         BNL   @DC00424                                            0435
         C     OLDKEY,LASTKEY                                      0435
         BH    @DC00424                                            0435
         TM    CAATTNIS(COMMREG),B'01000000'                       0435
         BZ    @DL00424                                            0435
@DC00424 DS    0H                                                  0436
*    VERIFY = NEWKEY  - THEINCR;     /* VERIFY LAST LINE WRITTEN     */
         LR    @03,NEWKEY                                          0436
         SL    @03,THEINCR                                         0436
         ST    @03,VERIFY                                          0436
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          MOVE/COPY PART 2                                        */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          CHECK FOR ERRORS                                        */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF ATTENTION WAS ISSUED THEN TERMINATE WITHOUT AN       */
*/*          ERROR MSG                                               */
*/*                                                                  */
*/*          IF THERE ARE STILL MORE LINES TO MOVE/COPY BUT WE HAVE  */
*/*          PASSED OUR LIMIT THEN WE HAVE TO BUILD A NEW UTILITY    */
*/*          DATASET                                                 */
*/*                                                                  */
*/*          IF THE LAST KEY FOR THE MOVE/COPY IS LESS THAN THE      */
*/*          ORIGINAL VALUE FOR THE FIRST KEY WE HAVE AN ERROR       */
*/*                                                                  */
*/*          IF THE ORIGINAL VALUE FOR THE FIRST KEY DID NOT EXIST   */
*/*          BUT FALLS BEFORE AN EXISTING KEY=X,THEN IF THE LAST     */
*/*          KEY IS LESS THAN THIS NEW FIRSTKEY=X THEN WE HAVE AN    */
*/*          ERROR.                                                  */
*/*                                                                  */
*/*          IF STATUS=NORECORD THEN WE GOT A NO RECORD FOUND        */
*/*          INDICATION FROM IKJEBEUT.WE ARE THERE FORE FINISHED,I.  */
*/*          E.THERE WAS NO RECORD AFTER THE LAST RECORD TO BE       */
*/*          MOVE/COPIED.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0437
*   IF CAATTNIS = YES                /* WAS ATTENTION ISSUED         */
*     THEN STATUS = TERMNOER;        /* TERMINATE W/O ERR MSG        */
*                                                                  0437
         TM    CAATTNIS(COMMREG),B'01000000'                       0437
         BNO   @RF00437                                            0437
         LA    STATUS,32                                           0438
*     ELSE                           /* CHECK FOR ANY ERRORS         */
*     IF STATUS = CONTINUE           /* IKJEBEUT EXECUTE OK AND ...  */
*       THEN                                                       0439
         B     @RC00437                                            0439
@RF00437 LTR   STATUS,STATUS                                       0439
         BNZ   @RF00439                                            0439
*       IF OLDKEY =< LASTKEY &       /* STILL HAVE MORE TO MOVE/COPY */
*          NEWKEY >= LIMITKEY        /* ... WE HAVE GONE PAST LIMIT  */
*         THEN                       /* HAVE TO BUILD A NEW UTILITY DS*
         C     OLDKEY,LASTKEY                                      0440
         BH    @RF00440                                            0440
         C     NEWKEY,LIMITKEY                                     0440
         BL    @RF00440                                            0440
*           CALL NEWUTIL;            /* BUILD THE NEW UTILITY DS     */
*                                                                  0441
         BAL   @14,NEWUTIL                                         0441
*         ELSE                       /* CHECK FOR SOME ERRORS        */
*         IF LASTKEY < ORIGFRST      /* LAST < FIRST AS ENTERED      */
*           THEN STATUS = BADEND;    /* INDICATE LASTKEY < FIRSTKEY  */
*                                                                  0442
         B     @RC00440                                            0442
@RF00440 CLC   LASTKEY(4),ORIGFRST                                 0442
         BNL   @RF00442                                            0442
         L     STATUS,BADEND                                       0443
*           ELSE                     /* CHECK FOR NO LINES IN RANGE  */
*           IF LASTKEY < FIRSTKEY    /* LAST < ACTUAL FIRST LINE     */
*             THEN STATUS = MSG52578; /* NO LINES IN RANGE MESSAGE   */
         B     @RC00442                                            0444
@RF00442 CLC   LASTKEY(4),FIRSTKEY                                 0444
         BNL   @RF00444                                            0444
         LH    STATUS,MSG52578                                     0445
*             ELSE;                  /* A NECESSAR NULL ELSE         */
*                                                                  0446
@RF00444 DS    0H                                                  0447
*       ELSE                         /* WE DID NOT BYPASS OUR LIMIT  */
*       IF STATUS = NORECORD         /* NO RECORD FOUND VIA READ NEXT*/
*         THEN STATUS = CONTINUE;    /* THEN RESET TO CONTINUE STATUS*/
*                                                                  0447
*                                                                  0447
         B     @RC00439                                            0447
@RF00439 C     STATUS,@CF00055                                     0447
         BNE   @RF00447                                            0447
         SLR   STATUS,STATUS                                       0448
*END MOVECOPY;                                                     0449
@EL00012 DS    0H                                                  0449
@EF00012 DS    0H                                                  0449
@ER00012 LM    @14,@05,@SA00012                                    0449
         LM    @07,@12,@SA00012+32                                 0449
         BR    @14                                                 0449
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          DELETREC                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          FOR THE MOVE COMMAND TO DELETE THE RECORD FROM ITS      */
*/*          ORIGINAL LOCATION                                       */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          WE WILL DELETE THE OLD KEY BY CALLING DELETE.           */
*/*          IF THE KEY WE DELETE WAS OUR LIMIT KEY THEN WE WILL     */
*/*          GET A NEW LIMIT KEY.                                    */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          EUTERR----I/O ERRORS PASSED ON FROM IKJEBEUT            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0450
*DELETREC:                                                         0450
*        PROC OPTIONS(NOSAVE);                                     0450
*                                                                  0450
DELETREC DS    0H                                                  0451
*    RESPECIFY (GPR14P) RSTD;                                      0451
*    DELETR14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,DELETR14                                     0452
*    RESPECIFY (GPR14P) UNRSTD;                                    0453
*                                                                  0453
*    UTPARMP = ADDR(DELETKEY);       /* PARMS TO DELETE A KEY        */
         LA    UTPARMP,DELETKEY                                    0454
*    THEKEY = OLDKEY;                /* THE KEY TO BE DELETED        */
         ST    OLDKEY,THEKEY(,COMMREG)                             0455
*    CALL DELETE;                    /* DELETE THE KEY               */
*                                                                  0456
         BAL   @14,DELETE                                          0456
*    IF STATUS = CONTINUE &          /* CAN WE CONTINUE              */
*       OLDKEY = LIMITKEY            /* AND WAS LIMITKEY DELETED     */
*      THEN DO;                      /* GET NEW LIMIT KEY            */
         LTR   STATUS,STATUS                                       0457
         BNZ   @RF00457                                            0457
         L     @03,LIMITKEY                                        0457
         CR    OLDKEY,@03                                          0457
         BNE   @RF00457                                            0457
*        UTPARMP = ADDR(READNEXT);   /* PARMS TO READ NEXT RECORD    */
         LA    UTPARMP,READNEXT                                    0459
*        THEKEY = LIMITKEY;          /* READ NEXT AFTEROLD LIMIT     */
         ST    @03,THEKEY(,COMMREG)                                0460
*        CALL READ;                  /* READ NEW LIMIT               */
*                                                                  0461
         BAL   @14,READ                                            0461
*        IF STATUS = CONTINUE        /* IF STATUS IS OK              */
*          THEN LIMITKEY = THEKEY;   /* SET NEW VALUE FRO LIMIT      */
*                                                                  0462
         LTR   STATUS,STATUS                                       0462
         BNZ   @RF00462                                            0462
         L     @03,THEKEY(,COMMREG)                                0463
         ST    @03,LIMITKEY                                        0463
*          ELSE                      /* MAYBE ITS END OF FILE        */
*            IF STATUS = NORECORD    /* IF NO RECORD AFTER OLD LIMIT */
*              THEN DO;              /* THEN LIMIT WILL BE EOF       */
         B     @RC00462                                            0464
@RF00462 C     STATUS,@CF00055                                     0464
         BNE   @RF00464                                            0464
*                STATUS = CONTINUE;  /* RESET A CONTINUE STATUS      */
         SLR   STATUS,STATUS                                       0466
*                LIMITKEY = EOF;     /* INDICATE END OF FILE         */
         MVC   LIMITKEY(4),@CF01325                                0467
*                END;                                              0468
*        END;                                                      0469
*                                                                  0469
@RF00464 DS    0H                                                  0469
@RC00462 DS    0H                                                  0470
*    RESPECIFY (GPR14P) RSTD;                                      0470
@RF00457 DS    0H                                                  0471
*    GPR14P = DELETR14;              /* RESTORE REG 14               */
         L     GPR14P,DELETR14                                     0471
*    RESPECIFY (GPR14P) UNRSTD;                                    0472
*                                                                  0472
*END DELETREC;                                                     0473
@EL00013 DS    0H                                                  0473
@EF00013 DS    0H                                                  0473
@ER00013 BR    @14                                                 0473
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          NEWUTIL                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          ALLOCATE A SECONDARY DATASET SO MOVE/COPY CAN REBUILD   */
*/*          THE CURRENT DATASET BECAUSE THE RANGE OF LINES WOULD    */
*/*          NOT FIT BEFORE THE LIMITKEY                             */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          CALCULATE THE NUMBER OF ADDITIONAL RECORDS NEEDED FOR   */
*/*          THE SECONDARY DATASET.INVOKE IKJEBEUI TO ALLOCATE THE   */
*/*          SECONDARY DATASET                                       */
*/*                                                                  */
*/*          INITIALIZE THE PARAMETER LIST FOR IKJEBEUT THAT WILL    */
*/*          BE USED TO WRITE SEQUENTIALLY TO THE SECONDARY DATASET. */
*/*                                                                  */
*/*          STEPS 1 THRU 3 ARE USED IN REBUILDING THE CURRENT DATA  */
*/*          SET AND PERFORMING THE MOVE/COPY IN THE SECONDARY       */
*/*          DATASET                                                 */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          TERMNOER---NON ZERO RETURN CODE FROM IKJEBEUI           */
*/*                                                                  */
*/********************************************************************/
*NEWUTIL:                                                          0474
*        PROC OPTIONS(NOSAVE);                                     0474
*                                                                  0474
NEWUTIL  DS    0H                                                  0475
*    RESPECIFY GPR14P RSTD;                                        0475
*    NEWUTI14=GPR14P;               /* UIPLIST IS A DUMMY FIELD NOT  */
         ST    GPR14P,NEWUTI14                                     0476
*    RESPECIFY GPR14P UNRSTD;                                      0477
*                                                                  0477
*    IF TYPE = STRING                /* IF TYPE IS STRING MOVE/COPY  */
*     THEN CARECNO = THECOUNT;       /* THE NUMBER OF ADDITIONAL RECS*/
*                                                                  0478
         CLI   TYPE,3                                              0478
         BNE   @RF00478                                            0478
         L     @06,THECOUNT                                        0479
         ST    @06,CARECNO(,COMMREG)                               0479
*     ELSE                           /* TYPE IS A LINENUM MOVE/COPY  */
*       IF CAUTILNO <                /* PRESENT SIZE OF UTILITY DS   */
*             (LASTKEY - FIRSTKEY)   /* COMPARED WITH LAST-FIRST     */
*         THEN CARECNO = CAUTILNO;   /* WILL TAKE WHICH EVER VALUE...*/
         B     @RC00478                                            0480
@RF00478 L     @06,CAUTILNO(,COMMREG)                              0480
         L     @03,LASTKEY                                         0480
         SL    @03,FIRSTKEY                                        0480
         CR    @06,@03                                             0480
         BNL   @RF00480                                            0480
         ST    @06,CARECNO(,COMMREG)                               0481
*         ELSE CARECNO = LASTKEY - FIRSTKEY; /* ... IS THE SMALLEST  */
*                                                                  0482
         B     @RC00480                                            0482
@RF00480 L     @06,LASTKEY                                         0482
         SL    @06,FIRSTKEY                                        0482
         ST    @06,CARECNO(,COMMREG)                               0482
*    RESPECIFY (GPR00P,GPR15P) RSTD;                               0483
@RC00480 DS    0H                                                  0483
@RC00478 DS    0H                                                  0484
*    GEN REFS(COMMREG)                                             0484
*      (IKJEBESH (COMMREG),IKJEBEUI,PARAM=((COMMREG)),MF=(E,A));   0484
         IKJEBESH (COMMREG),IKJEBEUI,PARAM=((COMMREG)),MF=(E,A)
*    STATUS = GPR15P;                /* GET ALLOC STATUS             */
         LR    STATUS,GPR15P                                       0485
*    CAPTPDCB = GPR00P;              /* GET NEW DCB ADDRESS          */
         ST    GPR00P,CAPTPDCB(,COMMREG)                           0486
*    RESPECIFY (GPR00P,GPR15P) UNRSTD;                             0487
*                                                                  0487
*    UTPARMP = ADDR(WRITESEQ);       /* PARMS TO WRITE SEQUENTIALLY  */
         LA    UTPARMP,WRITESEQ                                    0488
*    UTCODE = CAUTWRTS;              /* CODE TO WRITE SEQUENTIALLY   */
         MVI   UTCODE(UTPARMP),X'21'                               0489
*    UTDCBPTR = CAPTPDCB;            /* NEW DATASET DCB              */
         L     @05,CAPTPDCB(,COMMREG)                              0490
         STCM  @05,7,UTDCBPTR(UTPARMP)                             0490
*    UTKEYPTR = ADDR(THEBUFFR);      /* WRITE THEBUFFR WITH THIS KEY */
         LA    @05,THEBUFFR(,COMMREG)                              0491
         ST    @05,UTKEYPTR(,UTPARMP)                              0491
*    UTEOL2 = YES;                   /* INDICATE END OF LIST         */
*                                                                  0492
         OI    UTEOL2(UTPARMP),B'10000000'                         0492
*    IF STATUS = CONTINUE            /* CAN WE CONTINUE TO STEP1     */
*      THEN DO;                      /* PROCEED TO STEP 1            */
         LTR   STATUS,STATUS                                       0493
         BNZ   @RF00493                                            0493
*        SECONDDS = YES;             /* SECOND DATA SET ALLOCATED    */
*                                                                  0495
         OI    SECONDDS,B'10000000'                                0495
*        CALL STEP1;                 /* COPY 0 THRU LIMIT            */
*                                                                  0496
         BAL   @14,STEP1                                           0496
*        IF STATUS = CONTINUE        /* CAN WE CONTINUE TO STEP2     */
*          THEN DO;                  /* PROCEED TO STEP 2            */
         LTR   STATUS,STATUS                                       0497
         BNZ   @RF00497                                            0497
*            CALL STEP2;             /* COPY FIRST THRU LAST         */
*                                                                  0499
         BAL   @14,STEP2                                           0499
*            IF STATUS = CONTINUE    /* CAN WE CONTINUE TO STEP 3    */
*              THEN CALL STEP3;      /* THEN PROCEED TO STEP 3       */
         LTR   STATUS,STATUS                                       0500
         BNZ   @RF00500                                            0500
         BAL   @14,STEP3                                           0501
*            END;                                                  0502
*        END;                                                      0503
*                                                                  0503
*      ELSE                          /* BAD ALLOCATION ERROR         */
*        STATUS = TERMNOER;          /* TERMINATE WITHOUT ERR MSG    */
*                                                                  0504
         B     @RC00493                                            0504
@RF00493 LA    STATUS,32                                           0504
*    RESPECIFY (GPR14P) RSTD;                                      0505
@RC00493 DS    0H                                                  0506
*    GPR14P = NEWUTI14;              /* RESTORE REG 14               */
         L     GPR14P,NEWUTI14                                     0506
*    RESPECIFY (GPR14P) UNRSTD;                                    0507
*                                                                  0507
*END NEWUTIL;                                                      0508
@EL00014 DS    0H                                                  0508
@EF00014 DS    0H                                                  0508
@ER00014 BR    @14                                                 0508
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          STEP1                                                   */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          COPY THE LINES FROM THE BEGINNING OF THE DATASET UP TO  */
*/*          LIMITKEY.                                               */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          COPY FROM THE CURRENT DATASET TO THE SECONDARY DATASET. */
*/*          START WITH THE BEGINNING OF THE CURRENT DATASET AND     */
*/*          COPY UP TO BUT NOT INCLUDING THE RECORD WHOSE           */
*/*          KEY=LIMITKEY.                                           */
*/*                                                                  */
*/*          IF THE COMMAND IS A MOVE AND THE RANGE OF LINES FALLS   */
*/*          BETWEEN THE BEGINNING OF THE CURRENT DATASET AND THE    */
*/*          LIMITKEY THEN BYPASS COPYING THE RANGE OF LINES TO THE  */
*/*          SECONDARY DATASET.                                      */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          EUTERR---ANY ERRORS DETECTED IN IKJEBEUT                */
*/*                                                                  */
*/********************************************************************/
*STEP1:                                                            0509
*        PROC OPTIONS(NOSAVE);                                     0509
*                                                                  0509
STEP1    DS    0H                                                  0510
*    RESPECIFY (GPR14P) RSTD;                                      0510
*    STEP114 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,STEP114                                      0511
*    RESPECIFY (GPR14P) UNRSTD;                                    0512
*                                                                  0512
*    UTPARMP = ADDR(READFRST);       /* WE WILL READ THE FIRST RECORD*/
         LA    UTPARMP,READFRST                                    0513
*    CALL READ;                      /* READ THE FIRST RECORD        */
*                                                                  0514
         BAL   @14,READ                                            0514
*    DO WHILE STATUS = CONTINUE &    /* LOOP WHILE STATUS IS CONTINUE*/
*             THEKEY < LIMITKEY &    /* AND WE HAVE NOT PASSED LIMIT */
*             CAATTNIS = NO;         /* AND NO ATTENTION IS ISSUED   */
*                                                                  0515
         B     @DE00515                                            0515
@DL00515 DS    0H                                                  0516
*      IF FIRSTKEY =< THEKEY  &      /* IS RECORD WITHIN THE RANGE...*/
*         THEKEY =< LASTKEY   &      /* ... OF MOVE/COPY             */
*         COMMAND = MOVE             /* ... TO MOVE                  */
*        THEN DO;                    /* THEN DO NOT COPY TO NEW DS   */
         L     @03,THEKEY(,COMMREG)                                0516
         C     @03,FIRSTKEY                                        0516
         BL    @RF00516                                            0516
         L     @15,LASTKEY                                         0516
         CR    @03,@15                                             0516
         BH    @RF00516                                            0516
         CLI   COMMAND,1                                           0516
         BNE   @RF00516                                            0516
*          UTPARMP = ADDR(READNEXT); /* WILL SKIP TO NEXT AFTER LAST */
         LA    UTPARMP,READNEXT                                    0518
*          THEKEY = LASTKEY;         /* READ-NEXT-AFTER LASTKEY      */
         ST    @15,THEKEY(,COMMREG)                                0519
*          CALL READ;                /* READ THE RECORD AFTER LAST   */
         BAL   @14,READ                                            0520
*                                    /* THIS NEW KEY IS IN THEKEY    */
*          END;                                                    0521
*                                                                  0521
*        ELSE DO;                    /* WE CAN COPY THE LINE         */
         B     @RC00516                                            0522
@RF00516 DS    0H                                                  0523
*          UTPARMP = ADDR(WRITESEQ); /* WRITE RECORDS SEQUENTIALLY   */
         LA    UTPARMP,WRITESEQ                                    0523
*          CALL WRITE;               /* WRITE THE RECORD             */
*                                                                  0524
         BAL   @14,WRITE                                           0524
*          UTPARMP = ADDR(READNEXT); /* WILL GET NEXT RECORD         */
         LA    UTPARMP,READNEXT                                    0525
*          CALL READ;                /* READ THE NEXT RECORD         */
         BAL   @14,READ                                            0526
*          END;                                                    0527
*    END;                                                          0528
*                                                                  0528
@RC00516 DS    0H                                                  0528
@DE00515 LTR   STATUS,STATUS                                       0528
         BNZ   @DC00515                                            0528
         CLC   THEKEY(4,COMMREG),LIMITKEY                          0528
         BNL   @DC00515                                            0528
         TM    CAATTNIS(COMMREG),B'01000000'                       0528
         BZ    @DL00515                                            0528
@DC00515 DS    0H                                                  0529
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */
*                                                                  0529
         TM    CAATTNIS(COMMREG),B'01000000'                       0529
         BNO   @RF00529                                            0529
         LA    STATUS,32                                           0530
*      ELSE                          /* LOOK FOR END OF FILE         */
*      IF STATUS = NORECORD          /* IF LIMIT IS EOF              */
*        THEN STATUS = CONTINUE;     /* THEN INDICATE WE CAN CONTINUE*/
*                                                                  0531
         B     @RC00529                                            0531
@RF00529 C     STATUS,@CF00055                                     0531
         BNE   @RF00531                                            0531
         SLR   STATUS,STATUS                                       0532
*    RESPECIFY (GPR14P) RSTD;                                      0533
@RF00531 DS    0H                                                  0533
@RC00529 DS    0H                                                  0534
*    GPR14P = STEP114;               /* RESTPRE REG 14               */
         L     GPR14P,STEP114                                      0534
*    RESPECIFY (GPR14P) UNRSTD;                                    0535
*                                                                  0535
*END STEP1;                                                        0536
@EL00015 DS    0H                                                  0536
@EF00015 DS    0H                                                  0536
@ER00015 BR    @14                                                 0536
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          STEP2                                                   */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          COPY THE RANGE OF LINES TO THE SECONDARY DATASET        */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          SIMPLY COPY THOSE RECORDS BEGINNING WITH FIRSTKEY AND   */
*/*          ENDING WITH LASTKEY TO THE NEW DATASET.THEY WILL NOT    */
*/*          HAVE TO BE DELETED FROM THE SECONDARY DATASET IF THE    */
*/*          COMMAND IS A MOVE BECAUSE THEY WERE NOT COPIED TO IT.   */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          EUTERR---ANY ERRORS DETECTED IN IKJEBEUT                */
*/*                                                                  */
*/********************************************************************/
*STEP2:                                                            0537
*        PROC OPTIONS(NOSAVE);                                     0537
*                                                                  0537
STEP2    DS    0H                                                  0538
*    RESPECIFY (GPR14P) RSTD;                                      0538
*    STEP214 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,STEP214                                      0539
*    RESPECIFY (GPR14P) UNRSTD;                                    0540
*                                                                  0540
*    UTPARMP = ADDR(READPARM);        /* READ FIRST REC FOR MOVE/COPY *
         LA    UTPARMP,READPARM                                    0541
*    THEKEY = OLDKEY;                /* NEXT LINE TO BE MOVE/COPIED  */
         ST    OLDKEY,THEKEY(,COMMREG)                             0542
*    CALL READ;                      /* READ THE FIRST KEY           */
*                                                                  0543
         BAL   @14,READ                                            0543
*    DO WHILE STATUS = CONTINUE &    /* AS LONG AS WE CAN CONTINUE   */
*             OLDKEY =< LASTKEY &    /* THEKEY STILL IN THE RANGE    */
*             CAATTNIS = NO;         /* AND NO ATTENTION ISSUED      */
*                                                                  0544
         B     @DE00544                                            0544
@DL00544 DS    0H                                                  0545
*      UTPARMP = ADDR(WRITESEQ);     /* WRITE THE RECORD             */
         LA    UTPARMP,WRITESEQ                                    0545
*      THEKEY = NEWKEY;              /* WRITE WITH A NEW KEY         */
         ST    NEWKEY,THEKEY(,COMMREG)                             0546
*      CALL WRITE;                   /* WRITE THE RECORD             */
*                                                                  0547
         BAL   @14,WRITE                                           0547
*      UTPARMP = ADDR(READNEXT);     /* WILL READ THE NEXT RECORD    */
         LA    UTPARMP,READNEXT                                    0548
*      THEKEY = OLDKEY;              /* READ NEXT AFTER THE OLD KEY  */
         ST    OLDKEY,THEKEY(,COMMREG)                             0549
*      CALL READ;                    /* READ THE RECORD              */
         BAL   @14,READ                                            0550
*      OLDKEY = THEKEY;              /* THE NEXT OLD KEY             */
*                                                                  0551
         L     OLDKEY,THEKEY(,COMMREG)                             0551
*      NEWKEY  = NEWKEY  + THEINCR;  /* WHERE THE REC WILL GO        */
         AL    NEWKEY,THEINCR                                      0552
*    END;                                                          0553
*                                                                  0553
@DE00544 LTR   STATUS,STATUS                                       0553
         BNZ   @DC00544                                            0553
         C     OLDKEY,LASTKEY                                      0553
         BH    @DC00544                                            0553
         TM    CAATTNIS(COMMREG),B'01000000'                       0553
         BZ    @DL00544                                            0553
@DC00544 DS    0H                                                  0554
*    VERIFY = NEWKEY  - THEINCR;     /* VERIFY LAST LINE WRITTEN     */
*                                                                  0554
         LR    @08,NEWKEY                                          0554
         SL    @08,THEINCR                                         0554
         ST    @08,VERIFY                                          0554
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */
*                                                                  0555
         TM    CAATTNIS(COMMREG),B'01000000'                       0555
         BNO   @RF00555                                            0555
         LA    STATUS,32                                           0556
*      ELSE                          /* LOOK FOR END OF FILE         */
*      IF STATUS = NORECORD          /* IF NOTHEING AFTER LAST REC   */
*        THEN STATUS = CONTINUE;     /* INDICATE WE CAN CONTINUE     */
*                                                                  0557
         B     @RC00555                                            0557
@RF00555 C     STATUS,@CF00055                                     0557
         BNE   @RF00557                                            0557
         SLR   STATUS,STATUS                                       0558
*    RESPECIFY (GPR14P) RSTD;                                      0559
@RF00557 DS    0H                                                  0559
@RC00555 DS    0H                                                  0560
*    GPR14P = STEP214;               /* RESTORE REG 14               */
         L     GPR14P,STEP214                                      0560
*    RESPECIFY (GPR14P) UNRSTD;                                    0561
*                                                                  0561
*END STEP2;                                                        0562
@EL00016 DS    0H                                                  0562
@EF00016 DS    0H                                                  0562
@ER00016 BR    @14                                                 0562
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          STEP3                                                   */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          COPY FROM LIMITKEY TO THE END OF THE DATASET.           */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          COPY THE REST OF THE CURRENT DATASET FROM KEY=LIMITKEY  */
*/*          TO EOF.WE HAVE TO DO OUR RENUMBERING HERE OF THE THOSE  */
*/*          LINES WITH KEYS>=LIMITKEY AND KEYS=<THEKEY OF THE LAST  */
*/*          LINE WRITTEN TO THE SECONDARY DATASET                   */
*/*                                                                  */
*/*          IF THE KEY OF THE RECORD READ FROM THE CURRENT DATASET  */
*/*          IS LESS THAN THE KEY OF THE LAST RECORD WRITTEN TO THE  */
*/*          SECONDARY DATASET,THE KEY FOR THE RECORD OF THE         */
*/*          CURRENT DATASET HAS TO BE RENUMBERED.                   */
*/*                                                                  */
*/*          RECORDS WILL CONTINUE TO BE RENUMBERED UNTIL THE KEYS   */
*/*          OF THE CURRENT DATASET CATCH UP TO AND BECOME GREATER   */
*/*          THAN THE KEY=NEWKEY OF THE LAST REC WRITTEN TO THE      */
*/*          SECONDARY DATASET.THIS IS WHEN THE RENUMBERING STOPS.   */
*/*                                                                  */
*/********************************************************************/
*STEP3:                                                            0563
*        PROC OPTIONS(NOSAVE);                                     0563
*                                                                  0563
STEP3    DS    0H                                                  0564
*    RESPECIFY (GPR14P) RSTD;                                      0564
*    STEP314 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,STEP314                                      0565
*    RESPECIFY (GPR14P) UNRSTD;                                    0566
*                                                                  0566
*    NEWKEY  = NEWKEY  - THEINCR;    /* RESET TO LAST LINE # WRITTEN */
         SL    NEWKEY,THEINCR                                      0567
*                                    /* AND ADD THE MIN INCR OF 1    */
*    OLDKEY = LIMITKEY;              /* WE MAY RENUMBER THIS KEY     */
         L     @05,LIMITKEY                                        0568
         LR    OLDKEY,@05                                          0568
*    UTPARMP = ADDR(READPARM);       /* WANT TO READ SPECIFIC KEY    */
         LA    UTPARMP,READPARM                                    0569
*    THEKEY = LIMITKEY;              /* READ FROM LIMIT TO EOF       */
         ST    @05,THEKEY(,COMMREG)                                0570
*    CALL READ;                      /* READ KEY=LIMITKEY            */
*                                                                  0571
         BAL   @14,READ                                            0571
*    DO WHILE STATUS = CONTINUE &    /* LOOP TILL END OF FILE        */
*             CAATTNIS = NO;         /* AND NO ATTENTION ISSUED      */
*                                                                  0572
         B     @DE00572                                            0572
@DL00572 DS    0H                                                  0573
*      IF FIRSTKEY =< OLDKEY &       /* IS RECORD WITHIN THE RANGE...*/
*         OLDKEY =< LASTKEY  &       /* ... OF THE MOVE/COPY...      */
*         COMMAND = MOVE             /* ... TO BE MOVED              */
*        THEN DO;                    /* THEN SKIP TO LINE AFTER LAST */
         C     OLDKEY,FIRSTKEY                                     0573
         BL    @RF00573                                            0573
         L     @03,LASTKEY                                         0573
         CR    OLDKEY,@03                                          0573
         BH    @RF00573                                            0573
         CLI   COMMAND,1                                           0573
         BNE   @RF00573                                            0573
*          UTPARMP = ADDR(READNEXT); /* WANT LINE AFTER KEY=LASTKEY  */
         LA    UTPARMP,READNEXT                                    0575
*          THEKEY = LASTKEY;         /* GET LINE AFTER KEY = LASTKEY */
         ST    @03,THEKEY(,COMMREG)                                0576
*          CALL READ;                /* READ THE LINE AFTER LASTKEY  */
         BAL   @14,READ                                            0577
*          OLDKEY = THEKEY;          /* SAVE NEXT KEY AFTER LAST     */
         L     OLDKEY,THEKEY(,COMMREG)                             0578
*          END;                                                    0579
*                                                                  0579
*        ELSE DO;                    /* WE CAN COPY THIS LINE        */
         B     @RC00573                                            0580
@RF00573 DS    0H                                                  0581
*          IF OLDKEY =< NEWKEY       /* IS KEY < LAST REC WRITTEN    */
*            THEN DO;                /* WILL RENUMBER BY MININCR     */
         CR    OLDKEY,NEWKEY                                       0581
         BH    @RF00581                                            0581
*              NEWKEY  = NEWKEY  + MININCR; /* INCR BY MININCR       */
         AL    NEWKEY,@CF00063                                     0583
*              THEKEY  = NEWKEY;     /* AND CHANGE THE KEY           */
         ST    NEWKEY,THEKEY(,COMMREG)                             0584
*              END;                                                0585
*                                                                  0585
*          UTPARMP = ADDR(WRITESEQ); /* WRITE THE RECORD             */
@RF00581 LA    UTPARMP,WRITESEQ                                    0586
*          CALL WRITE;               /* WRITE THE RECORD             */
*                                                                  0587
         BAL   @14,WRITE                                           0587
*          UTPARMP = ADDR(READNEXT); /* WILL READ THE NEXT RECORD... */
         LA    UTPARMP,READNEXT                                    0588
*          THEKEY = OLDKEY;          /* AFTER THE LAST REC READ      */
         ST    OLDKEY,THEKEY(,COMMREG)                             0589
*          CALL READ;                /* READ THE NEXT RECORD         */
         BAL   @14,READ                                            0590
*          OLDKEY = THEKEY;          /* SAVE THE NEXT KEY            */
         L     OLDKEY,THEKEY(,COMMREG)                             0591
*          END;                                                    0592
*    END;                                                          0593
*                                                                  0593
@RC00573 DS    0H                                                  0593
@DE00572 LTR   STATUS,STATUS                                       0593
         BNZ   @DC00572                                            0593
         TM    CAATTNIS(COMMREG),B'01000000'                       0593
         BZ    @DL00572                                            0593
@DC00572 DS    0H                                                  0594
*    IF CAATTNIS = YES               /* WAS ATTENTION ISSUED         */
*      THEN STATUS = TERMNOER;       /* TERMINATE WITHOUT ERR MSG    */
*                                                                  0594
         TM    CAATTNIS(COMMREG),B'01000000'                       0594
         BNO   @RF00594                                            0594
         LA    STATUS,32                                           0595
*      ELSE                          /* LOOK FOR END OF FILE         */
*      IF STATUS = NORECORD          /* IF END OF FILE               */
*        THEN STATUS = CONTINUE;     /* THEN CONTINUE, I.E. NO ERR   */
*                                                                  0596
         B     @RC00594                                            0596
@RF00594 C     STATUS,@CF00055                                     0596
         BNE   @RF00596                                            0596
         SLR   STATUS,STATUS                                       0597
*    RESPECIFY (GPR14P) RSTD;                                      0598
@RF00596 DS    0H                                                  0598
@RC00594 DS    0H                                                  0599
*    GPR14P = STEP314;               /* RESTORE REG 14               */
         L     GPR14P,STEP314                                      0599
*    RESPECIFY (GPR14P) UNRSTD;                                    0600
*                                                                  0600
*END STEP3;                                                        0601
@EL00017 DS    0H                                                  0601
@EF00017 DS    0H                                                  0601
@ER00017 BR    @14                                                 0601
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          IKJEBEUT                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          PERFORM THE READ/WRITE/DELETE OPERATIONS FOR MOVE/COPY  */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          NO I/O OPERATIONS WILL BE PERFORMED IF THE STATUS IS    */
*/*          OTHER THAN CONTINUE                                     */
*/*                                                                  */
*/*          GET THE ADDRESS OF THE I/O PARAMETER LIST THAT WILL BE  */
*/*          USED BY IKJEBEUT                                        */
*/*                                                                  */
*/*          CALL IKJEBEUT TO PERFORM THE I/O OPERATION              */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          TERMNOER--WHEN OTHER THAN CONTINUE OR NO RECORD FOUND   */
*/*          STATUS                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0602
*IKJEBEUT:READ:WRITE:DELETE:                                       0602
*        PROC OPTIONS(NOSAVE);                                     0602
*                                                                  0602
IKJEBEUT DS    0H                                                  0602
READ     DS    0H                                                  0602
WRITE    DS    0H                                                  0602
DELETE   DS    0H                                                  0603
*   RESPECIFY (GPR01P,GPR14P) RSTD;                                0603
*   EBEUT14 =GPR14P;                 /* SAVE REG 14                  */
         ST    GPR14P,EBEUT14                                      0604
*   RESPECIFY (GPR14P) UNRSTD;                                     0605
*                                                                  0605
*    IF STATUS = CONTINUE            /* CAN WE CONTINUE WITH IKJEBEUT*/
*      THEN DO;                                                    0606
         LTR   STATUS,STATUS                                       0606
         BNZ   @RF00606                                            0606
*        RESPECIFY (GPR15P,GPR01P) RSTD;                           0608
*        GPR01P = UTPARMP;           /* GET ADDR OF PARAMETER LIST   */
*                                                                  0609
         LR    GPR01P,UTPARMP                                      0609
*        GENERATE REFS(COMMREG,CAPTUT)                             0610
*          (IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),(1)),MF=(E,A))
*                                                                  0610
         IKJEBESH (COMMREG),IKJEBEUT,PARAM=((COMMREG),(1)),MF=(E,A)
*        STATUS = GPR15P;                                          0611
         LR    STATUS,GPR15P                                       0611
*        RESPECIFY (GPR15P,GPR01P) UNRSTD;                         0612
*                                                                  0612
*        IF STATUS ^= CONTINUE &     /* WAS THERE AN ERROR IN EBEUT  */
*           STATUS ^= NORECORD       /* OTHER THAN NO RECORD FOUND   */
*         THEN                       /*   YES - THERE WAS AN ERROR   */
         LTR   STATUS,STATUS                                       0613
         BZ    @RF00613                                            0613
         C     STATUS,@CF00055                                     0613
         BE    @RF00613                                            0613
*           STATUS = TERMNOER;       /* IKJEBEUT PUT OUT THE MESSAGES*/
         LA    STATUS,32                                           0614
*        END;                                                      0615
*                                                                  0615
@RF00613 DS    0H                                                  0616
*    RESPECIFY (GPR14P) RSTD;                                      0616
@RF00606 DS    0H                                                  0617
*    GPR14P=EBEUT14;                 /* RESTORE REG 14               */
         L     GPR14P,EBEUT14                                      0617
*    RESPECIFY (GPR14P,GPR01P) UNRSTD;                             0618
*END IKJEBEUT;                                                     0619
@EL00018 DS    0H                                                  0619
@EF00018 DS    0H                                                  0619
@ER00018 BR    @14                                                 0619
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RELINENM                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          FIND RELATIVE LINE NUMBER FOR NTH LINE                  */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          THE VARIABLE COUNT CONTAINS THE NUMBER OF RECORDS THAT  */
*/*          WE WANT TO MOVE/COPY                                    */
*/*                                                                  */
*/*          WHEN WE HAVE READ THAT NUMBER OF RECORDS THE VARIABLE   */
*/*          THEKEY CONTAINS THE KEY OF THE LAST LINE THAT WILL BE   */
*/*          MOVE/COPIED                                             */
*/*                                                                  */
*/*          IF EOF IS REACHED BEFORE ALL THE RECORDS HAVE BEEN      */
*/*          READ THEN THE VARIABLE THEKEY CONTAINS THE KEY OF THE   */
*/*          LAST RECORD IN THE DATASET AND THAT KEY IS USED FOR     */
*/*          THE KEY OF THE LAST LINE TO BE MOVE/COPIED              */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          EUTERR---ANY I/O ERRORS DETECTED IN IKJEBEUT            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0620
*RELINENM:                                                         0620
*        PROC OPTIONS(NOSAVE);                                     0620
*                                                                  0620
RELINENM DS    0H                                                  0621
*   RESPECIFY GPR14P RSTD;                                         0621
*   RELINE14 = GPR14P;               /* SAVE REG 14                  */
         ST    GPR14P,RELINE14                                     0622
*   RESPECIFY GPR14P UNRSTD;                                       0623
*                                                                  0623
*   UTPARMP = ADDR(READNEXT);        /* READ RECORD AFTER KEY = THEKEY*
*                                                                  0624
         LA    UTPARMP,READNEXT                                    0624
*   DO LOOPCNT = COUNT - ONE TO ONE BY - ONE  /* READ N RECORDS      */
*      WHILE (STATUS = CONTINUE); /* WHILE READS ARE SUCCESSFUL      */
         L     @08,COUNT                                           0625
         BCTR  @08,0                                               0625
         ST    @08,LOOPCNT                                         0625
         B     @DE00625                                            0625
@DL00625 LTR   STATUS,STATUS                                       0625
         BNZ   @DC00625                                            0625
*                                    /* ... UPPER LIMIT OF MOVE/COPY */
*     CALL READ;                    /* READ A RECORD                 */
         BAL   @14,READ                                            0626
*   END;                                                           0627
*                                                                  0627
         SLR   @08,@08                                             0627
         BCTR  @08,0                                               0627
         AL    @08,LOOPCNT                                         0627
         ST    @08,LOOPCNT                                         0627
@DE00625 LTR   @08,@08                                             0627
         BP    @DL00625                                            0627
@DC00625 DS    0H                                                  0628
*   IF STATUS = NORECORD             /* IF NO RECORD FOUND           */
*     THEN STATUS = CONTINUE;        /* SET STATUS TO CONTINUE       */
*                                                                  0628
         C     STATUS,@CF00055                                     0628
         BNE   @RF00628                                            0628
         SLR   STATUS,STATUS                                       0629
*   RESPECIFY (GPR14P) RSTD;                                       0630
@RF00628 DS    0H                                                  0631
*   GPR14P = RELINE14;               /* RESTORE REG 14               */
         L     GPR14P,RELINE14                                     0631
*   RESPECIFY (GPR14P) UNRSTD;                                     0632
*                                                                  0632
*END RELINENM;                                                     0633
@EL00019 DS    0H                                                  0633
@EF00019 DS    0H                                                  0633
@ER00019 BR    @14                                                 0633
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          INCRCHCK                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          PARSE VALIDITY CHECK ROUTINE                            */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF NO VALUE WAS ENTERED FOR THE KEYWORD REQUEST THAT    */
*/*          PARSE PROMPT THE USER FOR A VALUE                       */
*/*                                                                  */
*/*          IF THE VALUE THAT WAS ENTERED IS ZERO THEN REQUEST      */
*/*          THAT PARSE PROMPT THE USER FOR A NON ZERO VALUE         */
*/*                                                                  */
*/*          OTHERWISE ACCEPT THE VALUE THAT WAS ENTERED             */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          N/A                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0634
*INCRCHCK:                                                         0634
*        PROC OPTIONS(NOSAVEAREA);                                 0634
*                                                                  0634
INCRCHCK STM   @14,@12,12(@13)                                     0634
*   RESPECIFY (GPR01P,GPR15P) RSTD;                                0635
*   GPR15P  =GPR01P  ->IWK;         /* GET PTR TO REGS               */
         L     GPR15P,IWK(,GPR01P)                                 0636
*   GEN( LM 2,12,0(15));            /* SET UP REGS FOR VALCK         */
*                                                                  0637
          LM 2,12,0(15)
*   IF IHERE = NO                  /* IF NO VALUE ENTERED FOR INCR  */
*      VALINCR(1:ILENGTH) =         /* OR THE VALUE IS ZERO          */
*          FOXZERO(1:ILENGTH)                                      0638
*     THEN GPR15P = FOUR;           /* SET RC=4 TO MAKE PARSE PROMPT */
*                                                                  0638
         L     @14,IPDE(,GPR01P)                                   0638
         TM    IHERE(@14),B'10000000'                              0638
         BZ    @RT00638                                            0638
         L     @08,ICHARPTR(,@14)                                  0638
         LH    @14,ILENGTH(,@14)                                   0638
         BCTR  @14,0                                               0638
         EX    @14,@SC01528                                        0638
         BNE   @RF00638                                            0638
@RT00638 DS    0H                                                  0639
         LA    GPR15P,4                                            0639
*     ELSE DO;                                                     0640
         B     @RC00638                                            0640
@RF00638 DS    0H                                                  0641
*       PACKAREA = FOXZERO;          /* ZERO OUT THE FIELD           */
         MVC   PACKAREA(8),FOXZERO                                 0641
*       PACKAREA(9-ILENGTH:8) =      /* MOVE   INTO THE RIGHT SIDE...*/
*           ICHARPTR->VALINCR;       /* ...THE VALUE ENTERED         */
         L     @14,IPDE(,GPR01P)                                   0642
         LA    @08,9                                               0642
         SH    @08,ILENGTH(,@14)                                   0642
         LA    @03,PACKAREA-1(@08)                                 0642
         LCR   @08,@08                                             0642
         AL    @08,@CF00061                                        0642
         L     @14,ICHARPTR(,@14)                                  0642
         EX    @08,@SM01530                                        0642
*       PACK(PACKAREA,PACKAREA);     /* CONVERT: ZONED TO PACKED     */
         PACK  PACKAREA(8),PACKAREA(8)                             0643
*       CVB(THEINCR,PACKAREA);       /* CONVERT: PACKED TO BINARY    */
         CVB   @14,PACKAREA                                        0644
         ST    @14,THEINCR                                         0644
*       GPR15P  = ZERO;              /* INDICATE NO PROMPTING NEEDED */
         SLR   GPR15P,GPR15P                                       0645
*       END;                                                       0646
*                                                                  0646
*   RETURN CODE(GPR15P  );                                         0647
@RC00638 L     @14,12(,@13)                                        0647
         LM    @00,@12,20(@13)                                     0647
         BR    @14                                                 0647
*   RESPECIFY (GPR01P,GPR15P) UNRSTD;                              0648
*                                                                  0648
*END INCRCHCK;                                                     0649
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          IKJEBESE                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          FIND THE RECORD WHICH CONTAINS THE FIRST OCCURANCE OF   */
*/*          THE STRING ENTERED AS THE FIRST OPERAND ON THE          */
*/*          MOVE/COPY COMMAND.THE SEARCH BEGINS WITH THE CURRENT    */
*/*          LINE NUMBER.                                            */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          PASS THE STRING TO IKJEBELE WHICH IS LINE-EDIT SO IT    */
*/*          CAN FOLD THE STRING TO UPPERCASE IF NECESSARY           */
*/*                                                                  */
*/*          WE HAVE TO PASS THE CURRENT LINE TO IKJEBESE.WE KNOW    */
*/*          WHAT THE KEY OF THE FIRST RECORD IN THE DATA SET IS.IF  */
*/*          THE CURRENT LINE POINTER IS LESS THAN THE FIRST RECORD  */
*/*          THEN WE WILL PASS THE FIRST RECORD IN THE DATA SET TO   */
*/*          IKJEBESE.THE CURRENT LINE POINTER CAN BE LESS THAN THE  */
*/*          KEY OF THE FIRST RECORD WHEN THE KEY OF THE FIRST       */
*/*          RECORD IS GREATER THAN ZERO AND TOP WAS ENTERED WHICH   */
*/*          GIVES A CURRENT LINE POINTER OF ZERO.                   */
*/*                                                                  */
*/*          AFTER OBTAINING THE CURRENT LINE AND INITIALIZING THE   */
*/*          PARAMETER LIST FOR IKJEBESE WE CALL IKJEBESE TO FIND    */
*/*          THE RECORD WHICH CONTAINS THE STRING THAT WAS ENTERED   */
*/*          ON THE MOVE/COPY COMMAND:                               */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          NOTEXT---QUOTED STRING NOT FOUND                        */
*/*          EUTERR---ANY I/O ERRORS DETECTED IN IKJEBEUT            */
*/*                                                                  */
*/********************************************************************/
*IKJEBESE:                                                         0650
*        PROC;                                                     0650
*                                                                  0650
IKJEBESE STM   @14,@05,@SA00021                                    0650
         STM   @07,@12,@SA00021+32                                 0650
*    LECODE = DELIMSTR;              /* A DELIMITED STRING           */
         MVI   LECODE,X'80'                                        0651
*    LETXTPTR = ADDR(LETXT);         /*ADDRESS OF THE TEXT           */
         LA    @08,LETXT(,COMMREG)                                 0652
         STCM  @08,7,LETXTPTR                                      0652
*    LECAPTR = COMMREG;              /*POINTER TO IKJEBECA           */
*                                                                  0653
         ST    COMMREG,LECAPTR                                     0653
*    LETXTLEN = FIRSTSL + FOUR;      /*LENGTH OF THE STRING + HEADER */
         LH    @08,FIRSTSL                                         0654
         LA    @07,4                                               0654
         ALR   @07,@08                                             0654
         STH   @07,LETXTLEN(,COMMREG)                              0654
*    LETXTTXT(1:FIRSTSL) =           /*MOVE THE STRING TO...         */
*        STRNGVAL(1:FIRSTSL);        /*... BE EDITTED                */
*                                                                  0655
         BCTR  @08,0                                               0655
         L     @07,FIRSTSP                                         0655
         EX    @08,@SM01532                                        0655
*    GEN REFS(CAPTLE,LEPLIST)                                      0656
*     (IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),MF=(E,A));
*                                                                  0656
         IKJEBESH (COMMREG),IKJEBELE,PARAM=((COMMREG),LEPLIST),MF=(E,A)
*    STRNGVAL(1:FIRSTSL) =           /* MOVE EDITTED STRING BACK...  */
*        LETXTTXT(1:FIRSTSL);        /*... TO AREA GOTTEN BY PARSE   */
*                                                                  0657
         L     @08,FIRSTSP                                         0657
         LH    @07,FIRSTSL                                         0657
         BCTR  @07,0                                               0657
         EX    @07,@SM01534                                        0657
*    UTPARMP = ADDR(READPARM);       /* WANT TO READ FROM THE DS     */
         LA    UTPARMP,READPARM                                    0658
*    THEKEY = CACURNUM;              /* WANT TO READ THE CURRENT LINE*/
*                                                                  0659
         L     @08,CACURNUM(,COMMREG)                              0659
         ST    @08,THEKEY(,COMMREG)                                0659
*    IF THEKEY < FIRSTREC            /* 0 = CACURNUM < FIRST REC NUM */
*      THEN THEKEY = FIRSTREC;       /* WILL REALLY READ FIRST RECRD */
*                                                                  0660
         L     @07,FIRSTREC                                        0660
         CR    @08,@07                                             0660
         BNL   @RF00660                                            0660
         ST    @07,THEKEY(,COMMREG)                                0661
*    CALL READ;                      /* READ THE CURRENT LINE        */
*                                                                  0662
@RF00660 BAL   @14,READ                                            0662
*    IF STATUS = CONTINUE           /* IF READ WAS SUCCESSFUL       */
*       STATUS = NORECORD            /* OR RECORD NOT FOUND          */
*      THEN DO;                      /* THEN CALL IKJEBESE           */
         LTR   STATUS,STATUS                                       0663
         BZ    @RT00663                                            0663
         C     STATUS,@CF00055                                     0663
         BNE   @RF00663                                            0663
@RT00663 DS    0H                                                  0664
*        STATUS = CONTINUE;          /* RESET A CONTINUE STATUS      */
         SLR   STATUS,STATUS                                       0665
*        SEDCBPTR=CAPTCDCB;          /*SET PTR TO CURRENT DCB        */
         L     @08,CAPTCDCB(,COMMREG)                              0666
         ST    @08,SEDCBPTR                                        0666
*        SEOFFS=ZERO;                /*STARTING OFFSET EQUAL ZERO    */
         SLR   @08,@08                                             0667
         STH   @08,SEOFFS                                          0667
*        SESTRLEN=FIRSTSL;           /*LENGTH OF STRING FROM PARSE   */
         LH    @08,FIRSTSL                                         0668
         STH   @08,SESTRLEN                                        0668
*        SETXTPTR=ADDR(STRNGVAL);    /* POINT TO EDITTED STRING      */
         L     @08,FIRSTSP                                         0669
         ST    @08,SETXTPTR                                        0669
*        SEBFRPTR=ADDR(THEBUFFR);    /* BUFFER WITH FIRST RECORD     */
         LA    @08,THEBUFFR(,COMMREG)                              0670
         ST    @08,SEBFRPTR                                        0670
*        SELNRNGE=ADDR(SEPLISTD);    /* POINT TO RANGE OF LINES      */
         LA    @08,SEPLISTD                                        0671
         ST    @08,SELNRNGE                                        0671
*        SESTART=CACURNUM;           /*STARTING LINE NUM             */
         L     @08,CACURNUM(,COMMREG)                              0672
         ST    @08,SESTART                                         0672
*        SEEND= EOF;                 /*MAXIMUM LINE NUMBER           */
         MVC   SEEND(4),@CF01325                                   0673
*        SECHARCT=CALRECL-FOUR;      /* WILL SCAN ENTIRE RECORD      */
*                                                                  0674
         LH    @08,CALRECL(,COMMREG)                               0674
         SL    @08,@CF00055                                        0674
         STH   @08,SECHARCT                                        0674
*        RESPECIFY (GPR15P) RSTD;                                  0675
*        GENERATE REFS(COMMREG)                                    0676
*        (IKJEBESH ,IKJEBESE,PARAM=((COMMREG),SEPLIST),MF=(E,SEPLIST));
         IKJEBESH ,IKJEBESE,PARAM=((COMMREG),SEPLIST),MF=(E,SEPLIST)
*        SERETCD = GPR15P;           /* SAVE IKJEBESE RET CODE       */
         ST    GPR15P,SERETCD                                      0677
*        RESPECIFY (GPR15P) UNRSTD;                                0678
*                                                                  0678
*        IF SECODE = ZERO           /* IF ZERO CODE FROM SE OR ...  */
*           SECODE = FOUR            /* ... CODE OF FOUR             */
*         THEN FIRSTKEY = THEKEY; /* USE KEY OF REC FOR FIRST        */
         CLI   SECODE,0                                            0679
         BE    @RT00679                                            0679
         CLI   SECODE,4                                            0679
         BNE   @RF00679                                            0679
@RT00679 DS    0H                                                  0680
         L     @08,THEKEY(,COMMREG)                                0680
         ST    @08,FIRSTKEY                                        0680
*         ELSE STATUS = NOTEXT;  /* INDICATE TEXT NOT FOUND          */
         B     @RC00679                                            0681
@RF00679 L     STATUS,NOTEXT                                       0681
*       END;                                                       0682
*                                                                  0682
*END IKJEBESE;                                                     0683
@EL00021 DS    0H                                                  0683
@EF00021 DS    0H                                                  0683
@ER00021 LM    @14,@05,@SA00021                                    0683
         LM    @07,@12,@SA00021+32                                 0683
         BR    @14                                                 0683
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          CLEANUP                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          FREE CORE AND DATASETS,ETC.                             */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          FREE THE PARSE DESCRIPTOR LIST IF GOTTEN.THE POINTER    */
*/*          TO THE PDL WAS INITIALIZED TO ZERO IN INIT.             */
*/*                                                                  */
*/*          IF WE GOT A SECOND UTILITY DATA SET THEN WE HAVE AN     */
*/*          EXTRA DCB THAT NEEDS TO BE DELETED.IF THERE ARE NO      */
*/*          ERRORS THEN WE WILL SWITCH THE DCB POINTERS SO THAT     */
*/*          IKJEBEEX CAN DELETE THE CURRENT DATASET AND WE CAN      */
*/*          KEEP THE SECONDARY DATASET                              */
*/*                                                                  */
*/*          IF THERE ARE NO ERRORS AND THE VERIFY SWITCH IS ON      */
*/*          THEN GET THE LINE TO BE VERIFIED.                       */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          VERERROR---THIS ERROR SHOULD NOT OCCUR,IT MEANS TROUBLE */
*/*                                                                  */
*/********************************************************************/
*CLEANUP:                                                          0684
*        PROC OPTIONS(NOSAVE);                                     0684
*                                                                  0684
CLEANUP  DS    0H                                                  0685
*    RESPECIFY (GPR14P) RSTD;                                      0685
*    CLEANU14 = GPR14P;              /* SAVE REG 14                  */
         ST    GPR14P,CLEANU14                                     0686
*    RESPECIFY (GPR14P) UNRSTD;                                    0687
*                                                                  0687
*    RESPECIFY (GPR01P) RSTD;                                      0688
*    GPR01P = ADDR(CAPTPRSD);        /* GET ADDR OF PDL POINTER      */
         LA    GPR01P,CAPTPRSD(,COMMREG)                           0689
*    GEN REFS(GPR01P) (IKJRLSA (1)); /* FREE THE PDL                 */
         IKJRLSA (1)
*    RESPECIFY (GPR01P) UNRSTD;                                    0691
*                                                                  0691
*    CAFREEDL = FREED;               /* INDICATE PDL IS FREED        */
*                                                                  0692
         OI    CAFREEDL(COMMREG),B'10000000'                       0692
*    IF SECONDDS = YES               /* DID WE GET A SECOND UTIL DS  */
*      THEN DO;                      /*   YES - WE HAVE TWO UTIL DS  */
         TM    SECONDDS,B'10000000'                                0693
         BNO   @RF00693                                            0693
*        IF STATUS = CONTINUE        /* IF EVERYTHING GONE OK        */
*          THEN DO;                  /* THEN SWITCH THE DCB POINTERS */
         LTR   STATUS,STATUS                                       0695
         BNZ   @RF00695                                            0695
*            TEMP = CAPTCDCB;        /* SAVE OLD DCB PTR             */
         L     TEMP,CAPTCDCB(,COMMREG)                             0697
*            CAPTCDCB = CAPTPDCB;    /* SET OLD TO NEW               */
         L     @08,CAPTPDCB(,COMMREG)                              0698
         ST    @08,CAPTCDCB(,COMMREG)                              0698
*            CAPTPDCB = TEMP;        /* NOW WE CAN DELETE THE OLD    */
         ST    TEMP,CAPTPDCB(,COMMREG)                             0699
*            END;                                                  0700
*                                                                  0700
*        RESPECIFY (GPR00P) RSTD;                                  0701
@RF00695 DS    0H                                                  0702
*        GPR00P = CAPTPDCB;          /* FREE THE THE DCB''S DATA SET */
         L     GPR00P,CAPTPDCB(,COMMREG)                           0702
*        GEN REFS(COMMREG)           /* DELETE A UTILITY DATA SET    */
*          (IKJEBESH (COMMREG),IKJEBEEX,PARAM=((COMMREG)),MF=(E,X));
         IKJEBESH (COMMREG),IKJEBEEX,PARAM=((COMMREG)),MF=(E,X)
*        RESPECIFY (GPR00P) UNRSTD;                                0704
*        END;                                                      0705
*                                                                  0705
*    IF STATUS = CONTINUE            /* EVERYTHING OK THIS FAR       */
*      THEN DO;                      /* EVERYTHING IS OK SO FAR      */
@RF00693 LTR   STATUS,STATUS                                       0706
         BNZ   @RF00706                                            0706
*        CACURNUM = VERIFY;          /* CHANGE THE CURRENT LINE PTR  */
         L     @08,VERIFY                                          0708
         ST    @08,CACURNUM(,COMMREG)                              0708
*        IF CAVRFYSW = YES           /* AND WE WANT TO VERIFY LINE   */
*          THEN DO;                  /* GET LINE TO BE VARIFIED      */
         TM    CAVRFYSW(COMMREG),B'01000000'                       0709
         BNO   @RF00709                                            0709
*          CALNTOVF = YES;           /* TURN ON LINE TO VERIFY SW    */
         OI    CALNTOVF(COMMREG),B'10000000'                       0711
*          UTPARMP = ADDR(READPARM);  /* WANT TO READ A SPECIFIC KEY  *
         LA    UTPARMP,READPARM                                    0712
*          THEKEY = VERIFY;          /* USE THIS KEY FOR VERIFIED LN */
         ST    @08,THEKEY(,COMMREG)                                0713
*          UTDCBPTR = CAPTCDCB;      /* WE MAY A NEW DCB POINTER     */
         MVC   UTDCBPTR(3,UTPARMP),CAPTCDCB+1(COMMREG)             0714
*          UTBUFPTR = ADDR(CATEMPBF) + /* THE BUFFER TO GET THE LINE */
*                     12;            /* PLUS THIS MAGIC NUMBER       */
         LA    @08,CATEMPBF(,COMMREG)                              0715
         AL    @08,@CF00034                                        0715
         ST    @08,UTBUFPTR(,UTPARMP)                              0715
*          UTEOL3 = YES;             /* INDICATE END OF LIST         */
         OI    UTEOL3(UTPARMP),B'10000000'                         0716
*          CALL READ;                /* READ THE LINE                */
*                                                                  0717
         BAL   @14,READ                                            0717
*          IF STATUS ^= CONTINUE     /* IF READ IS BAD               */
*            THEN DO;                /* HANDLE VERIFY ERROR          */
         LTR   STATUS,STATUS                                       0718
         BZ    @RF00718                                            0718
*              STATUS = VERERROR;    /* INDICATE VERIFY ERROR        */
         L     STATUS,VERERROR                                     0720
*              CALNTOVF = NO;        /* INDICATE DON''T VERIFY       */
         NI    CALNTOVF(COMMREG),B'01111111'                       0721
*              END;                                                0722
*          END;                                                    0723
@RF00718 DS    0H                                                  0724
*        END;                                                      0724
*                                                                  0724
@RF00709 DS    0H                                                  0725
*    RESPECIFY (GPR14P) RSTD;                                      0725
@RF00706 DS    0H                                                  0726
*    GPR14P = CLEANU14;              /* RESTORE REG 14               */
         L     GPR14P,CLEANU14                                     0726
*    RESPECIFY (GPR14P) UNRSTD;                                    0727
*                                                                  0727
*END CLEANUP;                                                      0728
@EL00022 DS    0H                                                  0728
@EF00022 DS    0H                                                  0728
@ER00022 BR    @14                                                 0728
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          HANDLERR                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          HANDLE THE MOVE/COPY ERROR THAT MAY HAVE OCCURRED       */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*      STATUS<ZERO-                                                */
*/*          IMPLIES STATUS=MSG W/O ASSOCIATED INSERTIONS            */
*/*                                                                  */
*/*      STATUS=ZERO-                                                */
*/*          HANDLERR DOES NOT GET CONTROL                           */
*/*                                                                  */
*/*      STATUS>ZERO-                                                */
*/*           PARSE ERROR-                                           */
*/*               STATUS=GETMERR=MSG52312                            */
*/*               STATUS=NOT ZERO AND NOT 4=MSG52313                 */
*/*                                                                  */
*/********************************************************************/
*HANDLERR:                                                         0729
*        PROC OPTIONS(NOSAVE);                                     0729
*                                                                  0729
HANDLERR DS    0H                                                  0730
*    RESPECIFY (GPR14P) RSTD;                                      0730
*    HANDLE14 = GPR14P;              /* SAVE REG 14                  */
         LR    HANDLE14,GPR14P                                     0731
*    RESPECIFY (GPR14P) UNRSTD;                                    0732
*                                                                  0732
*    EMSPARMS = EMSPARMS && EMSPARMS;/* ZERO OUT PARM LIST FOR EBESE */
*                                                                  0733
         XC    EMSPARMS(12),EMSPARMS                               0733
*    IF STATUS < ZERO                /* STATUS = A MESSAGE NUMBER    */
*      THEN EMSMSG1 = ZERO - STATUS; /* MAKE NUMBER POSITIVE         */
*                                                                  0734
*                                                                  0734
         SLR   @08,@08                                             0734
         CR    STATUS,@08                                          0734
         BNL   @RF00734                                            0734
         SLR   @08,STATUS                                          0735
         STH   @08,EMSMSG1                                         0735
*      ELSE                          /* STATUS NOT EQUAL MSG NUMBER  */
*      IF PARSERR = YES              /* WAS IT A PARSE ERROR         */
*        THEN                        /* YES A PARSE ERROR            */
         B     @RC00734                                            0736
@RF00734 TM    PARSERR,B'01000000'                                 0736
         BNO   @RF00736                                            0736
*        IF STATUS = GETMERR         /* IS IT A GETMAIN ERROR        */
*          THEN DO;                  /* SET UP FOR GETMAIN ERROR     */
         C     STATUS,@CF00863                                     0737
         BNE   @RF00737                                            0737
*            EMSMSG1 = MSG52312;     /* SET THE ERROR MESSAGE NUMBER */
         LH    @08,MSG52312                                        0739
         STH   @08,EMSMSG1                                         0739
*            EMSINS1 = ADDR(TXTCMND);/* POINT  TO TEXT INSERTION */
         LA    @08,TXTCMND                                         0740
         ST    @08,EMSINS1                                         0740
*            END;                                                  0741
*                                                                  0741
*                                                                  0741
*          ELSE DO;                  /* HANDLE OTHER PARSE ERRORS    */
         B     @RC00737                                            0742
@RF00737 DS    0H                                                  0743
*            EMSMSG1 = MSG52313;     /* SET THE MSG NUMBER           */
         LH    @08,MSG52313                                        0743
         STH   @08,EMSMSG1                                         0743
*            EMSMSG2 = ONE;          /* SECOND LEVEL MSG EXISTS      */
         MVC   EMSMSG2(2),@CH00063                                 0744
*            EMSINS2 = ADDR(EMSTXT1);/* POINT  TO TXT INSERTIONS */
*                                                                  0745
         LA    @08,EMSTXT1                                         0745
         ST    @08,EMSINS2                                         0745
*            RESPECIFY TXTMAP BASED(ADDR(EMSTXT1));                0746
*            TXTMAP = TXTPARS;       /* INIT PARSE TEXT INSERTION    */
         MVI   TXTMAP+13(@08),C' '                                 0747
         MVC   TXTMAP+14(242,@08),TXTMAP+13(@08)                   0747
         MVC   TXTMAP(13,@08),TXTPARS                              0747
*            TXTNEXT = ADDR(EMSTXT2);/* THE  NEXT TEXT INSERTION */
*                                                                  0748
         LA    @07,EMSTXT2                                         0748
         ST    @07,TXTNEXT(,@08)                                   0748
*            RESPECIFY TXTMAP BASED(ADDR(EMSTXT2));                0749
*            TXTMAP(1:LENGTH(TXTRC)) = TXTRC; /* RC TXT INSERT       */
         MVC   TXTMAP(10,@07),TXTRC                                0750
*            CVD(STATUS,PACKAREA);            /* BINARY -> PACKED    */
         CVD   STATUS,PACKAREA                                     0751
*            UNPK(TXTTXT(1:2),PACKAREA);      /* PACKED TO ZONED     */
         UNPK  TXTTXT(2,@07),PACKAREA(8)                           0752
*            TXTTXT(2) = TXTTXT(2)  FOXZERO(1); /*'C4'X -> 'F4'X*/
         OC    TXTTXT+1(1,@07),FOXZERO                             0753
*            RESPECIFY TXTMAP BASED;                               0754
*            END;                                                  0755
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          HANDLERR PART 2                                         */
*/*                                                                  */
*/*      STATUS>ZERO CONTINUED-                                      */
*/*           IKJEBEDC ERROR-                                        */
*/*               STATUS=FOUR=MSG52501                               */
*/*               STATUS^=FOUR=TERMINATE W/O ERROR MSG               */
*/*                                                                  */
*/*           IKJEBEMR ERROR-                                        */
*/*               STATUS=8,THEN RETCODE=16,NO MSG                    */
*/*               STATUS^=8 AND RETCODE=0,THEN RETCODE=8,NO MSG      */
*/*                                                                  */
*/*      STATUS=PTR TO TEXT INSERTION-                               */
*/*          FOR MSG52579                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0756
*      ELSE                          /* CHECK FOR OTHER ERRORS       */
*      IF DCERROR = YES              /* CHECK FOR ERRORS IN IKJEBEDC */
*        THEN                        /* YES ERRORS IN IKJEBEDC       */
         B     @RC00736                                            0756
@RF00736 TM    DCERROR,B'00100000'                                 0756
         BNO   @RF00756                                            0756
*        IF STATUS = FOUR            /* IF IKJEBEDC RC = 4           */
*          THEN DO;                  /* HANDLE RC 4 ERROR IN IKJEBEDC*/
         C     STATUS,@CF00055                                     0757
         BNE   @RF00757                                            0757
*            RETCODE = EIGHT;        /* SET RETURN CODE TO 8         */
         MVC   RETCODE(4),@CF00061                                 0759
*            EMSMSG1 = - MSG52501;   /* EMPTY DATASET MESSAGE        */
         LH    @08,MSG52501                                        0760
         LCR   @08,@08                                             0760
         STH   @08,EMSMSG1                                         0760
*            END;                                                  0761
*                                                                  0761
*          ELSE STATUS = TERMNOER;   /* TERMINATE W/O ERR MSG        */
*                                                                  0762
         B     @RC00757                                            0762
@RF00757 LA    STATUS,32                                           0762
*        ELSE                        /* CHECK FOR ERROR IN IKJEBEMR  */
*        IF MRERROR = YES            /* IS THERE ERROR IN IKJEBEMR   */
*          THEN DO;                  /* YES ERROR IN IKJEBEMR        */
         B     @RC00756                                            0763
@RF00756 TM    MRERROR,B'00010000'                                 0763
         BNO   @RF00763                                            0763
*            IF STATUS = EIGHT       /* WAS RC FROM IKJEBEMR = 8     */
*              THEN RETCODE = SIXTEEN; /* SET RETURN CODE TO 16      */
*                                                                  0765
         C     STATUS,@CF00061                                     0765
         BNE   @RF00765                                            0765
         MVC   RETCODE(4),@CF00863                                 0766
*              ELSE                                                0767
*              IF RETCODE = ZERO     /* IF NO PREVIOUS BAD RETCODES  */
*                THEN RETCODE = EIGHT;  /* THEN SET RETURN CODE = 8  */
*                                                                  0767
         B     @RC00765                                            0767
@RF00765 L     @08,RETCODE                                         0767
         LTR   @08,@08                                             0767
         BNZ   @RF00767                                            0767
         MVC   RETCODE(4),@CF00061                                 0768
*            STATUS = TERMNOER;         /* TERM W/O ERROR MSG        */
@RF00767 DS    0H                                                  0769
@RC00765 LA    STATUS,32                                           0769
*            END;                                                  0770
*                                                                  0770
*        ELSE DO;                    /* MUST BE MESSAGE IKJ52579     */
         B     @RC00763                                            0771
@RF00763 DS    0H                                                  0772
*          EMSMSG1 = MSG52579;       /* SET  MESSAGE NUMBER          */
         LH    @08,MSG52579                                        0772
         STH   @08,EMSMSG1                                         0772
*          EMSINS1 = STATUS;         /* GET ADDR OF TEXT INSERTION   */
         ST    STATUS,EMSINS1                                      0773
*          END;                                                    0774
*                                                                  0774
*    IF STATUS ^= TERMNOER           /* IF WE SHOULD SEND MSG        */
*      THEN DO;                      /* SEND ERR MSG VIA IKJEBEMS    */
@RC00763 DS    0H                                                  0775
@RC00756 DS    0H                                                  0775
@RC00736 DS    0H                                                  0775
@RC00734 C     STATUS,@CF00890                                     0775
         BE    @RF00775                                            0775
*        GENERATE REFS(CAPTMS,EMSPARMS) (IKJEBEML ,,,,MF=(E,EMSPARMS));
         IKJEBEML ,,,,MF=(E,EMSPARMS)
*        STATUS = CONTINUE;          /* INDICATE CONTINUE STATUS     */
         SLR   STATUS,STATUS                                       0778
*        END;                                                      0779
*                                                                  0779
*    RESPECIFY (GPR14P) RSTD;                                      0780
@RF00775 DS    0H                                                  0781
*    GPR14P = HANDLE14;              /* RESTORE REG 14               */
         LR    GPR14P,HANDLE14                                     0781
*    RESPECIFY (GPR14P) UNRSTD;                                    0782
*                                                                  0782
*END HANDLERR;                                                     0783
@EL00023 DS    0H                                                  0783
@EF00023 DS    0H                                                  0783
@ER00023 BR    @14                                                 0783
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          IPLI EXIT                                               */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INVOKE IKJEBEMR TO ELETE THE OLD POLISH DATSET AND      */
*/*          BUILD A NEW ONE                                         */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF A SECOND DATASET WAS BUILT THEN SWITCH THE DCB       */
*/*          POINTERS SO IKJEBEMR WILL PROCESS THE SECOND ONE.       */
*/*          IKJEBEMR WILL USE CAPTCDCB TO IDENTIFY THE DATASET.     */
*/*                                                                  */
*/*          INVOKE IKJEBEMR TO BUILD A NEW POLISH DATASET           */
*/*                                                                  */
*/*          IF A SECOND DATASET WAS BUILT THEN SWITCH THE DCB PTRS  */
*/*          BACK TO THERE ORIGINAL VALUES                           */
*/*                                                                  */
*/*ERRORS-                                                           */
*/*          MRERROR---AN ERROR OCCURRED IN IKJEBEMR                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0784
*IPLIEXIT:                                                         0784
*        PROC OPTIONS(NOSAVE);                                     0784
*                                                                  0784
IPLIEXIT DS    0H                                                  0785
*   RESPECIFY (GPR14P) RSTD;                                       0785
*   IPLIEX14 = GPR14P;               /* SAVE REG 14                  */
         LR    IPLIEX14,GPR14P                                     0786
*   RESPECIFY (GPR14P) UNRSTD;                                     0787
*                                                                  0787
*   IF SECONDDS = YES                /* IS THERE SECOND UTILITY DS   */
*     THEN DO;                       /* SWITCH DCB POINTERS          */
         TM    SECONDDS,B'10000000'                                0788
         BNO   @RF00788                                            0788
*       TEMP = CAPTCDCB;             /* SAVE CURRENT DCB POINTER     */
         L     TEMP,CAPTCDCB(,COMMREG)                             0790
*       CAPTCDCB = CAPTPDCB;         /* CHANGE CURRENT DCB POINTER   */
         L     @08,CAPTPDCB(,COMMREG)                              0791
         ST    @08,CAPTCDCB(,COMMREG)                              0791
*       CAPTPDCB = TEMP;             /* SAVE CURRENT DCB POINTER     */
         ST    TEMP,CAPTPDCB(,COMMREG)                             0792
*       END;                                                       0793
*                                                                  0793
*   RESPECIFY (GPR15P) RSTD;                                       0794
@RF00788 DS    0H                                                  0795
*   GEN(IKJEBESH (COMMREG),IKJEBEMR,PARAM=((COMMREG)),MF=(E,X));   0795
         IKJEBESH (COMMREG),IKJEBEMR,PARAM=((COMMREG)),MF=(E,X)
*   STATUS = GPR15P;                 /* SAVE IKJEBEMR RETURN CODE    */
         LR    STATUS,GPR15P                                       0796
*   RESPECIFY (GPR15P) UNRSTD;                                     0797
*                                                                  0797
*   IF SECONDDS = YES                /* IS THERE SECOND UTILITY DS   */
*     THEN DO;                       /* SWITCH DCB POINTERS BACK     */
         TM    SECONDDS,B'10000000'                                0798
         BNO   @RF00798                                            0798
*       TEMP = CAPTCDCB;             /* SAVE CURRENT DCB POINTER     */
         L     TEMP,CAPTCDCB(,COMMREG)                             0800
*       CAPTCDCB = CAPTPDCB;         /* CHANGE CURRENT DCB POINTER   */
         L     @08,CAPTPDCB(,COMMREG)                              0801
         ST    @08,CAPTCDCB(,COMMREG)                              0801
*       CAPTPDCB = TEMP;             /* SAVE CURRENT DCB POINTER     */
         ST    TEMP,CAPTPDCB(,COMMREG)                             0802
*       END;                                                       0803
*                                                                  0803
*   IF STATUS ^= CONTINUE            /* IF ERROR IN IKJEBEMR         */
*     THEN MRERROR = YES;            /* INDICATE ERROR IN IKJEBEMR   */
*                                                                  0804
@RF00798 LTR   STATUS,STATUS                                       0804
         BZ    @RF00804                                            0804
         OI    MRERROR,B'00010000'                                 0805
*   RESPECIFY (GPR14P) RSTD;                                       0806
@RF00804 DS    0H                                                  0807
*   GPR14P = IPLIEX14;               /* RESTORE REG 14               */
         LR    GPR14P,IPLIEX14                                     0807
*   RESPECIFY (GPR14P) UNRSTD;                                     0808
*                                                                  0808
*END IPLIEXIT;                                                     0809
@EL00024 DS    0H                                                  0809
@EF00024 DS    0H                                                  0809
@ER00024 BR    @14                                                 0809
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          DATAEXIT PART 1                                         */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          SET UP THE PARAMETERS THAT WILL BE USED BY THE          */
*/*          INSTALLATION DATA EXIT                                  */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          INVOKE IKJEBEDC TO BUILD AN INCORE DATASET AND TO INIT  */
*/*          A PARM LIST DESCRIBING THE INCORE DATASET.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0810
*DATAEXIT:                                                         0810
*        PROC OPTIONS(NOSAVE);                                     0810
*                                                                  0810
DATAEXIT DS    0H                                                  0811
*   RESPECIFY (GPR14P) RSTD;                                       0811
*   DATAEX14 = GPR14P;               /* SAVE REG 14                  */
         LR    DATAEX14,GPR14P                                     0812
*   RESPECIFY (GPR14P) UNRSTD;                                     0813
*                                                                  0813
*   DCCAPTR = COMMREG;               /* SET POINTER TO IKJEBECA      */
         ST    COMMREG,DCCAPTR                                     0814
*   DCOUTPTR = ADDR(DSINFO);         /* POINT TO IKJEBEDC OUTPUT AREA*/
*                                                                  0815
         LA    @06,DSINFO                                          0815
         ST    @06,DCOUTPTR                                        0815
*   RESPECIFY (GPR00P,GPR01P) RSTD;                                0816
*   GPR00P = FOUR;                   /* ENTRY CODE FOR IKJEBEDC      */
         LA    GPR00P,4                                            0817
*   GPR01P = ADDR(DCPARMS);          /* POINT TO IKJEBEDC PARM LIST  */
         LA    GPR01P,DCPARMS                                      0818
*   DO; /* LINK  EP('IKJEBEDC') */                                 0819
*   I00601 ='00'X; /*EP/DE FLAG*/                                  0820
         MVI   I00601,X'00'                                        0820
*   I00602 =ADDR('IKJEBEDC');/*ADDR OF EP/DE*/                     0821
         LA    @03,@CC01494                                        0821
         STCM  @03,7,I00602                                        0821
*   I00604 = 0;/*DCB PTR*/                                         0822
         SLR   @03,@03                                             0822
         STCM  @03,7,I00604                                        0822
*   I00603 = '00'X;/*ERRET FLAG*/                                  0823
         MVI   I00603,X'00'                                        0823
*   RESPECIFY(GPR15P) RESTRICTED;                                  0824
*   GPR15P=ADDR(I006);/*ADDR OF LINK LIST*/                        0825
         LA    GPR15P,I006                                         0825
*   SVC (6);/*ISSUE LINK SVC*/                                     0826
         SVC   6                                                   0826
*   RESPECIFY(GPR15P) UNRESTRICTED;                                0827
*   END; /* LINK  EP('IKJEBEDC') */                                0828
*   RESPECIFY (GPR15P) RSTD;                                       0829
*                                                                  0829
*   STATUS = GPR15P;                 /* SAVE RET CODE FROM IKJEBEDC  */
         LR    STATUS,GPR15P                                       0830
*   RESPECIFY (GPR00P,GPR01P,GPR15P) UNRSTD;                       0831
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          DATAEXIT PART 2                                         */
*/*                                                                  */
*/*OPERATION CONTINUED-                                              */
*/*          BUILD THE PARAMETER LIST FOR IKJEBEDX AND INVOKE        */
*/*          IKJEBEDX WHICH WILL INTUN INVOKE THE INSTALLATION       */
*/*          DATAEXT ROUTINE.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0832
*   IF STATUS ^= CONTINUE            /* IF AN ERROR IN IKJEBEDC      */
*     THEN DCERROR = YES;            /* INDICATE ERROR IN IKJEBEDC   */
*                                                                  0832
         LTR   STATUS,STATUS                                       0832
         BZ    @RF00832                                            0832
         OI    DCERROR,B'00100000'                                 0833
*     ELSE DO;                       /* INVOKE DATA EXIT             */
         B     @RC00832                                            0834
@RF00832 DS    0H                                                  0835
*       EXUPTPTR=CAPTUPT;            /* PT TO UPT                    */
         L     @06,CAPTUPT(,COMMREG)                               0835
         ST    @06,EXUPTPTR                                        0835
*       EXECTPTR=CAPTECT;            /* PT TO ECT                    */
         L     @06,CAPTECT(,COMMREG)                               0836
         ST    @06,EXECTPTR                                        0836
*       EXEDAECB=CAPTECB;            /* PT TO ATTN ECB               */
         L     @06,CAPTECB(,COMMREG)                               0837
         ST    @06,EXEDAECB                                        0837
*       EXFLAGS(1) = ZERO;           /* DEFAULT FLAGS TO ZERO        */
*                                                                  0838
         MVI   EXFLAGS,X'00'                                       0838
*       IF CASEQCOL = YES            /* NON STD LINE NUMBERS         */
*         THEN EXBIT0 = YES;         /* INDICATE NON STD LINE #S     */
*                                                                  0839
         TM    CASEQCOL(COMMREG),B'00001000'                       0839
         BNO   @RF00839                                            0839
         OI    EXBIT0,B'10000000'                                  0840
*       IF COMMAND = MOVE            /* IF THIS IS MOVE              */
*         THEN EXBIT2 = YES;         /* THEN TURN ON THE MOVE BIT    */
@RF00839 CLI   COMMAND,1                                           0841
         BNE   @RF00841                                            0841
         OI    EXBIT2,B'00100000'                                  0842
*         ELSE EXBIT3 = YES;         /* ELSE TURN ON COPY BIT        */
*                                                                  0843
         B     @RC00841                                            0843
@RF00841 OI    EXBIT3,B'00010000'                                  0843
*       IF CARECFM = NO              /* IF RECORDS ARE VARIABLE      */
*         THEN EXBIT5 = YES;         /* INDICATE RECS ARE VARIABLE   */
*                                                                  0844
@RC00841 TM    CARECFM(COMMREG),B'01000000'                        0844
         BNZ   @RF00844                                            0844
         OI    EXBIT5,B'00000100'                                  0845
*       EXDSADDR = DSPTR;            /* POINT TO INCORE DATA SET     */
@RF00844 MVC   EXDSADDR(3),DSPTR+1                                 0846
*       EXSUBCIN=ADDR(DATEXSIA);     /* PT TO SUBCOMMAND INTERFACE   */
         LA    @06,DATEXSIA                                        0847
         ST    @06,EXSUBCIN                                        0847
*       EXDAATRB = ADDR(EXATTRB);    /* ADDR OF DATA SET ATTRIBUTES  */
*                                                                  0848
         LA    @06,EXATTRB                                         0848
         ST    @06,EXDAATRB                                        0848
*       EXSEQPOS = CALINE;           /* SEQUENCE NUMBER POSITION     */
         SLR   @06,@06                                             0849
         IC    @06,CALINE(,COMMREG)                                0849
         ST    @06,EXSEQPOS                                        0849
*       EXLNSEQN = CALENGTH;         /* LENGTH OF SEQUENCE NUMBER    */
         SLR   @06,@06                                             0850
         IC    @06,CALENGTH(,COMMREG)                              0850
         ST    @06,EXLNSEQN                                        0850
*       EXFIRST = FIRSTKEY;          /* FIRST LINE OF MOVE OR COPY   */
         L     @06,FIRSTKEY                                        0851
         ST    @06,EXFIRST                                         0851
*       EXLAST = LASTKEY;            /* LAST LINE OF MOVE OR COPY    */
         L     @06,LASTKEY                                         0852
         ST    @06,EXLAST                                          0852
*       EXFSTLN = INSRTKEY;          /* LINE INSERTED AFTER          */
         L     @06,INSRTKEY                                        0853
         ST    @06,EXFSTLN                                         0853
*       EXINCRE = THEINCR;           /* THE INCREMENT                */
         L     @06,THEINCR                                         0854
         ST    @06,EXINCRE                                         0854
*       EXCURLNP = DSCURLIN;         /* POINT TO THE CURRENT LINE    */
*                                                                  0855
         L     @06,DSCURLIN                                        0855
         ST    @06,EXCURLNP                                        0855
*       EXLRCL = DSLRECL;            /* LRECL FOR INCORE DATA SET    */
         L     @06,DSLRECL                                         0856
         ST    @06,EXLRCL                                          0856
*       EXLGNIDS = DSLEN;            /* LENGTH OF INCORE DATA SET    */
*                                                                  0857
         L     @06,DSLEN                                           0857
         ST    @06,EXLGNIDS                                        0857
*       DXDATAPT = ADDR(DATEXTPL);   /* POINT TO DATA EXIT PARMS     */
         LA    @06,DATEXTPL                                        0858
         ST    @06,DXDATAPT                                        0858
*       DXCAPT = COMMREG;            /* POINT TO IKJEBECA            */
*                                                                  0859
         ST    COMMREG,DXCAPT                                      0859
*       RESPECIFY (GPR01P) RSTD;                                   0860
*       GPR01P = ADDR(DXPARMS);      /* POINT TO INVOKER PARMS       */
         LA    GPR01P,DXPARMS                                      0861
*       DO; /* LINK  EP('IKJEBEDX') */                             0862
*       I00601 ='00'X; /*EP/DE FLAG*/                              0863
         MVI   I00601,X'00'                                        0863
*       I00602 =ADDR('IKJEBEDX');/*ADDR OF EP/DE*/                 0864
         LA    @03,@CC01499                                        0864
         STCM  @03,7,I00602                                        0864
*       I00604 = 0;/*DCB PTR*/                                     0865
         SLR   @03,@03                                             0865
         STCM  @03,7,I00604                                        0865
*       I00603 = '00'X;/*ERRET FLAG*/                              0866
         MVI   I00603,X'00'                                        0866
*       RESPECIFY(GPR15P) RESTRICTED;                              0867
*       GPR15P=ADDR(I006);/*ADDR OF LINK LIST*/                    0868
         LA    GPR15P,I006                                         0868
*       SVC (6);/*ISSUE LINK SVC*/                                 0869
         SVC   6                                                   0869
*       RESPECIFY(GPR15P) UNRESTRICTED;                            0870
*       END; /* LINK  EP('IKJEBEDX') */                            0871
*       RESPECIFY (GPR15P) RSTD;                                   0872
*       STATUS = GPR15P;             /* SAVE IKJEBEDX RET CODE       */
         LR    STATUS,GPR15P                                       0873
*       RESPECIFY (GPR01P,GPR15P) UNRSTD;                          0874
*                                                                  0874
*       IF STATUS = FOUR             /* RC = 4 FROM DATA EXIT        */
*         THEN STATUS = CONTINUE;    /* THEN ACTUALLY A CONTINUE     */
         C     STATUS,@CF00055                                     0875
         BNE   @RF00875                                            0875
         SLR   STATUS,STATUS                                       0876
*         ELSE STATUS = TERMNOER;    /* ELSE TERMINATE W/O ERR MSG   */
         B     @RC00875                                            0877
@RF00875 LA    STATUS,32                                           0877
*       END;                                                       0878
*                                                                  0878
@RC00875 DS    0H                                                  0879
*   RESPECIFY (GPR14P) RSTD;                                       0879
@RC00832 DS    0H                                                  0880
*   GPR14P = DATAEX14;               /* RESTORE REG 14               */
         LR    GPR14P,DATAEX14                                     0880
*   RESPECIFY (GPR14P) UNRSTD;                                     0881
*                                                                  0881
*END DATAEXIT;                                                     0882
@EL00025 DS    0H                                                  0882
@EF00025 DS    0H                                                  0882
@ER00025 BR    @14                                                 0882
*/********************************************************************/
*/*                                                                  */
*/*                              EPILOG                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0883
*                                                                  0883
*    DECLARE /*GENERAL PURPOSE REGISTERS */                        0883
*      GPR00P PTR(31) REG(0),                                      0883
*      GPR01P PTR(31) REG(1),                                      0883
*      GPR02P PTR(31) REG(2),                                      0883
*      GPR03P PTR(31) REG(3),                                      0883
*      GPR04P PTR(31) REG(4),                                      0883
*      GPR05P PTR(31) REG(5),                                      0883
*      GPR06P PTR(31) REG(6),                                      0883
*      GPR07P PTR(31) REG(7),                                      0883
*      GPR08P PTR(31) REG(8),                                      0883
*      GPR09P PTR(31) REG(9),                                      0883
*      GPR12P PTR(31) REG(12),                                     0883
*      GPR13P PTR(31) REG(13),                                     0883
*      GPR14P PTR(31) REG(14),                                     0883
*      GPR15P PTR(31) REG(15);                                     0883
*                                                                  0883
*    /* VARIABLES REQUIRED BY PL/S SYSTEM MACROS */                0884
*      DECLARE CASAVPTR PTR(31) BASED;/*SAVE AREA PTR FOR IKJEBESV*/
*      DECLARE COMMREG REG(9) PTR(31) RSTD;/*POINTER TO EDIT COMMO AREA
*/     DECLARE DATDREG REG(10) PTR(31) RSTD;/*BASEREG FOR EDIT SUBCOMMA
*D WORK AREA*/                                                     0885
*      DECLARE CASAVE CHAR(72) BASED;/*SAVE AREA EDIT MODULE*/     0887
*    DCL 1 I006 DEF(ILIST),/*DEFINE LIST*/                         0888
*          2 I00601 CHAR(1),/*EP/DE FLAG*/                         0888
*          2 I00602 PTR(24),/*EP/DE PTR*/                          0888
*          2 I00603 CHAR(1),/*ERRET FLAG*/                         0888
*          2 I00604 PTR(24),/*DCB PTR*/                            0888
*          2 I00605 PTR(31);/*ERRET PTR*/                          0888
*                                                                  0888
*    DECLARE ILIST CHAR(12) BDY(DWORD); /*STANDARD LIST*/          0889
*                                                                  0889
*    DECLARE /* COMMON VARIABLES */                                0890
*      I256C CHAR(256) BASED,                                      0890
*      I031F FIXED(31) BASED,                                      0890
*      I031P PTR(31)   BASED,                                      0890
*      I015F FIXED(15) BASED,                                      0890
*      I015P PTR(15)   BASED,                                      0890
*      I008P PTR(8)    BASED,                                      0890
*      I001C CHAR(1)   BASED;                                      0890
*/********************************************************************/
*/*                                                                  */
*/*                            PATCH AREA                            */
*/*                                                                  */
*/********************************************************************/
*      DCL PATCHLOC FIXED(31) STATIC;                              0891
*     GEN DATA DEFS(PATCHLOC);                                     0892
*   END IKJEBEMC                                                   0893
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IKJEBECA)                                        *
*/*%INCLUDE SYSLIB  (IKJPPL  )                                        *
*/*%INCLUDE SYSLIB  (IKJEBEMJ)                                        *
*;                                                                 0893
@EL00001 DS    0H                                                  0893
@EF00001 DS    0H                                                  0893
@ER00001 LM    @14,@12,12(@13)                                     0893
         BR    @14                                                 0893
@DATA    DS    0H
@SM01522 MVC   0(0,@01),FIRSTVAL(@08)
@SM01524 MVC   0(0,@01),LASTVAL(@08)
@SM01526 MVC   0(0,@01),NEWVAL(@08)
@SC01528 CLC   VALINCR(0,@08),FOXZERO
@SM01530 MVC   0(0,@03),VALINCR(@14)
@SM01532 MVC   LETXTTXT(0,COMMREG),STRNGVAL(@07)
@SM01534 MVC   STRNGVAL(0,@08),LETXTTXT(COMMREG)
@DATD    DSECT
         DS    0F
@SA00012 DS    14F
@SA00021 DS    14F
IKJEBEMC CSECT
         DS    0F
@CF00063 DC    F'1'
@CH00063 EQU   @CF00063+2
@CF00055 DC    F'4'
@CF00061 DC    F'8'
@CF00034 DC    F'12'
@CF00863 DC    F'16'
@CF00890 DC    F'32'
@CF01325 DC    F'100000000'
@DATD    DSECT
         DS    0D
MAINLI14 DS    A
CLEANU14 DS    A
SETLAS14 DS    A
SETFIR14 DS    A
SETNEW14 DS    A
OPERAN14 DS    A
CHECK14  DS    A
EBEUT14  DS    A
NEWUTI14 DS    A
RELINE14 DS    A
STEP114  DS    A
STEP214  DS    A
STEP314  DS    A
SETLIM14 DS    A
DELETR14 DS    A
RETCODE  DS    A
FIRSTKEY DS    A
LASTKEY  DS    A
INSRTKEY DS    A
LIMITKEY DS    A
THECOUNT DS    A
VERIFY   DS    A
THEINCR  DS    A
LOOPCNT  DS    A
FIRSTREC DS    A
ORIGFRST DS    A
COUNT    DS    A
COMMAND  DS    FL1
TYPE     DS    FL1
         DS    CL2
SERETCD  DS    CL4
         ORG   SERETCD
SECODE   DS    CL1
SEOFFSET DS    AL3
         ORG   SERETCD+4
SEPLIST  DS    CL24
         ORG   SEPLIST
SEDCBPTR DS    AL4
SEOFFS   DS    FL2
SESTRLEN DS    FL2
SETXTPTR DS    AL4
SEBFRPTR DS    AL4
SELNRNGE DS    AL4
@NM00025 DS    CL1
SEFLAGS  DS    CL1
         ORG   SEFLAGS
SEMODSW  DS    BL1
         ORG   SEPLIST+22
SECHARCT DS    FL2
         ORG   SEPLIST+24
         DS    CL4
SEPLISTD DS    CL8
         ORG   SEPLISTD
SESTART  DS    AL4
SEEND    DS    AL4
         ORG   SEPLISTD+8
LEPLIST  DS    CL8
         ORG   LEPLIST
LECODE   DS    CL1
LETXTPTR DS    AL3
LECAPTR  DS    AL4
         ORG   LEPLIST+8
READPARM DS    CL12
READFRST DS    CL12
READNEXT DS    CL12
READPREV DS    CL12
WRITESEQ DS    CL12
WRITEREC DS    CL12
DELETKEY DS    CL12
DATEXTPL DS    CL24
         ORG   DATEXTPL
EXUPTPTR DS    AL4
EXECTPTR DS    AL4
EXEDAECB DS    AL4
EXFLAGS  DS    CL1
         ORG   EXFLAGS
EXBIT0   DS    BL1
EXBIT1   EQU   EXFLAGS+0
EXBIT2   EQU   EXFLAGS+0
EXBIT3   EQU   EXFLAGS+0
EXBIT4   EQU   EXFLAGS+0
EXBIT5   EQU   EXFLAGS+0
         ORG   DATEXTPL+13
EXDSADDR DS    AL3
EXSUBCIN DS    AL4
EXDAATRB DS    AL4
         ORG   DATEXTPL+24
DATEXSIA DS    CL28
         ORG   DATEXSIA
EXSEQPOS DS    AL4
EXLNSEQN DS    FL4
EXFIRST  DS    FL4
EXLAST   DS    FL4
EXFSTLN  DS    FL4
EXINCRE  DS    FL4
EXCURLNP DS    FL4
         ORG   DATEXSIA+28
EXATTRB  DS    CL8
         ORG   EXATTRB
EXLRCL   DS    AL4
EXLGNIDS DS    AL4
         ORG   EXATTRB+8
DXPARMS  DS    CL8
         ORG   DXPARMS
DXDATAPT DS    AL4
DXCAPT   DS    AL4
         ORG   DXPARMS+8
DCPARMS  DS    CL8
         ORG   DCPARMS
DCCAPTR  DS    AL4
DCOUTPTR DS    AL4
         ORG   DCPARMS+8
DSINFO   DS    CL16
         ORG   DSINFO
DSPTR    DS    AL4
DSLEN    DS    AL4
DSLRECL  DS    AL4
DSCURLIN DS    AL4
         ORG   DSINFO+16
EMSPARMS DS    CL12
         ORG   EMSPARMS
EMSMSG1  DS    AL2
EMSMSG2  DS    AL2
EMSINS1  DS    AL4
EMSINS2  DS    AL4
         ORG   EMSPARMS+12
EMSTXT1  DS    CL13
         DS    CL3
EMSTXT2  DS    CL13
         DS    CL3
VALPARMS DS    CL44
PACKAREA DS    CL8
THEBITS  DS    CL1
         ORG   THEBITS
SECONDDS DS    BL1
PARSERR  EQU   THEBITS+0
DCERROR  EQU   THEBITS+0
MRERROR  EQU   THEBITS+0
         ORG   THEBITS+1
         DS    CL7
ILIST    DS    CL12
IKJEBEMC CSECT
         NOPR  ((@ENDDATD-@DATD)/673*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV01317 DC    V(IKJEBE1)
         DS    0D
VERERROR DC    AL4(TXTVER)
ESERROR  DC    AL4(TXTEBESE)
ELERROR  DC    AL4(TXTEBELE)
NOFIRST  DC    AL4(TXTBAD1)
LINESTRG DC    AL4(TXTLINST)
BADLAST1 DC    AL4(TXTNO0)
BADLAST2 DC    AL4(TXTNOSTR)
LINERNG  DC    AL4(TXTRANGE)
NOTEXT   DC    AL4(TXTNOTXT)
BADEND   DC    AL4(TXTEND)
MSG52312 DC    H'270'
MSG52313 DC    H'271'
MSG52501 DC    AL2(0-1287)
MSG52502 DC    AL2(0-1288)
MSG52578 DC    AL2(0-1544)
MSG52579 DC    H'1545'
MSG52580 DC    AL2(0-1546)
@CC01494 DC    C'IKJEBEDC'
@CC01499 DC    C'IKJEBEDX'
@CB01330 DC    X'0000000000000000'
         DS    CL2
TXTCMND  DS    CL17
         ORG   TXTCMND
@NM00027 DC    A(0)
@NM00028 DC    AL2(13)
@NM00029 DC    AL2(45)
@NM00030 DC    CL9'MOVE/COPY'
         ORG   TXTCMND+17
         DS    CL3
TXTPARS  DS    CL13
         ORG   TXTPARS
@NM00031 DC    A(0)
@NM00032 DC    AL2(9)
@NM00033 DC    AL2(10)
@NM00034 DC    CL5'PARSE'
         ORG   TXTPARS+13
         DS    CL3
TXTRC    DS    CL10
         ORG   TXTRC
@NM00035 DC    A(0)
@NM00036 DC    AL2(6)
@NM00037 DC    AL2(22)
@NM00038 DC    CL2'  '
         ORG   TXTRC+10
         DS    CL2
TXTLINST DS    CL53
         ORG   TXTLINST
@NM00039 DC    A(0)
@NM00040 DC    AL2(49)
@NM00041 DC    AL2(27)
@NM00042 DC    CL45'STRING INVALID FOR END OF RANGE SPECIFICATION'
         ORG   TXTLINST+53
         DS    CL3
TXTNO0   DS    CL30
         ORG   TXTNO0
@NM00043 DC    A(0)
@NM00044 DC    AL2(26)
@NM00045 DC    AL2(27)
@NM00046 DC    CL22'0 IS INVALID FOR COUNT'
         ORG   TXTNO0+30
         DS    CL2
TXTNOSTR DS    CL57
         ORG   TXTNOSTR
@NM00047 DC    A(0)
@NM00048 DC    AL2(53)
@NM00049 DC    AL2(27)
@NM00050 DC    CL49'* INVALID FOR COUNT OR END OF RANGE SPECIFICATION'
         ORG   TXTNOSTR+57
         DS    CL3
TXTRANGE DS    CL43
         ORG   TXTRANGE
@NM00051 DC    A(0)
@NM00052 DC    AL2(39)
@NM00053 DC    AL2(27)
@NM00054 DC    CL35'TRYING TO MOVE/COPY INTO LINE RANGE'
         ORG   TXTRANGE+43
         DS    CL1
TXTBAD1  DS    CL51
         ORG   TXTBAD1
@NM00055 DC    A(0)
@NM00056 DC    AL2(47)
@NM00057 DC    AL2(27)
@NM00058 DC    CL43'FIRST LINE TO BE MOVE/COPIED DOES NOT EXIST'
         ORG   TXTBAD1+51
         DS    CL1
TXTNOTXT DS    CL31
         ORG   TXTNOTXT
@NM00059 DC    A(0)
@NM00060 DC    AL2(27)
@NM00061 DC    AL2(27)
@NM00062 DC    CL23'QUOTED STRING NOT FOUND'
         ORG   TXTNOTXT+31
         DS    CL1
TXTEBESE DS    CL25
         ORG   TXTEBESE
@NM00063 DC    A(0)
@NM00064 DC    AL2(21)
@NM00065 DC    AL2(27)
@NM00066 DC    CL17'ERROR IN IKJEBESE'
         ORG   TXTEBESE+25
         DS    CL3
TXTEBELE DS    CL25
         ORG   TXTEBELE
@NM00067 DC    A(0)
@NM00068 DC    AL2(21)
@NM00069 DC    AL2(27)
@NM00070 DC    CL17'ERROR IN IKJEBELE'
         ORG   TXTEBELE+25
         DS    CL3
TXTVER   DS    CL37
         ORG   TXTVER
@NM00071 DC    A(0)
@NM00072 DC    AL2(33)
@NM00073 DC    AL2(27)
@NM00074 DC    CL29'LINE TO BE VERIFIED NOT FOUND'
         ORG   TXTVER+37
         DS    CL3
TXTEND   DS    CL80
         ORG   TXTEND
@NM00075 DC    A(0)
@NM00076 DC    AL2(76)
@NM00077 DC    AL2(27)
@NM00078 DC    CL72'END OF RANGE MUST BE GREATER THAN OR EQUAL TO THE BC
               EGINNING OF THE RANGE'
         ORG   TXTEND+80
FOXZERO  DC    CL8'00000000'
IKJEBEMC CSECT
IKJEBE1  IKJPARM DSECT=IKJPRMD1
FIRSTL   IKJIDENT 'LINE1',ASTERISK,MAXLNTH=8,                         **
               FIRST=NUMERIC,OTHER=NUMERIC
FIRSTS   IKJPOSIT QSTRING,ASIS
LAST     IKJIDENT 'LINE2 OR COUNT',MAXLNTH=8,ASTERISK,                **
               FIRST=NUMERIC,OTHER=NUMERIC
NEW      IKJIDENT 'LINE3 OR LINE4',ASTERISK,MAXLNTH=8,                **
               FIRST=NUMERIC,OTHER=NUMERIC
*
INCR     IKJKEYWD
         IKJNAME  'INCR',SUBFLD=INCRNUM
INCRNUM  IKJSUBF
INCRNO   IKJIDENT 'INCREMENT NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,     XX
               PROMPT='INCREMENT FROM 1 TO MAXIMUM LINE NUMBER',      XX
               HELP=('THIS IS THE INCREMENT FOR THE MOVE OR COPY'),   XX
               VALIDCK=INCRCHCK,MAXLNTH=8
         IKJENDP
*
* EQUATES REQUIRED BY GENERATED EDIT MACROS
*
RETREG    EQU   14                      REGISTER 14
RETCDREG  EQU   15                      REGISTER 15
PARMREG0  EQU   0                       REGISTER 0
PARMREG1  EQU   1                       REGISTER 1
IKJEBEMC CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEBEMC CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
UTPARMP  EQU   @04
TEMP     EQU   @03
OLDKEY   EQU   @08
NEWKEY   EQU   @07
STATUS   EQU   @06
IPLIEX14 EQU   @04
DATAEX14 EQU   @08
HANDLE14 EQU   @03
SETTYP14 EQU   @03
INIT14   EQU   @03
PARSE14  EQU   @08
PPLPTR   EQU   @04
COMMREG  EQU   @09
PDLPTR   EQU   @02
GPR01P   EQU   @01
GPR13P   EQU   @13
GPR15P   EQU   @15
DATDREG  EQU   @10
GPR12P   EQU   @12
GPR14P   EQU   @14
GPR02P   EQU   @02
GPR00P   EQU   @00
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR08P   EQU   @08
GPR09P   EQU   @09
CVTPTR   EQU   16
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
IKJEBECA EQU   0
CAPTLE   EQU   IKJEBECA+16
CAPTMS   EQU   IKJEBECA+20
CAPTUT   EQU   IKJEBECA+24
CAPTPRSD EQU   IKJEBECA+36
CAPRSPDL EQU   CAPTPRSD
CAFREEDL EQU   CAPRSPDL
CAPTIBFR EQU   IKJEBECA+40
CAOPERND EQU   CAPTIBFR
CAPTCDCB EQU   IKJEBECA+52
CAPTPDCB EQU   IKJEBECA+56
CAUTILNO EQU   IKJEBECA+60
CAATTN   EQU   IKJEBECA+120
CAATTNIS EQU   CAATTN
CACFLAG  EQU   IKJEBECA+124
CACFLAG1 EQU   CACFLAG
CALNTOVF EQU   CACFLAG1
CAVRFYSW EQU   CACFLAG1
CANONUM  EQU   CACFLAG1
CACFLAG2 EQU   CACFLAG+1
CARECFM  EQU   CACFLAG2
CASEQCOL EQU   CACFLAG2
CACFLAG3 EQU   CACFLAG+2
CAIMFLG  EQU   CACFLAG3
CACFLAG4 EQU   CACFLAG+3
CACFLAG5 EQU   CACFLAG+4
CACFLAG6 EQU   CACFLAG+5
CAPD     EQU   IKJEBECA+152
CALINE   EQU   CAPD+18
CALENGTH EQU   CAPD+19
CADSCODE EQU   CAPD+40
CADSATTR EQU   CAPD+41
CADSATR2 EQU   CAPD+42
CAPTPDXT EQU   IKJEBECA+228
CALRECL  EQU   IKJEBECA+232
CAEDFLAG EQU   IKJEBECA+236
CAEDFLG2 EQU   IKJEBECA+237
CASAFLAG EQU   IKJEBECA+376
CASAFLG2 EQU   IKJEBECA+377
CACURNUM EQU   IKJEBECA+456
CAINCRE  EQU   IKJEBECA+460
CARECNO  EQU   IKJEBECA+480
CASYNLST EQU   IKJEBECA+496
CASYNWA  EQU   IKJEBECA+508
CASYNOPT EQU   IKJEBECA+524
CASYNSW  EQU   CASYNOPT+3
CATMPLST EQU   IKJEBECA+528
CAPTUPT  EQU   CATMPLST
CAPTECT  EQU   CATMPLST+4
CAPTECB  EQU   CATMPLST+8
CAMAWKA  EQU   IKJEBECA+596
MACFLAGS EQU   CAMAWKA+28
MACFLAG2 EQU   CAMAWKA+29
CAMODEMG EQU   IKJEBECA+928
CASCWKA  EQU   IKJEBECA+1448
CABFRPL  EQU   IKJEBECA+2120
CATEMPBF EQU   IKJEBECA+2648
CANXTSVA EQU   IKJEBECA+3896
IKJEBECX EQU   0
CXDATEXT EQU   IKJEBECX
PPL      EQU   0
PPLPCL   EQU   PPL+12
PPLANS   EQU   PPL+16
PPLCBUF  EQU   PPL+20
PPLUWA   EQU   PPL+24
UTPARMS  EQU   0
UTCODE   EQU   UTPARMS
UTDCBPTR EQU   UTPARMS+1
UTKEYPTR EQU   UTPARMS+4
UTEOL2   EQU   UTKEYPTR
UTBUFPTR EQU   UTPARMS+8
UTEOL3   EQU   UTBUFPTR
TXTMAP   EQU   0
TXTNEXT  EQU   TXTMAP
TXTTXT   EQU   TXTMAP+8
VALCK    EQU   0
IPDE     EQU   VALCK
IWK      EQU   VALCK+4
INCRPDE  EQU   0
ICHARPTR EQU   INCRPDE
IWORD2   EQU   INCRPDE+4
ILENGTH  EQU   IWORD2
IFLAGS   EQU   IWORD2+2
IHERE    EQU   IFLAGS
FIRSTVAL EQU   0
STRNGVAL EQU   0
LASTVAL  EQU   0
NEWVAL   EQU   0
VALINCR  EQU   0
CASAVPTR EQU   0
CASAVE   EQU   0
INCRVAL  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
FIRSTLP  EQU   FIRSTL
FIRSTLL  EQU   FIRSTL+4
@NM00079 EQU   FIRSTL+6
FIRSTLF  EQU   @NM00079
FIRSTSP  EQU   FIRSTS
FIRSTSL  EQU   FIRSTS+4
@NM00080 EQU   FIRSTS+6
FIRSTSF  EQU   @NM00080
LASTP    EQU   LAST
LASTL    EQU   LAST+4
@NM00081 EQU   LAST+6
LASTF    EQU   @NM00081
NEWP     EQU   NEW
NEWL     EQU   NEW+4
@NM00082 EQU   NEW+6
NEWF     EQU   @NM00082
INCRP    EQU   INCR
@NM00083 EQU   INCR+6
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTPARS  EQU   CVTS01+176
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
LETXT    EQU   CABFRPL
LETXTLEN EQU   LETXT
LETXTTXT EQU   LETXT+4
THEBUFFR EQU   CABFRPL
THEKEY   EQU   THEBUFFR
I006     EQU   ILIST
I00601   EQU   I006
I00602   EQU   I006+1
I00603   EQU   I006+4
I00604   EQU   I006+5
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
I00605   EQU   I006+8
@NM00026 EQU   LETXT+2
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTRV612 EQU   CVTS01+664
CVTRV611 EQU   CVTS01+660
CVTRV610 EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTRV608 EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTRV519 EQU   CVTS01+92
CVTRV327 EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
INCRF    EQU   @NM00083
INCRL    EQU   INCR+4
IVALMSG  EQU   VALCK+8
TXTOFFST EQU   TXTMAP+6
TXTLEN   EQU   TXTMAP+4
PPLECB   EQU   PPL+8
PPLECT   EQU   PPL+4
PPLUPT   EQU   PPL
CAPDEXT  EQU   IKJEBECA+3984
CADSNRC2 EQU   IKJEBECA+3928
CADSNOF2 EQU   IKJEBECA+3926
CADSNLN2 EQU   IKJEBECA+3924
CADSNPT2 EQU   IKJEBECA+3920
@NM00024 EQU   IKJEBECA+3900
CASVAREA EQU   IKJEBECA+3176
CAFIBFR  EQU   IKJEBECA+1188
CAAEDCB  EQU   IKJEBECA+1096
CALDROP  EQU   IKJEBECA+1064
CAATNWKA EQU   IKJEBECA+956
CAATNBUF EQU   IKJEBECA+952
CAMODETX EQU   CAMODEMG+12
CAMODEOF EQU   CAMODEMG+10
CAMODELN EQU   CAMODEMG+8
CAMODEPT EQU   CAMODEMG+4
CAMODEIS EQU   CAMODEMG
CASRWKA  EQU   IKJEBECA+728
CAMSWKA  EQU   IKJEBECA+628
@NM00023 EQU   CAMAWKA+30
@NM00022 EQU   MACFLAG2
MATABLE1 EQU   MACFLAG2
@NM00021 EQU   MACFLAGS
MAENDPRC EQU   MACFLAGS
MAABBREV EQU   MACFLAGS
MAECTMOD EQU   MACFLAGS
@NM00020 EQU   CAMAWKA
CASTAEPL EQU   IKJEBECA+576
CASTAXPL EQU   IKJEBECA+556
CASRPLST EQU   CATMPLST+12
CASYNSCN EQU   CASYNSW
CASYNML  EQU   CASYNSW
CASYNSF  EQU   CASYNSW
CASYNRFM EQU   CASYNSW
CASYNIS  EQU   CASYNSW
@NM00019 EQU   CASYNSW
CASYNLN  EQU   CASYNSW
@NM00018 EQU   CASYNSW
CASYNRCL EQU   CASYNOPT+2
CASYNCD2 EQU   CASYNOPT+1
CASYNCD1 EQU   CASYNOPT
CASYNTEM EQU   CASYNWA+12
CASYNMS2 EQU   CASYNWA+8
CASYNMS1 EQU   CASYNWA+4
CASYNWAP EQU   CASYNWA+1
CASYNECD EQU   CASYNWA
CASYNPTO EQU   CASYNLST+8
CASYNPWA EQU   CASYNLST+4
CASYNBFR EQU   CASYNLST
@NM00017 EQU   IKJEBECA+484
CAINSAVE EQU   IKJEBECA+476
@NM00016 EQU   IKJEBECA+472
CAIMLINC EQU   IKJEBECA+468
CAIMLLNO EQU   IKJEBECA+464
CANXTREC EQU   IKJEBECA+452
CASTNUM  EQU   IKJEBECA+448
CASAPSWD EQU   IKJEBECA+440
CASADDN  EQU   IKJEBECA+432
CASAMEMB EQU   IKJEBECA+424
CASADSN  EQU   IKJEBECA+380
CASADSNL EQU   IKJEBECA+378
CASADQTY EQU   CASAFLG2
CASANCTG EQU   CASAFLG2
CASAALOC EQU   CASAFLAG
CASAUNCG EQU   CASAFLAG
CASADSOR EQU   CASAFLAG
CASAMEM  EQU   CASAFLAG
CASADISP EQU   CASAFLAG
CASAINCP EQU   CASAFLAG
CASAFNCP EQU   CASAFLAG
CASAVEDS EQU   CASAFLAG
CADSNREC EQU   IKJEBECA+320
CADSNOFF EQU   IKJEBECA+318
CADSNLEN EQU   IKJEBECA+316
CADSNPTR EQU   IKJEBECA+312
CAEDTSIZ EQU   IKJEBECA+308
CAEDPSWD EQU   IKJEBECA+300
CAEDDDN  EQU   IKJEBECA+292
CAEDMEMB EQU   IKJEBECA+284
CAEDDSN  EQU   IKJEBECA+240
CAEDDSNL EQU   IKJEBECA+238
CAEDPRTC EQU   CAEDFLG2
CAEDALOC EQU   CAEDFLAG
CAEDUNCG EQU   CAEDFLAG
CAEDDSOR EQU   CAEDFLAG
CAEDMEM  EQU   CAEDFLAG
CAEDDISP EQU   CAEDFLAG
CAEDINCP EQU   CAEDFLAG
CAEDFNCP EQU   CAEDFLAG
CAEDITDS EQU   CAEDFLAG
CABLK2   EQU   IKJEBECA+234
@NM00015 EQU   IKJEBECA+226
CAPDEND  EQU   CAPD+82
CADATEXT EQU   CAPD+74
CAEXTNAM EQU   CAPD+66
CAPRNAME EQU   CAPD+58
CACHKOPT EQU   CAPD+56
CAULRLMX EQU   CAPD+54
CAULRLDF EQU   CAPD+52
CAVLRLMX EQU   CAPD+50
CAVLRLDF EQU   CAPD+48
CAFLRLMX EQU   CAPD+46
CAFLRLDF EQU   CAPD+44
CARECFMD EQU   CAPD+43
@NM00014 EQU   CADSATR2
CAINLIST EQU   CADSATR2
CARUNDS  EQU   CADSATR2
CAOBJGEN EQU   CADSATR2
CADSNDEF EQU   CADSATR2
CALINTAB EQU   CADSATR2
@NM00013 EQU   CADSATTR
CALRECLX EQU   CADSATTR
CALNNUM  EQU   CADSATTR
CADSCONT EQU   CADSATTR
CACAPSDF EQU   CADSATTR
CACAPSRQ EQU   CADSATTR
CASCAN   EQU   CADSATTR
CARUN    EQU   CADSATTR
CASYNAME EQU   CAPD+32
CATABS   EQU   CAPD+20
CABLKS   EQU   CAPD+16
CADSQUAL EQU   CAPD+8
CADSTYPE EQU   CAPD
@NM00012 EQU   CACFLAG+8
CAPLIRTM EQU   CACFLAG+7
CAPLILFM EQU   CACFLAG+6
@NM00011 EQU   CACFLAG6
CACHAR60 EQU   CACFLAG6
CACHAR48 EQU   CACFLAG6
CAFREE   EQU   CACFLAG6
@NM00010 EQU   CACFLAG5
CAEDLNDP EQU   CACFLAG5
CADSUSED EQU   CACFLAG4
CARECURS EQU   CACFLAG4
CAINPROC EQU   CACFLAG4
CASCRC20 EQU   CACFLAG4
CAABEND  EQU   CACFLAG4
CATPUTVF EQU   CACFLAG4
CAPTGTBF EQU   CACFLAG4
CAFINDIS EQU   CACFLAG4
@NM00009 EQU   CAIMFLG
CAIMINPT EQU   CAIMFLG
CAIMSFPT EQU   CAIMFLG
CAIMCIN  EQU   CAIMFLG
CAIMIR   EQU   CAIMFLG
CAIMSC   EQU   CAIMFLG
CAIMINS  EQU   CAIMFLG
CAIMPT   EQU   CAIMFLG
@NM00008 EQU   CACFLAG2
CAMODMSG EQU   CACFLAG2
CASCANON EQU   CACFLAG2
CADSMODS EQU   CACFLAG2
CACAPS   EQU   CACFLAG1
CAENDSC  EQU   CACFLAG1
CAINITSC EQU   CACFLAG1
CASCANSW EQU   CACFLAG1
CAPROMPT EQU   CACFLAG1
@NM00007 EQU   CAATTN
@NM00006 EQU   IKJEBECA+118
CAMAXBLK EQU   IKJEBECA+116
@NM00005 EQU   IKJEBECA+88
CAPTICLN EQU   IKJEBECA+84
CAPTICDS EQU   IKJEBECA+80
CAPTNBFR EQU   IKJEBECA+76
CAPTCHK  EQU   IKJEBECA+72
CACORELN EQU   IKJEBECA+68
CAPTCORE EQU   IKJEBECA+64
@NM00004 EQU   IKJEBECA+50
CASCMDLN EQU   IKJEBECA+48
CAPTSCMD EQU   IKJEBECA+44
CAPTRTRY EQU   IKJEBECA+32
CAPTMSGM EQU   IKJEBECA+28
CAPTAT   EQU   IKJEBECA+12
CAPTAE   EQU   IKJEBECA+8
@NM00003 EQU   IKJEBECA+4
CAPTTMP  EQU   IKJEBECA
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00002 EQU   CVTFIX+248
@NM00001 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRSV37 EQU   CVTDMSR
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00243 EQU   @RC00237
@RC00241 EQU   @RC00237
@RF00329 EQU   @RC00323
@RC00344 EQU   @RC00343
@RF00447 EQU   @EL00012
@RC00439 EQU   @EL00012
@RC00437 EQU   @EL00012
@RF00497 EQU   @RC00493
@RF00500 EQU   @RC00493
@RF00663 EQU   @EL00021
@RC00679 EQU   @EL00021
@RC00737 EQU   @RC00736
@RC00757 EQU   @RC00756
@RF00358 EQU   @RC00344
@RC00350 EQU   @RC00344
@RC00442 EQU   @RC00439
@RC00440 EQU   @RC00439
@RF00355 EQU   @RC00350
@ENDDATA EQU   *
         END   IKJEBEMC,(C'PLS1616',0701,75328)

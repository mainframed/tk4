         TITLE 'ISTIC005-OPTION DECODE'
ISTIC005 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISTIC005  78.336'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
*   R3=R13;                                                        0046
         LR    R3,R13                                              0046
*   R13=ADDR(SVEIC003);                                            0047
         LA    R13,SVEIC003(,WAPTR)                                0047
*   BACKSAVE(3)=R13;                                               0048
         ST    R13,BACKSAVE+8(,R3)                                 0048
*   SVEIC003(2)=R3;                                                0049
         ST    R3,SVEIC003+4(,WAPTR)                               0049
*   OPTS=A33OPTN;                   /* MOVE OPTIONS TO WORK          */
         MVC   OPTS(44),A33OPTN                                    0050
*   IF $OPTMSG='1'B THEN            /* OPTION MSG REQUESTED ?        */
         TM    $OPTMSG(WAPTR),B'10000000'                          0051
         BNO   @RF00051                                            0051
*     DO;                           /* SET UP OPTIONS ARE MSG        */
*       EBTL='N';                                                  0053
         MVI   EBTL,C'N'                                           0053
*       IF $LOOPTST='1'B THEN       /* TEST LOOP (TL)                */
         TM    $LOOPTST(WAPTR),B'00000001'                         0054
         BNO   @RF00054                                            0054
*         EBTL=' ';                                                0055
         MVI   EBTL,C' '                                           0055
*       EBEL='N';                                                  0056
@RF00054 MVI   EBEL,C'N'                                           0056
*       IF $LOOPERR='1'B THEN       /* ERROR LOOP (EL)               */
         TM    $LOOPERR(WAPTR),B'00000010'                         0057
         BNO   @RF00057                                            0057
*         EBEL=' ';                                                0058
         MVI   EBEL,C' '                                           0058
*       EBPP='N';                                                  0059
@RF00057 MVI   EBPP,C'N'                                           0059
*       IF $ALTPRNT='1'B THEN       /* PARALLEL PRINT (PP)           */
         TM    $ALTPRNT(WAPTR),B'00010000'                         0060
         BNO   @RF00060                                            0060
*         EBPP=' ';                                                0061
         MVI   EBPP,C' '                                           0061
*       EBFE='N';                                                  0062
@RF00060 MVI   EBFE,C'N'                                           0062
*       IF $FSTCOMM='1'B THEN       /* FIRST ERROR COMM. (FE)        */
         TM    $FSTCOMM(WAPTR),B'00000001'                         0063
         BNO   @RF00063                                            0063
*         EBFE=' ';                                                0064
         MVI   EBFE,C' '                                           0064
*       EBMI='N';                                                  0065
@RF00063 MVI   EBMI,C'N'                                           0065
*       IF $MANINTV='1'B THEN       /* MANUAL INTERVENT (MI)         */
         TM    $MANINTV(WAPTR),B'10000000'                         0066
         BNO   @RF00066                                            0066
*         EBMI=' ';                                                0067
         MVI   EBMI,C' '                                           0067
*       EBEP='N';                                                  0068
@RF00066 MVI   EBEP,C'N'                                           0068
*       IF $NERRPRT='0'B THEN       /* ERROR PRINT (EP)              */
         TM    $NERRPRT(WAPTR),B'00000100'                         0069
         BNZ   @RF00069                                            0069
*         EBEP=' ';                                                0070
         MVI   EBEP,C' '                                           0070
*       EBCP='N';                                                  0071
@RF00069 MVI   EBCP,C'N'                                           0071
*       IF $NOCNTRL='1'B THEN       /* CONTROL PRINT (CP)            */
         TM    $NOCNTRL(WAPTR),B'00001000'                         0072
         BNO   @RF00072                                            0072
*         EBCP=' ';                                                0073
         MVI   EBCP,C' '                                           0073
*       EBPR='N';                                                  0074
@RF00072 MVI   EBPR,C'N'                                           0074
*       IF $NOPRT='1'B THEN         /* PRINT (PR)                    */
         TM    $NOPRT(WAPTR),B'00000100'                           0075
         BNO   @RF00075                                            0075
*         EBPR=' ';                                                0076
         MVI   EBPR,C' '                                           0076
*       EBTR='N';                                                  0077
@RF00075 MVI   EBTR,C'N'                                           0077
*       IF $TRACE='1'B THEN         /* TRACE (TR)                    */
         TM    $TRACE(WAPTR),B'00000100'                           0078
         BNO   @RF00078                                            0078
*         EBTR=' ';                                                0079
         MVI   EBTR,C' '                                           0079
*       EBAP='N';                                                  0080
@RF00078 MVI   EBAP,C'N'                                           0080
*       IF $ALTPRTR='1'B THEN       /* ALTERNATE PRINT (AP)          */
         TM    $ALTPRTR(WAPTR),B'00000010'                         0081
         BNO   @RF00081                                            0081
*         EBAP=' ';                                                0082
         MVI   EBAP,C' '                                           0082
*       $INBUFR(1:43)=OPTS;         /* MOVE OPTIONS FOR CECOM        */
*                                                                  0083
@RF00081 MVC   $INBUFR(43,WAPTR),OPTS                              0083
*       /*************************************************************/
*       /*                                                           */
*       /* TCEC MSGN(107)SUB(YES) INVOKED                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0084
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */
         OI    $TCECM(WAPTR),B'00000001'                           0084
*       R1=ADDR($TCA09);            /* SET UP PARM LIST $TR          */
         LA    R1,$TCA09                                           0085
*       CALL #EXIT;                 /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0086
         BALR  @14,@15                                             0086
*       DCL                                                        0087
*         1 $TCA09,                 /* TCEC PARM LIST                */
*          2 $TCB09 FIXED(32) INIT(107),/* MSG NUMBER                */
*          2 $TCC09 FIXED(32) INIT(0),/* INCT LEN                    */
*          2 $TCD09 BIT(8) INIT('10000000'B),/* FLAG                 */
*          2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE 0087
*                                      OPTIONS ARE ....              */
*       R3=$EXTA(1);                /* GET EXTERNAL DATA SIZE        */
         SLR   R3,R3                                               0088
         IC    R3,$EXTA(,WAPTR)                                    0088
*       IF R3^=0 THEN               /* IF EXT= HAS BEEN ENTER        */
         LTR   R3,R3                                               0089
         BZ    @RF00089                                            0089
*         DO;                       /* THEN SET UP TO WRITE NS       */
*           R4=R3+1;                                               0091
         LA    R4,1                                                0091
         ALR   R4,R3                                               0091
*           $INBUFR(1:54)='';                                      0092
         MVI   $INBUFR(WAPTR),C' '                                 0092
         MVC   $INBUFR+1(53,WAPTR),$INBUFR(WAPTR)                  0092
*           $INBUFR(1:R3)=$EXTA(2:R4);                             0093
*                                                                  0093
         LR    @14,R3                                              0093
         BCTR  @14,0                                               0093
         EX    @14,@SM00860                                        0093
*           /*********************************************************/
*           /*                                                       */
*           /* TCEC MSGN(327)SUB(YES) INVOKED                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0094
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */
         OI    $TCECM(WAPTR),B'00000001'                           0094
*           R1=ADDR($TCA10);        /* SET UP PARM LIST $TR          */
         LA    R1,$TCA10                                           0095
*           CALL #EXIT;             /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0096
         BALR  @14,@15                                             0096
*           DCL                                                    0097
*             1 $TCA10,             /* TCEC PARM LIST                */
*              2 $TCB10 FIXED(32) INIT(327),/* MSG NUMBER            */
*              2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                */
*              2 $TCD10 BIT(8) INIT('10000000'B),/* FLAG             */
*              2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0097
*                                      ISSUE EXT= MSG                */
*         END;                                                     0098
*       $OPTMSG='0'B;               /* RESET OPT MESSAGE SWT         */
@RF00089 NI    $OPTMSG(WAPTR),B'01111111'                          0099
*       GO TO OPT900;                                              0100
         B     OPT900                                              0100
*     END;                                                         0101
*   R3=$SLASHAD(2)+1;               /* PT TO 1ST CHAR OF OPTS        */
@RF00051 LA    R3,1                                                0102
         AL    R3,$SLASHAD+4(,WAPTR)                               0102
*   IF R3=$SLASHAD(3) THEN          /* SLASH ENTERED ?               */
         C     R3,$SLASHAD+8(,WAPTR)                               0103
         BE    @RT00103                                            0103
*     GO TO OPT900;                                                0104
*   A33SAVE=A33SAVE&&A33SAVE;       /* CLEAR SAVE AREA               */
         XC    A33SAVE(11),A33SAVE                                 0105
*   A33SAVE(1)=$TESTOPT;            /* SAVE                          */
         MVC   A33SAVE(1),$TESTOPT(WAPTR)                          0106
*   A33SAVE(2)=$ERROPT;             /* OLD                           */
         MVC   A33SAVE+1(1),$ERROPT(WAPTR)                         0107
*   A33SAVE(3)=$EXECFLG;            /* OPTIONS                       */
         MVC   A33SAVE+2(1),$EXECFLG(WAPTR)                        0108
*   A33SAVE(4)=$OLTFLGS;            /* AND                           */
         MVC   A33SAVE+3(1),$OLTFLGS(WAPTR)                        0109
*   A33SAVE(5)=$PRNTLVL;            /* CONSTANTS                     */
         MVC   A33SAVE+4(1),$PRNTLVL(WAPTR)                        0110
*   A33SAVE(6:7)=$ERRCNTA;          /*                               */
         MVC   A33SAVE+5(2),$ERRCNTA(WAPTR)                        0111
*   A33SAVE(8:9)=$TLCNT;                                           0112
         MVC   A33SAVE+7(2),$TLCNT(WAPTR)                          0112
*   A33SAVE(10)=$FLAG9;                                            0113
         MVC   A33SAVE+9(1),$FLAG9(WAPTR)                          0113
*   INTFLAGS=INTFLAGS&&INTFLAGS;    /* INIT INTERNAL FLAGS           */
         XC    INTFLAGS(1),INTFLAGS                                0114
*                                                                  0115
*   /*****************************************************************/
*   /*                                                               */
*   /* DECODE OPTION FIELD                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0115
*OPT050:                                                           0115
*   NO='0'B;                        /* SET NEGATIVE OPT FLAG         */
OPT050   NI    NO,B'01111111'                                      0115
*   IF INPUTBUF(1)='N' THEN         /* CHK 1ST CHAR= N               */
         CLI   INPUTBUF(R3),C'N'                                   0116
         BNE   @RF00116                                            0116
*     DO;                                                          0117
*       NO='1'B;                    /* YES SET FLAG ON               */
         OI    NO,B'10000000'                                      0118
*       R3=R3+1;                    /* PT TO OPTION                  */
         AL    R3,@CF00072                                         0119
*     END;                                                         0120
*   IF INPUTBUF(1:2)='TL' THEN      /* TEST LOOP SPECIFIED           */
@RF00116 CLC   INPUTBUF(2,R3),@CC00763                             0121
         BNE   @RF00121                                            0121
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NTL SPECIFIED                 */
         TM    NO,B'10000000'                                      0123
         BZ    @RT00123                                            0123
*         GO TO OPT300;             /* NO,PROCESS TL                 */
*       $LOOPTST='0'B;              /* TURN TL OFF                   */
         NI    $LOOPTST(WAPTR),B'11111110'                         0125
*       $TLCNT=1;                   /* INITIALIZE COUNT              */
         MVC   $TLCNT(2,WAPTR),@CH00072                            0126
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0127
*     END;                                                         0128
*   IF INPUTBUF(1:2)='EL' THEN      /* ERROR LOOP SPECIFIED          */
@RF00121 CLC   INPUTBUF(2,R3),@CC00766                             0129
         BNE   @RF00129                                            0129
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NEL SPECIFIED                 */
         TM    NO,B'10000000'                                      0131
         BZ    @RT00131                                            0131
*         GO TO OPT200;             /* NO,PROCESS EL                 */
*       $LOOPERR='0'B;              /* TURN EL OFF                   */
         NI    $LOOPERR(WAPTR),B'11111101'                         0133
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0134
*     END;                                                         0135
*   IF INPUTBUF(1:2)='PP' THEN      /* PARALLEL PRINT SPECIFED       */
@RF00129 CLC   INPUTBUF(2,R3),@CC00768                             0136
         BNE   @RF00136                                            0136
*     DO;                           /* YES                           */
*       IF NO='0'B THEN             /* NPP SPECIFIED                 */
         TM    NO,B'10000000'                                      0138
         BZ    @RT00138                                            0138
*         GO TO OPT100;             /* NO PROCESS PP                 */
*       $ALTPRNT='0'B;              /* TURN OFF PP                   */
         NI    $ALTPRNT(WAPTR),B'11101111'                         0140
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */
         B     OPT070                                              0141
*     END;                                                         0142
*   IF INPUTBUF(1:2)='AP'&$OLTACT='0'B THEN/* ALTERNATE PRINTER      */
@RF00136 CLC   INPUTBUF(2,R3),@CC00770                             0143
         BNE   @RF00143                                            0143
         TM    $OLTACT(WAPTR),B'00000001'                          0143
         BNZ   @RF00143                                            0143
*     DO;                           /* YES                           */
*       GO TO OPT400;                                              0145
         B     OPT400                                              0145
*     END;                                                         0146
*   IF INPUTBUF(1:2)='FE' THEN      /* FIRST ERROR COMM              */
@RF00143 CLC   INPUTBUF(2,R3),@CC00772                             0147
         BNE   @RF00147                                            0147
*     DO;                           /* YES                           */
*       $FSTCOMM='0'B;              /* SET NFE                       */
         NI    $FSTCOMM(WAPTR),B'11111110'                         0149
*       IF NO='0'B THEN             /* FE SPECIFIED                  */
         TM    NO,B'10000000'                                      0150
         BNZ   @RF00150                                            0150
*         $FSTCOMM='1'B;            /* YES                           */
         OI    $FSTCOMM(WAPTR),B'00000001'                         0151
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0152
*     END;                                                         0153
*   IF INPUTBUF(1:2)='MI' THEN      /* MANUAL INTERVENTION           */
@RF00147 CLC   INPUTBUF(2,R3),@CC00773                             0154
         BNE   @RF00154                                            0154
*     DO;                           /* YES                           */
*       $MANINTV='0'B;              /* SET NMI                       */
         NI    $MANINTV(WAPTR),B'01111111'                         0156
*       IF NO='0'B THEN             /* MI SPECIFIED                  */
         TM    NO,B'10000000'                                      0157
         BNZ   @RF00157                                            0157
*         $MANINTV='1'B;            /* YES                           */
         OI    $MANINTV(WAPTR),B'10000000'                         0158
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0159
*     END;                                                         0160
*   IF INPUTBUF(1:2)='EP' THEN      /* ERROR PRINT                   */
@RF00154 CLC   INPUTBUF(2,R3),@CC00774                             0161
         BNE   @RF00161                                            0161
*     DO;                           /* YES                           */
*       $NERRPRT='1'B;              /* SET NEP                       */
         OI    $NERRPRT(WAPTR),B'00000100'                         0163
*       IF NO='0'B THEN             /* EP SPECIFIED                  */
         TM    NO,B'10000000'                                      0164
         BNZ   @RF00164                                            0164
*         $NERRPRT='0'B;            /* YES                           */
         NI    $NERRPRT(WAPTR),B'11111011'                         0165
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0166
*     END;                                                         0167
*   IF INPUTBUF(1:2)='CP' THEN      /* CONTROL PRINT                 */
@RF00161 CLC   INPUTBUF(2,R3),@CC00775                             0168
         BNE   @RF00168                                            0168
*     DO;                           /* YES                           */
*       $NOCNTRL='0'B;              /* SET NCP                       */
         NI    $NOCNTRL(WAPTR),B'11110111'                         0170
*       IF NO='0'B THEN             /* CP SPECIFIED                  */
         TM    NO,B'10000000'                                      0171
         BNZ   @RF00171                                            0171
*         $NOCNTRL='1'B;            /* YES                           */
         OI    $NOCNTRL(WAPTR),B'00001000'                         0172
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0173
*     END;                                                         0174
*   IF INPUTBUF(1:2)='PR' THEN      /* PRINT                         */
@RF00168 CLC   INPUTBUF(2,R3),@CC00776                             0175
         BNE   @RF00175                                            0175
*     DO;                           /* YES                           */
*       $NOPRT='0'B;                /* SET NPR                       */
         NI    $NOPRT(WAPTR),B'11111011'                           0177
*       IF NO='0'B THEN             /* PR SPECIFIED                  */
         TM    NO,B'10000000'                                      0178
         BNZ   @RF00178                                            0178
*         $NOPRT='1'B;              /* YES                           */
         OI    $NOPRT(WAPTR),B'00000100'                           0179
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0180
*     END;                                                         0181
*   IF INPUTBUF(1:2)='TR' THEN      /* TRACE                         */
@RF00175 CLC   INPUTBUF(2,R3),@CC00777                             0182
         BNE   @RF00182                                            0182
*     DO;                           /* YES                           */
*       $TRACE='0'B;                /* SET NTR                       */
         NI    $TRACE(WAPTR),B'11111011'                           0184
*       IF NO='0'B THEN             /* TR SPECIFIED                  */
         TM    NO,B'10000000'                                      0185
         BNZ   @RF00185                                            0185
*         $TRACE='1'B;              /* YES                           */
         OI    $TRACE(WAPTR),B'00000100'                           0186
*       GO TO OPT070;               /* DECODE NEXT                   */
         B     OPT070                                              0187
*     END;                                                         0188
*   IF INPUTBUF(1:4)='EXT=' THEN    /* EXTERNAL DATA                 */
@RF00182 CLC   INPUTBUF(4,R3),@CC00778                             0189
         BNE   @RF00189                                            0189
*     DO;                           /* YES                           */
*       R3=R3+4;                    /* POINT TO DATA                 */
         AL    R3,@CF00068                                         0191
*       IF INPUTBUF(1)='/' THEN     /* END OF OPTION FIELD           */
         CLI   INPUTBUF(R3),C'/'                                   0192
         BNE   @RF00192                                            0192
*         DO;                       /* YES,CONTINUE                  */
*           $EXTA=$EXTA&&$EXTA;     /* INIT EXTERNAL DATA AREA       */
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0194
*           GO TO OPT080;           /* CHECK FOR END OF FIELD        */
         B     OPT080                                              0195
*         END;                                                     0196
*       R4=$SLASHAD(3)-R3;          /* CALCULATE LENGTH              */
@RF00192 L     R4,$SLASHAD+8(,WAPTR)                               0197
         SLR   R4,R3                                               0197
*       IF R4<1×                    /* CHECK FOR                     */
*           R4>54 THEN              /* VALID LENGTH                  */
         LA    @14,1                                               0198
         CR    R4,@14                                              0198
         BL    @RT00198                                            0198
         C     R4,@CF00752                                         0198
         BH    @RT00198                                            0198
*         GO TO OPT800;             /* INVALID LENGTH                */
*       $EXTA=$EXTA&&$EXTA;         /* CLEAR AREA                    */
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0200
*       EXTNUMFX=R4;                /* MOVE COUNT                    */
         ST    R4,EXTNUMFX                                         0201
*       $EXTA(1)=EXTNUMCH;          /* INTO FIRST BYTE               */
         MVC   $EXTA(1,WAPTR),EXTNUMCH                             0202
*       R4=R4+1;                    /* ADD 1 FOR SUBSCRIPT           */
         ALR   R4,@14                                              0203
*       $EXTA(2:R4)=INPUTBUF;       /* MOVE IN DATA                  */
         LR    @14,R4                                              0204
         BCTR  @14,0                                               0204
         BCTR  @14,0                                               0204
         EX    @14,@SM00870                                        0204
*       R3=R3+EXTNUMFX;                                            0205
         L     @14,EXTNUMFX                                        0205
         ALR   R3,@14                                              0205
*       GO TO OPT080;               /* CHK FOR MUTALLY EXCL          */
         B     OPT080                                              0206
*     END;                                                         0207
*   R3=R3+1;                        /* PT TO INVALID OPTION          */
@RF00189 AL    R3,@CF00072                                         0208
*   GO TO OPT800;                   /* ERROR,INVALID OPTION          */
         B     OPT800                                              0209
*OPT070:                                                           0210
*   R3=R3+2;                        /* PT TO NEXT ENTRY              */
OPT070   AL    R3,@CF00139                                         0210
*OPT075:                                                           0211
*   IF INPUTBUF(1)=',' THEN         /* IS IT A COMMA                 */
OPT075   CLI   INPUTBUF(R3),C','                                   0211
         BNE   @RF00211                                            0211
*     DO;                                                          0212
*       R3=R3+1;                    /* PT TO NEXT OPTION             */
         AL    R3,@CF00072                                         0213
*       GO TO OPT050;               /* DEODE NEXT ENTRY              */
         B     OPT050                                              0214
*     END;                                                         0215
*OPT080:                                                           0216
*   IF INPUTBUF(1)='/' THEN         /* END OF OPT FIELD              */
@RF00211 DS    0H                                                  0216
OPT080   CLI   INPUTBUF(R3),C'/'                                   0216
         BE    @RT00216                                            0216
*     GO TO OPT900;                 /* YES,RETURN                    */
*   GO TO OPT800;                   /* NO,ERROR                      */
         B     OPT800                                              0218
*                                                                  0219
*   /*****************************************************************/
*   /*                                                               */
*   /* PP OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0219
*OPT100:                                                           0219
*   $ALTPRNT='1'B;                  /* SET PARALLEL PRINT            */
OPT100   OI    $ALTPRNT(WAPTR),B'00010000'                         0219
*   $PRNTLVL='2';                   /* SET DEFAULT LEVEL             */
         MVI   $PRNTLVL(WAPTR),C'2'                                0220
*   IF INPUTBUF(3)='(' THEN         /* WILL PRNT LVL BE SPEC ?       */
         CLI   INPUTBUF+2(R3),C'('                                 0221
         BNE   @RF00221                                            0221
*     DO;                                                          0222
*       IF INPUTBUF(4)<'0'×         /* YES                           */
*           INPUTBUF(4)>'3' THEN    /* CHK HIGH-LOW LEGAL RNGE       */
         CLI   INPUTBUF+3(R3),C'0'                                 0223
         BL    @RT00223                                            0223
         CLI   INPUTBUF+3(R3),C'3'                                 0223
         BNH   @RF00223                                            0223
@RT00223 DS    0H                                                  0224
*         DO;                                                      0224
*           R3=R3+3;                /* ERROR                         */
         AL    R3,@CF00081                                         0225
*           GO TO OPT800;                                          0226
         B     OPT800                                              0226
*         END;                                                     0227
*       $PRNTLVL=INPUTBUF(4);       /* MOVE PRNT LEVEL TO TWA        */
@RF00223 MVC   $PRNTLVL(1,WAPTR),INPUTBUF+3(R3)                    0228
*OPT150:                                                           0229
*       IF INPUTBUF(5)^=')' THEN    /* CHK SYNTAX                    */
OPT150   CLI   INPUTBUF+4(R3),C')'                                 0229
         BE    @RF00229                                            0229
*         DO;                                                      0230
*           R3=R3+4;                /* ERROR                         */
         AL    R3,@CF00068                                         0231
*           GO TO OPT800;                                          0232
         B     OPT800                                              0232
*         END;                                                     0233
*       R3=R3+5;                    /* PT TO , OR /                  */
@RF00229 AL    R3,@CF00350                                         0234
*       GO TO OPT075;                                              0235
         B     OPT075                                              0235
*     END;                                                         0236
*   GO TO OPT070;                   /* GO CHK IT                     */
         B     OPT070                                              0237
*                                                                  0238
*   /*****************************************************************/
*   /*                                                               */
*   /* EL OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*OPT200:                                                           0238
*   $LOOPERR='1'B;                  /* SET EL BIT ON                 */
OPT200   OI    $LOOPERR(WAPTR),B'00000010'                         0238
*   $ERRCNT='0'B;                   /* TURN OFF COUNT GIVEN          */
         NI    $ERRCNT(WAPTR),B'11101111'                          0239
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */
         CLI   INPUTBUF+2(R3),C'('                                 0240
         BNE   @RF00240                                            0240
*     DO;                                                          0241
*       IF INPUTBUF(4)='I' THEN     /* INDEFINITE LOOP               */
         CLI   INPUTBUF+3(R3),C'I'                                 0242
         BNE   @RF00242                                            0242
*         DO;                       /* YES                           */
*           $INDEFLP='1'B;          /* TURN ON SWITCH                */
         OI    $INDEFLP(WAPTR),B'00000010'                         0244
*           GO TO OPT150;           /* GO CHK LEFT PAREN             */
         B     OPT150                                              0245
*         END;                                                     0246
*       R3=R3+3;                    /* PT TO NUMBER                  */
@RF00242 AL    R3,@CF00081                                         0247
*       GEN(BAL  R11,OPT350);       /* CONVERT NUMBER                */
         BAL  R11,OPT350
*       IF HEXNUM=0 THEN            /* LOOP CNT=0                    */
         L     @14,HEXNUM                                          0249
         LTR   @14,@14                                             0249
         BNZ   @RF00249                                            0249
*         DO;                       /* YES,CONTINUE                  */
*           $LOOPERR='0'B;          /* SET ERROR LOOP OFF            */
         NI    $LOOPERR(WAPTR),B'11111101'                         0251
*           GO TO OPT075;           /* CONTINUE DECODING             */
         B     OPT075                                              0252
*         END;                                                     0253
*       $ERRCNTA=HEXNUM;            /* STORE COUNT FOR OLT           */
@RF00249 L     @14,HEXNUM                                          0254
         STH   @14,$ERRCNTA(,WAPTR)                                0254
*       $ERRLPCT=$ERRCNTA;          /* PUT IN SCT ALSO               */
         STH   @14,$ERRLPCT(,WAPTR)                                0255
*       $ERRCNT='1'B;               /* SET COUNT GIVEN BIT           */
         OI    $ERRCNT(WAPTR),B'00010000'                          0256
*       $INDEFLP='0'B;              /* RESET INDEFINITE LOOP         */
         NI    $INDEFLP(WAPTR),B'11111101'                         0257
*       GO TO OPT075;               /* DECODE NEXT CHAR              */
         B     OPT075                                              0258
*     END;                                                         0259
*   $ERRLPCT=$COUNT;                /* USE OLT DEFAULT               */
@RF00240 L     @14,$LOWADDR(,WAPTR)                                0260
         LH    @10,RTNDISP(,@14)                                   0260
         ALR   @10,@14                                             0260
         LH    @14,$COUNT(,@10)                                    0260
         N     @14,@CF00874                                        0260
         STH   @14,$ERRLPCT(,WAPTR)                                0260
*   $INDEFLP='0'B;                  /* RESET INDEFINITE LOOP         */
         NI    $INDEFLP(WAPTR),B'11111101'                         0261
*   GO TO OPT070;                   /* DECODE NEXT CHAR              */
         B     OPT070                                              0262
*                                                                  0263
*   /*****************************************************************/
*   /*                                                               */
*   /* TL OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*OPT300:                                                           0263
*   $LOOPTST='1'B;                  /* SET TL BIT                    */
OPT300   OI    $LOOPTST(WAPTR),B'00000001'                         0263
*   $TLCNT=500;                     /* SET DEFAULT COUNT             */
         MVC   $TLCNT(2,WAPTR),@CH00798                            0264
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */
         CLI   INPUTBUF+2(R3),C'('                                 0265
         BNE   @RF00265                                            0265
*     DO;                           /* YES                           */
*       R3=R3+3;                    /* PT TO COUNT                   */
         AL    R3,@CF00081                                         0267
*       GEN(BAL  R11,OPT350);       /* DECODE & CONVERT CNT          */
         BAL  R11,OPT350
*       $TLCNT=HEXNUM;              /* MOVE IN COUNT FOR OLT         */
         L     @14,HEXNUM                                          0269
         STH   @14,$TLCNT(,WAPTR)                                  0269
*       GO TO OPT075;               /* DECODE NEXT                   */
         B     OPT075                                              0270
*     END;                                                         0271
*   GO TO OPT070;                   /* DECODE NEXT                   */
         B     OPT070                                              0272
*OPT350:                            /* CONVERT ROUTINE               */
*   WORK=EBCF0;                     /* INITIALIZE WORKAREA           */
OPT350   MVC   WORK(8),EBCF0                                       0273
*   DO I=1 TO 6 BY 1;               /* SCAN FOR RT. PAREN            */
         LA    @14,1                                               0274
         STH   @14,I                                               0274
@DL00274 DS    0H                                                  0275
*     IF INPUTBUF(I)=')' THEN       /* FOUND                         */
         ALR   @14,R3                                              0275
         BCTR  @14,0                                               0275
         CLI   INPUTBUF(@14),C')'                                  0275
         BE    @RT00275                                            0275
*       GO TO OPT355;               /* YES,DECODE & CONVERT          */
*     IF APFLAG='0'B THEN           /* IS THIS AN ALT PRTR           */
         TM    APFLAG,B'01000000'                                  0277
         BNZ   @RF00277                                            0277
*       DO;                         /* NO,CONTINUE                   */
*         IF INPUTBUF(I)>'9'×       /* IS CHAR                       */
*             '0'>INPUTBUF(I) THEN  /* NUMERIC                       */
         LH    @14,I                                               0279
         ALR   @14,R3                                              0279
         BCTR  @14,0                                               0279
         CLI   INPUTBUF(@14),C'9'                                  0279
         BH    @RT00279                                            0279
         LH    @14,I                                               0279
         ALR   @14,R3                                              0279
         BCTR  @14,0                                               0279
         CLI   INPUTBUF(@14),C'0'                                  0279
         BNL   @RF00279                                            0279
@RT00279 DS    0H                                                  0280
*           DO;                     /* NO,ERROR                      */
*             R3=R3+I;              /* POINT TO ERROR                */
         AH    R3,I                                                0281
*             GO TO OPT360;                                        0282
         B     OPT360                                              0282
*           END;                                                   0283
*       END;                                                       0284
@RF00279 DS    0H                                                  0285
*   END;                                                           0285
@RF00277 LA    @14,1                                               0285
         AH    @14,I                                               0285
         STH   @14,I                                               0285
         C     @14,@CF00448                                        0285
         BNH   @DL00274                                            0285
*   R3=R3+5;                        /* ERROR TOO MANY CHARS          */
         AL    R3,@CF00350                                         0286
*   GO TO OPT800;                   /* ISSUE 115 ERROR MSG           */
         B     OPT800                                              0287
*OPT355:                                                           0288
*   I=I-1;                          /* COMPUTE WORK AREA SUBSCR      */
OPT355   LH    @14,I                                               0288
         BCTR  @14,0                                               0288
         STH   @14,I                                               0288
*   IF I=0 THEN                     /* NOTHING FOUND?                */
         LTR   @14,@14                                             0289
         BZ    @RT00289                                            0289
*     GO TO OPT800;                 /* YES,ERROR                     */
*   N=9-I;                          /* NUMBER OF CHARACTERS          */
         LA    @10,9                                               0291
         SLR   @10,@14                                             0291
         STH   @10,N                                               0291
*   WORK(N:8)=INPUTBUF(1:I);        /* MOVE IN EBCDIC NUM            */
         LA    @08,WORK-1(@10)                                     0292
         LCR   @10,@10                                             0292
         AL    @10,@CF00054                                        0292
         EX    @10,@SM00875                                        0292
*   R3=R3+I;                        /* INCR INPUT POINTER            */
*                                                                  0293
         ALR   R3,@14                                              0293
*   /*****************************************************************/
*   /*                                                               */
*   /* ITACONV FROM(WORK)TO(WORKA)TYPE(EH)COUNT(8) INVOKED           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   DCL                                                            0294
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */
*      2 * CHAR(4) INIT('0102F4F1'X),                              0294
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */
*   ITATCFR=ADDR(WORK);             /* SET THE FROM ADDRESS          */
         LA    @14,WORK                                            0295
         ST    @14,ITATCFR                                         0295
*   ITATCTO=ADDR(WORKA);            /* SET THE TO ADDRESS            */
         LA    @14,WORKA                                           0296
         ST    @14,ITATCTO                                         0296
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */
         NI    ITATCTP,B'01111111'                                 0297
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */
         MVI   ITATCNT,X'08'                                       0298
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */
         LA    R1,ITATCPRM                                         0299
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */
         L     @15,@CV00813                                        0300
         BALR  @14,@15                                             0300
*   IF R15^=0 THEN                  /* ERROR CONVERTING              */
         LTR   R15,R15                                             0301
         BNZ   @RT00301                                            0301
*     GO TO OPT800;                 /* YES,GO ISSUE 115 MSG          */
*   IF APFLAG='1'B THEN             /* IS THIS AN AP ENTRY ENT       */
         TM    APFLAG,B'01000000'                                  0303
         BO    @RT00303                                            0303
*     GO TO OPT370;                                                0304
*   HEXNUM=WORKA*16+12;             /* CONVERT TO                    */
         L     @14,WORKA                                           0305
         SLL   @14,4                                               0305
         AL    @14,@CF00136                                        0305
         ST    @14,HEXNUM                                          0305
*   CVB(HEXNUM,HEXNUMA);            /* HEX                           */
         XC    @TS00001(8),@TS00001                                0306
         MVC   @TS00001+4(4),HEXNUMA                               0306
         CVB   @14,@TS00001                                        0306
         ST    @14,HEXNUM                                          0306
*   IF HEXNUM>32767 THEN            /* NUM HAS TO FIT IN HALF        */
         C     @14,@CF00816                                        0307
         BNH   @RF00307                                            0307
*     DO;                           /* IT DOESNT,ERROR               */
*OPT360:                                                           0309
*       R3=R3-1;                    /* POINT TO ERROR                */
OPT360   BCTR  R3,0                                                0309
*       GO TO OPT800;               /* ISSUE 115 MSG                 */
         B     OPT800                                              0310
*     END;                                                         0311
*OPT370:                                                           0312
*   R3=R3+1;                        /* POINT TO ERROR CHAR           */
@RF00307 DS    0H                                                  0312
OPT370   AL    R3,@CF00072                                         0312
*   GEN(BR   R11);                  /* RETURN TO CALLER              */
         BR   R11
*                                                                  0314
*   /*****************************************************************/
*   /*                                                               */
*   /* AP OPTION ENTRY                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0314
*OPT400:                                                           0314
*   IF $ALTPRTR='1'B×               /* IS THERE AN ACTIVE AP OR      */
*       ($NOTDEV(2)='1'B&$ACQRED(2)='1'B)/* ONE WITH ERROR           */
*     THEN                          /* IF EITHER DO                  */
OPT400   TM    $ALTPRTR(WAPTR),B'00000010'                         0314
         BO    @RT00314                                            0314
         TM    $NOTDEV+68(WAPTR),B'11000000'                       0314
         BNO   @RF00314                                            0314
@RT00314 DS    0H                                                  0315
*     DO;                           /* YES CONTINUE                  */
*       SYM=ADDR($SYSMN(2));        /* GET NAME FOR RELEASE          */
         LA    @14,$SYSMN+68(,WAPTR)                               0316
         ST    @14,SYM                                             0316
*       R1=ADDR(RELPARM);           /* RELEASE PARM LIST             */
         LA    R1,RELPARM                                          0317
*       CALL #EXIT;                 /* RELEASE PRESENT AP            */
         L     @15,#EXITA(,WAPTR)                                  0318
         BALR  @14,@15                                             0318
*       IF R15^=0 THEN              /* ERROR ?                       */
         LTR   R15,R15                                             0319
         BNZ   @RT00319                                            0319
*         GO TO OPT890;             /* YES                           */
*     END;                                                         0321
*   $NOTDEV(2)='0'B;                /* NOT A TEST DEVICE             */
@RF00314 NI    $NOTDEV+68(WAPTR),B'01111111'                       0322
*   $ALTPRTR='0'B;                  /* RESET AP BIT                  */
*   $NEWAP='0'B;                    /* RESET NEW ALT PRTR FLAG       */
         NI    $ALTPRTR(WAPTR),B'11111100'                         0324
*   $APNAME='';                     /* INITIALIZE ALT PRT NAME       */
         MVI   $APNAME(WAPTR),C' '                                 0325
         MVC   $APNAME+1(7,WAPTR),$APNAME(WAPTR)                   0325
*   IF NO='1'B THEN                 /* AP SPECIFIED                  */
         TM    NO,B'10000000'                                      0326
         BO    @RT00326                                            0326
*     GO TO OPT070;                 /* NO DECODE NEXT                */
*   IF INPUTBUF(3)^='(' THEN        /* ALT PRINTER SPEC              */
         CLI   INPUTBUF+2(R3),C'('                                 0328
         BE    @RF00328                                            0328
*     DO;                           /* NO                            */
*       R3=R3+2;                    /* ERROR                         */
         AL    R3,@CF00139                                         0330
*       GO TO OPT800;               /* ISSUE ERROR MSG               */
         B     OPT800                                              0331
*     END;                                                         0332
*   R3=R3+3;                        /* PT TO 1ST CHAR OF NAME        */
@RF00328 AL    R3,@CF00081                                         0333
*   $DEVCDSF(2)='00'X;              /* CDS DEVICE FLAGS              */
*                                                                  0334
         MVI   $DEVCDSF+68(WAPTR),X'00'                            0334
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE SYMBOLIC NAME FIELD                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0335
*   $$SYMNME(2)=$$SYMNME(2)&&$$SYMNME(2);                          0335
         XC    $$SYMNME+68(8,WAPTR),$$SYMNME+68(WAPTR)             0335
*   I=1;                            /* SET SUBSCRIPT                 */
         MVC   I(2),@CH00072                                       0336
*   IF INPUTBUF(1)>'Z' THEN         /* UNIT ADDRESS ?                */
         CLI   INPUTBUF(R3),C'Z'                                   0337
         BNH   @RF00337                                            0337
*     DO;                           /* YES                           */
*       APFLAG='1'B;                /* SET INT AP FLAG               */
         OI    APFLAG,B'01000000'                                  0339
*       GEN(BAL  R11,OPT350);       /* CONVERT UNIT ADDR TO HEX      */
         BAL  R11,OPT350
*       APFLAG='0'B;                /* RESET AP FLAG                 */
         NI    APFLAG,B'10111111'                                  0341
*       IF NUM>4095 THEN            /* MORE THAN 3 HEX DIGITS ?      */
         CLC   NUM(2),@CH00823                                     0342
         BNH   @RF00342                                            0342
*         DO;                       /* YES,ERROR                     */
*           R3=R3-2;                /* BACK UP TO LAST DIGIT         */
         BCTR  R3,0                                                0344
         BCTR  R3,0                                                0344
*           GO TO OPT800;           /* ERROR HANDLING                */
         B     OPT800                                              0345
*         END;                                                     0346
*       $APNAME(1:I)=WORK(N:8);     /* MOVE AP UNIT ADR              */
@RF00342 LH    @14,I                                               0347
         BCTR  @14,0                                               0347
         LH    @10,N                                               0347
         LA    @08,WORK-1(@10)                                     0347
         EX    @14,@SM00879                                        0347
*       $DEVUNAD(2)=WORKA;          /* UNIT ADDR TO DEV TBLE         */
         MVC   $DEVUNAD+68(4,WAPTR),WORKA                          0348
*       GO TO OPT450;               /* GO INQUIRE                    */
         B     OPT450                                              0349
*     END;                                                         0350
*OPT420:                                                           0351
*   IF INPUTBUF(I)='$'×             /* CHECK FOR                     */
*       INPUTBUF(I)='@'×            /* LEGAL                         */
*       INPUTBUF(I)='#'×            /* SYMBOLIC                      */
*       INPUTBUF(I)>='A' THEN       /* NAME                          */
@RF00337 DS    0H                                                  0351
OPT420   LH    @14,I                                               0351
         ALR   @14,R3                                              0351
         BCTR  @14,0                                               0351
         CLI   INPUTBUF(@14),C'$'                                  0351
         BE    @RT00351                                            0351
         LH    @14,I                                               0351
         ALR   @14,R3                                              0351
         BCTR  @14,0                                               0351
         CLI   INPUTBUF(@14),C'@'                                  0351
         BE    @RT00351                                            0351
         LH    @14,I                                               0351
         ALR   @14,R3                                              0351
         BCTR  @14,0                                               0351
         CLI   INPUTBUF(@14),C'#'                                  0351
         BE    @RT00351                                            0351
         LH    @14,I                                               0351
         ALR   @14,R3                                              0351
         BCTR  @14,0                                               0351
         CLI   INPUTBUF(@14),C'A'                                  0351
         BL    @RF00351                                            0351
@RT00351 DS    0H                                                  0352
*     DO;                                                          0352
*       I=I+1;                      /* PT TO NEXT CHAR               */
         LA    @14,1                                               0353
         AH    @14,I                                               0353
         STH   @14,I                                               0353
*       IF I>9 THEN                 /* MORE THAN 8 CHARS             */
         C     @14,@CF00087                                        0354
         BH    @RT00354                                            0354
*         GO TO OPT430;             /* YES,ERROR                     */
*       GO TO OPT420;               /* CHK NEXT CHAR                 */
         B     OPT420                                              0356
*     END;                                                         0357
*   IF INPUTBUF(I)^=')'×            /* IF NOT END OF FIELD OR        */
*       I=1 THEN                    /* NO NAME SPECIFIED             */
@RF00351 LH    @14,I                                               0358
         ALR   @14,R3                                              0358
         BCTR  @14,0                                               0358
         CLI   INPUTBUF(@14),C')'                                  0358
         BNE   @RT00358                                            0358
         LH    @14,I                                               0358
         C     @14,@CF00072                                        0358
         BNE   @RF00358                                            0358
@RT00358 DS    0H                                                  0359
*     DO;                           /* ERROR                         */
*OPT430:                                                           0360
*       R3=R3+I-1;                  /* POINT TO ERROR                */
OPT430   LR    @14,R3                                              0360
         AH    @14,I                                               0360
         BCTR  @14,0                                               0360
         LR    R3,@14                                              0360
*       GO TO OPT800;               /* WRITE ERROR MSG               */
         B     OPT800                                              0361
*     END;                                                         0362
*   $DEVCDSF(2)='0A'X;              /* CDS DEVICE FLAGS              */
@RF00358 MVI   $DEVCDSF+68(WAPTR),X'0A'                            0363
*   $$SYMNME(2)='';                 /* INIT SYM NAME                 */
         MVI   $$SYMNME+68(WAPTR),C' '                             0364
         MVC   $$SYMNME+69(7,WAPTR),$$SYMNME+68(WAPTR)             0364
*   I=I-1;                          /* RESET SUBSCRIPT               */
         LH    @14,I                                               0365
         BCTR  @14,0                                               0365
         STH   @14,I                                               0365
*   $$SYMNME(2,1:I)=INPUTBUF(1:I);  /* MOVE NAME TO DEV TBL          */
         LR    @10,@14                                             0366
         BCTR  @10,0                                               0366
         EX    @10,@SM00881                                        0366
*   $APNAME=$$SYMNME(2);            /* ALSO MOVE TO APNAME           */
         MVC   $APNAME(8,WAPTR),$$SYMNME+68(WAPTR)                 0367
*   R3=R3+I+1;                      /* INCR INPUT PTR                */
         ALR   @14,R3                                              0368
         AL    @14,@CF00072                                        0368
         LR    R3,@14                                              0368
*OPT450:                                                           0369
*   CDSADDR=ADDR($DEVTBLE(2));      /* CDS FOR ACQ/VER               */
OPT450   LA    @14,$DEVTBLE+68(,WAPTR)                             0369
         ST    @14,CDSADDR                                         0369
*   R1=ADDR(ACQPARM);               /* ADDRESS OF ACQ PARM LST       */
         LA    R1,ACQPARM                                          0370
*   CALL ISTSC030;                  /* CALL ACQUISITION              */
         L     @15,@CV00835                                        0371
         BALR  @14,@15                                             0371
*   IF R15^=0 THEN                  /* ERROR                         */
         LTR   R15,R15                                             0372
         BNZ   @RT00372                                            0372
*     GO TO OPT890;                 /* YES                           */
*   IF SYMNAME=$SYSMN(1) THEN       /* ALT PRT = CONTROL TERM        */
         L     @14,SYMPTR+2376(,WAPTR)                             0374
         CLC   SYMNAME(8,@14),$SYSMN(WAPTR)                        0374
         BNE   @RF00374                                            0374
*     DO;                           /* YES                           */
*OPT460:                                                           0376
*       R3=R3-2;                    /* PT TO ERROR                   */
OPT460   BCTR  R3,0                                                0376
         BCTR  R3,0                                                0376
*       GO TO OPT800;               /* ERROR HANDLING                */
         B     OPT800                                              0377
*     END;                                                         0378
*   $MSGOTSD(2)=0;                  /* CLCAB WORD FOR QUE            */
@RF00374 SLR   @14,@14                                             0379
         ST    @14,$MSGOTSD+68(,WAPTR)                             0379
*   $DEVFEAT(2)=DEVCHAR;            /* MOVE DEV CHARS FOR 200        */
         L     @14,DVCHRPTR+2376(,WAPTR)                           0380
         MVC   $DEVFEAT+68(4,WAPTR),DEVCHAR(@14)                   0380
*   R1=DVCHRPTR;                    /* POINT TO PARM LIST            */
         LR    R1,@14                                              0381
*   CALL I00C0200;                  /* CAN DEV BE AN ALT PRTR        */
         L     @15,@CV00838                                        0382
         BALR  @14,@15                                             0382
*   IF R15>4 THEN                   /* CHECK R/C                     */
         C     R15,@CF00068                                        0383
         BH    @RT00383                                            0383
*     GO TO OPT800;                 /* CANT BE ALT PRTR              */
*   $SYSMN(2)=SYMNAME;              /* MOVE SYM NAME TOO             */
         LA    @14,2376                                            0385
         ALR   @14,WAPTR                                           0385
         L     @10,SYMPTR(,@14)                                    0385
         MVC   $SYSMN+68(8,WAPTR),SYMNAME(@10)                     0385
*   $LINENME(2)=NAMERN;             /* MOVE NAME TO DEF TABLE        */
         MVC   $LINENME+68(8,WAPTR),NAMERN(@14)                    0386
*   $DEVFLG5(2)=FLG5;               /* MOVE DEVICE FLAGS             */
         MVC   $DEVFLG5+68(1,WAPTR),FLG5(@14)                      0387
*   $NEWAP='1'B;                    /* SET NEW AP FLAG               */
         OI    $NEWAP(WAPTR),B'00000001'                           0388
*   $APRQPER='1'B;                  /* AP REQ. PERMISSION            */
         OI    $APRQPER(WAPTR),B'01000000'                         0389
*   APFLAG='0'B;                    /* TURN OFF INT FLAG             */
         NI    APFLAG,B'10111111'                                  0390
*   GO TO OPT075;                   /* DECODE NEXT ENTRY             */
         B     OPT075                                              0391
*OPT800:                                                           0392
*                                                                  0392
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR HANDLING                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0392
*   R4=$SLASHAD(2)+1;               /* ADDR OF 1ST INPUT CHAR        */
OPT800   LA    R4,1                                                0392
         AL    R4,$SLASHAD+4(,WAPTR)                               0392
*   IF R3>$SLASHAD(3) THEN          /* BEYOND OPTION FIELD           */
         L     @14,$SLASHAD+8(,WAPTR)                              0393
         CR    R3,@14                                              0393
         BNH   @RF00393                                            0393
*     R3=$SLASHAD(3);               /* YES,RESET POINTER             */
         LR    R3,@14                                              0394
*   R6=R3;                          /* SET ERROR INPUT PTR           */
@RF00393 LR    R6,R3                                               0395
*   $INBUFR(1:8)=' ';               /* BLK OUT WORK AREA             */
         MVI   $INBUFR+1(WAPTR),C' '                               0396
         MVC   $INBUFR+2(6,WAPTR),$INBUFR+1(WAPTR)                 0396
         MVI   $INBUFR(WAPTR),C' '                                 0396
*   DO I=8 TO 1 BY-1;               /* SCAN INPUT                    */
         LA    @14,8                                               0397
         STH   @14,I                                               0397
@DL00397 DS    0H                                                  0398
*     $INBUFR(I)=ERRINPUT(1);       /* MOVE ERROR TO SUB FIELD       */
         ALR   @14,WAPTR                                           0398
         MVC   $INBUFR-1(1,@14),ERRINPUT(R6)                       0398
*     IF R6=R4 THEN                 /* END OF OPT FIELD              */
         CR    R6,R4                                               0399
         BE    @RT00399                                            0399
*       GO TO OPT820;               /* YES WRITE ERROR MSG           */
*     R6=R6-1;                      /* DECR INPUT PTR                */
         BCTR  R6,0                                                0401
*   END;                                                           0402
         LH    @10,I                                               0402
         BCTR  @10,0                                               0402
         LR    @14,@10                                             0402
         STH   @14,I                                               0402
         LTR   @14,@14                                             0402
         BP    @DL00397                                            0402
*OPT820:                                                           0403
*                                                                  0403
*   /*****************************************************************/
*   /*                                                               */
*   /* TCEC MSGN(115)SUB(YES) INVOKED                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */
OPT820   OI    $TCECM(WAPTR),B'00000001'                           0403
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */
         LA    R1,$TCA12                                           0404
*   CALL #EXIT;                     /* CALL CECOM                    */
         L     @15,#EXITA(,WAPTR)                                  0405
         BALR  @14,@15                                             0405
*   DCL                                                            0406
*     1 $TCA12,                     /* TCEC PARM LIST                */
*      2 $TCB12 FIXED(32) INIT(115),/* MSG NUMBER                    */
*      2 $TCC12 FIXED(32) INIT(0),  /* INCT LEN                      */
*      2 $TCD12 BIT(8) INIT('10000000'B),/* FLAG                     */
*      2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE ERROR
*                                      MSG                           */
*OPT850:                                                           0407
*   $TESTOPT=A33SAVE(1);            /* RESTORE                       */
OPT850   MVC   $TESTOPT(1,WAPTR),A33SAVE                           0407
*   $ERROPT=A33SAVE(2);             /* OLD                           */
         MVC   $ERROPT(1,WAPTR),A33SAVE+1                          0408
*   $EXECFLG=A33SAVE(3);            /* OPTIONS                       */
         MVC   $EXECFLG(1,WAPTR),A33SAVE+2                         0409
*   $OLTFLGS=A33SAVE(4);            /* AND                           */
         MVC   $OLTFLGS(1,WAPTR),A33SAVE+3                         0410
*   $PRNTLVL=A33SAVE(5);            /* CONSTANTS                     */
         MVC   $PRNTLVL(1,WAPTR),A33SAVE+4                         0411
*   $ERRCNTA=A33SAVE(6:9);          /*                               */
         MVC   $ERRCNTA(2,WAPTR),A33SAVE+7                         0412
*   $TLCNT=A33SAVE(8:9);            /*                               */
         MVC   $TLCNT(2,WAPTR),A33SAVE+7                           0413
*   $FLAG9=A33SAVE(10);             /*                               */
         MVC   $FLAG9(1,WAPTR),A33SAVE+9                           0414
*   $NEWAP='0'B;                    /* RESET ALT PRT FLAG            */
         NI    $NEWAP(WAPTR),B'11111110'                           0415
*OPT890:                                                           0416
*   $OPTERR='1'B;                   /* INDICATE ERROR                */
OPT890   OI    $OPTERR(WAPTR),B'00000100'                          0416
*   IF $ALTPRTR='0'B&               /* ALT PRINTER                   */
*       $NEWAP='0'B THEN            /* OR NEW ALT PRINTER            */
         TM    $ALTPRTR(WAPTR),B'00000011'                         0417
         BNZ   @RF00417                                            0417
*     DO;                                                          0418
*       $DEVTBLE(2)=$DEVTBLE(2)&&$DEVTBLE(2);/* CLEAR ENTRY          */
         XC    $DEVTBLE+68(68,WAPTR),$DEVTBLE+68(WAPTR)            0419
*       $NOTDEV(2)='1'B;            /* SET NOT DEVICE FOR AP         */
         OI    $NOTDEV+68(WAPTR),B'10000000'                       0420
*     END;                                                         0421
*OPT895:                            /* SCAN FOR NEXT ENTRY           */
*   IF INPUTBUF(1)=',' THEN         /* REACHED NEXT ENTRY?           */
@RF00417 DS    0H                                                  0422
OPT895   CLI   INPUTBUF(R3),C','                                   0422
         BNE   @RF00422                                            0422
*     DO;                           /* YES CONTINUE                  */
*       R3=R3+1;                    /* POINT TO NEXT ENTRY           */
         AL    R3,@CF00072                                         0424
*       GO TO OPT050;               /* CONTINUE DECODING             */
         B     OPT050                                              0425
*     END;                                                         0426
*   IF INPUTBUF(1)='/' THEN         /* END OF INPUT?                 */
@RF00422 CLI   INPUTBUF(R3),C'/'                                   0427
         BE    @RT00427                                            0427
*     GO TO OPT900;                 /* YES,RETURN TO COMM INT        */
*   R3=R3+1;                        /* UPDATE POINTER                */
         AL    R3,@CF00072                                         0429
*   GO TO OPT895;                   /* LOOK FOR END OF ENTRY         */
         B     OPT895                                              0430
*OPT900:                                                           0431
*   R13=SVEIC003(2);                /* MY SAVE PTR                   */
OPT900   L     R13,SVEIC003+4(,WAPTR)                              0431
*   RETURN;                         /* GO TO COMM INT                */
@EL00001 DS    0H                                                  0432
@EF00001 DS    0H                                                  0432
@ER00001 LM    @14,@12,12(@13)                                     0432
         BR    @14                                                 0432
*   DO;                             /* ATDSPLY                       */
*   END;                            /* ATDSPLY                       */
*   END ISTIC005;                                                  0435
@DATA    DS    0H
@CH00798 DC    H'500'
@CH00823 DC    H'4095'
@SM00860 MVC   $INBUFR(0,WAPTR),$EXTA+1(WAPTR)
@SM00870 MVC   $EXTA+1(0,WAPTR),INPUTBUF(R3)
@SM00875 MVC   0(0,@08),INPUTBUF(R3)
@SM00879 MVC   $APNAME(0,WAPTR),0(@08)
@SM00881 MVC   $$SYMNME+68(0,WAPTR),INPUTBUF(R3)
         DS    0F
         DS    0F
@CF00072 DC    F'1'
@CH00072 EQU   @CF00072+2
@CF00139 DC    F'2'
@CF00081 DC    F'3'
@CF00068 DC    F'4'
@CF00350 DC    F'5'
@CF00448 DC    F'6'
@CF00054 DC    F'8'
@CF00087 DC    F'9'
@CF00136 DC    F'12'
@CF00752 DC    F'54'
@CF00816 DC    F'32767'
@CF00874 DC    XL4'0000FFFF'
@CV00813 DC    V(ISTSC021)
@CV00835 DC    V(ISTSC030)
@CV00838 DC    V(I00C0200)
         DS    0D
RCAPTR   DS    A
         DS    0D
@TS00001 DS    CL8
@CC00778 DC    C'EXT='
@CC00763 DC    C'TL'
@CC00766 DC    C'EL'
@CC00768 DC    C'PP'
@CC00770 DC    C'AP'
@CC00772 DC    C'FE'
@CC00773 DC    C'MI'
@CC00774 DC    C'EP'
@CC00775 DC    C'CP'
@CC00776 DC    C'PR'
@CC00777 DC    C'TR'
A33OPTN  DC    CL44'NTL,NEL,NPP,NFE,NMI,NEP,NCP,NPR,NTR,NAP'
@NM00055 DS    CL90
         ORG   @NM00055
N        DS    FL2
I        DS    FL2
EXTNUMFX DS    FL4
         ORG   EXTNUMFX
@NM00056 DS    CL3
EXTNUMCH DS    CL1
         ORG   @NM00055+8
@NM00057 DS    CL12
         ORG   @NM00057
WORK     DS    CL8
WORKA    DS    CL4
         ORG   WORKA
@NM00058 DS    CL2
NUM      DS    CL2
         ORG   @NM00055+20
HEXNUM   DS    FL4
         ORG   HEXNUM
HEXNUMA  DS    CL4
         ORG   @NM00055+24
OPTS     DS    CL44
         ORG   OPTS
EBTL     DS    CL1
@NM00059 DS    CL3
EBEL     DS    CL1
@NM00060 DS    CL3
EBPP     DS    CL1
@NM00061 DS    CL3
EBFE     DS    CL1
@NM00062 DS    CL3
EBMI     DS    CL1
@NM00063 DS    CL3
EBEP     DS    CL1
@NM00064 DS    CL3
EBCP     DS    CL1
@NM00065 DS    CL3
EBPR     DS    CL1
@NM00066 DS    CL3
EBTR     DS    CL1
@NM00067 DS    CL3
EBAP     DS    CL1
@NM00068 DS    CL3
         ORG   @NM00055+68
A33SAVE  DS    CL11
INTFLAGS DS    CL1
         ORG   INTFLAGS
NO       DS    BL1
APFLAG   EQU   INTFLAGS+0
@NM00069 EQU   INTFLAGS+0
         ORG   @NM00055+90
         DS    CL2
RELPARM  DS    CL9
         ORG   RELPARM
@NM00070 DC    X'0102F3F1'
SYM      DS    AL4
@NM00071 DC    B'10000000'
         ORG   RELPARM+9
         DS    CL3
ACQPARM  DS    CL5
         ORG   ACQPARM
CDSADDR  DS    AL4
@NM00072 DC    B'00100000'
         ORG   ACQPARM+5
EBCF0    DC    CL8'00000000'
         DS    CL3
$TCA09   DS    CL13
         ORG   $TCA09
$TCB09   DC    A(107)
$TCC09   DC    A(0)
$TCD09   DC    B'10000000'
$TCE09   DC    X'FFFFFFFF'
         ORG   $TCA09+13
         DS    CL3
$TCA10   DS    CL13
         ORG   $TCA10
$TCB10   DC    A(327)
$TCC10   DC    A(0)
$TCD10   DC    B'10000000'
$TCE10   DC    X'FFFFFFFF'
         ORG   $TCA10+13
         DS    CL3
ITATCPRM DS    CL14
         ORG   ITATCPRM
@NM00074 DC    X'0102F4F1'
ITATCFR  DS    AL4
ITATCTO  DS    AL4
@NM00075 DC    AL1(0)
         ORG   @NM00075
ITATCTP  DS    BL1
         ORG   ITATCPRM+13
ITATCNT  DS    FL1
         ORG   ITATCPRM+14
         DS    CL2
$TCA12   DS    CL13
         ORG   $TCA12
$TCB12   DC    A(115)
$TCC12   DC    A(0)
$TCD12   DC    B'10000000'
$TCE12   DC    X'FFFFFFFF'
         ORG   $TCA12+13
         DS    CL3
PATCH    DC    15F'0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WAPTR    EQU   @02
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R9       EQU   @09
R11      EQU   @11
R13      EQU   @13
R15      EQU   @15
$RCAAREA EQU   0
$POINTER EQU   $RCAAREA+100
$TRTBLA  EQU   $POINTER+124
$CONSTNT EQU   $RCAAREA+244
$RCAFLG  EQU   $RCAAREA+604
TOLTEPWA EQU   0
$SCTTBLE EQU   TOLTEPWA
$ERRLPCT EQU   $SCTTBLE
$TESTOPT EQU   $SCTTBLE+2
$NOPRT   EQU   $TESTOPT
$INDEFLP EQU   $TESTOPT
$FSTCOMM EQU   $TESTOPT
$ERROPT  EQU   $SCTTBLE+3
$ALTPRNT EQU   $ERROPT
$NOCNTRL EQU   $ERROPT
$NERRPRT EQU   $ERROPT
$LOOPERR EQU   $ERROPT
$LOOPTST EQU   $ERROPT
$PDEVFLG EQU   $SCTTBLE+10
$CDSFLGS EQU   $SCTTBLE+11
$CDS8T19 EQU   $SCTTBLE+20
$EXECFLG EQU   $SCTTBLE+33
$ERRCNT  EQU   $EXECFLG
$OLTFLGS EQU   $SCTTBLE+36
$MANINTV EQU   $OLTFLGS
$TRACE   EQU   $OLTFLGS
$OLTFLG2 EQU   $SCTTBLE+37
$TOTFLG1 EQU   $SCTTBLE+38
$ROUTMSK EQU   $SCTTBLE+40
$CDA     EQU   TOLTEPWA+100
$SLASHAD EQU   $CDA+32
$RCA     EQU   $CDA+44
$OLTPTR  EQU   $CDA+52
$LOWADDR EQU   $OLTPTR
$HIMOREC EQU   $CDA+60
$TLCNT   EQU   $CDA+100
$ERRCNTA EQU   $CDA+102
$PRNTLVL EQU   $CDA+104
$COMMFLG EQU   TOLTEPWA+224
$FLAG1   EQU   $COMMFLG
$OLTACT  EQU   $FLAG1
$FLAG2   EQU   $COMMFLG+1
$FLAG3   EQU   $COMMFLG+2
$OPTERR  EQU   $FLAG3
$ALTPRTR EQU   $FLAG3
$NEWAP   EQU   $FLAG3
$FLAG4   EQU   $COMMFLG+3
$APRQPER EQU   $FLAG4
$FLAG5   EQU   $COMMFLG+4
$EOJ     EQU   $FLAG5
$CANCEL  EQU   $EOJ
$FLAG6   EQU   $COMMFLG+5
$ABNDBIT EQU   $FLAG6
$FLAG7   EQU   $COMMFLG+6
$FLAG8   EQU   $COMMFLG+7
$TCECM   EQU   $FLAG8
$FLAG9   EQU   $COMMFLG+8
$FLAG10  EQU   $COMMFLG+9
$FLAG11  EQU   $COMMFLG+10
$FLAG12  EQU   $COMMFLG+11
$OPTMSG  EQU   $FLAG12
$FLAG13  EQU   $COMMFLG+12
$DEVTBLE EQU   TOLTEPWA+240
$DEVCDS  EQU   $DEVTBLE
$DEVUNAD EQU   $DEVCDS
@NM00039 EQU   $DEVUNAD+2
$DEVFEAT EQU   $DEVCDS+4
$DEVCDSF EQU   $DEVCDS+9
$DEVSDCF EQU   $DEVCDS+10
$$SYMNME EQU   $DEVCDS+12
$MSGOTSD EQU   $$SYMNME
$DEVFLG1 EQU   $DEVTBLE+20
$EVNCPLT EQU   $DEVFLG1
$ATTNEXP EQU   $DEVFLG1
$INTOCC  EQU   $DEVFLG1
$DEVFLG2 EQU   $DEVTBLE+21
$DEVTECB EQU   $DEVTBLE+22
$OPIS    EQU   $DEVTECB
$OPND    EQU   $DEVTECB+2
$DEVFLG3 EQU   $DEVTBLE+27
$NOTDEV  EQU   $DEVFLG3
$ACQRED  EQU   $DEVFLG3
$SIOFLG  EQU   $DEVFLG3
$SYSMN   EQU   $DEVTBLE+28
$IFTOUT  EQU   $DEVTBLE+36
$DEVSESP EQU   $IFTOUT
$SSCPDAF EQU   $IFTOUT+6
$LDNCBPT EQU   $DEVTBLE+48
$RNINFO  EQU   $DEVTBLE+56
$LINENME EQU   $RNINFO
$DEVFLG5 EQU   $RNINFO+8
$DEVFLG4 EQU   $DEVTBLE+65
$SLTBL   EQU   TOLTEPWA+1468
$RUNTEST EQU   $SLTBL+13
$TESTFLG EQU   $SLTBL+21
$SECLST  EQU   $SLTBL+22
$INBUFR  EQU   TOLTEPWA+2104
$EXTA    EQU   TOLTEPWA+2320
$WORK    EQU   TOLTEPWA+2376
#EXITA   EQU   TOLTEPWA+2632
$CCOMDAT EQU   TOLTEPWA+2644
$CFLGS   EQU   $CCOMDAT+16
$24FEMSG EQU   TOLTEPWA+2681
$24CATMG EQU   $24FEMSG+11
$APNAME  EQU   TOLTEPWA+2704
@NM00048 EQU   TOLTEPWA+2776
$OUNTPTR EQU   @NM00048+4
$NSPTR   EQU   $OUNTPTR
$NSCNT   EQU   @NM00048+10
$ENXX    EQU   @NM00048+15
$IMITX   EQU   $ENXX
SVESC033 EQU   TOLTEPWA+3160
SVECC013 EQU   TOLTEPWA+3232
SVEIC003 EQU   TOLTEPWA+3592
SVESC022 EQU   TOLTEPWA+3736
SVECC011 EQU   TOLTEPWA+4024
#EXIT    EQU   0
@NM00051 EQU   0
RTNDISP  EQU   @NM00051+10
INST     EQU   @NM00051+12
$NEWSPRF EQU   0
#FLAGS   EQU   $NEWSPRF+16
$COUNT   EQU   $NEWSPRF+18
INPUTBUF EQU   0
@NM00073 EQU   0
SYMPTR   EQU   @NM00073
DVCHRPTR EQU   @NM00073+4
NAMERN   EQU   @NM00073+8
FLG5     EQU   @NM00073+16
SYMNAME  EQU   0
DEVCHAR  EQU   0
ERRINPUT EQU   0
BACKSAVE EQU   0
$TRTBL   EQU   0
OLTENTRY EQU   0
SVECC012 EQU   SVESC022
SVEIC00A EQU   SVEIC003
SVEIC004 EQU   SVEIC003
SVEIC005 EQU   SVEIC003
SVESC02A EQU   SVESC022
SVESC02B EQU   SVESC022
SVESC02D EQU   SVESC022
SVESC02E EQU   SVESC022
SVESC02F EQU   SVECC013
SVESC024 EQU   SVESC022
SVESC027 EQU   SVESC022
SVESC029 EQU   SVESC033
SVESC031 EQU   SVECC013
SVESC032 EQU   SVECC011
SVETC037 EQU   SVEIC003
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
$RME     EQU   $NEWSPRF+36
@NM00054 EQU   $NEWSPRF+35
$ECA     EQU   $NEWSPRF+32
$DCHB    EQU   $NEWSPRF+28
$MOSIZE  EQU   $NEWSPRF+24
$RTSIZE  EQU   $NEWSPRF+20
$REFNUM  EQU   $NEWSPRF+17
@NM00053 EQU   #FLAGS
#MSGIDRQ EQU   #FLAGS
#PLKMCOR EQU   #FLAGS
@NM00052 EQU   #FLAGS
$VIRTUAL EQU   #FLAGS
$PLINK$  EQU   $NEWSPRF+12
$SCTREQ  EQU   $NEWSPRF+11
$RM      EQU   $NEWSPRF+9
$CTYPE   EQU   $NEWSPRF+8
$CCLASS  EQU   $NEWSPRF+7
$CFEAT   EQU   $NEWSPRF+6
$CMODEL  EQU   $NEWSPRF+5
$TYPE    EQU   $NEWSPRF+4
$CLASS   EQU   $NEWSPRF+3
$FEAT    EQU   $NEWSPRF+2
$MODEL   EQU   $NEWSPRF+1
$RTN#    EQU   $NEWSPRF
#MSGID   EQU   @NM00051+16
LEVEL    EQU   @NM00051+8
SECTID   EQU   @NM00051
SVECC010 EQU   TOLTEPWA+3952
SVETC035 EQU   TOLTEPWA+3880
SVESC030 EQU   TOLTEPWA+3808
SVESC020 EQU   TOLTEPWA+3664
SVEIC002 EQU   TOLTEPWA+3520
SVECC014 EQU   TOLTEPWA+3376
SVESC120 EQU   TOLTEPWA+3304
SVESC025 EQU   TOLTEPWA+3088
@NM00050 EQU   TOLTEPWA+2980
$RPLERR  EQU   TOLTEPWA+2977
@NM00049 EQU   TOLTEPWA+2976
$R13PR3  EQU   TOLTEPWA+2972
$CEINT2  EQU   TOLTEPWA+2968
$CEINT1  EQU   TOLTEPWA+2964
$MSGGET  EQU   TOLTEPWA+2960
$ACQLIST EQU   TOLTEPWA+2956
$R4SAVE1 EQU   TOLTEPWA+2952
$CLSISS  EQU   TOLTEPWA+2950
$CLSCNT  EQU   TOLTEPWA+2948
$CUTABLE EQU   TOLTEPWA+2868
$BUFSZ2  EQU   TOLTEPWA+2864
$RESID2  EQU   TOLTEPWA+2860
$OLTCCW2 EQU   TOLTEPWA+2856
$ENDBFR2 EQU   TOLTEPWA+2852
$1STBFR2 EQU   TOLTEPWA+2848
$TECB2   EQU   TOLTEPWA+2844
$BUFSZ1  EQU   TOLTEPWA+2840
$RESID1  EQU   TOLTEPWA+2836
$OLTCCW1 EQU   TOLTEPWA+2832
$ENDBFR1 EQU   TOLTEPWA+2828
$1STBFR1 EQU   TOLTEPWA+2824
$TECB1   EQU   TOLTEPWA+2820
$WAITIME EQU   TOLTEPWA+2816
$TRTN#   EQU   TOLTEPWA+2815
$WIODEV  EQU   TOLTEPWA+2814
$RQSTSZE EQU   TOLTEPWA+2812
$RQSTPTR EQU   TOLTEPWA+2808
$R4SAVE  EQU   TOLTEPWA+2804
$PARTADR EQU   TOLTEPWA+2800
$TBSDATA EQU   TOLTEPWA+2796
$CTWIDTH EQU   TOLTEPWA+2795
$CTLINE  EQU   TOLTEPWA+2794
$APWIDTH EQU   TOLTEPWA+2793
$APLINE  EQU   TOLTEPWA+2792
$INDEX   EQU   $IMITX
$UMXX    EQU   @NM00048+14
$NSXX    EQU   @NM00048+12
$ATACNT  EQU   $NSCNT
$CTR     EQU   @NM00048+8
$ATAPTR  EQU   $NSPTR
$DDRPTR  EQU   @NM00048
$DTORESP EQU   TOLTEPWA+2712
$24SYMNE EQU   $24CATMG+4
$24DEVAD EQU   $24CATMG
$24RTN#  EQU   $24FEMSG+8
$ESECTID EQU   $24FEMSG
$24FLGS  EQU   TOLTEPWA+2680
$24SAVE2 EQU   TOLTEPWA+2676
$24SAVE1 EQU   TOLTEPWA+2672
$24UNADR EQU   TOLTEPWA+2668
$24SAV13 EQU   TOLTEPWA+2664
$24RETCD EQU   TOLTEPWA+2663
$MACID   EQU   TOLTEPWA+2661
$CSPARE  EQU   $CFLGS
$C2WAY   EQU   $CFLGS
$CINCT   EQU   $CCOMDAT+12
$CINADR  EQU   $CCOMDAT+8
$COUTCT  EQU   $CCOMDAT+4
$COUTAD  EQU   $CCOMDAT
ROOTLOC  EQU   TOLTEPWA+2640
$RETREG  EQU   TOLTEPWA+2636
$PASSONA EQU   TOLTEPWA+2264
$TRMINPT EQU   TOLTEPWA+2184
$BUFFER  EQU   TOLTEPWA+1976
$TLTRPL3 EQU   TOLTEPWA+1856
$TLTRPL2 EQU   TOLTEPWA+1736
$TLTRPL1 EQU   TOLTEPWA+1616
@NM00047 EQU   $SLTBL+135
$HIGHRTN EQU   $SLTBL+134
$PRIMADR EQU   $SLTBL+130
$CTSTPT  EQU   $SLTBL+128
$TSTCNT  EQU   $SLTBL+126
$SECFLGS EQU   $SECLST+3
$SECTION EQU   $SECLST
$SECACT  EQU   $TESTFLG
$CANTRUN EQU   $TESTFLG
$FINAL   EQU   $TESTFLG
$TESTSUF EQU   $RUNTEST+5
$TESTNUM EQU   $RUNTEST+1
$LETPRF  EQU   $RUNTEST
$SYMBOLC EQU   $SLTBL+5
$FAMILY  EQU   $SLTBL
$CDEVPT  EQU   TOLTEPWA+1466
$DEVCNTS EQU   TOLTEPWA+1464
$FEEDBCK EQU   $DEVTBLE+66
$WTISUED EQU   $DEVFLG4
$EXIOISD EQU   $DEVFLG4
$REMWRIT EQU   $DEVFLG4
$REMDONE EQU   $DEVFLG4
$2NDUSED EQU   $DEVFLG4
$1STUSED EQU   $DEVFLG4
$IGLXIFB EQU   $DEVFLG4
$EXIOLV3 EQU   $DEVFLG4
@NM00046 EQU   $DEVFLG5
$DVBASIC EQU   $DEVFLG5
$ASCII   EQU   $DEVFLG5
$DEVLU   EQU   $DEVFLG5
$OPNDFAL EQU   $DEVFLG5
$ACQNCB  EQU   $DEVFLG5
$REMOTE  EQU   $DEVFLG5
$ENDNODE EQU   $DEVFLG5
$CID     EQU   $DEVTBLE+52
$DVCOL   EQU   $LDNCBPT+2
$DVROW   EQU   $LDNCBPT
$NCSPLP  EQU   $DEVTBLE+44
$DVLN    EQU   $SSCPDAF
$DAF     EQU   $DEVSESP+4
$VARYPAB EQU   $DEVSESP
@NM00045 EQU   $DEVFLG3
$CLRSNT  EQU   $DEVFLG3
$OLTERR  EQU   $DEVFLG3
$SRTEST  EQU   $DEVFLG3
$DVSNDOK EQU   $SIOFLG
$POLLREQ EQU   $DEVFLG3
$DVINCT  EQU   $DEVTBLE+26
$DVBRKST EQU   $OPND+1
$DVBRKSN EQU   $OPND
$DVSEQNO EQU   $OPIS
$CEINTRP EQU   $DEVFLG2
$TESTMDE EQU   $DEVFLG2
$DEVALOC EQU   $DEVFLG2
$ALLDATA EQU   $DEVFLG2
$ENDCNTL EQU   $DEVFLG2
$CTLDEV  EQU   $DEVFLG2
$NOCDS   EQU   $DEVFLG2
$DATAIN  EQU   $DEVFLG2
$PRIMARY EQU   $DEVFLG1
$DVCTBYT EQU   $INTOCC
$DEVACT  EQU   $DEVFLG1
$DVLGMDE EQU   $ATTNEXP
$DVSPRM  EQU   $EVNCPLT
$GRABBED EQU   $DEVFLG1
$CATASTR EQU   $DEVFLG1
$LETGO   EQU   $DEVFLG1
$CURELEM EQU   $$SYMNME+4
$EXTDEV  EQU   $DEVCDS+11
@NM00044 EQU   $DEVSDCF
$NOTPRIM EQU   $DEVSDCF
@NM00043 EQU   $DEVCDSF
@NM00042 EQU   $DEVCDSF
@NM00041 EQU   $DEVCDSF
$CDSNAME EQU   $DEVCDSF
$EXTRN   EQU   $DEVCDSF
$CEVOLUM EQU   $DEVCDSF
$SHARD   EQU   $DEVCDSF
$DEVFPM  EQU   $DEVCDSF
$DEVCNT  EQU   $DEVCDS+8
$DEVTYPE EQU   $DEVFEAT+3
$DEVCLAS EQU   $DEVFEAT+2
$DEVFRRS EQU   $DEVFEAT+1
$DEVMOD  EQU   $DEVFEAT
$DEVRDGT EQU   @NM00039+1
$DEVCTLU EQU   @NM00039+1
$DEVCHAN EQU   @NM00039
@NM00040 EQU   @NM00039
$CTINDX  EQU   $DEVUNAD
$FLAG16  EQU   $COMMFLG+15
$FLAG15  EQU   $COMMFLG+14
$FLAG14  EQU   $COMMFLG+13
$TEP2ND  EQU   $FLAG13
$TEP1ST  EQU   $FLAG13
$CATMSG  EQU   $FLAG13
$PRMPTSW EQU   $FLAG13
$DEVENT  EQU   $FLAG13
$OLTMACC EQU   $FLAG13
$LGON    EQU   $FLAG13
$CTLOGON EQU   $FLAG13
@NM00038 EQU   $FLAG12
$VARYINP EQU   $FLAG12
$ENDTEST EQU   $FLAG12
$VRYHRD  EQU   $FLAG12
$VRYSFT  EQU   $FLAG12
$POSTFLG EQU   $FLAG12
$FEORCAT EQU   $FLAG11
@NM00037 EQU   $FLAG11
@NM00036 EQU   $FLAG10
$INBND   EQU   $FLAG10
$WAITFLG EQU   $FLAG10
$DPRINT  EQU   $FLAG10
$HOLD    EQU   $FLAG9
$NOTRRCH EQU   $FLAG9
@NM00035 EQU   $FLAG9
$COPY    EQU   $FLAG9
$LSTLNSW EQU   $FLAG9
$MULLNSW EQU   $FLAG9
$REMSW   EQU   $FLAG9
$IGRES   EQU   $FLAG9
$VS2     EQU   $FLAG8
$VS1     EQU   $FLAG8
$EDOS    EQU   $FLAG8
@NM00034 EQU   $FLAG8
$TWOWAY  EQU   $FLAG8
@NM00033 EQU   $FLAG8
$RCVMSG  EQU   $FLAG7
$RCVRFLG EQU   $FLAG7
$SNDRFLG EQU   $FLAG7
$LDOIS   EQU   $FLAG7
$DCONTCT EQU   $FLAG7
$EXIOWAT EQU   $FLAG7
$2NDDATA EQU   $FLAG7
$1STDATA EQU   $FLAG7
$CIREQ   EQU   $FLAG6
$ABTERM  EQU   $ABNDBIT
$FSTMCIS EQU   $FLAG6
$DISCREQ EQU   $FLAG6
$DISCISS EQU   $FLAG6
$CHANGE  EQU   $FLAG6
$CTERROR EQU   $FLAG6
$RECAL11 EQU   $FLAG6
@NM00032 EQU   $FLAG5
$PROGCK  EQU   $CANCEL
$PRINTAP EQU   $FLAG5
@NM00031 EQU   $FLAG5
$MSG922  EQU   $FLAG5
$CT924   EQU   $FLAG5
$FSTCAT  EQU   $FLAG5
$FSTFE   EQU   $FLAG5
$ACTOPND EQU   $FLAG4
$ACQCUTT EQU   $FLAG4
$CLSSACT EQU   $FLAG4
$BACKINT EQU   $FLAG4
$DMSGSW  EQU   $FLAG4
$TSTDEVP EQU   $FLAG4
$OPCOM   EQU   $FLAG4
$PRTONLY EQU   $FLAG3
$REQSTOR EQU   $FLAG3
$LOGOFFE EQU   $FLAG3
$TSTERR  EQU   $FLAG3
$DEVERR  EQU   $FLAG3
$PARTIAL EQU   $FLAG2
$NRMTERM EQU   $FLAG2
$VALDTST EQU   $FLAG2
$VALDDEV EQU   $FLAG2
$DBLSLSH EQU   $FLAG2
$NDR     EQU   $FLAG2
@NM00030 EQU   $FLAG2
$NORELDV EQU   $FLAG1
@NM00029 EQU   $FLAG1
$OPTCHNG EQU   $FLAG1
$DEVCHNG EQU   $FLAG1
$TESTCNG EQU   $FLAG1
$CNSLFG  EQU   $FLAG1
$TEP3RD  EQU   $FLAG1
@NM00028 EQU   $CDA+120
$CUCNT   EQU   $CDA+118
@NM00027 EQU   $CDA+117
$PRTFORM EQU   $CDA+116
$OPISCNT EQU   $CDA+114
$OPNDCNT EQU   $CDA+112
$GETMSZE EQU   $CDA+110
$GRCNTS  EQU   $CDA+108
$CTLCNT  EQU   $CDA+106
$ACTLVL  EQU   $CDA+105
$TIMEALW EQU   $CDA+96
$PTRAREA EQU   $CDA+92
$GETMPTR EQU   $CDA+88
$R13PTRT EQU   $CDA+84
$R13PTR  EQU   $CDA+80
$TEPEND  EQU   $CDA+76
$PLINKDL EQU   $CDA+72
$TEPBEGN EQU   $CDA+68
$FRELPTR EQU   $CDA+64
$HIGHADR EQU   $HIMOREC
$LOMOREC EQU   $CDA+56
$ENDCOMM EQU   $CDA+48
$COMMON  EQU   $RCA
$PASSON  EQU   $CDA+28
$TOLBRTB EQU   $CDA+24
$SCTPTR8 EQU   $CDA+20
$SCTPTR  EQU   $CDA+16
$TBWDPTR EQU   $CDA+12
$TFWDPTR EQU   $CDA+8
@NM00026 EQU   $CDA
@NM00025 EQU   $SCTTBLE+98
$SCTLWTC EQU   $SCTTBLE+96
$SCTLWTA EQU   $SCTTBLE+92
#EXT     EQU   $SCTTBLE+88
#PASS    EQU   $SCTTBLE+84
#TABLE   EQU   $SCTTBLE+80
#MSGIDAC EQU   $SCTTBLE+78
@NM00024 EQU   $SCTTBLE+71
$RETMASK EQU   $SCTTBLE+70
$R249255 EQU   $ROUTMSK+29
$R241248 EQU   $ROUTMSK+28
$R233240 EQU   $ROUTMSK+27
$R225232 EQU   $ROUTMSK+26
$R217224 EQU   $ROUTMSK+25
$R209216 EQU   $ROUTMSK+24
$R201208 EQU   $ROUTMSK+23
$R193200 EQU   $ROUTMSK+22
$R185192 EQU   $ROUTMSK+21
$R177184 EQU   $ROUTMSK+20
$R169176 EQU   $ROUTMSK+19
$R161168 EQU   $ROUTMSK+18
$R153160 EQU   $ROUTMSK+17
$R145152 EQU   $ROUTMSK+16
$R137144 EQU   $ROUTMSK+15
$R129136 EQU   $ROUTMSK+14
$R121128 EQU   $ROUTMSK+13
$R113120 EQU   $ROUTMSK+12
$R105112 EQU   $ROUTMSK+11
$R097104 EQU   $ROUTMSK+10
$R089096 EQU   $ROUTMSK+9
$R081088 EQU   $ROUTMSK+8
$R073080 EQU   $ROUTMSK+7
$R065072 EQU   $ROUTMSK+6
$R057064 EQU   $ROUTMSK+5
$R049056 EQU   $ROUTMSK+4
$R041048 EQU   $ROUTMSK+3
$R033040 EQU   $ROUTMSK+2
$R025032 EQU   $ROUTMSK+1
$R017024 EQU   $ROUTMSK
$TOTFLG2 EQU   $SCTTBLE+39
@NM00023 EQU   $TOTFLG1
@NM00022 EQU   $TOTFLG1
@NM00021 EQU   $TOTFLG1
$CURELOD EQU   $TOTFLG1
$CTEQTT  EQU   $TOTFLG1
@NM00020 EQU   $TOTFLG1
@NM00019 EQU   $TOTFLG1
$LINESHR EQU   $TOTFLG1
@NM00018 EQU   $OLTFLG2
@NM00017 EQU   $OLTFLG2
@NM00016 EQU   $OLTFLG2
@NM00015 EQU   $OLTFLG2
@NM00014 EQU   $OLTFLG2
@NM00013 EQU   $OLTFLG2
@NM00012 EQU   $OLTFLG2
$TALK    EQU   $OLTFLG2
$DYCOM   EQU   $OLTFLGS
@NM00011 EQU   $OLTFLGS
$RETCODE EQU   $OLTFLGS
$CONTCB  EQU   $OLTFLGS
$RETAIN  EQU   $OLTFLGS
$CLEANRT EQU   $OLTFLGS
$OLTSIZE EQU   $SCTTBLE+34
$QSCTMOD EQU   $EXECFLG
$CTRLMOD EQU   $EXECFLG
$CLEANUP EQU   $EXECFLG
$LSTPDEV EQU   $EXECFLG
$RTNSLCT EQU   $EXECFLG
$MULTDEV EQU   $EXECFLG
@NM00010 EQU   $EXECFLG
$RMSKCNT EQU   $SCTTBLE+32
$SYNAME  EQU   $CDS8T19+4
$EXTSIG  EQU   $CDS8T19+3
$CDFLGS  EQU   $CDS8T19+1
$CDSCNT  EQU   $CDS8T19
$PDEVDSC EQU   $SCTTBLE+16
$PDEVADR EQU   $SCTTBLE+12
$COMMCN  EQU   $CDSFLGS
$CUSTSYM EQU   $CDSFLGS
$TWOCHSW EQU   $CDSFLGS
$SYMNAME EQU   $CDSFLGS
$EXTINTC EQU   $CDSFLGS
$CEVOL   EQU   $CDSFLGS
$SHARED  EQU   $CDSFLGS
$FPM     EQU   $CDSFLGS
$LASTSUB EQU   $PDEVFLG
@NM00009 EQU   $PDEVFLG
@NM00008 EQU   $PDEVFLG
@NM00007 EQU   $PDEVFLG
$LASTDEV EQU   $PDEVFLG
@NM00006 EQU   $PDEVFLG
$EXFILPT EQU   $PDEVFLG
$FPMOLD  EQU   $PDEVFLG
$TSSSYM  EQU   $SCTTBLE+8
$SCTLEVL EQU   $SCTTBLE+7
$DRIVER  EQU   $SCTTBLE+6
$RT0916  EQU   $SCTTBLE+5
$RT0108  EQU   $SCTTBLE+4
$CATERR  EQU   $ERROPT
$ASTERIK EQU   $ERROPT
$TESTERR EQU   $ERROPT
$PARAPRT EQU   $TESTOPT
@NM00005 EQU   $TESTOPT
$TLTEND  EQU   $RCAAREA+945
$CNSLID  EQU   $RCAAREA+936
$EXITSAV EQU   $RCAAREA+864
$TRASCII EQU   $RCAAREA+608
@NM00004 EQU   $RCAAREA+605
$VTAMEND EQU   $RCAFLG
$TPPOSTD EQU   $RCAFLG
$NEWCT   EQU   $RCAFLG
$ABNDALL EQU   $RCAFLG
$CUTESTB EQU   $RCAFLG
$CONSOLE EQU   $RCAFLG
$TPLOGON EQU   $RCAFLG
$UPDATE  EQU   $RCAFLG
$DEVAREA EQU   $RCAAREA+600
$CTDVAR  EQU   $RCAAREA+596
$BUFFS   EQU   $RCAAREA+464
$TLTNIB  EQU   $CONSTNT+140
$TLTPRPL EQU   $CONSTNT+20
@NM00003 EQU   $CONSTNT+4
@NM00002 EQU   $CONSTNT+2
$USECNT  EQU   $CONSTNT
$CURRTWA EQU   $POINTER+140
$CTNAME  EQU   $POINTER+132
$CTARGX  EQU   $POINTER+128
$COMINT  EQU   $POINTER+120
$QUEHNDL EQU   $POINTER+116
@NM00001 EQU   $POINTER+36
$RTNPTR  EQU   $POINTER+32
$TLTECB2 EQU   $POINTER+28
$TLTECB1 EQU   $POINTER+24
$CLEANP  EQU   $POINTER+20
$ABEND   EQU   $POINTER+16
$LSTAREA EQU   $POINTER+12
$FSTAREA EQU   $POINTER+8
$CVTSAVE EQU   $POINTER+4
$TOLTEP  EQU   $POINTER
$TLTACB  EQU   $RCAAREA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00103 EQU   OPT900
@RT00123 EQU   OPT300
@RT00131 EQU   OPT200
@RT00138 EQU   OPT100
@RF00150 EQU   OPT070
@RF00157 EQU   OPT070
@RF00164 EQU   OPT070
@RF00171 EQU   OPT070
@RF00178 EQU   OPT070
@RF00185 EQU   OPT070
@RT00198 EQU   OPT800
@RT00216 EQU   OPT900
@RF00221 EQU   OPT070
@RF00265 EQU   OPT070
@RT00275 EQU   OPT355
@RT00289 EQU   OPT800
@RT00301 EQU   OPT800
@RT00303 EQU   OPT370
@RT00319 EQU   OPT890
@RT00326 EQU   OPT070
@RT00354 EQU   OPT430
@RT00372 EQU   OPT890
@RT00383 EQU   OPT800
@RT00399 EQU   OPT820
@RT00427 EQU   OPT900
@ENDDATA EQU   *
         END   ISTIC005,(C'PLS1241',0702,78336)

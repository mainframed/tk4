         TITLE 'IRARMEVT - SYSTEM RESOURCES MANAGER SYSEVENT PROCESSORS*
               S        '
IRARMEVT CSECT ,                                                   0001
@MAINENT BALR  @15,0                                               0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT-2)
IRARMXVT BALR  @15,0                                               0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00168-IRARMXVT-2)
         ENTRY IRARMXVT
         DROP  @15
@PROLOG  BALR  @08,0                                               0001
@PSTART  LA    @09,4095(,@08)                                      0001
         USING @PSTART,@08                                         0001
         USING @PSTART+4095,@09                                    0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*                                                                  0164
*/*                                                                  */
*/*   SYSEVENT ROUTER TO PASS CONTROL TO THE APPROPRIATE             */
*/*   SYSEVENT PROCESSOR.                                            */
*/*                                                                  */
*                                                                  0164
*IRARMRVT:                          /* ENTRY POINT FOR SYSEVENT RETRY*/
*   SVEREG=RMCTRMSA;                /* SRM SAVE AREA START ADDRESS   */
IRARMRVT L     SVEREG,RMCTRMSA(,RMCTPTR)                           0164
*   RRPAEPA=ADDR(RMEPBEVT);         /* ADDRESS OF ENTRY POINT BLOCK
*                                      FOR THIS MODULE FOR RECOVERY  */
         LA    @12,RMEPBEVT(,RMCTPTR)                              0165
         ST    @12,RRPAEPA(,RRPAPTR)                               0165
*   GOTO PROCESSR;                  /* PROCESS CURRENT SYSEVENT      */
         SLR   @12,@12                                             0166
         IC    @12,RRPACOD(,RRPAPTR)                               0166
         SLA   @12,2                                               0166
         L     @12,IRAPRCSR-4(@12)                                 0166
         BR    @12                                                 0166
*   RESPECIFY                                                      0167
*     OUXBPTR UNRSTD;                                              0167
*                                                                  0168
*/*                                                                  */
*/* SETUP THE ENVIRONMENT REQUIRED TO RETRY THE SYSEVENT THAT WAS    */
*/* BEING PROCESSED WHEN A SYSTEM ERROR OCCURRED.                    */
*/*                                                                  */
*                                                                  0168
*IRARMXVT:                                                         0168
*   ENTRY;                                                         0168
@EP00168 DS    0H                                                  0169
*   IF RRPAASD^=ZERO&               /* IF ASID DEFINED               */
*       RRPAASD<=ASVTMAXU&          /* WITHIN THE ASVT AND           */
*       ASVTENTY(RRPAASD)>ZERO THEN /* ASCB ADDRESS VALID,           */
         LH    @12,RRPAASD(,RRPAPTR)                               0169
         N     @12,@CF02678                                        0169
         LTR   @12,@12                                             0169
         BZ    @RF00169                                            0169
         L     @11,CVTPTR                                          0169
         L     @11,ASVTPTR(,@11)                                   0169
         C     @12,ASVTMAXU(,@11)                                  0169
         BH    @RF00169                                            0169
         SLA   @12,2                                               0169
         L     @12,ASVTENTY-4(@12,@11)                             0169
         LTR   @12,@12                                             0169
         BNP   @RF00169                                            0169
*     ASCBPTR=ASVTENTY(RRPAASD);    /* ADDRESSABILITY TO ASCB        */
         LR    ASCBPTR,@12                                         0170
*   ELSE                            /* ASID INVALID                  */
*     DO;                           /* TERMINATE USER                */
         B     @RC00169                                            0171
@RF00169 DS    0H                                                  0172
*       RESNCODE=CON4;              /* ABEND REASON CODE             */
*                                                                  0172
         LA    RESNCODE,4                                          0172
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I10)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0173
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */
         L     @15,RMSBI10(,RMCTPTR)                               0173
         BALR  @14,@15                                             0173
*     END;                                                         0174
*   OUCBPTR=ASCBOUCB;               /* ADDRESSABILITY TO OUCB        */
@RC00169 L     OUCBPTR,ASCBOUCB(,ASCBPTR)                          0175
*   GOTO IRARMRVT;                  /* GO RETRY SYSEVENT             */
         B     IRARMRVT                                            0176
*                                                                  0177
*/* **************************************************************** */
*/*                                                                  */
*/* ENTRY POINT NAME = IRARMDEL                                      */
*/*                                                                  */
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER FREE OUCB AND OUXB   */
*/*                    STORAGE ROUTINE                               */
*/*                                                                  */
*/* FUNCTION = TO RELEASE THE STORAGE FOR THE OUCB AND OUXB WHEN A   */
*/*            MEMORY IS BEING TERMINATED, AND TO NOTIFY THE ISSUER  */
*/*            OF SYSEVENT 7(MEMDEL) TO CONTINUE MEMORY TERMINATION. */
*/*            NOTE: IRARMDEL IS AN 'ACTION' ROUTINE THAT IS         */
*/*                  EXECUTED UNDER THE SRM LOCK             @Z40BPJE*/
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMDEL FOR RECOVERY   */
*/*           REG  2 - RMCT ADDRESS                                  */
*/*           REG  3 - RRPA ADDRESS                                  */
*/*           REG 14 - RETURN POINT ADDRESS                          */
*/*           REG 15 - ENTRY POINT ADDRESS                           */
*/*                                                                  */
*/* INPUT = REG  4 - OUCB ADDRESS OF MEMORY THAT IS BEING TERMINATED */
*/*                                                                  */
*/* OUTPUT = NONE                                                    */
*/*                                                                  */
*/*                                                                  */
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */
*/*                                                                  */
*/* **************************************************************** */
*                                                                  0177
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLEP EPN(DEL)CODEREG(8)SAVE(0,14)                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0177
*   DCL                                                            0177
*     IRARMDEL ENTRY INT;                                          0177
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMDEL) NOEXIT SEQFLOW; 0178
*                                  /*
         ENTRY IRARMDEL
IRARMDEL DS    0H
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY
*   OUCBFWD->OUCBBCK=OUCBBCK;       /* UPDATE BACK CHAIN PTR         */
         L     @12,OUCBFWD(,OUCBPTR)                               0179
         L     @11,OUCBBCK(,OUCBPTR)                               0179
         ST    @11,OUCBBCK(,@12)                                   0179
*   OUCBBCK->OUCBFWD=OUCBFWD;       /* UPDATE FORWARD CHAIN PTR      */
         ST    @12,OUCBFWD(,@11)                                   0180
*   IF OUCBOUT='0'B THEN            /* IF USER NOT ALREADY OUT       */
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0181
         BNZ   @RF00181                                            0181
*     RMCAINUS=RMCAINUS-ONE;        /* DECREMENT NO. OF MEMORIES IN
*                                      STORAGE                       */
         LH    @12,RMCAINUS(,RMCTPTR)                              0182
         BCTR  @12,0                                               0182
         STH   @12,RMCAINUS(,RMCTPTR)                              0182
*   IF OUCBGOI='1'B THEN            /* IF MEMORY ON WAY INTO CORE  0183
*                                                            @Z40BPJE*/
@RF00181 TM    OUCBGOI(OUCBPTR),B'01000000'                        0183
         BNO   @RF00183                                            0183
*     RMCACIUS=RMCACIUS-ONE;        /* DECREMENT COUNT OF USERS THAT
*                                      ARE COMING INTO CORE. @Z40BPJE*/
         LH    @12,RMCACIUS(,RMCTPTR)                              0184
         BCTR  @12,0                                               0184
         STH   @12,RMCACIUS(,RMCTPTR)                              0184
*   ASCBPTR=OUCBASCB;               /* ADDRESSABILITY TO ASCB        */
@RF00183 L     ASCBPTR,OUCBASCB(,OUCBPTR)                          0185
*   ASCBOUCB=ZERO;                                                 0186
         SLR   @12,@12                                             0186
         ST    @12,ASCBOUCB(,ASCBPTR)                              0186
*   OUCBINV='1'B;                   /* OUCB INVALID          @Z40BPCH*/
         OI    OUCBINV(OUCBPTR),B'00010000'                        0187
*   OUCBASCB=ZERO;                                                 0188
         ST    @12,OUCBASCB(,OUCBPTR)                              0188
*   R0=LENGTH(OUCB);                /* SIZE OF STORAGE TO FREE       */
         LA    R0,136                                              0189
*   R1=OUCBPTR;                     /* ADDRESS OF STORAGE TO FREE    */
*                                                                  0190
         LR    R1,OUCBPTR                                          0190
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I04)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0191
*   CALL RMSBI04->IRARMRTN;         /* INVOKE I04 SUBRTN             */
*                                                                  0191
         L     @15,RMSBI04(,RMCTPTR)                               0191
         BALR  @14,@15                                             0191
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE STORAGE                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0192
*   R0=LENGTH(OUXB);                /* SIZE OF STORAGE TO FREE       */
         LA    R0,144                                              0192
*   R1=ASCBOUXB;                    /* ADDRESS OF STORAGE TO FREE    */
         L     R1,ASCBOUXB(,ASCBPTR)                               0193
*   ASCBOUXB=ZERO;                  /* OUXB INVALID                  */
*                                                                  0194
         SLR   @12,@12                                             0194
         ST    @12,ASCBOUXB(,ASCBPTR)                              0194
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I04)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*   CALL RMSBI04->IRARMRTN;         /* INVOKE I04 SUBRTN             */
*                                                                  0195
         L     @15,RMSBI04(,RMCTPTR)                               0195
         BALR  @14,@15                                             0195
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE STORAGE                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0196
*   R0=ZERO;                        /* SET POST CODE         @ZA16877*/
         SLR   R0,R0                                               0196
*   R1=ADDR(ASCBMECB);              /* ECB ADDRESS TO XMPOST         */
         LA    R1,ASCBMECB(,ASCBPTR)                               0197
*   ASCBPTR=RMCAMAS;                /* WILL POST MASTER SCHEDULER    */
*                                                                  0198
         L     ASCBPTR,RMCAMAS(,RMCTPTR)                           0198
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I06)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0199
*   CALL RMSBI06->IRARMRTN;         /* INVOKE I06 SUBRTN             */
*                                                                  0199
         L     @15,RMSBI06(,RMCTPTR)                               0199
         BALR  @14,@15                                             0199
*   /*****************************************************************/
*   /*                                                               */
*   /* ISSUE XMPOST                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0200
*   IF RRPASVC='1'B&                /* SRM INVOKED VIA TYPE-1 SVC    */
*       RRPACOD^=SYSEVT48 THEN      /* AND NOT INVOKED BY SRM SRB,   */
         TM    RRPASVC(RRPAPTR),B'00100000'                        0200
         BNO   @RF00200                                            0200
         CLI   RRPACOD(RRPAPTR),48                                 0200
         BE    @RF00200                                            0200
*     RRPARTN=CVTEXP1;              /* FORCE EXIT THRU DISPATCHER    */
*                                                                  0201
         L     @12,CVTPTR                                          0201
         L     @12,CVTEXP1(,@12)                                   0201
         ST    @12,RRPARTN(,RRPAPTR)                               0201
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLEP ENN(DEL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0202
*   GEN CODE EXIT NOSEQFLOW;                                       0202
@RF00200 DS    0H                                                  0202
*                                  /*
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS
         BR    RTNREG                  RETURN TO INVOKER
*                                                                  0203
*/* **************************************************************** */
*/*                                                                  */
*/* ENTRY POINT NAME = IRARMIPS                                      */
*/*                                                                  */
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER SWITCH TO NEW        */
*/*                    INTERNAL PERFORMANCE SPECIFICATION(IPS)       */
*/*                    RESIDENT SUBROUTINE                           */
*/*                                                                  */
*/* FUNCTION = TO INVOKE THE NON-RESIDENT PORTION OF THE SWITCH TO   */
*/*            NEW IPS SUBROUTINE.                                   */
*/*            NOTE:  IRARMIPS IS AN 'ACTION' ROUTINE THAT IS        */
*/*                   EXECUTED UNDER THE SRM LOCK            @Z40BPJE*/
*/*                                                                  */
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMIPS FOR RECOVERY   */
*/*           REG  2 - RMCT ADDRESS                                  */
*/*           REG  3 - RRPA ADDRESS                                  */
*/*           REG 14 - RETURN POINT ADDRESS                          */
*/*           REG 15 - ENTRY POINT ADDRESS                           */
*/*                                                                  */
*/* INPUT = WMSTNWST - ADDRESS OF THE NEW IPS                        */
*/*                                                                  */
*/* OUTPUT = NONE                                                    */
*/*                                                                  */
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */
*/*                                                                  */
*/* **************************************************************** */
*                                                                  0203
*IRARMXPS:                          /* ENTRY POINT IF SET TO NEW IPS
*                                      PROCESSING HAS FAILED         */
*                                                                  0203
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLEP EPN(IPS)CODEREG(8)SAVE(0,14)                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0203
*   DCL                                                            0203
*     IRARMIPS ENTRY INT;                                          0203
IRARMXPS DS    0H                                                  0204
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMIPS) NOEXIT SEQFLOW; 0204
*                                  /*
         ENTRY IRARMIPS
IRARMIPS DS    0H
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY
*   RRPAIPS='1'B;                   /* IRARMSET ROUTINE IN CONTROL   */
         OI    RRPAIPS(RRPAPTR),B'00100000'                        0205
*/*                                                                  */
*/*   INVOKE IRARMSET TO SWITCH TO THE NEW IPS.                      */
*/*                                                                  */
*                                                                  0206
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(SET)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0206
*   CALL RMSBSET->IRARMRTN;         /* INVOKE SET SUBRTN             */
         L     @15,RMSBSET(,RMCTPTR)                               0206
         BALR  @14,@15                                             0206
*   RRPAIPS='0'B;                   /* IRARMSET NO LONGER IN CONTROL */
         NI    RRPAIPS(RRPAPTR),B'11011111'                        0207
*   RMSBSET=RMSBNOP;                /* RESET ROUTINE ADDRESS         */
*                                                                  0208
         L     @12,RMSBNOP(,RMCTPTR)                               0208
         ST    @12,RMSBSET(,RMCTPTR)                               0208
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLEP ENN(IPS)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0209
*   GEN CODE EXIT NOSEQFLOW;                                       0209
*                                  /*
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS
         BR    RTNREG                  RETURN TO INVOKER
*                                                                  0210
*/* **************************************************************** */
*/*                                                                  */
*/* ENTRY POINT NAME = IRARMUXB                                      */
*/*                                                                  */
*/* DESCRIPTIVE NAME = SYSTEM RESOURCES MANAGER FREE OUXB            */
*/*                    STORAGE ROUTINE                               */
*/*                                                                  */
*/* FUNCTION = TO RELEASE THE STORAGE FOR THE OUXB(SQA) DURING THE   */
*/*            INTERVAL THE MEMORY IS OUT OF STORAGE, TO NOTIFY THE  */
*/*            ISSUER OF SYSEVENT 43(REQSWAP) THAT THE SWAPOUT-SWAPIN*/
*/*            IS COMPLETE, AND TO MAKE A MEMORY IN LONG WAIT        */
*/*            ELIGIBLE TO BE SWAPPED IN IF A SYSEVENT 4(USERRDY)    */
*/*            HAS BEEN RECEIVED.                                    */
*/*            NOTE:  IRARMUXB IS AN 'ACTION' ROUTINE THAT IS        */
*/*                   EXECUTED UNDER THE SRM LOCK            @Z40BPJE*/
*/*                                                                  */
*/* LINKAGE = REG  1 - RMEP BLOCK ADDRESS OF IRARMUXB FOR RECOVERY   */
*/*           REG  2 - RMCT ADDRESS                                  */
*/*           REG  3 - RRPA ADDRESS                                  */
*/*           REG 14 - RETURN POINT ADDRESS                          */
*/*           REG 15 - ENTRY POINT ADDRESS                           */
*/*                                                                  */
*/* INPUT = REG  4 - OUCB ADDRESS OF MEMORY THAT WAS SWAPPED OUT     */
*/*                                                                  */
*/* OUTPUT = NONE                                                    */
*/*                                                                  */
*/* EXIT-NORMAL = RETURN VIA REG 14                                  */
*/*                                                                  */
*/* **************************************************************** */
*                                                                  0210
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLEP EPN(UXB)CODEREG(8)SAVE(0,14)                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0210
*   DCL                                                            0210
*     IRARMUXB ENTRY INT;                                          0210
*   GEN CODE REFS(RMCTRMSA,RRPAEPA) DEFS(IRARMUXB) NOEXIT SEQFLOW; 0211
*                                  /*
         ENTRY IRARMUXB
IRARMUXB DS    0H
         L     @15,RMCTRMSA(,RMCTPTR)  SRM SAVE AREA START ADDRESS
         STM   @00,@14,064+000(@15)    SAVE INVOKING RTNE REGS
         MVC   064+060(4,@15),RRPAEPA(RRPAPTR) SAVE PREV RMEP
         ST    @01,RRPAEPA(,RRPAPTR)   INDICATE NEW CURRENT RMEP
         LR    @13,@15                 ROUTINE SAVE AREA ADDRESS
         BALR  @15,0                   SETUP ENTRY ADDRESSABILITY
         LA    @08,*-@PSTART           DISPLACEMENT TO MODULE BASE
         LCR   @08,@08                 NEGATIVE FOR SUBTRACT
         ALR   @08,@15                 SETUP MODULE ADDRESSABILITY
*   RESPECIFY                                                      0212
*    (BASE1,                                                       0212
*     BASE2) RESTRICTED;            /*                       @YM05628*/
*   BASE2=BASE1+CON4095;            /* INITIALIZE BASE REG2  @YM05628*/
         LA    BASE2,4095                                          0213
         ALR   BASE2,BASE1                                         0213
*   RESPECIFY                                                      0214
*    (BASE1,                                                       0214
*     BASE2) UNRESTRICTED;          /*                       @YM05628*/
*   RFY                                                            0215
*     OUXBPTR RSTD;                                                0215
*   ASCBPTR=OUCBASCB;               /* ADDRESSABILITY TO ASCB        */
         L     ASCBPTR,OUCBASCB(,OUCBPTR)                          0216
*   IF ASCBOUXB^=RMCTOUXB           /* CANNOT FREE PRE-DEFINED OUXB  */
*       &OUCBOUT='1'B               /* OR OUXB OF USER IN OR ON THE  */
*       &OUCBGOI='0'B THEN          /* WAY INTO MAIN STORAGE         */
         L     @12,ASCBOUXB(,ASCBPTR)                              0217
         C     @12,RMCTOUXB(,RMCTPTR)                              0217
         BE    @RF00217                                            0217
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0217
         BNO   @RF00217                                            0217
         TM    OUCBGOI(OUCBPTR),B'01000000'                        0217
         BNZ   @RF00217                                            0217
*     DO;                                                          0218
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO OUXB        */
*                                                                  0219
         LR    OUXBPTR,@12                                         0219
*       /*************************************************************/
*       /*                                                           */
*       /* FINISH TRANSWAP                                   @ZA16887*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0220
*       IF OUCBTSWP='1'B THEN       /* TRANSWAP IN PROGRESS? @ZA16887*/
         TM    OUCBTSWP(OUCBPTR),B'00010000'                       0220
         BNO   @RF00220                                            0220
*         DO;                       /* FINISH IT             @ZA16887*/
*           OUCBNSW='1'B;           /* SET A.S. NONSWAPPABLE @ZA16887*/
         OI    OUCBNSW(OUCBPTR),B'10000000'                        0222
*           OUCBNDS=OUCBNDS+OUCBNTSP+ONE;/* INCREMENT COUNT BY NUMBER
*                                      OF TRANSWAPS PENDING  @ZA16887*/
         LH    @12,OUCBNDS(,OUCBPTR)                               0223
         AH    @12,OUCBNTSP(,OUCBPTR)                              0223
         AL    @12,@CF00078                                        0223
         STH   @12,OUCBNDS(,OUCBPTR)                               0223
*           IF OUCBNDS<ZERO THEN    /* COUNT EXCEEDS MAX?    @ZA20975*/
         LH    @12,OUCBNDS(,OUCBPTR)                               0224
         LTR   @12,@12                                             0224
         BNM   @RF00224                                            0224
*             OUCBNDS=CON32767;     /* SET TO MAX VALUE      @ZA16887*/
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         0225
*           IF OUCBNDS=ONE THEN     /* SWAP STATUS CHNGD?    @ZA16887*/
*                                                                  0226
@RF00224 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         0226
         BNE   @RF00226                                            0226
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(WMK)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0227
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */
*                                                                  0227
         L     @15,RMSBWMK(,RMCTPTR)                               0227
         BALR  @14,@15                                             0227
*           /*********************************************************/
*           /*                                                       */
*           /* LET WLM KNOW                                  @ZA16887*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0228
*           OUCBTSWC='1'B;          /* INDICATE TRANSWAP COMPL     0228
*                                                            @ZA16887*/
@RF00226 OI    OUCBTSWC(OUCBPTR),B'00001000'                       0228
*         END;                      /* END TRANSWAP CASE     @ZA20975*/
*                                                                  0229
*       /*************************************************************/
*       /*                                                           */
*       /* POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.       */
*       /*                                                   @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0230
*       IF OUCBRSWP='1'B×OUCBTSWP='1'B THEN/* POSTING NEEDED?      0230
*                                                            @ZA20975*/
@RF00220 TM    OUCBRSWP(OUCBPTR),B'00110000'                       0230
         BZ    @RF00230                                            0230
*         DO;                       /* POSSIBLY...           @ZA20975*/
*           R0=ZERO;                /* I06 WILL POST WITH 0  @ZA20975*/
         SLR   R0,R0                                               0232
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA20975*/
         BAL   @14,EVTENDSW                                        0233
*         END;                      /* DONE POSTING.         @ZA20975*/
*       R0=LENGTH(OUXB);            /* LENGTH OF STORAGE AREA        */
@RF00230 LA    R0,144                                              0235
*       R1=OUXBPTR;                 /* ADDRESS OF STORAGE AREA       */
*                                                                  0236
         LR    R1,OUXBPTR                                          0236
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I04)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0237
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */
*                                                                  0237
         L     @15,RMSBI04(,RMCTPTR)                               0237
         BALR  @14,@15                                             0237
*       /*************************************************************/
*       /*                                                           */
*       /* FREE STORAGE PROVIDE DUMMY AREA FOR OUXB WHILE MEMORY IS  */
*       /* SWAPPED OUT TO PREVENT THE DESTRUCTION OF VALID           */
*       /* INFORMATION IF AN ATTEMPT TO REFERENCE THE OUXB OCCURS    */
*       /* WHILE THE MEMORY IS OUT OF MAIN STORAGE.                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0238
*       ASCBOUXB=RMCTOUXB;                                         0238
         L     @12,RMCTOUXB(,RMCTPTR)                              0238
         ST    @12,ASCBOUXB(,ASCBPTR)                              0238
*     END;                                                         0239
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* CHAP USERS TO SWAP IN PRIORITY FOR NEW TSO TRANSACTIONS IN THE*/
*   /* APG, THAT IS THE PRIORITY OF THE FIRST PERFORMANCE GROUP      */
*   /* PERIOD. FOR OTHER USERS IN THE MTW, THE SWAP IN PRIORITY IS   */
*   /* THE TOP OF THE MTW.                                   @ZA19283*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF OUCBAPG='1'B THEN            /* USER IN APG           @YM05632*/
@RF00217 TM    OUCBAPG(OUCBPTR),B'01000000'                        0240
         BNO   @RF00240                                            0240
*     IF OUCBINC='1'B               /* THIS IS A NEW TSO     @YM05632*/
*         &OUCBATR='0'B             /* TRANSACTION           @YM05632*/
*       THEN                                                       0241
         TM    OUCBINC(OUCBPTR),B'00000001'                        0241
         BNO   @RF00241                                            0241
         TM    OUCBATR(OUCBPTR),B'10000000'                        0241
         BNZ   @RF00241                                            0241
*       OUCBNDP=OUCBRDP;            /* USE INITIAL PRIORITY  @Z40BPJE*/
         IC    @12,OUCBRDP(,OUCBPTR)                               0242
         STC   @12,OUCBNDP(,OUCBPTR)                               0242
*     ELSE                                                         0243
*       IF OUCBNDP<CCCAPGDP         /* IN MEAN TIME TO WAIT  @ZA19283*/
*         THEN                                                     0243
         B     @RC00241                                            0243
@RF00241 LH    @12,CCCAPGDP(,RMCTPTR)                              0243
         SLR   @07,@07                                             0243
         IC    @07,OUCBNDP(,OUCBPTR)                               0243
         CR    @12,@07                                             0243
         BNH   @RF00243                                            0243
*         OUCBNDP=CCCAPGDP;         /* PUT AT TOP            @ZA19283*/
         STC   @12,OUCBNDP(,OUCBPTR)                               0244
*   CALL EVTCHAP;                   /* CHAP USER FOR SWAPIN  @YM05632*/
@RF00243 DS    0H                                                  0245
@RC00241 DS    0H                                                  0245
@RF00240 BAL   @14,EVTCHAP                                         0245
*   OUCBGOO='0'B;                   /* MEMORY OUT OF MAIN STORAGE    */
         NI    OUCBGOO(OUCBPTR),B'01111111'                        0246
*   IF OUCBOFF='1'B&                /* MEMORY IS ON LONG WAIT QUEUE  */
*       OUCBRDY='1'B THEN           /* USERRDY RECEIVED FOR MEMORY   */
*                                                                  0247
         TM    OUCBOFF(OUCBPTR),B'00001000'                        0247
         BNO   @RF00247                                            0247
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0247
         BNO   @RF00247                                            0247
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(HIT)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0248
*     DO;                                                          0248
*       R1=ADDR(RMEPBHIT);          /* HIT REQUEST IS PARAM          */
         LA    R1,RMEPBHIT(,RMCTPTR)                               0249
*       CALL RMSBCRN->IRARMRTN;     /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0250
         BALR  @14,@15                                             0250
*     END;                          /* MAKE THE MEMORY ELIGIBLE FOR
*                                      SWAP IN               @Z40BPJE*/
*   RFY                                                            0252
*     OUXBPTR UNRSTD;                                              0252
*                                                                  0252
@RF00247 DS    0H                                                  0253
*/*   ? IRACTLEP ENN(UXB)                                            */
*                                                                  0253
*   GEN CODE EXIT NOSEQFLOW;                                       0253
*                                  /*
         MVC   RRPAEPA(4,RRPAPTR),064+060(@13) RESTORE PREV RMEP
         LM    @00,@14,064+000(@13)    RELOAD INVOKING RTNE REGS
         BR    RTNREG                  RETURN TO INVOKER
*                                                                  0254
*/***********************************************************@YM05632*/
*/*                                                          @YM05632*/
*/* EVTCHAP - IRARMEVT INTERNAL SUBROUTINE                   @YM05632*/
*/*                                                          @YM05632*/
*/* FUNCTION - BUILD CHAP PARAMETER LIST AND INVOKE ASCBCHAP @YM05632*/
*/*                                                          @YM05632*/
*/* INPUT -                                                  @YM05632*/
*/*   ASCBPTR - ADDRESS OF ASCB TO BE CHAPPED                @YM05632*/
*/*   OUCBNDP - NEW DISPATCHING PRIORITY                     @YM05632*/
*/*                                                          @YM05632*/
*/***********************************************************@YM05632*/
*                                                                  0254
*EVTCHAP:                                                          0254
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @YM05632*/
EVTCHAP  DS    0H                                                  0255
*   RESPECIFY                                                      0255
*     WRKREG2 RSTD;                 /*                       @YM05632*/
*   IF ASCBDP^=OUCBNDP THEN         /* TEST IF NEED CHAP     @Z30WIMG*/
*                                                                  0256
         CLC   ASCBDP(1,ASCBPTR),OUCBNDP(OUCBPTR)                  0256
         BE    @RF00256                                            0256
*     /***************************************************************/
*     /*                                                             */
*     /* REPOSITION ADDRESS SPACE ON DISPATCHER READY QUEUE  @Z30WIMG*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0257
*     DO;                           /*                       @Z30WIMG*/
*       WRKREG2=RTNREG;             /* SAVE RETURN REGISTER  @YM05632*/
         LR    WRKREG2,RTNREG                                      0258
*       CHAPASCB=ASCBPTR;           /* BUILD PARAMETER       @YM05632*/
         ST    ASCBPTR,CHAPASCB                                    0259
*       CHAPDP=OUCBNDP;             /* LIST                  @YM05632*/
         IC    @12,OUCBNDP(,OUCBPTR)                               0260
         STC   @12,CHAPDP                                          0260
*       R1=ADDR(CHAPLIST);          /* POINT TO PARM LIST    @YM05632
*                                      INVOKE ASCBCHAP       @YM05632*/
*                                                                  0261
         LA    R1,CHAPLIST                                         0261
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I02)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0262
*       CALL RMSBI02->IRARMRTN;     /* INVOKE I02 SUBRTN             */
*                                                                  0262
         L     @15,RMSBI02(,RMCTPTR)                               0262
         BALR  @14,@15                                             0262
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @YM05632*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0263
*       RTNREG=WRKREG2;             /* RESTORE RETURN REG    @YM05632*/
         LR    RTNREG,WRKREG2                                      0263
*     END;                          /*                       @Z30WIMG*/
*   RESPECIFY                                                      0265
*     WRKREG2 UNRSTD;               /*                       @YM05632*/
*   END;                            /*                       @YM05632*/
@EL00002 DS    0H                                                  0266
@EF00002 DS    0H                                                  0266
@ER00002 BR    @14                                                 0266
*                                                                  0267
*/***********************************************************@ZA16887*/
*/*                                                          @ZA16887*/
*/* EVTABEND -    SUBROUTINE  USED TO ABEND THE ISSUER OF A  @ZA16887*/
*/*            SYSEVENT THAT ENCOUNTERED AN ERROR CONDITION. @ZA16887*/
*/*            USE THIS FOR ABENDS OTHER THAN '15F' (USE I10 @ZA16887*/
*/*            FOR '15F').                                   @ZA16887*/
*/*   INPUT  - REG15=REASON CODE,  REG1=COMPLETION CODE      @ZA16887*/
*/*                                                          @ZA16887*/
*/***********************************************************@ZA16887*/
*                                                                  0267
*EVTABEND:                          /*                       @ZA16687*/
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA16887*/
EVTABEND DS    0H                                                  0268
*   GENERATE CODE(ABEND (1),DUMP,,SYSTEM);/*                 @ZA16887*/
         ABEND (1),DUMP,,SYSTEM
*   END;                            /*                       @ZA16887*/
@EL00003 DS    0H                                                  0269
@EF00003 DS    0H                                                  0269
@ER00003 BR    @14                                                 0269
*                                                                  0270
*/***********************************************************@ZA20975*/
*/*                                                          @ZA20975*/
*/* EVTSTACK - IRARMEVT ECB STACK SUBROUTINE                 @ZA20975*/
*/*                                                          @ZA20975*/
*/* FUNCTION - ADD AN ECB TO A STACK FOR CONCURRENT          @ZA20975*/
*/*            TRANSWAPS OR REQSWAPS.  IF A STACK DOES NOT   @ZA20975*/
*/*            YET EXIST, GET AN AREA FOR ONE.               @ZA20975*/
*/*                                                          @ZA20975*/
*/* CALLERS  - SYSEVENT TRANSWAP                             @ZA20975*/
*/*            SYSEVENT REQSWAP                              @ZA20975*/
*/*                                                          @ZA20975*/
*/* INPUT    - REG1:                                         @ZA20975*/
*/*             FOR TRANSWAP, ADDRESS OF OUXBTSW             @ZA20975*/
*/*             FOR REQSWAP, ADDRESS OF OUXBRSW              @ZA20975*/
*/*             (IF THE OUXB FIELD HAS THE HIGH ORDER BIT    @ZA20975*/
*/*              ON, IT POINTS TO A STACK OF ECB ADDRESSES.  @ZA20975*/
*/*              OTHERWISE IT POINTS TO SINGLE ECB.)         @ZA20975*/
*/*            REG3: ADDRESS OF RRPA                         @ZA20975*/
*/*                                                          @ZA20975*/
*/* OUTPUT   - IF A STACK MUST BE CREATED, ITS               @ZA20975*/
*/*            ADDRESS IS PUT IN THE OUXB FIELD AND THE      @ZA20975*/
*/*            HIGH ORDER BIT TURNED ON.  IF A STACK ALREADY @ZA20975*/
*/*            EXISTS, ANOTHER ECB ADDRESS IS ADDED TO IT.   @ZA20975*/
*/*                                                          @ZA20975*/
*/***********************************************************@ZA20975*/
*                                                                  0270
*EVTSTACK:                                                         0270
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/
EVTSTACK DS    0H                                                  0271
*/* USE GLOBAL SAVEAREA 3                                    @ZA20975*/
*                                                                  0271
*   GEN CODE REFS(RMCTRMSA) NOEXIT SEQFLOW;                        0271
*                                                       /*  @ZA20975*/
  L    @15,RMCTRMSA(,RMCTPTR)
  STM  @00,@14,128+000(@15)
  LR   @13,@15
*   RFY                                                            0272
*     I RSTD;                       /* WORK REG FOR LOOP     @ZA20975*/
*   ECBPARM=R1;                     /* STORE INPUT VALUE     @ZA20975*/
         LR    ECBPARM,R1                                          0273
*   IF RRPAINP^=ZERO THEN           /* THIS SWAP HAS ECB?    @ZA20975*/
         SLR   @10,@10                                             0274
         C     @10,RRPAINP(,RRPAPTR)                               0274
         BE    @RF00274                                            0274
*     IF SWAPECB^=ZERO THEN         /* ALREADY ONE WITH ECB? @ZA20975*/
         C     @10,SWAPECB(,ECBPARM)                               0275
         BE    @RF00275                                            0275
*       DO;                         /*                       @ZA20975*/
*         IF ECBLISTB='1'B THEN     /* ALREADY A STACK?      @ZA20975*/
         TM    ECBLISTB(ECBPARM),B'10000000'                       0277
         BNO   @RF00277                                            0277
*           DO;                     /* FIND END OF STACK     @ZA20975*/
*             DO I=ONE TO LENGTH(OUXB)/FOUR WHILE ECBLIST(I)^=ZERO;/*
*                                      STACK IS SIZE OF OUXB @ZA20975*/
         LA    I,1                                                 0279
@DL00279 LR    @10,I                                               0279
         SLA   @10,2                                               0279
         L     @07,SWAPECB(,ECBPARM)                               0279
         AL    @07,@CF02685                                        0279
         L     @10,ECBLIST(@10,@07)                                0279
         LTR   @10,@10                                             0279
         BZ    @DC00279                                            0279
*             END;                  /* FIND AN UNUSED ENTRY  @ZA20975*/
         AL    I,@CF00078                                          0280
         C     I,@CF02432                                          0280
         BNH   @DL00279                                            0280
@DC00279 DS    0H                                                  0281
*             IF I<=LENGTH(OUXB)/FOUR THEN/* ROOM FOR 1 MORE?      0281
*                                                            @ZA20975*/
         C     I,@CF02432                                          0281
         BH    @RF00281                                            0281
*               ECBLIST(I)=RRPAINP; /* STORE IT              @ZA20975*/
         LR    @10,I                                               0282
         SLA   @10,2                                               0282
         L     @07,SWAPECB(,ECBPARM)                               0282
         L     @06,RRPAINP(,RRPAPTR)                               0282
         AL    @07,@CF02685                                        0282
         ST    @06,ECBLIST(@10,@07)                                0282
*             ELSE                  /* NO MORE ROOM...       @ZA20975*/
*               DO;                 /* SHOULD NEVER HAPPEN,  @ZA20975*/
         B     @RC00281                                            0283
@RF00281 DS    0H                                                  0284
*                 RESNCODE=CON28;   /* BUT JUST IN CASE,     @ZA20975*/
*                                                                  0284
         LA    RESNCODE,28                                         0284
*                 /***************************************************/
*                 /*                                                 */
*                 /* ? IRACTLCL EPN(I10)                             */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0285
*                 CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT        */
         L     @15,RMSBI10(,RMCTPTR)                               0285
         BALR  @14,@15                                             0285
*               END;                /* ABEND 15F RC=28       @ZA20975*/
*           END;                    /* END STACK CASE        @ZA20975*/
*         ELSE                      /* NO-STACK CASE         @ZA20975*/
*           DO;                     /* NEED TO CREATE STACK  @ZA20975*/
         B     @RC00277                                            0288
@RF00277 DS    0H                                                  0289
*             R0=LENGTH(OUXB);      /* GET SOME STORAGE --   @ZA20975*/
         LA    R0,144                                              0289
*             R1=ZERO;              /* SIZE OF OUXB WILL DO  @ZA20975*/
*                                                                  0290
         SLR   R1,R1                                               0290
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(I04)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0291
*             CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN            */
*                                                                  0291
         L     @15,RMSBI04(,RMCTPTR)                               0291
         BALR  @14,@15                                             0291
*             /*******************************************************/
*             /*                                                     */
*             /* INVOKE GETCELL ROUTINE                      @ZA20975*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0292
*             NEWCELL(ONE:LENGTH(OUXB))=''B;/* CLEAR NEW CELL      0292
*                                                            @ZA20975*/
         XC    NEWCELL(144,R1),NEWCELL(R1)                         0292
*             RFY                                                  0293
*               ECBLIST BASED(R1);  /* USE NEW CELL          @ZA20975*/
*             ECBLIST(ONE)=SWAPECB; /* ORIGINAL ECB          @ZA20975*/
         L     @10,SWAPECB(,ECBPARM)                               0294
         ST    @10,ECBLIST(,R1)                                    0294
*             ECBLIST(TWO)=RRPAINP; /* THIS ONE              @ZA20975*/
         L     @10,RRPAINP(,RRPAPTR)                               0295
         ST    @10,ECBLIST+4(,R1)                                  0295
*             SWAPECB=R1;           /* PUT CELL ADDR IN OUXB @ZA20975*/
         ST    R1,SWAPECB(,ECBPARM)                                0296
*             ECBLISTB='1'B;        /* INDICATE STACK EXISTS @ZA20975*/
         OI    ECBLISTB(ECBPARM),B'10000000'                       0297
*             RFY                                                  0298
*               ECBLIST BASED(SWAPECB);/* NORMAL BASING      @ZA20975*/
*           END;                    /* END NO-STACK CASE     @ZA20975*/
*       END;                        /* END PREVIOUS ECB CASE @ZA20975*/
*     ELSE                          /* NO PREVIOUS ECB CASE  @ZA20975*/
*       SWAPECB=RRPAINP;            /* OK TO STORE THIS ECB  @ZA20975*/
         B     @RC00275                                            0301
@RF00275 L     @10,RRPAINP(,RRPAPTR)                               0301
         ST    @10,SWAPECB(,ECBPARM)                               0301
*   RFY                                                            0302
*     I UNRSTD;                     /* FREE UP WORK REGISTER @ZA20975*/
@RC00275 DS    0H                                                  0302
@RF00274 DS    0H                                                  0303
*   GEN CODE NOEXIT SEQFLOW;                                       0303
*                                  /* RESTORE REGS FROM SA3 @ZA20975*/
   LM   @00,@14,128+000(@13)
*   END EVTSTACK;                   /* DONE                  @ZA20975*/
@EL00004 DS    0H                                                  0304
@EF00004 DS    0H                                                  0304
@ER00004 BR    @14                                                 0304
*                                                                  0305
*/***********************************************************@ZA20975*/
*/*                                                          @ZA20975*/
*/* EVTENDSW - IRARMEVT END-REQSWAP-OR-TRANSWAP SUBROUTINE   @ZA20975*/
*/*                                                          @ZA20975*/
*/* CALLERS  - SYSEVENT QSCEST                               @ZA20975*/
*/*            SYSEVENT QSCECMP                              @ZA20975*/
*/*            SYSEVENT SWOUTCMP (VIA UXB ROUTINE)           @ZA20975*/
*/*                                                          @ZA20975*/
*/* FUNCTION - TURN OFF SWAP PENDING BITS, POST REQSWAP OR   @ZA20975*/
*/*            TRANSWAP ISSUER IF NECESSARY, CLEAR ECB ADDR  @ZA20975*/
*/*                                                          @ZA20975*/
*/* INPUT    - OUCBRSWP, OUXBRSW, OUCBTSWP, OUXBTSW          @ZA20975*/
*/*            REG 0: POST CODE (SET BY CALLER OF EVTENDSW,  @ZA20975*/
*/*                   USED BY I06 ROUTINE WHICH IS INVOKED   @ZA20975*/
*/*                   BY EVTPOST)                            @ZA20975*/
*/*            REG 4: ADDRESS OF OUCB                        @ZA20975*/
*/*            REG 6: ADDRESS OF OUXB                        @ZA20975*/
*/*                                                          @ZA20975*/
*/***********************************************************@ZA20975*/
*                                                                  0305
*EVTENDSW:                                                         0305
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/
EVTENDSW DS    0H                                                  0306
*/* USE GLOBAL SAVEAREA 3                                    @ZA20975*/
*                                                                  0306
*   GEN CODE REFS(RMCTRMSA) NOEXIT SEQFLOW;                        0306
*                                                       /*  @ZA20975*/
   L    @15,RMCTRMSA(,RMCTPTR)
   STM  @00,@14,128+000(@15)
   LR   @13,@15
*   RFY                                                            0307
*     OUXBPTR RSTD;                 /*                       @ZA20975*/
*   IF OUCBRSWP='1'B THEN           /* REQSWAP PENDING?      @ZA20975*/
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       0308
         BNO   @RF00308                                            0308
*     DO;                           /* END IT...             @ZA20975*/
*       IF OUXBRSW^=ZERO THEN       /* ECB(S) TO BE POSTED?  @ZA20975*/
         L     @12,OUXBRSW(,OUXBPTR)                               0310
         LTR   @12,@12                                             0310
         BZ    @RF00310                                            0310
*         DO;                       /* YES,                  @ZA20975*/
*           R1=ADDR(OUXBRSW);       /* PASS ADDRESS          @ZA20975*/
         LA    R1,OUXBRSW(,OUXBPTR)                                0312
*           CALL EVTPOST;           /* INVOKE POST SUBROUTINE      0313
*                                                            @ZA20975*/
         BAL   @14,EVTPOST                                         0313
*         END;                      /* END REQSWAP POST      @ZA20975*/
*       OUCBRSWP='0'B;              /* RESET PENDING BIT     @ZA20975*/
@RF00310 NI    OUCBRSWP(OUCBPTR),B'11011111'                       0315
*     END;                          /* END REQSWAP CASE      @ZA20975*/
*   IF OUCBTSWP='1'B THEN           /* TRANSWAP PENDING?     @ZA20975*/
@RF00308 TM    OUCBTSWP(OUCBPTR),B'00010000'                       0317
         BNO   @RF00317                                            0317
*     DO;                           /* END IT...             @ZA20975*/
*       IF OUXBTSW^=ZERO THEN       /* ECB(S) TO BE POSTED?  @ZA20975*/
         L     @12,OUXBTSW(,OUXBPTR)                               0319
         LTR   @12,@12                                             0319
         BZ    @RF00319                                            0319
*         DO;                       /* YES,                  @ZA20975*/
*           R1=ADDR(OUXBTSW);       /* PASS ADDRESS          @ZA20975*/
         LA    R1,OUXBTSW(,OUXBPTR)                                0321
*           CALL EVTPOST;           /* INVOKE POST SUBROUTINE      0322
*                                                            @ZA20975*/
         BAL   @14,EVTPOST                                         0322
*         END;                      /* END TRANSWAP POST     @ZA20975*/
*       OUCBTSWP='0'B;              /* RESET PENDING BIT     @ZA20975*/
@RF00319 NI    OUCBTSWP(OUCBPTR),B'11101111'                       0324
*       OUCBNTSP=ZERO;              /* RESET PENDING COUNT   @ZA20975*/
         SLR   @12,@12                                             0325
         STH   @12,OUCBNTSP(,OUCBPTR)                              0325
*     END;                          /* END TRANSWAP CASE     @ZA20975*/
*   RFY                                                            0327
*     OUXBPTR UNRSTD;               /*                       @ZA20975*/
@RF00317 DS    0H                                                  0328
*   GEN CODE NOEXIT SEQFLOW;                                       0328
*                                  /* RESTORE REGS FROM SA3 @ZA20975*/
   LM   @00,@14,128+000(@13)
*   END EVTENDSW;                   /* DONE                  @ZA20975*/
@EL00005 DS    0H                                                  0329
@EF00005 DS    0H                                                  0329
@ER00005 BR    @14                                                 0329
*                                                                  0330
*/***********************************************************@ZA20975*/
*/*                                                          @ZA20975*/
*/* EVTPOST  - IRARMEVT POST SUBROUTINE FOR REQSWAP AND      @ZA20975*/
*/*            TRANSWAP                                      @ZA20975*/
*/*                                                          @ZA20975*/
*/* CALLER   - EVTENDSW SUBROUTINE                           @ZA20975*/
*/*                                                          @ZA20975*/
*/* FUNCTION - POST AN ECB OR A STACK OF ECBS FOR THE        @ZA20975*/
*/*            ISSUER(S) OF SYSEVENT REQSWAP OR TRANSWAP,    @ZA20975*/
*/*            CLEAR THE OUXB FIELD THAT WAS PASSED IN.      @ZA20975*/
*/*                                                          @ZA20975*/
*/* INPUT    - R0= POST CODE (SET BY CALLER OF EVTENDSW,     @ZA20975*/
*/*                USED BY I06 ROUTINE)                      @ZA20975*/
*/*            R1= FOR TRANSWAP, ADDRESS OF OUXBTSW          @ZA20975*/
*/*                FOR REQSWAP, ADDRESS OF OUXBRSW           @ZA20975*/
*/*                (IF HIGH ORDER BIT OF OUXB FIELD IS ON,   @ZA20975*/
*/*                 IT POINTS TO A STACK. OTHERWISE, IT      @ZA20975*/
*/*                 POINTS TO A SINGLE ECB.)                 @ZA20975*/
*/*                                                          @ZA20975*/
*/***********************************************************@ZA20975*/
*                                                                  0330
*EVTPOST:                                                          0330
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA20975*/
EVTPOST  DS    0H                                                  0331
*   RFY                                                            0331
*    (OUXBPTR,                                                     0331
*     WRKREG2,                                                     0331
*     I) RSTD;                      /*                       @ZA20975*/
*   RFY                                                            0332
*    (NTRREG,                                                      0332
*     RETNCODE) UNRSTD;             /*                       @ZA20975*/
*   WRKREG2=RTNREG;                 /* SAVE RETURN ADDRESS   @ZA20975*/
         LR    WRKREG2,RTNREG                                      0333
*   ECBPARM=R1;                     /* STORE INPUT VALUE     @ZA20975*/
         LR    ECBPARM,R1                                          0334
*   IF ECBLISTB='1'B THEN           /* THERE'S A STACK       @ZA20975*/
         TM    ECBLISTB(ECBPARM),B'10000000'                       0335
         BNO   @RF00335                                            0335
*     DO;                           /* POST THEM ALL         @ZA20975*/
*       DO I=ONE TO LENGTH(OUXB)/FOUR WHILE ECBLIST(I)^=ZERO;/* STACK
*                                      IS SIZE OF OUXB       @ZA20975*/
         LA    I,1                                                 0337
@DL00337 LR    @15,I                                               0337
         SLA   @15,2                                               0337
         L     @07,SWAPECB(,ECBPARM)                               0337
         AL    @07,@CF02685                                        0337
         L     @15,ECBLIST(@15,@07)                                0337
         LTR   @15,@15                                             0337
         BZ    @DC00337                                            0337
*         R1=ECBLIST(I);            /* PASS ECB ADDRESS      @ZA20975*/
*                                                                  0338
         LR    R1,@15                                              0338
*         /***********************************************************/
*         /*                                                         */
*         /* ? IRACTLCL EPN(I06)                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0339
*         CALL RMSBI06->IRARMRTN;   /* INVOKE I06 SUBRTN             */
*                                                                  0339
         L     @15,RMSBI06(,RMCTPTR)                               0339
         BALR  @14,@15                                             0339
*         /***********************************************************/
*         /*                                                         */
*         /* TO POST ROUTINE                                 @ZA20975*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0340
*       END;                        /* DONE WITH STACK       @ZA20975*/
         AL    I,@CF00078                                          0340
         C     I,@CF02432                                          0340
         BNH   @DL00337                                            0340
@DC00337 DS    0H                                                  0341
*       RFY                                                        0341
*         PCSAVE RSTD;              /* HOLD WORK REGISTER    @ZA20975*/
*       PCSAVE=R0;                  /* SAVE POST CODE IN CASE      0342
*                                      EVTENDSW MUST DO MORE POSTING
*                                                            @ZA20975*/
         LR    PCSAVE,R0                                           0342
*       R0=LENGTH(OUXB);            /* NOW FREE UP STACK     @ZA20975*/
         LA    R0,144                                              0343
*       R1=SWAPECB;                 /* ADDRESS OF STACK      @ZA20975*/
*                                                                  0344
         L     R1,SWAPECB(,ECBPARM)                                0344
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I04)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0345
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */
*                                                                  0345
         L     @15,RMSBI04(,RMCTPTR)                               0345
         BALR  @14,@15                                             0345
*       /*************************************************************/
*       /*                                                           */
*       /* FREECELL SUBROUTINE                               @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0346
*       R0=PCSAVE;                  /* RESTORE POST CODE     @ZA20975*/
         LR    R0,PCSAVE                                           0346
*       RFY                                                        0347
*         PCSAVE UNRSTD;            /* FREE UP REGISTER      @ZA20975*/
*     END;                          /* END ECB-STACK CASE    @ZA20975*/
*   ELSE                            /* ONLY ONE ECB          @ZA20975*/
*     DO;                           /* SO,                   @ZA20975*/
         B     @RC00335                                            0349
@RF00335 DS    0H                                                  0350
*       R1=SWAPECB;                 /* PASS ECB ADDRESS      @ZA20975*/
*                                                                  0350
         L     R1,SWAPECB(,ECBPARM)                                0350
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I06)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0351
*       CALL RMSBI06->IRARMRTN;     /* INVOKE I06 SUBRTN             */
*                                                                  0351
         L     @15,RMSBI06(,RMCTPTR)                               0351
         BALR  @14,@15                                             0351
*       /*************************************************************/
*       /*                                                           */
*       /* POST IT                                           @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0352
*     END;                          /* END SINGLE ECB CASE   @ZA20975*/
*   ECBFIELD=ZERO;                  /* CLEAR OUXB FIELD      @ZA20975*/
@RC00335 SLR   @15,@15                                             0353
         ST    @15,ECBFIELD(,ECBPARM)                              0353
*   RTNREG=WRKREG2;                 /* RESTORE RETURN ADDR   @ZA20975*/
         LR    RTNREG,WRKREG2                                      0354
*   RFY                                                            0355
*    (OUXBPTR,                                                     0355
*     WRKREG2,                                                     0355
*     I) UNRSTD;                    /*                       @ZA20975*/
*   RFY                                                            0356
*    (NTRREG,                                                      0356
*     RETNCODE) RSTD;               /*                       @ZA20975*/
*   END EVTPOST;                    /* DONE                  @ZA20975*/
@EL00006 DS    0H                                                  0357
@EF00006 DS    0H                                                  0357
@ER00006 BR    @14                                                 0357
*                                                                  0358
*/* + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +*/
*/* × EVTCSOD:      SWAP OUT DRIVER FOR BOTH INITDET AND OKSWAP     ×*/
*/* ×               SYSEVENTS.                                      ×*/
*/* ×                                                               ×*/
*/* × FUNCTION:     CALL IRARMCRY TO INITIATE SWAPOUT OF THE        ×*/
*/* ×               CURRENT ADDRESS SPACE.                          ×*/
*/* ×                                                               ×*/
*/* × CALLERS:      SYSEVENT - OKSWAP                               ×*/
*/* ×               SYSEVENT - INITDET                              ×*/
*/* ×                                                               ×*/
*/* × INPUT:        REG 3 - RRPA ADDRESS                            ×*/
*/* ×               REG 4 - OUCB ADDRESS                            ×*/
*/* + - - - - - - - - - - - - - - - - - - - - - - - - - - - -@ZA31733*/
*                                                                  0358
*EVTCSOD:                                                          0358
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);/*                       @ZA31733*/
EVTCSOD  DS    0H                                                  0359
*   RFY                                                            0359
*    (WRKREG2,                                                     0359
*     OUXBPTR) RSTD;                /* RETURN ADDR SAVEAREA  @ZA31733*/
*   WRKREG2=RTNREG;                 /* SAVE RETURN ADDR      @ZA31733*/
*                                                                  0360
         LR    WRKREG2,RTNREG                                      0360
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL CSO TO INITIATE ADDRESS SPACE SWAP OUT           @ZA31733*/
*   /* ? IRACTLCL EPN(CSO)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0361
*   DO;                                                            0361
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0362
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0363
         BALR  @14,@15                                             0363
*   END;                                                           0364
*   IF RETNCODE=ZERO                /* SWAP STARTED?         @ZA31733*/
*     THEN                          /* YES. BEGIN SWAP STARTED CASE  */
         LTR   RETNCODE,RETNCODE                                   0365
         BNZ   @RF00365                                            0365
*     DO;                           /*                       @ZA31733*/
*       OUCBLWT='0'B;               /* RESET LONGWAIT STATUS @ZA31733*/
*       OUCBMWT='0'B;               /* RESET MSO DETECTED WAIT STATUS
*                                                            @ZA31733*/
*       OUCBTRM='0'B;               /* RESET TERMINAL WAIT STATUS  0369
*                                                            @ZA31733*/
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0369
*       OUCBSRC=SRCDRQSC;           /* SWAP REASON IS REQSWAP      0370
*                                                            @ZA31733*/
         MVI   OUCBSRC(OUCBPTR),X'07'                              0370
*     END;                          /* END SWAP STARTED CASE @ZA31733*/
*   IF RRPASVC='1'B                 /* Q. SVC ENTRY TO SRM?  @ZA31733*/
*     THEN                                                         0372
@RF00365 TM    RRPASVC(RRPAPTR),B'00100000'                        0372
         BNO   @RF00372                                            0372
*     RRPARTN=CVTEXP1;              /* YES. FORCE RETURN THROUGH   0373
*                                      DISPATCHER            @ZA31733*/
         L     @12,CVTPTR                                          0373
         L     @12,CVTEXP1(,@12)                                   0373
         ST    @12,RRPARTN(,RRPAPTR)                               0373
*   RTNREG=WRKREG2;                 /* RESTORE RETURN ADDR   @ZA31733*/
@RF00372 LR    RTNREG,WRKREG2                                      0374
*   RFY                                                            0375
*    (WRKREG2,                                                     0375
*     OUXBPTR) UNRSTD;              /* FREE WORK REGISTERS   @ZA31733*/
*   END EVTCSOD;                    /* END EVTCSOD SUBRT     @ZA31733*/
@EL00007 DS    0H                                                  0376
@EF00007 DS    0H                                                  0376
@ER00007 BR    @14                                                 0376
*IRARME01:                          /* SYSEVENT 1 - TIMEREXP         */
*   IF RRPATODO=OKCLOCK THEN        /* TOD CLOCK HAS BEEN INITIALIZED*/
IRARME01 CLI   RRPATODO(RRPAPTR),X'01'                             0377
         BNE   @RF00377                                            0377
*     DO;                           /*                       @ZA31158*/
*                                                                  0378
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(WMY)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0379
*       CALL RMSBWMY->IRARMRTN;     /* INVOKE WMY SUBRTN             */
*                                                                  0379
         L     @15,RMSBWMY(,RMCTPTR)                               0379
         BALR  @14,@15                                             0379
*       /*************************************************************/
*       /*                                                           */
*       /* INIT SRM TIMED ENTRY QUEUES                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0380
*       CVTRV609=ADDR(IRARMEPS);    /* FILL IN ADDRESS OF SYSEVENT 0380
*                                      ENTRY POINT TABLE     @ZA31158*/
         L     @12,@CV02508                                        0380
         L     @11,CVTPTR                                          0380
         ST    @12,CVTRV609(,@11)                                  0380
*     END;                          /* END OKCLOCK CASE      @ZA31158*/
*/*                                                                  */
*/*   PROHIBIT ENTRY TO SRM CONTROL ROUTINE FROM THIS SYSEVENT       */
*/*   UNTIL THE SRM TIMED ENTRY QUEUES HAVE BEEN INITIALIZED.        */
*/*                                                                  */
*                                                                  0382
*   IF RMCTTBS=ZERO THEN            /* TOD CLOCK NOT INITIALIZED     */
*                                                                  0382
@RF00377 L     @12,RMCTTBS(,RMCTPTR)                               0382
         LTR   @12,@12                                             0382
         BNZ   @RF00382                                            0382
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(I01)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0383
*     GOTO RMEXI01->IRARMNTR;       /* EXIT TO I01 FUNCT             */
*                                                                  0383
         L     @12,RMEXI01(,RMCTPTR)                               0383
         BR    @12                                                 0383
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INVOKER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0384
*   ELSE                            /* TOD CLOCK HAS BEEN INITIALIZED*/
*                                                                  0384
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(CET)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0384
*     GOTO RMEXCET->IRARMNTR;       /* EXIT TO CET FUNCT             */
*                                                                  0384
@RF00382 L     @12,RMEXCET(,RMCTPTR)                               0384
         BR    @12                                                 0384
*   /*****************************************************************/
*   /*                                                               */
*   /* SRM TIMER EXPIRED ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0385
*IRARME02:                          /* SYSEVENT 2 - TERMWAIT         */
*   OUCBTRM='1'B;                   /* MEMORY ENTERED TERMINAL WAIT  */
IRARME02 OI    OUCBTRM(OUCBPTR),B'01000000'                        0385
*   IF RRPAWTYP=OUTWAIT THEN        /* IF MEM IN OUTPUT TERMINAL WAIT*/
         CLI   RRPAWTYP(RRPAPTR),X'80'                             0386
         BNE   @RF00386                                            0386
*     OUCBOWT='1'B;                 /* INDICATE MEMORY IN OUTPUT WAIT*/
         OI    OUCBOWT(OUCBPTR),B'00100000'                        0387
*   ELSE                            /* INDICATE MEMORY NOT   @ZA30458*/
*     OUCBOWT='0'B;                 /* IN OUTPUT WAIT        @ZA30458*/
*                                                                  0388
         B     @RC00386                                            0388
@RF00386 NI    OUCBOWT(OUCBPTR),B'11011111'                        0388
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CSO)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0389
*   DO;                                                            0389
@RC00386 DS    0H                                                  0390
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0390
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0391
         BALR  @14,@15                                             0391
*   END;                            /* SWAP-OUT THIS MEMORY          */
*   IF RTNCOD=ZERO THEN             /* SWAP-OUT REQUEST SUCCESSFUL   */
         LTR   RTNCOD,RTNCOD                                       0393
         BNZ   @RF00393                                            0393
*     DO;                                                          0394
*       OUCBLWT='1'B;               /* MEMORY MAY BE IN LONG WAIT    */
         OI    OUCBLWT(OUCBPTR),B'10000000'                        0395
*       IF OUCBOWT='1'B             /* SWAP DUE TO OUTPUT    @Z40BPEB*/
*         THEN                                                     0396
         TM    OUCBOWT(OUCBPTR),B'00100000'                        0396
         BNO   @RF00396                                            0396
*         OUCBSRC=SRCDTOSC;         /* TERM OUTPUT WT CODE   @Z40BPEB*/
         MVI   OUCBSRC(OUCBPTR),X'01'                              0397
*       ELSE                                                       0398
*         OUCBSRC=SRCDTISC;         /* INPUT TERM WAIT CODE  @Z40BPEB*/
         B     @RC00396                                            0398
@RF00396 MVI   OUCBSRC(OUCBPTR),X'02'                              0398
*     END;                          /* SWAPOUT WAS SUCCESSFUL      0399
*                                                            @Z40BPEB*/
*                                                                  0399
@RC00396 DS    0H                                                  0400
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0400
@RF00393 L     @12,RMEXCTL(,RMCTPTR)                               0400
         BR    @12                                                 0400
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*IRARME03:                          /* SYSEVENT 3 - NIOWAIT  @Z30WIMG*/
*                                                                  0401
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CSO)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0401
*   DO;                                                            0401
IRARME03 DS    0H                                                  0402
*     R1=ADDR(RMEPBCSO);            /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0402
*     CALL RMSBCRY->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0403
         BALR  @14,@15                                             0403
*   END;                            /* TRY SWAP THIS MEMORY  @Z40BPEB*/
*   IF RTNCOD=ZERO THEN             /* SWAP OUT REQUEST OK   @Z40BPEB*/
         LTR   RTNCOD,RTNCOD                                       0405
         BNZ   @RF00405                                            0405
*     DO;                           /*                       @Z40BPEB*/
*       OUCBLWT='1'B;               /* MEMRY IN LONG WAIT    @Z40BPEB*/
         OI    OUCBLWT(OUCBPTR),B'10000000'                        0407
*       OUCBSRC=SRCDLWSC;           /* LONG WAIT SWAP REASON @Z40BPEB*/
         MVI   OUCBSRC(OUCBPTR),X'03'                              0408
*     END;                          /*                       @Z40BPEB*/
*                                                                  0409
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0410
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0410
@RF00405 L     @12,RMEXCTL(,RMCTPTR)                               0410
         BR    @12                                                 0410
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL RTN                                 @Z40BPEB*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0411
*IRARME04:                          /* SYSEVENT 4 - USERRDY          */
*   OUCBRDYB='1'B;                  /* USER READY SYSEVENT RECEIVED  */
IRARME04 L     @12,OUCBRDYB-2(,OUCBPTR)                            0411
@GL00006 LR    @11,@12                                             0411
         O     @11,@CF02688                                        0411
         CS    @12,@11,OUCBRDYB-2(OUCBPTR)                         0411
         BNE   @GL00006                                            0411
*   ASCBOUTB='0'B;                  /* PREVENT FURTHER USER READY  0412
*                                      SYSEVENTS FROM BEING RECEIVED */
*   ASCBTLWT='0'B;                  /* PREVENT MEMORY FROM BEING   0413
*                                      TERMINATED FOR EXCEEDING WAIT
*                                      TIME LIMIT                    */
         L     @12,ASCBTLWT-2(,ASCBPTR)                            0413
@GL00007 LR    @11,@12                                             0413
         N     @11,@CF02691                                        0413
         CS    @12,@11,ASCBTLWT-2(ASCBPTR)                         0413
         BNE   @GL00007                                            0413
*/*  TEST IF THE SYSEVENT CAN BE IGNORED BECAUSE THE USER    @Z40BPEB*/
*/*  WILL BE DETECTED BY ANOTHER ROUTINE.                    @Z40BPEB*/
*                                                                  0414
*   IF OUCBOUT='1'B&OUCBAXS='0'B&OUCBFXS='0'B&/* NOT A HEAVY FIXER 0414
*                                                            @Z40BPEB*/
*       OUCBJSAS='0'B&OUCBJSFS='0'B&/* NOT A JOBSELECT SWAP  @ZM43072*/
*       OUCBGOO='0'B&OUCBGOI='0'B THEN/* DONT IGNORE.        @Z40BPJE*/
*                                                                  0414
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0414
         BNO   @RF00414                                            0414
         TM    OUCBAXS(OUCBPTR),B'00000101'                        0414
         BNZ   @RF00414                                            0414
         TM    OUCBJSAS(OUCBPTR),B'11000000'                       0414
         BNZ   @RF00414                                            0414
         TM    OUCBGOO(OUCBPTR),B'11000000'                        0414
         BNZ   @RF00414                                            0414
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(HIT)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0415
*     DO;                                                          0415
*       R1=ADDR(RMEPBHIT);          /* HIT REQUEST IS PARAM          */
         LA    R1,RMEPBHIT(,RMCTPTR)                               0416
*       CALL RMSBCRN->IRARMRTN;     /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0417
         BALR  @14,@15                                             0417
*     END;                          /*                       @Z40BPJE*/
*                                                                  0418
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0419
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  0419
@RF00414 L     @12,RMEXI01(,RMCTPTR)                               0419
         BR    @12                                                 0419
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INVOKER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0420
*IRARME06:                          /* SYSEVENT 6 - MEMCREAT         */
*/*                                                                  */
*/*   VERIFY THE INPUT CODE IDENTIFYING THE COMMAND FROM WHICH THE   */
*/*   MEMORY IS BEING CREATED.  VALID CODES ARE:                     */
*/*                                                                  */
*/*         1 - START COMMAND                                        */
*/*         2 - LOGON COMMAND                                        */
*/*         3 - MOUNT COMMAND                                        */
*/*                                                                  */
*                                                                  0420
*   IF RRPAMEMO>ZERO&               /* IF INPUT IDENTIFYING          */
*       RRPAMEMO<FOUR THEN          /* THE COMMAND IS VALID,         */
IRARME06 CLI   RRPAMEMO(RRPAPTR),0                                 0420
         BNH   @RF00420                                            0420
         CLI   RRPAMEMO(RRPAPTR),4                                 0420
         BNL   @RF00420                                            0420
*     DO;                           /* CONTINUE SRM MEMORY CREATE    */
*                                                                  0421
*       /*************************************************************/
*       /*                                                           */
*       /* IF ANY RESOURCE SHORTAGES EXIST, PROHIBIT THE CREATION OF */
*       /* THE MEMORY.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0422
*       IF MCTSQA1='1'B×            /* SQA SHORTAGE FIRST LEVEL FLAG */
*           MCTFAVQ='1'B×           /* EXCESS OF FIXED PGS   @Z40BPEB*/
*           MCTASM1='1'B THEN       /* AUX SHORTAGE FIRST LEVEL FLAG */
         TM    MCTSQA1(RMCTPTR),B'10010000'                        0422
         BNZ   @RT00422                                            0422
         TM    MCTASM1(RMCTPTR),B'10000000'                        0422
         BNO   @RF00422                                            0422
@RT00422 DS    0H                                                  0423
*         RRPARI0=NOGO;             /* PROHIBIT CREATION OF MEMORY   */
         MVI   RRPARI0(RRPAPTR),X'80'                              0423
*       ELSE                        /* NO RESOURCE SHORTAGE EXISTS   */
*         DO;                                                      0424
*                                                                  0424
         B     @RC00422                                            0424
@RF00422 DS    0H                                                  0425
*           /*********************************************************/
*           /*                                                       */
*           /* OBTAIN AND INITIALIZE STORAGE FOR AN OUCB.            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0425
*           R0=LENGTH(OUCB);        /* LENGTH OF STORAGE REQUIRED    */
         LA    R0,136                                              0425
*           R1=ZERO;                /* CLEAR FOR GET REQUEST         */
*                                                                  0426
         SLR   R1,R1                                               0426
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(I04)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0427
*           CALL RMSBI04->IRARMRTN; /* INVOKE I04 SUBRTN             */
*                                                                  0427
         L     @15,RMSBI04(,RMCTPTR)                               0427
         BALR  @14,@15                                             0427
*           /*********************************************************/
*           /*                                                       */
*           /* GET STORAGE FOR OUCB                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0428
*           IF RTNCOD=ZERO THEN     /* IF STORAGE OBTAINED,          */
         LTR   RTNCOD,RTNCOD                                       0428
         BNZ   @RF00428                                            0428
*             DO;                   /* INITIALIZE STORAGE            */
*               OUCBPTR=R1;         /* ADDRESSABILITY TO OUCB        */
         LR    OUCBPTR,R1                                          0430
*               ASCBOUCB=R1;        /* POINTER TO OUCB IN ASCB       */
         ST    R1,ASCBOUCB(,ASCBPTR)                               0431
*               OUCB=RMCTOUCB->     /* INITIALIZE OUCB FROM PRE-     */
*                   OUCB;           /* DEFINED COPY                  */
         L     @12,RMCTOUCB(,RMCTPTR)                              0432
         MVC   OUCB(136,OUCBPTR),OUCB(@12)                         0432
*               OUCBASCB=ASCBPTR;   /* POINTER TO ASCB IN OUCB       */
*                                                                  0433
         ST    ASCBPTR,OUCBASCB(,OUCBPTR)                          0433
*               /*****************************************************/
*               /*                                                   */
*               /* INDICATE THE COMMAND FROM WHICH THE MEMORY        */
*               /* ORIGINATED.                                       */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0434
*               IF RRPAMEMO=LOGONCOM/* IF MEMORY BEING CREATED IN    */
*                 THEN              /* RESPONSE TO A LOGON COMMAND   */
         CLI   RRPAMEMO(RRPAPTR),2                                 0434
         BNE   @RF00434                                            0434
*                 OUCBLOG='1'B;                                    0435
         OI    OUCBLOG(OUCBPTR),B'00100000'                        0435
*               ELSE                /* START OR MOUNT COMMAND        */
*                 IF RRPAMEMO=      /* IF MEMORY BEING CREATED IN    */
*                     BATCHCOM THEN /* RESPONSE TO A START COMMAND   */
         B     @RC00434                                            0436
@RF00434 CLI   RRPAMEMO(RRPAPTR),1                                 0436
         BNE   @RF00436                                            0436
*                   OUCBSTT='1'B;                                  0437
         OI    OUCBSTT(OUCBPTR),B'01000000'                        0437
*                 ELSE              /* MOUNT COMMAND                 */
*                   OUCBMNT='1'B;                                  0438
*                                                                  0438
         B     @RC00436                                            0438
@RF00436 OI    OUCBMNT(OUCBPTR),B'00010000'                        0438
*               /*****************************************************/
*               /*                                                   */
*               /* OBTAIN STORAGE FOR OUXB                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0439
*               R0=LENGTH(OUXB);    /* LENGTH OF STORAGE REQUIRED    */
@RC00436 DS    0H                                                  0439
@RC00434 LA    R0,144                                              0439
*               R1=ZERO;            /* CLEAR FOR GET REQUEST         */
*                                                                  0440
         SLR   R1,R1                                               0440
*               /*****************************************************/
*               /*                                                   */
*               /* ? IRACTLCL EPN(I04)                               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0441
*               CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN          */
         L     @15,RMSBI04(,RMCTPTR)                               0441
         BALR  @14,@15                                             0441
*               IF RTNCOD=ZERO THEN /* IF OUXB STORAGE OBTAINED,     */
         LTR   RTNCOD,RTNCOD                                       0442
         BNZ   @RF00442                                            0442
*                 DO;               /* COMPLETE SRM MEMORY CREATION  */
*                   RESPECIFY                                      0444
*                    (OUXBPTR) RSTD;/* BASE PTR TO OUXB              */
*                   OUXBPTR=R1;     /* ADDRESSABILITY TO OUXB        */
         LR    OUXBPTR,R1                                          0445
*                   ASCBOUXB=R1;    /* POINTER TO OUXB IN ASCB       */
         ST    R1,ASCBOUXB(,ASCBPTR)                               0446
*                   OUXB=''B;       /* INITIALIZE OUXB               */
         XC    OUXB(144,OUXBPTR),OUXB(OUXBPTR)                     0447
*                   OUXBNAME='OUXB';/* ACRONYM IN EBCDIC             */
*                                                                  0448
         MVC   OUXBNAME(4,OUXBPTR),@CC02562                        0448
*                   /*************************************************/
*                   /*                                               */
*                   /* REQUEST THAT THE MEMORY BE PLACED ON THE      */
*                   /* IN-CORE OUCB CHAIN. THE REQUEST IS PERFORMED  */
*                   /* INDIRECTLY THROUGH THE USER ACTION REQUEST    */
*                   /* ROUTINE TO INSURE SYSTEM RESOURCE MANAGER     */
*                   /* CONTROL BLOCK INTEGRITY. THE ENTRY POINT BLOCK*/
*                   /* DESCRIBING THE MEMORY ENQUEUE ROUTINE IS      */
*                   /* PASSED TO THE USER ACTION ROUTINE AS INPUT.   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0449
*                   OUCBINV='0'B;   /* OUCB VALID            @Z40BPCH*/
*                                                                  0449
         NI    OUCBINV(OUCBPTR),B'11101111'                        0449
*                   /*************************************************/
*                   /*                                               */
*                   /* ? IRACTLCL EPN(RPS)                           */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0450
*                   DO;                                            0450
*                     R1=ADDR(RMEPBRPS);/* RPS REQUEST IS PARAM      */
         LA    R1,RMEPBRPS(,RMCTPTR)                               0451
*                     CALL RMSBCRN->IRARMRTN;/* ACTION INVK FUNCT    */
         L     @15,RMSBCRN(,RMCTPTR)                               0452
         BALR  @14,@15                                             0452
*                   END;            /* MEMORY ENQUEUE ACTION ROUT    */
*                   RMCAINUS=RMCAINUS/* INCREMENT NUMBER OF MEMORIES */
*                       +ONE;       /* IN STORAGE                    */
         LA    @12,1                                               0454
         AH    @12,RMCAINUS(,RMCTPTR)                              0454
         STH   @12,RMCAINUS(,RMCTPTR)                              0454
*                   RRPARI0=OK;     /* MEMORY CAN BE CREATED         */
         MVI   RRPARI0(RRPAPTR),X'00'                              0455
*                 END;                                             0456
*               ELSE                /* OUXB STORAGE NOT OBTAINED     */
*                 DO;               /* FREE OUCB STORAGE             */
         B     @RC00442                                            0457
@RF00442 DS    0H                                                  0458
*                   R0=LENGTH(OUCB);/* LENGTH OF STORAGE TO FREE     */
         LA    R0,136                                              0458
*                   R1=OUCBPTR;     /* ADDRESS OF STORAGE TO FREE    */
         LR    R1,OUCBPTR                                          0459
*                   ASCBOUCB=ZERO;  /* RESET POINTER TO OUCB         */
*                                                                  0460
         SLR   @12,@12                                             0460
         ST    @12,ASCBOUCB(,ASCBPTR)                              0460
*                   /*************************************************/
*                   /*                                               */
*                   /* ? IRACTLCL EPN(I04)                           */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0461
*                   CALL RMSBI04->IRARMRTN;/* INVOKE I04 SUBRTN      */
         L     @15,RMSBI04(,RMCTPTR)                               0461
         BALR  @14,@15                                             0461
*                   RRPARI0=NOGO;   /* PROHIBIT CREATION OF MEMORY   */
         MVI   RRPARI0(RRPAPTR),X'80'                              0462
*                 END;                                             0463
*             END;                                                 0464
*           ELSE                    /* OUCB STORAGE NOT OBTAINED     */
*             RRPARI0=NOGO;         /* PROHIBIT CREATION OF MEMORY   */
         B     @RC00428                                            0465
@RF00428 MVI   RRPARI0(RRPAPTR),X'80'                              0465
*         END;                                                     0466
*     END;                                                         0467
*   ELSE                            /* INVALID INPUT CODE,           */
*     DO;                           /* TERMINATE INVOKER             */
         B     @RC00420                                            0468
@RF00420 DS    0H                                                  0469
*       RESNCODE=CON4;              /* ABEND REASON CODE             */
*                                                                  0469
         LA    RESNCODE,4                                          0469
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I10)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0470
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */
         L     @15,RMSBI10(,RMCTPTR)                               0470
         BALR  @14,@15                                             0470
*     END;                          /*                               */
*                                                                  0471
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0472
@RC00420 L     @12,RMEXCTL(,RMCTPTR)                               0472
         BR    @12                                                 0472
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0473
*   RESPECIFY                                                      0473
*    (OUXBPTR) UNRSTD;                                             0473
*IRARME07:                          /* SYSEVENT 7 - MEMDEL           */
*/*                                                                  */
*/*   RELEASE THE STORAGE FOR THE OUCB AND OUXB THAT WAS OBTAINED    */
*/*   DURING THE MEMORY CREATE SYSEVENT.  THE REQUEST IS PERFORMED   */
*/*   INDIRECTLY THROUGH THE USER ACTION REQUEST ROUTINE(IRARMCRN).  */
*/*   THE ENTRY POINT BLOCK DESCRIBING THE ACTION TO BE PERFORMED IS */
*/*   PASSED TO IRARMCRN.  IRARMCRN WILL SYSNCHRONIZE THE DELETION   */
*/*   OF THE SRM CONTROL BLOCKS AND THE ASCB WITH ALL ASYNCHRONOUS   */
*/*   SRM PROCESSING THAT COULD REFERENCE THESE BLOCKS.              */
*/*                                                                  */
*/*   A SPECIAL SYSEVENT MEMDEL (TYPE=NOSWIN) IS ISSUED OUT OF THE   */
*/*   RSM MODULE IEAVTERM.  THIS SYSEVENT PREVENTS ANY FURTHER       */
*/*   SWAP INS FROM BEING ATTEMPTED UNTIL THE NORMAL SYSEVENT MEMDEL */
*/*   WHEN THE OUCB IS REMOVED FROM THE QUEUES AND FREED.    @ZA29015*/
*/*                                                                  */
*                                                                  0474
*   IF RRPANSWI='1'B THEN           /* MEMDEL, PHASE 1?      @ZA29015*/
IRARME07 TM    RRPANSWI(RRPAPTR),B'10000000'                       0474
         BNO   @RF00474                                            0474
*     OUCBNSWI='1'B;                /* STOP SWAPINS          @ZA29015*/
         OI    OUCBNSWI(OUCBPTR),B'00001000'                       0475
*   ELSE                            /* THIS IS NORMAL MEMDEL @ZA29015*/
*     DO;                           /*                       @ZA29015*/
*                                                                  0476
         B     @RC00474                                            0476
@RF00474 DS    0H                                                  0477
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(DEL)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0477
*       DO;                                                        0477
*         R1=ADDR(RMEPBDEL);        /* DEL REQUEST IS PARAM          */
         LA    R1,RMEPBDEL(,RMCTPTR)                               0478
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0479
         BALR  @14,@15                                             0479
*       END;                                                       0480
*       RRPARI3=WAIT;               /* MEMORY DELETE PROCESSING WILL
*                                      ISSUE A WAIT THAT WILL BE   0481
*                                      XMPOSTED AS THE SRM DELETE  0481
*                                      ACTION IS PERFORMED           */
         MVI   RRPARI3(RRPAPTR),X'04'                              0481
*     END;                          /* END NORMAL MEMDEL     @ZA29015*/
*                                                                  0482
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0483
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0483
@RC00474 L     @12,RMEXCTL(,RMCTPTR)                               0483
         BR    @12                                                 0483
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0484
*IRARME08:                          /* SYSEVENT 8 - JOBSELCT         */
*   IF OUCBATR='1'B THEN            /* USER UNDER WLM CONTROL        */
*                                                                  0484
IRARME08 TM    OUCBATR(OUCBPTR),B'10000000'                        0484
         BNO   @RF00484                                            0484
*     /***************************************************************/
*     /*                                                             */
*     /* TERMINATE ONGOING SESSION TRANSACTION ACTIVITY RECORDKEEPING*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0485
*     DO;                                                          0485
*       OUCBSTR='1'B;               /* FORCE TRANSACTION END         */
*                                                                  0486
         OI    OUCBSTR(OUCBPTR),B'01000000'                        0486
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(WMO)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0487
*       CALL RMSBWMO->IRARMRTN;     /* INVOKE WMO SUBRTN             */
*                                                                  0487
         L     @15,RMSBWMO(,RMCTPTR)                               0487
         BALR  @14,@15                                             0487
*       /*************************************************************/
*       /*                                                           */
*       /* END ANY CURRENT TRANSACTION                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0488
*     END;                                                         0488
*                                                                  0488
*/*     IF THIS IS NOT THE FIRST JOB SELECT FOR THIS ASID,   @Z40BPEB*/
*/*   PICK UP THE PERFORMANCE GROUP NUMBER(PGN) UNDER        @Z40BPJE*/
*/*   WHICH THE NEW JOB WILL BEGIN TO EXECUTE.               @Z40BPJE*/
*/*     IF IT IS THE FIRST JOB SELECT, LEAVE THE OUCB        @Z40BPEB*/
*/*   MARKED AS PRIVILEDGED AND IN DOMAIN ZERO.  THIS IS     @Z40BPEB*/
*/*   TO ALLOW STC AND LOGONS SPECIAL TREATMENT.             @Z40BPEB*/
*                                                                  0489
*   IF OUCBJSR='1'B THEN            /* JOB SELECT RECEIVED   @Z40BPEB*/
@RF00484 TM    OUCBJSR(OUCBPTR),B'00001000'                        0489
         BNO   @RF00489                                            0489
*     DO;                           /* BEFORE THIS ONE?      @Z40BPEB*/
*       OUCBPVL='0'B;               /* MEMORY NO LONGER PRIVILEGED 0491
*                                                            @Z40BPJE*/
         NI    OUCBPVL(OUCBPTR),B'11111011'                        0491
*       OUCBNPG=RRPAVPGN;           /* NEW PGN INPUT WITH SYSEVENT 0492
*                                                            @Z40BPJE*/
         SLR   @12,@12                                             0492
         IC    @12,RRPAVPGN(,RRPAPTR)                              0492
         STC   @12,OUCBNPG(,OUCBPTR)                               0492
*       OUCBSPG=RRPAVPGN;           /* SAVE INPUT PGN        @Z40WPEB*/
         IC    @11,RRPAVPGN(,RRPAPTR)                              0493
         STC   @11,OUCBSPG(,OUCBPTR)                               0493
*/*                                                          @Z40BPJE*/
*/*   THE NEW PGN IS VALIDATED BY USING IT AS AN INDEX INTO  @Z40BPJE*/
*/*   THE WORKLOAD MANAGER PERFORMANCE GROUP VECTOR TABLE    @Z40BPJE*/
*/*   (WPGVT), AN ARRAY OF 2 BYTE ELEMENTS.  EACH ELEMENT    @Z40BPJE*/
*/*   REPRESENTS AN OFFSET TO ONE OF THE PERFORMANCE GROUPS  @Z40BPJE*/
*/*   THAT CAN BE DEFINED WITH-IN AN IPS. THOSE PERFORMANCE  @Z40BPJE*/
*/*   GROUPS THAT ARE INVALID HAVE A ZERO OFFSET.  IF THE    @Z40BPJE*/
*/*   INDEXED ELEMENT IS NON-ZERO, THEN THE PGN IS VALID.    @Z40BPJE*/
*/*   OTHERWISE DETERMINE THE DEFAULT PGN TO BE USED BASED   @Z40BPJE*/
*/*   ON THE COMMAND FROM WHICH THE MEMORY ORIGINATED.       @Z40BPJE*/
*                                                                  0494
*       IF(OUCBNPG>WMSTPGHI×        /* IF THE NEW PGN IS UNDEFINED 0494
*                                                            @Z40BPJE*/
*           WPGVTENT=ZERO) THEN     /* IN THE CURRENT IPS,   @Z40BPJE*/
*                                                                  0494
         L     @11,WMSTPTR(,RMCTPTR)                               0494
         CH    @12,WMSTPGHI(,@11)                                  0494
         BH    @RT00494                                            0494
         ALR   @12,@12                                             0494
         AL    @12,WMSTPGVT(,@11)                                  0494
         LH    @12,WPGVTENT(,@12)                                  0494
         LTR   @12,@12                                             0494
         BNZ   @RF00494                                            0494
@RT00494 DS    0H                                                  0495
*         /***********************************************************/
*         /*                                                         */
*         /*                                                 @Z40BPJE*/
*         /* DETERMINE THE DEFAULT PGN FOR THIS USER BASED   @Z40BPJE*/
*         /* ON THE COMMAND FROM WHICH THE MEMORY ORIGINATED.        */
*         /*                                                 @Z40BPJE*/
*         /*                                                 @Z40BPJE*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0495
*         DO;                       /*                       @Z40BPJE*/
*           IF OUCBLOG='1'B THEN    /* MEMORY ORIGINATED VIA LOGON 0496
*                                                            @Z40BPJE*/
         TM    OUCBLOG(OUCBPTR),B'00100000'                        0496
         BNO   @RF00496                                            0496
*             OUCBNPG=RMCALGPG;     /* DEFAULT PGN FOR LOGON USER  0497
*                                                            @Z40BPJE*/
         IC    @12,RMCALGPG(,RMCTPTR)                              0497
         STC   @12,OUCBNPG(,OUCBPTR)                               0497
*           ELSE                    /* MEMORY ORIGINATED VIA START OR
*                                      MOUNT                 @Z40BPJE*/
*             OUCBNPG=RMCABCPG;     /* DEFAULT PGN FOR ALL OTHER   0498
*                                      USERS                 @Z40BPJE*/
         B     @RC00496                                            0498
@RF00496 IC    @12,RMCABCPG(,RMCTPTR)                              0498
         STC   @12,OUCBNPG(,OUCBPTR)                               0498
*         END;                      /*                       @Z40BPJE*/
*                                                                  0499
@RC00496 DS    0H                                                  0500
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @Z40BPJE*/
*       /* PLACE DOMAIN # & OFFSET IN OUCB                   @Z40BPJE*/
*       /*                                                   @Z40BPJE*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0500
*       WPGPPTR=WMSTPGDT+WPGVTENT   /* RESOLVE ADDRESSING    @Z40BPJE*/
*           +OUCBPGP;               /* TO CORRECT PGP AND    @Z40BPJE*/
@RF00494 L     @12,WMSTPTR(,RMCTPTR)                               0500
         SLR   @10,@10                                             0500
         IC    @10,OUCBNPG(,OUCBPTR)                               0500
         ALR   @10,@10                                             0500
         AL    @10,WMSTPGVT(,@12)                                  0500
         LH    WPGPPTR,WPGVTENT(,@10)                              0500
         AL    WPGPPTR,WMSTPGDT(,@12)                              0500
         SLR   @10,@10                                             0500
         IC    @10,OUCBPGP(,OUCBPTR)                               0500
         ALR   WPGPPTR,@10                                         0500
*       OUCBDMN=WPGPDMN;            /* INITIALIZE THE DOMAIN NUMBER
*                                                            @Z40BPJE*/
         SLR   @10,@10                                             0501
         IC    @10,WPGPDMN(,WPGPPTR)                               0501
         STC   @10,OUCBDMN(,OUCBPTR)                               0501
*       OUCBDMO=WDMVTENT;           /* AND DOMAIN OFFSET     @Z40BPJE*/
         ALR   @10,@10                                             0502
         AL    @10,WMSTDMVT(,@12)                                  0502
         LH    @12,WDMVTENT(,@10)                                  0502
         STH   @12,OUCBDMO(,OUCBPTR)                               0502
*       RFY                                                        0503
*         DMDTPTR2 RSTD;            /*                       @ZA11854*/
*       RFY                                                        0504
*         DMDT BASED(DMDTPTR2);     /*                       @ZA11854*/
*       DMDTPTR2=RMCTDMDT+OUCBDMO;  /* PTR TO DMDT ENTRY     @ZA11854*/
         AL    @12,RMCTDMDT(,RMCTPTR)                              0505
         LR    DMDTPTR2,@12                                        0505
*       DO WHILE(DMDTHI=ZERO&       /* MAX MPL = 0 ??        @ZA11854*/
*             WPGPFIN^='1'B);       /* AND NOT LAST PERIOD   @ZA11854*/
         B     @DE00506                                            0506
@DL00506 DS    0H                                                  0507
*         OUCBPGP=OUCBPGP+LENGTH(WPGP);/* GO TO NEXT PERIOD  @ZA11854*/
         LA    @12,8                                               0507
         SLR   @07,@07                                             0507
         IC    @07,OUCBPGP(,OUCBPTR)                               0507
         ALR   @12,@07                                             0507
         STC   @12,OUCBPGP(,OUCBPTR)                               0507
*         WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD @ZA11854*/
         L     @07,WMSTPTR(,RMCTPTR)                               0508
         SLR   @06,@06                                             0508
         IC    @06,OUCBNPG(,OUCBPTR)                               0508
         ALR   @06,@06                                             0508
         AL    @06,WMSTPGVT(,@07)                                  0508
         LH    WPGPPTR,WPGVTENT(,@06)                              0508
         AL    WPGPPTR,WMSTPGDT(,@07)                              0508
         ALR   WPGPPTR,@12                                         0508
*         OUCBDMN=WPGPDMN;          /* UPDATE DMN NUMBER     @ZA11854*/
         SLR   @12,@12                                             0509
         IC    @12,WPGPDMN(,WPGPPTR)                               0509
         STC   @12,OUCBDMN(,OUCBPTR)                               0509
*         OUCBDMO=WDMVTENT;         /* AND DMN OFFSET        @ZA11854*/
         ALR   @12,@12                                             0510
         AL    @12,WMSTDMVT(,@07)                                  0510
         LH    @12,WDMVTENT(,@12)                                  0510
         STH   @12,OUCBDMO(,OUCBPTR)                               0510
*         DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO NEW DMDT ENTRY @ZA11854*/
         AL    @12,RMCTDMDT(,RMCTPTR)                              0511
         LR    DMDTPTR2,@12                                        0511
*       END;                        /*                       @ZA11854*/
@DE00506 CLI   DMDTHI(DMDTPTR2),0                                  0512
         BNE   @DC00506                                            0512
         TM    WPGPFIN(WPGPPTR),B'10000000'                        0512
         BNO   @DL00506                                            0512
@DC00506 DS    0H                                                  0513
*       RFY                                                        0513
*         DMDT BASED(DMDTPTR);      /*                       @ZA11854*/
*       RFY                                                        0514
*         DMDTPTR2 UNRSTD;          /* FREE UP FOR USE...    @ZA11854*/
*     END;                          /* END JSR=1 CASE        @ZA10831*/
*/*                                                                  */
*/*   IF AUX PAGE SHORTAGE FIRST LEVEL HAS BEEN PASSED,  OR FIXED    */
*/*   PAGES COUNT HAS EXCEEDED THE FIRST THRESHOLD, AND THE COM-     */
*/*   MAND FROM WHICH THE MEMORY ORIGINATED WAS A START COMMAND,     */
*/*   SWAP-OUT THIS MEMORY BEFORE ANOTHER USER CAN BE INITIATED.     */
*/*                                                                  */
*                                                                  0516
*   IF(MCTASM1='1'B×                /* AUX SHORTAGE FLAG     @ZM43072*/
*       MCTFAVQ='1'B)&              /* FIXED OVER THRESHHOLD @Z40BPEB*/
*       OUCBSTT='1'B THEN           /* MEMORY ORIGIN WAS START CMD   */
@RF00489 TM    MCTASM1(RMCTPTR),B'10000000'                        0516
         BO    @GL00015                                            0516
         TM    MCTFAVQ(RMCTPTR),B'00010000'                        0516
         BNO   @RF00516                                            0516
@GL00015 TM    OUCBSTT(OUCBPTR),B'01000000'                        0516
         BNO   @RF00516                                            0516
*     DO;                                                          0517
*                                                                  0517
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(CSO)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0518
*       DO;                                                        0518
*         R1=ADDR(RMEPBCSO);        /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0519
*         CALL RMSBCRY->IRARMRTN;   /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0520
         BALR  @14,@15                                             0520
*       END;                        /* SWAP-OUT THIS MEMORY          */
*       IF RTNCOD=ZERO THEN         /* SWAP-OUT REQUEST SUCCESSFUL   */
         LTR   RTNCOD,RTNCOD                                       0522
         BNZ   @RF00522                                            0522
*         DO;                                                      0523
*           IF MCTASM1='1'B THEN    /* AUX SHORTAGE CAUSED SWAP    0524
*                                                            @ZM43072*/
         TM    MCTASM1(RMCTPTR),B'10000000'                        0524
         BNO   @RF00524                                            0524
*             DO;                                                  0525
*               OUCBJSAS='1'B;      /* JOBSELECT AUX SHORTAGE      0526
*                                                            @ZM43072*/
         OI    OUCBJSAS(OUCBPTR),B'01000000'                       0526
*               OUCBSRC=SRCDXSSC;   /* SWAP REASON           @Z40BPEB*/
         MVI   OUCBSRC(OUCBPTR),X'04'                              0527
*             END;                  /*                       @Z40BPEB*/
*           ELSE                    /* SWAP DUE TO FIXED EXCESS    0529
*                                                            @Z40BPEB*/
*             DO;                   /*                       @Z40BPEB*/
         B     @RC00524                                            0529
@RF00524 DS    0H                                                  0530
*               OUCBJSFS='1'B;      /* JOBSELECT FIX SWAP    @ZM43072*/
         OI    OUCBJSFS(OUCBPTR),B'10000000'                       0530
*               OUCBSRC=SRCDRSSC;   /* REASON FOR SWAP       @Z40BPEB*/
         MVI   OUCBSRC(OUCBPTR),X'05'                              0531
*             END;                  /*                       @Z40BPEB*/
*         END;                      /*                       @Z40BPEB*/
@RC00524 DS    0H                                                  0534
*     END;                                                         0534
*                                                                  0534
@RF00522 DS    0H                                                  0535
*/*                                                                  */
*/*   RE-INITIALIZE PAGE COUNTS IN OUSB AND OUXB FOR NEXT USER.      */
*/*                                                                  */
*                                                                  0535
*   ASXBOUSB->PGEFLDS=''B;          /* INITIALIZE PAGE COUNTS IN OUSB*/
@RF00516 L     @12,ASXBPTR(,ASCBPTR)                               0535
         L     @12,ASXBOUSB(,@12)                                  0535
         XC    PGEFLDS(48,@12),PGEFLDS(@12)                        0535
*   ASCBOUXB->PGEFLDX=''B;          /* INITIALIZE PAGE COUNTS IN OUXB*/
         L     @12,ASCBOUXB(,ASCBPTR)                              0536
         XC    PGEFLDX(36,@12),PGEFLDX(@12)                        0536
*   ASCBOUXB->ACCNTFLD=''B;         /* CLEAR OUXB ACCOUNTING FIELDS  */
         XC    ACCNTFLD(28,@12),ACCNTFLD(@12)                      0537
*   OUCBLWT='0'B;                                                  0538
*   OUCBMWT='0'B;                                                  0539
*   OUCBCIM='0'B;                                                  0540
*   OUCBOWT='0'B;                                                  0541
*   OUCBTRM='0'B;                                                  0542
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0542
*   OUCBINP='1'B;                   /* SHOW INITIATOR ATTACH PENDING */
*   OUCBSTR='1'B;                   /* SHOW BEGN TRANSACTION PENDING */
         OI    OUCBINP(OUCBPTR),B'01000010'                        0544
*   OUCBJSR='1'B;                   /* SHOW JOBSELECT RECEIVED FOR 0545
*                                      THIS ASID.            @Z40BPEB*/
*                                                                  0545
         OI    OUCBJSR(OUCBPTR),B'00001000'                        0545
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0546
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0546
         L     @12,RMEXCTL(,RMCTPTR)                               0546
         BR    @12                                                 0546
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0547
*IRARMAPG:                          /* CHECK APG STATUS OF MEMORY AND
*                                      MOVE IT TO CORRECT POSITION ON
*                                      THE ASCB QUEUE                */
*   RESPECIFY                                                      0547
*    (OUXBPTR) RSTD;                /* PTR TO OUXB                   */
IRARMAPG DS    0H                                                  0548
*/*                                                                  */
*/*   IF THE INPUT DISPATCHING PRIORITY PLACES THE MEMORY WITHIN THE */
*/*   APG, THEN INITIALIZE BASE VALUES FOR THE APG MONITORING        */
*/*   ALGORITHM. FOR ALL MEMORIES, MOVE THE ASCB TO ITS CORRECT POSI-*/
*/*   TION ON THE ASCB QUEUE BASED ON THE INPUT DISPATCHING PRIORITY.*/
*/*                                                                  */
*                                                                  0548
*   OUCBAPG='0'B;                                                  0548
*   OUCBCPL='0'B;                   /* RESET CPL BIT                 */
         NI    OUCBAPG(OUCBPTR),B'10101111'                        0549
*   IF RRPANDP>=CCCAPMDP&           /* IF THE DISPATCHING PRIORITY   */
*       RRPANDP<=CCCAPBDP THEN      /* PLACES THE MEMORY IN THE APG, */
         SLR   @12,@12                                             0550
         IC    @12,RRPANDP(,RRPAPTR)                               0550
         LH    @07,CCCAPMDP(,RMCTPTR)                              0550
         CR    @12,@07                                             0550
         BL    @RF00550                                            0550
         CH    @12,CCCAPBDP(,RMCTPTR)                              0550
         BH    @RF00550                                            0550
*     DO;                           /* THEN                  @Z40BPJE*/
*       OUCBAPG='1'B;               /* TURN APG FLAG ON              */
         OI    OUCBAPG(OUCBPTR),B'01000000'                        0552
*       WPGPPTR=WMSTPGDT+WPGVTENT+  /* GAIN ADDRESSABILTY    @Z40BPEB*/
*           OUCBPGP;                /* TO PERIOD INFO        @Z40BPEB*/
         L     @12,WMSTPTR(,RMCTPTR)                               0553
         SLR   @10,@10                                             0553
         IC    @10,OUCBNPG(,OUCBPTR)                               0553
         ALR   @10,@10                                             0553
         AL    @10,WMSTPGVT(,@12)                                  0553
         LH    WPGPPTR,WPGVTENT(,@10)                              0553
         AL    WPGPPTR,WMSTPGDT(,@12)                              0553
         SLR   @12,@12                                             0553
         IC    @12,OUCBPGP(,OUCBPTR)                               0553
         ALR   WPGPPTR,@12                                         0553
*       IF WPGPAPG='1'B             /* IPS PERIOD HAS APG    @Z40BPEB*/
*         THEN                                                     0554
         TM    WPGPAPG(WPGPPTR),B'00100000'                        0554
         BNO   @RF00554                                            0554
*         OUCBNDP=CCCAPMDP+WPGPAPGV;/* DP AS REQUESTED       @Z40BPEB*/
         SLR   @12,@12                                             0555
         IC    @12,WPGPAPGV(,WPGPPTR)                              0555
         ALR   @07,@12                                             0555
         STC   @07,OUCBNDP(,OUCBPTR)                               0555
*       ELSE                        /* IPS HAS NO APG        @Z40BPEB*/
*         OUCBNDP=CCCAPGDP;         /* GIVE DEFAULT          @Z40BPEB*/
         B     @RC00554                                            0556
@RF00554 LH    @12,CCCAPGDP(,RMCTPTR)                              0556
         STC   @12,OUCBNDP(,OUCBPTR)                               0556
*     END;                          /* DISPATCHING PRIORITY  @Z40BPJE*/
*   ELSE                                                           0558
*     OUCBNDP=RRPANDP;              /* NON-APG DP            @Z40BPJE*/
         B     @RC00550                                            0558
@RF00550 IC    @12,RRPANDP(,RRPAPTR)                               0558
         STC   @12,OUCBNDP(,OUCBPTR)                               0558
*   OUCBRDP=OUCBNDP;                /* SAVE USER DP          @Z40BPEB*/
@RC00550 IC    @12,OUCBNDP(,OUCBPTR)                               0559
         STC   @12,OUCBRDP(,OUCBPTR)                               0559
*   OUXBWCT=ASCBSWCT;               /* BASE SHORT WAIT COUNT         */
         LH    @12,ASCBSWCT(,ASCBPTR)                              0560
         STH   @12,OUXBWCT(,OUXBPTR)                               0560
*   OUXBAET=ZERO;                   /* ASCBEJST RESET AT INIT ATT/DET*/
         SLR   @12,@12                                             0561
         ST    @12,OUXBAET(,OUXBPTR)                               0561
*   OUXBCPS=''B;                    /* ALSO RESET WLM BASE CPU TIME  */
         XC    OUXBCPS(8,OUXBPTR),OUXBCPS(OUXBPTR)                 0562
*   CALL EVTCHAP;                   /* CHAP USER             @YM05632*/
*                                                                  0563
         BAL   @14,EVTCHAP                                         0563
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0564
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0564
         L     @12,RMEXCTL(,RMCTPTR)                               0564
         BR    @12                                                 0564
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*   RESPECIFY                                                      0565
*    (OUXBPTR) UNRSTD;              /* PTR TO OUXB NOT NEEDED        */
*IRARME09:                          /* SYSEVENT 9 - JOBTERM          */
*   IF OUCBATR='1'B THEN            /* USER UNDER WLM CONTROL        */
*                                                                  0566
IRARME09 TM    OUCBATR(OUCBPTR),B'10000000'                        0566
         BNO   @RF00566                                            0566
*     /***************************************************************/
*     /*                                                             */
*     /* TERMINATE ONGOING SESSION TRANSACTION ACTIVITY RECORDKEEPING*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0567
*     DO;                                                          0567
*       OUCBSTR='1'B;               /* FORCE TRANSACTION END         */
*                                                                  0568
         OI    OUCBSTR(OUCBPTR),B'01000000'                        0568
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(WMO)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0569
*       CALL RMSBWMO->IRARMRTN;     /* INVOKE WMO SUBRTN             */
*                                                                  0569
         L     @15,RMSBWMO(,RMCTPTR)                               0569
         BALR  @14,@15                                             0569
*       /*************************************************************/
*       /*                                                           */
*       /* END ANY CURRENT TRANSACTION                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0570
*     END;                                                         0570
*   ASCBOUXB->ACCNTFLD=''B;         /* CLEAR OUXB ACCOUNTING FIELDS  */
@RF00566 L     @12,ASCBOUXB(,ASCBPTR)                              0571
         XC    ACCNTFLD(28,@12),ACCNTFLD(@12)                      0571
*   OUCBLWT='0'B;                                                  0572
         NI    OUCBLWT(OUCBPTR),B'01111111'                        0572
*   OUCBRPG=ZERO;                   /* CLEAR RESET PGN SO INIT DOES
*                                      NOT KEEP THIS ONE     @Z40BPEB*/
         MVI   OUCBRPG(OUCBPTR),X'00'                              0573
*   OUCBMWT='0'B;                                                  0574
*   OUCBCIM='0'B;                                                  0575
*   OUCBOWT='0'B;                                                  0576
*   OUCBTRM='0'B;                                                  0577
         NI    OUCBMWT(OUCBPTR),B'10001110'                        0577
*   OUCBINP='0'B;                   /* SHOW INITIATOR ATTACH IGNORED */
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS */
*   OUCBSTR='0'B;                   /* RESET TRANSACTION BEGN STATUS */
         NI    OUCBINP(OUCBPTR),B'10111100'                        0580
*   OUCBBIB='0'B;                   /* RESET BRINGIN BIT     @Z40BPEB*/
*   OUCBPVL='1'B;                   /* IGNORE USER, WLM..    @Z40BPEB*/
         OI    OUCBPVL(OUCBPTR),B'00000100'                        0582
         NI    OUCBBIB(OUCBPTR),B'11011111'                        0582
*   OUCBDMN=ZERO;                   /* ALLOW ROTATION OF INITS     0583
*                                                            @Z40BPEB*/
         MVI   OUCBDMN(OUCBPTR),X'00'                              0583
*   OUCBDMO=ZERO;                   /* BY FORCING TO DMN0    @Z40BPEB*/
*                                                                  0584
         SLR   @12,@12                                             0584
         STH   @12,OUCBDMO(,OUCBPTR)                               0584
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0585
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0585
         L     @12,RMEXCTL(,RMCTPTR)                               0585
         BR    @12                                                 0585
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*IRARME10:                          /* SYSEVENT 10 - INITATT         */
*/*                                                                  */
*/*   RESET WAIT BITS.                                               */
*/*                                                                  */
*                                                                  0586
*   OUCBLWT='0'B;                                                  0586
IRARME10 DS    0H                                                  0587
*   OUCBMWT='0'B;                                                  0587
*   OUCBCIM='0'B;                                                  0588
*   OUCBOWT='0'B;                                                  0589
*   OUCBTRM='0'B;                                                  0590
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0590
*   OUCBBIB='0'B;                   /* MAKE SURE USER IS SWAPPABLE 0591
*                                                            @ZM43093*/
         NI    OUCBBIB(OUCBPTR),B'11011111'                        0591
*   ASCBIOSM=ZERO;                  /* RESET I/O COUNT       @ZA10808*/
         SLR   @12,@12                                             0592
         STH   @12,ASCBIOSM(,ASCBPTR)                              0592
*   OUCBIOSM=ZERO;                  /* RESET I/O COUNT       @ZA10808*/
         ST    @12,OUCBIOSM(,OUCBPTR)                              0593
*   OUCBPS2=ZERO;                   /* CLEAR PAGE SECONDS    @Z40BPEB*/
         ST    @12,OUCBPS2(,OUCBPTR)                               0594
*   OUCBPS1=ZERO;                   /* CLEAR PAGE SECONDS    @Z40BPEB*/
         ST    @12,OUCBPS1(,OUCBPTR)                               0595
*   OUCBPST=ZERO;                   /* AND STEP TIME.        @Z40BPEB*/
         ST    @12,OUCBPST(,OUCBPTR)                               0596
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS */
         NI    OUCBINC(OUCBPTR),B'11111110'                        0597
*   IF OUCBINP='1'B THEN            /* JOB SELECT SYSEVENT PROCESSED */
         TM    OUCBINP(OUCBPTR),B'00000010'                        0598
         BNO   @RF00598                                            0598
*     OUCBINC='1'B;                 /* SHOW INITIATOR ATTACH CURRENT */
         OI    OUCBINC(OUCBPTR),B'00000001'                        0599
*   IF OUCBTSWC='0'B THEN           /* INITIATOR DIDN'T      @ZA16887*/
@RF00598 TM    OUCBTSWC(OUCBPTR),B'00001000'                       0600
         BNZ   @RF00600                                            0600
*     DO;                           /* ISSUE TRANSWAP        @ZA16887*/
*       OUCBNSW='0'B;               /* RESET NOSWAP FLAG     @ZA16887*/
         NI    OUCBNSW(OUCBPTR),B'01111111'                        0602
*       OUCBNDS=ZERO;               /* RESET NOSWAP COUNT    @ZA16887*/
         SLR   @12,@12                                             0603
         STH   @12,OUCBNDS(,OUCBPTR)                               0603
*     END;                          /*                       @ZA16887*/
*   OUCBASW='0'B;                   /* RESET AUTH FLAG       @ZA16887*/
@RF00600 NI    OUCBASW(OUCBPTR),B'11111110'                        0605
*   IF RRPAASW='1'B THEN            /* A.S. IS AUTHORIZED TO ISSUE 0606
*                                      DONTSWAP/OKSWAP       @ZA16887*/
         TM    RRPAASW(RRPAPTR),B'00000010'                        0606
         BNO   @RF00606                                            0606
*     DO;                                                          0607
*       IF ASCBPTR=RMCAMAS THEN     /* IF MASTER SCHEDULER   @Z30WIMG*/
         C     ASCBPTR,RMCAMAS(,RMCTPTR)                           0608
         BNE   @RF00608                                            0608
*         RRPANPG=ZERO;             /* INSURE PGN IS ZERO    @Z30WIMG*/
         MVI   RRPANPG(RRPAPTR),X'00'                              0609
*       OUCBASW='1'B;               /* PERMIT MEMORY TO ISSUE SYS- 0610
*                                      EVENTS 41 AND 42 IN ORDER TO
*                                      CHANGE ITS SWAPPABLE STATUS   */
@RF00608 OI    OUCBASW(OUCBPTR),B'00000001'                        0610
*     END;                                                         0611
*                                                                  0611
*/*                                                                  */
*/*   DETERMINE THE PERFORMANCE GROUP NUMBER(PGN) UNDER WHICH THE NEW*/
*/*   STEP WILL EXECUTE.  IF THE NEW PGN IS ZERO(0), THEN THE USER   */
*/*   WILL EXECUTE IN PRIVILEGED STATUS. A MEMORY IN THIS STATE WILL */
*/*   BE IN DOM 0.  A PGN INPUT VIA A RESET COMMAND SUPERCEDES ALL   */
*/*   NON-ZERO PGNS FOR THIS USER.  NON-ZERO PGNS WILL BE VALIDATED  */
*/*   AND A DEFAULT PGN SUPPLIED BASED ON THE MEMORY ORIGIN.         */
*/*                                                                  */
*                                                                  0612
*   OUCBSPG=RRPANPG;                /* SAVE INPUT PGN        @ZA17805*/
@RF00606 IC    @12,RRPANPG(,RRPAPTR)                               0612
         STC   @12,OUCBSPG(,OUCBPTR)                               0612
*   IF RRPANPG=ZERO THEN            /* IF NEW PGN IS ZERO,           */
         CLI   RRPANPG(RRPAPTR),0                                  0613
         BNE   @RF00613                                            0613
*     DO;                           /* MEMORY WILL EXECUTE PRIVILEGED*/
*       OUCBNPG=ZERO;               /* SAVE NEW PGN                  */
         MVI   OUCBNPG(OUCBPTR),X'00'                              0615
*       OUCBDMN=ZERO;               /* PRIV....DOMAIN ZERO   @Z40BPEB*/
         MVI   OUCBDMN(OUCBPTR),X'00'                              0616
*       OUCBDMO=ZERO;               /* PRIV....DOMAIN ZERO   @Z40BPEB*/
         SLR   @12,@12                                             0617
         STH   @12,OUCBDMO(,OUCBPTR)                               0617
*       OUCBPVL='1'B;               /* INDICATE PRIVILEGED MEMORY    */
         OI    OUCBPVL(OUCBPTR),B'00000100'                        0618
*     END;                                                         0619
*   ELSE                            /* NEW PGN IS NON-ZERO           */
*     DO;                                                          0620
         B     @RC00613                                            0620
@RF00613 DS    0H                                                  0621
*       OUCBPVL='0'B;               /* MEMORY NO LONGER PRIVILEGED   */
         NI    OUCBPVL(OUCBPTR),B'11111011'                        0621
*       IF OUCBRPG=ZERO THEN        /* IF RESET COMMAND NOT PROCESSED*/
         CLI   OUCBRPG(OUCBPTR),0                                  0622
         BNE   @RF00622                                            0622
*         OUCBNPG=RRPANPG;          /* NEW PGN INPUT WITH SYSEVENT   */
         IC    @12,RRPANPG(,RRPAPTR)                               0623
         STC   @12,OUCBNPG(,OUCBPTR)                               0623
*       ELSE                        /* RESET COMMAND PROCESSED       */
*         OUCBNPG=OUCBRPG;          /* RESET COMMAND PGN REPLACES ANY
*                                      INPUT WITH THE SYSEVENT       */
*                                                                  0624
         B     @RC00622                                            0624
@RF00622 IC    @12,OUCBRPG(,OUCBPTR)                               0624
         STC   @12,OUCBNPG(,OUCBPTR)                               0624
*       /*************************************************************/
*       /*                                                           */
*       /* THE NEW PGN IS VALIDATED BY USING IT AS AN INDEX INTO THE */
*       /* WORKLOAD MANAGER PERFORMANCE GROUP VECTOR TABLE(WPGVT), AN*/
*       /* ARRAY OF 2 BYTE ELEMENTS. EACH ELEMENT REPRESENTS AN      */
*       /* OFFSET TO ONE OF THE PERFORMANCE GROUPS THAT CAN BE       */
*       /* DEFINED WITH- IN AN IPS. THOSE PERFORMANCE GROUPS THAT ARE*/
*       /* INVALID HAVE A ZERO OFFSET. IF THE INDEXED ELEMENT IS     */
*       /* NON-ZERO, THEN THE PGN IS VALID. OTHERWISE DETERMINE THE  */
*       /* DEFAULT PGN TO BE USED BASED ON THE COMMAND FROM WHICH THE*/
*       /* MEMORY ORIGINATED.                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0625
*       IF(OUCBNPG>WMSTPGHI×        /* IF THE NEW PGN IS UNDEFINED   */
*           WPGVTENT=ZERO) THEN     /* IN THE CURRENT IPS,           */
*                                                                  0625
@RC00622 SLR   @12,@12                                             0625
         IC    @12,OUCBNPG(,OUCBPTR)                               0625
         L     @11,WMSTPTR(,RMCTPTR)                               0625
         CH    @12,WMSTPGHI(,@11)                                  0625
         BH    @RT00625                                            0625
         ALR   @12,@12                                             0625
         AL    @12,WMSTPGVT(,@11)                                  0625
         LH    @12,WPGVTENT(,@12)                                  0625
         LTR   @12,@12                                             0625
         BNZ   @RF00625                                            0625
@RT00625 DS    0H                                                  0626
*         /***********************************************************/
*         /*                                                         */
*         /* DETERMINE THE DEFAULT PGN FOR THIS USER BASED ON THE    */
*         /* COMMAND FROM WHICH THE MEMORY ORIGINATED.               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0626
*         DO;                                                      0626
*           IF OUCBLOG='1'B THEN    /* MEMORY ORIGINATED VIA LOGON   */
         TM    OUCBLOG(OUCBPTR),B'00100000'                        0627
         BNO   @RF00627                                            0627
*             OUCBNPG=RMCALGPG;     /* DEFAULT PGN FOR LOGON @Z40BPJE*/
         IC    @12,RMCALGPG(,RMCTPTR)                              0628
         STC   @12,OUCBNPG(,OUCBPTR)                               0628
*           ELSE                    /* MEMORY ORIGINATED VIA START OR
*                                      MOUNT                         */
*             OUCBNPG=RMCABCPG;     /* DEFAULT PGN FOR ALL OTHER   0629
*                                      USERS                 @Z40BPJE*/
         B     @RC00627                                            0629
@RF00627 IC    @12,RMCABCPG(,RMCTPTR)                              0629
         STC   @12,OUCBNPG(,OUCBPTR)                               0629
*         END;                                                     0630
@RC00627 DS    0H                                                  0631
*     END;                                                         0631
*                                                                  0631
@RF00625 DS    0H                                                  0632
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @Z40BPJE*/
*   /* PLACE DOMAIN # & OFFSET IN OUCB                       @Z40BPJE*/
*   /*                                                       @Z40BPJE*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0632
*   IF OUCBINC='1'B THEN            /* IF USER UNDER WLM CONTROL     */
@RC00613 TM    OUCBINC(OUCBPTR),B'00000001'                        0632
         BNO   @RF00632                                            0632
*/*                                                                  */
*/*   DETERMINE THE TRANSACTION STATUS WITHIN THIS MEMORY.  A TRANS- */
*/*   ACTION FOR A USER WHOSE MEMORY ORIGIN WAS A START COMMAND CAN  */
*/*   EXTEND ACROSS JOB STEPS.  IF THE PGN FOR THE NEW STEP IS THE   */
*/*   SAME AS THAT OF THE PREVIOUS STEP, THEN AN EXISTING TRANSACTION*/
*/*   THAT WAS SUSPENDED AT THE PREVIOUS INITDET SYSEVENT SHOULD BE  */
*/*   RESUMED.  OTHERWISE A NEW TRANSACTION SHOULD BE STARTED.       */
*/*                                                                  */
*                                                                  0633
*     DO;                                                          0633
*       IF OUCBSTT='1'B&            /* IF THE ORIGIN OF THE          */
*           OUCBNPG=(ADDR(WPGD)+    /* MEMORY IS A START COMMAND AND */
*           OUCBWMG)->              /* THE NEW PGN IS THE SAME AS    */
*           WPGDPGN THEN            /* THE PREVIOUS ONE,             */
*                                                                  0634
         TM    OUCBSTT(OUCBPTR),B'01000000'                        0634
         BNO   @RF00634                                            0634
         L     @12,WMSTPTR(,RMCTPTR)                               0634
         LH    @11,OUCBWMG(,OUCBPTR)                               0634
         AL    @11,WPGDPTR(,@12)                                   0634
         CLC   OUCBNPG(1,OUCBPTR),WPGDPGN(@11)                     0634
         BNE   @RF00634                                            0634
*         /***********************************************************/
*         /*                                                         */
*         /* ? IRACTLCL EPN(WMR)                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0635
*         CALL RMSBWMR->IRARMRTN;   /* INVOKE WMR SUBRTN             */
*                                                                  0635
         L     @15,RMSBWMR(,RMCTPTR)                               0635
         BALR  @14,@15                                             0635
*       /*************************************************************/
*       /*                                                           */
*       /* RESUME OLD TRANSACTION                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0636
*       ELSE                                                       0636
*         DO;                                                      0636
         B     @RC00634                                            0636
@RF00634 DS    0H                                                  0637
*           OUCBPGP=WPGPOFST;       /* FIRST PERIOD OFFSET   @Z40BPEB*/
         LA    @12,12                                              0637
         STC   @12,OUCBPGP(,OUCBPTR)                               0637
*           WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO     0638
*                                                            @Z40BPJE*/
*               OUCBPGP;            /* THE CORRECT PGP       @Z40BPJE*/
         L     @10,WMSTPTR(,RMCTPTR)                               0638
         SLR   @07,@07                                             0638
         IC    @07,OUCBNPG(,OUCBPTR)                               0638
         ALR   @07,@07                                             0638
         AL    @07,WMSTPGVT(,@10)                                  0638
         LH    WPGPPTR,WPGVTENT(,@07)                              0638
         AL    WPGPPTR,WMSTPGDT(,@10)                              0638
         ALR   WPGPPTR,@12                                         0638
*           OUCBDMN=WPGPDMN;        /* INITIALIZE THE DOMAIN NUMBER
*                                                            @Z40BPJE*/
         SLR   @12,@12                                             0639
         IC    @12,WPGPDMN(,WPGPPTR)                               0639
         STC   @12,OUCBDMN(,OUCBPTR)                               0639
*           OUCBDMO=WDMVTENT;       /* AND DOMAIN OFFSET     @Z40BPJE*/
*                                                                  0640
         ALR   @12,@12                                             0640
         AL    @12,WMSTDMVT(,@10)                                  0640
         LH    @12,WDMVTENT(,@12)                                  0640
         STH   @12,OUCBDMO(,OUCBPTR)                               0640
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(WMN)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0641
*           CALL RMSBWMN->IRARMRTN; /* INVOKE WMN SUBRTN             */
*                                                                  0641
         L     @15,RMSBWMN(,RMCTPTR)                               0641
         BALR  @14,@15                                             0641
*           /*********************************************************/
*           /*                                                       */
*           /* START A NEW TRANSACTION                               */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0642
*         END;                                                     0642
*     END;                                                         0643
*   ELSE                                                           0644
*     DO;                           /* NOT UNDER WLM CONTROL @Z40BPEB*/
         B     @RC00632                                            0644
@RF00632 DS    0H                                                  0645
*       OUCBPGP=WPGPOFST;           /* FIRST PERIOD OFFSET   @Z40BPEB*/
         LA    @12,12                                              0645
         STC   @12,OUCBPGP(,OUCBPTR)                               0645
*       WPGPPTR=WMSTPGDT+WPGVTENT+  /* RESOLVE ADDRESSING TO @Z40BPJE*/
*           OUCBPGP;                /* THE CORRECT PGP       @Z40BPJE*/
         L     @10,WMSTPTR(,RMCTPTR)                               0646
         SLR   @07,@07                                             0646
         IC    @07,OUCBNPG(,OUCBPTR)                               0646
         ALR   @07,@07                                             0646
         AL    @07,WMSTPGVT(,@10)                                  0646
         LH    WPGPPTR,WPGVTENT(,@07)                              0646
         AL    WPGPPTR,WMSTPGDT(,@10)                              0646
         ALR   WPGPPTR,@12                                         0646
*       OUCBDMN=WPGPDMN;            /* INITIALIZE THE DOMAIN NUMBER
*                                                            @Z40BPJE*/
         SLR   @12,@12                                             0647
         IC    @12,WPGPDMN(,WPGPPTR)                               0647
         STC   @12,OUCBDMN(,OUCBPTR)                               0647
*       OUCBDMO=WDMVTENT;           /* AND DOMAIN OFFSET     @Z40BPJE*/
         ALR   @12,@12                                             0648
         AL    @12,WMSTDMVT(,@10)                                  0648
         LH    @12,WDMVTENT(,@12)                                  0648
         STH   @12,OUCBDMO(,OUCBPTR)                               0648
*     END;                          /*                       @Z40BPEB*/
*   RESPECIFY                                                      0650
*    (OUXBPTR) RSTD;                                               0650
@RC00632 DS    0H                                                  0651
*   OUXBPTR=ASCBOUXB;               /* EST ADDRESSABILITY TO THE OUXB*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0651
*/*                                                                  */
*/*   ESTABLISH BASE I/O USAGE VALUE AND BASE TIME FOR THE I/O LOAD  */
*/*   BALANCING ALGORITHM.                                           */
*/*                                                                  */
*                                                                  0652
*   OUXBILS=ZERO;                   /* BASE I/O USAGE MEASUREMENT  0652
*                                                            @ZA10808*/
         SLR   @12,@12                                             0652
         ST    @12,OUXBILS(,OUXBPTR)                               0652
*   OUXBITD=RMCTTOD;                /* BASE TIME OF DAY              */
         L     @07,RMCTTOD(,RMCTPTR)                               0653
         ST    @07,OUXBITD(,OUXBPTR)                               0653
*   OUCBIOR=ZERO;                   /* RESET I/O USAGE PROFILE       */
         STH   @12,OUCBIOR(,OUCBPTR)                               0654
*/*                                                                  */
*/*   ESTABLISH BASE VAM AND NON-VAM DATA SET AUXILIARY STORAGE      */
*/*   ALLOCATED SLOT COUNT VALUES AND BASE TIME FOR THE AUX SLOT     */
*/*   SHORTAGE MONITORING ALGORITHM.                                 */
*/*                                                                  */
*                                                                  0655
*   OUXBVSC=ASCBVSC;                /* BASE VAM SLOT COUNT           */
         LH    @11,ASCBVSC(,ASCBPTR)                               0655
         STH   @11,OUXBVSC(,OUXBPTR)                               0655
*   OUXBNVC=ASCBNVSC;               /* BASE NON-VAM SLOT COUNT       */
         LH    @11,ASCBNVSC(,ASCBPTR)                              0656
         STH   @11,OUXBNVC(,OUXBPTR)                               0656
*   OUXBSTD=RMCTTOD;                /* BASE TIME OF DAY OF SLOT COUNT*/
         ST    @07,OUXBSTD(,OUXBPTR)                               0657
*   OUXBPET=ZERO;                   /* RESET PAGE STEAL CPU INTERVAL */
         ST    @12,OUXBPET(,OUXBPTR)                               0658
*/*                                                                  */
*/*   SET UP NEW APG STATUS FOR THIS MEMORY AND HAVE THE MEMORY MOVED*/
*/*   TO THE CORRECT POSITION ON THE ASCB QUEUE.                     */
*/*                                                                  */
*                                                                  0659
*   GOTO IRARMAPG;                                                 0659
         B     IRARMAPG                                            0659
*   RESPECIFY                                                      0660
*    (OUXBPTR) UNRSTD;              /* ADDRESSABILITY TO OUXB NO   0660
*                                      LONGER REQUIRED.              */
*IRARME11:                          /* SYSEVENT 11 - INITDET         */
*/*                                                                  */
*/*   RESET WAIT BITS.                                               */
*/*                                                                  */
*                                                                  0661
*   OUCBLWT='0'B;                                                  0661
IRARME11 DS    0H                                                  0662
*   OUCBMWT='0'B;                                                  0662
*   OUCBCIM='0'B;                                                  0663
*   OUCBOWT='0'B;                                                  0664
*   OUCBTRM='0'B;                                                  0665
         NI    OUCBLWT(OUCBPTR),B'00001110'                        0665
*   OUCBNDS=ZERO;                   /* CLEAR COUNT OF OUTSTANDING  0666
*                                      DONTSWAP SYSEVENTS WHICH ARE
*                                      NOT VALID ACROSS JOB STEPS    */
         SLR   @12,@12                                             0666
         STH   @12,OUCBNDS(,OUCBPTR)                               0666
*   OUCBNSW='0'B;                   /* CURRENT STATUS OF MEMORY IS 0667
*                                      SWAPPABLE                     */
*   OUCBPVL='0'B;                   /* MARK MEMORY AS NON- PRIVILEGED
*                                      STATUS                @Z40BPJE*/
         NI    OUCBNSW(OUCBPTR),B'01111011'                        0668
*   OUCBASW='0'B;                   /* RESCIND AUTHORIZATION OF    0669
*                                      MEMORY TO ISSUE SYSEVENTS 41
*                                      AND 42                        */
         NI    OUCBASW(OUCBPTR),B'11111110'                        0669
*   OUCBPST=ZERO;                   /* RESET STEP TIME       @Z40BPEB*/
         SLR   @12,@12                                             0670
         ST    @12,OUCBPST(,OUCBPTR)                               0670
*   OUCBINC='0'B;                   /* RESET INITIATOR ATTACH STATUS
*                                      THIS STOPS DELAY IF BETWEEN 0671
*                                      JOBSTEPS              @ZA11855*/
*                                                                  0671
         NI    OUCBINC(OUCBPTR),B'11111110'                        0671
*   /*****************************************************************/
*   /*                                                               */
*   /* RESET TRANSWAP AND REQSWAP FIELDS. FREE ANY STORAGE CELLS USED*/
*   /* FOR ECB LISTS.                                        @ZA20975*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0672
*   IF PVTAPREF='0'B THEN           /* IF ALLOWED            @ZA16887*/
         L     @12,CVTPTR                                          0672
         L     @12,PVTPTR(,@12)                                    0672
         TM    PVTAPREF(@12),B'00001000'                           0672
         BNZ   @RF00672                                            0672
*     DO;                           /* RESET PREFERRED STORAGE     0673
*                                                            @ZA16887*/
*       ASCB1LPU='0'B;              /* INDICATORS - 1ST LEVEL,     0674
*                                                            @ZA16887*/
*       ASCB2LPU='0'B;              /* 2ND LEVEL, AND        @ZA16887*/
*       ASCBN2LP='0'B;              /* NEVER 2ND LEVEL       @ZA16887*/
         L     @12,ASCBN2LP(,ASCBPTR)                              0676
@GL00020 LR    @11,@12                                             0676
         N     @11,@CF02698                                        0676
         CS    @12,@11,ASCBN2LP(ASCBPTR)                           0676
         BNE   @GL00020                                            0676
*     END;                          /*                       @ZA16887*/
*   RFY                                                            0678
*     OUXBPTR RSTD;                 /* PTR TO OUXB           @ZA16887*/
@RF00672 DS    0H                                                  0679
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB      0679
*                                                            @ZA16887*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0679
*   RFY                                                            0680
*     ECBFIELD BASED(ADDR(OUXBRSW));/* FIRST, REQSWAP...     @ZA20975*/
*   IF ECBLISTB='1'B THEN           /* DOES ECB LIST EXIST?  @ZA20975*/
         LA    @12,12                                              0681
         ALR   @12,OUXBPTR                                         0681
         TM    ECBLISTB(@12),B'10000000'                           0681
         BNO   @RF00681                                            0681
*     DO;                           /* YES, FREE ITS CELL:   @ZA20975*/
*       R0=LENGTH(OUXB);            /* IN CASE I04 INVOKED   @ZA20975*/
         LA    R0,144                                              0683
*       R1=SWAPECB;                 /* PASS ADDRESS OF CELL  @ZA20975*/
*                                                                  0684
         L     R1,SWAPECB(,@12)                                    0684
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I04)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0685
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */
*                                                                  0685
         L     @15,RMSBI04(,RMCTPTR)                               0685
         BALR  @14,@15                                             0685
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE FREECELL RTN                               @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0686
*     END;                          /* END REQSWAP FREECELL  @ZA20975*/
*   ECBFIELD=ZERO;                  /* CLEAR OUXBRSW FIELD   @ZA20975*/
@RF00681 SLR   @12,@12                                             0687
         ST    @12,ECBFIELD+12(,OUXBPTR)                           0687
*   RFY                                                            0688
*     ECBFIELD BASED(ADDR(OUXBTSW));/* NOW, TRANSWAP...      @ZA20975*/
*   IF ECBLISTB='1'B THEN           /* DOES ECB LIST EXIST?  @ZA20975*/
         LA    @12,140                                             0689
         ALR   @12,OUXBPTR                                         0689
         TM    ECBLISTB(@12),B'10000000'                           0689
         BNO   @RF00689                                            0689
*     DO;                           /* YES, FREE ITS CELL:   @ZA20975*/
*       R0=LENGTH(OUXB);            /* IN CASE I04 INVOKED   @ZA20975*/
         LA    R0,144                                              0691
*       R1=SWAPECB;                 /* PASS ADDRESS OF CELL  @ZA20975*/
*                                                                  0692
         L     R1,SWAPECB(,@12)                                    0692
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I04)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0693
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */
*                                                                  0693
         L     @15,RMSBI04(,RMCTPTR)                               0693
         BALR  @14,@15                                             0693
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE FREECELL RTN                               @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0694
*     END;                          /* END TRANSWAP FREECELL @ZA20975*/
*   ECBFIELD=ZERO;                  /* CLEAR OUXBTSW FIELD   @ZA20975*/
@RF00689 SLR   @12,@12                                             0695
         ST    @12,ECBFIELD+140(,OUXBPTR)                          0695
*   RFY                                                            0696
*     ECBFIELD BASED(ECBPARM);      /* NORMAL BASING         @ZA20975*/
*   OUCBTSWP='0'B;                  /* RESET TRANSWAP PENDING      0697
*                                                            @ZA16887*/
*   OUCBTSWC='0'B;                  /* RESET TRANSWAP COMPLETE     0698
*                                                            @ZA16887*/
         NI    OUCBTSWP(OUCBPTR),B'11100111'                       0698
*   OUCBNTSP=ZERO;                  /* RESET PENDING COUNT   @ZA20975*/
         STH   @12,OUCBNTSP(,OUCBPTR)                              0699
*   IF OUCBRSWP='1'B                /* REQSWAP PENDING?      @ZA31733*/
*     THEN                                                         0700
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       0700
         BNO   @RF00700                                            0700
*     CALL EVTCSOD;                 /* YES. ATTEMPT SWAP OUT @ZA31733*/
*                                                                  0701
         BAL   @14,EVTCSOD                                         0701
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(WMO)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0702
*   CALL RMSBWMO->IRARMRTN;         /* INVOKE WMO SUBRTN             */
*                                                                  0702
@RF00700 L     @15,RMSBWMO(,RMCTPTR)                               0702
         BALR  @14,@15                                             0702
*   /*****************************************************************/
*   /*                                                               */
*   /* TERMINATE OR SUSPEND THE CURRENT TRANSACTION                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0703
*/*                                                                  */
*/*   IF I/O ACTIVITY FOR THIS MEMORY WAS BEING MONITORED BY THE I/O */
*/*   LOAD BALANCING ALGORITHM, REQUEST THAT THE HISTORY OF I/O      */
*/*   ACTIVITY BE RESET SINCE I/O ACTIVITY MAY NOT BE CONSISTENT     */
*/*   ACROSS JOB STEPS. THE REQUEST IS PERFORMED INDIRECTLY THROUGH  */
*/*   THE USER ACTION REQUEST ROUTINE WHICH PROVIDES THE NECESSARY   */
*/*   SYNCHRONIZATION WITH OTHER SRM FUNCTIONS. IF REQUIRED, THE USER*/
*/*   ACTION REQUEST ROUTINE WILL QUEUE THE ACTION UNTIL ALL ASYN-   */
*/*   SYNCHRONOUS PROCESSING HAS COMPLETED.                          */
*/*                                                                  */
*                                                                  0703
*   IF OUCBIMCB^=ZERO THEN          /* IF I/O ACTIVITY WAS MONITORED,*/
         L     @12,OUCBIMCB(,OUCBPTR)                              0703
         LTR   @12,@12                                             0703
         BZ    @RF00703                                            0703
*     DO;                           /* REQUEST I/O HISTORY BE RESET  */
*                                                                  0704
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(IL4)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0705
*       DO;                                                        0705
*         R1=ADDR(RMEPBIL4);        /* IL4 REQUEST IS PARAM          */
         LA    R1,RMEPBIL4(,RMCTPTR)                               0706
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0707
         BALR  @14,@15                                             0707
*       END;                        /* INVOKE I/O MONITORING ACTION
*                                      ROUTINE                       */
*     END;                                                         0709
*                                                                  0709
*   /*****************************************************************/
*   /*                                                               */
*   /* PREVENT ADDRESS SPACE FROM BEING CAUGHT IN A DELAY DOMAIN     */
*   /* BETWEEN JOB STEPS AND DURING TERMINATION PROCESSING. (THIS    */
*   /* LOGIC IS ALSO USED BY JOBSELCT AND RESETPG.)          @ZA24836*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0710
*   RFY                                                            0710
*     DMDTPTR RSTD;                 /*                       @ZA24836*/
@RF00703 DS    0H                                                  0711
*   WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* CURRENT PERIOD      @ZA24836*/
         L     @12,WMSTPTR(,RMCTPTR)                               0711
         SLR   @10,@10                                             0711
         IC    @10,OUCBNPG(,OUCBPTR)                               0711
         ALR   @10,@10                                             0711
         AL    @10,WMSTPGVT(,@12)                                  0711
         LH    WPGPPTR,WPGVTENT(,@10)                              0711
         AL    WPGPPTR,WMSTPGDT(,@12)                              0711
         SLR   @12,@12                                             0711
         IC    @12,OUCBPGP(,OUCBPTR)                               0711
         ALR   WPGPPTR,@12                                         0711
*   DMDTPTR=RMCTDMDT+OUCBDMO;       /* CURRENT DMDT ENRY     @ZA24836*/
         LH    DMDTPTR,OUCBDMO(,OUCBPTR)                           0712
         AL    DMDTPTR,RMCTDMDT(,RMCTPTR)                          0712
*   DO WHILE(DMDTHI=ZERO&           /* MAX MPL = 0 ??        @ZA24836*/
*         WPGPFIN^='1'B);           /* AND NOT LAST PERIOD   @ZA24836*/
         B     @DE00713                                            0713
@DL00713 DS    0H                                                  0714
*     OUCBPGP=OUCBPGP+LENGTH(WPGP); /* GO TO NEXT PERIOD     @ZA24836*/
         LA    @12,8                                               0714
         SLR   @10,@10                                             0714
         IC    @10,OUCBPGP(,OUCBPTR)                               0714
         ALR   @12,@10                                             0714
         STC   @12,OUCBPGP(,OUCBPTR)                               0714
*     WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD     @ZA24836*/
         L     @10,WMSTPTR(,RMCTPTR)                               0715
         SLR   @12,@12                                             0715
         IC    @12,OUCBNPG(,OUCBPTR)                               0715
         ALR   @12,@12                                             0715
         AL    @12,WMSTPGVT(,@10)                                  0715
         LH    WPGPPTR,WPGVTENT(,@12)                              0715
         AL    WPGPPTR,WMSTPGDT(,@10)                              0715
         SLR   @12,@12                                             0715
         IC    @12,OUCBPGP(,OUCBPTR)                               0715
         ALR   WPGPPTR,@12                                         0715
*     OUCBDMN=WPGPDMN;              /* UPDATE DMN NUMBER     @ZA24836*/
         SLR   @12,@12                                             0716
         IC    @12,WPGPDMN(,WPGPPTR)                               0716
         STC   @12,OUCBDMN(,OUCBPTR)                               0716
*     OUCBDMO=WDMVTENT;             /* AND DMN OFFSET        @ZA24836*/
         ALR   @12,@12                                             0717
         AL    @12,WMSTDMVT(,@10)                                  0717
         LH    @12,WDMVTENT(,@12)                                  0717
         STH   @12,OUCBDMO(,OUCBPTR)                               0717
*     DMDTPTR=RMCTDMDT+OUCBDMO;     /* PTR TO NEW DMDT ENTRY @ZA24836*/
         AL    @12,RMCTDMDT(,RMCTPTR)                              0718
         LR    DMDTPTR,@12                                         0718
*   END;                            /*                       @ZA24836*/
@DE00713 CLI   DMDTHI(DMDTPTR),0                                   0719
         BNE   @DC00713                                            0719
         TM    WPGPFIN(WPGPPTR),B'10000000'                        0719
         BNO   @DL00713                                            0719
@DC00713 DS    0H                                                  0720
*   RFY                                                            0720
*     DMDTPTR UNRSTD;               /* FREE UP FOR USE...    @ZA24836*/
*/*                                                                  */
*/*   SET UP NEW APG STATUS FOR THIS MEMORY AND HAVE THE MEMORY MOVED*/
*/*   TO THE CORRECT POSITION ON THE ASCB QUEUE.                     */
*/*                                                                  */
*                                                                  0721
*   GOTO IRARMAPG;                                                 0721
         B     IRARMAPG                                            0721
*   RESPECIFY                                                      0722
*    (OUXBPTR) UNRSTD;              /* PTR TO OUXB NOT NEEDED        */
*IRARME12:                          /* SYSEVENT 12 - QSCEST          */
*/*                                                                  */
*/*   FOR A NON-SWAPPABLE MEMORY, QUIESCE PROCESSING WILL BE DIRECTED*/
*/*   TO RESTORE THE MEMORY. IF SRM RESOURCE SHORTAGE ALGORITHMS ARE */
*/*   APPLICABLE TO THIS MEMORY THEN THE I/O USAGE PROFILE ROUTINE IS*/
*/*   INVOKED TO CHECK TO SEE IF THE USER'S I/O PROFILE SHOULD BE    */
*/*   UPDATED.                                                       */
*/*                                                                  */
*                                                                  0723
*   OUCBPSTR='0'B;                  /* RESET XMPOST ERROR ROUTINE  0723
*                                      FLAG THAT WAS SET BY CSO    0723
*                                                            @ZA16887*/
IRARME12 NI    OUCBPSTR(OUCBPTR),B'11110111'                       0723
*   RRPARI3=QSCECONT;               /* RCT IS TO CONTINUE QUIESCE    */
         MVI   RRPARI3(RRPAPTR),X'00'                              0724
*   IF OUCBNSW='1'B×                /* MEMORY IS NON-SWAPPABLE OR    */
*       OUCBCTI='1'B×               /* CONTROL PROHIBITS SWAP OR     */
*       OUCBRSWP='0'B&              /* NO REQSWAP PENDING AND      0725
*                                                            @ZA16887*/
*       OUCBTSWP='0'B&              /* NO TRANSWAP PENDING, AND    0725
*                                                            @ZA16887*/
*       ((OUCBLWT='1'B×             /* MEMORY WAS SWAPPED BECAUSE OF */
*       OUCBMWT='1'B)&              /* LONG WAIT BUT IS NOT REALLY   */
*       RRPAWAIT=NOWAIT) THEN       /* IN LONG WAIT          @Z30WIMG*/
         TM    OUCBNSW(OUCBPTR),B'11000000'                        0725
         BNZ   @RT00725                                            0725
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0725
         BNZ   @RF00725                                            0725
         TM    OUCBLWT(OUCBPTR),B'10000001'                        0725
         BZ    @RF00725                                            0725
         CLI   RRPAWAIT(RRPAPTR),X'00'                             0725
         BNE   @RF00725                                            0725
@RT00725 DS    0H                                                  0726
*     DO;                                                          0726
*                                                                  0726
*       /*************************************************************/
*       /*                                                           */
*       /* FIRST, POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.*/
*       /*                                                   @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0727
*       RFY                                                        0727
*         OUXBPTR RSTD;             /* HOLD REGISTER         @ZA16887*/
*       OUXBPTR=ASCBOUXB;           /* GET OUXB ADDRESS      @ZA16887*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0728
*       IF OUCBRSWP='1'B×OUCBTSWP='1'B THEN/* POSTING NEEDED?      0729
*                                                            @ZA20975*/
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0729
         BZ    @RF00729                                            0729
*         DO;                       /* POSSIBLY, SO          @ZA20975*/
*           R0=FOUR;                /* I06 WILL POST WITH 4  @ZA20975*/
         LA    R0,4                                                0731
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA16887*/
         BAL   @14,EVTENDSW                                        0732
*         END;                      /* DONE POSTING          @ZA20975*/
*                                                                  0733
*       /*************************************************************/
*       /*                                                           */
*       /* NOW, RESET OTHER FIELDS FOR SWAP TURNAROUND.              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0734
*       OUCBLWT='0'B;               /* RESET LONG                    */
@RF00729 DS    0H                                                  0735
*       OUCBMWT='0'B;               /* WAIT FLAGS                    */
*       OUCBTRM='0'B;               /* INDICATE NO TERMWAIT SWAPOUT  */
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0736
*       OUCBCTI='0'B;               /* RESET CNTL PROHIBITS SWAP FLAG*/
         NI    OUCBCTI(OUCBPTR),B'10111111'                        0737
*       OUCBGOO='0'B;               /* RESET USER TRANSITIONING OUT  */
         NI    OUCBGOO(OUCBPTR),B'01111111'                        0738
*       CALL EVTCHAP;               /* CHAP TO USER PRIORITY @YM05632*/
         BAL   @14,EVTCHAP                                         0739
*       RRPARI3=RESTORE;            /* RCT IS TO RESTORE ADDR SPACE  */
         MVI   RRPARI3(RRPAPTR),X'08'                              0740
*     END;                                                         0741
*   ELSE                            /* MEMORY IS SWAPPABLE           */
*     OUCBQSS='1'B;                 /* QSCEST SYSEVENT PROCESSED     */
         B     @RC00725                                            0742
@RF00725 OI    OUCBQSS(OUCBPTR),B'00000100'                        0742
*   IF OUCBRMA='1'B THEN            /* SRM ALGORITHMS APPLICABLE     */
*                                                                  0743
@RC00725 TM    OUCBRMA(OUCBPTR),B'00100000'                        0743
         BNO   @RF00743                                            0743
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(IL0)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0744
*     CALL RMSBIL0->IRARMRTN;       /* INVOKE IL0 SUBRTN             */
*                                                                  0744
         L     @15,RMSBIL0(,RMCTPTR)                               0744
         BALR  @14,@15                                             0744
*   /*****************************************************************/
*   /*                                                               */
*   /* I/O USAGE MONITORING ALGORITHM ? IRACTLCL EPN(CTL)            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0745
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0745
@RF00743 L     @12,RMEXCTL(,RMCTPTR)                               0745
         BR    @12                                                 0745
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0746
*   RFY                                                            0746
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/
*IRARME13:                          /* SYSEVENT 13 - QSCECMP         */
*   RESPECIFY                                                      0747
*    (RTNREG,                                                      0747
*     NTRREG,                                                      0747
*     RETNCODE) UNRSTD;                                            0747
IRARME13 DS    0H                                                  0748
*   RESPECIFY                                                      0748
*     OUXBPTR                       /*                       @Z30WIMG*/
*         RSTD;                     /* HOLD OUSBPTR LATER    @ZA20975*/
*   IF RRPAWAIT=NOWAIT THEN         /* IF MEMORY HAS AT LEAST ONE  0749
*                                      EXECUTABLE TASK               */
         CLI   RRPAWAIT(RRPAPTR),X'00'                             0749
         BNE   @RF00749                                            0749
*     OUCBRDYB='1'B;                /* MEMORY ELIGIBLE TO BE SWAPPED
*                                      IN                            */
         L     @12,OUCBRDYB-2(,OUCBPTR)                            0750
@GL00025 LR    @07,@12                                             0750
         O     @07,@CF02688                                        0750
         CS    @12,@07,OUCBRDYB-2(OUCBPTR)                         0750
         BNE   @GL00025                                            0750
*/*                                                                  */
*/*   DETERMINE THE STATUS OF THE MEMORY.  A NON-SWAPPABLE MEMORY    */
*/*   SHOULD BE RESTORED BY THE RCT.                                 */
*/*                                                                  */
*                                                                  0751
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB        */
@RF00749 L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0751
*   IF OUCBNSW='1'B×                /* MEMORY IS NON-SWAPPABLE OR    */
*       OUCBCTI='1'B×               /* CONTROL PROHIBITS SWAP OR     */
*       OUCBRSWP='0'B&              /* NO REQSWAP PENDING AND      0752
*                                                            @ZA16887*/
*       OUCBTSWP='0'B&              /* NO TRANSWAP PENDING, AND    0752
*                                                            @ZA16887*/
*       (((OUCBLWT='1'B×            /* MEMORY WAS SWAPPED BECAUSE OF */
*       OUCBMWT='1'B)&              /* LONG WAIT BUT IS NOT REALLY   */
*       OUCBRDY='1'B)) THEN         /* IN LONG WAIT                  */
         TM    OUCBNSW(OUCBPTR),B'11000000'                        0752
         BNZ   @RT00752                                            0752
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0752
         BNZ   @RF00752                                            0752
         TM    OUCBLWT(OUCBPTR),B'10000001'                        0752
         BZ    @RF00752                                            0752
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0752
         BNO   @RF00752                                            0752
@RT00752 DS    0H                                                  0753
*     DO;                           /* TURN SWAP AROUND              */
*                                                                  0753
*       /*************************************************************/
*       /*                                                           */
*       /* FIRST, POST ALL ISSUERS OF REQSWAP OR TRANSWAP, IF NEEDED.*/
*       /*                                                   @ZA20975*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0754
*       IF OUCBRSWP='1'B×OUCBTSWP='1'B THEN/* POSTING NEEDED?      0754
*                                                            @ZA20975*/
         TM    OUCBRSWP(OUCBPTR),B'00110000'                       0754
         BZ    @RF00754                                            0754
*         DO;                       /* POSSIBLY, SO          @ZA20975*/
*           R0=FOUR;                /* I06 WILL POST WITH 4  @ZA20975*/
         LA    R0,4                                                0756
*           CALL EVTENDSW;          /* SUBROUTINE DOES POST  @ZA16887*/
         BAL   @14,EVTENDSW                                        0757
*         END;                      /* DONE POSTING          @ZA20975*/
*                                                                  0758
*       /*************************************************************/
*       /*                                                           */
*       /* NOW RESET OTHER FIELDS FOR SWAP TURNAROUND.               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0759
*       OUCBTRM='0'B;               /* INDICATE NO TERMWAIT SWAPOUT  */
@RF00754 NI    OUCBTRM(OUCBPTR),B'10111111'                        0759
*       CALL EVTCHAP;               /* CHAP TO USER PRIORITY @YM05632*/
         BAL   @14,EVTCHAP                                         0760
*       RRPARI3=RESTORE;            /* RCT IS TO RESTORE ADDR SPACE  */
         MVI   RRPARI3(RRPAPTR),X'08'                              0761
*     END;                                                         0762
*   ELSE                            /* PREPARE TO SWAP-OUT THE MEMORY*/
*     DO;                                                          0763
*                                                                  0763
         B     @RC00752                                            0763
@RF00752 DS    0H                                                  0764
*       /*************************************************************/
*       /*                                                           */
*       /* IF THERE IS AN ACTIVE TRANSACTION IN THE MEMORY, INFORM   */
*       /* THE WORKLOAD MANAGER THAT THE MEMORY IS BEING SWAPPED OUT.*/
*       /* THE ACTIVE TRANSACTION WILL BE SUSPENDED UNTIL THE MEMORY */
*       /* IS SWAPPED IN AGAIN.                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0764
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */
*                                                                  0764
         TM    OUCBINC(OUCBPTR),B'00000001'                        0764
         BNO   @RF00764                                            0764
*         /***********************************************************/
*         /*                                                         */
*         /* ? IRACTLCL EPN(WMQ)                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0765
*         CALL RMSBWMQ->IRARMRTN;   /* INVOKE WMQ SUBRTN             */
         L     @15,RMSBWMQ(,RMCTPTR)                               0765
         BALR  @14,@15                                             0765
*       RFY                                                        0766
*         OUSBPTR RSTD;             /* NOW HOLD REGISTER     @ZA20975*/
@RF00764 DS    0H                                                  0767
*       OUSBPTR=ASXBOUSB;           /* ADDRESSABILITY TO OUSB        */
*                                                                  0767
         L     @12,ASXBPTR(,ASCBPTR)                               0767
         L     OUSBPTR,ASXBOUSB(,@12)                              0767
*       /*************************************************************/
*       /*                                                           */
*       /* ADD OUXB PAGE COUNTS FOR THE LAST IN-MAIN STORAGE INTERVAL*/
*       /* TO THE ACCUMULATORS IN THE OUSB.                          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0768
*       OUSBPIN=OUSBPIN+OUXBPIN;    /* NUMBER OF PAGE-INS            */
         L     @12,OUSBPIN(,OUSBPTR)                               0768
         AL    @12,OUXBPIN(,OUXBPTR)                               0768
         ST    @12,OUSBPIN(,OUSBPTR)                               0768
*       OUSBPOUT=OUSBPOUT+OUXBPOUT; /* NUMBER OF PAGE-OUTS           */
         L     @12,OUSBPOUT(,OUSBPTR)                              0769
         AL    @12,OUXBPOUT(,OUXBPTR)                              0769
         ST    @12,OUSBPOUT(,OUSBPTR)                              0769
*       OUSBPREC=OUSBPREC+OUXBPREC; /* NUMBER OF PAGE RECLAIMS       */
         L     @12,OUSBPREC(,OUSBPTR)                              0770
         AL    @12,OUXBPREC(,OUXBPTR)                              0770
         ST    @12,OUSBPREC(,OUSBPTR)                              0770
*       OUSBVAMI=OUSBVAMI+OUXBVAMI; /* NUMBER OF VAM PAGE-INS        */
         L     @12,OUSBVAMI(,OUSBPTR)                              0771
         AL    @12,OUXBVAMI(,OUXBPTR)                              0771
         ST    @12,OUSBVAMI(,OUSBPTR)                              0771
*       OUSBVAMO=OUSBVAMO+OUXBVAMO; /* NUMBER OF VAM PAGE-OUTS       */
         L     @12,OUSBVAMO(,OUSBPTR)                              0772
         AL    @12,OUXBVAMO(,OUXBPTR)                              0772
         ST    @12,OUSBVAMO(,OUSBPTR)                              0772
*       OUSBVAMR=OUSBVAMR+OUXBVAMR; /* NUMBER OF VAM PAGE-RECLAIMS   */
         L     @12,OUSBVAMR(,OUSBPTR)                              0773
         AL    @12,OUXBVAMR(,OUXBPTR)                              0773
         ST    @12,OUSBVAMR(,OUSBPTR)                              0773
*       OUSBCAPI=OUSBCAPI+OUXBCAPI; /* NUM OF COMMON PGIN    @Z30WIMG*/
         L     @12,OUSBCAPI(,OUSBPTR)                              0774
         AL    @12,OUXBCAPI(,OUXBPTR)                              0774
         ST    @12,OUSBCAPI(,OUSBPTR)                              0774
*       OUSBCAPR=OUSBCAPR+OUXBCAPR; /* NUM OF COMMON RCLM    @Z30WIMG*/
         L     @12,OUSBCAPR(,OUSBPTR)                              0775
         AL    @12,OUXBCAPR(,OUXBPTR)                              0775
         ST    @12,OUSBCAPR(,OUSBPTR)                              0775
*       OUSBSTCT=OUSBSTCT+OUXBSTCT; /* NUM OF STOLEN         @Z40BPJE*/
*                                                                  0776
         L     @12,OUSBSTCT(,OUSBPTR)                              0776
         AL    @12,OUXBSTCT(,OUXBPTR)                              0776
         ST    @12,OUSBSTCT(,OUSBPTR)                              0776
*       /*************************************************************/
*       /*                                                           */
*       /* INVOKE CPU LOAD BALANCING PROFILE ADJUSTMENT ROUTINE TO   */
*       /* RECALCULATE THE USER AND THE SYSTEM CPU USAGE PROFILE. ?  */
*       /* IRACTLCL EPN(CL0)                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0777
*       CALL RMSBCL0->IRARMRTN;     /* INVOKE CL0 SUBRTN             */
*                                                                  0777
         L     @15,RMSBCL0(,RMCTPTR)                               0777
         BALR  @14,@15                                             0777
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST I/O LOAD BALANCING BASE TIME OF DAY VALUE IN       */
*       /* CONJUNCTION WITH RESTORE COMPLETED TO ELIMINATE TIME USER */
*       /* SWAPPED OUT FROM RESOURCE USE CALCULATIONS.               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0778
*       OUXBITD=OUXBITD-RMCTTOD;                                   0778
*                                                                  0778
         L     @12,OUXBITD(,OUXBPTR)                               0778
         SL    @12,RMCTTOD(,RMCTPTR)                               0778
         ST    @12,OUXBITD(,OUXBPTR)                               0778
*       /*************************************************************/
*       /*                                                           */
*       /* QSCEFL DID NOT RECUR, SO RESET RECURSION FLAG.    @ZA29919*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0779
*       OUCBQSFL='0'B;              /*                       @ZA29919*/
*                                                                  0779
         NI    OUCBQSFL(OUCBPTR),B'11101111'                       0779
*       /*************************************************************/
*       /*                                                           */
*       /* TO PRESERVE THE INFORMATION KEPT IN THE OUXB WHILE THE    */
*       /* MEMORY IS OUT OF MAIN STORAGE(THE STORAGE OCCUPIED BY THE */
*       /* OUXB IS FREED DURING THE SWAPPED-OUT PERIOD), MOVE THE    */
*       /* DATA TO THE OUSB.                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0780
*       OUSBFLDS=OUXBFLDS;                                         0780
*                                                                  0780
         MVC   OUSBFLDS(80,OUSBPTR),OUXBFLDS(OUXBPTR)              0780
*       /*************************************************************/
*       /*                                                           */
*       /* CHANGE THE STATUS OF THE MEMORY TO OUT OF MAIN STORAGE AND*/
*       /* REPOSITON IT ON THE CORRECT OUT OF CORE QUEUE. THE MEMORY */
*       /* WILL NORMALLY BE POSITIONED ON THE OUT QUEUE. HOWEVER, IF */
*       /* THE MEMORY IS NOT RUNNABLE(IN LONG WAIT) OR AN AUX PAGE   */
*       /* SHORTAGE EXISTS, OR THE NUMBER OF FIXED FRAMES IS OVER A  */
*       /* THRESHOLD,THEN IT WILL BE PLACED ON THE WAIT QUEUE. THE   */
*       /* REQUEST IS PERFORMED INDIRECTLY THROUGH THE USER ACTION   */
*       /* REQUEST ROUTINE TO INSURE SRM CONTROL BLOCK INTEGRITY. THE*/
*       /* ENTRY POINT BLOCK DESCRIBING THE MEMORY STATUS CHANGE     */
*       /* ACTION ROUTINE IS PASSED TO THE USER ACTION REQUEST       */
*       /* ROUTINE AS INPUT. IF REQUIRED, THE USER ACTION REQUEST    */
*       /* ROUTINE QUEUES THE ACTION UNTIL ANY ASYNCHRONOUS SRM      */
*       /* PROCESSING HAS COMPLETED.                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0781
*       OUCBOUT='1'B;               /* MEMORY OUT OF MAIN STORAGE    */
         OI    OUCBOUT(OUCBPTR),B'00000100'                        0781
*       RMCAINUS=RMCAINUS-ONE;      /* DECREMENT NO. OF IN-CORE USERS*/
         LH    @12,RMCAINUS(,RMCTPTR)                              0782
         BCTR  @12,0                                               0782
         STH   @12,RMCAINUS(,RMCTPTR)                              0782
*       OUCBGOB='1'B;               /* RPS HAS BEEN INVOKED          */
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0783
*       IF OUCBAXS='1'B×            /* AUX PAGE SHORTAGE FORCED SWAP */
*           OUCBFXS='1'B×           /* REAL PAGE SHORTAGE    @Z40BPEB*/
*           OUCBJSAS='1'B×          /* JOB SELECT SWAP (AUX) @ZM43072*/
*           OUCBJSFS='1'B×          /* JOB SELECT SWAP (FIX) @ZM43072*/
*           (OUCBRDY='0'B&          /* NO USER READY SYSEVENT RCVD & */
*           RRPAWAIT=LONGWAIT) THEN /* MEMORY STILL IN LONG WAIT     */
         TM    OUCBAXS(OUCBPTR),B'00000101'                        0784
         BNZ   @RT00784                                            0784
         TM    OUCBJSAS(OUCBPTR),B'11000000'                       0784
         BNZ   @RT00784                                            0784
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0784
         BNZ   @RF00784                                            0784
         CLI   RRPAWAIT(RRPAPTR),X'80'                             0784
         BNE   @RF00784                                            0784
@RT00784 DS    0H                                                  0785
*         OUCBOFF='1'B;             /* PLACE MEMORY ON WAIT OUT QUEUE*/
         OI    OUCBOFF(OUCBPTR),B'00001000'                        0785
*       IF OUCBSRC>0&OUCBSRC<=LENGTH(RMCASRC)/4 THEN               0786
@RF00784 CLI   OUCBSRC(OUCBPTR),0                                  0786
         BNH   @RF00786                                            0786
         CLI   OUCBSRC(OUCBPTR),10                                 0786
         BH    @RF00786                                            0786
*         RMCASRCD(OUCBSRC)=RMCASRCD(OUCBSRC)+1;/* UPDATE THE      0787
*                                      APPROPRIATE SWAP OUT REASON 0787
*                                      CODE COUNTER          @Z40BPJE*/
*                                                                  0787
         SLR   @12,@12                                             0787
         IC    @12,OUCBSRC(,OUCBPTR)                               0787
         SLA   @12,2                                               0787
         LA    @15,1                                               0787
         AL    @15,RMCASRCD-4(@12,RMCTPTR)                         0787
         ST    @15,RMCASRCD-4(@12,RMCTPTR)                         0787
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(RPS)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0788
*       DO;                                                        0788
@RF00786 DS    0H                                                  0789
*         R1=ADDR(RMEPBRPS);        /* RPS REQUEST IS PARAM          */
         LA    R1,RMEPBRPS(,RMCTPTR)                               0789
*         CALL RMSBCRN->IRARMRTN;   /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0790
         BALR  @14,@15                                             0790
*       END;                                                       0791
*       RRPARI2=OUCBSRC;            /* PUT IN SWAP OUT REASON CODE 0792
*                                      FOR RETURN TO CALLER  @Z40BPJE*/
         IC    @12,OUCBSRC(,OUCBPTR)                               0792
         STC   @12,RRPARI2(,RRPAPTR)                               0792
*       RRPARI3=QSCECONT;           /* RCT IS TO CONTINUE QUIESCE    */
         MVI   RRPARI3(RRPAPTR),X'00'                              0793
*       OUCBQSC='1'B;               /* MARK QUIESCE PROCESS COMPLETE */
         OI    OUCBQSC(OUCBPTR),B'00000010'                        0794
*     END;                                                         0795
*   IF OUCBRDY='1'B THEN            /* IF USER READY SYSEVENT        */
@RC00752 TM    OUCBRDY(OUCBPTR),B'10000000'                        0796
         BNO   @RF00796                                            0796
*     DO;                           /* RECEIVED SINCE QUIESCE STARTED*/
*       RRPARI0=ZERO;               /* INDICATE TO RCT THAT A USER 0798
*                                      READY WAS RECEIVED            */
         MVI   RRPARI0(RRPAPTR),X'00'                              0798
*       ASCBOUTB='0'B;              /* ELIMINATE FURTHER USRRDYS     */
         L     @12,ASCBOUTB-2(,ASCBPTR)                            0799
@GL00033 LR    @15,@12                                             0799
         N     @15,@CF02704                                        0799
         CS    @12,@15,ASCBOUTB-2(ASCBPTR)                         0799
         BNE   @GL00033                                            0799
*     END;                                                         0800
*                                                                  0800
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0801
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0801
@RF00796 L     @12,RMEXCTL(,RMCTPTR)                               0801
         BR    @12                                                 0801
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0802
*   RESPECIFY                                                      0802
*    (OUXBPTR,                                                     0802
*     OUSBPTR) UNRSTD;              /*                       @Z30WIMG*/
*   RESPECIFY                                                      0803
*    (RTNREG,                                                      0803
*     NTRREG,                                                      0803
*     RETNCODE) RSTD;                                              0803
*IRARME14:                          /* SYSEVENT 14 - TRANSWAP      0804
*                                                            @ZA16887*/
*/* INITIATE THE TRANSITION OF AN ADDRESS SPACE FROM         @ZA16887*/
*/* SWAPPABLE TO NONSWAPPABLE.  BEGIN SWAPOUT OF THE ADDRESS @ZA16887*/
*/* SPACE AND SET INDICATORS THAT CAUSE ITS FRAMES TO BE     @ZA16887*/
*/* OBTAINED FROM PREFERRED STORAGE (RATHER THAN             @ZA16887*/
*/* RECONFIGURABLE STORAGE) WHEN IT IS SWAPPED BACK IN.      @ZA16887*/
*/* IF ECB ADDRESS IS PASSED IN REGISTER 1,                  @ZA16887*/
*/* SYSEVENT 15 (SWOUTCMP) WILL POST THE TRANSWAP ISSUER     @ZA16887*/
*/* THAT THE TRANSITION WAS SUCCESSFUL.                      @ZA16887*/
*                                                                  0804
*   RFY                                                            0804
*     OUXBPTR RSTD;                 /* HOLD REGISTER         @ZA16887*/
IRARME14 DS    0H                                                  0805
*   IF ASCBPTR=PSAAOLD THEN         /* MUST BE FOR CURRENT A.S     0805
*                                                            @ZA16887*/
         C     ASCBPTR,PSAAOLD                                     0805
         BNE   @RF00805                                            0805
*     IF OUCBNSW='0'B THEN          /* SWAPPABLE?            @ZA16887*/
         TM    OUCBNSW(OUCBPTR),B'10000000'                        0806
         BNZ   @RF00806                                            0806
*       DO;                         /* CONTINUE TRANSWAP     @ZA16887*/
*         OUXBPTR=ASCBOUXB;         /* GET ADDR OF OUXB      @ZA16887*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0808
*         IF OUCBTSWP='0'B THEN     /* NO OTHER TRANSWAP PENDING?  0809
*                                                            @ZA16887*/
         TM    OUCBTSWP(OUCBPTR),B'00010000'                       0809
         BNZ   @RF00809                                            0809
*           DO;                     /* OK TO BEGIN SWAPOUT   @ZA16887*/
*                                                                  0810
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(CSO)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0811
*             DO;                                                  0811
*               R1=ADDR(RMEPBCSO);  /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0812
*               CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT          */
         L     @15,RMSBCRY(,RMCTPTR)                               0813
         BALR  @14,@15                                             0813
*             END;                  /* INVOKE SWAPOUT ROUTINE      0814
*                                                            @ZA16887*/
*             IF RETNCODE=ZERO×     /* SWAPOUT WAS BEGUN OR A.S.   0815
*                                                            @ZA16887*/
*                 RETNCODE=CON8 THEN/* WAS TRANSITIONING     @ZA16887*/
         LTR   RETNCODE,RETNCODE                                   0815
         BZ    @RT00815                                            0815
         C     RETNCODE,@CF00152                                   0815
         BNE   @RF00815                                            0815
@RT00815 DS    0H                                                  0816
*               DO;                 /* CONTINUE TRANSWAP     @ZA16887*/
*                 IF ASCBN2LP='0'B THEN/* TURN ON BOTH PREF  @ZA16887*/
         TM    ASCBN2LP(ASCBPTR),B'00100000'                       0817
         BNZ   @RF00817                                            0817
*                   DO;             /* STORAGE BITS,         @ZA16887*/
*                     ASCB1LPU='1'B;/* 1ST LEVEL AND         @ZA16887*/
*                     ASCB2LPU='1'B;/* 2ND LEVEL             @ZA16887*/
         L     @12,ASCB1LPU(,ASCBPTR)                              0820
@GL00035 LR    @07,@12                                             0820
         O     @07,@CF02707                                        0820
         CS    @12,@07,ASCB1LPU(ASCBPTR)                           0820
         BNE   @GL00035                                            0820
*                   END;                                           0821
*                 ELSE              /* OTHERWISE,            @ZA16887*/
*                   ASCB1LPU='1'B;  /* ONLY 1ST LEVEL        @ZA16887*/
         B     @RC00817                                            0822
@RF00817 L     @12,ASCB1LPU(,ASCBPTR)                              0822
@GL00036 LR    @07,@12                                             0822
         O     @07,@CF02710                                        0822
         CS    @12,@07,ASCB1LPU(ASCBPTR)                           0822
         BNE   @GL00036                                            0822
*                 OUCBTSWP='1'B;    /* TRANSWAP IS PENDING   @ZA16887*/
@RC00817 OI    OUCBTSWP(OUCBPTR),B'00010000'                       0823
*                 OUXBTSW=RRPAINP;  /* STORE ECB ADDR, IF ANY      0824
*                                                            @ZA16887*/
         L     @12,RRPAINP(,RRPAPTR)                               0824
         ST    @12,OUXBTSW(,OUXBPTR)                               0824
*                 IF RETNCODE=ZERO THEN/* SWAP OUT WAS BEGUN @ZA16887*/
         LTR   RETNCODE,RETNCODE                                   0825
         BNZ   @RF00825                                            0825
*                   DO;             /* SO FINISH TRANSWAP PROCESS  0826
*                                                            @ZA16887*/
*                     OUCBLWT='0'B; /* RESET LONG            @ZA16887*/
*                     OUCBMWT='0'B; /* WAIT FLAGS            @ZA16887*/
*                     OUCBTRM='0'B; /* INDICATE NO TERMWAIT SWAPOUT
*                                                            @ZA16887*/
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0829
*                     OUCBSRC=SRCDRQSC;/* COUNT AS REQSWAP   @ZA16887*/
         MVI   OUCBSRC(OUCBPTR),X'07'                              0830
*                     IF RRPASVC='1'B THEN/* IF SVC ENTRY TO SRM,  0831
*                                                            @ZA16887*/
         TM    RRPASVC(RRPAPTR),B'00100000'                        0831
         BNO   @RF00831                                            0831
*                       RRPARTN=CVTEXP1;/* FORCE EXIT THRU DISPATCHER
*                                      TO ALLOW SWAPOUT TO RUN     0832
*                                                            @ZA16887*/
         L     @12,CVTPTR                                          0832
         L     @12,CVTEXP1(,@12)                                   0832
         ST    @12,RRPARTN(,RRPAPTR)                               0832
*                   END;            /* END RC=0 CASE         @ZA16887*/
*               END;                /* END RC=0 OR 8 CASE    @ZA16887*/
*             ELSE                  /* RC=4 FROM SWAP OUT    @ZA16887*/
*               DO;                 /* MEANS INVALID SRM DATA      0835
*                                                            @ZA16887*/
         B     @RC00815                                            0835
@RF00815 DS    0H                                                  0836
*                 RESNCODE=CON24;   /* ABEND 15F RC=24       @ZA16887*/
*                                                                  0836
         LA    RESNCODE,24                                         0836
*                 /***************************************************/
*                 /*                                                 */
*                 /* ? IRACTLCL EPN(I10)                             */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0837
*                 CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT        */
*                                                                  0837
         L     @15,RMSBI10(,RMCTPTR)                               0837
         BALR  @14,@15                                             0837
*                 /***************************************************/
*                 /*                                                 */
*                 /* FRR WILL CONVERT TO 25F ABEND           @ZA16887*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0838
*               END;                /* END RC=4 CASE         @ZA16887*/
*           END;                    /*                       @ZA16887*/
*         ELSE                      /* ANOTHER TRANSWAP WAS PENDING
*                                                            @ZA16887*/
*           DO;                     /* INVOKE SUBROUTINE     @ZA20975*/
         B     @RC00809                                            0840
@RF00809 DS    0H                                                  0841
*             R1=ADDR(OUXBTSW);     /* TO STORE ECB ADDR     @ZA20975*/
         LA    R1,OUXBTSW(,OUXBPTR)                                0841
*             CALL EVTSTACK;        /* IF ONE IS SPEC'D.     @ZA20975*/
         BAL   @14,EVTSTACK                                        0842
*             OUCBNTSP=OUCBNTSP+ONE;/* COUNT PENDING TRANSWAPS (USED
*                                      BY UXB AT SWOUTCMP)   @ZA16887*/
         LA    @12,1                                               0843
         AH    @12,OUCBNTSP(,OUCBPTR)                              0843
         STH   @12,OUCBNTSP(,OUCBPTR)                              0843
*           END;                    /* END PENDING CASE      @ZA20975*/
*         RRPARI3=ZERO;             /* NORMAL TRANSWAP       @ZA16887*/
@RC00809 MVI   RRPARI3(RRPAPTR),X'00'                              0845
*       END;                        /* END SWAPPABLE CASE    @ZA16887*/
*     ELSE                          /* A.S. IS NONSWAPPABLE  @ZA16887*/
*       IF OUCBTSWC='1'B THEN       /* TRANSWAP ALREADY DONE @ZA16887*/
         B     @RC00806                                            0847
@RF00806 TM    OUCBTSWC(OUCBPTR),B'00001000'                       0847
         BNO   @RF00847                                            0847
*         DO;                       /* ADD ON THIS TRANSWAP  @ZA16887*/
*           OUCBNDS=OUCBNDS+ONE;    /* INCR NONSWAP COUNT    @ZA16887*/
         LA    @12,1                                               0849
         AH    @12,OUCBNDS(,OUCBPTR)                               0849
         STH   @12,OUCBNDS(,OUCBPTR)                               0849
*           IF OUCBNDS<ZERO THEN    /* COUNT WRAPPED?        @ZA16887*/
         LH    @12,OUCBNDS(,OUCBPTR)                               0850
         LTR   @12,@12                                             0850
         BNM   @RF00850                                            0850
*             OUCBNDS=CON32767;     /* SET TO MAX VALUE      @ZA16887*/
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         0851
*           IF OUCBNDS=ONE THEN     /* SWAP STATUS CHNGD?    @ZA16887*/
*                                                                  0852
@RF00850 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         0852
         BNE   @RF00852                                            0852
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(WMK)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0853
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */
*                                                                  0853
         L     @15,RMSBWMK(,RMCTPTR)                               0853
         BALR  @14,@15                                             0853
*           /*********************************************************/
*           /*                                                       */
*           /* LET WLM KNOW                                  @ZA16887*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0854
*           RRPARI3=CON4;           /* TELL ISSUER TRANSWAP ALREADY
*                                      ISSUED                @ZA16887*/
@RF00852 MVI   RRPARI3(RRPAPTR),X'04'                              0854
*         END;                      /* END DUPL TRANSWAP CASE      0855
*                                                            @ZA16887*/
*       ELSE                        /* DONTSWAP WAS ISSUED   @ZA16887*/
*         DO;                       /* PRIOR TO TRANSWAP     @ZA16887*/
         B     @RC00847                                            0856
@RF00847 DS    0H                                                  0857
*           RETNCODE=ZERO;          /* ABEND ISSUER WITH 35F @ZA16887*/
         SLR   RETNCODE,RETNCODE                                   0857
*           COMPCODE=CODE35F;       /*                       @ZA16887*/
         LA    COMPCODE,863                                        0858
*           CALL EVTABEND;          /*                       @ZA16887*/
         BAL   @14,EVTABEND                                        0859
*         END;                      /*                       @ZA16887*/
*   ELSE                            /* TRANSWAP WAS ISSUED FOR     0861
*                                                            @ZA16887*/
*     DO;                           /* A.S. OTHER THAN CURRENT     0861
*                                                            @ZA16887*/
         B     @RC00805                                            0861
@RF00805 DS    0H                                                  0862
*       RESNCODE=CON4;              /* ABEND ISSUER WITH 15F RC=4  0862
*                                                            @ZA16887*/
*                                                                  0862
         LA    RESNCODE,4                                          0862
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I10)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0863
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */
*                                                                  0863
         L     @15,RMSBI10(,RMCTPTR)                               0863
         BALR  @14,@15                                             0863
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID INPUT TO SRM                              @ZA16887*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0864
*     END;                          /*                       @ZA16887*/
*/*  ? IRACTLCL EPN(CTL)                                             */
*                                                                  0865
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0865
@RC00805 L     @12,RMEXCTL(,RMCTPTR)                               0865
         BR    @12                                                 0865
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT TO CONTROL                                       @ZA16887*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0866
*   RFY                                                            0866
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/
*IRARME15:                          /* SYSEVENT 15 - SWOUTCMP        */
*/*                                                                  */
*/*    REMOVE ANY ERROR IN CURRENT SWAP OUT COUNT DUE TO DIFFERENCE  */
*/*    IN NUMBER OF FRAMES FREED BY SWAP AND NUMBER EXPECTED TO BE   */
*/*    FREED                                                         */
*/*                                                                  */
*                                                                  0867
*   OUCBPSO=SWOPGCNT;               /* SAVE NO. OF PAGES SWAPPED-OUT */
IRARME15 L     @12,RRPAINP(,RRPAPTR)                               0867
         LH    @11,SWOPGCNT(,@12)                                  0867
         STH   @11,OUCBPSO(,OUCBPTR)                               0867
*   OUCBWSS=SWIWSS;                 /* SAVE WORKING SET SIZE         */
         LH    @12,SWIWSS(,@12)                                    0868
         STH   @12,OUCBWSS(,OUCBPTR)                               0868
*/*                                                                  */
*/*   RELEASE OUXB STORAGE.                                          */
*/*                                                                  */
*                                                                  0869
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(UXB)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0869
*   DO;                                                            0869
*     R1=ADDR(RMEPBUXB);            /* UXB REQUEST IS PARAM          */
         LA    R1,RMEPBUXB(,RMCTPTR)                               0870
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0871
         BALR  @14,@15                                             0871
*   END;                                                           0872
*   IF OUCBRDY^='1'B×               /* IF MEMORY NOT SWAPPED-OUT BY  */
*       OUCBPVL='1'B THEN           /* ANALYSIS, OR MEMORY IS      0873
*                                      PRIVILEGED            @Z40BPJE*/
*                                                                  0873
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0873
         BNO   @RT00873                                            0873
         TM    OUCBPVL(OUCBPTR),B'00000100'                        0873
         BNO   @RF00873                                            0873
@RT00873 DS    0H                                                  0874
*     /***************************************************************/
*     /*                                                             */
*     /* ? IRACTLCL EPN(CAP)                                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0874
*     DO;                                                          0874
*       R1=ADDR(RMEPBCAP);          /* CAP REQUEST IS PARAM          */
         LA    R1,RMEPBCAP(,RMCTPTR)                               0875
*       CALL RMSBCRL->IRARMRTN;     /* ALGRTHM SCH FUNCT             */
         L     @15,RMSBCRL(,RMCTPTR)                               0876
         BALR  @14,@15                                             0876
*     END;                                                         0877
*   IF SWOWRSM='1'B THEN            /* MEMORY WAITING ON RSM SERVICE */
@RF00873 L     @12,RRPAINP(,RRPAPTR)                               0878
         TM    SWOWRSM(@12),B'00000001'                            0878
         BNO   @RF00878                                            0878
*     DO;                           /*                               */
*       OUCBRSMB='1'B;              /* SET RSM SERVICE READY FLAG    */
         L     @12,OUCBRSMB-2(,OUCBPTR)                            0880
@GL00038 LR    @11,@12                                             0880
         O     @11,@CF02713                                        0880
         CS    @12,@11,OUCBRSMB-2(OUCBPTR)                         0880
         BNE   @GL00038                                            0880
*       IF OUCBRDY='0'B THEN        /* IF MEMORY NOT MARKED READY    */
         TM    OUCBRDY(OUCBPTR),B'10000000'                        0881
         BNZ   @RF00881                                            0881
*         CALL IRARME04;            /* MAKE MEMORY ELIGIBLE FOR      */
         BAL   @14,IRARME04                                        0882
*     END;                          /* SWAP IN                       */
*                                                                  0883
@RF00881 DS    0H                                                  0884
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0884
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  0884
@RF00878 L     @12,RMEXI01(,RMCTPTR)                               0884
         BR    @12                                                 0884
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INVOKER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0885
*IRARME16:                          /* EVENT 16 - SWINSTAT   @Z40BPEB*/
*/*  THIS SYSEVENT HAS TWO REASON CODES:                             */
*/*      1 - SWAP IN PROCESS HAS STARTED                             */
*/*      2 - SWAP IN PROCESS HAS COMPLETED (STAGE ONE)               */
*/*   THIS IS A NO-OP FOR RELEASE 4,JUST PROVIDES FOR GTF TRACING    */
*/*                                                                  */
*                                                                  0885
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0885
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  0885
IRARME16 L     @12,RMEXI01(,RMCTPTR)                               0885
         BR    @12                                                 0885
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INVOKER                                     @Z40BPEB*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0886
*IRARME17:                          /* SYSEVENT 17 - SWINFL          */
*   OUCBGOI='0'B;                   /* MEMORY NO LONGER TRANSITIONING
*                                      INTO MAIN STORAGE             */
IRARME17 NI    OUCBGOI(OUCBPTR),B'10111111'                        0886
*   RMCACIUS=RMCACIUS-ONE;          /* SUBTR FM SWAPIN COUNT @Z30WIMG*/
         LH    @12,RMCACIUS(,RMCTPTR)                              0887
         BCTR  @12,0                                               0887
         STH   @12,RMCACIUS(,RMCTPTR)                              0887
*   OUCBGOB='1'B;                   /* RPS BEING INVOKED             */
*                                                                  0888
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0888
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(RPS)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0889
*   DO;                                                            0889
*     R1=ADDR(RMEPBRPS);            /* RPS REQUEST IS PARAM          */
         LA    R1,RMEPBRPS(,RMCTPTR)                               0890
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0891
         BALR  @14,@15                                             0891
*   END;                            /* REQUEUE MEMORY FOR SWAP ANLZ  */
*   IF ASCBOUXB^=RMCTOUXB&          /* CANNOT FREE PREDEFINED@ZA00250*/
*       OUCBOUT='1'B THEN           /* OUXB OR OUXB OF USER WHO IS 0893
*                                      NOT OUT OF MAIN STORAGE     0893
*                                                            @ZA00250*/
         L     @12,ASCBOUXB(,ASCBPTR)                              0893
         C     @12,RMCTOUXB(,RMCTPTR)                              0893
         BE    @RF00893                                            0893
         TM    OUCBOUT(OUCBPTR),B'00000100'                        0893
         BNO   @RF00893                                            0893
*     DO;                           /*                       @ZA00250*/
*       R0=LENGTH(OUXB);            /* LENGTH OF STOAGE AREA @ZA00250*/
         LA    R0,144                                              0895
*       R1=ASCBOUXB;                /* STORAGE AREA ADDRESS  @ZA00250*/
*                                                                  0896
         LR    R1,@12                                              0896
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZA00250*/
*       /* FREE STORAGE                                      @ZA00250*/
*       /*                                                   @ZA00250*/
*       /* ? IRACTLCL EPN(I04)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0897
*       CALL RMSBI04->IRARMRTN;     /* INVOKE I04 SUBRTN             */
*                                                                  0897
         L     @15,RMSBI04(,RMCTPTR)                               0897
         BALR  @14,@15                                             0897
*       /*************************************************************/
*       /*                                                           */
*       /*                                                   @ZA00250*/
*       /*                                                   @ZA00250*/
*       /* PROVIDE DUMMY AREA FOR OUXB TO PREVENT DESTRUCTION        */
*       /*                                                   @ZA00250*/
*       /* OF VALID INFORMATION IF AN ATTEMPT TO REFERENCE   @ZA00250*/
*       /* OUXB OCCURS WHILE THE MEMORY IS SWAPPED OUT.      @ZA00250*/
*       /*                                                   @ZA00250*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0898
*       ASCBOUXB=RMCTOUXB;          /*                       @ZA00250*/
         L     @12,RMCTOUXB(,RMCTPTR)                              0898
         ST    @12,ASCBOUXB(,ASCBPTR)                              0898
*     END;                          /*                       @ZA00250*/
*                                                                  0899
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0900
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  0900
@RF00893 L     @12,RMEXCTL(,RMCTPTR)                               0900
         BR    @12                                                 0900
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0901
*IRARME18:                          /* SYSEVENT 18 - QSCEFL          */
*   OUCBPSTR='0'B;                  /* RESET XMPOST ERROR FLAG THAT
*                                      WAS SET BY CSO        @ZA16887*/
IRARME18 NI    OUCBPSTR(OUCBPTR),B'11110111'                       0901
*   CALL EVTCHAP;                   /* CHAP TO USER PRIORITY @YM05632*/
         BAL   @14,EVTCHAP                                         0902
*IRARME19:                          /* SYSEVENT 19 - RSTORCMP        */
*   RESPECIFY                                                      0903
*    (RTNREG,                                                      0903
*     RTNREG,                                                      0903
*     NTRREG) UNRSTD;                                              0903
IRARME19 DS    0H                                                  0904
*   RESPECIFY                                                      0904
*    (OUXBPTR,                                                     0904
*     OUSBPTR,                                                     0904
*     RESNCODE) RSTD;               /*                       @ZA16887*/
*   OUXBPTR=ASCBOUXB;               /* ADDRESSABILITY TO OUXB        */
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          0905
*   OUSBPTR=ASXBOUSB;               /* ADDRESSABILITY TO OUSB        */
         L     @14,ASXBPTR(,ASCBPTR)                               0906
         L     OUSBPTR,ASXBOUSB(,@14)                              0906
*   IF OUCBGOI='1'B THEN            /* MEMORY WAS SWAPPED OUT        */
         TM    OUCBGOI(OUCBPTR),B'01000000'                        0907
         BNO   @RF00907                                            0907
*     DO;                                                          0908
*                                                                  0908
*       /*************************************************************/
*       /*                                                           */
*       /* UPDATE THE SWAP ACCUMULATORS IN THE OUSB TO INCLUDE THE   */
*       /* NUMBER OF PAGES SWAPPED IN AND OUT.                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0909
*       OUSBSPIN=OUSBSPIN+          /* NUMBER OF PAGES SWAPPED IN    */
*           OUCBWSS;                                               0909
         LH    @14,OUCBWSS(,OUCBPTR)                               0909
         AL    @14,OUSBSPIN(,OUSBPTR)                              0909
         ST    @14,OUSBSPIN(,OUSBPTR)                              0909
*       OUSBSPOT=OUSBSPOT+          /* NUMBER OF PAGES SWAPPED OUT   */
*           OUCBPSO;                                               0910
         LH    @14,OUCBPSO(,OUCBPTR)                               0910
         AL    @14,OUSBSPOT(,OUSBPTR)                              0910
         ST    @14,OUSBSPOT(,OUSBPTR)                              0910
*       OUSBSWCT=OUSBSWCT+ONE;      /* NO. OF TIMES MEMORY SWAPPED   */
         LA    @14,1                                               0911
         AL    @14,OUSBSWCT(,OUSBPTR)                              0911
         ST    @14,OUSBSWCT(,OUSBPTR)                              0911
*       RMCACIUS=RMCACIUS-ONE;      /* SUBTR FM SWAPIN COUNT @Z30WIMG*/
         LH    @14,RMCACIUS(,RMCTPTR)                              0912
         BCTR  @14,0                                               0912
         STH   @14,RMCACIUS(,RMCTPTR)                              0912
*     END;                                                         0913
*                                                                  0913
*/*                                                                  */
*/*   MEMORY NO LONGER TRANSITIONING INTO OR OUT OF MAIN STORAGE.    */
*/*   RESET SWAP STATUS INDICATORS.                                  */
*/*   NOTE:  A SWAP OUT REQUEST AGAINST THIS MEMORY IS NOW VALID.    */
*/*                                                                  */
*                                                                  0914
*   OUCBSRC=ZERO;                   /* RESET SWAPOUT REASON CODE   0914
*                                                            @Z40BPJE*/
@RF00907 MVI   OUCBSRC(OUCBPTR),X'00'                              0914
*   OUCBGOO='0'B;                                                  0915
*   OUCBGOI='0'B;                                                  0916
*   OUCBOFF='0'B;                                                  0917
*   OUCBOUT='0'B;                   /* RESET MEMORY OUT OF STORGE IND*/
         NI    OUCBGOO(OUCBPTR),B'00110011'                        0918
*   IF OUCBQSC='1'B THEN            /* QUIESCE COMPLETED SYSEVENT  0919
*                                      PROCESSED, PERFORM NORMAL RES-
*                                      TORE COMPLETED PROCESSING     */
         TM    OUCBQSC(OUCBPTR),B'00000010'                        0919
         BNO   @RF00919                                            0919
*     DO;                                                          0920
*                                                                  0920
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE THE INFORMATION SAVED AT THE PREVIOUS QUIESCE COMP-  */
*       /* LETED SYSEVENT FROM THE OUSB TO THE OUXB.                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0921
*       OUXBFLDS=OUSBFLDS;                                         0921
*                                                                  0921
         MVC   OUXBFLDS(80,OUXBPTR),OUSBFLDS(OUSBPTR)              0921
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST START TIME OF I/O MONITORING INTERVAL IN           */
*       /* CONJUNCTION WITH QUIESCE COMPLETE TO REFLECT SWAPPED OUT  */
*       /* TIME PERIOD.                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0922
*       OUXBITD=OUXBITD+RMCTTOD;                                   0922
*                                                                  0922
         L     @14,OUXBITD(,OUXBPTR)                               0922
         AL    @14,RMCTTOD(,RMCTPTR)                               0922
         ST    @14,OUXBITD(,OUXBPTR)                               0922
*       /*************************************************************/
*       /*                                                           */
*       /* CALCULATE USER EXECUTION TIME IN 1.024 MILLISECONDS.      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0923
*       RESPECIFY                                                  0923
*        (EJST1,                    /* RESTRICT REGISTERS USED IN THE*/
*         EJST2)                    /* CALCULATION OF USER EXECUTION */
*             RSTD;                 /* TIME                          */
*       GENERATE CODE REFS(ASCBEJST,ASCBPTR,EJST1,EJST2);          0924
         LM    EJST1,EJST2,ASCBEJST(ASCBPTR)
         SRDL  EJST1,MILLISEC
MILLISEC EQU   22                      CONVERT MICRO TO 1.024 MILLIS
*       OUXBPET=EJST2;              /* SAVE TASK PORTION OF CPU TIME */
         ST    EJST2,OUXBPET(,OUXBPTR)                             0925
*       GENERATE CODE REFS(ASCBSRBT);                              0926
         LM    EJST1,EJST2,ASCBSRBT(ASCBPTR)
         SRDL  EJST1,MILLISEC
*       OUXBPET=OUXBPET+EJST2;      /* SAVE SRB PORTION OF TIME      */
         LR    @14,EJST2                                           0927
         AL    @14,OUXBPET(,OUXBPTR)                               0927
         ST    @14,OUXBPET(,OUXBPTR)                               0927
*       OUXBSTC=ZERO;               /* BASE STEAL COUNT              */
         SLR   @12,@12                                             0928
         STH   @12,OUXBSTC(,OUXBPTR)                               0928
*       RESPECIFY                                                  0929
*        (EJST1,                    /* CALCULATIONS COMPLETE, RETURN */
*         EJST2)                    /* USE OF REGISTERS TO COMPILER  */
*             UNRSTD;                                              0929
*       IF OUCBINC='1'B             /* IF A NEW TSO TRANSACTION IS   */
*           &OUCBATR='0'B THEN      /* ABOUT TO BEGIN                */
         TM    OUCBINC(OUCBPTR),B'00000001'                        0930
         BNO   @RF00930                                            0930
         TM    OUCBATR(OUCBPTR),B'10000000'                        0930
         BNZ   @RF00930                                            0930
*         DO;                       /* THEN                          */
*           OUXBAET=OUXBPET;        /* RESET APG PRIORITY            */
         ST    @14,OUXBAET(,OUXBPTR)                               0932
*           OUXBWCT=ASCBSWCT;       /* COMPUTATION BASE VALUES       */
         LH    @14,ASCBSWCT(,ASCBPTR)                              0933
         STH   @14,OUXBWCT(,OUXBPTR)                               0933
*           OUCBCPL='0'B;           /* RESET SIGNIFICANT CPU USER FLG*/
         NI    OUCBCPL(OUCBPTR),B'11101111'                        0934
*         END;                                                     0935
*                                                                  0935
*       /*************************************************************/
*       /*                                                           */
*       /* RESUME AN ACTIVE TRANSACTION IN THE MEMORY.               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0936
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */
*                                                                  0936
@RF00930 TM    OUCBINC(OUCBPTR),B'00000001'                        0936
         BNO   @RF00936                                            0936
*         /***********************************************************/
*         /*                                                         */
*         /* ? IRACTLCL EPN(WMR)                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0937
*         CALL RMSBWMR->IRARMRTN;   /* INVOKE WMR SUBRTN             */
*                                                                  0937
         L     @15,RMSBWMR(,RMCTPTR)                               0937
         BALR  @14,@15                                             0937
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE ASM SHORTAGE MONITORING FIELDS                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0938
*       OUXBVSC=ASCBVSC;            /* BASE VAM SLOT COUNT           */
@RF00936 LH    @14,ASCBVSC(,ASCBPTR)                               0938
         STH   @14,OUXBVSC(,OUXBPTR)                               0938
*       OUXBNVC=ASCBNVSC;           /* BASE NON-VAM SLOT COUNT       */
         LH    @14,ASCBNVSC(,ASCBPTR)                              0939
         STH   @14,OUXBNVC(,OUXBPTR)                               0939
*       OUXBSTD=RMCTTOD;            /* BASE TIME OF DAY              */
         L     @14,RMCTTOD(,RMCTPTR)                               0940
         ST    @14,OUXBSTD(,OUXBPTR)                               0940
*       RMCAINUS=RMCAINUS+ONE;      /* INCREMENT NO. OF IN-CORE USERS*/
         LA    @14,1                                               0941
         AH    @14,RMCAINUS(,RMCTPTR)                              0941
         STH   @14,RMCAINUS(,RMCTPTR)                              0941
*       OUCBQSC='0'B;               /* RESET QUIESCE COMPLETED     0942
*                                      SYSEVENT PROCESSED FLAG       */
         NI    OUCBQSC(OUCBPTR),B'11111101'                        0942
*     END;                                                         0943
*   ELSE                            /* SWAPOUT NOT PERFORMED         */
*     RRPAWAIT=ZERO;                /* RESET WAIT STATE INDICATOR    */
*                                                                  0944
         B     @RC00919                                            0944
@RF00919 MVI   RRPAWAIT(RRPAPTR),X'00'                             0944
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A TRANSWAP AND/OR REQSWAP IS PENDING, IMMEDIATELY SWAP THE */
*   /* A.S. BACK OUT WITH THE APPROPRIATE REASON CODE.       @ZA16887*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0945
*   IF OUCBRSWP='1'B×OUCBTSWP='1'B THEN/* TRANS OR REQSWAP PENDING 0945
*                                                            @ZA16887*/
@RC00919 TM    OUCBRSWP(OUCBPTR),B'00110000'                       0945
         BZ    @RF00945                                            0945
*     IF RRPACOD=SYSEVT19 THEN      /* THIS IS RSTORCMP,     @ZA29919*/
         CLI   RRPACOD(RRPAPTR),19                                 0946
         BNE   @RF00946                                            0946
*       DO;                         /* FINISH IT NOW         @ZA16887*/
*                                                                  0947
*         /***********************************************************/
*         /*                                                         */
*         /* ? IRACTLCL EPN(CSO)                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0948
*         DO;                                                      0948
*           R1=ADDR(RMEPBCSO);      /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0949
*           CALL RMSBCRY->IRARMRTN; /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0950
         BALR  @14,@15                                             0950
*         END;                      /* INVOKE SWAPOUT ROUTINE      0951
*                                                            @ZA16887*/
*         IF RETNCODE=ZERO THEN     /* SWAPOUT WAS BEGUN     @ZA16887*/
         LTR   RETNCODE,RETNCODE                                   0952
         BNZ   @RF00952                                            0952
*           DO;                     /* CONTINUE TRANS OR REQSWAP   0953
*                                                            @ZA16887*/
*             OUCBLWT='0'B;         /* RESET LONG            @ZA16887*/
*             OUCBMWT='0'B;         /* WAIT FLAGS            @ZA16887*/
*             OUCBTRM='0'B;         /* INDICATE NO TERMWAIT SWAPOUT
*                                                            @ZA16887*/
         NI    OUCBLWT(OUCBPTR),B'00111110'                        0956
*             OUCBSRC=SRCDRQSC;     /* SET REASON CODE       @ZA16887*/
         MVI   OUCBSRC(OUCBPTR),X'07'                              0957
*             IF RRPASVC='1'B THEN  /* IF SVC ENTRY TO SRM   @ZA16887*/
         TM    RRPASVC(RRPAPTR),B'00100000'                        0958
         BNO   @RF00958                                            0958
*               RRPARTN=CVTEXP1;    /* FORCE EXIT THRU DISPATCHER  0959
*                                                            @ZA16887*/
         L     @14,CVTPTR                                          0959
         L     @14,CVTEXP1(,@14)                                   0959
         ST    @14,RRPARTN(,RRPAPTR)                               0959
*           END;                    /* TO ALLOW SWAPOUT TO RUN     0960
*                                                            @ZA16887*/
*         ELSE                      /* SWAPOUT NOT BEGUN     @ZA16887*/
*           DO;                     /* INVALID SRM CONTROL BLOCKS  0961
*                                                            @ZA16887*/
         B     @RC00952                                            0961
@RF00952 DS    0H                                                  0962
*             RESNCODE=CON24;       /* ABEND 15F RC=24       @ZA16887*/
*                                                                  0962
         LA    RESNCODE,24                                         0962
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(I10)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0963
*             CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT            */
*                                                                  0963
         L     @15,RMSBI10(,RMCTPTR)                               0963
         BALR  @14,@15                                             0963
*             /*******************************************************/
*             /*                                                     */
*             /* FRR WILL CONVERT TO 25F                     @ZA16887*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0964
*           END;                    /*                       @ZA16887*/
*       END;                        /* END RSTORCMP CASE     @ZA29919*/
*     ELSE                          /* THIS IS QSCEFL,       @ZA29919*/
*                                                                  0966
*       /*************************************************************/
*       /*                                                           */
*       /* IF A SYSEVENT QSCEFL OCCURS WHEN A REQUESTED SWAP OR A    */
*       /* TRANSITION-TO-NONSWAPPABLE SWAP IS PENDING, TRY THE SWAP  */
*       /* AGAIN. IF QUIESCE FAILS A SECOND TIME, ABEND RCT WITH CODE*/
*       /* 45F TO PREVENT THE ISSUER FROM WAITING FOREVER FOR THE    */
*       /* SWAP TO COMPLETE AND TO PREVENT POSSIBLE MISUSE OF        */
*       /* RECONFIGURABLE OR V=R STORAGE FRAMES.             @ZA29919*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0966
*       IF OUCBQSFL='0'B THEN       /* FIRST QSCEFL?         @ZA29919*/
         B     @RC00946                                            0966
@RF00946 TM    OUCBQSFL(OUCBPTR),B'00010000'                       0966
         BNZ   @RF00966                                            0966
*         DO;                       /* TRY SWAP OUT AGAIN    @ZA29919*/
*                                                                  0967
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(CSO)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0968
*           DO;                                                    0968
*             R1=ADDR(RMEPBCSO);    /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0969
*             CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT            */
         L     @15,RMSBCRY(,RMCTPTR)                               0970
         BALR  @14,@15                                             0970
*           END;                    /* INITIATE SWAP OUT     @ZA29919*/
*           IF RTNCOD=ZERO THEN     /* SWAP OUT WAS BEGUN    @ZA29919*/
         LTR   RTNCOD,RTNCOD                                       0972
         BNZ   @RF00972                                            0972
*             DO;                   /*                       @ZA29919*/
*               OUCBQSFL='1'B;      /* PREVENT RECURSION (BIT IS   0974
*                                      RESET AT QSCECMP)     @ZA29919*/
         OI    OUCBQSFL(OUCBPTR),B'00010000'                       0974
*               OUCBSRC=SRCDRQSC;   /* REASON CODE IS SAME FOR     0975
*                                      REQSWAP OR TRANSWAP   @ZA29919*/
         MVI   OUCBSRC(OUCBPTR),X'07'                              0975
*             END;                  /* END SWAP RETRY CASE   @ZA29919*/
*           ELSE                    /* SWAP OUT NOT POSSIBLE @ZA29919*/
*             DO;                   /* ABEND RCT             @ZA29919*/
         B     @RC00972                                            0977
@RF00972 DS    0H                                                  0978
*               RETNCODE=ZERO;      /* PREPARE INPUT         @ZA29919*/
         SLR   RETNCODE,RETNCODE                                   0978
*               COMPCODE=CODE45F;   /* REGISTERS FOR ABEND   @ZA29919*/
         LA    COMPCODE,1119                                       0979
*               CALL EVTABEND;      /* ISSUE ABEND 45F       @ZA29919*/
         BAL   @14,EVTABEND                                        0980
*             END;                  /*                       @ZA29919*/
*         END;                      /*                       @ZA29919*/
*       ELSE                        /* QSCEFL IS RECURSIVE,  @ZA29919*/
*         DO;                       /* ABEND RCT             @ZA29919*/
         B     @RC00966                                            0983
@RF00966 DS    0H                                                  0984
*           RETNCODE=ZERO;          /* PREPARE INPUT         @ZA29919*/
         SLR   RETNCODE,RETNCODE                                   0984
*           COMPCODE=CODE45F;       /* REGISTERS FOR ABEND   @ZA29919*/
         LA    COMPCODE,1119                                       0985
*           CALL EVTABEND;          /* ISSUE ABEND 45F       @ZA29919*/
         BAL   @14,EVTABEND                                        0986
*         END;                      /*                       @ZA29919*/
*                                                                  0987
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CONTINUE WITH RESTORE PROCESSING.                 @ZA29919*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0988
*   OUCBQSS='0'B;                   /* RESET QUIESCE STARTED SYSEVENT
*                                      PROCESSED FLAG                */
@RC00966 DS    0H                                                  0988
@RC00946 DS    0H                                                  0988
@RF00945 NI    OUCBQSS(OUCBPTR),B'11111011'                        0988
*/*                                                                  */
*/*   CHANGE THE CURRENT STATUS OF THE MEMORY FROM OUT OF MAIN STOR- */
*/*   AGE TO IN MAIN STORAGE.                                        */
*/*                                                                  */
*                                                                  0989
*   OUCBGOB='1'B;                   /* RPS HAS BEEN INVOKED          */
*                                                                  0989
         OI    OUCBGOB(OUCBPTR),B'00100000'                        0989
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(RPS)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0990
*   DO;                                                            0990
*     R1=ADDR(RMEPBRPS);            /* RPS REQUEST IS PARAM          */
         LA    R1,RMEPBRPS(,RMCTPTR)                               0991
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               0992
         BALR  @14,@15                                             0992
*   END;                                                           0993
*   IF RRPAWAIT=LONGWAIT&           /* IF MEMORY STILL IN LONG WAIT  */
*       OUCBNSW='0'B&               /* MEMORY IS NOT NON-SWAPPABLE & */
*       OUCBCTI='0'B&               /* CONTROL DOES NOT PROHIBIT SWAP*/
*       OUCBENQ='0'B&               /* NOT RESOURCE HOLDER   @YM05631*/
*       OUCBRSM='0'B&               /* NOT WAIT FOR RSM SERVC@YM05631*/
*       OUCBBIB='0'B&               /* NOT BEING CANCELLED   @Z40BPEB*/
*       RRPACOD=SYSEVT19 THEN       /* RESTORE COMPLETED SYSEVENT    */
*                                                                  0994
         CLI   RRPAWAIT(RRPAPTR),X'80'                             0994
         BNE   @RF00994                                            0994
         TM    OUCBNSW(OUCBPTR),B'11000010'                        0994
         BNZ   @RF00994                                            0994
         TM    OUCBRSM(OUCBPTR),B'01000000'                        0994
         BNZ   @RF00994                                            0994
         TM    OUCBBIB(OUCBPTR),B'00100000'                        0994
         BNZ   @RF00994                                            0994
         CLI   RRPACOD(RRPAPTR),19                                 0994
         BNE   @RF00994                                            0994
*     /***************************************************************/
*     /*                                                             */
*     /* SWAP-OUT THIS MEMORY                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0995
*     DO;                                                          0995
*                                                                  0995
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(CSO)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0996
*       DO;                                                        0996
*         R1=ADDR(RMEPBCSO);        /* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               0997
*         CALL RMSBCRY->IRARMRTN;   /* ACTION INVK FUNCT             */
         L     @15,RMSBCRY(,RMCTPTR)                               0998
         BALR  @14,@15                                             0998
*       END;                                                       0999
*       RESPECIFY                                                  1000
*         RTNCOD RSTD;              /*                       @Z30WIAW*/
*       IF RTNCOD=ZERO THEN         /* SWAP-OUT REQUEST SUCCESSFUL   */
         LTR   RTNCOD,RTNCOD                                       1001
         BNZ   @RF01001                                            1001
*         DO;                       /*                       @Z30WIMG*/
*           OUCBLWT='1'B;           /* MEMORY MAY BE IN LONG WAIT    */
         OI    OUCBLWT(OUCBPTR),B'10000000'                        1003
*           OUXBSTC=OUXBSTC+ONE;    /* AVOID STEAL ALL PAGES @Z30WIMG*/
         LA    @14,1                                               1004
         AH    @14,OUXBSTC(,OUXBPTR)                               1004
         STH   @14,OUXBSTC(,OUXBPTR)                               1004
*           IF OUCBTRM='1'B THEN    /* IF MEMORY IN TERMINAL @ZA30458*/
         TM    OUCBTRM(OUCBPTR),B'01000000'                        1005
         BNO   @RF01005                                            1005
*             IF OUCBOWT='1'B THEN  /* WAIT CONTINUE TO SWAP @ZA30458*/
         TM    OUCBOWT(OUCBPTR),B'00100000'                        1006
         BNO   @RF01006                                            1006
*               OUCBSRC=SRCDTOSC;   /* FOR TERMINAL WAIT     @ZA30458*/
         MVI   OUCBSRC(OUCBPTR),X'01'                              1007
*             ELSE                                                 1008
*               OUCBSRC=SRCDTISC;   /*                       @ZA30458*/
         B     @RC01006                                            1008
@RF01006 MVI   OUCBSRC(OUCBPTR),X'02'                              1008
*           ELSE                    /* NOT IN TERM WAIT      @ZA30458*/
*             OUCBSRC=SRCDLWSC;     /* SWAP DUE TO LONG WAIT DURING
*                                      RESTORE COMPLETE      @Z40BPEB*/
         B     @RC01005                                            1009
@RF01005 MVI   OUCBSRC(OUCBPTR),X'03'                              1009
*         END;                      /*                       @Z30WIMG*/
*     END;                                                         1011
*   ELSE                            /* USER WILL REMAIN IN CORE      */
*                                                                  1012
*     /***************************************************************/
*     /*                                                             */
*     /* RESET INDICATORS AS TO WHY USER WAS SWAPPED OUT OF CORE     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1012
*     DO;                                                          1012
         B     @RC00994                                            1012
@RF00994 DS    0H                                                  1013
*       OUCBLWT='0'B;                                              1013
*       OUCBMWT='0'B;                                              1014
         NI    OUCBLWT(OUCBPTR),B'01111110'                        1014
*       OUCBCTI='0'B;                                              1015
         NI    OUCBCTI(OUCBPTR),B'10111111'                        1015
*     END;                                                         1016
*   OUCBRDYB='0'B;                  /* RESET SWAP USER               */
@RC00994 DS    0H                                                  1018
*   OUCBRSMB='0'B;                  /* READY INDICATORS              */
         L     @14,OUCBRSMB-2(,OUCBPTR)                            1018
@GL00044 LR    @12,@14                                             1018
         N     @12,@CF02717                                        1018
         CS    @14,@12,OUCBRSMB-2(OUCBPTR)                         1018
         BNE   @GL00044                                            1018
*   RESPECIFY                                                      1019
*    (OUXBPTR,                                                     1019
*     OUSBPTR,                                                     1019
*     RTNCOD,                                                      1019
*     RESNCODE) UNRSTD;             /*                       @ZA16887*/
*                                                                  1019
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1020
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1020
         L     @14,RMEXCTL(,RMCTPTR)                               1020
         BR    @14                                                 1020
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1021
*   RESPECIFY                                                      1021
*    (RTNREG,                                                      1021
*     NTRREG) RSTD;                                                1021
*                                                                  1022
*/********************************************************************/
*/*                                                                  */
*/*      ENQHOLD -20- ENQ HOLD                                       */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1022
*IRARME20:                          /* SYSEVENT 20 - ENQHOLD         */
*/*                                                                  */
*/*      MARK USER HOLDING AN ENQ RESOURCE IN DEMAND BY ANOTHER      */
*/*      USER.  CONTROL WILL SEE THIS AS AN EXPRESS SWAP IN          */
*/*      TO GIVE THE USER A CHANCE TO FREE THE RESOURCE.  THIS       */
*/*      WILL INSURE THAT ENQ RESOURCES OF A FEW INSTRUCTIONS        */
*/*      DURATION WILL NEVER BE HELD BY A SWAPPED OUT USER.          */
*/*                                                                  */
*                                                                  1022
*   RESPECIFY                                                      1022
*    (OUXBPTR,                                                     1022
*     ENQJST1,                                                     1022
*     ENQJST2) RESTRICTED;          /*                       @Z30WIMG*/
IRARME20 DS    0H                                                  1023
*   IF OUCBNQC=ZERO THEN            /* IF NO ENQHOLD SYSEVENTS ARE   */
         CLI   OUCBNQC(OUCBPTR),0                                  1023
         BNE   @RF01023                                            1023
*     DO;                           /* CURRENT FOR USER,             */
*       OUCBENQ='1'B;               /* SET ENQ FLAG ON               */
         OI    OUCBENQ(OUCBPTR),B'00000010'                        1025
*       CCVENQCT=CCVENQCT+ONE;      /* KEEP TRACK OF NUMBER OF USERS
*                                      MARKED FOR ENQUEUE REASONS.   */
         LA    @12,1                                               1026
         AH    @12,CCVENQCT(,RMCTPTR)                              1026
         STH   @12,CCVENQCT(,RMCTPTR)                              1026
*       IF OUCBOUT='0'B             /* IF USER IS IN MAIN STORAGE AND*/
*           &OUCBGOO='0'B           /* NOT BEING SWAPPED,            */
*           &OUCBGOI='0'B THEN      /*                               */
         TM    OUCBOUT(OUCBPTR),B'11000100'                        1027
         BNZ   @RF01027                                            1027
*         DO;                                                      1028
*           GENERATE CODE REFS(ASCBEJST);                          1029
         LM    ENQJST1,ENQJST2,ASCBEJST(ASCBPTR)
         SRDL  ENQJST1,MILLISEC
*           OUXBPTR=ASCBOUXB;       /* SAVE USER EXECUTION TIME VALUE*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1030
*           OUXBNQT=ENQJST2;        /* AT POINT SYSEVENT OCCURRED    */
         ST    ENQJST2,OUXBNQT(,OUXBPTR)                           1031
*         END;                                                     1032
*       ELSE                        /* OTHERWISE                     */
*         OUCBNQF='1'B;             /* INDICATE INVALID BASE TIME    */
         B     @RC01027                                            1033
@RF01027 OI    OUCBNQF(OUCBPTR),B'00001000'                        1033
*     END;                                                         1034
*                                                                  1034
@RC01027 DS    0H                                                  1035
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE RESOURCE HOLDER IS IN THE MEAN TIME TO WAIT GROUP      */
*   /* ENSURE THAT THE DISPATCHING PRIORITY IS HIGH ENOUGH TO ALLOW  */
*   /* THE USER TO FREE THE RESOURCE.                        @ZA19283*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1035
*   IF OUCBAPG='1'B&                /* APG USER              @ZA19283*/
*       OUCBNDP<CCCAPGDP            /* IN MEAN TIME TO WAIT  @ZA19283*/
*     THEN                                                         1035
@RF01023 TM    OUCBAPG(OUCBPTR),B'01000000'                        1035
         BNO   @RF01035                                            1035
         LH    @12,CCCAPGDP(,RMCTPTR)                              1035
         SLR   @11,@11                                             1035
         IC    @11,OUCBNDP(,OUCBPTR)                               1035
         CR    @12,@11                                             1035
         BNH   @RF01035                                            1035
*     OUCBNDP=CCCAPGDP;             /* PUT TO TOP.           @ZA19283*/
         STC   @12,OUCBNDP(,OUCBPTR)                               1036
*   OUCBNQC=OUCBNQC+ONE;            /* KEEP TRACK OF NO. OF ENQHOLD
*                                      SYSEVENTS OUTSTANDING FOR USER
*                                      ENTER SRM CONTROL ROUTINE     */
*                                                                  1037
@RF01035 LA    @12,1                                               1037
         SLR   @11,@11                                             1037
         IC    @11,OUCBNQC(,OUCBPTR)                               1037
         ALR   @12,@11                                             1037
         STC   @12,OUCBNQC(,OUCBPTR)                               1037
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1038
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
         L     @12,RMEXCTL(,RMCTPTR)                               1038
         BR    @12                                                 1038
*   RESPECIFY                                                      1039
*    (OUXBPTR,                                                     1039
*     ENQJST1,                                                     1039
*     ENQJST2) UNRESTRICTED;                                       1039
*                                                                  1040
*/********************************************************************/
*/*                                                                  */
*/*      ENQRLSE -21- ENQ RELEASE                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1040
*IRARME21:                          /* SYSEVENT 21 - ENQRLSE         */
*/*                                                                  */
*/*      WHEN USER FREES ALL ENQ RESOURCES THEN REMOVE SPECIAL       */
*/*      MARKING GIVEN AT ENQHOLD TIME.                              */
*/*                                                                  */
*                                                                  1040
*   OUCBNQC=OUCBNQC-ONE;            /* DECREMENT ENQHOLD COUNT       */
IRARME21 SLR   @12,@12                                             1040
         IC    @12,OUCBNQC(,OUCBPTR)                               1040
         BCTR  @12,0                                               1040
         STC   @12,OUCBNQC(,OUCBPTR)                               1040
*   IF OUCBNQC=ZERO THEN            /* IF COUNT GOES TO ZERO AND USER*/
         CLI   OUCBNQC(OUCBPTR),0                                  1041
         BNE   @RF01041                                            1041
*     IF OUCBENQ='1'B THEN          /* IS MARKED FOR ENQUEUE         */
         TM    OUCBENQ(OUCBPTR),B'00000010'                        1042
         BNO   @RF01042                                            1042
*       DO;                         /* REASONS:                      */
*         OUCBENQ='0'B;             /* MAKE USER NORMAL AGAIN.       */
         NI    OUCBENQ(OUCBPTR),B'11111101'                        1044
*         OUCBNQF='0'B;             /* RESET ENQ TIME INVALID BIT    */
         NI    OUCBNQF(OUCBPTR),B'11110111'                        1045
*         CCVENQCT=CCVENQCT-ONE;    /* REDUCE COUNT OF ENQHOLD USERS */
         LH    @12,CCVENQCT(,RMCTPTR)                              1046
         BCTR  @12,0                                               1046
         STH   @12,CCVENQCT(,RMCTPTR)                              1046
*       END;                        /* ENTER SRM CONTROL ROUTINE     */
*                                                                  1047
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1048
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
@RF01042 DS    0H                                                  1048
@RF01041 L     @12,RMEXCTL(,RMCTPTR)                               1048
         BR    @12                                                 1048
*                                                                  1049
*/********************************************************************/
*/*                                                                  */
*/*      RSMCNSTS -22- REAL STORAGE MANAGEMENT CONSTANTS             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1049
*IRARME22:                          /* SYSEVENT 22 - RSMCNSTS        */
*/*                                                                  */
*/*      THIS SYSEVENT IS NOW A NO-OP                        @Z40BPJE*/
*/*                                                                  */
*                                                                  1049
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1049
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
IRARME22 L     @12,RMEXI01(,RMCTPTR)                               1049
         BR    @12                                                 1049
*                                                                  1050
*/********************************************************************/
*/*                                                                  */
*/*      AVQLOW -23- AVAILABLE QUEUE BELOW LIMIT                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1050
*IRARME23:                          /* SYSEVENT 23 - AVQLOW          */
*/*                                                                  */
*/*      INVOKE MAIN STORAGE OCCUPANCY ANALYSIS TO ALLEVIATE         */
*/*      PAGE SHORTAGE.                                      @Z40BPJE*/
*/*                                                                  */
*                                                                  1050
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(MS2)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1050
*   DO;                                                            1050
IRARME23 DS    0H                                                  1051
*     R1=ADDR(RMEPBMS2);            /* MS2 REQUEST IS PARAM          */
         LA    R1,RMEPBMS2(,RMCTPTR)                               1051
*     CALL RMSBCRL->IRARMRTN;       /* ALGRTHM SCH FUNCT             */
         L     @15,RMSBCRL(,RMCTPTR)                               1052
         BALR  @14,@15                                             1052
*   END;                                                           1053
*   IF LEVEL=ONE THEN               /* IF NUMBER OF AVAILABLE PAGES  */
         CLI   LEVEL(RRPAPTR),1                                    1054
         BNE   @RF01054                                            1054
*     MCTAVQ1='1'B;                 /* SET AVQLOW FLAG               */
         OI    MCTAVQ1(RMCTPTR),B'00100000'                        1055
*   IF LEVEL=FOUR THEN              /* IF % OF FIXED REAL PAGES IS 1056
*                                      TOO HIGH              @Z40BPJE*/
@RF01054 CLI   LEVEL(RRPAPTR),4                                    1056
         BNE   @RF01056                                            1056
*     MCTFAVQ='1'B;                 /* SET FIXED PAGE FLAG   @Z40BPJE
*                                      RETURN TO INTERFACE PROGRAM   */
*                                                                  1057
         OI    MCTFAVQ(RMCTPTR),B'00010000'                        1057
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1058
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
@RF01056 L     @12,RMEXI01(,RMCTPTR)                               1058
         BR    @12                                                 1058
*                                                                  1059
*/********************************************************************/
*/*                                                                  */
*/*      AVQOK -24- AVAILABLE QUEUE ABOVE LIMIT                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1059
*IRARME24:                          /* SYSEVENT 24 - AVQOK           */
*/*                                                                  */
*/*      RESET AVQLOW BIT AND RETURN                                 */
*/*                                                                  */
*                                                                  1059
*   MCTAVQ1='0'B;                   /* INDICATE SHORTAGE RELIEVED  1059
*                                      RETURN TO INTERFACE PROGRAM   */
*                                                                  1059
IRARME24 NI    MCTAVQ1(RMCTPTR),B'11011111'                        1059
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1060
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
         L     @12,RMEXI01(,RMCTPTR)                               1060
         BR    @12                                                 1060
*                                                                  1061
*/********************************************************************/
*/*                                                                  */
*/*      SQALOW -25- AVAILABLE SYSTEM QUEUE SPACE BELOW LIMIT        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1061
*IRARME25:                          /* SYSEVENT 25 - SQALOW          */
*/*                                                                  */
*/*      SET FLAGS INDICATING SHORTAGE OF SYSTEM QUEUE SPACE         */
*/*      INVOKE SQA MESSAGE WRITER TO INFORM OPERATOR OF SHORTAGE.   */
*/*      MESSAGES CANNOT BE WRITTEN DIRECTLY BECAUSE THE SRM LOCK    */
*/*      IS NOT HELD                                                 */
*/*                                                                  */
*                                                                  1061
*   RESPECIFY                                                      1061
*     R1 RESTRICTED;                                               1061
IRARME25 DS    0H                                                  1062
*   IF RRPAINP=ONE THEN             /* IF FIRST LEVEL SHORTAGE,      */
         CLC   RRPAINP(4,RRPAPTR),@CF00078                         1062
         BNE   @RF01062                                            1062
*     MCTSQA1='1'B;                 /* SET FIRST LEVEL FLAG ON       */
         OI    MCTSQA1(RMCTPTR),B'10000000'                        1063
*   ELSE                            /* OTHERWISE                     */
*     MCTSQA2='1'B;                 /* INDICATE SECOND LEVEL SHORTAGE
*                                      INVOKE SQA MESSAGE WRITER     */
*                                                                  1064
         B     @RC01062                                            1064
@RF01062 OI    MCTSQA2(RMCTPTR),B'01000000'                        1064
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(SQA)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1065
*   DO;                                                            1065
@RC01062 DS    0H                                                  1066
*     R1=ADDR(RMEPBSQA);            /* SQA REQUEST IS PARAM          */
         LA    R1,RMEPBSQA(,RMCTPTR)                               1066
*     CALL RMSBCRL->IRARMRTN;       /* ALGRTHM SCH FUNCT             */
         L     @15,RMSBCRL(,RMCTPTR)                               1067
         BALR  @14,@15                                             1067
*   END;                                                           1068
*   RESPECIFY                                                      1069
*     R1 UNRESTRICTED;              /* RETURN TO INTERFACE PROGRAM   */
*                                                                  1069
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1070
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
         L     @12,RMEXI01(,RMCTPTR)                               1070
         BR    @12                                                 1070
*                                                                  1071
*/********************************************************************/
*/*                                                                  */
*/*      SQAOK -26- AVAILABLE SYSTEM QUEUE SPACE ABOVE LIMIT         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1071
*IRARME26:                          /* SYSEVENT 26 - SQAOK           */
*/*                                                                  */
*/*      RESET SQA SHORTAGE FLAGS AND INVOKE SQA MESSAGE WRITER TO   */
*/*      INFORM OPERATOR THAT SQA SHORTAGES HAVE BEEN RELIEVED       */
*/*                                                                  */
*                                                                  1071
*   RESPECIFY                                                      1071
*     R1 RESTRICTED;                                               1071
IRARME26 DS    0H                                                  1072
*   IF RRPAINP=ONE THEN             /* IF ALL SHORTAGES RELIEVED     */
         CLC   RRPAINP(4,RRPAPTR),@CF00078                         1072
         BNE   @RF01072                                            1072
*     DO;                                                          1073
*       MCTSQA1='0'B;               /* RESET FIRST LEVEL FLAG        */
*       MCTSQA2='0'B;               /* RESET SECOND LEVEL FLAG INVOKE
*                                      SQA MESSAGE WRITER            */
*                                                                  1075
         NI    MCTSQA1(RMCTPTR),B'00111111'                        1075
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(SQA)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1076
*       DO;                                                        1076
*         R1=ADDR(RMEPBSQA);        /* SQA REQUEST IS PARAM          */
         LA    R1,RMEPBSQA(,RMCTPTR)                               1077
*         CALL RMSBCRL->IRARMRTN;   /* ALGRTHM SCH FUNCT             */
         L     @15,RMSBCRL(,RMCTPTR)                               1078
         BALR  @14,@15                                             1078
*       END;                                                       1079
*     END;                                                         1080
*   ELSE                            /* OTHERWISE                     */
*     MCTSQA2='0'B;                 /* RESET SECOND LEVEL FLAG       */
         B     @RC01072                                            1081
@RF01072 NI    MCTSQA2(RMCTPTR),B'10111111'                        1081
*   RESPECIFY                                                      1082
*     R1 UNRESTRICTED;              /* RETURN TO INTERFACE PROGRAM   */
*                                                                  1082
@RC01072 DS    0H                                                  1083
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1083
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
         L     @12,RMEXI01(,RMCTPTR)                               1083
         BR    @12                                                 1083
*                                                                  1084
*   /*****************************************************************/
*   /*                                                               */
*   /* IRARME28: DEVALLOC (DEVICE ALLOCATION) HAS BEEN MOVED TO THE  */
*   /* MODULE IRARMIOM.                                      @ZA20975*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1084
*IRARME29:                          /* SYSEVENT 29 - CONFIGCH        */
*   IF SMF22RTY=TYPE22 THEN         /* SMF RECORD TYPE IS 22         */
IRARME29 L     @12,SMF22PTR(,RRPAPTR)                              1084
         CLI   SMF22RTY(@12),22                                    1084
         BNE   @RF01084                                            1084
*     DO;                                                          1085
*                                                                  1085
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST SRM CONTROL BLOCKS TO REFLECT THE CHANGE IN THE    */
*       /* NUMBER OF ON-LINE CPUS.                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1086
*       CCVCPUCT=CSDCPUOL;          /* NO. OF ON-LINE CPUS           */
*                                                                  1086
         L     @12,CVTPTR                                          1086
         L     @12,CVTCSD(,@12)                                    1086
         LH    @12,CSDCPUOL(,@12)                                  1086
         STH   @12,CCVCPUCT(,RMCTPTR)                              1086
*       /*************************************************************/
*       /*                                                           */
*       /* ADJUST LOGICAL CHANNEL UTILIZATION IMBALANCE THRESHOLDS   */
*       /* BASED ON THE NUMBER OF CPUS STILL ON-LINE.                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1087
*       ICCHIUTH=ICCINHIT(CCVCPUCT);/* HIGH IMBALANCE THRESHOLD      */
         ALR   @12,@12                                             1087
         LH    @11,ICCINHIT-2(@12,RMCTPTR)                         1087
         STH   @11,ICCHIUTH(,RMCTPTR)                              1087
*       ICCLOUTH=ICCINLOT(CCVCPUCT);/* LOW IMBALANCE THRESHOLD       */
         LH    @11,ICCINLOT-2(@12,RMCTPTR)                         1088
         STH   @11,ICCLOUTH(,RMCTPTR)                              1088
*       ICCDAUTH=ICCINDAT(CCVCPUCT);/* DEVICE ALLOCATION THRESHOLD   */
         LH    @12,ICCINDAT-2(@12,RMCTPTR)                         1089
         STH   @12,ICCDAUTH(,RMCTPTR)                              1089
*     END;                                                         1090
*                                                                  1090
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1091
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1091
@RF01084 L     @12,RMEXCTL(,RMCTPTR)                               1091
         BR    @12                                                 1091
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1092
*IRARME30:                          /* SYSEVENT 30 - VERIFYPG        */
*/*                                                                  */
*/*   THE PERFORMANCE GROUP NUMBER(PGN) IS VERIFIED BY USING IT AS   */
*/*   AN INDEX INTO THE WORKLOAD MANAGER PERFORMANCE GROUP VECTOR    */
*/*   TABLE(WPGVT), AN ARRAY OF 2 BYTE ELEMENTS.  EACH ELEMENT       */
*/*   REPRESENTS AN OFFSET TO ONE OF THE PERFORMANCE GROUP DESCRIP-  */
*/*   TIONS THAT CAN BE DEFINED WITHIN AN IPS.  THOSE PERFORMANCE    */
*/*   GROUPS THAT ARE UNDEFINED WITHIN AN IPS HAVE A ZERO(0) OFFSET. */
*/*   IF THE INDEXED ELEMENT IS NON-ZERO, THEN THE PGN IS KNOWN TO   */
*/*   THE SYSTEM RESOURCES MANAGER.  OTHERWISE, A DEFAULT PGN WILL   */
*/*   BE RETURNED FOR LOGONS. OTHER MEMORIES HAVE THEIR PGN  @ZA17805*/
*/*   VERIFIED AT INITATT TIME.                              @ZA17805*/
*/*                                                                  */
*                                                                  1092
*   RRPARI2=OK;                     /* PGN VALID IN IPS              */
IRARME30 MVI   RRPARI2(RRPAPTR),X'00'                              1092
*   RESPECIFY                                                      1093
*     WPGVTENT BASED(WMSTPGVT+TWO*RRPAPGN);                        1093
*   IF OUCBLOG='1'B THEN            /* MEMORY ORIGINATED VIA LOGON   */
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1094
         BNO   @RF01094                                            1094
*     IF(RRPAPGN=ZERO×              /* IF PGN INVALID OR             */
*         RRPAPGN>WMSTPGHI×WPGVTENT=ZERO) THEN/* PGN UNDEFINED IN  1095
*                                      IPS,                          */
*                                                                  1095
         CLI   RRPAPGN(RRPAPTR),0                                  1095
         BE    @RT01095                                            1095
         SLR   @12,@12                                             1095
         IC    @12,RRPAPGN(,RRPAPTR)                               1095
         L     @11,WMSTPTR(,RMCTPTR)                               1095
         CH    @12,WMSTPGHI(,@11)                                  1095
         BH    @RT01095                                            1095
         ALR   @12,@12                                             1095
         AL    @12,WMSTPGVT(,@11)                                  1095
         LH    @12,WPGVTENT(,@12)                                  1095
         LTR   @12,@12                                             1095
         BNZ   @RF01095                                            1095
@RT01095 DS    0H                                                  1096
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE THE DEFAULT PGN FOR THIS TSO USER               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1096
*       RRPADEF=RMCALGPG;           /* DEFAULT PGN FOR TSO USER    1096
*                                                            @Z40BPJE*/
         IC    @12,RMCALGPG(,RMCTPTR)                              1096
         STC   @12,RRPADEF(,RRPAPTR)                               1096
*     ELSE                                                         1097
*       ;                           /* PGN IS OK AS IS       @ZA17805*/
@RF01095 DS    0H                                                  1098
*   ELSE                            /* MEMORY ORIGINATED VIA START OR
*                                      MOUNT COMMAND                 */
*     IF RRPAPGN=ZERO THEN          /* AND NO PGN SPECIFIED  @ZA17805*/
         B     @RC01094                                            1098
@RF01094 CLI   RRPAPGN(RRPAPTR),0                                  1098
         BNE   @RF01098                                            1098
*       RRPADEF=RMCABCPG;           /* DEFAULT PGN FOR ALL OTHER USER
*                                                            @Z40BPJE*/
         IC    @12,RMCABCPG(,RMCTPTR)                              1099
         STC   @12,RRPADEF(,RRPAPTR)                               1099
*   RFY                                                            1100
*     WPGVTENT BASED(WMSTPGVT+TWO*OUCBNPG);/*                @Z40BPEB*/
*                                                                  1100
@RF01098 DS    0H                                                  1100
@RC01094 DS    0H                                                  1101
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1101
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1101
         L     @12,RMEXCTL(,RMCTPTR)                               1101
         BR    @12                                                 1101
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1102
*IRARME31:                          /* SYSEVENT 31 - RESETPG         */
*   IF ASCBOUCB^=ZERO&              /* IF OUCB PTR IN ASCB NON-ZERO  */
*       OUCBINV='0'B&               /* AND VALID BLOCK INDICATOR SET
*                                                            @Z40BPCH*/
*       ASCBPTR=OUCBASCB THEN       /* AND ASCB PTR IN OUCB VALID,   */
IRARME31 SLR   @12,@12                                             1102
         C     @12,ASCBOUCB(,ASCBPTR)                              1102
         BE    @RF01102                                            1102
         TM    OUCBINV(OUCBPTR),B'00010000'                        1102
         BNZ   @RF01102                                            1102
         C     ASCBPTR,OUCBASCB(,OUCBPTR)                          1102
         BNE   @RF01102                                            1102
*     DO;                           /* DETERMINE VALIDITY OF RESET PG*/
*       RESPECIFY                                                  1104
*         WPGVTENT BASED(WMSTPGVT+TWO*RRPAPGN);                    1104
*       IF(RRPAPGN^=ZERO&           /* IF PGN VALID                  */
*           RRPAPGN<=WMSTPGHI&      /* AND PGN DEFINED               */
*           WPGVTENT^=ZERO) THEN    /* IN IPS,                       */
         CLI   RRPAPGN(RRPAPTR),0                                  1105
         BE    @RF01105                                            1105
         SLR   @11,@11                                             1105
         IC    @11,RRPAPGN(,RRPAPTR)                               1105
         L     @10,WMSTPTR(,RMCTPTR)                               1105
         CH    @11,WMSTPGHI(,@10)                                  1105
         BH    @RF01105                                            1105
         LR    @07,@11                                             1105
         ALR   @07,@07                                             1105
         AL    @07,WMSTPGVT(,@10)                                  1105
         CH    @12,WPGVTENT(,@07)                                  1105
         BE    @RF01105                                            1105
*         DO;                                                      1106
*           OUCBRPG=RRPAPGN;        /* ESTABLISH RESET PG VALUE      */
         STC   @11,OUCBRPG(,OUCBPTR)                               1107
*           IF OUCBPVL='0'B THEN    /* IF CURRENT PGN NOT ZERO,      */
         TM    OUCBPVL(OUCBPTR),B'00000100'                        1108
         BNZ   @RF01108                                            1108
*             OUCBNPG=RRPAPGN;      /* STORE NEW PERF. GROUP FOR NEXT
*                                      TRANSACTION           @Z40BPEB*/
*                                                                  1109
         STC   @11,OUCBNPG(,OUCBPTR)                               1109
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(WMN)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1110
*           CALL RMSBWMN->IRARMRTN; /* INVOKE WMN SUBRTN             */
*                                                                  1110
@RF01108 L     @15,RMSBWMN(,RMCTPTR)                               1110
         BALR  @14,@15                                             1110
*           /*********************************************************/
*           /*                                                       */
*           /* START NEW TRANSACTION                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1111
*           OUCBPGP=WPGPOFST;       /* FIRST PERIOD OFFSET   @Z40BPEB*/
         LA    @12,12                                              1111
         STC   @12,OUCBPGP(,OUCBPTR)                               1111
*           RFY                                                    1112
*             WPGVTENT BASED(WMSTPGVT+TWO*OUCBNPG);/*        @ZA28473*/
*           WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO     1113
*                                                            @Z40BPJE*/
*               OUCBPGP;            /* THE CORRECT PGP       @Z40BPJE*/
         L     @10,WMSTPTR(,RMCTPTR)                               1113
         SLR   @07,@07                                             1113
         IC    @07,OUCBNPG(,OUCBPTR)                               1113
         ALR   @07,@07                                             1113
         AL    @07,WMSTPGVT(,@10)                                  1113
         LH    WPGPPTR,WPGVTENT(,@07)                              1113
         AL    WPGPPTR,WMSTPGDT(,@10)                              1113
         ALR   WPGPPTR,@12                                         1113
*           OUCBDMN=WPGPDMN;        /* INITIALIZE THE DOMAIN NUMBER
*                                                            @Z40BPJE*/
         SLR   @12,@12                                             1114
         IC    @12,WPGPDMN(,WPGPPTR)                               1114
         STC   @12,OUCBDMN(,OUCBPTR)                               1114
*           OUCBDMO=WDMVTENT;       /* AND DOMAIN OFFSET     @Z40BPJE*/
         ALR   @12,@12                                             1115
         AL    @12,WMSTDMVT(,@10)                                  1115
         LH    @12,WDMVTENT(,@12)                                  1115
         STH   @12,OUCBDMO(,OUCBPTR)                               1115
*           RFY                                                    1116
*             DMDTPTR2 RSTD;        /* HOLD IT...            @ZA11854*/
*           RFY                                                    1117
*             DMDT BASED(DMDTPTR2); /*                       @ZA11854*/
*           DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO DMDT ENTRY   @ZA11854*/
         AL    @12,RMCTDMDT(,RMCTPTR)                              1118
         LR    DMDTPTR2,@12                                        1118
*           IF OUCBINC='0'B THEN    /* BETWEEN JOB STEPS?    @ZA11854*/
         TM    OUCBINC(OUCBPTR),B'00000001'                        1119
         BNZ   @RF01119                                            1119
*             DO;                   /* YES                   @ZA11854*/
*               DO WHILE(DMDTHI=ZERO&/* MAX MPL = 0 ??       @ZA11854*/
*                     WPGPFIN^='1'B);/* AND NOT LAST PERIOD  @ZA11854*/
         B     @DE01121                                            1121
@DL01121 DS    0H                                                  1122
*                 OUCBPGP=OUCBPGP+LENGTH(WPGP);/* GO TO NEXT PERIOD
*                                                            @ZA11854*/
         LA    @12,8                                               1122
         SLR   @07,@07                                             1122
         IC    @07,OUCBPGP(,OUCBPTR)                               1122
         ALR   @12,@07                                             1122
         STC   @12,OUCBPGP(,OUCBPTR)                               1122
*                 WPGPPTR=WMSTPGDT+WPGVTENT+OUCBPGP;/* PTR TO PERIOD
*                                                            @ZA11854*/
         L     @07,WMSTPTR(,RMCTPTR)                               1123
         SLR   @06,@06                                             1123
         IC    @06,OUCBNPG(,OUCBPTR)                               1123
         ALR   @06,@06                                             1123
         AL    @06,WMSTPGVT(,@07)                                  1123
         LH    WPGPPTR,WPGVTENT(,@06)                              1123
         AL    WPGPPTR,WMSTPGDT(,@07)                              1123
         ALR   WPGPPTR,@12                                         1123
*                 OUCBDMN=WPGPDMN;  /* UPDATE DMN NUMBER     @ZA11854*/
         SLR   @12,@12                                             1124
         IC    @12,WPGPDMN(,WPGPPTR)                               1124
         STC   @12,OUCBDMN(,OUCBPTR)                               1124
*                 OUCBDMO=WDMVTENT; /* AND DMN OFFSET        @ZA11854*/
         ALR   @12,@12                                             1125
         AL    @12,WMSTDMVT(,@07)                                  1125
         LH    @12,WDMVTENT(,@12)                                  1125
         STH   @12,OUCBDMO(,OUCBPTR)                               1125
*                 DMDTPTR2=RMCTDMDT+OUCBDMO;/* PTR TO NEW DMDT ENTRY
*                                                            @ZA11854*/
         AL    @12,RMCTDMDT(,RMCTPTR)                              1126
         LR    DMDTPTR2,@12                                        1126
*               END;                /*                       @ZA11854*/
@DE01121 CLI   DMDTHI(DMDTPTR2),0                                  1127
         BNE   @DC01121                                            1127
         TM    WPGPFIN(WPGPPTR),B'10000000'                        1127
         BNO   @DL01121                                            1127
@DC01121 DS    0H                                                  1128
*             END;                  /*                       @ZA11854*/
*           RFY                                                    1129
*             DMDT BASED(DMDTPTR);  /*                       @ZA11854*/
@RF01119 DS    0H                                                  1130
*           RFY                                                    1130
*             DMDTPTR2 UNRSTD;      /* NOW LET IT GO...      @ZA11854*/
*           IF OUCBAPG='1'B THEN    /* AN APG USER?          @ZA11390*/
         TM    OUCBAPG(OUCBPTR),B'01000000'                        1131
         BNO   @RF01131                                            1131
*             IF WPGPAPG='1'B       /* NEW PERIOD SPECIFY    @ZA11390*/
*               THEN                /* AN APG VLAUE ?        @ZA11390*/
         TM    WPGPAPG(WPGPPTR),B'00100000'                        1132
         BNO   @RF01132                                            1132
*               OUCBNDP=CCCAPMDP+WPGPAPGV;/* ASSIGN REQUESTED DP   1133
*                                                            @ZA11390*/
         SLR   @12,@12                                             1133
         IC    @12,WPGPAPGV(,WPGPPTR)                              1133
         AH    @12,CCCAPMDP(,RMCTPTR)                              1133
         STC   @12,OUCBNDP(,OUCBPTR)                               1133
*             ELSE                  /* NO APG VALUE CODED    @ZA11390*/
*               OUCBNDP=CCCAPGDP;   /* ASSIGN DEFAULT DP     @ZA11390*/
         B     @RC01132                                            1134
@RF01132 LH    @12,CCCAPGDP(,RMCTPTR)                              1134
         STC   @12,OUCBNDP(,OUCBPTR)                               1134
*           RRPARI2=OK;             /* RESET PGN REQUEST HONORED     */
@RC01132 DS    0H                                                  1135
@RF01131 MVI   RRPARI2(RRPAPTR),X'00'                              1135
*         END;                                                     1136
*       ELSE                        /* RESET PGN IS INVALID IN IPS   */
*         RRPARI2=UNKNWPGN;         /* PGN UNDEFINED IN IPS          */
         B     @RC01105                                            1137
@RF01105 MVI   RRPARI2(RRPAPTR),X'04'                              1137
*     END;                                                         1138
*   ELSE                            /* INVALID SRM CONTROL BLOCKS    */
*     RRPARI2=NULLBLKS;             /* RESET PGN COMMAND IGNORED     */
*                                                                  1139
         B     @RC01102                                            1139
@RF01102 MVI   RRPARI2(RRPAPTR),X'08'                              1139
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1140
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1140
@RC01102 L     @12,RMEXCTL(,RMCTPTR)                               1140
         BR    @12                                                 1140
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*IRARME32:                          /* SYSEVENT 32 - NEWIPS          */
*   WMSTSTCB=PSATOLD;               /* TCB ADDRESS OF SET COMMAND IPS
*                                      KEYWORD PROCESSOR FOR RECOVERY*/
IRARME32 L     @12,WMSTPTR(,RMCTPTR)                               1141
         L     @11,PSATOLD                                         1141
         ST    @11,WMSTSTCB(,@12)                                  1141
*   WMSTNWST=RRPAINP;               /* ADDRESS OF NEW WORKLOAD MANAG-
*                                      ER SPECIFICATION TABLE(WMST)  */
         L     @11,RRPAINP(,RRPAPTR)                               1142
         ST    @11,WMSTNWST(,@12)                                  1142
*/*                                                                  */
*/*   SET UP ENTRY POINT ADDRESS IN RMSB VECTOR TABLE OF IRARMSET    */
*/*   WHICH IS LOADED AND FIXED IN STORAGE BY THE SET COMMAND IPS    */
*/*   KEYWORD PROCESSOR.                                             */
*/*                                                                  */
*                                                                  1143
*   RMSBSET=RRPAINP->WMSTSET;                                      1143
         L     @11,WMSTSET(,@11)                                   1143
         ST    @11,RMSBSET(,RMCTPTR)                               1143
*   RMCTWAST=ZERO;                  /* CLEAR INDICATOR               */
         SLR   @11,@11                                             1144
         ST    @11,RMCTWAST(,RMCTPTR)                              1144
*   WMSTSECB=ZERO;                  /* CLEAR ECB BEFORE XMPOST       */
         ST    @11,WMSTSECB(,@12)                                  1145
*/*                                                                  */
*/*   REQUEST INVOCATION OF THE SET TO NEW IPS PROCESSOR ROUTINE TO  */
*/*   SWITCH THE SRM TO THE NEW IPS.  THIS ROUTINE IS PLACED ON THE  */
*/*   ACTION QUEUE TO RECEIVE CONTROL ONLY AFTER SERIALIZATION       */
*/*   AGAINST OTHER SRM PROCESSING HAS BEEN ACCOMPLISHED.  CONTROL   */
*/*   IS RETURNED TO THE ISSUER PRIOR TO THE EXECUTION OF THE RE-    */
*/*   QUESTED ROUTINE.                                               */
*/*                                                                  */
*                                                                  1146
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(IPS)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1146
*   DO;                                                            1146
*     R1=ADDR(RMEPBIPS);            /* IPS REQUEST IS PARAM          */
         LA    R1,RMEPBIPS(,RMCTPTR)                               1147
*     CALL RMSBCRN->IRARMRTN;       /* ACTION INVK FUNCT             */
         L     @15,RMSBCRN(,RMCTPTR)                               1148
         BALR  @14,@15                                             1148
*   END;                                                           1149
*   IF RMCTWAST=ZERO THEN           /* IF IPS HAS NOT BEEN CHANGED,  */
         L     @12,RMCTWAST(,RMCTPTR)                              1150
         LTR   @12,@12                                             1150
         BNZ   @RF01150                                            1150
*     RRPAINP=RMCTWMST;             /* ADDRESS OF WMST TO FREE       */
         L     @12,RMCTWMST(,RMCTPTR)                              1151
         ST    @12,RRPAINP(,RRPAPTR)                               1151
*   ELSE                            /* IPS HAS BEEN CHANGED          */
*     RRPAINP=RMCTWAST;             /* ADDRESS OF WMST TO FREE       */
*                                                                  1152
         B     @RC01150                                            1152
@RF01150 L     @12,RMCTWAST(,RMCTPTR)                              1152
         ST    @12,RRPAINP(,RRPAPTR)                               1152
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1153
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1153
@RC01150 L     @12,RMEXCTL(,RMCTPTR)                               1153
         BR    @12                                                 1153
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1154
*IRARME33:                          /* SYSEVENT 33 - ALTCPREC        */
*/*                                                                  */
*/*   ADJUST SRM CONTROL BLOCKS TO REFLECT THE DECREASE IN THE       */
*/*   NUMBER OF ON-LINE CPUS.                                        */
*/*                                                                  */
*                                                                  1154
*   CCVCPUCT=CSDCPUOL;              /* NUMBER OF ONLINE CPUS         */
IRARME33 L     @12,CVTPTR                                          1154
         L     @12,CVTCSD(,@12)                                    1154
         LH    @12,CSDCPUOL(,@12)                                  1154
         STH   @12,CCVCPUCT(,RMCTPTR)                              1154
*/*                                                                  */
*/*   ADJUST LOGICAL CHANNEL UTILIZATION IMBALANCE THRESHOLDS        */
*/*   BASED ON THE NUMBER OF CPUS STILL ON-LINE.                     */
*/*                                                                  */
*                                                                  1155
*   ICCHIUTH=ICCINHIT(CCVCPUCT);    /* HIGH IMBALANCE THRESHOLD      */
         ALR   @12,@12                                             1155
         LH    @11,ICCINHIT-2(@12,RMCTPTR)                         1155
         STH   @11,ICCHIUTH(,RMCTPTR)                              1155
*   ICCLOUTH=ICCINLOT(CCVCPUCT);    /* LOW IMBALANCE THRESHOLD       */
         LH    @11,ICCINLOT-2(@12,RMCTPTR)                         1156
         STH   @11,ICCLOUTH(,RMCTPTR)                              1156
*   ICCDAUTH=ICCINDAT(CCVCPUCT);    /* DEVICE ALLOCATION THRESHOLD   */
*                                                                  1157
         LH    @12,ICCINDAT-2(@12,RMCTPTR)                         1157
         STH   @12,ICCDAUTH(,RMCTPTR)                              1157
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1158
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1158
         L     @12,RMEXCTL(,RMCTPTR)                               1158
         BR    @12                                                 1158
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1159
*IRARME34:                          /* SYSEVENT 34 - TGETTPUT        */
*   IF RRPAGTPT='0'B THEN           /* TGET SATISFIED                */
IRARME34 TM    RRPAGTPT(RRPAPTR),B'10000000'                       1159
         BNZ   @RF01159                                            1159
*     DO;                                                          1160
*       IF OUCBCIM='0'B THEN        /* NO COMPOSITE INPUT MESSAGE    */
         TM    OUCBCIM(OUCBPTR),B'00010000'                        1161
         BNZ   @RF01161                                            1161
*         DO;                                                      1162
*           IF RRPATRAN='1'B THEN   /* MESSAGE TRANSFER INCOMPLETE   */
         TM    RRPATRAN(RRPAPTR),B'01000000'                       1163
         BNO   @RF01163                                            1163
*             OUCBCIM='1'B;         /* NEXT TGET IS PART OF CURRENT  */
         OI    OUCBCIM(OUCBPTR),B'00010000'                        1164
*           IF OUCBNSW='0'B&        /* NONSWAPPABLE KEEPS OLD XACTN. */
*               OUCBTRM='0'B THEN   /* NEW COMMAND BUFFER AVAILABLE  */
@RF01163 TM    OUCBNSW(OUCBPTR),B'10000000'                        1165
         BNZ   @RF01165                                            1165
         TM    OUCBTRM(OUCBPTR),B'01000000'                        1165
         BNZ   @RF01165                                            1165
*             DO;                   /* WITHOUT WAIT                  */
*                                                                  1166
*               /*****************************************************/
*               /*                                                   */
*               /* ? IRACTLCL EPN(WMN)                               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1167
*               CALL RMSBWMN->IRARMRTN;/* INVOKE WMN SUBRTN          */
         L     @15,RMSBWMN(,RMCTPTR)                               1167
         BALR  @14,@15                                             1167
*/*   START A NEW TRANSACTION                                        */
*                                                                  1168
*               OUCBPGP=WPGPOFST;   /* FIRST PERIOD OFFSET   @Z40BPEB*/
         LA    @12,12                                              1168
         STC   @12,OUCBPGP(,OUCBPTR)                               1168
*               WPGPPTR=WMSTPGDT+WPGVTENT+/* RESOLVE ADDRESSING TO 1169
*                                                            @Z40BPJE*/
*                   OUCBPGP;        /* THE CORRECT PGP       @Z40BPJE*/
         L     @10,WMSTPTR(,RMCTPTR)                               1169
         SLR   @07,@07                                             1169
         IC    @07,OUCBNPG(,OUCBPTR)                               1169
         ALR   @07,@07                                             1169
         AL    @07,WMSTPGVT(,@10)                                  1169
         LH    WPGPPTR,WPGVTENT(,@07)                              1169
         AL    WPGPPTR,WMSTPGDT(,@10)                              1169
         ALR   WPGPPTR,@12                                         1169
*               OUCBDMN=WPGPDMN;    /* INITIALIZE THE DOMAIN NUMBER
*                                                            @Z40BPJE*/
         SLR   @12,@12                                             1170
         IC    @12,WPGPDMN(,WPGPPTR)                               1170
         STC   @12,OUCBDMN(,OUCBPTR)                               1170
*               OUCBDMO=WDMVTENT;   /* AND DOMAIN OFFSET     @Z40BPJE*/
         ALR   @12,@12                                             1171
         AL    @12,WMSTDMVT(,@10)                                  1171
         LH    @12,WDMVTENT(,@12)                                  1171
         STH   @12,OUCBDMO(,OUCBPTR)                               1171
*               IF OUCBAPG='1'B THEN/* AN APG USER?          @ZA11390*/
         TM    OUCBAPG(OUCBPTR),B'01000000'                        1172
         BNO   @RF01172                                            1172
*                 IF WPGPAPG='1'B   /* NEW PERIOD SPECIFY    @ZA11390*/
*                   THEN            /* AN APG VLAUE ?        @ZA11390*/
         TM    WPGPAPG(WPGPPTR),B'00100000'                        1173
         BNO   @RF01173                                            1173
*                   OUCBNDP=CCCAPMDP+WPGPAPGV;/* ASSIGN REQUESTED DP
*                                                            @ZA11390*/
         SLR   @12,@12                                             1174
         IC    @12,WPGPAPGV(,WPGPPTR)                              1174
         AH    @12,CCCAPMDP(,RMCTPTR)                              1174
         STC   @12,OUCBNDP(,OUCBPTR)                               1174
*                 ELSE              /* NO APG VALUE CODED    @ZA11390*/
*                   OUCBNDP=CCCAPGDP;/* ASSIGN DEFAULT DP    @ZA11390*/
         B     @RC01173                                            1175
@RF01173 LH    @12,CCCAPGDP(,RMCTPTR)                              1175
         STC   @12,OUCBNDP(,OUCBPTR)                               1175
*             END;                  /* XACTN IS STARTED      @Z40BPEB*/
*         END;                                                     1177
*       ELSE                        /* COMPOSITE INPUT MESSAGE       */
*         DO;                                                      1178
         B     @RC01161                                            1178
@RF01161 DS    0H                                                  1179
*           IF RRPATRAN='0'B THEN   /* MESSAGE TRANSFER COMPLETE     */
         TM    RRPATRAN(RRPAPTR),B'01000000'                       1179
         BNZ   @RF01179                                            1179
*             OUCBCIM='0'B;                                        1180
         NI    OUCBCIM(OUCBPTR),B'11101111'                        1180
*         END;                                                     1181
@RF01179 DS    0H                                                  1182
*     END;                                                         1182
*                                                                  1182
@RC01161 DS    0H                                                  1183
*/*                                                                  */
*/*   RESET TERMINAL WAIT FLAGS.                                     */
*/*                                                                  */
*                                                                  1183
*   OUCBTRM='0'B;                                                  1183
@RF01159 DS    0H                                                  1184
*   OUCBOWT='0'B;                                                  1184
*                                                                  1184
         NI    OUCBTRM(OUCBPTR),B'10011111'                        1184
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1185
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1185
         L     @12,RMEXCTL(,RMCTPTR)                               1185
         BR    @12                                                 1185
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1186
*IRARME37:                          /* SYSEVENT 37 - SETDMN  @Z40BPEB
*                                                            @Z40BPEB*/
*/* THIS SYSEVENT RECEIVES A DOMAIN NUMBER AS INPUT AND      @Z40BPEB*/
*/* OPTIONAL CONSTRAINT VALUES. THE DOMAIN NUMBER IS         @Z40BPEB*/
*/* VERIFIED (DOMAIN 0 WILL NOT BE PASSED) , THEN CONSTRAINT       1186
*                                                            @Z40BPEB*/
*/* VALUES ARE PLACED IN THE DOMAIN TABLE IF THEY ARE VALID. @Z40BPEB*/
*                                                                  1186
*   RFY                                                            1186
*     WDMVTENT BASED(WMSTDMVT+LENGTH(WDMVTENT)*SETDDMN);/*   @Z40BPEB*/
IRARME37 DS    0H                                                  1187
*   RFY                                                            1187
*     DMDTPTR RSTD;                 /* HOLD REG 7            @Z40BPEB*/
*   IF((SETDDMN+1)*LENGTH(WDMVTENT)<=WMSTDMVS)&WDMVTENT^=ZERO/* VALID
*                                      DOMAIN?               @ZA14985*/
*     THEN                          /* YES                   @Z40BPEB*/
         L     @12,RRPAINP(,RRPAPTR)                               1188
         SLR   @06,@06                                             1188
         IC    @06,SETDDMN(,@12)                                   1188
         LA    @11,1                                               1188
         ALR   @11,@06                                             1188
         ALR   @11,@11                                             1188
         L     @10,WMSTPTR(,RMCTPTR)                               1188
         C     @11,WMSTDMVS(,@10)                                  1188
         BH    @RF01188                                            1188
         ALR   @06,@06                                             1188
         AL    @06,WMSTDMVT(,@10)                                  1188
         LH    @06,WDMVTENT(,@06)                                  1188
         LTR   @06,@06                                             1188
         BZ    @RF01188                                            1188
*     DO;                           /*                       @Z40BPEB*/
*       DMDTPTR=WMSTDMDT+WDMVTENT;  /* FIND PROPER DMN TABLE @Z40BPEB*/
         AL    @06,WMSTDMDT(,@10)                                  1190
         LR    DMDTPTR,@06                                         1190
*       IF MINFLAG='1'B             /* NEWMIN PASSED?        @Z40BPEB*/
*         THEN                                                     1191
         TM    MINFLAG(@12),B'10000000'                            1191
         BNO   @RF01191                                            1191
*         MINSET=SETDMIN;           /* PICK IT UP            @Z40BPEB*/
         IC    @06,SETDMIN(,@12)                                   1192
         STC   @06,MINSET                                          1192
*       ELSE                                                       1193
*         MINSET=DMDTLO;            /* NO: KEEP OLD MIN      @Z40BPEB*/
         B     @RC01191                                            1193
@RF01191 IC    @12,DMDTLO(,DMDTPTR)                                1193
         STC   @12,MINSET                                          1193
*       IF MAXFLAG='1'B             /* NEW MAX PASSED?       @Z40BPEB*/
*         THEN                                                     1194
@RC01191 L     @12,RRPAINP(,RRPAPTR)                               1194
         TM    MAXFLAG(@12),B'01000000'                            1194
         BNO   @RF01194                                            1194
*         MAXSET=SETDMAX;           /* YES: PICK IT UP       @Z40BPEB*/
         IC    @06,SETDMAX(,@12)                                   1195
         STC   @06,MAXSET                                          1195
*       ELSE                                                       1196
*         MAXSET=DMDTHI;            /* NO: KEEP OLD MAX      @Z40BPEB*/
         B     @RC01194                                            1196
@RF01194 IC    @12,DMDTHI(,DMDTPTR)                                1196
         STC   @12,MAXSET                                          1196
*       IF MINSET<=MAXSET           /* VALUES ARE PROPER     @Z40BPEB*/
*         THEN                      /* SO UPDATE THE DMDT    @Z40BPEB*/
@RC01194 CLC   MINSET(1),MAXSET                                    1197
         BH    @RF01197                                            1197
*         DO;                       /* .WITH PASSED VALUES   @Z40BPEB*/
*           DMDTLO=MINSET;          /* STORE MINIMUM         @Z40BPEB*/
         IC    @12,MINSET                                          1199
         STC   @12,DMDTLO(,DMDTPTR)                                1199
*           DMDTHI=MAXSET;          /* STORE MAXIMUM         @Z40BPEB*/
         IC    @12,MAXSET                                          1200
         STC   @12,DMDTHI(,DMDTPTR)                                1200
*           IF WTFLAG='1'B          /* NEW WEIGHT PASSED ?   @Z40BPEB*/
*             THEN                                                 1201
         L     @12,RRPAINP(,RRPAPTR)                               1201
         TM    WTFLAG(@12),B'00100000'                             1201
         BNO   @RF01201                                            1201
*             DMDTWT=SETDWT;        /* STORE WEIGHT          @Z40BPEB*/
         IC    @06,SETDWT(,@12)                                    1202
         STC   @06,DMDTWT(,DMDTPTR)                                1202
*           IF DMDTLO>DMDTMPLT      /* IF MIN EXCEEDS TARGET @Z40BPEB*/
*             THEN                                                 1203
@RF01201 SLR   @12,@12                                             1203
         IC    @12,DMDTLO(,DMDTPTR)                                1203
         CH    @12,DMDTMPLT(,DMDTPTR)                              1203
         BNH   @RF01203                                            1203
*             DMDTMPLT=DMDTLO;      /* RAISE TARGET          @Z40BPEB*/
         STH   @12,DMDTMPLT(,DMDTPTR)                              1204
*           IF DMDTHI<DMDTMPLT      /* IF TARGET EXCEEDS MAX @Z40BPEB*/
*             THEN                                                 1205
@RF01203 SLR   @12,@12                                             1205
         IC    @12,DMDTHI(,DMDTPTR)                                1205
         CH    @12,DMDTMPLT(,DMDTPTR)                              1205
         BNL   @RF01205                                            1205
*             DMDTMPLT=DMDTHI;      /* LOWER TARGET          @Z40BPEB*/
         STH   @12,DMDTMPLT(,DMDTPTR)                              1206
*           RRPARTC=ZERO;           /* SUCCESSFUL SYSEVENT   @Z40BPEB*/
@RF01205 MVI   RRPARTC(RRPAPTR),X'00'                              1207
*         END;                      /*                       @Z40BPEB*/
*       ELSE                        /* MIN EXCEEDS MAX       @Z40BPEB*/
*         RRPARTC=CON8;             /* RETURN ERROR CODE     @Z40BPEB*/
         B     @RC01197                                            1209
@RF01197 MVI   RRPARTC(RRPAPTR),X'08'                              1209
*     END;                          /*                       @Z40BPEB*/
*   ELSE                            /* DOMAIN UNDEFINED      @Z40BPEB*/
*     RRPARTC=CON4;                 /* RETURN ERROR CODE     @Z40BPEB*/
         B     @RC01188                                            1211
@RF01188 MVI   RRPARTC(RRPAPTR),X'04'                              1211
*   RFY                                                            1212
*     DMDTPTR UNRSTD;               /* FREE UP REG 7         @Z40BPEB*/
@RC01188 DS    0H                                                  1213
*   RFY                                                            1213
*     WDMVTENT BASED(WMSTDMVT+LENGTH(WDMVTENT)*WPGPDMN);/*   @Z40BPEB*/
*                                                                  1213
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1214
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  1214
         L     @12,RMEXI01(,RMCTPTR)                               1214
         BR    @12                                                 1214
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INTERFACE                                   @Z40BPEB*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1215
*IRARME38:                          /* SYSEVENT 38 - REQSERVC        */
*   RESPECIFY                                                      1215
*    (R0,                                                          1215
*     R1,                                                          1215
*     RTNREG,                                                      1215
*     NTRREG) UNRSTD;                                              1215
IRARME38 DS    0H                                                  1216
*   RESPECIFY                                                      1216
*    (RTNREG1,                                                     1216
*     RTNREG2,                                                     1216
*     RTNREG3) RSTD;                                               1216
*                                                                  1216
*/*                                                                  */
*/*   COLLECT SERVICE RELATED DATA ACCUMULATED BY THE SRM FOR        */
*/*   THIS USER.                                                     */
*/*                                                                  */
*                                                                  1217
*   IF OUCBINV='0'B&                /* MEMRY STILL VALID AND @Z40BPCH*/
*       OUCBDTA='0'B&               /* USER DATA STILL VALID AND     */
*       OUCBOUT='0'B THEN           /* MEMORY CURRENTLY IN-CORE      */
         TM    OUCBINV(OUCBPTR),B'00010000'                        1217
         BNZ   @RF01217                                            1217
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1217
         BNZ   @RF01217                                            1217
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1217
         BNZ   @RF01217                                            1217
*     DO;                                                          1218
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO THE OUXB    */
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1219
*       RESPECIFY                                                  1220
*        (SERVICE,                                                 1220
*         TRNTIME,                                                 1220
*         WRKREG2) RSTD;                                           1220
*       SERVICE=OUXBJBS+            /* TOTAL SERVICE EXCLUDING       */
*           OUXBTRS;                /* CURRENT IN-CORE INTERVAL      */
         L     SERVICE,OUXBJBS(,OUXBPTR)                           1221
         AL    SERVICE,OUXBTRS(,OUXBPTR)                           1221
*       TRNTIME=OUXBJBT+            /* TOTAL TRANSACTION ACTIVE TIME */
*           OUXBTRT;                /* EXCLUDING CURRENT IN-CORE   1222
*                                      INTERVAL                      */
         L     TRNTIME,OUXBJBT(,OUXBPTR)                           1222
         AL    TRNTIME,OUXBTRT(,OUXBPTR)                           1222
*       WRKREG2=OUCBNPG*CON65536;   /* LAST PGN FOR MEMORY IN LEFT HW*/
         SLR   WRKREG2,WRKREG2                                     1223
         IC    WRKREG2,OUCBNPG(,OUCBPTR)                           1223
         SLA   WRKREG2,16                                          1223
*       IF OUCBLOG='1'B THEN        /* LOGON MEMORY                  */
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1224
         BNO   @RF01224                                            1224
*         WRKREG2=WRKREG2+          /* TOTAL NUMBER OF TRANSACTIONS  */
*             OUXBTRC;              /* IN TERMINAL SESSION           */
         AL    WRKREG2,OUXBTRC(,OUXBPTR)                           1225
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL        */
@RF01224 TM    OUCBINC(OUCBPTR),B'00000001'                        1226
         BNO   @RF01226                                            1226
*         DO;                       /* OBTAIN SERVICE AND TRANSACTION
*                                      ACTIVE TIME FOR CURRENT TRANS */
*                                                                  1227
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(WM1)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1228
*           CALL RMSBWM1->IRARMRTN; /* INVOKE WM1 SUBRTN             */
*                                                                  1228
         L     @15,RMSBWM1(,RMCTPTR)                               1228
         BALR  @14,@15                                             1228
*           /*********************************************************/
*           /*                                                       */
*           /* CALCULATE SERVICE IN CURRENT IN-CORE INTERVAL         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1229
*           SERVICE=SERVICE+        /* ADD SERIVCE ACCUMULATED FOR   */
*               OUCBWMS;            /* CURRENT IN-CORE INTERVAL      */
         AL    SERVICE,OUCBWMS(,OUCBPTR)                           1229
*           TRNTIME=TRNTIME+        /* ADD TRANSACTION ACTIVE TIME   */
*               (RMCTTOD-           /* FOR CURRENT IN-CORE INTERVAL  */
*               OUCBTMS);                                          1230
         L     @14,RMCTTOD(,RMCTPTR)                               1230
         SL    @14,OUCBTMS(,OUCBPTR)                               1230
         ALR   TRNTIME,@14                                         1230
*         END;                                                     1231
*       RTNREG1=SERVICE;            /* SET UP FOR RETURN     @Z40BPEB*/
@RF01226 LR    RTNREG1,SERVICE                                     1232
*       RTNREG2=TRNTIME;            /* OF INFORMATION TO     @Z40BPEB*/
         LR    RTNREG2,TRNTIME                                     1233
*       RTNREG3=WRKREG2;            /* INTERFACE ROUTINE     @Z40BPEB*/
         LR    RTNREG3,WRKREG2                                     1234
*       RRPARTC=OK;                 /* REQ FOR SERVICE DATA HONORED  */
         MVI   RRPARTC(RRPAPTR),X'00'                              1235
*       RESPECIFY                                                  1236
*        (SERVICE,                                                 1236
*         TRNTIME,                                                 1236
*         WRKREG2) UNRSTD;                                         1236
*     END;                                                         1237
*   ELSE                            /* USER SERVICE DATA INVALID     */
*     DO;                                                          1238
         B     @RC01217                                            1238
@RF01217 DS    0H                                                  1239
*       RTNREG1=ZERO;               /* INDICATE THAT SERVICE         */
         SLR   RTNREG1,RTNREG1                                     1239
*       RTNREG2=ZERO;               /* INFORMATION FOR THIS USER     */
         SLR   RTNREG2,RTNREG2                                     1240
*       RTNREG3=ZERO;               /* IS INVALID                    */
         SLR   RTNREG3,RTNREG3                                     1241
*       RRPARTC=INVLDATA;           /* REQ FOR SERVICE DATA IGNORED  */
         MVI   RRPARTC(RRPAPTR),X'04'                              1242
*     END;                                                         1243
*                                                                  1243
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1244
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  1244
@RC01217 L     @14,RMEXI01(,RMCTPTR)                               1244
         BR    @14                                                 1244
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INVOKER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1245
*   RESPECIFY                                                      1245
*    (RTNREG1,                                                     1245
*     RTNREG2,                                                     1245
*     RTNREG3) UNRSTD;                                             1245
*   RESPECIFY                                                      1246
*    (R0,                                                          1246
*     R1,                                                          1246
*     RTNREG,                                                      1246
*     NTRREG) RSTD;                                                1246
*IRARME39:                          /* SYSEVENT 39 - REQPGDAT        */
*/*                                                                  */
*/*   REQUEST BY SMF FOR USER PAGING AND SWAPPING DATA.              */
*/*                                                                  */
*                                                                  1247
*   IF OUCBINV='0'B&                /* MEMRY STILL VALID AND @Z40BPCH*/
*       OUCBDTA='0'B&               /* USER DATA STILL VALID AND     */
*       OUCBOUT='0'B THEN           /* MEMORY CURRENTLY IN-CORE      */
IRARME39 TM    OUCBINV(OUCBPTR),B'00010000'                        1247
         BNZ   @RF01247                                            1247
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1247
         BNZ   @RF01247                                            1247
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1247
         BNZ   @RF01247                                            1247
*     DO;                                                          1248
*       RESPECIFY                                                  1249
*        (OUXBPTR,                  /* RESTRICT POINTERS             */
*         OUSBPTR,                                                 1249
*         WRKREG2) RSTD;                                           1249
*       OUSBPTR=ASXBOUSB;           /* ADDRESSABILITY TO OUSB        */
         L     @12,ASXBPTR(,ASCBPTR)                               1250
         L     OUSBPTR,ASXBOUSB(,@12)                              1250
*       OUXBPTR=ASCBOUXB;           /* ADDRESSABILITY TO OUXB        */
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1251
*       IF RRPASVC='0'B THEN        /* IF BRANCH ENTERED             */
         TM    RRPASVC(RRPAPTR),B'00100000'                        1252
         BNZ   @RF01252                                            1252
*         DO;                       /* MODESET KEYADDR(RRPAKEY)    1253
*                                      WORKREG(MODESETR)             */
*           MODESETR=RRPAKEY;       /* GET KEY FORM SAVE LOCATION    */
         SLR   MODESETR,MODESETR                                   1254
         IC    MODESETR,RRPAKEY(,RRPAPTR)                          1254
*           SPKA(MODESETR);         /* SET PSW KEY                   */
         SPKA  0(MODESETR)                                         1255
*         END;                      /* MODESET KEYADDR(RRPAKEY)    1256
*                                      WORKREG(MODESETR)     @Z40BPJE*/
*       ELSE                        /* OTHERWISE,                    */
*         DO;                       /* SWITCH TO PROTECT KEY IN      */
         B     @RC01252                                            1257
@RF01252 DS    0H                                                  1258
*           R1=PSATOLD;             /* CURRENT TCB           @Z30WIMG*/
         L     R1,PSATOLD                                          1258
*           GENERATE;                                              1259
*                                                         /*@Z30WIMG*/
         USING TCB,R1
         MODESET EXTKEY=RBT1,WORKREG=10
         DROP  R1
*         END;                      /*                               */
*                                                                  1260
*       /*************************************************************/
*       /*                                                           */
*       /* GET PAGING DATA TOTALS FOR THE JOB OR TSO SESSION. PAGING */
*       /* DATA TOTAL = (TOTAL TO LAST IN-STORAGE INTERVAL) + (TOTAL */
*       /* DURING LAST IN-STORAGE INTERVAL).                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1261
*       SMFPIN=OUSBPIN+OUXBPIN;     /* NUMBER OF PAGE-INS            */
@RC01252 L     @12,RRPAINP(,RRPAPTR)                               1261
         L     @11,OUSBPIN(,OUSBPTR)                               1261
         AL    @11,OUXBPIN(,OUXBPTR)                               1261
         ST    @11,SMFPIN(,@12)                                    1261
*       SMFPOUT=OUSBPOUT+OUXBPOUT;  /* NUMBER OF PAGE-OUTS           */
         L     @11,OUSBPOUT(,OUSBPTR)                              1262
         AL    @11,OUXBPOUT(,OUXBPTR)                              1262
         ST    @11,SMFPOUT(,@12)                                   1262
*       SMFPREC=OUSBPREC+OUXBPREC;  /* NUMBER OF PAGE-RECLAIMS       */
         L     @11,OUSBPREC(,OUSBPTR)                              1263
         AL    @11,OUXBPREC(,OUXBPTR)                              1263
         ST    @11,SMFPREC(,@12)                                   1263
*       SMFVAMI=OUSBVAMI+OUXBVAMI;  /* NUMBER OF VAM PAGE-INS        */
         L     @11,OUSBVAMI(,OUSBPTR)                              1264
         AL    @11,OUXBVAMI(,OUXBPTR)                              1264
         ST    @11,SMFVAMI(,@12)                                   1264
*       SMFVAMO=OUSBVAMO+OUXBVAMO;  /* NUMBER OF VAM PAGE-OUTS       */
         L     @11,OUSBVAMO(,OUSBPTR)                              1265
         AL    @11,OUXBVAMO(,OUXBPTR)                              1265
         ST    @11,SMFVAMO(,@12)                                   1265
*       SMFVAMR=OUSBVAMR+OUXBVAMR;  /* NUMBER OF VAM PAGE-RECLAIMS   */
         L     @11,OUSBVAMR(,OUSBPTR)                              1266
         AL    @11,OUXBVAMR(,OUXBPTR)                              1266
         ST    @11,SMFVAMR(,@12)                                   1266
*       SMFCAPI=OUSBCAPI+OUXBCAPI;  /* NUMBER OF COMMON PAGE INS   1267
*                                                            @Z40BPJE*/
         L     @11,OUSBCAPI(,OUSBPTR)                              1267
         AL    @11,OUXBCAPI(,OUXBPTR)                              1267
         ST    @11,SMFCAPI(,@12)                                   1267
*       SMFCAPR=OUSBCAPR+OUXBCAPR;  /* NUMBER OF COMMON PAGE RECLAIMS
*                                                            @Z40BPJE*/
         L     @11,OUSBCAPR(,OUSBPTR)                              1268
         AL    @11,OUXBCAPR(,OUXBPTR)                              1268
         ST    @11,SMFCAPR(,@12)                                   1268
*       SMFSTCT=OUSBSTCT+OUXBSTCT;  /* NUMBER OF PAGES STOLEN      1269
*                                                            @Z40BPJE*/
         L     @11,OUSBSTCT(,OUSBPTR)                              1269
         AL    @11,OUXBSTCT(,OUXBPTR)                              1269
         ST    @11,SMFSTCT(,@12)                                   1269
*       SMFPGSS=OUCBPSS;            /* NUMBER OF PAGE SECONDS (IN  1270
*                                      MILLISECONDS)         @Z40BPJE*/
*                                                                  1270
         MVC   SMFPGSS(8,@12),OUCBPSS(OUCBPTR)                     1270
*       /*************************************************************/
*       /*                                                           */
*       /* MOVE SWAPPING DATA ACCUMULATED FOR USER TO SMF DATA AREA. */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1271
*       SMFSCNTS=SWPFLDS;           /* MOVE SWAPPING DATA TO SMF AREA*/
         MVC   SMFSCNTS(12,@12),SWPFLDS(OUSBPTR)                   1271
*       GENERATE;                                                  1272
*                                                                  1272
         MODESET EXTKEY=SRM
*       /*************************************************************/
*       /*                                                           */
*       /* RE-INITIALIZE FIELDS IN OUXB AND OUSB.                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1273
*       PGEFLDS=''B;                /* RE-INIT PAGING AND SWAPPING 1273
*                                      FIELDS IN OUSB                */
         XC    PGEFLDS(48,OUSBPTR),PGEFLDS(OUSBPTR)                1273
*       PGEFLDX=''B;                /* RE-INIT PAGING FIELDS IN OUXB */
         XC    PGEFLDX(36,OUXBPTR),PGEFLDX(OUXBPTR)                1274
*       RRPARTC=OK;                 /* REQ FOR PAGING DATA HONORED   */
         MVI   RRPARTC(RRPAPTR),X'00'                              1275
*       RESPECIFY                                                  1276
*        (OUXBPTR,                  /* UNRESTRICT POINTERS           */
*         OUSBPTR,                                                 1276
*         WRKREG2) UNRSTD;                                         1276
*     END;                                                         1277
*   ELSE                            /* USER PAGING DATA INVALID      */
*     RRPARTC=INVLDATA;             /* REQ FOR PAGING DATA IGNORED   */
*                                                                  1278
         B     @RC01247                                            1278
@RF01247 MVI   RRPARTC(RRPAPTR),X'04'                              1278
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1279
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1279
@RC01247 L     @12,RMEXCTL(,RMCTPTR)                               1279
         BR    @12                                                 1279
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1280
*IRARME40:                          /* SYSEVENT 40 - COPYDMDT      1280
*                                                            @Z40BPEB*/
*/* THIS SYSEVENT COPIES THE NUMBER OF VALID DOMAINS AND     @Z40BPEB*/
*/* THE DOMAIN TABLE INTO A FIXED AREA PASSED AS INPUT.      @Z40BPEB*/
*/* THE SYSEVENT IS NEEDED SO THE COPY CAN BE DONE UNDER     @Z40BPEB*/
*/* THE SRM LOCK, WITHOUT FEAR OF SETIPS CHANGING THE DMDT.  @Z40BPEB*/
*/*                                                                  */
*                                                                  1280
*   COPYCNT=RMCTDMNC;               /* COPY DOMAIN COUNT     @Z40BPEB*/
IRARME40 L     @12,RRPAINP(,RRPAPTR)                               1280
         LH    @11,RMCTDMNC(,RMCTPTR)                              1280
         STH   @11,COPYCNT(,@12)                                   1280
*   RFY                                                            1281
*    (COPYTARG,                                                    1281
*     COPYLNG,                                                     1281
*     COPYSRC,                                                     1281
*     COPYLGTH) RSTD;               /* HOLD REGS 6,7,10,11 FOR MVCL.
*                                                            @Z40BPEB*/
*   COPYLNG=COPYCNT*LENGTH(DMDT);   /* LENGTH OF MOVE        @Z40BPEB*/
         ST    @11,@TF00001                                        1282
         L     COPYLNG,@TF00001                                    1282
         MH    COPYLNG,@CH02633                                    1282
*   COPYLGTH=COPYLNG;               /* LENGTH OF SOURCE TOO. @Z40BPEB*/
         LR    COPYLGTH,COPYLNG                                    1283
*   COPYTARG=ADDR(COPYDMDT);        /* ADDR OF TARGET        @Z40BPEB*/
         LA    COPYTARG,COPYDMDT(,@12)                             1284
*   COPYSRC=WMSTDMDT;               /* ADDR OF DMDT (SOURCE) @Z40BPEB*/
         L     @12,WMSTPTR(,RMCTPTR)                               1285
         L     COPYSRC,WMSTDMDT(,@12)                              1285
*   MVCL(COPYTARG,COPYSRC);         /* DUPLICATE THE DMDT    @Z40BPEB*/
         MVCL  COPYTARG,COPYSRC                                    1286
*   RFY                                                            1287
*    (COPYTARG,                                                    1287
*     COPYLNG,                                                     1287
*     COPYSRC,                                                     1287
*     COPYLGTH) UNRSTD;             /*                       @Z40BPEB*/
*   RRPARTC=ZERO;                   /* SUCCESSFUL SYSEVENT   @Z40BPEB*/
         MVI   RRPARTC(RRPAPTR),X'00'                              1288
*/*   ? IRACTLCL EPN(I01)                                            */
*                                                                  1289
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
*                                                                  1289
         L     @12,RMEXI01(,RMCTPTR)                               1289
         BR    @12                                                 1289
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO INTERFACE PGM                               @Z40BPEB*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*IRARME41:                          /* SYSEVENT 41 - DONTSWAP        */
*IRARME42:                          /* SYSEVENT 42 - OKSWAP          */
*   IF RRPASVC='1'B THEN            /* SVC ENTRY TO SRM              */
IRARME41 DS    0H                                                  1290
IRARME42 TM    RRPASVC(RRPAPTR),B'00100000'                        1290
         BNO   @RF01290                                            1290
*     DO;                           /* CHECK AUTHORIZATION TO ISSUE
*                                      SYSEVENT                      */
*                                                                  1291
*       /*************************************************************/
*       /*                                                           */
*       /* SAVE REGISTERS ALTERED BY TESTAUTH.                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1292
*       RESPECIFY                                                  1292
*        (RMCTSAVE,                                                1292
*         RRPASAVE) RSTD;                                          1292
*       RMCTSAVE=RMCTPTR;                                          1293
         LR    RMCTSAVE,RMCTPTR                                    1293
*       RRPASAVE=RRPAPTR;                                          1294
*                                                                  1294
         LR    RRPASAVE,RRPAPTR                                    1294
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK AUTHORIZATION OF MEMORY TO ISSUE SYSEVENT.          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1295
*       GENERATE CODE REFS(CVTAPF,CVT)                             1295
*           (TESTAUTH FCTN=1,STATE=YES,KEY=YES,RBLEVEL=1,BRANCH=YES);
*                                                                  1295
         TESTAUTH FCTN=1,STATE=YES,KEY=YES,RBLEVEL=1,BRANCH=YES
*       /*************************************************************/
*       /*                                                           */
*       /* RESTORE REGISTERS ALTERED BY TESTAUTH.                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1296
*       RMCTPTR=RMCTSAVE;                                          1296
         LR    RMCTPTR,RMCTSAVE                                    1296
*       RRPAPTR=RRPASAVE;                                          1297
         LR    RRPAPTR,RRPASAVE                                    1297
*       RESPECIFY                                                  1298
*        (RMCTSAVE,                                                1298
*         RRPASAVE) UNRSTD;                                        1298
*       IF RTNCOD^=ZERO&            /* MEMORY NOT AUTH BY TESTAUTH & */
*           OUCBASW='0'B THEN       /* NO AUTHORIZATION FROM PREVIOUS
*                                      INITATT SYSEVENT              */
         LTR   RTNCOD,RTNCOD                                       1299
         BZ    @RF01299                                            1299
         TM    OUCBASW(OUCBPTR),B'00000001'                        1299
         BNZ   @RF01299                                            1299
*         DO;                                                      1300
*           RRPARI3=NOAUTH;         /* USER NOT AUTHORIZED           */
*                                                                  1301
         MVI   RRPARI3(RRPAPTR),X'08'                              1301
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(CTL)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1302
*           GOTO RMEXCTL->IRARMNTR; /* EXIT TO CTL FUNCT             */
*                                                                  1302
         L     @12,RMEXCTL(,RMCTPTR)                               1302
         BR    @12                                                 1302
*           /*********************************************************/
*           /*                                                       */
*           /* ENTER SRM CONTROL ROUTINE                             */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1303
*         END;                                                     1303
*     END;                                                         1304
@RF01299 DS    0H                                                  1305
*   IF ASCBPTR=PSAAOLD THEN         /* MEMORY AFFECTED BY SYSEVENT IS
*                                      THE CURRENT MEMORY            */
@RF01290 C     ASCBPTR,PSAAOLD                                     1305
         BNE   @RF01305                                            1305
*     DO;                                                          1306
*       RRPARI3=OK;                 /* REQUEST FOR MEMORY STATUS   1307
*                                      CHANGE HONORED                */
         MVI   RRPARI3(RRPAPTR),X'00'                              1307
*       IF RRPACOD=SYSEVT41 THEN    /* IF SYSEVENT 41,               */
         CLI   RRPACOD(RRPAPTR),41                                 1308
         BNE   @RF01308                                            1308
*         DO;                                                      1309
*           OUCBNSW='1'B;           /* MEMORY IS NON-SWAPPABLE       */
         OI    OUCBNSW(OUCBPTR),B'10000000'                        1310
*           OUCBNDS=OUCBNDS+ONE;    /* INCREMENT NO. OF OUTSTANDING
*                                      DONTSWAP SYSEVENTS            */
         LA    @12,1                                               1311
         AH    @12,OUCBNDS(,OUCBPTR)                               1311
         STH   @12,OUCBNDS(,OUCBPTR)                               1311
*           IF OUCBNDS<ZERO THEN    /* IF NO. OF DONTSWAP    @ZA20975*/
         LH    @12,OUCBNDS(,OUCBPTR)                               1312
         LTR   @12,@12                                             1312
         BNM   @RF01312                                            1312
*             DO;                   /* SYSEVENTS EXCEEDS 32767,      */
*               RRPARI3=NOAUTH;     /* DONTSWAP SYSEVENT IGNORED     */
         MVI   RRPARI3(RRPAPTR),X'08'                              1314
*               OUCBNDS=CON32767;   /* RESET COUNT TO MAXIMUM        */
         MVC   OUCBNDS(2,OUCBPTR),@CH02502                         1315
*             END;                                                 1316
*           IF OUCBNDS=ONE THEN     /* MEMORY BECAME NONSWAPPABLE  1317
*                                                            @ZA10102*/
*                                                                  1317
@RF01312 CLC   OUCBNDS(2,OUCBPTR),@CH00078                         1317
         BNE   @RF01317                                            1317
*             /*******************************************************/
*             /*                                                     */
*             /* ? IRACTLCL EPN(WMK)                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1318
*             CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN            */
*                                                                  1318
         L     @15,RMSBWMK(,RMCTPTR)                               1318
         BALR  @14,@15                                             1318
*           /*********************************************************/
*           /*                                                       */
*           /* INVOKE WMK SUBRTN                             @ZA10102*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1319
*         END;                                                     1319
*       ELSE                        /* SYSEVENT 42                   */
*         DO;                                                      1320
         B     @RC01308                                            1320
@RF01308 DS    0H                                                  1321
*           IF OUCBNDS>ONE×(OUCBNDS=ONE&ASCBVEQR='0'B) THEN/*      1321
*                                      OUTSTANDING DONTSWAP SYSEVENTS
*                                      BUT DON'T LET A V=R JOB BECOME
*                                      SWAPPABLE             @ZA16887*/
         LA    @12,1                                               1321
         CH    @12,OUCBNDS(,OUCBPTR)                               1321
         BL    @RT01321                                            1321
         CH    @12,OUCBNDS(,OUCBPTR)                               1321
         BNE   @RF01321                                            1321
         TM    ASCBVEQR(ASCBPTR),B'00010000'                       1321
         BNZ   @RF01321                                            1321
@RT01321 DS    0H                                                  1322
*             OUCBNDS=OUCBNDS-ONE;  /* DECREMENT COUNT OF NO. OF   1322
*                                      OUTSTANDING DONTSWAP SYSEVENTS*/
         LH    @12,OUCBNDS(,OUCBPTR)                               1322
         BCTR  @12,0                                               1322
         STH   @12,OUCBNDS(,OUCBPTR)                               1322
*           IF OUCBNDS=ZERO THEN    /* NO OUTSTANDING DONTSWAP       */
@RF01321 LH    @12,OUCBNDS(,OUCBPTR)                               1323
         LTR   @12,@12                                             1323
         BNZ   @RF01323                                            1323
*             DO;                   /* SYSEVENT, CHANGE MEMORY STATUS*/
*               OUCBNSW='0'B;       /* MEMORY IS SWAPPABLE           */
         NI    OUCBNSW(OUCBPTR),B'01111111'                        1325
*/*   ? IRACTLCL EPN(WMK)                                            */
*                                                                  1326
*               CALL RMSBWMK->IRARMRTN;/* INVOKE WMK SUBRTN          */
*                                                                  1326
         L     @15,RMSBWMK(,RMCTPTR)                               1326
         BALR  @14,@15                                             1326
*               /*****************************************************/
*               /*                                                   */
*               /* TELL WLM, MEMORY IS NOW SWAPPABLE         @ZA10102*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  1327
*               IF OUCBRSWP='1'B    /* Q. REQSWAP PENDING?   @ZA31733*/
*                 THEN                                             1327
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       1327
         BNO   @RF01327                                            1327
*                 CALL EVTCSOD;     /* YES. ATTEMPT SWAP OUT @ZA31733*/
         BAL   @14,EVTCSOD                                         1328
*             END;                  /*                               */
*         END;                                                     1330
*     END;                                                         1331
*   ELSE                            /* MEMORY AFFECTED NOT CURRENT   */
*     RRPARI3=INVLDREQ;             /* REQUEST IGNORED               */
*                                                                  1332
         B     @RC01305                                            1332
@RF01305 MVI   RRPARI3(RRPAPTR),X'04'                              1332
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1333
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1333
@RC01305 L     @12,RMEXCTL(,RMCTPTR)                               1333
         BR    @12                                                 1333
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1334
*IRARME43:                          /* SYSEVENT 43 - REQSWAP         */
*/*                                                                  */
*/*   SWAP-OUT OF A PARTICULAR MEMORY IS REQUIRED.                   */
*/*    IF REGISTER 1 IS NOT ZERO, THE ECB IT POINTS TO WILL BE       */
*/*   POSTED DURING SWAPOUT COMPLETE PROCESSING. THUS THE MEMORY     */
*/*   WILL IMMEDIATELY BE ELIGIBLE FOR SWAPIN.                       */
*/*                                                                  */
*                                                                  1334
*   RFY                                                            1334
*     OUXBPTR RSTD;                 /* HOLD REGISTER         @ZA16887*/
IRARME43 DS    0H                                                  1335
*   IF RRPAINP=ZERO×ASCBPTR=PSAAOLD THEN/* IF AN ECB IS SPECIFIED, 1335
*                                      THE REQUEST MUST BE FOR THE 1335
*                                      CURRENT A.S.          @ZA16887*/
         L     @12,RRPAINP(,RRPAPTR)                               1335
         LTR   @12,@12                                             1335
         BZ    @RT01335                                            1335
         C     ASCBPTR,PSAAOLD                                     1335
         BNE   @RF01335                                            1335
@RT01335 DS    0H                                                  1336
*     IF OUCBNSW='0'B THEN          /* SWAPPABLE?            @ZA16887*/
         TM    OUCBNSW(OUCBPTR),B'10000000'                        1336
         BNZ   @RF01336                                            1336
*       DO;                         /* CONTINUE REQSWAP      @ZA16887*/
*         OUXBPTR=ASCBOUXB;         /* GET ADDR OF OUXB      @ZA16887*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1338
*         IF OUCBRSWP='0'B THEN     /* NO OTHER REQSWAP PENDING?   1339
*                                                            @ZA16887*/
         TM    OUCBRSWP(OUCBPTR),B'00100000'                       1339
         BNZ   @RF01339                                            1339
*           IF OUCBOUT='0'B×OUCBGOI='1'B×/* A.S. IN STORAGE OR     1340
*                                                            @ZA16887*/
*               OUCBGOO='1'B THEN   /* TRANSITIONING?        @ZA16887*/
         TM    OUCBGOI(OUCBPTR),B'11000000'                        1340
         BNZ   @RT01340                                            1340
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1340
         BO    @RF01340                                            1340
@RT01340 DS    0H                                                  1341
*             DO;                   /* OK TO BEGIN SWAPOUT / @ZA16887*/
*/*  ? IRACTLCL EPN(CSO)                                             */
*                                                                  1342
*               DO;                                                1342
*                 R1=ADDR(RMEPBCSO);/* CSO REQUEST IS PARAM          */
         LA    R1,RMEPBCSO(,RMCTPTR)                               1343
*                 CALL RMSBCRY->IRARMRTN;/* ACTION INVK FUNCT        */
         L     @15,RMSBCRY(,RMCTPTR)                               1344
         BALR  @14,@15                                             1344
*               END;                /* INVOKE SWAPOUT ROUTINE      1345
*                                                            @ZA16887*/
*               IF RETNCODE=ZERO×   /* SWAPOUT WAS BEGUN OR  @ZA16887*/
*                   RETNCODE=CON8 THEN/* A.S WAS TRANSITIONING     1346
*                                                            @ZA16887*/
         LTR   RETNCODE,RETNCODE                                   1346
         BZ    @RT01346                                            1346
         C     RETNCODE,@CF00152                                   1346
         BNE   @RF01346                                            1346
@RT01346 DS    0H                                                  1347
*                 DO;               /* CONTINUE REQSWAP      @ZA16887*/
*                   OUCBRSWP='1'B;  /* REQSWAP IS PENDING    @ZA16887*/
         OI    OUCBRSWP(OUCBPTR),B'00100000'                       1348
*                   OUXBRSW=RRPAINP;/* STORE ECB ADDRESS, IF THERE IS
*                                      ONE                   @ZA16887*/
         L     @12,RRPAINP(,RRPAPTR)                               1349
         ST    @12,OUXBRSW(,OUXBPTR)                               1349
*                   IF RETNCODE=ZERO THEN/* SWAPOUT WAS BEGUN      1350
*                                                            @ZA16887*/
         LTR   RETNCODE,RETNCODE                                   1350
         BNZ   @RF01350                                            1350
*                     DO;           /* SO FINISH REQSWAP     @ZA16887*/
*                       OUCBLWT='0'B;/* RESET LONG           @ZA16887*/
*                       OUCBMWT='0'B;/* WAIT FLAGS           @ZA16887*/
*                       OUCBTRM='0'B;/* INDICATE NO TERMWAIT SWAPOUT
*                                                            @ZA16887*/
         NI    OUCBLWT(OUCBPTR),B'00111110'                        1354
*                       OUCBSRC=SRCDRQSC;/* COUNT THIS REQSWAP     1355
*                                                            @ZA16887*/
         MVI   OUCBSRC(OUCBPTR),X'07'                              1355
*                       IF RRPASVC='1'B THEN/* SVC ENTRY TO SRM    1356
*                                                            @ZA16887*/
         TM    RRPASVC(RRPAPTR),B'00100000'                        1356
         BNO   @RF01356                                            1356
*                         RRPARTN=CVTEXP1;/* FORCE EXIT THRU       1357
*                                      DISPATCHER TO ALLOW SWAPOUT TO
*                                      RUN                   @ZA16887*/
         L     @12,CVTPTR                                          1357
         L     @12,CVTEXP1(,@12)                                   1357
         ST    @12,RRPARTN(,RRPAPTR)                               1357
*                     END;          /* END RC=0 CASE         @ZA16887*/
@RF01356 DS    0H                                                  1359
*                   RRPARI3=ZERO;   /* SUCCESSFUL REQSWAP    @ZA16887*/
@RF01350 MVI   RRPARI3(RRPAPTR),X'00'                              1359
*                 END;              /* END RC=0 OR 8 CASE    @ZA16887*/
*               ELSE                /* RC=4 FROM SWAPOUT     @ZA16887*/
*                 DO;               /* MEANS INVALID SRM DATA      1361
*                                                            @ZA16887*/
         B     @RC01346                                            1361
@RF01346 DS    0H                                                  1362
*                   RESNCODE=CON24; /*                       @ZA16887*/
         LA    RESNCODE,24                                         1362
*/*  ? IRACTLCL EPN(I10)                                             */
*                                                                  1363
*                   CALL RMSBI10->IRARMRTN;/* ABEND THIS SYSEVT      */
*                                                                  1363
         L     @15,RMSBI10(,RMCTPTR)                               1363
         BALR  @14,@15                                             1363
*                   /*************************************************/
*                   /*                                               */
*                   /* FRR WILL CONVERT TO 25F ABEND         @ZA16887*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1364
*                 END;              /*                       @ZA16887*/
*             END;                  /* END IN-STORAGE CASE   @ZA16887*/
*           ELSE                    /* A.S. IS OUT OF STORAGE      1366
*                                                            @ZA16887*/
*             RRPARI3=CON12;        /* TELL REQSWAP ISSUER   @ZA16887*/
         B     @RC01340                                            1366
@RF01340 MVI   RRPARI3(RRPAPTR),X'0C'                              1366
*         ELSE                      /* ANOTHER REQ WAS PENDING     1367
*                                                            @ZA16887*/
*           DO;                     /* INVOKE SUBROUTINE     @ZA20975*/
         B     @RC01339                                            1367
@RF01339 DS    0H                                                  1368
*             R1=ADDR(OUXBRSW);     /* TO STORE ECB ADDR     @ZA20975*/
         LA    R1,OUXBRSW(,OUXBPTR)                                1368
*             CALL EVTSTACK;        /* IF ONE IS SPEC'D.     @ZA20975*/
         BAL   @14,EVTSTACK                                        1369
*             RRPARI3=ZERO;         /* NORMAL REQSWAP        @ZA16887*/
         MVI   RRPARI3(RRPAPTR),X'00'                              1370
*           END;                    /* END PENDING CASE      @ZA20975*/
*       END;                        /* END SWAPPABLE CASE    @ZA16887*/
*     ELSE                          /* A.S. IS NONSWAPPABLE  @ZA16887*/
*       DO;                         /*                       @ZA31733*/
         B     @RC01336                                            1373
@RF01336 DS    0H                                                  1374
*         RRPARI3=CON4;             /* TELL REQSWAP ISSUER.  @ZA16887*/
         MVI   RRPARI3(RRPAPTR),X'04'                              1374
*         OUCBRSWP='1'B;            /* SET REQUEST SWAP PENDING LATCH
*                                                            @ZA31733*/
         OI    OUCBRSWP(OUCBPTR),B'00100000'                       1375
*       END;                        /*                       @ZA31733*/
*   ELSE                            /* ECB WAS SPECIFIED,    @ZA16887*/
*     DO;                           /* REMOTE A.S.,          @ZA16887*/
         B     @RC01335                                            1377
@RF01335 DS    0H                                                  1378
*       RESNCODE=CON4;              /* ABEND 15F RC=4        @ZA16887*/
         LA    RESNCODE,4                                          1378
*/*  ? IRACTLCL EPN(I10)                                             */
*                                                                  1379
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */
*                                                                  1379
         L     @15,RMSBI10(,RMCTPTR)                               1379
         BALR  @14,@15                                             1379
*       /*************************************************************/
*       /*                                                           */
*       /* INVALID INPUT TO SRM                              @ZA16887*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1380
*     END;                          /*                       @ZA16887*/
*/*  ? IRACTLCL EPN(CTL)                                             */
*                                                                  1381
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1381
@RC01335 L     @12,RMEXCTL(,RMCTPTR)                               1381
         BR    @12                                                 1381
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT TO CONTROL                                       @ZA16887*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1382
*   RFY                                                            1382
*     OUXBPTR UNRSTD;               /* FREE UP REGISTER      @ZA16887*/
*IRARME44:                          /* SYSEVENT 44 - BRINGIN         */
*   IF OUCBOUT='1'B THEN            /* ADDRESS SPACE OUT OF STORAGE  */
IRARME44 TM    OUCBOUT(OUCBPTR),B'00000100'                        1383
         BNO   @RF01383                                            1383
*     DO;                           /* MAKE THE ADDRESS SPACE READY  */
*       OUCBBIB='1'B;               /* EXPEDITE SWAP-IN PROCESSING 1385
*                                                            @Z40BPJE*/
         OI    OUCBBIB(OUCBPTR),B'00100000'                        1385
*       IF OUCBGOO='1'B×            /* TRANSITIONING INTO OR         */
*           OUCBGOI='1'B THEN       /* OUT OF MAIN STORAGE,  @Z40BPJE*/
         TM    OUCBGOO(OUCBPTR),B'11000000'                        1386
         BZ    @RF01386                                            1386
*         RRPARI3=NOAUTH;           /* BRINGIN SYSEVENT UNSUCCESSFUL */
         MVI   RRPARI3(RRPAPTR),X'08'                              1387
*       IF OUCBOFF='1'B×            /* ADDRESS SPACE ON WAIT QUEUE OR*/
*           OUCBRDY='0'B THEN       /* ADDRESS SPACE NOT MARKED READY*/
*                                                                  1388
@RF01386 TM    OUCBOFF(OUCBPTR),B'00001000'                        1388
         BO    @RT01388                                            1388
         TM    OUCBRDY(OUCBPTR),B'10000000'                        1388
         BNZ   @RF01388                                            1388
@RT01388 DS    0H                                                  1389
*         /***********************************************************/
*         /*                                                         */
*         /* FORCE READY CONDITION TO INSURE ADDRESS SPACE SWAP-IN   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  1389
*         DO;                                                      1389
*           OUCBRDYB='1'B;          /* ADDRESS SPACE READY           */
         L     @12,OUCBRDYB-2(,OUCBPTR)                            1390
@GL00065 LR    @11,@12                                             1390
         O     @11,@CF02688                                        1390
         CS    @12,@11,OUCBRDYB-2(OUCBPTR)                         1390
         BNE   @GL00065                                            1390
*           ASCBOUTB='0'B;          /* PREVENT USER READY SYSEVENTS  */
*           ASCBTLWT='0'B;          /* PREVENT WAIT TIME LIMIT CHEK  */
*                                                                  1392
         L     @12,ASCBTLWT-2(,ASCBPTR)                            1392
@GL00066 LR    @11,@12                                             1392
         N     @11,@CF02691                                        1392
         CS    @12,@11,ASCBTLWT-2(ASCBPTR)                         1392
         BNE   @GL00066                                            1392
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(HIT)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1393
*           DO;                                                    1393
*             R1=ADDR(RMEPBHIT);    /* HIT REQUEST IS PARAM          */
         LA    R1,RMEPBHIT(,RMCTPTR)                               1394
*             CALL RMSBCRN->IRARMRTN;/* ACTION INVK FUNCT            */
         L     @15,RMSBCRN(,RMCTPTR)                               1395
         BALR  @14,@15                                             1395
*           END;                                                   1396
*         END;                                                     1397
*     END;                                                         1398
*   ELSE                            /* ADDRESS SPACE STILL IN STORAGE*/
*     IF OUCBGOO='1'B THEN          /* IF SWAP-OUT HAS BEEN STARTED  */
         B     @RC01383                                            1399
@RF01383 TM    OUCBGOO(OUCBPTR),B'10000000'                        1399
         BNO   @RF01399                                            1399
*       OUCBCTI='1'B;               /* PROHIBIT SWAP-OUT FROM      1400
*                                      COMPLETING                    */
         OI    OUCBCTI(OUCBPTR),B'01000000'                        1400
*/*   ? IRACTLCL EPN(CTL)                                            */
*                                                                  1401
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
@RF01399 DS    0H                                                  1401
@RC01383 L     @12,RMEXCTL(,RMCTPTR)                               1401
         BR    @12                                                 1401
*IRARME45:                          /* SYSEVENT 45 - WKLDINIT        */
*   IF(RMCTMFA='1'B×                /* DATA COLLECTION ALREADY ACTIVE*/
*       RMCTSTW='1'B&               /* OR SET TO NEW IPS SYSEVENT  1402
*                                      OCCURRED TERMINATING DATA   1402
*                                      COLLECTION AND                */
*       RMCTWAMT^=ZERO) THEN        /* DATA COLECTION BUFFER EXISTS  */
IRARME45 TM    RMCTMFA(RMCTPTR),B'10000000'                        1402
         BO    @RT01402                                            1402
         TM    RMCTSTW(RMCTPTR),B'00000100'                        1402
         BNO   @RF01402                                            1402
         L     @12,RMCTWAMT(,RMCTPTR)                              1402
         LTR   @12,@12                                             1402
         BZ    @RF01402                                            1402
@RT01402 DS    0H                                                  1403
*     RRPARTC=ALRDYACT;             /* INITIALIZATION NOT PERFORMED  */
         MVI   RRPARTC(RRPAPTR),X'20'                              1403
*   ELSE                            /* DATA COLLECTION NOT ACTIVE    */
*     DO;                           /* INITIALIZE FOR MF/1 WORKLOAD
*                                      ACTIVITY DATA COLLECTION      */
         B     @RC01402                                            1404
@RF01402 DS    0H                                                  1405
*       RESPECIFY                                                  1405
*         WAMTPTR RSTD;                                            1405
*       WAMTPTR=RRPAINP;            /* ADDRESSABILITY TO WAMT        */
         L     WAMTPTR,RRPAINP(,RRPAPTR)                           1406
*       RRPAWAR='1'B;               /* WORKLOAD ACTIVITY ROUTINE IN
*                                      CONTROL FOR RECOVERY          */
         OI    RRPAWAR(RRPAPTR),B'01000000'                        1407
*       CALL IRARMWR1;              /* INITIALIZE DATA COLLECTION  1408
*                                      BUFFER AND INITIATE WORKLOAD
*                                      ACTIVITY DATA COLLECTION      */
         L     @12,WAMTWAR(,WAMTPTR)                               1408
         L     @15,WARTABLE(,@12)                                  1408
         BALR  @14,@15                                             1408
*       RRPAWAR='0'B;               /* WORKLOAD ACTIVITY ROUTINE NO
*                                      LONGER IN CONTROL             */
         NI    RRPAWAR(RRPAPTR),B'10111111'                        1409
*       RESPECIFY                                                  1410
*         WAMTPTR UNRSTD;                                          1410
*     END;                                                         1411
*                                                                  1411
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1412
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1412
@RC01402 L     @12,RMEXCTL(,RMCTPTR)                               1412
         BR    @12                                                 1412
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1413
*IRARME46:                          /* SYSEVENT 46 - WKLDCOLL        */
*   RESPECIFY                                                      1413
*    (WAMTPTR) RSTD;                                               1413
IRARME46 DS    0H                                                  1414
*   WAMTPTR=RMCTWAMT;               /* ADDRESSABILITY TO DATA      1414
*                                      COLLECTION BUFFER             */
         L     WAMTPTR,RMCTWAMT(,RMCTPTR)                          1414
*   IF(RMCTMFA='1'B×                /* DATA COLLECTION ACTIVE OR     */
*       RMCTSTW='1'B)&              /* SET TO NEW IPS SYSEVENT     1415
*                                      OCCURRED TERMINATING WORKLOAD
*                                      ACTIVITY DATA COLLECTION AND  */
*       WAMTPTR^=ZERO THEN          /* DATA COLLECTION BUFFER EXISTS */
         TM    RMCTMFA(RMCTPTR),B'10000100'                        1415
         BZ    @RF01415                                            1415
         LTR   WAMTPTR,WAMTPTR                                     1415
         BZ    @RF01415                                            1415
*     DO;                                                          1416
*       RRPAWAR='1'B;               /* WORKLOAD ACTIVITY ROUTINE IN
*                                      CONTROL FOR RECOVERY          */
         OI    RRPAWAR(RRPAPTR),B'01000000'                        1417
*       CALL IRARMWR3;              /* COLLECT WORKLOAD ACTIVITY DATA*/
         L     @12,WAMTWAR(,WAMTPTR)                               1418
         L     @15,WARTABLE+4(,@12)                                1418
         BALR  @14,@15                                             1418
*       RRPAWAR='0'B;               /* WORKLOAD ACTIVITY ROUTINE NO
*                                      LONGER IN CONTROL             */
         NI    RRPAWAR(RRPAPTR),B'10111111'                        1419
*     END;                                                         1420
*   ELSE                            /* DATA COLLECTION NOT ACTIVE OR
*                                      COLLECTION BUFFER NON-EXISTANT*/
*     RRPARTC=NOTACTVE;             /* REQUEST FOR DATA IGNORED      */
         B     @RC01415                                            1421
@RF01415 MVI   RRPARTC(RRPAPTR),X'40'                              1421
*   RESPECIFY                                                      1422
*    (WAMTPTR) UNRSTD;                                             1422
*                                                                  1422
@RC01415 DS    0H                                                  1423
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1423
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1423
         L     @12,RMEXCTL(,RMCTPTR)                               1423
         BR    @12                                                 1423
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1424
*IRARME47:                          /* SYSEVENT 47 - WKLDTERM        */
*   IF(RMCTMFA='1'B×                /* DATA COLLECTION ACTIVE OR     */
*       RMCTSTW='1'B)&              /* SET TO NEW IPS SYSEVENT     1424
*                                      OCCURRED TERMINATING WORKLOAD
*                                      ACTIVITY DATA COLLECTION AND  */
*       RMCTWAMT^=ZERO THEN         /* DATA COLLECTION BUFFER EXISTS */
IRARME47 TM    RMCTMFA(RMCTPTR),B'10000100'                        1424
         BZ    @RF01424                                            1424
         SLR   @12,@12                                             1424
         L     @11,RMCTWAMT(,RMCTPTR)                              1424
         CR    @11,@12                                             1424
         BE    @RF01424                                            1424
*     DO;                           /* TERMINATE WORKLOAD ACTIVITY 1425
*                                      DATA COLLECTION               */
*       RMCTMFA='0'B;               /* DEACTIVATE DATA COLLECTION    */
*       RMCTSTW='0'B;               /* TURN OFF INDICATOR            */
         NI    RMCTMFA(RMCTPTR),B'01111011'                        1427
*       RRPAINP=RMCTWAMT;           /* RETURN ADDRESS OF WORKLOAD  1428
*                                      COLLECTION BUFFER             */
         ST    @11,RRPAINP(,RRPAPTR)                               1428
*       RMCTWAMT=ZERO;              /* CLEAR BUFFER ADDRESS          */
         ST    @12,RMCTWAMT(,RMCTPTR)                              1429
*       RMSBWR4=RMSBNOP;            /* RESET PERIOD ACCUML RTN ADDR  */
         L     @12,RMSBNOP(,RMCTPTR)                               1430
         ST    @12,RMSBWR4(,RMCTPTR)                               1430
*       RMSBWR6=RMSBNOP;            /* RESET XACTN END CNT RTN ADDR  */
         ST    @12,RMSBWR6(,RMCTPTR)                               1431
*       RRPARTC=ZERO;               /* WAR TERMINATION COMPLETE      */
         MVI   RRPARTC(RRPAPTR),X'00'                              1432
*     END;                                                         1433
*   ELSE                            /* DATA COLLECTION NOT ACTIVE OR
*                                      COLLECTION BUFFER NON-EXISTANT*/
*     RRPARTC=NOTACTVE;             /* TERMINATION REQUEST IGNORED   */
*                                                                  1434
         B     @RC01424                                            1434
@RF01424 MVI   RRPARTC(RRPAPTR),X'40'                              1434
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(CTL)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1435
*   GOTO RMEXCTL->IRARMNTR;         /* EXIT TO CTL FUNCT             */
*                                                                  1435
@RC01424 L     @12,RMEXCTL(,RMCTPTR)                               1435
         BR    @12                                                 1435
*   /*****************************************************************/
*   /*                                                               */
*   /* ENTER SRM CONTROL ROUTINE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1436
*IRARME48:                          /* SYSEVENT 48 - INTERNAL EVENT  */
*   RESPECIFY                                                      1436
*     SRBPTR RSTD;                                                 1436
IRARME48 DS    0H                                                  1437
*   IF RRPASVC='0'B&                /* IF BRANCH ENTRY AND           */
*       RRPAKEY=ZERO THEN           /* INVOKER IN STORAGE KEY ZERO,  */
         TM    RRPASVC(RRPAPTR),B'00100000'                        1437
         BNZ   @RF01437                                            1437
         CLI   RRPAKEY(RRPAPTR),0                                  1437
         BNE   @RF01437                                            1437
*     DO;                                                          1438
*       RRPASVC='1'B;                                              1439
*       RRPAENB='0'B;                                              1440
*       RRPADSB='0'B;                                              1441
         OI    RRPASVC(RRPAPTR),B'00100000'                        1441
         NI    RRPAENB(RRPAPTR),B'00111111'                        1441
*       SRBPTR=RRPAINP;             /* SRB ADDRESS                   */
         L     SRBPTR,RRPAINP(,RRPAPTR)                            1442
*       SRBPARM=ZERO;               /* ALLOW SRM SRB TO BE         1443
*                                      RESCHEDULED                   */
*                                                                  1443
         SLR   @12,@12                                             1443
         ST    @12,SRBPARM(,SRBPTR)                                1443
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(CTL)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1444
*       GOTO RMEXCTL->IRARMNTR;     /* EXIT TO CTL FUNCT             */
*                                                                  1444
         L     @12,RMEXCTL(,RMCTPTR)                               1444
         BR    @12                                                 1444
*       /*************************************************************/
*       /*                                                           */
*       /* ENTER SRM CONTROL ROUTINE                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1445
*     END;                                                         1445
*   ELSE                            /* INVALID INVOCATION            */
*     DO;                           /* INDICATE UNAUTHORIZED PROGRAM */
@RF01437 DS    0H                                                  1447
*       RESNCODE=CON8;              /* ABEND REASON CODE             */
*                                                                  1447
         LA    RESNCODE,8                                          1447
*       /*************************************************************/
*       /*                                                           */
*       /* ? IRACTLCL EPN(I10)                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1448
*       CALL RMSBI10->IRARMRTN;     /* ABEND THIS SYSEVT             */
         L     @15,RMSBI10(,RMCTPTR)                               1448
         BALR  @14,@15                                             1448
*     END;                          /*                               */
*   RESPECIFY                                                      1450
*     SRBPTR UNRSTD;                                               1450
*IRARME49:                          /* SYSEVENT 49 - REQSVDAT      1451
*                                                            @ZM43092*/
*/*                                                          @ZM43092*/
*/*   REQUEST BY SMF FOR USER SERVICE DATA.                  @ZM43092*/
*/*                                                          @ZM43092*/
*                                                                  1451
*   RFY                                                            1451
*    (R0,                                                          1451
*     RTNREG,                                                      1451
*     NTRREG) UNRSTD;               /*                       @ZM43092*/
IRARME49 DS    0H                                                  1452
*   RQSVDATA=''B;                   /* ZERO COLLECTION AREA  @ZM43092*/
         L     @14,RQSVPTR(,RMCTPTR)                               1452
         XC    RQSVDATA(16,@14),RQSVDATA(@14)                      1452
*   IF OUCBINV='0'B&                /* MEMORY IS VALID       @ZM43092*/
*       OUCBDTA='0'B&               /* USER DATA VALID       @ZM43092*/
*       OUCBOUT='0'B THEN           /* MEMORY IN CORE        @ZM43092*/
         TM    OUCBINV(OUCBPTR),B'00010000'                        1453
         BNZ   @RF01453                                            1453
         TM    OUCBDTA(OUCBPTR),B'00000010'                        1453
         BNZ   @RF01453                                            1453
         TM    OUCBOUT(OUCBPTR),B'00000100'                        1453
         BNZ   @RF01453                                            1453
*     DO;                           /* COLLECT DATA          @ZM43092*/
*       RFY                                                        1455
*         OUXBPTR RSTD;             /* HOLD THIS REG.        @ZM43092*/
*       OUXBPTR=ASCBOUXB;           /* DATA ADDRESSABILITY   @ZM43092*/
         L     OUXBPTR,ASCBOUXB(,ASCBPTR)                          1456
*       RQSVSRV=OUXBJBS+OUXBTRS;    /* SRV TO LAST SWAP-IN   @ZM43092*/
         L     @12,OUXBJBS(,OUXBPTR)                               1457
         AL    @12,OUXBTRS(,OUXBPTR)                               1457
         ST    @12,RQSVSRV(,@14)                                   1457
*       RQSVTIM=OUXBJBT+OUXBTRT;    /* TRANSACTION ACTIVE TIME TO  1458
*                                      LAST SWAP-IN          @ZM43092*/
         L     @12,OUXBJBT(,OUXBPTR)                               1458
         AL    @12,OUXBTRT(,OUXBPTR)                               1458
         ST    @12,RQSVTIM(,@14)                                   1458
*       RQSVSRT=OUXBJBR+OUXBTRR;    /* SESSION RESIDENCY TIME      1459
*                                                            @ZA14216*/
         L     @12,OUXBJBR(,OUXBPTR)                               1459
         AL    @12,OUXBTRR(,OUXBPTR)                               1459
         ST    @12,RQSVSRT(,@14)                                   1459
*       RQSVPGN=OUCBNPG;            /* LAST PGN FOR MEMORY   @ZM43092*/
         SLR   @12,@12                                             1460
         IC    @12,OUCBNPG(,OUCBPTR)                               1460
         STH   @12,RQSVPGN(,@14)                                   1460
*       IF OUCBLOG='1'B             /* FOR TSO USER, GET     @ZM43092*/
*         THEN                                                     1461
         TM    OUCBLOG(OUCBPTR),B'00100000'                        1461
         BNO   @RF01461                                            1461
*         RQSVTRC=OUXBTRC;          /* TRANSACTION COUNT     @ZM43092*/
         L     @12,OUXBTRC(,OUXBPTR)                               1462
         STH   @12,RQSVTRC(,@14)                                   1462
*       IF OUCBINC='1'B THEN        /* USER UNDER WLM CONTROL      1463
*                                                            @ZM43092*/
@RF01461 TM    OUCBINC(OUCBPTR),B'00000001'                        1463
         BNO   @RF01463                                            1463
*         DO;                       /* GET THIS INTERVAL DATA      1464
*                                                            @ZM43092*/
*                                                                  1464
*           /*********************************************************/
*           /*                                                       */
*           /* ? IRACTLCL EPN(WM1)                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1465
*           CALL RMSBWM1->IRARMRTN; /* INVOKE WM1 SUBRTN             */
         L     @15,RMSBWM1(,RMCTPTR)                               1465
         BALR  @14,@15                                             1465
*           RQSVSRV=RQSVSRV+OUCBWMS;/* SERVICE THIS INTERVAL @ZM43092*/
         L     @14,RQSVPTR(,RMCTPTR)                               1466
         L     @12,RQSVSRV(,@14)                                   1466
         AL    @12,OUCBWMS(,OUCBPTR)                               1466
         ST    @12,RQSVSRV(,@14)                                   1466
*           RQSVTIM=RQSVTIM+        /* TRANSACTION ACTIVE    @ZM43092*/
*               (RMCTTOD-OUCBTMS);  /* TIME THIS INTERVAL    @ZM43092*/
         L     @12,RMCTTOD(,RMCTPTR)                               1467
         SL    @12,OUCBTMS(,OUCBPTR)                               1467
         L     @07,RQSVTIM(,@14)                                   1467
         ALR   @07,@12                                             1467
         ST    @07,RQSVTIM(,@14)                                   1467
*           RQSVSRT=RQSVSRT+(RMCTTOD-OUCBTMS);/* SESSION RESIDENCY 1468
*                                      TIME INCLUDING THIS INTERVAL
*                                                            @ZA14216*/
         AL    @12,RQSVSRT(,@14)                                   1468
         ST    @12,RQSVSRT(,@14)                                   1468
*         END;                      /*                       @ZM43092*/
*       RRPARTC=OK;                 /* REQUEST SUCCESSFUL    @ZM43092*/
@RF01463 MVI   RRPARTC(RRPAPTR),X'00'                              1470
*       RFY                                                        1471
*         OUXBPTR UNRSTD;           /* FREE UP THIS REG.     @ZM43092*/
*     END;                          /*                       @ZM43092*/
*   ELSE                            /*                       @ZM43092*/
*     RRPARTC=INVLDATA;             /* REQUEST IGNORED       @ZM43092*/
         B     @RC01453                                            1473
@RF01453 MVI   RRPARTC(RRPAPTR),X'04'                              1473
*/*                                                          @ZM43092*/
*/* GET INTO THE APPROPRIATE KEY TO STORE THE DATA           @ZM43092*/
*/*  THAT HAS BEEN GATHERED.                                 @ZM43092*/
*/* IF THE REQUEST WAS INVALID, ZEROES ARE RETURNED.         @ZM43092*/
*/*                                                          @ZM43092*/
*                                                                  1474
*   IF RRPASVC='0'B THEN            /* FOR BRANCH ENTRY,     @ZM43092*/
@RC01453 TM    RRPASVC(RRPAPTR),B'00100000'                        1474
         BNZ   @RF01474                                            1474
*     DO;                           /*                       @ZM43092*/
*       MODESETR=RRPAKEY;           /* GET SAVED KEY         @ZM43092*/
         SLR   MODESETR,MODESETR                                   1476
         IC    MODESETR,RRPAKEY(,RRPAPTR)                          1476
*       SPKA(MODESETR);             /* AND SET PSW KEY.      @ZM43092*/
         SPKA  0(MODESETR)                                         1477
*     END;                          /*                       @ZM43092*/
*   ELSE                                                           1479
*     DO;                           /* FOR SVC ENTRY, USE THE      1479
*                                                            @ZM43092*/
         B     @RC01474                                            1479
@RF01474 DS    0H                                                  1480
*       R1=PSATOLD;                 /* CURRENT TCB KEY       @ZM43092*/
         L     R1,PSATOLD                                          1480
*       GENERATE;                                                  1481
     USING TCB,R1
     MODESET EXTKEY=RBT1,WORKREG=10
*     END;                          /*                       @ZM43092*/
*/*                                                          @ZM43092*/
*/*   NOW STORE THE SERVICE DATA IN SMF'S AREA.              @ZM43092*/
*/*                                                          @ZM43092*/
*                                                                  1483
*   REQSPARM=RQSVDATA;              /* COPY DATA             @ZM43092*/
@RC01474 L     @14,RRPAINP(,RRPAPTR)                               1483
         L     @12,RQSVPTR(,RMCTPTR)                               1483
         MVC   REQSPARM(16,@14),RQSVDATA(@12)                      1483
*   GENERATE;                                                      1484
*                                                                  1484
*                                 /* GET BACK TO SRM KEY    @ZM43092*/
   MODESET EXTKEY=SRM
*   /*****************************************************************/
*   /*                                                               */
*   /* ? IRACTLCL EPN(I01)                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1485
*   GOTO RMEXI01->IRARMNTR;         /* EXIT TO I01 FUNCT             */
         L     @14,RMEXI01(,RMCTPTR)                               1485
         BR    @14                                                 1485
*   RFY                                                            1486
*    (R0,                                                          1486
*     RTNREG,                                                      1486
*     NTRREG) RSTD;                 /*                       @ZM43092*/
*   END IRARMEVT                                                   1487
*                                                                  1487
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IRACNSMP)                                       */
*/*%INCLUDE SYSLIB  (IRARMCT )                                       */
*/*%INCLUDE SYSLIB  (IRACCT  )                                       */
*/*%INCLUDE SYSLIB  (IRAICT  )                                       */
*/*%INCLUDE SYSLIB  (IRAMCT  )                                       */
*/*%INCLUDE SYSLIB  (IRARCT  )                                       */
*/*%INCLUDE SYSLIB  (IRARMPT )                                       */
*/*%INCLUDE SYSLIB  (IRARMCA )                                       */
*/*%INCLUDE SYSLIB  (IRARMEX )                                       */
*/*%INCLUDE SYSLIB  (IRARMSB )                                       */
*/*%INCLUDE SYSLIB  (IRAEPAT )                                       */
*/*%INCLUDE SYSLIB  (IRAEPDT )                                       */
*/*%INCLUDE SYSLIB  (IRAEPST )                                       */
*/*%INCLUDE SYSLIB  (IRARRPA )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IRAOUCB )                                       */
*/*%INCLUDE SYSLIB  (IHAOUXB )                                       */
*/*%INCLUDE SYSLIB  (IHAOUSB )                                       */
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */
*/*%INCLUDE SYSLIB  (IRARMEP )                                       */
*/*%INCLUDE SYSLIB  (IRAWMST )                                       */
*/*%INCLUDE SYSLIB  (IRAWPGDT)                                       */
*/*%INCLUDE SYSLIB  (IRAWAMT )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IRARQSRV)                                       */
*/*%INCLUDE SYSLIB  (IRASRCD )                                       */
*/*%INCLUDE SYSLIB  (IRADMDT )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */
*/*%INCLUDE SYSLIB  (IFASMFR )                                       */
*/*%INCLUDE SYSLIB  (IFASMFR1)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR2)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR3)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR4)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR5)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR6)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR7)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR8)                                       */
*/*%INCLUDE SYSLIB  (IFASMFR9)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRA)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRB)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRC)                                       */
*/*%INCLUDE SYSLIB  (IFASMFRD)                                       */
*/*%INCLUDE SYSLIB  (IRAREGS )                                       */
*                                                                  1487
*       ;                                                          1487
@DATA    DS    0H
@CH02633 DC    H'20'
@CH02502 DC    H'32767'
         DS    0F
@TF00001 DS    F
         DS    0F
@CF00078 DC    F'1'
@CH00078 EQU   @CF00078+2
@CF00152 DC    F'8'
@CF02432 DC    F'36'
@CF02685 DC    F'-4'
@CF02678 DC    XL4'0000FFFF'
@CF02688 DC    BL4'00000000000000001000000000000000'
@CF02691 DC    BL4'11111111111111111111100111111111'
@CF02698 DC    BL4'00011111111111111111111111111111'
@CF02704 DC    BL4'11111111111111111111101111111111'
@CF02707 DC    BL4'11000000000000000000000000000000'
@CF02710 DC    BL4'01000000000000000000000000000000'
@CF02713 DC    BL4'00000000000000000100000000000000'
@CF02717 DC    BL4'11111111111111110011111111111111'
@CV02272 DC    V(IRARMI01)
@CV02294 DC    V(IRARME28)
@CV02508 DC    V(IRARMEPS)
         DS    0D
WPGLPTR  DS    A
WAMPPTR  DS    A
MINSET   DC    AL1(0)
MAXSET   DC    AL1(0)
@CC02562 DC    C'OUXB'
         DS    CL2
CHAPLIST DS    CL8
         ORG   CHAPLIST
CHAPFLAG DC    X'80'
@NM00041 DC    X'0000'
CHAPDP   DS    FL1
CHAPASCB DS    AL4
         ORG   CHAPLIST+8
IRAPRCSR DC    AL4(IRARME01)
         DC    AL4(IRARME02)
         DC    AL4(IRARME03)
         DC    AL4(IRARME04)
         DC    VL4(IRARMI01)
         DC    AL4(IRARME06)
         DC    AL4(IRARME07)
         DC    AL4(IRARME08)
         DC    AL4(IRARME09)
         DC    AL4(IRARME10)
         DC    AL4(IRARME11)
         DC    AL4(IRARME12)
         DC    AL4(IRARME13)
         DC    AL4(IRARME14)
         DC    AL4(IRARME15)
         DC    AL4(IRARME16)
         DC    AL4(IRARME17)
         DC    AL4(IRARME18)
         DC    AL4(IRARME19)
         DC    AL4(IRARME20)
         DC    AL4(IRARME21)
         DC    AL4(IRARME22)
         DC    AL4(IRARME23)
         DC    AL4(IRARME24)
         DC    AL4(IRARME25)
         DC    AL4(IRARME26)
         DC    VL4(IRARMI01)
         DC    VL4(IRARME28)
         DC    AL4(IRARME29)
         DC    AL4(IRARME30)
         DC    AL4(IRARME31)
         DC    AL4(IRARME32)
         DC    AL4(IRARME33)
         DC    AL4(IRARME34)
         DC    VL4(IRARMI01)
         DC    VL4(IRARMI01)
         DC    AL4(IRARME37)
         DC    AL4(IRARME38)
         DC    AL4(IRARME39)
         DC    AL4(IRARME40)
         DC    AL4(IRARME41)
         DC    AL4(IRARME42)
         DC    AL4(IRARME43)
         DC    AL4(IRARME44)
         DC    AL4(IRARME45)
         DC    AL4(IRARME46)
         DC    AL4(IRARME47)
         DC    AL4(IRARME48)
         DC    AL4(IRARME49)
IRARMEVT CSECT
*                                  /*
         IHARB
         IKJTCB
IRARMEVT CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ECBPARM  EQU   @11
WPGPPTR  EQU   @11
BASE1    EQU   @08
BASE2    EQU   @09
RMCTPTR  EQU   @02
RRPAPTR  EQU   @03
ASCBPTR  EQU   @05
OUCBPTR  EQU   @04
OUXBPTR  EQU   @06
OUSBPTR  EQU   @07
RMEPPTR  EQU   @07
WAMTPTR  EQU   @06
DMDTPTR  EQU   @07
SRBPTR   EQU   @10
R0       EQU   @00
R1       EQU   @01
SVEREG   EQU   @13
RTNREG   EQU   @14
NTRREG   EQU   @15
RTNCOD   EQU   @15
RTNREG1  EQU   @04
RTNREG2  EQU   @05
RTNREG3  EQU   @06
ENQJST1  EQU   @06
ENQJST2  EQU   @07
RMCTSAVE EQU   @06
RRPASAVE EQU   @07
COPYTARG EQU   @06
COPYLNG  EQU   @07
COPYSRC  EQU   @10
COPYLGTH EQU   @11
EJST1    EQU   @10
WRKREG2  EQU   @10
DMDTPTR2 EQU   @10
EJST2    EQU   @11
SERVICE  EQU   @11
TRNTIME  EQU   @12
RETNCODE EQU   @15
MODESETR EQU   @15
RESNCODE EQU   @00
COMPCODE EQU   @01
I        EQU   @12
PCSAVE   EQU   @07
AVQNEWAT EQU   @07
AVQNEWBT EQU   @06
AVQOLDAT EQU   @05
AVQOLDBT EQU   @04
MSNEWCT  EQU   @07
MSOLDCT  EQU   @06
RSMDELTA EQU   @06
RTNREG4  EQU   @07
SWPCNT   EQU   @11
WRKREG3  EQU   @11
         ENTRY IRAPRCSR
         ENTRY IRARMXPS
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
FLCCVT   EQU   FLCICCW2
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSATOLD  EQU   PSA+540
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
RMCT     EQU   0
RMCTWMST EQU   RMCT+24
RMCTRMSA EQU   RMCT+32
RMCTWAST EQU   RMCT+84
RMCTWAMT EQU   RMCT+88
RMCTTBS  EQU   RMCT+120
RMCTTOD  EQU   RMCT+124
RMCTRQSV EQU   RMCT+144
RMCTFLGS EQU   RMCT+148
RMCTMFA  EQU   RMCTFLGS
RMCTSTW  EQU   RMCTFLGS
RMCTOUCB EQU   RMCT+168
RMCTOUXB EQU   RMCT+172
RMCTDMDT EQU   RMCT+180
RMCTDMNC EQU   RMCT+188
CCT      EQU   RMCT+192
CCCAPBDP EQU   CCT+36
CCCAPMDP EQU   CCT+40
CCCAPGDP EQU   CCT+42
CCVENQCT EQU   CCT+120
CCVCPUCT EQU   CCT+122
CCTFLG1  EQU   CCT+124
ICT      EQU   RMCT+320
ICCHIUTH EQU   ICT+38
ICCLOUTH EQU   ICT+40
ICCDAUTH EQU   ICT+42
ICCINHIT EQU   ICT+44
ICCINLOT EQU   ICT+48
ICCINDAT EQU   ICT+52
ICTFLAGS EQU   ICT+84
MCT      EQU   RMCT+408
MCTSFLGS EQU   MCT+64
MCTSQA1  EQU   MCTSFLGS
MCTSQA2  EQU   MCTSFLGS
MCTAVQ1  EQU   MCTSFLGS
MCTFAVQ  EQU   MCTSFLGS
MCTOFLGS EQU   MCT+65
MCTASM1  EQU   MCTOFLGS
RCT      EQU   RMCT+504
RMPT     EQU   RMCT+592
RMCA     EQU   RMCT+664
RMCAINUS EQU   RMCA+6
RMCAFLGS EQU   RMCA+36
RMCALGPG EQU   RMCA+72
RMCABCPG EQU   RMCA+73
RMCAMAS  EQU   RMCA+76
RMCACIUS EQU   RMCA+118
RMCASRC  EQU   RMCA+124
RMEX     EQU   RMCT+832
RMEPBEVT EQU   RMEX
RMEPBCTL EQU   RMEX+16
RMEXCTL  EQU   RMEPBCTL
RMEXI01  EQU   RMEX+32
RMEXCET  EQU   RMEX+40
RMSB     EQU   RMCT+896
RMSBI02  EQU   RMSB
RMSBI04  EQU   RMSB+8
RMSBI06  EQU   RMSB+16
RMSBI10  EQU   RMSB+32
RMSBCRL  EQU   RMSB+36
RMSBCRN  EQU   RMSB+40
RMSBCRY  EQU   RMSB+44
RMSBWM1  EQU   RMSB+52
RMSBWMK  EQU   RMSB+60
RMSBWMN  EQU   RMSB+64
RMSBWMO  EQU   RMSB+68
RMSBWMQ  EQU   RMSB+72
RMSBWMR  EQU   RMSB+76
RMSBWMY  EQU   RMSB+80
RMSBWR4  EQU   RMSB+88
RMSBWR6  EQU   RMSB+92
RMSBSET  EQU   RMSB+96
RMSBNOP  EQU   RMSB+100
RMSBCL0  EQU   RMSB+108
RMSBIL0  EQU   RMSB+112
EPAT     EQU   RMCT+1016
RMEPBCAP EQU   EPAT
RMEPBSQA EQU   EPAT+96
RMEPBMS2 EQU   EPAT+160
EPDT     EQU   RMCT+1416
RMEPBIPS EQU   EPDT
RMEPBDEL EQU   EPDT+16
RMEPBIL4 EQU   EPDT+32
RMEPBUXB EQU   EPDT+48
RMEPBHIT EQU   EPDT+64
RMEPBRPS EQU   EPDT+80
EPST     EQU   RMCT+1512
RMEPBWM3 EQU   EPST
RMEPBIL3 EQU   EPST+16
RMEPBCL3 EQU   EPST+32
RMEPBCSO EQU   EPST+48
RMEPBCSI EQU   EPST+64
RRPA     EQU   0
RRPAINC  EQU   RRPA
RRPAASD  EQU   RRPAINC
RRPAVPGN EQU   RRPAINC+2
RRPAFLG0 EQU   RRPAVPGN
RRPANSWI EQU   RRPAFLG0
RRPACOD  EQU   RRPAINC+3
RRPAINP  EQU   RRPA+4
RRPAFLG  EQU   RRPA+8
RRPADSB  EQU   RRPAFLG
RRPAENB  EQU   RRPAFLG
RRPASVC  EQU   RRPAFLG
RRPAWAR  EQU   RRPAFLG+1
RRPAIPS  EQU   RRPAFLG+1
RRPAKEY  EQU   RRPA+10
RRPARTC  EQU   RRPA+11
RRPAINS  EQU   RRPA+16
RRPARTN  EQU   RRPAINS
RRPAEPA  EQU   RRPA+20
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBIOSM EQU   ASCB+40
ASCBDP   EQU   ASCB+43
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCB2LPU EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCBVEQR EQU   ASCBRSMF
ASCBEJST EQU   ASCB+64
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBASXB EQU   ASCB+108
ASCBSWCT EQU   ASCB+112
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBVSC  EQU   ASCB+120
ASCBNVSC EQU   ASCB+122
ASCBLKGP EQU   ASCB+128
ASCBMECB EQU   ASCB+140
ASCBOUCB EQU   ASCB+144
ASCBOUXB EQU   ASCB+148
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
ASCBSRBT EQU   ASCB+200
OUCB     EQU   0
OUCBFWD  EQU   OUCB+4
OUCBBCK  EQU   OUCB+8
OUCBQFL  EQU   OUCB+16
OUCBGOO  EQU   OUCBQFL
OUCBGOI  EQU   OUCBQFL
OUCBGOB  EQU   OUCBQFL
OUCBQSFL EQU   OUCBQFL
OUCBOFF  EQU   OUCBQFL
OUCBOUT  EQU   OUCBQFL
OUCBSFL  EQU   OUCB+17
OUCBNSW  EQU   OUCBSFL
OUCBCTI  EQU   OUCBSFL
OUCBBIB  EQU   OUCBSFL
OUCBINV  EQU   OUCBSFL
OUCBNSWI EQU   OUCBSFL
OUCBPVL  EQU   OUCBSFL
OUCBENQ  EQU   OUCBSFL
OUCBYFL  EQU   OUCB+18
OUCBSTT  EQU   OUCBYFL
OUCBLOG  EQU   OUCBYFL
OUCBMNT  EQU   OUCBYFL
OUCBPSTR EQU   OUCBYFL
OUCBAXS  EQU   OUCBYFL
OUCBDTA  EQU   OUCBYFL
OUCBFXS  EQU   OUCBYFL
OUCBAFL  EQU   OUCB+19
OUCBAPG  EQU   OUCBAFL
OUCBRMA  EQU   OUCBAFL
OUCBCPL  EQU   OUCBAFL
OUCBJSR  EQU   OUCBAFL
OUCBASW  EQU   OUCBAFL
OUCBTFL  EQU   OUCB+20
OUCBATR  EQU   OUCBTFL
OUCBSTR  EQU   OUCBTFL
OUCBINP  EQU   OUCBTFL
OUCBINC  EQU   OUCBTFL
OUCBEFL  EQU   OUCB+21
OUCBLWT  EQU   OUCBEFL
OUCBTRM  EQU   OUCBEFL
OUCBOWT  EQU   OUCBEFL
OUCBCIM  EQU   OUCBEFL
OUCBNQF  EQU   OUCBEFL
OUCBQSS  EQU   OUCBEFL
OUCBQSC  EQU   OUCBEFL
OUCBMWT  EQU   OUCBEFL
OUCBNQC  EQU   OUCB+22
OUCBUFL  EQU   OUCB+23
OUCBJSFS EQU   OUCBUFL
OUCBJSAS EQU   OUCBUFL
OUCBRSWP EQU   OUCBUFL
OUCBTSWP EQU   OUCBUFL
OUCBTSWC EQU   OUCBUFL
OUCBNPG  EQU   OUCB+24
OUCBRPG  EQU   OUCB+25
OUCBNDP  EQU   OUCB+26
OUCBRDP  EQU   OUCB+27
OUCBSPG  EQU   OUCB+28
OUCBPGP  EQU   OUCB+31
OUCBWMG  EQU   OUCB+32
OUCBDMO  EQU   OUCB+34
OUCBDMN  EQU   OUCB+36
OUCBSRC  EQU   OUCB+37
OUCBASCB EQU   OUCB+40
OUCBIMCB EQU   OUCB+44
OUCBWMS  EQU   OUCB+52
OUCBTMS  EQU   OUCB+68
OUCBPSO  EQU   OUCB+76
OUCBWSS  EQU   OUCB+78
OUCBCSW  EQU   OUCB+84
OUCBCFL  EQU   OUCBCSW+2
OUCBRDY  EQU   OUCBCFL
OUCBRSM  EQU   OUCBCFL
OUCBIOR  EQU   OUCB+100
OUCBIOSM EQU   OUCB+108
OUCBPSS  EQU   OUCB+112
OUCBPS1  EQU   OUCBPSS
OUCBPS2  EQU   OUCBPSS+4
OUCBPST  EQU   OUCB+120
OUCBNDS  EQU   OUCB+132
OUCBNTSP EQU   OUCB+134
OUXB     EQU   0
OUXBNAME EQU   OUXB
OUXBPET  EQU   OUXB+4
OUXBRSW  EQU   OUXB+12
OUXBPIN  EQU   OUXB+16
OUXBPOUT EQU   OUXB+20
OUXBPREC EQU   OUXB+24
OUXBVAMI EQU   OUXB+28
OUXBVAMO EQU   OUXB+32
OUXBVAMR EQU   OUXB+36
OUXBCAPI EQU   OUXB+40
OUXBCAPR EQU   OUXB+44
OUXBSTCT EQU   OUXB+48
OUXBSTC  EQU   OUXB+54
OUXBNQT  EQU   OUXB+60
OUXBTRC  EQU   OUXB+64
OUXBJBS  EQU   OUXB+68
OUXBJBT  EQU   OUXB+72
OUXBTRS  EQU   OUXB+76
OUXBTRT  EQU   OUXB+80
OUXBJBR  EQU   OUXB+84
OUXBTRR  EQU   OUXB+88
OUXBAET  EQU   OUXB+92
OUXBCPS  EQU   OUXB+96
OUXBITD  EQU   OUXB+112
OUXBSTD  EQU   OUXB+116
OUXBWCT  EQU   OUXB+124
OUXBILS  EQU   OUXB+128
OUXBVSC  EQU   OUXB+132
OUXBNVC  EQU   OUXB+136
OUXBTSW  EQU   OUXB+140
OUSB     EQU   0
OUSBCAPI EQU   OUSB+4
OUSBCAPR EQU   OUSB+8
OUSBSTCT EQU   OUSB+12
OUSBSPIN EQU   OUSB+16
OUSBSPOT EQU   OUSB+20
OUSBSWCT EQU   OUSB+24
OUSBPIN  EQU   OUSB+28
OUSBPOUT EQU   OUSB+32
OUSBPREC EQU   OUSB+36
OUSBVAMI EQU   OUSB+40
OUSBVAMO EQU   OUSB+44
OUSBVAMR EQU   OUSB+48
OUSBSAVE EQU   OUSB+52
ASXB     EQU   0
ASXBOUSB EQU   ASXB+128
ASXBAEQ  EQU   ASXB+168
ASXBSECR EQU   ASXB+199
ASCBSFLG EQU   ASXBSECR
ASXBCASW EQU   ASXB+216
ASXBCRB1 EQU   ASXBCASW
RMEP     EQU   0
RMEPEPB  EQU   RMEP
RMEPFLG  EQU   RMEPEPB+8
RMEPSCH  EQU   RMEP+16
WMST     EQU   0
WMSTPGVT EQU   WMST+8
WMSTPGDT EQU   WMST+16
WMSTDMDT EQU   WMST+40
WMSTDMVT EQU   WMST+48
WMSTDMVS EQU   WMST+52
WMSTPGHI EQU   WMST+62
WMSTSET  EQU   WMST+84
WMSTSTCB EQU   WMST+88
WMSTNWST EQU   WMST+92
WMSTSECB EQU   WMST+96
WPGD     EQU   0
WPGDPGN  EQU   WPGD
WPGDDFL  EQU   WPGD+3
WPGDPGP  EQU   WPGD+12
WPGDINDS EQU   WPGDPGP+5
WPGP     EQU   0
WPGPDMN  EQU   WPGP+1
WPGPAPGV EQU   WPGP+4
WPGPINDS EQU   WPGP+5
WPGPFIN  EQU   WPGPINDS
WPGPAPG  EQU   WPGPINDS
WPGL     EQU   0
WPGLISV  EQU   WPGL
WAMT     EQU   0
WAMTWAR  EQU   WAMT
WAMTNX1  EQU   WAMT+56
WAMP     EQU   0
WAMPPGP  EQU   WAMP
ASVT     EQU   0
ASVTMAXU EQU   ASVT+516
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
RQSV     EQU   0
RQSVDATA EQU   RQSV
RQSVSRV  EQU   RQSVDATA
RQSVTIM  EQU   RQSVDATA+4
RQSVPGSC EQU   RQSVDATA+8
RQSVPGN  EQU   RQSVPGSC
RQSVTRC  EQU   RQSVPGSC+2
RQSVSRT  EQU   RQSVDATA+12
DMDT     EQU   0
DMDTLO   EQU   DMDT+1
DMDTHI   EQU   DMDT+2
DMDTWT   EQU   DMDT+3
DMDTMPLT EQU   DMDT+4
CVTMAP   EQU   0
CVT      EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
PVT      EQU   0
PVTFLAG1 EQU   PVT
PVTAPREF EQU   PVTFLAG1
PVTFLAG2 EQU   PVT+1
PVTQS    EQU   PVT+304
PVTWSAX  EQU   PVT+344
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBFLC   EQU   SRB+12
SRBPARM  EQU   SRB+28
CSD      EQU   0
CSDCPUAL EQU   CSD+8
CSDCPUOL EQU   CSD+10
CSDSCWRD EQU   CSD+12
CSDSCFL1 EQU   CSDSCWRD
CSDSCFL2 EQU   CSDSCWRD+1
CSDSCFL3 EQU   CSDSCWRD+2
CSDSCFL4 EQU   CSDSCWRD+3
CSDFLAGS EQU   CSD+23
SMFRCD22 EQU   0
SMF22RTY EQU   SMFRCD22+5
SMF22CPU EQU   0
SMF22CHL EQU   0
SMF22STR EQU   0
SMF22IPL EQU   0
SMF22VON EQU   0
SMF22VOF EQU   0
SWOCMPLT EQU   0
SWOPGCNT EQU   SWOCMPLT
SWIWSS   EQU   SWOCMPLT+2
SWOFLGS  EQU   SWOCMPLT+7
SWOWRSM  EQU   SWOFLGS
SETDPRMS EQU   0
SETDDMN  EQU   SETDPRMS
SETDFLGS EQU   SETDPRMS+1
MINFLAG  EQU   SETDFLGS
MAXFLAG  EQU   SETDFLGS
WTFLAG   EQU   SETDFLGS
SETDMIN  EQU   SETDPRMS+2
SETDMAX  EQU   SETDPRMS+3
SETDWT   EQU   SETDPRMS+4
SMFAREA  EQU   0
SMFPIN   EQU   SMFAREA
SMFPOUT  EQU   SMFAREA+4
SMFPREC  EQU   SMFAREA+8
SMFVAMI  EQU   SMFAREA+12
SMFVAMO  EQU   SMFAREA+16
SMFVAMR  EQU   SMFAREA+20
SMFSCNTS EQU   SMFAREA+24
SMFCAPI  EQU   SMFAREA+36
SMFCAPR  EQU   SMFAREA+40
SMFSTCT  EQU   SMFAREA+44
SMFPGSS  EQU   SMFAREA+48
COPYPRMS EQU   0
COPYCNT  EQU   COPYPRMS
COPYDMDT EQU   COPYPRMS+4
REQSPARM EQU   0
IRARMNTR EQU   0
IRARMRTN EQU   0
WPGVTENT EQU   0
WARTABLE EQU   0
IRARMWR1 EQU   0
IRARMWR3 EQU   0
ECBFIELD EQU   0
SWAPECB  EQU   ECBFIELD
NEWCELL  EQU   0
ECBLIST  EQU   0
PROCESSR EQU   0
WDMVTENT EQU   0
DOMAINS  EQU   0
ASXBPTR  EQU   ASCBASXB
WMSTPTR  EQU   RMCTWMST
WPGDPTR  EQU   WMSTPGDT
CVTS01   EQU   CVTPGSIA
CVTPVTP  EQU   CVTS01+8
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTASVT  EQU   CVTS01+208
CVTCSD   EQU   CVTS01+312
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTEXP1  EQU   CVTS01+572
CVTGSDA  EQU   CVTS01+600
CVTRV609 EQU   CVTS01+652
ASVTPTR  EQU   CVTASVT
RQSVPTR  EQU   RMCTRQSV
CVTPTR   EQU   FLCCVT
PSARSVTE EQU   PSARSVT
PVTPTR   EQU   CVTPVTP
SMF22PTR EQU   RRPAINP
RRPAREG  EQU   RRPAINP
RRPARI0  EQU   RRPAREG
RRPAWAIT EQU   RRPARI0
RRPAWTYP EQU   RRPAWAIT
RRPAGTPT EQU   RRPAWTYP
RRPATRAN EQU   RRPAWTYP
RRPARI1  EQU   RRPAREG+1
RRPAASW  EQU   RRPARI1
RRPARI2  EQU   RRPAREG+2
RRPADEF  EQU   RRPARI2
RRPANPG  EQU   RRPADEF
RRPARI3  EQU   RRPAREG+3
RRPAPGN  EQU   RRPARI3
RRPANDP  EQU   RRPAPGN
RRPAMEMO EQU   RRPANDP
RRPATODO EQU   RRPAMEMO
LEVEL    EQU   RRPAINP+3
OUXBFLDS EQU   OUXBNQT
OUSBFLDS EQU   OUSBSAVE
SWPFLDS  EQU   OUSBSPIN
PGEFLDX  EQU   OUXBPIN
PGEFLDS  EQU   OUSBCAPI
@NM00042 EQU   ECBFIELD
ECBLISTB EQU   @NM00042
ASCBFW1A EQU   ASCBFW1
ASCBOUTB EQU   ASCBFW1A+2
ASCBTLWT EQU   ASCBFW1A+2
ACCNTFLD EQU   OUXBTRC
OUCBRFLG EQU   OUCBCSW
OUCBRDYB EQU   OUCBRFLG+2
OUCBRSMB EQU   OUCBRFLG+2
RMCASRCD EQU   RMCASRC
FLC      EQU   PSA
MSASCBET EQU   ASCBEJST+2
WAMTNDX  EQU   WAMTNX1
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00048 EQU   OUCBRFLG+3
@NM00047 EQU   OUCBRFLG+2
@NM00046 EQU   OUCBRFLG
@NM00045 EQU   ASCBFW1A+2
@NM00044 EQU   ASCBFW1A
@NM00043 EQU   @NM00042
@NM00037 EQU   RRPARI1
@NM00036 EQU   RRPARI1
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
COPYRSV  EQU   COPYPRMS+2
SMFSWCT  EQU   SMFSCNTS+8
SMFSPOT  EQU   SMFSCNTS+4
SMFSPIN  EQU   SMFSCNTS
@NM00040 EQU   SETDFLGS
@NM00039 EQU   SWOFLGS
@NM00038 EQU   SWOCMPLT+6
SWOSPFR  EQU   SWOCMPLT+4
SMF22FSI EQU   SMF22VOF+3
SMF22RVB EQU   SMF22VOF+2
SMF22FID EQU   SMF22VOF+1
SMF22RV6 EQU   SMF22VOF
SMF22NSI EQU   SMF22VON+3
SMF22RVA EQU   SMF22VON+2
SMF22NID EQU   SMF22VON+1
SMF22RV5 EQU   SMF22VON
SMF22ION EQU   SMF22IPL+2
SMF22IID EQU   SMF22IPL+1
SMF22RV4 EQU   SMF22IPL
SMF22NPG EQU   SMF22STR+4
SMF22PGL EQU   SMF22STR+2
SMF22TID EQU   SMF22STR+1
SMF22RV3 EQU   SMF22STR
SMF22CPD EQU   SMF22CHL+5
SMF22CHA EQU   SMF22CHL+4
SMF22CHN EQU   SMF22CHL+2
SMF22CID EQU   SMF22CHL+1
SMF22RV2 EQU   SMF22CHL
SMF22CPA EQU   SMF22CPU+5
SMF22RV1 EQU   SMF22CPU+4
SMF22CPN EQU   SMF22CPU+2
SMF22PID EQU   SMF22CPU+1
SMF22RV0 EQU   SMF22CPU
SMF22ECT EQU   SMFRCD22+20
SMF22IND EQU   SMFRCD22+18
SMF22SID EQU   SMFRCD22+14
SMF22DTE EQU   SMFRCD22+10
SMF22TME EQU   SMFRCD22+6
SMF22FLG EQU   SMFRCD22+4
SMF22SEG EQU   SMFRCD22+2
SMF22LEN EQU   SMFRCD22
@NM00035 EQU   CSD+160
CSDMASK  EQU   CSD+128
CSDUCNT  EQU   CSD+124
CSDTCNT  EQU   CSD+120
CSDGDTOD EQU   CSD+116
CSDGDINT EQU   CSD+112
CSDGDCC  EQU   CSD+108
CSDDDRCT EQU   CSD+106
CSDRV044 EQU   CSD+104
CSDMAFF  EQU   CSD+24
CSDRV038 EQU   CSDFLAGS
CSDRV037 EQU   CSDFLAGS
CSDRV036 EQU   CSDFLAGS
CSDRV035 EQU   CSDFLAGS
CSDRV034 EQU   CSDFLAGS
CSDRV033 EQU   CSDFLAGS
CSDRV032 EQU   CSDFLAGS
CSDMP    EQU   CSDFLAGS
CSDACR   EQU   CSD+22
CSDMF1CP EQU   CSD+20
CSDRV043 EQU   CSD+16
CSDRV030 EQU   CSDSCFL4
CSDRV029 EQU   CSDSCFL4
CSDRV028 EQU   CSDSCFL4
CSDRV027 EQU   CSDSCFL4
CSDRV026 EQU   CSDSCFL4
CSDRV025 EQU   CSDSCFL4
CSDRV024 EQU   CSDSCFL4
CSDRV023 EQU   CSDSCFL4
CSDRV022 EQU   CSDSCFL3
CSDRV021 EQU   CSDSCFL3
CSDRV020 EQU   CSDSCFL3
CSDRV019 EQU   CSDSCFL3
CSDRV018 EQU   CSDSCFL3
CSDRV017 EQU   CSDSCFL3
CSDRV016 EQU   CSDSCFL3
CSDRV015 EQU   CSDSCFL3
CSDRV014 EQU   CSDSCFL2
CSDRV013 EQU   CSDSCFL2
CSDRV012 EQU   CSDSCFL2
CSDRV011 EQU   CSDSCFL2
CSDRV010 EQU   CSDSCFL2
CSDRV009 EQU   CSDSCFL2
CSDRV008 EQU   CSDSCFL2
CSDRV007 EQU   CSDSCFL2
CSDRV006 EQU   CSDSCFL1
CSDRV005 EQU   CSDSCFL1
CSDRV004 EQU   CSDSCFL1
CSDRV003 EQU   CSDSCFL1
CSDRV002 EQU   CSDSCFL1
CSDRV001 EQU   CSDSCFL1
CSDSYSND EQU   CSDSCFL1
CSDRV042 EQU   CSDSCFL1
CSDSAFF  EQU   CSDCPUAL
CSDCHAD  EQU   CSD+6
CSDCPUJS EQU   CSD+4
CSDCSD   EQU   CSD
@NM00034 EQU   SRB+40
@NM00033 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBRMTR  EQU   SRB+24
SRBEP    EQU   SRB+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBASCB  EQU   SRB+8
SRBFLNK  EQU   SRB+4
SRBID    EQU   SRB
PVTEND   EQU   PVT+1848
PVTTASID EQU   PVT+1846
PVTXXXXX EQU   PVT+1844
PVTMVCLC EQU   PVT+1840
PVTSPARE EQU   PVT+1838
PVTCHUIC EQU   PVT+1836
PVTCOMFX EQU   PVT+1834
PVTSQAFX EQU   PVT+1832
PVTCNTFX EQU   PVT+1830
PVTDEFFX EQU   PVT+1828
PVTFIXOK EQU   PVT+1826
PVTPEROK EQU   PVT+1824
PVTMAXFX EQU   PVT+1822
PVTPERFX EQU   PVT+1820
PVTRSRB  EQU   PVT+1776
PVTRESV5 EQU   PVT+1773
PVTSRBS  EQU   PVT+1772
PVTSSRB  EQU   PVT+1768
PVTACA   EQU   PVTWSAX+1400
PVTSAVE  EQU   PVTWSAX+1328
PVTWSA18 EQU   PVTWSAX+1256
PVTWSA17 EQU   PVTWSAX+1184
PVTWSA16 EQU   PVTWSAX+1112
PVTWSA15 EQU   PVTWSAX+1040
PVTWSA14 EQU   PVTWSAX+968
PVTWSA13 EQU   PVTWSAX+896
PVTWSA12 EQU   PVTWSAX+824
PVTWSA11 EQU   PVTWSAX+752
PVTWSA10 EQU   PVTWSAX+672
PVTWSA9  EQU   PVTWSAX+592
PVTWSA8  EQU   PVTWSAX+504
PVTWSA7  EQU   PVTWSAX+432
PVTWSA6  EQU   PVTWSAX+360
PVTWSA5  EQU   PVTWSAX+288
PVTWSA4  EQU   PVTWSAX+216
PVTWSA3  EQU   PVTWSAX+144
PVTWSA2  EQU   PVTWSAX+72
PVTWSA1  EQU   PVTWSAX
PVTCIOQL EQU   PVTQS+36
PVTCIOQF EQU   PVTQS+32
PVTGFADL EQU   PVTQS+28
PVTGFADF EQU   PVTQS+24
PVTFPCBL EQU   PVTQS+20
PVTFPCBF EQU   PVTQS+16
PVTSQAQL EQU   PVTQS+14
PVTSQAQF EQU   PVTQS+12
PVTCFQL  EQU   PVTQS+10
PVTCFQF  EQU   PVTQS+8
PVTRSRVL EQU   PVTQS+6
PVTRSRVF EQU   PVTQS+4
PVTAFQL  EQU   PVTQS+2
PVTAFQF  EQU   PVTQS
PVTSPFR  EQU   PVT+302
PVTCFMCT EQU   PVT+300
PVTSPREC EQU   PVT+296
PVTCAREC EQU   PVT+292
PVTCAOUT EQU   PVT+288
PVTCAIN  EQU   PVT+284
PVTNSWPS EQU   PVT+280
PVTNPREC EQU   PVT+276
PVTSPOUT EQU   PVT+272
PVTSPIN  EQU   PVT+268
PVTVAMR  EQU   PVT+264
PVTVAMO  EQU   PVT+260
PVTVAMI  EQU   PVT+256
PVTNPOUT EQU   PVT+252
PVTNPIN  EQU   PVT+248
PVTPRSET EQU   PVT+244
PVTFRSLT EQU   PVT+240
PVTPAGIO EQU   PVT+236
PVTSWPIO EQU   PVT+232
PVTPSWPP EQU   PVT+228
PVTPPREF EQU   PVT+224
PVTPOPBR EQU   PVT+220
PVTPRELF EQU   PVT+216
PVTPRELV EQU   PVT+212
PVTPFREE EQU   PVT+208
PVTPRELS EQU   PVT+204
PVTPOUT  EQU   PVT+200
PVTPFXLD EQU   PVT+196
PVTPITAS EQU   PVT+192
PVTPSRBP EQU   PVT+188
PVTPDSEG EQU   PVT+184
PVTPCSGB EQU   PVT+180
PVTPCSEG EQU   PVT+176
PVTPINV  EQU   PVT+172
PVTPSWPC EQU   PVT+168
PVTPSOUT EQU   PVT+164
PVTPSWIN EQU   PVT+160
PVTPRCV  EQU   PVT+156
PVTPRCFI EQU   PVT+152
PVTPRCF  EQU   PVT+148
PVTPVRC  EQU   PVT+144
PVTPVRIN EQU   PVT+140
PVTPVRLS EQU   PVT+136
PVTPVEQR EQU   PVT+132
PVTPPIOI EQU   PVT+128
PVTPVRPO EQU   PVT+124
PVTPRFR  EQU   PVT+120
PVTPFP2  EQU   PVT+116
PVTPFP   EQU   PVT+112
PVTPFTE  EQU   PVT+108
PVTPCB   EQU   PVT+104
PVTREP2  EQU   PVT+100
PVTPIOCP EQU   PVT+96
PVTPIOP  EQU   PVT+92
PVTPGFAD EQU   PVT+88
PVTPGFA  EQU   PVT+84
PVTPSQA  EQU   PVT+80
PVTPSINT EQU   PVT+76
PVTPSIB  EQU   PVT+72
PVTSRBID EQU   PVT+68
PVTPCIWA EQU   PVT+64
PVTHQSA  EQU   PVT+62
PVTLQSA  EQU   PVT+60
PVTOROOT EQU   PVT+56
PVTPRCA  EQU   PVT+52
PVTREUS  EQU   PVT+48
PVTSQNPC EQU   PVT+47
PVTSQVRC EQU   PVT+46
PVTRSUS  EQU   PVT+44
PVTVROOT EQU   PVT+40
PVTPCBLO EQU   PVT+38
PVTPCBCT EQU   PVT+36
PVTDFRS  EQU   PVT+34
PVTRSQA  EQU   PVT+32
PVTPTLB  EQU   PVT+31
PVTPCBNO EQU   PVT+30
PVTSRBNO EQU   PVT+29
PVTSQDC  EQU   PVT+28
PVTLCSA  EQU   PVT+26
PVTLPRIV EQU   PVT+24
PVTLVR   EQU   PVT+22
PVTFVR   EQU   PVT+20
PVTLPFN  EQU   PVT+18
PVTFPFN  EQU   PVT+16
PVTPFTP  EQU   PVT+12
PVTSSPIN EQU   PVT+11
PVTPCBS  EQU   PVT+10
PVTPOOL  EQU   PVT+8
PVTAFCOK EQU   PVT+6
PVTAFCLO EQU   PVT+4
PVTAFC   EQU   PVT+2
@NM00032 EQU   PVTFLAG2
PVTRSMGM EQU   PVTFLAG2
PVTDUMP  EQU   PVTFLAG1
PVTSIT   EQU   PVTFLAG1
PVTLSI   EQU   PVTFLAG1
PVTPCBLT EQU   PVTFLAG1
PVTSRBIU EQU   PVTFLAG1
PVTBGMS  EQU   PVTFLAG1
PVTPMSG  EQU   PVTFLAG1
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00007 EQU   CVTFIX+248
@NM00006 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
DMDTEND  EQU   DMDT+20
DMDTRUC  EQU   DMDT+16
DMDTINCU EQU   DMDT+14
DMDTOUTU EQU   DMDT+12
DMDTCMPL EQU   DMDT+10
DMDTGOOU EQU   DMDT+8
DMDTRUA  EQU   DMDT+6
DMDTNO   EQU   DMDT
RQSVEND  EQU   RQSV+20
RQSVRSV  EQU   RQSV+16
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00005 EQU   ASVT
WAMPEND  EQU   WAMP+44
WAMPRSV  EQU   WAMPPGP+42
WAMPDMN  EQU   WAMPPGP+41
WAMPOBJN EQU   WAMPPGP+40
WAMPSWC  EQU   WAMPPGP+36
WAMPTRR  EQU   WAMPPGP+32
WAMPMSO  EQU   WAMPPGP+28
WAMPIOC  EQU   WAMPPGP+24
WAMPCPU  EQU   WAMPPGP+20
WAMPNWL  EQU   WAMPPGP+16
WAMPTET  EQU   WAMPPGP+12
WAMPSRV  EQU   WAMPPGP+8
WAMPTAT  EQU   WAMPPGP+4
WAMPTRN  EQU   WAMPPGP
WAMTEND  EQU   WAMT+64
WAMTR90  EQU   WAMT+60
WAMTNX0  EQU   WAMT+52
WAMTIPM  EQU   WAMT+48
WAMTIPI  EQU   WAMT+44
WAMTIPC  EQU   WAMT+40
WAMTHPG  EQU   WAMT+38
WAMTSPD  EQU   WAMT+36
WAMTCPD  EQU   WAMT+34
WAMTIPS  EQU   WAMT+32
WAMTTCB  EQU   WAMT+28
WAMTASD  EQU   WAMT+24
WAMTTOC  EQU   WAMT+16
WAMTTMA  EQU   WAMT+8
WAMTSIZ  EQU   WAMT+4
WPGLEND  EQU   WPGL+4
WPGLDUR  EQU   WPGLISV
WPGPEND  EQU   WPGP+8
WPGPDURP EQU   WPGP+7
WPGPISVP EQU   WPGP+6
WPGPRTB  EQU   WPGPINDS
WPGPRB2  EQU   WPGPINDS
WPGPUNT  EQU   WPGPINDS
@NM00004 EQU   WPGP+2
WPGPOBJN EQU   WPGP
WPGDEND  EQU   WPGD+20
WPGDPGL  EQU   WPGD+20
WPGDDURP EQU   WPGDPGP+7
WPGDISVP EQU   WPGDPGP+6
WPGDRTB  EQU   WPGDINDS
WPGDRB2  EQU   WPGDINDS
WPGDAPG  EQU   WPGDINDS
WPGDUNT  EQU   WPGDINDS
WPGDFIN  EQU   WPGDINDS
WPGDAPGV EQU   WPGDPGP+4
@NM00003 EQU   WPGDPGP+2
WPGDDMN  EQU   WPGDPGP+1
WPGDOBJN EQU   WPGDPGP
WPGDISV  EQU   WPGD+8
WPGDATM  EQU   WPGD+4
WPGDRD1  EQU   WPGDDFL
WPGDVLD  EQU   WPGDDFL
WPGDR02  EQU   WPGD+2
WPGDSIZ  EQU   WPGD+1
WMSTEND  EQU   WMST+112
WMSTIPM  EQU   WMST+108
WMSTIPI  EQU   WMST+104
WMSTIPC  EQU   WMST+100
WMSTRSVD EQU   WMST+81
WMSTREAL EQU   WMST+80
WMSTMSO  EQU   WMST+76
WMSTIOC  EQU   WMST+72
WMSTCPU  EQU   WMST+68
WMSTDMNC EQU   WMST+66
WMSTPGPC EQU   WMST+64
WMSTWLHI EQU   WMST+60
WMSTDMDE EQU   WMST+56
WMSTDMDS EQU   WMST+44
WMSTPODS EQU   WMST+36
WMSTPODT EQU   WMST+32
WMSTPOVS EQU   WMST+28
WMSTPOVT EQU   WMST+24
WMSTPGDS EQU   WMST+20
WMSTPGVS EQU   WMST+12
WMSTWLLO EQU   WMST+6
WMSTID   EQU   WMST+4
WMSTNAME EQU   WMST
RMEPSND  EQU   RMEP+32
RMEPINT  EQU   RMEPSCH+12
RMEPTME  EQU   RMEPSCH+8
RMEPBCK  EQU   RMEPSCH+4
RMEPFWD  EQU   RMEPSCH
RMEPEND  EQU   RMEP+16
RMEPPRV  EQU   RMEPEPB+12
RMEPACN  EQU   RMEPFLG+3
RMEPTMD  EQU   RMEPFLG+3
RMEPRCR  EQU   RMEPFLG+3
RMEPVFL  EQU   RMEPFLG
RMEPERA  EQU   RMEPEPB+4
RMEPEPA  EQU   RMEPEPB
ASXBEND  EQU   ASXB+232
ASXBRV25 EQU   ASXB+228
ASXBRV24 EQU   ASXB+224
ASXBPT0E EQU   ASXB+220
ASXBCRB4 EQU   ASXBCASW+3
ASXBCRB3 EQU   ASXBCASW+2
ASXBCRB2 EQU   ASXBCASW+1
ASXBCR06 EQU   ASXBCRB1
ASXBCR05 EQU   ASXBCRB1
ASXBCR04 EQU   ASXBCRB1
ASXBCR03 EQU   ASXBCRB1
ASXBCR02 EQU   ASXBCRB1
ASXBCR01 EQU   ASXBCRB1
ASXBTFD  EQU   ASXBCRB1
ASXBPIP  EQU   ASXBCRB1
ASXBCTDC EQU   ASXB+212
ASXBTDCB EQU   ASXB+208
ASXBRV19 EQU   ASXB+204
ASXBSENV EQU   ASXBSECR+1
ASXBRV34 EQU   ASCBSFLG
ASXBRV33 EQU   ASCBSFLG
ASXBRV32 EQU   ASCBSFLG
ASXBRV31 EQU   ASCBSFLG
ASXBRV30 EQU   ASCBSFLG
ASXBRV29 EQU   ASCBSFLG
ASXBRV28 EQU   ASCBSFLG
ASXBRV27 EQU   ASCBSFLG
ASXBUSER EQU   ASXB+192
ASXBLSRB EQU   ASXBAEQ+20
ASXBFSRB EQU   ASXBAEQ+16
ASXBLRQE EQU   ASXBAEQ+12
ASXBFRQE EQU   ASXBAEQ+8
ASXBLIQE EQU   ASXBAEQ+4
ASXBFIQE EQU   ASXBAEQ
ASXBETSK EQU   ASXB+164
ASXBSIRB EQU   ASXB+160
ASXBPSWD EQU   ASXB+152
ASXBPRG  EQU   ASXB+136
ASXBRV26 EQU   ASXB+132
ASXBDDR  EQU   ASXB+124
ASXBRCTD EQU   ASXB+120
ASXBRSMD EQU   ASXB+116
ASXBSPSA EQU   ASXB+112
ASXBFRWA EQU   ASXB+108
ASXBFLSA EQU   ASXB+36
ASXBIHSA EQU   ASXB+32
ASXBRV15 EQU   ASXB+28
ASXBRV14 EQU   ASXB+24
ASXBLWA  EQU   ASXB+20
ASXBMPST EQU   ASXB+16
ASXBRS00 EQU   ASXB+14
ASXBTCBS EQU   ASXB+12
ASXBLTCB EQU   ASXB+8
ASXBFTCB EQU   ASXB+4
ASXBASXB EQU   ASXB
ASXBEGIN EQU   ASXB
OUSBEND  EQU   OUSB+136
OUSBR90  EQU   OUSB+132
OUSBNAME EQU   OUSB
OUXBEND  EQU   OUXB+144
OUXBFIXC EQU   OUXB+138
OUXBUIC  EQU   OUXB+134
OUXBRSV1 EQU   OUXB+126
OUXBPRS  EQU   OUXB+120
OUXBMSS  EQU   OUXB+104
OUXBIOSM EQU   OUXB+56
OUXBIOS  EQU   OUXB+52
OUXBMET  EQU   OUXB+8
OUCBEND  EQU   OUCB+136
OUCBTIO  EQU   OUCB+128
OUCBTCP  EQU   OUCB+124
OUCBTMP  EQU   OUCB+104
OUCBR03  EQU   OUCB+102
OUCBCRV  EQU   OUCB+98
OUCBIRV  EQU   OUCB+96
OUCBWMR  EQU   OUCB+92
OUCBCMRV EQU   OUCB+88
OUCBCF2  EQU   OUCBCFL
OUCBACN  EQU   OUCBCSW
OUCBACT  EQU   OUCB+80
OUCBTMO  EQU   OUCB+72
OUCBMSO  EQU   OUCB+64
OUCBIOC  EQU   OUCB+60
OUCBCPU  EQU   OUCB+56
OUCBTMW  EQU   OUCB+48
OUCBSWC  EQU   OUCB+38
OUCBR40  EQU   OUCB+30
OUCBR30  EQU   OUCB+29
OUCBUF7  EQU   OUCBUFL
OUCBUF6  EQU   OUCBUFL
OUCBUF5  EQU   OUCBUFL
OUCBMAR  EQU   OUCBTFL
OUCBPCH  EQU   OUCBTFL
OUCBRTR  EQU   OUCBTFL
OUCBNTR  EQU   OUCBTFL
OUCBNWT  EQU   OUCBAFL
OUCBR02  EQU   OUCBAFL
OUCBAF0  EQU   OUCBAFL
OUCBPSTE EQU   OUCBYFL
OUCBSCN  EQU   OUCBSFL
OUCBQF7  EQU   OUCBQFL
OUCBQF6  EQU   OUCBQFL
OUCBTMA  EQU   OUCB+12
OUCBNAME EQU   OUCB
ASCBEND  EQU   ASCB+208
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBRV07 EQU   ASCB+42
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
RRPAEND  EQU   RRPA+24
RRPATOD  EQU   RRPA+12
RRPARCI  EQU   RRPAFLG+1
RRPARFI  EQU   RRPAFLG+1
RRPARTI  EQU   RRPAFLG+1
RRPACTL  EQU   RRPAFLG+1
RRPAF11  EQU   RRPAFLG+1
RRPAF07  EQU   RRPAFLG
RRPAOPT  EQU   RRPAFLG
RRPAF05  EQU   RRPAFLG
RRPAF04  EQU   RRPAFLG
RRPADSP  EQU   RRPAFLG
RRPAVLU  EQU   RRPAINP
@NM00002 EQU   RRPAFLG0
EPSTEND  EQU   EPST+80
EPSTCSI  EQU   RMEPBCSI
EPSTCSO  EQU   RMEPBCSO
EPSTCL3  EQU   RMEPBCL3
EPSTIL3  EQU   RMEPBIL3
EPSTWM3  EQU   RMEPBWM3
EPDTEND  EQU   EPDT+96
EPATEND  EQU   EPAT+400
RMEPBPR1 EQU   EPAT+368
RMEPBEQ1 EQU   EPAT+336
RMEPBAP1 EQU   EPAT+304
RMEPBCL1 EQU   EPAT+272
RMEPBWM2 EQU   EPAT+240
RMEPBIL1 EQU   EPAT+208
RMEPBASM EQU   EPAT+176
RMEPBPR5 EQU   EPAT+144
RMEPBMS6 EQU   EPAT+112
RMEPBRM2 EQU   EPAT+64
RMEPBRM1 EQU   EPAT+32
RMSBEND  EQU   RMSB+120
RMSBRA9  EQU   RMSB+116
RMSBRA6  EQU   RMSB+104
RMSBTRC  EQU   RMSB+84
RMSBWM4  EQU   RMSB+56
RMSBWM5  EQU   RMSB+48
RMSBI09  EQU   RMSB+28
RMSBR24  EQU   RMSB+24
RMSBI07  EQU   RMSB+20
RMSBI05  EQU   RMSB+12
RMSBI03  EQU   RMSB+4
RMEXEND  EQU   RMEX+64
RMEXSRE  EQU   RMEX+60
RMEXXPE  EQU   RMEX+56
RMEXRR2  EQU   RMEX+52
RMEXRR1  EQU   RMEX+48
RMEXI48  EQU   RMEX+44
RMEXCXX  EQU   RMEX+36
RMEXEVT  EQU   RMEPBEVT
RMCAEND  EQU   RMCA+168
RMCAR90  EQU   RMCA+164
RMCAUSSC EQU   RMCASRC+36
RMCAEXSC EQU   RMCASRC+32
RMCANQSC EQU   RMCASRC+28
RMCARQSC EQU   RMCASRC+24
RMCADWSC EQU   RMCASRC+20
RMCARSSC EQU   RMCASRC+16
RMCAXSSC EQU   RMCASRC+12
RMCALWSC EQU   RMCASRC+8
RMCATISC EQU   RMCASRC+4
RMCATOSC EQU   RMCASRC
RMCACPW1 EQU   RMCA+120
RMCAR14  EQU   RMCA+116
RMCAR13  EQU   RMCA+112
RMCAWKA  EQU   RMCA+80
RMCAR20  EQU   RMCA+74
RMCAISV  EQU   RMCA+70
RMCAR11  EQU   RMCA+68
RMCAINV  EQU   RMCA+64
RMCAR10  EQU   RMCA+60
RMCARSV9 EQU   RMCA+56
RMCACHU  EQU   RMCA+52
RMCACHP  EQU   RMCA+48
RMCARSV8 EQU   RMCA+44
RMCARSV7 EQU   RMCA+40
RMCARSVF EQU   RMCAFLGS
RMCASAAF EQU   RMCAFLGS
RMCARSV5 EQU   RMCA+32
RMCARSV4 EQU   RMCA+28
RMCARSV3 EQU   RMCA+24
RMCATOI  EQU   RMCA+20
RMCATRS  EQU   RMCA+16
RMCATQS  EQU   RMCA+12
RMCARSV2 EQU   RMCA+10
RMCARSV1 EQU   RMCA+8
RMCAR04  EQU   RMCA+4
RMCANAME EQU   RMCA
RMPTEND  EQU   RMPT+72
RMPTOPE  EQU   RMPT+66
RMPTOPI  EQU   RMPT+63
RMPTOPC  EQU   RMPT+60
RMPTIOET EQU   RMPT+56
RMPTCPET EQU   RMPT+52
RMPTWMET EQU   RMPT+48
RMPTSAET EQU   RMPT+44
RMPTXCHT EQU   RMPT+40
RMPTRSV3 EQU   RMPT+38
RMPTRSV2 EQU   RMPT+36
RMPTRSV1 EQU   RMPT+32
RMPTTOL  EQU   RMPT+28
RMPTTOM  EQU   RMPT+24
RMPTTCS  EQU   RMPT+20
RMPTIMN  EQU   RMPT+16
RMPTERV  EQU   RMPT+12
RMPTIOC  EQU   RMPT+8
RMPTCPU  EQU   RMPT+4
RMPTNAME EQU   RMPT
RCTEND   EQU   RCT+88
RCVRSVF3 EQU   RCT+84
RCVRSVF2 EQU   RCT+80
RCVTAPAD EQU   RCT+76
RCVRSVF1 EQU   RCT+74
RCVTOTDF EQU   RCT+72
RCVBPTTM EQU   RCT+68
RCVBPTCT EQU   RCT+64
RCVASMQ  EQU   RCT+60
RCVAVQP  EQU   RCT+56
RCVCPUC  EQU   RCT+52
RCVUICC  EQU   RCT+48
RCVPTR   EQU   RCT+46
RCVASMQA EQU   RCT+44
RCVAVQC  EQU   RCT+42
RCVCPUA  EQU   RCT+40
RCVUICA  EQU   RCT+38
RCVCTMC  EQU   RCT+36
RCCRSVF3 EQU   RCT+32
RCCRSVF2 EQU   RCT+28
RCCRSVF1 EQU   RCT+26
RCCLCHRR EQU   RCT+24
RCCLCHUT EQU   RCT+22
RCCTOTUT EQU   RCT+20
RCCASMTH EQU   RCT+18
RCCASMTL EQU   RCT+16
RCCPTRTH EQU   RCT+14
RCCPTRTL EQU   RCT+12
RCCCPUTH EQU   RCT+10
RCCCPUTL EQU   RCT+8
RCCUICTH EQU   RCT+6
RCCUICTL EQU   RCT+4
RCTRCT   EQU   RCT
MCTEND   EQU   MCT+96
MCVRSVF3 EQU   MCT+92
MCVRSVF2 EQU   MCT+88
MCVRSVF1 EQU   MCT+84
MCCINTMX EQU   MCT+80
MCCPR1IN EQU   MCT+76
MCCUICIN EQU   MCT+72
MCCUICBD EQU   MCT+68
MCTRSVB1 EQU   MCT+67
MCTXRSVD EQU   MCT+66
MCTFX2   EQU   MCTOFLGS
MCTFX1   EQU   MCTOFLGS
MCTSMS2  EQU   MCTOFLGS
MCTSMS1  EQU   MCTOFLGS
MCTAMS2  EQU   MCTOFLGS
@NM00001 EQU   MCTOFLGS
MCTASM2  EQU   MCTOFLGS
MCTSF04  EQU   MCTSFLGS
MCVAVQC  EQU   MCT+60
MCVFRCNT EQU   MCT+58
MCVSTCRI EQU   MCT+56
MCCEND   EQU   MCT+56
MCCASMT2 EQU   MCT+54
MCCASMT1 EQU   MCT+52
MCCRSVH1 EQU   MCT+50
MCCPLUS  EQU   MCT+48
MCCMS403 EQU   MCT+44
MCCMS402 EQU   MCT+40
MCCMS401 EQU   MCT+36
MCCMS400 EQU   MCT+32
MCCMS203 EQU   MCT+28
MCCMS202 EQU   MCT+24
MCCMS201 EQU   MCT+20
MCCMS200 EQU   MCT+16
MCCMS102 EQU   MCT+12
MCCMS101 EQU   MCT+8
MCCMS100 EQU   MCT+4
MCTMCT   EQU   MCT
ICTEND   EQU   ICT+88
ICTRSVB3 EQU   ICT+87
ICTRSVB2 EQU   ICT+86
ICTRSVB1 EQU   ICT+85
ICT003   EQU   ICTFLAGS
ICTIOOT  EQU   ICTFLAGS
ICTIOL   EQU   ICTFLAGS
ICTDRSV4 EQU   ICTFLAGS
ICVIRSV3 EQU   ICT+80
ICVULCBT EQU   ICT+76
ICVOLCBT EQU   ICT+72
ICVLCBPT EQU   ICT+68
ICVLUTBT EQU   ICT+64
ICCEND   EQU   ICT+64
ICCRSV01 EQU   ICT+62
ICCEDSUT EQU   ICT+60
ICCSRSV2 EQU   ICT+58
ICCSIGUP EQU   ICT+56
ICCDASF2 EQU   ICT+36
ICCDASF1 EQU   ICT+34
ICCMINRV EQU   ICT+32
ICCMAXRV EQU   ICT+30
ICCRVSCF EQU   ICT+28
ICCMNIOR EQU   ICT+26
ICCLCHN  EQU   ICT+24
ICCLCLST EQU   ICT+20
ICCMNSWP EQU   ICT+16
ICCMNUIN EQU   ICT+12
ICCMXICT EQU   ICT+8
ICCMRSV1 EQU   ICT+4
ICTICT   EQU   ICT
CCVEND   EQU   CCT+128
CCTFLG2  EQU   CCT+125
CCTCPUOT EQU   CCTFLG1
CCTALL   EQU   CCTFLG1
CCVLGFMC EQU   CCT+118
CCVLGUTL EQU   CCT+116
CCVR07   EQU   CCT+114
CCVR06   EQU   CCT+112
CCVUTILP EQU   CCT+110
CCVR05   EQU   CCT+108
CCVIMBBT EQU   CCT+104
CCVEJST  EQU   CCT+100
CCVPGCPF EQU   CCT+96
CCVRVSWF EQU   CCT+92
CCVRBSTD EQU   CCT+88
CCVR04   EQU   CCT+84
CCVRBSWT EQU   CCT+80
CCVR03   EQU   CCT+76
CCCEND   EQU   CCT+76
CCCRSVH1 EQU   CCT+74
CCCSCFC2 EQU   CCT+72
CCCSCFC1 EQU   CCT+70
CCCR02   EQU   CCT+68
CCCSIGUR EQU   CCT+66
CCCSIGDP EQU   CCT+64
CCCSCFAC EQU   CCT+62
CCCMINRV EQU   CCT+60
CCCMAXRV EQU   CCT+58
CCCLOSCF EQU   CCT+56
CCCHISCF EQU   CCT+54
CCCUTLOT EQU   CCT+52
CCCUTHIT EQU   CCT+50
CCCAPRHT EQU   CCT+48
CCCAPRLT EQU   CCT+46
CCCR01   EQU   CCT+44
CCCAPLDP EQU   CCT+38
CCCAPROT EQU   CCT+34
CCCAPDIV EQU   CCT+32
CCCRSVF1 EQU   CCT+28
CCCMNSIN EQU   CCT+24
CCCMNUIN EQU   CCT+20
CCCAPDEL EQU   CCT+16
CCCAPMAX EQU   CCT+12
CCCAPMIN EQU   CCT+8
CCCAPMET EQU   CCT+4
CCTCCT   EQU   CCT
RMCTEND  EQU   RMCT+192
RMCTR50  EQU   RMCT+190
RMCTDMDE EQU   RMCT+184
RMCTSRBT EQU   RMCT+176
RMCTTOCI EQU   RMCT+160
RMCTCPID EQU   RMCT+156
RMCTTELM EQU   RMCT+152
RMCTF09  EQU   RMCTFLGS+1
RMCTMFS  EQU   RMCTFLGS+1
RMCTF07  EQU   RMCTFLGS+1
RMCTF06  EQU   RMCTFLGS
RMCTRSV2 EQU   RMCTFLGS
RMCTRSV1 EQU   RMCTFLGS
RMCTINIT EQU   RMCTFLGS
RMCTF03  EQU   RMCTFLGS
RMCTCPS1 EQU   RMCTFLGS
RMCTALR  EQU   RMCT+140
RMCTALA  EQU   RMCT+136
RMCTTOC  EQU   RMCT+128
RMCTR10  EQU   RMCT+116
RMCTINQE EQU   RMCT+112
RMCTOTQE EQU   RMCT+108
RMCTWTQE EQU   RMCT+104
RMCTAQHD EQU   RMCT+100
RMCTAQCT EQU   RMCT+96
RMCTTMQE EQU   RMCT+92
RMCTEPPR EQU   RMCT+80
RMCTFLTM EQU   RMCT+76
RMCTEPET EQU   RMCT+72
RMCTITT  EQU   RMCT+68
RMCTADJC EQU   RMCT+64
RMCTEPBG EQU   RMCT+60
RMCTEPAT EQU   RMCT+56
RMCTEPDT EQU   RMCT+52
RMCTEPPA EQU   RMCT+48
RMCTRMSB EQU   RMCT+44
RMCTRMEX EQU   RMCT+40
RMCTRMPD EQU   RMCT+36
RMCTRLCT EQU   RMCT+28
RMCTRMCA EQU   RMCT+20
RMCTRMPT EQU   RMCT+16
RMCTMCT  EQU   RMCT+12
RMCTICT  EQU   RMCT+8
RMCTCCT  EQU   RMCT+4
RMCTNAME EQU   RMCT
@NM00031 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00030 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00029 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00028 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00027 EQU   FLCFSA
@NM00026 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00025 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00024 EQU   FLCIOA
@NM00023 EQU   FLCMCLA+15
@NM00022 EQU   FLCMCLA+14
@NM00021 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00020 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00019 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00018 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00017 EQU   FLCPER
@NM00016 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00015 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00014 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00013 EQU   FLCPIILC
@NM00012 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00011 EQU   FLCSVILC
@NM00010 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00009 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00008 EQU   FLCICCW2+4
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00256 EQU   @EL00002
@RC00277 EQU   @RC00275
@RC00422 EQU   @RC00420
@RC00428 EQU   @RC00420
@RC00554 EQU   @RC00550
@RC00634 EQU   @RC00632
@RC00815 EQU   @RC00809
@RC00847 EQU   @RC00805
@RC00806 EQU   @RC00805
@RC00952 EQU   @RC00946
@RC00972 EQU   @RC00966
@RF01001 EQU   @RC00994
@RC01005 EQU   @RC00994
@RC01105 EQU   @RC01102
@RF01165 EQU   @RC01161
@RC01173 EQU   @RC01161
@RF01172 EQU   @RC01161
@RC01197 EQU   @RC01188
@RC01308 EQU   @RC01305
@RF01323 EQU   @RC01305
@RF01327 EQU   @RC01305
@RC01336 EQU   @RC01335
@RF01388 EQU   @RC01383
@RC00281 EQU   @RC00277
@RC00442 EQU   @RC00428
@RF00825 EQU   @RC00815
@RF00831 EQU   @RC00815
@RF00958 EQU   @RC00952
@RC01006 EQU   @RC01005
@RF01317 EQU   @RC01308
@RC01339 EQU   @RC01336
@RC01340 EQU   @RC01339
@RC01346 EQU   @RC01340
@ENDDATA EQU   *
         END   IRARMEVT,(C'PLS1912',0701,78167)

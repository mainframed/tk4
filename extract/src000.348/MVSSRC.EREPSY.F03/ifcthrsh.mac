         TITLE 'IFCTHRSH - CONTROL FOR THRESHOLD PROCESSING'
IFCTHRSH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCTHRSH  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @05,4095(,@10)                                      0001
         LA    @04,4095(,@05)                                      0001
         LA    @03,4095(,@04)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@05                                   0001
         USING @PSTART+16380,@04                                   0001
         USING @PSTART+20475,@03                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0213
SORT     STM   @14,@12,@SA00002                                    0213
*SRTCONT = ((NUMENT - ONE) * TWELVE) + CURRPTR;            /*@0001VLS*/
         L     @08,CURRPTR                                         0215
         L     @15,NUMENT                                          0215
         BCTR  @15,0                                               0215
         MH    @15,@CH00033                                        0215
         ALR   @15,@08                                             0215
         ST    @15,SRTCONT                                         0215
*R7 = CURRPTR;                     /* START OF THE SORT TABLE        */
         LR    R7,@08                                              0216
*GENERATE REFS(CONTRTAB);                                  /*@0001VLS*/
         LA    R15,TWELVE          LOAD THE INCREMENT VALUE
         L     R9,SRTCONT          LOAD THE MAX LIMIT
         LR    R1,R7               SET UP THE STOP LIMIT ON BACK UP
         B     DOIT                GO AROUND THIS CODE FIRST TIME
LOOPBCK1 ALR   R7,R15            MOVE THE POINTER TO NEXT ENTRY
         CR    R7,R9               ARE WE POINTING TO LAST ENTRY
         BNL   DONE                FINISHED WITH THE SORT SO EXIT
DOIT    CLC   CONTRTAB(TWELVE,R7),CONTRTAB+TWELVE(R7)
         BNH   LOOPBCK1            DONT NEED TO SORT ITEM
         XC    CONTRTAB(TWELVE,R7),CONTRTAB+TWELVE(R7)
         XC    CONTRTAB+TWELVE(TWELVE,R7),CONTRTAB(R7)
         XC    CONTRTAB(TWELVE,R7),CONTRTAB+TWELVE(R7)
         LR    R6,R7               SET NEW POINTER(BACKWARD)
LOOPBCK2 SR   R6,R15              POINT TO LAST ENTRY
         CR    R6,R1               DONT BACK OUT OF THE TABLE
         BL    LOOPBCK1            START WITH NEXT ENTRY
         CLC   CONTRTAB(TWELVE,R6),CONTRTAB+TWELVE(R6)
         BNH   LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE
         XC    CONTRTAB+TWELVE(TWELVE,R6),CONTRTAB(R6)
         XC    CONTRTAB(TWELVE,R6),CONTRTAB+TWELVE(R6)
         XC    CONTRTAB+TWELVE(TWELVE,R6),CONTRTAB(R6)
         B     LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN
DONE    EQU   *
TWELVE EQU 12                          /*                  @D3503SG*/
*RESPECIFY (R6,R9) UNRESTRICTED;                           /*@0001VLS*/
*IF DEBUG8 = ON THEN                                               0219
         TM    DEBUG8(R2),B'10000000'                              0219
         BNO   @RF00219                                            0219
*  CALL DUMP;                    /*DUMP THE SORT TABLE       @0001VLS*/
         BAL   @14,DUMP                                            0220
*MSGDS = CHARS(1);               /* EREPPT DATA SET OUTPUT   @0001VLS*/
@RF00219 MVC   MSGDS(1),CHARS                                      0221
*END;                                                      /*@0001VLS*/
@EL00002 DS    0H                                                  0222
@EF00002 DS    0H                                                  0222
@ER00002 LM    @14,@12,@SA00002                                    0222
         BR    @14                                                 0222
*/*                                                          @0001VLS*/
*/* OUTPUT THE TWO HEADERS AT THE TOP OF THE PAGE.           @0001VLS*/
*/*                                                          @0001VLS*/
*OUTHED12: PROC;                                           /*@0001VLS*/
OUTHED12 STM   @14,@12,@SA00003                                    0223
*  CALL PAGEJECT;                        /* NEW PAGE         @0001VLS*/
         BAL   @14,PAGEJECT                                        0224
*  MSGADDR(40:39+LENGTH(CUASH1)) = CUASH1;                 /*@0001VLS*/
         MVC   MSGADDR+39(44),CUASH1                               0225
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0226
*  CALL CONVERT(CONTRCUA,CUASH2C,TWO); /*CONVERT LOW CUA     @D3506GB*/
         MVC   @AL00001+4(8),@AL00227                              0227
         L     @06,CURRPTR                                         0227
         ST    @06,@AL00001                                        0227
         LA    @01,@AL00001                                        0227
         BAL   @14,CONVERT                                         0227
*  RECCPU=CPU;                                             /*@D3506GB*/
         L     @06,CURRPTR                                         0228
         MVC   RECCPU(3),CPU(@06)                                  0228
*  RECCUA=CONTRCUA;                                        /*@D3506GB*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0229
*  CALL CONVCNTR;                      /*CONVERT HIGH BY CONTROL CARD *
         BAL   @14,CONVCNTR                                        0230
*  IF VALIDCON=OFF THEN                                            0231
         TM    VALIDCON,B'00010000'                                0231
         BNZ   @RF00231                                            0231
*    DO;                                                   /*@D3506GB*/
*      CALL PRINTIT;                                       /*@D3506GB*/
         BAL   @14,PRINTIT                                         0233
*      CALL IFCMSG(90,ADDR(MSGADDR));  /*CUA RANGE IS > 16   @D3506GB*/
         LA    @06,MSGADDR                                         0234
         ST    @06,@AFTEMPS                                        0234
         L     @15,ADIFCMSG(,R2)                                   0234
         LA    @01,@AL00234                                        0234
         BALR  @14,@15                                             0234
*      CALL PRINTIT;                                       /*@D3506GB*/
         BAL   @14,PRINTIT                                         0235
*    END;                                                  /*@D3506GB*/
*  ELSE;                                                   /*@D3506GB*/
@RF00231 DS    0H                                                  0238
*  CALL CONVERT(HIGHCUA,CUASH2C2,TWO); /*CONVERT HIGH CUA    @D3506GB*/
         LA    @01,@AL00238                                        0238
         BAL   @14,CONVERT                                         0238
*  MSGADDR(40:39+LENGTH(CUASH2)) = CUASH2;                 /*@0001VLS*/
         MVC   MSGADDR+39(44),CUASH2                               0239
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0240
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0241
         BCTR  @06,0                                               0241
         BCTR  @06,0                                               0241
         ST    @06,MYLINCT                                         0241
*  HEAD1 = ON;                                             /*@0001VLS*/
         OI    HEAD1,B'00010000'                                   0242
* END;                                                     /*@0001VLS*/
@EL00003 DS    0H                                                  0243
@EF00003 DS    0H                                                  0243
@ER00003 LM    @14,@12,@SA00003                                    0243
         BR    @14                                                 0243
*/*                                                          @0001VLS*/
*/* OUTPUT THE NO RECORDS EXCEEDING THRESHOLD MESSAGE.       @0001VLS*/
*/*                                                          @0001VLS*/
*NOHEAD1: PROC;                                            /*@0001VLS*/
NOHEAD1  STM   @14,@12,@SA00004                                    0244
*  CALL OUTHED12;                        /* DISMOUNT HEADERS @0001VLS*/
         BAL   @14,OUTHED12                                        0245
*  CALL FINDDATE;                        /* FIND THE DATE RANGE      */
         BAL   @14,FINDDATE                                        0246
*  CALL CONVERT (LOWDATE,TEMPAREA,THREE);                  /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00247                              0247
         L     @06,DATEPTR                                         0247
         LA    @06,LOWDATE(,@06)                                   0247
         ST    @06,@AL00001                                        0247
         LA    @01,@AL00001                                        0247
         BAL   @14,CONVERT                                         0247
*  CUASH6D1 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUASH6D1(5),TEMPAREA                                0248
*  CALL CONVERT (HIDATE,TEMPAREA,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00249                              0249
         L     @06,DATEPTR                                         0249
         LA    @06,HIDATE(,@06)                                    0249
         ST    @06,@AL00001                                        0249
         LA    @01,@AL00001                                        0249
         BAL   @14,CONVERT                                         0249
*  CUASH6D2 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUASH6D2(5),TEMPAREA                                0250
*  MSGADDR(20:19+LENGTH(CUASH6)) = CUASH6;                 /*@0001VLS*/
         MVC   MSGADDR+19(42),CUASH6                               0251
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0252
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0253
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0254
         BCTR  @06,0                                               0254
         BCTR  @06,0                                               0254
         ST    @06,MYLINCT                                         0254
* END;                                                     /*@0001VLS*/
@EL00004 DS    0H                                                  0255
@EF00004 DS    0H                                                  0255
@ER00004 LM    @14,@12,@SA00004                                    0255
         BR    @14                                                 0255
*/*                                                          @0001VLS*/
*/* OUTPUT THE NO PERMANENT ERRORS MESSAGE.                  @0001VLS*/
*/*                                                          @0001VLS*/
*NOHEAD2: PROC;                                            /*@0001VLS*/
NOHEAD2  STM   @14,@12,@SA00005                                    0256
*  MSGADDR = SPACER;                     /* SPACER LINE      @0001VLS*/
         MVC   MSGADDR(132),SPACER                                 0257
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0258
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0259
*  MYLINCT = MYLINCT - TWO;                                /*@0001VLS*/
         L     @06,MYLINCT                                         0260
         BCTR  @06,0                                               0260
         BCTR  @06,0                                               0260
         ST    @06,MYLINCT                                         0260
*  IF MYLINCT < FOUR THEN                /* EJECT TO NEW PAGE IF REST*/
         C     @06,@CF00037                                        0261
         BNL   @RF00261                                            0261
*    CALL PAGEJECT;                      /* OF REPORT WILL NOT FIT   */
         BAL   @14,PAGEJECT                                        0262
*  MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;                 /*@0001VLS*/
@RF00261 MVC   MSGADDR+43(25),CUAPH1                               0263
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0264
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0265
*  CALL FINDDATE;                        /* FIND THE DATE RANGE      */
         BAL   @14,FINDDATE                                        0266
*  CALL CONVERT(LOWDATE,TEMPAREA,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00267                              0267
         L     @06,DATEPTR                                         0267
         LA    @06,LOWDATE(,@06)                                   0267
         ST    @06,@AL00001                                        0267
         LA    @01,@AL00001                                        0267
         BAL   @14,CONVERT                                         0267
*  CUAPH5D1 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUAPH5D1(5),TEMPAREA                                0268
*  CALL CONVERT(HIDATE,TEMPAREA,THREE);                    /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00269                              0269
         L     @06,DATEPTR                                         0269
         LA    @06,HIDATE(,@06)                                    0269
         ST    @06,@AL00001                                        0269
         LA    @01,@AL00001                                        0269
         BAL   @14,CONVERT                                         0269
*  CUAPH5D2 = TEMPAREA(1:5);                               /*@0001VLS*/
         MVC   CUAPH5D2(5),TEMPAREA                                0270
*  MSGADDR(20:19+LENGTH(CUAPH5)) = CUAPH5;                 /*@0001VLS*/
         MVC   MSGADDR+19(47),CUAPH5                               0271
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0272
*  CALL PRINTIT;                                           /*@0001VLS*/
         BAL   @14,PRINTIT                                         0273
*  MYLINCT = MYLINCT - FOUR;                               /*@0001VLS*/
         L     @06,MYLINCT                                         0274
         SL    @06,@CF00037                                        0274
         ST    @06,MYLINCT                                         0274
*  HEAD2 = ON;                                             /*@0001VLS*/
         OI    HEAD2,B'00001000'                                   0275
*END;                                                      /*@0001VLS*/
@EL00005 DS    0H                                                  0276
@EF00005 DS    0H                                                  0276
@ER00005 LM    @14,@12,@SA00005                                    0276
         BR    @14                                                 0276
*/*                                                          @0001VLS*/
*/* EJECT TO A NEW PAGE.                                     @0001VLS*/
*/*                                                          @0001VLS*/
*PAGEJECT: PROC;                                           /*@0001VLS*/
PAGEJECT STM   @14,@12,@SA00006                                    0277
* MSGCC = EJECT;                                           /*@0001VLS*/
         MVI   MSGCC,X'89'                                         0278
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0279
* MSGCC = SPACE;                                           /*@0001VLS*/
         MVI   MSGCC,X'09'                                         0280
* MYLINCT = LINECT - ONE;                                  /*@0001VLS*/
         LH    @06,LINECT(,R2)                                     0281
         BCTR  @06,0                                               0281
         ST    @06,MYLINCT                                         0281
*END;                                                      /*@0001VLS*/
@EL00006 DS    0H                                                  0282
@EF00006 DS    0H                                                  0282
@ER00006 LM    @14,@12,@SA00006                                    0282
         BR    @14                                                 0282
*/*                                                          @0001VLS*/
*/* OUTPUT THE PERMANENT ERROR SECTION OF THE REPORT.  IF THE HEADERS*/
*/* HAVE NOT BEEN PRINTED, PRINT THE SPACER, AND THEN THE HEADERS.   */
*/* IF THE HEADERS FOR THE DISMOUNT SECTION HAVE NOT BEEN PRINTED,   */
*/* PRINT THE HEADERS, AND THE MESSAGE THAT NO RECORDS EXCEED        */
*/* THRESHOLD.                                               @0001VLS*/
*/*                                                          @0001VLS*/
*CUAPERMS: PROC;                                           /*@0001VLS*/
CUAPERMS STM   @14,@12,@SA00007                                    0283
* RECCPU = CPU;                          /* INITIALIZE FOR SEARCH TO */
         L     @06,CURRPTR                                         0284
         MVC   RECCPU(3),CPU(@06)                                  0284
* RECCUA = CONTRCUA;                     /* FIND DATE RANGE. @0001VLS*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0285
* IF HEAD1 = OFF THEN                                              0286
         TM    HEAD1,B'00010000'                                   0286
         BNZ   @RF00286                                            0286
*    CALL NOHEAD1;                       /* SECTION ONE HEADERS      */
         BAL   @14,NOHEAD1                                         0287
* IF HEAD2 = OFF THEN                                              0288
@RF00286 TM    HEAD2,B'00001000'                                   0288
         BNZ   @RF00288                                            0288
*    DO;                                                   /*@0001VLS*/
*      MSGADDR = SPACER;                 /* SPACER LINE      @0001VLS*/
         MVC   MSGADDR(132),SPACER                                 0290
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0291
*      CALL PRINTIT;                     /* BLANK LINE       @0001VLS*/
         BAL   @14,PRINTIT                                         0292
*      MYLINCT = MYLINCT - TWO;                            /*@0001VLS*/
         L     @06,MYLINCT                                         0293
         BCTR  @06,0                                               0293
         BCTR  @06,0                                               0293
         ST    @06,MYLINCT                                         0293
*      IF MYLINCT < ELEVEN THEN          /* EJECT TO A NEW PAGE IF   */
         C     @06,@CF00034                                        0294
         BNL   @RF00294                                            0294
*        CALL PAGEJECT;                  /* REST OF REPORT WONT FIT  */
         BAL   @14,PAGEJECT                                        0295
*      MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;             /*@0001VLS*/
@RF00294 MVC   MSGADDR+43(25),CUAPH1                               0296
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0297
*      MSGADDR(74:73+LENGTH(CUAPH2)) = CUAPH2;             /*@0001VLS*/
         MVC   MSGADDR+73(11),CUAPH2                               0298
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0299
*      MSGADDR(81:80+LENGTH(CUAPH3)) = CUAPH3;             /*@0001VLS*/
         MVC   MSGADDR+80(42),CUAPH3                               0300
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0301
*      MSGADDR = CUAPH4;                                   /*@0001VLS*/
         MVI   MSGADDR+120,C' '                                    0302
         MVC   MSGADDR+121(11),MSGADDR+120                         0302
         MVC   MSGADDR(120),CUAPH4                                 0302
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0303
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         0304
*      MYLINCT = MYLINCT - FIVE;                           /*@0001VLS*/
         L     @06,MYLINCT                                         0305
         SL    @06,@CF00036                                        0305
         ST    @06,MYLINCT                                         0305
*      HEAD2 = ON;                                         /*@0001VLS*/
         OI    HEAD2,B'00001000'                                   0306
*    END;                                                  /*@0001VLS*/
* IF MYLINCT < SEVEN THEN                /* EJECT TO NEW PAGE IF REST*/
@RF00288 L     @06,MYLINCT                                         0308
         C     @06,@CF00082                                        0308
         BNL   @RF00308                                            0308
*   DO;                                  /* OF REPORT WILL NOT FIT   */
*     CALL PAGEJECT;                                       /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0310
*     MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;              /*@0001VLS*/
         MVC   MSGADDR+43(25),CUAPH1                               0311
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0312
*     MSGADDR(74:73+LENGTH(CUAPH2)) = CUAPH2;              /*@0001VLS*/
         MVC   MSGADDR+73(11),CUAPH2                               0313
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0314
*     MSGADDR(81:80+LENGTH(CUAPH3)) = CUAPH3;              /*@0001VLS*/
         MVC   MSGADDR+80(42),CUAPH3                               0315
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0316
*     MSGADDR = CUAPH4;                                    /*@0001VLS*/
         MVI   MSGADDR+120,C' '                                    0317
         MVC   MSGADDR+121(11),MSGADDR+120                         0317
         MVC   MSGADDR(120),CUAPH4                                 0317
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0318
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0319
*     MYLINCT = MYLINCT - FIVE;                            /*@0001VLS*/
         L     @06,MYLINCT                                         0320
         SL    @06,@CF00036                                        0320
         ST    @06,MYLINCT                                         0320
*   END;                                                   /*@0001VLS*/
* CALL CONVERT (SECUA2,TEMPAREA,TWO);    /* SECONDARY CUA    @0001VLS*/
@RF00308 MVC   @AL00001+4(8),@AL00322                              0322
         LA    @06,SECUA2(,R7)                                     0322
         ST    @06,@AL00001                                        0322
         LA    @01,@AL00001                                        0322
         BAL   @14,CONVERT                                         0322
* OUTDEV = TEMPAREA(2:4);                                  /*@0001VLS*/
         MVC   OUTDEV(3),TEMPAREA+1                                0323
* IF OSER74XX ^= HEXZEROS THEN                                     0324
         CLC   OSER74XX(2,R7),@CB00208                             0324
         BE    @RF00324                                            0324
*   CALL CONVBIN2(OSER74XX,OUTSER);      /* TAPE UNIT SERIAL NUMBER  */
         LA    @06,OSER74XX(,R7)                                   0325
         ST    @06,@AL00001                                        0325
         LA    @06,OUTSER                                          0325
         ST    @06,@AL00001+4                                      0325
         LA    @01,@AL00001                                        0325
         BAL   @14,CONVBIN2                                        0325
* ELSE                                                             0326
*   OUTSER = NA;                                           /*@0001VLS*/
         B     @RC00324                                            0326
@RF00324 MVC   OUTSER(5),@CC00495                                  0326
* IF SENSBIT3(1) = OFF THEN              /* PERMANENT ERROR  @0001VLS*/
@RC00324 TM    SENSBIT3(R7),B'00010000'                            0327
         BNZ   @RF00327                                            0327
*   IF SENSBIT5(2) = ON THEN                                       0328
         TM    SENSBIT5+1(R7),B'00000100'                          0328
         BNO   @RF00328                                            0328
*     OUTERR = ERRTABC(1);                             /* PW @0001VLS*/
         MVC   OUTERR(2),ERRTABC                                   0329
*   ELSE                                                           0330
*     IF CCWBYT0 = CB ×                   /* IS IT MODE SET  @ZA35214*/
*        CCWBYT0 = C3 ×                   /* IS IT MODE SET  @ZA35214*/
*        CCWBYT0 = D3 THEN                /* IS IT MODE SET  @ZA35214*/
         B     @RC00328                                            0330
@RF00328 CLI   CCWBYT0(R7),X'CB'                                   0330
         BE    @RT00330                                            0330
         CLI   CCWBYT0(R7),X'C3'                                   0330
         BE    @RT00330                                            0330
         CLI   CCWBYT0(R7),X'D3'                                   0330
         BNE   @RF00330                                            0330
@RT00330 DS    0H                                                  0331
*       OUTERR = ERRTABC(11);             /* YES          EM @ZA35214*/
         MVC   OUTERR(2),ERRTABC+340                               0331
*     ELSE                                                         0332
*       OUTERR = ERRTABC(2);                            /* PR @ZA35214*
         B     @RC00330                                            0332
@RF00330 MVC   OUTERR(2),ERRTABC+34                                0332
* ELSE                                                             0333
*   IF SENSBIT5(8) = ON THEN             /* EQUIPMENT CHECK  @0001VLS*/
         B     @RC00327                                            0333
@RF00327 TM    SENSBIT5+7(R7),B'00000100'                          0333
         BNO   @RF00333                                            0333
*     OUTERR = ERRTABC(5);                             /* EE @0001VLS*/
         MVC   OUTERR(2),ERRTABC+136                               0334
*   ELSE                                                           0335
*     IF SENSBIT7(8) = ON THEN                                     0335
         B     @RC00333                                            0335
@RF00333 TM    SENSBIT7+7(R7),B'00000001'                          0335
         BNO   @RF00335                                            0335
*       OUTERR = ERRTABC(7);                           /* EL @0001VLS*/
         MVC   OUTERR(2),ERRTABC+204                               0336
*     ELSE                                                         0337
*       IF SENSBIT6(8) = ON THEN                                   0337
         B     @RC00335                                            0337
@RF00335 TM    SENSBIT6+7(R7),B'00000010'                          0337
         BNO   @RF00337                                            0337
*         OUTERR = ERRTABC(8);                         /* EP @0001VLS*/
         MVC   OUTERR(2),ERRTABC+238                               0338
*       ELSE                                                       0339
*         IF SENSBIT3(8) = ON THEN                                 0339
         B     @RC00337                                            0339
@RF00337 TM    SENSBIT3+7(R7),B'00010000'                          0339
         BNO   @RF00339                                            0339
*           OUTERR = ERRTABC(11);                      /* EM @ZA35214*/
         MVC   OUTERR(2),ERRTABC+340                               0340
*         ELSE                                                     0341
*           IF SENSBIT5(11) = ON THEN                              0341
         B     @RC00339                                            0341
@RF00339 TM    SENSBIT5+10(R7),B'00000100'                         0341
         BNO   @RF00341                                            0341
*             OUTERR = ERRTABC(9);                     /* ET @0001VLS*/
         MVC   OUTERR(2),ERRTABC+272                               0342
*           ELSE                                                   0343
*             IF SENSBIT7(11) = ON THEN                            0343
         B     @RC00341                                            0343
@RF00341 TM    SENSBIT7+10(R7),B'00000001'                         0343
         BNO   @RF00343                                            0343
*               OUTERR = ERRTABC(10);                  /* EV @0001VLS*/
         MVC   OUTERR(2),ERRTABC+306                               0344
*             ELSE                                                 0345
*               OUTERR = ERRTABC(4);                   /* EC @0001VLS*/
         B     @RC00343                                            0345
@RF00343 MVC   OUTERR(2),ERRTABC+102                               0345
* PVOL = VOLID;                          /* VOLUME IDENTIFICATION    */
@RC00343 DS    0H                                                  0346
@RC00341 DS    0H                                                  0346
@RC00339 DS    0H                                                  0346
@RC00337 DS    0H                                                  0346
@RC00335 DS    0H                                                  0346
@RC00333 DS    0H                                                  0346
@RC00327 MVC   PVOL(6),VOLID(R7)                                   0346
* CALL CONVERT (FAILCCW,PCCW,EIGHT);     /* FAILING CCW      @0001VLS*/
         MVC   @AL00001+4(8),@AL00347                              0347
         LA    @06,FAILCCW(,R7)                                    0347
         ST    @06,@AL00001                                        0347
         LA    @01,@AL00001                                        0347
         BAL   @14,CONVERT                                         0347
* CALL CONVERT (CSW,PCSW,FOUR);          /* FAILING CSW      @0001VLS*/
         MVC   @AL00001+4(8),@AL00348                              0348
         LA    @06,CSW(,R7)                                        0348
         ST    @06,@AL00001                                        0348
         LA    @01,@AL00001                                        0348
         BAL   @14,CONVERT                                         0348
* DO Z = ONE TO 24;                                        /*@0001VLS*/
         LA    @06,1                                               0349
         ST    @06,Z                                               0349
@DL00349 DS    0H                                                  0350
*   CALL CONVERT (SENSE(Z),PSNSB(Z),ONE);  /* SENSE BYTES    @0001VLS*/
         LA    @15,SENSE-1(@06,R7)                                 0350
         ST    @15,@AL00001                                        0350
         MH    @06,@CH00038                                        0350
         LA    @06,PSNSB-3(@06)                                    0350
         ST    @06,@AL00001+4                                      0350
         LA    @06,@CF00057                                        0350
         ST    @06,@AL00001+8                                      0350
         LA    @01,@AL00001                                        0350
         BAL   @14,CONVERT                                         0350
* END;                                                     /*@0001VLS*/
         LA    @06,1                                               0351
         AL    @06,Z                                               0351
         ST    @06,Z                                               0351
         C     @06,@CF00227                                        0351
         BNH   @DL00349                                            0351
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         0352
* MYLINCT = MYLINCT - ONE;                                 /*@0001VLS*/
         L     @06,MYLINCT                                         0353
         BCTR  @06,0                                               0353
         ST    @06,MYLINCT                                         0353
*END;                                                      /*@0001VLS*/
@EL00007 DS    0H                                                  0354
@EF00007 DS    0H                                                  0354
@ER00007 LM    @14,@12,@SA00007                                    0354
         BR    @14                                                 0354
*/********************************************************************/
*/*                      8809DEV                             @D3503SG*/
*/* OUTPUT THE PERMANENT ERROR SECTION OF THE REPORT.  IF THE HEADERS*/
*/* HAVE NOT BEEN PRINTED, PRINT THE SPACER, AND THEN THE HEADERS.   */
*/* IF THE HEADERS FOR THE DISMOUNT SECTION HAVE NOT BEEN PRINTED,   */
*/* PRINT THE HEADERS, AND THE MESSAGE THAT NO RECORDS EXCEED        */
*/* THRESHOLD.                                               @000@SSG*/
*/********************************************************************/
*SFPERMS: PROC;                                           /*@000@SSG*/
SFPERMS  STM   @14,@12,@SA00008                                    0355
* RECCPU = CPU;                          /* INITIALIZE FOR SEARCH TO */
         L     @06,CURRPTR                                         0356
         MVC   RECCPU(3),CPU(@06)                                  0356
* RECCUA = CONTRCUA;                     /* FIND DATE RANGE. @000@SSG*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0357
* IF HEAD1 = OFF THEN                                              0358
         TM    HEAD1,B'00010000'                                   0358
         BNZ   @RF00358                                            0358
*    CALL NOHEAD1;                       /* SECTION ONE HEADERS      */
         BAL   @14,NOHEAD1                                         0359
* IF HEAD2 = OFF THEN                                              0360
@RF00358 TM    HEAD2,B'00001000'                                   0360
         BNZ   @RF00360                                            0360
*    DO;                                                   /*@D3503SG*/
*      MSGADDR = SPACER;                 /* SPACER LINE      @D3503SG*/
         MVC   MSGADDR(132),SPACER                                 0362
*      CALL PRINTIT;                                       /*@D3503SG*/
         BAL   @14,PRINTIT                                         0363
*      CALL PRINTIT;                     /* BLANK LINE       @D3503SG*/
         BAL   @14,PRINTIT                                         0364
*      MYLINCT = MYLINCT - TWO;                            /*@D3503SG*/
         L     @06,MYLINCT                                         0365
         BCTR  @06,0                                               0365
         BCTR  @06,0                                               0365
         ST    @06,MYLINCT                                         0365
*      IF MYLINCT < ELEVEN THEN          /* EJECT TO A NEW PAGE IF   */
         C     @06,@CF00034                                        0366
         BNL   @RF00366                                            0366
*        CALL PAGEJECT;                  /* REST OF REPORT WONT FIT  */
         BAL   @14,PAGEJECT                                        0367
*      MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;             /*@D3503SG*/
@RF00366 MVC   MSGADDR+43(25),CUAPH1                               0368
*      CALL PRINTIT;                                       /*@D3503SG*/
         BAL   @14,PRINTIT                                         0369
*      CALL PRINTIT;                                       /*@D3503SG*/
         BAL   @14,PRINTIT                                         0370
*      MSGADDR = CUAPH6;                                   /*@D3503SG*/
         MVI   MSGADDR+99,C' '                                     0371
         MVC   MSGADDR+100(32),MSGADDR+99                          0371
         MVC   MSGADDR(99),CUAPH6                                  0371
*      CALL PRINTIT;                                       /*@D3503SG*/
         BAL   @14,PRINTIT                                         0372
*      MSGADDR =CUAPH7;                                    /*@D3503SG*/
         MVI   MSGADDR+100,C' '                                    0373
         MVC   MSGADDR+101(31),MSGADDR+100                         0373
         MVC   MSGADDR(100),CUAPH7                                 0373
*      CALL PRINTIT;                                       /*@D3503SG*/
         BAL   @14,PRINTIT                                         0374
*      MYLINCT = MYLINCT - FIVE;                           /*@D3503SG*/
         L     @06,MYLINCT                                         0375
         SL    @06,@CF00036                                        0375
         ST    @06,MYLINCT                                         0375
*      HEAD2 = ON;                                         /*@D3503SG*/
         OI    HEAD2,B'00001000'                                   0376
*    END;          /*IF HEAD2 = OFF                          @D3503SG*/
* IF MYLINCT < SEVEN THEN                /* EJECT TO NEW PAGE IF REST*/
@RF00360 L     @06,MYLINCT                                         0378
         C     @06,@CF00082                                        0378
         BNL   @RF00378                                            0378
*   DO;                                  /* OF REPORT WILL NOT FIT   */
*     CALL PAGEJECT;                                       /*@D3503SG*/
         BAL   @14,PAGEJECT                                        0380
*     MSGADDR(44:43+LENGTH(CUAPH1)) = CUAPH1;              /*@D3503SG*/
         MVC   MSGADDR+43(25),CUAPH1                               0381
*     CALL PRINTIT;                                        /*@D3503SG*/
         BAL   @14,PRINTIT                                         0382
*     CALL PRINTIT;                                        /*@D3503SG*/
         BAL   @14,PRINTIT                                         0383
*     MSGADDR = CUAPH6;                                    /*@D3503SG*/
         MVI   MSGADDR+99,C' '                                     0384
         MVC   MSGADDR+100(32),MSGADDR+99                          0384
         MVC   MSGADDR(99),CUAPH6                                  0384
*     CALL PRINTIT;                                        /*@D3503SG*/
         BAL   @14,PRINTIT                                         0385
*     MSGADDR = CUAPH7;                                    /*@D3503SG*/
         MVI   MSGADDR+100,C' '                                    0386
         MVC   MSGADDR+101(31),MSGADDR+100                         0386
         MVC   MSGADDR(100),CUAPH7                                 0386
*     MYLINCT = MYLINCT - FIVE;                            /*@D3503SG*/
         L     @06,MYLINCT                                         0387
         SL    @06,@CF00036                                        0387
         ST    @06,MYLINCT                                         0387
*   END;           /*IF MYLINCT < SEVEN                      @D3503SG*/
* CALL CONVERT (OCUA2,TEMPAREA,2);       /* SECONDARY CUA #  @D3503SG*/
@RF00378 MVC   @AL00001+4(8),@AL00389                              0389
         LA    @06,OCUA2(,R7)                                      0389
         ST    @06,@AL00001                                        0389
         LA    @01,@AL00001                                        0389
         BAL   @14,CONVERT                                         0389
* SPCUA = TEMPAREA(2:4);                 /*                  @D3503SG*/
         MVI   SPCUA+3,C' '                                        0390
         MVC   SPCUA(3),TEMPAREA+1                                 0390
* IF SOWCHK1 = ON  ×                     /*BYTE 20,BIT 2=1   @D3503SG*/
*    SOWCHK2 = ON   THEN                 /*BYTE 20,BIT 3=1   @D3503SG*/
         TM    SOWCHK1(R7),B'00110000'                             0391
         BZ    @RF00391                                            0391
*      SPERR = ERRTABLE(12);    /* WC-SET WRITE CURRENT ERR. @D3503SG*/
         MVC   SPERR(2),ERRTABLE+374                               0392
* ELSE                                   /*                  @D3503SG*/
*    IF (SOSYMP & 'F0'X) = CBX  ×        /*BYTE 30=X'B'      @D3503SG*/
*       (SOSYMP & 'F0'X) = CCX  ×        /*BYTE 30=X'C'      @D3503SG*/
*       (SOSYMP & 'F0'X) = CDX  THEN     /*BYTE 30=X'D'      @D3503SG*/
         B     @RC00391                                            0393
@RF00391 MVC   @TS00001(1),SOSYMP(R7)                              0393
         NI    @TS00001,X'F0'                                      0393
         CLI   @TS00001,X'B0'                                      0393
         BE    @RT00393                                            0393
         MVC   @TS00001(1),SOSYMP(R7)                              0393
         NI    @TS00001,X'F0'                                      0393
         CLI   @TS00001,X'C0'                                      0393
         BE    @RT00393                                            0393
         MVC   @TS00001(1),SOSYMP(R7)                              0393
         NI    @TS00001,X'F0'                                      0393
         CLI   @TS00001,X'D0'                                      0393
         BNE   @RF00393                                            0393
@RT00393 DS    0H                                                  0394
*         SPERR = ERRTABLE(4);  /* EC-SET EQUIPMENT CHECK    @D3503SG*/
         MVC   SPERR(2),ERRTABLE+102                               0394
*    ELSE                                /*                  @D3503SG*/
*      IF SOSYMP = CE1  ×                /*BYTE 30=X'E1'     @D3503SG*/
*         SOSYMP = CE2  THEN             /*BYTE 30=X'E2'     @D3503SG*/
         B     @RC00393                                            0395
@RF00393 CLI   SOSYMP(R7),X'E1'                                    0395
         BE    @RT00395                                            0395
         CLI   SOSYMP(R7),X'E2'                                    0395
         BNE   @RF00395                                            0395
@RT00395 DS    0H                                                  0396
*           SPERR = ERRTABLE(1);/* PW-SET PERMANENT WRITE ER.@D3503SG*/
         MVC   SPERR(2),ERRTABLE                                   0396
*      ELSE                              /*                  @D3503SG*/
*        IF SOSYMP = CE3  THEN           /*BYTE 30=X'E3'     @D3503SG*/
         B     @RC00395                                            0397
@RF00395 CLI   SOSYMP(R7),X'E3'                                    0397
         BNE   @RF00397                                            0397
*             SPERR = ERRTABLE(2); /* PR-SET PERM. READ ERR. @D3503SG*/
         MVC   SPERR(2),ERRTABLE+34                                0398
*        ELSE                            /*UNKNOWN           @D3503SG*/
*          SPERR = ERRTABLE(3);    /* PF-NONE OF THE ABOVE   @D3503SG*/
         B     @RC00397                                            0399
@RF00397 MVC   SPERR(2),ERRTABLE+68                                0399
* SPVOLID = VOLID;                       /*VOLUME ID.        @D3503SG*/
@RC00397 DS    0H                                                  0400
@RC00395 DS    0H                                                  0400
@RC00393 DS    0H                                                  0400
@RC00391 MVC   SPVOLID(6),VOLID(R7)                                0400
* CALL CONVERT(FAILCCW,SPCCW,8);         /*FAILING CCW       @D3503SG*/
         MVC   @AL00001+4(8),@AL00401                              0401
         LA    @06,FAILCCW(,R7)                                    0401
         ST    @06,@AL00001                                        0401
         LA    @01,@AL00001                                        0401
         BAL   @14,CONVERT                                         0401
* CALL CONVERT(CSW34XX,SPCSW,4);         /*BITS 4-7 CSW      @D3503SG*/
         MVC   @AL00001+4(8),@AL00402                              0402
         LA    @06,CSW34XX(,R7)                                    0402
         ST    @06,@AL00001                                        0402
         LA    @01,@AL00001                                        0402
         BAL   @14,CONVERT                                         0402
* CALL CONVERT(DATE(2:4),TEMPAREA,6);    /*DATE DATA         @D3503SG*/
         MVC   @AL00001+4(8),@AL00403                              0403
         LA    @06,DATE+1(,R7)                                     0403
         ST    @06,@AL00001                                        0403
         LA    @01,@AL00001                                        0403
         BAL   @14,CONVERT                                         0403
* SPDAY = TEMPAREA(3:5);                 /*DATE-DAY          @D3503SG*/
         MVC   SPDAY(3),TEMPAREA+2                                 0404
* SPYEAR = TEMPAREA(1:2);                /*DATE-YEAR         @D3503SG*/
         MVC   SPYEAR(2),TEMPAREA                                  0405
* CALL CONVERT(TIME,TEMPAREA,8);         /*TIME DATA         @D3503SG*/
         MVC   @AL00001+4(8),@AL00406                              0406
         LA    @06,TIME(,R7)                                       0406
         ST    @06,@AL00001                                        0406
         LA    @01,@AL00001                                        0406
         BAL   @14,CONVERT                                         0406
* SPHH = TEMPAREA(1:2);                  /*TIME-HOURS        @D3503SG*/
         MVC   SPHH(2),TEMPAREA                                    0407
* SPMM = TEMPAREA(3:4);                  /*TIME-MINUTES      @D3503SG*/
         MVC   SPMM(2),TEMPAREA+2                                  0408
* SPSS = TEMPAREA(5:6);                  /*TIME-SECONDS      @D3503SG*/
         MVC   SPSS(2),TEMPAREA+4                                  0409
* SPPOINT = PERIOD;                      /*DECIMAL POINT     @D3503SG*/
         MVI   SPPOINT,C'.'                                        0410
* SPTH = TEMPAREA(7:8);                  /*TIME-TENTHS       @D3503SG*/
         MVC   SPTH(2),TEMPAREA+6                                  0411
* IF SOIPSB = ON   THEN                  /*BYTE 80 IS SET    @D3503SG*/
         TM    SOIPSB(R7),B'00000010'                              0412
         BNO   @RF00412                                            0412
*    SPIPS = CHONE;                      /*SET 100 IN/SEC.   @D3503SG*/
         MVI   SPIPS,C'1'                                          0413
* ELSE                                   /*                  @D3503SG*/
*    SPIPS = CHZERO;                     /*RESET 100 IN/SEC. @D3503SG*/
         B     @RC00412                                            0414
@RF00412 MVI   SPIPS,C'0'                                          0414
* IF SOLGM = ON   THEN                   /*LONG GAP MODE ?   @D3503SG*/
@RC00412 TM    SOLGM(R7),B'00001000'                               0415
         BNO   @RF00415                                            0415
*   SPLGM = CHONE;                       /*YES-SET INDICATER @D3503SG*/
         MVI   SPLGM,C'1'                                          0416
* ELSE                                   /*                  @D3503SG*/
*   SPLGM = CHZERO;                      /*NO-RESET INDCATER @D3503SG*/
         B     @RC00415                                            0417
@RF00415 MVI   SPLGM,C'0'                                          0417
* CALL CONVERT(SOSYMCD,SPSYMCD,TWO);     /*SYMPTOM CODE      @D3503SG*/
@RC00415 MVC   @AL00001+4(8),@AL00418                              0418
         LA    @06,SOSYMCD(,R7)                                    0418
         ST    @06,@AL00001                                        0418
         LA    @01,@AL00001                                        0418
         BAL   @14,CONVERT                                         0418
* CALL PRINTIT;                          /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         0419
* MYLINCT = MYLINCT - ONE;               /*                  @D3503SG*/
         L     @06,MYLINCT                                         0420
         BCTR  @06,0                                               0420
         ST    @06,MYLINCT                                         0420
*END ;           /*  SFPERMS PROC.                           @D3503SG*/
@EL00008 DS    0H                                                  0421
@EF00008 DS    0H                                                  0421
@ER00008 LM    @14,@12,@SA00008                                    0421
         BR    @14                                                 0421
*/*                                                          @0001VLS*/
*/* OUTPUT THE DISMOUNT SECTION OF THE REPORT.  IF THE HEADERS HAVE  */
*/* NOT BEEN PRINTED, THEN PRINT THE HEADERS FOR SECTION ONE.        */
*/*                                                          @0001VLS*/
* CUASTATS: PROC;                                          /*@0001VLS*/
CUASTATS STM   @14,@12,@SA00009                                    0422
*    IF HEAD1 = OFF THEN            /* PRINT HEADERS         @0001VLS*/
         TM    HEAD1,B'00010000'                                   0423
         BNZ   @RF00423                                            0423
*      DO;                                                 /*@0001VLS*/
*        CALL OUTHED12;                                    /*@0001VLS*/
         BAL   @14,OUTHED12                                        0425
*        CUASH3R = RDTHRSH;         /* READ THRESHOLD        @0001VLS*/
         MVC   CUASH3R(3),RDTHRSH(R2)                              0426
*        CUASH3W = WRTHRSH;         /* WRITE THRESHOLD       @0001VLS*/
         MVC   CUASH3W(3),WRTHRSH(R2)                              0427
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@0001VLS*/
         MVC   MSGADDR+29(61),CUASH3                               0428
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0429
*        CALL PRINTIT;              /* BLANK LINE            @0001VLS*/
         BAL   @14,PRINTIT                                         0430
*        MSGADDR = CUASH4;                                 /*@0001VLS*/
         MVI   MSGADDR+130,C' '                                    0431
         MVI   MSGADDR+131,C' '                                    0431
         MVC   MSGADDR(130),CUASH4                                 0431
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0432
*        MSGADDR = CUASH5;                                 /*@0001VLS*/
         MVI   MSGADDR+129,C' '                                    0433
         MVC   MSGADDR+130(2),MSGADDR+129                          0433
         MVC   MSGADDR(129),CUASH5                                 0433
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0434
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0435
*        MYLINCT = MYLINCT - FIVE;                         /*@0001VLS*/
         L     @06,MYLINCT                                         0436
         SL    @06,@CF00036                                        0436
         ST    @06,MYLINCT                                         0436
*      END;                                                /*@0001VLS*/
*    IF MYLINCT < THREE THEN              /* EJECT TO NEW PAGE IF    */
@RF00423 L     @06,MYLINCT                                         0438
         C     @06,@CF00038                                        0438
         BNL   @RF00438                                            0438
*      DO;                                /* REST OF REPORT WONT FIT */
*        CALL PAGEJECT;                                    /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0440
*        MSGADDR(40:39+LENGTH(CUASH1)) = CUASH1;           /*@0001VLS*/
         MVC   MSGADDR+39(44),CUASH1                               0441
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0442
*        MSGADDR(40:39+LENGTH(CUASH2)) = CUASH2;           /*@0001VLS*/
         MVC   MSGADDR+39(44),CUASH2                               0443
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0444
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@0001VLS*/
         MVC   MSGADDR+29(61),CUASH3                               0445
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0446
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0447
*        MSGADDR = CUASH4;                                 /*@0001VLS*/
         MVI   MSGADDR+130,C' '                                    0448
         MVI   MSGADDR+131,C' '                                    0448
         MVC   MSGADDR(130),CUASH4                                 0448
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0449
*        MSGADDR = CUASH5;                                 /*@0001VLS*/
         MVI   MSGADDR+129,C' '                                    0450
         MVC   MSGADDR+130(2),MSGADDR+129                          0450
         MVC   MSGADDR(129),CUASH5                                 0450
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0451
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         0452
*        MYLINCT = MYLINCT - SEVEN;                        /*@0001VLS*/
         L     @06,MYLINCT                                         0453
         SL    @06,@CF00082                                        0453
         ST    @06,MYLINCT                                         0453
*      END;                                                /*@0001VLS*/
*        CALL CONVERT (OCUA2,TEMPAREA,TWO); /* PRIMARY CUA   @0001VLS*/
@RF00438 MVC   @AL00001+4(8),@AL00455                              0455
         LA    @06,OCUA2(,R7)                                      0455
         ST    @06,@AL00001                                        0455
         LA    @01,@AL00001                                        0455
         BAL   @14,CONVERT                                         0455
*        OUTCUA = TEMPAREA(2:4);                           /*@0001VLS*/
         MVC   OUTCUA(3),TEMPAREA+1                                0456
*        IF SNSCNT <= 9 × OSER74XX = HEXZEROS THEN                 0457
         CLC   SNSCNT(2,R7),@CH00085                               0457
         BNH   @RT00457                                            0457
         CLC   OSER74XX(2,R7),@CB00208                             0457
         BNE   @RF00457                                            0457
@RT00457 DS    0H                                                  0458
*          TUSER = NA;                                     /*@0001VLS*/
         MVC   TUSER(5),@CC00495                                   0458
*        ELSE                                                      0459
*          CALL CONVBIN2(OSER74XX,TUSER); /* TAPE UNIT SERIAL NUMBER */
         B     @RC00457                                            0459
@RF00457 LA    @06,OSER74XX(,R7)                                   0459
         ST    @06,@AL00001                                        0459
         LA    @06,TUSER                                           0459
         ST    @06,@AL00001+4                                      0459
         LA    @01,@AL00001                                        0459
         BAL   @14,CONVBIN2                                        0459
*        CALL CONVERT (DATE(2:4),TEMPAREA,SIX);            /*@0001VLS*/
@RC00457 MVC   @AL00001+4(8),@AL00460                              0460
         LA    @06,DATE+1(,R7)                                     0460
         ST    @06,@AL00001                                        0460
         LA    @01,@AL00001                                        0460
         BAL   @14,CONVERT                                         0460
*        DAY = TEMPAREA(3:5);                              /*@0001VLS*/
         MVC   DAY(3),TEMPAREA+2                                   0461
*        YEAR = TEMPAREA(1:2);                             /*@0001VLS*/
         MVC   YEAR(2),TEMPAREA                                    0462
*        OVOLUME = VOLID;           /* VOLUME                @0001VLS*/
         MVC   OVOLUME(6),VOLID(R7)                                0463
*        CALL CONVERT (TIME,TEMPAREA,EIGHT);               /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00464                              0464
         LA    @06,TIME(,R7)                                       0464
         ST    @06,@AL00001                                        0464
         LA    @01,@AL00001                                        0464
         BAL   @14,CONVERT                                         0464
*        HH = TEMPAREA(1:2);                               /*@0001VLS*/
         MVC   HH(2),TEMPAREA                                      0465
*        MM = TEMPAREA(3:4);                               /*@0001VLS*/
         MVC   MM(2),TEMPAREA+2                                    0466
*        SS = TEMPAREA(5:6);                               /*@0001VLS*/
         MVC   SS(2),TEMPAREA+4                                    0467
*        POINT = PERIOD;                                   /*@0001VLS*/
         MVI   POINT,C'.'                                          0468
*        TH = TEMPAREA(7:8);                               /*@0001VLS*/
         MVC   TH(2),TEMPAREA+6                                    0469
*        CALL CONVBIN1(READTH,OREADS);   /* TEMP. READ ERRORS @0001VLS*
         LA    @06,READTH(,R7)                                     0470
         ST    @06,@AL00001                                        0470
         LA    @06,OREADS                                          0470
         ST    @06,@AL00001+4                                      0470
         LA    @01,@AL00001                                        0470
         BAL   @14,CONVBIN1                                        0470
*        CALL CONVBIN1(RITETH,WRTS); /* TEMPORARY WRITE ERRORS       */
         LA    @06,RITETH(,R7)                                     0471
         ST    @06,@AL00001                                        0471
         LA    @06,WRTS                                            0471
         ST    @06,@AL00001+4                                      0471
         LA    @01,@AL00001                                        0471
         BAL   @14,CONVBIN1                                        0471
*        CALL CONVBIN2(RECSIOS,SIOCNT); /* SIO COUNT         @0001VLS*/
         LA    @06,RECSIOS(,R7)                                    0472
         ST    @06,@AL00001                                        0472
         LA    @06,SIOCNT                                          0472
         ST    @06,@AL00001+4                                      0472
         LA    @01,@AL00001                                        0472
         BAL   @14,CONVBIN2                                        0472
*        NRZIN = NA;                /* ONLY VALID FOR 800 BPI        */
         MVC   NRZIN(5),@CC00495                                   0473
*        IF OSER74XX = HEXZEROS THEN                               0474
         CLC   OSER74XX(2,R7),@CB00208                             0474
         BNE   @RF00474                                            0474
*        DENSITY = NA;              /* NO DENSITY            @0001VLS*/
         MVC   DENSITY(4),@CC00495                                 0475
*      ELSE                                                        0476
*        IF SENSBIT5(4) = ON  THEN                                 0476
         B     @RC00474                                            0476
@RF00474 TM    SENSBIT5+3(R7),B'00000100'                          0476
         BNO   @RF00476                                            0476
*        DENSITY = BPI1600;                                /*@0001VLS*/
         MVC   DENSITY(4),@CC00491                                 0477
*      ELSE                                                        0478
*        IF SENSBIT4(7) = ON THEN   /* BIRCH DEVICE          @0001VLS*/
         B     @RC00476                                            0478
@RF00476 TM    SENSBIT4+6(R7),B'00001000'                          0478
         BNO   @RF00478                                            0478
*          DENSITY = BPI6250;                              /*@0001VLS*/
         MVC   DENSITY(4),@CC00493                                 0479
*        ELSE                                                      0480
*          DO;                                             /*@0001VLS*/
         B     @RC00478                                            0480
@RF00478 DS    0H                                                  0481
*            DENSITY = BPI800;                             /*@0001VLS*/
         MVC   DENSITY(4),@CC00489                                 0481
*            CALL CONVBIN1(NOISE,NRZIN);   /* CONVERT NRZI NOISE     */
         LA    @06,NOISE(,R7)                                      0482
         ST    @06,@AL00001                                        0482
         LA    @06,NRZIN                                           0482
         ST    @06,@AL00001+4                                      0482
         LA    @01,@AL00001                                        0482
         BAL   @14,CONVBIN1                                        0482
*          END;                                            /*@0001VLS*/
*    CALL CONVBIN1(RWVRC,ORWVRC);                          /*@0001VLS*/
@RC00478 DS    0H                                                  0484
@RC00476 DS    0H                                                  0484
@RC00474 LA    @06,RWVRC(,R7)                                      0484
         ST    @06,@AL00001                                        0484
         LA    @06,ORWVRC                                          0484
         ST    @06,@AL00001+4                                      0484
         LA    @01,@AL00001                                        0484
         BAL   @14,CONVBIN1                                        0484
*    IF SNSCNT <= 9 THEN                                           0485
         CLC   SNSCNT(2,R7),@CH00085                               0485
         BH    @RF00485                                            0485
*      DO;                                                 /*@0001VLS*/
*        WRTGVRC = NA;                                     /*@0001VLS*/
         MVC   WRTGVRC(5),@CC00495                                 0487
*        ERLYBOR = NA;                                     /*@0001VLS*/
         MVC   ERLYBOR(5),@CC00495                                 0488
*        OVELCHG = NA;                                     /*@0001VLS*/
         MVC   OVELCHG(5),@CC00495                                 0489
*      END;                                                /*@0001VLS*/
*    ELSE                                                          0491
*      DO;                                                 /*@0001VLS*/
         B     @RC00485                                            0491
@RF00485 DS    0H                                                  0492
*        I = CCOMVRC & ZEROFOX;           /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0492
         SLR   @15,@15                                             0492
         IC    @15,CCOMVRC(,R7)                                    0492
         NR    @06,@15                                             0492
         STH   @06,I                                               0492
*        CALL CONVBIN2(I,WRTGVRC);                         /*@0001VLS*/
         LA    @01,@AL00493                                        0493
         BAL   @14,CONVBIN2                                        0493
*        I = EXPEARL & ZEROFOX;           /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0494
         SLR   @15,@15                                             0494
         IC    @15,EXPEARL(,R7)                                    0494
         NR    @06,@15                                             0494
         STH   @06,I                                               0494
*        CALL CONVBIN2 (I,ERLYBOR);                        /*@0001VLS*/
         LA    @01,@AL00495                                        0495
         BAL   @14,CONVBIN2                                        0495
*        I = RECVEL & ZEROFOX;            /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0496
         SLR   @15,@15                                             0496
         IC    @15,RECVEL(,R7)                                     0496
         NR    @06,@15                                             0496
         STH   @06,I                                               0496
*        CALL CONVBIN2 (I,OVELCHG);                        /*@0001VLS*/
         LA    @01,@AL00497                                        0497
         BAL   @14,CONVBIN2                                        0497
*      END;                                                /*@0001VLS*/
*    CALL CONVBIN1 (MTELRCR,LRCMTE);                       /*@0001VLS*/
@RC00485 LA    @06,MTELRCR(,R7)                                    0499
         ST    @06,@AL00001                                        0499
         LA    @06,LRCMTE                                          0499
         ST    @06,@AL00001+4                                      0499
         LA    @01,@AL00001                                        0499
         BAL   @14,CONVBIN1                                        0499
*    CALL CONVBIN1 (EDCCRC,CRCEDC);                        /*@0001VLS*/
         LA    @06,EDCCRC(,R7)                                     0500
         ST    @06,@AL00001                                        0500
         LA    @06,CRCEDC                                          0500
         ST    @06,@AL00001+4                                      0500
         LA    @01,@AL00001                                        0500
         BAL   @14,CONVBIN1                                        0500
*    CALL CONVBIN1 (RECVRC,ECCENV);                        /*@0001VLS*/
         LA    @06,RECVRC(,R7)                                     0501
         ST    @06,@AL00001                                        0501
         LA    @06,ECCENV                                          0501
         ST    @06,@AL00001+4                                      0501
         LA    @01,@AL00001                                        0501
         BAL   @14,CONVBIN1                                        0501
*    I = RECOVER & ZEROFOX;               /* RIGHT HALF OF THE FIELD */
         LA    @06,15                                              0502
         SLR   @15,@15                                             0502
         IC    @15,RECOVER(,R7)                                    0502
         NR    @06,@15                                             0502
         STH   @06,I                                               0502
*    CALL CONVBIN2 (I,SKEWERR);                            /*@0001VLS*/
         LA    @01,@AL00503                                        0503
         BAL   @14,CONVBIN2                                        0503
*    CALL CONVERT (CPUMOD,MCPU,TWO);                       /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00504                              0504
         LA    @06,CPUMOD(,R7)                                     0504
         ST    @06,@AL00001                                        0504
         LA    @01,@AL00001                                        0504
         BAL   @14,CONVERT                                         0504
*    CALL CONVERT (CPUSER,SERCPU,THREE);                   /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00505                              0505
         LA    @06,CPUSER(,R7)                                     0505
         ST    @06,@AL00001                                        0505
         LA    @01,@AL00001                                        0505
         BAL   @14,CONVERT                                         0505
*    IF HDRSER = HEXZEROS THEN                                     0506
         CLC   HDRSER(2,R7),@CB00208                               0506
         BNE   @RF00506                                            0506
*      HEADSER = NA;                                       /*@0001VLS*/
         MVC   HEADSER(5),@CC00495                                 0507
*    ELSE                                                          0508
*      CALL CONVBIN2 (HDRSER,HEADSER);                     /*@0001VLS*/
         B     @RC00506                                            0508
@RF00506 LA    @06,HDRSER(,R7)                                     0508
         ST    @06,@AL00001                                        0508
         LA    @06,HEADSER                                         0508
         ST    @06,@AL00001+4                                      0508
         LA    @01,@AL00001                                        0508
         BAL   @14,CONVBIN2                                        0508
*    CALL PRINTIT;                                         /*@0001VLS*/
@RC00506 BAL   @14,PRINTIT                                         0509
*    MYLINCT = MYLINCT - ONE;                              /*@0001VLS*/
         L     @06,MYLINCT                                         0510
         BCTR  @06,0                                               0510
         ST    @06,MYLINCT                                         0510
* END;                                                     /*@0001VLS*/
@EL00009 DS    0H                                                  0511
@EF00009 DS    0H                                                  0511
@ER00009 LM    @14,@12,@SA00009                                    0511
         BR    @14                                                 0511
*/********************************************************************/
*/*             8809DEV - CUA STATISTICS                     @000@SSG*/
*/* OUTPUT THE DISMOUNT SECTION OF THE REPORT.  IF THE       @D3503SG*/
*/* HEADERS HAVE NOT BEEN PRINTED, THEN PRINT THE HEADERS    @D3503SG*/
*/* FOR SECTION ONE.                                         @D3503SG*/
*/********************************************************************/
* SFSTATS:  PROC;                                          /*@D3503SG*/
SFSTATS  STM   @14,@12,@SA00010                                    0512
*    IF HEAD1 = OFF THEN            /* PRINT HEADERS         @D3503SG*/
         TM    HEAD1,B'00010000'                                   0513
         BNZ   @RF00513                                            0513
*      DO;                                                 /*@D3503SG*/
*        CALL OUTHED12;             /*8809DEV LABELS 1/2     @D3503SG*/
         BAL   @14,OUTHED12                                        0515
*        CUASH3R = RDTHRSH;         /* READ THRESHOLD        @D3503SG*/
         MVC   CUASH3R(3),RDTHRSH(R2)                              0516
*        CUASH3W = WRTHRSH;         /* WRITE THRESHOLD       @D3503SG*/
         MVC   CUASH3W(3),WRTHRSH(R2)                              0517
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@D3503SG*/
         MVC   MSGADDR+29(61),CUASH3                               0518
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0519
*        CALL PRINTIT;              /* BLANK LINE            @D3503SG*/
         BAL   @14,PRINTIT                                         0520
*        MSGADDR = CUASH10;                                /*@D3503SG*/
         MVI   MSGADDR+101,C' '                                    0521
         MVC   MSGADDR+102(30),MSGADDR+101                         0521
         MVC   MSGADDR(101),CUASH10                                0521
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0522
*        MSGADDR = CUASH11;                                /*@D3503SG*/
         MVI   MSGADDR+108,C' '                                    0523
         MVC   MSGADDR+109(23),MSGADDR+108                         0523
         MVC   MSGADDR(108),CUASH11                                0523
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0524
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0525
*        MYLINCT = MYLINCT - FIVE;                         /*@D3503SG*/
         L     @06,MYLINCT                                         0526
         SL    @06,@CF00036                                        0526
         ST    @06,MYLINCT                                         0526
*      END;         /*IF HEAD1 = OFF                         @D3503SG*/
*    IF MYLINCT < THREE THEN              /* EJECT TO NEW PAGE IF    */
@RF00513 L     @06,MYLINCT                                         0528
         C     @06,@CF00038                                        0528
         BNL   @RF00528                                            0528
*      DO;                                /* REST OF REPORT WONT FIT */
*        CALL PAGEJECT;                                    /*@D3503SG*/
         BAL   @14,PAGEJECT                                        0530
*        MSGADDR(40:39+LENGTH(CUASH1)) = CUASH1;           /*@D3503SG*/
         MVC   MSGADDR+39(44),CUASH1                               0531
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0532
*        MSGADDR(40:39+LENGTH(CUASH2)) = CUASH2;           /*@D3503SG*/
         MVC   MSGADDR+39(44),CUASH2                               0533
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0534
*        MSGADDR(30:29+LENGTH(CUASH3)) = CUASH3;           /*@D3503SG*/
         MVC   MSGADDR+29(61),CUASH3                               0535
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0536
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0537
*        MSGADDR = CUASH10;                                /*@D3503SG*/
         MVI   MSGADDR+101,C' '                                    0538
         MVC   MSGADDR+102(30),MSGADDR+101                         0538
         MVC   MSGADDR(101),CUASH10                                0538
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0539
*        MSGADDR = CUASH11;                                /*@D3503SG*/
         MVI   MSGADDR+108,C' '                                    0540
         MVC   MSGADDR+109(23),MSGADDR+108                         0540
         MVC   MSGADDR(108),CUASH11                                0540
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0541
*        CALL PRINTIT;                                     /*@D3503SG*/
         BAL   @14,PRINTIT                                         0542
*        MYLINCT = MYLINCT - SEVEN;                        /*@D3503SG*/
         L     @06,MYLINCT                                         0543
         SL    @06,@CF00082                                        0543
         ST    @06,MYLINCT                                         0543
*      END;           /*IF MYLINCT < THREE                   @D3503SG*/
*      CALL CONVERT(SMCUA,TEMPAREA,2);   /*                  @D3503SG*/
@RF00528 MVC   @AL00001+4(8),@AL00545                              0545
         LA    @06,SMCUA(,R7)                                      0545
         ST    @06,@AL00001                                        0545
         LA    @01,@AL00001                                        0545
         BAL   @14,CONVERT                                         0545
*      SCCUA=TEMPAREA(2:4);              /*1 PHYSICAL CUA    @D3503SG*/
         MVI   SCCUA+3,C' '                                        0546
         MVC   SCCUA(3),TEMPAREA+1                                 0546
*      CALL CONVERT(SMDATE(2:4),TEMPAREA,6);    /*           @D3503SG*/
         MVC   @AL00001+4(8),@AL00547                              0547
         LA    @06,SMDATE+1(,R7)                                   0547
         ST    @06,@AL00001                                        0547
         LA    @01,@AL00001                                        0547
         BAL   @14,CONVERT                                         0547
*      SCDAY=TEMPAREA(3:5);              /*2A DATE-DAY       @D3503SG*/
         MVC   SCDAY(3),TEMPAREA+2                                 0548
*      SCYEAR=TEMPAREA(1:2);             /*2B DATE-YEAR      @D3503SG*/
         MVC   SCYEAR(2),TEMPAREA                                  0549
*      SCSER=SMVOLID;                    /*3 VOL.SER.        @D3503SG*/
         MVC   SCSER(6),SMVOLID(R7)                                0550
*      CALL CONVERT(TIME,TEMPAREA,8);    /*                  @D3503SG*/
         MVC   @AL00001+4(8),@AL00551                              0551
         LA    @06,TIME(,R7)                                       0551
         ST    @06,@AL00001                                        0551
         LA    @01,@AL00001                                        0551
         BAL   @14,CONVERT                                         0551
*      SCHH=TEMPAREA(1:2);               /*4A TIME-HOUR      @D3503SG*/
         MVC   SCHH(2),TEMPAREA                                    0552
*      SCMM=TEMPAREA(3:4);               /*4B TIME-MINUTE    @D3503SG*/
         MVC   SCMM(2),TEMPAREA+2                                  0553
*      SCSS=TEMPAREA(5:6);               /*4C TIME-SECOND    @D3503SG*/
         MVC   SCSS(2),TEMPAREA+4                                  0554
*      SCPOINT=PERIOD;                   /*DECIMAL POINT     @D3503SG*/
         MVI   SCPOINT,C'.'                                        0555
*      SCTH=TEMPAREA(7:8);               /*4D TIME-TENTHS    @D3503SG*/
         MVC   SCTH(2),TEMPAREA+6                                  0556
*      CALL CONVERT(SMCPSER,SCCPSER,THREE); /*19 SERIAL #    @D3503SG*/
         MVC   @AL00001+4(8),@AL00557                              0557
         LA    @06,SMCPSER(,R7)                                    0557
         ST    @06,@AL00001                                        0557
         LA    @01,@AL00001                                        0557
         BAL   @14,CONVERT                                         0557
*      CALL CONVERT(SMCPMDL,SCCPMDL,TWO);   /*18 MODEL #     @D3503SG*/
         MVC   @AL00001+4(8),@AL00558                              0558
         LA    @06,SMCPMDL(,R7)                                    0558
         ST    @06,@AL00001                                        0558
         LA    @01,@AL00001                                        0558
         BAL   @14,CONVERT                                         0558
*      CALL CONVBIN1(SMVEL,SCVEL);       /*17 VELOCITY CHK.  @D3503SG*/
         LA    @06,SMVEL(,R7)                                      0559
         ST    @06,@AL00001                                        0559
         LA    @06,SCVEL                                           0559
         ST    @06,@AL00001+4                                      0559
         LA    @01,@AL00001                                        0559
         BAL   @14,CONVBIN1                                        0559
*      CALL CONVBIN1(SMSKEW,SCSKEW);     /*16 SKEW ERROR     @D3503SG*/
         LA    @06,SMSKEW(,R7)                                     0560
         ST    @06,@AL00001                                        0560
         LA    @06,SCSKEW                                          0560
         ST    @06,@AL00001+4                                      0560
         LA    @01,@AL00001                                        0560
         BAL   @14,CONVBIN1                                        0560
*      CALL CONVBIN1(SMCRE,SCCRE);       /*15 CREASE ERROR.  @D3503SG*/
         LA    @06,SMCRE(,R7)                                      0561
         ST    @06,@AL00001                                        0561
         LA    @06,SCCRE                                           0561
         ST    @06,@AL00001+4                                      0561
         LA    @01,@AL00001                                        0561
         BAL   @14,CONVBIN1                                        0561
*      CALL CONVBIN1(SMNOP,SCNOP);       /*14 NO POINTER ER. @D3503SG*/
         LA    @06,SMNOP(,R7)                                      0562
         ST    @06,@AL00001                                        0562
         LA    @06,SCNOP                                           0562
         ST    @06,@AL00001+4                                      0562
         LA    @01,@AL00001                                        0562
         BAL   @14,CONVBIN1                                        0562
*      CALL CONVBIN1(SMENV,SCENV);       /*13 ENVELOPE CHK.  @D3503SG*/
         LA    @06,SMENV(,R7)                                      0563
         ST    @06,@AL00001                                        0563
         LA    @06,SCENV                                           0563
         ST    @06,@AL00001+4                                      0563
         LA    @01,@AL00001                                        0563
         BAL   @14,CONVBIN1                                        0563
*      CALL CONVBIN1(SMRBF,SCRBF);       /*12 READ BACK FAIL @D3503SG*/
         LA    @06,SMRBF(,R7)                                      0564
         ST    @06,@AL00001                                        0564
         LA    @06,SCRBF                                           0564
         ST    @06,@AL00001+4                                      0564
         LA    @01,@AL00001                                        0564
         BAL   @14,CONVBIN1                                        0564
*      CALL CONVBIN1(SMSRC,SCSRC);       /*11 START READ CHK.@D3503SG*/
         LA    @06,SMSRC(,R7)                                      0565
         ST    @06,@AL00001                                        0565
         LA    @06,SCSRC                                           0565
         ST    @06,@AL00001+4                                      0565
         LA    @01,@AL00001                                        0565
         BAL   @14,CONVBIN1                                        0565
*      CALL CONVBIN1(SMEDC,SCEDC);       /*10 END DATA CHK.  @D3503SG*/
         LA    @06,SMEDC(,R7)                                      0566
         ST    @06,@AL00001                                        0566
         LA    @06,SCEDC                                           0566
         ST    @06,@AL00001+4                                      0566
         LA    @01,@AL00001                                        0566
         BAL   @14,CONVBIN1                                        0566
*      CALL CONVBIN1(SMMUTE,SCMTE);      /*9 MULTI-TRK.ERS.  @D3503SG*/
         LA    @06,SMMUTE(,R7)                                     0567
         ST    @06,@AL00001                                        0567
         LA    @06,SCMTE                                           0567
         ST    @06,@AL00001+4                                      0567
         LA    @01,@AL00001                                        0567
         BAL   @14,CONVBIN1                                        0567
*      CALL CONVBIN2(SMWTSIO,SCWTSIO);   /*8 SIO WRITE       @D3503SG*/
         LA    @06,SMWTSIO(,R7)                                    0568
         ST    @06,@AL00001                                        0568
         LA    @06,SCWTSIO                                         0568
         ST    @06,@AL00001+4                                      0568
         LA    @01,@AL00001                                        0568
         BAL   @14,CONVBIN2                                        0568
*      CALL CONVBIN2(SMRDSIO,SCRDSIO);   /*7 SIO READ        @D3503SG*/
         LA    @06,SMRDSIO(,R7)                                    0569
         ST    @06,@AL00001                                        0569
         LA    @06,SCRDSIO                                         0569
         ST    @06,@AL00001+4                                      0569
         LA    @01,@AL00001                                        0569
         BAL   @14,CONVBIN2                                        0569
*      CALL CONVBIN1(SMTWRT,SCWRTS);     /*6 TEMP.WRITE ERS. @D3503SG*/
         LA    @06,SMTWRT(,R7)                                     0570
         ST    @06,@AL00001                                        0570
         LA    @06,SCWRTS                                          0570
         ST    @06,@AL00001+4                                      0570
         LA    @01,@AL00001                                        0570
         BAL   @14,CONVBIN1                                        0570
*      CALL CONVBIN1(SMTRD,SCRDS);       /*5 TEMP.READ ERS.  @D3503SG*/
         LA    @06,SMTRD(,R7)                                      0571
         ST    @06,@AL00001                                        0571
         LA    @06,SCRDS                                           0571
         ST    @06,@AL00001+4                                      0571
         LA    @01,@AL00001                                        0571
         BAL   @14,CONVBIN1                                        0571
*      CALL PRINTIT;                     /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         0572
*      MYLINCT = MYLINCT - 1;            /*                  @D3503SG*/
         L     @06,MYLINCT                                         0573
         BCTR  @06,0                                               0573
         ST    @06,MYLINCT                                         0573
*   END SFSTATS;     /*8809DEV CUA STATISTICS.PROCESSING     @D3503SG*/
@EL00010 DS    0H                                                  0574
@EF00010 DS    0H                                                  0574
@ER00010 LM    @14,@12,@SA00010                                    0574
         BR    @14                                                 0574
*FINDDATE: PROC;                                           /*@0001VLS*/
FINDDATE STM   @14,@12,@SA00011                                    0575
*   FOUND = OFF;                                           /*@0001VLS*/
         NI    FOUND,B'11011111'                                   0576
*   CHAIN = CHAIN && CHAIN;                                /*@0001VLS*/
         XC    CHAIN(6),CHAIN                                      0577
*   CHAINCPU = RECCPU;             /* CPU SERIAL NUMBER      @0001VLS*/
         MVC   CHAINCPU(3),RECCPU                                  0578
*   CHAINCUX = RECCUA;                                     /*@0001VLS*/
         MVC   CHAINCUX(2),RECCUA                                  0579
*   CALL CONVCNTR;                     /*CONVERT CUA TO CONTROL LEVEL *
         BAL   @14,CONVCNTR                                        0580
*   CHAINCUX=LOWCUA;                   /*SAVE CONVERTED VALUE         *
         MVC   CHAINCUX(2),LOWCUA                                  0581
*   CHAINDEV = RECDEV;                     /*DEVICE REQ'ST   @D3503SG*/
         MVC   CHAINDEV(1),RECDEV                                  0582
*   DATEPTR = LHDATPTR;            /* INITIALIZE FOR SEARCH  @0001VLS*/
         L     @06,LHDATPTR                                        0583
         ST    @06,DATEPTR                                         0583
*   DO WHILE(DATEPTR ^= ZERO & FOUND = OFF);               /*@0001VLS*/
         B     @DE00584                                            0584
@DL00584 DS    0H                                                  0585
*     IF CHAIN = DATECC THEN                                       0585
         L     @06,DATEPTR                                         0585
         CLC   CHAIN(6),DATECC(@06)                                0585
         BNE   @RF00585                                            0585
*       FOUND = ON;                /* FOUND THE APPROPRIATE SET      */
         OI    FOUND,B'00100000'                                   0586
*     ELSE                                                         0587
*       DO;                                                /*@0001VLS*/
         B     @RC00585                                            0587
@RF00585 DS    0H                                                  0588
*         Z = DATEPTR;             /* SAVE THIS VALUE        @0001VLS*/
         L     @06,DATEPTR                                         0588
         ST    @06,Z                                               0588
*         DATEPTR = NEXTDATE;      /* NEXT ENTRY             @0001VLS*/
         L     @06,NEXTDATE(,@06)                                  0589
         ST    @06,DATEPTR                                         0589
*       END;     /*CHAIN ^= DATECC                           @0001VLS*/
*   END;         /*DO WHILE DATEPTR ^= ZERO & FOUND = OFF    @0001VLS*/
@RC00585 DS    0H                                                  0591
@DE00584 L     @06,DATEPTR                                         0591
         LTR   @06,@06                                             0591
         BZ    @DC00584                                            0591
         TM    FOUND,B'00100000'                                   0591
         BZ    @DL00584                                            0591
@DC00584 DS    0H                                                  0592
*   IF DATEPTR = ZERO THEN                                         0592
         L     @06,DATEPTR                                         0592
         LTR   @06,@06                                             0592
         BNZ   @RF00592                                            0592
*     DO;                          /* GENERATE A NEW SET OF ENTRIES  */
*       RESPECIFY (R0,R15) RESTRICTED;                     /*@0001VLS*/
*       R0 = LENGTH(DATEAREA);                             /*@0001VLS*/
         LA    R0,16                                               0595
*       GEN(GETMAIN EC,LV=(0),A=DATEPTR);                  /*@0001VLS*/
         GETMAIN EC,LV=(0),A=DATEPTR
*       RETCODE = R15;                                     /*@0001VLS*/
         ST    R15,RETCODE                                         0597
*       RESPECIFY (R0,R15) UNRESTRICTED;                   /*@0001VLS*/
*       IF RETCODE = ZERO THEN                                     0599
         L     @06,RETCODE                                         0599
         SLR   @15,@15                                             0599
         CR    @06,@15                                             0599
         BNE   @RF00599                                            0599
*         DO;                                              /*@0001VLS*/
*           NEXTDATE = ZERO;       /* CLEAR NEXT AREA POINTER        */
         L     @06,DATEPTR                                         0601
         ST    @15,NEXTDATE(,@06)                                  0601
*           LOWDATE = DATE(2:4);                           /*@0001VLS*/
         MVC   LOWDATE(3,@06),DATE+1(R7)                           0602
*           HIDATE = DATE(2:4);                            /*@0001VLS*/
         MVC   HIDATE(3,@06),DATE+1(R7)                            0603
*           DATECC = CHAIN;                                /*@0001VLS*/
         MVC   DATECC(6,@06),CHAIN                                 0604
*           IF LHDATPTR = ZERO THEN                                0605
         C     @15,LHDATPTR                                        0605
         BNE   @RF00605                                            0605
*             LHDATPTR = DATEPTR;  /* POINT TO FIRST ENTRY   @0001VLS*/
         ST    @06,LHDATPTR                                        0606
*           ELSE                                                   0607
*             Z -> NEXTDATE = DATEPTR;                     /*@0001VLS*/
         B     @RC00605                                            0607
@RF00605 L     @06,DATEPTR                                         0607
         L     @01,Z                                               0607
         ST    @06,NEXTDATE(,@01)                                  0607
*         END;                                             /*@0001VLS*/
@RC00605 DS    0H                                                  0609
*     END;                                                 /*@0001VLS*/
@RF00599 DS    0H                                                  0610
*   IF HVOLDATE > DATE(2:4) THEN                                   0610
@RF00592 CLC   HVOLDATE(3),DATE+1(R7)                              0610
         BNH   @RF00610                                            0610
*     HVOLDATE = DATE(2:4);        /* HIGH VOLUME DATE       @0001VLS*/
         MVC   HVOLDATE(3),DATE+1(R7)                              0611
*   IF LVOLDATE < DATE(2:4) THEN                                   0612
@RF00610 CLC   LVOLDATE(3),DATE+1(R7)                              0612
         BNL   @RF00612                                            0612
*     LVOLDATE = DATE(2:4);        /* LOW VOLUME DATE        @0001VLS*/
         MVC   LVOLDATE(3),DATE+1(R7)                              0613
* END;                                                     /*@0001VLS*/
@EL00011 DS    0H                                                  0614
@EF00011 DS    0H                                                  0614
@ER00011 LM    @14,@12,@SA00011                                    0614
         BR    @14                                                 0614
*OUTTYPES: PROC;                   /* SORT BREAK PROCESSING  @0001VLS*/
OUTTYPES STM   @14,@12,@SA00012                                    0615
* IF HEAD3 = OFF THEN                                              0616
         TM    HEAD3,B'00000100'                                   0616
         BNZ   @RF00616                                            0616
*   DO;                                                    /*@0001VLS*/
*     IF HEAD2 = ON THEN                                           0618
         TM    HEAD2,B'00001000'                                   0618
         BNO   @RF00618                                            0618
*       CALL OUTCODES;             /* THE ERROR CODES        @0001VLS*/
         BAL   @14,OUTCODES                                        0619
*     MSGADDR = SPACER;            /* SPACER LINE            @0001VLS*/
@RF00618 MVC   MSGADDR(132),SPACER                                 0620
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0621
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0622
*     MYLINCT = MYLINCT - TWO;                             /*@0001VLS*/
         LA    @06,2                                               0623
         L     @15,MYLINCT                                         0623
         SLR   @15,@06                                             0623
         ST    @15,MYLINCT                                         0623
*     IF MYLINCT < TWO THEN        /* BOTH LINES WILL NOT FIT ON PAGE*/
         CR    @15,@06                                             0624
         BNL   @RF00624                                            0624
*       CALL PAGEJECT;                                     /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0625
*     MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;              /*@0001VLS*/
@RF00624 MVC   MSGADDR+39(48),CUATH1                               0626
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0627
*     MSGADDR(20:19+LENGTH(NOTOTALS)) = NOTOTALS;          /*@0001VLS*/
         MVC   MSGADDR+19(32),NOTOTALS                             0628
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0629
*   END;                                                   /*@0001VLS*/
* HEAD1 = OFF;                                             /*@0001VLS*/
@RF00616 DS    0H                                                  0632
* HEAD2 = OFF;                                             /*@0001VLS*/
* HEAD3 = OFF;                                             /*@0001VLS*/
         NI    HEAD1,B'11100011'                                   0633
* IF EOTABLE ^= 'FFFF'X THEN                                       0634
         L     @06,CURRPTR                                         0634
         CLC   EOTABLE(2,@06),@CB00261                             0634
         BE    @RF00634                                            0634
*   OLDCPUCU = SORTCPUC;                                   /*@0001VLS*/
         MVC   OLDCPUCU(6),SORTCPUC(@06)                           0635
* END;                                                     /*@0001VLS*/
@EL00012 DS    0H                                                  0636
@EF00012 DS    0H                                                  0636
@ER00012 LM    @14,@12,@SA00012                                    0636
         BR    @14                                                 0636
*/*                                                          @0001VLS*/
*/* OUTPUT THE TEMPORARY ERROR SUMMARY.  ONLY PRODUCE A LINE FOR EACH*/
*/* CUA FOR WHICH THERE WERE ANY SIOS.                       @0001VLS*/
*/*                                                          @0001VLS*/
*TEMPSUM:  PROC;                                           /*@0001VLS*/
TEMPSUM  STM   @14,@12,@SA00013                                    0637
*   SYSSIOS = ZERO;                                        /*@0001VLS*/
         SLR   @06,@06                                             0638
         ST    @06,SYSSIOS                                         0638
*   SYSRDS = ZERO;                                         /*@0001VLS*/
         ST    @06,SYSRDS                                          0639
*   SYSRTS = ZERO;                                         /*@0001VLS*/
         ST    @06,SYSRTS                                          0640
*   SYSMNTS = ZERO;                                        /*@0001VLS*/
         ST    @06,SYSMNTS                                         0641
*   RECCPU = CPU;                      /* INITIALIZE FOR THE SEARCH  */
         L     @06,CURRPTR                                         0642
         MVC   RECCPU(3),CPU(@06)                                  0642
*   RECCUA = CONTRCUA;                 /* OF THE DATE RANGE  @0001VLS*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0643
*   RECDEV = DEVTYPE;                  /* DEVICE REQS'TD.    @D3503SG*/
         MVC   RECDEV(1),DEVTYPE(@06)                              0644
*   IF HEAD1 = OFF THEN                                            0645
         TM    HEAD1,B'00010000'                                   0645
         BNZ   @RF00645                                            0645
*     CALL NOHEAD1;                    /* OUTPUT NO PART 1 MESSAGE   */
         BAL   @14,NOHEAD1                                         0646
*   IF HEAD2 = OFF THEN                                            0647
@RF00645 TM    HEAD2,B'00001000'                                   0647
         BNZ   @RF00647                                            0647
*     CALL NOHEAD2;                    /* OUTPUT NO PART2 MESSAGE    */
         BAL   @14,NOHEAD2                                         0648
*   ELSE                                                           0649
*     CALL OUTCODES;                   /* OUTPUT ERROR CODES @0001VLS*/
         B     @RC00647                                            0649
@RF00647 BAL   @14,OUTCODES                                        0649
*   MSGADDR = SPACER;                                      /*@0001VLS*/
@RC00647 MVC   MSGADDR(132),SPACER                                 0650
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0651
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0652
*   MYLINCT = MYLINCT - TWO;                               /*@0001VLS*/
         L     @06,MYLINCT                                         0653
         BCTR  @06,0                                               0653
         BCTR  @06,0                                               0653
         ST    @06,MYLINCT                                         0653
*   IF MYLINCT < EIGHT THEN            /* PAGE EJECT IF REST OF REPRT*/
         C     @06,@CF00067                                        0654
         BNL   @RF00654                                            0654
*     CALL PAGEJECT;                   /* WILL NOT FIT       @0001VLS*/
         BAL   @14,PAGEJECT                                        0655
*   MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;                /*@0001VLS*/
@RF00654 MVC   MSGADDR+39(48),CUATH1                               0656
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0657
*   MSGADDR(7:6+LENGTH(CUATH2)) = CUATH2;                  /*@0001VLS*/
         MVC   MSGADDR+6(82),CUATH2                                0658
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0659
*   MSGADDR(11:10+LENGTH(CUATH3)) = CUATH3;                /*@0001VLS*/
         MVC   MSGADDR+10(108),CUATH3                              0660
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0661
*   MSGADDR = CUATH4;                                      /*@0001VLS*/
         MVI   MSGADDR+119,C' '                                    0662
         MVC   MSGADDR+120(12),MSGADDR+119                         0662
         MVC   MSGADDR(119),CUATH4                                 0662
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0663
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0664
*   SUMPTR = TABCCHHR(1:4);            /* ADDRESS OF THE COUNTERS    */
         L     @06,CURRPTR                                         0665
         MVC   SUMPTR(4),TABCCHHR(@06)                             0665
*   DO I = 1 TO 16;                                        /*@0001VLS*/
         LA    @06,1                                               0666
         STH   @06,I                                               0666
@DL00666 DS    0H                                                  0667
*     IF SIOS(I) ^= ZERO THEN                                      0667
         MH    @06,@CH00727                                        0667
         L     @01,SUMPTR                                          0667
         AL    @01,@CF01754                                        0667
         L     @06,SIOS-8(@06,@01)                                 0667
         LTR   @06,@06                                             0667
         BZ    @RF00667                                            0667
*       DO;                            /* ANY SIOS           @0001VLS*/
*         IF MYLINCT < THREE THEN      /* NEW PAGE IF REST OF REPORT */
         L     @06,MYLINCT                                         0669
         C     @06,@CF00038                                        0669
         BNL   @RF00669                                            0669
*           DO;                        /* WILL NOT FIT       @0001VLS*/
*             CALL PAGEJECT;                               /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0671
*             MSGADDR(40:30+LENGTH(CUATH1)) = CUATH1;      /*@0001VLS*/
         MVC   MSGADDR+39(39),CUATH1                               0672
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0673
*             MSGADDR(7:6+LENGTH(CUATH2)) = CUATH2;        /*@0001VLS*/
         MVC   MSGADDR+6(82),CUATH2                                0674
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0675
*             MSGADDR(11:10+LENGTH(CUATH3)) = CUATH3;      /*@0001VLS*/
         MVC   MSGADDR+10(108),CUATH3                              0676
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0677
*             MSGADDR = CUATH4;                            /*@0001VLS*/
         MVI   MSGADDR+119,C' '                                    0678
         MVC   MSGADDR+120(12),MSGADDR+119                         0678
         MVC   MSGADDR(119),CUATH4                                 0678
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0679
*             CALL PRINTIT;                                /*@0001VLS*/
         BAL   @14,PRINTIT                                         0680
*             MYLINCT = MYLINCT - FIVE;                    /*@0001VLS*/
         L     @06,MYLINCT                                         0681
         SL    @06,@CF00036                                        0681
         ST    @06,MYLINCT                                         0681
*           END;                                           /*@0001VLS*/
*         TEMPAREA(19:20) = CUX × (I-1);  /* CONVERT THE CUA @0001VLS*/
@RF00669 LH    @06,I                                               0683
         BCTR  @06,0                                               0683
         L     @01,SUMPTR                                          0683
         SLR   @00,@00                                             0683
         ICM   @00,3,CUX(@01)                                      0683
         OR    @06,@00                                             0683
         STCM  @06,3,TEMPAREA+18                                   0683
*         CALL CONVERT(TEMPAREA(19:20),TEMPAREA,TWO);      /*@0001VLS*/
         LA    @01,@AL00684                                        0684
         BAL   @14,CONVERT                                         0684
*         SUMCUA = TEMPAREA(2:4);                          /*@0001VLS*/
         MVC   SUMCUA(3),TEMPAREA+1                                0685
*         CALL CALCPERC(READER(I),SIOS(I),READPERC);       /*@0001VLS*/
         L     @06,SUMPTR                                          0686
         LH    @15,I                                               0686
         MH    @15,@CH00727                                        0686
         LA    @01,0(@15,@06)                                      0686
         AL    @01,@CF01755                                        0686
         ST    @01,@AL00001                                        0686
         AL    @06,@CF01754                                        0686
         LA    @06,SIOS-8(@15,@06)                                 0686
         ST    @06,@AL00001+4                                      0686
         LA    @06,READPERC                                        0686
         ST    @06,@AL00001+8                                      0686
         LA    @01,@AL00001                                        0686
         BAL   @14,CALCPERC                                        0686
*         CALL CALCPERC(WRITER(I),SIOS(I),RITEPERC);       /*@0001VLS*/
         L     @06,SUMPTR                                          0687
         LH    @15,I                                               0687
         MH    @15,@CH00727                                        0687
         LA    @01,0(@15,@06)                                      0687
         AL    @01,@CF01756                                        0687
         ST    @01,@AL00001                                        0687
         AL    @06,@CF01754                                        0687
         LA    @06,SIOS-8(@15,@06)                                 0687
         ST    @06,@AL00001+4                                      0687
         LA    @06,RITEPERC                                        0687
         ST    @06,@AL00001+8                                      0687
         LA    @01,@AL00001                                        0687
         BAL   @14,CALCPERC                                        0687
*         CALL CONVERT (FDATE(I),TEMPAREA,THREE);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00688                              0688
         LH    @06,I                                               0688
         MH    @06,@CH00727                                        0688
         L     @01,SUMPTR                                          0688
         AL    @01,@CF01757                                        0688
         LA    @06,FDATE-52(@06,@01)                               0688
         ST    @06,@AL00001                                        0688
         LA    @01,@AL00001                                        0688
         BAL   @14,CONVERT                                         0688
*         SUMFDATE = TEMPAREA(1:5);                        /*@0001VLS*/
         MVC   SUMFDATE(5),TEMPAREA                                0689
*         CALL CONVERT (TDATE(I),TEMPAREA,THREE);          /*@0001VLS*/
         MVC   @AL00001+4(8),@AL00690                              0690
         LH    @06,I                                               0690
         MH    @06,@CH00727                                        0690
         L     @01,SUMPTR                                          0690
         BCTR  @01,0                                               0690
         LA    @06,TDATE-55(@06,@01)                               0690
         ST    @06,@AL00001                                        0690
         LA    @01,@AL00001                                        0690
         BAL   @14,CONVERT                                         0690
*         SUMTDATE = TEMPAREA(1:5);                        /*@0001VLS*/
         MVC   SUMTDATE(5),TEMPAREA                                0691
*         CALL CONVBIN3(SIOS(I),SUMSIOS);                  /*@0001VLS*/
         LH    @06,I                                               0692
         MH    @06,@CH00727                                        0692
         L     @01,SUMPTR                                          0692
         AL    @01,@CF01754                                        0692
         LA    @06,SIOS-8(@06,@01)                                 0692
         ST    @06,@AL00001                                        0692
         LA    @06,SUMSIOS                                         0692
         ST    @06,@AL00001+4                                      0692
         LA    @01,@AL00001                                        0692
         BAL   @14,CONVBIN3                                        0692
*         SYSSIOS = SYSSIOS + SIOS(I);   /* TOTAL ALL SIOS   @0001VLS*/
         L     @06,SUMPTR                                          0693
         LH    @15,I                                               0693
         MH    @15,@CH00727                                        0693
         L     @14,SYSSIOS                                         0693
         LA    @01,0(@15,@06)                                      0693
         AL    @01,@CF01754                                        0693
         AL    @14,SIOS-8(,@01)                                    0693
         ST    @14,SYSSIOS                                         0693
*         CALL CONVBIN (MOUNTS(I),SUMMNTS);                /*@0001VLS*/
         AL    @06,@CF01758                                        0694
         LA    @06,MOUNTS-28(@15,@06)                              0694
         ST    @06,@AL00001                                        0694
         LA    @06,SUMMNTS                                         0694
         ST    @06,@AL00001+4                                      0694
         LA    @01,@AL00001                                        0694
         BAL   @14,CONVBIN                                         0694
*         SYSMNTS = SYSMNTS + MOUNTS(I);  /* TOTAL ALL MOUNTS        */
         L     @06,SUMPTR                                          0695
         LH    @15,I                                               0695
         MH    @15,@CH00727                                        0695
         L     @14,SYSMNTS                                         0695
         LA    @01,0(@15,@06)                                      0695
         AL    @01,@CF01758                                        0695
         AL    @14,MOUNTS-28(,@01)                                 0695
         ST    @14,SYSMNTS                                         0695
*         SUMP1 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP1,C'.'                                          0696
*         CALL CONVBIN (READER(I),SUMREAD);                /*@0001VLS*/
         AL    @06,@CF01755                                        0697
         LA    @06,READER-12(@15,@06)                              0697
         ST    @06,@AL00001                                        0697
         LA    @06,SUMREAD                                         0697
         ST    @06,@AL00001+4                                      0697
         LA    @01,@AL00001                                        0697
         BAL   @14,CONVBIN                                         0697
*         SYSRDS = SYSRDS + READER(I);                     /*@0001VLS*/
         L     @06,SUMPTR                                          0698
         LH    @15,I                                               0698
         MH    @15,@CH00727                                        0698
         L     @14,SYSRDS                                          0698
         LA    @01,0(@15,@06)                                      0698
         AL    @01,@CF01755                                        0698
         AL    @14,READER-12(,@01)                                 0698
         ST    @14,SYSRDS                                          0698
*         CALL CONVBIN (CLEANER(I),SUMCLEAN);              /*@0001VLS*/
         AL    @06,@CF01759                                        0699
         LA    @06,CLEANER-16(@15,@06)                             0699
         ST    @06,@AL00001                                        0699
         LA    @06,SUMCLEAN                                        0699
         ST    @06,@AL00001+4                                      0699
         LA    @01,@AL00001                                        0699
         BAL   @14,CONVBIN                                         0699
*         SUMP2 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP2,C'.'                                          0700
*         CALL CONVBIN (WRITER(I),SUMWRITE);               /*@0001VLS*/
         LH    @06,I                                               0701
         MH    @06,@CH00727                                        0701
         L     @01,SUMPTR                                          0701
         AL    @01,@CF01756                                        0701
         LA    @06,WRITER-20(@06,@01)                              0701
         ST    @06,@AL00001                                        0701
         LA    @06,SUMWRITE                                        0701
         ST    @06,@AL00001+4                                      0701
         LA    @01,@AL00001                                        0701
         BAL   @14,CONVBIN                                         0701
*         SYSRTS = SYSRTS + WRITER(I);                     /*@0001VLS*/
         L     @06,SUMPTR                                          0702
         LH    @15,I                                               0702
         MH    @15,@CH00727                                        0702
         L     @14,SYSRTS                                          0702
         LA    @01,0(@15,@06)                                      0702
         AL    @01,@CF01756                                        0702
         AL    @14,WRITER-20(,@01)                                 0702
         ST    @14,SYSRTS                                          0702
*         CALL CONVBIN (ERASE(I),SUMERASE);                /*@0001VLS*/
         AL    @06,@CF01760                                        0703
         LA    @06,ERASE-24(@15,@06)                               0703
         ST    @06,@AL00001                                        0703
         LA    @06,SUMERASE                                        0703
         ST    @06,@AL00001+4                                      0703
         LA    @01,@AL00001                                        0703
         BAL   @14,CONVBIN                                         0703
*         SUMP3 = PERIOD;                                  /*@0001VLS*/
         MVI   SUMP3,C'.'                                          0704
*         CALL CONVBIN2(VRC(I),SUMVRC);                    /*@0001VLS*/
         LH    @06,I                                               0705
         MH    @06,@CH00727                                        0705
         L     @01,SUMPTR                                          0705
         AL    @01,@CF01761                                        0705
         LA    @06,VRC-40(@06,@01)                                 0705
         ST    @06,@AL00001                                        0705
         LA    @06,SUMVRC                                          0705
         ST    @06,@AL00001+4                                      0705
         LA    @01,@AL00001                                        0705
         BAL   @14,CONVBIN2                                        0705
*         CALL CONVBIN2(STRDCHK(I),SUMSTRD);               /*@0001VLS*/
         LH    @06,I                                               0706
         MH    @06,@CH00727                                        0706
         L     @01,SUMPTR                                          0706
         AL    @01,@CF01762                                        0706
         LA    @06,STRDCHK-42(@06,@01)                             0706
         ST    @06,@AL00001                                        0706
         LA    @06,SUMSTRD                                         0706
         ST    @06,@AL00001+4                                      0706
         LA    @01,@AL00001                                        0706
         BAL   @14,CONVBIN2                                        0706
*         CALL CONVBIN2(PARTRECK(I),SUMPART);              /*@0001VLS*/
         LH    @06,I                                               0707
         MH    @06,@CH00727                                        0707
         L     @01,SUMPTR                                          0707
         AL    @01,@CF01763                                        0707
         LA    @06,PARTRECK-44(@06,@01)                            0707
         ST    @06,@AL00001                                        0707
         LA    @06,SUMPART                                         0707
         ST    @06,@AL00001+4                                      0707
         LA    @01,@AL00001                                        0707
         BAL   @14,CONVBIN2                                        0707
*         CALL CONVBIN2(OVERRUNS(I),SUMOVER);              /*@0001VLS*/
         LH    @06,I                                               0708
         MH    @06,@CH00727                                        0708
         L     @01,SUMPTR                                          0708
         AL    @01,@CF01764                                        0708
         LA    @06,OVERRUNS-46(@06,@01)                            0708
         ST    @06,@AL00001                                        0708
         LA    @06,SUMOVER                                         0708
         ST    @06,@AL00001+4                                      0708
         LA    @01,@AL00001                                        0708
         BAL   @14,CONVBIN2                                        0708
*         CALL CONVBIN2(VELCHGS(I),SUMVEL);                /*@0001VLS*/
         LH    @06,I                                               0709
         MH    @06,@CH00727                                        0709
         L     @01,SUMPTR                                          0709
         AL    @01,@CF01765                                        0709
         LA    @06,VELCHGS-48(@06,@01)                             0709
         ST    @06,@AL00001                                        0709
         LA    @06,SUMVEL                                          0709
         ST    @06,@AL00001+4                                      0709
         LA    @01,@AL00001                                        0709
         BAL   @14,CONVBIN2                                        0709
*         CALL CONVBIN2(IBG(I),SUMIBG);                    /*@0001VLS*/
         LH    @06,I                                               0710
         MH    @06,@CH00727                                        0710
         L     @01,SUMPTR                                          0710
         AL    @01,@CF01766                                        0710
         LA    @06,IBG-50(@06,@01)                                 0710
         ST    @06,@AL00001                                        0710
         LA    @06,SUMIBG                                          0710
         ST    @06,@AL00001+4                                      0710
         LA    @01,@AL00001                                        0710
         BAL   @14,CONVBIN2                                        0710
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0711
*         MYLINCT = MYLINCT - ONE;                         /*@0001VLS*/
         L     @06,MYLINCT                                         0712
         BCTR  @06,0                                               0712
         ST    @06,MYLINCT                                         0712
*       END;                                               /*@0001VLS*/
*   END;                                                   /*@0001VLS*/
@RF00667 LA    @06,1                                               0714
         AH    @06,I                                               0714
         STH   @06,I                                               0714
         C     @06,@CF00088                                        0714
         BNH   @DL00666                                            0714
*   CALL PRINTIT;                                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0715
*   IF SYSSIOS ^= ZERO THEN                                        0716
         L     @06,SYSSIOS                                         0716
         LTR   @06,@06                                             0716
         BZ    @RF00716                                            0716
*     DO;                              /* TOTALS LINE        @0001VLS*/
*       SUMT1 = TOTAL;                                     /*@0001VLS*/
         MVC   SUMT1(6),@CC00518                                   0718
*       CALL CALCPERC(SYSRDS,SYSSIOS,READPERC);            /*@0001VLS*/
         LA    @01,@AL00719                                        0719
         BAL   @14,CALCPERC                                        0719
*       CALL CALCPERC(SYSRTS,SYSSIOS,RITEPERC);            /*@0001VLS*/
         LA    @01,@AL00720                                        0720
         BAL   @14,CALCPERC                                        0720
*       CALL CONVBIN3(SYSSIOS,SUMSIOS);                    /*@0001VLS*/
         LA    @01,@AL00721                                        0721
         BAL   @14,CONVBIN3                                        0721
*       CALL CONVBIN (SYSMNTS,SUMMNTS);                    /*@0001VLS*/
         LA    @01,@AL00722                                        0722
         BAL   @14,CONVBIN                                         0722
*       CALL CONVBIN (SYSRDS,SUMREAD);                     /*@0001VLS*/
         LA    @01,@AL00723                                        0723
         BAL   @14,CONVBIN                                         0723
*       CALL CONVBIN (SYSRTS,SUMWRITE);                    /*@0001VLS*/
         LA    @01,@AL00724                                        0724
         BAL   @14,CONVBIN                                         0724
*     END;                                                 /*@0001VLS*/
*   ELSE                                                           0726
*     MSGADDR(1:LENGTH(NOTOTALS)) = NOTOTALS;              /*@0001VLS*/
         B     @RC00716                                            0726
@RF00716 MVC   MSGADDR(32),NOTOTALS                                0726
*   CALL PRINTIT;                                          /*@0001VLS*/
@RC00716 BAL   @14,PRINTIT                                         0727
*   HEAD3 = ON;                                            /*@0001VLS*/
         OI    HEAD3,B'00000100'                                   0728
*   EOTABLE(1:2) = EOT;                                    /*@D3503SG*/
         L     @06,CURRPTR                                         0729
         MVC   EOTABLE(2,@06),@CB00261                             0729
* END;                                                     /*@0001VLS*/
@EL00013 DS    0H                                                  0730
@EF00013 DS    0H                                                  0730
@ER00013 LM    @14,@12,@SA00013                                    0730
         BR    @14                                                 0730
*/********************************************************************/
*/*                      8809DEV                             @D3503SG*/
*/* OUTPUT THE TEMPORARY ERROR SUMMARY.  ONLY PRODUCE A LINE @D3503SG*/
*/* FOR EACH CUA FOR WHICH THERE WERE ANY SIOS.              @D3503SG*/
*/*                                                          @D3503SG*/
*/********************************************************************/
*SFSUM:  PROC;                                            /*@D3503SG*/
SFSUM    STM   @14,@12,@SA00014                                    0731
*   SYSSIOS = ZERO;                                        /*@D3503SG*/
         SLR   @06,@06                                             0732
         ST    @06,SYSSIOS                                         0732
*   SYWTSIOS = ZERO;                                       /*@D3503SG*/
         ST    @06,SYWTSIOS                                        0733
*   SYSRDS = ZERO;                                         /*@D3503SG*/
         ST    @06,SYSRDS                                          0734
*   SYSRTS = ZERO;                                         /*@D3503SG*/
         ST    @06,SYSRTS                                          0735
*   SYSMNTS = ZERO;                                        /*@D3503SG*/
         ST    @06,SYSMNTS                                         0736
*   RECCPU = CPU;                      /* INITIALIZE FOR THE SEARCH  */
         L     @06,CURRPTR                                         0737
         MVC   RECCPU(3),CPU(@06)                                  0737
*   RECCUA = CONTRCUA;                 /* OF THE DATE RANGE  @D3503SG*/
         MVC   RECCUA(2),CONTRCUA(@06)                             0738
*   RECDEV = DEVTYPE;                  /* DEVICE REQST'D.    @D3503SG*/
         MVC   RECDEV(1),DEVTYPE(@06)                              0739
*   IF HEAD1 = OFF THEN                                            0740
         TM    HEAD1,B'00010000'                                   0740
         BNZ   @RF00740                                            0740
*     CALL NOHEAD1;                    /* OUTPUT NO PART 1 MESSAGE   */
         BAL   @14,NOHEAD1                                         0741
*   IF HEAD2 = OFF THEN                                            0742
@RF00740 TM    HEAD2,B'00001000'                                   0742
         BNZ   @RF00742                                            0742
*     CALL NOHEAD2;                    /* OUTPUT NO PART2 MESSAGE    */
         BAL   @14,NOHEAD2                                         0743
*   ELSE                                                           0744
*     CALL OUTCODES;                   /* OUTPUT ERROR CODES @D3503SG*/
         B     @RC00742                                            0744
@RF00742 BAL   @14,OUTCODES                                        0744
*   MSGADDR = SPACER;                                      /*@D3503SG*/
@RC00742 MVC   MSGADDR(132),SPACER                                 0745
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0746
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0747
*   MYLINCT = MYLINCT - TWO;                               /*@D3503SG*/
         L     @06,MYLINCT                                         0748
         BCTR  @06,0                                               0748
         BCTR  @06,0                                               0748
         ST    @06,MYLINCT                                         0748
*   IF MYLINCT < EIGHT THEN            /* PAGE EJECT IF REST OF REPRT*/
         C     @06,@CF00067                                        0749
         BNL   @RF00749                                            0749
*     CALL PAGEJECT;                   /* WILL NOT FIT       @D3503SG*/
         BAL   @14,PAGEJECT                                        0750
*   MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;                /*@D3503SG*/
@RF00749 MVC   MSGADDR+39(48),CUATH1                               0751
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0752
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0753
*   MSGADDR(7:6+LENGTH(CUATH6)) = CUATH6;                  /*@D3503SG*/
         MVC   MSGADDR+6(92),CUATH6                                0754
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0755
*   MSGADDR(11:10+LENGTH(CUATH7)) = CUATH7;                /*@D3503SG*/
         MVC   MSGADDR+10(91),CUATH7                               0756
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0757
*   MSGADDR(3:2+LENGTH(CUATH8)) = CUATH8;                  /*@D3503SG*/
         MVC   MSGADDR+2(99),CUATH8                                0758
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0759
*   CALL PRINTIT;                                          /*@D3503SG*/
         BAL   @14,PRINTIT                                         0760
*   SUMPTR = TABCCHHR(1:4);            /* ADDRESS OF THE COUNTERS    */
         L     @06,CURRPTR                                         0761
         MVC   SUMPTR(4),TABCCHHR(@06)                             0761
*   DO I = 1 TO 16;                                        /*@D3503SG*/
         LA    @06,1                                               0762
         STH   @06,I                                               0762
@DL00762 DS    0H                                                  0763
*     IF SIOS(I) ^= ZERO THEN                                      0763
         MH    @06,@CH00727                                        0763
         L     @01,SUMPTR                                          0763
         AL    @01,@CF01754                                        0763
         L     @06,SIOS-8(@06,@01)                                 0763
         LTR   @06,@06                                             0763
         BZ    @RF00763                                            0763
*       DO;                            /* ANY SIOS           @D3503SG*/
*         IF MYLINCT < THREE THEN      /* NEW PAGE IF REST OF REPORT */
         L     @06,MYLINCT                                         0765
         C     @06,@CF00038                                        0765
         BNL   @RF00765                                            0765
*           DO;                        /* WILL NOT FIT       @D3503SG*/
*             CALL PAGEJECT;                               /*@D3503SG*/
         BAL   @14,PAGEJECT                                        0767
*             MSGADDR(40:39+LENGTH(CUATH1)) = CUATH1;      /*@D3503SG*/
         MVC   MSGADDR+39(48),CUATH1                               0768
*             CALL PRINTIT;                                /*@D3503SG*/
         BAL   @14,PRINTIT                                         0769
*             MSGADDR(7:6+LENGTH(CUATH6)) = CUATH6;        /*@D3503SG*/
         MVC   MSGADDR+6(92),CUATH6                                0770
*             CALL PRINTIT;                                /*@D3503SG*/
         BAL   @14,PRINTIT                                         0771
*             MSGADDR(11:10+LENGTH(CUATH7)) = CUATH7;      /*@D3503SG*/
         MVC   MSGADDR+10(91),CUATH7                               0772
*             CALL PRINTIT;                                /*@D3503SG*/
         BAL   @14,PRINTIT                                         0773
*             MSGADDR(3:2+LENGTH(CUATH8)) = CUATH8;        /*@D3503SG*/
         MVC   MSGADDR+2(99),CUATH8                                0774
*             CALL PRINTIT;                                /*@D3503SG*/
         BAL   @14,PRINTIT                                         0775
*             CALL PRINTIT;                                /*@D3503SG*/
         BAL   @14,PRINTIT                                         0776
*             MYLINCT = MYLINCT - FIVE;                    /*@D3503SG*/
         L     @06,MYLINCT                                         0777
         SL    @06,@CF00036                                        0777
         ST    @06,MYLINCT                                         0777
*           END;        /*MYLINCT < THREE                    @D3503SG*/
*         TEMPAREA(19:20) = CUX × (I-1);  /*1 CONVRT THE CUA @D3503SG*/
@RF00765 LH    @06,I                                               0779
         BCTR  @06,0                                               0779
         L     @01,SUMPTR                                          0779
         SLR   @00,@00                                             0779
         ICM   @00,3,CUX(@01)                                      0779
         OR    @06,@00                                             0779
         STCM  @06,3,TEMPAREA+18                                   0779
*         CALL CONVERT(TEMPAREA(19:20),TEMPAREA,2);  /*      @D3503SG*/
         LA    @01,@AL00780                                        0780
         BAL   @14,CONVERT                                         0780
*         STCUA = TEMPAREA(2:4);         /*                  @D3503SG*/
         MVC   STCUA(3),TEMPAREA+1                                 0781
*         CALL CALCPERC(READER(I),SIOS(I),STRDPRC);  /*2 READ ERS.PER*/
         L     @06,SUMPTR                                          0782
         LH    @15,I                                               0782
         MH    @15,@CH00727                                        0782
         LA    @01,0(@15,@06)                                      0782
         AL    @01,@CF01755                                        0782
         ST    @01,@AL00001                                        0782
         AL    @06,@CF01754                                        0782
         LA    @06,SIOS-8(@15,@06)                                 0782
         ST    @06,@AL00001+4                                      0782
         LA    @06,STRDPRC                                         0782
         ST    @06,@AL00001+8                                      0782
         LA    @01,@AL00001                                        0782
         BAL   @14,CALCPERC                                        0782
*         CALL CALCPERC(WRITER(I),WTSIOS(I),STWTPRC); /*3 WTE.ERS.PER*/
         L     @06,SUMPTR                                          0783
         LH    @15,I                                               0783
         MH    @15,@CH00727                                        0783
         LA    @01,0(@15,@06)                                      0783
         AL    @01,@CF01756                                        0783
         ST    @01,@AL00001                                        0783
         AL    @06,@CF01768                                        0783
         LA    @06,WTSIOS-32(@15,@06)                              0783
         ST    @06,@AL00001+4                                      0783
         LA    @06,STWTPRC                                         0783
         ST    @06,@AL00001+8                                      0783
         LA    @01,@AL00001                                        0783
         BAL   @14,CALCPERC                                        0783
*         CALL CONVERT(FDATE(I),TEMPAREA,3);  /*             @D3503SG*/
         MVC   @AL00001+4(8),@AL00784                              0784
         LH    @06,I                                               0784
         MH    @06,@CH00727                                        0784
         L     @01,SUMPTR                                          0784
         AL    @01,@CF01757                                        0784
         LA    @06,FDATE-52(@06,@01)                               0784
         ST    @06,@AL00001                                        0784
         LA    @01,@AL00001                                        0784
         BAL   @14,CONVERT                                         0784
*         STFRDATE = TEMPAREA(1:5);      /*4A FROM DATE      @D3503SG*/
         MVC   STFRDATE(5),TEMPAREA                                0785
*         CALL CONVERT(TDATE(I),TEMPAREA,3);  /*             @D3503SG*/
         MVC   @AL00001+4(8),@AL00786                              0786
         LH    @06,I                                               0786
         MH    @06,@CH00727                                        0786
         L     @01,SUMPTR                                          0786
         BCTR  @01,0                                               0786
         LA    @06,TDATE-55(@06,@01)                               0786
         ST    @06,@AL00001                                        0786
         LA    @01,@AL00001                                        0786
         BAL   @14,CONVERT                                         0786
*         STTODATE = TEMPAREA(1:5);      /*4B TO DATE        @D3503SG*/
         MVC   STTODATE(5),TEMPAREA                                0787
*         CALL CONVBIN(SIOS(I),STRDSIO); /*5 READ SIOS       @D3503SG*/
         LH    @06,I                                               0788
         MH    @06,@CH00727                                        0788
         L     @01,SUMPTR                                          0788
         AL    @01,@CF01754                                        0788
         LA    @06,SIOS-8(@06,@01)                                 0788
         ST    @06,@AL00001                                        0788
         LA    @06,STRDSIO                                         0788
         ST    @06,@AL00001+4                                      0788
         LA    @01,@AL00001                                        0788
         BAL   @14,CONVBIN                                         0788
*         SYSSIOS = SYSSIOS + SIOS(I);   /* TOTAL READS      @D3503SG*/
         L     @06,SUMPTR                                          0789
         LH    @15,I                                               0789
         MH    @15,@CH00727                                        0789
         L     @14,SYSSIOS                                         0789
         LA    @01,0(@15,@06)                                      0789
         AL    @01,@CF01754                                        0789
         AL    @14,SIOS-8(,@01)                                    0789
         ST    @14,SYSSIOS                                         0789
*         CALL CONVBIN(WTSIOS(I),STWTSIO);  /*6 WRITE SIOS   @D3503SG*/
         AL    @06,@CF01768                                        0790
         LA    @06,WTSIOS-32(@15,@06)                              0790
         ST    @06,@AL00001                                        0790
         LA    @06,STWTSIO                                         0790
         ST    @06,@AL00001+4                                      0790
         LA    @01,@AL00001                                        0790
         BAL   @14,CONVBIN                                         0790
*         SYWTSIOS = SYWTSIOS + WTSIOS(I); /* TOTAL WRITES   @D3503SG*/
         L     @06,SUMPTR                                          0791
         LH    @15,I                                               0791
         MH    @15,@CH00727                                        0791
         L     @14,SYWTSIOS                                        0791
         LA    @01,0(@15,@06)                                      0791
         AL    @01,@CF01768                                        0791
         AL    @14,WTSIOS-32(,@01)                                 0791
         ST    @14,SYWTSIOS                                        0791
*         CALL CONVBIN(MOUNTS(I),STUMNTS);   /*7 MOUNTS      @D3503SG*/
         AL    @06,@CF01758                                        0792
         LA    @06,MOUNTS-28(@15,@06)                              0792
         ST    @06,@AL00001                                        0792
         LA    @06,STUMNTS                                         0792
         ST    @06,@AL00001+4                                      0792
         LA    @01,@AL00001                                        0792
         BAL   @14,CONVBIN                                         0792
*         SYSMNTS = SYSMNTS + MOUNTS(I); /* TOTAL MOUNTS     @D3503SG*/
         L     @06,SUMPTR                                          0793
         LH    @15,I                                               0793
         MH    @15,@CH00727                                        0793
         L     @14,SYSMNTS                                         0793
         LA    @01,0(@15,@06)                                      0793
         AL    @01,@CF01758                                        0793
         AL    @14,MOUNTS-28(,@01)                                 0793
         ST    @14,SYSMNTS                                         0793
*         CALL CONVBIN(READER(I),STRDERS);  /*8 READ ERRORS  @D3503SG*/
         AL    @06,@CF01755                                        0794
         LA    @06,READER-12(@15,@06)                              0794
         ST    @06,@AL00001                                        0794
         LA    @06,STRDERS                                         0794
         ST    @06,@AL00001+4                                      0794
         LA    @01,@AL00001                                        0794
         BAL   @14,CONVBIN                                         0794
*         SYSRDS = SYSRDS + READER(I);   /* TOTAL READS      @D3503SG*/
         L     @06,SUMPTR                                          0795
         LH    @15,I                                               0795
         MH    @15,@CH00727                                        0795
         L     @14,SYSRDS                                          0795
         LA    @01,0(@15,@06)                                      0795
         AL    @01,@CF01755                                        0795
         AL    @14,READER-12(,@01)                                 0795
         ST    @14,SYSRDS                                          0795
*         CALL CONVBIN(SRDTRYS(I),STRDTRES); /*9 READ RETRIES@D3503SG*/
         AL    @06,@CF01769                                        0796
         LA    @06,SRDTRYS-36(@15,@06)                             0796
         ST    @06,@AL00001                                        0796
         LA    @06,STRDTRES                                        0796
         ST    @06,@AL00001+4                                      0796
         LA    @01,@AL00001                                        0796
         BAL   @14,CONVBIN                                         0796
*         CALL CONVBIN(WRITER(I),STWTERS);   /*10 WRITE ERS. @D3503SG*/
         LH    @06,I                                               0797
         MH    @06,@CH00727                                        0797
         L     @01,SUMPTR                                          0797
         AL    @01,@CF01756                                        0797
         LA    @06,WRITER-20(@06,@01)                              0797
         ST    @06,@AL00001                                        0797
         LA    @06,STWTERS                                         0797
         ST    @06,@AL00001+4                                      0797
         LA    @01,@AL00001                                        0797
         BAL   @14,CONVBIN                                         0797
*         SYSRTS = SYSRTS + WRITER(I);   /* TOTAL WRITES     @D3503SG*/
         L     @06,SUMPTR                                          0798
         LH    @15,I                                               0798
         MH    @15,@CH00727                                        0798
         L     @14,SYSRTS                                          0798
         LA    @01,0(@15,@06)                                      0798
         AL    @01,@CF01756                                        0798
         AL    @14,WRITER-20(,@01)                                 0798
         ST    @14,SYSRTS                                          0798
*         CALL CONVBIN(ERASE(I),STERGAPS);  /*11 ERASE GAPS  @D3503SG*/
         AL    @06,@CF01760                                        0799
         LA    @06,ERASE-24(@15,@06)                               0799
         ST    @06,@AL00001                                        0799
         LA    @06,STERGAPS                                        0799
         ST    @06,@AL00001+4                                      0799
         LA    @01,@AL00001                                        0799
         BAL   @14,CONVBIN                                         0799
*         CALL CONVBIN2(OVERRUNS(I),STOVRUN); /*12 OVERRUNS  @D3503SG*/
         LH    @06,I                                               0800
         MH    @06,@CH00727                                        0800
         L     @01,SUMPTR                                          0800
         AL    @01,@CF01764                                        0800
         LA    @06,OVERRUNS-46(@06,@01)                            0800
         ST    @06,@AL00001                                        0800
         LA    @06,STOVRUN                                         0800
         ST    @06,@AL00001+4                                      0800
         LA    @01,@AL00001                                        0800
         BAL   @14,CONVBIN2                                        0800
*         CALL CONVBIN2(VELCHGS(I),STVELCHK); /*13 VEL.CHKS. @D3503SG*/
         LH    @06,I                                               0801
         MH    @06,@CH00727                                        0801
         L     @01,SUMPTR                                          0801
         AL    @01,@CF01765                                        0801
         LA    @06,VELCHGS-48(@06,@01)                             0801
         ST    @06,@AL00001                                        0801
         LA    @06,STVELCHK                                        0801
         ST    @06,@AL00001+4                                      0801
         LA    @01,@AL00001                                        0801
         BAL   @14,CONVBIN2                                        0801
*         CALL PRINTIT;                  /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         0802
*         MYLINCT = MYLINCT - ONE;       /*                  @D3503SG*/
         L     @06,MYLINCT                                         0803
         BCTR  @06,0                                               0803
         ST    @06,MYLINCT                                         0803
*       END;         /*SIOS ^= ZERO                          @D3503SG*/
*   END;           /*DO 1 TO 16                              @D3503SG*/
@RF00763 LA    @06,1                                               0805
         AH    @06,I                                               0805
         STH   @06,I                                               0805
         C     @06,@CF00088                                        0805
         BNH   @DL00762                                            0805
*   CALL PRINTIT;                    /*                      @D3503SG*/
         BAL   @14,PRINTIT                                         0806
*   IF SYSSIOS ^= 0  THEN            /*                      @D3503SG*/
         L     @06,SYSSIOS                                         0807
         LTR   @06,@06                                             0807
         BZ    @RF00807                                            0807
*     DO;                            /*                      @D3503SG*/
*       SUMT1 = TOTAL;               /*                      @D3503SG*/
         MVC   SUMT1(6),@CC00518                                   0809
*       CALL CALCPERC(SYSRDS,SYSSIOS,STRDPRC);  /*2 READ ERS.@D3503SG*/
         LA    @01,@AL00810                                        0810
         BAL   @14,CALCPERC                                        0810
*       CALL CALCPERC(SYSRTS,SYWTSIOS,STWTPRC); /*3 WRITE ER.@D3503SG*/
         LA    @01,@AL00811                                        0811
         BAL   @14,CALCPERC                                        0811
*       CALL CONVBIN(SYSSIOS,STRDSIO);        /*5 READ SIOS  @D3503SG*/
         LA    @01,@AL00812                                        0812
         BAL   @14,CONVBIN                                         0812
*       CALL CONVBIN(SYWTSIOS,STWTSIO);       /*6 WRITE SIOS @D3503SG*/
         LA    @01,@AL00813                                        0813
         BAL   @14,CONVBIN                                         0813
*       CALL CONVBIN(SYSMNTS,STUMNTS);        /*7 MOUNTS     @D3503SG*/
         LA    @01,@AL00814                                        0814
         BAL   @14,CONVBIN                                         0814
*       CALL CONVBIN(SYSRDS,STRDERS);         /*8 READ ERS.  @D3503SG*/
         LA    @01,@AL00815                                        0815
         BAL   @14,CONVBIN                                         0815
*       CALL CONVBIN(SYSRTS,STWTERS);         /*10 WRITE ERS.@D3503SG*/
         LA    @01,@AL00816                                        0816
         BAL   @14,CONVBIN                                         0816
*     END;            /* SYSSIOS NOT = ZERO                  @D3503SG*/
*   ELSE              /* SYSSIOS = ZERO                      @D3503SG*/
*     MSGADDR(1:LENGTH(NOTOTALS)) = NOTOTALS;  /*            @D3503SG*/
         B     @RC00807                                            0818
@RF00807 MVC   MSGADDR(32),NOTOTALS                                0818
*   CALL PRINTIT;                  /*                        @D3503SG*/
@RC00807 BAL   @14,PRINTIT                                         0819
*   EOTABLE(1:2) = EOT;            /*MARK END OF RECORDS     @D3503SG*/
         L     @06,CURRPTR                                         0820
         MVC   EOTABLE(2,@06),@CB00261                             0820
*   HEAD3 = ON;                    /*                        @D3503SG*/
         OI    HEAD3,B'00000100'                                   0821
* END;                  /* END PROC SFSUM                    @D3503SG*/
@EL00014 DS    0H                                                  0822
@EF00014 DS    0H                                                  0822
@ER00014 LM    @14,@12,@SA00014                                    0822
         BR    @14                                                 0822
*/*                                                          @0001VLS*/
*/* OUTPUT THE VOLUME SECTION OF THE REPORT.  FIRST PUT OUT THE      */
*/* HEADERS.  IF NO RECORDS ARE PRESENT, THEN PUT OUT THE NO RECORDS */
*/* MESSAGE.  OTHERWISE OUTPUT ONE LINE FOR EACH VOLUME.     @0001VLS*/
*/*                                                          @0001VLS*/
*OUTVOLID:  PROC;                                          /*@0001VLS*/
OUTVOLID STM   @14,@12,@SA00015                                    0823
*     CALL PAGEJECT;                                       /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0824
*     VOLH1R = RDTHRSH;                /* READ THRESHOLD     @0001VLS*/
         MVC   VOLH1R(3),RDTHRSH(R2)                               0825
*     VOLH1W = WRTHRSH;                /* WRITE THRESHOLD    @0001VLS*/
         MVC   VOLH1W(3),WRTHRSH(R2)                               0826
*     MSGADDR = VOLHEAD1;                                  /*@0001VLS*/
         MVI   MSGADDR+104,C' '                                    0827
         MVC   MSGADDR+105(27),MSGADDR+104                         0827
         MVC   MSGADDR(104),VOLHEAD1                               0827
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         0828
*     IF EXCTHRES(1) = ZERO & EXCTHRES(2) = ZERO THEN              0829
         SLR   @06,@06                                             0829
         C     @06,EXCTHRES                                        0829
         BNE   @RF00829                                            0829
         C     @06,EXCTHRES+4                                      0829
         BNE   @RF00829                                            0829
*       DO;                            /* NO VOLUMES PRESENT @0001VLS*/
*         CALL CONVERT (LVOLDATE,TEMPAREA,THREE);  /* LOW DATE       */
         LA    @01,@AL00831                                        0831
         BAL   @14,CONVERT                                         0831
*         VOLH5L = TEMPAREA(1:5);                          /*@0001VLS*/
         MVC   VOLH5L(5),TEMPAREA                                  0832
*         CALL CONVERT (HVOLDATE,TEMPAREA,THREE);  /* HIGH DATE      */
         LA    @01,@AL00833                                        0833
         BAL   @14,CONVERT                                         0833
*         VOLH5H = TEMPAREA(1:5);                          /*@0001VLS*/
         MVC   VOLH5H(5),TEMPAREA                                  0834
*         MSGADDR(40:39+LENGTH(NOVOLS)) = NOVOLS;          /*@0001VLS*/
         MVC   MSGADDR+39(46),NOVOLS                               0835
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0836
*       END;                                               /*@0001VLS*/
*     ELSE                                                         0838
*       DO;                                                /*@0001VLS*/
         B     @RC00829                                            0838
@RF00829 DS    0H                                                  0839
*         MSGADDR = VOLH2;             /* HEADER             @0001VLS*/
         MVC   MSGADDR(132),VOLH2                                  0839
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0840
*         MSGADDR = VOLH3;             /* HEADER             @0001VLS*/
         MVC   MSGADDR(132),VOLH3                                  0841
*         CALL PRINTIT;                                    /*@0001VLS*/
         BAL   @14,PRINTIT                                         0842
*         CALL PRINTIT;                /* BLANK LINE         @0001VLS*/
         BAL   @14,PRINTIT                                         0843
*         MYLINCT = MYLINCT - FIVE;                        /*@0001VLS*/
         L     @06,MYLINCT                                         0844
         SL    @06,@CF00036                                        0844
         ST    @06,MYLINCT                                         0844
*         DO CURRPTR = CURRPTR BY TWELVE WHILE(EOTABLE ^= EOT);    0845
         B     @DE00845                                            0845
@DL00845 DS    0H                                                  0846
*           RECCCHHR = TABCCHHR;          /* RECORD LOCATION @0001VLS*/
         L     @06,CURRPTR                                         0846
         MVC   RECCCHHR(5,R2),TABCCHHR(@06)                        0846
*           RESPECIFY (R15) RESTRICTED;                    /*@0001VLS*/
*           CALL IOHND(READIRCT);                          /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    0848
         LA    @01,@AL00848                                        0848
         BALR  @14,@15                                             0848
*           RETCODE = R15;                                 /*@0001VLS*/
         ST    R15,RETCODE                                         0849
*           RESPECIFY (R15) UNRESTRICTED;                  /*@0001VLS*/
*           IF RETCODE = ZERO THEN                                 0851
         L     @06,RETCODE                                         0851
         SLR   @15,@15                                             0851
         CR    @06,@15                                             0851
         BNE   @RF00851                                            0851
*             DO;                                          /*@0001VLS*/
*               IF MYLINCT <= ZERO THEN       /* LINE WILL NOT FIT   */
         C     @15,MYLINCT                                         0853
         BL    @RF00853                                            0853
*                 DO;                         /* ON PAGE     @0001VLS*/
*                   CALL PAGEJECT;                         /*@0001VLS*/
         BAL   @14,PAGEJECT                                        0855
*                   MSGADDR = VOLHEAD1;                    /*@0001VLS*/
         MVI   MSGADDR+104,C' '                                    0856
         MVC   MSGADDR+105(27),MSGADDR+104                         0856
         MVC   MSGADDR(104),VOLHEAD1                               0856
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0857
*                   MSGADDR = VOLH2;                       /*@0001VLS*/
         MVC   MSGADDR(132),VOLH2                                  0858
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0859
*                   MSGADDR = VOLH3;                       /*@0001VLS*/
         MVC   MSGADDR(132),VOLH3                                  0860
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0861
*                   CALL PRINTIT;                          /*@0001VLS*/
         BAL   @14,PRINTIT                                         0862
*                   MYLINCT = MYLINCT - FIVE;              /*@0001VLS*/
         L     @06,MYLINCT                                         0863
         SL    @06,@CF00036                                        0863
         ST    @06,MYLINCT                                         0863
*                 END;                                     /*@0001VLS*/
*               IF (RECTYP & FOXZERO) = OBRREC  THEN       /*@D3503SG*/
@RF00853 MVC   @TS00001(1),RECTYP(R7)                              0865
         NI    @TS00001,X'F0'                                      0865
         CLI   @TS00001,X'30'                                      0865
         BNE   @RF00865                                            0865
*                 DO;                                      /*@D3503SG*/
*                   VVOLUME = VOLID;                       /*@D3503SG*/
         MVC   VVOLUME(6),VOLID(R7)                                0867
*                   CALL CONVERT(DATE(2:4),TEMPAREA,SIX);  /*@D3503SG*/
         MVC   @AL00001+4(8),@AL00868                              0868
         LA    @06,DATE+1(,R7)                                     0868
         ST    @06,@AL00001                                        0868
         LA    @01,@AL00001                                        0868
         BAL   @14,CONVERT                                         0868
*                   VDAY = TEMPAREA(3:5);                  /*@D3503SG*/
         MVC   VDAY(3),TEMPAREA+2                                  0869
*                   VYEAR = TEMPAREA(1:2);                 /*@D3503SG*/
         MVC   VYEAR(2),TEMPAREA                                   0870
*                   CALL CONVERT(TIME,TEMPAREA,EIGHT);     /*@D3503SG*/
         MVC   @AL00001+4(8),@AL00871                              0871
         LA    @06,TIME(,R7)                                       0871
         ST    @06,@AL00001                                        0871
         LA    @01,@AL00001                                        0871
         BAL   @14,CONVERT                                         0871
*                   VHH = TEMPAREA(1:2);                   /*@D3503SG*/
         MVC   VHH(2),TEMPAREA                                     0872
*                   VMM = TEMPAREA(3:4);                   /*@D3503SG*/
         MVC   VMM(2),TEMPAREA+2                                   0873
*                   VSS = TEMPAREA(5:6);                   /*@D3503SG*/
         MVC   VSS(2),TEMPAREA+4                                   0874
*                   VPOINT = PERIOD;                       /*@D3503SG*/
         MVI   VPOINT,C'.'                                         0875
*                   VTH = TEMPAREA(7:8);                   /*@D3503SG*/
         MVC   VTH(2),TEMPAREA+6                                   0876
*                   IF SNSCNT <= 9 × OSER74XX = HEXZEROS THEN      0877
         CLC   SNSCNT(2,R7),@CH00085                               0877
         BNH   @RT00877                                            0877
         CLC   OSER74XX(2,R7),@CB00208                             0877
         BNE   @RF00877                                            0877
@RT00877 DS    0H                                                  0878
*                     DO;                                  /*@D3503SG*/
*                       VTUSER = NA;                       /*@D3503SG*/
         MVC   VTUSER(5),@CC00495                                  0879
*                       VMODEL = NA;                       /*@D3503SG*/
         MVC   VMODEL(5),@CC00495                                  0880
*                       VDENS = NA;                        /*@D3503SG*/
         MVC   VDENS(5),@CC00495                                   0881
*                       VHDRSER = NA;                      /*@D3503SG*/
         MVC   VHDRSER(5),@CC00495                                 0882
*                     END;                                 /*@D3503SG*/
*                   ELSE                                           0884
*                     DO;                                  /*@D3503SG*/
         B     @RC00877                                            0884
@RF00877 DS    0H                                                  0885
*                       CALL CONVBIN2(OSER74XX,VTUSER);    /*@D3503SG*/
         LA    @06,OSER74XX(,R7)                                   0885
         ST    @06,@AL00001                                        0885
         LA    @06,VTUSER                                          0885
         ST    @06,@AL00001+4                                      0885
         LA    @01,@AL00001                                        0885
         BAL   @14,CONVBIN2                                        0885
*                       IF SENSBIT5(4) = ON THEN                   0886
         TM    SENSBIT5+3(R7),B'00000100'                          0886
         BNO   @RF00886                                            0886
*                         VDENS = BPI1600;                 /*@D3503SG*/
         MVI   VDENS+4,C' '                                        0887
         MVC   VDENS(4),@CC00491                                   0887
*                       ELSE                                       0888
*                         IF SENSBIT4(7) = ON THEN                 0888
         B     @RC00886                                            0888
@RF00886 TM    SENSBIT4+6(R7),B'00001000'                          0888
         BNO   @RF00888                                            0888
*                             VDENS = BPI6250;             /*@D3503SG*/
         MVI   VDENS+4,C' '                                        0889
         MVC   VDENS(4),@CC00493                                   0889
*                         ELSE                                     0890
*                             VDENS = BPI800;              /*@D3503SG*/
         B     @RC00888                                            0890
@RF00888 MVI   VDENS+4,C' '                                        0890
         MVC   VDENS(4),@CC00489                                   0890
*                       I = SENSE(7) & ZEROFOX;            /*@D3503SG*/
@RC00888 DS    0H                                                  0891
@RC00886 LA    @06,15                                              0891
         SLR   @15,@15                                             0891
         IC    @15,SENSE+6(,R7)                                    0891
         NR    @06,@15                                             0891
         STH   @06,I                                               0891
*                       VMODEL(3:3) = MODNO(I+1);          /*@D3503SG*/
         LA    @01,MODNO(@06)                                      0892
         MVC   VMODEL+2(1),0(@01)                                  0892
*                       CALL CONVBIN2(HDRSER,VHDRSER);     /*@D3503SG*/
         LA    @06,HDRSER(,R7)                                     0893
         ST    @06,@AL00001                                        0893
         LA    @06,VHDRSER                                         0893
         ST    @06,@AL00001+4                                      0893
         LA    @01,@AL00001                                        0893
         BAL   @14,CONVBIN2                                        0893
*                     END;                                 /*@D3503SG*/
*                   CALL CONVERT(OCUA2,TEMPAREA,TWO);      /*@D3503SG*/
@RC00877 MVC   @AL00001+4(8),@AL00895                              0895
         LA    @06,OCUA2(,R7)                                      0895
         ST    @06,@AL00001                                        0895
         LA    @01,@AL00001                                        0895
         BAL   @14,CONVERT                                         0895
*                   VCUA = TEMPAREA(2:4);                  /*@D3503SG*/
         MVC   VCUA(3),TEMPAREA+1                                  0896
*                   IF DEVCODE = NONSF  THEN  /*             @D3503SG*/
         CLI   DEVCODE,X'00'                                       0897
         BNE   @RF00897                                            0897
*                     DO;                /*                  @D3503SG*/
*                       IF DISMNT = OFF THEN                       0899
         TM    DISMNT(R7),B'00000100'                              0899
         BNZ   @RF00899                                            0899
*                         IF SENSBIT3(1) = OFF THEN                0900
         TM    SENSBIT3(R7),B'00010000'                            0900
         BNZ   @RF00900                                            0900
*                           IF SENSBIT5(2) = ON THEN               0901
         TM    SENSBIT5+1(R7),B'00000100'                          0901
         BNO   @RF00901                                            0901
*                             VRDWRT = CHARW;       /*PERMANENT WRITE*/
         MVI   VRDWRT,C'W'                                         0902
*                           ELSE                                   0903
*                             VRDWRT = CHARR;       /*PERMANENT READ*/
         B     @RC00901                                            0903
@RF00901 MVI   VRDWRT,C'R'                                         0903
*                         ELSE                                     0904
*                             VRDWRT = CHARE;       /*EQUIPMENT CHECK*/
         B     @RC00900                                            0904
@RF00900 MVI   VRDWRT,C'E'                                         0904
*                       CALL CONVBIN1(PERMRDS,VPRDS);      /*@D3503SG*/
@RC00900 DS    0H                                                  0905
@RF00899 LA    @06,PERMRDS(,R7)                                    0905
         ST    @06,@AL00001                                        0905
         LA    @06,VPRDS                                           0905
         ST    @06,@AL00001+4                                      0905
         LA    @01,@AL00001                                        0905
         BAL   @14,CONVBIN1                                        0905
*                       CALL CONVBIN1(PERMRTS,VPRTS);      /*@D3503SG*/
         LA    @06,PERMRTS(,R7)                                    0906
         ST    @06,@AL00001                                        0906
         LA    @06,VPRTS                                           0906
         ST    @06,@AL00001+4                                      0906
         LA    @01,@AL00001                                        0906
         BAL   @14,CONVBIN1                                        0906
*                       CALL CONVBIN1(READTH,VTRDS);       /*@D3503SG*/
         LA    @06,READTH(,R7)                                     0907
         ST    @06,@AL00001                                        0907
         LA    @06,VTRDS                                           0907
         ST    @06,@AL00001+4                                      0907
         LA    @01,@AL00001                                        0907
         BAL   @14,CONVBIN1                                        0907
*                       CALL CONVBIN1(RITETH,VTRTS);       /*@D3503SG*/
         LA    @06,RITETH(,R7)                                     0908
         ST    @06,@AL00001                                        0908
         LA    @06,VTRTS                                           0908
         ST    @06,@AL00001+4                                      0908
         LA    @01,@AL00001                                        0908
         BAL   @14,CONVBIN1                                        0908
*                       CALL CONVBIN2(RECLEAN,VCLEAN);     /*@D3503SG*/
         LA    @06,RECLEAN(,R7)                                    0909
         ST    @06,@AL00001                                        0909
         LA    @06,VCLEAN                                          0909
         ST    @06,@AL00001+4                                      0909
         LA    @01,@AL00001                                        0909
         BAL   @14,CONVBIN2                                        0909
*                       CALL CONVBIN2(RECERASE,VERASE);    /*@D3503SG*/
         LA    @06,RECERASE(,R7)                                   0910
         ST    @06,@AL00001                                        0910
         LA    @06,VERASE                                          0910
         ST    @06,@AL00001+4                                      0910
         LA    @01,@AL00001                                        0910
         BAL   @14,CONVBIN2                                        0910
*                       CALL CONVBIN2(RECSIOS,VSIOS);      /*@D3503SG*/
         LA    @06,RECSIOS(,R7)                                    0911
         ST    @06,@AL00001                                        0911
         LA    @06,VSIOS                                           0911
         ST    @06,@AL00001+4                                      0911
         LA    @01,@AL00001                                        0911
         BAL   @14,CONVBIN2                                        0911
*                       CALL CONVBIN2(BLKLENG,VBLOCK);     /*@D3503SG*/
         LA    @06,BLKLENG(,R7)                                    0912
         ST    @06,@AL00001                                        0912
         LA    @06,VBLOCK                                          0912
         ST    @06,@AL00001+4                                      0912
         LA    @01,@AL00001                                        0912
         BAL   @14,CONVBIN2                                        0912
*                       VPGMID = JOBID;                    /*@D3503SG*/
         MVC   VPGMID(8),JOBID(R7)                                 0913
*                       CALL CONVERT(CPUMOD,VCPUMOD,TWO);          0914
         MVC   @AL00001+4(8),@AL00914                              0914
         LA    @06,CPUMOD(,R7)                                     0914
         ST    @06,@AL00001                                        0914
         LA    @01,@AL00001                                        0914
         BAL   @14,CONVERT                                         0914
*                       CALL CONVERT(CPUSER,VCPUSER,THREE);        0915
         MVC   @AL00001+4(8),@AL00915                              0915
         LA    @06,CPUSER(,R7)                                     0915
         ST    @06,@AL00001                                        0915
         LA    @01,@AL00001                                        0915
         BAL   @14,CONVERT                                         0915
*                       CALL PRINTIT;                      /*@D3503SG*/
         BAL   @14,PRINTIT                                         0916
*                       MYLINCT = MYLINCT - ONE;           /*@D3503SG*/
         L     @06,MYLINCT                                         0917
         BCTR  @06,0                                               0917
         ST    @06,MYLINCT                                         0917
*                     END;             /*  3410 OBR          @D3503SG*/
*                   ELSE               /*                    @D3503SG*/
*                     DO;              /*  8809 OBR          @D3503SG*/
         B     @RC00897                                            0919
@RF00897 DS    0H                                                  0920
*                       IF SOPRWB = OFF  THEN      /*        @D3503SG*/
         TM    SOPRWB(R7),B'10000000'                              0920
         BNZ   @RF00920                                            0920
*                         VRDWRT = CHARR; /*R=PERM.READ      @D3503SG*/
         MVI   VRDWRT,C'R'                                         0921
*                       ELSE             /*                  @D3503SG*/
*                         VRDWRT = CHARW; /*W=PERM.WRITE     @D3503SG*/
         B     @RC00920                                            0922
@RF00920 MVI   VRDWRT,C'W'                                         0922
*                       CALL CONVBIN2(BLKLENG,VBLOCK);     /*@D3503SG*/
@RC00920 LA    @06,BLKLENG(,R7)                                    0923
         ST    @06,@AL00001                                        0923
         LA    @06,VBLOCK                                          0923
         ST    @06,@AL00001+4                                      0923
         LA    @01,@AL00001                                        0923
         BAL   @14,CONVBIN2                                        0923
*                       VPGMID = JOBID;                    /*@D3503SG*/
         MVC   VPGMID(8),JOBID(R7)                                 0924
*                       CALL CONVERT(CPUMOD,VCPUMOD,TWO);          0925
         MVC   @AL00001+4(8),@AL00925                              0925
         LA    @06,CPUMOD(,R7)                                     0925
         ST    @06,@AL00001                                        0925
         LA    @01,@AL00001                                        0925
         BAL   @14,CONVERT                                         0925
*                       CALL CONVERT(CPUSER,VCPUSER,THREE);        0926
         MVC   @AL00001+4(8),@AL00926                              0926
         LA    @06,CPUSER(,R7)                                     0926
         ST    @06,@AL00001                                        0926
         LA    @01,@AL00001                                        0926
         BAL   @14,CONVERT                                         0926
*                       CALL PRINTIT;                      /*@D3503SG*/
         BAL   @14,PRINTIT                                         0927
*                       MYLINCT = MYLINCT - ONE;           /*@D3503SG*/
         L     @06,MYLINCT                                         0928
         BCTR  @06,0                                               0928
         ST    @06,MYLINCT                                         0928
*                     END;            /* 8809 OBR            @D3503SG*/
*                 END;                /* OBR RECORD          @D3503SG*/
*               ELSE                  /*                     @D3503SG*/
*                   CALL SFVOLID;     /* MDR RECORD          @D3503SG*/
         B     @RC00865                                            0931
@RF00865 BAL   @14,SFVOLID                                         0931
*             END;           /*RETCODE ^= ZERO               @D3503SG*/
@RC00865 DS    0H                                                  0933
*         END;           /*CURRPTR BY 12 WHILE NOT EOT       @D3503SG*/
@RF00851 LA    @06,12                                              0933
         AL    @06,CURRPTR                                         0933
         ST    @06,CURRPTR                                         0933
@DE00845 L     @06,CURRPTR                                         0933
         CLC   EOTABLE(2,@06),@CB00261                             0933
         BNE   @DL00845                                            0933
*       END;         /*EXCTHRES(1/2) = ZERO                  @D3503SG*/
*END OUTVOLID;                                             /*@D3503SG*/
@EL00015 DS    0H                                                  0935
@EF00015 DS    0H                                                  0935
@ER00015 LM    @14,@12,@SA00015                                    0935
         BR    @14                                                 0935
*/********************************************************************/
*/*                  8809DEV                                 @D3503SG*/
*/* OUTPUT THE VOLUME SECTION OF THE REPORT.  PUT OUT ONE    @D3503SG*/
*/* LINE FOR EACH VOLUME.                                    @D3503SG*/
*/*                                                          @D3503SG*/
*/********************************************************************/
*SFVOLID:  PROC;                                           /*@D3503SG*/
SFVOLID  STM   @14,@12,@SA00016                                    0936
*  VVOLUME= SMVOLID;                                       /*@D3503SG*/
         MVC   VVOLUME(6),SMVOLID(R7)                              0937
*  CALL CONVERT(DATE(2:4),TEMPAREA,6);                     /*@D3503SG*/
         MVC   @AL00001+4(8),@AL00938                              0938
         LA    @06,DATE+1(,R7)                                     0938
         ST    @06,@AL00001                                        0938
         LA    @01,@AL00001                                        0938
         BAL   @14,CONVERT                                         0938
*  VDAY = TEMPAREA(3:5);                                   /*@D3503SG*/
         MVC   VDAY(3),TEMPAREA+2                                  0939
*  VYEAR = TEMPAREA(1:2);                                  /*@D3503SG*/
         MVC   VYEAR(2),TEMPAREA                                   0940
*  CALL CONVERT(TIME,TEMPAREA,8);                          /*@D3503SG*/
         MVC   @AL00001+4(8),@AL00941                              0941
         LA    @06,TIME(,R7)                                       0941
         ST    @06,@AL00001                                        0941
         LA    @01,@AL00001                                        0941
         BAL   @14,CONVERT                                         0941
*  VHH = TEMPAREA(1:2);                                    /*@D3503SG*/
         MVC   VHH(2),TEMPAREA                                     0942
*  VMM = TEMPAREA(3:4);                                    /*@D3503SG*/
         MVC   VMM(2),TEMPAREA+2                                   0943
*  VSS = TEMPAREA(5:6);                                    /*@D3503SG*/
         MVC   VSS(2),TEMPAREA+4                                   0944
*  VPOINT = PERIOD;                                        /*@D3503SG*/
         MVI   VPOINT,C'.'                                         0945
*  VTH = TEMPAREA(7:8);                                    /*@D3503SG*/
         MVC   VTH(2),TEMPAREA+6                                   0946
*  CALL CONVERT(SMCUA,TEMPAREA,2);                         /*@D3503SG*/
         MVC   @AL00001+4(8),@AL00947                              0947
         LA    @06,SMCUA(,R7)                                      0947
         ST    @06,@AL00001                                        0947
         LA    @01,@AL00001                                        0947
         BAL   @14,CONVERT                                         0947
*  VCUA = TEMPAREA(2:4);                /*4 CONTROL UNIT AD. @D3503SG*/
         MVC   VCUA(3),TEMPAREA+1                                  0948
*  CALL CONVBIN1(SMTRD,VTRDS);          /*7 TEMPORARY READ   @D3503SG*/
         LA    @06,SMTRD(,R7)                                      0949
         ST    @06,@AL00001                                        0949
         LA    @06,VTRDS                                           0949
         ST    @06,@AL00001+4                                      0949
         LA    @01,@AL00001                                        0949
         BAL   @14,CONVBIN1                                        0949
*  CALL CONVBIN1(SMTWRT,VTRTS);         /*8 TEMPORARY WRITE  @D3503SG*/
         LA    @06,SMTWRT(,R7)                                     0950
         ST    @06,@AL00001                                        0950
         LA    @06,VTRTS                                           0950
         ST    @06,@AL00001+4                                      0950
         LA    @01,@AL00001                                        0950
         BAL   @14,CONVBIN1                                        0950
*  CALL CONVBIN2(SMRDTRY,VRETRY);       /*9 READ RETRY       @D3503SG*/
         LA    @06,SMRDTRY(,R7)                                    0951
         ST    @06,@AL00001                                        0951
         LA    @06,VRETRY                                          0951
         ST    @06,@AL00001+4                                      0951
         LA    @01,@AL00001                                        0951
         BAL   @14,CONVBIN2                                        0951
*  CALL CONVBIN2(SMERGAP,VERASE);       /*10 ERASE GAPS      @D3503SG*/
         LA    @06,SMERGAP(,R7)                                    0952
         ST    @06,@AL00001                                        0952
         LA    @06,VERASE                                          0952
         ST    @06,@AL00001+4                                      0952
         LA    @01,@AL00001                                        0952
         BAL   @14,CONVBIN2                                        0952
*  CALL CONVBIN2(SMRDSIO,VSIOS);        /*11 READ SIOS       @D3503SG*/
         LA    @06,SMRDSIO(,R7)                                    0953
         ST    @06,@AL00001                                        0953
         LA    @06,VSIOS                                           0953
         ST    @06,@AL00001+4                                      0953
         LA    @01,@AL00001                                        0953
         BAL   @14,CONVBIN2                                        0953
*  CALL CONVBIN2(SMWTSIO,VCWRTS);       /*12 WRITE SIOS      @D3503SG*/
         LA    @06,SMWTSIO(,R7)                                    0954
         ST    @06,@AL00001                                        0954
         LA    @06,VCWRTS                                          0954
         ST    @06,@AL00001+4                                      0954
         LA    @01,@AL00001                                        0954
         BAL   @14,CONVBIN2                                        0954
*  CALL CONVBIN2(SMBLTH,VBLOCK);        /*13 BLK LENGTH      @D3503SG*/
         LA    @06,SMBLTH(,R7)                                     0955
         ST    @06,@AL00001                                        0955
         LA    @06,VBLOCK                                          0955
         ST    @06,@AL00001+4                                      0955
         LA    @01,@AL00001                                        0955
         BAL   @14,CONVBIN2                                        0955
*  CALL CONVERT(SMCPMDL,VCPUMOD,TWO);   /*15A MODEL#.        @D3503SG*/
         MVC   @AL00001+4(8),@AL00956                              0956
         LA    @06,SMCPMDL(,R7)                                    0956
         ST    @06,@AL00001                                        0956
         LA    @01,@AL00001                                        0956
         BAL   @14,CONVERT                                         0956
*  CALL CONVERT(SMCPSER,VCPUSER,THREE); /*15B SERIAL#        @D3503SG*/
         MVC   @AL00001+4(8),@AL00957                              0957
         LA    @06,SMCPSER(,R7)                                    0957
         ST    @06,@AL00001                                        0957
         LA    @01,@AL00001                                        0957
         BAL   @14,CONVERT                                         0957
*  CALL PRINTIT;                         /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         0958
*  MYLINCT = MYLINCT - ONE;              /*                  @D3503SG*/
         L     @06,MYLINCT                                         0959
         BCTR  @06,0                                               0959
         ST    @06,MYLINCT                                         0959
* END SFVOLID;   /*END PROCEEDURE                            @D3503SG*/
@EL00016 DS    0H                                                  0960
@EF00016 DS    0H                                                  0960
@ER00016 LM    @14,@12,@SA00016                                    0960
         BR    @14                                                 0960
*/********************************************************************/
*/* THIS PROCEDURE WILL MAKE ENTRIES INTO THE SORT TABLE.  FOR EACH  */
*/* PERM ERROR OR EACH DISMOUNT RECORD WHICH EXCEEDS THRESHOLD, AN   */
*/* ENTRY IS MADE.  ALL DISMOUNT RECORDS ARE SUMMED INTO THE @0001VLS*/
*/* APPROPRIATE CPU/CONTROL UNIT COUNTERS FOR THE TEMPORARY SUMMARY. */
*/********************************************************************/
*TABENT: PROC;                                             /*@0001VLS*/
TABENT   STM   @14,@12,@SA00017                                    0961
*  RECCOUNT = RECCOUNT + ONE;                              /*@0001VLS*/
         LH    @06,RECCOUNT                                        0962
         LA    @06,1(,@06)                                         0962
         STH   @06,RECCOUNT                                        0962
*  RECCUA = OCUA2;                   /* RECORD CUA FOR SHARE CONVERT */
         MVC   RECCUA(2),OCUA2(R7)                                 0963
*  RECCPU = CPUSER;                  /* RECORD CPU FOR SHARE CONVERT */
         MVC   RECCPU(3),CPUSER(R7)                                0964
*  RECDEV = NONSF;                   /* RECORD RECORD TYPE   @D3503SG*/
         MVI   RECDEV,X'00'                                        0965
*  IF SHAREPTR ^= ZERO THEN                                        0966
         L     @06,SHAREPTR(,R2)                                   0966
         LTR   @06,@06                                             0966
         BZ    @RF00966                                            0966
*    CALL CUASHARE;                   /* PERFORM ANY SHARE CONVERSION*/
         BAL   @14,CUASHARE                                        0967
*  CALL FINDDATE;                     /* SET UP DATE RANGES  @0001VLS*/
@RF00966 BAL   @14,FINDDATE                                        0968
*  IF LOWDATE > DATE(2:4) THEN                                     0969
         L     @06,DATEPTR                                         0969
         CLC   LOWDATE(3,@06),DATE+1(R7)                           0969
         BNH   @RF00969                                            0969
*    LOWDATE = DATE(2:4);             /* NEW LOW DATE        @0001VLS*/
         MVC   LOWDATE(3,@06),DATE+1(R7)                           0970
*  IF HIDATE < DATE(2:4) THEN                                      0971
@RF00969 L     @06,DATEPTR                                         0971
         CLC   HIDATE(3,@06),DATE+1(R7)                            0971
         BNL   @RF00971                                            0971
*    HIDATE = DATE(2:4);              /* NEW HIGH DATE       @0001VLS*/
         MVC   HIDATE(3,@06),DATE+1(R7)                            0972
*  IF DISMNT = ON THEN                /* DISMOUNT RECORD     @0001VLS*/
@RF00971 TM    DISMNT(R7),B'00000100'                              0973
         BNO   @RF00973                                            0973
*    DO;                                                   /*@0001VLS*/
*      CALL TEMPTOT;                  /* TOTAL FOR TEMP SUMMARY      */
         BAL   @14,TEMPTOT                                         0975
*      IF RETCODE = ZERO & (READTH >= READS × RITETH >= WRITES) THEN
         L     @06,RETCODE                                         0976
         LTR   @06,@06                                             0976
         BNZ   @RF00976                                            0976
         CLC   READTH(1,R7),READS                                  0976
         BNL   @RT00976                                            0976
         CLC   RITETH(1,R7),WRITES                                 0976
         BL    @RF00976                                            0976
@RT00976 DS    0H                                                  0977
*        DO EXCTHRES(1) = EXCTHRES(1) + ONE;               /*@0001VLS*/
         LA    @06,1                                               0977
         AL    @06,EXCTHRES                                        0977
         ST    @06,EXCTHRES                                        0977
*          CALL SAVEREC(ONE);         /* ENTER INTO TABLE AS TYPE 1  */
         LA    @01,@AL00978                                        0978
         BAL   @14,SAVEREC                                         0978
*        END;                                              /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
*  ELSE                                                            0981
*    IF (CSW34XX & UNITCK) = UNITCK THEN                           0981
         B     @RC00973                                            0981
@RF00973 MVC   @TS00001(1),CSW34XX(R7)                             0981
         NI    @TS00001,X'02'                                      0981
         CLI   @TS00001,X'02'                                      0981
         BNE   @RF00981                                            0981
*      DO EXCTHRES(2) = EXCTHRES(2) + ONE;                 /*@0001VLS*/
         LA    @06,1                                               0982
         AL    @06,EXCTHRES+4                                      0982
         ST    @06,EXCTHRES+4                                      0982
*        CALL SAVEREC(TWO);           /* ENTER INTO TABLE AS TYPE 2  */
         LA    @01,@AL00983                                        0983
         BAL   @14,SAVEREC                                         0983
*      END;                                                /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00017 DS    0H                                                  0985
@EF00017 DS    0H                                                  0985
@ER00017 LM    @14,@12,@SA00017                                    0985
         BR    @14                                                 0985
*/********************************************************************/
*/*        8809DEV TABLE ENTRY PROCESSING                    @D3503SG*/
*/********************************************************************/
*SFBENT: PROC;                                             /*@D3503SG*/
SFBENT   STM   @14,@12,@SA00018                                    0986
*  RECCOUNT = RECCOUNT + ONE;                              /*@D3503SG*/
         LH    @06,RECCOUNT                                        0987
         LA    @06,1(,@06)                                         0987
         STH   @06,RECCOUNT                                        0987
*  RECCPU = CPUSER;                   /*RECORD CPU FOR SHARE CONVERT */
         MVC   RECCPU(3),CPUSER(R7)                                0988
*  IF (RECTYP & FOXZERO) = MDRREC  THEN  /*                  @D3503SG*/
         MVC   @TS00001(1),RECTYP(R7)                              0989
         NI    @TS00001,X'F0'                                      0989
         CLI   @TS00001,X'90'                                      0989
         BNE   @RF00989                                            0989
*    RECCUA = SMCUA;                     /*                  @D3503SG*/
         MVC   RECCUA(2),SMCUA(R7)                                 0990
*  ELSE                                  /*OBR RECORD        @D3503SG*/
*    RECCUA = OCUA2;                     /*                  @D3503SG*/
         B     @RC00989                                            0991
@RF00989 MVC   RECCUA(2),OCUA2(R7)                                 0991
*  RECDEV = SFOBR;                    /*INDICATE 8809DEV     @D3503SG*/
@RC00989 MVI   RECDEV,X'01'                                        0992
*  IF SHAREPTR ^= ZERO THEN                                        0993
         L     @06,SHAREPTR(,R2)                                   0993
         LTR   @06,@06                                             0993
         BZ    @RF00993                                            0993
*    CALL CUASHARE;                   /* PERFORM ANY SHARE CONVERSION*/
         BAL   @14,CUASHARE                                        0994
*  CALL FINDDATE;                     /* SET UP DATE RANGES  @D3503SG*/
@RF00993 BAL   @14,FINDDATE                                        0995
*  IF LOWDATE > DATE(2:4) THEN                                     0996
         L     @06,DATEPTR                                         0996
         CLC   LOWDATE(3,@06),DATE+1(R7)                           0996
         BNH   @RF00996                                            0996
*    LOWDATE = DATE(2:4);             /* NEW LOW DATE        @D3503SG*/
         MVC   LOWDATE(3,@06),DATE+1(R7)                           0997
*  IF HIDATE < DATE(2:4) THEN                                      0998
@RF00996 L     @06,DATEPTR                                         0998
         CLC   HIDATE(3,@06),DATE+1(R7)                            0998
         BNL   @RF00998                                            0998
*    HIDATE = DATE(2:4);                 /* NEW HIGH DATE    @D3503SG*/
         MVC   HIDATE(3,@06),DATE+1(R7)                            0999
*  IF (RECTYP & FOXZERO) = MDRREC THEN   /* MDR RECORD       @D3503SG*/
@RF00998 MVC   @TS00001(1),RECTYP(R7)                              1000
         NI    @TS00001,X'F0'                                      1000
         CLI   @TS00001,X'90'                                      1000
         BNE   @RF01000                                            1000
*    DO;                                                   /*@D3503SG*/
*      CALL SFTOT;      /*TOTAL FOR TEMPORARY SUMMARY  2     @D3503SG*/
         BAL   @14,SFTOT                                           1002
*      IF RETCODE = ZERO   &                               /*@D3503SG*/
*         (SMTRD >= READS × SMTWRT >= WRITES)  THEN        /*@D3503SG*/
         L     @06,RETCODE                                         1003
         LTR   @06,@06                                             1003
         BNZ   @RF01003                                            1003
         CLC   SMTRD(1,R7),READS                                   1003
         BNL   @RT01003                                            1003
         CLC   SMTWRT(1,R7),WRITES                                 1003
         BL    @RF01003                                            1003
@RT01003 DS    0H                                                  1004
*        DO EXCTHRES(1) = EXCTHRES(1) + ONE;               /*@D3503SG*/
         LA    @06,1                                               1004
         AL    @06,EXCTHRES                                        1004
         ST    @06,EXCTHRES                                        1004
*          CALL SAVEREC(ONE);   /*ENTER INTO TABLE AS TYPE 1 @D3503SG*/
         LA    @01,@AL01005                                        1005
         BAL   @14,SAVEREC                                         1005
*        END;                                              /*@D3503SG*/
*    END;                                                  /*@D3503SG*/
*  ELSE                                                            1008
*    DO;                                                   /*@D3503SG*/
         B     @RC01000                                            1008
@RF01000 DS    0H                                                  1009
*      EXCTHRES(2) = EXCTHRES(2) + ONE;                    /*@D3503SG*/
         LA    @06,1                                               1009
         AL    @06,EXCTHRES+4                                      1009
         ST    @06,EXCTHRES+4                                      1009
*      CALL SAVEREC(TWO);       /*ENTER INTO TABLE AS TYPE 2 @D3503SG*/
         LA    @01,@AL01010                                        1010
         BAL   @14,SAVEREC                                         1010
*    END;                                /*                  @D3503SG*/
*END;                                    /*                  @D3503SG*/
@EL00018 DS    0H                                                  1012
@EF00018 DS    0H                                                  1012
@ER00018 LM    @14,@12,@SA00018                                    1012
         BR    @14                                                 1012
*/********************************************************************/
*/* A RECORD IS SAVED IN THE SORT TABLE.  IF THE RECORD WAS INPUT    */
*/* FROM HISTORY TAPE, THEN IT IS SAVED ON DIRECTWK.  THE TYPE IS    */
*/* ENTERED FROM THE PARAMETER PASSED.                       @0001VLS*/
*/*      TYPE 1 = DISMOUNT RECORD                            @0001VLS*/
*/*      TYPE 2 = PERM ERROR                                 @0001VLS*/
*/*      TYPE 3 = POINTER TO TEMP SUMMARY TABLE              @0001VLS*/
*/********************************************************************/
*SAVEREC: PROC(TYPEENT);                                   /*@0001VLS*/
SAVEREC  STM   @14,@12,@SA00019                                    1013
         MVC   @PC00019(4),0(@01)                                  1013
*   DCL TYPEENT FIXED(31);                                 /*@0001VLS*/
*   IF PHIST = ON THEN                 /* HISTORY INPUT      @0001VLS*/
         TM    PHIST(R2),B'00100000'                               1015
         BNO   @RF01015                                            1015
*     DO;                                                  /*@0001VLS*/
*       RESPECIFY (R15) RESTRICTED;                        /*@0001VLS*/
*       CALL IOHND(RITESCRT);                              /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    1018
         LA    @01,@AL01018                                        1018
         BALR  @14,@15                                             1018
*       RETCODE = R15;                                     /*@0001VLS*/
         ST    R15,RETCODE                                         1019
*       RESPECIFY (R15) UNRESTRICTED;                      /*@0001VLS*/
*     END;                                                 /*@0001VLS*/
*   IF RETCODE = ZERO THEN                                         1022
@RF01015 L     @06,RETCODE                                         1022
         LTR   @06,@06                                             1022
         BNZ   @RF01022                                            1022
*     DO;                                                  /*@0001VLS*/
*       CONTRCUA = RECCUA;             /* STORE CUA          @0001VLS*/
         L     @06,CURRPTR                                         1024
         MVC   CONTRCUA(2,@06),RECCUA                              1024
*       CALL CONVCNTR;                 /*CONVERT CUA TO CONTROL LEVEL *
         BAL   @14,CONVCNTR                                        1025
*       CONTRCUA=LOWCUA;               /*SAVE CONVERTED VALUE         *
         L     @06,CURRPTR                                         1026
         MVC   CONTRCUA(2,@06),LOWCUA                              1026
*       CPU = RECCPU;                  /* STORE CPU          @0001VLS*/
         MVC   CPU(3,@06),RECCPU                                   1027
*       TABCCHHR = RECCCHHR;           /* AUX STORAGE ADDRESS        */
         MVC   TABCCHHR(5,@06),RECCCHHR(R2)                        1028
*       TYPE = TYPEENT;                /* TYPE OF ENTRY      @0001VLS*/
         L     @15,@PC00019                                        1029
         L     @15,TYPEENT(,@15)                                   1029
         STC   @15,TYPE(,@06)                                      1029
*       DEVTYPE = RECDEV;              /* SF OR NON-SF RECRD.@D3503SG*/
         MVC   DEVTYPE(1,@06),RECDEV                               1030
*       NUMENT = NUMENT + ONE;                             /*@0001VLS*/
         LA    @15,1                                               1031
         AL    @15,NUMENT                                          1031
         ST    @15,NUMENT                                          1031
*       CURRPTR = CURRPTR - TWELVE;    /* POINT TO NEXT ENTRY        */
         SL    @06,@CF00033                                        1032
         ST    @06,CURRPTR                                         1032
*     END;                                                 /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00019 DS    0H                                                  1034
@EF00019 DS    0H                                                  1034
@ER00019 LM    @14,@12,@SA00019                                    1034
         BR    @14                                                 1034
*/********************************************************************/
*/* TOTAL THE DISMOUNT DATA INTO THE APPROPRIATE CPU/CONTROL UNIT    */
*/* COUNTERS.  IF NONE EXIST, A NEW SET IS CREATED, AN ENTRY MADE IN */
*/* THE SORT TABLE, AND THE ADDRESS OF THE COUNTERS STORED THERE.    */
*/********************************************************************/
*TEMPTOT: PROC;                                            /*@0001VLS*/
TEMPTOT  STM   @14,@12,@SA00020                                    1035
*CUAINDEX = RECCUA & ZZZF;             /* UNITS ADDRESS      @0001VLS*/
         LA    @06,15                                              1036
         SLR   @15,@15                                             1036
         ICM   @15,3,RECCUA                                        1036
         NR    @06,@15                                             1036
         ST    @06,CUAINDEX                                        1036
*CUAINDEX = CUAINDEX + ONE;                                /*@0001VLS*/
         AL    @06,@CF00057                                        1037
         ST    @06,CUAINDEX                                        1037
*CALL FINDTOTS;                           /* FIND COUNTER AREA       */
         BAL   @14,FINDTOTS                                        1038
*IF RETCODE = ZERO THEN                                            1039
         L     @06,RETCODE                                         1039
         LTR   @06,@06                                             1039
         BNZ   @RF01039                                            1039
*  DO;                                                     /*@0001VLS*/
*    IF DATE(2:4) > TDATE(CUAINDEX) THEN                           1041
         L     @06,SUMPTR                                          1041
         L     @15,CUAINDEX                                        1041
         MH    @15,@CH00727                                        1041
         ST    @15,@TF00001                                        1041
         ALR   @15,@06                                             1041
         BCTR  @15,0                                               1041
         CLC   DATE+1(3,R7),TDATE-55(@15)                          1041
         BNH   @RF01041                                            1041
*      TDATE(CUAINDEX) = DATE(2:4);       /* HIGHER TO DATE  @0001VLS*/
         AL    @06,@TF00001                                        1042
         BCTR  @06,0                                               1042
         MVC   TDATE-55(3,@06),DATE+1(R7)                          1042
*    IF DATE(2:4) < FDATE(CUAINDEX) THEN                           1043
@RF01041 L     @06,SUMPTR                                          1043
         L     @15,CUAINDEX                                        1043
         MH    @15,@CH00727                                        1043
         ST    @15,@TF00001                                        1043
         ALR   @15,@06                                             1043
         AL    @15,@CF01757                                        1043
         CLC   DATE+1(3,R7),FDATE-52(@15)                          1043
         BNL   @RF01043                                            1043
*      FDATE(CUAINDEX) = DATE(2:4);       /* LOWER FROM DATE @0001VLS*/
         AL    @06,@TF00001                                        1044
         AL    @06,@CF01757                                        1044
         MVC   FDATE-52(3,@06),DATE+1(R7)                          1044
*    READER(CUAINDEX) = READER(CUAINDEX) + READTH;  /* # TEMP READS  */
@RF01043 L     @06,SUMPTR                                          1045
         L     @15,CUAINDEX                                        1045
         MH    @15,@CH00727                                        1045
         SLR   @14,@14                                             1045
         IC    @14,READTH(,R7)                                     1045
         LA    @01,0(@15,@06)                                      1045
         AL    @01,@CF01755                                        1045
         AL    @14,READER-12(,@01)                                 1045
         LA    @01,0(@15,@06)                                      1045
         AL    @01,@CF01755                                        1045
         ST    @14,READER-12(,@01)                                 1045
*    WRITER(CUAINDEX) = WRITER(CUAINDEX) + RITETH;  /* # TEMP WRITES */
         SLR   @14,@14                                             1046
         IC    @14,RITETH(,R7)                                     1046
         LA    @01,0(@15,@06)                                      1046
         AL    @01,@CF01756                                        1046
         AL    @14,WRITER-20(,@01)                                 1046
         LA    @01,0(@15,@06)                                      1046
         AL    @01,@CF01756                                        1046
         ST    @14,WRITER-20(,@01)                                 1046
*    SIOS(CUAINDEX) = SIOS(CUAINDEX) + RECSIOS;     /* # SIOS        */
         SLR   @14,@14                                             1047
         ICM   @14,3,RECSIOS(R7)                                   1047
         LA    @01,0(@15,@06)                                      1047
         AL    @01,@CF01754                                        1047
         AL    @14,SIOS-8(,@01)                                    1047
         LA    @01,0(@15,@06)                                      1047
         AL    @01,@CF01754                                        1047
         ST    @14,SIOS-8(,@01)                                    1047
*    CLEANER(CUAINDEX) = CLEANER(CUAINDEX) + RECLEAN; /* # CLEANER   */
         SLR   @14,@14                                             1048
         ICM   @14,3,RECLEAN(R7)                                   1048
         LA    @01,0(@15,@06)                                      1048
         AL    @01,@CF01759                                        1048
         AL    @14,CLEANER-16(,@01)                                1048
         LA    @01,0(@15,@06)                                      1048
         AL    @01,@CF01759                                        1048
         ST    @14,CLEANER-16(,@01)                                1048
*    ERASE(CUAINDEX) = ERASE(CUAINDEX) + RECERASE;  /* # ERASE GAPS  */
         SLR   @14,@14                                             1049
         ICM   @14,3,RECERASE(R7)                                  1049
         LA    @01,0(@15,@06)                                      1049
         AL    @01,@CF01760                                        1049
         AL    @14,ERASE-24(,@01)                                  1049
         LA    @01,0(@15,@06)                                      1049
         AL    @01,@CF01760                                        1049
         ST    @14,ERASE-24(,@01)                                  1049
*    IF DISMNT = ON & EOD = OFF THEN                               1050
         TM    DISMNT(R7),B'00000100'                              1050
         BNO   @RF01050                                            1050
         TM    EOD(R7),B'10000000'                                 1050
         BNZ   @RF01050                                            1050
*      MOUNTS(CUAINDEX) = MOUNTS(CUAINDEX) + ONE;   /* ADD 1 TO MOUNT*/
         LA    @14,1                                               1051
         LA    @01,0(@15,@06)                                      1051
         AL    @01,@CF01758                                        1051
         AL    @14,MOUNTS-28(,@01)                                 1051
         AL    @06,@CF01758                                        1051
         ST    @14,MOUNTS-28(@15,@06)                              1051
*    VRC(CUAINDEX) = VRC(CUAINDEX) + RECVRC;               /*@0001VLS*/
@RF01050 L     @06,SUMPTR                                          1052
         L     @15,CUAINDEX                                        1052
         MH    @15,@CH00727                                        1052
         SLR   @14,@14                                             1052
         IC    @14,RECVRC(,R7)                                     1052
         LA    @01,0(@15,@06)                                      1052
         AL    @01,@CF01761                                        1052
         AH    @14,VRC-40(,@01)                                    1052
         LA    @01,0(@15,@06)                                      1052
         AL    @01,@CF01761                                        1052
         STH   @14,VRC-40(,@01)                                    1052
*    I = RECSTRD & ZEROFOX;                                /*@0001VLS*/
         LA    @14,15                                              1053
         SLR   @09,@09                                             1053
         IC    @09,RECSTRD(,R7)                                    1053
         NR    @09,@14                                             1053
         STH   @09,I                                               1053
*    STRDCHK(CUAINDEX) = STRDCHK(CUAINDEX) + I;            /*@0001VLS*/
         LA    @08,0(@15,@06)                                      1054
         AL    @08,@CF01762                                        1054
         AH    @09,STRDCHK-42(,@08)                                1054
         LA    @08,0(@15,@06)                                      1054
         AL    @08,@CF01762                                        1054
         STH   @09,STRDCHK-42(,@08)                                1054
*    I = RECPART;                                          /*@0001VLS*/
         SLR   @09,@09                                             1055
         IC    @09,RECPART(,R7)                                    1055
         STH   @09,I                                               1055
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @09,4                                               1056
         STH   @09,I                                               1056
*    PARTRECK(CUAINDEX) = PARTRECK(CUAINDEX) + I;          /*@0001VLS*/
         LA    @01,0(@15,@06)                                      1057
         AL    @01,@CF01763                                        1057
         LH    @09,PARTRECK-44(,@01)                               1057
         AH    @09,I                                               1057
         LA    @08,0(@15,@06)                                      1057
         AL    @08,@CF01763                                        1057
         STH   @09,PARTRECK-44(,@08)                               1057
*    I = RECOVER;                                          /*@0001VLS*/
         SLR   @09,@09                                             1058
         IC    @09,RECOVER(,R7)                                    1058
         STH   @09,I                                               1058
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @09,4                                               1059
         STH   @09,I                                               1059
*    OVERRUNS(CUAINDEX) = OVERRUNS(CUAINDEX) + I;          /*@0001VLS*/
         LA    @01,0(@15,@06)                                      1060
         AL    @01,@CF01764                                        1060
         LH    @09,OVERRUNS-46(,@01)                               1060
         AH    @09,I                                               1060
         LA    @08,0(@15,@06)                                      1060
         AL    @08,@CF01764                                        1060
         STH   @09,OVERRUNS-46(,@08)                               1060
*    I = RECVEL & ZEROFOX;                                 /*@0001VLS*/
         SLR   @09,@09                                             1061
         IC    @09,RECVEL(,R7)                                     1061
         NR    @14,@09                                             1061
         STH   @14,I                                               1061
*    VELCHGS(CUAINDEX) = VELCHGS(CUAINDEX) + I;            /*@0001VLS*/
         LA    @01,0(@15,@06)                                      1062
         AL    @01,@CF01765                                        1062
         AH    @14,VELCHGS-48(,@01)                                1062
         LA    @01,0(@15,@06)                                      1062
         AL    @01,@CF01765                                        1062
         STH   @14,VELCHGS-48(,@01)                                1062
*    I = RECIBG;                                           /*@0001VLS*/
         SLR   @14,@14                                             1063
         IC    @14,RECIBG(,R7)                                     1063
         STH   @14,I                                               1063
*    SRL(I,FOUR);                                          /*@0001VLS*/
         SRL   @14,4                                               1064
         STH   @14,I                                               1064
*    IBG(CUAINDEX) = IBG(CUAINDEX) + I;                    /*@0001VLS*/
         LA    @01,0(@15,@06)                                      1065
         AL    @01,@CF01766                                        1065
         LH    @14,IBG-50(,@01)                                    1065
         AH    @14,I                                               1065
         AL    @06,@CF01766                                        1065
         STH   @14,IBG-50(@15,@06)                                 1065
*  END;                                                    /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00020 DS    0H                                                  1067
@EF00020 DS    0H                                                  1067
@ER00020 LM    @14,@12,@SA00020                                    1067
         BR    @14                                                 1067
*/********************************************************************/
*/*                        8809DEV                           @D3503SG*/
*/* TOTAL THE DISMOUNT DATA INTO THE APPROPRIATE CPU/CONTROL UNIT    */
*/* COUNTERS.  IF NONE EXIST, A NEW SET IS CREATED, AN ENTRY MADE IN */
*/* THE SORT TABLE, AND THE ADDRESS OF THE COUNTERS STORED THERE.    */
*/********************************************************************/
*SFTOT:   PROC;                                            /*@0001VLS*/
SFTOT    STM   @14,@12,@SA00021                                    1068
*CUAINDEX = RECCUA & ZZZF;             /* UNITS ADDRESS      @0001VLS*/
         LA    @06,15                                              1069
         SLR   @15,@15                                             1069
         ICM   @15,3,RECCUA                                        1069
         NR    @06,@15                                             1069
         ST    @06,CUAINDEX                                        1069
*CUAINDEX = CUAINDEX + ONE;                                /*@0001VLS*/
         AL    @06,@CF00057                                        1070
         ST    @06,CUAINDEX                                        1070
*CALL FINDTOTS;                           /* FIND COUNTER AREA       */
         BAL   @14,FINDTOTS                                        1071
*IF RETCODE = ZERO THEN                                            1072
         L     @06,RETCODE                                         1072
         LTR   @06,@06                                             1072
         BNZ   @RF01072                                            1072
*  DO;                                                     /*@0001VLS*/
*    IF DATE(2:4) > TDATE(CUAINDEX) THEN                           1074
         L     @06,SUMPTR                                          1074
         L     @15,CUAINDEX                                        1074
         MH    @15,@CH00727                                        1074
         ST    @15,@TF00001                                        1074
         ALR   @15,@06                                             1074
         BCTR  @15,0                                               1074
         CLC   DATE+1(3,R7),TDATE-55(@15)                          1074
         BNH   @RF01074                                            1074
*      TDATE(CUAINDEX) = DATE(2:4);       /* HIGHER TO DATE  @0001VLS*/
         AL    @06,@TF00001                                        1075
         BCTR  @06,0                                               1075
         MVC   TDATE-55(3,@06),DATE+1(R7)                          1075
*    IF DATE(2:4) < FDATE(CUAINDEX) THEN                           1076
@RF01074 L     @06,SUMPTR                                          1076
         L     @15,CUAINDEX                                        1076
         MH    @15,@CH00727                                        1076
         ST    @15,@TF00001                                        1076
         ALR   @15,@06                                             1076
         AL    @15,@CF01757                                        1076
         CLC   DATE+1(3,R7),FDATE-52(@15)                          1076
         BNL   @RF01076                                            1076
*      FDATE(CUAINDEX) = DATE(2:4);       /* LOWER FROM DATE @0001VLS*/
         AL    @06,@TF00001                                        1077
         AL    @06,@CF01757                                        1077
         MVC   FDATE-52(3,@06),DATE+1(R7)                          1077
*    VELCHGS(CUAINDEX)=VELCHGS(CUAINDEX)+SMVEL; /*VEL.CHK.   @D3503SG*/
@RF01076 L     @06,SUMPTR                                          1078
         L     @15,CUAINDEX                                        1078
         MH    @15,@CH00727                                        1078
         SLR   @14,@14                                             1078
         IC    @14,SMVEL(,R7)                                      1078
         LA    @01,0(@15,@06)                                      1078
         AL    @01,@CF01765                                        1078
         AH    @14,VELCHGS-48(,@01)                                1078
         LA    @01,0(@15,@06)                                      1078
         AL    @01,@CF01765                                        1078
         STH   @14,VELCHGS-48(,@01)                                1078
*    READER(CUAINDEX)=READER(CUAINDEX)+SMTRD;   /*READ ERS.  @D3503SG*/
         SLR   @14,@14                                             1079
         IC    @14,SMTRD(,R7)                                      1079
         LA    @01,0(@15,@06)                                      1079
         AL    @01,@CF01755                                        1079
         AL    @14,READER-12(,@01)                                 1079
         LA    @01,0(@15,@06)                                      1079
         AL    @01,@CF01755                                        1079
         ST    @14,READER-12(,@01)                                 1079
*    WRITER(CUAINDEX)=WRITER(CUAINDEX)+SMTWRT;  /*WRITE ERS. @D3503SG*/
         SLR   @14,@14                                             1080
         IC    @14,SMTWRT(,R7)                                     1080
         LA    @01,0(@15,@06)                                      1080
         AL    @01,@CF01756                                        1080
         AL    @14,WRITER-20(,@01)                                 1080
         LA    @01,0(@15,@06)                                      1080
         AL    @01,@CF01756                                        1080
         ST    @14,WRITER-20(,@01)                                 1080
*    SIOS(CUAINDEX)=SIOS(CUAINDEX)+SMRDSIO;     /*READ SIOS  @D3503SG*/
         SLR   @14,@14                                             1081
         ICM   @14,3,SMRDSIO(R7)                                   1081
         LA    @01,0(@15,@06)                                      1081
         AL    @01,@CF01754                                        1081
         AL    @14,SIOS-8(,@01)                                    1081
         LA    @01,0(@15,@06)                                      1081
         AL    @01,@CF01754                                        1081
         ST    @14,SIOS-8(,@01)                                    1081
*    WTSIOS(CUAINDEX)=WTSIOS(CUAINDEX)+SMWTSIO; /*WRITE SIOS @D3503SG*/
         SLR   @14,@14                                             1082
         ICM   @14,3,SMWTSIO(R7)                                   1082
         LA    @01,0(@15,@06)                                      1082
         AL    @01,@CF01768                                        1082
         AL    @14,WTSIOS-32(,@01)                                 1082
         LA    @01,0(@15,@06)                                      1082
         AL    @01,@CF01768                                        1082
         ST    @14,WTSIOS-32(,@01)                                 1082
*    IF EOD = OFF  THEN                         /*NOT END DAY@D3503SG*/
         TM    EOD(R7),B'10000000'                                 1083
         BNZ   @RF01083                                            1083
*      MOUNTS(CUAINDEX)=MOUNTS(CUAINDEX)+SMOUNT; /*MOUNTS    @D3503SG*/
         SLR   @14,@14                                             1084
         IC    @14,SMOUNT(,R7)                                     1084
         LA    @01,0(@15,@06)                                      1084
         AL    @01,@CF01758                                        1084
         AL    @14,MOUNTS-28(,@01)                                 1084
         AL    @06,@CF01758                                        1084
         ST    @14,MOUNTS-28(@15,@06)                              1084
*    OVERRUNS(CUAINDEX)=OVERRUNS(CUAINDEX)+SMOVRUN; /*OVERRUNS0002SSG*/
@RF01083 L     @06,SUMPTR                                          1085
         L     @15,CUAINDEX                                        1085
         MH    @15,@CH00727                                        1085
         SLR   @14,@14                                             1085
         IC    @14,SMOVRUN(,R7)                                    1085
         LA    @01,0(@15,@06)                                      1085
         AL    @01,@CF01764                                        1085
         AH    @14,OVERRUNS-46(,@01)                               1085
         LA    @01,0(@15,@06)                                      1085
         AL    @01,@CF01764                                        1085
         STH   @14,OVERRUNS-46(,@01)                               1085
*    ERASE(CUAINDEX)=ERASE(CUAINDEX)+SMERGAP;   /*ERASE GAPS @D3503SG*/
         SLR   @14,@14                                             1086
         ICM   @14,3,SMERGAP(R7)                                   1086
         LA    @01,0(@15,@06)                                      1086
         AL    @01,@CF01760                                        1086
         AL    @14,ERASE-24(,@01)                                  1086
         LA    @01,0(@15,@06)                                      1086
         AL    @01,@CF01760                                        1086
         ST    @14,ERASE-24(,@01)                                  1086
*    SRDTRYS(CUAINDEX)=SRDTRYS(CUAINDEX)+SMRDTRY; /*READ RTRS@D3503SG*/
         SLR   @14,@14                                             1087
         ICM   @14,3,SMRDTRY(R7)                                   1087
         LA    @01,0(@15,@06)                                      1087
         AL    @01,@CF01769                                        1087
         AL    @14,SRDTRYS-36(,@01)                                1087
         AL    @06,@CF01769                                        1087
         ST    @14,SRDTRYS-36(@15,@06)                             1087
*  END;                                  /*                  @D3503SG*/
*END;                                    /*                  @D3503SG*/
@EL00021 DS    0H                                                  1089
@EF00021 DS    0H                                                  1089
@ER00021 LM    @14,@12,@SA00021                                    1089
         BR    @14                                                 1089
*/********************************************************************/
*/* OUTPUT THE CUA STATISTICS PORTION OF THE REPORT.         @0001VLS*/
*/********************************************************************/
*PRINTCUA: PROC;                                           /*@0001VLS*/
PRINTCUA STM   @14,@12,@SA00022                                    1090
* OLDCPUCU = SORTCPUC;               /*INITIALIZE SORT BREAK @0001VLS*/
         L     @06,CURRPTR                                         1091
         MVC   OLDCPUCU(6),SORTCPUC(@06)                           1091
* DO CURRPTR = CURRPTR BY TWELVE WHILE (EOTABLE ^= EOT);   /*@0002VLS*/
         B     @DE01092                                            1092
@DL01092 DS    0H                                                  1093
*   IF OLDCPUCU ^= SORTCPUC THEN                                   1093
         L     @06,CURRPTR                                         1093
         CLC   OLDCPUCU(6),SORTCPUC(@06)                           1093
         BE    @RF01093                                            1093
*     CALL OUTTYPES;                  /* SORT BREAK.         @0001VLS*/
         BAL   @14,OUTTYPES                                        1094
*   IF TYPE = THREE THEN                                           1095
@RF01093 L     @06,CURRPTR                                         1095
         CLI   TYPE(@06),3                                         1095
         BNE   @RF01095                                            1095
*     IF DEVTYPE = NONSF  THEN           /*NON 8809DEV       @D3503SG*/
         CLI   DEVTYPE(@06),X'00'                                  1096
         BNE   @RF01096                                            1096
*       CALL TEMPSUM;                 /* OUTPUT THE SUMMARY SECTION  */
         BAL   @14,TEMPSUM                                         1097
*     ELSE                               /*8809DEV           @D3503SG*/
*       CALL SFSUM;                   /* OUTPUT THE SUMMARY SECTION  */
         B     @RC01096                                            1098
@RF01096 BAL   @14,SFSUM                                           1098
*   ELSE                                                           1099
*     DO;                                                  /*@0001VLS*/
         B     @RC01095                                            1099
@RF01095 DS    0H                                                  1100
*       RECCCHHR = TABCCHHR;          /* SET LOCATION OF RECORD      */
         L     @06,CURRPTR                                         1100
         MVC   RECCCHHR(5,R2),TABCCHHR(@06)                        1100
*       RESPECIFY (R15) RESTRICTED;                        /*@0001VLS*/
*       CALL IOHND(READIRCT);         /* GET A RECORD        @0001VLS*/
         L     @15,ADIOHND(,R2)                                    1102
         LA    @01,@AL01102                                        1102
         BALR  @14,@15                                             1102
*       RETCODE = R15;                /* RETURN CODE         @0001VLS*/
         ST    R15,RETCODE                                         1103
*       RESPECIFY (R15) UNRESTRICTED;                      /*@0001VLS*/
*       IF RETCODE = ZERO THEN                                     1105
         L     @06,RETCODE                                         1105
         LTR   @06,@06                                             1105
         BNZ   @RF01105                                            1105
*         DO;                                              /*@0001VLS*/
*           IF TYPE = ONE THEN                                     1107
         L     @06,CURRPTR                                         1107
         CLI   TYPE(@06),1                                         1107
         BNE   @RF01107                                            1107
*             IF DEVTYPE = NONSF  THEN   /*                  @D3503SG*/
         CLI   DEVTYPE(@06),X'00'                                  1108
         BNE   @RF01108                                            1108
*               CALL CUASTATS;        /* RECORD EXCEEDS THRESHOLD    */
         BAL   @14,CUASTATS                                        1109
*             ELSE                       /*                  @D3503SG*/
*               CALL SFSTATS;            /*                  @D3503SG*/
         B     @RC01108                                            1110
@RF01108 BAL   @14,SFSTATS                                         1110
*           ELSE                                                   1111
*             IF DEVTYPE = NONSF  THEN   /*                  @D3503SG*/
         B     @RC01107                                            1111
@RF01107 L     @06,CURRPTR                                         1111
         CLI   DEVTYPE(@06),X'00'                                  1111
         BNE   @RF01111                                            1111
*               CALL CUAPERMS;     /*RECORD IS PERM.ERROR-NON 8809DEV*/
         BAL   @14,CUAPERMS                                        1112
*             ELSE                       /*                  @D3503SG*/
*               CALL SFPERMS;      /*RECORD IS PERM.ERROR 8809DEV    */
         B     @RC01111                                            1113
@RF01111 BAL   @14,SFPERMS                                         1113
*             IF (RECTYP & FOXZERO) = MDRREC  THEN   /*      @D3503SG*/
@RC01111 DS    0H                                                  1114
@RC01107 MVC   @TS00001(1),RECTYP(R7)                              1114
         NI    @TS00001,X'F0'                                      1114
         CLI   @TS00001,X'90'                                      1114
         BNE   @RF01114                                            1114
*                CONTRVOL = SMVOLID;     /*MDR VOLID         @D3503SG*/
         L     @06,CURRPTR                                         1115
         MVI   CONTRVOL+6(@06),C' '                                1115
         MVC   CONTRVOL(6,@06),SMVOLID(R7)                         1115
*             ELSE                       /*                  @D3503SG*/
*                CONTRVOL = VOLID;       /*OBR VOLID         @D3503SG*/
         B     @RC01114                                            1116
@RF01114 L     @06,CURRPTR                                         1116
         MVI   CONTRVOL+6(@06),C' '                                1116
         MVC   CONTRVOL(6,@06),VOLID(R7)                           1116
*         END;                                             /*@0001VLS*/
*       ELSE                                                       1118
*         CONTRVOL = CONTRVOL && CONTRVOL;  /* ERROR - DO NOTHING    */
         B     @RC01105                                            1118
@RF01105 L     @06,CURRPTR                                         1118
         XC    CONTRVOL(7,@06),CONTRVOL(@06)                       1118
*     END;        /* DO TYPE ^= THREE                        @0001VLS*/
@RC01105 DS    0H                                                  1120
*  END;           /* DO CURRPTR LOOP                         @0001VLS*/
@RC01095 LA    @06,12                                              1120
         AL    @06,CURRPTR                                         1120
         ST    @06,CURRPTR                                         1120
@DE01092 L     @06,CURRPTR                                         1120
         CLC   EOTABLE(2,@06),@CB00261                             1120
         BNE   @DL01092                                            1120
*  CALL OUTTYPES;                                          /*@0001VLS*/
         BAL   @14,OUTTYPES                                        1121
*END;                                                      /*@0001VLS*/
@EL00022 DS    0H                                                  1122
@EF00022 DS    0H                                                  1122
@ER00022 LM    @14,@12,@SA00022                                    1122
         BR    @14                                                 1122
*/********************************************************************/
*/* OUTPUT THE ERROR CODES FOR PERMANENT ERRORS.             @0001VLS*/
*/********************************************************************/
*OUTCODES: PROC;                                           /*@0001VLS*/
OUTCODES STM   @14,@12,@SA00023                                    1123
*CALL PRINTIT;                           /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         1124
* OUTCODE(1) = ERRTABLE(1);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE                                1125
* OUTCODE(2) = ERRTABLE(2);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+34                          1126
* OUTCODE(3) = ERRTABLE(3);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+68                          1127
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1128
* OUTCODE(1) = ERRTABLE(4);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+102                            1129
* OUTCODE(2) = ERRTABLE(5);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+136                         1130
* OUTCODE(3) = ERRTABLE(6);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+170                         1131
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1132
* OUTCODE(1) = ERRTABLE(7);                                /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+204                            1133
* OUTCODE(2) = ERRTABLE(8);                                /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+238                         1134
* OUTCODE(3) = ERRTABLE(9);                                /*@0001VLS*/
         MVC   OUTCODE+80(34),ERRTABLE+272                         1135
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1136
* OUTCODE(1) = ERRTABLE(10);                               /*@0001VLS*/
         MVC   OUTCODE(34),ERRTABLE+306                            1137
* OUTCODE(2) = ERRTABLE(11);                               /*@0001VLS*/
         MVC   OUTCODE+40(34),ERRTABLE+340                         1138
* OUTCODE(3) = ERRTABLE(12);         /*WC-WRITE CURRENT CHK. @D3503SG*/
         MVC   OUTCODE+80(34),ERRTABLE+374                         1139
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1140
* CALL PRINTIT;                          /*                  @D3503SG*/
         BAL   @14,PRINTIT                                         1141
* MYLINCT = MYLINCT - SIX;                                 /*@0001VLS*/
         L     @06,MYLINCT                                         1142
         SL    @06,@CF00080                                        1142
         ST    @06,MYLINCT                                         1142
*END;                                                      /*@0001VLS*/
@EL00023 DS    0H                                                  1143
@EF00023 DS    0H                                                  1143
@ER00023 LM    @14,@12,@SA00023                                    1143
         BR    @14                                                 1143
*/********************************************************************/
*/* A SEARCH IS MADE FOR THE APPROPRIATE SET OF CPU/CONTROL UNIT CTRS*/
*/********************************************************************/
*FINDTOTS: PROC;                                           /*@0001VLS*/
FINDTOTS STM   @14,@12,@SA00024                                    1144
* FOUND = OFF;                        /* INIT SEARCH VARIABLE        */
         NI    FOUND,B'11011111'                                   1145
* SUMPTR = TOTALPTR;                                       /*@0001VLS*/
         L     @06,TOTALPTR                                        1146
         ST    @06,SUMPTR                                          1146
* DO WHILE (SUMPTR ^= ZERO & FOUND = OFF);                 /*@0001VLS*/
         B     @DE01147                                            1147
@DL01147 DS    0H                                                  1148
*   IF CHAIN = CPUCUX THEN                                         1148
         L     @06,SUMPTR                                          1148
         CLC   CHAIN(6),CPUCUX(@06)                                1148
         BNE   @RF01148                                            1148
*     FOUND = ON;                                          /*@0001VLS*/
         OI    FOUND,B'00100000'                                   1149
*   ELSE                                                           1150
*     DO;                                                  /*@0001VLS*/
         B     @RC01148                                            1150
@RF01148 DS    0H                                                  1151
*       Z = SUMPTR;                   /* SAVE THE POINTER TO LAST ONE*/
         L     @06,SUMPTR                                          1151
         ST    @06,Z                                               1151
*       SUMPTR = NEXTCPU;             /* NEXT ONE            @0001VLS*/
         L     @06,NEXTCPU(,@06)                                   1152
         ST    @06,SUMPTR                                          1152
*     END;                                                 /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@RC01148 DS    0H                                                  1154
@DE01147 L     @06,SUMPTR                                          1154
         LTR   @06,@06                                             1154
         BZ    @DC01147                                            1154
         TM    FOUND,B'00100000'                                   1154
         BZ    @DL01147                                            1154
@DC01147 DS    0H                                                  1155
* IF SUMPTR = ZERO THEN               /* MUST CREATE A NEW AREA      */
         L     @06,SUMPTR                                          1155
         LTR   @06,@06                                             1155
         BNZ   @RF01155                                            1155
*  DO;                                                     /*@0001VLS*/
*    RESPECIFY (R0,R15) RESTRICTED;                        /*@0001VLS*/
*    R0 = LENGTH(SUMAREA);            /* SIZE OF NEW AREA    @0001VLS*/
         LA    R0,910                                              1158
*    GEN(GETMAIN EC,LV=(0),A=SUMPTR);                      /*@0001VLS*/
         GETMAIN EC,LV=(0),A=SUMPTR
*    RETCODE = R15;                                        /*@0001VLS*/
         ST    R15,RETCODE                                         1160
*    RESPECIFY (R0,R15) UNRESTRICTED;                      /*@0001VLS*/
*    IF RETCODE = ZERO THEN                                        1162
         L     @06,RETCODE                                         1162
         LTR   @06,@06                                             1162
         BNZ   @RF01162                                            1162
*      DO;                                                 /*@0001VLS*/
*        DO I = ONE TO 16;                                 /*@0001VLS*/
         LA    @06,1                                               1164
         STH   @06,I                                               1164
@DL01164 DS    0H                                                  1165
*          SUMTEMP(I) = SUMTEMP(I) && SUMTEMP(I);   /* CLEAR AREA    */
         L     @15,SUMPTR                                          1165
         LR    @14,@06                                             1165
         MH    @14,@CH00727                                        1165
         ST    @14,@TF00001                                        1165
         ALR   @14,@15                                             1165
         AL    @14,@CF01754                                        1165
         XC    SUMTEMP-8(50,@14),SUMTEMP-8(@14)                    1165
*          FDATE(I,1:2) = EOT;                             /*@0001VLS*/
         AL    @15,@TF00001                                        1166
         AL    @15,@CF01757                                        1166
         MVC   FDATE-52(2,@15),@CB00261                            1166
*        END;                                              /*@0001VLS*/
         AL    @06,@CF00057                                        1167
         STH   @06,I                                               1167
         C     @06,@CF00088                                        1167
         BNH   @DL01164                                            1167
*        IF TOTALPTR = ZERO THEN                                   1168
         L     @06,TOTALPTR                                        1168
         LTR   @06,@06                                             1168
         BNZ   @RF01168                                            1168
*          TOTALPTR = SUMPTR;                              /*@0001VLS*/
         L     @06,SUMPTR                                          1169
         ST    @06,TOTALPTR                                        1169
*        ELSE                                                      1170
*          Z -> NEXTCPU = SUMPTR;                          /*@0001VLS*/
         B     @RC01168                                            1170
@RF01168 L     @06,SUMPTR                                          1170
         L     @01,Z                                               1170
         ST    @06,NEXTCPU(,@01)                                   1170
*        NEXTCPU = ZERO;                /* NOTHING IN CHAIN  @0001VLS*/
@RC01168 L     @06,SUMPTR                                          1171
         SLR   @15,@15                                             1171
         ST    @15,NEXTCPU(,@06)                                   1171
*        CPUCUX = CHAIN;                /* CPU SERIAL/MODEL CUA      */
         MVC   CPUCUX(6,@06),CHAIN                                 1172
*        CONTRCUA = CUX;                /* SORT TABLE ENTRY  @0001VLS*/
         L     @15,CURRPTR                                         1173
         MVC   CONTRCUA(2,@15),CUX(@06)                            1173
*        CPU = RECCPU;                  /* SORT TABLE CPU ENTRY      */
         MVC   CPU(3,@15),RECCPU                                   1174
*        TABCCHHR = SUMPTRC;            /* LOCATION OF SUMMARY AREA  */
         MVI   TABCCHHR+4(@15),C' '                                1175
         MVC   TABCCHHR(4,@15),SUMPTRC                             1175
*        TYPE = THREE;                                     /*@0001VLS*/
         MVI   TYPE(@15),X'03'                                     1176
*        DEVTYPE = RECDEV;               /*                  @D3503SG*/
         MVC   DEVTYPE(1,@15),RECDEV                               1177
*        NUMENT = NUMENT + ONE;                            /*@0001VLS*/
         LA    @14,1                                               1178
         AL    @14,NUMENT                                          1178
         ST    @14,NUMENT                                          1178
*        CURRPTR = CURRPTR - TWELVE;    /* DECREMENT TO NEXT ENTRY   */
         SL    @15,@CF00033                                        1179
         ST    @15,CURRPTR                                         1179
*        FDATE(CUAINDEX) = DATE(2:4);   /* FROM DATE         @0001VLS*/
         L     @15,CUAINDEX                                        1180
         MH    @15,@CH00727                                        1180
         ST    @15,@TF00001                                        1180
         ALR   @15,@06                                             1180
         AL    @15,@CF01757                                        1180
         MVC   FDATE-52(3,@15),DATE+1(R7)                          1180
*        TDATE(CUAINDEX) = DATE(2:4);   /* TO DATE           @0001VLS*/
         AL    @06,@TF00001                                        1181
         BCTR  @06,0                                               1181
         MVC   TDATE-55(3,@06),DATE+1(R7)                          1181
*      END;                                                /*@0001VLS*/
*    ELSE                                                          1183
*      DO;                                                 /*@0001VLS*/
         B     @RC01162                                            1183
@RF01162 DS    0H                                                  1184
*        CALL IFCMSG(53,ADDR(MSGADDR));                    /*@0001VLS*/
         LA    @06,MSGADDR                                         1184
         ST    @06,@AFTEMPS+4                                      1184
         L     @15,ADIFCMSG(,R2)                                   1184
         LA    @01,@AL01184                                        1184
         BALR  @14,@15                                             1184
*        CALL PRINTIT;                                     /*@0001VLS*/
         BAL   @14,PRINTIT                                         1185
*      END;                                                /*@0001VLS*/
*  END;                                                    /*@0001VLS*/
* END;                                                     /*@0001VLS*/
@EL00024 DS    0H                                                  1188
@EF00024 DS    0H                                                  1188
@ER00024 LM    @14,@12,@SA00024                                    1188
         BR    @14                                                 1188
*/********************************************************************/
*/*    THIS PROC WILL PRINT THE DEBUG COUNTS SAVE AT VARIOUS POINTS  */
*/*    THE COUNTS ARE ONLY FROM IFCTHRSH NOT CUA OR EEDIT    @0001VLS*/
*/********************************************************************/
*BUGDATA: PROC;               /* PRINT DEBUG16 DATA          @0001VLS*/
BUGDATA  STM   @14,@12,@SA00025                                    1189
*MSGADDR = BUG16;                /*MOVE THE DEBUG HEADING INTO BUFFER*/
         MVI   MSGADDR+31,C' '                                     1190
         MVC   MSGADDR+32(100),MSGADDR+31                          1190
         MVC   MSGADDR(31),BUG16                                   1190
*CALL PRINTIT;                   /*GO PRINT THE MESSAGE      @0001VLS*/
         BAL   @14,PRINTIT                                         1191
*CALL CONVBIN(TOTREC,BUG10);          /* TOTAL NUMBER OF RECORDS READ*/
         LA    @01,@AL01192                                        1192
         BAL   @14,CONVBIN                                         1192
*MSGADDR = BUG10;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+26,C' '                                     1193
         MVC   MSGADDR+27(105),MSGADDR+26                          1193
         MVC   MSGADDR(26),BUG10                                   1193
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1194
*CALL CONVBIN(OBRCT,BUG20);           /* NUMBER OF OBR RECORDS READ  */
         LA    @01,@AL01195                                        1195
         BAL   @14,CONVBIN                                         1195
*MSGADDR = BUG20;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+24,C' '                                     1196
         MVC   MSGADDR+25(107),MSGADDR+24                          1196
         MVC   MSGADDR(24),BUG20                                   1196
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1197
*CALL CONVBIN(MDRCT,BUG21);           /* NUMBER OF MDR RECORDS READ  */
         LA    @01,@AL01198                                        1198
         BAL   @14,CONVBIN                                         1198
*MSGADDR = BUG21;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+24,C' '                                     1199
         MVC   MSGADDR+25(107),MSGADDR+24                          1199
         MVC   MSGADDR(24),BUG21                                   1199
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1200
*CALL CONVBIN(NUMSHORT,BUG30);        /* NUMBER OF SHORT RECORDS     */
         LA    @01,@AL01201                                        1201
         BAL   @14,CONVBIN                                         1201
*MSGADDR = BUG30;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+36,C' '                                     1202
         MVC   MSGADDR+37(95),MSGADDR+36                           1202
         MVC   MSGADDR(36),BUG30                                   1202
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1203
*CALL CONVBIN(BADDEV,BUG31);          /* NUMBER OF NON-8003 DEVICES  */
         LA    @01,@AL01204                                        1204
         BAL   @14,CONVBIN                                         1204
*MSGADDR = BUG31;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+30,C' '                                     1205
         MVC   MSGADDR+31(101),MSGADDR+30                          1205
         MVC   MSGADDR(30),BUG31                                   1205
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1206
*CALL CONVBIN(BADDAY,BUG40);        /* NUM RECORDS FAILED DATE RANGE */
         LA    @01,@AL01207                                        1207
         BAL   @14,CONVBIN                                         1207
*MSGADDR = BUG40;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     1208
         MVC   MSGADDR+38(94),MSGADDR+37                           1208
         MVC   MSGADDR(37),BUG40                                   1208
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1209
*CALL CONVBIN(BADTIME,BUG50);       /* NUM RECORDS FAILED TIME RANGE */
         LA    @01,@AL01210                                        1210
         BAL   @14,CONVBIN                                         1210
*MSGADDR = BUG50;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     1211
         MVC   MSGADDR+38(94),MSGADDR+37                           1211
         MVC   MSGADDR(37),BUG50                                   1211
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1212
*CALL CONVBIN(DROP3RD,BUG60);       /* NUM RECORDS FAILED 3RD SHIFT  */
         LA    @01,@AL01213                                        1213
         BAL   @14,CONVBIN                                         1213
*MSGADDR = BUG60;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+33,C' '                                     1214
         MVC   MSGADDR+34(98),MSGADDR+33                           1214
         MVC   MSGADDR(33),BUG60                                   1214
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1215
*CALL CONVBIN(BADCPU,BUG70);        /* NUM RECORDS FAILED CPU SPECS  */
         LA    @01,@AL01216                                        1216
         BAL   @14,CONVBIN                                         1216
*MSGADDR = BUG70;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+35,C' '                                     1217
         MVC   MSGADDR+36(96),MSGADDR+35                           1217
         MVC   MSGADDR(35),BUG70                                   1217
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1218
*CALL CONVBIN(BADCUA,BUG80);        /* NUM RECORDS FAILED CUA RANGE  */
         LA    @01,@AL01219                                        1219
         BAL   @14,CONVBIN                                         1219
*MSGADDR = BUG80;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+35,C' '                                     1220
         MVC   MSGADDR+36(96),MSGADDR+35                           1220
         MVC   MSGADDR(35),BUG80                                   1220
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1221
*CALL CONVBIN(BADVOL,BUG90);        /* NUM RECORDS FAILED VOL SPECS  */
         LA    @01,@AL01222                                        1222
         BAL   @14,CONVBIN                                         1222
*MSGADDR = BUG90;             /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+37,C' '                                     1223
         MVC   MSGADDR+38(94),MSGADDR+37                           1223
         MVC   MSGADDR(37),BUG90                                   1223
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1224
*CALL CONVBIN(BADSER,BUG100);        /* NUM RECORDS FAILED DEVSER    */
         LA    @01,@AL01225                                        1225
         BAL   @14,CONVBIN                                         1225
*MSGADDR = BUG100;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+45,C' '                                     1226
         MVC   MSGADDR+46(86),MSGADDR+45                           1226
         MVC   MSGADDR(45),BUG100                                  1226
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1227
*CALL CONVBIN(SHAREMOD,BUG110);       /* NUM SHARE CHGS AS CONTROLLER*/
         LA    @01,@AL01228                                        1228
         BAL   @14,CONVBIN                                         1228
*MSGADDR = BUG110;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+66,C' '                                     1229
         MVC   MSGADDR+67(65),MSGADDR+66                           1229
         MVC   MSGADDR(66),BUG110                                  1229
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1230
*CALL CONVBIN(SHARECU,BUG120);        /* NUM SHARE CHGS AS CUA       */
         LA    @01,@AL01231                                        1231
         BAL   @14,CONVBIN                                         1231
*MSGADDR = BUG120;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+56,C' '                                     1232
         MVC   MSGADDR+57(75),MSGADDR+56                           1232
         MVC   MSGADDR(56),BUG120                                  1232
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1233
*CALL CONVBIN(EXCTHRES(1),BUG130);        /* NUM THRESHOLD EXCEEDS   */
         LA    @01,@AL01234                                        1234
         BAL   @14,CONVBIN                                         1234
*MSGADDR = BUG130;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+33,C' '                                     1235
         MVC   MSGADDR+34(98),MSGADDR+33                           1235
         MVC   MSGADDR(33),BUG130                                  1235
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1236
*CALL CONVBIN(EXCTHRES(2),BUG140);        /* NUM PERM ERRORS @0001VLS*/
         LA    @01,@AL01237                                        1237
         BAL   @14,CONVBIN                                         1237
*MSGADDR = BUG140;            /*MOVE THE MESSAGE TO THE PRINT BUFFER */
         MVI   MSGADDR+30,C' '                                     1238
         MVC   MSGADDR+31(101),MSGADDR+30                          1238
         MVC   MSGADDR(30),BUG140                                  1238
*CALL PRINTIT;                /*GO PRINT THE MESSAGE         @0001VLS*/
         BAL   @14,PRINTIT                                         1239
*END;                                                      /*@0001VLS*/
@EL00025 DS    0H                                                  1240
@EF00025 DS    0H                                                  1240
@ER00025 LM    @14,@12,@SA00025                                    1240
         BR    @14                                                 1240
*/*                                                          @0001VLS*/
*/* LOOK UP THE CUA IN THE SHARE TABLE FOR THE CONVERTED SHARE VALUE. *
*/* IF IT IS FOUND, RETURN THE CONVERTED VALUE IN NEW CUA. IF NOT,    *
*/* RETURN THE ORIGINAL VALUE IN NEWCUA.                     @0001VLS*/
*/*                                                          @0001VLS*/
*CUASHARE: PROC;                                           /*@0001VLS*/
CUASHARE STM   @14,@12,12(@13)                                     1241
*    VALIDSHR = OFF;                          /* TURN OFF FOR SEARCH  *
         NI    VALIDSHR,B'01111111'                                1242
*    SHR74CUA = RECCUA;                       /* CUA FOR COMPARISON   *
         MVC   SHR74CUA(2),RECCUA                                  1243
*    SHR74CPU = CPUIDENT;                     /* CPU FOR COMPARISON   *
         MVC   SHR74CPU(3),CPUIDENT(R7)                            1244
*    DO I = 1 TO SHARENUM BY 1 WHILE(VALIDSHR = OFF);      /*@0001VLS*/
         LA    @06,1                                               1245
         STH   @06,I                                               1245
         B     @DE01245                                            1245
@DL01245 TM    VALIDSHR,B'10000000'                                1245
         BNZ   @DC01245                                            1245
*      IF SHAREFLG(I)=LETTERS&SHR74CPU=SHARSERA(I) THEN            1246
         SLA   @06,4                                               1246
         L     @15,SHAREPTR(,R2)                                   1246
         ST    @06,@TF00001                                        1246
         ALR   @06,@15                                             1246
         AL    @06,@CF01762                                        1246
         CLC   SHAREFLG-2(1,@06),LETTERS                           1246
         BNE   @RF01246                                            1246
         LR    @06,@15                                             1246
         AL    @06,@TF00001                                        1246
         AL    @06,@CF01766                                        1246
         CLC   SHR74CPU(3),SHARSERA-10(@06)                        1246
         BNE   @RF01246                                            1246
*        IF SHR74CUA>=SHRCUAAL(I)&SHR74CUA<=SHRCUAAH(I) THEN       1247
         LR    @06,@15                                             1247
         AL    @06,@TF00001                                        1247
         AL    @06,@CF01771                                        1247
         CLC   SHR74CUA(2),SHRCUAAL-13(@06)                        1247
         BL    @RF01247                                            1247
         LR    @06,@15                                             1247
         AL    @06,@TF00001                                        1247
         BCTR  @06,0                                               1247
         CLC   SHR74CUA(2),SHRCUAAH-15(@06)                        1247
         BH    @RF01247                                            1247
*          DO;                                /* CUA ONLY.   @0001VLS*/
*            IF SHRCUAAL(I)^=SHRCUAAH(I) THEN                      1249
         LR    @06,@15                                             1249
         AL    @06,@TF00001                                        1249
         AL    @06,@CF01771                                        1249
         AL    @15,@TF00001                                        1249
         BCTR  @15,0                                               1249
         CLC   SHRCUAAL-13(2,@06),SHRCUAAH-15(@15)                 1249
         BE    @RF01249                                            1249
*              SHARECU=SHARECU+ONE;    /*CUA LEVEL CHANGE    @D3506GB*/
         LA    @06,1                                               1250
         AL    @06,SHARECU                                         1250
         ST    @06,SHARECU                                         1250
*            ELSE                                                  1251
*              SHAREMOD=SHAREMOD+ONE;  /*CONTROLLER LEVEL CHANGE      *
         B     @RC01249                                            1251
@RF01249 LA    @06,1                                               1251
         AL    @06,SHAREMOD                                        1251
         ST    @06,SHAREMOD                                        1251
*            RECCUA=SHRCUABL(I)+SHR74CUA-SHRCUAAL(I);      /*@D3506GB*/
@RC01249 LH    @06,I                                               1252
         SLA   @06,4                                               1252
         L     @15,SHAREPTR(,R2)                                   1252
         ST    @06,@TF00001                                        1252
         ALR   @06,@15                                             1252
         AL    @06,@CF01764                                        1252
         SLR   @14,@14                                             1252
         ICM   @14,3,SHRCUABL-6(@06)                               1252
         SLR   @06,@06                                             1252
         ICM   @06,3,SHR74CUA                                      1252
         ALR   @14,@06                                             1252
         LR    @06,@15                                             1252
         AL    @06,@TF00001                                        1252
         AL    @06,@CF01771                                        1252
         SLR   @09,@09                                             1252
         ICM   @09,3,SHRCUAAL-13(@06)                              1252
         SLR   @14,@09                                             1252
         STCM  @14,3,RECCUA                                        1252
*            RECCPU = SHARSERB(I);                         /*@0001VLS*/
         AL    @15,@TF00001                                        1253
         AL    @15,@CF01772                                        1253
         MVC   RECCPU(3),SHARSERB-3(@15)                           1253
*            VALIDSHR = ON;                                /*@0001VLS*/
         OI    VALIDSHR,B'10000000'                                1254
*          END;                                            /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
@RF01247 DS    0H                                                  1256
@RF01246 LA    @06,1                                               1256
         AH    @06,I                                               1256
         STH   @06,I                                               1256
@DE01245 L     @01,SHAREPTR(,R2)                                   1256
         CH    @06,SHARENUM(,@01)                                  1256
         BNH   @DL01245                                            1256
@DC01245 DS    0H                                                  1257
*    RETURN;                                               /*@0001VLS*/
@EL00026 DS    0H                                                  1257
@EF00026 DS    0H                                                  1257
@ER00026 LM    @14,@12,12(@13)                                     1257
         BR    @14                                                 1257
* END;                                                     /*@0001VLS*/
*/*                                                          @D3506GB*/
*/* LOOK UP THE CUA IN THE SHARE/CONTROLLER TABLE FOR A CONTROLLER    *
*/* ENTRY THAT MATCHES THE IMPUT VALUE AND THEN CONVERT. IF NO        *
*/* CONTROLLER VALUE IS FOUND CONVERT THE LOW END OF THE RANGE TO 0   *
*/*                                                          @D3506GB*/
*CONVCNTR: PROC;                                           /*@D3506GB*/
CONVCNTR STM   @14,@12,12(@13)                                     1259
*  VALIDCON=ON;                        /*SWITCH FOR VALID CUA RANGE   *
*  VALIDSHR=OFF;                       /*SWITCH FOR DO LOOP  @D3506GB*/
         OI    VALIDCON,B'00010000'                                1261
         NI    VALIDSHR,B'01111111'                                1261
*  IF SHAREPTR ^= 0 THEN                                           1262
         L     @06,SHAREPTR(,R2)                                   1262
         LTR   @06,@06                                             1262
         BZ    @RF01262                                            1262
*   DO I = 1 TO SHARENUM BY 1 WHILE(VALIDSHR=OFF);         /*@D3506GB*/
         LA    @06,1                                               1263
         STH   @06,I                                               1263
         B     @DE01263                                            1263
@DL01263 TM    VALIDSHR,B'10000000'                                1263
         BNZ   @DC01263                                            1263
*    IF SHAREFLG(I)=LETTERC THEN       /* TEST FOR CONTROLLER ENTRY   *
         SLA   @06,4                                               1264
         L     @15,SHAREPTR(,R2)                                   1264
         ST    @06,@TF00001                                        1264
         ALR   @06,@15                                             1264
         AL    @06,@CF01762                                        1264
         CLC   SHAREFLG-2(1,@06),LETTERC                           1264
         BNE   @RF01264                                            1264
*      IF RECCPU=SHARSERB(I) THEN      /*SAME CPU            @D3506GB*/
         LR    @06,@15                                             1265
         AL    @06,@TF00001                                        1265
         AL    @06,@CF01772                                        1265
         CLC   RECCPU(3),SHARSERB-3(@06)                           1265
         BNE   @RF01265                                            1265
*        IF RECCUA>=SHRCUABL(I) & RECCUA<=SHRCUABH(I) THEN         1266
         LR    @06,@15                                             1266
         AL    @06,@TF00001                                        1266
         AL    @06,@CF01764                                        1266
         CLC   RECCUA(2),SHRCUABL-6(@06)                           1266
         BL    @RF01266                                            1266
         LR    @06,@15                                             1266
         AL    @06,@TF00001                                        1266
         AL    @06,@CF01765                                        1266
         CLC   RECCUA(2),SHRCUABH-8(@06)                           1266
         BH    @RF01266                                            1266
*          IF SHRCUABH(I)-SHRCUABL(I)>DEC15 THEN                   1267
         LR    @06,@15                                             1267
         AL    @06,@TF00001                                        1267
         AL    @06,@CF01765                                        1267
         SLR   @14,@14                                             1267
         ICM   @14,3,SHRCUABH-8(@06)                               1267
         AL    @15,@TF00001                                        1267
         AL    @15,@CF01764                                        1267
         SLR   @06,@06                                             1267
         ICM   @06,3,SHRCUABL-6(@15)                               1267
         SLR   @14,@06                                             1267
         C     @14,@CF00032                                        1267
         BNH   @RF01267                                            1267
*            DO;                                           /*@D3506GB*/
*              LOWCUA=RECCUA&ZFFZ;     /*SET DEFAULT RANGE   @D3506GB*/
         MVC   LOWCUA(2),RECCUA                                    1269
         NC    LOWCUA(2),@CB00475                                  1269
*              HIGHCUA=RECCUA×ZZZF;                        /*@D3506GB*/
         MVC   HIGHCUA(2),RECCUA                                   1270
         OC    HIGHCUA(2),@CB00473                                 1270
*              VALIDCON=OFF;           /*ERROR IN CUA RANGE IN TABLE  *
*              VALIDSHR=ON;                                /*@D3506GB*/
         OI    VALIDSHR,B'10000000'                                1272
         NI    VALIDCON,B'11101111'                                1272
*            END;                                          /*@D3506GB*/
*          ELSE                        /*CUA RANGE IS VALID  @D3506GB*/
*            DO;                       /*CUA IN CORRECT RANGE         *
         B     @RC01267                                            1274
@RF01267 DS    0H                                                  1275
*              LOWCUA=SHRCUABL(I);     /*GET LOW END OF CONTROLLER    *
         LH    @06,I                                               1275
         SLA   @06,4                                               1275
         L     @15,SHAREPTR(,R2)                                   1275
         ST    @06,@TF00001                                        1275
         ALR   @06,@15                                             1275
         AL    @06,@CF01764                                        1275
         MVC   LOWCUA(2),SHRCUABL-6(@06)                           1275
*              HIGHCUA=SHRCUABH(I);    /*GET HIGH END OF CONTROLLER   *
         AL    @15,@TF00001                                        1276
         AL    @15,@CF01765                                        1276
         MVC   HIGHCUA(2),SHRCUABH-8(@15)                          1276
*              VALIDSHR=ON;                                /*@D3506GB*/
         OI    VALIDSHR,B'10000000'                                1277
*            END;                                          /*@D3506GB*/
*        ELSE;                         /*CUA NOT IN RANGE    @D3506GB*/
@RF01266 DS    0H                                                  1280
*      ELSE;                           /*CPU IS DIFFERENT    @D3506GB*/
@RF01265 DS    0H                                                  1281
*    ELSE;                             /*SHARE ENTRY         @D3506GB*/
@RF01264 DS    0H                                                  1282
*   END;                                                   /*@D3506GB*/
@RC01264 LA    @06,1                                               1282
         AH    @06,I                                               1282
         STH   @06,I                                               1282
@DE01263 L     @01,SHAREPTR(,R2)                                   1282
         CH    @06,SHARENUM(,@01)                                  1282
         BNH   @DL01263                                            1282
@DC01263 DS    0H                                                  1283
*  IF VALIDSHR=OFF THEN                /* CONTROLLER ENTRY MISSING    *
@RF01262 TM    VALIDSHR,B'10000000'                                1283
         BNZ   @RF01283                                            1283
*    DO;                                                   /*@D3506GB*/
*      LOWCUA=RECCUA&ZFFZ;             /* 0 LAST FOUR BITS   @D3506GB*/
         MVC   LOWCUA(2),RECCUA                                    1285
         NC    LOWCUA(2),@CB00475                                  1285
*      HIGHCUA=RECCUA×ZZZF;            /* SET LAST FOUR BITS TO 1     *
         MVC   HIGHCUA(2),RECCUA                                   1286
         OC    HIGHCUA(2),@CB00473                                 1286
*      DO I = 1 TO SHARENUM BY 1;                          /*@D3506GB*/
         LA    @06,1                                               1287
         STH   @06,I                                               1287
         B     @DE01287                                            1287
@DL01287 DS    0H                                                  1288
*         J = SHARENUM - I + ONE;   /*INDEX OF TABLE FROM BOTTOM*/ 1288
         LA    @15,1                                               1288
         L     @14,SHAREPTR(,R2)                                   1288
         LH    @09,SHARENUM(,@14)                                  1288
         SLR   @09,@06                                             1288
         ALR   @09,@15                                             1288
         STH   @09,J                                               1288
*         IF SHAREFLG(I) = LETTERC & RECCPU = SHARSERB(I) THEN     1289
         SLA   @06,4                                               1289
         ST    @06,@TF00001                                        1289
         ALR   @06,@14                                             1289
         AL    @06,@CF01762                                        1289
         CLC   SHAREFLG-2(1,@06),LETTERC                           1289
         BNE   @RF01289                                            1289
         LR    @06,@14                                             1289
         AL    @06,@TF00001                                        1289
         AL    @06,@CF01772                                        1289
         CLC   RECCPU(3),SHARSERB-3(@06)                           1289
         BNE   @RF01289                                            1289
*            IF LOWCUA >= SHRCUABL(I)&LOWCUA<=SHRCUABH(I) THEN     1290
         LR    @06,@14                                             1290
         AL    @06,@TF00001                                        1290
         AL    @06,@CF01764                                        1290
         CLC   LOWCUA(2),SHRCUABL-6(@06)                           1290
         BL    @RF01290                                            1290
         LR    @06,@14                                             1290
         AL    @06,@TF00001                                        1290
         AL    @06,@CF01765                                        1290
         CLC   LOWCUA(2),SHRCUABH-8(@06)                           1290
         BH    @RF01290                                            1290
*               LOWCUA = SHRCUABH(I) + HONE;               /*@D3506GB*/
         AL    @14,@TF00001                                        1291
         AL    @14,@CF01765                                        1291
         SLR   @06,@06                                             1291
         ICM   @06,3,SHRCUABH-8(@14)                               1291
         ALR   @15,@06                                             1291
         STCM  @15,3,LOWCUA                                        1291
*            ELSE;                                         /*@D3506GB*/
@RF01290 DS    0H                                                  1293
*         ELSE;                                            /*@D3506GB*/
@RF01289 DS    0H                                                  1294
*         IF SHAREFLG(J) = LETTERC & RECCPU = SHARSERB(J) THEN     1294
         LH    @06,J                                               1294
         SLA   @06,4                                               1294
         L     @15,SHAREPTR(,R2)                                   1294
         ST    @06,@TF00001                                        1294
         ALR   @06,@15                                             1294
         AL    @06,@CF01762                                        1294
         CLC   SHAREFLG-2(1,@06),LETTERC                           1294
         BNE   @RF01294                                            1294
         LR    @06,@15                                             1294
         AL    @06,@TF00001                                        1294
         AL    @06,@CF01772                                        1294
         CLC   RECCPU(3),SHARSERB-3(@06)                           1294
         BNE   @RF01294                                            1294
*            IF HIGHCUA>= SHRCUABL(J)&HIGHCUA<=SHRCUABH(J) THEN    1295
         LR    @06,@15                                             1295
         AL    @06,@TF00001                                        1295
         AL    @06,@CF01764                                        1295
         CLC   HIGHCUA(2),SHRCUABL-6(@06)                          1295
         BL    @RF01295                                            1295
         LR    @06,@15                                             1295
         AL    @06,@TF00001                                        1295
         AL    @06,@CF01765                                        1295
         CLC   HIGHCUA(2),SHRCUABH-8(@06)                          1295
         BH    @RF01295                                            1295
*               HIGHCUA = SHRCUABL(J) - HONE;              /*@D3506GB*/
         AL    @15,@TF00001                                        1296
         AL    @15,@CF01764                                        1296
         SLR   @06,@06                                             1296
         ICM   @06,3,SHRCUABL-6(@15)                               1296
         BCTR  @06,0                                               1296
         STCM  @06,3,HIGHCUA                                       1296
*            ELSE;                                         /*@D3506GB*/
@RF01295 DS    0H                                                  1298
*         ELSE;                                            /*@D3506GB*/
@RF01294 DS    0H                                                  1299
*      END;                                                /*@D3506GB*/
         LA    @06,1                                               1299
         AH    @06,I                                               1299
         STH   @06,I                                               1299
@DE01287 L     @01,SHAREPTR(,R2)                                   1299
         CH    @06,SHARENUM(,@01)                                  1299
         BNH   @DL01287                                            1299
*    END;                                                  /*@D3506GB*/
*  ELSE;                               /* CONTROLLER ENTRY FOUND      *
@RF01283 DS    0H                                                  1302
*END CONVCNTR;                                             /*@D3506GB*/
@EL00027 DS    0H                                                  1302
@EF00027 DS    0H                                                  1302
@ER00027 LM    @14,@12,12(@13)                                     1302
         BR    @14                                                 1302
*/*********************************************************************
*/* THIS PROC WILL SORT THE SHARE/CONTROL TABLE BASED ON THE BASE     *
*/* CPU/CUA.                                                 @D3506GB*/
*/*********************************************************************
*SORTSHAR: PROC;                                           /*@D3506GB*/
SORTSHAR STM   @14,@12,12(@13)                                     1303
*  DO J = 1 BY 1 TO SHARENUM - 1;                          /*@D3506GB*/
         LA    @06,1                                               1304
         STH   @06,J                                               1304
         B     @DE01304                                            1304
@DL01304 DS    0H                                                  1305
*     DO K = J + 1 BY 1 TO SHARENUM;                       /*@D3506GB*/
         AL    @06,@CF00057                                        1305
         STH   @06,K                                               1305
         B     @DE01305                                            1305
@DL01305 DS    0H                                                  1306
*        IF SHRBASE(J) > SHRBASE(K) THEN                           1306
         LH    @15,J                                               1306
         SLA   @15,4                                               1306
         L     @14,SHAREPTR(,R2)                                   1306
         SLA   @06,4                                               1306
         ST    @15,@TF00001                                        1306
         ALR   @15,@14                                             1306
         AL    @15,@CF01772                                        1306
         ST    @06,@TF00002                                        1306
         ALR   @06,@14                                             1306
         AL    @06,@CF01772                                        1306
         CLC   SHRBASE-3(7,@15),SHRBASE-3(@06)                     1306
         BNH   @RF01306                                            1306
*           DO;                                            /*@D3506GB*/
*              SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));        /*@D3506GB*/
         LR    @06,@14                                             1308
         AL    @06,@TF00001                                        1308
         AL    @06,@CF01762                                        1308
         LR    @15,@14                                             1308
         AL    @15,@TF00001                                        1308
         AL    @15,@CF01762                                        1308
         MVC   @TS00001(16),SHAREIO-2(@15)                         1308
         LR    @15,@14                                             1308
         AL    @15,@TF00002                                        1308
         AL    @15,@CF01762                                        1308
         XC    @TS00001(16),SHAREIO-2(@15)                         1308
         MVC   SHAREIO-2(16,@06),@TS00001                          1308
*              SHAREIO(K)=(SHAREIO(K)&&SHAREIO(J));        /*@D3506GB*/
         LR    @06,@14                                             1309
         AL    @06,@TF00002                                        1309
         AL    @06,@CF01762                                        1309
         LR    @15,@14                                             1309
         AL    @15,@TF00002                                        1309
         AL    @15,@CF01762                                        1309
         MVC   @TS00001(16),SHAREIO-2(@15)                         1309
         LR    @15,@14                                             1309
         AL    @15,@TF00001                                        1309
         AL    @15,@CF01762                                        1309
         XC    @TS00001(16),SHAREIO-2(@15)                         1309
         MVC   SHAREIO-2(16,@06),@TS00001                          1309
*              SHAREIO(J)=(SHAREIO(J)&&SHAREIO(K));        /*@D3506GB*/
         LR    @06,@14                                             1310
         AL    @06,@TF00001                                        1310
         AL    @06,@CF01762                                        1310
         LR    @15,@14                                             1310
         AL    @15,@TF00001                                        1310
         AL    @15,@CF01762                                        1310
         MVC   @TS00001(16),SHAREIO-2(@15)                         1310
         AL    @14,@TF00002                                        1310
         AL    @14,@CF01762                                        1310
         XC    @TS00001(16),SHAREIO-2(@14)                         1310
         MVC   SHAREIO-2(16,@06),@TS00001                          1310
*           END;                                           /*@D3506GB*/
*        ELSE;                                             /*@D3506GB*/
@RF01306 DS    0H                                                  1313
*     END;                                                 /*@D3506GB*/
         LA    @06,1                                               1313
         AH    @06,K                                               1313
         STH   @06,K                                               1313
@DE01305 L     @01,SHAREPTR(,R2)                                   1313
         CH    @06,SHARENUM(,@01)                                  1313
         BNH   @DL01305                                            1313
*  END;                                                    /*@D3506GB*/
         LA    @06,1                                               1314
         AH    @06,J                                               1314
         STH   @06,J                                               1314
@DE01304 L     @01,SHAREPTR(,R2)                                   1314
         LH    @15,SHARENUM(,@01)                                  1314
         BCTR  @15,0                                               1314
         CR    @06,@15                                             1314
         BNH   @DL01304                                            1314
*END SORTSHAR;                                             /*@D3506GB*/
@EL00028 DS    0H                                                  1315
@EF00028 DS    0H                                                  1315
@ER00028 LM    @14,@12,12(@13)                                     1315
         BR    @14                                                 1315
*/*                                                          @0001VLS*/
*/*****************************************************************/
*/*    THIS PROC WILL HEX DUMP THE SORT TABLE ENTRIES ONE/LINE    */
*DUMP: PROC;                                               /*@0001VLS*/
DUMP     STM   @14,@12,@SA00029                                    1316
* MSGDS = CHARS(2);              /* TOURIST DATA SET OUTPUT  @0001VLS*/
         MVC   MSGDS(1),CHARS+1                                    1317
* MSGADDR = BUG8;                                          /*@0001VLS*/
         MVI   MSGADDR+33,C' '                                     1318
         MVC   MSGADDR+34(98),MSGADDR+33                           1318
         MVC   MSGADDR(33),BUG8                                    1318
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1319
* DO Z = ONE BY ONE TO SORTNUM;                            /*@0001VLS*/
         LA    @06,1                                               1320
         ST    @06,Z                                               1320
         B     @DE01320                                            1320
@DL01320 DS    0H                                                  1321
*  CALL CONVERT(SORTTAB(Z),MSGADDR,TWELVE);                /*@0001VLS*/
         MVC   @AL00001+4(8),@AL01321                              1321
         MH    @06,@CH00033                                        1321
         L     @01,SORTADR(,R2)                                    1321
         AL    @01,@CF01763                                        1321
         LA    @06,SORTTAB(@06,@01)                                1321
         ST    @06,@AL00001                                        1321
         LA    @01,@AL00001                                        1321
         BAL   @14,CONVERT                                         1321
*  CALL PRINTIT;                 /*PRINT THIS ENTRY OF THE SORT TABLE*/
         BAL   @14,PRINTIT                                         1322
* END;                                                     /*@0001VLS*/
         LA    @06,1                                               1323
         AL    @06,Z                                               1323
         ST    @06,Z                                               1323
@DE01320 C     @06,SORTNUM(,R2)                                    1323
         BNH   @DL01320                                            1323
*END;                                                      /*@0001VLS*/
@EL00029 DS    0H                                                  1324
@EF00029 DS    0H                                                  1324
@ER00029 LM    @14,@12,@SA00029                                    1324
         BR    @14                                                 1324
*CONVBIN1: PROC(BWORD1,DADDR1);                            /*@0001VLS*/
CONVBIN1 STM   @14,@12,@SA00030                                    1325
         MVC   @PC00030(8),0(@01)                                  1325
* DCL  BWORD1 FIXED(8);                                    /*@0001VLS*/
* DCL  DADDR1 CHAR(20);                                    /*@0001VLS*/
* L = BWORD1;                                              /*@0001VLS*/
         L     @06,@PC00030                                        1328
         SLR   @15,@15                                             1328
         IC    @15,BWORD1(,@06)                                    1328
         ST    @15,L                                               1328
* CALL CONVBIN(L,DADDR1);                                  /*@0001VLS*/
         LA    @06,L                                               1329
         ST    @06,@AL00001                                        1329
         L     @06,@PC00030+4                                      1329
         ST    @06,@AL00001+4                                      1329
         LA    @01,@AL00001                                        1329
         BAL   @14,CONVBIN                                         1329
*END;                                                      /*@0001VLS*/
@EL00030 DS    0H                                                  1330
@EF00030 DS    0H                                                  1330
@ER00030 LM    @14,@12,@SA00030                                    1330
         BR    @14                                                 1330
*CONVBIN2: PROC(BWORD2,DADDR2);                            /*@0001VLS*/
CONVBIN2 STM   @14,@12,@SA00031                                    1331
         MVC   @PC00031(8),0(@01)                                  1331
* DCL  BWORD2 FIXED(15);                                   /*@0001VLS*/
* DCL  DADDR2 CHAR(20);                                    /*@0001VLS*/
* L = BWORD2;                                              /*@0001VLS*/
         L     @06,@PC00031                                        1334
         LH    @06,BWORD2(,@06)                                    1334
         ST    @06,L                                               1334
* CALL CONVBIN(L,DADDR2);                                  /*@0001VLS*/
         LA    @06,L                                               1335
         ST    @06,@AL00001                                        1335
         L     @06,@PC00031+4                                      1335
         ST    @06,@AL00001+4                                      1335
         LA    @01,@AL00001                                        1335
         BAL   @14,CONVBIN                                         1335
*END;                                                      /*@0001VLS*/
@EL00031 DS    0H                                                  1336
@EF00031 DS    0H                                                  1336
@ER00031 LM    @14,@12,@SA00031                                    1336
         BR    @14                                                 1336
*CONVBIN3: PROC(BWORD3,DADDR3);                            /*@0001VLS*/
CONVBIN3 STM   @14,@12,12(@13)                                     1337
         MVC   @PC00032(8),0(@01)                                  1337
* DCL  BWORD3 FIXED(32) UNSIGNED;                          /*@0001VLS*/
* DCL  DADDR3 CHAR(20);                                    /*@0001VLS*/
* CVD(BWORD3,DBLWORD);                                     /*@0001VLS*/
         L     @06,@PC00032                                        1340
         L     @06,BWORD3(,@06)                                    1340
         CVD   @06,DBLWORD                                         1340
* UNPK(WORK(1:8),DBLWORD);                                 /*@0001VLS*/
         UNPK  WORK(8),DBLWORD(8)                                  1341
* WORK(8) = WORK(8) × FOXZERO;                             /*@0001VLS*/
         OI    WORK+7,X'F0'                                        1342
* SWITCH1 = OFF;                                           /*@0001VLS*/
         NI    SWITCH1,B'10111111'                                 1343
* DO L = 1 BY 1 TO 7 WHILE(SWITCH1 = OFF);                 /*@0001VLS*/
         LA    @06,1                                               1344
         ST    @06,L                                               1344
@DL01344 TM    SWITCH1,B'01000000'                                 1344
         BNZ   @DC01344                                            1344
*  IF WORKOVER(L) = FOXZERO THEN /*REMOVE THE LEADING ZEROS  @0001VLS*/
         LA    @01,WORKOVER-1(@06)                                 1345
         CLI   0(@01),X'F0'                                        1345
         BNE   @RF01345                                            1345
*    WORKOVER(L) = BLANK;        /*REPLACE WITH A BLANK CHARACTER*/
         LA    @01,WORKOVER-1(@06)                                 1346
         MVI   0(@01),C' '                                         1346
*   ELSE                                                           1347
*    SWITCH1 = ON;               /*TELL LOOP THE END OF LEADING ZEROS*/
         B     @RC01345                                            1347
@RF01345 OI    SWITCH1,B'01000000'                                 1347
* END;                                                     /*@0001VLS*/
@RC01345 LA    @06,1                                               1348
         AL    @06,L                                               1348
         ST    @06,L                                               1348
         C     @06,@CF00082                                        1348
         BNH   @DL01344                                            1348
@DC01344 DS    0H                                                  1349
* DADDR3(1:8) = WORK(1:8);       /* MOVE THE DATA TO THE OUTPUT LINE */
         L     @06,@PC00032+4                                      1349
         MVC   DADDR3(8,@06),WORK                                  1349
*END;                                                      /*@0001VLS*/
@EL00032 DS    0H                                                  1350
@EF00032 DS    0H                                                  1350
@ER00032 LM    @14,@12,12(@13)                                     1350
         BR    @14                                                 1350
*CONVBIN: PROC(BINWORD,DECADDR);                           /*@0001VLS*/
CONVBIN  STM   @14,@12,12(@13)                                     1351
         MVC   @PC00033(8),0(@01)                                  1351
* DCL  BINWORD FIXED(31);                                  /*@0001VLS*/
* DCL  DECADDR CHAR(20);                                   /*@0001VLS*/
* RESPECIFY (R8) RESTRICTED;                               /*@0001VLS*/
* R8 = BINWORD;                  /*LOAD THE ITEM TO CONVERT  @0001VLS*/
         L     @06,@PC00033                                        1355
         L     R8,BINWORD(,@06)                                    1355
* CVD(R8,DBLWORD);                                         /*@0001VLS*/
         CVD   R8,DBLWORD                                          1356
* UNPK(WORK(1:8),DBLWORD);                                 /*@0001VLS*/
         UNPK  WORK(8),DBLWORD(8)                                  1357
* WORK(8) = WORK(8) × FOXZERO;                             /*@0001VLS*/
         OI    WORK+7,X'F0'                                        1358
* SWITCH1 = OFF;                                           /*@0001VLS*/
         NI    SWITCH1,B'10111111'                                 1359
* DO L = 1 BY 1 TO 7 WHILE(SWITCH1 = OFF);                 /*@0001VLS*/
         LA    @09,1                                               1360
         ST    @09,L                                               1360
@DL01360 TM    SWITCH1,B'01000000'                                 1360
         BNZ   @DC01360                                            1360
*  IF WORKOVER(L) = FOXZERO THEN /*REMOVE THE LEADING ZEROS  @0001VLS*/
         LA    @06,WORKOVER-1(@09)                                 1361
         CLI   0(@06),X'F0'                                        1361
         BNE   @RF01361                                            1361
*    WORKOVER(L) = BLANK;        /*REPLACE WITH A BLANK CHARACTER*/
         LA    @06,WORKOVER-1(@09)                                 1362
         MVI   0(@06),C' '                                         1362
*   ELSE                                                           1363
*    SWITCH1 = ON;               /*TELL LOOP THE END OF LEADING ZEROS*/
         B     @RC01361                                            1363
@RF01361 OI    SWITCH1,B'01000000'                                 1363
* END;                                                     /*@0001VLS*/
@RC01361 LA    @09,1                                               1364
         AL    @09,L                                               1364
         ST    @09,L                                               1364
         C     @09,@CF00082                                        1364
         BNH   @DL01360                                            1364
@DC01360 DS    0H                                                  1365
* DECADDR(1:5) = WORK(4:8);      /* MOVE THE DATA TO THE OUTPUT LINE */
         L     @09,@PC00033+4                                      1365
         MVC   DECADDR(5,@09),WORK+3                               1365
* RESPECIFY (R8) UNRESTRICTED;                             /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00033 DS    0H                                                  1367
@EF00033 DS    0H                                                  1367
@ER00033 LM    @14,@12,12(@13)                                     1367
         BR    @14                                                 1367
*PRINTIT: PROC;                /*SET UP LINKAGE FOR I/O TO PRINT LINE*/
PRINTIT  STM   @14,@12,@SA00034                                    1368
* IF DEBUG27 = OFF THEN                                            1369
         TM    DEBUG27(R2),B'00010000'                             1369
         BNZ   @RF01369                                            1369
*   DO;                                  /*                  @D3503SG*/
*     PRINTADR = ADDR(MESSAGE);     /*TELL I/O ADDRESS OF OUT BUFFER*/
         LA    @06,MESSAGE                                         1371
         ST    @06,PRINTADR(,R2)                                   1371
*     CALL IOHND(RITEPRTR);    /*PASS CONTROL TO I/O TO PRINT MESSAGE*/
         L     @15,ADIOHND(,R2)                                    1372
         LA    @01,@AL01372                                        1372
         BALR  @14,@15                                             1372
*   END;                                 /*                  @D3503SG*/
*END;                                                      /*@0001VLS*/
@EL00034 DS    0H                                                  1374
@EF00034 DS    0H                                                  1374
@ER00034 LM    @14,@12,@SA00034                                    1374
         BR    @14                                                 1374
* /*                                                         @0001VLS*/
* /* CONVERT CHARACTERS TO PRINTABLE                         @0001VLS*/
* /*                                                         @0001VLS*/
*CONVERT: PROC(NEXTBYTE,ADDNUM,LENNUM);                    /*@0001VLS*/
CONVERT  STM   @14,@12,12(@13)                                     1375
         MVC   @PC00035(12),0(@01)                                 1375
* DCL NEXTBYTE  CHAR(11);                                  /*@0001VLS*/
* DCL ADDNUM    CHAR(133);                                 /*@0001VLS*/
* DCL LENNUM    FIXED(31);        /* HOW MUCH TO CONVERT     @0001VLS*/
* RESPECIFY (R8,R9) RESTRICTED;                            /*@0001VLS*/
* DO P = LENNUM BY -1 TO ONE;                              /*@0001VLS*/
         L     @06,@PC00035+8                                      1380
         L     @06,LENNUM(,@06)                                    1380
         ST    @06,P                                               1380
         B     @DE01380                                            1380
@DL01380 DS    0H                                                  1381
*  R8 = NEXTBYTE(P);              /* LOAD THE NEXT BYTE      @0001VLS*/
         L     @15,@PC00035                                        1381
         BCTR  @15,0                                               1381
         SLR   R8,R8                                               1381
         IC    R8,NEXTBYTE(@06,@15)                                1381
*  X = TWO * P;                   /* INDEX FOR STORING CONVERTED 1/2 */
         LR    @15,@06                                             1382
         ALR   @15,@15                                             1382
         ST    @15,X                                               1382
*                                 /* BYTE.  INPUT IS 2 CHARS @0001VLS*/
*  SRDL(R8,FOUR);                 /* SPLIT THE BYTE IN HALF  @0001VLS*/
         SRDL  R8,4                                                1383
*  SRL(R9,28);                    /* RIGHT JUSTIFY SPLIT HALF BYTE   */
         SRL   R9,28                                               1384
*  R9 = R9 + ONE;                                          /*@0001VLS*/
         LA    @14,1                                               1385
         ALR   R9,@14                                              1385
*  R8 = R8 + ONE;                                          /*@0001VLS*/
         ALR   R8,@14                                              1386
*  ADDNUM(X-ONE) = CHARS(R8);     /* CHARS IS 16 CHAR STRING FOR     */
         L     @14,@PC00035+4                                      1387
         ALR   @15,@14                                             1387
         BCTR  @15,0                                               1387
         BCTR  @15,0                                               1387
         LA    @01,CHARS-1(R8)                                     1387
         MVC   ADDNUM(1,@15),0(@01)                                1387
*  ADDNUM(X)     = CHARS(R9);     /* CONVERTINAG HEX NUMS TO PRINT   */
         L     @15,X                                               1388
         ALR   @14,@15                                             1388
         BCTR  @14,0                                               1388
         LA    @15,CHARS-1(R9)                                     1388
         MVC   ADDNUM(1,@14),0(@15)                                1388
* END;                                                     /*@0001VLS*/
         BCTR  @06,0                                               1389
         ST    @06,P                                               1389
@DE01380 LTR   @06,@06                                             1389
         BP    @DL01380                                            1389
*END;                                                      /*@0001VLS*/
@EL00035 DS    0H                                                  1390
@EF00035 DS    0H                                                  1390
@ER00035 LM    @14,@12,12(@13)                                     1390
         BR    @14                                                 1390
*RESPECIFY (R8,R9) UNRESTRICTED;                           /*@0001VLS*/
* /*                                                         @0001VLS*/
* /* CALCULATE THE PERCENTAGE FOR THE TEMPORARY SUMMARY      @0001VLS*/
* /*                                                         @0001VLS*/
*CALCPERC: PROC(DIVEND,DIVSOR,OUTLOC);                     /*@0001VLS*/
CALCPERC STM   @14,@12,@SA00036                                    1392
         MVC   @PC00036(12),0(@01)                                 1392
* DCL DIVEND    FIXED(31);        /* DIVIDEND                @0001VLS*/
* DCL DIVSOR    FIXED(32) UNSIGNED;  /* DIVISOR              @0001VLS*/
* DCL OUTLOC    CHAR(5);          /* OUTPUT LOCATION         @0001VLS*/
* /* Z = (DIVEND * 200000 * 100) / DIVSOR                    @0001VLS*/
* RESPECIFY (R8,R9) RESTRICTED;                            /*@0001VLS*/
* R8 = ZERO;                      /* CLEAR HIGH ORDER PART OF REGS   */
         SLR   R8,R8                                               1397
* R9 = DIVEND;                    /* MULTIPLICAND            @0001VLS*/
         L     @06,@PC00036                                        1398
         L     R9,DIVEND(,@06)                                     1398
* R7 = 10000000;                  /* MULTIPLIER              @ZA34987*/
         L     R7,@CF01690                                         1399
* GEN (MR R8,R7);                 /* PRODUCT/DIVIDEND        @0001VLS*/
         MR R8,R7
* R7 = DIVSOR;                    /* DIVISOR                 @0001VLS*/
         L     @15,@PC00036+4                                      1401
         L     R7,DIVSOR(,@15)                                     1401
* GEN (DR R8,R7);                                          /*@0001VLS*/
         DR R8,R7
* Z = R9;                         /* QUOTIENT                @0001VLS*/
         ST    R9,Z                                                1403
* RESPECIFY (R8,R9) UNRESTRICTED;                          /*@0001VLS*/
* IF Z >= 10000 THEN                                               1405
         L     @06,Z                                               1405
         C     @06,@CF01691                                        1405
         BL    @RF01405                                            1405
*   OUTLOC = HUNDPLUS;            /* OVER 100 PERCENT        @0001VLS*/
         L     @06,@PC00036+8                                      1406
         MVC   OUTLOC(5,@06),@CC00520                              1406
* ELSE                                                             1407
*   DO;                                                    /*@0001VLS*/
         B     @RC01405                                            1407
@RF01405 DS    0H                                                  1408
*     CVD (Z,DBLWORD);                                     /*@0001VLS*/
         L     @06,Z                                               1408
         CVD   @06,DBLWORD                                         1408
*     UNPK (TEMPAREA(1:8),DBLWORD);                        /*@0001VLS*/
         UNPK  TEMPAREA(8),DBLWORD(8)                              1409
*     TEMPAREA(8) = TEMPAREA(8) × FOXZERO;                 /*@0001VLS*/
         OI    TEMPAREA+7,X'F0'                                    1410
*     IF TEMPAREA(5) = FOXZERO THEN                                1411
         CLI   TEMPAREA+4,X'F0'                                    1411
         BNE   @RF01411                                            1411
*       TEMPAREA(5) = BLANK;        /* CHANGE LEADING ZERO TO BLANK  */
         MVI   TEMPAREA+4,C' '                                     1412
*     OUTLOC(1:2) = TEMPAREA(5:6);  /* TENS AND UNITS DIGITS @0001VLS*/
@RF01411 L     @06,@PC00036+8                                      1413
         MVC   OUTLOC(2,@06),TEMPAREA+4                            1413
*     OUTLOC(3) = PERIOD;                                  /*@0001VLS*/
         MVI   OUTLOC+2(@06),C'.'                                  1414
*     OUTLOC(4:5) = TEMPAREA(7:8);  /* TENTHS AND HUNDREDTHS @0001VLS*/
         MVC   OUTLOC+3(2,@06),TEMPAREA+6                          1415
*   END;                                                   /*@0001VLS*/
* END CALCPERC;                                            /*@0001VLS*/
@EL00036 DS    0H                                                  1417
@EF00036 DS    0H                                                  1417
@ER00036 LM    @14,@12,@SA00036                                    1417
         BR    @14                                                 1417
*/********************************************************************/
*/*                                                          @D3503SG*/
*/*  TEST INPUT DEVICE CODES. IS THIS DEVICE TO BE USED      @D3503SG*/
*/*       IN THIS REPORT                                     @D3503SG*/
*/*                                                          @D3503SG*/
*/********************************************************************/
*DEVCHK:  PROC;                        /*                    @D3503SG*/
DEVCHK   STM   @14,@12,12(@13)                                     1418
*CHKCDE = OFF;                         /*                    @D3503SG*/
         NI    CHKCDE,B'01111111'                                  1419
*IF POBR = ON & (RECTYP & FOXZERO) = OBRREC  THEN          /*@D3503SG*/
         TM    POBR(R2),B'00100000'                                1420
         BNO   @RF01420                                            1420
         MVC   @TS00001(1),RECTYP(R7)                              1420
         NI    @TS00001,X'F0'                                      1420
         CLI   @TS00001,X'30'                                      1420
         BNE   @RF01420                                            1420
*  DO;                                   /*                  @D3503SG*/
*    OBRCT = OBRCT + ONE;              /*COUNT OBR RECORDS   @D3503SG*/
         LA    @06,1                                               1422
         AL    @06,OBRCT                                           1422
         ST    @06,OBRCT                                           1422
*    IF DEV2 = OBRDEV  THEN              /*8809 DEVICE ?     @D3503SG*/
         CLC   DEV2(2,R7),@CB00547                                 1423
         BNE   @RF01423                                            1423
*      DEVCODE = SFOBR;                  /*YES-8809 OBR      @D3503SG*/
         MVI   DEVCODE,X'01'                                       1424
*    ELSE                                /*                  @D3503SG*/
*      DEVCODE = NONSF;                  /*N0-3410 OBR       @D3503SG*/
         B     @RC01423                                            1425
@RF01423 MVI   DEVCODE,X'00'                                       1425
*    IF DEVPTR ^= ZERO  THEN           /* ENTRIES IN TABLE ? @D3503SG*/
@RC01423 L     @06,DEVPTR(,R2)                                     1426
         LTR   @06,@06                                             1426
         BZ    @RF01426                                            1426
*      DO I = 1 TO DEVNUM BY 1;        /* LOOP DEVICE TABLE  @D3503SG*/
         LA    @06,1                                               1427
         STH   @06,I                                               1427
         B     @DE01427                                            1427
@DL01427 DS    0H                                                  1428
*        IF DEVVAL(I) = DEV2  THEN     /*OBR TYPE DEVICE?    @D3503SG*/
         ALR   @06,@06                                             1428
         L     @01,DEVPTR(,R2)                                     1428
         ALR   @01,@06                                             1428
         CLC   DEVVAL-2(2,@01),DEV2(R7)                            1428
         BNE   @RF01428                                            1428
*          CHKCDE = ON;                  /*YES               @D3503SG*/
         OI    CHKCDE,B'10000000'                                  1429
*      END;                           /*DO LOOP              @D3503SG*/
@RF01428 LA    @06,1                                               1430
         AH    @06,I                                               1430
         STH   @06,I                                               1430
@DE01427 L     @01,DEVPTR(,R2)                                     1430
         CH    @06,DEVNUM(,@01)                                    1430
         BNH   @DL01427                                            1430
*    ELSE                             /*RECORD REQUESTED     @D3503SG*/
*      CHKCDE = ON;                   /*NO DEVICES SPEC'D.   @D3503SG*/
         B     @RC01426                                            1431
@RF01426 OI    CHKCDE,B'10000000'                                  1431
*  END;          /*END OBR DEVICE                            @D3503SG*/
*ELSE                                                      /*@D3503SG*/
*  DO;                                   /*                  @D3503SG*/
         B     @RC01420                                            1433
@RF01420 DS    0H                                                  1434
*    IF PTTYP = ON & (RECTYP & FOXZERO) = MDRREC  THEN     /*@D3503SG*/
         TM    PTTYP(R2),B'10000000'                               1434
         BNO   @RF01434                                            1434
         MVC   @TS00001(1),RECTYP(R7)                              1434
         NI    @TS00001,X'F0'                                      1434
         CLI   @TS00001,X'90'                                      1434
         BNE   @RF01434                                            1434
*      DO;                               /*                  @D3503SG*/
*        DEVCODE = SFMDR;                /*SET MDR TYPE      @D3503SG*/
         MVI   DEVCODE,X'02'                                       1436
*        IF DEVPTR ^= ZERO  THEN         /*ANY ENTRIES ?     @D3503SG*/
         L     @06,DEVPTR(,R2)                                     1437
         LTR   @06,@06                                             1437
         BZ    @RF01437                                            1437
*          DO I = 1 TO MDRNUM BY 1;      /*YES CHECK DEVICES @D3503SG*/
         LA    @06,1                                               1438
         STH   @06,I                                               1438
         B     @DE01438                                            1438
@DL01438 DS    0H                                                  1439
*            IF MDRVAL(I) = SMDEV  THEN  /*MDR TYPE DEVICE?  @D3503SG*/
         L     @01,DEVPTR(,R2)                                     1439
         ALR   @01,@06                                             1439
         CLC   MDRVAL-1(1,@01),SMDEV(R7)                           1439
         BNE   @RF01439                                            1439
*              CHKCDE = ON;              /*YES SET GOOD ONE  @D3503SG*/
         OI    CHKCDE,B'10000000'                                  1440
*          END;                          /*                  @D3503SG*/
@RF01439 LA    @06,1                                               1441
         AH    @06,I                                               1441
         STH   @06,I                                               1441
@DE01438 L     @01,DEVPTR(,R2)                                     1441
         CH    @06,MDRNUM(,@01)                                    1441
         BNH   @DL01438                                            1441
*        ELSE                            /*                  @D3503SG*/
*          CHKCDE = ON;                  /*NO DEVICES SPEC'D @D3503SG*/
         B     @RC01437                                            1442
@RF01437 OI    CHKCDE,B'10000000'                                  1442
*      END;        /*END MDR DEVICE                          @D3503SG*/
*    ELSE                                /*                  @D3503SG*/
*      BADREC = BADREC + ONE;     /*COUNT NON MDR/OBR RECORDS@D3503SG*/
         B     @RC01434                                            1444
@RF01434 LA    @06,1                                               1444
         AL    @06,BADREC                                          1444
         ST    @06,BADREC                                          1444
*  END;       /*END MDR/OBR DEVICE                           @D3503SG*/
*END DEVCHK;                             /*                  @D3503SG*/
@EL00037 DS    0H                                                  1446
@EF00037 DS    0H                                                  1446
@ER00037 LM    @14,@12,12(@13)                                     1446
         BR    @14                                                 1446
*/* THE RECORD IS PASSED AGAINST THE FILTERING CRITERIA SET UP BY THE*/
*/* PARAMETER ROUTINE.                                       @0001VLS*/
*/*                                                          @0001VLS*/
*FILTER: PROC;                                             /*@0001VLS*/
FILTER   STM   @14,@12,@SA00038                                    1447
* DCL TEMPVOL CHAR(6);                   /*WORK VOLUME ID.   @D3503SG*/
* DCL TEMPCUA CHAR(2);                   /*WORK CUA.#        @D3503SG*/
*  TOTREC = TOTREC + ONE;         /* KEEP TRACK OF TOTAL RECORDS READ*/
         LA    @06,1                                               1450
         AL    @06,TOTREC                                          1450
         ST    @06,TOTREC                                          1450
*  PASSFLAG = OFF;                /* ASSUME THE RECORD WILL FAIL     */
         NI    PASSFLAG(R2),B'11111110'                            1451
*  CALL DEVCHK;            /*DEVICE USED BY THIS     @D3503SG*/    1452
         BAL   @14,DEVCHK                                          1452
*  IF CHKCDE = ON   THEN        /*REPORT ?           @D3503SG*/    1453
         TM    CHKCDE,B'10000000'                                  1453
         BNO   @RF01453                                            1453
*    DO;                                           /*@0001VLS*/    1454
*      IF SHORT = OFF THEN        /* IF SHORT RECORD, THEN DISCARD   */
         TM    SHORT(R7),B'00100000'                               1455
         BNZ   @RF01455                                            1455
*        DO;                                               /*@0001VLS*/
*          IF DATE >= STDATE &            /* IS DATE IN RANGE    */
*            DATE <= ENDDATE THEN                                  1457
         CLC   DATE(4,R7),STDATE(R2)                               1457
         BL    @RF01457                                            1457
         CLC   DATE(4,R7),ENDDATE(R2)                              1457
         BH    @RF01457                                            1457
*            DO;                                       /*@0001VLS*/
*              IF (TIME >= STTIME1 & TIME <= ENDTIME1) ×           1459
*                 (TIME >= STTIME2 & TIME <= ENDTIME2)  THEN       1459
         CLC   TIME(4,R7),STTIME1(R2)                              1459
         BL    @GL00025                                            1459
         CLC   TIME(4,R7),ENDTIME1(R2)                             1459
         BNH   @RT01459                                            1459
@GL00025 CLC   TIME(4,R7),STTIME2(R2)                              1459
         BL    @RF01459                                            1459
         CLC   TIME(4,R7),ENDTIME2(R2)                             1459
         BH    @RF01459                                            1459
@RT01459 DS    0H                                                  1460
*                DO;                                   /*@0001VLS*/
*                  IF SHIFT3RD = ON &                              1461
*                     ((DATE = STDATE & TIME < STTIME1) ×          1461
*                     (DATE = ENDDATE & TIME > ENDTIME2)) THEN     1461
         TM    SHIFT3RD(R2),B'00010000'                            1461
         BNO   @RF01461                                            1461
         CLC   DATE(4,R7),STDATE(R2)                               1461
         BNE   @GL00029                                            1461
         CLC   TIME(4,R7),STTIME1(R2)                              1461
         BL    @RT01461                                            1461
@GL00029 CLC   DATE(4,R7),ENDDATE(R2)                              1461
         BNE   @RF01461                                            1461
         CLC   TIME(4,R7),ENDTIME2(R2)                             1461
         BNH   @RF01461                                            1461
@RT01461 DS    0H                                                  1462
*                        DROP3RD = DROP3RD + ONE; /* NUM FAIL TIME  */
         LA    @06,1                                               1462
         AL    @06,DROP3RD                                         1462
         ST    @06,DROP3RD                                         1462
*                  ELSE                                            1463
*                        PASSFLAG = ON;       /* SET FLAG TO PASS RCD*/
         B     @RC01461                                            1463
@RF01461 OI    PASSFLAG(R2),B'00000001'                            1463
*                END;                      /*@0001VLS*/            1464
*              ELSE                                                1465
*                BADTIME = BADTIME + ONE;     /* # OF REC OUT OF TIME*/
         B     @RC01459                                            1465
@RF01459 LA    @06,1                                               1465
         AL    @06,BADTIME                                         1465
         ST    @06,BADTIME                                         1465
*            END;     /*DATE CHECK                           @0001VLS*/
*          ELSE                                                    1467
*            BADDAY = BADDAY + ONE;       /* # OF REC FAILING DAY*/
         B     @RC01457                                            1467
@RF01457 LA    @06,1                                               1467
         AL    @06,BADDAY                                          1467
         ST    @06,BADDAY                                          1467
*        END;                                          /*@0001VLS*/
*      ELSE                                                        1469
*        NUMSHORT = NUMSHORT + ONE;     /* OBR WITH SHORT SW ON */ 1469
         B     @RC01455                                            1469
@RF01455 LA    @06,1                                               1469
         AL    @06,NUMSHORT                                        1469
         ST    @06,NUMSHORT                                        1469
*    END;                                                /*@0001VLS*/
*  ELSE                                                            1471
*    BADDEV = BADDEV + ONE;               /*NOT 80XX RECORD          */
         B     @RC01453                                            1471
@RF01453 LA    @06,1                                               1471
         AL    @06,BADDEV                                          1471
         ST    @06,BADDEV                                          1471
*  VALIDCUA = OFF;                                         /*@0001VLS*/
@RC01453 NI    VALIDCUA,B'10111111'                                1472
*  VALIDCPU = OFF;                                         /*@0001VLS*/
*  VALIDSER = OFF;                                         /*@0001VLS*/
         NI    VALIDCPU,B'11111100'                                1474
*  VALIDVOL = OFF;                                         /*@0001VLS*/
         NI    VALIDVOL,B'11011111'                                1475
*  IF PASSFLAG = YES THEN                 /* ALLOW RECORD TO CONTINUE*/
         TM    PASSFLAG(R2),B'00000001'                            1476
         BNO   @RF01476                                            1476
*    DO;                                                   /*@0001VLS*/
*      IF (RECTYP & FOXZERO) = MDRREC  THEN   /* MDR RECORD  @D3503SG*/
         MVC   @TS00001(1),RECTYP(R7)                              1478
         NI    @TS00001,X'F0'                                      1478
         CLI   @TS00001,X'90'                                      1478
         BNE   @RF01478                                            1478
*        DO;                             /*                  @D3503SG*/
*          TEMPVOL = SMVOLID;            /*SAVE VOLUME ID.   @D3503SG*/
         MVC   TEMPVOL(6),SMVOLID(R7)                              1480
*          TEMPCUA = SMCUA;              /*SAVE CUA #        @D3503SG*/
         MVC   TEMPCUA(2),SMCUA(R7)                                1481
*        END;                            /*                  @D3503SG*/
*      ELSE                              /*                  @D3503SG*/
*        DO;                             /* OBR RECORD       @D3503SG*/
         B     @RC01478                                            1483
@RF01478 DS    0H                                                  1484
*          TEMPVOL = VOLID;              /*SAVE VOLUME ID.   @D3503SG*/
         MVC   TEMPVOL(6),VOLID(R7)                                1484
*          TEMPCUA = OCUA2;              /*SAVE CUA#         @D3503SG*/
         MVC   TEMPCUA(2),OCUA2(R7)                                1485
*        END;                            /*                  @D3503SG*/
*      /*                                                    @0001VLS*/
*      /* THIS SECTION OF CODE COMPARES THE OBR JUST READ WITH THE   */
*      /* PARAMETERS BUILT BY THE PARAM ROUTINE.             @0001VLS*/
*      /* IF NO CUA WAS SPECIFIED, THE POINTER TO THE CUA TABLE WILL */
*      /* BE ZERO.  IF IT IS NOT, THEN A MAXIMUM OF SIXTEEN SINGLE   */
*      /* OR RANGE CUAS MUST BE COMPARED WITH THE CUA IN THE RECORD. */
*      /*                                                    @0001VLS*/
*      IF CUAPTR ^= ZERO THEN               /* ARE ALL CUA'S WANTED  */
@RC01478 L     @06,CUAPTR(,R2)                                     1487
         LTR   @06,@06                                             1487
         BZ    @RF01487                                            1487
*        DO I = 1 TO CUANUM BY 1 WHILE (VALIDCUA = OFF);   /*@0001VLS*/
         LA    @06,1                                               1488
         STH   @06,I                                               1488
         B     @DE01488                                            1488
@DL01488 TM    VALIDCUA,B'01000000'                                1488
         BNZ   @DC01488                                            1488
*          IF TEMPCUA >= CUA1(I) &          /* DOES THE CUA LIE IN   */
*             TEMPCUA <= CUA2(I) THEN       /* RANGE SPECIFIED       */
         SLA   @06,2                                               1489
         L     @15,CUAPTR(,R2)                                     1489
         ST    @06,@TF00001                                        1489
         ALR   @06,@15                                             1489
         BCTR  @06,0                                               1489
         BCTR  @06,0                                               1489
         CLC   TEMPCUA(2),CUA1-2(@06)                              1489
         BL    @RF01489                                            1489
         AL    @15,@TF00001                                        1489
         CLC   TEMPCUA(2),CUA2-4(@15)                              1489
         BH    @RF01489                                            1489
*            VALIDCUA = ON;                 /* ACCEPT RECORD @0001VLS*/
         OI    VALIDCUA,B'01000000'                                1490
*        END;                                              /*@0001VLS*/
@RF01489 LA    @06,1                                               1491
         AH    @06,I                                               1491
         STH   @06,I                                               1491
@DE01488 L     @01,CUAPTR(,R2)                                     1491
         CH    @06,CUANUM(,@01)                                    1491
         BNH   @DL01488                                            1491
@DC01488 DS    0H                                                  1492
*      ELSE                                                        1492
*        VALIDCUA = ON;                     /* ACCEPT RECORD @0001VLS*/
         B     @RC01487                                            1492
@RF01487 OI    VALIDCUA,B'01000000'                                1492
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE TO SEE IF A LIST OF VOLIS'S WAS PASSED IN  */
*      /* THE PARAMETER LIST.  IF IT WAS, THE VOLID IN THE RECORD IS */
*      /* COMPARED TO THE VOLIDS IN THE LIST TO SEE IF THE RECORD    */
*      /* SHOULD BE INCLUDED IN THE REPORTS.                 @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF VOLPTR ^= ZERO THEN               /* WAS A VOLID SPECIFIED */
@RC01487 L     @06,VOLPTR(,R2)                                     1493
         LTR   @06,@06                                             1493
         BZ    @RF01493                                            1493
*        DO I = 1 TO VOLNUM BY 1 WHILE(VALIDVOL = OFF);    /*@0001VLS*/
         LA    @06,1                                               1494
         STH   @06,I                                               1494
         B     @DE01494                                            1494
@DL01494 TM    VALIDVOL,B'00100000'                                1494
         BNZ   @DC01494                                            1494
*          IF VOLVAL(I) = TEMPVOL  THEN    /* VOLUME IN LIST        */
         MH    @06,@CH00080                                        1495
         L     @01,VOLPTR(,R2)                                     1495
         ALR   @01,@06                                             1495
         AL    @01,@CF01757                                        1495
         CLC   VOLVAL-2(6,@01),TEMPVOL                             1495
         BNE   @RF01495                                            1495
*            VALIDVOL = ON;                 /* ACCEPT RECORD @0001VLS*/
         OI    VALIDVOL,B'00100000'                                1496
*        END;                                              /*@0001VLS*/
@RF01495 LA    @06,1                                               1497
         AH    @06,I                                               1497
         STH   @06,I                                               1497
@DE01494 L     @01,VOLPTR(,R2)                                     1497
         CH    @06,VOLNUM(,@01)                                    1497
         BNH   @DL01494                                            1497
@DC01494 DS    0H                                                  1498
*      ELSE                                                        1498
*        VALIDVOL = ON;                     /* ACCEPT RECORD @0001VLS*/
         B     @RC01493                                            1498
@RF01493 OI    VALIDVOL,B'00100000'                                1498
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE TO SEE ANY CPUS WERE SPECIFIED.    @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF CPUPTR ^= ZERO THEN                                      1499
@RC01493 L     @06,CPUPTR(,R2)                                     1499
         LTR   @06,@06                                             1499
         BZ    @RF01499                                            1499
*        DO I = 1 TO CPUNUM BY 1 WHILE(VALIDCPU = OFF);    /*@0001VLS*/
         LA    @06,1                                               1500
         STH   @06,I                                               1500
         B     @DE01500                                            1500
@DL01500 TM    VALIDCPU,B'00000001'                                1500
         BNZ   @DC01500                                            1500
*          IF CPUIDENT = CPUVAL(I) THEN                            1501
         MH    @06,@CH00036                                        1501
         L     @01,CPUPTR(,R2)                                     1501
         ALR   @01,@06                                             1501
         AL    @01,@CF01771                                        1501
         CLC   CPUIDENT(5,R7),CPUVAL-2(@01)                        1501
         BNE   @RF01501                                            1501
*            VALIDCPU = ON;                                /*@0001VLS*/
         OI    VALIDCPU,B'00000001'                                1502
*        END;                                              /*@0001VLS*/
@RF01501 LA    @06,1                                               1503
         AH    @06,I                                               1503
         STH   @06,I                                               1503
@DE01500 L     @01,CPUPTR(,R2)                                     1503
         CH    @06,CPUNUM(,@01)                                    1503
         BNH   @DL01500                                            1503
@DC01500 DS    0H                                                  1504
*      ELSE                                                        1504
*        VALIDCPU = ON;                                    /*@0001VLS*/
         B     @RC01499                                            1504
@RF01499 OI    VALIDCPU,B'00000001'                                1504
*      /*                                                    @0001VLS*/
*      /* A CHECK IS MADE AGAINST ANY DEVICE SERIALS SPECIFIED.      */
*      /*                                                    @0001VLS*/
*      IF SERPTR ^= ZERO &                                         1505
*         (RECTYP & FOXZERO) = OBRREC &  /*                  @D3503SG*/
*         DEV2 ^= OBRDEV  THEN           /*                  @D3503SG*/
@RC01499 L     @06,SERPTR(,R2)                                     1505
         LTR   @06,@06                                             1505
         BZ    @RF01505                                            1505
         MVC   @TS00001(1),RECTYP(R7)                              1505
         NI    @TS00001,X'F0'                                      1505
         CLI   @TS00001,X'30'                                      1505
         BNE   @RF01505                                            1505
         CLC   DEV2(2,R7),@CB00547                                 1505
         BE    @RF01505                                            1505
*        DO I = 1 TO SERNUM BY 1 WHILE(VALIDSER = OFF);    /*@0001VLS*/
         LA    @06,1                                               1506
         STH   @06,I                                               1506
         B     @DE01506                                            1506
@DL01506 TM    VALIDSER,B'00000010'                                1506
         BNZ   @DC01506                                            1506
*          IF OSER74XX = SERVAL(I) THEN                            1507
         ALR   @06,@06                                             1507
         L     @01,SERPTR(,R2)                                     1507
         ALR   @01,@06                                             1507
         CLC   OSER74XX(2,R7),SERVAL-2(@01)                        1507
         BNE   @RF01507                                            1507
*            VALIDSER = ON;                                /*@0001VLS*/
         OI    VALIDSER,B'00000010'                                1508
*        END;                                              /*@0001VLS*/
@RF01507 LA    @06,1                                               1509
         AH    @06,I                                               1509
         STH   @06,I                                               1509
@DE01506 L     @01,SERPTR(,R2)                                     1509
         CH    @06,SERNUM(,@01)                                    1509
         BNH   @DL01506                                            1509
@DC01506 DS    0H                                                  1510
*      ELSE                                                        1510
*        VALIDSER = ON;                                    /*@0001VLS*/
         B     @RC01505                                            1510
@RF01505 OI    VALIDSER,B'00000010'                                1510
*      /*                                                    @0001VLS*/
*      IF DEBUG16 = ON THEN    /*IF YES CHECK TO ADD ANY DROPPED REC */
@RC01505 TM    DEBUG16(R2),B'10000000'                             1511
         BNO   @RF01511                                            1511
*        DO;                                               /*@0001VLS*/
*          IF VALIDCUA = OFF THEN                                  1513
         TM    VALIDCUA,B'01000000'                                1513
         BNZ   @RF01513                                            1513
*            BADCUA = BADCUA + ONE; /*NUMBER DROPPED FOR CUA @0001VLS*/
         LA    @06,1                                               1514
         AL    @06,BADCUA                                          1514
         ST    @06,BADCUA                                          1514
*          ELSE                                                    1515
*            IF VALIDVOL = OFF THEN                                1515
         B     @RC01513                                            1515
@RF01513 TM    VALIDVOL,B'00100000'                                1515
         BNZ   @RF01515                                            1515
*              BADVOL = BADVOL + ONE; /* NUMBER DROPPED FOR VOLID    */
         LA    @06,1                                               1516
         AL    @06,BADVOL                                          1516
         ST    @06,BADVOL                                          1516
*            ELSE                                                  1517
*              IF VALIDSER = OFF THEN                              1517
         B     @RC01515                                            1517
@RF01515 TM    VALIDSER,B'00000010'                                1517
         BNZ   @RF01517                                            1517
*                BADSER = BADSER + ONE;  /*INCORRECT SERIAL NUMBER   */
         LA    @06,1                                               1518
         AL    @06,BADSER                                          1518
         ST    @06,BADSER                                          1518
*              ELSE                                                1519
*                IF VALIDCPU =  OFF THEN                           1519
         B     @RC01517                                            1519
@RF01517 TM    VALIDCPU,B'00000001'                                1519
         BNZ   @RF01519                                            1519
*                  BADCPU = BADCPU + ONE; /* CPU DOES NOT MATCH PARMS*/
         LA    @06,1                                               1520
         AL    @06,BADCPU                                          1520
         ST    @06,BADCPU                                          1520
*        END;                                              /*@0001VLS*/
*    END;                                                  /*@0001VLS*/
*END FILTER;                                               /*@0001VLS*/
@EL00038 DS    0H                                                  1523
@EF00038 DS    0H                                                  1523
@ER00038 LM    @14,@12,@SA00038                                    1523
         BR    @14                                                 1523
*/*                                                          @0001VLS*/
*/* AT END OF FILE THE PART OF THE CONTROL TABLE THAT HAS NOT BEEN   */
*/* USED IS FREED AND THEN CONTROL IS PASSED TO SORT THE TABLE.      */
*/*                                                          @0001VLS*/
*ENDOFILE: PROC;                                           /*@0001VLS*/
ENDOFILE STM   @14,@12,@SA00039                                    1524
* IF CURRPTR < TABPTR THEN               /* NOT ENOUGH TABLE SPACE   */
         CLC   CURRPTR(4),TABPTR                                   1525
         BNL   @RF01525                                            1525
*   DO;                                                    /*@0001VLS*/
*     CALL IFCMSG(53,ADDR(MSGADDR));                       /*@0001VLS*/
         LA    @06,MSGADDR                                         1527
         ST    @06,@AFTEMPS+8                                      1527
         L     @15,ADIFCMSG(,R2)                                   1527
         LA    @01,@AL01527                                        1527
         BALR  @14,@15                                             1527
*     CALL PRINTIT;                                        /*@0001VLS*/
         BAL   @14,PRINTIT                                         1528
*   END;                                                   /*@0001VLS*/
* CURRPTR = CURRPTR + TWELVE;            /* PUT WITHIN BOUNDS        */
@RF01525 LA    @06,12                                              1530
         AL    @06,CURRPTR                                         1530
         ST    @06,CURRPTR                                         1530
* CALL IFCMSG(54,ADDR(MSGADDR));                           /*@0001VLS*/
         LA    @06,MSGADDR                                         1531
         ST    @06,@AFTEMPS+8                                      1531
         L     @15,ADIFCMSG(,R2)                                   1531
         LA    @01,@AL01531                                        1531
         BALR  @14,@15                                             1531
* CVD (RECCOUNT,TEMPAREA(1:8));          /* CONVERT TO DECIMAL       */
         LH    @06,RECCOUNT                                        1532
         CVD   @06,TEMPAREA                                        1532
* UNPK (NUMRECP,TEMPAREA(1:8));          /* PRINTABLE CHARACTERS     */
         UNPK  NUMRECP(7),TEMPAREA(8)                              1533
* NUMRECP(7) = NUMRECP(7) × FOXZERO;                       /*@0001VLS*/
         OI    NUMRECP+6,X'F0'                                     1534
* I = 1;                                                   /*@0001VLS*/
         MVC   I(2),@CH00057                                       1535
* DO UNTIL (I > 6 × NUMRECP(I) ^= FOXZERO);                /*@0001VLS*/
@DL01536 DS    0H                                                  1537
*   NUMRECP(I) = BLANK;                  /* SET LEADING ZERO TO BLANK*/
         LH    @06,I                                               1537
         LA    @01,NUMRECP-1(@06)                                  1537
         MVI   0(@01),C' '                                         1537
*   I = I + 1;                                             /*@0001VLS*/
         LA    @06,1(,@06)                                         1538
         STH   @06,I                                               1538
* END;                                                     /*@0001VLS*/
@DE01536 LH    @06,I                                               1539
         C     @06,@CF00080                                        1539
         BH    @DC01536                                            1539
         LA    @01,NUMRECP-1(@06)                                  1539
         CLI   0(@01),X'F0'                                        1539
         BE    @DL01536                                            1539
@DC01536 DS    0H                                                  1540
* CALL PRINTIT;                                            /*@0001VLS*/
         BAL   @14,PRINTIT                                         1540
* FREESIZE = (CURRPTR - TABPTR);         /* UNUSED SPACE     @0001VLS*/
         L     @06,TABPTR                                          1541
         L     @15,CURRPTR                                         1541
         SLR   @15,@06                                             1541
         ST    @15,FREESIZE                                        1541
* IF FREESIZE > EIGHT THEN               /* OUTPUT MESSAGE   @0001VLS*/
         C     @15,@CF00067                                        1542
         BNH   @RF01542                                            1542
*   DO;                                                    /*@0001VLS*/
*     FREESIZE = FREESIZE & 'FFFFF8'X;   /* DOUBLE WORD AMOUNT       */
         N     @15,@CF01707                                        1544
         ST    @15,FREESIZE                                        1544
*     RESPECIFY (R0,R1) RESTRICTED;                        /*@0001VLS*/
*     R0 = FREESIZE;                                       /*@0001VLS*/
         LR    R0,@15                                              1546
*     R1 = TABPTR;                                         /*@0001VLS*/
         LR    R1,@06                                              1547
*     GEN(FREEMAIN R,LV=(R0),A=(R1));                      /*@0001VLS*/
         FREEMAIN R,LV=(R0),A=(R1)
*     RESPECIFY (R0,R1) UNRESTRICTED;                      /*@0001VLS*/
*   END;                                                   /*@0001VLS*/
* TABPTR = CURRPTR;                      /* SAVE ADDRESS OF NEW TABLE*/
@RF01542 L     @06,CURRPTR                                         1551
         ST    @06,TABPTR                                          1551
* SORTNUM = NUMENT;                      /* STORE THE NUMBER OF RCDS */
         L     @15,NUMENT                                          1552
         ST    @15,SORTNUM(,R2)                                    1552
* SORTADR = TABPTR;                      /* LOCATION OF SORT TABLE   */
         ST    @06,SORTADR(,R2)                                    1553
* IF PHIST = ON THEN                     /* HISTORY INPUT    @0001VLS*/
         TM    PHIST(R2),B'00100000'                               1554
         BNO   @RF01554                                            1554
*   DO;                                                    /*@0001VLS*/
*     /*                                                     @0001VLS*/
*     /* INPUT DATA SETS MUST BE CLOSED IF HISTORY IS INPUT  @0001VLS*/
*     /*                                                     @0001VLS*/
*     CLOSEIO = CLOSEIO && CLOSEIO;                        /*@0001VLS*/
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           1556
*     IF PLOGREC = ON THEN                                         1557
         TM    PLOGREC(R2),B'00000010'                             1557
         BNO   @RF01557                                            1557
*       CSERLOG = ON;                                      /*@0001VLS*/
         OI    CSERLOG(R2),B'00100000'                             1558
*     CDRCTWRK = ON;                                       /*@0001VLS*/
@RF01557 OI    CDRCTWRK(R2),B'00000010'                            1559
*     CALL IOHND (IOCLOSE);                                /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    1560
         LA    @01,@AL01560                                        1560
         BALR  @14,@15                                             1560
*   END;                                                   /*@0001VLS*/
*END;                                                      /*@0001VLS*/
@EL00039 DS    0H                                                  1562
@EF00039 DS    0H                                                  1562
@ER00039 LM    @14,@12,@SA00039                                    1562
         BR    @14                                                 1562
@PB00039 DS    0H                                                  1563
*/*                                                          @0001VLS*/
*/* INITIALLY THE ADDRESS OF THE PARAMETER LIST IS SAVED.  NEXT AN    *
*/* AREA OF CORE IS GOTTEN FOR THE CONTROL TABLE.            @0001VLS*/
*/*                                                          @0001VLS*/
*  SAVEPARM = R2;                     /* SAVE ADDR TO PARM TABLE     */
         ST    R2,SAVEPARM                                         1563
*  RESPECIFY (R12,R15) RESTRICTED;                         /*@0001VLS*/
*  IF DEBUG4 = ON THEN                /* DUMP PGM NAMES AND DATES    */
         TM    DEBUG4(R2),B'00001000'                              1565
         BNO   @RF01565                                            1565
*    DO R15 = R12 - 27;                                    /*@0001VLS*/
         LR    R15,R12                                             1566
         SL    R15,@CF01708                                        1566
*      GEN(MVC  MSGADDR(16),0(R15));                       /*@0001VLS*/
         MVC  MSGADDR(16),0(R15)
*      CALL PRINTIT;                                       /*@0001VLS*/
         BAL   @14,PRINTIT                                         1568
*    END;                                                  /*@0001VLS*/
*IF SHAREPTR ^= 0 THEN                                             1570
@RF01565 L     @14,SHAREPTR(,R2)                                   1570
         LTR   @14,@14                                             1570
         BZ    @RF01570                                            1570
* CALL SORTSHAR;                                           /*@D3506GB*/
         BAL   @14,SORTSHAR                                        1571
*  RESPECIFY (R0) RESTRICTED;                              /*@0001VLS*/
@RF01570 DS    0H                                                  1573
*  R0 = TABSIZE / FOUR;               /* GET SIZE FOR TABLE  @0001VLS*/
         L     R0,TABSIZE(,R2)                                     1573
         SRDA  R0,32                                               1573
         D     R0,@CF00037                                         1573
         LR    R0,@01                                              1573
*  GEN(GETMAIN EC,LV=(0),A=TABPTR GET SPACE FOR TABLE);    /*@0001VLS*/
         GETMAIN EC,LV=(0),A=TABPTR GET SPACE FOR TABLE
*  RETCODE = R15;                                          /*@0001VLS*/
         ST    R15,RETCODE                                         1575
*  RESPECIFY (R0,R12,R15) UNRESTRICTED;                    /*@0001VLS*/
*  IF RETCODE = ZERO THEN             /* IF GOOD RET CODE, CONTINUE  */
         L     @06,RETCODE                                         1577
         LTR   @06,@06                                             1577
         BNZ   @RF01577                                            1577
*    DO;                                                   /*@0001VLS*/
*      PACK(TEMPAREA(1:8),RDTHRSH);   /* CONVERT THE THRESHOLD VALUE */
         PACK  TEMPAREA(8),RDTHRSH(3,R2)                           1579
*      CVB(CURRPTR,TEMPAREA(1:8));    /* TO A VALUE SIMILAR TO THAT  */
         CVB   @06,TEMPAREA                                        1580
         ST    @06,CURRPTR                                         1580
*      READS = CURRPTR;               /* IN THE RECORD       @0001VLS*/
         STC   @06,READS                                           1581
*      PACK(TEMPAREA(1:8),WRTHRSH);   /* CONVERT THE THRESHOLD VALUE */
         PACK  TEMPAREA(8),WRTHRSH(3,R2)                           1582
*      CVB(CURRPTR,TEMPAREA(1:8));    /* TO A VALUE SIMILAR TO THAT  */
         CVB   @06,TEMPAREA                                        1583
         ST    @06,CURRPTR                                         1583
*      WRITES = CURRPTR;              /* IN THE RECORD       @0001VLS*/
         STC   @06,WRITES                                          1584
*      CURRPTR = TABPTR + (TABSIZE / FOUR) - 2;            /*@0001VLS*/
         L     @00,TABSIZE(,R2)                                    1585
         SRDA  @00,32                                              1585
         D     @00,@CF00037                                        1585
         AL    @01,TABPTR                                          1585
         BCTR  @01,0                                               1585
         BCTR  @01,0                                               1585
         ST    @01,CURRPTR                                         1585
*      EOTABLE = EOT;                 /* PUT IN END OF TABLE INDICAT */
         MVC   EOTABLE(2,@01),@CB00261                             1586
*      CURRPTR = CURRPTR - TWELVE;                         /*@0001VLS*/
         SL    @01,@CF00033                                        1587
         ST    @01,CURRPTR                                         1587
*      RESPECIFY (R15) RESTRICTED;                         /*@0001VLS*/
*      CALL IOHND(READSEQ);           /* GET AN INPUT RECORD @0001VLS*/
         L     @15,ADIOHND(,R2)                                    1589
         LA    @01,@AL01589                                        1589
         BALR  @14,@15                                             1589
*      RETCODE = R15;                                      /*@0001VLS*/
         ST    R15,RETCODE                                         1590
*      RESPECIFY (R15) UNRESTRICTED;                       /*@0001VLS*/
*      DO WHILE (CURRPTR >= TABPTR & RETCODE = ZERO);      /*@0001VLS*/
         B     @DE01592                                            1592
@DL01592 DS    0H                                                  1593
*        CALL FILTER;                                      /*@0001VLS*/
         BAL   @14,FILTER                                          1593
*        IF VALIDCUA = ON & VALIDVOL = ON & VALIDCPU = ON &        1594
*          VALIDSER = ON THEN                                      1594
         TM    VALIDCUA,B'01100000'                                1594
         BNO   @RF01594                                            1594
         TM    VALIDCPU,B'00000011'                                1594
         BNO   @RF01594                                            1594
*          IF DEVCODE = NONSF  THEN      /*NOT 8809DEV       @D3503SG*/
         CLI   DEVCODE,X'00'                                       1595
         BNE   @RF01595                                            1595
*            CALL TABENT;                /*MAKE A TABLE ENTRY@D3503SG*/
         BAL   @14,TABENT                                          1596
*          ELSE                          /*8809DEV RECORD    @D3503SG*/
*            CALL SFBENT;                /*MAKE A TABLE ENTRY@D3503SG*/
         B     @RC01595                                            1597
@RF01595 BAL   @14,SFBENT                                          1597
*        IF RETCODE = ZERO THEN                                    1598
@RC01595 DS    0H                                                  1598
@RF01594 L     @06,RETCODE                                         1598
         LTR   @06,@06                                             1598
         BNZ   @RF01598                                            1598
*          DO;                                             /*@0001VLS*/
*            RESPECIFY (R15) RESTRICTED;                   /*@0001VLS*/
*            CALL IOHND (READSEQ);            /* GET ANOTHER RECORD  */
         L     @15,ADIOHND(,R2)                                    1601
         LA    @01,@AL01601                                        1601
         BALR  @14,@15                                             1601
*            RETCODE = R15;                                /*@0001VLS*/
         ST    R15,RETCODE                                         1602
*            RESPECIFY (R15) UNRESTRICTED;                 /*@0001VLS*/
*          END;                                            /*@0001VLS*/
*      END;                                                /*@0001VLS*/
@RF01598 DS    0H                                                  1605
@DE01592 CLC   CURRPTR(4),TABPTR                                   1605
         BL    @DC01592                                            1605
         L     @06,RETCODE                                         1605
         LTR   @06,@06                                             1605
         BZ    @DL01592                                            1605
@DC01592 DS    0H                                                  1606
*      CALL ENDOFILE;                                      /*@0001VLS*/
         BAL   @14,ENDOFILE                                        1606
*      /*                                                    @0001VLS*/
*      /* WHEN END OF FILE HAS BEEN REACHED OR THE CONTROL TABLE IS  */
*      /* FULL, THE ENTRIES ARE SORTED FOR PROCESSING.  THE COUNT OF */
*      /* RECORDS AND ADDRESS OF THE FIRST ENTRY IS SAVED FOR SECOND */
*      /* PASS.                                              @0001VLS*/
*      /*                                                    @0001VLS*/
*      IF RECCOUNT ^= ZERO THEN       /* ARE THERE ANY VALID RECORDS */
         LH    @06,RECCOUNT                                        1607
         LTR   @06,@06                                             1607
         BZ    @RF01607                                            1607
*        DO;                                               /*@0001VLS*/
*          IF DEBUG16 = ON THEN       /* DO THEY WANT THE DEBUG CTS  */
         TM    DEBUG16(R2),B'10000000'                             1609
         BNO   @RF01609                                            1609
*            CALL BUGDATA;            /* GO PRINT THE COUNTS @0001VLS*/
         BAL   @14,BUGDATA                                         1610
*          IF NUMENT > ONE THEN                                    1611
@RF01609 L     @06,NUMENT                                          1611
         C     @06,@CF00057                                        1611
         BNH   @RF01611                                            1611
*            CALL SORT;               /* SORT FOR CUA        @0001VLS*/
         BAL   @14,SORT                                            1612
*          IF DEBUG11 = ON THEN       /* ABEND REQUESTED?    @0001VLS*/
@RF01611 TM    DEBUG11(R2),B'00010000'                             1613
         BNO   @RF01613                                            1613
*            GEN (ABEND 520,DUMP);                         /*@0001VLS*/
         ABEND 520,DUMP
*          CALL PRINTCUA;                /*                  @D3503SG*/
@RF01613 BAL   @14,PRINTCUA                                        1615
*          SORTFLG = ON;                                   /*@0001VLS*/
         OI    SORTFLG,B'10000000'                                 1616
*          DEBUG27 = OFF;                                  /*@0001VLS*/
         NI    DEBUG27(R2),B'11101111'                             1617
*          CURRPTR = TABPTR;                               /*@0001VLS*/
         L     @06,TABPTR                                          1618
         ST    @06,CURRPTR                                         1618
*          IF NUMENT > ONE THEN                                    1619
         L     @06,NUMENT                                          1619
         C     @06,@CF00057                                        1619
         BNH   @RF01619                                            1619
*            CALL SORT;               /* SORT FOR VOLUME ID  @0001VLS*/
         BAL   @14,SORT                                            1620
*          CALL OUTVOLID;             /*                     @D3503SG*/
@RF01619 BAL   @14,OUTVOLID                                        1621
*        END;      /*IF RECOUNT ^= ZERO                      @0001VLS*/
*    END;                                                  /*@0001VLS*/
*  ELSE                                                            1624
*    DO;                                                   /*@0001VLS*/
         B     @RC01577                                            1624
@RF01577 DS    0H                                                  1625
*      CALL IFCMSG(55,ADDR(MSGADDR)); /* MSG FOR GETMAIN FAIL        */
         LA    @06,MSGADDR                                         1625
         ST    @06,@AFTEMPS+12                                     1625
         L     @15,ADIFCMSG(,R2)                                   1625
         LA    @01,@AL01625                                        1625
         BALR  @14,@15                                             1625
*      CALL PRINTIT;                  /* PRINT THE ERROR OUT @0001VLS*/
         BAL   @14,PRINTIT                                         1626
*    END;                                                  /*@0001VLS*/
*  IF DEBUG12 = ON THEN               /* ABEND REQUESTED?    @0001VLS*/
@RC01577 TM    DEBUG12(R2),B'00001000'                             1628
         BNO   @RF01628                                            1628
*    GEN(ABEND 540,DUMP);                                  /*@0001VLS*/
         ABEND 540,DUMP
*  RETURN;                                                 /*@0001VLS*/
@EL00001 L     @13,4(,@13)                                         1630
@EF00001 DS    0H                                                  1630
@ER00001 L     @14,12(,@13)                                        1630
         LM    @00,@12,20(@13)                                     1630
         BR    @14                                                 1630
* END                                                      /*@0001VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 1631
         B     @EL00001                                            1631
@DATA    DS    0H
@CH00085 DC    H'9'
@CH00727 DC    H'56'
         DS    0F
@AL00227 DC    A(CUASH2C)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00075)
@AL00234 DC    A(@CF01519)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00238 DC    A(HIGHCUA)              LIST WITH   3 ARGUMENT(S)
         DC    A(CUASH2C2)
         DC    A(@CF00075)
@AL00347 DC    A(PCCW)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00067)
@AL00348 DC    A(PCSW)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00037)
@AL00401 DC    A(SPCCW)                LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00067)
@AL00402 DC    A(SPCSW)                LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00037)
@AL00403 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00460 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00547 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00868 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00938 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00080)
@AL00406 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00464 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00551 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00871 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00941 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00067)
@AL00418 DC    A(SPSYMCD)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00075)
@AL00493 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(WRTGVRC)
@AL00495 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(ERLYBOR)
@AL00497 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(OVELCHG)
@AL00503 DC    A(I)                    LIST WITH   2 ARGUMENT(S)
         DC    A(SKEWERR)
@AL00504 DC    A(MCPU)                 LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00075)
@AL00505 DC    A(SERCPU)               LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00038)
@AL00557 DC    A(SCCPSER)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00038)
@AL00558 DC    A(SCCPMDL)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00075)
@AL00684 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00780 DC    A(TEMPAREA+18)          LIST WITH   3 ARGUMENT(S)
@AL00322 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00389 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00455 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00545 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00895 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00947 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00075)
@AL00719 DC    A(SYSRDS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYSSIOS)
         DC    A(READPERC)
@AL00720 DC    A(SYSRTS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYSSIOS)
         DC    A(RITEPERC)
@AL00721 DC    A(SYSSIOS)              LIST WITH   2 ARGUMENT(S)
         DC    A(SUMSIOS)
@AL00722 DC    A(SYSMNTS)              LIST WITH   2 ARGUMENT(S)
         DC    A(SUMMNTS)
@AL00723 DC    A(SYSRDS)               LIST WITH   2 ARGUMENT(S)
         DC    A(SUMREAD)
@AL00724 DC    A(SYSRTS)               LIST WITH   2 ARGUMENT(S)
         DC    A(SUMWRITE)
@AL00810 DC    A(SYSRDS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYSSIOS)
         DC    A(STRDPRC)
@AL00811 DC    A(SYSRTS)               LIST WITH   3 ARGUMENT(S)
         DC    A(SYWTSIOS)
         DC    A(STWTPRC)
@AL00812 DC    A(SYSSIOS)              LIST WITH   2 ARGUMENT(S)
         DC    A(STRDSIO)
@AL00813 DC    A(SYWTSIOS)             LIST WITH   2 ARGUMENT(S)
         DC    A(STWTSIO)
@AL00814 DC    A(SYSMNTS)              LIST WITH   2 ARGUMENT(S)
         DC    A(STUMNTS)
@AL00815 DC    A(SYSRDS)               LIST WITH   2 ARGUMENT(S)
         DC    A(STRDERS)
@AL00816 DC    A(SYSRTS)               LIST WITH   2 ARGUMENT(S)
         DC    A(STWTERS)
@AL00831 DC    A(LVOLDATE)             LIST WITH   3 ARGUMENT(S)
         DC    A(TEMPAREA)
         DC    A(@CF00038)
@AL00833 DC    A(HVOLDATE)             LIST WITH   3 ARGUMENT(S)
@AL00247 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00249 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00267 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00269 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00688 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00690 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00784 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00786 DC    A(TEMPAREA)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00038)
@AL00848 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01102 DC    A(@CF00080+2)           LIST WITH   1 ARGUMENT(S)
@AL00914 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00925 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00956 DC    A(VCPUMOD)              LIST WITH   2 ARGUMENT(S)
@AL00983 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01010 DC    A(@CF00075)             LIST WITH   1 ARGUMENT(S)
@AL00915 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00926 EQU   *                       LIST WITH   2 ARGUMENT(S)
@AL00957 DC    A(VCPUSER)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00038)
@AL00978 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01005 DC    A(@CF00057)             LIST WITH   1 ARGUMENT(S)
@AL01018 DC    A(@CF00036+2)           LIST WITH   1 ARGUMENT(S)
@AL01184 DC    A(@CF00777)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL01192 DC    A(TOTREC)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG10)
@AL01195 DC    A(OBRCT)                LIST WITH   2 ARGUMENT(S)
         DC    A(BUG20)
@AL01198 DC    A(MDRCT)                LIST WITH   2 ARGUMENT(S)
         DC    A(BUG21)
@AL01201 DC    A(NUMSHORT)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG30)
@AL01204 DC    A(BADDEV)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG31)
@AL01207 DC    A(BADDAY)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG40)
@AL01210 DC    A(BADTIME)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG50)
@AL01213 DC    A(DROP3RD)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG60)
@AL01216 DC    A(BADCPU)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG70)
@AL01219 DC    A(BADCUA)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG80)
@AL01222 DC    A(BADVOL)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG90)
@AL01225 DC    A(BADSER)               LIST WITH   2 ARGUMENT(S)
         DC    A(BUG100)
@AL01228 DC    A(SHAREMOD)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG110)
@AL01231 DC    A(SHARECU)              LIST WITH   2 ARGUMENT(S)
         DC    A(BUG120)
@AL01234 DC    A(EXCTHRES)             LIST WITH   2 ARGUMENT(S)
         DC    A(BUG130)
@AL01237 DC    A(EXCTHRES+4)           LIST WITH   2 ARGUMENT(S)
         DC    A(BUG140)
@AL01321 DC    A(MSGADDR)              LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00033)
@AL01372 DC    A(@CF00075+2)           LIST WITH   1 ARGUMENT(S)
@AL01527 DC    A(@CF00777)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
@AL01531 DC    A(@CF01706)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
@AL01560 DC    A(@CF00082+2)           LIST WITH   1 ARGUMENT(S)
@AL01589 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01601 DC    A(@CF00038+2)           LIST WITH   1 ARGUMENT(S)
@AL01625 DC    A(@CF01711)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+12)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00029 DS    15F
@SA00003 DS    15F
@SA00006 DS    15F
@SA00034 DS    15F
@PC00035 DS    3F
@SA00004 DS    15F
@SA00011 DS    15F
@SA00005 DS    15F
@SA00007 DS    15F
@SA00031 DS    15F
@PC00031 DS    2F
@SA00008 DS    15F
@SA00009 DS    15F
@SA00030 DS    15F
@PC00030 DS    2F
@SA00010 DS    15F
@SA00012 DS    15F
@SA00023 DS    15F
@SA00013 DS    15F
@SA00036 DS    15F
@PC00036 DS    3F
@PC00032 DS    2F
@PC00033 DS    2F
@SA00014 DS    15F
@SA00015 DS    15F
@SA00016 DS    15F
@SA00017 DS    15F
@SA00020 DS    15F
@SA00019 DS    15F
@PC00019 DS    1F
@SA00018 DS    15F
@SA00021 DS    15F
@SA00024 DS    15F
@SA00022 DS    15F
@SA00025 DS    15F
@SA00038 DS    15F
@SA00039 DS    15F
@AL00001 DS    3A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    4F
         DS    0F
@CF00057 DC    F'1'
@CH00057 EQU   @CF00057+2
@CF00075 DC    F'2'
@CF00038 DC    F'3'
@CH00038 EQU   @CF00038+2
@CF00037 DC    F'4'
@CF00036 DC    F'5'
@CH00036 EQU   @CF00036+2
@CF00080 DC    F'6'
@CH00080 EQU   @CF00080+2
@CF00082 DC    F'7'
@CF00067 DC    F'8'
@CF00034 DC    F'11'
@CF00033 DC    F'12'
@CH00033 EQU   @CF00033+2
@CF00032 DC    F'15'
@CF00088 DC    F'16'
@CF00227 DC    F'24'
@CF01708 DC    F'27'
@CF00777 DC    F'53'
@CF01706 DC    F'54'
@CF01711 DC    F'55'
@CF01519 DC    F'90'
@CF01691 DC    F'10000'
@CF01690 DC    F'10000000'
@CF01754 DC    F'-48'
@CF01755 DC    F'-44'
@CF01759 DC    F'-40'
@CF01756 DC    F'-36'
@CF01760 DC    F'-32'
@CF01758 DC    F'-28'
@CF01768 DC    F'-24'
@CF01769 DC    F'-20'
@CF01761 DC    F'-16'
@CF01762 DC    F'-14'
@CF01772 DC    F'-13'
@CF01763 DC    F'-12'
@CF01764 DC    F'-10'
@CF01765 DC    F'-8'
@CF01766 DC    F'-6'
@CF01757 DC    F'-4'
@CF01771 DC    F'-3'
@CF01707 DC    XL4'FFFFF8'
         DS    0D
SYWTSIOS DS    F
MDRCT    DC    F'0'
MYLINCT  DC    F'0'
SAVEPARM DS    F
CURRPTR  DS    A
TABPTR   DS    A
RETCODE  DS    F
FREESIZE DC    F'8192'
TOTREC   DC    F'0'
OBRCT    DC    F'0'
NUMSHORT DC    F'0'
BADDEV   DC    F'0'
BADDAY   DC    F'0'
BADTIME  DC    F'0'
DROP3RD  DC    F'0'
BADCPU   DC    F'0'
BADCUA   DC    F'0'
BADVOL   DC    F'0'
BADSER   DC    F'0'
BADREC   DC    F'0'
SHAREMOD DC    F'0'
SHARECU  DC    F'0'
Z        DC    F'0'
L        DC    F'0'
P        DC    F'0'
X        DC    F'0'
TOTALPTR DC    A(0)
SUMPTR   DC    A(0)
NUMENT   DC    F'0'
SYSSIOS  DS    F
SYSRDS   DS    F
SYSRTS   DS    F
SYSMNTS  DS    F
SRTCONT  DC    F'0'
CUAINDEX DS    F
LHDATPTR DC    A(0)
DATEPTR  DC    A(0)
RECCOUNT DC    H'0'
I        DS    H
J        DS    H
K        DS    H
@TS00001 DS    CL16
@CC00518 DC    C'TOTALS'
@CC00495 DC    C' N/A '
@CC00520 DC    C'100+ '
@CC00489 DC    C' 800'
@CC00491 DC    C'1600'
@CC00493 DC    C'6250'
@CB00208 DC    X'0000'
@CB00261 DC    X'FFFF'
@CB00473 DC    X'000F'
@CB00475 DC    X'0FF0'
@CB00547 DC    X'8006'
DEVCODE  DC    X'00'
CHKCDE   DS    BL1
         DS    CL4
DBLWORD  DS    CL8
WORK     DS    CL8
RECCPU   DC    CL3' '
RECCUA   DC    CL2' '
RECDEV   DC    CL1' '
READS    DS    CL1
WRITES   DS    CL1
SWITCH   DC    X'8000'
         ORG   SWITCH
SORTFLG  DS    BL1
SWITCH1  EQU   SWITCH+0
FOUND    EQU   SWITCH+0
HEAD1    EQU   SWITCH+0
HEAD2    EQU   SWITCH+0
HEAD3    EQU   SWITCH+0
VALIDSER EQU   SWITCH+0
VALIDCPU EQU   SWITCH+0
VALIDSHR DS    BL1
VALIDCUA EQU   SWITCH+1
VALIDVOL EQU   SWITCH+1
VALIDCON EQU   SWITCH+1
         ORG   SWITCH+2
         DS    CL6
TEMPAREA DS    CL20
OLDCPUCU DS    CL6
@NM00012 DS    CL5
         ORG   @NM00012
SHR74XXX DS    CL5
         ORG   SHR74XXX
SHR74CUA DS    BL2
SHR74CPU DS    CL3
         ORG   @NM00012+5
LOWCUA   DS    CL2
HIGHCUA  DS    CL2
LETTERS  DC    CL1'S'
LETTERC  DC    CL1'C'
HVOLDATE DC    X'000000'
LVOLDATE DC    X'FFFFFF'
CHARS    DC    CL16'0123456789ABCDEF'
BUG16    DC    CL31'DEBUG16 - INFORMATIONAL COUNTS'
BUG10    DC    CL26'       TOTAL RECORDS FOUND'
BUG20    DC    CL24'       OBR RECORDS FOUND'
BUG21    DC    CL24'       MDR RECORDS FOUND'
BUG30    DC    CL36'       SHORT RECORDS FOUND && DROPPED'
BUG31    DC    CL30'       DROPPED NOT DEVICE 34XX'
BUG40    DC    CL37'       DROPPED, OUT OF THE DATE RANGE'
BUG50    DC    CL37'       DROPPED, OUT OF THE TIME RANGE'
BUG60    DC    CL33'       DROPPED DUE TO THIRD SHIFT'
BUG70    DC    CL35'       DROPPED DUE TO CPU SELECTION'
BUG80    DC    CL35'       DROPPED DUE TO CUA SELECTION'
BUG90    DC    CL37'       DROPPED DUE TO VOLID SELECTION'
BUG8     DC    CL33'DEBUG8 HEX DUMP OF THE SORT TABLE'
BUG100   DC    CL45'       DROPPED DUE TO DEVICE SERIAL SELECTION'
BUG110   DC    CL66'       CUAS AT THE CONTROLLER LEVEL MODIFIED DUE TOC
                SHARE CARDS   '
BUG120   DC    CL56'       CUAS AT THE CUA LEVEL MODIFIED DUE TO SHARE C
               CARDS'
BUG130   DC    CL33'       RECORDS EXCEEDED THRESHOLD'
BUG140   DC    CL30'       RECORDS WITH PERM ERROR'
CUAPH1   DC    CL25'PERMANENT ERROR SUMMARY'
CUAPH2   DC    CL11'...SENSE...'
CUAPH3   DC    CL42'1  1  1  1  1  1  1  1  1  1  2  2  2  2'
CUAPH4   DS    CL120
         ORG   CUAPH4
@NM00013 DC    CL40'DEV  SERIAL ERR  VOLID     LAST CCW     '
@NM00014 DC    CL40'CSW44-47  0  1  2  3  4  5  6  7  8  9  '
@NM00015 DC    CL40'0  1  2  3  4  5  6  7  8  9  0  1  2  3'
         ORG   CUAPH4+120
CUAPH5   DS    CL47
         ORG   CUAPH5
@NM00016 DC    CL33'NO PERMANENT ERRORS ENCOUNTERED:'
CUAPH5D1 DC    CL5' '
@NM00017 DC    CL4' TO'
CUAPH5D2 DC    CL5' '
         ORG   CUAPH5+47
CUAPH6   DS    CL99
         ORG   CUAPH6
@NM00018 DC    CL53' '
@NM00019 DC    CL46'DATE        TIME       100         SYMP'
         ORG   CUAPH6+99
CUAPH7   DS    CL100
         ORG   CUAPH7
@NM00020 DC    CL40'DEV   ERR   VOL ID       LAST CCW'
@NM00021 DC    CL36'CSW 44-47   DAY YR   HH MM SS TH'
@NM00022 DC    CL24'IPS   LGM   CODE'
         ORG   CUAPH7+100
CUASH1   DC    CL44'XXXXX 34XX/3803/8809 SUBSYSTEM SUMMARY XXXXX'
CUASH2   DC    CL44'XXXXX    PRIMARY CUA       -           XXXXX'
CUASH3   DS    CL61
         ORG   CUASH3
@NM00023 DC    CL32'CUA STATISTICS - CUAS EXCEEDING '
CUASH3R  DC    CL3' '
@NM00024 DC    CL13' TEMP RDS OR '
CUASH3W  DC    CL3' '
@NM00025 DC    CL10' TEMP WRTS'
         ORG   CUASH3+61
CUASH4   DS    CL130
         ORG   CUASH4
@NM00026 DC    CL10' '
@NM00027 DC    CL50'TU    DATE   VOLUME     TIME      --TEMP--   SIO'
@NM00028 DC    CL50'DEN- NRZI  R/W WR TG  LRC  CRC  ECC  SKEW ERLY VEL'
@NM00029 DC    CL20'  ----CPU----  HDR'
         ORG   CUASH4+130
CUASH5   DS    CL129
         ORG   CUASH5
@NM00030 DC    CL2' '
@NM00031 DC    CL52' CUA  SERIAL DAY YR  SERIAL  HH MM SS.TH   RDS WRTSC
               '
@NM00032 DC    CL52'COUNT SITY NOISE VRC  VRC   MTE  EDC  ENV  ERR  BORC
               '
@NM00033 DC    CL23' CHG   ID  SERIAL  SER'
         ORG   CUASH5+129
CUASH6   DS    CL42
         ORG   CUASH6
@NM00034 DC    CL28'NO CUAS EXCEEDED THRESHOLD: '
CUASH6D1 DC    CL5' '
@NM00035 DC    CL4' TO '
CUASH6D2 DC    CL5' '
         ORG   CUASH6+42
CUASH10  DS    CL101
         ORG   CUASH10
@NM00036 DC    CL37'       DATE   VOLUME     TIME'
@NM00037 DC    CL64'  TEMP    SIO COUNT'
         ORG   CUASH10+101
CUASH11  DS    CL108
         ORG   CUASH11
@NM00038 DC    CL35'CUA   DAY YR  SERIAL  HH MM SS TH'
@NM00039 DC    CL36'  RDS WRTS  RDS  WRTS   MTE EDC SRC'
@NM00040 DC    CL37'RBF ENV NOP CRE SKEW VEL MODEL SERIAL'
         ORG   CUASH11+108
SPACER   DS    CL132
         ORG   SPACER
@NM00041 DC    132CL1'X'
         ORG   SPACER+132
VOLHEAD1 DS    CL104
         ORG   VOLHEAD1
@NM00042 DC    CL30'  VOLUME STATISTICS - VOLUMES'
@NM00043 DC    CL10'EXCEEDING'
VOLH1R   DC    CL3' '
@NM00044 DC    CL20' TEMPORARY READS OR'
VOLH1W   DC    CL3' '
@NM00045 DC    CL38' TEMPORARY WRITES OR PERMANENT ERRORS'
         ORG   VOLHEAD1+104
NOVOLS   DS    CL46
         ORG   NOVOLS
@NM00046 DC    CL32'NO VOLUMES EXCEEDED THRESHOLD:'
VOLH5L   DC    CL5' '
@NM00047 DC    CL4' TO '
VOLH5H   DC    CL5' '
         ORG   NOVOLS+46
VOLH2    DS    CL132
         ORG   VOLH2
@NM00048 DC    CL32'VOLUME  DATE     TIME'
@NM00049 DC    CL36'TU    RD/  --PERM--  --TEMP-- RD RTR'
@NM00050 DC    CL3'Y/'
@NM00051 DC    CL37'ERASE  SIO COUNT BLOCK  PROGRAM  ----'
@NM00052 DC    CL24'CPU----  MOD  DEN- HDR'
         ORG   VOLH2+132
VOLH3    DS    CL132
         ORG   VOLH3
@NM00053 DC    CL32'SERIAL DAY YR HH MM SS TH CUA  S'
@NM00054 DC    CL36'ERIAL WRT  RDS WRTS  RDS WRTS CLNR A'
@NM00055 DC    CL3'CT'
@NM00056 DC    CL37' GAPS  RDS  WRTS LENGTH   ID     ID  '
@NM00057 DC    CL24' SERIAL   #   SITY SER'
         ORG   VOLH3+132
CUATH1   DC    CL48'34XX/3803/8809 SUBSYSTEM TEMPORARY ERROR SUMMARY'
CUATH2   DS    CL82
         ORG   CUATH2
@NM00058 DC    CL50' ERRORS/100K'
@NM00059 DC    CL16'READ'
@NM00060 DC    CL13'WRITE'
@NM00061 DC    CL3'ECC'
         ORG   CUATH2+82
CUATH3   DS    CL108
         ORG   CUATH3
@NM00062 DC    CL34'SIOS           DATE      TOTAL'
@NM00063 DC    CL41'TOTAL    STATISTICS       STATISTICS'
@NM00064 DC    CL33'VRC   STRD  PART   OVER  VEL  IBG'
         ORG   CUATH3+108
CUATH4   DS    CL119
         ORG   CUATH4
@NM00065 DC    CL1' '
@NM00066 DC    CL45'CUA   READ  WRITE  -FROM---TO--    SIOS   MOU'
@NM00067 DC    CL45'NTS. ERRORS  CLNRAC . ERRORS  ERSGAP . ENV'
@NM00068 DC    CL28'CHK   RECK   RUN   CHG  DET'
         ORG   CUATH4+119
CUATH6   DS    CL92
         ORG   CUATH6
@NM00069 DC    CL51' ERRORS/100K'
@NM00070 DC    CL16'READ'
@NM00071 DC    CL25'WRITE'
         ORG   CUATH6+92
CUATH7   DS    CL91
         ORG   CUATH7
@NM00072 DC    CL29'SIOS         DATE      TOTAL'
@NM00073 DC    CL34'SIOS    TOTAL     STATISTICS'
@NM00074 DC    CL28'STATISTICS    OVER   VEL'
         ORG   CUATH7+91
CUATH8   DS    CL99
         ORG   CUATH8
@NM00075 DC    CL36'CUA  READ  WRITE -FROM---TO--  READ'
@NM00076 DC    CL40'WRITE    MOUNTS  ERRORS RETRIES  ERRORS'
@NM00077 DC    CL23'ERS GAP  RUN    CHK'
         ORG   CUATH8+99
NOTOTALS DC    CL32'NO TEMPORARY ERRORS ENCOUNTERED'
MESSAGE  DS    CL134
         ORG   MESSAGE
MSGDS    DC    CL1'1'
MSGCC    DC    CL1' '
MSGADDR  DC    CL132' '
         ORG   MSGADDR
@NM00078 DS    CL8
NUMRECP  DS    CL7
         ORG   MESSAGE+134
CHAIN    DS    CL6
         ORG   CHAIN
CHAINCPU DS    CL3
CHAINCUX DS    CL2
CHAINDEV DS    CL1
         ORG   CHAIN+6
TEMPVOL  DS    CL6
TEMPCUA  DS    CL2
SUPERZAP DC    3CL10'SUPERZAP'
         DS    CL3
EXCTHRES DC    F'0'
         DS    1XL4
MODNO    DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'3'
         DC    CL1'5'
         DC    CL1'7'
         DC    5CL1' '
         DC    CL1'4'
         DC    CL1'6'
         DC    CL1'8'
         DC    2CL1' '
ERRTABLE DC    CL34'PW  PERMANENT WRITE'
         ORG   ERRTABLE+0
ERRTABC  DS    CL2
         ORG   ERRTABLE+34
         DC    CL34'PR  PERMANENT READ'
         ORG   ERRTABLE+68
         DC    CL34'PF  CAUSE UNKNOWN'
         ORG   ERRTABLE+102
         DC    CL34'EC  EQUIPMENT CHECK, CAUSE UNKNOWN'
         ORG   ERRTABLE+136
         DC    CL34'EE  ERASE HEAD'
         ORG   ERRTABLE+170
         DC    CL34'EB  TAPE BOTTOM, LEFT OR RIGHT'
         ORG   ERRTABLE+204
         DC    CL34'EL  LOAD FAILURE'
         ORG   ERRTABLE+238
         DC    CL34'EP  AIR BEARING PRESSURE'
         ORG   ERRTABLE+272
         DC    CL34'ET  TACH START FAILURE'
         ORG   ERRTABLE+306
         DC    CL34'EV  VELOCITY CHECK'
         ORG   ERRTABLE+340
         DC    CL34'ER  RESET KEY'
         ORG   ERRTABLE+374
         DC    CL34'WC  WRITE CURRENT CHECK'
         ORG   ERRTABLE+408
PATCH    DC    20H'0'
IFCTHRSH CSECT
         DC    S(SUPERZAP)
IFCTHRSH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
POBR     EQU   RECTYPE
PTTYP    EQU   RECTYPE+1
SWITCHES EQU   PARM+2
SHIFT3RD EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG8   EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG16  EQU   DEBUG+2
DEBUG27  EQU   DEBUG+3
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PHIST    EQU   MISC
PRINTES  EQU   MISC
PLOGREC  EQU   MISC
PASSFLAG EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
CSERLOG  EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
RDTHRSH  EQU   PARM+66
WRTHRSH  EQU   PARM+69
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
TABSIZE  EQU   PARM+80
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHARENUM EQU   SHARE
SHAREIO  EQU   SHARE+2
SHAREFLG EQU   SHAREIO
SHRBASE  EQU   SHAREIO+1
SHARSERB EQU   SHRBASE
SHRCUABL EQU   SHRBASE+3
SHRCUABH EQU   SHRBASE+5
SHRCUCPU EQU   SHAREIO+8
SHARSERA EQU   SHRCUCPU
SHRCUAAL EQU   SHRCUCPU+3
SHRCUAAH EQU   SHRCUCPU+5
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUANUM   EQU   CUA
CUAVAL   EQU   CUA+2
CUA1     EQU   CUAVAL
CUA2     EQU   CUAVAL+2
DEVICE   EQU   0
DEVNUM   EQU   DEVICE
DEVVAL   EQU   DEVICE+2
MDRNUM   EQU   DEVICE+202
MDRVAL   EQU   DEVICE+204
MODELS   EQU   0
DEVSERAL EQU   0
SERNUM   EQU   DEVSERAL
SERVAL   EQU   DEVSERAL+2
VOLUME   EQU   0
VOLNUM   EQU   VOLUME
VOLVAL   EQU   VOLUME+2
CPUS     EQU   0
CPUNUM   EQU   CPUS
CPUVAL   EQU   CPUS+2
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
CONTRTAB EQU   0
CONTRVOL EQU   CONTRTAB
SORTCPUC EQU   CONTRVOL
CONTRCUA EQU   SORTCPUC
EOTABLE  EQU   CONTRCUA
CPU      EQU   SORTCPUC+2
DEVTYPE  EQU   SORTCPUC+5
TYPE     EQU   CONTRVOL+6
TABCCHHR EQU   CONTRTAB+7
SORTTAB  EQU   0
BUFFER   EQU   0
RECTYP   EQU   BUFFER
SWITCHE  EQU   BUFFER+2
SW2      EQU   SWITCHE+1
EOD      EQU   SW2
SHORT    EQU   SW2
DISMNT   EQU   SW2
DATE     EQU   BUFFER+8
TIME     EQU   BUFFER+12
CPUIDENT EQU   BUFFER+17
CPUSER   EQU   CPUIDENT
CPUMOD   EQU   CPUIDENT+3
JOBID    EQU   BUFFER+24
FAILCCW  EQU   BUFFER+32
CCWBYT0  EQU   FAILCCW
CSW      EQU   BUFFER+44
CSW34XX  EQU   CSW
SECUA    EQU   BUFFER+49
SECUA2   EQU   SECUA+1
ODEVICE  EQU   BUFFER+52
DEV2     EQU   ODEVICE+2
OCUA     EQU   BUFFER+57
OCUA2    EQU   OCUA+1
SNSCNT   EQU   BUFFER+62
VOLID    EQU   BUFFER+64
BLKLENG  EQU   BUFFER+70
HDRSER   EQU   BUFFER+72
READTH   EQU   BUFFER+76
RITETH   EQU   BUFFER+77
RECSIOS  EQU   BUFFER+78
SOPRWB   EQU   RECSIOS
PERMRDS  EQU   BUFFER+80
SOIPSB   EQU   PERMRDS
PERMRTS  EQU   BUFFER+81
RECERASE EQU   BUFFER+84
RECLEAN  EQU   BUFFER+86
NOISE    EQU   BUFFER+89
RWVRC    EQU   BUFFER+90
SOLGM    EQU   RWVRC
MTELRCR  EQU   BUFFER+91
EDCCRC   EQU   BUFFER+92
SOWCHK1  EQU   EDCCRC
SOWCHK2  EQU   EDCCRC
RECVRC   EQU   BUFFER+93
RECOVER  EQU   BUFFER+94
CCOMVRC  EQU   BUFFER+95
@NM00161 EQU   BUFFER+96
RECSTRD  EQU   BUFFER+98
RECPART  EQU   BUFFER+99
RECIBG   EQU   BUFFER+100
EXPEARL  EQU   BUFFER+101
SOSYMCD  EQU   BUFFER+102
SOSYMP   EQU   SOSYMCD
RECVEL   EQU   BUFFER+104
@NM00163 EQU   BUFFER+105
@NM00164 EQU   BUFFER+107
SENSE24  EQU   BUFFER+108
SENSE    EQU   SENSE24
SENSBIT3 EQU   SENSE
SENSBIT4 EQU   SENSE
SENSBIT5 EQU   SENSE
SENSBIT6 EQU   SENSE
SENSBIT7 EQU   SENSE
SMBUF    EQU   0
SMDEV    EQU   SMBUF+4
SMDATE   EQU   SMBUF+8
SMIDENT  EQU   SMBUF+17
SMCPSER  EQU   SMIDENT
SMCPMDL  EQU   SMIDENT+3
SMCUA    EQU   SMBUF+24
SMVOLID  EQU   SMBUF+26
SMBLTH   EQU   SMBUF+32
SMMUTE   EQU   SMBUF+42
SMEDC    EQU   SMBUF+43
SMSRC    EQU   SMBUF+44
SMRBF    EQU   SMBUF+45
SMENV    EQU   SMBUF+46
SMNOP    EQU   SMBUF+47
SMCRE    EQU   SMBUF+48
SMSKEW   EQU   SMBUF+49
SMVEL    EQU   SMBUF+53
SMTRD    EQU   SMBUF+54
SMTWRT   EQU   SMBUF+55
SMRDSIO  EQU   SMBUF+56
SMWTSIO  EQU   SMBUF+58
SMOUNT   EQU   SMBUF+60
SMOVRUN  EQU   SMBUF+61
SMERGAP  EQU   SMBUF+62
SMRDTRY  EQU   SMBUF+64
SUMAREA  EQU   0
NEXTCPU  EQU   SUMAREA
SUMTEMP  EQU   SUMAREA+8
SIOS     EQU   SUMTEMP
READER   EQU   SUMTEMP+4
CLEANER  EQU   SUMTEMP+8
WRITER   EQU   SUMTEMP+12
ERASE    EQU   SUMTEMP+16
MOUNTS   EQU   SUMTEMP+20
WTSIOS   EQU   SUMTEMP+24
SRDTRYS  EQU   SUMTEMP+28
VRC      EQU   SUMTEMP+32
STRDCHK  EQU   SUMTEMP+34
PARTRECK EQU   SUMTEMP+36
OVERRUNS EQU   SUMTEMP+38
VELCHGS  EQU   SUMTEMP+40
IBG      EQU   SUMTEMP+42
FDATE    EQU   SUMTEMP+44
TDATE    EQU   SUMTEMP+47
CPUCUX   EQU   SUMAREA+904
CUX      EQU   CPUCUX+3
DATEAREA EQU   0
NEXTDATE EQU   DATEAREA
DATECC   EQU   DATEAREA+4
LOWDATE  EQU   DATEAREA+10
HIDATE   EQU   DATEAREA+13
TYPEENT  EQU   0
BWORD1   EQU   0
DADDR1   EQU   0
BWORD2   EQU   0
DADDR2   EQU   0
BWORD3   EQU   0
DADDR3   EQU   0
BINWORD  EQU   0
DECADDR  EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
LENNUM   EQU   0
DIVEND   EQU   0
DIVSOR   EQU   0
OUTLOC   EQU   0
WORKOVER EQU   WORK
SUMPTRC  EQU   SUMPTR
CUASH2C  EQU   CUASH2+23
CUASH2C2 EQU   CUASH2+28
@NM00079 EQU   MSGADDR
OUTCUA   EQU   @NM00079+3
TUSER    EQU   @NM00079+9
DAY      EQU   @NM00079+15
YEAR     EQU   @NM00079+19
OVOLUME  EQU   @NM00079+23
HH       EQU   @NM00079+31
MM       EQU   @NM00079+34
SS       EQU   @NM00079+37
POINT    EQU   @NM00079+39
TH       EQU   @NM00079+40
OREADS   EQU   @NM00079+43
WRTS     EQU   @NM00079+48
SIOCNT   EQU   @NM00079+54
DENSITY  EQU   @NM00079+60
NRZIN    EQU   @NM00079+65
ORWVRC   EQU   @NM00079+70
WRTGVRC  EQU   @NM00079+75
LRCMTE   EQU   @NM00079+80
CRCEDC   EQU   @NM00079+85
ECCENV   EQU   @NM00079+90
SKEWERR  EQU   @NM00079+96
ERLYBOR  EQU   @NM00079+101
OVELCHG  EQU   @NM00079+106
MCPU     EQU   @NM00079+112
SERCPU   EQU   @NM00079+117
HEADSER  EQU   @NM00079+124
@NM00096 EQU   MSGADDR
OUTDEV   EQU   @NM00096
OUTSER   EQU   @NM00096+6
OUTERR   EQU   @NM00096+12
PVOL     EQU   @NM00096+16
PCCW     EQU   @NM00096+23
PCSW     EQU   @NM00096+40
PSNS     EQU   @NM00096+48
PSNSB    EQU   PSNS+1
@NM00103 EQU   MSGADDR
VVOLUME  EQU   @NM00103
VDAY     EQU   @NM00103+7
VYEAR    EQU   @NM00103+11
VHH      EQU   @NM00103+14
VMM      EQU   @NM00103+17
VSS      EQU   @NM00103+20
VPOINT   EQU   @NM00103+22
VTH      EQU   @NM00103+23
VCUA     EQU   @NM00103+26
VTUSER   EQU   @NM00103+30
VRDWRT   EQU   @NM00103+38
VPRDS    EQU   @NM00103+40
VPRTS    EQU   @NM00103+45
VTRDS    EQU   @NM00103+50
VTRTS    EQU   @NM00103+55
VCLEAN   EQU   @NM00103+63
VRETRY   EQU   VCLEAN
VERASE   EQU   @NM00103+71
VSIOS    EQU   @NM00103+77
VCWRTS   EQU   @NM00103+83
VBLOCK   EQU   @NM00103+89
VPGMID   EQU   @NM00103+95
VCPUMOD  EQU   @NM00103+104
VCPUSER  EQU   @NM00103+109
VMODEL   EQU   @NM00103+116
VDENS    EQU   @NM00103+121
VHDRSER  EQU   @NM00103+126
@NM00122 EQU   MSGADDR
@NM00123 EQU   @NM00122
OUTCODE  EQU   @NM00123
@NM00125 EQU   MSGADDR
SUMT1    EQU   @NM00125
SUMCUA   EQU   SUMT1+1
READPERC EQU   @NM00125+7
RITEPERC EQU   @NM00125+14
SUMFDATE EQU   @NM00125+20
SUMTDATE EQU   @NM00125+27
SUMSIOS  EQU   @NM00125+34
SUMMNTS  EQU   @NM00125+43
SUMP1    EQU   @NM00125+49
SUMREAD  EQU   @NM00125+52
SUMCLEAN EQU   @NM00125+60
SUMP2    EQU   @NM00125+66
SUMWRITE EQU   @NM00125+69
SUMERASE EQU   @NM00125+77
SUMP3    EQU   @NM00125+83
SUMVRC   EQU   @NM00125+84
SUMSTRD  EQU   @NM00125+90
SUMPART  EQU   @NM00125+96
SUMOVER  EQU   @NM00125+102
SUMVEL   EQU   @NM00125+108
SUMIBG   EQU   @NM00125+114
OSER74XX EQU   SENSE24+15
@NM00171 EQU   MSGADDR
SCCUA    EQU   @NM00171
SCDAY    EQU   @NM00171+6
SCYEAR   EQU   @NM00171+10
SCSER    EQU   @NM00171+14
SCHH     EQU   @NM00171+22
SCMM     EQU   @NM00171+25
SCSS     EQU   @NM00171+28
SCPOINT  EQU   @NM00171+30
SCTH     EQU   @NM00171+31
SCRDS    EQU   @NM00171+34
SCWRTS   EQU   @NM00171+39
SCRDSIO  EQU   @NM00171+45
SCWTSIO  EQU   @NM00171+51
SCMTE    EQU   @NM00171+57
SCEDC    EQU   @NM00171+61
SCSRC    EQU   @NM00171+65
SCRBF    EQU   @NM00171+69
SCENV    EQU   @NM00171+73
SCNOP    EQU   @NM00171+77
SCCRE    EQU   @NM00171+81
SCSKEW   EQU   @NM00171+86
SCVEL    EQU   @NM00171+90
SCCPMDL  EQU   @NM00171+96
SCCPSER  EQU   @NM00171+102
@NM00193 EQU   MSGADDR
SPCUA    EQU   @NM00193
SPERR    EQU   @NM00193+6
SPVOLID  EQU   @NM00193+12
SPCCW    EQU   @NM00193+21
SPCSW    EQU   @NM00193+40
SPDAY    EQU   @NM00193+52
SPYEAR   EQU   @NM00193+56
SPHH     EQU   @NM00193+61
SPMM     EQU   @NM00193+64
SPSS     EQU   @NM00193+67
SPPOINT  EQU   @NM00193+69
SPTH     EQU   @NM00193+70
SPIPS    EQU   @NM00193+77
SPLGM    EQU   @NM00193+83
SPSYMCD  EQU   @NM00193+88
@NM00206 EQU   MSGADDR
STCUA    EQU   @NM00206+2
STRDPRC  EQU   @NM00206+7
STWTPRC  EQU   @NM00206+13
STFRDATE EQU   @NM00206+19
STTODATE EQU   @NM00206+26
STRDSIO  EQU   @NM00206+32
STWTSIO  EQU   @NM00206+38
STUMNTS  EQU   @NM00206+46
STRDERS  EQU   @NM00206+54
STRDTRES EQU   @NM00206+60
STWTERS  EQU   @NM00206+69
STERGAPS EQU   @NM00206+76
STOVRUN  EQU   @NM00206+86
STVELCHK EQU   @NM00206+91
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00220 EQU   @NM00206+88
@NM00219 EQU   @NM00206+81
@NM00218 EQU   @NM00206+74
@NM00217 EQU   @NM00206+65
@NM00216 EQU   @NM00206+59
@NM00215 EQU   @NM00206+51
@NM00214 EQU   @NM00206+43
@NM00213 EQU   @NM00206+37
@NM00212 EQU   @NM00206+31
@NM00211 EQU   @NM00206+24
@NM00210 EQU   @NM00206+18
@NM00209 EQU   @NM00206+12
@NM00208 EQU   @NM00206+5
@NM00207 EQU   @NM00206
@NM00205 EQU   @NM00193+84
@NM00204 EQU   @NM00193+78
@NM00203 EQU   @NM00193+72
@NM00202 EQU   @NM00193+66
@NM00201 EQU   @NM00193+63
@NM00200 EQU   @NM00193+58
@NM00199 EQU   @NM00193+55
@NM00198 EQU   @NM00193+48
@NM00197 EQU   @NM00193+37
@NM00196 EQU   @NM00193+18
@NM00195 EQU   @NM00193+8
@NM00194 EQU   @NM00193+4
@NM00192 EQU   @NM00171+99
@NM00191 EQU   @NM00171+92
@NM00190 EQU   @NM00171+88
@NM00189 EQU   @NM00171+84
@NM00188 EQU   @NM00171+80
@NM00187 EQU   @NM00171+76
@NM00186 EQU   @NM00171+72
@NM00185 EQU   @NM00171+68
@NM00184 EQU   @NM00171+64
@NM00183 EQU   @NM00171+60
@NM00182 EQU   @NM00171+56
@NM00181 EQU   @NM00171+50
@NM00180 EQU   @NM00171+43
@NM00179 EQU   @NM00171+38
@NM00178 EQU   @NM00171+33
@NM00177 EQU   @NM00171+27
@NM00176 EQU   @NM00171+24
@NM00175 EQU   @NM00171+20
@NM00174 EQU   @NM00171+12
@NM00173 EQU   @NM00171+9
@NM00172 EQU   @NM00171+4
@NM00144 EQU   @NM00125+113
@NM00143 EQU   @NM00125+107
@NM00142 EQU   @NM00125+101
@NM00141 EQU   @NM00125+95
@NM00140 EQU   @NM00125+89
@NM00139 EQU   @NM00125+82
@NM00138 EQU   @NM00125+74
@NM00137 EQU   @NM00125+67
@NM00136 EQU   @NM00125+65
@NM00135 EQU   @NM00125+57
@NM00134 EQU   @NM00125+50
@NM00133 EQU   @NM00125+48
@NM00132 EQU   @NM00125+42
@NM00131 EQU   @NM00125+32
@NM00130 EQU   @NM00125+25
@NM00129 EQU   @NM00125+19
@NM00128 EQU   @NM00125+12
@NM00127 EQU   @NM00125+6
@NM00126 EQU   SUMT1
@NM00124 EQU   @NM00123+34
@NM00121 EQU   @NM00103+115
@NM00120 EQU   @NM00103+108
@NM00119 EQU   @NM00103+103
@NM00118 EQU   @NM00103+94
@NM00117 EQU   @NM00103+88
@NM00116 EQU   @NM00103+82
@NM00115 EQU   @NM00103+76
@NM00114 EQU   @NM00103+68
@NM00113 EQU   @NM00103+60
@NM00112 EQU   @NM00103+39
@NM00111 EQU   @NM00103+35
@NM00110 EQU   @NM00103+29
@NM00109 EQU   @NM00103+25
@NM00108 EQU   @NM00103+19
@NM00107 EQU   @NM00103+16
@NM00106 EQU   @NM00103+13
@NM00105 EQU   @NM00103+10
@NM00104 EQU   @NM00103+6
@NM00102 EQU   PSNS
@NM00101 EQU   @NM00096+39
@NM00100 EQU   @NM00096+22
@NM00099 EQU   @NM00096+14
@NM00098 EQU   @NM00096+11
@NM00097 EQU   @NM00096+3
@NM00095 EQU   @NM00079+123
@NM00094 EQU   @NM00079+116
@NM00093 EQU   @NM00079+111
@NM00092 EQU   @NM00079+95
@NM00091 EQU   @NM00079+64
@NM00090 EQU   @NM00079+59
@NM00089 EQU   @NM00079+53
@NM00088 EQU   @NM00079+42
@NM00087 EQU   @NM00079+36
@NM00086 EQU   @NM00079+33
@NM00085 EQU   @NM00079+29
@NM00084 EQU   @NM00079+21
@NM00083 EQU   @NM00079+18
@NM00082 EQU   @NM00079+14
@NM00081 EQU   @NM00079+6
@NM00080 EQU   @NM00079
@NM00221 EQU   CPUCUX+5
CPUMSER  EQU   CPUCUX
@NM00170 EQU   SMBUF+50
@NM00169 EQU   SMBUF+34
@NM00168 EQU   SMBUF+22
@NM00167 EQU   SMBUF+16
SMTIME   EQU   SMBUF+12
@NM00166 EQU   SMBUF+5
@NM00165 EQU   SMBUF
SENSBIT2 EQU   SENSE
SENSBIT1 EQU   SENSE
SENSBIT0 EQU   SENSE
ALUHRDER EQU   @NM00164
BUSOCHK  EQU   @NM00164
BACKWARD EQU   BUFFER+106
EXP3     EQU   @NM00163
EXP3A    EQU   @NM00163
VELCHNG  EQU   RECVEL
EXP2     EQU   RECVEL
VELRETRY EQU   SOSYMCD+1
SLWNDRD  EQU   SOSYMCD+1
SLBGRD   EQU   SOSYMP
EARLNDRD EQU   SOSYMP
EARLBGRD EQU   EXPEARL
EXP      EQU   EXPEARL
FEEDTHRU EQU   RECIBG
ORDROP   EQU   RECIBG
EXCPAMB  EQU   RECPART
PARTREC  EQU   RECPART
@NM00162 EQU   RECSTRD
WRTTMCHK EQU   RECSTRD
TRKINERR EQU   BUFFER+97
PARITY   EQU   @NM00161
MASKEXP  EQU   @NM00161
PEIDCHK  EQU   @NM00161
WRTTRVRC EQU   CCOMVRC
CCOMPARE EQU   CCOMVRC
SKEWCHK  EQU   RECOVER
OVERRUN  EQU   RECOVER
@NM00160 EQU   EDCCRC
@NM00159 EQU   RWVRC
SPAR     EQU   BUFFER+88
SOSNS14  EQU   RECLEAN
@NM00158 EQU   BUFFER+83
NOISEBLK EQU   BUFFER+82
@NM00157 EQU   PERMRDS
@NM00156 EQU   BUFFER+74
IORETRY  EQU   BUFFER+60
@NM00155 EQU   OCUA
@NM00154 EQU   BUFFER+56
@NM00153 EQU   ODEVICE
@NM00152 EQU   SECUA
@NM00151 EQU   BUFFER+48
@NM00150 EQU   BUFFER+40
@NM00149 EQU   BUFFER+22
CPUVER   EQU   BUFFER+16
@NM00148 EQU   BUFFER+4
@NM00147 EQU   SW2
@NM00146 EQU   SW2
@NM00145 EQU   SWITCHE
SYSREL   EQU   BUFFER+1
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+15
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00330 EQU   @RC00327
@RC00328 EQU   @RC00327
@RF00612 EQU   @EL00011
@RF00634 EQU   @EL00012
@RC00901 EQU   @RC00900
@RC00897 EQU   @RC00865
@RC00829 EQU   @EL00015
@RF00981 EQU   @EL00017
@RC00973 EQU   @EL00017
@RC01000 EQU   @EL00018
@RF01022 EQU   @EL00019
@RF01039 EQU   @EL00020
@RF01072 EQU   @EL00021
@RC01096 EQU   @RC01095
@RC01108 EQU   @RC01107
@RC01114 EQU   @RC01105
@RF01155 EQU   @EL00024
@RC01162 EQU   @EL00024
@RC01265 EQU   @RC01264
@RF01369 EQU   @EL00034
@RC01405 EQU   @EL00036
@RC01420 EQU   @EL00037
@RC01434 EQU   @EL00037
@RC01455 EQU   @RC01453
@RF01476 EQU   @EL00038
@RF01511 EQU   @EL00038
@RF01519 EQU   @EL00038
@RC01517 EQU   @EL00038
@RC01515 EQU   @EL00038
@RC01513 EQU   @EL00038
@PB00038 EQU   @PB00039
@RF01554 EQU   @EL00039
@RF01607 EQU   @RC01577
@RF01628 EQU   @EL00001
@RF00976 EQU   @RC00973
@RF01003 EQU   @RC01000
@RC01266 EQU   @RC01265
@RC01426 EQU   @RC01420
@RC01437 EQU   @RC01434
@PB00037 EQU   @PB00038
@RC01457 EQU   @RC01455
@RC01267 EQU   @RC01266
@PB00036 EQU   @PB00037
@RC01459 EQU   @RC01457
@PB00035 EQU   @PB00036
@RC01461 EQU   @RC01459
@PB00034 EQU   @PB00035
@PB00033 EQU   @PB00034
@PB00032 EQU   @PB00033
@PB00031 EQU   @PB00032
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCTHRSH

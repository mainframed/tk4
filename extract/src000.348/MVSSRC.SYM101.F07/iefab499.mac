         TITLE 'IEFAB499 - VM&&V WTO/R FORMAT RTN                      *
                         '
IEFAB499 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB499  73.325'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE  R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(20),0(@01)                              01S0001
         MODESET EXTKEY=SCHED
*                                        SCAN                        */
*RETCODE = ZERO;                       /*INITIALIZE RETURN CODE      */
         SLR   RETCODE,RETCODE                                  01S0027
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - A499INIT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - IEFAB499 MESSAGE INITIALIZATION               */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE PERFORMS THE FOLLOWING INITIALIZATION FUNCTIONS:  */
*/*     .GETS CORE FOR THE WTO/R PARAMETER LIST                      */
*/*     .ESTABLISHES ADDRESSABILITY TO THE PARM LIST AND TO THE      */
*/*      TEXT BUFFER                                                 */
*/*     .DETERMINES THE LENGTH OF THE JOB NAME, STEP NAME AND/OR     */
*/*      DATA SET NAME TO BE USED IN THE MESSAGE                     */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   INPUT -                                                        */
*/*     DSNAMEP - PTR TO DSNAME OR 0                                 */
*/*     JOBNAMEP - PTR TO JOB NAME OR 0                              */
*/*     STEPNAMP - PTR TO STEP NAME OR 0                             */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - INITIALIZATION COMPLETED SUCCESSFULLY              */
*/*     OUTPUT -                                                     */
*/*       DSNAMELM - LENGTH OF DATA SET NAME OR 0                    */
*/*       JOBNAMLN - LENGTH OF JOB NAME OR 0                         */
*/*       LINECNT  - LINE COUNT = 1                                  */
*/*       MSGPTR   - PTR TO START OF TEXT BUFFER                     */
*/*       WPLPTR   - PTR TO START OF WTO PARM LIST (WPL)             */
*/*       WTOLISTP - PTR TO WTO/R PARM LIST (IN INPUT PARM AREA)     */
*/*       WTOLSTLN - LENGTH OF PARM LIST (IN INPUT PARM AREA)        */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 0                                                */
*/*   CONDITION - NO CORE AVAILABLE FOR WPL                          */
*/*     OUTPUT - NONE                                                */
*/*     RETURN CODE                                                  */
*/*       RETCODE = 4                                                */
*/********************************************************************/
* /* ?GETSTORG (SUBPL230,MAXBUFR,WPLPTR);*/                     02S0028
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0028
*   DCL                                                         02S0028
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0028
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0028
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0028
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0028
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0028
*   DCL                                                         02S0029
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               02S0029
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               02S0029
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               02S0029
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               02S0029
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               02S0029
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               02S0029
*     GTSTZERO FIXED(31) INIT(0),                               02S0029
*     GTST253  FIXED(31) CONSTANT(253);                         02S0029
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0030
*   GTSTR0 = MAXBUFR; /* SET AMOUNT*/                           02S0031
         LA    GTSTR0,160                                       02S0031
*   GTSTR2 = SUBPL230; /* SET SUBPOOL*/                         02S0032
         LA    GTSTR2,230                                       02S0032
*   GENERATE CODE;                                              02S0033
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0034
         LR    GTSTRTCD,GTSTR15                                 02S0034
*   WPLPTR = GTSTR1; /* ADDR OF GOTN STORG*/                    02S0035
         LR    WPLPTR,GTSTR1                                    02S0035
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0036
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               02S0037
         LTR   GTSTRTCD,GTSTRTCD                                02S0037
         BNZ   @RF00037                                         02S0037
*     DO;               /* YES, CLEAR STORAGE.*/                02S0038
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0039
*                          GTSTR7,GTSTR8) RSTD;                 02S0039
*       GTSTR4 = WPLPTR; /*STORG PTR*/                          02S0040
         LR    GTSTR4,WPLPTR                                    02S0040
*       GTSTR5 = MAXBUFR; /*STORG AMNT*/                        02S0041
         LA    GTSTR5,160                                       02S0041
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               02S0042
         SLR   GTSTR7,GTSTR7                                    02S0042
*       IF SUBPL230 = GTST253 THEN                              02S0043
         B     @RF00043                                         02S0043
*      GEN                                                      02S0044
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           02S0044
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*       GEN REFS(GTSTR4,GTSTR6);                                02S0045
@RF00043 DS    0H                                               02S0045
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*       IF SUBPL230 = GTST253 THEN                              02S0046
         B     @RF00046                                         02S0046
*         GEN (MODESET KEYADDR=(2));                            02S0047
         MODESET KEYADDR=(2)
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0048
*                          GTSTR7,GTSTR8) UNRSTD;               02S0048
@RF00046 DS    0H                                               02S0049
*     END;       /* STORAGE CLEARING COMPLETED */               02S0049
*   ELSE                                                        02S0050
*   WPLPTR= 0;   /* CLEAR RETURN ADDR. */                       02S0050
         B     @RC00037                                         02S0050
@RF00037 SLR   WPLPTR,WPLPTR                                    02S0050
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0051
@RC00037 LR    GTSTR15,GTSTRTCD                                 02S0051
*                                      /* RESTORE LIST PRINT STATUS  */
*  /*GET CORE FOR MSG BUFFER     */                             02S0052
*RETCODE = REG15;                      /*SAVE RETURN CODE            */
         LR    RETCODE,REG15                                    02S0052
*IF RETCODE = ZERO THEN                /*CORE GOTTEN O.K.            */
         LTR   RETCODE,RETCODE                                  02S0053
         BNZ   @RF00053                                         02S0053
*  DO;                                 /*CONTINUE INITIALIZATION     */
*    WTOLISTP = WPLPTR;                /*SET PTR TO BUFF IN PARM BLK */
         L     @10,@PC00001                                     02S0055
         ST    WPLPTR,WTOLISTP(,@10)                            02S0055
*    WTOLSTLN = MAXBUFR;               /*SET LENGTH OF BUFFER        */
         MVC   WTOLSTLN(2,@10),@CH00256                         02S0056
*    IF MSGID = VERMSG THEN            /*MSG WILL NEED WTOR PREFIX   */
         CLI   MSGID(@10),4                                     02S0057
         BNE   @RF00057                                         02S0057
*      WPLPTR = WPLPTR + PREFXLEN;     /*ADJUST PTR PASS PREFIX      */
         AL    WPLPTR,PREFXLEN                                  02S0058
*    MSGPTR = ADDR(WPLTXT);            /*INIT BUFF PTR TO BEGINNING
*                                        OF TEXT AREA                */
@RF00057 LA    @10,WPLTXT(,WPLPTR)                              02S0059
         ST    @10,MSGPTR                                       02S0059
*    EVNTACTN = OFF;                   /*INIT EVENTUAL ACTION INDIC  */
         NI    EVNTACTN,B'01111111'                             02S0060
*    LINECNT = ONE;                    /*INIT LINE COUNT             */
         MVI   LINECNT,X'01'                                    02S0061
*    JOBNAMLN = ZERO;                  /*INIT LENGTH OF JOBNAME      */
         SLR   @10,@10                                          02S0062
         STH   @10,JOBNAMLN                                     02S0062
*    STPNAMLN = ZERO;                  /*INIT LENGTH OF STEPNAME     */
         STH   @10,STPNAMLN                                     02S0063
*    DSNAMELN = ZERO;                  /*INIT LENGTH OF DSNAME       */
         STH   @10,DSNAMELN                                     02S0064
*    IF JOBNAMEP ^= ZERO THEN          /*JOB NAME NEEDED             */
         L     @08,@PC00001+8                                   02S0065
         C     @10,JOBNAMEP(,@08)                               02S0065
         BE    @RF00065                                         02S0065
*      DO;                             /*GET NUMBER NON-BLANK CHARS  */
*        JOBNAMLN = MAXJNMLN;          /*SET MAX LENGTH OF NAME      */
         MVC   JOBNAMLN(2),@CH00049                             02S0067
*        CALL SQUEEZE(JOBNAMEP,JOBNAMLN); /*COMPRESS BLANKS FROM NAME*/
         ST    @08,@AL00001                                     02S0068
         LA    @10,JOBNAMLN                                     02S0068
         ST    @10,@AL00001+4                                   02S0068
         LA    @01,@AL00001                                     02S0068
         BAL   @14,SQUEEZE                                      02S0068
*      END;                                                     02S0069
*    IF STEPNAMP ^= ZERO THEN          /*STEP NAME NEEDED            */
@RF00065 L     @10,@PC00001+12                                  02S0070
         ICM   @08,15,STEPNAMP(@10)                             02S0070
         BZ    @RF00070                                         02S0070
*      DO;                             /*GET LENGTH FOR MSG          */
*        STPNAMLN = MAXSNMLN;          /*SET MAX LENGTH              */
         MVC   STPNAMLN(2),@CH00049                             02S0072
*        CALL SQUEEZE(STEPNAMP,STPNAMLN); /*COMPRESS BLANKS          */
         ST    @10,@AL00001                                     02S0073
         LA    @10,STPNAMLN                                     02S0073
         ST    @10,@AL00001+4                                   02S0073
         LA    @01,@AL00001                                     02S0073
         BAL   @14,SQUEEZE                                      02S0073
*      END;                                                     02S0074
*    IF DSNAMEP ^= ZERO THEN           /*DS NAME NEEDED              */
@RF00070 L     @10,@PC00001+16                                  02S0075
         ICM   @08,15,DSNAMEP(@10)                              02S0075
         BZ    @RF00075                                         02S0075
*      DO;                             /*GET LENGTH FOR MSG          */
*        DSNAMELN = MAXDSNLN;          /*SET MAXIMUM LENGTH          */
         MVC   DSNAMELN(2),@CH00258                             02S0077
*        CALL SQUEEZE(DSNAMEP,DSNAMELN); /*GET NO. NON-BLANK CHARS   */
         ST    @10,@AL00001                                     02S0078
         LA    @10,DSNAMELN                                     02S0078
         ST    @10,@AL00001+4                                   02S0078
         LA    @01,@AL00001                                     02S0078
         BAL   @14,SQUEEZE                                      02S0078
*      END;                                                     02S0079
*  END;                                                         02S0080
*ELSE;                                 /*NO CORE AVAILABLE FOR BUFFER*/
@RF00053 DS    0H                                               02S0082
*IF RETCODE = ZERO THEN                /*BUFFER CORE OBTAINED O.K.   */
@RC00053 SLR   @10,@10                                          01S0082
         CR    RETCODE,@10                                      01S0082
         BNE   @RF00082                                         01S0082
*  DO;                                 /*BUILD REQUIRED MESSAGE      */
*    IF MSGID = VERMSG THEN            /*NEED VERIFY  MESSAGE        */
         L     @08,@PC00001                                     01S0084
         CLI   MSGID(@08),4                                     01S0084
         BNE   @RF00084                                         01S0084
*      DO;                                                      01S0085
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BVERMSG                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD VERIFY MESSAGE (IEF369D)                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE CONSTRUCTS THE VERIFY MESSAGE USING DATA OBTAINED */
*/*   FROM THE INPUT PARAMETER AREA AND THE MESSAGE MODULE, IEFAB4M4.*/
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     A PTR TO THE TEXT OF THE VERIFY MESSAGE IS RECEIVED AS       */
*/*     INPUT (ADINFOP). THE MESSAGE ID, THE JOB AND STEP NAMES  (IF */
*/*     PRESENT), AND THE MESSAGE TEXT ARE POSITIONED IN THE         */
*/*     MESSAGE BUFFER AND THE WTO/R PARAMETER LIST COMPLETED (VIA   */
*/*     THE 'COMPLWPL' SUBROUTINE).                                  */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   INPUT -                                                        */
*/*     ADINFOP  - PTR TO VERIFY MESSAGE TEXT                        */
*/*     ADINFOLN - LENGTH OF TEXT                                    */
*/*     JOBNAMLN - LENGTH OF JOBNAME                                 */
*/*     JOBNAMEP - PTR TO JOBNAME                                    */
*/*     LINECNT  - CURRENT LINE NUMBER (ALWAYS 1 FOR VERIFY MSG)     */
*/*     MSGPTR   - PTR TO START OF TEXT BUFFER                       */
*/*     STEPNAMP - PTR TO STEP NAME                                  */
*/*     STPNAMLN - LENGTH OF STEP NAME                               */
*/*     WPLPTR   - PTR TO START OF WTO PARM LIST                     */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - WTO PARM LIST FOR VERIFY MESSAGE COMPLETED         */
*/*     OUTPUT -                                                     */
*/*       COMPLETED WPL FOR VERIFY MESSAGE                           */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*VMSGID = MSGNO(MSGID);                /*GET MSG ID FROM MSG MODULE  */
         L     @02,MSGPTR                                       02S0086
         SLR   @15,@15                                          02S0086
         IC    @15,MSGID(,@08)                                  02S0086
         SLA   @15,3                                            02S0086
         L     @08,@CA00292                                     02S0086
         ALR   @08,@15                                          02S0086
         AL    @08,@CF00328                                     02S0086
         MVC   VMSGID(8,@02),MSGNO-MSGNO(@08)                   02S0086
*VMSGJNM(1:JOBNAMLN) = JOBNAME(1:JOBNAMLN); /*INSERT JOB NAME IN MSG */
         LH    @08,JOBNAMLN                                     02S0087
         LR    @15,@08                                          02S0087
         BCTR  @15,0                                            02S0087
         L     @14,@PC00001+8                                   02S0087
         L     @01,JOBNAMEP(,@14)                               02S0087
         EX    @15,@SM00329                                     02S0087
*MSGPTR = MSGPTR + LENGTH(VMSGID) + JOBNAMLN; /*UPDATE BUFFER PTR    */
         AH    @02,@CH00049                                     02S0088
         ALR   @02,@08                                          02S0088
         ST    @02,MSGPTR                                       02S0088
*IF STPNAMLN ^= ZERO THEN              /*STEP NAME PRESENT FOR MSG   */
         LH    @08,STPNAMLN                                     02S0089
         CR    @08,@10                                          02S0089
         BE    @RF00089                                         02S0089
*  DO;                                                          02S0090
*    VMSGDLIM = COMMA;                 /*INSERT DELIMITER            */
         MVC   VMSGDLIM(1,@02),COMMA                            02S0091
*    VMSGSTNM(1:STPNAMLN) = STEPNAME(1:STPNAMLN); /*ADD STEP NAME    */
         LR    @10,@08                                          02S0092
         BCTR  @10,0                                            02S0092
         L     @15,@PC00001+12                                  02S0092
         L     @01,STEPNAMP(,@15)                               02S0092
         EX    @10,@SM00331                                     02S0092
*    MSGPTR = MSGPTR + STPNAMLN + COMMALEN; /*UPDATE BUFFER PTR      */
         ALR   @02,@08                                          02S0093
         AH    @02,COMMALEN                                     02S0093
         ST    @02,MSGPTR                                       02S0093
*  END;                                                         02S0094
*ELSE;                                 /*NO STEP NAME FOR MSG        */
@RF00089 DS    0H                                               02S0096
*MSG(1:ADINFOLN) = ADDLINFO(1:ADINFOLN); /*PUT MSG TEXT INTO BUFFER  */
         L     @10,MSGPTR                                       02S0096
         L     @08,@PC00001                                     02S0096
         LH    @15,ADINFOLN(,@08)                               02S0096
         LR    @14,@15                                          02S0096
         BCTR  @14,0                                            02S0096
         L     @08,ADINFOP(,@08)                                02S0096
         EX    @14,@SM00333                                     02S0096
*MSGPTR = MSGPTR + ADINFOLN;           /*UPDATE BUFFER PTR           */
         ALR   @10,@15                                          02S0097
         ST    @10,MSGPTR                                       02S0097
*MSGLNTH = MSGPTR - ADDR(WPLTXT);      /*SET LENGTH OF MSG           */
         LA    MSGLNTH,WPLTXT(,WPLPTR)                          02S0098
         SLR   @10,MSGLNTH                                      02S0098
         LR    MSGLNTH,@10                                      02S0098
*CALL COMPLWPL;                        /*COMPLETE THE WTO PARM LIST  */
         BAL   @14,COMPLWPL                                     02S0099
*      END;                                                     01S0100
*    ELSE                                                       01S0101
*      DO;                                                      01S0101
         B     @RC00084                                         01S0101
@RF00084 DS    0H                                               01S0102
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BLDBASIC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD BASIC MOUNT/DISMOUNT MESSAGE            */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE CONSTRUCTS THE BASIC PORTION OF A MOUNT OR A      */
*/*   DISMOUNT (UNLOAD) MESSAGE USING DATA FROM THE INPUT PARAMETER  */
*/*   AREA AND THE MESSAGE MODULE IEFAB4M4. THE MESSAGE BUILT        */
*/*   INCLUDES ALL OF THE DATA SPECIFIED UP TO THE JOBSTEP NAME      */
*/*   (I.E., MSGID, ACTION CODE, UNIT NAME, VOLUME SERIAL,           */
*/*   VOLUME ATTRIBUTE, JOB NAME AND STEP NAME).                     */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE ROUTINE WILL FIRST INSERT ALL REQUIRED DATA INTO THE     */
*/*     MESSAGE BUFFER. FOR OPTIONAL DATA THE ROUTINE MUST INSERT    */
*/*     THE DATA IF IT IS SPECIFIED. OTHERWISE ITS ABSENCE FROM      */
*/*     THE MESSAGE MUST BE DENOTED BY A COMMA.                      */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   INPUT -                                                        */
*/*     ACTCODE - INDEX TO MESSAGE ACTION CODE TEXT                  */
*/*     ATTRIBUT - INDEX TO VOLUME ATTRIBUTE TEXT                    */
*/*     JOBNAMLN - LENGTH OF JOB NAME IF GIVEN, ZERO OTHERWISE       */
*/*     JOBNAMEP - PTR TO JOB NAME FOR MSG                           */
*/*     MSGID - INDEX TO MESSAGE ID                                  */
*/*     MSGPTR - PTR TO MESSAGE TEXT BUFFER                          */
*/*     STPNAMLN  - LENGTH OF STEP NAME IF GIVEN,ZERO OTHERWISE      */
*/*     STEPNAMP - PTR TO STEP NAME                                  */
*/*     UNITNAME - UNIT NAME FOR MESSAGE                             */
*/*     VOLSERP - PTR TO VOLSER FOR MESSAGE OR ZERO                  */
*/*     WPLPTR - PTR TO START OF WPL                                 */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - BASIC MESSAGE CONSTRUCTED IN BUFFER                */
*/*     OUTPUT -                                                     */
*/*       MSG - MESSAGE BUFFER COMPLETE THRU STEP NAME FIELD         */
*/*       MSGPTR - PTR TO NEXT AVAILABLE POSITION IN BUFFER          */
*/*       MSGLNTH - LENGTH OF TEXT CURRENTLY IN BUFFER               */
*/*     RETURN CODE - NONE                                           */
*/********************************************************************/
*MSGIDENT = MSGNO(MSGID);              /*GET MESSAGE ID FROM MSG MOD */
         L     @10,MSGPTR                                       02S0102
         L     @08,@PC00001                                     02S0102
         SLR   @02,@02                                          02S0102
         IC    @02,MSGID(,@08)                                  02S0102
         SLA   @02,3                                            02S0102
         L     @15,@CA00292                                     02S0102
         ALR   @15,@02                                          02S0102
         AL    @15,@CF00328                                     02S0102
         MVC   MSGIDENT(8,@10),MSGNO-MSGNO(@15)                 02S0102
*ACTNCODE = ACTION(ACTCODE);           /*GET ACTION CODE             */
         SLR   @02,@02                                          02S0103
         IC    @02,ACTCODE(,@08)                                02S0103
         ALR   @02,@02                                          02S0103
         L     @15,@CA00290                                     02S0103
         ALR   @15,@02                                          02S0103
         AL    @15,@CF00335                                     02S0103
         MVC   ACTNCODE(2,@10),ACTION-ACTION(@15)               02S0103
*MSGUNAME = UNITNAME;                  /*INSERT INPUT UNIT NAME      */
         MVC   MSGUNAME(3,@10),UNITNAME(@08)                    02S0104
*MSGDLIM = COMMA;                      /*INSERT DELIMITER            */
         MVC   MSGDLIM(1,@10),COMMA                             02S0105
*MSGPTR = MSGPTR + LENGTH(HDRFMT);     /*UPDATE TEXT PTR TO NEXT SLOT*/
         AH    @10,@CH00201                                     02S0106
         ST    @10,MSGPTR                                       02S0106
*IF VOLSERP ^= ZERO &                  /*VOL SER SUPPLIED FOR MSG    */
*    VOLSER(1) ^= NSPTAPE &            /*NOT 'FF' VOL SER            */
*    VOLSER ^= ZEROVLSR THEN           /*NOT A ZERO VOL SER          */
         L     @08,@PC00001+4                                   02S0107
         L     @08,VOLSERP(,@08)                                02S0107
         LTR   @08,@08                                          02S0107
         BZ    @RF00107                                         02S0107
         CLC   VOLSER(1,@08),NSPTAPE                            02S0107
         BE    @RF00107                                         02S0107
         CLC   VOLSER(6,@08),ZEROVLSR                           02S0107
         BE    @RF00107                                         02S0107
*  DO;                                                          02S0108
*    MSGVLSER = VOLSER;                /*PUT VOLSER INTO BUFFER      */
         MVC   MSGVLSER(6,@10),VOLSER(@08)                      02S0109
*    MSGPTR = MSGPTR + LENGTH(VOLSER); /*UPDATE BUFFER PTR           */
         AH    @10,@CH00203                                     02S0110
         ST    @10,MSGPTR                                       02S0110
*  END;                                                         02S0111
*MSG(1) = COMMA;                       /*INSERT DELIMITER            */
@RF00107 L     @10,MSGPTR                                       02S0112
         MVC   MSG(1,@10),COMMA                                 02S0112
*MSGPTR = MSGPTR + COMMALEN;           /*UPDATE TO NEXT BUFFR POS'N  */
         AH    @10,COMMALEN                                     02S0113
         ST    @10,MSGPTR                                       02S0113
*IF ATTRIBUT ^= ZERO THEN              /*ATTRIBUTE NEEDED IN MSG     */
         L     @08,@PC00001                                     02S0114
         CLI   ATTRIBUT(@08),0                                  02S0114
         BE    @RF00114                                         02S0114
*  DO;                                                          02S0115
*    ATTRPTR = ADDR(ATRIBUTE)          /*GET PTR TO ATTRIBUTE IN MSG
*                                        MODULE                      */
*        + ATTROFFS(ATTRIBUT);         /*OFFSET TO TEXT IN MSG MOD   */
         L     ATTRPTR,@CV00291                                 02S0116
         SLR   @05,@05                                          02S0116
         IC    @05,ATTRIBUT(,@08)                               02S0116
         ALR   @05,@05                                          02S0116
         L     @08,@CA00284                                     02S0116
         LA    @01,0(@05,@08)                                   02S0116
         AL    @01,@CF00336                                     02S0116
         SLR   @00,@00                                          02S0116
         IC    @00,ATTROFFS-ATTROTAB-1(,@01)                    02S0116
         ALR   ATTRPTR,@00                                      02S0116
*    ATTRLEN = ATTRLNTH(ATTRIBUT);     /*GET LENGTH OF ATTRIBUTE     */
         AL    @08,@CF00335                                     02S0117
         SLR   ATTRLEN,ATTRLEN                                  02S0117
         IC    ATTRLEN,ATTRLNTH-ATTROTAB(@05,@08)               02S0117
*    MSG(1:ATTRLEN) = ATTRTEXT(1:ATTRLEN); /*MOVE ATTRIBUTE TO BUFFER*/
         LR    @08,ATTRLEN                                      02S0118
         BCTR  @08,0                                            02S0118
         EX    @08,@SM00337                                     02S0118
*    MSGPTR = MSGPTR + ATTRLEN;        /*UPDATE BUFFER PTR           */
         ALR   @10,ATTRLEN                                      02S0119
         ST    @10,MSGPTR                                       02S0119
*  END;                                                         02S0120
*MSG(1) = COMMA;                       /*INSERT DATA DELIMITER       */
@RF00114 L     @10,MSGPTR                                       02S0121
         MVC   MSG(1,@10),COMMA                                 02S0121
*MSGPTR = MSGPTR + COMMALEN;           /*UPDATE TO NEXT BUFF POS'N   */
         AH    @10,COMMALEN                                     02S0122
         ST    @10,MSGPTR                                       02S0122
*IF JOBNAMLN ^= ZERO THEN              /*JOB NAME TO GO IN MSG       */
         LH    @08,JOBNAMLN                                     02S0123
         LTR   @08,@08                                          02S0123
         BZ    @RF00123                                         02S0123
*  DO;                                                          02S0124
*    MSG(1:JOBNAMLN) = JOBNAME(1:JOBNAMLN); /*MOVE JOBNAME TO BUFFER */
         LR    @02,@08                                          02S0125
         BCTR  @02,0                                            02S0125
         L     @15,@PC00001+8                                   02S0125
         L     @01,JOBNAMEP(,@15)                               02S0125
         EX    @02,@SM00339                                     02S0125
*    MSGPTR = MSGPTR + JOBNAMLN;       /*UPDATE BUFFER PTR           */
         ALR   @10,@08                                          02S0126
         ST    @10,MSGPTR                                       02S0126
*  END;                                                         02S0127
*MSG(1) = COMMA;                       /*INSERT DELIMITER            */
@RF00123 L     @10,MSGPTR                                       02S0128
         MVC   MSG(1,@10),COMMA                                 02S0128
*MSGPTR = MSGPTR + COMMALEN;           /*UPDATE BUFFER PTR           */
         AH    @10,COMMALEN                                     02S0129
         ST    @10,MSGPTR                                       02S0129
*IF STPNAMLN ^= ZERO THEN              /*STEP NAME TO GO IN MSG      */
         LH    @08,STPNAMLN                                     02S0130
         LTR   @08,@08                                          02S0130
         BZ    @RF00130                                         02S0130
*  DO;                                                          02S0131
*    MSG(1:STPNAMLN) = STEPNAME(1:STPNAMLN); /*MOVE STEP NAME TO BUFF*/
         LR    @02,@08                                          02S0132
         BCTR  @02,0                                            02S0132
         L     @15,@PC00001+12                                  02S0132
         L     @01,STEPNAMP(,@15)                               02S0132
         EX    @02,@SM00341                                     02S0132
*    MSGPTR = MSGPTR + STPNAMLN;       /*UPDATE BUFFER PTR           */
         ALR   @10,@08                                          02S0133
         ST    @10,MSGPTR                                       02S0133
*  END;                                                         02S0134
*MSG(1) = COMMA;                       /*UNSERT DELIMITER            */
@RF00130 L     @10,MSGPTR                                       02S0135
         MVC   MSG(1,@10),COMMA                                 02S0135
*MSGPTR = MSGPTR + COMMALEN;           /*UPDATE BUFFER PTR           */
         AH    @10,COMMALEN                                     02S0136
         ST    @10,MSGPTR                                       02S0136
*MSGLNTH = MSGPTR - ADDR(WPLTXT);      /*CALC CURRENT MSG LENGTH     */
         LA    MSGLNTH,WPLTXT(,WPLPTR)                          02S0137
         SLR   @10,MSGLNTH                                      02S0137
         LR    MSGLNTH,@10                                      02S0137
*        IF MSGID = UNLDMSG THEN       /*UNLOAD MESSAGE REQUESTED    */
         L     @10,@PC00001                                     01S0138
         CLI   MSGID(@10),2                                     01S0138
         BNE   @RF00138                                         01S0138
*          DO;                         /*COMPLETE UNLOAD MESSAGE     */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BUNLDMSG                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD UNLOAD MESSAGE (IEF234E)                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE COMPLETES THE CONSTRUCTION OF AN UNLOAD (DISMOUNT)*/
*/*   MESSAGE.                                                       */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE BASIC TEXT OF THE UNLOAD MESSAGE IS RECEIVED AS INPUT TO */
*/*     THIS ROUTINE. IF ADDITIONAL TEXT WAS REQUESTED BY THE CALLER */
*/*     (ADINFOP ^= ZERO), THAT TEXT IS ADDED TO THE MESSAGE. IF THE */
*/*     TEXT CANNOT FIT ON THE CURRENT LINE OF THE MESSAGE, A LINE   */
*/*     SWITCH WILL BE DONE (VIA THE 'CHNGLINE' SUBROUTINE). EXTRA   */
*/*     COMMAS PRIOR TO THE ADDITIONAL TEXT WILL BE DELETED, LEAVING */
*/*     ONE COMMA BEFORE THE TEXT.                                   */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*   INPUT -                                                        */
*/*     ADINFOP  - PTR TO ADDITIONAL TEXT OR 0                       */
*/*     ADINFOLN - LENGTH OF ADDITIONAL TEXT                         */
*/*     LINECNT  - CURRENT LINE NUMBER                               */
*/*     MSGPTR   - PTR TO NEXT BUFFER POSITION                       */
*/*     MSGLNTH  - LENGTH OF TEXT CURRENTLY IN BUFFER                */
*/*     WPLPTR   - PTR TO START OF WTO PARM LIST (WPL)               */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - WTO PARM LIST FOR UNLOAD MESSAGE COMPLETED         */
*/*     OUTPUT -                                                     */
*/*       WPL COMPLETED FOR UNLOAD MESSAGE                           */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*DO WHILE(EOLCHAR = COMMA);            /*REMOVE TRAILING COMMAS      */
         B     @DE00140                                         02S0140
@DL00140 DS    0H                                               02S0141
*  MSGPTR = MSGPTR - COMMALEN;         /*DECREMENT PTR TO E-O-L CHAR */
         LH    @10,COMMALEN                                     02S0141
         L     @08,MSGPTR                                       02S0141
         SLR   @08,@10                                          02S0141
         ST    @08,MSGPTR                                       02S0141
*  MSGLNTH = MSGLNTH - COMMALEN;       /* DECREMENT PTR TO TEXT      */
         SLR   MSGLNTH,@10                                      02S0142
*END;                                                           02S0143
@DE00140 L     @10,MSGPTR                                       02S0143
         LR    @08,@10                                          02S0143
         BCTR  @08,0                                            02S0143
         CLC   EOLCHAR(1,@08),COMMA                             02S0143
         BE    @DL00140                                         02S0143
*IF ADINFOP ^= ZERO THEN               /*SPACE INFO NEED IN UNLD MSG */
         L     @08,@PC00001                                     02S0144
         ICM   @15,15,ADINFOP(@08)                              02S0144
         BZ    @RF00144                                         02S0144
*  DO;                                                          02S0145
*    MSG(1) = COMMA;                   /*ADD COMMA BEFORE INFO       */
         MVC   MSG(1,@10),COMMA                                 02S0146
*    MSGPTR = MSGPTR + COMMALEN;       /*UPDATE BUFFER PTR           */
         LH    @15,COMMALEN                                     02S0147
         ALR   @10,@15                                          02S0147
         ST    @10,MSGPTR                                       02S0147
*    MSGLNTH = MSGLNTH + COMMALEN;     /*UPDATE TEXT LENGTH          */
         ALR   MSGLNTH,@15                                      02S0148
*    IF MSGLNTH + ADINFOLN > ONELINE THEN /*NEED NEW LINE FOR ADD'L
*                                        TEXT                        */
         LR    @10,MSGLNTH                                      02S0149
         AH    @10,ADINFOLN(,@08)                               02S0149
         CH    @10,@CH00272                                     02S0149
         BNH   @RF00149                                         02S0149
*      CALL CHNGLINE;                  /*SWITCH LINES IN PARM LIST   */
         BAL   @14,CHNGLINE                                     02S0150
*    ELSE;                             /*ADD'L TEXT FITS ON CURRENT
*                                        LINE                        */
@RF00149 DS    0H                                               02S0152
*    MSG(1:ADINFOLN) = ADDLINFO(1:ADINFOLN); /*INSERT SPACE INFO     */
         L     @10,MSGPTR                                       02S0152
         L     @08,@PC00001                                     02S0152
         LH    @15,ADINFOLN(,@08)                               02S0152
         LR    @14,@15                                          02S0152
         BCTR  @14,0                                            02S0152
         L     @08,ADINFOP(,@08)                                02S0152
         EX    @14,@SM00333                                     02S0152
*    MSGLNTH = MSGLNTH + ADINFOLN;     /*UPDATE TEXT LENGTH          */
         ALR   MSGLNTH,@15                                      02S0153
*    MSGPTR = MSGPTR + ADINFOLN;       /*UPDATE BUFFER PTR           */
         ALR   @10,@15                                          02S0154
         ST    @10,MSGPTR                                       02S0154
*  END;                                                         02S0155
*ELSE;                                 /*NO SPACE INFO FOR MESSAGE   */
@RF00144 DS    0H                                               02S0157
*EVNTACTN = ON;                        /*INDICATE 'EVENTUAL ACTION
*                                        MESSAGE                     */
         OI    EVNTACTN,B'10000000'                             02S0157
*CALL COMPLWPL;                        /*COMPLETE THE WTO PARM LIST  */
         BAL   @14,COMPLWPL                                     02S0158
*          END;                                                 01S0159
*        ELSE                          /*MSGID NOT FOR UNLOAD MSG    */
*          DO;                         /*COMPLETE MOUNT/MOUNT REPLY
*                                        MSG                         */
         B     @RC00138                                         01S0160
@RF00138 DS    0H                                               01S0161
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BMNTMSG                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD MOUNT MESSAGE (IEF233A OR IEF233D)      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE COMPLETES THE MOUNT MESSAGE. IF THE MESSAGE       */
*/*   REQUIRES A REPLY, THE WTO MESSAGE IS ISSUED AND THE PARAMETER  */
*/*   LIST FOR THE SUBSEQUENT WTOR IS CONSTRUCTED (SEE BLDWTOR).     */
*/*   TRAILING COMMAS ARE DELETED.                                   */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   INPUT -                                                        */
*/*     ADINFOLN - LENGTH OF ADDITIONAL TEXT FOR MOUNT WITH REPLY OPT*/
*/*     ADINFOP - PTR TO ADDITIONAL TEXT                             */
*/*     DSNAMELN - LENGTH OF DSNAME IF ONE GIVEN, 0 OTHERWISE        */
*/*     DSNAMEP - PTR TO DSNAME                                      */
*/*     MSGID - INDEX TO ID OF MESSAGE TO BE ISSUED                  */
*/*     MSGLNTH - LENGTH OF CURRENT TEXT IN PARM LIST                */
*/*     MSGPTR  - PTR TO NEXT DATA POSITION IN TEXT                  */
*/*     WPLPTR - PTR TO START OF WTO PARM LIST (WPL)                 */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - FUNCTION COMPLETED                                 */
*/*     OUTPUT -                                                     */
*/*       MOUNT MESSAGE BUILT IN MESSAGE BUFFER                      */
*/*       IF NECESSARY, MESSAGE ISSUED AND CONDITIONAL MOUNT MESSAGE */
*/*         BUILT                                                    */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*IF DSNAMELN ^= ZERO THEN              /*DSNAME NEEDED IN MESSAGE    */
         LH    @10,DSNAMELN                                     02S0161
         LTR   @10,@10                                          02S0161
         BZ    @RF00161                                         02S0161
*  DO;                                                          02S0162
*    IF MSGLNTH + DSNAMELN > ONELINE ×  /*NO ROOM ON CURRENT LINE FOR*/
*       ( MSGID = MONTRPLY &            /* FOR DSNAME AND COMMA IF IT*/
*       MSGLNTH + DSNAMELN + COMMALEN > ONELINE )  THEN /* HAS REPLY */
         LA    @08,70                                           02S0163
         ALR   @10,MSGLNTH                                      02S0163
         CR    @10,@08                                          02S0163
         BH    @RT00163                                         02S0163
         L     @15,@PC00001                                     02S0163
         CLI   MSGID(@15),3                                     02S0163
         BNE   @RF00163                                         02S0163
         AH    @10,COMMALEN                                     02S0163
         CR    @10,@08                                          02S0163
         BNH   @RF00163                                         02S0163
@RT00163 DS    0H                                               02S0164
*        CALL CHNGLINE;                /*SWITCH TO NEW LINE          */
         BAL   @14,CHNGLINE                                     02S0164
*    ELSE;                             /*DSNAME FITS ON CURRENT LINE */
@RF00163 DS    0H                                               02S0166
*    MSG(1:DSNAMELN) = DSNAME(1:DSNAMELN); /*MOVE DSNAME TO BUFFER   */
         L     @10,MSGPTR                                       02S0166
         LH    @08,DSNAMELN                                     02S0166
         LR    @15,@08                                          02S0166
         BCTR  @15,0                                            02S0166
         L     @14,@PC00001+16                                  02S0166
         L     @01,DSNAMEP(,@14)                                02S0166
         EX    @15,@SM00344                                     02S0166
*    MSGPTR = MSGPTR + DSNAMELN;       /*UPDATE MSG TEXT PTR         */
         ALR   @10,@08                                          02S0167
         ST    @10,MSGPTR                                       02S0167
*    MSGLNTH = MSGLNTH + DSNAMELN;     /*UPDATE TEXT LENGTH          */
         ALR   MSGLNTH,@08                                      02S0168
*  END;                                                         02S0169
*ELSE                                  /*NO DSNAME FOR MESSAGE       */
*  DO WHILE(EOLCHAR = COMMA);          /*REMOVE TRAILING COMMAS      */
         B     @RC00161                                         02S0170
@RF00161 B     @DE00170                                         02S0170
@DL00170 DS    0H                                               02S0171
*    MSGPTR = MSGPTR - COMMALEN;       /*DECREMENT PTR TO EOLCHAR    */
         LH    @10,COMMALEN                                     02S0171
         L     @08,MSGPTR                                       02S0171
         SLR   @08,@10                                          02S0171
         ST    @08,MSGPTR                                       02S0171
*    MSGLNTH = MSGLNTH - COMMALEN;     /*DECREMENT LENGTH OF TEXT    */
         SLR   MSGLNTH,@10                                      02S0172
*  END;                                                         02S0173
@DE00170 L     @10,MSGPTR                                       02S0173
         BCTR  @10,0                                            02S0173
         CLC   EOLCHAR(1,@10),COMMA                             02S0173
         BE    @DL00170                                         02S0173
*IF MSGID = MONTRPLY THEN              /*MOUNT REPLY MESSAGE         */
@RC00161 L     @10,@PC00001                                     02S0174
         CLI   MSGID(@10),3                                     02S0174
         BNE   @RF00174                                         02S0174
*  DO;                                 /*PUT REPLY TEXT ON NEW LINE  */
*    MSG(1) = COMMA;                   /*END TEXT WITH COMMA         */
         L     @10,MSGPTR                                       02S0176
         MVC   MSG(1,@10),COMMA                                 02S0176
*    MSGPTR = MSGPTR + COMMALEN;       /*UPDATE BUFFER PTR           */
         LH    @08,COMMALEN                                     02S0177
         ALR   @10,@08                                          02S0177
         ST    @10,MSGPTR                                       02S0177
*    MSGLNTH = MSGLNTH + COMMALEN;     /*UPDATE TEXT LENGTH          */
         ALR   MSGLNTH,@08                                      02S0178
*    CALL CHNGLINE;                    /*SET UP FOR NEXT LINE        */
         BAL   @14,CHNGLINE                                     02S0179
*    MSG(1:ADINFOLN) = ADDLINFO(1:ADINFOLN); /*INSERT REPLY TEXT     */
         L     @10,MSGPTR                                       02S0180
         L     @08,@PC00001                                     02S0180
         LH    @15,ADINFOLN(,@08)                               02S0180
         LR    @14,@15                                          02S0180
         BCTR  @14,0                                            02S0180
         L     @08,ADINFOP(,@08)                                02S0180
         EX    @14,@SM00333                                     02S0180
*    MSGPTR = MSGPTR + ADINFOLN;       /*UPDATE BUFFER PTR           */
         ALR   @10,@15                                          02S0181
         ST    @10,MSGPTR                                       02S0181
*    MSGLNTH = MSGLNTH + ADINFOLN;     /*UPDATE TEXT LENGTH          */
         ALR   MSGLNTH,@15                                      02S0182
*    EVNTACTN = ON;                    /*MSG REQUIRES EVENTUAL ACTION*/
         OI    EVNTACTN,B'10000000'                             02S0183
*  END;                                                         02S0184
*ELSE;                                 /*NOT MOUNT WITH REPLY OPT    */
@RF00174 DS    0H                                               02S0186
*CALL COMPLWPL;                        /*COMPLETE WTO PARM-LIST      */
         BAL   @14,COMPLWPL                                     02S0186
*IF MSGID = MONTRPLY THEN                                       02S0187
         L     @10,@PC00001                                     02S0187
         CLI   MSGID(@10),3                                     02S0187
         BNE   @RF00187                                         02S0187
*  DO;                                 /*ISSUE WTO & BLD WTOR        */
*    RFY (REG0,REG1) RSTD;                                      02S0189
*    REG0 = ZERO;                      /*CLEAR REG0 FOR WTO          */
         SLR   REG0,REG0                                        02S0190
*    REG1 = WPLPTR;                    /*POINT TO WTO PARM LIST      */
         LR    REG1,WPLPTR                                      02S0191
*    GEN (WTO MF=(E,(1)));             /*ISSUE MESSAGE               */
         WTO MF=(E,(1))
*    RFY (REG0,REG1) UNRSTD;                                    02S0193
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BLDWTOR                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD WTOR PARM LIST                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE BUILDS THE WTO PARAMETER THE CONDITIONAL MOUNT    */
*/*   MESSAGE USING DATA FROM THE INPUT PARAMETER AREA AND THE       */
*/*   MESSAGE MODULE, IEFAB4M4. THE CONDITIONAL MOUNT MESSAGE WILL   */
*/*   BE ISSUED AS A WRITE-TO-OPERATOR-WITH-REPLY (WTOR) BY THE      */
*/*   CALLER OF THIS MODULE.                                         */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE COMPLETE TEXT OF THE MESSAGE IS OBTAINED FROM THE        */
*/*     MESSAGE MODULE. THE VARIABLE TEXT PORTIONS OF THE MESSAGE    */
*/*     (I.E.,JOB NAME, STEP NAME, UNIT NAME AND VOLUME SERIAL)      */
*/*     ARE THEN INSERTED BY THIS ROUTINE. THE WPL IS COMPLETED VIA  */
*/*     THE 'COMPLWPL' SUBROUTINE.                                   */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   INPUT -                                                        */
*/*     WPLPTR  - PTR TO START OF WTO PARM LIST CORE                 */
*/*     WTOLSTLN - LENGTH OF PARM LIST                               */
*/*     JOBNAMEP - PTR TO JOB NAME                                   */
*/*     JOBNAMLN - LENGTH OF JOB NAME                                */
*/*     STEPNAMP - PTR TO STEP NAME (IF PRESENT)                     */
*/*     STPNAMLN - LENGTH OF STEP NAME OR 0                          */
*/*     UNITNAME - UNIT NAME (IN EBCDIC)                             */
*/*     VOLSERP  - PTR TO VOLSER                                     */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - CONDITIONAL MOUNT MSG PARM LIST COMPLETED          */
*/*     OUTPUT -                                                     */
*/*       WPL FOR CONDITIONAL MOUNT MESSAGE                          */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*MSGPTR = WPLPTR;                      /*SET PTR TO START OF P-LIST
*                                        CORE                        */
         ST    WPLPTR,MSGPTR                                    03S0194
*MSG(1:WTOLSTLN) =                     /*ZERO WPL CORE               */
*    MSG(1:WTOLSTLN) && MSG(1:WTOLSTLN);                        03S0195
         L     @10,MSGPTR                                       03S0195
         L     @08,@PC00001                                     03S0195
         LH    @15,WTOLSTLN(,@08)                               03S0195
         BCTR  @15,0                                            03S0195
         EX    @15,@SX00346                                     03S0195
*WPLPTR = WPLPTR + PREFXLEN;           /*POINT PASS WPL PREFIX       */
         AL    WPLPTR,PREFXLEN                                  03S0196
*MSGPTR = ADDR(WPLTXT);                /*BASE FOR TEXT OF MESSAGE    */
         LA    @10,WPLTXT(,WPLPTR)                              03S0197
         ST    @10,MSGPTR                                       03S0197
*FMPTR = MSGPTR;                       /*SET FIXED MSG PTR           */
         LR    FMPTR,@10                                        03S0198
*MSG(1:CMLEN) = CONDMT(1:CMLEN);       /*MOVE BASE MSG TO BUFFER     */
         L     @15,@CA00287                                     03S0199
         LH    @14,CMLEN-CNDMTMSG(,@15)                         03S0199
         BCTR  @14,0                                            03S0199
         EX    @14,@SM00348                                     03S0199
*CMSER = VOLSER;                       /*VOLSER TO BUFFER            */
         L     @10,@PC00001+4                                   03S0200
         L     @10,VOLSERP(,@10)                                03S0200
         MVC   CMSER(6,FMPTR),VOLSER(@10)                       03S0200
*CMCUA = UNITNAME;                     /*UNIT TO BUFFER              */
         MVC   CMCUA(3,FMPTR),UNITNAME(@08)                     03S0201
*CMJOB(1:JOBNAMLN) = JOBNAME(1:JOBNAMLN); /*JOBNAME TO BUFFER        */
         LH    @10,JOBNAMLN                                     03S0202
         LR    @08,@10                                          03S0202
         BCTR  @08,0                                            03S0202
         L     @15,@PC00001+8                                   03S0202
         L     @01,JOBNAMEP(,@15)                               03S0202
         EX    @08,@SM00350                                     03S0202
*MSGPTR = ADDR(CMJOB) + JOBNAMLN;      /*BUMP MSGPTR PAST JOBNAME    */
         LA    @08,CMJOB(,FMPTR)                                03S0203
         ALR   @08,@10                                          03S0203
         ST    @08,MSGPTR                                       03S0203
*IF STPNAMLN ^= ZERO THEN              /*MUST PUT IN STEPNAME        */
         LH    @10,STPNAMLN                                     03S0204
         LTR   @10,@10                                          03S0204
         BZ    @RF00204                                         03S0204
*  DO;                                                          03S0205
*    MSG(1) = COMMA;                   /*INSERT DELIMITER            */
         MVC   MSG(1,@08),COMMA                                 03S0206
*    MSGPTR = MSGPTR + COMMALEN;       /*UPDATE BUFFER PTR           */
         AH    @08,COMMALEN                                     03S0207
         ST    @08,MSGPTR                                       03S0207
*    CMSTEP(1:STPNAMLN) = STEPNAME(1:STPNAMLN); /*STEPNAME TO BUFFER */
         LR    @15,@10                                          03S0208
         BCTR  @15,0                                            03S0208
         L     @14,@PC00001+12                                  03S0208
         L     @01,STEPNAMP(,@14)                               03S0208
         EX    @15,@SM00352                                     03S0208
*    MSGPTR = MSGPTR+STPNAMLN;         /*UPDATE BUFFER PTR           */
         ALR   @08,@10                                          03S0209
         ST    @08,MSGPTR                                       03S0209
*  END;                                                         03S0210
*CMREPLY = CMFREPLY;                   /*REPLY INFO TO BUFFER        */
@RF00204 L     @10,MSGPTR                                       03S0211
         MVC   CMREPLY(14,@10),CMFREPLY(FMPTR)                  03S0211
*MSGPTR = MSGPTR+LENGTH(CMFREPLY);     /*UPDATE BUFFER PTR           */
         AH    @10,@CH00201                                     03S0212
         ST    @10,MSGPTR                                       03S0212
*MSGLNTH = MSGPTR - ADDR(WPLTXT);      /*SET LNTH OF MSG             */
         LA    MSGLNTH,WPLTXT(,WPLPTR)                          03S0213
         SLR   @10,MSGLNTH                                      03S0213
         LR    MSGLNTH,@10                                      03S0213
*LINECNT = ONE;                        /*SINGLE LINE MSG             */
         MVI   LINECNT,X'01'                                    03S0214
*EVNTACTN = OFF;                       /*NOT AN EVENTUAL ACTION MSG  */
         NI    EVNTACTN,B'01111111'                             03S0215
*CALL COMPLWPL;                        /*COMPLETE WTO PARM LIST      */
         BAL   @14,COMPLWPL                                     03S0216
*  END;                                                         02S0217
*ELSE;                                 /*NOT MOUNT WITH REPLY OPT    */
@RF00187 DS    0H                                               02S0219
*          END;                                                 01S0219
*      END;                                                     01S0220
*  END;                                                         01S0221
*ELSE;                                 /*NO CORE AVAILABLE FOR BUFFER*/
@RF00082 DS    0H                                               01S0223
*RETURN CODE (RETCODE);                                         01S0223
@RC00082 IC    @02,@OLDKEY                                      01S0223
         L     @13,4(,@13)                                      01S0223
         L     @00,@SIZDATD                                     01S0223
         LR    @01,@11                                          01S0223
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@03                                          01S0223
         L     @14,12(,@13)                                     01S0223
         LM    @00,@12,20(@13)                                  01S0223
         BR    @14                                              01S0223
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SQUEEZE                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ELIMINATE TRAILING BLANKS FROM FIELD NAMES    */
*/*                                                                  */
*/* FUNCTION - GIVEN A POINTER TO A FIELD AND A LENGTH OF THE FIELD  */
*/*   CALCULATE THE RESIDUAL COUNT OF THE NUMBER OF CHARACTERS IN THE*/
*/*   FIELD IGNORING TRAILING BLANKS.                                */
*/*                                                                  */
*/*   OPERATION - SCAN FROM RIGHT TO LEFT UNTIL FIRST NON-BLANK IS   */
*/*     ENCOUNTERED. CALCULATE RESIDUAL COUNT OF CHARACTERS IN FIELD.*/
*/*                                                                  */
*/* ENTRY POINT - SQUEEZE (INTERNAL PROCEDURE)                       */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/* INPUT DATA -                                                     */
*/*                                                                  */
*/*   PARMLEN - LENGTH OF FIELD                                      */
*/*   PARMPTR - ADDRESS OF FIELD                                     */
*/*                                                                  */
*/* EXIT -                                                           */
*/*                                                                  */
*/*   CONDITION - FIELD LENGTH SQUEEZED DOWN TO ACTUAL NUMBER OF     */
*/*               CHARACTERS IN FIELD.                               */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*       INPUT FIELD PARMLEN UPDATED TO ACTUAL LENGTH OF FIELD.     */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*SQUEEZE: PROC(PARMPTR,PARMLEN);                                02S0224
@EL00001 IC    @02,@OLDKEY                                      02S0224
         L     @13,4(,@13)                                      02S0224
@EF00001 L     @00,@SIZDATD                                     02S0224
         LR    @01,@11                                          02S0224
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
@ER00001 LM    @14,@12,12(@13)                                  02S0224
         BR    @14                                              02S0224
@PB00001 DS    0H                                               02S0224
SQUEEZE  STM   @14,@12,12(@13)                                  02S0224
         MVC   @PC00002(8),0(@01)                               02S0224
*ENDPTR = PARMPTR + PARMLEN-ONE;       /*POINT TO END OF MESSAGE     */
         L     @10,@PC00002                                     02S0225
         L     @15,@PC00002+4                                   02S0225
         LH    ENDPTR,PARMLEN(,@15)                             02S0225
         AL    ENDPTR,PARMPTR(,@10)                             02S0225
         BCTR  ENDPTR,0                                         02S0225
*DO WHILE (PARMLEN ^= ZERO &           /*SEARCH FOR FIRST NON-BLANK  */
*    LASTCHAR = BLANK);                                         02S0226
         B     @DE00226                                         02S0226
@DL00226 DS    0H                                               02S0227
*  ENDPTR = ENDPTR - ONE;                                       02S0227
         BCTR  ENDPTR,0                                         02S0227
*  PARMLEN = PARMLEN - ONE;                                     02S0228
         L     @10,@PC00002+4                                   02S0228
         LH    @03,PARMLEN(,@10)                                02S0228
         BCTR  @03,0                                            02S0228
         STH   @03,PARMLEN(,@10)                                02S0228
*END;                                                           02S0229
@DE00226 L     @10,@PC00002+4                                   02S0229
         ICM   @03,3,PARMLEN(@10)                               02S0229
         BZ    @DC00226                                         02S0229
         CLI   LASTCHAR(ENDPTR),C' '                            02S0229
         BE    @DL00226                                         02S0229
@DC00226 DS    0H                                               02S0230
*PARMLEN = ENDPTR - PARMPTR + ONE;     /*GET ACTUAL LENGTH OF FIELD  */
         L     @10,@PC00002+4                                   02S0230
         L     @03,@PC00002                                     02S0230
         LR    @15,ENDPTR                                       02S0230
         SL    @15,PARMPTR(,@03)                                02S0230
         AH    @15,@CH00060                                     02S0230
         STH   @15,PARMLEN(,@10)                                02S0230
*END;                                                           02S0231
@EL00002 DS    0H                                               02S0231
@EF00002 DS    0H                                               02S0231
@ER00002 LM    @14,@12,12(@13)                                  02S0231
         BR    @14                                              02S0231
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - COMPLWPL                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - COMPLETE WTO PARAMETER LIST (WPL)             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE COMPLETES THE BUILDING OF A WRITE-TO-OPERATOR     */
*/*   PARAMETER LIST BY FILLING IN THE FOLLOWING INFORMATION:        */
*/*     .LENGTH OF LAST LINE                                         */
*/*     .'END LINE' CONTROL FLAG (IF A MULTI-LINE MSG)               */
*/*     .ROUTING AND DESCRIPTOR CODES                                */
*/*                                                                  */
*/* ENTRY - COMPLWPL (INTERNAL SUBROUTINE)                           */
*/*   INPUT -                                                        */
*/*     LINECNT - NUMBER OF LINES IN MESSAGE                         */
*/*     MSGPTR  - PTR TO NEXT DATA POSITION IN BUFFER                */
*/*     MSGLNTH  - LENGTH OF TEXT IN CURRENT LINE                    */
*/*     EVNTACTN - IF ON, MSG WILL REQUIRE EVENTUAL OPERATOR ACTION  */
*/*              - IF OFF, MSG REQUIRES IMMEDIATE ACTION             */
*/*     DAUNIT   - IF ON, MSG IS FOR A D.A. UNIT                     */
*/*     TAPEUNIT - IF ON, MSG IS FOR A TAPE UNIT                     */
*/*     WPLPTR   - PTR TO START OF WTP PARM LIST                     */
*/*     WPLMLPTR - PTR TO LAST MULTI-LINE SECTION OF PARM LIST IF ANY*/
*/*                                                                  */
*/* EXIT - RETURN TO CALLER                                          */
*/*   CONDITION - WPL COMPLETED                                      */
*/*     OUTPUT -                                                     */
*/*       THE FOLLOWING FIELDS ARE FILLED IN IF REQUIRED:            */
*/*         WPLLGH/WPLMLLEN - LENGTH OF LAST LINE                    */
*/*         WPLMLLTD - 'END LINE' INDICATOR                          */
*/*         WPLMCSFA - 'ROUTE/DESC CODES PRESENT' INDICATOR          */
*/*         WPLDESCB/WPLDESCC - 'OPERATOR ACTION' DESCRIPTOR CODE    */
*/*         WPLDESCF - 'JOB STATUS' DESCRIPTOR CODE                  */
*/*         WPLROUTC/WPLROUTD - ROUTING CODE                         */
*/*     RETURN CODE - NONE                                           */
*/********************************************************************/
*COMPLWPL:                             /*COMPLETE WTO PARM LIST      */
*  PROC;                                                        02S0232
COMPLWPL STM   @14,@12,12(@13)                                  02S0232
*IF LINECNT = ONE THEN                 /*SINGLE LINE MESSAGE         */
         CLI   LINECNT,1                                        02S0233
         BNE   @RF00233                                         02S0233
*  WPLLGH = MSGLNTH + FOUR;            /*SET LENGTH OF LINE          */
         LA    @10,4                                            02S0234
         ALR   @10,MSGLNTH                                      02S0234
         STH   @10,WPLLGH(,WPLPTR)                              02S0234
*ELSE                                  /*MULTI-LINE MESSAGE          */
*  DO;                                                          02S0235
         B     @RC00233                                         02S0235
@RF00233 DS    0H                                               02S0236
*    WPLMLLEN = MSGLNTH + FOUR;        /*SET LENGTH OF LAST LINE     */
         L     @10,WPLMLPTR                                     02S0236
         LA    @08,4                                            02S0236
         ALR   @08,MSGLNTH                                      02S0236
         STC   @08,WPLMLLEN(,@10)                               02S0236
*    WPLMLLTD = ON;                    /*SET 'END LINE' INDICATOR    */
         OI    WPLMLLTD(@10),B'00010000'                        02S0237
*  END;                                                         02S0238
*WPLMCSFA = ON;                        /*INDICATE RTE/DESC CODES
*                                        PRESENT                     */
@RC00233 OI    WPLMCSFA(WPLPTR),B'10000000'                     02S0239
*WPLDESC = ZERO;                       /*CLEAR DESC CODES AREA       */
         SLR   @10,@10                                          02S0240
         LR    @08,WPLPTR                                       02S0240
         AH    @08,WPLLGH(,WPLPTR)                              02S0240
         STH   @10,WPLDESC(,@08)                                02S0240
*WPLROUT = ZERO;                       /*CLEAR ROUTE CODES AREA      */
         STH   @10,WPLROUT(,@08)                                02S0241
*IF EVNTACTN = NO THEN                 /*NOT AN EVENTUAL ACTION MSG  */
         TM    EVNTACTN,B'10000000'                             02S0242
         BNZ   @RF00242                                         02S0242
*  DO;                                                          02S0243
*    WPLDESCB = ON;                    /*INDICATE IMMEDIATE ACTION   */
*    WPLDESCF = ON;                    /*SET 'JOB STATUS' INDICATOR  */
         OI    WPLDESCB(@08),B'01000100'                        02S0245
*  END;                                                         02S0246
*ELSE                                                           02S0247
*  WPLDESCC = ON;                      /*INDICATE EVENTUAL ACTION    */
         B     @RC00242                                         02S0247
@RF00242 LR    @10,WPLPTR                                       02S0247
         AH    @10,WPLLGH(,WPLPTR)                              02S0247
         OI    WPLDESCC(@10),B'00100000'                        02S0247
*IF DAUNIT = ON THEN                   /*MSG IS FOR A D.A. UNIT      */
@RC00242 L     @10,@PC00001                                     02S0248
         TM    DAUNIT(@10),B'00100000'                          02S0248
         BNO   @RF00248                                         02S0248
*  WPLROUTD = ON;                      /*ROUTE TO D.A. POOL          */
         LR    @10,WPLPTR                                       02S0249
         AH    @10,WPLLGH(,WPLPTR)                              02S0249
         OI    WPLROUTD(@10),B'00010000'                        02S0249
*ELSE                                  /*NOT D.A. UNIT               */
*  IF TAPEUNIT = ON THEN               /*MSG IS FOR TAPE UNIT        */
         B     @RC00248                                         02S0250
@RF00248 L     @10,@PC00001                                     02S0250
         TM    TAPEUNIT(@10),B'00010000'                        02S0250
         BNO   @RF00250                                         02S0250
*    WPLROUTC = ON;                    /*ROUTE TO TAPE POOL          */
         LR    @10,WPLPTR                                       02S0251
         AH    @10,WPLLGH(,WPLPTR)                              02S0251
         OI    WPLROUTC(@10),B'00100000'                        02S0251
*RETURN;                               /*RETURN TO CALLER            */
@EL00003 DS    0H                                               02S0252
@EF00003 DS    0H                                               02S0252
@ER00003 LM    @14,@12,12(@13)                                  02S0252
         BR    @14                                              02S0252
*END COMPLWPL;                                                  02S0253
         B     @EL00003                                         02S0253
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CHNGLINE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHANGE LINE IN WTO PARAMETER LIST             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE EFFECTS A LINE CHANGE IN THE WRITE-TO-OPERATOR    */
*/*   PARAMETER LIST (WPL) BEING CONSTRUCTED. THE ROUTINE WILL SET   */
*/*   THE NECESSARY FLAGS/FIELDS TO COMPLETE THE CURRENT LINE, SET   */
*/*   UP ADDRESSABILITY TO THE NEXT LINE AND SET REQUIRED FIELDS AND */
*/*   FLAGS IN THAT SECTION OF THE PARM LIST. BLANKS ARE INSERTED    */
*/*   AT THE BEGINNING OF THE NEW LINE SO THAT THE ACTUAL TEXT WILL  */
*/*   BEGIN BEYOND THE MESSAGE I.D. OF THE FIRST LINE.               */
*/*                                                                  */
*/* ENTRY - CHNGLINE (INTERNAL SUBROUTINE)                           */
*/*   INPUT -                                                        */
*/*     LINECNT - CURRENT LINE NUMBER                                */
*/*     MSGLNTH - LENGTH OF TEXT IN CURRENT LINE                     */
*/*     WPLMLPTR - POINTER TO CURRENT MULTI-LINE SECTION, IF ANY     */
*/*     WPLPTR - POINTER TO START OF WPL                             */
*/*                                                                  */
*/* EXIT - RETURN TO CALLER                                          */
*/*   CONDITION - LINE CHANGE EFFECTED                               */
*/*     OUTPUT -                                                     */
*/*       WPLMLPTR - PTR TO NEW WPLML                                */
*/*       MSGPTR - PTR TO NEXT AVAILABLE TEXT POSITION               */
*/*       WPLLGH/WPLMLLEN - LENGTH OF CURRENT LINE                   */
*/*       WPLLTFC/WPLMLLTC - 'DATA LINE' INDICATORS                  */
*/*       WPLMCSFJ - 'MULTI-LINE WTO' INDICATOR                      */
*/*       LINECNT - UPDATED LINE NUMBER                              */
*/*       WPLLINES - NUMBER OF LINES                                 */
*/*       MSGLNTH - LENGTH OF TEXT IN NEW LINE                       */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*CHNGLINE:                             /*CHANGE LINE SUBROUTINE      */
*  PROC;                                                        02S0254
CHNGLINE STM   @14,@01,12(@13)                                  02S0254
         STM   @03,@12,32(@13)                                  02S0254
*IF LINECNT = ONE THEN                 /*END OF FIRST LINE           */
         CLI   LINECNT,1                                        02S0255
         BNE   @RF00255                                         02S0255
*  DO;                                                          02S0256
*    WPLLGH = MSGLNTH + FOUR;          /*SET LENGTH FOR FIRST LINE   */
         LA    @10,4                                            02S0257
         LR    @08,MSGLNTH                                      02S0257
         ALR   @08,@10                                          02S0257
         STH   @08,WPLLGH(,WPLPTR)                              02S0257
*    WPLMCSFJ = ON;                    /*SET MULTI-LINE INDICATOR    */
         OI    WPLMCSFJ(WPLPTR),B'01000000'                     02S0258
*    WPLLTFC = ON;                     /*SET DATA LINE INDICATOR     */
         ALR   @08,WPLPTR                                       02S0259
         ALR   @10,@08                                          02S0259
         OI    WPLLTFC(@10),B'00100000'                         02S0259
*    WPLMLPTR = ADDR(WPLLS01) +        /*POINT TO START OF LINE 2    */
*        LENGTH(WPLLS01);                                       02S0260
         AH    @08,@CH00049                                     02S0260
         ST    @08,WPLMLPTR                                     02S0260
*  END;                                                         02S0261
*ELSE                                                           02S0262
*  DO;                                                          02S0262
         B     @RC00255                                         02S0262
@RF00255 DS    0H                                               02S0263
*    WPLMLLEN = MSGLNTH + FOUR;        /*SET LENGTH OF CURRENT LINE  */
         L     @10,WPLMLPTR                                     02S0263
         LA    @08,4                                            02S0263
         ALR   @08,MSGLNTH                                      02S0263
         STC   @08,WPLMLLEN(,@10)                               02S0263
*    WPLMLPTR = WPLMLPTR + WPLMLLEN;   /*POINT TO START OF NEXT LINE */
         ALR   @10,@08                                          02S0264
         ST    @10,WPLMLPTR                                     02S0264
*  END;                                                         02S0265
*LINECNT = LINECNT + ONE;              /*INCREMENT NUMBER OF LINES   */
@RC00255 LA    @10,1                                            02S0266
         SLR   @08,@08                                          02S0266
         IC    @08,LINECNT                                      02S0266
         ALR   @10,@08                                          02S0266
         STC   @10,LINECNT                                      02S0266
*WPLLINES = LINECNT;                   /*SET NUMBER OF LINES IN WPL  */
         LR    @08,WPLPTR                                       02S0267
         AH    @08,WPLLGH(,WPLPTR)                              02S0267
         STC   @10,WPLLINES+4(,@08)                             02S0267
*WPLMLLTC = ON;                        /*INDICATE NEW LINE IS A DATA
*                                        LINE                        */
         L     @10,WPLMLPTR                                     02S0268
         OI    WPLMLLTC(@10),B'00100000'                        02S0268
*MSGPTR = ADDR(WPLMLTXT);              /*SET PTR FOR START OF MSG TXT*/
         LA    @10,WPLMLTXT(,@10)                               02S0269
         ST    @10,MSGPTR                                       02S0269
*MSGIDENT = BLANKS;                    /*INSERT BLANKS INSTEAD OF AN
*                                        ID                          */
         MVC   MSGIDENT(8,@10),BLANKS                           02S0270
*MSGPTR = MSGPTR + LENGTH(MSGIDENT);   /*POINT TO NEXT BUFFER POS'N  */
         LA    @08,8                                            02S0271
         ALR   @10,@08                                          02S0271
         ST    @10,MSGPTR                                       02S0271
*MSGLNTH = LENGTH(MSGIDENT);           /*SET LENGTH OF TEXT          */
         LR    MSGLNTH,@08                                      02S0272
*RETURN;                               /*RETURN TO CALLER            */
@EL00004 DS    0H                                               02S0273
@EF00004 DS    0H                                               02S0273
@ER00004 LM    @14,@01,12(@13)                                  02S0273
         LM    @03,@12,32(@13)                                  02S0273
         BR    @14                                              02S0273
*END CHNGLINE;                                                  02S0274
*END IEFAB499                                                   01S0275
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A499SPEC)                                        *
*/*%INCLUDE SYSLIB  (A499DATA)                                        *
*/*%INCLUDE SYSLIB  (IEZWPL  )                                        *
*/*%INCLUDE SYSLIB  (A499INIT)                                        *
*/*%INCLUDE SYSLIB  (INITSPEC)                                        *
*/*%INCLUDE SYSLIB  (BVERMSG )                                        *
*/*%INCLUDE SYSLIB  (VERSPEC )                                        *
*/*%INCLUDE SYSLIB  (BLDBASIC)                                        *
*/*%INCLUDE SYSLIB  (BBSCSPEC)                                        *
*/*%INCLUDE SYSLIB  (BUNLDMSG)                                        *
*/*%INCLUDE SYSLIB  (UNLDSPEC)                                        *
*/*%INCLUDE SYSLIB  (BMNTMSG )                                        *
*/*%INCLUDE SYSLIB  (BMNTSPEC)                                        *
*/*%INCLUDE SYSLIB  (BLDWTOR )                                        *
*/*%INCLUDE SYSLIB  (WTORSPEC)                                        *
*/*%INCLUDE SYSLIB  (SQUEEZE )                                        *
*/*%INCLUDE SYSLIB  (SQUEZSPC)                                        *
*/*%INCLUDE SYSLIB  (COMPLWPL)                                        *
*/*%INCLUDE SYSLIB  (CWPLSPEC)                                        *
*/*%INCLUDE SYSLIB  (CHNGLINE)                                        *
*/*%INCLUDE SYSLIB  (CHLNSPEC)                                        *
*;                                                              01S0275
@DATA    DS    0H
@CH00060 DC    H'1'
@CH00203 DC    H'6'
@CH00049 DC    H'8'
@CH00201 DC    H'14'
@CH00258 DC    H'44'
@CH00272 DC    H'70'
@CH00256 DC    H'160'
@SM00329 MVC   VMSGJNM(0,@02),JOBNAME(@01)
@SM00331 MVC   VMSGSTNM(0,@02),STEPNAME(@01)
@SM00333 MVC   MSG(0,@10),ADDLINFO(@08)
@SM00337 MVC   MSG(0,@10),ATTRTEXT(ATTRPTR)
@SM00339 MVC   MSG(0,@10),JOBNAME(@01)
@SM00341 MVC   MSG(0,@10),STEPNAME(@01)
@SM00344 MVC   MSG(0,@10),DSNAME(@01)
@SX00346 XC    MSG(0,@10),MSG(@10)
@SM00348 MVC   MSG(0,@10),CONDMT-CNDMTMSG(@15)
@SM00350 MVC   CMJOB(0,FMPTR),JOBNAME(@01)
@SM00352 MVC   CMSTEP(0,@08),STEPNAME(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    5F
@PC00002 DS    2F
@AL00001 DS    2A
IEFAB499 CSECT
         DS    0F
@CF00328 DC    F'-8'
@CF00335 DC    F'-2'
@CF00336 DC    F'-1'
@DATD    DSECT
         DS    0D
WPLMLPTR DS    A
MSGPTR   DS    A
DSNAMELN DS    H
JOBNAMLN DS    H
STPNAMLN DS    H
SPACELEN DS    H
LINECNT  DS    FL1
EVNTACTN DS    BL1
@OLDKEY  DS    AL1
IEFAB499 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CA00284 DC    A(ATTROTAB)
@CA00287 DC    A(CNDMTMSG)
@CA00290 DC    A(ACTION)
@CV00291 DC    V(ATRIBUTE)
@CA00292 DC    A(MSGNO)
         DS    0D
PREFXLEN DC    AL4(8)
GTSTZERO DC    F'0'
COMMALEN DC    AL2(1)
BLANKS   DC    CL8' '
COMMA    DC    CL1','
NSPTAPE  DC    X'FF'
ZEROVLSR DC    X'00'
         DC    XL5'0'
IEFAB499 CSECT
         DS   0H
A499PTCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB499 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GTSTRTCD EQU   @10
ENDPTR   EQU   @02
RETCODE  EQU   @03
MSGLNTH  EQU   @02
ATTRLEN  EQU   @02
FMPTR    EQU   @02
ATTRPTR  EQU   @04
WPLPTR   EQU   @09
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
         EXTRN ATTROTAB
         EXTRN CNDMTMSG
         EXTRN ACTION
         EXTRN MSGNO
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSFA EQU   WPLMCSF1
WPLMCSF2 EQU   WPLMCSF+1
WPLMCSFJ EQU   WPLMCSF2
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESCB EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUTC EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUT2 EQU   WPLROUT+1
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLLTFC  EQU   WPLLTF1
WPLLINES EQU   WPLLS01+3
WPLML    EQU   0
WPLMLLEN EQU   WPLML+1
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
WPLMLLTC EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLTXT EQU   WPLML+4
CMBUF    EQU   0
CMSER    EQU   CMBUF+14
CMCUA    EQU   CMBUF+24
CMJOB    EQU   CMBUF+32
CMFREPLY EQU   CMBUF+49
HDRFMT   EQU   0
MSGIDENT EQU   HDRFMT
ACTNCODE EQU   HDRFMT+8
MSGUNAME EQU   HDRFMT+10
MSGDLIM  EQU   HDRFMT+13
ADDLINFO EQU   0
ATTRTEXT EQU   0
CMREPLY  EQU   0
CMSTEP   EQU   0
DSNAME   EQU   0
EOLCHAR  EQU   0
JOBNAME  EQU   0
MSG      EQU   0
MSGVLSER EQU   0
VOLSER   EQU   0
STEPNAME EQU   0
VMSGFMT1 EQU   0
VMSGID   EQU   VMSGFMT1
VMSGJNM  EQU   VMSGFMT1+8
VMSGFMT2 EQU   0
VMSGDLIM EQU   VMSGFMT2
VMSGSTNM EQU   VMSGFMT2+1
LASTCHAR EQU   0
ATTRLNTH EQU   ATTROTAB
ATTROFFS EQU   ATTROTAB+1
CMLEN    EQU   CNDMTMSG
CONDMT   EQU   CNDMTMSG+2
PARMBLCK EQU   0
MSGID    EQU   PARMBLCK
ACTCODE  EQU   PARMBLCK+1
UNITNAME EQU   PARMBLCK+2
ATTRIBUT EQU   PARMBLCK+5
TYPEBITS EQU   PARMBLCK+6
DAUNIT   EQU   TYPEBITS
TAPEUNIT EQU   TYPEBITS
ADINFOP  EQU   PARMBLCK+8
ADINFOLN EQU   PARMBLCK+12
WTOLSTLN EQU   PARMBLCK+14
WTOLISTP EQU   PARMBLCK+16
VOLSERP  EQU   0
JOBNAMEP EQU   0
STEPNAMP EQU   0
DSNAMEP  EQU   0
PARMLEN  EQU   0
PARMPTR  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00002 EQU   TYPEBITS
DOWTO    EQU   TYPEBITS
DOWTOR   EQU   TYPEBITS
@NM00006 EQU   CMBUF+40
@NM00005 EQU   CMBUF+27
@NM00004 EQU   CMBUF+20
@NM00003 EQU   CMBUF
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLML0   EQU   WPLML
WPLAREA  EQU   WPLLS01+2
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTK EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00001 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
WPLRLN   EQU   WPLRPTR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00075 EQU   @RC00053
@RC00084 EQU   @RC00082
@RC00138 EQU   @RC00082
@RF00250 EQU   @EL00003
@RC00248 EQU   @EL00003
@PB00004 EQU   @EL00001
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IEFAB499

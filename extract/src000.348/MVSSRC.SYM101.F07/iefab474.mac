         TITLE 'IEFAB474 - PROCESS MULTI-UNIT/GEN REQS                 *
                        '
IEFAB474 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(24)                                          01S0001
         DC    C'IEFAB474 76352  UZ08101 '                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(8),0(@01)                               01S0001
         MODESET EXTKEY=SCHED
*                                        ON ALG GROUP LIST ENTRIES   */
*RTNCODE = SUCCESS;                    /*INITIALIZE RETURN CODE TO 0 */
         SLR   RTNCODE,RTNCODE                                  01S0027
*SIOTPTR = SIOT1P;                     /*POINT TO THE FIRST SIOT     */
         L     @10,@PC00001                                     01S0028
         L     @10,ALCWAPTR(,@10)                               01S0028
         L     SIOTPTR,SIOT1P(,@10)                             01S0028
*DO WHILE (SIOTPTR^=ZERO & RTNCODE=SUCCESS); /*SCAN ALL THE SIOTS    */
         B     @DE00029                                         01S0029
@DL00029 DS    0H                                               01S0030
*  IF SIOTALCD = OFF                   /*IS SIOT UNALLOCATED, ..     */
*      & SVOLUNAD->VUMUGDON = OFF      /*..NOT YET PROCESSED, ..     */
*      & SIOTAFID ^= ZERO THEN         /*..AND PART OF A MULTI-U/G ? */
         TM    SIOTALCD(SIOTPTR),B'00000010'                    01S0030
         BNZ   @RF00030                                         01S0030
         L     @10,SVOLUNAD(,SIOTPTR)                           01S0030
         TM    VUMUGDON(@10),B'10000000'                        01S0030
         BNZ   @RF00030                                         01S0030
         SLR   @10,@10                                          01S0030
         CH    @10,SIOTAFID(,SIOTPTR)                           01S0030
         BE    @RF00030                                         01S0030
*    DO;                               /*YES, PROCESS                */
*      CANSOLVE = ON;                  /*ASSUME 1-GEN SOLUTION EXISTS*/
*      SOLVED = ON;                    /*ASSUME 1-GEN SOLUTION FOUND */
         OI    CANSOLVE,B'10010000'                             01S0033
*      GENIDALC = ZERO;                /*ZERO SAVE AREA FOR GEN ID   */
         ST    @10,GENIDALC                                     01S0034
*      RFY INDMSIOT BASED(SAFIDPTR);                            01S0035
*      SAFIDPTR = SIOTPTR;             /*POINT TO SIOT BEING PROCESSD*/
         ST    SIOTPTR,SAFIDPTR                                 01S0036
*      DO WHILE  (SAFIDPTR ^= ZERO     /*SCAN THE REST OF SIOT CHAIN */
*          & CANSOLVE = ON);           /*AS LONG AS A SOLUTION EXISTS*/
         B     @DE00037                                         01S0037
@DL00037 DS    0H                                               01S0038
*        IF SIOTALCD = OFF             /*IS SIOT UNALLOCATED ..      */
*            & SIOTAFID=SIOTPTR->SIOTAFID THEN/*AND PART OF SAME MUG?*/
         L     @10,SAFIDPTR                                     01S0038
         TM    SIOTALCD(@10),B'00000010'                        01S0038
         BNZ   @RF00038                                         01S0038
         CLC   SIOTAFID(2,@10),SIOTAFID(SIOTPTR)                01S0038
         BNE   @RF00038                                         01S0038
*          DO;                         /*YES, PROCESS                */
*            SVOLUNAD->VUMUGDON = ON;  /*INDICATE SIOT IS PROCESSED  */
         L     @10,SVOLUNAD(,@10)                               01S0040
         OI    VUMUGDON(@10),B'10000000'                        01S0040
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - HOWALGC                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DETERMINE HOW THE ALG COVERED A SIOT          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     THIS CODE DETERMINES IF THE ALGORITHM COVERED ALL THE        */
*/*     DEVICE REQUIREMENTS FOR A SIOT EXCEPT FOR ITS SCRATCH        */
*/*     VOLUME REQUESTS. IF ALL THE DEVICE REQUIREMENTS WERE         */
*/*     COVERED, THIS CODE ALSO DETERMINES IF THEY WERE ALL          */
*/*     COVERED BY THE SAME GENERIC DEVICE TYPE AND, IF SO,          */
*/*     WHETHER THIS DEVICE TYPE MATCHES THE DEVICE TYPE OF ANY      */
*/*     UNITS WHICH HAVE ALREADY BEEN ASSIGNED TO SIOTS WITH THE     */
*/*     SAME SIOTAFID.                                               */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*       THIS ROUTINE DETERMINES WHETHER EACH OF THE SIOT'S         */
*/*       VOLUNIT ENTRIES WERE COVERED BY THE ALGORITHM BY SCANNING  */
*/*       THE GROUP LIST ENTRIES ASSOCIATED WITH EACH OF THE VOLUNIT */
*/*       ENTRIES.                                                   */
*/*       IF A GROUP WAS PICKED BY THE ALGORITHM FOR A PARTICULAR    */
*/*       VOLUNIT ENTRY, THE EDL IS SCANNED TO DETERMINE THE         */
*/*       DEVICE TYPE OF THE GROUP.                                  */
*/*                                                                  */
*/* ENTRY - (INLINE SUBROUTINE)                                      */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     SAFIDPTR - PTR TO THE SIOT TO BE PROCESSED                   */
*/*     GENIDALC - THE DEVICE TYPE OF ANY OTHER GROUPS ALREADY       */
*/*                ASSIGNED TO SIOTS WITH THE SAME SIOTAFID AS THE   */
*/*                SIOT BEING PROCESSED. THIS FIELD WILL BE ZERO     */
*/*                IF NO OTHER SIOTS WITH THE SAME SIOTAFID HAVE     */
*/*                BEEN PROCESSED.                                   */
*/*     CANSOLVE - 1                                                 */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */
*/*                                                                  */
*/*   CONDITIONS - FUNCTION COMPLETED.                               */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*       GENIDALC - THE GENERIC DEVICE TYPE OF FIRST GROUP          */
*/*                  ASSIGNED TO THESE SIOTS WITH THE SAME SIOTAFID. */
*/*       CANSOLVE - SET TO 0 IF ALL OF THIS SIOT'S DEVICE           */
*/*                  REQUIREMENTS, EXCEPT SCRATCH REQS, WERE NOT     */
*/*                COVERED BY THE ALGORITHM.                         */
*/*       SOLVED - SET TO 0 IF MORE THAN 1 GENERIC HAS BEEN ASSIGNED */
*/*                TO ALL THE SIOTS WITH THE SAME SIOTAFID.          */
*/*                                                                  */
*/*   RETURN CODES - (NONE)                                          */
*/*                                                                  */
*/********************************************************************/
*VUPTR = SVOLUNAD;                     /*POINT TO THE SIOTS FIRST VU */
         LR    VUPTR,@10                                        02S0041
*DO VUCTR = ONE TO SVOLUNNO            /*SCAN ALL OF SIOTS VOLUNITS..*/
*    WHILE CANSOLVE = ON;              /*..UNTIL REQ NOT COVERED     */
         LA    VUCTR,1                                          02S0042
         B     @DE00042                                         02S0042
@DL00042 TM    CANSOLVE,B'10000000'                             02S0042
         BNO   @DC00042                                         02S0042
*  IF VOLALOC = OFF                    /*IS THIS AN UNALLOCATED ENTRY*/
*      & VDEVREQD = ON                 /*..REQUIRING A DEVICE, BUT.. */
*      & CVRDUPLI = OFF THEN           /*..NOT A DUPLICATE ALG REQ ? */
         TM    VDEVREQD(VUPTR),B'00100000'                      02S0043
         BNO   @RF00043                                         02S0043
         TM    VOLALOC(VUPTR),B'10000000'                       02S0043
         BNZ   @RF00043                                         02S0043
         L     @10,VOLALGTP(,VUPTR)                             02S0043
         TM    CVRDUPLI(@10),B'10000000'                        02S0043
         BNZ   @RF00043                                         02S0043
*    DO;                               /*YES, PROCESS ..             */
*      IF CVRSKFLG = OFF THEN          /*DID THE ALG CONSIDER THE REQ*/
         TM    CVRSKFLG(@10),B'10000000'                        02S0045
         BNZ   @RF00045                                         02S0045
*        DO;                           /*YES, PROCESS ..             */
*          CANSOLVE = OFF;             /*ASSUME ALG DID NOT COVER REQ*/
         NI    CANSOLVE,B'01111111'                             02S0047
*          GRPENTP = CVRGRPPT;         /*POINT TO REQS 1ST GROUP LIST*/
         L     GRPENTP,CVRGRPPT(,@10)                           02S0048
*          DO AGPCTR = ONE TO CVRNGRP  /*SCAN ALL ALG GROUP LIST ENTS*/
*              WHILE CANSOLVE = OFF;   /*..UNTIL GROUP ALG USED      */
         LA    AGPCTR,1                                         02S0049
         B     @DE00049                                         02S0049
@DL00049 TM    CANSOLVE,B'10000000'                             02S0049
         BNZ   @DC00049                                         02S0049
*            IF CVRGALL > ZERO THEN    /*DID THE ALG PICK THIS GROUP */
         ICM   @10,3,CVRGALL(GRPENTP)                           02S0050
         BNP   @RF00050                                         02S0050
*              DO;                     /*YES ..                      */
*                CANSOLVE = ON;        /*INDICATE ALG COVERED THE REQ*/
         OI    CANSOLVE,B'10000000'                             02S0052
*                IF SOLVED = ON THEN   /*MORE THAN ONE GEN USED ?    */
         TM    SOLVED,B'00010000'                               02S0053
         BNO   @RF00053                                         02S0053
*                  DO;                 /*NOT YET - PROCESS           */
*                    GENFOUND = OFF;   /*GEN NOT LOCATED IN EDL YET  */
         NI    GENFOUND,B'11011111'                             02S0055
*                    EDLPTR = EDLFGENP;/*POINT TO FIRST GEN IN EDL   */
         L     @10,SAFIDPTR                                     02S0056
         L     @10,SIOTEDLP(,@10)                               02S0056
         L     EDLPTR,EDLFGENP(,@10)                            02S0056
*                DO EGENCTR=ONE TO EDLGENNO /*SCAN ALL GENS IN EDL ..*/
*                    WHILE GENFOUND=OFF; /*..UNTIL GROUP ALC IS FOUND*/
         LA    EGENCTR,1                                        02S0057
         B     @DE00057                                         02S0057
@DL00057 TM    GENFOUND,B'00100000'                             02S0057
         BNZ   @DC00057                                         02S0057
*                  IF EINDEVTP=OFF THEN /*IS THE GENERIC STILL ELIG ?*/
         TM    EINDEVTP(EDLPTR),B'10000000'                     02S0058
         BNZ   @RF00058                                         02S0058
*                    DO;               /*YES, SCAN GENERIC FOR GROUP */
*                      EDLGNTP=EDLGRPTR; /*POINT TO 1ST GROUP IN GEN */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0060
*                      DO EGRPCTR=ONE TO EDLGRPNO /*SCAN GRPS IN GEN */
*                          WHILE GENFOUND=OFF; /*UNTIL GRP ALC IS FND*/
         LA    @15,1                                            02S0061
         B     @DE00061                                         02S0061
@DL00061 TM    GENFOUND,B'00100000'                             02S0061
         BNZ   @DC00061                                         02S0061
*                        IF EDLGRID=CVRGRPID THEN /*SAME GROUP AS ALC*/
         L     @15,EDLGRID(,EDLGNTP)                            02S0062
         CH    @15,CVRGRPID(,GRPENTP)                           02S0062
         BNE   @RF00062                                         02S0062
*                          DO;         /*YES, ..                     */
*                            GENFOUND=ON; /*INDICATE GEN ALLOCD FOUND*/
         OI    GENFOUND,B'00100000'                             02S0064
*                            IF GENIDALC=ZERO THEN /*FIRST UNIT ALC'D*/
         ICM   @15,15,GENIDALC                                  02S0065
         BNZ   @RF00065                                         02S0065
*                                GENIDALC=EDLDEVT; /*YES,SAV GEN TYPE*/
         MVC   GENIDALC(4),EDLDEVT(EDLPTR)                      02S0066
*                            ELSE      /*NOT THE FIRST UNIT ALLOC'D..*/
*                              DO;                              02S0067
         B     @RC00065                                         02S0067
@RF00065 DS    0H                                               02S0068
*                               IF GENIDALC^=EDLDEVT THEN /*SAME GEN?*/
         CLC   GENIDALC(4),EDLDEVT(EDLPTR)                      02S0068
         BE    @RF00068                                         02S0068
*                                   SOLVED = OFF; /*NO, INDICATE     */
         NI    SOLVED,B'11101111'                               02S0069
*                               ELSE;  /*YES, SAME GENERIC AS BEFORE */
@RF00068 DS    0H                                               02S0071
*                              END;                             02S0071
*                          END;                                 02S0072
*                        ELSE;         /*NOT THE GROUP ALLOC'D       */
@RF00062 DS    0H                                               02S0074
*                        EDLGNTP=EDLNXGRP; /*POINT TO THE NEXT GROUP */
@RC00062 L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0074
*                      END;                                     02S0075
         LA    @15,1                                            02S0075
         AL    @15,EGRPCTR                                      02S0075
@DE00061 ST    @15,EGRPCTR                                      02S0075
         C     @15,EDLGRPNO(,EDLPTR)                            02S0075
         BNH   @DL00061                                         02S0075
@DC00061 DS    0H                                               02S0076
*                    END;                                       02S0076
*                  ELSE;               /*INELIGIBLE GENERIC          */
@RF00058 DS    0H                                               02S0078
*                  EDLPTR = EDLNXTNT;  /*POINT TO THE NEXT GENERIC   */
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0078
*                  END;                                         02S0079
         AH    EGENCTR,@CH00041                                 02S0079
@DE00057 L     @06,SAFIDPTR                                     02S0079
         L     @06,SIOTEDLP(,@06)                               02S0079
         C     EGENCTR,EDLGENNO(,@06)                           02S0079
         BNH   @DL00057                                         02S0079
@DC00057 DS    0H                                               02S0080
*                END;                                           02S0080
*              ELSE;                   /*MORE THAN 1 GEN ALREADY     */
@RF00053 DS    0H                                               02S0082
*              END;                                             02S0082
*            ELSE;                     /*ALG DID NOT PICK THIS GROUP */
@RF00050 DS    0H                                               02S0084
*            GRPENTP=GRPENTP + LENGTH(CVRGPLST); /*PT TO NEXT GRP ENT*/
         AH    GRPENTP,@CH00277                                 02S0084
*          END;                                                 02S0085
         AH    AGPCTR,@CH00041                                  02S0085
@DE00049 L     @10,VOLALGTP(,VUPTR)                             02S0085
         CH    AGPCTR,CVRNGRP(,@10)                             02S0085
         BNH   @DL00049                                         02S0085
@DC00049 DS    0H                                               02S0086
*        END;                                                   02S0086
*      ELSE                            /*ALG DID NOT CONSIDER THE REQ*/
*        DO;                                                    02S0087
         B     @RC00045                                         02S0087
@RF00045 DS    0H                                               02S0088
*          CANSOLVE = OFF;             /*INDICATE REQ WAS NOT COVERED*/
         NI    CANSOLVE,B'01111111'                             02S0088
*        END;                                                   02S0089
*    END;                                                       02S0090
*  ELSE;                               /*VU ENTRY NOT TO BE COVERED  */
@RF00043 DS    0H                                               02S0092
*  VUPTR = VUPTR + LENGTH(VOLUNTAB);   /*POINT TO THE NEXT VU ENTRY  */
@RC00043 AH    VUPTR,@CH00457                                   02S0092
*END;                                                           02S0093
         AH    VUCTR,@CH00041                                   02S0093
@DE00042 L     @10,SAFIDPTR                                     02S0093
         CH    VUCTR,SVOLUNNO(,@10)                             02S0093
         BNH   @DL00042                                         02S0093
@DC00042 DS    0H                                               02S0094
*          END;                                                 01S0094
*        ELSE;                         /*NOT UNALLOC, SAME MUG SIOT  */
@RF00038 DS    0H                                               01S0096
*        SAFIDPTR = SIOTNPTR;          /*POINT TO THE NEXT SIOT      */
         L     @10,SAFIDPTR                                     01S0096
         L     @10,SIOTNPTR(,@10)                               01S0096
         ST    @10,SAFIDPTR                                     01S0096
*       END;                                                    01S0097
@DE00037 ICM   @10,15,SAFIDPTR                                  01S0097
         BZ    @DC00037                                         01S0097
         TM    CANSOLVE,B'10000000'                             01S0097
         BO    @DL00037                                         01S0097
@DC00037 DS    0H                                               01S0098
*       IF CANSOLVE = ON &             /*IF ALGORITHM COVERED@ZA15730*/
*          GENIDALC ^= ZERO THEN       /*AND DEV TYPE NOT ZERO. SIOT
*                                        PROCESSED IF ZERO.  @ZA15730*/
         TM    CANSOLVE,B'10000000'                             01S0098
         BNO   @RF00098                                         01S0098
         ICM   @10,15,GENIDALC                                  01S0098
         BZ    @RF00098                                         01S0098
*        DO;                           /*YES, PROCESS                */
*          IF SOLVED = OFF THEN        /*DID ALG COVER WITH 1 GENERIC*/
         TM    SOLVED,B'00010000'                               01S0100
         BNZ   @RF00100                                         01S0100
*            DO;                       /*NO, TRY TO PUT ONTO 1-GEN   */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - FORCEGEN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - TRY TO FIND A 1-GENERIC SOLUTION              */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     THIS ROUTINE IS ENTERED WHEN THE ALGORITHM HAS COMPLETELY    */
*/*     COVERED ALL THE SIOTS WITH THE SAME SIOTAFID BUT THE         */
*/*     ALGORITHM USED MORE THAN ONE GENERIC DEVICE TYPE TO COVER    */
*/*     ALL THESE REQUESTS.                                          */
*/*     THIS ROUTINE TRIES TO FIND AN ELIGIBLE DEVICE TYPE WHICH     */
*/*     CAN COMPLETELY COVER ALL THE REQUESTS WITH THE SAME          */
*/*     SIOTAFID. IF REQUESTED BY THE CALLER, THE ONLY DEVICE TYPE   */
*/*     CONSIDERED AS A POSSIBLE SOLUTION IS THE LAST GENERIC        */
*/*     LOCKED.                                                      */
*/*     FOR EACH GENERIC BEING CONSIDERED AS A POSSIBLE SOLUTION,    */
*/*     SEGMENT 'FGENALOC' IS INVOKED FOR EACH SIOT WITH THE         */
*/*     SAME SIOTAFID TO SEE IF THE SIOT CAN BE SATISFIED BY THE     */
*/*     UNITS ALLOCATED BY THE ALGORITHM FROM THAT GENERIC OR THE    */
*/*     EXCESS UNITS (I.E. NOT USED BY THE ALG) FOR THE GENERIC.     */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE ITSELF.    */
*/*                                                                  */
*/* ENTRY - (INLINE SUBROUTINE)                                      */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*        SIOTPTR - PTR TO THE SIOT BEING PROCESSED                 */
*/*        ONLYLGEN - FUNCTION MAP BIT                               */
*/*                 - 1 - TRY ONLY THE LAST GENERIC LOCKED           */
*/*                 - 0 - TRY ALL ELIGIBLE GENERICS                  */
*/*        ALCWAPTR - PTR TO THE ALLOCATION WORK AREA                */
*/*          LGENLOCK - GENERIC DEVICE TYPE LAST LOCKED              */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */
*/*                                                                  */
*/*   CONDITIONS - FUNCTION COMPLETED.                               */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*        SOLVED - SET TO 1 IF A ONE-GENERIC SOLUTION IS FOUND.     */
*/*        CANSOLVE - SET TO 1 IF A 1-GENERIC SOLUTION IS NOT FOUND. */
*/*        GENIDALC - GENERIC WHICH COVERED ALL THE REQUESTS         */
*/*                                                                  */
*/*   RETURN CODES - (NONE)                                          */
*/*                                                                  */
*/********************************************************************/
*EDLPTR = SIOTPTR->SIOTEDLP->EDLFGENP; /*POINT TO THE 1ST GEN IN EDL */
         L     @10,SIOTEDLP(,SIOTPTR)                           02S0102
         L     EDLPTR,EDLFGENP(,@10)                            02S0102
*DO EGENCTR = ONE TO SIOTPTR -> SIOTEDLP -> EDLGENNO  /*SCAN ALL GENS*/
*    WHILE (SOLVED = OFF               /*UNLESS A 1-GEN SOLUTION FND */
*    & EDLGRPTR->EDLGRID<=ALGPARMP->CVRGRPLK);/*OR GROUPS NOT LOCKED */
         LA    EGENCTR,1                                        02S0103
         B     @DE00103                                         02S0103
@DL00103 TM    SOLVED,B'00010000'                               02S0103
         BNZ   @DC00103                                         02S0103
         L     @06,EDLGRPTR(,EDLPTR)                            02S0103
         L     @15,@PC00001                                     02S0103
         L     @15,ALCWAPTR(,@15)                               02S0103
         L     @01,ALGTABP(,@15)                                02S0103
         L     @01,ALGPARMP(,@01)                               02S0103
         L     @06,EDLGRID(,@06)                                02S0103
         CH    @06,CVRGRPLK(,@01)                               02S0103
         BH    @DC00103                                         02S0103
*  IF EINDEVTP = OFF THEN              /*IS THE GENERIC ELIGIBLE ?   */
         TM    EINDEVTP(EDLPTR),B'10000000'                     02S0104
         BNZ   @RF00104                                         02S0104
*    DO;                               /*YES, PROCESS ..             */
*      IF (ONLYLGEN = OFF)             /*SHOULD GENERIC BE TRIED ?   */
*          × (ONLYLGEN = ON                                     02S0106
*          & EDLDEVT = LGENLOCK) THEN                           02S0106
         L     @06,@PC00001+4                                   02S0106
         TM    ONLYLGEN(@06),B'10000000'                        02S0106
         BZ    @RT00106                                         02S0106
         TM    ONLYLGEN(@06),B'10000000'                        02S0106
         BNO   @RF00106                                         02S0106
         CLC   EDLDEVT(4,EDLPTR),LGENLOCK(@15)                  02S0106
         BNE   @RF00106                                         02S0106
@RT00106 DS    0H                                               02S0107
*        DO;                           /*YES,TRY TO SOLVE WITH GEN   */
*          GENIDALC = EDLDEVT;         /*SAVE THE GEN DEVICE TYPE    */
         MVC   GENIDALC(4),EDLDEVT(EDLPTR)                      02S0108
*          EDLGNTP = EDLGRPTR;         /*POINT TO 1ST GROUP IN GEN   */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0109
*          LOWGRP = EDLGRID;           /*SAVE THIS GROUP ID          */
         MVC   LOWGRP(2),EDLGRID+2(EDLGNTP)                     02S0110
*          DO EGRPCTR = ONE TO EDLGRPNO; /*SCAN ALL THE GROUPS IN GEN*/
         LA    @15,1                                            02S0111
         B     @DE00111                                         02S0111
@DL00111 DS    0H                                               02S0112
*            HIGHGRP = EDLGRID;        /*SAVE GROUP ID AS LAST IN GEN*/
         MVC   HIGHGRP(2),EDLGRID+2(EDLGNTP)                    02S0112
*            EDLGNTP = EDLNXGRP;       /*POINT TO NEXT GROUP IN GEN  */
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0113
*          END;                                                 02S0114
         AH    @15,@CH00041                                     02S0114
@DE00111 ST    @15,EGRPCTR                                      02S0114
         C     @15,EDLGRPNO(,EDLPTR)                            02S0114
         BNH   @DL00111                                         02S0114
*          SOLVED = ON;                /*ASSUME THIS GEN WILL SOLVE  */
         OI    SOLVED,B'00010000'                               02S0115
*          SAFIDPTR = SIOTPTR;         /*POINT TO SIOT BEING PROCESSD*/
         ST    SIOTPTR,SAFIDPTR                                 02S0116
*          DO WHILE (SAFIDPTR ^= ZERO  /*SCAN ALL THE SIOTS UNTIL .. */
*              & SOLVED = ON);         /*..GENERIC CANT COVER        */
         B     @DE00117                                         02S0117
@DL00117 DS    0H                                               02S0118
*            IF SIOTALCD = OFF         /*IS SIOT UNALLOCATED AND PART*/
*                & SIOTAFID=SIOTPTR->SIOTAFID THEN /*..OF SAME MUG ? */
         L     @06,SAFIDPTR                                     02S0118
         TM    SIOTALCD(@06),B'00000010'                        02S0118
         BNZ   @RF00118                                         02S0118
         CLC   SIOTAFID(2,@06),SIOTAFID(SIOTPTR)                02S0118
         BNE   @RF00118                                         02S0118
*              DO;                     /*YES,TRY TO COVER WITH GEN   */
*                CALL FGENALOC;                                 02S0120
         BAL   @14,FGENALOC                                     02S0120
*              END;                                             02S0121
*            ELSE;                     /*NOT UNALLOC'D,SAME MUG SIOT */
@RF00118 DS    0H                                               02S0123
*            SAFIDPTR = SIOTNPTR;      /*POINT TO THE NEXT SIOT      */
         L     @06,SAFIDPTR                                     02S0123
         L     @06,SIOTNPTR(,@06)                               02S0123
         ST    @06,SAFIDPTR                                     02S0123
*          END;                                                 02S0124
@DE00117 ICM   @06,15,SAFIDPTR                                  02S0124
         BZ    @DC00117                                         02S0124
         TM    SOLVED,B'00010000'                               02S0124
         BO    @DL00117                                         02S0124
@DC00117 DS    0H                                               02S0125
*        END;                                                   02S0125
*      ELSE;                           /*GENERIC SHOULD NOT BE TRIED */
@RF00106 DS    0H                                               02S0127
*    END;                                                       02S0127
*  ELSE;                               /*GENERIC IS INELIGIBLE       */
@RF00104 DS    0H                                               02S0129
*  EDLPTR = EDLNXTNT;                  /*POINT TO THE NEXT GENERIC   */
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0129
*END;                                                           02S0130
         AH    EGENCTR,@CH00041                                 02S0130
@DE00103 L     @06,SIOTEDLP(,SIOTPTR)                           02S0130
         C     EGENCTR,EDLGENNO(,@06)                           02S0130
         BNH   @DL00103                                         02S0130
@DC00103 DS    0H                                               02S0131
*IF SOLVED = OFF THEN                  /*WAS A 1-GEN SOLUTION FOUND? */
         TM    SOLVED,B'00010000'                               02S0131
         BNZ   @RF00131                                         02S0131
*  DO;                                 /*NO, INDICATE                */
*    CANSOLVE = OFF;                                            02S0133
         NI    CANSOLVE,B'01111111'                             02S0133
*  END;                                                         02S0134
*ELSE;                                 /*1-GENERIC SOLUTION WAS FOUND*/
@RF00131 DS    0H                                               02S0136
*            END;                                               01S0136
*          ELSE;                       /*THE ALG COVERED WITH 1 GEN  */
@RF00100 DS    0H                                               01S0138
*          IF SOLVED = ON THEN         /*IS A 1-GEN SOLUTION FOUND ? */
         TM    SOLVED,B'00010000'                               01S0138
         BNO   @RF00138                                         01S0138
*            DO;                       /*YES,ELIMINATE ALL OTHER GENS*/
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ELIMGENS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ELIMINATE ALL OTHER GENERICS VIA IEFAB481     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     THIS ROUTINE INVOKES MODULE IEFAB481 FOR EACH OF THE         */
*/*     SIOTS WITH THE SAME SIOTAFID AS THE SIOT BEING PROCESSED.    */
*/*     MODULE IEFAB481 WILL MARKS AS INELIGIBLE,IN THE EDL AND THE  */
*/*     ALGORITHM GROUP LIST ENTRIES, ALL THE GENERIC DEVICE TYPES   */
*/*     EXCEPT THE ONE CHOSEN FOR THESE REQUESTS.                    */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE ITSELF.    */
*/*                                                                  */
*/*                                                                  */
*/* ENTRY - (INLINE SUBROUTINE)                                      */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*       GENIDALC - THE GENERIC DEVICE TYPE CHOSEN FOR THESE        */
*/*                  REQUESTS.                                       */
*/*       SIOTPTR - THE FIRST SIOT WITH THE SIOTAFID BEING PROCESSED.*/
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */
*/*                                                                  */
*/*   CONDITIONS - FUNCTION COMPLETED.                               */
*/*                                                                  */
*/*   OUTPUT - (NONE EXCEPT MODULE IEFAB481 WILL HAVE MARKED ENTRIES */
*/*            FOR OTHER GENERICS AS INELIGIBLE IN THE EDL AND THE   */
*/*            ALGORITHM GROUP LIST ENTRIES.)                        */
*/*                                                                  */
*/*   RETURN CODES - 0 IN RTNCODE                                    */
*/*                                                                  */
*/********************************************************************/
*SAFIDPTR = SIOTPTR;                   /*POINT TO SIOT BEING PROCESSD*/
         ST    SIOTPTR,SAFIDPTR                                 02S0140
*SAVEAFID = SIOTAFID;                  /*STORE THE AFID              */
         L     @10,SAFIDPTR                                     02S0141
         LH    SAVEAFID,SIOTAFID(,@10)                          02S0141
*DO WHILE (SAFIDPTR ^= ZERO                                     02S0142
*    & RTNCODE = SUCCESS);             /*SCAN THE REST OF THE SIOTS  */
         B     @DE00142                                         02S0142
@DL00142 DS    0H                                               02S0143
*  IF SIOTALCD = OFF                   /*IS THE SIOT UNALLOCATED ..  */
*      & SIOTAFID = SAVEAFID THEN      /*.AND PART OF THE SAME MUG ? */
         L     @10,SAFIDPTR                                     02S0143
         TM    SIOTALCD(@10),B'00000010'                        02S0143
         BNZ   @RF00143                                         02S0143
         CH    SAVEAFID,SIOTAFID(,@10)                          02S0143
         BNE   @RF00143                                         02S0143
*    DO;                               /*YES,ELIMINATE ALL OTHER GENS*/
*      CALL IEFAB481 (SAFIDPTR,GENIDALC); /*UPDATE THE ALG TABLES/EDL*/
         LA    @10,SAFIDPTR                                     02S0145
         ST    @10,@AL00001                                     02S0145
         LA    @10,GENIDALC                                     02S0145
         ST    @10,@AL00001+4                                   02S0145
         L     @15,@CV00081                                     02S0145
         LA    @01,@AL00001                                     02S0145
         BALR  @14,@15                                          02S0145
*      RTNCODE = REG15;                /*SAVE THE RETURN CODE        */
         LR    RTNCODE,REG15                                    02S0146
*    END;                                                       02S0147
*  ELSE;                               /*NOT UNALLOC, SAME MUG SIOT  */
@RF00143 DS    0H                                               02S0149
*  SAFIDPTR = SIOTNPTR;                /*POINT TO THE NEXT SIOT      */
         L     @10,SAFIDPTR                                     02S0149
         L     @10,SIOTNPTR(,@10)                               02S0149
         ST    @10,SAFIDPTR                                     02S0149
*END;                                                           02S0150
@DE00142 SLR   @10,@10                                          02S0150
         C     @10,SAFIDPTR                                     02S0150
         BE    @DC00142                                         02S0150
         CR    RTNCODE,@10                                      02S0150
         BE    @DL00142                                         02S0150
@DC00142 DS    0H                                               02S0151
*            END;                                               01S0151
*          ELSE;                       /*A 1-GEN SOLUTION NOT FOUND  */
@RF00138 DS    0H                                               01S0153
*        END;                                                   01S0153
*      ELSE;                           /*ALG DID NOT COVER EVERYTHING*/
@RF00098 DS    0H                                               01S0155
*      IF CANSOLVE=OFF THEN            /*WAS A 1-GEN SOLUTION FOUND ?*/
         TM    CANSOLVE,B'10000000'                             01S0155
         BNZ   @RF00155                                         01S0155
*        DO;                           /*NO,REMOVE ALG'S COVERING    */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GIVEBACK                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - REMOVE THE ALGORITHM'S COVERING               */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     THIS ROUTINE GIVES BACK THE UNITS THE ALGORITHM HAS          */
*/*     ALREADY ALLOCATED TO THESE SIOTS WITH THE SAME SIOTAFID --   */
*/*     BECAUSE NO ONE GENERIC WAS ABLE TO COMPLETELY SATISFY ALL    */
*/*     THESE REQUESTS AND THEREFORE THESE REQUESTS SHOULD NOT BE    */
*/*     ALLOCATED AT ALL.                                            */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE ITSELF.    */
*/*                                                                  */
*/* ENTRY - (INLINE SUBROUTINE)                                      */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     SAFIDPTR - THE FIRST SIOT WITH THE SIOTAFID BEING PROCESSED. */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */
*/*                                                                  */
*/*   CONDITIONS - FUNCTION COMPLETED.                               */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*       GRPEXCS - INCREMENTED FOR GROUPS WHICH THE ALGORITHM       */
*/*                 HAD USED TO COVER THESE REQUESTS.                */
*/*       CVRGALL - SET TO 0 FOR GROUPS LIST ENTRIES WHICH THE       */
*/*                 ALGORITHM HAD USED TO COVER THESE REQUESTS.      */
*/*                                                                  */
*/*   RETURN CODES - (NONE)                                          */
*/*                                                                  */
*/********************************************************************/
*SAFIDPTR = SIOTPTR;                   /*POINT TO SIOT BEING PROCESSD*/
         ST    SIOTPTR,SAFIDPTR                                 02S0157
*DO WHILE (SAFIDPTR ^= ZERO);          /*SCAN THE REST OF THE SIOTS  */
         B     @DE00158                                         02S0158
@DL00158 DS    0H                                               02S0159
*  IF SIOTALCD = OFF                   /*UNALLOCATED SIOT IN THE.....*/
*     & SIOTAFID=SIOTPTR->SIOTAFID THEN/*...SAME MULTI-UNIT/GEN GROUP*/
         L     @10,SAFIDPTR                                     02S0159
         TM    SIOTALCD(@10),B'00000010'                        02S0159
         BNZ   @RF00159                                         02S0159
         CLC   SIOTAFID(2,@10),SIOTAFID(SIOTPTR)                02S0159
         BNE   @RF00159                                         02S0159
*    DO;                               /*YES, PROCESS ..             */
*      VUPTR = SVOLUNAD;               /*POINT TO SIOTS FIRST VU NTRY*/
         L     VUPTR,SVOLUNAD(,@10)                             02S0161
*      DO VUCTR = ONE TO SVOLUNNO;     /*SCAN ALL THE VOLUNIT ENTRIES*/
         LA    VUCTR,1                                          02S0162
         B     @DE00162                                         02S0162
@DL00162 DS    0H                                               02S0163
*        IF VOLALOC = OFF              /*IS THE VU ENTRY UNALLOCATED.*/
*            & CVRSKFLG = OFF THEN     /*..AND CONSIDERED BY ALG ?   */
         TM    VOLALOC(VUPTR),B'10000000'                       02S0163
         BNZ   @RF00163                                         02S0163
         L     @10,VOLALGTP(,VUPTR)                             02S0163
         TM    CVRSKFLG(@10),B'10000000'                        02S0163
         BNZ   @RF00163                                         02S0163
*          DO;                         /*YES, PROCESS ..             */
*            COVERED = OFF;            /*GROUP ALG USED NOT YET FOUND*/
         NI    COVERED,B'10111111'                              02S0165
*            GRPENTP = CVRGRPPT;       /*POINT TO 1ST GROUP LIST NTRY*/
         L     GRPENTP,CVRGRPPT(,@10)                           02S0166
*            DO AGPCTR = ONE TO CVRNGRP /*SCAN ALL GROUP LIST ENTRIES*/
*                WHILE (COVERED = OFF); /*..UNTIL GROUP ALG USED     */
         LA    AGPCTR,1                                         02S0167
         B     @DE00167                                         02S0167
@DL00167 TM    COVERED,B'01000000'                              02S0167
         BNZ   @DC00167                                         02S0167
*              IF CVRGALL > ZERO THEN  /*DID THE ALG PICK THIS GROUP?*/
         SLR   @10,@10                                          02S0168
         LH    @06,CVRGALL(,GRPENTP)                            02S0168
         CR    @06,@10                                          02S0168
         BNH   @RF00168                                         02S0168
*                DO;                   /*YES, GIVE BACK THE UNITS    */
*                  COVERED = ON;       /*INDICATE GROUP ALG USED FND */
         OI    COVERED,B'01000000'                              02S0170
*                  GRPEXCS=GRPEXCS+CVRGALL; /*INCREMENT UNITS ALG
*                                        DIDNT USE                   */
         L     @04,CVRGCPTR(,GRPENTP)                           02S0171
         AH    @06,GRPEXCS(,@04)                                02S0171
         STH   @06,GRPEXCS(,@04)                                02S0171
*                  CVRGALL = ZERO;     /*ZERO COUNT OF UNITS ALLOC'D */
         STH   @10,CVRGALL(,GRPENTP)                            02S0172
*                END;                                           02S0173
*              ELSE;                   /*ALG DID NOT PICK THIS GROUP */
@RF00168 DS    0H                                               02S0175
*              GRPENTP=GRPENTP+LENGTH(CVRGPLST); /*POINT TO NEXT GRP */
         AH    GRPENTP,@CH00277                                 02S0175
*           END;                                                02S0176
         AH    AGPCTR,@CH00041                                  02S0176
@DE00167 L     @10,VOLALGTP(,VUPTR)                             02S0176
         CH    AGPCTR,CVRNGRP(,@10)                             02S0176
         BNH   @DL00167                                         02S0176
@DC00167 DS    0H                                               02S0177
*         END;                                                  02S0177
*        ELSE;                         /*VU ENTRY NOT TO BE ALLOCATED*/
@RF00163 DS    0H                                               02S0179
*        VUPTR=VUPTR+LENGTH(VOLUNTAB); /*POINT TO NEXT VOLUNIT ENTRY */
         AH    VUPTR,@CH00457                                   02S0179
*      END;                                                     02S0180
         AH    VUCTR,@CH00041                                   02S0180
@DE00162 L     @10,SAFIDPTR                                     02S0180
         CH    VUCTR,SVOLUNNO(,@10)                             02S0180
         BNH   @DL00162                                         02S0180
*    END;                                                       02S0181
*  ELSE;                               /*SIOT NOT TO BE ALLOCATED    */
@RF00159 DS    0H                                               02S0183
*  SAFIDPTR = SIOTNPTR;                /*POINT TO THE NEXT SIOT      */
         L     @10,SAFIDPTR                                     02S0183
         L     @10,SIOTNPTR(,@10)                               02S0183
         ST    @10,SAFIDPTR                                     02S0183
*END;                                                           02S0184
@DE00158 ICM   @10,15,SAFIDPTR                                  02S0184
         BNZ   @DL00158                                         02S0184
*        END;                                                   01S0185
*      ELSE;                           /*A 1-GEN SOLUTION FOUND      */
@RF00155 DS    0H                                               01S0187
*      RFY INDMSIOT BASED(SIOTPTR);                             01S0187
*    END;                                                       01S0188
*  ELSE;                               /*SIOT NOT TO BE PROCESSED    */
@RF00030 DS    0H                                               01S0190
*  IF SVOLUNAD ^= ZERO THEN            /*VOL/UNIT ENTRY EXISTS?      */
         L     @10,SVOLUNAD(,SIOTPTR)                           01S0190
         LTR   @10,@10                                          01S0190
         BZ    @RF00190                                         01S0190
*    SVOLUNAD->VUMUGDON = OFF;         /*TURN OFF 'PROCESSED' SWITCH'*/
         NI    VUMUGDON(@10),B'01111111'                        01S0191
*  SIOTPTR = SIOTNPTR;                 /*POINT TO THE NEXT SIOT      */
@RF00190 L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       01S0192
*END;                                                           01S0193
@DE00029 SLR   @10,@10                                          01S0193
         CR    SIOTPTR,@10                                      01S0193
         BE    @DC00029                                         01S0193
         CR    RTNCODE,@10                                      01S0193
         BE    @DL00029                                         01S0193
@DC00029 DS    0H                                               01S0194
*RETURN CODE(RTNCODE);                 /*RETURN TO CALLER            */
         IC    @02,@OLDKEY                                      01S0194
         L     @13,4(,@13)                                      01S0194
         L     @00,@SIZDATD                                     01S0194
         LR    @01,@11                                          01S0194
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@07                                          01S0194
         L     @14,12(,@13)                                     01S0194
         LM    @00,@12,20(@13)                                  01S0194
         BR    @14                                              01S0194
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - FGENALOC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - TRY TO COVER WITH A PARTICULAR GENERIC        */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*     THIS ROUTINE TRIES TO COVER ALL OF THE SIOT'S UNIQUE UNIT    */
*/*     REQUESTS, EXCEPT FOR SCRATCH VOLUME REQUESTS, WITH THE       */
*/*     GENERIC DEVICE TYPE PICKED.                                  */
*/*     IF THE GROUP CURRENTLY COVERING ONE OF THE SIOT'S UNIT       */
*/*     REQUESTS IS NOT IN THE GENERIC PICKED, THEN THIS ROUTINE     */
*/*     LOOKS FOR AN ELIGIBLE GROUP IN THE GENERIC PICKED WHICH HAS  */
*/*     UNITS NOT USED BY THE ALGORITHM (GRPEXCS > 0). IF SUCH A     */
*/*     GROUP IS FOUND, THE COVERING FOR THIS REQUEST IS CHANGED     */
*/*     TO THIS GROUP.                                               */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE ITSELF.    */
*/*                                                                  */
*/* ENTRY - (INLINE SUBROUTINE)                                      */
*/*                                                                  */
*/*   PURPOSE - (SEE FUNCTION)                                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*       SAFIDPTR - PTR TO THE SIOT TO PROCESS                      */
*/*       LOWGRP - FIRST ELIGIBLE GROUP IN THE GENERIC PICKED        */
*/*       HIGHGRP - LAST ELIGIBLE GROUP IN THE GENERIC PICKED        */
*/*       SOLVED - 1                                                 */
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */
*/*                                                                  */
*/*   CONDITIONS - FUNCTION COMPLETED.                               */
*/*   OUTPUT -                                                       */
*/*       SOLVED - SET TO 0 IF THE GENERIC CANNOT COVER ALL OF THE   */
*/*                SIOT'S REQUESTS.                                  */
*/*       GRPEXCS - MAY BE INCREMENTED FOR GROUPS NOT IN THE         */
*/*                 GENERIC PICKED.                                  */
*/*               - MAY BE DECREMENTED FOR GROUPS IN THE GENERIC     */
*/*                 PICKED.                                          */
*/*       CVRGALL - MAY BE SET TO 0 FOR GROUPS NOT IN THE GENERIC    */
*/*                 PICKED.                                          */
*/*               - MAY BE INCREMENTED FOR GROUPS IN THE GENERIC     */
*/*                 PICKED.                                          */
*/*   RETURN CODES - (NONE)                                          */
*/*                                                                  */
*/********************************************************************/
*FGENALOC: PROC;                                                02S0195
FGENALOC STM   @14,@12,12(@13)                                  02S0195
*VUPTR = SAFIDPTR->SVOLUNAD;           /*POINT TO SIOTS FIRST VU NTRY*/
         L     @10,SAFIDPTR                                     02S0196
         L     VUPTR,SVOLUNAD(,@10)                             02S0196
*DO VUCTR = ONE TO SAFIDPTR->SVOLUNNO  /*SCAN ALL THE VOLUNIT ENTRIES*/
*    WHILE (SOLVED = ON);              /*..UNTIL THE GEN CANT COVER  */
         LA    VUCTR,1                                          02S0197
         B     @DE00197                                         02S0197
@DL00197 TM    SOLVED,B'00010000'                               02S0197
         BNO   @DC00197                                         02S0197
*  IF VOLALOC = OFF                    /*IS THE VU ENTRY UNALLOCATED,*/
*      & VDEVREQD = ON                 /*..REQUIRING A DEVICE,       */
*      & CVRSCRTH = OFF                /*..BUT NOT A SCRATCH REQ     */
*      & CVRDUPLI = OFF THEN           /*..OR A DUPLICATE OF ANOTHER?*/
         TM    VDEVREQD(VUPTR),B'00100000'                      02S0198
         BNO   @RF00198                                         02S0198
         TM    VOLALOC(VUPTR),B'10000000'                       02S0198
         BNZ   @RF00198                                         02S0198
         L     @10,VOLALGTP(,VUPTR)                             02S0198
         TM    CVRSCRTH(@10),B'00001000'                        02S0198
         BNZ   @RF00198                                         02S0198
         TM    CVRDUPLI(@10),B'10000000'                        02S0198
         BNZ   @RF00198                                         02S0198
*    DO;                               /*YES, PROCESS ..             */
*      COVERED = OFF;                  /*GROUP ALG USED NOT YET FOUND*/
         NI    COVERED,B'10111111'                              02S0200
*      GRPENTP = CVRGRPPT;             /*POINT TO 1ST GROUP LIST NTRY*/
         L     GRPENTP,CVRGRPPT(,@10)                           02S0201
*      DO AGPCTR = ONE TO CVRNGRP      /*SCAN ALL GROUP LIST ENTRIES */
*          WHILE (COVERED = OFF);      /*..UNTIL GROUP ALG USED FOUND*/
         LA    AGPCTR,1                                         02S0202
         B     @DE00202                                         02S0202
@DL00202 TM    COVERED,B'01000000'                              02S0202
         BNZ   @DC00202                                         02S0202
*        IF CVRGALL > ZERO THEN        /*DID THE ALG PICK THIS GROUP?*/
         ICM   @10,3,CVRGALL(GRPENTP)                           02S0203
         BNP   @RF00203                                         02S0203
*          DO;                         /*YES, PROCESS ..             */
*            COVERED = ON;             /*INDICATE ALG COVERING FOUND */
         OI    COVERED,B'01000000'                              02S0205
*            IF CVRGRPID < LOWGRP      /*IS THE GROUP PICKED IN THE..*/
*                × CVRGRPID>HIGHGRP THEN /*..1 GEN BEING PROCESSED ? */
         LH    @10,CVRGRPID(,GRPENTP)                           02S0206
         CH    @10,LOWGRP                                       02S0206
         BL    @RT00206                                         02S0206
         CH    @10,HIGHGRP                                      02S0206
         BNH   @RF00206                                         02S0206
@RT00206 DS    0H                                               02S0207
*              DO;                     /*NO, TRY TO CHANGE COVERING  */
*                GPTR = GRPENTP;       /*SAVE PTR TO THIS GROUP      */
         LR    GPTR,GRPENTP                                     02S0208
*                SOLVED = OFF;         /*1-GEN SOLUTION NOT YET FOUND*/
         NI    SOLVED,B'11101111'                               02S0209
*                GRPENTP = CVRGRPPT;   /*POINT TO 1ST GROUP LIST NTRY*/
         L     @10,VOLALGTP(,VUPTR)                             02S0210
         L     GRPENTP,CVRGRPPT(,@10)                           02S0210
*                DO RAGPCTR=ONE TO CVRNGRP /*SCAN ALL GROUP ENTRIES  */
*                    WHILE (SOLVED=OFF); /*..UNTIL 1-GEN SOLUTION FND*/
         LA    RAGPCTR,1                                        02S0211
         B     @DE00211                                         02S0211
@DL00211 TM    SOLVED,B'00010000'                               02S0211
         BNZ   @DC00211                                         02S0211
*                  IF CVRGRPID => LOWGRP /*IS THE GROUP IN THE 1 GEN */
*                      & CVRGRPID <= HIGHGRP /*..BEING PROCESSED AND */
*                      & GRPEXCS > ZERO   /*.HAS EXTRA UNITS @Y30QPPA*/
*                      & CVRGSKP = OFF THEN /*AND IS ELIG.   @Y30QPPA*/
         LH    @10,CVRGRPID(,GRPENTP)                           02S0212
         CH    @10,LOWGRP                                       02S0212
         BL    @RF00212                                         02S0212
         CH    @10,HIGHGRP                                      02S0212
         BH    @RF00212                                         02S0212
         SLR   @10,@10                                          02S0212
         L     @15,CVRGCPTR(,GRPENTP)                           02S0212
         LH    @14,GRPEXCS(,@15)                                02S0212
         CR    @14,@10                                          02S0212
         BNH   @RF00212                                         02S0212
         TM    CVRGSKP(GRPENTP),B'10000000'                     02S0212
         BNZ   @RF00212                                         02S0212
*                    DO;               /*YES, ALLOCATE TO THE REQUEST*/
*                      SOLVED = ON;    /*INDICATE 1-GEN SOLUTION FND */
         OI    SOLVED,B'00010000'                               02S0214
*                      GRPEXCS=GRPEXCS-ONE; /*DECREMENT EXTRA UNITS  */
         BCTR  @14,0                                            02S0215
         STH   @14,GRPEXCS(,@15)                                02S0215
*                      CVRGALL = ONE;  /*SET COUNT OF UNITS ALLOC'D  */
         LA    @15,1                                            02S0216
         STH   @15,CVRGALL(,GRPENTP)                            02S0216
*                      GPTR->CVRGCPTR->GRPEXCS=                 02S0217
*                      GPTR->CVRGCPTR->GRPEXCS+ONE;             02S0217
         L     @14,CVRGCPTR(,GPTR)                              02S0217
         AH    @15,GRPEXCS(,@14)                                02S0217
         STH   @15,GRPEXCS(,@14)                                02S0217
*                                      /*INCR EXCESS OF OTHER GROUP  */
*                      GPTR->CVRGALL=ZERO;/*ZERO COUNT OF UNITS ALLOC*/
         STH   @10,CVRGALL(,GPTR)                               02S0218
*                    END;                                       02S0219
*                  ELSE;               /*NOT THIS GEN WITH EXTRA UNIT*/
@RF00212 DS    0H                                               02S0221
*                  GRPENTP=GRPENTP+LENGTH(CVRGPLST); /*NEXT GRP ENTRY*/
         AH    GRPENTP,@CH00277                                 02S0221
*                END;                                           02S0222
         AH    RAGPCTR,@CH00041                                 02S0222
@DE00211 L     @10,VOLALGTP(,VUPTR)                             02S0222
         CH    RAGPCTR,CVRNGRP(,@10)                            02S0222
         BNH   @DL00211                                         02S0222
@DC00211 DS    0H                                               02S0223
*              END;                                             02S0223
*            ELSE;                     /*GROUP IN GEN BEING PROCESSED*/
@RF00206 DS    0H                                               02S0225
*          END;                                                 02S0225
*        ELSE                          /*ALG DID NOT USED THIS GROUP */
*            GRPENTP=GRPENTP+LENGTH(CVRGPLST); /*PT TO NEXT GROUP ENT*/
         B     @RC00203                                         02S0226
@RF00203 AH    GRPENTP,@CH00277                                 02S0226
*      END;                                                     02S0227
@RC00203 AH    AGPCTR,@CH00041                                  02S0227
@DE00202 L     @10,VOLALGTP(,VUPTR)                             02S0227
         CH    AGPCTR,CVRNGRP(,@10)                             02S0227
         BNH   @DL00202                                         02S0227
@DC00202 DS    0H                                               02S0228
*    END;                                                       02S0228
*  ELSE;                               /*VU ENTRY NOT TO BE PROCESSED*/
@RF00198 DS    0H                                               02S0230
*  VUPTR = VUPTR + LENGTH(VOLUNTAB);   /*POINT TO NEXT VOLUNIT ENTRY */
         AH    VUPTR,@CH00457                                   02S0230
*END;                                                           02S0231
         AH    VUCTR,@CH00041                                   02S0231
@DE00197 L     @10,SAFIDPTR                                     02S0231
         CH    VUCTR,SVOLUNNO(,@10)                             02S0231
         BNH   @DL00197                                         02S0231
@DC00197 DS    0H                                               02S0232
*END FGENALOC;                                                  02S0232
@EL00002 DS    0H                                               02S0232
@EF00002 DS    0H                                               02S0232
@ER00002 LM    @14,@12,12(@13)                                  02S0232
         BR    @14                                              02S0232
*END IEFAB474                                                   01S0233
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A474SPEC)                                        *
*/*%INCLUDE SYSLIB  (A474DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFZB422)                                        *
*/*%INCLUDE SYSLIB  (IEFZB423)                                        *
*/*%INCLUDE SYSLIB  (IEFZB425)                                        *
*/*%INCLUDE SYSLIB  (IEFZB426)                                        *
*/*%INCLUDE SYSLIB  (HOWALGC )                                        *
*/*%INCLUDE SYSLIB  (HOWASPEC)                                        *
*/*%INCLUDE SYSLIB  (FORCEGEN)                                        *
*/*%INCLUDE SYSLIB  (FGENSPEC)                                        *
*/*%INCLUDE SYSLIB  (ELIMGENS)                                        *
*/*%INCLUDE SYSLIB  (ELIMSPEC)                                        *
*/*%INCLUDE SYSLIB  (GIVEBACK)                                        *
*/*%INCLUDE SYSLIB  (BACKSPEC)                                        *
*/*%INCLUDE SYSLIB  (FGENALOC)                                        *
*/*%INCLUDE SYSLIB  (FALCSPEC)                                        *
*;                                                              01S0233
@DATA    DS    0H
@CH00041 DC    H'1'
@CH00277 DC    H'16'
@CH00457 DC    H'28'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@AL00001 DS    2A
IEFAB474 CSECT
         DS    0F
@DATD    DSECT
         DS    0D
SAFIDPTR DS    A
EGRPCTR  DS    F
EDLUCBLP DS    A
HIGHGRP  DS    H
LOWGRP   DS    H
GENIDALC DS    CL4
@NM00002 DS    CL1
         ORG   @NM00002
CANSOLVE DS    BL1
COVERED  EQU   @NM00002+0
GENFOUND EQU   @NM00002+0
SOLVED   EQU   @NM00002+0
@NM00003 EQU   @NM00002+0
         ORG   @NM00002+1
@OLDKEY  DS    AL1
IEFAB474 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00081 DC    V(IEFAB481)
         DS    0D
IEFAB474 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB474 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
VUCTR    EQU   @09
SAVEAFID EQU   @03
RTNCODE  EQU   @07
RAGPCTR  EQU   @05
EGENCTR  EQU   @10
AGPCTR   EQU   @08
VUPTR    EQU   @02
SIOTPTR  EQU   @05
GRPENTP  EQU   @03
GPTR     EQU   @04
EDLPTR   EQU   @04
EDLGNTP  EQU   @06
REG15    EQU   @15
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTAFID EQU   INDMSIOT+26
SIOTBYT1 EQU   INDMSIOT+43
SIOTALCD EQU   SIOTBYT1
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTEDLP EQU   INDMSIOT+136
SVOLUNAD EQU   INDMSIOT+140
SIOTNPTR EQU   INDMSIOT+152
SVOLUNNO EQU   INDMSIOT+168
IEFEDL   EQU   0
EDLHDR   EQU   IEFEDL
EDLGENNO EQU   EDLHDR+4
EDLFGENP EQU   EDLHDR+8
EDLUVFLG EQU   EDLHDR+16
EDLENTRY EQU   0
EDLNXTNT EQU   EDLENTRY
EDLDEVT  EQU   EDLENTRY+4
EDLGRPNO EQU   EDLENTRY+8
EDLGRPTR EQU   EDLENTRY+12
EDLDTFLG EQU   EDLENTRY+20
EINDEVTP EQU   EDLDTFLG
EDLGNTRY EQU   0
EDLNXGRP EQU   EDLGNTRY
EDLGRID  EQU   EDLGNTRY+12
EDLGRFLG EQU   EDLGNTRY+16
EDLUCBL  EQU   0
EDLINDIC EQU   EDLUCBL+2
VOLUNTAB EQU   0
VOLSTAT  EQU   VOLUNTAB+6
VOLSTATA EQU   VOLSTAT
VOLSTATB EQU   VOLSTAT+1
VOLALOC  EQU   VOLSTATB
VDEVREQD EQU   VOLSTATB
VOLSTATC EQU   VOLSTAT+2
VOLSTATD EQU   VOLSTAT+3
VUMUGDON EQU   VOLSTATD
VOLALGTP EQU   VOLUNTAB+12
ALCWA    EQU   0
SIOT1P   EQU   ALCWA+8
CNTABLE  EQU   ALCWA+28
ALGTABP  EQU   ALCWA+88
INDICATE EQU   ALCWA+112
@NM00024 EQU   ALCWA+113
TIOTHDRP EQU   ALCWA+120
LGENLOCK EQU   ALCWA+124
NAMES    EQU   0
ALGPTRS  EQU   0
ALGPARMP EQU   ALGPTRS
CVRPARM  EQU   0
CVRGRPLK EQU   CVRPARM+6
CVRFLG1  EQU   CVRPARM+8
CVRRQLST EQU   0
CVRMIN   EQU   CVRRQLST+10
CVRFLG2  EQU   CVRRQLST+16
CVRSKFLG EQU   CVRFLG2
CVRSCRTH EQU   CVRFLG2
CVRDUPLI EQU   CVRFLG2+1
CVRNGRP  EQU   CVRRQLST+18
CVRGRPPT EQU   CVRRQLST+20
CVRGPLST EQU   0
CVRGCPTR EQU   CVRGPLST
CVRGRPID EQU   CVRGPLST+4
CVRGALL  EQU   CVRGPLST+8
CVRFLG3  EQU   CVRGPLST+12
CVRGSKP  EQU   CVRFLG3
GRPCOUNT EQU   0
GRPEXCS  EQU   GRPCOUNT+8
ALCWAPTR EQU   0
FUNCMAP  EQU   0
ONLYLGEN EQU   FUNCMAP
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00001 EQU   FUNCMAP
GRPWPTR  EQU   GRPCOUNT+12
GRPIDENT EQU   GRPCOUNT+10
GRPTOTAL EQU   GRPCOUNT+6
GRPOFFLN EQU   GRPCOUNT+4
GRPALLCT EQU   GRPCOUNT+2
GRPAVAIL EQU   GRPCOUNT
@NM00031 EQU   CVRGPLST+13
@NM00030 EQU   CVRFLG3
CVRFORCI EQU   CVRFLG3
CVRBOUND EQU   CVRGPLST+10
CVRGRPAL EQU   CVRGPLST+6
@NM00029 EQU   CVRRQLST+26
CVRWUCBP EQU   CVRRQLST+24
@NM00028 EQU   CVRFLG2+1
CVRWMOVE EQU   CVRFLG2
CVRIGNOR EQU   CVRFLG2
CVRMULTI EQU   CVRFLG2
CVRFULL  EQU   CVRFLG2
CVRREACH EQU   CVRFLG2
CVRRUSED EQU   CVRFLG2
CVRGNEXT EQU   CVRRQLST+12
CVRPTS   EQU   CVRMIN
CVRNEED  EQU   CVRRQLST+8
CVRALLCT EQU   CVRRQLST+6
CVRREQ1  EQU   CVRRQLST+4
CVRVUPTR EQU   CVRRQLST
@NM00027 EQU   CVRPARM+9
@NM00026 EQU   CVRFLG1
CVRFCALL EQU   CVRFLG1
CVROFFLG EQU   CVRFLG1
CVRALFLG EQU   CVRFLG1
CVRAVFLG EQU   CVRFLG1
CVRNREQ  EQU   CVRPARM+4
CVRRQPTR EQU   CVRPARM
ALGGCNTP EQU   ALGPTRS+12
ALGGLSTP EQU   ALGPTRS+8
ALGRQLTP EQU   ALGPTRS+4
ALCPROCN EQU   NAMES+16
ALCSTEPN EQU   NAMES+8
ALCJOBN  EQU   NAMES
EXITPRMP EQU   ALCWA+144
CANCELP  EQU   ALCWA+140
WORK3MP  EQU   ALCWA+136
WMASK2P  EQU   ALCWA+132
WMASKPTR EQU   ALCWA+128
TCBP     EQU   ALCWA+116
ALCWASID EQU   ALCWA+114
@NM00025 EQU   @NM00024
NODEVERR EQU   @NM00024
NEEDRCVY EQU   @NM00024
ALCWAREC EQU   @NM00024
WAITIGEN EQU   @NM00024
UNITRECS EQU   @NM00024
ALCWADUL EQU   INDICATE
ALCWISAM EQU   INDICATE
DSSUNIT  EQU   INDICATE
DSSTAPE  EQU   INDICATE
PRIVASUM EQU   INDICATE
INDREQU  EQU   INDICATE
INDRETRY EQU   INDICATE
INDWAIT  EQU   INDICATE
QMGRRBP  EQU   ALCWA+108
RIMTABCT EQU   ALCWA+104
RIMTABLN EQU   ALCWA+100
RIMTABP  EQU   ALCWA+96
ALGTABSZ EQU   ALCWA+92
VOLUNSZE EQU   ALCWA+84
VOLUNPTR EQU   ALCWA+80
@NM00023 EQU   ALCWA+78
LTUNITID EQU   ALCWA+76
TOTVOLUN EQU   CNTABLE+44
NUMREQS  EQU   CNTABLE+40
TOTREQS  EQU   CNTABLE+36
OTHEREQS EQU   CNTABLE+32
SUBSREQS EQU   CNTABLE+28
STRGREQS EQU   CNTABLE+24
PUBLREQS EQU   CNTABLE+20
PVTNREQS EQU   CNTABLE+16
SPECREQS EQU   CNTABLE+12
TPREQS   EQU   CNTABLE+8
VAMREQS  EQU   CNTABLE+4
DMYREQS  EQU   CNTABLE
EDTABPTR EQU   ALCWA+24
FAILRSCP EQU   ALCWA+20
IOSLUTP  EQU   ALCWA+16
JSCBPTR  EQU   ALCWA+12
FMAPPTR  EQU   ALCWA+4
WASIZE   EQU   ALCWA
VUGRID   EQU   VOLUNTAB+24
VUUCBP   EQU   VOLUNTAB+20
VOLSIOTP EQU   VOLUNTAB+16
VOLUNTID EQU   VOLUNTAB+10
VURCVYPR EQU   VOLSTATD
VUVLUNIQ EQU   VOLSTATD
VUDMUNIQ EQU   VOLSTATD
VUUNALSW EQU   VOLSTATD
VUDMNDAL EQU   VOLSTATD
VUDMNDOF EQU   VOLSTATD
VUREALOC EQU   VOLSTATD
@NM00022 EQU   VOLSTATC
@NM00021 EQU   VOLSTATC
VURECVRY EQU   VOLSTATC
VOLURREQ EQU   VOLSTATC
VOLGRREQ EQU   VOLSTATC
VOLDAREQ EQU   VOLSTATC
VOLCOREQ EQU   VOLSTATC
VOLTAREQ EQU   VOLSTATC
VUAFFWRK EQU   VOLSTATB
VUVINELG EQU   VOLSTATB
VUDADSME EQU   VOLSTATB
VUDNALOC EQU   VOLSTATB
VUPROCED EQU   VOLSTATB
VOLMNTD  EQU   VOLSTATB
VOLDEFER EQU   VOLSTATA
VUDADSM  EQU   VOLSTATA
VOLRESVE EQU   VOLSTATA
VOLNSHR  EQU   VOLSTATA
VOLSTG   EQU   VOLSTATA
VOLSPEC  EQU   VOLSTATA
VOLPRV   EQU   VOLSTATA
VOLPUB   EQU   VOLSTATA
VOLID    EQU   VOLUNTAB
EDLNOJES EQU   EDLINDIC
EDLVOLAF EQU   EDLINDIC
EDLENQ   EQU   EDLINDIC
EDLDADSM EQU   EDLINDIC
EDLALCD  EQU   EDLINDIC
EDLUCBAD EQU   EDLUCBL
EDLJINEL EQU   EDLGRFLG
EDLLISTP EQU   EDLGNTRY+8
EDLUCBNO EQU   EDLGNTRY+4
@NM00020 EQU   EDLENTRY+18
EDLNSCNT EQU   EDLENTRY+16
EDLMGENS EQU   EDLUVFLG
EDLVAM   EQU   EDLUVFLG
EDLGMTP  EQU   EDLHDR+12
EDLLUV   EQU   EDLHDR
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SJFCBPTR EQU   INDMSIOT+156
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SCTANAME EQU   INDMSIOT+122
@NM00019 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
@NM00018 EQU   SIOTBYT2
@NM00017 EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00016 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00015 EQU   SIOTALTD
@NM00014 EQU   SIOTALTD
@NM00013 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00012 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00011 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00010 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
SIOTAFF  EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
SCTALCHK EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
@NM00009 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00008 EQU   SIOTTSTC
@NM00007 EQU   SIOTBYT3
S3400OFF EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00006 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00005 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
@NM00004 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00065 EQU   @RC00062
@RC00045 EQU   @RC00043
@ENDDATA EQU   *
         END   IEFAB474,(C'PLS2001',0701,76352)

         TITLE 'IEFAB479 - ALLOCATE DEMAND REQUESTS                    *
                        '
IEFAB479 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB479  75.314'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(8),0(@01)                               01S0001
         MODESET EXTKEY=SCHED
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*RTNCODE=SUCCESS;                       /*INITIALIZE RETURN CODE     */
         SLR   RTNCODE,RTNCODE                                  01S0051
*NSPCMNT=OFF;                           /*INITIALIZE SWITCH          */
         NI    NSPCMNT,B'01111111'                              01S0052
*IF SPMNTSW=ON THEN                     /*ANY SPECIFIC REQUESTS?     */
         L     @10,@PC00001+4                                   01S0053
         TM    SPMNTSW(@10),B'00100000'                         01S0053
         BNO   @RF00053                                         01S0053
*  DO;                                  /*YES                        */
*    CALL IEFAB433(ALCWAPTR,ADDR(FUNCLIST)); /*ALLOC SPECS TO MNTDS  */
         L     @10,@PC00001                                     01S0055
         ST    @10,@AL00001                                     01S0055
         LA    @10,FUNCLIST                                     01S0055
         ST    @10,@TF00001                                     01S0055
         LA    @10,@TF00001                                     01S0055
         ST    @10,@AL00001+4                                   01S0055
         L     @15,@CV00153                                     01S0055
         LA    @01,@AL00001                                     01S0055
         BALR  @14,@15                                          01S0055
*    RTNCODE=REG15;                       /*SAVE RETURN CODE         */
         LR    RTNCODE,REG15                                    01S0056
*  END;                                                         01S0057
*IF RTNCODE=SUCCESS THEN                /*SPEC TO MOUNTEDS SUCCESS?  */
@RF00053 LTR   RTNCODE,RTNCODE                                  01S0058
         BNZ   @RF00058                                         01S0058
*  DO;                                  /*YES                        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - FIRSTSCN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - FIRST SCAN OF SIOTS                           */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE PURPOSE OF THIS CODE SEGMENT IS TO SCAN THE SIOTS AFTER    */
*/*   RETURN FROM IEFAB433 LOOKING FOR UNALLOCATED DEMAND REQUESTS   */
*/*   ELIGIBLE TO THIS GENERIC. VARIOUS ERROR AND RECOVERY SITUA-    */
*/*   TIONS ARE CHECKED FOR, AND IF NONE ARE FOUND,AN ATTEMPT IS     */
*/*   MADE TO ALLOCATE THE REQUEST.                                  */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   THE OPERATION IS DOCUMENTED BY THE CODE.                       */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     OFFDEVSW - OK TO CONSIDER OFFLINES                           */
*/*     VOLMNTSW - ALLOW VOLUME MOUNTING                             */
*/*     SIOT1P   - ADDRESS OF FIRST SIOT                             */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - ALL ELIGIBLE DEMANDS EXCEPT PUBLIC NON-SPECIFICS   */
*/*               ARE ALLOCATED OR MARKED FOR RECOVERY               */
*/*                                                                  */
*/*   OUTPUT - REQUESTS MARKED ALLOCATED(SIOTALCD=ON) OR RECOVERY    */
*/*            (VUDNALOC=ON). IF ALLOCATED,                          */
*/*            COUNTS OF REQUESTS STILL TO BE ALLOCATED DECREMENTED. */
*/*                                                                  */
*/*   RETURN CODE - 0 IN RTNCODE                                     */
*/*                                                                  */
*/* EXIT - ERROR - INLINE SUBROUTINE                                 */
*/*                                                                  */
*/*   CONDITIONS - AN ERROR WHICH CAUSES ALLOCATION TO FAIL HAS      */
*/*                BEEN DETECTED.                                    */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     A REASON CODE IS PUT IN FIELD SIOTRSNC OF THE SIOT. THE      */
*/*     POSSIBLE REASON CODES ARE AS FOLLOWS:                        */
*/*                                                                  */
*/*       0021 - UCB NOT USEABLE                                     */
*/*                                                                  */
*/*       0070 - CAN'T CONSIDER OFFLINES                             */
*/*                                                                  */
*/*       0056 - VOLUMES CAN'T BE MOUNTED                            */
*/*                                                                  */
*/*       0066 - VOL MOUNTED IS PERMRES/RESVD                        */
*/*                                                                  */
*/*       0071 - REQUESTED DEVICE IS A CONSOLE                       */
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/********************************************************************/
*SIOTPTR=SIOT1P;                        /*POINT TO FIRST SIOT        */
         L     @10,@PC00001                                     02S0060
         L     @10,ALCWAPTR(,@10)                               02S0060
         MVC   SIOTPTR(4),SIOT1P(@10)                           02S0060
*DO WHILE SIOTPTR ^= ZERO & RTNCODE=SUCCESS; /*SCAN ALL SIOTS        */
         B     @DE00061                                         02S0061
@DL00061 DS    0H                                               02S0062
*  VUPTR=SVOLUNAD;                      /*POINT TO VOL UN ENTRY      */
         L     @10,SIOTPTR                                      02S0062
         L     @02,SVOLUNAD(,@10)                               02S0062
         ST    @02,VUPTR                                        02S0062
*  IF SIOTALCD=NO & SIOTGIGN=OFF &      /*UNALLOC'D ELIGIBLE SIOT    */
*      VUVINELG=OFF THEN                /*NOT MARKED INELIGIBLE      */
         TM    SIOTALCD(@10),B'00000010'                        02S0063
         BNZ   @RF00063                                         02S0063
         TM    SIOTGIGN(@10),B'00001000'                        02S0063
         BNZ   @RF00063                                         02S0063
         TM    VUVINELG(@02),B'00000010'                        02S0063
         BNZ   @RF00063                                         02S0063
*    DO;                                /*YES                        */
*      UCBPTR=SIOUCBAD;                 /*POINT TO REQ'S UCB         */
         SLR   @02,@02                                          02S0065
         ICM   @02,7,SIOUCBAD(@10)                              02S0065
         ST    @02,UCBPTR                                       02S0065
*      IF UCBNALOC=ON THEN              /*IS UCB USEABLE?            */
         TM    UCBNALOC(@02),B'00000100'                        02S0066
         BNO   @RF00066                                         02S0066
*        DO;                            /*NO                         */
*          RTNCODE=FAILURE;             /*SET ERROR RETURN CODE      */
         LA    RTNCODE,4                                        02S0068
*          SIOTRSNC=NALOCON;            /*SET SIOT REASON CODE       */
         MVC   SIOTRSNC(2,@10),@CH00120                         02S0069
*        END;                                                   02S0070
*      ELSE                             /*UCB IS USEABLE             */
*        IF UCBONLI=OFF THEN            /*IS UCB ONLINE?             */
         B     @RC00066                                         02S0071
@RF00066 L     @10,UCBPTR                                       02S0071
         TM    UCBONLI(@10),B'10000000'                         02S0071
         BNZ   @RF00071                                         02S0071
*          DO;                          /*NO                         */
*            IF OFFDEVSW=OFF THEN       /*CAN ALLOC CONSIDER OFFLINES*/
         L     @10,@PC00001                                     02S0073
         L     @10,ALCWAPTR(,@10)                               02S0073
         L     @10,FMAPPTR(,@10)                                02S0073
         TM    OFFDEVSW(@10),B'00000100'                        02S0073
         BNZ   @RF00073                                         02S0073
*              DO;                      /*NO                         */
*               RTNCODE=FAILURE ;       /*SET ERROR RETURN CODE      */
         LA    RTNCODE,4                                        02S0075
*               SIOTRSNC=NOFFLINS;      /*SET SIOT REASON CODE       */
         L     @10,SIOTPTR                                      02S0076
         MVC   SIOTRSNC(2,@10),@CH00124                         02S0076
*              END;                                             02S0077
*            ELSE                      /*CAN CONSIDER OFFLINES       */
*              IF VOLMNTSW=OFF &       /*CAN VOLUMES BE MOUNTED?     */
*                 (UCB3DACC = ON ×     /*DIRECT ACCESS ?             */
*                  UCB3TAPE = ON) THEN /*TAPE ?                      */
         B     @RC00073                                         02S0078
@RF00073 L     @10,@PC00001                                     02S0078
         L     @10,ALCWAPTR(,@10)                               02S0078
         L     @10,FMAPPTR(,@10)                                02S0078
         TM    VOLMNTSW(@10),B'10000000'                        02S0078
         BNZ   @RF00078                                         02S0078
         L     @10,UCBPTR                                       02S0078
         TM    UCB3DACC(@10),B'10100000'                        02S0078
         BZ    @RF00078                                         02S0078
*                DO;                   /*NO                          */
*                  RTNCODE=FAILURE;    /*SET RETURN CODE             */
         LA    RTNCODE,4                                        02S0080
*                  SIOTRSNC=NOMNTING;  /*SET SIOT REASON CODE        */
         L     @10,SIOTPTR                                      02S0081
         MVC   SIOTRSNC(2,@10),@CH00126                         02S0081
*                END;                                           02S0082
*              ELSE                    /*CAN MOUNT VOLUMES           */
*                CALL MARKVUS;         /*MARK VU ENTRY FOR RECOVERY  */
         B     @RC00078                                         02S0083
@RF00078 BAL   @14,MARKVUS                                      02S0083
*          END;                                                 02S0084
*        ELSE                          /*UCB IS ONLINE               */
*          DO;                                                  02S0085
         B     @RC00071                                         02S0085
@RF00071 DS    0H                                               02S0086
*            IF UCB3TAPE=OFF & UCB3DACC=OFF THEN /*NON-TAPE/DA?      */
         L     @10,UCBPTR                                       02S0086
         TM    UCB3TAPE(@10),B'10100000'                        02S0086
         BNZ   @RF00086                                         02S0086
*              DO;                    /*YES                          */
*                IF UCBSYSR=ON THEN   /*PRIMARY CONSOLE?             */
         TM    UCBSYSR(@10),B'00000010'                         02S0088
         BNO   @RF00088                                         02S0088
*                  DO;                /*YES                          */
*                    RTNCODE=FAILURE; /*SET RETURN CODE              */
         LA    RTNCODE,4                                        02S0090
*                    SIOTRSNC=CONSOLE; /*SET SIOT RSCN               */
         L     @10,SIOTPTR                                      02S0091
         MVC   SIOTRSNC(2,@10),@CH00111                         02S0091
*                  END;                                         02S0092
*              END;                                             02S0093
@RF00088 DS    0H                                               02S0094
*            IF ((UCBPRES=ON & (UCBALOC=ON /*                @YM05583*/
*               × (UCBVOLI ^= VOLSER0 & UCBMOUNT=OFF))) /*   @YM05583*/
*               × UCBRESV=ON) &        /*PERMRES/RSVD?       @YM05583*/
*                (UCBBPRV=ON × VOLSPEC=ON ×                     02S0094
*                 VOLPRV = ON) THEN   /*PRIVATE VOL, SPECIFIC REQ,
*                                        OR PRIVATE REQUEST          */
@RF00086 L     @10,UCBPTR                                       02S0094
         TM    UCBPRES(@10),B'00000100'                         02S0094
         BNO   @GL00005                                         02S0094
         TM    UCBALOC(@10),B'00001000'                         02S0094
         BO    @GL00004                                         02S0094
         CLC   UCBVOLI(6,@10),VOLSER0                           02S0094
         BE    @GL00005                                         02S0094
         TM    UCBMOUNT(@10),B'10000000'                        02S0094
         BZ    @GL00004                                         02S0094
@GL00005 L     @10,UCBPTR                                       02S0094
         TM    UCBRESV(@10),B'00100000'                         02S0094
         BNO   @RF00094                                         02S0094
@GL00004 L     @10,UCBPTR                                       02S0094
         TM    UCBBPRV(@10),B'00010000'                         02S0094
         BO    @RT00094                                         02S0094
         L     @10,VUPTR                                        02S0094
         TM    VOLSPEC(@10),B'01100000'                         02S0094
         BZ    @RF00094                                         02S0094
@RT00094 DS    0H                                               02S0095
*              DO;                     /*YES, THEN ERROR             */
*                RTNCODE=FAILURE;      /*SET ERROR RETURN CODE       */
         LA    RTNCODE,4                                        02S0096
*                SIOTRSNC=PMRSRSVD;    /*SET SIOT REASON CODE        */
         L     @10,SIOTPTR                                      02S0097
         MVC   SIOTRSNC(2,@10),@CH00134                         02S0097
*              END;                                             02S0098
*            IF RTNCODE=SUCCESS THEN                            02S0099
@RF00094 LTR   RTNCODE,RTNCODE                                  02S0099
         BNZ   @RF00099                                         02S0099
*              DO;                                              02S0100
*/********************************************************************/
*/*                                                                  */
*/*  SEGMENT NAME - ALOCSPFC                                         */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ALLOCATE SPECIFICS & PRIVATE NON-SPECIFICS    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT DETERMINES WHETHER THE REQUEST BEING PROCESSED    */
*/*   MUST WAIT,BE FAILED OR BE ALLOCATED BY 'ALLOCATE REQUEST TO    */
*/*   UNIT'                                                          */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   THIS ROUTINE DETERMINES IF THE VOLUME ON THE SPECIFIED UNIT    */
*/*   IS ALLOCATED. IF IT IS ALLOCATED AND THE REQUEST IS FOR TAPE   */
*/*   OR DA,ANOTHER SEGMENT,DATPALOC,HANDLES IT. IF IT IS ALLOC-     */
*/*   ATED AND NON-TAPE,NON-DA THIS ROUTINE DECIDES WHETHER TO       */
*/*   WAIT OR FAIL THE REQUEST. IF THE UNIT IS NOT ALLOCATED, AND    */
*/*   IF THE REQUEST IS SPECIFIC OR NON-TAPE/NON-DA, IEFAB434        */
*/*   IS INVOKED TO ALLOCATE IT                                      */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     UWAITSW - OK TO WAIT FOR UNITS                               */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - IF THE UCB IS ALLOCATED,THE REQUEST IS MARKED FOR  */
*/*               RECOVERY. IF THE UCB IS NOT ALLOCATED,THE REQUEST  */
*/*               IS ALLOCATED BY IEFAB434.                          */
*/*                                                                  */
*/*   OUTPUT - VOLUNIT MARKED IF RECOVERY. REQUEST MARKED ALLOCATED  */
*/*            AND COUNTS DECREMENTED IF ALLOCATED                   */
*/*                                                                  */
*/*   RETURN CODE - 0 IN RTNCODE                                     */
*/*                                                                  */
*/* EXIT - ERROR - INLINE SUBROUTINE                                 */
*/*                                                                  */
*/*   CONDITION - AN ERROR WHICH CAUSES THE ALLOCATION TO FAIL       */
*/*               HAS BEEN DETECTED                                  */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*                                                                  */
*/*     A REASON CODE IS PUT IN FIELD SIOTRSNC OF THE SIOT. THE      */
*/*                                                                  */
*/*       0056 - ALLOCATION CAN'T WAIT FOR VOLUMES TO BE MOUNTED     */
*/*       0059 - ALLOCATION CAN'T WAIT FOR ALLOCATED UNITS           */
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/********************************************************************/
*IF UCBALOC=ON THEN                     /*IS DEVICE ALLOCATED        */
         L     @10,UCBPTR                                       03S0101
         TM    UCBALOC(@10),B'00001000'                         03S0101
         BNO   @RF00101                                         03S0101
*  DO;                                  /*YES                        */
*    IF UCB3TAPE=ON × UCB3DACC=ON THEN  /*IS UNIT TAPE OR DA         */
         TM    UCB3TAPE(@10),B'10100000'                        03S0103
         BZ    @RF00103                                         03S0103
*      DO;                              /*YES                        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DATPALOC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PROCESS REQUESTS TO ALLOCATED TAPES AND DA    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT DETERMINES IF THE REQUEST CAN BE 1) ALLOCATED     */
*/*   TO AN ALLOCATED DA UNIT(PUBLIC NON-SPECIFIC REQUEST TO A       */
*/*   SHAREABLE DA DEVICE) OR 2) WAIT FOR THE UNIT TO BE UNALLOCATED.*/
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   IF THE REQUEST IS PUBLIC NON-SPECIFIC TO A SHAREABLE DA DEVICE */
*/*   A FLAG IS SET TO PROCESS THIS REQUEST ON THE SECOND SCAN OF THE*/
*/*   SIOTS. ALL OTHER REQUESTS MUST WAIT FOR THE UNIT TO BE UNALLOC-*/
*/*   ATED,IF VOLUME MOUNTING AND WAITING FOR UNITS IS ALLOWED.      */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     VOLMNTSW - ALLOW VOLUME MOUNTING                             */
*/*     UWAITSW - ALLOW WAITING FOR UNITS                            */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - DEMAND REQUEST TO AN ALLOCATED UNIT MARKED FOR     */
*/*               RECOVERY.                                          */
*/*                                                                  */
*/*   OUTPUT - THIS REQUEST AND ALL OTHER REQUESTS IN THIS STEP      */
*/*            ASKING FOR THE DEMANDED UNIT HAVE THEIR VOLUNIT       */
*/*            ENTRIES MARKED(VUDNALOC=ON)                           */
*/*                                                                  */
*/*   RETURN CODE - 0 IN RTNCODE                                     */
*/*                                                                  */
*/* EXIT - ERROR - INLINE SUBROUTINE                                 */
*/*                                                                  */
*/*   CONDITION - AN ERROR WHICH CAUSES THE ALLOCATION TO FAIL HAS   */
*/*               BEEN DETECTED                                      */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*   A REASON CODE IS PUT IN FIELD SIOTRSNC OF THE SIOT. THE        */
*/*   POSSIBLE REASON CODES ARE AS FOLLOWS:                          */
*/*                                                                  */
*/*     0056 - ALLOCATION CAN'T MOUNT VOLUMES                        */
*/*                                                                  */
*/*     0059 - ALLOCATION CAN'T WAIT FOR ALLOCATED UNITS             */
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/********************************************************************/
*IF VOLPUB=ON & VOLSPEC=OFF &          /*IS REQUEST PUBLIC NON-SPEC. */
*    (UCBBPUB=ON × UCBBSTR=ON) &       /*AND VOL OR PUBLIC      04S0105
*                                        OR STORAGE          @YM05583*/
*    (UCB3DACC=ON &                    /*AND VOL IS SHARABLE @YM05583*/
*     UCBBSVL=OFF) &^ (UCBMOUNT = ON & UCBVOLI = VOLSER0) THEN/*
*                                        AND NOT ALLOC'D, SCRATCH
*                                        VOL MOUNT PENDING           */
         L     @02,VUPTR                                        04S0105
         TM    VOLPUB(@02),B'10000000'                          04S0105
         BNO   @RF00105                                         04S0105
         TM    VOLSPEC(@02),B'00100000'                         04S0105
         BNZ   @RF00105                                         04S0105
         TM    UCBBPUB(@10),B'00001100'                         04S0105
         BZ    @RF00105                                         04S0105
         TM    UCB3DACC(@10),B'00100000'                        04S0105
         BNO   @RF00105                                         04S0105
         TM    UCBBSVL(@10),B'10000000'                         04S0105
         BNZ   @RF00105                                         04S0105
         TM    UCBMOUNT(@10),B'10000000'                        04S0105
         BNO   @RT00105                                         04S0105
         CLC   UCBVOLI(6,@10),VOLSER0                           04S0105
         BE    @RF00105                                         04S0105
@RT00105 DS    0H                                               04S0106
*  DO;                                 /*YES                         */
*    NSPCMNT=ON;                       /*INDICATE NON-SPECIFIC RTN   */
         OI    NSPCMNT,B'10000000'                              04S0107
*  END;                                                         04S0108
*ELSE                                  /*NOT PUBLIC NON-SPECIFIC REQ */
*  IF UCBPRES=ON × UCBRESV=ON THEN     /*FIXED DEVICE?       @YM05583*/
         B     @RC00105                                         04S0109
@RF00105 L     @10,UCBPTR                                       04S0109
         TM    UCBPRES(@10),B'00100100'                         04S0109
         BZ    @RF00109                                         04S0109
*    DO;                               /*YES, FAIL           @YM05583*/
*      RTNCODE = FAILURE;              /*SET RETURN CODE     @YM05583*/
         LA    RTNCODE,4                                        04S0111
*      SIOTRSNC = PMRSRSVD;            /*SET REASON CODE     @YM05583*/
         L     @10,SIOTPTR                                      04S0112
         MVC   SIOTRSNC(2,@10),@CH00134                         04S0112
*    END;                                                       04S0113
*  ELSE                                /*NOT FIXED DEVICE    @YM05583*/
*    DO;                               /* TO SHAREABLE PUBLIC VOLUME */
         B     @RC00109                                         04S0114
@RF00109 DS    0H                                               04S0115
*      IF VOLMNTSW=OFF THEN            /*IS MOUNTING ALLOWED?        */
         L     @10,@PC00001                                     04S0115
         L     @10,ALCWAPTR(,@10)                               04S0115
         L     @10,FMAPPTR(,@10)                                04S0115
         TM    VOLMNTSW(@10),B'10000000'                        04S0115
         BNZ   @RF00115                                         04S0115
*        DO;                           /*NO                          */
*          RTNCODE=FAILURE;            /*SET RETURN CODE             */
         LA    RTNCODE,4                                        04S0117
*          SIOTRSNC=NOMNTING;          /*SET SIOT REASON CODE        */
         L     @10,SIOTPTR                                      04S0118
         MVC   SIOTRSNC(2,@10),@CH00126                         04S0118
*        END;                                                   04S0119
*      ELSE                            /*MOUNTING ALLOWED            */
*        IF UWAITSW=OFF THEN           /*IS WAITING FOR UNITS OK?    */
         B     @RC00115                                         04S0120
@RF00115 L     @10,@PC00001                                     04S0120
         L     @10,ALCWAPTR(,@10)                               04S0120
         L     @10,FMAPPTR(,@10)                                04S0120
         TM    UWAITSW(@10),B'00100000'                         04S0120
         BNZ   @RF00120                                         04S0120
*          DO;                         /*NO                          */
*            RTNCODE=FAILURE;          /*SET RETURN CODE             */
         LA    RTNCODE,4                                        04S0122
*            SIOTRSNC=NOWATING;        /*SET SIOT REASON CODE        */
         L     @10,SIOTPTR                                      04S0123
         MVC   SIOTRSNC(2,@10),@CH00128                         04S0123
*          END;                                                 04S0124
*        ELSE                           /*MOUNTING AND WAITING OK    */
*          DO;                                                  04S0125
         B     @RC00120                                         04S0125
@RF00120 DS    0H                                               04S0126
*            VUPTR=SVOLUNAD;            /*POINT TO VOLUNIT TABLE     */
         L     @10,SIOTPTR                                      04S0126
         MVC   VUPTR(4),SVOLUNAD(@10)                           04S0126
*            CALL MARKVUS;               /*INDICATE RECOVERY IN VOLUN *
         BAL   @14,MARKVUS                                      04S0127
*          END;                                                 04S0128
*    END;                                                       04S0129
*      END;                                                     03S0130
*    ELSE                               /*NOT TAPE OR DA             */
*      DO;                                                      03S0131
         B     @RC00103                                         03S0131
@RF00103 DS    0H                                               03S0132
*        VUPTR=SVOLUNAD;                                        03S0132
         L     @10,SIOTPTR                                      03S0132
         MVC   VUPTR(4),SVOLUNAD(@10)                           03S0132
*          IF UWAITSW=OFF THEN          /*CAN WAIT FOR UNITS?        */
         L     @02,@PC00001                                     03S0133
         L     @02,ALCWAPTR(,@02)                               03S0133
         L     @02,FMAPPTR(,@02)                                03S0133
         TM    UWAITSW(@02),B'00100000'                         03S0133
         BNZ   @RF00133                                         03S0133
*            DO;                                                03S0134
*              RTNCODE=FAILURE;         /*SET RETURN CODE            */
         LA    RTNCODE,4                                        03S0135
*              SIOTRSNC=NOWATING;       /*SET SIOT REASON CODE       */
         MVC   SIOTRSNC(2,@10),@CH00128                         03S0136
*            END;                                               03S0137
*          ELSE                         /*WAITING ALLOWED            */
*            CALL MARKVUS;              /*INDICATE RECOVERY IN VUTAB */
         B     @RC00133                                         03S0138
@RF00133 BAL   @14,MARKVUS                                      03S0138
*      END;                                                     03S0139
*  END;                                                         03S0140
*ELSE                                   /*UNIT NOT ALLOCATED         */
*  DO;                                                          03S0141
         B     @RC00101                                         03S0141
@RF00101 DS    0H                                               03S0142
*    VUPTR=SVOLUNAD;                    /*POINT TO SIOTS VOLUN ENTRY */
         L     @10,SIOTPTR                                      03S0142
         L     @10,SVOLUNAD(,@10)                               03S0142
         ST    @10,VUPTR                                        03S0142
*    IF (VOLSPEC=ON × VOLPRV=ON ×       /*SPECIFIC OR PRIVATE REQUEST*/
*       (UCB3DACC=OFF & UCB3TAPE=OFF))  /*OR NON-TAPE,NON-DA REQ     */
*        × INDWAIT=ON THEN              /*OR WAIT-HOLDING-RESOURCES  */
         TM    VOLSPEC(@10),B'01100000'                         03S0143
         BNZ   @RT00143                                         03S0143
         L     @10,UCBPTR                                       03S0143
         TM    UCB3DACC(@10),B'10100000'                        03S0143
         BZ    @RT00143                                         03S0143
         L     @10,@PC00001                                     03S0143
         L     @10,ALCWAPTR(,@10)                               03S0143
         TM    INDWAIT(@10),B'10000000'                         03S0143
         BNO   @RF00143                                         03S0143
@RT00143 DS    0H                                               03S0144
*      DO;                              /*YES                        */
*        IF (UCB3DACC = ON × UCB3TAPE = ON) & /*TAPE OR D.A. ?       */
*           VOLMNTSW = OFF THEN         /*VOLUME MOUNTING ALLOWED    */
         L     @10,UCBPTR                                       03S0145
         TM    UCB3DACC(@10),B'10100000'                        03S0145
         BZ    @RF00145                                         03S0145
         L     @10,@PC00001                                     03S0145
         L     @10,ALCWAPTR(,@10)                               03S0145
         L     @10,FMAPPTR(,@10)                                03S0145
         TM    VOLMNTSW(@10),B'10000000'                        03S0145
         BNZ   @RF00145                                         03S0145
*          DO;                                                  03S0146
*            RTNCODE = FAILURE;         /*FAIL REQUEST               */
         LA    RTNCODE,4                                        03S0147
*            SIOTRSNC = NOMNTING;       /*NO MOUNTING ALLOWED        */
         L     @10,SIOTPTR                                      03S0148
         MVC   SIOTRSNC(2,@10),@CH00126                         03S0148
*          END;                                                 03S0149
*        ELSE                           /*MNTING ALOWED OR NONTAPE/DA*/
*          DO;                                                  03S0150
         B     @RC00145                                         03S0150
@RF00145 DS    0H                                               03S0151
*            INDFLAGS=INDFLAGS && INDFLAGS; /*ZERO BIT SETTINGS      */
         XC    INDFLAGS(4),INDFLAGS                             03S0151
*            IF SIOTETIO ^= ZERO THEN   /*DOES ETIOT EXIST ?         */
         L     @10,SIOTPTR                                      03S0152
         ICM   @15,15,SIOTETIO(@10)                             03S0152
         BZ    @RF00152                                         03S0152
*              ETIOFLAG=ON;             /*YES, ONLY UPDATE IT        */
         OI    ETIOFLAG,B'10000000'                             03S0153
*            VOLUMEID=VOLID;            /*INDICATE TO 434 WRONG VOL  */
@RF00152 L     @10,VUPTR                                        03S0154
         MVC   VOLUMEID(6),VOLID(@10)                           03S0154
*            UCBDATAP=ADDR(UCBDATA);                            03S0155
         LA    @10,UCBDATA                                      03S0155
         ST    @10,UCBDATAP                                     03S0155
*            IF UCB3DACC=ON THEN        /*DA REQUEST?                */
         L     @10,UCBPTR                                       03S0156
         TM    UCB3DACC(@10),B'00100000'                        03S0156
         BNO   @RF00156                                         03S0156
*              USEFLAG=ON;              /*UPDATE USE COUNT           */
         OI    USEFLAG,B'01000000'                              03S0157
*            IF VOLSPEC=ON THEN         /*SPECIFIC REQUEST?          */
@RF00156 L     @10,VUPTR                                        03S0158
         TM    VOLSPEC(@10),B'00100000'                         03S0158
         BNO   @RF00158                                         03S0158
*              VLDFLAG=ON;              /*YES,VALIDITY CHECK         */
         OI    VLDFLAG,B'00010000'                              03S0159
*            USEATFLG=ON;               /*NO,UPDATE USE ATTRIB       */
@RF00158 OI    USEATFLG,B'00001000'                             03S0160
*            IF WHOLEGEN = ON THEN      /*IS VOL SWITCHING OK        */
         L     @10,@PC00001+4                                   03S0161
         TM    WHOLEGEN(@10),B'01000000'                        03S0161
         BNO   @RF00161                                         03S0161
*              VOLSWOK=ON;              /*VOLUME SWITCHING OK        */
         OI    VOLSWOK,B'00000010'                              03S0162
*            AFFFLAG=ON;                /*PROCESS AFFINITIES         */
@RF00161 DS    0H                                               03S0164
*            UPDALGTB=ON;               /*UPDATE ALGORITHM TABLES    */
         OI    AFFFLAG,B'00100100'                              03S0164
*            GROUPID=EDLFGENP->EDLGRPTR->EDLGRID; /*SET GROUP ID     */
         L     @10,SIOTPTR                                      03S0165
         L     @10,SIOTEDLP(,@10)                               03S0165
         L     @10,EDLFGENP(,@10)                               03S0165
         L     @10,EDLGRPTR(,@10)                               03S0165
         MVC   GROUPID(4),EDLGRID(@10)                          03S0165
*            CALL IEFAB434(SIOTPTR,VUPTR,UCBPTR,                03S0166
*              INDFLAGS,ETIODATA,ALCWAPTR,GROUPID,UCBDATAP);    03S0166
         LA    @10,SIOTPTR                                      03S0166
         ST    @10,@AL00001                                     03S0166
         LA    @10,VUPTR                                        03S0166
         ST    @10,@AL00001+4                                   03S0166
         LA    @10,UCBPTR                                       03S0166
         ST    @10,@AL00001+8                                   03S0166
         LA    @10,INDFLAGS                                     03S0166
         ST    @10,@AL00001+12                                  03S0166
         LA    @10,ETIODATA                                     03S0166
         ST    @10,@AL00001+16                                  03S0166
         L     @10,@PC00001                                     03S0166
         ST    @10,@AL00001+20                                  03S0166
         LA    @10,GROUPID                                      03S0166
         ST    @10,@AL00001+24                                  03S0166
         LA    @10,UCBDATAP                                     03S0166
         ST    @10,@AL00001+28                                  03S0166
         L     @15,@CV00154                                     03S0166
         LA    @01,@AL00001                                     03S0166
         BALR  @14,@15                                          03S0166
*                                       /*CALL IEFAB434              */
*            RTNCODE=REG15;             /*SAVE RETURN CODE           */
         LR    RTNCODE,REG15                                    03S0167
*            IF RTNCODE=SUCCESS × RTNCODE=RET40 THEN /*ALLOC    03S0168
*                                         SUCCESSFUL ?               */
         LTR   RTNCODE,RTNCODE                                  03S0168
         BZ    @RT00168                                         03S0168
         CH    RTNCODE,@CH00142                                 03S0168
         BNE   @RF00168                                         03S0168
@RT00168 DS    0H                                               03S0169
*              DO;                      /*YES                        */
*                VOLALOC=ON;            /*MARK VU ALLOCATED          */
         L     @10,VUPTR                                        03S0170
         OI    VOLALOC(@10),B'10000000'                         03S0170
*                TOTVOLUN=TOTVOLUN-ONE; /*DECREMENT VOLUN COUNT      */
         L     @10,@PC00001                                     03S0171
         L     @10,ALCWAPTR(,@10)                               03S0171
         L     @02,TOTVOLUN(,@10)                               03S0171
         BCTR  @02,0                                            03S0171
         ST    @02,TOTVOLUN(,@10)                               03S0171
*                IF SIOTALCD = OFF THEN /*SIOT NOT YET ALLOC'D?      */
         L     @02,SIOTPTR                                      03S0172
         TM    SIOTALCD(@02),B'00000010'                        03S0172
         BNZ   @RF00172                                         03S0172
*                  DO;                  /*YES, COUNT AS ALLOCATED    */
*                    SIOTALCD=ON;       /*MARK SIOT ALLOCATED        */
         OI    SIOTALCD(@02),B'00000010'                        03S0174
*                    TOTREQS=TOTREQS-ONE; /*DECREMENT SIOT COUNT     */
         L     @02,TOTREQS(,@10)                                03S0175
         BCTR  @02,0                                            03S0175
         ST    @02,TOTREQS(,@10)                                03S0175
*                  END;                                         03S0176
*                ELSE;                  /*SIOT ALREADY MARKED ALLOC'D*/
@RF00172 DS    0H                                               03S0178
*                IF VOLSPEC=ON THEN     /*SPECIFIC REQUEST?          */
         L     @10,VUPTR                                        03S0178
         TM    VOLSPEC(@10),B'00100000'                         03S0178
         BNO   @RF00178                                         03S0178
*                  SPECREQS=SPECREQS-ONE; /*DECREMENT SPECIFIC COUNT */
         L     @10,@PC00001                                     03S0179
         L     @10,ALCWAPTR(,@10)                               03S0179
         L     @02,SPECREQS(,@10)                               03S0179
         BCTR  @02,0                                            03S0179
         ST    @02,SPECREQS(,@10)                               03S0179
*              END;                                             03S0180
*            ELSE;                      /*ALLOCATION NOT SUCCESSFUL  */
@RF00168 DS    0H                                               03S0182
*            IF RTNCODE=RET28 × RTNCODE=RET40 THEN              03S0182
@RC00168 CH    RTNCODE,@CH00137                                 03S0182
         BE    @RT00182                                         03S0182
         CH    RTNCODE,@CH00142                                 03S0182
         BNE   @RF00182                                         03S0182
@RT00182 DS    0H                                               03S0183
*                                       /*THESE RTNCODES MEAN CONTINUE
*                                         PROCESSING                 */
*              RTNCODE=SUCCESS;                                 03S0183
         SLR   RTNCODE,RTNCODE                                  03S0183
*              IF RTNCODE = RET24 THEN  /*TAPE VOL SWITCH NEEDED?    */
@RF00182 CH    RTNCODE,@CH00108                                 03S0184
         BNE   @RF00184                                         03S0184
*                DO;                    /*YES, INDICATE UCB NOT ELIG-
*                                        IBLE TO OTHER REQS          */
*                  RTNCODE = SUCCESS;                           03S0186
         SLR   RTNCODE,RTNCODE                                  03S0186
*                  WAITIGEN = ON;                               03S0187
         L     @10,@PC00001                                     03S0187
         L     @10,ALCWAPTR(,@10)                               03S0187
         OI    WAITIGEN(@10),B'01000000'                        03S0187
*                  VOLALGTP->CVRWUCBP = UCBPTR;                 03S0188
         L     @10,VUPTR                                        03S0188
         L     @10,VOLALGTP(,@10)                               03S0188
         MVC   CVRWUCBP(2,@10),UCBPTR+2                         03S0188
*                END;                                           03S0189
*          END;                                                 03S0190
*      END;                                                     03S0191
*    ELSE                               /*PUBLIC NON-SPECIFIC REQ    */
*      DO;                                                      03S0192
         B     @RC00143                                         03S0192
@RF00143 DS    0H                                               03S0193
*        NSPCMNT=ON;                    /*INDICAT NON-SPEC RTN NEEDED*/
         OI    NSPCMNT,B'10000000'                              03S0193
*      END;                                                     03S0194
*  END;                                                         03S0195
*              END;                                             02S0196
*          END;                                                 02S0197
*    END;                                                       02S0198
*  ELSE;                                /*ALLOC'D OR INELIGIBLE SIOT */
@RF00063 DS    0H                                               02S0200
*  SIOTPTR=SIOTNPTR;                    /*POINT TO NEXT SIOT         */
@RC00063 L     @10,SIOTPTR                                      02S0200
         L     @10,SIOTNPTR(,@10)                               02S0200
         ST    @10,SIOTPTR                                      02S0200
*END;                                                           02S0201
@DE00061 SLR   @10,@10                                          02S0201
         C     @10,SIOTPTR                                      02S0201
         BE    @DC00061                                         02S0201
         CR    RTNCODE,@10                                      02S0201
         BE    @DL00061                                         02S0201
@DC00061 DS    0H                                               02S0202
*                                       /*RECOVERY AND ERROR SITUA-  */
*                                       /*TIONS AND ALSO ALLOCATE    */
*                                       /*SPECIFICS TO NON-MOUNTEDS, */
*                                       /*PVT NON-SPFCS,NON-TAPE/DA  */
*  END;                                                         01S0202
*IF RTNCODE=SUCCESS & NSPCMNT=ON THEN   /*ANY NON-SPEC PUBLICS LEFT? */
@RF00058 LTR   RTNCODE,RTNCODE                                  01S0203
         BNZ   @RF00203                                         01S0203
         TM    NSPCMNT,B'10000000'                              01S0203
         BNO   @RF00203                                         01S0203
*  DO;                                  /*YES                        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SECNDSCN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SECOND SCAN OF SIOTS                          */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT SCANS THE SIOTS LOOKING FOR DEMAND REQUESTS       */
*/*   ELIGIBLE TO THIS GENERIC WHICH ARE STILL UNALLOCATED OR        */
*/*   AREN'T MARKED FOR RECOVERY. IF A VOLUME ENQ IS NECESSARY,      */
*/*   IEFAB4F0 IS CALLED TO DO THE ENQ. AFTER THE ENQ,IEFAB434       */
*/*   (ALLOCATE REQUEST TO UNIT) IS CALLED TO ALLOCATE THE REQUEST   */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   THE OPERATION IS DOCUMENTED BY THE CODE.                       */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     SIOT1P - PTR TO FIRST SIOT                                   */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - ALL DEMAND REQUESTS ELIGIBLE TO THIS GENERIC ARE   */
*/*               ALLOCATED OR MARKED FOR RECOVERY.                  */
*/*                                                                  */
*/*   OUTPUT - REQUESTS MARKED ALLOCATED OR RECOVERY. IF ALLOCATED,  */
*/*            COUNTS OF REQUESTS STILL TO BE ALLOCATED ARE DECRE-   */
*/*            MENTED                                                */
*/*                                                                  */
*/*   RETURN CODE - 0 IN RTNCODE                                     */
*/*                                                                  */
*/* EXIT - ERROR - INLINE SUBROUTINE                                 */
*/*                                                                  */
*/*   CONDITION - AN ERROR WHICH CAUSES THE ALLOCATION TO FAIL HAS   */
*/*               BEEN DETECTED BY IEFAB434.                         */
*/*                                                                  */
*/*   OUTPUT - SEE PROLOGUE OF IEFAB434 FOR POSSIBLE FAILING RETURN  */
*/*            CODES.                                                */
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/*   CONDITION - AN ERROR WHICH CAUSES THE ALLOCATION TO FAIL HAS   */
*/*               BEEN DETECTED BY THIS SEGMENT                      */
*/*                                                                  */
*/*   OUTPUT - ONE OF THE FOLLOWING REASON CODES IS PUT IN FIELD     */
*/*            SIOTRSNC IN THE SIOT =                                */
*/*              0056 - ALLOCATION CAN'T MOUNT VOLUMES               */
*/*              0059 - ALLOCATION CAN'T WAIT FOR ALLOCATED UNITS    */
*/*              0066 - PERMRES VOLUME IS ALLOCATED AND      @YM05583*/
*/*                     MOUNT PENDING FOR ANOTHER JOB        @YM05583*/
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/********************************************************************/
*SIOTPTR=SIOT1P;                                                02S0205
         L     @10,@PC00001                                     02S0205
         L     @10,ALCWAPTR(,@10)                               02S0205
         MVC   SIOTPTR(4),SIOT1P(@10)                           02S0205
*REPROCES=OFF;                          /*INITIALIZE REPROCESS SW    */
         NI    REPROCES,B'01111111'                             02S0206
*DO WHILE SIOTPTR^=ZERO & RTNCODE=SUCCESS; /*SCAN SIOTS              */
         B     @DE00207                                         02S0207
@DL00207 DS    0H                                               02S0208
*  IF SIOTALCD=NO & SIOTGIGN=OFF THEN   /*UNALLOC'D ELIGIBLE SIOT?   */
         L     @10,SIOTPTR                                      02S0208
         TM    SIOTALCD(@10),B'00000010'                        02S0208
         BNZ   @RF00208                                         02S0208
         TM    SIOTGIGN(@10),B'00001000'                        02S0208
         BNZ   @RF00208                                         02S0208
*    DO;                                /*YES                        */
*      ERETCODE=ZERO;                   /*ZERO ENQ RETURN AREA       */
         SLR   ERETCODE,ERETCODE                                02S0210
*      VUPTR=SVOLUNAD;                  /*POINT TO VOLUNIT ENTRY     */
         L     @05,SVOLUNAD(,@10)                               02S0211
         ST    @05,VUPTR                                        02S0211
*      UCBPTR=SIOUCBAD;                 /*POINT TO UCB               */
         SLR   @02,@02                                          02S0212
         ICM   @02,7,SIOUCBAD(@10)                              02S0212
         ST    @02,UCBPTR                                       02S0212
*      IF VUDNALOC=OFF THEN             /*ENTRY MARKED FOR RECOVERY? */
         TM    VUDNALOC(@05),B'00001000'                        02S0213
         BNZ   @RF00213                                         02S0213
*        DO;                            /*NO                         */
*          FOMAP=FOMAP && FOMAP;        /*ZERO ENQ SWITCHES          */
         XC    FOMAP(1),FOMAP                                   02S0215
*          IF UCB3TAPE=ON & UCBBPRV=OFF & /*TAPE ENQ NEEDED?         */
*             UCBMONT = OFF &          /*NO PASSED DATA SET ON  02S0216
*                                        VOLUME              @ZA02721*/
*             (UCBVOLI(1)^=FF & UCBVOLI^= VOLSER0) & UCBMOUNT=OFF &
*              (UCBBPUB=ON × UCBBSTR=ON) THEN                   02S0216
         TM    UCB3TAPE(@02),B'10000000'                        02S0216
         BNO   @RF00216                                         02S0216
         TM    UCBBPRV(@02),B'00010000'                         02S0216
         BNZ   @RF00216                                         02S0216
         TM    UCBMONT(@02),B'00000001'                         02S0216
         BNZ   @RF00216                                         02S0216
         CLI   UCBVOLI(@02),X'FF'                               02S0216
         BE    @RF00216                                         02S0216
         CLC   UCBVOLI(6,@02),VOLSER0                           02S0216
         BE    @RF00216                                         02S0216
         TM    UCBMOUNT(@02),B'10000000'                        02S0216
         BNZ   @RF00216                                         02S0216
         TM    UCBBPUB(@02),B'00001100'                         02S0216
         BZ    @RF00216                                         02S0216
*            DO;                                                02S0217
*              VOLEXCLU=ON;             /*EXCLUSIVE ENQ              */
*              VOLUMENQ=ON;             /*ENQ                        */
         OI    VOLEXCLU,B'10100000'                             02S0219
*            END;                                               02S0220
*          ELSE                                                 02S0221
*            IF UCB3DACC=ON & UCBBPRV=OFF & /*DA ENQ NEEDED?         */
*               UCBRESV=OFF & UCBPRES=OFF & /*               @YM05583*/
*               UCBVOLI^=VOLSER0 & UCBMOUNT=OFF &               02S0221
*              (UCBBPUB=ON × UCBBSTR=ON) THEN                   02S0221
         B     @RC00216                                         02S0221
@RF00216 L     @10,UCBPTR                                       02S0221
         TM    UCB3DACC(@10),B'00100000'                        02S0221
         BNO   @RF00221                                         02S0221
         TM    UCBBPRV(@10),B'00010000'                         02S0221
         BNZ   @RF00221                                         02S0221
         TM    UCBRESV(@10),B'00100100'                         02S0221
         BNZ   @RF00221                                         02S0221
         CLC   UCBVOLI(6,@10),VOLSER0                           02S0221
         BE    @RF00221                                         02S0221
         TM    UCBMOUNT(@10),B'10000000'                        02S0221
         BNZ   @RF00221                                         02S0221
         TM    UCBBPUB(@10),B'00001100'                         02S0221
         BZ    @RF00221                                         02S0221
*              DO;                      /*YES                        */
*                VOLUMENQ=ON;           /*ENQ                        */
*                VOLEXCLU=OFF;          /*NOT EXCLUSIVE ENQ          */
         OI    VOLUMENQ,B'10000000'                             02S0224
         NI    VOLEXCLU,B'11011111'                             02S0224
*              END;                                             02S0225
*          IF VOLUMENQ=ON & REPROCES=OFF THEN /*ENQ?                 */
@RF00221 DS    0H                                               02S0226
@RC00216 TM    VOLUMENQ,B'10000000'                             02S0226
         BNO   @RF00226                                         02S0226
         TM    REPROCES,B'10000000'                             02S0226
         BNZ   @RF00226                                         02S0226
*            DO;                                                02S0227
*              VOLSERP=ADDR(UCBVOLI);   /*VOLSER PTR                 */
         L     @10,UCBPTR                                       02S0228
         LA    @10,UCBVOLI(,@10)                                02S0228
         ST    @10,VOLSERP                                      02S0228
*              TCBADD=JSCBPTR->JSCBTCBP; /*TCP PTR                   */
         L     @10,@PC00001                                     02S0229
         L     @10,ALCWAPTR(,@10)                               02S0229
         L     @05,JSCBPTR(,@10)                                02S0229
         MVC   TCBADD(4),JSCBTCBP(@05)                          02S0229
*              CALL IEFAB4F0 (FOMAP,VOLSERP,TCBADD,VOLUNPTR,VOLUNSZE);
         LA    @05,FOMAP                                        02S0230
         ST    @05,@AL00001                                     02S0230
         LA    @05,VOLSERP                                      02S0230
         ST    @05,@AL00001+4                                   02S0230
         LA    @05,TCBADD                                       02S0230
         ST    @05,@AL00001+8                                   02S0230
         LA    @05,VOLUNPTR(,@10)                               02S0230
         ST    @05,@AL00001+12                                  02S0230
         LA    @10,VOLUNSZE(,@10)                               02S0230
         ST    @10,@AL00001+16                                  02S0230
         L     @15,@CV00152                                     02S0230
         LA    @01,@AL00001                                     02S0230
         BALR  @14,@15                                          02S0230
*                                       /*CALL ENQ                   */
*              ERETCODE=REG15;          /*SAVE RETURN CODE           */
         LR    ERETCODE,REG15                                   02S0231
*              IF ERETCODE=ZERO THEN    /*ENQ SUCCESSFUL?            */
         LTR   ERETCODE,ERETCODE                                02S0232
         BNZ   @RF00232                                         02S0232
*                VOLUMEID=UCBVOLI;      /*YES,INDIC TO 434 VOL OK    */
         L     @10,UCBPTR                                       02S0233
         MVC   VOLUMEID(6),UCBVOLI(@10)                         02S0233
*              ELSE                                             02S0234
*                IF ERETCODE=JOBOWNS THEN /*ALREADY OWN VOLUME       */
         B     @RC00232                                         02S0234
@RF00232 CH    ERETCODE,@CH00057                                02S0234
         BNE   @RF00234                                         02S0234
*                  DO;                  /*YES                        */
*                    ERETCODE=ZERO;                             02S0236
         SLR   ERETCODE,ERETCODE                                02S0236
*                    VOLUMENQ=OFF;      /*CANCEL 'DEQ IF DADSM ERROR'*/
         NI    VOLUMENQ,B'01111111'                             02S0237
*                    VOLUMEID=UCBVOLI;  /*INDIC TO 434 VOL OK        */
         L     @10,UCBPTR                                       02S0238
         MVC   VOLUMEID(6),UCBVOLI(@10)                         02S0238
*                  END;                                         02S0239
*                ELSE                   /*ENQ UNSUCCESSFUL           */
*                  DO;                                          02S0240
         B     @RC00234                                         02S0240
@RF00234 DS    0H                                               02S0241
*                    IF VOLMNTSW = OFF THEN /*NO VOL MOUNTING ALLOWED*/
         L     @10,@PC00001                                     02S0241
         L     @10,ALCWAPTR(,@10)                               02S0241
         L     @10,FMAPPTR(,@10)                                02S0241
         TM    VOLMNTSW(@10),B'10000000'                        02S0241
         BNZ   @RF00241                                         02S0241
*                      DO;                                      02S0242
*                        RTNCODE = FAILURE; /*FAIL THIS REQUEST      */
         LA    RTNCODE,4                                        02S0243
*                        SIOTRSNC = NOMNTING; /*NO MOUNTING ALLOWED  */
         L     @10,SIOTPTR                                      02S0244
         MVC   SIOTRSNC(2,@10),@CH00126                         02S0244
*                      END;                                     02S0245
*                    ELSE                /*VOLUME MOUNTING ALLOWED   */
*                      DO;                                      02S0246
         B     @RC00241                                         02S0246
@RF00241 DS    0H                                               02S0247
*                        IF UCBALOC=OFF THEN /*IS UNIT UNALLOCATED   */
         L     @10,UCBPTR                                       02S0247
         TM    UCBALOC(@10),B'00001000'                         02S0247
         BNZ   @RF00247                                         02S0247
*                          DO;                                  02S0248
*                            VOLUMEID=VOLID; /*INDI TO 434 VOL NOT OK*/
         L     @10,VUPTR                                        02S0249
         MVC   VOLUMEID(6),VOLID(@10)                           02S0249
*                            ERETCODE=ZERO;                     02S0250
         SLR   ERETCODE,ERETCODE                                02S0250
*                          END;                                 02S0251
*                        ELSE           /*UCB ALLOCATED              */
*                          DO;                                  02S0252
         B     @RC00247                                         02S0252
@RF00247 DS    0H                                               02S0253
*                            IF UWAITSW=OFF THEN /*WAIT FOR UNITS?   */
         L     @10,@PC00001                                     02S0253
         L     @10,ALCWAPTR(,@10)                               02S0253
         L     @10,FMAPPTR(,@10)                                02S0253
         TM    UWAITSW(@10),B'00100000'                         02S0253
         BNZ   @RF00253                                         02S0253
*                              DO;      /*NO                         */
*                                RTNCODE=FAILURE; /*SET FAILURE RTN  */
         LA    RTNCODE,4                                        02S0255
*                                SIOTRSNC=NOWATING; /*SET REASON CODE*/
         L     @10,SIOTPTR                                      02S0256
         MVC   SIOTRSNC(2,@10),@CH00128                         02S0256
*                              END;                             02S0257
*                            ELSE       /*WAITING OK                 */
*                              DO;                              02S0258
         B     @RC00253                                         02S0258
@RF00253 DS    0H                                               02S0259
*                               EDLFGENP->EDLGRPTR->            02S0259
*                               EDLLISTP->EDLENQ(1)=ON;         02S0259
         L     @10,SIOTPTR                                      02S0259
         L     @10,SIOTEDLP(,@10)                               02S0259
         L     @10,EDLFGENP(,@10)                               02S0259
         L     @10,EDLGRPTR(,@10)                               02S0259
         L     @10,EDLLISTP(,@10)                               02S0259
         OI    EDLENQ(@10),B'00100000'                          02S0259
*                                       /*FAILED BIT ON FOR RECOVERY */
*                               CALL MARKVUS;                   02S0260
         BAL   @14,MARKVUS                                      02S0260
*                              END;                             02S0261
*                          END;                                 02S0262
*                     END;                                      02S0263
*                 END;                                          02S0264
*            END;                                               02S0265
*          ELSE                         /*NO ENQ NEEDED              */
*            DO;                                                02S0266
         B     @RC00226                                         02S0266
@RF00226 DS    0H                                               02S0267
*              IF (UCBRESV=OFF & UCBPRES=OFF) /*IF VOL NOT RESVD OR
*                                         PERMRES            @YM05583*/
*                 × (UCBPRES=ON & UCBALOC=OFF /*OR PERMRES WITH 02S0267
*                                         NO VOL MOUNTE      @YM05583*/
*                 & (UCBMOUNT=ON × UCBVOLI=VOLSER0)) THEN /* @YM05583*/
         L     @10,UCBPTR                                       02S0267
         TM    UCBRESV(@10),B'00100100'                         02S0267
         BZ    @RT00267                                         02S0267
         L     @10,UCBPTR                                       02S0267
         TM    UCBPRES(@10),B'00000100'                         02S0267
         BNO   @RF00267                                         02S0267
         TM    UCBALOC(@10),B'00001000'                         02S0267
         BNZ   @RF00267                                         02S0267
         TM    UCBMOUNT(@10),B'10000000'                        02S0267
         BO    @RT00267                                         02S0267
         CLC   UCBVOLI(6,@10),VOLSER0                           02S0267
         BNE   @RF00267                                         02S0267
@RT00267 DS    0H                                               02S0268
*                DO;                                            02S0268
*                  IF (UCB3DACC = ON × UCB3TAPE = ON) & /*TAPE OR DA?*/
*                     VOLMNTSW = OFF THEN /*VOL MOUNTING NOT ALLOWED */
         L     @10,UCBPTR                                       02S0269
         TM    UCB3DACC(@10),B'10100000'                        02S0269
         BZ    @RF00269                                         02S0269
         L     @10,@PC00001                                     02S0269
         L     @10,ALCWAPTR(,@10)                               02S0269
         L     @10,FMAPPTR(,@10)                                02S0269
         TM    VOLMNTSW(@10),B'10000000'                        02S0269
         BNZ   @RF00269                                         02S0269
*                    DO;                                        02S0270
*                      RTNCODE = FAILURE; /*FAIL THIS REQUEST        */
         LA    RTNCODE,4                                        02S0271
*                      SIOTRSNC = NOMNTING; /*NO MOUNTING ALLOWED    */
         L     @10,SIOTPTR                                      02S0272
         MVC   SIOTRSNC(2,@10),@CH00126                         02S0272
*                    END;                                       02S0273
*                  ELSE                /*MNTING ALLOWED OR NON- 02S0274
*                                        TAPE/DA                     */
*                    VOLUMEID = VOLID; /*INDIC TO 434 VOL NOT OK     */
         B     @RC00269                                         02S0274
@RF00269 L     @10,VUPTR                                        02S0274
         MVC   VOLUMEID(6),VOLID(@10)                           02S0274
*                END;                                           02S0275
*              ELSE                     /*IF VOL IS FIXEDED THEN     */
*                VOLUMEID=UCBVOLI;      /*INDIC TO 434 VOL OK.       */
         B     @RC00267                                         02S0276
@RF00267 L     @10,UCBPTR                                       02S0276
         MVC   VOLUMEID(6),UCBVOLI(@10)                         02S0276
*              VOLUMENQ=OFF;            /*NO ENQ NEEDED              */
@RC00267 NI    VOLUMENQ,B'01111111'                             02S0277
*              REPROCES=OFF;            /*DON'T REPROCESS            */
         NI    REPROCES,B'01111111'                             02S0278
*            END;                                               02S0279
*          IF ERETCODE=ZERO &           /*VOLUME ENQ'D SUCCESSFULLY? */
*             RTNCODE = SUCCESS THEN    /*NO OTHER FAILURE           */
@RC00226 SLR   @10,@10                                          02S0280
         CR    ERETCODE,@10                                     02S0280
         BNE   @RF00280                                         02S0280
         CR    RTNCODE,@10                                      02S0280
         BNE   @RF00280                                         02S0280
*            DO;                        /*YES                        */
*              IF UCBMOUNT=ON & UCBALOC=ON THEN /*MOUNT PENDING      */
         L     @10,UCBPTR                                       02S0282
         TM    UCBMOUNT(@10),B'10000000'                        02S0282
         BNO   @RF00282                                         02S0282
         TM    UCBALOC(@10),B'00001000'                         02S0282
         BNO   @RF00282                                         02S0282
*                DO;                    /*YES                        */
*                  SAVSIOTP=SIOTPTR;    /*SAVE POINTER TO THIS SIOT  */
         L     SAVSIOTP,SIOTPTR                                 02S0284
*                  SIOTPTR=SIOT1P;      /*POINT TO FIRST SIOT        */
         L     @10,@PC00001                                     02S0285
         L     @10,ALCWAPTR(,@10)                               02S0285
         MVC   SIOTPTR(4),SIOT1P(@10)                           02S0285
*                  RECOVSW=ON;          /*RECOVERY NECESSARY         */
         OI    RECOVSW,B'10000000'                              02S0286
*                  DO WHILE SIOTPTR^=ZERO & RECOVSW=ON; /*SCAN SIOTS */
         B     @DE00287                                         02S0287
@DL00287 DS    0H                                               02S0288
*                    IF SIOTGIGN=OFF & SAVSIOTP->SIOUCBAD=SIOUCBAD &
*                      SIOTALCD=ON THEN /*ANOTHER REQ ALLOC TO UCB   */
         L     @10,SIOTPTR                                      02S0288
         TM    SIOTGIGN(@10),B'00001000'                        02S0288
         BNZ   @RF00288                                         02S0288
         CLC   SIOUCBAD(3,SAVSIOTP),SIOUCBAD(@10)               02S0288
         BNE   @RF00288                                         02S0288
         TM    SIOTALCD(@10),B'00000010'                        02S0288
         BNO   @RF00288                                         02S0288
*                     RECOVSW=OFF;      /*RECOVERY NOT NEEDED        */
         NI    RECOVSW,B'01111111'                              02S0289
*                    SIOTPTR = SIOTNPTR; /*GET NEXT SIOT.            */
@RF00288 L     @10,SIOTPTR                                      02S0290
         L     @10,SIOTNPTR(,@10)                               02S0290
         ST    @10,SIOTPTR                                      02S0290
*                  END;                                         02S0291
@DE00287 ICM   @10,15,SIOTPTR                                   02S0291
         BZ    @DC00287                                         02S0291
         TM    RECOVSW,B'10000000'                              02S0291
         BO    @DL00287                                         02S0291
@DC00287 DS    0H                                               02S0292
*                  SIOTPTR=SAVSIOTP;    /*POINT BACK TO REQUEST      */
         ST    SAVSIOTP,SIOTPTR                                 02S0292
*                  VUPTR=SVOLUNAD;                              02S0293
         L     @10,SIOTPTR                                      02S0293
         MVC   VUPTR(4),SVOLUNAD(@10)                           02S0293
*                  IF RECOVSW=ON THEN                           02S0294
         TM    RECOVSW,B'10000000'                              02S0294
         BNO   @RF00294                                         02S0294
*                    IF UCB3DACC=ON & UCBPRES=ON THEN /*PREMRES 02S0295
*                                        DEVICE?             @YM05583*/
         L     @02,UCBPTR                                       02S0295
         TM    UCB3DACC(@02),B'00100000'                        02S0295
         BNO   @RF00295                                         02S0295
         TM    UCBPRES(@02),B'00000100'                         02S0295
         BNO   @RF00295                                         02S0295
*                      DO;             /*YES, FAIL           @YM05583*/
*                        RTNCODE = FAILURE; /*SET RTN CODE   @YM05583*/
         LA    RTNCODE,4                                        02S0297
*                        SIOTRSNC = PMRSRSVD; /*SET RSN CODE @YM05583*/
         MVC   SIOTRSNC(2,@10),@CH00134                         02S0298
*                      END;            /*                    @YM05583*/
*                    ELSE              /*NOT PERMRES DEVICE  @YM05583*/
*                      IF UWAITSW=OFF THEN /*CAN ALLOCATION WAIT     */
         B     @RC00295                                         02S0300
@RF00295 L     @10,@PC00001                                     02S0300
         L     @10,ALCWAPTR(,@10)                               02S0300
         L     @10,FMAPPTR(,@10)                                02S0300
         TM    UWAITSW(@10),B'00100000'                         02S0300
         BNZ   @RF00300                                         02S0300
*                        DO;            /*NO                         */
*                          RTNCODE=FAILURE; /*SET ERROR RETURN CODE  */
         LA    RTNCODE,4                                        02S0302
*                          SIOTRSNC=NOWATING; /*SET REASON CODE      */
         L     @10,SIOTPTR                                      02S0303
         MVC   SIOTRSNC(2,@10),@CH00128                         02S0303
*                        END;                                   02S0304
*                      ELSE             /*ALLOCATION CAN WAIT        */
*                        CALL MARKVUS;  /*MARK FOR RECOVERY          */
         B     @RC00300                                         02S0305
@RF00300 BAL   @14,MARKVUS                                      02S0305
*                  ELSE                 /*THIS JOB OWNS VOL. @YM05583*/
*                    IF UCBVOLI ^= VOLSER0 THEN /*ANY VOLSER?@YM05583*/
         B     @RC00294                                         02S0306
@RF00294 L     @10,UCBPTR                                       02S0306
         CLC   UCBVOLI(6,@10),VOLSER0                           02S0306
         BE    @RF00306                                         02S0306
*                      VOLUMEID = UCBVOLI; /*YES PASS TO 434 @YM05583*/
         MVC   VOLUMEID(6),UCBVOLI(@10)                         02S0307
*                END;                                           02S0308
*              ELSE                     /*NO MOUNT PENDING           */
*                RECOVSW=OFF;                                   02S0309
         B     @RC00282                                         02S0309
@RF00282 NI    RECOVSW,B'01111111'                              02S0309
*              IF RECOVSW=OFF THEN      /*SHOULD BE ALLOC'D?         */
@RC00282 TM    RECOVSW,B'10000000'                              02S0310
         BNZ   @RF00310                                         02S0310
*                DO;                                            02S0311
*                  INDFLAGS=INDFLAGS && INDFLAGS; /*ZERO BIT SETTINGS*/
         XC    INDFLAGS(4),INDFLAGS                             02S0312
*                  IF SIOTETIO ^= ZERO THEN /*DOES ETIOT EXIST ?     */
         L     @10,SIOTPTR                                      02S0313
         ICM   @02,15,SIOTETIO(@10)                             02S0313
         BZ    @RF00313                                         02S0313
*                    ETIOFLAG=ON;       /*YES, ONLY UPDATE IT        */
         OI    ETIOFLAG,B'10000000'                             02S0314
*                  IF UCB3DACC=ON THEN  /*DA REQUEST?                */
@RF00313 L     @10,UCBPTR                                       02S0315
         TM    UCB3DACC(@10),B'00100000'                        02S0315
         BNO   @RF00315                                         02S0315
*                    USEFLAG=ON;        /*YES,UPDATE USE COUNT       */
         OI    USEFLAG,B'01000000'                              02S0316
*                  IF UCBRESV=OFF THEN  /*REMOVABLE VOLUME?          */
@RF00315 L     @10,UCBPTR                                       02S0317
         TM    UCBRESV(@10),B'00100000'                         02S0317
         BNZ   @RF00317                                         02S0317
*                    USEATFLG=ON;       /*YES,UPDATE USE ATTRIB      */
         OI    USEATFLG,B'00001000'                             02S0318
*                  IF VOLID(1)=FF & UCB3TAPE=ON /*VALIDITY CHK?      */
*                    & SCTSNEW=OFF THEN                         02S0319
@RF00317 L     @10,VUPTR                                        02S0319
         CLI   VOLID(@10),X'FF'                                 02S0319
         BNE   @RF00319                                         02S0319
         L     @10,UCBPTR                                       02S0319
         TM    UCB3TAPE(@10),B'10000000'                        02S0319
         BNO   @RF00319                                         02S0319
         L     @10,SIOTPTR                                      02S0319
         TM    SCTSNEW(@10),B'00000100'                         02S0319
         BNZ   @RF00319                                         02S0319
*                      VLDFLAG=ON;      /*YES,INDICATE               */
         OI    VLDFLAG,B'00010000'                              02S0320
*                  AFFFLAG=ON;          /*PROCESS AFFINITIES         */
@RF00319 DS    0H                                               02S0322
*                  UPDALGTB=ON;         /*UPDATE ALGORITHM TABLES    */
         OI    AFFFLAG,B'00100100'                              02S0322
*                  IF WHOLEGEN = ON THEN /*IS VOL SWITCHING OK ?     */
         L     @10,@PC00001+4                                   02S0323
         TM    WHOLEGEN(@10),B'01000000'                        02S0323
         BNO   @RF00323                                         02S0323
*                    VOLSWOK=ON;        /*VOLUME SWITCHING OK        */
         OI    VOLSWOK,B'00000010'                              02S0324
*                  GROUPID=EDLFGENP->EDLGRPTR->EDLGRID; /*SET GRUP ID*/
@RF00323 L     @10,SIOTPTR                                      02S0325
         L     @10,SIOTEDLP(,@10)                               02S0325
         L     @10,EDLFGENP(,@10)                               02S0325
         L     @10,EDLGRPTR(,@10)                               02S0325
         MVC   GROUPID(4),EDLGRID(@10)                          02S0325
*                  UCBDATAP=ADDR(UCBDATA);                      02S0326
         LA    @10,UCBDATA                                      02S0326
         ST    @10,UCBDATAP                                     02S0326
*                  IF UCB3TAPE=ON & UCBRESV=ON THEN /*RESERVED TAPE ?*/
         L     @10,UCBPTR                                       02S0327
         TM    UCB3TAPE(@10),B'10000000'                        02S0327
         BNO   @RF00327                                         02S0327
         TM    UCBRESV(@10),B'00100000'                         02S0327
         BNO   @RF00327                                         02S0327
*                    DO;                                        02S0328
*                      CALL IEFAB442(FUNC442,ALCWAPTR,VOLID,VOLUNTID);
         LA    @10,@CB00117                                     02S0329
         ST    @10,@AL00001                                     02S0329
         L     @10,@PC00001                                     02S0329
         ST    @10,@AL00001+4                                   02S0329
         L     @10,VUPTR                                        02S0329
         ST    @10,@AL00001+8                                   02S0329
         LA    @10,VOLUNTID(,@10)                               02S0329
         ST    @10,@AL00001+12                                  02S0329
         L     @15,@CV00155                                     02S0329
         LA    @01,@AL00001                                     02S0329
         BALR  @14,@15                                          02S0329
*                      RTNCODE = REG15; /*SAVE THE RETURN CODE       */
         LR    RTNCODE,REG15                                    02S0330
*                    END;                                       02S0331
*                  ELSE;               /*NOT A RESERVED TAPE         */
@RF00327 DS    0H                                               02S0333
*                  IF RTNCODE = SUCCESS THEN /*ANY ERROR ?           */
         LTR   RTNCODE,RTNCODE                                  02S0333
         BNZ   @RF00333                                         02S0333
*                    DO;                                        02S0334
*                      CALL IEFAB434 (SIOTPTR,VUPTR,UCBPTR,     02S0335
*                        INDFLAGS,ETIODATA,ALCWAPTR,            02S0335
*                        GROUPID,UCBDATAP); /*ALLOC REQ TO UNIT      */
         LA    @10,SIOTPTR                                      02S0335
         ST    @10,@AL00001                                     02S0335
         LA    @10,VUPTR                                        02S0335
         ST    @10,@AL00001+4                                   02S0335
         LA    @10,UCBPTR                                       02S0335
         ST    @10,@AL00001+8                                   02S0335
         LA    @10,INDFLAGS                                     02S0335
         ST    @10,@AL00001+12                                  02S0335
         LA    @10,ETIODATA                                     02S0335
         ST    @10,@AL00001+16                                  02S0335
         L     @10,@PC00001                                     02S0335
         ST    @10,@AL00001+20                                  02S0335
         LA    @10,GROUPID                                      02S0335
         ST    @10,@AL00001+24                                  02S0335
         LA    @10,UCBDATAP                                     02S0335
         ST    @10,@AL00001+28                                  02S0335
         L     @15,@CV00154                                     02S0335
         LA    @01,@AL00001                                     02S0335
         BALR  @14,@15                                          02S0335
*                      RTNCODE=REG15;  /*SAVE RETURN CODE            */
         LR    RTNCODE,REG15                                    02S0336
*                      IF (RTNCODE=RET32 /*RECOVERABLE AFF ERROR
*                                                            @YM05583*/
*                         & UCBPRES=OFF & UCBRESV=OFF) × /*ON   02S0337
*                                        REMOVABLE DEVICE    @YM05583*/
*                         RTNCODE = RET40 THEN /*TAPE AFF ERROR 02S0337
*                                                            @ZA04112*/
         CH    RTNCODE,@CH00064                                 02S0337
         BNE   @GL00048                                         02S0337
         L     @10,UCBPTR                                       02S0337
         TM    UCBPRES(@10),B'00100100'                         02S0337
         BZ    @RT00337                                         02S0337
@GL00048 CH    RTNCODE,@CH00142                                 02S0337
         BNE   @RF00337                                         02S0337
@RT00337 DS    0H                                               02S0338
*                        RTNCODE=SUCCESS;                       02S0338
         SLR   RTNCODE,RTNCODE                                  02S0338
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ERORCHK                                           */
*/*                                                                  */
*/* DISCRIPTIVE NAME - CHECK ERRORS FROM IEFAB434                    */
*/*                                                                  */
*/* FUNCTION                                                         */
*/*   THIS SEGMENT CHECKS RETURN CODES FROM IEFAB434. IF THE RETURN  */
*/*   CODE IS SUCCESSFUL OR INDICATES AFFINITY ERROR, THE REQUEST    */
*/*   IS ALLOCATED. IF UNSUCCESSFUL RETURN CODE,THEN IF THE VOLUME   */
*/*   WAS ENQ'D FOR THIS REQUEST,IT MUST BE DEQ'D. IF A RECOVERABLE  */
*/*   DADSM ERROR OCCURRED ON A REMOVABLE DEVICE, THEN       @YM05583*/
*/*   IF NO SPECIFIC REQUESTS ARE ALLOCATED TO THIS          @YM05583*/
*/*   UNIT,RECOVERY IS INDICATED. IF SPECIFIC REQUESTS ARE           */
*/*   ALLOCATED TO THIS UNIT, THEN A FAILURE RETURN CODE IS SET.     */
*/*                                                                  */
*/* OPERATION                                                        */
*/*   THE OPERATION IS DOCUMENTED BY THE CODE                        */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT                                                          */
*/*     SIOT1P  - POINTER TO FIRST SIOT                              */
*/*     RTNCODE - RETURN CODE FROM IEFAB434                          */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - NO ERROR OCCURRED IN IEFAB434.                     */
*/*                                                                  */
*/*   OUTPUT - REQUEST MARKED ALLOCATED,COUNTS DECREMENTED           */
*/*                                                                  */
*/*   RTNCODE - 0 IN RTNCODE                                         */
*/*                                                                  */
*/* EXIT - ERROR - INLINE SUBROUTINE                                 */
*/*                                                                  */
*/*   CONDITION - UNRECOVERABLE DADSM ERROR FOUND BY IEFAB434        */
*/*               OR RECOVERABLE ERROR FOR SPECIFIC REQUEST          */
*/*                                                                  */
*/*   OUTPUT - REASON CODE PUT IN FIELD SIOTRSNC OF SIOT BY IEFAB434 */
*/*            SEE IEFAB434 FOR POSSIBLE REASON CODES.               */
*/*                                                                  */
*/*   RETURN CODE - 4 IN RTNCODE                                     */
*/*                                                                  */
*/*   CONDITION - RECOVERABLE DADSM ERROR FOR NON-SPECIFIC REQUEST   */
*/*                                                                  */
*/*   OUTPUT - SET UP FOR RECOVERY VUDADSME SET ON IN VOLUNIT ENTRY  */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/********************************************************************/
*IF RTNCODE=SUCCESS × RTNCODE=RET36 THEN /*ALLOCATED SUCCESSFULLY?   */
@RF00337 LTR   RTNCODE,RTNCODE                                  03S0339
         BZ    @RT00339                                         03S0339
         CH    RTNCODE,@CH00140                                 03S0339
         BNE   @RF00339                                         03S0339
@RT00339 DS    0H                                               03S0340
*  DO;                                  /*YES                        */
*    VOLALOC=ON;                        /*MARK VU ALLOCATED          */
         L     @10,VUPTR                                        03S0341
         OI    VOLALOC(@10),B'10000000'                         03S0341
*    TOTVOLUN=TOTVOLUN-ONE;             /*DECREMENT VOLUNIT COUNT    */
         L     @10,@PC00001                                     03S0342
         L     @10,ALCWAPTR(,@10)                               03S0342
         L     @02,TOTVOLUN(,@10)                               03S0342
         BCTR  @02,0                                            03S0342
         ST    @02,TOTVOLUN(,@10)                               03S0342
*    IF SIOTALCD = OFF THEN             /*SIOT NOT YET ALLOC'D       */
         L     @02,SIOTPTR                                      03S0343
         TM    SIOTALCD(@02),B'00000010'                        03S0343
         BNZ   @RF00343                                         03S0343
*      DO;                              /*YES, COUNT AS ALLOC'D      */
*        SIOTALCD=ON;                   /*MARK SIOT ALLOCATED        */
         OI    SIOTALCD(@02),B'00000010'                        03S0345
*        TOTREQS=TOTREQS-ONE;           /*DECREMENT TOTAL COUNT      */
         L     @02,TOTREQS(,@10)                                03S0346
         BCTR  @02,0                                            03S0346
         ST    @02,TOTREQS(,@10)                                03S0346
*      END;                                                     03S0347
*    ELSE;                              /*SIOT ALREADY MARKED ALLOC'D*/
@RF00343 DS    0H                                               03S0349
*  END;                                                         03S0349
*ELSE                                   /*NOT ALLOCATED SUCCESSFULLY */
*  DO;                                                          03S0350
         B     @RC00339                                         03S0350
@RF00339 DS    0H                                               03S0351
*    IF VOLUMENQ=ON THEN                /*DID THIS REQUEST ENQ?      */
         TM    VOLUMENQ,B'10000000'                             03S0351
         BNO   @RF00351                                         03S0351
*      DO;                              /*YES                        */
*        VOLUMENQ=OFF;                                          03S0353
*        VOLUMEDQ=ON;                                           03S0354
         OI    VOLUMEDQ,B'01000000'                             03S0354
         NI    VOLUMENQ,B'01111111'                             03S0354
*        CALL IEFAB4F0(FOMAP,VOLSERP,TCBADD,VOLUNPTR,VOLUNSZE); /*DEQ
*                                         VOLSER                     */
         LA    @10,FOMAP                                        03S0355
         ST    @10,@AL00001                                     03S0355
         LA    @10,VOLSERP                                      03S0355
         ST    @10,@AL00001+4                                   03S0355
         LA    @10,TCBADD                                       03S0355
         ST    @10,@AL00001+8                                   03S0355
         L     @10,@PC00001                                     03S0355
         L     @10,ALCWAPTR(,@10)                               03S0355
         LA    @02,VOLUNPTR(,@10)                               03S0355
         ST    @02,@AL00001+12                                  03S0355
         LA    @10,VOLUNSZE(,@10)                               03S0355
         ST    @10,@AL00001+16                                  03S0355
         L     @15,@CV00152                                     03S0355
         LA    @01,@AL00001                                     03S0355
         BALR  @14,@15                                          03S0355
*      END;                                                     03S0356
*    IF RTNCODE=RET24 THEN              /*TAPE VOL SWITCH NEEDED?    */
@RF00351 CH    RTNCODE,@CH00108                                 03S0357
         BNE   @RF00357                                         03S0357
*      DO;                                                      03S0358
*        WAITIGEN = ON;                 /*INDICATE UCB IS NOT   03S0359
*                                         ELIGIBLE TO OTHER REQS     */
         L     @10,@PC00001                                     03S0359
         L     @10,ALCWAPTR(,@10)                               03S0359
         OI    WAITIGEN(@10),B'01000000'                        03S0359
*        VOLALGTP->CVRWUCBP=UCBPTR;                             03S0360
         L     @10,VUPTR                                        03S0360
         L     @10,VOLALGTP(,@10)                               03S0360
         MVC   CVRWUCBP(2,@10),UCBPTR+2                         03S0360
*        RTNCODE=SUCCESS;                                       03S0361
         SLR   RTNCODE,RTNCODE                                  03S0361
*      END;                                                     03S0362
*    ELSE                               /*NOT TAPE VOL SWITCH NEEDED */
*    IF RTNCODE=RECDADER                /*RECOVERABLE DADSM ERROR    */
*        & UCBPRES=OFF & UCBRESV=OFF THEN /*ON REMOVABLE DEV @YM05583*/
         B     @RC00357                                         03S0363
@RF00357 CH    RTNCODE,@CH00144                                 03S0363
         BNE   @RF00363                                         03S0363
         L     @10,UCBPTR                                       03S0363
         TM    UCBPRES(@10),B'00100100'                         03S0363
         BNZ   @RF00363                                         03S0363
*      DO;                              /*YES                        */
*        RTNCODE=SUCCESS;               /*ZERO RETURN WORD           */
         SLR   RTNCODE,RTNCODE                                  03S0365
*        SAVUTYPE=SIOUCBAD;             /*SAVE UCBPTR                */
         L     @10,SIOTPTR                                      03S0366
         SLR   SAVUTYPE,SAVUTYPE                                03S0366
         ICM   SAVUTYPE,7,SIOUCBAD(@10)                         03S0366
*        SAVSIOTP=SIOTPTR;              /*SAVE SIOTPTR               */
         LR    SAVSIOTP,@10                                     03S0367
*        SIOTPTR=SIOT1P;                /*POINT TO FIRST SIOT        */
         L     @10,@PC00001                                     03S0368
         L     @10,ALCWAPTR(,@10)                               03S0368
         MVC   SIOTPTR(4),SIOT1P(@10)                           03S0368
*        REPROCES=ON;                   /*ASSUME ONLY DEMAND ON VOL  */
         OI    REPROCES,B'10000000'                             03S0369
*        DO WHILE SIOTPTR^=ZERO & RTNCODE=SUCCESS; /*SCAN SIOTS      */
         B     @DE00370                                         03S0370
@DL00370 DS    0H                                               03S0371
*          VUPTR=SVOLUNAD;              /*POINT TO VOLUNIT ENTRY     */
         L     @10,SIOTPTR                                      03S0371
         L     @05,SVOLUNAD(,@10)                               03S0371
         ST    @05,VUPTR                                        03S0371
*          IF SIOTGIGN=OFF & SAVUTYPE=SIOUCBAD THEN /*IS THIS REQUEST
*                                         DEMAND TO SAME UCB?        */
         TM    SIOTGIGN(@10),B'00001000'                        03S0372
         BNZ   @RF00372                                         03S0372
         SLR   @15,@15                                          03S0372
         ICM   @15,7,SIOUCBAD(@10)                              03S0372
         CR    SAVUTYPE,@15                                     03S0372
         BNE   @RF00372                                         03S0372
*            DO;                        /*YES                        */
*              IF VOLSPEC=ON THEN       /*SPECIFIC REUEST?           */
         TM    VOLSPEC(@05),B'00100000'                         03S0374
         BNO   @RF00374                                         03S0374
*                DO;                    /*YES                        */
*                  RTNCODE=FAILURE;     /*FAILURE RETURN CODE        */
         LA    RTNCODE,4                                        03S0376
*                END;                                           03S0377
*              ELSE                                             03S0378
*                IF SIOTALCD=ON THEN   /*IF ANY SIOTS ALCD THEN THIS
*                                          ALLOCATION MUST RECOVER   */
         B     @RC00374                                         03S0378
@RF00374 L     @10,SIOTPTR                                      03S0378
         TM    SIOTALCD(@10),B'00000010'                        03S0378
         BNO   @RF00378                                         03S0378
*                  DO;                                          03S0379
*                    VUDADSME=ON;       /*TURN ON DADSM ERROR SWITCH */
         L     @10,VUPTR                                        03S0380
         OI    VUDADSME(@10),B'00000100'                        03S0380
*                    REPROCES=OFF;     /*TURN REPROCESS OFF          */
         NI    REPROCES,B'01111111'                             03S0381
*                  END;                                         03S0382
*            END;                                               03S0383
*          ELSE;                        /*NOT SPEC REQ TO THIS UCB   */
@RF00372 DS    0H                                               03S0385
*          SIOTPTR=SIOTNPTR;            /*POINT TO NEXT SIOT         */
@RC00372 L     @10,SIOTPTR                                      03S0385
         L     @10,SIOTNPTR(,@10)                               03S0385
         ST    @10,SIOTPTR                                      03S0385
*        END;                                                   03S0386
@DE00370 SLR   @10,@10                                          03S0386
         C     @10,SIOTPTR                                      03S0386
         BE    @DC00370                                         03S0386
         CR    RTNCODE,@10                                      03S0386
         BE    @DL00370                                         03S0386
@DC00370 DS    0H                                               03S0387
*        SIOTPTR=SAVSIOTP;              /*POINT TO THIS SIOT         */
         ST    SAVSIOTP,SIOTPTR                                 03S0387
*        VUPTR=SVOLUNAD;                /*POINT TO SIOT'S VU ENTRY   */
         L     @10,SIOTPTR                                      03S0388
         MVC   VUPTR(4),SVOLUNAD(@10)                           03S0388
*        IF (RTNCODE=SUCCESS &          /*SUCCESSFUL RETURN AREA MEANS
*                                        NO SPECIFIC REQS TO THIS UCB*/
*              REPROCES=OFF) ×          /*REPROCESS OFF MEANS MORE THAN
*                                         ONE NON-SPEC REQ.          */
*              (UCBALOC=ON & REPROCES=ON) THEN  /*OTHER ALLOCATION
*                                        ON THIS PACK                */
         LTR   RTNCODE,RTNCODE                                  03S0389
         BNZ   @GL00054                                         03S0389
         TM    REPROCES,B'10000000'                             03S0389
         BZ    @RT00389                                         03S0389
@GL00054 L     @10,UCBPTR                                       03S0389
         TM    UCBALOC(@10),B'00001000'                         03S0389
         BNO   @RF00389                                         03S0389
         TM    REPROCES,B'10000000'                             03S0389
         BNO   @RF00389                                         03S0389
@RT00389 DS    0H                                               03S0390
*          DO;                          /*THEREFORE,RECOVERABLE ERROR*/
*            REPROCES=OFF;              /*TURN OFF REPROCESS SWITCH  */
         NI    REPROCES,B'01111111'                             03S0391
*            CALL MARKVUS;              /*SET UP FOR RECOVERY        */
         BAL   @14,MARKVUS                                      03S0392
*          END;                                                 03S0393
*       END;                                                    03S0394
*     ELSE                              /*NOT A RCVRABLE DADSM ERROR */
*       DO;                                                     03S0395
         B     @RC00363                                         03S0395
@RF00363 DS    0H                                               03S0396
*         RTNCODE=FAILURE;              /*SET FAILING RETURN CODE    */
         LA    RTNCODE,4                                        03S0396
*       END;                                                    03S0397
*  END;                                                         03S0398
*                    END;                                       02S0399
*                  ELSE;               /*ERROR                       */
@RF00333 DS    0H                                               02S0401
*              END;                                             02S0401
*            END;                                               02S0402
*          ELSE;                        /*UNSUCCESSFUL ENQ           */
@RF00280 DS    0H                                               02S0404
*        END;                                                   02S0404
@RC00280 DS    0H                                               02S0405
*    END;                                                       02S0405
@RF00213 DS    0H                                               02S0406
*  IF REPROCES=OFF THEN                 /*TRY NEXT SIOT?             */
@RF00208 TM    REPROCES,B'10000000'                             02S0406
         BNZ   @RF00406                                         02S0406
*    SIOTPTR=SIOTNPTR;                /*YES,POINT TO NEXT SIOT       */
         L     @10,SIOTPTR                                      02S0407
         L     @10,SIOTNPTR(,@10)                               02S0407
         ST    @10,SIOTPTR                                      02S0407
*END;                                                           02S0408
@RF00406 DS    0H                                               02S0408
@DE00207 SLR   @10,@10                                          02S0408
         C     @10,SIOTPTR                                      02S0408
         BE    @DC00207                                         02S0408
         CR    RTNCODE,@10                                      02S0408
         BE    @DL00207                                         02S0408
@DC00207 DS    0H                                               02S0409
*  END;                                                         01S0409
*RETURN CODE(RTNCODE);                  /*RETURN TO CALLER           */
@RF00203 IC    @02,@OLDKEY                                      01S0410
         L     @13,4(,@13)                                      01S0410
         L     @00,@SIZDATD                                     01S0410
         LR    @01,@11                                          01S0410
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@03                                          01S0410
         L     @14,12(,@13)                                     01S0410
         LM    @00,@12,20(@13)                                  01S0410
         BR    @14                                              01S0410
*MARKVUS: PROC;                                                 02S0411
MARKVUS  STM   @14,@12,12(@13)                                  02S0411
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MARKVUS                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - MARK REQUESTS FOR RECOVERY                    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE PURPOSE OF THIS CODE SEGMENT IS TO SCAN THE VOLUNIT        */
*/*   TABLE WHENEVER IT IS DETERMINED THAT A REQUEST NEEDS RECOVERY  */
*/*   PROCESSING. IF ANY ENTRIES IN THE VOLUNIT TABLE HAVE THE SAME  */
*/*   VOLUNTID,OR ARE ASKING FOR THE SAME UNIT,THESE ENTRIES ARE     */
*/*   ALSO MARKED FOR RECOVERY. AN ENTRY IS MARKED FOR RECOVERY BY   */
*/*   TURNING ON THE VUDNALOC BIT AND PUTTING THE POINTER TO THE     */
*/*   UCB IN FIELD CVRWUCBP OF THE ALGORITHM TABLES.                 */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   THE OPERATION IS DOCUMENTED BY THE CODE.                       */
*/*                                                                  */
*/* ENTRY - INLINE SUBROUTINE                                        */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT - SIOTPTR - ADDRESS OF SIOT FOR THE REQUEST              */
*/*                                                                  */
*/* EXIT - NORMAL - INLINE SUBROUTINE                                */
*/*                                                                  */
*/*   CONDITION - ALL VOLUNIT ENTRIES WITH THE SAME VOLUNTID OR WHOSE*/
*/*               SIOTS REPRESENT DEMAND REQUESTS AND ARE REQUESTING */
*/*               THIS UNIT ARE MARKED FOR RECOVERY.                 */
*/*                                                                  */
*/*   OUTPUT - VUDNALOC BIT OF ALL SUCH REQUESTS TURNED ON,POINTER   */
*/*            TO UCB PUT IN ALGORITHM TABLES.                       */
*/*                                                                  */
*/*   RETURN CODE - 0 IN RTNCODE                                     */
*/*                                                                  */
*/* EXIT ERROR - NONE                                                */
*/*                                                                  */
*/********************************************************************/
*SAVSIOTP=SIOTPTR;                      /*SAVE SIOTPTR               */
         L     SAVSIOTP,SIOTPTR                                 02S0412
*SAVUNTID=VOLUNTID;                     /*SAVE VOLUNITID             */
         L     @10,VUPTR                                        02S0413
         LH    SAVUNTID,VOLUNTID(,@10)                          02S0413
*IF VUDMNDOF = OFF & VUDMNDAL = OFF THEN                        02S0414
         TM    VUDMNDOF(@10),B'00110000'                        02S0414
         BNZ   @RF00414                                         02S0414
*  DO;                                                          02S0415
*    VUDMUNIQ = ON;                     /*INDICATE FIRST REQ FOR UNIT*/
         OI    VUDMUNIQ(@10),B'00000100'                        02S0416
*  END;                                                         02S0417
*VUPTR=VOLUNPTR;                        /*POINT TO FIRST VOLUN ENTRY */
@RF00414 L     @10,@PC00001                                     02S0418
         L     @10,ALCWAPTR(,@10)                               02S0418
         MVC   VUPTR(4),VOLUNPTR(@10)                           02S0418
*DO VUCTR=ONE TO VOLUNSZE/LENGTH(VOLUNTAB); /*SCAN VOLUN TABLE       */
         LA    VUCTR,1                                          02S0419
         B     @DE00419                                         02S0419
@DL00419 DS    0H                                               02S0420
*  SIOTPTR=VOLSIOTP;                                            02S0420
         L     @10,VUPTR                                        02S0420
         L     @05,VOLSIOTP(,@10)                               02S0420
         ST    @05,SIOTPTR                                      02S0420
*  IF VOLUNTID=SAVUNTID × (SIOTDMND=ON  /*SAME UNITID AS CURRENT REQ */
*     & SIOTGIGN=OFF & SAVSIOTP->SIOUCBAD=SIOUCBAD) THEN        02S0421
         CH    SAVUNTID,VOLUNTID(,@10)                          02S0421
         BE    @RT00421                                         02S0421
         TM    SIOTDMND(@05),B'10000000'                        02S0421
         BNO   @RF00421                                         02S0421
         TM    SIOTGIGN(@05),B'00001000'                        02S0421
         BNZ   @RF00421                                         02S0421
         CLC   SIOUCBAD(3,SAVSIOTP),SIOUCBAD(@05)               02S0421
         BNE   @RF00421                                         02S0421
@RT00421 DS    0H                                               02S0422
*    DO;                                /*OR SAME UNIT               */
*      VUDNALOC=ON;                     /*MARK VU FOR RECOVERY       */
         L     @10,VUPTR                                        02S0423
         OI    VUDNALOC(@10),B'00001000'                        02S0423
*      VOLUNTID=SAVUNTID;               /*ASSIGN SAME UNIT ID        */
         STH   SAVUNTID,VOLUNTID(,@10)                          02S0424
*      VOLALGTP->CVRWUCBP=UCBPTR;       /*PUT UCB PTR IN ALG TABLE   */
         L     @05,UCBPTR                                       02S0425
         L     @01,VOLALGTP(,@10)                               02S0425
         STH   @05,CVRWUCBP(,@01)                               02S0425
*      WAITIGEN=ON;                     /*INDICATE ALB TABLE UPDATED */
         L     @15,@PC00001                                     02S0426
         L     @01,ALCWAPTR(,@15)                               02S0426
         OI    WAITIGEN(@01),B'01000000'                        02S0426
*      IF UCBONLI = OFF THEN            /*IS UCB OFFLINE ?           */
         TM    UCBONLI(@05),B'10000000'                         02S0427
         BNZ   @RF00427                                         02S0427
*        VUDMNDOF = ON;                 /*YES, INDICATE              */
         OI    VUDMNDOF(@10),B'00100000'                        02S0428
*      ELSE                             /*INDICATE UCB IS ALLOC'D    */
*        VUDMNDAL = ON;                                         02S0429
         B     @RC00427                                         02S0429
@RF00427 L     @10,VUPTR                                        02S0429
         OI    VUDMNDAL(@10),B'00010000'                        02S0429
*    END;                                                       02S0430
@RC00427 DS    0H                                               02S0431
*  VUPTR=VUPTR+LENGTH(VOLUNTAB);        /*POINT TO NEXT ENTRY        */
@RF00421 LA    @10,28                                           02S0431
         AL    @10,VUPTR                                        02S0431
         ST    @10,VUPTR                                        02S0431
*END;                                                           02S0432
         AH    VUCTR,@CH00040                                   02S0432
@DE00419 L     @10,@PC00001                                     02S0432
         L     @10,ALCWAPTR(,@10)                               02S0432
         L     @00,VOLUNSZE(,@10)                               02S0432
         SRDA  @00,32                                           02S0432
         D     @00,@CF00137                                     02S0432
         CR    VUCTR,@01                                        02S0432
         BNH   @DL00419                                         02S0432
*SIOTPTR=SAVSIOTP;                                              02S0433
         ST    SAVSIOTP,SIOTPTR                                 02S0433
*VUPTR=SVOLUNAD;                                                02S0434
         L     @10,SIOTPTR                                      02S0434
         MVC   VUPTR(4),SVOLUNAD(@10)                           02S0434
*END MARKVUS;                                                   02S0435
@EL00002 DS    0H                                               02S0435
@EF00002 DS    0H                                               02S0435
@ER00002 LM    @14,@12,12(@13)                                  02S0435
         BR    @14                                              02S0435
*END IEFAB479                           /*END ALLOCATE DEMAND REQS   */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A479SPEC)                                        *
*/*%INCLUDE SYSLIB  (A479DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        *
*/*%INCLUDE SYSLIB  (IEFZB422)                                        *
*/*%INCLUDE SYSLIB  (IEFZB428)                                        *
*/*%INCLUDE SYSLIB  (IEFZB423)                                        *
*/*%INCLUDE SYSLIB  (IEFZB425)                                        *
*/*%INCLUDE SYSLIB  (IEFZB426)                                        *
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        *
*/*%INCLUDE SYSLIB  (FIRSTSCN)                                        *
*/*%INCLUDE SYSLIB  (FSCNSPEC)                                        *
*/*%INCLUDE SYSLIB  (ALOCSPFC)                                        *
*/*%INCLUDE SYSLIB  (ALSPSPEC)                                        *
*/*%INCLUDE SYSLIB  (DATPALOC)                                        *
*/*%INCLUDE SYSLIB  (DATPSPEC)                                        *
*/*%INCLUDE SYSLIB  (SECNDSCN)                                        *
*/*%INCLUDE SYSLIB  (SCNDSPEC)                                        *
*/*%INCLUDE SYSLIB  (ERORCHK )                                        *
*/*%INCLUDE SYSLIB  (ERORSPEC)                                        *
*/*%INCLUDE SYSLIB  (MARKVUS )                                        *
*/*%INCLUDE SYSLIB  (MARKSPEC)                                        *
*;                                                              01S0436
@DATA    DS    0H
@CH00040 DC    H'1'
@CH00057 DC    H'8'
@CH00144 DC    H'12'
@CH00120 DC    H'21'
@CH00108 DC    H'24'
@CH00064 DC    H'32'
@CH00140 DC    H'36'
@CH00142 DC    H'40'
@CH00126 DC    H'56'
@CH00128 DC    H'59'
@CH00134 DC    H'66'
@CH00124 DC    H'70'
@CH00111 DC    H'71'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@AL00001 DS    8A
@TF00001 DS    F
IEFAB479 CSECT
         DS    0F
@CF00137 DC    F'28'
@CH00137 EQU   @CF00137+2
@DATD    DSECT
         DS    0D
EDLGNTP  DS    A
EDLPTR   DS    A
EDLUCBLP DS    A
SIOTPTR  DS    A
TCBADD   DS    A
TCBJSCB  DS    A
UCBDATAP DS    A
UCBPTR   DS    A
VOLSERP  DS    A
VUPTR    DS    A
GROUPID  DS    F
CNTPTR   DS    A
SAVVUPTR DS    A
FOMAP    DS    BL1
         ORG   FOMAP
VOLUMENQ DS    BL1
VOLUMEDQ EQU   FOMAP+0
VOLEXCLU EQU   FOMAP+0
@NM00001 EQU   FOMAP+0
         ORG   FOMAP+1
INDFLAGS DS    BL4
         ORG   INDFLAGS
ETIOFLAG DS    BL1
USEFLAG  EQU   INDFLAGS+0
AFFFLAG  EQU   INDFLAGS+0
VLDFLAG  EQU   INDFLAGS+0
USEATFLG EQU   INDFLAGS+0
UPDALGTB EQU   INDFLAGS+0
VOLSWOK  EQU   INDFLAGS+0
@NM00002 EQU   INDFLAGS+0
         ORG   INDFLAGS+4
NSPCMNT  DS    BL1
RECOVSW  DS    BL1
REPROCES DS    BL1
UCBDATA  DS    CL9
         ORG   UCBDATA
@NM00003 DS    AL2
VOLUMEID DS    CL6
@NM00004 DS    CL1
         ORG   UCBDATA+9
SAVVOLID DS    CL6
@OLDKEY  DS    AL1
IEFAB479 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00152 DC    V(IEFAB4F0)
@CV00153 DC    V(IEFAB433)
@CV00154 DC    V(IEFAB434)
@CV00155 DC    V(IEFAB442)
         DS    0D
ETIODATA DS    FL4
         ORG   ETIODATA
RELDEVNO DC    H'1'
NUMDEVS  DC    H'1'
         ORG   ETIODATA+4
@CB00117 DC    B'10000000'
         DS    CL3
FUNCLIST DS    CL8
         ORG   FUNCLIST
@NM00005 DS    CL4
         ORG   @NM00005
@NM00006 DC    B'00001110'
         ORG   @NM00006
@NM00007 DS    BL1
@NM00008 EQU   @NM00006+0
@NM00009 EQU   @NM00006+0
@NM00010 EQU   @NM00006+0
@NM00011 EQU   @NM00006+0
@NM00012 EQU   @NM00006+0
@NM00013 EQU   @NM00006+0
@NM00014 EQU   @NM00006+0
         ORG   @NM00005+1
@NM00015 DS    AL3
         ORG   FUNCLIST+4
@NM00016 DS    FL4
         ORG   FUNCLIST+8
VOLSER0  DC    X'000000000000'
IEFAB479 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB479 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
VUCTR    EQU   @04
SAVUTYPE EQU   @04
SAVUNTID EQU   @03
RTNCODE  EQU   @03
ERETCODE EQU   @04
SAVSIOTP EQU   @02
REG15    EQU   @15
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTBYT1 EQU   INDMSIOT+43
SIOTALCD EQU   SIOTBYT1
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SIOTGIGN EQU   SIOTBYT0
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSNEW  EQU   SCTSBYT3
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOUCBAD EQU   SCTUTYPE+5
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTDMND EQU   SIOTBYT2
SIOTRSNC EQU   INDMSIOT+130
SIOTEDLP EQU   INDMSIOT+136
SVOLUNAD EQU   INDMSIOT+140
SIOTETIO EQU   INDMSIOT+148
SIOTNPTR EQU   INDMSIOT+152
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBMONT  EQU   UCBJBNR
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3TAPE EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00036 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
IEFEDL   EQU   0
EDLHDR   EQU   IEFEDL
EDLFGENP EQU   EDLHDR+8
EDLUVFLG EQU   EDLHDR+16
EDLENTRY EQU   0
EDLGRPTR EQU   EDLENTRY+12
EDLDTFLG EQU   EDLENTRY+20
EDLGNTRY EQU   0
EDLLISTP EQU   EDLGNTRY+8
EDLGRID  EQU   EDLGNTRY+12
EDLGRFLG EQU   EDLGNTRY+16
EDLUCBL  EQU   0
EDLINDIC EQU   EDLUCBL+2
EDLENQ   EQU   EDLINDIC
FUNCMAP  EQU   0
VOLMNTSW EQU   FUNCMAP
WRTMSGSW EQU   FUNCMAP
UWAITSW  EQU   FUNCMAP
VWAITSW  EQU   FUNCMAP
OFFDEVSW EQU   FUNCMAP
CCLMNTSW EQU   FUNCMAP
GENLOKSW EQU   FUNCMAP
HDRMSGSW EQU   FUNCMAP+1
MTRJOBSW EQU   FUNCMAP+1
NOTIOTNQ EQU   FUNCMAP+1
TRKMSW   EQU   FUNCMAP+1
WAITOKSW EQU   FUNCMAP+1
ASNMSW   EQU   FUNCMAP+1
VOLUNTAB EQU   0
VOLID    EQU   VOLUNTAB
VOLSTAT  EQU   VOLUNTAB+6
VOLSTATA EQU   VOLSTAT
VOLPUB   EQU   VOLSTATA
VOLPRV   EQU   VOLSTATA
VOLSPEC  EQU   VOLSTATA
VOLSTATB EQU   VOLSTAT+1
VOLALOC  EQU   VOLSTATB
VUDNALOC EQU   VOLSTATB
VUDADSME EQU   VOLSTATB
VUVINELG EQU   VOLSTATB
VOLSTATC EQU   VOLSTAT+2
VOLSTATD EQU   VOLSTAT+3
VUDMNDOF EQU   VOLSTATD
VUDMNDAL EQU   VOLSTATD
VUDMUNIQ EQU   VOLSTATD
VOLUNTID EQU   VOLUNTAB+10
VOLALGTP EQU   VOLUNTAB+12
VOLSIOTP EQU   VOLUNTAB+16
ALCWA    EQU   0
FMAPPTR  EQU   ALCWA+4
SIOT1P   EQU   ALCWA+8
JSCBPTR  EQU   ALCWA+12
CNTABLE  EQU   ALCWA+28
SPECREQS EQU   CNTABLE+12
TOTREQS  EQU   CNTABLE+36
TOTVOLUN EQU   CNTABLE+44
VOLUNPTR EQU   ALCWA+80
VOLUNSZE EQU   ALCWA+84
ALGTABP  EQU   ALCWA+88
INDICATE EQU   ALCWA+112
INDWAIT  EQU   INDICATE
@NM00044 EQU   ALCWA+113
WAITIGEN EQU   @NM00044
TIOTHDRP EQU   ALCWA+120
NAMES    EQU   0
ALGPTRS  EQU   0
CVRPARM  EQU   0
CVRFLG1  EQU   CVRPARM+8
CVRRQLST EQU   0
CVRMIN   EQU   CVRRQLST+10
CVRFLG2  EQU   CVRRQLST+16
CVRWUCBP EQU   CVRRQLST+24
CVRGPLST EQU   0
CVRFLG3  EQU   CVRGPLST+12
GRPCOUNT EQU   0
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBTCBP EQU   JSCBSEC1+20
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
UCBBGN   EQU   0
ALCWAPTR EQU   0
FLAGBITS EQU   0
WHOLEGEN EQU   FLAGBITS
SPMNTSW  EQU   FLAGBITS
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBMOUNT EQU   UCBDMCT
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00035 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCSCT   EQU   JSCBSEC3+68
JSCRSV35 EQU   JSCBSEC3+96
JSCRSV36 EQU   JSCRSV35
JSCRSV37 EQU   JSCRSV35+2
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCRSV41 EQU   JSCRSV37+1
JSCRSV40 EQU   JSCRSV37
JSCRSV39 EQU   JSCRSV36+1
JSCRSV38 EQU   JSCRSV36
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00055 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00054 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCRSV25 EQU   JSCBSEC3+10
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00035
UCBSKPFG EQU   @NM00035
UCBRIPND EQU   @NM00035
UCBRTIAC EQU   @NM00035
UCBRSV79 EQU   @NM00035
UCBRSV78 EQU   @NM00035
UCBRSV77 EQU   @NM00035
UCBOLTEP EQU   @NM00035
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00034 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
LASTDONE EQU   FLAGBITS
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00053 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00052 EQU   IEZJSCB
GRPWPTR  EQU   GRPCOUNT+12
GRPIDENT EQU   GRPCOUNT+10
GRPEXCS  EQU   GRPCOUNT+8
GRPTOTAL EQU   GRPCOUNT+6
GRPOFFLN EQU   GRPCOUNT+4
GRPALLCT EQU   GRPCOUNT+2
GRPAVAIL EQU   GRPCOUNT
@NM00051 EQU   CVRGPLST+13
@NM00050 EQU   CVRFLG3
CVRFORCI EQU   CVRFLG3
CVRGSKP  EQU   CVRFLG3
CVRBOUND EQU   CVRGPLST+10
CVRGALL  EQU   CVRGPLST+8
CVRGRPAL EQU   CVRGPLST+6
CVRGRPID EQU   CVRGPLST+4
CVRGCPTR EQU   CVRGPLST
@NM00049 EQU   CVRRQLST+26
CVRGRPPT EQU   CVRRQLST+20
CVRNGRP  EQU   CVRRQLST+18
@NM00048 EQU   CVRFLG2+1
CVRDUPLI EQU   CVRFLG2+1
CVRWMOVE EQU   CVRFLG2
CVRIGNOR EQU   CVRFLG2
CVRMULTI EQU   CVRFLG2
CVRSCRTH EQU   CVRFLG2
CVRFULL  EQU   CVRFLG2
CVRREACH EQU   CVRFLG2
CVRRUSED EQU   CVRFLG2
CVRSKFLG EQU   CVRFLG2
CVRGNEXT EQU   CVRRQLST+12
CVRPTS   EQU   CVRMIN
CVRNEED  EQU   CVRRQLST+8
CVRALLCT EQU   CVRRQLST+6
CVRREQ1  EQU   CVRRQLST+4
CVRVUPTR EQU   CVRRQLST
@NM00047 EQU   CVRPARM+9
@NM00046 EQU   CVRFLG1
CVRFCALL EQU   CVRFLG1
CVROFFLG EQU   CVRFLG1
CVRALFLG EQU   CVRFLG1
CVRAVFLG EQU   CVRFLG1
CVRGRPLK EQU   CVRPARM+6
CVRNREQ  EQU   CVRPARM+4
CVRRQPTR EQU   CVRPARM
ALGGCNTP EQU   ALGPTRS+12
ALGGLSTP EQU   ALGPTRS+8
ALGRQLTP EQU   ALGPTRS+4
ALGPARMP EQU   ALGPTRS
ALCPROCN EQU   NAMES+16
ALCSTEPN EQU   NAMES+8
ALCJOBN  EQU   NAMES
EXITPRMP EQU   ALCWA+144
CANCELP  EQU   ALCWA+140
WORK3MP  EQU   ALCWA+136
WMASK2P  EQU   ALCWA+132
WMASKPTR EQU   ALCWA+128
LGENLOCK EQU   ALCWA+124
TCBP     EQU   ALCWA+116
ALCWASID EQU   ALCWA+114
@NM00045 EQU   @NM00044
NODEVERR EQU   @NM00044
NEEDRCVY EQU   @NM00044
ALCWAREC EQU   @NM00044
UNITRECS EQU   @NM00044
ALCWADUL EQU   INDICATE
ALCWISAM EQU   INDICATE
DSSUNIT  EQU   INDICATE
DSSTAPE  EQU   INDICATE
PRIVASUM EQU   INDICATE
INDREQU  EQU   INDICATE
INDRETRY EQU   INDICATE
QMGRRBP  EQU   ALCWA+108
RIMTABCT EQU   ALCWA+104
RIMTABLN EQU   ALCWA+100
RIMTABP  EQU   ALCWA+96
ALGTABSZ EQU   ALCWA+92
@NM00043 EQU   ALCWA+78
LTUNITID EQU   ALCWA+76
NUMREQS  EQU   CNTABLE+40
OTHEREQS EQU   CNTABLE+32
SUBSREQS EQU   CNTABLE+28
STRGREQS EQU   CNTABLE+24
PUBLREQS EQU   CNTABLE+20
PVTNREQS EQU   CNTABLE+16
TPREQS   EQU   CNTABLE+8
VAMREQS  EQU   CNTABLE+4
DMYREQS  EQU   CNTABLE
EDTABPTR EQU   ALCWA+24
FAILRSCP EQU   ALCWA+20
IOSLUTP  EQU   ALCWA+16
WASIZE   EQU   ALCWA
VUGRID   EQU   VOLUNTAB+24
VUUCBP   EQU   VOLUNTAB+20
VURCVYPR EQU   VOLSTATD
VUVLUNIQ EQU   VOLSTATD
VUUNALSW EQU   VOLSTATD
VUREALOC EQU   VOLSTATD
VUMUGDON EQU   VOLSTATD
@NM00042 EQU   VOLSTATC
@NM00041 EQU   VOLSTATC
@NM00040 EQU   VOLSTATC
VOLURREQ EQU   VOLSTATC
VOLGRREQ EQU   VOLSTATC
VOLDAREQ EQU   VOLSTATC
VOLCOREQ EQU   VOLSTATC
VOLTAREQ EQU   VOLSTATC
VUAFFWRK EQU   VOLSTATB
VUPROCED EQU   VOLSTATB
VDEVREQD EQU   VOLSTATB
VOLMNTD  EQU   VOLSTATB
VOLDEFER EQU   VOLSTATA
VUDADSM  EQU   VOLSTATA
VOLRESVE EQU   VOLSTATA
VOLNSHR  EQU   VOLSTATA
VOLSTG   EQU   VOLSTATA
EXTRACAL EQU   FUNCMAP+1
ALCASDSN EQU   ASNMSW
ALCSUBWT EQU   WAITOKSW
ALCATRKM EQU   TRKMSW
ALCNOENQ EQU   NOTIOTNQ
ALCJOBNM EQU   MTRJOBSW
ALCHDMSG EQU   HDRMSGSW
@NM00039 EQU   FUNCMAP+1
ALCGENER EQU   GENLOKSW
ALCCANCL EQU   CCLMNTSW
ALCOFFDV EQU   OFFDEVSW
@NM00038 EQU   FUNCMAP
ALCWTVOL EQU   VWAITSW
ALCWTUNT EQU   UWAITSW
ALCMSGLV EQU   WRTMSGSW
ALCMOUNT EQU   VOLMNTSW
EDLNOJES EQU   EDLINDIC
EDLVOLAF EQU   EDLINDIC
EDLDADSM EQU   EDLINDIC
EDLALCD  EQU   EDLINDIC
EDLUCBAD EQU   EDLUCBL
EDLJINEL EQU   EDLGRFLG
EDLUCBNO EQU   EDLGNTRY+4
EDLNXGRP EQU   EDLGNTRY
EINDEVTP EQU   EDLDTFLG
@NM00037 EQU   EDLENTRY+18
EDLNSCNT EQU   EDLENTRY+16
EDLGRPNO EQU   EDLENTRY+8
EDLDEVT  EQU   EDLENTRY+4
EDLNXTNT EQU   EDLENTRY
EDLMGENS EQU   EDLUVFLG
EDLVAM   EQU   EDLUVFLG
EDLGMTP  EQU   EDLHDR+12
EDLGENNO EQU   EDLHDR+4
EDLLUV   EQU   EDLHDR
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00036
UCBHALI  EQU   @NM00036
UCBRSV09 EQU   @NM00036
UCBRSV08 EQU   @NM00036
UCBRSV07 EQU   @NM00036
UCBRSV06 EQU   @NM00036
UCBRSV05 EQU   @NM00036
UCBRSV04 EQU   @NM00036
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00033 EQU   UCB
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SJFCBPTR EQU   INDMSIOT+156
SIOTATE  EQU   INDMSIOT+144
SIOTEDLS EQU   INDMSIOT+132
SCTANAME EQU   INDMSIOT+122
@NM00032 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
SIODDQCR EQU   SIOTBYT2
SIOVDQCR EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00031 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00030 EQU   SIOTALTD
@NM00029 EQU   SIOTALTD
@NM00028 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00027 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00026 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00025 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00024 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
@NM00023 EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
@NM00022 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00021 EQU   SIOTTSTC
@NM00020 EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00019 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00018 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00017 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00178 EQU   @RC00168
@RC00071 EQU   @RC00063
@RC00066 EQU   @RC00063
@RF00099 EQU   @RC00063
@RC00101 EQU   @RC00063
@RC00143 EQU   @RC00063
@RC00234 EQU   @RC00226
@RC00232 EQU   @RC00226
@RC00241 EQU   @RC00226
@RC00247 EQU   @RC00226
@RC00253 EQU   @RC00226
@RC00269 EQU   @RC00267
@RF00306 EQU   @RC00282
@RC00294 EQU   @RC00282
@RF00378 EQU   @RC00372
@RC00374 EQU   @RC00372
@RF00310 EQU   @RC00280
@RC00333 EQU   @RC00280
@RC00078 EQU   @RC00071
@RC00073 EQU   @RC00071
@RC00103 EQU   @RC00101
@RC00133 EQU   @RC00101
@RC00145 EQU   @RC00143
@RF00184 EQU   @RC00143
@RC00300 EQU   @RC00294
@RC00295 EQU   @RC00294
@RC00339 EQU   @RC00333
@RC00363 EQU   @RC00333
@RC00357 EQU   @RC00333
@RC00109 EQU   @RC00103
@RC00105 EQU   @RC00103
@RC00120 EQU   @RC00103
@RC00115 EQU   @RC00103
@RF00389 EQU   @RC00363
@ENDDATA EQU   *
         END   IEFAB479,(C'PLS2017',0701,75314)

         TITLE '***** RSM V=R REGION ROUTINE IEAVEQR *****             *
                        '
*                                        /*                 @Z40WPYC*/
IEAVEQR  CSECT                                               @Z40WPYC
         MODID   BR=NO                                       @Z40WPYC
         ENTRY   IEAVEQR2                                    @Z40WPYC
IEAVEQR2 DS      0H                                          @Z40WPYC
ENT1     STM     @14,@12,12(@13)
         BALR    @15,0             ESTABLISH ADDR.
         USING   *,@15
         B       COMMON            COMMON ENTRY CODE
         DC      AL2(EP1-ENT1-6)   DISPLACEMENT FOR IEAVEQR
IEAVEQRI STM     @00,@15,PVTWSA3(PVTPTR)
         BALR    @15,0             ESTABLISH ADDR.
         USING   *,@15
         B       COMMON            COMMON ENTRY CODE
         DC      AL2(EP2-IEAVEQRI-6) DISPLACEMENT FOR IEAVEQRI
         ENTRY   IEAVEQRI
IEAVEQRC BALR    @15,0             ESTABLISH ADDRR
         USING   *,@15
         B       COMMON            COMMON ENTRY CODE
         DC      AL2(EP3-IEAVEQRC-2) DISPLACEMENT FOR IEAVEQRC
         ENTRY   IEAVEQRC
IEAVEQRF STM      @14,@12,12(@13)  SAVE REGS IS USER SAVE AREA
         BALR    @15,0             ESTABLISH ADDR.
         USING   *,@15
         B       COMMON            COMMON ENTRY CODE
         DC      AL2(EP4-IEAVEQRF-6) DISPLACEMENT FOR IEAVEQRF
         ENTRY   IEAVEQRF
IEAVEQRP BALR @15,0                ESTABLISH MODULE ADDR.
         USING *,@15
         B    COMMON               BRANCH TO COMMON CODE
         DC   AL2(EP5-IEAVEQRP-2)
         ENTRY IEAVEQRP
IEAVRMT  BALR @15,0               ESTABLISH MODULE ADDR.
         USING *,@15
         B   COMMON               BRANCH TO COMMON CODE
         DC    AL2(EP6-IEAVRMT-2)
         ENTRY IEAVRMT
         DROP    @15
COMMON   BALR    @12,0             ESTABLISH MODULE ADDR.
         USING   *,@12
COMMON1  EQU     *                                           @Z30GNYD
         USING   COMMON1+3840,@11  ESTABLISH 2ND BASE REG    @Z30GNYD
         LA      @11,3840(@12)                               @Z30GNYD
         AH      @15,4(@15)        ADD DISPLACEMENT FOR ADDRESS
         BR      @15               BRANCH TO CODE SECTION
EP1      DS      0H
*   INPUTPTR=REG1;                  /* INPUT PARAMETER LIST PTR      */
         LR    INPUTPTR,REG1                                       0077
*   CALL SETFRR;                    /* GO SET UP FRR AND PVT PRT   0078
*                                                            @ZA31128*/
*                                                                  0078
         BAL   @14,SETFRR                                          0078
*   /*****************************************************************/
*   /*                                                               */
*   /* FRR HAS BEEN SET UP SO CONTINUE WITH PROCESSING               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0079
*   RFY                                                            0079
*     RCA BASED(PVTPRCA);                                          0079
*   RCAVEQR=ON;                     /* SET ENTERED BIT ON            */
         L     @10,PVTPRCA(,PVTPTR)                                0080
         OI    RCAVEQR(@10),B'00001000'                            0080
*   RSMHDPTR=ASCBRSM;               /* RSM HEADER ADDRESS            */
         L     @10,ASCBPTR                                         0081
         L     RSMHDPTR,ASCBRSM(,@10)                              0081
*   MOTION=OFF;                     /* INIT SCHEDULE INDICATOR     0082
*                                                            @Z30GNYD*/
*                                                                  0082
         NI    MOTION(REG13),B'01111111'                           0082
*   /*****************************************************************/
*   /*                                                               */
*   /* IF START RBN IS WITHIN V=R BOUNDS THEN CONTINUE PROCESSING    */
*   /* REQUEST. OTHERWISE, SET RETURN CODE AND RETURN TO GETPART.    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0083
*   RESPECIFY                                                      0083
*     RSAVE RSTD;                                                  0083
*   RSAVE=(INPSTART/K4)*SIXTEEN;                                   0084
*                                                                  0084
         L     @00,INPSTART(,INPUTPTR)                             0084
         SRDA  @00,32                                              0084
         D     @00,@CF00054                                        0084
         SLA   @01,4                                               0084
         LR    RSAVE,@01                                           0084
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WITHIN BOUNDS THEN GET PCB WORKAREA.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0085
*   IF RSAVE>=PVTFVR&RSAVE<=PVTLVR THEN                            0085
         SLR   @10,@10                                             0085
         ICM   @10,3,PVTFVR(PVTPTR)                                0085
         CR    RSAVE,@10                                           0085
         BL    @RF00085                                            0085
         SLR   @10,@10                                             0085
         ICM   @10,3,PVTLVR(PVTPTR)                                0085
         CR    RSAVE,@10                                           0085
         BH    @RF00085                                            0085
*     DO;                           /* OBTAIN WORK AREA FROM PCB     */
*       RESPECIFY                                                  0087
*        (REG0,                                                    0087
*         REG1) RSTD;                                              0087
*       REG0=ONE;                   /* REQUEST FOR 1 PCB             */
         LA    REG0,1                                              0088
*       REG1=ZERO;                  /* INPUT 0                       */
         SLR   REG1,REG1                                           0089
*       CALL IEAVPCB;               /* CALL PCB MANAGER FOR PCBR     */
*                                                                  0090
         L     @15,PVTPCB(,PVTPTR)                                 0090
         BALR  @14,@15                                             0090
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE NOT ZERO, RC=16 RETURN                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0091
*       IF RCODE^=ZERO              /* NOT ABLE TO GET PCB           */
*         THEN                                                     0091
         LTR   RCODE,RCODE                                         0091
         BZ    @RF00091                                            0091
*         DO;                       /*                       @Z30GNYD*/
*           S15=SIXTEEN;            /* SET RETURN CODE = 16  @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0093
*           GOTO EXIT;              /* RETURN                @Z30GNYD*/
         B     EXIT                                                0094
*         END;                      /*                       @Z30GNYD*/
*       PCBRPTR=REG1;               /* PCBPTR CONTAINS PCBR ADDRESS  */
@RF00091 LR    PCBRPTR,REG1                                        0096
*       RESPECIFY                                                  0097
*        (REG0,                                                    0097
*         REG1) UNRSTD;                                            0097
*       STARTRBN=RSAVE;                                            0098
         ST    RSAVE,STARTRBN(,PCBRPTR)                            0098
*       PCBRASCB=ASCBPTR;                                          0099
         MVC   PCBRASCB(4,PCBRPTR),ASCBPTR                         0099
*       RESPECIFY                                                  0100
*         RSAVE UNRSTD;                                            0100
*       PCBRTCB=PSATOLD;            /* CALLER'S TCB ADDRESS          */
         MVC   PCBRTCB(4,PCBRPTR),PSATOLD                          0101
*       COMPSRB=ZERO;               /* CLEAR SAVE AREA OF SRB ADDR TO
*                                      BE USED TO SCHED IEAVEQRC   0102
*                                                            @Z30GNYD*/
         SLR   @10,@10                                             0102
         ST    @10,COMPSRB(,PCBRPTR)                               0102
*       POUTSRB=ZERO;               /* CLEAR SAVE AREA OF SRB ADDR TO
*                                      BE USED TO SCHED IEAVEQRP   0103
*                                                            @Z30GNYD*/
         ST    @10,POUTSRB(,REG13)                                 0103
*       LOOPFLAG=OFF;               /* SET LOOP PREVENTION FLAG TO 0104
*                                      ZERO                  @Z30GNYD*/
*                                                                  0104
         NI    LOOPFLAG(REG13),B'10111111'                         0104
*       /*************************************************************/
*       /*                                                           */
*       /* DO GETCELL FOR SRB TO BE USED TO SCHEDULE IEAVEQRC        */
*       /*                                                   @Z30GNYD*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0105
*GETCMSRB:                                                         0105
*       ;                           /*                       @Z30GNYD*/
GETCMSRB DS    0H                                                  0106
*       RFY                                                        0106
*        (REG0) RSTD;               /*                       @Z30GNYD*/
*       REG0=PVTSRBID;              /* SRB ID FOR GETCELL    @Z30GNYD*/
         L     REG0,PVTSRBID(,PVTPTR)                              0107
*       REG2=REG13;                 /* SAVE 13 ACROSS GETCELL      0108
*                                                            @Z30GNYD*/
         LR    REG2,REG13                                          0108
*       REG13=ADDR(PVTSAVE);        /* SAVEAREA ADDR FOR GETCELL   0109
*                                                            @Z30GNYD*/
         LA    REG13,PVTSAVE(,PVTPTR)                              0109
*       GEN(GETCELL CPID=(0),BRANCH=YES,SAVE=YES);/*         @Z30GNYD*/
         GETCELL CPID=(0),BRANCH=YES,SAVE=YES
*       REG13=REG2;                 /* RESTORE REGISTER 13   @Z30GNYD*/
         LR    REG13,REG2                                          0111
*       REG2=ASCBRSM;               /* RESTORE REGISTER 2    @Z30GNYD*/
         L     @10,ASCBPTR                                         0112
         L     REG2,ASCBRSM(,@10)                                  0112
*       RFY                                                        0113
*        (REG0) UNRSTD;             /*                       @Z30GNYD*/
*       IF RCODE^=ZERO&LOOPFLAG=OFF THEN                           0114
         LTR   RCODE,RCODE                                         0114
         BZ    @RF00114                                            0114
         TM    LOOPFLAG(REG13),B'01000000'                         0114
         BNZ   @RF00114                                            0114
*         DO;                       /* IF GETCELL FAILED, AND      0115
*                                      IEAVREP2 HAS NOT BEEN CALLED
*                                                            @Z30GNYD*/
*           LOOPFLAG=ON;            /* INDICATE IEAVREP2 HAS BEEN  0116
*                                      CALLED                @Z30GNYD*/
         OI    LOOPFLAG(REG13),B'01000000'                         0116
*           PVTPTR=CVTPVTP;         /* SET POINTER TO PVT    @Z30GNYD*/
         L     @10,CVTPTR                                          0117
         L     PVTPTR,CVTPVTP(,@10)                                0117
*           RFY                                                    0118
*            (REG14,                                               0118
*             REG15) RSTD;          /*                       @Z30GNYD*/
*           CALL IEAVREP2;          /* REPLENISH SRBS        @ZA31128*/
         L     @15,PVTREP2(,PVTPTR)                                0119
         BALR  @14,@15                                             0119
*           RFY                                                    0120
*            (REG14,                                               0120
*             REG15) UNRSTD;        /*                       @Z30GNYD*/
*           IF RCODE^=ZERO THEN     /* IF REPLENISH FAILED           */
         LTR   RCODE,RCODE                                         0121
         BZ    @RF00121                                            0121
*             DO;                   /*                       @Z30GNYD*/
*               S15=SIXTEEN;        /* SET RC = 16           @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0123
*               GOTO EXITCLR;       /* FREE PCB AND RETURN   @Z30GNYD*/
         B     EXITCLR                                             0124
*             END;                  /*                       @Z30GNYD*/
*           ELSE                                                   0126
*             GOTO GETCMSRB;        /* REPLENISH OK, GO TRY GETCELL
*                                      AGAIN                 @Z30GNYD*/
*         END;                      /*                       @Z30GNYD*/
*       ELSE                        /*                       @Z30GNYD*/
*         DO;                                                      0128
@RF00114 DS    0H                                                  0129
*           IF RCODE=ZERO THEN      /* IF GETCELL SUCCESSFUL @Z30GNYD*/
         LTR   RCODE,RCODE                                         0129
         BNZ   @RF00129                                            0129
*             DO;                                                  0130
*               COMPSRB=REG1;       /* SAVE COMPLETION SRB PTR     0131
*                                                            @Z30GNYD*/
         ST    REG1,COMPSRB(,PCBRPTR)                              0131
*               LOOPFLAG=OFF;       /* SET LOOP FLAG OFF     @Z30GNYD*/
         NI    LOOPFLAG(REG13),B'10111111'                         0132
*             END;                  /*                       @Z30GNYD*/
*           ELSE                                                   0134
*             DO;                                                  0134
         B     @RC00129                                            0134
@RF00129 DS    0H                                                  0135
*               S15=SIXTEEN;        /* SET REG 15=16         @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0135
*               GOTO EXITCLR;       /* GO FREE PCB AND RETURN      0136
*                                                            @Z30GNYD*/
         B     EXITCLR                                             0136
*             END;                  /*                       @Z30GNYD*/
*         END;                      /*                       @Z30GNYD*/
*                                                                  0138
@RC00129 DS    0H                                                  0139
*       /*************************************************************/
*       /*                                                           */
*       /* DO GETCELL FOR SRB TO BE USED TO SCHEDULE IEAVEQRP        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0139
*GETPOSRB:                                                         0139
*       ;                           /*                       @Z30GNYD*/
GETPOSRB DS    0H                                                  0140
*       RFY                                                        0140
*        (REG0) RSTD;               /*                       @Z30GNYD*/
*       REG0=PVTSRBID;              /* SRB ID FOR GETCELL    @Z30GNYD*/
         L     REG0,PVTSRBID(,PVTPTR)                              0141
*       REG2=REG13;                 /* SAVE 13 ACROSS GETCELL      0142
*                                                            @Z30GNYD*/
         LR    REG2,REG13                                          0142
*       REG13=ADDR(PVTSAVE);        /* SAVEAREA ADDR FOR GETCELL   0143
*                                                            @Z30GNYD*/
         LA    REG13,PVTSAVE(,PVTPTR)                              0143
*       GEN(GETCELL CPID=(0),BRANCH=YES,SAVE=YES);/*         @Z30GNYD*/
         GETCELL CPID=(0),BRANCH=YES,SAVE=YES
*       REG13=REG2;                 /* RESTORE REGISTER 13   @Z30GNYD*/
         LR    REG13,REG2                                          0145
*       REG2=ASCBRSM;               /* RESTORE REGISTER 2    @Z30GNYD*/
         L     @10,ASCBPTR                                         0146
         L     REG2,ASCBRSM(,@10)                                  0146
*       RFY                                                        0147
*        (REG0) UNRSTD;             /*                       @Z30GNYD*/
*       IF RCODE^=ZERO&LOOPFLAG=OFF THEN                           0148
         LTR   RCODE,RCODE                                         0148
         BZ    @RF00148                                            0148
         TM    LOOPFLAG(REG13),B'01000000'                         0148
         BNZ   @RF00148                                            0148
*         DO;                       /* IF GETCELL FAILED, AND      0149
*                                      IEAVREP2 HAS NOT BEEN CALLED
*                                                            @Z30GNYD*/
*           LOOPFLAG=ON;            /* INDICATE IEAVREP2 HAS BEEN  0150
*                                      CALLED                @Z30GNYD*/
         OI    LOOPFLAG(REG13),B'01000000'                         0150
*           RFY                                                    0151
*            (REG14,                                               0151
*             REG15) RSTD;          /*                       @Z30GNYD*/
*           CALL IEAVREP2;          /* REPLENISH SRBS        @ZA31128*/
         L     @15,PVTREP2(,PVTPTR)                                0152
         BALR  @14,@15                                             0152
*           RFY                                                    0153
*            (REG14,                                               0153
*             REG15) UNRSTD;        /*                       @Z30GNYD*/
*           IF RCODE=ZERO THEN      /* IF REPLENISH SUCCESSFUL       */
         LTR   RCODE,RCODE                                         0154
         BZ    @RT00154                                            0154
*             GOTO GETPOSRB;        /* SAVE PAGE OUT SRB PTR @Z30GNYD*/
*           ELSE                                                   0156
*             GOTO DETBNDS;         /* CONTINUE IF SRB NOT OBTAINED  */
         B     DETBNDS                                             0156
*         END;                      /*                       @Z30GNYD*/
*       ELSE                        /*                       @Z30GNYD*/
*         IF RCODE=ZERO THEN                                       0158
@RF00148 LTR   RCODE,RCODE                                         0158
         BNZ   @RF00158                                            0158
*           POUTSRB=REG1;           /* IF GETCELL SUCCESSFUL, SAVE 0159
*                                      SRB PTR               @Z30GNYD*/
         ST    REG1,POUTSRB(,REG13)                                0159
*         ELSE                                                     0160
*           GOTO DETBNDS;           /* CONTINUE, IF UNSUCCESSFUL   0160
*                                                            @Z30GNYD*/
*/*  IF NOT WITHIN BOUNDS, THEN SET RETURN CODE AND RETURN           */
*                                                                  0161
*     END;                                                         0161
*   ELSE                                                           0162
*     DO;                                                          0162
         B     @RC00085                                            0162
@RF00085 DS    0H                                                  0163
*       S15=SIXTEEN;                /* SET RETURN CODE TO 16 @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0163
*       GOTO EXIT;                  /*                       @Z30GNYD*/
         B     EXIT                                                0164
*     END;                                                         0165
*                                                                  0165
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP BOUNDS FOR V=R REGION, THEN CHECK IF STATED REGION IS  */
*   /* AVAILABLE BY LOOKING AT EACH FRAME PFTE.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0166
*DETBNDS:                                                          0166
*   ;                               /*                       @Z30GNYD*/
@RC00085 DS    0H                                                  0166
DETBNDS  DS    0H                                                  0167
*   DELTA=(INPAGES-ONE)*SIXTEEN;    /* PFTE LENGTH OF V=R REGION     */
         LH    @10,INPAGES(,INPUTPTR)                              0167
         BCTR  @10,0                                               0167
         SLA   @10,4                                               0167
         ST    @10,DELTA(,PCBRPTR)                                 0167
*   PFTEPTR=PVTPFTP+STARTRBN;       /* ADDR OF PFTE TABLE+RBN INCRE  */
*                                                                  0168
         L     PFTEPTR,PVTPFTP(,PVTPTR)                            0168
         AL    PFTEPTR,STARTRBN(,PCBRPTR)                          0168
*   /*****************************************************************/
*   /*                                                               */
*   /* IF LAST RBN IS NOT WITHIN V=R BOUNDS THEN SET RETURN CODE AND */
*   /* RETURN TO CALLER. OTHERWISE, CONTINUE PROCESSING.             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0169
*RESTART:                                                          0169
*   PCBRCNT=ZERO;                   /* GOOD FRAME COUNT=0    @ZA31128*/
RESTART  SLR   @10,@10                                             0169
         STH   @10,PCBRCNT(,PCBRPTR)                               0169
*   IF STARTRBN+DELTA>PVTLVR THEN                                  0170
         L     @10,STARTRBN(,PCBRPTR)                              0170
         AL    @10,DELTA(,PCBRPTR)                                 0170
         SLR   @09,@09                                             0170
         ICM   @09,3,PVTLVR(PVTPTR)                                0170
         CR    @10,@09                                             0170
         BNH   @RF00170                                            0170
*     DO;                           /*                       @Z30GNYD*/
*       S15=SIXTEEN;                /* RETURN CODE = 16              */
         MVC   S15(4,REG13),@CF00040                               0172
*       GOTO EXITCLR;               /* RETURN                @Z30GNYD*/
         B     EXITCLR                                             0173
*     END;                          /*                       @Z30GNYD*/
*                                                                  0174
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH ALL V=R FRAMES UNTIL THE NUMBER REQUIRED IS FOUND. IF  */
*   /* FRAME IS NOT ON THE AVAILABLE FRAME QUEUE, THEN CHECK FRAME   */
*   /* FOR UNDESIRABLE STATUS. IF THE FRAME HAS ONE OF THE CONDITIONS*/
*   /* THEN IT CAN NOT BE USED IN V=R REGION.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   DO UNTIL PCBRCNT=INPAGES;       /* DO TIL ENOUGH GOTTEN  @ZA31128*/
@RF00170 DS    0H                                                  0175
@DL00175 DS    0H                                                  0176
*     IF PFTONAVQ=OFF&              /* IF NOT ON AVQ, AND    @ZA31128*/
*         (PFTVRALC=ON×             /* NOW A V=R FRAME, OR   @ZA31128*/
*         PFTVRINT=ON×              /* V=R INTERCEPTED, OR   @ZA31128*/
*         PFTVRPLT=ON×              /* POLLUTES V=R AREA, OR @ZA31128*/
*         PFTOFINT=ON×              /* OFFLINE INTRCPTD, OR  @ZA31128*/
*         PFTBADPG=ON×              /* A BADPAGE, OR         @ZA31128*/
*         PFTOFFLN=ON×              /* OFFLINE, OR           @ZA31128*/
*         PFTQNDX=PFTSRQN) THEN     /* ON THE SQA RESERVE QUEUE, THEN
*                                      DO NOT ACCEPT THE FRAME.    0176
*                                                            @ZA31128*/
*                                                                  0176
         TM    PFTONAVQ(PFTEPTR),B'10000000'                       0176
         BNZ   @RF00176                                            0176
         TM    PFTVRALC(PFTEPTR),B'01010111'                       0176
         BNZ   @RT00176                                            0176
         TM    PFTOFFLN(PFTEPTR),B'01000000'                       0176
         BO    @RT00176                                            0176
         CLI   PFTQNDX(PFTEPTR),X'04'                              0176
         BNE   @RF00176                                            0176
@RT00176 DS    0H                                                  0177
*       /*************************************************************/
*       /*                                                           */
*       /* IF A SPECIFIC REGION WAS REQUESTED THEN RETURN TO CALLER  */
*       /* WITH RETURN CODE 16 SINCE AN UNAVAILABLE FRAME WAS FOUND  */
*       /* IN REGION. OTHERWISE, JUMP OVER UNAVAILABLE FRAME AND     */
*       /* BEGIN A NEW REGION SEARCH ON NEXT PFTE.                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0177
*       DO;                         /*                       @ZA31128*/
*         IF INPSPEC=ON THEN        /* IF ON, REQUEST SPECIFIC REGION*/
         TM    INPSPEC(INPUTPTR),B'10000000'                       0178
         BNO   @RF00178                                            0178
*           DO;                     /*                       @Z30GNYD*/
*             S15=SIXTEEN;          /* SET RETURN = 16       @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0180
*             GOTO EXITCLR;         /* RETURN                @Z30GNYD*/
         B     EXITCLR                                             0181
*           END;                    /*                       @Z30GNYD*/
*         PFTEPTR=PFTEPTR+LENGTH(PFTE);                            0183
@RF00178 AL    PFTEPTR,@CF00040                                    0183
*         STARTRBN=PFTEPTR-PVTPFTP; /* NEW START RBN VALUE           */
         LR    @10,PFTEPTR                                         0184
         SL    @10,PVTPFTP(,PVTPTR)                                0184
         ST    @10,STARTRBN(,PCBRPTR)                              0184
*         GOTO RESTART;             /* REPEAT SEARCH PROCESS         */
         B     RESTART                                             0185
*       END;                        /*                       @ZA31128*/
*                                                                  0186
*     /***************************************************************/
*     /*                                                             */
*     /* FRAME ACCEPTED FOR V=R REGION. INCREMENT COUNT OF FRAMES    */
*     /* OBTAINED, AND POINT TO THE NEXT PFTE. IF FRAME COUNT DOES   */
*     /* NOT EQUAL INPUT FRAME REQUEST THEN SEARCH WILL CONTINUE.    */
*     /* OTHERWISE, SEARCH IS COMPLETE.                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0187
*     ELSE                          /*                       @ZA31128*/
*       DO;                         /*                       @ZA31128*/
@RF00176 DS    0H                                                  0188
*         PCBRCNT=PCBRCNT+ONE;      /* INCR FRAME OBTAINED COUNT     */
         LA    @10,1                                               0188
         AH    @10,PCBRCNT(,PCBRPTR)                               0188
         STH   @10,PCBRCNT(,PCBRPTR)                               0188
*         PFTEPTR=PFTEPTR+LENGTH(PFTE);/* ADDR NEXT PFTE             */
         AL    PFTEPTR,@CF00040                                    0189
*       END;                        /*                       @ZA31128*/
*   END;                            /*                       @ZA31128*/
*                                                                  0191
@DE00175 CLC   PCBRCNT(2,PCBRPTR),INPAGES(INPUTPTR)                0191
         BNE   @DL00175                                            0191
*   /*****************************************************************/
*   /*                                                               */
*   /* FRAMES ARE NOW CHECKED FOR V=R REGION. DO GETMAIN FOR PAGE AND*/
*   /* EXTERNAL PAGE TABLES. IF REGION DOES NOT BEGIN OR END ON      */
*   /* SEGMENT BOUNDARY, THEN SEGMENT MAY HAVE ALREADY BE VALID. IF  */
*   /* THIS IS THE CASE, FREEMAIN DUPLICATE PAGE TABLES. THEN CHECK  */
*   /* THIS VALID SEGMENT TO SEE IF IT HAS ANY GETMAIN ASSIGNED PAGES*/
*   /* THAT FALL WITHIN THE BOUNDS OF THE V=R REGION. IF ANY EXISTS, */
*   /* PUT THE VSA OF THE FIRST FOUND IN THE INPUT PARAMETER AREA,   */
*   /* BACKOUT ALL SEGMENTS ACQUIRED AND THEIR PAGE TABLES, AND      */
*   /* RETURN TO GETPART.                                    @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0192
*   RFY                                                            0192
*    (PFTEPTR) UNRSTD;                                             0192
*   INPSTART=STARTRBN*N256;         /* CONVERT RBN TO VSA            */
         L     @10,STARTRBN(,PCBRPTR)                              0193
         LR    @09,@10                                             0193
         SLA   @09,8                                               0193
         ST    @09,INPSTART(,INPUTPTR)                             0193
*   RGNSTART=INPSTART;                                             0194
         ST    @09,RGNSTART(,PCBRPTR)                              0194
*   ENDRBN=STARTRBN+DELTA;          /* STORE ENDRBN IN PCBR          */
         LR    @09,@10                                             0195
         AL    @09,DELTA(,PCBRPTR)                                 0195
         ST    @09,ENDRBN(,PCBRPTR)                                0195
*   RGNEND=ENDRBN*N256;             /* VSA END ADDRESS FOR V=R       */
         LR    @07,@09                                             0196
         SLA   @07,8                                               0196
         ST    @07,RGNEND(,PCBRPTR)                                0196
*   STARTSEG=STARTRBN/N256;         /* START V=R SEGMENT NUMBER      */
         SRL   @10,8                                               0197
         STH   @10,STARTSEG(,PCBRPTR)                              0197
*   CURSEG=STARTSEG;                                               0198
         STH   @10,CURSEG(,PCBRPTR)                                0198
*   NSEG=((ENDRBN/N256)-STARTSEG)+ONE;                             0199
         SRL   @09,8                                               0199
         SLR   @09,@10                                             0199
         AH    @09,@CH00044                                        0199
         STH   @09,NSEG(,PCBRPTR)                                  0199
*   RESPECIFY                                                      0200
*    (REG0,                                                        0200
*     REG1,                                                        0200
*     REG4,                                                        0200
*     REG7,                                                        0200
*     REG5) RSTD;                                                  0200
*                                                                  0200
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW HAVE NUMBER OF WHOLE AND PARTIAL SEGMENTS. GETMAIN GETMAIN*/
*   /* SPACE FOR 1 SET OF PAGE TABLES.                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0201
*REATE:                                                            0201
*   SAVERCA=PVTPRCA;                                               0201
REATE    MVC   SAVERCA(4,PVTPTR),PVTPRCA(PVTPTR)                   0201
*   REG5=PVTPTR;                                                   0202
         LR    REG5,PVTPTR                                         0202
*   REG7=PCBRASCB;                                                 0203
         L     REG7,PCBRASCB(,PCBRPTR)                             0203
*   REG4=PSATOLD;                   /* INPUT REG TO GETMAIN          */
         L     REG4,PSATOLD                                        0204
*   REG0=(LENGTH(PGTPTE)+LENGTH(XPTE))*SIXTEEN;                    0205
         LA    REG0,224                                            0205
*   GENERATE(GETMAIN RU,LV=(0),SP=255,BRANCH=YES) ;                0206
         GETMAIN RU,LV=(0),SP=255,BRANCH=YES
*   PVTPTR=REG5;                                                   0207
         LR    PVTPTR,REG5                                         0207
*   PVTPRCA=SAVERCA;                                               0208
         MVC   PVTPRCA(4,PVTPTR),SAVERCA(PVTPTR)                   0208
*   RESPECIFY                                                      0209
*    (REG0,                                                        0209
*     REG7,                                                        0209
*     REG5) UNRSTD;                                                0209
*   WORK=REG1;                      /* SAVE GETMAIN AREA ADDRESS     */
*                                                                  0210
         ST    REG1,WORK(,PCBRPTR)                                 0210
*   /*****************************************************************/
*   /*                                                               */
*   /* SEE IF THE GETMAINED PAGE IS BACKED BY A V=R FRAME THAT HAS   */
*   /* BEEN SELECTED FOR THIS V=R REGION. IF SO, BACKOUT MUST BE     */
*   /* DONE. OTHERWISE THE ALLOCATION WILL HANG.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0211
*   GENERATE SETS(REG0) REFS(REG1);                                0211
         LRA   REG0,0(REG1) GET REAL ADDRESS OF LSQA PAGE   @ZA10767
         SRL   REG0,8       CONVERT TO AN RBN               @ZA10767
*   IF REG0<STARTRBN×REG0>ENDRBN THEN/* IN RGN BOUNDS ?      @ZA31128*/
         C     REG0,STARTRBN(,PCBRPTR)                             0212
         BL    @RT00212                                            0212
         C     REG0,ENDRBN(,PCBRPTR)                               0212
         BNH   @RF00212                                            0212
@RT00212 DS    0H                                                  0213
*     DO;                           /* NO                    @ZA31128*/
*                                                                  0213
*       /*************************************************************/
*       /*                                                           */
*       /* CALL CREATE SEGMENT TO INITIALIZE SEGMENT AND PAGE TABLES */
*       /* FOR V=R. XPTES ARE CREATED FOR V=R BUT ARE NEVER USED     */
*       /* SINCE THE REGION IS NOT PAGEABLE. IEAVCSGB CAN RETURN 3   */
*       /* RETURN CODES. 0 MEANS SUCCESSFUL, 4 MEANS UNSUCCESSFUL    */
*       /* (UNPREDICTABLE ERROR), AND 8 MEANS UNSUCCESSFUL (REQUESTED*/
*       /* SEGMENT ALREADY VALID).                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0214
*       CSGBRC=ZERO;                /* RETURN CODE WILL BE STORED  0214
*                                      HERE                  @Z30GNYD*/
         SLR   @10,@10                                             0214
         ST    @10,CSGBRC(,REG13)                                  0214
*       REG4=REG13;                 /* SAVE SAVE AREA ADDRESS        */
         LR    REG4,REG13                                          0215
*       RESPECIFY                                                  0216
*         REG0 RSTD;                                               0216
*       REG0=N256;                  /* 1 SEG TO CREATE       @ZA31128*/
         LA    REG0,256                                            0217
*       GENERATE(ICM   REG0,1,CURSEG+1(PCBRPTR)) ;                 0218
*                                                                  0218
         ICM   REG0,1,CURSEG+1(PCBRPTR)
*       /*************************************************************/
*       /*                                                           */
*       /* 0000NNXX START SEGMENT NUMBER                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0219
*       REG13=WSALRSM;              /* CREATE SEGMENTS SAVE AREA   0219
*                                                            @ZA30930*/
         L     @10,ASCBPTR                                         0219
         L     @10,ASXBPTR(,@10)                                   0219
         L     @10,ASXBSPSA(,@10)                                  0219
         L     REG13,WSALRSM(,@10)                                 0219
*       CALL IEAVCSGB;              /* CALL CREATE SEGMENT           */
         L     @15,PVTPCSGB(,PVTPTR)                               0220
         BALR  @14,@15                                             0220
*       RESPECIFY                                                  0221
*         RCODE RSTD;                                              0221
*       RCACSECT=RCACVR;                                           0222
         L     @14,PVTPRCA(,PVTPTR)                                0222
         MVI   RCACSECT(@14),X'05'                                 0222
*       RCAVEQR=ON;                                                0223
         OI    RCAVEQR(@14),B'00001000'                            0223
*       REG13=REG4;                                                0224
         LR    REG13,REG4                                          0224
*       RESPECIFY                                                  0225
*        (REG1,                                                    0225
*         REG4,                                                    0225
*         REG0) UNRSTD;                                            0225
*       IF RCODE=ZERO THEN          /* NEW SEG CREATED ?             */
         LTR   RCODE,RCODE                                         0226
         BNZ   @RF00226                                            0226
*         DO;                       /* YES, REG0 HAS ADDR FIRST PGTE */
*           IF CURSEG=ENDRBN/256 THEN/* ALL SEGS CREATED ?           */
         LH    @14,CURSEG(,PCBRPTR)                                0228
         L     @10,ENDRBN(,PCBRPTR)                                0228
         SRL   @10,8                                               0228
         CR    @14,@10                                             0228
         BE    @RT00228                                            0228
*             GOTO LOCALQ;          /* YES                           */
*           ELSE                    /* MORE SEGS TO CREATE   @ZA31128*/
*             DO;                   /*                       @ZA31128*/
*               CURSEG=CURSEG+1;    /* NO, INCRE CURRENT SEGMENT     */
         AH    @14,@CH00044                                        0231
         STH   @14,CURSEG(,PCBRPTR)                                0231
*               GOTO REATE;         /* LOOP AROUND                   */
         B     REATE                                               0232
*             END;                  /*                       @ZA31128*/
*         END;                                                     0234
*                                                                  0234
*       /*************************************************************/
*       /*                                                           */
*       /* CRSEG RC IS EITHER 4 OR 8. IF 8, REG0 CONTAINS SEGMENT    */
*       /* NUMBER OF A SEGMENT THAT IS ALREADY VALID. SAVE IT AND THE*/
*       /* RETURN CODE.                                      @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0235
*       SEGID=REG0;                 /* YES, SAVE ALREADY VALID SEG ID*/
@RF00226 STH   REG0,SEGID(,PCBRPTR)                                0235
*       CSGBRC=RCODE;               /* SAVE RETURN CODE FROM CRSEG   */
         ST    RCODE,CSGBRC(,REG13)                                0236
*     END;                          /*                       @ZA31128*/
*   ELSE                            /* PGT BACKED BY FRAME IN RGN  0238
*                                                            @ZA31128*/
*     CSGBRC=FOUR;                  /* BACKOUT ALL SEGMENTS ACQUIRED
*                                                            @ZA31128*/
*                                                                  0238
         B     @RC00212                                            0238
@RF00212 MVC   CSGBRC(4,REG13),@CF00036                            0238
*   /*****************************************************************/
*   /*                                                               */
*   /* FREEMAIN THE PAGE TABLES THAT WERE GETMAINED FOR THE SEGMENT  */
*   /* WE JUST TRIED TO CREATE.                              @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*   RESPECIFY                                                      0239
*    (REG7,                                                        0239
*     REG4,                                                        0239
*     REG1,                                                        0239
*     REG0,                                                        0239
*     REG5) RSTD;                                                  0239
@RC00212 DS    0H                                                  0240
*   SAVERCA=PVTPRCA;                                               0240
         MVC   SAVERCA(4,PVTPTR),PVTPRCA(PVTPTR)                   0240
*   REG5=PVTPTR;                                                   0241
         LR    REG5,PVTPTR                                         0241
*   REG7=PSAAOLD;                   /* ASCB ADDRESS                  */
         L     REG7,PSAAOLD                                        0242
*   REG4=PSATOLD;                   /* ZERO TCB ADDRESS              */
         L     REG4,PSATOLD                                        0243
*   REG0=16*(LENGTH(PGTPTE)+LENGTH(XPTE));                         0244
         LA    REG0,224                                            0244
*   REG1=WORK;                                                     0245
         L     REG1,WORK(,PCBRPTR)                                 0245
*   GEN(FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES) ;              0246
         FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES
*   PVTPTR=REG5;                                                   0247
         LR    PVTPTR,REG5                                         0247
*   PVTPRCA=SAVERCA;                                               0248
         MVC   PVTPRCA(4,PVTPTR),SAVERCA(PVTPTR)                   0248
*   IF CSGBRC=FOUR THEN             /* CRSEG ERROR OR V=R RGN FRAME
*                                      BACKING PAGE TABLES ? @ZA31128*/
         CLC   CSGBRC(4,REG13),@CF00036                            0249
         BNE   @RF00249                                            0249
*     DO;                           /* YES                   @ZA31128*/
*RSMERROR:                                                         0251
*       DO WHILE STARTSEG^=CURSEG;  /* DESTROY ALL SEGS CREATED    0251
*                                                            @ZA31128*/
RSMERROR B     @DE00251                                            0251
@DL00251 DS    0H                                                  0252
*         REG0=STARTSEG;            /* SEG TO DESTROY                */
         LH    REG0,STARTSEG(,PCBRPTR)                             0252
*         RFY                                                      0253
*           REG1 RSTD;                                             0253
*         CALL IEAVDSEG;            /* CALL DESTROY SEGMENT          */
         L     @15,PVTPDSEG(,PVTPTR)                               0254
         BALR  @14,@15                                             0254
*         RCACSECT=RCACVR;                                         0255
         L     @14,PVTPRCA(,PVTPTR)                                0255
         MVI   RCACSECT(@14),X'05'                                 0255
*         RCAVEQR=ON;                                              0256
*                                                                  0256
         OI    RCAVEQR(@14),B'00001000'                            0256
*         /***********************************************************/
*         /*                                                         */
*         /* IF REG1 = 0 THEN DESTROY COULD NOT DESTROY SEGMENT      */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0257
*         IF REG1^=0 THEN           /*                       @ZA31128*/
         LTR   REG1,REG1                                           0257
         BZ    @RF00257                                            0257
*           DO;                     /* FREEMAN PGT/XPT       @ZA31128*/
*             SAVERCA=PVTPRCA;                                     0259
         ST    @14,SAVERCA(,PVTPTR)                                0259
*             REG5=PVTPTR;                                         0260
         LR    REG5,PVTPTR                                         0260
*             REG7=PSAAOLD;         /* ASCB ADDRESS                  */
         L     REG7,PSAAOLD                                        0261
*             REG4=PSATOLD;         /* ZERO TCB ADDRESS              */
         L     REG4,PSATOLD                                        0262
*             REG0=SIXTEEN*(LENGTH(PGTPTE)+LENGTH(XPTE));          0263
         LA    REG0,224                                            0263
*             GEN(FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES) ;    0264
         FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES
*             RFY                                                  0265
*               REG1 UNRSTD;                                       0265
*             PVTPTR=REG5;                                         0266
         LR    PVTPTR,REG5                                         0266
*             PVTPRCA=SAVERCA;                                     0267
*                                                                  0267
         L     @14,SAVERCA(,PVTPTR)                                0267
         ST    @14,PVTPRCA(,PVTPTR)                                0267
*             /*******************************************************/
*             /*                                                     */
*             /* IF NOT ZERO RETURN CODE, ABEND C0D AND CONTINUE     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0268
*             IF RCODE^=0 THEN                                     0268
         LTR   RCODE,RCODE                                         0268
         BZ    @RF00268                                            0268
*               DO;                 /*                       @ZA31128*/
*                 RCARCRD=3;                                       0270
         MVI   RCARCRD(@14),X'03'                                  0270
*                 GEN(ABEND X'C0D',,,SYSTEM) ;                     0271
         ABEND X'C0D',,,SYSTEM
*               END;                                               0272
*           END;                    /*                       @ZA31128*/
@RF00268 DS    0H                                                  0274
*         STARTSEG=STARTSEG+1;      /* NEXT SEGMENT          @ZA31128*/
@RF00257 LA    @14,1                                               0274
         AH    @14,STARTSEG(,PCBRPTR)                              0274
         STH   @14,STARTSEG(,PCBRPTR)                              0274
*       END;                                                       0275
*                                                                  0275
@DE00251 CLC   STARTSEG(2,PCBRPTR),CURSEG(PCBRPTR)                 0275
         BNE   @DL00251                                            0275
*       /*************************************************************/
*       /*                                                           */
*       /* ALL CREATED SEGMENTS HAVE BEEN DESTROYED.                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0276
*       IF INPSPEC=ON THEN          /* SPECIFIC REQUEST ?    @ZA31128*/
         TM    INPSPEC(INPUTPTR),B'10000000'                       0276
         BNO   @RF00276                                            0276
*         S15=SIXTEEN;              /* YES, RC=16            @ZA31128*/
         MVC   S15(4,REG13),@CF00040                               0277
*       ELSE                        /* NO                    @ZA31128*/
*         S15=EIGHT;                /* RC=8                  @ZA31128*/
         B     @RC00276                                            0278
@RF00276 MVC   S15(4,REG13),@CF00038                               0278
*       GOTO EXITCLR;               /* GOTO EXIT AND RETURN  @Z30GNYD*/
         B     EXITCLR                                             0279
*     END;                          /*                       @ZA31128*/
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* A VALID SEGMENT WAS FOUND WITHIN V=R REGION SEGMENTS (CRSEG   */
*   /* RETURN CODE = 8). IF THE SEGMENT IS THE FIRST OR LAST AND NO  */
*   /* PAGE THAT IS WITHIN THE V=R REGION IS GETMAIN ASSIGNED, THEN  */
*   /* EVERYTHING IS O.K. THE DUPLICATE SET OF PAGE TABLES HAS       */
*   /* ALREADY BEEN FREEMAINED.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0281
*   ELSE                            /* CRSEG RC WAS 8        @ZA31128*/
*     DO;                           /*                       @ZA31128*/
@RF00249 DS    0H                                                  0282
*       RESPECIFY                                                  0282
*        (REG7,                                                    0282
*         REG4,                                                    0282
*         REG5) UNRSTD;             /*                       @ZA31128*/
*       REG1=SEGID*K64;             /* VSA OF SEGMENT        @ZA31128*/
         LH    REG1,SEGID(,PCBRPTR)                                0283
         SLA   REG1,16                                             0283
*       RESPECIFY                                                  0284
*         CURVSA RSTD;                                             0284
*       CURVSA=REG1;                /* CURRENT ADDRESS               */
         LR    CURVSA,REG1                                         0285
*       CALL IEAVFP2;               /* FIND PGTE FOR SEGMENT         */
         L     @15,PVTPFP2(,PVTPTR)                                0286
         BALR  @14,@15                                             0286
*       IF RCODE^=ZERO THEN         /* FINDPAGE ERROR ?              */
         LTR   RCODE,RCODE                                         0287
         BZ    @RF00287                                            0287
*         DO;                       /* YES, RECORD IT                */
*           RCARCRD=1;                                             0289
         L     @01,PVTPRCA(,PVTPTR)                                0289
         MVI   RCARCRD(@01),X'01'                                  0289
*           GENERATE(ABEND X'C0D',,,SYSTEM) ;                      0290
         ABEND X'C0D',,,SYSTEM
*           GOTO RSMERROR;          /* FREEMAIN ALL GOTTEN AREA      */
         B     RSMERROR                                            0291
*         END;                                                     0292
*       RESPECIFY                                                  0293
*         PTEPTR RSTD;                                             0293
@RF00287 DS    0H                                                  0294
*       PTEPTR=REG0;                /* PGTE RELATED TO VSA           */
*                                                                  0294
         LR    PTEPTR,REG0                                         0294
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK EACH PGTE FOR ASSIGNED BIT. IF ON AND PAGE IS IN V=R*/
*       /* REGION THEN FREEMAIN DUPLICATE PAGE TABLES.       @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0295
*       DO REG0=16 TO 1 BY-1;       /* LOOK AT ALL PGTES     @ZA31128*/
*                                                                  0295
         LA    REG0,16                                             0295
@DL00295 DS    0H                                                  0296
*         /***********************************************************/
*         /*                                                         */
*         /* SEE IF THE PAGE IS GETMAIN ASSIGNED AND IN THE V=R      */
*         /* REGION. (NOTE: FOR CONVENIENCE, ALL 16 PGTE'S ARE       */
*         /* CHECKED EVEN THOUGH ONCE THE FIRST PGTE FOR A PAGE ABOVE*/
*         /* THE V=R REGION IS FOUND, IT IS NOT NECESSARY TO CHECK   */
*         /* FURTHER.)                                       @ZA31128*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0296
*         IF PGTPAM=ON&             /* IF GETMAIN ASSIGNED,  @ZA31128*/
*             CURVSA>=INPSTART&     /* AND WITHIN THE V=R    @ZA31128*/
*             CURVSA<(INPSTART+(INPAGES*K4)) THEN/* RGN THEN @ZA31128*/
         TM    PGTPAM(PTEPTR),B'00000001'                          0296
         BNO   @RF00296                                            0296
         L     @14,INPSTART(,INPUTPTR)                             0296
         CR    CURVSA,@14                                          0296
         BL    @RF00296                                            0296
         LH    @10,INPAGES(,INPUTPTR)                              0296
         SLA   @10,12                                              0296
         ALR   @14,@10                                             0296
         CR    CURVSA,@14                                          0296
         BNL   @RF00296                                            0296
*           DO;                     /* MUST BACKOUT CREATED SEGS     */
*             INPSTART=CURVSA;      /* RETURN OVERLAP ADDRESS        */
         ST    CURVSA,INPSTART(,INPUTPTR)                          0298
*             GOTO RSMERROR;                                       0299
         B     RSMERROR                                            0299
*           END;                    /*                       @ZA31128*/
*         ELSE                      /*                       @ZA31128*/
*           DO;                     /*                       @ZA31128*/
@RF00296 DS    0H                                                  0302
*             CURVSA=CURVSA+K4;     /* INCRE TO NEXT PAGE            */
         AL    CURVSA,@CF00054                                     0302
*             PTEPTR=PTEPTR+LENGTH(PGTPTE);                        0303
         AH    PTEPTR,@CH00058                                     0303
*           END;                    /*                       @ZA31128*/
*       END;                        /*                       @ZA31128*/
*                                                                  0305
         BCTR  REG0,0                                              0305
         LTR   REG0,REG0                                           0305
         BP    @DL00295                                            0305
*       /*************************************************************/
*       /*                                                           */
*       /* ALL PGTES FOR THE SEGMENT HAVE BEEN CHECKED, AND THERE    */
*       /* WERE NO GETMAIN ASSIGNED PAGES IN THE V=R REGION. SEE IF  */
*       /* MORE SEGMENTS ARE REQUIRED.                       @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0306
*       NSEG=NSEG-1;                /* DECR NUMBER OF SEGS REQ'D     */
*                                                                  0306
         LH    @14,NSEG(,PCBRPTR)                                  0306
         BCTR  @14,0                                               0306
         STH   @14,NSEG(,PCBRPTR)                                  0306
*       /*************************************************************/
*       /*                                                           */
*       /* IF MORE THAN 1 SEGMENT REQUIRED, THEN RESET STARTSEG AND  */
*       /* CURSEG, AND GO GETMAIN PAGE TABLES AND CREATE REMAINING   */
*       /* SEGMENTS.                                         @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0307
*       IF NSEG^=ZERO THEN          /* MORE THAN 1 SEG REQ'D ?     0307
*                                                            @ZA31128*/
         LTR   @14,@14                                             0307
         BZ    @RF00307                                            0307
*         DO;                       /* YES                   @ZA31128*/
*           IF SEGID=STARTSEG THEN  /* OVERLAP IN 1ST SEG ?  @ZA31128*/
         LH    @14,STARTSEG(,PCBRPTR)                              0309
         CH    @14,SEGID(,PCBRPTR)                                 0309
         BNE   @RF00309                                            0309
*             DO;                   /* YES                           */
*               STARTSEG=STARTSEG+1;                               0311
         AH    @14,@CH00044                                        0311
         STH   @14,STARTSEG(,PCBRPTR)                              0311
*               CURSEG=STARTSEG;                                   0312
         STH   @14,CURSEG(,PCBRPTR)                                0312
*               GOTO REATE;         /* GOTO GETMAIN AND CREATE AGAIN */
         B     REATE                                               0313
*             END;                                                 0314
*         END;                                                     0315
@RF00309 DS    0H                                                  0316
*     END;                          /* END CRSEG RC WAS 8    @ZA31128*/
@RF00307 DS    0H                                                  0317
*   RESPECIFY                                                      0317
*    (CURVSA,                                                      0317
*     PTEPTR,                                                      0317
*     REG0,                                                        0317
*     REG1) UNRSTD;                                                0317
*                                                                  0318
*   /*****************************************************************/
*   /*                                                               */
*   /* AT THIS POINT IN THE PROGRAM, ALL V=R REGION FRAMES HAVE PAGE */
*   /* TABLES SET UP FOR THEM. NOW CHECK WHAT QUEUE THE FRAME IS ON. */
*   /* THE FIRST AND LAST V=R PGTE PAM BIT MUST BE TURNED ON TO      */
*   /* PREVENT SEGMENT INVALIDATION.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0318
*   RFY                                                            0318
*    (PTEPTR,                                                      0318
*     REG0,                                                        0318
*     REG1,                                                        0318
*     REG5) RSTD;                                                  0318
*LOCALQ:                                                           0319
*   REG5=STARTRBN;                  /* DO FIRST RBN                  */
*                                                                  0319
LOCALQ   L     REG5,STARTRBN(,PCBRPTR)                             0319
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL FINDPAGE FOR PGTE ADDRESS OF FIRST V=R REGION PAGE.      */
*   /* INDICATE THAT IT IS GETMAINED ASSIGNED. THEN REPEAT FOR THE   */
*   /* LAST V=R REGION PAGE.                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0320
*PAMIT:                                                            0320
*   REG1=REG5*256;                  /* GET VIRTUAL ADDRESS           */
PAMIT    LR    REG1,REG5                                           0320
         SLA   REG1,8                                              0320
*   CALL IEAVFP2;                   /* GET PGTE ADDRESS              */
         L     @15,PVTPFP2(,PVTPTR)                                0321
         BALR  @14,@15                                             0321
*   IF RCODE^=0 THEN                                               0322
         LTR   RCODE,RCODE                                         0322
         BZ    @RF00322                                            0322
*     DO;                           /* IF 0 CONTINUE, ELSE CLEAN UP
*                                      AREA                          */
*       RCARCRD=1;                  /* TURN ON INDICATOR             */
         L     @14,PVTPRCA(,PVTPTR)                                0324
         MVI   RCARCRD(@14),X'01'                                  0324
*       GEN( ABEND X'C0D',,,SYSTEM) ;                              0325
          ABEND X'C0D',,,SYSTEM
*       GOTO RSMERROR;              /* GO CLEAN UP REGION            */
         B     RSMERROR                                            0326
*     END;                                                         0327
*   PTEPTR=REG0;                    /* SET UP PGTE ADDRESS           */
@RF00322 LR    PTEPTR,REG0                                         0328
*   PGTPAM='1'B;                    /* TURN ON PAM BIT               */
*                                                                  0329
         OI    PGTPAM(PTEPTR),B'00000001'                          0329
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MOTION IS 0 THEN WORKING ON FIRST PGTE. IF NOT THEN ON LAST*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0330
*   IF MOTION=OFF THEN              /* FIRST PASS THROUGH    @Z30GNYD*/
         TM    MOTION(REG13),B'10000000'                           0330
         BNZ   @RF00330                                            0330
*     DO;                                                          0331
*       MOTION=ON;                  /* INDICATE SECOND TIME THROUGH
*                                                            @Z30GNYD*/
         OI    MOTION(REG13),B'10000000'                           0332
*       REG5=ENDRBN;                /* DO LAST RBN                   */
         L     REG5,ENDRBN(,PCBRPTR)                               0333
*       GOTO PAMIT;                 /* NOW TURN ON LAST PGTE PAM BIT */
         B     PAMIT                                               0334
*     END;                                                         0335
*   MOTION=OFF;                     /* RESET MOTION                  */
@RF00330 NI    MOTION(REG13),B'01111111'                           0336
*   RFY                                                            0337
*    (REG0,                                                        0337
*     REG5,                                                        0337
*     PTEPTR) UNRSTD;                                              0337
*   PCBRCNT=ZERO;                   /* INIT COUNTER TO ZERO          */
         SLR   @14,@14                                             0338
         STH   @14,PCBRCNT(,PCBRPTR)                               0338
*   RFY                                                            0339
*     PFTEPTR RSTD;                                                0339
*   PFTEPTR=STARTRBN+PVTPFTP;       /* FIRST PFTE ADDR IN REGION     */
*                                                                  0340
         L     PFTEPTR,STARTRBN(,PCBRPTR)                          0340
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0340
*   /*****************************************************************/
*   /*                                                               */
*   /* TURN ON THE V=R INTERCEPTED FLAG IN ALL PFTE'S OF THE V=R     */
*   /* REGION BEING ALLOCATED. THIS IS DONE TO PREVENT THE ALLOCATION*/
*   /* FROM HANGING, WHICH CAN OCCUR AS FOLLOWS. DURING A PAGEOUT    */
*   /* FROM V=R MAINLINE, IEAVSQA COULD TAKE A FRAME IN THE POTENTIAL*/
*   /* V=R REGION IN ORDER TO BACK AN SQA GETMAIN REQUEST THAT       */
*   /* RESULTED FROM EXPANSION OF THE PCB POOL IN ORDER TO GET A PCB */
*   /* FOR THE PAGEOUT. IEAVSQA WILL RECOGNIZE AN INTERCEPTED FRAME, */
*   /* AND WILL CALL V=R INTERCEPT WITH THE ROOT FAIL FLAG ON TO FAIL*/
*   /* THE ALLOCATION. HOWEVER, IF THE FRAME WAS NOT INTERCEPTED, THE*/
*   /* ALLOCATION WILL HANG SINCE THE FRAME WILL NEVER BE FREED.     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   RFY                                                            0341
*     COUNT RSTD;                   /*                       @ZA10767*/
*   REG1=PFTEPTR;                   /* INIT FRAME POINTER    @ZA10767*/
         LR    REG1,PFTEPTR                                        0342
*   DO COUNT=INPAGES TO 1 BY-1;     /*                       @ZA10767*/
         LH    COUNT,INPAGES(,INPUTPTR)                            0343
         B     @DE00343                                            0343
@DL00343 DS    0H                                                  0344
*     REG1->PFTVRINT='1'B;          /* INDICATE FRAME INTERCEPTED  0344
*                                                            @ZA10767*/
         OI    PFTVRINT(REG1),B'01000000'                          0344
*     REG1=REG1+LENGTH(PFTE);       /* POINT TO NEXT PFTE    @ZA10767*/
         AL    REG1,@CF00040                                       0345
*   END;                            /*                       @ZA10767*/
         BCTR  COUNT,0                                             0346
@DE00343 LTR   COUNT,COUNT                                         0346
         BP    @DL00343                                            0346
*   RFY                                                            0347
*    (COUNT,                                                       0347
*     REG1) UNRSTD;                 /*                       @ZA10767*/
*                                                                  0347
*   /*****************************************************************/
*   /*                                                               */
*   /* EXAMINE EACH FRAME CHOSEN FOR THE V=R REGION. IF IT IS ON THE */
*   /* AFQ (IE. IS AVAILABLE NOW), MOVE IT TO THE LOCAL FRAME QUEUE. */
*   /*                                                       @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0348
*   DO WORK=INPAGES TO 1 BY-1;      /* CHECK EACH FRAME      @ZA31128*/
         LH    @14,INPAGES(,INPUTPTR)                              0348
         ST    @14,WORK(,PCBRPTR)                                  0348
         B     @DE00348                                            0348
@DL00348 DS    0H                                                  0349
*     IF PFTONAVQ=ON THEN           /* IS FRAME ON AFQ ?             */
         TM    PFTONAVQ(PFTEPTR),B'10000000'                       0349
         BNO   @RF00349                                            0349
*       DO;                         /* FRAME IS ON AFQ               */
*         RESPECIFY                                                0351
*           REG1 RSTD;                                             0351
*         RSMHDPTR=ASCBRSM;         /* RESTORE RSMHD POINTER @YA01572*/
         L     @14,ASCBPTR                                         0352
         L     RSMHDPTR,ASCBRSM(,@14)                              0352
*         RSMCNTFX=RSMCNTFX+1;      /* INCREMENT LOCAL FIX COUNT   0353
*                                                            @YA01572*/
         LA    @14,1                                               0353
         LH    @10,RSMCNTFX(,RSMHDPTR)                             0353
         ALR   @10,@14                                             0353
         STH   @10,RSMCNTFX(,RSMHDPTR)                             0353
*         PVTCNTFX=PVTCNTFX+1;      /* INCREMENT SYSTEM COUNT      0354
*                                                            @YA01572*/
         AH    @14,PVTCNTFX(,PVTPTR)                               0354
         STH   @14,PVTCNTFX(,PVTPTR)                               0354
*         IF PVTCNTFX=PVTMAXFX THEN /* HAS THE FIX COUNT THRESHOLD 0355
*                                      BEEN REACHED                  */
         CH    @14,PVTMAXFX(,PVTPTR)                               0355
         BNE   @RF00355                                            0355
*           DO;                     /* YES, NOTIFY SRM       @YA01572*/
*             REG1=FOUR;            /* GET CODE FOR FIX THRESHOLD  0357
*                                      REACHED               @YA01572*/
         LA    REG1,4                                              0357
*             REG2=REG13;           /* SAVE REGISTER 13 ACROSS     0358
*                                      SYSEVENT              @YA01572*/
         LR    REG2,REG13                                          0358
*             REG13=ADDR(PVTSAVE);  /* GET SRM A SAVE AREA   @YA01572*/
*                                                                  0359
         LA    REG13,PVTSAVE(,PVTPTR)                              0359
*             /*******************************************************/
*             /*                                                     */
*             /* NOTIFY SRM THAT THE FIXED THRESHOLD HAS BEEN REACHED*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0360
*             GEN REFS(CVT,CVTPTR,CVTOPTE) SETS(REG0,REG14,REG15)  0360
*                 (SYSEVENT AVQLOW,ENTRY=BRANCH);                  0360
         SYSEVENT AVQLOW,ENTRY=BRANCH
*             REG13=REG2;           /* RESTORE REG13         @YA01572*/
         LR    REG13,REG2                                          0361
*             RSMHDPTR=ASCBRSM;     /* RESTORE RSMHD POINTER @YA01572*/
         L     @14,ASCBPTR                                         0362
         L     RSMHDPTR,ASCBRSM(,@14)                              0362
*           END;                                                   0363
*         PFTASID=ASCBASID;         /* PUT ASID IN PFTE              */
@RF00355 L     @14,ASCBPTR                                         0364
         MVC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    0364
*         PFTVBN=PFTEPTR-PVTPFTP;                                  0365
         LR    @14,PFTEPTR                                         0365
         SL    @14,PVTPFTP(,PVTPTR)                                0365
         STH   @14,PFTVBN(,PFTEPTR)                                0365
*         PFTVRALC=ON;              /* TURN ON VRALC BIT             */
*         PFTVRINT='0'B;            /* TURN OFF V=R INTCPTD  @ZA10767*/
         OI    PFTVRALC(PFTEPTR),B'00000010'                       0367
         NI    PFTVRINT(PFTEPTR),B'10111111'                       0367
*         PFTIRRG='0'B;                                            0368
         NI    PFTIRRG(PFTEPTR),B'11101111'                        0368
*         RESPECIFY                                                0369
*           REG0 RSTD;                                             0369
*         REG0=PFTLFQN;                                            0370
         LA    REG0,128                                            0370
*         GENERATE;                                                0371
         SLL   REG0,16                 GET NUMBER IN HIGH ORDER BYTES
         ICM   REG0,3,PFTVBN(PFTEPTR)  INSERT VBN
*         REG1=PCBRASCB;                                           0372
         L     REG1,PCBRASCB(,PCBRPTR)                             0372
*         CALL IEAPFTE;             /* MOVE PFTE TO LOCAL QUEUE      */
         L     @15,PVTPFTE(,PVTPTR)                                0373
         BALR  @14,@15                                             0373
*         RESPECIFY                                                0374
*          (REG0,                                                  0374
*           REG1) UNRSTD;                                          0374
*       END;                                                       0375
*     ELSE                          /* FRAME NOT ON AFQ              */
*       DO;                                                        0376
*                                                                  0376
         B     @RC00349                                            0376
@RF00349 DS    0H                                                  0377
*         /***********************************************************/
*         /*                                                         */
*         /* PLACE THE ROOT PCB ON THE V=R ROOT QUEUE (IF IT IS NOT  */
*         /* ALREADY THERE) SINCE AT LEAST ONE FRAME IS STILL MARKED */
*         /* AS INTERCEPTED.                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0377
*         IF PVTVROOT^=PCBRPTR THEN /* ROOT ALREADY ON Q ?           */
         L     @14,PVTVROOT(,PVTPTR)                               0377
         CR    @14,PCBRPTR                                         0377
         BE    @RF00377                                            0377
*           DO;                     /* NO, ENQUEUE IT                */
*             PCBRECB=INPECBP;                                     0379
         MVC   PCBRECB(4,PCBRPTR),INPECBP(INPUTPTR)                0379
*             NEXTPCB=PVTVROOT;                                    0380
         ST    @14,NEXTPCB(,PCBRPTR)                               0380
*             PVTVROOT=PCBRPTR;                                    0381
         ST    PCBRPTR,PVTVROOT(,PVTPTR)                           0381
*             PCBRLOAD='1'B;        /* INDICATE MAINLINE IS STILL  0382
*                                      SCANNING                      */
         OI    PCBRLOAD(PCBRPTR),B'00000100'                       0382
*           END;                                                   0383
*         PCBRCNT=PCBRCNT+ONE;      /* COUNT UNAVAILABLE FRAMES      */
*                                                                  0384
@RF00377 LA    @14,1                                               0384
         AH    @14,PCBRCNT(,PCBRPTR)                               0384
         STH   @14,PCBRCNT(,PCBRPTR)                               0384
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE FRAME IS FOR VIO, A PAGEOUT CANNOT BE DONE SINCE */
*         /* THERE IS NO ASID IN THE PFTE. A PAGEOUT CAN ONLY BE DONE*/
*         /* FOR A FRAME THAT BELONGS TO THE CURRENT ADDRESS SPACE OR*/
*         /* THE COMMON AREA, AND DOES NOT HAVE I/O IN PROGRESS FOR  */
*         /* IT. (NOTE: THE TEST FOR A FIXED FRAME IS REMOVED BY APAR*/
*         /* OZ31128, SINCE ANY FIXES WOULD HAVE HAD PFTVRPLT ON, AND*/
*         /* THEREFORE WOULD HAVE BEEN SKIPPED.)             @ZA31128*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0385
*         RFY                                                      0385
*           REG1 RSTD;                                             0385
*         IF PFTIRRG=OFF&           /* IF FRAME NOT IRREG, AND     0386
*                                                            @ZA31128*/
*             (PFTASID=ASCBASID×PFTASID=COMASID)&/* COMMON OR      0386
*                                      CURRENT, AND                  */
*             PFTPCBSI=OFF THEN     /* NO I/O, THEN PAGE OUT @ZA31128*/
         TM    PFTIRRG(PFTEPTR),B'00010000'                        0386
         BNZ   @RF00386                                            0386
         L     @14,ASCBPTR                                         0386
         CLC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    0386
         BE    @GL00010                                            0386
         CLC   PFTASID(2,PFTEPTR),COMASID                          0386
         BNE   @RF00386                                            0386
@GL00010 TM    PFTPCBSI(PFTEPTR),B'00001000'                       0386
         BNZ   @RF00386                                            0386
*           DO;                                                    0387
*             REG0=0;               /* ZERO ECB ADDRESS              */
         SLR   REG0,REG0                                           0388
*             REG1=PFTVBN*256;      /* VIRTUAL BEGIN ADDRESS         */
         SLR   REG1,REG1                                           0389
         ICM   REG1,3,PFTVBN(PFTEPTR)                              0389
         SLA   REG1,8                                              0389
*             REG2=REG1+4096;       /* VIRTUAL END ADDRESS           */
         LR    REG2,REG1                                           0390
         AL    REG2,@CF00054                                       0390
*             GEN SETS(REG2) REFS(PGOUT)(ICM   REG2,8,PGOUT);      0391
         ICM   REG2,8,PGOUT
*             REG4=PSATOLD;         /* CURRENT ASCB                  */
         L     REG4,PSATOLD                                        0392
*             CALL PSII;            /* BRANCH ENTRY TO PSI           */
         L     @15,PVTPSINT(,PVTPTR)                               0393
         BALR  @14,@15                                             0393
*             REG2=ASCBRSM;         /* RESTORE RSMHDR ADDRESS        */
         L     @14,ASCBPTR                                         0394
         L     REG2,ASCBRSM(,@14)                                  0394
*           END;                                                   0395
*         ELSE                      /* CANNOT DO PAGEOUT             */
*           DO;                                                    0396
         B     @RC00386                                            0396
@RF00386 DS    0H                                                  0397
*             IF MOTION=OFF THEN    /* PGOUT SRB SCHEDULED ? @ZA31128*/
         TM    MOTION(REG13),B'10000000'                           0397
         BNZ   @RF00397                                            0397
*               DO;                 /* NO, SCHEDULE IT       @ZA31128*/
*                 IF POUTSRB=ZERO THEN/* ANY SRB PTR ?       @ZA31128*/
         ICM   @14,15,POUTSRB(REG13)                               0399
         BNZ   @RF00399                                            0399
*                   DO;             /* NO, ISSUE ABENDC0D            */
*                     RCARCRD=2;    /* INDICATOR FOR THIS SITUATION  */
         L     @14,PVTPRCA(,PVTPTR)                                0401
         MVI   RCARCRD(@14),X'02'                                  0401
*                     GEN(ABEND X'C0D',,,SYSTEM) ;                 0402
         ABEND X'C0D',,,SYSTEM
*                   END;                                           0403
*                 ELSE                                             0404
*                   DO;                                            0404
         B     @RC00399                                            0404
@RF00399 DS    0H                                                  0405
*                     REG1=POUTSRB; /* SRB PTR TO REG1       @Z30GNYD*/
         L     REG1,POUTSRB(,REG13)                                0405
*                     RFY                                          0406
*                       SRBSECT BASED(REG1);/*               @ZA10767*/
*                     PCBRPOF='1'B;                                0407
         OI    PCBRPOF(PCBRPTR),B'00000001'                        0407
*                     MOTION=ON;    /* INDICATE SRB SCHEDULED      0408
*                                                            @Z30GNYD*/
         OI    MOTION(REG13),B'10000000'                           0408
*                     POUTSRB=ZERO; /* PAGE OUT SRB HAS BEEN USED. 0409
*                                      IEAVEQRP WILL FREE IT.      0409
*                                                            @Z30GNYD*/
         SLR   @14,@14                                             0409
         ST    @14,POUTSRB(,REG13)                                 0409
*                     SRBSECT=SRBSECT&&SRBSECT;/* CLEAR SRB AREA   0410
*                                                            @ZA10767*/
         XC    SRBSECT(44,REG1),SRBSECT(REG1)                      0410
*                     SRBID='SRB '; /* INIT CONTROL BLOCK NAME       */
         MVC   SRBID(4,REG1),@CC02307                              0411
*                     SRBPASID=PSAAOLD->ASCBASID;/* CURRENT ASID   0412
*                                                            @ZA10767*/
         L     @10,PSAAOLD                                         0412
         MVC   SRBPASID(2,REG1),ASCBASID(@10)                      0412
*                     SRBASCB=ASVTENTY(PFTASID);/* SRBASCB ADDR      */
         SLR   @10,@10                                             0413
         ICM   @10,3,PFTASID(PFTEPTR)                              0413
         SLA   @10,2                                               0413
         L     @09,CVTPTR                                          0413
         L     @09,ASVTPTR(,@09)                                   0413
         L     @10,ASVTENTY-4(@10,@09)                             0413
         ST    @10,SRBASCB(,REG1)                                  0413
*                     SRBEP=PVTPVRPO;/* ENTRY POINT                  */
         MVC   SRBEP(4,REG1),PVTPVRPO(PVTPTR)                      0414
*                     SRBRMTR=ADDR(IEAVRMT);                       0415
         L     @10,@CV02275                                        0415
         ST    @10,SRBRMTR(,REG1)                                  0415
*                     SRBPTCB=ZERO; /* TCB ADDR              @ZA10767*/
         ST    @14,SRBPTCB(,REG1)                                  0416
*                     SRBPARM=PCBRPTR;/* PCBR ADDR                   */
         ST    PCBRPTR,SRBPARM(,REG1)                              0417
*                     GEN(SCHEDULE SRB=(1),SCOPE=GLOBAL);          0418
         SCHEDULE SRB=(1),SCOPE=GLOBAL
*                     RFY                                          0419
*                       SRBSECT BASED(SRBPTR);/*             @ZA10767*/
*                   END;                                           0420
*               END;                                               0421
@RC00399 DS    0H                                                  0422
*           END;                    /*                       @ZA31128*/
@RF00397 DS    0H                                                  0423
*         RFY                                                      0423
*           REG1 UNRSTD;                                           0423
@RC00386 DS    0H                                                  0424
*       END;                                                       0424
*     PFTEPTR=PFTEPTR+LENGTH(PFTE); /* ADDR NEXT FRAME               */
@RC00349 AL    PFTEPTR,@CF00040                                    0425
*   END;                            /*                       @ZA31128*/
*                                                                  0426
         SLR   @14,@14                                             0426
         BCTR  @14,0                                               0426
         AL    @14,WORK(,PCBRPTR)                                  0426
         ST    @14,WORK(,PCBRPTR)                                  0426
@DE00348 LTR   @14,@14                                             0426
         BP    @DL00348                                            0426
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL FRAMES HAVE BEEN CHECKED TO SEE IF THEY COULD BE TAKEN OR */
*   /* PAGED OUT NOW. IF ALL COULD NOT BE, THE PAGEOUT SRB HAS BEEN  */
*   /* SCHEDULED. IF PCBRCNT=0, THEN ALL FRAMES ARE ON THE ON LOCAL  */
*   /* FRAME QUEUE. A ROOT PCB IS NOT REQUIRED, SO RETURN TO GETPART */
*   /* WITH RETURN CODE 0 (IE. V=R REGION BUILT). OTHERWISE, PCBRCNT */
*   /* IS THE NUMBER OF UNAVAILABLE FRAMES THAT WILL BE INTERCEPTED  */
*   /* WHEN GIVEN UP AND SENT TO AFQ. A ROOT PCB MUST BE BUILT TO    */
*   /* HANDLE INTERCEPTED FRAMES.                            @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0427
*   RESPECIFY                                                      0427
*    (PFTEPTR) UNRSTD;                                             0427
*   PCBRLOAD='0'B;                  /* INDICATE ALL FRAMES CHECKED 0428
*                                                            @ZA31128*/
         NI    PCBRLOAD(PCBRPTR),B'11111011'                       0428
*   IF PCBRCNT=ZERO THEN                                           0429
         ICM   @14,3,PCBRCNT(PCBRPTR)                              0429
         BNZ   @RF00429                                            0429
*     DO;                                                          0430
*                                                                  0430
*       /*************************************************************/
*       /*                                                           */
*       /* IF PCBR IS QUEUED, UNQUEUE IT. COUNT HAS GONE TO ZERO SO  */
*       /* WILL FREE PCBR BEFORE EXITING                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0431
*       IF PVTVROOT=PCBRPTR THEN                                   0431
         C     PCBRPTR,PVTVROOT(,PVTPTR)                           0431
         BNE   @RF00431                                            0431
*         PVTVROOT=NEXTPCB;         /* UNCHAIN ROOT PCB, BUT FREE IT
*                                      AFTER VALIDATE                */
         MVC   PVTVROOT(4,PVTPTR),NEXTPCB(PCBRPTR)                 0432
*       CALL VALIDATE;              /* REGION VALIDATION SUBROUTINE  */
*                                                                  0433
@RF00431 BAL   @14,VALIDATE                                        0433
*       /*************************************************************/
*       /*                                                           */
*       /* IF RETURN CODE DOES NOT = ZERO, THEN BACK OUT             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0434
*       IF RCODE^=0 THEN                                           0434
         SLR   @14,@14                                             0434
         CR    RCODE,@14                                           0434
         BE    @RF00434                                            0434
*         DO;                                                      0435
*           RGNSTART=0;             /* LOOP INDICATOR                */
         ST    @14,RGNSTART(,PCBRPTR)                              0436
*           REG1=STARTRBN*256;      /* VIRTUAL ADDRESS TO FIND PAGE  */
*                                                                  0437
         L     REG1,STARTRBN(,PCBRPTR)                             0437
         SLA   REG1,8                                              0437
*           /*********************************************************/
*           /*                                                       */
*           /* CALL FINDPAGE AND GET PGTE ADDRESS TO TURN OFF PAM BIT*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0438
*OFFIT:                                                            0438
*           CALL IEAVFP2;           /* CALL FINDPAGE                 */
*                                                                  0438
OFFIT    L     @15,PVTPFP2(,PVTPTR)                                0438
         BALR  @14,@15                                             0438
*           /*********************************************************/
*           /*                                                       */
*           /* IF ERROR, COD AND CONTINUE                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0439
*           IF RCODE^=0 THEN        /* IF NOT ZERO THEN ERROR        */
         LTR   RCODE,RCODE                                         0439
         BZ    @RF00439                                            0439
*             DO;                                                  0440
*               RCARCRD=1;          /* INDICATE TYPE OF ERROR        */
         L     @14,PVTPRCA(,PVTPTR)                                0441
         MVI   RCARCRD(@14),X'01'                                  0441
*               GEN(ABEND X'C0D',,,SYSTEM) ;                       0442
         ABEND X'C0D',,,SYSTEM
*             END;                                                 0443
*           ELSE                    /* FINDPAGE WENT OK      @ZA31128*/
*             DO;                   /*                       @ZA31128*/
         B     @RC00439                                            0444
@RF00439 DS    0H                                                  0445
*               PTEPTR=REG0;        /* PGTE ADDRESS OF ENTRY         */
         LR    PTEPTR,REG0                                         0445
*               PGTPAM='0'B;        /* TURN OFF PAM BIT              */
         NI    PGTPAM(PTEPTR),B'11111110'                          0446
*             END;                  /*                       @ZA31128*/
*                                                                  0447
*           /*********************************************************/
*           /*                                                       */
*           /* RGNSTART IS 0 FIRST TIME THROUGH, AND IS 1 SECOND     */
*           /* TIME.                                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0448
*           IF RGNSTART=0 THEN      /* IF 0 THEN FIRST TIME THRU     */
@RC00439 ICM   @14,15,RGNSTART(PCBRPTR)                            0448
         BNZ   @RF00448                                            0448
*             DO;                                                  0449
*               RGNSTART=1;         /* INDICATE SECOND TIME THROUGH  */
         MVC   RGNSTART(4,PCBRPTR),@CF00044                        0450
*               REG1=ENDRBN*256;    /* NOW DO IT FOR END PAGE        */
         L     REG1,ENDRBN(,PCBRPTR)                               0451
         SLA   REG1,8                                              0451
*               GOTO OFFIT;         /* DO IT AGAIN FOR LAST PAGE     */
         B     OFFIT                                               0452
*             END;                                                 0453
*           CURSEG=STARTSEG;                                       0454
@RF00448 MVC   CURSEG(2,PCBRPTR),STARTSEG(PCBRPTR)                 0454
*           RESPECIFY                                              0455
*             REG0 RSTD;                                           0455
*                                                                  0455
*           /*********************************************************/
*           /*                                                       */
*           /* DESTROY EACH SEGMENT AND FREEMAIN ITS PAGE TABLES     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0456
*           DO WHILE NSEG^=0;       /*                       @ZA31128*/
         B     @DE00456                                            0456
@DL00456 DS    0H                                                  0457
*             RESPECIFY                                            0457
*              (REG1,                                              0457
*               REG4,                                              0457
*               REG5,                                              0457
*               REG7) RSTD;                                        0457
*             REG0=CURSEG;                                         0458
         LH    REG0,CURSEG(,PCBRPTR)                               0458
*             CALL IEAVDSEG;        /* CALL DESTROY SEGMENT          */
         L     @15,PVTPDSEG(,PVTPTR)                               0459
         BALR  @14,@15                                             0459
*             SAVERCA=PVTPRCA;                                     0460
         MVC   SAVERCA(4,PVTPTR),PVTPRCA(PVTPTR)                   0460
*             REG5=PVTPTR;                                         0461
         LR    REG5,PVTPTR                                         0461
*             REG4=PSATOLD;                                        0462
         L     REG4,PSATOLD                                        0462
*             REG7=PSAAOLD;                                        0463
         L     REG7,PSAAOLD                                        0463
*             REG0=16*(LENGTH(PGTPTE)+LENGTH(XPTE));               0464
         LA    REG0,224                                            0464
*             GEN(FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES);     0465
         FREEMAIN RC,LV=(0),SP=255,A=(1),BRANCH=YES
*             PVTPTR=REG5;                                         0466
         LR    PVTPTR,REG5                                         0466
*             PVTPRCA=SAVERCA;                                     0467
         MVC   PVTPRCA(4,PVTPTR),SAVERCA(PVTPTR)                   0467
*             RESPECIFY                                            0468
*              (REG0,                                              0468
*               REG1,                                              0468
*               REG4,                                              0468
*               REG5,                                              0468
*               REG7) UNRSTD;                                      0468
*             CURSEG=CURSEG+1;                                     0469
         LA    @14,1                                               0469
         AH    @14,CURSEG(,PCBRPTR)                                0469
         STH   @14,CURSEG(,PCBRPTR)                                0469
*             NSEG=NSEG-1;                                         0470
         LH    @14,NSEG(,PCBRPTR)                                  0470
         BCTR  @14,0                                               0470
         STH   @14,NSEG(,PCBRPTR)                                  0470
*           END;                    /*                       @ZA31128*/
*                                                                  0471
@DE00456 ICM   @14,3,NSEG(PCBRPTR)                                 0471
         BNZ   @DL00456                                            0471
*           /*********************************************************/
*           /*                                                       */
*           /* DEQUEUE EACH FRAME AND SEND TO AVAILABLE FRAME QUEUE  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0472
*           PFTEPTR=STARTRBN+PVTPFTP;                              0472
         L     @14,STARTRBN(,PCBRPTR)                              0472
         LR    PFTEPTR,@14                                         0472
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0472
*           RESPECIFY                                              0473
*             REG0 RSTD;                                           0473
*                                                                  0473
*           /*********************************************************/
*           /*                                                       */
*           /* TURN OFF PFTVRALC BIT AND DEQUEUE ALL PFTES.          */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0474
*           DO REG0=STARTRBN TO ENDRBN BY 16;                      0474
         LR    REG0,@14                                            0474
         B     @DE00474                                            0474
@DL00474 DS    0H                                                  0475
*             PFTVRALC=OFF;                                        0475
*             PFTVRINT=OFF;                                        0476
         NI    PFTVRALC(PFTEPTR),B'10111101'                       0476
*             RSMCNTFX=RSMCNTFX-1;  /* DECREMENT LOCAL FIX COUNT   0477
*                                                            @YA01572*/
         LH    @14,RSMCNTFX(,RSMHDPTR)                             0477
         BCTR  @14,0                                               0477
         STH   @14,RSMCNTFX(,RSMHDPTR)                             0477
*             PVTCNTFX=PVTCNTFX-1;  /* DECREMENT SYSTEM COUNT      0478
*                                                            @YA01572*/
         LH    @14,PVTCNTFX(,PVTPTR)                               0478
         BCTR  @14,0                                               0478
         STH   @14,PVTCNTFX(,PVTPTR)                               0478
*             CALL IEAPFTE;         /* AFQ Q ID MUST BE X'00'        */
         L     @15,PVTPFTE(,PVTPTR)                                0479
         BALR  @14,@15                                             0479
*             PFTEPTR=PFTEPTR+LENGTH(PFTE);                        0480
         AL    PFTEPTR,@CF00040                                    0480
*           END;                                                   0481
         AL    REG0,@CF00040                                       0481
@DE00474 C     REG0,ENDRBN(,PCBRPTR)                               0481
         BNH   @DL00474                                            0481
*           S15=SIXTEEN;            /* SET RETURN CODE = 16  @Z30GNYD*/
         MVC   S15(4,REG13),@CF00040                               0482
*           GOTO EXITCLR;           /* RETURN                @Z30GNYD*/
         B     EXITCLR                                             0483
*           RESPECIFY                                              0484
*             REG0 UNRSTD;                                         0484
*         END;                                                     0485
*       ASCBVEQR=ON;                /* TURN ON BIT INDICATING THAT 0486
*                                      THIS ADDRESS SPACE SHOULD NOT
*                                      BE SWAPPED-OUT UNTIL THIS V=R
*                                      REGION HAS BEEN FREED VIA   0486
*                                      FREEPART.             @ZA16816*/
@RF00434 L     @09,ASCBPTR                                         0486
         L     @14,ASCBVEQR(,@09)                                  0486
@GL00013 LR    @10,@14                                             0486
         O     @10,@CF02389                                        0486
         CS    @14,@10,ASCBVEQR(@09)                               0486
         BNE   @GL00013                                            0486
*       S15=ZERO;                   /* SET RETURN=0, RETURN  @Z30GNYD*/
         SLR   @14,@14                                             0487
         ST    @14,S15(,REG13)                                     0487
*     END;                                                         0488
*   ELSE                                                           0489
*                                                                  0489
*     /***************************************************************/
*     /*                                                             */
*     /* SINCE PCBRCNT^=0, THEN SOME FRAMES HAVE PFTVRINT BIT SET.   */
*     /* KEEP PCBR INORDER TO COLLECT FRAMES                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0489
*     DO;                           /*                       @Z30GNYD*/
         B     @RC00429                                            0489
@RF00429 DS    0H                                                  0490
*       ASCBVEQR=ON;                /* TURN ON BIT INDICATING THAT 0490
*                                      THIS ADDRESS SPACE SHOULD NOT
*                                      BE SWAPPED-OUT UNTIL THIS V=R
*                                      REGION HAS BEEN FREED VIA   0490
*                                      FREEPART.             @ZA16816*/
         L     @09,ASCBPTR                                         0490
         L     @14,ASCBVEQR(,@09)                                  0490
@GL00014 LR    @10,@14                                             0490
         O     @10,@CF02389                                        0490
         CS    @14,@10,ASCBVEQR(@09)                               0490
         BNE   @GL00014                                            0490
*       S15=FOUR;                   /* SET RETURN=4, AND RETURN    0491
*                                                            @Z30GNYD*/
         MVC   S15(4,REG13),@CF00036                               0491
*       GOTO FPOUTSRB;              /* FREE SRB AND RETURN   @Z30GNYD*/
         B     FPOUTSRB                                            0492
*     END;                          /*                       @Z30GNYD*/
*                                                                  0493
*   /*****************************************************************/
*   /*                                                               */
*   /* DEQUEUE WORK PCB                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0494
*EXITCLR:                           /*                       @Z30GNYD*/
*   RESPECIFY                                                      0494
*    (REG0,                                                        0494
*     REG1) RSTD;                                                  0494
@RC00429 DS    0H                                                  0494
EXITCLR  DS    0H                                                  0495
*   IF COMPSRB^=ZERO THEN           /* IF A SRB WAS GOTTEN FOR     0495
*                                      COMPLETION THEN FREE THE SRB
*                                                            @Z30GNYD*/
         L     @14,COMPSRB(,PCBRPTR)                               0495
         LTR   @14,@14                                             0495
         BZ    @RF00495                                            0495
*     DO;                           /*                       @Z30GNYD*/
*       REG1=COMPSRB;               /* ADDR OF COMPLETION SRB      0497
*                                                            @Z30GNYD*/
         LR    REG1,@14                                            0497
*       REG0=PVTSRBID;              /* SRB ID TO FREE        @Z30GNYD*/
         L     REG0,PVTSRBID(,PVTPTR)                              0498
*       REG2=REG13;                 /* SAVE SAVE PTR ACROSS FREECELL
*                                                            @Z30GNYD*/
         LR    REG2,REG13                                          0499
*       REG13=ADDR(PVTSAVE);        /* SET SAVE AREA PTR FOR FREECELL
*                                                            @Z30GNYD*/
         LA    REG13,PVTSAVE(,PVTPTR)                              0500
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES);/*     0501
*                                                            @Z30GNYD*/
         FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES
*       REG13=REG2;                 /* RESTORE POINTER TO SAVE AREA
*                                                            @Z30GNYD*/
         LR    REG13,REG2                                          0502
*       REG2=ASCBRSM;               /* RESTORE REGISTER 2    @Z30GNYD*/
         L     @14,ASCBPTR                                         0503
         L     REG2,ASCBRSM(,@14)                                  0503
*     END;                          /*                       @Z30GNYD*/
*   PCBFQP=FREECB;                                                 0505
@RF00495 MVC   PCBFQP(4,PCBRPTR),FREECB                            0505
*   REG0=PCBFREQN;                  /* TQID OF TO Q, FREE PCB Q      */
         LA    REG0,16                                             0506
*   REG1=PCBRPTR;                   /* PCBR ADDRESS TO DEQUEUE       */
         LR    REG1,PCBRPTR                                        0507
*   CALL IEAVPCB;                   /* PCB MANAGER                   */
         L     @15,PVTPCB(,PVTPTR)                                 0508
         BALR  @14,@15                                             0508
*FPOUTSRB:                                                         0509
*   ;                                                              0509
FPOUTSRB DS    0H                                                  0510
*   IF POUTSRB^=ZERO THEN           /* IF A SRB WAS GOTTEN FOR PAGE
*                                      OUTS THEN FREE THE SRB      0510
*                                                            @Z30GNYD*/
         L     @14,POUTSRB(,REG13)                                 0510
         LTR   @14,@14                                             0510
         BZ    @RF00510                                            0510
*     DO;                           /*                       @Z30GNYD*/
*       REG1=POUTSRB;               /* ADDR OF PAGE OUT SRB  @Z30GNYD*/
         LR    REG1,@14                                            0512
*       REG0=PVTSRBID;              /* SRB ID TO FREE        @Z30GNYD*/
         L     REG0,PVTSRBID(,PVTPTR)                              0513
*       REG2=REG13;                 /* SAVE SAVE AREA PTR ACROSS   0514
*                                      FREECELL              @Z30GNYD*/
         LR    REG2,REG13                                          0514
*       REG13=ADDR(PVTSAVE);        /* SET SAVE PTR FOR FREECELL   0515
*                                                            @Z30GNYD*/
         LA    REG13,PVTSAVE(,PVTPTR)                              0515
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES);/*     0516
*                                                            @Z30GNYD*/
         FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES
*       REG13=REG2;                 /* RESTORE SAVE AREA PTR @Z30GNYD*/
         LR    REG13,REG2                                          0517
*       REG2=ASCBRSM;               /* RESTORE PTR TO RSM HEADER   0518
*                                                            @Z30GNYD*/
         L     @14,ASCBPTR                                         0518
         L     REG2,ASCBRSM(,@14)                                  0518
*     END;                          /*                       @Z30GNYD*/
*   RESPECIFY                                                      0520
*    (REG0,                                                        0520
*     REG1) UNRSTD;                                                0520
*                                                                  0520
@RF00510 DS    0H                                                  0521
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE REGS AND RETURN                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0521
*EXIT:                                                             0521
*   ;                                                              0521
EXIT     DS    0H                                                  0522
*   GEN SETS(REG1,REG2)(SETFRR D,WRKREGS=(1,2));/*           @ZA31128*/
         SETFRR D,WRKREGS=(1,2)
*   LM(REG14,REG12,CALLREGS(13:72));/* RESTORE REGS          @ZA31128*/
         LM    REG14,REG12,CALLREGS+12(REG13)                      0523
*   GOTO REG14;                     /* RETURN TO GETPART     @ZA31128*/
         BR    REG14                                               0524
*   RESPECIFY                                                      0525
*    (INPUTPTR,                                                    0525
*     PVTPTR,                                                      0525
*     RSMHDPTR,                                                    0525
*     PCBRPTR) UNRSTD;                                             0525
*SETFRR:                                                           0526
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);/*                     @ZA31128*/
*                                                                  0526
SETFRR   DS    0H                                                  0527
*   /*****************************************************************/
*   /*                                                               */
*   /* SETFRR GETS EXECUTED WHEN ANY V=R ROUTINE NEEDS THE SETFRR    */
*   /* FUNCTION. REGISTER 14 CONTAINS THE RETURN ADDRESS. REGS 1,2,10*/
*   /* GET CLOBBERED. REG3 GETS INITIALIZED TO THE ADDRESS OF THE    */
*   /* PVT. RCACVR BYTE IN RCA IS SET UP PVTPRCA FIELD OF PVT        */
*   /* CONTAINS ADDRESS OF RCA AREA.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0527
*   RFY                                                            0527
*    (REG1,                                                        0527
*     REG2,                                                        0527
*     REG10,                                                       0527
*     REG11,                                                       0527
*     REG12,                                                       0527
*     REG14) RSTD;                  /*                       @YA01572*/
*   PVTPTR=CVTPVTP;                 /* PVT PTR IN CVT                */
         L     @09,CVTPTR                                          0528
         L     PVTPTR,CVTPVTP(,@09)                                0528
*   REG10=PVTPRCV;                  /* RECOVERY ROUTINE ADDR         */
         L     REG10,PVTPRCV(,PVTPTR)                              0529
*   GEN(SETFRR A,FRRAD=(REG10),WRKREGS=(1,2),PARMAD=(2));/*  @ZA31128*/
         SETFRR A,FRRAD=(REG10),WRKREGS=(1,2),PARMAD=(2)
*   PVTPRCA=REG2;                   /* INITIALIZE THE PVTPRCA FIELD  */
         ST    REG2,PVTPRCA(,PVTPTR)                               0531
*   RCACSECT=RCACVR;                /* SET CSECT IN CONTROL BYTE     */
         L     @09,PVTPRCA(,PVTPTR)                                0532
         MVI   RCACSECT(@09),X'05'                                 0532
*   RFY                                                            0533
*    (REG1,                                                        0533
*     REG2,                                                        0533
*     REG10,                                                       0533
*     REG11,                                                       0533
*     REG12,                                                       0533
*     REG14) UNRSTD;                /*                       @YA01572*/
*   END SETFRR;                     /*                       @ZA31128*/
@EL00002 DS    0H                                                  0534
@EF00002 DS    0H                                                  0534
@ER00002 BR    @14                                                 0534
*VALIDATE:                                                         0535
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0535
*                                                                  0535
VALIDATE DS    0H                                                  0536
*/********************************************************************/
*/*VALIDATE ROUTINE GETS CONTROL FROM ALLOCATION AND COMPLETE ROUTNES*/
*/*WHEN ALL V=R FRAMES ARE ON EITHER THEIR LOCAL QUEUE(ALLOCATION)   */
*/*OR ARE NOT QUEUED(CALLED FROM COMPLETE).  IF THE FRAME IS NOT     */
*/*ALREADY ON LOCAL QUEUE, IT IS MOVED THERE.  THE PGTE'S ARE FILLED */
*/*IN, STORAGE KEYS ARE SET, AND THE REGION IS CLEARED TO 0'S.       */
*/********************************************************************/
*                                                                  0536
*   RFY                                                            0536
*    (RSMHDPTR,                                                    0536
*     PVTPTR,                                                      0536
*     PTEPTR,                                                      0536
*     PFTEPTR,                                                     0536
*     VRBN,                                                        0536
*     PCBRPTR) RSTD;                                               0536
*   WORK=REG14;                     /* SAVE RETURN ADDRESS           */
         ST    REG14,WORK(,PCBRPTR)                                0537
*   PFTEPTR=STARTRBN+PVTPFTP;                                      0538
         L     PFTEPTR,STARTRBN(,PCBRPTR)                          0538
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0538
*   VRBN=RGNSTART;                                                 0539
         L     VRBN,RGNSTART(,PCBRPTR)                             0539
*   DO UNTIL VRBN>RGNEND;           /* PROCESS ALL PAGES     @ZA31128*/
*                                                                  0540
@DL00540 DS    0H                                                  0541
*     /***************************************************************/
*     /*                                                             */
*     /* IF IT IS INITIAL PAGE, OR FIRST PAGE OF A NEW SEGMENT, THEN */
*     /* A FINDPAGE MUST BE DONE.                            @ZA31128*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0541
*     IF((VRBN&SEGMASK)=0)×(VRBN=RGNSTART) THEN/* FP REQ'D ? @ZA31128*/
         LR    @14,VRBN                                            0541
         N     @14,SEGMASK                                         0541
         LTR   @14,@14                                             0541
         BZ    @RT00541                                            0541
         C     VRBN,RGNSTART(,PCBRPTR)                             0541
         BNE   @RF00541                                            0541
@RT00541 DS    0H                                                  0542
*       DO;                         /* YES, DO FINDPAGE AGAIN        */
*         RFY                                                      0543
*          (REG0,                                                  0543
*           REG1) RSTD;             /*                       @ZA31128*/
*         REG1=VRBN;                                               0544
         LR    REG1,VRBN                                           0544
*         CALL IEAVFP2;             /* LOCATE PGTE FOR VSA           */
         L     @15,PVTPFP2(,PVTPTR)                                0545
         BALR  @14,@15                                             0545
*         IF RCODE^=0 THEN          /* FINDPAGE OK ?                 */
         LTR   RCODE,RCODE                                         0546
         BNZ   @RT00546                                            0546
*           GOTO ENDVAL;            /* NO, RETURN                    */
*         PTEPTR=REG0;              /* PGTE ADDRESS FOR VSA          */
         LR    PTEPTR,REG0                                         0548
*         RFY                                                      0549
*          (REG0) UNRSTD;           /*                       @ZA31128*/
*       END;                        /*                       @ZA31128*/
*     PGTRSA=PFTEPTR-PVTPFTP;       /* RBN TO PGTE                   */
@RF00541 LR    @14,PFTEPTR                                         0551
         SL    @14,PVTPFTP(,PVTPTR)                                0551
         STH   @14,PGTRSA(,PTEPTR)                                 0551
*     PGTPAM=ON;                    /* ASSIGNED =ON , PGTPVM = OFF   */
*                                                                  0552
         OI    PGTPAM(PTEPTR),B'00000001'                          0552
*     /***************************************************************/
*     /*                                                             */
*     /* SET STORAGE KEY TO 0 WITH FETCH PROTECT ON EACH FRAME       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0553
*     GEN REFS(VRBN) SETS(REG1,REG14);                             0553
         LR    REG14,VRBN             CHANGE REGS
         LA    REG1,8                 FETCH PROTECT BIT
         SSK   REG1,REG14             SET STORAGE KEY
         LA    REG14,2048(REG14)      ADDR OF NEXT 2K BLOCK
         SSK   REG1,REG14             SET STORAGE KEY IN NEXT BLOCK
*     RFY                                                          0554
*      (REG1) UNRSTD;               /*                       @ZA31128*/
*                                                                  0554
*     /***************************************************************/
*     /*                                                             */
*     /* IF FRAME IS NOT QUEUED, THEN TURN ON PFTVRALC BIT. THIS CASE*/
*     /* WOULD ARISE IF FRAMES WERE INTERCEPTED FOR V=R. THEY SHOULD */
*     /* ALREADY BE QUEUED ON LOCAL QUEUE IF NOT INTERCEPTD ALSO, SET*/
*     /* PFTVBN TO FRAME RBN SINCE V=R IS MAPPED 1 TO 1.             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0555
*     IF PFTQNDX=PFTNQN THEN                                       0555
         CLI   PFTQNDX(PFTEPTR),X'FF'                              0555
         BNE   @RF00555                                            0555
*       DO;                                                        0556
*         RSMHDPTR=ASCBRSM;         /* RESTORE RSMHD POINTER @YA01572*/
         L     @14,ASCBPTR                                         0557
         L     RSMHDPTR,ASCBRSM(,@14)                              0557
*         RSMCNTFX=RSMCNTFX+1;      /* INCREMENT LOCAL FIX COUNT   0558
*                                                            @YA01572*/
         LA    @14,1                                               0558
         LH    @10,RSMCNTFX(,RSMHDPTR)                             0558
         ALR   @10,@14                                             0558
         STH   @10,RSMCNTFX(,RSMHDPTR)                             0558
*         PVTCNTFX=PVTCNTFX+1;      /* INCREMENT SYSTEM COUNT      0559
*                                                            @YA01572*/
         AH    @14,PVTCNTFX(,PVTPTR)                               0559
         STH   @14,PVTCNTFX(,PVTPTR)                               0559
*         IF PVTCNTFX=PVTMAXFX THEN /* HAS THE FIX COUNT THRESHOLD 0560
*                                      BEEN REACHED                  */
         CH    @14,PVTMAXFX(,PVTPTR)                               0560
         BNE   @RF00560                                            0560
*           DO;                     /* YES, NOTIFY SRM       @YA01572*/
*             RFY                                                  0562
*              (REG1) RSTD;         /*                       @ZA31128*/
*             REG1=FOUR;            /* GET CODE FOR FIX THRESHOLD  0563
*                                      REACHED               @YA01572*/
         LA    REG1,4                                              0563
*             REG2=REG13;           /* SAVE REGISTER 13 ACROSS     0564
*                                      SYSEVENT              @YA01572*/
         LR    REG2,REG13                                          0564
*             REG13=ADDR(PVTSAVE);  /* GET SRM A SAVE AREA   @YA01572*/
*                                                                  0565
         LA    REG13,PVTSAVE(,PVTPTR)                              0565
*             /*******************************************************/
*             /*                                                     */
*             /* NOTIFY SRM THAT THE FIXED THRESHOLD HAS BEEN REACHED*/
*             /*                                                     */
*             /*******************************************************/
*                                                                  0566
*             RFY                                                  0566
*              (REG0) RSTD;         /*                       @ZA31128*/
*             GEN REFS(CVT,CVTPTR,CVTOPTE) SETS(REG0,REG14,REG15)  0567
*                 (SYSEVENT AVQLOW,ENTRY=BRANCH);                  0567
         SYSEVENT AVQLOW,ENTRY=BRANCH
*             RFY                                                  0568
*              (REG0,                                              0568
*               REG1) UNRSTD;       /*                       @ZA31128*/
*             REG13=REG2;           /* RESTORE REGISTER 13   @YA01572*/
         LR    REG13,REG2                                          0569
*             RSMHDPTR=ASCBRSM;     /* RESTORE RSM HEADER POINTER  0570
*                                                            @YA01572*/
         L     @14,ASCBPTR                                         0570
         L     RSMHDPTR,ASCBRSM(,@14)                              0570
*           END;                                                   0571
*                                                                  0571
*         /***********************************************************/
*         /*                                                         */
*         /* TURN OFF ALL BITS EXCEPT PFTBADPG AND PFTOFINT          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0572
*         PFTFLAG1=PFTFLAG1&FLAG1;                                 0572
@RF00560 NI    PFTFLAG1(PFTEPTR),X'07'                             0572
*         PFTVRALC=ON;              /* TURN ON PFTVRALC BIT          */
         OI    PFTVRALC(PFTEPTR),B'00000010'                       0573
*         PFTVR=ON;                 /* TURN ON PFTVR BIT     @ZA03537*/
         OI    PFTVR(PFTEPTR),B'00100000'                          0574
*         PFTFLAG2=PFTFLAG2&FLAG2;  /* TURN OFF ALL BITS EXCEPT PFTVR
*                                      AND PFTPREF           @ZA03537*/
         NI    PFTFLAG2(PFTEPTR),X'24'                             0575
*         PFTVBN=PFTEPTR-PVTPFTP;   /* 1 TO 1 MAPPING                */
         LR    @14,PFTEPTR                                         0576
         SL    @14,PVTPFTP(,PVTPTR)                                0576
         STH   @14,PFTVBN(,PFTEPTR)                                0576
*         PFTASID=PCBRASCB->ASCBASID;/* ASID OF REQUESTED REGION     */
         L     @14,PCBRASCB(,PCBRPTR)                              0577
         MVC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    0577
*         RESPECIFY                                                0578
*          (REG0,                                                  0578
*           REG1) RSTD;                                            0578
*                                                                  0578
*         /***********************************************************/
*         /*                                                         */
*         /* MOVE PFTE TO LOCAL FRAME QUEUE                          */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0579
*         REG0=PFTLFQN;                                            0579
         LA    REG0,128                                            0579
*         GENERATE(SLL   REG0,16) ;                                0580
         SLL   REG0,16
*         GENERATE(ICM   REG0,3,PFTVBN(PFTEPTR)) ;                 0581
         ICM   REG0,3,PFTVBN(PFTEPTR)
*         REG1=PCBRASCB;                                           0582
         L     REG1,PCBRASCB(,PCBRPTR)                             0582
*         CALL IEAPFTE;             /* MOVE PFTE TO LOCAL FRAME QUEUE*/
         L     @15,PVTPFTE(,PVTPTR)                                0583
         BALR  @14,@15                                             0583
*         RESPECIFY                                                0584
*          (REG0,                                                  0584
*           REG1) UNRSTD;           /*                       @ZA31128*/
*       END;                                                       0585
*     VRBN=VRBN+K4;                 /* ADDR TO NEXT PAGE             */
@RF00555 AL    VRBN,@CF00054                                       0586
*     PFTEPTR=PFTEPTR+LENGTH(PFTE); /* ADDR NEXT FRAME               */
         AL    PFTEPTR,@CF00040                                    0587
*     PTEPTR=PTEPTR+LENGTH(PGTPTE); /* ADDR NEXT PGTE                */
         AH    PTEPTR,@CH00058                                     0588
*   END;                            /*                       @ZA31128*/
*                                                                  0589
@DE00540 L     @14,RGNEND(,PCBRPTR)                                0589
         CR    VRBN,@14                                            0589
         BNH   @DL00540                                            0589
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL PAGES HAVE BEEN PROCESSED. ALL FRAMES ARE NOW ON THE LOCAL*/
*   /* FRAME QUEUE, AND HAVE BEEN SET TO KEY 0, AND FETCH PROTECTED. */
*   /* ALL PGTE'S HAVE BEEN FILLED IN. NOW CLEAR THE ENTIRE REGION.  */
*   /* REGISTERS FOR MVCL ARE AS FOLLOWS: REG0 = START ADDRESS OF    */
*   /* AREA TO ZERO OUT, REG1 = NUMBER OF BYTES IN REGION TO ZERO    */
*   /* OUT, REG10 = REGION START ADDRESS, REG11 = PADDING CHARACTER =*/
*   /* 0.                                                    @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*   RFY                                                            0590
*    (REG0,                                                        0590
*     REG1,                                                        0590
*     REG10) RSTD;                  /*                       @ZA31128*/
*   REG0=RGNSTART;                                                 0591
         L     @07,RGNSTART(,PCBRPTR)                              0591
         LR    REG0,@07                                            0591
*   REG1=(RGNEND+K4)-RGNSTART;                                     0592
         AL    @14,@CF00054                                        0592
         SLR   @14,@07                                             0592
         LR    REG1,@14                                            0592
*   REG10=RGNSTART;                                                0593
         LR    REG10,@07                                           0593
*   REG11=ZERO;                     /* DESTROYS BASE REG     @Z30GNYD*/
         SLR   REG11,REG11                                         0594
*   GEN REFS(REG0,REG10)(MVCL REG0,REG10);                         0595
         MVCL REG0,REG10
*   REG11=REG12+3840;               /* RESTORE BASE REG      @Z30GNYD*/
         LA    REG11,3840                                          0596
         ALR   REG11,REG12                                         0596
*   RESPECIFY                                                      0597
*     REG1 UNRSTD;                                                 0597
*   RCODE=ZERO;                     /* RETURN CODE = 0       @ZA31128*/
         SLR   RCODE,RCODE                                         0598
*   RFY                                                            0599
*    (REG0,                                                        0599
*     REG1,                                                        0599
*     REG10) UNRSTD;                /*                       @ZA31128*/
*                                                                  0599
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON EXIT ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*ENDVAL:                                                           0600
*   REG14=WORK;                     /* RESTORE RETURN ADDRESS        */
ENDVAL   L     REG14,WORK(,PCBRPTR)                                0600
*   RFY                                                            0601
*    (PVTPTR,                                                      0601
*     PTEPTR,                                                      0601
*     PFTEPTR,                                                     0601
*     PCBRPTR,                                                     0601
*     VRBN,                                                        0601
*     RSMHDPTR) UNRSTD;                                            0601
*   END VALIDATE;                                                  0602
@EL00003 DS    0H                                                  0602
@EF00003 DS    0H                                                  0602
@ER00003 BR    @14                                                 0602
*                                                                  0603
*   /*****************************************************************/
*   /*                                                               */
*   /* INTERCEPT GETS CONTROL FROM PFTE MANAGER WHEN A V=R           */
*   /* INTERCEPTED FRAME IS SENT TO THE AVAILABLE FRAME QUEUE, OR    */
*   /* FROM SQA ALLOCATION WHEN IT TAKES A V=R INTERCEPTED FRAME FOR */
*   /* ITS USE. INTERCEPT FIRST TESTS TO SEE IF THE ALLOCATION HAS   */
*   /* BEEN FAILED (PCBRFAIL=1). PCBRFAIL CAN BE TURNED ON BY SQA    */
*   /* ALLOCATION WHEN IT TAKES AN INTERCEPTED FRAME, OR BY INTERCEPT*/
*   /* WHEN A FRAME SENT TO IT BY PFTE MANAGER IS MARKED AS A BAD    */
*   /* PAGE OR TO GO OFFLINE. IF THE ALLOCATION IS FAILED, V=R       */
*   /* COMPLETE WILL BE SCHEDULED IF IT HAS NOT ALREADY BEEN         */
*   /* SCHEDULED (PCBRINT=1). WHEN COMPLETE RUNS WITH PCBRFAIL=1, IT */
*   /* WILL POST THE INITIATOR WITH A CODE OF 16 SO THAT A FREEPART  */
*   /* AND NEW GETPART WILL BE PERFORMED. IF THE ALLOCATION IS NOT   */
*   /* FAILED, THE FRAME IS ACCEPTED AND THE ROOT COUNT IN THE V=R   */
*   /* ROOT PCB IS DECREMENTED. IF V=R MAINLINE IS NOT RUNNING       */
*   /* (PCBRLOAD=0) AND THE ROOT COUNT GOES TO ZERO, COMPLETE IS     */
*   /* SCHEDULED. COMPLETE WILL POST THE INITIATOR WITH A CODE OF 0  */
*   /* INDICATING SUCCESSFUL ALLOCATION. IF THE MAINLINE IS RUNNING, */
*   /* COMPLETE CANNOT BE SCHEDULED.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0603
*   RESPECIFY                                                      0603
*    (PVTPTR,                                                      0603
*     PCBRPTR,                                                     0603
*     VRBN,                                                        0603
*     PFTEPTR,                                                     0603
*     REG1) RSTD;                   /*                       @ZA10767*/
*                                                                  0603
*   /*****************************************************************/
*   /*                                                               */
*   /* REG3 SHOULD ALREADY CONTAIN PVT ADDRESS BY RSM CONVENTIONS    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0604
*EP2:                                                              0604
*   PFTEPTR=REG6;                   /* PFTE ADDR PASSED IN REG6      */
EP2      LR    PFTEPTR,REG6                                        0604
*   VRBN=REG1;                      /* REG1 CONTAINS RBN OF        0605
*                                      INTERCEPTED FRAME.            */
         LR    VRBN,REG1                                           0605
*   RCAVEQRI=ON;                                                   0606
         L     @14,PVTPRCA(,PVTPTR)                                0606
         OI    RCAVEQRI(@14),B'00000010'                           0606
*   PCBRPTR=PVTVROOT;               /* PICK UP ADDR OF FIRST PCB ON
*                                      V=R WAIT QUEUE.               */
*                                                                  0607
         L     PCBRPTR,PVTVROOT(,PVTPTR)                           0607
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH PCBS FOR THE ONE TO INCLUDE FRAME                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0608
*PCBLOOP:                                                          0608
*   IF PCBRPTR=ZERO THEN            /* IF 0, THEN END OF PCBR QUEUE  */
PCBLOOP  LTR   PCBRPTR,PCBRPTR                                     0608
         BNZ   @RF00608                                            0608
*     DO;                                                          0609
*       PFTVRINT=OFF;               /* TURN OFF INTERCEPT BIT        */
         NI    PFTVRINT(PFTEPTR),B'10111111'                       0610
*       RCARCRD=8;                                                 0611
         L     @14,PVTPRCA(,PVTPTR)                                0611
         MVI   RCARCRD(@14),X'08'                                  0611
*       GEN(ABEND X'C0D',,,SYSTEM);                                0612
         ABEND X'C0D',,,SYSTEM
*       GOTO EXITI;                 /* EXIT INTERCEPT                */
         B     EXITI                                               0613
*     END;                                                         0614
*                                                                  0614
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF FRAME WITHIN PCB RANGE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0615
*   IF VRBN<STARTRBN×VRBN>ENDRBN THEN                              0615
@RF00608 C     VRBN,STARTRBN(,PCBRPTR)                             0615
         BL    @RT00615                                            0615
         C     VRBN,ENDRBN(,PCBRPTR)                               0615
         BNH   @RF00615                                            0615
@RT00615 DS    0H                                                  0616
*     DO;                           /* OUTSIDE RANGE         @ZA31128*/
*       PCBRPTR=NEXTPCB;            /* ADDRESS OF NEXT PCB ON CHAIN  */
         L     PCBRPTR,NEXTPCB(,PCBRPTR)                           0617
*       GOTO PCBLOOP;               /* REPETE SCAN PROCESS           */
         B     PCBLOOP                                             0618
*     END;                          /*                       @ZA31128*/
*   ELSE                            /* FRAME IN RANGE        @ZA31128*/
*                                                                  0620
*     /***************************************************************/
*     /*                                                             */
*     /* IF PCBRFAIL IS ON, COMPLETE (IEAVEQRC) SHOULD BE SCHEDULED  */
*     /* IN ORDER TO TERMINATE THE ALLOCATION. IF ALLOCATION HAS NOT */
*     /* BEEN FAILED, SEE IF IT SHOULD BE.                           */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0620
*     IF PCBRFAIL='0'B THEN         /* HAS ROOT BEEN FAILED  @ZA10767*/
@RF00615 TM    PCBRFAIL(PCBRPTR),B'00001000'                       0620
         BNZ   @RF00620                                            0620
*       DO;                         /* ROOT NOT FAILED       @ZA10767*/
*                                                                  0621
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE FRAME IS INTERCEPTED FOR VARY STORAGE OFFLINE, OR*/
*         /* THE FRAME IS BAD, DO NOT ACCEPT IT AND FAIL THE         */
*         /* ALLOCATION. OTHERWISE, ACCEPT THE FRAME.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0622
*         IF PFTOFINT=ON×PFTBADPG=ON THEN                          0622
         TM    PFTOFINT(PFTEPTR),B'00000101'                       0622
         BZ    @RF00622                                            0622
*           PCBRFAIL=ON;            /* FAIL THE ALLOCATION   @ZA10767*/
         OI    PCBRFAIL(PCBRPTR),B'00001000'                       0623
*         ELSE                      /* FRAME O. K.           @ZA10767*/
*           DO;                     /*                       @ZA10767*/
         B     @RC00622                                            0624
@RF00622 DS    0H                                                  0625
*             VRBN=0;               /* ACCEPT THE FRAME      @ZA10767*/
         SLR   VRBN,VRBN                                           0625
*             PCBRCNT=PCBRCNT-ONE;  /* DECREMENT ROOT COUNT  @ZA10767*/
*                                                                  0626
         LH    @14,PCBRCNT(,PCBRPTR)                               0626
         BCTR  @14,0                                               0626
         STH   @14,PCBRCNT(,PCBRPTR)                               0626
*             /*******************************************************/
*             /*                                                     */
*             /* IF PCBRLOAD IS ON THEN MAINLINE IS STILL RUNNING, SO*/
*             /* DO NOT SCHEDULE COMPLETE EVEN IF PCBRCNT GOES TO    */
*             /* ZERO.                                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0627
*             IF PCBRLOAD='1'B THEN /* IS MAINLINE RUNNING   @ZA10767*/
         TM    PCBRLOAD(PCBRPTR),B'00000100'                       0627
         BO    @RT00627                                            0627
*               GOTO EXITI;         /* YES, RETURN           @ZA10767*/
*           END;                    /*                       @ZA10767*/
*       END;                        /*                       @ZA10767*/
*                                                                  0630
@RC00622 DS    0H                                                  0631
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALLOCATION HAS BEEN FAILED AND COMPLETE HAS NOT ALREADY    */
*   /* BEEN SCHEDULED, OR IF THE ROOT COUNT HAS REACHED ZERO,        */
*   /* SCHEDULE COMPLETE. COMPLETE COULD ONLY HAVE ALREADY BEEN      */
*   /* SCHEDULED IF THE ALLOCATION HAD PREVIOUSLY BEEN FAILED.       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0631
*   IF(PCBRFAIL=ON&PCBRINT^=ON)×PCBRCNT=0 THEN/*             @ZA10767*/
@RF00620 TM    PCBRFAIL(PCBRPTR),B'00001000'                       0631
         BNO   @GL00017                                            0631
         TM    PCBRINT(PCBRPTR),B'10000000'                        0631
         BZ    @RT00631                                            0631
@GL00017 ICM   @14,3,PCBRCNT(PCBRPTR)                              0631
         BNZ   @RF00631                                            0631
@RT00631 DS    0H                                                  0632
*     DO;                                                          0632
*                                                                  0632
*       /*************************************************************/
*       /*                                                           */
*       /* IF SRB WAS NOT OBTAINED, THEN CANNOT SCHEDULE. THIS       */
*       /* SITUATION SHOULD NEVER OCCUR.                     @Z30GNYD*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0633
*       IF COMPSRB=0 THEN           /* IF POINTER TO COMPLETION SRB=0
*                                                            @Z30GNYD*/
         ICM   @14,15,COMPSRB(PCBRPTR)                             0633
         BNZ   @RF00633                                            0633
*         DO;                                                      0634
*           VRBN=REG1;              /* DO NOT ACCEPT FRAME   @ZA10767*/
         LR    VRBN,REG1                                           0635
*           REG7=PCBRTCBA;                                         0636
         SLR   REG7,REG7                                           0636
         ICM   REG7,7,PCBRTCBA(PCBRPTR)                            0636
*           REG8=PCBRASCB->ASCBASID;                               0637
         L     @14,PCBRASCB(,PCBRPTR)                              0637
         SLR   @10,@10                                             0637
         ICM   @10,3,ASCBASID(@14)                                 0637
         LR    REG8,@10                                            0637
*           GENERATE;                                              0638
   CALLRTM  TYPE=ABTERM,COMPCOD=X'028',TCB=(REG7),ASID=(REG8)
*           GOTO EXITI;             /* GOTO INTERCEPT EXIT           */
         B     EXITI                                               0639
*         END;                                                     0640
*       RESPECIFY                                                  0641
*         SRBPTR RSTD;                                             0641
@RF00633 DS    0H                                                  0642
*       SRBPTR=COMPSRB;             /* REG1 = SRB ADDRESS    @Z30GNYD*/
*                                                                  0642
         L     SRBPTR,COMPSRB(,PCBRPTR)                            0642
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD SRB                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0643
*       SRBSECT=SRBSECT&&SRBSECT;   /* CLEAR SRB AREA        @ZA10767*/
         XC    SRBSECT(44,SRBPTR),SRBSECT(SRBPTR)                  0643
*       SRBID='SRB ';                                              0644
         MVC   SRBID(4,SRBPTR),@CC02307                            0644
*       SRBASCB=PCBRASCB;                                          0645
         L     @14,PCBRASCB(,PCBRPTR)                              0645
         ST    @14,SRBASCB(,SRBPTR)                                0645
*       SRBEP=PVTPVRC;                                             0646
         MVC   SRBEP(4,SRBPTR),PVTPVRC(PVTPTR)                     0646
*       SRBRMTR=PVTPSRBP;                                          0647
         MVC   SRBRMTR(4,SRBPTR),PVTPSRBP(PVTPTR)                  0647
*       SRBPTCB=PCBRTCBA;                                          0648
         SLR   @10,@10                                             0648
         ICM   @10,7,PCBRTCBA(PCBRPTR)                             0648
         ST    @10,SRBPTCB(,SRBPTR)                                0648
*       SRBPASID=PCBRASCB->ASCBASID;                               0649
         MVC   SRBPASID(2,SRBPTR),ASCBASID(@14)                    0649
*       SRBPARM=PCBRPTR;                                           0650
         ST    PCBRPTR,SRBPARM(,SRBPTR)                            0650
*       PCBRINT=ON;                 /* SET SCHEDULED BIT             */
         OI    PCBRINT(PCBRPTR),B'10000000'                        0651
*       REG1=SRBPTR;                /* REG1 CONTAINS SRB ADDRESS     */
         LR    REG1,SRBPTR                                         0652
*       RESPECIFY                                                  0653
*         SRBPTR UNRSTD;                                           0653
*       GEN(SCHEDULE SRB=(1));                                     0654
         SCHEDULE SRB=(1)
*     END;                                                         0655
*                                                                  0655
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON EXIT CODE FOR INTERCEPT                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0656
*EXITI:                                                            0656
*   REG1=VRBN;                      /* SET PARM REG FOR CALLER     0656
*                                                            @ZA10767*/
@RF00631 DS    0H                                                  0656
EXITI    LR    REG1,VRBN                                           0656
*   RCAVEQRI='0'B;                                                 0657
         L     @14,PVTPRCA(,PVTPTR)                                0657
         NI    RCAVEQRI(@14),B'11111101'                           0657
*   REG0=PVTWSA3(1:4);              /* RESTOR REG 0          @ZA31128*/
         L     REG0,PVTWSA3(,PVTPTR)                               0658
*   LM(REG2,REG15,PVTWSA3(9:64));   /*                       @ZA31128*/
         LM    REG2,REG15,PVTWSA3+8(PVTPTR)                        0659
*   GOTO REG14;                     /* RETURN                @ZA31128*/
         BR    REG14                                               0660
*   RESPECIFY                                                      0661
*    (REG1,                                                        0661
*     PCBRPTR,                                                     0661
*     VRBN,                                                        0661
*     PFTEPTR,                                                     0661
*     PVTPTR) UNRSTD;                                              0661
*                                                                  0662
*/********************************************************************/
*/*COMPLETE ROUTINE IS SCHEDULED WHEN V=R REQUEST CAN BE POSTED      */
*/*COMPLETE WITH POST CODE 0 FOR SUCCESSFUL OR 16 FOR UNSUCCESSFUL.  */
*/*COMPLETE WILL THEN TURN ON PCBRFPCB BIT SO THAT  WHEN IEAVEQRF    */
*/*GETS CONTROL IT WILL FREE PCB IN ADDITION TO REGULAR PROCESSING.  */
*/*IT IS POSSIBLE FOR COMPLETE TO GET CONTROL AFTER IEAVEQRF IS RUN. */
*/*THAT IS, A FREEPART IS ISSUED BEFORE ALLOCATION IS COMPLETE.  TO  */
*/*SYNCHRONIZE THIS SITUATION, IEAVEQRF WILL TURN ON PCBRPB BIT.  IF */
*/*COMPLETE FINDS PCBRPB ON, IT WILL NOT TRY TO POST BUT IT WILL     */
*/*DEQUEUE PCB.                                                      */
*/********************************************************************/
*                                                                  0662
*   RESPECIFY                                                      0662
*    (PCBRPTR,                                                     0662
*     PVTPTR,                                                      0662
*     SRBPTR,                                                      0662
*     REG5) RSTD;                                                  0662
*EP3:                                                              0663
*   PCBRPTR=REG1;                                                  0663
EP3      LR    PCBRPTR,REG1                                        0663
*   REG5=REG12;                     /* SAVE BASE REGISTER    @ZA06219*/
         LR    REG5,REG12                                          0664
*   GENERATE CODE;                                                 0665
LOCALCO SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        **
               RELATED=(RSM,IEAVEQRC(LOCALCR))
EP3SALO  SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                      **
               RELATED=(RSM,IEAVEQRC(GLOBALCR),IEAVEQRC(GR2))
*   REG12=REG5;                     /* RESTORE BASE REG      @ZA06219*/
         LR    REG12,REG5                                          0666
*   REG11=REG12+3840;               /* RESTORE 2ND BASE REG  @ZA06219*/
         LA    REG11,3840                                          0667
         ALR   REG11,REG12                                         0667
*   CALL SETFRR;                    /* GO SET UP FRR AND PVT PTR   0668
*                                                            @ZA31128*/
*                                                                  0668
         BAL   @14,SETFRR                                          0668
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FRR IS SET UP SO CONTINUE                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0669
*   RCASAL=ON;                                                     0669
*   RCALL=ON;                                                      0670
         L     @14,PVTPRCA(,PVTPTR)                                0670
         OI    RCASAL(@14),B'11000000'                             0670
*   RCAVEQRC=ON;                    /* TURN ON ENTERED BIT           */
         OI    RCAVEQRC(@14),B'00001000'                           0671
*   SRBPTR=REG0;                                                   0672
         LR    SRBPTR,REG0                                         0672
*   REG0=PVTSRBID;                  /* FREE SRB AREA                 */
         L     REG0,PVTSRBID(,PVTPTR)                              0673
*   REG5=PVTPTR;                    /* SAVE PVT POINTER ACROSS     0674
*                                      FREECELL              @ZA31128*/
         LR    REG5,PVTPTR                                         0674
*   GEN(FREECELL CPID=(0),CELL=(SRBPTR),BRANCH=YES,SAVE=NO) ;      0675
         FREECELL CPID=(0),CELL=(SRBPTR),BRANCH=YES,SAVE=NO
*   PVTPTR=REG5;                    /* RESTORE PVT POINTER   @ZA31128*/
         LR    PVTPTR,REG5                                         0676
*   RESPECIFY                                                      0677
*    (REG5,                                                        0677
*     SRBPTR) UNRSTD;               /*                       @ZA31128*/
*                                                                  0677
*   /*****************************************************************/
*   /*                                                               */
*   /* THE COMPLETE SRB HAS BEEN FREED SO ZERO OUT IT'S ADDRESS IN   */
*   /* THE ROOT PCB TO KEEP V=R FREE FROM TRYING TO FREE IT AGAIN. IF*/
*   /* THE PCBRPB BIT IS ON,THE IEAVEQRF HAS ALREADY RUN FREEING THE */
*   /* REQUESTED REGION (BY FREEPART). THEREFORE, JUST FREE PCBR AND */
*   /* RETURN. OTHERWISE, SCHEDULE POST WITH CODE 0 OR 16 DEPENDING  */
*   /* IF THE PCBRFAIL BIT IS ON OR NOT.                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0678
*   COMPSRB=0;                      /* ZERO OUT COMP SRBPTR IN ROOT
*                                      PCB                   @ZA10767*/
         SLR   @14,@14                                             0678
         ST    @14,COMPSRB(,PCBRPTR)                               0678
*   IF PCBRPB=ON THEN               /* IF ON, THEN FREE HAS ALREADY
*                                      RUN                           */
         TM    PCBRPB(PCBRPTR),B'00100000'                         0679
         BNO   @RF00679                                            0679
*     DO;                                                          0680
*       RFY                                                        0681
*        (REG6) RSTD;               /*                       @ZA31128*/
*                                                                  0681
*       /*************************************************************/
*       /*                                                           */
*       /* MAP PVTVROOT ONTO NEXTPCB FIELD OF ROOT PCB       @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0682
*       REG6=ADDR(PVTVROOT)-(ADDR(NEXTPCB)-ADDR(PCBR));/*    @ZA31128*/
*                                                                  0682
         LA    REG6,PVTVROOT(,PVTPTR)                              0682
         SH    REG6,@CH00879                                       0682
*       /*************************************************************/
*       /*                                                           */
*       /* SEARCH ROOT QUEUE UNTIL INPUT ROOT PCB FOUND OR END OF    */
*       /* QUEUE IS REACHED.                                 @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0683
*       DO WHILE(PCBRPTR^=REG6->NEXTPCB)&(REG6->NEXTPCB^=0);       0683
         B     @DE00683                                            0683
@DL00683 DS    0H                                                  0684
*         REG6=REG6->NEXTPCB;       /* ADDR NEXT ROOT        @ZA31128*/
         L     REG6,NEXTPCB(,REG6)                                 0684
*       END;                        /* END SEARCH FOR ROOT   @ZA31128*/
@DE00683 L     @14,NEXTPCB(,REG6)                                  0685
         CR    PCBRPTR,@14                                         0685
         BE    @DC00683                                            0685
         LTR   @14,@14                                             0685
         BNZ   @DL00683                                            0685
@DC00683 DS    0H                                                  0686
*       IF REG6->NEXTPCB=0 THEN     /* ROOT FOUND ?          @ZA31128*/
         ICM   @14,15,NEXTPCB(REG6)                                0686
         BNZ   @RF00686                                            0686
*         DO;                       /* NO, ERROR             @ZA31128*/
*           RCARCRD=8;                                             0688
         L     @14,PVTPRCA(,PVTPTR)                                0688
         MVI   RCARCRD(@14),X'08'                                  0688
*           GEN(ABEND X'C0D',,,SYSTEM);/* RECORD ERROR               */
         ABEND X'C0D',,,SYSTEM
*           PCBRPOF='1'B;           /* FORCE EXIT            @ZA31128*/
         OI    PCBRPOF(PCBRPTR),B'00000001'                        0690
*         END;                      /*                       @ZA31128*/
*       ELSE                        /* ROOT FOUND            @ZA31128*/
*                                                                  0692
*         /***********************************************************/
*         /*                                                         */
*         /* INPUT ROOT PCB HAS BEEN FOUND ON ROOT QUEUE     @ZA31128*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0692
*         REG6->NEXTPCB=NEXTPCB;    /* DEQUEUE ROOT          @ZA31128*/
         B     @RC00686                                            0692
@RF00686 MVC   NEXTPCB(4,REG6),NEXTPCB(PCBRPTR)                    0692
*       RFY                                                        0693
*        (REG6) UNRSTD;             /*                       @ZA31128*/
*                                                                  0693
@RC00686 DS    0H                                                  0694
*       /*************************************************************/
*       /*                                                           */
*       /* IF MAINLINE NOT RUNNING, SEND ROOT TO PCB FREE Q          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0694
*       IF PCBRPOF='1'B THEN        /* IF ON, CANNOT GET RID OF PCBR */
         TM    PCBRPOF(PCBRPTR),B'00000001'                        0694
         BNO   @RF00694                                            0694
*         DO;                                                      0695
*           PCBRPOF='0'B;           /* TURN OF POF SO IEAVEQRP WILL
*                                      DEQUEUE                       */
         NI    PCBRPOF(PCBRPTR),B'11111110'                        0696
*           REG1=REG12;             /* SAVE BASE REGISTER            */
         LR    REG1,REG12                                          0697
*           GENERATE;                                              0698
GR2      SETLOCK RELEASE,TYPE=SALLOC,RELATED=(RSM,IEAVEQRC(EP3SALO))
*           GOTO GOODBY;            /* RETURN                        */
         B     GOODBY                                              0699
*         END;                                                     0700
*       ELSE                        /* ROOT TO PCB FREE Q    @ZA31128*/
*         DO;                       /*                       @ZA31128*/
@RF00694 DS    0H                                                  0702
*           PCBFQP=FREECB;          /* PCBFQP = 'FF000000'X          */
         MVC   PCBFQP(4,PCBRPTR),FREECB                            0702
*           RESPECIFY                                              0703
*            (REG0,                                                0703
*             REG1,                                                0703
*             RSMHDPTR) RSTD;                                      0703
*           RSMHDPTR=ASCBRSM;                                      0704
         L     @14,ASCBPTR                                         0704
         L     RSMHDPTR,ASCBRSM(,@14)                              0704
*           REG0=PCBFREQN;          /* INPUT TO PCB MANAGER          */
         LA    REG0,16                                             0705
*           REG1=PCBRPTR;           /* PCBR TO DEQUEUE               */
         LR    REG1,PCBRPTR                                        0706
*           CALL IEAVPCB;           /* CALL PCB MANAGER              */
         L     @15,PVTPCB(,PVTPTR)                                 0707
         BALR  @14,@15                                             0707
*           RESPECIFY                                              0708
*            (REG0,                                                0708
*             REG1,                                                0708
*             RSMHDPTR) UNRSTD;                                    0708
*         END;                                                     0709
*     END;                          /*                       @ZA31128*/
*   ELSE                                                           0711
*     DO;                                                          0711
*                                                                  0711
         B     @RC00679                                            0711
@RF00679 DS    0H                                                  0712
*       /*************************************************************/
*       /*                                                           */
*       /* IF PCBRFAIL IS ON,THEN V=R REGION COULD NOT BE OBTAINED,  */
*       /* POST WITH POST CODE OF 16.                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0712
*       RESPECIFY                                                  0712
*        (REG0,                                                    0712
*         REG1,                                                    0712
*         REG10,                                                   0712
*         REG9) RSTD;                                              0712
*       REG9=PCBRECB;                                              0713
*                                                                  0713
         L     REG9,PCBRECB(,PCBRPTR)                              0713
*       /*************************************************************/
*       /*                                                           */
*       /* IF FAIL BIT IS ON THEN SET UP POST CODE OF 16             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0714
*       IF PCBRFAIL=ON THEN                                        0714
         TM    PCBRFAIL(PCBRPTR),B'00001000'                       0714
         BNO   @RF00714                                            0714
*         DO;                                                      0715
*           PCBRFPCB=ON;            /* TURN ON FREEPCB BIT           */
         OI    PCBRFPCB(PCBRPTR),B'00010000'                       0716
*           REG10=16;               /* SET POST CODE OF 16           */
         LA    REG10,16                                            0717
*         END;                                                     0718
*       ELSE                                                       0719
*         DO;                                                      0719
         B     @RC00714                                            0719
@RF00714 DS    0H                                                  0720
*           RFY                                                    0720
*            (RSMHDPTR) RSTD;       /*                       @ZA31128*/
*           RSMHDPTR=ASCBRSM;       /*                       @ZA31128*/
         L     @14,ASCBPTR                                         0721
         L     RSMHDPTR,ASCBRSM(,@14)                              0721
*           CALL VALIDATE;          /* VALIDATE AND ZERO OUT V=R   0722
*                                      REGION                        */
         BAL   @14,VALIDATE                                        0722
*           RFY                                                    0723
*            (RSMHDPTR) UNRSTD;     /*                       @ZA31128*/
*           IF RCODE=0 THEN         /* VALIDATE SUCCESSFUL ?         */
         LTR   RCODE,RCODE                                         0724
         BNZ   @RF00724                                            0724
*             DO;                   /* YES, CONTINUE                 */
*                                                                  0725
*               /*****************************************************/
*               /*                                                   */
*               /* MAP PVTVROOT ONTO NEXTPCB FIELD OF ROOT PCB       */
*               /*                                           @ZA31128*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0726
*               REG1=ADDR(PVTVROOT)-(ADDR(NEXTPCB)-ADDR(PCBR));/*  0726
*                                                            @ZA31128*/
*                                                                  0726
         LA    REG1,PVTVROOT(,PVTPTR)                              0726
         SH    REG1,@CH00879                                       0726
*               /*****************************************************/
*               /*                                                   */
*               /* SEARCH ROOT QUEUE UNTIL INPUT ROOT PCB FOUND OR   */
*               /* END OF QUEUE IS REACHED.                  @ZA31128*/
*               /*                                                   */
*               /*****************************************************/
*                                                                  0727
*               DO WHILE(PCBRPTR^=REG1->NEXTPCB)&(REG1->NEXTPCB^=0);
         B     @DE00727                                            0727
@DL00727 DS    0H                                                  0728
*                 REG1=REG1->NEXTPCB;/* ADDR NEXT ROOT       @ZA31128*/
         L     REG1,NEXTPCB(,REG1)                                 0728
*               END;                /* END SEARCH FOR ROOT   @ZA31128*/
@DE00727 L     @14,NEXTPCB(,REG1)                                  0729
         CR    PCBRPTR,@14                                         0729
         BE    @DC00727                                            0729
         LTR   @14,@14                                             0729
         BNZ   @DL00727                                            0729
@DC00727 DS    0H                                                  0730
*               IF REG1->NEXTPCB=0 THEN/* ROOT FOUND ?       @ZA31128*/
         ICM   @14,15,NEXTPCB(REG1)                                0730
         BNZ   @RF00730                                            0730
*                 DO;               /* NO, ERROR             @ZA31128*/
*                   RCARCRD=8;                                     0732
         L     @14,PVTPRCA(,PVTPTR)                                0732
         MVI   RCARCRD(@14),X'08'                                  0732
*                   GEN(ABEND X'C0D',,,SYSTEM);/* RECORD ERROR       */
         ABEND X'C0D',,,SYSTEM
*                 END;              /*                       @ZA31128*/
*               ELSE                /*                       @ZA31128*/
*                                                                  0735
*                 /***************************************************/
*                 /*                                                 */
*                 /* INPUT ROOT PCB HAS BEEN FOUND ON ROOT QUEUE     */
*                 /*                                         @ZA31128*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0735
*                 REG1->NEXTPCB=NEXTPCB;/* DEQUEUE ROOT      @ZA31128*/
*                                                                  0735
         B     @RC00730                                            0735
@RF00730 MVC   NEXTPCB(4,REG1),NEXTPCB(PCBRPTR)                    0735
*               /*****************************************************/
*               /*                                                   */
*               /* FREE PCB BEFORE POSTING                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0736
*               IF PCBRPOF='1'B THEN                               0736
@RC00730 TM    PCBRPOF(PCBRPTR),B'00000001'                        0736
         BNO   @RF00736                                            0736
*                 DO;                                              0737
*                   REG9=PCBRECB;   /* SET UP ECB TO POST            */
         L     REG9,PCBRECB(,PCBRPTR)                              0738
*                   PCBRPOF='0'B;   /* TURN OFF POF SO IEAVEQRP WILL
*                                      DEQUEUE                       */
         NI    PCBRPOF(PCBRPTR),B'11111110'                        0739
*                 END;                                             0740
*               ELSE                /*                       @ZA31128*/
*                 DO;               /*                       @ZA31128*/
         B     @RC00736                                            0741
@RF00736 DS    0H                                                  0742
*                   RFY                                            0742
*                    (RSMHDPTR) RSTD;/*                      @ZA31128*/
*                   RSMHDPTR=ASCBRSM;                              0743
         L     @14,ASCBPTR                                         0743
         L     RSMHDPTR,ASCBRSM(,@14)                              0743
*                   REG9=PCBRECB;                                  0744
         L     REG9,PCBRECB(,PCBRPTR)                              0744
*                   PCBFQP=FREECB;  /* FREE PCBR                     */
         MVC   PCBFQP(4,PCBRPTR),FREECB                            0745
*                   REG0=PCBFREQN;                                 0746
         LA    REG0,16                                             0746
*                   REG1=PCBRPTR;                                  0747
         LR    REG1,PCBRPTR                                        0747
*                   CALL IEAVPCB;                                  0748
         L     @15,PVTPCB(,PVTPTR)                                 0748
         BALR  @14,@15                                             0748
*                   RFY                                            0749
*                    (RSMHDPTR) UNRSTD;/*                    @ZA31128*/
*                 END;              /*                       @ZA31128*/
*               REG10=0;            /* SET UP POST CODE OF 0         */
@RC00736 SLR   REG10,REG10                                         0751
*             END;                                                 0752
*           ELSE                                                   0753
*             DO;                                                  0753
         B     @RC00724                                            0753
@RF00724 DS    0H                                                  0754
*               PCBRFPCB=ON;                                       0754
         OI    PCBRFPCB(PCBRPTR),B'00010000'                       0754
*               REG10=16;           /* SET UP POST CODE OF 16        */
         LA    REG10,16                                            0755
*             END;                                                 0756
*         END;                      /* SETLOCK CLOBBERS REG11-14     */
@RC00724 DS    0H                                                  0758
*       REG1=REG12;                                                0758
@RC00714 LR    REG1,REG12                                          0758
*       GENERATE;                                                  0759
GLOBALCR  SETLOCK  RELEASE,TYPE=SALLOC,                               **
               RELATED=(RSM,IEAVEQRC(GLOBALCO))
*                                   /* REG10 HAS ALREADY BEEN SET UP
*                                      WITH POST CODE                */
*       REG11=REG9;                 /* SET UP ECB ADDR IN REG11      */
         LR    REG11,REG9                                          0760
*       CALL POST;                  /* POST CLOBBERS REG10-13        */
         L     @02,CVTPTR                                          0761
         L     @15,CVT0PT01(,@02)                                  0761
         BALR  @14,@15                                             0761
*       RESPECIFY                                                  0762
*        (REG0,                                                    0762
*         REG1,                                                    0762
*         REG10) UNRSTD;                                           0762
*     END;                                                         0763
*                                                                  0763
*   /*****************************************************************/
*   /*                                                               */
*   /* RELEASE OBTAINED LOCKS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0764
*GOODBY:                                                           0764
*   ;                                                              0764
@RC00679 DS    0H                                                  0764
GOODBY   DS    0H                                                  0765
*   GENERATE;                                                      0765
LOCALCR  SETLOCK  RELEASE,TYPE=LOCAL,                                 **
               RELATED=(RSM,IEAVEQRC(LOCALCO))
*   REG12=REG1;                     /* RESTORE REG12                 */
         LR    REG12,REG1                                          0766
*   REG11=REG12+3840;               /* RESTORE 2ND BASE REG  @Z30GNYD*/
*                                                                  0767
         LA    REG11,3840                                          0767
         ALR   REG11,REG12                                         0767
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON EXIT CODE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0768
*   GEN(SETFRR D,WRKREGS=(1,2));                                   0768
         SETFRR D,WRKREGS=(1,2)
*   REG14=CVTSRBRT;                 /* RETURN SRB ADDRESS            */
         L     @10,CVTPTR                                          0769
         L     REG14,CVTSRBRT(,@10)                                0769
*   GOTO REG14;                                                    0770
         BR    REG14                                               0770
*   RESPECIFY                                                      0771
*    (REG9,                                                        0771
*     PCBRPTR,                                                     0771
*     PVTPTR) UNRSTD;                                              0771
*                                                                  0772
*/********************************************************************/
*/*FREE IS ENTERED WHEN FREEPART IS ISSUED FOR V=R REGION.  THE      */
*/*REGION ALLOCATION COULD STILL BE IN PROGRESS OR THE ALLOCATION    */
*/*PROCESS HAS ALREADY COMPLETED.  IF THE PCBRINT BIT IS ON,         */
*/*THE COMPLETE ROUTINE WAS SCHEDULED TO POST THE ECB, THEREFORE     */
*/*IT NEEDS THE PCBR.  DO NOT DEQUEUE IT YET, BUT SET THE PCBRPB     */
*/*BIT SO THAT WHEN COMPLETE DOES GET CONTROL, IT WILL CHECK THE     */
*/*BIT AND DEQUEUE THE PCBR WITHOUT FURTHER PROCESSING.  IF THE      */
*/*PCBRFPCB BIT IS ON, THAT MEANS THAT COMPLETE HAS ALREADY RUN.     */
*/*COMPLETE SET THE BIT TO NOTIFY FREE TO FREE THE PCB IN ADDITION   */
*/*TO FREEING THE REGION FOR V=R.                                    */
*/********************************************************************/
*                                                                  0772
*EP4:                                                              0772
*   ;                                                              0772
EP4      DS    0H                                                  0773
*   RESPECIFY                                                      0773
*    (INPUTPTR,                                                    0773
*     RSMHDPTR,                                                    0773
*     PVTPTR,                                                      0773
*     PCBRPTR) RSTD;                                               0773
*   INPUTPTR=REG1;                                                 0774
         LR    INPUTPTR,REG1                                       0774
*   CALL SETFRR;                    /* GO SET UP FRR AND PVT PTR   0775
*                                                            @ZA31128*/
*                                                                  0775
         BAL   @14,SETFRR                                          0775
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW FRR IS SET UP CONTINUE PROCESSING                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0776
*   RCAVEQRF=ON;                    /* SET UP ENTRY BIT INPUT LIST   */
         L     @14,PVTPRCA(,PVTPTR)                                0776
         OI    RCAVEQRF(@14),B'00000100'                           0776
*   RSMHDPTR=ASCBRSM;                                              0777
         L     @14,ASCBPTR                                         0777
         L     RSMHDPTR,ASCBRSM(,@14)                              0777
*   PCBRPTR=PVTVROOT;               /* PICK UP ADDR OF FIRST PCB ON
*                                      V=R WAIT QUEUE                */
         L     @14,PVTVROOT(,PVTPTR)                               0778
         LR    PCBRPTR,@14                                         0778
*   RESPECIFY                                                      0779
*    (REG5,                                                        0779
*     RSAVE) RSTD;                                                 0779
*   REG5=PVTVROOT;                  /* SAVE BACKWARD PTR             */
*                                                                  0780
         LR    REG5,@14                                            0780
*   /*****************************************************************/
*   /*                                                               */
*   /* BEGIN PCB FREE SEARCH                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0781
*FREELOOP:                                                         0781
*   IF PCBRPTR=ZERO THEN            /* NO PCBR CREATED FOR REGION    */
FREELOOP LTR   PCBRPTR,PCBRPTR                                     0781
         BNZ   @RF00781                                            0781
*     DO;                           /* DO LRA FOR CHECK OF VEQR      */
*       REG1=INPSTART;                                             0783
         L     REG1,INPSTART(,INPUTPTR)                            0783
*       GENERATE;                                                  0784
          LRA  REG8,0(REG1)
          BC   7,BAD
*       IF REG8=INPSTART THEN       /* CONDITION CODE=0, IN CORE     */
         C     REG8,INPSTART(,INPUTPTR)                            0785
         BE    @RT00785                                            0785
*         GOTO FREERGN;             /* VALIDITY CHECK COMPLETE       */
*                                                                  0786
*       /*************************************************************/
*       /*                                                           */
*       /* IF REGION NOT BACKED BY REAL STORAGE, OR NOT MAPPED 1 TO  */
*       /* 1, RECORD ERROR; THEN SET RC AND RETURN.                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0787
*BAD:                                                              0787
*       RCARCRD=27;                 /*                       @ZA03281*/
BAD      L     @14,PVTPRCA(,PVTPTR)                                0787
         MVI   RCARCRD(@14),X'1B'                                  0787
*       GEN(ABEND X'C0D',,,SYSTEM); /*                       @ZA03281*/
         ABEND X'C0D',,,SYSTEM
*       S15=SIXTEEN;                /* INPUT PARAMETER INCORRECT     */
         MVC   S15(4,REG13),@CF00040                               0789
*       GOTO EXITF;                 /* RETURN                        */
         B     EXITF                                               0790
*     END;                                                         0791
*   IF INPSTART=RGNSTART THEN       /* IS PCB REGION START ADDR = TO
*                                      GIVEN START ADDRESS           */
@RF00781 CLC   INPSTART(4,INPUTPTR),RGNSTART(PCBRPTR)              0792
         BNE   @RF00792                                            0792
*     DO;                                                          0793
*                                                                  0793
*       /*************************************************************/
*       /*                                                           */
*       /* IF RINT IS OFF OR FPCB IS ON THEN FREE PCB                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0794
*       IF PCBRINT=OFF×PCBRFPCB=ON THEN                            0794
         TM    PCBRFPCB(PCBRPTR),B'00010000'                       0794
         BNZ   @RT00794                                            0794
         TM    PCBRINT(PCBRPTR),B'10000000'                        0794
         BNO   @RT00794                                            0794
*         GOTO FREEPCB;             /* GO FREE PCB                   */
*       PCBRPB=ON;                                                 0796
         OI    PCBRPB(PCBRPTR),B'00100000'                         0796
*       GOTO FREERGN;               /* TURN ON PCBRPB BIT, SO THAT 0797
*                                      COMPLETE WILL NOT POST ECB    */
         B     FREERGN                                             0797
*     END;                                                         0798
*   REG5=PCBRPTR;                   /* SAVE BACKWARD PTR             */
@RF00792 LR    REG5,PCBRPTR                                        0799
*   PCBRPTR=NEXTPCB;                /* GET NEXT PCB ADDRESS          */
         L     PCBRPTR,NEXTPCB(,PCBRPTR)                           0800
*   GOTO FREELOOP;                  /* GOTO FREE LOOP AGAIN          */
*                                                                  0801
         B     FREELOOP                                            0801
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE PCB SET UP                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0802
*FREEPCB:                                                          0802
*   ;                                                              0802
FREEPCB  DS    0H                                                  0803
*   RESPECIFY                                                      0803
*     REG1 RSTD;                                                   0803
*   REG1=PCBRPTR;                                                  0804
         LR    REG1,PCBRPTR                                        0804
*   IF PVTVROOT=PCBRPTR THEN                                       0805
         C     PCBRPTR,PVTVROOT(,PVTPTR)                           0805
         BNE   @RF00805                                            0805
*     PVTVROOT=NEXTPCB;             /* ONLY 1 ROOT PCB ON QUEUE      */
         MVC   PVTVROOT(4,PVTPTR),NEXTPCB(PCBRPTR)                 0806
*   ELSE                                                           0807
*     DO;                                                          0807
         B     @RC00805                                            0807
@RF00805 DS    0H                                                  0808
*       REG5->NEXTPCB=NEXTPCB;      /* COMPLETE CHAIN                */
         MVC   NEXTPCB(4,REG5),NEXTPCB(PCBRPTR)                    0808
*     END;                                                         0809
*                                                                  0809
*   /*****************************************************************/
*   /*                                                               */
*   /* IF POF IS ON THEN STILL SCHEDULING SRBS, SO CANNOT DEQUEUE    */
*   /* PCBR. IF POF = OFF, SAFE TO DEQUEUE PCBR.                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0810
*   IF COMPSRB^=ZERO THEN                                          0810
@RC00805 L     @14,COMPSRB(,PCBRPTR)                               0810
         LTR   @14,@14                                             0810
         BZ    @RF00810                                            0810
*     DO;                                                          0811
*       RFY                                                        0812
*        (REG0,                                                    0812
*         REG1,                                                    0812
*         REG2,                                                    0812
*         PVTPTR) RSTD;             /*                       @Z30GNYD*/
*       REG0=PVTSRBID;              /* SRB ID TO FREE        @Z30GNYD*/
         L     REG0,PVTSRBID(,PVTPTR)                              0813
*       REG1=COMPSRB;               /* SET ADDR OF SRB TO FREE     0814
*                                                            @Z30GNYD*/
         LR    REG1,@14                                            0814
*       PVTPTR=CVTPVTP;             /* SET PTR TO PVT        @Z30GNYD*/
         L     @14,CVTPTR                                          0815
         L     PVTPTR,CVTPVTP(,@14)                                0815
*       REG2=REG13;                 /* SAVE SAVE AREA PTR ACROSS   0816
*                                      FREECELL              @Z30GNYD*/
         LR    REG2,REG13                                          0816
*       REG13=ADDR(PVTSAVE);        /* SET SAVE AREA PTR FOR FREECELL
*                                                            @Z30GNYD*/
         LA    REG13,PVTSAVE(,PVTPTR)                              0817
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES);/*     0818
*                                                            @Z30GNYD*/
         FREECELL CPID=(0),CELL=(1),BRANCH=YES,SAVE=YES
*       REG13=REG2;                 /* RESTORE PTR TO SAVE AREA    0819
*                                                            @Z30GNYD*/
         LR    REG13,REG2                                          0819
*       REG2=ASCBRSM;               /* RESTORE RSM HEADER POINTER  0820
*                                                            @Z30GNYD*/
         L     @14,ASCBPTR                                         0820
         L     REG2,ASCBRSM(,@14)                                  0820
*       RFY                                                        0821
*        (REG0,                                                    0821
*         REG1,                                                    0821
*         PVTPTR) UNRSTD;           /*                       @Z30GNYD*/
*     END;                          /*                       @Z30GNYD*/
*   IF PCBRPOF='1'B THEN                                           0823
@RF00810 TM    PCBRPOF(PCBRPTR),B'00000001'                        0823
         BNO   @RF00823                                            0823
*     DO;                                                          0824
*       PCBRPOF='0'B;               /* TURN OF POF SO IEAVEQRP WILL
*                                      DEQUEUE                       */
         NI    PCBRPOF(PCBRPTR),B'11111110'                        0825
*       GOTO FREERGN;               /* CONTINUE WITHOUT DEQUEUE      */
         B     FREERGN                                             0826
*     END;                                                         0827
*   REG0=PCBFREQN;                  /* REG0 = '00000010'X            */
@RF00823 LA    REG0,16                                             0828
*   PCBFQP=FREECB;                  /* SEND TO DEQUEUE               */
         MVC   PCBFQP(4,PCBRPTR),FREECB                            0829
*   CALL IEAVPCB;                   /* SEND PCB TO FREE QUEUE        */
         L     @15,PVTPCB(,PVTPTR)                                 0830
         BALR  @14,@15                                             0830
*   RESPECIFY                                                      0831
*    (PCBRPTR,                                                     0831
*     REG1,                                                        0831
*     RSAVE,                                                       0831
*     REG5) UNRSTD;                                                0831
*                                                                  0831
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO FREE V=R REGION                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0832
*   RESPECIFY                                                      0832
*     RVSA RSTD;                                                   0832
*                                                                  0832
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO FREE REGION BY GETTING START ADDRESS                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*FREERGN:                                                          0833
*   RVSA=ZERO;                                                     0833
FREERGN  SLR   RVSA,RVSA                                           0833
*   GENERATE( ICM RVSA,12,INPSTART(INPUTPTR)) ;                    0834
*                                                                  0834
          ICM RVSA,12,INPSTART(INPUTPTR)
*   /*****************************************************************/
*   /*                                                               */
*   /* START VEQR REGION ADDR                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0835
*FREER:                                                            0835
*   ;                                                              0835
FREER    DS    0H                                                  0836
*   RESPECIFY                                                      0836
*    (REG1,                                                        0836
*     RCODE) RSTD;                                                 0836
*   REG1=RVSA;                                                     0837
         LR    REG1,RVSA                                           0837
*   CALL IEAVFP2;                   /* FIND FIRST PGTE OF SEGMENT    */
*                                                                  0838
         L     @15,PVTPFP2(,PVTPTR)                                0838
         BALR  @14,@15                                             0838
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT ZERO, THEN SET UP RETURN CODE 16 AND BACKOUT           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0839
*   IF RCODE^=ZERO THEN                                            0839
         LTR   RCODE,RCODE                                         0839
         BZ    @RF00839                                            0839
*     DO;                                                          0840
*       S15=SIXTEEN;                /* RETURN CODE = 16              */
         MVC   S15(4,REG13),@CF00040                               0841
*       GOTO UPPFTE2;               /* CLEAN UP BEFORE LEAVING       */
         B     UPPFTE2                                             0842
*     END;                                                         0843
*   RESPECIFY                                                      0844
*     RCODE UNRSTD;                                                0844
@RF00839 DS    0H                                                  0845
*   RESPECIFY                                                      0845
*    (COUNT,                                                       0845
*     PTEPTR) RSTD;                                                0845
*   PTEPTR=REG0;                    /* FIRST PAGE TABLE ENTRY ADDRESS*/
*                                                                  0846
         LR    PTEPTR,REG0                                         0846
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK EACH PAGE OF THE SEGMENT FOR THE ASSIGNED BIT. IF ON,   */
*   /* CHECK IF PAGE IS WITHIN V=R REGION. IF IT IS, INVALIDATE PAGE */
*   /* TABLE ENTRY AND CONTINUE CHECKING. WHEN ALL PAGES IN A SEGMENT*/
*   /* HAVE BEEN INVALIDATED, CALL IEAVDSEG TO DESTROY THE SEGMENT.  */
*   /* THEN FREEMAIN THE PAGE TABLES. FOR SEGMENTS PARTIALLY         */
*   /* ALLOCATED TO THE V=R REGION, ONLY THE RELEVANT PAGE TABLE     */
*   /* ENTRIES ARE INVALIDATED. ONCE ALL NECESSARY PAGE TABLE ENTRIES*/
*   /* HAVE BEEN INVALIDATED AND SEGMENTS DESTROYED, THE FRAMES ARE  */
*   /* SENT TO THE AVAILABLE FRAME QUEUE.                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0847
*   COUNT=0;                                                       0847
         SLR   COUNT,COUNT                                         0847
*   DO REG1=1 TO 16;                                               0848
         LA    REG1,1                                              0848
@DL00848 DS    0H                                                  0849
*     IF PGTPAM=OFF THEN            /* ASSIGNED BIT                  */
         TM    PGTPAM(PTEPTR),B'00000001'                          0849
         BNZ   @RF00849                                            0849
*       DO;                                                        0850
*         COUNT=COUNT+ONE;          /* PAM=OFF COUNTER               */
         AL    COUNT,@CF00044                                      0851
*         GOTO INCRE;                                              0852
         B     INCRE                                               0852
*       END;                                                       0853
*                                                                  0853
*     /***************************************************************/
*     /*                                                             */
*     /* IF GREATER THAN V=R START, CHECK IF GREATER THAN END        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0854
*     IF RVSA>=INPSTART THEN                                       0854
@RF00849 L     @10,INPSTART(,INPUTPTR)                             0854
         CR    RVSA,@10                                            0854
         BL    @RF00854                                            0854
*       DO;                                                        0855
*                                                                  0855
*         /***********************************************************/
*         /*                                                         */
*         /* IF ADDR IS GREATER THEN V=R REGION, DO NOT FREE PAGE    */
*         /* SPACE                                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0856
*         IF RVSA>=INPSTART+(INPAGES*K4) THEN                      0856
         LH    @07,INPAGES(,INPUTPTR)                              0856
         SLA   @07,12                                              0856
         ALR   @10,@07                                             0856
         CR    RVSA,@10                                            0856
         BNL   @RT00856                                            0856
*           GOTO UPPFTE;                                           0857
*                                                                  0857
*         /***********************************************************/
*         /*                                                         */
*         /* PAM IS ON IN V=R REGION, SO TURN IT OFF AND CONTINUE    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0858
*         PGTRSA=0;                 /* TO PREVENT RECLAIM            */
         SLR   @10,@10                                             0858
         STH   @10,PGTRSA(,PTEPTR)                                 0858
*         PGTPVM=ON;                                               0859
         OI    PGTPVM(PTEPTR),B'00001000'                          0859
*         COUNT=COUNT+1;                                           0860
         AL    COUNT,@CF00044                                      0860
*       END;                                                       0861
*                                                                  0861
*     /***************************************************************/
*     /*                                                             */
*     /* INCREMENT TO NEXT PGTE AND CONTINUE                         */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0862
*INCRE:                                                            0862
*     PTEPTR=PTEPTR+LENGTH(PGTPTE); /* INCRE TO NEXT PAGE TABLE ENTRY*/
@RF00854 DS    0H                                                  0862
INCRE    AH    PTEPTR,@CH00058                                     0862
*     RVSA=RVSA+K4;                 /* INCRE TO NEXT FRAME           */
         AL    RVSA,@CF00054                                       0863
*   END;                                                           0864
*                                                                  0864
         AL    REG1,@CF00044                                       0864
         CH    REG1,@CH00040                                       0864
         BNH   @DL00848                                            0864
*   /*****************************************************************/
*   /*                                                               */
*   /* IF ALL PAGES IN SEGMENT HAD PAM BIT OFF OR WERE IN V=R REGION */
*   /* THEN FREE PAGE TABLE SPACE FOR THAT SEGMENT.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0865
*   IF COUNT=16 THEN                /* ALL 16 PAGES CAN BE         0865
*                                      INVALIDATED                   */
         CH    COUNT,@CH00040                                      0865
         BNE   @RF00865                                            0865
*     DO;                                                          0866
*       REG0=RVSA-K4;                                              0867
         LR    REG0,RVSA                                           0867
         SL    REG0,@CF00054                                       0867
*       GENERATE;                                                  0868
           SRL REG0,16               SET UP REG0
*       CALL IEAVDSEG;              /* DESTROY SEGMENT               */
         L     @15,PVTPDSEG(,PVTPTR)                               0869
         BALR  @14,@15                                             0869
*       RFY                                                        0870
*         REG10 RSTD;                                              0870
*       REG10=REG1;                 /* SAVE PGTE AREA ADDRESS        */
         LR    REG10,REG1                                          0871
*       RCACSECT=RCACVR;                                           0872
         L     @07,PVTPRCA(,PVTPTR)                                0872
         MVI   RCACSECT(@07),X'05'                                 0872
*       RESPECIFY                                                  0873
*        (REG0,                                                    0873
*         REG4,                                                    0873
*         REG7,                                                    0873
*         RCODE) RSTD;                                             0873
*       SAVERCA=PVTPRCA;                                           0874
         L     @14,PVTPRCA(,PVTPTR)                                0874
         ST    @14,SAVERCA(,PVTPTR)                                0874
*       REG4=PSATOLD;                                              0875
         L     REG4,PSATOLD                                        0875
*       REG7=PSAAOLD;                                              0876
         L     REG7,PSAAOLD                                        0876
*       REG1=REG10;                                                0877
         LR    REG1,REG10                                          0877
*       REG0=SIXTEEN*(LENGTH(PGTPTE)+LENGTH(XPTE));                0878
         LA    REG0,224                                            0878
*       GENERATE( FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES) ;    0879
          FREEMAIN RC,LV=(0),A=(1),SP=255,BRANCH=YES
*       PVTPTR=CVTPVTP;                                            0880
         L     @14,CVTPTR                                          0880
         L     PVTPTR,CVTPVTP(,@14)                                0880
*       PVTPRCA=SAVERCA;                                           0881
*                                                                  0881
         L     @14,SAVERCA(,PVTPTR)                                0881
         ST    @14,PVTPRCA(,PVTPTR)                                0881
*       /*************************************************************/
*       /*                                                           */
*       /* RETURN CODE DOES NOT EQUAL 0 THEN RECORD ERROR            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0882
*       IF RCODE^=ZERO THEN                                        0882
         LTR   RCODE,RCODE                                         0882
         BZ    @RF00882                                            0882
*         DO;                                                      0883
*           RCARCRD=3;                                             0884
         MVI   RCARCRD(@14),X'03'                                  0884
*           GENERATE CODE;                                         0885
                 ABEND X'C0D',,,SYSTEM
*         END;                                                     0886
*       RESPECIFY                                                  0887
*        (REG0,                                                    0887
*         REG1,                                                    0887
*         REG4,                                                    0887
*         REG7,                                                    0887
*         REG10,                                                   0887
*         RCODE) UNRSTD;                                           0887
@RF00882 DS    0H                                                  0888
*     END;                                                         0888
*                                                                  0888
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE CURRENT ADDR IS GREATER THAN THE V=R REGION END ADDR,  */
*   /* DO NOT DESTROY THE SEGMENT OR FREEMAIN PAGE TABLES, BUT       */
*   /* REQUEUE THE FRAMES. OTHERWISE, WORK ON THE NEXT SEGMENTS PAGE */
*   /* TABLES.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0889
*   IF RVSA>INPSTART+((INPAGES-1)*K4) THEN                         0889
@RF00865 LH    @10,INPAGES(,INPUTPTR)                              0889
         BCTR  @10,0                                               0889
         SLA   @10,12                                              0889
         AL    @10,INPSTART(,INPUTPTR)                             0889
         CR    RVSA,@10                                            0889
         BH    @RT00889                                            0889
*     GOTO UPPFTE;                  /* GO SET RETURN CODE TO ZERO    */
*   GOTO FREER;                     /* GO AND FREE REGION            */
         B     FREER                                               0891
*   RESPECIFY                                                      0892
*    (PTEPTR,                                                      0892
*     RVSA,                                                        0892
*     REG1,                                                        0892
*     REG7,                                                        0892
*     COUNT) UNRSTD;                                               0892
*                                                                  0892
*   /*****************************************************************/
*   /*                                                               */
*   /* SET RETURN CODE TO 0                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0893
*UPPFTE:                                                           0893
*   S15=ZERO;                                                      0893
*                                                                  0893
UPPFTE   SLR   @10,@10                                             0893
         ST    @10,S15(,REG13)                                     0893
*/********************************************************************/
*/*THIS ROUTINE IS ENTERED TO MOVE FRAMES BACK TO THE AFQ FROM  THE  */
*/*LOCAL QUEUE OR FROM AN UNQUEUED STATE.                            */
*/********************************************************************/
*                                                                  0894
*UPPFTE2:                                                          0894
*   ;                                                              0894
UPPFTE2  DS    0H                                                  0895
*   RESPECIFY                                                      0895
*     PFTEPTR RSTD;                                                0895
*   PFTEPTR=PVTPFTP+((INPSTART/K4)*SIXTEEN);                       0896
         L     @00,INPSTART(,INPUTPTR)                             0896
         SRDA  @00,32                                              0896
         D     @00,@CF00054                                        0896
         SLA   @01,4                                               0896
         AL    @01,PVTPFTP(,PVTPTR)                                0896
         LR    PFTEPTR,@01                                         0896
*   RESPECIFY                                                      0897
*     COUNT RSTD;                                                  0897
*   DO COUNT=1 TO INPAGES;                                         0898
         LA    COUNT,1                                             0898
         B     @DE00898                                            0898
@DL00898 DS    0H                                                  0899
*     PFTVRALC=OFF;                 /* TURN OFF V=R ALLOC BIT        */
         NI    PFTVRALC(PFTEPTR),B'11111101'                       0899
*     IF PFTVRINT=ON THEN           /* IF OFF, THEN FRAME ON LOCAL 0900
*                                      QUEUE                         */
         TM    PFTVRINT(PFTEPTR),B'01000000'                       0900
         BNO   @RF00900                                            0900
*       DO;                                                        0901
*         PFTVRINT=OFF;             /* TURN OFF INTERCEPT BIT        */
         NI    PFTVRINT(PFTEPTR),B'10111111'                       0902
*         IF PFTQNDX^=PFTNQN THEN   /* IF FRAME QUEUED, LET ALONE    */
         CLI   PFTQNDX(PFTEPTR),X'FF'                              0903
         BNE   @RT00903                                            0903
*           GOTO LASTPFTE;                                         0904
*                                                                  0904
*         /***********************************************************/
*         /*                                                         */
*         /* FRAME MAY BE DEQUEUED BUT HAVE I/O IN PROGRESS IF       */
*         /* DEQUEUE WAS A RESULT OF GOING THRU MEMORY TERMINATION   */
*         /* FOR THE ADDRESS SPACE THAT OWNED THE FRAME WHEN IT WAS  */
*         /* INTERCEPTED.                                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0905
*         IF PFTPCBSI='1'B THEN     /* IF UNQUEUED BUT I/O IN      0905
*                                      PROGRESS, LET ALONE   @ZA10767*/
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0905
         BO    @RT00905                                            0905
*           GOTO LASTPFTE;          /*                       @ZA10767*/
*       END;                                                       0907
*     ELSE                                                         0908
*                                                                  0908
*       /*************************************************************/
*       /*                                                           */
*       /* THE FRAME IS NOT MARKED AS INTERCEPTED. ENSURE THAT IT IS */
*       /* ON THE LOCAL FRAME QUEUE OF THE CURRENT ADDRESS SPACE, AND*/
*       /* AND THAT IT'S VBN AND RBN ARE EQUAL BEFORE SENDING THE    */
*       /* FRAME TO THE AVQ. IF ANY OF THESE CHECKS FAILS, THE FRAME */
*       /* IS LEFT ALONE. THIS PREVENTS FREEING A FRAME THAT IS      */
*       /* ALREADY ON THE AVAILABLE FRAME QUEUE, OR THAT WAS         */
*       /* RE-ALLOCATED AFTER V=R INTERCEPT SENT IT BACK TO PFTE     */
*       /* MANAGER BECAUSE THE ROOT PCB HAD BEEN FAILED.             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0908
*       DO;                                                        0908
         B     @RC00900                                            0908
@RF00900 DS    0H                                                  0909
*         IF(PSAAOLD->ASCBASID^=PFTASID)×((PFTEPTR-PVTPFTP)^=PFTVBN)×(
*             PFTQNDX^=PFTLFQN) THEN/*                       @ZA10767*/
         L     @10,PSAAOLD                                         0909
         CLC   ASCBASID(2,@10),PFTASID(PFTEPTR)                    0909
         BNE   @RT00909                                            0909
         LR    @10,PFTEPTR                                         0909
         SL    @10,PVTPFTP(,PVTPTR)                                0909
         SLR   @07,@07                                             0909
         ICM   @07,3,PFTVBN(PFTEPTR)                               0909
         CR    @10,@07                                             0909
         BNE   @RT00909                                            0909
         CLI   PFTQNDX(PFTEPTR),X'80'                              0909
         BNE   @RT00909                                            0909
*           GOTO LASTPFTE;          /* WRONG FRAME, GET NEXT PFTE  0910
*                                                            @ZA10767*/
*       END;                                                       0911
*                                                                  0911
*     /***************************************************************/
*     /*                                                             */
*     /* CALL PFTE MANAGER TO MOVE FRAME FROM LOCAL QUEUE OR IN A    */
*     /* DEQUEUED STATE TO THE AVAILABLE FRAME QUEUE.                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0912
*     IF PFTQNDX=PFTLFQN THEN       /* IS FRAME ON LOCAL QUEUE     0912
*                                                            @YA01572*/
@RC00900 CLI   PFTQNDX(PFTEPTR),X'80'                              0912
         BNE   @RF00912                                            0912
*       DO;                         /* YES, DECREMENT COUNTERS     0913
*                                                            @YA01572*/
*         RSMHDPTR=ASCBRSM;         /* RESTORE RSMHD POINTER @YA01572*/
         L     @10,ASCBPTR                                         0914
         L     RSMHDPTR,ASCBRSM(,@10)                              0914
*         RSMCNTFX=RSMCNTFX-1;      /* DECREMENT COUNT FOR THIS    0915
*                                      ADDRESS SPACE         @YA01572*/
         LH    @10,RSMCNTFX(,RSMHDPTR)                             0915
         BCTR  @10,0                                               0915
         STH   @10,RSMCNTFX(,RSMHDPTR)                             0915
*         PVTCNTFX=PVTCNTFX-1;      /* DECREMENT SYSTEM COUNT      0916
*                                                            @YA01572*/
         LH    @10,PVTCNTFX(,PVTPTR)                               0916
         BCTR  @10,0                                               0916
         STH   @10,PVTCNTFX(,PVTPTR)                               0916
*       END;                                                       0917
*     REG0=PFTEPTR-PVTPFTP;         /* TQID = 00, RBN = SUBTRACTION  */
@RF00912 LR    REG0,PFTEPTR                                        0918
         SL    REG0,PVTPFTP(,PVTPTR)                               0918
*     GENERATE(ICM   REG0,12,HEADQ) ;/* MOVE PFTE TO HEAD OF AFQ     */
         ICM   REG0,12,HEADQ
*     CALL IEAPFTE;                                                0920
*                                                                  0920
         L     @15,PVTPFTE(,PVTPTR)                                0920
         BALR  @14,@15                                             0920
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK EACH PFTE                                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0921
*LASTPFTE:                                                         0921
*     PFTEPTR=PFTEPTR+LENGTH(PFTE);                                0921
LASTPFTE AL    PFTEPTR,@CF00040                                    0921
*   END;                                                           0922
         AL    COUNT,@CF00044                                      0922
@DE00898 CH    COUNT,INPAGES(,INPUTPTR)                            0922
         BNH   @DL00898                                            0922
*   RESPECIFY                                                      0923
*     COUNT UNRSTD;                                                0923
*   REG1=0;                                                        0924
         SLR   REG1,REG1                                           0924
*   CALL IEAVINV;                   /* CALL INVALIDATE FOR PTLBS     */
         L     @15,PVTPINV(,PVTPTR)                                0925
         BALR  @14,@15                                             0925
*   ASCBVEQR='0'B;                  /* TURN OFF BIT THAT INDICATES 0926
*                                      THAT THIS ADDRESS SPACE SHOULD
*                                      NOT BE SWAPPED-OUT. THE REAL
*                                      REGION HAS BEEN FREED VIA   0926
*                                      FREEPART.             @ZA16816*/
*                                                                  0926
         L     @04,ASCBPTR                                         0926
         L     @10,ASCBVEQR(,@04)                                  0926
@GL00022 LR    @07,@10                                             0926
         N     @07,@CF02396                                        0926
         CS    @10,@07,ASCBVEQR(@04)                               0926
         BNE   @GL00022                                            0926
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON EXIT CODE                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0927
*EXITF:                                                            0927
*   ;                                                              0927
EXITF    DS    0H                                                  0928
*   GEN SETS(REG1,REG2)(SETFRR D,WRKREGS=(1,2));/*           @ZA31128*/
         SETFRR D,WRKREGS=(1,2)
*   LM(REG14,REG12,CALLREGS(13:72));/* RESTORE REGS          @ZA31128*/
         LM    REG14,REG12,CALLREGS+12(REG13)                      0929
*   GOTO REG14;                     /* RETURN                @ZA31128*/
         BR    REG14                                               0930
*   RESPECIFY                                                      0931
*    (COUNT,                                                       0931
*     INPUTPTR,                                                    0931
*     PFTEPTR,                                                     0931
*     PVTPTR) UNRSTD;                                              0931
*   RFY                                                            0932
*    (PCBRPTR,                                                     0932
*     RCODE,                                                       0932
*     PVTPTR,                                                      0932
*     PFTEPTR,                                                     0932
*     SRBPTR) RSTD;                                                0932
*                                                                  0932
*   /*****************************************************************/
*   /*                                                               */
*   /* IEAVEQRP IS SCHEDULED BY IEAVEQR AND IEAVEQRP WHEN A V=R      */
*   /* INTERCEPTED FRAME WAS NOT PAGED OUT. IEAVEQRP WILL REQUEST    */
*   /* THAT THE ADDRESS SPACE BE SWAPPED OUT. A SUCCESSFUL RETURN    */
*   /* CODE FROM THE REQUEST SWAP SYSEVENT WILL ELIMINATE PAGE-OUTS  */
*   /* FOR THE ADDRESS SPACE. IF THE ADDRESS SPACE IS NON-SWAPPABLE, */
*   /* THE V=R INTERCEPTED FRAMES ARE PAGED OUT. THE SWAP OUT OR PAGE*/
*   /* OUT WILL FREE THE FRAME THEREBY ALLOWING IEAVEQRI TO OBTAIN IT*/
*   /* FOR THE V=R REQUEST.                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0933
*EP5:                                                              0933
*   ;                                                              0933
EP5      DS    0H                                                  0934
*   RFY                                                            0934
*    (REG0,                                                        0934
*     REG1,                                                        0934
*     REG2,                                                        0934
*     REG5,                                                        0934
*     REG9,                                                        0934
*     REG10) RSTD;                  /*                       @ZA10767*/
*   PVTPTR=CVTPVTP;                 /* GET ADDRESS OF PVT    @ZA10767*/
         L     @14,CVTPTR                                          0935
         L     PVTPTR,CVTPVTP(,@14)                                0935
*   REG8=PVTPRCV;                   /* GET ADDRESS OF RSM RECOVERY 0936
*                                      RTN                   @ZA10767*/
         L     REG8,PVTPRCV(,PVTPTR)                               0936
*   GEN(SETFRR A,FRRAD=(REG8),WRKREGS=(REG9,REG10),PARMAD=(REG2));/*
*                                      THE COMMON SETFRR ROUTINE IS
*                                      NOT USED AT THIS ENTRY POINT
*                                      SINCE IT STORES THE RCA     0937
*                                      POINTER IN THE PVT, BUT THE 0937
*                                      SALLOC LOCK IS NOT HELD HERE.
*                                                            @ZA10767*/
         SETFRR A,FRRAD=(REG8),WRKREGS=(REG9,REG10),PARMAD=(REG2)
*   RFY                                                            0938
*     RCA BASED(REG2);              /* REG2 CONTAINS ADDRESS OF RCA
*                                                            @ZA10767*/
*   RCACSECT=RCACVR;                /* INDICATE V=R CSECT IN RCA   0939
*                                                            @ZA10767*/
         MVI   RCACSECT(REG2),X'05'                                0939
*   RCAVEQRP='1'B;                  /* ENTRY BIT                     */
         OI    RCAVEQRP(REG2),B'00001000'                          0940
*   PCBRPTR=REG1;                   /* SET UP PCBRPTR                */
         LR    PCBRPTR,REG1                                        0941
*   SRBPTR=REG0;                    /* INITIALIZE SRBPTR     @ZA10767*/
         LR    SRBPTR,REG0                                         0942
*   REG5=REG12;                     /* SAVE BASE REG                 */
         LR    REG5,REG12                                          0943
*   REG9=ZERO;                      /* INITIALIZE REG9 TO INDICATE 0944
*                                      SWAP OUT ALREADY REQUESTED  0944
*                                                            @ZA10767*/
*                                                                  0944
         SLR   REG9,REG9                                           0944
*   /*****************************************************************/
*   /*                                                               */
*   /* BE SURE THAT THE ADDRESS SPACE HAS AN SPCT. IF IT DOES NOT,   */
*   /* INDICATE IN REG9 THAT THE ADDRESS SPACE WAS NOT SWAPPED OUT.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0945
*   IF PSAAOLD->ASCBRSM->RSMSPCT=0 THEN/* ANY SPCT ?         @ZA10767*/
         L     @14,PSAAOLD                                         0945
         L     @14,ASCBRSM(,@14)                                   0945
         ICM   @07,15,RSMSPCT(@14)                                 0945
         BNZ   @RF00945                                            0945
*     REG9=4;                       /* NO, INDICATE SWAPOUT NOT DONE
*                                                            @ZA10767*/
         LA    REG9,4                                              0946
*   ELSE                            /* SPCT EXISTS           @ZA10767*/
*     DO;                           /* SWAP OUT THE ADDRESS SAPCE  0947
*                                                            @ZA10767*/
         B     @RC00945                                            0947
@RF00945 DS    0H                                                  0948
*       GENERATE;                                                  0948
GLL SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(RSM,IEAVEQRP(RL))
*       REG12=REG5;                 /* RESTORE BASE REG      @ZA10767*/
         LR    REG12,REG5                                          0949
*       REG11=REG12+3840;           /* RESTORE SECOND BASE REGISTER
*                                                            @ZA10767*/
*                                                                  0950
         LA    REG11,3840                                          0950
         ALR   REG11,REG12                                         0950
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARMS FOR REQUEST SWAP                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0951
*       REG0=ZERO;                  /* INDICATE THAT THE CURRENT   0951
*                                      ADDRESS SPACE IS TO BE SWAPPED
*                                      OUT                   @ZA10767*/
         SLR   REG0,REG0                                           0951
*       REG1=ZERO;                  /* INDICATE THAT NO ECB        0952
*                                      DEPENDANCY EXISTS     @ZA10767*/
         SLR   REG1,REG1                                           0952
*       REG13=WSALRSM;              /* SET UP SAVE AREA ADDRESS    0953
*                                                            @ZA21128*/
         L     @14,ASCBPTR                                         0953
         L     @14,ASXBPTR(,@14)                                   0953
         L     @14,ASXBSPSA(,@14)                                  0953
         L     REG13,WSALRSM(,@14)                                 0953
*       GEN(SYSEVENT REQSWAP,ASID=(0),ENTRY=BRANCH);/* ISSUE REQSWAP
*                                      SYSEVENT              @ZA10767*/
         SYSEVENT REQSWAP,ASID=(0),ENTRY=BRANCH
*       REG9=REG1;                  /* SAVE RETURN CODE      @ZA10767*/
         LR    REG9,REG1                                           0955
*       IF REG1^=4 THEN             /* WAS THIS ADDRESS SPACE BEING
*                                      SWAPPED OUT ALREADY,(RCODE=8)
*                                      OR WAS THE REQUEST SWAP     0956
*                                      HONORED,(RCODE=0) ?   @ZA10767*/
         CH    REG1,@CH00036                                       0956
         BE    @RF00956                                            0956
*         DO;                       /* YES, THE ADDRESS WILL GET   0957
*                                      SWAPPED OUT, FREEING ANY V=R
*                                      INTERCEPTED FRAMES    @ZA10767*/
*           PSAAOLD->ASCBRSM->RSMSPCT->SPCTVROT=ON;/* INDICATE THAT
*                                      IEAVEQRP HAS REQUESTED THAT 0958
*                                      THIS ADDRESS SPACE BE SWAPPED
*                                      OUT                   @ZA10767*/
         L     @14,PSAAOLD                                         0958
         L     @14,ASCBRSM(,@14)                                   0958
         L     @14,RSMSPCT(,@14)                                   0958
         OI    SPCTVROT(@14),B'00000100'                           0958
*         END;                                                     0959
*       GENERATE;                                                  0960
@RF00956 DS    0H                                                  0960
RL       SETLOCK RELEASE,TYPE=LOCAL,RELATED=(RSM,IEAVEQRP(GLL))
*     END;                                                         0961
*   GENERATE;                                                      0962
@RC00945 DS    0H                                                  0962
GOB SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,RELATED=(RSM,IEAVEQRP(RG))
*   REG12=REG5;                     /* RESTORE BASE REG ADDRESS      */
         LR    REG12,REG5                                          0963
*   REG11=REG12+3840;               /* RESTORE 2ND BASE REG  @Z30GNYD*/
         LA    REG11,3840                                          0964
         ALR   REG11,REG12                                         0964
*   PVTPRCA=REG2;                   /* RCA ADDRESS TO PVT    @ZA10767*/
         ST    REG2,PVTPRCA(,PVTPTR)                               0965
*   REG10=SRBPTR;                   /* SAVE SRB ADDRESS      @ZA10767*/
         LR    REG10,SRBPTR                                        0966
*   RFY                                                            0967
*     RCA BASED(PVTPRCA);           /*                       @ZA10767*/
*   RFY                                                            0968
*    (REG2,                                                        0968
*     REG5) UNRSTD;                 /*                       @ZA10767*/
*                                                                  0968
*   /*****************************************************************/
*   /*                                                               */
*   /* PCBRPOF BIT IS TURNED ON BY V=R ALLOCATION BEFORE THE FIRST   */
*   /* SCHEDULE OF THIS ROUTINE. IF IEAVEQR OR IEAVEQRF IS GIVEN     */
*   /* CONTROL WITH THE BIT ON, THEY CANNOT FREE THE PCBR SINCE THIS */
*   /* ROUTINE WILL CHECK THE BIT IN THE PCBR. THEY WILL HAVE TO TURN*/
*   /* OFF THE POF BIT TO INDICATE TO THIS ROUTINE TO FREE THE PCBR  */
*   /* AND TERMINATE ANY FURTHER PROCESSING. NORMALLY, THIS ROUTINE  */
*   /* WILL GET CONTROL WITH POF ON AND WILL EVENTUALLY TURN IT OFF  */
*   /* AFTER THE LAST ADDRESS SPACE PAGE OUT. HOWVER, IF THE ROUTINE */
*   /* FINDS THAT THE ALLOCATION HAS BEEN FAILED (PCBRFAIL=1), IT    */
*   /* WILL TURN OFF PCBRPOF, FREE ITS SRB, AND EXIT TO PREVENT      */
*   /* FURTHER SCHEDULING OF THE ROUTINE. IF THE ADDRESS SPACE THAT  */
*   /* THE SRB WAS SCHEDULED IN TERMINATES, THE RMTR WILL GET CONTROL*/
*   /* AND SCHEDULE THE SRB INTO MASTER'S ADDRESS SPACE SO THAT      */
*   /* PAGEOUTS OF INTERCEPTED FRAMES CAN CONTINUE.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0969
*   IF PCBRPOF='0'B THEN            /* IF OFF, DEQUEUE PCBR AND GET
*                                      OUT                           */
         TM    PCBRPOF(PCBRPTR),B'00000001'                        0969
         BNZ   @RF00969                                            0969
*     DO;                                                          0970
*       PCBFQP=FREECB;              /* SET UP FREE INDICATION        */
         MVC   PCBFQP(4,PCBRPTR),FREECB                            0971
*       RSMHDPTR=PCBRASCB->ASCBRSM; /* RSMHEAD PTR                   */
         L     @14,PCBRASCB(,PCBRPTR)                              0972
         L     RSMHDPTR,ASCBRSM(,@14)                              0972
*       REG0=PCBFREQN;              /* FREE QUEUE                    */
         LA    REG0,16                                             0973
*       REG1=PCBRPTR;               /* PCBR ADDRESS TO DEQUEUE       */
         LR    REG1,PCBRPTR                                        0974
*       CALL IEAVPCB;               /* CALL PCB MANAGER TO DEQUEUE   */
         L     @15,PVTPCB(,PVTPTR)                                 0975
         BALR  @14,@15                                             0975
*       GOTO ENDIT;                 /* GO FREE SRB, RELEASE LOCK, AND
*                                      RETURN                        */
         B     ENDIT                                               0976
*     END;                                                         0977
*   IF PCBRFAIL='1'B THEN           /* ALLOCATION FAILED ?   @ZA10767*/
@RF00969 TM    PCBRFAIL(PCBRPTR),B'00001000'                       0978
         BNO   @RF00978                                            0978
*     DO;                           /* YES                   @ZA10767*/
*       PCBRPOF='0'B;               /* STOP PAGEOUT SRB      @ZA10767*/
         NI    PCBRPOF(PCBRPTR),B'11111110'                        0980
*       GOTO ENDIT;                 /* FREE PAGEOUT SRB      @ZA10767*/
         B     ENDIT                                               0981
*     END;                          /*                       @ZA10767*/
*                                                                  0982
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE ADDRESS SPACE IS NOT BEING SWAPPED, EXAMINE EACH FRAME */
*   /* IN THE V=R REGION TO SEE IF IT CAN BE PAGED OUT. THE FRAME    */
*   /* MUST HAVE THE FOLLOWING ATTRIBUTES IN ORDER TO BE PAGED OUT:  */
*   /* (1) CURRENT ASID, (2) LOCAL Q, (3) NO I/O IN PROGRESS, (4) NOT*/
*   /* AN IRREG FRAME, (5) NOT FIXED.                        @ZA31128*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0983
*   IF REG9=4 THEN                  /* ADDR SPACE BEING SWAPPED ?  0983
*                                                            @ZA31128*/
@RF00978 CH    REG9,@CH00036                                       0983
         BNE   @RF00983                                            0983
*     DO;                           /* NO                    @ZA31128*/
*       RFY                                                        0985
*         REG9 UNRSTD;                                             0985
*       PFTEPTR=PVTPFTP+STARTRBN;   /* ADDR FIRST FRAME      @ZA31128*/
         L     PFTEPTR,PVTPFTP(,PVTPTR)                            0986
         AL    PFTEPTR,STARTRBN(,PCBRPTR)                          0986
*       DO UNTIL PFTEPTR>PVTPFTP+ENDRBN;/* TRY PAGEOUTS      @ZA31128*/
@DL00987 DS    0H                                                  0988
*         IF PFTASID=PSAAOLD->ASCBASID&/* IF CURRENT ASID,   @ZA31128*/
*             PFTQNDX=PFTLFQN&      /* AND ON LOCAL QUEUE,   @ZA31128*/
*             PFTPCBSI='0'B&        /* AND NO I/O GOING ON,  @ZA31128*/
*             PFTIRRG='0'B&         /* AND NOT IRREG FRAME,  @ZA31128*/
*             PFTFXCT=0 THEN        /* AND NOT FIXED, THEN CAN DO  0988
*                                      PAGEOUT               @ZA31128*/
*                                                                  0988
         L     @14,PSAAOLD                                         0988
         CLC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    0988
         BNE   @RF00988                                            0988
         CLI   PFTQNDX(PFTEPTR),X'80'                              0988
         BNE   @RF00988                                            0988
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0988
         BNZ   @RF00988                                            0988
         TM    PFTIRRG(PFTEPTR),B'00010000'                        0988
         BNZ   @RF00988                                            0988
         ICM   @14,3,PFTFXCT(PFTEPTR)                              0988
         BNZ   @RF00988                                            0988
*           /*********************************************************/
*           /*                                                       */
*           /* THE FRAME PASSED THE ABOVE CHECKS. SET UP THE         */
*           /* INTERFACE FOR IEVPSII AND DO THE PAGE OUT.            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0989
*           DO;                                                    0989
*             REG0=0;               /* SET UP TO PAGE OUT            */
         SLR   REG0,REG0                                           0990
*             REG1=PFTVBN*256;      /* VIRTUAL ADDR                  */
         SLR   REG1,REG1                                           0991
         ICM   REG1,3,PFTVBN(PFTEPTR)                              0991
         SLA   REG1,8                                              0991
*             REG2=REG1+4096;       /* END ADDRESS                   */
         LR    REG2,REG1                                           0992
         AL    REG2,@CF00054                                       0992
*             GEN(ICM   REG2,8,PGOUT) ;/* GET PAGEOUT INDICATION     */
         ICM   REG2,8,PGOUT
*             REG4=PCBRTCB;         /* TCB ADDRESS                   */
         L     REG4,PCBRTCB(,PCBRPTR)                              0994
*             CALL PSII;            /* CALL PSI TO CALL PAGEOUT      */
         L     @15,PVTPSINT(,PVTPTR)                               0995
         BALR  @14,@15                                             0995
*           END;                                                   0996
*         PFTEPTR=PFTEPTR+LENGTH(PFTE);/* ADDR NEXT PFTE             */
@RF00988 AL    PFTEPTR,@CF00040                                    0997
*       END;                        /*                       @ZA31128*/
@DE00987 L     @14,PVTPFTP(,PVTPTR)                                0998
         AL    @14,ENDRBN(,PCBRPTR)                                0998
         CR    PFTEPTR,@14                                         0998
         BNH   @DL00987                                            0998
*     END;                          /*                       @ZA31128*/
*                                                                  0999
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL PFTES HAVE BEEN CHECKED FOR POSSIBLE PAGEOUT. CHECK FOR   */
*   /* PAGES IN OTHER ADDRESS SPACES THAT NEED TO GO OUT. IF ONE IS  */
*   /* FOUND, REUSE SRB AND SCHEDULE IT TO THAT ADDRESS SPACE. IF ONE*/
*   /* IS NOT FOUND TURN OF POF BIT AND FREE SRB.                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1000
*   PFTEPTR=PVTPFTP+STARTRBN;       /* START AT BEGINNING            */
@RF00983 L     PFTEPTR,PVTPFTP(,PVTPTR)                            1000
         AL    PFTEPTR,STARTRBN(,PCBRPTR)                          1000
*   SRBPTR=REG10;                   /* REINIT SRBPTR                 */
*                                                                  1001
         LR    SRBPTR,REG10                                        1001
*   /*****************************************************************/
*   /*                                                               */
*   /* EXAMINE EACH FRAME IN THE V=R REGION FOR THE FOLLOWING        */
*   /* CONDITIONS: (1) FRAME IS FOR ASID JUST PROCESSED, (2) FRAME IS*/
*   /* FOR ASID THAT THIS V=R ALLOCATION IS BEING DONE FOR, (3) FRAME*/
*   /* IS UNQUEUED, (4) FRAME IS FIXED, (5) FRAME HAS I/O IN         */
*   /* PROGRESS, (6) FRAME IS VIO AND THEREFORE HAS NO ASID. IF ANY  */
*   /* CONDITION IS MET, THE NEXT FRAME IN THE POTENTIAL V=R REGION  */
*   /* IS EXAMINED. IF NO CONDITION IS MET, IEAVEQRP SCHEDULES ITSELF*/
*   /* INTO THE ADDRESS SPACE WHOSE ASID IS IN THE PFTE FOR THE      */
*   /* FRAME. IF ALL PFTE'S ARE EXAMINED AND ALL MEET AT LEAST ONE   */
*   /* CONDITION, IEAVEQRP WILL INDICATE THAT IT HAS STOPPED RUNNING */
*   /* AND FREE ITS SRB.                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1002
*   DO UNTIL PFTEPTR>PVTPFTP+ENDRBN;/* CHECK ALL PFTES       @ZA31128*/
@DL01002 DS    0H                                                  1003
*     IF PFTASID^=PSAAOLD->ASCBASID&/* IF NOT CURRENT ASID,  @ZA31128*/
*         PFTASID^=PCBRASCB->ASCBASID&/* AND NOT RQSTED ASID,      1003
*                                                            @ZA31128*/
*         PFTQNDX^=PFTNQN&          /* AND QUEUED,           @ZA31128*/
*         PFTFXCT=0&                /* AND NOT FIXED,        @ZA20976*/
*         PFTPCBSI='0'B&            /* AND NO I/O IN PROGRESS,     1003
*                                                            @ZA31128*/
*         PFTIRRG='0'B THEN         /* AND NOT IRREG, THEN MIGHT   1003
*                                      SCHEDULE PAGEOUT SRB  @ZA31128*/
*                                                                  1003
         L     @14,PSAAOLD                                         1003
         CLC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    1003
         BE    @RF01003                                            1003
         L     @14,PCBRASCB(,PCBRPTR)                              1003
         CLC   PFTASID(2,PFTEPTR),ASCBASID(@14)                    1003
         BE    @RF01003                                            1003
         CLI   PFTQNDX(PFTEPTR),X'FF'                              1003
         BE    @RF01003                                            1003
         SLR   @14,@14                                             1003
         CH    @14,PFTFXCT(,PFTEPTR)                               1003
         BNE   @RF01003                                            1003
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       1003
         BNZ   @RF01003                                            1003
         TM    PFTIRRG(PFTEPTR),B'00010000'                        1003
         BNZ   @RF01003                                            1003
*       /*************************************************************/
*       /*                                                           */
*       /* A FRAME HAS BEEN FOUND THAT CONTAINS A PAGEABLE OR LSQA   */
*       /* PRIVATE AREA PAGE, AND WHOSE ADDRESS SPACE IS NEITHER THE */
*       /* CURRENT NOR THAT OF THE V=R REGION BEING ALLOCATED. (NOTE:*/
*       /* IF THE FRAME IS LSQA, IT CANNOT BE FOR A LONG-TERM        */
*       /* NON-SWAPPABLE ADDRESS SPACE.) BEFORE SCHEDULING THE       */
*       /* PAGEOUT SRB INTO THAT ADDRESS SPACE, DETERMINE IF A       */
*       /* REQUEST SWAP HAS ALREADY BEEN DONE FOR IT. IF SO, DO NOT  */
*       /* SCHEDULE THE SRB. (NOTE: THIS IS DONE TO PREVENT CONTINUAL*/
*       /* SCHEDULING AND EXECUTION OF THE PAGEOUT SRB. IF CONTINUAL */
*       /* SCHEDULING AND EXECUTION OCCURRED, THE XMPOST SRB TO POST */
*       /* THE RCT TO QUIESCE THE ADDRESS SPACE WOULD NEVER RUN      */
*       /* BECAUSE IT RUNS AT THE LOCAL LEVEL WHILE THE PAGEOUT SRB  */
*       /* RUNS AT THE GLOBAL LEVEL. THUS THE ADDRESS SPACE WOULD    */
*       /* NEVER BE SWAPPPED OUT.)                           @ZA31128*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  1004
*       DO;                         /*                       @ZA31128*/
*         REG10=ASVTENTY(PFTASID);  /* ASCB ADDRESS          @ZA15747*/
         SLR   @09,@09                                             1005
         ICM   @09,3,PFTASID(PFTEPTR)                              1005
         SLA   @09,2                                               1005
         L     @07,CVTPTR                                          1005
         L     @07,ASVTPTR(,@07)                                   1005
         L     REG10,ASVTENTY-4(@09,@07)                           1005
*         REG1=REG10->ASCBRSM->RSMSPCT;/* SPCT ADDRESS       @ZA15747*/
         L     @09,ASCBRSM(,REG10)                                 1006
         L     REG1,RSMSPCT(,@09)                                  1006
*         IF REG1=0×REG1->SPCTVROT='0'B THEN/* SCHEDULE SRB? @ZA15747*/
*                                                                  1007
         CR    REG1,@14                                            1007
         BE    @RT01007                                            1007
         TM    SPCTVROT(REG1),B'00000100'                          1007
         BNZ   @RF01007                                            1007
@RT01007 DS    0H                                                  1008
*           /*********************************************************/
*           /*                                                       */
*           /* NO REQUEST SWAP HAS BEEN DONE. IF THE FRAME JUST FOUND*/
*           /* IS FOR LSQA, INDICATE THAT A REQUEST SWAP HAS BEEN    */
*           /* DONE. (NOTE: THE REQUEST SWAP DONE FLAG (SPCTVROT) IS */
*           /* SET UNDER THIS CONDITION SO THAT SCHEDULING OF THE    */
*           /* PAGEOUT SRB WILL NOT PING-PONG BETWEEN 2 NON-SWAPPABLE*/
*           /* ADDRESS SPACES THAT HAVE LSQA INTERCEPTED FOR THIS    */
*           /* ALLOCATION. AT THIS POINT, REG1 WILL CONTAIN AN SPCT  */
*           /* ADDRESS SINCE ONLY PERMANENTLY NON-SWAPPABLE ADDRESS  */
*           /* SPACES HAVE A ZERO SPCT POINTER IN THE RSM HEADER, AND*/
*           /* LSQA WILL NOT BE INTERCEPTED FOR SUCH ADDRESS SPACES.)*/
*           /* WHETHER THE FRAME IS LSQA OR NOT, THE PAGEOUT SRB IS  */
*           /* SCHEDULED INTO THE ADDRESS SPACE.             @ZA31128*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  1008
*           DO;                     /* YES, NEED REQ SWAP    @ZA15747*/
*             IF PFTQNDX=PFTLSQAN THEN/* IS FRAME LSQA ?     @ZA31128*/
         CLI   PFTQNDX(PFTEPTR),X'84'                              1009
         BNE   @RF01009                                            1009
*               REG1->SPCTVROT='1'B;/* YES, STOP FURTHER REQ SWAPS 1010
*                                      FOR THIS ADDR SPACE   @ZA31128*/
         OI    SPCTVROT(REG1),B'00000100'                          1010
*             SRBASCB=REG10;        /* SET UP ADDRESS SPACE          */
@RF01009 ST    REG10,SRBASCB(,SRBPTR)                              1011
*             SRBPASID=PFTASID;     /* SET UP NEW ASID               */
         MVC   SRBPASID(2,SRBPTR),PFTASID(PFTEPTR)                 1012
*             REG1=SRBPTR;          /* SRB ADDRESS                   */
         LR    REG1,SRBPTR                                         1013
*             GEN(SCHEDULE SRB=(1),SCOPE=GLOBAL);                  1014
         SCHEDULE SRB=(1),SCOPE=GLOBAL
*             GOTO ENDP;            /* CLEAN UP AND RETURN           */
         B     ENDP                                                1015
*           END;                    /*                       @ZA15747*/
*       END;                        /*                       @ZA31128*/
@RF01007 DS    0H                                                  1018
*     PFTEPTR=PFTEPTR+LENGTH(PFTE); /* ADDR NEXT PFTE                */
@RF01003 AL    PFTEPTR,@CF00040                                    1018
*   END;                            /*                       @ZA31128*/
*                                                                  1019
@DE01002 L     @14,PVTPFTP(,PVTPTR)                                1019
         AL    @14,ENDRBN(,PCBRPTR)                                1019
         CR    PFTEPTR,@14                                         1019
         BNH   @DL01002                                            1019
*   /*****************************************************************/
*   /*                                                               */
*   /* THE LAST PFTE HAS BEEN CHECKED AND NO OTHER ADDRESS SPACE     */
*   /* PAGES ARE AVAILABLE TO PAGE OUT. TURN OFF POF, FREE THE       */
*   /* PAGEOUT SRB, AND RETURN.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1020
*   PCBRPOF='0'B;                                                  1020
         NI    PCBRPOF(PCBRPTR),B'11111110'                        1020
*ENDIT:                                                            1021
*   REG0=PVTSRBID;                  /* SRBID TO FREE                 */
ENDIT    L     REG0,PVTSRBID(,PVTPTR)                              1021
*   REG13=ADDR(PVTSAVE);            /* SAVE AREA                     */
         LA    REG13,PVTSAVE(,PVTPTR)                              1022
*   GENERATE(FREECELL CPID=(0),CELL=(SRBPTR),BRANCH=YES) ;         1023
         FREECELL CPID=(0),CELL=(SRBPTR),BRANCH=YES
*ENDP:                                                             1024
*   REG9=REG12;                                                    1024
ENDP     LR    REG9,REG12                                          1024
*   GENERATE;                                                      1025
RG       SETLOCK RELEASE,TYPE=SALLOC,RELATED=(RSM,IEAVEQRP(GOB))
*   REG12=REG9;                                                    1026
         LR    REG12,REG9                                          1026
*   REG11=REG12+3840;               /* RESTORE 2ND BASE REG  @Z30GNYD*/
         LA    REG11,3840                                          1027
         ALR   REG11,REG12                                         1027
*   GEN(SETFRR  D,WRKREGS=(1,2));   /*                       @ZA31128*/
         SETFRR  D,WRKREGS=(1,2)
*   REG14=CVTSRBRT;                 /* RETURN ADDRESS                */
         L     @09,CVTPTR                                          1029
         L     REG14,CVTSRBRT(,@09)                                1029
*   GOTO REG14;                     /* RETURN TO DISPATCHER  @ZA31128*/
         BR    REG14                                               1030
*   RFY                                                            1031
*     REG10 UNRSTD;                 /*                       @Z30GNYD*/
*                                                                  1032
*/********************************************************************/
*/*IEAVRMTR GETS CONTROL WHEN IEAVEQRP IS SCHEDULED INTO A TERMINATNG*/
*/*ADDRESS SPACE.  THIS ROUTINE'S ONLY FUNCTION IS TO SCHEDULE THE   */
*/*VEQR PAGE-OUT ROUTINE (IEAVEQRP) INTO MASTER'S MEMORY. THIS       */
*/*INSURES THAT EACH ADDRESS SPACE WITH V=R INTERCEPTED FRAMES WILL  */
*/*HAVE IEAVEQRP SCHEDULED FOR IT.                                   */
*/*      INPUT                                                       */
*/*      REG1 = SRB ADDRESS                                          */
*/*      REG2 = SRB PARM ADDRESS (PCBRPTR)                           */
*/*      REG14= RETURN ADDRESS                                       */
*/********************************************************************/
*                                                                  1032
*EP6:                                                              1032
*   ;                                                              1032
EP6      DS    0H                                                  1033
*   RFY                                                            1033
*    (REG1,                                                        1033
*     REG9,                                                        1033
*     PVTPTR) RSTD;                                                1033
*   REG9=REG14;                     /* SAVE RETURN ADDRESS           */
         LR    REG9,REG14                                          1034
*   REG1->SRBASCB=ADDR(IEAMASCB);   /* MASTER'S ASCB ADDRESS @ZA10767*/
         L     @14,@CV02278                                        1035
         ST    @14,SRBASCB(,REG1)                                  1035
*   REG1->SRBPASID=REG1->SRBASCB->ASCBASID;/* MASTER'S ASID  @ZA10767*/
         MVC   SRBPASID(2,REG1),ASCBASID(@14)                      1036
*   GEN(SCHEDULE SRB=(1),SCOPE=GLOBAL);/* SCHEDULE SRB INTO MASTER'S
*                                      MEMORY                @ZA10767*/
         SCHEDULE SRB=(1),SCOPE=GLOBAL
*   REG14=REG9;                     /* SET UP RETURN ADDRESS         */
         LR    REG14,REG9                                          1038
*   GOTO REG14;                     /* RETURN                        */
         BR    REG14                                               1039
*   END IEAVEQR                                                    1040
*                                                                  1040
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IRAOUCB )                                       */
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */
*/*%INCLUDE SYSLIB  (IHASPCT )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */
*/*%INCLUDE SYSLIB  (IHAPCB  )                                       */
*/*%INCLUDE SYSLIB  (IHAPCBR )                                       */
*/*%INCLUDE SYSLIB  (IHAPGTE )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHAPFTE )                                       */
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */
*/*%INCLUDE SYSLIB  (IHARCA  )                                       */
*/*%INCLUDE SYSLIB  (IHARSMHD)                                       */
*/*%INCLUDE SYSLIB  (IHASGTE )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHAXPTE )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*                                                                  1040
*       ;                                                          1040
@DATA    DS    0H
@CH00058 DC    H'2'
@CH00879 DC    H'28'
@DATD    DSECT
         DS    0F
IEAVEQR  CSECT
         DS    0F
@CF00044 DC    F'1'
@CH00044 EQU   @CF00044+2
@CF00036 DC    F'4'
@CH00036 EQU   @CF00036+2
@CF00038 DC    F'8'
@CF00040 DC    F'16'
@CH00040 EQU   @CF00040+2
@CF00054 DC    F'4096'
@CF02389 DC    BL4'00010000000000000000000000000000'
@CF02396 DC    BL4'11101111111111111111111111111111'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVEQR  CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV02275 DC    V(IEAVRMT)
@CV02278 DC    V(IEAMASCB)
         DS    0D
@CC02307 DC    C'SRB '
SEGMASK  DC    X'0000FFFF'
         ORG   SEGMASK
@NM00001 DS    CL2
COMASID  DS    CL2
         ORG   SEGMASK+4
PGOUT    DC    X'04'
FREECB   DC    X'FF000000'
HEADQ    DC    X'8000'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
RSMHDPTR EQU   @02
PVTPTR   EQU   @03
REG4     EQU   @04
XPTEPTR  EQU   @04
COUNT    EQU   @04
SRBPTR   EQU   @04
RSAVE    EQU   @04
PFTEPTR  EQU   @05
REG5     EQU   @05
CURVSA   EQU   @05
REG6     EQU   @06
INPUTPTR EQU   @06
VRBN     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
PCBRPTR  EQU   @08
RCAPTR   EQU   @08
RVSA     EQU   @08
PCBPTR   EQU   @08
PTEPTR   EQU   @09
REG9     EQU   @09
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
RCODE    EQU   @15
QPTR     EQU   @07
REG3     EQU   @03
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
FLCCVT   EQU   FLCICCW2
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSATOLD  EQU   PSA+540
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
FRREPTR  EQU   0
SEGSPTR  EQU   0
SWAPPTR  EQU   0
LCCAPTR  EQU   0
INPUT    EQU   0
INPSTART EQU   INPUT
INPSPEC  EQU   INPUT+4
INPAGES  EQU   INPUT+6
INPECBP  EQU   INPUT+8
WKPCB    EQU   20
STARTRBN EQU   WKPCB
ENDRBN   EQU   WKPCB+4
NEXTPCB  EQU   WKPCB+8
DELTA    EQU   WKPCB+12
RGNEND   EQU   DELTA
COUNTER  EQU   WKPCB+16
STARTSEG EQU   COUNTER
CURSEG   EQU   COUNTER+2
NSEG     EQU   WKPCB+20
SEGID    EQU   WKPCB+22
WORK     EQU   WKPCB+24
COMPSRB  EQU   WKPCB+28
RGNSTART EQU   WKPCB+32
TQIDRBN  EQU   WKPCB+36
CALLREGS EQU   0
@NM00004 EQU   CALLREGS
MOTION   EQU   @NM00004
LOOPFLAG EQU   @NM00004
CSGBRC   EQU   CALLREGS+4
POUTSRB  EQU   CALLREGS+8
S15      EQU   CALLREGS+16
STEPTR   EQU   0
OUCB     EQU   0
OUCBQFL  EQU   OUCB+16
OUCBSFL  EQU   OUCB+17
OUCBYFL  EQU   OUCB+18
OUCBAFL  EQU   OUCB+19
OUCBTFL  EQU   OUCB+20
OUCBEFL  EQU   OUCB+21
OUCBUFL  EQU   OUCB+23
OUCBCSW  EQU   OUCB+84
OUCBCFL  EQU   OUCBCSW+2
OUCBPSS  EQU   OUCB+112
LCCA     EQU   0
LCCAIHRC EQU   LCCA+520
LCCAIHR1 EQU   LCCAIHRC
LCCAIHR2 EQU   LCCAIHRC+1
LCCAIHR3 EQU   LCCAIHRC+2
LCCAIHR4 EQU   LCCAIHRC+3
LCCASPIN EQU   LCCA+524
LCCASPN1 EQU   LCCASPIN
LCCASPN2 EQU   LCCASPIN+1
LCCASPN3 EQU   LCCASPIN+2
LCCASPN4 EQU   LCCASPIN+3
LCCACPUS EQU   LCCA+536
LCCADSF1 EQU   LCCA+540
LCCADSF2 EQU   LCCA+541
LCCASPSA EQU   LCCA+544
LCCACRFL EQU   LCCA+692
LCCACREX EQU   LCCA+693
LCCALKFG EQU   LCCA+694
LCCASRBF EQU   LCCA+720
WSAL     EQU   0
WSALRSM  EQU   WSAL+52
WSAG     EQU   0
WSAC     EQU   0
ASXB     EQU   0
ASXBSPSA EQU   ASXB+112
ASXBAEQ  EQU   ASXB+168
ASXBSECR EQU   ASXB+199
ASCBSFLG EQU   ASXBSECR
ASXBCASW EQU   ASXB+216
ASXBCRB1 EQU   ASXBCASW
SPCT     EQU   0
SPCTFLG1 EQU   SPCT+10
SPCTVROT EQU   SPCTFLG1
SPCTSEGE EQU   0
SPCTSWPE EQU   0
SPCTLS   EQU   SPCTSWPE
SPCTFLAG EQU   SPCTLS
SPCTEXTM EQU   0
SPCTENT  EQU   SPCTEXTM+8
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBASID EQU   ASCB+36
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCBVEQR EQU   ASCBRSMF
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBASXB EQU   ASCB+108
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBOUCB EQU   ASCB+144
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSENTR EQU   0
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
PCB      EQU   0
PCBFQP   EQU   PCB
PCBBQP   EQU   PCB+4
PCBRTP   EQU   PCB+8
PCBFL1   EQU   PCBRTP
PCBRLP   EQU   PCB+12
PCBXPT   EQU   PCB+16
PCBFL2   EQU   PCBXPT
PCBPGT   EQU   PCB+20
PCBFL3   EQU   PCBPGT
PCBBLOCK EQU   PCB+28
PCBSRB   EQU   PCBBLOCK
PCBRB    EQU   PCBSRB
PCBR     EQU   0
PCBRTCB  EQU   PCBR
PCBRFLAG EQU   PCBRTCB
PCBRINT  EQU   PCBRFLAG
PCBRPB   EQU   PCBRFLAG
PCBRFPCB EQU   PCBRFLAG
PCBRFAIL EQU   PCBRFLAG
PCBRLOAD EQU   PCBRFLAG
PCBRPOF  EQU   PCBRFLAG
PCBRTCBA EQU   PCBRTCB+1
PCBRECB  EQU   PCBR+8
PCBRASCB EQU   PCBR+12
PCBRCNT  EQU   PCBR+16
PGTPTE   EQU   0
PGTRSA   EQU   PGTPTE
PGTBITS  EQU   PGTRSA+1
PGTPVM   EQU   PGTBITS
PGTPAM   EQU   PGTBITS
PFTE     EQU   0
PFTPGID  EQU   PFTE
PFTASID  EQU   PFTPGID
PFTVBN   EQU   PFTPGID+2
PFTQPTRS EQU   PFTE+4
PFTFXCT  EQU   PFTE+8
PFTFLAGS EQU   PFTE+12
PFTFLAG1 EQU   PFTFLAGS
PFTONAVQ EQU   PFTFLAG1
PFTVRINT EQU   PFTFLAG1
PFTVRPLT EQU   PFTFLAG1
PFTPCBSI EQU   PFTFLAG1
PFTBADPG EQU   PFTFLAG1
PFTVRALC EQU   PFTFLAG1
PFTOFINT EQU   PFTFLAG1
PFTFLAG2 EQU   PFTFLAGS+1
PFTOFFLN EQU   PFTFLAG2
PFTVR    EQU   PFTFLAG2
PFTIRRG  EQU   PFTFLAG2
PFTQNDX  EQU   PFTE+14
PVT      EQU   0
PVTFLAG1 EQU   PVT
PVTFLAG2 EQU   PVT+1
PVTPFTP  EQU   PVT+12
PVTFVR   EQU   PVT+20
PVTLVR   EQU   PVT+22
PVTVROOT EQU   PVT+40
PVTPRCA  EQU   PVT+52
PVTSRBID EQU   PVT+68
PVTPSINT EQU   PVT+76
PVTREP2  EQU   PVT+100
PVTPCB   EQU   PVT+104
PVTPFTE  EQU   PVT+108
PVTPFP2  EQU   PVT+116
PVTPVRPO EQU   PVT+124
PVTPVRC  EQU   PVT+144
PVTPRCV  EQU   PVT+156
PVTPINV  EQU   PVT+172
PVTPCSGB EQU   PVT+180
PVTPDSEG EQU   PVT+184
PVTPSRBP EQU   PVT+188
PVTQS    EQU   PVT+304
PVTWSAX  EQU   PVT+344
PVTWSA3  EQU   PVTWSAX+144
PVTSAVE  EQU   PVTWSAX+1328
PVTMAXFX EQU   PVT+1822
PVTCNTFX EQU   PVT+1830
PVTPCBQS EQU   PVT+1852
RCA      EQU   0
RCANAME7 EQU   RCA+8
RCACSECT EQU   RCA+9
RCAFLAGS EQU   RCA+10
RCASAL   EQU   RCAFLAGS
RCALL    EQU   RCAFLAGS
RCARCRD  EQU   RCA+11
RCANAMES EQU   RCA+12
RCANAME1 EQU   RCANAMES
RCAVEQR  EQU   RCANAME1
RCANAME2 EQU   RCANAMES+1
RCANAME3 EQU   RCANAMES+2
RCANAME4 EQU   RCANAMES+3
RCAVEQRC EQU   RCANAME4
RCAVEQRF EQU   RCANAME4
RCAVEQRI EQU   RCANAME4
RCANAME5 EQU   RCANAMES+4
RCANAME6 EQU   RCANAMES+5
RCAVEQRP EQU   RCANAME6
RSMHD    EQU   0
RSMSPCT  EQU   RSMHD+4
RSMFLG1  EQU   RSMHD+12
RSMCNTFX EQU   RSMHD+14
RSMQS    EQU   RSMHD+20
RSMLFQ   EQU   RSMQS
RSMLSQA  EQU   RSMQS+4
RSMLIOQ  EQU   RSMQS+8
SGTSTE   EQU   0
SGTLK    EQU   SGTSTE
SGTPTO   EQU   SGTSTE+1
SGTBYTE  EQU   SGTPTO+2
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBID    EQU   SRB
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBPASID EQU   SRBFLC+2
SRBPTCB  EQU   SRBFLC+4
SRBEP    EQU   SRB+20
SRBRMTR  EQU   SRB+24
SRBPARM  EQU   SRB+28
XPTE     EQU   0
XPTFLAGS EQU   XPTE+2
XPTFLAG2 EQU   XPTE+3
XPTLPID  EQU   XPTE+4
XPTLGN   EQU   XPTLPID
XPTLPN   EQU   XPTLPID+4
CVTMAP   EQU   0
CVT      EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVT0PT01 EQU   CVTMAP+152
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTPTRV  EQU   CVTMAP+288
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
IEAVFP2  EQU   0
IEAVCSGB EQU   0
IEAVPCB  EQU   0
IEAPFTE  EQU   0
IEAVDSEG EQU   0
IEAVINV  EQU   0
IEAVREP2 EQU   0
POST     EQU   0
PSII     EQU   0
PGTEND   EQU   0
SGTEND   EQU   0
TRV      EQU   0
CVTS01   EQU   CVTPGSIA
CVTPVTP  EQU   CVTS01+8
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTSRBRT EQU   CVTS01+100
CVTOPTE  EQU   CVTS01+188
CVTASVT  EQU   CVTS01+208
CVTSPSA  EQU   CVTS01+336
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
ASVTPTR  EQU   CVTASVT
PSARSVTE EQU   PSARSVT
PSACSTK  EQU   PSARSVTE
FRRSPTR  EQU   PSACSTK
CVTPTR   EQU   FLCCVT
ASCBPTR  EQU   PSAAOLD
OUCBPTR  EQU   ASCBOUCB
ASXBPTR  EQU   ASCBASXB
SPCTPTR  EQU   RSMSPCT
SAVERCA  EQU   PVTSAVE
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00064 EQU   CVTFIX+248
@NM00063 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTBAH   EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTRV490 EQU   CVTMAP+388
CVTSU    EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTVS1B  EQU   CVTOPTB
CVTVS1A  EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
XPTLSID2 EQU   XPTLPN
XPTLSID  EQU   XPTLGN
@NM00062 EQU   XPTFLAG2
XPTIOERR EQU   XPTFLAG2
XPTPOINP EQU   XPTFLAG2
XPTRES1  EQU   XPTFLAG2
XPTVALID EQU   XPTFLAG2
XPTRSV4  EQU   XPTFLAGS
XPTDEFER EQU   XPTFLAGS
XPTRES2  EQU   XPTFLAGS
XPTVIO   EQU   XPTFLAGS
@NM00061 EQU   XPTFLAGS
XPTCKF   EQU   XPTFLAGS
XPTXAV   EQU   XPTFLAGS
XPTVIOLP EQU   XPTFLAGS
XPTRSV1  EQU   XPTE+1
XPTPROT  EQU   XPTE
@NM00060 EQU   SRB+40
@NM00059 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBCPAFF EQU   SRBFLC
SRBFLNK  EQU   SRB+4
SGTPAM   EQU   SGTBYTE
SGTEAC   EQU   SGTBYTE
@NM00058 EQU   SGTBYTE
@NM00057 EQU   SGTBYTE
@NM00056 EQU   SGTBYTE
@NM00055 EQU   SGTBYTE
@NM00054 EQU   SGTBYTE
SGTORG   EQU   SGTPTO
SGTKEY   EQU   SGTLK
SGTPTL   EQU   SGTLK
RSMASMHD EQU   RSMHD+40
RSMFOEQ  EQU   RSMHD+36
RSMLIOQL EQU   RSMLIOQ+4
RSMLIOQF EQU   RSMLIOQ
RSMLSQAL EQU   RSMLSQA+2
RSMLSQAF EQU   RSMLSQA
RSMLFQL  EQU   RSMLFQ+2
RSMLFQF  EQU   RSMLFQ
RSMRSV2  EQU   RSMHD+16
RSMRSV1  EQU   RSMHD+13
@NM00053 EQU   RSMFLG1
RSMFAIL  EQU   RSMFLG1
RSMGFADD EQU   RSMFLG1
RSMCPNC  EQU   RSMFLG1
RSMCPNU  EQU   RSMFLG1
RSMGFAD  EQU   RSMFLG1
RSMIOCPC EQU   RSMFLG1
RSMIOCPU EQU   RSMFLG1
RSMASCB  EQU   RSMHD+8
RSMVSTO  EQU   RSMHD
RCARETAD EQU   RCA+20
RCATASID EQU   RCA+18
RCAREP1  EQU   RCANAME6
RCAPSIF  EQU   RCANAME6
RCAPSIX  EQU   RCANAME6
RCARCFC  EQU   RCANAME6
RCACSGB  EQU   RCANAME6
RCAFXL   EQU   RCANAME6
RCAPS113 EQU   RCANAME6
RCAFREE  EQU   RCANAME5
RCARFR2  EQU   RCANAME5
RCACPBR  EQU   RCANAME5
RCAOPBR  EQU   RCANAME5
RCASORT  EQU   RCANAME5
RCASIRT  EQU   RCANAME5
RCARELV  EQU   RCANAME5
RCARELF  EQU   RCANAME5
RCAGFAD  EQU   RCANAME4
RCATERM  EQU   RCANAME4
RCASQA   EQU   RCANAME4
RCASWIN  EQU   RCANAME4
RCASOUT  EQU   RCANAME4
RCARFR   EQU   RCANAME3
RCARELS  EQU   RCANAME3
RCARCFI  EQU   RCANAME3
RCARCF   EQU   RCANAME3
RCAPSII  EQU   RCANAME3
RCAPSIB  EQU   RCANAME3
RCAPS112 EQU   RCANAME3
RCAPIX   EQU   RCANAME3
RCAPIOP  EQU   RCANAME2
RCASWPC  EQU   RCANAME2
RCASWPP  EQU   RCANAME2
RCAPFTE  EQU   RCANAME2
RCAPCB   EQU   RCANAME2
RCAOUT   EQU   RCANAME2
RCAITAS  EQU   RCANAME2
RCAIOCP  EQU   RCANAME2
RCAINV   EQU   RCANAME1
RCAGFA   EQU   RCANAME1
RCAFXLD  EQU   RCANAME1
RCADSEG  EQU   RCANAME1
RCADLAS  EQU   RCANAME1
RCACSEG  EQU   RCANAME1
RCAVAMSI EQU   RCANAME1
@NM00052 EQU   RCAFLAGS
RCADISP  EQU   RCAFLAGS
@NM00051 EQU   RCAFLAGS
RCAQS    EQU   RCAFLAGS
RCAPSIER EQU   RCAFLAGS
RCAABEND EQU   RCAFLAGS
@NM00050 EQU   RCANAME7
RCAPRSS  EQU   RCANAME7
RCAPRSR  EQU   RCANAME7
RCAPRSB  EQU   RCANAME7
RCAPSIY  EQU   RCANAME7
RCAPIOI  EQU   RCANAME7
RCAPARM1 EQU   RCA+4
RCAPARM0 EQU   RCA
PVTEND   EQU   PVT+1944
PVTTASID EQU   PVT+1942
PVTXXXXX EQU   PVT+1940
PVTMVCLC EQU   PVT+1936
PVTVCONS EQU   PVT+1896
PVTPRSB  EQU   PVT+1892
PVTCIOQL EQU   PVTPCBQS+36
PVTCIOQF EQU   PVTPCBQS+32
PVTGFADL EQU   PVTPCBQS+28
PVTGFADF EQU   PVTPCBQS+24
PVTFPCBL EQU   PVTPCBQS+20
PVTFPCBF EQU   PVTPCBQS+16
PVTPCBQR EQU   PVTPCBQS
PVTLPAFX EQU   PVT+1850
PVTLSQAF EQU   PVT+1848
PVTLPAR  EQU   PVT+1844
PVTLPAI  EQU   PVT+1840
PVTLPAFC EQU   PVT+1838
PVTCHUIC EQU   PVT+1836
PVTCOMFX EQU   PVT+1834
PVTSQAFX EQU   PVT+1832
PVTDEFFX EQU   PVT+1828
PVTFIXOK EQU   PVT+1826
PVTPEROK EQU   PVT+1824
PVTPERFX EQU   PVT+1820
PVTRSRB  EQU   PVT+1776
PVTRESV5 EQU   PVT+1773
PVTSRBS  EQU   PVT+1772
PVTSSRB  EQU   PVT+1768
PVTACA   EQU   PVTWSAX+1400
PVTWSA18 EQU   PVTWSAX+1256
PVTWSA17 EQU   PVTWSAX+1184
PVTWSA16 EQU   PVTWSAX+1112
PVTWSA15 EQU   PVTWSAX+1040
PVTWSA14 EQU   PVTWSAX+968
PVTWSA13 EQU   PVTWSAX+896
PVTWSA12 EQU   PVTWSAX+824
PVTWSA11 EQU   PVTWSAX+752
PVTWSA10 EQU   PVTWSAX+672
PVTWSA9  EQU   PVTWSAX+592
PVTWSA8  EQU   PVTWSAX+504
PVTWSA7  EQU   PVTWSAX+432
PVTWSA6  EQU   PVTWSAX+360
PVTWSA5  EQU   PVTWSAX+288
PVTWSA4  EQU   PVTWSAX+216
PVTWSA2  EQU   PVTWSAX+72
PVTWSA1  EQU   PVTWSAX
PVTPFTQR EQU   PVTQS+20
PVTRSBQL EQU   PVTQS+18
PVTRSBQF EQU   PVTQS+16
PVTSQAQL EQU   PVTQS+14
PVTSQAQF EQU   PVTQS+12
PVTCFQL  EQU   PVTQS+10
PVTCFQF  EQU   PVTQS+8
PVTRSRVL EQU   PVTQS+6
PVTRSRVF EQU   PVTQS+4
PVTAFQL  EQU   PVTQS+2
PVTAFQF  EQU   PVTQS
PVTSPFR  EQU   PVT+302
PVTCFMCT EQU   PVT+300
PVTSPREC EQU   PVT+296
PVTCAREC EQU   PVT+292
PVTCAOUT EQU   PVT+288
PVTCAIN  EQU   PVT+284
PVTNSWPS EQU   PVT+280
PVTNPREC EQU   PVT+276
PVTSPOUT EQU   PVT+272
PVTSPIN  EQU   PVT+268
PVTVAMR  EQU   PVT+264
PVTVAMO  EQU   PVT+260
PVTVAMI  EQU   PVT+256
PVTNPOUT EQU   PVT+252
PVTNPIN  EQU   PVT+248
PVTPRSET EQU   PVT+244
PVTFRSLT EQU   PVT+240
PVTPAGIO EQU   PVT+236
PVTSWPIO EQU   PVT+232
PVTPSWPP EQU   PVT+228
PVTPPREF EQU   PVT+224
PVTPOPBR EQU   PVT+220
PVTPRELF EQU   PVT+216
PVTPRELV EQU   PVT+212
PVTPFREE EQU   PVT+208
PVTPRELS EQU   PVT+204
PVTPOUT  EQU   PVT+200
PVTPFXLD EQU   PVT+196
PVTPITAS EQU   PVT+192
PVTPCSEG EQU   PVT+176
PVTPSWPC EQU   PVT+168
PVTPSOUT EQU   PVT+164
PVTPSWIN EQU   PVT+160
PVTPRCFI EQU   PVT+152
PVTPRCF  EQU   PVT+148
PVTPVRIN EQU   PVT+140
PVTPVRLS EQU   PVT+136
PVTPVEQR EQU   PVT+132
PVTPPIOI EQU   PVT+128
PVTPRFR  EQU   PVT+120
PVTPFP   EQU   PVT+112
PVTPIOCP EQU   PVT+96
PVTPIOP  EQU   PVT+92
PVTPGFAD EQU   PVT+88
PVTPGFA  EQU   PVT+84
PVTPSQA  EQU   PVT+80
PVTPSIB  EQU   PVT+72
PVTPCIWA EQU   PVT+64
PVTHQSA  EQU   PVT+62
PVTLQSA  EQU   PVT+60
PVTOROOT EQU   PVT+56
PVTREUS  EQU   PVT+48
PVTSQNPC EQU   PVT+47
PVTSQVRC EQU   PVT+46
PVTRSUS  EQU   PVT+44
PVTPCBLO EQU   PVT+38
PVTPCBCT EQU   PVT+36
PVTDFRS  EQU   PVT+34
PVTRSQA  EQU   PVT+32
PVTPTLB  EQU   PVT+31
PVTPCBNO EQU   PVT+30
PVTSRBNO EQU   PVT+29
PVTSQDC  EQU   PVT+28
PVTLCSA  EQU   PVT+26
PVTLPRIV EQU   PVT+24
PVTLPFN  EQU   PVT+18
PVTFPFN  EQU   PVT+16
PVTSSPIN EQU   PVT+11
PVTPCBS  EQU   PVT+10
PVTPOOL  EQU   PVT+8
PVTAFCOK EQU   PVT+6
PVTAFCLO EQU   PVT+4
PVTAFC   EQU   PVT+2
@NM00049 EQU   PVTFLAG2
PVTRSMGM EQU   PVTFLAG2
PVTDUMP  EQU   PVTFLAG1
PVTSIT   EQU   PVTFLAG1
PVTLSI   EQU   PVTFLAG1
PVTAPREF EQU   PVTFLAG1
PVTPCBLT EQU   PVTFLAG1
PVTSRBIU EQU   PVTFLAG1
PVTBGMS  EQU   PVTFLAG1
PVTPMSG  EQU   PVTFLAG1
PFTUIC   EQU   PFTE+15
@NM00048 EQU   PFTFLAG2
@NM00047 EQU   PFTFLAG2
PFTPREF  EQU   PFTFLAG2
PFTSTEAL EQU   PFTFLAG2
PFTDFRLS EQU   PFTFLAG2
PFTLSQA  EQU   PFTFLAG1
PFTRSV1  EQU   PFTE+10
PFTBQPTR EQU   PFTQPTRS+2
PFTFQPTR EQU   PFTQPTRS
@NM00022 EQU   PGTBITS
@NM00021 EQU   PGTBITS
@NM00020 EQU   PGTBITS
@NM00019 EQU   PGTBITS
@NM00018 EQU   PGTBITS
@NM00017 EQU   PGTBITS
PGTREAL  EQU   PGTRSA
PCBRWRKB EQU   PCBR+60
PCBRWRKA EQU   PCBR+56
PCBRWRK9 EQU   PCBR+52
PCBRWRK8 EQU   PCBR+48
PCBRWRK7 EQU   PCBR+44
PCBRWRK6 EQU   PCBR+40
PCBRWRK5 EQU   PCBR+36
PCBRWRK4 EQU   PCBR+32
PCBRWRK3 EQU   PCBR+28
PCBRWRK2 EQU   PCBR+24
PCBRWRK1 EQU   PCBR+20
PCBRRSV1 EQU   PCBR+18
PCBRGOTO EQU   PCBR+4
PCBRFECB EQU   PCBRFLAG
PCBRETRY EQU   PCBRFLAG
PCBEND   EQU   PCB+64
PCBAIA   EQU   PCB+36
PCBASCB  EQU   PCB+32
PCBSPCTE EQU   PCBRB
PCBVBN   EQU   PCB+26
PCBRBN   EQU   PCB+24
PCBPGTA  EQU   PCBPGT+1
PCBSWPS2 EQU   PCBFL3
@NM00016 EQU   PCBFL3
PCBNOREC EQU   PCBFL3
PCBDFRLS EQU   PCBFL3
PCBSWPLS EQU   PCBFL3
PCBSWPS1 EQU   PCBFL3
PCBSWPIN EQU   PCBFL3
PCBSWPOT EQU   PCBFL3
PCBXPTA  EQU   PCBXPT+1
@NM00015 EQU   PCBFL2
@NM00014 EQU   PCBFL2
PCBVIO   EQU   PCBFL2
PCBSUPRS EQU   PCBFL2
PCBRESET EQU   PCBFL2
PCBIOERR EQU   PCBFL2
PCBGFAD  EQU   PCBFL2
PCBFREAL EQU   PCBFL2
PCBRLPA  EQU   PCBRLP+1
PCBFXC   EQU   PCBRLP
PCBRTPA  EQU   PCBRTP+1
PCBIOCMP EQU   PCBFL1
PCBIOI   EQU   PCBFL1
PCBROOT  EQU   PCBFL1
PCBLFR   EQU   PCBFL1
PCBLLHLD EQU   PCBFL1
PCBSRBMD EQU   PCBFL1
PCBPEX   EQU   PCBFL1
@NM00013 EQU   PCBFL1
PCBBQPA  EQU   PCBBQP
PCBFQPA  EQU   PCBFQP+1
PCBCQN   EQU   PCBFQP
FRRSPARM EQU   FRRSENTR+8
@NM00012 EQU   FRRSFLGS+1
@NM00011 EQU   FRRSFLG1
FRRSNEST EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSFRRA EQU   FRRSENTR
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
FRRSCURR EQU   FRRSHEAD+12
FRRSELEN EQU   FRRSHEAD+8
FRRSLAST EQU   FRRSHEAD+4
FRRSEMP  EQU   FRRSHEAD
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00010 EQU   ASVT
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCB2LPU EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
SPCTXEND EQU   SPCTENT+48
SPCTENTS EQU   SPCTENT
@NM00009 EQU   SPCTEXTM+4
SPCTEXT  EQU   SPCTEXTM
SPCTFIXC EQU   SPCTSWPE+6
SPCTVBN  EQU   SPCTLS+4
SPCTSSID EQU   SPCTLS+1
@NM00008 EQU   SPCTFLAG
SPCTDEFR EQU   SPCTFLAG
SPCTCOMM EQU   SPCTFLAG
SPCTLSQ  EQU   SPCTFLAG
SPCTLVAL EQU   SPCTFLAG
SPCTBITM EQU   SPCTSEGE+4
SPCTPGT  EQU   SPCTSEGE+1
SPCTSEGX EQU   SPCTSEGE
SPCTSEGS EQU   SPCT+72
SPCTSWAP EQU   SPCT+16
SPCTSIZE EQU   SPCT+14
SPCTWSSZ EQU   SPCT+12
SPCTIDEN EQU   SPCT+11
@NM00007 EQU   SPCTFLG1
SPCTPSET EQU   SPCTFLG1
SPCTBIG  EQU   SPCTFLG1
SPCTPURG EQU   SPCTFLG1
SPCTOUT  EQU   SPCTFLG1
SPCTSWIN EQU   SPCTFLG1
SPCTSSEG EQU   SPCT+9
SPCTNSEG EQU   SPCT+8
SPCTLSQA EQU   SPCT+6
SPCTFIX  EQU   SPCT+4
SPCTSWRT EQU   SPCT
ASXBEND  EQU   ASXB+232
ASXBRV25 EQU   ASXB+228
ASXBRV24 EQU   ASXB+224
ASXBPT0E EQU   ASXB+220
ASXBCRB4 EQU   ASXBCASW+3
ASXBCRB3 EQU   ASXBCASW+2
ASXBCRB2 EQU   ASXBCASW+1
ASXBCR06 EQU   ASXBCRB1
ASXBCR05 EQU   ASXBCRB1
ASXBCR04 EQU   ASXBCRB1
ASXBCR03 EQU   ASXBCRB1
ASXBCR02 EQU   ASXBCRB1
ASXBCR01 EQU   ASXBCRB1
ASXBTFD  EQU   ASXBCRB1
ASXBPIP  EQU   ASXBCRB1
ASXBCTDC EQU   ASXB+212
ASXBTDCB EQU   ASXB+208
ASXBRV19 EQU   ASXB+204
ASXBSENV EQU   ASXBSECR+1
ASXBRV34 EQU   ASCBSFLG
ASXBRV33 EQU   ASCBSFLG
ASXBRV32 EQU   ASCBSFLG
ASXBRV31 EQU   ASCBSFLG
ASXBRV30 EQU   ASCBSFLG
ASXBRV29 EQU   ASCBSFLG
ASXBRV28 EQU   ASCBSFLG
ASXBRV27 EQU   ASCBSFLG
ASXBUSER EQU   ASXB+192
ASXBLSRB EQU   ASXBAEQ+20
ASXBFSRB EQU   ASXBAEQ+16
ASXBLRQE EQU   ASXBAEQ+12
ASXBFRQE EQU   ASXBAEQ+8
ASXBLIQE EQU   ASXBAEQ+4
ASXBFIQE EQU   ASXBAEQ
ASXBETSK EQU   ASXB+164
ASXBSIRB EQU   ASXB+160
ASXBPSWD EQU   ASXB+152
ASXBPRG  EQU   ASXB+136
ASXBRV26 EQU   ASXB+132
ASXBOUSB EQU   ASXB+128
ASXBDDR  EQU   ASXB+124
ASXBRCTD EQU   ASXB+120
ASXBRSMD EQU   ASXB+116
ASXBFRWA EQU   ASXB+108
ASXBFLSA EQU   ASXB+36
ASXBIHSA EQU   ASXB+32
ASXBRV15 EQU   ASXB+28
ASXBRV14 EQU   ASXB+24
ASXBLWA  EQU   ASXB+20
ASXBMPST EQU   ASXB+16
ASXBRS00 EQU   ASXB+14
ASXBTCBS EQU   ASXB+12
ASXBLTCB EQU   ASXB+8
ASXBFTCB EQU   ASXB+4
ASXBASXB EQU   ASXB
ASXBEGIN EQU   ASXB
WSACASMS EQU   WSAC+60
WSACASMD EQU   WSAC+56
WSACCCH  EQU   WSAC+52
WSACRRSA EQU   WSAC+48
WSACREST EQU   WSAC+44
WSACRSTI EQU   WSAC+40
WSACABTM EQU   WSAC+36
WSACMF1  EQU   WSAC+32
WSACEDS0 EQU   WSAC+28
WSACIOS  EQU   WSAC+24
WSACRTMK EQU   WSAC+20
WSACACR  EQU   WSAC+16
WSACTIME EQU   WSAC+12
WSACOPTM EQU   WSAC+8
WSACGTF  EQU   WSAC+4
WSACCWSA EQU   WSAC
WSAGSCHE EQU   WSAG+40
WSAGREST EQU   WSAG+36
WSAGNQDQ EQU   WSAG+32
WSAGMEMT EQU   WSAG+28
WSAGOPTM EQU   WSAG+24
WSAGSTAT EQU   WSAG+20
WSAGEMS0 EQU   WSAG+16
WSAGSSRS EQU   WSAG+12
WSAGRSM  EQU   WSAG+8
WSAGGMFM EQU   WSAG+4
WSAGPGIO EQU   WSAG
WSALACHP EQU   WSAL+56
WSALEVNT EQU   WSAL+48
WSALSTAE EQU   WSAL+44
WSALSTAT EQU   WSAL+40
WSALWAIT EQU   WSAL+36
WSALPOST EQU   WSAL+32
WSALEXIT EQU   WSAL+28
WSALS2EE EQU   WSAL+24
WSALCIRB EQU   WSAL+20
WSALABTM EQU   WSAL+16
WSALSDMP EQU   WSAL+12
WSALRTM2 EQU   WSAL+8
WSALVALC EQU   WSAL+4
WSALCWSA EQU   WSAL
LCCAR125 EQU   LCCA+964
LCCAR124 EQU   LCCA+960
LCCASGPR EQU   LCCA+896
LCCADRT2 EQU   LCCA+888
LCCADRT1 EQU   LCCA+880
LCCAR103 EQU   LCCA+876
LCCAESS2 EQU   LCCA+872
LCCASPLJ EQU   LCCA+868
LCCASMQJ EQU   LCCA+864
LCCAIRT  EQU   LCCA+736
LCCAASID EQU   LCCA+732
LCCARV89 EQU   LCCA+728
LCCAPGTA EQU   LCCASRBF+2
LCCASAFN EQU   LCCASRBF
LCCAECSA EQU   LCCA+716
LCCAICR0 EQU   LCCA+712
LCCALWTM EQU   LCCA+704
LCCARV78 EQU   LCCA+700
LCCAPINV EQU   LCCA+696
LCCARV88 EQU   LCCA+695
LCCARV87 EQU   LCCALKFG
LCCARV86 EQU   LCCALKFG
LCCARV85 EQU   LCCALKFG
LCCARV84 EQU   LCCALKFG
LCCALKRD EQU   LCCALKFG
LCCALKAQ EQU   LCCALKFG
LCCALKSA EQU   LCCALKFG
LCCALKDP EQU   LCCALKFG
LCCACRST EQU   LCCACREX
LCCACRDP EQU   LCCACREX
LCCACRLM EQU   LCCACREX
LCCACRIN EQU   LCCACREX
LCCACRRT EQU   LCCACREX
LCCACRLE EQU   LCCACREX
LCCACRRM EQU   LCCACREX
LCCACREF EQU   LCCACREX
LCCAVARY EQU   LCCACRFL
LCCARV73 EQU   LCCACRFL
LCCARV72 EQU   LCCACRFL
LCCARV71 EQU   LCCACRFL
LCCARV70 EQU   LCCACRFL
LCCARV69 EQU   LCCACRFL
LCCACLMS EQU   LCCACRFL
LCCACRTM EQU   LCCACRFL
LCCALCR0 EQU   LCCA+688
LCCACRLC EQU   LCCA+684
LCCARCPU EQU   LCCA+680
LCCADCPU EQU   LCCA+676
LCCASRBJ EQU   LCCA+672
LCCADSSR EQU   LCCA+668
LCCADSSC EQU   LCCA+660
LCCADSS3 EQU   LCCA+648
LCCADSS2 EQU   LCCA+636
LCCADSS1 EQU   LCCA+624
LCCAWTIM EQU   LCCA+616
LCCAITOD EQU   LCCA+608
LCCADTOD EQU   LCCA+600
LCCASTOD EQU   LCCA+592
LCCARIR5 EQU   LCCASPSA+44
LCCARIR4 EQU   LCCASPSA+40
LCCARIR3 EQU   LCCASPSA+36
LCCARIR2 EQU   LCCASPSA+32
LCCARPR5 EQU   LCCASPSA+28
LCCARPR4 EQU   LCCASPSA+24
LCCARPR3 EQU   LCCASPSA+20
LCCARPR2 EQU   LCCASPSA+16
LCCADSR5 EQU   LCCASPSA+12
LCCADSR4 EQU   LCCASPSA+8
LCCADSR3 EQU   LCCASPSA+4
LCCADSR2 EQU   LCCASPSA
LCCARV68 EQU   LCCA+543
LCCAPSMK EQU   LCCA+542
LCCARV67 EQU   LCCADSF2
LCCARV66 EQU   LCCADSF2
LCCARV65 EQU   LCCADSF2
LCCARV64 EQU   LCCADSF2
LCCADSRW EQU   LCCADSF2
LCCADSPL EQU   LCCADSF2
LCCAGSRB EQU   LCCADSF2
LCCASRBM EQU   LCCADSF2
LCCARV61 EQU   LCCADSF1
LCCARV60 EQU   LCCADSF1
LCCARV59 EQU   LCCADSF1
LCCARV58 EQU   LCCADSF1
LCCATIMR EQU   LCCADSF1
LCCADSS  EQU   LCCADSF1
LCCAVCPU EQU   LCCADSF1
LCCAACR  EQU   LCCADSF1
LCCAASCP EQU   LCCA+532
LCCAESSA EQU   LCCA+528
LCCARV55 EQU   LCCASPN4
LCCARV54 EQU   LCCASPN4
LCCARV53 EQU   LCCASPN4
LCCARV52 EQU   LCCASPN4
LCCARV51 EQU   LCCASPN4
LCCARV50 EQU   LCCASPN4
LCCARV49 EQU   LCCASPN4
LCCARV48 EQU   LCCASPN4
LCCARV47 EQU   LCCASPN3
LCCARV46 EQU   LCCASPN3
LCCARV45 EQU   LCCASPN3
LCCARV44 EQU   LCCASPN3
LCCARV43 EQU   LCCASPN3
LCCARV42 EQU   LCCASPN3
LCCARV41 EQU   LCCASPN3
LCCARV40 EQU   LCCASPN3
LCCARV39 EQU   LCCASPN2
LCCARV38 EQU   LCCASPN2
LCCARV37 EQU   LCCASPN2
LCCARV36 EQU   LCCASPN2
LCCARV35 EQU   LCCASPN2
LCCARV34 EQU   LCCASPN2
LCCARV33 EQU   LCCASPN2
LCCARV32 EQU   LCCASPN2
LCCARV31 EQU   LCCASPN1
LCCARV30 EQU   LCCASPN1
LCCAMFIO EQU   LCCASPN1
LCCARSTR EQU   LCCASPN1
LCCATSPN EQU   LCCASPN1
LCCALOCK EQU   LCCASPN1
LCCASIGP EQU   LCCASPN1
LCCAPTLB EQU   LCCASPN1
LCCARV27 EQU   LCCAIHR4
LCCARV26 EQU   LCCAIHR4
LCCARV25 EQU   LCCAIHR4
LCCARV24 EQU   LCCAIHR4
LCCARV23 EQU   LCCAIHR4
LCCARV22 EQU   LCCAIHR4
LCCARV21 EQU   LCCAIHR4
LCCARV20 EQU   LCCAIHR4
LCCARV19 EQU   LCCAIHR3
LCCARV18 EQU   LCCAIHR3
LCCARV17 EQU   LCCAIHR3
LCCARV16 EQU   LCCAIHR3
LCCARV15 EQU   LCCAIHR3
LCCARV14 EQU   LCCAIHR3
LCCARV13 EQU   LCCAIHR3
LCCARV12 EQU   LCCAIHR3
LCCARV11 EQU   LCCAIHR2
LCCARV10 EQU   LCCAIHR2
LCCARV09 EQU   LCCAIHR2
LCCARV08 EQU   LCCAIHR2
LCCARV07 EQU   LCCAIHR2
LCCARV06 EQU   LCCAIHR2
LCCARV05 EQU   LCCAIHR2
LCCARV04 EQU   LCCAIHR2
LCCARV03 EQU   LCCAIHR1
LCCARV02 EQU   LCCAIHR1
LCCARV01 EQU   LCCAIHR1
LCCAPPIE EQU   LCCAIHR1
LCCAPSG1 EQU   LCCAIHR1
LCCAPDAT EQU   LCCAIHR1
LCCAXRC2 EQU   LCCAIHR1
LCCAXRC1 EQU   LCCAIHR1
LCCAIOPS EQU   LCCA+512
LCCAGPGR EQU   LCCA+448
LCCAR133 EQU   LCCA+444
LCCAR132 EQU   LCCA+440
LCCAR131 EQU   LCCA+436
LCCAR130 EQU   LCCA+432
LCCAR129 EQU   LCCA+428
LCCAR128 EQU   LCCA+424
LCCAR127 EQU   LCCA+420
LCCAR126 EQU   LCCA+416
LCCARSGR EQU   LCCA+352
LCCAXGR3 EQU   LCCA+288
LCCAXGR2 EQU   LCCA+224
LCCAXGR1 EQU   LCCA+160
LCCACR0  EQU   LCCA+156
LCCAMCR1 EQU   LCCA+152
LCCAPVAD EQU   LCCA+148
LCCAPINT EQU   LCCA+144
LCCAPPSW EQU   LCCA+136
LCCAPGR2 EQU   LCCA+72
LCCAPGR1 EQU   LCCA+8
LCCARV77 EQU   LCCA+6
LCCACPUA EQU   LCCA+4
LCCALCCA EQU   LCCA
OUCBEND  EQU   OUCB+136
OUCBNTSP EQU   OUCB+134
OUCBNDS  EQU   OUCB+132
OUCBTIO  EQU   OUCB+128
OUCBTCP  EQU   OUCB+124
OUCBPST  EQU   OUCB+120
OUCBPS2  EQU   OUCBPSS+4
OUCBPS1  EQU   OUCBPSS
OUCBIOSM EQU   OUCB+108
OUCBTMP  EQU   OUCB+104
OUCBR03  EQU   OUCB+102
OUCBIOR  EQU   OUCB+100
OUCBCRV  EQU   OUCB+98
OUCBIRV  EQU   OUCB+96
OUCBWMR  EQU   OUCB+92
OUCBCMRV EQU   OUCB+88
OUCBCF2  EQU   OUCBCFL
OUCBRSM  EQU   OUCBCFL
OUCBRDY  EQU   OUCBCFL
OUCBACN  EQU   OUCBCSW
OUCBACT  EQU   OUCB+80
OUCBWSS  EQU   OUCB+78
OUCBPSO  EQU   OUCB+76
OUCBTMO  EQU   OUCB+72
OUCBTMS  EQU   OUCB+68
OUCBMSO  EQU   OUCB+64
OUCBIOC  EQU   OUCB+60
OUCBCPU  EQU   OUCB+56
OUCBWMS  EQU   OUCB+52
OUCBTMW  EQU   OUCB+48
OUCBIMCB EQU   OUCB+44
OUCBASCB EQU   OUCB+40
OUCBSWC  EQU   OUCB+38
OUCBSRC  EQU   OUCB+37
OUCBDMN  EQU   OUCB+36
OUCBDMO  EQU   OUCB+34
OUCBWMG  EQU   OUCB+32
OUCBPGP  EQU   OUCB+31
OUCBR40  EQU   OUCB+30
OUCBR30  EQU   OUCB+29
OUCBSPG  EQU   OUCB+28
OUCBRDP  EQU   OUCB+27
OUCBNDP  EQU   OUCB+26
OUCBRPG  EQU   OUCB+25
OUCBNPG  EQU   OUCB+24
OUCBUF7  EQU   OUCBUFL
OUCBUF6  EQU   OUCBUFL
OUCBUF5  EQU   OUCBUFL
OUCBTSWC EQU   OUCBUFL
OUCBTSWP EQU   OUCBUFL
OUCBRSWP EQU   OUCBUFL
OUCBJSAS EQU   OUCBUFL
OUCBJSFS EQU   OUCBUFL
OUCBNQC  EQU   OUCB+22
OUCBMWT  EQU   OUCBEFL
OUCBQSC  EQU   OUCBEFL
OUCBQSS  EQU   OUCBEFL
OUCBNQF  EQU   OUCBEFL
OUCBCIM  EQU   OUCBEFL
OUCBOWT  EQU   OUCBEFL
OUCBTRM  EQU   OUCBEFL
OUCBLWT  EQU   OUCBEFL
OUCBINC  EQU   OUCBTFL
OUCBINP  EQU   OUCBTFL
OUCBMAR  EQU   OUCBTFL
OUCBPCH  EQU   OUCBTFL
OUCBRTR  EQU   OUCBTFL
OUCBNTR  EQU   OUCBTFL
OUCBSTR  EQU   OUCBTFL
OUCBATR  EQU   OUCBTFL
OUCBASW  EQU   OUCBAFL
OUCBNWT  EQU   OUCBAFL
OUCBR02  EQU   OUCBAFL
OUCBJSR  EQU   OUCBAFL
OUCBCPL  EQU   OUCBAFL
OUCBRMA  EQU   OUCBAFL
OUCBAPG  EQU   OUCBAFL
OUCBAF0  EQU   OUCBAFL
OUCBFXS  EQU   OUCBYFL
OUCBDTA  EQU   OUCBYFL
OUCBAXS  EQU   OUCBYFL
OUCBPSTR EQU   OUCBYFL
OUCBMNT  EQU   OUCBYFL
OUCBLOG  EQU   OUCBYFL
OUCBSTT  EQU   OUCBYFL
OUCBPSTE EQU   OUCBYFL
OUCBSCN  EQU   OUCBSFL
OUCBENQ  EQU   OUCBSFL
OUCBPVL  EQU   OUCBSFL
OUCBNSWI EQU   OUCBSFL
OUCBINV  EQU   OUCBSFL
OUCBBIB  EQU   OUCBSFL
OUCBCTI  EQU   OUCBSFL
OUCBNSW  EQU   OUCBSFL
OUCBQF7  EQU   OUCBQFL
OUCBQF6  EQU   OUCBQFL
OUCBOUT  EQU   OUCBQFL
OUCBOFF  EQU   OUCBQFL
OUCBQSFL EQU   OUCBQFL
OUCBGOB  EQU   OUCBQFL
OUCBGOI  EQU   OUCBQFL
OUCBGOO  EQU   OUCBQFL
OUCBTMA  EQU   OUCB+12
OUCBBCK  EQU   OUCB+8
OUCBFWD  EQU   OUCB+4
OUCBNAME EQU   OUCB
@NM00006 EQU   CALLREGS+20
S14      EQU   CALLREGS+12
@NM00005 EQU   @NM00004
MOVERBN  EQU   TQIDRBN+2
IDOFTQ   EQU   TQIDRBN+1
@NM00003 EQU   TQIDRBN
@NM00002 EQU   INPUT+4
@NM00046 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00045 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00044 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00043 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00042 EQU   FLCFSA
@NM00041 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00040 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00039 EQU   FLCIOA
@NM00038 EQU   FLCMCLA+15
@NM00037 EQU   FLCMCLA+14
@NM00036 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00035 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00034 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00033 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00032 EQU   FLCPER
@NM00031 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00030 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00029 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00028 EQU   FLCPIILC
@NM00027 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00026 EQU   FLCSVILC
@NM00025 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00024 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00023 EQU   FLCICCW2+4
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RF00121 EQU   GETCMSRB
@RT00154 EQU   GETPOSRB
@RF00154 EQU   DETBNDS
@RF00158 EQU   DETBNDS
@RT00228 EQU   LOCALQ
@RC00276 EQU   EXITCLR
@RT00546 EQU   ENDVAL
@RT00627 EQU   EXITI
@RT00785 EQU   FREERGN
@RT00794 EQU   FREEPCB
@RT00856 EQU   UPPFTE
@RT00889 EQU   UPPFTE
@RT00903 EQU   LASTPFTE
@RT00905 EQU   LASTPFTE
@RT00909 EQU   LASTPFTE
@ENDDATA EQU   *
         END   IEAVEQR,(C'PLS1217',0701,78164)

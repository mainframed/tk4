         TITLE 'IEFAB461 - GDG SINGLE PROCESSING                       *
                        '
IEFAB461 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB461  74.004'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE  R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(32),0(@01)                              01S0001
         MODESET EXTKEY=SCHED
*                                                                    */
*   DO SEARCH=MAXDSNLN TO 1 BY-1 WHILE(JFCBDSNM(SEARCH)=BLANK); 01S0068
         LA    SEARCH,44                                        01S0068
@DL00068 L     @10,@PC00001+16                                  01S0068
         L     @10,JFCBPTR(,@10)                                01S0068
         ALR   @10,SEARCH                                       01S0068
         AL    @10,@CF00886                                     01S0068
         CLI   JFCBDSNM(@10),C' '                               01S0068
         BNE   @DC00068                                         01S0068
*   END;                            /* SCAN THE DSN FOR A BLANK TO
*                                      DETERMINE THE DSN LENGTH      */
         BCTR  SEARCH,0                                         01S0069
         LTR   SEARCH,SEARCH                                    01S0069
         BP    @DL00068                                         01S0069
@DC00068 DS    0H                                               01S0070
*   IF SEARCH>GDGNMLN THEN          /* LENGTH GREATER THAN 35 ??     */
         CH    SEARCH,@CH00072                                  01S0070
         BNH   @RF00070                                         01S0070
*     DO;                           /* IF YES THEN INDICATE ERROR    */
*       HWRTCD=ERROR;               /* SET RETURN CODE = 4 AND       */
         L     @10,@PC00001+8                                   01S0072
         L     @10,HWRTNP(,@10)                                 01S0072
         MVC   HWRTCD(2,@10),@CH00065                           01S0072
*       HWRSNCD=FIFTY3;             /* REASON CODE = 53              */
         MVC   HWRSNCD(2,@10),@CH00091                          01S0073
*     END;                                                      01S0074
*   ELSE                            /* DSNAME LENGTH O.K.            */
*     DO;                                                       01S0075
         B     @RC00070                                         01S0075
@RF00070 DS    0H                                               01S0076
*                                                               02S0076
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GENNOVAL                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GENERATION NUMBER SPECIFICATION CHECK         */
*/*                                                                  */
*/* FUNCTION - CHECK THE GENERATION INDEX NUMBER SPECIFICATION.      */
*/*                                                                  */
*/*   OPERATION - THE FIRST CHARACTER (THE GENERATION NUMBER IS IN   */
*/*               THE ELEMENT NUMBER FIELD IN THE JFCB) MAY BE A     */
*/*               '0', '+', OR '-'.  IF '0', THE REMAINING           */
*/*               CHARACTERS (4 MAXIMUM) MUST BE 0'S ( OR BLANK).    */
*/*               NUMBERS OTHER THAN ZERO MUST BE NUMERIC, THREE     */
*/*               DIGITS OR LESS, LESS THAN 255, AND FOLLOWED BY AT  */
*/*               LEAST ONE BLANK.                                   */
*/*               ERRORS DETECTED ARE REFLECTED BY RETURN AND REASON */
*/*               CODES PLACED IN THE HSKPWA.                        */
*/*                                                                  */
*/* ENTRY - INLINE                                                   */
*/*                                                                  */
*/*   PURPOSE - SINGLE ENTRY                                         */
*/*                                                                  */
*/*   INPUT - N/A                                                    */
*/*                                                                  */
*/* EXIT - INLINE                                                    */
*/*                                                                  */
*/*   CONDITION - N/A                                                */
*/*                                                                  */
*/*   OUTPUT DATA - ERROR     - REASON CODE  52                      */
*/*               - NON ERROR - REASON CODE   0                      */
*/*                                                                  */
*/*   RETURN CODE - ERROR     - 4 INVALID GENERATION INDEX NUMBER    */
*/*               - NON ERROR - 0   VALID GENERATION INDEX NUMBER    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0076
*       IF JFCBELNM(1)=CHAR0 THEN   /* FIRST CHAR A ZERO ???         */
         L     @10,@PC00001+16                                  02S0076
         L     @10,JFCBPTR(,@10)                                02S0076
         CLI   JFCBELNM(@10),C'0'                               02S0076
         BNE   @RF00076                                         02S0076
*         DO;                       /* IF YES THEN                   */
*           DO ELNMSZ=2 TO MAXELNM WHILE(JFCBELNM(ELNMSZ)^=BLANK&HWRTCD
*                 =SUCCESS);        /* SCAN THE REST OF THE ELEMENT
*                                      NAME                          */
         LA    @10,2                                            02S0078
         STH   @10,ELNMSZ                                       02S0078
@DL00078 L     @03,@PC00001+16                                  02S0078
         L     @03,JFCBPTR(,@03)                                02S0078
         ALR   @10,@03                                          02S0078
         CLI   JFCBELNM-1(@10),C' '                             02S0078
         BE    @DC00078                                         02S0078
         L     @10,@PC00001+8                                   02S0078
         L     @10,HWRTNP(,@10)                                 02S0078
         ICM   @15,3,HWRTCD(@10)                                02S0078
         BNZ   @DC00078                                         02S0078
*             IF JFCBELNM(ELNMSZ)^=CHAR0 THEN/* A ZERO 1ST CHAR MUST
*                                      BE FOLLOWED BY ZEROS OR BLANKS*/
         LH    @15,ELNMSZ                                       02S0079
         ALR   @03,@15                                          02S0079
         CLI   JFCBELNM-1(@03),C'0'                             02S0079
         BE    @RF00079                                         02S0079
*               DO;                 /* INDICATE ERROR IN INDEX       */
*                 HWRTCD=ERROR;     /* SET RETURN CODE = 4           */
         MVC   HWRTCD(2,@10),@CH00065                           02S0081
*                 HWRSNCD=FIFTY2;   /* AND REASON CODE 52            */
         MVC   HWRSNCD(2,@10),@CH00093                          02S0082
*               END;                                            02S0083
*           END;                                                02S0084
@RF00079 LA    @10,1                                            02S0084
         AH    @10,ELNMSZ                                       02S0084
         STH   @10,ELNMSZ                                       02S0084
         CH    @10,@CH00071                                     02S0084
         BNH   @DL00078                                         02S0084
@DC00078 DS    0H                                               02S0085
*           IF HWRTCD=SUCCESS&ELNMSZ>4 THEN/* WERE MORE THAN 3 CHARS
*                                      SPEC                          */
         L     @10,@PC00001+8                                   02S0085
         L     @10,HWRTNP(,@10)                                 02S0085
         ICM   @03,3,HWRTCD(@10)                                02S0085
         BNZ   @RF00085                                         02S0085
         LA    @03,4                                            02S0085
         CH    @03,ELNMSZ                                       02S0085
         BNL   @RF00085                                         02S0085
*             DO;                   /* IF YES THEN                   */
*               HWRTCD=ERROR;       /* INDICATE ERROR RTCD = 4       */
         STH   @03,HWRTCD(,@10)                                 02S0087
*               HWRSNCD=FIFTY2;     /* REASON CODE = 52              */
         MVC   HWRSNCD(2,@10),@CH00093                          02S0088
*             END;                                              02S0089
*         END;                                                  02S0090
*       ELSE                        /* FIRST CHARACTER NOT '0',      */
*         IF(JFCBELNM(1)=PLUSSIGN×JFCBELNM(1)=MINUSIGN)&JFCBELNM(2)^=
*             BLANK THEN            /* IT MUST BE A '+' OR A '-'     */
         B     @RC00076                                         02S0091
@RF00076 L     @10,@PC00001+16                                  02S0091
         L     @10,JFCBPTR(,@10)                                02S0091
         CLI   JFCBELNM(@10),C'+'                               02S0091
         BE    @GL00003                                         02S0091
         CLI   JFCBELNM(@10),C'-'                               02S0091
         BNE   @RF00091                                         02S0091
@GL00003 L     @10,@PC00001+16                                  02S0091
         L     @10,JFCBPTR(,@10)                                02S0091
         CLI   JFCBELNM+1(@10),C' '                             02S0091
         BE    @RF00091                                         02S0091
*           DO;                     /* FOLLOWED BY NUMERICS          */
*             DO ELNMSZ=2 TO MAXELNM WHILE(JFCBELNM(ELNMSZ)^=BLANK&
*                   HWRTCD=SUCCESS);/* SCAN FOR 1-3 NUMERIC CHARS    */
         LA    @10,2                                            02S0093
         STH   @10,ELNMSZ                                       02S0093
@DL00093 L     @03,@PC00001+16                                  02S0093
         L     @03,JFCBPTR(,@03)                                02S0093
         ALR   @10,@03                                          02S0093
         CLI   JFCBELNM-1(@10),C' '                             02S0093
         BE    @DC00093                                         02S0093
         L     @10,@PC00001+8                                   02S0093
         L     @10,HWRTNP(,@10)                                 02S0093
         ICM   @15,3,HWRTCD(@10)                                02S0093
         BNZ   @DC00093                                         02S0093
*               IF JFCBELNM(ELNMSZ)<CHAR0×JFCBELNM(ELNMSZ)>CHAR9 THEN
         LH    @10,ELNMSZ                                       02S0094
         ALR   @10,@03                                          02S0094
         CLI   JFCBELNM-1(@10),C'0'                             02S0094
         BL    @RT00094                                         02S0094
         LH    @10,ELNMSZ                                       02S0094
         ALR   @03,@10                                          02S0094
         CLI   JFCBELNM-1(@03),C'9'                             02S0094
         BNH   @RF00094                                         02S0094
@RT00094 DS    0H                                               02S0095
*                 DO;               /* NON NUMERIC CHARACTER         */
*                   HWRTCD=ERROR;   /* SET RETURN CODE 4             */
         L     @10,@PC00001+8                                   02S0096
         L     @10,HWRTNP(,@10)                                 02S0096
         MVC   HWRTCD(2,@10),@CH00065                           02S0096
*                   HWRSNCD=FIFTY2; /* AND REASON CODE 52            */
         MVC   HWRSNCD(2,@10),@CH00093                          02S0097
*                 END;                                          02S0098
*             END;                                              02S0099
@RF00094 LA    @10,1                                            02S0099
         AH    @10,ELNMSZ                                       02S0099
         STH   @10,ELNMSZ                                       02S0099
         CH    @10,@CH00071                                     02S0099
         BNH   @DL00093                                         02S0099
@DC00093 DS    0H                                               02S0100
*             IF HWRTCD=SUCCESS THEN                            02S0100
         L     @10,@PC00001+8                                   02S0100
         L     @10,HWRTNP(,@10)                                 02S0100
         ICM   @03,3,HWRTCD(@10)                                02S0100
         BNZ   @RF00100                                         02S0100
*               IF ELNMSZ>5×(ELNMSZ=5&JFCBELNM(2:4)>CHAR255) THEN
         LH    @10,ELNMSZ                                       02S0101
         LA    @03,5                                            02S0101
         CR    @10,@03                                          02S0101
         BH    @RT00101                                         02S0101
         CR    @10,@03                                          02S0101
         BNE   @RF00101                                         02S0101
         L     @10,@PC00001+16                                  02S0101
         L     @10,JFCBPTR(,@10)                                02S0101
         CLC   JFCBELNM+1(3,@10),@CC00106                       02S0101
         BNH   @RF00101                                         02S0101
@RT00101 DS    0H                                               02S0102
*                 DO;               /* GEN INDEX GREATER THAN 255    */
*                   HWRTCD=ERROR;   /* SET RETURN CODE 4             */
         L     @10,@PC00001+8                                   02S0103
         L     @10,HWRTNP(,@10)                                 02S0103
         MVC   HWRTCD(2,@10),@CH00065                           02S0103
*                   HWRSNCD=FIFTY2; /* AND REASON CODE 52            */
         MVC   HWRSNCD(2,@10),@CH00093                          02S0104
*                 END;                                          02S0105
*               ELSE                /* PLUS OR MINUS ZERO            */
*                 IF(JFCBELNM(2:ELNMSZ-1)=CHAR000)&SCTSNEW=ON THEN
         B     @RC00101                                         02S0106
@RF00101 L     @10,@PC00001+16                                  02S0106
         L     @10,JFCBPTR(,@10)                                02S0106
         LH    @03,ELNMSZ                                       02S0106
         SH    @03,@CH00052                                     02S0106
         EX    @03,@SC00893                                     02S0106
         BNE   @RF00106                                         02S0106
         L     @10,@PC00001+12                                  02S0106
         L     @10,SIOTPTR(,@10)                                02S0106
         TM    SCTSNEW(@10),B'00000100'                         02S0106
         BNO   @RF00106                                         02S0106
*                   DO;             /* REQUEST FOR NEW DATA SET??    */
*                     HWRTCD=ERROR; /* IF YES FAIL STEP              */
         L     @10,@PC00001+8                                   02S0108
         L     @10,HWRTNP(,@10)                                 02S0108
         MVC   HWRTCD(2,@10),@CH00065                           02S0108
*                     HWRSNCD=FIFTY4;/* INCOMPATABLE DISPOSITION
*                                      SPECIFIED                     */
         MVC   HWRSNCD(2,@10),@CH00089                          02S0109
*                   END;                                        02S0110
*           END;                                                02S0111
*         ELSE                      /* 1ST CHAR INVALID              */
*           DO;                                                 02S0112
         B     @RC00091                                         02S0112
@RF00091 DS    0H                                               02S0113
*             HWRTCD=ERROR;         /* SET RETURN CODE 4             */
         L     @10,@PC00001+8                                   02S0113
         L     @10,HWRTNP(,@10)                                 02S0113
         MVC   HWRTCD(2,@10),@CH00065                           02S0113
*             HWRSNCD=FIFTY2;       /* AND REASON CODE 52            */
         MVC   HWRSNCD(2,@10),@CH00093                          02S0114
*           END;                                                02S0115
*       IF HWRTCD=SUCCESS THEN      /* GENERATION NUMBER IS VALID    */
@RC00091 DS    0H                                               01S0116
@RC00076 SLR   @10,@10                                          01S0116
         L     @03,@PC00001+8                                   01S0116
         L     @03,HWRTNP(,@03)                                 01S0116
         CH    @10,HWRTCD(,@03)                                 01S0116
         BNE   @RF00116                                         01S0116
*         DO;                                                   01S0117
*           HWDSNLN=SEARCH+1;       /* SAVE OFFSET OF FIRST BLANK    */
         L     @03,@PC00001+4                                   01S0118
         L     @03,HWDATAP(,@03)                                01S0118
         LA    @15,1                                            01S0118
         ALR   @15,SEARCH                                       01S0118
         STH   @15,HWDSNLN(,@03)                                01S0118
*           GDGDSNWA=JFCBDSNM;      /* SAVE THE 'BASE' DS NAME       */
         L     @02,@PC00001+16                                  01S0119
         L     @01,JFCBPTR(,@02)                                01S0119
         MVC   GDGDSNWA(44),JFCBDSNM(@01)                       01S0119
*           HWGDGBSP=ZERO;          /* INIT BASE LEVEL PTR TO 0      */
         ST    @10,HWGDGBSP(,@03)                               01S0120
*           IF JCTGDGNT^=NONE THEN  /* DOES A GDGNT EXIST ??         */
         L     @15,@PC00001+24                                  01S0121
         L     @15,JCTPTR(,@15)                                 01S0121
         ICM   @14,7,JCTGDGNT(@15)                              01S0121
         BZ    @RF00121                                         01S0121
*             DO;                                               01S0122
*               IF FGDGNTP=NONE THEN/* IF FIRST REQUEST THIS STEP,   */
         L     @14,@PC00001+20                                  01S0123
         C     @10,FGDGNTP(,@14)                                01S0123
         BNE   @RF00123                                         01S0123
*                 DO;               /* READ AND CHAIN THE GDGNT 01S0124
*                                                                    */
*                                                               02S0125
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GNTRDLOC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GDG NAME TABLE READ AND CHAIN                 */
*/*                                                                  */
*/* FUNCTION - TO RESOLVE THE GDGNT SVAB CHAIN POINTER(S) IN THE     */
*/*            GDGNT AND IN THE HSKPWA.                              */
*/*                                                                  */
*/*   OPERATION - READ LOCATE ISSUED FOR EACH BLOCK OF THE GDGNT VIA */
*/*               SWA INTERFACE (IEFAB4F7).  THE BLOCKS ARE CHAINED  */
*/*               AND A POINTER TO THE FIRST BLOCK IS PLACED INTO    */
*/*               THE HSKPWA (HOUSEKEEPING WORKAREA).                */
*/*                                                                  */
*/* ENTRY - IF THE GDG NAME TABLE HAS NOT BEEN READ IN THIS STEP.    */
*/*                                                                  */
*/*   PURPOSE - N/A                                                  */
*/*                                                                  */
*/*   INPUT DATA - N/A                                               */
*/*                                                                  */
*/* EXIT - INLINE                                                    */
*/*                                                                  */
*/*   CONDITION - N/A                                                */
*/*                                                                  */
*/*   OUTPUT DATA - N/A                                              */
*/*                                                                  */
*/*   RETURN CODE - N/A                                              */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0125
*                   SWACTLS=ZERO;   /* SET SWA INTERFACE CONTROLS    */
         STH   @10,SWACTLS                                      02S0125
*                   SWREAD=READ;    /* FOR READ OPERATION, AND       */
*                   SWNEW=CREATEPA; /* CREATE AND CHAIN AN EPA.      */
         OI    SWREAD,B'00101000'                               02S0127
*                   SWCHN=CHAINEPA;                             02S0128
         OI    SWCHN,B'10000000'                                02S0128
*                   BLOCKSVA=JCTGDGNT;/* OBTAIN SVA OF FIRST GDGNT   */
         MVC   BLOCKSVA(3),JCTGDGNT(@15)                        02S0129
*                   DO WHILE(BLOCKSVA^=NONE);/* LOOP ONCE FOR EACH
*                                      GDGNT                         */
         B     @DE00130                                         02S0130
@DL00130 DS    0H                                               02S0131
*                     CALL IEFAB4F7(SWACTLS,0,HWLEPAP,ADDR(DISKADDR),
*                         ADDR(COREADDR),0,RECORDNM);/* CALL SWA
*                                      INTERFACE TO CONVERT THE SVA
*                                      TO AN SVAB FOR THE GDGNT      */
         LA    @10,SWACTLS                                      02S0131
         ST    @10,@AL00001                                     02S0131
         LA    @10,@CF00081                                     02S0131
         ST    @10,@AL00001+4                                   02S0131
         L     @10,@PC00001+4                                   02S0131
         L     @10,HWDATAP(,@10)                                02S0131
         LA    @10,HWLEPAP(,@10)                                02S0131
         ST    @10,@AL00001+8                                   02S0131
         LA    @10,DISKADDR                                     02S0131
         ST    @10,@TF00001                                     02S0131
         LA    @10,@TF00001                                     02S0131
         ST    @10,@AL00001+12                                  02S0131
         LA    @10,COREADDR                                     02S0131
         ST    @10,@TF00002                                     02S0131
         LA    @10,@TF00002                                     02S0131
         ST    @10,@AL00001+16                                  02S0131
         LA    @10,@CF00081                                     02S0131
         ST    @10,@AL00001+20                                  02S0131
         LA    @10,@CF00057                                     02S0131
         ST    @10,@AL00001+24                                  02S0131
         L     @15,@CV00051                                     02S0131
         LA    @01,@AL00001                                     02S0131
         BALR  @14,@15                                          02S0131
*                     IF FGDGNTP=NONE THEN/* IS THIS THE FIRST BLOCK */
         L     @10,@PC00001+20                                  02S0132
         ICM   @15,15,FGDGNTP(@10)                              02S0132
         BNZ   @RF00132                                         02S0132
*                       FGDGNTP=BLOKSVAB;/* IF YES, SAVE THE ADDRESS */
         MVC   FGDGNTP(4,@10),BLOKSVAB                          02S0133
*                     ELSE                                      02S0134
*                       GNTNEXTR=BLOKSVAB;/* CHAIN TO PREVIOUS BLOCK */
         B     @RC00132                                         02S0134
@RF00132 L     @10,GDGNTPTR                                     02S0134
         MVC   GNTNEXTR(4,@10),BLOKSVAB                         02S0134
*                     GDGNTPTR=BLOKSVAB;/* 'MAP' THE GDGNT BLOCK     */
@RC00132 L     @10,BLOKSVAB                                     02S0135
         ST    @10,GDGNTPTR                                     02S0135
*                     BLOCKSVA=GNTNEXTP;/* SVA OF NEXT BLOCK TO READ */
         MVC   BLOCKSVA(3),GNTNEXTP(@10)                        02S0136
*                   END;                                        02S0137
@DE00130 ICM   @10,7,BLOCKSVA                                   02S0137
         BNZ   @DL00130                                         02S0137
*                 END;              /* NOW, SCAN THE GDGNT      01S0138
*                                                                    */
*                                                               02S0139
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GNTSCAN                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GDG NAME TABLE DSNAME SCAN                    */
*/*                                                                  */
*/* FUNCTION - TO SEARCH THE GDGNT TO DETERMINE IF A PRIOR REQUEST   */
*/*            HAS BEEN MADE IN THE JOB FOR THIS GDG , AND           */
*/*            PLACE A POINTER TO THE ENTRY, IF FOUND, INTO THE      */
*/*            HOUSEKEEPING WORKAREA.                                */
*/*                                                                  */
*/*   OPERATION - SEARCH THE GDG NAME TABLE FOR A MATCH OF THE DATA  */
*/*               SET NAME SPECIFIED AND THE DATA SET NAME IN THE    */
*/*               GDGNT ENTRIES.  IF A MATCH IS FOUND, THE  ADDRESS  */
*/*               OF ASSOCIATED BASE LEVEL IS PLACED INTO HSKPWA.    */
*/*                                                                  */
*/* ENTRY - INLINE                                                   */
*/*                                                                  */
*/*   PURPOSE - SINGLE ENTRY                                         */
*/*                                                                  */
*/*   INPUT DATA - DATA SET NAME IN JFCB.                            */
*/*                                                                  */
*/* EXIT - INLINE                                                    */
*/*                                                                  */
*/*   CONDITION - N/A                                                */
*/*                                                                  */
*/*   OUTPUT DATA - POINTER TO BASE LEVEL IN HSKPWA IF SUCCESSFUL.   */
*/*                                                                  */
*/*   RETURN CODE - N/A                                              */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0139
*               GDGNTPTR=FGDGNTP;   /* ADDR OF FIRST GDGNT BLOCK     */
@RF00123 L     @10,@PC00001+20                                  02S0139
         MVC   GDGNTPTR(4),FGDGNTP(@10)                         02S0139
*               DO WHILE(GDGNTPTR^=NONE&HWGDGBSP=NONE);/* SEARCH
*                                      UNTIL THE DSN IS FOUND OR
*                                      UNTIL THERE ARE NO MORE GDGNT
*                                      ENTRIES                       */
         B     @DE00140                                         02S0140
@DL00140 DS    0H                                               02S0141
*                 DO COMPARE=1 TO GNTENT WHILE(HWGDGBSP=NONE);/*
*                                      COMPARE THE GDGNT ENTRY NAMES
*                                      WITH THE JFCB BASE DSN        */
         LA    COMPARE,1                                        02S0141
         B     @DE00141                                         02S0141
@DL00141 L     @10,@PC00001+4                                   02S0141
         L     @10,HWDATAP(,@10)                                02S0141
         ICM   @03,15,HWGDGBSP(@10)                             02S0141
         BNZ   @DC00141                                         02S0141
*                   IF GNTNAME(COMPARE)=GDGDSNWA(1:35) THEN/* FOUND, */
         L     @03,GDGNTPTR                                     02S0142
         LR    @15,COMPARE                                      02S0142
         MH    @15,@CH00259                                     02S0142
         ST    @15,@TF00001                                     02S0142
         ALR   @15,@03                                          02S0142
         AL    @15,@CF00896                                     02S0142
         CLC   GNTNAME-8(35,@15),GDGDSNWA                       02S0142
         BNE   @RF00142                                         02S0142
*                     HWGDGBSP=ADDR(GNTBASE(COMPARE));/* UPDATE 02S0143
*                                      HSKPWA                        */
         L     @01,@TF00001                                     02S0143
         LA    @03,GNTBASE-39(@01,@03)                          02S0143
         ST    @03,HWGDGBSP(,@10)                               02S0143
*                 END;                                          02S0144
@RF00142 AH    COMPARE,@CH00057                                 02S0144
@DE00141 L     @10,GDGNTPTR                                     02S0144
         SLR   @03,@03                                          02S0144
         IC    @03,GNTENT(,@10)                                 02S0144
         CR    COMPARE,@03                                      02S0144
         BNH   @DL00141                                         02S0144
@DC00141 DS    0H                                               02S0145
*                 LASTGNTP=GDGNTPTR;/* GDGNT POINTER WILL CONTAIN    */
         L     @10,GDGNTPTR                                     02S0145
         ST    @10,LASTGNTP                                     02S0145
*                 GDGNTPTR=GNTNEXTR;/* THE ADDRESS OF THE LAST       */
         L     @10,GNTNEXTR(,@10)                               02S0146
         ST    @10,GDGNTPTR                                     02S0146
*               END;                /* BLOCK IN THE CHAIN            */
@DE00140 SLR   @10,@10                                          02S0147
         C     @10,GDGNTPTR                                     02S0147
         BE    @DC00140                                         02S0147
         L     @15,@PC00001+4                                   02S0147
         L     @01,HWDATAP(,@15)                                02S0147
         C     @10,HWGDGBSP(,@01)                               02S0147
         BE    @DL00140                                         02S0147
@DC00140 DS    0H                                               02S0148
*               GDGNTPTR=LASTGNTP;  /* RESET TO ADDR OF LAST BLOCK
*                                                                    */
         MVC   GDGNTPTR(4),LASTGNTP                             02S0148
*             END;                                              01S0149
*           IF HWGDGBSP=ZERO THEN   /* BASE LEVEL NOT IN GDGNT       */
@RF00121 SLR   @10,@10                                          01S0150
         L     @15,@PC00001+4                                   01S0150
         L     @14,HWDATAP(,@15)                                01S0150
         C     @10,HWGDGBSP(,@14)                               01S0150
         BNE   @RF00150                                         01S0150
*             DO;                   /* JLOCATE WILL OBTAIN BASE LEVEL
*                                                                    */
*                                                               02S0152
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GNTLCUPD                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GDG NAME TABLE PROCESSING                     */
*/*                                                                  */
*/* FUNCTION - TO OBTAIN THE DSN BASE LEVEL VIA JLOCATE AND TO       */
*/*            UPDATE THE GDGNT ACCORDINGLY.                         */
*/*                                                                  */
*/*   OPERATION - JLOCATE (IEFAB469) IS CALLED TO ISSUE A LOCATE ON  */
*/*               THE LEVEL ZERO DSN TO OBTAIN THE DSN BASE LEVEL.   */
*/*               IF AN ERROR OCCURS, PROCESSING IS TERMINATED. THE  */
*/*               DSN IS THEN SCANNED TO DETERMINE THE LENGTH OF THE */
*/*               DSN IN ORDER TO OBTAIN THE DSN BASE LEVEL FROM THE */
*/*               DSN.(NOTE1 - THE BASE LEVEL IS CONTAINED IN THE LOW*/
*/*               LEVEL QUALIFIED NAME GXXXXV00 WHICH IS RETURNED    */
*/*               FROM JLOCATE. XXXX IS THE BASE DSN.) (NOTE2 - THE  */
*/*               DSN LENGTH MUST BE REDETERMINED SINCE IF AN ALIAS  */
*/*               WAS SPECIFIED AS A HIGH LEVEL QUALIFIED NAME IT    */
*/*               WILL BE REPLACED BY THE REAL DSN.)                 */
*/*               IF NO GDGNT EXISTS, OR IF THE LAST GDGNT BLOCK IS  */
*/*               FULL, SWA INTERFACE (IEFAB4F7) IS CALLED TO OBTAIN */
*/*               SPACE FOR A NEW GDGNT BLOCK.                       */
*/*               THE APPROPRIATE GDGNT BLOCK IS THEN UPDATED WITH   */
*/*               THE DSN AND ITS BASE LEVEL .                       */
*/*                                                                  */
*/* ENTRY - INLINE                                                   */
*/*                                                                  */
*/*   PURPOSE - N/A                                                  */
*/*                                                                  */
*/*   INPUT DATA - N/A                                               */
*/*                                                                  */
*/* EXIT - INLINE                                                    */
*/*                                                                  */
*/*   CONDITION - ERROR     - NON ZERO RETURN CODE FROM JLOCATE.     */
*/*             - NON ERROR - PROCESSING COMPLETE                    */
*/*                                                                  */
*/*   OUTPUT DATA - ERROR     - REASON CODE AS SET BY JLOCATE.       */
*/*               - NON ERROR - UPDATED GDG NAME TABLE AND JFCBDSN.  */
*/*                                                                  */
*/*   RETURN CODE - ERROR     - AS SET BY JLOCATE.                   */
*/*               - NON ERROR - 0                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0152
*               GDGDSNWA(HWDSNLN:HWDSNLN+LENGTH(LEVEL0)-1)=LEVEL0;/*
*                                      DUMMY DSN LEVEL ZERO          */
         LH    @01,HWDSNLN(,@14)                                02S0152
         LA    @09,GDGDSNWA-1(@01)                              02S0152
         MVC   0(3,@09),LEVEL0                                  02S0152
*               HWJLCTLS=ZERO;      /* RESET JLOCATE CONTROLS        */
         L     @09,@PC00001                                     02S0153
         L     @08,HWCNTRLP(,@09)                               02S0153
         STH   @10,HWJLCTLS(,@08)                               02S0153
*               HWSYSLOC=SYSLOCAT;  /* ISSUE SYSTEM LOCATE           */
*               HWLBASEL=LOCBASEL;  /* LOCATE BASE LEVEL DSN ONLY    */
         OI    HWSYSLOC(@08),B'00101000'                        02S0155
*               CALL IEFAB469(HWCNTRLP,HWDATAP,HWRTNP,HWCSIOTP,JFCBPTR,
*                   ADDR(GDGDSNWA));/* JLOCATE                       */
         ST    @09,@AL00001                                     02S0156
         ST    @15,@AL00001+4                                   02S0156
         L     @10,@PC00001+8                                   02S0156
         ST    @10,@AL00001+8                                   02S0156
         LA    @10,HWCSIOTP(,@14)                               02S0156
         ST    @10,@AL00001+12                                  02S0156
         L     @10,@PC00001+16                                  02S0156
         ST    @10,@AL00001+16                                  02S0156
         LA    @10,GDGDSNWA                                     02S0156
         ST    @10,@TF00001                                     02S0156
         LA    @10,@TF00001                                     02S0156
         ST    @10,@AL00001+20                                  02S0156
         L     @15,@CV00050                                     02S0156
         LA    @01,@AL00001                                     02S0156
         BALR  @14,@15                                          02S0156
*               IF HWRTCD=SUCCESS THEN                          02S0157
         L     @10,@PC00001+8                                   02S0157
         L     @10,HWRTNP(,@10)                                 02S0157
         ICM   @15,3,HWRTCD(@10)                                02S0157
         BNZ   @RF00157                                         02S0157
*                 DO;               /* LOCATE SUCCESSFUL             */
*                   DO SEARCH=MAXDSNLN TO 1 BY-1 WHILE(GDGDSNWA(SEARCH)
*                         =BLANK);                              02S0159
         LA    SEARCH,44                                        02S0159
@DL00159 LA    @10,GDGDSNWA-1(SEARCH)                           02S0159
         CLI   0(@10),C' '                                      02S0159
         BNE   @DC00159                                         02S0159
*                   END;            /* FIND LENGTH OF THE DSN        */
         BCTR  SEARCH,0                                         02S0160
         LTR   SEARCH,SEARCH                                    02S0160
         BP    @DL00159                                         02S0160
@DC00159 DS    0H                                               02S0161
*                   IF FGDGNTP=NONE×/* IF NO GDGNT EXISTS OR THE     */
*                       GNTENT=FULL THEN/* LAST GDGNT BLOCK IS FULL, */
         L     @10,@PC00001+20                                  02S0161
         ICM   @03,15,FGDGNTP(@10)                              02S0161
         BZ    @RT00161                                         02S0161
         L     @10,GDGNTPTR                                     02S0161
         CLI   GNTENT(@10),4                                    02S0161
         BNE   @RF00161                                         02S0161
@RT00161 DS    0H                                               02S0162
*                     DO;           /* HAVE A NEW BLOCK ASSIGNED
*                                                                    */
*                                                               03S0163
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GNTASCHN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GDG NAME TABLE BLOCK CREATOR                  */
*/*                                                                  */
*/* FUNCTION - TO OBTAIN SPACE FOR AND CHAIN A GDGNT BLOCK           */
*/*                                                                  */
*/*   OPERATION - SWA INTERFACE (IEFAB4F7) IS CALLED TO ASSIGN A     */
*/*               BLOCK IN SWA FOR A NEW GDG NAME TABLE BLOCK.       */
*/*               THE BLOCK IS CHAINED INTO THE EXISTING GDGNT.      */
*/*                                                                  */
*/* ENTRY -  N/A                                                     */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT DATA - N/A                                               */
*/*                                                                  */
*/* EXIT -  N/A                                                      */
*/*                                                                  */
*/*   CONDITION - UPON COMPLETION                                    */
*/*                                                                  */
*/*   OUTPUT DATA - A NEWLY CREATED GDGNT BLOCK                      */
*/*                                                                  */
*/*   RETURN CODE - ZERO                                             */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0163
*                       SWACTLS=ZERO;/* RESET SWA INTERFACE CNTLS    */
         SLR   @10,@10                                          03S0163
         STH   @10,SWACTLS                                      03S0163
*                       SWASN=ASSIGN;/* INDICATE ASSIGN OPERATION    */
*                       SWNEW=CREATEPA;/* INDICATE CREATE AN EPA     */
         OI    SWASN,B'10001000'                                03S0165
*                       SWCHN=CHAINEPA;/* INDICATE CHAIN CREATED EPA */
         OI    SWCHN,B'10000000'                                03S0166
*                       BLOCKID=GDGNTID;/* PLACE GDGNT ID IN PARM
*                                      LIST                          */
         MVI   BLOCKID,X'23'                                    03S0167
*                       CALL IEFAB4F7(SWACTLS,0,HWLEPAP,ADDR(DISKADDR),
*                           ADDR(COREADDR),GDGNTLN,RECORDNM);/* CALL
*                                      SWA INTERFACE TO ASSIGN SPACE
*                                      FOR A GDGNT BLOCK             */
         LA    @10,SWACTLS                                      03S0168
         ST    @10,@AL00001                                     03S0168
         LA    @10,@CF00081                                     03S0168
         ST    @10,@AL00001+4                                   03S0168
         L     @10,@PC00001+4                                   03S0168
         L     @10,HWDATAP(,@10)                                03S0168
         LA    @10,HWLEPAP(,@10)                                03S0168
         ST    @10,@AL00001+8                                   03S0168
         LA    @10,DISKADDR                                     03S0168
         ST    @10,@TF00001                                     03S0168
         LA    @10,@TF00001                                     03S0168
         ST    @10,@AL00001+12                                  03S0168
         LA    @10,COREADDR                                     03S0168
         ST    @10,@TF00002                                     03S0168
         LA    @10,@TF00002                                     03S0168
         ST    @10,@AL00001+16                                  03S0168
         LA    @10,@CF00097                                     03S0168
         ST    @10,@AL00001+20                                  03S0168
         LA    @10,@CF00057                                     03S0168
         ST    @10,@AL00001+24                                  03S0168
         L     @15,@CV00051                                     03S0168
         LA    @01,@AL00001                                     03S0168
         BALR  @14,@15                                          03S0168
*                       IF FGDGNTP=NONE THEN/* IS THIS FIRST GDGNT
*                                      BLOCK?                        */
         SLR   @10,@10                                          03S0169
         L     @03,@PC00001+20                                  03S0169
         C     @10,FGDGNTP(,@03)                                03S0169
         BNE   @RF00169                                         03S0169
*                         DO;       /* IF YES THEN                   */
*                           IF HWEPAJCT=ON THEN/* DOES AN EPA EXIST
*                                      FOR THE JCT ??                */
         L     @03,@PC00001                                     03S0171
         L     @03,HWCNTRLP(,@03)                               03S0171
         TM    HWEPAJCT(@03),B'00010000'                        03S0171
         BNO   @RF00171                                         03S0171
*                             DO;   /* IF NOT THEN GET ONE           */
*                               SWACTLS=ZERO;/* RESET SWA INTERFACE
*                                      CNTLS                         */
         STH   @10,SWACTLS                                      03S0173
*                               SWREAD=READ;/* INDICATE READ    03S0174
*                                      OPERATION                     */
*                               SWNEW=CREATEPA;/* INDICATE CREATE AN
*                                      EPA                           */
         OI    SWREAD,B'00101000'                               03S0175
*                               SWCHN=CHAINEPA;/* INDICATE CHAIN
*                                      CREATED EPA                   */
         OI    SWCHN,B'10000000'                                03S0176
*                               CALL IEFAB4F7(SWACTLS,0,HWLEPAP,ADDR(
*                                   JCTDSKAD),ADDR(DUMYJCTP),JCTLN,
*                                   RECORDNM);/* GO CREATE EPA FOR
*                                      THE JCT                       */
         LA    @10,SWACTLS                                      03S0177
         ST    @10,@AL00001                                     03S0177
         LA    @10,@CF00081                                     03S0177
         ST    @10,@AL00001+4                                   03S0177
         L     @10,@PC00001+4                                   03S0177
         L     @10,HWDATAP(,@10)                                03S0177
         LA    @10,HWLEPAP(,@10)                                03S0177
         ST    @10,@AL00001+8                                   03S0177
         L     @10,@PC00001+24                                  03S0177
         ST    @10,@AL00001+12                                  03S0177
         LA    @10,DUMYJCTP                                     03S0177
         ST    @10,@TF00001                                     03S0177
         LA    @10,@TF00001                                     03S0177
         ST    @10,@AL00001+16                                  03S0177
         LA    @10,@CF00097                                     03S0177
         ST    @10,@AL00001+20                                  03S0177
         LA    @10,@CF00057                                     03S0177
         ST    @10,@AL00001+24                                  03S0177
         L     @15,@CV00051                                     03S0177
         LA    @01,@AL00001                                     03S0177
         BALR  @14,@15                                          03S0177
*                               HWEPAJCT=OFF;/* INDICATE EPA NOW
*                                      EXISTS                        */
         L     @10,@PC00001                                     03S0178
         L     @10,HWCNTRLP(,@10)                               03S0178
         NI    HWEPAJCT(@10),B'11101111'                        03S0178
*                             END;                              03S0179
*                           JCTGDGNT=BLOCKSVA;/* PLACE SVA OF GDGNT
*                                      IN JCT                        */
@RF00171 L     @10,@PC00001+24                                  03S0180
         L     @10,JCTPTR(,@10)                                 03S0180
         MVC   JCTGDGNT(3,@10),BLOCKSVA                         03S0180
*                           FGDGNTP=BLOKSVAB;/* PLACE SVAB IN   03S0181
*                                      CALLER'S PARM                 */
         L     @10,@PC00001+20                                  03S0181
         MVC   FGDGNTP(4,@10),BLOKSVAB                          03S0181
*                         END;                                  03S0182
*                       ELSE        /* OTHERWISE                     */
*                         DO;                                   03S0183
         B     @RC00169                                         03S0183
@RF00169 DS    0H                                               03S0184
*                           GNTNEXTP=BLOCKSVA;/* UPDATE CHAIN   03S0184
*                                      POINTERS IN                   */
         L     @10,GDGNTPTR                                     03S0184
         MVC   GNTNEXTP(3,@10),BLOCKSVA                         03S0184
*                           GNTNEXTR=BLOKSVAB;/* LAST GDGNT BLOCK?   */
         MVC   GNTNEXTR(4,@10),BLOKSVAB                         03S0185
*                         END;                                  03S0186
*                       GDGNTPTR=BLOKSVAB;/* MAKE GDGNT ADDRESSABLE
*                                      FOR UPDATING             03S0187
*                                                                    */
@RC00169 MVC   GDGNTPTR(4),BLOKSVAB                             03S0187
*                     END;                                      02S0188
*                   GNTENT=GNTENT+1;/* NUMBER OF ENTRIES IN BLOCK    */
@RF00161 L     @10,GDGNTPTR                                     02S0189
         LA    @03,1                                            02S0189
         SLR   @15,@15                                          02S0189
         IC    @15,GNTENT(,@10)                                 02S0189
         ALR   @03,@15                                          02S0189
         STC   @03,GNTENT(,@10)                                 02S0189
*                   GNTNAME(GNTENT)=JFCBDSNM(1:35);/* COPY THE DSNAME*/
         LA    @15,39                                           02S0190
         LR    @01,@03                                          02S0190
         MR    @00,@15                                          02S0190
         ST    @01,@TF00001                                     02S0190
         ALR   @01,@10                                          02S0190
         AL    @01,@CF00896                                     02S0190
         L     @03,@PC00001+16                                  02S0190
         L     @03,JFCBPTR(,@03)                                02S0190
         MVC   GNTNAME-8(35,@01),JFCBDSNM(@03)                  02S0190
*                   GNTBASE(GNTENT)=GDGDSNWA(SEARCH-06:SEARCH-03);/*
*                                      AND THE BASE LEVEL TO THE
*                                      GDGNT                         */
         LR    @03,@10                                          02S0191
         AL    @03,@TF00001                                     02S0191
         LA    @01,GDGDSNWA-7(SEARCH)                           02S0191
         MVC   GNTBASE-39(4,@03),0(@01)                         02S0191
*                   HWGDGBSP=ADDR(GNTBASE(GNTENT));/* PLACE THE 02S0192
*                                      ADDRESS OF THE BASE LEVEL IN
*                                      THE HSKPWA                    */
         L     @14,@PC00001+4                                   02S0192
         L     @01,HWDATAP(,@14)                                02S0192
         SLR   @09,@09                                          02S0192
         IC    @09,GNTENT(,@10)                                 02S0192
         MR    @14,@09                                          02S0192
         LA    @10,GNTBASE-39(@15,@10)                          02S0192
         ST    @10,HWGDGBSP(,@01)                               02S0192
*                 END;                                          02S0193
*             END;                                              01S0194
@RF00157 DS    0H                                               01S0195
*           IF HWRTCD=SUCCESS THEN  /* IF NO ERRORS, HAVE JLOCATE    */
@RF00150 SLR   @10,@10                                          01S0195
         L     @15,@PC00001+8                                   01S0195
         L     @01,HWRTNP(,@15)                                 01S0195
         CH    @10,HWRTCD(,@01)                                 01S0195
         BNE   @RF00195                                         01S0195
*             DO;                   /* LOCATE GDG LEVEL SPECIFIED
*                                                                    */
*                                                               02S0197
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RESLVDSN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GDG DSNAME RESOLUTION                         */
*/*                                                                  */
*/* FUNCTION - TO RESOLVE THE DSN AND TO VERIFY THE DSN STATUS       */
*/*                                                                  */
*/*   OPERATION - JLOCATE IS CALLED TO RESOLVE THE DSN. THE STATUS   */
*/*               IS CHECKED TO DETERMINE IF THE SPECIFIED STATUS IS */
*/*               COMPATABLE WITH THE ACTUAL STATUS.                 */
*/*                                                                  */
*/* ENTRY -     N/A                                                  */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT DATA - N/A                                               */
*/*                                                                  */
*/* EXIT -   N/A                                                     */
*/*                                                                  */
*/*   CONDITION - UPON COMPLETION OR IF A JLOCATE ERROR OCCURS       */
*/*                                                                  */
*/*   OUTPUT DATA - REASON CODE 0 - DSN CORRECTLY RESOLVED           */
*/*                 REASON CODE - 54 - INCOMPATABLE STATUS           */
*/*                                                                  */
*/*   RETURN CODE - 0 - SUCCESS                                      */
*/*                 4 - ERROR                                        */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0197
*               JFCBDSNM(HWDSNLN)=LFTPAREN;/* PLACE A LEFT PAREN ON
*                                      THE END OF THE DSN            */
         L     @14,@PC00001+4                                   02S0197
         L     @09,HWDATAP(,@14)                                02S0197
         LH    @08,HWDSNLN(,@09)                                02S0197
         L     @07,@PC00001+16                                  02S0197
         L     @06,JFCBPTR(,@07)                                02S0197
         ST    @08,@TF00001                                     02S0197
         ALR   @08,@06                                          02S0197
         AL    @08,@CF00886                                     02S0197
         MVC   JFCBDSNM(1,@08),LFTPAREN                         02S0197
*               JFCBDSNM(HWDSNLN+1:HWDSNLN+ELNMSZ-1)=JFCBELNM;/*
*                                      APPEND THE GENERATION NUMBER
*                                      TO THE DSN                    */
         LR    @01,@06                                          02S0198
         AL    @01,@TF00001                                     02S0198
         LH    @08,ELNMSZ                                       02S0198
         LR    @05,@08                                          02S0198
         BCTR  @05,0                                            02S0198
         BCTR  @05,0                                            02S0198
         EX    @05,@SM00898                                     02S0198
*               JFCBDSNM(HWDSNLN+ELNMSZ)=RTPAREN;/* PLACE A RIGHT
*                                      PAREN AT THE END OF THE DSN   */
         AL    @08,@TF00001                                     02S0199
         ALR   @06,@08                                          02S0199
         AL    @06,@CF00886                                     02S0199
         MVI   JFCBDSNM(@06),C')'                               02S0199
*               HWJLCTLS=ZERO;      /* RESET JLOCATE CONTROLS        */
         L     @08,@PC00001                                     02S0200
         L     @06,HWCNTRLP(,@08)                               02S0200
         STH   @10,HWJLCTLS(,@06)                               02S0200
*               HWSYSLOC=SYSLOCAT;  /* ISSUE SYSTEM LOCATE           */
*               HWGDGSLC=SPECIAL;   /* GDG BASE LEVEL PROVIDED       */
         OI    HWSYSLOC(@06),B'00100100'                        02S0202
*               HWDOMOD=UPDATE;     /* CHANGE 'MOD' DISPOSITION TO
*                                      'NEW' IF NECESSARY            */
         OI    HWDOMOD(@06),B'10000000'                         02S0203
*               CALL IEFAB469(HWCNTRLP,HWDATAP,HWRTNP,HWCSIOTP,JFCBPTR,
*                   ADDR(JFCBDSNM));/* LOCATE REQUESTED DATA SET     */
         ST    @08,@AL00001                                     02S0204
         ST    @14,@AL00001+4                                   02S0204
         ST    @15,@AL00001+8                                   02S0204
         LA    @10,HWCSIOTP(,@09)                               02S0204
         ST    @10,@AL00001+12                                  02S0204
         ST    @07,@AL00001+16                                  02S0204
         ST    @07,@AL00001+20                                  02S0204
         L     @15,@CV00050                                     02S0204
         LA    @01,@AL00001                                     02S0204
         BALR  @14,@15                                          02S0204
*               IF HWRTCD=SUCCESS THEN/* IF JLOCATE WAS SUCCESSFUL   */
         L     @10,@PC00001+8                                   02S0205
         L     @10,HWRTNP(,@10)                                 02S0205
         ICM   @15,3,HWRTCD(@10)                                02S0205
         BNZ   @RF00205                                         02S0205
*                 DO;               /* AND A NEW DS NAME WAS         */
*                   HWCATSER=CTGCVVOL;/* SAVE CATALOG VOLSER FOR DSCB
*                                      PAT. OBTAIN           @YM04955*/
         L     @10,@PC00001+4                                   02S0207
         L     @10,HWDATAP(,@10)                                02S0207
         L     @15,@PC00001+28                                  02S0207
         L     @15,CTGPLPTR(,@15)                               02S0207
         L     @01,CTGCVOL(,@15)                                02S0207
         MVC   HWCATSER(6,@10),CTGCVVOL(@01)                    02S0207
*                   IF CTGNGDSN=NEWGDG THEN/* CREATED, TURN OFF THE  */
         TM    CTGNGDSN(@15),B'00010000'                        02S0208
         BNO   @RF00208                                         02S0208
*                     HWDSNCAT=NOTINCAT;/* 'DSN-FOUND-IN-CATALOG' BIT*/
         L     @10,@PC00001                                     02S0209
         L     @10,HWCNTRLP(,@10)                               02S0209
         NI    HWDSNCAT(@10),B'11111011'                        02S0209
*                   IF SCTSNEW=ON&(HWDSNCAT=ON×HWRESIOT=ON)×(CTGNGDSN=
*                       ON&HWRESIOT=OFF&SCTSNEW^=ON) THEN/* THE 02S0210
*                                      STATUS SPECIFIED DOES NOT
*                                      MATCH THE                     */
@RF00208 L     @10,@PC00001+12                                  02S0210
         L     @10,SIOTPTR(,@10)                                02S0210
         TM    SCTSNEW(@10),B'00000100'                         02S0210
         BNO   @GL00012                                         02S0210
         L     @10,@PC00001                                     02S0210
         L     @10,HWCNTRLP(,@10)                               02S0210
         TM    HWDSNCAT(@10),B'00001100'                        02S0210
         BNZ   @RT00210                                         02S0210
@GL00012 L     @10,@PC00001+28                                  02S0210
         L     @10,CTGPLPTR(,@10)                               02S0210
         TM    CTGNGDSN(@10),B'00010000'                        02S0210
         BNO   @RF00210                                         02S0210
         L     @10,@PC00001                                     02S0210
         L     @10,HWCNTRLP(,@10)                               02S0210
         TM    HWRESIOT(@10),B'00001000'                        02S0210
         BNZ   @RF00210                                         02S0210
         L     @10,@PC00001+12                                  02S0210
         L     @10,SIOTPTR(,@10)                                02S0210
         TM    SCTSNEW(@10),B'00000100'                         02S0210
         BO    @RF00210                                         02S0210
@RT00210 DS    0H                                               02S0211
*                     DO;           /* REAL STATUS - FAIL THE DD     */
*                       HWRTCD=ERROR;/* SET RETURN CODE=4            */
         L     @10,@PC00001+8                                   02S0212
         L     @10,HWRTNP(,@10)                                 02S0212
         MVC   HWRTCD(2,@10),@CH00065                           02S0212
*                       HWRSNCD=FIFTY4;/* AND REASON CODE 54         */
         MVC   HWRSNCD(2,@10),@CH00089                          02S0213
*                     END;                                      02S0214
*                   ELSE            /* PLUS OR MINUS ZERO REQUEST    */
*                     IF SCTSNEW=ON&/* FOR NEW DATA SET??            */
*                         (JFCBELNM(1)=PLUSSIGN×JFCBELNM(1)=MINUSIGN)&(
*                         JFCBELNM(2:ELNMSZ-1)=CHAR000) THEN    02S0215
         B     @RC00210                                         02S0215
@RF00210 L     @10,@PC00001+12                                  02S0215
         L     @10,SIOTPTR(,@10)                                02S0215
         TM    SCTSNEW(@10),B'00000100'                         02S0215
         BNO   @RF00215                                         02S0215
         L     @10,@PC00001+16                                  02S0215
         L     @10,JFCBPTR(,@10)                                02S0215
         CLI   JFCBELNM(@10),C'+'                               02S0215
         BE    @GL00016                                         02S0215
         CLI   JFCBELNM(@10),C'-'                               02S0215
         BNE   @RF00215                                         02S0215
@GL00016 L     @10,@PC00001+16                                  02S0215
         L     @10,JFCBPTR(,@10)                                02S0215
         LH    @15,ELNMSZ                                       02S0215
         SH    @15,@CH00052                                     02S0215
         EX    @15,@SC00893                                     02S0215
         BNE   @RF00215                                         02S0215
*                       DO;         /* IF YES FAIL STEP              */
*                         HWRTCD=ERROR;/* INCOMPATABLE DISPOSITIONS  */
         L     @10,@PC00001+8                                   02S0217
         L     @10,HWRTNP(,@10)                                 02S0217
         MVC   HWRTCD(2,@10),@CH00065                           02S0217
*                         HWRSNCD=FIFTY4;/* SPECIFIED                */
         MVC   HWRSNCD(2,@10),@CH00089                          02S0218
*                       END;                                    02S0219
*                 END;                                          02S0220
*             END;                                              01S0221
*         END;                                                  01S0222
*     END;                                                      01S0223
*   END IEFAB461                                                01S0224
*                                                               01S0224
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (GDGSPRLG)                                       */
*/*%INCLUDE SYSUT5  (GDGSDCLS)                                       */
*/*%INCLUDE SYSLIB  (IEFZB436)                                       */
*/*%INCLUDE SYSLIB  (IEFZB437)                                       */
*/*%INCLUDE SYSLIB  (IEFZB429)                                       */
*/*%INCLUDE SYSLIB  (IEFASIOT)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGCV)                                       */
*/*%INCLUDE SYSUT5  (GVALPRLG)                                       */
*/*%INCLUDE SYSUT5  (GENNOVAL)                                       */
*/*%INCLUDE SYSUT5  (RDLCPRLG)                                       */
*/*%INCLUDE SYSUT5  (GNTRDLOC)                                       */
*/*%INCLUDE SYSUT5  (SCANPRLG)                                       */
*/*%INCLUDE SYSUT5  (GNTSCAN )                                       */
*/*%INCLUDE SYSUT5  (GNTLPRLG)                                       */
*/*%INCLUDE SYSUT5  (GNTLCUPD)                                       */
*/*%INCLUDE SYSUT5  (ACHNPRLG)                                       */
*/*%INCLUDE SYSUT5  (GNTASCHN)                                       */
*/*%INCLUDE SYSUT5  (RDSNPRLG)                                       */
*/*%INCLUDE SYSUT5  (RESLVDSN)                                       */
*                                                               01S0224
*       ;                                                       01S0224
@EL00001 IC    @02,@OLDKEY                                      01S0224
         L     @13,4(,@13)                                      01S0224
@EF00001 L     @00,@SIZDATD                                     01S0224
         LR    @01,@11                                          01S0224
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
@ER00001 LM    @14,@12,12(@13)                                  01S0224
         BR    @14                                              01S0224
@DATA    DS    0H
@CH00052 DC    H'3'
@CH00065 DC    H'4'
@CH00071 DC    H'8'
@CH00072 DC    H'35'
@CH00259 DC    H'39'
@CH00093 DC    H'52'
@CH00091 DC    H'53'
@CH00089 DC    H'54'
@SC00893 CLC   JFCBELNM+1(0,@10),@CC00108
@SM00898 MVC   JFCBDSNM(0,@01),JFCBELNM(@06)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    8F
@AL00001 DS    7A
@TF00001 DS    F
@TF00002 DS    F
IEFAB461 CSECT
         DS    0F
@CF00081 DC    F'0'
@CF00057 DC    F'1'
@CH00057 EQU   @CF00057+2
@CF00097 DC    F'176'
@CF00896 DC    F'-31'
@CF00886 DC    F'-1'
@DATD    DSECT
         DS    0D
GDGNTPTR DS    A
LASTGNTP DS    A
DUMYJCTP DS    A
ELNMSZ   DS    H
SWACTLS  DS    FL2
         ORG   SWACTLS
SWASN    DS    BL1
SWDEL    EQU   SWACTLS+0
SWREAD   EQU   SWACTLS+0
SWWRT    EQU   SWACTLS+0
SWNEW    EQU   SWACTLS+0
SWFREE   EQU   SWACTLS+0
SWMOD    EQU   SWACTLS+0
SWOLD    EQU   SWACTLS+0
SWCHN    DS    BL1
@NM00001 EQU   SWACTLS+1
         ORG   SWACTLS+2
DISKADDR DS    CL4
         ORG   DISKADDR
BLOCKSVA DS    AL3
BLOCKID  DS    CL1
         ORG   DISKADDR+4
COREADDR DS    CL4
         ORG   COREADDR
BLOKSVAB DS    AL4
         ORG   COREADDR+4
GDGDSNWA DS    CL44
DSNFOUND DS    BL1
GDGBASWA DS    CL4
@OLDKEY  DS    AL1
IEFAB461 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00050 DC    V(IEFAB469)
@CV00051 DC    V(IEFAB4F7)
         DS    0D
@CC00106 DC    C'255'
@CC00108 DC    C'000'
LFTPAREN DC    CL1'('
LEVEL0   DC    CL3'(0)'
IEFAB461 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB461 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
COMPARE  EQU   @02
SEARCH   EQU   @02
HWCNTRL  EQU   0
HWEPAJCT EQU   HWCNTRL+1
HWRESIOT EQU   HWCNTRL+2
HWDSNCAT EQU   HWCNTRL+2
HWTBLCTL EQU   HWCNTRL+6
HWJLCTLS EQU   HWCNTRL+7
HWSYSLOC EQU   HWJLCTLS
HWLBASEL EQU   HWJLCTLS
HWGDGSLC EQU   HWJLCTLS
HWDOMOD  EQU   HWJLCTLS+1
HWDATA   EQU   0
HWLEPAP  EQU   HWDATA+12
HWCSIOTP EQU   HWDATA+44
HWUCLPTR EQU   HWDATA+56
HWGDGBSP EQU   HWDATA+64
HWSTPNBR EQU   HWDATA+172
HWDSNLN  EQU   HWDATA+174
HWCATSER EQU   HWDATA+978
HWUCLST  EQU   0
HWDEV    EQU   0
HWOBYTE  EQU   HWDEV+1
HWCTBYT  EQU   HWDEV+2
HWRETURN EQU   0
HWRTCD   EQU   HWRETURN
HWRSNCD  EQU   HWRETURN+2
GDGNT    EQU   0
GNTNEXTP EQU   GDGNT
GNTNEXTR EQU   GDGNT+4
GNTGRPEN EQU   GDGNT+8
GNTNAME  EQU   GNTGRPEN
GNTBASE  EQU   GNTGRPEN+35
GNTENT   EQU   GDGNT+164
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTBYT1 EQU   INDMSIOT+43
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSNEW  EQU   SCTSBYT3
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
INJMJCT  EQU   0
JCTDSKAD EQU   INJMJCT
JCTJSTAT EQU   INJMJCT+5
INDMCTLG EQU   JCTJSTAT
JCTJBYTE EQU   INJMJCT+7
JCTJMGLV EQU   JCTJBYTE
JCTGDGNT EQU   INJMJCT+28
JCTCCODE EQU   INJMJCT+54
JCTRSW1  EQU   INJMJCT+86
JCTRSW2  EQU   INJMJCT+87
JCTJSB   EQU   INJMJCT+111
JCTSTAT2 EQU   INJMJCT+116
IEFAACTB EQU   0
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGOPTN2 EQU   CTGPL+1
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGOPTN4 EQU   CTGPL+3
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGCVOL  EQU   CTGCAT
CTGDSORG EQU   CTGPL+16
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFBFLG EQU   CTGNEWNM+2
CTGNGDSN EQU   CTGFBFLG
CTGJSCB  EQU   CTGPL+24
CTGCV    EQU   0
CTGCVVOL EQU   CTGCV
CTGCVDSN EQU   CTGCV+6
HWCNTRLP EQU   0
HWDATAP  EQU   0
HWRTNP   EQU   0
SIOTPTR  EQU   0
JFCBPTR  EQU   0
FGDGNTP  EQU   0
JCTPTR   EQU   0
CTGPLPTR EQU   0
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCRSV23 EQU   JFCOPTCD
JFCREORG EQU   JFCRSV23
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBPQTY EQU   JFCUCSEG+44
JFCBCTRI EQU   JFCUCSEG+47
JFCBSQTY EQU   JFCUCSEG+48
JFCBIND3 EQU   JFCBSQTY+2
JFCFLGS1 EQU   JFCUCSEG+51
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JFCBEND  EQU   JFCUCSEG+68
JFCBSPTN EQU   JFCUCSEG+67
JFCBVLCT EQU   JFCUCSEG+66
JFCBDRLH EQU   JFCUCSEG+63
JFCBSBNM EQU   JFCUCSEG+60
JFCBABST EQU   JFCUCSEG+58
JFCBSPNM EQU   JFCUCSEG+55
JFCBDQTY EQU   JFCUCSEG+52
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCRSV43 EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCRSV41 EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCRSV39 EQU   JFCFLGS1
JFCRSV52 EQU   JFCBIND3
JFCRSV51 EQU   JFCBIND3
JFCRSV50 EQU   JFCBIND3
JFCRSV49 EQU   JFCBIND3
JFCRSV48 EQU   JFCBIND3
JFCRSV47 EQU   JFCBIND3
JFCRSV46 EQU   JFCBIND3
JFCBDLET EQU   JFCBIND3
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCRSV28 EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCUCSEG+41
JFCBEXTL EQU   JFCUCSEG+40
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCRSV24 EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00033 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00032 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
CTGCVCC  EQU   CTGCV+50
CTGCVDEV EQU   CTGCVDSN
CTGFIELD EQU   CTGPL+28
CTGPSWD  EQU   CTGJSCB
@NM00055 EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGPAR   EQU   CTGFBFLG
CTGFDBK  EQU   CTGNEWNM
CTGNOFLD EQU   CTGPL+19
CTGTYPE  EQU   CTGPL+18
@NM00054 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGWKA   EQU   CTGPL+12
CTGFVT   EQU   CTGENT
@NM00053 EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGLBASE EQU   CTGOPTN4
CTGAM0   EQU   CTGOPTN3
CTGNUM   EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSUPLT EQU   CTGOPTN3
CTGFUNC  EQU   CTGOPTN3
@NM00052 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGEXT   EQU   CTGOPTN2
CTGGENLD EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
ACTACCNT EQU   IEFAACTB+32
ACTJNFLD EQU   IEFAACTB+31
ACTJTIME EQU   IEFAACTB+28
ACTPRGNM EQU   IEFAACTB+8
@NM00051 EQU   IEFAACTB+7
ACTNEXT  EQU   IEFAACTB+4
ACTIDENT EQU   IEFAACTB+3
ACTDSKAD EQU   IEFAACTB
@NM00050 EQU   INJMJCT+175
JCTVULDP EQU   INJMJCT+172
JCTACODE EQU   INJMJCT+168
JCTPRFMF EQU   INJMJCT+167
JCTTSOID EQU   INJMJCT+160
JCTSSD   EQU   INJMJCT+157
@NM00049 EQU   INJMJCT+156
JCTSRBT  EQU   INJMJCT+152
JCTJMRJD EQU   INJMJCT+149
JCTJMRJT EQU   INJMJCT+146
JCTJMRSS EQU   INJMJCT+143
JCTJMRTL EQU   INJMJCT+140
JCTJMRCL EQU   INJMJCT+139
JCTJMROP EQU   INJMJCT+138
JCTJMRD  EQU   INJMJCT+137
JCTJMR   EQU   INJMJCT+134
JCTCKIDT EQU   INJMJCT+118
JCTCKIDL EQU   INJMJCT+117
@NM00048 EQU   JCTSTAT2
JCTBLP   EQU   JCTSTAT2
JCTPERFM EQU   JCTSTAT2
JCTSWSM  EQU   JCTSTAT2
JCTENDIT EQU   JCTSTAT2
JCTADSPC EQU   JCTSTAT2
JCTSPSYS EQU   JCTSTAT2
@NM00047 EQU   INJMJCT+115
JCTSSTR  EQU   INJMJCT+112
JCTJSBTM EQU   JCTJSB
JCTJSBEX EQU   JCTJSB
JCTJSBAL EQU   JCTJSB
JCTJSBIN EQU   JCTJSB
@NM00046 EQU   JCTJSB
JCTVOLSQ EQU   INJMJCT+110
JCTNRCKP EQU   INJMJCT+108
JCTNTRK  EQU   INJMJCT+107
JCTCKTTR EQU   INJMJCT+104
JCTDEVT  EQU   INJMJCT+100
@NM00045 EQU   INJMJCT+99
JCTSTIOT EQU   INJMJCT+96
JCTSNUMB EQU   INJMJCT+95
JCTQIDNT EQU   INJMJCT+94
JCTEQREG EQU   INJMJCT+92
@NM00044 EQU   INJMJCT+91
JCTDETDA EQU   INJMJCT+88
JCTDSDRA EQU   JCTRSW2
JCTDSOJB EQU   JCTRSW2
JCTDSOCR EQU   JCTRSW2
JCTRESTT EQU   JCTRSW2
JCTNOCKP EQU   JCTRSW2
JCTNORST EQU   JCTRSW2
JCTNARST EQU   JCTRSW2
JCTSYSCK EQU   JCTRSW2
@NM00043 EQU   JCTRSW1
JCTSTEPR EQU   JCTRSW1
JCTCKPTR EQU   JCTRSW1
JCTCKFT  EQU   JCTRSW1
JCTCONTR EQU   JCTRSW1
JCTSTERM EQU   JCTRSW1
JCTWARMS EQU   JCTRSW1
@NM00042 EQU   JCTCCODE+3
JCTJDPOP EQU   JCTCCODE+2
JCTJDPCD EQU   JCTCCODE
@NM00041 EQU   INJMJCT+53
JCTSCT   EQU   INJMJCT+52
JCTSMRBA EQU   INJMJCT+44
@NM00040 EQU   INJMJCT+43
JCTACTAD EQU   INJMJCT+40
@NM00039 EQU   INJMJCT+36
@NM00038 EQU   INJMJCT+35
JCTSDKAD EQU   INJMJCT+32
JCTJCSMF EQU   INJMJCT+31
@NM00037 EQU   INJMJCT+27
JCTPDIP  EQU   INJMJCT+24
JCTJTPTN EQU   INJMJCT+16
JCTJNAME EQU   INJMJCT+8
JCTJPRTY EQU   JCTJBYTE
INCMMGL1 EQU   JCTJMGLV
INCMMGL2 EQU   JCTJMGLV
@NM00036 EQU   JCTJMGLV
INCMALL  EQU   JCTJMGLV
JCTJMGPO EQU   INJMJCT+6
INCMNSET EQU   JCTJSTAT
INCMCAT  EQU   INDMCTLG
INCMSTS  EQU   JCTJSTAT
JCTABEND EQU   JCTJSTAT
@NM00035 EQU   JCTJSTAT
JCTJSTPC EQU   JCTJSTAT
@NM00034 EQU   JCTJSTAT
JCTJBLBS EQU   JCTJSTAT
JCTJSRNO EQU   INJMJCT+4
JCTIDENT EQU   INJMJCT+3
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00031 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCRSV01 EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SJFCBPTR EQU   INDMSIOT+156
SIOTNPTR EQU   INDMSIOT+152
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SCTANAME EQU   INDMSIOT+122
@NM00030 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
SIODDQCR EQU   SIOTBYT2
SIOVDQCR EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00029 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00028 EQU   SIOTALTD
@NM00027 EQU   SIOTALTD
@NM00026 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00025 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00024 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00023 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00022 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
@NM00021 EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
@NM00020 EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
@NM00019 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00018 EQU   SIOTTSTC
@NM00017 EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00016 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00015 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00014 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
@NM00013 EQU   GDGNT+165
GNTID    EQU   GDGNT+3
HWTYPE   EQU   HWCTBYT+1
@NM00012 EQU   HWCTBYT
HWDA     EQU   HWCTBYT
@NM00011 EQU   HWCTBYT
HWTAPE   EQU   HWCTBYT
HW7TRK   EQU   HWOBYTE
HWMBYTE  EQU   HWDEV
HWUCBP   EQU   HWUCLST+8
HWDEVTYP EQU   HWUCLST+4
HWEDTLUV EQU   HWUCLST
HWRSVCHR EQU   HWDATA+984
@NM00010 EQU   HWDATA+958
HWCRI    EQU   HWDATA+220
HWDSNAME EQU   HWDATA+176
HWSTEPNO EQU   HWSTPNBR+1
@NM00009 EQU   HWSTPNBR
HWGETLN  EQU   HWDATA+168
HWGETSPN EQU   HWDATA+164
HWRSVPTR EQU   HWDATA+80
HWDSENQP EQU   HWDATA+76
HWRPDIEP EQU   HWDATA+72
HWLPDIBP EQU   HWDATA+68
HWLEPARP EQU   HWDATA+60
HWGETADD EQU   HWDATA+52
HWCJFCBP EQU   HWDATA+48
HWRSIOTP EQU   HWDATA+40
HWCRIP   EQU   HWDATA+36
HWIOSLTP EQU   HWDATA+32
HWGDGNTP EQU   HWDATA+28
HWPDIP   EQU   HWDATA+24
HWJSCBP  EQU   HWDATA+20
HWGEPACP EQU   HWDATA+16
HWFSIOTP EQU   HWDATA+8
HWSCTP   EQU   HWDATA+4
HWJCTP   EQU   HWDATA
@NM00008 EQU   HWCNTRL+14
HWDDCTR  EQU   HWCNTRL+12
HWDDSTEP EQU   HWCNTRL+10
@NM00007 EQU   HWCNTRL+9
@NM00006 EQU   HWJLCTLS+1
HWVSAME  EQU   HWJLCTLS
HWLOCCAT EQU   HWJLCTLS
@NM00005 EQU   HWJLCTLS
HWPDIEDL EQU   HWJLCTLS
HWPDISCN EQU   HWJLCTLS
@NM00004 EQU   HWTBLCTL
HWCOPYAF EQU   HWTBLCTL
HWTBCOPY EQU   HWTBLCTL
@NM00003 EQU   HWCNTRL+3
HWCATINT EQU   HWCNTRL+3
HWNEWVL  EQU   HWCNTRL+3
HWDDDONE EQU   HWCNTRL+3
HWOVRDN  EQU   HWCNTRL+3
HWVAME   EQU   HWCNTRL+3
HWEDT    EQU   HWCNTRL+3
HWUCB    EQU   HWCNTRL+2
HWOVCAND EQU   HWCNTRL+2
HWGDGALL EQU   HWCNTRL+2
HWDSNRQD EQU   HWCNTRL+2
HWVUREC  EQU   HWCNTRL+2
HWDSNREC EQU   HWCNTRL+2
@NM00002 EQU   HWCNTRL+1
HWDSAUTH EQU   HWCNTRL+1
HWNODSI  EQU   HWCNTRL+1
HWCAJSCB EQU   HWCNTRL+1
HWDENQT  EQU   HWCNTRL+1
HWOFFDEV EQU   HWCNTRL+1
HWNOSCAT EQU   HWCNTRL
HWWVOLS  EQU   HWCNTRL
HWDNCCDD EQU   HWCNTRL
HWUNLCCT EQU   HWCNTRL
HWWAITOK EQU   HWCNTRL
HWMNTCAT EQU   HWCNTRL
HWNOULSP EQU   HWCNTRL
HWDOPDI  EQU   HWCNTRL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00085 EQU   @RC00076
@RF00106 EQU   @RC00091
@RC00101 EQU   @RC00091
@RF00100 EQU   @RC00091
@RC00070 EQU   @EL00001
@RF00116 EQU   @EL00001
@RF00195 EQU   @EL00001
@RF00205 EQU   @EL00001
@RF00215 EQU   @EL00001
@RC00210 EQU   @EL00001
@ENDDATA EQU   *
         END   IEFAB461

         TITLE 'IEFAB428 - BUILD DSAB/TIOT ENTRY                       *
                        '
IEFAB428 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB428  75.268'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(12),0(@01)                              01S0001
         MODESET EXTKEY=SCHED
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*RETCODE = NOERROR;                    /*INITIALIZE RETURN CODE      */
         SLR   RETCODE,RETCODE                                  01S0056
*RFY IEZJSCB BASED(JSCBPTR);                                    01S0057
*TIORBPTR = ADDR(TIOTRB);              /*INITIALIZE TIOT MGR REQ BLK */
         LA    @15,TIOTRB                                       01S0058
         ST    @15,TIORBPTR                                     01S0058
*SUBPL = JSCBSWSP;                     /*SUBPOOL FOR DSAB            */
         L     @15,@PC00001+4                                   01S0059
         L     @01,JSCBPTR(,@15)                                01S0059
         SLR   @00,@00                                          01S0059
         IC    @00,JSCBSWSP(,@01)                               01S0059
         ST    @00,SUBPL                                        01S0059
*GRIDSW = ON;                          /*INITIALIZE ID LIST SW       */
         OI    GRIDSW,B'10000000'                               01S0060
*GOTGRSW = OFF;                        /* GRID LIST NOT YET GOTTEN   */
         NI    GOTGRSW,B'01111111'                              01S0061
*IF EREQBLD = ON THEN                  /*BUILD NEW DSAB/TIOT ENTRY?  */
         L     @01,@PC00001                                     01S0062
         L     @01,EREQPTR(,@01)                                01S0062
         TM    EREQBLD(@01),B'10000000'                         01S0062
         BNO   @RF00062                                         01S0062
*  DO;                                 /*YES:                        */
*    GETLEN = DSABLENG;                /*LENGTH OF DSAB              */
         L     @10,DSABLENG                                     01S0064
         ST    @10,GETLEN                                       01S0064
*     /* ?GETSTORG (SUBPL,GETLEN,DSABPTR);*/                    01S0065
*       /* DEFINITIONS OF GETMAIN PARMS */                      01S0065
*       DCL                                                     01S0065
*         GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/           01S0065
*         GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/           01S0065
*         GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/           01S0065
*         GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/           01S0065
*         GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */           01S0065
*       DCL                                                     01S0066
*         GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/           01S0066
*         GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/           01S0066
*         GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/           01S0066
*         GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/           01S0066
*         GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/           01S0066
*         GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/           01S0066
*         GTSTZERO FIXED(31) INIT(0),                           01S0066
*         GTST253  FIXED(31) CONSTANT(253);                     01S0066
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           01S0067
*       GTSTR0 = GETLEN; /* SET AMOUNT*/                        01S0068
         LR    GTSTR0,@10                                       01S0068
*       GTSTR2 = SUBPL; /* SET SUBPOOL*/                        01S0069
         L     @10,SUBPL                                        01S0069
         LR    GTSTR2,@10                                       01S0069
*       GENERATE CODE;                                          01S0070
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           01S0071
         ST    GTSTR15,GTSTRTCD                                 01S0071
*       DSABPTR = GTSTR1; /* ADDR OF GOTN STORG*/               01S0072
         ST    GTSTR1,DSABPTR                                   01S0072
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            01S0073
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           01S0074
         L     @10,GTSTRTCD                                     01S0074
         LTR   @10,@10                                          01S0074
         BNZ   @RF00074                                         01S0074
*         DO;               /* YES, CLEAR STORAGE.*/            01S0075
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   01S0076
*                              GTSTR7,GTSTR8) RSTD;             01S0076
*           GTSTR4 = DSABPTR; /*STORG PTR*/                     01S0077
         L     @10,DSABPTR                                      01S0077
         LR    GTSTR4,@10                                       01S0077
*           GTSTR5 = GETLEN; /*STORG AMNT*/                     01S0078
         L     GTSTR5,GETLEN                                    01S0078
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           01S0079
         SLR   GTSTR7,GTSTR7                                    01S0079
*           IF SUBPL = GTST253 THEN                             01S0080
         CLC   SUBPL(4),@CF01288                                01S0080
         BNE   @RF00080                                         01S0080
*          GEN                                                  01S0081
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       01S0081
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*           GEN REFS(GTSTR4,GTSTR6);                            01S0082
@RF00080 DS    0H                                               01S0082
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*           IF SUBPL = GTST253 THEN                             01S0083
         CLC   SUBPL(4),@CF01288                                01S0083
         BNE   @RF00083                                         01S0083
*             GEN (MODESET KEYADDR=(2));                        01S0084
         MODESET KEYADDR=(2)
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   01S0085
*                              GTSTR7,GTSTR8) UNRSTD;           01S0085
@RF00083 DS    0H                                               01S0086
*         END;       /* STORAGE CLEARING COMPLETED */           01S0086
*       ELSE                                                    01S0087
*       DSABPTR= 0;   /* CLEAR RETURN ADDR. */                  01S0087
         B     @RC00074                                         01S0087
@RF00074 SLR   @10,@10                                          01S0087
         ST    @10,DSABPTR                                      01S0087
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           01S0088
@RC00074 L     GTSTR15,GTSTRTCD                                 01S0088
*                                      /* RESTORE LIST PRINT STATUS  */
* /*GET CORE FOR DSAB           */                              01S0089
*    RETCODE=REG15;                    /*SAVE RETURN CODE            */
         LR    RETCODE,REG15                                    01S0089
*    RFY (REG15) RSTD;                                          01S0090
*    IF RETCODE = NOERROR THEN         /*GETMAIN SUCCESSFUL?         */
         SLR   @14,@14                                          01S0091
         CR    RETCODE,@14                                      01S0091
         BNE   @RF00091                                         01S0091
*      DO;                             /*YES,GET CORE FOR ID LIST    */
*        IF EREQGRID ^= ZERO THEN      /*GROUP ID SUPPLIED?          */
         L     @09,@PC00001                                     01S0093
         L     @09,EREQPTR(,@09)                                01S0093
         C     @14,EREQGRID(,@09)                               01S0093
         BE    @RF00093                                         01S0093
*          DO;                         /*YES,GET CORE FOR ID LIST    */
*            GETLEN=HDRLEN+(GRIDLEN*EREQDEVS); /*LENGTH OF ID LIST   */
         L     @14,GRIDLEN                                      01S0095
         MH    @14,EREQDEVS(,@09)                               01S0095
         AL    @14,HDRLEN                                       01S0095
         ST    @14,GETLEN                                       01S0095
*             /* ?GETSTORG (SUBPL,GETLEN,DSABGIDP);*/           01S0096
*               RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/   01S0096
*               GTSTR0 = GETLEN; /* SET AMOUNT*/                01S0097
         LR    GTSTR0,@14                                       01S0097
*               GTSTR2 = SUBPL; /* SET SUBPOOL*/                01S0098
         L     GTSTR2,SUBPL                                     01S0098
*               GENERATE CODE;                                  01S0099
                 GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*               GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/   01S0100
         ST    GTSTR15,GTSTRTCD                                 01S0100
*               DSABGIDP = GTSTR1; /* ADDR OF GOTN STORG*/      01S0101
         L     @14,DSABPTR                                      01S0101
         ST    GTSTR1,DSABGIDP(,@14)                            01S0101
*               RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */    01S0102
*               IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */   01S0103
         L     @14,GTSTRTCD                                     01S0103
         LTR   @14,@14                                          01S0103
         BNZ   @RF00103                                         01S0103
*                 DO;               /* YES, CLEAR STORAGE.*/    01S0104
*                   RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,           01S0105
*                                      GTSTR7,GTSTR8) RSTD;     01S0105
*                   GTSTR4 = DSABGIDP; /*STORG PTR*/            01S0106
         L     @14,DSABPTR                                      01S0106
         L     @14,DSABGIDP(,@14)                               01S0106
         LR    GTSTR4,@14                                       01S0106
*                   GTSTR5 = GETLEN; /*STORG AMNT*/             01S0107
         L     GTSTR5,GETLEN                                    01S0107
*                   GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/   01S0108
         SLR   GTSTR7,GTSTR7                                    01S0108
*                   IF SUBPL = GTST253 THEN                     01S0109
         CLC   SUBPL(4),@CF01288                                01S0109
         BNE   @RF00109                                         01S0109
*                  GEN                                          01S0110
*               (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*                   GEN REFS(GTSTR4,GTSTR6);                    01S0111
@RF00109 DS    0H                                               01S0111
                      MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*                   IF SUBPL = GTST253 THEN                     01S0112
         CLC   SUBPL(4),@CF01288                                01S0112
         BNE   @RF00112                                         01S0112
*                     GEN (MODESET KEYADDR=(2));                01S0113
         MODESET KEYADDR=(2)
*                   RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,           01S0114
*                                      GTSTR7,GTSTR8) UNRSTD;   01S0114
@RF00112 DS    0H                                               01S0115
*                 END;       /* STORAGE CLEARING COMPLETED */   01S0115
*               ELSE                                            01S0116
*               DSABGIDP= 0;   /* CLEAR RETURN ADDR. */         01S0116
         B     @RC00103                                         01S0116
@RF00103 L     @14,DSABPTR                                      01S0116
         SLR   @10,@10                                          01S0116
         ST    @10,DSABGIDP(,@14)                               01S0116
*               GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */   01S0117
@RC00103 L     GTSTR15,GTSTRTCD                                 01S0117
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET CORE FOR LST    */                                       01S0118
*            RETCODE=REG15;            /*SAVE RETURN CODE            */
         LR    RETCODE,REG15                                    01S0118
*            IF RETCODE = ZERO THEN    /* GETMAIN OK                 */
         LTR   RETCODE,RETCODE                                  01S0119
         BNZ   @RF00119                                         01S0119
*              GOTGRSW = ON;           /* GRID LIST GOTTEN OK        */
         OI    GOTGRSW,B'10000000'                              01S0120
*            ELSE                      /* GETMAIN FAILED             */
*              EREQCODE = GETMERR;     /* RETURN GETMAIN RESN CODE   */
         B     @RC00119                                         01S0121
@RF00119 L     @14,@PC00001                                     01S0121
         L     @14,EREQPTR(,@14)                                01S0121
         MVC   EREQCODE(2,@14),@CH00094                         01S0121
*          END;                                                 01S0122
*        ELSE                          /*NO GROUP ID LIST NEEDED     */
*           GRIDSW = OFF;              /*RESET GROUP ID LIST SWITCH  */
         B     @RC00093                                         01S0123
@RF00093 NI    GRIDSW,B'01111111'                               01S0123
*        IF RETCODE=NOERROR × GRIDSW=OFF THEN /*GETMAIN OK OR   01S0124
*                                        NO ID LIST                  */
@RC00093 LTR   RETCODE,RETCODE                                  01S0124
         BZ    @RT00124                                         01S0124
         TM    GRIDSW,B'10000000'                               01S0124
         BNZ   @RF00124                                         01S0124
@RT00124 DS    0H                                               01S0125
*          DO;                         /*YES,GET CORE FOR DSABANMI   */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UPDTDSAB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UPDATE DSAB ALTERNATE NAME FIELDS             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   CALCULATE THE LENGTH OF THE ALTERNATE DSNAME FOR GENERATED     */
*/*   OR GDG DATA SET REQUESTS. GET CORE FOR THE LENGTH AND NAME     */
*/*   FIELDS. SET A POINTER TO THAT CORE AND STORE  THE LENGTH AND   */
*/*   NAME IN THOSE FIELDS.                                          */
*/*                                                                  */
*/*   OPERATION - SCAN THE NAME FIELD IN  EACH CASE FROM RIGHT TO    */
*/*     LEFT FOR FIRST NON-BLANK. CALCULATE THE # OF CHARACTERS      */
*/*     REMAINING. FOR A GENERATED DATA SET NAME, SIOTGDSN = ON AND  */
*/*     THE NAME IS IN THE FIELD SCTANAME (IN SIOT).                 */
*/*     IF IT IS A MEMBER OF A GDG SINGLE OR GDG ALL REQUEST, THE    */
*/*     SAME TECHNIQUE IS USED,ONLY THE  DATASET NAME IS FOUND IN    */
*/*     THE JFCB FIELD: JFCBDSNM, AND SIOTGALL OR SCTSGDGS WILL BE ON*/
*/*                                                                  */
*/*                                                                  */
*/* ENTRY POINT - UPDTDSAB (INCLUDED SEGMENT)                        */
*/*                                                                  */
*/*   PURPOSE  (SEE FUNCTION)                                        */
*/*                                                                  */
*/*   INPUT - POINTER TO DSAB                                       */
*/*                                                                  */
*/* EXIT - INLINE                                                    */
*/*   CONDITION - DATASET NAME WAS GDG OR GENERATED.                 */
*/*                                                                  */
*/*   OUTPUT-     ALTERNATE DSNAME AND DSNAME LENGTH DETERMINED      */
*/*               AND STORED AT DSABANAM & DSABANML RESPECTIVELY.    */
*/*               DSABANMP IS SET BY THE GETMAIN ROUTINE AND POINTS  */
*/*               TO DSABANML.                                       */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/*   CONDITION - DATASET NAME WAS NOT GDG OR GENERATED.             */
*/*                                                                  */
*/*   OUTPUT    - DSABANMP SET TO ZERO                               */
*/*                                                                  */
*/*   RETURN CODE-NONE                                               */
*/*                                                                  */
*/*   CONDITION - GETMAIN ERROR OCCURRED                             */
*/*                                                                  */
*/*   OUTPUT - IEFAB428 MUST FREE DSAB AND GRID IF THEY EXIST        */
*/*                                                                  */
*/*   RETURN CODES - RETCODE = 4         ERROR RETURN CODE           */
*/*                  EREQCODE= 2           ERROR REASON CODE         */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*SIOTPTR = EREQSIOT;                   /* POINT TO SIOT              */
         L     @14,@PC00001                                     02S0126
         L     @14,EREQPTR(,@14)                                02S0126
         L     @14,EREQSIOT(,@14)                               02S0126
         ST    @14,SIOTPTR                                      02S0126
*JFCBPTR = SJFCBPTR;                   /* PTR TO JFCB                */
         MVC   JFCBPTR(4),SJFCBPTR(@14)                         02S0127
*GMRETCOD = ZERO;                      /* INITIALIZE INTERNAL RETCODE*/
         SLR   GMRETCOD,GMRETCOD                                02S0128
*DSBNAMSW = OFF;                       /*INIT GETMAIN CHECK SWITCH   */
         NI    DSBNAMSW,B'01111111'                             02S0129
*IF   SIOTGDSN = ON & SCTANAME^= BLANKS8   THEN /* IF DSNAM IS GEN'D */
         TM    SIOTGDSN(@14),B'00010000'                        02S0130
         BNO   @RF00130                                         02S0130
         CLC   SCTANAME(8,@14),BLANKS8                          02S0130
         BE    @RF00130                                         02S0130
* DO;                                  /*AND TEMP NAME FIELD NOT BLNK*/
*    ENDPTR = ADDR(SCTANAME)+ SEVEN;   /*POINT TO END OF NAME FIELD  */
         LA    ENDPTR,SCTANAME(,@14)                            02S0132
         AH    ENDPTR,@CH00578                                  02S0132
*    DO WHILE LASTCHAR = BLANK;        /*FIND LAST CHAR OF NAME      */
         B     @DE00133                                         02S0133
@DL00133 DS    0H                                               02S0134
*      ENDPTR = ENDPTR - ONE;          /*POINT TO LAST BYTE          */
         BCTR  ENDPTR,0                                         02S0134
*    END;                                                       02S0135
@DE00133 CLC   LASTCHAR(1,ENDPTR),BLANK                         02S0135
         BE    @DL00133                                         02S0135
*    CORBYTES = ENDPTR - ADDR(SCTANAME) + THREE;  /* AMOUNT OF CORE
*                                      FOR ALT DSNAM & LNTH FIELD    */
         L     @14,SIOTPTR                                      02S0136
         LA    @14,SCTANAME(,@14)                               02S0136
         LCR   @14,@14                                          02S0136
         ALR   @14,ENDPTR                                       02S0136
         AH    @14,@CH00071                                     02S0136
         ST    @14,CORBYTES                                     02S0136
*     /* ?GETSTORG (SUBPL,CORBYTES,DSABANMP);*/                 02S0137
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           02S0137
*       GTSTR0 = CORBYTES; /* SET AMOUNT*/                      02S0138
         LR    GTSTR0,@14                                       02S0138
*       GTSTR2 = SUBPL; /* SET SUBPOOL*/                        02S0139
         L     GTSTR2,SUBPL                                     02S0139
*       GENERATE CODE;                                          02S0140
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           02S0141
         ST    GTSTR15,GTSTRTCD                                 02S0141
*       DSABANMP = GTSTR1; /* ADDR OF GOTN STORG*/              02S0142
         L     @14,DSABPTR                                      02S0142
         ST    GTSTR1,DSABANMP(,@14)                            02S0142
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            02S0143
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           02S0144
         L     @14,GTSTRTCD                                     02S0144
         LTR   @14,@14                                          02S0144
         BNZ   @RF00144                                         02S0144
*         DO;               /* YES, CLEAR STORAGE.*/            02S0145
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0146
*                              GTSTR7,GTSTR8) RSTD;             02S0146
*           GTSTR4 = DSABANMP; /*STORG PTR*/                    02S0147
         L     @14,DSABPTR                                      02S0147
         L     @14,DSABANMP(,@14)                               02S0147
         LR    GTSTR4,@14                                       02S0147
*           GTSTR5 = CORBYTES; /*STORG AMNT*/                   02S0148
         L     GTSTR5,CORBYTES                                  02S0148
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           02S0149
         SLR   GTSTR7,GTSTR7                                    02S0149
*           IF SUBPL = GTST253 THEN                             02S0150
         CLC   SUBPL(4),@CF01288                                02S0150
         BNE   @RF00150                                         02S0150
*          GEN                                                  02S0151
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       02S0151
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*           GEN REFS(GTSTR4,GTSTR6);                            02S0152
@RF00150 DS    0H                                               02S0152
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*           IF SUBPL = GTST253 THEN                             02S0153
         CLC   SUBPL(4),@CF01288                                02S0153
         BNE   @RF00153                                         02S0153
*             GEN (MODESET KEYADDR=(2));                        02S0154
         MODESET KEYADDR=(2)
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0155
*                              GTSTR7,GTSTR8) UNRSTD;           02S0155
@RF00153 DS    0H                                               02S0156
*         END;       /* STORAGE CLEARING COMPLETED */           02S0156
*       ELSE                                                    02S0157
*       DSABANMP= 0;   /* CLEAR RETURN ADDR. */                 02S0157
         B     @RC00144                                         02S0157
@RF00144 L     @14,DSABPTR                                      02S0157
         SLR   @09,@09                                          02S0157
         ST    @09,DSABANMP(,@14)                               02S0157
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           02S0158
@RC00144 L     GTSTR15,GTSTRTCD                                 02S0158
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET CORE                  */                                 02S0159
*    GMRETCOD = REG15;                 /*SAVE RETURN CODE            */
         LR    GMRETCOD,REG15                                   02S0159
*    IF GMRETCOD = ZERO THEN           /*NO ERROR, CONTINUE          */
         LTR   GMRETCOD,GMRETCOD                                02S0160
         BNZ   @RF00160                                         02S0160
*      DO;                                                      02S0161
*        DSBNAMSW = ON;                /*INDICATE CORE OBTAINED      */
         OI    DSBNAMSW,B'10000000'                             02S0162
*        DSABANML = CORBYTES - ONE;    /*LENGTH OF ALTERNATE DSNAME  */
         L     @14,DSABPTR                                      02S0163
         L     @14,DSABANMP(,@14)                               02S0163
         L     @03,CORBYTES                                     02S0163
         BCTR  @03,0                                            02S0163
         STC   @03,DSABANML(,@14)                               02S0163
*        DSABANAM(1) = AMPRSAND;       /*HI-ORDER & TO INDICATE TEMP */
         MVC   DSABANAM(1,@14),AMPRSAND                         02S0164
*        DSABANAM(2:DSABANML)=SCTANAME(1:(DSABANML-1)); /*FILL IN    */
         BCTR  @03,0                                            02S0165
         BCTR  @03,0                                            02S0165
         L     @01,SIOTPTR                                      02S0165
         EX    @03,@SM01293                                     02S0165
*      END;                            /*NAME FROM SCTANAME          */
*    ELSE;                             /*GETMAIN ERROR               */
@RF00160 DS    0H                                               02S0168
*  END;                                                         02S0168
*ELSE                                  /*NOT GENERATED DS NAME       */
*  IF  SIOTGALL =ON  ×  SCTSGDGS=ON  THEN /*MEMBER OF GDGALL GROUP   */
         B     @RC00130                                         02S0169
@RF00130 L     @14,SIOTPTR                                      02S0169
         TM    SIOTGALL(@14),B'00100000'                        02S0169
         BO    @RT00169                                         02S0169
         TM    SCTSGDGS(@14),B'10000000'                        02S0169
         BNO   @RF00169                                         02S0169
@RT00169 DS    0H                                               02S0170
*                                      /* OR GDGSINGLE               */
*    DO;                                                        02S0170
*      ENDPTR = ADDR(JFCBDSNM) + FORTY#3; /*PT TO END OF NAME FIELD  */
         LA    ENDPTR,43                                        02S0171
         AL    ENDPTR,JFCBPTR                                   02S0171
*      DO WHILE LASTCHAR = BLANK;      /*FIND LAST CHAR OF NAME      */
         B     @DE00172                                         02S0172
@DL00172 DS    0H                                               02S0173
*        ENDPTR = ENDPTR - ONE;        /*POINT TO NEXT BYTE          */
         BCTR  ENDPTR,0                                         02S0173
*      END;                                                     02S0174
@DE00172 CLC   LASTCHAR(1,ENDPTR),BLANK                         02S0174
         BE    @DL00172                                         02S0174
*      CORBYTES = ENDPTR - ADDR(JFCBDSNM) - SEVEN;   /* LENGTH OF
*                            CORE NEEDED FOR NAM FLD & LNTH FLD      */
         LR    @14,ENDPTR                                       02S0175
         SL    @14,JFCBPTR                                      02S0175
         SH    @14,@CH00578                                     02S0175
         ST    @14,CORBYTES                                     02S0175
*       /* ?GETSTORG (SUBPL,CORBYTES,DSABANMP);*/               02S0176
*         RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/         02S0176
*         GTSTR0 = CORBYTES; /* SET AMOUNT*/                    02S0177
         LR    GTSTR0,@14                                       02S0177
*         GTSTR2 = SUBPL; /* SET SUBPOOL*/                      02S0178
         L     GTSTR2,SUBPL                                     02S0178
*         GENERATE CODE;                                        02S0179
           GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*         GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/         02S0180
         ST    GTSTR15,GTSTRTCD                                 02S0180
*         DSABANMP = GTSTR1; /* ADDR OF GOTN STORG*/            02S0181
         L     @14,DSABPTR                                      02S0181
         ST    GTSTR1,DSABANMP(,@14)                            02S0181
*         RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */          02S0182
*         IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */         02S0183
         L     @14,GTSTRTCD                                     02S0183
         LTR   @14,@14                                          02S0183
         BNZ   @RF00183                                         02S0183
*           DO;               /* YES, CLEAR STORAGE.*/          02S0184
*             RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                 02S0185
*                                GTSTR7,GTSTR8) RSTD;           02S0185
*             GTSTR4 = DSABANMP; /*STORG PTR*/                  02S0186
         L     @14,DSABPTR                                      02S0186
         L     @14,DSABANMP(,@14)                               02S0186
         LR    GTSTR4,@14                                       02S0186
*             GTSTR5 = CORBYTES; /*STORG AMNT*/                 02S0187
         L     GTSTR5,CORBYTES                                  02S0187
*             GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/         02S0188
         SLR   GTSTR7,GTSTR7                                    02S0188
*             IF SUBPL = GTST253 THEN                           02S0189
         CLC   SUBPL(4),@CF01288                                02S0189
         BNE   @RF00189                                         02S0189
*            GEN                                                02S0190
*         (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);     02S0190
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*             GEN REFS(GTSTR4,GTSTR6);                          02S0191
@RF00189 DS    0H                                               02S0191
                MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*             IF SUBPL = GTST253 THEN                           02S0192
         CLC   SUBPL(4),@CF01288                                02S0192
         BNE   @RF00192                                         02S0192
*               GEN (MODESET KEYADDR=(2));                      02S0193
         MODESET KEYADDR=(2)
*             RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                 02S0194
*                                GTSTR7,GTSTR8) UNRSTD;         02S0194
@RF00192 DS    0H                                               02S0195
*           END;       /* STORAGE CLEARING COMPLETED */         02S0195
*         ELSE                                                  02S0196
*         DSABANMP= 0;   /* CLEAR RETURN ADDR. */               02S0196
         B     @RC00183                                         02S0196
@RF00183 L     @14,DSABPTR                                      02S0196
         SLR   @09,@09                                          02S0196
         ST    @09,DSABANMP(,@14)                               02S0196
*         GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */         02S0197
@RC00183 L     GTSTR15,GTSTRTCD                                 02S0197
*                                      /* RESTORE LIST PRINT STATUS  */
*/* GET CORE               */                                   02S0198
*      GMRETCOD = REG15;               /*SAVE RETURN CODE            */
         LR    GMRETCOD,REG15                                   02S0198
*      IF GMRETCOD = ZERO THEN         /* NO ERROR,CONTINUE          */
         LTR   GMRETCOD,GMRETCOD                                02S0199
         BNZ   @RF00199                                         02S0199
*        DO;                                                    02S0200
*          DSBNAMSW = ON;              /*INDICATE CORE OBTAINED      */
         OI    DSBNAMSW,B'10000000'                             02S0201
*          DSABANML = CORBYTES - ONE;  /*LENGTH OF DSNAME W/O VERSION*/
         L     @14,DSABPTR                                      02S0202
         L     @14,DSABANMP(,@14)                               02S0202
         L     @03,CORBYTES                                     02S0202
         BCTR  @03,0                                            02S0202
         STC   @03,DSABANML(,@14)                               02S0202
*                                      /*AND GENERATION NUMBERS      */
*          DSABANAM(1:DSABANML)=                                02S0203
*                     JFCBDSNM(1:DSABANML); /*ALTERNATE DSNAME       */
         BCTR  @03,0                                            02S0203
         L     @01,JFCBPTR                                      02S0203
         EX    @03,@SM01295                                     02S0203
*        END;                                                   02S0204
*      ELSE;                           /* NOT MEMBER OF GDG ALL GROUP*/
@RF00199 DS    0H                                               02S0206
*    END;                                                       02S0206
*  ELSE                                                         02S0207
*    DSABANMP = ZERO;                  /*NOT GDG OR TEMP DSN         */
         B     @RC00169                                         02S0207
@RF00169 L     @14,DSABPTR                                      02S0207
         SLR   @03,@03                                          02S0207
         ST    @03,DSABANMP(,@14)                               02S0207
*IF GMRETCOD ^= ZERO THEN              /*SET ERROR CODES             */
@RC00169 DS    0H                                               02S0208
@RC00130 LTR   GMRETCOD,GMRETCOD                                02S0208
         BZ    @RF00208                                         02S0208
*  DO;                                                          02S0209
*    RETCODE = ERROR;                  /*SET ERROR RETURN CODE       */
         LA    RETCODE,4                                        02S0210
*    EREQCODE = GETMERR;               /* SET ERROR REASON CODE      */
         L     @14,@PC00001                                     02S0211
         L     @14,EREQPTR(,@14)                                02S0211
         MVC   EREQCODE(2,@14),@CH00094                         02S0211
*  END;                                                         02S0212
*ELSE                                  /*NO ERRORS                   */
*  CALL IEFAB4E9(DSABPTR,SJFCBPTR);    /*INVOKE 'SET DCB MASK'       */
         B     @RC00208                                         02S0213
@RF00208 LA    @14,DSABPTR                                      02S0213
         ST    @14,@AL00001                                     02S0213
         L     @14,SIOTPTR                                      02S0213
         LA    @14,SJFCBPTR(,@14)                               02S0213
         ST    @14,@AL00001+4                                   02S0213
         L     @15,@CV01260                                     02S0213
         LA    @01,@AL00001                                     02S0213
         BALR  @14,@15                                          02S0213
*            IF RETCODE = ZERO THEN    /*ANY GETMAIN ERRORS?         */
@RC00208 LTR   RETCODE,RETCODE                                  01S0214
         BNZ   @RF00214                                         01S0214
*              DO;                                              01S0215
*                RFY (REG15) UNRSTD;                            01S0216
*                TIOMGRRB=TIOMGRRB&&TIOMGRRB; /*CLEAR REQUEST BLOCK  */
         L     @15,TIORBPTR                                     01S0217
         XC    TIOMGRRB(38,@15),TIOMGRRB(@15)                   01S0217
*                TIOMALOC = ON;        /*INDICATE ALLOCATE ENTRY FUNC*/
         OI    TIOMALOC(@15),B'00100000'                        01S0218
*                TIOMJSCP = JSCBPTR;   /*SUPPLY JSCB ADDRESS         */
         L     @14,@PC00001+4                                   01S0219
         MVC   TIOMJSCP(4,@15),JSCBPTR(@14)                     01S0219
*                TIOMRETP = ADDR(DSABTIOT); /*AREA FOR TIOT ENT ADDR */
         L     @01,DSABPTR                                      01S0220
         LA    @14,DSABTIOT(,@01)                               01S0220
         ST    @14,TIOMRETP(,@15)                               01S0220
*                TIOMELEN=ETIOBASE+(DEVENTLN*EREQDEVS); /*ENTRY LENTH*/
         L     @14,@PC00001                                     01S0221
         L     @01,EREQPTR(,@14)                                01S0221
         L     @14,DEVENTLN                                     01S0221
         MH    @14,EREQDEVS(,@01)                               01S0221
         AH    @14,@CH00051                                     01S0221
         STH   @14,TIOMELEN(,@15)                               01S0221
*                CALL IEFAB4FC(TIORBPTR); /*GET SLOT FOR TIO DD ENTRY*/
         LA    @15,TIORBPTR                                     01S0222
         ST    @15,@AL00001                                     01S0222
         L     @15,@CV01261                                     01S0222
         LA    @01,@AL00001                                     01S0222
         BALR  @14,@15                                          01S0222
*                RETCODE = REG15;      /* SAVE RETURN CODE           */
         LR    RETCODE,REG15                                    01S0223
*                IF RETCODE = NOERROR THEN /*TIOT MANAGER ERROR?     */
         LTR   RETCODE,RETCODE                                  01S0224
         BNZ   @RF00224                                         01S0224
*                  DO;                 /*NO:                         */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ETBSETUP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SET UP ETIOT ENTRY                            */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT INITIALIZES A GROUP ID LIST, A DSAB, AND A TIOT   */
*/*   DD ENTRY. THESE DATA AREAS ARE INITIALIZED ACCORDING TO THE    */
*/*   INFORMATION SPECIFIED IN THE CALLER'S REQUEST BLOCK. WHEN      */
*/*   THE AREAS HAVE BEEN INITIALIZED, POINTERS TO THE DSAB IN THE   */
*/*   SIOT AND QDB ARE SET.                                          */
*/*                                                                  */
*/*   IF THE FIRST DSAB IS BEING INITIALIZED, THE BACKWARD DSAB      */
*/*   POINTER DEFAULTS TO ZERO.                                      */
*/*                                                                  */
*/* ENTRY -                                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     ADDRESSES OF THE GROUP ID LIST, DSAB, AND TIOT DD ENTRY      */
*/*     CALLER'S REQUEST BLOCK                                       */
*/*                                                                  */
*/* EXIT -                                                           */
*/*                                                                  */
*/*   CONDITION - GROUP ID LIST, DSAB, AND TIOT DD ENTRY INITIALIZED */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     GROUP ID LIST,DSAB,AND TIOT DD ENTRY INITIALIZED AND CHAINED */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*       INITIALIZE GROUP ID LIST                                   */
*/********************************************************************/
*IF GRIDSW = ON THEN                   /*DOES GROUP ID LIST EXIST?   */
         TM    GRIDSW,B'10000000'                               02S0226
         BNO   @RF00226                                         02S0226
*  DO;                                 /*YES,INITIALIZE IT           */
*    DSABLLEN = GETLEN;                /*LENGTH OF GROUP ID LIST     */
         L     @01,DSABPTR                                      02S0228
         L     @15,DSABGIDP(,@01)                               02S0228
         MVC   DSABLLEN(4,@15),GETLEN                           02S0228
*    DSABGRID(EREQRPOS) = EREQGRID;    /*GROUP ID                    */
         L     @14,@PC00001                                     02S0229
         L     @14,EREQPTR(,@14)                                02S0229
         LH    @09,EREQRPOS(,@14)                               02S0229
         SLA   @09,2                                            02S0229
         L     @14,EREQGRID(,@14)                               02S0229
         ST    @14,DSABGRID-4(@09,@15)                          02S0229
*  END;                                                         02S0230
*/********************************************************************/
*/*       INITIALIZE AND CHAIN DSAB                                  */
*/********************************************************************/
*DSABID = DSABCHAR;                    /*DSAB ID                     */
@RF00226 L     @03,DSABPTR                                      02S0231
         MVC   DSABID(4,@03),@CC01243                           02S0231
*QDBPTR = JSCDSABQ;                    /*INITIALIZE QDB POINTER      */
         L     @15,@PC00001+4                                   02S0232
         L     @01,JSCBPTR(,@15)                                02S0232
         L     QDBPTR,JSCDSABQ(,@01)                            02S0232
*IF EXITPRMP ^= ZERO THEN              /* ESTAE PARMS EXIST?         */
         L     @03,@PC00001+8                                   02S0233
         L     @03,EXITPRMP(,@03)                               02S0233
         LTR   @03,@03                                          02S0233
         BZ    @RF00233                                         02S0233
*  DO;                                                          02S0234
*    PRMQDBP = QDBPTR;                 /*QDB PTR TO ESTAE PARMS      */
         ST    QDBPTR,PRMQDBP(,@03)                             02S0235
*    PRMDSQL = DSQLASTP;               /*PTR TO LAST DSAB TO PARMS   */
         MVC   PRMDSQL(4,@03),DSQLASTP(QDBPTR)                  02S0236
*    PRMDSQF = DSQFRSTP;               /*PTR TO FIRST DSAB TO PARMS  */
         MVC   PRMDSQF(4,@03),DSQFRSTP(QDBPTR)                  02S0237
*    PRMNELM = DSQNELMS;               /*NO. OF DSABS TO PARMS       */
         MVC   PRMNELM(4,@03),DSQNELMS(QDBPTR)                  02S0238
*    DSABCHN = ON;                     /*INDICATE DSAB BEING UPDATED */
         OI    DSABCHN(@03),B'00100000'                         02S0239
*  END;                                                         02S0240
*IF DSQFRSTP ^= ZERO THEN              /*OTHER DSABS EXIST?          */
@RF00233 ICM   @03,15,DSQFRSTP(QDBPTR)                          02S0241
         BZ    @RF00241                                         02S0241
*  DO;                                                          02S0242
*    DSABBCHN = DSQLASTP;              /*YES,SET BACKWARD PTR TO DSAB*/
         L     @03,DSABPTR                                      02S0243
         L     @15,DSQLASTP(,QDBPTR)                            02S0243
         ST    @15,DSABBCHN(,@03)                               02S0243
*    DSABBCHN->DSABFCHN=DSABPTR;       /*SET PTR TO THIS DSAB        */
         ST    @03,DSABFCHN(,@15)                               02S0244
*  END;                                                         02S0245
*DSABLNTH = DSABLENG;                  /*DSAB LENGTH                 */
@RF00241 L     @03,DSABPTR                                      02S0246
         MVC   DSABLNTH(2,@03),DSABLENG+2                       02S0246
*IF DSABBCHN = ZERO THEN               /*IS THIS FIRST DSAB?         */
         ICM   @15,15,DSABBCHN(@03)                             02S0247
         BNZ   @RF00247                                         02S0247
*  DSQFRSTP = DSABPTR;                 /*YES, SET PTR IN QDB         */
         ST    @03,DSQFRSTP(,QDBPTR)                            02S0248
*DSQLASTP = DSABPTR;                   /*SET PTR TO LAST DSAB IN QDB */
@RF00247 L     @03,DSABPTR                                      02S0249
         ST    @03,DSQLASTP(,QDBPTR)                            02S0249
*DSQNELMS = DSQNELMS+1;                /*UP ELEMENT NUMBER COUNT     */
         LA    @15,1                                            02S0250
         AL    @15,DSQNELMS(,QDBPTR)                            02S0250
         ST    @15,DSQNELMS(,QDBPTR)                            02S0250
*EREQSIOT->SIOTETIO = DSABPTR;         /*PUT DSAB PTR IN SIOT        */
         L     @02,@PC00001                                     02S0251
         L     @01,EREQPTR(,@02)                                02S0251
         L     @02,EREQSIOT(,@01)                               02S0251
         ST    @03,SIOTETIO(,@02)                               02S0251
*IF EXITPRMP ^= ZERO THEN              /* ESTAE PARMS EXIST?         */
         L     @03,@PC00001+8                                   02S0252
         L     @03,EXITPRMP(,@03)                               02S0252
         LTR   @03,@03                                          02S0252
         BZ    @RF00252                                         02S0252
*  DO;                                                          02S0253
*    DSABCHN = OFF;                    /*INDICATE CHAINING COMPLETE  */
         NI    DSABCHN(@03),B'11011111'                         02S0254
*    PRMSIOTP = EREQSIOT;              /*PTR TO SIOT TO ESTAE PARMS  */
         ST    @02,PRMSIOTP(,@03)                               02S0255
*    UPDSABCK = ON;                    /*ETIOT ENTRY BEING UPDATED   */
         OI    UPDSABCK(@03),B'01000000'                        02S0256
*  END;                                                         02S0257
*IF EREQSIOT->SIOTCCAT = ON THEN       /*MEMBER OF CONCAT GROUP?     */
@RF00252 L     @15,@PC00001                                     02S0258
         L     @01,EREQPTR(,@15)                                02S0258
         L     @01,EREQSIOT(,@01)                               02S0258
         TM    SIOTCCAT(@01),B'00100000'                        02S0258
         BNO   @RF00258                                         02S0258
*  DSABCATM = ON;                      /*DSAB CONCAT INDICATOR       */
         L     @01,DSABPTR                                      02S0259
         OI    DSABCATM(@01),B'00000010'                        02S0259
*ELSE;                                                          02S0260
@RF00258 DS    0H                                               02S0261
*IF EREQSIOT -> SCTDEFER = ON THEN     /*DEFER MOUNTING SPECIFIED    */
         L     @15,@PC00001                                     02S0261
         L     @01,EREQPTR(,@15)                                02S0261
         L     @01,EREQSIOT(,@01)                               02S0261
         TM    SCTDEFER(@01),B'00000010'                        02S0261
         BNO   @RF00261                                         02S0261
*  DSABDEFR = ON;                      /*SET DEFER IN DSAB           */
         L     @01,DSABPTR                                      02S0262
         OI    DSABDEFR(@01),B'10000000'                        02S0262
*DSABSSVA = EREQSSVA;                  /*SIOT VIRTUAL ADDRESS        */
@RF00261 L     @15,DSABPTR                                      02S0263
         L     @14,@PC00001                                     02S0263
         L     @14,EREQPTR(,@14)                                02S0263
         MVC   DSABSSVA(3,@15),EREQSSVA(@14)                    02S0263
*IF EREQVAM = ON THEN                  /*VAM DATA SET?               */
         TM    EREQVAM(@14),B'00100000'                         02S0264
         BNO   @RF00264                                         02S0264
*  DSABVAM = ON;                       /*YES, SET APPROPRIATE BIT    */
         OI    DSABVAM(@15),B'00100000'                         02S0265
*IF EREQUNAL=ON THEN                   /*UNALLOCATE WHEN CLOSED?     */
@RF00264 L     @15,@PC00001                                     02S0266
         L     @01,EREQPTR(,@15)                                02S0266
         TM    EREQUNAL(@01),B'00010000'                        02S0266
         BNO   @RF00266                                         02S0266
*  DSABUNAL=ON;                        /*YES,SET APPROPRIATE BIT     */
         L     @01,DSABPTR                                      02S0267
         OI    DSABUNAL(@01),B'00100000'                        02S0267
*/********************************************************************/
*/*       INITIALIZE TIOT DD ENTRY                                   */
*/********************************************************************/
*TIOENTRY(1:TIOMELEN)=TIOENTRY(1:TIOMELEN)&&TIOENTRY(1:TIOMELEN);
@RF00266 L     @01,DSABPTR                                      02S0268
         L     @15,DSABTIOT(,@01)                               02S0268
         L     @01,TIORBPTR                                     02S0268
         LH    @14,TIOMELEN(,@01)                               02S0268
         LR    @09,@14                                          02S0268
         BCTR  @09,0                                            02S0268
         EX    @09,@SX01301                                     02S0268
*TIOELNGH = TIOMELEN;                  /*LENGTH OF TIOT DD ENTRY     */
         STC   @14,TIOELNGH(,@15)                               02S0269
*TIOEWTCT = EREQDEVS;                  /*NUMBER OF DEVICES           */
         L     @14,@PC00001                                     02S0270
         L     @14,EREQPTR(,@14)                                02S0270
         MVC   TIOEWTCT(1,@15),EREQDEVS+1(@14)                  02S0270
*IF EREQTERM = ON THEN                 /*TERM=TS REQUESTED?          */
         TM    EREQTERM(@14),B'10000000'                        02S0271
         BNO   @RF00271                                         02S0271
*  TIOTTERM = ON;                      /*YES, SET APPROPRIATE BIT    */
         OI    TIOTTERM(@15),B'00100000'                        02S0272
*IF EREQQNM = ON THEN                  /*QNAME REQUESTED?            */
@RF00271 L     @15,@PC00001                                     02S0273
         L     @01,EREQPTR(,@15)                                02S0273
         TM    EREQQNM(@01),B'01000000'                         02S0273
         BNO   @RF00273                                         02S0273
*  TIOEQNAM = ON;                      /*YES, SET APPROPRIATE BIT    */
         L     @01,DSABPTR                                      02S0274
         L     @01,DSABTIOT(,@01)                               02S0274
         OI    TIOEQNAM(@01),B'00001000'                        02S0274
*IF EREQSIOT->SIOTCCAT = ON THEN       /*BLANK DDNAME IN TIOT?       */
@RF00273 L     @15,@PC00001                                     02S0275
         L     @01,EREQPTR(,@15)                                02S0275
         L     @01,EREQSIOT(,@01)                               02S0275
         TM    SIOTCCAT(@01),B'00100000'                        02S0275
         BNO   @RF00275                                         02S0275
*  TIOEDDNM=BLANKS8;                   /*FILL IN DDNAM WITH BLANKS   */
         L     @01,DSABPTR                                      02S0276
         L     @01,DSABTIOT(,@01)                               02S0276
         MVC   TIOEDDNM(8,@01),BLANKS8                          02S0276
*ELSE                                                           02S0277
*  TIOEDDNM = EREQDDNM;                /*DDNAME                      */
         B     @RC00275                                         02S0277
@RF00275 L     @01,DSABPTR                                      02S0277
         L     @01,DSABTIOT(,@01)                               02S0277
         L     @15,@PC00001                                     02S0277
         L     @15,EREQPTR(,@15)                                02S0277
         MVC   TIOEDDNM(8,@01),EREQDDNM(@15)                    02S0277
*UCBPTR = EREQUCB;                     /*GET UCB ADDRESS             */
@RC00275 L     @15,@PC00001                                     02S0278
         L     @15,EREQPTR(,@15)                                02S0278
         L     UCBPTR,EREQUCB(,@15)                             02S0278
*IF EREQSIOT -> SIOTPRIV = ON ×        /*PRIVATE REQUEST     @YM03917*/
*   EREQSIOT -> SPVTAMSG = ON THEN     /*STORAGE CHANGED TO PVT 02S0279
*                                                            @YM03917*/
         L     @15,EREQSIOT(,@15)                               02S0279
         TM    SIOTPRIV(@15),B'00100000'                        02S0279
         BO    @RT00279                                         02S0279
         TM    SPVTAMSG(@15),B'00010000'                        02S0279
         BNO   @RF00279                                         02S0279
@RT00279 DS    0H                                               02S0280
*  TIOSDSP1 = ON;                      /*SET RWND/UNLD FOR CLOSE     */
         L     @01,DSABPTR                                      02S0280
         L     @01,DSABTIOT(,@01)                               02S0280
         OI    TIOSDSP1(@01),B'00000010'                        02S0280
*ELSE                                  /*REQUEST NOT PRIVATE         */
*  TIOSDSP2 = ON;                      /*SET RWND FOR CLOSE          */
         B     @RC00279                                         02S0281
@RF00279 L     @01,DSABPTR                                      02S0281
         L     @01,DSABTIOT(,@01)                               02S0281
         OI    TIOSDSP2(@01),B'00000001'                        02S0281
*TIOEJFCB = EREQJSVA;                  /*JFCB VIRTUAL ADDRESS        */
@RC00279 L     @01,DSABPTR                                      02S0282
         L     @15,DSABTIOT(,@01)                               02S0282
         L     @14,@PC00001                                     02S0282
         L     @14,EREQPTR(,@14)                                02S0282
         MVC   TIOEJFCB(3,@15),EREQJSVA(@14)                    02S0282
*TIOUSED(1) = ON;                      /*SET DATA SET ON DEVICE BIT  */
         OI    TIOUSED(@15),B'10000000'                         02S0283
*TIOUCBP(EREQRPOS) = EREQUCB;          /*SET UCB ADDRESS             */
         LH    @09,EREQRPOS(,@14)                               02S0284
         SLA   @09,2                                            02S0284
         L     @08,EREQUCB(,@14)                                02S0284
         ALR   @09,@15                                          02S0284
         STCM  @08,7,TIOUCBP-4(@09)                             02S0284
*IF EREQSIOT->SCTJOBLB = ON THEN                                02S0285
         L     @01,EREQSIOT(,@14)                               02S0285
         TM    SCTJOBLB(@01),B'00010000'                        02S0285
         BNO   @RF00285                                         02S0285
*  TIOSJBLB = ON;                      /*SET JOBLIB INDICATOR IN TIOT
*                                                            @ZA06652*/
         OI    TIOSJBLB(@15),B'00010000'                        02S0286
*                  END;                                         01S0287
*                ELSE                  /*TIOT MANAGER FAILURE        */
*                  EREQCODE = NOSPACE; /* NO SPACE IN TIOT           */
         B     @RC00224                                         01S0288
@RF00224 L     @15,@PC00001                                     01S0288
         L     @01,EREQPTR(,@15)                                01S0288
         MVC   EREQCODE(2,@01),@CH00338                         01S0288
*              END;                                             01S0289
*            ELSE;                                              01S0290
@RF00214 DS    0H                                               01S0291
*          END;                                                 01S0291
*        ELSE;                                                  01S0292
@RF00124 DS    0H                                               01S0293
*        IF RETCODE ^= ZERO THEN       /*DID ERROR OCCUR?            */
@RC00124 LTR   RETCODE,RETCODE                                  01S0293
         BZ    @RF00293                                         01S0293
*          DO;                                                  01S0294
*            RFY (REG0,REG1) RSTD;                              01S0295
*            IF GOTGRSW=ON THEN        /*GROUP ID LIST EXIST?        */
         TM    GOTGRSW,B'10000000'                              01S0296
         BNO   @RF00296                                         01S0296
*              DO;                     /*YES:                        */
*                SUBPL1=JSCBSWSP;      /*SUBPOOL NUMBER OF ID LIST   */
         L     @10,@PC00001+4                                   01S0298
         L     @10,JSCBPTR(,@10)                                01S0298
         MVC   SUBPL1(1),JSCBSWSP(@10)                          01S0298
*                LENG=GETLEN;          /*LENGTH OF GROUP ID LIST     */
         MVC   LENG(3),GETLEN+1                                 01S0299
*                REG0=FREELEN;         /*MOVE SUBPL AND LENG TO REG  */
         L     REG0,FREELEN                                     01S0300
*                REG1=DSABGIDP;        /*PTR TO GROUP ID LIST        */
         L     @10,DSABPTR                                      01S0301
         L     REG1,DSABGIDP(,@10)                              01S0301
*                GEN( FREEMAIN R,LV=(0),A=(1) ); /*FREE ID LIST      */
          FREEMAIN R,LV=(0),A=(1)
*              END;                                             01S0303
*            ELSE;                                              01S0304
@RF00296 DS    0H                                               01S0305
*            IF DSBNAMSW = ON THEN      /*DOES DSABANMI EXIST?       */
         TM    DSBNAMSW,B'10000000'                             01S0305
         BNO   @RF00305                                         01S0305
*              DO;                                              01S0306
*                SUBPL1=JSCBSWSP;       /*SUBPOOL NUMBER             */
         L     @10,@PC00001+4                                   01S0307
         L     @10,JSCBPTR(,@10)                                01S0307
         MVC   SUBPL1(1),JSCBSWSP(@10)                          01S0307
*                LENG  =CORBYTES;       /*LENGTH OF CORE TO FREE     */
         MVC   LENG(3),CORBYTES+1                               01S0308
*                REG0  =FREELEN;        /*MOVE SUBPOOL & LENG TO REG */
         L     REG0,FREELEN                                     01S0309
*                REG1  = ADDR(DSABANMI); /*PTR TO NAME FLD           */
         L     @10,DSABPTR                                      01S0310
         L     REG1,DSABANMP(,@10)                              01S0310
*                GEN (FREEMAIN R,LV=(0),A=(1)); /*FREE NAM FLD       */
         FREEMAIN R,LV=(0),A=(1)
*              END;                                             01S0312
*            ELSE;                                              01S0313
@RF00305 DS    0H                                               01S0314
*            SUBPL1=JSCBSWSP;          /*SUBPOOL NUMBER OF ID LIST   */
         L     @15,@PC00001+4                                   01S0314
         L     @15,JSCBPTR(,@15)                                01S0314
         MVC   SUBPL1(1),JSCBSWSP(@15)                          01S0314
*            LENG=DSABLENG;            /*LENGTH OF DSAB              */
         MVC   LENG(3),DSABLENG+1                               01S0315
*            REG0=FREELEN;             /*MOVE SUBPOOL AND LENG TO REG*/
         L     REG0,FREELEN                                     01S0316
*            REG1=DSABPTR;             /*PTR TO DSAB                 */
         L     REG1,DSABPTR                                     01S0317
*            GEN ( FREEMAIN R,LV=(0),A=(1) ); /*FREE DSAB CORE       */
          FREEMAIN R,LV=(0),A=(1)
*            RFY (REG0,REG1) UNRSTD;                            01S0319
*            RETCODE=ERROR;            /*SET ERROR RETURN CODE       */
         LA    RETCODE,4                                        01S0320
*          END;                                                 01S0321
*        ELSE                                                   01S0322
*          DO;                                                  01S0322
         B     @RC00293                                         01S0322
@RF00293 DS    0H                                               01S0323
*            IF EREQPASS = ON THEN     /*DATA SET DISP = PASS?       */
         L     @15,@PC00001                                     01S0323
         L     @01,EREQPTR(,@15)                                01S0323
         TM    EREQPASS(@01),B'00001000'                        01S0323
         BNO   @RF00323                                         01S0323
*              DSABPASS = ON;                                   01S0324
         L     @01,DSABPTR                                      01S0324
         OI    DSABPASS(@01),B'01000000'                        01S0324
*            ELSE;                                              01S0325
@RF00323 DS    0H                                               01S0326
*            IF EREQJSCT = ON THEN     /*JOBCAT OR STEPCAT?          */
         L     @15,@PC00001                                     01S0326
         L     @01,EREQPTR(,@15)                                01S0326
         TM    EREQJSCT(@01),B'00000100'                        01S0326
         BNO   @RF00326                                         01S0326
*              DSABJSCT  = ON;                                  01S0327
         L     @01,DSABPTR                                      01S0327
         OI    DSABJSCT(@01),B'00000100'                        01S0327
*            ELSE;                                              01S0328
@RF00326 DS    0H                                               01S0329
*            IF EREQCATL = ON THEN     /*IS DATA SET A CATALOG?      */
         L     @15,@PC00001                                     01S0329
         L     @01,EREQPTR(,@15)                                01S0329
         TM    EREQCATL(@01),B'00000010'                        01S0329
         BNO   @RF00329                                         01S0329
*              DSABCATL  = ON;                                  01S0330
         L     @01,DSABPTR                                      01S0330
         OI    DSABCATL(@01),B'00001000'                        01S0330
*            ELSE;                                              01S0331
@RF00329 DS    0H                                               01S0332
*          END;                                                 01S0332
*      END;                                                     01S0333
*    ELSE                              /*GETMAIN FAILURE             */
*      DO;                                                      01S0334
         B     @RC00091                                         01S0334
@RF00091 DS    0H                                               01S0335
*        RETCODE = ERROR;              /*SET ERROR RETURN CODE       */
         LA    RETCODE,4                                        01S0335
*        EREQCODE = GETMERR;           /*SET ERROR REASON CODE       */
         L     @15,@PC00001                                     01S0336
         L     @01,EREQPTR(,@15)                                01S0336
         MVC   EREQCODE(2,@01),@CH00094                         01S0336
*      END;                                                     01S0337
*    IF EXITPRMP ^= ZERO THEN          /*ESTAE PARMS EXIT ?          */
@RC00091 L     @15,@PC00001+8                                   01S0338
         L     @15,EXITPRMP(,@15)                               01S0338
         LTR   @15,@15                                          01S0338
         BZ    @RF00338                                         01S0338
*      UPDSABCK = OFF;                 /*DSAB/TIOT UPDATED           */
         NI    UPDSABCK(@15),B'10111111'                        01S0339
*  END;                                                         01S0340
*ELSE                                                           01S0341
*  IF EREQUPD = ON THEN                /*UPDATE TIOT DD ENTRY?       */
         B     @RC00062                                         01S0341
@RF00062 L     @15,@PC00001                                     01S0341
         L     @15,EREQPTR(,@15)                                01S0341
         TM    EREQUPD(@15),B'01000000'                         01S0341
         BNO   @RF00341                                         01S0341
*    DO;                               /*YES:                        */
*      DSABPTR = EREQSIOT->SIOTETIO;   /*SET PTR TO ENTRY            */
         L     @01,EREQSIOT(,@15)                               01S0343
         L     @14,SIOTETIO(,@01)                               01S0343
         ST    @14,DSABPTR                                      01S0343
*      TIOUCBP(EREQRPOS) = EREQUCB;    /*PUT IN UCB ADDRESS          */
         LH    @09,EREQRPOS(,@15)                               01S0344
         SLA   @09,2                                            01S0344
         L     @01,DSABTIOT(,@14)                               01S0344
         L     @08,EREQUCB(,@15)                                01S0344
         ALR   @01,@09                                          01S0344
         STCM  @08,7,TIOUCBP-4(@01)                             01S0344
*      IF DSABGIDP ^= 0 THEN                                    01S0345
         L     @08,DSABGIDP(,@14)                               01S0345
         LTR   @08,@08                                          01S0345
         BZ    @RF00345                                         01S0345
*        DSABGRID(EREQRPOS) = EREQGRID;/*PUT IN GROUP ID             */
         L     @15,EREQGRID(,@15)                               01S0346
         ST    @15,DSABGRID-4(@09,@08)                          01S0346
*    END;                                                       01S0347
*  ELSE                                                         01S0348
*    IF EREQMOVE = ON THEN             /*MOVE ENTRY?                 */
         B     @RC00341                                         01S0348
@RF00341 L     @15,@PC00001                                     01S0348
         L     @15,EREQPTR(,@15)                                01S0348
         TM    EREQMOVE(@15),B'00100000'                        01S0348
         BNO   @RF00348                                         01S0348
*      DO;                             /*YES:                        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MVTIOTDD                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - MOVE TIOT DD ENTRY                            */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT MOVES A GROUP ID LIST AND A TIOT DD ENTRY         */
*/*   IN ORDER THAT THEY MAY BE EXPANDED. THE SEGMENT GETS A         */
*/*   SLOT FOR THE NEW TIOT DD ENTRY FROM THE TIOT MANAGER,          */
*/*   IEFAB4FC. IT GETS CORE FOR THE NEW GROUP ID LIST. IT THEN MOVES*/
*/*   THE INFORMATION FROM THE OLD AREAS TO THE NEW ONES, RELEASES   */
*/*   THE OLD ENTRIES, AND UPDATES POINTERS IN THE DSAB.             */
*/*                                                                  */
*/* ENTRY -                                                          */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     ADDRESSES OF CURRENT TIOT DD ENTRY AND GROUP ID LIST         */
*/*     POINTER TO SIOT WHICH CONTAINS POINTER TO DSAB               */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*   CONDITION - TIOT DD ENTRY MOVED SUCCESSFULLY                   */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     NEW TIOT DD ENTRY                                            */
*/*     NEW GROUP ID LIST                                            */
*/*     UPDATED DSAB                                                 */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/*   CONDITION - ERROR                                              */
*/*                                                                  */
*/*   OUTPUT DATA -                                                  */
*/*     REASON -                                                     */
*/*       2 - GETMAIN ERROR                                          */
*/*       4 - FAILURE IN RELEASE OF OLD TIOT DD ENTRY                */
*/*       6 - NO SPACE IN TIOT FOR DD ENTRY                          */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/* EXTERNAL REFERENCES                                              */
*/*   IEFAB4FC - TIOT MANAGER                                        */
*/*                                                                  */
*/********************************************************************/
*DSABPTR = EREQSIOT->SIOTETIO;          /*SET PTR TO DSAB            */
         L     @01,EREQSIOT(,@15)                               02S0350
         MVC   DSABPTR(4),SIOTETIO(@01)                         02S0350
*TIOMGRRB=TIOMGRRB && TIOMGRRB;         /*CLEAR TIOT REQUEST BLOCK   */
         L     @14,TIORBPTR                                     02S0351
         XC    TIOMGRRB(38,@14),TIOMGRRB(@14)                   02S0351
*TIOMALOC = ON;                         /*INDICATE FUNC FOR TIOT MGR */
         OI    TIOMALOC(@14),B'00100000'                        02S0352
*TIOMJSCP = JSCBPTR;                    /*SUPPLY JSCB ADDRESS        */
         L     @09,@PC00001+4                                   02S0353
         MVC   TIOMJSCP(4,@14),JSCBPTR(@09)                     02S0353
*TIOMRETP = ADDR(TEMPTIOP);             /*PT TO AREA FOR ENTRY ADDR  */
         LA    @09,TEMPTIOP                                     02S0354
         ST    @09,TIOMRETP(,@14)                               02S0354
*TIOMELEN = ETIOBASE+(DEVENTLN*EREQDEVS); /*LENGTH OF TIOT DD ENTRY  */
         L     @09,DEVENTLN                                     02S0355
         MH    @09,EREQDEVS(,@15)                               02S0355
         AH    @09,@CH00051                                     02S0355
         STH   @09,TIOMELEN(,@14)                               02S0355
*CALL IEFAB4FC(TIORBPTR);               /*CALL TIOT MGR TO ASSGN ENT */
         LA    @15,TIORBPTR                                     02S0356
         ST    @15,@AL00001                                     02S0356
         L     @15,@CV01261                                     02S0356
         LA    @01,@AL00001                                     02S0356
         BALR  @14,@15                                          02S0356
*IF REG15 = NOERROR THEN                /*TIOT MANAGER ERROR?        */
         SLR   @14,@14                                          02S0357
         CR    REG15,@14                                        02S0357
         BNE   @RF00357                                         02S0357
*  DO;                                  /*NO,GET CORE FOR ID LIST    */
*    IF DSABGIDP ^= ZERO THEN           /*SHOULD ID LIST EXIST?      */
         L     @01,DSABPTR                                      02S0359
         C     @14,DSABGIDP(,@01)                               02S0359
         BE    @RF00359                                         02S0359
*      DO;                              /*YES, GET CORE FOR IT       */
*        GETLEN=HDRLEN+(GRIDLEN*EREQDEVS); /*LENGTH OF GROUP ID LIST */
         L     @15,@PC00001                                     02S0361
         L     @01,EREQPTR(,@15)                                02S0361
         L     @00,GRIDLEN                                      02S0361
         MH    @00,EREQDEVS(,@01)                               02S0361
         AL    @00,HDRLEN                                       02S0361
         ST    @00,GETLEN                                       02S0361
*         /* ?GETSTORG (SUBPL,GETLEN,TEMPIDP);*/                02S0362
*           RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/       02S0362
*           GTSTR0 = GETLEN; /* SET AMOUNT*/                    02S0363
         L     @03,GETLEN                                       02S0363
         LR    GTSTR0,@03                                       02S0363
*           GTSTR2 = SUBPL; /* SET SUBPOOL*/                    02S0364
         L     GTSTR2,SUBPL                                     02S0364
*           GENERATE CODE;                                      02S0365
             GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*           GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/       02S0366
         ST    GTSTR15,GTSTRTCD                                 02S0366
*           TEMPIDP = GTSTR1; /* ADDR OF GOTN STORG*/           02S0367
         ST    GTSTR1,TEMPIDP                                   02S0367
*           RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */        02S0368
*           IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */       02S0369
         L     @15,GTSTRTCD                                     02S0369
         LTR   @15,@15                                          02S0369
         BNZ   @RF00369                                         02S0369
*             DO;               /* YES, CLEAR STORAGE.*/        02S0370
*               RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,               02S0371
*                                  GTSTR7,GTSTR8) RSTD;         02S0371
*               GTSTR4 = TEMPIDP; /*STORG PTR*/                 02S0372
         L     @09,TEMPIDP                                      02S0372
         LR    GTSTR4,@09                                       02S0372
*               GTSTR5 = GETLEN; /*STORG AMNT*/                 02S0373
         L     GTSTR5,GETLEN                                    02S0373
*               GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/       02S0374
         SLR   GTSTR7,GTSTR7                                    02S0374
*               IF SUBPL = GTST253 THEN                         02S0375
         CLC   SUBPL(4),@CF01288                                02S0375
         BNE   @RF00375                                         02S0375
*              GEN                                              02S0376
*           (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);   02S0376
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*               GEN REFS(GTSTR4,GTSTR6);                        02S0377
@RF00375 DS    0H                                               02S0377
                  MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*               IF SUBPL = GTST253 THEN                         02S0378
         CLC   SUBPL(4),@CF01288                                02S0378
         BNE   @RF00378                                         02S0378
*                 GEN (MODESET KEYADDR=(2));                    02S0379
         MODESET KEYADDR=(2)
*               RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,               02S0380
*                                  GTSTR7,GTSTR8) UNRSTD;       02S0380
@RF00378 DS    0H                                               02S0381
*             END;       /* STORAGE CLEARING COMPLETED */       02S0381
*           ELSE                                                02S0382
*           TEMPIDP= 0;   /* CLEAR RETURN ADDR. */              02S0382
         B     @RC00369                                         02S0382
@RF00369 SLR   @15,@15                                          02S0382
         ST    @15,TEMPIDP                                      02S0382
*           GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */       02S0383
@RC00369 L     GTSTR15,GTSTRTCD                                 02S0383
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET CORE FOR ID LIST */                                      02S0384
*        RFY (REG15) RSTD;                                      02S0384
*      END;                                                     02S0385
*    ELSE GRIDSW = OFF;                 /*NO, INDICATE NO ID LIST    */
         B     @RC00359                                         02S0386
@RF00359 NI    GRIDSW,B'01111111'                               02S0386
*    IF REG15 = NOERROR × GRIDSW=OFF THEN /*GETMAIN SUCCESSFUL?      */
@RC00359 LTR   REG15,REG15                                      02S0387
         BZ    @RT00387                                         02S0387
         TM    GRIDSW,B'10000000'                               02S0387
         BNZ   @RF00387                                         02S0387
@RT00387 DS    0H                                               02S0388
*      DO;                              /*YES,FILL IN TIOT ENT & ID'S*/
*        /************************************************************/
*        /*  INITIALIZE TIOT DD ENTRY                                */
*        /************************************************************/
*        RFY (REG15) UNRSTD;                                    02S0389
*        TEMPTIOP->TIOENTRY(1:TIOELNGH)=TIOENTRY; /*MOVE DD ENTRY    */
         L     @15,TEMPTIOP                                     02S0390
         L     @01,DSABPTR                                      02S0390
         L     @14,DSABTIOT(,@01)                               02S0390
         SLR   @09,@09                                          02S0390
         IC    @09,TIOELNGH(,@14)                               02S0390
         BCTR  @09,0                                            02S0390
         EX    @09,@SM01308                                     02S0390
*        TEMPTIOP->TIOELNGH = TIOMELEN; /*SET NEW LENGTH             */
         L     @14,TIORBPTR                                     02S0391
         MVC   TIOELNGH(1,@15),TIOMELEN+1(@14)                  02S0391
*        TEMPTIOP->TIOEWTCT=EREQDEVS;   /*SET NEW UNIT COUNT         */
         L     @14,@PC00001                                     02S0392
         L     @14,EREQPTR(,@14)                                02S0392
         LH    @09,EREQDEVS(,@14)                               02S0392
         STC   @09,TIOEWTCT(,@15)                               02S0392
*        IF EREQRPOS ^= EREQDEVS THEN   /*IS NEW ENTRY THE LAST ?    */
         CH    @09,EREQRPOS(,@14)                               02S0393
         BE    @RF00393                                         02S0393
*          DO NEWPOS = EREQDEVS TO EREQRPOS+1 BY -1; /*NO, SHIFT
*                                         ENTRIES DOWN               */
         LR    NEWPOS,@09                                       02S0394
         B     @DE00394                                         02S0394
@DL00394 DS    0H                                               02S0395
*            TEMPTIOP -> TIOEDEVE(NEWPOS) =                     02S0395
*               TEMPTIOP -> TIOEDEVE(NEWPOS-1);                 02S0395
         L     @03,TEMPTIOP                                     02S0395
         LR    @15,NEWPOS                                       02S0395
         SLA   @15,2                                            02S0395
         L     @14,TIOEDEVE-8(@15,@03)                          02S0395
         ST    @14,TIOEDEVE-4(@15,@03)                          02S0395
*          END;                                                 02S0396
         BCTR  NEWPOS,0                                         02S0396
@DE00394 L     @03,@PC00001                                     02S0396
         L     @03,EREQPTR(,@03)                                02S0396
         LA    @15,1                                            02S0396
         AH    @15,EREQRPOS(,@03)                               02S0396
         CR    NEWPOS,@15                                       02S0396
         BNL   @DL00394                                         02S0396
*        TEMPTIOP -> TIOEDEVE(EREQRPOS) = ZERO; /*CLEAR NEW DEV ENTRY*/
@RF00393 L     @15,TEMPTIOP                                     02S0397
         L     @14,@PC00001                                     02S0397
         L     @01,EREQPTR(,@14)                                02S0397
         LH    @14,EREQRPOS(,@01)                               02S0397
         SLA   @14,2                                            02S0397
         SLR   @09,@09                                          02S0397
         ST    @09,TIOEDEVE-4(@14,@15)                          02S0397
*        TIOMGRRB=TIOMGRRB && TIOMGRRB; /*CLEAR TIOT MGR REQUEST BLK */
         L     @14,TIORBPTR                                     02S0398
         XC    TIOMGRRB(38,@14),TIOMGRRB(@14)                   02S0398
*        TIOMRLSE = ON;                 /*PREPARE TO RELEASE OLD ENT */
         OI    TIOMRLSE(@14),B'00010000'                        02S0399
*        TIOMJSCP = JSCBPTR;            /*SUPPLY JSCB PTR            */
         L     @09,@PC00001+4                                   02S0400
         MVC   TIOMJSCP(4,@14),JSCBPTR(@09)                     02S0400
*        TIOMENTP = DSABTIOT;           /*PTR TO ENTRY TO BE RELEASED*/
         L     @09,DSABPTR                                      02S0401
         MVC   TIOMENTP(4,@14),DSABTIOT(@09)                    02S0401
*        DSABTIOT = TEMPTIOP;           /*SET PTR TO NEW TIOT ENTRY  */
         ST    @15,DSABTIOT(,@09)                               02S0402
*        CALL IEFAB4FC(TIORBPTR);       /*RELEASE OLD TIOT DD ENTRY  */
         LA    @15,TIORBPTR                                     02S0403
         ST    @15,@AL00001                                     02S0403
         L     @15,@CV01261                                     02S0403
         LA    @01,@AL00001                                     02S0403
         BALR  @14,@15                                          02S0403
*        IF REG15 = NOERROR THEN        /*TIOT MANAGER ERROR?        */
         LTR   REG15,REG15                                      02S0404
         BNZ   @RF00404                                         02S0404
*          DO;                          /*NO:                        */
*            DSABTIOT = TEMPTIOP;       /*SET PTR TO NEW TIOT ENTRY  */
         L     @15,DSABPTR                                      02S0406
         MVC   DSABTIOT(4,@15),TEMPTIOP                         02S0406
*            /********************************************************/
*            /*   INITITALIZE GROUP ID LIST                          */
*            /********************************************************/
*            IF GRIDSW = ON THEN        /*DOES ID LIST EXIST?        */
         TM    GRIDSW,B'10000000'                               02S0407
         BNO   @RF00407                                         02S0407
*              DO;                      /*YES,INITIALIZE ID LIST     */
*                TEMPIDP->DSABGIDL(1:DSABLLEN)=DSABGIDL; /*MOVE IDS  */
         L     @14,TEMPIDP                                      02S0409
         L     @09,DSABGIDP(,@15)                               02S0409
         L     @08,DSABLLEN(,@09)                               02S0409
         LR    @07,@08                                          02S0409
         BCTR  @07,0                                            02S0409
         EX    @07,@SM01310                                     02S0409
*                RFY (REG0,REG1) RSTD;                          02S0410
*                SUBPL1=JSCBSWSP;       /*SET SUBPOOL ID             */
         L     @07,@PC00001+4                                   02S0411
         L     @07,JSCBPTR(,@07)                                02S0411
         MVC   SUBPL1(1),JSCBSWSP(@07)                          02S0411
*                LENG=DSABLLEN;         /*SET LENGTH OF OLD ID LIST  */
         STCM  @08,7,LENG                                       02S0412
*                REG0=FREELEN;          /*MOVE SUBPOOL AND LNG TO REG*/
         L     REG0,FREELEN                                     02S0413
*                REG1=DSABGIDP;         /*SET PTR TO OLD ID LIST     */
         LR    REG1,@09                                         02S0414
*                DSABGIDP = TEMPIDP;    /*PT TO NEW ID LIST IN DSAB  */
         ST    @14,DSABGIDP(,@15)                               02S0415
*                DSABLLEN = GETLEN;     /*SET NEW ID LIST LENGTH     */
         MVC   DSABLLEN(4,@14),GETLEN                           02S0416
*                GEN(   FREEMAIN R,LV=(0),A=(1)); /*FREE OLD ID LIST */
            FREEMAIN R,LV=(0),A=(1)
*                RFY (REG0,REG1) UNRSTD;                        02S0418
*                IF EREQRPOS ^= EREQDEVS THEN /*NEW ENTRY LAST ONE ? */
         L     @15,@PC00001                                     02S0419
         L     @15,EREQPTR(,@15)                                02S0419
         LH    @14,EREQDEVS(,@15)                               02S0419
         CH    @14,EREQRPOS(,@15)                               02S0419
         BE    @RF00419                                         02S0419
*                  DO NEWPOS = EREQDEVS TO EREQRPOS+1 BY -1; /*NO,
*                                         SHIFT IDS DOWN             */
         LR    NEWPOS,@14                                       02S0420
         B     @DE00420                                         02S0420
@DL00420 DS    0H                                               02S0421
*                    DSABGRID(NEWPOS) = DSABGRID(NEWPOS-1);     02S0421
         LR    @03,NEWPOS                                       02S0421
         SLA   @03,2                                            02S0421
         L     @01,DSABPTR                                      02S0421
         L     @15,DSABGIDP(,@01)                               02S0421
         ST    @03,@TF00001                                     02S0421
         ALR   @03,@15                                          02S0421
         AL    @15,@TF00001                                     02S0421
         AL    @15,@CF01312                                     02S0421
         MVC   DSABGRID-4(4,@03),DSABGRID-4(@15)                02S0421
*                  END;                                         02S0422
         BCTR  NEWPOS,0                                         02S0422
@DE00420 L     @03,@PC00001                                     02S0422
         L     @03,EREQPTR(,@03)                                02S0422
         LA    @15,1                                            02S0422
         AH    @15,EREQRPOS(,@03)                               02S0422
         CR    NEWPOS,@15                                       02S0422
         BNL   @DL00420                                         02S0422
*                DSABGRID(EREQRPOS) = ZERO; /*CLEAR NEW ID FIELD     */
@RF00419 L     @15,@PC00001                                     02S0423
         L     @01,EREQPTR(,@15)                                02S0423
         LH    @15,EREQRPOS(,@01)                               02S0423
         SLA   @15,2                                            02S0423
         L     @01,DSABPTR                                      02S0423
         L     @01,DSABGIDP(,@01)                               02S0423
         SLR   @14,@14                                          02S0423
         ST    @14,DSABGRID-4(@15,@01)                          02S0423
*              END;                                             02S0424
*          END;                                                 02S0425
*        ELSE                           /*TIOT MANAGER ERROR         */
*          DO;                                                  02S0426
         B     @RC00404                                         02S0426
@RF00404 DS    0H                                               02S0427
*            RETCODE = ERROR;           /*SET ERROR RETURN CODE      */
         LA    @15,4                                            02S0427
         LR    RETCODE,@15                                      02S0427
*            EREQCODE = RLSERR;         /*SET ERROR REASON CODE      */
         L     @14,@PC00001                                     02S0428
         L     @01,EREQPTR(,@14)                                02S0428
         STH   @15,EREQCODE(,@01)                               02S0428
*          END;                                                 02S0429
*      END;                                                     02S0430
*    ELSE                               /*GETMAIN ERROR              */
*      DO;                                                      02S0431
         B     @RC00387                                         02S0431
@RF00387 DS    0H                                               02S0432
*        RETCODE = ERROR;               /*SET ERROR RETURN CODE      */
         LA    RETCODE,4                                        02S0432
*        EREQCODE = GETMERR;            /*SET ERROR REASON CODE      */
         L     @15,@PC00001                                     02S0433
         L     @01,EREQPTR(,@15)                                02S0433
         MVC   EREQCODE(2,@01),@CH00094                         02S0433
*      END;                                                     02S0434
*  END;                                                         02S0435
*ELSE                                   /*TIOT MANAGER ERROR         */
*  DO;                                                          02S0436
         B     @RC00357                                         02S0436
@RF00357 DS    0H                                               02S0437
*    RETCODE = ERROR;                   /*SET ERROR RETURN CODE      */
         LA    RETCODE,4                                        02S0437
*    EREQCODE = NOSPACE;                /*SET ERROR REASON CODE      */
         L     @15,@PC00001                                     02S0438
         L     @01,EREQPTR(,@15)                                02S0438
         MVC   EREQCODE(2,@01),@CH00338                         02S0438
*  END;                                                         02S0439
*      END;                                                     01S0440
@RC00357 DS    0H                                               01S0441
*RETURN CODE(RETCODE);                                          01S0441
@RF00348 DS    0H                                               01S0441
@RC00341 DS    0H                                               01S0441
@RC00062 IC    @02,@OLDKEY                                      01S0441
         L     @13,4(,@13)                                      01S0441
         L     @00,@SIZDATD                                     01S0441
         LR    @01,@11                                          01S0441
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@10                                          01S0441
         L     @14,12(,@13)                                     01S0441
         LM    @00,@12,20(@13)                                  01S0441
         BR    @14                                              01S0441
*END IEFAB428                                                   01S0442
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A428SPEC)                                        *
*/*%INCLUDE SYSLIB  (A428DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFZB430)                                        *
*/*%INCLUDE SYSLIB  (IEFZB447)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IHADSAB )                                        *
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                        *
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        *
*/*%INCLUDE SYSLIB  (IEFZB424)                                        *
*/*%INCLUDE SYSLIB  (UPDSBDAT)                                        *
*/*%INCLUDE SYSLIB  (UPDTDSAB)                                        *
*/*%INCLUDE SYSLIB  (UPDSBSPC)                                        *
*/*%INCLUDE SYSLIB  (ETBSETUP)                                        *
*/*%INCLUDE SYSLIB  (ETBSUSPC)                                        *
*/*%INCLUDE SYSLIB  (MVTIOTDD)                                        *
*/*%INCLUDE SYSLIB  (MVDDSPEC)                                        *
*;                                                              01S0442
@DATA    DS    0H
@CH00094 DC    H'2'
@CH00071 DC    H'3'
@CH00338 DC    H'6'
@CH00578 DC    H'7'
@CH00051 DC    H'16'
@SM01293 MVC   DSABANAM+1(0,@14),SCTANAME(@01)
@SM01295 MVC   DSABANAM(0,@14),JFCBDSNM(@01)
@SX01301 XC    TIOENTRY(0,@15),TIOENTRY(@15)
@SM01308 MVC   TIOENTRY(0,@15),TIOENTRY(@14)
@SM01310 MVC   DSABGIDL(0,@14),DSABGIDL(@09)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@AL00001 DS    2A
@TF00001 DS    F
IEFAB428 CSECT
         DS    0F
@CF01288 DC    F'253'
@CF01312 DC    F'-4'
@DATD    DSECT
         DS    0D
DSABPTR  DS    A
JFCBPTR  DS    A
SIOTPTR  DS    A
TEMPTIOP DS    A
TEMPIDP  DS    A
TIORBPTR DS    A
TIOTPTR  DS    A
TCBJSCB  DS    A
CORBYTES DS    F
GETLEN   DS    F
SUBPL    DS    F
GTSTRTCD DS    F
FREELEN  DS    CL4
         ORG   FREELEN
SUBPL1   DS    AL1
LENG     DS    AL3
         ORG   FREELEN+4
DSBNAMSW DS    BL1
GOTGRSW  DS    BL1
GRIDSW   DS    BL1
         DS    CL1
TIOTRB   DS    CL38
@OLDKEY  DS    AL1
IEFAB428 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV01260 DC    V(IEFAB4E9)
@CV01261 DC    V(IEFAB4FC)
         DS    0D
DEVENTLN DC    AL4(4)
DSABLENG DC    AL4(72)
GRIDLEN  DC    AL4(4)
HDRLEN   DC    AL4(4)
GTSTZERO DC    F'0'
@CC01243 DC    C'DSAB'
BLANKS8  DC    CL8' '
AMPRSAND DC    CL1'&&'
BLANK    DC    CL1' '
IEFAB428 CSECT
         DS   0H
A428PTCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB428 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GMRETCOD EQU   @02
ENDPTR   EQU   @02
RETCODE  EQU   @10
NEWPOS   EQU   @02
UCBPTR   EQU   @02
QDBPTR   EQU   @02
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
ETIOTREQ EQU   0
EREQMAP  EQU   ETIOTREQ
EREQBLD  EQU   EREQMAP
EREQUPD  EQU   EREQMAP
EREQMOVE EQU   EREQMAP
EREQSTAT EQU   ETIOTREQ+2
EREQTERM EQU   EREQSTAT
EREQQNM  EQU   EREQSTAT
EREQVAM  EQU   EREQSTAT
EREQUNAL EQU   EREQSTAT
EREQPASS EQU   EREQSTAT
EREQJSCT EQU   EREQSTAT
EREQCATL EQU   EREQSTAT
EREQDDNM EQU   ETIOTREQ+4
EREQJSVA EQU   ETIOTREQ+12
EREQSSVA EQU   ETIOTREQ+16
EREQSIOT EQU   ETIOTREQ+20
EREQUCB  EQU   ETIOTREQ+24
EREQRPOS EQU   ETIOTREQ+28
EREQDEVS EQU   ETIOTREQ+30
EREQGRID EQU   ETIOTREQ+32
EREQCODE EQU   ETIOTREQ+40
PRMESTAE EQU   0
PRMRESC  EQU   PRMESTAE+252
PRMFUNC  EQU   PRMESTAE+253
UPDSABCK EQU   PRMFUNC
DSABCHN  EQU   PRMFUNC
PRMSIOTP EQU   PRMESTAE+256
PRMQDBP  EQU   PRMESTAE+276
PRMDSQL  EQU   PRMESTAE+280
PRMDSQF  EQU   PRMESTAE+284
PRMNELM  EQU   PRMESTAE+288
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTBYT1 EQU   INDMSIOT+43
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SPVTAMSG EQU   SIOTBYT0
SCTSDISP EQU   INDMSIOT+55
SIOTPRIV EQU   SCTSDISP
SCTSBYT1 EQU   INDMSIOT+56
SIOTCCAT EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SCTSBYT2 EQU   INDMSIOT+57
SCTJOBLB EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTSBYT3 EQU   INDMSIOT+58
SCTSBYT4 EQU   INDMSIOT+59
SCTSGDGS EQU   SCTSBYT4
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTGALL EQU   SIOTBYT2
SCTANAME EQU   INDMSIOT+122
SIOTETIO EQU   INDMSIOT+148
SJFCBPTR EQU   INDMSIOT+156
DSAB     EQU   0
DSABID   EQU   DSAB
DSABFCHN EQU   DSAB+4
DSABBCHN EQU   DSAB+8
DSABLNTH EQU   DSAB+12
DSABTIOT EQU   DSAB+16
DSABSSVA EQU   DSAB+21
DSABGIDP EQU   DSAB+24
DSABANMP EQU   DSAB+28
DSABORG  EQU   DSAB+32
DSABORG1 EQU   DSABORG
DSABORG2 EQU   DSABORG+1
DSABFLG1 EQU   DSAB+34
DSABCATM EQU   DSABFLG1
DSABFLG2 EQU   DSAB+35
DSABUNAL EQU   DSABFLG2
DSABFLG3 EQU   DSAB+36
DSABDEFR EQU   DSABFLG3
DSABPASS EQU   DSABFLG3
DSABVAM  EQU   DSABFLG3
DSABCATL EQU   DSABFLG3
DSABJSCT EQU   DSABFLG3
DSABFLG4 EQU   DSAB+37
DSABANMI EQU   0
DSABANML EQU   DSABANMI
DSABANAM EQU   DSABANMI+1
DSABGIDL EQU   0
DSABLLEN EQU   DSABGIDL
DSABGRID EQU   DSABGIDL+4
TIOT1    EQU   0
TIOENTRY EQU   0
TIOELNGH EQU   TIOENTRY
TIOESTTA EQU   TIOENTRY+1
TIOSJBLB EQU   TIOESTTA
TIOSDSP1 EQU   TIOESTTA
TIOSDSP2 EQU   TIOESTTA
TIOERLOC EQU   TIOENTRY+2
TIOEWTCT EQU   TIOERLOC
TIOELINK EQU   TIOERLOC+1
TIOTTERM EQU   TIOELINK
TIOEQNAM EQU   TIOELINK
TIOESYOT EQU   TIOELINK
TIOEDDNM EQU   TIOENTRY+4
TIOEJFCB EQU   TIOENTRY+12
TIOESTTC EQU   TIOENTRY+15
TIOESTTB EQU   TIOENTRY+16
POOLSTAR EQU   TIOENTRY+20
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00034 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
TIOMGRRB EQU   0
TIOMFMAP EQU   TIOMGRRB
TIOMALOC EQU   TIOMFMAP
TIOMRLSE EQU   TIOMFMAP
TIOMTSZE EQU   TIOMGRRB+2
TIOMJSCP EQU   TIOMGRRB+4
TIOMENTP EQU   TIOMGRRB+16
TIOMRETP EQU   TIOMGRRB+28
IHAQDB   EQU   0
DSQNELMS EQU   IHAQDB+8
DSQFRSTP EQU   IHAQDB+12
DSQLASTP EQU   IHAQDB+16
LASTCHAR EQU   0
UCBBGN   EQU   0
EREQPTR  EQU   0
JSCBPTR  EQU   0
EXITPRMP EQU   0
TIOEDEVE EQU   TIOESTTB
TIOSTTB  EQU   TIOEDEVE
TIOUSED  EQU   TIOSTTB
TIOUCBP  EQU   TIOEDEVE+1
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00033 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCRSV23 EQU   JFCOPTCD
JFCREORG EQU   JFCRSV23
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCDSABQ EQU   JSCBSEC3+60
JSCSCT   EQU   JSCBSEC3+68
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV35 EQU   JSCBSEC3+96
JSCRSV36 EQU   JSCRSV35
JSCRSV37 EQU   JSCRSV35+2
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
TIOMELEN EQU   TIOMTSZE
TIOMNDSA EQU   TIOMTSZE
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCRSV41 EQU   JSCRSV37+1
JSCRSV40 EQU   JSCRSV37
JSCRSV39 EQU   JSCRSV36+1
JSCRSV38 EQU   JSCRSV36
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00042 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00041 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCRSV25 EQU   JSCBSEC3+10
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBSPNM EQU   JFCBS001+45
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCRSV41 EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00038 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCRSV24 EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00037 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00036 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00033
UCBSKPFG EQU   @NM00033
UCBRIPND EQU   @NM00033
UCBRTIAC EQU   @NM00033
UCBRSV79 EQU   @NM00033
UCBRSV78 EQU   @NM00033
UCBRSV77 EQU   @NM00033
UCBOLTEP EQU   @NM00033
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00032 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
TIOVERF  EQU   TIOSTTB
TIOUNLD  EQU   TIOSTTB
TIOMNTD  EQU   TIOSTTB
TIOSETU  EQU   TIOSTTB
TIOVLSR  EQU   TIOSTTB
TIOPVIO  EQU   TIOSTTB
TIOREQD  EQU   TIOSTTB
@NM00051 EQU   IHAQDB
TIOMIUSL EQU   TIOMGRRB+36
TIOMPSNP EQU   TIOMGRRB+32
TIOMSIOP EQU   TIOMGRRB+24
TIOMDSAP EQU   TIOMGRRB+20
TIOMSNMP EQU   TIOMGRRB+12
TIOMJNMP EQU   TIOMGRRB+8
@NM00050 EQU   TIOMFMAP+1
@NM00049 EQU   TIOMFMAP+1
@NM00048 EQU   TIOMFMAP+1
@NM00047 EQU   TIOMFMAP+1
@NM00046 EQU   TIOMFMAP+1
@NM00045 EQU   TIOMFMAP+1
@NM00044 EQU   TIOMFMAP+1
TIOMRENT EQU   TIOMFMAP+1
TIOMFREE EQU   TIOMFMAP
TIOMUNAL EQU   TIOMFMAP
TIOMCCAT EQU   TIOMFMAP
TIOMUPD  EQU   TIOMFMAP
@NM00043 EQU   TIOMFMAP
TIOMBLD  EQU   TIOMFMAP
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00040 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00039 EQU   IEZJSCB
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00035 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00034
UCBHALI  EQU   @NM00034
UCBRSV09 EQU   @NM00034
UCBRSV08 EQU   @NM00034
UCBRSV07 EQU   @NM00034
UCBRSV06 EQU   @NM00034
UCBRSV05 EQU   @NM00034
UCBRSV04 EQU   @NM00034
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00031 EQU   UCB
TIOTFEND EQU   POOLSTAR+16
TIOPSLOT EQU   POOLSTAR+13
TIOPSTTB EQU   POOLSTAR+12
TIOPPOOL EQU   POOLSTAR+4
TIOPNSRT EQU   POOLSTAR+3
@NM00030 EQU   POOLSTAR+2
TIOPNSLT EQU   POOLSTAR+1
@NM00029 EQU   POOLSTAR
TIOEFSRT EQU   TIOENTRY+17
TIOSVERF EQU   TIOESTTB
TIOSUNLD EQU   TIOESTTB
TIOSMNTD EQU   TIOESTTB
TIOSSETU EQU   TIOESTTB
TIOSVLSR EQU   TIOESTTB
TIOSPVIO EQU   TIOESTTB
TIOSREQD EQU   TIOESTTB
TIOSUSED EQU   TIOESTTB
TIOSBALS EQU   TIOESTTC
TIOSBALP EQU   TIOESTTC
TIOSVOLS EQU   TIOESTTC
TIOSVOLP EQU   TIOESTTC
TIOSAFFS EQU   TIOESTTC
TIOSAFFP EQU   TIOESTTC
TIOSDEFR EQU   TIOESTTC
TIOSDKCR EQU   TIOESTTC
TIOTREM  EQU   TIOELINK
TIOESSDS EQU   TIOESYOT
TIOESYIN EQU   TIOELINK
TIOEDYNM EQU   TIOELINK
TIOTRV01 EQU   TIOELINK
TIOSYOUT EQU   TIOELINK
TIOSLABL EQU   TIOESTTA
TIOSDADS EQU   TIOESTTA
TIOSPLTS EQU   TIOESTTA
TIOSPLTP EQU   TIOESTTA
TIOSLTYP EQU   TIOESTTA
TIOCSTEP EQU   TIOT1+8
TIOCNJOB EQU   TIOT1
DSABRS04 EQU   DSAB+68
DSABSIOT EQU   DSAB+64
DSABRS03 EQU   DSAB+62
DSABDCBM EQU   DSAB+56
DSABSSCM EQU   DSAB+52
DSABSSNM EQU   DSAB+48
DSABPTTR EQU   DSAB+44
DSABTCBP EQU   DSAB+40
DSABRS02 EQU   DSAB+38
@NM00028 EQU   DSABFLG4
DSABCKSI EQU   DSABFLG4
DSABCKVL EQU   DSABFLG4
DSABCKDS EQU   DSABFLG4
@NM00027 EQU   DSABFLG3
DSABVMSC EQU   DSABFLG3
@NM00026 EQU   DSABFLG2
DSABIRM  EQU   DSABFLG2
DSABOPEN EQU   DSABFLG2
DSABNUSE EQU   DSABFLG1
DSABPCAT EQU   DSABFLG1
DSABDCAT EQU   DSABFLG1
DSABCONV EQU   DSABFLG1
DSABDCNV EQU   DSABFLG1
DSABPALC EQU   DSABFLG1
DSABDALC EQU   DSABFLG1
@NM00025 EQU   DSABORG2
DSABTR   EQU   DSABORG2
DSABAM   EQU   DSABORG2
@NM00024 EQU   DSABORG2
DSABTQ   EQU   DSABORG2
DSABTX   EQU   DSABORG2
DSABGS   EQU   DSABORG2
DSABU    EQU   DSABORG1
DSABPO   EQU   DSABORG1
DSABMQ   EQU   DSABORG1
DSABCQ   EQU   DSABORG1
DSABCX   EQU   DSABORG1
DSABDA   EQU   DSABORG1
DSABPS   EQU   DSABORG1
DSABIS   EQU   DSABORG1
DSABRS01 EQU   DSAB+20
DSABOPCT EQU   DSAB+14
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SIOTNPTR EQU   INDMSIOT+152
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
@NM00023 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
SIODDQCR EQU   SIOTBYT2
SIOVDQCR EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00022 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00021 EQU   SIOTALTD
@NM00020 EQU   SIOTALTD
@NM00019 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00018 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00017 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00016 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00015 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
@NM00014 EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
@NM00013 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00012 EQU   SIOTTSTC
@NM00011 EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00010 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00009 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00008 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
PRMQMBP  EQU   PRMESTAE+272
PRMQMBLN EQU   PRMESTAE+268
PRMQMGP  EQU   PRMESTAE+264
PRMUCBP  EQU   PRMESTAE+260
PRMASID  EQU   PRMESTAE+254
@NM00007 EQU   PRMFUNC
VMVCALL  EQU   PRMFUNC
FREECORE EQU   PRMFUNC
DUMPOK   EQU   PRMFUNC
TIOTBLT  EQU   PRMFUNC
GENCLNUP EQU   PRMFUNC
@NM00006 EQU   PRMRESC
TPQ      EQU   PRMRESC
DSSUNREC EQU   PRMRESC
DSSTAP   EQU   PRMRESC
CHNGQ    EQU   PRMRESC
DDRQ     EQU   PRMRESC
ENQQ4    EQU   PRMRESC
@NM00005 EQU   PRMESTAE
EREQJSCB EQU   ETIOTREQ+36
@NM00004 EQU   ETIOTREQ+19
@NM00003 EQU   ETIOTREQ+15
@NM00002 EQU   EREQSTAT
@NM00001 EQU   EREQMAP
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00119 EQU   @RC00093
@RC00214 EQU   @RC00124
@RC00293 EQU   @RC00091
@RF00338 EQU   @RC00062
@RF00345 EQU   @RC00341
@RC00387 EQU   @RC00357
@RC00224 EQU   @RC00214
@RC00404 EQU   @RC00387
@RF00285 EQU   @RC00224
@RF00407 EQU   @RC00404
@ENDDATA EQU   *
         END   IEFAB428,(C'PLS1857',0701,75268)

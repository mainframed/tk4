         TITLE 'IEFAB423 - DETERMINE DEVICE REQUIREMENTS               *
                        '
IEFAB423 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB423  78.128'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(4),0(@01)                               01S0001
         MODESET EXTKEY=SCHED
*ERRORWD=ZERO;                                                  01S0035
         SLR   ERRORWD,ERRORWD                                  01S0035
*GLENGTH=LENGTH(VOLUNRB)*TOTREQS;      /*LENGTH FOR GETMAIN OF REQUEST
*                                        BLOCKS                      */
         L     @10,@PC00001                                     01S0036
         L     @10,ALCWAPTR(,@10)                               01S0036
         L     @10,TOTREQS(,@10)                                01S0036
         MH    @10,@CH00673                                     01S0036
         ST    @10,GLENGTH                                      01S0036
* /* ?GETSTORG (SPID,GLENGTH,RBPTR);*/                          01S0037
*   /* DEFINITIONS OF GETMAIN PARMS */                          01S0037
*   DCL                                                         01S0037
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               01S0037
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               01S0037
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               01S0037
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               01S0037
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               01S0037
*   DCL                                                         01S0038
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               01S0038
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               01S0038
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               01S0038
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               01S0038
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               01S0038
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               01S0038
*     GTSTZERO FIXED(31) INIT(0),                               01S0038
*     GTST253  FIXED(31) CONSTANT(253);                         01S0038
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               01S0039
*   GTSTR0 = GLENGTH; /* SET AMOUNT*/                           01S0040
         LR    GTSTR0,@10                                       01S0040
*   GTSTR2 = SPID; /* SET SUBPOOL*/                             01S0041
         LA    GTSTR2,230                                       01S0041
*   GENERATE CODE;                                              01S0042
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               01S0043
         ST    GTSTR15,GTSTRTCD                                 01S0043
*   RBPTR = GTSTR1; /* ADDR OF GOTN STORG*/                     01S0044
         LR    RBPTR,GTSTR1                                     01S0044
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                01S0045
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               01S0046
         L     @10,GTSTRTCD                                     01S0046
         LTR   @10,@10                                          01S0046
         BNZ   @RF00046                                         01S0046
*     DO;               /* YES, CLEAR STORAGE.*/                01S0047
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       01S0048
*                          GTSTR7,GTSTR8) RSTD;                 01S0048
*       GTSTR4 = RBPTR; /*STORG PTR*/                           01S0049
         LR    GTSTR4,RBPTR                                     01S0049
*       GTSTR5 = GLENGTH; /*STORG AMNT*/                        01S0050
         L     GTSTR5,GLENGTH                                   01S0050
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               01S0051
         SLR   GTSTR7,GTSTR7                                    01S0051
*       IF SPID = GTST253 THEN                                  01S0052
         B     @RF00052                                         01S0052
*      GEN                                                      01S0053
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           01S0053
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*       GEN REFS(GTSTR4,GTSTR6);                                01S0054
@RF00052 DS    0H                                               01S0054
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*       IF SPID = GTST253 THEN                                  01S0055
         B     @RF00055                                         01S0055
*         GEN (MODESET KEYADDR=(2));                            01S0056
         MODESET KEYADDR=(2)
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       01S0057
*                          GTSTR7,GTSTR8) UNRSTD;               01S0057
@RF00055 DS    0H                                               01S0058
*     END;       /* STORAGE CLEARING COMPLETED */               01S0058
*   ELSE                                                        01S0059
*   RBPTR= 0;   /* CLEAR RETURN ADDR. */                        01S0059
         B     @RC00046                                         01S0059
@RF00046 SLR   RBPTR,RBPTR                                      01S0059
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               01S0060
@RC00046 L     GTSTR15,GTSTRTCD                                 01S0060
*                                      /* RESTORE LIST PRINT STATUS  */
*       /*GET CORE FOR REQUEST BLOCKS */                        01S0061
*ERRORWD=REG15;                                                 01S0061
         LR    ERRORWD,REG15                                    01S0061
*IF ERRORWD=ZERO THEN                                           01S0062
         LTR   ERRORWD,ERRORWD                                  01S0062
         BNZ   @RF00062                                         01S0062
*  DO;                                                          01S0063
*    TRBPTR=RBPTR;                     /*SAVE ADDRESS OF REQUEST CORE*/
         ST    RBPTR,TRBPTR                                     01S0064
*    SIOTPTR=SIOT1P;                   /*INIT. ADDR. OF FIRST SIOT   */
         L     @10,@PC00001                                     01S0065
         L     @10,ALCWAPTR(,@10)                               01S0065
         L     SIOTPTR,SIOT1P(,@10)                             01S0065
*    DO I=ONE TO NUMREQS WHILE (ERRORWD = ZERO);                01S0066
         LA    I,1                                              01S0066
         B     @DE00066                                         01S0066
@DL00066 LTR   ERRORWD,ERRORWD                                  01S0066
         BNZ   @DC00066                                         01S0066
*                                      /*LOOP THROUGH EACH SIOT      */
*      IF SIOTALCD = OFF THEN          /*SIOT NOT PROCESSED          */
         TM    SIOTALCD(SIOTPTR),B'00000010'                    01S0067
         BNZ   @RF00067                                         01S0067
*        DO;                                                    01S0068
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BVOLUNRB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD VOLUNIT REQUEST BLOCK                   */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS ROUTINE IS TO CONSTRUCT A VOLUNIT REQUEST */
*/*   BLOCK(VRB) FOR A GIVEN SIOT PASSED AS INPUT. THE VRBS WILL BE  */
*/*   USED BY BLDVOLUN TO CONSTRUCT THE VOLUNIT TABLE. INFORMATION   */
*/*   IS EXTRACTED FROM THE SIOT AND JFCB AND CONSOLIDATED IN THE    */
*/*   VRB.                                                           */
*/*   THE VOLUME SEQUENCE NUMBER FROM THE JFCB (JFCBVLSQ) IS @ZA07134*/
*/*   CHECKED FOR VALIDITY WITH RESPECT TO THE NUMBER OF     @ZA07134*/
*/*   VOLUME SERIAL NUMBERS SPECIFIED OR IMPLIED IN THE SIOT @ZA07134*/
*/*   (SCTVOLCT).  SCTVOLCT OF ZERO INDICATES A NON-SPECIFIC @ZA07134*/
*/*   REQUEST.  A VOLUME SEQUENCE NUMBER OF ONE IS VALID IN  @ZA07134*/
*/*   THIS SPECIAL CASE.                                     @ZA07134*/
*/*   IN ADDITION THE FOLLOWING FIELDS IN THE SIOT ARE UPDATED:      */
*/*     SIOTOTUN - IF PARALLEL MOUNTING WAS SPECIFIED, SET TO MAX    */
*/*               (VOLUME COUNT, NUMBER OF SERIALS). IF UNIT AFFINITY*/
*/*               SET TO SIOTOTUN FROM AFF SIOT.                     */
*/*   THIS ROUTINE ALSO CHECKS FOR NEW, D.A., DEFER. IF              */
*/*   FINDING THIS CONDITION IT IGNORES DEFER. THIS                  */
*/*   ROUTINE ALSO CHECKS FOR NEW, UNIT AFF., D.A. IF                */
*/*   FOUND THIS REQUEST IS IN ERROR AND ALLOCATION IS               */
*/*   FAILED.  IF THE REQUEST IS ALSO ELIGIBLE FOR TAPE,             */
*/*   A BIT IN THE SIOT IS SET (SIOTFUDA) INDICATING                 */
*/*   D.A. IS NOT ELIGIBLE.                                          */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     SIOT                                                         */
*/*     JFCB - POINTER TO THE VRB TO BE CONSTRUCTED                  */
*/*                                                                  */
*/* EXIT -                                                           */
*/* 1 CONDITION - VRBS SUCCESSFULLY BUILT                            */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     VOLUNIT REQUEST BLOCK (VRB) - SEE A423DATA                   */
*/*       ALL FIELDS FILLED IN                                       */
*/*                                                                  */
*/*     SIOT -                                                       */
*/*       SIOTOTUN                                                   */
*/*       SCTUTYPE                                                   */
*/*       SIOTFUDA                                                   */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/* 2 CONDITION - PARALLEL MOUNTING REQUEST REQUIRES OVER 59 UNITS   */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     SIOT -                                                       */
*/*       SIOTRSNC - 9 = TOO MANY UNITS REQUIRED                     */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/* 3 CONDITION - NEW DATA SET REQUEST FOR UNIT AFF AND D.A.         */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     SIOT -                                                       */
*/*       SIOTRSNC - 15 = INVALID UNIT AFF                           */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/********************************************************************/
*JFCBPTR = SJFCBPTR;                   /* SET JFCB BASE              */
         L     JFCBPTR,SJFCBPTR(,SIOTPTR)                       02S0069
*NXTVRB = RBPTR + LENGTH(VOLUNRB);     /* SET CHAIN POINTER          */
         LA    @10,28                                           02S0070
         ALR   @10,RBPTR                                        02S0070
         ST    @10,NXTVRB(,RBPTR)                               02S0070
*SIOTOTUN = SCTNMBUT;                  /* INIT. TOTAL #UNITS         */
         MVC   SIOTOTUN(1,SIOTPTR),SCTNMBUT(SIOTPTR)            02S0071
*IF SCTSNEW = ON &                     /* NEW DIRECT ACCESS DATA SETS*/
*   SCTDEFER = ON &                    /* CANNOT BE DEFER MOUNTED    */
*   SIO3DACC = ON THEN                                          02S0072
         TM    SCTSNEW(SIOTPTR),B'00000100'                     02S0072
         BNO   @RF00072                                         02S0072
         TM    SCTDEFER(SIOTPTR),B'00000010'                    02S0072
         BNO   @RF00072                                         02S0072
         TM    SIO3DACC(SIOTPTR),B'00100000'                    02S0072
         BNO   @RF00072                                         02S0072
*  IF SIO3TAPE ^= ON THEN              /* NOT ELIGIBLE FOR TAPE TOO  */
         TM    SIO3TAPE(SIOTPTR),B'10000000'                    02S0073
         BO    @RF00073                                         02S0073
*     SCTDEFER = OFF;                  /* IGNORE DEFER               */
         NI    SCTDEFER(SIOTPTR),B'11111101'                    02S0074
*  ELSE                                                         02S0075
*    SIOTFUDA = ON;                    /* MAKE IT TAPE ELIGIBLE ONLY */
         B     @RC00073                                         02S0075
@RF00073 OI    SIOTFUDA(SIOTPTR),B'00100000'                    02S0075
*IF SCTPARLM = ON & (SCTVOLCT > ZERO × SIOTVLCT > ZERO) THEN/*PARALEL
*                                        MOUNT REQUEST               */
@RC00073 DS    0H                                               02S0076
@RF00072 TM    SCTPARLM(SIOTPTR),B'00000100'                    02S0076
         BNO   @RF00076                                         02S0076
         CLI   SCTVOLCT(SIOTPTR),0                              02S0076
         BH    @RT00076                                         02S0076
         CLI   SIOTVLCT(SIOTPTR),0                              02S0076
         BNH   @RF00076                                         02S0076
@RT00076 DS    0H                                               02S0077
*  IF JFCBVLSQ = ZERO × SCTSNEW = ON THEN                       02S0077
         ICM   @10,3,JFCBVLSQ(JFCBPTR)                          02S0077
         BZ    @RT00077                                         02S0077
         TM    SCTSNEW(SIOTPTR),B'00000100'                     02S0077
         BNO   @RF00077                                         02S0077
@RT00077 DS    0H                                               02S0078
*    DO;                                                        02S0078
*      SIOTOTUN = MAX(SCTVOLCT,SIOTVLCT);/* SET TOTALS UNITS REQUIRED*/
         SLR   @10,@10                                          02S0079
         IC    @10,SCTVOLCT(,SIOTPTR)                           02S0079
         SLR   @08,@08                                          02S0079
         IC    @08,SIOTVLCT(,SIOTPTR)                           02S0079
         CR    @10,@08                                          02S0079
         BNL   *+6
         LR    @10,@08                                          02S0079
         STC   @10,SIOTOTUN(,SIOTPTR)                           02S0079
*      IF SIOTOTUN > MAXUNIT THEN                               02S0080
         CLI   SIOTOTUN(SIOTPTR),59                             02S0080
         BNH   @RF00080                                         02S0080
*        DO;                                                    02S0081
*          ERRORWD = BVOLFAIL;                                  02S0082
         LA    ERRORWD,4                                        02S0082
*          SIOTRSNC = OVER59U;                                  02S0083
         MVC   SIOTRSNC(2,SIOTPTR),@CH00094                     02S0083
*        END;                                                   02S0084
*    END;                                                       02S0085
@RF00080 DS    0H                                               02S0086
*IF SCTUNAFF = ON THEN                 /* UNIT AFF SPECIFIED         */
@RF00077 DS    0H                                               02S0086
@RF00076 TM    SCTUNAFF(SIOTPTR),B'00000010'                    02S0086
         BNO   @RF00086                                         02S0086
*  DO;                                 /* COPY TOTAL UNIT COUNT      */
*    TSIOTPTR = SIOT1P;                /* SET FIRST SIOT POINTER     */
         L     @10,@PC00001                                     02S0088
         L     @10,ALCWAPTR(,@10)                               02S0088
         L     TSIOTPTR,SIOT1P(,@10)                            02S0088
*    DO WHILE(TSIOTPTR->SCTDDINO^=SIOTUNAF); /* FIND AFF DD          */
         B     @DE00089                                         02S0089
@DL00089 DS    0H                                               02S0090
*      TSIOTPTR = TSIOTPTR->SIOTNPTR;  /* FIND NEXT SIOT             */
         L     TSIOTPTR,SIOTNPTR(,TSIOTPTR)                     02S0090
*    END;                                                       02S0091
@DE00089 CLC   SCTDDINO(2,TSIOTPTR),SIOTUNAF(SIOTPTR)           02S0091
         BNE   @DL00089                                         02S0091
*    SIOTOTUN = TSIOTPTR->SIOTOTUN;    /* COPY TOTAL NO. UNITS       */
         MVC   SIOTOTUN(1,SIOTPTR),SIOTOTUN(TSIOTPTR)           02S0092
*    IF SCTSNEW = ON THEN                                       02S0093
         TM    SCTSNEW(SIOTPTR),B'00000100'                     02S0093
         BNO   @RF00093                                         02S0093
*      IF SIO3DACC = ON & SIO3TAPE = OFF THEN /* NEW D.A. UNIT = AFF */
         TM    SIO3DACC(SIOTPTR),B'00100000'                    02S0094
         BNO   @RF00094                                         02S0094
         TM    SIO3TAPE(SIOTPTR),B'10000000'                    02S0094
         BNZ   @RF00094                                         02S0094
*        DO;                           /* IS INVALID                 */
*          SIOTRSNC = FUAFF;           /* FAIL UNIT AFF              */
         MVC   SIOTRSNC(2,SIOTPTR),@CH00038                     02S0096
*          ERRORWD = BVOLFAIL;                                  02S0097
         LA    ERRORWD,4                                        02S0097
*        END;                                                   02S0098
*      ELSE                                                     02S0099
*        DO;                           /* IGNORE USING DIRECT ACCESS */
         B     @RC00094                                         02S0099
@RF00094 DS    0H                                               02S0100
*          SIOTFUDA = ON;                                       02S0100
         OI    SIOTFUDA(SIOTPTR),B'00100000'                    02S0100
*          TSIOTPTR -> SIOTFUDA = ON;                           02S0101
         OI    SIOTFUDA(TSIOTPTR),B'00100000'                   02S0101
*        END;                                                   02S0102
*    ELSE;                                                      02S0103
@RF00093 DS    0H                                               02S0104
*  END;                                                         02S0104
@RC00093 DS    0H                                               02S0105
*IF ERRORWD = ZERO THEN                                         02S0105
@RF00086 LTR   ERRORWD,ERRORWD                                  02S0105
         BNZ   @RF00105                                         02S0105
*  DO;                                                          02S0106
*    VRBJXPTR = SIOTJFX;               /* SET PTR TO FIRST JFCBX     */
         MVC   VRBJXPTR(4,RBPTR),SIOTJFX(SIOTPTR)               02S0107
*    VRBDDNUM = SCTDDINO;              /* SET DD NUMBER FROM SIOT    */
         MVC   VRBDDNUM(2,RBPTR),SCTDDINO(SIOTPTR)              02S0108
*    IF SCTUNAFF = ON THEN             /* UNIT AFFINITY SPECIFIED    */
         TM    SCTUNAFF(SIOTPTR),B'00000010'                    02S0109
         BNO   @RF00109                                         02S0109
*      VRBAFFNO = SIOTUNAF;            /* SET UNIT AFF DD NUMBER     */
         MVC   VRBAFFNO(2,RBPTR),SIOTUNAF(SIOTPTR)              02S0110
*    IF SIOTVAFF = ON THEN             /* INTRA-STEP VOL REF         */
@RF00109 TM    SIOTVAFF(SIOTPTR),B'00000100'                    02S0111
         BNO   @RF00111                                         02S0111
*      VRBREFNO = SIOTREFN;            /* SET REFERENCED DD NUMBER   */
         MVC   VRBREFNO(2,RBPTR),SIOTREFN(SIOTPTR)              02S0112
*    VRBSERNO = SCTVOLCT;              /* SET NO OF VOL SERS SPECIFID*/
@RF00111 MVC   VRBSERNO(1,RBPTR),SCTVOLCT(SIOTPTR)              02S0113
*    VRBVLCNT = SIOTVLCT;              /* SET VOLUME COUNT           */
         MVC   VRBVLCNT(1,RBPTR),SIOTVLCT(SIOTPTR)              02S0114
*    IF SCTVOLCT = ZERO &              /* SET VOLUME         @ZA07134*/
*      JFCBVLSQ = ONE  THEN            /* SEQUENCE NUMBER    @ZA07134*/
         CLI   SCTVOLCT(SIOTPTR),0                              02S0115
         BNE   @RF00115                                         02S0115
         CLC   JFCBVLSQ(2,JFCBPTR),@CH00065                     02S0115
         BNE   @RF00115                                         02S0115
*      VRBVLSEQ = ZERO;                /* (SPECIAL CASE)     @ZA07134*/
         MVI   VRBVLSEQ(RBPTR),X'00'                            02S0116
*    ELSE                              /*                    @ZA07134*/
*      VRBVLSEQ = JFCBVLSQ;            /* (NORMAL CASE)      @ZA07134*/
         B     @RC00115                                         02S0117
@RF00115 MVC   VRBVLSEQ(1,RBPTR),JFCBVLSQ+1(JFCBPTR)            02S0117
*    VRBUNCNT = SIOTOTUN;              /* SET TOTAL UNIT COUNT       */
@RC00115 MVC   VRBUNCNT(1,RBPTR),SIOTOTUN(SIOTPTR)              02S0118
*    VRBSRPTR = ADDR(JFCBVOLS);        /* SET PTR. TO FIRST 5 VOLSERS*/
         LA    @10,JFCBVOLS(,JFCBPTR)                           02S0119
         ST    @10,VRBSRPTR(,RBPTR)                             02S0119
*    VRBSIOTP = ADDR(INDMSIOT);        /* SET PTR. TO SIOT           */
         ST    SIOTPTR,VRBSIOTP(,RBPTR)                         02S0120
*    VRBJXPTR = SIOTJFX;               /* SET PTR. TO JFCBX          */
         MVC   VRBJXPTR(4,RBPTR),SIOTJFX(SIOTPTR)               02S0121
*    IF SIOTPRIV = ON THEN             /* PRIVATE REQUEST            */
         TM    SIOTPRIV(SIOTPTR),B'00100000'                    02S0122
         BNO   @RF00122                                         02S0122
*      PRIVATER = ON;                  /* SET PRIVATE BIT ON         */
         OI    PRIVATER(RBPTR),B'00100000'                      02S0123
*    IF SIOTDLET = ON THEN             /* DISP = DELETE              */
@RF00122 TM    SIOTDLET(SIOTPTR),B'00000100'                    02S0124
         BNO   @RF00124                                         02S0124
*      DISPDELT = ON;                  /* SET DISP=DELETE ON         */
         OI    DISPDELT(RBPTR),B'00010000'                      02S0125
*    IF SCTDEFER = ON THEN             /* DEFER MOUNT REQUEST        */
@RF00124 TM    SCTDEFER(SIOTPTR),B'00000010'                    02S0126
         BNO   @RF00126                                         02S0126
*      DEFERMT = ON;                   /* SET DEFER MOUNT BIT        */
         OI    DEFERMT(RBPTR),B'00001000'                       02S0127
*    IF SCTSNEW = ON THEN              /* DISP = NEW                 */
@RF00126 TM    SCTSNEW(SIOTPTR),B'00000100'                     02S0128
         BNO   @RF00128                                         02S0128
*      DISPNEW = ON;                   /* SET DISP = NEW             */
         OI    DISPNEW(RBPTR),B'00000100'                       02S0129
*    IF SIO3TAPE = ON THEN             /* TAPE DEVICE                */
@RF00128 TM    SIO3TAPE(SIOTPTR),B'10000000'                    02S0130
         BNO   @RF00130                                         02S0130
*      TAPEREQ = ON;                   /* SET TAPE REQUEST ON        */
         OI    TAPEREQ(RBPTR),B'10000000'                       02S0131
*    IF SIO3DACC = ON THEN             /* DIRECT ACCESS REQUEST      */
@RF00130 TM    SIO3DACC(SIOTPTR),B'00100000'                    02S0132
         BNO   @RF00132                                         02S0132
*      DAREQ = ON;                     /* SET DIRECT ACCESS ON       */
         OI    DAREQ(RBPTR),B'00010000'                         02S0133
*    IF SIO3COMM = ON THEN             /* COMMUNICATION REQUEST      */
@RF00132 TM    SIO3COMM(SIOTPTR),B'01000000'                    02S0134
         BNO   @RF00134                                         02S0134
*      COMMREQ = ON;                   /* SET COM. REQUEST ON        */
         OI    COMMREQ(RBPTR),B'01000000'                       02S0135
*    IF SIO3DISP = ON THEN             /* GRAPHICS REQUEST           */
@RF00134 TM    SIO3DISP(SIOTPTR),B'00010000'                    02S0136
         BNO   @RF00136                                         02S0136
*      GRAPHREQ = ON;                  /* SET GRAPHIC REQUEST ON     */
         OI    GRAPHREQ(RBPTR),B'00100000'                      02S0137
*    IF SIO3UREC = ON THEN             /* UNIT RECORD REQUEST        */
@RF00136 TM    SIO3UREC(SIOTPTR),B'00001000'                    02S0138
         BNO   @RF00138                                         02S0138
*      URECREQ = ON;                   /* SET UNIT RECORD REQUEST ON */
         OI    URECREQ(RBPTR),B'00001000'                       02S0139
* END;                                                          02S0140
@RF00138 DS    0H                                               02S0141
*RBPTR = NXTVRB;                       /* POINT TO NEXT VRB          */
@RF00105 L     RBPTR,NXTVRB(,RBPTR)                             02S0141
*        END;                          /*END BUILDING OF ONE BLOCK   */
*      SIOTPTR=SIOTNPTR;               /*GET NEXT SIOT               */
@RF00067 L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       01S0143
*    END;                                                       01S0144
         AH    I,@CH00065                                       01S0144
@DE00066 L     @10,@PC00001                                     01S0144
         L     @10,ALCWAPTR(,@10)                               01S0144
         C     I,NUMREQS(,@10)                                  01S0144
         BNH   @DL00066                                         01S0144
@DC00066 DS    0H                                               01S0145
*    RBPTR=RBPTR-LENGTH(VOLUNRB);      /*POINT TO LAST VRB BUILT     */
         SH    RBPTR,@CH00673                                   01S0145
*/* NOTE:   BVOLUNRB UPDATES TO NEXT ENTRY EACH TIME                 */
*    NXTVRB=ZERO;                      /*ZERO LAST CHAIN PTR         */
         SLR   @10,@10                                          01S0146
         ST    @10,NXTVRB(,RBPTR)                               01S0146
*    IF ERRORWD = ZERO THEN            /*NO ERRORS                   */
         CR    ERRORWD,@10                                      01S0147
         BNE   @RF00147                                         01S0147
*      DO;                                                      01S0148
*/********************************************************************/
*/* SEGMENT NAME - BLDVOLUN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD VOLUNIT TABLE                           */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE IS RESPONSIBLE FOR CONSTRUCTING THE VOLUNIT TABLE.*/
*/*   THE SIZE OF THE VOLUNIT TABLE IS EQUAL TO THE TOTAL NUMBER     */
*/*   OF ENTIRES REQUIRED * 16. EACH REQUEST'S NUMBER OF ENTRIES     */
*/*   IS CALCULATED AS FOLLOWS -                                     */
*/*          . FOR NON-SPECIFIC,NON-PRIVATE DIRECT ACCESS    @YM03990*/
*/*            THE NUMBER OF ENTRIES EQUALS THE UNIT COUNT.          */
*/*                                                                  */
*/*          . FOR SPECIFIC DIRECT ACCESS REQUESTS NON-      @YM03990*/
*/*            SPECIFIC PRIVATE REQUESTS, AND FOR TAPE, THE  @YM03990*/
*/*            NUMBER OF ENTRIES IS EQUAL TO THE GREATER OF NUMBER   */
*/*            OF VOLUME SERIALS (IF A VOLUME SEQUENCE COUNT IS      */
*/*            SPECIFIED, THE NUMBER OF SERIALS IS DECREMENTED BY THE*/
*/*            VOLUME SEQUENCE COUNT -1), VOLUME COUNT, OR UNIT COUNT*/
*/*                                                                  */
*/*   THE VOLUNIT TABLE IS THEN INITIALIZED AS FOLLOWS:              */
*/*          . VOLUME SERIAL NUMBERS ARE INSERTED. SCRATCH SERIALS   */
*/*            ARE GENERATED IF NEEDED (IN THE FORMAT X'FE00NNNNNNNN'*/
*/*            FOR D.A. AND X'FFSVAASID' FOR TAPE WHERE SVA IS THE   */
*/*            JFCB SVA, AND ASID IS THE ASID) IN EACH               */
*/*            REQUESTS VOLUNIT ENTRIES. IF A VOLUME                 */
*/*            SEQUENCE NUMBER IS LESS THAN THE NUMBER OF VOLUME     */
*/*            SERIALS SPECIFIED, ONLY THOSE VOLUME SERIALS INDICATED*/
*/*            BY THE VOLUME SEQUENCE NUMBER ARE INSERTED IN THE     */
*/*            VOLUNIT TABLE. IF THE VOLUME SEQUENCE NUMBER IS       */
*/*            GREATER THAN THE NUMBER OF SERIALS SPECIFIED AN ERROR */
*/*            CONDITION IS SET AND PROCESSING IS TERMINATED. IF A   */
*/*            VOLUME SEQUENCE NUMBER IS SPECIFIED FOR A NEW         */
*/*            DATA SET IT IS IGNORED.                               */
*/*                                                                  */
*/*          . UNITIDS ARE GENERATED FOR EACH VOLUME SERIAL UNTIL    */
*/*            THE UNIT COUNT IS REACHED. AT THIS POINT THE LAST     */
*/*            UNITID IS PROPAGATED FOR THE REQUEST'S REMAINING      */
*/*            VOLUNIT ENTRIES.                                      */
*/*                                                                  */
*/*          . IF UNIT AFFINITY WAS SPECIFIED THE REFERENCED         */
*/*            REQUEST'S UNITIDS ARE COPIED ONE TO ONE WITH THE      */
*/*            LAST UNITID PROPAGATED IF THERE ARE MORE VOLUNIT      */
*/*            ENTRIES PRESENT IN THE REFERENCING REQUEST. FOR NON   */
*/*            D.A., NON TAPE REQUESTS VOLIDS ARE ALSO COPIED MAKING */
*/*            UNIT AFFINITY APPEAR AS VOLUME AFFINITY.              */
*/*                                                                  */
*/*          . IF INTRA-STEP VOLUME REFERENCE TO A NON-SPECIFIC      */
*/*            VOLUME REQUEST IS SPECIFIED, THE REFERENCED           */
*/*            REQUEST'S VOLIDS ARE COPIED ONE TO ONE UNTIL THE      */
*/*            VOLUNIT ENTRY COUNT OF THE REFERENCING REQUEST IS     */
*/*            REACHED. IF MORE VOLIDS ARE NEEDED, NON-SPECIFIC      */
*/*            SERIALS ARE GENERATED (SEE ABOVE).                    */
*/*                                                                  */
*/*   THE VOLUNIT TABLE IS COMPLETED BY RESOLVING VOLUME AFFINITIES  */
*/*   BY CALLING IEFAB426.                                           */
*/*                                                                  */
*/*   STATUS BITS MUST BE SET FOR EACH VOLUNIT ENTRY, THEY ARE       */
*/*          . PUBLIC VOLUME REQUEST                                 */
*/*          . PRIVATE SPECIFIED                                     */
*/*          . SPECIFIC VOLUME REQUEST                               */
*/*          . STORAGE REQUEST                                       */
*/*          . VOLUME/UNIT MUST BE NON-SHAREABLE                     */
*/*          . VOLUME MUST BE MOUNTED BY END OF ALLOCATION           */
*/*          . ETIOT DEVICE ENTRY REQUIRED                           */
*/*                                                                  */
*/* ENTRY POINT - IN-LINE SEGMENT                                    */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     TRBPTR - POINTING TO TOP OF VRB BLOCKS.                      */
*/*                                                                  */
*/* EXITS -                                                          */
*/* 1 CONDITION - VOLUNIT TABLE CONSTRUCTED                          */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     VOLUNIT TABLE CONSTRUCTED                                    */
*/*     ALCWA CONTAINING ADDRESS AND SIZE OF VOLUNIT                 */
*/*     SIOT CONTAINING ADDRESS AND NUMBER OF SUBJECT VOLUNIT ENTRIES*/
*/*        AND POSSIBLY UPDATED UNIT COUNT.                          */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/* 2 CONDITION - CORE NOT AVAILABLE FOR VOLUNIT TABLE               */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     STEP RELATED REASON CODE (STEPRSNC) -                        */
*/*        2 = GETMAIN ERROR                                         */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/* 3 CONDITION - VOLUME SEQUENCE COUNT IS GREATER THAN              */
*/*                THE NUMBER OF SERIALS SPECIFIED                   */
*/*                                                                  */
*/*   OUTPUT DATA -                                                  */
*/*     DD RELATED REASON CODE (SIOTRSNC) -                          */
*/*       11 = INVALID VOLUME SEQUENCE NUMBER                        */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/********************************************************************/
*TOTNUM=ZERO;                          /*TOTAL NO OF VOLUNIT ENTRIES */
         SLR   TOTNUM,TOTNUM                                    02S0149
*RBPTR=TRBPTR;                         /*POINT TO TOP VRB            */
         L     RBPTR,TRBPTR                                     02S0150
*CNTENTRY=ZERO;                        /*INITIALIZE ENTRY COUNTER    */
         SLR   CNTENTRY,CNTENTRY                                02S0151
*DO  WHILE(RBPTR ^=ZERO & ERRORWD=ZERO);/*GET SZE OF VOLUNIT THRU VRB*/
         B     @DE00152                                         02S0152
@DL00152 DS    0H                                               02S0153
*  SERPTR=VRBSRPTR;                                             02S0153
         L     SERPTR,VRBSRPTR(,RBPTR)                          02S0153
*  IF VRBVLSEQ ^=ZERO & DISPNEW = OFF THEN  /* VOL SEQ SPECIFIED     */
         CLI   VRBVLSEQ(RBPTR),0                                02S0154
         BE    @RF00154                                         02S0154
         TM    DISPNEW(RBPTR),B'00000100'                       02S0154
         BNZ   @RF00154                                         02S0154
*    IF VRBVLSEQ <= VRBSERNO &SERIAL(1,1) ^=TAPEGEND THEN /*VALID SEQ*/
         CLC   VRBVLSEQ(1,RBPTR),VRBSERNO(RBPTR)                02S0155
         BH    @RF00155                                         02S0155
         CLC   SERIAL(1,SERPTR),TAPEGEND                        02S0155
         BE    @RF00155                                         02S0155
*      DO;                                                      02S0156
*        TEMSERNO = VRBSERNO - VRBVLSEQ + ONE; /* #OF SERIALS - SEQ. */
         SLR   TEMSERNO,TEMSERNO                                02S0157
         IC    TEMSERNO,VRBSERNO(,RBPTR)                        02S0157
         SLR   @10,@10                                          02S0157
         IC    @10,VRBVLSEQ(,RBPTR)                             02S0157
         SLR   TEMSERNO,@10                                     02S0157
         LA    TEMSERNO,1(,TEMSERNO)                            02S0157
*        IF VRBSIOTP -> SCTPARLM = ON THEN  /*PARALLEL MOUNT WANTED  */
         L     @10,VRBSIOTP(,RBPTR)                             02S0158
         TM    SCTPARLM(@10),B'00000100'                        02S0158
         BNO   @RF00158                                         02S0158
*          DO;                                                  02S0159
*            VRBUNCNT = MAX(TEMSERNO,VRBVLCNT); /*CALC. # OF UNITS   */
         SLR   @08,@08                                          02S0160
         IC    @08,VRBVLCNT(,RBPTR)                             02S0160
         CR    @08,TEMSERNO                                     02S0160
         BNL   *+6
         LR    @08,TEMSERNO                                     02S0160
         STC   @08,VRBUNCNT(,RBPTR)                             02S0160
*            VRBSIOTP -> SIOTOTUN = VRBUNCNT;  /*PROPAGATE TO SIOT   */
         STC   @08,SIOTOTUN(,@10)                               02S0161
*            IF VRBSIOTP-> SIOTOTUN > MAXUNIT THEN              02S0162
         CLI   SIOTOTUN(@10),59                                 02S0162
         BNH   @RF00162                                         02S0162
*              DO;                                              02S0163
*                ERRORWD = BLDVFAIL;                            02S0164
         LA    ERRORWD,4                                        02S0164
*                VRBSIOTP -> SIOTRSNC = OVER59U;                02S0165
         MVC   SIOTRSNC(2,@10),@CH00094                         02S0165
*              END;                                             02S0166
*          END;                                                 02S0167
@RF00162 DS    0H                                               02S0168
*        CNTENTRY = MAX(TEMSERNO,VRBUNCNT,VRBVLCNT); /*# OF VOLUNIT
*                                        ENTRIES                     */
@RF00158 SLR   CNTENTRY,CNTENTRY                                02S0168
         IC    CNTENTRY,VRBUNCNT(,RBPTR)                        02S0168
         CR    CNTENTRY,TEMSERNO                                02S0168
         BNL   *+6
         LR    CNTENTRY,TEMSERNO                                02S0168
         SLR   @10,@10                                          02S0168
         IC    @10,VRBVLCNT(,RBPTR)                             02S0168
         CR    CNTENTRY,@10                                     02S0168
         BNL   *+6
         LR    CNTENTRY,@10                                     02S0168
*      END;                                                     02S0169
*    ELSE                              /*INVALID VOL SEQ             */
*      DO;                                                      02S0170
         B     @RC00155                                         02S0170
@RF00155 DS    0H                                               02S0171
*        ERRORWD = SEQERR;             /*INDICATE VOL SEQ ERROR      */
         LA    ERRORWD,4                                        02S0171
*        VRBSIOTP -> SIOTRSNC =VLSEQRSN; /*VOL SEQ REASON CODE       */
         L     @10,VRBSIOTP(,RBPTR)                             02S0172
         MVC   SIOTRSNC(2,@10),@CH00125                         02S0172
*      END;                                                     02S0173
*  ELSE                                /*NO VOL SEQ TO BE DONE       */
*    DO;                                                        02S0174
         B     @RC00154                                         02S0174
@RF00154 DS    0H                                               02S0175
*      IF SERIAL(1,1) =NONSPEC                                  02S0175
*         & (PRIVATER=OFF &            /*NON SPECIFIC NON PRIVATE
*                                                            @YM03990*/
*            TAPEREQ=OFF) THEN         /*NON TAPE            @YM03990*/
         CLI   SERIAL(SERPTR),C' '                              02S0175
         BNE   @RF00175                                         02S0175
         TM    PRIVATER(RBPTR),B'00100000'                      02S0175
         BNZ   @RF00175                                         02S0175
         TM    TAPEREQ(RBPTR),B'10000000'                       02S0175
         BNZ   @RF00175                                         02S0175
*          CNTENTRY= VRBUNCNT;         /*NO. OF SERIALS OR UNIT CNT  */
         SLR   CNTENTRY,CNTENTRY                                02S0176
         IC    CNTENTRY,VRBUNCNT(,RBPTR)                        02S0176
*      ELSE                                                     02S0177
*          IF SERIAL(1,1) = NONSPEC    /*NON-SPECIFIC        @ZA25630*/
*             & TAPEREQ = ON THEN      /*TAPE REQUEST        @ZA25630*/
         B     @RC00175                                         02S0177
@RF00175 CLI   SERIAL(SERPTR),C' '                              02S0177
         BNE   @RF00177                                         02S0177
         TM    TAPEREQ(RBPTR),B'10000000'                       02S0177
         BNO   @RF00177                                         02S0177
*              CNTENTRY = MAX(VRBSERNO,VRBUNCNT);  /*DONT CONSIDER
*                                        THE VOLCOUNT        @ZA25630*/
         SLR   CNTENTRY,CNTENTRY                                02S0178
         IC    CNTENTRY,VRBSERNO(,RBPTR)                        02S0178
         SLR   @10,@10                                          02S0178
         IC    @10,VRBUNCNT(,RBPTR)                             02S0178
         CR    CNTENTRY,@10                                     02S0178
         BNL   *+6
         LR    CNTENTRY,@10                                     02S0178
*          ELSE                        /*                    @ZA25630*/
*              CNTENTRY = MAX(VRBSERNO,VRBUNCNT,VRBVLCNT); /*CONSIDER
*                                        VOLCOUNT                    */
         B     @RC00177                                         02S0179
@RF00177 SLR   CNTENTRY,CNTENTRY                                02S0179
         IC    CNTENTRY,VRBSERNO(,RBPTR)                        02S0179
         SLR   @10,@10                                          02S0179
         IC    @10,VRBUNCNT(,RBPTR)                             02S0179
         CR    CNTENTRY,@10                                     02S0179
         BNL   *+6
         LR    CNTENTRY,@10                                     02S0179
         SLR   @10,@10                                          02S0179
         IC    @10,VRBVLCNT(,RBPTR)                             02S0179
         CR    CNTENTRY,@10                                     02S0179
         BNL   *+6
         LR    CNTENTRY,@10                                     02S0179
*    END;                                                       02S0180
@RC00177 DS    0H                                               02S0180
@RC00175 DS    0H                                               02S0181
*  TOTNUM=TOTNUM+CNTENTRY;             /*RUNNING TOTAL OF ENTRIES    */
@RC00154 ALR   TOTNUM,CNTENTRY                                  02S0181
*  VRBSIOTP ->SVOLUNNO =CNTENTRY;      /*UPDATE NO. ENTRIES IN SIOT  */
         L     @10,VRBSIOTP(,RBPTR)                             02S0182
         STH   CNTENTRY,SVOLUNNO(,@10)                          02S0182
*  RBPTR=NXTVRB;                       /*LOOP TO NEXT VRB            */
         L     RBPTR,NXTVRB(,RBPTR)                             02S0183
*END;                                                           02S0184
@DE00152 SLR   @10,@10                                          02S0184
         CR    RBPTR,@10                                        02S0184
         BE    @DC00152                                         02S0184
         CR    ERRORWD,@10                                      02S0184
         BE    @DL00152                                         02S0184
@DC00152 DS    0H                                               02S0185
* IF ERRORWD = ZERO THEN               /*NO ERRORS                   */
         LTR   ERRORWD,ERRORWD                                  02S0185
         BNZ   @RF00185                                         02S0185
*   DO;                                                         02S0186
*     TOTVOLUN = TOTNUM;               /*TOTAL VU'S IN ALCWA         */
         L     @08,@PC00001                                     02S0187
         L     @08,ALCWAPTR(,@08)                               02S0187
         ST    TOTNUM,TOTVOLUN(,@08)                            02S0187
*     VUSIZE=TOTNUM*LENGTH(VOLUNTAB);  /*TOTAL SIZE OF VOLUNIT TABLE */
         LR    VUSIZE,TOTNUM                                    02S0188
         MH    VUSIZE,@CH00673                                  02S0188
*      /* ?GETSTORG (SPID,VUSIZE,VUPTR);*/                      02S0189
*        RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/          02S0189
*        GTSTR0 = VUSIZE; /* SET AMOUNT*/                       02S0190
         LR    GTSTR0,VUSIZE                                    02S0190
*        GTSTR2 = SPID; /* SET SUBPOOL*/                        02S0191
         LA    GTSTR2,230                                       02S0191
*        GENERATE CODE;                                         02S0192
          GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*        GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/          02S0193
         ST    GTSTR15,GTSTRTCD                                 02S0193
*        VUPTR = GTSTR1; /* ADDR OF GOTN STORG*/                02S0194
         LR    VUPTR,GTSTR1                                     02S0194
*        RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */           02S0195
*        IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */          02S0196
         L     @08,GTSTRTCD                                     02S0196
         LTR   @08,@08                                          02S0196
         BNZ   @RF00196                                         02S0196
*          DO;               /* YES, CLEAR STORAGE.*/           02S0197
*            RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                  02S0198
*                               GTSTR7,GTSTR8) RSTD;            02S0198
*            GTSTR4 = VUPTR; /*STORG PTR*/                      02S0199
         LR    GTSTR4,VUPTR                                     02S0199
*            GTSTR5 = VUSIZE; /*STORG AMNT*/                    02S0200
         LR    GTSTR5,VUSIZE                                    02S0200
*            GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/          02S0201
         SLR   GTSTR7,GTSTR7                                    02S0201
*            IF SPID = GTST253 THEN                             02S0202
         B     @RF00202                                         02S0202
*           GEN                                                 02S0203
*        (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);      02S0203
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*            GEN REFS(GTSTR4,GTSTR6);                           02S0204
@RF00202 DS    0H                                               02S0204
               MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*            IF SPID = GTST253 THEN                             02S0205
         B     @RF00205                                         02S0205
*              GEN (MODESET KEYADDR=(2));                       02S0206
         MODESET KEYADDR=(2)
*            RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                  02S0207
*                               GTSTR7,GTSTR8) UNRSTD;          02S0207
@RF00205 DS    0H                                               02S0208
*          END;       /* STORAGE CLEARING COMPLETED */          02S0208
*        ELSE                                                   02S0209
*        VUPTR= 0;   /* CLEAR RETURN ADDR. */                   02S0209
         B     @RC00196                                         02S0209
@RF00196 SLR   VUPTR,VUPTR                                      02S0209
*        GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */          02S0210
@RC00196 L     GTSTR15,GTSTRTCD                                 02S0210
*                                      /* RESTORE LIST PRINT STATUS  */
*   /*GET CORE FOR VOLUNIT        */                            02S0211
*     IF REG15 = ZERO THEN                                      02S0211
         SLR   @14,@14                                          02S0211
         CR    REG15,@14                                        02S0211
         BNE   @RF00211                                         02S0211
*       DO;                                                     02S0212
*         VOLUNSZE = VUSIZE;           /*VOLUNIT SIZE TO ALCWA       */
         L     @08,@PC00001                                     02S0213
         L     @08,ALCWAPTR(,@08)                               02S0213
         ST    VUSIZE,VOLUNSZE(,@08)                            02S0213
*         NXTVOLID = ZERO;             /*PRIME SCRATCH SERIAL NUMBER */
         ST    @14,NXTVOLID                                     02S0214
*         GENVOL = SCRSER;                                      02S0215
         MVC   GENVOL(2),@CB00120                               02S0215
*         RBPTR=TRBPTR;                /*BASE FOR FIRST VRB          */
         L     RBPTR,TRBPTR                                     02S0216
*         GENFF = TAPEGEND;            /*X'FF' TO BUFFER             */
         MVC   GENFF(1),TAPEGEND                                02S0217
*         VOLUNPTR=VUPTR;              /*BASE FOR START OF VOLUNIT   */
         ST    VUPTR,VOLUNPTR(,@08)                             02S0218
*         DO WHILE(RBPTR^=ZERO);       /*LOOP THRU VRBS              */
         B     @DE00219                                         02S0219
@DL00219 DS    0H                                               02S0220
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - INITVOLN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - FILL IN VOLUNIT ENTRIES                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO INITIALIZE VOLUNIT TABLE    */
*/*   ENTRIES. THIS SEGMENT CONSTRUCTS ALL VOLUNIT ENTRIES FOR A     */
*/*   REQUEST WHERE A REQUEST IS REPRESENTED BY A VOLUNIT            */
*/*   REQUEST BLOCK(VRB).  THE NUMBER OF VOLUNIT ENTRIES IS GIVEN    */
*/*   IN THE SIOT THAT IS ASSOCIATED WITH THE VRB.                   */
*/*                                                                  */
*/*   THE VOLUNIT TABLE ENTRIES ARE SET AS FOLLOWS:                  */
*/*                                                                  */
*/*   1. VOLUME SERIAL NUMBERS ARE INSERTED. IF A VOLUME SEQUENCE    */
*/*      COUNT IS SPECIFIED FOR AN OLD DATA SET ONLY THOSE VOLUME    */
*/*      SERIALS INDICATED BY THE VOLUME SEQUENCE COUNT ARE USED.    */
*/*      IF ANY NON-SPECIFIC VOLUMES ARE NEEDED, THE SERIAL NUMBERS  */
*/*      ARE GENERATED IN THE FORMAT X'FE00NNNNNNNN' WHERE           */
*/*      NNNNNNNN IS A UNIQUE NUMBER FOR EACH GENERATED SERIAL FOR   */
*/*      D.A. FOR TAPE THE SERIAL NUMBER BEGINS WITH AN X'FF' AND    */
*/*      CONTAINS, JFCB SVA AND ASID.                                */
*/*                                                                  */
*/*   2. UNITIDS ARE GENERATED FOR EACH VOLUME SERIAL UNTIL THE      */
*/*      TOTAL NUMBER OF UNITS REQUIRED IS REACHED. AT THIS POINT    */
*/*      THE LAST UNITID IS PROPOGATED FOR THE REQUEST'S REMAINING   */
*/*      VOLUNIT ENTRIES.                                            */
*/*                                                                  */
*/*   3. IF INTRA-STEP VOLUME REFERENCE TO A NON-SPECIFIC VOLUME     */
*/*      REQUEST IS SPECIFIED, THE REFERENCED REQUEST'S VOLIDS ARE   */
*/*      COPIED ONE TO ONE UNTIL THE VOLUNIT ENTRY COUNT OF THE      */
*/*      REFERENCING REQUEST OR THE VOLUNIT ENTRY COUNT OF THE       */
*/*      REFERENCED REQUEST IS REACHED, WHICHEVER IS SMALLER. IF MORE*/
*/*      SERIALS ARE NEEDED, NON-SPECIFIC SERIALS ARE GENERATED.     */
*/*                                                                  */
*/*   4. IF UNIT AFFINITY IS SPECIFIED, THE REFERENCED REQUEST'S     */
*/*      UNITIDS ARE COPIED ONE TO ONE WITH THE LAST UNITID          */
*/*      PROPAGATED IF THERE ARE MORE VOLUNIT ENTRIES PRESENT.       */
*/*      FOR NON D.A. NON TAPE REQUESTS, VOLIDS ARE ALSO COPIED      */
*/*      FORCING VOLUME AFFINITY.                                    */
*/*                                                                  */
*/*   5. STATUS BITS IN THE VOLUNIT TABLE ENTRIES ARE SET.           */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     SIOT -                                                       */
*/*       SVOLUNNO - NO. OF VOLUNIT ENTRIES FOR THIS REQUEST         */
*/*                                                                  */
*/*     VRB'S (VOLUNIT REQUEST BLOCKS)                               */
*/*                                                                  */
*/*     VOLUNIT TABLE ENTRIES                                        */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - VOLUNIT ENTRY INITIALIZED                          */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     SIOT -                                                       */
*/*       SVOLUNAD - PTR. TO FIRST VOLUNIT TABLE ENTRY               */
*/*                                                                  */
*/*     VOLUNIT ENTRY INITIALIZED                                    */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*CNTUNID=ZERO;                         /*UNITID  COUNTER             */
         SLR   @07,@07                                          03S0220
         ST    @07,CNTUNID                                      03S0220
*VRBSIOTP->SVOLUNAD=VUPTR;             /*VU ADDR TO SIOT             */
         L     @01,VRBSIOTP(,RBPTR)                             03S0221
         ST    VUPTR,SVOLUNAD(,@01)                             03S0221
*CNTENTRY=ZERO;                        /*ENTRY COUNTER               */
         SLR   CNTENTRY,CNTENTRY                                03S0222
*SERCNTR=ZERO;                         /*SERIAL NUMBER COUNTER       */
         ST    @07,SERCNTR                                      03S0223
*I=ONE;                                /*INDEX VALUE                 */
         LA    @15,1                                            03S0224
         LR    I,@15                                            03S0224
*SERCTRL=FIVE;                         /*JFCB TO JFCBX CONTROL       */
         LA    @14,5                                            03S0225
         LR    SERCTRL,@14                                      03S0225
*SERPTR=VRBSRPTR;                      /*PTR TO FIRST VOLSER         */
         L     SERPTR,VRBSRPTR(,RBPTR)                          03S0226
*IF VRBVLSEQ ^= ZERO & DISPNEW = OFF THEN/*VOL SEQ FOR OLD DATA SET  */
         CLI   VRBVLSEQ(RBPTR),0                                03S0227
         BE    @RF00227                                         03S0227
         TM    DISPNEW(RBPTR),B'00000100'                       03S0227
         BNZ   @RF00227                                         03S0227
*  DO;                                 /*VOLSEQ WANTED               */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - VLSEQPRC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PROCESS VOLUME SEQUENCE NUMBER                */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO SET UP COUNTERS FOR INITVOLN*/
*/*   SO THAT ONLY THOSE VOLUMES INDICATED BY THE VOLUME SEQUENCE    */
*/*   COUNT ARE PUT IN THE VOLUNIT TABLE. SERIAL NUMBERS PRIOR TO    */
*/*   THE VOLUME SEQUENCE COUNT ARE IGNORED.                         */
*/*                                                                  */
*/*   THE FOLLOWING FUNCTIONS ARE PERFORMED:                         */
*/*                                                                  */
*/*   1. SET THE NUMBER OF VOLSERS ALREADY PROCESSED (SEE INPUT DATA)*/
*/*      THE NUMBER OF VOLSERS ALREADY PROCESSED IS SET TO THE       */
*/*      VOLUME SEQUENCE COUNT - 1.                                  */
*/*                                                                  */
*/*   2. SET THE POSITION OF THE VOLSER IN THE JFCB OR JFCBX THAT    */
*/*      MUST BE PROCESSED.                                          */
*/*                                                                  */
*/*   3. SET THE NUMBER OF VOLUMES TO PROCESS BEFORE ANOTHER JFCBX   */
*/*      MUST BE ACCESSED (SEE INPUT).                               */
*/*      THIS FIELD IS INCREMENTED BY FIFTEEN FOR EACH JFCBX BYPASSED*/
*/*      BECAUSE OF VOLUME SEQUENCE COUNT.                           */
*/*                                                                  */
*/*   4. SET THE BASE FOR VOLUME SERIALS                             */
*/*      SET TO THE ADDRESS OF THE JFCBX THAT CONTAINS THE FIRST     */
*/*      VOLUME INDICATED BY THE VOLUME SEQUENCE COUNT.              */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     VRB (VOLUNIT REQUEST BLOCK) -                                */
*/*       VRBVLSEQ - VOLUME SEQUENCE COUNT                           */
*/*       VRBJXPTR - JFCBX ADDRESS                                   */
*/*                                                                  */
*/*     SERCTRL - NUMBER OF VOLUMES TO PROCESS BEFORE A JFCBX        */
*/*       SHOULD BE OBTAINED.                                        */
*/*                                                                  */
*/*     SERCNTR - NUMBER OF VOLUME SERIALS ALREADY PROCESSED         */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - VOL SEQ PROCESSING COMPLETE                        */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     I - THE NUMBER (WITHIN THE JFCB OR JFCBX) OF THE FIRST       */
*/*         VOLUME TO BE PROCESSED.                                  */
*/*                                                                  */
*/*     SERPTR - BASE ADDRESS FOR VOLUME SERIALS                     */
*/*                                                                  */
*/*     SERCTRL - SEE INPUT                                          */
*/*                                                                  */
*/*     SERCNTR - SEE INPUT                                          */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*IF VRBVLSEQ >FIVE THEN                 /*MUST GO TO JFCBX           */
         CLI   VRBVLSEQ(RBPTR),5                                04S0229
         BNH   @RF00229                                         04S0229
*  DO;                                                          04S0230
*    SERCTRL = SERCTRL + FIFTEEN;       /*ALLOW                      */
         LA    @06,15                                           04S0231
         ALR   SERCTRL,@06                                      04S0231
*    JFXPTR = VRBJXPTR;                 /*BASE OF FIRST JFCBX        */
         MVC   JFXPTR(4),VRBJXPTR(RBPTR)                        04S0232
*    TEMPSEQ = VRBVLSEQ - FIVE;         /*ADJUST FOR JFCBVOLS        */
         LCR   @14,@14                                          04S0233
         SLR   TEMPSEQ,TEMPSEQ                                  04S0233
         IC    TEMPSEQ,VRBVLSEQ(,RBPTR)                         04S0233
         ALR   @14,TEMPSEQ                                      04S0233
         LR    TEMPSEQ,@14                                      04S0233
*    JFXPOS = TEMPSEQ/FIFTEEN;          /*HOW MANY JFCBXS            */
         LR    @01,TEMPSEQ                                      04S0234
         SLR   @00,@00                                          04S0234
         DR    @00,@06                                          04S0234
         LR    JFXPOS,@01                                       04S0234
*    JFXREM = TEMPSEQ//FIFTEEN;         /*REMAINDER IN LAST JFCBX    */
         LR    @00,TEMPSEQ                                      04S0235
         SRDA  @00,32                                           04S0235
         DR    @00,@06                                          04S0235
         LR    JFXREM,@00                                       04S0235
*    IF JFXREM > ZERO THEN              /*ADJUST FOR LAST JFCBX      */
         CR    JFXREM,@07                                       04S0236
         BNH   @RF00236                                         04S0236
*      JFXPOS = JFXPOS + ONE;                                   04S0237
         ALR   JFXPOS,@15                                       04S0237
*    IF JFXPOS > ONE THEN               /*DON'T HAVE CORRECT JFCBX
*                                         YET                        */
@RF00236 LA    @03,1                                            04S0238
         CR    JFXPOS,@03                                       04S0238
         BNH   @RF00238                                         04S0238
*      DO XCTR = ONE TO JFXPOS - ONE;   /*LOOP TILL CORRECT JFCBX    */
         LA    @15,1                                            04S0239
         LR    XCTR,@15                                         04S0239
         B     @DE00239                                         04S0239
@DL00239 DS    0H                                               04S0240
*        JFXPTR = JFCBXNXT;                                     04S0240
         L     @01,JFXPTR                                       04S0240
         L     @15,JFCBXNXT(,@01)                               04S0240
         ST    @15,JFXPTR                                       04S0240
*        SERCTRL = SERCTRL + FIFTEEN;                           04S0241
         AH    SERCTRL,@CH00038                                 04S0241
*      END;                                                     04S0242
         AH    XCTR,@CH00065                                    04S0242
@DE00239 LR    @15,JFXPOS                                       04S0242
         BCTR  @15,0                                            04S0242
         CR    XCTR,@15                                         04S0242
         BNH   @DL00239                                         04S0242
*    IF JFXREM > ZERO THEN              /*MUST POSITION WITHIN JFCBX */
@RF00238 CH    JFXREM,@CH00096                                  04S0243
         BNH   @RF00243                                         04S0243
*      DO;                                                      04S0244
*        I=JFXREM;                                              04S0245
         LR    I,JFXREM                                         04S0245
*      END;                                                     04S0246
*    ELSE                               /*MUST POSITION TO END OF EXT*/
*      DO;                                                      04S0247
         B     @RC00243                                         04S0247
@RF00243 DS    0H                                               04S0248
*        I=FIFTEEN;                                             04S0248
         LA    I,15                                             04S0248
*      END;                                                     04S0249
*    SERPTR = ADDR(JFCBXVOL);           /*POINT TO SERIALS IN JFCBX  */
@RC00243 L     SERPTR,JFXPTR                                    04S0250
         LA    SERPTR,JFCBXVOL(,SERPTR)                         04S0250
*  END;                                                         04S0251
*ELSE                                   /*VLSEQ WITHIN JFCB          */
*  DO;                                                          04S0252
         B     @RC00229                                         04S0252
@RF00229 DS    0H                                               04S0253
*    I=VRBVLSEQ;                                                04S0253
         SLR   I,I                                              04S0253
         IC    I,VRBVLSEQ(,RBPTR)                               04S0253
*  END;                                                         04S0254
*SERCNTR = VRBVLSEQ -ONE;               /*ADJUST SERIAL COUNTER      */
@RC00229 SLR   @07,@07                                          04S0255
         IC    @07,VRBVLSEQ(,RBPTR)                             04S0255
         BCTR  @07,0                                            04S0255
         ST    @07,SERCNTR                                      04S0255
*  END;                                                         03S0256
*DO WHILE (CNTENTRY <  VRBSIOTP -> SVOLUNNO); /*NO. OF VOLUN ENTRIES */
@RF00227 B     @DE00257                                         03S0257
@DL00257 DS    0H                                               03S0258
*  IF VRBSERNO=ZERO × SERCNTR=VRBSERNO THEN   /*ALL SERIALS PROCESSED*/
         CLI   VRBSERNO(RBPTR),0                                03S0258
         BE    @RT00258                                         03S0258
         L     @07,SERCNTR                                      03S0258
         SLR   @15,@15                                          03S0258
         IC    @15,VRBSERNO(,RBPTR)                             03S0258
         CR    @07,@15                                          03S0258
         BNE   @RF00258                                         03S0258
@RT00258 DS    0H                                               03S0259
*    DO;                               /*GENERATE NON-SPECIFIC SERIAL*/
*      IF VRBREFNO = ZERO THEN         /*NO NON-SPECIFIC VOL AFFINITY*/
         SLR   @05,@05                                          03S0260
         CH    @05,VRBREFNO(,RBPTR)                             03S0260
         BNE   @RF00260                                         03S0260
*        DO;                           /*GENERATE SERIAL             */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GENSERS                                           */
*/* DESCRIPTIVE NAME - GENERATE TEMPORARY VOLUME SERIALS             */
*/*                                                                  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS ROUTINE IS TO GENERATE TEMPORARY, UNIQUE, */
*/*   VOLUME SERIAL NUMBERS FOR REQUESTS NOT SPECIFYING SERIAL       */
*/*   NUMBERS. THESE NUMBERS ARE ALSO GENERATED TO FILL OUT A        */
*/*   REQUESTS VOLUNIT ENTRIES WHEN MORE VOLUNIT ENTRIES THEN        */
*/*   SPECIFIC SERIAL NUMBERS EXIST.                                 */
*/*   THE SERIAL NUMBERS GENERATED ARE OF TWO FORMS-                 */
*/*     1.FEOONNNNNNNN - WHERE NNNNNNNN  IS A FOUR BYTE FIELD        */
*/*       CONTAINING A UNIQUE NUMBER BEGINNING WITH ONE. THIS TYPE   */
*/*       OF NUMBER IS NORMALLY GENERATED, THE ONLY EXCEPTION IS     */
*/*       DESCRIBED BELOW. NOTE - THESE NUMBERS EXIST ONLY IN THE    */
*/*       VOLUNIT TABLE AND NEVER EXIST IN A JFCB OR UCB. THE PURPOSE*/
*/*       OF THESE NUMBERS IS TO ALLOW FOR THE RESOLUTION OF VOLUME  */
*/*       AFFINITIES BETWEEN NON SPECIFIC REQUESTS                   */
*/*     2.FFSVAASID - WHERE SVA IS THE THREE BYTE SVA OF THE JFCB    */
*/*       FOR THE REQUEST, AND ASID IS THE ASID OF THIS              */
*/*       JOB.  THIS NUMBER IS GENERATED FOR NON SPECIFIC TAPE       */
*/*       REQUESTS. ONLY ONE SUCH SERIAL PER TAPE REQUEST IS         */
*/*       GENERATED. THIS SERIAL NUMBER WILL APPEAR IN THE VOLUNIT   */
*/*       TABLE, THE JFCB AND THE UCB. THESE SERIAL NUMBERS ALLOW    */
*/*       VOLUME AFFINITY TO BE RESOLVED AT OPEN (VIA THE JFCB SVA). */
*/*       THEREFORE, THESE SERIAL NUMBERS ARE REPLACED IN THE JFCB   */
*/*       AND UCB WHEN THE DATA SET IS OPENED.                       */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   DESCRIBED IN FUNCTION                                          */
*/*                                                                  */
*/* ENTRY - INLINE SEGMENT                                           */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     VRB - VOLUNIT REQUEST BLOCK                                  */
*/*       VRBSIOTP - POINTER TO SIOT                                 */
*/*                                                                  */
*/*   EXITS -                                                        */
*/*     CONDITION - SUCCESSFUL COMPLETION                            */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       BUFFER CONTAINING GENERATED NUMBER                         */
*/*       JFCB CONTAINING FF NUMBER                                  */
*/*                                                                  */
*/*     RETURN CODE - NONE                                           */
*/*                                                                  */
*/********************************************************************/
*IF CNTENTRY =ZERO &                                            04S0262
*   TAPEREQ =ON THEN                   /*FIRST TIME FOR NON-SP TAPE  */
         CR    CNTENTRY,@05                                     04S0262
         BNE   @RF00262                                         04S0262
         TM    TAPEREQ(RBPTR),B'10000000'                       04S0262
         BNO   @RF00262                                         04S0262
*  DO;                                 /*GENERATE FF VOL SERIAL      */
*    GENSVA = VRBSIOTP -> SCTPJFCB;    /*JFCB SVA                    */
         L     @06,VRBSIOTP(,RBPTR)                             04S0264
         MVC   GENSVA(3),SCTPJFCB(@06)                          04S0264
*    GENASID=ALCWASID;                 /*ASID TO SERIAL #            */
         L     @15,@PC00001                                     04S0265
         L     @01,ALCWAPTR(,@15)                               04S0265
         MVC   GENASID(2),ALCWASID(@01)                         04S0265
*    SERPTR = ADDR(TAPEBUF);           /*POINT TO TAPE BUFFER        */
         LA    SERPTR,TAPEBUF                                   04S0266
*    JFCBPTR = VRBSIOTP ->SJFCBPTR;                             04S0267
         L     JFCBPTR,SJFCBPTR(,@06)                           04S0267
*    JFCBVOLS(1:6) = TAPEBUF;          /*FF NUMBER TO JFCB           */
         MVC   JFCBVOLS(6,JFCBPTR),TAPEBUF                      04S0268
*    JFCBNVOL =ONE;                    /*# OF SERIALS                */
         MVI   JFCBNVOL(JFCBPTR),X'01'                          04S0269
*  END;                                                         04S0270
*ELSE                                                           04S0271
*  DO;                                                          04S0271
         B     @RC00262                                         04S0271
@RF00262 DS    0H                                               04S0272
*    NXTVOLID = NXTVOLID + ONE;        /*GENERATE DA SERIAL          */
         LA    @07,1                                            04S0272
         L     @15,NXTVOLID                                     04S0272
         ALR   @15,@07                                          04S0272
         ST    @15,NXTVOLID                                     04S0272
*    SERPTR = ADDR(GENVOL);                                     04S0273
         LA    SERPTR,GENVOL                                    04S0273
*    I =ONE;                           /*REL. POSITION               */
         LR    I,@07                                            04S0274
*  END;                                                         04S0275
*          I=ONE;                      /*INDEX INTO SERIAL LIST      */
@RC00262 LA    I,1                                              03S0276
*        END;                                                   03S0277
*      ELSE                            /*NON SPECIFIC VOL REF        */
*        DO;                           /*COPY VOLIDS FROM REF'ED SER */
         B     @RC00260                                         03S0278
@RF00260 DS    0H                                               03S0279
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - VLREFPRC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PROCESS INTRA-STEP VOLUME REFERENCE TO A      */
*/*   NON-SPECIFIC VOLUME REQUEST                                    */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO SET UP COUNTERS FOR INITVOLN*/
*/*   SO THAT THE CORRECT SERIAL NUMBERS ARE PLACED IN THE INPUT     */
*/*   VOLUNIT ENTRY. THE INPUT VOLUNIT ENTRY IS KNOWN TO HAVE VOLUME */
*/*   REFERENCE TO ANOTHER VOLUNIT ENTRY IN THE TABLE. IN ADDITION,  */
*/*   THE REFERENCED VOLUNIT ENTRY IS FOR A NON-SPECIFIC REQUEST.    */
*/*                                                                  */
*/*   THE FOLLOWING FUNCTIONS ARE PERFORMED:                         */
*/*                                                                  */
*/*   1. SET THE POSITION OF THE VOLSER WITHIN THE VOLUME SERIAL LIST*/
*/*      THIS FIELD IS AUTOMATICALLY SET TO ONE                      */
*/*                                                                  */
*/*   2. SET THE BASE FOR THE VOLUME SERIAL LIST                     */
*/*      IF ALL THE VOLUME SERIALS HAVE BEEN COPIED FROM THE         */
*/*      REFERENCED REQUEST, A NEW NON-SPECIFIC SERIAL IS GENERATED  */
*/*      AND THE BASE FOR THE SERIAL LIST IS SET TO POINT TO THIS    */
*/*      SERIAL. IF ALL THE SERIALS HAVE NOT YET BEEN COPIED FROM    */
*/*      THE REFERENCED REQUEST THE FOLLOWING IS DONE:               */
*/*        A FIELD (CNTENTRY) WHICH CONTAINS THE NUMBER OF THE       */
*/*        VOLUNIT ENTRY BEING PROCESSED (RESET FOR EACH SIOT AND    */
*/*        ZERO ORIGIN) IS PASSED AS INPUT. THE BASE FOR THE VOLUME  */
*/*        SERIAL LIST IS SET TO -                                   */
*/*          SVOLUNAD + LENGTH(VOLUNTAB) * CNTENTRY                  */
*/*          WHERE:                                                  */
*/*            SVOLUNAD = ADDR. OF THE FIRST VOLUNIT ENTRY FOR THE   */
*/*              REFERENCED REQUEST.                                 */
*/*            LENGTH(VOLUNTAB) = LENGTH OF ONE VOLUNIT ENTRY        */
*/*   3. IF VOLUME REFERENCE TO A NON-SPECIFIC TAPE REQUEST, @YM03977*/
*/*      A FF VOLSER IS GENERATED WITH THE SVA OF THE        @ZA08096*/
*/*      REFERENCED REQUESTS JFCB.                           @ZA08096*/
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     CNTENTRY - RELATIVE NUMBER OF THE VOLUNIT ENTRY BEING        */
*/*       PROCESSED. RESET FOR EACH SIOT AND HAS ZERO ORIGIN.        */
*/*                                                                  */
*/*     RBPTR - ADDR. OF VRB                                         */
*/*       VRB - VOLUNIT REQUEST BLOCK                                */
*/*         VRBREFNO - DD NUMBER OF REFERENCED REQUEST               */
*/*                                                                  */
*/*     TRBPTR - ADDR. OF FIRST VRB                                  */
*/*       VRB - VOLUNIT REQUEST BLOCK                                */
*/*         VRBDDNUM - DD NUMBER OF VRB                              */
*/*         VRBSIOTP - ADDR. OF ASSOCIATED SIOT                      */
*/*                                                                  */
*/*       SIOT -                                                     */
*/*         SVOLUNNO - NUMBER OF VOLUNIT ENTRIES FOR THIS SIOT       */
*/*         SVOLUNAD - ADDR. OF FIRST VOLUNIT ENTRY FOR THIS SIOT    */
*/*                                                                  */
*/*       VOLUNIT ENTRY -                                            */
*/*         VOLID - VOLUME SERIAL ID                                 */
*/*                                                                  */
*/*       GENVOL - AREA FOR NON-SPECIFIC SERIALS                     */
*/*         NXTVOLID - UNIQUE NUMBER FOR GENERATED SERIALS           */
*/*                                                                  */
*/* EXIT -                                                           */
*/*                                                                  */
*/*    CONDITION - PROCESSING COMPLETE                               */
*/*                                                                  */
*/*    OUTPUT -                                                      */
*/*      NXTVOLID - SEE INPUT DATA                                   */
*/*      SERPTR - BASE FOR VOLUME SERIAL LIST                        */
*/*      I - POSITION OF THE VOLSER CURRENTRY BEING PROCESSED IN     */
*/*         THE VOLUME SERIAL LIST.                                  */
*/*                                                                  */
*/*    RETURN CODE - NONE                                            */
*/*                                                                  */
*/********************************************************************/
*SAVRBPTR = RBPTR;                     /*SAVE ORIGINAL VRB POINTER   */
         LR    SAVRBPTR,RBPTR                                   04S0279
*RBPTR = TRBPTR;                       /*POINT TO TOP OF VRB CHAIN   */
         L     RBPTR,TRBPTR                                     04S0280
*SAVVUPTR = VUPTR;                     /*SAVE ORIGINAL VOLUNIT PTR   */
         LR    SAVVUPTR,VUPTR                                   04S0281
*DO WHILE(SAVRBPTR -> VRBREFNO ^= VRBDDNUM); /*FIND REF VRB          */
         B     @DE00282                                         04S0282
@DL00282 DS    0H                                               04S0283
*  RBPTR = NXTVRB;                                              04S0283
         L     RBPTR,NXTVRB(,RBPTR)                             04S0283
*END;                                                           04S0284
@DE00282 CLC   VRBREFNO(2,SAVRBPTR),VRBDDNUM(RBPTR)             04S0284
         BNE   @DL00282                                         04S0284
*VUPTR = VRBSIOTP -> SVOLUNAD;         /*POINT TO REFS VOLUNIT       */
         L     @05,VRBSIOTP(,RBPTR)                             04S0285
         L     VUPTR,SVOLUNAD(,@05)                             04S0285
*IF CNTENTRY >= VRBSIOTP ->SVOLUNNO THEN /*GENERATE NEW VOLID        */
         CH    CNTENTRY,SVOLUNNO(,@05)                          04S0286
         BL    @RF00286                                         04S0286
*  DO;                                                          04S0287
*    NXTVOLID = NXTVOLID + ONE;        /*GENERATE NEW VOLID          */
         LA    @10,1                                            04S0288
         L     @09,NXTVOLID                                     04S0288
         ALR   @09,@10                                          04S0288
         ST    @09,NXTVOLID                                     04S0288
*    SERPTR = ADDR(GENVOL);                                     04S0289
         LA    SERPTR,GENVOL                                    04S0289
*    I=ONE;                                                     04S0290
         LR    I,@10                                            04S0290
*  END;                                                         04S0291
*ELSE                                  /*GET PROPER VOLUNIT ENTRY    */
*  DO;                                                          04S0292
         B     @RC00286                                         04S0292
@RF00286 DS    0H                                               04S0293
*    VUPTR = VUPTR +LENGTH(VOLUNTAB)*CNTENTRY; /* REFD VU ENTRY      */
         LR    @07,CNTENTRY                                     04S0293
         MH    @07,@CH00673                                     04S0293
         ALR   VUPTR,@07                                        04S0293
*    SERPTR = VUPTR;                   /*REFD SERIAL                 */
         LR    SERPTR,VUPTR                                     04S0294
*    I = ONE;                          /*SET FIRST SERIAL IN LIST    */
         LA    I,1                                              04S0295
*    IF CNTENTRY = ZERO &                                       04S0296
*       VOLID(1) = TAPEGEND THEN       /*MUST PUT FF NUMBER IN  04S0296
*                                        JFCB                @YM03977*/
         LTR   CNTENTRY,CNTENTRY                                04S0296
         BNZ   @RF00296                                         04S0296
         CLC   VOLID(1,VUPTR),TAPEGEND                          04S0296
         BNE   @RF00296                                         04S0296
*      DO;                                                      04S0297
*        JFCBPTR = SAVRBPTR->VRBSIOTP->SJFCBPTR; /*GET REF'ING JFCB
*                                                  PTR       @YM03977*/
         L     @10,VRBSIOTP(,SAVRBPTR)                          04S0298
         L     JFCBPTR,SJFCBPTR(,@10)                           04S0298
*        GENSVA = VRBSIOTP -> SCTPJFCB; /*REFERENCED JFCB    @ZA08096*/
         L     @10,VRBSIOTP(,RBPTR)                             04S0299
         MVC   GENSVA(3),SCTPJFCB(@10)                          04S0299
*        GENASID = ALCWASID;           /*ASID TO SERIAL #    @ZA08096*/
         L     @10,@PC00001                                     04S0300
         L     @10,ALCWAPTR(,@10)                               04S0300
         MVC   GENASID(2),ALCWASID(@10)                         04S0300
*        JFCBVOLS(1:6) = TAPEBUF;      /*MOVE VOLSER TO JFCB @ZA08096*/
         MVC   JFCBVOLS(6,JFCBPTR),TAPEBUF                      04S0301
*        JFCBNVOL = ONE;               /*INDICATE ONE VOL    @YM03977*/
         MVI   JFCBNVOL(JFCBPTR),X'01'                          04S0302
*      END;                                                     04S0303
*    ELSE;                                                      04S0304
@RF00296 DS    0H                                               04S0305
*  END;                                                         04S0305
*RBPTR = SAVRBPTR;                                              04S0306
@RC00286 LR    RBPTR,SAVRBPTR                                   04S0306
*VUPTR = SAVVUPTR;                                              04S0307
         LR    VUPTR,SAVVUPTR                                   04S0307
*        END;                                                   03S0308
*    END;                                                       03S0309
*  ELSE                                /*STILL WORKING ON SPECIFIC VL*/
*    SERCNTR= SERCNTR+ ONE;            /*BUMP NUMBER OF SERIALS      */
         B     @RC00258                                         03S0310
@RF00258 LA    @07,1                                            03S0310
         AL    @07,SERCNTR                                      03S0310
         ST    @07,SERCNTR                                      03S0310
*  VOLID=SERIAL(I);                    /*SERIAL TO VOLUNIT ENTRY     */
@RC00258 LR    @07,I                                            03S0311
         MH    @07,@CH00109                                     03S0311
         ALR   @07,SERPTR                                       03S0311
         AL    @07,@CF00772                                     03S0311
         MVC   VOLID(6,VUPTR),SERIAL(@07)                       03S0311
*  I=I+ONE;                            /*BUMP TO NEXT SERIAL IN LIST */
         AH    I,@CH00065                                       03S0312
*  VOLSTAT = ZERO;                     /*ZERO VOLUNIT STATUS BITS    */
         SLR   @07,@07                                          03S0313
         ST    @07,VOLSTAT(,VUPTR)                              03S0313
*  IF VRBAFFNO ^=ZERO THEN             /*UNIT=AFF SPECIFIED          */
         CH    @07,VRBAFFNO(,RBPTR)                             03S0314
         BE    @RF00314                                         03S0314
*    DO;                               /*PROCESS UNIT AFFINITY       */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UNAFFPRC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PROCESS UNIT AFFINITY                         */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO COPY THE UNIT ID FROM THE   */
*/*   REFERENCED REQUEST'S VOLUNIT ENTRY TO THE REFERENCING          */
*/*   REQUEST'S VOLUNIT ENTRY. IN ADDITION BOTH THE REFERENCED       */
*/*   REQUEST AND THE REFERENCING REQUEST ARE MARKED NON-SHARABLE.   */
*/*   IF ALL UNIT ID'S HAVE BEEN COPIED FROM THE REFERENCED          */
*/*   REQUEST AND MORE UNIT ID'S ARE NEEDED, THE UNIT ID OF THE      */
*/*   REFERENCED REQUEST'S LAST VOLUNIT ENTRY IS USED.               */
*/*   NOTE: FOR UNIT AFFINITY BETWEEN NON D.A., NON TAPE REQUESTS THE*/
*/*         VOLIDS ARE COPIED MAKING IT APPEAR AS VOLUME AFFINITY.   */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE ALGORITHM USED TO DETERMINE WHICH VOLUNIT ENTRY TO       */
*/*     RETRIEVE THE UNIT ID FROM IS AS FOLLOWS:                     */
*/*                                                                  */
*/*     A FIELD (CNTENTRY, SEE INPUT) IS RECIEVED AS INPUT. IT       */
*/*     CONTAINS THE NUMBER OF THE VOLUNIT ENTRY BEING PROCESSED.    */
*/*     THIS FIELD IS RESET FOR EACH SIOT AND HAS ZERO ORIGIN.       */
*/*     IF CNTENTRY IS >= THE NUMBER OF VOLUNIT ENTRIES FOR THE      */
*/*     REFERENCED REQUEST THIS MEANS WE HAVE COPIED ALL OF THE      */
*/*     REFERENCED REQUEST'S VOLUNIT ENTRIES BUT WE STILL NEED MORE  */
*/*     UNIT ID'S. THIS MEANS WE MUST COPY THE UNIT ID FROM THE      */
*/*     REFERENCED REQUEST'S LAST VOLUNIT ENTRY. THE ADDRESS OF      */
*/*     THE REFERENCED REQUEST'S LAST VOLUNIT ENTRY IS GIVEN BY:     */
*/*       VUAD = VUPTR + (LENGTH(VOLUNTAB) * SVOLUNNO) -             */
*/*         LENGTH(VOLUNTAB)                                         */
*/*       WHERE :                                                    */
*/*         VUPTR = ADDRESS OF THE REFERENCED REQUEST'S FIRST        */
*/*           VOLUNIT ENTRY                                          */
*/*         LENGTH(VOLUNTAB) = LENGTH OF A VOLUNIT ENTRY             */
*/*         SVOLUNNO = NUMBER OF VOLUNIT ENTRIES FOR THE REFERENCING */
*/*           REQUEST                                                */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     TRBPTR - PTR. TO FIRST VRB                                   */
*/*                                                                  */
*/*     VRB -                                                        */
*/*       VRBSIOTP - PTR. TO ASSOCIATED SIOT                         */
*/*       NXTVRB - PTR. TO NEXT VRB                                  */
*/*                                                                  */
*/*     SIOT -                                                       */
*/*       SVOLUNNO - NUMBER OF VOLUNIT ENTRIES FOR THIS SIOT         */
*/*       SVOLUNAD - PTR. TO FIRST VOLUNIT ENTRY FOR THIS SIOT       */
*/*                                                                  */
*/*     VOLUNIT ENTRY -                                              */
*/*       VOLUNTID - UNIT ID                                         */
*/*       VDEVREQD - TIOT DEVICE ENTRY REQUIRED BIT                  */
*/*                                                                  */
*/*     CNTENTRY - RELATIVE NUMBER OF THE VOLUNIT ENTRY BEING        */
*/*       PROCESSED. RESET FOR EACH SIOT AND HAS ZERO ORIGIN.        */
*/*                                                                  */
*/* EXITS -                                                          */
*/*                                                                  */
*/*   CONDITION - SUCCESSFUL COMPLETION                              */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     VOLUNIT ENTRY -                                              */
*/*       VOLUNTID - UNIT ID                                         */
*/*       VDEVREQD - TIOT DEVICE ENTRY REQUIRED                      */
*/*       VOLNSHR - NON-SHARABLE BIT                                 */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*SAVRBPTR=RBPTR;                       /*SAVE ORIGNAL VRB POINTER    */
         LR    SAVRBPTR,RBPTR                                   04S0316
*RBPTR=TRBPTR;                         /*POINT TO TOP OF VRB CHAIN   */
         L     RBPTR,TRBPTR                                     04S0317
*SAVVUPTR=VUPTR;                       /*SAVE INPUT VOLUNIT PTR      */
         LR    SAVVUPTR,VUPTR                                   04S0318
*DO WHILE(SAVRBPTR ->VRBAFFNO ^=VRBDDNUM); /*FIND AFF VRB            */
         B     @DE00319                                         04S0319
@DL00319 DS    0H                                               04S0320
*  RBPTR =NXTVRB;                                               04S0320
         L     RBPTR,NXTVRB(,RBPTR)                             04S0320
*END;                                                           04S0321
@DE00319 CLC   VRBAFFNO(2,SAVRBPTR),VRBDDNUM(RBPTR)             04S0321
         BNE   @DL00319                                         04S0321
*VUPTR= VRBSIOTP ->SVOLUNAD;           /*POINT TO REFD SIOTS FIRST
*                                        VOLUNIT ENTRY               */
         L     @07,VRBSIOTP(,RBPTR)                             04S0322
         L     VUPTR,SVOLUNAD(,@07)                             04S0322
*IF CNTENTRY >=VRBSIOTP ->SVOLUNNO THEN /*ALL OF REFERENCED VU  04S0323
*                                         ENTRIES HAVE BEEN COPIED   */
         LH    @07,SVOLUNNO(,@07)                               04S0323
         CR    CNTENTRY,@07                                     04S0323
         BL    @RF00323                                         04S0323
*  VUPTR=VUPTR+(LENGTH(VOLUNTAB)*VRBSIOTP ->SVOLUNNO) -         04S0324
*           LENGTH(VOLUNTAB);          /*REFERENCED REQUEST LAST VU
*                                        ENTRY                       */
         LA    @15,28                                           04S0324
         LR    @01,@07                                          04S0324
         MR    @00,@15                                          04S0324
         ALR   @01,VUPTR                                        04S0324
         SLR   @01,@15                                          04S0324
         LR    VUPTR,@01                                        04S0324
*ELSE                                  /*GET PROPER ENTRY FOR UNITID */
*  DO;                                                          04S0325
         B     @RC00323                                         04S0325
@RF00323 DS    0H                                               04S0326
*    VUPTR=VUPTR+LENGTH(VOLUNTAB)*CNTENTRY;                     04S0326
         LR    @07,CNTENTRY                                     04S0326
         MH    @07,@CH00673                                     04S0326
         ALR   VUPTR,@07                                        04S0326
*    IF VDEVREQD = ON THEN             /*PRIMARY REQUIRES DEVICE?    */
         TM    VDEVREQD(VUPTR),B'00100000'                      04S0327
         BNO   @RF00327                                         04S0327
*      SAVVUPTR -> VDEVREQD = ON;      /*YES SET IN SECONDARY        */
         OI    VDEVREQD(SAVVUPTR),B'00100000'                   04S0328
*  END;                                                         04S0329
@RF00327 DS    0H                                               04S0330
*IF VRBSIOTP->SIO3DACC = OFF &         /*NON DA OR TAPE UNIT=AFF     */
*   VRBSIOTP->SIO3TAPE=OFF THEN        /*MAKE IT VOLUME AFFINITY     */
@RC00323 L     @07,VRBSIOTP(,RBPTR)                             04S0330
         TM    SIO3DACC(@07),B'10100000'                        04S0330
         BNZ   @RF00330                                         04S0330
*     SAVVUPTR->VOLID=VOLID;                                    04S0331
         MVC   VOLID(6,SAVVUPTR),VOLID(VUPTR)                   04S0331
*SAVVUPTR -> VOLUNTID = VOLUNTID;      /* SET UNITID                 */
@RF00330 MVC   VOLUNTID(2,SAVVUPTR),VOLUNTID(VUPTR)             04S0332
*SAVVUPTR->VOLNSHR = ON;                                        04S0333
         OI    VOLNSHR(SAVVUPTR),B'00001000'                    04S0333
*VOLNSHR = ON;                                                  04S0334
         OI    VOLNSHR(VUPTR),B'00001000'                       04S0334
*RBPTR=SAVRBPTR;                                                04S0335
         LR    RBPTR,SAVRBPTR                                   04S0335
*VUPTR=SAVVUPTR;                                                04S0336
         LR    VUPTR,SAVVUPTR                                   04S0336
*    END;                                                       03S0337
*  ELSE                                /*NO AFFINITY                 */
*      IF CNTUNID <  VRBUNCNT THEN     /*MORE UNITIDS NEEDED BECAUSE
*                                        UNIT COUNT NOT YET REACHED  */
         B     @RC00314                                         03S0338
@RF00314 L     @07,CNTUNID                                      03S0338
         SLR   @15,@15                                          03S0338
         IC    @15,VRBUNCNT(,RBPTR)                             03S0338
         CR    @07,@15                                          03S0338
         BNL   @RF00338                                         03S0338
*        DO;                                                    03S0339
*          CNTUNID=CNTUNID+ONE;        /*BUMP UNIT ID CNTR FOR THIS
*                                        SIOT                        */
         LA    @15,1                                            03S0340
         ALR   @07,@15                                          03S0340
         ST    @07,CNTUNID                                      03S0340
*          LTUNITID=LTUNITID+ONE;      /*BUMP NEXT UNIT ID TO USE    */
         L     @07,@PC00001                                     03S0341
         L     @07,ALCWAPTR(,@07)                               03S0341
         AH    @15,LTUNITID(,@07)                               03S0341
         STH   @15,LTUNITID(,@07)                               03S0341
*          VOLUNTID = LTUNITID;        /*UNIT ID TO VOLUNIT IN ALCWA */
         STH   @15,VOLUNTID(,VUPTR)                             03S0342
*          VDEVREQD = ON;              /*DEVICE REQ'D                */
         OI    VDEVREQD(VUPTR),B'00100000'                      03S0343
*          IF DEFERMT=OFF THEN         /*DEFER MNTING NOT SPECIFIED  */
         TM    DEFERMT(RBPTR),B'00001000'                       03S0344
         BNZ   @RF00344                                         03S0344
*            VOLMNTD = ON;             /*VOLUME MUST BE MOUNTED      */
         OI    VOLMNTD(VUPTR),B'01000000'                       03S0345
*          ELSE                        /*DEFER MOUNTING SPECIFIED    */
*            DO;                                                03S0346
         B     @RC00344                                         03S0346
@RF00344 DS    0H                                               03S0347
*              VOLDEFER = ON;          /*DEFER MNT. IN VOLUNIT       */
*              VOLNSHR = ON;           /*MAKE NON-SHAREABLE          */
         OI    VOLDEFER(VUPTR),B'00001001'                      03S0348
*            END;                                               03S0349
*        END;                                                   03S0350
*      ELSE                            /*UNIT COUNT REACHED          */
*        DO;                           /*ALL OTHER VOLS ON SAME UNIT */
         B     @RC00338                                         03S0351
@RF00338 DS    0H                                               03S0352
*          VOLNSHR = ON;               /*NON-SHARAABLE               */
         OI    VOLNSHR(VUPTR),B'00001000'                       03S0352
*          TPTR = VUPTR-LENGTH(VOLUNTAB);/*PREVIOUS VOLUNIT ENTRY    */
         LR    TPTR,VUPTR                                       03S0353
         SH    TPTR,@CH00673                                    03S0353
*          TPTR->VOLNSHR=ON;           /*SET NON-SHARABLE            */
         OI    VOLNSHR(TPTR),B'00001000'                        03S0354
*          VOLUNTID = LTUNITID;        /*USE SAME UNIT ID AS PREVIOUS*/
         L     @07,@PC00001                                     03S0355
         L     @07,ALCWAPTR(,@07)                               03S0355
         MVC   VOLUNTID(2,VUPTR),LTUNITID(@07)                  03S0355
*          IF DEFERMT=ON THEN          /*DEFER MOUNTING REQUESTED    */
         TM    DEFERMT(RBPTR),B'00001000'                       03S0356
         BNO   @RF00356                                         03S0356
*            VOLDEFER=ON;              /*SET DEFER IN VU ENTRY       */
         OI    VOLDEFER(VUPTR),B'00000001'                      03S0357
*        END;                                                   03S0358
@RF00356 DS    0H                                               03S0359
*  CNTENTRY=CNTENTRY+ONE;              /*BUMP CNTR OF VOLUNIT ENTRYS */
@RC00338 DS    0H                                               03S0359
@RC00314 AH    CNTENTRY,@CH00065                                03S0359
*  VOLSIOTP=VRBSIOTP;                  /*SIOT PTR TO VOLUNIT TABLE   */
         MVC   VOLSIOTP(4,VUPTR),VRBSIOTP(RBPTR)                03S0360
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SETVLBIT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SET VOLUNIT ENTRY BITS                        */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO SET STATUS BITS IN A GIVEN  */
*/*   VOLUNIT TABLE ENTRY.                                           */
*/*                                                                  */
*/*   THE FOLLOWING BITS ARE SET:                                    */
*/*                                                                  */
*/*   . FOR DIRECT ACCESS REQUESTS -                                 */
*/*      DIRECT ACCESS BIT SET ON                                    */
*/*      FOR NON-SPECIFIC REQUEST WHEN DISP = DELETE, SET PUBLIC     */
*/*        BIT ON UNLESS PRIVATE WAS SPECIFIED                       */
*/*      FOR NON-SPECIFIC REQUEST WHEN DISP ^= DELETE, SET STORAGE   */
*/*        BIT ON UNLESS PRIVATE WAS SPECIFIED                       */
*/*      FOR SPECIFIC REQUEST SET SPECIFIC BIT ON                    */
*/*      IF THIS IS THE FIRST VOLUNIT ENTRY FOR THE REQUEST AND      */
*/*        DISP = NEW WAS SPECIFIED SET THE DADSM REQUIRED BIT ON    */
*/*      IF PRIVATE WAS SPECIFIED, SET THE PRIVATE BIT ON.           */
*/*                                                                  */
*/*   . FOR A COMMUNICATIONS REQUEST                                 */
*/*       SET THE COMMUNICATION REQUEST BIT ON                       */
*/*                                                                  */
*/*   . FOR A TAPE REQUEST                                           */
*/*       TAPE BIT SET ON, PRIVATE BIT OR PUBLIC BIT SET ON          */
*/*                                                                  */
*/*   . FOR A UNIT RECORD REQUEST                                    */
*/*       UNIT RECORD BIT SET ON                                     */
*/*                                                                  */
*/*   . FOR A GRAPHIC REQUEST                                        */
*/*       GRAPHIC BIT SET ON                                         */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     VRB (VOLUNIT REQUEST BLOCK)                                  */
*/*                                                                  */
*/*     VOLUNIT TABLE ENTRY                                          */
*/*       VOLID - VOLUME SERIAL ID                                   */
*/*                                                                  */
*/*     CNTENTRY - IF 1, MEANS FIRST VOLUNIT ENTRY FOR REQUEST       */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - VOLUNIT BITS SET                                   */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     VOLUNIT ENTRY -                                              */
*/*       VOLPUB - IF ON, PUBLIC REQUEST                             */
*/*       VOLSTG - IF ON, STORAGE REQUEST                            */
*/*       VOLPRV - IF ON, PRIVATE REQUEST                            */
*/*       VOLSPEC - IF ON, SPECIFIC REQUEST                          */
*/*       VOLCOREQ - IF ON, COMMUNICATION REQUEST                    */
*/*       VOLDAREQ - IF ON, DIRECT ACCESS REQUEST                    */
*/*       VUDADSM - IF ON, DADSM REQUIRED                            */
*/*       VOLTAREQ - IF ON, TAPE REQUEST                             */
*/*       VOLURREQ - IF ON, UNIT RECORD REQUEST                      */
*/*       VOLGRREQ - IF ON, GRAPHIC REQUEST                          */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*IF DAREQ=ON THEN                     /*DIRECT ACCESS                */
         TM    DAREQ(RBPTR),B'00010000'                         04S0361
         BNO   @RF00361                                         04S0361
*  DO;                                                          04S0362
*    VOLDAREQ=ON;                                               04S0363
         OI    VOLDAREQ(VUPTR),B'00100000'                      04S0363
*    IF  VOLID(1)=DASCR ×             /*NON SPECIFIC                 */
*        VOLID(1)=TAPEGEND THEN                                 04S0364
         CLI   VOLID(VUPTR),X'FE'                               04S0364
         BE    @RT00364                                         04S0364
         CLC   VOLID(1,VUPTR),TAPEGEND                          04S0364
         BNE   @RF00364                                         04S0364
@RT00364 DS    0H                                               04S0365
*      DO;                                                      04S0365
*        IF DISPDELT=ON THEN          /*PUBLIC REQUEST               */
         TM    DISPDELT(RBPTR),B'00010000'                      04S0366
         BNO   @RF00366                                         04S0366
*          VOLPUB=ON;                                           04S0367
         OI    VOLPUB(VUPTR),B'10000000'                        04S0367
*        ELSE                         /*STORAGE REQUEST              */
*          VOLSTG=ON;                                           04S0368
         B     @RC00366                                         04S0368
@RF00366 OI    VOLSTG(VUPTR),B'00010000'                        04S0368
*      END;                                                     04S0369
*    ELSE                             /*SPECIFIC REQUEST             */
*      VOLSPEC=ON;                                              04S0370
         B     @RC00364                                         04S0370
@RF00364 OI    VOLSPEC(VUPTR),B'00100000'                       04S0370
*    IF CNTENTRY=ONE THEN             /*FIRST ENTRY FOR THIS REQ     */
@RC00364 CH    CNTENTRY,@CH00065                                04S0371
         BNE   @RF00371                                         04S0371
*      DO;                                                      04S0372
*        IF DISPNEW=ON THEN           /*NEW DATA SET                 */
         TM    DISPNEW(RBPTR),B'00000100'                       04S0373
         BNO   @RF00373                                         04S0373
*          VUDADSM=ON;                                          04S0374
         OI    VUDADSM(VUPTR),B'00000010'                       04S0374
*      END;                                                     04S0375
*    ELSE;                                                      04S0376
@RF00371 DS    0H                                               04S0377
*    IF PRIVATER=ON THEN              /*PRIVATE REQUEST              */
@RC00371 TM    PRIVATER(RBPTR),B'00100000'                      04S0377
         BNO   @RF00377                                         04S0377
*      DO;                                                      04S0378
*        VOLPRV=ON;                                             04S0379
*        VOLPUB=OFF;                                            04S0380
*        VOLSTG=OFF;                                            04S0381
         OI    VOLPRV(VUPTR),B'01000000'                        04S0381
         NI    VOLPUB(VUPTR),B'01101111'                        04S0381
*      END;                                                     04S0382
*    ELSE;                                                      04S0383
@RF00377 DS    0H                                               04S0384
*  END;                                                         04S0384
*ELSE;                                                          04S0385
@RF00361 DS    0H                                               04S0386
*  IF COMMREQ = ON THEN                /*COMMUNICATION DEVICE        */
         TM    COMMREQ(RBPTR),B'01000000'                       04S0386
         BNO   @RF00386                                         04S0386
*    VOLCOREQ = ON;                    /*COMMUNICATION BIT ON        */
         OI    VOLCOREQ(VUPTR),B'01000000'                      04S0387
*  IF TAPEREQ = ON THEN                /*TAPE ELIGIBILITY            */
@RF00386 TM    TAPEREQ(RBPTR),B'10000000'                       04S0388
         BNO   @RF00388                                         04S0388
*    DO;                                                        04S0389
*      VOLTAREQ=ON;                    /*TAPE ON IN VUENTRY          */
         OI    VOLTAREQ(VUPTR),B'10000000'                      04S0390
*      IF PRIVATER = ON THEN           /*PRIVATE REQUEST             */
         TM    PRIVATER(RBPTR),B'00100000'                      04S0391
         BNO   @RF00391                                         04S0391
*        VOLPRV = ON;                  /*PRIVATE IN VUENTRY          */
         OI    VOLPRV(VUPTR),B'01000000'                        04S0392
*      ELSE                                                     04S0393
*        VOLPUB=ON;                    /*PUBLIC IN VUENTRY           */
         B     @RC00391                                         04S0393
@RF00391 OI    VOLPUB(VUPTR),B'10000000'                        04S0393
*      IF VOLID(1)^=TAPEGEND                                    04S0394
*        & VOLID(1)^=DASCR THEN        /*SPECIFIC REQUEST            */
@RC00391 CLC   VOLID(1,VUPTR),TAPEGEND                          04S0394
         BE    @RF00394                                         04S0394
         CLI   VOLID(VUPTR),X'FE'                               04S0394
         BE    @RF00394                                         04S0394
*          VOLSPEC = ON;                                        04S0395
         OI    VOLSPEC(VUPTR),B'00100000'                       04S0395
*    END;                                                       04S0396
@RF00394 DS    0H                                               04S0397
*  IF URECREQ = ON THEN                /*UNIT RECORD                 */
@RF00388 TM    URECREQ(RBPTR),B'00001000'                       04S0397
         BNO   @RF00397                                         04S0397
*    VOLURREQ = ON;                    /*UNIT RECORD IN VUENTRY      */
         OI    VOLURREQ(VUPTR),B'00001000'                      04S0398
*  IF GRAPHREQ = ON THEN               /*SET GRAPHICS                */
@RF00397 TM    GRAPHREQ(RBPTR),B'00100000'                      04S0399
         BNO   @RF00399                                         04S0399
*    VOLGRREQ = ON;                                             04S0400
         OI    VOLGRREQ(VUPTR),B'00010000'                      04S0400
*  IF SERCNTR=SERCTRL THEN             /*REACHED END OF SERIAL LIST  */
@RF00399 C     SERCTRL,SERCNTR                                  03S0401
         BNE   @RF00401                                         03S0401
*    DO;                               /*GET A JFCBX                 */
*      IF SERCTRL=FIVE THEN            /*END OF JFCB SERIALS         */
         CH    SERCTRL,@CH00135                                 03S0403
         BNE   @RF00403                                         03S0403
*        JFXPTR=VRBJXPTR;              /*BASE OF JFCBX               */
         MVC   JFXPTR(4),VRBJXPTR(RBPTR)                        03S0404
*      ELSE                            /*END OF JFCBX SERIALS        */
*        JFXPTR=JFCBXNXT;              /*BASE OF NEXT JFCBX          */
         B     @RC00403                                         03S0405
@RF00403 L     @05,JFXPTR                                       03S0405
         L     @05,JFCBXNXT(,@05)                               03S0405
         ST    @05,JFXPTR                                       03S0405
*      SERCTRL = SERCTRL+ FIFTEEN;     /*ACCOUNT FOR JFCBX SERIALS   */
@RC00403 AH    SERCTRL,@CH00038                                 03S0406
*      SERPTR = ADDR(JFCBXVOL);        /*JFCBX SERRORS               */
         L     SERPTR,JFXPTR                                    03S0407
         LA    SERPTR,JFCBXVOL(,SERPTR)                         03S0407
*      I=ONE;                          /*INDEX BACK TO ONE           */
         LA    I,1                                              03S0408
*    END;                                                       03S0409
*  ELSE;                                                        03S0410
@RF00401 DS    0H                                               03S0411
*  VUPTR=VUPTR+LENGTH(VOLUNTAB);       /*NEXT VOLUNIT ENTRY          */
         AH    VUPTR,@CH00673                                   03S0411
*END;                                                           03S0412
@DE00257 L     @07,VRBSIOTP(,RBPTR)                             03S0412
         CH    CNTENTRY,SVOLUNNO(,@07)                          03S0412
         BL    @DL00257                                         03S0412
*           RBPTR=NXTVRB;                                       02S0413
         L     RBPTR,NXTVRB(,RBPTR)                             02S0413
*         END;                                                  02S0414
@DE00219 LTR   RBPTR,RBPTR                                      02S0414
         BNZ   @DL00219                                         02S0414
*         CALL IEFAB426(ALCWAPTR);     /*AFFINITY PROCESSING         */
         L     @10,@PC00001                                     02S0415
         ST    @10,@AL00001                                     02S0415
         L     @15,@CV00100                                     02S0415
         LA    @01,@AL00001                                     02S0415
         BALR  @14,@15                                          02S0415
*         ERRORWD = REG15;                                      02S0416
         LR    ERRORWD,REG15                                    02S0416
*       END;                                                    02S0417
*     ELSE                                                      02S0418
*       DO;                                                     02S0418
         B     @RC00211                                         02S0418
@RF00211 DS    0H                                               02S0419
*         ERRORWD = REG15;             /*GETMAIN ERROR               */
         LR    ERRORWD,REG15                                    02S0419
*         STEPRSNC = GETMAIN;          /*SET GETMAIN ERROR           */
         L     @10,@PC00001                                     02S0420
         L     @10,ALCWAPTR(,@10)                               02S0420
         L     @10,FAILRSCP(,@10)                               02S0420
         MVC   STEPRSNC(2,@10),@CH00063                         02S0420
*       END;                                                    02S0421
*    END;                                                       02S0422
*ELSE;                                                          02S0423
@RF00185 DS    0H                                               02S0424
*      IF ERRORWD=ZERO THEN            /*NO ERROR                    */
@RC00185 LTR   ERRORWD,ERRORWD                                  01S0424
         BNZ   @RF00424                                         01S0424
*        DO;                                                    01S0425
*          CALL IEFAB424(ALCWAPTR);    /*BUILD EDLS                  */
         L     @10,@PC00001                                     01S0426
         ST    @10,@AL00001                                     01S0426
         L     @15,@CV00099                                     01S0426
         LA    @01,@AL00001                                     01S0426
         BALR  @14,@15                                          01S0426
*          ERRORWD=REG15;              /*SAVE RETURN CODE            */
         LR    ERRORWD,REG15                                    01S0427
*        END;                                                   01S0428
*      END;                                                     01S0429
*    ELSE;                                                      01S0430
@RF00147 DS    0H                                               01S0431
*    RFY (REG0,REG1) RSTD;                                      01S0431
@RC00147 DS    0H                                               01S0432
*    REG0=GLENGTH;                                              01S0432
         L     REG0,GLENGTH                                     01S0432
*    REG0 = REG0 × SUBPL230;           /*FREE FROM SUBPOOL 230       */
         O     REG0,@CF00091                                    01S0433
*    REG1=TRBPTR;                                               01S0434
         L     REG1,TRBPTR                                      01S0434
*    GEN (FREEMAIN R,LV=(0),A=(1));    /*FREE VOLUNIT REQUEST BLOCKS */
         FREEMAIN R,LV=(0),A=(1)
*    RFY (REG0,REG1) UNRSTD;                                    01S0436
*  END;                                                         01S0437
*ELSE                                  /*ELSE FOR GETMAIN ERROR      */
*  STEPRSNC = GETMAIN;                 /*SET ERROR REASON CODE       */
         B     @RC00062                                         01S0438
@RF00062 L     @10,@PC00001                                     01S0438
         L     @10,ALCWAPTR(,@10)                               01S0438
         L     @10,FAILRSCP(,@10)                               01S0438
         MVC   STEPRSNC(2,@10),@CH00063                         01S0438
*RETURN CODE(ERRORWD);                 /*RETURN TO CALLER            */
@RC00062 IC    @02,@OLDKEY                                      01S0439
         L     @13,4(,@13)                                      01S0439
         L     @00,@SIZDATD                                     01S0439
         LR    @01,@11                                          01S0439
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@03                                          01S0439
         L     @14,12(,@13)                                     01S0439
         LM    @00,@12,20(@13)                                  01S0439
         BR    @14                                              01S0439
*END IEFAB423                                                   01S0440
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A423SPEC)                                        *
*/*%INCLUDE SYSLIB  (A423DATA)                                        *
*/*%INCLUDE SYSLIB  (BLDVDATA)                                        *
*/*%INCLUDE SYSLIB  (INITDATA)                                        *
*/*%INCLUDE SYSLIB  (GENSDATA)                                        *
*/*%INCLUDE SYSLIB  (SETVDATA)                                        *
*/*%INCLUDE SYSLIB  (VLSEDATA)                                        *
*/*%INCLUDE SYSLIB  (IEFZB423)                                        *
*/*%INCLUDE SYSLIB  (BVOLDATA)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                        *
*/*%INCLUDE SYSLIB  (IEFZB425)                                        *
*/*%INCLUDE SYSLIB  (BVOLUNRB)                                        *
*/*%INCLUDE SYSLIB  (BVOLSPEC)                                        *
*/*%INCLUDE SYSLIB  (BLDVOLUN)                                        *
*/*%INCLUDE SYSLIB  (BLDVSPEC)                                        *
*/*%INCLUDE SYSLIB  (INITVOLN)                                        *
*/*%INCLUDE SYSLIB  (INITSPEC)                                        *
*/*%INCLUDE SYSLIB  (VLSEQPRC)                                        *
*/*%INCLUDE SYSLIB  (VLSESPEC)                                        *
*/*%INCLUDE SYSLIB  (GENSERS )                                        *
*/*%INCLUDE SYSLIB  (GENSPEC )                                        *
*/*%INCLUDE SYSLIB  (VLREFPRC)                                        *
*/*%INCLUDE SYSLIB  (VLRESPEC)                                        *
*/*%INCLUDE SYSLIB  (UNAFFPRC)                                        *
*/*%INCLUDE SYSLIB  (UNAFSPEC)                                        *
*/*%INCLUDE SYSLIB  (SETVLBIT)                                        *
*/*%INCLUDE SYSLIB  (SETVSPEC)                                        *
*;                                                              01S0440
@DATA    DS    0H
@CH00096 DC    H'0'
@CH00065 DC    H'1'
@CH00063 DC    H'2'
@CH00135 DC    H'5'
@CH00109 DC    H'6'
@CH00094 DC    H'9'
@CH00125 DC    H'11'
@CH00038 DC    H'15'
@CH00673 DC    H'28'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@AL00001 DS    1A
IEFAB423 CSECT
         DS    0F
@CF00772 DC    F'-6'
@CF00091 DC    XL4'E6000000'
@DATD    DSECT
         DS    0D
TRBPTR   DS    A
GLENGTH  DS    F
CNTUNID  DS    F
JFXPTR   DS    A
SERCNTR  DS    F
JFCBXPTR DS    A
GTSTRTCD DS    F
BUFFER   DS    CL8
         ORG   BUFFER
@NM00005 DS    FL2
GENVOL   DS    CL2
NXTVOLID DS    FL4
         ORG   BUFFER+8
TAPEBUF  DS    CL6
         ORG   TAPEBUF
GENFF    DS    CL1
GENSVA   DS    CL3
GENASID  DS    CL2
         ORG   TAPEBUF+6
@OLDKEY  DS    AL1
IEFAB423 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00099 DC    V(IEFAB424)
@CV00100 DC    V(IEFAB426)
         DS    0D
GTSTZERO DC    F'0'
@CB00120 DC    X'FE00'
TAPEGEND DC    X'FF'
IEFAB423 CSECT
         DS   0H
A423PTCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB423 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
XCTR     EQU   @03
TEMPSEQ  EQU   @03
JFXREM   EQU   @05
JFXPOS   EQU   @02
SERCTRL  EQU   @08
TPTR     EQU   @02
SAVVUPTR EQU   @03
SAVRBPTR EQU   @02
VUSIZE   EQU   @09
TOTNUM   EQU   @02
TEMSERNO EQU   @05
CNTENTRY EQU   @04
VUPTR    EQU   @10
SERPTR   EQU   @05
I        EQU   @06
ERRORWD  EQU   @03
TSIOTPTR EQU   @04
SIOTPTR  EQU   @02
RBPTR    EQU   @09
JFCBPTR  EQU   @07
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
STEPRSNC EQU   0
VOLUNRB  EQU   0
NXTVRB   EQU   VOLUNRB
VRBDDNUM EQU   VOLUNRB+4
VRBAFFNO EQU   VOLUNRB+6
VRBREFNO EQU   VOLUNRB+8
VRBSERNO EQU   VOLUNRB+10
VRBVLCNT EQU   VOLUNRB+11
VRBVLSEQ EQU   VOLUNRB+12
VRBUNCNT EQU   VOLUNRB+13
VRBIND1  EQU   VOLUNRB+14
PRIVATER EQU   VRBIND1
DISPDELT EQU   VRBIND1
DEFERMT  EQU   VRBIND1
DISPNEW  EQU   VRBIND1
VRBIND2  EQU   VOLUNRB+15
TAPEREQ  EQU   VRBIND2
COMMREQ  EQU   VRBIND2
GRAPHREQ EQU   VRBIND2
DAREQ    EQU   VRBIND2
URECREQ  EQU   VRBIND2
VRBSRPTR EQU   VOLUNRB+16
VRBJXPTR EQU   VOLUNRB+20
VRBSIOTP EQU   VOLUNRB+24
SERIAL   EQU   0
VOLUNTAB EQU   0
VOLID    EQU   VOLUNTAB
VOLSTAT  EQU   VOLUNTAB+6
VOLSTATA EQU   VOLSTAT
VOLPUB   EQU   VOLSTATA
VOLPRV   EQU   VOLSTATA
VOLSPEC  EQU   VOLSTATA
VOLSTG   EQU   VOLSTATA
VOLNSHR  EQU   VOLSTATA
VUDADSM  EQU   VOLSTATA
VOLDEFER EQU   VOLSTATA
VOLSTATB EQU   VOLSTAT+1
VOLMNTD  EQU   VOLSTATB
VDEVREQD EQU   VOLSTATB
VOLSTATC EQU   VOLSTAT+2
VOLTAREQ EQU   VOLSTATC
VOLCOREQ EQU   VOLSTATC
VOLDAREQ EQU   VOLSTATC
VOLGRREQ EQU   VOLSTATC
VOLURREQ EQU   VOLSTATC
VOLSTATD EQU   VOLSTAT+3
VOLUNTID EQU   VOLUNTAB+10
VOLSIOTP EQU   VOLUNTAB+16
VUUCBP   EQU   VOLUNTAB+20
VUGRID   EQU   VOLUNTAB+24
VUPOOL   EQU   0
VUGRLST  EQU   0
VUGRLENT EQU   VUGRLST
VUGRLFLG EQU   VUGRLENT+4
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTUNAF EQU   SCTUSADD
SCTPJFCB EQU   INDMSIOT+32
SIOTOTUN EQU   INDMSIOT+39
SIOTREFN EQU   INDMSIOT+40
SIOTBYT1 EQU   INDMSIOT+43
SIOTALCD EQU   SIOTBYT1
SCTDDINO EQU   INDMSIOT+44
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SCTVOLCT EQU   INDMSIOT+49
SIOTBYT0 EQU   INDMSIOT+52
SIOTFUDA EQU   SIOTBYT0
SCTNMBUT EQU   INDMSIOT+53
SIOTVLCT EQU   INDMSIOT+54
SCTSDISP EQU   INDMSIOT+55
SIOTPRIV EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SCTSBYT1 EQU   INDMSIOT+56
SCTPARLM EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTSBYT2 EQU   INDMSIOT+57
SCTDEFER EQU   SCTSBYT2
SCTSBYT3 EQU   INDMSIOT+58
SCTSNEW  EQU   SCTSBYT3
SCTSBYT4 EQU   INDMSIOT+59
SIOTVAFF EQU   SCTSBYT4
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIO3TAPE EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIOTBYT4 EQU   INDMSIOT+81
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTRSNC EQU   INDMSIOT+130
SVOLUNAD EQU   INDMSIOT+140
SIOTNPTR EQU   INDMSIOT+152
SJFCBPTR EQU   INDMSIOT+156
SIOTJFX  EQU   INDMSIOT+160
SVOLUNNO EQU   INDMSIOT+168
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBVLSQ EQU   INFMJFCB+70
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
JFCBX    EQU   0
JFCBXVOL EQU   JFCBX+4
JFCBXNXT EQU   JFCBX+172
ALCWA    EQU   0
SIOT1P   EQU   ALCWA+8
FAILRSCP EQU   ALCWA+20
CNTABLE  EQU   ALCWA+28
TOTREQS  EQU   CNTABLE+36
NUMREQS  EQU   CNTABLE+40
TOTVOLUN EQU   CNTABLE+44
LTUNITID EQU   ALCWA+76
VOLUNPTR EQU   ALCWA+80
VOLUNSZE EQU   ALCWA+84
INDICATE EQU   ALCWA+112
@NM00031 EQU   ALCWA+113
ALCWASID EQU   ALCWA+114
TIOTHDRP EQU   ALCWA+120
NAMES    EQU   0
ALCWAPTR EQU   0
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBNVOL EQU   JFCUCSEG+9
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBEXP  EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00026 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00025 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00024 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
ALCPROCN EQU   NAMES+16
ALCSTEPN EQU   NAMES+8
ALCJOBN  EQU   NAMES
LOJSSNMP EQU   ALCWA+164
SSERBLKP EQU   ALCWA+160
GROUPSZ  EQU   ALCWA+156
GRIDPTR  EQU   ALCWA+152
ALCNUCBS EQU   ALCWA+148
EXITPRMP EQU   ALCWA+144
CANCELP  EQU   ALCWA+140
WORK3MP  EQU   ALCWA+136
WMASK2P  EQU   ALCWA+132
WMASKPTR EQU   ALCWA+128
LGENLOCK EQU   ALCWA+124
TCBP     EQU   ALCWA+116
@NM00032 EQU   @NM00031
DDRDA    EQU   @NM00031
DDRTPUR  EQU   @NM00031
NODEVERR EQU   @NM00031
NEEDRCVY EQU   @NM00031
ALCWAREC EQU   @NM00031
WAITIGEN EQU   @NM00031
UNITRECS EQU   @NM00031
ALCWADUL EQU   INDICATE
ALCWISAM EQU   INDICATE
DSSUNIT  EQU   INDICATE
DSSTAPE  EQU   INDICATE
PRIVASUM EQU   INDICATE
INDREQU  EQU   INDICATE
INDRETRY EQU   INDICATE
INDWAIT  EQU   INDICATE
QMGRRBP  EQU   ALCWA+108
RIMTABCT EQU   ALCWA+104
RIMTABLN EQU   ALCWA+100
RIMTABP  EQU   ALCWA+96
ALGTABSZ EQU   ALCWA+92
ALGTABP  EQU   ALCWA+88
@NM00030 EQU   ALCWA+78
OTHEREQS EQU   CNTABLE+32
SUBSREQS EQU   CNTABLE+28
STRGREQS EQU   CNTABLE+24
PUBLREQS EQU   CNTABLE+20
PVTNREQS EQU   CNTABLE+16
SPECREQS EQU   CNTABLE+12
TPREQS   EQU   CNTABLE+8
VAMREQS  EQU   CNTABLE+4
DMYREQS  EQU   CNTABLE
EDTABPTR EQU   ALCWA+24
IOSLUTP  EQU   ALCWA+16
JSCBPTR  EQU   ALCWA+12
FMAPPTR  EQU   ALCWA+4
WASIZE   EQU   ALCWA
@NM00029 EQU   JFCBX+144
JFCBXDEV EQU   JFCBX+140
JFCBXNAM EQU   JFCBX+96
@NM00028 EQU   JFCBX+94
@NM00027 EQU   JFCBX+3
JFCBXTTR EQU   JFCBX
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00023 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SIOTVMVP EQU   INDMSIOT+164
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SCTANAME EQU   INDMSIOT+122
SIOTSSIC EQU   INDMSIOT+120
@NM00022 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
@NM00021 EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
SIOTSSWA EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00020 EQU   SIOTALTD
@NM00019 EQU   SIOTALTD
@NM00018 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00017 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00016 EQU   SIOTBYT4
SIOTRACT EQU   SIOTBYT4
SIOTRACD EQU   SIOTBYT4
SIOTPROT EQU   SIOTBYT4
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00015 EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00014 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
SCTALCHK EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
SIOTSSMG EQU   SIOTTSTC
SIOTSSGP EQU   SIOTTSTC
@NM00013 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
SIOTINFC EQU   SIOTTSTC
@NM00012 EQU   SIOTBYT3
SIOTDSID EQU   SIOTBYT3
S3400OFF EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SIOTDDNT EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTVRSB EQU   INDMSIOT+36
@NM00011 EQU   INDMSIOT+35
@NM00010 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
SIOTVLSP EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
@NM00009 EQU   VUGRLENT+5
@NM00008 EQU   VUGRLFLG
VUGRALCD EQU   VUGRLFLG
VUGRLIDS EQU   VUGRLENT
VUCBS    EQU   VUPOOL+4
VUPOOL#  EQU   VUPOOL
VOLALGTP EQU   VOLUNTAB+12
VURCVYPR EQU   VOLSTATD
VUVLUNIQ EQU   VOLSTATD
VUDMUNIQ EQU   VOLSTATD
VUUNALSW EQU   VOLSTATD
VUDMNDAL EQU   VOLSTATD
VUDMNDOF EQU   VOLSTATD
VUREALOC EQU   VOLSTATD
VUMUGDON EQU   VOLSTATD
@NM00007 EQU   VOLSTATC
@NM00006 EQU   VOLSTATC
VURECVRY EQU   VOLSTATC
VUAFFWRK EQU   VOLSTATB
VUVINELG EQU   VOLSTATB
VUDADSME EQU   VOLSTATB
VUDNALOC EQU   VOLSTATB
VUPROCED EQU   VOLSTATB
VOLALOC  EQU   VOLSTATB
VOLRESVE EQU   VOLSTATA
@NM00004 EQU   VRBIND2
@NM00003 EQU   VRBIND2
@NM00002 EQU   VRBIND2
@NM00001 EQU   VRBIND1
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00094 EQU   @RC00093
@RC00155 EQU   @RC00154
@RC00260 EQU   @RC00258
@RC00344 EQU   @RC00338
@RC00366 EQU   @RC00364
@RF00373 EQU   @RC00371
@RC00211 EQU   @RC00185
@RF00424 EQU   @RC00147
@ENDDATA EQU   *
         END   IEFAB423,(C'PLS1759',0701,78128)

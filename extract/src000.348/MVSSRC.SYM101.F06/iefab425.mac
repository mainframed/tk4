         TITLE 'IEFAB425 - PROCESS TP REQUESTS                         *
                        '
IEFAB425 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB425  74.211'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(4),0(@01)                               01S0001
         MODESET EXTKEY=SCHED
*/*                                                                  */
*VUPTR    = VOLUNPTR;                  /*PTR TO 1ST VOLUNIT TAB ENTRY*/
         L     @08,@PC00001                                     01S0043
         L     @08,ALCWAPTR(,@08)                               01S0043
         MVC   VUPTR(4),VOLUNPTR(@08)                           01S0043
*DEVPOSCT = ONE;                       /*INIT REL POS CTR FOR REQUEST*/
         MVC   DEVPOSCT(2),@CH00055                             01S0044
*TPRTNCD  = ZERO;                      /*INIT RETURN CODE            */
         SLR   TPRTNCD,TPRTNCD                                  01S0045
*ENQTP(1:ENQTPLN) = ENQCORE(1:ENQTPLN);  /*ENQ LIST TO DSECT         */
         L     @05,ENQTPLN                                      01S0046
         BCTR  @05,0                                            01S0046
         EX    @05,@SM00822                                     01S0046
*TPQ = ON;                             /*ENQ INDICATOR TO ESTAE PARMS*/
         L     @08,EXITPRMP(,@08)                               01S0047
         OI    TPQ(@08),B'00000100'                             01S0047
*GEN REFS(ENQTP);                      /*ENQ ON ALLOCTP RESOURCE     */
     ENQ MF=(E,ENQTP)
*DO WHILE(TPREQS ^= ZERO               /*PROCESS ALL TP REQS         */
*       & TPRTNCD = ZERO);             /*NO ERRORS                   */
         B     @DE00049                                         01S0049
@DL00049 DS    0H                                               01S0050
*  SIOTPTR = VOLSIOTP;                 /*PTR TO SIOT FOR CURRNT ENTRY*/
         L     @08,VUPTR                                        01S0050
         L     @05,VOLSIOTP(,@08)                               01S0050
         ST    @05,SIOTPTR                                      01S0050
*  IF VOLCOREQ = ON THEN               /*TP REQUEST?                 */
         TM    VOLCOREQ(@08),B'01000000'                        01S0051
         BNO   @RF00051                                         01S0051
*    DO;                               /* IF YES                     */
*      TPINDFLG = ZERO;                /*INIT UPDATE FLAG AREA       */
         SLR   @08,@08                                          01S0053
         ST    @08,TPINDFLG                                     01S0053
*      IF DEVPOSCT = ONE THEN          /*1ST REQ FOR CURRENT SIOT?   */
         CLC   DEVPOSCT(2),@CH00055                             01S0054
         BNE   @RF00054                                         01S0054
*        DO;                           /* IF YES                     */
*          MULREQCT = SVOLUNNO;        /*#ENTRIES FOR CURRENT SIOT   */
         LH    @08,SVOLUNNO(,@05)                               01S0056
         ST    @08,MULREQCT                                     01S0056
*          NUMDEVRQ = SIOTOTUN;        /*#DEV TO BE ALOC'D,CURRNT SIO*/
         SLR   @08,@08                                          01S0057
         IC    @08,SIOTOTUN(,@05)                               01S0057
         STH   @08,NUMDEVRQ                                     01S0057
*        END;                                                   01S0058
*      ELSE                                                     01S0059
*        UPDTEFLG = ON;                /*ETIOT UPDATE REQUIRED       */
         B     @RC00054                                         01S0059
@RF00054 OI    UPDTEFLG,B'10000000'                             01S0059
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - TPUCBTAB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD TP UCB SELECTION TABLE                  */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*                                                                  */
*/*   THIS SEGMENT BUILDS A TABLE CONSISTING OF HALFWORD UCB PTRS.   */
*/*   IT USES ALL GENERIC AND GROUP ENTRIES OF THE EDL ASSOCIATED    */
*/*   WITH A SINGLE DD REQUEST AND SORTS THE TABLE INTO ASCENDING    */
*/*   ORDER OF UCB ADDRESSES.                                        */
*/*                                                                  */
*/* ENTRY - TPUCBTAB - INCLUDED AS AN INLINE SEGMENT                 */
*/*                                                                  */
*/*   PURPOSE -                                                      */
*/*      BUILD A UCB SELECTION TABLE FOR TP REQUESTS                 */
*/*                                                                  */
*/* EXIT                                                             */
*/*   CONDITION - NO ERROR,TOTNOUCB > 1                              */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       UCB ADDRESSES, SORTED INTO ASCENDING ORDER OF UCB ADDRESS, */
*/*         (UCBTBPTR).                                              */
*/*           UCBSRCH = ON                                           */
*/*           GTMNSW = ON                                            */
*/*                                                                  */
*/*     RETURN CODES -                                               */
*/*       TPRTNCD = ZERO INDICATES NO ERROR                          */
*/*                                                                  */
*/*   CONDITION - NO ERROR, TOTNOUCB = 1.                            */
*/*     OUTPUT -                                                     */
*/*       UCBSRCH = OFF                                              */
*/*     RETURN CODES - NONE                                          */
*/*                                                                  */
*/*   CONDITION - NO ERROR, TOTNOUCB = 1.                            */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       GTMNSW  = OFF                                              */
*/*       UCBSRCH = ON                                               */
*/*       LISTCT = ONE                                               */
*/*       EDLPTR - PTR TO GENERIC ENTRY                              */
*/*       EDLGNTP- PTR TO GROUP ENTRY                                */
*/*       EDLUCBLP- PTR TO UCB LIST                                  */
*/*     RETURN CODES - NONE                                          */
*/*                                                                  */
*/*   CONDITION  ERROR WHEN OBTAINING CORE FOR TABLE                 */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*       GETMAIN SWITCH OFF                                         */
*/*                                                                  */
*/*     RETURN CODES -                                               */
*/*       TPRTNCD = 4                                                */
*/********************************************************************/
*IF DEVPOSCT = ONE THEN                                         02S0060
@RC00054 CLC   DEVPOSCT(2),@CH00055                             02S0060
         BNE   @RF00060                                         02S0060
*  DO;                                                          02S0061
*    TOTNOUCB = ZERO;                  /*INITIALIZE UCB COUNT        */
         SLR   TOTNOUCB,TOTNOUCB                                02S0062
*    GTMNSW   = OFF;                   /*INIT GETMAIN DONE INDICATOR */
         NI    GTMNSW,B'01111111'                               02S0063
*    EDLPTR = EDLFGENP;                /*PT TO FIRST GENERIC ENTRY   */
         L     @08,SIOTPTR                                      02S0064
         L     @08,SIOTEDLP(,@08)                               02S0064
         L     EDLPTR,EDLFGENP(,@08)                            02S0064
*    DO WHILE EDLPTR ^= ZERO;          /*DO FOR ALL GENERICS         */
         B     @DE00065                                         02S0065
@DL00065 DS    0H                                               02S0066
*      EDLGNTP = EDLGRPTR;             /*POINT TO FIRST GROUP ENTRY  */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0066
*      DO WHILE EDLGNTP ^= ZERO;       /*DO FOR ALL GROUP ENTRIES    */
         B     @DE00067                                         02S0067
@DL00067 DS    0H                                               02S0068
*        TOTNOUCB = TOTNOUCB +EDLUCBNO; /*COUNT # OF UCB'S           */
         AL    TOTNOUCB,EDLUCBNO(,EDLGNTP)                      02S0068
*        EDLGNTP  = EDLNXGRP;          /*PT TO NEXT GRP ENTRY IF ANY */
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0069
*      END;                                                     02S0070
@DE00067 LTR   EDLGNTP,EDLGNTP                                  02S0070
         BNZ   @DL00067                                         02S0070
*      EDLPTR = EDLNXTNT;              /*PT TO NEXT GEN ENTRY IF ANY */
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0071
*    END;                                                       02S0072
@DE00065 LTR   EDLPTR,EDLPTR                                    02S0072
         BNZ   @DL00065                                         02S0072
*    IF TOTNOUCB = ONE THEN            /*IF YES,DON'T NEED TO BUILD  */
         LA    @08,1                                            02S0073
         CR    TOTNOUCB,@08                                     02S0073
         BNE   @RF00073                                         02S0073
*      DO;                             /*A TABLE OR SORT.            */
*        EDLPTR = EDLFGENP;            /*PT TO THE GENERIC ENTRY     */
         L     @05,SIOTPTR                                      02S0075
         L     @05,SIOTEDLP(,@05)                               02S0075
         L     EDLPTR,EDLFGENP(,@05)                            02S0075
*        EDLGNTP = EDLGRPTR;           /*PT TO THE GROUP ENTRY       */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0076
*        EDLUCBLP= EDLLISTP;           /*PT TO UCB LIST              */
         L     @05,EDLLISTP(,EDLGNTP)                           02S0077
         ST    @05,EDLUCBLP                                     02S0077
*        LISTCT  = ONE;                /*UCB INDEX                   */
         ST    @08,LISTCT                                       02S0078
*        UCBPTR = EDLUCBAD(LISTCT);                             02S0079
         SLA   @08,2                                            02S0079
         ALR   @05,@08                                          02S0079
         AL    @05,@CF00827                                     02S0079
         SLR   @08,@08                                          02S0079
         ICM   @08,3,EDLUCBAD(@05)                              02S0079
         ST    @08,UCBPTR                                       02S0079
*        UCBSRCH = ON;                 /*PREVENT TABLE/UCBLIST SEARCH*/
         OI    UCBSRCH,B'10000000'                              02S0080
*      END;                                                     02S0081
*    ELSE                              /*TOTAL NO UCB > ONE          */
*      DO;                                                      02S0082
         B     @RC00073                                         02S0082
@RF00073 DS    0H                                               02S0083
*        UCBSRCH = OFF;                /*INITIALIZE SEARCH CONTROL   */
         NI    UCBSRCH,B'01111111'                              02S0083
*        CORBYTES = TOTNOUCB * TWO;    /*CALC AMT OF CORE NEEDED     */
         LR    @08,TOTNOUCB                                     02S0084
         ALR   @08,@08                                          02S0084
         ST    @08,CORBYTES                                     02S0084
*         /* ?GETSTORG (POOLNO,CORBYTES,TABLEPTR);*/            02S0085
*           /* DEFINITIONS OF GETMAIN PARMS */                  02S0085
*           DCL                                                 02S0085
*             GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/       02S0085
*             GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/       02S0085
*             GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/       02S0085
*             GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/       02S0085
*             GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */       02S0085
*           DCL                                                 02S0086
*             GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/       02S0086
*             GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/       02S0086
*             GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/       02S0086
*             GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/       02S0086
*             GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/       02S0086
*             GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/       02S0086
*             GTSTZERO FIXED(31) INIT(0),                       02S0086
*             GTST253  FIXED(31) CONSTANT(253);                 02S0086
*           RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/       02S0087
*           GTSTR0 = CORBYTES; /* SET AMOUNT*/                  02S0088
         LR    GTSTR0,@08                                       02S0088
*           GTSTR2 = POOLNO; /* SET SUBPOOL*/                   02S0089
         LA    GTSTR2,230                                       02S0089
*           GENERATE CODE;                                      02S0090
             GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*           GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/       02S0091
         ST    GTSTR15,GTSTRTCD                                 02S0091
*           TABLEPTR = GTSTR1; /* ADDR OF GOTN STORG*/          02S0092
         LR    TABLEPTR,GTSTR1                                  02S0092
*           RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */        02S0093
*           IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */       02S0094
         L     @08,GTSTRTCD                                     02S0094
         LTR   @08,@08                                          02S0094
         BNZ   @RF00094                                         02S0094
*             DO;               /* YES, CLEAR STORAGE.*/        02S0095
*               RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,               02S0096
*                                  GTSTR7,GTSTR8) RSTD;         02S0096
*               GTSTR4 = TABLEPTR; /*STORG PTR*/                02S0097
         LR    GTSTR4,TABLEPTR                                  02S0097
*               GTSTR5 = CORBYTES; /*STORG AMNT*/               02S0098
         L     GTSTR5,CORBYTES                                  02S0098
*               GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/       02S0099
         SLR   GTSTR7,GTSTR7                                    02S0099
*               IF POOLNO = GTST253 THEN                        02S0100
         B     @RF00100                                         02S0100
*              GEN                                              02S0101
*           (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);   02S0101
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*               GEN REFS(GTSTR4,GTSTR6);                        02S0102
@RF00100 DS    0H                                               02S0102
                  MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*               IF POOLNO = GTST253 THEN                        02S0103
         B     @RF00103                                         02S0103
*                 GEN (MODESET KEYADDR=(2));                    02S0104
         MODESET KEYADDR=(2)
*               RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,               02S0105
*                                  GTSTR7,GTSTR8) UNRSTD;       02S0105
@RF00103 DS    0H                                               02S0106
*             END;       /* STORAGE CLEARING COMPLETED */       02S0106
*           ELSE                                                02S0107
*           TABLEPTR= 0;   /* CLEAR RETURN ADDR. */             02S0107
         B     @RC00094                                         02S0107
@RF00094 SLR   TABLEPTR,TABLEPTR                                02S0107
*           GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */       02S0108
@RC00094 L     GTSTR15,GTSTRTCD                                 02S0108
*                                      /* RESTORE LIST PRINT STATUS  */
*/* OBTAIN CORE         */                                      02S0109
*        TPRTNCD = REG15;              /*SAVE RETURN CODE            */
         LR    TPRTNCD,REG15                                    02S0109
*        IF TPRTNCD = ZERO THEN        /*CHECK FOR ANY ERRORS        */
         LTR   TPRTNCD,TPRTNCD                                  02S0110
         BNZ   @RF00110                                         02S0110
*          DO;                         /*START TABLE BUILD           */
*            GTMNSW = ON;              /*INDICATE CORE OBTAINED      */
         OI    GTMNSW,B'10000000'                               02S0112
*            UCBNOCT= ONE;             /*INIT TABLE INDEX            */
         LA    UCBNOCT,1                                        02S0113
*            EDLPTR = EDLFGENP;        /*PT TO 1ST GENERIC ENTRY     */
         L     @08,SIOTPTR                                      02S0114
         L     @08,SIOTEDLP(,@08)                               02S0114
         L     EDLPTR,EDLFGENP(,@08)                            02S0114
*            DO WHILE EDLPTR ^= ZERO;  /*DO FOR EACH GENERIC         */
         B     @DE00115                                         02S0115
@DL00115 DS    0H                                               02S0116
*              EDLGNTP = EDLGRPTR;     /*PT TO 1ST GROUP             */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0116
*              DO WHILE EDLGNTP ^=ZERO; /*DO FOR EACH GROUP          */
         B     @DE00117                                         02S0117
@DL00117 DS    0H                                               02S0118
*                EDLUCBLP = EDLLISTP;  /*PT TO UCB LIST IN GRP ENTRY */
         MVC   EDLUCBLP(4),EDLLISTP(EDLGNTP)                    02S0118
*                DO LISTCT = ONE TO EDLUCBNO; /*STORE UCB PTR IN TAB */
         LA    @08,1                                            02S0119
         B     @DE00119                                         02S0119
@DL00119 DS    0H                                               02S0120
*                  UCBPTR =  EDLUCBAD(LISTCT);                  02S0120
         LR    @05,@08                                          02S0120
         SLA   @05,2                                            02S0120
         L     @01,EDLUCBLP                                     02S0120
         ALR   @01,@05                                          02S0120
         AL    @01,@CF00827                                     02S0120
         SLR   @05,@05                                          02S0120
         ICM   @05,3,EDLUCBAD(@01)                              02S0120
         ST    @05,UCBPTR                                       02S0120
*                  UCBTBPTR(UCBNOCT)= EDLUCBAD(LISTCT); /*ADR OF PTR */
         LR    @15,UCBNOCT                                      02S0121
         ALR   @15,@15                                          02S0121
         AL    @15,@CF00828                                     02S0121
         STH   @05,UCBTBPTR(@15,TABLEPTR)                       02S0121
*                  UCBNOCT = UCBNOCT + ONE; /* INCR TABLE INDEX      */
         AH    UCBNOCT,@CH00055                                 02S0122
*                END;                                           02S0123
         AH    @08,@CH00055                                     02S0123
@DE00119 ST    @08,LISTCT                                       02S0123
         C     @08,EDLUCBNO(,EDLGNTP)                           02S0123
         BNH   @DL00119                                         02S0123
*                EDLGNTP = EDLNXGRP;   /* PT TO NEXT GROUP           */
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0124
*              END;                                             02S0125
@DE00117 LTR   EDLGNTP,EDLGNTP                                  02S0125
         BNZ   @DL00117                                         02S0125
*              EDLPTR = EDLNXTNT;      /* PT TO NEXT GENERIC         */
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0126
*            END;                                               02S0127
@DE00115 LTR   EDLPTR,EDLPTR                                    02S0127
         BNZ   @DL00115                                         02S0127
*            UCBNOCT = UCBNOCT - ONE;  /*ADJUST # OF UCBS FOR LOOP   */
         BCTR  UCBNOCT,0                                        02S0128
*            EXCHANGS = ON;            /*LOOP ENTRY CONDITION        */
         OI    EXCHANGS,B'10000000'                             02S0129
*            DO SCAN=ONE TO UCBNOCT WHILE(EXCHANGS=ON); /*SORTTAB    */
         LA    SCAN,1                                           02S0130
         B     @DE00130                                         02S0130
@DL00130 TM    EXCHANGS,B'10000000'                             02S0130
         BNO   @DC00130                                         02S0130
*              EXCHANGS = OFF;         /*SET OUTER LOOP CTRL         */
         NI    EXCHANGS,B'01111111'                             02S0131
*              DO TPS = ONE TO (UCBNOCT-ONE); /*CHECK EACH MEMBER    */
         LA    TPS,1                                            02S0132
         B     @DE00132                                         02S0132
@DL00132 DS    0H                                               02S0133
*                IF UCBTBPTR(TPS)                               02S0133
*                     > UCBTBPTR(TPS+ONE) THEN /* DO SWAP            */
         LR    @08,TPS                                          02S0133
         ALR   @08,@08                                          02S0133
         ST    @08,@TF00001                                     02S0133
         ALR   @08,TABLEPTR                                     02S0133
         AL    @08,@CF00828                                     02S0133
         LR    @01,TABLEPTR                                     02S0133
         AL    @01,@TF00001                                     02S0133
         CLC   UCBTBPTR(2,@08),UCBTBPTR(@01)                    02S0133
         BNH   @RF00133                                         02S0133
*                  DO;                 /*EXCHANGE VIA EXCLUSIVE OR'S */
*                    UCBTBPTR(TPS) = UCBTBPTR(TPS)              02S0135
*                        && UCBTBPTR(TPS+ONE);                  02S0135
         LR    @08,TABLEPTR                                     02S0135
         AL    @08,@TF00001                                     02S0135
         SLR   @15,@15                                          02S0135
         ICM   @15,3,UCBTBPTR(@08)                              02S0135
         LR    @08,TABLEPTR                                     02S0135
         AL    @08,@TF00001                                     02S0135
         AL    @08,@CF00828                                     02S0135
         SLR   @14,@14                                          02S0135
         ICM   @14,3,UCBTBPTR(@08)                              02S0135
         XR    @15,@14                                          02S0135
         L     @08,@TF00001                                     02S0135
         AL    @08,@CF00828                                     02S0135
         STH   @15,UCBTBPTR(@08,TABLEPTR)                       02S0135
*                    UCBTBPTR(TPS+ONE) = UCBTBPTR(TPS+ONE)      02S0136
*                        && UCBTBPTR(TPS);                      02S0136
         LR    @08,TABLEPTR                                     02S0136
         AL    @08,@TF00001                                     02S0136
         SLR   @14,@14                                          02S0136
         ICM   @14,3,UCBTBPTR(@08)                              02S0136
         XR    @15,@14                                          02S0136
         L     @08,@TF00001                                     02S0136
         STH   @15,UCBTBPTR(@08,TABLEPTR)                       02S0136
*                    UCBTBPTR(TPS) =UCBTBPTR(TPS)               02S0137
*                        && UCBTBPTR(TPS+ONE);                  02S0137
         LR    @08,TABLEPTR                                     02S0137
         AL    @08,@TF00001                                     02S0137
         AL    @08,@CF00828                                     02S0137
         SLR   @14,@14                                          02S0137
         ICM   @14,3,UCBTBPTR(@08)                              02S0137
         XR    @15,@14                                          02S0137
         L     @08,@TF00001                                     02S0137
         AL    @08,@CF00828                                     02S0137
         STH   @15,UCBTBPTR(@08,TABLEPTR)                       02S0137
*                    EXCHANGS = ON;     /*INDICATE EXCHANGE OCCURRED */
         OI    EXCHANGS,B'10000000'                             02S0138
*                  END;                                         02S0139
*                ELSE;                 /*COMPARE WITH NEXT MEMBER    */
@RF00133 DS    0H                                               02S0141
*              END;                    /*ALL MEMBERS SCANNED         */
         AH    TPS,@CH00055                                     02S0141
@DE00132 LR    @08,UCBNOCT                                      02S0141
         BCTR  @08,0                                            02S0141
         CR    TPS,@08                                          02S0141
         BNH   @DL00132                                         02S0141
*            END;                      /*TABLE COMPLETELY SORTED     */
         AH    SCAN,@CH00055                                    02S0142
@DE00130 CR    SCAN,UCBNOCT                                     02S0142
         BNH   @DL00130                                         02S0142
@DC00130 DS    0H                                               02S0143
*          END;                                                 02S0143
*        ELSE;                         /*TPRTNCD = ERROR             */
@RF00110 DS    0H                                               02S0145
*      END;                            /* GTMN/BUILD/SORT DONE       */
*  END;                                /*END FOR DEVPOSCT=ONE SECTION*/
*ELSE                                  /*MULTIUNIT REQ,DEVPOSCT ^=1  */
*  UCBSRCH = OFF;                      /*RESET SEARCH CONTROL        */
         B     @RC00060                                         02S0147
@RF00060 NI    UCBSRCH,B'01111111'                              02S0147
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - TPEDLSEL                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SEARCH EDL TO SELECT UCB FOR TP               */
*/*                                                                  */
*/* FUNCTION                                                         */
*/*                                                                  */
*/*   THIS SEGMENT SETS UP PTRS TO THE UCB TO BE ALLOCATED. IT       */
*/*   SEARCHES THE EDL'S FOR A MATCH BETWEEN A UCB LIST ELEMENT      */
*/*   AND THE UCB TABLE ELEMENT THAT IS TO BE ALLOCATED. THE VARIABLE*/
*/*   'DEVPOSCT' DETERMINES WHICH UCB TABLE ELEMENT IS USED.         */
*/*                                                                  */
*/* ENTRY - INCLUDED AS AN INLINE SEGMENT.                           */
*/*                                                                  */
*/*   PURPOSE - SELECT THE UCB TO BE ALLOCATED                       */
*/*                                                                  */
*/* EXIT                                                             */
*/*                                                                  */
*/*   CONDITIONS -                                                   */
*/*     UCB SELECTED                                                 */
*/*                                                                  */
*/*     OUTPUT                                                       */
*/*       PTR TO UCB TO BE ALLOCATED                                 */
*/*       EDLPTR - PTR TO GENERIC ENTRY                              */
*/*       EDLGNTP - PTR TO GROUP ENTRY                               */
*/*       EDLUCBLP - UCBLIST PTR                                     */
*/*       EDLUCBAD - UCB ADDRESS SELECTED                            */
*/*                                                                  */
*/*     RETURN CODES                                                 */
*/*       NONE                                                       */
*/*                                                                  */
*/********************************************************************/
*EDLPTR = EDLFGENP;                    /*PT TO 1ST GENERIC ENTRY     */
@RC00060 L     @08,SIOTPTR                                      02S0148
         L     @08,SIOTEDLP(,@08)                               02S0148
         L     EDLPTR,EDLFGENP(,@08)                            02S0148
*DO WHILE (EDLPTR ^= ZERO&TPRTNCD=ZERO& UCBSRCH =OFF); /*FOR EACH ONE*/
         B     @DE00149                                         02S0149
@DL00149 DS    0H                                               02S0150
*  EDLGNTP = EDLGRPTR;                 /*PT TO EDL GROUP ENTRY       */
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0150
*    DO WHILE (EDLGNTP ^=ZERO&UCBSRCH =OFF); /*SCAN EACH GROUP       */
         B     @DE00151                                         02S0151
@DL00151 DS    0H                                               02S0152
*      EDLUCBLP = EDLLISTP;            /*PTR TO UCB LIST FOR GROUP   */
         MVC   EDLUCBLP(4),EDLLISTP(EDLGNTP)                    02S0152
*      DO LISTCT = ONE TO EDLUCBNO WHILE (UCBSRCH=OFF);         02S0153
         LA    @08,1                                            02S0153
         B     @DE00153                                         02S0153
@DL00153 TM    UCBSRCH,B'10000000'                              02S0153
         BNZ   @DC00153                                         02S0153
*        IF UCBTBPTR(DEVPOSCT)=EDLUCBAD(LISTCT) THEN /*MATCH?        */
         LH    @05,DEVPOSCT                                     02S0154
         ALR   @05,@05                                          02S0154
         SLA   @08,2                                            02S0154
         ALR   @05,TABLEPTR                                     02S0154
         AL    @05,@CF00828                                     02S0154
         L     @03,EDLUCBLP                                     02S0154
         ALR   @03,@08                                          02S0154
         AL    @03,@CF00827                                     02S0154
         CLC   UCBTBPTR(2,@05),EDLUCBAD(@03)                    02S0154
         BNE   @RF00154                                         02S0154
*          UCBSRCH = ON;               /* MATCH FOUND                */
         OI    UCBSRCH,B'10000000'                              02S0155
*      END;                                                     02S0156
@RF00154 LA    @08,1                                            02S0156
         AL    @08,LISTCT                                       02S0156
@DE00153 ST    @08,LISTCT                                       02S0156
         C     @08,EDLUCBNO(,EDLGNTP)                           02S0156
         BNH   @DL00153                                         02S0156
@DC00153 DS    0H                                               02S0157
*      IF UCBSRCH = OFF THEN           /*NO MATCH                    */
         TM    UCBSRCH,B'10000000'                              02S0157
         BNZ   @RF00157                                         02S0157
*        EDLGNTP = EDLNXGRP;           /*PT TO NEXT GROUP            */
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0158
*      ELSE;                           /*SAVE GRP ENTRY PTR          */
@RF00157 DS    0H                                               02S0160
*    END;                                                       02S0160
@DE00151 LTR   EDLGNTP,EDLGNTP                                  02S0160
         BZ    @DC00151                                         02S0160
         TM    UCBSRCH,B'10000000'                              02S0160
         BZ    @DL00151                                         02S0160
@DC00151 DS    0H                                               02S0161
*    IF UCBSRCH = OFF THEN             /*NO MATCH                    */
         TM    UCBSRCH,B'10000000'                              02S0161
         BNZ   @RF00161                                         02S0161
*      EDLPTR = EDLNXTNT;              /*PT TO NEXT GENERIC ENTRY    */
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0162
*    ELSE;                             /*SAVE GENERIC ENTRY PTR      */
@RF00161 DS    0H                                               02S0164
*  LISTCT = LISTCT - ONE;              /*ADJUST INDX FOR SELECTED UCB*/
         L     @08,LISTCT                                       02S0164
         BCTR  @08,0                                            02S0164
         ST    @08,LISTCT                                       02S0164
*END;                                                           02S0165
@DE00149 SLR   @08,@08                                          02S0165
         CR    EDLPTR,@08                                       02S0165
         BE    @DC00149                                         02S0165
         CR    TPRTNCD,@08                                      02S0165
         BNE   @DC00149                                         02S0165
         TM    UCBSRCH,B'10000000'                              02S0165
         BZ    @DL00149                                         02S0165
@DC00149 DS    0H                                               02S0166
*      IF TPRTNCD = ZERO THEN          /* IF RETURN CODE = 0,        */
         LTR   TPRTNCD,TPRTNCD                                  01S0166
         BNZ   @RF00166                                         01S0166
*        DO;                           /*NO ERROR OCCURRED           */
*          UCBDATAP  = ADDR(UCBDATA);  /*SET PTR TO UCBDATA          */
         LA    @08,UCBDATA                                      01S0168
         ST    @08,UCBDATAP                                     01S0168
*          VOLUMEID = VOLID;           /*SERIAL FOR IEFAB435         */
         L     @08,VUPTR                                        01S0169
         MVC   VOLUMEID(6),VOLID(@08)                           01S0169
*          GROUPID   = EDLGRID;        /*SET GROUPID FROM EDL        */
         MVC   GROUPID(4),EDLGRID(EDLGNTP)                      01S0170
*          UCBPTR = EDLUCBAD(LISTCT);  /*SET UCB ADDRESS PTR         */
         L     @08,LISTCT                                       01S0171
         SLA   @08,2                                            01S0171
         L     @01,EDLUCBLP                                     01S0171
         ALR   @01,@08                                          01S0171
         AL    @01,@CF00827                                     01S0171
         SLR   @08,@08                                          01S0171
         ICM   @08,3,EDLUCBAD(@01)                              01S0171
         ST    @08,UCBPTR                                       01S0171
*          IF UCBSYSR = ON THEN        /*LINE ACTIVE CONSOLE @YM04970*/
         TM    UCBSYSR(@08),B'00000010'                         01S0172
         BNO   @RF00172                                         01S0172
*            DO;                       /*                    @YM04970*/
*              TPRTNCD = FOUR;         /*SET ERROR RETURN    @YM04970*/
         LA    TPRTNCD,4                                        01S0174
*              SIOTRSNC = ACTCONSL;    /*SET REASON CODE     @YM04970*/
         L     @08,SIOTPTR                                      01S0175
         MVC   SIOTRSNC(2,@08),@CH00075                         01S0175
*            END;                      /*                    @YM04970*/
*          ELSE                        /*NOT ACTIVE CONSOLE  @YM04970*/
*            DO;                       /*                    @YM04970*/
         B     @RC00172                                         01S0177
@RF00172 DS    0H                                               01S0178
*              IF UCBNALOC = ON THEN   /*LINE IN USE BY SYSTEM  01S0178
*                                        FUNCTION            @YM04970*/
         L     @08,UCBPTR                                       01S0178
         TM    UCBNALOC(@08),B'00000100'                        01S0178
         BNO   @RF00178                                         01S0178
*                DO;                   /*                    @YM04970*/
*                  TPRTNCD = FOUR;     /*SET ERROR RETURN    @YM04970*/
         LA    TPRTNCD,4                                        01S0180
*                  SIOTRSNC = LININUSE; /*SET REASON CODE    @YM04970*/
         L     @08,SIOTPTR                                      01S0181
         MVC   SIOTRSNC(2,@08),@CH00080                         01S0181
*                END;                  /*NOT IN USE          @YM04970*/
*              ELSE                    /*                    @YM04970*/
*                DO;                   /*                    @YM04970*/
         B     @RC00178                                         01S0183
@RF00178 DS    0H                                               01S0184
*                  IF UCBALOC = ON THEN /*LINE ALLOCATED     @YM04970*/
         L     @08,UCBPTR                                       01S0184
         TM    UCBALOC(@08),B'00001000'                         01S0184
         BNO   @RF00184                                         01S0184
*                    DO;               /*                    @YM04970*/
*                      TPRTNCD = FOUR; /*SET ERROR RETURN    @YM04970*/
         LA    TPRTNCD,4                                        01S0186
*                      SIOTRSNC = LINEALOC; /*REASON CODE    @YM04970*/
         L     @08,SIOTPTR                                      01S0187
         MVC   SIOTRSNC(2,@08),@CH00078                         01S0187
*                    END;              /*                    @YM04970*/
*                  ELSE                /*LINE NOT ALLOCATED  @YM04970*/
*                    IF UCBONLI = OFF & /*IF NOT ONLINE      @YM04970*/
*                       UCBVHRSN=ON THEN /*HIERARCH OFFLINE  @YM04970*/
         B     @RC00184                                         01S0189
@RF00184 L     @08,UCBPTR                                       01S0189
         TM    UCBONLI(@08),B'10000000'                         01S0189
         BNZ   @RF00189                                         01S0189
         TM    UCBVHRSN(@08),B'00000010'                        01S0189
         BNO   @RF00189                                         01S0189
*                      DO;             /*                    @YM04970*/
*                        TPRTNCD = FOUR; /*SET ERROR RETURN  @YM04970*/
         LA    TPRTNCD,4                                        01S0191
*                        SIOTRSNC=TPNOTAVL; /*SET REASON CODE@YM04970*/
         L     @08,SIOTPTR                                      01S0192
         MVC   SIOTRSNC(2,@08),@CH00069                         01S0192
*                      END;            /*                    @YM04970*/
*                    ELSE              /*NO ERROR            @YM04970*/
*                      DO;             /*                    @YM04970*/
         B     @RC00189                                         01S0194
@RF00189 DS    0H                                               01S0195
*                        CALL IEFAB434(SIOTPTR,VUPTR,UCBPTR,TPINDFLG,
*                                 ETIODATA,ALCWAPTR,GROUPID,    01S0195
*                                 UCBDATAP); /*CALL             01S0195
*                                        IEFAB434/ALLOC REQ-UNIT     */
         LA    @08,SIOTPTR                                      01S0195
         ST    @08,@AL00001                                     01S0195
         LA    @08,VUPTR                                        01S0195
         ST    @08,@AL00001+4                                   01S0195
         LA    @08,UCBPTR                                       01S0195
         ST    @08,@AL00001+8                                   01S0195
         LA    @08,TPINDFLG                                     01S0195
         ST    @08,@AL00001+12                                  01S0195
         LA    @08,ETIODATA                                     01S0195
         ST    @08,@AL00001+16                                  01S0195
         L     @08,@PC00001                                     01S0195
         ST    @08,@AL00001+20                                  01S0195
         LA    @08,GROUPID                                      01S0195
         ST    @08,@AL00001+24                                  01S0195
         LA    @08,UCBDATAP                                     01S0195
         ST    @08,@AL00001+28                                  01S0195
         L     @15,@CV00051                                     01S0195
         LA    @01,@AL00001                                     01S0195
         BALR  @14,@15                                          01S0195
*                        TPRTNCD = REG15; /*SAVE RETURN CODE         */
         LR    TPRTNCD,REG15                                    01S0196
*                      END;            /*                    @YM04970*/
*                END;                  /*                    @YM04970*/
@RC00189 DS    0H                                               01S0198
@RC00184 DS    0H                                               01S0199
*            END;                      /*                    @YM04970*/
@RC00178 DS    0H                                               01S0200
*          IF TPRTNCD = ZERO THEN      /*NO ERROR IN IEFAB434        */
@RC00172 SLR   @08,@08                                          01S0200
         CR    TPRTNCD,@08                                      01S0200
         BNE   @RF00200                                         01S0200
*            DO;                                                01S0201
*              VOLALOC = ON;           /*MARK VOLUNIT ENTRY PROCESSED*/
         L     @05,VUPTR                                        01S0202
         OI    VOLALOC(@05),B'10000000'                         01S0202
*              EDLALCD(LISTCT) = ON;   /*MARK UCB ENTRY ALLOCATED    */
         L     @05,LISTCT                                       01S0203
         SLA   @05,2                                            01S0203
         L     @01,EDLUCBLP                                     01S0203
         ALR   @01,@05                                          01S0203
         AL    @01,@CF00828                                     01S0203
         OI    EDLALCD-2(@01),B'10000000'                       01S0203
*              MULREQCT =MULREQCT-ONE; /*UPDTE #ENTRIES LEFT FOR SIOT*/
         L     @05,MULREQCT                                     01S0204
         BCTR  @05,0                                            01S0204
         ST    @05,MULREQCT                                     01S0204
*              TOTVOLUN =TOTVOLUN-ONE; /*UPDTE COUNT OF  UNALLOCATED
*                                        VU ENTRIES                  */
         L     @15,@PC00001                                     01S0205
         L     @15,ALCWAPTR(,@15)                               01S0205
         L     @14,TOTVOLUN(,@15)                               01S0205
         BCTR  @14,0                                            01S0205
         ST    @14,TOTVOLUN(,@15)                               01S0205
*              IF MULREQCT = ZERO THEN /*ENTRIES FOR CRRNT SIOT DONE?*/
         CR    @05,@08                                          01S0206
         BNE   @RF00206                                         01S0206
*                DO;                   /* IF YES                     */
*                  DEVPOSCT = ONE;     /*RESET FOR NEW SIOT          */
         MVC   DEVPOSCT(2),@CH00055                             01S0208
*                  SIOTALCD = ON;      /*MARK SIOT PROCESSED         */
         L     @08,SIOTPTR                                      01S0209
         OI    SIOTALCD(@08),B'00000010'                        01S0209
*                  TPREQS =TPREQS-ONE; /*DEC # TP REQS IN ALCWA      */
         L     @08,TPREQS(,@15)                                 01S0210
         BCTR  @08,0                                            01S0210
         ST    @08,TPREQS(,@15)                                 01S0210
*                  TOTREQS=TOTREQS-ONE; /*DEC TOTAL # REQS IN ALCWA  */
         L     @08,TOTREQS(,@15)                                01S0211
         BCTR  @08,0                                            01S0211
         ST    @08,TOTREQS(,@15)                                01S0211
*                  IF GTMNSW = ON THEN /*IF A UCB TABLE WAS BUILT,   */
         TM    GTMNSW,B'10000000'                               01S0212
         BNO   @RF00212                                         01S0212
*                    CALL TPFRMAIN;    /*  FREE UP THE SPACE         */
         BAL   @14,TPFRMAIN                                     01S0213
*                  ELSE;                                        01S0214
@RF00212 DS    0H                                               01S0215
*                END;                                           01S0215
*              ELSE                                             01S0216
*                DEVPOSCT = DEVPOSCT + ONE; /*UPDTE RELATIVE POSIT
*                                      OF MULTIUNIT REQUEST          */
         B     @RC00206                                         01S0216
@RF00206 LA    @08,1                                            01S0216
         AH    @08,DEVPOSCT                                     01S0216
         STH   @08,DEVPOSCT                                     01S0216
*              VUPTR=VUPTR + VOLENTSZ; /*UPDTE VOLUNIT ENTRY POINTER */
@RC00206 L     @08,VUPTR                                        01S0217
         AL    @08,VOLENTSZ                                     01S0217
         ST    @08,VUPTR                                        01S0217
*            END;                                               01S0218
*          ELSE                        /* ERROR ALLOCATING REQUEST   */
*            IF GTMNSW =ON THEN        /*WAS A UCB TABLE BUILT?      */
         B     @RC00200                                         01S0219
@RF00200 TM    GTMNSW,B'10000000'                               01S0219
         BNO   @RF00219                                         01S0219
*              CALL TPFRMAIN;          /* FREE UCB TABLE             */
         BAL   @14,TPFRMAIN                                     01S0220
*            ELSE;                     /*FALL THROUGH TO RETURN      */
@RF00219 DS    0H                                               01S0222
*        END;                                                   01S0222
*      ELSE;                                                    01S0223
@RF00166 DS    0H                                               01S0224
*    END;                                                       01S0224
*  ELSE                                /*VOLUNIT ENTRY NOT TP REQ,   */
*    VUPTR = VUPTR + VOLENTSZ;         /*POINT TO NEXT ENTRY         */
         B     @RC00051                                         01S0225
@RF00051 L     @08,VUPTR                                        01S0225
         AL    @08,VOLENTSZ                                     01S0225
         ST    @08,VUPTR                                        01S0225
*END;                                                           01S0226
@RC00051 DS    0H                                               01S0226
@DE00049 SLR   @08,@08                                          01S0226
         L     @05,@PC00001                                     01S0226
         L     @05,ALCWAPTR(,@05)                               01S0226
         C     @08,TPREQS(,@05)                                 01S0226
         BE    @DC00049                                         01S0226
         CR    TPRTNCD,@08                                      01S0226
         BE    @DL00049                                         01S0226
@DC00049 DS    0H                                               01S0227
*GEN REFS(ENQTP);                      /*DEQ OFF ALLOCTP RESOURCE    */
     DEQ MF=(E,ENQTP)
*TPQ = OFF;                            /*DEQ INDICATOR TO ESTAE PARMS*/
         L     @10,@PC00001                                     01S0228
         L     @10,ALCWAPTR(,@10)                               01S0228
         L     @10,EXITPRMP(,@10)                               01S0228
         NI    TPQ(@10),B'11111011'                             01S0228
*RETURN CODE(TPRTNCD);                 /*RTNCD= ZERO FOR SUCCESS     */
         IC    @02,@OLDKEY                                      01S0229
         L     @13,4(,@13)                                      01S0229
         L     @00,@SIZDATD                                     01S0229
         LR    @01,@11                                          01S0229
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@04                                          01S0229
         L     @14,12(,@13)                                     01S0229
         LM    @00,@12,20(@13)                                  01S0229
         BR    @14                                              01S0229
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - TPFRMAIN                                          */
*/*                                                                  */
*/*                                                                  */
*/* FUNCTION - THIS SEGMENT FREES THE CORE IN WHICH THE              */
*/*            UCB TABLE WAS BUILT.                                  */
*/*                                                                  */
*/* ENTRY - INTERNAL PROCEDURE OF IEFAB425                           */
*/*                                                                  */
*/*   INPUT  -                                                       */
*/*     CORBYTES - AMOUNT OF CORE TO FREE                            */
*/*     TABLEPTR - ADDRESS OF THE AREA                               */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - CORE FOR TP UCB TABLE FREED                        */
*/*     OUTPUT   - NONE                                              */
*/*     RETURN CODES - NONE                                          */
*/********************************************************************/
*TPFRMAIN: PROC;                       /* TP FREEMAIN                */
TPFRMAIN STM   @14,@12,@SA00002                                 02S0230
*RFY(REG0,REG1) RSTD;                  /* RESTRICT REGISTERS         */
*REG0 = CORBYTES;                      /* LENGTH TO FREE             */
         L     REG0,CORBYTES                                    02S0232
*REG0 = REG0  SUBPL230;               /* FREE FROM SUBPOOL 230.     */
         O     REG0,@CF00800                                    02S0233
*REG1 = TABLEPTR;                      /* ADDR OF AREA TO FREE       */
         LR    REG1,TABLEPTR                                    02S0234
*GEN(FREEMAIN R,LV=(0),A=(1));         /* FREE UCBTABLE              */
         FREEMAIN R,LV=(0),A=(1)
*RFY(REG0,REG1) UNRSTD;                /* RELEASE REGS               */
*END TPFRMAIN;                                                  02S0237
@EL00002 DS    0H                                               02S0237
@EF00002 DS    0H                                               02S0237
@ER00002 LM    @14,@12,@SA00002                                 02S0237
         BR    @14                                              02S0237
*END IEFAB425                                                   01S0238
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A425SPEC)                                        *
*/*%INCLUDE SYSLIB  (A425DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        *
*/*%INCLUDE SYSLIB  (IEFZB425)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFZB422)                                        *
*/*%INCLUDE SYSLIB  (IEFZB423)                                        *
*/*%INCLUDE SYSLIB  (IEFZB447)                                        *
*/*%INCLUDE SYSLIB  (TPUCDATA)                                        *
*/*%INCLUDE SYSLIB  (TPUCBTAB)                                        *
*/*%INCLUDE SYSLIB  (TPUCSPEC)                                        *
*/*%INCLUDE SYSLIB  (TPEDLSEL)                                        *
*/*%INCLUDE SYSLIB  (TEDLSSPC)                                        *
*/*%INCLUDE SYSLIB  (TPFRMAIN)                                        *
*/*%INCLUDE SYSLIB  (TPFRMSPC)                                        *
*;                                                              01S0238
@DATA    DS    0H
@CH00055 DC    H'1'
@CH00069 DC    H'2'
@CH00080 DC    H'21'
@CH00078 DC    H'59'
@CH00075 DC    H'71'
@SM00822 MVC   ENQTP(0),ENQCORE
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    15F
@AL00001 DS    8A
@TF00001 DS    F
IEFAB425 CSECT
         DS    0F
@CF00827 DC    F'-4'
@CF00828 DC    F'-2'
@CF00800 DC    XL4'E6000000'
@DATD    DSECT
         DS    0D
EDLUCBLP DS    A
SIOTPTR  DS    A
UCBDATAP DS    A
UCBPTR   DS    A
VUPTR    DS    A
CORBYTES DS    F
LISTCT   DS    F
MULREQCT DS    F
GTSTRTCD DS    F
VENTRNBR DS    F
ETIODATA DS    CL4
         ORG   ETIODATA
DEVPOSCT DS    FL2
NUMDEVRQ DS    FL2
         ORG   ETIODATA+4
TPINDFLG DS    BL4
         ORG   TPINDFLG
UPDTEFLG DS    BL1
@NM00001 EQU   TPINDFLG+0
         ORG   TPINDFLG+4
GTMNSW   DS    BL1
GROUPID  DS    CL4
UCBDATA  DS    CL9
         ORG   UCBDATA
@NM00002 DS    CL2
VOLUMEID DS    CL6
@NM00003 DS    CL1
         ORG   UCBDATA+9
EXCHANGS DS    BL1
UCBSRCH  DS    BL1
@OLDKEY  DS    AL1
IEFAB425 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00051 DC    V(IEFAB434)
         DS    0D
VOLENTSZ DC    AL4(28)
GTSTZERO DC    F'0'
SYSQNAME DC    CL8'SYSIEFSD'
SYSRNAME DC    CL7'ALLOCTP'
IEFAB425 CSECT
         DS   0H
A425PTCH DC ((@DATA-@PSTART)/20)X'00'
IEFAB425 CSECT
ENQCORE ENQ (SYSQNAME,SYSRNAME,E,7,SYSTEM),MF=L
ENQTPLN DC A(*-ENQCORE)
@DATD    DSECT
ENQTP ENQ (SYSQNAME,SYSRNAME,E,7,SYSTEM),MF=L
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB425 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
UCBNOCT  EQU   @03
TOTNOUCB EQU   @03
SCAN     EQU   @05
TPS      EQU   @02
TPRTNCD  EQU   @04
TABLEPTR EQU   @10
EDLPTR   EQU   @02
EDLGNTP  EQU   @09
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
UCBTBPTR EQU   0
VOLUNTAB EQU   0
VOLID    EQU   VOLUNTAB
VOLSTAT  EQU   VOLUNTAB+6
VOLSTATA EQU   VOLSTAT
VOLSTATB EQU   VOLSTAT+1
VOLALOC  EQU   VOLSTATB
VOLSTATC EQU   VOLSTAT+2
VOLCOREQ EQU   VOLSTATC
VOLSTATD EQU   VOLSTAT+3
VOLSIOTP EQU   VOLUNTAB+16
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBVHRSN EQU   UCBWGT
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00007 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
ALCWA    EQU   0
CNTABLE  EQU   ALCWA+28
TPREQS   EQU   CNTABLE+8
TOTREQS  EQU   CNTABLE+36
TOTVOLUN EQU   CNTABLE+44
VOLUNPTR EQU   ALCWA+80
INDICATE EQU   ALCWA+112
@NM00009 EQU   ALCWA+113
TIOTHDRP EQU   ALCWA+120
EXITPRMP EQU   ALCWA+144
NAMES    EQU   0
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTOTUN EQU   INDMSIOT+39
SIOTBYT1 EQU   INDMSIOT+43
SIOTALCD EQU   SIOTBYT1
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTRSNC EQU   INDMSIOT+130
SIOTEDLP EQU   INDMSIOT+136
SVOLUNNO EQU   INDMSIOT+168
IEFEDL   EQU   0
EDLHDR   EQU   IEFEDL
EDLFGENP EQU   EDLHDR+8
EDLUVFLG EQU   EDLHDR+16
EDLENTRY EQU   0
EDLNXTNT EQU   EDLENTRY
EDLGRPTR EQU   EDLENTRY+12
EDLDTFLG EQU   EDLENTRY+20
EDLGNTRY EQU   0
EDLNXGRP EQU   EDLGNTRY
EDLUCBNO EQU   EDLGNTRY+4
EDLLISTP EQU   EDLGNTRY+8
EDLGRID  EQU   EDLGNTRY+12
EDLGRFLG EQU   EDLGNTRY+16
EDLUCBL  EQU   0
EDLUCBAD EQU   EDLUCBL
EDLINDIC EQU   EDLUCBL+2
EDLALCD  EQU   EDLINDIC
PRMESTAE EQU   0
PRMRESC  EQU   PRMESTAE+252
TPQ      EQU   PRMRESC
PRMFUNC  EQU   PRMESTAE+253
UCBBGN   EQU   0
ALCWAPTR EQU   0
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00006 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBOBS09 EQU   UCBDEV
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00006
UCBSKPFG EQU   @NM00006
UCBRIPND EQU   @NM00006
UCBRTIAC EQU   @NM00006
UCBRSV79 EQU   @NM00006
UCBRSV78 EQU   @NM00006
UCBRSV77 EQU   @NM00006
UCBOLTEP EQU   @NM00006
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00005 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
PRMNELM  EQU   PRMESTAE+288
PRMDSQF  EQU   PRMESTAE+284
PRMDSQL  EQU   PRMESTAE+280
PRMQDBP  EQU   PRMESTAE+276
PRMQMBP  EQU   PRMESTAE+272
PRMQMBLN EQU   PRMESTAE+268
PRMQMGP  EQU   PRMESTAE+264
PRMUCBP  EQU   PRMESTAE+260
PRMSIOTP EQU   PRMESTAE+256
PRMASID  EQU   PRMESTAE+254
@NM00034 EQU   PRMFUNC
VMVCALL  EQU   PRMFUNC
FREECORE EQU   PRMFUNC
DUMPOK   EQU   PRMFUNC
TIOTBLT  EQU   PRMFUNC
DSABCHN  EQU   PRMFUNC
UPDSABCK EQU   PRMFUNC
GENCLNUP EQU   PRMFUNC
@NM00033 EQU   PRMRESC
DSSUNREC EQU   PRMRESC
DSSTAP   EQU   PRMRESC
CHNGQ    EQU   PRMRESC
DDRQ     EQU   PRMRESC
ENQQ4    EQU   PRMRESC
@NM00032 EQU   PRMESTAE
EDLNOJES EQU   EDLINDIC
EDLVOLAF EQU   EDLINDIC
EDLENQ   EQU   EDLINDIC
EDLDADSM EQU   EDLINDIC
EDLJINEL EQU   EDLGRFLG
EINDEVTP EQU   EDLDTFLG
@NM00028 EQU   EDLENTRY+18
EDLNSCNT EQU   EDLENTRY+16
EDLGRPNO EQU   EDLENTRY+8
EDLDEVT  EQU   EDLENTRY+4
EDLMGENS EQU   EDLUVFLG
EDLVAM   EQU   EDLUVFLG
EDLGMTP  EQU   EDLHDR+12
EDLGENNO EQU   EDLHDR+4
EDLLUV   EQU   EDLHDR
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SJFCBPTR EQU   INDMSIOT+156
SIOTNPTR EQU   INDMSIOT+152
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLS EQU   INDMSIOT+132
SCTANAME EQU   INDMSIOT+122
@NM00027 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
SIODDQCR EQU   SIOTBYT2
SIOVDQCR EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00026 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00025 EQU   SIOTALTD
@NM00024 EQU   SIOTALTD
@NM00023 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00022 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00021 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00020 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00019 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
@NM00018 EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
@NM00017 EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
@NM00016 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00015 EQU   SIOTTSTC
@NM00014 EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTVRSB EQU   INDMSIOT+36
@NM00013 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00012 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00011 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
ALCPROCN EQU   NAMES+16
ALCSTEPN EQU   NAMES+8
ALCJOBN  EQU   NAMES
CANCELP  EQU   ALCWA+140
WORK3MP  EQU   ALCWA+136
WMASK2P  EQU   ALCWA+132
WMASKPTR EQU   ALCWA+128
LGENLOCK EQU   ALCWA+124
TCBP     EQU   ALCWA+116
ALCWASID EQU   ALCWA+114
@NM00010 EQU   @NM00009
NODEVERR EQU   @NM00009
NEEDRCVY EQU   @NM00009
ALCWAREC EQU   @NM00009
WAITIGEN EQU   @NM00009
UNITRECS EQU   @NM00009
ALCWADUL EQU   INDICATE
ALCWISAM EQU   INDICATE
DSSUNIT  EQU   INDICATE
DSSTAPE  EQU   INDICATE
PRIVASUM EQU   INDICATE
INDREQU  EQU   INDICATE
INDRETRY EQU   INDICATE
INDWAIT  EQU   INDICATE
QMGRRBP  EQU   ALCWA+108
RIMTABCT EQU   ALCWA+104
RIMTABLN EQU   ALCWA+100
RIMTABP  EQU   ALCWA+96
ALGTABSZ EQU   ALCWA+92
ALGTABP  EQU   ALCWA+88
VOLUNSZE EQU   ALCWA+84
@NM00008 EQU   ALCWA+78
LTUNITID EQU   ALCWA+76
NUMREQS  EQU   CNTABLE+40
OTHEREQS EQU   CNTABLE+32
SUBSREQS EQU   CNTABLE+28
STRGREQS EQU   CNTABLE+24
PUBLREQS EQU   CNTABLE+20
PVTNREQS EQU   CNTABLE+16
SPECREQS EQU   CNTABLE+12
VAMREQS  EQU   CNTABLE+4
DMYREQS  EQU   CNTABLE
EDTABPTR EQU   ALCWA+24
FAILRSCP EQU   ALCWA+20
IOSLUTP  EQU   ALCWA+16
JSCBPTR  EQU   ALCWA+12
SIOT1P   EQU   ALCWA+8
FMAPPTR  EQU   ALCWA+4
WASIZE   EQU   ALCWA
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00007
UCBHALI  EQU   @NM00007
UCBRSV09 EQU   @NM00007
UCBRSV08 EQU   @NM00007
UCBRSV07 EQU   @NM00007
UCBRSV06 EQU   @NM00007
UCBRSV05 EQU   @NM00007
UCBRSV04 EQU   @NM00007
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00004 EQU   UCB
VUGRID   EQU   VOLUNTAB+24
VUUCBP   EQU   VOLUNTAB+20
VOLALGTP EQU   VOLUNTAB+12
VOLUNTID EQU   VOLUNTAB+10
VURCVYPR EQU   VOLSTATD
VUVLUNIQ EQU   VOLSTATD
VUDMUNIQ EQU   VOLSTATD
VUUNALSW EQU   VOLSTATD
VUDMNDAL EQU   VOLSTATD
VUDMNDOF EQU   VOLSTATD
VUREALOC EQU   VOLSTATD
VUMUGDON EQU   VOLSTATD
@NM00031 EQU   VOLSTATC
@NM00030 EQU   VOLSTATC
@NM00029 EQU   VOLSTATC
VOLURREQ EQU   VOLSTATC
VOLGRREQ EQU   VOLSTATC
VOLDAREQ EQU   VOLSTATC
VOLTAREQ EQU   VOLSTATC
VUAFFWRK EQU   VOLSTATB
VUVINELG EQU   VOLSTATB
VUDADSME EQU   VOLSTATB
VUDNALOC EQU   VOLSTATB
VUPROCED EQU   VOLSTATB
VDEVREQD EQU   VOLSTATB
VOLMNTD  EQU   VOLSTATB
VOLDEFER EQU   VOLSTATA
VUDADSM  EQU   VOLSTATA
VOLRESVE EQU   VOLSTATA
VOLNSHR  EQU   VOLSTATA
VOLSTG   EQU   VOLSTATA
VOLSPEC  EQU   VOLSTATA
VOLPRV   EQU   VOLSTATA
VOLPUB   EQU   VOLSTATA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00073 EQU   @RC00060
@RC00166 EQU   @RC00051
@RC00200 EQU   @RC00166
@ENDDATA EQU   *
         END   IEFAB425,(C'PLS0536',0603,74211)

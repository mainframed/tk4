         TITLE 'IEFAB469 - JLOCATE                                     *
                        '
IEFAB469 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(24)                                          01S0001
         DC    C'IEFAB469 77208  UZ13400 '                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MVC   @PC00001(24),0(@01)                              01S0001
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*                                                               01S0049
*   /*****************************************************************/
*   /*                                                               */
*   /* THE REST OF THE FIELDS HAVE THE FOLLOWING FORMAT FOR JOB      */
*   /* ACCOUNTING- 1 BYTE- LENGTH OF FIELD VARIABLE BYTES- CONTENTS  */
*   /* OF FIELD (LAST 2 REPEATED FOR N FIELDS ) STEP ACCOUNTING HAS  */
*   /* THE FOLLOWING FORMAT FOR EACH STEP- 3 BYTES- MAXIMUM STEP     */
*   /* RUNNING TIME 1 BYTE- NBR OF FIELDS IN STEP 1 BYTE- LENGTH OF  */
*   /* FIELD VARIABLE BYTES- CONTENTS OF FIELD (LAST 2 REPEATED N    */
*   /* TIMES )                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0050
*   NQCORE(1:NQLENGTH)=PCNQLIST(1:NQLENGTH);/* ENQ LIST TO DSECT     */
         L     @10,NQLENGTH                                     01S0050
         BCTR  @10,0                                            01S0050
         EX    @10,@SM01147                                     01S0050
*   CTGPLPTR=HWCRIP;                /* CATALOG PARM LIST POINTER     */
         L     @10,@PC00001+4                                   01S0051
         L     @15,HWDATAP(,@10)                                01S0051
         L     CTGPLPTR,HWCRIP(,@15)                            01S0051
*   HWDSNCAT=OFF;                   /* INITIALIZE INDICATORS FOR     */
*   HWRESIOT=OFF;                   /* 'FOUND IN CATALOG - PDI'.     */
         L     @06,@PC00001                                     01S0053
         L     @14,HWCNTRLP(,@06)                               01S0053
         NI    HWDSNCAT(@14),B'11110011'                        01S0053
*   IF HWPDISCN=ON&                 /* SCAN THE PDI (LOCAL) AND      */
*       HWDOPDI=ON&                 /* SCAN THE PDI (GLOBAL) AND     */
*       JCTPDIP^=0 THEN             /* IF PDI EXISTS, SCAN PDI.      */
         TM    HWPDISCN(@14),B'10000000'                        01S0054
         BNO   @RF00054                                         01S0054
         TM    HWDOPDI(@14),B'10000000'                         01S0054
         BNO   @RF00054                                         01S0054
         L     @01,HWJCTP(,@15)                                 01S0054
         ICM   @00,7,JCTPDIP(@01)                               01S0054
         BZ    @RF00054                                         01S0054
*     CALL IEFAB455                 /* CALL IEFAB455                 */
*         (HWCNTRLP,HWDATAP,HWRTNP,SIOTPTR,DSNPTR,HWJCTP);      01S0055
         ST    @06,@AL00001                                     01S0055
         ST    @10,@AL00001+4                                   01S0055
         L     @10,@PC00001+8                                   01S0055
         ST    @10,@AL00001+8                                   01S0055
         L     @10,@PC00001+12                                  01S0055
         ST    @10,@AL00001+12                                  01S0055
         L     @10,@PC00001+20                                  01S0055
         ST    @10,@AL00001+16                                  01S0055
         ST    @15,@AL00001+20                                  01S0055
         L     @15,@CV00127                                     01S0055
         LA    @01,@AL00001                                     01S0055
         BALR  @14,@15                                          01S0055
*   IF HWRESIOT^=ON&                /* NOT FOUND IN PDI AND          */
*       HWSYSLOC=ON THEN            /* LOCATE 'REQUESTED'            */
@RF00054 L     @10,@PC00001                                     01S0056
         L     @10,HWCNTRLP(,@10)                               01S0056
         TM    HWRESIOT(@10),B'00001000'                        01S0056
         BO    @RF00056                                         01S0056
         TM    HWSYSLOC(@10),B'00100000'                        01S0056
         BNO   @RF00056                                         01S0056
*     DO;                           /* SETUP FOR SYSTEM LOCATE       */
*                                                               02S0058
*/********************************************************************/
*/* SEGMENT NAME - LOCATECT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - LOCATE CONTROL                                */
*/*                                                                  */
*/* FUNCTION -   CONTROLS ISSUANCES OF LOCATE (SVC 26) AND THE       */
*/*              PROCESSING OF THE RETURN CODES AND POSSIBLE         */
*/*              RECOVERY THEREFROM.                                 */
*/*                                                                  */
*/*   OPERATION- SEGMENT 'PARMINIT' WILL CREATE AND INITIALIZE       */
*/*              THE PARAMETER LIST TO LOCATE.                       */
*/*              THE VOLUME LIST AND CATALOG CONNECTOR AREA (FOR     */
*/*              ALIAS CATALOG NAMES) WILL BE ZEROED.  IF THE DD     */
*/*              IS A STEPCAT, THE DATASET NAME WILL BE PLACED INTO  */
*/*              THE CONNECTOR AREA TO ENABLE 'DD PROCESSING         */
*/*              CONTROL' (IEFAB452) TO DETERMINE IF THE STEPCAT     */
*/*              DATASET NAME WAS AN ALIAS FOR PCCB PROCESSING.      */
*/*              SVC 26 (LOCATE) IS ISSUED.                          */
*/*              A RETURN CODE OF ZERO (OR AN UNRECOVERABLE RETURN   */
*/*              CODE LIKE AN I/O ERROR) WILL TERMINATE SEGMENT      */
*/*              PROCESSING AND RETURN CONTROL TO JLOCATE WITH       */
*/*              APPROPRIATE RETURN AND REASON CODES.                */
*/*              SEGMENT 'REDOPREP' WILL HANDLE RECOVERABLE RETURN   */
*/*              CODES LIKE 'VOLUME LIST TOO SMALL', OR 'PRIVATE     */
*/*              CATALOG NEEDS TO BE ALLOCATED'.                     */
*/*              SEGMENT 'CLEANUP' WILL UPDATE THE SIOT AND JFCB     */
*/*              WITH RETRIEVED CATALOG INFORMATION IF THE LOCATE(S) */
*/*              WERE SUCCESSFUL.                                    */
*/*                                                                  */
*/* ENTRY - IF A SYSTEM LOCATE IS REQUIRED                           */
*/*                                                                  */
*/*   PURPOSE - CONTROL LOCATES AND ADDITIONAL PROCESSING            */
*/*                                                                  */
*/*   INPUT DATA - PTR TO CATALOG PARM LISTS,HSKP CONTROLS           */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - LOCATE(S) FOR SPECIFIED DATA SET FINISHED          */
*/*                                                                  */
*/*   OUTPUT DATA - COMPLETED CRI - LOCATE(S) SUCCESSFUL.            */
*/*                 REASON CODES -  LOCATE(S) UNSUCCESSFUL:          */
*/*                   01  DATASET NAME NOT FOUND IN CATALOG(S)       */
*/*                   12  STEP ERROR:  INSUFFICIENT CORE AVAILABLE   */
*/*                   13  STEP ERROR:  PERMANENT I/O ERROR           */
*/*                                                                  */
*/*   RETURN CODE - 0  SUCCESSFUL                                    */
*/*                 4 DD RELATED ERROR: LOCATE UNSUCCESSFUL          */
*/*                 8 STEP RELATED ERROR: LOCATE UNSUCCESSFUL.       */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0058
*                                                               03S0058
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - PARMINIT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - LOCATE PARAMETER AREAS INITIALIZATION         */
*/*                                                                  */
*/* FUNCTION - MAP AND INITIALIZE THE LOCATE PARAMETER AREA INTO     */
*/*            THE HOUSEKEEPING CRI (CATALOG RETURN INFORMATION).    */
*/*                                                                  */
*/*   OPERATION- THE LOCATE PARAMETER LIST, WORKAREA, INFO AREA, AND */
*/*            INITIAL VOLUME LIST IS MAPPED INTO THE HSKP CRI AND   */
*/*            INTERNAL POINTERS TO THE VARIOUS AREAS SET UP ONCE    */
*/*            PER STEP, ALONG WITH THE MAPPING OF ALLOCATE CATALOG  */
*/*            CONTROLS FROM VARIOUS HSKP GLOBAL CONTROLS.           */
*/*                                                                  */
*/*            ONCE PER JLOCATE INVOCATION, THE INPUT CONTROLS AND   */
*/*            POINTERS ARE MAPPED INTO THE VARIOUS AREAS FOR THE    */
*/*            INITIAL (AND SUBSEQUENT,IF ANY) LOCATES, PARALLEL     */
*/*            MOUNT AND DSORG INFORMATION ARE ALSO MAPPED.          */
*/*                                                                  */
*/* ENTRY - INLINE                                                   */
*/*                                                                  */
*/*   PURPOSE - MAP AND INITIALIZE LOCATE PARAMETER LISTS            */
*/*                                                                  */
*/*   INPUT DATA - PTR CRI,HSKPWA CONTROLS                           */
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - INITIALIZATION COMPLETE                            */
*/*                                                                  */
*/*   OUTPUT DATA - LOCATE AND ALLOCATE CATALOG PARAMETER LISTS      */
*/*                 AND CONTROL AREAS.                               */
*/*   RETURN CODE - N/A                                              */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0058
*       IF HWCATINT=OFF THEN        /* THE CTLG PARMS HAVE NOT BEEN  */
         TM    HWCATINT(@10),B'00000100'                        03S0058
         BNZ   @RF00058                                         03S0058
*         DO;                       /* INITIALIZED IN THIS JOB-STEP  */
*           CTGWKA=CTGPLPTR+LENGTH(CTGPL);/* MAP CATALOG WORKAREA    */
         LA    @06,28                                           03S0060
         ALR   @06,CTGPLPTR                                     03S0060
         ST    @06,CTGWKA(,CTGPLPTR)                            03S0060
*           CTGCVOL=CTGWKA+LENGTH(CTGWA);/* MAP CATALOG INFO AREA    */
         LA    @15,16                                           03S0061
         ALR   @15,@06                                          03S0061
         ST    @15,CTGCVOL(,CTGPLPTR)                           03S0061
*           CTGWAVL=CTGCVOL+LENGTH(CTGCV);/* INITIAL VOLUME LIST PTR */
         AL    @15,@CF01140                                     03S0062
         ST    @15,CTGWAVL(,@06)                                03S0062
*           CTGWALV=600;            /* INITIAL VOLUME LIST LENGTH    */
         MVC   CTGWALV(2,@06),@CH01130                          03S0063
*           CTGSUPLT=ON;            /* SUPER LOCATE                  */
*           CTGAM0=ON;              /* VS2 (AM0) LOCATE              */
         OI    CTGSUPLT(CTGPLPTR),B'00010001'                   03S0065
*           CTGDOCAT=ON;            /* DO NOT OPEN CATALOGS          */
*           CTGCOIN=ON;             /* SET CATALOG INTERCEPT FLAG ON
*                                                            @ZA24741*/
         OI    CTGDOCAT(CTGPLPTR),B'01010000'                   03S0067
*           HWCATINT=ON;            /* STEP INITIALIZATION DONE      */
         OI    HWCATINT(@10),B'00000100'                        03S0068
*         END;                                                  03S0069
*       RESTPCCB=OFF;               /* SET IF CATALOGS UNALLOCATED TO
*                                      ALLOCATE NEEDED CATALOG       */
@RF00058 NI    RESTPCCB,B'01111111'                             03S0070
*       SV26DONE=OFF;               /* COMPLETION INDICATOR          */
         NI    SV26DONE,B'01111111'                             03S0071
*       CTGWAVCT=0;                 /* RESET THE CATALOG WORKAREA,   */
         SLR   @10,@10                                          03S0072
         L     @06,CTGWKA(,CTGPLPTR)                            03S0072
         STH   @10,CTGWAVCT(,@06)                               03S0072
*       CTGWAUCT=0;                 /* EXCEPT FOR THE VOLUME LIST    */
         STH   @10,CTGWAUCT(,@06)                               03S0073
*       CTGWAGCT=0;                 /* ADDRESS AND LENGTH            */
         STH   @10,CTGWAGCT(,@06)                               03S0074
*       CTGWAGB=0;                                              03S0075
         ST    @10,CTGWAGB(,@06)                                03S0075
*       CTGNEWNM=0;                                             03S0076
         ST    @10,CTGNEWNM(,CTGPLPTR)                          03S0076
*       CTGGDGL=OFF;                /* RESET CATALOG CONTROLS FOR    */
         NI    CTGGDGL(CTGPLPTR),B'11110111'                    03S0077
*       CTGLBASE=OFF;               /* GDG DATA SET SUPPORT          */
         NI    CTGLBASE(CTGPLPTR),B'01111111'                   03S0078
*       IF HWLBASEL=ON THEN         /* LOCATE GDG SINGLE BASE LEVEL  */
         L     @10,@PC00001                                     03S0079
         L     @10,HWCNTRLP(,@10)                               03S0079
         TM    HWLBASEL(@10),B'00001000'                        03S0079
         BNO   @RF00079                                         03S0079
*         CTGLBASE=ON;                                          03S0080
         OI    CTGLBASE(CTGPLPTR),B'10000000'                   03S0080
*       ELSE                        /* NOT FOUND                     */
*         IF HWGDGSLC=ON THEN       /* SUBSEQUENT GDG SINGLE         */
         B     @RC00079                                         03S0081
@RF00079 L     @10,@PC00001                                     03S0081
         L     @10,HWCNTRLP(,@10)                               03S0081
         TM    HWGDGSLC(@10),B'00000100'                        03S0081
         BNO   @RF00081                                         03S0081
*           DO;                     /* LOCATE...THEN                 */
*             CTGGDGL=ON;           /* INDICATE THAT A GDG BASE      */
         OI    CTGGDGL(CTGPLPTR),B'00001000'                    03S0083
*             CTGWAGB=HWGDGBSP;     /* LEVEL POINTER IS PRESENT      */
         L     @10,CTGWKA(,CTGPLPTR)                            03S0084
         L     @06,@PC00001+4                                   03S0084
         L     @06,HWDATAP(,@06)                                03S0084
         L     @06,HWGDGBSP(,@06)                               03S0084
         ST    @06,CTGWAGB(,@10)                                03S0084
*           END;                                                03S0085
*       IF SIOTJSCT=ON×             /* SEARCH THE MASTER CATALOG     */
*           HWLOCCAT=ON THEN        /* ONLY FOR STEPCATS OR IF       */
@RF00081 DS    0H                                               03S0086
@RC00079 L     @10,@PC00001+12                                  03S0086
         L     @10,SIOTPTR(,@10)                                03S0086
         TM    SIOTJSCT(@10),B'00000001'                        03S0086
         BO    @RT00086                                         03S0086
         L     @10,@PC00001                                     03S0086
         L     @10,HWCNTRLP(,@10)                               03S0086
         TM    HWLOCCAT(@10),B'00000010'                        03S0086
         BNO   @RF00086                                         03S0086
@RT00086 DS    0H                                               03S0087
*         CTGSRH=ON;                /* REQUESTED BY THE CALLER       */
         OI    CTGSRH(CTGPLPTR),B'00000100'                     03S0087
*       ELSE                        /* OTHERWISE SEARCH ALL CATALOGS */
*         CTGSRH=OFF;               /* AVAILABLE                     */
         B     @RC00086                                         03S0088
@RF00086 NI    CTGSRH(CTGPLPTR),B'11111011'                     03S0088
*       CTGENT=DSNPTR;              /* ADDRESS OF DSNAME,            */
@RC00086 L     @10,@PC00001+20                                  03S0089
         L     @10,DSNPTR(,@10)                                 03S0089
         ST    @10,CTGENT(,CTGPLPTR)                            03S0089
*       CTGDSORG=JFCDSORG;          /* DSORG AND                     */
         L     @10,@PC00001+16                                  03S0090
         L     @10,JFCBPTR(,@10)                                03S0090
         MVC   CTGDSORG(2,CTGPLPTR),JFCDSORG(@10)               03S0090
*       IF SCTPARLM=ON THEN         /* PARALLEL MOUNT MAY BE NEEDED  */
         L     @10,@PC00001+12                                  03S0091
         L     @10,SIOTPTR(,@10)                                03S0091
         TM    SCTPARLM(@10),B'00000100'                        03S0091
         BNO   @RF00091                                         03S0091
*         CTGPAR=ON;                /* OR ALTERED BY LOCATE          */
         OI    CTGPAR(CTGPLPTR),B'10000000'                     03S0092
*       ELSE                        /* NOT NEEDED                    */
*         CTGPAR=OFF;                                           03S0093
         B     @RC00091                                         03S0093
@RF00091 NI    CTGPAR(CTGPLPTR),B'01111111'                     03S0093
*       CTGWAUCT=SCTNMBUT;          /* MINIMUM UNIT COUNT ALSO       */
@RC00091 L     @10,CTGWKA(,CTGPLPTR)                            03S0094
         L     @06,@PC00001+12                                  03S0094
         L     @06,SIOTPTR(,@06)                                03S0094
         SLR   @15,@15                                          03S0094
         IC    @15,SCTNMBUT(,@06)                               03S0094
         STH   @15,CTGWAUCT(,@10)                               03S0094
*       SV26DONE=OFF;               /* COMPLETION INDICATOR          */
         NI    SV26DONE,B'01111111'                             02S0095
*       DO WHILE(HWRTCD=0&SV26DONE=OFF);/* NO ERRORS & NOT FINISHED  */
         B     @DE00096                                         02S0096
@DL00096 DS    0H                                               02S0097
*         CTGCV=CTGCV&&CTGCV;       /* ZERO CATALOG INFO AREA        */
         L     @10,CTGCVOL(,CTGPLPTR)                           02S0097
         XC    CTGCV(94,@10),CTGCV(@10)                         02S0097
*         IF SIOTJSCT=ON THEN       /* SAVE THE STEPCAT DSNAME       */
         L     @10,@PC00001+12                                  02S0098
         L     @10,SIOTPTR(,@10)                                02S0098
         TM    SIOTJSCT(@10),B'00000001'                        02S0098
         BNO   @RF00098                                         02S0098
*           CTGCVCC=CTGENT->DSN;    /* FOR ALIAS NAME CHECK BY       */
         L     @10,CTGCVOL(,CTGPLPTR)                           02S0099
         L     @06,CTGENT(,CTGPLPTR)                            02S0099
         MVC   CTGCVCC(44,@10),DSN(@06)                         02S0099
*         RFY                                                   02S0100
*          (VOLSPTR,                                            02S0100
*           VOLLNTH,                                            02S0100
*           BYTEPTR,                                            02S0100
*           BYTLNTH) RSTD;          /* IEFAB452                      */
@RF00098 DS    0H                                               02S0101
*         VOLSPTR=CTGWAVL;          /* VOLUME LIST TO CLEAR          */
         L     @10,CTGWKA(,CTGPLPTR)                            02S0101
         L     VOLSPTR,CTGWAVL(,@10)                            02S0101
*         VOLLNTH=CTGWALV;          /* LENGTH TO CLEAR               */
         LH    VOLLNTH,CTGWALV(,@10)                            02S0102
*         BYTEPTR=ADDR(CLEAR1);     /* CLEAR CHARACTER               */
         LA    BYTEPTR,@CH00056+1                               02S0103
*         BYTLNTH=1;                /* MOVE ONE BYTE, THEN 'PAD'     */
         LA    BYTLNTH,1                                        02S0104
*         GEN(MVCL VOLSPTR,BYTEPTR);/* CLEAR THE VOLUME LIST         */
         MVCL VOLSPTR,BYTEPTR
*         RFY                                                   02S0106
*          (VOLSPTR,                                            02S0106
*           VOLLNTH,                                            02S0106
*           BYTEPTR,                                            02S0106
*           BYTLNTH) UNRSTD;                                    02S0106
*         PARMPTR=CTGPLPTR;         /* LOCATE PARM LIST POINTER      */
         LR    PARMPTR,CTGPLPTR                                 02S0107
*         GEN(LOCATE (1));          /* LOCATE INVOCATION             */
         LOCATE (1)
*         RTCDSAV=RTCDREG;          /* SAVE RETURN CODE - REG 15     */
         LR    RTCDSAV,RTCDREG                                  02S0109
*         IF RTCDSAV=0×RTCDSAV=NODSN×/* LOCATE OK OR TERMINATING     */
*             RTCDSAV=IOERR×RTCDSAV=ABORT×RTCDSAV=NOTCVOL THEN/* TYPE
*                                      ERROR                         */
         LTR   RTCDSAV,RTCDSAV                                  02S0110
         BZ    @RT00110                                         02S0110
         C     RTCDSAV,@CF00055                                 02S0110
         BE    @RT00110                                         02S0110
         C     RTCDSAV,@CF00083                                 02S0110
         BE    @RT00110                                         02S0110
         C     RTCDSAV,@CF00089                                 02S0110
         BE    @RT00110                                         02S0110
         C     RTCDSAV,@CF00070                                 02S0110
         BNE   @RF00110                                         02S0110
@RT00110 DS    0H                                               02S0111
*           DO;                                                 02S0111
*             SV26DONE=ON;          /* LOCATE LOOP EXIT              */
         OI    SV26DONE,B'10000000'                             02S0112
*             IF RTCDSAV=NODSN×     /* DATA SET NOT FOUND            */
*                 RTCDSAV=NOTCVOL THEN/* CVOL INDICATED BUT DOES     */
         C     RTCDSAV,@CF00055                                 02S0113
         BE    @RT00113                                         02S0113
         C     RTCDSAV,@CF00070                                 02S0113
         BNE   @RF00113                                         02S0113
@RT00113 DS    0H                                               02S0114
*               DO;                 /* NOT EXIST IN MASTER CTLG      */
*                 HWRTCD=DDERR;     /* DD RELATED ERROR - 4          */
         LA    @10,4                                            02S0115
         L     @09,@PC00001+8                                   02S0115
         L     @09,HWRTNP(,@09)                                 02S0115
         STH   @10,HWRTCD(,@09)                                 02S0115
*                 IF RTCDSAV=NOTCVOL THEN/* CVOL DOES NOT EXIST      */
         CR    RTCDSAV,@10                                      02S0116
         BNE   @RF00116                                         02S0116
*                   HWRSNCD=RSNCVOL;/* REASON CODE - 57              */
         MVC   HWRSNCD(2,@09),@CH00077                          02S0117
*                 ELSE              /* DATA SET NAME NOT FOUND       */
*                   HWRSNCD=DSNOTFND;/* REASON CODE - 01             */
         B     @RC00116                                         02S0118
@RF00116 L     @10,@PC00001+8                                   02S0118
         L     @10,HWRTNP(,@10)                                 02S0118
         MVC   HWRSNCD(2,@10),@CH00049                          02S0118
*               END;                                            02S0119
*             ELSE                  /* DATA SET FOUND                */
*               IF RTCDSAV^=0 THEN  /* OTHER ERROR                   */
         B     @RC00113                                         02S0120
@RF00113 LTR   RTCDSAV,RTCDSAV                                  02S0120
         BZ    @RF00120                                         02S0120
*                 DO;                                           02S0121
*                   HWRTCD=STEPERR; /* STEP RELATED ERROR - 8        */
         L     @10,@PC00001+8                                   02S0122
         L     @10,HWRTNP(,@10)                                 02S0122
         MVC   HWRTCD(2,@10),@CH00055                           02S0122
*                   IF RTCDSAV=IOERR THEN/* PERMANENT I/O ERROR      */
         C     RTCDSAV,@CF00083                                 02S0123
         BNE   @RF00123                                         02S0123
*                     HWRSNCD=RSNIOERR;/* REASON CODE - 13           */
         MVC   HWRSNCD(2,@10),@CH00075                          02S0124
*                   ELSE            /* INSUFFICIENT CORE             */
*                     HWRSNCD=RSNCORE;/* REASON CODE - 12            */
         B     @RC00123                                         02S0125
@RF00123 L     @10,@PC00001+8                                   02S0125
         L     @10,HWRTNP(,@10)                                 02S0125
         MVC   HWRSNCD(2,@10),@CH00073                          02S0125
*                 END;                                          02S0126
*           END;                                                02S0127
*         ELSE                      /* NEED LOCATE REISSUED          */
*           DO;                                                 02S0128
         B     @RC00110                                         02S0128
@RF00110 DS    0H                                               02S0129
*                                                               03S0129
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - REDOPREP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - PREPARE FOR LOCATE REISSUANCE                 */
*/*                                                                  */
*/* FUNCTION - PREPARE CATALOG PARAMETER LISTS FOR NEXT LOCATE,      */
*/*            OBTAINS LARGER VOLUME LIST, IF NECESSARY, AND CAUSES  */
*/*            PRIVATE CATALOGS TO BE ALLOCATED, OR PREPARED TO      */
*/*            BE ALLOCATED.                                         */
*/*                                                                  */
*/* OPERATION- RT CODE 40-OBTAIN A LARGER VOLUME LIST AND FREE THE   */
*/*            OLD ONE,IF NOT THE ORIGINAL VOL LIST IN HSKPWA(CRI).  */
*/*            INITIALIZE PARAMETERS AND CALL IEFAB4F5 TO ALLOCATE   */
*/*            PRIVATE CATALOGS,OPEN ACBS, AND/OR CREATE AND/OR      */
*/*            MODIFY PCCBS IF RT CODES-36(CATALOG NEEDED) OR 188    */
*/*            (STEPCAT NEEDED), IF NOT A STEPCAT DD, OR FOR @ZA02101*/
*/*            RT CODE 68 (CVOL NEEDED).                     @ZA02101*/
*/*            CALL IEFAB466 TO CREATE SIOT/JFCB FOR ANY PRIVATE     */
*/*            CATALOGS WHICH WERE ALLOCATED AND HAD A PCCB JUST     */
*/*            CREATED (ALLOCATED FOR THE FIRST TIME).               */
*/*                                                                  */
*/*            CANCEL SUBSEQUENT LOCATE PROCESSING ON AN ERROR       */
*/*                                                                  */
*/* ENTRY - AFTER SVC26 (LOCATE)                                     */
*/*                                                                  */
*/*   PURPOSE - HANDLE LOCATE RETURN CODES                           */
*/*                                                                  */
*/*   INPUT DATA - CATALOG PARAMETERS,HSKP CONTROLS, LOCATE          */
*/*                RETURN CODE -REG 15                               */
*/* EXIT -                                                           */
*/*   CONDITION - COMPLETE                                           */
*/*                                                                  */
*/*   OUTPUT DATA - UPDATED CATALOG PARAMETER LISTS                  */
*/*                 CREATED DD IF NECESSARY                          */
*/*                 ERROR REASON CODES:                              */
*/*                   01  DD ERROR:   DATA SET NOT FOUND (STEPCAT    */
*/*                             NOT CATALOGED IN MASTER CATALOG).    */
*/*                   02  STEP ERROR: VOLUME LIST GETMAIN FAILURE.   */
*/*                                                                  */
*/*   RETURN CODE - 0   SUCCESSFUL.                                  */
*/*                 4   DD RELATED ERROR                             */
*/*                 8   STEP RELATED ERROR                           */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0129
*             IF RTCDSAV=NEEDVL THEN/* VOL LIST TOO SMALL - RC=40    */
         C     RTCDSAV,@CF00087                                 03S0129
         BNE   @RF00129                                         03S0129
*               DO;                 /* HAVE 'GETSTORG' GET MORE      */
*                 IF HWNEWVL=ON THEN/* FREEMAIN AN OLD ONE IF ANY    */
         L     @10,@PC00001                                     03S0131
         L     @10,HWCNTRLP(,@10)                               03S0131
         TM    HWNEWVL(@10),B'00001000'                         03S0131
         BNO   @RF00131                                         03S0131
*                   DO;                                         03S0132
*                     FSBPOOL=SBPOOL;/* SUBPOOL OF GOTTEN VOLUME
*                                      LIST,                         */
         MVI   FSBPOOL,X'E6'                                    03S0133
*                     FLENTH=CTGWALV;/* AND LENGTH OF OLD VOLUME LIST*/
         L     @10,CTGWKA(,CTGPLPTR)                            03S0134
         LH    @06,CTGWALV(,@10)                                03S0134
         STCM  @06,7,FLENTH                                     03S0134
*                     REG0=SPLEN;   /* FOR FREEMAIN                  */
         L     REG0,SPLEN                                       03S0135
*                     REG1=CTGWAVL; /* ADDRESS OF VOLUME LIST        */
         L     REG1,CTGWAVL(,@10)                               03S0136
*                     GEN(FREEMAIN R,LV=(0),A=(1));             03S0137
         FREEMAIN R,LV=(0),A=(1)
*                   END;                                        03S0138
*                 CTGWALV=CTGFDBK;  /* NEW LENGTH TO 'GET'           */
*                                                               03S0139
@RF00131 L     @10,CTGWKA(,CTGPLPTR)                            03S0139
         LH    @06,CTGFDBK(,CTGPLPTR)                           03S0139
         N     @06,@CF01155                                     03S0139
         STH   @06,CTGWALV(,@10)                                03S0139
*                 /***************************************************/
*                 /*                                                 */
*                 /* ?GETSTORG (SBPOOL,CTGWALV,CTGWAVL) NOCLEAR;     */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0140
*                                                               03S0140
*                 /***************************************************/
*                 /*                                                 */
*                 /* DEFINITIONS OF GETMAIN PARMS                    */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0140
*                 DCL                                           03S0140
*                   GTSTR0 FIXED(31) REG(0),/* GTMN PARM REG         */
*                   GTSTR1 FIXED(31) REG(1),/* GTMN PARM REG         */
*                   GTSTR2 PTR(31) REG(2),/* GTMN PARM REG           */
*                   GTSTR15 FIXED(31) REG(15),/* GTMN RET COD        */
*                   GTSTRTCD FIXED(31);/* GETMAIN RTN CODE           */
*                 RFY                                           03S0141
*                  (GTSTR0,                                     03S0141
*                   GTSTR1,                                     03S0141
*                   GTSTR2) RSTD;   /* SAVE RGS                      */
*                 GTSTR0=CTGWALV;   /* SET AMOUNT                    */
         LR    GTSTR0,@06                                       03S0142
*                 GTSTR2=SBPOOL;    /* SET SUBPOOL                   */
         LA    GTSTR2,230                                       03S0143
*                 GENERATE CODE;                                03S0144
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*                 GTSTRTCD=GTSTR15; /* SAVE GETMAIN RET COD          */
         LR    GTSTRTCD,GTSTR15                                 03S0145
*                 CTGWAVL=GTSTR1;   /* ADDR OF GOTN STORG            */
         L     @10,CTGWKA(,CTGPLPTR)                            03S0146
         ST    GTSTR1,CTGWAVL(,@10)                             03S0146
*                 RFY                                           03S0147
*                  (GTSTR0,                                     03S0147
*                   GTSTR1,                                     03S0147
*                   GTSTR2) UNRSTD; /* RLSE                          */
*                 GTSTR15=GTSTRTCD; /* GTMN RETURN CODE              */
         LR    GTSTR15,GTSTRTCD                                 03S0148
*                                   /* RESTORE LIST PRINT STATUS     */
*                 IF RTCDREG=0 THEN /* NO 'GETMAIN' ERROR            */
         LTR   RTCDREG,RTCDREG                                  03S0149
         BNZ   @RF00149                                         03S0149
*                   HWNEWVL=ON;     /* NEW VOLUME LIST OBTAINED      */
         L     @10,@PC00001                                     03S0150
         L     @10,HWCNTRLP(,@10)                               03S0150
         OI    HWNEWVL(@10),B'00001000'                         03S0150
*                 ELSE              /* 'GETMAIN' ERROR               */
*                   DO;                                         03S0151
         B     @RC00149                                         03S0151
@RF00149 DS    0H                                               03S0152
*                     HWRTCD=STEPERR;/* RETURN CODE - 8              */
         L     @10,@PC00001+8                                   03S0152
         L     @10,HWRTNP(,@10)                                 03S0152
         MVC   HWRTCD(2,@10),@CH00055                           03S0152
*                     HWRSNCD=GETRSN02;/* REASON CODE - 2            */
         MVC   HWRSNCD(2,@10),@CH00068                          03S0153
*                   END;                                        03S0154
*               END;                /* GET LARGER VOLUME LIST        */
*             ELSE                                              03S0156
*               IF RTCDSAV=SCATNEED×/* STEP CAT NEEDED - RC=188      */
*                   RTCDSAV=CATNEED×/* CATALOG NEEDED - RC=36        */
*                   RTCDSAV=CVOLNEED THEN/* OS CVOL NEEDED - RC=68   */
         B     @RC00129                                         03S0156
@RF00129 C     RTCDSAV,@CF00093                                 03S0156
         BE    @RT00156                                         03S0156
         C     RTCDSAV,@CF00085                                 03S0156
         BE    @RT00156                                         03S0156
         C     RTCDSAV,@CF00091                                 03S0156
         BNE   @RF00156                                         03S0156
@RT00156 DS    0H                                               03S0157
*                 IF SIOTJSCT=ON THEN/* STEPCAT DD - IS NOT CATALOGED*/
         L     @10,@PC00001+12                                  03S0157
         L     @10,SIOTPTR(,@10)                                03S0157
         TM    SIOTJSCT(@10),B'00000001'                        03S0157
         BNO   @RF00157                                         03S0157
*                   DO;             /* IN MASTER (DATASET NOT FOUND) */
*                     HWRTCD=DDERR; /* RETURN CODE - 4               */
         L     @10,@PC00001+8                                   03S0159
         L     @10,HWRTNP(,@10)                                 03S0159
         MVC   HWRTCD(2,@10),@CH00070                           03S0159
*                     HWRSNCD=DSNOTFND;/* REASON CODE - 1            */
         MVC   HWRSNCD(2,@10),@CH00049                          03S0160
*                   END;                                        03S0161
*                 ELSE              /* STEPCAT IS CATALOGED          */
*                   DO;             /* ALLOCATE THE CATALOG          */
         B     @RC00157                                         03S0162
@RF00157 DS    0H                                               03S0163
*                     ACCNTRLS=0;   /* RESET ALLOCATE CTLG CNTRLS    */
         SLR   @10,@10                                          03S0163
         STH   @10,ACCNTRLS                                     03S0163
*                     IF HWDNCCDD=ON THEN/* TELL DYNALLOC TO         */
         L     @10,@PC00001                                     03S0164
         L     @10,HWCNTRLP(,@10)                               03S0164
         TM    HWDNCCDD(@10),B'00000100'                        03S0164
         BNO   @RF00164                                         03S0164
*                       ACNODD=ON;  /* SET CATALOG DATASET INDICATORS*/
         OI    ACNODD,B'10000000'                               03S0165
*                     IF HWUNLCCT=ON THEN/* UNALLOCATE CATALOGS IF   */
@RF00164 L     @10,@PC00001                                     03S0166
         L     @10,HWCNTRLP(,@10)                               03S0166
         TM    HWUNLCCT(@10),B'00001000'                        03S0166
         BNO   @RF00166                                         03S0166
*                       ACRECOVR=ON;/* DEVICE(S) ARE NEEDED          */
         OI    ACRECOVR,B'00100000'                             03S0167
*                     IF HWWAITOK=ON THEN/* WAIT FOR DEVICES         */
@RF00166 L     @10,@PC00001                                     03S0168
         L     @10,HWCNTRLP(,@10)                               03S0168
         TM    HWWAITOK(@10),B'00010000'                        03S0168
         BNO   @RF00168                                         03S0168
*                       ACDVWAIT=ON;                            03S0169
         OI    ACDVWAIT,B'01000000'                             03S0169
*                     IF HWWVOLS=ON THEN/* WAIT FOR VOLUMES          */
@RF00168 L     @10,@PC00001                                     03S0170
         L     @10,HWCNTRLP(,@10)                               03S0170
         TM    HWWVOLS(@10),B'00000010'                         03S0170
         BNO   @RF00170                                         03S0170
*                       ACVLWAIT=ON;                            03S0171
         OI    ACVLWAIT,B'00001000'                             03S0171
*                     IF HWOFFDEV=ON THEN/* CONSIDER OFF LINE DEVICES*/
@RF00170 L     @10,@PC00001                                     03S0172
         L     @10,HWCNTRLP(,@10)                               03S0172
         TM    HWOFFDEV(@10),B'10000000'                        03S0172
         BNO   @RF00172                                         03S0172
*                       ACOFLINE=ON;                            03S0173
         OI    ACOFLINE,B'00000100'                             03S0173
*                     IF HWDENQT=ON THEN/* DO NOT ENQUEUE ON THE TIOT*/
@RF00172 L     @10,@PC00001                                     03S0174
         L     @10,HWCNTRLP(,@10)                               03S0174
         TM    HWDENQT(@10),B'01000000'                         03S0174
         BNO   @RF00174                                         03S0174
*                       ACNOENQ=ON;                             03S0175
         OI    ACNOENQ,B'00000010'                              03S0175
*                     IF HWCAJSCB=ON THEN/* MAKE CURRENT JSCB ACTIVE
*                                      TO                            */
@RF00174 L     @10,@PC00001                                     03S0176
         L     @10,HWCNTRLP(,@10)                               03S0176
         TM    HWCAJSCB(@10),B'00100000'                        03S0176
         BNO   @RF00176                                         03S0176
*                       ACNUJSCB=ON;/* ALLOC CTGS TO THE INITIATOR   */
         OI    ACNUJSCB,B'00000001'                             03S0177
*                     IF HWMNTCAT=ON THEN/* CATALOG MOUNTING IS      */
@RF00176 L     @10,@PC00001                                     03S0178
         L     @10,HWCNTRLP(,@10)                               03S0178
         TM    HWMNTCAT(@10),B'00100000'                        03S0178
         BNO   @RF00178                                         03S0178
*                       ACOK2MNT=ON;/* AUTHORIZED BY CALLER          */
         OI    ACOK2MNT,B'10000000'                             03S0179
*                     ACCCPCCB=ON;  /* CREATE & CHAIN/MODIFY PCCB    */
@RF00178 OI    ACCCPCCB,B'00001000'                             03S0180
*                     IF HWLOCCAT=OFF×/* LOCATE CATALOG ONLY@YM03379 */
*                         ACNODD=ON×/* NO GENERATED DD       @YM03379*/
*                         RTCDSAV=CVOLNEED THEN/* CVOL NEEDED   03S0181
*                                                            @ZA02101*/
         L     @10,@PC00001                                     03S0181
         L     @10,HWCNTRLP(,@10)                               03S0181
         TM    HWLOCCAT(@10),B'00000010'                        03S0181
         BZ    @RT00181                                         03S0181
         TM    ACNODD,B'10000000'                               03S0181
         BO    @RT00181                                         03S0181
         C     RTCDSAV,@CF00091                                 03S0181
         BNE   @RF00181                                         03S0181
@RT00181 DS    0H                                               03S0182
*                       DO;         /* ALLOC, OPEN CATLG             */
*                         ACALCTLG=ON;/* ALLOCATE THE CATALOG        */
*                         ACOPNACB=ON;/* CREATE/OPEN AN ACB          */
         OI    ACALCTLG,B'00110000'                             03S0184
*                       END;                                    03S0185
*                     IF RTCDSAV=CVOLNEED THEN/* CATALOG NEEDED IS AN*/
@RF00181 C     RTCDSAV,@CF00091                                 03S0186
         BNE   @RF00186                                         03S0186
*                       ACOSCVOL=ON;/* OS TYPE CVOL                  */
         OI    ACOSCVOL,B'00010000'                             03S0187
*                     IF CTGCVCC(1:4)=0 THEN/* INIT CATLG CONNECTOR  */
@RF00186 SLR   @10,@10                                          03S0188
         L     @09,CTGCVOL(,CTGPLPTR)                           03S0188
         ICM   @06,15,CTGCVCC(@09)                              03S0188
         CLR   @10,@06                                          03S0188
         BNE   @RF00188                                         03S0188
*                       CATCONP=0;  /* POINTER TO ZERO OR TO THE     */
         ST    @10,CATCONP                                      03S0189
*                     ELSE          /* ADDRESS OF THE CONNECTOR,     */
*                       CATCONP=ADDR(CTGCVCC);/* IF ONE IS PRESENT   */
         B     @RC00188                                         03S0190
@RF00188 L     @10,CTGCVOL(,CTGPLPTR)                           03S0190
         LA    @10,CTGCVCC(,@10)                                03S0190
         ST    @10,CATCONP                                      03S0190
*                     CALL IEFAB4F5 /* CALL IEDAB4F5                 */
*                         (ACCNTRLS,HWRTNP,HWJSCBP,ADDR(CTGCVDSN),
*                         CATCONP,0);                           03S0191
@RC00188 LA    @10,ACCNTRLS                                     03S0191
         ST    @10,@AL00001                                     03S0191
         L     @10,@PC00001+8                                   03S0191
         ST    @10,@AL00001+4                                   03S0191
         L     @10,@PC00001+4                                   03S0191
         L     @10,HWDATAP(,@10)                                03S0191
         LA    @10,HWJSCBP(,@10)                                03S0191
         ST    @10,@AL00001+8                                   03S0191
         L     @10,CTGCVOL(,CTGPLPTR)                           03S0191
         LA    @10,CTGCVDSN(,@10)                               03S0191
         ST    @10,@TF00001                                     03S0191
         LA    @10,@TF00001                                     03S0191
         ST    @10,@AL00001+12                                  03S0191
         LA    @10,CATCONP                                      03S0191
         ST    @10,@AL00001+16                                  03S0191
         LA    @10,@CF00056                                     03S0191
         ST    @10,@AL00001+20                                  03S0191
         L     @15,@CV00125                                     03S0191
         LA    @01,@AL00001                                     03S0191
         BALR  @14,@15                                          03S0191
*                     IF CATCONP^=0 THEN/* INHIBIT RE-CALLING OF THE */
         L     @10,CATCONP                                      03S0192
         LTR   @10,@10                                          03S0192
         BZ    @RF00192                                         03S0192
*                       CTGCVCC=CTGCVCC&&CTGCVCC;/* PCCB ROUTINE.    */
         L     @10,CTGCVOL(,CTGPLPTR)                           03S0193
         XC    CTGCVCC(44,@10),CTGCVCC(@10)                     03S0193
*                     IF ACRECOVD=ON THEN/* CATALOGS UNALLOCATED.    */
@RF00192 TM    ACRECOVD,B'00000100'                             03S0194
         BNO   @RF00194                                         03S0194
*                       RESTPCCB=ON;/* REACTIVATE ALL PCCB(S)        */
         OI    RESTPCCB,B'10000000'                             03S0195
*                     IF HWRTCD=0&  /* IF NO ERRORS, THEN A DD IS    */
*                         HWDNCCDD=OFF&/* CREATED IF ALLOWED AND     */
*                         (RTCDSAV=CATNEED×/* PRIVATE CATALOG OR A   */
*                         RTCDSAV=CVOLNEED)&/* CVOL WAS NEEDED AND   */
*                         HWRSNCD=PCCBMADE THEN/* ONE WAS ALLOCATED  */
@RF00194 L     @10,@PC00001+8                                   03S0196
         L     @10,HWRTNP(,@10)                                 03S0196
         LH    @10,HWRTCD(,@10)                                 03S0196
         LTR   @10,@10                                          03S0196
         BNZ   @RF00196                                         03S0196
         L     @10,@PC00001                                     03S0196
         L     @10,HWCNTRLP(,@10)                               03S0196
         TM    HWDNCCDD(@10),B'00000100'                        03S0196
         BNZ   @RF00196                                         03S0196
         C     RTCDSAV,@CF00085                                 03S0196
         BE    @GL00014                                         03S0196
         C     RTCDSAV,@CF00091                                 03S0196
         BNE   @RF00196                                         03S0196
@GL00014 L     @10,@PC00001+8                                   03S0196
         L     @09,HWRTNP(,@10)                                 03S0196
         LH    @09,HWRSNCD(,@09)                                03S0196
         LTR   @09,@09                                          03S0196
         BNZ   @RF00196                                         03S0196
*                       DO;         /* WITH A NEW PCCB CREATED.      */
*                         HWTBLCTL=0;/* CALL TABLE CREATION FOR DD   */
         L     @09,@PC00001                                     03S0198
         L     @06,HWCNTRLP(,@09)                               03S0198
         MVI   HWTBLCTL(@06),X'00'                              03S0198
*                         TSIOTPTR=SIOTPTR;/* SIOT PTR. MAY BE  03S0199
*                                      ALTERED IF DD IS CONCATINATED */
         L     @06,@PC00001+12                                  03S0199
         L     @06,SIOTPTR(,@06)                                03S0199
         ST    @06,TSIOTPTR                                     03S0199
*                         CALL IEFAB466/* CALL IEFAB466              */
*                             (HWCNTRLP,HWDATAP,HWRTNP,HWSCTP,HWJSCBP,
*                             TSIOTPTR,HWCJFCBP,ONEPAIR);       03S0200
         ST    @09,@AL00001                                     03S0200
         L     @09,@PC00001+4                                   03S0200
         ST    @09,@AL00001+4                                   03S0200
         ST    @10,@AL00001+8                                   03S0200
         L     @10,HWDATAP(,@09)                                03S0200
         LA    @09,HWSCTP(,@10)                                 03S0200
         ST    @09,@AL00001+12                                  03S0200
         LA    @09,HWJSCBP(,@10)                                03S0200
         ST    @09,@AL00001+16                                  03S0200
         LA    @09,TSIOTPTR                                     03S0200
         ST    @09,@AL00001+20                                  03S0200
         LA    @10,HWCJFCBP(,@10)                               03S0200
         ST    @10,@AL00001+24                                  03S0200
         LA    @10,@CH00049                                     03S0200
         ST    @10,@AL00001+28                                  03S0200
         L     @15,@CV00129                                     03S0200
         LA    @01,@AL00001                                     03S0200
         BALR  @14,@15                                          03S0200
*                         IF HWRTCD=0 THEN/* TABLES CREATED OK       */
         L     @10,@PC00001+8                                   03S0201
         L     @10,HWRTNP(,@10)                                 03S0201
         LH    @10,HWRTCD(,@10)                                 03S0201
         LTR   @10,@10                                          03S0201
         BNZ   @RF00201                                         03S0201
*                           DO;     /* MOVE FIELDS TO NEW TABLES     */
*                             RFY                               03S0203
*                               INDMSIOT BASED(TSIOTPTR);       03S0203
*                             SIOTNPTR->SJFCBPTR->JFCBDSNM=CTGCVDSN;
         L     @10,TSIOTPTR                                     03S0204
         L     @10,SIOTNPTR(,@10)                               03S0204
         L     @09,SJFCBPTR(,@10)                               03S0204
         L     @06,CTGCVOL(,CTGPLPTR)                           03S0204
         MVC   JFCBDSNM(44,@09),CTGCVDSN(@06)                   03S0204
*                             SIOTNPTR->SIOTCATL=ON;/* CATALOG DD    */
         OI    SIOTCATL(@10),B'01000000'                        03S0205
*                             SIOTNPTR->SIOTKEEP=ON;/* DISP=SHR,KEEP */
         OI    SIOTKEEP(@10),B'00001000'                        03S0206
*                             SIOTNPTR->SJFCBPTR->JFCSHARE=ON;  03S0207
         OI    JFCSHARE(@09),B'00001000'                        03S0207
*                             IF RTCDSAV=CVOLNEED THEN/* MARK NEW    */
         C     RTCDSAV,@CF00091                                 03S0208
         BNE   @RF00208                                         03S0208
*                               SIOTNPTR->SIOTCVOL=ON;/* SIOT AS
*                                      'CVOL'                        */
         OI    SIOTCVOL(@10),B'00000100'                        03S0209
*                             RFY                               03S0210
*                               INDMSIOT BASED(SIOTPTR);        03S0210
@RF00208 DS    0H                                               03S0211
*                           END;    /* DD CREATED O K                */
*                       END;        /* NEED DD CREATED FOR CATALOG   */
*                     ELSE          /* ERRORS                        */
*                       IF HWRTCD=0 THEN/* RESET 'INFORMATION' REASON*/
         B     @RC00196                                         03S0213
@RF00196 SLR   @10,@10                                          03S0213
         L     @06,@PC00001+8                                   03S0213
         L     @06,HWRTNP(,@06)                                 03S0213
         CH    @10,HWRTCD(,@06)                                 03S0213
         BNE   @RF00213                                         03S0213
*                         HWRSNCD=0;/* CODE FROM THE PCCB ROUTINE    */
         STH   @10,HWRSNCD(,@06)                                03S0214
*                     IF CTGSRH=ON THEN/* CATALOG INFO REQUEST  03S0215
*                                      COMPLETE                      */
@RF00213 DS    0H                                               03S0215
@RC00196 TM    CTGSRH(CTGPLPTR),B'00000100'                     03S0215
         BNO   @RF00215                                         03S0215
*                       SV26DONE=ON;/* END 'LOCATE LOOP'             */
         OI    SV26DONE,B'10000000'                             03S0216
*                   END;                                        03S0217
*               ELSE                /* OTHER THAN NORMAL RETURN CODE */
*                 DO;                                           03S0218
         B     @RC00156                                         03S0218
@RF00156 DS    0H                                               03S0219
*                   HWRTCD=DDERR;   /* RETURN CODE - 4               */
         L     @10,@PC00001+8                                   03S0219
         L     @10,HWRTNP(,@10)                                 03S0219
         MVC   HWRTCD(2,@10),@CH00070                           03S0219
*                   HWRSNCD=BADRETCD;/* REASON CODE - 82             */
         MVC   HWRSNCD(2,@10),@CH00079                          03S0220
*                 END;                                          03S0221
*           END;                    /* END 'REISSUE LOCATE'          */
@RC00156 DS    0H                                               02S0222
@RC00129 DS    0H                                               02S0223
*       END;                        /* LOCATE LOOP                   */
@RC00110 DS    0H                                               02S0223
@DE00096 L     @10,@PC00001+8                                   02S0223
         L     @10,HWRTNP(,@10)                                 02S0223
         LH    @10,HWRTCD(,@10)                                 02S0223
         LTR   @10,@10                                          02S0223
         BNZ   @DC00096                                         02S0223
         TM    SV26DONE,B'10000000'                             02S0223
         BZ    @DL00096                                         02S0223
@DC00096 DS    0H                                               02S0224
*       IF HWRTCD=0 THEN            /* ROUTINE FINISHED OK           */
         L     @10,@PC00001+8                                   02S0224
         L     @10,HWRTNP(,@10)                                 02S0224
         LH    @10,HWRTCD(,@10)                                 02S0224
         LTR   @10,@10                                          02S0224
         BNZ   @RF00224                                         02S0224
*         DO;                                                   02S0225
*                                                               03S0226
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CLEANUP                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - LOCATE CLEANUP                                */
*/*                                                                  */
*/* FUNCTION - UPDATE SIOT, JFCB AND HSKP WORKAREA.                  */
*/*                                                                  */
*/*   OPERATION - DSORG, PARALLEL MOUNT AND DATA SET DISPOSITION     */
*/*            (FORCED KEEP), INFORMATION IS MAPPED INTO THE SIOT    */
*/*            AND THE JFCB AS REQUIRED.                             */
*/*            GDGALL INDICATOR IN HSKP WORK AREA IS SET ON OR OFF,  */
*/*            AND 'DATA SET IN CATALOG' IS TURNED ON. THE CATALOG   */
*/*            CONNECTOR (CATALOG INFO AREA OF CRI) IS MAPPED INTO   */
*/*            THE APPROPRIATE PCCB AND ALL PCCBS ARE MADE ACTIVE    */
*/*            IF THEY WERE MADE INACTIVE BY THE UNALLOCATE CATALOG  */
*/*            ROUTINE (IEFAB4F4) TO FREE RESOURCES TO ALLOW THE     */
*/*            ALLOCATION OF A NEEDED CATALOG (BY IEFAB4F5).         */
*/*                                                                  */
*/*            THE PCCB ROUTINE (IEFAB4EF) WILL BE CALLED TO CREATE/ */
*/*            MODIFY THE PRIVATE CATALOG CONTROL BLOCK FOR THE      */
*/*            SPECIFIED CATALOG IF CATALOG MANAGEMENT INDICATED THE */
*/*            DATASET SPECIFIED WAS CATALOGED ON AN ALIAS FOR A     */
*/*            (PREVIOUSLY ALLOCATED) CATALOG OR IF THE CATALOG IS   */
*/*            A CVOL THAT WILL BE NEEDED BY UNALLOCATION TO ALLOW   */
*/*            FOR THE UNCATALOGING OF THE DATA SET - DD WAS CREATED */
*/*            TO REPRESENT CVOL AS A RESULT OF A SPECIAL LOCATE     */
*/*            ISSUED ON BEHALF OF DISPOSITION PROCESSING (IEFAB459) */
*/*                                                                  */
*/*            ALIAS STEPCAT PROCESSING IS HANDLED BY IEFAB452.      */
*/*                                                                  */
*/* ENTRY - LOCATE(S) COMPLETE AND SUCCESSFUL                        */
*/*                                                                  */
*/*   PURPOSE - PREPARE FOR RETURN TO CALLER                         */
*/*                                                                  */
*/*   INPUT DATA - CRI,SIOT,JFCB,HSKP RETURN INFO                    */
*/*                                                                  */
*/* EXIT - TO JLOCATE FINAL PROCESSING                               */
*/*                                                                  */
*/*   CONDITION - LOCATE CONTROL COMPLETE                            */
*/*                                                                  */
*/*   OUTPUT DATA - SIOT,JFCB UPDATED                                */
*/*                 HSKP WORKAREA UPDATED                            */
*/*   RETURN CODE - AS PASSED                                        */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0226
*           IF HWVSAME=YES THEN     /* CHANGE DD AS PER IF CATALOG   */
         L     @10,@PC00001                                     03S0226
         L     @10,HWCNTRLP(,@10)                               03S0226
         TM    HWVSAME(@10),B'00000001'                         03S0226
         BNO   @RF00226                                         03S0226
*             DO;                   /* MGMNT, IF REQUESTED BY CALLER.*/
*               JFCDSORG=CTGDSORG;  /* DSORG BACK TO JFCB            */
         L     @10,@PC00001+16                                  03S0228
         L     @10,JFCBPTR(,@10)                                03S0228
         MVC   JFCDSORG(2,@10),CTGDSORG(CTGPLPTR)               03S0228
*               IF CTGPAR=ON THEN   /* PARALLEL MOUNT TO SIOT        */
         TM    CTGPAR(CTGPLPTR),B'10000000'                     03S0229
         BNO   @RF00229                                         03S0229
*                 SCTPARLM=ON;                                  03S0230
         L     @10,@PC00001+12                                  03S0230
         L     @10,SIOTPTR(,@10)                                03S0230
         OI    SCTPARLM(@10),B'00000100'                        03S0230
*               ELSE                /* NO PARALLEL MOUNT             */
*                 SCTPARLM=OFF;                                 03S0231
         B     @RC00229                                         03S0231
@RF00229 L     @10,@PC00001+12                                  03S0231
         L     @10,SIOTPTR(,@10)                                03S0231
         NI    SCTPARLM(@10),B'11111011'                        03S0231
*               IF CTGKEEP=ON THEN  /* FORCE KEEP DISPOSIOTION IN    */
@RC00229 TM    CTGKEEP(CTGPLPTR),B'01000000'                    03S0232
         BNO   @RF00232                                         03S0232
*                 DO;               /* REGULAR AND CONDITIONAL       */
*                   SCTSDISP=SCTSDISP&DSPRESET;/* DISPOSIOTION FIELDS
*                                      OF SIOT                       */
         L     @10,@PC00001+12                                  03S0234
         L     @10,SIOTPTR(,@10)                                03S0234
         NI    SCTSDISP(@10),X'E0'                              03S0234
*                   SIOTALTD=SIOTALTD&ALTRESET;                 03S0235
         NI    SIOTALTD(@10),X'F0'                              03S0235
*                   SIOTKEEP=ON;    /* RESET AND SET 'KEEP'          */
         OI    SIOTKEEP(@10),B'00001000'                        03S0236
*                   SIOTAKEP=ON;                                03S0237
         OI    SIOTAKEP(@10),B'00001000'                        03S0237
*                 END;                                          03S0238
*             END;                                              03S0239
@RF00232 DS    0H                                               03S0240
*           IF CTGGDGB=ON&          /* GDG ALL               @ZA01574*/
*               HWLOCCAT=OFF THEN   /* NOT LOCATE CATALOG ONLY  03S0240
*                                                            @ZA01574*/
@RF00226 TM    CTGGDGB(CTGPLPTR),B'00100000'                    03S0240
         BNO   @RF00240                                         03S0240
         L     @10,@PC00001                                     03S0240
         L     @10,HWCNTRLP(,@10)                               03S0240
         TM    HWLOCCAT(@10),B'00000010'                        03S0240
         BNZ   @RF00240                                         03S0240
*             HWGDGALL=ON;                                      03S0241
         OI    HWGDGALL(@10),B'00010000'                        03S0241
*           HWDSNCAT=ON;            /* DSN FOUND IN CATALOG          */
@RF00240 L     @10,@PC00001                                     03S0242
         L     @10,HWCNTRLP(,@10)                               03S0242
         OI    HWDSNCAT(@10),B'00000100'                        03S0242
*           IF JSCBACT->JSCBPCC^=0& /* MUST MAKE ALL PCCB(S) ACTIVE  */
*               RESTPCCB=ON THEN    /* IF CATALOGS WERE UNALLOCATED  */
         L     @10,@PC00001+4                                   03S0243
         L     @10,HWDATAP(,@10)                                03S0243
         L     @10,HWJSCBP(,@10)                                03S0243
         L     @10,JSCBACT(,@10)                                03S0243
         L     @10,JSCBPCC(,@10)                                03S0243
         LTR   @10,@10                                          03S0243
         BZ    @RF00243                                         03S0243
         TM    RESTPCCB,B'10000000'                             03S0243
         BNO   @RF00243                                         03S0243
*             DO;                   /* ENQUEUE ON PCCB CHAIN         */
*               GEN REFS(NQCORE);                               03S0245
      ENQ    MF=(E,NQCORE)
*               PCCBPTR=JSCBACT->JSCBPCC;/* MAP THE FIRST PCCB       */
         L     @10,@PC00001+4                                   03S0246
         L     @10,HWDATAP(,@10)                                03S0246
         L     @10,HWJSCBP(,@10)                                03S0246
         L     @10,JSCBACT(,@10)                                03S0246
         L     PCCBPTR,JSCBPCC(,@10)                            03S0246
*               DO WHILE(PCCBPTR^=0);/* INSURE ALL PCCBS ARE ACTIVE  */
         B     @DE00247                                         03S0247
@DL00247 DS    0H                                               03S0248
*                 PCCACTIV=ON;      /* SO CATALOG MANAGEMENT MAY     */
         OI    PCCACTIV(PCCBPTR),B'00100000'                    03S0248
*                 PCCBPTR=PCCNEXTP; /* USE FOR SUBSEQUENT LOCATES    */
         L     PCCBPTR,PCCNEXTP(,PCCBPTR)                       03S0249
*               END;                                            03S0250
@DE00247 LTR   PCCBPTR,PCCBPTR                                  03S0250
         BNZ   @DL00247                                         03S0250
*               GEN REFS(NQCORE);                               03S0251
      DEQ    MF=(E,NQCORE)
*             END;                  /* PCCB PROCESSING               */
*         END;                                                  02S0253
@RF00243 DS    0H                                               02S0254
*     END;                          /* SYSTEM LOCATE REQUEST DONE    */
@RF00224 DS    0H                                               01S0255
*   IF HWRTCD=0&HWGDGSLC=YES THEN   /* IF GDG SPEC. LOCATE WAS OK,   */
@RF00056 L     @10,@PC00001+8                                   01S0255
         L     @10,HWRTNP(,@10)                                 01S0255
         LH    @10,HWRTCD(,@10)                                 01S0255
         LTR   @10,@10                                          01S0255
         BNZ   @RF00255                                         01S0255
         L     @10,@PC00001                                     01S0255
         L     @10,HWCNTRLP(,@10)                               01S0255
         TM    HWGDGSLC(@10),B'00000100'                        01S0255
         BNO   @RF00255                                         01S0255
*     IF HWDOPDI=YES                /* AND THERE IS PDI              */
*         &JCTPDIP^=0 THEN          /* PROCESSING FOR THIS STEP      */
         TM    HWDOPDI(@10),B'10000000'                         01S0256
         BNO   @RF00256                                         01S0256
         L     @06,@PC00001+4                                   01S0256
         L     @06,HWDATAP(,@06)                                01S0256
         L     @06,HWJCTP(,@06)                                 01S0256
         ICM   @15,7,JCTPDIP(@06)                               01S0256
         BZ    @RF00256                                         01S0256
*       DO;                         /* SEE IF GDG IS IN THE PDI.     */
*         IF SCTSNEW=NO THEN        /* IF DATA SET IS NOT NEW        */
         L     @06,@PC00001+12                                  01S0258
         L     @06,SIOTPTR(,@06)                                01S0258
         TM    SCTSNEW(@06),B'00000100'                         01S0258
         BNZ   @RF00258                                         01S0258
*           HWPDIEDL=YES;           /* INDICATE DELETE PDI ENTRY.    */
         OI    HWPDIEDL(@10),B'01000000'                        01S0259
*         CALL IEFAB455             /* SCAN PDI FOR THIS OLD GDG.    */
*             (HWCNTRLP,HWDATAP,HWRTNP,SIOTPTR,DSNPTR,HWJCTP);  01S0260
@RF00258 L     @10,@PC00001                                     01S0260
         ST    @10,@AL00001                                     01S0260
         L     @10,@PC00001+4                                   01S0260
         ST    @10,@AL00001+4                                   01S0260
         L     @06,@PC00001+8                                   01S0260
         ST    @06,@AL00001+8                                   01S0260
         L     @06,@PC00001+12                                  01S0260
         ST    @06,@AL00001+12                                  01S0260
         L     @06,@PC00001+20                                  01S0260
         ST    @06,@AL00001+16                                  01S0260
         L     @10,HWDATAP(,@10)                                01S0260
         ST    @10,@AL00001+20                                  01S0260
         L     @15,@CV00127                                     01S0260
         LA    @01,@AL00001                                     01S0260
         BALR  @14,@15                                          01S0260
*         IF HWRESIOT=YES THEN      /* IF DATA SET WAS IN PDI,       */
         L     @10,@PC00001                                     01S0261
         L     @10,HWCNTRLP(,@10)                               01S0261
         TM    HWRESIOT(@10),B'00001000'                        01S0261
         BNO   @RF00261                                         01S0261
*           HWDSNCAT=OFF;           /* USE PDI INSTEAD OF CATALOG    */
         NI    HWDSNCAT(@10),B'11111011'                        01S0262
*       END;                        /* FOR VOLUME/UNIT INFORMATION   */
@RF00261 DS    0H                                               01S0264
*   IF HWNOVOLU=OFF THEN            /* CALL WAS FOR VOL/UNIT @YM06106*/
@RF00256 DS    0H                                               01S0264
@RF00255 L     @10,@PC00001                                     01S0264
         L     @10,HWCNTRLP(,@10)                               01S0264
         TM    HWNOVOLU(@10),B'01000000'                        01S0264
         BNZ   @RF00264                                         01S0264
*     DO;                           /* POSSIBILITY OF DISP CHANGE OR
*                                      DATA SET NOT FOUND    @YM06106*/
*       IF SCTSMOD=ON&              /* MOD SPECIFIED AND DISPOSITION */
*           HWDOMOD=ON THEN         /* IS FOR THE DATASET LOCATED -
*                                      NOT VOL=REF FOR EXAMPLE       */
         L     @06,@PC00001+12                                  01S0266
         L     @06,SIOTPTR(,@06)                                01S0266
         TM    SCTSMOD(@06),B'00000010'                         01S0266
         BNO   @RF00266                                         01S0266
         TM    HWDOMOD(@10),B'10000000'                         01S0266
         BNO   @RF00266                                         01S0266
*         IF HWRESIOT=OFF&          /* NOT IN PDI AND        @YM06106*/
*             (HWSYSLOC=OFF×        /* LOCATE WAS NOT REQUESTED OR   */
*             HWRSNCD=DSNOTFND×     /* THE DS-NAME WAS NOT FOUND, OR */
*             CTGNGDSN=ON) THEN     /* A NEW-NAME GDG SINGLE REQUEST */
         TM    HWRESIOT(@10),B'00001000'                        01S0267
         BNZ   @RF00267                                         01S0267
         TM    HWSYSLOC(@10),B'00100000'                        01S0267
         BZ    @RT00267                                         01S0267
         L     @10,@PC00001+8                                   01S0267
         L     @10,HWRTNP(,@10)                                 01S0267
         CLC   HWRSNCD(2,@10),@CH00049                          01S0267
         BE    @RT00267                                         01S0267
         TM    CTGNGDSN(CTGPLPTR),B'00010000'                   01S0267
         BNO   @RF00267                                         01S0267
@RT00267 DS    0H                                               01S0268
*           DO;                     /* THE DATA SET IS NEW, AND IS   */
*             HWRETURN=0;           /* THEREFORE, NOT A REAL ERROR.  */
         L     @10,@PC00001+8                                   01S0269
         L     @10,HWRTNP(,@10)                                 01S0269
         SLR   @15,@15                                          01S0269
         STCM  @15,15,HWRETURN(@10)                             01S0269
*             SCTSMOD=OFF;          /* CHANGE DATA SETS DISP IN      */
*             SCTSNEW=ON;           /* THE SIOT AND THE JFCB FROM    */
         L     @10,@PC00001+12                                  01S0271
         L     @10,SIOTPTR(,@10)                                01S0271
         OI    SCTSNEW(@10),B'00000100'                         01S0271
         NI    SCTSMOD(@10),B'11111101'                         01S0271
*             JFCMODNW=ON;          /* MOD TO NEW AND INDICATE       */
         L     @10,@PC00001+16                                  01S0272
         L     @10,JFCBPTR(,@10)                                01S0272
         OI    JFCMODNW(@10),B'00010000'                        01S0272
*             JFCDISP='11'B;        /* THE CHANGE IN THE JFCB        */
         OI    JFCDISP(@10),B'11000000'                         01S0273
*           END;                                                01S0274
*         ELSE                                                  01S0275
*           ;                       /* NULL                          */
@RF00267 DS    0H                                               01S0276
*       ELSE                        /* NOT A 'MOD' DATA SET          */
*         IF HWRESIOT=OFF&          /* NOT IN THE PDI OR     @YM06106*/
*             HWDSNCAT=OFF&         /* THE CATALOG (IF REQUESTED)    */
*             HWRTCD=0 THEN         /* AND NO OTHER ERROR FOUND      */
         B     @RC00266                                         01S0276
@RF00266 L     @10,@PC00001                                     01S0276
         L     @10,HWCNTRLP(,@10)                               01S0276
         TM    HWRESIOT(@10),B'00001100'                        01S0276
         BNZ   @RF00276                                         01S0276
         L     @10,@PC00001+8                                   01S0276
         L     @10,HWRTNP(,@10)                                 01S0276
         LH    @15,HWRTCD(,@10)                                 01S0276
         LTR   @15,@15                                          01S0276
         BNZ   @RF00276                                         01S0276
*           DO;                     /* INDICATE 'LOCATE' ERROR       */
*             HWRTCD=DDERR;         /* RETURN CODE - 4               */
         MVC   HWRTCD(2,@10),@CH00070                           01S0278
*             HWRSNCD=DSNOTFND;     /* REASON CODE - 1               */
         MVC   HWRSNCD(2,@10),@CH00049                          01S0279
*           END;                                                01S0280
*     END;                          /* CALLED FOR VOL/UNIT INFO 01S0281
*                                                            @YM06106*/
*   ELSE                            /* CALLED FOR PDI        @YM06106*/
*     DO;                           /* UPDATE OR CATLG       @YM06106*/
         B     @RC00264                                         01S0282
@RF00264 DS    0H                                               01S0283
*       HWDSNCAT=OFF;               /* CONTROL BLOCKS ONLY, SO  01S0283
*                                                            @YM06106*/
*       HWRESIOT=OFF;               /* TURN OFF SOURCE       @YM06106*/
         L     @10,@PC00001                                     01S0284
         L     @10,HWCNTRLP(,@10)                               01S0284
         NI    HWDSNCAT(@10),B'11110011'                        01S0284
*       IF HWRSNCD=DSNOTFND THEN    /* INDICATORS AND NOT    @YM06106*/
         L     @10,@PC00001+8                                   01S0285
         L     @10,HWRTNP(,@10)                                 01S0285
         CLC   HWRSNCD(2,@10),@CH00049                          01S0285
         BNE   @RF00285                                         01S0285
*         HWRETURN=0;               /* FOUND RETURN CODE.    @YM06106*/
         SLR   @15,@15                                          01S0286
         STCM  @15,15,HWRETURN(@10)                             01S0286
*     END;                          /* END NOVOLU.           @YM06106*/
*   END IEFAB469                                                01S0288
*                                                               01S0288
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (PRLG469 )                                       */
*/*%INCLUDE SYSUT5  (DCLS469 )                                       */
*/*%INCLUDE SYSLIB  (IEFZB437)                                       */
*/*%INCLUDE SYSLIB  (IEFZB442)                                       */
*/*%INCLUDE SYSLIB  (IEFZB436)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGWA)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGVL)                                       */
*/*%INCLUDE SYSLIB  (IEZCTGCV)                                       */
*/*%INCLUDE SYSLIB  (IEFASIOT)                                       */
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */
*/*%INCLUDE SYSLIB  (IEFPCCB )                                       */
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                       */
*/*%INCLUDE SYSUT5  (LCCNTSPC)                                       */
*/*%INCLUDE SYSUT5  (LOCATECT)                                       */
*/*%INCLUDE SYSUT5  (PINITSPC)                                       */
*/*%INCLUDE SYSUT5  (PARMINIT)                                       */
*/*%INCLUDE SYSUT5  (REDOSPEC)                                       */
*/*%INCLUDE SYSUT5  (REDOPREP)                                       */
*/*%INCLUDE SYSUT5  (CLNUPSPC)                                       */
*/*%INCLUDE SYSUT5  (CLEANUP )                                       */
*                                                               01S0288
*       ;                                                       01S0288
@EL00001 L     @13,4(,@13)                                      01S0288
@EF00001 L     @00,@SIZDATD                                     01S0288
         LR    @01,@11                                          01S0288
         FSPACE   R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  01S0288
         BR    @14                                              01S0288
@DATA    DS    0H
@CH00049 DC    H'1'
@CH00068 DC    H'2'
@CH00073 DC    H'12'
@CH00075 DC    H'13'
@CH00077 DC    H'57'
@CH00079 DC    H'82'
@CH01130 DC    H'600'
@SM01147 MVC   NQCORE(0),PCNQLIST
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    6F
@AL00001 DS    8A
@TF00001 DS    F
IEFAB469 CSECT
         DS    0F
@CF00056 DC    F'0'
@CH00056 EQU   @CF00056+2
@CF00070 DC    F'4'
@CH00070 EQU   @CF00070+2
@CF00055 DC    F'8'
@CH00055 EQU   @CF00055+2
@CF00083 DC    F'24'
@CF00085 DC    F'36'
@CF00087 DC    F'40'
@CF00089 DC    F'44'
@CF00091 DC    F'68'
@CF01140 DC    F'94'
@CF00093 DC    F'188'
@CF01155 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
CATCONP  DS    A
TSIOTPTR DS    A
CATNAMEP DS    A
VSERPTR  DS    A
ACCNTRLS DS    FL2
         ORG   ACCNTRLS
ACNODD   DS    BL1
ACDVWAIT EQU   ACCNTRLS+0
ACRECOVR EQU   ACCNTRLS+0
ACOSCVOL EQU   ACCNTRLS+0
ACVLWAIT EQU   ACCNTRLS+0
ACOFLINE EQU   ACCNTRLS+0
ACNOENQ  EQU   ACCNTRLS+0
ACNUJSCB EQU   ACCNTRLS+0
ACOK2MNT DS    BL1
ACSTPCAT EQU   ACCNTRLS+1
ACALCTLG EQU   ACCNTRLS+1
ACOPNACB EQU   ACCNTRLS+1
ACCCPCCB EQU   ACCNTRLS+1
ACRECOVD EQU   ACCNTRLS+1
@NM00012 EQU   ACCNTRLS+1
         ORG   ACCNTRLS+2
SWACTLS  DS    FL2
         ORG   SWACTLS
SWASN    DS    BL1
SWDEL    EQU   SWACTLS+0
SWREAD   EQU   SWACTLS+0
SWWRT    EQU   SWACTLS+0
SWNEW    EQU   SWACTLS+0
SWFREE   EQU   SWACTLS+0
SWMOD    EQU   SWACTLS+0
SWOLD    EQU   SWACTLS+0
SWCHN    DS    BL1
@NM00013 EQU   SWACTLS+1
         ORG   SWACTLS+2
SPLEN    DS    CL4
         ORG   SPLEN
FSBPOOL  DS    FL1
FLENTH   DS    FL3
         ORG   SPLEN+4
SV26DONE DS    BL1
RESTPCCB DS    BL1
IEFAB469 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00125 DC    V(IEFAB4F5)
@CV00127 DC    V(IEFAB455)
@CV00129 DC    V(IEFAB466)
         DS    0D
QNAME    DC    CL8'SYSZPCCB'
RNAME    DC    CL4'PCCB'
IEFAB469 CSECT
PCNQLIST ENQ (QNAME,RNAME,S,,SYSTEM),MF=L
NQLENGTH DC A(*-PCNQLIST)
@DATD    DSECT
NQCORE   ENQ (QNAME,RNAME,S,,SYSTEM),MF=L
IEFAB469 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB469 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GTSTRTCD EQU   @05
CTGPLPTR EQU   @07
PCCBPTR  EQU   @02
RTCDSAV  EQU   @08
REG0     EQU   @00
REG1     EQU   @01
PARMPTR  EQU   @01
VOLSPTR  EQU   @02
VOLLNTH  EQU   @03
BYTEPTR  EQU   @04
BYTLNTH  EQU   @05
RTCDREG  EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
DSN      EQU   0
HWRETURN EQU   0
HWRTCD   EQU   HWRETURN
HWRSNCD  EQU   HWRETURN+2
HWCNTRL  EQU   0
HWDOPDI  EQU   HWCNTRL
HWMNTCAT EQU   HWCNTRL
HWWAITOK EQU   HWCNTRL
HWUNLCCT EQU   HWCNTRL
HWDNCCDD EQU   HWCNTRL
HWWVOLS  EQU   HWCNTRL
HWOFFDEV EQU   HWCNTRL+1
HWDENQT  EQU   HWCNTRL+1
HWCAJSCB EQU   HWCNTRL+1
HWGDGALL EQU   HWCNTRL+2
HWRESIOT EQU   HWCNTRL+2
HWDSNCAT EQU   HWCNTRL+2
HWNEWVL  EQU   HWCNTRL+3
HWCATINT EQU   HWCNTRL+3
HWTBLCTL EQU   HWCNTRL+6
HWJLCTLS EQU   HWCNTRL+7
HWPDISCN EQU   HWJLCTLS
HWPDIEDL EQU   HWJLCTLS
HWSYSLOC EQU   HWJLCTLS
HWLBASEL EQU   HWJLCTLS
HWGDGSLC EQU   HWJLCTLS
HWLOCCAT EQU   HWJLCTLS
HWVSAME  EQU   HWJLCTLS
HWDOMOD  EQU   HWJLCTLS+1
HWNOVOLU EQU   HWJLCTLS+1
HWDATA   EQU   0
HWJCTP   EQU   HWDATA
HWSCTP   EQU   HWDATA+4
HWJSCBP  EQU   HWDATA+20
HWCRIP   EQU   HWDATA+36
HWCJFCBP EQU   HWDATA+48
HWUCLPTR EQU   HWDATA+56
HWGDGBSP EQU   HWDATA+64
HWSTPNBR EQU   HWDATA+172
HWUCLST  EQU   0
HWDEV    EQU   0
HWOBYTE  EQU   HWDEV+1
HWCTBYT  EQU   HWDEV+2
CTGPL    EQU   0
CTGOPTN1 EQU   CTGPL
CTGOPTN2 EQU   CTGPL+1
CTGEXT   EQU   CTGOPTN2
CTGERASE EQU   CTGOPTN2
CTGSMF   EQU   CTGERASE
CTGREL   EQU   CTGSMF
CTGPURG  EQU   CTGOPTN2
CTGVMNT  EQU   CTGPURG
CTGOPTN3 EQU   CTGPL+2
CTGSUPLT EQU   CTGOPTN3
CTGGDGL  EQU   CTGOPTN3
CTGSRH   EQU   CTGOPTN3
CTGAM0   EQU   CTGOPTN3
CTGOPTN4 EQU   CTGPL+3
CTGLBASE EQU   CTGOPTN4
CTGDOCAT EQU   CTGOPTN4
CTGCOIN  EQU   CTGOPTN4
CTGENT   EQU   CTGPL+4
CTGCAT   EQU   CTGPL+8
CTGCVOL  EQU   CTGCAT
CTGWKA   EQU   CTGPL+12
CTGDSORG EQU   CTGPL+16
CTGDDNM  EQU   CTGPL+20
CTGNEWNM EQU   CTGDDNM
CTGFDBK  EQU   CTGNEWNM
CTGFBFLG EQU   CTGNEWNM+2
CTGPAR   EQU   CTGFBFLG
CTGKEEP  EQU   CTGFBFLG
CTGGDGB  EQU   CTGFBFLG
CTGNGDSN EQU   CTGFBFLG
CTGJSCB  EQU   CTGPL+24
CTGWA    EQU   0
CTGWAVL  EQU   CTGWA
CTGWALV  EQU   CTGWA+4
CTGWAVCT EQU   CTGWA+6
CTGWAUCT EQU   CTGWA+8
CTGWAGCT EQU   CTGWA+10
CTGWAGB  EQU   CTGWA+12
CTGVL    EQU   0
CTGVLX   EQU   0
CTGCV    EQU   0
CTGCVDSN EQU   CTGCV+6
CTGCVCC  EQU   CTGCV+50
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SIOTBYT1 EQU   INDMSIOT+43
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTNMBUT EQU   INDMSIOT+53
SCTSDISP EQU   INDMSIOT+55
SIOTKEEP EQU   SCTSDISP
SCTSBYT1 EQU   INDMSIOT+56
SCTPARLM EQU   SCTSBYT1
SIOTJSCT EQU   SCTSBYT1
SCTSBYT2 EQU   INDMSIOT+57
SIOTCATL EQU   SCTSBYT2
SCTSBYT3 EQU   INDMSIOT+58
SCTSNEW  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTAKEP EQU   SIOTALTD
SIOTBYT2 EQU   INDMSIOT+103
SIOTCVOL EQU   SIOTBYT2
SIOTNPTR EQU   INDMSIOT+152
SJFCBPTR EQU   INDMSIOT+156
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCDISP  EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
IEFPCCB  EQU   0
PCCNEXTP EQU   IEFPCCB+4
PCCSTATS EQU   IEFPCCB+12
PCCSTAT1 EQU   PCCSTATS
PCCACTIV EQU   PCCSTAT1
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBPCC  EQU   JSCBSEC1+16
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
INJMJCT  EQU   0
JCTJSTAT EQU   INJMJCT+5
INDMCTLG EQU   JCTJSTAT
JCTJBYTE EQU   INJMJCT+7
JCTJMGLV EQU   JCTJBYTE
JCTPDIP  EQU   INJMJCT+24
JCTCCODE EQU   INJMJCT+54
JCTRSW1  EQU   INJMJCT+86
JCTRSW2  EQU   INJMJCT+87
JCTJSB   EQU   INJMJCT+111
JCTSTAT2 EQU   INJMJCT+116
IEFAACTB EQU   0
HWCNTRLP EQU   0
HWDATAP  EQU   0
HWRTNP   EQU   0
SIOTPTR  EQU   0
JFCBPTR  EQU   0
DSNPTR   EQU   0
@NM00019 EQU   CTGDDNM
CTGPROB  EQU   @NM00019
CTGREASN EQU   CTGPROB+2
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCSCT   EQU   JSCBSEC3+68
JSCBACT  EQU   JSCBSEC3+88
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00045 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00044 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBRV01 EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00040 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00039 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00038 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
CTGREAS2 EQU   CTGREASN+1
CTGREAS1 EQU   CTGREASN
CTGMODID EQU   CTGPROB
ACTACCNT EQU   IEFAACTB+32
ACTJNFLD EQU   IEFAACTB+31
ACTJTIME EQU   IEFAACTB+28
ACTPRGNM EQU   IEFAACTB+8
@NM00063 EQU   IEFAACTB+7
ACTNEXT  EQU   IEFAACTB+4
ACTIDENT EQU   IEFAACTB+3
ACTDSKAD EQU   IEFAACTB
@NM00062 EQU   INJMJCT+175
JCTVULDP EQU   INJMJCT+172
JCTACODE EQU   INJMJCT+168
JCTPRFMF EQU   INJMJCT+167
JCTUSER  EQU   INJMJCT+160
JCTSSD   EQU   INJMJCT+157
@NM00061 EQU   INJMJCT+156
JCTSRBT  EQU   INJMJCT+152
JCTJMRJD EQU   INJMJCT+149
JCTJMRJT EQU   INJMJCT+146
JCTJMRSS EQU   INJMJCT+143
JCTJMRTL EQU   INJMJCT+140
JCTJMRCL EQU   INJMJCT+139
JCTJMROP EQU   INJMJCT+138
JCTJMRD  EQU   INJMJCT+137
JCTJMR   EQU   INJMJCT+134
JCTCKIDT EQU   INJMJCT+118
JCTCKIDL EQU   INJMJCT+117
@NM00060 EQU   JCTSTAT2
JCTBLP   EQU   JCTSTAT2
JCTPERFM EQU   JCTSTAT2
JCTSWSM  EQU   JCTSTAT2
JCTENDIT EQU   JCTSTAT2
JCTADSPC EQU   JCTSTAT2
JCTSPSYS EQU   JCTSTAT2
@NM00059 EQU   INJMJCT+115
JCTSSTR  EQU   INJMJCT+112
JCTJSBTM EQU   JCTJSB
JCTJSBEX EQU   JCTJSB
JCTJSBAL EQU   JCTJSB
JCTJSBIN EQU   JCTJSB
@NM00058 EQU   JCTJSB
JCTVOLSQ EQU   INJMJCT+110
JCTNRCKP EQU   INJMJCT+108
JCTNTRK  EQU   INJMJCT+107
JCTCKTTR EQU   INJMJCT+104
JCTDEVT  EQU   INJMJCT+100
@NM00057 EQU   INJMJCT+99
JCTSTIOT EQU   INJMJCT+96
JCTSNUMB EQU   INJMJCT+95
JCTQIDNT EQU   INJMJCT+94
JCTEQREG EQU   INJMJCT+92
@NM00056 EQU   INJMJCT+91
JCTDETDA EQU   INJMJCT+88
JCTDSDRA EQU   JCTRSW2
JCTDSOJB EQU   JCTRSW2
JCTDSOCR EQU   JCTRSW2
JCTRESTT EQU   JCTRSW2
JCTNOCKP EQU   JCTRSW2
JCTNORST EQU   JCTRSW2
JCTNARST EQU   JCTRSW2
JCTSYSCK EQU   JCTRSW2
@NM00055 EQU   JCTRSW1
JCTSTEPR EQU   JCTRSW1
JCTCKPTR EQU   JCTRSW1
JCTCKFT  EQU   JCTRSW1
JCTCONTR EQU   JCTRSW1
JCTSTERM EQU   JCTRSW1
JCTWARMS EQU   JCTRSW1
@NM00054 EQU   JCTCCODE+3
JCTJDPOP EQU   JCTCCODE+2
JCTJDPCD EQU   JCTCCODE
@NM00053 EQU   INJMJCT+53
JCTSCT   EQU   INJMJCT+52
JCTSMRBA EQU   INJMJCT+44
@NM00052 EQU   INJMJCT+43
JCTACTAD EQU   INJMJCT+40
@NM00051 EQU   INJMJCT+39
JCTJCTX  EQU   INJMJCT+36
@NM00050 EQU   INJMJCT+35
JCTSDKAD EQU   INJMJCT+32
JCTJCSMF EQU   INJMJCT+31
JCTGDGNT EQU   INJMJCT+28
@NM00049 EQU   INJMJCT+27
JCTJTPTN EQU   INJMJCT+16
JCTJNAME EQU   INJMJCT+8
JCTJPRTY EQU   JCTJBYTE
INCMMGL1 EQU   JCTJMGLV
INCMMGL2 EQU   JCTJMGLV
@NM00048 EQU   JCTJMGLV
INCMALL  EQU   JCTJMGLV
JCTJMGPO EQU   INJMJCT+6
INCMNSET EQU   JCTJSTAT
INCMCAT  EQU   INDMCTLG
INCMSTS  EQU   JCTJSTAT
JCTABEND EQU   JCTJSTAT
@NM00047 EQU   JCTJSTAT
JCTJSTPC EQU   JCTJSTAT
@NM00046 EQU   JCTJSTAT
JCTJBLBS EQU   JCTJSTAT
JCTJSRNO EQU   INJMJCT+4
JCTIDENT EQU   INJMJCT+3
JCTDSKAD EQU   INJMJCT
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00043 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00042 EQU   IEZJSCB
PCCRSVD2 EQU   IEFPCCB+128
PCCLACBP EQU   IEFPCCB+124
PCCRSVD1 EQU   IEFPCCB+122
PCVOLSER EQU   IEFPCCB+116
PCCTGCON EQU   IEFPCCB+72
PCCDSNAM EQU   IEFPCCB+28
PCCDDNAM EQU   IEFPCCB+20
PCCACBP  EQU   IEFPCCB+16
PCCSTAT4 EQU   PCCSTATS+3
PCCSTAT3 EQU   PCCSTATS+2
PCCSTAT2 EQU   PCCSTATS+1
@NM00041 EQU   PCCSTAT1
PCCTCL   EQU   PCCSTAT1
PCOSCVOL EQU   PCCSTAT1
PCCALIAS EQU   PCCSTAT1
PCCSTEPC EQU   PCCSTAT1
PCCPREVP EQU   IEFPCCB+8
PCCACRO  EQU   IEFPCCB
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00037 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SCTANAME EQU   INDMSIOT+122
@NM00036 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
@NM00035 EQU   SIOTBYT2
@NM00034 EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00033 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00032 EQU   SIOTALTD
@NM00031 EQU   SIOTALTD
@NM00030 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00029 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00028 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00027 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
SIOTAFF  EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
SCTALCHK EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SCTUNAFF EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
@NM00026 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00025 EQU   SIOTTSTC
@NM00024 EQU   SIOTBYT3
SIOTDSID EQU   SIOTBYT3
S3400OFF EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00023 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00022 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00021 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
CTGCVDEV EQU   CTGCVDSN
CTGCVVOL EQU   CTGCV
CTGVLTTR EQU   CTGVLX+12
@NM00020 EQU   CTGVLX
CTGVLSEQ EQU   CTGVL+10
CTGVLDEV EQU   CTGVL+6
CTGVLVOL EQU   CTGVL
CTGFIELD EQU   CTGPL+28
CTGPSWD  EQU   CTGJSCB
@NM00018 EQU   CTGFBFLG
CTGNOFLD EQU   CTGPL+19
CTGTYPE  EQU   CTGPL+18
@NM00017 EQU   CTGDSORG
CTGOPTNS EQU   CTGDSORG
CTGFVT   EQU   CTGENT
@NM00016 EQU   CTGOPTN4
CTGTIOT  EQU   CTGOPTN4
CTGBYPMT EQU   CTGOPTN4
@NM00015 EQU   CTGOPTN4
CTGNUM   EQU   CTGOPTN3
CTGFUNC  EQU   CTGOPTN3
@NM00014 EQU   CTGOPTN2
CTGSCR   EQU   CTGOPTN2
CTGOVRID EQU   CTGOPTN2
CTGDISC  EQU   CTGOPTN2
CTGGTNXT EQU   CTGOPTN2
CTGRCATN EQU   CTGVMNT
CTGGTALL EQU   CTGREL
CTGNSVS  EQU   CTGEXT
CTGGENLD EQU   CTGOPTN1
CTGCNAME EQU   CTGOPTN1
CTGNAME  EQU   CTGOPTN1
CTGREAD  EQU   CTGOPTN1
CTGUPD   EQU   CTGOPTN1
CTGCI    EQU   CTGOPTN1
CTGMAST  EQU   CTGOPTN1
CTGBYPSS EQU   CTGOPTN1
HWTYPE   EQU   HWCTBYT+1
@NM00011 EQU   HWCTBYT
HWDA     EQU   HWCTBYT
@NM00010 EQU   HWCTBYT
HWTAPE   EQU   HWCTBYT
HW7TRK   EQU   HWOBYTE
HWMBYTE  EQU   HWDEV
HWUCBP   EQU   HWUCLST+8
HWDEVTYP EQU   HWUCLST+4
HWEDTLUV EQU   HWUCLST
HWRSVCHR EQU   HWDATA+984
HWCATSER EQU   HWDATA+978
@NM00009 EQU   HWDATA+958
HWCRI    EQU   HWDATA+220
HWDSNAME EQU   HWDATA+176
HWDSNLN  EQU   HWDATA+174
HWSTEPNO EQU   HWSTPNBR+1
@NM00008 EQU   HWSTPNBR
HWGETLN  EQU   HWDATA+168
HWGETSPN EQU   HWDATA+164
HWRSVPTR EQU   HWDATA+80
HWDSENQP EQU   HWDATA+76
HWRPDIEP EQU   HWDATA+72
HWLPDIBP EQU   HWDATA+68
HWLEPARP EQU   HWDATA+60
HWGETADD EQU   HWDATA+52
HWCSIOTP EQU   HWDATA+44
HWRSIOTP EQU   HWDATA+40
HWIOSLTP EQU   HWDATA+32
HWGDGNTP EQU   HWDATA+28
HWPDIP   EQU   HWDATA+24
HWGEPACP EQU   HWDATA+16
HWLEPAP  EQU   HWDATA+12
HWFSIOTP EQU   HWDATA+8
@NM00007 EQU   HWCNTRL+14
HWDDCTR  EQU   HWCNTRL+12
HWDDSTEP EQU   HWCNTRL+10
@NM00006 EQU   HWCNTRL+9
@NM00005 EQU   HWJLCTLS+1
@NM00004 EQU   HWJLCTLS
@NM00003 EQU   HWTBLCTL
HWCOPYAF EQU   HWTBLCTL
HWTBCOPY EQU   HWTBLCTL
@NM00002 EQU   HWCNTRL+3
HWDDDONE EQU   HWCNTRL+3
HWOVRDN  EQU   HWCNTRL+3
HWVAME   EQU   HWCNTRL+3
HWEDT    EQU   HWCNTRL+3
HWUCB    EQU   HWCNTRL+2
HWOVCAND EQU   HWCNTRL+2
HWDSNRQD EQU   HWCNTRL+2
HWVUREC  EQU   HWCNTRL+2
HWDSNREC EQU   HWCNTRL+2
@NM00001 EQU   HWCNTRL+1
HWNOVRID EQU   HWCNTRL+1
HWDSAUTH EQU   HWCNTRL+1
HWNODSI  EQU   HWCNTRL+1
HWEPAJCT EQU   HWCNTRL+1
HWNOSCAT EQU   HWCNTRL
HWNOULSP EQU   HWCNTRL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00120 EQU   @RC00110
@RC00113 EQU   @RC00110
@RC00123 EQU   @RC00110
@RC00149 EQU   @RC00129
@RF00201 EQU   @RC00196
@RC00157 EQU   @RC00156
@RF00215 EQU   @RC00156
@RC00264 EQU   @EL00001
@RF00285 EQU   @EL00001
@RC00116 EQU   @RC00113
@RF00276 EQU   @RC00264
@RC00266 EQU   @RC00264
@ENDDATA EQU   *
         END   IEFAB469,(C'PLS1647',0701,77208)

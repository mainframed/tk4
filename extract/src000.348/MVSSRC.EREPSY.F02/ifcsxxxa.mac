IFCSXXXA TITLE 'IFCSXXXA / SUM TABLE - LINKNAME=IFCS2400,ALIASES=IFCS32X
               11,IFCS3540,IFCS3203,IFCS3289.'
***********************************************************************
**                                                                   **
**                                                                   **
**  MODULE NAME:   IFCSXXXA                                          **
**                                                                   **
**  DESCRIPTIVE-NAME:   SUMMARY TABLE FOR 2400, 3211, 3540, XXXX,    **
**                     3203, 3289 DEVICES.                           **
**                                                                   **
**  COPYRIGHT:  NONE                                                 **
**                                                                   **
**  STATUS:    N/A                                                   **
**                                                                   **
**  FUNCTION:   PROVIDES DEVICE SUMMARY SUPPORT FOR 2400, 3211, 3540,**
**            XXXX, 3203, 3289.                                      **
**                                                                   **
**  NOTES:                                                           **
**                                                                   **
**    DEPENDENCIES:   THIS MODULE WAS ASSEMBLED USING THE EBCDIC     **
**                  CHARACTER SET.  IT MUST BE RE-ASSEMBLED IF       **
**                  ANOTHER CHARACTER SET IS TO BE USED AT EXECUTION **
**                                                                   **
**    RESTRICTIONS:   N/A                                            **
**                                                                   **
**    REGISTER-CONVENTIONS:                                          **
**          REG 2  = POINTER TO THE OBR RECORD                       **
**          REG 3  = POINTER TO THE PRINT BUFFER                     **
**          REG 4  = POINTER TO DATA ITEM REFERENCED IN 'ROUTINE'    **
**          REG 14 = RETURN POINT FROM 'ROUTINE'                     **
**          REG 15 = SET TO ZERO TO SUPPRESS PRINTING LINE           **
**                                                                   **
**    PATCH-LABEL:  PATCH                                            **
**                                                                   **
**  MODULE TYPE:    DATA                                             **
**                                                                   **
**    PROCESSOR:    370 ASSEMBLER                                    **
**                                                                   **
**    MODULE-SIZE:                                                   **
**                                                                   **
**    ATTRIBUTES:   SERIALLY RE-USABLE                               **
**                                                                   **
**  ENTRY-POINT:    N/A                                              **
**                                                                   **
**    LINKAGE:      N/A                                              **
**                                                                   **
**  INPUT:     N/A                                                   **
**                                                                   **
**  OUTPUT:    N/A                                                   **
**                                                                   **
**  EXIT-NORMAL:     N/A                                             **
**                                                                   **
**  EXIT-ERROR:      N/A                                             **
**                                                                   **
**  EXTERNAL-REFERENCES:                                             **
**                                                                   **
**    ROUTINES:        NONE                                          **
**                                                                   **
**    DATA-AREAS:      NONE                                          **
**                                                                   **
**    CONTROL-BLOCKS:  NONE                                          **
**                                                                   **
**    TABLES:          NONE                                          **
**                                                                   **
**    MACROS:    SUMMARY TABLE MACROS                                **
**                                                                   **
***********************************************************************
         EJECT                                                 @Z2002ST
         GBLC  &DSECT,&CSECT
&CSECT   SETC  'IFCSXXXA'
&DSECT   SETC  'XXXA'
IFCSXXXA CSECT
*              OBR SUM TABLE
*
*DEVICE CODE=8001 DEVICE TYPE=2400  ALIAS=IFCS2400             @Z2002ST
*            0809             3211        IFCS3211             @Z2002ST
*            0844             3540        IFCS3540             @Z2002ST
*            080B             3203      IFCS3203           @Z2002ST
*            080B             3289        IFCS3289             @Z2002ST
*
XXXA     DSECT                                                 @Z2002ST
         DSGEN (XKEY1,16),(XDUM1,8),(XSW,1),(SW2B1,1),           S21021X
               (SHRTSW,1),(SW2B3,1),(SW2B4,1),(SW2B5,1),         S21021X
               (SW2B6,1),(SW2B7,1)                               S21021
         DSGEN (XDUM2,32)                    SPARES
         DSGEN (XDATE,32)                    DATE
         DSGEN (XTIME,32)                    TIME
         DSGEN (XDUM3,8),(XSER,24)           SERIAL NO
         DSGEN (XMODEL,16),(XDUM8,16)        MODEL NUMBER
         DSGEN (XPGN1,32)                    JOB
         DSGEN (XPGN2,32)                       NAME
         DSGEN (XFCCWCC,8),(XFCCWDA,24)      FAILING
         DSGEN (XFCCWFL,8),(XZERO,8),(XFCCWCT,16)   FAILING CCW
         DSGEN (XCSWK,8),(XCSWCA,24)                CSW
         DSGEN (XCSWATTN,1),(XCSWSM,1),(XCSWUA,1),(XCSWBSY,1),         C
               (XCSWCE,1),(XCSWDE,1),(XCSWUC,1),(XCSWUE,1),            C
               (XCSWPCI,1),(XCSWSILI,1),(XCSWPC,1),(XCSWPCHK,1),       C
               (XCSWCDC,1),(XCSWCCC,1),(XCSWICC,1),(XCSWCH,1),         C
               (XCSWCT,16)
         DSGEN (XECSW,32)                              ECSW
         DSGEN (XDEVT1,16),(XDEVT2,16)
         DSGEN (XDUM6,8),(XCUA,24)                     CUA
         DSGEN (XDUM7,32)                              VOLUME
         DSGEN (XVOL1,32)                                   SERIAL
         DSGEN (XVOL2,16),(XDUMP,16)                             NO
         DSGEN (XDUM11,32)
         DSGEN (XDUM12,32)
         DSGEN (XDUM13,32)
         DSGEN (XDUM14,32)
         DSGEN (SDR1,8),(SDR2,8),(SDR3,8),(SDR4,8),              S21021C
               (SDR5,8),(SDR6,8),(SDR7,8),(SDR8,8)               S21021
         DSGEN (XDUM17,16),                                            C
               (XB0CMDR,1),(XB0INTRQ,1),(XB0BUSC,1),(XB0ECHK,1),       C
               (XB0DCHK,1),(XB0OVRN,1),(XB0WRD,1),(XB0DTC,1),          C
               (XB1NOISE,1),(XB1STATA,1),(XB1STATB,1),(XB17TRCK,1),    C
               (XB1LOADP,1),(XB1WTSTA,1),(XB1FLPRT,1),(XB1NCOMP,1)
         DSGEN (XB2TE0,1),(XB2TE1,1),(XB2TE2,1),(XB2TE3,1),            C
               (XB2TE4,1),(XB2TE5,1),(XB2TE6,1),(XB2TE7,1),            C
               (XB3RUN,1),(XB3LRC,1),(XB3SKW,1),(XB3CRC,1),            C
               (XB3SKV,1),(XB3PDE,1),(XB3BKW,1),(XB3CCM,1),            C
               (XB4ECH,1),(XB4REJ,1),(XB4RDC,1),(XB4WRC,1),            C
               (XB4DLY,1),(XB4CSQ,1),(XB4BSQ,1),(XB4ASQ,1),            C
               (XB5BT0,1),(XB5BT1,1),(XB5BT2,1),(XB5BT3,1),            C
               (XB5BT4,1),(XB5BT5,1),(XB5BT6,1),(XB5BT7,1)
         DSGEN (XB6BT0,1),(XB6BT1,1),(XB6BT2,1),(XB6BT3,1),    @Z2002STX
               (XB6BT4,1),(XB6BT5,1),(XB6BT6,1),(XB6BT7,1),    @Z2002STX
               (XB7BT0,1),(XB7BT1,1),(XB7BT2,1),(XB7BT3,1),    @Z2002STX
               (XB7BT4,1),(XB7BT5,1),(XB7BT6,1),(XB7BT7,1),    @Z2002STX
               (XB8BT0,1),(XB8BT1,1),(XB8BT2,1),(XB8BT3,1),    @Z2002STX
               (XB8BT4,1),(XB8BT5,1),(XB8BT6,1),(XB8BT7,1),    @Z2002STX
               (XB9BT0,1),(XB9BT1,1),(XB9BT2,1),(XB9BT3,1),    @Z2002STX
               (XB9BT4,1),(XB9BT5,1),(XB9BT6,1),(XB9BT7,1)     @Z2002ST
         DSGEN (XB10BT0,1),(XB10BT1,1),(XB10BT2,1),(XB10BT3,1),        X
               (XB10BT4,1),(XB10BT5,1),(XB10BT6,1),(XB10BT7,1),        X
               (XB11BT0,1),(XB11BT1,1),(XB11BT2,1),(XB11BT3,1),        X
               (XB11BT4,1),(XB11BT5,1),(XB11BT6,1),(XB11BT7,1),        X
               (XB12BT0,1),(XB12BT1,1),(XB12BT2,1),(XB12BT3,1),        X
               (XB12BT4,1),(XB12BT5,1),(XB12BT6,1),(XB12BT7,1),        X
               (XB13BT0,1),(XB13BT1,1),(XB13BT2,1),(XB13BT3,1),        X
               (XB13BT4,1),(XB13BT5,1),(XB13BT6,1),(XB13BT7,1) @Z2002ST
         DSGEN (XB14BT0,1),(XB14BT1,1),(XB14BT2,1),(XB14BT3,1),        X
               (XB14BT4,1),(XB14BT5,1),(XB14BT6,1),(XB14BT7,1),        X
               (XB15BT0,1),(XB15BT1,1),(XB15BT2,1),(XB15BT3,1),        X
               (XB15BT4,1),(XB15BT5,1),(XB15BT6,1),(XB15BT7,1),        X
               (XB16BT0,1),(XB16BT1,1),(XB16BT2,1),(XB16BT3,1),        X
               (XB16BT4,1),(XB16BT5,1),(XB16BT6,1),(XB16BT7,1),        X
               (XB17BT0,1),(XB17BT1,1),(XB17BT2,1),(XB17BT3,1),        X
               (XB17BT4,1),(XB17BT5,1),(XB17BT6,1),(XB17BT7,1) @Z2002ST
         DSGEN (XB18BT0,1),(XB18BT1,1),(XB18BT2,1),(XB18BT3,1),        X
               (XB18BT4,1),(XB18BT5,1),(XB18BT6,1),(XB18BT7,1),        X
               (XB19BT0,1),(XB19BT1,1),(XB19BT2,1),(XB19BT3,1),        X
               (XB19BT4,1),(XB19BT5,1),(XB19BT6,1),(XB19BT7,1),        X
               (XB20BT0,1),(XB20BT1,1),(XB20BT2,1),(XB20BT3,1),        X
               (XB20BT4,1),(XB20BT5,1),(XB20BT6,1),(XB20BT7,1),        X
               (XB21BT0,1),(XB21BT1,1),(XB21BT2,1),(XB21BT3,1),        X
               (XB21BT4,1),(XB21BT5,1),(XB21BT6,1),(XB21BT7,1) @Z2002ST
         DSGEN (XB22BT0,1),(XB22BT1,1),(XB22BT2,1),(XB22BT3,1),        X
               (XB22BT4,1),(XB22BT5,1),(XB22BT6,1),(XB22BT7,1),        X
               (XB23BT0,1),(XB23BT1,1),(XB23BT2,1),(XB23BT3,1),        X
               (XB23BT4,1),(XB23BT5,1),(XB23BT6,1),(XB23BT7,1),        X
               (XDUM9,16)                                      @X60CAFR
*                                                                S21021
         EJECT                                                 @Z2002ST
EXPNOBR  DSECT                                                   S21021
EXPNHDRA DS    CL52                                              S21021
EXPNDEVA DS    CL12                                              S21021
EXPNDA   DS    CL24                                              S21021
EXPNSDRA DS    CL10                                              S21021
EXPNSNSA DS    CL24                                            @Z2002ST
EXPNSIO  DS    CL4                                             @Z2002ST
*                                                                S21021
SHRTOBR  DSECT                                                   S21021
SHRTHDRA DS    CL24                                              S21021
SHRTDEVA DS    CL8                                               S21021
SHRTSDRA DS    CL10                                              S21021
*                                                                S21021
NORMOBR  DSECT                                                   S21021
NORMHDRA DS    CL64                                              S21021
NORMDA   DS    CL8                                               S21021
NORMSDRA DS    CL10                                              S21021
NORMSNSA DS    CL24                                            @Z2002ST
NORMSIO  DS    CL4                                             @Z2002ST
*                                                                S21021
*                                                                S21021
         EJECT                                                 @Z2002ST
IFCSXXXA CSECT
         USING XXXA,R2                                         @Z2002ST
         USING *,R9                                            @Z2002ST
         DC    A(ENTRIES)               PTR TO ENTRIES
         DC    A(PEDIT)                 PTR TO EDIT SECTION OF SUM TBL
REG8     DC    F'0'                     R8 SAVE AREA CURRENT ENTRY
SCSIZE   DC    AL2(SCNUM)          NO OF 2 BYTE CNTRS TO GET.  @Z2002ST
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         EJECT                                                 @Z2002ST
*
*        SPECIAL ROUTINE SECTION   R2=PTR TO LOGREC R9=BASE ADDR
*                                  R3=PTR TO BUM COUNTER
*
*        VOLUME SER      3 CNTRS ARE VOL SER  1 COUNTER THE NUMBER
*                                             R3 POINTS TO COUNTER
SETVOLS  TM    XSW,HEX20                IS THIS A SHORT RECORD?  S21021
         BCR   1,R14                    YES, NO VOLSER, RETURN   S21021
         STM   R5,R8,XSAVE              SAVE REGS                S21021
         CLC   XDEVT2(L2),H3211         TEST FOR 3211            S20202
         BE    RETURNV                  BRANCH                   S20202
         CLC   XDEVT2(L2),H3203    TEST FOR 3203/3289.         @Z2002ST
         BE    RETURNV             BR IF HAVE ONE--NO VOLSER.  @Z2002ST
         LA    R5,L10              LOOP COUNT                  @Z2002ST
         LR    R6,L3               SET COUNTER PTR             @Z2002ST
SETVOL1  CLC   L0(L6,R6),ZEROS     IS COUNTER EMPTY            @Z2002ST
         BE    SETVOL2             BR-YES
         CLC   L0(L6,R6),XVOL1          DOES THIS SER MATCH    @Z2002ST
         BE    SETVOL3             YES
         LA    R6,L8(R6)           BUMP TO NEXT SLOT           @Z2002ST
         BCT   R5,SETVOL1          LOOP                        @Z2002ST
         B     RETURNV             ALL FULL IGNORE
SETVOL2  MVC   L0(L6,R6),XVOL1     STORE NEW VOLUME SER        @Z2002ST
SETVOL3  LH    R7,L6(R6)           ADD                         @Z2002ST
         LA    R7,L1(R7)               1                       @Z2002ST
         STH   R7,L6(R6)                TO COUNTER             @Z2002ST
RETURNV  LM    R5,R6,XSAVE                AND                  @Z2002ST
         BR    R14                          RETURN
*
XDATE1   STM   R14,R15,L12(R13)         SAVE R14 & R 15          S21021
         BAL   R14,EXPANDER             BAL TO EXPAND REC        S21021
         STM   R0,R12,L20(R13)          SAVE REMAINDER OF REGS   S21021
         CLC   XDATE(L4),HEX00         IS DATE ZERO            @Z2002ST
         BE    RETURN                   BR-ZERO
         CLC   L0(L4,R3),HEX00          IS LOW DATE ZERO       @Z2002ST
         BNE   XDATE2                   BR-NO
         MVC   L0(L4,R3),XDATE          MOVE IN DATE           @Z2002ST
XDATE2   CLC   XDATE(L4),L0(R3)         CHECK FOR LOW DATE     @Z2002ST
         BL    SAVELOW                  LOWER SAVE IT
         CLC   XDATE(L4),L4(R3)         CHECK FOR HI           @Z2002ST
         BNH   RETURN                   BR-NOT HI
SAVEHI   MVC   L4(L4,R3),XDATE          MOVE HI DATE           @Z2002ST
         B     RETURN
SAVELOW  MVC   L0(L4,R3),XDATE          MOVE LOW DATE          @Z2002ST
         B     RETURN
*                                                                S21021
*                                       ROUTINE TO SUM SDR CNTRS S21021
*                                                                S21021
SDR1L    IC    R15,SDR1                                          S21021
SDRLEFT  SLL   R15,L24                  SHIFT OFF UNUSED BITS    S21021
SDRADD   SRL   R15,L28                  MOVE IT BACK FOR ADD     S21021
         AH    R15,L0(R3)               ADD IN COUNTER           S21021
         STH   R15,L0(R3)               SAVE RESULT              S21021
         BR    R14  RETURN                                       S21021
SDR1R    IC    R15,SDR1                 PICK UP COUNTER          S21021
SDRRIGHT SLL   R15,L28                  SHIFT OFF UNUSED BITS    S21021
         B     SDRADD                                            S21021
SDR2L    IC    R15,SDR2                                          S21021
         B     SDRLEFT                                           S21021
SDR3L    IC    R15,SDR3                                          S21021
         B     SDRLEFT                                           S21021
SDR4L    IC    R15,SDR4                                          S21021
         B     SDRLEFT                                           S21021
SDR5L    IC    R15,SDR5                                          S21021
         B     SDRLEFT                                           S21021
SDR6L    IC    R15,SDR6                                          S21021
         B     SDRLEFT                                           S21021
SDR7L    IC    R15,SDR7                                          S21021
         B     SDRLEFT                                           S21021
SDR8L    IC    R15,SDR8                                          S21021
         B     SDRLEFT                                           S21021
SDR2R    IC    R15,SDR2                                          S21021
         B     SDRRIGHT                                          S21021
SDR3R    IC    R15,SDR3                                          S21021
         B     SDRRIGHT                                          S21021
SDR4R    IC    R15,SDR4                                          S21021
         B     SDRRIGHT                                          S21021
SDR5R    IC    R15,SDR5                                          S21021
         B     SDRRIGHT                                          S21021
SDR6R    IC    R15,SDR6                                          S21021
         B     SDRRIGHT                                          S21021
SDR7R    IC    R15,SDR7                                          S21021
         B     SDRRIGHT                                          S21021
SDR8R    IC    R15,SDR8                                          S21021
         B     SDRRIGHT                                          S21021
*                                                                S21021
EXPANDER STM   R5,R6,XSAVE              SAVE WORK REGS           S21021
         MVI   RELSAVE,C' '        CLEAR RELEASE VALUE
         SR    R6,R6               CLEAR REGISTER
         IC    R6,XKEY1+L1         GET RELEASE/VERSION
         SRL   R6,L5               SHIFT OUT VERSION
         STC   R6,RELSAVE          SVE RELEASE VALUE
         LA    R5,OBRAREA               GET EXP AREA             S21021
         LR    R6,R2                    SWAP ADDRESSES           S21021
         USING EXPNOBR,R5               SET DSECT ADDRESSABILITY S21021
         USING NORMOBR,R6                                        S21021
         XC    OBRAREA(L126),OBRAREA CLEAR AREA.               @Z2002ST
         TM    XKEY1,HEX02              IS IT A CONVERTED REC    S21021
         BO    MOVEALL                  YES                      S21021
         TM    XSW,HEX20                IS IT A SHORT HEC        S21021
         BO    MOVESHRT                 YES                      S21021
         MVC   EXPNHDRA(L72),NORMHDRA   MOVE HEADER AND VOLSER   S21021
         CLC   XDEVT2(L2),H3540    3540?
         BNE   EXPNDRT1            NO,BYPASS
         CLI   RELSAVE,X'01'       DOS RECORD
         BNE   EXPNDRT1            NO,BYPASS
         XC    EXPNHDRA+L64(L8),EXPNHDRA+L64 CLEAR VOLUME
EXPNDRT1 CLC   XDEVT2(L2),H3203    3203?
         BE    EXPNDRT2            YES,USE LONG FORM
         CLC   XDEVT2(L2),H3211    3211?
         BE    EXPNDRT2            YES, USE LONG FORM
         CLI   RELSAVE,X'01'       DOS RECORD?
         BNE   EXPNDRT2            NO, USE LONG FORM
         CLC   XDEVT2(L2),DEVCODE  2400?
         BE    EXPNDRT3            YES, USE SPECIAL FORM
         MVC   EXPNSDRA(L8),NORMHDRA+L64 SDR COUNTERS
         MVC   EXPNSNSA(L24),NORMHDRA+L72 SENSE BYTES
         B     EXPNDRET            EXIT
EXPNDRT3 MVC   EXPNSDRA(L10+L24),NORMHDRA+88 MOVE 2400 DATA
         B     EXPNDRET
EXPNDRT2 MVC   EXPNSDRA(L10+L24),NORMHDRA+L72 MOVE DATA
EXPNDRET ST    R2,SAVE2                 SAVE R2                  S21021
         LR    R2,R5                    SWAP REG POINTERS        S21021
         LM    R5,R6,XSAVE              RESET REGS               S21021
         BR    R14                      RETURN                   S21021
MOVEALL  MVC   EXPNOBR(L110),NORMOBR MOVE ALL OF RECORD.       @Z2002ST
         B     EXPNDRET                                          S21021
         USING SHRTOBR,R6                                        S21021
MOVESHRT MVC   EXPNHDRA(L24),SHRTHDRA                            S21021
         MVC   EXPNDEVA(L8),SHRTDEVA                             S21021
         MVC   EXPNSDRA(L10),SHRTSDRA                            S21021
         B     EXPNDRET                                          S21021
*                                                                S21021
RESETR2  L     R2,SAVE2                 RESET R2                 S21021
         BR    R14                                               S21021
*                                                                S21021
*
*
L0       EQU   0
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L5       EQU   5
L6       EQU   6                                                 S21021
L7       EQU   7
L8       EQU   8
L9       EQU   9                                                 S21021
L10      EQU   10
L11      EQU   11                                              @Z2002ST
L12      EQU   12
L13      EQU   13                                                S21021
L14      EQU   14                                                S21021
L16      EQU   16                                                S21021
L17      EQU   17                                                S21021
L18      EQU   18                                                S21021
L20      EQU   20                                                S21021
L24      EQU   24                                                S21021
L28      EQU   28                                                S21021
L32      EQU   32                                                S21021
L64      EQU   64                                                S21021
L72      EQU   72                                                S21021
L104     EQU   104                                               S21021
L110     EQU   110                                             @Z2002ST
L126     EQU   126                                             @Z2002ST
HEX20    EQU   X'20'                                             S21021
SAVE2    DS    F                                                 S21021
OBRAREA  DS    CL126                                           @Z2002ST
         DS    0H
HEXFF    DC    X'FFFF'
HEX00    DC    XL4'00'
XFAILCCW TM    XSW,HEX20                IS THIS A SHORT RECORD?  S21021
         BCR   1,R14                    YES, NO CCW, RETURN      S21021
*
         STM   R14,R12,L12(R13)         SAVE REGS              @Z2002ST
         SR    R7,R7                                           @Z2002ST
         IC    R7,XFCCWCC               PICK UP FAILING CCW CODE
COMMON   SR    R1,R1                                           @Z2002ST
         L     R8,REG8             GET CURRENT PTR             @Z2002ST
         IC    R1,L1(R8)           PICK UP NUMBER OF ITERATIONS@Z2002ST
         LR    R5,R1               PLACE VALUE IN R5           @Z2002ST
         SLL   R5,L2               MULTIPLY BY 2               @Z2002ST
         AR    R5,R3               SET PTR TO POS PAST CTRS HOLDING
*                                  DATA - SUM COUNTER
         LH    R4,HEXFF            PICK UP FULL FLG            @Z2002ST
LOOP1    CH    R4,L0(R3)           IS THIS COUNT EMPTY         @Z2002ST
         BNE   STORE               BR-YES NOT FFFF
         CH    R7,L2(R3)           IS DATE EQUAL TO STORED     @Z2002ST
         BE    BUMP                YES
         LA    R3,L4(R3)           BUMP DATA PTR               @Z2002ST
         LA    R5,L2(R5)           BUMP SUM PTR                @Z2002ST
         BCT   R1,LOOP1            LOOP TILL DONE              @Z2002ST
         B     RETURN              FULL RETURN
STORE    STH   R4,L0(R3)           STORE FFFF FLAG             @Z2002ST
BUMP     LH    R6,L0(R5)                PICK UP COUNTER        @Z2002ST
         STH   R7,L2(R3)           STORE DATA                  @Z2002ST
         LA    R6,L1(R6)           BASED ON R5                 @Z2002ST
         STH   R6,L0(R5)                                       @Z2002ST
*
RETURN   LM    R14,R12,L12(R13)    RESTORE REGS                @Z2002ST
         BR    R14                 RETURN
*
XDEVT    MVC   L0(L4,R3),XDEVT1         MOVE INTO SUM AREA DEVTYPE
         BR    R14                      RETURN
ZEROS    DC    XL6'00'
RELSAVE  DC    C' '
         EJECT                                                 @Z2002ST
ENTRIES  DS    0F
         SPECIAL    XDATE1,00000000,SPACE=4                    @Z2002ST
         SPECIAL    XDEVT,00000000,SPACE=2                     @Z2002ST
         SPECIAL    XFAILCCW,00011000,SPACE=72                 @Z2002ST
         SPECIAL    SETVOLS,00000000,SPACE=40                  @Z2002ST
*                                                 SAVED 2 CNTRS SAVE
*                                                 CCW & 1 CNTER FOR SUM
*
         SUM        XB0CMDR
         SUM        XB0INTRQ
         SUM        XB0BUSC
         SUM        XB0ECHK
         SUM        XB0DCHK
         SUM        XB0OVRN
         SUM        XB0WRD
         SUM        XB0DTC
         SUM        XB1NOISE
         SUM   XB1STATA
         SUM   XB1STATB
         SUM   XB17TRCK
         SUM   XB1LOADP
         SUM        XB1WTSTA
         SUM        XB1FLPRT
         SUM        XB1NCOMP
         SUM        XB2TE0
         SUM        XB2TE1
         SUM        XB2TE2
         SUM        XB2TE3
         SUM   XB2TE4
         SUM        XB2TE5
         SUM   XB2TE6
         SUM        XB2TE7
         SUM        XB3RUN
         SUM        XB3LRC
         SUM        XB3SKW
         SUM        XB3CRC
         SUM        XB3SKV
         SUM        XB3PDE
         SUM        XB3BKW
         SUM   XB3CCM
         SUM   XB4ECH
         SUM   XB4REJ
         SUM        XB4RDC
         SUM        XB4WRC
         SUM        XB4DLY
         SUM   XB4CSQ
         SUM        XB4BSQ
         SUM        XB4ASQ
         SUM        XB5BT0
         SUM        XB5BT1
         SUM        XB5BT2
         SUM        XB5BT3
         SUM        XB5BT4
         SUM   XB5BT5
         SUM   XB5BT6
         SUM   XB5BT7
         SUM   XB6BT0                                          @Z2002ST
         SUM   XB6BT1                                          @Z2002ST
         SUM   XB6BT2                                          @Z2002ST
         SUM   XB6BT3                                          @Z2002ST
         SUM   XB6BT4                                          @Z2002ST
         SUM   XB6BT5                                          @Z2002ST
         SUM   XB6BT6                                          @Z2002ST
         SUM   XB6BT7                                          @Z2002ST
         SUM   XB7BT0                                          @Z2002ST
         SUM   XB7BT1                                          @Z2002ST
         SUM   XB7BT2                                          @Z2002ST
         SUM   XB7BT3                                          @Z2002ST
         SUM   XB7BT4                                          @Z2002ST
         SUM   XB7BT5                                          @Z2002ST
         SUM   XB7BT6                                          @Z2002ST
         SUM   XB7BT7                                          @Z2002ST
         SUM   XB8BT0                                          @Z2002ST
         SUM   XB8BT1                                          @Z2002ST
         SUM   XB8BT2                                          @Z2002ST
         SUM   XB8BT3                                          @Z2002ST
         SUM   XB8BT4                                          @Z2002ST
         SUM   XB8BT5                                          @Z2002ST
         SUM   XB8BT6                                          @Z2002ST
         SUM   XB8BT7                                          @Z2002ST
         SUM   XB9BT0                                          @Z2002ST
         SUM   XB9BT1                                          @Z2002ST
         SUM   XB9BT2                                          @Z2002ST
         SUM   XB9BT3                                          @Z2002ST
         SUM   XB9BT4                                          @Z2002ST
         SUM   XB9BT5                                          @Z2002ST
         SUM   XB9BT6                                          @Z2002ST
         SUM   XB9BT7                                          @Z2002ST
         SUM   XB10BT0                                         @Z2002ST
         SUM   XB10BT1                                         @Z2002ST
         SUM   XB10BT2                                         @Z2002ST
         SUM   XB10BT3                                         @Z2002ST
         SUM   XB10BT4                                         @Z2002ST
         SUM   XB10BT5                                         @Z2002ST
         SUM   XB10BT6                                         @Z2002ST
         SUM   XB10BT7                                         @Z2002ST
         SUM   XB11BT0                                         @Z2002ST
         SUM   XB11BT1                                         @Z2002ST
         SUM   XB11BT2                                         @Z2002ST
         SUM   XB11BT3                                         @Z2002ST
         SUM   XB11BT4                                         @Z2002ST
         SUM   XB11BT5                                         @Z2002ST
         SUM   XB11BT6                                         @Z2002ST
         SUM   XB11BT7                                         @Z2002ST
         SUM   XB12BT0                                         @Z2002ST
         SUM   XB12BT1                                         @Z2002ST
         SUM   XB12BT2                                         @Z2002ST
         SUM   XB12BT3                                         @Z2002ST
         SUM   XB12BT4                                         @Z2002ST
         SUM   XB12BT5                                         @Z2002ST
         SUM   XB12BT6                                         @Z2002ST
         SUM   XB12BT7                                         @Z2002ST
         SUM   XB13BT0                                         @Z2002ST
         SUM   XB13BT1                                         @Z2002ST
         SUM   XB13BT2                                         @Z2002ST
         SUM   XB13BT3                                         @Z2002ST
         SUM   XB13BT4                                         @Z2002ST
         SUM   XB13BT5                                         @Z2002ST
         SUM   XB13BT6                                         @Z2002ST
         SUM   XB13BT7                                         @Z2002ST
         SUM   XB14BT0                                         @Z2002ST
         SUM   XB14BT1                                         @Z2002ST
         SUM   XB14BT2                                         @Z2002ST
         SUM   XB14BT3                                         @Z2002ST
         SUM   XB14BT4                                         @Z2002ST
         SUM   XB14BT5                                         @Z2002ST
         SUM   XB14BT6                                         @Z2002ST
         SUM   XB14BT7                                         @Z2002ST
         SUM   XB15BT0                                         @Z2002ST
         SUM   XB15BT1                                         @Z2002ST
         SUM   XB15BT2                                         @Z2002ST
         SUM   XB15BT3                                         @Z2002ST
         SUM   XB15BT4                                         @Z2002ST
         SUM   XB15BT5                                         @Z2002ST
         SUM   XB15BT6                                         @Z2002ST
         SUM   XB15BT7                                         @Z2002ST
         SUM   XB16BT0                                         @Z2002ST
         SUM   XB16BT1                                         @Z2002ST
         SUM   XB16BT2                                         @Z2002ST
         SUM   XB16BT3                                         @Z2002ST
         SUM   XB16BT4                                         @Z2002ST
         SUM   XB16BT5                                         @Z2002ST
         SUM   XB16BT6                                         @Z2002ST
         SUM   XB16BT7                                         @Z2002ST
         SUM   XB17BT0                                         @Z2002ST
         SUM   XB17BT1                                         @Z2002ST
         SUM   XB17BT2                                         @Z2002ST
         SUM   XB17BT3                                         @Z2002ST
         SUM   XB17BT4                                         @Z2002ST
         SUM   XB17BT5                                         @Z2002ST
         SUM   XB17BT6                                         @Z2002ST
         SUM   XB17BT7                                         @Z2002ST
         SUM   XB18BT0                                         @Z2002ST
         SUM   XB18BT1                                         @Z2002ST
         SUM   XB18BT2                                         @Z2002ST
         SUM   XB18BT3                                         @Z2002ST
         SUM   XB18BT4                                         @Z2002ST
         SUM   XB18BT5                                         @Z2002ST
         SUM   XB18BT6                                         @Z2002ST
         SUM   XB18BT7                                         @Z2002ST
         SUM   XB19BT0                                         @Z2002ST
         SUM   XB19BT1                                         @Z2002ST
         SUM   XB19BT2                                         @Z2002ST
         SUM   XB19BT3                                         @Z2002ST
         SUM   XB19BT4                                         @Z2002ST
         SUM   XB19BT5                                         @Z2002ST
         SUM   XB19BT6                                         @Z2002ST
         SUM   XB19BT7                                         @Z2002ST
         SUM   XB20BT0                                         @Z2002ST
         SUM   XB20BT1                                         @Z2002ST
         SUM   XB20BT2                                         @Z2002ST
         SUM   XB20BT3                                         @Z2002ST
         SUM   XB20BT4                                         @Z2002ST
         SUM   XB20BT5                                         @Z2002ST
         SUM   XB20BT6                                         @Z2002ST
         SUM   XB20BT7                                         @Z2002ST
         SUM   XB21BT0                                         @Z2002ST
         SUM   XB21BT1                                         @Z2002ST
         SUM   XB21BT2                                         @Z2002ST
         SUM   XB21BT3                                         @Z2002ST
         SUM   XB21BT4                                         @Z2002ST
         SUM   XB21BT5                                         @Z2002ST
         SUM   XB21BT6                                         @Z2002ST
         SUM   XB21BT7                                         @Z2002ST
         SUM   XB22BT0                                         @Z2002ST
         SUM   XB22BT1                                         @Z2002ST
         SUM   XB22BT2                                         @Z2002ST
         SUM   XB22BT3                                         @Z2002ST
         SUM   XB22BT4                                         @Z2002ST
         SUM   XB22BT5                                         @Z2002ST
         SUM   XB22BT6                                         @Z2002ST
         SUM   XB22BT7                                         @Z2002ST
         SUM   XB23BT0                                         @Z2002ST
         SUM   XB23BT1                                         @Z2002ST
         SUM   XB23BT2                                         @Z2002ST
         SUM   XB23BT3                                         @Z2002ST
         SUM   XB23BT4                                         @Z2002ST
         SUM   XB23BT5                                         @Z2002ST
         SUM   XB23BT6                                         @Z2002ST
         SUM   XB23BT7                                         @Z2002ST
         SPECIAL  SDR1L,0,SPACE=1                                S21021
         SPECIAL  SDR1R,0,SPACE=1                                S21021
         SPECIAL  SDR2L,0,SPACE=1                                S21021
         SPECIAL  SDR2R,0,SPACE=1                                S21021
         SPECIAL  SDR3L,0,SPACE=1                                S21021
         SPECIAL  SDR3R,0,SPACE=1                                S21021
         SPECIAL  SDR4L,0,SPACE=1                                S21021
         SPECIAL  SDR4R,0,SPACE=1                                S21021
         SPECIAL  SDR5L,0,SPACE=1                                S21021
         SPECIAL  SDR5R,0,SPACE=1                                S21021
         SPECIAL  SDR6L,0,SPACE=1                                S21021
         SPECIAL  SDR6R,0,SPACE=1                                S21021
         SPECIAL  SDR7L,0,SPACE=1                                S21021
         SPECIAL  SDR7R,0,SPACE=1                                S21021
         SPECIAL  SDR8L,0,SPACE=1                                S21021
         SPECIAL  SDR8R,0,SPACE=1                                S21021
         SUM   SHRTSW                                            S21021
         SPECIAL    RESETR2,0,SPACE=1                            S21021
         DC    X'FF'
         EJECT                                                 @Z2002ST
PEDIT    DS    0F
&DSECT   SETC  'YYYA'
&CSECT   SETC  'PEDIT'
         USING *,R9
         USING YYYA,R2                                           S20202
*
*              EDIT AND PRINT SECTION
*
         DC    A(PENTRY)                ADDRESS OF EDIT ENTRIES
         DC    CL8'IFCSXXXA'
YR9PTR   DS    F
YLABELP  DS    F
*
         EJECT                                                 @Z2002ST
YYYA     DSECT
         DS    3H
         DSGEN (YDUMA,16),(YNOREC,16)
         DSGEN (YTYPE,8),(YCHAN,8),(YCUA,24),(YSER,24)
         DSGEN (YCPU,16),(YSMSW,16)
         DSGEN (YLOWD,32)               LOW DATE
         DSGEN (YHID,32)                HI DATE
         DSGEN (YDEVT1,16),(YDEVT2,16)
         DSGEN (YFFF01,16),(YNC01,8),(YCC01,8)
         DSGEN (YFFF02,16),(YNC02,8),(YCC02,8)
         DSGEN (YFFF03,16),(YNC03,8),(YCC03,8)
         DSGEN (YFFF04,16),(YNC04,8),(YCC04,8)
         DSGEN (YFFF05,16),(YNC05,8),(YCC05,8)
         DSGEN (YFFF06,16),(YNC06,8),(YCC06,8)
         DSGEN (YFFF07,16),(YNC07,8),(YCC07,8)
         DSGEN (YFFF08,16),(YNC08,8),(YCC08,8)
         DSGEN (YFFF09,16),(YNC09,8),(YCC09,8)
         DSGEN (YFFF10,16),(YNC10,8),(YCC10,8)
         DSGEN (YFFF11,16),(YNC11,8),(YCC11,8)
         DSGEN (YFFF12,16),(YNC12,8),(YCC12,8)
         DSGEN (YFFF13,16),(YNC13,8),(YCC13,8)
         DSGEN (YFFF14,16),(YNC14,8),(YCC14,8)
         DSGEN (YFFF15,16),(YNC15,8),(YCC15,8)
         DSGEN (YFFF16,16),(YNC16,8),(YCC16,8)
         DSGEN (YFFF17,16),(YNC17,8),(YCC17,8)
         DSGEN (YFFF18,16),(YNC18,8),(YCC18,8)
         DSGEN (YFFF19,16),(YNC19,8),(YCC19,8)
         DSGEN (YFFF20,16),(YNC20,8),(YCC20,8)
         DSGEN (YFFF21,16),(YNC21,8),(YCC21,8)
         DSGEN (YFFF22,16),(YNC22,8),(YCC22,8)
         DSGEN (YFFF23,16),(YNC23,8),(YCC23,8)
         DSGEN (YFFF24,16),(YNC24,8),(YCC24,8)
         DSGEN (YSC01,16),(YSC02,16)
         DSGEN (YSC03,16),(YSC04,16)
         DSGEN (YSC05,16),(YSC06,16)
         DSGEN (YSC07,16),(YSC08,16)
         DSGEN (YSC09,16),(YSC10,16)
         DSGEN (YSC11,16),(YSC12,16)
         DSGEN (YSC13,16),(YSC14,16)
         DSGEN (YSC15,16),(YSC16,16)
         DSGEN (YSC17,16),(YSC18,16)
         DSGEN (YSC19,16),(YSC20,16)
         DSGEN (YSC21,16),(YSC22,16)
         DSGEN (YSC23,16),(YSC24,16)
         DSGEN (YVOL1,48),(YVOL1C,16)
         DSGEN (YVOL2,48),(YVOL2C,16)
         DSGEN (YVOL3,48),(YVOL3C,16)
         DSGEN (YVOL4,48),(YVOL4C,16)
         DSGEN (YVOL5,48),(YVOL5C,16)
         DSGEN (YVOL6,48),(YVOL6C,16)
         DSGEN (YVOL7,48),(YVOL7C,16)
         DSGEN (YVOL8,48),(YVOL8C,16)
         DSGEN (YVOL9,48),(YVOL9C,16)
         DSGEN (YVOLA,48),(YVOLAC,16)
         DSGEN (YB0CMDR,16),(YB0INTV,16),(YB0BOCHK,16),(YB0ECHK,16)
         DSGEN (YB0DCHK,16),(YB0OVRN,16),(YB0WRD,16),(YB0DTC,16)
         DSGEN (YB1NOISE,16),(YB1STATA,16)
         DSGEN (YB1STATB,16),(YB17TRCK,16)
         DSGEN (YB1LOADP,16),(YB1WTSTA,16)
         DSGEN (YB1FLPRT,16),(YB1NCOMP,16)
         DSGEN (YB2TE0,16),(YB2TE1,16),(YB2TE2,16),(YB2TE3,16)
         DSGEN (YB2TE4,16),(YB2TE5,16),(YB2TE6,16),(YB2TE7,16)
         DSGEN (YB3WRN,16),(YB3LRC,16),(YB3SKW,16),(YB3CRC,16)
         DSGEN (YB3SKV,16),(YB3PED,16),(YB3BKW,16),(YB3CCM,16)
         DSGEN (YB4ECH,16),(YB4REJ,16),(YB4RDC,16),(YB4WRC,16)
         DSGEN (YB4DLY,16),(YB4CSQ,16),(YB4BSQ,16),(YB4ASQ,16)
         DSGEN (YB5BT0,16),(YB5BT1,16),(YB5BT2,16),(YB5BT3,16)
         DSGEN (YB5BT4,16),(YB5BT5,16),(YB5BT6,16),(YB5BT7,16)
         DSGEN (YB6BT0,16),(YB6BT1,16),(YB6BT2,16),(YB6BT3,16) @Z2002ST
         DSGEN (YB6BT4,16),(YB6BT5,16),(YB6BT6,16),(YB6BT7,16) @Z2002ST
         DSGEN (YB7BT0,16),(YB7BT1,16),(YB7BT2,16),(YB7BT3,16) @Z2002ST
         DSGEN (YB7BT4,16),(YB7BT5,16),(YB7BT6,16),(YB7BT7,16) @Z2002ST
         DSGEN (YB8BT0,16),(YB8BT1,16),(YB8BT2,16),(YB8BT3,16) @Z2002ST
         DSGEN (YB8BT4,16),(YB8BT5,16),(YB8BT6,16),(YB8BT7,16) @Z2002ST
         DSGEN (YB9BT0,16),(YB9BT1,16),(YB9BT2,16),(YB9BT3,16) @Z2002ST
         DSGEN (YB9BT4,16),(YB9BT5,16),(YB9BT6,16),(YB9BT7,16) @Z2002ST
         DSGEN (YB10BT0,16),(YB10BT1,16),(YB10BT2,16),(YB10BT3,16)
         DSGEN (YB10BT4,16),(YB10BT5,16),(YB10BT6,16),(YB10BT7,16)
         DSGEN (YB11BT0,16),(YB11BT1,16),(YB11BT2,16),(YB11BT3,16)
         DSGEN (YB11BT4,16),(YB11BT5,16),(YB11BT6,16),(YB11BT7,16)
         DSGEN (YB12BT0,16),(YB12BT1,16),(YB12BT2,16),(YB12BT3,16)
         DSGEN (YB12BT4,16),(YB12BT5,16),(YB12BT6,16),(YB12BT7,16)
         DSGEN (YB13BT0,16),(YB13BT1,16),(YB13BT2,16),(YB13BT3,16)
         DSGEN (YB13BT4,16),(YB13BT5,16),(YB13BT6,16),(YB13BT7,16)
*                                                              @Z2002ST
         DSGEN (YB14BT0,16),(YB14BT1,16),(YB14BT2,16),(YB14BT3,16)
         DSGEN (YB14BT4,16),(YB14BT5,16),(YB14BT6,16),(YB14BT7,16)
         DSGEN (YB15BT0,16),(YB15BT1,16),(YB15BT2,16),(YB15BT3,16)
         DSGEN (YB15BT4,16),(YB15BT5,16),(YB15BT6,16),(YB15BT7,16)
         DSGEN (YB16BT0,16),(YB16BT1,16),(YB16BT2,16),(YB16BT3,16)
         DSGEN (YB16BT4,16),(YB16BT5,16),(YB16BT6,16),(YB16BT7,16)
         DSGEN (YB17BT0,16),(YB17BT1,16),(YB17BT2,16),(YB17BT3,16)
         DSGEN (YB17BT4,16),(YB17BT5,16),(YB17BT6,16),(YB17BT7,16)
*                                                              @Z2002ST
         DSGEN (YB18BT0,16),(YB18BT1,16),(YB18BT2,16),(YB18BT3,16)
         DSGEN (YB18BT4,16),(YB18BT5,16),(YB18BT6,16),(YB18BT7,16)
         DSGEN (YB19BT0,16),(YB19BT1,16),(YB19BT2,16),(YB19BT3,16)
         DSGEN (YB19BT4,16),(YB19BT5,16),(YB19BT6,16),(YB19BT7,16)
         DSGEN (YB20BT0,16),(YB20BT1,16),(YB20BT2,16),(YB20BT3,16)
         DSGEN (YB20BT4,16),(YB20BT5,16),(YB20BT6,16),(YB20BT7,16)
         DSGEN (YB21BT0,16),(YB21BT1,16),(YB21BT2,16),(YB21BT3,16)
         DSGEN (YB21BT4,16),(YB21BT5,16),(YB21BT6,16),(YB21BT7,16)
*                                                              @Z2002ST
         DSGEN (YB22BT0,16),(YB22BT1,16),(YB22BT2,16),(YB22BT3,16)
         DSGEN (YB22BT4,16),(YB22BT5,16),(YB22BT6,16),(YB22BT7,16)
         DSGEN (YB23BT0,16),(YB23BT1,16),(YB23BT2,16),(YB23BT3,16)
         DSGEN (YB23BT4,16),(YB23BT5,16),(YB23BT6,16),(YB23BT7,16)
*                                                              @Z2002ST
         DSGEN (YSDR1L,16),(YSDR1R,16)                           S21021
         DSGEN (YSDR2L,16),(YSDR2R,16)                           S21021
         DSGEN (YSDR3L,16),(YSDR3R,16)                           S21021
         DSGEN (YSDR4L,16),(YSDR4R,16)                           S21021
         DSGEN (YSDR5L,16),(YSDR5R,16)                           S21021
         DSGEN (YSDR6L,16),(YSDR6R,16)                           S21021
         DSGEN (YSDR7L,16),(YSDR7R,16)                           S21021
         DSGEN (YSDR8L,16),(YSDR8R,16)                           S21021
         DSGEN (YSHRT,16),(YDUM1,16)                             S21021
TABSIZE  EQU   *-YYYA                                          @Z2002ST
SCNUM    EQU   (*-YLOWD)/2                                     @Z2002ST
         EJECT                                                 @Z2002ST
IFCSXXXA CSECT
*
*        SPECIAL ROUTINE SECTION
SETST1   STM   R5,R8,XSAVE              SAVE                     S20202
         CLC   L0(L2,R4),H3211          TEST FOR 3211            S20202
         BNE   IS3540                                          @Y30OPDP
         L     R5,SNS3211          POINT TO SENSE LABELS.      @Z2002ST
         ST    R5,YLABELP                                        S20202
         B     RETURNA                                           S20202
IS3540   CLC   L0(L2,R4),H3540                                 @Y30OPDP
         BNE   IS3203              GO CHECK FOR 3203/3289.     @Z2002ST
         L     R5,SNS3540                                      @Z2002ST
         ST    R5,YLABELP                                      @Y30OPDP
         B     RETURNA                                         @Y30OPDP
IS3203   CLC   L0(L2,R4),H3203     SEE IF HAVE 3203/3289.      @Z2002ST
         BNE   RETURNA             BR IF NO.                   @Z2002ST
         L     R5,SNS3203          YES--LOAD ADDR OF 3203/3289 LABELS.
         ST    R5,YLABELP          SAVE ADDR FORT LABEL OUTPUT.@Z2002ST
         B     RETURNA             GO RETURN TO CALLING CODE.  @Z2002ST
*                                                                S20202
*
SETVOL   MVC   L0(L6,R3),L0(R4)         MOV VOL LABEL TO LINE
         BR    R14
CHKVOL   CLC   L0(L6,R4),YZERO          IS COUNTER IN USE
         BCR   L7,R14                   BR YES
         SR    R15,R15                  DON'T PRINT LINE         S21021
         BR    R14                      RETURN                   S21021
CONVERT  STM   R5,R8,XSAVE              SAVE REGS
         LH    R5,L0(R4)                PICK UP COUNT
CONV1    CVD   R5,WORK                  CONVERT IT TO DEVIMALP
         UNPK  L0(L4,R3),WORK+L5(L3)    UNPACK IT      XA02745/YA02991
         MVZ   L3(L1,R3),L0(R3)         MOVE ZONE      XA02745/YA02991
RETURNA  LM    R5,R8,XSAVE              RESTORE REGS
         BR    R14
*
SKIPPER  BR    R14                      RETURN
*
SETDATE  UNPK  WORK(L8),L0(L4,R4)       PACK DATE
         MVZ   WORK+L7(L1),WORK         MOVE ON ZONE
         MVC   L0(L3,R3),WORK+L5        MOVE DATE TO PRINT LINE
         MVC   L5(L2,R3),WORK+L3        MOVE YEAR TO PRINT LINE
         BR    R14
*
CONVCC1  CLC   L0(L2,R4),HEXFFFF        IS THIS COUNTER EMPYT
         BCR   L8,R14                   NO TI IS FULL
         SR    R15,R15                  STOP LINE PRINTING
         BR    R14                      RETURN
*
*        FREEE COUNTERS AREA LAST THING DONE
*
FREECTR  STM   R14,R12,L12(R13)         SAVE ALL REGS
         LR    R12,R13                  SAVE SAVE AREA ADDR
         LA    R13,FSAVE                POINT TO MY SAVE
         ST    R12,L4(R13)              SET CHAINING POINTERS
         ST    R13,L8(R12)
         L     R3,L4(R2)                PICK UP POINTER TO NEXT COUNTER
         ST    R3,L28(R12)              SAVE POINTER IN REG SAVE
         LH    R0,SIZE                  PICK UP SIZE OF AREA
         LR    R1,R2                    SET ADDRESS
         FREEMAIN R,LV=(0),A=(1)
         LTR   R3,R3                    ANY MORE COUNTERS
         BZ    RETURN0                  NO  RETURN
         L     R5,APENTRY          ***POINT TO                 @Z2002ST
         LA    R5,L10(R5)          ADDR OF TOP ENTRY LESS 4.***@Z2002ST
         ST    R5,YR9PTR
         L     R5,ALABELS          POINT TO FIRST LABEL-1.     @Z2002ST
         ST    R5,YLABELP               STORE IT IN TABLE
RETURN0  L    R13,L4(R13)               PICK UP &
         LM    R14,R12,L12(R13)         RESTOR E REGS
         BR    R14
         LTORG
SETDEV   STM   R5,R8,XSAVE              SAVE REGS                S21021
         LA    R6,DEVTABLE                                       S20202
         LA    R5,L4               # OF DEVICE TABLE ENTRIES.  @Z2002ST
SETDEVT  CLC   L0(L2,R4),L0(R6)                                  S20202
         BE    SDEVFND                                           S20202
         LA    R6,L11(R6)          POINT TO NEXT TABLE ENTRY.  @Z2002ST
         BCT   R5,SETDEVT                                        S20202
         B     RETURNA                                           S20202
SDEVFND  MVC   L0(L9,R3),L2(R6)    MOVE LABEL TO PRINT LINE.   @Z2002ST
         B     RETURNA                                           S20202
XFF      EQU   X'FF'                                             S21021
SETCPUNO STM   R5,R8,XSAVE              SAVE REGS                S21021
         SR    R5,R5                    CLEAAR R5                S21021
         IC    R5,0(R4)                 PICK UP                  S21021
         SLL   R5,R8                      CPU TYPE               S21021
         IC    R5,L1(R4)                    FIELD                S21021
         LTR   R5,R5               IS IT ZERO?                 @Z2002ST
         BNZ   RETURNA                  NO, LINE IS GOOD, RETURN S21021
         LA    R6,L64                   ELSE, BACK UP DATA PTR   S21021
         SR    R3,R6                    TO PUT IN NEW INFO       S21021
         MVC   0(L6,R3),SHARED          SAY MODEL SHARED       @Z427VLS
         B     RETURNA                  RETURN                   S21021
*                                                              @Z2002ST
CHK3203  STM   R5,R8,XSAVE         SAVE REGS                   @Z2002ST
         CLC   YDEVT2(L2),H3203    CHECK DEVICE DESCRIPT.      @Z2002ST
         BNE   NOT3203             BR IF NOT 3203              @Z2002ST
         L     R5,MORE3203         ***SET LABEL POINTER TO     @Z2002ST
         ST    R5,YLABELP          REMAINDER OF SENSE LABELS.***
         B     RETURNA             GO RETURN TO LINE/LABEL MACRO
*                                  PROCESSING.                 @Z2002ST
SETSTAT  STM   R5,R8,XSAVE              SAVE REGS                S21021
NOT3203  L     R5,ASTATSCT         POINT TO EDITS FOR STATS.   @Z2002ST
         ST    R5,YR9PTR                LET EREP KNOW            S21021
         L     R5,ASTATLBS         POINTER FOR STAT LABELS.    @Z2002ST
         ST    R5,YLABELP               SET FOR EREP             S21021
         LA    R5,L17(R5)               BUMP PAST FIRST LABEL    S21021
         LA    R6,L4               NUMBER OF ENTRIES           @Z2002ST
         LA    R8,STLBLIST              POINT TO FIRST LABEL ENTRS21021
STLBCOMP CLC   0(L2,R4),0(R8)           IS THIS THE DEVICE TYPE  S21021
         BE    STLBLTFD                 YES, GO MOVE LABELS      S21021
         LA    R8,L18(R8)               NO, BUMP TO NEXT         S21021
         BCT   R6,STLBCOMP              NOT DONE, GO BACK        S21021
         LA    R8,STLBDFLT              DONE, USE DEFAULT        S21021
STLBLTFD DS    0H                  LABELS FOUND                  S21021
         LA    R8,L2(R8)                USE LABELS               S21021
         LA    R7,L16(R8)               DETERMINE END POINT      S21021
         ST    R7,STLBLEND              SAVE FOR COMPARE         S21021
STLABLP  DS    0H                                                S21021
         CLI   0(R8),XFF                IS THIS 'NOT USED'       S21021
         BE    STLBLNUS                 YES, LABEL = 'NOT USED'  S21021
         SR    R7,R7                    CLEAR R7                 S21021
         IC    R7,0(R8)                 GET INDEX TO LABEL       S21021
         MH    R7,HW13                  MULTIPLY TO GET LABEL    S21021
         A     R7,STLBTBAD              SET TO LABEL             S21021
         MVC   L0(L13,R5),L0(R7)        MOVE IN LABEL            S21021
         B     STLBL001                                          S21021
STLBLNUS DS    0H                                                S21021
         MVC   L0(L13,R5),STLBNTUS      'NOT USED' LABEL         S21021
STLBL001 DS    0H                                                S21021
         LA    R5,L14(R5)               BUMP R5                  S21021
         LA    R7,STLBTABL              GET PROPER LABEL         S21021
         LA    R8,L1(R8)                POINT TO NEXT INDEX      S21021
         C     R8,STLBLEND              AT END OF LIST?          S21021
         BNE   STLABLP                  NO, CONTINUE             S21021
         B     RETURNA                                           S21021
*                                                                S21021
STLBNTUS DC    C'NOT USED     '                                  S21021
HEX02    EQU   X'02'                                           @Z2002ST
*                                                              @Z2002ST
WORK     DS    D                                               @Z2002ST
XSAVE    DS    4F                                              @Z2002ST
FSAVE    DS    18F                                             @Z2002ST
CHARS    DC    C'0123456789ABCDEF'                             @Z2002ST
SIZE     DC    AL2(TABSIZE)        NO OF BYTES TO BE FREED.    @Z2002ST
HEXFFFF  DC    X'FFFF'                                         @Z2002ST
YZERO    DC    XL6'00'                                         @Z2002ST
APENTRY  DC    A(PENTRY)                                       @Z2002ST
SNS3211  DC    A(SENS3211)                                     @Z2002ST
SNS3540  DC    A(SENS3540)                                     @Z2002ST
SNS3203  DC    A(SENS3203)                                     @Z2002ST
MORE3203 DC    A(MOR3203)                                      @Z2002ST
ALABELS  DC    A(LABELS-L1)                                    @Z2002ST
ASTATSCT DC    A(STATSECT-L4)                                  @Z2002ST
ASTATLBS DC    A(STATLABS)                                     @Z2002ST
STLBLIST DS    0C                                                S21021
         DC    X'8001'                                           S21021
         DC    X'000102030405060708090A0B0C0D0E0F' 2400 STAT LABES21021
         DC    X'0844'                                         @Y30OPDP
         DC    X'FFFFFF1EFF1718191A1B1C1DFFFFFF0F' 3540/XXXX STAT
*                                  LABELS.                     @Z2002ST
         DC    X'080B'                                         @X60CAFR
         DC    X'0001FF03041011FF1213FF15FF16FF0F' 3203/3289 STAT
*                       LABELS.                                @Z2002ST
STLBDFLT DS    0C                                                S21021
         DC    X'0809'                                           S21021
         DC    X'0001FF03041011FF12131415FF16FF0F' 3211 STAT LABES21021
STLBTBAD DC    A(STLBTABL)                                       S21021
STLBTABL DS    0C                                                S21021
         DC    C'TEMPY READS  '         00                       S21021
         DC    C'TEMPY WRITES '         01                       S21021
         DC    C'INTRVN REQD  '         02                       S21021
         DC    C'BUS OUT CHK  '         03                       S21021
         DC    C'EQUIP CHK    '         04                       S21021
         DC    C'OVERRUN      '         05                       S21021
         DC    C'WD CT 0      '         06                       S21021
         DC    C'DATA CONV CHK'         07                       S21021
         DC    C'R/W VRC      '         08                       S21021
         DC    C'LRCR         '         09                       S21021
         DC    C'SKEW         '         0A                       S21021
         DC    C'CRC          '         0B                       S21021
         DC    C'SKEW REG VRC '         0C                       S21021
         DC    C'NOISE        '         0D                       S21021
         DC    C'RD OPP RECVY '         0E                       S21021
         DC    C'CHAN DATA CHK'         0F                       S21021
         DC    C'BUFF PTY CHK '         10                       S21021
         DC    C'LOAD CHECK   '         11                       S21021
         DC    C'CMND RETRY   '         12                       S21021
         DC    C'PRINT CHECK  '         13                       S21021
         DC    C'PRNT QUALITY '         14                       S21021
         DC    C'LINE POS     '         15                       S21021
         DC    C'CMND SUPPRESS'         16                       S21021
         DC    C'NRF CRC ERR  '               17               @Y30OPDP
         DC    C'NRF NO CRC ER'               18               @Y30OPDP
         DC    C'FAST/SLO INDX'               19               @Y30OPDP
         DC    C'ADR MARK FAIL'               1A               @Y30OPDP
         DC    C'DATA AM INCOR'               1B               @Y30OPDP
         DC    C'DATA CRC ERR '               1C               @Y30OPDP
         DC    C'CTRL U OVRRUN'               1D               @Y30OPDP
         DC    C'BUS OUT CHECK'               1E               @Y30OPDP
STLBLEND DC    F'0'                                              S21021
HW13     DC    H'13'                                             S21021
SHARED   DC    C'SHARED'                                       @Z427VLS
DEVTABLE DC    X'0809'                                           S20202
         DC    C'3211     '                                    @Z2002ST
         DC    X'8001'                                           S20202
         DC    C'2400     '                                    @Z2002ST
H3540    DC    X'0844'                                         @Y30OPDP
         DC    C'3540/XXXX'                                    @Z2002ST
H3203    DC    X'080B'                                         @Z2002ST
         DC    C'3203/3289'                                    @Z2002ST
H3211    DC    X'0809'                                           S20202
DEVCODE  DC    X'8001'                                           S20202
*
SENS3211 DC    C'CMND REJ*CMD RETRY*CAR F MOV*UCB PRTY*'
         DC    C'XTRA SCAN*BIT 0$'
         DC    C'INTV REQ*PRT CHECK*CAR SQ CK*PLB PRTY*'
         DC    C'PRT TRIG *BIT 1$'
         DC    C'BUS O CK*PRT QLTY *CAR SP CK*FCB PRTY*'
         DC    C'BLK PRINT*BIT 2$'
         DC    C'EQUIP CK*LINE POS *PLT F ADV*COIL PRO*'
         DC    C'PLAT INLK*BIT 3$'
         DC    C'DATA CHK*FRM CHECK*PLT F RET*H FIR CK*'
         DC    C'CAR GO   *BIT 4$'
         DC    C'B PAR CK*CMND SUPP*FORMS JAM*SERV AID*'         PT1403
         DC    C'CAR SETTL*BIT 5$'
         DC    C'LD CHECK*MECH MOTN*RIB MOT  *UCSAR S C*'
         DC    C'CAR COMPR*BIT 6$'
         DC    C'CHAN 9  *UNASSIGN*TRN OVLD *PSE S CHK*'
         DC    C'FWD DRIVE*BIT 7$'
         DC    C'$$$$$$'
*
SENS3540 DC    C'CMND REJ*PERM ERR*  FLAGS        *  CC           *'
         DC    C'   HH          *   R           $'             @Y30OPDP
         DC    C'INV REQ*AUTO RETRY*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'BUS O CHK*MOT. MAL*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'EQP CK*RETRY/IR*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'DATA CK*SREC XFR*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'NOT USED*NOT USED*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'NOT USED*NOT USED*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'NOT USED*NOT USED*               *               *'
         DC    C'               *               $'             @Y30OPDP
         DC    C'$$$$$$'                                       @Y30OPDP
*                                                              @Y30OPDP
*                                                              @X60CAFR
SENS3203 DC    C'CMND REJ *CMD RETRY*CAR F MOV*UCS PRTY *'
         DC    C'DEVICE ID*RIBN REV$'                          @Z2002ST
         DC    C'INTV REQ *PRT CHK  *CAR MO CK*PLB PRTY *'
         DC    C'UNASSIGN *RESTORE$'                           @Z2002ST
         DC    C'BUS O CK *NOT USED *NOT USED *NOT USED *'     @Z2002ST
         DC    C'UNASSIGN *RST LN CT$'                         @Z2002ST
         DC    C'EQUIP CK *LINE POS *NOT USED *COIL PRO *'     @Z2002ST
         DC    C'UNASSIGN *SPACE KEY$'                         @Z2002ST
         DC    C'DATA CHK *FRM CHECK*NOT USED *H. FIR CK*'     @Z2002ST
         DC    C'UNASSIGN *IDLE STAT$'                         @Z2002ST
         DC    C'B PAR CK *COMD SUPP*FORMS CHK*NOT USED *'     @Z2002ST
         DC    C'PRINT SS *START KEY$'                         @Z2002ST
         DC    C'LD CHECK *CTRLR CK *RB RV T O*SYNC CHK *'
         DC    C'CTRLR CK *STOP KEY$'                          @Z2002ST
         DC    C'CHAN 9   *UNASSIGN *TRN VELOC*UNASSIGN *'
         DC    C'STATS    *48 CHR ST$'                         @Z2002ST
         DC    C'$$$$$$'                                       @Z2002ST
PENTRY   DS    0F
         DC    X'00010001'
         DC    X'00010001'
         DC    A(LABELS)
         DC    H'0'
*
         DC    X'01'
         DC    X'000B8B00'
         LABEL      ' '
         LINE  (57,32),(23,26)                                   S21021
         HEX   YCPU,0,2B                                         S21021
         HEX   YSER,0,3B                                         S21021
         ROUTINE  YCPU,SETCPUNO                                  S21021
         LABEL 'DAY YEAR   DAY YEAR','MODEL-','SERIAL NO.'       S21021
         LINE       (23,11),(1,30)
         ROUTINE    YLOWD,SETDATE
         ROUTINE    YHID,SETDATE
         LABEL      'OUTBOARD DATE RANGE -','TO'
*
         LINE       (61,16),(1,62)
         HEX        YCUA
         ROUTINE    YDEVT2,SETDEV       GO DETERMINE DEVICE TYPE S20202
         LABEL 'SUMMARY OF I/O OUTBOARD ENVIRONMENT RECORDS FOR DEVICE'C
               ,'DEVICE TYPE'                                    S20202
*
         LINE  (29,),,SKIP=1                                     S21021
         ROUTINE    YNOREC,CONVERT
         LABEL      'TOTAL NUMBER OF RECORDS'
         LINE  ,,SKIP=2                                          S21021
         ROUTINE  YSHRT,CONVERT                                  S21021
         LABEL 'TOTAL OF OVERFLOW RECORDS'                       S21021
*
         LINE       ,(1,1)
         ROUTINE    YDUM1,SKIPPER
         LABEL 'CCW COMMAND CODES ENCOUNTERED(MAXIMUM OF 24)'
*
         LINE       ,(3,6),SKIP=1
         ROUTINE    YDUM1,SKIPPER
         LABEL      'CMND','TOTAL'
         LINE       (4,6),(1,1)
         HEX        YCC01
         ROUTINE    YSC01,CONVERT
         ROUTINE    YFFF01,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC02
         ROUTINE    YSC02,CONVERT
         ROUTINE    YFFF02,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC03
         ROUTINE    YSC03,CONVERT
         ROUTINE    YFFF03,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC04
         ROUTINE    YSC04,CONVERT
         ROUTINE    YFFF04,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC05
         ROUTINE    YSC05,CONVERT
         ROUTINE    YFFF05,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC06
         ROUTINE    YSC06,CONVERT
         ROUTINE    YFFF06,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC07
         ROUTINE    YSC07,CONVERT
         ROUTINE    YFFF07,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC08
         ROUTINE    YSC08,CONVERT
         ROUTINE    YFFF08,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC09
         ROUTINE    YSC09,CONVERT
         ROUTINE    YFFF09,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC10
         ROUTINE    YSC10,CONVERT
         ROUTINE    YFFF10,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC11
         ROUTINE    YSC11,CONVERT
         ROUTINE    YFFF11,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC12
         ROUTINE    YSC12,CONVERT
         ROUTINE    YFFF12,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC13
         ROUTINE    YSC13,CONVERT
         ROUTINE    YFFF13,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC14
         ROUTINE    YSC14,CONVERT
         ROUTINE    YFFF14,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC15
         ROUTINE    YSC15,CONVERT
         ROUTINE    YFFF15,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC16
         ROUTINE    YSC16,CONVERT
         ROUTINE    YFFF16,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC17
         ROUTINE    YSC17,CONVERT
         ROUTINE    YFFF17,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC18
         ROUTINE    YSC18,CONVERT
         ROUTINE    YFFF18,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC19
         ROUTINE    YSC19,CONVERT
         ROUTINE    YFFF19,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC20
         ROUTINE    YSC20,CONVERT
         ROUTINE    YFFF20,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC21
         ROUTINE    YSC21,CONVERT
         ROUTINE    YFFF21,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC22
         ROUTINE    YSC22,CONVERT
         ROUTINE    YFFF22,CONVCC1
         LABEL      ' '
         LINE  ,,SKIP=1
         HEX        YCC23
         ROUTINE    YSC23,CONVERT
         ROUTINE    YFFF23,CONVCC1
         LABEL      ' '
         LINE       ,,SKIP=1
         HEX        YCC24
         ROUTINE    YSC24,CONVERT
         ROUTINE    YFFF24,CONVCC1
         LABEL      ' '
         LINE       (12,12),(1,1),SKIP=1
         LABEL ''                                                S21021
         LINE  ,,SKIP=1
         ROUTINE    YDUM1,SKIPPER
         LABEL      'VOLUME LABELS ENCOUNTERED (MAXIMUM OF 10)'
         LINE  ,,SKIP=1
         ROUTINE    YVOL1,SETVOL
         ROUTINE    YVOL1C,CONVERT
         LABEL      'VOL. LABEL'
         ROUTINE    YVOL1,CHKVOL
         LINE  ,,SKIP=1
         ROUTINE    YVOL2,SETVOL
         ROUTINE    YVOL2C,CONVERT
         ROUTINE    YVOL2,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL3,SETVOL
         ROUTINE    YVOL3C,CONVERT
         ROUTINE    YVOL3,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL4,SETVOL
         ROUTINE    YVOL4C,CONVERT
         ROUTINE    YVOL4,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL5,SETVOL
         ROUTINE    YVOL5C,CONVERT
         ROUTINE    YVOL5,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL6,SETVOL
         ROUTINE    YVOL6C,CONVERT
         ROUTINE    YVOL6,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL7,SETVOL
         ROUTINE    YVOL7C,CONVERT
         ROUTINE    YVOL7,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL8,SETVOL
         ROUTINE    YVOL8C,CONVERT
         ROUTINE    YVOL8,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=1
         ROUTINE    YVOL9,SETVOL
         ROUTINE    YVOL9C,CONVERT
         ROUTINE    YVOL9,CHKVOL
         LABEL      ' '
         LINE       ,,SKIP=2
         ROUTINE    YVOLA,SETVOL
         ROUTINE    YVOLAC,CONVERT
         ROUTINE    YVOLA,CHKVOL
         LABEL      ' '
         LINE  ,,SKIP=2
         LABEL ''                                                S21021
         LINE  ,,SKIP=2
         LABEL      'SENSE BYTE SUMMARY'
         LINE      (12,19),(1,19)
         LABEL 'BYTE 0','BYTE 1','BYTE 2','BYTE 3','BYTE 4','BYTE 5'
         LINE       (12,19),(1,19),SKIP=1
         ROUTINE    YB0CMDR,CONVERT
         ROUTINE    YB1NOISE,CONVERT
         ROUTINE    YB2TE0,CONVERT
         ROUTINE    YB3WRN,CONVERT
         ROUTINE    YB4ECH,CONVERT
         ROUTINE    YB5BT0,CONVERT
         ROUTINE    YDEVT2,SETST1                                S20202
         LABEL 'CMNP REJ','NOISE','TRK ERR 0','R/W VRC','ECHO ERR',    C
               'BIT 0'
*
         LINE  ,,SKIP=1
         ROUTINE    YB0INTV,CONVERT
         ROUTINE    YB1STATA,CONVERT
         ROUTINE    YB2TE1,CONVERT
         ROUTINE    YB3LRC,CONVERT
         ROUTINE    YB4REJ,CONVERT
         ROUTINE    YB5BT1,CONVERT
         LABEL 'INTV REQD','TU STAT A','TRK ERR 1','LRCR','REJECT TU', *
               'BIT 1'
         LINE  ,,SKIP=1
         ROUTINE    YB0BOCHK,CONVERT
         ROUTINE    YB1STATB,CONVERT
         ROUTINE    YB2TE2,CONVERT
         ROUTINE    YB3SKW,CONVERT
         ROUTINE    YB4RDC,CONVERT
         ROUTINE    YB5BT2,CONVERT
         LABEL 'BUS O CHK','TU STAT B','TRK ERR 2','SKEW','READ CLCK', C
               'BIT 2'
         LINE  ,,SKIP=1
         ROUTINE    YB0ECHK,CONVERT
         ROUTINE    YB17TRCK,CONVERT
         ROUTINE    YB2TE3,CONVERT
         ROUTINE    YB3CRC,CONVERT
         ROUTINE    YB4WRC,CONVERT
         ROUTINE    YB5BT3,CONVERT
         LABEL 'EQUIP CHK','7 TRACK','TRK ERR 3','CRC/DT CH','WRITE CLCC
               ','BIT 3'
         LINE  ,,SKIP=1
         ROUTINE    YB0DCHK,CONVERT
         ROUTINE    YB1LOADP,CONVERT
         ROUTINE    YB2TE4,CONVERT
         ROUTINE    YB3SKV,CONVERT
         ROUTINE    YB4DLY,CONVERT
         ROUTINE    YB5BT4,CONVERT
         LABEL 'DATA CHK','LOAD PT','TRK ERR 4','SKEW VRC',     XA00641C
               'ST RD CHK','BIT 4'                              XA00641
         LINE  ,,SKIP=1
         ROUTINE    YB0OVRN,CONVERT
         ROUTINE    YB1WTSTA,CONVERT
         ROUTINE    YB2TE5,CONVERT
         ROUTINE    YB3PED,CONVERT
         ROUTINE    YB4CSQ,CONVERT
         ROUTINE    YB5BT5,CONVERT
         LABEL 'OVERRUN','WRITE STA','TRK ERR 5','PE DRIVE','C SEQUENC'C
               ,'BIT 5'
         LINE  ,,SKIP=1
         ROUTINE    YB0WRD,CONVERT
         ROUTINE    YB1FLPRT,CONVERT
         ROUTINE    YB2TE6,CONVERT
         ROUTINE    YB3BKW,CONVERT
         ROUTINE    YB4BSQ,CONVERT
         ROUTINE    YB5BT6,CONVERT
         LABEL 'WTD CNT 0','FL PROT','TRK ERR 6','BACKWARD','B SEQUENC'C
               ,'BIT 6'
         LINE  ,,SKIP=2                                          S21021
         ROUTINE    YB0DTC,CONVERT
         ROUTINE    YB1NCOMP,CONVERT
         ROUTINE    YB2TE7,CONVERT
         ROUTINE    YB3CCM,CONVERT
         ROUTINE    YB4ASQ,CONVERT
         ROUTINE    YB5BT7,CONVERT
         LABEL 'DT CNVRT','NOT COMP','TRK ERR 7','C COMPARE','A-SEQUENCC
               ','BIT 7'
         LINE  ,,SKIP=2                                        @Z2002ST
         ROUTINE YDEVT2,CHK3203    GO CHECK FOR 3203/3289.     @Z2002ST
         LABEL ''                                              @Z2002ST
MOR3203  LABEL 'BYTE 6','BYTE 7','BYTE 8','BYTE 9','BYTE 10',  @Z2002STX
               'BYTE 11'                                       @Z2002ST
         LINE  ,,SKIP=1                                        @Z2002ST
         ROUTINE YB6BT0,CONVERT                                @Z2002ST
         ROUTINE YB7BT0,CONVERT                                @Z2002ST
         ROUTINE YB8BT0,CONVERT                                @Z2002ST
         ROUTINE YB9BT0,CONVERT                                @Z2002ST
         ROUTINE YB10BT0,CONVERT                               @Z2002ST
         ROUTINE YB11BT0,CONVERT                               @Z2002ST
         LABEL 'INV FC RQ',                                    @Z2002STX
               'PRINT CHK',                                    @Z2002STX
               'FL TO MOV',                                    @Z2002STX
               'FORMS CHK',                                    @Z2002STX
               'FCT GO RJ',                                    @Z2002STX
               'ADAPT RDY'                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT1,CONVERT                                @Z2002ST
         ROUTINE YB7BT1,CONVERT                                @Z2002ST
         ROUTINE YB8BT1,CONVERT                                @Z2002ST
         ROUTINE YB9BT1,CONVERT                                @Z2002ST
         ROUTINE YB10BT1,CONVERT                               @Z2002ST
         ROUTINE YB11BT1,CONVERT                               @Z2002ST
         LABEL 'H/S FAULT',                                    @Z2002STX
               'CAB 2 PTY',                                    @Z2002STX
               'ACC SLOW ',                                    @Z2002STX
               'OUT OF FM',                                    @Z2002STX
               'MS NPL RY',                                    @Z2002STX
               'CARR OPER'                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT2,CONVERT                                @Z2002ST
         ROUTINE YB7BT2,CONVERT                                @Z2002ST
         ROUTINE YB8BT2,CONVERT                                @Z2002ST
         ROUTINE YB9BT2,CONVERT                                @Z2002ST
         ROUTINE YB12BT2,CONVERT                               @Z2002ST
         ROUTINE YB11BT2,CONVERT                               @Z2002ST
         LABEL 'UNASSIGN ',                                    @Z2002STX
               'DUCT PTY ',                                    @Z2002STX
               'MS FB PLS',                                    @Z2002STX
               'STK FL/JM',                                    @Z2002STX
               'HM BR OFF',                                    @Z2002STX
               'PRNT OPER'                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT3,CONVERT                                @Z2002ST
         ROUTINE YB7BT3,CONVERT                                @Z2002ST
         ROUTINE YB8BT3,CONVERT                                @Z2002ST
         ROUTINE YB9BT3,CONVERT                                @Z2002ST
         ROUTINE YB10BT3,CONVERT                               @Z2002ST
         ROUTINE YB11BT3,CONVERT                               @Z2002ST
         LABEL 'UNASSIGN ',                                    @Z2002STX
               'INTR OVRN',                                    @Z2002STX
               'XTR FB PL',                                    @Z2002STX
               'FT INLK O',                                    @Z2002STX
               'HM BR OFF',                                    @Z2002STX
               'INTR EXP '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT4,CONVERT                                @Z2002ST
         ROUTINE YB7BT4,CONVERT                                @Z2002ST
         ROUTINE YB8BT4,CONVERT                                @Z2002ST
         ROUTINE YB9BT4,CONVERT                                @Z2002ST
         ROUTINE YB10BT4,CONVERT                               @Z2002ST
         ROUTINE YB11BT4,CONVERT                               @Z2002ST
         LABEL 'UNASSIGN ',                                    @Z2002STX
               'SPUR INTR',                                    @Z2002STX
               'STEP CK 1',                                    @Z2002STX
               'ADP CL PR',                                    @Z2002STX
               'H BR S/NM',                                    @Z2002STX
               'T O EXP  '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT5,CONVERT                                @Z2002ST
         ROUTINE YB7BT5,CONVERT                                @Z2002ST
         ROUTINE YB8BT5,CONVERT                                @Z2002ST
         ROUTINE YB9BT5,CONVERT                                @Z2002ST
         ROUTINE YB10BT5,CONVERT                               @Z2002ST
         ROUTINE YB11BT5,CONVERT                               @Z2002ST
         LABEL 'INV IO CM',                                    @Z2002STX
               'MS B STAT',                                    @Z2002STX
               'STEP CK 2',                                    @Z2002STX
               'PRT CL PR',                                    @Z2002STX
               'HM BR BNC',                                    @Z2002STX
               'CK STP CD'                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB6BT6,CONVERT                                @Z2002ST
         ROUTINE YB7BT6,CONVERT                                @Z2002ST
         ROUTINE YB8BT6,CONVERT                                @Z2002ST
         ROUTINE YB9BT6,CONVERT                                @Z2002ST
         ROUTINE YB10BT6,CONVERT                               @Z2002ST
         ROUTINE YB11BT6,CONVERT                               @Z2002ST
         LABEL 'CTL BO PY',                                    @Z2002STX
               'FMR PY CK',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'TRN VL CK',                                    @Z2002STX
               'SYNC CK 1',                                    @Z2002STX
               'TRN DR OF'                                     @Z2002ST
         LINE  ,,SKIP=2                                        @Z2002ST
         ROUTINE YB6BT7,CONVERT                                @Z2002ST
         ROUTINE YB7BT7,CONVERT                                @Z2002ST
         ROUTINE YB8BT7,CONVERT                                @Z2002ST
         ROUTINE YB9BT7,CONVERT                                @Z2002ST
         ROUTINE YB10BT7,CONVERT                               @Z2002ST
         ROUTINE YB11BT7,CONVERT                               @Z2002ST
         LABEL 'HALT     ',                                    @Z2002STX
               'TIME OUT ',                                    @Z2002STX
               'CARR STOP',                                    @Z2002STX
               'SYNC CK 0',                                    @Z2002STX
               'SYNC CK 2',                                    @Z2002STX
               'FD RL IDL'                                     @Z2002ST
         LINE  ,,SKIP=2
         LABEL 'BYTE 12','BYTE 13','BYTE 14','BYTE 15','BYTE 16',      X
               'BYTE 17'                                       @Z2002ST
         LINE  ,,SKIP=1                                        @Z2002ST
         ROUTINE YB12BT0,CONVERT                               @Z2002ST
         ROUTINE YB13BT0,CONVERT                               @Z2002ST
         ROUTINE YB14BT0,CONVERT                               @Z2002ST
         ROUTINE YB15BT0,CONVERT                               @Z2002ST
         ROUTINE YB16BT0,CONVERT                               @Z2002ST
         ROUTINE YB17BT0,CONVERT                               @Z2002ST
         LABEL 'CAC BUSY ',                                    @Z2002STX
               'BIT 0    ',                                    @Z2002STX
               'PRNT CMPL',                                    @Z2002STX
               'BIT 0    ',                                    @Z2002STX
               'ENABLE   ',                                    @Z2002STX
               'BIT 0    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT1,CONVERT                               @Z2002ST
         ROUTINE YB13BT1,CONVERT                               @Z2002ST
         ROUTINE YB14BT1,CONVERT                               @Z2002ST
         ROUTINE YB15BT1,CONVERT                               @Z2002ST
         ROUTINE YB16BT1,CONVERT                               @Z2002ST
         ROUTINE YB17BT1,CONVERT                               @Z2002ST
         LABEL 'ERR PEND ',                                    @Z2002STX
               'BIT 1    ',                                    @Z2002STX
               'NOT READY',                                    @Z2002STX
               'BIT 1    ',                                    @Z2002STX
               'COMPARE  ',                                    @Z2002STX
               'BIT 1    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT2,CONVERT                               @Z2002ST
         ROUTINE YB13BT2,CONVERT                               @Z2002ST
         ROUTINE YB14BT2,CONVERT                               @Z2002ST
         ROUTINE YB15BT2,CONVERT                               @Z2002ST
         ROUTINE YB12BT2,CONVERT                               @Z2002ST
         ROUTINE YB17BT2,CONVERT                               @Z2002ST
         LABEL 'GO NT RDY',                                    @Z2002STX
               'BIT 2    ',                                    @Z2002STX
               'TIME INTR',                                    @Z2002STX
               'BIT 2    ',                                    @Z2002STX
               'FIRED    ',                                    @Z2002STX
               'BIT 2    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT3,CONVERT                               @Z2002ST
         ROUTINE YB13BT3,CONVERT                               @Z2002ST
         ROUTINE YB14BT3,CONVERT                               @Z2002ST
         ROUTINE YB15BT3,CONVERT                               @Z2002ST
         ROUTINE YB16BT3,CONVERT                               @Z2002ST
         ROUTINE YB17BT3,CONVERT                               @Z2002ST
         LABEL 'ATTN PEND',                                    @Z2002STX
               'BIT 3    ',                                    @Z2002STX
               'ADAPT ERR',                                    @Z2002STX
               'BIT 3    ',                                    @Z2002STX
               'HANDLED  ',                                    @Z2002STX
               'BIT 3    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT4,CONVERT                               @Z2002ST
         ROUTINE YB13BT4,CONVERT                               @Z2002ST
         ROUTINE YB14BT4,CONVERT                               @Z2002ST
         ROUTINE YB15BT4,CONVERT                               @Z2002ST
         ROUTINE YB16BT4,CONVERT                               @Z2002ST
         ROUTINE YB17BT4,CONVERT                               @Z2002ST
         LABEL 'CK STP RQ',                                    @Z2002STX
               'BIT 4    ',                                    @Z2002STX
               'OPERATION',                                    @Z2002STX
               'BIT 4    ',                                    @Z2002STX
               'DATA CHK ',                                    @Z2002STX
               'BIT 4    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT5,CONVERT                               @Z2002ST
         ROUTINE YB13BT5,CONVERT                               @Z2002ST
         ROUTINE YB14BT5,CONVERT                               @Z2002ST
         ROUTINE YB15BT5,CONVERT                               @Z2002ST
         ROUTINE YB16BT5,CONVERT                               @Z2002ST
         ROUTINE YB17BT5,CONVERT                               @Z2002ST
         LABEL 'CARR STOP',                                    @Z2002STX
               'BIT 5    ',                                    @Z2002STX
               'MACH CHK ',                                    @Z2002STX
               'BIT 5    ',                                    @Z2002STX
               'HMR FAIL ',                                    @Z2002STX
               'BIT 5    '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB12BT6,CONVERT                               @Z2002ST
         ROUTINE YB13BT6,CONVERT                               @Z2002ST
         ROUTINE YB14BT6,CONVERT                               @Z2002ST
         ROUTINE YB15BT6,CONVERT                               @Z2002ST
         ROUTINE YB16BT6,CONVERT                               @Z2002ST
         ROUTINE YB17BT6,CONVERT                               @Z2002ST
         LABEL 'REQ STACK',                                    @Z2002STX
               'BIT 6    ',                                    @Z2002STX
               'INTR ENBL',                                    @Z2002STX
               'BIT 6    ',                                    @Z2002STX
               'HMR MSFIR',                                    @Z2002STX
               'BIT 6    '                                     @Z2002ST
         LINE  ,,SKIP=2                                        @Z2002ST
         ROUTINE YB12BT7,CONVERT                               @Z2002ST
         ROUTINE YB13BT7,CONVERT                               @Z2002ST
         ROUTINE YB14BT7,CONVERT                               @Z2002ST
         ROUTINE YB15BT7,CONVERT                               @Z2002ST
         ROUTINE YB16BT7,CONVERT                               @Z2002ST
         ROUTINE YB17BT7,CONVERT                               @Z2002ST
         LABEL 'HI SP CAR',                                    @Z2002STX
               'BIT 7    ',                                    @Z2002STX
               'INTR REQ ',                                    @Z2002STX
               'BIT 7    ',                                    @Z2002STX
               'PLB PRTY ',                                    @Z2002STX
               'BIT 7    '                                     @Z2002ST
         LINE  ,,SKIP=2
         LABEL 'BYTE 18','BYTE 19','BYTE 20','BYTE 21','BYTE 22',      X
               'BYTE 23'                                       @Z2002ST
         LINE  ,,SKIP=1                                        @Z2002ST
         ROUTINE YB18BT0,CONVERT                               @Z2002ST
         ROUTINE YB19BT0,CONVERT                               @Z2002ST
         ROUTINE YB20BT0,CONVERT                               @Z2002ST
         ROUTINE YB21BT0,CONVERT                               @Z2002ST
         ROUTINE YB22BT0,CONVERT                               @Z2002ST
         ROUTINE YB23BT0,CONVERT                               @Z2002ST
         LABEL 'BIT 0    ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT1,CONVERT                               @Z2002ST
         ROUTINE YB19BT1,CONVERT                               @Z2002ST
         ROUTINE YB20BT1,CONVERT                               @Z2002ST
         ROUTINE YB21BT1,CONVERT                               @Z2002ST
         ROUTINE YB22BT1,CONVERT                               @Z2002ST
         ROUTINE YB23BT1,CONVERT                               @Z2002ST
         LABEL 'BIT 1    ',                                    @Z2002STX
               'RESTORE  ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT2,CONVERT                               @Z2002ST
         ROUTINE YB19BT2,CONVERT                               @Z2002ST
         ROUTINE YB20BT2,CONVERT                               @Z2002ST
         ROUTINE YB21BT2,CONVERT                               @Z2002ST
         ROUTINE YB18BT2,CONVERT                               @Z2002ST
         ROUTINE YB23BT2,CONVERT                               @Z2002ST
         LABEL 'BIT 2    ',                                    @Z2002STX
               'RST LN CT',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT3,CONVERT                               @Z2002ST
         ROUTINE YB19BT3,CONVERT                               @Z2002ST
         ROUTINE YB20BT3,CONVERT                               @Z2002ST
         ROUTINE YB21BT3,CONVERT                               @Z2002ST
         ROUTINE YB22BT3,CONVERT                               @Z2002ST
         ROUTINE YB23BT3,CONVERT                               @Z2002ST
         LABEL 'BIT 3    ',                                    @Z2002STX
               'SPACE KEY',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT4,CONVERT                               @Z2002ST
         ROUTINE YB19BT4,CONVERT                               @Z2002ST
         ROUTINE YB20BT4,CONVERT                               @Z2002ST
         ROUTINE YB21BT4,CONVERT                               @Z2002ST
         ROUTINE YB22BT4,CONVERT                               @Z2002ST
         ROUTINE YB23BT4,CONVERT                               @Z2002ST
         LABEL 'BIT 4    ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT5,CONVERT                               @Z2002ST
         ROUTINE YB19BT5,CONVERT                               @Z2002ST
         ROUTINE YB20BT5,CONVERT                               @Z2002ST
         ROUTINE YB21BT5,CONVERT                               @Z2002ST
         ROUTINE YB22BT5,CONVERT                               @Z2002ST
         ROUTINE YB23BT5,CONVERT                               @Z2002ST
         LABEL 'BIT 5    ',                                    @Z2002STX
               'ST/SNG CY',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=1
         ROUTINE YB18BT6,CONVERT                               @Z2002ST
         ROUTINE YB19BT6,CONVERT                               @Z2002ST
         ROUTINE YB20BT6,CONVERT                               @Z2002ST
         ROUTINE YB21BT6,CONVERT                               @Z2002ST
         ROUTINE YB22BT6,CONVERT                               @Z2002ST
         ROUTINE YB23BT6,CONVERT                               @Z2002ST
         LABEL 'BIT 6    ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
         LINE  ,,SKIP=2                                        @Z2002ST
         ROUTINE YB18BT7,CONVERT                               @Z2002ST
         ROUTINE YB19BT7,CONVERT                               @Z2002ST
         ROUTINE YB20BT7,CONVERT                               @Z2002ST
         ROUTINE YB21BT7,CONVERT                               @Z2002ST
         ROUTINE YB22BT7,CONVERT                               @Z2002ST
         ROUTINE YB23BT7,CONVERT                               @Z2002ST
         LABEL 'BIT 7    ',                                    @Z2002STX
               'NEAR EOFS',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN ',                                    @Z2002STX
               'UNASSIGN '                                     @Z2002ST
*
         LINE  ,,SKIP=2                                        @Z2002ST
         ROUTINE YDEVT2,SETSTAT                                @Z2002ST
STATLABS LABEL 'STATISTICAL DATA'                              @Z2002ST
STATSECT DS    0C                                                S21021
         LINE  (20,30),(1,30),SKIP=1                             S21021
         ROUTINE    YSDR1L,CONVERT                               S21021
         ROUTINE    YSDR1R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR2L,CONVERT                               S21021
         ROUTINE    YSDR2R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR3L,CONVERT                               S21021
         ROUTINE    YSDR3R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR4L,CONVERT                               S21021
         ROUTINE    YSDR4R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR5L,CONVERT                               S21021
         ROUTINE    YSDR5R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR6L,CONVERT                               S21021
         ROUTINE    YSDR6R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR7L,CONVERT                               S21021
         ROUTINE    YSDR7R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YSDR8L,CONVERT                               S21021
         ROUTINE    YSDR8R,CONVERT                               S21021
         LABEL '             ','             '                   S21021
         LINE  ,,SKIP=1
         ROUTINE    YDUM1,FREECTR
         LABEL      ' '
         DC    X'FF'
         DC    XL6'00'
         DC    C'$'
LABELS   EQU   *
         LSTART
         END

         TITLE 'IFCIOHND-IO SERVICES MODULE FOR IFCEREP1'
IFCIOHND CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCIOHND  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@06,20(@13)                                     0001
         STM   @08,@12,52(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         LA    @08,4095(,@09)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         USING @PSTART+12285,@08                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*DCL ADDNUM(1) CHAR(1) BASED(ADDNXT);                      /*@Z427VLS*/
*DCL NEXTBY FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL ADDNXT FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL NUMBER FIXED(31) INIT(0);                             /*@Z427VLS*/
*DCL GETTIT CHAR(4) DEFINED(GETHIS); /*ALPHA ACCESS OF GETHIS*/    0070
*DCL LISTPTR PTR(31) BASED(PTRSPOT); /*POINTER TO LIST PARAMETER*/ 0071
*DCL INARG  FIXED(15) BASED(LISTPTR); /*INPUT PARAMETER WITH @Z427VLS*/
*                                     /*SERVICE REQUESTED CODE*/   0073
*DCL LINECTT FIXED(15) INIT(0); /*RUNNING LINE COUNT FOR PAGE SKIPIN */
*DCL LINEMAX FIXED(15) INIT(0); /*MAXIMUM LINES PER PAGE, TOURIST*/
*DCL CCSAVE  CHAR(1) INIT(' '); /*CARRIAGE CONTROL CHAR SAVE SPOT*/
*DCL BLANKS CHAR(134) INIT(' '); /*BLANKS FOR PRINT LINE     @Z427VLS*/
*DCL MSGNO  FIXED(31)  INIT(0); /*MESSAGE TEXT INDEX         @Z427VLS*/
*DCL BADNEWS FIXED(31) INIT(0); /*RETURN CODE SAVE ITEM      @Z427VLS*/
*DCL PACKPAS  CHAR(4) INIT('    ');                        /*@Z427VLS*/
*DCL CHARPAS  CHAR(8) INIT('        ');                    /*@Z427VLS*/
*DCL PASSNUM  FIXED(31) INIT(0);                           /*@Z427VLS*/
*DCL EDIFILD(9) CHAR(1);                                   /*@Z427VLS*/
*DCL EDFLD CHAR(9) DEFINED(EDIFILD);                       /*@Z427VLS*/
*DCL CTPTR(10) FIXED(31) DEFINED(CONTPTR);                 /*@Z427VLS*/
*DCL CHARS CHAR(16) INIT('0123456789ABCDEF');              /*@Z427VLS*/
*/********************************************************************/
*DCL CLOSEALL BIT(16) CONSTANT('FFFF'X); /*EOF ALL CLOSED MASK*/   0086
*DCL SKIPNEW BIT(8) CONSTANT('8B'X);          /* SKIP TO CHANNEL ONE*/
*DCL NODSETS BIT(16) CONSTANT('0000'X); /*NO DATA SETS ASKED OPEN*/
*DCL DBLWORD BIT(32) CONSTANT('00000007'X); /*NO DOUBLE WORD MASK*/
*DCL NULL    BIT(32) CONSTANT('00000000'X);                /*@Z427VLS*/
*DCL CHARZERO BIT(8) CONSTANT('F0'X);                      /*@Z427VLS*/
*DCL BLANK    BIT(8) CONSTANT('40'X);                      /*@Z427VLS*/
*/********************************************************************/
*DCL  1  IOPLINE  CHAR(134)  BASED(PRINTADR), /*PRINT WORK AREA DSECT*/
*      2 PRINTDS  CHAR(1), /*DATA SET IS ERREPT IF F0        @Z427VLS*/
*                          /*DATA SET IS TOURIST IF F1       @Z427VLS*/
*      2 PRINTCC  CHAR(1), /*CARRIAGE CONTROL CHARACTER, IGNORED*/ 0093
*                          /*IF FROM USER FOR TOURIST DATA SET*/   0093
*      2 PRINTBDY CHAR(132); /*LINE TO BE PRINTED, WILL BE CLEARED*/
*                            /*TO BLANKS BEFORE RETURN TO USER*/   0094
*DCL 1 ERRLINE(29), /*INTERNAL DEBUG15 MESSAGES              @G51DGBB*/
*    2 ERRDS CHAR(1) INIT((29)'1'),                                0094
*    2 ERRCS CHAR(1) INIT((29)' '),                                0094
*    2 PRINTNM CHAR(9) INIT((29)'DEBUG15  '),                      0094
*    2 PRNTXT CHAR(40)                                             0094
*INIT('SERLOG OPEN ATTEMPTED                   ',  /*53      @Z427VLS*/
*     'CHECK HEADER FOR MORE RECORDS ATTEMPTED ', /*54       @Z427VLS*/
*     'RESET OF SERLOG HEADER ATTEMPTED        ', /*55       @Z427VLS*/
*     'SERLOG CLOSE ATTEMPTED                  ', /*56       @Z427VLS*/
*     'ZEROALL ATTEMPTED                       ', /*57       @Z427VLS*/
*     'SDR COUNTER DUMP ATTEMPTED              ', /*58       @Z427VLS*/
*     'SYSIN OPEN ATTEMPTED                    ', /*59       @Z427VLS*/
*     'SYSIN CLOSE ATTEMPTED                   ', /*60       @Z427VLS*/
*     'DIRECTWK CLOSE FOR WRITING ATTEMPTED    ', /*61       @Z427VLS*/
*     'DIRECTWK CLOSE FOR READING ATTEMPTED    ', /*62       @Z427VLS*/
*     'DIRECTWK OPEN FOR WRITE ATTEMPTED      ', /*63        @Z427VLS*/
*     'ACCIN OPEN ATTEMPTED                    ', /*64       @Z427VLS*/
*     'ACCIN CLOSE ATTEMPTED                   ', /*65       @Z427VLS*/
*     'ACCDEV CLOSE ATTEMPTED                  ', /*66       @Z427VLS*/
*     'EREPPT OPEN ATTEMPTED                   ', /*67       @Z427VLS*/
*     'EREPPT CLOSE ATTEMPTED                  ', /*68       @Z427VLS*/
*     'ACCDEV OPEN ATTEMPTED                   ',  /*69TH ENTRY*/  0094
*     'FIRST FRAME READ ATTEMPT                ',                  0094
*     'TIMES IFCIOHND EXITED WITH R.C.12       ', /*70       @Z427VLS*/
*     'SERLOG SEQUENTIAL READ ATTEMPTS         ', /*71       @Z427VLS*/
*     'SERLOG DIRECT READ ATTEMPTS             ', /*72       @Z427VLS*/
*     'TIME CONVERSION NECESSARY NUM. TIMES    ', /*73       @Z427VLS*/
*     'RECORDS SAVED DURING ZEROALL PROCESSING ', /*74       @Z427VLS*/
*     'SYSIN READ ATTEMPTS                     ', /*75       @Z427VLS*/
*     'DIRECTWK WRITE ATTEMPTS                 ', /*76       @Z427VLS*/
*     'DIRECTWK READ ATTEMPTS                  ', /*77       @Z427VLS*/
*     'ACCIN SEQUENTIAL READ ATTEMPTS          ', /*78       @Z427VLS*/
*     'ACCDEV WRITE ATTEMPTS                   ',                  0094
*     'FRAME READ ATTEMPTS OF SYS1.LOGREC      ');         /*@G51DGBB*/
*DCL MACHCODE(256) CHAR(1) /* ENSURE VALID MACHINE CODE      @ZA18999*/
*INIT('09'X,'01'X,(9)'09'X,'0B'X,(5)'09'X,'11'X,'09'X,'13'X,       0095
*     (5)'09'X,                                                    0095
*      '19'X,'09'X,'1B'X,(109)'09'X,'89'X,'09'X,'8B'X,             0095
*       (5)'09'X,'91'X,'09'X,'93'X,(5)'09'X,'99'X,                 0095
*       '09'X,'9B'X,(5)'09'X,'A1'X,'09'X,'A3'X,                    0095
*       (7)'09'X,'AB'X,(5)'09'X,'B1'X,                             0095
*       '09'X,'B3'X,(5)'09'X,'B9'X,'09'X,'BB'X,(5)'09'X,           0095
*       'C1'X,'09'X,'C3'X,(5)'09'X,'C9'X,'09'X,'CB'X,              0095
*       (5)'09'X,'D1'X,'09'X,'D3'X,(5)'09'X,'D9'X,                 0095
*        '09'X,'DB'X,(5)'09'X,'E1'X,'09'X,'E3'X,(20)'09'X);/*@ZA18999*/
*/********************************************************************/
*DCL PRNTBF CHAR(134) BDY(DWORD); /*INTERNAL PRINT LINE BUFFER*/   0096
*/********************************************************************/
*DCL 1  BUF1 BDY(DWORD), /*WORK AREA FOR QSAM RECORDS        @Z427VLS*/
*     2 BUF1RDW, /*RECORD DESCRIPTOR WORD                    @Z427VLS*/
*     3 BUF1RDWL FIXED(15) INIT(0), /*QSAM RECORD LENGTH     @Z427VLS*/
*     3 BUF1L    FIXED(15) INIT(0), /*QSAM ZEROS             @Z427VLS*/
*     2 BUF1DTA  CHAR(2000);    /*MAXIMUM SYS1.LOGREC RECORD LENGTH*/
*/*******************************************************************/
*DCL  1 RECTB BASED(RUNPTR), /*ZEROALL RECORD SAVE AREA DSECT*/    0098
*     2 FORPTR  PTR(31),                                           0098
*     2 JUNK,                                                      0098
*     3 JUNK1   CHAR(5),                                           0098
*     3 JUNK2   CHAR(1),                                           0098
*     3 JUNK3   FIXED(15),                                         0098
*     2 RECSPT  CHAR(1894);                                /*@Z427VLS*/
*/*******************************************************************/
* DCL 1 IOSWTCH CHAR(3) INIT('000000'X), /*NEW SWITCHES      @Z427VLS*/
*     2 HISTOPN BIT(1), /*OUTPUT HIST IS OPENED FLAG         @Z427VLS*/
*     2 SECGET   BIT(1), /*ZEROALL GETMAIN SWITCH            @Z427VLS*/
*     2 FLIPFLOP BIT(1), /*OFF SERLOG READSEQ, ON ACCIN READSEQ*/  0099
*     2 HISTYES BIT(1), /*INDICATES ACCIN INPUT SPECIFIED    @Z427VLS*/
*     2 DBLYES  BIT(1), /*DOUBLE WORD CREATION LOOP EXIT SWITCH*/  0099
*     2 LASTLOOP BIT(1),  /*ZEROALL PROCESSING               @Z427VLS*/
*     2 TOURERR BIT(1), /*ERROR WITH TOURIST DATA SET        @Z427VLS*/
*     2 INHISO  BIT(1), /*INPUT HIST IS IPENED FLAG          @Z427VLS*/
*     2 SERLO   BIT(1), /*SERLOG IS OPENED FLAG              @Z427VLS*/
*     2 TWOTRY  BIT(1), /*OFF IMPLIES 1ST EOF READING SERLOG SEQ.*/
*     2 INDIR   BIT(1), /*DIRECTWK IS OPENED FOR SEQ WRITE   @Z427VLS*/
*     2 NONBLANK BIT(1), /*NONBLANK LOOP FINDER SWITCH       @Z427VLS*/
*     2 CLOSE2  BIT(1), /*DIRECTWK IS OPENED FOR DIR WRITE   @Z427VLS*/
*     2 SYSOPN  BIT(1), /*SYSIN IS OPENED SWITCH             @Z427VLS*/
*     2 TOUROPN  BIT(1), /*TOURIST DS IS OPENED SWITCH       @Z427VLS*/
*     2 ERPTOPN  BIT(1), /*REGULAR PRINT D.S. HAS BEEN OPENED*/    0099
*    2 READFR   BIT(1), /*FRAMES ARE BEING READ SWITCH       @G51DGBB*/
*    2 SCRATCH  BIT(1), /*LAST OPERATION WAS READ DIRECT     @G51DGBB*/
*     2 SNAPOP  BIT(1); /*SNAP DS HAS BEEN OPENED SWITCH     @Z427VLS*/
*/********************************************************************/
*DCL    1   HDRBUFF   CHAR(64) BDY(DWORD),   /* EXTRACTOR WORK AREA  */
*          2   HDRSEEK             CHAR(8),  /* SEEK FIELD FOR I/O   */
*             3   HDRM             CHAR(1) INIT('00'X),            0100
*             3   HDRBB            CHAR(2) INIT('0000'X),          0100
*             3   HDRCC            CHAR(2) INIT('0000'X),          0100
*             3   HDRHH            CHAR(2) INIT('0000'X),          0100
*             3   HDRR             CHAR(1) INIT('00'X),            0100
*          2   HEADER              CHAR(40), /* HEADER REC - LOGREC  */
*             3   HDRKEY           CHAR(2),  /* FF00-HDR SOURCE FLD  */
*             3   HDRSCC           CHAR(2),  /* START OF     @Z427VLS*/
*             3   HDRSHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/
*             3   HDRECC           CHAR(2),  /* END OF       @Z427VLS*/
*             3   HDREHH           CHAR(2),  /* SYS1.LOGREC  @Z427VLS*/
*             3   HDRCOUNT         CHAR(1),  /* COUNT OF FULL MSG */
*             3   HDRREC1          CHAR(7),  /* CCHHR OF 1ST REC     */
*                4   HDR1BB        CHAR(2),                        0100
*                4   HDR1CC        CHAR(2),                        0100
*                4   HDR1HH        CHAR(2),                        0100
*                4   HDR1R         CHAR(1),                        0100
*             3   HDRREM           CHAR(2),  /* NO. OF BYTES REMAING */
*             3   HDRTRKCP         CHAR(2),  /* TRK CAPACITY @Z427VLS*/
*             3   HDRREC2          CHAR(7),  /* LAST ACTIVE RECORD   */
*                4   HDR2BB        CHAR(2),                        0100
*                4   HDR2CC        CHAR(2),                        0100
*                4   HDR2HH        CHAR(2),                        0100
*                4   HDR2R         CHAR(1),                        0100
*             3   HDRUCBNO         CHAR(2),  /* NO. OF UCB'S @Z427VLS*/
*             3   HDREXSZE         CHAR(2),  /* NO. OF TRK'S @Z427VLS*/
*             3   HDRTYPE          CHAR(1),  /* RES TYPE     @Z427VLS*/
*             3   *                CHAR(4),                        0100
*             3   *                CHAR(1),                        0100
*                4   HDRWNGBT       BIT(1),  /* 90% FULL SWITCH      */
*                4   *              BIT(1),                        0100
*                4   FRAMES         BIT(1), /*FRAMES EXIST FLAG*/  0100
*                4   *              BIT(4),                        0100
*             3   HDRSAFE          CHAR(1),  /* X'FF' INDICATES RECOK*/
*          2   PREVSEEK            CHAR(8),  /* PREVIOUS SEEK FIELD  */
*             3   PREVM            CHAR(1) INIT('FF'X), /* FF=CLOSED */
*             3   PREVBB           CHAR(2),                        0100
*             3   PREVCC           CHAR(2),                        0100
*             3   PREVHH           CHAR(2),                        0100
*             3   PREVR            CHAR(1);                /*@G51DGBB*/
*DCL     LOGRECA    CHAR(11) INIT('SYS1.LOGREC'); /* ENQUE/DEQUE     */
*DCL     LOGRECB    CHAR(8)  INIT('RECORDER');    /* NAMES FOR SYSTEM*/
*DCL     RESID      CHAR(8)  INIT('SERLOG');      /* & STEP ENQ/DEQ  */
*DCL     RESIDII    CHAR(8)  INIT('LOGREC');      /*         @Z427VLS*/
*DCL     SDRK  FIXED(15) INIT(0);                          /*@Z427VLS*/
*DCL     ZEROA CHAR(24);                                   /*@Z427VLS*/
*DCL 1 SEEKSAVE CHAR(8) INIT('0000000000000000'X), /*BEGINNING OF LOG*/
*    2 *      CHAR(7),                                             0107
*    2 SKSAVREC CHAR(1); /*R PORTION OF MBBCCHHR             @G51DGBB*/
*DCL     BYTESREM(14) FIXED(15)                             /*XL03145*/
*                        INIT(00000,    /* SPARE  CODE 00    @Z427VLS*/
*                             03419,    /* 2311   CODE 01    @Z427VLS*/
*                             20137,    /* 2301   CODE 02    @Z427VLS*/
*                             04596,    /* 2303   CODE 03    @Z427VLS*/
*                             04778,    /* 2302   CODE 04    @Z427VLS*/
*                             00000,    /* SPARE  CODE 05    @Z427VLS*/
*                             13192,    /* 2305-1 CODE 06    @Z427VLS*/
*                             14184,    /* 2305-2 CODE 07    @Z427VLS*/
*                             07008,    /* 2314   CODE 08    @Z427VLS*/
*                             12680,    /* 3330   CODE 09    @Z427VLS*/
*                             07954,    /* 3340   CODE 0A    @Z427VLS*/
*                             18800,    /* 3350   CODE 0B    @Z40RIVS*/
*                             00000,    /* SPARE  CODE 0C    @Z427VLS*/
*                             12680);   /* 3330-1 CODE 0D    @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      ECB,IOB,& CCW'S FOR EXCP                            @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*DCL    1   XWRECB  FIXED(31) INIT(0),  /* ECB               @Z427VLS*/
*          2   POST      CHAR(1),                                  0109
*          2   *         CHAR(3);                          /*@Z427VLS*/
*DCL    1   XIOB    CHAR(40) BDY(DWORD),                           0110
*          2   XIOBFL1   CHAR(1) INIT('42'X),                      0110
*          2   XIOBFL2   CHAR(1) INIT('00'X),                      0110
*          2   XIOBSNS0  CHAR(1) INIT('00'X),                      0110
*          2   XIOBSNS1  CHAR(1) INIT('00'X),                      0110
*          2   XIOBECB   PTR(31) INIT(ADDR(XWRECB)),               0110
*          2   XIOBCSW   CHAR(8) INIT('0000000000000000'X),        0110
*          2   XIOBCCW   PTR(31) INIT(ADDR(SEQ)),                  0110
*          2   XIOBDCB   PTR(31),                                  0110
*          2   XIOBRA    PTR(31) INIT(0),                          0110
*          2   XIOBBEC   FIXED(31) INIT(0),                        0110
*          2   XIOBSEEK  CHAR(8),                                  0110
*             3   XIOBM  CHAR(1)  INIT('00'X),                     0110
*             3   XIOBBB CHAR(2)  INIT('0000'X),                   0110
*             3   XIOBCC CHAR(2)  INIT('0000'X),                   0110
*             3   XIOBHH CHAR(2)  INIT('0000'X),                   0110
*             3   XIOBR  CHAR(1)  INIT('00'X);             /*@Z427VLS*/
*DCL    1   SWITCH  BIT(8) INIT('00'X), /* INTERNAL SWITCH   @Z427VLS*/
*          2   SBT0      BIT(1),        /* DISK OPEN         @Z427VLS*/
*          2   SBT2      BIT(1),        /* WRITE REQUIRED    @Z427VLS*/
*          2   SBT3      BIT(1),        /*                   @Z427VLS*/
*          2   SBT4      BIT(1),        /* HEADER RECORD I/O @Z427VLS*/
*          2   SBT7      BIT(1);        /* INTERNAL ENQ ISSUED       */
*DCL    1   SEQ     CHAR(24) BDY(DWORD),/* CCW STRING        @Z427VLS*/
*          2   SID1       CHAR(8),                /* SEARCH ID EQUAL */
*             3   *       CHAR(1) INIT('31'X),                     0112
*             3   AREAADR PTR(24) BDY(BYTE),      /* PTR TO COUNT FLD*/
*             3   *       CHAR(2) INIT('4000'X),                   0112
*             3   *       FIXED(15) BDY(BYTE) INIT(5),             0112
*          2   TIC1       CHAR(8),                /* TRANSFER IN CHAN*/
*            3    *       CHAR(1) INIT('08'X),                     0112
*             3   *       PTR(24) BDY(BYTE) INIT(ADDR(SID1)),      0112
*             3   *       CHAR(2) INIT('4000'X),                   0112
*             3   *       FIXED(15) BDY(BYTE) INIT(1),             0112
*          2   CKD1       CHAR(8),                /* R/W COUNT KEY & */
*             3   CKDCOM  CHAR(1),                /* DATA    @Z427VLS*/
*             3   CKDAREA  PTR(24) BDY(BYTE),     /* DATA PTR        */
*             3   CKDCHAIN CHAR(1) INIT('20'X),                    0112
*             3   *        CHAR(1) INIT('00'X),                    0112
*             3   CKDCOUNT FIXED(15) BDY(BYTE);   /* SIZE OF RECORD  */
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CONSTANTS & WORK AREAS FOR TIME/DATE CONVERSION     @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*DCL    1   WORK8   CHAR(8) BDY(DWORD),                            0113
*          2   WORK         FIXED(31),                             0113
*          2   WORKB        FIXED(31),                             0113
*             3   WHOURS     CHAR(1),                              0113
*             3   WMINS      CHAR(1),                              0113
*             3   WDAYS      CHAR(2),                              0113
*                4   WSECS   CHAR(1),                              0113
*                4   WTNTHS  CHAR(1);                      /*@Z427VLS*/
*DCL     TIMDIV     FIXED(31);                             /*@Z427VLS*/
*DCL     MILLION    FIXED(31) INIT(1000000);               /*@Z427VLS*/
*DCL     TWENTY4    FIXED(31) INIT(24);                    /*@Z427VLS*/
*DCL     SIXTY      FIXED(31) INIT(60);                    /*@Z427VLS*/
*DCL     CONSTG     FIXED(31) INIT('30040'X);              /*@Z427VLS*/
*DCL     CONSTH     FIXED(31) INIT('24AE062'X);            /*@Z427VLS*/
*DCL     SIXTYMIL   FIXED(31) INIT(60000000);              /*@Z427VLS*/
*DCL     PATCH(20) FIXED(15) INIT((20)0);    /* PATCH AREA   @Z427VLS*/
*GENERATE DATA;                                            /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      BASED DCL'S                                         @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      DSECT OF HEADER                                     @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   OHEADER           CHAR(40) BASED(R4),                  0123
*          2   OHDRKEY        CHAR(2),                             0123
*          2   OHDRSCC        CHAR(2),                             0123
*          2   OHDRSHH        CHAR(2),                             0123
*          2   OHDRECC        CHAR(2),                             0123
*          2   OHDREHH        CHAR(2),                             0123
*          2   OHDRHI         CHAR(1),                             0123
*          2   OHDRREC1       CHAR(7),                             0123
*             3   OHDR1BB     CHAR(2),                             0123
*             3   OHDR1CC     CHAR(2),                             0123
*             3   OHDR1HH     CHAR(2),                             0123
*             3   OHDR1R      CHAR(1),                             0123
*          2   OHDRREM        CHAR(2),                             0123
*          2   OHDRTRXC       CHAR(2),                             0123
*          2   OHDRREC2       CHAR(7),                             0123
*             3   OHDR2BB     CHAR(2),                             0123
*             3   OHDR2CC     CHAR(2),                             0123
*             3   OHDR2HH     CHAR(2),                             0123
*             3   OHDR2R      CHAR(1),                             0123
*          2   OHDRUCBN       CHAR(2),                             0123
*          2   OHDREXSZ       CHAR(2),                             0123
*          2   OHDRTYP        CHAR(1),                             0123
*          2   *              CHAR(5),                             0123
*          2   OHDRSAFE       CHAR(1);                     /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/*      DSECT OF INPUT BUFFER                               @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   BUFFER  DEFINED(BUF1), /*USE FOR SERLOP EXCP READS*/   0124
*          2   BCOUNT              CHAR(8),  /* COUNT AREA   @Z427VLS*/
*             3   BCCHHR           CHAR(5),  /* COUNT FROM REC       */
*             3   BKEYL            CHAR(1),  /* KEY LENGTH=0 @Z427VLS*/
*             3   BSIZE            CHAR(2),  /* SIZE OF RECORD READ  */
*          2   BDATA                 CHAR(1900);           /*@G51DGBB*/
*DCL  BSZ FIXED(15) DEFINED(BSIZE); /*ACCESS BSIZE AS NUMERIC*/    0125
*DCL SAVELENT FIXED(15) INIT(0); /*DATA LENGTH + 4 FROM READSEQ*/  0126
*DCL  BBRDW CHAR(2) DEFINED(BCCHHR) POSITION(5); /*USE TO SHUFFLE*/
*                                /*LOGREC RECORD INTO V FORMAT*/   0128
*/*                                                          @Z427VLS*/
*/*      DSCECT OF AN INPUT RECORD                           @Z427VLS*/
*/*                                                          @Z427VLS*/
*DCL    1   RECAREA              BASED(TIMEBASE),                  0128
*          2   RECKEY              CHAR(1),                        0128
*          2   *                   CHAR(1),                        0128
*          2   *                   CHAR(6),                        0128
*             3   *                 BIT(1),                        0128
*             3   NSSWITCH          BIT(1),  /* NS TIME INDICATOR    */
*             3   *                 BIT(2),                        0128
*             3   LCSWITCH          BIT(1),  /* LOCAL TIME  INDICATOR*/
*             3   *                 BIT(3),                        0128
*          2   DATETIME            CHAR(8),                        0128
*             3   DATE             CHAR(4),                        0128
*                4   DATE0         CHAR(1),                        0128
*                   5   GMTSW       BIT(1),                        0128
*                   5   *           BIT(7),                        0128
*                4   YEAR          CHAR(1),                        0128
*                4   DAYS          CHAR(2),                        0128
*             3   TIME             CHAR(4),                        0128
*                4   HOURS         CHAR(1),                        0128
*                4   MINS          CHAR(1),                        0128
*                4   SECS          CHAR(1),                        0128
*                4   TNTHS         CHAR(1);                /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      EQUATES                                             @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*GENERATE ;                                                /*@Z427VLS*/
L0       EQU   0
L1       EQU   1
L2       EQU   2
L4       EQU   4
L6       EQU   6
L8       EQU   8
L10      EQU   10
L12      EQU   12
L19      EQU   19
L20      EQU   20
L24      EQU   24
L36      EQU   36
L38      EQU   38
L256     EQU   256
OPENOK   EQU   X'10'
ZR0      EQU   8
*DCL THCONV FIXED(31) INIT(10000);                         /*@Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      STARTING LOCATION FOR IFCIOHND                      @Z427VLS*/
*/*                                                          @Z427VLS*/
*                                      /*R2 HAS COMTABLE ADDRESS*/ 0131
*PTRSPOT = R1; /*GET PARAMETER LIST ADDRESS OF ADDRESS       @Z427VLS*/
         ST    R1,PTRSPOT                                          0131
*SAVER2 = R2; /*PRESUME THAT R2 HAS ADDRESS OF COMTABLE AT THIS POINT*/
         ST    R2,SAVER2                                           0132
*GENERATE;                                                 /*@Z427VLS*/
         USING IHADCB,R12      USE R12 FOR ADDRESSING DCBS
*BADNEWS = ZERO; /*RETURN CODE SAVE ITEM                     @Z427VLS*/
         SLR   @12,@12                                             0134
         ST    @12,BADNEWS                                         0134
*RESPECIFY (R2,R1) UNRESTRICTED;                           /*@Z427VLS*/
*/*DETERMINE SERVICE CALLER HAS REQUESTED AND BRANCH TO APPROPRIATE*/
*/*ROUTINE                                                   @Z427VLS*/
*IF INARG = READSEQ THEN /*IF READ OF SERLOG OR ACCIN REQUESTED*/  0136
         L     @12,PTRSPOT                                         0136
         L     @12,LISTPTR(,@12)                                   0136
         CLC   INARG(2,@12),@CH00077                               0136
         BNE   @RF00136                                            0136
*  CALL READSIT;                                           /*@Z427VLS*/
         BAL   @14,READSIT                                         0137
*ELSE                                                              0138
*  DO;                                                     /*@Z427VLS*/
         B     @RC00136                                            0138
@RF00136 DS    0H                                                  0139
*    IF INARG = READIRCT THEN                                      0139
         L     @12,PTRSPOT                                         0139
         L     @12,LISTPTR(,@12)                                   0139
         CLC   INARG(2,@12),@CH00082                               0139
         BNE   @RF00139                                            0139
*      CALL DIRECTIT; /*EXCP READ OF SERLOG OR POINT SEQ. READ OF WORK*
         BAL   @14,DIRECTIT                                        0140
*    ELSE                                                          0141
*      DO;                                                 /*@Z427VLS*/
         B     @RC00139                                            0141
@RF00139 DS    0H                                                  0142
*        IF INARG = RITEHIST THEN                                  0142
         L     @12,PTRSPOT                                         0142
         L     @12,LISTPTR(,@12)                                   0142
         CLC   INARG(2,@12),@CH00065                               0142
         BNE   @RF00142                                            0142
*          CALL HISTIT; /*QSAM WRITE TO ACCDEV, HISTORY OUTPUT*/   0143
         BAL   @14,HISTIT                                          0143
*        ELSE                                                      0144
*          DO;                                             /*@Z427VLS*/
         B     @RC00142                                            0144
@RF00142 DS    0H                                                  0145
*            IF INARG = RITESCRT THEN /*SEQUENTIAL NOTE WRITE TO WORK*/
         L     @12,PTRSPOT                                         0145
         L     @12,LISTPTR(,@12)                                   0145
         CLC   INARG(2,@12),@CH00080                               0145
         BNE   @RF00145                                            0145
*              CALL SCRCHIT;                               /*@Z427VLS*/
         BAL   @14,SCRCHIT                                         0146
*            ELSE                                                  0147
*              DO;                                         /*@Z427VLS*/
         B     @RC00145                                            0147
@RF00145 DS    0H                                                  0148
*                IF INARG = RITEPRTR THEN                          0148
         L     @12,PTRSPOT                                         0148
         L     @12,LISTPTR(,@12)                                   0148
         CLC   INARG(2,@12),@CH00075                               0148
         BNE   @RF00148                                            0148
*                  CALL PRINTIT;                           /*@Z427VLS*/
         BAL   @14,PRINTIT                                         0149
*                ELSE                                              0150
*                  DO;                                     /*@Z427VLS*/
         B     @RC00148                                            0150
@RF00148 DS    0H                                                  0151
*                    IF INARG = IOOPEN THEN                        0151
         L     @12,PTRSPOT                                         0151
         L     @12,LISTPTR(,@12)                                   0151
         CLC   INARG(2,@12),@CH00056                               0151
         BNE   @RF00151                                            0151
*                      CALL OPENIT;                        /*@Z427VLS*/
         BAL   @14,OPENIT                                          0152
*                    ELSE                                          0153
*                      DO;                                 /*@Z427VLS*/
         B     @RC00151                                            0153
@RF00151 DS    0H                                                  0154
*                        IF INARG = IOCLOSE THEN                   0154
         L     @12,PTRSPOT                                         0154
         L     @12,LISTPTR(,@12)                                   0154
         CLC   INARG(2,@12),@CH00037                               0154
         BNE   @RF00154                                            0154
*                          CALL CLOSIT;                    /*@Z427VLS*/
         BAL   @14,CLOSIT                                          0155
*                        ELSE                                      0156
*                          DO;                             /*@Z427VLS*/
         B     @RC00154                                            0156
@RF00154 DS    0H                                                  0157
*                                IF INARG = READCARD THEN          0157
         L     @12,PTRSPOT                                         0157
         L     @12,LISTPTR(,@12)                                   0157
         CLC   INARG(2,@12),@CH00034                               0157
         BNE   @RF00157                                            0157
*                                  CALL REEDSYS;           /*@Z427VLS*/
         BAL   @14,REEDSYS                                         0158
*                                ELSE                              0159
*                                  DO;                     /*@Z427VLS*/
         B     @RC00157                                            0159
@RF00157 DS    0H                                                  0160
*                                     MSGNO = 1;           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00056                                   0160
*                                     CALL ERRMSG;         /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0161
*                                  END;                    /*@Z427VLS*/
*                           END;                           /*@Z427VLS*/
@RC00157 DS    0H                                                  0164
*                       END;                               /*@Z427VLS*/
@RC00154 DS    0H                                                  0165
*                    END;                                  /*@Z427VLS*/
@RC00151 DS    0H                                                  0166
*                END;                                      /*@Z427VLS*/
@RC00148 DS    0H                                                  0167
*             END;                                         /*@Z427VLS*/
@RC00145 DS    0H                                                  0168
*          END;                                            /*@Z427VLS*/
@RC00142 DS    0H                                                  0169
*       END;                                               /*@Z427VLS*/
@RC00139 DS    0H                                                  0170
*GOBACK: ;                                                 /*@Z427VLS*/
@RC00136 DS    0H                                                  0170
GOBACK   DS    0H                                                  0171
*RESPECIFY(R15) RESTRICTED;                                /*@Z427VLS*/
*R15 = BADNEWS;                                            /*@Z427VLS*/
         L     R15,BADNEWS                                         0172
*IF R15 > FOUR THEN /*FIND OUT IF USER CHECKING RETURN CODE  @Z427VLS*/
         C     R15,@CF00065                                        0173
         BNH   @RF00173                                            0173
*  ERRORENT = ERRORENT + 1; /*USER BUNGLE IF MORE THAN ONE   @Z427VLS*/
         LA    @14,1                                               0174
         AL    @14,ERRORENT                                        0174
         ST    @14,ERRORENT                                        0174
*RETURN;                                                   /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0175
@EF00001 DS    0H                                                  0175
@ER00001 L     @14,12(,@13)                                        0175
         LM    @00,@06,20(@13)                                     0175
         LM    @08,@12,52(@13)                                     0175
         BR    @14                                                 0175
*     /*THIS IS A STRUCTURED PROC TO REPLACE EXCPLOOP        @G51DGBB*/
*     /*OTHERWISE, THE ONLY CHANGES ARE THAT ALL REFERENCES  @G51DGBB*/
*     /*TO ZEROING INDIVIDUAL RECORDS HAVE BEEN REMOVED AND  @G51DGBB*/
*     /*THE LOCATION OF THE BEGINNING OF LOGREC FROM THE DEB @G51DGBB*/
*     /*IS SAVED FOR INITIALIZATION TO READ FRAMES           @G51DGBB*/
*/*EXCP LOOP THAT PERFORMS ALL IO OPERATIONS TO LOGREC. ONE CCW CHAIN*/
*/*IS USE FOR ALL THREE TYPES OF I-O PERFORMED. IN ALL CASES, THE   */
*/*FIRST CCW  IS A SEARCH FOR A PARTICULAR MBBCCHHR ACTUAL PHYSICAL */
*/*LOCATION OF A RECORD ON LOGREC ACCROSS THE ENTIRE EXTENT ALLO-   */
*/*CATED TO LOGREC. THE NEXT CCW IS A TIC WHICH LOOPS BACK TO THE   */
*/*SEARCH IF THE SEARCH FOR A PARTICULAR RECORD WAS UNSUCCESSFUL    */
*/*THE TYPES OF OPERATIONS WHICH ARE PERFORMED ARE:          @G51DGBB*/
*/* 1. CC= 6, READ LOGREC HEADER BY GIVING MBBCCHHR OF HEADER       */
*/* 2. CC= 5, WRITE HEADER OF SAME LENGTH BACK TO EXACT LOCATION    */
*/*           SPECIFIED IN GIVEN MBBCCHHR.                   @G51DGBB*/
*/* 3. CC= 158, READ THE NEXT ERROR RECORD AFTER THE RECORD WHOSE   */
*/*             MBBCCHHR IS GIVEN IN THE SEARCH              @G51DGBB*/
*/* R7 = ADDRESS OF AREA IN CORE TO PLACE THE RECORD READ    @G51DGBB*/
*RESPECIFY (R7,R5,R12) RESTRICTED;                         /*@G51DGBB*/
*EXCPLOOP: PROC;                                           /*@G51DGBB*/
EXCPLOOP STM   @14,@12,@SA00002                                    0177
*CKDAREA = R7; /*SET UP CCW3 CORE ADDRESS TO READ RECORD TO  @G51DGBB*/
         STCM  R7,7,CKDAREA                                        0178
*AREAADR = ADDR(HDRCC); /*SEARCH ID FOR FIRST CCW            @G51DGBB*/
         LA    @14,HDRCC                                           0179
         STCM  @14,7,AREAADR                                       0179
*IF SBT4 = ON THEN     /*IF HEADER I/O HAS BEEN REQUESTED    @G51DGBB*/
         TM    SBT4,B'00010000'                                    0180
         BNO   @RF00180                                            0180
*  DO;                                                     /*@G51DGBB*/
*    CKDCOUNT = 40;   /*3RD CCW NUMBER OF BYTES IN HEADER TO BE READ*/
         MVC   CKDCOUNT(2),@CH00471                                0182
*    IF SBT2 = ON THEN /*IF HEADER IS TO BE WRITTEN THEN     @G51DGBB*/
         TM    SBT2,B'01000000'                                    0183
         BNO   @RF00183                                            0183
*      CKDCOM = '05'X; /*SET 3RD CCW CHANNEL COMMAND TO WRITE IN PLACE*
         MVI   CKDCOM,X'05'                                        0184
*    ELSE              /*IF HEADER IS TO BE READ             @G51DGBB*/
*      CKDCOM = '06'X; /*SET 3RD CCW CHANNEL COMMAND TO READ SAME */
         B     @RC00183                                            0185
@RF00183 MVI   CKDCOM,X'06'                                        0185
*                      /*RECORD AS SEARCH ID EQUAL HAS FOUND @G51DGBB*/
*    HDRM = '00'X;                                         /*@G51DGBB*/
@RC00183 MVI   HDRM,X'00'                                          0186
*    HDRR = '01'X;    /*HEADER RECORD IS RECORD 1            @G51DGBB*/
         MVI   HDRR,X'01'                                          0187
*    GEN(LA R12,LOGREC); /*SET LOGREC DCB DSECT BASE ADDRESS @G51DGBB*/
         LA R12,LOGREC
*    GEN(L  R5,DCBDEBAD); /*LOAD ADDRESS OF DEB FROM DCB FOR LOGREC*/
         L  R5,DCBDEBAD
*    GEN(MVC HDRBB(L6),L36(R5)); /*GET BBCCHH OF BEGINNING OF LOGREC*/
         MVC HDRBB(L6),L36(R5)
*      /*FROM FIRST EXTENT DIRECT ACCESS EXTENSION TO THE DEB*/    0191
*    SEEKSAVE = HDRSEEK; /*SAVE FOR USE WHEN READING FRAMES  @G51DGBB*/
         MVC   SEEKSAVE(8),HDRSEEK                                 0191
*    SKSAVREC = '02'X; /*INDICATE TIME STAMP AS RECORD BEFORE 1ST FRM*/
         MVI   SKSAVREC,X'02'                                      0192
*  END;                                                    /*@G51DGBB*/
*ELSE  /*IF NORMAL, NON HEADER, READ OF LOGREC               @G51DGBB*/
*  DO;                                                     /*@G51DGBB*/
         B     @RC00180                                            0194
@RF00180 DS    0H                                                  0195
*    HDRSEEK = PREVSEEK; /*SET ADDRESS TO SEEK FROM COUNT FIELD OF */
         MVC   HDRSEEK(8),PREVSEEK                                 0195
*                        /*PREVIOUS RECORD                   @G51DGBB*/
*    CKDCOM = '9E'X;  /*SET THIRD CCW CHANNEL COMMAND TO SEEK NEXT */
         MVI   CKDCOM,X'9E'                                        0196
*                     /*RECORD AFTER RECORD WHOSE SEEK ID EQUAL IS */
*                     /*FOUND AS RESULT OF CCW1. DONE FOR SPEED*/  0197
*    CKDCOUNT = 1944; /*SET NUMBER OF BYTES TO READ. INCORRECT LENGTH*/
         MVC   CKDCOUNT(2),@CH00925                                0197
*                     /*ERRORS ARE SUPPRESSED                @G51DGBB*/
*  END;                                                    /*@G51DGBB*/
*XIOBSEEK = HDRSEEK; /*SET IOB SEEK ADDRESS                  @G51DGBB*/
@RC00180 MVC   XIOBSEEK(8),HDRSEEK                                 0199
*XWRECB = 0;         /*ZERO THE EVENT CONTROL BLOCK          @G51DGBB*/
         SLR   @14,@14                                             0200
         ST    @14,XWRECB                                          0200
*DO UNTIL POST ^= '44'X; /*LOOP UNTIL IO REQUEST NOT INTERCEPTED*/ 0201
@DL00201 DS    0H                                                  0202
*  GEN(EXCP XIOB); /*ISSUE SVC 0                             @G51DGBB*/
         EXCP XIOB
*  GEN(WAIT ECB=XWRECB); /*WAIT FOR COMPLETION OF IO         @G51DGBB*/
         WAIT ECB=XWRECB
*END;                                                      /*@G51DGBB*/
@DE00201 CLI   POST,X'44'                                          0204
         BE    @DL00201                                            0204
*RESPECIFY (R7,R5,R12) UNRESTRICTED;                       /*@G51DGBB*/
*END;                                                      /*@G51DGBB*/
@EL00002 DS    0H                                                  0206
@EF00002 DS    0H                                                  0206
@ER00002 LM    @14,@12,@SA00002                                    0206
         BR    @14                                                 0206
*READSER: PROC OPTIONS (DONTSAVE(7)); /*READ SYS1.LOGREC SEQUENTIALLY*/
READSER  STM   @14,@06,@SA00003                                    0207
         STM   @08,@12,@SA00003+36                                 0207
*  /*PROC HAS BEEN REWRITTEN TO HANDLE READING OF FRAMES AT END OF   */
*  /*OF FILE FOR ERROR RECORDS, IF FRAMES EXIST. THE PROC IS NOW     */
*  /*STRUCTURED.                                             @G51DGBB*/
*RESPECIFY (R7) RESTRICTED;                                /*@G51DGBB*/
*RSEQCNT = RSEQCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS      @G51DGBB*/
         LA    @14,1                                               0209
         AL    @14,RSEQCNT                                         0209
         ST    @14,RSEQCNT                                         0209
*IF SERLO = YES THEN    /*IF SYS1.LOGREC IS OPEN THEN        @G51DGBB*/
         TM    SERLO,B'10000000'                                   0210
         BNO   @RF00210                                            0210
*  DO;                                                     /*@G51DGBB*/
*    IF READFR = OFF THEN /*IF READING ERROR RECORDS         @G51DGBB*/
         TM    READFR,B'10000000'                                  0212
         BNZ   @RF00212                                            0212
*      DO;                                                 /*@G51DGBB*/
*        IF PREVSEEK(2:8) = HDRREC2 THEN /*IF CURRENT SEEK ADDRESS IS*/
         CLC   PREVSEEK+1(7),HDRREC2                               0214
         BNE   @RF00214                                            0214
*         /*EQUAL TO LAST ACTIVE RECORD SEEK ADDRESS, IMPLICATION IS */
*         /*THAT THIS LAST RECORD HAS ALREADY BEEN READ      @G51DGBB*/
*          DO;                                             /*@G51DGBB*/
*            IF TWOTRY = NO & /*SECOND TRY FOR EOF ON SEQUENTIAL INPT*/
*               LASTLOOP = NO THEN /*NOT AN END OF FILE SAVING OF    */
         TM    TWOTRY,B'01000000'                                  0216
         BNZ   @RF00216                                            0216
         TM    LASTLOOP,B'00000100'                                0216
         BNZ   @RF00216                                            0216
*                                  /*RECORDS DURING ZERO ALL PROCESS*/
*              DO;                                         /*@G51DGBB*/
*                TWOTRY = YES; /*SET SECOND SEQUENTIAL READ TRY FLAG*/
         OI    TWOTRY,B'01000000'                                  0218
*                CALL CHECKHDR; /*ANY RECORDS WRITTEN WHILE READING?*/
         BAL   @14,CHECKHDR                                        0219
*                IF BADNEWS = FOUR &    /*IF NO NEW RECORDS WRITTEN*/
*                   FRAMES  = YES THEN  /*AND FRAMES EXIST ON LOGREC*/
         CLC   BADNEWS(4),@CF00065                                 0220
         BNE   @RF00220                                            0220
         TM    FRAMES,B'00100000'                                  0220
         BNO   @RF00220                                            0220
*                  DO;                                     /*@G51DGBB*/
*                    BADNEWS = ZERO; /*INDICATE NO END OF FILE YET*/
         SLR   @14,@14                                             0222
         ST    @14,BADNEWS                                         0222
*                    READFR = YES; /*SET READ FRAME SWITCH   @G51DGBB*/
         OI    READFR,B'10000000'                                  0223
*                    IF DEBUG15 = ON THEN /*IF DEBUG 15 MONITORING*/
         L     @14,SAVER2                                          0224
         TM    DEBUG15(@14),B'00000001'                            0224
         BNO   @RF00224                                            0224
*                      DO;                                 /*@G51DGBB*/
*                        MSGNO = 70; /*START OF FRAME READ MONITOR*/
         MVC   MSGNO(4),@CF00932                                   0226
*                        CALL ERRMSG; /*PRINT MESSAGE TO TOURIST*/ 0227
         BAL   @14,ERRMSG                                          0227
*                      END;                                /*@G51DGBB*/
*                    PREVSEEK = SEEKSAVE; /*GET TIME STAMP LOCATION*/
@RF00224 MVC   PREVSEEK(8),SEEKSAVE                                0229
*                  END;                                    /*@G51DGBB*/
*              END;                                        /*@G51DGBB*/
*            ELSE  /*EITHER SECOND END OF FILE OR ZEROALL PROCESSING*/
*              DO;                                         /*@G51DGBB*/
         B     @RC00216                                            0232
@RF00216 DS    0H                                                  0233
*                IF FRAMES = YES &    /*DO FRAMES EXIST ON SERLOG*/
*                   LASTLOOP = NO THEN /*NOT ZEROALL PROCESSING  */
         TM    FRAMES,B'00100000'                                  0233
         BNO   @RF00233                                            0233
         TM    LASTLOOP,B'00000100'                                0233
         BNZ   @RF00233                                            0233
*                  DO;                                     /*@G51DGBB*/
*                    READFR = YES; /*SET READING FRAMES SWITCH*/   0235
         OI    READFR,B'10000000'                                  0235
*                    IF DEBUG15 = ON THEN /*IF DEBUG15 MONITORING*/
         L     @14,SAVER2                                          0236
         TM    DEBUG15(@14),B'00000001'                            0236
         BNO   @RF00236                                            0236
*                      DO;                                 /*@G51DGBB*/
*                        MSGNO = 70; /*START OF FRAME READ MESSAGE*/
         MVC   MSGNO(4),@CF00932                                   0238
*                        CALL ERRMSG; /*WRITE MESSAGE TO TOURIST*/ 0239
         BAL   @14,ERRMSG                                          0239
*                      END;                                /*@G51DGBB*/
*                    PREVSEEK = SEEKSAVE; /*GET STARTING LOCATION*/
@RF00236 MVC   PREVSEEK(8),SEEKSAVE                                0241
*                    /*OF LOGREC FROM DEB. IMPLICATION IS THAT   */
*                    /*1ST FRAME MUST BE ON SAME TRACK AS HEADER */
*                   END;                                   /*@G51DGBB*/
*                 ELSE  /*LEGITIMATE END OF FILE             @G51DGBB*/
*                   BADNEWS = FOUR; /*INDICATE EOF TO WORLD  @G51DGBB*/
         B     @RC00233                                            0243
@RF00233 MVC   BADNEWS(4),@CF00065                                 0243
*               END;                                       /*@G51DGBB*/
*           END;                                           /*@G51DGBB*/
*      END;                                                /*@G51DGBB*/
*    ELSE  /*FRAMES ARE BEING READ                           @G51DGBB*/
*      DO;                                                 /*@G51DGBB*/
         B     @RC00212                                            0247
@RF00212 DS    0H                                                  0248
*        IF PREVSEEK(2:8) = HDRREC1 THEN /*IF SEEK ADDRESS FOR */  0248
         CLC   PREVSEEK+1(7),HDRREC1                               0248
         BNE   @RF00248                                            0248
*          /*PREVIOUS RECORD IS EQUAL TO SEEK ADDRESS OF LAST FRAME*/
*          /*THEN END OF FILE ON LOGREC HAS BEEN REACHED     @G51DGBB*/
*          BADNEWS = FOUR; /*INDICATE END OF FILE            @G51DGBB*/
         MVC   BADNEWS(4),@CF00065                                 0249
*        ELSE  /*NOT LAST FRAME                              @G51DGBB*/
*          RFRCOUNT = RFRCOUNT + 1; /*COUNT FRAMES FOR DEBUG16 TOTAL*/
         B     @RC00248                                            0250
@RF00248 LA    @14,1                                               0250
         AL    @14,RFRCOUNT                                        0250
         ST    @14,RFRCOUNT                                        0250
*      END;                                                /*@G51DGBB*/
@RC00248 DS    0H                                                  0252
*    IF BADNEWS = ZERO THEN /*IF NO EOF OR ERROR CONDITIONS THEN*/ 0252
@RC00212 L     @14,BADNEWS                                         0252
         LTR   @14,@14                                             0252
         BNZ   @RF00252                                            0252
*      DO;                                                 /*@G51DGBB*/
*        R7 = ADDR(BUF1); /*ADDRESS READ BUFFER              @G51DGBB*/
         LA    R7,BUF1                                             0254
*        CALL EXCPLOOP; /*ISSUE EXCP READ                    @G51DGBB*/
         BAL   @14,EXCPLOOP                                        0255
*        IF POST ^= '7F'X THEN /*IF UNSUCCESSFULL READ       @G51DGBB*/
         CLI   POST,X'7F'                                          0256
         BE    @RF00256                                            0256
*          DO;                                             /*@G51DGBB*/
*            IF POST = '42'X THEN /*OUT OF LOGREC EXTENT ERROR*/   0258
         CLI   POST,X'42'                                          0258
         BNE   @RF00258                                            0258
*              MSGNO = 14;                                 /*@G51DGBB*/
         MVC   MSGNO(4),@CF00768                                   0259
*            ELSE   /* HARD I-O ERROR                        @G51DGBB*/
*              MSGNO = 39;                                 /*@G51DGBB*/
         B     @RC00258                                            0260
@RF00258 MVC   MSGNO(4),@CF00933                                   0260
*            CALL ERRMSG;                                  /*@G51DGBB*/
@RC00258 BAL   @14,ERRMSG                                          0261
*            BADNEWS = TWELVE;                             /*@G51DGBB*/
         MVC   BADNEWS(4),@CF00068                                 0262
*          END;                                            /*@G51DGBB*/
*        ELSE /*SUCCESSFUL READ                              @G51DGBB*/
*          DO;                                             /*@G51DGBB*/
         B     @RC00256                                            0264
@RF00256 DS    0H                                                  0265
*            PREVCC(1:5) = BCOUNT; /*DIRECT ACCESS ADDRESS,CCHHR,*/
         MVC   PREVCC(5),BCOUNT                                    0265
*           /*OF RECORD LAST READ FROM COUNT RECORD PRECEEDING DATA*/
*           /*RECORD ON COUNT,DATA FORMATTED DIRECT ACCESS FILE*/  0266
*            FLIPFLOP = NO; /*INDICATE SEQUENTIAL INPUT FROM LOGREC,*/
         NI    FLIPFLOP,B'11011111'                                0266
*                           /* AND NOT FROM HISTORY INPUT    @G51DGBB*/
*            RECCCHHR = BCOUNT; /*PASS SAME VALUE TO USER VIA PARM*/
         L     @14,SAVER2                                          0267
         MVC   RECCCHHR(5,@14),BCOUNT                              0267
*            RECLNGTH = BSIZE; /*PASS RECORD LENGTH FROM COUNT RECRD*/
         LH    @12,BSIZE                                           0268
         N     @12,@CF01180                                        0268
         STH   @12,RECLNGTH(,@14)                                  0268
*            SAVELENT = BSIZE + 4; /*SAVE RECORD QSAM LENGTH FOR */
         LA    @12,4(,@12)                                         0269
         STH   @12,SAVELENT                                        0269
*                                  /*RITESCRT,RITEHIST       @G51DGBB*/
*            R7 = ADDR(BDATA); /*BKEY IS DATA PORTION OF RECORD SINCE*/
         LA    R7,BDATA                                            0270
*            TIMEBASE = R7; /*TELL TIME CONVERSION WHERE RECORD IS*/
         ST    R7,TIMEBASE                                         0271
*            CALL CONVTIME; /*CONVERT TIME, IF NECESSARY     @G51DGBB*/
         BAL   @14,CONVTIME                                        0272
*          END;                                            /*@G51DGBB*/
*      END;                                                /*@G51DGBB*/
*  END;                                                    /*@G51DGBB*/
*ELSE /*IF LOGREC HAS NOT BEEN OPENED                        @G51DGBB*/
*  DO;                                                     /*@G51DGBB*/
         B     @RC00210                                            0276
@RF00210 DS    0H                                                  0277
*    MSGNO = 47;                                           /*@G51DGBB*/
         MVC   MSGNO(4),@CF00935                                   0277
*    CALL ERRMSG;                                          /*@G51DGBB*/
         BAL   @14,ERRMSG                                          0278
*    BADNEWS = TWELVE;                                     /*@G51DGBB*/
         MVC   BADNEWS(4),@CF00068                                 0279
*  END;                                                    /*@G51DGBB*/
*END; /*END OF PROC READSER                                  @G51DGBB*/
@EL00003 DS    0H                                                  0281
@EF00003 DS    0H                                                  0281
@ER00003 LM    @14,@06,@SA00003                                    0281
         LM    @08,@12,@SA00003+36                                 0281
         BR    @14                                                 0281
*DIRRDSER: PROC OPTIONS(DONTSAVE(R7)); /*READ SERLOG DIRECTLY*/    0282
DIRRDSER STM   @14,@06,@SA00004                                    0282
         STM   @08,@12,@SA00004+36                                 0282
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/
*IF SERLO = YES THEN /*DO ONLY IF SERLOG IS OPEN             @Z427VLS*/
         TM    SERLO,B'10000000'                                   0284
         BNO   @RF00284                                            0284
*  DO;                                                     /*@Z427VLS*/
*    RSERDCNT = RSERDCNT + 1; /*COUNT NUMBER OF READ ATTEMPTS*/    0286
         LA    @14,1                                               0286
         AL    @14,RSERDCNT                                        0286
         ST    @14,RSERDCNT                                        0286
*    PREVCC(1:5) = RECCCHHR;                               /*@Z427VLS*/
         L     @14,SAVER2                                          0287
         MVC   PREVCC(5),RECCCHHR(@14)                             0287
*    R7 = ADDR(BUF1);                                      /*@Z427VLS*/
         LA    R7,BUF1                                             0288
*    PREVR = PREVR - 1;                                    /*@Z427VLS*/
         SLR   @14,@14                                             0289
         IC    @14,PREVR                                           0289
         BCTR  @14,0                                               0289
         STC   @14,PREVR                                           0289
*    CALL EXCPLOOP;                                        /*@Z427VLS*/
         BAL   @14,EXCPLOOP                                        0290
*    IF POST ^= '7F'X THEN                                         0291
         CLI   POST,X'7F'                                          0291
         BE    @RF00291                                            0291
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 25;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00940                                   0293
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0294
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0295
*        RETURN;                                           /*@Z427VLS*/
@EL00004 DS    0H                                                  0296
@EF00004 DS    0H                                                  0296
@ER00004 LM    @14,@06,@SA00004                                    0296
         LM    @08,@12,@SA00004+36                                 0296
         BR    @14                                                 0296
*      END;                                                /*@Z427VLS*/
*     PREVCC(1:5) = BCOUNT;                                /*@Z427VLS*/
@RF00291 MVC   PREVCC(5),BCOUNT                                    0298
*     RECLNGTH = BSZ;                                      /*@Z427VLS*/
         LH    @14,BSZ                                             0299
         L     @12,SAVER2                                          0299
         STH   @14,RECLNGTH(,@12)                                  0299
*     R7 = ADDR(BDATA);                                    /*@G51DGBB*/
         LA    R7,BDATA                                            0300
*     TIMEBASE = R7;                                       /*@Z427VLS*/
         ST    R7,TIMEBASE                                         0301
*     CALL CONVTIME;                                       /*@Z427VLS*/
         BAL   @14,CONVTIME                                        0302
*  END;                                                    /*@Z427VLS*/
*ELSE /*SERLOG NOT OPEN                                      @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00284                                            0304
@RF00284 DS    0H                                                  0305
*    MSGNO = 47;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00935                                   0305
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0306
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0307
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
*END; /*CLOSING END TO DIRRDSER PROC                         @Z427VLS*/
         B     @EL00004                                            0310
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      RESET HEADER TO INDICATE AN EMPTY DATA SET          @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*RESETHDR: PROC;                                           /*@Z427VLS*/
RESETHDR STM   @14,@12,@SA00005                                    0311
*RESPECIFY (R7,R6) RESTRICTED;                             /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0313
         L     @14,SAVER2                                          0313
         TM    DEBUG15(@14),B'00000001'                            0313
         BNO   @RF00313                                            0313
*          DO; /*PRINT TO TOURIST ATTEMPT TO RESET HEADER    @Z427VLS*/
*            MSGNO = 55;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00945                                   0315
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0316
*          END;                                            /*@Z427VLS*/
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */
@RF00313 LA    R7,HEADER                                           0318
*        SBT2='1'B;                     /* SET HEADER & WRITE        */
*        SBT4='1'B;                     /* SWITCHES ON       @Z427VLS*/
         OI    SBT2,B'01010000'                                    0320
*        HDRREC2=HDRREC1;               /* RESET LAST REC WRITTEN    */
         MVC   HDRREC2(7),HDRREC1                                  0321
*        R6=HDRTYPE;                    /* PICK UP DEV TYPE  @Z427VLS*/
         SLR   R6,R6                                               0322
         IC    R6,HDRTYPE                                          0322
*        GEN(SLL   R6,L1);              /* MULTIPLY BY 2     @Z427VLS*/
         SLL   R6,L1
*        GEN(LA    R6,BYTESREM(R6));    /* INDEX INTO TABLE  @Z427VLS*/
         LA    R6,BYTESREM(R6)
*        GEN(MVC   HDRREM(L2),L0(R6));  /* MOVE BYTES REM TO FLD     */
         MVC   HDRREM(L2),L0(R6)
*       IF FRAMES = YES THEN /*IF FRAMES TO BE SAVED FOR MERIDIAN*/
         TM    FRAMES,B'00100000'                                  0326
         BNO   @RF00326                                            0326
*         HDRREM = 20; /*DONT LET RECORDS ON LAST FRAME TRACK*/    0327
         MVC   HDRREM(2),@CH00671                                  0327
*        HDRWNGBT='0'B;                 /* TURN OFF EARLY WARN SWITCH*/
@RF00326 NI    HDRWNGBT,B'01111111'                                0328
*        HDRCOUNT = '00'X;             /* RESET THE MSG FIELD */   0329
         MVI   HDRCOUNT,X'00'                                      0329
*        CALL EXCPLOOP;                                    /*@Z427VLS*/
         BAL   @14,EXCPLOOP                                        0330
*        IF POST^='7F'X THEN            /* TEST FOR NORMAL   @Z427VLS*/
         CLI   POST,X'7F'                                          0331
         BE    @RF00331                                            0331
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 48;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00946                                   0333
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0334
*            BADNEWS = TWELVE;                             /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0335
*            R2 = SAVER2;    /*INSURE COMTBL ADDR. BY R2     @ZA31549*/
         L     @14,SAVER2                                          0336
         LR    R2,@14                                              0336
*            CALL IFCMSG(201,ADDR(PRNTBF));                /*@Z427VLS*/
         LA    @12,PRNTBF                                          0337
         ST    @12,@AFTEMPS                                        0337
         L     @15,ADIFCMSG(,@14)                                  0337
         LA    @01,@AL00337                                        0337
         BALR  @14,@15                                             0337
*            RETURN;                                       /*@Z427VLS*/
@EL00005 DS    0H                                                  0338
@EF00005 DS    0H                                                  0338
@ER00005 LM    @14,@12,@SA00005                                    0338
         BR    @14                                                 0338
*          END;                                            /*@Z427VLS*/
*RESPECIFY (R7,R6)  UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC RESETHDR                         @Z427VLS*/
         B     @EL00005                                            0341
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      OPEN  SYS1.LOGREC                                   @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*OPENSERL: PROC;                                           /*@Z427VLS*/
OPENSERL STM   @14,@12,@SA00006                                    0342
*RESPECIFY(R1,R0,R7,R12) RESTRICTED;                       /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0344
         L     @14,SAVER2                                          0344
         TM    DEBUG15(@14),B'00000001'                            0344
         BNO   @RF00344                                            0344
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 53;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00952                                   0346
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0347
*  END;                                                    /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
@RF00344 DS    0H                                                  0349
         LA    R1,LOGREC
         ST    R1,XIOBDCB
*IF SERLO = YES THEN /*IF SERLOG ALREADY OPEN THEN           @Z427VLS*/
         TM    SERLO,B'10000000'                                   0350
         BNO   @RF00350                                            0350
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 41;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00953                                   0352
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0353
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0354
*    RETURN;                                               /*@Z427VLS*/
@EL00006 DS    0H                                                  0355
@EF00006 DS    0H                                                  0355
@ER00006 LM    @14,@12,@SA00006                                    0355
         BR    @14                                                 0355
*  END;                                                    /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/*      BLOCK  GENERATE TO INTERFACE WITH SYSTEM MACROS & CONTROL   */
*/*                                                          @Z427VLS*/
*ZEROA = (ZEROA && ZEROA); /*CLEAR FIELD                     @Z427VLS*/
@RF00350 XC    ZEROA(24),ZEROA                                     0357
*IF NOSDR = NO THEN /*IF USER WANTS SDR COUNTERS DUMPED      @Z427VLS*/
         L     @14,SAVER2                                          0358
         TM    NOSDR(@14),B'00000001'                              0358
         BNZ   @RF00358                                            0358
*DO;                                                       /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
         LA    R0,4                     CODE TO DUMP SDR'S
         SVC   76                       ISSUE SVC TO DUMP SDR'S
*END;                                                      /*@Z427VLS*/
*GENERATE;                                                 /*@Z427VLS*/
@RF00358 DS    0H                                                  0362
         ENQ   (RESID,LOGRECA,E,11,STEP) ENQ TO PREVENT OTHER ACCESS
         OPEN  (LOGREC,(OUTPUT))         FROM ANOTHER IFCEREP0 TASK
         LA    R12,LOGREC               PICK UP ADDR FOR DSECT BASE
         TM    DCBOFLGS,OPENOK          DID OPEN GO OK
         BZ    BADOPENA                 BR-NO BAD OPEN
*        SERLO = YES;                   /* TURN ON OPEN DISK IND     */
         OI    SERLO,B'10000000'                                   0363
*        SBT4='1'B;                     /* TURN ON HDR READ SW       */
         OI    SBT4,B'00010000'                                    0364
*        R7=ADDR(HEADER);               /* POINT TO HEADER AREA      */
         LA    R7,HEADER                                           0365
*        CALL EXCPLOOP;                 /* GO DO I/O TO READ HDR     */
         BAL   @14,EXCPLOOP                                        0366
*        SBT4='0'B;                     /* TURN OFF HDR READ SW      */
         NI    SBT4,B'11101111'                                    0367
*        IF POST^='7F'X                 /* TEST FOR NORMAL   @Z427VLS*/
*              THEN                     /* RETURN FROM I/O   @Z427VLS*/
         CLI   POST,X'7F'                                          0368
         BNE   @RT00368                                            0368
*                   GOTO HDRERR0;       /* IF NOT GOTO ERROR EXIT    */
*        IF HDRSAFE^='FF'X              /* TEST FOR SAFETY BYTE      */
*              THEN                     /* IN HEADER RECORD  @Z427VLS*/
         CLI   HDRSAFE,X'FF'                                       0370
         BNE   @RT00370                                            0370
*                   GOTO HDRERR1;       /* IF NOT TAKE ERROR EXIT    */
*        GENERATE;                                         /*@Z427VLS*/
         MVC   DCBFDAD+L3(L4),HDRECC    SET DCB HIGH EXTENT FIELD
         XC    DCBTRBAL(L2),DCBTRBAL    ZERO THE TRACK BALANCE FIELD
L3       EQU   3
*PREVSEEK(2:8) = HDRREC1; /*SET START SEEK AT LAST FRAME LOCATION*/
         MVC   PREVSEEK+1(7),HDRREC1                               0373
*PREVM = '00'X; /*INDICATE DATA SET OPEN                     @G51DGBB*/
         MVI   PREVM,X'00'                                         0374
*        RETURN;                        /* TAKE NORMAL EXIT  @Z427VLS*/
         B     @EL00006                                            0375
*HDRERR0:     ;                                            /*@Z427VLS*/
HDRERR0  DS    0H                                                  0377
*        IF POST='42'X                  /* TEST FOR OUT OF EXTENT    */
*              THEN                     /* IF YES            @Z427VLS*/
         CLI   POST,X'42'                                          0377
         BNE   @RF00377                                            0377
*                MSGNO = 14;                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF00768                                   0378
*              ELSE                                                0379
*                MSGNO = 15;                               /*@Z427VLS*/
         B     @RC00377                                            0379
@RF00377 MVC   MSGNO(4),@CF00036                                   0379
*         CALL ERRMSG;                                     /*@Z427VLS*/
@RC00377 BAL   @14,ERRMSG                                          0380
*         BADNEWS = TWELVE;                                /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0381
*         RETURN;                                          /*@Z427VLS*/
         B     @EL00006                                            0382
*HDRERR1:     ;                                            /*@Z427VLS*/
HDRERR1  DS    0H                                                  0384
*      MSGNO = 16;                                         /*@Z427VLS*/
         MVC   MSGNO(4),@CF00089                                   0384
*      CALL ERRMSG;                                        /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0385
*      BADNEWS = TWELVE;                                   /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0386
*RESPECIFY (R1,R0,R7,R12) UNRESTRICTED;                    /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENSERL, OPEN SERLOG DATA SET   @Z427VLS*/
         B     @EL00006                                            0388
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CHECK HEADER FOR MORE RECORDS WRITTEN WHILE PROCESSING      */
*/*                                                          @Z427VLS*/
*/********************************************************************/
*CHECKHDR: PROC;                                           /*@Z427VLS*/
CHECKHDR STM   @14,@12,@SA00007                                    0389
*RESPECIFY(R1,R4,R7) RESTRICTED;                           /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0391
         L     @14,SAVER2                                          0391
         TM    DEBUG15(@14),B'00000001'                            0391
         BNO   @RF00391                                            0391
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 54;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00961                                   0393
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0394
*          END;                                            /*@Z427VLS*/
*        IF SERLO = NO THEN             /* TEST FOR DISK OPEN        */
@RF00391 TM    SERLO,B'10000000'                                   0396
         BNZ   @RF00396                                            0396
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 49;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF00962                                   0398
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0399
*            BADNEWS = TWELVE;                             /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0400
*            RETURN;                                       /*@Z427VLS*/
@EL00007 DS    0H                                                  0401
@EF00007 DS    0H                                                  0401
@ER00007 LM    @14,@12,@SA00007                                    0401
         BR    @14                                                 0401
*          END;                                            /*@Z427VLS*/
*        GEN(GETMAIN R,LV=40);          /* GET STORAGE TO HOLD HEADER*/
@RF00396 DS    0H                                                  0403
         GETMAIN R,LV=40
*        R4=R1;                         /* SET BASE FOR OLD HEADER   */
         LR    R4,R1                                               0404
*        OHEADER=HEADER;                /* MOVE HEADER TO GOTTEN CORE*/
         MVC   OHEADER(40,R4),HEADER                               0405
*        R7=ADDR(HEADER);               /* POINT TO BUFF FOR READ    */
         LA    R7,HEADER                                           0406
*        SBT4='1'B;                     /* TURN ON READ HEADER       */
         OI    SBT4,B'00010000'                                    0407
*        IF LASTLOOP = YES THEN /*DONT ENQUEUE EXCEPT FOR ZEROALL PRO*/
         TM    LASTLOOP,B'00000100'                                0408
         BNO   @RF00408                                            0408
*        DO; /*CESSING. MAYBE EXTRA RECORD WRITTEN AT EOF FOR READSEQ*/
*        SBT7='1'B;                     /* TURN ON INTERNAL ENQ SW   */
         OI    SBT7,B'00001000'                                    0410
*        GEN(ENQ  (RESIDII,LOGRECB,E,8,SYSTEM));           /*@Z427VLS*/
         ENQ  (RESIDII,LOGRECB,E,8,SYSTEM)
*        END;                                              /*@Z427VLS*/
*        CALL EXCPLOOP;                 /* GO DO I/O READ HEADER     */
@RF00408 BAL   @14,EXCPLOOP                                        0413
*CHK01  :     ;                                            /*@Z427VLS*/
CHK01    DS    0H                                                  0415
*        IF POST^='7F'X                 /* TEST POST CODE FOR NORMAL */
*              THEN                     /* RETURN IF NOT     @Z427VLS*/
         CLI   POST,X'7F'                                          0415
         BNE   @RT00415                                            0415
*                   GOTO CHK03;         /* TAKE ERROR EXIT   @Z427VLS*/
*        IF HDRSAFE^='FF'X              /* TEST HDR REC JUST READ FOR*/
*              THEN                     /* SAFETY BYTE       @Z427VLS*/
         CLI   HDRSAFE,X'FF'                                       0417
         BNE   @RT00417                                            0417
*                   GOTO CHK04;         /* IF NOT FF TAKE ERR EXIT   */
*        IF HDRREC2=OHDRREC2            /* TEST LAST REC WRITTEN FLDS*/
*              THEN                     /* IF THEY MATCH     @Z427VLS*/
         CLC   HDRREC2(7),OHDRREC2(R4)                             0419
         BNE   @RF00419                                            0419
*                   DO;                 /* THEN              @Z427VLS*/
*                        BADNEWS = FOUR; /*INDICATE REAL END OF FILE */
         MVC   BADNEWS(4),@CF00065                                 0421
*                        GOTO CHK02;    /* GO ON             @Z427VLS*/
         B     CHK02                                               0422
*                   END;                                   /*@Z427VLS*/
*        PREVSEEK(2:8)=OHDRREC2  ;                          /*YM01498*/
@RF00419 MVC   PREVSEEK+1(7),OHDRREC2(R4)                          0424
*CHK02  :     ;                                            /*@Z427VLS*/
CHK02    DS    0H                                                  0426
*        SBT4='0'B;                     /* TURN OF HEADER SW @Z427VLS*/
         NI    SBT4,B'11101111'                                    0426
*        R1=R4;                         /* SET R1 FOR FREE MAIN      */
         LR    R1,R4                                               0427
*        GEN(FREEMAIN R,LV=40,A=(1));   /* FREE MAIN OF GOTTEN CORE  */
         FREEMAIN R,LV=40,A=(1)
*          RETURN; /*GO BACK TO CALLER                       @Z427VLS*/
         B     @EL00007                                            0429
*CHK03  :     ;                                            /*@Z427VLS*/
CHK03    DS    0H                                                  0431
*        IF POST = '42'X THEN /*42 MEANS OUT OF EXTENT       @Z427VLS*/
         CLI   POST,X'42'                                          0431
         BNE   @RF00431                                            0431
*          MSGNO = 14;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF00768                                   0432
*        ELSE                                                      0433
*          MSGNO = 15;   /*NOT 42 MEANS IO ERROR             @Z427VLS*/
         B     @RC00431                                            0433
@RF00431 MVC   MSGNO(4),@CF00036                                   0433
*        CALL ERRMSG;                                      /*@Z427VLS*/
@RC00431 BAL   @14,ERRMSG                                          0434
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0435
*        GOTO  CHK02;     /*GO BACK TO FREE EXCESS CORE      @Z427VLS*/
         B     CHK02                                               0436
*CHK04  :     ;                                            /*@Z427VLS*/
CHK04    DS    0H                                                  0438
*        MSGNO = 16; /*HEADER CHECK BYTE BAD                 @Z427VLS*/
         MVC   MSGNO(4),@CF00089                                   0438
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0439
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0440
*        GOTO CHK02;                     /*GO BACK TO DEQ    @Z427VLS*/
         B     CHK02                                               0441
*RESPECIFY(R1,R4,R7) UNRESTRICTED;                         /*@Z427VLS*/
*END; /*CLOSING END TO PROC CHECK HEADER                     @Z427VLS*/
*/********************************************************************/
*/*                                                          @Z427VLS*/
*/*      CONVERT TIME ROUTINE                                @Z427VLS*/
*/*                                                          @Z427VLS*/
*/********************************************************************/
*CONVTIME: PROC;                                           /*@Z427VLS*/
CONVTIME STM   @14,@12,@SA00008                                    0444
*RESPECIFY(R3,R4,R5,R6,R7) RESTRICTED;                     /*@Z427VLS*/
*        R7SAVE = R7;  /*SAVE RECORD ADDRESS                 @Z427VLS*/
         ST    R7,R7SAVE                                           0446
*        IF LCSWITCH='1'B               /*  HAS TIME BEEN CONVERTED  */
*              THEN                     /*  OR IS IT IN PROPER FORM  */
         L     @14,TIMEBASE                                        0447
         TM    LCSWITCH(@14),B'00001000'                           0447
         BO    @RT00447                                            0447
*                   RETURN;               /*  YES EXIT TO CALLER   */
*        CONVTCT = CONVTCT + 1;         /*NUMBER OF CONVERSIONS DONE*/
         LA    @14,1                                               0449
         AL    @14,CONVTCT                                         0449
         ST    @14,CONVTCT                                         0449
*/********************************************************************/
*/*      NEW SYSTEM - TO YYDDD & HHMMSS                      @Z427VLS*/
*/********************************************************************/
*CONVNS :     ;                                            /*@Z427VLS*/
CONVNS   DS    0H                                                  0451
*        WORK8=DATETIME;                /* MOVE DATE & TIME TO WORK  */
         L     @14,TIMEBASE                                        0451
         MVC   WORK8(8),DATETIME(@14)                              0451
*        NSSWITCH='0'B;                 /* TURN OFF NS SWITCH        */
*        LCSWITCH='1'B ;                /* TURN ON LOCAL SW  @Z427VLS*/
         OI    LCSWITCH(@14),B'00001000'                           0453
         NI    NSSWITCH(@14),B'10111111'                           0453
*        IF WORK=0 &                    /* TEST FOR          @Z427VLS*/
*           WORKB=0                     /* ZERO FIELD        @Z427VLS*/
*              THEN                     /* IF YES EXIT TO CALLER     */
         SLR   @14,@14                                             0454
         C     @14,WORK                                            0454
         BNE   @RF00454                                            0454
         C     @14,WORKB                                           0454
         BNE   @RF00454                                            0454
*                DO;                                       /*@Z427VLS*/
*                  R7 = R7SAVE;                            /*@Z427VLS*/
         L     R7,R7SAVE                                           0456
*                   RETURN;                                /*@Z427VLS*/
@EL00008 DS    0H                                                  0457
@EF00008 DS    0H                                                  0457
@ER00008 LM    @14,@12,@SA00008                                    0457
         BR    @14                                                 0457
*                END;                                      /*@Z427VLS*/
*        R4=WORK ;                      /* PICK UP DATE/TIME @Z427VLS*/
@RF00454 L     R4,WORK                                             0459
*        R5=WORKB;                      /* INTO WORK REGS    @Z427VLS*/
         L     R5,WORKB                                            0460
*        GEN(SRDL  R4,L12);             /* CONVERT FROM NANO TO MICRO*/
         SRDL  R4,L12
*        GEN(D     R4,SIXTYMIL);        /* DIVIDE TO GET # OF MINUTES*/
         D     R4,SIXTYMIL
*        R6=0 ;                         /*                   @Z427VLS*/
         SLR   R6,R6                                               0463
*        R7=R4;                         /* MOVE REMAINDER TO OTHER RG*/
         LR    R7,R4                                               0464
*        GEN(D    R6,MILLION);          /* DIVIDE TO GET SECONDS     */
         D    R6,MILLION
*        GEN(CVD   R7,WORK8);           /* CONVERT # OF SECONDS      */
         CVD   R7,WORK8
*        R4=WORKB;                      /* PICK IT UP TO WORK REG    */
         L     R4,WORKB                                            0467
*        SRL(R4,FOUR);                  /* MOVE IT TO HI ORDER       */
         SRL   R4,4                                                0468
*        SECS=R4;                       /* PUT BYTE INTO RECORD      */
         L     @14,TIMEBASE                                        0469
         STC   R4,SECS(,@14)                                       0469
*        R4=0 ;                         /*                   @Z427VLS*/
         SLR   R4,R4                                               0470
*        R7=R6 ;                                            /*YM6362*/
         LR    R7,R6                                               0471
*        R6= 0 ;                                            /*YM6362*/
         SLR   R6,R6                                               0472
*        GEN( D  R6,THCONV);                                /*YM6362*/
          D  R6,THCONV
*        GEN( CVD R7,WORK8) ;                               /*YM6362*/
          CVD R7,WORK8
*        R6=WORKB ;                                         /*YM6362*/
         L     R6,WORKB                                            0475
*        SRL (R6,FOUR);                                    /*@Z427VLS*/
         SRL   R6,4                                                0476
*        TNTHS=R6 ;                                         /*YM6362*/
         L     @14,TIMEBASE                                        0477
         STC   R6,TNTHS(,@14)                                      0477
*        GEN(D     R4,SIXTY);           /* DIVIDE MIN TO GET HOURS   */
         D     R4,SIXTY
*        GEN(CVD   R4,WORK8);           /* CONVERT # MINUTES @Z427VLS*/
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP CONVERTED #       */
         L     R4,WORKB                                            0480
*        SRL (R4,FOUR);                 /* POSITION IT       @Z427VLS*/
         SRL   R4,4                                                0481
*        MINS=R4;                       /* SET IT INTO REC AS # MINS */
         L     @14,TIMEBASE                                        0482
         STC   R4,MINS(,@14)                                       0482
*        R4=0 ;                         /*                   @Z427VLS*/
         SLR   R4,R4                                               0483
*        GEN(D     R4,TWENTY4);         /* DIVIDE TO GET HOURS       */
         D     R4,TWENTY4
*        GEN(CVD   R4,WORK8);           /* CONVERT # OF HOURS        */
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/
         L     R4,WORKB                                            0486
*        SRL (R4,FOUR);                 /* POSITION IT IN REG        */
         SRL   R4,4                                                0487
*        HOURS=R4;                      /* PUT VALUE INTO RECORD     */
         L     @14,TIMEBASE                                        0488
         STC   R4,HOURS(,@14)                                      0488
*        IF GMTSW='1'B                  /* TEST FOR BASE VALUE TO BE */
*              THEN                     /* 1900 OR 1960      @Z427VLS*/
         TM    GMTSW(@14),B'10000000'                              0489
         BNO   @RF00489                                            0489
*                DO;                                       /*@Z427VLS*/
*                  R4 = 0;              /* BIT ON BASE IS 00   YM3662*/
         SLR   R4,R4                                               0491
*                  R5 = R5 + 1;         /* INCREMENT DAY COUNT YM3662
*                                          SINCE 1900 IS NOT   YM3662
*                                          A LEAP YEAR AND     YM3662
*                                          LOOP ASSUMES IT IS  YM3662*/
         AL    R5,@CF00056                                         0492
*                END;                                      /*@Z427VLS*/
*              ELSE                     /* IF BIT OFF SET BASE TO 60 */
*                   R4=60;              /*                   @Z427VLS*/
         B     @RC00489                                            0494
@RF00489 LA    R4,60                                               0494
*LEAPYEAR:    ;                         /* R5 HAS NUMBER OF DAYS     */
@RC00489 DS    0H                                                  0495
LEAPYEAR DS    0H                                                  0496
*        R5=R5-366;                     /* DECREMENT BY A LEAP YEAR  */
         LA    @14,366                                             0496
         SLR   R5,@14                                              0496
*        IF R5 < ZERO                   /* IF TOO MUCH       @Z427VLS*/
*              THEN                     /* THEN DO THE FOLLOWING     */
         LTR   R5,R5                                               0497
         BNM   @RF00497                                            0497
*                   DO;                 /*                   @Z427VLS*/
*                        R5=R5+366;     /* BUMP BACK # OF DAYS BY 366*/
         ALR   R5,@14                                              0499
*                        GOTO CONVNSDN; /* EXIT CONVERSION DONE      */
         B     CONVNSDN                                            0500
*                   END;                /*                   @Z427VLS*/
*        R4=R4+1;                       /* ADD 1 FOR YEAR    @Z427VLS*/
@RF00497 LA    @14,1                                               0502
         ALR   R4,@14                                              0502
*                                       /*                   @Z427VLS*/
*                                       /*  DO LOOP FOR REG YEARS    */
*        DO A=1 TO 3 BY 1;                                 /*@Z427VLS*/
         ST    @14,A                                               0503
@DL00503 DS    0H                                                  0504
*              R5=R5-365;               /* DECREMENT BY 365 DAYS     */
         LA    @14,365                                             0504
         SLR   R5,@14                                              0504
*              IF R5 < ZERO                  /* HAS VALUE    @Z427VLS*/
*                   THEN                /* GON NEGATIVE      @Z427VLS*/
         LTR   R5,R5                                               0505
         BNM   @RF00505                                            0505
*                        DO;            /* IF YES THEN       @Z427VLS*/
*                             R5=R5+365;     /* ADD BACK 365 DAYS    */
         ALR   R5,@14                                              0507
*                             GOTO CONVNSDN; /* & EXIT TO FINISH UP  */
         B     CONVNSDN                                            0508
*                        END;                              /*@Z427VLS*/
*              R4=R4+1;                 /* ADD 1 YEAR        @Z427VLS*/
@RF00505 AL    R4,@CF00056                                         0510
*        END ;                          /* END OF DO LOOP REPEAT 3X  */
         LA    @14,1                                               0511
         AL    @14,A                                               0511
         ST    @14,A                                               0511
         C     @14,@CF00077                                        0511
         BNH   @DL00503                                            0511
*        GOTO LEAPYEAR;                                    /*@Z427VLS*/
         B     LEAPYEAR                                            0512
*CONVNSDN:    ;                         /* R4 HAS YEAR       @Z427VLS*/
CONVNSDN DS    0H                                                  0514
*        R5=R5+1;                       /* R5 HAS DAYS ADD 1 TO YEAR */
         AL    R5,@CF00056                                         0514
*        GEN(CVD   R4,WORK8);           /* CONVERT YEARS TO DEC      */
         CVD   R4,WORK8
*        R4=WORKB;                      /* PICK UP VALUE     @Z427VLS*/
         L     R4,WORKB                                            0516
*        SRL (R4,FOUR);                 /* & POSITION IT IN A REG    */
         SRL   R4,4                                                0517
*        YEAR=R4;                       /* PUT YEAR IN RECORD        */
         L     @14,TIMEBASE                                        0518
         STC   R4,YEAR(,@14)                                       0518
*        GEN(CVD   R5,WORK8);           /* CONVERT THE NO OF DAYS    */
         CVD   R5,WORK8
*        DAYS=(WDAYS  '000F'X);        /* PUT DAYS INTO REC WTH SIGN*/
         L     @14,TIMEBASE                                        0520
         MVC   DAYS(2,@14),WDAYS                                   0520
         OC    DAYS(2,@14),@CB00983                                0520
*        DATE0='00'X;                   /* SET HI DIGITS TO ZERO     */
         MVI   DATE0(@14),X'00'                                    0521
*        R7 = R7SAVE;                                      /*@Z427VLS*/
         L     R7,R7SAVE                                           0522
*RESPECIFY (R3,R4,R5,R6,R7) UNRESTRICTED;                  /*@Z427VLS*/
* END; /*CLOSING END TO PROC CONVTIME                        @Z427VLS*/
         B     @EL00008                                            0524
*OPENIT: PROC;                                             /*@Z427VLS*/
OPENIT   STM   @14,@12,@SA00009                                    0525
*IF OTOURIST = YES THEN                                            0526
         L     @14,SAVER2                                          0526
         TM    OTOURIST(@14),B'10000000'                           0526
         BNO   @RF00526                                            0526
*  CALL OPENTOUR;                                          /*@Z427VLS*/
         BAL   @14,OPENTOUR                                        0527
*IF OEREPPT = YES THEN                                             0528
@RF00526 L     @14,SAVER2                                          0528
         TM    OEREPPT(@14),B'01000000'                            0528
         BNO   @RF00528                                            0528
*  CALL OPENERPT;                                          /*@Z427VLS*/
         BAL   @14,OPENERPT                                        0529
*IF OSERLOG = YES THEN                                             0530
@RF00528 L     @14,SAVER2                                          0530
         TM    OSERLOG(@14),B'00100000'                            0530
         BNO   @RF00530                                            0530
*  CALL OPENSERL;                                          /*@Z427VLS*/
         BAL   @14,OPENSERL                                        0531
*IF OACCIN = YES THEN                                              0532
@RF00530 L     @14,SAVER2                                          0532
         TM    OACCIN(@14),B'00010000'                             0532
         BNO   @RF00532                                            0532
*  CALL OPENHIST;                                          /*@Z427VLS*/
         BAL   @14,OPENHIST                                        0533
*IF OACCDEV = YES THEN                                             0534
@RF00532 L     @14,SAVER2                                          0534
         TM    OACCDEV(@14),B'00001000'                            0534
         BNO   @RF00534                                            0534
*  CALL OPENDEV;                                           /*@Z427VLS*/
         BAL   @14,OPENDEV                                         0535
*IF OSYSIN = YES THEN                                              0536
@RF00534 L     @14,SAVER2                                          0536
         TM    OSYSIN(@14),B'00000100'                             0536
         BNO   @RF00536                                            0536
*  CALL OPENSYS;                                           /*@Z427VLS*/
         BAL   @14,OPENSYS                                         0537
*IF ODRCTWRK = YES THEN                                            0538
@RF00536 L     @14,SAVER2                                          0538
         TM    ODRCTWRK(@14),B'00000010'                           0538
         BNO   @RF00538                                            0538
*  CALL OPENDIR;                                           /*@Z427VLS*/
         BAL   @14,OPENDIR                                         0539
*IF OPENIO = NODSETS THEN                                          0540
@RF00538 L     @14,SAVER2                                          0540
         CLC   OPENIO(2,@14),@CB00209                              0540
         BNE   @RF00540                                            0540
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 17;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00993                                   0542
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0543
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0544
*  END;                                                    /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENIT                           @Z427VLS*/
@EL00009 DS    0H                                                  0546
@EF00009 DS    0H                                                  0546
@ER00009 LM    @14,@12,@SA00009                                    0546
         BR    @14                                                 0546
*CLOSIT: PROC; /*SELECT DATA SET SPECIFIED AND CLOSE IT      @Z427VLS*/
CLOSIT   STM   @14,@12,@SA00010                                    0547
*IF CEREPPT = YES THEN                                             0548
         L     @14,SAVER2                                          0548
         TM    CEREPPT(@14),B'01000000'                            0548
         BNO   @RF00548                                            0548
*  CALL CLOSERPT;                                          /*@Z427VLS*/
         BAL   @14,CLOSERPT                                        0549
*IF CACCIN = YES THEN                                              0550
@RF00548 L     @14,SAVER2                                          0550
         TM    CACCIN(@14),B'00010000'                             0550
         BNO   @RF00550                                            0550
*  CALL CLOSHIST;                                          /*@Z427VLS*/
         BAL   @14,CLOSHIST                                        0551
*IF CACCDEV = YES THEN                                             0552
@RF00550 L     @14,SAVER2                                          0552
         TM    CACCDEV(@14),B'00001000'                            0552
         BNO   @RF00552                                            0552
*  CALL CLOSEDEV;                                          /*@Z427VLS*/
         BAL   @14,CLOSEDEV                                        0553
*IF CSYSIN = ON THEN                                               0554
@RF00552 L     @14,SAVER2                                          0554
         TM    CSYSIN(@14),B'00000100'                             0554
         BNO   @RF00554                                            0554
*  CALL CLOSSYS;                                           /*@Z427VLS*/
         BAL   @14,CLOSSYS                                         0555
*IF CDRCTWRK = YES THEN                                            0556
@RF00554 L     @14,SAVER2                                          0556
         TM    CDRCTWRK(@14),B'00000010'                           0556
         BNO   @RF00556                                            0556
*  CALL CLOSDIR;                                           /*@Z427VLS*/
         BAL   @14,CLOSDIR                                         0557
*IF CSERLOG = YES THEN                                             0558
@RF00556 L     @14,SAVER2                                          0558
         TM    CSERLOG(@14),B'00100000'                            0558
         BNO   @RF00558                                            0558
*  CALL CLOSSERL;                                          /*@Z427VLS*/
         BAL   @14,CLOSSERL                                        0559
*IF CTOURIST = YES THEN                                            0560
@RF00558 L     @14,SAVER2                                          0560
         TM    CTOURIST(@14),B'10000000'                           0560
         BNO   @RF00560                                            0560
*  CALL CLOSTOUR;                                          /*@Z427VLS*/
         BAL   @14,CLOSTOUR                                        0561
*/*MUST CLOSE TOURIST LAST TO GET ALL POSSIBLE ERROR MESSAGES*/    0562
*/*MUST CLOSE SERLOG SECOND TO LAST IN ORDER TO FREE UP AS MUCH*/  0562
*/*BUFFER SPACE IN ORDER TO DO A POTENTIAL ZEROALL, WHICH IMPLIES*/
*/*RECORDS WRITTEN WHILE PROCESSING MUST BE SAVED IN CORE. I HOPE*/
*/*THAT EREP1 HAD ENOUGH SENSE TO FREE UP THE SORTABLE OR ITS */   0562
*/*EQUIVALENT                                                @Z427VLS*/
*IF CLOSEIO = NODSETS THEN                                         0562
@RF00560 L     @14,SAVER2                                          0562
         CLC   CLOSEIO(2,@14),@CB00209                             0562
         BNE   @RF00562                                            0562
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 32;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00531                                   0564
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0565
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0566
*  END;                                                    /*@Z427VLS*/
*END; /*CLOSING END TO CLOSIT                                @Z427VLS*/
@EL00010 DS    0H                                                  0568
@EF00010 DS    0H                                                  0568
@ER00010 LM    @14,@12,@SA00010                                    0568
         BR    @14                                                 0568
*CLOSSERL: PROC; /*CLOSE THE SERLOG DATA SET AND ALL THAT IMPLIES*/
CLOSSERL STM   @14,@12,@SA00011                                    0569
*RESPECIFY (R15,R1,R0) RESTRICTED;                         /*@Z427VLS*/
*IF SERLO = ON THEN /*ONLY ATTEMPT TO CLOSE LOGREC IF ALREADY OPEN*/
         TM    SERLO,B'10000000'                                   0571
         BNO   @RF00571                                            0571
*DO;                                                       /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0573
         L     @14,SAVER2                                          0573
         TM    DEBUG15(@14),B'00000001'                            0573
         BNO   @RF00573                                            0573
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 56;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01007                                   0575
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0576
*  END;                                                    /*@Z427VLS*/
*IF ZEROALL = YES  /*ZEROALL MEANS RESET THE HEADER TO INDICATE NO*/
*                  /*DATA. FIRST, ANY RECORDS WRITTEN WHILE PROCESS-*/
*               /*ING ARE READ INTO CORE. SECOND, THE HEADER IS */ 0578
*               /*RESET. THIRD, SVC 76 IS ISSUED TO REWRITE THE*/  0578
*               /*RECORDS BACK TO THE NEW SERLOG             @Z427VLS*/
*  THEN DO;                                                /*@Z427VLS*/
@RF00573 L     @14,SAVER2                                          0578
         TM    ZEROALL(@14),B'01000000'                            0578
         BNO   @RF00578                                            0578
*    IF DEBUG15 = ON THEN                                          0580
         TM    DEBUG15(@14),B'00000001'                            0580
         BNO   @RF00580                                            0580
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 57;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01008                                   0582
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0583
*      END;                                                /*@Z427VLS*/
*    LASTLOOP = YES; /*INDICATE ZEROALL PROCESSING           @Z427VLS*/
@RF00580 OI    LASTLOOP,B'00000100'                                0585
*    READFR = OFF;  /* DO NOT READ FRAMES DURING ZEROALL     @ZA34610*/
         NI    READFR,B'01111111'                                  0586
*    CALL CHECKHDR; /*SET UP TO READ RECORDS WRITTEN TO LOGREC WHILE*/
         BAL   @14,CHECKHDR                                        0587
*                   /*EREP HAS BEEN PROCESSING               @Z427VLS*/
*    IF BADNEWS = ZERO THEN /*NO PROBLEMS, YES THERE ARE MORE RECORDS*/
         L     @14,BADNEWS                                         0588
         LTR   @14,@14                                             0588
         BNZ   @RF00588                                            0588
*      DO;                                                 /*@Z427VLS*/
*        CALL SAVEM; /*READ RECORDS INTO CORE                @Z427VLS*/
         BAL   @14,SAVEM                                           0590
*        CALL RESETHDR;                                    /*@Z427VLS*/
         BAL   @14,RESETHDR                                        0591
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)
*        RUNPTR = FRSPTR;                                  /*@Z427VLS*/
         L     @14,FRSPTR                                          0593
         ST    @14,RUNPTR                                          0593
*        IF FRSPTR ^= ZERO THEN                                    0594
         LTR   @14,@14                                             0594
         BZ    @RF00594                                            0594
*         DO UNTIL RUNPTR = ZERO;                          /*@Z427VLS*/
@DL00595 DS    0H                                                  0596
*           CALL ISSUE76;                                  /*@Z427VLS*/
         BAL   @14,ISSUE76                                         0596
*           RUNPTR = FORPTR;                               /*@Z427VLS*/
         L     @14,RUNPTR                                          0597
         L     @14,FORPTR(,@14)                                    0597
         ST    @14,RUNPTR                                          0597
*         END;                                             /*@Z427VLS*/
@DE00595 L     @14,RUNPTR                                          0598
         LTR   @14,@14                                             0598
         BNZ   @DL00595                                            0598
*      END;                                                /*@Z427VLS*/
*    ELSE                                                          0600
*      DO;     /* NO RECORDS WRITTEN WHILE PROCESSING?       @Z427VLS*/
         B     @RC00588                                            0600
@RF00588 DS    0H                                                  0601
*        IF BADNEWS = FOUR THEN                                    0601
         CLC   BADNEWS(4),@CF00065                                 0601
         BNE   @RF00601                                            0601
*          DO;                                             /*@ZA18998*/
*            BADNEWS=ZERO;                /* RESET RTN CODE  @ZA19017*/
         SLR   @14,@14                                             0603
         ST    @14,BADNEWS                                         0603
*            CALL RESETHDR;               /* RESET HEADER    @Z427VLS*/
         BAL   @14,RESETHDR                                        0604
*          END;                                            /*@ZA18998*/
*        GEN(DEQ  (RESIDII,LOGRECB,8,SYSTEM));             /*@Z427VLS*/
@RF00601 DS    0H                                                  0606
         DEQ  (RESIDII,LOGRECB,8,SYSTEM)
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
@RC00588 DS    0H                                                  0609
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*LET OTHER EREPS AT LOGREC*/ 0609
@RF00578 DS    0H                                                  0609
         DEQ   (RESID,LOGRECA,11,STEP)
*GEN(CLOSE (LOGREC));  /*CLOSE THE DCB                       @Z427VLS*/
         CLOSE (LOGREC)
*SERLO = OFF; /*INDICATE THAT SERLOG IS CLOSED               @Z427VLS*/
         NI    SERLO,B'01111111'                                   0611
*END;                                                      /*@Z427VLS*/
*ELSE /*IF SERLOG WAS NOT OPEN                               @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00571                                            0613
@RF00571 DS    0H                                                  0614
*    IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP CLOSEALL ALLOWED*/
         L     @14,SAVER2                                          0614
         CLC   CLOSEIO(2,@14),@CB00262                             0614
         BE    @RF00614                                            0614
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 51;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01011                                   0616
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0617
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0618
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R15,R0,R1) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSSERL                         @Z427VLS*/
@EL00011 DS    0H                                                  0622
@EF00011 DS    0H                                                  0622
@ER00011 LM    @14,@12,@SA00011                                    0622
         BR    @14                                                 0622
*ISSUE76: PROC;                                            /*@Z427VLS*/
ISSUE76  STM   @14,@12,@SA00012                                    0623
*RESPECIFY (R0,R1) RESTRICTED;                             /*@Z427VLS*/
*IF DEBUG15 = ON THEN                                              0625
         L     @12,SAVER2                                          0625
         TM    DEBUG15(@12),B'00000001'                            0625
         BNO   @RF00625                                            0625
*  DO;                                                     /*@Z427VLS*/
*    MSGNO = 58;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01015                                   0627
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0628
*  END;                                                    /*@Z427VLS*/
*R0 =JUNK3;                                                /*@Z427VLS*/
@RF00625 L     @12,RUNPTR                                          0630
         LH    R0,JUNK3(,@12)                                      0630
*R1 = ADDR(RECSPT);                                        /*@Z427VLS*/
         LA    R1,RECSPT(,@12)                                     0631
*R0 = R0 * (-1);                                           /*@Z427VLS*/
         LR    @12,R0                                              0632
         MH    @12,@CH01016                                        0632
         LR    R0,@12                                              0632
*SVC(76);                                                  /*@Z427VLS*/
         SVC   76                                                  0633
*RESPECIFY (R0,R1) UNRESTRICTED;                           /*@Z427VLS*/
*END; /*CLOSING END TO PROC ISSUE76                          @Z427VLS*/
@EL00012 DS    0H                                                  0635
@EF00012 DS    0H                                                  0635
@ER00012 LM    @14,@12,@SA00012                                    0635
         BR    @14                                                 0635
*SAVEM: PROC;                                              /*@Z427VLS*/
SAVEM    STM   @14,@12,@SA00013                                    0636
*RESPECIFY (R2,R3,R4,R5,R6,R15) RESTRICTED;                /*@Z427VLS*/
*DO WHILE BADNEWS = ZERO;                                  /*@Z427VLS*/
         B     @DE00638                                            0638
@DL00638 DS    0H                                                  0639
*  CALL READSER;                                           /*@Z427VLS*/
         BAL   @14,READSER                                         0639
*  IF BADNEWS = ZERO THEN                                          0640
         L     @14,BADNEWS                                         0640
         LTR   @14,@14                                             0640
         BNZ   @RF00640                                            0640
*    DO;                                                   /*@Z427VLS*/
*      DBLYES = NO;                                        /*@Z427VLS*/
         NI    DBLYES,B'11110111'                                  0642
*      GETHIS = BSZ;                                       /*@Z427VLS*/
         LH    @14,BSZ                                             0643
         ST    @14,GETHIS                                          0643
*      GETHIS = GETHIS + 12;                               /*@Z427VLS*/
         AL    @14,@CF00068                                        0644
         ST    @14,GETHIS                                          0644
*      DO WHILE DBLYES = NO;                               /*@Z427VLS*/
         B     @DE00645                                            0645
@DL00645 DS    0H                                                  0646
*        IF (GETTIT & DBLWORD) ^= NULL THEN                        0646
         MVC   @TS00001(4),GETTIT                                  0646
         NC    @TS00001(4),@CB00532                                0646
         CLC   @TS00001(4),@CB00120                                0646
         BE    @RF00646                                            0646
*          GETHIS = GETHIS + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0647
         AL    @14,GETHIS                                          0647
         ST    @14,GETHIS                                          0647
*        ELSE                                                      0648
*          DBLYES = YES;                                   /*@Z427VLS*/
         B     @RC00646                                            0648
@RF00646 OI    DBLYES,B'00001000'                                  0648
*      END;                                                /*@Z427VLS*/
@RC00646 DS    0H                                                  0649
@DE00645 TM    DBLYES,B'00001000'                                  0649
         BZ    @DL00645                                            0649
*      R6 = GETTIT; /*NUMBER OF BYTES NEEDED IN R6           @Z427VLS*/
         L     R6,GETTIT                                           0650
*      GEN(GETMAIN  EC,LV=(R6),A=SAVEPTR); /*STORAGE FOR RECORD*/  0651
         GETMAIN  EC,LV=(R6),A=SAVEPTR
*      NUMRECSV = NUMRECSV + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0652
         AL    @14,NUMRECSV                                        0652
         ST    @14,NUMRECSV                                        0652
*      IF R15 = ZERO THEN                                          0653
         LTR   R15,R15                                             0653
         BNZ   @RF00653                                            0653
*        DO;                                               /*@Z427VLS*/
*          IF SECGET = NO THEN /*IF FIRST RECORD SAVED THEN  @Z427VLS*/
         TM    SECGET,B'01000000'                                  0655
         BNZ   @RF00655                                            0655
*            DO;                                           /*@Z427VLS*/
*              SECGET = YES;                               /*@Z427VLS*/
         OI    SECGET,B'01000000'                                  0657
*              FRSPTR = SAVEPTR; /*POINTER TO FIRST RECORD SAVED*/ 0658
         L     @14,SAVEPTR                                         0658
         ST    @14,FRSPTR                                          0658
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESSABILITY  @Z427VLS*/
         ST    @14,RUNPTR                                          0659
*            END;                                          /*@Z427VLS*/
*           ELSE /*IF SAVING SECOND RECORD THEN              @Z427VLS*/
*            DO;                                           /*@Z427VLS*/
         B     @RC00655                                            0661
@RF00655 DS    0H                                                  0662
*              FORPTR = SAVEPTR; /*SET FORWARD POINTER FROM OLD REC*/
         L     @14,SAVEPTR                                         0662
         L     @12,RUNPTR                                          0662
         ST    @14,FORPTR(,@12)                                    0662
*                                /*TO LOCATION OF NEW RECORD SAVE ARR*/
*              RUNPTR = SAVEPTR; /*ESTABLISH ADDRESS OF NEW RECORD*/
         ST    @14,RUNPTR                                          0663
*            END;                                          /*@Z427VLS*/
*          R2 = ADDR(JUNK);                                /*@Z427VLS*/
@RC00655 L     R2,RUNPTR                                           0665
         LA    R2,JUNK(,R2)                                        0665
*          R3 = GETHIS - 4;                                /*@Z427VLS*/
         L     R3,GETHIS                                           0666
         SL    R3,@CF00065                                         0666
*          R4 = ADDR(BCOUNT); /*MAY BE WRONG                 @Z427VLS*/
         LA    R4,BCOUNT                                           0667
*          R5 = R3;                                        /*@Z427VLS*/
         LR    R5,R3                                               0668
*          MVCL(R2,R4);                                    /*@Z427VLS*/
         MVCL  R2,R4                                               0669
*          FORPTR = ZERO;                                  /*@Z427VLS*/
         L     @14,RUNPTR                                          0670
         SLR   @12,@12                                             0670
         ST    @12,FORPTR(,@14)                                    0670
*        END;                                              /*@Z427VLS*/
*      ELSE                                                        0672
*        DO;                                               /*@Z427VLS*/
         B     @RC00653                                            0672
@RF00653 DS    0H                                                  0673
*          MSGNO = 50;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF00296                                   0673
*          CALL ERRMSG;                                    /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0674
*          BADNEWS = TWELVE;                               /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0675
*        END;                                              /*@Z427VLS*/
*     END;                                                 /*@Z427VLS*/
@RC00653 DS    0H                                                  0678
*   END;                                                   /*@Z427VLS*/
@RF00640 DS    0H                                                  0678
@DE00638 L     @14,BADNEWS                                         0678
         LTR   @14,@14                                             0678
         BZ    @DL00638                                            0678
*RESPECIFY (R2,R3,R4,R5,R6,R15) UNRESTRICTED;              /*@Z427VLS*/
*END; /*CLOSING END TO PROC SAVEM                            @Z427VLS*/
@EL00013 DS    0H                                                  0680
@EF00013 DS    0H                                                  0680
@ER00013 LM    @14,@12,@SA00013                                    0680
         BR    @14                                                 0680
*ERRMSG: PROC; /*WRITE ERROR MESSAGES TO THE TOURIST DATA SET*/    0681
ERRMSG   STM   @14,@12,@SA00014                                    0681
*              /*IF THE PROBLEM EXISTS WITH THE TOURIST DATA SET*/ 0682
*              /*THEN WRITE TO THE OPERATOR. IF THE OPERATOR @Z427VLS*/
*              /*CANNOT BE REACHED, THEN YOU ARE ASKING TOO MUCH*/ 0682
*              /*OF THIS PROGRAM                             @Z427VLS*/
*RESPECIFY (R7,R12,R5) RESTRICTED;                         /*@Z427VLS*/
*GEN(MVC PRNTBF(134),BLANKS); /*CLEAR INTERNAL PRINT BUFFER  @Z427VLS*/
         MVC PRNTBF(134),BLANKS
*IF MSGNO <= 52 THEN            /* SYSTEM ERROR MESSAGE ?    @Z427VLS*/
         L     @06,MSGNO                                           0684
         C     @06,@CF01026                                        0684
         BH    @RF00684                                            0684
*  DO;                                                     /*@Z427VLS*/
*    R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2       @ZA31549*/
         L     @06,SAVER2                                          0686
         LR    R2,@06                                              0686
*    CALL IFCMSG(MSGNO,ADDR(PRNTBF)+2);                    /*@Z427VLS*/
         LA    @04,PRNTBF                                          0687
         AL    @04,@CF00075                                        0687
         ST    @04,@AFTEMPS+4                                      0687
         L     @15,ADIFCMSG(,@06)                                  0687
         LA    @01,@AL00687                                        0687
         BALR  @14,@15                                             0687
*    PRNTBF(1:2) = '1 ';                                   /*@Z427VLS*/
         MVC   PRNTBF(2),@CC01027                                  0688
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0690
*  DO;                                                     /*@Z427VLS*/
         B     @RC00684                                            0690
@RF00684 DS    0H                                                  0691
*    MSGNO = MSGNO - 52;                                   /*@Z427VLS*/
         L     @06,MSGNO                                           0691
         SL    @06,@CF01026                                        0691
         ST    @06,MSGNO                                           0691
*    R5 = ADDR(ERRLINE) + (51 * (MSGNO - 1)); /*POINT TO MESSAGE TEXT*/
         LA    R5,ERRLINE                                          0692
         BCTR  @06,0                                               0692
         MH    @06,@CH01011                                        0692
         ALR   R5,@06                                              0692
*    GEN(MVC PRNTBF(51),0(R5)); /*MOVE TEXT TO INTERNAL PRINT BUFFER*/
         MVC PRNTBF(51),0(R5)
*  END;                                                    /*@Z427VLS*/
*PRINTADR = ADDR(PRNTBF); /*ADDRESS THE DATA SET TYPE        @Z427VLS*/
@RC00684 LA    @06,PRNTBF                                          0695
         L     @04,SAVER2                                          0695
         ST    @06,PRINTADR(,@04)                                  0695
*IF TOUROPN = YES                 THEN /*IF TOURIST DATA SET IS OPEN*/
         TM    TOUROPN,B'00000010'                                 0696
         BNO   @RF00696                                            0696
*  DO;                                                     /*@Z427VLS*/
*     R7 = PRINTADR + 1; /*POINT PAST DATA SET INDICATOR     @Z427VLS*/
         LA    R7,1                                                0698
         ALR   R7,@06                                              0698
*     CCSAVE = PRINTCC; /*SAVE CARRIAGE CONTROL FROM CALLER  @Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@06)                              0699
*     PRINTCC = '09'X; /*CARRIAGE CONTROL TO PRINT ONE LINE  @Z427VLS*/
         MVI   PRINTCC(@06),X'09'                                  0700
*     GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB             @Z427VLS*/
         LA R12,TOURDCB
*     GEN(PUT (12),(R7));                                  /*@Z427VLS*/
         PUT (12),(R7)
*     PRINTCC = CCSAVE; /*RESTORE CALLERS CARRIAGE CONTROL   @Z427VLS*/
         L     @06,SAVER2                                          0703
         L     @04,PRINTADR(,@06)                                  0703
         MVC   PRINTCC(1,@04),CCSAVE                               0703
*     PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER       @Z427VLS*/
         MVC   PRINTBDY(132,@04),BLANKS                            0704
*     LINECTT = LINECTT + 1;                               /*@Z427VLS*/
         LA    @15,1                                               0705
         AH    @15,LINECTT                                         0705
         STH   @15,LINECTT                                         0705
*     IF LINECTT = LINECT THEN                                     0706
         CH    @15,LINECT(,@06)                                    0706
         BNE   @RF00706                                            0706
*       DO;                                                /*@Z427VLS*/
*         LINECTT = 0;                                     /*@Z427VLS*/
         SLR   @06,@06                                             0708
         STH   @06,LINECTT                                         0708
*         CCSAVE = PRINTCC;                                /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@04)                              0709
*         PRINTCC = SKIPNEW;                               /*@Z427VLS*/
         MVI   PRINTCC(@04),X'8B'                                  0710
*         GEN(PUT (R12),(R7));                             /*@Z427VLS*/
         PUT (R12),(R7)
*         PRINTCC = CCSAVE;                                /*@Z427VLS*/
         L     @06,SAVER2                                          0712
         L     @06,PRINTADR(,@06)                                  0712
         MVC   PRINTCC(1,@06),CCSAVE                               0712
*       END;                                               /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
* ELSE /*IF TOURIST NOT OPEN THEN GO TO OPERATOR             @ZA28682*/
*   DO;                                                    /*@ZA35725*/
         B     @RC00696                                            0715
@RF00696 DS    0H                                                  0716
*    R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2       @ZA31549*/
         L     @06,SAVER2                                          0716
         LR    R2,@06                                              0716
*    CALL IFCMSG(203,ADDR(PRNTBF));                        /*@ZA28682*/
         LA    @04,PRNTBF                                          0717
         ST    @04,@AFTEMPS+4                                      0717
         L     @15,ADIFCMSG(,@06)                                  0717
         LA    @01,@AL00717                                        0717
         BALR  @14,@15                                             0717
*   END;                                                   /*@ZA35725*/
*RESPECIFY (R7,R12,R5) UNRESTRICTED;                       /*@Z427VLS*/
* END; /*CLOSING END TO ERRMSG PROC                          @Z427VLS*/
@EL00014 DS    0H                                                  0720
@EF00014 DS    0H                                                  0720
@ER00014 LM    @14,@12,@SA00014                                    0720
         BR    @14                                                 0720
*PRINTIT: PROC; /*SELECT PRINT DATA SET AND PRINT LINE REQUESTED*/ 0721
PRINTIT  STM   @14,@12,@SA00015                                    0721
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*IF PRINTDS = 'F0'X THEN /*IF PRINT TO ERREPT THEN           @Z427VLS*/
         L     @06,SAVER2                                          0723
         L     @06,PRINTADR(,@06)                                  0723
         CLI   PRINTDS(@06),X'F0'                                  0723
         BNE   @RF00723                                            0723
*  DO;                                                     /*@Z427VLS*/
*    IF ERPTOPN = ON THEN /*IF ERREPT HAS BEEN OPENED THEN   @Z427VLS*/
         TM    ERPTOPN,B'00000001'                                 0725
         BNO   @RF00725                                            0725
*      DO;                                                 /*@Z427VLS*/
*        GEN(LA R12,EREPTDCB); /*ADDRESS ERREPT DCB          @Z427VLS*/
         LA R12,EREPTDCB
*        R7 = PRINTADR + 1; /*POINT PAST THE DATA SET DEFINER*/    0728
         LA    R7,1                                                0728
         L     @06,SAVER2                                          0728
         AL    R7,PRINTADR(,@06)                                   0728
*        GEN(TR 0(1,R7),MACHCODE); /* ENSURE VALID CODE      @ZA18999*/
         TR 0(1,R7),MACHCODE
*        GEN(PUT (12),(7));                                /*@Z427VLS*/
         PUT (12),(7)
*        PRINTBDY = BLANKS; /*CLEAR PRINT LINE FOR CALLER    @Z427VLS*/
         L     @06,SAVER2                                          0731
         L     @06,PRINTADR(,@06)                                  0731
         MVC   PRINTBDY(132,@06),BLANKS                            0731
*      END;                                                /*@Z427VLS*/
*    ELSE /*REQUEST TO WRITE TO DATA SET NOT OPEN            @Z427VLS*/
*      DO;                                                 /*@Z427VLS*/
         B     @RC00725                                            0733
@RF00725 DS    0H                                                  0734
*        BADNEWS = TWELVE;                                 /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0734
*        MSGNO = 19;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01032                                   0735
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0736
*      END;                                                /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*ELSE /*REQUEST FOR WRITE TO TOURIST DATA SET                @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00723                                            0739
@RF00723 DS    0H                                                  0740
*    IF TOUROPN = YES THEN /*IF TOURIST DATA SET IS OPEN THEN*/    0740
         TM    TOUROPN,B'00000010'                                 0740
         BNO   @RF00740                                            0740
*      DO;                                                 /*@Z427VLS*/
*        R7 = PRINTADR + 1; /* POINT PAST DATA SET ID        @Z427VLS*/
         L     @01,SAVER2                                          0742
         L     @15,PRINTADR(,@01)                                  0742
         LA    R7,1                                                0742
         ALR   R7,@15                                              0742
*        CCSAVE = PRINTCC;                                 /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@15)                              0743
*        PRINTCC = '09'X; /*SET TO PRINT AND SKIP ONE        @Z427VLS*/
         MVI   PRINTCC(@15),X'09'                                  0744
*        GEN(LA R12,TOURDCB); /*ADDRESS TOURIST DCB          @Z427VLS*/
         LA R12,TOURDCB
*        GEN(PUT (12),(7)); /*PUT TO TOURIST                 @Z427VLS*/
         PUT (12),(7)
*        PRINTCC = CCSAVE; /*RESTORE USERS CARRIAGE CONTROL  @Z427VLS*/
         L     @06,SAVER2                                          0747
         L     @15,PRINTADR(,@06)                                  0747
         MVC   PRINTCC(1,@15),CCSAVE                               0747
*        PRINTBDY = BLANKS; /*BLANKS TO CALLERS LINE         @Z427VLS*/
         MVC   PRINTBDY(132,@15),BLANKS                            0748
*        LINECTT = LINECTT + 1;                            /*@Z427VLS*/
         LA    @14,1                                               0749
         AH    @14,LINECTT                                         0749
         STH   @14,LINECTT                                         0749
*        IF LINECTT = LINECT THEN                                  0750
         CH    @14,LINECT(,@06)                                    0750
         BNE   @RF00750                                            0750
*          DO;                                             /*@Z427VLS*/
*            LINECTT = 0;                                  /*@Z427VLS*/
         SLR   @06,@06                                             0752
         STH   @06,LINECTT                                         0752
*            CCSAVE = PRINTCC;                             /*@Z427VLS*/
         MVC   CCSAVE(1),PRINTCC(@15)                              0753
*            PRINTCC = SKIPNEW;                            /*@Z427VLS*/
         MVI   PRINTCC(@15),X'8B'                                  0754
*            GEN(PUT (R12),(R7));                          /*@Z427VLS*/
         PUT (R12),(R7)
*            PRINTCC = CCSAVE;                             /*@Z427VLS*/
         L     @06,SAVER2                                          0756
         L     @06,PRINTADR(,@06)                                  0756
         MVC   PRINTCC(1,@06),CCSAVE                               0756
*          END;                                            /*@Z427VLS*/
*     END;                                                 /*@Z427VLS*/
*   ELSE  /*IMPLIES TOURIST DATA SET NOT OPEN                @Z427VLS*/
*     DO;                                                  /*@Z427VLS*/
         B     @RC00740                                            0759
@RF00740 DS    0H                                                  0760
*       R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2    @ZA31549*/
         L     @06,SAVER2                                          0760
         LR    R2,@06                                              0760
*       CALL IFCMSG(203,ADDR(PRNTBF));                     /*@Z427VLS*/
         LA    @15,PRNTBF                                          0761
         ST    @15,@AFTEMPS+8                                      0761
         L     @15,ADIFCMSG(,@06)                                  0761
         LA    @01,@AL00761                                        0761
         BALR  @14,@15                                             0761
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0762
*     END;                                                 /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC PRINTIT                          @Z427VLS*/
@EL00015 DS    0H                                                  0766
@EF00015 DS    0H                                                  0766
@ER00015 LM    @14,@12,@SA00015                                    0766
         BR    @14                                                 0766
*OPENSYS: PROC; /*OPEN SYSIN DATA SET TO READ CARDS          @Z427VLS*/
OPENSYS  STM   @14,@12,@SA00016                                    0767
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF SYSOPN = NO THEN /* IF ALREADY OPEN IS NO NO             @Z427VLS*/
         TM    SYSOPN,B'00000100'                                  0769
         BNZ   @RF00769                                            0769
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0771
         L     @01,SAVER2                                          0771
         TM    DEBUG15(@01),B'00000001'                            0771
         BNO   @RF00771                                            0771
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 59;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01036                                   0773
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0774
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF00771 DS    0H                                                  0776
         LA    R12,SYSDCB
         OPEN  ((R12),(INPUT))
         TM    DCBOFLGS,OPENOK
         BZ    SYSOBAD
*   SYSOPN = YES;                                          /*@Z427VLS*/
         OI    SYSOPN,B'00000100'                                  0777
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0779
*  DO;                                                     /*@Z427VLS*/
         B     @RC00769                                            0779
@RF00769 DS    0H                                                  0780
*    MSGNO = 33;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01037                                   0780
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0781
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0782
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENSYS                          @Z427VLS*/
@EL00016 DS    0H                                                  0785
@EF00016 DS    0H                                                  0785
@ER00016 LM    @14,@12,@SA00016                                    0785
         BR    @14                                                 0785
*CLOSSYS: PROC; /*CLOSE SYSIN DATA SET FOR READING CARDS     @Z427VLS*/
CLOSSYS  STM   @14,@12,@SA00017                                    0786
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF SYSOPN = YES THEN                                              0788
         TM    SYSOPN,B'00000100'                                  0788
         BNO   @RF00788                                            0788
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0790
         L     @01,SAVER2                                          0790
         TM    DEBUG15(@01),B'00000001'                            0790
         BNO   @RF00790                                            0790
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 60;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00841                                   0792
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0793
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF00790 DS    0H                                                  0795
         CLOSE (SYSDCB)
*    SYSOPN = NO;                                          /*@Z427VLS*/
         NI    SYSOPN,B'11111011'                                  0796
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0798
*  DO;                                                     /*@Z427VLS*/
         B     @RC00788                                            0798
@RF00788 DS    0H                                                  0799
*    IF CLOSEIO ^= CLOSEALL THEN                                   0799
         L     @01,SAVER2                                          0799
         CLC   CLOSEIO(2,@01),@CB00262                             0799
         BE    @RF00799                                            0799
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 34;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01041                                   0801
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0802
*        BADNEWS = 12;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0803
*      END;                                                /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSSYS                          @Z427VLS*/
@EL00017 DS    0H                                                  0807
@EF00017 DS    0H                                                  0807
@ER00017 LM    @14,@12,@SA00017                                    0807
         BR    @14                                                 0807
*REEDSYS: PROC OPTIONS(DONTSAVE(R7)); /*READ THE SYSIN CARDS @Z427VLS*/
REEDSYS  STM   @14,@06,@SA00018                                    0808
         STM   @08,@12,@SA00018+36                                 0808
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*IF SYSOPN = YES THEN                                              0810
         TM    SYSOPN,B'00000100'                                  0810
         BNO   @RF00810                                            0810
*  DO;                                                     /*@Z427VLS*/
*    SYSRDCT = SYSRDCT + 1; /*NUMBER OF READS ATTEMPTED      @Z427VLS*/
         LA    @06,1                                               0812
         AL    @06,SYSRDCT                                         0812
         ST    @06,SYSRDCT                                         0812
*    GENERATE;                                             /*@Z427VLS*/
         LA    R7,CARDSPOT
         LA    R12,SYSDCB
         GET   (12),(7)
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              0815
*  DO;                                                     /*@Z427VLS*/
         B     @RC00810                                            0815
@RF00810 DS    0H                                                  0816
*    MSGNO = 35;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01045                                   0816
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0817
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0818
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO REEDSYS PROC                          @Z427VLS*/
@EL00018 DS    0H                                                  0821
@EF00018 DS    0H                                                  0821
@ER00018 LM    @14,@06,@SA00018                                    0821
         LM    @08,@12,@SA00018+36                                 0821
         BR    @14                                                 0821
*SCRCHIT: PROC; /*WRITE TO DIRECTWK DATA SET SEQUENTIALLY    @Z427VLS*/
SCRCHIT  STM   @14,@12,@SA00019                                    0822
*RESPECIFY (R7,R12,R1) RESTRICTED;                         /*@Z427VLS*/
*IF INDIR = YES & /*IF DATA SET IS OPEN AND OPEN FOR SEQUENTIAL*/  0824
*   CLOSE2 = NO THEN /*WRITING THEN                          @Z427VLS*/
         TM    INDIR,B'00100000'                                   0824
         BNO   @RF00824                                            0824
         TM    CLOSE2,B'00001000'                                  0824
         BNZ   @RF00824                                            0824
*  DO;                                                     /*@Z427VLS*/
*    RITEWKCT = RITEWKCT + 1; /*NUMBER OF WRITE ATTEMPTS     @Z427VLS*/
         LA    @06,1                                               0826
         AL    @06,RITEWKCT                                        0826
         ST    @06,RITEWKCT                                        0826
*GENERATE;                                                 /*@Z427VLS*/
         LA    R7,BUF1     GET ADDRESS OF RECORD
*        IF FLIPFLOP = OFF THEN /*MUST REARRANGE SERLOG PRE RECORD*/
         TM    FLIPFLOP,B'00100000'                                0828
         BNZ   @RF00828                                            0828
*          DO;                                             /*@Z427VLS*/
*            BBRDW = SAVELENT; /*GET UNMODIFIED QSAM RECORD LENGTH*/
         LH    @06,SAVELENT                                        0830
         STH   @06,BBRDW                                           0830
*            BSIZE = '0000'X;                              /*@Z427VLS*/
         MVC   BSIZE(2),@CB00209                                   0831
*            R7 = ADDR(BBRDW);                             /*@Z427VLS*/
         LA    R7,BBRDW                                            0832
*          END;                                            /*@Z427VLS*/
*         GENERATE;                                        /*@Z427VLS*/
@RF00828 DS    0H                                                  0834
         LA    R12,WORKWDCB   GET DCB ADDRESS
         WRITE WORKWDEC,SF,(12),(7)  ISSUE WRITE SVC
         CHECK WORKWDEC     MAKE SURE WRITE COMPLETES BEFORE PROCEED
         NOTE  (12)     RETRIEVE RELATIVE RECORD LOCATION ON DIRECTWK
         ST    R1,TTRSAVE  SAVE TTR FOR SORTABLE
         CLC   TTRSAVE(2),MAXTRK  ARE WE ON LAST TRACK OF DATA SET
         BNL   OVERFLOW    GO TELL OF OVERFLOW CONDITION
*RECCCHHR = TTRSAVE; /*PUT IN COMTABLE FOR USER ACCESS       @Z427VLS*/
         L     @06,SAVER2                                          0835
         MVI   RECCCHHR+4(@06),C' '                                0835
         MVC   RECCCHHR(4,@06),TTRSAVE                             0835
*END;                                                      /*@Z427VLS*/
*ELSE /*IF DATA SET IS NOT OPEN                              @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00824                                            0837
@RF00824 DS    0H                                                  0838
*    MSGNO = 28;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01049                                   0838
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0839
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0840
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12,R1) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO SCRSCHT PROC                          @Z427VLS*/
@EL00019 DS    0H                                                  0843
@EF00019 DS    0H                                                  0843
@ER00019 LM    @14,@12,@SA00019                                    0843
         BR    @14                                                 0843
*DIRRDSCR: PROC OPTIONS(DONTSAVE(R7)); /*READ DIRECTWK SEQUENTIALLY*/
DIRRDSCR STM   @14,@06,@SA00020                                    0844
         STM   @08,@12,@SA00020+36                                 0844
*                                     /*USING POINT          @Z427VLS*/
*RESPECIFY (R7,R6,R12) RESTRICTED;                         /*@Z427VLS*/
*IF INDIR = YES &  /*IF DATA SET OPEN AND OPEN FOR SEQUENTIAL*/    0846
*   CLOSE2 = YES THEN /*POINT READING                        @Z427VLS*/
         TM    INDIR,B'00101000'                                   0846
         BNO   @RF00846                                            0846
*  DO;                                                     /*@Z427VLS*/
*    READWKCT = READWKCT + 1;                              /*@Z427VLS*/
         LA    @15,1                                               0848
         AL    @15,READWKCT                                        0848
         ST    @15,READWKCT                                        0848
*    GENERATE;                                             /*@Z427VLS*/
         LA    R7,BUF1
         LA    R12,WORKRDCB
         LA    R6,RECCCHHR
         A     R6,SAVER2
         POINT (12),(6)
         READ  WORKRDEC,SF,(12),(7)
         CHECK WORKRDEC
*        R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER  @Z427VLS*/
         LA    @15,4                                               0850
         ALR   R7,@15                                              0850
*        BUF1L = BUF1RDWL; /*MOVE RECORD LENGTH TO 2 BYTES BEFORE REC*/
         LH    @14,BUF1RDWL                                        0851
         STH   @14,BUF1L                                           0851
*        BUF1L = BUF1L - 4; /*RECORD DATA LENGTH ONLY        @0001VLS*/
         SLR   @14,@15                                             0852
         STH   @14,BUF1L                                           0852
*        SCRATCH = YES; /*JUST READ CURRENT RECORD OFF DIRECTWK*/  0853
         OI    SCRATCH,B'01000000'                                 0853
*        RECLNGTH = BUF1L;                                 /*@Z427VLS*/
         L     @15,SAVER2                                          0854
         STH   @14,RECLNGTH(,@15)                                  0854
*  END;                                                    /*@Z427VLS*/
*ELSE /*DATA SET NOT OPEN                                    @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00846                                            0856
@RF00846 DS    0H                                                  0857
*    MSGNO = 46;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01054                                   0857
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0858
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0859
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R6,R12) UNRESTRICTED;                       /*@Z427VLS*/
*END; /*CLOSING END TO PROC DIRRDSER                         @Z427VLS*/
@EL00020 DS    0H                                                  0862
@EF00020 DS    0H                                                  0862
@ER00020 LM    @14,@06,@SA00020                                    0862
         LM    @08,@12,@SA00020+36                                 0862
         BR    @14                                                 0862
*DIRECTIT: PROC OPTIONS(DONTSAVE(R7)); /*CHOOSE DIRECT READ OF SERLOG*/
DIRECTIT STM   @14,@06,@SA00021                                    0863
         STM   @08,@12,@SA00021+36                                 0863
*                                     /*OR DIRECTWK          @Z427VLS*/
*RESPECIFY (R7) RESTRICTED;                                /*@Z427VLS*/
*IF HISTYES = YES THEN /*IS DIRECTWK DATA SET                @Z427VLS*/
         TM    HISTYES,B'00010000'                                 0865
         BNO   @RF00865                                            0865
*  CALL DIRRDSCR;                                          /*@Z427VLS*/
         BAL   @14,DIRRDSCR                                        0866
*ELSE /*IS SERLOG BY DEFAULT                                 @Z427VLS*/
*  CALL DIRRDSER;                                          /*@Z427VLS*/
         B     @RC00865                                            0867
@RF00865 BAL   @14,DIRRDSER                                        0867
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
*END; /*CLOSING END TO DIRECTIT                              @Z427VLS*/
@EL00021 DS    0H                                                  0869
@EF00021 DS    0H                                                  0869
@ER00021 LM    @14,@06,@SA00021                                    0869
         LM    @08,@12,@SA00021+36                                 0869
         BR    @14                                                 0869
*CLOSDIR: PROC; /*CLOSE DIRECTWK DATA SET                    @Z427VLS*/
CLOSDIR  STM   @14,@12,@SA00022                                    0870
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INDIR = YES THEN /*IF DATA SET IS OPEN THEN              @Z427VLS*/
         TM    INDIR,B'00100000'                                   0872
         BNO   @RF00872                                            0872
*  DO;                                                     /*@Z427VLS*/
*    IF CLOSE2 = NO THEN /*IF CLOSING DIRECTWK FOR WRITING   @Z427VLS*/
         TM    CLOSE2,B'00001000'                                  0874
         BNZ   @RF00874                                            0874
*      DO;                                                 /*@Z427VLS*/
*        IF DEBUG15 = ON THEN                                      0876
         L     @01,SAVER2                                          0876
         TM    DEBUG15(@01),B'00000001'                            0876
         BNO   @RF00876                                            0876
*          DO;                                             /*@Z427VLS*/
*            MSGNO = 61;                                   /*@Z427VLS*/
         MVC   MSGNO(4),@CF01061                                   0878
*            CALL ERRMSG;                                  /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0879
*          END;                                            /*@Z427VLS*/
*        CLOSE2 = YES; /*INDICATE CLOSED FOR WRITING         @Z427VLS*/
@RF00876 OI    CLOSE2,B'00001000'                                  0881
*        GENERATE;                                         /*@Z427VLS*/
         CLOSE (WORKWDCB) CLOSE WRITE DCB
         LA    R12,WORKRDCB  GET READING DCB
         OPEN  ((R12),(INPUT))     OPEN FOR READING DIRECTWK
         TM    DCBOFLGS,OPENOK   IF OPEN SUCCESSFUL
         BZ    BADBRSEQ     IF FAILS,GO PRINT MESSAGE;     /*@Z427VLS*/
*    INDIR = YES; /*INDICATE OPEN SUCCESSFUL                 @Z427VLS*/
         OI    INDIR,B'00100000'                                   0883
*   END;                                                   /*@Z427VLS*/
*  ELSE /*CLOSE FOR SEQUENTIAL POINT READING                 @Z427VLS*/
*    DO;                                                   /*@Z427VLS*/
         B     @RC00874                                            0885
@RF00874 DS    0H                                                  0886
*      IF DEBUG15 = ON THEN                                        0886
         L     @01,SAVER2                                          0886
         TM    DEBUG15(@01),B'00000001'                            0886
         BNO   @RF00886                                            0886
*        DO;                                               /*@Z427VLS*/
*          MSGNO = 62;                                     /*@Z427VLS*/
         MVC   MSGNO(4),@CF01062                                   0888
*          CALL ERRMSG;                                    /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0889
*        END;                                              /*@Z427VLS*/
*      GEN(CLOSE (WORKRDCB)); /*ISSUE CLOSE SVC              @Z427VLS*/
@RF00886 DS    0H                                                  0891
         CLOSE (WORKRDCB)
*    END;                                                  /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
* ELSE  /*CLOSE REQUESTED WHEN NOT OPEN                      @Z427VLS*/
*   DO;                                                    /*@Z427VLS*/
         B     @RC00872                                            0894
@RF00872 DS    0H                                                  0895
*     IF CLOSEIO ^= CLOSEALL THEN /*END OF JOB WRAPUP IS ALLOWED*/ 0895
         L     @01,SAVER2                                          0895
         CLC   CLOSEIO(2,@01),@CB00262                             0895
         BE    @RF00895                                            0895
*       DO;                                                /*@Z427VLS*/
*         MSGNO = 29;                                      /*@Z427VLS*/
         MVC   MSGNO(4),@CF00544                                   0897
*         CALL ERRMSG;                                     /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0898
*         BADNEWS = TWELVE;                                /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0899
*       END;                                               /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSDIR                          @Z427VLS*/
@EL00022 DS    0H                                                  0903
@EF00022 DS    0H                                                  0903
@ER00022 LM    @14,@12,@SA00022                                    0903
         BR    @14                                                 0903
*READSIT: PROC OPTIONS(DONTSAVE(R7)); /*READ FROM SERLOG OR ACCIN*/
READSIT  STM   @14,@06,@SA00023                                    0904
         STM   @08,@12,@SA00023+36                                 0904
*RESPECIFY (R7) RESTRICTED;           /*SEQUENTIALLY         @Z427VLS*/
*IF INHISO = YES THEN /*IF ACCIN IS OPEN, READ IT. IF BOTH SERLOG */
         TM    INHISO,B'00000001'                                  0906
         BNO   @RF00906                                            0906
*  CALL READHIST;     /*AND ACCIN ARE OPEN, READ ACCIN FIRST @Z427VLS*/
         BAL   @14,READHIST                                        0907
*ELSE           /*IMPLIES HISTORY NOT OPEN                   @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00906                                            0908
@RF00906 DS    0H                                                  0909
*    IF SERLO = YES THEN /*IF SERLOG IS OPEN THEN IMPLIES ACCIN*/  0909
         TM    SERLO,B'10000000'                                   0909
         BNO   @RF00909                                            0909
*      CALL READSER;    /*NEVER OPEN OR ACCIN HAS BEEN READ, CLOSED*/
         BAL   @14,READSER                                         0910
*    ELSE                /*NEITHER DATA SET OPEN IMPLIED     @Z427VLS*/
*      DO;                                                 /*@Z427VLS*/
         B     @RC00909                                            0911
@RF00909 DS    0H                                                  0912
*        BADNEWS = TWELVE; /*SET BAD RETURN CODE             @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0912
*        MSGNO = 21;     /*INDICATE ERROR MESSAGE TEXT NUMBER*/    0913
         MVC   MSGNO(4),@CF01067                                   0913
*        CALL ERRMSG; /*PRINT THE ERROR TO TOURIST           @Z427VLS*/
         BAL   @14,ERRMSG                                          0914
*      END;                                                /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R7) UNRESTRICTED;                              /*@Z427VLS*/
* END; /*CLOSING END TO READSIT PROC                         @Z427VLS*/
@EL00023 DS    0H                                                  0918
@EF00023 DS    0H                                                  0918
@ER00023 LM    @14,@06,@SA00023                                    0918
         LM    @08,@12,@SA00023+36                                 0918
         BR    @14                                                 0918
*READHIST: PROC OPTIONS(DONTSAVE(R7)); /*READ ACCIN SEQUENTIALLY*/ 0919
READHIST STM   @14,@06,@SA00024                                    0919
         STM   @08,@12,@SA00024+36                                 0919
*RESPECIFY (R7,R12) RESTRICTED;                            /*@Z427VLS*/
*    ACIRDCT = ACIRDCT + 1; /*ACCIN READ ATTEMPTS            @Z427VLS*/
         LA    @06,1                                               0921
         AL    @06,ACIRDCT                                         0921
         ST    @06,ACIRDCT                                         0921
*    R7 = ADDR(BUF1RDW); /*GET ADDRESS OF WORKAREA           @Z427VLS*/
         LA    R7,BUF1RDW                                          0922
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/
         LA R12,INHIST
*    GEN(GET (R12),(R7)); /*RETRIEVE A RECORD. NOTE THAT RECORD WILL*/
         GET (R12),(R7)
*                       /*WILL BE HERE FOR RITE TO SCRATCH AND FOR*/
*                       /*WRITE TO ACCDEV                    @Z427VLS*/
*    R7 = R7 + 4; /*POINT PAST RDW FOR RETURN TO CALLER      @Z427VLS*/
         LA    @06,4                                               0925
         ALR   R7,@06                                              0925
*    FLIPFLOP = YES;  /*TELL READIRCT WHAT STORY IS          @Z427VLS*/
         OI    FLIPFLOP,B'00100000'                                0926
*    RECCCHHR = (RECCCHHR && RECCCHHR); /*SET TO ACCIN INPUT IN PARM*/
         L     @15,SAVER2                                          0927
         XC    RECCCHHR(5,@15),RECCCHHR(@15)                       0927
*    RECLNGTH = BUF1RDWL-4;  /*SET REC LTH IN PARM TABLE     @ZA32483*/
         LCR   @06,@06                                             0928
         AH    @06,BUF1RDWL                                        0928
         STH   @06,RECLNGTH(,@15)                                  0928
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO READHIST PROC                         @Z427VLS*/
@EL00024 DS    0H                                                  0930
@EF00024 DS    0H                                                  0930
@ER00024 LM    @14,@06,@SA00024                                    0930
         LM    @08,@12,@SA00024+36                                 0930
         BR    @14                                                 0930
*OPENDIR : PROC; /*OPEN DIRECTWK DATA SET FOR SEQUENTIAL LOAD*/    0931
OPENDIR  STM   @14,@12,@SA00025                                    0931
*RESPECIFY (R1,R2,R12,R3) RESTRICTED;                      /*@Z427VLS*/
*IF INDIR  = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/
         TM    INDIR,B'00100000'                                   0933
         BNZ   @RF00933                                            0933
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0935
         L     @15,SAVER2                                          0935
         TM    DEBUG15(@15),B'00000001'                            0935
         BNO   @RF00935                                            0935
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 63;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01074                                   0937
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0938
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,WORKWDCB); /*GET ADDRESS OF DCB              @Z427VLS*/
@RF00935 DS    0H                                                  0940
         LA R12,WORKWDCB
*    GEN(OPEN ((R12),(OUTPUT))); /*OPEN DIRECTWK TO LOAD SEQUENTIALLY*/
         OPEN ((R12),(OUTPUT))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BADBWSEQ);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/   0943
         BZ BADBWSEQ
*  GENERATE;                                               /*@Z427VLS*/
         L     R1,DCBIFLGS  FLGS NOT SET, ACTUALLY LOAD DCBEBAD
         LH    R1,46(R1) LOAD NUMBER OF TRACKS IN THIS EXTENT
         BCTR  R1,R0        SUBTRACT ONE FOR RELATIVE TRACK NUMBER
         STH   R1,MAXTRK   SAVE NUMBER OF TRACKS OF OVERFLOW CHECK
*INDIR = YES; /*SET SUCCESSFUL OPEN OF DIRECTWK FLAG         @Z427VLS*/
         OI    INDIR,B'00100000'                                   0945
*END;                                                      /*@Z427VLS*/
*ELSE /*IF DATA SET IS ALREADY OPEN                          @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00933                                            0947
@RF00933 DS    0H                                                  0948
*    BADNEWS = TWELVE; /*SET RETURN CODE TO ERROR            @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0948
*    MSGNO = 31;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF00042                                   0949
*    CALL ERRMSG; /*WRITE MESSAGE TO TOURIST DATA SET        @Z427VLS*/
         BAL   @14,ERRMSG                                          0950
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R1,R12,R2,R3) UNRESTRICTED;                    /*@Z427VLS*/
*END; /*CLOSING END TO OPENDIR PROC                          @Z427VLS*/
@EL00025 DS    0H                                                  0953
@EF00025 DS    0H                                                  0953
@ER00025 LM    @14,@12,@SA00025                                    0953
         BR    @14                                                 0953
*OPENHIST: PROC; /*OPEN ACCIN DATA SET                       @Z427VLS*/
OPENHIST STM   @14,@12,@SA00026                                    0954
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INHISO = NO THEN /*IF IT HASNT BEEN OPENED BEFORE        @Z427VLS*/
         TM    INHISO,B'00000001'                                  0956
         BNZ   @RF00956                                            0956
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0958
         L     @01,SAVER2                                          0958
         TM    DEBUG15(@01),B'00000001'                            0958
         BNO   @RF00958                                            0958
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 64;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF00709                                   0960
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0961
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,INHIST); /*GET ADDRESS OF DCB                @Z427VLS*/
@RF00958 DS    0H                                                  0963
         LA R12,INHIST
*    GEN(OPEN ((R12),(INPUT))); /*OPEN ACCIN                 @Z427VLS*/
         OPEN ((R12),(INPUT))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFUL          @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BDOIHST);  /*SET BAD RETURN CODE AND PRINT ERRMSG*/    0966
         BZ BDOIHST
*    GEN(TM DCBRECFM,DCBRECV); /*IS CORRECT FORMAT           @Z427VLS*/
         TM DCBRECFM,DCBRECV
*    GEN(BZ BDIST);    /*IF NOT, GO TELL WORLD, SET BAD R.C. @Z427VLS*/
         BZ BDIST
*    GEN(TM DCBRECFM,DCBRECU); /*IS RECFM U                  @Z427VLS*/
         TM DCBRECFM,DCBRECU
*    GEN(BO BDIST);                                        /*@Z427VLS*/
         BO BDIST
*    INHISO = YES; /*TELL OF SUCCESSFUL OPEN OF ACCIN        @Z427VLS*/
*    HISTYES = YES;                                        /*@Z427VLS*/
         OI    INHISO,B'00010001'                                  0972
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF OPEN ASKED WHEN ALREADY OPEN                      @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00956                                            0974
@RF00956 DS    0H                                                  0975
*    MSGNO = 11; /*TELL WHAT MESSAGE NUMBER TO PRINT         @Z427VLS*/
         MVC   MSGNO(4),@CF00032                                   0975
*    CALL ERRMSG; /*GO SELECT MESSAGE AND PRINT TO TOURIST   @Z427VLS*/
         BAL   @14,ERRMSG                                          0976
*    BADNEWS = TWELVE; /*TELL USER BAD NEWS                  @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 0977
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO OPEN HISTORY INPUT DATA SET PROC      @Z427VLS*/
@EL00026 DS    0H                                                  0980
@EF00026 DS    0H                                                  0980
@ER00026 LM    @14,@12,@SA00026                                    0980
         BR    @14                                                 0980
*CLOSHIST: PROC; /*CLOSE ACCIN DATA SET                      @Z427VLS*/
CLOSHIST STM   @14,@12,@SA00027                                    0981
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF INHISO = YES THEN /*IF DATA SET IS OPEN THEN             @Z427VLS*/
         TM    INHISO,B'00000001'                                  0983
         BNO   @RF00983                                            0983
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          0985
         L     @01,SAVER2                                          0985
         TM    DEBUG15(@01),B'00000001'                            0985
         BNO   @RF00985                                            0985
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 65;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01081                                   0987
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          0988
*      END;                                                /*@Z427VLS*/
*    GEN(LA  R12,INHIST); /*GET ACCIN DCB ADDRESS            @Z427VLS*/
@RF00985 DS    0H                                                  0990
         LA  R12,INHIST
*    GEN(CLOSE  (INHIST));         /*ISSUE CLOSE SVC         @Z427VLS*/
         CLOSE  (INHIST)
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCIN BUFFERS        @Z427VLS*/
         FREEPOOL  (R12)
*    INHISO = NO; /*SAY THAT ACCIN IS CLOSED                 @Z427VLS*/
         NI    INHISO,B'11111110'                                  0993
*  END;                                                    /*@Z427VLS*/
*ELSE  /*IF DATA SET IS ALREADY CLOSED                       @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC00983                                            0995
@RF00983 DS    0H                                                  0996
*    IF CLOSEIO ^= CLOSEALL THEN                                   0996
         L     @01,SAVER2                                          0996
         CLC   CLOSEIO(2,@01),@CB00262                             0996
         BE    @RF00996                                            0996
*    DO;                                                   /*@Z427VLS*/
*    MSGNO = 12;                                           /*@Z427VLS*/
         LA    @15,12                                              0998
         ST    @15,MSGNO                                           0998
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         ST    @15,BADNEWS                                         0999
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1000
*    END;                                                  /*@Z427VLS*/
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSE ACCIN DATA SET PROC             @Z427VLS*/
@EL00027 DS    0H                                                  1004
@EF00027 DS    0H                                                  1004
@ER00027 LM    @14,@12,@SA00027                                    1004
         BR    @14                                                 1004
*CLOSEDEV: PROC; /*PROC TO CLOSE ACCDEV DATA SET             @Z427VLS*/
CLOSEDEV STM   @14,@12,@SA00028                                    1005
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF HISTOPN = YES THEN                                             1007
         TM    HISTOPN,B'10000000'                                 1007
         BNO   @RF01007                                            1007
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1009
         L     @01,SAVER2                                          1009
         TM    DEBUG15(@01),B'00000001'                            1009
         BNO   @RF01009                                            1009
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 66;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01085                                   1011
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1012
*      END;                                                /*@Z427VLS*/
*    GEN(LA R12,OUTHIST); /*FIND ADDRESS OF DCB              @Z427VLS*/
@RF01009 DS    0H                                                  1014
         LA R12,OUTHIST
*    GEN(CLOSE (OUTHIST));       /*ISSUE CLOSE SVC           @Z427VLS*/
         CLOSE (OUTHIST)
*    GEN(FREEPOOL  (R12)); /*GET RID OF ACCDEV BUFFERS       @Z427VLS*/
         FREEPOOL  (R12)
*    HISTOPN = NO; /*SAY THAT DATA SET IS CLOSED             @Z427VLS*/
         NI    HISTOPN,B'01111111'                                 1017
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF ACCDEV IS ALREADY CLOSED                          @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01007                                            1019
@RF01007 DS    0H                                                  1020
*   IF CLOSEIO ^= CLOSEALL /*END OF JOB STEP VALID REQUEST   @Z427VLS*/
*     THEN DO;                                             /*@Z427VLS*/
         L     @01,SAVER2                                          1020
         CLC   CLOSEIO(2,@01),@CB00262                             1020
         BE    @RF01020                                            1020
*       MSGNO = 8;                                         /*@Z427VLS*/
         MVC   MSGNO(4),@CF00035                                   1022
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1023
*       CALL ERRMSG;                                       /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1024
*     END;                                                 /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC CLOSEDEV                         @Z427VLS*/
@EL00028 DS    0H                                                  1028
@EF00028 DS    0H                                                  1028
@ER00028 LM    @14,@12,@SA00028                                    1028
         BR    @14                                                 1028
*OPENTOUR : PROC; /*OPEN THE TOURIST DATA SET                @Z427VLS*/
OPENTOUR STM   @14,@12,@SA00029                                    1029
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/
*  IF TOUROPN = NO THEN /*ILLEGAL TO OPEN AN OPEN DATA SET   @Z427VLS*/
         TM    TOUROPN,B'00000010'                                 1031
         BNZ   @RF01031                                            1031
*    DO;                                                   /*@Z427VLS*/
*      GENERATE;                                           /*@Z427VLS*/
         LA    R12,TOURDCB
         OPEN  ((R12),(OUTPUT))
         TM    DCBOFLGS,OPENOK    CHECK FOR SUCCESS
         BZ    BADOTOUR
*      TOUROPN = YES; /*HURRAY FOR SUCCESSFUL OPEN           @Z427VLS*/
         OI    TOUROPN,B'00000010'                                 1034
*      PRINTADR = ADDR(PRNTBF);                            /*@Z427VLS*/
         LA    @06,PRNTBF                                          1035
         L     @01,SAVER2                                          1035
         ST    @06,PRINTADR(,@01)                                  1035
*      R7 = PRINTADR + 1;                                  /*@Z427VLS*/
         LA    R7,1                                                1036
         ALR   R7,@06                                              1036
*      PRINTCC = SKIPNEW;                                  /*@Z427VLS*/
         MVI   PRINTCC(@06),X'8B'                                  1037
*      GEN(PUT  (R12),(R7)); /*INITIAL SKIP TO NEW PAGE      @Z427VLS*/
         PUT  (R12),(R7)
*    END;                                                  /*@Z427VLS*/
* ELSE  /*IF TOURIST ALREADY OPEN THEN                       @Z427VLS*/
*   DO;                                                    /*@Z427VLS*/
         B     @RC01031                                            1040
@RF01031 DS    0H                                                  1041
*     MSGNO = 23;                                          /*@Z427VLS*/
         MVC   MSGNO(4),@CF01089                                   1041
*     CALL ERRMSG;                                         /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1042
*     BADNEWS = TWELVE;                                    /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1043
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12,R7) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENTOUR                         @Z427VLS*/
@EL00029 DS    0H                                                  1046
@EF00029 DS    0H                                                  1046
@ER00029 LM    @14,@12,@SA00029                                    1046
         BR    @14                                                 1046
*CLOSTOUR: PROC; /*CLOSE THE TOURIST DATA SET                @Z427VLS*/
CLOSTOUR STM   @14,@12,@SA00030                                    1047
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF TOUROPN = YES THEN /*IF REALLY NEEDS CLOSING             @Z427VLS*/
         TM    TOUROPN,B'00000010'                                 1049
         BNO   @RF01049                                            1049
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN /*PRINT SUMMARY OF IO OPERATIONS DURING RUN*/
         L     @01,SAVER2                                          1051
         TM    DEBUG15(@01),B'00000001'                            1051
         BNO   @RF01051                                            1051
*             DO J = 1 TO 11; /*PRINT ALL DEBUG15 TOTALS     @G51DGBB*/
         LA    @15,1                                               1052
         ST    @15,J                                               1052
@DL01052 DS    0H                                                  1053
*           MSGNO = J + 70; /*INCREMENT PAST SYSTEM MESSAGES @G51DGBB*/
         AL    @15,@CF00932                                        1053
         ST    @15,MSGNO                                           1053
*          CALL ERRMSG; /*PRINT OUT SUMMARY MESSAGE TEXT     @Z427VLS*/
         BAL   @14,ERRMSG                                          1054
*          PASSNUM = CTPTR(J); /*ACCESS PARTICULAR COUNT     @Z427VLS*/
         L     @15,J                                               1055
         SLA   @15,2                                               1055
         L     @15,CTPTR-4(@15)                                    1055
         ST    @15,PASSNUM                                         1055
*          CVD(PASSNUM,PACKPAS); /*CONVERT BINARY TO PACKED  @Z427VLS*/
         CVD   @15,@TS00001                                        1056
         MVC   PACKPAS(4),@TS00001+4                               1056
*          PACKPAS = (PACKPAS  '0000000F'X); /*TURN C TO F  @Z427VLS*/
         OC    PACKPAS(4),@CB01094                                 1057
*          UNPK(EDFLD,PACKPAS); /*CHANGE PACKED TO PRINTABLE @Z427VLS*/
         UNPK  EDFLD(9),PACKPAS(4)                                 1058
*          NONBLANK = OFF;                                 /*@Z427VLS*/
         NI    NONBLANK,B'11101111'                                1059
*          DO K = 1 BY 1 TO 8 WHILE NONBLANK = OFF;        /*@Z427VLS*/
         LA    @15,1                                               1060
         ST    @15,K                                               1060
@DL01060 TM    NONBLANK,B'00010000'                                1060
         BNZ   @DC01060                                            1060
*            IF EDIFILD(K) = CHARZERO THEN                         1061
         LA    @14,EDIFILD-1(@15)                                  1061
         CLI   0(@14),X'F0'                                        1061
         BNE   @RF01061                                            1061
*              EDIFILD(K) = BLANK;                         /*@Z427VLS*/
         LA    @14,EDIFILD-1(@15)                                  1062
         MVI   0(@14),X'40'                                        1062
*            ELSE                                                  1063
*              NONBLANK = ON;                              /*@Z427VLS*/
         B     @RC01061                                            1063
@RF01061 OI    NONBLANK,B'00010000'                                1063
*          END;                                            /*@Z427VLS*/
@RC01061 LA    @15,1                                               1064
         AL    @15,K                                               1064
         ST    @15,K                                               1064
         C     @15,@CF00035                                        1064
         BNH   @DL01060                                            1064
@DC01060 DS    0H                                                  1065
*          PRINTADR = ADDR(PRNTBF);                        /*@Z427VLS*/
         LA    @15,PRNTBF                                          1065
         L     @14,SAVER2                                          1065
         ST    @15,PRINTADR(,@14)                                  1065
*          PRINTDS = '1'; /*INDICATE PRINT TO TOURIST        @Z427VLS*/
         MVI   PRINTDS(@15),C'1'                                   1066
*          PRINTBDY = (PRINTBDY && PRINTBDY);              /*@Z427VLS*/
         XC    PRINTBDY(132,@15),PRINTBDY(@15)                     1067
*          GEN(MVC PRNTBF+10(9),EDFLD);                    /*@Z427VLS*/
         MVC PRNTBF+10(9),EDFLD
*          CALL PRINTIT;                                   /*@Z427VLS*/
         BAL   @14,PRINTIT                                         1069
*        END;                                              /*@Z427VLS*/
         LA    @15,1                                               1070
         AL    @15,J                                               1070
         ST    @15,J                                               1070
         C     @15,@CF00032                                        1070
         BNH   @DL01052                                            1070
*    GENERATE;                                             /*@Z427VLS*/
@RF01051 DS    0H                                                  1071
         LA    R12,TOURDCB
         CLOSE (TOURDCB)
         FREEPOOL (12)
*    TOUROPN = NO; /*INDICATE CLOSE                          @Z427VLS*/
         NI    TOUROPN,B'11111101'                                 1072
* END;                                                     /*@Z427VLS*/
*ELSE /*IF ALREADY CLOSED THEN                               @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01049                                            1074
@RF01049 DS    0H                                                  1075
*   IF CLOSEIO ^= CLOSEALL THEN /*LEGAL TO DO END OF JOB WRAPUP*/  1075
         L     @15,SAVER2                                          1075
         CLC   CLOSEIO(2,@15),@CB00262                             1075
         BE    @RF01075                                            1075
*     DO;                                                  /*@Z427VLS*/
*       R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2    @ZA31549*/
         LR    R2,@15                                              1077
*       CALL IFCMSG(204,ADDR(PRNTBF));                     /*@Z427VLS*/
         LA    @14,PRNTBF                                          1078
         ST    @14,@AFTEMPS+12                                     1078
         L     @15,ADIFCMSG(,@15)                                  1078
         LA    @01,@AL01078                                        1078
         BALR  @14,@15                                             1078
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1079
*     END;                                                 /*@Z427VLS*/
* END;                                                     /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSTOUR PROCEDURE                    @Z427VLS*/
@EL00030 DS    0H                                                  1083
@EF00030 DS    0H                                                  1083
@ER00030 LM    @14,@12,@SA00030                                    1083
         BR    @14                                                 1083
*OPENERPT: PROC; /*OPEN THE ERREPT D.S. FOR PRINTING         @Z427VLS*/
OPENERPT STM   @14,@12,@SA00031                                    1084
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF ERPTOPN = NO THEN                                              1086
         TM    ERPTOPN,B'00000001'                                 1086
         BNZ   @RF01086                                            1086
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1088
         L     @01,SAVER2                                          1088
         TM    DEBUG15(@01),B'00000001'                            1088
         BNO   @RF01088                                            1088
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 67;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01100                                   1090
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1091
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF01088 DS    0H                                                  1093
         LA    R12,EREPTDCB
         OPEN  ((R12),(OUTPUT))
         TM    DCBOFLGS,OPENOK
         BZ    BADORPT
*    ERPTOPN = YES; /*INDICATE SUCCESSFUL OPEN               @Z427VLS*/
         OI    ERPTOPN,B'00000001'                                 1094
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF OPEN REQUESTED WHEN DATA SET ALREADY OPEN         @Z427VLS*/
*  DO;                                                     /*@Z427VLS*/
         B     @RC01086                                            1096
@RF01086 DS    0H                                                  1097
*    MSGNO = 45;                                           /*@Z427VLS*/
         MVC   MSGNO(4),@CF01101                                   1097
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1098
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1099
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENERPT                         @Z427VLS*/
@EL00031 DS    0H                                                  1102
@EF00031 DS    0H                                                  1102
@ER00031 LM    @14,@12,@SA00031                                    1102
         BR    @14                                                 1102
*CLOSERPT : PROC; /*OPEN ERREPT DATA SET                     @Z427VLS*/
CLOSERPT STM   @14,@12,@SA00032                                    1103
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF ERPTOPN = YES THEN /*MUST BE OPEN IN ORDER TO CLOSE      @Z427VLS*/
         TM    ERPTOPN,B'00000001'                                 1105
         BNO   @RF01105                                            1105
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1107
         L     @01,SAVER2                                          1107
         TM    DEBUG15(@01),B'00000001'                            1107
         BNO   @RF01107                                            1107
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 68;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01105                                   1109
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1110
*      END;                                                /*@Z427VLS*/
*    GENERATE;                                             /*@Z427VLS*/
@RF01107 DS    0H                                                  1112
         LA    R12,EREPTDCB
         CLOSE (EREPTDCB)
         FREEPOOL (R12)
*    ERPTOPN = NO; /*INDICATE ERREPT IS CLOSED               @Z427VLS*/
         NI    ERPTOPN,B'11111110'                                 1113
*  END;                                                    /*@Z427VLS*/
*ELSE /*IF CLOSE REQUESTED WHEN NOT OPEN THEN                @Z427VLS*/
* DO;                                                      /*@Z427VLS*/
         B     @RC01105                                            1115
@RF01105 DS    0H                                                  1116
*   IF CLOSEIO ^= CLOSEALL THEN  /*VALID POTPOURI OF CLOSES  @Z427VLS*/
         L     @01,SAVER2                                          1116
         CLC   CLOSEIO(2,@01),@CB00262                             1116
         BE    @RF01116                                            1116
*     DO;                                                  /*@Z427VLS*/
*       MSGNO = 22;                                        /*@Z427VLS*/
         MVC   MSGNO(4),@CF01106                                   1118
*       CALL ERRMSG;                                       /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1119
*       BADNEWS = TWELVE;                                  /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1120
*     END;                                                 /*@Z427VLS*/
*   END;                                                   /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO CLOSERPT PROC                         @Z427VLS*/
@EL00032 DS    0H                                                  1124
@EF00032 DS    0H                                                  1124
@ER00032 LM    @14,@12,@SA00032                                    1124
         BR    @14                                                 1124
*OPENDEV: PROC; /*OPEN ACCDEV DATA SET                       @Z427VLS*/
OPENDEV  STM   @14,@12,@SA00033                                    1125
*RESPECIFY (R12) RESTRICTED;                               /*@Z427VLS*/
*IF HISTOPN = NO THEN /*IF DATA SET HAS NOT ALREADY BEEN OPENED*/  1127
         TM    HISTOPN,B'10000000'                                 1127
         BNZ   @RF01127                                            1127
*  DO;                                                     /*@Z427VLS*/
*    IF DEBUG15 = ON THEN                                          1129
         L     @01,SAVER2                                          1129
         TM    DEBUG15(@01),B'00000001'                            1129
         BNO   @RF01129                                            1129
*      DO;                                                 /*@Z427VLS*/
*        MSGNO = 69;                                       /*@Z427VLS*/
         MVC   MSGNO(4),@CF01110                                   1131
*        CALL ERRMSG;                                      /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1132
*      END;                                                /*@Z427VLS*/
*    GEN(LA (R12),OUTHIST); /*FIND ADDRESS OF DCB            @Z427VLS*/
@RF01129 DS    0H                                                  1134
         LA (R12),OUTHIST
*    GEN(OPEN ((R12),(OUTPUT,DISP))); /*ISSUE OPEN SVC       @Z427VLS*/
         OPEN ((R12),(OUTPUT,DISP))
*    GEN(TM DCBOFLGS,OPENOK); /*WAS OPEN SUCCESSFULL         @Z427VLS*/
         TM DCBOFLGS,OPENOK
*    GEN(BZ BADOOHST); /*GO TO ERROR ROUTINE                 @Z427VLS*/
         BZ BADOOHST
*    HISTOPN = YES;                                        /*@Z427VLS*/
         OI    HISTOPN,B'10000000'                                 1138
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              1140
*  DO;                                                     /*@Z427VLS*/
         B     @RC01127                                            1140
@RF01127 DS    0H                                                  1141
*    MSGNO = 2;                                            /*@Z427VLS*/
         MVC   MSGNO(4),@CF00075                                   1141
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1142
*    BADNEWS = TWELVE; /*ABORT RETURN CODE                   @Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1143
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R12) UNRESTRICTED;                             /*@Z427VLS*/
*END; /*CLOSING END TO PROC OPENDEV                          @Z427VLS*/
@EL00033 DS    0H                                                  1146
@EF00033 DS    0H                                                  1146
@ER00033 LM    @14,@12,@SA00033                                    1146
         BR    @14                                                 1146
*HISTIT: PROC; /*WRITE TO ACCDEV USING QSAM                  @Z427VLS*/
HISTIT   STM   @14,@12,@SA00034                                    1147
*RESPECIFY (R12,R7) RESTRICTED;                            /*@Z427VLS*/
*IF HISTOPN = YES THEN                                             1149
         TM    HISTOPN,B'10000000'                                 1149
         BNO   @RF01149                                            1149
*  DO;                                                     /*@Z427VLS*/
*    DEVCT = DEVCT + 1;                                    /*@Z427VLS*/
         LA    @06,1                                               1151
         AL    @06,DEVCT                                           1151
         ST    @06,DEVCT                                           1151
*    GEN(LA (R12),OUTHIST); /*GET DCB ADDRESS                @Z427VLS*/
         LA (R12),OUTHIST
*    R7 = ADDR(BUF1RDW); /*ADDRESS THE RECORD DESCRIPTOR WORD*/    1153
         LA    R7,BUF1RDW                                          1153
*    IF SCRATCH = YES THEN /*IF FRAMES FROM DIRECTWK, MUST FIX REC*/
         TM    SCRATCH,B'01000000'                                 1154
         BNO   @RF01154                                            1154
*      DO;                 /*ORD DESCRIPTOR WORD BECAUSE IT WAS   */
*                          /*MANGLED FOR EDSUM MODULES       @G51DGBB*/
*        BUF1RDWL = BUF1L + 4; /*RE-ADD RDW LENGTH, MOVE TO RDW   */
         LH    @06,BUF1L                                           1156
         LA    @06,4(,@06)                                         1156
         STH   @06,BUF1RDWL                                        1156
*        BUF1L = '0000'X;      /*FINISH RDW RIGHTMOST TWO BYTES   */
         SLR   @06,@06                                             1157
         STH   @06,BUF1L                                           1157
*        R7 = ADDR(BUF1);      /*POINT TO RECORD FOR QSAM PUT     */
         LA    R7,BUF1                                             1158
*      END;                                                /*@G51DGBB*/
*    ELSE   /*RECORD NOT RETRIEVED FROM DIRECTWK             @G51DGBB*/
*      IF FLIPFLOP = OFF THEN /*IF RECORD FROM READSEQ OF LOGREC*/ 1160
         B     @RC01154                                            1160
@RF01154 TM    FLIPFLOP,B'00100000'                                1160
         BNZ   @RF01160                                            1160
*        DO;                                               /*@G51DGBB*/
*          BBRDW = SAVELENT; /*GET UNMODIFIED QSAM LENGTH    @G51DGBB*/
         LH    @06,SAVELENT                                        1162
         STH   @06,BBRDW                                           1162
*          BSIZE = '0000'X; /*COMPLETE RDW                   @G51DGBB*/
         MVC   BSIZE(2),@CB00209                                   1163
*          R7 = ADDR(BBRDW);                               /*@G51DGBB*/
         LA    R7,BBRDW                                            1164
*        END;                                              /*@G51DGBB*/
*    GEN(PUT  (R12),(R7)); /*ISSUE WRITE SVC USING QSAM      @Z427VLS*/
@RF01160 DS    0H                                                  1166
@RC01154 DS    0H                                                  1166
         PUT  (R12),(R7)
*  END;                                                    /*@Z427VLS*/
*ELSE                                                              1168
*  DO;                                                     /*@Z427VLS*/
         B     @RC01149                                            1168
@RF01149 DS    0H                                                  1169
*    BADNEWS = TWELVE;                                     /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1169
*    MSGNO = 4;                                            /*@Z427VLS*/
         MVC   MSGNO(4),@CF00065                                   1170
*    CALL ERRMSG;                                          /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1171
*  END;                                                    /*@Z427VLS*/
*RESPECIFY (R7,R12) UNRESTRICTED;                          /*@Z427VLS*/
*END; /*CLOSING END TO PROC HISTIT                           @Z427VLS*/
@EL00034 DS    0H                                                  1174
@EF00034 DS    0H                                                  1174
@ER00034 LM    @14,@12,@SA00034                                    1174
         BR    @14                                                 1174
*/*PROC TO CONVERT HEX DAT INTO PRINTABLE FORMAT             @Z427VLS*/
*/* ITEM NUMBER IS NUMBER OF BYTES TO BE CONVERTED           @Z427VLS*/
*/* ITEM NEXTBY IS THE ADDRESS OF THE DATA TO BE CONVERTED   @Z427VLS*/
*/* ITEM ADDNXT IS THE LOCATION WHERE THE CONVERTED DATA IS TO BE PUT*/
*CONVERT: PROC;                                            /*@Z427VLS*/
CONVERT  STM   @14,@12,12(@13)                                     1175
*RESPECIFY (R2,R3) RESTRICTED;                             /*@Z427VLS*/
*DO J = NUMBER BY -1 TO 1;                                 /*@Z427VLS*/
         L     @12,NUMBER                                          1177
         ST    @12,J                                               1177
         B     @DE01177                                            1177
@DL01177 DS    0H                                                  1178
*  R2 = NEXTBYTE(J);                                       /*@Z427VLS*/
         L     @01,NEXTBY                                          1178
         BCTR  @01,0                                               1178
         SLR   R2,R2                                               1178
         IC    R2,NEXTBYTE(@12,@01)                                1178
*  K  = 2 * J;                                             /*@Z427VLS*/
         LR    @15,@12                                             1179
         ALR   @15,@15                                             1179
         ST    @15,K                                               1179
*  SRDL(R2,4);                                             /*@Z427VLS*/
         SRDL  R2,4                                                1180
*  SRL(R3,28);                                             /*@Z427VLS*/
         SRL   R3,28                                               1181
*  R3 = R3 + 1;                                            /*@Z427VLS*/
         LA    @14,1                                               1182
         ALR   R3,@14                                              1182
*  R2 = R2 + 1;                                            /*@Z427VLS*/
         ALR   R2,@14                                              1183
*  ADDNUM(K-1) = CHARS(R2);                                /*@Z427VLS*/
         L     @14,ADDNXT                                          1184
         ALR   @15,@14                                             1184
         BCTR  @15,0                                               1184
         BCTR  @15,0                                               1184
         LA    @01,CHARS-1(R2)                                     1184
         MVC   ADDNUM(1,@15),0(@01)                                1184
*  ADDNUM(K) = CHARS(R3);                                  /*@Z427VLS*/
         L     @15,K                                               1185
         ALR   @14,@15                                             1185
         BCTR  @14,0                                               1185
         LA    @15,CHARS-1(R3)                                     1185
         MVC   ADDNUM(1,@14),0(@15)                                1185
*END;                                                      /*@Z427VLS*/
         BCTR  @12,0                                               1186
         ST    @12,J                                               1186
@DE01177 LTR   @12,@12                                             1186
         BP    @DL01177                                            1186
*RESPECIFY (R2,R3) UNRESTRICTED;                           /*@Z427VLS*/
*END; /*CLOSING END TO PROC CONVERT                          @Z427VLS*/
@EL00035 DS    0H                                                  1188
@EF00035 DS    0H                                                  1188
@ER00035 LM    @14,@12,12(@13)                                     1188
         BR    @14                                                 1188
*BADORPT:  ; /*ERREPT  UNSUCCESSFUL OPEN                     @Z427VLS*/
BADORPT  DS    0H                                                  1190
*MSGNO = 44;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01121                                   1190
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1191
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1192
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1193
*BADOTOUR: ; /*TOURIST UNSUCCESSFUL OPEN                     @Z427VLS*/
BADOTOUR DS    0H                                                  1195
*R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2           @ZA31549*/
         L     @12,SAVER2                                          1195
         LR    R2,@12                                              1195
* CALL IFCMSG(205,ADDR(PRNTBF));                           /*@Z427VLS*/
         LA    @15,PRNTBF                                          1196
         ST    @15,@AFTEMPS+16                                     1196
         L     @15,ADIFCMSG(,@12)                                  1196
         LA    @01,@AL01196                                        1196
         BALR  @14,@15                                             1196
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1197
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1198
*HISTBAD:  ; /*ERROR EXIT WRITING TO ACCDEV                  @Z427VLS*/
HISTBAD  DS    0H                                                  1200
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=QSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1201
*MSGNO = 6;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00082                                   1202
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1203
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1204
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1205
*HISTEND:  ; /*EOF EXIT FOR READING ACCIN                    @Z427VLS*/
HISTEND  DS    0H                                                  1207
*CALL CLOSHIST;                                            /*@Z427VLS*/
         BAL   @14,CLOSHIST                                        1207
*IF SERLO = ON THEN /*IF SERLOG IS ALSO ON WE MUST READ IT ALSO*/  1208
         TM    SERLO,B'10000000'                                   1208
         BNO   @RF01208                                            1208
* DO;                                                      /*@Z427VLS*/
*  CALL READSER; /*WILL START READING SERLOG SEQUENTIALLY THERE*/  1210
         BAL   @14,READSER                                         1210
*  GOTO GOBACK;   /*RETURN TO CALLER                         @Z427VLS*/
         B     GOBACK                                              1211
* END;                                                     /*@Z427VLS*/
*ELSE                                                              1213
*  DO;                                                     /*@Z427VLS*/
@RF01208 DS    0H                                                  1214
*    BADNEWS = FOUR; /*INDICATE EOF ON SEQUENTIAL DATA       @Z427VLS*/
         MVC   BADNEWS(4),@CF00065                                 1214
*    GOTO GOBACK;                                          /*@Z427VLS*/
         B     GOBACK                                              1215
*  END;                                                    /*@Z427VLS*/
*HISTINBD:  ; /*ERROR EXIT FOR READING ACCIN                 @Z427VLS*/
HISTINBD DS    0H                                                  1218
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=QSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1219
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1220
*MSGNO =7;                                                 /*@Z427VLS*/
         MVC   MSGNO(4),@CF00037                                   1221
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1222
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1223
*BADBRSEQ: ; /*CANT OPEN DIRECTWK FOR READ EXIT              @Z427VLS*/
BADBRSEQ DS    0H                                                  1225
*MSGNO = 30;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01134                                   1225
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1226
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1227
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1228
*BADOPENA: ; /*SERLOG OPEN FAILED EXIT                       @Z427VLS*/
BADOPENA DS    0H                                                  1230
*GEN(DEQ   (RESID,LOGRECA,11,STEP)); /*STEP DEQUEUE          @Z427VLS*/
         DEQ   (RESID,LOGRECA,11,STEP)
*MSGNO = 13;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01137                                   1231
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1232
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1233
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1234
*BADBWSEQ:  ; /*ERROR EXIT IF CANT OPEN DIRECTWK FOR WRITING @Z427VLS*/
BADBWSEQ DS    0H                                                  1236
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1236
*MSGNO = 27;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01140                                   1237
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1238
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1239
*BDIST: ; /*IMPROPER RECORD FORMAT EXIT FOR ACCIN            @Z427VLS*/
BDIST    DS    0H                                                  1241
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1241
*MSGNO = 10;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF00033                                   1242
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1243
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1244
*BDOIHST: ;  /*CANT OPEN ACCIN EXIT                          @Z427VLS*/
BDOIHST  DS    0H                                                  1246
*MSGNO = 9;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00034                                   1246
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1247
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1248
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1249
*BADRDIR: ; /*SYNAD FOR READING DIRECTWK D.S. SEQUENTIALLY WITH POINT*/
BADRDIR  DS    0H                                                  1251
* GEN(SYNADAF  ACSMETH=BSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=BSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1252
*MSGNO = 42;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01147                                   1253
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1254
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1255
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1256
*BADOOHST: ; /*CANT OPEN ACCDEV EXIT                         @Z427VLS*/
BADOOHST DS    0H                                                  1258
*MSGNO = 3;                                                /*@Z427VLS*/
         MVC   MSGNO(4),@CF00077                                   1258
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1259
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1260
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1261
*SYSOBAD: ;                                                /*@Z427VLS*/
SYSOBAD  DS    0H                                                  1263
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1263
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1264
*SYSBAD: ;                                                 /*@Z427VLS*/
SYSBAD   DS    0H                                                  1266
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=QSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1267
*MSGNO = 36; /*SYSIN READ ERROR                              @Z427VLS*/
         MVC   MSGNO(4),@CF01154                                   1268
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1269
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1270
*GOTO GOBACK;                                              /*@Z427VLS*/
*OVERFLOW: ;                                               /*@Z427VLS*/
OVERFLOW DS    0H                                                  1273
*MSGNO = 37;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01157                                   1273
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1274
*MSGNO = 38;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01158                                   1275
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1276
*PRINTADR = ADDR(PRNTBF);                                  /*@Z427VLS*/
         LA    @12,PRNTBF                                          1277
         L     @01,SAVER2                                          1277
         ST    @12,PRINTADR(,@01)                                  1277
*PRINTDS = 'F1'X;                                          /*@Z427VLS*/
         MVI   PRINTDS(@12),X'F1'                                  1278
*PRINTCC = '09'X;                                          /*@Z427VLS*/
         MVI   PRINTCC(@12),X'09'                                  1279
*NUMBER = 40; /*NUMBER OF BYTES OF LAST RECORD WRITTEN TO BE PRINTED*/
         MVC   NUMBER(4),@CF00471                                  1280
*NEXTBY = R7 + 4; /*ADDRESS OF RECORD PAST RECORD LENGTH     @Z427VLS*/
         LA    @06,4                                               1281
         ALR   @06,R7                                              1281
         ST    @06,NEXTBY                                          1281
*ADDNXT = PRINTADR + 2; /*PUT PRINTABLE NUMBER HERE IN PRINT BUFFER*/
         AL    @12,@CF00075                                        1282
         ST    @12,ADDNXT                                          1282
*CALL CONVERT; /*CONVERT HEXIDECIMAL RECORD HEADER TO PRINTABLE*/  1283
         BAL   @14,CONVERT                                         1283
*CALL PRINTIT; /*WRITE RECORD LAST PROCESSED TO THE TOURIST DATA SET*/
         BAL   @14,PRINTIT                                         1284
*BADNEWS = 8;                                              /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00035                                 1285
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1286
*SYSEOF: ;                                                 /*@Z427VLS*/
SYSEOF   DS    0H                                                  1288
*BADNEWS = FOUR;                                           /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00065                                 1288
*GOTO GOBACK;                                              /*@Z427VLS*/
         B     GOBACK                                              1289
*PRINTBAD: ;                                               /*@Z427VLS*/
PRINTBAD DS    0H                                                  1291
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=QSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1292
*MSGNO = 18;                                               /*@Z427VLS*/
         MVC   MSGNO(4),@CF01164                                   1293
*CALL ERRMSG;                                              /*@Z427VLS*/
         BAL   @14,ERRMSG                                          1294
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1295
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1296
*TOURBAD: ;                                                /*@Z427VLS*/
TOURBAD  DS    0H                                                  1298
* GEN(SYNADAF  ACSMETH=QSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=QSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1299
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
         MVC   BADNEWS(4),@CF00068                                 1300
*R2 = SAVER2;    /*INSURE COMTABLE ADDRESSED BY R2           @ZA31549*/
         L     @12,SAVER2                                          1301
         LR    R2,@12                                              1301
*CALL IFCMSG(202,ADDR(PRNTBF));                            /*@Z427VLS*/
         LA    @15,PRNTBF                                          1302
         ST    @15,@AFTEMPS+16                                     1302
         L     @15,ADIFCMSG(,@12)                                  1302
         LA    @01,@AL01302                                        1302
         BALR  @14,@15                                             1302
* GOTO GOOUT;                       /* RETURN TO SUPERVISOR  @ZA28682*/
         B     GOOUT                                               1303
*WRITEERR:;                                                /*@Z427VLS*/
WRITEERR DS    0H                                                  1305
* GEN(SYNADAF  ACSMETH=BSAM);       /* GET OWN SAVE AREA     @ZA28682*/
         SYNADAF  ACSMETH=BSAM
* SAVER14 = R14;                    /* SAVE RETURN ADDRESS   @ZA28682*/
         ST    R14,SAVER14                                         1306
* GOOUT:;                           /* RETURN TO SUPERVISOR  @ZA28682*/
GOOUT    DS    0H                                                  1308
*  RESPECIFY(R15) RESTRICTED;       /* USE R15 FOR RET CODE  @ZA28682*/
*  R15 = BADNEWS;                   /* GET RETURN CODE       @ZA28682*/
         L     R15,BADNEWS                                         1309
*  IF  R15 > FOUR THEN              /* MORE THAN ONE REQ     @ZA28682*/
         C     R15,@CF00065                                        1310
         BNH   @RF01310                                            1310
*   ERRORENT = ERRORENT + 1;        /* CAN NOT DO            @ZA28682*/
         LA    @14,1                                               1311
         AL    @14,ERRORENT                                        1311
         ST    @14,ERRORENT                                        1311
*  R14 = SAVER14;                   /* RESTORE SPVR RET ADR  @ZA28682*/
@RF01310 L     R14,SAVER14                                         1312
*  GEN(SYNADRLS );                  /* RSTR SPVR REGS        @ZA28682*/
         SYNADRLS
* RETURN;                           /* RETURN TO SUPERVISOR  @ZA28682*/
         B     @EL00001                                            1314
*MSGNO = 26;                                               /*@Z427VLS*/
*CALL ERRMSG;                                              /*@Z427VLS*/
*BADNEWS = TWELVE;                                         /*@Z427VLS*/
*GO TO GOBACK;                                             /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/*      BLOCK GENERATE FOR CONTROL BLOCKS & DSECT           @Z427VLS*/
*/*                                                          @Z427VLS*/
*GENERATE ;                                                /*@Z427VLS*/
OUTHIST  DCB   MACRF=(PM),SYNAD=HISTBAD,LRECL=2000,                    C
               DSORG=PS,DDNAME=ACCDEV,BUFNO=2
INHIST   DCB   MACRF=(GM),DSORG=PS,DDNAME=ACCIN,LRECL=2000,            C
               EODAD=HISTEND,SYNAD=HISTINBD,BUFNO=2
LOGREC   DCB   MACRF=(E),IOBAD=XIOB,DSORG=DA,DEVD=DA,RECFM=U,          C
               DDNAME=SERLOG
* DIRECTWK IS READ WITH THE FIRST DCB USING NOTE LOGIC AND READ WITH
* THE SECOND DCB USING POINT LOGIC
* A CLOSE TO THE FIRST DCB MUST BE ISSUED BEFORE USING THE SECOND
WORKWDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C
               MACRF=(WP),RECFM=V,SYNAD=WRITEERR
WORKRDCB DCB   DDNAME=DIRECTWK,DEVD=DA,DSORG=PS,BLKSIZE=2000,          C
               MACRF=(RP),RECFM=V,SYNAD=BADRDIR
SYSDCB   DCB   DDNAME=SYSIN,DEVD=DA,DSORG=PS,EODAD=SYSEOF,             C
               LRECL=80,MACRF=GM,SYNAD=SYSBAD,EXLST=BLKEXIT
* NOTE THAT EREPPT COMMAND CHARACTERS HAVE FLUCTUATED BETWEEN ANSI AND
* MACHINE CHARACTERS.
EREPTDCB DCB   MACRF=(PM),SYNAD=PRINTBAD,LRECL=133,DDNAME=EREPPT,      C
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT
TOURDCB  DCB   MACRF=(PM),SYNAD=TOURBAD,LRECL=133,DDNAME=TOURIST,      C
               DEVD=DA,DSORG=PS,RECFM=FBM,EXLST=BLKEXIT
BLKEXIT  DS    0F                         ALIGN ON A FULLWORD
         DC    AL1(128+5),AL3(ADDBLKSZ)   DCB OPEN EXIT
ADDBLKSZ EQU   *
         USING IHADCB,1
         OC    DCBBLKSI(2),DCBBLKSI   BLKSIZE SPECIFIED
         BNZR  R14                    YES...RETURN
         MVC   DCBBLKSI(2),DCBLRECL   DEFAULT BLKSIZE = LRECL
         BR    R14                    RETURN
         DROP  1
*GENERATE DATA ;                                           /*@Z427VLS*/
*/********************************************************************/
*RESPECIFY (R7,R15) UNRESTRICTED;                          /*@Z427VLS*/
*        END  /*CLOSING END TO EXTERNAL PROC IFCIOHND        @Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 1322
         B     @EL00001                                            1322
@DATA    DS    0H
@CH00080 DC    H'5'
@CH00671 DC    H'20'
@CH00925 DC    H'1944'
@CH01016 DC    H'-1'
         DS    0F
@AL00337 DC    A(@CF00947)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00687 DC    A(MSGNO)                LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00717 DC    A(@CF01028)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00761 DC    A(@CF01028)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
@AL01078 DC    A(@CF01096)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+12)
@AL01196 DC    A(@CF01124)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+16)
@AL01302 DC    A(@CF01167)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+16)
         DS    0F
@SA00001 DS    18F
@SA00023 DS    14F
@SA00021 DS    14F
@SA00034 DS    15F
@SA00019 DS    15F
@SA00015 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00018 DS    14F
@SA00014 DS    15F
@SA00002 DS    15F
@SA00003 DS    14F
@SA00007 DS    15F
@SA00008 DS    15F
@SA00004 DS    14F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00029 DS    15F
@SA00031 DS    15F
@SA00026 DS    15F
@SA00033 DS    15F
@SA00016 DS    15F
@SA00025 DS    15F
@SA00032 DS    15F
@SA00027 DS    15F
@SA00028 DS    15F
@SA00017 DS    15F
@SA00022 DS    15F
@SA00011 DS    15F
@SA00030 DS    15F
@SA00013 DS    15F
@SA00012 DS    15F
@SA00020 DS    14F
@SA00024 DS    14F
@AFTEMPS DS    5F
         DS    0F
@CF00056 DC    F'1'
@CH00056 EQU   @CF00056+2
@CF00075 DC    F'2'
@CH00075 EQU   @CF00075+2
@CF00077 DC    F'3'
@CH00077 EQU   @CF00077+2
@CF00065 DC    F'4'
@CH00065 EQU   @CF00065+2
@CF00082 DC    F'6'
@CH00082 EQU   @CF00082+2
@CF00037 DC    F'7'
@CH00037 EQU   @CF00037+2
@CF00035 DC    F'8'
@CF00034 DC    F'9'
@CH00034 EQU   @CF00034+2
@CF00033 DC    F'10'
@CF00032 DC    F'11'
@CF00068 DC    F'12'
@CF01137 DC    F'13'
@CF00768 DC    F'14'
@CF00036 DC    F'15'
@CF00089 DC    F'16'
@CF00993 DC    F'17'
@CF01164 DC    F'18'
@CF01032 DC    F'19'
@CF01067 DC    F'21'
@CF01106 DC    F'22'
@CF01089 DC    F'23'
@CF00940 DC    F'25'
@CF01140 DC    F'27'
@CF01049 DC    F'28'
@CF00544 DC    F'29'
@CF01134 DC    F'30'
@CF00042 DC    F'31'
@CF00531 DC    F'32'
@CF01037 DC    F'33'
@CF01041 DC    F'34'
@CF01045 DC    F'35'
@CF01154 DC    F'36'
@CF01157 DC    F'37'
@CF01158 DC    F'38'
@CF00933 DC    F'39'
@CF00471 DC    F'40'
@CH00471 EQU   @CF00471+2
@CF00953 DC    F'41'
@CF01147 DC    F'42'
@CF01121 DC    F'44'
@CF01101 DC    F'45'
@CF01054 DC    F'46'
@CF00935 DC    F'47'
@CF00946 DC    F'48'
@CF00962 DC    F'49'
@CF00296 DC    F'50'
@CF01011 DC    F'51'
@CH01011 EQU   @CF01011+2
@CF01026 DC    F'52'
@CF00952 DC    F'53'
@CF00961 DC    F'54'
@CF00945 DC    F'55'
@CF01007 DC    F'56'
@CF01008 DC    F'57'
@CF01015 DC    F'58'
@CF01036 DC    F'59'
@CF00841 DC    F'60'
@CF01061 DC    F'61'
@CF01062 DC    F'62'
@CF01074 DC    F'63'
@CF00709 DC    F'64'
@CF01081 DC    F'65'
@CF01085 DC    F'66'
@CF01100 DC    F'67'
@CF01105 DC    F'68'
@CF01110 DC    F'69'
@CF00932 DC    F'70'
@CF00947 DC    F'201'
@CF01167 DC    F'202'
@CF01028 DC    F'203'
@CF01096 DC    F'204'
@CF01124 DC    F'205'
@CF01180 DC    XL4'0000FFFF'
         DS    0D
SAVER2   DC    A(0)
PTRSPOT  DC    A(0)
SAVEPTR  DC    A(0)
FRSPTR   DC    A(0)
RUNPTR   DC    A(0)
SAVER14  DC    A(0)
A        DC    F'0'
K        DC    F'0'
J        DC    F'0'
GETHIS   DC    F'0'
R7SAVE   DC    F'0'
TIMEBASE DC    A(0)
NEXTBY   DC    F'0'
ADDNXT   DC    F'0'
NUMBER   DC    F'0'
MSGNO    DC    F'0'
BADNEWS  DC    F'0'
PASSNUM  DC    F'0'
XWRECB   DC    F'0'
         ORG   XWRECB
POST     DS    CL1
@NM00017 DS    CL3
         ORG   XWRECB+4
MILLION  DC    F'1000000'
TWENTY4  DC    F'24'
SIXTY    DC    F'60'
CONSTG   DC    XL4'30040'
CONSTH   DC    XL4'24AE062'
SIXTYMIL DC    F'60000000'
THCONV   DC    F'10000'
TIMDIV   DS    F
SAVELNGT DC    H'0'
LINECTT  DC    H'0'
LINEMAX  DC    H'0'
SDRK     DC    H'0'
SAVELENT DC    H'0'
         DS    0D
@TS00001 DS    CL8
@CC01027 DC    C'1 '
@CB00120 DC    X'00000000'
@CB00532 DC    X'00000007'
@CB01094 DC    X'0000000F'
@CB00209 EQU   @CB00120
@CB00262 DC    X'FFFF'
@CB00983 DC    X'000F'
CARDSPOT DC    CL80' '
         DS    CL2
MAXTRK   DC    X'00000000'
LOOKATIT DC    CL40'XXXXXXXXOPERATION COUNTS IFCEREP1XXXXXXX'
CONTPTR  DS    CL44
         ORG   CONTPTR
ERRORENT DC    F'0'
RSEQCNT  DC    F'0'
RSERDCNT DC    F'0'
CONVTCT  DC    F'0'
NUMRECSV DC    F'0'
SYSRDCT  DC    F'0'
RITEWKCT DC    F'0'
READWKCT DC    F'0'
ACIRDCT  DC    F'0'
DEVCT    DC    F'0'
RFRCOUNT DC    F'0'
         ORG   CONTPTR+44
TTRSAVE  DC    X'00000000'
CCSAVE   DC    CL1' '
BLANKS   DC    CL134' '
PACKPAS  DC    CL4'    '
CHARPAS  DC    CL8'        '
CHARS    DC    CL16'0123456789ABCDEF'
         DS    CL5
PRNTBF   DS    CL134
         DS    CL2
BUF1     DS    CL2004
         ORG   BUF1
BUF1RDW  DS    CL4
         ORG   BUF1RDW
BUF1RDWL DC    H'0'
BUF1L    DC    H'0'
         ORG   BUF1+4
BUF1DTA  DS    CL2000
         ORG   BUF1+2004
IOSWTCH  DC    X'000000'
         ORG   IOSWTCH
HISTOPN  DS    BL1
SECGET   EQU   IOSWTCH+0
FLIPFLOP EQU   IOSWTCH+0
HISTYES  EQU   IOSWTCH+0
DBLYES   EQU   IOSWTCH+0
LASTLOOP EQU   IOSWTCH+0
TOURERR  EQU   IOSWTCH+0
INHISO   EQU   IOSWTCH+0
SERLO    DS    BL1
TWOTRY   EQU   IOSWTCH+1
INDIR    EQU   IOSWTCH+1
NONBLANK EQU   IOSWTCH+1
CLOSE2   EQU   IOSWTCH+1
SYSOPN   EQU   IOSWTCH+1
TOUROPN  EQU   IOSWTCH+1
ERPTOPN  EQU   IOSWTCH+1
READFR   DS    BL1
SCRATCH  EQU   IOSWTCH+2
SNAPOP   EQU   IOSWTCH+2
         ORG   IOSWTCH+3
         DS    CL1
HDRBUFF  DS    CL64
         ORG   HDRBUFF
HDRSEEK  DS    CL8
         ORG   HDRSEEK
HDRM     DC    X'00'
HDRBB    DC    X'0000'
HDRCC    DC    X'0000'
HDRHH    DC    X'0000'
HDRR     DC    X'00'
         ORG   HDRBUFF+8
HEADER   DS    CL40
         ORG   HEADER
HDRKEY   DS    CL2
HDRSCC   DS    CL2
HDRSHH   DS    CL2
HDRECC   DS    CL2
HDREHH   DS    CL2
HDRCOUNT DS    CL1
HDRREC1  DS    CL7
         ORG   HDRREC1
HDR1BB   DS    CL2
HDR1CC   DS    CL2
HDR1HH   DS    CL2
HDR1R    DS    CL1
         ORG   HEADER+18
HDRREM   DS    CL2
HDRTRKCP DS    CL2
HDRREC2  DS    CL7
         ORG   HDRREC2
HDR2BB   DS    CL2
HDR2CC   DS    CL2
HDR2HH   DS    CL2
HDR2R    DS    CL1
         ORG   HEADER+29
HDRUCBNO DS    CL2
HDREXSZE DS    CL2
HDRTYPE  DS    CL1
@NM00012 DS    CL4
@NM00013 DS    CL1
         ORG   @NM00013
HDRWNGBT DS    BL1
@NM00014 EQU   @NM00013+0
FRAMES   EQU   @NM00013+0
@NM00015 EQU   @NM00013+0
         ORG   HEADER+39
HDRSAFE  DS    CL1
         ORG   HDRBUFF+48
PREVSEEK DS    CL8
         ORG   PREVSEEK
PREVM    DC    X'FF'
PREVBB   DS    CL2
PREVCC   DS    CL2
PREVHH   DS    CL2
PREVR    DS    CL1
         ORG   HDRBUFF+64
LOGRECA  DC    CL11'SYS1.LOGREC'
LOGRECB  DC    CL8'RECORDER'
RESID    DC    CL8'SERLOG'
RESIDII  DC    CL8'LOGREC'
ZEROA    DS    CL24
SEEKSAVE DC    X'0000000000000000'
         ORG   SEEKSAVE
@NM00016 DS    CL7
SKSAVREC DS    CL1
         ORG   SEEKSAVE+8
         DS    CL5
XIOB     DS    CL40
         ORG   XIOB
XIOBFL1  DC    X'42'
XIOBFL2  DC    X'00'
XIOBSNS0 DC    X'00'
XIOBSNS1 DC    X'00'
XIOBECB  DC    AL4(XWRECB)
XIOBCSW  DC    X'0000000000000000'
XIOBCCW  DC    AL4(SEQ)
XIOBDCB  DS    AL4
XIOBRA   DC    A(0)
XIOBBEC  DC    F'0'
XIOBSEEK DS    CL8
         ORG   XIOBSEEK
XIOBM    DC    X'00'
XIOBBB   DC    X'0000'
XIOBCC   DC    X'0000'
XIOBHH   DC    X'0000'
XIOBR    DC    X'00'
         ORG   XIOB+40
SEQ      DS    CL24
         ORG   SEQ
SID1     DS    CL8
         ORG   SID1
@NM00018 DC    X'31'
AREAADR  DS    AL3
@NM00019 DC    X'4000'
@NM00020 DC    H'5'
         ORG   SEQ+8
TIC1     DS    CL8
         ORG   TIC1
@NM00021 DC    X'08'
@NM00022 DC    AL3(SID1)
@NM00023 DC    X'4000'
@NM00024 DC    H'1'
         ORG   SEQ+16
CKD1     DS    CL8
         ORG   CKD1
CKDCOM   DS    CL1
CKDAREA  DS    AL3
CKDCHAIN DC    X'20'
@NM00025 DC    X'00'
CKDCOUNT DS    FL2
         ORG   SEQ+24
SWITCH   DC    X'00'
         ORG   SWITCH
SBT0     DS    BL1
SBT2     EQU   SWITCH+0
SBT3     EQU   SWITCH+0
SBT4     EQU   SWITCH+0
SBT7     EQU   SWITCH+0
         ORG   SWITCH+1
         DS    CL7
WORK8    DS    CL8
         ORG   WORK8
WORK     DS    FL4
WORKB    DS    FL4
         ORG   WORKB
WHOURS   DS    CL1
WMINS    DS    CL1
WDAYS    DS    CL2
         ORG   WDAYS
WSECS    DS    CL1
WTNTHS   DS    CL1
         ORG   WORK8+8
SUPERZAP DC    3CL10'SUPERZAP'
EDIFILD  DS    9CL1
ERRLINE  DS    CL51
         ORG   ERRLINE+0
ERRDS    DC    CL1'1'
ERRCS    DC    CL1' '
PRINTNM  DC    CL9'DEBUG15  '
PRNTXT   DC    CL40'SERLOG OPEN ATTEMPTED                   '
         ORG   ERRLINE+51
         ORG   ERRLINE+51
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'CHECK HEADER FOR MORE RECORDS ATTEMPTED '
         ORG   ERRLINE+102
         ORG   ERRLINE+102
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'RESET OF SERLOG HEADER ATTEMPTED        '
         ORG   ERRLINE+153
         ORG   ERRLINE+153
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG CLOSE ATTEMPTED                  '
         ORG   ERRLINE+204
         ORG   ERRLINE+204
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ZEROALL ATTEMPTED                       '
         ORG   ERRLINE+255
         ORG   ERRLINE+255
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SDR COUNTER DUMP ATTEMPTED              '
         ORG   ERRLINE+306
         ORG   ERRLINE+306
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN OPEN ATTEMPTED                    '
         ORG   ERRLINE+357
         ORG   ERRLINE+357
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN CLOSE ATTEMPTED                   '
         ORG   ERRLINE+408
         ORG   ERRLINE+408
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK CLOSE FOR WRITING ATTEMPTED    '
         ORG   ERRLINE+459
         ORG   ERRLINE+459
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK CLOSE FOR READING ATTEMPTED    '
         ORG   ERRLINE+510
         ORG   ERRLINE+510
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK OPEN FOR WRITE ATTEMPTED      '
         ORG   ERRLINE+561
         ORG   ERRLINE+561
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN OPEN ATTEMPTED                    '
         ORG   ERRLINE+612
         ORG   ERRLINE+612
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN CLOSE ATTEMPTED                   '
         ORG   ERRLINE+663
         ORG   ERRLINE+663
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV CLOSE ATTEMPTED                  '
         ORG   ERRLINE+714
         ORG   ERRLINE+714
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'EREPPT OPEN ATTEMPTED                   '
         ORG   ERRLINE+765
         ORG   ERRLINE+765
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'EREPPT CLOSE ATTEMPTED                  '
         ORG   ERRLINE+816
         ORG   ERRLINE+816
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV OPEN ATTEMPTED                   '
         ORG   ERRLINE+867
         ORG   ERRLINE+867
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'FIRST FRAME READ ATTEMPT                '
         ORG   ERRLINE+918
         ORG   ERRLINE+918
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'TIMES IFCIOHND EXITED WITH R.C.12       '
         ORG   ERRLINE+969
         ORG   ERRLINE+969
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG SEQUENTIAL READ ATTEMPTS         '
         ORG   ERRLINE+1020
         ORG   ERRLINE+1020
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SERLOG DIRECT READ ATTEMPTS             '
         ORG   ERRLINE+1071
         ORG   ERRLINE+1071
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'TIME CONVERSION NECESSARY NUM. TIMES    '
         ORG   ERRLINE+1122
         ORG   ERRLINE+1122
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'RECORDS SAVED DURING ZEROALL PROCESSING '
         ORG   ERRLINE+1173
         ORG   ERRLINE+1173
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'SYSIN READ ATTEMPTS                     '
         ORG   ERRLINE+1224
         ORG   ERRLINE+1224
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK WRITE ATTEMPTS                 '
         ORG   ERRLINE+1275
         ORG   ERRLINE+1275
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'DIRECTWK READ ATTEMPTS                  '
         ORG   ERRLINE+1326
         ORG   ERRLINE+1326
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCIN SEQUENTIAL READ ATTEMPTS          '
         ORG   ERRLINE+1377
         ORG   ERRLINE+1377
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'ACCDEV WRITE ATTEMPTS                   '
         ORG   ERRLINE+1428
         ORG   ERRLINE+1428
         DC    CL1'1'
         DC    CL1' '
         DC    CL9'DEBUG15  '
         DC    CL40'FRAME READ ATTEMPTS OF SYS1.LOGREC      '
         ORG   ERRLINE+1479
MACHCODE DC    X'09'
         DC    X'01'
         DC    9X'09'
         DC    X'0B'
         DC    5X'09'
         DC    X'11'
         DC    X'09'
         DC    X'13'
         DC    5X'09'
         DC    X'19'
         DC    X'09'
         DC    X'1B'
         DC    109X'09'
         DC    X'89'
         DC    X'09'
         DC    X'8B'
         DC    5X'09'
         DC    X'91'
         DC    X'09'
         DC    X'93'
         DC    5X'09'
         DC    X'99'
         DC    X'09'
         DC    X'9B'
         DC    5X'09'
         DC    X'A1'
         DC    X'09'
         DC    X'A3'
         DC    7X'09'
         DC    X'AB'
         DC    5X'09'
         DC    X'B1'
         DC    X'09'
         DC    X'B3'
         DC    5X'09'
         DC    X'B9'
         DC    X'09'
         DC    X'BB'
         DC    5X'09'
         DC    X'C1'
         DC    X'09'
         DC    X'C3'
         DC    5X'09'
         DC    X'C9'
         DC    X'09'
         DC    X'CB'
         DC    5X'09'
         DC    X'D1'
         DC    X'09'
         DC    X'D3'
         DC    5X'09'
         DC    X'D9'
         DC    X'09'
         DC    X'DB'
         DC    5X'09'
         DC    X'E1'
         DC    X'09'
         DC    X'E3'
         DC    20X'09'
         DS    8XL1
BYTESREM DC    H'0'
         DC    H'3419'
         DC    H'20137'
         DC    H'4596'
         DC    H'4778'
         DC    H'0'
         DC    H'13192'
         DC    H'14184'
         DC    H'7008'
         DC    H'12680'
         DC    H'7954'
         DC    H'18800'
         DC    H'0'
         DC    H'12680'
PATCH    DC    20H'0'
IFCIOHND CSECT
         DC    S(SUPERZAP)
IFCIOHND CSECT
         DC    S(PATCH)
IFCIOHND CSECT
         DCBD  DSORG=PS,DEVD=DA         DCB DSECT
IFCIOHND CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R2       EQU   @02
R1       EQU   @01
R7       EQU   @07
R0       EQU   @00
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R12      EQU   @12
R14      EQU   @14
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R8       EQU   @08
R9       EQU   @09
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
NOSDR    EQU   SWITCHES
ZEROALL  EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG15  EQU   DEBUG+1
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
OTOURIST EQU   OPENIO
OEREPPT  EQU   OPENIO
OSERLOG  EQU   OPENIO
OACCIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OSYSIN   EQU   OPENIO
ODRCTWRK EQU   OPENIO
CLOSEIO  EQU   OPENCLSE+2
CTOURIST EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
RECLNGTH EQU   CCHHRLNG+6
LINECT   EQU   PARM+120
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRBASE  EQU   SHAREIO+1
SHRCUCPU EQU   SHAREIO+8
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
NEXTBYTE EQU   0
ADDNUM   EQU   0
LISTPTR  EQU   0
INARG    EQU   0
IOPLINE  EQU   0
PRINTDS  EQU   IOPLINE
PRINTCC  EQU   IOPLINE+1
PRINTBDY EQU   IOPLINE+2
RECTB    EQU   0
FORPTR   EQU   RECTB
JUNK     EQU   RECTB+4
JUNK3    EQU   JUNK+6
RECSPT   EQU   RECTB+12
OHEADER  EQU   0
OHDRREC1 EQU   OHEADER+11
OHDRREC2 EQU   OHEADER+22
RECAREA  EQU   0
@NM00028 EQU   RECAREA+2
NSSWITCH EQU   @NM00028
LCSWITCH EQU   @NM00028
DATETIME EQU   RECAREA+8
DATE     EQU   DATETIME
DATE0    EQU   DATE
GMTSW    EQU   DATE0
YEAR     EQU   DATE+1
DAYS     EQU   DATE+2
TIME     EQU   DATETIME+4
HOURS    EQU   TIME
MINS     EQU   TIME+1
SECS     EQU   TIME+2
TNTHS    EQU   TIME+3
IOHND    EQU   0
GETTIT   EQU   GETHIS
EDFLD    EQU   EDIFILD
CTPTR    EQU   CONTPTR
BUFFER   EQU   BUF1
BCOUNT   EQU   BUFFER
BCCHHR   EQU   BCOUNT
BSIZE    EQU   BCOUNT+6
BDATA    EQU   BUFFER+8
BSZ      EQU   BSIZE
BBRDW    EQU   BCCHHR+4
TRECCH   EQU   TRECCH0
TRKNUM   EQU   MAXTRK
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
BKEYL    EQU   BCOUNT+5
@NM00032 EQU   DATE0
@NM00031 EQU   @NM00028
@NM00030 EQU   @NM00028
@NM00029 EQU   @NM00028
@NM00027 EQU   RECAREA+1
RECKEY   EQU   RECAREA
OHDRSAFE EQU   OHEADER+39
@NM00026 EQU   OHEADER+34
OHDRTYP  EQU   OHEADER+33
OHDREXSZ EQU   OHEADER+31
OHDRUCBN EQU   OHEADER+29
OHDR2R   EQU   OHDRREC2+6
OHDR2HH  EQU   OHDRREC2+4
OHDR2CC  EQU   OHDRREC2+2
OHDR2BB  EQU   OHDRREC2
OHDRTRXC EQU   OHEADER+20
OHDRREM  EQU   OHEADER+18
OHDR1R   EQU   OHDRREC1+6
OHDR1HH  EQU   OHDRREC1+4
OHDR1CC  EQU   OHDRREC1+2
OHDR1BB  EQU   OHDRREC1
OHDRHI   EQU   OHEADER+10
OHDREHH  EQU   OHEADER+8
OHDRECC  EQU   OHEADER+6
OHDRSHH  EQU   OHEADER+4
OHDRSCC  EQU   OHEADER+2
OHDRKEY  EQU   OHEADER
JUNK2    EQU   JUNK+5
JUNK1    EQU   JUNK
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+15
SHRCUAAH EQU   SHRCUCPU+5
SHRCUAAL EQU   SHRCUCPU+3
SHARSERA EQU   SHRCUCPU
SHRCUABH EQU   SHRBASE+5
SHRCUABL EQU   SHRBASE+3
SHARSERB EQU   SHRBASE
SHAREFLG EQU   SHAREIO
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SORTNUM  EQU   PARM+84
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
OSNAP    EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG4   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00173 EQU   @EL00001
@RF00214 EQU   @RC00212
@RC00216 EQU   @RC00212
@RC00233 EQU   @RC00212
@RC00210 EQU   @EL00003
@RC00284 EQU   @EL00004
@RF00331 EQU   @EL00005
@RT00368 EQU   HDRERR0
@RT00370 EQU   HDRERR1
@RT00415 EQU   CHK03
@RT00417 EQU   CHK04
@RT00447 EQU   @EL00008
@RF00540 EQU   @EL00009
@RF00562 EQU   @EL00010
@RF00594 EQU   @RC00588
@RC00571 EQU   @EL00011
@RF00614 EQU   @EL00011
@RC00696 EQU   @EL00014
@RC00723 EQU   @EL00015
@RC00740 EQU   @EL00015
@RC00769 EQU   @EL00016
@RC00788 EQU   @EL00017
@RF00799 EQU   @EL00017
@RC00810 EQU   @EL00018
@RC00824 EQU   @EL00019
@RC00846 EQU   @EL00020
@RC00865 EQU   @EL00021
@RC00872 EQU   @EL00022
@RF00895 EQU   @EL00022
@RC00906 EQU   @EL00023
@RC00909 EQU   @EL00023
@RC00933 EQU   @EL00025
@RC00956 EQU   @EL00026
@RC00983 EQU   @EL00027
@RF00996 EQU   @EL00027
@RC01007 EQU   @EL00028
@RF01020 EQU   @EL00028
@RC01031 EQU   @EL00029
@RC01049 EQU   @EL00030
@RF01075 EQU   @EL00030
@RC01086 EQU   @EL00031
@RC01105 EQU   @EL00032
@RF01116 EQU   @EL00032
@RC01127 EQU   @EL00033
@RC01149 EQU   @EL00034
@RF00220 EQU   @RC00216
@RF00252 EQU   @RC00210
@RC00256 EQU   @RC00210
@RF00706 EQU   @RC00696
@RC00725 EQU   @RC00723
@RF00750 EQU   @RC00740
@RC00874 EQU   @RC00872
@ENDDATA EQU   *
         END   IFCIOHND

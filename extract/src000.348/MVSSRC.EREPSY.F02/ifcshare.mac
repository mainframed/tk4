         TITLE 'IFCSHARE-SHARE/CONTROLLER CARD MODULE'
IFCSHARE CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCSHARE  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@04,20(@13)                                     0001
         STM   @06,@12,44(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                                                  0107
*/********************************************************************/
*/*                                                                  */
*/*  THIS IS THE TOP UNIT OF IFCSHARE. THIS UNIT WILL READ THE       */
*/*  INPUT CARD AND DETERMINE WHAT TYPE OF PROCESSING IS NEEDED FOR  */
*/*  EACH CARD. WHEN ALL CARDS ARE PROCESSED THIS UNIT WILL CALL     */
*/*  SHARLTR TO ASSIGN LETTERS TO ALL ENTRIES IN THE TABLE BUILT.    */
*/*  NEXT THIS UNIT WILL CALL DEBUG TO PRINT OUT THE DEBUG PRINT.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0107
*   LENGPARM=(TABSIZE-LENGTH(SHARENUM))/ENTRYLEN;/* MAX # OF ENTRIES */
         L     @00,TABSIZE(,R2)                                    0107
         BCTR  @00,0                                               0107
         BCTR  @00,0                                               0107
         SRDA  @00,32                                              0107
         D     @00,@CF00089                                        0107
         ST    @01,LENGPARM                                        0107
*   RESPECIFY                                                      0108
*    (R7) RESTRICTED;                                              0108
*   CALL IOHND(READCARD);           /* READ A CARD. PRT IN R7        */
         L     @15,ADIOHND(,R2)                                    0109
         LA    @01,@AL00109                                        0109
         BALR  @14,@15                                             0109
*   RESPECIFY                                                      0110
*    (R15) RESTRICTED;                                             0110
*   INDEX2=ZERO;                    /* NUMBER OF ENTRIES IN TABLE    */
         SLR   @14,@14                                             0111
         ST    @14,INDEX2                                          0111
*   IF R15=ZERO THEN                /* NOT END OF FILE               */
         CR    R15,@14                                             0112
         BNE   @RF00112                                            0112
*     DO UNTIL(R15^=ZERO);                                         0113
@DL00113 DS    0H                                                  0114
*       PARMFLD(1:80)=CARD(1:80);   /* MOVE CARD READ                */
         MVC   PARMFLD(80),CARD(R7)                                0114
*       PARMFLD(81)=BLANK;          /* START TO BLANK LINE           */
         MVI   PARMFLD+80,C' '                                     0115
*       RESPECIFY                                                  0116
*        (R7,                                                      0116
*         R15) UNRESTRICTED;                                       0116
*       PARMFLD(82:100)=PARMFLD(81:99);/* CLEAR REMAINDER OF AREA    */
         MVC   @TS00001(19),PARMFLD+80                             0117
         MVC   PARMFLD+81(19),@TS00001                             0117
*       PARMPRT(1:ENDCARD)=PARMFLD(1:ENDCARD);/* PRINT THE CARD READ */
         MVC   PARMPRT(72),PARMFLD                                 0118
*       PRINTADR=ADDR(PARMPT);                                     0119
         LA    @10,PARMPT                                          0119
         ST    @10,PRINTADR(,R2)                                   0119
*       CALL IOHND(RITEPRTR);                                      0120
         L     @15,ADIOHND(,R2)                                    0120
         LA    @01,@AL00120                                        0120
         BALR  @14,@15                                             0120
*       IF PARMFLD(1)^=STAR THEN    /* TEST FOR COMMENT CARD         */
         CLI   PARMFLD,C'*'                                        0121
         BE    @RF00121                                            0121
*         DO;                       /* FIND FIRST NON-BLANK          */
*           DO INDEX1=1 TO ENDCARD BY 1 WHILE(PARMFLD(INDEX1)=BLANK);
         LA    INDEX1,1                                            0123
@DL00123 LA    @10,PARMFLD-1(INDEX1)                               0123
         CLI   0(@10),C' '                                         0123
         BNE   @DC00123                                            0123
*           END;                                                   0124
         AH    INDEX1,@CH00053                                     0124
         CH    INDEX1,@CH00596                                     0124
         BNH   @DL00123                                            0124
@DC00123 DS    0H                                                  0125
*           IF INDEX1<ENDCARD THEN  /* IS CARD BLANK                 */
         CH    INDEX1,@CH00596                                     0125
         BNL   @RF00125                                            0125
*             IF PARMFLD(INDEX1:INDEX1+LENGTH(CONTRWD)-1)=CONTRWD THEN
         LA    @10,PARMFLD-1(INDEX1)                               0126
         CLC   0(10,@10),CONTRWD                                   0126
         BNE   @RF00126                                            0126
*               CALL CONTROL;       /* PROCESS CONTROLLER CARD       */
         BAL   @14,CONTROL                                         0127
*             ELSE                                                 0128
*               IF PARMFLD(INDEX1:INDEX1+LENGTH(SHAREW)-1)=SHAREW THEN
         B     @RC00126                                            0128
@RF00126 LA    @10,PARMFLD-1(INDEX1)                               0128
         CLC   0(5,@10),SHAREW                                     0128
         BNE   @RF00128                                            0128
*                 CALL SHARECRD;    /* PROCESS SHARE CARD            */
         BAL   @14,SHARECRD                                        0129
*               ELSE                                               0130
*                 CALL OUTMSG(SYNTAX);/* ++++++UNKNOWN TYPE+++++++++ */
         B     @RC00128                                            0130
@RF00128 LA    @01,@AL00130                                        0130
         BAL   @14,OUTMSG                                          0130
*           ELSE                                                   0131
*             ;                     /* BLANK CARD                    */
@RF00125 DS    0H                                                  0132
*         END;                                                     0132
*       ELSE                                                       0133
*         ;                         /* COMMENT CARD IGNORE           */
@RF00121 DS    0H                                                  0134
*       RESPECIFY                                                  0134
*        (R7) RESTRICTED;                                          0134
@RC00121 DS    0H                                                  0135
*       CALL IOHND(READCARD);       /* READ NEXT CARD                */
         L     @15,ADIOHND(,R2)                                    0135
         LA    @01,@AL00135                                        0135
         BALR  @14,@15                                             0135
*       RESPECIFY                                                  0136
*        (R15) RESTRICTED;                                         0136
*     END;                                                         0137
@DE00113 LTR   R15,R15                                             0137
         BZ    @DL00113                                            0137
*   ELSE                                                           0138
*     ;                             /* NO INPUT CARDS READ           */
@RF00112 DS    0H                                                  0139
*   IF TABFULL=ON THEN              /* SEE IF TABLE IS FULL          */
         TM    TABFULL,B'01000000'                                 0139
         BNO   @RF00139                                            0139
*     CALL MSGTABFL;                /* PRINT TABLE FULL MESSAGE      */
         BAL   @14,MSGTABFL                                        0140
*   ELSE                                                           0141
*     ;                             /* TABLE NOT FULL                */
@RF00139 DS    0H                                                  0142
*   CALL SHARLTR;                   /* ASSIGN LETTERS TO EACH CPU    */
         BAL   @14,SHARLTR                                         0142
*   IF DEBUG3=ON&INDEX2^=ZERO THEN  /* IS DEBUG OUTPUT WANTED        */
         TM    DEBUG3(R2),B'00010000'                              0143
         BNO   @RF00143                                            0143
         L     @14,INDEX2                                          0143
         LTR   @14,@14                                             0143
         BZ    @RF00143                                            0143
*     DO;                                                          0144
*       SHARENUM=INDEX2;            /* STORE NUMBER OF ENTRIES       */
         L     @10,SHAREPTR(,R2)                                   0145
         STH   @14,SHARENUM(,@10)                                  0145
*       CALL DEBUGOUT;              /* PRINT SHARE/CONTROLLER TABLE  */
         BAL   @14,DEBUGOUT                                        0146
*     END;                                                         0147
*   ELSE                                                           0148
*     ;                             /* NO DEBUG OUTPUT REQUESTED     */
@RF00143 DS    0H                                                  0149
*   IF INDEX2=ZERO×RETCODE^=ZERO THEN/* NO ENTRIES OR ERROR          */
         SLR   @14,@14                                             0149
         C     @14,INDEX2                                          0149
         BE    @RT00149                                            0149
         L     @10,@PC00001                                        0149
         C     @14,RETCODE(,@10)                                   0149
         BE    @RF00149                                            0149
@RT00149 DS    0H                                                  0150
*     DO;                           /* FREE ENTIRE TABLE             */
*       RESPECIFY                                                  0151
*        (R7,                                                      0151
*         R15) UNRESTRICTED;                                       0151
*       RESPECIFY                                                  0152
*        (R1,                                                      0152
*         R0) RESTRICTED;                                          0152
*       R1=SHAREPTR;                /* ADDRESS OF AREA TO FREE       */
         L     R1,SHAREPTR(,R2)                                    0153
*       R0=TABSIZE;                 /* RELEASE ENTIRE SPACE          */
         L     R0,TABSIZE(,R2)                                     0154
*       GEN(FREEMAIN R,LV=(R0),A=(R1));                            0155
         FREEMAIN R,LV=(R0),A=(R1)
*       SHAREPTR=ZERO;              /* SHARE TABLE IS RELEASED       */
         SLR   @10,@10                                             0156
         ST    @10,SHAREPTR(,R2)                                   0156
*     END;                                                         0157
*   ELSE                                                           0158
*     DO;                                                          0158
         B     @RC00149                                            0158
@RF00149 DS    0H                                                  0159
*       SHARENUM=INDEX2;            /* PUT # OF ENTRIES IN TABLE     */
         L     @10,INDEX2                                          0159
         L     @04,SHAREPTR(,R2)                                   0159
         STH   @10,SHARENUM(,@04)                                  0159
*       INDEX2=INDEX2+ONE;          /* EXTRA ENTRY IN TABLE          */
         AL    @10,@CF00053                                        0160
         ST    @10,INDEX2                                          0160
*       SHAREIO(INDEX2)=SHAREIO(INDEX2)&&SHAREIO(INDEX2);          0161
         SLA   @10,4                                               0161
         ST    @10,@TF00001                                        0161
         ALR   @10,@04                                             0161
         AL    @10,@CF00727                                        0161
         XC    SHAREIO-2(16,@10),SHAREIO-2(@10)                    0161
*       INDEX2=INDEX2*ENTRYLEN+LENGTH(SHARENUM);/* TABLE SIZE        */
         LA    @10,2                                               0162
         AL    @10,@TF00001                                        0162
         ST    @10,INDEX2                                          0162
*       R0=(TABSIZE-INDEX2)&'FFFFFF80'X;/* AMOUNT (DOUBLE WORD)      */
         L     @03,TABSIZE(,R2)                                    0163
         LCR   @10,@10                                             0163
         ALR   @10,@03                                             0163
         N     @10,@CF00638                                        0163
         LR    R0,@10                                              0163
*       R1=SHAREPTR+TABSIZE-R0;     /* PLACE TO FREE FROM            */
         ALR   @04,@03                                             0164
         SLR   @04,R0                                              0164
         LR    R1,@04                                              0164
*       GEN(FREEMAIN R,LV=(R0),A=(R1));/* FREE SHARE TABLE           */
         FREEMAIN R,LV=(R0),A=(R1)
*       RESPECIFY                                                  0166
*        (R0,                                                      0166
*         R1) UNRESTRICTED;                                        0166
*     END;                                                         0167
*   RESPECIFY                                                      0168
*    (R15) RESTRICTED;                                             0168
@RC00149 DS    0H                                                  0169
*   R15=RETCODE;                    /* SET RETURN CODE               */
         L     @10,@PC00001                                        0169
         L     R15,RETCODE(,@10)                                   0169
*   RESPECIFY                                                      0170
*    (R15) UNRESTRICTED;                                           0170
*                                                                  0171
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL CONTROL THE PROCESSING OF CONTROLLER CARDS. IT   */
*/*  CALLS SHARECPU TO VALIDATE ALL CPU/CUA PAIRS ON THE CARD.       */
*/*  THIS MODULE BUILDS A CONTROLLER ENTRY IN THE SHARE/CONTROLLER   */
*/*  TABLE FOR ALL VALID ENTRIES FOUND. IT RETURNS CONTROL TO        */
*/*  PROC IFCSHARE.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0171
*CONTROL:                                                          0171
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0171
@EL00001 L     @13,4(,@13)                                         0171
@EF00001 DS    0H                                                  0171
@ER00001 L     @14,12(,@13)                                        0171
         LM    @00,@04,20(@13)                                     0171
         LM    @06,@12,44(@13)                                     0171
         BR    @14                                                 0171
CONTROL  ST    @14,@SA00002                                        0171
         STM   @00,@04,@SA00002+4                                  0171
         STM   @06,@12,@SA00002+24                                 0171
*   INDEX1=INDEX1+LENGTH(CONTRWD);  /* POINT TO '='                  */
         AH    INDEX1,@CH00277                                     0172
*   IF PARMFLD(INDEX1)^=EQUAL THEN                                 0173
         LA    @10,PARMFLD-1(INDEX1)                               0173
         CLI   0(@10),C'='                                         0173
         BE    @RF00173                                            0173
*     CALL OUTMSG(SYNTAX);          /* NO VALID INPUT FOUND          */
         LA    @01,@AL00174                                        0174
         BAL   @14,OUTMSG                                          0174
*   ELSE                                                           0175
*     IF PARMFLD(INDEX1+1)^=LPAREN THEN                            0175
         B     @RC00173                                            0175
@RF00173 LA    @10,PARMFLD(INDEX1)                                 0175
         CLI   0(@10),C'('                                         0175
         BE    @RF00175                                            0175
*       DO;                                                        0176
*         INDEX1=INDEX1+ONE;        /* POINT TO '('                  */
         AL    INDEX1,@CF00053                                     0177
*         CALL OUTMSG(SYNTAX);      /* OPENING '(' MISSING           */
         LA    @01,@AL00178                                        0178
         BAL   @14,OUTMSG                                          0178
*       END;                                                       0179
*     ELSE                                                         0180
*       DO;                                                        0180
         B     @RC00175                                            0180
@RF00175 DS    0H                                                  0181
*         INDEX1=INDEX1+ONE;        /* POINT TO '('                  */
         AL    INDEX1,@CF00053                                     0181
*         DO UNTIL(INDEX1>=ENDCARD×PARMFLD(INDEX1)^=COMMA);/* PROCESS
*                                      OTHERS                        */
@DL00182 DS    0H                                                  0183
*           INDEX1=INDEX1+ONE;      /* POINT TO CPU #                */
         AL    INDEX1,@CF00053                                     0183
*           CALL SHARECPU;          /* VALIDATE CPU/CUA              */
         BAL   @14,SHARECPU                                        0184
*           RESPECIFY                                              0185
*            (R15) RESTRICTED;                                     0185
*           IF R15=ZERO THEN        /* VALID CPU/CUA                 */
         LTR   R15,R15                                             0186
         BNZ   @RF00186                                            0186
*             IF INDEX2<LENGPARM THEN/* ROOM IN TABLE                */
         L     @14,INDEX2                                          0187
         C     @14,LENGPARM                                        0187
         BNL   @RF00187                                            0187
*               DO;                 /* ADD AN ENTRY                  */
*                 RESPECIFY                                        0189
*                  (R15) UNRESTRICTED;                             0189
*                 INDEX2=INDEX2+ONE;/* NUMBER OF ENTRIES             */
         AL    @14,@CF00053                                        0190
         ST    @14,INDEX2                                          0190
*                 SHAREFLG(INDEX2)=CHARC;/* CONTROLLER CARD FLAG     */
         SLA   @14,4                                               0191
         L     @10,SHAREPTR(,R2)                                   0191
         ST    @14,@TF00001                                        0191
         ALR   @14,@10                                             0191
         AL    @14,@CF00727                                        0191
         MVI   SHAREFLG-2(@14),C'C'                                0191
*                 SHRBASE(INDEX2)=KEYWORD(1:7);/* BASE CPU/CUA IN  0192
*                                      TABLE                         */
         LR    @04,@10                                             0192
         AL    @04,@TF00001                                        0192
         AL    @04,@CF00728                                        0192
         MVC   SHRBASE-3(7,@04),KEYWORD                            0192
*                 SHRCUCPU(INDEX2)=KEYWORD(1:7);/* ALT CPU/CUA IN  0193
*                                      TABLE                         */
         LR    @04,@10                                             0193
         AL    @04,@TF00001                                        0193
         AL    @04,@CF00729                                        0193
         MVC   SHRCUCPU-10(7,@04),KEYWORD                          0193
*                 SHARLET(INDEX2)=STAR;/* INDICATE BASE ENTRY        */
         AL    @10,@TF00001                                        0194
         MVI   SHARLET-16(@10),C'*'                                0194
*               END;                                               0195
*             ELSE                                                 0196
*               TABFULL=ON;         /* TABLE FULL ERROR              */
         B     @RC00187                                            0196
@RF00187 OI    TABFULL,B'01000000'                                 0196
*           ELSE                                                   0197
*             ;                     /* RETURN CODE =12 FROM SHARECPU */
@RF00186 DS    0H                                                  0198
*         END;                                                     0198
@RC00186 DS    0H                                                  0198
@DE00182 CH    INDEX1,@CH00596                                     0198
         BNL   @DC00182                                            0198
         LA    @10,PARMFLD-1(INDEX1)                               0198
         CLI   0(@10),C','                                         0198
         BE    @DL00182                                            0198
@DC00182 DS    0H                                                  0199
*         IF(PARMFLD(INDEX1)^=RPAREN&PARMFLD(INDEX1)^=BLANK) THEN  0199
         LA    @10,PARMFLD-1(INDEX1)                               0199
         CLI   0(@10),C')'                                         0199
         BE    @RF00199                                            0199
         LA    @10,PARMFLD-1(INDEX1)                               0199
         CLI   0(@10),C' '                                         0199
         BE    @RF00199                                            0199
*           CALL OUTMSG(SYNTAX);    /* CLOSING ')' MISSING           */
         LA    @01,@AL00200                                        0200
         BAL   @14,OUTMSG                                          0200
*         ELSE                                                     0201
*           ;                       /* CLOSING ')' FOUND             */
@RF00199 DS    0H                                                  0202
*       END;                                                       0202
*   END CONTROL;                                                   0203
@EL00002 DS    0H                                                  0203
@EF00002 DS    0H                                                  0203
@ER00002 L     @14,@SA00002                                        0203
         LM    @00,@04,@SA00002+4                                  0203
         LM    @06,@12,@SA00002+24                                 0203
         BR    @14                                                 0203
*                                                                  0204
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL CONTROL THE PROCESSING OF SHARE CARDS. IT        */
*/*  CALLS SHARECPU TO VALIDATE ALL CPU/CUA PAIRS AND BUILDS NEW     */
*/*  SHARE ENTRIES IN THE TABLE.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0204
*SHARECRD:                                                         0204
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0204
SHARECRD ST    @14,@SA00003                                        0204
         STM   @00,@04,@SA00003+4                                  0204
         STM   @06,@12,@SA00003+24                                 0204
*   INDEX1=INDEX1+LENGTH(SHAREW);   /* POINT PASS WORD 'SHARE'       */
         AH    INDEX1,@CH00079                                     0205
*   IF PARMFLD(INDEX1)^=EQUAL THEN  /* LOOK FOR '='                  */
         LA    @10,PARMFLD-1(INDEX1)                               0206
         CLI   0(@10),C'='                                         0206
         BE    @RF00206                                            0206
*     CALL OUTMSG(SYNTAX);          /* CARD NOT PROCESSED,= MISSING  */
         LA    @01,@AL00207                                        0207
         BAL   @14,OUTMSG                                          0207
*   ELSE                                                           0208
*     IF PARMFLD(INDEX1+1)^=LPAREN THEN/* LOOK FOR '('               */
         B     @RC00206                                            0208
@RF00206 LA    @10,PARMFLD(INDEX1)                                 0208
         CLI   0(@10),C'('                                         0208
         BE    @RF00208                                            0208
*       DO INDEX1=INDEX1+ONE;       /* POINT TO MISSING '('          */
         LA    @10,1                                               0209
         ALR   @10,INDEX1                                          0209
         LR    INDEX1,@10                                          0209
*         CALL OUTMSG(SYNTAX);      /* WRITE ERROR MESSAGE           */
         LA    @01,@AL00210                                        0210
         BAL   @14,OUTMSG                                          0210
*       END;                                                       0211
*     ELSE                                                         0212
*       DO;                         /* SYTAX CORRECT =( FOUND        */
         B     @RC00208                                            0212
@RF00208 DS    0H                                                  0213
*         INDEX1=INDEX1+TWO;        /* POINT PASS '=('               */
         AH    INDEX1,@CH00074                                     0213
*         CALL SHARECPU;            /* VALIDATE BASE CPU/CUA         */
         BAL   @14,SHARECPU                                        0214
*         RESPECIFY                                                0215
*          (R15) RESTRICTED;                                       0215
*         IF R15=ZERO THEN          /* TEST RETURN CODE              */
         LTR   R15,R15                                             0216
         BNZ   @RF00216                                            0216
*           DO;                     /* PROCEED WITH RC=0             */
*             RESPECIFY                                            0218
*              (R15) UNRESTRICTED;                                 0218
*             BASENTRY=KEYWORD(1:7);/* SAVE BASE CPU/CUA             */
         MVC   BASENTRY(7),KEYWORD                                 0219
*             CALL BASEALT;         /* IS BASE CPU/CUA ALSO AN ALT   */
         BAL   @14,BASEALT                                         0220
*             SWITCH=OFF;           /* DO LOOP CONTROL               */
         NI    SWITCH,B'11011111'                                  0221
*             IF INDEX2^=ZERO THEN  /* TEST FOR EMPTY TABLE          */
         L     @10,INDEX2                                          0222
         LTR   @10,@10                                             0222
         BZ    @RF00222                                            0222
*               DO I=1 TO INDEX2 BY 1 WHILE(SWITCH=OFF);/* TEST      */
         LA    @10,1                                               0223
         ST    @10,I                                               0223
         B     @DE00223                                            0223
@DL00223 TM    SWITCH,B'00100000'                                  0223
         BNZ   @DC00223                                            0223
*                 IF SHAREFLG(I)=CHARS THEN/* FOR DUPLICATE ENTRY    */
         SLA   @10,4                                               0224
         L     @04,SHAREPTR(,R2)                                   0224
         ST    @10,@TF00001                                        0224
         ALR   @10,@04                                             0224
         AL    @10,@CF00727                                        0224
         CLI   SHAREFLG-2(@10),C'S'                                0224
         BNE   @RF00224                                            0224
*                   IF SHRBASE(I)=KEYWORD(1:7) THEN/* ENTRY IDENTICAL*/
         AL    @04,@TF00001                                        0225
         AL    @04,@CF00728                                        0225
         CLC   SHRBASE-3(7,@04),KEYWORD                            0225
         BNE   @RF00225                                            0225
*                     SWITCH=ON;    /* GET OUT OF LOOP               */
         OI    SWITCH,B'00100000'                                  0226
*                   ELSE                                           0227
*                     ;             /* ENTRY DOES NOT MATCH          */
@RF00225 DS    0H                                                  0228
*                 ELSE                                             0228
*                   ;               /* ENTRY IS NOT SHARE ENTRY      */
@RF00224 DS    0H                                                  0229
*               END;                                               0229
         LA    @10,1                                               0229
         AL    @10,I                                               0229
         ST    @10,I                                               0229
@DE00223 C     @10,INDEX2                                          0229
         BNH   @DL00223                                            0229
@DC00223 DS    0H                                                  0230
*             ELSE                                                 0230
*               ;                   /* TABLE IS EMPTY                */
@RF00222 DS    0H                                                  0231
*             IF SWITCH=OFF THEN    /* TEST FOR ENTRY NOT FOUND      */
         TM    SWITCH,B'00100000'                                  0231
         BNZ   @RF00231                                            0231
*               DO;                 /* BUILD A NEW ENTRY             */
*                 IF INDEX2>=LENGPARM THEN/* TEST FOR FULL TABLE     */
         L     @10,INDEX2                                          0233
         C     @10,LENGPARM                                        0233
         BL    @RF00233                                            0233
*                   TABFULL=ON;     /* INDICATE FULL TABLE           */
         OI    TABFULL,B'01000000'                                 0234
*                 ELSE                                             0235
*                   DO;             /* BUILD NEW TABLE ENTRY FOR BASE*/
         B     @RC00233                                            0235
@RF00233 DS    0H                                                  0236
*                     INDEX2=INDEX2+ONE;/* NUMBER OF ENTRIES         */
         LA    @10,1                                               0236
         AL    @10,INDEX2                                          0236
         ST    @10,INDEX2                                          0236
*                     SHAREFLG(INDEX2)=CHARS;/* SET SHARE FLAG       */
         SLA   @10,4                                               0237
         L     @04,SHAREPTR(,R2)                                   0237
         ST    @10,@TF00001                                        0237
         ALR   @10,@04                                             0237
         AL    @10,@CF00727                                        0237
         MVI   SHAREFLG-2(@10),C'S'                                0237
*                     SHRBASE(INDEX2)=KEYWORD(1:7);/* BASE CPU/CUA   */
         LR    @10,@04                                             0238
         AL    @10,@TF00001                                        0238
         AL    @10,@CF00728                                        0238
         MVC   SHRBASE-3(7,@10),KEYWORD                            0238
*                     SHRCUCPU(INDEX2)=KEYWORD(1:7);/* ALT CPU/CUA   */
         LR    @10,@04                                             0239
         AL    @10,@TF00001                                        0239
         AL    @10,@CF00729                                        0239
         MVC   SHRCUCPU-10(7,@10),KEYWORD                          0239
*                     SHARLET(INDEX2)=STAR;/* INDICATE BASE ENTRY    */
         AL    @04,@TF00001                                        0240
         MVI   SHARLET-16(@04),C'*'                                0240
*                   END;                                           0241
*               END;                                               0242
*             ELSE                                                 0243
*               ;                   /* DON'T BUILD DUPLICATE ENTRY   */
@RF00231 DS    0H                                                  0244
*             IF INDEX1<ENDCARD&PARMFLD(INDEX1)=COMMA THEN/* ALT CPU */
@RC00231 CH    INDEX1,@CH00596                                     0244
         BNL   @RF00244                                            0244
         LA    @10,PARMFLD-1(INDEX1)                               0244
         CLI   0(@10),C','                                         0244
         BNE   @RF00244                                            0244
*               DO UNTIL(PARMFLD(INDEX1)^=COMMA×INDEX1>=ENDCARD);  0245
@DL00245 DS    0H                                                  0246
*                 INDEX1=INDEX1+ONE;/* POINT TO CPU NUMBER           */
         AL    INDEX1,@CF00053                                     0246
*                 CALL SHARECPU;    /* VALIDATE ALT CPU/CUA          */
         BAL   @14,SHARECPU                                        0247
*                 RESPECIFY                                        0248
*                  (R15) RESTRICTED;                               0248
*                 IF R15=ZERO THEN  /* GOOD CPU/CUA                  */
         LTR   R15,R15                                             0249
         BNZ   @RF00249                                            0249
*                   DO;                                            0250
*                     RESPECIFY                                    0251
*                      (R15) UNRESTRICTED;                         0251
*                     CALL ALTRANGE;/* VALIDATE THE ALT CUAS         */
         BAL   @14,ALTRANGE                                        0252
*                     RESPECIFY                                    0253
*                      (R15) RESTRICTED;                           0253
*                     IF R15=ZERO THEN/* GOOD CUA RANGE              */
         LTR   R15,R15                                             0254
         BNZ   @RF00254                                            0254
*                       IF INDEX2>=LENGPARM THEN/* IS TABLE FULL     */
         L     @14,INDEX2                                          0255
         C     @14,LENGPARM                                        0255
         BL    @RF00255                                            0255
*                         TABFULL=ON;/* INDICATE TABLE IS FULL       */
         OI    TABFULL,B'01000000'                                 0256
*                       ELSE                                       0257
*                         DO;       /* BUILD ALT CPU/CUA ENTRY       */
         B     @RC00255                                            0257
@RF00255 DS    0H                                                  0258
*                           RESPECIFY                              0258
*                            (R15) UNRESTRICTED;                   0258
*                           INDEX2=INDEX2+ONE;/* NUMBER OF ENTRIES   */
         LA    @10,1                                               0259
         AL    @10,INDEX2                                          0259
         ST    @10,INDEX2                                          0259
*                           SHAREFLG(INDEX2)=CHARS;/* SHARE INDICATOR*/
         SLA   @10,4                                               0260
         L     @04,SHAREPTR(,R2)                                   0260
         ST    @10,@TF00001                                        0260
         ALR   @10,@04                                             0260
         AL    @10,@CF00727                                        0260
         MVI   SHAREFLG-2(@10),C'S'                                0260
*                           SHRCUCPU(INDEX2)=KEYWORD(1:7);/* ALT   0261
*                                      CPU/CUA                       */
         LR    @10,@04                                             0261
         AL    @10,@TF00001                                        0261
         AL    @10,@CF00729                                        0261
         MVC   SHRCUCPU-10(7,@10),KEYWORD                          0261
*                           SHRBASE(INDEX2)=BASENTRY;/* BASE CPU/CUA */
         LR    @10,@04                                             0262
         AL    @10,@TF00001                                        0262
         AL    @10,@CF00728                                        0262
         MVC   SHRBASE-3(7,@10),BASENTRY                           0262
*                           SHARLET(INDEX2)=BLANK;/* NON-BASE ENTRY  */
         AL    @04,@TF00001                                        0263
         MVI   SHARLET-16(@04),C' '                                0263
*                         END;                                     0264
*                     ELSE                                         0265
*                       ;           /* CUA RANGE OF ALT IS BAD       */
@RF00254 DS    0H                                                  0266
*                   END;                                           0266
*                 ELSE                                             0267
*                   ;               /* ERROR FROM SHARECPU           */
@RF00249 DS    0H                                                  0268
*               END;                                               0268
@RC00249 DS    0H                                                  0268
@DE00245 LA    @10,PARMFLD-1(INDEX1)                               0268
         CLI   0(@10),C','                                         0268
         BNE   @DC00245                                            0268
         CH    INDEX1,@CH00596                                     0268
         BL    @DL00245                                            0268
@DC00245 DS    0H                                                  0269
*             ELSE                                                 0269
*               CALL OUTMSG(SYNTAX);/* ALT CPU/CUA MISSING           */
         B     @RC00244                                            0269
@RF00244 LA    @01,@AL00269                                        0269
         BAL   @14,OUTMSG                                          0269
*             IF PARMFLD(INDEX1)^=RPAREN&PARMFLD(INDEX1)^=BLANK THEN
@RC00244 LA    @10,PARMFLD-1(INDEX1)                               0270
         CLI   0(@10),C')'                                         0270
         BE    @RF00270                                            0270
         LA    @10,PARMFLD-1(INDEX1)                               0270
         CLI   0(@10),C' '                                         0270
         BE    @RF00270                                            0270
*               CALL OUTMSG(SYNTAX);/* CLOSING ')' MISSING           */
         LA    @01,@AL00271                                        0271
         BAL   @14,OUTMSG                                          0271
*             ELSE                                                 0272
*               ;                   /* CLOSING ')' FOUND             */
@RF00270 DS    0H                                                  0273
*           END;                                                   0273
*         ELSE                                                     0274
*           ;                       /* BAD RETURN FROM SHARECPU      */
@RF00216 DS    0H                                                  0275
*       END;                                                       0275
*   END SHARECRD;                                                  0276
@EL00003 DS    0H                                                  0276
@EF00003 DS    0H                                                  0276
@ER00003 L     @14,@SA00003                                        0276
         LM    @00,@04,@SA00003+4                                  0276
         LM    @06,@12,@SA00003+24                                 0276
         BR    @14                                                 0276
*                                                                  0277
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC IS CALLED BY CONTROL AND SHARECRD TO START THE        */
*/*  PROCESSING ON A CPU/CUA PAIR. THIS PROC SETS THE RETURN CODE    */
*/*  SAVE AREAS TO ZERO. IT THEN CALLS VALIDNUM TO VALIDATE THE CPU. */
*/*  NEXT SHARECPU CALLS EITHER VALIDCUX OR CHECKCUA TO VALIDATE THE */
*/*  CUA INPUT. NEXT CUADIGIT AND SHRSEARH ARE CALLED TO DO FUTHER   */
*/*  CHECKING ON THE CUAS INPUT. REG 15 PASSES BACK A RETURN CODE.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0277
*SHARECPU:                                                         0277
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0277
SHARECPU ST    @14,@SA00004                                        0277
         STM   @00,@04,@SA00004+4                                  0277
         STM   @06,@12,@SA00004+24                                 0277
*   CPURC=ZERO;                     /* INIT RETURN CODE SAVE AREAS   */
         SLR   @10,@10                                             0278
         ST    @10,CPURC                                           0278
*   CUARC1=ZERO;                                                   0279
         ST    @10,CUARC1                                          0279
*   CUARC2=ZERO;                                                   0280
         ST    @10,CUARC2                                          0280
*   RANGERC1=ZERO;                                                 0281
         ST    @10,RANGERC1                                        0281
*   RANGERC2=ZERO;                                                 0282
         ST    @10,RANGERC2                                        0282
*   CALL VALIDNUM(6);               /* VALIDATE CPU NUMBER           */
         LA    @01,@AL00283                                        0283
         BAL   @14,VALIDNUM                                        0283
*   RESPECIFY                                                      0284
*    (R15) RESTRICTED;                                             0284
*   CPURC=R15;                      /* SAVE RETURN CODE FROM VALIDNUM*/
         ST    R15,CPURC                                           0285
*   RESPECIFY                                                      0286
*    (R15) UNRESTRICTED;                                           0286
*   CALL HEXPACK(6);                /* PACK CPU DERIAL NUMBER        */
         LA    @01,@AL00287                                        0287
         BAL   @14,HEXPACK                                         0287
*   KEYWORD(1:3)=HOLDAREA(1:3);     /* SAVE CONVERTED CPU NUMBER     */
         MVC   KEYWORD(3),HOLDAREA                                 0288
*   IF PARMFLD(INDEX1)^=PERIOD THEN /* PERIOD EXPECTED               */
         LA    @10,PARMFLD-1(INDEX1)                               0289
         CLI   0(@10),C'.'                                         0289
         BE    @RF00289                                            0289
*     DO;                                                          0290
*       CALL OUTMSG(SYNTAX);                                       0291
         LA    @01,@AL00291                                        0291
         BAL   @14,OUTMSG                                          0291
*       CALL FINDDELM;              /* FIND NEXT ',' OR ')'          */
         BAL   @14,FINDDELM                                        0292
*       RESPECIFY                                                  0293
*        (R15) RESTRICTED;                                         0293
*       R15=TWELVE;                 /* SET RETURN CODE               */
         LA    R15,12                                              0294
*       RESPECIFY                                                  0295
*        (R15) UNRESTRICTED;                                       0295
*     END;                                                         0296
*   ELSE                                                           0297
*     DO;                                                          0297
         B     @RC00289                                            0297
@RF00289 DS    0H                                                  0298
*       INDEX1=INDEX1+ONE;          /* POINT TO LOW CUA              */
         AL    INDEX1,@CF00053                                     0298
*       IF PARMFLD(INDEX1+TWO)=CHARX THEN/* TEST FOR CUX             */
         LA    @10,PARMFLD+1(INDEX1)                               0299
         CLI   0(@10),C'X'                                         0299
         BNE   @RF00299                                            0299
*         CALL VALIDCUX;            /* VALIDATE CUX                  */
         BAL   @14,VALIDCUX                                        0300
*       ELSE                                                       0301
*         CALL CHECKCUA;            /* VALIDATE CUA NON CUX          */
         B     @RC00299                                            0301
@RF00299 BAL   @14,CHECKCUA                                        0301
*       IF CPURC=ZERO&CUARC1=ZERO&CUARC2=ZERO THEN/* TEST FOR GOOD 0302
*                                      CUA                           */
@RC00299 SLR   @10,@10                                             0302
         C     @10,CPURC                                           0302
         BNE   @RF00302                                            0302
         C     @10,CUARC1                                          0302
         BNE   @RF00302                                            0302
         C     @10,CUARC2                                          0302
         BNE   @RF00302                                            0302
*         DO;                                                      0303
*           CALL CUADIGIT;          /* VALIDATE RANGE OF CUAS        */
         BAL   @14,CUADIGIT                                        0304
*           RESPECIFY                                              0305
*            (R15) RESTRICTED;                                     0305
*           RANGERC1=R15;           /* SAVE RETURN CODE              */
         ST    R15,RANGERC1                                        0306
*           RESPECIFY                                              0307
*            (R15) UNRESTRICTED;                                   0307
*           IF INDEX2^=ZERO&RANGERC1=ZERO THEN/* TEST FOR NON EMPTY
*                                      TABLE                         */
         SLR   @10,@10                                             0308
         C     @10,INDEX2                                          0308
         BE    @RF00308                                            0308
         L     @04,RANGERC1                                        0308
         CR    @04,@10                                             0308
         BNE   @RF00308                                            0308
*             DO;                                                  0309
*               CALL SHRSEARH;      /* CHECK CUA RANGE AGAIN         */
         BAL   @14,SHRSEARH                                        0310
*               RESPECIFY                                          0311
*                (R15) RESTRICTED;                                 0311
*               RANGERC2=R15;       /* SAVE RETURN CODE              */
         ST    R15,RANGERC2                                        0312
*             END;                                                 0313
*           ELSE                                                   0314
*             ;                     /* TABLE WAS EMPTY OR CUA BAD    */
@RF00308 DS    0H                                                  0315
*           IF RANGERC1=ZERO&RANGERC2=ZERO THEN                    0315
         SLR   @14,@14                                             0315
         C     @14,RANGERC1                                        0315
         BNE   @RF00315                                            0315
         C     @14,RANGERC2                                        0315
         BNE   @RF00315                                            0315
*             R15=ZERO;             /* SET RETURN CODE OF 0          */
         SLR   R15,R15                                             0316
*           ELSE                    /* CUA RANGE DID NOT VALIDATE    */
*             R15=TWELVE;           /* SET RETURN CODE OF 12         */
         B     @RC00315                                            0317
@RF00315 LA    R15,12                                              0317
*         END;                                                     0318
*       ELSE                        /* CPU/CUA DID NOT VALIDATE      */
*         R15=TWELVE;               /* SET RETURN CODE OF 12         */
         B     @RC00302                                            0319
@RF00302 LA    R15,12                                              0319
*     END;                                                         0320
*   END SHARECPU;                                                  0321
@EL00004 DS    0H                                                  0321
@EF00004 DS    0H                                                  0321
@ER00004 L     @14,@SA00004                                        0321
         LM    @00,@04,@SA00004+4                                  0321
         LM    @06,@12,@SA00004+24                                 0321
         BR    @14                                                 0321
*   RESPECIFY                                                      0322
*    (R15) UNRESTRICTED;                                           0322
*                                                                  0323
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL VALIDATE A CUX FIELD ON A SHARE OR CONTROLLER    */
*/*  CARD. IT IS CALLED BY SHARECPU AND SETS A RETURN CODE IN CUARC1 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0323
*VALIDCUX:                                                         0323
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0323
VALIDCUX ST    @14,@SA00005                                        0323
         STM   @00,@04,@SA00005+4                                  0323
         STM   @06,@12,@SA00005+24                                 0323
*   CALL VALIDCUA(2);               /* VALIDATE 2 DIGIT CUX          */
         LA    @01,@AL00324                                        0324
         BAL   @14,VALIDCUA                                        0324
*   RESPECIFY                                                      0325
*    (R15) RESTRICTED;                                             0325
*   CUARC1=R15;                     /* SAVE RETURN CODE              */
         ST    R15,CUARC1                                          0326
*   RESPECIFY                                                      0327
*    (R15) UNRESTRICTED;                                           0327
*   PARMFLD(INDEX1+TWO)=PARMFLD(INDEX1+TWO)&HEXZERO;/* 0 LAST 8 BITS */
         LA    @10,PARMFLD+1(INDEX1)                               0328
         NI    0(@10),X'00'                                        0328
*   CUAHOLD(1:3)=PARMFLD(INDEX1:INDEX1+2);/* SAVE LOW CUA BEFORE PACK*/
         LA    @10,PARMFLD-1(INDEX1)                               0329
         MVC   CUAHOLD(3),0(@10)                                   0329
*   CUAHOLD2(1:3)=CUAHOLD(1:3)×H00000F;/* SAVE HIGH CUA BEFORE PACK  */
         MVC   CUAHOLD2(3),CUAHOLD                                 0330
         OC    CUAHOLD2(3),@CB00229                                0330
*   INDEX1=INDEX1-ONE;              /* POINT TO '.'                  */
         BCTR  INDEX1,0                                            0331
*   PARMFLD(INDEX1)='0';            /* PAD CUA TO 2 BYTES FOR HEXPACK*/
         LA    @10,PARMFLD-1(INDEX1)                               0332
         MVI   0(@10),C'0'                                         0332
*   CALL HEXPACK(4);                /* PACK 2 BYTE LOW CUA           */
         LA    @01,@AL00333                                        0333
         BAL   @14,HEXPACK                                         0333
*   KEYWORD(4:5)=HOLDAREA(1:2);     /* SAVE LOW PACKED CUA           */
         MVC   KEYWORD+3(2),HOLDAREA                               0334
*   HOLDAREA(1:2)=HOLDAREA(1:2)×HEX000F;/* SAVE HIGH PACKED CUA      */
         OC    HOLDAREA(2),@CB00618                                0335
*   KEYWORD(6:7)=HOLDAREA(1:2);     /* MOVE HIGH CUA NEAR LOW        */
         MVC   KEYWORD+5(2),HOLDAREA                               0336
*   CUAPLACE=INDEX1;                /* SAVE POSITION OF CUA          */
         ST    INDEX1,CUAPLACE                                     0337
*   IF PARMFLD(INDEX1)^=COMMA&PARMFLD(INDEX1)^=RPAREN THEN         0338
         LA    @10,PARMFLD-1(INDEX1)                               0338
         CLI   0(@10),C','                                         0338
         BE    @RF00338                                            0338
         LA    @10,PARMFLD-1(INDEX1)                               0338
         CLI   0(@10),C')'                                         0338
         BE    @RF00338                                            0338
*     DO;                                                          0339
*       CALL OUTMSG(SYNTAX);        /* NO DELIMITER FOUND            */
         LA    @01,@AL00340                                        0340
         BAL   @14,OUTMSG                                          0340
*       CALL FINDDELM;              /* FIND NEXT ',' × ')' × ' '     */
         BAL   @14,FINDDELM                                        0341
*     END;                                                         0342
*   ELSE                                                           0343
*     ;                             /* SYNTAX OKAY                   */
@RF00338 DS    0H                                                  0344
*   END VALIDCUX;                                                  0344
@EL00005 DS    0H                                                  0344
@EF00005 DS    0H                                                  0344
@ER00005 L     @14,@SA00005                                        0344
         LM    @00,@04,@SA00005+4                                  0344
         LM    @06,@12,@SA00005+24                                 0344
         BR    @14                                                 0344
*                                                                  0345
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL VALIDATE A CUA FIELD ON A SHARE OR CONTROLLER    */
*/*  CARD. IT IS CALLED BY SHARECPU AND SETS RETURN CODES IN CUARC1  */
*/*  AND CUARC1.                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0345
*CHECKCUA:                                                         0345
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0345
CHECKCUA ST    @14,@SA00006                                        0345
         STM   @00,@04,@SA00006+4                                  0345
         STM   @06,@12,@SA00006+24                                 0345
*   CALL VALIDCUA(3);               /* VALIDATE CUA                  */
         LA    @01,@AL00346                                        0346
         BAL   @14,VALIDCUA                                        0346
*   RESPECIFY                                                      0347
*    (R15) RESTRICTED;                                             0347
*   CUARC1=R15;                     /* SAVE RETURN CODE              */
         ST    R15,CUARC1                                          0348
*   RESPECIFY                                                      0349
*    (R15) UNRESTRICTED;                                           0349
*   CUAHOLD(1:3)=PARMFLD(INDEX1:INDEX1+2);/* SAVE LOW UNPACKED CUA   */
         LA    @10,PARMFLD-1(INDEX1)                               0350
         MVC   CUAHOLD(3),0(@10)                                   0350
*   CUAHOLD2(1:3)=CUAHOLD(1:3);     /* SAVE HIGH UNPACKED CUA        */
         MVC   CUAHOLD2(3),CUAHOLD                                 0351
*   INDEX1=INDEX1-ONE;              /* POINT TO '.' TO PAD CUA       */
         BCTR  INDEX1,0                                            0352
*   PARMFLD(INDEX1)='0';            /* PAD DIGIT OF CUA IS 0         */
         LA    @10,PARMFLD-1(INDEX1)                               0353
         MVI   0(@10),C'0'                                         0353
*   CALL HEXPACK(4);                /* PACK 2 BYTE LOW CUA           */
         LA    @01,@AL00354                                        0354
         BAL   @14,HEXPACK                                         0354
*   KEYWORD(4:5)=HOLDAREA(1:2);     /* SAVE LOW CUA                  */
         MVC   KEYWORD+3(2),HOLDAREA                               0355
*   IF PARMFLD(INDEX1)=DASH THEN    /* SEE IF RANGE SPECIFIED        */
         LA    @10,PARMFLD-1(INDEX1)                               0356
         CLI   0(@10),C'-'                                         0356
         BNE   @RF00356                                            0356
*     DO;                                                          0357
*       INDEX1=INDEX1+ONE;          /* POINT TO HIGH CUA             */
         AL    INDEX1,@CF00053                                     0358
*       CALL VALIDCUA(3);           /* VALIDATE HIGH CUA             */
         LA    @01,@AL00359                                        0359
         BAL   @14,VALIDCUA                                        0359
*       RESPECIFY                                                  0360
*        (R15) RESTRICTED;                                         0360
*       CUARC2=R15;                 /* SAVE RETURN CODE              */
         ST    R15,CUARC2                                          0361
*       RESPECIFY                                                  0362
*        (R15) UNRESTRICTED;                                       0362
*       CUAHOLD2(1:3)=PARMFLD(INDEX1:INDEX1+2);/* SAVE HIGH CUA      */
         LA    @10,PARMFLD-1(INDEX1)                               0363
         MVC   CUAHOLD2(3),0(@10)                                  0363
*       INDEX1=INDEX1-ONE;          /* PAD HIGH CUA TO 4 BYTES       */
         BCTR  INDEX1,0                                            0364
*       PARMFLD(INDEX1)='0';        /* SET PAD BYTE TO 0             */
         LA    @10,PARMFLD-1(INDEX1)                               0365
         MVI   0(@10),C'0'                                         0365
*       CALL HEXPACK(4);            /* CONVERT HIGH CUA TO HEX       */
         LA    @01,@AL00366                                        0366
         BAL   @14,HEXPACK                                         0366
*     END;                                                         0367
*   ELSE                                                           0368
*     ;                             /* RANGE OF CUAS NOT SPECIFIED   */
@RF00356 DS    0H                                                  0369
*   KEYWORD(6:7)=HOLDAREA(1:2);     /* MOVE HIGH CUA NEAR LOW        */
         MVC   KEYWORD+5(2),HOLDAREA                               0369
*   CUAPLACE=INDEX1;                /* SAVE POSITION OF CUA          */
         ST    INDEX1,CUAPLACE                                     0370
*   IF PARMFLD(INDEX1)^=COMMA&PARMFLD(INDEX1)^=RPAREN THEN         0371
         LA    @10,PARMFLD-1(INDEX1)                               0371
         CLI   0(@10),C','                                         0371
         BE    @RF00371                                            0371
         LA    @10,PARMFLD-1(INDEX1)                               0371
         CLI   0(@10),C')'                                         0371
         BE    @RF00371                                            0371
*     DO;                                                          0372
*       CALL OUTMSG(SYNTAX);        /* NO DELIMITER FOUND            */
         LA    @01,@AL00373                                        0373
         BAL   @14,OUTMSG                                          0373
*       CALL FINDDELM;              /* FIND NEXT DELIMITER           */
         BAL   @14,FINDDELM                                        0374
*     END;                                                         0375
*   ELSE                                                           0376
*     ;                             /* GOOD DELIMITER FOUND          */
@RF00371 DS    0H                                                  0377
*   END CHECKCUA;                                                  0377
@EL00006 DS    0H                                                  0377
@EF00006 DS    0H                                                  0377
@ER00006 L     @14,@SA00006                                        0377
         LM    @00,@04,@SA00006+4                                  0377
         LM    @06,@12,@SA00006+24                                 0377
         BR    @14                                                 0377
*                                                                  0378
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC PERFORMS A CHECK ON THE BASE CPU/CUA SPECIFIED ON A   */
*/*  SHARE CARD. IT CHECKS TO SEE THAT THE BASE CPU/CUA DOES NOT     */
*/*  APPEAR AS AN ALTERNATE ON ANOTHER SHARE CARD.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0378
*BASEALT:                                                          0378
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0378
BASEALT  ST    @14,@SA00007                                        0378
         STM   @00,@04,@SA00007+4                                  0378
         STM   @06,@12,@SA00007+24                                 0378
*   IF INDEX2^=ZERO THEN            /* TEST FOR EMPTY TABLE          */
         L     @10,INDEX2                                          0379
         LTR   @10,@10                                             0379
         BZ    @RF00379                                            0379
*     DO;                           /* SEARCH SHARE/CONTROLLER TABLE */
*       SWITCH=OFF;                                                0381
         NI    SWITCH,B'11011111'                                  0381
*       DO I=1 TO INDEX2 BY 1 WHILE(SWITCH=OFF);                   0382
         LA    @10,1                                               0382
         ST    @10,I                                               0382
         B     @DE00382                                            0382
@DL00382 TM    SWITCH,B'00100000'                                  0382
         BNZ   @DC00382                                            0382
*         IF SHAREFLG(I)=CHARS THEN                                0383
         SLA   @10,4                                               0383
         L     @04,SHAREPTR(,R2)                                   0383
         ST    @10,@TF00001                                        0383
         ALR   @10,@04                                             0383
         AL    @10,@CF00727                                        0383
         CLI   SHAREFLG-2(@10),C'S'                                0383
         BNE   @RF00383                                            0383
*           IF KEYWORD(1:7)=SHRCUCPU(I)&KEYWORD(1:7)^=SHRBASE(I) THEN
         LR    @10,@04                                             0384
         AL    @10,@TF00001                                        0384
         AL    @10,@CF00729                                        0384
         CLC   KEYWORD(7),SHRCUCPU-10(@10)                         0384
         BNE   @RF00384                                            0384
         AL    @04,@TF00001                                        0384
         AL    @04,@CF00728                                        0384
         CLC   KEYWORD(7),SHRBASE-3(@04)                           0384
         BE    @RF00384                                            0384
*             DO;                   /* SHARE BASE APPEARS AS ALT     */
*               PLACE=INDEX1-CUAPLACE+THREE;/* POINT TO CUA NUMBER   */
         LR    @10,INDEX1                                          0386
         SL    @10,CUAPLACE                                        0386
         AL    @10,@CF00076                                        0386
         ST    @10,PLACE                                           0386
*               CALL OUTMSG(RANGETAX);/* PRINT INVALID RANGE MESS    */
         LA    @01,@AL00387                                        0387
         BAL   @14,OUTMSG                                          0387
*               SWITCH=ON;          /* GET OUT OF LOOP               */
         OI    SWITCH,B'00100000'                                  0388
*             END;                                                 0389
*           ELSE                                                   0390
*             ;                     /* BASE DOES NOT MATCH           */
@RF00384 DS    0H                                                  0391
*         ELSE                                                     0391
*           ;                       /* ENTRY IS NOT SHARE            */
@RF00383 DS    0H                                                  0392
*       END;                                                       0392
         LA    @10,1                                               0392
         AL    @10,I                                               0392
         ST    @10,I                                               0392
@DE00382 C     @10,INDEX2                                          0392
         BNH   @DL00382                                            0392
@DC00382 DS    0H                                                  0393
*     END;                                                         0393
*   ELSE                                                           0394
*     ;                             /* EMPTY TABLE                   */
@RF00379 DS    0H                                                  0395
*   END BASEALT;                                                   0395
@EL00007 DS    0H                                                  0395
@EF00007 DS    0H                                                  0395
@ER00007 L     @14,@SA00007                                        0395
         LM    @00,@04,@SA00007+4                                  0395
         LM    @06,@12,@SA00007+24                                 0395
         BR    @14                                                 0395
*                                                                  0396
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC PERFORMS CHECKS ON THE CUA RANGE SPECIFIED ON A       */
*/*  SHARE OR CONTROLLER CARD. IT WILL SEE IF THE HIGH CUA IS        */
*/*  AT LEAST AS LARGE AS THE LOW CUA. IT WILL ALSO TEST TO SEE IF   */
*/*  THE RANGE SPECIFIED IS GREATER THAN 32. WHEN THE RANGE IS SPEC -*/
*/*  IFIED IF THE MIDDLE DIGIT OF THE LOW CUA IS ODD THAN THE MIDDLE */
*/*  DIGIT OF THE HIGH CUA MUST BE THE SAME ODD DIGIT. IF THE MIDDLE */
*/*  DIGIT OFF THE LOW CUA IS EVEN THEN THE MIDDLE DIGIT OF THE HIGH */
*/*  CUA MUST EITHER BE THE SAME EVEN DIGIT OR THE NEXT HIGHER ODD   */
*/*  DIGIT.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0396
*CUADIGIT:                                                         0396
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0396
CUADIGIT ST    @14,@SA00008                                        0396
         STM   @00,@04,@SA00008+4                                  0396
         STM   @06,@12,@SA00008+24                                 0396
*   ALTRNG=HOLDAREA(1:2)-KEYWORD(4:5);/* COMPUTE CUA RANGE           */
         MVC   @ZT00002+2(2),HOLDAREA                              0397
         L     @10,@ZT00002                                        0397
         MVC   @ZT00002+2(2),KEYWORD+3                             0397
         SL    @10,@ZT00002                                        0397
         ST    @10,@TF00001                                        0397
         MVC   ALTRNG(2),@TF00001+2                                0397
*   IF ALTRNG<HEXZEROS×ALTRNG>THIRTYON THEN/* HIGH>LOW AND RANGE<33  */
         CLC   ALTRNG(2),@CB00209                                  0398
         BL    @RT00398                                            0398
         CLC   ALTRNG(2),@CB00620                                  0398
         BNH   @RF00398                                            0398
@RT00398 DS    0H                                                  0399
*     DO;                                                          0399
*       PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF '*' IN MESSAGE    */
         LR    @10,INDEX1                                          0400
         SL    @10,CUAPLACE                                        0400
         AL    @10,@CF00076                                        0400
         ST    @10,PLACE                                           0400
*       CALL OUTMSG(RANGESYN);      /* INVALID RANGE MESSAGE         */
         LA    @01,@AL00401                                        0401
         BAL   @14,OUTMSG                                          0401
*       RESPECIFY                                                  0402
*        (R15) RESTRICTED;                                         0402
*       R15=TWELVE;                 /* PUT RETURN CODE IN REG 15     */
         LA    R15,12                                              0403
*     END;                                                         0404
*   ELSE                                                           0405
*     IF CUAHOLD(2)=CUAHOLD2(2) THEN/* TEST 2ND DIGITS OF CUA        */
         B     @RC00398                                            0405
@RF00398 CLC   CUAHOLD+1(1),CUAHOLD2+1                             0405
         BNE   @RF00405                                            0405
*       R15=ZERO;                   /* DIGITS ARE EQUAL SO RANGE   0406
*                                      PASSES                        */
         SLR   R15,R15                                             0406
*     ELSE                                                         0407
*       IF KEYBIT12=ON THEN         /* TEST IF ODD 2ND DIGIT         */
         B     @RC00405                                            0407
@RF00405 TM    KEYBIT12,B'00010000'                                0407
         BNO   @RF00407                                            0407
*         DO;                       /* DIGIT IS ODD BUT UNEQUAL      */
*           RESPECIFY                                              0409
*            (R15) UNRESTRICTED;                                   0409
*           PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF SYNTAX ERROR  */
         LR    @10,INDEX1                                          0410
         SL    @10,CUAPLACE                                        0410
         AL    @10,@CF00076                                        0410
         ST    @10,PLACE                                           0410
*           CALL OUTMSG(RANGESYN);  /* INVALID RANGE MESSAGE         */
         LA    @01,@AL00411                                        0411
         BAL   @14,OUTMSG                                          0411
*           RESPECIFY                                              0412
*            (R15) RESTRICTED;                                     0412
*           R15=TWELVE;             /* PUT RETURN CODE IN REG 15     */
         LA    R15,12                                              0413
*           RESPECIFY                                              0414
*            (R15) UNRESTRICTED;                                   0414
*         END;                                                     0415
*       ELSE                                                       0416
*         DO;                       /* 2ND DIGIT OF CUA IS EVEN      */
         B     @RC00407                                            0416
@RF00407 DS    0H                                                  0417
*           CUADIG=CUAHOLD2(2)-CUAHOLD(2);/* DIFFERENCE IN MIDDLE  0417
*                                      DIGITS                        */
         SLR   @10,@10                                             0417
         IC    @10,CUAHOLD2+1                                      0417
         MVC   @ZT00003+3(1),CUAHOLD+1                             0417
         SL    @10,@ZT00003                                        0417
         STC   @10,CUADIG                                          0417
*           IF CUADIG^=ONE THEN     /* DIFFERENCE IS GREATER THAN 1  */
         CLI   CUADIG,1                                            0418
         BE    @RF00418                                            0418
*             DO;                                                  0419
*               PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF SYNTAX  0420
*                                      ERROR                         */
         LR    @10,INDEX1                                          0420
         SL    @10,CUAPLACE                                        0420
         AL    @10,@CF00076                                        0420
         ST    @10,PLACE                                           0420
*               CALL OUTMSG(RANGESYN);/* INVALID RANGE MESSAGE       */
         LA    @01,@AL00421                                        0421
         BAL   @14,OUTMSG                                          0421
*               RESPECIFY                                          0422
*                (R15) RESTRICTED;                                 0422
*               R15=TWELVE;         /* SET RETURN CODE IN REG 15     */
         LA    R15,12                                              0423
*             END;                                                 0424
*           ELSE                                                   0425
*             R15=ZERO;             /* SET RETURN CODE IN REG 15     */
         B     @RC00418                                            0425
@RF00418 SLR   R15,R15                                             0425
*         END;                                                     0426
*   RESPECIFY                                                      0427
*    (R15) UNRESTRICTED;                                           0427
*   END CUADIGIT;                                                  0428
@EL00008 DS    0H                                                  0428
@EF00008 DS    0H                                                  0428
@ER00008 L     @14,@SA00008                                        0428
         LM    @00,@04,@SA00008+4                                  0428
         LM    @06,@12,@SA00008+24                                 0428
         BR    @14                                                 0428
*                                                                  0429
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL TEST TO SEE IF THE RANGE OF THE CUAS CURRENTLY   */
*/*  BEING PROCESSED OVERLAPS WITH AN ENTRY IN THE SHARE/CONTROLLER  */
*/*  TABLE. IF THE CUAS APPEAR ANYWHERE ELSE IN THE TABLE THE LOW AND*/
*/*  HIGH CUAS MUST BE THE SAME.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0429
*SHRSEARH:                                                         0429
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0429
SHRSEARH ST    @14,@SA00009                                        0429
         STM   @00,@04,@SA00009+4                                  0429
         STM   @06,@12,@SA00009+24                                 0429
*   SWITCH=OFF;                                                    0430
         NI    SWITCH,B'11011111'                                  0430
*   DO I=1 TO INDEX2 BY 1 WHILE(SWITCH=OFF);                       0431
*                                                                  0431
         LA    @10,1                                               0431
         ST    @10,I                                               0431
         B     @DE00431                                            0431
@DL00431 TM    SWITCH,B'00100000'                                  0431
         BNZ   @DC00431                                            0431
*     /***************************************************************/
*     /*                                                             */
*     /* TEST BASE CPU/CUA ENTRY                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0432
*     IF KEYWORD(1:3)=SHARSERB(I) THEN/* TEST FOR LIKE SERIAL WITH 0432
*                                      BASE                          */
         SLA   @10,4                                               0432
         L     @04,SHAREPTR(,R2)                                   0432
         ST    @10,@TF00001                                        0432
         ALR   @10,@04                                             0432
         AL    @10,@CF00728                                        0432
         CLC   KEYWORD(3),SHARSERB-3(@10)                          0432
         BNE   @RF00432                                            0432
*       IF(KEYWORD(4:5)>=SHRCUABL(I)&KEYWORD(4:5)<=SHRCUABH(I))×(  0433
*           HOLDAREA(1:2)>=SHRCUABL(I)&HOLDAREA(1:2)<=SHRCUABH(I))×(
*           SHRCUABL(I)>=KEYWORD(4:5)&SHRCUABL(I)<=HOLDAREA(1:2))×(
*           SHRCUABH(I)>=KEYWORD(4:5)&SHRCUABH(I)<=HOLDAREA(1:2)) THEN
         LR    @10,@04                                             0433
         AL    @10,@TF00001                                        0433
         AL    @10,@CF00733                                        0433
         CLC   KEYWORD+3(2),SHRCUABL-6(@10)                        0433
         BL    @GL00018                                            0433
         AL    @04,@TF00001                                        0433
         AL    @04,@CF00734                                        0433
         CLC   KEYWORD+3(2),SHRCUABH-8(@04)                        0433
         BNH   @RT00433                                            0433
@GL00018 L     @10,I                                               0433
         SLA   @10,4                                               0433
         L     @04,SHAREPTR(,R2)                                   0433
         ST    @10,@TF00001                                        0433
         ALR   @10,@04                                             0433
         AL    @10,@CF00733                                        0433
         CLC   HOLDAREA(2),SHRCUABL-6(@10)                         0433
         BL    @GL00017                                            0433
         AL    @04,@TF00001                                        0433
         AL    @04,@CF00734                                        0433
         CLC   HOLDAREA(2),SHRCUABH-8(@04)                         0433
         BNH   @RT00433                                            0433
@GL00017 L     @10,I                                               0433
         SLA   @10,4                                               0433
         L     @04,SHAREPTR(,R2)                                   0433
         ST    @10,@TF00001                                        0433
         ALR   @10,@04                                             0433
         AL    @10,@CF00733                                        0433
         CLC   SHRCUABL-6(2,@10),KEYWORD+3                         0433
         BL    @GL00016                                            0433
         AL    @04,@TF00001                                        0433
         AL    @04,@CF00733                                        0433
         CLC   SHRCUABL-6(2,@04),HOLDAREA                          0433
         BNH   @RT00433                                            0433
@GL00016 L     @10,I                                               0433
         SLA   @10,4                                               0433
         L     @04,SHAREPTR(,R2)                                   0433
         ST    @10,@TF00001                                        0433
         ALR   @10,@04                                             0433
         AL    @10,@CF00734                                        0433
         CLC   SHRCUABH-8(2,@10),KEYWORD+3                         0433
         BL    @RF00433                                            0433
         AL    @04,@TF00001                                        0433
         AL    @04,@CF00734                                        0433
         CLC   SHRCUABH-8(2,@04),HOLDAREA                          0433
         BH    @RF00433                                            0433
@RT00433 DS    0H                                                  0434
*         IF KEYWORD(1:7)^=SHRBASE(I) THEN/* OVERLAPPING NON EQUAL 0434
*                                      RANGE                         */
         L     @10,I                                               0434
         SLA   @10,4                                               0434
         L     @04,SHAREPTR(,R2)                                   0434
         ALR   @04,@10                                             0434
         AL    @04,@CF00728                                        0434
         CLC   KEYWORD(7),SHRBASE-3(@04)                           0434
         BE    @RF00434                                            0434
*           DO;                                                    0435
*             PLACE=INDEX1-CUAPLACE+THREE;/* '*' POSITION IN MESSAGE */
         LR    @10,INDEX1                                          0436
         SL    @10,CUAPLACE                                        0436
         AL    @10,@CF00076                                        0436
         ST    @10,PLACE                                           0436
*             CALL OUTMSG(RANGETAX);/* INVALID RANGE MESSAGE         */
         LA    @01,@AL00437                                        0437
         BAL   @14,OUTMSG                                          0437
*             SWITCH=ON;            /* GET OUT OF LOOP               */
         OI    SWITCH,B'00100000'                                  0438
*           END;                                                   0439
*         ELSE                                                     0440
*           ;                       /* RANGE OKAY                    */
@RF00434 DS    0H                                                  0441
*       ELSE                                                       0441
*         ;                         /* RANGE OKAY                    */
@RF00433 DS    0H                                                  0442
*     ELSE                                                         0442
*       ;                           /* CPU NUMBERS DIFFERENT         */
*                                                                  0442
@RF00432 DS    0H                                                  0443
*     /***************************************************************/
*     /*                                                             */
*     /* TEST ALT CPU/CUA IF NO ERROR FOUND                          */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0443
*     IF SHAREFLG(I)=CHARS&SWITCH=OFF&KEYWORD(1:3)=SHARSERA(I) THEN
         L     @10,I                                               0443
         SLA   @10,4                                               0443
         L     @04,SHAREPTR(,R2)                                   0443
         ST    @10,@TF00001                                        0443
         ALR   @10,@04                                             0443
         AL    @10,@CF00727                                        0443
         CLI   SHAREFLG-2(@10),C'S'                                0443
         BNE   @RF00443                                            0443
         TM    SWITCH,B'00100000'                                  0443
         BNZ   @RF00443                                            0443
         LR    @10,@04                                             0443
         AL    @10,@TF00001                                        0443
         AL    @10,@CF00729                                        0443
         CLC   KEYWORD(3),SHARSERA-10(@10)                         0443
         BNE   @RF00443                                            0443
*       IF(KEYWORD(4:5)>=SHRCUAAL(I)&KEYWORD(4:5)<=SHRCUAAH(I))×(  0444
*           HOLDAREA(1:2)>=SHRCUAAL(I)&HOLDAREA(1:2)<=SHRCUAAH(I))×(
*           SHRCUAAL(I)>=KEYWORD(4:5)&SHRCUAAL(I)<=HOLDAREA(1:2))×(
*           SHRCUAAH(I)>=KEYWORD(4:5)&SHRCUAAH(I)<=HOLDAREA(1:2)) THEN
         LR    @10,@04                                             0444
         AL    @10,@TF00001                                        0444
         AL    @10,@CF00735                                        0444
         CLC   KEYWORD+3(2),SHRCUAAL-13(@10)                       0444
         BL    @GL00027                                            0444
         AL    @04,@TF00001                                        0444
         BCTR  @04,0                                               0444
         CLC   KEYWORD+3(2),SHRCUAAH-15(@04)                       0444
         BNH   @RT00444                                            0444
@GL00027 L     @10,I                                               0444
         SLA   @10,4                                               0444
         L     @04,SHAREPTR(,R2)                                   0444
         ST    @10,@TF00001                                        0444
         ALR   @10,@04                                             0444
         AL    @10,@CF00735                                        0444
         CLC   HOLDAREA(2),SHRCUAAL-13(@10)                        0444
         BL    @GL00026                                            0444
         AL    @04,@TF00001                                        0444
         BCTR  @04,0                                               0444
         CLC   HOLDAREA(2),SHRCUAAH-15(@04)                        0444
         BNH   @RT00444                                            0444
@GL00026 L     @10,I                                               0444
         SLA   @10,4                                               0444
         L     @04,SHAREPTR(,R2)                                   0444
         ST    @10,@TF00001                                        0444
         ALR   @10,@04                                             0444
         AL    @10,@CF00735                                        0444
         CLC   SHRCUAAL-13(2,@10),KEYWORD+3                        0444
         BL    @GL00025                                            0444
         AL    @04,@TF00001                                        0444
         AL    @04,@CF00735                                        0444
         CLC   SHRCUAAL-13(2,@04),HOLDAREA                         0444
         BNH   @RT00444                                            0444
@GL00025 L     @10,I                                               0444
         SLA   @10,4                                               0444
         L     @04,SHAREPTR(,R2)                                   0444
         ST    @10,@TF00001                                        0444
         ALR   @10,@04                                             0444
         BCTR  @10,0                                               0444
         CLC   SHRCUAAH-15(2,@10),KEYWORD+3                        0444
         BL    @RF00444                                            0444
         AL    @04,@TF00001                                        0444
         BCTR  @04,0                                               0444
         CLC   SHRCUAAH-15(2,@04),HOLDAREA                         0444
         BH    @RF00444                                            0444
@RT00444 DS    0H                                                  0445
*         IF KEYWORD(1:7)^=SHRCUCPU(I) THEN                        0445
         L     @10,I                                               0445
         SLA   @10,4                                               0445
         L     @04,SHAREPTR(,R2)                                   0445
         ALR   @04,@10                                             0445
         AL    @04,@CF00729                                        0445
         CLC   KEYWORD(7),SHRCUCPU-10(@04)                         0445
         BE    @RF00445                                            0445
*           DO;                                                    0446
*             PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF SYNTAX ERROR*/
         LR    @10,INDEX1                                          0447
         SL    @10,CUAPLACE                                        0447
         AL    @10,@CF00076                                        0447
         ST    @10,PLACE                                           0447
*             CALL OUTMSG(RANGETAX);/* INVALID RANGE MESSAGE         */
         LA    @01,@AL00448                                        0448
         BAL   @14,OUTMSG                                          0448
*             SWITCH=ON;            /* GET OUT OF LOOP               */
         OI    SWITCH,B'00100000'                                  0449
*             RETCODE=TWELVE;       /* SET RETURN CODE               */
         L     @10,@PC00001                                        0450
         MVC   RETCODE(4,@10),@CF00066                             0450
*           END;                                                   0451
*         ELSE                                                     0452
*           ;                       /* RANGE OKAY                    */
@RF00445 DS    0H                                                  0453
*       ELSE                                                       0453
*         ;                         /* RANGE OKAY                    */
@RF00444 DS    0H                                                  0454
*     ELSE                                                         0454
*       ;                           /* CPU # DIFFERENT               */
@RF00443 DS    0H                                                  0455
*     RESPECIFY                                                    0455
*      (R15) RESTRICTED;                                           0455
*     IF SWITCH=ON THEN             /* TEST FOR INVALID RANGE        */
         TM    SWITCH,B'00100000'                                  0456
         BNO   @RF00456                                            0456
*       R15=TWELVE;                 /* SET RETURN CODE               */
         LA    R15,12                                              0457
*     ELSE                                                         0458
*       R15=ZERO;                   /* SET GOOD RETURN CODE          */
         B     @RC00456                                            0458
@RF00456 SLR   R15,R15                                             0458
*     RESPECIFY                                                    0459
*      (R15) UNRESTRICTED;                                         0459
@RC00456 DS    0H                                                  0460
*   END;                                                           0460
         LA    @10,1                                               0460
         AL    @10,I                                               0460
         ST    @10,I                                               0460
@DE00431 C     @10,INDEX2                                          0460
         BNH   @DL00431                                            0460
@DC00431 DS    0H                                                  0461
*   END SHRSEARH;                                                  0461
@EL00009 DS    0H                                                  0461
@EF00009 DS    0H                                                  0461
@ER00009 L     @14,@SA00009                                        0461
         LM    @00,@04,@SA00009+4                                  0461
         LM    @06,@12,@SA00009+24                                 0461
         BR    @14                                                 0461
*                                                                  0462
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL MAKE RANGE CHECKS ON THE ALTERNATE CUAS INPUT    */
*/*  ON A SHARE CARD ONLY. THE RANGE OF THE ALTERNATE CUAS MUST BE   */
*/*  EQUAL TO THE RANGE OF THE BASE CUAS. THE ALTERNATE CPU/CUA      */
*/*  MUST NOT APPEAR AS THE BASE ENTRY OF ANOTHER SHARE CARD OR AS   */
*/*  THE ALTERNATE OF MORE THAN ONE CPU/CUA.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0462
*ALTRANGE:                                                         0462
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0462
ALTRANGE ST    @14,@SA00010                                        0462
         STM   @00,@04,@SA00010+4                                  0462
         STM   @06,@12,@SA00010+24                                 0462
*   BASERNG=BASEHCUA-BASELCUA;      /* RANGE OF BASE CUAS            */
         MVC   @ZT00002+2(2),BASEHCUA                              0463
         L     @10,@ZT00002                                        0463
         MVC   @ZT00002+2(2),BASELCUA                              0463
         SL    @10,@ZT00002                                        0463
         ST    @10,@TF00001                                        0463
         MVC   BASERNG(2),@TF00001+2                               0463
*   ALTRNG=KEYWORD(6:7)-KEYWORD(4:5);/* RANGE OF ALT CUAS            */
         MVC   @ZT00002+2(2),KEYWORD+5                             0464
         L     @10,@ZT00002                                        0464
         MVC   @ZT00002+2(2),KEYWORD+3                             0464
         SL    @10,@ZT00002                                        0464
         ST    @10,@TF00001                                        0464
         MVC   ALTRNG(2),@TF00001+2                                0464
*   IF ALTRNG^=BASERNG THEN         /* SEE IF RANGES ARE EQUAL       */
         CLC   ALTRNG(2),BASERNG                                   0465
         BE    @RF00465                                            0465
*     DO;                                                          0466
*       PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF SYNTAX ERROR      */
         LR    @10,INDEX1                                          0467
         SL    @10,CUAPLACE                                        0467
         AL    @10,@CF00076                                        0467
         ST    @10,PLACE                                           0467
*       CALL OUTMSG(RANGESYN);      /* INVALID RANGE MESSAGE         */
         LA    @01,@AL00468                                        0468
         BAL   @14,OUTMSG                                          0468
*       RESPECIFY                                                  0469
*        (R15) RESTRICTED;                                         0469
*       R15=TWELVE;                 /* PUT RETURN CODE IN R15        */
         LA    R15,12                                              0470
*       RESPECIFY                                                  0471
*        (R15) UNRESTRICTED;                                       0471
*     END;                                                         0472
*   ELSE                            /* TEST FOR ALT AS BASE          */
*     DO;                                                          0473
         B     @RC00465                                            0473
@RF00465 DS    0H                                                  0474
*       RESPECIFY                                                  0474
*        (R15) RESTRICTED;                                         0474
*       SWITCH=OFF;                 /* SEE IF ALT CPU/CUA IS A BASE  */
         NI    SWITCH,B'11011111'                                  0475
*       DO I=1 TO INDEX2 BY 1 WHILE(SWITCH=OFF);                   0476
         LA    @14,1                                               0476
         ST    @14,I                                               0476
         B     @DE00476                                            0476
@DL00476 TM    SWITCH,B'00100000'                                  0476
         BNZ   @DC00476                                            0476
*         IF SHAREFLG(I)=CHARS&(SHRBASE(I)=KEYWORD(1:7)×(KEYWORD(1:7)=
*             SHRCUCPU(I)&BASENTRY^=SHRBASE(I))) THEN              0477
         SLA   @14,4                                               0477
         L     @10,SHAREPTR(,R2)                                   0477
         ST    @14,@TF00001                                        0477
         ALR   @14,@10                                             0477
         AL    @14,@CF00727                                        0477
         CLI   SHAREFLG-2(@14),C'S'                                0477
         BNE   @RF00477                                            0477
         LR    @14,@10                                             0477
         AL    @14,@TF00001                                        0477
         AL    @14,@CF00728                                        0477
         CLC   SHRBASE-3(7,@14),KEYWORD                            0477
         BE    @RT00477                                            0477
         LR    @14,@10                                             0477
         AL    @14,@TF00001                                        0477
         AL    @14,@CF00729                                        0477
         CLC   KEYWORD(7),SHRCUCPU-10(@14)                         0477
         BNE   @RF00477                                            0477
         AL    @10,@TF00001                                        0477
         AL    @10,@CF00728                                        0477
         CLC   BASENTRY(7),SHRBASE-3(@10)                          0477
         BE    @RF00477                                            0477
@RT00477 DS    0H                                                  0478
*           DO;                     /* ERROR FOUND                   */
*             SWITCH=ON;            /* GET OUT OF LOOP               */
         OI    SWITCH,B'00100000'                                  0479
*             PLACE=INDEX1-CUAPLACE+THREE;/* POSITION OF SYNTAX ERROR*/
         LR    @14,INDEX1                                          0480
         SL    @14,CUAPLACE                                        0480
         AL    @14,@CF00076                                        0480
         ST    @14,PLACE                                           0480
*             CALL OUTMSG(RANGETAX);/* INVALID RANGE MESSAGE         */
         LA    @01,@AL00481                                        0481
         BAL   @14,OUTMSG                                          0481
*             R15=TWELVE;           /* SET RETURN CODE               */
         LA    R15,12                                              0482
*           END;                                                   0483
*         ELSE                                                     0484
*           R15=ZERO;               /* SET RETURN CODE               */
         B     @RC00477                                            0484
@RF00477 SLR   R15,R15                                             0484
*       END;                                                       0485
@RC00477 LA    @14,1                                               0485
         AL    @14,I                                               0485
         ST    @14,I                                               0485
@DE00476 C     @14,INDEX2                                          0485
         BNH   @DL00476                                            0485
@DC00476 DS    0H                                                  0486
*       RESPECIFY                                                  0486
*        (R15) UNRESTRICTED;                                       0486
*     END;                                                         0487
*   END ALTRANGE;                                                  0488
@EL00010 DS    0H                                                  0488
@EF00010 DS    0H                                                  0488
@ER00010 L     @14,@SA00010                                        0488
         LM    @00,@04,@SA00010+4                                  0488
         LM    @06,@12,@SA00010+24                                 0488
         BR    @14                                                 0488
*                                                                  0489
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL SEARCH THE INPUT CARD PARMFLD FOR ONE OF THREE   */
*/*  DELIMITERS. THE ACCEPTED DELIMITERS ARE ',' OR ')' OR ' '. IT   */
*/*  WILL START THE SEARCH AT INDEX1 AND CONTINUE UNTIL THE END OF   */
*/*  INPUT (ENDCARD). IT WILL SET INDEX1 TO THE LAST PLACE SCANED.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0489
*FINDDELM:                                                         0489
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0489
FINDDELM ST    @14,12(,@13)                                        0489
         STM   @00,@04,20(@13)                                     0489
         STM   @06,@12,44(@13)                                     0489
*   DO I=INDEX1 TO ENDCARD BY 1 WHILE(PARMFLD(I)^=COMMA&PARMFLD(I)^=
*         RPAREN&PARMFLD(I)^=BLANK);                               0490
         LR    @10,INDEX1                                          0490
         ST    @10,I                                               0490
         B     @DE00490                                            0490
@DL00490 LA    @04,PARMFLD-1(@10)                                  0490
         CLI   0(@04),C','                                         0490
         BE    @DC00490                                            0490
         LA    @04,PARMFLD-1(@10)                                  0490
         CLI   0(@04),C')'                                         0490
         BE    @DC00490                                            0490
         LA    @04,PARMFLD-1(@10)                                  0490
         CLI   0(@04),C' '                                         0490
         BE    @DC00490                                            0490
*   END;                                                           0491
         AL    @10,@CF00053                                        0491
         ST    @10,I                                               0491
@DE00490 CH    @10,@CH00596                                        0491
         BNH   @DL00490                                            0491
@DC00490 DS    0H                                                  0492
*   INDEX1=I;                       /* SET POINTER TO NEXT CPU/CUA   */
         L     INDEX1,I                                            0492
*   END FINDDELM;                                                  0493
@EL00011 DS    0H                                                  0493
@EF00011 DS    0H                                                  0493
@ER00011 L     @14,12(,@13)                                        0493
         LM    @00,@04,20(@13)                                     0493
         LM    @06,@12,44(@13)                                     0493
         BR    @14                                                 0493
*                                                                  0494
*/********************************************************************/
*/*                                                                  */
*/*  OUTPUT AN ERROR MESSAGE.  THE FLAG BEING PASSED AS A PARAMETER  */
*/*  INDICATES THE TYPE OF ERROR.  IF THE INPUT PARAMETER STRING HAS */
*/*  NOT BEEN OUTPUT, A HEADING IS WRITTEN OUT AND THE PARAMETER     */
*/*  STRING IS WRITTEN OUT.  THEN THE ERROR MESSAGE IS WRITTEN OUT   */
*/*  WITH AN ASTERISK IN THE PLACE WHERE THE SCAN ROUTINE IS LOCATED.*/
*/*  THIS SHOULD INDICATE THE LOCATION OF THE ERROR.                 */
*/********************************************************************/
*                                                                  0494
*OUTMSG:                                                           0494
*   PROC(ERROR) OPTIONS(DONTSAVE(R5,R15));                         0494
OUTMSG   ST    @14,@SA00012                                        0494
         STM   @00,@04,@SA00012+4                                  0494
         STM   @06,@12,@SA00012+24                                 0494
         MVC   @PC00012(4),0(@01)                                  0494
*   DCL                                                            0495
*     ERROR FIXED(31);                                             0495
*   IF INDEX1<=80 THEN                                             0496
         CH    INDEX1,@CH00540                                     0496
         BH    @RF00496                                            0496
*     DO INDEX1=INDEX1-PLACE;                                      0497
         LR    @10,INDEX1                                          0497
         SL    @10,PLACE                                           0497
         LR    INDEX1,@10                                          0497
*       IF ERROR=RANGETAX THEN                                     0498
         L     @10,@PC00012                                        0498
         CLC   ERROR(4,@10),@CF00074                               0498
         BNE   @RF00498                                            0498
*         CALL IFCMSG(91,ADDR(MSGNO));/* RANGE OVERLAPS INVALIDLY    */
         LA    @10,MSGNO                                           0499
         ST    @10,@AFTEMPS                                        0499
         L     @15,ADIFCMSG(,R2)                                   0499
         LA    @01,@AL00499                                        0499
         BALR  @14,@15                                             0499
*       ELSE                                                       0500
*         IF ERROR=RANGESYN THEN                                   0500
         B     @RC00498                                            0500
@RF00498 L     @10,@PC00012                                        0500
         CLC   ERROR(4,@10),@CF00076                               0500
         BNE   @RF00500                                            0500
*           CALL IFCMSG(90,ADDR(MSGNO));/* RANGE HAS SYNTAX ERROR    */
         LA    @10,MSGNO                                           0501
         ST    @10,@AFTEMPS                                        0501
         L     @15,ADIFCMSG(,R2)                                   0501
         LA    @01,@AL00501                                        0501
         BALR  @14,@15                                             0501
*         ELSE                                                     0502
*           CALL IFCMSG(65,ADDR(MSGNO));/* SYNTAX ERROR              */
         B     @RC00500                                            0502
@RF00500 LA    @10,MSGNO                                           0502
         ST    @10,@AFTEMPS                                        0502
         L     @15,ADIFCMSG(,R2)                                   0502
         LA    @01,@AL00502                                        0502
         BALR  @14,@15                                             0502
*       PARMPRT(INDEX1)=STAR;       /* INSERT ASTERISK               */
@RC00500 DS    0H                                                  0503
@RC00498 LA    @10,PARMPRT-1(INDEX1)                               0503
         MVI   0(@10),C'*'                                         0503
*       PRINTADR=ADDR(PARMPT);      /* ADDR OF OUPUT BUFFER          */
         LA    @10,PARMPT                                          0504
         ST    @10,PRINTADR(,R2)                                   0504
*       CALL IOHND(RITEPRTR);       /* WRITE ERROR MESSAGE           */
         L     @15,ADIOHND(,R2)                                    0505
         LA    @01,@AL00505                                        0505
         BALR  @14,@15                                             0505
*       INDEX1=INDEX1+PLACE;                                       0506
         AL    INDEX1,PLACE                                        0506
*     END;                                                         0507
*   PLACE=ZERO;                                                    0508
@RF00496 SLR   @10,@10                                             0508
         ST    @10,PLACE                                           0508
*   RETCODE=TWELVE;                 /* SET RETURN CODE               */
         L     @10,@PC00001                                        0509
         MVC   RETCODE(4,@10),@CF00066                             0509
*   END;                                                           0510
@EL00012 DS    0H                                                  0510
@EF00012 DS    0H                                                  0510
@ER00012 L     @14,@SA00012                                        0510
         LM    @00,@04,@SA00012+4                                  0510
         LM    @06,@12,@SA00012+24                                 0510
         BR    @14                                                 0510
*                                                                  0511
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL PRINT THE ERROR MESSAGE THAT THE SHARE/CONTROLLER*/
*/*  TABLE IS FULL.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0511
*MSGTABFL:                                                         0511
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0511
MSGTABFL ST    @14,@SA00013                                        0511
         STM   @00,@04,@SA00013+4                                  0511
         STM   @06,@12,@SA00013+24                                 0511
*   CALL IFCMSG(89,ADDR(MSGNO));    /* GET MESSAGE TEXT              */
         LA    @10,MSGNO                                           0512
         ST    @10,@AFTEMPS+4                                      0512
         L     @15,ADIFCMSG(,R2)                                   0512
         LA    @01,@AL00512                                        0512
         BALR  @14,@15                                             0512
*   PRINTADR=ADDR(PARMPT);                                         0513
         LA    @10,PARMPT                                          0513
         ST    @10,PRINTADR(,R2)                                   0513
*   CALL IOHND(RITEPRTR);           /* WRITE ERROR MESSAGE           */
         L     @15,ADIOHND(,R2)                                    0514
         LA    @01,@AL00514                                        0514
         BALR  @14,@15                                             0514
*   RETCODE=TWELVE;                 /* SET RETURN CODE               */
         L     @10,@PC00001                                        0515
         MVC   RETCODE(4,@10),@CF00066                             0515
*   END MSGTABFL;                                                  0516
@EL00013 DS    0H                                                  0516
@EF00013 DS    0H                                                  0516
@ER00013 L     @14,@SA00013                                        0516
         LM    @00,@04,@SA00013+4                                  0516
         LM    @06,@12,@SA00013+24                                 0516
         BR    @14                                                 0516
*                                                                  0517
*/********************************************************************/
*/*                                                                  */
*/*  CONVERT THE HEXADECIMAL VALUES IN THE BYTES STRAIGHT TO         */
*/*  CHARACTER REPRESENTATION.                                       */
*/********************************************************************/
*                                                                  0517
*UNPACK:                                                           0517
*   PROC(OPLEN) OPTIONS(DONTSAVE(R5,R15));                         0517
UNPACK   ST    @14,@SA00014                                        0517
         STM   @00,@04,@SA00014+4                                  0517
         STM   @06,@12,@SA00014+24                                 0517
         MVC   @PC00014(4),0(@01)                                  0517
*   DCL                                                            0518
*     OPLEN FIXED(31);              /* NUMBER OF CHAR TO CONVERT     */
*   DO J=1 TO OPLEN BY 1;                                          0519
         LA    @10,1                                               0519
         ST    @10,J                                               0519
         B     @DE00519                                            0519
@DL00519 DS    0H                                                  0520
*     HOLDAREA=HOLDAREA&&HOLDAREA;  /* CHEAR HOLD AREA               */
         XC    HOLDAREA(5),HOLDAREA                                0520
*     HOLDAREA(2)=PARMFLD(J);       /* CHARACTERS ARE IN PARMFLD     */
         LA    @04,PARMFLD-1(@10)                                  0521
         MVC   HOLDAREA+1(1),0(@04)                                0521
*     SLL(HOLDAREA(1:2),FOUR);      /* SHIFT FIRST TO FIRST BYTE     */
         MVC   @ZT00002+2(2),HOLDAREA                              0522
         L     @04,@ZT00002                                        0522
         SLL   @04,4                                               0522
         STH   @04,@TF00001                                        0522
         MVC   HOLDAREA(2),@TF00001                                0522
*     SRL(HOLDAREA(2:2),FOUR);      /* SECOND TO SECOND BYTE         */
         SLR   @04,@04                                             0523
         IC    @04,HOLDAREA+1                                      0523
         SRL   @04,4                                               0523
         STC   @04,HOLDAREA+1                                      0523
*     INDEX3=HOLDAREA(1)+1;         /* GET VALUE AS INDEX            */
         LA    @04,1                                               0524
         SLR   @03,@03                                             0524
         IC    @03,HOLDAREA                                        0524
         ALR   @03,@04                                             0524
         ST    @03,INDEX3                                          0524
*     PARMPT(2*J+1)=NUMTAB(INDEX3); /* STORE CHARACTER               */
         LR    @15,@10                                             0525
         ALR   @15,@15                                             0525
         LA    @14,PARMPT(@15)                                     0525
         LA    @01,NUMTAB-1(@03)                                   0525
         MVC   0(1,@14),0(@01)                                     0525
*     INDEX3=HOLDAREA(2)+1;         /* GET VALUE AS INDEX            */
         MVC   @ZT00003+3(1),HOLDAREA+1                            0526
         AL    @04,@ZT00003                                        0526
         ST    @04,INDEX3                                          0526
*     PARMPT(2*J+2)=NUMTAB(INDEX3); /* STORE CHARACTER               */
         LA    @03,PARMPT+1(@15)                                   0527
         LA    @01,NUMTAB-1(@04)                                   0527
         MVC   0(1,@03),0(@01)                                     0527
*   END;                                                           0528
         AL    @10,@CF00053                                        0528
         ST    @10,J                                               0528
@DE00519 L     @04,@PC00014                                        0528
         C     @10,OPLEN(,@04)                                     0528
         BNH   @DL00519                                            0528
*   PRINTADR=ADDR(PARMPT);                                         0529
         LA    @10,PARMPT                                          0529
         ST    @10,PRINTADR(,R2)                                   0529
*   CALL IOHND(RITEPRTR);                                          0530
         L     @15,ADIOHND(,R2)                                    0530
         LA    @01,@AL00530                                        0530
         BALR  @14,@15                                             0530
*   END;                                                           0531
@EL00014 DS    0H                                                  0531
@EF00014 DS    0H                                                  0531
@ER00014 L     @14,@SA00014                                        0531
         LM    @00,@04,@SA00014+4                                  0531
         LM    @06,@12,@SA00014+24                                 0531
         BR    @14                                                 0531
*                                                                  0532
*/********************************************************************/
*/*                                                                  */
*/*  VALID THE FIELD STARTING AT PARMFLD(INDEX1) FOR A LENGTH AS     */
*/*  GIVEN AS THE INPUT PARAMETER.  IF A CHARACTER IS NOT FOUND TO   */
*/*  BE A VALID NUMERIC, THE FIELD IS INDICATED AS HAVING A SYNTAX   */
*/*  ERROR.  THE CONTENTS OF THE ORIGINAL FIELD ARE CHANGED TO THE   */
*/*  HEXADECIMAL EQUIVALENT FOR THE CHARACTER.  THOSE VALUES CAN THEN*/
*/*  BE EASILY CONVERTED FOR THE NECESSARY FIELD.                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0532
*VALIDNUM:                                                         0532
*   PROC(LENGTHV) OPTIONS(DONTSAVE(R5,R15));                       0532
VALIDNUM ST    @14,@SA00015                                        0532
         STM   @00,@04,@SA00015+4                                  0532
         STM   @06,@12,@SA00015+24                                 0532
         MVC   @PC00015(4),0(@01)                                  0532
*   DCL                                                            0533
*     LENGTHV FIXED(31);            /* LENGTH OF THE INPUT FLD       */
*   SWITCH=OFF;                     /* INDICATOR OF INVALID DIGIT    */
         NI    SWITCH,B'11011111'                                  0534
*   I=INDEX1+LENGTHV-1;             /* LAST CHARACTER POSITION       */
         L     @10,@PC00015                                        0535
         LR    @04,INDEX1                                          0535
         AL    @04,LENGTHV(,@10)                                   0535
         BCTR  @04,0                                               0535
         ST    @04,I                                               0535
*   DO INDEX3=INDEX1 TO I BY 1;                                    0536
         LR    @10,INDEX1                                          0536
         ST    @10,INDEX3                                          0536
         B     @DE00536                                            0536
@DL00536 DS    0H                                                  0537
*     VALID=OFF;                                                   0537
*                                                                  0537
         NI    VALID,B'01111111'                                   0537
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK TO SEE IF THE FIELD IS A VALID DECIMAL NUMBER. IF YES,*/
*     /* TERMINATE THE SEARCH AND REPLACE THE CHARACTER WITH         */
*     /* HEXADECIMAL EQUIVALENT. IF NO, PRINT AN ERROR MESSAGE FOR   */
*     /* THIS OPERAND.                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0538
*     DO J=10 TO 1 BY-1 WHILE(VALID=OFF);                          0538
         LA    @10,10                                              0538
         ST    @10,J                                               0538
@DL00538 TM    VALID,B'10000000'                                   0538
         BNZ   @DC00538                                            0538
*       IF PARMFLD(INDEX3)=NUMTAB(J) THEN                          0539
         L     @04,INDEX3                                          0539
         LA    @03,PARMFLD-1(@04)                                  0539
         LA    @01,NUMTAB-1(@10)                                   0539
         CLC   0(1,@03),0(@01)                                     0539
         BNE   @RF00539                                            0539
*         DO;                                                      0540
*           VALID=ON;               /* VALID CHAR IS FOUND           */
         OI    VALID,B'10000000'                                   0541
*           PARMFLD(INDEX3)=HEXTAB(J);/* CONVERT TO HEX DIGIT        */
         LA    @03,PARMFLD-1(@04)                                  0542
         LA    @04,HEXTAB-1(@10)                                   0542
         MVC   0(1,@03),0(@04)                                     0542
*         END;                                                     0543
*     END;                                                         0544
@RF00539 SLR   @10,@10                                             0544
         BCTR  @10,0                                               0544
         AL    @10,J                                               0544
         ST    @10,J                                               0544
         LTR   @10,@10                                             0544
         BP    @DL00538                                            0544
@DC00538 DS    0H                                                  0545
*     IF VALID=OFF THEN                                            0545
         TM    VALID,B'10000000'                                   0545
         BNZ   @RF00545                                            0545
*       DO PLACE=INDEX1-INDEX3;     /* LOCATION OF INVALID DIGIT     */
         LR    @10,INDEX1                                          0546
         SL    @10,INDEX3                                          0546
         ST    @10,PLACE                                           0546
*         CALL OUTMSG(SYNTAX);      /* WRITE ERROR MESSAGE           */
         LA    @01,@AL00547                                        0547
         BAL   @14,OUTMSG                                          0547
*         SWITCH=ON;                /* AT LEAST ONE INVALID CHAR   0548
*                                      FOUND                         */
         OI    SWITCH,B'00100000'                                  0548
*       END;                                                       0549
*   END;                                                           0550
@RF00545 LA    @10,1                                               0550
         AL    @10,INDEX3                                          0550
         ST    @10,INDEX3                                          0550
@DE00536 C     @10,I                                               0550
         BNH   @DL00536                                            0550
*   RESPECIFY                                                      0551
*    (R15) RESTRICTED;                                             0551
*   IF SWITCH=ON THEN               /* AT LEAST ONE INVALID CHAR     */
         TM    SWITCH,B'00100000'                                  0552
         BNO   @RF00552                                            0552
*     R15=TWELVE;                   /* SET RETURN CODE               */
         LA    R15,12                                              0553
*   ELSE                                                           0554
*     R15=ZERO;                     /* NO ERRORS FOUND               */
         B     @RC00552                                            0554
@RF00552 SLR   R15,R15                                             0554
*   RESPECIFY                                                      0555
*    (R15) UNRESTRICTED;                                           0555
*   END;                                                           0556
@EL00015 DS    0H                                                  0556
@EF00015 DS    0H                                                  0556
@ER00015 L     @14,@SA00015                                        0556
         LM    @00,@04,@SA00015+4                                  0556
         LM    @06,@12,@SA00015+24                                 0556
         BR    @14                                                 0556
*                                                                  0557
*/********************************************************************/
*/*                                                                  */
*/*  VALID THE FIELD STARTING AT PARMFLD(INDEX1) FOR A LENGTH AS     */
*/*  GIVEN AS THE INPUT PARAMETER.  IF A CHARACTER IS NOT FOUND TO   */
*/*  BE A VALID NUMERIC, THE FIELD IS INDICATED AS HAVING A SYNTAX   */
*/*  ERROR.  THE CONTENTS OF THE ORIGINAL FIELD ARE CHANGED TO THE   */
*/*  HEXADECIMAL EQUIVALENT FOR THE CHARACTER.  THOSE VALUES CAN THEN*/
*/*  BE EASILY CONVERTED FOR THE NECESSARY FIELD.                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0557
*VALIDCUA:                                                         0557
*   PROC(LENGTHC) OPTIONS(DONTSAVE(R5,R15));                       0557
VALIDCUA ST    @14,@SA00016                                        0557
         STM   @00,@04,@SA00016+4                                  0557
         STM   @06,@12,@SA00016+24                                 0557
         MVC   @PC00016(4),0(@01)                                  0557
*   DCL                                                            0558
*     LENGTHC FIXED(31);            /* LENGTH OF THE INPUT FLD       */
*   SWITCH=OFF;                     /* INDICATOR OF INVALID CHAR     */
         NI    SWITCH,B'11011111'                                  0559
*   I=INDEX1+LENGTHC-1;             /* LAST CHARACTER POSITION       */
         L     @10,@PC00016                                        0560
         LR    @04,INDEX1                                          0560
         AL    @04,LENGTHC(,@10)                                   0560
         BCTR  @04,0                                               0560
         ST    @04,I                                               0560
*   DO INDEX3=INDEX1 TO I BY 1;                                    0561
         LR    @10,INDEX1                                          0561
         ST    @10,INDEX3                                          0561
         B     @DE00561                                            0561
@DL00561 DS    0H                                                  0562
*     VALID=OFF;                                                   0562
*                                                                  0562
         NI    VALID,B'01111111'                                   0562
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK TO SEE IF THE FIELD IS A VALID DECIMAL NUMBER. IF YES,*/
*     /* TERMINATE THE SEARCH AND REPLACE THE CHARACTER WITH         */
*     /* HEXADECIMAL EQUIVALENT. IF NO, PRINT AN ERROR MESSAGE FOR   */
*     /* THIS OPERAND.                                               */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0563
*     DO J=16 TO 1 BY-1 WHILE(VALID=OFF);                          0563
         LA    @10,16                                              0563
         ST    @10,J                                               0563
@DL00563 TM    VALID,B'10000000'                                   0563
         BNZ   @DC00563                                            0563
*       IF PARMFLD(INDEX3)=NUMTAB(J) THEN                          0564
         L     @04,INDEX3                                          0564
         LA    @03,PARMFLD-1(@04)                                  0564
         LA    @01,NUMTAB-1(@10)                                   0564
         CLC   0(1,@03),0(@01)                                     0564
         BNE   @RF00564                                            0564
*         DO;                                                      0565
*           VALID=ON;               /* VALID CHAR FOUND              */
         OI    VALID,B'10000000'                                   0566
*           PARMFLD(INDEX3)=HEXTAB(J);/* CONVERT TO HEX DIGIT        */
         LA    @03,PARMFLD-1(@04)                                  0567
         LA    @04,HEXTAB-1(@10)                                   0567
         MVC   0(1,@03),0(@04)                                     0567
*         END;                                                     0568
*     END;                                                         0569
@RF00564 SLR   @10,@10                                             0569
         BCTR  @10,0                                               0569
         AL    @10,J                                               0569
         ST    @10,J                                               0569
         LTR   @10,@10                                             0569
         BP    @DL00563                                            0569
@DC00563 DS    0H                                                  0570
*     IF VALID=OFF THEN                                            0570
         TM    VALID,B'10000000'                                   0570
         BNZ   @RF00570                                            0570
*       DO PLACE=INDEX1-INDEX3;     /* POSITION OF INVALID DIGIT     */
         LR    @10,INDEX1                                          0571
         SL    @10,INDEX3                                          0571
         ST    @10,PLACE                                           0571
*         CALL OUTMSG(SYNTAX);      /* WRITE ERROR MESSAGE           */
         LA    @01,@AL00572                                        0572
         BAL   @14,OUTMSG                                          0572
*         SWITCH=ON;                /* INVALID DIGIT FOUND           */
         OI    SWITCH,B'00100000'                                  0573
*       END;                                                       0574
*   END;                                                           0575
@RF00570 LA    @10,1                                               0575
         AL    @10,INDEX3                                          0575
         ST    @10,INDEX3                                          0575
@DE00561 C     @10,I                                               0575
         BNH   @DL00561                                            0575
*   RESPECIFY                                                      0576
*    (R15) RESTRICTED;                                             0576
*   IF SWITCH=ON THEN               /* AT LEAST ONE INVALID CHAR     */
         TM    SWITCH,B'00100000'                                  0577
         BNO   @RF00577                                            0577
*     R15=TWELVE;                   /* SET RETURN CODE               */
         LA    R15,12                                              0578
*   ELSE                                                           0579
*     R15=ZERO;                     /* GOOD DIGITS                   */
         B     @RC00577                                            0579
@RF00577 SLR   R15,R15                                             0579
*   RESPECIFY                                                      0580
*    (R15) UNRESTRICTED;                                           0580
*   END;                                                           0581
@EL00016 DS    0H                                                  0581
@EF00016 DS    0H                                                  0581
@ER00016 L     @14,@SA00016                                        0581
         LM    @00,@04,@SA00016+4                                  0581
         LM    @06,@12,@SA00016+24                                 0581
         BR    @14                                                 0581
*                                                                  0582
*/********************************************************************/
*/*                                                                  */
*/*  PACK A FIELD OF A GIVEN LENGTH INTO THE VARIABLE HOLD.  THE     */
*/*  INPUT IS ASSUMED TO BE HEX CHARACTERS, WITH A LEADING ZERO FOR  */
*/*  EACH TWO DIGITS.                                                */
*/********************************************************************/
*                                                                  0582
*HEXPACK:                                                          0582
*   PROC(HEXLEN) OPTIONS(DONTSAVE(R5,R15));                        0582
HEXPACK  ST    @14,12(,@13)                                        0582
         STM   @00,@04,20(@13)                                     0582
         STM   @06,@12,44(@13)                                     0582
         MVC   @PC00017(4),0(@01)                                  0582
*   DCL                                                            0583
*     HEXLEN FIXED(31);                                            0583
*   INDEX3=HEXLEN/2;                /* NO. BYTES OF OUTPUT           */
         L     @10,@PC00017                                        0584
         L     @00,HEXLEN(,@10)                                    0584
         SRDA  @00,32                                              0584
         D     @00,@CF00074                                        0584
         ST    @01,INDEX3                                          0584
*   DO I=1 TO INDEX3 BY 1;                                         0585
*                                                                  0585
         LA    @10,1                                               0585
         ST    @10,I                                               0585
         B     @DE00585                                            0585
@DL00585 DS    0H                                                  0586
*     /***************************************************************/
*     /*                                                             */
*     /* THE DATA IN PARMFLD IS ACCESSED TWO CHARACTERS AT A TIME.   */
*     /* THE FIRST CHARACTER IS SHIFTED LEFT FOUR BITS AND THEN ORED */
*     /* WITH THE SECOND CHARACTER. THE SECOND CHARACTER IS ASSUMED  */
*     /* TO HAVE THE FIRST FOUR BITS AS ZEROES.                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0586
*     HOLD(I)=PARMFLD(INDEX1);                                     0586
         LA    @04,HOLD-1(@10)                                     0586
         LA    @03,PARMFLD-1(INDEX1)                               0586
         MVC   0(1,@04),0(@03)                                     0586
*     SLL(HOLD(I),FOUR);                                           0587
         SLR   @04,@04                                             0587
         IC    @04,HOLD-1(@10)                                     0587
         SLL   @04,4                                               0587
         STC   @04,HOLD-1(@10)                                     0587
*     HOLD(I)=HOLD(I)×PARMFLD(INDEX1+1);                           0588
         LA    @04,HOLD-1(@10)                                     0588
         LA    @03,PARMFLD(INDEX1)                                 0588
         OC    0(1,@04),0(@03)                                     0588
*     INDEX1=INDEX1+2;              /* POINT PASS INPUT FIELD        */
         AL    INDEX1,@CF00074                                     0589
*   END;                                                           0590
         AL    @10,@CF00053                                        0590
         ST    @10,I                                               0590
@DE00585 C     @10,INDEX3                                          0590
         BNH   @DL00585                                            0590
*   END;                                                           0591
@EL00017 DS    0H                                                  0591
@EF00017 DS    0H                                                  0591
@ER00017 L     @14,12(,@13)                                        0591
         LM    @00,@04,20(@13)                                     0591
         LM    @06,@12,44(@13)                                     0591
         BR    @14                                                 0591
*                                                                  0592
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL SEARCH THE SHARE/CONTROLLER TABLE TO ASSIGN      */
*/*  A LETTER TO EACH DISTINCT CPU IN THE TABLE. BASE ENTRIES ARE    */
*/*  ASSIGNED LETTERS FIRST AND THEN NON-BASE ENTRIES.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0592
*SHARLTR:                                                          0592
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0592
SHARLTR  ST    @14,@SA00018                                        0592
         STM   @00,@04,@SA00018+4                                  0592
         STM   @06,@12,@SA00018+24                                 0592
*   I=ZERO;                                                        0593
         SLR   @10,@10                                             0593
         ST    @10,I                                               0593
*   DO J=1 TO INDEX2 BY 1 WHILE(I<=MAXCPUS);/* LETTERS FOR BASE      */
         LA    @10,1                                               0594
         ST    @10,J                                               0594
         B     @DE00594                                            0594
@DL00594 L     @04,I                                               0594
         CH    @04,@CH00089                                        0594
         BH    @DC00594                                            0594
*     IF SHARLET(J)=STAR THEN       /* DO BASE ONLY                  */
         SLA   @10,4                                               0595
         L     @03,SHAREPTR(,R2)                                   0595
         ALR   @03,@10                                             0595
         CLI   SHARLET-16(@03),C'*'                                0595
         BNE   @RF00595                                            0595
*       DO I=I+1;                                                  0596
         AL    @04,@CF00053                                        0596
         ST    @04,I                                               0596
*         SHARLET(J)=LETTAB(I);     /* ASSIGN LETTER                 */
         L     @10,J                                               0597
         SLA   @10,4                                               0597
         L     @03,SHAREPTR(,R2)                                   0597
         ALR   @03,@10                                             0597
         LA    @10,LETTAB-1(@04)                                   0597
         MVC   SHARLET-16(1,@03),0(@10)                            0597
*         DO INDEX1=1 TO INDEX2 BY 1;                              0598
*                                                                  0598
         LA    INDEX1,1                                            0598
         B     @DE00598                                            0598
@DL00598 DS    0H                                                  0599
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF BASE CPU SPECIFIED ELSEWHERE                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0599
*           IF SHARSERA(J)=SHARSERA(INDEX1) THEN                   0599
         L     @10,J                                               0599
         SLA   @10,4                                               0599
         L     @04,SHAREPTR(,R2)                                   0599
         LR    @03,INDEX1                                          0599
         SLA   @03,4                                               0599
         ALR   @10,@04                                             0599
         AL    @10,@CF00729                                        0599
         ST    @03,@TF00001                                        0599
         ALR   @03,@04                                             0599
         AL    @03,@CF00729                                        0599
         CLC   SHARSERA-10(3,@10),SHARSERA-10(@03)                 0599
         BNE   @RF00599                                            0599
*             SHARLET(INDEX1)=LETTAB(I);                           0600
         AL    @04,@TF00001                                        0600
         L     @10,I                                               0600
         LA    @03,LETTAB-1(@10)                                   0600
         MVC   SHARLET-16(1,@04),0(@03)                            0600
*         END;                                                     0601
@RF00599 AL    INDEX1,@CF00053                                     0601
@DE00598 C     INDEX1,INDEX2                                       0601
         BNH   @DL00598                                            0601
*       END;                                                       0602
*   END;                                                           0603
@RF00595 LA    @10,1                                               0603
         AL    @10,J                                               0603
         ST    @10,J                                               0603
@DE00594 C     @10,INDEX2                                          0603
         BNH   @DL00594                                            0603
@DC00594 DS    0H                                                  0604
*   DO J=1 TO INDEX2 BY 1 WHILE(I<=MAXCPUS);/* LETTERS FOR ALT       */
         LA    @10,1                                               0604
         ST    @10,J                                               0604
         B     @DE00604                                            0604
@DL00604 L     @04,I                                               0604
         CH    @04,@CH00089                                        0604
         BH    @DC00604                                            0604
*     IF SHARLET(J)=BLANK THEN      /* DO UNASSIGNED                 */
         SLA   @10,4                                               0605
         L     @03,SHAREPTR(,R2)                                   0605
         ALR   @03,@10                                             0605
         CLI   SHARLET-16(@03),C' '                                0605
         BNE   @RF00605                                            0605
*       DO I=I+1;                                                  0606
         AL    @04,@CF00053                                        0606
         ST    @04,I                                               0606
*         SHARLET(J)=LETTAB(I);     /* NEXT LETTER                   */
         L     @10,J                                               0607
         SLA   @10,4                                               0607
         L     @03,SHAREPTR(,R2)                                   0607
         ALR   @03,@10                                             0607
         LA    @10,LETTAB-1(@04)                                   0607
         MVC   SHARLET-16(1,@03),0(@10)                            0607
*         DO INDEX1=1 TO INDEX2 BY 1;                              0608
*                                                                  0608
         LA    INDEX1,1                                            0608
         B     @DE00608                                            0608
@DL00608 DS    0H                                                  0609
*           /*********************************************************/
*           /*                                                       */
*           /* CHECK IF ALT CPU SPECIFIED ELSEWHERE                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0609
*           IF SHARSERA(J)=SHARSERA(INDEX1) THEN                   0609
         L     @10,J                                               0609
         SLA   @10,4                                               0609
         L     @04,SHAREPTR(,R2)                                   0609
         LR    @03,INDEX1                                          0609
         SLA   @03,4                                               0609
         ALR   @10,@04                                             0609
         AL    @10,@CF00729                                        0609
         ST    @03,@TF00001                                        0609
         ALR   @03,@04                                             0609
         AL    @03,@CF00729                                        0609
         CLC   SHARSERA-10(3,@10),SHARSERA-10(@03)                 0609
         BNE   @RF00609                                            0609
*             SHARLET(INDEX1)=LETTAB(I);                           0610
         AL    @04,@TF00001                                        0610
         L     @10,I                                               0610
         LA    @03,LETTAB-1(@10)                                   0610
         MVC   SHARLET-16(1,@04),0(@03)                            0610
*         END;                                                     0611
@RF00609 AL    INDEX1,@CF00053                                     0611
@DE00608 C     INDEX1,INDEX2                                       0611
         BNH   @DL00608                                            0611
*       END;                                                       0612
*   END;                                                           0613
@RF00605 LA    @10,1                                               0613
         AL    @10,J                                               0613
         ST    @10,J                                               0613
@DE00604 C     @10,INDEX2                                          0613
         BNH   @DL00604                                            0613
@DC00604 DS    0H                                                  0614
*   IF I>MAXCPUS THEN               /* MORE THAN 16 CPUS             */
         L     @10,I                                               0614
         CH    @10,@CH00089                                        0614
         BNH   @RF00614                                            0614
*     DO;                                                          0615
*       CALL IFCMSG(68,ADDR(MSGNO));/* MESSAGE TEXT                  */
         LA    @10,MSGNO                                           0616
         ST    @10,@AFTEMPS+8                                      0616
         L     @15,ADIFCMSG(,R2)                                   0616
         LA    @01,@AL00616                                        0616
         BALR  @14,@15                                             0616
*       PRINTADR=ADDR(PARMPT);                                     0617
         LA    @10,PARMPT                                          0617
         ST    @10,PRINTADR(,R2)                                   0617
*       CALL IOHND(RITEPRTR);       /* WRITE ERROR MESSAGE           */
         L     @15,ADIOHND(,R2)                                    0618
         LA    @01,@AL00618                                        0618
         BALR  @14,@15                                             0618
*       RETCODE=TWELVE;             /* SET RETURN CODE               */
         L     @10,@PC00001                                        0619
         MVC   RETCODE(4,@10),@CF00066                             0619
*       ZEROALL=OFF;                /* DON'T 0 ALL RECORDS           */
         NI    ZEROALL(R2),B'10111111'                             0620
*     END;                                                         0621
*   ELSE                                                           0622
*     ;                             /* LESS THAN 16 CPUS             */
@RF00614 DS    0H                                                  0623
*   END SHARLTR;                                                   0623
@EL00018 DS    0H                                                  0623
@EF00018 DS    0H                                                  0623
@ER00018 L     @14,@SA00018                                        0623
         LM    @00,@04,@SA00018+4                                  0623
         LM    @06,@12,@SA00018+24                                 0623
         BR    @14                                                 0623
*                                                                  0624
*/********************************************************************/
*/*                                                                  */
*/*  THIS PROC WILL PRINT OUT THE SHARE/CONTROLLER TABLE IF DEBUG3   */
*/*  IS ON.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0624
*DEBUGOUT:                                                         0624
*   PROC OPTIONS(DONTSAVE(R5,R15));                                0624
DEBUGOUT ST    @14,@SA00019                                        0624
         STM   @00,@04,@SA00019+4                                  0624
         STM   @06,@12,@SA00019+24                                 0624
*   IF SHAREPTR^=ZERO THEN          /* SHARE TABLE EMPTY             */
         L     @10,SHAREPTR(,R2)                                   0625
         LTR   @10,@10                                             0625
         BZ    @RF00625                                            0625
*     DO;                                                          0626
*       MSGNO(1:LENGTH(SHARETAB))=SHARETAB;/* MOVE HEADER            */
         MVC   MSGNO(33),SHARETAB                                  0627
*       PRINTADR=ADDR(PARMPT);                                     0628
         LA    @10,PARMPT                                          0628
         ST    @10,PRINTADR(,R2)                                   0628
*       CALL IOHND(RITEPRTR);       /* WRITE HEADER                  */
         L     @15,ADIOHND(,R2)                                    0629
         LA    @01,@AL00629                                        0629
         BALR  @14,@15                                             0629
*       INDEX1=INDEX2*ENTRYLEN+LENGTH(SHARENUM);/* MAX BYTES         */
         L     INDEX1,INDEX2                                       0630
         SLA   INDEX1,4                                            0630
         AL    INDEX1,@CF00074                                     0630
*       DO I=66 TO INDEX1 BY 66;                                   0631
         LA    @10,66                                              0631
         ST    @10,I                                               0631
         B     @DE00631                                            0631
@DL00631 DS    0H                                                  0632
*         PARMFLD(1:66)=SHARE(I-65:I);/* GET NEXT 66 HEX DIGITS      */
         L     @04,SHAREPTR(,R2)                                   0632
         ALR   @04,@10                                             0632
         AL    @04,@CF00739                                        0632
         MVC   PARMFLD(66),SHARE(@04)                              0632
*         CALL UNPACK(66);          /* CONVERT TO CHAR               */
         LA    @01,@AL00633                                        0633
         BAL   @14,UNPACK                                          0633
*       END;                                                       0634
         LA    @10,66                                              0634
         AL    @10,I                                               0634
         ST    @10,I                                               0634
@DE00631 CR    @10,INDEX1                                          0634
         BNH   @DL00631                                            0634
*       I=66-I+INDEX1;              /* GET INCOMPLETE LAST LINE      */
         LA    @10,66                                              0635
         SL    @10,I                                               0635
         ALR   @10,INDEX1                                          0635
         ST    @10,I                                               0635
*       IF I>ZERO THEN                                             0636
         LTR   @10,@10                                             0636
         BNP   @RF00636                                            0636
*         DO;                                                      0637
*           PARMFLD(1:I)=SHARE(INDEX1-I+1:INDEX1);                 0638
         LR    @04,@10                                             0638
         BCTR  @04,0                                               0638
         LCR   @10,@10                                             0638
         ALR   @10,INDEX1                                          0638
         L     @03,SHAREPTR(,R2)                                   0638
         ALR   @03,@10                                             0638
         EX    @04,@SM00740                                        0638
*           CALL UNPACK(I);         /* CONVERT TO CHAR               */
         LA    @01,@AL00639                                        0639
         BAL   @14,UNPACK                                          0639
*         END;                                                     0640
*     END;                                                         0641
*   END DEBUGOUT;                                                  0642
@EL00019 DS    0H                                                  0642
@EF00019 DS    0H                                                  0642
@ER00019 L     @14,@SA00019                                        0642
         LM    @00,@04,@SA00019+4                                  0642
         LM    @06,@12,@SA00019+24                                 0642
         BR    @14                                                 0642
*   END IFCSHARE                                                   0643
*                                                                  0643
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (COMTABLE)                                       */
*                                                                  0643
*       ;                                                          0643
@DATA    DS    0H
@CH00079 DC    H'5'
@CH00086 DC    H'9'
@CH00277 DC    H'10'
@CH00596 DC    H'72'
@CH00540 DC    H'80'
@SM00740 MVC   PARMFLD(0),SHARE(@03)
         DS    0F
@AL00109 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00135 DC    A(@CH00086)             LIST WITH   1 ARGUMENT(S)
@AL00120 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00505 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00514 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00530 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00618 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00629 DC    A(@CF00074+2)           LIST WITH   1 ARGUMENT(S)
@AL00130 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00174 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00178 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00200 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00207 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00210 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00269 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00271 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00291 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00340 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00373 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00547 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00572 DC    A(@CF00053)             LIST WITH   1 ARGUMENT(S)
@AL00283 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00287 DC    A(@CF00081)             LIST WITH   1 ARGUMENT(S)
@AL00324 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00387 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00437 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00448 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00481 DC    A(@CF00074)             LIST WITH   1 ARGUMENT(S)
@AL00333 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00354 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00366 DC    A(@CF00062)             LIST WITH   1 ARGUMENT(S)
@AL00346 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00359 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00401 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00411 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00421 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00468 DC    A(@CF00076)             LIST WITH   1 ARGUMENT(S)
@AL00499 DC    A(@CF00685)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00501 DC    A(@CF00686)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00502 DC    A(@CF00687)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00512 DC    A(@CF00691)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+4)
@AL00616 DC    A(@CF00719)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS+8)
@AL00633 DC    A(@CF00723)             LIST WITH   1 ARGUMENT(S)
@AL00639 DC    A(I)                    LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00002 DS    13F
@SA00003 DS    13F
@SA00012 DS    13F
@PC00012 DS    1F
@SA00013 DS    13F
@SA00018 DS    13F
@SA00019 DS    13F
@SA00004 DS    13F
@SA00007 DS    13F
@SA00010 DS    13F
@SA00015 DS    13F
@PC00015 DS    1F
@PC00017 DS    1F
@SA00005 DS    13F
@SA00006 DS    13F
@SA00008 DS    13F
@SA00009 DS    13F
@SA00016 DS    13F
@PC00016 DS    1F
@SA00014 DS    13F
@PC00014 DS    1F
@TF00001 DS    F
@AFTEMPS DS    3F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00053 DC    F'1'
@CH00053 EQU   @CF00053+2
@CF00074 DC    F'2'
@CH00074 EQU   @CF00074+2
@CF00076 DC    F'3'
@CF00062 DC    F'4'
@CF00081 DC    F'6'
@CF00066 DC    F'12'
@CF00089 DC    F'16'
@CH00089 EQU   @CF00089+2
@CF00687 DC    F'65'
@CF00723 DC    F'66'
@CF00719 DC    F'68'
@CF00691 DC    F'89'
@CF00686 DC    F'90'
@CF00685 DC    F'91'
@CF00739 DC    F'-66'
@CF00727 DC    F'-14'
@CF00728 DC    F'-13'
@CF00733 DC    F'-10'
@CF00734 DC    F'-8'
@CF00729 DC    F'-6'
@CF00735 DC    F'-3'
@CF00638 DC    XL4'FFFFFF80'
         DS    0D
LENGPARM DC    F'0'
I        DS    F
INDEX3   DS    F
J        DS    F
PLACE    DC    F'0'
CUAPLACE DC    F'0'
INDEX2   DS    F
CPURC    DC    F'0'
CUARC1   DC    F'0'
CUARC2   DC    F'0'
RANGERC1 DC    F'0'
RANGERC2 DC    F'0'
@TS00001 DS    CL19
@CB00229 DC    X'00000F'
@CB00209 EQU   @CB00229
@CB00618 DC    X'000F'
@CB00620 DC    X'001F'
PARMPT   DS    CL134
         ORG   PARMPT
@NM00012 DC    CL2'11'
MSGNO    DC    CL32' '
PARMPRT  DC    CL100' '
         ORG   PARMPT+134
SHARETAB DC    CL33'DEBUG3 - SHARE/CONTROLLER ENTRIES'
PARMFLD  DC    CL256' '
HOLDAREA DS    CL5
         DS    CL2
KEYWORD  DS    CL10
SWES     DC    X'00'
         ORG   SWES
VALID    DS    BL1
TABFULL  EQU   SWES+0
SWITCH   EQU   SWES+0
@NM00014 EQU   SWES+0
NOCOMMA  EQU   SWES+0
@NM00015 EQU   SWES+0
@NM00016 EQU   SWES+0
@NM00017 EQU   SWES+0
         ORG   SWES+1
CUAHOLD  DS    CL3
CUAHOLD2 DS    CL3
CONTRWD  DC    CL10'CONTROLLER'
SHAREW   DC    CL5'SHARE'
BASENTRY DS    CL7
         ORG   BASENTRY
BASECPU  DS    CL3
BASELCUA DS    BL2
BASEHCUA DS    BL2
         ORG   BASENTRY+7
BASERNG  DS    BL2
ALTRNG   DS    BL2
CUADIG   DS    BL1
SUPERZAP DC    3CL10'SUPERZAP'
NUMTAB   DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
         DC    CL1'X'
HEXTAB   DC    X'00'
         DC    X'01'
         DC    X'02'
         DC    X'03'
         DC    X'04'
         DC    X'05'
         DC    X'06'
         DC    X'07'
         DC    X'08'
         DC    X'09'
         DC    X'0A'
         DC    X'0B'
         DC    X'0C'
         DC    X'0D'
         DC    X'0E'
         DC    X'0F'
         DC    X'00'
LETTAB   DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
         DC    CL1'G'
         DC    CL1'H'
         DC    CL1'I'
         DC    CL1'J'
         DC    CL1'K'
         DC    CL1'L'
         DC    CL1'M'
         DC    CL1'N'
         DC    CL1'O'
         DC    CL1'P'
         DC    CL1'*'
IFCSHARE CSECT
*                                                         /*@G51DGVS*/
        DC    S(SUPERZAP)
IFCSHARE CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R5       EQU   @05
R15      EQU   @15
R12      EQU   @12
R11      EQU   @11
R2       EQU   @02
INDEX1   EQU   @05
R0       EQU   @00
R1       EQU   @01
R7       EQU   @07
R10      EQU   @10
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R8       EQU   @08
R9       EQU   @09
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
ZEROALL  EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG3   EQU   DEBUG
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
TABSIZE  EQU   PARM+80
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHARENUM EQU   SHARE
SHAREIO  EQU   SHARE+2
SHAREFLG EQU   SHAREIO
SHRBASE  EQU   SHAREIO+1
SHARSERB EQU   SHRBASE
SHRCUABL EQU   SHRBASE+3
SHRCUABH EQU   SHRBASE+5
SHRCUCPU EQU   SHAREIO+8
SHARSERA EQU   SHRCUCPU
SHRCUAAL EQU   SHRCUCPU+3
SHRCUAAH EQU   SHRCUCPU+5
SHARLET  EQU   SHAREIO+15
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
CARD     EQU   0
RETCODE  EQU   0
ERROR    EQU   0
OPLEN    EQU   0
LENGTHV  EQU   0
LENGTHC  EQU   0
HEXLEN   EQU   0
HOLD     EQU   HOLDAREA
KEYBITS  EQU   KEYWORD
SECDIG   EQU   KEYBITS+3
KEYBIT12 EQU   SECDIG+1
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
KEYBIT16 EQU   SECDIG+1
KEYBIT15 EQU   SECDIG+1
KEYBIT14 EQU   SECDIG+1
KEYBIT13 EQU   SECDIG+1
KEYBIT11 EQU   SECDIG+1
KEYBIT10 EQU   SECDIG+1
KEYBIT9  EQU   SECDIG+1
KEYBIT8  EQU   SECDIG
KEYBIT7  EQU   SECDIG
KEYBIT6  EQU   SECDIG
KEYBIT5  EQU   SECDIG
KEYBIT4  EQU   SECDIG
KEYBIT3  EQU   SECDIG
KEYBIT2  EQU   SECDIG
KEYBIT1  EQU   SECDIG
@NM00013 EQU   KEYBITS
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
LINECT   EQU   PARM+120
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
RECCCHHR EQU   CCHHRLNG
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SORTNUM  EQU   PARM+84
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
WRTHRSH  EQU   PARM+69
RDTHRSH  EQU   PARM+66
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG4   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00125 EQU   @RC00121
@RC00187 EQU   @RC00186
@RC00175 EQU   @EL00002
@RC00173 EQU   @EL00002
@RC00233 EQU   @RC00231
@RC00254 EQU   @RC00249
@RC00208 EQU   @EL00003
@RC00206 EQU   @EL00003
@RC00289 EQU   @EL00004
@RC00302 EQU   @EL00004
@RC00407 EQU   @EL00008
@RC00405 EQU   @EL00008
@RC00398 EQU   @EL00008
@RC00418 EQU   @EL00008
@RC00465 EQU   @EL00010
@RC00552 EQU   @EL00015
@RC00577 EQU   @EL00016
@RF00625 EQU   @EL00019
@RF00636 EQU   @EL00019
@PB00019 EQU   @EL00001
@RC00128 EQU   @RC00125
@RC00126 EQU   @RC00125
@RC00255 EQU   @RC00254
@RC00315 EQU   @RC00302
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCSHARE,(C'PLS0302',0702,79011)

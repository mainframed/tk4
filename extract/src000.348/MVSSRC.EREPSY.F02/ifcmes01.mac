         TITLE 'IFCMES01 - CONTROL FOR MEDIA ERROR STATISTICS PROCESSIN*
               G'
IFCMES01 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCMES01  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         B     @PB00002                                            0074
SORT     STM   @14,@12,@SA00002                                    0074
*SRTCONT =((RECCOUNT-1)* 11) + CURRPTR;                    /*@Z427VLS*/
         L     @10,RECCOUNT                                        0077
         BCTR  @10,0                                               0077
         MH    @10,@CH00034                                        0077
         ALR   @10,CURRPTR                                         0077
         ST    @10,SRTCONT                                         0077
*/* THIS SORT IS DONE IN BAL IN ORDER TO GET MIN PROCESSING TIME    */
*/* SOME 35 INSTRUCTIONS WERE CUT FROM THE BEST THAT PLS WOULD DO   */
*/* THIS CUT THE RUN TIME DOWN BY APP. 50 PERCENT            @Z427VLS*/
*         GENERATE REFS(CONTRTAB);                         /*@ZA35015*/
          LA     R15,11              LOAD THE INCREMENT VALUE
          LR     R7,CURRPTR          LOAD THE START OF THE TABLE
          L      R4,SRTCONT          LOAD THE MAX LIMIT
          SR     R4,R15              POINT TO LAST ENTRY
          LR     R1,R7               SET UP THE STOP LIMIT ON BACK UP
          B      DOIT                GO AROUND THIS CODE FIRST TIME
LOOPBCK1  ALR    R7,R15              MOVE THE POINTER TO NEXT ENTRY
          CR     R7,R4               ARE WE POINTING TO LAST ENTRY
          BNL    DONE                FINISHED WITH THE SORT SO EXIT
DOIT      CLC    CONTRTAB(11,R7),CONTRTAB+11(R7)
         BNH   LOOPBCK1            DONT NEED TO SORT ITEM
          XC     CONTRTAB(11,R7),CONTRTAB+11(R7)
          XC     CONTRTAB+11(11,R7),CONTRTAB(R7)
          XC     CONTRTAB(11,R7),CONTRTAB+11(R7)
          LR     R6,R7               SET NEW POINTER(BACKWARD)
LOOPBCK2  SR     R6,R15              POINT TO LAST ENTRY
          CR     R6,R1               DONT BACK OUT OF THE TABLE
          BL     LOOPBCK1            START WITH NEXT ENTRY
          CLC    CONTRTAB(11,R6),CONTRTAB+11(R6)
          BNH    LOOPBCK1            NO FUTHER SHUFFEL THIS SAMPLE
          XC     CONTRTAB+11(11,R6),CONTRTAB(R6)
          XC     CONTRTAB(11,R6),CONTRTAB+11(R6)
          XC     CONTRTAB+11(11,R6),CONTRTAB(R6)
          B      LOOPBCK2            DOES IT NEED TO BE MOVED AGAIN
DONE      EQU    *
*      RESPECIFY (R6) UNRESTRICTED;                        /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
@EL00002 DS    0H                                                  0080
@EF00002 DS    0H                                                  0080
@ER00002 LM    @14,@12,@SA00002                                    0080
         BR    @14                                                 0080
*/*                                                          @Z427VLS*/
*/* OUTPUT ALL OF THE SUMMARY COUNTERS THAT HAVE BEEN BUILT UP TO THIS*
*/* POINT.  CNTAREA CONTAINS THE ADDRESS OF THE FIRST COUNTER AREA.   *
*/*                                                          @Z427VLS*/
*OUTSUM: PROC;                                             /*@Z427VLS*/
OUTSUM   STM   @14,@12,@SA00003                                    0081
*        CURRCNTS = CNTAREA;              /* GET ADDRESS OF FIRST AREA*
         L     @10,CNTAREA                                         0082
         ST    @10,CURRCNTS                                        0082
*        DO WHILE (CURRCNTS ^= ZERO);                      /*@Z427VLS*/
         B     @DE00083                                            0083
@DL00083 DS    0H                                                  0084
*          RESPECIFY (R7,R9) RESTRICTED;                   /*@Z427VLS*/
*          R9 = SUMEDIT;                  /* SUMMARY OUTPUT EDITS     *
         L     @10,SUMTAB                                          0085
         L     R9,SUMEDIT(,@10)                                    0085
*          R7 = CURRCNTS;                 /* ADDRESS OF COUNTERS      *
         L     R7,CURRCNTS                                         0086
*          CALL IFCEEDIT;                 /* GO TO EDIT TABLE         *
         L     @15,@CV00543                                        0087
         BALR  @14,@15                                             0087
*          R9 = 22 + (2 * CNTSIZE);       /* SIZE OF COUNTER AREA     *
         L     @10,SUMTAB                                          0088
         LH    R9,CNTSIZE(,@10)                                    0088
         ALR   R9,R9                                               0088
         AL    R9,@CF00614                                         0088
*          CURRCNTS = NEXTTAB;            /* ADDRESS OF NEXT AREA.    *
         L     @10,CURRCNTS                                        0089
         L     @10,NEXTTAB(,@10)                                   0089
         ST    @10,CURRCNTS                                        0089
*          GEN(FREEMAIN R,LV=(R9),A=(R7));                 /*@Z427VLS*/
         FREEMAIN R,LV=(R9),A=(R7)
*          RESPECIFY (R7,R9) UNRESTRICTED;                 /*@Z427VLS*/
*        END;                                              /*@Z427VLS*/
@DE00083 SLR   @10,@10                                             0092
         C     @10,CURRCNTS                                        0092
         BNE   @DL00083                                            0092
*        CNTAREA = ZERO;                  /* INITIALIZE FIRST AREA ADD*
         ST    @10,CNTAREA                                         0093
*        LASTDATE = LASTDATE && LASTDATE;  /* CLEAR LAST DATE         *
         XC    LASTDATE(4),LASTDATE                                0094
*END;                                                      /*@Z427VLS*/
@EL00003 DS    0H                                                  0095
@EF00003 DS    0H                                                  0095
@ER00003 LM    @14,@12,@SA00003                                    0095
         BR    @14                                                 0095
*/*                                                          @Z427VLS*/
*/* THE NEXT CODE WILL INITIALIZE THE REGISTERS FOR EXITING TO        *
*/* AN EDIT MODULE.  THE EXPECTED PARAMETERS TO IFCEEDIT ARE:         *
*/*      REG2 - POINTING TO THE RECORD TO BE EDITTED.        @Z427VLS*/
*/*      REG9 - POINTING TO THE BASE OF THE EDIT TABLE.      @Z427VLS*/
*/*      REG15 - POINTING TO THE BASE OF IFCEEDIT.           @Z427VLS*/
*/*                                                          @Z427VLS*/
*OUTEDIT: PROC (RECFLAG);                                  /*@Z427VLS*/
OUTEDIT  STM   @14,@12,@SA00004                                    0096
         MVC   @PC00004(4),0(@01)                                  0096
*      DCL RECFLAG CHAR(1);                                /*@Z427VLS*/
*      DCL 1 THRSHRC CHAR(8) BASED(R7),/* DUMMY AREA FOR ADDRESSING   *
*           2 *       CHAR(4),                                     0098
*           2 THRSHFLG CHAR(1);        /* RECORD FLAG FOR THRSH PROC  *
*      RESPECIFY (R9) RESTRICTED;                          /*@Z427VLS*/
*      R9 = EDITTAB;                   /* GET BASE OF EDIT TABLE      *
         L     R9,EDITTAB                                          0100
*      IF PARMTHR = ON THEN                                        0101
         TM    PARMTHR(R2),B'00001000'                             0101
         BNO   @RF00101                                            0101
*        DO;                                               /*@Z427VLS*/
*          ERTHRE = RDTHRSH;           /* READ THRESHOLD     @Z427VLS*/
         MVC   ERTHRE(3,R9),RDTHRSH(R2)                            0103
*          EWTHRE = WRTHRSH;           /* WRITE THRESHOLD    @Z427VLS*/
         MVC   EWTHRE(3,R9),WRTHRSH(R2)                            0104
*        END;                                              /*@Z427VLS*/
*      THRSHFLG = RECFLAG;             /* FLAG FOR THRESHOLD PROCESS  *
@RF00101 L     @10,@PC00004                                        0106
         MVC   THRSHFLG(1,R7),RECFLAG(@10)                         0106
*      CALL IFCEEDIT;                  /* GO TO IFCEEDIT     @Z427VLS*/
         L     @15,@CV00543                                        0107
         BALR  @14,@15                                             0107
*      THRSHFLG = HEXZERO;             /* RESTORE PLACE IN RECORD     *
         MVI   THRSHFLG(R7),X'00'                                  0108
*      RETURN;                                             /*@Z427VLS*/
@EL00004 DS    0H                                                  0109
@EF00004 DS    0H                                                  0109
@ER00004 LM    @14,@12,@SA00004                                    0109
         BR    @14                                                 0109
*      RESPECIFY (R9) UNRESTRICTED;                        /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* IN EVERY SUMMARY TABLE AT OFFSET 12 THERE IS A HALFWORK WITH THE  *
*/* NUMBER OF TWO BYTE COUNTERS NEEDED FOR THIS SERVICE.  AT THE      *
*/* BEGINNING OF EVERY COUNT AREA THERE ARE 22 BYTES OF CONTROL       *
*/* INFORMATION ADDED TO THE COUNT AREA.  THIS CODE ISSUES A GETMAIN  *
*/* FOR THIS AREA AND SETS IT TO ZERO.                       @Z427VLS*/
*/*                                                          @Z427VLS*/
*GETSPACE: PROC;                                           /*@Z427VLS*/
GETSPACE STM   @14,@12,@SA00005                                    0112
*          RESPECIFY (R0,R1,R7) RESTRICTED;                /*@Z427VLS*/
*          R0 = 22 + (CNTSIZE * 2);       /* DETERMINE SIZE OF AREA   *
         L     @10,SUMTAB                                          0114
         LH    R0,CNTSIZE(,@10)                                    0114
         ALR   R0,R0                                               0114
         AL    R0,@CF00614                                         0114
*          GEN(GETMAIN R,LV=(0));                          /*@Z427VLS*/
         GETMAIN R,LV=(0)
*          IF CNTAREA = ZERO THEN                                  0116
         L     @10,CNTAREA                                         0116
         LTR   @10,@10                                             0116
         BNZ   @RF00116                                            0116
*            CNTAREA = R1;                /* 1ST COUNTER AREA         *
         ST    R1,CNTAREA                                          0117
*          ELSE                                                    0118
*            DO CURRCNTS = CNTAREA;                        /*@Z427VLS*/
         B     @RC00116                                            0118
@RF00116 L     @10,CNTAREA                                         0118
         ST    @10,CURRCNTS                                        0118
*              DO WHILE (CURRCNTS -> NEXTTAB ^= ZERO); /* FIND END    *
         B     @DE00119                                            0119
@DL00119 DS    0H                                                  0120
*                CURRCNTS = NEXTTAB;                       /*@Z427VLS*/
         L     @10,CURRCNTS                                        0120
         L     @10,NEXTTAB(,@10)                                   0120
         ST    @10,CURRCNTS                                        0120
*              END;                                        /*@Z427VLS*/
@DE00119 L     @10,CURRCNTS                                        0121
         L     @06,NEXTTAB(,@10)                                   0121
         LTR   @06,@06                                             0121
         BNZ   @DL00119                                            0121
*              NEXTTAB = R1;              /* ADD TO END OF CHAIN      *
         ST    R1,NEXTTAB(,@10)                                    0122
*            END;                                          /*@Z427VLS*/
*          CURRCNTS = R1;                 /* SET POINTER TO AREA      *
@RC00116 ST    R1,CURRCNTS                                         0124
*          RESPECIFY (R0,R1) UNRESTRICTED;                 /*@Z427VLS*/
*          DO R7 = CNTSIZE TO 1 BY -1;    /* CLEAR SUM AREA  @Z427VLS*/
         L     @10,SUMTAB                                          0126
         LH    R7,CNTSIZE(,@10)                                    0126
         B     @DE00126                                            0126
@DL00126 DS    0H                                                  0127
*            COUNTERS(R7) = ZERO;                          /*@Z427VLS*/
         LR    @10,R7                                              0127
         ALR   @10,@10                                             0127
         SLR   @06,@06                                             0127
         L     @05,CURRCNTS                                        0127
         STH   @06,COUNTERS-2(@10,@05)                             0127
*          END;                                            /*@Z427VLS*/
         BCTR  R7,0                                                0128
@DE00126 LTR   R7,R7                                               0128
         BP    @DL00126                                            0128
*          /*                                                @Z427VLS*/
*          /* THIS CODE INITIALIZED THE HEADER AREA OF THE SUM AREA.  *
*          /* IT MARKS THIS AS THE LAST SUM AREA AND PUTS IN OTHER    *
*          /* IDENTIFYING INFORMATION.                       @Z427VLS*/
*          /*                                                @Z427VLS*/
*          NEXTTAB = ZERO;             /* INITIALIZE HEADER OF AREA   *
         L     @10,CURRCNTS                                        0129
         SLR   @06,@06                                             0129
         ST    @06,NEXTTAB(,@10)                                   0129
*          SUMIDENT = CUACPU;          /* CPU/CUA OR VOLID   @Z427VLS*/
         MVC   SUMIDENT(8,@10),CUACPU                              0130
*          MODNAME = STABNAME;         /* MODULE NAME TO EDIT AREA    *
         MVC   MODNAME(8,@10),STABNAME                             0131
*          CURRDEV = SAVEDEV;          /* DEVICE CODE        @Z427VLS*/
         MVC   CURRDEV(2,@10),SAVEDEV                              0132
*          RETURN;                                         /*@Z427VLS*/
@EL00005 DS    0H                                                  0133
@EF00005 DS    0H                                                  0133
@ER00005 LM    @14,@12,@SA00005                                    0133
         BR    @14                                                 0133
*          RESPECIFY (R7) UNRESTRICTED;                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* THE NEXT CODE SUMMARIZES THE INDIVIDUAL RECORDS INTO THE COUNTER  *
*/* AREA.  A'FF'X ENTRY SIGNIFIES THE END OF THE TABLE AND WHEN IT IS *
*/* FOUND A BRANCH IS TAKEN TO CHECK WHAT PASS WE ARE IN.    @Z427VLS*/
*/*                                                          @Z427VLS*/
*SUMIT: PROC;                                              /*@Z427VLS*/
SUMIT    STM   @14,@12,@SA00006                                    0136
*       RESPECIFY (R3,R9) RESTRICTED;                      /*@Z427VLS*/
*       /*                                                   @Z427VLS*/
*       /* SUMSPEC1 IS LOADED WITH THE ADDRESS OF THE ENTRY FOR THE   *
*       /* SPECIAL ROUTINE WITHIN THE SUMMARY MODULE.  SPECIAL WILL   *
*       /* CAUSE THE NECESSARY LINKAGE TO BE GENERATED BY THE COMPILER*
*       /*                                                   @Z427VLS*/
*       DCL SUMSPEC1 PTR(31);                              /*@Z427VLS*/
*       DCL SPECIAL ENTRY BASED(SUMSPEC1);                 /*@Z427VLS*/
*       NEXTENT = SUMPTR;              /* GET POINTER TO SUM ENTRIES  *
         L     @10,SUMTAB                                          0140
         L     @08,SUMPTR(,@10)                                    0140
         ST    @08,NEXTENT(,@10)                                   0140
*       R9 = SUMTAB;                  /* ADDRESS OF SUMMARY TABLE     *
         LR    R9,@10                                              0141
*       DO UNTIL (SUMFLAG = FOXFOX);                       /*@Z427VLS*/
@DL00142 DS    0H                                                  0143
*         /*                                                 @Z427VLS*/
*         /* GET THE ADDRESS OF THE COUNTER TO BE UPDATED.   @Z427VLS*/
*         /*                                                 @Z427VLS*/
*         R3 = CURRCNTS + 22 + (2 * CNTOFSET);             /*@Z427VLS*/
         LA    R3,22                                               0143
         AL    R3,CURRCNTS                                         0143
         L     @10,SUMTAB                                          0143
         L     @10,NEXTENT(,@10)                                   0143
         LH    @08,CNTOFSET(,@10)                                  0143
         ALR   @08,@08                                             0143
         ALR   R3,@08                                              0143
*         /*                                                 @Z427VLS*/
*         /* A '00'X ENTRY MEANS THAT A GIVEN BIT IN THE RECORD MUST  *
*         /* BE TESTED AND THE COUNTER UPDATED IF THE BIT IS ON.  AN  *
*         /* '80'X ENTRY MEANS THAT CONTROL IS TO BE GIVEN TO SPECIAL *
*         /* ROUTINE WITH REG3 POINTING TO THE COUNTER TO BE UPDATED*/
*         /* AND REG9 HAVING THE BASE OF THE SUM TABLE.      @Z427VLS*/
*         /*                                                 @Z427VLS*/
*         IF SUMFLAG = HEXZERO THEN    /* IS THIS A NORMAL SUMMARY    *
         CLI   SUMFLAG(@10),X'00'                                  0144
         BNE   @RF00144                                            0144
*           DO;                                            /*@Z427VLS*/
*             IF (SUMMARY & SUMMASK) = SUMMASK THEN                0146
         LR    @08,BUFFPTR                                         0146
         AH    @08,OFFSET(,@10)                                    0146
         MVC   @TS00001(1),SUMMARY(@08)                            0146
         NC    @TS00001(1),SUMMASK(@10)                            0146
         CLC   @TS00001(1),SUMMASK(@10)                            0146
         BNE   @RF00146                                            0146
*                COUNTER = COUNTER + 1;  /* IF ON-INCREMENT CTR       *
         LA    @10,1                                               0147
         AH    @10,COUNTER(,R3)                                    0147
         STH   @10,COUNTER(,R3)                                    0147
*           END;                                           /*@Z427VLS*/
*         ELSE                                                     0149
*           DO;                                            /*@Z427VLS*/
         B     @RC00144                                            0149
@RF00144 DS    0H                                                  0150
*             R2 = BUFFPTR;            /* GET POINTER TO RECORD       *
         LR    R2,BUFFPTR                                          0150
*             SUMSPEC1 = SUMSPEC + SUMTAB;                 /*@Z427VLS*/
         L     @10,SUMTAB                                          0151
         L     @08,NEXTENT(,@10)                                   0151
         AH    @10,SUMSPEC(,@08)                                   0151
         ST    @10,SUMSPEC1                                        0151
*             CALL SPECIAL;            /* GO TO ROUTINE IN SUM TABLE  *
         LR    @15,@10                                             0152
         BALR  @14,@15                                             0152
*           END;                                           /*@Z427VLS*/
*         NEXTENT = NEXTENT + 6;       /* UPDATE SUMMARY ENTRY        *
@RC00144 L     @10,SUMTAB                                          0154
         LA    @08,6                                               0154
         AL    @08,NEXTENT(,@10)                                   0154
         ST    @08,NEXTENT(,@10)                                   0154
*       END;                                               /*@Z427VLS*/
@DE00142 L     @10,SUMTAB                                          0155
         L     @10,NEXTENT(,@10)                                   0155
         CLI   SUMFLAG(@10),X'FF'                                  0155
         BNE   @DL00142                                            0155
*       LASTDATE = DATE;               /* SAVE THE DATE OF THIS RECORD*
         MVC   LASTDATE(4),DATE(BUFFPTR)                           0156
*       LASTCUA = SAVECUA;             /* SAVE THE CUA OF THIS RECORD *
         MVC   LASTCUA(3),SAVECUA                                  0157
*       LASTCPU = SAVECPU;             /* SAVE THE CPU OF THIS RECORD *
         MVC   LASTCPU(5),SAVECPU                                  0158
*       RETURN;                                            /*@Z427VLS*/
@EL00006 DS    0H                                                  0159
@EF00006 DS    0H                                                  0159
@ER00006 LM    @14,@12,@SA00006                                    0159
         BR    @14                                                 0159
*       RESPECIFY (R3,R9) UNRESTRICTED;                    /*@Z427VLS*/
*END;                                                      /*@Z427VLS*/
*/*                                                          @Z427VLS*/
*/* LOOK UP THE CUA IN THE SHARE TABLE FOR THE CONVERTED SHARE VALUE. *
*/* IF IT IS FOUND, RETURN THE CONVERTED VALUE IN NEW CUA. IF NOT,    *
*/* RETURN THE ORIGINAL VALUE IN NEWCUA.                     @Z427VLS*/
*/*                                                          @Z427VLS*/
*CUASHARE: PROC;                                           /*@Z427VLS*/
CUASHARE STM   @14,@12,12(@13)                                     0162
*    VALIDSHR = OFF;                          /* TURN OFF FOR SEARCH  *
         NI    VALIDSHR,B'11101111'                                0163
*    SHR74CUA = OCUA2;                        /* CUA FOR COMPARISON   *
         MVC   SHR74CUA(2),OCUA2(BUFFPTR)                          0164
*    SHR74CPU = CPUIDENT;                     /* CPU FOR COMPARISON   *
         MVC   SHR74CPU(3),CPUIDENT(BUFFPTR)                       0165
*    DO I = 1 TO SHARENUM BY 1 WHILE(VALIDSHR = OFF);      /*@Z427VLS*/
         LA    @10,1                                               0166
         STH   @10,I                                               0166
         B     @DE00166                                            0166
@DL00166 TM    VALIDSHR,B'00010000'                                0166
         BNZ   @DC00166                                            0166
*       IF SHAREFLG(I)=LETTERS & SHR74CPU=SHARSERA(I) &            0167
*         SHR74CUA>=SHRCUAAL(I) & SHR74CUA<=SHRCUAAH(I) THEN       0167
         SLA   @10,4                                               0167
         L     @06,SHAREPTR(,R2)                                   0167
         ST    @10,@TF00001                                        0167
         ALR   @10,@06                                             0167
         AL    @10,@CF00653                                        0167
         CLC   SHAREFLG-2(1,@10),LETTERS                           0167
         BNE   @RF00167                                            0167
         LR    @10,@06                                             0167
         AL    @10,@TF00001                                        0167
         AL    @10,@CF00654                                        0167
         CLC   SHR74CPU(3),SHARSERA-10(@10)                        0167
         BNE   @RF00167                                            0167
         LR    @10,@06                                             0167
         AL    @10,@TF00001                                        0167
         AL    @10,@CF00655                                        0167
         CLC   SHR74CUA(2),SHRCUAAL-13(@10)                        0167
         BL    @RF00167                                            0167
         LR    @10,@06                                             0167
         AL    @10,@TF00001                                        0167
         BCTR  @10,0                                               0167
         CLC   SHR74CUA(2),SHRCUAAH-15(@10)                        0167
         BH    @RF00167                                            0167
*          DO;                                /* CUA ONLY.   @Z427VLS*/
*            RECCUA=SHRCUABL(I) + SHR74CUA- SHRCUAAL(I);   /*@D3506GB*/
         LR    @10,@06                                             0169
         AL    @10,@TF00001                                        0169
         AL    @10,@CF00656                                        0169
         SLR   @05,@05                                             0169
         ICM   @05,3,SHRCUABL-6(@10)                               0169
         SLR   @10,@10                                             0169
         ICM   @10,3,SHR74CUA                                      0169
         ALR   @05,@10                                             0169
         LR    @10,@06                                             0169
         AL    @10,@TF00001                                        0169
         AL    @10,@CF00655                                        0169
         SLR   @03,@03                                             0169
         ICM   @03,3,SHRCUAAL-13(@10)                              0169
         SLR   @05,@03                                             0169
         STCM  @05,3,RECCUA                                        0169
*            RECCPU = SHARSERB(I);                         /*@0001VLS*/
         AL    @06,@TF00001                                        0170
         AL    @06,@CF00657                                        0170
         MVC   RECCPU(3),SHARSERB-3(@06)                           0170
*            VALIDSHR = ON;                                /*@Z427VLS*/
         OI    VALIDSHR,B'00010000'                                0171
*          END;                                            /*@Z427VLS*/
*    END;                                                  /*@Z427VLS*/
@RF00167 LA    @10,1                                               0173
         AH    @10,I                                               0173
         STH   @10,I                                               0173
@DE00166 L     @06,SHAREPTR(,R2)                                   0173
         CH    @10,SHARENUM(,@06)                                  0173
         BNH   @DL00166                                            0173
@DC00166 DS    0H                                                  0174
*    RETURN;                                               /*@Z427VLS*/
@EL00007 DS    0H                                                  0174
@EF00007 DS    0H                                                  0174
@ER00007 LM    @14,@12,12(@13)                                     0174
         BR    @14                                                 0174
* END;                                                     /*@Z427VLS*/
@PB00007 DS    0H                                                  0176
*/*                                                          @Z427VLS*/
*/* INITIALLY THE ADDRESS OF THE PARAMETER LIST IS SAVED.  NEXT AN    *
*/* AREA OF CORE IS GOTTEN FOR THE CONTROL TABLE.            @Z427VLS*/
*/*                                                          @Z427VLS*/
*        SAVEPARM = R2;                /* SAVE ADDR TO PARM TABLE     *
         ST    R2,SAVEPARM                                         0176
*        IF DEBUG4 = ON THEN                                       0177
         TM    DEBUG4(R2),B'00001000'                              0177
         BNO   @RF00177                                            0177
*          DO;                                             /*@Z427VLS*/
*            R15 = R12 - 27;                               /*@Z427VLS*/
         LR    R15,R12                                             0179
         SL    R15,@CF00639                                        0179
*            GEN(MVC  MSGADDR(16),0(R15));                 /*@Z427VLS*/
         MVC  MSGADDR(16),0(R15)
*            PRINTADR = ADDR(MESSAGE);                     /*@Z427VLS*/
         LA    @10,MESSAGE                                         0181
         ST    @10,PRINTADR(,R2)                                   0181
*            CURRPTR = ADDR(IFCEEDIT);                     /*@Z427VLS*/
         L     CURRPTR,@CV00543                                    0182
*            GEN(MVC MSGADDR+20(16),5(CURRPTR));           /*@Z427VLS*/
         MVC MSGADDR+20(16),5(CURRPTR)
*            PRINTADR = ADDR(MESSAGE);                     /*@Z427VLS*/
         LA    @10,MESSAGE                                         0184
         ST    @10,PRINTADR(,R2)                                   0184
*            CALL IOHND(RITEPRTR);                         /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0185
         LA    @01,@AL00185                                        0185
         BALR  @14,@15                                             0185
*          END;                                            /*@Z427VLS*/
*        RESPECIFY (R0,R1) RESTRICTED;                     /*@Z427VLS*/
@RF00177 DS    0H                                                  0188
*        R0 = TABSIZE;                                     /*@Z427VLS*/
         L     R0,TABSIZE(,R2)                                     0188
*  GEN(GETMAIN EC,LV=(0),A=TABPTR);                        /*@0001VLS*/
         GETMAIN EC,LV=(0),A=TABPTR
*    IF R15 = ZERO THEN                                            0190
         LTR   R15,R15                                             0190
         BNZ   @RF00190                                            0190
*    DO;                                                   /*@GZZDGVS*/
*        RESPECIFY (R0,R1) UNRESTRICTED;                   /*@Z427VLS*/
*        CURRPTR = TABPTR + TABSIZE - 2;                   /*@Z427VLS*/
         L     CURRPTR,TABPTR                                      0193
         AL    CURRPTR,TABSIZE(,R2)                                0193
         BCTR  CURRPTR,0                                           0193
         BCTR  CURRPTR,0                                           0193
*        EOTABLE = EOT;                /* PUT IN END OF TABLE INDICAT *
         MVC   EOTABLE(2,CURRPTR),@CB00260                         0194
*        CURRPTR = CURRPTR - 11;                           /*@Z427VLS*/
         SL    CURRPTR,@CF00034                                    0195
*        RESPECIFY (R15) RESTRICTED;                       /*@Z427VLS*/
*        CALL IOHND(READSEQ);          /* GET AN INPUT RECORD         *
         L     @15,ADIOHND(,R2)                                    0197
         LA    @01,@AL00197                                        0197
         BALR  @14,@15                                             0197
*        RETCODE = R15;                                    /*@Z427VLS*/
         ST    R15,RETCODE                                         0198
*        RESPECIFY (R15) UNRESTRICTED;                     /*@Z427VLS*/
*        DO WHILE (CURRPTR >= TABPTR & RETCODE = ZERO);    /*@Z427VLS*/
         B     @DE00200                                            0200
@DL00200 DS    0H                                                  0201
*          /*                                                @Z427VLS*/
*          /* THIS NEXT CODE WILL GET THE DEVICE TYPE AND CUA FROM THE*
*          /* PROPER OFFSET IN THE RECORD.  WITH A LONG OBR RECORD,   *
*          /* THE INFORMATION WILL BE RETRIEVED FROM THE NORMAL       *
*          /* OFFSETS.                                       @Z427VLS*/
*          /*                                                @Z427VLS*/
*          IF (RECTYP & FOXZERO) = OBRREC &                        0201
*              SHORT = OFF & DEV2 = SAVEDEV &                      0201
*              DATE >= STDATE & DATE <= ENDDATE &                  0201
*              ((SHIFT3RD = OFF & TIME >= STTIME1 & TIME <= ENDTIME1) ×
*               (SHIFT3RD = ON &                                   0201
*                ((TIME >= STTIME1 & DATE ^= ENDDATE) ×            0201
*                 (TIME <= ENDTIME2 & DATE ^= STDATE)))) THEN      0201
         MVC   @TS00001(1),RECTYP(BUFFPTR)                         0201
         NI    @TS00001,X'F0'                                      0201
         CLI   @TS00001,X'30'                                      0201
         BNE   @RF00201                                            0201
         TM    SHORT(BUFFPTR),B'00100000'                          0201
         BNZ   @RF00201                                            0201
         CLC   DEV2(2,BUFFPTR),SAVEDEV                             0201
         BNE   @RF00201                                            0201
         CLC   DATE(4,BUFFPTR),STDATE(R2)                          0201
         BL    @RF00201                                            0201
         CLC   DATE(4,BUFFPTR),ENDDATE(R2)                         0201
         BH    @RF00201                                            0201
         TM    SHIFT3RD(R2),B'00010000'                            0201
         BNZ   @GL00009                                            0201
         CLC   TIME(4,BUFFPTR),STTIME1(R2)                         0201
         BL    @GL00009                                            0201
         CLC   TIME(4,BUFFPTR),ENDTIME1(R2)                        0201
         BNH   @RT00201                                            0201
@GL00009 TM    SHIFT3RD(R2),B'00010000'                            0201
         BNO   @RF00201                                            0201
         CLC   TIME(4,BUFFPTR),STTIME1(R2)                         0201
         BL    @GL00013                                            0201
         CLC   DATE(4,BUFFPTR),ENDDATE(R2)                         0201
         BNE   @RT00201                                            0201
@GL00013 CLC   TIME(4,BUFFPTR),ENDTIME2(R2)                        0201
         BH    @RF00201                                            0201
         CLC   DATE(4,BUFFPTR),STDATE(R2)                          0201
         BE    @RF00201                                            0201
@RT00201 DS    0H                                                  0202
*            DO;                                           /*@Z427VLS*/
*              /*                                            @Z427VLS*/
*              /* THIS NEXT SECTION OF CODE COMPARES THE OBR JUST READ*
*              /* IN WITH THE PARAMETERS SPECIFIED ON THE EXEC CARD   *
*              /* AND PUT IN A LIST BY PARAMETER PROCESSOR.  @Z427VLS*/
*              /* IF NO CUA WAS SPECIFIED, THE POINTER TO THE CUA     *
*              /* TABLE WILL BE ZERO.  IF IT IS NOT, THEN A MAXIMUM   *
*              /* OF SIXTEEN INDIVIDUAL OR RANGE CUAS MUST BE COMPARED*
*              /* TO THE CUA IN THE RECORD.                  @Z427VLS*/
*              /*                                            @Z427VLS*/
*              VALIDCUA = OFF;                             /*@Z427VLS*/
*              VALIDCPU = OFF;                             /*@Z427VLS*/
*              VALIDSER = OFF;                             /*@Z427VLS*/
*              VALIDVOL = OFF;                             /*@Z427VLS*/
         NI    VALIDCUA,B'10010011'                                0206
*              IF CUAPTR ^= ZERO THEN        /* ARE ALL CUA'S WANTED  *
         L     @10,CUAPTR(,R2)                                     0207
         LTR   @10,@10                                             0207
         BZ    @RF00207                                            0207
*                DO I = 1 TO CUANUM BY 1 WHILE (VALIDCUA = OFF);   0208
         LA    @10,1                                               0208
         STH   @10,I                                               0208
         B     @DE00208                                            0208
@DL00208 TM    VALIDCUA,B'00001000'                                0208
         BNZ   @DC00208                                            0208
*                  IF OCUA2 >= CUA1(I) &     /* DOES THE CUA LIE IN   *
*                     OCUA2 <= CUA2(I) THEN  /* RANGE SPECIFIED       *
         SLA   @10,2                                               0209
         L     @06,CUAPTR(,R2)                                     0209
         ST    @10,@TF00001                                        0209
         ALR   @10,@06                                             0209
         BCTR  @10,0                                               0209
         BCTR  @10,0                                               0209
         CLC   OCUA2(2,BUFFPTR),CUA1-2(@10)                        0209
         BL    @RF00209                                            0209
         AL    @06,@TF00001                                        0209
         CLC   OCUA2(2,BUFFPTR),CUA2-4(@06)                        0209
         BH    @RF00209                                            0209
*                       VALIDCUA = ON;       /* ACCEPT RECORD         *
         OI    VALIDCUA,B'00001000'                                0210
*                END;                                      /*@Z427VLS*/
@RF00209 LA    @10,1                                               0211
         AH    @10,I                                               0211
         STH   @10,I                                               0211
@DE00208 L     @06,CUAPTR(,R2)                                     0211
         CH    @10,CUANUM(,@06)                                    0211
         BNH   @DL00208                                            0211
@DC00208 DS    0H                                                  0212
*              ELSE                                                0212
*                VALIDCUA = ON;              /* ACCEPT RECORD         *
         B     @RC00207                                            0212
@RF00207 OI    VALIDCUA,B'00001000'                                0212
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE TO SEE IF A LIST OF VOLID'S WAS     *
*              /* PASSED IN THE PARAMETER LIST.  IF IT WAS, THE VOLID *
*              /* IN THE RECORD IS COMPARED TO THE VOLIDS IN THE LIST *
*              /* TO SEE IF THE RECORD SHOULD BE INCLUDED IN THE      *
*              /* REPORTS.                                   @Z427VLS*/
*              /*                                            @Z427VLS*/
*              IF VOLPTR ^= ZERO THEN        /* WAS A VOLID SPECIFIED *
@RC00207 L     @10,VOLPTR(,R2)                                     0213
         LTR   @10,@10                                             0213
         BZ    @RF00213                                            0213
*                DO I = 1 TO VOLNUM BY 1 WHILE(VALIDVOL = OFF);    0214
         LA    @10,1                                               0214
         STH   @10,I                                               0214
         B     @DE00214                                            0214
@DL00214 TM    VALIDVOL,B'00000100'                                0214
         BNZ   @DC00214                                            0214
*                  IF VOLVAL(I) = VOLID THEN /* VOLUME IN LIST        *
         MH    @10,@CH00079                                        0215
         L     @06,VOLPTR(,R2)                                     0215
         ALR   @06,@10                                             0215
         AL    @06,@CF00660                                        0215
         CLC   VOLVAL-2(6,@06),VOLID(BUFFPTR)                      0215
         BNE   @RF00215                                            0215
*                    VALIDVOL = ON;          /* ACCEPT RECORD         *
         OI    VALIDVOL,B'00000100'                                0216
*                END;                                      /*@Z427VLS*/
@RF00215 LA    @10,1                                               0217
         AH    @10,I                                               0217
         STH   @10,I                                               0217
@DE00214 L     @06,VOLPTR(,R2)                                     0217
         CH    @10,VOLNUM(,@06)                                    0217
         BNH   @DL00214                                            0217
@DC00214 DS    0H                                                  0218
*              ELSE                                                0218
*                VALIDVOL = ON;              /* ACCEPT RECORD         *
         B     @RC00213                                            0218
@RF00213 OI    VALIDVOL,B'00000100'                                0218
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE AGAINST ANY CPU WERE SPECIFIED      *
*              /*                                            @Z427VLS*/
*              IF CPUPTR ^= ZERO THEN                              0219
@RC00213 L     @10,CPUPTR(,R2)                                     0219
         LTR   @10,@10                                             0219
         BZ    @RF00219                                            0219
*                DO I = 1 TO CPUNUM BY 1 WHILE(VALIDCPU = OFF);    0220
         LA    @10,1                                               0220
         STH   @10,I                                               0220
         B     @DE00220                                            0220
@DL00220 TM    VALIDCPU,B'00100000'                                0220
         BNZ   @DC00220                                            0220
*                  IF CPUIDENT = CPUVAL(I) THEN                    0221
         MH    @10,@CH00077                                        0221
         L     @06,CPUPTR(,R2)                                     0221
         ALR   @06,@10                                             0221
         AL    @06,@CF00655                                        0221
         CLC   CPUIDENT(5,BUFFPTR),CPUVAL-2(@06)                   0221
         BNE   @RF00221                                            0221
*                    VALIDCPU = ON;                        /*@Z427VLS*/
         OI    VALIDCPU,B'00100000'                                0222
*                END;                                      /*@Z427VLS*/
@RF00221 LA    @10,1                                               0223
         AH    @10,I                                               0223
         STH   @10,I                                               0223
@DE00220 L     @06,CPUPTR(,R2)                                     0223
         CH    @10,CPUNUM(,@06)                                    0223
         BNH   @DL00220                                            0223
@DC00220 DS    0H                                                  0224
*              ELSE                                                0224
*                VALIDCPU = ON;                            /*@Z427VLS*/
         B     @RC00219                                            0224
@RF00219 OI    VALIDCPU,B'00100000'                                0224
*              /*                                            @Z427VLS*/
*              /* A CHECK IS MADE AGAINST ANY DEVSER THAT WERE SPECIFD*
*              /*                                            @Z427VLS*/
*              IF SERPTR ^= ZERO THEN                              0225
@RC00219 L     @10,SERPTR(,R2)                                     0225
         LTR   @10,@10                                             0225
         BZ    @RF00225                                            0225
*                DO I = 1 TO SERNUM BY 1 WHILE(VALIDSER = OFF);    0226
         LA    @10,1                                               0226
         STH   @10,I                                               0226
         B     @DE00226                                            0226
@DL00226 TM    VALIDSER,B'01000000'                                0226
         BNZ   @DC00226                                            0226
*                  IF OSER74XX = SERVAL(I) THEN                    0227
         ALR   @10,@10                                             0227
         L     @06,SERPTR(,R2)                                     0227
         ALR   @06,@10                                             0227
         CLC   OSER74XX(2,BUFFPTR),SERVAL-2(@06)                   0227
         BNE   @RF00227                                            0227
*                    VALIDSER = ON;                        /*@Z427VLS*/
         OI    VALIDSER,B'01000000'                                0228
*                END;                                      /*@Z427VLS*/
@RF00227 LA    @10,1                                               0229
         AH    @10,I                                               0229
         STH   @10,I                                               0229
@DE00226 L     @06,SERPTR(,R2)                                     0229
         CH    @10,SERNUM(,@06)                                    0229
         BNH   @DL00226                                            0229
@DC00226 DS    0H                                                  0230
*              ELSE                                                0230
*                VALIDSER = ON;                            /*@Z427VLS*/
         B     @RC00225                                            0230
@RF00225 OI    VALIDSER,B'01000000'                                0230
*              /*                                            @Z427VLS*/
*              IF VALIDCUA = ON & VALIDVOL = ON & VALIDCPU = ON &  0231
*                 VALIDSER = ON THEN                               0231
@RC00225 TM    VALIDCUA,B'01101100'                                0231
         BNO   @RF00231                                            0231
*                DO RECCOUNT = RECCOUNT + 1; /* INCREMENT RECORD COUNT*
         LA    @10,1                                               0232
         AL    @10,RECCOUNT                                        0232
         ST    @10,RECCOUNT                                        0232
*                  IF PHIST = ON THEN                              0233
         TM    PHIST(R2),B'00100000'                               0233
         BNO   @RF00233                                            0233
*                   DO;                                    /*@0001VLS*/
*                    RESPECIFY (R15) RESTRICTED;           /*@0001VLS*/
*                    CALL IOHND(RITESCRT);                 /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0236
         LA    @01,@AL00236                                        0236
         BALR  @14,@15                                             0236
*                    RETCODE = R15;                        /*@0001VLS*/
         ST    R15,RETCODE                                         0237
*                    RESPECIFY (R15) UNRESTRICTED;         /*@0001VLS*/
*                   END;                                   /*@0001VLS*/
*                 IF RETCODE = ZERO THEN                           0240
@RF00233 SLR   @10,@10                                             0240
         C     @10,RETCODE                                         0240
         BNE   @RF00240                                            0240
*                  DO;                                     /*@0001VLS*/
*                  /*                                        @Z427VLS*/
*                  /* CHECK FOR SHARED I/O AND CHANGE CUA IF REQUIRED *
*                  /*                                        @Z427VLS*/
*                  CONTRTAB = CONTRTAB && CONTRTAB;        /*@0001VLS*/
         XC    CONTRTAB(11,CURRPTR),CONTRTAB(CURRPTR)              0242
*                  RECCUA = OCUA2;                         /*@0001VLS*/
         MVC   RECCUA(2),OCUA2(BUFFPTR)                            0243
*                  RECCPU = CPUSER;                        /*@0001VLS*/
         MVC   RECCPU(3),CPUSER(BUFFPTR)                           0244
*                  IF SHAREPTR ^= ZERO THEN                        0245
         C     @10,SHAREPTR(,R2)                                   0245
         BE    @RF00245                                            0245
*                    CALL CUASHARE;                        /*@Z427VLS*/
         BAL   @14,CUASHARE                                        0246
*                  CONTRCUA(2:3) = RECCUA;   /* GET CUA      @0001VLS*/
@RF00245 MVC   CONTRCUA+1(2,CURRPTR),RECCUA                        0247
*                  /*                                        @Z427VLS*/
*                  /* IF THRESHOLD, SORT BY CH AND CU ONLY.  @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = ON THEN                            0248
         TM    PARMTHR(R2),B'00001000'                             0248
         BNO   @RF00248                                            0248
*                    CONTRCUA(3) = CONTRCUA(3) & FOXZERO;  /*@Z427VLS*/
         NI    CONTRCUA+2(CURRPTR),X'F0'                           0249
*                  CPU = RECCPU;      /* PUT CPU SERIAL NUMBER IN    */
@RF00248 MVC   CPU(3,CURRPTR),RECCPU                               0250
*                  TABCCHHR = RECCCHHR;       /* PUT CCHHR IN TABLE   *
         MVC   TABCCHHR(5,CURRPTR),RECCCHHR(R2)                    0251
*                  CURRPTR = CURRPTR - 11;   /* DECREMENT TO NEXT ENTR*
         SL    CURRPTR,@CF00034                                    0252
*                  END;                                    /*@0001VLS*/
*                END;                                      /*@Z427VLS*/
@RF00240 DS    0H                                                  0255
*            END;                                          /*@Z427VLS*/
@RF00231 DS    0H                                                  0256
*            RESPECIFY (R15) RESTRICTED;                   /*@Z427VLS*/
@RF00201 DS    0H                                                  0257
*           IF RETCODE = ZERO THEN                                 0257
         L     @14,RETCODE                                         0257
         LTR   @14,@14                                             0257
         BNZ   @RF00257                                            0257
*             DO;                                          /*@0001VLS*/
*               CALL IOHND (READSEQ);         /* GET ANOTHER RECORD  */
         L     @15,ADIOHND(,R2)                                    0259
         LA    @01,@AL00259                                        0259
         BALR  @14,@15                                             0259
*               RETCODE = R15;                             /*@0001VLS*/
         ST    R15,RETCODE                                         0260
*             END;                                         /*@0001VLS*/
*            RESPECIFY (R15) UNRESTRICTED;                 /*@Z427VLS*/
@RF00257 DS    0H                                                  0263
*        END;                                              /*@Z427VLS*/
@DE00200 C     CURRPTR,TABPTR                                      0263
         BL    @DC00200                                            0263
         L     @10,RETCODE                                         0263
         LTR   @10,@10                                             0263
         BZ    @DL00200                                            0263
@DC00200 DS    0H                                                  0264
*        /*                                                  @Z427VLS*/
*        /* AT END OF FILE THE PART OF THE CONTROL TABLE THAT HAS NOT *
*        /* BEEN USED IS FREED AND THEN WE GO TO SORT THE CONTROL     *
*        /* TABLE AND PREPARE TO PROCESS THE RECORDS.        @Z427VLS*/
*        /*                                                  @Z427VLS*/
*        IF CURRPTR < TABPTR THEN         /* NOT ENOUGH TABLE SPACE   *
         C     CURRPTR,TABPTR                                      0264
         BNL   @RF00264                                            0264
*          DO;                                             /*@Z427VLS*/
*            CALL IFCMSG(53,ADDR(MSGADDR));                /*@Z427VLS*/
         LA    @10,MSGADDR                                         0266
         ST    @10,@AFTEMPS                                        0266
         L     @15,ADIFCMSG(,R2)                                   0266
         LA    @01,@AL00266                                        0266
         BALR  @14,@15                                             0266
*            PRINTADR = ADDR(MESSAGE);    /* INSUFF SPACE MESSAGE     *
         LA    @10,MESSAGE                                         0267
         ST    @10,PRINTADR(,R2)                                   0267
*            CALL IOHND(RITEPRTR);        /* OUTPUT MESSAGE  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0268
         LA    @01,@AL00268                                        0268
         BALR  @14,@15                                             0268
*          END;                                            /*@Z427VLS*/
*        CURRPTR = CURRPTR + 11;          /* PUT WITHIN BOUNDS        *
@RF00264 AL    CURRPTR,@CF00034                                    0270
*        CALL IFCMSG(54,ADDR(MSGADDR));                    /*@Z427VLS*/
         LA    @10,MSGADDR                                         0271
         ST    @10,@AFTEMPS                                        0271
         L     @15,ADIFCMSG(,R2)                                   0271
         LA    @01,@AL00271                                        0271
         BALR  @14,@15                                             0271
*        CVD (RECCOUNT,LASTDATE);         /* CONVVERT TO DECIMAL      *
         L     @10,RECCOUNT                                        0272
         CVD   @10,@TS00001                                        0272
         MVC   LASTDATE(4),@TS00001+4                              0272
*        UNPK (NUMRECP,LASTDATE);         /* PRINTABLE CHARACTERS     *
         UNPK  NUMRECP(7),LASTDATE(4)                              0273
*        NUMRECP(7) = NUMRECP(7) × FOXZERO;                /*@Z427VLS*/
         OI    NUMRECP+6,X'F0'                                     0274
*        I = 1;                                            /*@Z427VLS*/
         MVC   I(2),@CH00053                                       0275
*        DO UNTIL (I > 6 × NUMRECP(I) ^= FOXZERO);         /*@Z427VLS*/
@DL00276 DS    0H                                                  0277
*          NUMRECP(I) = BLANK;            /* SET LEADING ZERO TO BLANK*
         LH    @10,I                                               0277
         LA    @06,NUMRECP-1(@10)                                  0277
         MVI   0(@06),C' '                                         0277
*          I = I + 1;                                      /*@Z427VLS*/
         LA    @10,1(,@10)                                         0278
         STH   @10,I                                               0278
*        END;                                              /*@Z427VLS*/
@DE00276 LH    @10,I                                               0279
         C     @10,@CF00079                                        0279
         BH    @DC00276                                            0279
         LA    @06,NUMRECP-1(@10)                                  0279
         CLI   0(@06),X'F0'                                        0279
         BE    @DL00276                                            0279
@DC00276 DS    0H                                                  0280
*        PRINTADR = ADDR(MESSAGE);                         /*@Z427VLS*/
         LA    @10,MESSAGE                                         0280
         ST    @10,PRINTADR(,R2)                                   0280
*        CALL IOHND(RITEPRTR);            /* OUTPUT MESSAGE  @Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0281
         LA    @01,@AL00281                                        0281
         BALR  @14,@15                                             0281
*        FREESIZE = (CURRPTR - TABPTR);   /* UNUSED SPACE    @Z427VLS*/
         L     @10,TABPTR                                          0282
         LR    @06,CURRPTR                                         0282
         SLR   @06,@10                                             0282
         ST    @06,FREESIZE                                        0282
*        IF FREESIZE > EIGHT THEN         /* OUTPUT MESSAGE  @Z427VLS*/
         C     @06,@CF00064                                        0283
         BNH   @RF00283                                            0283
*          DO;                                             /*@Z427VLS*/
*            FREESIZE = FREESIZE & 'FFFFF8'X;  /* DOUBLE WORD AMOUNT  *
         N     @06,@CF00644                                        0285
         ST    @06,FREESIZE                                        0285
*            RESPECIFY (R0,R1) RESTRICTED;                 /*@Z427VLS*/
*            R0 = FREESIZE;                                /*@Z427VLS*/
         LR    R0,@06                                              0287
*            R1 = TABPTR;                                  /*@Z427VLS*/
         LR    R1,@10                                              0288
*            GEN(FREEMAIN R,LV=(R0),A=(R1));               /*@Z427VLS*/
         FREEMAIN R,LV=(R0),A=(R1)
*            RESPECIFY (R0,R1) UNRESTRICTED;               /*@Z427VLS*/
*          END;                                            /*@Z427VLS*/
*        TABPTR = CURRPTR;                /* SAVE ADDRESS OF NEW TABLE*
@RF00283 ST    CURRPTR,TABPTR                                      0292
*        SORTNUM = RECCOUNT;              /* STORE NUMBER OF RECORDS  *
         L     @10,RECCOUNT                                        0293
         ST    @10,SORTNUM(,R2)                                    0293
*        SORTADR = TABPTR;                /* LOCATION OF SORT TABLE   *
         L     @10,TABPTR                                          0294
         ST    @10,SORTADR(,R2)                                    0294
*        IF PHIST = ON THEN                                        0295
         TM    PHIST(R2),B'00100000'                               0295
         BNO   @RF00295                                            0295
*          DO;                                             /*@Z427VLS*/
*            /*                                              @Z427VLS*/
*            /* INPUT DATA SETS MUST BE CLOSED IF HISTORY IS INPUT    *
*            /*                                              @Z427VLS*/
*            CLOSEIO = CLOSEIO && CLOSEIO;                 /*@Z427VLS*/
         XC    CLOSEIO(2,R2),CLOSEIO(R2)                           0297
*            IF PLOGREC = ON THEN                                  0298
         TM    PLOGREC(R2),B'00000010'                             0298
         BNO   @RF00298                                            0298
*              CSERLOG = ON;                               /*@Z427VLS*/
         OI    CSERLOG(R2),B'00100000'                             0299
*            CDRCTWRK = ON;                                /*@Z427VLS*/
@RF00298 OI    CDRCTWRK(R2),B'00000010'                            0300
*            CALL IOHND (IOCLOSE);                         /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0301
         LA    @01,@AL00301                                        0301
         BALR  @14,@15                                             0301
*          END;                                            /*@Z427VLS*/
*        /*                                                  @Z427VLS*/
*        /* WHEN END OF FILE HAS BEEN REACHED OR THE CONTROL @Z427VLS*/
*        /* TABLE IS FULL THE ENTRIES ARE SORTED FOR PROCESSING.      *
*        /* THE COUNT OF RECORDS AND THE ADDRESS OF THE FIRST ENTRY IS*
*        /* SAVED FOR THE SECOND PASS.                       @Z427VLS*/
*        /*                                                  @Z427VLS*/
*          DO;                                             /*@Z427VLS*/
@RF00295 DS    0H                                                  0304
*            IF RECCOUNT > ONE THEN     /* INSURE > ONE REC  @ZA26586*/
         L     @10,RECCOUNT                                        0304
         C     @10,@CF00053                                        0304
         BNH   @RF00304                                            0304
*              DO;                                         /*@ZA26586*/
*                CALL SORT;                                /*@ZA26586*/
         BAL   @14,SORT                                            0306
*              END;                                        /*@ZA26586*/
*            IF DEBUG11 = ON THEN      /* ABEND REQUESTED?   @Z427VLS*/
@RF00304 TM    DEBUG11(R2),B'00010000'                             0308
         BNO   @RF00308                                            0308
*              GEN (ABEND 520,DUMP);                       /*@Z427VLS*/
         ABEND 520,DUMP
*            /*                                              @Z427VLS*/
*            /* START PROCESSING THE ENTRIES IN THE CONTROL TABLE. AT *
*            /* THE END OF THE TABLE, PROCESS THE SUMMARY CTRS WHICH  *
*            /* HAVE BEEN BUILT DURING RECORD PROCESSING. LOAD        *
*            /* IFCECUA0/1 AND IFCSCUA0/1 FOR PROCESSING. IF THE      *
*            /* IFCE/SCUA1 ROUTINES ARE LOADED THRESHOLD HAS BEEN     *
*            /* SPECIFIED.                                   @Z427VLS*/
*            /*                                              @Z427VLS*/
*            IF PARMTHR = ON THEN                                  0310
@RF00308 TM    PARMTHR(R2),B'00001000'                             0310
         BNO   @RF00310                                            0310
*              TABNBR = CHARONE;         /* THRESHOLD PROCESSING      *
         MVI   TABNBR,C'1'                                         0311
*            STABNBR = TABNBR;           /* ESTABLISH SUM TBL NUMBER  *
@RF00310 MVC   STABNBR(1),TABNBR                                   0312
*            GENERATE REFS(ETABNAME,EDITTAB,STABNAME,SUMTAB);      0313
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
               ST   R0,EDITTAB                  SAVE ADDRESS
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
               ST   R0,SUMTAB                   SAVE ADDRESS
*            DO CURRPTR = CURRPTR BY 11 WHILE (EOTABLE ^= EOT);    0314
         B     @DE00314                                            0314
@DL00314 DS    0H                                                  0315
*              RECCCHHR = TABCCHHR;                        /*@Z427VLS*/
         MVC   RECCCHHR(5,R2),TABCCHHR(CURRPTR)                    0315
*              RESPECIFY (R15) RESTRICTED;                 /*@Z427VLS*/
*              CALL IOHND(READIRCT);     /* GET A RECORD BY CCHHR     *
         L     @15,ADIOHND(,R2)                                    0317
         LA    @01,@AL00317                                        0317
         BALR  @14,@15                                             0317
*              RETCODE = R15;                              /*@Z427VLS*/
         ST    R15,RETCODE                                         0318
*              RESPECIFY (R15) UNRESTRICTED;               /*@Z427VLS*/
*              IF RETCODE = ZERO THEN                              0320
         L     @10,RETCODE                                         0320
         SLR   @06,@06                                             0320
         CR    @10,@06                                             0320
         BNE   @RF00320                                            0320
*                DO;                                       /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* BUILD A TABLE WITH THE CUA, DEVICE CODE, AND CPU*
*                  /* SERIAL NUMBER, TO CONTROL PROCESSING THE RECORD.*
*                  /*                                        @Z427VLS*/
*                  CUACPU = CUACPU && CUACPU;       /* CLEAR SAVE AREA*
         XC    CUACPU(8),CUACPU                                    0322
*                  SAVECUA(2:3) = CONTRCUA(2:3);     /* SAVE CUA     */
         MVC   SAVECUA+1(2),CONTRCUA+1(CURRPTR)                    0323
*                  SAVECPU(1:3) = CPU;               /* SAVE CPU     */
         MVC   SAVECPU(3),CPU(CURRPTR)                             0324
*                  /*                                        @Z427VLS*/
*                  /* DETERMINE IF THE CUA SUMMARY COUNTERS MUST BE   *
*                  /* PRINTED.  THEY ARE PRINTED AFTER THE RECORDS FOR*
*                  /* EACH CUA.  EACH DATE COVERED HAS A SEPARATE CTR *
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = ON & CNTAREA ^= ZERO &             0325
*                    (LASTCUA ^= SAVECUA ×                         0325
*                    LASTCPU(1:3) ^= SAVECPU(1:3)) THEN            0325
         TM    PARMTHR(R2),B'00001000'                             0325
         BNO   @RF00325                                            0325
         C     @06,CNTAREA                                         0325
         BE    @RF00325                                            0325
         CLC   LASTCUA(3),SAVECUA                                  0325
         BNE   @RT00325                                            0325
         CLC   LASTCPU(3),SAVECPU                                  0325
         BE    @RF00325                                            0325
@RT00325 DS    0H                                                  0326
*                    /* DIFFERENT CUAS OR CPUS.              @Z427VLS*/
*                    DO;                                   /*@Z427VLS*/
*                      CALL OUTEDIT (FOXEASY);             /*@Z427VLS*/
         LA    @01,@AL00327                                        0327
         BAL   @14,OUTEDIT                                         0327
*                      CALL OUTSUM;               /* OUTPUT SUM CTRS  *
         BAL   @14,OUTSUM                                          0328
*                      GENERATE REFS(ETABNAME,STABNAME,EDITTAB,SUMTAB);
                         DELETE EPLOC=ETABNAME  DELETE EDIT TABLE
                         DELETE EPLOC=STABNAME  DELETE SUM  TABLE
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
                         ST     R0,EDITTAB
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
                         ST     R0,SUMTAB
*                    END;                                  /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* IS A DETAIL PRINT OF EVERY RECORD WANTED. FORCE *
*                  /* DETAIL PRINT IF THRESHOLD SPECIFIED    @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                     RECCUA = OCUA2;                      /*@0001VLS*/
@RF00325 MVC   RECCUA(2),OCUA2(BUFFPTR)                            0331
*                     IF SHAREPTR ^= ZERO THEN                     0332
         L     @10,SHAREPTR(,R2)                                   0332
         LTR   @10,@10                                             0332
         BZ    @RF00332                                            0332
*                       CALL CUASHARE;                     /*@0001VLS*/
         BAL   @14,CUASHARE                                        0333
*                     SHRCUA = RECCUA;                     /*@0001VLS*/
@RF00332 MVC   SHRCUA(2,BUFFPTR),RECCUA                            0334
*                  IF PEDIT = ON THEN                              0335
         TM    PEDIT(R2),B'00010000'                               0335
         BNO   @RF00335                                            0335
*                    CALL OUTEDIT (HEXZERO);               /*@Z427VLS*/
         LA    @01,@AL00336                                        0336
         BAL   @14,OUTEDIT                                         0336
*                  /*                                        @Z427VLS*/
*                  /* THIS SECTION CONTROLS THE SUMMING OF RECORDS.   *
*                  /* THE COUNTERS ARE PROPERLY UPDATED.  IF THRESHOLD*
*                  /* IS SPECIFIED, A SUMMARY BY CUA IS FORCED.       *
*                  /*                                        @Z427VLS*/
*                  IF PSUM = ON THEN                               0337
@RF00335 TM    PSUM(R2),B'00001000'                                0337
         BNO   @RF00337                                            0337
*                    DO;                                   /*@Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      /* CHECK IF THIS RECORD DATE IS DIFFERENT THAN *
*                      /* THE PREVIOUS ONE. IF IT IS, CHAIN ANOTHER   *
*                      /* SUM AREA TO THE CURRENT AREA.  IF THE DATES *
*                      /* ARE THE SAME, THE RECORD IS SUMMED INTO THE *
*                      /* CURRENT AREA.  DO NOT BREAK FOR CUA         *
*                      /* THRESHOLD SUMMARY.                 @Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      IF (LASTDATE^=DATE & PARMTHR = OFF) ×       0339
*                    LASTCPU(1:3) ^= SAVECPU(1:3) ×                0339
*                    LASTCUA ^= SAVECUA THEN                       0339
         CLC   LASTDATE(4),DATE(BUFFPTR)                           0339
         BE    @GL00023                                            0339
         TM    PARMTHR(R2),B'00001000'                             0339
         BZ    @RT00339                                            0339
@GL00023 CLC   LASTCPU(3),SAVECPU                                  0339
         BNE   @RT00339                                            0339
         CLC   LASTCUA(3),SAVECUA                                  0339
         BE    @RF00339                                            0339
@RT00339 DS    0H                                                  0340
*                        CALL GETSPACE;                    /*@Z427VLS*/
         BAL   @14,GETSPACE                                        0340
*                     OCUA2 = RECCUA;                      /*@0001VLS*/
@RF00339 MVC   OCUA2(2,BUFFPTR),RECCUA                             0341
*                      CALL SUMIT;                         /*@Z427VLS*/
         BAL   @14,SUMIT                                           0342
*                    END;                                  /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* PLACE THE VOLID IN THE RECORD CONTROL TABLE FOR *
*                  /* NEXT SORT OF THE TABLE AND PROCESSING BY VOLID. *
*                  /*                                        @Z427VLS*/
*                  CONTRVOL = VOLID;                       /*@Z427VLS*/
@RF00337 MVC   CONTRVOL(6,CURRPTR),VOLID(BUFFPTR)                  0344
*                END;                                      /*@Z427VLS*/
*              ELSE                                                0346
*                CONTRVOL = CONTRVOL && CONTRVOL;          /*@Z427VLS*/
         B     @RC00320                                            0346
@RF00320 XC    CONTRVOL(6,CURRPTR),CONTRVOL(CURRPTR)               0346
*            END;                                          /*@Z427VLS*/
@RC00320 AL    CURRPTR,@CF00034                                    0347
@DE00314 CLC   EOTABLE(2,CURRPTR),@CB00260                         0347
         BNE   @DL00314                                            0347
*            IF PARMTHR = ON THEN         /* OUTPUT TRESH STATS AT END*
         TM    PARMTHR(R2),B'00001000'                             0348
         BNO   @RF00348                                            0348
*              CALL OUTEDIT (FOXFOX);                      /*@Z427VLS*/
         LA    @01,@AL00349                                        0349
         BAL   @14,OUTEDIT                                         0349
*            /*                                              @Z427VLS*/
*            /* WAS A SUMMARY REQUESTED. FORCE SUMMARY EDIT PRINTING  *
*            /* IF THRESHOLD IS SPECIFIED.                   @Z427VLS*/
*            /*                                              @Z427VLS*/
*            IF CNTAREA ^= ZERO THEN                               0350
@RF00348 L     @10,CNTAREA                                         0350
         LTR   @10,@10                                             0350
         BZ    @RF00350                                            0350
*              CALL OUTSUM;                 /* OUTPUT THE SUMMARY CTRS*
         BAL   @14,OUTSUM                                          0351
*            /*                                              @Z427VLS*/
*            /* SORT THE RECORDS BY VOLID AND PROCESS ALL THE MES     *
*            /* RECORDS BY VOLID.                            @Z427VLS*/
*            /*                                              @Z427VLS*/
*            GENERATE REFS(ETABNAME,STABNAME);             /*@Z427VLS*/
@RF00350 DS    0H                                                  0352
               DELETE EPLOC=ETABNAME DELETE EDIT TABLE
               DELETE EPLOC=STABNAME DELETE SUMMARY TABLE
*            CURRPTR = TABPTR;         /* GET ADDRESS FIRST TABLE ENT *
         L     CURRPTR,TABPTR                                      0353
*            REPTYPE = VOLREP;         /* MOVE 'VOL' TO EDIT AND      *
         MVC   REPTYPE(4),VOLREP                                   0354
*            SREPTYPE = VOLREP;        /* SUMMARY TABLE NAMES         *
         MVC   SREPTYPE(4),VOLREP                                  0355
*            SORTFLG = ON;             /* RESET SORT FLAG    @Z427VLS*/
         OI    SORTFLG,B'10000000'                                 0356
*            IF RECCOUNT > ONE THEN     /* INSURE > ONE REC  @ZA26586*/
         L     @10,RECCOUNT                                        0357
         C     @10,@CF00053                                        0357
         BNH   @RF00357                                            0357
*              DO;                                         /*@ZA26586*/
*                CALL SORT;                                /*@ZA26586*/
         BAL   @14,SORT                                            0359
*              END;                                        /*@ZA26586*/
*            GENERATE REFS(ETABNAME,EDITTAB,STABNAME,SUMTAB);      0361
@RF00357 DS    0H                                                  0361
         LOADEREP EPLOC=ETABNAME   LOAD EDIT TABLE
               ST   R0,EDITTAB       SAVE THE ENTRY POINT
         LOADEREP EPLOC=STABNAME   LOAD SUMMARY TABLE
               ST   R0,SUMTAB        SAVE THE ENTRY POINT
*            IF PARMTHR = ON THEN     /* FORCE NO VOL SUM IF THRESHOLD*
         TM    PARMTHR(R2),B'00001000'                             0362
         BNO   @RF00362                                            0362
*              PSUM = OFF;                                 /*@Z427VLS*/
         NI    PSUM(R2),B'11110111'                                0363
*            CUACPU = CUACPU && CUACPU;                    /*@Z427VLS*/
@RF00362 XC    CUACPU(8),CUACPU                                    0364
*            /*                                              @Z427VLS*/
*            /* PROCESS THE ENTRIES IN THE CONTROL TABLE.  AT THE END,*
*            /* PROCESS THE SUMMARY COUNTERS THAT HAVE BEEN BUILD.    *
*            /*                                              @Z427VLS*/
*            DO CURRPTR = CURRPTR BY 11 WHILE (EOTABLE ^= EOT);    0365
         B     @DE00365                                            0365
@DL00365 DS    0H                                                  0366
*              RECCCHHR = TABCCHHR;                        /*@Z427VLS*/
         MVC   RECCCHHR(5,R2),TABCCHHR(CURRPTR)                    0366
*              RESPECIFY (R15) RESTRICTED;                 /*@Z427VLS*/
*              CALL IOHND(READIRCT);                       /*@Z427VLS*/
         L     @15,ADIOHND(,R2)                                    0368
         LA    @01,@AL00368                                        0368
         BALR  @14,@15                                             0368
*              RETCODE = R15;                              /*@Z427VLS*/
         ST    R15,RETCODE                                         0369
*              RESPECIFY (R15) UNRESTRICTED;               /*@Z427VLS*/
*              IF RETCODE = ZERO THEN                              0371
         L     @10,RETCODE                                         0371
         LTR   @10,@10                                             0371
         BNZ   @RF00371                                            0371
*                DO;                                       /*@Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  /* BUILD A TABLE WITH THE DEVICE CODE AND VOLID.   *
*                  /* THE TABLE IS USED FOR PROCESSING THE RECORD.    *
*                  /*                                        @Z427VLS*/
*                  IF PARMTHR = OFF THEN                           0373
         TM    PARMTHR(R2),B'00001000'                             0373
         BNZ   @RF00373                                            0373
*                    CUACPU = VOLID;                       /*@Z427VLS*/
         MVI   CUACPU+6,C' '                                       0374
         MVI   CUACPU+7,C' '                                       0374
         MVC   CUACPU(6),VOLID(BUFFPTR)                            0374
*                  /*                                        @Z427VLS*/
*                  /* IS A DETAIL PRINT OF EVERY RECORD WANTED.       *
*                  /*                                        @Z427VLS*/
*                  IF PEDIT = ON THEN                              0375
@RF00373 TM    PEDIT(R2),B'00010000'                               0375
         BNO   @RF00375                                            0375
*                    CALL OUTEDIT (HEXZERO);               /*@Z427VLS*/
         LA    @01,@AL00376                                        0376
         BAL   @14,OUTEDIT                                         0376
*                  /*                                        @Z427VLS*/
*                  /* CHECK FOR SUMMARY REQUEST. ASSURE THAT SUMMARY  *
*                  /* COUNTERS ARE UPDATED PROPERLY.         @Z427VLS*/
*                  /*                                        @Z427VLS*/
*                  IF PSUM = ON THEN                               0377
@RF00375 TM    PSUM(R2),B'00001000'                                0377
         BNO   @RF00377                                            0377
*                    DO;                                   /*@Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      /* DETERMINE IF RECORD BEING PROCESSED SHOULD  *
*                      /* BE SUMMED WITH THE CURRENT COUNTERS OR IF A *
*                      /* NEW AREA IS NEEDED.                @Z427VLS*/
*                      /*                                    @Z427VLS*/
*                      IF SUMIDENT ^= CUACPU THEN                  0379
         L     @10,CURRCNTS                                        0379
         CLC   SUMIDENT(8,@10),CUACPU                              0379
         BE    @RF00379                                            0379
*                        CALL GETSPACE;                    /*@Z427VLS*/
         BAL   @14,GETSPACE                                        0380
*                      CALL SUMIT;                         /*@Z427VLS*/
@RF00379 BAL   @14,SUMIT                                           0381
*                    END;                                  /*@Z427VLS*/
*                END;                                      /*@Z427VLS*/
@RF00377 DS    0H                                                  0384
*            END;                                          /*@Z427VLS*/
@RF00371 AL    CURRPTR,@CF00034                                    0384
@DE00365 CLC   EOTABLE(2,CURRPTR),@CB00260                         0384
         BNE   @DL00365                                            0384
*            IF PARMTHR = ON THEN       /* OUTPUT THRESH STATS AT END *
         TM    PARMTHR(R2),B'00001000'                             0385
         BNO   @RF00385                                            0385
*              CALL OUTEDIT (FOXFOX);                      /*@Z427VLS*/
         LA    @01,@AL00386                                        0386
         BAL   @14,OUTEDIT                                         0386
*            IF CNTAREA ^= ZERO THEN    /* OUTPUT MES VOLUME SUMMARY  *
@RF00385 L     @10,CNTAREA                                         0387
         LTR   @10,@10                                             0387
         BZ    @RF00387                                            0387
*              CALL OUTSUM;                                /*@Z427VLS*/
         BAL   @14,OUTSUM                                          0388
*          END;                                            /*@Z427VLS*/
@RF00387 DS    0H                                                  0390
*    END;                /* END FOR GETMAIN FAILURE        @0001VLS   *
*     ELSE                                                         0391
*      DO;                                                 /*@GZZDGVS*/
         B     @RC00190                                            0391
@RF00190 DS    0H                                                  0392
*       CALL IFCMSG(55,ADDR(MSGADDR));  /* MESSAGE FOR GETMAIN FAIL  */
         LA    @10,MSGADDR                                         0392
         ST    @10,@AFTEMPS                                        0392
         L     @15,ADIFCMSG(,R2)                                   0392
         LA    @01,@AL00392                                        0392
         BALR  @14,@15                                             0392
*       PRINTADR = ADDR(MSGADDR);                          /*@0001VLS*/
         LA    @10,MSGADDR                                         0393
         ST    @10,PRINTADR(,R2)                                   0393
*       CALL IOHND(RITEPRTR);                              /*@0001VLS*/
         L     @15,ADIOHND(,R2)                                    0394
         LA    @01,@AL00394                                        0394
         BALR  @14,@15                                             0394
*      END;                                                /*@GZZDGVS*/
*        IF DEBUG12 = ON THEN           /* ABEND REQUESTED?  @Z427VLS*/
@RC00190 TM    DEBUG12(R2),B'00001000'                             0396
         BNO   @RF00396                                            0396
*          GEN(ABEND 540,DUMP);                            /*@Z427VLS*/
         ABEND 540,DUMP
*        RETURN;                                           /*@Z427VLS*/
@EL00001 L     @13,4(,@13)                                         0398
@EF00001 DS    0H                                                  0398
@ER00001 L     @14,12(,@13)                                        0398
         LM    @00,@12,20(@13)                                     0398
         BR    @14                                                 0398
* END                                                      /*@Z427VLS*/
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (COMTABLE)                                        *
*;                                                                 0399
         B     @EL00001                                            0399
@DATA    DS    0H
@CH00072 DC    H'2'
@CH00074 DC    H'3'
@CH00077 DC    H'5'
@CH00081 DC    H'7'
         DS    0F
@AL00185 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00268 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00281 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00394 DC    A(@CH00072)             LIST WITH   1 ARGUMENT(S)
@AL00197 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00259 DC    A(@CH00074)             LIST WITH   1 ARGUMENT(S)
@AL00236 DC    A(@CH00077)             LIST WITH   1 ARGUMENT(S)
@AL00266 DC    A(@CF00581)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00271 DC    A(@CF00641)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
@AL00301 DC    A(@CH00081)             LIST WITH   1 ARGUMENT(S)
@AL00317 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00368 DC    A(@CF00079+2)           LIST WITH   1 ARGUMENT(S)
@AL00327 DC    A(@CB00466)             LIST WITH   1 ARGUMENT(S)
@AL00336 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00376 DC    A(@CB00224)             LIST WITH   1 ARGUMENT(S)
@AL00349 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00386 DC    A(@CB00279)             LIST WITH   1 ARGUMENT(S)
@AL00392 DC    A(@CF00645)             LIST WITH   2 ARGUMENT(S)
         DC    A(@AFTEMPS)
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00004 DS    0F
@PC00004 EQU   @SA00004+60
         DS    16F
@TF00001 DS    F
@AFTEMPS DS    1F
         DS    0F
@CF00053 DC    F'1'
@CH00053 EQU   @CF00053+2
@CF00079 DC    F'6'
@CH00079 EQU   @CF00079+2
@CF00064 DC    F'8'
@CF00034 DC    F'11'
@CH00034 EQU   @CF00034+2
@CF00614 DC    F'22'
@CF00639 DC    F'27'
@CF00581 DC    F'53'
@CF00641 DC    F'54'
@CF00645 DC    F'55'
@CF00653 DC    F'-14'
@CF00657 DC    F'-13'
@CF00656 DC    F'-10'
@CF00654 DC    F'-6'
@CF00660 DC    F'-4'
@CF00655 DC    F'-3'
@CF00644 DC    XL4'FFFFF8'
@CV00543 DC    V(IFCEEDIT)
         DS    0D
EDITTAB  DS    F
SAVEPARM DS    F
CNTAREA  DC    A(0)
CURRCNTS DS    A
SUMTAB   DS    A
TABPTR   DS    A
RECCOUNT DC    F'0'
RETCODE  DS    F
FREESIZE DC    F'8192'
SRTCONT  DC    F'0'
SUMSPEC1 DS    A
I        DS    H
         DS    0D
@TS00001 DS    CL8
@CB00260 DC    X'FFFF'
@CB00224 DC    X'00'
@CB00279 EQU   @CB00260
@CB00466 DC    X'FE'
SUMCNTRL DS    CL10
         ORG   SUMCNTRL
CUACPU   DS    CL8
         ORG   CUACPU
SAVECUA  DS    CL3
SAVECPU  DS    CL5
         ORG   SUMCNTRL+8
SAVEDEV  DC    X'8003'
         ORG   SUMCNTRL+10
RECCPU   DC    CL3' '
RECCUA   DC    CL2' '
ETABNAME DS    CL8
         ORG   ETABNAME
@NM00013 DC    CL4'IFCE'
REPTYPE  DC    CL4'CUA0'
         ORG   ETABNAME+8
STABNAME DS    CL8
         ORG   STABNAME
@NM00014 DC    CL4'IFCS'
SREPTYPE DC    CL4'CUA0'
         ORG   STABNAME+8
LASTDATE DS    CL4
LASTCUA  DS    CL3
LASTCPU  DS    CL5
SWITCH   DC    X'80'
         ORG   SWITCH
SORTFLG  DS    BL1
VALIDSER EQU   SWITCH+0
VALIDCPU EQU   SWITCH+0
VALIDSHR EQU   SWITCH+0
VALIDCUA EQU   SWITCH+0
VALIDVOL EQU   SWITCH+0
         ORG   SWITCH+1
VOLREP   DC    CL4'VOL0'
MESSAGE  DS    CL134
         ORG   MESSAGE
@NM00027 DC    CL1'1'
@NM00028 DC    CL1' '
MSGADDR  DC    CL132' '
         ORG   MSGADDR
@NM00029 DS    CL8
NUMRECP  DS    CL7
         ORG   MESSAGE+134
@NM00030 DS    CL5
         ORG   @NM00030
SHR74XXX DS    CL5
         ORG   SHR74XXX
SHR74CUA DS    BL2
SHR74CPU DS    CL3
         ORG   @NM00030+5
LETTERS  DC    CL1'S'
SUPERZAP DC    3CL10'SUPERZAP'
PATCH    DC    20H'0'
IFCMES01 CSECT
         DC    S(SUPERZAP)
IFCMES01 CSECT
         DC    S(PATCH)
IFCMES01 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R7       EQU   @07
R9       EQU   @09
R12      EQU   @12
R15      EQU   @15
CURRPTR  EQU   @05
BUFFPTR  EQU   @07
R10      EQU   @10
R11      EQU   @11
R13      EQU   @13
R14      EQU   @14
R5       EQU   @05
R8       EQU   @08
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
PARMTHR  EQU   SWITCHES
SHIFT3RD EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUG4   EQU   DEBUG
DEBUG11  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUGA   EQU   PARM+8
MISC     EQU   PARM+12
PHIST    EQU   MISC
PRINTES  EQU   MISC
PEDIT    EQU   PRINTES
PSUM     EQU   PRINTES
PLOGREC  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
CSERLOG  EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
RDTHRSH  EQU   PARM+66
WRTHRSH  EQU   PARM+69
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
TABSIZE  EQU   PARM+80
SORTNUM  EQU   PARM+84
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHARENUM EQU   SHARE
SHAREIO  EQU   SHARE+2
SHAREFLG EQU   SHAREIO
SHRBASE  EQU   SHAREIO+1
SHARSERB EQU   SHRBASE
SHRCUABL EQU   SHRBASE+3
SHRCUCPU EQU   SHAREIO+8
SHARSERA EQU   SHRCUCPU
SHRCUAAL EQU   SHRCUCPU+3
SHRCUAAH EQU   SHRCUCPU+5
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUANUM   EQU   CUA
CUAVAL   EQU   CUA+2
CUA1     EQU   CUAVAL
CUA2     EQU   CUAVAL+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
SERNUM   EQU   DEVSERAL
SERVAL   EQU   DEVSERAL+2
VOLUME   EQU   0
VOLNUM   EQU   VOLUME
VOLVAL   EQU   VOLUME+2
CPUS     EQU   0
CPUNUM   EQU   CPUS
CPUVAL   EQU   CPUS+2
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
COUNTER  EQU   0
EDITCUA1 EQU   0
ERTHRE   EQU   EDITCUA1+20
EWTHRE   EQU   EDITCUA1+23
SUMTABLE EQU   0
SUMPTR   EQU   SUMTABLE
SUMEDIT  EQU   SUMTABLE+4
NEXTENT  EQU   SUMTABLE+8
CNTSIZE  EQU   SUMTABLE+12
SUMHEAD  EQU   0
NEXTTAB  EQU   SUMHEAD
SUMIDENT EQU   SUMHEAD+4
MODNAME  EQU   SUMHEAD+12
CURRDEV  EQU   SUMHEAD+20
COUNTERS EQU   SUMHEAD+22
SUMENTRY EQU   0
SUMFLAG  EQU   SUMENTRY
SUMMASK  EQU   SUMENTRY+1
OFFSET   EQU   SUMENTRY+2
SUMSPEC  EQU   OFFSET
CNTOFSET EQU   SUMENTRY+4
BUFFER   EQU   0
RECTYP   EQU   BUFFER
SWITCHE  EQU   BUFFER+2
SW2      EQU   SWITCHE+1
SHORT    EQU   SW2
SHRCUA   EQU   BUFFER+5
DATE     EQU   BUFFER+8
TIME     EQU   BUFFER+12
CPUIDENT EQU   BUFFER+17
CPUSER   EQU   CPUIDENT
ODEVICE  EQU   BUFFER+52
DEV2     EQU   ODEVICE+2
OCUA     EQU   BUFFER+57
OCUA2    EQU   OCUA+1
VOLID    EQU   BUFFER+64
OSER74XX EQU   BUFFER+123
CONTRTAB EQU   0
CONTRVOL EQU   CONTRTAB
CONTRCUA EQU   CONTRVOL
EOTABLE  EQU   CONTRCUA
CPU      EQU   CONTRVOL+3
TABCCHHR EQU   CONTRTAB+6
SUMMARY  EQU   0
THRSHRC  EQU   0
THRSHFLG EQU   THRSHRC+4
SPECIAL  EQU   0
RECFLAG  EQU   0
TABNBR   EQU   REPTYPE+3
STABNBR  EQU   SREPTYPE+3
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00031 EQU   THRSHRC
@NM00026 EQU   BUFFER+70
@NM00025 EQU   BUFFER+60
@NM00024 EQU   OCUA
@NM00023 EQU   BUFFER+56
@NM00022 EQU   ODEVICE
@NM00021 EQU   BUFFER+22
CPUMOD   EQU   CPUIDENT+3
@NM00020 EQU   BUFFER+16
@NM00019 EQU   BUFFER+7
@NM00018 EQU   BUFFER+4
@NM00017 EQU   SW2
@NM00016 EQU   SWITCHE
@NM00015 EQU   BUFFER+1
@NM00012 EQU   EDITCUA1
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+15
SHRCUABH EQU   SHRBASE+5
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
LINECT   EQU   PARM+120
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
ERRORID  EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG63  EQU   DEBUGA+3
DEBUG62  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG56  EQU   DEBUGA+3
DEBUG55  EQU   DEBUGA+2
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
COREFAIL EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00146 EQU   @RC00144
@PB00006 EQU   @PB00007
@RF00396 EQU   @EL00001
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IFCMES01

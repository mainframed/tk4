         TITLE 'DATA REDUCTION OF RANDOM ERRORS USING FSCS'
IFCNFPDR CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IFCNFPDR  79.011'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @11,4095(,@12)                                      0001
         LA    @10,4095(,@11)                                      0001
         LA    @09,4095(,@10)                                      0001
         LA    @08,4095(,@09)                                      0001
         LA    @03,4095(,@08)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@11                                    0001
         USING @PSTART+8190,@10                                    0001
         USING @PSTART+12285,@09                                   0001
         USING @PSTART+16380,@08                                   0001
         USING @PSTART+20475,@03                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*    SORTAT=R4;                      /* LOCATION OF THE START OF THE
*                                       SORT AREA                     *
         ST    R4,SORTAT                                           0138
*    DSORTAT=R4;                     /* SAVE FOR DEBUG AS SORTAT IS
*                                       CHANGED                       *
         ST    R4,DSORTAT                                          0139
*    NUMBER2=R7;                     /* NUMBER OF ENTRIES TO PROCCES  *
         STH   R7,NUMBER2                                          0140
*    RESPECIFY                                                     0141
*     (R7) UNRESTRICTED;                                           0141
*    CALL PRINTIT;                   /* BLANK LINE                    *
         BAL   @14,PRINTIT                                         0142
*    GEN(MVI  PRTLINE,X'5C');                                      0143
         MVI  PRTLINE,X'5C'
*    GEN(MVC  PRTLINE+1(78),PRTLINE);/* LINE OF ********              *
         MVC  PRTLINE+1(78),PRTLINE
*    CALL PRINTIT;                   /* PRINT THE LINE OF *****       *
         BAL   @14,PRINTIT                                         0145
*    CALL PRINTIT;                   /* BLANK LINE                    *
         BAL   @14,PRINTIT                                         0146
*    CALL FINDNUM;                   /* WILL SET UP ARRAYS ALLCOUNT &
*                                       EVDCOUNT                      *
         BAL   @14,FINDNUM                                         0147
*    CALL GETMAIN;                   /* GET CORE FOR SB TABLE BASED ON
*                                       CUA,GP                        *
         BAL   @14,GETMAIN                                         0148
*    IF DEBUG55=ON THEN              /* HEX DUMP THE SORT TABLE       *
         TM    DEBUG55(R2),B'00000001'                             0149
         BNO   @RF00149                                            0149
*      CALL DUMP2;                                                 0150
         BAL   @14,DUMP2                                           0150
*    IF COREFAIL=OFF&SWITCH2=OFF THEN/* CORE OBTAINED                 *
@RF00149 TM    COREFAIL(R2),B'00000100'                            0151
         BNZ   @RF00151                                            0151
         TM    SWITCH2,B'00010000'                                 0151
         BNZ   @RF00151                                            0151
*      DO;                                                         0152
*        IF NUMBER2>ONE THEN         /* DONT SORT IF ONLY ONE ENTRY   *
         LH    @05,NUMBER2                                         0153
         CH    @05,ONE                                             0153
         BNH   @RF00153                                            0153
*          DO;                                                     0154
*            CALL DOY2Y3;            /* GO START BUILDING THE EACS Y2
*                                       & Y3 ONLY                     *
         BAL   @14,DOY2Y3                                          0155
*            IF TOTALEVD>ONE THEN    /* DID WE FIND ANY RECORDS WITH
*                                       EVD ON                        *
         LH    @05,TOTALEVD                                        0156
         CH    @05,ONE                                             0156
         BNH   @RF00156                                            0156
*              CALL DOY2Y3;          /* GO BUILD Y2,Y3 FOR EVD RECORDS*
         BAL   @14,DOY2Y3                                          0157
*            CALL SORTCUA;           /* SORT BY CUA GROUP EVD BIT     *
@RF00156 BAL   @14,SORTCUA                                         0158
*          END;                                                    0159
*        NUMBER2=NUMBER2-NOGOOD      /* WILL LEAVE OUT MDR & INVALID
*                                       OBRS                          *
*            -HRDERROR;              /* LEAVE OUT HARDWARE ERRORS     *
@RF00153 LH    @05,NUMBER2                                         0160
         SH    @05,NOGOOD                                          0160
         SH    @05,HRDERROR                                        0160
         STH   @05,NUMBER2                                         0160
*       IF NUMBER2>ZERO THEN         /*IF ALL ARE NOT USED THEN QUIT  *
         LTR   @05,@05                                             0161
         BNP   @RF00161                                            0161
*        DO;                                                       0162
*        DO B=1 BY 1 TO 32;          /* MAKE MAIN GROUP COUNT CORRECT *
         LA    @05,1                                               0163
         STH   @05,B                                               0163
@DL00163 DS    0H                                                  0164
*          ALLCOUNT(B,6)=ALLCOUNT(B,6)+SPGROUP6(B);/* ADD NON 4949    *
         LR    @15,@05                                             0164
         MH    @15,@CH00033                                        0164
         LR    @14,@05                                             0164
         ALR   @14,@14                                             0164
         LH    @07,ALLCOUNT-2(@15)                                 0164
         AH    @07,SPGROUP6-2(@14)                                 0164
         STH   @07,ALLCOUNT-2(@15)                                 0164
*          EVDCOUNT(B,6)=EVDCOUNT(B,6)+EVDSPGP6(B);/* TO 4949 COUNTS  *
         LH    @07,EVDCOUNT-2(@15)                                 0165
         AH    @07,EVDSPGP6-2(@14)                                 0165
         STH   @07,EVDCOUNT-2(@15)                                 0165
*        END;                                                      0166
         AH    @05,@CH00057                                        0166
         STH   @05,B                                               0166
         CH    @05,@CH00895                                        0166
         BNH   @DL00163                                            0166
*        DO A=1 BY 1 TO 32;          /* ALWAYS ASSUME 32 CUA'S IN THE
*                                       DATA                          *
         LA    @05,1                                               0167
         STH   @05,A                                               0167
@DL00167 DS    0H                                                  0168
*          SWITCH4=OFF;              /* TURN DIVIDE OPTION OFF        *
         NI    SWITCH4,B'11111011'                                 0168
*          IF PRINTFLG=ON THEN       /* DO WE NEED A BLANK LINE    0169
*                                       BETWEEN CUA'S                 *
         TM    PRINTFLG,B'10000000'                                0169
         BNO   @RF00169                                            0169
*            DO;                                                   0170
*              CALL PRINTIT;         /* BLANK LINE                    *
         BAL   @14,PRINTIT                                         0171
*              PRINTFLG=OFF;         /* DONT SKIP UNTILL TOLD         *
         NI    PRINTFLG,B'01111111'                                0172
*            END;                                                  0173
*          IF ALLCOUNT(A,ONE)^=ZERO THEN                           0174
@RF00169 LH    @05,A                                               0174
         MH    @05,@CH00081                                        0174
         AH    @05,ONE                                             0174
         ALR   @05,@05                                             0174
         LH    @05,ALLCOUNT-14(@05)                                0174
         LTR   @05,@05                                             0174
         BZ    @RF00174                                            0174
*            CALL DODCI;             /* PROCESS GROUP1 RECORDS        *
         BAL   @14,DODCI                                           0175
*          IF ALLCOUNT(A,TWO)^=ZERO THEN                           0176
@RF00174 LH    @05,A                                               0176
         MH    @05,@CH00081                                        0176
         AH    @05,TWO                                             0176
         ALR   @05,@05                                             0176
         LH    @05,ALLCOUNT-14(@05)                                0176
         LTR   @05,@05                                             0176
         BZ    @RF00176                                            0176
*            CALL DOFCI;             /* PROCESS GROUP2 RECORDS        *
         BAL   @14,DOFCI                                           0177
*          IF ALLCOUNT(A,THREE)^=ZERO THEN                         0178
@RF00176 LH    @05,A                                               0178
         MH    @05,@CH00081                                        0178
         AH    @05,THREE                                           0178
         ALR   @05,@05                                             0178
         LH    @05,ALLCOUNT-14(@05)                                0178
         LTR   @05,@05                                             0178
         BZ    @RF00178                                            0178
*            DO;                                                   0179
*              SWITCH4=ON;           /* TELL READ TO DO DIVIDE        *
         OI    SWITCH4,B'00000100'                                 0180
*              CALL DOSV;            /* PROCESS GROUP3 RECORDS        *
         BAL   @14,DOSV                                            0181
*              IF EVDCOUNT(A,THREE)^=ZERO THEN/* ANY GROUP 3 EVD   0182
*                                       RECORDS                       *
         LH    @05,A                                               0182
         MH    @05,@CH00081                                        0182
         AH    @05,THREE                                           0182
         ALR   @05,@05                                             0182
         LH    @05,EVDCOUNT-14(@05)                                0182
         LTR   @05,@05                                             0182
         BZ    @RF00182                                            0182
*                DO;                                               0183
*                  CALL SORTCUA1;    /* PUT THING BACK IN ORDER       *
         BAL   @14,SORTCUA1                                        0184
*                  SWITCH3=ON;       /* SET FLAG TO MOVE AN E AFTER
*                                       GROUP TYPE                    *
         OI    SWITCH3,B'00001000'                                 0185
*                  CALL DOSV;        /* DO GROUP 3 EVD RECORDS        *
         BAL   @14,DOSV                                            0186
*                END;                                              0187
*            END;                                                  0188
@RF00182 DS    0H                                                  0189
*          IF ALLCOUNT(A,FOUR1)^=ZERO THEN/* ANY GROUP 4 RECORDS      *
@RF00178 LH    @05,A                                               0189
         MH    @05,@CH00081                                        0189
         AH    @05,FOUR1                                           0189
         ALR   @05,@05                                             0189
         LH    @05,ALLCOUNT-14(@05)                                0189
         LTR   @05,@05                                             0189
         BZ    @RF00189                                            0189
*            DO;                                                   0190
*              SWITCH4=ON;           /* SET FLAG TO DO THE DIVIDE     *
         OI    SWITCH4,B'00000100'                                 0191
*              CALL DOSC;            /* PROCESS GROUP4 RECORDS        *
         BAL   @14,DOSC                                            0192
*              IF EVDCOUNT(A,FOUR)^=ZERO THEN/* ANY GROUP4 EVD RECORDS*
         LH    @05,A                                               0193
         MH    @05,@CH00033                                        0193
         LH    @05,EVDCOUNT-6(@05)                                 0193
         LTR   @05,@05                                             0193
         BZ    @RF00193                                            0193
*                DO;                                               0194
*                  CALL SORTCUA1;    /* PUT THING BACK IN ORDER       *
         BAL   @14,SORTCUA1                                        0195
*                  SWITCH3=ON;       /* SET FLAG TO MOVE AN E AFTER
*                                       GROUP TYPE                    *
         OI    SWITCH3,B'00001000'                                 0196
*                  CALL DOSC;        /* DO GROUP 4 RECORDS            *
         BAL   @14,DOSC                                            0197
*                END;                                              0198
*            END;                                                  0199
@RF00193 DS    0H                                                  0200
*          IF ALLCOUNT(A,FIVE)^=ZERO THEN/* ANY GROUP 5 RECORDS       *
@RF00189 LH    @05,A                                               0200
         MH    @05,@CH00081                                        0200
         AH    @05,FIVE                                            0200
         ALR   @05,@05                                             0200
         LH    @05,ALLCOUNT-14(@05)                                0200
         LTR   @05,@05                                             0200
         BZ    @RF00200                                            0200
*            DO;                                                   0201
*              SWITCH4=ON;           /* SET FLAG TO DO THE DIVIDE     *
         OI    SWITCH4,B'00000100'                                 0202
*              CALL DORW;            /* PROCESS GROUP5 RECORDS        *
         BAL   @14,DORW                                            0203
*            END;                                                  0204
*          IF ALLCOUNT(A,SIX)^=ZERO THEN/* ANY GROUP 6 RECORDS        *
@RF00200 LH    @05,A                                               0205
         MH    @05,@CH00081                                        0205
         AH    @05,SIX                                             0205
         ALR   @05,@05                                             0205
         LH    @05,ALLCOUNT-14(@05)                                0205
         LTR   @05,@05                                             0205
         BZ    @RF00205                                            0205
*            DO;                                                   0206
*              SWITCH4=ON;           /* SET FLAG TO DO THE DIVIDE     *
         OI    SWITCH4,B'00000100'                                 0207
*              CALL DODC;            /* DO ALL GROUP 6 RECORDS        *
         BAL   @14,DODC                                            0208
*              IF EVDCOUNT(A,SIX)^=ZERO THEN/* ANY GROUP 6 EVD RECORDS*
         LH    @05,A                                               0209
         MH    @05,@CH00081                                        0209
         AH    @05,SIX                                             0209
         ALR   @05,@05                                             0209
         LH    @05,EVDCOUNT-14(@05)                                0209
         LTR   @05,@05                                             0209
         BZ    @RF00209                                            0209
*                DO;                                               0210
*                  CALL SORTCUA1;    /* PUT THING BACK IN ORDER       *
         BAL   @14,SORTCUA1                                        0211
*                  SWITCH3=ON;       /* SET FLAG TO MOVE AN E AFTER
*                                       GROUP TYPE                    *
         OI    SWITCH3,B'00001000'                                 0212
*                  CALL DODC;        /* DO ONLY GROUP 6 EVD RECORDS   *
         BAL   @14,DODC                                            0213
*                END;                                              0214
*            END;                                                  0215
@RF00209 DS    0H                                                  0216
*        END;                                                      0216
@RF00205 LA    @05,1                                               0216
         AH    @05,A                                               0216
         STH   @05,A                                               0216
         CH    @05,@CH00895                                        0216
         BNH   @DL00167                                            0216
*      END;                                                        0217
*     END;                                                         0218
@RF00161 DS    0H                                                  0219
*    CALL ERRORMSG;                  /*PRINT THE ERROR MESSAGES(IF ANY*
@RF00151 BAL   @14,ERRORMSG                                        0219
*    PRINTDS = 'F1'X;                /*CHANGE THE OUTPUT DATA SET*/
         MVI   PRINTDS,X'F1'                                       0220
*    CALL ERRORMSG;                  /*PRINT THE ERRORS ON TOURIST*/
         BAL   @14,ERRORMSG                                        0221
*    IF DEBUG60=ON THEN              /* USER REQUEST AN ABEND HAVE 0222
*                                       PROCESSED 1 CUX               *
         TM    DEBUG60(R2),B'00001000'                             0222
         BNO   @RF00222                                            0222
*      GEN(ABEND  777,DUMP);                                       0223
         ABEND  777,DUMP
*    IF COREFAIL=OFF&SWITCH2=OFF THEN/* CORE WAS OBTAINED FOR SB      *
@RF00222 TM    COREFAIL(R2),B'00000100'                            0224
         BNZ   @RF00224                                            0224
         TM    SWITCH2,B'00010000'                                 0224
         BNZ   @RF00224                                            0224
*      DO;                           /* OBTAINED CORE AND HAD VALID
*                                       SAMPLES                       *
*        RESPECIFY                                                 0226
*         (R0,                                                     0226
*          R1) RESTRICTED;                                         0226
*        R1=SENSEPTR;                /* POINTER TO GETMAINED AREA     *
         L     R1,SENSEPTR                                         0227
*        R0=TEMPSP*LENGTH(ALLSENSE); /* # BYTES GOTTEN BY GETMAIN     *
         LH    R0,TEMPSP                                           0228
         MH    R0,@CH00042                                         0228
*        RESPECIFY                                                 0229
*         (R0,                                                     0229
*          R1) UNRESTRICTED;                                       0229
*        GEN(FREEMAIN R,LV=(0),A=(1));/* RELEASE THE SB TABLE         *
         FREEMAIN R,LV=(0),A=(1)
*      END;                                                        0231
* /********************************************************************
* /*                          FINDNUM                                 *
* /*      THIS PROC WILL COUNT THE CUA'S BY GROUP,CUA CUA WITH EVD ON *
* /*      THIS PROC SERVES THE FUNCTION OF COUNTING ALL ITEMS THAT    *
* /*      REQUIRE THE FULL GROUP NOT THE CUA,GROUP BREAKDOWN          *
* /*  NOTE:  FOR GROUP 6 ALL OF THE FSC'S ARE NOT USED TO DETERMINE   *
* /*         THE EAC THIS REQIRES A SEPARATE TABLE FOR THESE COUNTS   *
*FINDNUM:                                                          0232
*    PROC;                                                         0232
@EL00001 L     @13,4(,@13)                                         0232
@EF00001 DS    0H                                                  0232
@ER00001 L     @14,12(,@13)                                        0232
         LM    @00,@12,20(@13)                                     0232
         BR    @14                                                 0232
FINDNUM  STM   @14,@12,@SA00002                                    0232
*    DO B=1 BY 1 TO NUMBER2;         /* PROCESS ALL SENT BY EDSUM     *
         LA    @05,1                                               0233
         STH   @05,B                                               0233
         B     @DE00233                                            0233
@DL00233 DS    0H                                                  0234
*      R4=GROUP(B);                  /* SET UP THE GROUP INDEX        *
         L     @15,SORTAT                                          0234
         MH    @05,@CH00034                                        0234
         LA    @01,0(@05,@15)                                      0234
         AL    @01,@CF01857                                        0234
         SLR   R4,R4                                               0234
         IC    R4,GROUP-2(,@01)                                    0234
*      R33=(CUA3(B)&'001F'X)+ONE;    /* SET UP THE CUA INDEX          *
         LH    @14,ONE                                             0235
         LA    @07,31                                              0235
         ST    @05,@TF00001                                        0235
         ALR   @05,@15                                             0235
         AL    @05,@CF01858                                        0235
         MVC   @ZT00002+2(2),CUA3(@05)                             0235
         N     @07,@ZT00002                                        0235
         ALR   @07,@14                                             0235
         STH   @07,R33                                             0235
*      IF EQUAL(B)=OFF & (R4 >0 & R4<7) THEN                       0236
         LR    @05,@15                                             0236
         AL    @05,@TF00001                                        0236
         AL    @05,@CF01859                                        0236
         TM    EQUAL-3(@05),B'00100000'                            0236
         BNZ   @RF00236                                            0236
         LTR   R4,R4                                               0236
         BNP   @RF00236                                            0236
         CH    R4,@CH00083                                         0236
         BNL   @RF00236                                            0236
*        DO;                         /* YES USE THIS ENTRY            *
*          GRPCNT1(R4)=GRPCNT1(R4)+ONE;/* COUNT OF VALID SAMPLES      *
         L     @05,GPPOINT                                         0238
         LR    @06,R4                                              0238
         ALR   @06,@06                                             0238
         LA    @01,0(@06,@05)                                      0238
         BCTR  @01,0                                               0238
         BCTR  @01,0                                               0238
         LH    @01,GRPCNT1(,@01)                                   0238
         ALR   @01,@14                                             0238
         BCTR  @05,0                                               0238
         BCTR  @05,0                                               0238
         STH   @01,GRPCNT1(@06,@05)                                0238
*          ALLCOUNT(R33,R4)=ALLCOUNT(R33,R4)+ONE;                  0239
*                                                                  0239
         LR    @05,@07                                             0239
         MH    @05,@CH00081                                        0239
         ALR   @05,R4                                              0239
         ALR   @05,@05                                             0239
         LH    @06,ALLCOUNT-14(@05)                                0239
         ALR   @06,@14                                             0239
         STH   @06,ALLCOUNT-14(@05)                                0239
*          IF R4=ONE THEN            /* DO GROUP 1                    *
         CR    R4,@14                                              0240
         BNE   @RF00240                                            0240
*            DO;                                                   0241
*              TEMPSV1=STRINGS(R33); /* STRING THIS BELONGS IN        *
         SLR   @05,@05                                             0242
         IC    @05,STRINGS-1(@07)                                  0242
         STH   @05,TEMPSV1                                         0242
*              IF FSC1(B)='93'X×FSC1(B)='9A'X THEN                 0243
         LR    @05,@15                                             0243
         AL    @05,@TF00001                                        0243
         AL    @05,@CF01860                                        0243
         CLI   FSC1-4(@05),X'93'                                   0243
         BE    @RT00243                                            0243
         AL    @15,@TF00001                                        0243
         AL    @15,@CF01860                                        0243
         CLI   FSC1-4(@15),X'9A'                                   0243
         BNE   @RF00243                                            0243
@RT00243 DS    0H                                                  0244
*                BYTE='4000'X;                                     0244
         MVC   BYTE(2),@CB01574                                    0244
*              ELSE                                                0245
*                BYTE='8000'X;                                     0245
         B     @RC00243                                            0245
@RF00243 MVC   BYTE(2),@CB00198                                    0245
*              IF TEMPSV1^=1 THEN    /* DONT USE IF IN 1 STRING       *
@RC00243 LA    @05,1                                               0246
         CH    @05,TEMPSV1                                         0246
         BE    @RF00246                                            0246
*                DO E=1 BY 1 TO EIGHT;                             0247
         STH   @05,E                                               0247
@DL00247 DS    0H                                                  0248
*                  MAINMDC(E,1)=(MAINMDC(E,1)×BYTE);               0248
         LR    @15,@05                                             0248
         MH    @15,@CH00033                                        0248
         LA    @14,MAINMDC-12(@15)                                 0248
         OC    0(2,@14),BYTE                                       0248
*                END;                                              0249
         AH    @05,@CH00057                                        0249
         STH   @05,E                                               0249
         CH    @05,@CH00037                                        0249
         BNH   @DL00247                                            0249
*              IF TEMPSV1^=9 THEN    /* IF IN THIS GROUP DONT USE     *
@RF00246 LA    @05,9                                               0250
         CH    @05,TEMPSV1                                         0250
         BE    @RF00250                                            0250
*                DO E=9 BY 1 TO T16; /* SET THE FSC FOR THIS STRING   *
         STH   @05,E                                               0251
         B     @DE00251                                            0251
@DL00251 DS    0H                                                  0252
*                  MAINMDC(E,1)=(MAINMDC(E,1)×BYTE);               0252
         LR    @15,@05                                             0252
         MH    @15,@CH00033                                        0252
         LA    @14,MAINMDC-12(@15)                                 0252
         OC    0(2,@14),BYTE                                       0252
*                END;                                              0253
         AH    @05,@CH00057                                        0253
         STH   @05,E                                               0253
@DE00251 CH    @05,T16                                             0253
         BNH   @DL00251                                            0253
*              IF TEMPSV1^=17 THEN   /* DONT PROCESS 3RD STRING       *
@RF00250 LA    @05,17                                              0254
         CH    @05,TEMPSV1                                         0254
         BE    @RF00254                                            0254
*                DO E=17 BY 1 TO T24;                              0255
         STH   @05,E                                               0255
         B     @DE00255                                            0255
@DL00255 DS    0H                                                  0256
*                  MAINMDC(E,1)=(MAINMDC(E,1)×BYTE);               0256
         LR    @15,@05                                             0256
         MH    @15,@CH00033                                        0256
         LA    @14,MAINMDC-12(@15)                                 0256
         OC    0(2,@14),BYTE                                       0256
*                END;                                              0257
         AH    @05,@CH00057                                        0257
         STH   @05,E                                               0257
@DE00255 CH    @05,T24                                             0257
         BNH   @DL00255                                            0257
*              IF TEMPSV1^=25 THEN   /* DONT PROCESS 4TH STRING       *
@RF00254 LA    @05,25                                              0258
         CH    @05,TEMPSV1                                         0258
         BE    @RF00258                                            0258
*                DO E=25 BY 1 TO T32;                              0259
         STH   @05,E                                               0259
         B     @DE00259                                            0259
@DL00259 DS    0H                                                  0260
*                  MAINMDC(E,1)=(MAINMDC(E,1)×BYTE);               0260
         LR    @15,@05                                             0260
         MH    @15,@CH00033                                        0260
         LA    @14,MAINMDC-12(@15)                                 0260
         OC    0(2,@14),BYTE                                       0260
*                END;                                              0261
         AH    @05,@CH00057                                        0261
         STH   @05,E                                               0261
@DE00259 CH    @05,T32                                             0261
         BNH   @DL00259                                            0261
*            END;                                                  0262
*          ELSE                                                    0263
*            IF R4=THREE THEN        /* DO GROUP 3                    *
         B     @RC00240                                            0263
@RF00240 CH    R4,THREE                                            0263
         BNE   @RF00263                                            0263
*              DO;                                                 0264
*                ALLCOUNT(R33,4)=ALLCOUNT(R33,4)+ONE;/* MUST UPDATE 4 *
*                                                                  0265
         LH    @05,R33                                             0265
         MH    @05,@CH00033                                        0265
         LH    @15,ONE                                             0265
         LH    @14,ALLCOUNT-6(@05)                                 0265
         ALR   @14,@15                                             0265
         STH   @14,ALLCOUNT-6(@05)                                 0265
*                IF EVD(B)=ON THEN   /* GROUP 3 EVD RECORD            *
         LH    @14,B                                               0266
         MH    @14,@CH00034                                        0266
         L     @01,SORTAT                                          0266
         ALR   @01,@14                                             0266
         AL    @01,@CF01859                                        0266
         TM    EVD-3(@01),B'10000000'                              0266
         BNO   @RF00266                                            0266
*                  DO;                                             0267
*                    EVDGROUP(3)=EVDGROUP(3)+ONE;/* 1 TO EVD COUNT    *
         SLR   @14,@14                                             0268
         IC    @14,EVDGROUP+2                                      0268
         ALR   @14,@15                                             0268
         STC   @14,EVDGROUP+2                                      0268
*                    EVDGROUP(4)=EVDGROUP(4)+1;/* 1 TO EVD GROUP4     *
         LA    @14,1                                               0269
         SLR   @07,@07                                             0269
         IC    @07,EVDGROUP+3                                      0269
         ALR   @07,@14                                             0269
         STC   @07,EVDGROUP+3                                      0269
*                    GRPCNT2(3)=GRPCNT2(3)+1;/* 1 TO EVD GROUP3       *
         L     @07,GPPOINT1                                        0270
         AH    @14,GRPCNT2+4(,@07)                                 0270
         STH   @14,GRPCNT2+4(,@07)                                 0270
*                    EVDCOUNT(R33,4)=EVDCOUNT(R33,4)+ONE;          0271
         LH    @14,EVDCOUNT-6(@05)                                 0271
         ALR   @14,@15                                             0271
         STH   @14,EVDCOUNT-6(@05)                                 0271
*                    EVDCOUNT(R33,3)=EVDCOUNT(R33,3)+ONE;          0272
         LH    @14,EVDCOUNT-8(@05)                                 0272
         ALR   @14,@15                                             0272
         STH   @14,EVDCOUNT-8(@05)                                 0272
*                    TOTALEVD=TOTALEVD+ONE;/* # OF EVD RECORDS        *
         AH    @15,TOTALEVD                                        0273
         STH   @15,TOTALEVD                                        0273
*                  END;                                            0274
*              END;                                                0275
*            ELSE                                                  0276
*              IF R4=FOUR&EVD(B)=ON THEN/* GRP4 & EVD BIT ON          *
         B     @RC00263                                            0276
@RF00263 CH    R4,@CH00066                                         0276
         BNE   @RF00276                                            0276
         LH    @05,B                                               0276
         MH    @05,@CH00034                                        0276
         L     @01,SORTAT                                          0276
         ALR   @01,@05                                             0276
         AL    @01,@CF01859                                        0276
         TM    EVD-3(@01),B'10000000'                              0276
         BNO   @RF00276                                            0276
*                DO;                                               0277
*                  EVDCOUNT(R33,4)=EVDCOUNT(R33,4)+ONE;            0278
         LH    @05,R33                                             0278
         MH    @05,@CH00033                                        0278
         LH    @15,ONE                                             0278
         LH    @14,EVDCOUNT-6(@05)                                 0278
         ALR   @14,@15                                             0278
         STH   @14,EVDCOUNT-6(@05)                                 0278
*                  GRPCNT2(4)=GRPCNT2(4)+1;/* GROUP COUNT             *
         L     @05,GPPOINT1                                        0279
         LA    @14,1                                               0279
         LH    @07,GRPCNT2+6(,@05)                                 0279
         ALR   @07,@14                                             0279
         STH   @07,GRPCNT2+6(,@05)                                 0279
*                  EVDGROUP(4)=EVDGROUP(4)+1;/* EVD COUNT             *
         MVC   @ZT00003+3(1),EVDGROUP+3                            0280
         AL    @14,@ZT00003                                        0280
         STC   @14,EVDGROUP+3                                      0280
*                  TOTALEVD=TOTALEVD+ONE;/* TOTAL EVD COUNT           *
         AH    @15,TOTALEVD                                        0281
         STH   @15,TOTALEVD                                        0281
*                END;                                              0282
*              ELSE                                                0283
*                IF R4=SIX THEN      /* GROUP 6                       *
         B     @RC00276                                            0283
@RF00276 CH    R4,SIX                                              0283
         BNE   @RF00283                                            0283
*                  DO;                                             0284
*                    IF EVD(B)=ON THEN/* ENVIORMENTAL BIT ON          *
         L     @05,SORTAT                                          0285
         LH    @15,B                                               0285
         MH    @15,@CH00034                                        0285
         ST    @15,@TF00001                                        0285
         ALR   @15,@05                                             0285
         AL    @15,@CF01859                                        0285
         TM    EVD-3(@15),B'10000000'                              0285
         BNO   @RF00285                                            0285
*                      DO;                                         0286
*                        EVDGROUP(6)=EVDGROUP(6)+1;/* EVD GROUP CT    *
         LA    @15,1                                               0287
         SLR   @14,@14                                             0287
         IC    @14,EVDGROUP+5                                      0287
         ALR   @14,@15                                             0287
         STC   @14,EVDGROUP+5                                      0287
*                        GRPCNT2(6)=GRPCNT2(6)+1;/* GROUP 6 COUNT     *
         L     @14,GPPOINT1                                        0288
         AH    @15,GRPCNT2+10(,@14)                                0288
         STH   @15,GRPCNT2+10(,@14)                                0288
*                        IF FORMAT4(B)=ON THEN                     0289
         AL    @05,@TF00001                                        0289
         AL    @05,@CF01859                                        0289
         TM    FORMAT4-3(@05),B'00010000'                          0289
         BNO   @RF00289                                            0289
*                          EVDCOUNT(R33,6)=EVDCOUNT(R33,6)+ONE;    0290
         LH    @05,R33                                             0290
         MH    @05,@CH00033                                        0290
         LH    @15,EVDCOUNT-2(@05)                                 0290
         AH    @15,ONE                                             0290
         STH   @15,EVDCOUNT-2(@05)                                 0290
*                        ELSE                                      0291
*                          EVDSPGP6(R33)=EVDSPGP6(R33)+1;          0291
         B     @RC00289                                            0291
@RF00289 LH    @05,R33                                             0291
         ALR   @05,@05                                             0291
         LA    @15,1                                               0291
         AH    @15,EVDSPGP6-2(@05)                                 0291
         STH   @15,EVDSPGP6-2(@05)                                 0291
*                        TOTALEVD=TOTALEVD+ONE;/* TOTAL EVD COUNT     *
@RC00289 LH    @05,TOTALEVD                                        0292
         AH    @05,ONE                                             0292
         STH   @05,TOTALEVD                                        0292
*                      END;                                        0293
*                    IF FORMAT4(B)=OFF THEN/* ^=FSC OF 494X           *
@RF00285 LH    @05,B                                               0294
         MH    @05,@CH00034                                        0294
         L     @01,SORTAT                                          0294
         ALR   @01,@05                                             0294
         AL    @01,@CF01859                                        0294
         TM    FORMAT4-3(@01),B'00010000'                          0294
         BNZ   @RF00294                                            0294
*                      DO;           /* WILL HAVE TO SUBTRACT 1 FOR
*                                       DOY2Y3 PROC                   *
*                        ALLCOUNT(R33,6)=ALLCOUNT(R33,6)-ONE;      0296
         LH    @05,R33                                             0296
         LR    @15,@05                                             0296
         MH    @15,@CH00033                                        0296
         LH    @14,ONE                                             0296
         LH    @07,ALLCOUNT-2(@15)                                 0296
         SLR   @07,@14                                             0296
         STH   @07,ALLCOUNT-2(@15)                                 0296
*                        SPGROUP6(R33)=SPGROUP6(R33)+ONE;          0297
         ALR   @05,@05                                             0297
         AH    @14,SPGROUP6-2(@05)                                 0297
         STH   @14,SPGROUP6-2(@05)                                 0297
*                      END;                                        0298
*                  END;                                            0299
*        END;                                                      0300
*      ELSE                                                        0301
*        DO;                                                       0301
         B     @RC00236                                            0301
@RF00236 DS    0H                                                  0302
*          IF EQUAL(B) = ON THEN                                   0302
         LH    @05,B                                               0302
         MH    @05,@CH00034                                        0302
         L     @01,SORTAT                                          0302
         ALR   @01,@05                                             0302
         AL    @01,@CF01859                                        0302
         TM    EQUAL-3(@01),B'00100000'                            0302
         BNO   @RF00302                                            0302
*            HRDERROR=HRDERROR+1;    /* HARDWARE ERROR                *
         LH    @05,HRDERROR                                        0303
         LA    @05,1(,@05)                                         0303
         STH   @05,HRDERROR                                        0303
*          ELSE                                                    0304
*            NOGOOD=NOGOOD+1;        /* BAD RECORD COUNT              *
         B     @RC00302                                            0304
@RF00302 LH    @05,NOGOOD                                          0304
         LA    @05,1(,@05)                                         0304
         STH   @05,NOGOOD                                          0304
*          KEEPCUA = CUA3(B);       /*SAVE FOR THE MESSAGE           */
@RC00302 L     @05,SORTAT                                          0305
         LH    @15,B                                               0305
         MH    @15,@CH00034                                        0305
         ST    @15,@TF00001                                        0305
         ALR   @15,@05                                             0305
         AL    @15,@CF01858                                        0305
         MVC   KEEPCUA(2),CUA3(@15)                                0305
*          CUA3(B)='7FFF'X;          /* WILL BE SORTED TO BOTTOM      *
         AL    @05,@TF00001                                        0306
         AL    @05,@CF01858                                        0306
         MVC   CUA3(2,@05),@CB01575                                0306
*        END;                                                      0307
*    END;                                                          0308
@RC00236 LA    @05,1                                               0308
         AH    @05,B                                               0308
         STH   @05,B                                               0308
@DE00233 CH    @05,NUMBER2                                         0308
         BNH   @DL00233                                            0308
*    IF DEBUG56=ON THEN              /* HEX DUMP TABLES JUST BUILT    *
         TM    DEBUG56(R2),B'10000000'                             0309
         BNO   @RF00309                                            0309
*      CALL BUGOUT;                                                0310
         BAL   @14,BUGOUT                                          0310
*    END FINDNUM;                                                  0311
@EL00002 DS    0H                                                  0311
@EF00002 DS    0H                                                  0311
@ER00002 LM    @14,@12,@SA00002                                    0311
         BR    @14                                                 0311
* /********************************************************************
* /*                          GETMAIN                                 *
* /*    THIS PROC WILL DETERMINE THE CUA WITH THE LARGEST NUMBER OF   *
* /*    ENTRIES AND DO A GETMAIN FOR THIS NUMBER * SIZE OF THE SB TABL*
*GETMAIN:                                                          0312
*    PROC;                                                         0312
GETMAIN  STM   @14,@12,@SA00003                                    0312
*    DO R33=1 BY 1 TO 32;            /* PROCESS 32 CUA'S              *
         LA    @05,1                                               0313
         STH   @05,R33                                             0313
@DL00313 DS    0H                                                  0314
*      DO R4=1 BY 1 TO 6;            /* PROCESS 6 GROUPS              *
         LA    R4,1                                                0314
@DL00314 DS    0H                                                  0315
*        IF ALLCOUNT(R33,R4)>TEMPSP THEN/* FIND THE ENTRY WITH > #    *
         LH    @05,R33                                             0315
         MH    @05,@CH00081                                        0315
         ALR   @05,R4                                              0315
         ALR   @05,@05                                             0315
         LH    @05,ALLCOUNT-14(@05)                                0315
         CH    @05,TEMPSP                                          0315
         BNH   @RF00315                                            0315
*          TEMPSP=ALLCOUNT(R33,R4);  /* SAVE IF LARGER                *
         STH   @05,TEMPSP                                          0316
*      END;                                                        0317
@RF00315 AH    R4,@CH00057                                         0317
         CH    R4,@CH00081                                         0317
         BNH   @DL00314                                            0317
*      IF SPGROUP6(R33)>TEMPSP THEN  /* CHECK SPECIAL GRP6 TABLE      *
         LH    @05,R33                                             0318
         ALR   @05,@05                                             0318
         LH    @05,SPGROUP6-2(@05)                                 0318
         CH    @05,TEMPSP                                          0318
         BNH   @RF00318                                            0318
*        TEMPSP=SPGROUP6(R33);       /* ONLY NEED TO CHECK THIS    0319
*                                       SPECIAL GRP6                  *
         STH   @05,TEMPSP                                          0319
*    END;                                                          0320
@RF00318 LA    @05,1                                               0320
         AH    @05,R33                                             0320
         STH   @05,R33                                             0320
         CH    @05,@CH00895                                        0320
         BNH   @DL00313                                            0320
*    IF TEMPSP^=ZERO THEN            /* DID WE FIND ANY VALID ENTRIES *
         LH    @05,TEMPSP                                          0321
         LTR   @05,@05                                             0321
         BZ    @RF00321                                            0321
*      DO;                                                         0322
*        SAVEIN=TEMPSP;              /* THIS WILL CAUSE THE GETMAIN
*                                       AREA TO BE CLEARED UPON THE
*                                       FIRST CALL TO READREC         *
         STH   @05,SAVEIN                                          0323
*        RESPECIFY                                                 0324
*         (R15,                                                    0324
*          R0) RESTRICTED;                                         0324
*        R0=TEMPSP*LENGTH(ALLSENSE); /* DETERMINE # BYTES NEEDED      *
         MH    @05,@CH00042                                        0325
         LR    R0,@05                                              0325
*        GEN(GETMAIN EC,LV=(R0),A=SENSEPTR);                       0326
         GETMAIN EC,LV=(R0),A=SENSEPTR
*        IF R15^=ZERO THEN           /* WAS GETMAIN OK                *
         LTR   R15,R15                                             0327
         BZ    @RF00327                                            0327
*          DO;                                                     0328
*            CALL IFCMSG(109,PRT9);  /* IFC153I OBTAIN ERROR MESSAGE  *
         L     @15,ADIFCMSG(,R2)                                   0329
         LA    @01,@AL00329                                        0329
         BALR  @14,@15                                             0329
*            CALL PRINTIT;           /* PRINT GETMAIN FAIL MESSAGE    *
         BAL   @14,PRINTIT                                         0330
*            COREFAIL=ON;            /* SET COMM TABLE ITEM ON        *
         OI    COREFAIL(R2),B'00000100'                            0331
*          END;                                                    0332
*        RESPECIFY                                                 0333
*         (R15,                                                    0333
*          R0) UNRESTRICTED;                                       0333
@RF00327 DS    0H                                                  0334
*      END;                                                        0334
*    ELSE                                                          0335
*      SWITCH2=ON;                   /* SHUT DOWN IFCNFPDR ONLY       *
         B     @RC00321                                            0335
@RF00321 OI    SWITCH2,B'00010000'                                 0335
*    END GETMAIN;                                                  0336
@EL00003 DS    0H                                                  0336
@EF00003 DS    0H                                                  0336
@ER00003 LM    @14,@12,@SA00003                                    0336
         BR    @14                                                 0336
* /********************************************************************
* /*                        SORTCUA                                   *
* /*    THIS PROC WILL SORT THE TABLE BY CUA, GROUP, EVD BIT          *
*SORTCUA:                                                          0337
*    PROC;                                                         0337
SORTCUA  STM   @14,@12,12(@13)                                     0337
*    DO C=1 BY 1 TO NUMBER2-1;                                     0338
         LA    @05,1                                               0338
         STH   @05,C                                               0338
         B     @DE00338                                            0338
@DL00338 DS    0H                                                  0339
*      DO D=C+1 BY ONE TO NUMBER2;                                 0339
         AH    @05,@CH00057                                        0339
         B     @DE00339                                            0339
@DL00339 DS    0H                                                  0340
*        IF(CUAGP(C)>CUAGP(D))×(CUAGP(C)=CUAGP(D)&SWTCH(D)>SWTCH(C))
*          THEN                                                    0340
         L     @15,SORTAT                                          0340
         LA    @14,11                                              0340
         LR    @07,@14                                             0340
         MH    @07,C                                               0340
         LR    @01,@05                                             0340
         MR    @00,@14                                             0340
         ST    @07,@TF00001                                        0340
         ALR   @07,@15                                             0340
         AL    @07,@CF01858                                        0340
         ST    @01,@TF00002                                        0340
         ALR   @01,@15                                             0340
         AL    @01,@CF01858                                        0340
         CLC   CUAGP(3,@07),CUAGP(@01)                             0340
         BH    @RT00340                                            0340
         LR    @05,@15                                             0340
         AL    @05,@TF00001                                        0340
         AL    @05,@CF01858                                        0340
         LR    @14,@15                                             0340
         AL    @14,@TF00002                                        0340
         AL    @14,@CF01858                                        0340
         CLC   CUAGP(3,@05),CUAGP(@14)                             0340
         BNE   @RF00340                                            0340
         LR    @05,@15                                             0340
         AL    @05,@TF00002                                        0340
         AL    @05,@CF01859                                        0340
         AL    @15,@TF00001                                        0340
         AL    @15,@CF01859                                        0340
         CLC   SWTCH-3(1,@05),SWTCH-3(@15)                         0340
         BNH   @RF00340                                            0340
@RT00340 DS    0H                                                  0341
*          DO;                                                     0341
*            SORTTAB(C)=SORTTAB(C)&&SORTTAB(D);                    0342
         L     @05,SORTAT                                          0342
         LA    @15,11                                              0342
         LR    @14,@15                                             0342
         MH    @14,C                                               0342
         ST    @14,@TF00001                                        0342
         ALR   @14,@05                                             0342
         AL    @14,@CF01858                                        0342
         MH    @15,D                                               0342
         LR    @01,@05                                             0342
         AL    @01,@TF00001                                        0342
         AL    @01,@CF01858                                        0342
         MVC   @TS00001(11),SORTTAB(@01)                           0342
         ST    @15,@TF00002                                        0342
         ALR   @15,@05                                             0342
         AL    @15,@CF01858                                        0342
         XC    @TS00001(11),SORTTAB(@15)                           0342
         MVC   SORTTAB(11,@14),@TS00001                            0342
*            SORTTAB(D)=SORTTAB(D)&&SORTTAB(C);                    0343
         LR    @01,@05                                             0343
         AL    @01,@TF00002                                        0343
         AL    @01,@CF01858                                        0343
         LR    @15,@05                                             0343
         AL    @15,@TF00002                                        0343
         AL    @15,@CF01858                                        0343
         MVC   @TS00001(11),SORTTAB(@15)                           0343
         LR    @15,@05                                             0343
         AL    @15,@TF00001                                        0343
         AL    @15,@CF01858                                        0343
         XC    @TS00001(11),SORTTAB(@15)                           0343
         MVC   SORTTAB(11,@01),@TS00001                            0343
*            SORTTAB(C)=SORTTAB(C)&&SORTTAB(D);                    0344
         LR    @01,@05                                             0344
         AL    @01,@TF00001                                        0344
         AL    @01,@CF01858                                        0344
         LR    @15,@05                                             0344
         AL    @15,@TF00001                                        0344
         AL    @15,@CF01858                                        0344
         MVC   @TS00001(11),SORTTAB(@15)                           0344
         AL    @05,@TF00002                                        0344
         AL    @05,@CF01858                                        0344
         XC    @TS00001(11),SORTTAB(@05)                           0344
         MVC   SORTTAB(11,@01),@TS00001                            0344
*          END;                                                    0345
*      END;                                                        0346
@RF00340 LH    @05,D                                               0346
         AH    @05,ONE                                             0346
@DE00339 STH   @05,D                                               0346
         CH    @05,NUMBER2                                         0346
         BNH   @DL00339                                            0346
*    END;                                                          0347
         LA    @05,1                                               0347
         AH    @05,C                                               0347
         STH   @05,C                                               0347
@DE00338 LH    @15,NUMBER2                                         0347
         BCTR  @15,0                                               0347
         CR    @05,@15                                             0347
         BNH   @DL00338                                            0347
*    END SORTCUA;                                                  0348
@EL00004 DS    0H                                                  0348
@EF00004 DS    0H                                                  0348
@ER00004 LM    @14,@12,12(@13)                                     0348
         BR    @14                                                 0348
* /********************************************************************
* /*    THIS PROC WILL SORT THE SB TABLE BY CUA & EVD BIT             *
*SORTCUA1:                                                         0349
*    PROC;                                                         0349
SORTCUA1 STM   @14,@12,@SA00005                                    0349
*    IF INTABLE>1 THEN                                             0350
         LA    @05,1                                               0350
         CH    @05,INTABLE                                         0350
         BNL   @RF00350                                            0350
*      DO C=1 BY 1 TO INTABLE-1;                                   0351
         STH   @05,C                                               0351
         B     @DE00351                                            0351
@DL00351 DS    0H                                                  0352
*        DO B=C+1 BY ONE TO INTABLE;                               0352
         AH    @05,@CH00057                                        0352
         B     @DE00352                                            0352
@DL00352 DS    0H                                                  0353
*          IF CUAP(C)>CUAP(B)×(CUAP(C)=CUAP(B)&SWITCH(B)>SWITCH(C)) THE
         L     @15,SENSEPTR                                        0353
         LA    @14,31                                              0353
         LR    @07,@14                                             0353
         MH    @07,C                                               0353
         LR    @01,@05                                             0353
         MR    @00,@14                                             0353
         ST    @07,@TF00001                                        0353
         ALR   @07,@15                                             0353
         AL    @07,@CF01862                                        0353
         ST    @01,@TF00002                                        0353
         ALR   @01,@15                                             0353
         AL    @01,@CF01862                                        0353
         CLC   CUAP(2,@07),CUAP(@01)                               0353
         BH    @RT00353                                            0353
         LR    @05,@15                                             0353
         AL    @05,@TF00001                                        0353
         AL    @05,@CF01862                                        0353
         LR    @14,@15                                             0353
         AL    @14,@TF00002                                        0353
         AL    @14,@CF01862                                        0353
         CLC   CUAP(2,@05),CUAP(@14)                               0353
         BNE   @RF00353                                            0353
         LR    @05,@15                                             0353
         AL    @05,@TF00002                                        0353
         AL    @05,@CF01863                                        0353
         AL    @15,@TF00001                                        0353
         AL    @15,@CF01863                                        0353
         CLC   SWITCH-2(1,@05),SWITCH-2(@15)                       0353
         BNH   @RF00353                                            0353
@RT00353 DS    0H                                                  0354
*            CALL SORTSNSE;          /* KEEP EVD RECORDS ON THE TOP   *
         BAL   @14,SORTSNSE                                        0354
*        END;                                                      0355
@RF00353 LH    @05,B                                               0355
         AH    @05,ONE                                             0355
@DE00352 STH   @05,B                                               0355
         CH    @05,INTABLE                                         0355
         BNH   @DL00352                                            0355
*      END;                                                        0356
         LA    @05,1                                               0356
         AH    @05,C                                               0356
         STH   @05,C                                               0356
@DE00351 LH    @15,INTABLE                                         0356
         BCTR  @15,0                                               0356
         CR    @05,@15                                             0356
         BNH   @DL00351                                            0356
*    END SORTCUA1;                                                 0357
@EL00005 DS    0H                                                  0357
@EF00005 DS    0H                                                  0357
@ER00005 LM    @14,@12,@SA00005                                    0357
         BR    @14                                                 0357
* /********************************************************************
* /*                         DOY2Y3                                   *
* /*    THIS PROC WILL SET Y2 Y3 FOR EACH CUA WITH RECORDS PRESENT    *
* /*    THIS PROC WILL BE CALLED TWICE.  ONCE FOR ALL RECORDS THEN    *
* /*    FOR RECORDS WITH JUST THE EVD BIT SET ON.                     *
* /*    THIS PROC WILL EXEPCT THE COUNTS TO BE IN WORK TABLE          *
* /*    IN EACH GROUP, FOR THE CUA'S PRESENT, Y2 & Y3 WILL BE SET ON  *
* /*    IF REQUIRED.                                                  *
* /*        Y2 WILL BE SET ON IF IN THE CURRENT GROUP:                *
* /*           A.  THERE ARE RECORDS IN THE SAME STRING (SEE GLOSSARY)*
* /*           B.  THEY ARE NOT FROM THE ADJACENT ADDRESS(SEE GLOSSARY*
* /*        Y3 WILL BE SET ON IF IN THE CURRENT GROUP:                *
* /*           A.  THERE ARE RECORDS FROM THE ADJACENT ADDRESS        *
* /*    GROUP 6 THE ABOVE WILL HOLD TRUE FOR EXCEPT THE SEARCH WILL   *
* /*    ONLY BE DONE FOR FSC OF 494X (THIS IS A RESULTS OF PROC       *
* /*    FINDNUM ONLY INCREMENTING THE TABLE FOR GROUP 6 IF FSC=494X)  *
*DOY2Y3:                                                           0358
*    PROC;                                                         0358
DOY2Y3   STM   @14,@12,12(@13)                                     0358
*    DO G=1 BY 1 TO 6;               /* DO FOR ALL SIX GROUPS         *
         LA    @05,1                                               0359
         STH   @05,G                                               0359
@DL00359 DS    0H                                                  0360
*      DO H=1 BY 1 TO 32;            /* DO FOR ALL CUA'S              *
         LA    @05,1                                               0360
         STH   @05,H                                               0360
@DL00360 DS    0H                                                  0361
*        IF CUAGPAY(H,G)^=ZERO THEN  /* ANY COUNTS IN THIS CUA,GROUP  *
         SLR   @15,@15                                             0361
         L     @14,RIGHTTAB                                        0361
         LH    @07,G                                               0361
         LA    @06,6                                               0361
         LR    @01,@05                                             0361
         MR    @00,@06                                             0361
         ALR   @01,@07                                             0361
         ALR   @01,@01                                             0361
         LA    @05,0(@01,@14)                                      0361
         AL    @05,@CF01864                                        0361
         CH    @15,CUAGPAY(,@05)                                   0361
         BE    @RF00361                                            0361
*          DO;                       /* BUILD THE ADJACENT ADDRESS    *
*            ADJ=ADJADDR(H);         /* EXTRACT THE ADJACENT ADDRESS  *
         LH    @05,H                                               0363
         ALR   @05,@05                                             0363
         LH    @05,ADJADDR-2(@05)                                  0363
         STH   @05,ADJ                                             0363
*            IF CUAGPAY(ADJ,G)^=ZERO THEN/* ADJ ADDRESS ^= TO ZERO    *
         ST    @01,@TF00001                                        0364
         LR    @01,@05                                             0364
         MR    @00,@06                                             0364
         ALR   @01,@07                                             0364
         ALR   @01,@01                                             0364
         AL    @14,@CF01864                                        0364
         CH    @15,CUAGPAY(@01,@14)                                0364
         BE    @RF00364                                            0364
*              EACSET(H,G)=(EACSET(H,G)×'1000'X);/* SET EAC CHAR 1    *
         L     @05,RIGHTEAC                                        0365
         AL    @05,@TF00001                                        0365
         AL    @05,@CF01864                                        0365
         OC    EACSET(2,@05),@CB01591                              0365
*            DO I=STRINGS(H) BY 1 TO STRINGS(H)+7;/* WILL DO 8 ADDR   *
@RF00364 LH    @05,H                                               0366
         SLR   @15,@15                                             0366
         IC    @15,STRINGS-1(@05)                                  0366
         STH   @15,I                                               0366
         B     @DE00366                                            0366
@DL00366 DS    0H                                                  0367
*              IF CUAGPAY(I,G)^=ZERO&I^=H&I^=ADJ THEN              0367
         LH    @05,G                                               0367
         LA    @14,6                                               0367
         LR    @01,@15                                             0367
         MR    @00,@14                                             0367
         ALR   @01,@05                                             0367
         ALR   @01,@01                                             0367
         L     @07,RIGHTTAB                                        0367
         AL    @07,@CF01864                                        0367
         LH    @07,CUAGPAY(@01,@07)                                0367
         LTR   @07,@07                                             0367
         BZ    @RF00367                                            0367
         LH    @07,H                                               0367
         CR    @15,@07                                             0367
         BE    @RF00367                                            0367
         CH    @15,ADJ                                             0367
         BE    @RF00367                                            0367
* /*DO NOT TEST THE ADJACENT OR CURRENT ADDRESS & ^= TO ZERO          *
*                EACSET(H,G)=(EACSET(H,G)×'2000'X);                0368
         MR    @06,@14                                             0368
         ALR   @07,@05                                             0368
         ALR   @07,@07                                             0368
         L     @05,RIGHTEAC                                        0368
         ALR   @05,@07                                             0368
         AL    @05,@CF01864                                        0368
         OC    EACSET(2,@05),@CB01592                              0368
*            END;                                                  0369
@RF00367 LA    @15,1                                               0369
         AH    @15,I                                               0369
         STH   @15,I                                               0369
@DE00366 LH    @05,H                                               0369
         LA    @14,7                                               0369
         LA    @01,STRINGS-1(@05)                                  0369
         MVC   @ZT00003+3(1),0(@01)                                0369
         AL    @14,@ZT00003                                        0369
         CR    @15,@14                                             0369
         BNH   @DL00366                                            0369
*          END;                                                    0370
*      END;                                                        0371
@RF00361 LA    @05,1                                               0371
         AH    @05,H                                               0371
         STH   @05,H                                               0371
         CH    @05,@CH00895                                        0371
         BNH   @DL00360                                            0371
*    END;                                                          0372
         LA    @05,1                                               0372
         AH    @05,G                                               0372
         STH   @05,G                                               0372
         CH    @05,@CH00081                                        0372
         BNH   @DL00359                                            0372
* /*   SET UP THE ADDRESSABILITY IN CASE THERE ARE EVD RECORDS        *
*    RIGHTTAB=ADDR(EVDCOUNT);        /* SET ADDRESSABILITY FOR DOY23Y *
         LA    @05,EVDCOUNT                                        0373
         ST    @05,RIGHTTAB                                        0373
*    GPPOINT=ADDR(EVDGROUP);         /* CAN FIND RIGHT GROUP TABLE    *
         LA    @05,EVDGROUP                                        0374
         ST    @05,GPPOINT                                         0374
*    RIGHTEAC=ADDR(EVDMDC);          /* SET EAC TABLE ADDRESSABILITY  *
         LA    @05,EVDMDC                                          0375
         ST    @05,RIGHTEAC                                        0375
*    END DOY2Y3;                                                   0376
@EL00006 DS    0H                                                  0376
@EF00006 DS    0H                                                  0376
@ER00006 LM    @14,@12,12(@13)                                     0376
         BR    @14                                                 0376
* /********************************************************************
* /*                           DODCI                                  *
* /*   THIS PROC WILL PROCESS ALL GROUP 1 ENTRIES.  AT LEAST 1 LINE OF*
* /*   OUTPUT WILL BE PRODUCED FOR EACH UNIQUE CUA.                   *
* /*   THE OUTPUT FORMAT FOR THIS GROUP IS:                           *
* /* CUA = XXX   TYPE = DCI   EAC = A1,A2,A3,A4(XXXX)  SAMPLES = XXXX *
* /*                          (THE EAC IS COMPOSED OF 4 HEX CHARACTERS)
*                                                                     *
* /*           MODIFER (3 TYPES)                                      *
* /*                SEL CNTRL:      ONLY FOR FSC'S OF 9006            *
* /*                IMMEDIATE TAG:  ONLY FOR FSC'S OF 9003            *
* /*                EXTENDED TAG:   ONLY FOR FSC'S OF 9001            *
* /*                   (EACH ONE HAS THE FOLLOWING THREE PARTS)       *
* /*                          TAG    = XX(SENSE BYTE 8)               *
* /*                          BUSOUT = YY(SENSE BYTE 9)               *
* /*                          BUSIN  = ZZ(SENSE BYTE 10)              *
* /* THE CUA IS TAKEN FROM THE SORTABLE ENTRY                         *
* /* DCI IS PRINTED FOR ALL GROUP1 ENTRIES                            *
* /* SAMPLES IS THE NUMBER OF RECORDS IN THIS GROUP                   *
* /* EAC IS BUILT BY                                                  *
* /*         A1 = 4 BITS  Y0,Y1,Y2,& Y3                               *
* /*          A TABLE WAS BUILT BY FINDNUM THAT CAN BE USED TO DETERMI*
* /*          THE VALUE OF Y0 & Y1.   THIS WAS REQUIRED AS THEY ARE   *
* /*          DETERMINED BY ALL GROUP1 RECORDS REGARDLESS OF THE CUA  *
* /*            Y0 = ON IF ANY OTHER GROUP 1 CUA HAS A SENSE CODE OF  *
* /*                 9001,9002,9003,9006,9007, OR 900E.               *
* /*            Y1 = ON IF OTHER GROUP1 CUA HAS  A FSC OF 93XX OR 9AXX*
* /*            Y2 = ON IF ANY GROUP1 ERRORS AGAINST ANY CUA IN THIS  *
* /*                 CUA'S STRING EXCLUDING THE ADJACENT ADDRESS.     *
* /*            Y3 = ON IF ANY GROUP1 ERRORS AGAINST THE ADJACENT     *
* /*                 CUA.                                             *
* /*         A2 = 4 BITS Y4,Y5,Y6,& Y7                                *
* /*            Y4 = UNUSED                                           *
* /*            Y5 = UNUSED                                           *
* /*            Y6 = ON IF THIS CUA HAS A FSC OF 9007 RECORDED        *
* /*            Y7 = ON IF THIS CUA HAS A FSC OF 900E RECORDED        *
* /*         A3 = 4 BITS  Y8,Y9,YA,YB                                 *
* /*            Y8 = ON IF THIS CUA HAS A FSC OF 9006 RECORDED        *
* /*            Y9 = ON IF THIS CUA HAS A FSC OF 9003 RECORDED        *
* /*            YA = ON IF THIS CUA HAS A FSC OF 9001 RECORDED        *
* /*            YB = ON IF THIS CUA HAS A FSC OF 9002 RECORDED        *
* /*         A4 = 4 BITS  YC,YD,YE,YF                                 *
* /*            YC = ON IF THIS CUA HAS SENSE BYTE 22 = 93 & BYTE 23  *
* /*                 HAS BIT 0 = ON.                                  *
* /*            YD = ON IF THIS CUA HAS SENSE BYTE 22 = 93 & BYTE 23  *
* /*                 HAS BIT 1 = ON.                                  *
* /*            YE = ON IF THIS CUA HAS SENSE BYTE 22 = 93 & BYTE 23  *
* /*                 HAS BIT 2 = ON.                                  *
* /*            YF = ON IF THIS CUA HAS A FSC OF 9AXX RECORDED        *
* /*    MODIFER:  THIS FIELD IS PRINTED FOR CUA'S WITH A FSC OF       *
* /*               9006,9003 OR 9001.                                 *
* /*               FOR EACH BLOCK OF THESE FSC'S ALL UNIQUE           *
* /*               COMBINATIONS OF SENSE BYTES 8,9 & 10.              *
* /*       SEL CNTRL:      TAG-XX   BUS OUT-YY BUS IN-ZZ (FSC OF 9006 *
* /*                       XX = SENSE BYTE 8 (DCI TAG BUS)            *
* /*                       YY = SENSE BYTE 9 (DCI BUS OUT)            *
* /*                       ZZ = SENSE BYTE 10 (DCI BUS IN)            *
* /*       IMMEDIATE TAG:  TAG-XX   BUS OUT-YY BUS IN-ZZ (FSC 0F 9003 *
* /*                       SAME AS SEL CNTRL                          *
* /*       EXTENDED  TAG:  TAG-XX   BUS OUT-YY BUS IN-ZZ (FSC OF 9001 *
* /*                       SAME AS SEL CNTRL                          *
*DODCI:                                                            0377
*    PROC;                                                         0377
DODCI    STM   @14,@12,@SA00007                                    0377
*    CALL READREC(ALLCOUNT(A,ONE));  /* READ THE RECORDS FOR THIS CUA *
         LH    @05,A                                               0378
         MH    @05,@CH00081                                        0378
         AH    @05,ONE                                             0378
         ALR   @05,@05                                             0378
         LA    @05,ALLCOUNT-14(@05)                                0378
         ST    @05,@AL00001                                        0378
         LA    @01,@AL00001                                        0378
         BAL   @14,READREC                                         0378
*    BYTE=BYTE&&BYTE;                /* CLEAR THE ANSWER              *
         XC    BYTE(2),BYTE                                        0379
*    DO Z=1 BY 1 TO INTABLE;         /* DO ALL RECORDS READ BY READREC*
         LA    @05,1                                               0380
         STH   @05,Z                                               0380
         B     @DE00380                                            0380
@DL00380 DS    0H                                                  0381
*      FAULT=BYTE2223(Z);            /* SAVE BAL CODE                 *
         MH    @05,@CH00042                                        0381
         L     @01,SENSEPTR                                        0381
         ALR   @01,@05                                             0381
         AL    @01,@CF01865                                        0381
         MVC   FAULT(2),BYTE2223-25(@01)                           0381
*      IF FAULT='9007'X THEN                                       0382
         CLC   FAULT(2),@CB01597                                   0382
         BNE   @RF00382                                            0382
*        Y6=ON;                      /* BIT 6                         *
         OI    Y6,B'00000010'                                      0383
*      ELSE                                                        0384
*        IF FAULT='900E'X THEN                                     0384
         B     @RC00382                                            0384
@RF00382 CLC   FAULT(2),@CB01598                                   0384
         BNE   @RF00384                                            0384
*          Y7=ON;                    /* BIT 7                         *
         OI    Y7,B'00000001'                                      0385
*        ELSE                                                      0386
*          IF FAULT='9006'X THEN                                   0386
         B     @RC00384                                            0386
@RF00384 CLC   FAULT(2),@CB01599                                   0386
         BNE   @RF00386                                            0386
*            Y8=ON;                  /* BIT 8                         *
         OI    Y8,B'10000000'                                      0387
*          ELSE                                                    0388
*            IF FAULT='9003'X THEN                                 0388
         B     @RC00386                                            0388
@RF00386 CLC   FAULT(2),@CB01600                                   0388
         BNE   @RF00388                                            0388
*              Y9=ON;                /* BIT 9                         *
         OI    Y9,B'01000000'                                      0389
*            ELSE                                                  0390
*              IF FAULT='9001'X THEN                               0390
         B     @RC00388                                            0390
@RF00388 CLC   FAULT(2),@CB01601                                   0390
         BNE   @RF00390                                            0390
*                YA=ON;              /* BIT 10                        *
         OI    YA,B'00100000'                                      0391
*              ELSE                                                0392
*                IF FAULT='9002'X THEN                             0392
         B     @RC00390                                            0392
@RF00390 CLC   FAULT(2),@CB01602                                   0392
         BNE   @RF00392                                            0392
*                  YB=ON;                                          0393
         OI    YB,B'00010000'                                      0393
*                ELSE                                              0394
*                  IF FAULT2='93'X THEN                            0394
         B     @RC00392                                            0394
@RF00392 CLI   FAULT2,X'93'                                        0394
         BNE   @RF00394                                            0394
*                    DO;                                           0395
*                      IF SB0=ON THEN                              0396
         TM    SB0,B'10000000'                                     0396
         BNO   @RF00396                                            0396
*                        YC=ON;                                    0397
         OI    YC,B'00001000'                                      0397
*                      IF SB1=ON THEN                              0398
@RF00396 TM    SB1,B'01000000'                                     0398
         BNO   @RF00398                                            0398
*                        YD=ON;                                    0399
         OI    YD,B'00000100'                                      0399
*                      IF SB2=ON THEN                              0400
@RF00398 TM    SB2,B'00100000'                                     0400
         BNO   @RF00400                                            0400
*                        YE=ON;                                    0401
         OI    YE,B'00000010'                                      0401
*                    END;                                          0402
*                  ELSE                                            0403
*                    IF FAULT2='9A'X THEN                          0403
         B     @RC00394                                            0403
@RF00394 CLI   FAULT2,X'9A'                                        0403
         BNE   @RF00403                                            0403
*                      YF=ON;                                      0404
         OI    YF,B'00000001'                                      0404
*    END;                                                          0405
@RF00403 DS    0H                                                  0405
@RC00394 DS    0H                                                  0405
@RC00392 DS    0H                                                  0405
@RC00390 DS    0H                                                  0405
@RC00388 DS    0H                                                  0405
@RC00386 DS    0H                                                  0405
@RC00384 DS    0H                                                  0405
@RC00382 LA    @05,1                                               0405
         AH    @05,Z                                               0405
         STH   @05,Z                                               0405
@DE00380 CH    @05,INTABLE                                         0405
         BNH   @DL00380                                            0405
*    MAINMDC(A,ONE)=(MAINMDC(A,ONE)×BYTE);/* MOVE ANSWER TO MAIN TAB  *
         LH    @05,A                                               0406
         MH    @05,@CH00081                                        0406
         AH    @05,ONE                                             0406
         ALR   @05,@05                                             0406
         LA    @01,MAINMDC-14(@05)                                 0406
         OC    0(2,@01),BYTE                                       0406
*    CALL PRTHEAD(ONE);              /* PRINT THE OUTPUT              *
         LA    @01,@AL00407                                        0407
         BAL   @14,PRTHEAD                                         0407
*    IF(MAINMDC(A,1)&'00E0'X)^=ZERO THEN/* ARE MODIFERS REQUIRED      *
         LH    @05,A                                               0408
         MH    @05,@CH00033                                        0408
         LA    @15,224                                             0408
         LA    @14,MAINMDC-12(@05)                                 0408
         MVC   @ZT00002+2(2),0(@14)                                0408
         N     @15,@ZT00002                                        0408
         LTR   @15,@15                                             0408
         BZ    @RF00408                                            0408
*      CALL GP1MODIF;                /* PRINT THE MODIFERS            *
         BAL   @14,GP1MODIF                                        0409
*    END DODCI;                                                    0410
@EL00007 DS    0H                                                  0410
@EF00007 DS    0H                                                  0410
@ER00007 LM    @14,@12,@SA00007                                    0410
         BR    @14                                                 0410
* /*******************************************************************/
* /*    THIS PROC WILL BUILD THE MODIFER FIELDS AND PRINT THE RESULT  *
* /*    FOR FSC'S OF 9006,9003,9001.  IT WILL PRINT ALL OF THE UNIQUE *
* /*    COMBINATION OF SB 3,4,5  FOR EACH OF THEE BYTES               *
*GP1MODIF:                                                         0411
*    PROC;                                                         0411
GP1MODIF STM   @14,@12,@SA00008                                    0411
*    IF INTABLE>ONE THEN             /* MUST HAVE MORE THAN 1 ITEM TO
*                                       SORT                          *
         LH    @05,INTABLE                                         0412
         CH    @05,ONE                                             0412
         BNH   @RF00412                                            0412
*      DO C=1 BY 1 TO INTABLE-1;     /* INTABLE = # RECORDS READ THIS
*                                       CUA                           *
         LA    @05,1                                               0413
         STH   @05,C                                               0413
         B     @DE00413                                            0413
@DL00413 DS    0H                                                  0414
*        DO B=C+1 BY ONE TO INTABLE;                               0414
         AH    @05,@CH00057                                        0414
         B     @DE00414                                            0414
@DL00414 DS    0H                                                  0415
*          IF BYTE0810(B)>BYTE0810(C) THEN/* BYTES 8,9,& 10           *
         L     @15,SENSEPTR                                        0415
         LA    @14,31                                              0415
         LR    @01,@05                                             0415
         MR    @00,@14                                             0415
         MH    @14,C                                               0415
         ALR   @01,@15                                             0415
         AL    @01,@CF01871                                        0415
         ALR   @15,@14                                             0415
         AL    @15,@CF01871                                        0415
         CLC   BYTE0810-11(3,@01),BYTE0810-11(@15)                 0415
         BNH   @RF00415                                            0415
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        0416
*        END;                                                      0417
@RF00415 LH    @05,B                                               0417
         AH    @05,ONE                                             0417
@DE00414 STH   @05,B                                               0417
         CH    @05,INTABLE                                         0417
         BNH   @DL00414                                            0417
*      END;                                                        0418
         LA    @05,1                                               0418
         AH    @05,C                                               0418
         STH   @05,C                                               0418
@DE00413 LH    @15,INTABLE                                         0418
         BCTR  @15,0                                               0418
         CR    @05,@15                                             0418
         BNH   @DL00413                                            0418
*    DCIMOD1D=DCIMOD1;               /* LINE 1 OF THE MODIFERS        *
@RF00412 MVC   DCIMOD1D(80),DCIMOD1                                0419
*    CALL PRINTIT;                   /* PRINT LINE 1                  *
         BAL   @14,PRINTIT                                         0420
*    DCIMOD2D=DCIMOD2;               /* LINE 2 OF THE MODIFERS        *
         MVC   DCIMOD2D(80),DCIMOD2                                0421
*    CALL PRINTIT;                   /* PRINT LINE 2                  *
         BAL   @14,PRINTIT                                         0422
*    SB345SV=SB345SV&&SB345SV;       /* CLEAR FOR NEW CUA             *
         XC    SB345SV(9),SB345SV                                  0423
*    SETTO1='000100010001'X;         /* SET F,G, &H TO A VALUE OF 1   *
         MVC   SETTO1(6),@CB01609                                  0424
*    GP1SWIT=GP1SWIT&&GP1SWIT;       /* SET SWITCHES OFF              *
         XC    GP1SWIT(2),GP1SWIT                                  0425
*    DO UNTIL(F>INTABLE&G>INTABLE&H>INTABLE);                      0426
@DL00426 DS    0H                                                  0427
*      CALL GP1MOD6;                 /* CHECK FOR FSC OF 9006         *
         BAL   @14,GP1MOD6                                         0427
*      CALL GP1MOD3;                 /* CHECK FOR FSC OF 9003         *
         BAL   @14,GP1MOD3                                         0428
*      CALL GP1MOD1;                 /* CHECK FOR FSC OF 9001         *
         BAL   @14,GP1MOD1                                         0429
*      IF(F9006=ON&F9003=ON&F9001=ON)×(F9006=ON&F9003=ON&H>INTABLE)×(
*          F9006=ON&F9001=ON&G>INTABLE)×(F9003=ON&F9001=ON&F>INTABLE)
*        THEN                                                      0430
         TM    F9006,B'11100000'                                   0430
         BO    @RT00430                                            0430
         TM    F9006,B'11000000'                                   0430
         BNO   @GL00014                                            0430
         LH    @05,H                                               0430
         CH    @05,INTABLE                                         0430
         BH    @RT00430                                            0430
@GL00014 TM    F9006,B'10100000'                                   0430
         BNO   @GL00013                                            0430
         LH    @05,G                                               0430
         CH    @05,INTABLE                                         0430
         BH    @RT00430                                            0430
@GL00013 TM    F9003,B'01100000'                                   0430
         BNO   @RF00430                                            0430
         LH    @05,F                                               0430
         CH    @05,INTABLE                                         0430
         BNH   @RF00430                                            0430
@RT00430 DS    0H                                                  0431
*        DO;                                                       0431
*          CALL PRINTIT;             /* WILL NEED ROOM IN THE TABLE
*                                       NEXT PASS                     *
         BAL   @14,PRINTIT                                         0432
*          GP1SWIT='0000'X;          /* RESET F9006,3,&1              *
         MVC   GP1SWIT(2),@CB00208                                 0433
*        END;                                                      0434
*    END;                                                          0435
@RF00430 DS    0H                                                  0435
@DE00426 LH    @05,INTABLE                                         0435
         CH    @05,F                                               0435
         BNL   @DL00426                                            0435
         CH    @05,G                                               0435
         BNL   @DL00426                                            0435
         CH    @05,H                                               0435
         BNL   @DL00426                                            0435
*    IF F9006=ON×F9003=ON×F9001=ON THEN                            0436
         TM    F9006,B'11100000'                                   0436
         BZ    @RF00436                                            0436
*      CALL PRINTIT;                 /* SOME THING IN THE PRINT LINE  *
         BAL   @14,PRINTIT                                         0437
*    END GP1MODIF;                                                 0438
@EL00008 DS    0H                                                  0438
@EF00008 DS    0H                                                  0438
@ER00008 LM    @14,@12,@SA00008                                    0438
         BR    @14                                                 0438
* /*******************************************************************/
* /*    THIS PROC WILL PROCESS FSC'S OF 9006 FOR GROUP1 MODIFERS      *
*                                                                  0439
*GP1MOD6:                                                          0439
*    PROC;                                                         0439
GP1MOD6  STM   @14,@12,@SA00009                                    0439
*    IF F^>INTABLE&BYTE2223(F)='9006'X THEN                        0440
         LH    @05,F                                               0440
         CH    @05,INTABLE                                         0440
         BH    @RF00440                                            0440
         L     @15,SENSEPTR                                        0440
         LR    @14,@05                                             0440
         MH    @14,@CH00042                                        0440
         ST    @14,@TF00001                                        0440
         ALR   @14,@15                                             0440
         AL    @14,@CF01865                                        0440
         CLC   BYTE2223-25(2,@14),@CB01599                         0440
         BNE   @RF00440                                            0440
*      DO;                                                         0441
*        IF F9006=OFF THEN           /* ANYTHING IN THE PRINT LINE    *
         TM    F9006,B'10000000'                                   0442
         BNZ   @RF00442                                            0442
*          DO;                                                     0443
*            IF BYTE0810(F)^=F9006SV×F=1 THEN                      0444
         AL    @15,@TF00001                                        0444
         AL    @15,@CF01871                                        0444
         CLC   BYTE0810-11(3,@15),F9006SV                          0444
         BNE   @RT00444                                            0444
         CH    @05,@CH00057                                        0444
         BNE   @RF00444                                            0444
@RT00444 DS    0H                                                  0445
*              DO;                   /* MOVE TO THE PRINT LINE        *
*                F9006SV=BYTE0810(F);/* SAVE FOR THE NEXT COMPARE     *
         LH    @05,F                                               0446
         MH    @05,@CH00042                                        0446
         L     @01,SENSEPTR                                        0446
         ALR   @01,@05                                             0446
         AL    @01,@CF01871                                        0446
         MVC   F9006SV(3),BYTE0810-11(@01)                         0446
*                CALL CONVERT1(ONE,PRT12,ADDR(F9006SV1));          0447
         LA    @05,F9006SV1                                        0447
         ST    @05,@AFTEMPS                                        0447
         LA    @01,@AL00447                                        0447
         BAL   @14,CONVERT1                                        0447
*                CALL CONVERT1(ONE,PRT17,ADDR(F9006SV2));          0448
         LA    @05,F9006SV2                                        0448
         ST    @05,@AFTEMPS                                        0448
         LA    @01,@AL00448                                        0448
         BAL   @14,CONVERT1                                        0448
*                CALL CONVERT1(ONE,PRT21,ADDR(F9006SV3));          0449
         LA    @05,F9006SV3                                        0449
         ST    @05,@AFTEMPS                                        0449
         LA    @01,@AL00449                                        0449
         BAL   @14,CONVERT1                                        0449
*                F9006=ON;           /* SOME THING IS IN THE PRINT 0450
*                                       LINE                          *
         OI    F9006,B'10000000'                                   0450
*              END;                                                0451
*            F=F+1;                  /* MOVE THE INDEX VALUE TO THE
*                                       NEXT ENTRY                    *
@RF00444 LH    @05,F                                               0452
         LA    @05,1(,@05)                                         0452
         STH   @05,F                                               0452
*          END;                                                    0453
*        ELSE                                                      0454
*          IF F9006=ON&G=>INTABLE&H=>INTABLE THEN                  0454
         B     @RC00442                                            0454
@RF00442 TM    F9006,B'10000000'                                   0454
         BNO   @RF00454                                            0454
         LH    @05,INTABLE                                         0454
         CH    @05,G                                               0454
         BH    @RF00454                                            0454
         CH    @05,H                                               0454
         BH    @RF00454                                            0454
*            DO;                     /* AVOID HANGING IN A LOOP       *
*              CALL PRINTIT;                                       0456
         BAL   @14,PRINTIT                                         0456
*              F9006=OFF;            /* ALLOW THIS ONE TO PRINT NEXT
*                                       TIME                          *
         NI    F9006,B'01111111'                                   0457
*            END;                                                  0458
*      END;                                                        0459
*    ELSE                                                          0460
*      F=F+1;                        /* MOVE THE INDEX VALUE          *
         B     @RC00440                                            0460
@RF00440 LH    @05,F                                               0460
         LA    @05,1(,@05)                                         0460
         STH   @05,F                                               0460
*    END GP1MOD6;                                                  0461
@EL00009 DS    0H                                                  0461
@EF00009 DS    0H                                                  0461
@ER00009 LM    @14,@12,@SA00009                                    0461
         BR    @14                                                 0461
* /*******************************************************************/
* /*    THIS PROC WILL PROCESS FSC'S OF 9003 FOR GROUP1 MODIFERS      *
*GP1MOD3:                                                          0462
*    PROC;                                                         0462
GP1MOD3  STM   @14,@12,@SA00010                                    0462
*    IF G^>INTABLE&BYTE2223(G)='9003'X THEN                        0463
         LH    @05,G                                               0463
         CH    @05,INTABLE                                         0463
         BH    @RF00463                                            0463
         L     @15,SENSEPTR                                        0463
         LR    @14,@05                                             0463
         MH    @14,@CH00042                                        0463
         ST    @14,@TF00001                                        0463
         ALR   @14,@15                                             0463
         AL    @14,@CF01865                                        0463
         CLC   BYTE2223-25(2,@14),@CB01600                         0463
         BNE   @RF00463                                            0463
*      DO;                                                         0464
*        IF F9003=OFF THEN           /* ANY THING IN THE PRINT LINE   *
         TM    F9003,B'01000000'                                   0465
         BNZ   @RF00465                                            0465
*          DO;                                                     0466
*            IF BYTE0810(G)^=F9003SV×G=1 THEN                      0467
         AL    @15,@TF00001                                        0467
         AL    @15,@CF01871                                        0467
         CLC   BYTE0810-11(3,@15),F9003SV                          0467
         BNE   @RT00467                                            0467
         CH    @05,@CH00057                                        0467
         BNE   @RF00467                                            0467
@RT00467 DS    0H                                                  0468
*              DO;                                                 0468
*                F9003SV=BYTE0810(G);/* SAVE FOR THE NEXT COMPARE     *
         LH    @05,G                                               0469
         MH    @05,@CH00042                                        0469
         L     @01,SENSEPTR                                        0469
         ALR   @01,@05                                             0469
         AL    @01,@CF01871                                        0469
         MVC   F9003SV(3),BYTE0810-11(@01)                         0469
*                CALL CONVERT1(ONE,PRT39,ADDR(F9003SV1));          0470
         LA    @05,F9003SV1                                        0470
         ST    @05,@AFTEMPS+4                                      0470
         LA    @01,@AL00470                                        0470
         BAL   @14,CONVERT1                                        0470
*                CALL CONVERT1(ONE,PRT44,ADDR(F9003SV2));          0471
         LA    @05,F9003SV2                                        0471
         ST    @05,@AFTEMPS+4                                      0471
         LA    @01,@AL00471                                        0471
         BAL   @14,CONVERT1                                        0471
*                CALL CONVERT1(ONE,PRT48,ADDR(F9003SV3));          0472
         LA    @05,F9003SV3                                        0472
         ST    @05,@AFTEMPS+4                                      0472
         LA    @01,@AL00472                                        0472
         BAL   @14,CONVERT1                                        0472
*                F9003=ON;           /* SOME THING IS IN THE PRINT 0473
*                                       LINE                          *
         OI    F9003,B'01000000'                                   0473
*              END;                                                0474
*            G=G+1;                  /* MOVE INDEX TO THE NEXT ITEM   *
@RF00467 LH    @05,G                                               0475
         LA    @05,1(,@05)                                         0475
         STH   @05,G                                               0475
*          END;                                                    0476
*        ELSE                                                      0477
*          IF F9003=ON&H=>INTABLE&F=>INTABLE THEN                  0477
         B     @RC00465                                            0477
@RF00465 TM    F9003,B'01000000'                                   0477
         BNO   @RF00477                                            0477
         LH    @05,INTABLE                                         0477
         CH    @05,H                                               0477
         BH    @RF00477                                            0477
         CH    @05,F                                               0477
         BH    @RF00477                                            0477
*            DO;                     /* AVOID HANGING IN A LOOP       *
*              CALL PRINTIT;         /* PRINT THE ENTRY IN THE TABLE  *
         BAL   @14,PRINTIT                                         0479
*              F9003=OFF;            /* ALLOW TO PRINT NEXT TIME      *
         NI    F9003,B'10111111'                                   0480
*            END;                                                  0481
*      END;                                                        0482
*    ELSE                                                          0483
*      G=G+1;                        /* MOVE THE POINTER TO THE NEXT
*                                       RECORD                        *
         B     @RC00463                                            0483
@RF00463 LH    @05,G                                               0483
         LA    @05,1(,@05)                                         0483
         STH   @05,G                                               0483
*    END GP1MOD3;                                                  0484
@EL00010 DS    0H                                                  0484
@EF00010 DS    0H                                                  0484
@ER00010 LM    @14,@12,@SA00010                                    0484
         BR    @14                                                 0484
* /*******************************************************************/
* /*    THIS PROC WILL PROCESS FSC'S OF 9001 FOR GROUP1 MODIFERS      *
*GP1MOD1:                                                          0485
*    PROC;                                                         0485
GP1MOD1  STM   @14,@12,@SA00011                                    0485
*    IF H^>INTABLE&BYTE2223(H)='9001'X THEN                        0486
         LH    @05,H                                               0486
         CH    @05,INTABLE                                         0486
         BH    @RF00486                                            0486
         L     @15,SENSEPTR                                        0486
         LR    @14,@05                                             0486
         MH    @14,@CH00042                                        0486
         ST    @14,@TF00001                                        0486
         ALR   @14,@15                                             0486
         AL    @14,@CF01865                                        0486
         CLC   BYTE2223-25(2,@14),@CB01601                         0486
         BNE   @RF00486                                            0486
*      DO;                                                         0487
*        IF F9001=OFF THEN           /* IS PRINT LOCATION EMPTY       *
         TM    F9001,B'00100000'                                   0488
         BNZ   @RF00488                                            0488
*          DO;                                                     0489
*            IF BYTE0810(H)^=F9001SV×H=1 THEN                      0490
         AL    @15,@TF00001                                        0490
         AL    @15,@CF01871                                        0490
         CLC   BYTE0810-11(3,@15),F9001SV                          0490
         BNE   @RT00490                                            0490
         CH    @05,@CH00057                                        0490
         BNE   @RF00490                                            0490
@RT00490 DS    0H                                                  0491
*              DO;                                                 0491
*                F9001SV=BYTE0810(H);/* SAVE FOR THE NEXT COMPARE     *
         LH    @05,H                                               0492
         MH    @05,@CH00042                                        0492
         L     @01,SENSEPTR                                        0492
         ALR   @01,@05                                             0492
         AL    @01,@CF01871                                        0492
         MVC   F9001SV(3),BYTE0810-11(@01)                         0492
*                CALL CONVERT1(ONE,PRT68,ADDR(F9001SV1));          0493
         LA    @05,F9001SV1                                        0493
         ST    @05,@AFTEMPS+8                                      0493
         LA    @01,@AL00493                                        0493
         BAL   @14,CONVERT1                                        0493
*                CALL CONVERT1(ONE,PRT72,ADDR(F9001SV2));          0494
         LA    @05,F9001SV2                                        0494
         ST    @05,@AFTEMPS+8                                      0494
         LA    @01,@AL00494                                        0494
         BAL   @14,CONVERT1                                        0494
*                CALL CONVERT1(ONE,PRT77,ADDR(F9001SV3));          0495
         LA    @05,F9001SV3                                        0495
         ST    @05,@AFTEMPS+8                                      0495
         LA    @01,@AL00495                                        0495
         BAL   @14,CONVERT1                                        0495
*                F9001=ON;           /* SOME THING IS IN THE PRINT 0496
*                                       LINE                          *
         OI    F9001,B'00100000'                                   0496
*              END;                                                0497
*            H=H+1;                  /* MOVE THE INDEX TO NEXT ENTRY  *
@RF00490 LH    @05,H                                               0498
         LA    @05,1(,@05)                                         0498
         STH   @05,H                                               0498
*          END;                                                    0499
*        ELSE                                                      0500
*          IF F9001=ON&G=>INTABLE&F=>INTABLE THEN                  0500
         B     @RC00488                                            0500
@RF00488 TM    F9001,B'00100000'                                   0500
         BNO   @RF00500                                            0500
         LH    @05,INTABLE                                         0500
         CH    @05,G                                               0500
         BH    @RF00500                                            0500
         CH    @05,F                                               0500
         BH    @RF00500                                            0500
*            DO;                     /* AVOID HANGING IN A LOOP       *
*              CALL PRINTIT;                                       0502
         BAL   @14,PRINTIT                                         0502
*              F9001=OFF;            /* ALLOW TO PRINT NEXT TIME      *
         NI    F9001,B'11011111'                                   0503
*            END;                                                  0504
*      END;                                                        0505
*    ELSE                                                          0506
*      H=H+1;                        /* MOVE THE INDEX VALUE          *
         B     @RC00486                                            0506
@RF00486 LH    @05,H                                               0506
         LA    @05,1(,@05)                                         0506
         STH   @05,H                                               0506
*    END GP1MOD1;                                                  0507
@EL00011 DS    0H                                                  0507
@EF00011 DS    0H                                                  0507
@ER00011 LM    @14,@12,@SA00011                                    0507
         BR    @14                                                 0507
* /*******************************************************************/
* /*                        DOFCI                                     *
* /*   THIS PROC WILL PROCESS ALL GROUP 2 ENTRIES.  1 LINE OF OUTPUT  *
* /*    WILL BE PRODUCED FOR EACH UNIQUE CUA.                         *
* /*   THE OUTPUT FORMAT FOR THIS GROUP IS:                           *
* /* CUA = XXX   TYPE = FCI   EAC = B1,B2,B3,B4(XXXX)  SAMPLES = XXXX *
* /*                                (EAC IS COMPOSED OF 4 HEX BYTES)  *
* /*   THE CUA IS TAKEN FROM THE SORTABLE ENTRY                       *
* /*   FCI IS PRINTED FOR ALL GROUP2 ENTRIES                          *
* /*   SAMPLES = NUMBER OF GROUP 2 RECORDS PROCESSED                  *
* /*   EAC:  B1 = 4 BITS  Y0,Y1,Y2,& Y3                               *
* /*            Y0 = UNUSED                                           *
* /*            Y1 = UNUSED                                           *
* /*            Y2 = ON IF ANY GROUP2 ERRORS AGAINST ANY CUA IN THIS  *
* /*                 CUAS STRING EXCLUDING THE ADJACENT ADDRESS.      *
* /*            Y3 = ON IF ANY GROUP2 ERRORS AGAINST THE ADJACENT     *
* /*                 CUA.                                             *
* /*         B2 = 4 BITS Y4,Y5,Y6, & Y7                               *
* /*            Y4 = UNUSED                                           *
* /*            Y5 = ON IF THIS CUA HAS A FSC OF 1905 RECORDED        *
* /*            Y6 = ON IF THIS CUA HAS A FSC OF 900B RECORDED        *
* /*            Y7 = ON IF THIS CUA HAS A FSC OF 900F RECORDED        *
* /*         B3 = 4 BITS  Y8,Y9,YA,YB                                 *
* /*            Y8 = ON IF THIS CUA HAS A FSC OF 1907 RECORDED        *
* /*            Y9 = ON IF THIS CUA HAS A FSC OF 1903 RECORDED        *
* /*            YA = ON IF THIS CUA HAS A FSC OF 1908 RECORDED        *
* /*            YB = ON IF THIS CUA HAS A FSC OF 1901 RECORDED        *
* /*         B4 = 4 BITS  YC,YD,YE,YF                                 *
* /*            YC = ON IF THIS CUA HAS A FSC OF 10XX RECORDED        *
* /*            YD = ON IF THIS CUA HAS A FSC OF 98XX RECORDED        *
* /*            YE = ON IF THIS CUA HAS A FSC OF 94XX RECORDED        *
* /*            YF = ON IF THIS CUA HAS A FSC OF 96XX RECORDED        *
*DOFCI:                                                            0508
*    PROC;                                                         0508
DOFCI    STM   @14,@12,@SA00012                                    0508
*    BYTE=BYTE&&BYTE;                /* CLEAR THE ANSWER AREA         *
         XC    BYTE(2),BYTE                                        0509
*    CALL READREC(ALLCOUNT(A,TWO));  /* READ THIS GROUP RECORDS       *
         LH    @05,A                                               0510
         MH    @05,@CH00081                                        0510
         AH    @05,TWO                                             0510
         ALR   @05,@05                                             0510
         LA    @05,ALLCOUNT-14(@05)                                0510
         ST    @05,@AL00001                                        0510
         LA    @01,@AL00001                                        0510
         BAL   @14,READREC                                         0510
*    DO Z=1 BY 1 TO INTABLE;         /* DO RECORDS READ BY READREC    *
         LA    @05,1                                               0511
         STH   @05,Z                                               0511
         B     @DE00511                                            0511
@DL00511 DS    0H                                                  0512
*      FAULT=BYTE2223(Z);            /* SAVE BAL CODE                 *
         MH    @05,@CH00042                                        0512
         L     @01,SENSEPTR                                        0512
         ALR   @01,@05                                             0512
         AL    @01,@CF01865                                        0512
         MVC   FAULT(2),BYTE2223-25(@01)                           0512
*      IF FAULT='1905'X THEN                                       0513
         CLC   FAULT(2),@CB01627                                   0513
         BNE   @RF00513                                            0513
*        Y5=ON;                                                    0514
         OI    Y5,B'00000100'                                      0514
*      ELSE                                                        0515
*        IF FAULT='900B'X THEN                                     0515
         B     @RC00513                                            0515
@RF00513 CLC   FAULT(2),@CB01628                                   0515
         BNE   @RF00515                                            0515
*          Y6=ON;                                                  0516
         OI    Y6,B'00000010'                                      0516
*        ELSE                                                      0517
*          IF FAULT='900F'X THEN                                   0517
         B     @RC00515                                            0517
@RF00515 CLC   FAULT(2),@CB01629                                   0517
         BNE   @RF00517                                            0517
*            Y7=ON;                                                0518
         OI    Y7,B'00000001'                                      0518
*          ELSE                                                    0519
*            IF FAULT='1907'X THEN                                 0519
         B     @RC00517                                            0519
@RF00517 CLC   FAULT(2),@CB01630                                   0519
         BNE   @RF00519                                            0519
*              Y8=ON;                                              0520
         OI    Y8,B'10000000'                                      0520
*            ELSE                                                  0521
*              IF FAULT='1903'X THEN                               0521
         B     @RC00519                                            0521
@RF00519 CLC   FAULT(2),@CB01631                                   0521
         BNE   @RF00521                                            0521
*                Y9=ON;                                            0522
         OI    Y9,B'01000000'                                      0522
*              ELSE                                                0523
*                IF FAULT='1908'X THEN                             0523
         B     @RC00521                                            0523
@RF00521 CLC   FAULT(2),@CB01632                                   0523
         BNE   @RF00523                                            0523
*                  YA=ON;                                          0524
         OI    YA,B'00100000'                                      0524
*                ELSE                                              0525
*                  IF FAULT='1901'X THEN                           0525
         B     @RC00523                                            0525
@RF00523 CLC   FAULT(2),@CB01633                                   0525
         BNE   @RF00525                                            0525
*                    YB=ON;                                        0526
         OI    YB,B'00010000'                                      0526
*                  ELSE                                            0527
*                    IF FAULT2='10'X THEN                          0527
         B     @RC00525                                            0527
@RF00525 CLI   FAULT2,X'10'                                        0527
         BNE   @RF00527                                            0527
*                      YC=ON;                                      0528
         OI    YC,B'00001000'                                      0528
*                    ELSE                                          0529
*                      IF FAULT2='98'X THEN                        0529
         B     @RC00527                                            0529
@RF00527 CLI   FAULT2,X'98'                                        0529
         BNE   @RF00529                                            0529
*                        YD=ON;                                    0530
         OI    YD,B'00000100'                                      0530
*                      ELSE                                        0531
*                        IF FAULT2='94'X THEN                      0531
         B     @RC00529                                            0531
@RF00529 CLI   FAULT2,X'94'                                        0531
         BNE   @RF00531                                            0531
*                          YE=ON;                                  0532
         OI    YE,B'00000010'                                      0532
*                        ELSE                                      0533
*                          IF FAULT2='96'X THEN                    0533
         B     @RC00531                                            0533
@RF00531 CLI   FAULT2,X'96'                                        0533
         BNE   @RF00533                                            0533
*                            YF=ON;                                0534
         OI    YF,B'00000001'                                      0534
*    END;                                                          0535
@RF00533 DS    0H                                                  0535
@RC00531 DS    0H                                                  0535
@RC00529 DS    0H                                                  0535
@RC00527 DS    0H                                                  0535
@RC00525 DS    0H                                                  0535
@RC00523 DS    0H                                                  0535
@RC00521 DS    0H                                                  0535
@RC00519 DS    0H                                                  0535
@RC00517 DS    0H                                                  0535
@RC00515 DS    0H                                                  0535
@RC00513 LA    @05,1                                               0535
         AH    @05,Z                                               0535
         STH   @05,Z                                               0535
@DE00511 CH    @05,INTABLE                                         0535
         BNH   @DL00511                                            0535
*    MAINMDC(A,TWO)=(MAINMDC(A,TWO)×BYTE);/* FINISH EAC               *
         LH    @05,A                                               0536
         MH    @05,@CH00081                                        0536
         AH    @05,TWO                                             0536
         ALR   @05,@05                                             0536
         LA    @01,MAINMDC-14(@05)                                 0536
         OC    0(2,@01),BYTE                                       0536
*    CALL PRTHEAD(TWO);              /* PRINT OUR RESULT              *
         LA    @01,@AL00537                                        0537
         BAL   @14,PRTHEAD                                         0537
*    END DOFCI;                                                    0538
@EL00012 DS    0H                                                  0538
@EF00012 DS    0H                                                  0538
@ER00012 LM    @14,@12,@SA00012                                    0538
         BR    @14                                                 0538
* /*******************************************************************/
* /*                        DOSV                                      *
* /*   THIS PROC WILL PROCESS ALL GROUP 3 ENTRIES.  2 EAC'S CAN BE    *
* /*    PRODUCED FOR EACH UNIQUE CUA. 1 FOR ALL ENTRIES 1 FOR ALL WITH*
* /*    EVD BIT ON .   ALSO ONE LINE FOR EACH RECORD WILL BE BUILT    *
* /*    IN A SUMMARY TABLE.                                           *
* /*    EAC:  IS 4 HEX CHARACTERS .                                   *
* /*          CHARACTER 1 IS COMPOSED OF BITS Y0,Y1,Y2 & Y3           *
* /*          CHARACTER 2- 4 IS BUILT AS 1.  ITEM ANSWER IS USED      *
* /*    SUMMARY TABLE:   EACH RECORD WILL HAVE 1 ENTRY IN THE TABLE   *
* /*                                                                  *
*DOSV:                                                             0539
*    PROC;                                                         0539
DOSV     STM   @14,@12,@SA00013                                    0539
*    IF SWITCH3=OFF THEN             /* DOING THE MAIN GROUP          *
         TM    SWITCH3,B'00001000'                                 0540
         BNZ   @RF00540                                            0540
*      CALL READREC(ALLCOUNT(A,THREE));/* READ THIS GROUP RECORDS     *
         LH    @05,A                                               0541
         MH    @05,@CH00081                                        0541
         AH    @05,THREE                                           0541
         ALR   @05,@05                                             0541
         LA    @05,ALLCOUNT-14(@05)                                0541
         ST    @05,@AL00001                                        0541
         LA    @01,@AL00001                                        0541
         BAL   @14,READREC                                         0541
*    ELSE                                                          0542
*      INTABLE=EVDCOUNT(A,THREE);    /* DOING THE EVD PASS            *
         B     @RC00540                                            0542
@RF00540 LH    @05,A                                               0542
         MH    @05,@CH00081                                        0542
         AH    @05,THREE                                           0542
         ALR   @05,@05                                             0542
         LH    @05,EVDCOUNT-14(@05)                                0542
         STH   @05,INTABLE                                         0542
*    BYTE='0000'X;                   /* CLEAR BYTE FOR NEW EAC        *
@RC00540 MVC   BYTE(2),@CB00208                                    0543
*    CALL DOSV1;                     /* PARM USED AS CALL WILL BE DIFF
*                                       NEXT TIME                     *
         BAL   @14,DOSV1                                           0544
*    IF SWITCH3=OFF THEN             /* DOING THE MAIN GROUP          *
         TM    SWITCH3,B'00001000'                                 0545
         BNZ   @RF00545                                            0545
*      MAINMDC(A,THREE)=(MAINMDC(A,THREE)×BYTE);/* SET THE MAIN EAC   *
         LH    @05,A                                               0546
         MH    @05,@CH00081                                        0546
         AH    @05,THREE                                           0546
         ALR   @05,@05                                             0546
         LA    @01,MAINMDC-14(@05)                                 0546
         OC    0(2,@01),BYTE                                       0546
*    ELSE                                                          0547
*      EVDMDC(A,THREE)=(EVDMDC(A,THREE)×BYTE);/* SET EVD EAC TABLE    *
         B     @RC00545                                            0547
@RF00545 LH    @05,A                                               0547
         MH    @05,@CH00081                                        0547
         AH    @05,THREE                                           0547
         ALR   @05,@05                                             0547
         LA    @01,EVDMDC-14(@05)                                  0547
         OC    0(2,@01),BYTE                                       0547
*    CALL PRTHEAD(THREE);            /* PRINT THE EAC LINE            *
@RC00545 LA    @01,@AL00548                                        0548
         BAL   @14,PRTHEAD                                         0548
*    IF SWITCH3=ON&ALLCOUNT(A,THREE)=EVDCOUNT(A,THREE) THEN        0549
         TM    SWITCH3,B'00001000'                                 0549
         BNO   @RF00549                                            0549
         LH    @05,A                                               0549
         MH    @05,@CH00081                                        0549
         AH    @05,THREE                                           0549
         ALR   @05,@05                                             0549
         LH    @15,ALLCOUNT-14(@05)                                0549
         CH    @15,EVDCOUNT-14(@05)                                0549
         BNE   @RF00549                                            0549
*      DO;                                                         0550
*        PRTLINE=ALLEQUAL;                                         0551
         MVI   PRTLINE+41,C' '                                     0551
         MVC   PRTLINE+42(90),PRTLINE+41                           0551
         MVC   PRTLINE(41),ALLEQUAL                                0551
*        CALL PRINTIT;                                             0552
         BAL   @14,PRINTIT                                         0552
*      END;                                                        0553
*    ELSE                                                          0554
*      CALL BUILDSUM;                /* PRINT THE MODIFERS            *
         B     @RC00549                                            0554
@RF00549 BAL   @14,BUILDSUM                                        0554
*    SWITCH3=OFF;                    /* CLEAR FOR THE NEXT EVD        *
@RC00549 NI    SWITCH3,B'11110111'                                 0555
*    END DOSV;                                                     0556
@EL00013 DS    0H                                                  0556
@EF00013 DS    0H                                                  0556
@ER00013 LM    @14,@12,@SA00013                                    0556
         BR    @14                                                 0556
* /*******************************************************************/
* /*                         DOSV1                                    *
* /*   THIS PROC WILL BUILD THE EAC FOR GROUP 3 RECORD.  IT WILL BE   *
* /*   CALLED TWICE ONCE TO PROCESS ALL GROUP 3 ONCE FOR GROUP 3 WITH *
* /*   JUST THE EVD DATA BIT ON.   THESE RECORDS WILL BE AT THE TOP OF*
* /*   THE SENSE BYTE TABLE.  THIS IS DO TO THE INITIAL SORT IN THE   *
* /*   MAIN PROGRAM.                                                  *
*DOSV1:                                                            0557
*    PROC;                                                         0557
DOSV1    STM   @14,@12,@SA00014                                    0557
*    SVZERO=SVZERO&&SVZERO;          /* CLEAR FOLLOWING FLAGS         *
         XC    SVZERO(6),SVZERO                                    0558
* /*INTERDIF = OFF         FLAG FOR INTERGALS BEING SB5'S ^=          *
* /*MIXISMIX = OFF         DIFFERENT PAIRS ARE MIXED IN > 2           *
* /*DIFFINTR = OFF         FLAG FOR INTERGALS BETWEEN SB5 & SB10 ^=   *
* /*MIXMORE2 = OFF         DIFFERENT PAIRS ARE BOTH > 2               *
* /*MIXLESS3 = OFF         DIFFERENT PAIRS OF INTERGALS ARE < 3       *
* /*DIFSB10R = OFF         SB10 REMAINDERS ARE DIFFERENT              *
* /*REMAINDF = OFF         FLAG FOR THE REMAINDERS BEING DIFFERENT    *
* /*PAIRMIX  = OFF         INTERGALS OF 24^= 24 OR 25 ^= 25           *
* /*OVERFLAG CHAR(2) ALSO CLEARED                                     *
* /*BYTESEQF CHAR(2) ALSO CLEARED                                     *
*    SVZERO1=SVZERO1&&SVZERO1;       /* THENUMB,SAVER33, NONZERO,  0559
*                                       SAVEFOR3,SAVEFOR4,SAVEFOR5 = 0*
         XC    SVZERO1(12),SVZERO1                                 0559
*    DO B=1 BY 1 TO INTABLE;         /* PROCESS ALL RECORDS READ      *
         LA    @05,1                                               0560
         STH   @05,B                                               0560
         B     @DE00560                                            0560
@DL00560 DS    0H                                                  0561
*      IF BYTE5(B)^=BYTE10(B) THEN   /* SB5 & 10 = FOR ALL RECORDS    *
         L     @15,SENSEPTR                                        0561
         MH    @05,@CH00042                                        0561
         ST    @05,@TF00001                                        0561
         ALR   @05,@15                                             0561
         AL    @05,@CF01875                                        0561
         AL    @15,@TF00001                                        0561
         AL    @15,@CF01876                                        0561
         CLC   BYTE5-8(1,@05),BYTE10-13(@15)                       0561
         BE    @RF00561                                            0561
*        THENUMBR=THENUMBR+1;                                      0562
         LH    @05,THENUMBR                                        0562
         LA    @05,1(,@05)                                         0562
         STH   @05,THENUMBR                                        0562
*    END;                                                          0563
@RF00561 LA    @05,1                                               0563
         AH    @05,B                                               0563
         STH   @05,B                                               0563
@DE00560 CH    @05,INTABLE                                         0563
         BNH   @DL00560                                            0563
*    IF THENUMBR^=ZERO THEN          /* 5 & 10 MISCOMPARED SOME REC   *
         LH    @05,THENUMBR                                        0564
         LTR   @05,@05                                             0564
         BZ    @RF00564                                            0564
*      CALL NOTEQUAL;                /* PROCESS REC WITH BYTE 5&10^=  *
         BAL   @14,NOTEQUAL                                        0565
*    ELSE                                                          0566
*      CALL BYTESEQ;                 /* ALL SB5 MATCHED SB10 IN THE
*                                       SAME RECORD THIS CUA          *
         B     @RC00564                                            0566
@RF00564 BAL   @14,BYTESEQ                                         0566
*    IF DEBUG61=ON THEN              /* DUMP ALL FLAGS & COUNTERS     *
@RC00564 TM    DEBUG61(R2),B'00000100'                             0567
         BNO   @RF00567                                            0567
*      DO;                                                         0568
*        CALL CONVERT1(TWO,PRT0,ADDR(SVFLAGS));                    0569
         LA    @05,SVFLAGS                                         0569
         ST    @05,@AFTEMPS+12                                     0569
         LA    @01,@AL00569                                        0569
         BAL   @14,CONVERT1                                        0569
*        CALL CONVERT1(FOUR1,PRT6,ADDR(BYTESEQF));                 0570
         LA    @05,BYTESEQF                                        0570
         ST    @05,@AFTEMPS+12                                     0570
         LA    @01,@AL00570                                        0570
         BAL   @14,CONVERT1                                        0570
*        CALL CONVERT1(TWO,PRT17,ADDR(OVERFLAG));                  0571
         LA    @05,OVERFLAG                                        0571
         ST    @05,@AFTEMPS+12                                     0571
         LA    @01,@AL00571                                        0571
         BAL   @14,CONVERT1                                        0571
*        CALL CONVBIN(3,THENUMBR,PRT25);                           0572
         LA    @01,@AL00572                                        0572
         BAL   @14,CONVBIN                                         0572
*        CALL CONVBIN(3,SAVER33,PRT32);                            0573
         LA    @01,@AL00573                                        0573
         BAL   @14,CONVBIN                                         0573
*        CALL CONVBIN(3,R33,PRT39);                                0574
         LA    @01,@AL00574                                        0574
         BAL   @14,CONVBIN                                         0574
*        CALL CONVBIN(3,SAVER4,PRT46);                             0575
         LA    @01,@AL00575                                        0575
         BAL   @14,CONVBIN                                         0575
*        CALL CONVBIN(3,SAVER44,PRT58);                            0576
         LA    @01,@AL00576                                        0576
         BAL   @14,CONVBIN                                         0576
*        CALL PRINTIT;                                             0577
         BAL   @14,PRINTIT                                         0577
*      END;                                                        0578
*    END DOSV1;                                                    0579
@EL00014 DS    0H                                                  0579
@EF00014 DS    0H                                                  0579
@ER00014 LM    @14,@12,@SA00014                                    0579
         BR    @14                                                 0579
* /*******************************************************************/
* /*    THIS PROC WILL PROCESS ALL RECORDS WHERE SB 5 & 10 ^=         *
*NOTEQUAL:                                                         0580
*    PROC;                                                         0580
NOTEQUAL STM   @14,@12,@SA00015                                    0580
*    IF INTABLE>ONE THEN             /* > 1 RECORD TO SORT            *
         LH    @05,INTABLE                                         0581
         CH    @05,ONE                                             0581
         BNH   @RF00581                                            0581
*      DO C=1 BY 1 TO INTABLE-1;     /* SORT ALL SB5 ^= 10 TO TOP OF
*                                       TABLE                         *
         LA    @05,1                                               0582
         STH   @05,C                                               0582
         B     @DE00582                                            0582
@DL00582 DS    0H                                                  0583
*        DO B=C+1 BY ONE TO INTABLE;                               0583
         AH    @05,@CH00057                                        0583
         B     @DE00583                                            0583
@DL00583 DS    0H                                                  0584
*          IF(BYTE5(B)^=BYTE10(B))&(BYTE5(C)=BYTE10(C)) THEN       0584
         L     @15,SENSEPTR                                        0584
         LA    @14,31                                              0584
         LR    @01,@05                                             0584
         MR    @00,@14                                             0584
         ST    @01,@TF00001                                        0584
         ALR   @01,@15                                             0584
         AL    @01,@CF01875                                        0584
         LR    @05,@15                                             0584
         AL    @05,@TF00001                                        0584
         AL    @05,@CF01876                                        0584
         CLC   BYTE5-8(1,@01),BYTE10-13(@05)                       0584
         BE    @RF00584                                            0584
         MH    @14,C                                               0584
         ST    @14,@TF00001                                        0584
         ALR   @14,@15                                             0584
         AL    @14,@CF01875                                        0584
         AL    @15,@TF00001                                        0584
         AL    @15,@CF01876                                        0584
         CLC   BYTE5-8(1,@14),BYTE10-13(@15)                       0584
         BNE   @RF00584                                            0584
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        0585
*        END;                                                      0586
@RF00584 LH    @05,B                                               0586
         AH    @05,ONE                                             0586
@DE00583 STH   @05,B                                               0586
         CH    @05,INTABLE                                         0586
         BNH   @DL00583                                            0586
*      END;                                                        0587
         LA    @05,1                                               0587
         AH    @05,C                                               0587
         STH   @05,C                                               0587
@DE00582 LH    @15,INTABLE                                         0587
         BCTR  @15,0                                               0587
         CR    @05,@15                                             0587
         BNH   @DL00582                                            0587
*    DO B=1 BY 1 TO THENUMBR;        /* # OF SB ^=-AT TOP OF TABLE    *
@RF00581 LA    @05,1                                               0588
         STH   @05,B                                               0588
         B     @DE00588                                            0588
@DL00588 DS    0H                                                  0589
*      R33=DIVIDE24(B);              /* SAVE BAL INSTRUCTIONS         *
         L     @15,SENSEPTR                                        0589
         MH    @05,@CH00042                                        0589
         LA    @01,0(@05,@15)                                      0589
         AL    @01,@CF01877                                        0589
         SLR   @00,@00                                             0589
         IC    @00,DIVIDE24-27(,@01)                               0589
         STH   @00,R33                                             0589
*      R4=DIVIDE26(B);               /* SAVE BAL INSTRUCTIONS         *
         BCTR  @15,0                                               0590
         BCTR  @15,0                                               0590
         SLR   R4,R4                                               0590
         IC    R4,DIVIDE26-29(@05,@15)                             0590
*      IF R33^=R4 THEN               /* INTERGALS OF SB5 & 10 ^=      *
         CR    @00,R4                                              0591
         BE    @RF00591                                            0591
*        DO;                                                       0592
*          IF(R33<3&R4<3) THEN       /* BOTH ARE LESS THAN 3          *
         LA    @05,3                                               0593
         CR    @00,@05                                             0593
         BNL   @RF00593                                            0593
         CR    R4,@05                                              0593
         BNL   @RF00593                                            0593
*            MIXLESS3=ON;            /* BOTH INTERGALS ARE < THAN 3   *
         OI    MIXLESS3,B'00001000'                                0594
*          ELSE                                                    0595
*            IF(R33>2&R4>2) THEN     /* BOTH ARE GREATER THAN 2       *
         B     @RC00593                                            0595
@RF00593 LA    @05,2                                               0595
         CH    @05,R33                                             0595
         BNL   @RF00595                                            0595
         CR    R4,@05                                              0595
         BNH   @RF00595                                            0595
*              MIXMORE2=ON;          /* BOTH ARE MORE THAN 2          *
         OI    MIXMORE2,B'00010000'                                0596
*            ELSE                                                  0597
*              MIXISMIX=ON;          /* ONE IS MORE THAN 2            *
         B     @RC00595                                            0597
@RF00595 OI    MIXISMIX,B'01000000'                                0597
*          DIFFINTR=ON;              /* FLAG SB5 & 10 ARE NOT EQUAL   *
@RC00595 DS    0H                                                  0598
@RC00593 OI    DIFFINTR,B'00100000'                                0598
*        END;                                                      0599
*      IF B^=1 THEN                  /* 2 RECORDS FOR THESE CHECKS    *
@RF00591 LH    @05,B                                               0600
         CH    @05,@CH00057                                        0600
         BE    @RF00600                                            0600
*        DO;                                                       0601
*          IF DIVIDE24(B-1)^=R33 THEN/* INTERGALS PAST & PRESENT =    *
         MH    @05,@CH00042                                        0602
         L     @01,SENSEPTR                                        0602
         AL    @01,@CF01878                                        0602
         SLR   @00,@00                                             0602
         IC    @00,DIVIDE24-27(@05,@01)                            0602
         CH    @00,R33                                             0602
         BE    @RF00602                                            0602
*            INTERDIF=ON;            /* NO SET FLAG SAYING SO         *
         OI    INTERDIF,B'10000000'                                0603
*          IF DIVIDE24(B-1)^=R33×DIVIDE26(B-1)^=R4 THEN            0604
@RF00602 L     @05,SENSEPTR                                        0604
         LH    @15,B                                               0604
         MH    @15,@CH00042                                        0604
         LA    @01,0(@15,@05)                                      0604
         AL    @01,@CF01878                                        0604
         SLR   @00,@00                                             0604
         IC    @00,DIVIDE24-27(,@01)                               0604
         CH    @00,R33                                             0604
         BNE   @RT00604                                            0604
         ALR   @05,@15                                             0604
         AL    @05,@CF01879                                        0604
         MVC   @ZT00003+3(1),DIVIDE26-29(@05)                      0604
         C     R4,@ZT00003                                         0604
         BE    @RF00604                                            0604
@RT00604 DS    0H                                                  0605
*            PAIRMIX=ON;             /* HAD DIFFERENT PAIRS           *
         OI    PAIRMIX,B'00000001'                                 0605
*        END;                                                      0606
@RF00604 DS    0H                                                  0607
*      IF DIVIDE25(B)^=DIVIDE27(B) THEN/* CHECK THE REMAINDERS        *
@RF00600 L     @05,SENSEPTR                                        0607
         LH    @15,B                                               0607
         MH    @15,@CH00042                                        0607
         ST    @15,@TF00001                                        0607
         ALR   @15,@05                                             0607
         AL    @15,@CF01880                                        0607
         AL    @05,@TF00001                                        0607
         BCTR  @05,0                                               0607
         CLC   DIVIDE25-28(1,@15),DIVIDE27-30(@05)                 0607
         BE    @RF00607                                            0607
*        REMAINDF=ON;                /* REMAINDERS OF 5 & 10 ARE ^=   *
         OI    REMAINDF,B'00000010'                                0608
*    END;                                                          0609
@RF00607 LA    @05,1                                               0609
         AH    @05,B                                               0609
         STH   @05,B                                               0609
@DE00588 CH    @05,THENUMBR                                        0609
         BNH   @DL00588                                            0609
*    IF DIFFINTR=OFF THEN            /* COMPARED FOR ALL RECORDS      *
         TM    DIFFINTR,B'00100000'                                0610
         BNZ   @RF00610                                            0610
*      IF INTERDIF=OFF THEN          /* SB5'S INTERGALS ARE ^ =       *
         TM    INTERDIF,B'10000000'                                0611
         BNZ   @RF00611                                            0611
*        BYTE=('0110'X×R33);         /* SELECT ERROR IN SINGLE AE  0612
*                                       MODULE R33 = MODULE #         *
         LA    @05,272                                             0612
         LH    @15,R33                                             0612
         OR    @05,@15                                             0612
         ST    @05,@TF00001                                        0612
         MVC   BYTE(2),@TF00001+2                                  0612
*      ELSE                                                        0613
*        BYTE='011F'X;                                             0613
         B     @RC00611                                            0613
@RF00611 MVC   BYTE(2),@CB01653                                    0613
*    ELSE                                                          0614
*      DO;                                                         0614
         B     @RC00610                                            0614
@RF00610 DS    0H                                                  0615
*        IF REMAINDF=ON THEN         /* REMAINDERS ARE NOT =          *
         TM    REMAINDF,B'00000010'                                0615
         BNO   @RF00615                                            0615
*          BYTE='0130'X;             /* RANDOM PATTERN OF SELECT   0616
*                                       MISCOMP                       *
         MVC   BYTE(2),@CB01654                                    0616
*        ELSE                                                      0617
*          DO;                                                     0617
         B     @RC00615                                            0617
@RF00615 DS    0H                                                  0618
*            IF PAIRMIX=ON THEN      /* SB5'S × SB10'S ^= TO PREV     *
         TM    PAIRMIX,B'00000001'                                 0618
         BNO   @RF00618                                            0618
*              BYTE='0124'X;         /* RANDOM MODULE MISSELECTION    *
         MVC   BYTE(2),@CB01655                                    0619
*            ELSE                                                  0620
*              IF MIXISMIX=ON THEN                                 0620
         B     @RC00618                                            0620
@RF00618 TM    MIXISMIX,B'01000000'                                0620
         BNO   @RF00620                                            0620
*                BYTE='0123'X;       /* MOVE/FIXED HEAD SELECT ERROR  *
         MVC   BYTE(2),@CB01656                                    0621
*              ELSE                                                0622
*                IF MIXLESS3=ON THEN                               0622
         B     @RC00620                                            0622
@RF00620 TM    MIXLESS3,B'00001000'                                0622
         BNO   @RF00622                                            0622
*                  BYTE='0121'X;     /* MOVEABLE HEAD                 *
         MVC   BYTE(2),@CB01657                                    0623
*                ELSE                                              0624
*                  BYTE='0122'X;     /* FIXED HEAD                    *
         B     @RC00622                                            0624
@RF00622 MVC   BYTE(2),@CB01658                                    0624
*          END;                                                    0625
*      END;                                                        0626
*    END NOTEQUAL;                                                 0627
@EL00015 DS    0H                                                  0627
@EF00015 DS    0H                                                  0627
@ER00015 LM    @14,@12,@SA00015                                    0627
         BR    @14                                                 0627
* /*******************************************************************/
* /*                         BYTESEQ                                  *
* /*   THIS PROC WILL PROCESS ALL GROUP 3 ENTRIES WHERE SENSE BYTE 5  *
* /*   AND SENSE BYTE 10 AGREE                                        *
* /*  THE FOLLOWING FLAGS ARE IN ITEM  BYTESEQF                       *
* /*   BIT4EQ7 BIT4 IN SB17 = BIT 7 SB 4 ANY RECORD                   *
* /*   MIXOVRUN OVERSHOT RECORD                                       *
* /*   OVERANY ON IF AN OVERSHOOT IN ANY RECORD                       *
* /*   UNDERSUM USE WITH OVERANY FOR MIX OF OVERSHOT                  *
* /*   GRTHANFF 1 RECORD > THAN A 'FF'X VALUE                         *
* /*   SUMS        ON IF SB18 BIT 1 &  2 &  SB19 ^= ZERO IN ANY RECORD*
* /*   TSUM  OPP OF ABOVE ONLY RESET EACH RECORD                      *
* /*   SB89NOTZ           SENSE BYTE 8-9 NOT ZERO ANY RECORD          *
* /*   TOTALCM            ON IF IN ALL RECORD SB19 + 256 IF SB18   0628
*                            BIT 2 = ON + 512 IF SB18 BIT 1 = ON = 0628
*                            SB8-9                                    *
* /*   RANDOM             DIFFERENCES BETWEEN SB89 & 34 ARE RANDOM 0628
*                            OR > 'FF'X                               *
* /*   BY89ZERO    WHERE TOTALCM WAS SET WAS BYTES89 = ZERO           *
* /*   DIFFLESS           DIFFERENCE IS LESS THAN 256                 *
* /*   SUMS1       USED TO DETERMIN ALL BYTE19 = ZERO                 *
* /*   RANDOM3            GROUP3 ANSWERS FOR ANSWER = X3XX            *
* /*   RANDOM4            GROUP4 ANSWERS FOR ANSWER = X4XX            *
* /*   RANDOM5            GROUP5 ANSWERS FOR ANSWER = X5XX            *
* /*   GRTHNFF3           GR3 DIFF SB3-4 & SB8-9 > 'FF'X              *
* /*   GRTHNFF4             " ONLY FOR ANSWER = -4XX                  *
* /*   GRTHNFF5             " ONLY ANSWER = -5XX                      *
*BYTESEQ:                                                          0628
*    PROC;                                                         0628
BYTESEQ  STM   @14,@12,@SA00016                                    0628
*    DO B=1 BY 1 TO INTABLE;         /* INTABLE = # REC READ THIS CUA *
         LA    @05,1                                               0629
         STH   @05,B                                               0629
         B     @DE00629                                            0629
@DL00629 DS    0H                                                  0630
*      IF(BIT174(B)=ON&BIT47(B)=ON)×(BIT174(B)=OFF&BIT47(B)=OFF) THEN
         L     @15,SENSEPTR                                        0630
         MH    @05,@CH00042                                        0630
         ST    @05,@TF00001                                        0630
         ALR   @05,@15                                             0630
         AL    @05,@CF01858                                        0630
         TM    BIT174-20(@05),B'00001000'                          0630
         BNO   @GL00038                                            0630
         AL    @15,@TF00001                                        0630
         AL    @15,@CF01881                                        0630
         TM    BIT47-7(@15),B'00000001'                            0630
         BO    @RT00630                                            0630
@GL00038 L     @05,SENSEPTR                                        0630
         LH    @15,B                                               0630
         MH    @15,@CH00042                                        0630
         ST    @15,@TF00001                                        0630
         ALR   @15,@05                                             0630
         AL    @15,@CF01858                                        0630
         TM    BIT174-20(@15),B'00001000'                          0630
         BNZ   @RF00630                                            0630
         AL    @05,@TF00001                                        0630
         AL    @05,@CF01881                                        0630
         TM    BIT47-7(@05),B'00000001'                            0630
         BNZ   @RF00630                                            0630
@RT00630 DS    0H                                                  0631
*        BIT4EQ7=ON;                 /* KNOW ANSWER WILL BE 0200      *
         OI    BIT4EQ7,B'10000000'                                 0631
*      IF BIT180(B)=OFF THEN         /* TEST FOR OVER SHOOT           *
@RF00630 L     @05,SENSEPTR                                        0632
         LH    @15,B                                               0632
         MH    @15,@CH00042                                        0632
         ST    @15,@TF00001                                        0632
         ALR   @15,@05                                             0632
         AL    @15,@CF01882                                        0632
         TM    BIT180-21(@15),B'10000000'                          0632
         BNZ   @RF00632                                            0632
*        DO;                         /* NOTE HEAD CAN BE COMMING OR
*                                       GOING IE REQUIRES 2 CHECKS FOR
*                                       OVERSHOOT                     *
*          IF BYTE0304(B)>BYTE0809(B) THEN/* IS BYTE 3-4 > THAN 8-9   *
         LR    @01,@05                                             0634
         AL    @01,@TF00001                                        0634
         AL    @01,@CF01883                                        0634
         AL    @05,@TF00001                                        0634
         AL    @05,@CF01871                                        0634
         CLC   BYTE0304-6(2,@01),BYTE0809-11(@05)                  0634
         BNH   @RF00634                                            0634
*            OVERANY=ON;             /* ONE RECORD WITH OVERSHOT      *
         OI    OVERANY,B'00100000'                                 0635
*          ELSE                                                    0636
*            UNDERSUM=ON;            /* ONE RECORD WITH AN UNDERSHOT  *
         B     @RC00634                                            0636
@RF00634 OI    UNDERSUM,B'00010000'                                0636
*        END;                                                      0637
*      ELSE                                                        0638
*        DO;                                                       0638
         B     @RC00632                                            0638
@RF00632 DS    0H                                                  0639
*          IF BYTE0304(B)<BYTE0809(B) THEN/* IS BYTE 3-4 LESS THAN 8-9*
         L     @05,SENSEPTR                                        0639
         LH    @15,B                                               0639
         MH    @15,@CH00042                                        0639
         ST    @15,@TF00001                                        0639
         ALR   @15,@05                                             0639
         AL    @15,@CF01883                                        0639
         AL    @05,@TF00001                                        0639
         AL    @05,@CF01871                                        0639
         CLC   BYTE0304-6(2,@15),BYTE0809-11(@05)                  0639
         BNL   @RF00639                                            0639
*            OVERANY=ON;             /* 1 RECORD WITH OVERSHOOT       *
         OI    OVERANY,B'00100000'                                 0640
*          ELSE                                                    0641
*            UNDERSUM=ON;            /* 1 RECORD WITH AN UNDERSHOOT   *
         B     @RC00639                                            0641
@RF00639 OI    UNDERSUM,B'00010000'                                0641
*        END;                                                      0642
@RC00639 DS    0H                                                  0643
*      R33=BYTE19(B);                /* EXTRACT BYTE 19 TO SAVE BAL   *
@RC00632 L     @05,SENSEPTR                                        0643
         LH    @15,B                                               0643
         MH    @15,@CH00042                                        0643
         LA    @01,0(@15,@05)                                      0643
         AL    @01,@CF01857                                        0643
         SLR   @00,@00                                             0643
         IC    @00,BYTE19-22(,@01)                                 0643
         STH   @00,R33                                             0643
*      IF BIT182(B)=ON THEN          /* THIS BIT & 181 ARE AN      0644
*                                       EXTENTION OF BYTE 19          *
         ALR   @05,@15                                             0644
         AL    @05,@CF01882                                        0644
         TM    BIT182-21(@05),B'00100000'                          0644
         BNO   @RF00644                                            0644
*        R33=R33+256;                                              0645
         AH    @00,@CH01112                                        0645
         STH   @00,R33                                             0645
*      IF BIT181(B)=ON THEN          /* BYTE 18 BIT 1 IS = TO 512     *
@RF00644 LH    @05,B                                               0646
         MH    @05,@CH00042                                        0646
         L     @01,SENSEPTR                                        0646
         ALR   @01,@05                                             0646
         AL    @01,@CF01882                                        0646
         TM    BIT181-21(@01),B'01000000'                          0646
         BNO   @RF00646                                            0646
*        R33=R33+512;                                              0647
         LH    @05,R33                                             0647
         LA    @05,512(,@05)                                       0647
         STH   @05,R33                                             0647
*      R4=ABS(BYTE0809(B)-BYTE0304(B));                            0648
@RF00646 L     @15,SENSEPTR                                        0648
         LH    @14,B                                               0648
         MH    @14,@CH00042                                        0648
         ST    @14,@TF00001                                        0648
         ALR   @14,@15                                             0648
         AL    @14,@CF01871                                        0648
         MVC   @ZT00002+2(2),BYTE0809-11(@14)                      0648
         L     R4,@ZT00002                                         0648
         AL    @15,@TF00001                                        0648
         AL    @15,@CF01883                                        0648
         MVC   @ZT00002+2(2),BYTE0304-6(@15)                       0648
         SL    R4,@ZT00002                                         0648
         LPR   R4,R4                                               0648
*      SAVER4=R4;                    /* KEEP FOR NEXT PROC            *
         STH   R4,SAVER4                                           0649
*      IF R4>'FF'X THEN                                            0650
         CH    R4,@CH00279                                         0650
         BNH   @RF00650                                            0650
*        GRTHANFF=ON;                /* GREATER THAN A FF HEX VALUE
*                                       FLAG                          *
         OI    GRTHANFF,B'00001000'                                0651
*      IF R33=ZERO THEN                                            0652
@RF00650 LH    @05,R33                                             0652
         LTR   @05,@05                                             0652
         BNZ   @RF00652                                            0652
*        SUMS=ON;                    /* SET TO INDICATE A ZERO     0653
*                                       CONDITION                     *
         OI    SUMS,B'00000100'                                    0653
*      ELSE                                                        0654
*        CALL B19NOT0;                                             0654
         B     @RC00652                                            0654
@RF00652 BAL   @14,B19NOT0                                         0654
*      IF B^=1 THEN                  /* MUST HAVE TWO ENTRIES FOR THIS
*                                       CHECK                         *
@RC00652 CLC   B(2),@CH00057                                       0655
         BE    @RF00655                                            0655
*        IF R4^=TEMPSV THEN          /* ARE ENTRIES THE SAME          *
         CH    R4,TEMPSV                                           0656
         BE    @RF00656                                            0656
*          RANDOM=ON;                /* NO SET THE FLAG SAYING SO     *
         OI    RANDOM,B'01000000'                                  0657
*        ELSE                                                      0658
*          ;                                                       0658
@RF00656 DS    0H                                                  0659
*      ELSE                                                        0659
*        TEMPSV=R4;                  /* SAVE FOR THE NEXT TIME        *
         B     @RC00655                                            0659
@RF00655 STH   R4,TEMPSV                                           0659
*    END;                                                          0660
@RC00655 LA    @05,1                                               0660
         AH    @05,B                                               0660
         STH   @05,B                                               0660
@DE00629 CH    @05,INTABLE                                         0660
         BNH   @DL00629                                            0660
*    IF BIT4EQ7=ON THEN                                            0661
         TM    BIT4EQ7,B'10000000'                                 0661
         BNO   @RF00661                                            0661
*      BYTE='0200'X;                                               0662
         MVC   BYTE(2),@CB01664                                    0662
*    ELSE                                                          0663
*      IF OVERANY=ON THEN            /* ARE ANY OVERSHOOT RECORDS  0663
*                                       AROUND                        *
         B     @RC00661                                            0663
@RF00661 TM    OVERANY,B'00100000'                                 0663
         BNO   @RF00663                                            0663
*        CALL OVERSHOT;              /* AT LEAST 1 RECORD WITH AN  0664
*                                       OVERSHOOT                     *
         BAL   @14,OVERSHOT                                        0664
*      ELSE                                                        0665
*        CALL UNDRSHOT;              /* NO RECORDS WITH AN OVERRUN 0665
*                                       CONDITION                     *
         B     @RC00663                                            0665
@RF00663 BAL   @14,UNDRSHOT                                        0665
*    END BYTESEQ;                                                  0666
@EL00016 DS    0H                                                  0666
@EF00016 DS    0H                                                  0666
@ER00016 LM    @14,@12,@SA00016                                    0666
         BR    @14                                                 0666
* /*******************************************************************/
* /*    THIS PROC WILL PROCCESS REC WITH BYTE 19 ^= TO ZERO           *
* /*    AT ENTRY  R4    DIFFERENCE BETWEEN SB34 AND SB89              *
* /*              R33 = VALUE OF SB19 + BIT 1 & 2 FROM SB18           *
*B19NOT0:                                                          0667
*    PROC;                                                         0667
B19NOT0  STM   @14,@12,12(@13)                                     0667
*    NONZERO=NONZERO+1;              /* NONZERO COUNT                 *
         LH    @05,NONZERO                                         0668
         LA    @05,1(,@05)                                         0668
         STH   @05,NONZERO                                         0668
*    IF SAVEFOR3=ZERO THEN           /* FIRST TIME THROUGH            *
         LH    @05,SAVEFOR3                                        0669
         LTR   @05,@05                                             0669
         BNZ   @RF00669                                            0669
*      SAVEFOR3=R4;                  /* SAVE FOR NEXT TIME THROUGH    *
         STH   R4,SAVEFOR3                                         0670
*    ELSE                                                          0671
*      IF R4^=SAVEFOR3 THEN          /* ALL THE SAME                  *
         B     @RC00669                                            0671
@RF00669 CH    R4,SAVEFOR3                                         0671
         BE    @RF00671                                            0671
*        RANDOM3=ON;                                               0672
         OI    RANDOM3,B'00000100'                                 0672
*    SUMS1=ON;                       /* 1 NON ZERO RECORD FOUND       *
@RF00671 DS    0H                                                  0673
@RC00669 OI    SUMS1,B'00001000'                                   0673
*    IF R4>'FF'X THEN                                              0674
         CH    R4,@CH00279                                         0674
         BNH   @RF00674                                            0674
*      GRTHNFF3=ON;                                                0675
         OI    GRTHNFF3,B'10000000'                                0675
*    IF R4=R33 THEN                                                0676
@RF00674 CH    R4,R33                                              0676
         BNE   @RF00676                                            0676
*      DO;                           /* THESE FLAGS SET ONLY FOR   0677
*                                       RECORDS WITH SB19 ^= 0        *
*        IF SAVEFOR5=ZERO THEN       /* FIRST TIME THROUGH            *
         LH    @05,SAVEFOR5                                        0678
         LTR   @05,@05                                             0678
         BNZ   @RF00678                                            0678
*          SAVEFOR5=R4;              /* SAVE FOR NEXT TIME THROUGH    *
         STH   R4,SAVEFOR5                                         0679
*        ELSE                                                      0680
*          IF R4^=SAVEFOR5 THEN      /* ALL THE SAME                  *
         B     @RC00678                                            0680
@RF00678 CH    R4,SAVEFOR5                                         0680
         BE    @RF00680                                            0680
*            RANDOM5=ON;                                           0681
         OI    RANDOM5,B'00000001'                                 0681
*        IF R4>'FF'X THEN                                          0682
@RF00680 DS    0H                                                  0682
@RC00678 CH    R4,@CH00279                                         0682
         BNH   @RF00682                                            0682
*          GRTHNFF5=ON;                                            0683
         OI    GRTHNFF5,B'00100000'                                0683
*        TOTALCM=ON;                 /* HAD A MATCH ON SOME RECORD    *
@RF00682 OI    TOTALCM,B'10000000'                                 0684
*        IF BYTE0809(B)^='0000'X THEN                              0685
         LH    @05,B                                               0685
         MH    @05,@CH00042                                        0685
         L     @01,SENSEPTR                                        0685
         ALR   @01,@05                                             0685
         AL    @01,@CF01871                                        0685
         CLC   BYTE0809-11(2,@01),@CB00208                         0685
         BE    @RF00685                                            0685
*          DO;                                                     0686
*            SB89NOTZ=ON;            /* SET FLAG FOR BYTE 8 & 9 ^= 0687
*                                       ZERO                          *
         OI    SB89NOTZ,B'00000001'                                0687
*            IF SAVEFOR4=ZERO THEN   /* FIRST TIME THROUGH            *
         LH    @05,SAVEFOR4                                        0688
         LTR   @05,@05                                             0688
         BNZ   @RF00688                                            0688
*              SAVEFOR4=R4;          /* SAVE FOR NEXT TIME THROUGH    *
         STH   R4,SAVEFOR4                                         0689
*            ELSE                                                  0690
*              IF R4^=SAVEFOR4 THEN  /* ALL THE SAME                  *
         B     @RC00688                                            0690
@RF00688 CH    R4,SAVEFOR4                                         0690
         BE    @RF00690                                            0690
*                RANDOM4=ON;                                       0691
         OI    RANDOM4,B'00000010'                                 0691
*            IF R4>'FF'X THEN                                      0692
@RF00690 DS    0H                                                  0692
@RC00688 CH    R4,@CH00279                                         0692
         BNH   @RF00692                                            0692
*              GRTHNFF4=ON;                                        0693
         OI    GRTHNFF4,B'01000000'                                0693
*          END;                                                    0694
@RF00692 DS    0H                                                  0695
*        SAVER44=R4;                                               0695
@RF00685 STH   R4,SAVER44                                          0695
*      END;                                                        0696
*    END B19NOT0;                                                  0697
@EL00017 DS    0H                                                  0697
@EF00017 DS    0H                                                  0697
@ER00017 LM    @14,@12,12(@13)                                     0697
         BR    @14                                                 0697
* /*******************************************************************/
* /*    THIS PROC WILL COMPLETE BUILDING 'BYTE' FOR ALL RECORDS       *
* /*    THAT SB5&10 ARE = AND NO OVERSHOOT CONDITION IS PRESENT       *
*UNDRSHOT:                                                         0698
*    PROC;                                                         0698
UNDRSHOT STM   @14,@12,12(@13)                                     0698
*    IF SUMS=ON&SUMS1=OFF THEN       /* ALL WERE                      *
         TM    SUMS,B'00000100'                                    0699
         BNO   @RF00699                                            0699
         TM    SUMS1,B'00001000'                                   0699
         BNZ   @RF00699                                            0699
*      DO;                                                         0700
*        IF GRTHANFF=ON×RANDOM=ON THEN                             0701
         TM    GRTHANFF,B'00001000'                                0701
         BO    @RT00701                                            0701
         TM    RANDOM,B'01000000'                                  0701
         BNO   @RF00701                                            0701
@RT00701 DS    0H                                                  0702
*          BYTE='0600'X;                                           0702
         MVC   BYTE(2),@CB01673                                    0702
*        ELSE                                                      0703
*          BYTE=(BYTE×SAVER4×'0600'X);/* S-4 = DIFF OF SB89 & SB34    *
         B     @RC00701                                            0703
@RF00701 LH    @05,SAVER4                                          0703
         MVC   @ZT00002+2(2),BYTE                                  0703
         O     @05,@ZT00002                                        0703
         O     @05,@CF01673                                        0703
         ST    @05,@TF00001                                        0703
         MVC   BYTE(2),@TF00001+2                                  0703
*      END;                                                        0704
*    ELSE                                                          0705
*      DO;                                                         0705
         B     @RC00699                                            0705
@RF00699 DS    0H                                                  0706
*        IF TOTALCM=OFF THEN         /* SB19 ^= TO ABS(SB0304 SB0809)
*                                       ANY REC                       *
         TM    TOTALCM,B'10000000'                                 0706
         BNZ   @RF00706                                            0706
*          DO;                                                     0707
*            IF GRTHNFF3=ON×RANDOM3=ON THEN                        0708
         TM    GRTHNFF3,B'10000000'                                0708
         BO    @RT00708                                            0708
         TM    RANDOM3,B'00000100'                                 0708
         BNO   @RF00708                                            0708
@RT00708 DS    0H                                                  0709
*              BYTE='0300'X;         /* RANDOM SELECTION OR ONE ='S
*                                       ZERO                          *
         MVC   BYTE(2),@CB01674                                    0709
*            ELSE                                                  0710
*              BYTE=('0300'X×SAVEFOR3);                            0710
         B     @RC00708                                            0710
@RF00708 LA    @05,768                                             0710
         LH    @15,SAVEFOR3                                        0710
         OR    @05,@15                                             0710
         ST    @05,@TF00001                                        0710
         MVC   BYTE(2),@TF00001+2                                  0710
*          END;                                                    0711
*        ELSE                                                      0712
*          DO;                                                     0712
         B     @RC00706                                            0712
@RF00706 DS    0H                                                  0713
*            IF SB89NOTZ=ON THEN     /* BYTE0809 ^= ZERO ANY RECORD   *
         TM    SB89NOTZ,B'00000001'                                0713
         BNO   @RF00713                                            0713
*              DO;                   /* UNDERSHOOT SEEK VERIFY ERROR  *
*                IF GRTHNFF4=ON×RANDOM4=ON THEN                    0715
         TM    GRTHNFF4,B'01000000'                                0715
         BO    @RT00715                                            0715
         TM    RANDOM4,B'00000010'                                 0715
         BNO   @RF00715                                            0715
@RT00715 DS    0H                                                  0716
*                  BYTE='0400'X;     /* MIX OF VALUES OR > THAN FF    *
         MVC   BYTE(2),@CB01675                                    0716
*                ELSE                                              0717
*                  BYTE=(BYTE×SAVEFOR4×'0400'X);                   0717
         B     @RC00715                                            0717
@RF00715 LH    @05,SAVEFOR4                                        0717
         MVC   @ZT00002+2(2),BYTE                                  0717
         O     @05,@ZT00002                                        0717
         O     @05,@CF01675                                        0717
         ST    @05,@TF00001                                        0717
         MVC   BYTE(2),@TF00001+2                                  0717
*              END;                                                0718
*            ELSE                                                  0719
*              DO;                   /* UNDERSHOOT SEEK VERIFY ERROR  *
         B     @RC00713                                            0719
@RF00713 DS    0H                                                  0720
*                IF GRTHNFF5=ON×RANDOM5=ON THEN                    0720
         TM    GRTHNFF5,B'00100000'                                0720
         BO    @RT00720                                            0720
         TM    RANDOM5,B'00000001'                                 0720
         BNO   @RF00720                                            0720
@RT00720 DS    0H                                                  0721
*                  BYTE='0500'X;                                   0721
         MVC   BYTE(2),@CB01676                                    0721
*                ELSE                                              0722
*                  BYTE=(BYTE×SAVEFOR5×'0500'X);                   0722
         B     @RC00720                                            0722
@RF00720 LH    @05,SAVEFOR5                                        0722
         MVC   @ZT00002+2(2),BYTE                                  0722
         O     @05,@ZT00002                                        0722
         O     @05,@CF01676                                        0722
         ST    @05,@TF00001                                        0722
         MVC   BYTE(2),@TF00001+2                                  0722
*              END;                                                0723
*          END;                                                    0724
*      END;                                                        0725
*    END UNDRSHOT;                                                 0726
@EL00018 DS    0H                                                  0726
@EF00018 DS    0H                                                  0726
@ER00018 LM    @14,@12,12(@13)                                     0726
         BR    @14                                                 0726
* /*******************************************************************/
* /*                          OVERSHOT                                *
* /*   THIS PROC WILL PROCESS GROUP3 3 RECORDS IF ANY OF THE SEEKS    *
* /*   OVERSHOT  ON THE SEEK COMMAND.                                 *
*OVERSHOT:                                                         0727
*    PROC;                                                         0727
OVERSHOT STM   @14,@12,12(@13)                                     0727
*    OVERFLAG=OVERFLAG&&OVERFLAG;                                  0728
         XC    OVERFLAG(5),OVERFLAG                                0728
* /*   KEEPDIFF  BIT(1)  DID NOT FIND DIFF TO MATCH 1,2,4,8--         *
* /*                     & DIFF BETWEEN BY34 & 89 IS DIFFERENT        *
* /*    MIXBITS  BIT(1)  NOT USED                                     *
* /*    DIFFSIG  BIT(1)  NOT USED                                     *
* /*    SIGMATCH BIT(1)  NOTUSED                                      *
* /*    SETDIFF  BIT(1)  FOUND DIFF = TO 1,2,4,8 ON 1 & DIFF ON       *
* /*                     ANOTHER RECORDS(S)                           *
* /*    MIXOVER  BIT(1)      MIX OF OVERSHOT RECORDS                  *
* /*    SB34M89  BIT(1)    ON IF ABS(SB34-SB89) ^= ALL RECORDS        *
*    SAVER4=ZERO;                                                  0729
         SLR   @05,@05                                             0729
         STH   @05,SAVER4                                          0729
*    IF UNDERSUM=ON THEN             /* HAVE A MIX OF OVER & UNDER    *
         TM    UNDERSUM,B'00010000'                                0730
         BNO   @RF00730                                            0730
*      BYTE='0900'X;                 /* MORE THAN 1 VALUE FROM SEEK
*                                       VERIF ERROR                   *
         MVC   BYTE(2),@CB01680                                    0731
*    ELSE                                                          0732
*      DO;                                                         0732
         B     @RC00730                                            0732
@RF00730 DS    0H                                                  0733
*        DO B=1 BY 1 TO INTABLE WHILE(SETDIFF=OFF);                0733
         LA    @05,1                                               0733
         STH   @05,B                                               0733
         B     @DE00733                                            0733
@DL00733 TM    SETDIFF,B'00001000'                                 0733
         BNZ   @DC00733                                            0733
*          R4=ABS(BYTE0304(B)-BYTE0809(B));                        0734
         L     @15,SENSEPTR                                        0734
         MH    @05,@CH00042                                        0734
         ST    @05,@TF00001                                        0734
         ALR   @05,@15                                             0734
         AL    @05,@CF01883                                        0734
         MVC   @ZT00002+2(2),BYTE0304-6(@05)                       0734
         L     R4,@ZT00002                                         0734
         AL    @15,@TF00001                                        0734
         AL    @15,@CF01871                                        0734
         MVC   @ZT00002+2(2),BYTE0809-11(@15)                      0734
         SL    R4,@ZT00002                                         0734
         LPR   R4,R4                                               0734
*          DO C=1 BY 1 TO 10;                                      0735
         LA    @05,1                                               0735
         STH   @05,C                                               0735
@DL00735 DS    0H                                                  0736
*            IF SIGBIT(C)=R4 THEN    /* 1 × 2× 4×8×16×32---           *
         ALR   @05,@05                                             0736
         LH    @05,SIGBIT-2(@05)                                   0736
         CR    @05,R4                                              0736
         BNE   @RF00736                                            0736
*              DO;                                                 0737
*                IF SAVER4=ZERO THEN /* FIRST TIME THROUGH            *
         LH    @15,SAVER4                                          0738
         LTR   @15,@15                                             0738
         BNZ   @RF00738                                            0738
*                  SAVER4=SIGBIT(C); /* SAVE FOR THE NEXT CHECK       *
         STH   @05,SAVER4                                          0739
*                ELSE                                              0740
*                  IF SIGBIT(C)^=SAVER4 THEN                       0740
         B     @RC00738                                            0740
@RF00738 LH    @05,C                                               0740
         ALR   @05,@05                                             0740
         LH    @05,SIGBIT-2(@05)                                   0740
         CH    @05,SAVER4                                          0740
         BE    @RF00740                                            0740
*                    SETDIFF=ON;     /* SET HAVE A MIX FLAG ON        *
         OI    SETDIFF,B'00001000'                                 0741
*              END;                                                0742
@RF00740 DS    0H                                                  0742
@RC00738 DS    0H                                                  0743
*          END;                                                    0743
@RF00736 LA    @05,1                                               0743
         AH    @05,C                                               0743
         STH   @05,C                                               0743
         CH    @05,@CH00035                                        0743
         BNH   @DL00735                                            0743
*          IF SAVER4=ZERO THEN       /* ZERO IF DID NOT FIND A MATCH  *
         LH    @05,SAVER4                                          0744
         LTR   @05,@05                                             0744
         BNZ   @RF00744                                            0744
*            DO;                     /* MUST ALSO CHECK IF WE HAVE A
*                                       MIX OF THE ENTRIES THAT WERE
*                                       NOT = TO A BINARY SIGNIFICANT
*                                       BIT                           *
*              IF B=1 THEN           /* FIRST TIME THROUGH            *
         CLC   B(2),@CH00057                                       0746
         BNE   @RF00746                                            0746
*                SAVEITEM=R4;        /* SAVE FOR THE FOLLOWING CHECK  *
         STH   R4,SAVEITEM                                         0747
*              ELSE                                                0748
*                IF SAVEITEM^=R4 THEN/* DO WE HAVE A MIXTURE OF VALUES*
         B     @RC00746                                            0748
@RF00746 CH    R4,SAVEITEM                                         0748
         BE    @RF00748                                            0748
*                  KEEPDIFF=ON;      /* SET THE FLAG INDICATING THIS  *
         OI    KEEPDIFF,B'10000000'                                0749
*            END;                                                  0750
@RF00748 DS    0H                                                  0750
@RC00746 DS    0H                                                  0751
*        END;                                                      0751
@RF00744 LA    @05,1                                               0751
         AH    @05,B                                               0751
         STH   @05,B                                               0751
@DE00733 CH    @05,INTABLE                                         0751
         BNH   @DL00733                                            0751
@DC00733 DS    0H                                                  0752
*        IF SAVER4=ZERO THEN                                       0752
         LH    @05,SAVER4                                          0752
         LTR   @05,@05                                             0752
         BNZ   @RF00752                                            0752
*          DO;                                                     0753
*            IF KEEPDIFF=OFF&SAVEITEM<'0100'X THEN                 0754
         TM    KEEPDIFF,B'10000000'                                0754
         BNZ   @RF00754                                            0754
         LH    @05,SAVEITEM                                        0754
         CH    @05,@CH00102                                        0754
         BNL   @RF00754                                            0754
*              BYTE=('0800'X×SAVEITEM);/* OR WITH THE DIFFERENCE      *
         O     @05,@CF01681                                        0755
         ST    @05,@TF00001                                        0755
         MVC   BYTE(2),@TF00001+2                                  0755
*            ELSE                                                  0756
*              BYTE='0800'X;                                       0756
         B     @RC00754                                            0756
@RF00754 MVC   BYTE(2),@CB01681                                    0756
*          END;                                                    0757
*        ELSE                        /* OVERSHOOT DIFF COUNTER        *
*          IF SETDIFF=ON THEN        /* MIX OF BINARY SIG. VALUES     *
         B     @RC00752                                            0758
@RF00752 TM    SETDIFF,B'00001000'                                 0758
         BNO   @RF00758                                            0758
*            BYTE='0700'X;                                         0759
         MVC   BYTE(2),@CB01682                                    0759
*          ELSE                                                    0760
*            IF SAVER4=256 THEN      /* 256 & 512 REQUIRE SPECIAL  0760
*                                       HANDLING                      *
         B     @RC00758                                            0760
@RF00758 CLC   SAVER4(2),@CH01112                                  0760
         BNE   @RF00760                                            0760
*              BYTE='07F1'X;                                       0761
         MVC   BYTE(2),@CB01683                                    0761
*            ELSE                                                  0762
*              IF SAVER4=512 THEN                                  0762
         B     @RC00760                                            0762
@RF00760 CLC   SAVER4(2),@CH01113                                  0762
         BNE   @RF00762                                            0762
*                BYTE='07F2'X;                                     0763
         MVC   BYTE(2),@CB01684                                    0763
*              ELSE                                                0764
*                BYTE=('0700'X×SAVER4);/* × WITH THE SIG. VALUE       *
         B     @RC00762                                            0764
@RF00762 LA    @05,1792                                            0764
         LH    @15,SAVER4                                          0764
         OR    @05,@15                                             0764
         ST    @05,@TF00001                                        0764
         MVC   BYTE(2),@TF00001+2                                  0764
*      END;                                                        0765
*    END OVERSHOT;                                                 0766
@EL00019 DS    0H                                                  0766
@EF00019 DS    0H                                                  0766
@ER00019 LM    @14,@12,12(@13)                                     0766
         BR    @14                                                 0766
* /********************************************************************
* /*                         BUILDSUM                                 *
* /*  THIS PROC WILL PROCESS ALL GROUP 3 ENTRIES IN ORDER TO BUILD THE*
*BUILDSUM:                                                         0767
*    PROC;                                                         0767
BUILDSUM STM   @14,@12,@SA00020                                    0767
*    SVLINED=SVLINE;                 /* MODIFERS                      *
         MVC   SVLINED(11),SVLINE                                  0768
*    CALL PRINTIT;                                                 0769
         BAL   @14,PRINTIT                                         0769
*    SVMOD1D=SVMOD1;                 /* LINE 1 DESCRIBING THE MODIFERS*
         MVC   SVMOD1D(80),SVMOD1                                  0770
*    CALL PRINTIT;                                                 0771
         BAL   @14,PRINTIT                                         0771
*    SVMOD2D=SVMOD2;                 /* LINE 2                        *
         MVC   SVMOD2D(80),SVMOD2                                  0772
*    CALL PRINTIT;                                                 0773
         BAL   @14,PRINTIT                                         0773
*    SVMOD3D=SVMOD3;                 /* LINE 3                        *
         MVC   SVMOD3D(80),SVMOD3                                  0774
*    CALL PRINTIT;                                                 0775
         BAL   @14,PRINTIT                                         0775
*    DO B=1 BY 1 TO INTABLE;         /* SAVE BYTE 3&4 SO CAN ZERO IF
*                                       REQUIRED                      *
         LA    @05,1                                               0776
         STH   @05,B                                               0776
         B     @DE00776                                            0776
@DL00776 DS    0H                                                  0777
*      SAVE0304(B)=BYTE0304(B);      /* MOVE INTO TO THE DIVIDE AREA  *
         L     @15,SENSEPTR                                        0777
         LR    @14,@05                                             0777
         MH    @14,@CH00042                                        0777
         ST    @14,@TF00001                                        0777
         ALR   @14,@15                                             0777
         AL    @14,@CF01884                                        0777
         AL    @15,@TF00001                                        0777
         AL    @15,@CF01883                                        0777
         MVC   SAVE0304-3(2,@14),BYTE0304-6(@15)                   0777
*    END;                                                          0778
         AH    @05,@CH00057                                        0778
         STH   @05,B                                               0778
@DE00776 CH    @05,INTABLE                                         0778
         BNH   @DL00776                                            0778
*    DO B=1 BY 1 TO INTABLE;         /* CHECK ALL RECORDS READ        *
         LA    @05,1                                               0779
         STH   @05,B                                               0779
         B     @DE00779                                            0779
@DL00779 DS    0H                                                  0780
*      IF BYTE5(B)>11 THEN           /* IF BYTE 5 IS > THAN 11 THEN
*                                       ZERO                          *
         L     @15,SENSEPTR                                        0780
         MH    @05,@CH00042                                        0780
         LA    @01,0(@05,@15)                                      0780
         AL    @01,@CF01875                                        0780
         SLR   @00,@00                                             0780
         IC    @00,BYTE5-8(,@01)                                   0780
         CH    @00,@CH00034                                        0780
         BNH   @RF00780                                            0780
*        BYTE0304(B)='0000'X;        /* SO THE FOLLOWING SORT &    0781
*                                       PRINTOUT WILL AGREE           *
         ALR   @15,@05                                             0781
         AL    @15,@CF01883                                        0781
         MVC   BYTE0304-6(2,@15),@CB00208                          0781
*    END;                                                          0782
@RF00780 LA    @05,1                                               0782
         AH    @05,B                                               0782
         STH   @05,B                                               0782
@DE00779 CH    @05,INTABLE                                         0782
         BNH   @DL00779                                            0782
*    IF INTABLE>ONE THEN             /* MUST HAVE MORE THAN 1 RECORD  *
         LH    @05,INTABLE                                         0783
         CH    @05,ONE                                             0783
         BNH   @RF00783                                            0783
*      DO C=1 BY 1 TO INTABLE-1;     /* SORT SMALLEST VALUE TO THE TOP*
         LA    @05,1                                               0784
         STH   @05,C                                               0784
         B     @DE00784                                            0784
@DL00784 DS    0H                                                  0785
*        DO B=C+1 BY ONE TO INTABLE;                               0785
         AH    @05,@CH00057                                        0785
         B     @DE00785                                            0785
@DL00785 DS    0H                                                  0786
*          IF BYTE0304(B)<BYTE0304(C) THEN                         0786
         L     @15,SENSEPTR                                        0786
         LA    @14,31                                              0786
         LR    @01,@05                                             0786
         MR    @00,@14                                             0786
         MH    @14,C                                               0786
         ALR   @01,@15                                             0786
         AL    @01,@CF01883                                        0786
         ALR   @15,@14                                             0786
         AL    @15,@CF01883                                        0786
         CLC   BYTE0304-6(2,@01),BYTE0304-6(@15)                   0786
         BNL   @RF00786                                            0786
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        0787
*        END;                                                      0788
@RF00786 LH    @05,B                                               0788
         AH    @05,ONE                                             0788
@DE00785 STH   @05,B                                               0788
         CH    @05,INTABLE                                         0788
         BNH   @DL00785                                            0788
*      END;                                                        0789
         LA    @05,1                                               0789
         AH    @05,C                                               0789
         STH   @05,C                                               0789
@DE00784 LH    @15,INTABLE                                         0789
         BCTR  @15,0                                               0789
         CR    @05,@15                                             0789
         BNH   @DL00784                                            0789
*    DO B=1 BY 1 TO INTABLE;         /* SEARCH ALL RECORDS            *
@RF00783 LA    @05,1                                               0790
         STH   @05,B                                               0790
         B     @DE00790                                            0790
@DL00790 DS    0H                                                  0791
*      BYTE0304(B)=SAVE0304(B);      /* RESTORE SENSE BYTES 3 & 4     *
         L     @15,SENSEPTR                                        0791
         LR    @14,@05                                             0791
         MH    @14,@CH00042                                        0791
         ST    @14,@TF00001                                        0791
         ALR   @14,@15                                             0791
         AL    @14,@CF01883                                        0791
         AL    @15,@TF00001                                        0791
         AL    @15,@CF01884                                        0791
         MVC   BYTE0304-6(2,@14),SAVE0304-3(@15)                   0791
*    END;                                                          0792
         AH    @05,@CH00057                                        0792
         STH   @05,B                                               0792
@DE00790 CH    @05,INTABLE                                         0792
         BNH   @DL00790                                            0792
*    DO B=1 BY 1 TO INTABLE;         /* DO FOR EVERY RECORD           *
         LA    @05,1                                               0793
         STH   @05,B                                               0793
         B     @DE00793                                            0793
@DL00793 DS    0H                                                  0794
*      IF BYTE5(B)<12 THEN           /* BUILD FIRST CCC VALUE         *
         L     @15,SENSEPTR                                        0794
         MH    @05,@CH00042                                        0794
         LA    @01,0(@05,@15)                                      0794
         AL    @01,@CF01875                                        0794
         SLR   @00,@00                                             0794
         IC    @00,BYTE5-8(,@01)                                   0794
         CH    @00,@CH00033                                        0794
         BNL   @RF00794                                            0794
*        DO;                                                       0795
*          TEMPSV1=BYTE0304(B);      /* MAKE SURE ALIGNMENT IS OK     *
         ALR   @15,@05                                             0796
         AL    @15,@CF01883                                        0796
         MVC   @ZT00002+2(2),BYTE0304-6(@15)                       0796
         L     @05,@ZT00002                                        0796
         STH   @05,TEMPSV1                                         0796
*          CALL CONVBIN(3,TEMPSV1,ADDR(CCC));/* CONVERT TO PRINTABLE  *
         LA    @05,CCC                                             0797
         ST    @05,@AFTEMPS+16                                     0797
         LA    @01,@AL00797                                        0797
         BAL   @14,CONVBIN                                         0797
*        END;                                                      0798
*      ELSE                                                        0799
*        CCC='  0';                  /* SET TO ZERO IF > THAN 11      *
         B     @RC00794                                            0799
@RF00794 MVC   CCC(3),@CC01688                                     0799
*      TEMPSV1=BYTE5(B);             /* BUILD DECIMAL VALUE OF SENSE
*                                       BYTE 5                        *
@RC00794 LH    @05,B                                               0800
         MH    @05,@CH00042                                        0800
         L     @01,SENSEPTR                                        0800
         AL    @01,@CF01875                                        0800
         SLR   @00,@00                                             0800
         IC    @00,BYTE5-8(@05,@01)                                0800
         STH   @00,TEMPSV1                                         0800
*      CALL CONVBIN(2,TEMPSV1,ADDR(HH));                           0801
         LA    @05,HH                                              0801
         ST    @05,@AFTEMPS+16                                     0801
         LA    @01,@AL00801                                        0801
         BAL   @14,CONVBIN                                         0801
*      IF TEMPSV1>11 THEN            /* SET TO M IF SB5 > 11          *
         LH    @05,TEMPSV1                                         0802
         CH    @05,@CH00034                                        0802
         BNH   @RF00802                                            0802
*        MF='F';                     /* MOVE IN A CHAR F              *
         MVI   MF,C'F'                                             0803
*      ELSE                                                        0804
*        MF='M';                     /* MOVE IN A CHAR M              *
         B     @RC00802                                            0804
@RF00802 MVI   MF,C'M'                                             0804
*      SRL(TEMPSV1,2);               /* INTERGAL VALUE OF SB5         *
@RC00802 LH    @05,TEMPSV1                                         0805
         SRL   @05,2                                               0805
         STH   @05,TEMPSV1                                         0805
*      CALL CONVBIN(2,TEMPSV1,ADDR(SS));                           0806
         LA    @05,SS                                              0806
         ST    @05,@AFTEMPS+16                                     0806
         LA    @01,@AL00806                                        0806
         BAL   @14,CONVBIN                                         0806
*      IF BYTE10(B)<12 THEN          /* IS SENSE BYTE 10 LESS THAN 12 *
         L     @05,SENSEPTR                                        0807
         LH    @15,B                                               0807
         MH    @15,@CH00042                                        0807
         LA    @01,0(@15,@05)                                      0807
         AL    @01,@CF01876                                        0807
         SLR   @00,@00                                             0807
         IC    @00,BYTE10-13(,@01)                                 0807
         CH    @00,@CH00033                                        0807
         BNL   @RF00807                                            0807
*        DO;                                                       0808
*          TEMPSV1=BYTE0809(B);      /* MAKE SURE ALIGNMENT IS OK     *
         ALR   @05,@15                                             0809
         AL    @05,@CF01871                                        0809
         MVC   @ZT00002+2(2),BYTE0809-11(@05)                      0809
         L     @05,@ZT00002                                        0809
         STH   @05,TEMPSV1                                         0809
*          CALL CONVBIN(3,TEMPSV1,ADDR(CCC1));                     0810
         LA    @05,CCC1                                            0810
         ST    @05,@AFTEMPS+16                                     0810
         LA    @01,@AL00810                                        0810
         BAL   @14,CONVBIN                                         0810
*        END;                                                      0811
*      ELSE                                                        0812
*        CCC1='  0';                 /* NO SO SET ANSWER TO A ZERO    *
         B     @RC00807                                            0812
@RF00807 MVC   CCC1(3),@CC01688                                    0812
*      TEMPSV1=BYTE10(B);            /* MAKE SURE OF THE ALIGNMENT    *
@RC00807 LH    @05,B                                               0813
         MH    @05,@CH00042                                        0813
         L     @01,SENSEPTR                                        0813
         AL    @01,@CF01876                                        0813
         SLR   @00,@00                                             0813
         IC    @00,BYTE10-13(@05,@01)                              0813
         STH   @00,TEMPSV1                                         0813
*      CALL CONVBIN(2,TEMPSV1,ADDR(HH1));/* CONVERT TO PRINTABLE      *
         LA    @05,HH1                                             0814
         ST    @05,@AFTEMPS+16                                     0814
         LA    @01,@AL00814                                        0814
         BAL   @14,CONVBIN                                         0814
*      IF TEMPSV1>11 THEN            /* BYTE 10 > THAN ELEVEN         *
         LH    @05,TEMPSV1                                         0815
         CH    @05,@CH00034                                        0815
         BNH   @RF00815                                            0815
*        MF1='F';                    /* YES SET TO FIXED HEAD FLAG    *
         MVI   MF1,C'F'                                            0816
*      ELSE                                                        0817
*        MF1='M';                    /* NO SET TO A MOVEABLE HEAD     *
         B     @RC00815                                            0817
@RF00815 MVI   MF1,C'M'                                            0817
*      SRL(TEMPSV1,2);               /* INTERGAL VALUE OF SB5         *
@RC00815 LH    @05,TEMPSV1                                         0818
         SRL   @05,2                                               0818
         STH   @05,TEMPSV1                                         0818
*      CALL CONVBIN(2,TEMPSV1,ADDR(SS1));                          0819
         LA    @05,SS1                                             0819
         ST    @05,@AFTEMPS+16                                     0819
         LA    @01,@AL00819                                        0819
         BAL   @14,CONVBIN                                         0819
*      IF BIT180(B)=ON THEN          /* ACCESS DIRECTION              *
         LH    @05,B                                               0820
         MH    @05,@CH00042                                        0820
         L     @01,SENSEPTR                                        0820
         ALR   @01,@05                                             0820
         AL    @01,@CF01882                                        0820
         TM    BIT180-21(@01),B'10000000'                          0820
         BNO   @RF00820                                            0820
*        FR='F';                     /* MOVE IN A CHAR F FOR FORWARD
*                                       MOTION                        *
         MVI   FR,C'F'                                             0821
*      ELSE                                                        0822
*        FR='R';                     /* MOVE IN A CHAR R FOR REVERSE  *
         B     @RC00820                                            0822
@RF00820 MVI   FR,C'R'                                             0822
*      IF BIT174(B)=ON THEN          /* EVEN TRACK LATCH              *
@RC00820 LH    @05,B                                               0823
         MH    @05,@CH00042                                        0823
         L     @01,SENSEPTR                                        0823
         ALR   @01,@05                                             0823
         AL    @01,@CF01858                                        0823
         TM    BIT174-20(@01),B'00001000'                          0823
         BNO   @RF00823                                            0823
*        EO='E';                     /* MOVE IN A CHAR E FOR EVEN  0824
*                                       LATCH                         *
         MVI   EO,C'E'                                             0824
*      ELSE                                                        0825
*        EO='O';                     /* MOVE IN A CHAR O FOR ODD LATCH*
         B     @RC00823                                            0825
@RF00823 MVI   EO,C'O'                                             0825
*      IF(BIT180(B)=ON&BYTE0304(B)>BYTE0809(B))×(BIT180(B)=OFF&BYTE0304
*          B)<BYTE0809(B)) THEN                                    0826
@RC00823 L     @05,SENSEPTR                                        0826
         LH    @15,B                                               0826
         MH    @15,@CH00042                                        0826
         ST    @15,@TF00001                                        0826
         ALR   @15,@05                                             0826
         AL    @15,@CF01882                                        0826
         TM    BIT180-21(@15),B'10000000'                          0826
         BNO   @GL00047                                            0826
         LR    @01,@05                                             0826
         AL    @01,@TF00001                                        0826
         AL    @01,@CF01883                                        0826
         AL    @05,@TF00001                                        0826
         AL    @05,@CF01871                                        0826
         CLC   BYTE0304-6(2,@01),BYTE0809-11(@05)                  0826
         BH    @RT00826                                            0826
@GL00047 L     @05,SENSEPTR                                        0826
         LH    @15,B                                               0826
         MH    @15,@CH00042                                        0826
         ST    @15,@TF00001                                        0826
         ALR   @15,@05                                             0826
         AL    @15,@CF01882                                        0826
         TM    BIT180-21(@15),B'10000000'                          0826
         BNZ   @RF00826                                            0826
         LR    @01,@05                                             0826
         AL    @01,@TF00001                                        0826
         AL    @01,@CF01883                                        0826
         AL    @05,@TF00001                                        0826
         AL    @05,@CF01871                                        0826
         CLC   BYTE0304-6(2,@01),BYTE0809-11(@05)                  0826
         BNL   @RF00826                                            0826
@RT00826 DS    0H                                                  0827
*        OS='US-';                   /* UNDRSHOOT EITHER DIRECTION    *
         MVC   OS(3),@CC01695                                      0827
*      ELSE                                                        0828
*        OS='OS-';                   /* OVERSHOOT EITHER DIRECTION    *
         B     @RC00826                                            0828
@RF00826 MVC   OS(3),@CC01696                                      0828
*      R4=ABS(BYTE0304(B)-BYTE0809(B));                            0829
@RC00826 L     @15,SENSEPTR                                        0829
         LH    @14,B                                               0829
         MH    @14,@CH00042                                        0829
         ST    @14,@TF00001                                        0829
         ALR   @14,@15                                             0829
         AL    @14,@CF01883                                        0829
         MVC   @ZT00002+2(2),BYTE0304-6(@14)                       0829
         L     R4,@ZT00002                                         0829
         AL    @15,@TF00001                                        0829
         AL    @15,@CF01871                                        0829
         MVC   @ZT00002+2(2),BYTE0809-11(@15)                      0829
         SL    R4,@ZT00002                                         0829
         LPR   R4,R4                                               0829
*      TEMPSV1=R4;                   /* AVOID PROBLEM IN CALLED PROC  *
         STH   R4,TEMPSV1                                          0830
*      CALL CONVBIN(3,TEMPSV1,ADDR(OS1));                          0831
         LA    @05,OS1                                             0831
         ST    @05,@AFTEMPS+16                                     0831
         LA    @01,@AL00831                                        0831
         BAL   @14,CONVBIN                                         0831
*      TEMPSV1=BYTE19(B);            /* SET UP FOR ALIGNMENT          *
         L     @05,SENSEPTR                                        0832
         LH    @15,B                                               0832
         MH    @15,@CH00042                                        0832
         LA    @01,0(@15,@05)                                      0832
         AL    @01,@CF01857                                        0832
         SLR   @00,@00                                             0832
         IC    @00,BYTE19-22(,@01)                                 0832
         STH   @00,TEMPSV1                                         0832
*      IF BIT181(B)=ON THEN          /* BIT 1 & 2 BYTE 18 ARE AN   0833
*                                       EXTENTION OF BYTE 19          *
         ALR   @05,@15                                             0833
         AL    @05,@CF01882                                        0833
         TM    BIT181-21(@05),B'01000000'                          0833
         BNO   @RF00833                                            0833
*        TEMPSV1=TEMPSV1+512;                                      0834
         AH    @00,@CH01113                                        0834
         STH   @00,TEMPSV1                                         0834
*      IF BIT182(B)=ON THEN                                        0835
@RF00833 LH    @05,B                                               0835
         MH    @05,@CH00042                                        0835
         L     @01,SENSEPTR                                        0835
         ALR   @01,@05                                             0835
         AL    @01,@CF01882                                        0835
         TM    BIT182-21(@01),B'00100000'                          0835
         BNO   @RF00835                                            0835
*        TEMPSV1=TEMPSV1+256;                                      0836
         LH    @05,TEMPSV1                                         0836
         LA    @05,256(,@05)                                       0836
         STH   @05,TEMPSV1                                         0836
*      CALL CONVBIN(3,TEMPSV1,ADDR(DIFFCT));/* CONVERT TO PRINTABLE   *
@RF00835 LA    @05,DIFFCT                                          0837
         ST    @05,@AFTEMPS+16                                     0837
         LA    @01,@AL00837                                        0837
         BAL   @14,CONVBIN                                         0837
*      CALL PRINTIT;                 /* PRINT THE MODIFER FOR THIS 0838
*                                       RECORD                        *
         BAL   @14,PRINTIT                                         0838
*    END;                                                          0839
         LA    @05,1                                               0839
         AH    @05,B                                               0839
         STH   @05,B                                               0839
@DE00793 CH    @05,INTABLE                                         0839
         BNH   @DL00793                                            0839
*    END BUILDSUM;                                                 0840
@EL00020 DS    0H                                                  0840
@EF00020 DS    0H                                                  0840
@ER00020 LM    @14,@12,@SA00020                                    0840
         BR    @14                                                 0840
* /*******************************************************************/
* /*                          DOSC                                    *
* /*   THIS PROC WILL PROCESS ALL GROUP 4 ENTRIES.  2 LINES OF OUTPUT *
* /*    CAN BE PRODUCED FOR EACH UNIQUE CUA.                          *
* /*   THE OUTPUT FORMAT FOR THIS GROUP IS:                           *
* /* CUA = XXX   TYPE = SC    EAC = D1,D2,D3,D4(XXXX)  SAMPLES = XXXX *
* /*                                (EAC COMPOSED OF 4 HEX CHARACTERS)*
* /*             MODIFER 1: (USES FSC'S OF 152C                       *
* /*               MAX OFFSET = XXX (VALID VALUES FROM 0 TO 255)      *
* /*               MIN OFFSET = XXX            "                      *
* /*             MODIFER 2: (USES FSC'S OF 1444,1448 &154E (REF  Z2)) *
* /*               MAX OFFSET    = XXX  (VALID VALUES FROM 0 TO 255)  *
* /*               MIN OFFSET    = XXX               "                *
* /*               MAX DIFF =      XXX               "                *
* /*               MIN DIFF =      XXX               "                *
* /*   THE CUA IS TAKEN FROM THE SORTABLE ENTRY                       *
* /*   FCI IS PRINTED FOR ALL GROUP3 ENTRIES                          *
* /*   SAMPLES = NUMBER OF RECORDS FOR THIS GROUP                     *
* /*   EAC:  D1 = 4 BITS  Y0,Y1,Y2,& Y3                               *
* /*            Y0 = ON IF THIS EAC IS FOR RECORDS WITH THE EVD BIT ON*
* /*            Y0 = OFF FOR THE GROUP USING ALL OF THE RECORDS       *
* /*            Y1 = UNUSED                                           *
* /*            Y2 = ON IF GROUP 4 ARE RECORDED AGAINST THIS STRING   *
* /*                 EXCLUDING THE ADJACENT FILE ADDRESS              *
* /*            Y3 = ON IF GROUP 4 ARE RECORDED AGAINST THE ADJACENT  *
* /*                 FILE ADDRESS                                     *
* /*         D2 = 4 BITS  Y4,Y5,Y6,& Y7  (ONLY FSC'S 152C,162A,&164A  *
* /*            Y4 = ON IF ALL D2 RECORD SENSE BYTE 17 BIT 4 IS THE   *
* /*                 SAME (EITHER ALL ON OR OFF)                      *
* /*            Y5 = ON IF ANY D2 RECORD BYTE 16 BIT 1 IS ON          *
* /*            Y6 = ON IF ANY D2 RECORD BYTE 16 BIT 2 IS ON          *
* /*            Y7 = ON IF ANY D2 RECORD BYTE 16 = HEX 'XC'           *
* /*         D3 = 4 BITS  Y8,Y9,YA,& YB (ONLY FSC'S 1444,1448,&154E)  *
* /*            Y8 = ON IF ANY D3 RECORD BYTE 17 BIT 2 IS ON          *
* /*            Y9 = ON IF ANY D3 RECORD BYTE 17 BIT 3 IS ON          *
* /*            YA = ON IF ANY D3 RECORD BYTE 19 ^= '00'              *
* /*            YB = ON IF ANY D3 RECORD BYTE 17 BIT 4 & BYTE 4 BIT 7 *
* /*                 ARE DIFFERENT                                    *
* /*         D4 = C2  NOTE:  THIS IS THE ONLY ITEM THAT REQUIRES      *
* /*                         ANY INPUT FROM ANOTHER GROUP.  THIS HEX  *
* /*                         ITEM WILL BE FOUND IN THIS CUA GROUP 3   *
* /*                         HEX CHAR 2.                              *
*DOSC:                                                             0841
*    PROC;                                                         0841
DOSC     STM   @14,@12,@SA00021                                    0841
* /*HAVE TO ADJUST THE NUMBER OF RECORDS TO READ AS THERE IS NO NEED  *
* /*TO REREAD THE GROUP 3 RECORDS AS ALL IS DONE IS TO EXTRACT A BYTE *
* /*FROM THE GROUP 3 EVD TABLE                                        *
*    TEMPSV=ALLCOUNT(A,FOUR)-ALLCOUNT(A,THREE);                    0842
         LH    @05,A                                               0842
         LR    @15,@05                                             0842
         MH    @15,@CH00033                                        0842
         MH    @05,@CH00081                                        0842
         AH    @05,THREE                                           0842
         ALR   @05,@05                                             0842
         LH    @14,ALLCOUNT-6(@15)                                 0842
         SH    @14,ALLCOUNT-14(@05)                                0842
         STH   @14,TEMPSV                                          0842
*    TEMPSV1=EVDCOUNT(A,FOUR)-EVDCOUNT(A,THREE);                   0843
         LH    @15,EVDCOUNT-6(@15)                                 0843
         SH    @15,EVDCOUNT-14(@05)                                0843
         STH   @15,TEMPSV1                                         0843
*    IF SWITCH3=OFF THEN             /* DONT READ IF DOING THE EVD 0844
*                                       PASS                          *
         TM    SWITCH3,B'00001000'                                 0844
         BNZ   @RF00844                                            0844
*      CALL READREC(TEMPSV);         /* READ THIS GROUP RECORDS       *
         LA    @01,@AL00845                                        0845
         BAL   @14,READREC                                         0845
*    ELSE                                                          0846
*      DO;                                                         0846
         B     @RC00844                                            0846
@RF00844 DS    0H                                                  0847
*        INTABLE=TEMPSV1;            /* SET NUMBER OF RECORDS TO EVD
*                                       COUNT                         *
         MVC   INTABLE(2),TEMPSV1                                  0847
*      END;                                                        0848
*    CALL GRP4EAC;                   /* GO BUILD THE EAC              *
@RC00844 BAL   @14,GRP4EAC                                         0849
*    IF SWITCH3=ON THEN              /* EVD PASS                      *
         TM    SWITCH3,B'00001000'                                 0850
         BNO   @RF00850                                            0850
*      DO;                                                         0851
*        BYTES1=(EVDMDC(A,THREE)&'0F00'X);/* BRING UP THE GROUP3 EAC  *
         LH    @05,A                                               0852
         LR    @15,@05                                             0852
         MH    @15,@CH00081                                        0852
         AH    @15,THREE                                           0852
         ALR   @15,@15                                             0852
         LA    @14,EVDMDC-14(@15)                                  0852
         MVC   BYTES1(2),0(@14)                                    0852
         NC    BYTES1(2),@CB01701                                  0852
*        SRL(BYTES1,8);              /* ADJUST POSITION FOR NEXT   0853
*                                       INSTRUCTION                   *
         MVC   @ZT00002+2(2),BYTES1                                0853
         L     @15,@ZT00002                                        0853
         SRL   @15,8                                               0853
         STH   @15,@TF00001                                        0853
         MVC   BYTES1(2),@TF00001                                  0853
*        EVDMDC(A,FOUR)=(EVDMDC(A,FOUR)×BYTE×BYTES1);              0854
         MH    @05,@CH00033                                        0854
         LA    @01,EVDMDC-6(@05)                                   0854
         LA    @15,EVDMDC-6(@05)                                   0854
         MVC   @TS00001(2),0(@15)                                  0854
         OC    @TS00001(2),BYTE                                    0854
         OC    @TS00001(2),BYTES1                                  0854
         MVC   0(2,@01),@TS00001                                   0854
*      END;                                                        0855
*    ELSE                                                          0856
*      DO;                           /* DO ALL RECORD PASS            *
         B     @RC00850                                            0856
@RF00850 DS    0H                                                  0857
*        R33=(MAINMDC(A,THREE)&'0F00'X);/* EXTRACT VALUE FROM GROUP3  *
         LH    @05,A                                               0857
         LR    @15,@05                                             0857
         MH    @15,@CH00081                                        0857
         AH    @15,THREE                                           0857
         ALR   @15,@15                                             0857
         LA    @14,3840                                            0857
         LA    @01,MAINMDC-14(@15)                                 0857
         MVC   @ZT00002+2(2),0(@01)                                0857
         N     @14,@ZT00002                                        0857
         STH   @14,R33                                             0857
*        SRL(R33,8);                 /* ADJUST POSITION FOR NEXT   0858
*                                       INSTRUCTION                   *
         SRL   @14,8                                               0858
         STH   @14,R33                                             0858
*        MAINMDC(A,FOUR)=(MAINMDC(A,FOUR)×BYTE×R33);               0859
         MH    @05,@CH00033                                        0859
         MVC   @ZT00002+2(2),BYTE                                  0859
         L     @15,@ZT00002                                        0859
         LA    @14,MAINMDC-6(@05)                                  0859
         MVC   @ZT00002+2(2),0(@14)                                0859
         O     @15,@ZT00002                                        0859
         LH    @14,R33                                             0859
         OR    @15,@14                                             0859
         ST    @15,@TF00001                                        0859
         LA    @14,MAINMDC-6(@05)                                  0859
         MVC   0(2,@14),@TF00001+2                                 0859
*      END;                                                        0860
*    IF DEBUG61=ON THEN                                            0861
@RC00850 TM    DEBUG61(R2),B'00000100'                             0861
         BNO   @RF00861                                            0861
*      DO;                                                         0862
*        CALL CONVERT1(TWO,PRT0,ADDR(BYTES1));                     0863
         LA    @05,BYTES1                                          0863
         ST    @05,@AFTEMPS+20                                     0863
         LA    @01,@AL00863                                        0863
         BAL   @14,CONVERT1                                        0863
*        CALL CONVERT1(TWO,PRT6,ADDR(R33));                        0864
         LA    @05,R33                                             0864
         ST    @05,@AFTEMPS+20                                     0864
         LA    @01,@AL00864                                        0864
         BAL   @14,CONVERT1                                        0864
*        CALL PRINTIT;                                             0865
         BAL   @14,PRINTIT                                         0865
*      END;                                                        0866
*    CALL PRTHEAD(FOUR1);            /* GO PRINT THE EAC LINE         *
@RF00861 LA    @01,@AL00867                                        0867
         BAL   @14,PRTHEAD                                         0867
*    IF SV19USE^=SV19RUSE THEN       /* DONT PRINT IF NOTHING WAS SET *
         CLC   SV19USE(12),SV19RUSE                                0868
         BE    @RF00868                                            0868
*      DO;                                                         0869
*        IF SWITCH3=ON&ALLCOUNT(A,FOUR)=EVDCOUNT(A,FOUR) THEN      0870
*                                                                  0870
         TM    SWITCH3,B'00001000'                                 0870
         BNO   @RF00870                                            0870
         LH    @05,A                                               0870
         MH    @05,@CH00033                                        0870
         LH    @15,ALLCOUNT-6(@05)                                 0870
         CH    @15,EVDCOUNT-6(@05)                                 0870
         BNE   @RF00870                                            0870
*          DO;                                                     0871
*            PRTLINE=ALLEQUAL;                                     0872
         MVI   PRTLINE+41,C' '                                     0872
         MVC   PRTLINE+42(90),PRTLINE+41                           0872
         MVC   PRTLINE(41),ALLEQUAL                                0872
*            CALL PRINTIT;                                         0873
         BAL   @14,PRINTIT                                         0873
*          END;                                                    0874
*        ELSE                                                      0875
*          CALL GP4MODIF;            /* PRINT THE MODIFERS            *
         B     @RC00870                                            0875
@RF00870 BAL   @14,GP4MODIF                                        0875
*      END;                                                        0876
@RC00870 DS    0H                                                  0877
*    SWITCH3=OFF;                    /* CLEAR FOR THE NEXT EVD        *
@RF00868 NI    SWITCH3,B'11110111'                                 0877
*    END DOSC;                                                     0878
@EL00021 DS    0H                                                  0878
@EF00021 DS    0H                                                  0878
@ER00021 LM    @14,@12,@SA00021                                    0878
         BR    @14                                                 0878
* /********************************************************************
* /*                      GRP4EAC                                     *
* /*    THIS PROC WILL BUILD THE EAC FOR GROUP 4 RECORDS              *
* /*    IT WILL BE CALLED TWICE, ONCE FOR ALL RECORDS AND ONCE FOR    *
* /*    RECORDS WITH JUST THE EVD BIT SET.                            *
*GRP4EAC:                                                          0879
*    PROC;                                                         0879
GRP4EAC  STM   @14,@12,@SA00022                                    0879
*    SCFLAG=SCFLAG&&SCFLAG;          /* CLEAR THE FLAGS               *
         XC    SCFLAG(2),SCFLAG                                    0880
* /*    SCFLAG1  BIT(1)  BYTE17 BIT 4 = ON  IN AT LEAST 1 RECORD      *
* /*    SCFLAG2  BIT(1)  BYTE17 BIT 4 = OFF IN AT LEAST 1 RECORD      *
* /*    SCFLAG3  BIT(1)  1 REC WITH FAULT CODE OF 152C,162A,164A FOUND*
*    BYTE=ZERO;                      /* CLEAR 2 BYTE FIELD            *
         SLR   @05,@05                                             0881
         ST    @05,@TF00001                                        0881
         MVC   BYTE(2),@TF00001+2                                  0881
*    DO B=1 BY 1 TO INTABLE;         /* WILL PROCESS ALL EVD ON    0882
*                                       RECORDS                       *
         LA    @05,1                                               0882
         STH   @05,B                                               0882
         B     @DE00882                                            0882
@DL00882 DS    0H                                                  0883
*      BY22231=BYTE2223(B);                                        0883
         MH    @05,@CH00042                                        0883
         L     @01,SENSEPTR                                        0883
         ALR   @01,@05                                             0883
         AL    @01,@CF01865                                        0883
         MVC   BY22231(2),BYTE2223-25(@01)                         0883
*      IF BY22231='152C'X×BY22231='162A'X×BY22231='164A'X THEN     0884
         CLC   BY22231(2),@CB01706                                 0884
         BE    @RT00884                                            0884
         CLC   BY22231(2),@CB01707                                 0884
         BE    @RT00884                                            0884
         CLC   BY22231(2),@CB01708                                 0884
         BNE   @RF00884                                            0884
@RT00884 DS    0H                                                  0885
*        DO;                                                       0885
*          SCFLAG3=ON;               /* FLAG SAYING FOUND ONE OF THESE
*                                       TYPES                         *
         OI    SCFLAG3,B'00100000'                                 0886
*          IF BIT174(B)=ON THEN      /* EVEN TRACK LATCH              *
         LH    @05,B                                               0887
         MH    @05,@CH00042                                        0887
         L     @01,SENSEPTR                                        0887
         ALR   @01,@05                                             0887
         AL    @01,@CF01858                                        0887
         TM    BIT174-20(@01),B'00001000'                          0887
         BNO   @RF00887                                            0887
*            SCFLAG1=ON;             /* FOUND BYTE17 BIT 4 = TO ON 0888
*                                       CONDITION                     *
         OI    SCFLAG1,B'10000000'                                 0888
*          ELSE                                                    0889
*            SCFLAG2=ON;                                           0889
         B     @RC00887                                            0889
@RF00887 OI    SCFLAG2,B'01000000'                                 0889
*          IF BIT161(B)=ON THEN      /* OVERSHOOT CHECK               *
@RC00887 LH    @05,B                                               0890
         MH    @05,@CH00042                                        0890
         L     @01,SENSEPTR                                        0890
         ALR   @01,@05                                             0890
         AL    @01,@CF01885                                        0890
         TM    BIT161-19(@01),B'01000000'                          0890
         BNO   @RF00890                                            0890
*            Y5=ON;                                                0891
         OI    Y5,B'00000100'                                      0891
*          IF BIT162(B)=ON THEN      /* SERVO OFF TRACK CHECK         *
@RF00890 LH    @05,B                                               0892
         MH    @05,@CH00042                                        0892
         L     @01,SENSEPTR                                        0892
         ALR   @01,@05                                             0892
         AL    @01,@CF01885                                        0892
         TM    BIT162-19(@01),B'00100000'                          0892
         BNO   @RF00892                                            0892
*            Y6=ON;                                                0893
         OI    Y6,B'00000010'                                      0893
*          IF(BYTE16(B)&'0C'X)='0C'X THEN/* BYTE 16 BITS 4 & 5        *
@RF00892 LH    @05,B                                               0894
         MH    @05,@CH00042                                        0894
         L     @01,SENSEPTR                                        0894
         ALR   @01,@05                                             0894
         AL    @01,@CF01885                                        0894
         MVC   @TS00001(1),BYTE16-19(@01)                          0894
         NI    @TS00001,X'0C'                                      0894
         CLI   @TS00001,X'0C'                                      0894
         BNE   @RF00894                                            0894
*            Y7=ON;                                                0895
         OI    Y7,B'00000001'                                      0895
*        END;                                                      0896
@RF00894 DS    0H                                                  0897
*      IF BY22231='154E'X×BY22231='1448'X×BY22231='1444'X THEN     0897
@RF00884 CLC   BY22231(2),@CB01709                                 0897
         BE    @RT00897                                            0897
         CLC   BY22231(2),@CB01710                                 0897
         BE    @RT00897                                            0897
         CLC   BY22231(2),@CB01711                                 0897
         BNE   @RF00897                                            0897
@RT00897 DS    0H                                                  0898
*        DO;                                                       0898
*          IF BIT172(B)=ON&BIT180(B)=ON THEN/* TRACK CROSSING LAT     *
         L     @05,SENSEPTR                                        0899
         LH    @15,B                                               0899
         MH    @15,@CH00042                                        0899
         ST    @15,@TF00001                                        0899
         ALR   @15,@05                                             0899
         AL    @15,@CF01858                                        0899
         TM    BIT172-20(@15),B'00100000'                          0899
         BNO   @RF00899                                            0899
         AL    @05,@TF00001                                        0899
         AL    @05,@CF01882                                        0899
         TM    BIT180-21(@05),B'10000000'                          0899
         BNO   @RF00899                                            0899
*            Y8=ON;                                                0900
         OI    Y8,B'10000000'                                      0900
*          IF BIT173(B)=ON&BIT180(B)=ON THEN/* VELOCITY POLARITY L    *
@RF00899 L     @05,SENSEPTR                                        0901
         LH    @15,B                                               0901
         MH    @15,@CH00042                                        0901
         ST    @15,@TF00001                                        0901
         ALR   @15,@05                                             0901
         AL    @15,@CF01858                                        0901
         TM    BIT173-20(@15),B'00010000'                          0901
         BNO   @RF00901                                            0901
         AL    @05,@TF00001                                        0901
         AL    @05,@CF01882                                        0901
         TM    BIT180-21(@05),B'10000000'                          0901
         BNO   @RF00901                                            0901
*            Y9=ON;                                                0902
         OI    Y9,B'01000000'                                      0902
*          IF BYTE19(B)^='00'X THEN  /* DIFFERENCE COUNTER            *
@RF00901 LH    @05,B                                               0903
         MH    @05,@CH00042                                        0903
         L     @01,SENSEPTR                                        0903
         ALR   @01,@05                                             0903
         AL    @01,@CF01857                                        0903
         CLI   BYTE19-22(@01),X'00'                                0903
         BE    @RF00903                                            0903
*            YA=ON;                                                0904
         OI    YA,B'00100000'                                      0904
*          IF(BIT174(B)=ON&BIT47(B)=OFF)×(BIT174(B)=OFF&BIT47(B)=ON)
*            THEN                                                  0905
@RF00903 L     @05,SENSEPTR                                        0905
         LH    @15,B                                               0905
         MH    @15,@CH00042                                        0905
         ST    @15,@TF00001                                        0905
         ALR   @15,@05                                             0905
         AL    @15,@CF01858                                        0905
         TM    BIT174-20(@15),B'00001000'                          0905
         BNO   @GL00057                                            0905
         AL    @05,@TF00001                                        0905
         AL    @05,@CF01881                                        0905
         TM    BIT47-7(@05),B'00000001'                            0905
         BZ    @RT00905                                            0905
@GL00057 L     @05,SENSEPTR                                        0905
         LH    @15,B                                               0905
         MH    @15,@CH00042                                        0905
         ST    @15,@TF00001                                        0905
         ALR   @15,@05                                             0905
         AL    @15,@CF01858                                        0905
         TM    BIT174-20(@15),B'00001000'                          0905
         BNZ   @RF00905                                            0905
         AL    @05,@TF00001                                        0905
         AL    @05,@CF01881                                        0905
         TM    BIT47-7(@05),B'00000001'                            0905
         BNO   @RF00905                                            0905
@RT00905 DS    0H                                                  0906
*            YB=ON;                                                0906
         OI    YB,B'00010000'                                      0906
*        END;                                                      0907
@RF00905 DS    0H                                                  0908
*      IF BY22231='152C'X THEN                                     0908
@RF00897 CLC   BY22231(2),@CB01706                                 0908
         BNE   @RF00908                                            0908
*        DO;                                                       0909
*          IF BYTE19(B)>SV19MAX1 THEN/* SET TO 9999 FIRST TIME IN     *
         LH    @05,B                                               0910
         MH    @05,@CH00042                                        0910
         L     @01,SENSEPTR                                        0910
         AL    @01,@CF01857                                        0910
         SLR   @15,@15                                             0910
         IC    @15,BYTE19-22(@05,@01)                              0910
         CH    @15,SV19MAX1                                        0910
         BNH   @RF00910                                            0910
*            SV19MAX1=BYTE19(B);                                   0911
         STH   @15,SV19MAX1                                        0911
*          IF BYTE19(B)<SV19MIN1 THEN/* SET TO -1 FIRST TIME IN       *
@RF00910 LH    @05,B                                               0912
         MH    @05,@CH00042                                        0912
         L     @01,SENSEPTR                                        0912
         AL    @01,@CF01857                                        0912
         SLR   @15,@15                                             0912
         IC    @15,BYTE19-22(@05,@01)                              0912
         CH    @15,SV19MIN1                                        0912
         BNL   @RF00912                                            0912
*            SV19MIN1=BYTE19(B);                                   0913
         STH   @15,SV19MIN1                                        0913
*        END;                                                      0914
*      ELSE                                                        0915
*        IF BY22231='154E'X THEN                                   0915
         B     @RC00908                                            0915
@RF00908 CLC   BY22231(2),@CB01709                                 0915
         BNE   @RF00915                                            0915
*          DO;                                                     0916
*            IF BYTE19(B)>SV19MAX2 THEN/* SET TO 9999 FIRST TIME      *
         LH    @05,B                                               0917
         MH    @05,@CH00042                                        0917
         L     @01,SENSEPTR                                        0917
         AL    @01,@CF01857                                        0917
         SLR   @15,@15                                             0917
         IC    @15,BYTE19-22(@05,@01)                              0917
         CH    @15,SV19MAX2                                        0917
         BNH   @RF00917                                            0917
*              SV19MAX2=BYTE19(B);                                 0918
         STH   @15,SV19MAX2                                        0918
*            IF BYTE19(B)<SV19MIN2 THEN/* SET TO -1 FIRST TIME        *
@RF00917 LH    @05,B                                               0919
         MH    @05,@CH00042                                        0919
         L     @01,SENSEPTR                                        0919
         AL    @01,@CF01857                                        0919
         SLR   @15,@15                                             0919
         IC    @15,BYTE19-22(@05,@01)                              0919
         CH    @15,SV19MIN2                                        0919
         BNL   @RF00919                                            0919
*              SV19MIN2=BYTE19(B);                                 0920
         STH   @15,SV19MIN2                                        0920
*          END;                                                    0921
*        ELSE                                                      0922
*          IF BY22231='1444'X×BY22231='1448'X THEN                 0922
         B     @RC00915                                            0922
@RF00915 CLC   BY22231(2),@CB01711                                 0922
         BE    @RT00922                                            0922
         CLC   BY22231(2),@CB01710                                 0922
         BNE   @RF00922                                            0922
@RT00922 DS    0H                                                  0923
*            DO;                                                   0923
*              IF BYTE19(B)>SV19MAX3 THEN/* SET TO 9999 FIRST TIME    *
         LH    @05,B                                               0924
         MH    @05,@CH00042                                        0924
         L     @01,SENSEPTR                                        0924
         AL    @01,@CF01857                                        0924
         SLR   @15,@15                                             0924
         IC    @15,BYTE19-22(@05,@01)                              0924
         CH    @15,SV19MAX3                                        0924
         BNH   @RF00924                                            0924
*                SV19MAX3=BYTE19(B);                               0925
         STH   @15,SV19MAX3                                        0925
*              IF BYTE19(B)<SV19MIN3 THEN/* SET TO 1- FIRST TIME      *
@RF00924 LH    @05,B                                               0926
         MH    @05,@CH00042                                        0926
         L     @01,SENSEPTR                                        0926
         AL    @01,@CF01857                                        0926
         SLR   @15,@15                                             0926
         IC    @15,BYTE19-22(@05,@01)                              0926
         CH    @15,SV19MIN3                                        0926
         BNL   @RF00926                                            0926
*                SV19MIN3=BYTE19(B);                               0927
         STH   @15,SV19MIN3                                        0927
*            END;                                                  0928
@RF00926 DS    0H                                                  0929
*    END;                                                          0929
@RF00922 DS    0H                                                  0929
@RC00915 DS    0H                                                  0929
@RC00908 LA    @05,1                                               0929
         AH    @05,B                                               0929
         STH   @05,B                                               0929
@DE00882 CH    @05,INTABLE                                         0929
         BNH   @DL00882                                            0929
*    IF(SCFLAG1=ON&SCFLAG2=OFF)×(SCFLAG1=OFF&SCFLAG2=ON) THEN      0930
         TM    SCFLAG1,B'10000000'                                 0930
         BNO   @GL00061                                            0930
         TM    SCFLAG2,B'01000000'                                 0930
         BZ    @RT00930                                            0930
@GL00061 TM    SCFLAG2,B'01000000'                                 0930
         BNO   @RF00930                                            0930
         TM    SCFLAG1,B'10000000'                                 0930
         BNZ   @RF00930                                            0930
@RT00930 DS    0H                                                  0931
*      BYTE=(BYTE×'0800'X);          /* SET Y4 = ON                   *
         OC    BYTE(2),@CB01681                                    0931
*    IF DEBUG61=ON THEN                                            0932
@RF00930 TM    DEBUG61(R2),B'00000100'                             0932
         BNO   @RF00932                                            0932
*      DO;                                                         0933
*        CALL CONVERT1(TWO,PRT0,ADDR(BYTE));                       0934
         LA    @05,BYTE                                            0934
         ST    @05,@AFTEMPS+24                                     0934
         LA    @01,@AL00934                                        0934
         BAL   @14,CONVERT1                                        0934
*        CALL CONVERT1(TWO,PRT6,ADDR(SCFLAG));/* FLAG BITS FOR THIS
*                                       OPTION                        *
         LA    @05,SCFLAG                                          0935
         ST    @05,@AFTEMPS+24                                     0935
         LA    @01,@AL00935                                        0935
         BAL   @14,CONVERT1                                        0935
*        CALL CONVERT1(T24,PRT12,ADDR(SV19USE));                   0936
         LA    @05,SV19USE                                         0936
         ST    @05,@AFTEMPS+24                                     0936
         LA    @01,@AL00936                                        0936
         BAL   @14,CONVERT1                                        0936
*        CALL PRINTIT;                                             0937
         BAL   @14,PRINTIT                                         0937
*      END;                                                        0938
*    END GRP4EAC;                                                  0939
@EL00022 DS    0H                                                  0939
@EF00022 DS    0H                                                  0939
@ER00022 LM    @14,@12,@SA00022                                    0939
         BR    @14                                                 0939
* /********************************************************************
* /*    THIS PROC WILL PRINT THE MODIFERS FOR GROUP4                  *
*GP4MODIF:                                                         0940
*    PROC;                                                         0940
GP4MODIF STM   @14,@12,@SA00023                                    0940
*    CALL PRINTIT;                   /* PRINT A BLANK LINE            *
         BAL   @14,PRINTIT                                         0941
*    SCMOD1D=SCMOD1;                 /* LINE 1 OF THE MODIFERS        *
         MVC   SCMOD1D(50),SCMOD1                                  0942
*    CALL PRINTIT;                   /* PRINT LINE ONE                *
         BAL   @14,PRINTIT                                         0943
*    SCMXD2D=SCMXD2;                 /* MOVE IN THE SECOND LINE(NOT A
*                                       HEADING)                      *
         MVC   SCMXD2D(46),SCMXD2                                  0944
*    IF SV19MAX1^=SMAX1 THEN         /* MAX FOR FSC OF 152C           *
         CLC   SV19MAX1(2),SMAX1                                   0945
         BE    @RF00945                                            0945
*      CALL CONVBIN(3,SV19MAX1,PRT15);/* CONVERT TO PRINTABLE         *
         LA    @01,@AL00946                                        0946
         BAL   @14,CONVBIN                                         0946
*    IF SV19MAX2^=SMAX2 THEN         /* MAX FOR FSC OF 154E           *
@RF00945 CLC   SV19MAX2(2),SMAX2                                   0947
         BE    @RF00947                                            0947
*      CALL CONVBIN(3,SV19MAX2,PRT42);/* CONVERT T0 PRINTABLE         *
         LA    @01,@AL00948                                        0948
         BAL   @14,CONVBIN                                         0948
*    CALL PRINTIT;                   /* PRINT THE RESULT              *
@RF00947 BAL   @14,PRINTIT                                         0949
*    SCMXD3D=SCMXD3;                                               0950
         MVC   SCMXD3D(46),SCMXD3                                  0950
*    IF SV19MIN1^=SMIN1 THEN         /* MIN FOR FSC OF 152C           *
         CLC   SV19MIN1(2),SMIN1                                   0951
         BE    @RF00951                                            0951
*      CALL CONVBIN(3,SV19MIN1,PRT15);                             0952
         LA    @01,@AL00952                                        0952
         BAL   @14,CONVBIN                                         0952
*    IF SV19MIN2^=SMIN2 THEN         /* MIN FOR FSC OF 154E           *
@RF00951 CLC   SV19MIN2(2),SMIN2                                   0953
         BE    @RF00953                                            0953
*      CALL CONVBIN(3,SV19MIN2,PRT42);                             0954
         LA    @01,@AL00954                                        0954
         BAL   @14,CONVBIN                                         0954
*    CALL PRINTIT;                   /* PRINT THE MODIFER RESULT      *
@RF00953 BAL   @14,PRINTIT                                         0955
*    SCMOD2D=SCMOD2;                                               0956
         MVC   SCMOD2D(16),SCMOD2                                  0956
*    IF SV19MAX3^=SMAX3 THEN         /* MAX FOR FAULT CODE OF 1444 OR
*                                       1448                          *
         CLC   SV19MAX3(2),SMAX3                                   0957
         BE    @RF00957                                            0957
*      CALL CONVBIN(3,SV19MAX3,PRT42);                             0958
         LA    @01,@AL00958                                        0958
         BAL   @14,CONVBIN                                         0958
*    CALL PRINTIT;                                                 0959
@RF00957 BAL   @14,PRINTIT                                         0959
*    SCMOD3D=SCMOD3;                                               0960
         MVC   SCMOD3D(16),SCMOD3                                  0960
*    IF SV19MIN3^=SMIN3 THEN                                       0961
         CLC   SV19MIN3(2),SMIN3                                   0961
         BE    @RF00961                                            0961
*      CALL CONVBIN(3,SV19MIN3,PRT42);                             0962
         LA    @01,@AL00962                                        0962
         BAL   @14,CONVBIN                                         0962
*    CALL PRINTIT;                   /* PRINT THE NUMBERS OUT         *
@RF00961 BAL   @14,PRINTIT                                         0963
*    SV19USE=SV19RUSE;               /* RESTORE THE DEFAULTS          *
         MVC   SV19USE(12),SV19RUSE                                0964
*    END;                                                          0965
@EL00023 DS    0H                                                  0965
@EF00023 DS    0H                                                  0965
@ER00023 LM    @14,@12,@SA00023                                    0965
         BR    @14                                                 0965
* /********************************************************************
* /*                       DORW                                       *
* /*    BUILD THE EAC FOR GROUP 5 TYPE-RW READ/WRITE SAFTEY           *
* /*    ONLY 1 LINE FOR EACH CUA AS THERE ARE NO MODIFERS             *
* /*    THE OUTPUT FORMAT FOR THIS GROUP IS:                          *
* /*    CUA = XXX   TYPE = RW   EAC = E1,E2,E3,E4(XXXX) SAMPLES = XXXX*
* /*                            (EAC IS COMPOSED OF 4 HEX CHARACTERS) *
* /*                                                                  *
* /*    THE CUA IS TAKEN FROM THE SORT TABLE ENTRY                    *
* /*    RW IS PRINTED FOR ALL GROUP5 ENTRIES                          *
* /*    SAMPLES = NUMBER OF RECORDS PROCESSED THIS GROUP              *
* /*    EAC:  E1 = 4 BITS Y0,Y1,Y2 & Y3                               *
* /*               Y0 = NOT USED                                      *
* /*               Y1 = NOT USED                                      *
* /*               Y2 = ON IF ANY GROUP5 ERRORS AGAINST ANY CUA IN    *
* /*                    THIS CUA'S STRING EXCLUDING THE ADJACENT      *
* /*                    ADDRESS.                                      *
* /*               Y3 = ON IF ANY GROUP5 ERRORS AGAINST THE ADJACENT  *
* /*          E2 = 4 BITS Y4,Y5,Y6, & Y7                              *
* /*               Y4 = NOT USED                                      *
* /*               Y5 = NOT USED                                      *
* /*               Y6 = ON IF SENSE BYTE 14 BIT 1 = ON ANY RECORD     *
* /*               Y7 = ON IF SENSE BYTE 5 HAS A VALUE > '0B'X  ANY   *
* /*                    GROUP 5 RECORD                                *
* /*          E3 = SEE SPEC                                           *
* /*          E4 = SEE SPEC                                           *
*DORW:                                                             0966
*    PROC;                                                         0966
DORW     STM   @14,@12,@SA00024                                    0966
*    CALL READREC(ALLCOUNT(A,FIVE)); /* READ THIS GROUP RECORDS       *
         LH    @05,A                                               0967
         MH    @05,@CH00081                                        0967
         AH    @05,FIVE                                            0967
         ALR   @05,@05                                             0967
         LA    @05,ALLCOUNT-14(@05)                                0967
         ST    @05,@AL00001                                        0967
         LA    @01,@AL00001                                        0967
         BAL   @14,READREC                                         0967
*    BYTE=BYTE&&BYTE;                /* CLEAR THE ANSWER              *
         XC    BYTE(2),BYTE                                        0968
*    Y8Y9ZERO=Y8Y9ZERO&&Y8Y9ZERO;                                  0969
         XC    Y8Y9ZERO(4),Y8Y9ZERO                                0969
*    DO M=1 BY 1 TO INTABLE;         /* INTABLE = # ALL RECORDS READ
*                                       THIS CUA                      *
         LA    @05,1                                               0970
         STH   @05,M                                               0970
         B     @DE00970                                            0970
@DL00970 DS    0H                                                  0971
*      IF BIT141(M)=ON THEN          /* BIT 1 BYTE 14                 *
         MH    @05,@CH00042                                        0971
         L     @01,SENSEPTR                                        0971
         ALR   @01,@05                                             0971
         AL    @01,@CF01864                                        0971
         TM    BIT141-17(@01),B'01000000'                          0971
         BNO   @RF00971                                            0971
*        Y6=ON;                                                    0972
         OI    Y6,B'00000010'                                      0972
*      IF BYTE5(M)>11 THEN           /* BYTE 5                        *
@RF00971 LH    @05,M                                               0973
         MH    @05,@CH00042                                        0973
         L     @01,SENSEPTR                                        0973
         AL    @01,@CF01875                                        0973
         SLR   @00,@00                                             0973
         IC    @00,BYTE5-8(@05,@01)                                0973
         CH    @00,@CH00034                                        0973
         BNH   @RF00973                                            0973
*        Y7=ON;                                                    0974
         OI    Y7,B'00000001'                                      0974
*      IF BIT135(M)=ON THEN          /* BIT 5 BYTE 13                 *
@RF00973 LH    @05,M                                               0975
         MH    @05,@CH00042                                        0975
         L     @01,SENSEPTR                                        0975
         ALR   @01,@05                                             0975
         AL    @01,@CF01886                                        0975
         TM    BIT135-16(@01),B'00000100'                          0975
         BNO   @RF00975                                            0975
*        Y8COUNT=Y8COUNT+ONE;                                      0976
         LH    @05,Y8COUNT                                         0976
         AH    @05,ONE                                             0976
         STH   @05,Y8COUNT                                         0976
*      IF BIT130(M)=ON×BIT134(M)=ON×BIT136(M)=ON×BIT137(M)=ON×BIT145(M)
*          ON×BIT146(M)=ON×BIT147(M)=ON THEN                       0977
@RF00975 L     @05,SENSEPTR                                        0977
         LH    @15,M                                               0977
         MH    @15,@CH00042                                        0977
         ST    @15,@TF00001                                        0977
         ALR   @15,@05                                             0977
         AL    @15,@CF01886                                        0977
         TM    BIT130-16(@15),B'10001011'                          0977
         BNZ   @RT00977                                            0977
         AL    @05,@TF00001                                        0977
         AL    @05,@CF01864                                        0977
         TM    BIT145-17(@05),B'00000111'                          0977
         BZ    @RF00977                                            0977
@RT00977 DS    0H                                                  0978
*        Y9COUNT=Y9COUNT+ONE;                                      0978
         LH    @05,Y9COUNT                                         0978
         AH    @05,ONE                                             0978
         STH   @05,Y9COUNT                                         0978
*    END;                                                          0979
@RF00977 LA    @05,1                                               0979
         AH    @05,M                                               0979
         STH   @05,M                                               0979
@DE00970 CH    @05,INTABLE                                         0979
         BNH   @DL00970                                            0979
*    IF Y8COUNT>ZERO&INTABLE>1 THEN                                0980
         LH    @05,Y8COUNT                                         0980
         LTR   @05,@05                                             0980
         BNP   @RF00980                                            0980
         LA    @05,1                                               0980
         CH    @05,INTABLE                                         0980
         BNL   @RF00980                                            0980
*      DO C=1 BY 1 TO INTABLE-1;                                   0981
         STH   @05,C                                               0981
         B     @DE00981                                            0981
@DL00981 DS    0H                                                  0982
*        DO B=C+1 BY ONE TO INTABLE;                               0982
         AH    @05,@CH00057                                        0982
         B     @DE00982                                            0982
@DL00982 DS    0H                                                  0983
*          IF BIT135(B)=ON&BIT135(C)=OFF THEN                      0983
         L     @15,SENSEPTR                                        0983
         LA    @14,31                                              0983
         LR    @01,@05                                             0983
         MR    @00,@14                                             0983
         ALR   @01,@15                                             0983
         AL    @01,@CF01886                                        0983
         TM    BIT135-16(@01),B'00000100'                          0983
         BNO   @RF00983                                            0983
         MH    @14,C                                               0983
         ALR   @15,@14                                             0983
         AL    @15,@CF01886                                        0983
         TM    BIT135-16(@15),B'00000100'                          0983
         BNZ   @RF00983                                            0983
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        0984
*        END;                                                      0985
@RF00983 LH    @05,B                                               0985
         AH    @05,ONE                                             0985
@DE00982 STH   @05,B                                               0985
         CH    @05,INTABLE                                         0985
         BNH   @DL00982                                            0985
*      END;                                                        0986
         LA    @05,1                                               0986
         AH    @05,C                                               0986
         STH   @05,C                                               0986
@DE00981 LH    @15,INTABLE                                         0986
         BCTR  @15,0                                               0986
         CR    @05,@15                                             0986
         BNH   @DL00981                                            0986
*    IF Y8COUNT>ZERO THEN                                          0987
@RF00980 LH    @05,Y8COUNT                                         0987
         LTR   @05,@05                                             0987
         BNP   @RF00987                                            0987
*      DO;                                                         0988
*        CALL FINISHRW(Y8COUNT);     /* BUILD Y8 TO YC                *
         LA    @01,@AL00989                                        0989
         BAL   @14,FINISHRW                                        0989
*        SLL(BYTES1,4);              /* POSITION ANSWER CORRECTLY     *
         MVC   @ZT00002+2(2),BYTES1                                0990
         L     @05,@ZT00002                                        0990
         SLL   @05,4                                               0990
         STH   @05,@TF00001                                        0990
         MVC   BYTES1(2),@TF00001                                  0990
*        BYTE=(BYTE×BYTES1);         /* MERGE ANSWER INTO EAC         *
         OC    BYTE(2),BYTES1                                      0991
*        SAVESWIT=GP5SWIT;           /* FOR DEBUG AS WILL CHANGE IF
*                                       BOTH Y8,Y9                    *
         MVC   SAVESWIT(2),GP5SWIT                                 0992
*      END;                                                        0993
*    IF Y9COUNT>ZERO&INTABLE>1 THEN                                0994
@RF00987 LH    @05,Y9COUNT                                         0994
         LTR   @05,@05                                             0994
         BNP   @RF00994                                            0994
         LA    @05,1                                               0994
         CH    @05,INTABLE                                         0994
         BNL   @RF00994                                            0994
*      DO C=1 BY 1 TO INTABLE-1;                                   0995
         STH   @05,C                                               0995
         B     @DE00995                                            0995
@DL00995 DS    0H                                                  0996
*        DO B=C+1 BY ONE TO INTABLE;                               0996
         AH    @05,@CH00057                                        0996
         B     @DE00996                                            0996
@DL00996 DS    0H                                                  0997
*          IF(BIT130(B)=ON×BIT134(B)=ON×BIT136(B)=ON×BIT137(B)=ON×BIT14
*              (B)=ON×BIT146(B)=ON×BIT147(B)=ON)&(BIT130(C)=OFF&BIT134(
*              )=OFF&BIT136(C)=OFF&BIT137(C)=OFF&BIT145(C)=OFF&BIT146(C
*              =OFF&BIT147(C)=OFF) THEN                            0997
         L     @15,SENSEPTR                                        0997
         MH    @05,@CH00042                                        0997
         ST    @05,@TF00001                                        0997
         ALR   @05,@15                                             0997
         AL    @05,@CF01886                                        0997
         TM    BIT130-16(@05),B'10001011'                          0997
         BNZ   @GL00066                                            0997
         AL    @15,@TF00001                                        0997
         AL    @15,@CF01864                                        0997
         TM    BIT145-17(@15),B'00000111'                          0997
         BZ    @RF00997                                            0997
@GL00066 L     @05,SENSEPTR                                        0997
         LH    @15,C                                               0997
         MH    @15,@CH00042                                        0997
         ST    @15,@TF00001                                        0997
         ALR   @15,@05                                             0997
         AL    @15,@CF01886                                        0997
         TM    BIT130-16(@15),B'10001011'                          0997
         BNZ   @RF00997                                            0997
         AL    @05,@TF00001                                        0997
         AL    @05,@CF01864                                        0997
         TM    BIT145-17(@05),B'00000111'                          0997
         BNZ   @RF00997                                            0997
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        0998
*        END;                                                      0999
@RF00997 LH    @05,B                                               0999
         AH    @05,ONE                                             0999
@DE00996 STH   @05,B                                               0999
         CH    @05,INTABLE                                         0999
         BNH   @DL00996                                            0999
*      END;                                                        1000
         LA    @05,1                                               1000
         AH    @05,C                                               1000
         STH   @05,C                                               1000
@DE00995 LH    @15,INTABLE                                         1000
         BCTR  @15,0                                               1000
         CR    @05,@15                                             1000
         BNH   @DL00995                                            1000
*    IF Y9COUNT^=ZERO THEN           /* ANY RECORDS FOR THE YC TO YF
*                                       FIELD                         *
@RF00994 LH    @05,Y9COUNT                                         1001
         LTR   @05,@05                                             1001
         BZ    @RF01001                                            1001
*      DO;                                                         1002
*        CALL FINISHRW(Y9COUNT);     /* GO BUILD YC TO YF             *
         LA    @01,@AL01003                                        1003
         BAL   @14,FINISHRW                                        1003
*        BYTE=(BYTE×BYTES1);         /* ANSWER IS POSITIONED IN BYTES1
*                                       CORRECT                       *
         OC    BYTE(2),BYTES1                                      1004
*      END;                                                        1005
*    IF DEBUG61=ON THEN                                            1006
@RF01001 TM    DEBUG61(R2),B'00000100'                             1006
         BNO   @RF01006                                            1006
*      DO;                                                         1007
*        CALL CONVERT1(TWO,PRT0,ADDR(BYTE));                       1008
         LA    @05,BYTE                                            1008
         ST    @05,@AFTEMPS+28                                     1008
         LA    @01,@AL01008                                        1008
         BAL   @14,CONVERT1                                        1008
*        CALL CONVERT1(TWO,PRT6,ADDR(GP5SWIT));                    1009
         LA    @05,GP5SWIT                                         1009
         ST    @05,@AFTEMPS+28                                     1009
         LA    @01,@AL01009                                        1009
         BAL   @14,CONVERT1                                        1009
*        CALL CONVBIN(3,Y8COUNT,PRT12);                            1010
         LA    @01,@AL01010                                        1010
         BAL   @14,CONVBIN                                         1010
*        CALL CONVBIN(3,Y9COUNT,PRT18);                            1011
         LA    @01,@AL01011                                        1011
         BAL   @14,CONVBIN                                         1011
*        CALL CONVERT1(TWO,PRT25,ADDR(BYTES1));                    1012
         LA    @05,BYTES1                                          1012
         ST    @05,@AFTEMPS+28                                     1012
         LA    @01,@AL01012                                        1012
         BAL   @14,CONVERT1                                        1012
*        CALL CONVERT1(TWO,PRT32,ADDR(SAVESWIT));                  1013
         LA    @05,SAVESWIT                                        1013
         ST    @05,@AFTEMPS+28                                     1013
         LA    @01,@AL01013                                        1013
         BAL   @14,CONVERT1                                        1013
*        CALL PRINTIT;                                             1014
         BAL   @14,PRINTIT                                         1014
*      END;                                                        1015
*    MAINMDC(A,FIVE)=(MAINMDC(A,FIVE)×BYTE);/* FINISH THE EAC         *
@RF01006 LH    @05,A                                               1016
         MH    @05,@CH00081                                        1016
         AH    @05,FIVE                                            1016
         ALR   @05,@05                                             1016
         LA    @01,MAINMDC-14(@05)                                 1016
         OC    0(2,@01),BYTE                                       1016
*    CALL PRTHEAD(FIVE);             /* PRINT THE EAC LINE            *
         LA    @01,@AL01017                                        1017
         BAL   @14,PRTHEAD                                         1017
*    END DORW;                                                     1018
@EL00024 DS    0H                                                  1018
@EF00024 DS    0H                                                  1018
@ER00024 LM    @14,@12,@SA00024                                    1018
         BR    @14                                                 1018
* /********************************************************************
* /*                         FINISHRW                                 *
* /*  THIS PROC WILL BUILD Y9 TO YB OR YD TO YF DEPENDING ON THE INPUT*
* /*  NUMBER RECORDS.  THIS WILL BE PASSED BY CALLING PROC            *
* /*  THE CALLING ROUTINE WILL AHVE TO POSITION THE CHAR IN THE ANSWER*
*                                                                  1019
*FINISHRW:                                                         1019
*    PROC(Y8TOYF);                   /* WILL PROCESS A SUBSET OF GROUP
*                                       5 RECORDS                     *
FINISHRW STM   @14,@12,12(@13)                                     1019
         MVC   @PC00025(4),0(@01)                                  1019
*    DCL                                                           1020
*      Y8TOYF FIXED(15);             /* NUMBER OF RECORDS TO PROCESS  *
*    BYTES1=BYTES1&&BYTES1;          /* CLEAR THE ANSWER              *
         XC    BYTES1(2),BYTES1                                    1021
*    GP5SWIT=GP5SWIT&&GP5SWIT;       /* CLEAR THIS GROUP FLAGS        *
         XC    GP5SWIT(2),GP5SWIT                                  1022
* /*   BYTE5ALL = OFF  ANY RECORD WITH BYTE 5 < THAN 12               *
* /*   BYTE5FLG = OFF  ANY RECORD WITH BYTE 5 > THAN 11               *
* /*   BYT5FAIL = OFF  MORE THAN ONE VALUE OF BYTE 5                  *
* /*   INTERGAL = OFF  USED TO INDICATE THE INTERGALS OF SB5 WERE ^=  *
*    DO M=1 BY 1 TO Y8TOYF;                                        1023
         LA    @05,1                                               1023
         STH   @05,M                                               1023
         B     @DE01023                                            1023
@DL01023 DS    0H                                                  1024
*      IF BYTE5(M)>11 THEN                                         1024
         MH    @05,@CH00042                                        1024
         L     @01,SENSEPTR                                        1024
         AL    @01,@CF01875                                        1024
         SLR   @00,@00                                             1024
         IC    @00,BYTE5-8(@05,@01)                                1024
         CH    @00,@CH00034                                        1024
         BNH   @RF01024                                            1024
*        BYTE5FLG=ON;                /* FLAG FOR ALL SB5S > 11        *
         OI    BYTE5FLG,B'01000000'                                1025
*      ELSE                                                        1026
*        BYTE5ALL=ON;                /* CAN TELL IF SOME WERE < 12    *
         B     @RC01024                                            1026
@RF01024 OI    BYTE5ALL,B'10000000'                                1026
*      IF M^=1 THEN                  /* CANNOT COMPARE FIRST TIME     *
@RC01024 LH    @05,M                                               1027
         CH    @05,@CH00057                                        1027
         BE    @RF01027                                            1027
*        IF BYTE5(M-1)^=BYTE5(M) THEN                              1028
         L     @15,SENSEPTR                                        1028
         MH    @05,@CH00042                                        1028
         ST    @05,@TF00001                                        1028
         ALR   @05,@15                                             1028
         AL    @05,@CF01887                                        1028
         AL    @15,@TF00001                                        1028
         AL    @15,@CF01875                                        1028
         CLC   BYTE5-8(1,@05),BYTE5-8(@15)                         1028
         BE    @RF01028                                            1028
*          BYT5FAIL=ON;                                            1029
         OI    BYT5FAIL,B'00100000'                                1029
*    END;                                                          1030
@RF01028 DS    0H                                                  1030
@RF01027 LA    @05,1                                               1030
         AH    @05,M                                               1030
         STH   @05,M                                               1030
@DE01023 L     @15,@PC00025                                        1030
         CH    @05,Y8TOYF(,@15)                                    1030
         BNH   @DL01023                                            1030
*    IF BYTE5FLG=OFF THEN            /* ALL SAMPLES < 12              *
         TM    BYTE5FLG,B'01000000'                                1031
         BNZ   @RF01031                                            1031
*      DO;                                                         1032
*        IF BYT5FAIL=OFF THEN        /* THEY WERE NOT EQUAL           *
         TM    BYT5FAIL,B'00100000'                                1033
         BNZ   @RF01033                                            1033
*          BYTES1=TWO;               /* SINGLE R/W HEAD FAILURE    1034
*                                       MOVEABLE HEAD                 *
         MVC   BYTES1(2),TWO                                       1034
*        ELSE                                                      1035
*          DO;                                                     1035
         B     @RC01033                                            1035
@RF01033 DS    0H                                                  1036
*            INTERGAL=OFF;           /* SET FLAG OFF PRIOR TO TEST    *
         NI    INTERGAL,B'11101111'                                1036
*            DO M=1 BY 1 TO Y8TOYF;                                1037
         LA    @05,1                                               1037
         STH   @05,M                                               1037
         B     @DE01037                                            1037
@DL01037 DS    0H                                                  1038
*              IF M^=1 THEN          /* DONT CHECK FIRST TIME         *
         CH    @05,@CH00057                                        1038
         BE    @RF01038                                            1038
*                IF DIVIDE24(M-1)^=DIVIDE24(M) THEN/* ALL INTERGALS = *
         L     @15,SENSEPTR                                        1039
         MH    @05,@CH00042                                        1039
         ST    @05,@TF00001                                        1039
         ALR   @05,@15                                             1039
         AL    @05,@CF01878                                        1039
         AL    @15,@TF00001                                        1039
         AL    @15,@CF01877                                        1039
         CLC   DIVIDE24-27(1,@05),DIVIDE24-27(@15)                 1039
         BE    @RF01039                                            1039
*                  INTERGAL=ON;      /* NO THEY WERE NOT              *
         OI    INTERGAL,B'00010000'                                1040
*            END;                                                  1041
@RF01039 DS    0H                                                  1041
@RF01038 LA    @05,1                                               1041
         AH    @05,M                                               1041
         STH   @05,M                                               1041
@DE01037 L     @15,@PC00025                                        1041
         CH    @05,Y8TOYF(,@15)                                    1041
         BNH   @DL01037                                            1041
*            IF INTERGAL=ON THEN                                   1042
         TM    INTERGAL,B'00010000'                                1042
         BNO   @RF01042                                            1042
*              BYTES1=SIX;           /* ERRORS AGAINST MULIT AE SELECT
*                                       MODULES                       *
         MVC   BYTES1(2),SIX                                       1043
*            ELSE                                                  1044
*              BYTES1=FOUR;          /* SELECT MODULE FAILURE-MOVEABLE
*                                       HEAD                          *
         B     @RC01042                                            1044
@RF01042 MVC   BYTES1(2),@CH00066                                  1044
*          END;                                                    1045
*      END;                                                        1046
*    ELSE                                                          1047
*      DO;                                                         1047
         B     @RC01031                                            1047
@RF01031 DS    0H                                                  1048
*        IF BYTE5ALL=OFF THEN        /* WERE ALL BYTE 5'S > 11        *
         TM    BYTE5ALL,B'10000000'                                1048
         BNZ   @RF01048                                            1048
*          DO;                       /* YES THEY WERE                 *
*            IF BYT5FAIL=OFF THEN                                  1050
         TM    BYT5FAIL,B'00100000'                                1050
         BNZ   @RF01050                                            1050
*              BYTES1=THREE;         /* SINGLE R/W HEAD FAILURE-FIXED
*                                       HEAD                          *
         MVC   BYTES1(2),THREE                                     1051
*            ELSE                                                  1052
*              DO;                                                 1052
         B     @RC01050                                            1052
@RF01050 DS    0H                                                  1053
*                INTERGAL=OFF;       /* FLAG FOR MISMATCH ON INTEGRALS*
         NI    INTERGAL,B'11101111'                                1053
*                DO M=1 BY 1 TO Y8TOYF;                            1054
         LA    @05,1                                               1054
         STH   @05,M                                               1054
         B     @DE01054                                            1054
@DL01054 DS    0H                                                  1055
*                  IF M^=1 THEN      /* DONT CHECK FIRST TIME         *
         CH    @05,@CH00057                                        1055
         BE    @RF01055                                            1055
*                    IF DIVIDE24(M-1)^=DIVIDE24(M) THEN/* ALL      1056
*                                       INTERGALS =                   *
         L     @15,SENSEPTR                                        1056
         MH    @05,@CH00042                                        1056
         ST    @05,@TF00001                                        1056
         ALR   @05,@15                                             1056
         AL    @05,@CF01878                                        1056
         AL    @15,@TF00001                                        1056
         AL    @15,@CF01877                                        1056
         CLC   DIVIDE24-27(1,@05),DIVIDE24-27(@15)                 1056
         BE    @RF01056                                            1056
*                      INTERGAL=ON;  /* NO THEY WERE NOT              *
         OI    INTERGAL,B'00010000'                                1057
*                END;                                              1058
@RF01056 DS    0H                                                  1058
@RF01055 LA    @05,1                                               1058
         AH    @05,M                                               1058
         STH   @05,M                                               1058
@DE01054 L     @15,@PC00025                                        1058
         CH    @05,Y8TOYF(,@15)                                    1058
         BNH   @DL01054                                            1058
*                IF INTERGAL=ON THEN                               1059
         TM    INTERGAL,B'00010000'                                1059
         BNO   @RF01059                                            1059
*                  BYTES1=SEVEN;     /* MULTI SELECT MODULES       1060
*                                       FAILED-FIXED HEAD             *
         MVC   BYTES1(2),SEVEN                                     1060
*                ELSE                                              1061
*                  BYTES1=FIVE;      /* SINGLE SELECT MODULE       1061
*                                       FAIL-FIXED HEAD               *
         B     @RC01059                                            1061
@RF01059 MVC   BYTES1(2),FIVE                                      1061
*              END;                                                1062
*          END;                                                    1063
*        ELSE                                                      1064
*          BYTES1=ONE;               /* MULTI MODULES MOVEABLE AND 1064
*                                       FIXED HEAD FAILURES           *
         B     @RC01048                                            1064
@RF01048 MVC   BYTES1(2),ONE                                       1064
*      END;                                                        1065
*    END FINISHRW;                                                 1066
@EL00025 DS    0H                                                  1066
@EF00025 DS    0H                                                  1066
@ER00025 LM    @14,@12,12(@13)                                     1066
         BR    @14                                                 1066
* /********************************************************************
* /*                          DODC                                    *
* /*    THIS PROC WILL PROCESS ALL GROUP 6 RECORDS ALL FORMAT 4X & 5X *
* /*    2 EAC'S ARE BUILT FOR EACH CUA ONE USING ALL RECORDS FROM THIS*
* /*    CUA AND ONE USING ONLY ONES WITH THE EVD BIT ON.              *
* /*   CUA = XXX   TYPE DC    EAC = F1,F2,F3,F4(XXXX)  SAMMPLES = XXXX*
* /*                          (EAC IS COMPOSED OF 4 HEX BYTES)        *
* /*   THE CUA IS TAKEN FROM THE SORTABLE ENTRY                       *
* /*   TYPE DC  IS PRINTED FOR ALL GROUP6 ENTRIES                     *
* /*   SAMPLES = NUMBER OF RECORDS PROCESSED THIS GROUP               *
* /*   EAC:                                                           *
* /*      F1 = 4 BITS Y0,Y1,Y2,Y3                                     *
* /*       Y0 = 1 FOR SET OF RECORDS WITH EVD BIT ON                  *
* /*       Y1 = NOT USED                                              *
* /*       Y2 = USE ONLY RECORDS WITH FSC OF 494X                     *
* /*            IF ANY IN THIS STRING EXCEPT THE ADJACENT ADDRESS     *
* /*            SET Y2 = ON                                           *
* /*       Y3 = USE ONLY RECORDS WITH FSC OF 494X                     *
* /*            IF ANY ERRORS LOGGED AGAINST THE ADJACENT ADDRESS THE *
* /*            SET Y3 = ON                                           *
* /*      F2 = 4 BITS Y4,Y5,Y6 & Y7                                   *
* /*       Y4  = NOT USED                                             *
* /*       Y5,Y6, & Y7 ARE BUILT FROM ONLY FORMAT 5 RECORDS           *
* /*           SEE SPEC FOR A DISCRIPTION OF HOW THESE ARE SET        *
* /*      F3 = 4 BITS Y8,Y9,YA, & YB    FROM FORMAT 4X RECORDS        *
* /*       Y8 = ON IF ANY FSC'S OF 4949 ARE RECORDED AGAINST THIS CUA *
* /*       Y9,YA & YB ARE DETERMINED FROM RECORDS WITH ONLY A FSC OF  *
* /*       4940, 4941, OR 4949  SEE SPEC FOR A DISCRIPTION OF HOW     *
* /*       THESE BITS ARE SET                                         *
* /*      F4 = 4 BITS YC,YD,YE, & YF                                  *
* /*       YC = ON IF ANY FSC OF 494D ARE RECORDED AGAINST THIS CUA   *
* /*       YD,YE, & YF ARE DERIVED FROM ONLY FSC'S OF 4944, 4945 OR   *
* /*       494D.  SEE SPEC TO DETERMINE HOW THESE BITS ARE SET        *
*DODC:                                                             1067
*    PROC;                                                         1067
DODC     STM   @14,@12,@SA00026                                    1067
*    IF SWITCH3=OFF THEN             /* IF OFF THEN PROCESSING ALL 1068
*                                       RECORDS                       *
         TM    SWITCH3,B'00001000'                                 1068
         BNZ   @RF01068                                            1068
*      CALL READREC(ALLCOUNT(A,SIX));/* READ THIS GROUP RECORDS       *
         LH    @05,A                                               1069
         MH    @05,@CH00081                                        1069
         AH    @05,SIX                                             1069
         ALR   @05,@05                                             1069
         LA    @05,ALLCOUNT-14(@05)                                1069
         ST    @05,@AL00001                                        1069
         LA    @01,@AL00001                                        1069
         BAL   @14,READREC                                         1069
*    ELSE                                                          1070
*      INTABLE=EVDCOUNT(A,SIX);      /* ONLY EVD & RECORDS ARE IN CORE
*                                       NOW                           *
         B     @RC01068                                            1070
@RF01068 LH    @05,A                                               1070
         MH    @05,@CH00081                                        1070
         AH    @05,SIX                                             1070
         ALR   @05,@05                                             1070
         LH    @05,EVDCOUNT-14(@05)                                1070
         STH   @05,INTABLE                                         1070
*    CALL BUILDRST;                  /* START BUILDING THE EAC        *
@RC01068 BAL   @14,BUILDRST                                        1071
*    IF SWITCH3=OFF THEN             /* PROCESS ALL RECORDS EAC       *
         TM    SWITCH3,B'00001000'                                 1072
         BNZ   @RF01072                                            1072
*      MAINMDC(A,SIX)=(MAINMDC(A,SIX)×BYTE);/* ALL RECORDS EVD        *
         LH    @05,A                                               1073
         MH    @05,@CH00081                                        1073
         AH    @05,SIX                                             1073
         ALR   @05,@05                                             1073
         LA    @01,MAINMDC-14(@05)                                 1073
         OC    0(2,@01),BYTE                                       1073
*    ELSE                                                          1074
*      EVDMDC(A,SIX)=(EVDMDC(A,SIX)×BYTE);/* EVD RECORDS EAC          *
         B     @RC01072                                            1074
@RF01072 LH    @05,A                                               1074
         MH    @05,@CH00081                                        1074
         AH    @05,SIX                                             1074
         ALR   @05,@05                                             1074
         LA    @01,EVDMDC-14(@05)                                  1074
         OC    0(2,@01),BYTE                                       1074
*    CALL PRTHEAD(SIX);              /* HEADING FOR THE GROUP SIX  1075
*                                       RECORDS                       *
@RC01072 LA    @01,@AL01075                                        1075
         BAL   @14,PRTHEAD                                         1075
*    IF(BYTE&'0EEE'X)^='0000'X THEN  /* IF 1'S ON ONLY FORGET IT      *
         MVC   @TS00001(2),BYTE                                    1076
         NC    @TS00001(2),@CB01729                                1076
         CLC   @TS00001(2),@CB00208                                1076
         BE    @RF01076                                            1076
*      DO;                                                         1077
*        IF SWITCH3=ON&ALLCOUNT(A,SIX)=EVDCOUNT(A,SIX) THEN        1078
         TM    SWITCH3,B'00001000'                                 1078
         BNO   @RF01078                                            1078
         LH    @05,A                                               1078
         MH    @05,@CH00081                                        1078
         AH    @05,SIX                                             1078
         ALR   @05,@05                                             1078
         LH    @15,ALLCOUNT-14(@05)                                1078
         CH    @15,EVDCOUNT-14(@05)                                1078
         BNE   @RF01078                                            1078
*          DO;                                                     1079
*            PRTLINE=ALLEQUAL;                                     1080
         MVI   PRTLINE+41,C' '                                     1080
         MVC   PRTLINE+42(90),PRTLINE+41                           1080
         MVC   PRTLINE(41),ALLEQUAL                                1080
*            CALL PRINTIT;                                         1081
         BAL   @14,PRINTIT                                         1081
*          END;                                                    1082
*        ELSE                                                      1083
*          CALL GP6MODIF;            /* GO PRINT THE MODIFERS IF   1083
*                                       REQUIRED                      *
         B     @RC01078                                            1083
@RF01078 BAL   @14,GP6MODIF                                        1083
*      END;                                                        1084
@RC01078 DS    0H                                                  1085
*    SWITCH3=OFF;                    /* CLEAR FOR THE NEXT EVD        *
@RF01076 NI    SWITCH3,B'11110111'                                 1085
*    END DODC;                                                     1086
@EL00026 DS    0H                                                  1086
@EF00026 DS    0H                                                  1086
@ER00026 LM    @14,@12,@SA00026                                    1086
         BR    @14                                                 1086
* /********************************************************************
* /*                            BUILDRST                              *
* /*   THIS PROC WILL BUILD THREE HALF BYTES OF THE EAC THIS WILL BE  *
* /*   DONE TWICE.  ONCE FOR ALL RECORDS AND ONCE FOR RECORDS WITH THE*
* /*   EAC BIT ON.                                                    *
*BUILDRST:                                                         1087
*    PROC;                                                         1087
BUILDRST STM   @14,@12,@SA00027                                    1087
*    CLEARALL=CLEARALL&&CLEARALL;    /* CLEAR BUILDF3,F4,F5           *
         XC    CLEARALL(8),CLEARALL                                1088
*    BUILDFLG=BUILDFLG&&BUILDFLG;    /* CLEAR THIS PROCS FLAGS        *
         XC    BUILDFLG(6),BUILDFLG                                1089
*    BYTE=BYTE&&BYTE;                /* CLEAR THE ANSWER AREA         *
         XC    BYTE(2),BYTE                                        1090
*    DO B=1 BY 1 TO INTABLE;         /* DO FOR NUMBER OF RECORDS READ
*                                       IN                            *
         LA    @05,1                                               1091
         STH   @05,B                                               1091
         B     @DE01091                                            1091
@DL01091 DS    0H                                                  1092
*      BY22231=(BYTE2223(B)&'000F'X);                              1092
         L     @15,SENSEPTR                                        1092
         MH    @05,@CH00042                                        1092
         ST    @05,@TF00001                                        1092
         ALR   @05,@15                                             1092
         AL    @05,@CF01865                                        1092
         MVC   BY22231(2),BYTE2223-25(@05)                         1092
         NC    BY22231(2),@CB01734                                 1092
*      IF(BYTE7(B)&'F0'X)='50'X THEN /* = TO FORMAT 5                 *
         AL    @15,@TF00001                                        1093
         AL    @15,@CF01889                                        1093
         MVC   @TS00001(1),BYTE7-10(@15)                           1093
         NI    @TS00001,X'F0'                                      1093
         CLI   @TS00001,X'50'                                      1093
         BNE   @RF01093                                            1093
*        FORMAT5=FORMAT5+1;          /* FORMAT 5 COUNTER              *
         LH    @05,FORMAT5                                         1094
         LA    @05,1(,@05)                                         1094
         STH   @05,FORMAT5                                         1094
*      ELSE                                                        1095
*        IF BY22231='0000'X×BY22231='0001'X×BY22231='0009'X THEN   1095
         B     @RC01093                                            1095
@RF01093 CLC   BY22231(2),@CB00208                                 1095
         BE    @RT01095                                            1095
         CLC   BY22231(2),@CB01736                                 1095
         BE    @RT01095                                            1095
         CLC   BY22231(2),@CB01737                                 1095
         BNE   @RF01095                                            1095
@RT01095 DS    0H                                                  1096
*          DO;                                                     1096
*            BUILDF3=BUILDF3+1;      /* FSC COUNTER FOR 4940,41,49    *
         LH    @05,BUILDF3                                         1097
         LA    @05,1(,@05)                                         1097
         STH   @05,BUILDF3                                         1097
*            IF BY22231='0009'X THEN                               1098
         CLC   BY22231(2),@CB01737                                 1098
         BNE   @RF01098                                            1098
*              F4949=ON;             /* SAVE LATER SEARCH             *
         OI    F4949,B'10000000'                                   1099
*          END;                                                    1100
*        ELSE                                                      1101
*          IF BY22231='0004'X×BY22231='0005'X THEN                 1101
         B     @RC01095                                            1101
@RF01095 CLC   BY22231(2),@CB01738                                 1101
         BE    @RT01101                                            1101
         CLC   BY22231(2),@CB01739                                 1101
         BNE   @RF01101                                            1101
@RT01101 DS    0H                                                  1102
*            BUILDF4=BUILDF4+1;      /* COUNTER FOR TYPES 4944,45     *
         LH    @05,BUILDF4                                         1102
         LA    @05,1(,@05)                                         1102
         STH   @05,BUILDF4                                         1102
*          ELSE                                                    1103
*            IF BY22231='000D'X THEN                               1103
         B     @RC01101                                            1103
@RF01101 CLC   BY22231(2),@CB01740                                 1103
         BNE   @RF01103                                            1103
*              DO;                                                 1104
*                BUILDF4=BUILDF4+1;                                1105
         LH    @05,BUILDF4                                         1105
         LA    @05,1(,@05)                                         1105
         STH   @05,BUILDF4                                         1105
*                F4FLAG=ON;          /* SAVE LATTER SEARCH            *
         OI    F4FLAG,B'01000000'                                  1106
*              END;                                                1107
*    END;                                                          1108
@RF01103 DS    0H                                                  1108
@RC01101 DS    0H                                                  1108
@RC01095 DS    0H                                                  1108
@RC01093 LA    @05,1                                               1108
         AH    @05,B                                               1108
         STH   @05,B                                               1108
@DE01091 CH    @05,INTABLE                                         1108
         BNH   @DL01091                                            1108
*    IF BUILDF3^=ZERO THEN           /* FIND ANY FSC'S OF 4940,41,49  *
         LH    @05,BUILDF3                                         1109
         LTR   @05,@05                                             1109
         BZ    @RF01109                                            1109
*      CALL DOFSC1;                                                1110
         BAL   @14,DOFSC1                                          1110
*    IF FORMAT5^=ZERO THEN           /* NEED FORMAT 5 RECORDS FOR THIS
*                                       AREA                          *
@RF01109 LH    @05,FORMAT5                                         1111
         LTR   @05,@05                                             1111
         BZ    @RF01111                                            1111
*      CALL DOFOR5;                                                1112
         BAL   @14,DOFOR5                                          1112
*    IF BUILDF4^=ZERO THEN           /* FIND ANY FSC'S OF 4944 OR  1113
*                                       4945'S                        *
@RF01111 LH    @05,BUILDF4                                         1113
         LTR   @05,@05                                             1113
         BZ    @RF01113                                            1113
*      CALL DOFSC2;                                                1114
         BAL   @14,DOFSC2                                          1114
*    IF DEBUG61=ON THEN                                            1115
@RF01113 TM    DEBUG61(R2),B'00000100'                             1115
         BNO   @RF01115                                            1115
*      DO;                                                         1116
*        CALL CONVERT1(TWO,PRT0,ADDR(DCFLAGS1));                   1117
         LA    @05,DCFLAGS1                                        1117
         ST    @05,@AFTEMPS+32                                     1117
         LA    @01,@AL01117                                        1117
         BAL   @14,CONVERT1                                        1117
*        CALL CONVBIN(3,Y8COUNT,PRT6);                             1118
         LA    @01,@AL01118                                        1118
         BAL   @14,CONVBIN                                         1118
*        CALL CONVBIN(3,FORMAT5,PRT12);                            1119
         LA    @01,@AL01119                                        1119
         BAL   @14,CONVBIN                                         1119
*        CALL CONVBIN(3,BUILDF3,PRT18);                            1120
         LA    @01,@AL01120                                        1120
         BAL   @14,CONVBIN                                         1120
*        CALL CONVBIN(3,BUILDF4,PRT22);                            1121
         LA    @01,@AL01121                                        1121
         BAL   @14,CONVBIN                                         1121
*        CALL CONVBIN(3,RETURN1,PRT26);                            1122
         LA    @01,@AL01122                                        1122
         BAL   @14,CONVBIN                                         1122
*        CALL CONVERT1(TWO,PRT32,ADDR(BYTES1));                    1123
         LA    @05,BYTES1                                          1123
         ST    @05,@AFTEMPS+32                                     1123
         LA    @01,@AL01123                                        1123
         BAL   @14,CONVERT1                                        1123
*        CALL CONVERT1(TWO,PRT39,ADDR(BYTE));                      1124
         LA    @05,BYTE                                            1124
         ST    @05,@AFTEMPS+32                                     1124
         LA    @01,@AL01124                                        1124
         BAL   @14,CONVERT1                                        1124
*        CALL CONVERT1(TWO,PRT48,ADDR(DCFLAGS2));                  1125
         LA    @05,DCFLAGS2                                        1125
         ST    @05,@AFTEMPS+32                                     1125
         LA    @01,@AL01125                                        1125
         BAL   @14,CONVERT1                                        1125
*        CALL CONVERT1(TWO,PRT58,ADDR(DCFLAGS3));                  1126
         LA    @05,DCFLAGS3                                        1126
         ST    @05,@AFTEMPS+32                                     1126
         LA    @01,@AL01126                                        1126
         BAL   @14,CONVERT1                                        1126
*        CALL PRINTIT;               /* PRINT THE DEBUG OUTPUTS       *
         BAL   @14,PRINTIT                                         1127
*      END;                                                        1128
*    END BUILDRST;                                                 1129
@EL00027 DS    0H                                                  1129
@EF00027 DS    0H                                                  1129
@ER00027 LM    @14,@12,@SA00027                                    1129
         BR    @14                                                 1129
* /********************************************************************
* /*    THIS PROC WILL PROCESS THE FORMAT 5 RECORDS                   *
*DOFOR5:                                                           1130
*    PROC;                                                         1130
DOFOR5   STM   @14,@12,@SA00028                                    1130
*    IF INTABLE>ONE THEN             /* NEED MORE THAN 1 SAMPLE BEFORE
*                                       SORT                          *
         LH    @05,INTABLE                                         1131
         CH    @05,ONE                                             1131
         BNH   @RF01131                                            1131
*      DO C=1 BY 1 TO INTABLE-1;     /* FIRST SAMPLE                  *
         LA    @05,1                                               1132
         STH   @05,C                                               1132
         B     @DE01132                                            1132
@DL01132 DS    0H                                                  1133
*        DO B=C+1 BY ONE TO INTABLE; /* SECOND SAMPLE                 *
         AH    @05,@CH00057                                        1133
         B     @DE01133                                            1133
@DL01133 DS    0H                                                  1134
*          IF(BYTE7(B)&'F0'X)='50'X& /* IS 2ND ENTRY FORMAT 5         *
*              (BYTE7(C)&'F0'X)^='50'X THEN/* & NOT THE FIRST         *
         L     @15,SENSEPTR                                        1134
         LA    @14,31                                              1134
         LR    @01,@05                                             1134
         MR    @00,@14                                             1134
         ALR   @01,@15                                             1134
         AL    @01,@CF01889                                        1134
         MVC   @TS00001(1),BYTE7-10(@01)                           1134
         NI    @TS00001,X'F0'                                      1134
         CLI   @TS00001,X'50'                                      1134
         BNE   @RF01134                                            1134
         MH    @14,C                                               1134
         ALR   @15,@14                                             1134
         AL    @15,@CF01889                                        1134
         MVC   @TS00001(1),BYTE7-10(@15)                           1134
         NI    @TS00001,X'F0'                                      1134
         CLI   @TS00001,X'50'                                      1134
         BE    @RF01134                                            1134
*            CALL SORTSNSE;          /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        1135
*        END;                                                      1136
@RF01134 LH    @05,B                                               1136
         AH    @05,ONE                                             1136
@DE01133 STH   @05,B                                               1136
         CH    @05,INTABLE                                         1136
         BNH   @DL01133                                            1136
*      END;                                                        1137
         LA    @05,1                                               1137
         AH    @05,C                                               1137
         STH   @05,C                                               1137
@DE01132 LH    @15,INTABLE                                         1137
         BCTR  @15,0                                               1137
         CR    @05,@15                                             1137
         BNH   @DL01132                                            1137
*    CALL RESTOF6(FORMAT5);          /* BUILD FORMAT FIVE CHAR        *
@RF01131 LA    @01,@AL01138                                        1138
         BAL   @14,RESTOF6                                         1138
*    DCFLAGS2=DCFLAGS1;              /* SAVE FOR DEBUG                *
         MVC   DCFLAGS2(2),DCFLAGS1                                1139
*    SAVE5A(1)=BYTE5(1);             /* SAVE FOR THE MODIFERS         *
         L     @05,SENSEPTR                                        1140
         SLR   @15,@15                                             1140
         IC    @15,BYTE5(,@05)                                     1140
         STH   @15,SAVE5A                                          1140
*    SAVE34A(1)=BYTE0304(1);         /* "                             *
         MVC   SAVE34A(2),BYTE0304(@05)                            1141
*    SAVE6A(1)=BYTE6(1);             /* "                             *
         SLR   @15,@15                                             1142
         IC    @15,BYTE6(,@05)                                     1142
         STH   @15,SAVE6A                                          1142
*    SLL(BYTES1,8);                  /* CORRECT THE HEX CHAR POSITION *
         MVC   @ZT00002+2(2),BYTES1                                1143
         L     @05,@ZT00002                                        1143
         SLL   @05,8                                               1143
         STH   @05,@TF00001                                        1143
         MVC   BYTES1(2),@TF00001                                  1143
*    BYTE=(BYTE×BYTES1);             /* SAVE THE ANSWER               *
         OC    BYTE(2),BYTES1                                      1144
*    END DOFOR5;                                                   1145
@EL00028 DS    0H                                                  1145
@EF00028 DS    0H                                                  1145
@ER00028 LM    @14,@12,@SA00028                                    1145
         BR    @14                                                 1145
* /********************************************************************
* /*    THIS PROC WILL PROCESS THE FSC'D OF 4940,4941,4949            *
*DOFSC1:                                                           1146
*    PROC;                                                         1146
DOFSC1   STM   @14,@12,@SA00029                                    1146
*    IF INTABLE>ONE THEN             /* MUST HAVE MORE THAN 1 TO SORT *
         LH    @05,INTABLE                                         1147
         CH    @05,ONE                                             1147
         BNH   @RF01147                                            1147
*      DO C=1 BY 1 TO INTABLE-1;     /* FIRST ENTRY                   *
         LA    @05,1                                               1148
         STH   @05,C                                               1148
         B     @DE01148                                            1148
@DL01148 DS    0H                                                  1149
*        DO B=C+1 BY ONE TO INTABLE; /* SECOND ENTRY                  *
         AH    @05,@CH00057                                        1149
         B     @DE01149                                            1149
@DL01149 DS    0H                                                  1150
*          BY22231=(BYTE2223(B)&'000F'X);                          1150
         L     @15,SENSEPTR                                        1150
         LA    @14,31                                              1150
         LR    @01,@05                                             1150
         MR    @00,@14                                             1150
         ST    @01,@TF00001                                        1150
         ALR   @01,@15                                             1150
         AL    @01,@CF01865                                        1150
         MVC   BY22231(2),BYTE2223-25(@01)                         1150
         NC    BY22231(2),@CB01734                                 1150
*          BY22232=(BYTE2223(C)&'000F'X);                          1151
         MH    @14,C                                               1151
         ST    @14,@TF00002                                        1151
         ALR   @14,@15                                             1151
         AL    @14,@CF01865                                        1151
         MVC   BY22232(2),BYTE2223-25(@14)                         1151
         NC    BY22232(2),@CB01734                                 1151
*          IF(BYTE7(C)&'F0'X)='50'X&(BYTE7(B)&'F0'X)='40'X THEN    1152
         LR    @05,@15                                             1152
         AL    @05,@TF00002                                        1152
         AL    @05,@CF01889                                        1152
         MVC   @TS00001(1),BYTE7-10(@05)                           1152
         NI    @TS00001,X'F0'                                      1152
         CLI   @TS00001,X'50'                                      1152
         BNE   @RF01152                                            1152
         AL    @15,@TF00001                                        1152
         AL    @15,@CF01889                                        1152
         MVC   @TS00001(1),BYTE7-10(@15)                           1152
         NI    @TS00001,X'F0'                                      1152
         CLI   @TS00001,X'40'                                      1152
         BNE   @RF01152                                            1152
*            CALL SORTSNSE;                                        1153
         BAL   @14,SORTSNSE                                        1153
*          ELSE                                                    1154
*            IF((BYTE7(C)&'F0'X)='40'X&(BYTE7(B)&'F0'X)='40'X)&(BY22232
*                ^='0000'X&BY22232^='0001'X&BY22232^='0009'X)&(BY22231=
*                '0000'X×BY22231='0001'X×BY22231='0009'X) THEN     1154
         B     @RC01152                                            1154
@RF01152 L     @05,SENSEPTR                                        1154
         LA    @15,31                                              1154
         LR    @14,@15                                             1154
         MH    @14,C                                               1154
         ALR   @14,@05                                             1154
         AL    @14,@CF01889                                        1154
         MVC   @TS00001(1),BYTE7-10(@14)                           1154
         NI    @TS00001,X'F0'                                      1154
         CLI   @TS00001,X'40'                                      1154
         BNE   @RF01154                                            1154
         MH    @15,B                                               1154
         ALR   @05,@15                                             1154
         AL    @05,@CF01889                                        1154
         MVC   @TS00001(1),BYTE7-10(@05)                           1154
         NI    @TS00001,X'F0'                                      1154
         CLI   @TS00001,X'40'                                      1154
         BNE   @RF01154                                            1154
         CLC   BY22232(2),@CB00208                                 1154
         BE    @RF01154                                            1154
         CLC   BY22232(2),@CB01736                                 1154
         BE    @RF01154                                            1154
         CLC   BY22232(2),@CB01737                                 1154
         BE    @RF01154                                            1154
         CLC   BY22231(2),@CB00208                                 1154
         BE    @RT01154                                            1154
         CLC   BY22231(2),@CB01736                                 1154
         BE    @RT01154                                            1154
         CLC   BY22231(2),@CB01737                                 1154
         BNE   @RF01154                                            1154
@RT01154 DS    0H                                                  1155
*              CALL SORTSNSE;        /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        1155
*        END;                                                      1156
@RF01154 DS    0H                                                  1156
@RC01152 LH    @05,B                                               1156
         AH    @05,ONE                                             1156
@DE01149 STH   @05,B                                               1156
         CH    @05,INTABLE                                         1156
         BNH   @DL01149                                            1156
*      END;                                                        1157
         LA    @05,1                                               1157
         AH    @05,C                                               1157
         STH   @05,C                                               1157
@DE01148 LH    @15,INTABLE                                         1157
         BCTR  @15,0                                               1157
         CR    @05,@15                                             1157
         BNH   @DL01148                                            1157
*    CALL RESTOF6(BUILDF3);          /* BUILD THE HEX BYTE FOR THESE
*                                       FSC'S                         *
@RF01147 LA    @01,@AL01158                                        1158
         BAL   @14,RESTOF6                                         1158
*    DCFLAGS3=DCFLAGS1;              /* SAVE FOR DEBUG                *
         MVC   DCFLAGS3(2),DCFLAGS1                                1159
*    SLL(BYTES1,4);                  /* POSITION THE HEX CHAR      1160
*                                       CORRECTLY                     *
         MVC   @ZT00002+2(2),BYTES1                                1160
         L     @05,@ZT00002                                        1160
         SLL   @05,4                                               1160
         STH   @05,@TF00001                                        1160
         MVC   BYTES1(2),@TF00001                                  1160
*    SAVE5A(2)=BYTE5(1);             /* SAVE FOR THE MODIFERS         *
         L     @05,SENSEPTR                                        1161
         SLR   @15,@15                                             1161
         IC    @15,BYTE5(,@05)                                     1161
         STH   @15,SAVE5A+2                                        1161
*    SAVE34A(2)=BYTE0304(1);         /* "                             *
         MVC   SAVE34A+2(2),BYTE0304(@05)                          1162
*    SAVE6A(2)=BYTE6(1);             /* "                             *
         SLR   @15,@15                                             1163
         IC    @15,BYTE6(,@05)                                     1163
         STH   @15,SAVE6A+2                                        1163
*    IF F4949=ON THEN                /* FOUND AT LEAST 1 FSC OF 4949  *
         TM    F4949,B'10000000'                                   1164
         BNO   @RF01164                                            1164
*      BYTE=(BYTE×'0080'X);                                        1165
         OC    BYTE(2),@CB01751                                    1165
*    BYTE=(BYTE×BYTES1);             /* SAVE THE ANSWER               *
@RF01164 OC    BYTE(2),BYTES1                                      1166
*    END DOFSC1;                                                   1167
@EL00029 DS    0H                                                  1167
@EF00029 DS    0H                                                  1167
@ER00029 LM    @14,@12,@SA00029                                    1167
         BR    @14                                                 1167
* /********************************************************************
* /*    THIS PROC WILL PROCESS THE FSC'S OF 4944,4945,494D            *
*DOFSC2:                                                           1168
*    PROC;                                                         1168
DOFSC2   STM   @14,@12,@SA00030                                    1168
*    IF INTABLE>ONE THEN             /* MORE THAN 1 SAMPLE TO SORT    *
         LH    @05,INTABLE                                         1169
         CH    @05,ONE                                             1169
         BNH   @RF01169                                            1169
*      DO C=1 BY 1 TO INTABLE-1;     /* FIRST ENTRY                   *
         LA    @05,1                                               1170
         STH   @05,C                                               1170
         B     @DE01170                                            1170
@DL01170 DS    0H                                                  1171
*        DO B=C+1 BY ONE TO INTABLE; /* SECOND ENTRY                  *
         AH    @05,@CH00057                                        1171
         B     @DE01171                                            1171
@DL01171 DS    0H                                                  1172
*          BY22232=(BYTE2223(C)&'000F'X);                          1172
         L     @15,SENSEPTR                                        1172
         LA    @14,31                                              1172
         LR    @07,@14                                             1172
         MH    @07,C                                               1172
         ST    @07,@TF00001                                        1172
         ALR   @07,@15                                             1172
         AL    @07,@CF01865                                        1172
         MVC   BY22232(2),BYTE2223-25(@07)                         1172
         NC    BY22232(2),@CB01734                                 1172
*          BY22231=(BYTE2223(B)&'000F'X);                          1173
         LR    @01,@05                                             1173
         MR    @00,@14                                             1173
         ST    @01,@TF00002                                        1173
         ALR   @01,@15                                             1173
         AL    @01,@CF01865                                        1173
         MVC   BY22231(2),BYTE2223-25(@01)                         1173
         NC    BY22231(2),@CB01734                                 1173
*          IF(BYTE7(C)&'F0'X)='50'X&(BYTE7(B)&'F0'X)='40'X THEN    1174
         LR    @05,@15                                             1174
         AL    @05,@TF00001                                        1174
         AL    @05,@CF01889                                        1174
         MVC   @TS00001(1),BYTE7-10(@05)                           1174
         NI    @TS00001,X'F0'                                      1174
         CLI   @TS00001,X'50'                                      1174
         BNE   @RF01174                                            1174
         AL    @15,@TF00002                                        1174
         AL    @15,@CF01889                                        1174
         MVC   @TS00001(1),BYTE7-10(@15)                           1174
         NI    @TS00001,X'F0'                                      1174
         CLI   @TS00001,X'40'                                      1174
         BNE   @RF01174                                            1174
*            CALL SORTSNSE;                                        1175
         BAL   @14,SORTSNSE                                        1175
*          ELSE                                                    1176
*            IF((BYTE7(C)&'F0'X)='40'X&(BYTE7(B)&'F0'X)='40'X)&(BY22232
*                                                                  1176
*                ^='0004'X&BY22232^='0005'X&BY22232^='000D'X)&(BY22231=
*                '0004'X×BY22231='0005'X×BY22231='000D'X) THEN     1176
         B     @RC01174                                            1176
@RF01174 L     @05,SENSEPTR                                        1176
         LA    @15,31                                              1176
         LR    @14,@15                                             1176
         MH    @14,C                                               1176
         ALR   @14,@05                                             1176
         AL    @14,@CF01889                                        1176
         MVC   @TS00001(1),BYTE7-10(@14)                           1176
         NI    @TS00001,X'F0'                                      1176
         CLI   @TS00001,X'40'                                      1176
         BNE   @RF01176                                            1176
         MH    @15,B                                               1176
         ALR   @05,@15                                             1176
         AL    @05,@CF01889                                        1176
         MVC   @TS00001(1),BYTE7-10(@05)                           1176
         NI    @TS00001,X'F0'                                      1176
         CLI   @TS00001,X'40'                                      1176
         BNE   @RF01176                                            1176
         CLC   BY22232(2),@CB01738                                 1176
         BE    @RF01176                                            1176
         CLC   BY22232(2),@CB01739                                 1176
         BE    @RF01176                                            1176
         CLC   BY22232(2),@CB01740                                 1176
         BE    @RF01176                                            1176
         CLC   BY22231(2),@CB01738                                 1176
         BE    @RT01176                                            1176
         CLC   BY22231(2),@CB01739                                 1176
         BE    @RT01176                                            1176
         CLC   BY22231(2),@CB01740                                 1176
         BNE   @RF01176                                            1176
@RT01176 DS    0H                                                  1177
*              CALL SORTSNSE;        /* SWAP THE 2                    *
         BAL   @14,SORTSNSE                                        1177
*        END;                                                      1178
@RF01176 DS    0H                                                  1178
@RC01174 LH    @05,B                                               1178
         AH    @05,ONE                                             1178
@DE01171 STH   @05,B                                               1178
         CH    @05,INTABLE                                         1178
         BNH   @DL01171                                            1178
*      END;                                                        1179
         LA    @05,1                                               1179
         AH    @05,C                                               1179
         STH   @05,C                                               1179
@DE01170 LH    @15,INTABLE                                         1179
         BCTR  @15,0                                               1179
         CR    @05,@15                                             1179
         BNH   @DL01170                                            1179
*    CALL RESTOF6(BUILDF4);          /* CHARACTER WILL BE IN CORRECT
*                                       POSITION                      *
@RF01169 LA    @01,@AL01180                                        1180
         BAL   @14,RESTOF6                                         1180
*    IF F4FLAG=ON THEN                                             1181
         TM    F4FLAG,B'01000000'                                  1181
         BNO   @RF01181                                            1181
*      BYTE=(BYTE×'0008'X);                                        1182
         OC    BYTE(2),@CB01755                                    1182
*    BYTE=(BYTE×BYTES1);                                           1183
@RF01181 OC    BYTE(2),BYTES1                                      1183
*    SAVE5A(3)=BYTE5(1);             /* SAVE FOR THE MODIFERS         *
         L     @05,SENSEPTR                                        1184
         SLR   @15,@15                                             1184
         IC    @15,BYTE5(,@05)                                     1184
         STH   @15,SAVE5A+4                                        1184
*    SAVE34A(3)=BYTE0304(1);         /* "                             *
         MVC   SAVE34A+4(2),BYTE0304(@05)                          1185
*    SAVE6A(3)=BYTE6(1);             /* "                             *
         SLR   @15,@15                                             1186
         IC    @15,BYTE6(,@05)                                     1186
         STH   @15,SAVE6A+4                                        1186
*    END DOFSC2;                                                   1187
@EL00030 DS    0H                                                  1187
@EF00030 DS    0H                                                  1187
@ER00030 LM    @14,@12,@SA00030                                    1187
         BR    @14                                                 1187
* /********************************************************************
* /*                            RESTOF6                               *
* /*   THIS PROC WILL PROCESS THE GROUP 6 RECORDS.                    *
* /*   BITS 5,6 &7 WILL BE SET ON IN A 1 BYTE ITEM CALLED ANSWER6.    *
* /*   THE CALLER WILL HAVE TO PLACE THE  BITS IN THE CORRECT POSITION*
* /*   THE CALLER WILL HAVE TO PASS THE NUMBER OF ENTRIES TO PROCESS. *
* /*   THIS PROC WILL ASSUME THAT THESE ENTRIES WILL HAVE BEEN SORTED *
* /*   TO THE TOP OF THE INPUT TABLE.                                 *
*RESTOF6:                                                          1188
*    PROC(NUMIN);                                                  1188
RESTOF6  STM   @14,@12,@SA00031                                    1188
         MVC   @PC00031(4),0(@01)                                  1188
*    DCL                                                           1189
*      NUMIN FIXED(15);              /*RECORDS FOR THIS PROC TO PROCES*
*    BYTES1=BYTES1&&BYTES1;                                        1190
         XC    BYTES1(2),BYTES1                                    1190
*    DCFLAGS1=DCFLAGS1&&DCFLAGS1;    /* SET FOLLOWING FLAGS OFF ITEMS
*                                       ARE DECLARED IN THIS ORDER    *
         XC    DCFLAGS1(2),DCFLAGS1                                1191
* /* GR11 = OFF           ALL LESS THAN 12 FLAG                       *
* /* LS12 = OFF           ALL GREATER THAN 11 FLAG                    *
* /* FIVEUNEQ = OFF       ALL BYTE 5 WERE EQUAL FLAG                  *
* /* SIXUNEQ = OFF        ALL BYTE 6 WERE EQUAL FLAG                  *
* /* T3TO6 = OFF          ALL BYTES 3 TO 6 WERE EQUAL                 *
* /* D24NOTEQ = OFF       ALL INTERGALS WERE NOT EQUAL                *
*    DO B=1 BY 1 TO NUMIN;                                         1192
         LA    @05,1                                               1192
         STH   @05,B                                               1192
         B     @DE01192                                            1192
@DL01192 DS    0H                                                  1193
*      IF BYTE5(B)>11 THEN           /* DETERMINE THE MIX OF BYTE 5'S *
         MH    @05,@CH00042                                        1193
         L     @01,SENSEPTR                                        1193
         AL    @01,@CF01875                                        1193
         SLR   @00,@00                                             1193
         IC    @00,BYTE5-8(@05,@01)                                1193
         CH    @00,@CH00034                                        1193
         BNH   @RF01193                                            1193
*        GR11=ON;                    /* DETERMINE IF ALL WERE < 12    *
         OI    GR11,B'10000000'                                    1194
*      ELSE                                                        1195
*        LS12=ON;                    /* DETERMINE IF ALL WERE > 11    *
         B     @RC01193                                            1195
@RF01193 OI    LS12,B'01000000'                                    1195
*      IF B^=1 THEN                  /* NEED AT LEAST TWO SAMPLES     *
@RC01193 LH    @05,B                                               1196
         CH    @05,@CH00057                                        1196
         BE    @RF01196                                            1196
*        DO;                                                       1197
*          IF BYTE5(B-1)^=BYTE5(B) THEN                            1198
         L     @15,SENSEPTR                                        1198
         MH    @05,@CH00042                                        1198
         ST    @05,@TF00001                                        1198
         ALR   @05,@15                                             1198
         AL    @05,@CF01887                                        1198
         AL    @15,@TF00001                                        1198
         AL    @15,@CF01875                                        1198
         CLC   BYTE5-8(1,@05),BYTE5-8(@15)                         1198
         BE    @RF01198                                            1198
*            FIVEUNEQ=ON;            /* 1 BYTE 5 DIFF FROM OTHERS     *
         OI    FIVEUNEQ,B'00100000'                                1199
*          IF BYTE6(B-1)^=BYTE6(B) THEN                            1200
@RF01198 L     @05,SENSEPTR                                        1200
         LH    @15,B                                               1200
         MH    @15,@CH00042                                        1200
         ST    @15,@TF00001                                        1200
         ALR   @15,@05                                             1200
         AL    @15,@CF01890                                        1200
         AL    @05,@TF00001                                        1200
         AL    @05,@CF01891                                        1200
         CLC   BYTE6-9(1,@15),BYTE6-9(@05)                         1200
         BE    @RF01200                                            1200
*            SIXUNEQ=ON;             /* 1 BYTE 6 DIFF FROM OTHER 6'S  *
         OI    SIXUNEQ,B'00010000'                                 1201
*          IF BYTE3TO6(B-1)^=BYTE3TO6(B) THEN                      1202
@RF01200 L     @05,SENSEPTR                                        1202
         LH    @15,B                                               1202
         MH    @15,@CH00042                                        1202
         ST    @15,@TF00001                                        1202
         ALR   @15,@05                                             1202
         AL    @15,@CF01892                                        1202
         AL    @05,@TF00001                                        1202
         AL    @05,@CF01883                                        1202
         CLC   BYTE3TO6-6(4,@15),BYTE3TO6-6(@05)                   1202
         BE    @RF01202                                            1202
*            T3TO6=ON;               /* 1 BYTE3,4,5,6 DIFF FROM OTHERS*
         OI    T3TO6,B'00001000'                                   1203
*          IF DIVIDE24(B-1)^=DIVIDE24(B) THEN                      1204
@RF01202 L     @05,SENSEPTR                                        1204
         LH    @15,B                                               1204
         MH    @15,@CH00042                                        1204
         ST    @15,@TF00001                                        1204
         ALR   @15,@05                                             1204
         AL    @15,@CF01878                                        1204
         AL    @05,@TF00001                                        1204
         AL    @05,@CF01877                                        1204
         CLC   DIVIDE24-27(1,@15),DIVIDE24-27(@05)                 1204
         BE    @RF01204                                            1204
*            D24NOTEQ=ON;            /* AT LEAST 1 INTERGAL FROM BYTE
*                                       5 DIFF                        *
         OI    D24NOTEQ,B'00000100'                                1205
*        END;                                                      1206
@RF01204 DS    0H                                                  1207
*    END;                                                          1207
@RF01196 LA    @05,1                                               1207
         AH    @05,B                                               1207
         STH   @05,B                                               1207
@DE01192 L     @15,@PC00031                                        1207
         CH    @05,NUMIN(,@15)                                     1207
         BNH   @DL01192                                            1207
*    IF GR11=OFF THEN                /* ALLREC SB5 < 12               *
         TM    GR11,B'10000000'                                    1208
         BNZ   @RF01208                                            1208
*      DO;                                                         1209
*        IF T3TO6=OFF THEN           /* ALL SB3TO 6 'S EQUAL          *
         TM    T3TO6,B'00001000'                                   1210
         BNZ   @RF01210                                            1210
*          DO;                                                     1211
*            CALL ALTER;             /* WAS IT A PRIME OR ALTERNATE   *
         BAL   @14,ALTER                                           1212
*            BYTES1=RETURN1;         /* MOVE IN THE VALUE SET BY ALTER*
         MVC   BYTES1(2),RETURN1                                   1213
*          END;                                                    1214
*        ELSE                                                      1215
*          DO;                                                     1215
         B     @RC01210                                            1215
@RF01210 DS    0H                                                  1216
*            IF FIVEUNEQ=OFF THEN    /* ALL SB5'S WERE EQUAL          *
         TM    FIVEUNEQ,B'00100000'                                1216
         BNZ   @RF01216                                            1216
*              BYTES1=4;             /* R/W HEAD FAILURE-MOVEABLE HEAD*
         MVC   BYTES1(2),@CH00066                                  1217
*            ELSE                                                  1218
*              IF D24NOTEQ=ON THEN   /* INTERGALS WERE NOT =          *
         B     @RC01216                                            1218
@RF01216 TM    D24NOTEQ,B'00000100'                                1218
         BNO   @RF01218                                            1218
*                BYTES1=1;           /* MULTIPLE AE SELECT MODULE     *
         MVC   BYTES1(2),@CH00057                                  1219
*              ELSE                                                1220
*                BYTES1=6;           /* SINGLE AE SELECT MODULE    1220
*                                       MOVEABLE H.                   *
         B     @RC01218                                            1220
@RF01218 MVC   BYTES1(2),@CH00081                                  1220
*          END;                                                    1221
*      END;                                                        1222
*    ELSE                                                          1223
*      IF LS12=ON THEN               /* OFF IF ALL > THAN 11          *
         B     @RC01208                                            1223
@RF01208 TM    LS12,B'01000000'                                    1223
         BNO   @RF01223                                            1223
*        BYTES1=1;                   /* MULTIPLE AE SELECT MODULES    *
         MVC   BYTES1(2),@CH00057                                  1224
*      ELSE                                                        1225
*        DO;                                                       1225
         B     @RC01223                                            1225
@RF01223 DS    0H                                                  1226
*          IF FIVEUNEQ=OFF THEN      /* ON IF BYTE5'S ARE UNEQUAL     *
         TM    FIVEUNEQ,B'00100000'                                1226
         BNZ   @RF01226                                            1226
*            DO;                                                   1227
*              IF SIXUNEQ=OFF THEN   /* ON IF BYTE6'S ARE ^=          *
         TM    SIXUNEQ,B'00010000'                                 1228
         BNZ   @RF01228                                            1228
*                DO;                                               1229
*                  CALL ALTER;       /* ARE THEY AN ALTER OR PRIME    *
         BAL   @14,ALTER                                           1230
*                  BYTES1=RETURN1;                                 1231
         MVC   BYTES1(2),RETURN1                                   1231
*                END;                                              1232
*              ELSE                                                1233
*                BYTES1=5;           /* R/W HEAD FAILURE FIXED HEAD   *
         B     @RC01228                                            1233
@RF01228 MVC   BYTES1(2),@CH00079                                  1233
*            END;                                                  1234
*          ELSE                                                    1235
*            IF D24NOTEQ=ON THEN     /* ARE THE INTERGALS =           *
         B     @RC01226                                            1235
@RF01226 TM    D24NOTEQ,B'00000100'                                1235
         BNO   @RF01235                                            1235
*              BYTES1=ONE;           /* MULTIPLE AE SELECT MODULES    *
         MVC   BYTES1(2),ONE                                       1236
*            ELSE                                                  1237
*              BYTES1=SEVEN;         /* SINGLE AE SELECT MODULE FIXED
*                                       H.                            *
         B     @RC01235                                            1237
@RF01235 MVC   BYTES1(2),SEVEN                                     1237
*        END;                                                      1238
*    END RESTOF6;                                                  1239
@EL00031 DS    0H                                                  1239
@EF00031 DS    0H                                                  1239
@ER00031 LM    @14,@12,@SA00031                                    1239
         BR    @14                                                 1239
* /********************************************************************
* /*                           ALTER                                  *
* /*    THIS PROC WILL DETERMINE IF A SENSE BYTE 5 & 6 COMBINATION    *
* /*    ARE POINTING TO A PRIME BLOCK, ALTERNATE BLOCK OR NEITHER     *
* /*    THIS IS DONE USING 4 TABLES:                                  *
* /*        PHYHEAD   VALID BYTE 5 ENTRIES                            *
* /*        HEADLINE  LINE NUMBER FOR EACH ENTRY IN TABLE PHYHEAD     *
* /*        PHYBLOCK  VALID BYTE 6 ENTRIES                            *
* /*        BLKLINE   LINE NUMBER FOR EACH ENTRY IN TABLE PHYBLOCK    *
* /*     PHYHEAD IS SEARCHED FOR A MATCH ON SB5 IF FOUND THE SAME     *
* /*     ENTRY IN HEADLINE IS KEPT.  THEN SB6 IS COMPARED AGAINST     *
* /*     PHYBLOCK FOR A MATCH.  IF FOUND THE SAME LOCATION IN TABLE   *
* /*     BLKLINE IS COMPARED AGAINST THE SAVED ENTRY.  IF THEY MATCH  *
* /*     IT IS AN ALTERNATE BLOCK IF THEY DO NOT MATCH (AND SB5 &     *
* /*     SB6 WERE FOUND IN THE TABLE) IT IS A PRIMARY BLOCK           *
*ALTER:                                                            1240
*    PROC;                                                         1240
ALTER    STM   @14,@12,12(@13)                                     1240
* /*  2 = SINGLE DATA BLOCK FAILURE - PRIME BLOCK                     *
* /*  3 = SINGLE DATA BLOCK FAILURE - ALTERNATE BLOCK                 *
*    RETURN1=TWO;                    /* SET UP TO RETURN A 2          *
         MVC   RETURN1(2),TWO                                      1241
*    DO D=1 BY 1 TO DIM(PHYHEAD) WHILE(RETURN1=TWO);               1242
         LA    @05,1                                               1242
         STH   @05,D                                               1242
@DL01242 CLC   RETURN1(2),TWO                                      1242
         BNE   @DC01242                                            1242
*      IF BYTE5(1)=PHYHEAD(D) THEN   /* IS BYTE 5 IN THE TABLE        *
         L     @01,SENSEPTR                                        1243
         LA    @15,PHYHEAD-1(@05)                                  1243
         CLC   BYTE5(1,@01),0(@15)                                 1243
         BNE   @RF01243                                            1243
*        DO E=1 BY 1 TO DIM(PHYBLOCK) WHILE(RETURN1=TWO);          1244
         LA    @05,1                                               1244
         STH   @05,E                                               1244
@DL01244 CLC   RETURN1(2),TWO                                      1244
         BNE   @DC01244                                            1244
*          IF BYTE6(1)=PHYBLOCK(E) THEN/* IS BYTE 6 IN THE TABLE      *
         L     @01,SENSEPTR                                        1245
         LA    @15,PHYBLOCK-1(@05)                                 1245
         CLC   BYTE6(1,@01),0(@15)                                 1245
         BNE   @RF01245                                            1245
*            IF HEADLINE(D)=BLKLINE(E) THEN/* ARE ENTRIES IN THE SAME
*                                       LINE                          *
         LH    @01,D                                               1246
         LA    @15,HEADLINE-1(@01)                                 1246
         LA    @14,BLKLINE-1(@05)                                  1246
         CLC   0(1,@15),0(@14)                                     1246
         BNE   @RF01246                                            1246
*              RETURN1=THREE;        /* ALTER RETURN CODE TO A 3      *
         MVC   RETURN1(2),THREE                                    1247
*        END;                                                      1248
@RF01246 DS    0H                                                  1248
@RF01245 LA    @05,1                                               1248
         AH    @05,E                                               1248
         STH   @05,E                                               1248
         CH    @05,@CH00227                                        1248
         BNH   @DL01244                                            1248
@DC01244 DS    0H                                                  1249
*    END;                                                          1249
@RF01243 LA    @05,1                                               1249
         AH    @05,D                                               1249
         STH   @05,D                                               1249
         CH    @05,@CH00895                                        1249
         BNH   @DL01242                                            1249
@DC01242 DS    0H                                                  1250
*    END ALTER;                                                    1250
@EL00032 DS    0H                                                  1250
@EF00032 DS    0H                                                  1250
@ER00032 LM    @14,@12,12(@13)                                     1250
         BR    @14                                                 1250
* /********************************************************************
* /*                             GP6MODIF                             *
* /*    THIS PROC WILL BUILD AND PRINT THE MODIFERS FOR DATA CHECKS   *
* /*    THE MODIFERS ARE BUILT DEPENDING ON THE VALUE OF ANSWER       *
* /*      LOC-P:  DECIMAL PHYSICAL LOCATION    CCC-HH-BB              *
* /*         (THESE VALUES ARE DETERMINED ONLY IF F2 = 2(0010B))      *
* /*           CCC = DECIMAL VALUE OF BYTE 3 & 4  IF SB5 >11 (000-999)*
* /*           HH  = DECIMAL VALUE OF BYTE 5  (00-99)                 *
* /*           BB  = DECIMAL VALUE OF BYTE 6  (00-99)                 *
* /*      LOC-A:  DECIMAL PHYSICAL LOCATION    CCC-HH-BB              *
* /*         (THESE VALUES ARE DETERMINED ONLY IF F2 = 3(0011B))      *
* /*           CCC = DECIMAL VALUE OF BYTE 3 & 4  IF SB5 >11 (000-999)*
* /*           HH  = DECIMAL VALUE OF BYTE 5  (00-99)                 *
* /*           BB  = DECIMAL VALUE OF BYTE 6  (00-99)                 *
* /*      HEAD:   DECIMAL HEAD NUMBER   HH                            *
* /*         (THIS VALUE DETERMINED ONLY IF F2 = 4 OR 5               *
* /*           HH = DECIMAL VALUE OF SB5    (00-99)                   *
* /*      MOD:    DECIMAL VALUE OF SB5   MM                           *
* /*         (THIS VALUE DETERMINED ONLY IF F2 = 6 OR 7               *
* /*           MM = SB5/4   VALID RESULTS 00-12                       *
*GP6MODIF:                                                         1251
*    PROC;                                                         1251
GP6MODIF STM   @14,@12,@SA00033                                    1251
*    CALL FINISH;                    /* PRINT THE HEADING             *
         BAL   @14,FINISH                                          1252
*    DO B=1 BY 1 TO 3;                                             1253
         LA    @05,1                                               1253
         STH   @05,B                                               1253
@DL01253 DS    0H                                                  1254
*      MOVEPT=MOVETAB(B);            /* CHANGE ADDR OF WHERE          *
         LR    @15,@05                                             1254
         SLA   @15,2                                               1254
         L     @15,MOVETAB-4(@15)                                  1254
         ST    @15,MOVEPT                                          1254
* /* NOTE COMPTAB NUMBERS ARE 1 HIGH FOR INDEXING                     *
* /* NOTE- COMPTAB POINTS TO THE TYPE OF OUTPUT                       *
* /* NOTE  SAVE-A  CONTAINS THE VALUE TO PRINT OUT                    *
*      IF COMPTAB(B)=3×COMPTAB(B)=4 THEN                           1255
         ALR   @05,@05                                             1255
         LH    @05,COMPTAB-2(@05)                                  1255
         CH    @05,@CH00038                                        1255
         BE    @RT01255                                            1255
         CH    @05,@CH00066                                        1255
         BNE   @RF01255                                            1255
@RT01255 DS    0H                                                  1256
*        DO;                                                       1256
*          IF SAVE5A(B)>11 THEN                                    1257
         LH    @05,B                                               1257
         ALR   @05,@05                                             1257
         LH    @15,SAVE5A-2(@05)                                   1257
         CH    @15,@CH00034                                        1257
         BNH   @RF01257                                            1257
*            SAVE34A(B)=ZERO;        /* SET ITEM TO '0000'X           *
         SLR   @15,@15                                             1258
         STH   @15,SAVE34A-2(@05)                                  1258
*          CALL CONVBIN(3,SAVE34A(B),MOVEPT+6);/* MOVE OUT THE CCC    *
@RF01257 MVC   @AL00001(12),@AL01259                               1259
         LH    @05,B                                               1259
         ALR   @05,@05                                             1259
         LA    @05,SAVE34A-2(@05)                                  1259
         ST    @05,@AL00001+4                                      1259
         LA    @05,6                                               1259
         AL    @05,MOVEPT                                          1259
         ST    @05,@AFTEMPS+36                                     1259
         LA    @01,@AL00001                                        1259
         BAL   @14,CONVBIN                                         1259
*          IF SAVE5A(B)>99 THEN      /* NEED TO PRINT 3 CHAR'S TO  1260
*                                       BLANK OUT N/A                 *
         LA    @05,99                                              1260
         LH    @15,B                                               1260
         ALR   @15,@15                                             1260
         CH    @05,SAVE5A-2(@15)                                   1260
         BNL   @RF01260                                            1260
*            SAVE5A(B)=99;           /* MAX VALUE PRINTED IS TO BE 99 *
         STH   @05,SAVE5A-2(@15)                                   1261
*          IF SAVE6A(B)>99 THEN                                    1262
@RF01260 LA    @05,99                                              1262
         LH    @15,B                                               1262
         ALR   @15,@15                                             1262
         CH    @05,SAVE6A-2(@15)                                   1262
         BNL   @RF01262                                            1262
*            SAVE6A(B)=99;                                         1263
         STH   @05,SAVE6A-2(@15)                                   1263
*          CALL CONVBIN(3,SAVE5A(B),MOVEPT+14);/* MOVE OUT THE HH     *
@RF01262 MVC   @AL00001(12),@AL01264                               1264
         LH    @05,B                                               1264
         ALR   @05,@05                                             1264
         LA    @05,SAVE5A-2(@05)                                   1264
         ST    @05,@AL00001+4                                      1264
         LA    @05,14                                              1264
         AL    @05,MOVEPT                                          1264
         ST    @05,@AFTEMPS+36                                     1264
         LA    @01,@AL00001                                        1264
         BAL   @14,CONVBIN                                         1264
*          CALL CONVBIN(3,SAVE6A(B),MOVEPT+22);/* MOVE OUT THE MM     *
         MVC   @AL00001(12),@AL01265                               1265
         LH    @05,B                                               1265
         ALR   @05,@05                                             1265
         LA    @05,SAVE6A-2(@05)                                   1265
         ST    @05,@AL00001+4                                      1265
         LA    @05,22                                              1265
         AL    @05,MOVEPT                                          1265
         ST    @05,@AFTEMPS+36                                     1265
         LA    @01,@AL00001                                        1265
         BAL   @14,CONVBIN                                         1265
*        END;                                                      1266
*      ELSE                                                        1267
*        IF COMPTAB(B)^=1&COMPTAB(B)^=2 THEN                       1267
         B     @RC01255                                            1267
@RF01255 LH    @05,B                                               1267
         ALR   @05,@05                                             1267
         LH    @05,COMPTAB-2(@05)                                  1267
         CH    @05,@CH00057                                        1267
         BE    @RF01267                                            1267
         CH    @05,@CH00075                                        1267
         BE    @RF01267                                            1267
*          DO;                                                     1268
*            IF COMPTAB(B)=7×COMPTAB(B)=8 THEN                     1269
         CH    @05,@CH00083                                        1269
         BE    @RT01269                                            1269
         CH    @05,@CH00037                                        1269
         BNE   @RF01269                                            1269
@RT01269 DS    0H                                                  1270
*              SRL(SAVE5A(B),2);     /* DIVIDE BY 4                   *
         LH    @05,B                                               1270
         ALR   @05,@05                                             1270
         LH    @15,SAVE5A-2(@05)                                   1270
         SRL   @15,2                                               1270
         STH   @15,SAVE5A-2(@05)                                   1270
*            IF SAVE5A(B)>99 THEN    /* EXPECT CONVBIN TO REMOVE ALL
*                                       OF 'N/A'                      *
@RF01269 LA    @05,99                                              1271
         LH    @15,B                                               1271
         ALR   @15,@15                                             1271
         CH    @05,SAVE5A-2(@15)                                   1271
         BNL   @RF01271                                            1271
*              SAVE5A(B)=99;         /* SET TO PRINT OUT AS THOUGH 1272
*                                       ONLY 2 CHAR OK                *
         STH   @05,SAVE5A-2(@15)                                   1272
*            CALL CONVBIN(3,SAVE5A(B),MOVEPT+5);                   1273
@RF01271 MVC   @AL00001(12),@AL01273                               1273
         LH    @05,B                                               1273
         ALR   @05,@05                                             1273
         LA    @05,SAVE5A-2(@05)                                   1273
         ST    @05,@AL00001+4                                      1273
         LA    @05,5                                               1273
         AL    @05,MOVEPT                                          1273
         ST    @05,@AFTEMPS+36                                     1273
         LA    @01,@AL00001                                        1273
         BAL   @14,CONVBIN                                         1273
*          END;                                                    1274
*    END;                                                          1275
@RF01267 DS    0H                                                  1275
@RC01255 LA    @05,1                                               1275
         AH    @05,B                                               1275
         STH   @05,B                                               1275
         CH    @05,@CH00038                                        1275
         BNH   @DL01253                                            1275
*    CALL PRINTIT;                                                 1276
         BAL   @14,PRINTIT                                         1276
*    END GP6MODIF;                                                 1277
@EL00033 DS    0H                                                  1277
@EF00033 DS    0H                                                  1277
@ER00033 LM    @14,@12,@SA00033                                    1277
         BR    @14                                                 1277
* /********************************************************************
* /*                                    FINISH                        *
* /*    THIS PROC PRINT THE MODIFER HEADING FOR GROUP 6 MODIFER       *
*FINISH:                                                           1278
*    PROC;                                                         1278
FINISH   STM   @14,@12,@SA00034                                    1278
*    IF DEBUG61=ON THEN                                            1279
         TM    DEBUG61(R2),B'00000100'                             1279
         BNO   @RF01279                                            1279
*      DO;                                                         1280
*        CALL CONVERT1(T16,PRT0,ADDR(SAVE5A));                     1281
         LA    @05,SAVE5A                                          1281
         ST    @05,@AFTEMPS+40                                     1281
         LA    @01,@AL01281                                        1281
         BAL   @14,CONVERT1                                        1281
*        CALL CONVERT1(T16,PRT39,ADDR(COMPTAB));                   1282
         LA    @05,COMPTAB                                         1282
         ST    @05,@AFTEMPS+40                                     1282
         LA    @01,@AL01282                                        1282
         BAL   @14,CONVERT1                                        1282
*        CALL PRINTIT;                                             1283
         BAL   @14,PRINTIT                                         1283
*      END;                                                        1284
*    CALL PRINTIT;                   /* BLANK LINE                    *
@RF01279 BAL   @14,PRINTIT                                         1285
*    DCLINED=DCLINE;                 /* LINE 1 OF MODIFER EXPLAINATION*
         MVC   DCLINED(80),DCLINE                                  1286
*    CALL PRINTIT;                   /* PRINT THE FIRST LINE OF    1287
*                                       DISCRIPTION                   *
         BAL   @14,PRINTIT                                         1287
*    BYTE=(BYTE&'0777'X);            /* DROP UNWANTED BITS            *
         NC    BYTE(2),@CB01774                                    1288
*    COMPTAB(1)=(BYTE&'0F00'X)+'0100'X;/* ADD 1 FOR INDEX VALUE       *
         MVC   @ZT00002+2(2),BYTE                                  1289
         L     @05,@ZT00002                                        1289
         LA    @15,3840                                            1289
         NR    @15,@05                                             1289
         AH    @15,@CH00102                                        1289
         STH   @15,COMPTAB                                         1289
*    COMPTAB(2)=(BYTE&'00F0'X)+'0010'X;/* TO BE CORRECT               *
         LA    @15,240                                             1290
         NR    @15,@05                                             1290
         AH    @15,@CH01776                                        1290
         STH   @15,COMPTAB+2                                       1290
*    COMPTAB(3)=(BYTE&'000F'X)+1;                                  1291
         LA    @15,1                                               1291
         N     @05,@CF01734                                        1291
         ALR   @05,@15                                             1291
         STH   @05,COMPTAB+4                                       1291
*    SRL(COMPTAB(1),8);              /* RIGHT JUSTIFY FOR INDEXING    *
         LH    @05,COMPTAB                                         1292
         SRL   @05,8                                               1292
         STH   @05,COMPTAB                                         1292
*    SRL(COMPTAB(2),4);              /* "                             *
         LH    @05,COMPTAB+2                                       1293
         SRL   @05,4                                               1293
         STH   @05,COMPTAB+2                                       1293
*    DO B=1 BY 1 TO 3;                                             1294
         STH   @15,B                                               1294
@DL01294 DS    0H                                                  1295
*      MOVEPT=MOVETAB(B);            /* CHANGE THE ADDRESS OF WHERE TO
*                                       PUT IT                        *
         LR    @05,@15                                             1295
         SLA   @05,2                                               1295
         L     @05,MOVETAB-4(@05)                                  1295
         ST    @05,MOVEPT                                          1295
*      MOVECHR1=DCLINE2(COMPTAB(B)); /* MOVE IN THE DISCRIPTION       *
         LR    @14,@15                                             1296
         ALR   @14,@14                                             1296
         LH    @14,COMPTAB-2(@14)                                  1296
         MH    @14,@CH01416                                        1296
         LA    @01,DCLINE2-22(@14)                                 1296
         MVC   MOVECHR1(22,@05),0(@01)                             1296
*    END;                                                          1297
         AH    @15,@CH00057                                        1297
         STH   @15,B                                               1297
         CH    @15,@CH00038                                        1297
         BNH   @DL01294                                            1297
*    CALL PRINTIT;                   /* PRINT THE HEADING TO DESCRIBE
*                                       EACH FOLLOWING FIELD          *
         BAL   @14,PRINTIT                                         1298
*    DO B=1 BY 1 TO 3;                                             1299
         LA    @05,1                                               1299
         STH   @05,B                                               1299
@DL01299 DS    0H                                                  1300
*      MOVEPT=MOVETAB(B);            /* CHANGE THE ADDRESS            *
         LR    @15,@05                                             1300
         SLA   @15,2                                               1300
         L     @15,MOVETAB-4(@15)                                  1300
         ST    @15,MOVEPT                                          1300
*      MOVECHR=LIN1(COMPTAB(B));     /* MOVE IN THE LABEL WITH N/A    *
         MVI   MOVECHR+25(@15),C' '                                1301
         LR    @14,@05                                             1301
         ALR   @14,@14                                             1301
         LH    @14,COMPTAB-2(@14)                                  1301
         MH    @14,@CH01434                                        1301
         LA    @01,LIN1-25(@14)                                    1301
         MVC   MOVECHR(25,@15),0(@01)                              1301
*    END;                                                          1302
         AH    @05,@CH00057                                        1302
         STH   @05,B                                               1302
         CH    @05,@CH00038                                        1302
         BNH   @DL01299                                            1302
*    END FINISH;                                                   1303
@EL00034 DS    0H                                                  1303
@EF00034 DS    0H                                                  1303
@ER00034 LM    @14,@12,@SA00034                                    1303
         BR    @14                                                 1303
* /********************************************************************
* /*    THIS PROC WILL PRINT THE ERROR MESSAGES                       *
*  ERRORMSG: PROC;                                                 1304
ERRORMSG STM   @14,@12,@SA00035                                    1304
*    IF NOGOOD^=ZERO THEN            /* RECORDS NOT USED SENT BY   1305
*                                       IFCESUMS                      *
         LH    @05,NOGOOD                                          1305
         LTR   @05,@05                                             1305
         BZ    @RF01305                                            1305
*      DO;                                                         1306
*        CALL IFCMSG(107,PRT0);      /* MOVE THE MESSAGE IN           *
         L     @15,ADIFCMSG(,R2)                                   1307
         LA    @01,@AL01307                                        1307
         BALR  @14,@15                                             1307
*        CALL CONVBIN(5,NOGOOD,PRT9);/* CONVERT THE # OF BAD RECORDS  *
         LA    @01,@AL01308                                        1308
         BAL   @14,CONVBIN                                         1308
*        CALL CONVERT1(TWO,PRT58,ADDR(KEEPCUA));                   1309
         LA    @05,KEEPCUA                                         1309
         ST    @05,@AFTEMPS+44                                     1309
         LA    @01,@AL01309                                        1309
         BAL   @14,CONVERT1                                        1309
*        GEN(MVI  PRTLINE+61,X'E7'); /*MOVE IN A CHAR X*/          1310
         MVI  PRTLINE+61,X'E7'
*        CALL PRINTIT;               /* PRINT THE MESSAGE             *
         BAL   @14,PRINTIT                                         1311
*      END;                                                        1312
*    IF HRDERROR^=ZERO THEN          /* RECORDS NOT USED SENT BY   1313
*                                       IFCESUMS                      *
@RF01305 LH    @05,HRDERROR                                        1313
         LTR   @05,@05                                             1313
         BZ    @RF01313                                            1313
*      DO;                                                         1314
*        CALL IFCMSG(108,PRT0);      /* MOVE THE MESSAGE IN           *
         L     @15,ADIFCMSG(,R2)                                   1315
         LA    @01,@AL01315                                        1315
         BALR  @14,@15                                             1315
*        CALL CONVBIN(5,HRDERROR,PRT9);/* CONVERT THE # OF BAD RECORDS*
         LA    @01,@AL01316                                        1316
         BAL   @14,CONVBIN                                         1316
*        CALL CONVERT1(TWO,PRT58,ADDR(KEEPCUA));                   1317
         LA    @05,KEEPCUA                                         1317
         ST    @05,@AFTEMPS+44                                     1317
         LA    @01,@AL01317                                        1317
         BAL   @14,CONVERT1                                        1317
*        GEN(MVI  PRTLINE+61,X'E7'); /*MOVE IN A CHAR X*/          1318
         MVI  PRTLINE+61,X'E7'
*        CALL PRINTIT;               /* PRINT THE MESSAGE             *
         BAL   @14,PRINTIT                                         1319
*      END;                                                        1320
*   END ERRORMSG;                                                  1321
@EL00035 DS    0H                                                  1321
@EF00035 DS    0H                                                  1321
@ER00035 LM    @14,@12,@SA00035                                    1321
         BR    @14                                                 1321
* /********************************************************************
* /*THIS PROC WILL SWAP TWO ITEMS IN THE SENSE BYTE TABLE             *
*SORTSNSE:                                                         1322
*    PROC;                                                         1322
SORTSNSE STM   @14,@12,12(@13)                                     1322
*    ALLSENSE(C)=ALLSENSE(C)&&ALLSENSE(B);                         1323
         L     @05,SENSEPTR                                        1323
         LA    @15,31                                              1323
         LR    @14,@15                                             1323
         MH    @14,C                                               1323
         ST    @14,@TF00001                                        1323
         ALR   @14,@05                                             1323
         AL    @14,@CF01862                                        1323
         MH    @15,B                                               1323
         LR    @01,@05                                             1323
         AL    @01,@TF00001                                        1323
         AL    @01,@CF01862                                        1323
         MVC   @TS00001(31),ALLSENSE(@01)                          1323
         ST    @15,@TF00002                                        1323
         ALR   @15,@05                                             1323
         AL    @15,@CF01862                                        1323
         XC    @TS00001(31),ALLSENSE(@15)                          1323
         MVC   ALLSENSE(31,@14),@TS00001                           1323
*    ALLSENSE(B)=ALLSENSE(B)&&ALLSENSE(C);                         1324
         LR    @01,@05                                             1324
         AL    @01,@TF00002                                        1324
         AL    @01,@CF01862                                        1324
         LR    @15,@05                                             1324
         AL    @15,@TF00002                                        1324
         AL    @15,@CF01862                                        1324
         MVC   @TS00001(31),ALLSENSE(@15)                          1324
         LR    @15,@05                                             1324
         AL    @15,@TF00001                                        1324
         AL    @15,@CF01862                                        1324
         XC    @TS00001(31),ALLSENSE(@15)                          1324
         MVC   ALLSENSE(31,@01),@TS00001                           1324
*    ALLSENSE(C)=ALLSENSE(C)&&ALLSENSE(B);                         1325
         LR    @01,@05                                             1325
         AL    @01,@TF00001                                        1325
         AL    @01,@CF01862                                        1325
         LR    @15,@05                                             1325
         AL    @15,@TF00001                                        1325
         AL    @15,@CF01862                                        1325
         MVC   @TS00001(31),ALLSENSE(@15)                          1325
         AL    @05,@TF00002                                        1325
         AL    @05,@CF01862                                        1325
         XC    @TS00001(31),ALLSENSE(@05)                          1325
         MVC   ALLSENSE(31,@01),@TS00001                           1325
*    END SORTSNSE;                                                 1326
@EL00036 DS    0H                                                  1326
@EF00036 DS    0H                                                  1326
@ER00036 LM    @14,@12,12(@13)                                     1326
         BR    @14                                                 1326
* /********************************************************************
* /*                        READREC                                   *
* /*    THIS PROC WILL READ THE RECORDS FOR ALL GROUPS.  THE CALLING  *
* /*    PROGRAM MUST PASS THE NUMBER OF RECORDS AND THE NUMBER OF     *
* /*    ENTRIES THAT HAVE BEEN USED UP.                               *
*READREC:                                                          1327
*    PROC(NUMTODO1);                                               1327
READREC  STM   @14,@12,@SA00037                                    1327
         MVC   @PC00037(4),0(@01)                                  1327
*    DCL                                                           1328
*      NUMTODO1 FIXED(15);                                         1328
*    INTABLE=ZERO;                   /* SET NUMBER READ TO ZERO       *
         SLR   @05,@05                                             1329
         STH   @05,INTABLE                                         1329
*    DO E=1 BY 1 TO SAVEIN;          /* CLEAR ALL PRIOR ENTRIES       *
         LA    @05,1                                               1330
         STH   @05,E                                               1330
         B     @DE01330                                            1330
@DL01330 DS    0H                                                  1331
*      ALLSENSE(E)=ALLSENSE(E)&&ALLSENSE(E);                       1331
         LR    @15,@05                                             1331
         MH    @15,@CH00042                                        1331
         L     @01,SENSEPTR                                        1331
         ALR   @01,@15                                             1331
         AL    @01,@CF01862                                        1331
         XC    ALLSENSE(31,@01),ALLSENSE(@01)                      1331
*    END;                                                          1332
         AH    @05,@CH00057                                        1332
         STH   @05,E                                               1332
@DE01330 CH    @05,SAVEIN                                          1332
         BNH   @DL01330                                            1332
*    DO E=1 BY 1 TO NUMTODO1 WHILE(ERROR=OFF);                     1333
*                                                                  1333
         LA    @05,1                                               1333
         STH   @05,E                                               1333
         B     @DE01333                                            1333
@DL01333 TM    ERROR,B'00100000'                                   1333
         BNZ   @DC01333                                            1333
*      RECCCHHR=RECLOC(E);           /* MOVE ADDRESS INTO THE LINE    *
         MH    @05,@CH00034                                        1334
         L     @01,SORTAT                                          1334
         ALR   @01,@05                                             1334
         AL    @01,@CF01893                                        1334
         MVC   RECCCHHR(5,R2),RECLOC-6(@01)                        1334
*      CALL IOHND(READIRCT);         /* ASK IO HANDLER FOR NEXT RECORD*
         L     @15,ADIOHND(,R2)                                    1335
         LA    @01,@AL01335                                        1335
         BALR  @14,@15                                             1335
*      RESPECIFY                                                   1336
*       (R7,                                                       1336
*        R15) RESTRICTED;                                          1336
*      IF R15^=ZERO THEN             /* WAS THE READ OK               *
         LTR   R15,R15                                             1337
         BZ    @RF01337                                            1337
*        ERROR=ON;                   /* THE RESULTS OF THIS IS WE WILL
*                                       KEEP COMING BACK TO READ IF AN
*                                       ERROR OCCURES BUT WILL NOT GO
*                                       BACK TO THE I/O HANDLER       *
         OI    ERROR,B'00100000'                                   1338
*      ELSE                                                        1339
*        BYTES(E)=OBRSENSE;          /* MOVE THE SENSE INFO INTO TABLE*
         B     @RC01337                                            1339
@RF01337 LH    @14,E                                               1339
         MH    @14,@CH00042                                        1339
         L     @06,SENSEPTR                                        1339
         ALR   @06,@14                                             1339
         AL    @06,@CF01884                                        1339
         LA    @14,OBRVOL(,R7)                                     1339
         SLR   @05,@05                                             1339
         IC    @05,OBRDEVDC(,R7)                                   1339
         SLA   @05,3                                               1339
         ALR   @14,@05                                             1339
         MVC   @ZT00003+3(1),OBRLSDRC(R7)                          1339
         AL    @14,@ZT00003                                        1339
         MVC   BYTES-3(24,@06),OBRSENSE(@14)                       1339
*      RESPECIFY                                                   1340
*       (R7,                                                       1340
*        R15) UNRESTRICTED;                                        1340
@RC01337 DS    0H                                                  1341
*      INTABLE=INTABLE+ONE;          /* EASY WAY TO KNOW HOW MANY  1341
*                                       RECORDS ARE IN CORE           *
         LH    @05,INTABLE                                         1341
         AH    @05,ONE                                             1341
         STH   @05,INTABLE                                         1341
*      CUAP(E)=CUA3(E);              /* MOVE THE CUA FROM SORT TABLE
*                                       INTO THE SENSE BYTE TABLE     *
         L     @05,SENSEPTR                                        1342
         LH    @15,E                                               1342
         LR    @14,@15                                             1342
         MH    @14,@CH00042                                        1342
         ST    @14,@TF00001                                        1342
         ALR   @14,@05                                             1342
         AL    @14,@CF01862                                        1342
         L     @07,SORTAT                                          1342
         LR    @06,@15                                             1342
         MH    @06,@CH00034                                        1342
         ST    @06,@TF00002                                        1342
         ALR   @06,@07                                             1342
         AL    @06,@CF01858                                        1342
         MVC   CUAP(2,@14),CUA3(@06)                               1342
*      SWITCH(E)=SWTCH(E);           /* MOVE THE EVD-SHARE BITS OVER  *
         AL    @05,@TF00001                                        1343
         AL    @05,@CF01863                                        1343
         AL    @07,@TF00002                                        1343
         AL    @07,@CF01859                                        1343
         MVC   SWITCH-2(1,@05),SWTCH-3(@07)                        1343
*    END;                                                          1344
         AH    @15,@CH00057                                        1344
         LR    @05,@15                                             1344
         STH   @05,E                                               1344
@DE01333 L     @15,@PC00037                                        1344
         CH    @05,NUMTODO1(,@15)                                  1344
         BNH   @DL01333                                            1344
@DC01333 DS    0H                                                  1345
*    SAVEIN=INTABLE;                 /* SAVE INCASE CALLER CHANGES 1345
*                                       INTABLE                       *
         LH    @05,INTABLE                                         1345
         STH   @05,SAVEIN                                          1345
*    SORTAT=SORTAT+11*INTABLE;       /* MOVE THE POINTER TO NEXT GROUP*
         LR    @15,@05                                             1346
         MH    @15,@CH00034                                        1346
         AL    @15,SORTAT                                          1346
         ST    @15,SORTAT                                          1346
*    NUMDONE=NUMDONE+INTABLE;        /* # RECORDS READ TOTAL          *
         AH    @05,NUMDONE                                         1347
         STH   @05,NUMDONE                                         1347
*    IF SWITCH4=ON THEN              /* THIS GROUP REQUIRE DIVISION OF
*                                       SB 5 & 10                     *
         TM    SWITCH4,B'00000100'                                 1348
         BNO   @RF01348                                            1348
*      CALL DIVIDE;                  /* FIND INTERGAL & REMAINDER FOR
*                                       SB 5 & 10                     *
         BAL   @14,DIVIDE                                          1349
*    IF DEBUG63=ON THEN              /* HEXDUMP SB TABLE              *
@RF01348 TM    DEBUG63(R2),B'00000001'                             1350
         BNO   @RF01350                                            1350
*      CALL DUMP1;                                                 1351
         BAL   @14,DUMP1                                           1351
*    END READREC;                                                  1352
@EL00037 DS    0H                                                  1352
@EF00037 DS    0H                                                  1352
@ER00037 LM    @14,@12,@SA00037                                    1352
         BR    @14                                                 1352
* /********************************************************************
* /*                           DIVIDE                                 *
* /*    THIS PROC WILL DIVIDE SB5 AND 10 AND PLACE THE INTERGAL AND   *
* /*    REMAINDER IN THE SB TABLE IN ITEMS DIVIDE25,26,27, & 28       *
* /*    THE CALLING PROC WILL PASS THE NUMBER OF ENTRIES TO DIVIDE    *
* /*    AND WHERE IN THE SB TABLE TO START                            *
*                                                                  1353
*DIVIDE:                                                           1353
*    PROC;                                                         1353
DIVIDE   STM   @14,@12,12(@13)                                     1353
*    RESPECIFY                                                     1354
*     (R0,                                                         1354
*      R1) RESTRICTED;                                             1354
*    DO F=1 BY 1 TO INTABLE;         /* DO FPLLOWING FOR ALL RECORDS
*                                       READ IN                       *
         LA    @05,1                                               1355
         STH   @05,F                                               1355
         B     @DE01355                                            1355
@DL01355 DS    0H                                                  1356
*      R0=BYTE5(F);                  /* EXTRACT BYTE 5                *
         L     @15,SENSEPTR                                        1356
         LR    @14,@05                                             1356
         MH    @14,@CH00042                                        1356
         LA    @07,0(@14,@15)                                      1356
         AL    @07,@CF01875                                        1356
         SLR   R0,R0                                               1356
         IC    R0,BYTE5-8(,@07)                                    1356
*      SRDL(R0,2);                   /* DIVIDE BY 4                   *
         SRDL  R0,2                                                1357
*      SRL(R1,30);                   /* POSITION THE REMAINDER        *
         SRL   R1,30                                               1358
*      DIVIDE24(F)=R0;               /* MOVE THE INTERGAL INTO THE SB
*                                       TABLE                         *
         LA    @07,0(@14,@15)                                      1359
         AL    @07,@CF01877                                        1359
         STC   R0,DIVIDE24-27(,@07)                                1359
*      DIVIDE25(F)=R1;               /* MOVE THE REMAINDER INTO THE SB
*                                       TABLE                         *
         LA    @07,0(@14,@15)                                      1360
         AL    @07,@CF01880                                        1360
         STC   R1,DIVIDE25-28(,@07)                                1360
*      R0=BYTE10(F);                 /* DO THE SAME THING FOR BYTE 10 *
         LA    @07,0(@14,@15)                                      1361
         AL    @07,@CF01876                                        1361
         SLR   R0,R0                                               1361
         IC    R0,BYTE10-13(,@07)                                  1361
*      SRDL(R0,2);                                                 1362
         SRDL  R0,2                                                1362
*      SRL(R1,30);                                                 1363
         SRL   R1,30                                               1363
*      DIVIDE26(F)=R0;               /* SAVE THE INTEGRAL OF SB10     *
         LA    @07,0(@14,@15)                                      1364
         BCTR  @07,0                                               1364
         BCTR  @07,0                                               1364
         STC   R0,DIVIDE26-29(,@07)                                1364
*      DIVIDE27(F)=R1;               /* SAVE THE REMAINDER OF SB5     *
         BCTR  @15,0                                               1365
         STC   R1,DIVIDE27-30(@14,@15)                             1365
*    END;                                                          1366
         AH    @05,@CH00057                                        1366
         STH   @05,F                                               1366
@DE01355 CH    @05,INTABLE                                         1366
         BNH   @DL01355                                            1366
*    RESPECIFY                                                     1367
*     (R0,                                                         1367
*      R1) UNRESTRICTED;                                           1367
*    END DIVIDE;                                                   1368
@EL00038 DS    0H                                                  1368
@EF00038 DS    0H                                                  1368
@ER00038 LM    @14,@12,12(@13)                                     1368
         BR    @14                                                 1368
* /********************************************************************
* /*    THIS PROC WILL PRINT THE EAC LINE FOR ALL GROUPS              *
*PRTHEAD:                                                          1369
*    PROC(FROMWHOM);                                               1369
PRTHEAD  STM   @14,@12,@SA00039                                    1369
         MVC   @PC00039(4),0(@01)                                  1369
*    DCL                                                           1370
*      FROMWHOM FIXED(15);           /* GROUP NUMBER FROM CALLING PROC*
*    IF PRINTFLG=OFF THEN            /* DO WE NEED A HEADING          *
         TM    PRINTFLG,B'10000000'                                1371
         BNZ   @RF01371                                            1371
*      CALL HEADING;                 /* PRINT HEADING LINE            *
         BAL   @14,HEADING                                         1372
*    TYPE=TYPE1(FROMWHOM);           /* MOVE IN THE EAC TYPE          *
@RF01371 L     @05,@PC00039                                        1373
         LH    @05,FROMWHOM(,@05)                                  1373
         LR    @15,@05                                             1373
         SLA   @15,2                                               1373
         LA    @14,TYPE1-4(@15)                                    1373
         MVC   TYPE(4),0(@14)                                      1373
*    IF SWITCH3=ON THEN              /* IS THIS PASS FOR EVD OUTPUT   *
         TM    SWITCH3,B'00001000'                                 1374
         BNO   @RF01374                                            1374
*      DO;                           /*EAC FOR RECORDS WITH THE EVD ON*
*        TYPEE='E';                  /* SHOW THIS IS EVD PASS TO USER *
         MVI   TYPEE,C'E'                                          1376
*        CALL CONVERT1(TWO,ADDR(EACVAL),ADDR(EVDMDC(A,FROMWHOM))); 1377
         LA    @15,EACVAL                                          1377
         ST    @15,@AFTEMPS+48                                     1377
         LH    @15,A                                               1377
         MH    @15,@CH00081                                        1377
         ALR   @15,@05                                             1377
         ALR   @15,@15                                             1377
         LA    @05,EVDMDC-14(@15)                                  1377
         ST    @05,@AFTEMPS+52                                     1377
         LA    @01,@AL01377                                        1377
         BAL   @14,CONVERT1                                        1377
*        CALL CONVBIN(4,EVDCOUNT(A,FROMWHOM),ADDR(SAMPLE1));       1378
         MVC   @AL00001(12),@AL01378                               1378
         LH    @05,A                                               1378
         MH    @05,@CH00081                                        1378
         L     @15,@PC00039                                        1378
         AH    @05,FROMWHOM(,@15)                                  1378
         ALR   @05,@05                                             1378
         LA    @05,EVDCOUNT-14(@05)                                1378
         ST    @05,@AL00001+4                                      1378
         LA    @05,SAMPLE1                                         1378
         ST    @05,@AFTEMPS+48                                     1378
         LA    @01,@AL00001                                        1378
         BAL   @14,CONVBIN                                         1378
*      END;                                                        1379
*    ELSE                                                          1380
*      DO;                           /*EAC FOR ALL RECORDS           */
         B     @RC01374                                            1380
@RF01374 DS    0H                                                  1381
*        CALL CONVERT1(TWO,ADDR(EACVAL),ADDR(MAINMDC(A,FROMWHOM)));
         LA    @05,EACVAL                                          1381
         ST    @05,@AFTEMPS+48                                     1381
         LH    @05,A                                               1381
         MH    @05,@CH00081                                        1381
         L     @15,@PC00039                                        1381
         AH    @05,FROMWHOM(,@15)                                  1381
         ALR   @05,@05                                             1381
         LA    @05,MAINMDC-14(@05)                                 1381
         ST    @05,@AFTEMPS+52                                     1381
         LA    @01,@AL01381                                        1381
         BAL   @14,CONVERT1                                        1381
*        CALL CONVBIN(4,ALLCOUNT(A,FROMWHOM),ADDR(SAMPLE1));       1382
         MVC   @AL00001(12),@AL01382                               1382
         LH    @05,A                                               1382
         MH    @05,@CH00081                                        1382
         L     @15,@PC00039                                        1382
         AH    @05,FROMWHOM(,@15)                                  1382
         ALR   @05,@05                                             1382
         LA    @05,ALLCOUNT-14(@05)                                1382
         ST    @05,@AL00001+4                                      1382
         LA    @05,SAMPLE1                                         1382
         ST    @05,@AFTEMPS+48                                     1382
         LA    @01,@AL00001                                        1382
         BAL   @14,CONVBIN                                         1382
*      END;                                                        1383
*    MOVEEAC1=PRIME1;                /* MOVE MAIN EAC LINE TO PRINT   *
@RC01374 MVC   MOVEEAC1(60),PRIME1                                 1384
*    CALL PRINTIT;                   /* PRINT THE INFORMATION         *
         BAL   @14,PRINTIT                                         1385
*    END PRTHEAD;                                                  1386
@EL00039 DS    0H                                                  1386
@EF00039 DS    0H                                                  1386
@ER00039 LM    @14,@12,@SA00039                                    1386
         BR    @14                                                 1386
* /********************************************************************
* /*                         HEADING                                  *
* /*    THIS PROC WILL PRINT THE TOP LINE OF THE HEADING. ONLY IF     *
* /*    THE HEADING FLAG IS OFF.                                      *
* /*    UNLESS IT'S A SHARED CONDITION   (SHARED BIT SET ON)          *
* /*    THE PROC WILL SET THE SERIAL FROM THE LAST RECORDS READ.      *
* /*    THE MODEL WILL BE SET FROM THE LAST RECORD READ               *
*HEADING:                                                          1387
*    PROC;                                                         1387
HEADING  STM   @14,@12,@SA00040                                    1387
*    PRINTFLG=ON;                    /* DO ONLY ONCE FOR EACH CUA     *
         OI    PRINTFLG,B'10000000'                                1388
*    MAINLINF=MAINLINE;              /* MOVE FIXED INFORMATION INTO
*                                       THE PRINT LINE                *
         MVC   MAINLINF(57),MAINLINE                               1389
*    CALL PRINTIT;                   /* PRINT THE MAIN HEADING LINE   *
         BAL   @14,PRINTIT                                         1390
*    CALL CONVERT1(TWO,ADDR(CUALABEL),ADDR(CUAP(1)));              1391
         LA    @05,CUALABEL                                        1391
         ST    @05,@AFTEMPS+56                                     1391
         L     @05,SENSEPTR                                        1391
         ST    @05,@AFTEMPS+60                                     1391
         LA    @01,@AL01391                                        1391
         BAL   @14,CONVERT1                                        1391
*    CALL CONVERT1(THREE,ADDR(SERIAL),ADDR(RDTHRSH));              1392
         LA    @05,SERIAL                                          1392
         ST    @05,@AFTEMPS+56                                     1392
         LA    @05,RDTHRSH(,R2)                                    1392
         ST    @05,@AFTEMPS+60                                     1392
         LA    @01,@AL01392                                        1392
         BAL   @14,CONVERT1                                        1392
*    MAINLIND=MAINLIN1;              /* PRINT LINE WITH CUA,SERIAL &
*                                       COUNTS                        *
         MVC   MAINLIND(58),MAINLIN1                               1393
*    IF SHAREON(1)=ON THEN                                         1394
         L     @05,SENSEPTR                                        1394
         TM    SHAREON(@05),B'01000000'                            1394
         BNO   @RF01394                                            1394
*      MAINLING=SHARE2;              /* PUT WORD SHARED IN TO THE  1395
*                                       PRINT LINE                    *
         MVC   MAINLING(6),SHARE2                                  1395
*    CALL PRINTIT;                   /* PRINT THE VARIABLE HEADING 1396
*                                       INFO                          *
@RF01394 BAL   @14,PRINTIT                                         1396
*    END HEADING;                                                  1397
@EL00040 DS    0H                                                  1397
@EF00040 DS    0H                                                  1397
@ER00040 LM    @14,@12,@SA00040                                    1397
         BR    @14                                                 1397
* /********************************************************************
* /*                            BUGOUT                                *
* /*    THIS PROC WILL PRINT OUT THE VARIOUS DEBUG REQUEST            *
*BUGOUT:                                                           1398
*    PROC(OPTION);                                                 1398
BUGOUT   STM   @14,@12,@SA00041                                    1398
         MVC   @PC00041(4),0(@01)                                  1398
*    DO B=1 BY 1 TO 6;                                             1399
         LA    @05,1                                               1399
         STH   @05,B                                               1399
@DL01399 DS    0H                                                  1400
*      CALL CONVERT1(T32,PRT0,ADDR(ALLCOUNT)+32*(B-1));            1400
         LA    @15,ALLCOUNT                                        1400
         BCTR  @05,0                                               1400
         SLA   @05,5                                               1400
         ALR   @15,@05                                             1400
         ST    @15,@AFTEMPS+64                                     1400
         LA    @01,@AL01400                                        1400
         BAL   @14,CONVERT1                                        1400
*      CALL PRINTIT;                                               1401
         BAL   @14,PRINTIT                                         1401
*    END;                                                          1402
         LA    @05,1                                               1402
         AH    @05,B                                               1402
         STH   @05,B                                               1402
         CH    @05,@CH00081                                        1402
         BNH   @DL01399                                            1402
*    CALL PRINTIT;                                                 1403
         BAL   @14,PRINTIT                                         1403
*    CALL CONVERT1(T32,PRT0,ADDR(SPGROUP6));                       1404
         LA    @05,SPGROUP6                                        1404
         ST    @05,@AFTEMPS+64                                     1404
         LA    @01,@AL01404                                        1404
         BAL   @14,CONVERT1                                        1404
*    CALL PRINTIT;                                                 1405
         BAL   @14,PRINTIT                                         1405
*    CALL PRINTIT;                                                 1406
         BAL   @14,PRINTIT                                         1406
*    CALL CONVERT1(T32,PRT0,ADDR(EVDSPGP6));                       1407
         LA    @05,EVDSPGP6                                        1407
         ST    @05,@AFTEMPS+64                                     1407
         LA    @01,@AL01407                                        1407
         BAL   @14,CONVERT1                                        1407
*    CALL PRINTIT;                                                 1408
         BAL   @14,PRINTIT                                         1408
*    CALL PRINTIT;                                                 1409
         BAL   @14,PRINTIT                                         1409
*    DO B=1 BY 1 TO 8;                                             1410
         LA    @05,1                                               1410
         STH   @05,B                                               1410
@DL01410 DS    0H                                                  1411
*      CALL CONVERT1(T32,PRT0,ADDR(EVDCOUNT)+32*(B-1));            1411
         LA    @15,EVDCOUNT                                        1411
         BCTR  @05,0                                               1411
         SLA   @05,5                                               1411
         ALR   @15,@05                                             1411
         ST    @15,@AFTEMPS+64                                     1411
         LA    @01,@AL01411                                        1411
         BAL   @14,CONVERT1                                        1411
*      CALL PRINTIT;                                               1412
         BAL   @14,PRINTIT                                         1412
*    END;                                                          1413
         LA    @05,1                                               1413
         AH    @05,B                                               1413
         STH   @05,B                                               1413
         CH    @05,@CH00037                                        1413
         BNH   @DL01410                                            1413
*    END BUGOUT;                                                   1414
@EL00041 DS    0H                                                  1414
@EF00041 DS    0H                                                  1414
@ER00041 LM    @14,@12,@SA00041                                    1414
         BR    @14                                                 1414
*DUMP1:                                                            1415
*    PROC;                                                         1415
DUMP1    STM   @14,@12,@SA00042                                    1415
*    CALL PRINTIT;                   /* BLANK LINE                    *
         BAL   @14,PRINTIT                                         1416
*    DO I=1 BY 1 TO INTABLE;         /* HEXDUMP ALL ENTRIES IN SB  1417
*                                       TABLE                         *
         LA    @05,1                                               1417
         STH   @05,I                                               1417
         B     @DE01417                                            1417
@DL01417 DS    0H                                                  1418
*      CALL CONVERT1(T31,PRT0,SENSEPTR+T31*(I-1));                 1418
         LR    @01,@05                                             1418
         BCTR  @01,0                                               1418
         MH    @01,T31                                             1418
         AL    @01,SENSEPTR                                        1418
         ST    @01,@AFTEMPS+68                                     1418
         LA    @01,@AL01418                                        1418
         BAL   @14,CONVERT1                                        1418
*      CALL PRINTIT;                                               1419
         BAL   @14,PRINTIT                                         1419
*    END;                                                          1420
         LA    @05,1                                               1420
         AH    @05,I                                               1420
         STH   @05,I                                               1420
@DE01417 CH    @05,INTABLE                                         1420
         BNH   @DL01417                                            1420
*    END DUMP1;                                                    1421
@EL00042 DS    0H                                                  1421
@EF00042 DS    0H                                                  1421
@ER00042 LM    @14,@12,@SA00042                                    1421
         BR    @14                                                 1421
*DUMP2:                                                            1422
*    PROC;                                                         1422
DUMP2    STM   @14,@12,@SA00043                                    1422
*    DO I=1 BY 1 TO NUMBER2;         /* DO TO TOTAL # OF RECORDS      *
         LA    @05,1                                               1423
         STH   @05,I                                               1423
         B     @DE01423                                            1423
@DL01423 DS    0H                                                  1424
*      CALL CONVERT1(ELEVEN,PRT0,DSORTAT+11*(I-1));                1424
         BCTR  @05,0                                               1424
         MH    @05,@CH00034                                        1424
         AL    @05,DSORTAT                                         1424
         ST    @05,@AFTEMPS+72                                     1424
         LA    @01,@AL01424                                        1424
         BAL   @14,CONVERT1                                        1424
*      CALL PRINTIT;                 /* PRINT ONE SORT TABLE ENTRY    *
         BAL   @14,PRINTIT                                         1425
*    END;                                                          1426
         LA    @05,1                                               1426
         AH    @05,I                                               1426
         STH   @05,I                                               1426
@DE01423 CH    @05,NUMBER2                                         1426
         BNH   @DL01423                                            1426
*    END DUMP2;                                                    1427
@EL00043 DS    0H                                                  1427
@EF00043 DS    0H                                                  1427
@ER00043 LM    @14,@12,@SA00043                                    1427
         BR    @14                                                 1427
* /********************************************************************
* /*   THIS PROC WILL REQUEST THE IO-HANDLER TO PRINT A LINE OF DATA  *
*PRINTIT:                                                          1428
*    PROC;                                                         1428
PRINTIT  STM   @14,@12,@SA00044                                    1428
*    PRINTADR=ADDR(PRINTLIN);        /* PUT THE ADD IN FOR THE     1429
*                                       IOHANDLER                     *
         LA    @05,PRINTLIN                                        1429
         ST    @05,PRINTADR(,R2)                                   1429
*    IF ERROR=OFF THEN                                             1430
         TM    ERROR,B'00100000'                                   1430
         BNZ   @RF01430                                            1430
*      CALL IOHND(RITEPRTR);         /* TELL I/O TO PRINT THE      1431
*                                       INFORMATION                   *
         L     @15,ADIOHND(,R2)                                    1431
         LA    @01,@AL01431                                        1431
         BALR  @14,@15                                             1431
*    RESPECIFY                                                     1432
*     (R15) RESTRICTED;                                            1432
@RF01430 DS    0H                                                  1433
*    IF R15^=ZERO THEN               /* IF IO FOUND A PRINTER PROBLEM
*                                       SET FLAG                      *
         LTR   R15,R15                                             1433
         BZ    @RF01433                                            1433
*      ERROR=ON;                     /* TO TERMINATE                  *
         OI    ERROR,B'00100000'                                   1434
*    RESPECIFY                                                     1435
*     (R15) UNRESTRICTED;                                          1435
*    END PRINTIT;                                                  1436
@EL00044 DS    0H                                                  1436
@EF00044 DS    0H                                                  1436
@ER00044 LM    @14,@12,@SA00044                                    1436
         BR    @14                                                 1436
* /********************************************************************
* /*                   CONVERT HEX TO PRINTABLE                       *
* /*    THIS PROC WILL CONVERT ANY NUMBER OF HEX CHARACTERS TO PRINTAB*
*CONVERT1:                                                         1437
*    PROC(NUMBER,ADDNXT,NEXTBY);                                   1437
CONVERT1 STM   @14,@12,12(@13)                                     1437
         MVC   @PC00045(12),0(@01)                                 1437
*    DCL                                                           1438
*      NUMBER FIXED(15);             /* NUMBER OF BYTES TO CONVERT    *
*    DCL                                                           1439
*      NEXTBY POINTER(31);           /* WHERE THE BYTES ARE COMING 1439
*                                       FROM                          *
*    DCL                                                           1440
*      ADDNXT POINTER(31);           /* WHERE THE CONVERTED BYTES ARE
*                                       GOING                         *
*    RESPECIFY                                                     1441
*     (R4,                                                         1441
*      R5) RESTRICTED;                                             1441
*    DO J=NUMBER BY-1 TO ONE;                                      1442
         L     @15,@PC00045                                        1442
         LH    @15,NUMBER(,@15)                                    1442
         STH   @15,J                                               1442
         B     @DE01442                                            1442
@DL01442 DS    0H                                                  1443
*      R4=NEXTBYTE(J);               /* PICK UP THE NEXT BYTE TO SPLIT*
         L     @14,@PC00045+8                                      1443
         L     @01,NEXTBY(,@14)                                    1443
         BCTR  @01,0                                               1443
         SLR   R4,R4                                               1443
         IC    R4,NEXTBYTE(@15,@01)                                1443
*      SRDL(R4,FOUR);                /* SPLIT THE BYTE ACROSS 2 REGS  *
         SRDL  R4,4                                                1444
*      SRL(R5,28);                   /* RIGHT JUSTIFY THE DATA IN REGS*
         SRL   R5,28                                               1445
*      T=TWO*J;                      /* OUTPUT IS TWICE THE INPUT     *
         LR    @14,@15                                             1446
         MH    @14,TWO                                             1446
         STH   @14,T                                               1446
*      ADDNUM(T-ONE)=CHAR1(R4+1);    /* MOVE THE CHAR THE REG ='S OUT *
         LR    @07,@14                                             1447
         SH    @07,ONE                                             1447
         L     @06,@PC00045+4                                      1447
         L     @06,ADDNXT(,@06)                                    1447
         ALR   @07,@06                                             1447
         BCTR  @07,0                                               1447
         LA    @01,CHAR1(R4)                                       1447
         MVC   ADDNUM(1,@07),0(@01)                                1447
*      ADDNUM(T)=CHAR1(R5+1);        /* +1TO MAKE UP FOR INDEX BY ZERO*
         ALR   @06,@14                                             1448
         BCTR  @06,0                                               1448
         LA    @07,CHAR1(R5)                                       1448
         MVC   ADDNUM(1,@06),0(@07)                                1448
*    END;                                                          1449
         BCTR  @15,0                                               1449
         STH   @15,J                                               1449
@DE01442 CH    @15,ONE                                             1449
         BNL   @DL01442                                            1449
*    END CONVERT1;                                                 1450
@EL00045 DS    0H                                                  1450
@EF00045 DS    0H                                                  1450
@ER00045 LM    @14,@12,12(@13)                                     1450
         BR    @14                                                 1450
* /********************************************************************
* /*                 CONVERT BINARY TO PRINTABLE                      *
* /*    THIS PROC WILL TAKE AN ITEM IN BINARY AND CONVERT TO PRINTABLE*
* /*    FOR THE NUMBER OF PLACES REQUESTED BY THE USER IF THE NUMBER IS
*                                                                     *
* /*    TO LARGE THE RESULTS WILL BE ALL NINES, ALSO LEADING ZEROS    *
* /*    WILL BE SUPPRESSED.  (MAX OF 8 CHAR OUT)                      *
* /*    NOTE: THE INPUT NUMBER MUST BE A FIXED 15 ITEM OR DISASTER    *
* /*          WILL OCCUR!                                             *
*CONVBIN:                                                          1451
*    PROC(BNDECNUM,BINWORD,DECADDR);                               1451
CONVBIN  STM   @14,@12,@SA00046                                    1451
         MVC   @PC00046(12),0(@01)                                 1451
*    DCL                                                           1452
*      BNDECNUM FIXED(31);           /* NUMBER OF PRINT POSITIONS  1452
*                                       ALLOWED                       *
*    DCL                                                           1453
*      BINWORD FIXED(15);            /* BINARY VALUE TO CONVERT       *
*    DCL                                                           1454
*      DECADDR FIXED(31);            /* LOCATION WHERE THE CONVERTED
*                                       VALUE GOES                    *
*    R4=BINWORD;                                                   1455
         L     @15,@PC00046+4                                      1455
         LH    R4,BINWORD(,@15)                                    1455
*    CVD(R4,DBLWORD);                                              1456
         CVD   R4,DBLWORD                                          1456
*    GEN(UNPK WORK(8),DBLWORD(8));                                 1457
         UNPK WORK(8),DBLWORD(8)
*    WORK(8)=WORK(8)×'F0'X;                                        1458
         OI    WORK+7,X'F0'                                        1458
*    SWITCH1=OFF;                                                  1459
         NI    SWITCH1,B'11011111'                                 1459
*    DO J=1 TO 7 BY 1 WHILE(SWITCH1=OFF);                          1460
         LA    @15,1                                               1460
         STH   @15,J                                               1460
@DL01460 TM    SWITCH1,B'00100000'                                 1460
         BNZ   @DC01460                                            1460
*      IF WORK(J)=FOXZERO THEN                                     1461
         LA    @14,WORK-1(@15)                                     1461
         CLC   0(1,@14),FOXZERO                                    1461
         BNE   @RF01461                                            1461
*        WORK(J)=BLANK;                                            1462
         LA    @14,WORK-1(@15)                                     1462
         MVC   0(1,@14),BLANK                                      1462
*      ELSE                                                        1463
*        SWITCH1=ON;                                               1463
         B     @RC01461                                            1463
@RF01461 OI    SWITCH1,B'00100000'                                 1463
*    END;                                                          1464
@RC01461 LA    @15,1                                               1464
         AH    @15,J                                               1464
         STH   @15,J                                               1464
         CH    @15,@CH00083                                        1464
         BNH   @DL01460                                            1464
@DC01460 DS    0H                                                  1465
*    IF(10-J)>BNDECNUM THEN                                        1465
         LA    @15,10                                              1465
         SH    @15,J                                               1465
         L     @14,@PC00046                                        1465
         C     @15,BNDECNUM(,@14)                                  1465
         BNH   @RF01465                                            1465
*      DO;                                                         1466
*        GEN(MVI  WORKOVER,X'F9');                                 1467
         MVI  WORKOVER,X'F9'
*        GEN(MVC  WORKOVER+1(7),WORKOVER);                         1468
         MVC  WORKOVER+1(7),WORKOVER
*      END;                                                        1469
*    RESPECIFY                                                     1470
*     (R6) RESTRICTED;                                             1470
@RF01465 DS    0H                                                  1471
*    R6=DECADDR;                                                   1471
         L     @15,@PC00046+8                                      1471
         L     R6,DECADDR(,@15)                                    1471
*    R5=BNDECNUM-1;                                                1472
         L     @07,@PC00046                                        1472
         L     @07,BNDECNUM(,@07)                                  1472
         LR    R5,@07                                              1472
         BCTR  R5,0                                                1472
*    R4=ADDR(WORKOVER)+8-BNDECNUM;                                 1473
         LA    R4,WORKOVER                                         1473
         AH    R4,@CH00037                                         1473
         SLR   R4,@07                                              1473
*    GEN(EX R5,MVCDATA);                                           1474
         EX R5,MVCDATA
*    GENERATE DATA;                                                1475
*    RESPECIFY                                                     1476
*     (R4,                                                         1476
*      R5,                                                         1476
*      R6) UNRESTRICTED;                                           1476
*    END CONVBIN;                                                  1477
@EL00046 DS    0H                                                  1477
@EF00046 DS    0H                                                  1477
@ER00046 LM    @14,@12,@SA00046                                    1477
         BR    @14                                                 1477
*    END IFCNFPDR                                                  1478
* /* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.  1478
* /*%INCLUDE SYSLIB  (COMTABLE)                                    1478
* ;                                                                1478
@DATA    DS    0H
@CH00057 DC    H'1'
@CH00081 DC    H'6'
@CH00083 DC    H'7'
@CH00037 DC    H'8'
@CH00035 DC    H'10'
@CH00034 DC    H'11'
@CH00033 DC    H'12'
@CH01416 DC    H'22'
@CH00227 DC    H'24'
@CH01434 DC    H'25'
@CH00042 DC    H'31'
@CH00895 DC    H'32'
@CH01112 DC    H'256'
@CH01113 DC    H'512'
@CH00102 DC    XL2'0100'
@CH01776 DC    XL2'0010'
@CH00279 DC    XL2'FF'
         DS    0F
@AL00329 DC    A(@CF01580)             LIST WITH   2 ARGUMENT(S)
         DC    A(PRT9)
@AL00447 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT12)
         DC    A(@AFTEMPS)
@AL00448 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT17)
         DC    A(@AFTEMPS)
@AL00449 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT21)
         DC    A(@AFTEMPS)
@AL00470 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT39)
         DC    A(@AFTEMPS+4)
@AL00471 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT44)
         DC    A(@AFTEMPS+4)
@AL00472 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT48)
         DC    A(@AFTEMPS+4)
@AL00493 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT68)
         DC    A(@AFTEMPS+8)
@AL00494 DC    A(ONE)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT72)
         DC    A(@AFTEMPS+8)
@AL00495 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00407 DC    A(ONE)                  LIST WITH   1 ARGUMENT(S)
         DC    A(PRT77)
         DC    A(@AFTEMPS+8)
@AL00569 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+12)
@AL00570 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00867 DC    A(FOUR1)                LIST WITH   1 ARGUMENT(S)
         DC    A(PRT6)
         DC    A(@AFTEMPS+12)
@AL00571 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT17)
         DC    A(@AFTEMPS+12)
@AL00572 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(THENUMBR)
         DC    A(PRT25)
@AL00573 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SAVER33)
         DC    A(PRT32)
@AL00574 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(R33)
         DC    A(PRT39)
@AL00575 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SAVER4)
         DC    A(PRT46)
@AL00576 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SAVER44)
         DC    A(PRT58)
@AL00797 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00810 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00831 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00837 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(TEMPSV1)
         DC    A(@AFTEMPS+16)
@AL00801 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00806 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00814 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00819 DC    A(@CF00075)             LIST WITH   3 ARGUMENT(S)
         DC    A(TEMPSV1)
         DC    A(@AFTEMPS+16)
@AL00845 DC    A(TEMPSV)               LIST WITH   1 ARGUMENT(S)
@AL00863 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+20)
@AL00864 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT6)
         DC    A(@AFTEMPS+20)
@AL00934 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+24)
@AL00935 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT6)
         DC    A(@AFTEMPS+24)
@AL00936 DC    A(T24)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT12)
         DC    A(@AFTEMPS+24)
@AL00946 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MAX1)
         DC    A(PRT15)
@AL00948 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MAX2)
         DC    A(PRT42)
@AL00952 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MIN1)
         DC    A(PRT15)
@AL00954 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MIN2)
         DC    A(PRT42)
@AL00958 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MAX3)
         DC    A(PRT42)
@AL00962 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(SV19MIN3)
         DC    A(PRT42)
@AL01008 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+28)
@AL01009 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT6)
         DC    A(@AFTEMPS+28)
@AL01010 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(Y8COUNT)
         DC    A(PRT12)
@AL01011 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL01003 DC    A(Y9COUNT)              LIST WITH   1 ARGUMENT(S)
         DC    A(PRT18)
@AL01012 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT25)
         DC    A(@AFTEMPS+28)
@AL01013 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT32)
         DC    A(@AFTEMPS+28)
@AL01017 DC    A(FIVE)                 LIST WITH   1 ARGUMENT(S)
@AL01075 DC    A(SIX)                  LIST WITH   1 ARGUMENT(S)
@AL01117 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+32)
@AL01118 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL00989 DC    A(Y8COUNT)              LIST WITH   1 ARGUMENT(S)
         DC    A(PRT6)
@AL01119 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL01138 DC    A(FORMAT5)              LIST WITH   1 ARGUMENT(S)
         DC    A(PRT12)
@AL01120 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL01158 DC    A(BUILDF3)              LIST WITH   1 ARGUMENT(S)
         DC    A(PRT18)
@AL01121 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL01180 DC    A(BUILDF4)              LIST WITH   1 ARGUMENT(S)
         DC    A(PRT22)
@AL01122 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
         DC    A(RETURN1)
         DC    A(PRT26)
@AL01123 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT32)
         DC    A(@AFTEMPS+32)
@AL01124 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT39)
         DC    A(@AFTEMPS+32)
@AL01125 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT48)
         DC    A(@AFTEMPS+32)
@AL01126 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT58)
         DC    A(@AFTEMPS+32)
@AL01259 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01264 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01265 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01273 DC    A(@CF00038)             LIST WITH   3 ARGUMENT(S)
@AL01335 DC    A(@CH00081)             LIST WITH   1 ARGUMENT(S)
         DC    A(@AFTEMPS+36)
@AL01281 DC    A(T16)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+40)
@AL01282 DC    A(T16)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT39)
         DC    A(@AFTEMPS+40)
@AL01307 DC    A(@CF01780)             LIST WITH   2 ARGUMENT(S)
         DC    A(PRT0)
@AL01308 DC    A(@CF00079)             LIST WITH   3 ARGUMENT(S)
         DC    A(NOGOOD)
         DC    A(PRT9)
@AL01309 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01317 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT58)
         DC    A(@AFTEMPS+44)
@AL01315 DC    A(@CF01781)             LIST WITH   2 ARGUMENT(S)
         DC    A(PRT0)
@AL01316 DC    A(@CF00079)             LIST WITH   3 ARGUMENT(S)
         DC    A(HRDERROR)
         DC    A(PRT9)
@AL01377 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01381 DC    A(TWO)                  LIST WITH   3 ARGUMENT(S)
         DC    A(@AFTEMPS+48)
         DC    A(@AFTEMPS+52)
@AL01378 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01382 DC    A(@CF00066)             LIST WITH   3 ARGUMENT(S)
@AL01431 DC    A(@CF00075+2)           LIST WITH   1 ARGUMENT(S)
         DC    A(@AFTEMPS+48)
@AL01391 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00537 DC    A(TWO)                  LIST WITH   1 ARGUMENT(S)
         DC    A(@AFTEMPS+56)
         DC    A(@AFTEMPS+60)
@AL01392 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00548 DC    A(THREE)                LIST WITH   1 ARGUMENT(S)
         DC    A(@AFTEMPS+56)
         DC    A(@AFTEMPS+60)
@AL01400 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01404 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01407 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL01411 DC    A(T32)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+64)
@AL01418 DC    A(T31)                  LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+68)
@AL01424 DC    A(ELEVEN)               LIST WITH   3 ARGUMENT(S)
         DC    A(PRT0)
         DC    A(@AFTEMPS+72)
         DS    0F
@SA00001 DS    18F
@SA00044 DS    15F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00043 DS    15F
@SA00007 DS    15F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00005 DS    15F
@SA00021 DS    15F
@SA00024 DS    15F
@SA00026 DS    15F
@SA00035 DS    15F
@SA00041 DS    15F
@PC00041 DS    1F
@SA00037 DS    15F
@PC00037 DS    1F
@SA00039 DS    15F
@PC00039 DS    1F
@SA00008 DS    15F
@SA00009 DS    15F
@SA00010 DS    15F
@SA00011 DS    15F
@PC00045 DS    3F
@SA00014 DS    15F
@SA00020 DS    15F
@SA00015 DS    15F
@SA00016 DS    15F
@SA00046 DS    15F
@PC00046 DS    3F
@SA00022 DS    15F
@SA00023 DS    15F
@PC00025 DS    1F
@SA00027 DS    15F
@SA00033 DS    15F
@SA00029 DS    15F
@SA00028 DS    15F
@SA00030 DS    15F
@SA00031 DS    15F
@PC00031 DS    1F
@SA00034 DS    15F
@SA00042 DS    15F
@SA00040 DS    15F
@AL00001 DS    3A
@TF00001 DS    F
@TF00002 DS    F
@AFTEMPS DS    19F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
         DS    0F
@CF00075 DC    F'2'
@CH00075 EQU   @CF00075+2
@CF00038 DC    F'3'
@CH00038 EQU   @CF00038+2
@CF00066 DC    F'4'
@CH00066 EQU   @CF00066+2
@CF00079 DC    F'5'
@CH00079 EQU   @CF00079+2
@CF01780 DC    F'107'
@CF01781 DC    F'108'
@CF01580 DC    F'109'
@CF01892 DC    F'-56'
@CF01887 DC    F'-54'
@CF01890 DC    F'-53'
@CF01878 DC    F'-35'
@CF01879 DC    F'-33'
@CF01862 DC    F'-31'
@CF01863 DC    F'-29'
@CF01884 DC    F'-28'
@CF01883 DC    F'-25'
@CF01881 DC    F'-24'
@CF01875 DC    F'-23'
@CF01891 DC    F'-22'
@CF01889 DC    F'-21'
@CF01871 DC    F'-20'
@CF01876 DC    F'-18'
@CF01886 DC    F'-15'
@CF01864 DC    F'-14'
@CF01885 DC    F'-12'
@CF01858 DC    F'-11'
@CF01882 DC    F'-10'
@CF01857 DC    F'-9'
@CF01859 DC    F'-8'
@CF01860 DC    F'-7'
@CF01865 DC    F'-6'
@CF01893 DC    F'-5'
@CF01877 DC    F'-4'
@CF01880 DC    F'-3'
@CF01673 DC    XL4'0600'
@CF01675 DC    XL4'0400'
@CF01676 DC    XL4'0500'
@CF01681 DC    XL4'0800'
@CF01734 DC    XL4'000F'
         DS    0D
MOVEPT   DC    A(0)
@TS00001 DS    CL31
@CC01688 DC    C'  0'
@CC01695 DC    C'US-'
@CC01696 DC    C'OS-'
@CB01609 DC    X'000100010001'
@CB00198 DC    X'8000'
@CB00208 DC    X'0000'
@CB01574 DC    X'4000'
@CB01575 DC    X'7FFF'
@CB01591 DC    X'1000'
@CB01592 DC    X'2000'
@CB01597 DC    X'9007'
@CB01598 DC    X'900E'
@CB01599 DC    X'9006'
@CB01600 DC    X'9003'
@CB01601 DC    X'9001'
@CB01602 DC    X'9002'
@CB01627 DC    X'1905'
@CB01628 DC    X'900B'
@CB01629 DC    X'900F'
@CB01630 DC    X'1907'
@CB01631 DC    X'1903'
@CB01632 DC    X'1908'
@CB01633 DC    X'1901'
@CB01653 DC    X'011F'
@CB01654 DC    X'0130'
@CB01655 DC    X'0124'
@CB01656 DC    X'0123'
@CB01657 DC    X'0121'
@CB01658 DC    X'0122'
@CB01664 DC    X'0200'
@CB01673 DC    X'0600'
@CB01674 DC    X'0300'
@CB01675 DC    X'0400'
@CB01676 DC    X'0500'
@CB01680 DC    X'0900'
@CB01681 DC    X'0800'
@CB01682 DC    X'0700'
@CB01683 DC    X'07F1'
@CB01684 DC    X'07F2'
@CB01701 DC    X'0F00'
@CB01706 DC    X'152C'
@CB01707 DC    X'162A'
@CB01708 DC    X'164A'
@CB01709 DC    X'154E'
@CB01710 DC    X'1448'
@CB01711 DC    X'1444'
@CB01729 DC    X'0EEE'
@CB01734 DC    X'000F'
@CB01736 EQU   @CB01609
@CB01737 DC    X'0009'
@CB01738 DC    X'0004'
@CB01739 DC    X'0005'
@CB01740 DC    X'000D'
@CB01751 DC    X'0080'
@CB01755 DC    X'0008'
@CB01774 DC    X'0777'
SHARE2   DC    CL6'SHARED'
CHARS    DC    CL16'0123456789ABCDEF'
PRINTLIN DC    CL134' '
         ORG   PRINTLIN
PRINTDS  DC    X'F0'
PRINTCC  DC    X'09'
PRTLINE  DC    CL132' '
         ORG   PRINTLIN+134
         DS    CL4
@NM00083 DS    CL292
         ORG   @NM00083
@NM00084 DC    CL16'FIXED 15,31 ITEM'
DBLWORD  DS    CL8
WORK     DS    CL8
WORK1    DS    CL8
TOTALEVD DC    H'0'
NUMDONE  DC    H'0'
ADJ      DC    H'0'
T31      DC    H'31'
T32      DC    H'32'
NUMBER2  DC    H'0'
INTABLE  DC    H'0'
MIX      DC    H'0'
SAVEIN   DC    H'0'
Y8COUNT  DC    H'0'
Y9COUNT  DC    H'0'
RETURN1  DC    H'0'
STRING   DC    H'0'
TEMPSP   DC    H'0'
NOGOOD   DC    H'0'
T16      DC    H'16'
HRDERROR DC    H'0'
TEMPSV1  DC    H'0'
TEMPSV   DC    H'0'
BUILDF3  DC    H'0'
BUILDF4  DC    H'0'
BUILDF5  DC    H'0'
FORMAT5  DC    H'0'
R33      DC    H'0'
T24      DC    H'24'
SAVER33  DC    H'0'
THENUMBR DC    H'0'
NONZERO  DC    H'0'
SAVEFOR3 DC    H'0'
SAVEFOR4 DC    H'0'
SAVEFOR5 DC    H'0'
SAVER4   DC    H'0'
SAVER44  DC    H'0'
SAVER444 DC    H'0'
SAVEITEM DC    H'0'
BY22231  DC    X'0000'
BY22232  DC    X'0000'
BYTEMOVE DC    H'0'
@NM00085 DC    CL8'POINTERS'
A        DC    AL2(0)
B        DC    AL2(0)
C        DC    AL2(0)
D        DC    AL2(0)
E        DC    AL2(0)
F        DC    AL2(0)
G        DC    AL2(0)
H        DC    AL2(0)
J        DC    AL2(0)
I        DC    AL2(0)
M        DC    AL2(0)
T        DC    AL2(0)
Z        DC    AL2(0)
@NM00086 DC    CL8'CONSTANT'
ONE      DC    H'1'
TWO      DC    H'2'
THREE    DC    H'3'
FOUR1    DC    H'4'
FIVE     DC    H'5'
SIX      DC    H'6'
SEVEN    DC    H'7'
EIGHT1   DC    H'8'
NINE     DC    H'9'
ELEVEN   DC    H'11'
SV19USE  DS    CL12
         ORG   SV19USE
SV19MAX1 DC    H'-1'
SV19MIN1 DC    H'9999'
SV19MAX2 DC    H'-1'
SV19MIN2 DC    H'9999'
SV19MAX3 DC    H'-1'
SV19MIN3 DC    H'9999'
         ORG   @NM00083+190
SV19RUSE DS    CL12
         ORG   SV19RUSE
SMAX1    DC    H'-1'
SMIN1    DC    H'9999'
SMAX2    DC    H'-1'
SMIN2    DC    H'9999'
SMAX3    DC    H'-1'
SMIN3    DC    H'9999'
         ORG   @NM00083+202
@NM00087 DC    CL4'****'
         DS    CL2
NEXTBY1  DC    A(0)
ADDNXT1  DC    A(0)
SORTAT   DC    A(0)
DSORTAT  DC    A(0)
SAVER5   DC    A(0)
SENSEPTR DC    A(0)
RIGHTEAC DC    AL4(MAINMDC)
GPPOINT  DC    AL4(ALLGROUP)
GPPOINT1 DC    AL4(EVDGROUP)
RIGHTTAB DC    AL4(ALLCOUNT)
RECPTR   DC    F'0'
FOXZERO  DC    X'F0'
BLANK    DC    X'40'
EROREXIT DC    X'00'
BYTES1   DC    X'0000'
SWITCHE  DC    X'00000000'
         ORG   SWITCHE
GRP1Y0   DS    BL1
GRP1Y1   EQU   SWITCHE+0
SWITCH1  EQU   SWITCHE+0
SWITCH2  EQU   SWITCHE+0
SWITCH3  EQU   SWITCHE+0
SWITCH4  EQU   SWITCHE+0
SWITCH5  EQU   SWITCHE+0
SWITCH6  EQU   SWITCHE+0
PRINTFLG DS    BL1
F4FLAG   EQU   SWITCHE+1
ERROR    EQU   SWITCHE+1
OK       EQU   SWITCHE+1
         ORG   @NM00083+261
GP5SWIT  DS    CL2
         ORG   GP5SWIT
BYTE5ALL DS    BL1
BYTE5FLG EQU   GP5SWIT+0
BYT5FAIL EQU   GP5SWIT+0
INTERGAL EQU   GP5SWIT+0
         ORG   @NM00083+263
SAVESWIT DS    CL2
GP1SWIT  DS    CL2
         ORG   GP1SWIT
F9006    DS    BL1
F9003    EQU   GP1SWIT+0
F9001    EQU   GP1SWIT+0
F9006F   EQU   GP1SWIT+0
F9003F   EQU   GP1SWIT+0
F9001F   EQU   GP1SWIT+0
         ORG   @NM00083+267
DCFLAGS  DC    X'0000'
         ORG   DCFLAGS
MISMATCH DS    BL1
         ORG   @NM00083+269
DCFLAGS1 DC    X'0000'
         ORG   DCFLAGS1
GR11     DS    BL1
LS12     EQU   DCFLAGS1+0
FIVEUNEQ EQU   DCFLAGS1+0
SIXUNEQ  EQU   DCFLAGS1+0
T3TO6    EQU   DCFLAGS1+0
D24NOTEQ EQU   DCFLAGS1+0
         ORG   @NM00083+271
DCFLAGS2 DC    X'0000'
DCFLAGS3 DC    X'0000'
SCFLAG   DC    X'0000'
         ORG   SCFLAG
SCFLAG1  DS    BL1
SCFLAG2  EQU   SCFLAG+0
SCFLAG3  EQU   SCFLAG+0
         ORG   @NM00083+277
BLDFLAG  DC    X'0000'
         ORG   BLDFLAG
F4949    DS    BL1
         ORG   @NM00083+279
SVFLAGS  DC    X'0000'
         ORG   SVFLAGS
INTERDIF DS    BL1
MIXISMIX EQU   SVFLAGS+0
DIFFINTR EQU   SVFLAGS+0
MIXMORE2 EQU   SVFLAGS+0
MIXLESS3 EQU   SVFLAGS+0
DIFSB10R EQU   SVFLAGS+0
REMAINDF EQU   SVFLAGS+0
PAIRMIX  EQU   SVFLAGS+0
         ORG   @NM00083+281
BYTESEQF DS    CL4
         ORG   BYTESEQF
BIT4EQ7  DS    BL1
MIXOVRUN EQU   BYTESEQF+0
OVERANY  EQU   BYTESEQF+0
UNDERSUM EQU   BYTESEQF+0
GRTHANFF EQU   BYTESEQF+0
SUMS     EQU   BYTESEQF+0
TSUM     EQU   BYTESEQF+0
SB89NOTZ EQU   BYTESEQF+0
TOTALCM  DS    BL1
RANDOM   EQU   BYTESEQF+1
BY89ZERO EQU   BYTESEQF+1
DIFFLESS EQU   BYTESEQF+1
SUMS1    EQU   BYTESEQF+1
RANDOM3  EQU   BYTESEQF+1
RANDOM4  EQU   BYTESEQF+1
RANDOM5  EQU   BYTESEQF+1
GRTHNFF3 DS    BL1
GRTHNFF4 EQU   BYTESEQF+2
GRTHNFF5 EQU   BYTESEQF+2
         ORG   @NM00083+285
OVERFLAG DS    CL5
         ORG   OVERFLAG
KEEPDIFF DS    BL1
MIXBITS  EQU   OVERFLAG+0
DIFFSIG  EQU   OVERFLAG+0
SIGMATCH EQU   OVERFLAG+0
SETDIFF  EQU   OVERFLAG+0
MIXOVER  EQU   OVERFLAG+0
SB34M89  EQU   OVERFLAG+0
         ORG   @NM00083+290
FAULT    DC    X'0000'
         ORG   FAULT
FAULT2   DS    CL1
@NM00088 DS    CL1
         ORG   @NM00088
SB0      DS    BL1
SB1      EQU   @NM00088+0
SB2      EQU   @NM00088+0
SB3      EQU   @NM00088+0
SB4      EQU   @NM00088+0
SB5      EQU   @NM00088+0
SB6      EQU   @NM00088+0
SB7      EQU   @NM00088+0
         ORG   @NM00083+292
ALLGROUP DS    CL12
         ORG   ALLGROUP
GRP1     DC    H'0'
GRP2     DC    H'0'
GRP3     DC    H'0'
GRP4     DC    H'0'
GRP5     DC    H'0'
GRP6     DC    H'0'
         ORG   ALLGROUP+12
EVDGROUP DS    CL12
         ORG   EVDGROUP
EVDGRP1  DC    H'0'
EVDGRP2  DC    H'0'
EVDGRP3  DC    H'0'
EVDGRP4  DC    H'0'
EVDGRP5  DC    H'0'
EVDGRP6  DC    H'0'
         ORG   EVDGROUP+12
SB345SV  DS    CL9
         ORG   SB345SV
F9006SV  DC    X'000000'
         ORG   F9006SV
F9006SV1 DS    CL1
F9006SV2 DS    CL1
F9006SV3 DS    CL1
         ORG   SB345SV+3
F9003SV  DC    X'000000'
         ORG   F9003SV
F9003SV1 DS    CL1
F9003SV2 DS    CL1
F9003SV3 DS    CL1
         ORG   SB345SV+6
F9001SV  DC    X'000000'
         ORG   F9001SV
F9001SV1 DS    CL1
F9001SV2 DS    CL1
F9001SV3 DS    CL1
         ORG   SB345SV+9
KEEPCUA  DC    X'0000'
BYTE     DS    CL2
         ORG   BYTE
Y0       DS    BL1
Y1       EQU   BYTE+0
Y2       EQU   BYTE+0
Y3       EQU   BYTE+0
Y4       EQU   BYTE+0
Y5       EQU   BYTE+0
Y6       EQU   BYTE+0
Y7       EQU   BYTE+0
Y8       DS    BL1
Y9       EQU   BYTE+1
YA       EQU   BYTE+1
YB       EQU   BYTE+1
YC       EQU   BYTE+1
YD       EQU   BYTE+1
YE       EQU   BYTE+1
YF       EQU   BYTE+1
         ORG   BYTE+2
ANALTEXT DC    CL256' '
         DC    CL256' '
         DC    CL248' '
         ORG   ANALTEXT
MAINLINE DS    CL57
         ORG   MAINLINE
@NM00090 DS    CL11
@NM00091 DC    CL42'MAINTENANCE DEVICE CODE FOR DEVICE TYPE = '
@NM00092 DC    CL4'3370'
         ORG   ANALTEXT+57
MAINLIN1 DS    CL58
         ORG   MAINLIN1
@NM00093 DC    CL24'       DEVICE ADDRESS = '
CUALABEL DC    CL4'    '
@NM00094 DS    CL2
MLABEL   DS    CL6
@NM00095 DC    CL16'      SERIAL = '
SERIAL   DS    CL6
         ORG   ANALTEXT+115
DCILINE  DS    CL160
         ORG   DCILINE
DCIMOD1  DC    CL80'SELECTION: TAG  BUS  BUS  IMMEDIATE:  TAG  BUS  BUSC
                    EXTENDED:  TAG BUS  BUS'
DCIMOD2  DC    CL80'                OUT  IN                    OUT  IN C
                                   OUT  IN'
         ORG   ANALTEXT+275
SVLINE   DC    CL11'MODIFER(S):'
SVMOD1   DC    CL80'  EXPECTED       ACTUAL         ACCESS     EVEN   OC
               VER/  DIFFERENCE CT'
SVMOD2   DC    CL80'  DESTINATION    DESTINATION    DIRECTION  TRACK  UC
               NDER  REMAINDER'
SVMOD3   DC    CL80'  CCC-HH-M/F-SM  CCC-HH-M/F-SM     F/R      E/O   OC
               S/US  DIFF    '
SCLINE   DS    CL174
         ORG   SCLINE
SCMOD1   DC    CL50'  SEEK LOSS OF READY ERRORS  SEEK SETTLING ERRORS'
SCMXD2   DC    CL46'  MAX OFFSET = N/A           MAX OFFSET = N/A'
SCMXD3   DC    CL46'  MIN OFFSET = N/A           MIN OFFSET = N/A'
SCMOD2   DC    CL16'MAX DIFF   = N/A'
SCMOD3   DC    CL16'MIN DIFF   = N/A'
         ORG   ANALTEXT+700
PRIMEHD  DS    CL60
         ORG   PRIMEHD
PRIME1   DS    CL60
         ORG   PRIME1
@NM00096 DC    CL20'     MD CODE TYPE = '
TYPES    DS    CL5
         ORG   TYPES
TYPE     DS    CL4
         ORG   TYPE
@NM00097 DS    CL3
TYPEE    DS    CL1
         ORG   PRIME1+25
@NM00098 DC    CL5' MDC='
EACVAL   DS    CL4
@NM00099 DC    CL9' SAMPLES='
SAMPLE1  DC    CL4'    '
         ORG   ANALTEXT+760
DCLINE   DC    CL80' ECC CORRECTABLE           UNCORRECTABLE           C
                  NO SYNC BYTE FOUND  '
         DS    CL3
CONST    DS    CL84
         ORG   CONST
PRT0     DC    AL4(PRTLINE)
PRT6     DC    AL4(PRTLINE+6)
PRT9     DC    AL4(PRTLINE+9)
PRT12    DC    AL4(PRTLINE+12)
PRT15    DC    AL4(PRTLINE+15)
PRT17    DC    AL4(PRTLINE+17)
PRT18    DC    AL4(PRTLINE+18)
PRT21    DC    AL4(PRTLINE+21)
PRT22    DC    AL4(PRTLINE+22)
PRT25    DC    AL4(PRTLINE+25)
PRT26    DC    AL4(PRTLINE+26)
PRT32    DC    AL4(PRTLINE+32)
PRT39    DC    AL4(PRTLINE+39)
PRT42    DC    AL4(PRTLINE+42)
PRT44    DC    AL4(PRTLINE+44)
PRT46    DC    AL4(PRTLINE+46)
PRT48    DC    AL4(PRTLINE+48)
PRT58    DC    AL4(PRTLINE+58)
PRT68    DC    AL4(PRTLINE+68)
PRT72    DC    AL4(PRTLINE+72)
PRT77    DC    AL4(PRTLINE+76)
         ORG   CONST+84
ALLEQUAL DC    CL41'EVD BIT SET IN ALL RECORD(S) FOR THIS CUA'
SUPERZAP DC    3CL10'SUPERZAP'
         DS    CL1
PATCH    DC    10F'0'
MAINMDC  DC    192X'0000'
ALLCOUNT DC    192H'0'
SAVE5A   DC    3H'0'
SAVE34A  DC    3H'0'
SAVE6A   DC    3H'0'
EVDCOUNT DC    192H'0'
SPGROUP6 DC    32H'0'
EVDSPGP6 DC    32H'0'
EVDMDC   DC    192X'8000'
SIGBIT   DC    H'1'
         DC    H'2'
         DC    H'4'
         DC    H'8'
         DC    H'16'
         DC    H'32'
         DC    H'64'
         DC    H'128'
         DC    H'256'
         DC    H'512'
PHYHEAD  DC    X'00'
         DC    X'0C'
         DC    X'18'
         DC    X'24'
         DC    X'01'
         DC    X'0D'
         DC    X'19'
         DC    X'25'
         DC    X'02'
         DC    X'0E'
         DC    X'1A'
         DC    X'26'
         DC    X'03'
         DC    X'0F'
         DC    X'1B'
         DC    X'27'
         DC    X'08'
         DC    X'14'
         DC    X'20'
         DC    X'2C'
         DC    X'09'
         DC    X'15'
         DC    X'21'
         DC    X'2D'
         DC    X'0A'
         DC    X'16'
         DC    X'22'
         DC    X'2E'
         DC    X'0B'
         DC    X'17'
         DC    X'23'
         DC    X'2F'
HEADLINE DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'02'
         DC    X'02'
         DC    X'02'
         DC    X'02'
         DC    X'03'
         DC    X'03'
         DC    X'03'
         DC    X'03'
         DC    X'04'
         DC    X'04'
         DC    X'04'
         DC    X'04'
         DC    X'05'
         DC    X'05'
         DC    X'05'
         DC    X'05'
         DC    X'06'
         DC    X'06'
         DC    X'06'
         DC    X'06'
         DC    X'07'
         DC    X'07'
         DC    X'07'
         DC    X'07'
         DC    X'08'
         DC    X'08'
         DC    X'08'
         DC    X'08'
PHYBLOCK DC    X'00'
         DC    X'05'
         DC    X'0A'
         DC    X'01'
         DC    X'06'
         DC    X'0B'
         DC    X'02'
         DC    X'07'
         DC    X'0C'
         DC    X'03'
         DC    X'08'
         DC    X'0D'
         DC    X'31'
         DC    X'36'
         DC    X'3B'
         DC    X'32'
         DC    X'37'
         DC    X'3C'
         DC    X'33'
         DC    X'38'
         DC    X'3D'
         DC    X'34'
         DC    X'39'
         DC    X'3E'
BLKLINE  DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'02'
         DC    X'02'
         DC    X'02'
         DC    X'03'
         DC    X'03'
         DC    X'03'
         DC    X'04'
         DC    X'04'
         DC    X'04'
         DC    X'05'
         DC    X'05'
         DC    X'05'
         DC    X'06'
         DC    X'06'
         DC    X'06'
         DC    X'07'
         DC    X'07'
         DC    X'07'
         DC    X'08'
         DC    X'08'
         DC    X'08'
STRINGS  DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'01'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'09'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'11'
         DC    X'19'
         DC    X'19'
         DC    X'19'
         DC    X'19'
         DC    X'19'
         DC    X'19'
         DC    X'19'
         DC    X'19'
LIN1     DC    CL25'                         '
         DC    CL25'                         '
         DC    CL25'CCC = N/A HH =N/A BB =N/A'
         DC    CL25'CCC = N/A HH =N/A BB =N/A'
         DC    CL25'HH = N/A                 '
         DC    CL25'HH = N/A                 '
         DC    CL25'MM = N/A                 '
         DC    CL25'MM = N/A                 '
COMPTAB  DS    3H
MOVETAB  DC    AL4(PRTLINE)
         DC    AL4(PRTLINE+27)
         DC    AL4(PRTLINE+54)
DCLINE2  DC    CL22'     N/A        '
         DC    CL22'     N/A        '
         DC    CL22'PRIME DATA BLOCK '
         DC    CL22'ALTERNATE DATA BLOCK'
         DC    CL22'DEFECTIVE R/W HEAD'
         DC    CL22'DEFECTIVE R/W HEAD'
         DC    CL22'AE SELECT MODULE'
         DC    CL22'AE SELECT MODULE'
ADJADDR  DC    H'2'
         DC    H'1'
         DC    H'4'
         DC    H'3'
         DC    H'6'
         DC    H'5'
         DC    H'8'
         DC    H'7'
         DC    H'10'
         DC    H'9'
         DC    H'12'
         DC    H'11'
         DC    H'14'
         DC    H'13'
         DC    H'16'
         DC    H'15'
         DC    H'18'
         DC    H'17'
         DC    H'20'
         DC    H'19'
         DC    H'22'
         DC    H'21'
         DC    H'24'
         DC    H'23'
         DC    H'26'
         DC    H'25'
         DC    H'28'
         DC    H'27'
         DC    H'30'
         DC    H'29'
         DC    H'32'
         DC    H'31'
TYPE1    DC    CL4' DCI'
         DC    CL4' FCI'
         DC    CL4' SV '
         DC    CL4' SC '
         DC    CL4' RW '
         DC    CL4' DC '
IFCNFPDR CSECT
         DC    S(SUPERZAP)
IFCNFPDR CSECT
         DC S(PATCH)              ESTABLISH ADDRESSABILITY
IFCNFPDR CSECT
MVCDATA  MVC  R0(R0,R6),0(R4)    MOVE THE CONVERTED VALUE
IFCNFPDR CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
R2       EQU   @02
R4       EQU   @04
R0       EQU   @00
R1       EQU   @01
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
R15      EQU   @15
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R3       EQU   @03
R8       EQU   @08
R9       EQU   @09
IOHND    EQU   0
IFCMSG   EQU   0
PARM     EQU   0
RECTYPE  EQU   PARM
SWITCHES EQU   PARM+2
COREFAIL EQU   SWITCHES+1
DEBUG    EQU   PARM+4
DEBUGA   EQU   PARM+8
DEBUG55  EQU   DEBUGA+2
DEBUG56  EQU   DEBUGA+3
DEBUG60  EQU   DEBUGA+3
DEBUG61  EQU   DEBUGA+3
DEBUG63  EQU   DEBUGA+3
MISC     EQU   PARM+12
PRINTES  EQU   MISC
OPENCLSE EQU   PARM+13
OPENIO   EQU   OPENCLSE
CLOSEIO  EQU   OPENCLSE+2
DATENOW  EQU   PARM+17
STDT     EQU   PARM+23
STDATE   EQU   STDT
PSTD     EQU   STDATE+1
ENDDT    EQU   PARM+31
ENDDATE  EQU   ENDDT
PEND     EQU   ENDDATE+1
STTIME1  EQU   PARM+39
ENDTIME1 EQU   PARM+43
STTIME2  EQU   PARM+47
ENDTIME2 EQU   PARM+51
STRTDATE EQU   PARM+55
RDTHRSH  EQU   PARM+66
@NM00006 EQU   PARM+72
@NM00007 EQU   PARM+75
ERRID    EQU   PARM+92
IDTIMEA  EQU   ERRID+6
IDTIME   EQU   IDTIMEA
CCHHRLNG EQU   PARM+112
RECCCHHR EQU   CCHHRLNG
ADIOHND  EQU   PARM+124
ADIFCMSG EQU   PARM+128
ADEDITB  EQU   PARM+132
EVPTR    EQU   PARM+136
SORTADR  EQU   PARM+140
PRINTADR EQU   PARM+148
CUAPTR   EQU   PARM+152
DEVPTR   EQU   PARM+156
MODPTR   EQU   PARM+160
SERPTR   EQU   PARM+164
VOLPTR   EQU   PARM+168
CPUPTR   EQU   PARM+172
CPCUAPTR EQU   PARM+176
LIBADPTR EQU   PARM+180
SYMCDPTR EQU   PARM+184
SYSUMPTR EQU   PARM+188
TRENPTR  EQU   PARM+192
SHAREPTR EQU   PARM+196
MERDCPTR EQU   PARM+208
DUMPTABL EQU   PARM+228
DUMPINFO EQU   DUMPTABL+4
TRENDONE EQU   0
TREGEN   EQU   TRENDONE+8
TRECCH0  EQU   TREGEN+8
TREND2   EQU   0
TRENDKEY EQU   TREND2
TRENDRT  EQU   TRENDKEY+1
TRENCPUS EQU   TRENDKEY+3
TRENDITM EQU   TRENDKEY+4
EVTABLE  EQU   0
EVSTOP   EQU   EVTABLE
EVKEY    EQU   EVTABLE+6
SORTABLE EQU   0
SORTKEY  EQU   SORTABLE
SORTCCHR EQU   SORTABLE+5
SYSUMONE EQU   0
SYSUM2   EQU   0
SYSUMKEY EQU   SYSUM2
SYSRT    EQU   SYSUMKEY+1
SYSCPUS  EQU   SYSUMKEY+3
SYSITEM  EQU   SYSUMKEY+4
SHARE    EQU   0
SHAREIO  EQU   SHARE+2
SHRBASE  EQU   SHAREIO+1
SHRCUCPU EQU   SHAREIO+8
EDITLOAD EQU   0
EDITABLE EQU   EDITLOAD+4
CUA      EQU   0
CUAVAL   EQU   CUA+2
DEVICE   EQU   0
MODELS   EQU   0
DEVSERAL EQU   0
VOLUME   EQU   0
CPUS     EQU   0
CPUCUAS  EQU   0
CPUCUAV  EQU   CPUCUAS+2
LIBADR   EQU   0
SYMCODE  EQU   0
SYMVAL   EQU   SYMCODE+2
MERIDIAN EQU   0
LRTREC   EQU   0
LRTKEY   EQU   LRTREC
LRTSMS   EQU   LRTREC+2
LRTERRID EQU   LRTREC+3
@NM00016 EQU   LRTREC+4
LRTDT    EQU   LRTREC+8
LRTDATE  EQU   LRTDT
LRTYRDAY EQU   LRTDATE+1
LRTTIME  EQU   LRTDT+4
LRTCPU   EQU   LRTREC+16
LRTCPMOD EQU   LRTCPU+1
MCHREC   EQU   0
MCHHEAD  EQU   MCHREC
MCHKEY   EQU   MCHHEAD
MCHSMS   EQU   MCHHEAD+2
MCHCPUID EQU   MCHHEAD+16
CCHREC   EQU   0
CCHHEAD  EQU   CCHREC
CCHKEY   EQU   CCHHEAD
CCHSMS   EQU   CCHHEAD+2
CCHCPUID EQU   CCHHEAD+16
CCHCODE  EQU   CCHREC+68
CCHCODE2 EQU   CCHCODE+2
OBRREC   EQU   0
OBRHEAD  EQU   OBRREC
OBRKEY   EQU   OBRHEAD
OBRSMS   EQU   OBRHEAD+2
MISCSW   EQU   OBRSMS
OBRSUBTP EQU   OBRSMS+1
OBRCPUID EQU   OBRHEAD+16
OBRJOBID EQU   OBRREC+24
OBRFCCW  EQU   OBRREC+32
OBRSRDS  EQU   OBRFCCW
OBRCSW   EQU   OBRREC+40
OBRDEVDC EQU   OBRREC+48
OBRCODE  EQU   OBRREC+52
OBRDEV   EQU   OBRCODE+2
OBRLSDRC EQU   OBRREC+56
OBRVOL   EQU   OBRREC+64
OBRSEEK  EQU   OBRREC+70
OBRTERMN EQU   OBRSEEK+2
SFTREC   EQU   0
SFTHEAD  EQU   SFTREC
SFTKEY   EQU   SFTHEAD
SFTCPUID EQU   SFTHEAD+16
SFTSDWA  EQU   SFTREC+32
SFTAEC1  EQU   SFTSDWA+96
SFTFLGS  EQU   SFTSDWA+232
SFTRECP  EQU   SFTSDWA+292
IPLREC   EQU   0
IPLHEAD  EQU   IPLREC
IPLKEY   EQU   IPLHEAD
IPLCPUID EQU   IPLHEAD+16
IPLSTIME EQU   IPLREC+52
DDRREC   EQU   0
DDRHEAD  EQU   DDRREC
DDRKEY   EQU   DDRHEAD
DDRSMS   EQU   DDRHEAD+2
DDRCPUID EQU   DDRHEAD+16
@NM00051 EQU   DDRREC+24
DDRFDEV  EQU   DDRREC+48
DDRCODE2 EQU   DDRFDEV+2
DDRTODEV EQU   DDRREC+56
MIHREC   EQU   0
MIHHEAD  EQU   MIHREC
MIHKEY   EQU   MIHHEAD
@NM00053 EQU   MIHHEAD+4
MIHCPUID EQU   MIHHEAD+16
@NM00056 EQU   MIHREC+24
MIHDEV   EQU   MIHREC+44
MIHCODE2 EQU   MIHDEV+2
EODREC   EQU   0
EODHEAD  EQU   EODREC
EODKEY   EQU   EODHEAD
EODCPUID EQU   EODHEAD+16
TPRREC   EQU   0
TPRHEAD  EQU   TPRREC
TPRKEY   EQU   TPRHEAD
TPRBUFC  EQU   TPRHEAD+5
TPRCPUID EQU   TPRHEAD+16
@NM00064 EQU   TPRREC+26
MCFREC   EQU   0
MCFHEAD  EQU   MCFREC
MCFKEY   EQU   MCFHEAD
MCFSMS   EQU   MCFHEAD+2
@NM00072 EQU   MCFHEAD+16
MCFSMO   EQU   MCFHEAD+17
CCFREC   EQU   0
CCFHEAD  EQU   CCFREC
CCFKEY   EQU   CCFHEAD
CCFSMS   EQU   CCFHEAD+2
@NM00080 EQU   CCFHEAD+16
CCFSMO   EQU   CCFHEAD+17
SORTTAB  EQU   0
SORTKEYZ EQU   SORTTAB
CUAGP    EQU   SORTKEYZ
CUA3     EQU   CUAGP
GROUP    EQU   CUAGP+2
SWTCH    EQU   SORTKEYZ+3
EVD      EQU   SWTCH
EQUAL    EQU   SWTCH
FORMAT4  EQU   SWTCH
FSCTAB   EQU   SORTTAB+4
FSC1     EQU   FSCTAB
RECLOC   EQU   SORTTAB+6
ADDNUM   EQU   0
NEXTBYTE EQU   0
CUAGPAY  EQU   0
EACSET   EQU   0
GRPCNT1  EQU   0
GRPCNT2  EQU   0
ALLSENSE EQU   0
SORTALL  EQU   ALLSENSE
CUAP     EQU   SORTALL
SWITCH   EQU   SORTALL+2
SHAREON  EQU   SWITCH
BYTES    EQU   ALLSENSE+3
SAVE0304 EQU   BYTES
BYTE3TO6 EQU   BYTES+3
BYTE0304 EQU   BYTE3TO6
BYTE4    EQU   BYTE0304+1
BIT47    EQU   BYTE4
BYTE5    EQU   BYTE3TO6+2
BYTE6    EQU   BYTE3TO6+3
BYTE7    EQU   BYTES+7
BYTE0810 EQU   BYTES+8
BYTE0809 EQU   BYTE0810
BYTE10   EQU   BYTE0810+2
BYTE13   EQU   BYTES+13
BIT130   EQU   BYTE13
BIT134   EQU   BYTE13
BIT135   EQU   BYTE13
BIT136   EQU   BYTE13
BIT137   EQU   BYTE13
BYTE14   EQU   BYTES+14
BIT141   EQU   BYTE14
BIT145   EQU   BYTE14
BIT146   EQU   BYTE14
BIT147   EQU   BYTE14
BYTE16   EQU   BYTES+16
BIT161   EQU   BYTE16
BIT162   EQU   BYTE16
BYTE17   EQU   BYTES+17
BIT172   EQU   BYTE17
BIT173   EQU   BYTE17
BIT174   EQU   BYTE17
BYTE18   EQU   BYTES+18
BIT180   EQU   BYTE18
BIT181   EQU   BYTE18
BIT182   EQU   BYTE18
BYTE19   EQU   BYTES+19
BYTE2223 EQU   BYTES+22
DIVIDE24 EQU   ALLSENSE+27
DIVIDE25 EQU   ALLSENSE+28
DIVIDE26 EQU   ALLSENSE+29
DIVIDE27 EQU   ALLSENSE+30
OBRSENSE EQU   0
MOVECHR  EQU   0
MOVECHR1 EQU   0
ADDNXT   EQU   0
NEXTBY   EQU   0
Y8TOYF   EQU   0
NUMIN    EQU   0
NUMTODO1 EQU   0
FROMWHOM EQU   0
OPTION   EQU   0
NUMBER   EQU   0
BNDECNUM EQU   0
BINWORD  EQU   0
DECADDR  EQU   0
WORKOVER EQU   WORK
CHAR1    EQU   CHARS
SETTO1   EQU   F
CLEARALL EQU   BUILDF3
BUILDFLG EQU   DCFLAGS1
Y8Y9ZERO EQU   Y8COUNT
SVZERO   EQU   SVFLAGS
SVZERO1  EQU   SAVER33
SCMOD1D  EQU   PRTLINE
SCMOD2D  EQU   PRTLINE+29
SCMOD3D  EQU   PRTLINE+29
DCLINED  EQU   PRTLINE
SVMOD3D  EQU   PRTLINE
SVMOD2D  EQU   PRTLINE
SVMOD1D  EQU   PRTLINE
SCMXD2D  EQU   PRTLINE
SCMXD3D  EQU   PRTLINE
SVLINED  EQU   PRTLINE
DCIMOD1D EQU   PRTLINE
DCIMOD2D EQU   PRTLINE
MAINLIND EQU   PRTLINE
MAINLINF EQU   PRTLINE
MAINLING EQU   PRTLINE+30
DCPRINT  EQU   PRTLINE
MOVEEAC1 EQU   PRTLINE
DCMOD3   EQU   PRTLINE
SVMODIF  EQU   PRTLINE
CCC      EQU   SVMODIF+2
HH       EQU   SVMODIF+6
MF       EQU   SVMODIF+10
SS       EQU   SVMODIF+13
CCC1     EQU   SVMODIF+17
HH1      EQU   SVMODIF+21
MF1      EQU   SVMODIF+25
SS1      EQU   SVMODIF+28
FR       EQU   SVMODIF+36
EO       EQU   SVMODIF+45
OS       EQU   SVMODIF+50
OS1      EQU   SVMODIF+53
DIFFCT   EQU   SVMODIF+58
DCLINED1 EQU   PRTLINE
DCPRT1   EQU   PRTLINE
DCPRT2   EQU   PRTLINE+26
DCPRT3   EQU   PRTLINE+53
SHARE1   EQU   MLABEL
TRECCH   EQU   TRECCH0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00116 EQU   SVMODIF+56
@NM00115 EQU   SVMODIF+46
@NM00114 EQU   SVMODIF+37
@NM00113 EQU   SVMODIF+29
@NM00112 EQU   SVMODIF+26
@NM00111 EQU   SVMODIF+23
@NM00110 EQU   SVMODIF+20
@NM00109 EQU   SVMODIF+14
@NM00108 EQU   SVMODIF+11
@NM00107 EQU   SVMODIF+8
@NM00106 EQU   SVMODIF+5
@NM00105 EQU   SVMODIF
DCMOD322 EQU   DCMOD3+19
@NM00104 EQU   DCMOD3+15
DCMOD321 EQU   DCMOD3+13
@NM00103 EQU   DCMOD3+9
DCMOD399 EQU   DCMOD3+6
@NM00102 EQU   DCMOD3
DC3      EQU   DCPRINT+52
@NM00101 EQU   DCPRINT+48
DC2      EQU   DCPRINT+26
@NM00100 EQU   DCPRINT+22
DC1      EQU   DCPRINT
BYTE23   EQU   BYTE2223+1
BYTE22   EQU   BYTE2223
BYTE21   EQU   BYTES+21
BYTE20   EQU   BYTES+20
BIT197   EQU   BYTE19
BIT196   EQU   BYTE19
BIT195   EQU   BYTE19
BIT194   EQU   BYTE19
BIT193   EQU   BYTE19
BIT192   EQU   BYTE19
BIT191   EQU   BYTE19
BIT190   EQU   BYTE19
BIT187   EQU   BYTE18
BIT186   EQU   BYTE18
BIT185   EQU   BYTE18
BIT184   EQU   BYTE18
BIT183   EQU   BYTE18
BIT177   EQU   BYTE17
BIT176   EQU   BYTE17
BIT175   EQU   BYTE17
BIT171   EQU   BYTE17
BIT170   EQU   BYTE17
BIT167   EQU   BYTE16
BIT166   EQU   BYTE16
BIT165   EQU   BYTE16
BIT164   EQU   BYTE16
BIT163   EQU   BYTE16
BIT160   EQU   BYTE16
BYTE15   EQU   BYTES+15
BIT144   EQU   BYTE14
BIT143   EQU   BYTE14
BIT142   EQU   BYTE14
BIT140   EQU   BYTE14
BIT133   EQU   BYTE13
BIT132   EQU   BYTE13
BIT131   EQU   BYTE13
BYTE12   EQU   BYTES+12
BYTE11   EQU   BYTES+11
BYTE9    EQU   BYTE0809+1
BYTE8    EQU   BYTE0809
BIT46    EQU   BYTE4
BIT45    EQU   BYTE4
BIT44    EQU   BYTE4
BIT43    EQU   BYTE4
BIT42    EQU   BYTE4
BIT41    EQU   BYTE4
BIT40    EQU   BYTE4
BYTE3    EQU   BYTE0304
BYTE2    EQU   BYTES+2
BYTE1    EQU   SAVE0304+1
BYTE0    EQU   SAVE0304
@NM00089 EQU   SWITCH
CONTROL  EQU   SWITCH
EVDON    EQU   SWITCH
FSC2     EQU   FSCTAB+1
SHARED   EQU   SWTCH
CCFFRAME EQU   CCFREC+24
@NM00082 EQU   CCFHEAD+22
CCFMOD   EQU   CCFSMO+3
CCFSER   EQU   CCFSMO
CCFVER   EQU   @NM00080
@NM00081 EQU   @NM00080
CCFTIMD  EQU   CCFHEAD+12
CCFDAT   EQU   CCFHEAD+8
@NM00079 EQU   CCFHEAD+7
CCFCNT   EQU   CCFHEAD+6
@NM00078 EQU   CCFHEAD+4
@NM00077 EQU   CCFSMS+1
CCFCPU   EQU   CCFSMS+1
CCFMP    EQU   CCFSMS+1
@NM00076 EQU   CCFSMS
CCFTIM   EQU   CCFSMS
@NM00075 EQU   CCFSMS
CCFTRU   EQU   CCFSMS
CCFTOD   EQU   CCFSMS
CCFLST   EQU   CCFSMS
CCFKEY2  EQU   CCFKEY+1
CCFKEY1  EQU   CCFKEY
MCFFRAME EQU   MCFREC+24
@NM00074 EQU   MCFHEAD+22
MCFMOD   EQU   MCFSMO+3
MCFSER   EQU   MCFSMO
MCFVER   EQU   @NM00072
@NM00073 EQU   @NM00072
MCFTIMD  EQU   MCFHEAD+12
MCFDAT   EQU   MCFHEAD+8
@NM00071 EQU   MCFHEAD+7
MCFCNT   EQU   MCFHEAD+6
@NM00070 EQU   MCFHEAD+4
@NM00069 EQU   MCFSMS+1
MCFCPU   EQU   MCFSMS+1
MCFMP    EQU   MCFSMS+1
@NM00068 EQU   MCFSMS
MCFTIM   EQU   MCFSMS
@NM00067 EQU   MCFSMS
MCFTRU   EQU   MCFSMS
MCFTOD   EQU   MCFSMS
MCFLST   EQU   MCFSMS
MCFKEY2  EQU   MCFKEY+1
MCFKEY1  EQU   MCFKEY
RMSSCBRY EQU   TPRREC+58
DVBSDRE  EQU   TPRREC+56
@NM00066 EQU   TPRREC+39
TPRMODE  EQU   TPRREC+38
TPRLINAD EQU   TPRREC+36
@NM00065 EQU   TPRREC+34
TPRVOL   EQU   @NM00064
TPRCUA   EQU   TPRREC+24
TPRCEL   EQU   TPRCPUID+6
TPRMODEL EQU   TPRCPUID+4
TPRSER   EQU   TPRCPUID+1
@NM00063 EQU   TPRCPUID
TPRTIME  EQU   TPRHEAD+12
TPRDATE  EQU   TPRHEAD+8
@NM00062 EQU   TPRHEAD+6
TPRLENGT EQU   TPRBUFC
@NM00061 EQU   TPRBUFC
TPRDEV   EQU   TPRHEAD+4
TPRSMS   EQU   TPRHEAD+2
TPRKEY2  EQU   TPRKEY+1
TPRKEY1  EQU   TPRKEY
EODCEL   EQU   EODCPUID+6
EODMODEL EQU   EODCPUID+4
EODSER   EQU   EODCPUID+1
@NM00060 EQU   EODCPUID
EODTIME  EQU   EODHEAD+12
EODDATE  EQU   EODHEAD+8
@NM00059 EQU   EODHEAD+5
EODDEV   EQU   EODHEAD+4
EODSMS   EQU   EODHEAD+2
EODKEY2  EQU   EODKEY+1
EODKEY1  EQU   EODKEY
MIHTYPE  EQU   MIHCODE2+1
MIHCLASS EQU   MIHCODE2
@NM00058 EQU   MIHDEV
MIHVOL   EQU   MIHREC+38
MIHCUA   EQU   MIHREC+35
@NM00057 EQU   @NM00056+8
MIHJOBID EQU   @NM00056
MIHCEL   EQU   MIHCPUID+6
MIHMOD   EQU   MIHCPUID+4
MIHSER   EQU   MIHCPUID+1
@NM00055 EQU   MIHCPUID
MIHTIME  EQU   MIHHEAD+12
MIHDATE  EQU   MIHHEAD+8
@NM00054 EQU   MIHHEAD+6
MIHCSID  EQU   MIHHEAD+5
MIHDEBIT EQU   @NM00053
MIHCEBIT EQU   @NM00053
MIHSMS   EQU   MIHHEAD+2
MIHKEY2  EQU   MIHKEY+1
MIHKEY1  EQU   MIHKEY
DDRDEV2  EQU   DDRTODEV+2
DDRDEV1  EQU   DDRTODEV
DDRTOCUA EQU   DDRREC+53
@NM00052 EQU   DDRREC+52
DDRTYPE  EQU   DDRCODE2+1
DDRCLASS EQU   DDRCODE2
DDRCODE1 EQU   DDRFDEV
DDRFCUA  EQU   DDRREC+45
DDRPHD   EQU   @NM00051+20
DDRVOL2  EQU   @NM00051+14
DDRVOL1  EQU   @NM00051+8
DDRJOBID EQU   @NM00051
DDRCEL   EQU   DDRCPUID+6
DDRMOD   EQU   DDRCPUID+4
DDRSER   EQU   DDRCPUID+1
@NM00050 EQU   DDRCPUID
DDRTIME  EQU   DDRHEAD+12
DDRDATE  EQU   DDRHEAD+8
@NM00049 EQU   DDRHEAD+4
DDRDEPSW EQU   DDRSMS+1
@NM00048 EQU   DDRSMS
DDRKEY2  EQU   DDRKEY+1
DDRKEY1  EQU   DDRKEY
IPLSHSEC EQU   IPLSTIME+3
IPLSSEC  EQU   IPLSTIME+2
IPLSMIN  EQU   IPLSTIME+1
IPLSHOUR EQU   IPLSTIME
IPLSDATE EQU   IPLREC+48
IPLTEMP  EQU   IPLREC+46
IPLHIGH  EQU   IPLREC+42
IPLCHAN  EQU   IPLREC+32
@NM00047 EQU   IPLREC+30
IPLREAS  EQU   IPLREC+28
@NM00046 EQU   IPLREC+25
IPLSYSID EQU   IPLREC+24
IPLCEL   EQU   IPLCPUID+6
IPLMOD   EQU   IPLCPUID+4
IPLSER   EQU   IPLCPUID+1
@NM00045 EQU   IPLCPUID
IPLTIME  EQU   IPLHEAD+12
IPLDATE  EQU   IPLHEAD+8
@NM00044 EQU   IPLHEAD+4
IPLSMS   EQU   IPLHEAD+2
IPLKEY2  EQU   IPLKEY+1
IPLKEY1  EQU   IPLKEY
SFTXDATA EQU   SFTREC+434
SFTLVARA EQU   SFTREC+432
SFTREXN  EQU   SFTRECP+16
SFTCSECT EQU   SFTRECP+8
SFTMODN  EQU   SFTRECP
@NM00043 EQU   SFTSDWA+238
SFTLCPUA EQU   SFTSDWA+236
SFTERRD  EQU   SFTFLGS+3
SFTERRC  EQU   SFTFLGS+2
SFTERRB  EQU   SFTFLGS+1
SFTERRA  EQU   SFTFLGS
@NM00042 EQU   SFTSDWA+136
SFTAAEC1 EQU   SFTSDWA+120
@NM00041 EQU   SFTSDWA+112
SFTPROGC EQU   SFTAEC1+8
@NM00040 EQU   SFTAEC1
@NM00039 EQU   SFTSDWA+88
SFTGRSV  EQU   SFTSDWA+24
SFTABNDC EQU   SFTSDWA
SFTJOBID EQU   SFTREC+24
SFTCEL   EQU   SFTCPUID+6
SFTMOD   EQU   SFTCPUID+4
SFTSER   EQU   SFTCPUID+1
@NM00038 EQU   SFTCPUID
SFTTIME  EQU   SFTHEAD+12
SFTDATE  EQU   SFTHEAD+8
@NM00037 EQU   SFTHEAD+4
SFTSMS   EQU   SFTHEAD+2
SFTKEY2  EQU   SFTKEY+1
SFTKEY1  EQU   SFTKEY
OBR34CT2 EQU   OBRTERMN+5
OBR34CT1 EQU   OBRTERMN+4
@NM00036 EQU   OBRTERMN
@NM00035 EQU   OBRSEEK+1
OBRTCAM  EQU   OBRSEEK
OBRSBCNT EQU   OBRREC+62
OBRRETRY EQU   OBRREC+60
OBRPCUA  EQU   OBRREC+57
OBRTYPE  EQU   OBRDEV+1
OBRCLASS EQU   OBRDEV
OBRCODE1 EQU   OBRCODE
OBRSECUA EQU   OBRREC+49
OBRSTAT  EQU   OBRCSW+4
@NM00034 EQU   OBRCSW
OBRSDRS2 EQU   OBRSRDS
OBRSDRS1 EQU   OBRSRDS
OBRSCUA  EQU   OBRJOBID+5
OBRSSDRC EQU   OBRJOBID+4
OBRSDEV2 EQU   OBRJOBID+2
OBRSDEV1 EQU   OBRJOBID
OBRCEL   EQU   OBRCPUID+6
OBRMOD   EQU   OBRCPUID+4
OBRSER   EQU   OBRCPUID+1
@NM00033 EQU   OBRCPUID
OBRTIME  EQU   OBRHEAD+12
OBRDATE  EQU   OBRHEAD+8
@NM00032 EQU   OBRHEAD+4
@NM00031 EQU   OBRSUBTP
DISMOUNT EQU   OBRSUBTP
@NM00030 EQU   OBRSUBTP
SHORTSW  EQU   OBRSUBTP
OBRTEMP  EQU   OBRSUBTP
SDRCOUNT EQU   OBRSUBTP
@NM00029 EQU   MISCSW
TRUNC    EQU   MISCSW
@NM00028 EQU   MISCSW
OBRKEY2  EQU   OBRKEY+1
OBRKEY1  EQU   OBRKEY
CCHLOG   EQU   CCHREC+80
CCHMP    EQU   CCHREC+76
CCHCUA   EQU   CCHREC+74
@NM00027 EQU   CCHREC+73
CCHID    EQU   CCHREC+72
CCHTYPE  EQU   CCHCODE2+1
CCHCLASS EQU   CCHCODE2
CCHCODE1 EQU   CCHCODE
CCHECSW  EQU   CCHREC+64
CCHCSW   EQU   CCHREC+56
CCHFCCW  EQU   CCHREC+48
CCHATIO  EQU   CCHREC+32
CCHJOBID EQU   CCHREC+24
CCHCEL   EQU   CCHCPUID+6
CCHMOD   EQU   CCHCPUID+4
CCHSER   EQU   CCHCPUID+1
@NM00026 EQU   CCHCPUID
CCHTIME  EQU   CCHHEAD+12
CCHDATE  EQU   CCHHEAD+8
@NM00025 EQU   CCHHEAD+4
CCHRINC  EQU   CCHSMS+1
@NM00024 EQU   CCHSMS
CCHRCRH  EQU   CCHSMS
@NM00023 EQU   CCHSMS
CCHKEY2  EQU   CCHKEY+1
CCHKEY1  EQU   CCHKEY
MCHLOG   EQU   MCHREC+48
MCHOPSW  EQU   MCHREC+40
MCHJOBID EQU   MCHREC+32
MCHPGMID EQU   MCHREC+24
MCHCEL   EQU   MCHCPUID+6
MCHMOD   EQU   MCHCPUID+4
MCHSER   EQU   MCHCPUID+1
@NM00022 EQU   MCHCPUID
MCHTIME  EQU   MCHHEAD+12
MCHDATE  EQU   MCHHEAD+8
@NM00021 EQU   MCHHEAD+4
MCHSYSTR EQU   MCHSMS+1
@NM00020 EQU   MCHSMS
MCHKEY2  EQU   MCHKEY+1
MCHKEY1  EQU   MCHKEY
LRTMCEL  EQU   LRTCPU+6
LRTMODEL EQU   LRTCPMOD+3
LRTCPUS  EQU   LRTCPMOD
@NM00019 EQU   LRTCPU
LRTHSECS EQU   LRTTIME+3
LRTSEC   EQU   LRTTIME+2
LRTMIN   EQU   LRTTIME+1
LRTHOUR  EQU   LRTTIME
LRTDAY   EQU   LRTYRDAY+1
LRTYEAR  EQU   LRTYRDAY
LRTDATE0 EQU   LRTDATE
@NM00018 EQU   @NM00016+3
LRTCNT   EQU   @NM00016+2
@NM00017 EQU   @NM00016
LRTDSMNT EQU   LRTERRID
@NM00015 EQU   LRTERRID
LRTSHRT  EQU   LRTERRID
@NM00014 EQU   LRTERRID
@NM00013 EQU   LRTSMS
LRTIMCNV EQU   LRTSMS
@NM00012 EQU   LRTSMS
LRTRUNC  EQU   LRTSMS
LRNS     EQU   LRTSMS
LRTNLAST EQU   LRTSMS
LRTKEY2  EQU   LRTKEY+1
LRTKEY1  EQU   LRTKEY
MODEL    EQU   MERIDIAN+2
MRDNUMBR EQU   MERIDIAN
SYMVAL2  EQU   SYMVAL+2
SYMVAL1  EQU   SYMVAL
SYMCDNUM EQU   SYMCODE
LIBVAL   EQU   LIBADR+2
LIBADNUM EQU   LIBADR
CPUCUX3  EQU   CPUCUAV+5
CPUCUX2  EQU   CPUCUAV+3
CPUCUX1  EQU   CPUCUAV
CPCUANUM EQU   CPUCUAS
CPUVAL   EQU   CPUS+2
CPUNUM   EQU   CPUS
VOLVAL   EQU   VOLUME+2
VOLNUM   EQU   VOLUME
SERVAL   EQU   DEVSERAL+2
SERNUM   EQU   DEVSERAL
MODVAL   EQU   MODELS+2
MODNUM   EQU   MODELS
MDRVAL   EQU   DEVICE+204
MDRNUM   EQU   DEVICE+202
DEVVAL   EQU   DEVICE+2
DEVNUM   EQU   DEVICE
CUA2     EQU   CUAVAL+2
CUA1     EQU   CUAVAL
CUANUM   EQU   CUA
LOADPTR  EQU   EDITABLE+8
LOADNAME EQU   EDITABLE
EDITNUM  EQU   EDITLOAD
SHARLET  EQU   SHAREIO+15
SHRCUAAH EQU   SHRCUCPU+5
SHRCUAAL EQU   SHRCUCPU+3
SHARSERA EQU   SHRCUCPU
SHRCUABH EQU   SHRBASE+5
SHRCUABL EQU   SHRBASE+3
SHARSERB EQU   SHRBASE
SHAREFLG EQU   SHAREIO
SHARENUM EQU   SHARE
SYSTEMP  EQU   SYSUM2+10
SYSPERM  EQU   SYSUM2+8
SYSRANGE EQU   SYSUM2+7
SYSDEV   EQU   SYSUM2+5
SYSOLDA  EQU   SYSITEM
SYS3705  EQU   SYSITEM
SYSOLD   EQU   SYSCPUS
SYSCPU   EQU   SYSCPUS
SYSTROLL EQU   SYSRT+1
SYSSPAN  EQU   SYSRT+1
SYSCUA   EQU   SYSRT
SYSGROUP EQU   SYSUMKEY
SYSUMEOD EQU   SYSUMONE+96
SYSUMPER EQU   SYSUMONE+92
SYSUMPEA EQU   SYSUMONE+88
SYSUMPEI EQU   SYSUMONE+84
SYSUMCH  EQU   SYSUMONE+20
SYSUMMCN EQU   SYSUMONE+16
SYSUMMCR EQU   SYSUMONE+12
SYSUMNXT EQU   SYSUMONE+8
SYSUMIPL EQU   SYSUMONE+4
SYSUMNUM EQU   SYSUMONE
SORTCORE EQU   SORTCCHR
SORTTIME EQU   SORTKEY+1
SORTYEAR EQU   SORTKEY
EVLETTER EQU   EVKEY+5
EVSERIAL EQU   EVKEY+2
EVMODEL  EQU   EVKEY
EVNUM    EQU   EVTABLE+4
EVDAY    EQU   EVSTOP+1
EVYEAR   EQU   EVSTOP
TRETMP   EQU   TREND2+10
TREPRM   EQU   TREND2+8
TRENDDEV EQU   TREND2+6
TRENDDAT EQU   TRENDKEY+5
TRENDOD  EQU   TRENDITM
TREND037 EQU   TRENDITM
TRENDOLD EQU   TRENCPUS
TRENDCPU EQU   TRENCPUS
@NM00011 EQU   TRENDRT+1
TRENDCUA EQU   TRENDRT
TRENDGRP EQU   TRENDKEY
TREPRE   EQU   TREGEN+72
TRECCHF  EQU   TREGEN+68
TRECCHE  EQU   TREGEN+64
TRECCHD  EQU   TREGEN+60
TRECCHC  EQU   TREGEN+56
TRECCHB  EQU   TREGEN+52
TRECCHA  EQU   TREGEN+48
TRECCH9  EQU   TREGEN+44
TRECCH8  EQU   TREGEN+40
TRECCH7  EQU   TREGEN+36
TRECCH6  EQU   TREGEN+32
TRECCH5  EQU   TREGEN+28
TRECCH4  EQU   TREGEN+24
TRECCH3  EQU   TREGEN+20
TRECCH2  EQU   TREGEN+16
TRECCH1  EQU   TREGEN+12
TREMCH   EQU   TREGEN+4
TREIPL   EQU   TREGEN
TRENUM   EQU   TRENDONE+4
TRENEXT  EQU   TRENDONE
DUMPSIZE EQU   DUMPINFO+4
DUMPADR  EQU   DUMPINFO
DUMPNUM  EQU   DUMPTABL
@NM00010 EQU   PARM+212
RECLNGT1 EQU   PARM+204
FRAMEPTR EQU   PARM+200
ADCPUT   EQU   PARM+144
LINECT   EQU   PARM+120
RECLNGTH EQU   CCHHRLNG+6
@NM00009 EQU   CCHHRLNG+5
USERPGM  EQU   PARM+102
IDTSEC   EQU   IDTIME+3
IDSEC    EQU   IDTIME+2
IDMIN    EQU   IDTIME+1
IDHOUR   EQU   IDTIME
IDASID   EQU   ERRID+4
IDCPU    EQU   ERRID+3
@NM00008 EQU   ERRID+2
IDVALUE  EQU   ERRID
NUMDAYS  EQU   PARM+88
SORTNUM  EQU   PARM+84
TABSIZE  EQU   PARM+80
SYSRETRN EQU   @NM00007
NUMIN222 EQU   @NM00006
WRTHRSH  EQU   PARM+69
TERM     EQU   PARM+58
EVSDAY   EQU   STRTDATE+1
EVSYEAR  EQU   STRTDATE
PENSEC2  EQU   ENDTIME2+2
PENMIN2  EQU   ENDTIME2+1
PENHOUR2 EQU   ENDTIME2
PSTSEC2  EQU   STTIME2+2
PSTMIN2  EQU   STTIME2+1
PSTHOUR2 EQU   STTIME2
PENSEC1  EQU   ENDTIME1+2
PENMIN1  EQU   ENDTIME1+1
PENHOUR1 EQU   ENDTIME1
PSTSEC1  EQU   STTIME1+2
PSTMIN1  EQU   STTIME1+1
PSTHOUR1 EQU   STTIME1
@NM00005 EQU   ENDDT+4
PENDY    EQU   PEND+1
PENYR    EQU   PEND
@NM00004 EQU   ENDDATE
@NM00003 EQU   STDT+4
PSTDY    EQU   PSTD+1
PSTYR    EQU   PSTD
@NM00002 EQU   STDATE
YEARNOW  EQU   DATENOW+4
@NM00001 EQU   DATENOW+3
DAYNOW   EQU   DATENOW
CSNAP    EQU   CLOSEIO
CDRCTWRK EQU   CLOSEIO
CSYSIN   EQU   CLOSEIO
CACCDEV  EQU   CLOSEIO
CACCIN   EQU   CLOSEIO
CSERLOG  EQU   CLOSEIO
CEREPPT  EQU   CLOSEIO
CTOURIST EQU   CLOSEIO
OSNAP    EQU   OPENIO
ODRCTWRK EQU   OPENIO
OSYSIN   EQU   OPENIO
OACCDEV  EQU   OPENIO
OACCIN   EQU   OPENIO
OSERLOG  EQU   OPENIO
OEREPPT  EQU   OPENIO
OTOURIST EQU   OPENIO
PASSFLAG EQU   MISC
PLOGREC  EQU   MISC
ERRORID  EQU   MISC
PSUM     EQU   PRINTES
PEDIT    EQU   PRINTES
PHIST    EQU   MISC
PACC     EQU   MISC
PZERO    EQU   MISC
DEBUG62  EQU   DEBUGA+3
DEBUG59  EQU   DEBUGA+3
DEBUG58  EQU   DEBUGA+3
DEBUG57  EQU   DEBUGA+3
DEBUG54  EQU   DEBUGA+2
DEBUG53  EQU   DEBUGA+2
DEBUG52  EQU   DEBUGA+2
DEBUG51  EQU   DEBUGA+2
DEBUG50  EQU   DEBUGA+2
DEBUG49  EQU   DEBUGA+2
DEBUG48  EQU   DEBUGA+2
DEBUG47  EQU   DEBUGA+1
DEBUG46  EQU   DEBUGA+1
DEBUG45  EQU   DEBUGA+1
DEBUG44  EQU   DEBUGA+1
DEBUG43  EQU   DEBUGA+1
DEBUG42  EQU   DEBUGA+1
DEBUG41  EQU   DEBUGA+1
DEBUG40  EQU   DEBUGA+1
DEBUG39  EQU   DEBUGA
DEBUG38  EQU   DEBUGA
DEBUG37  EQU   DEBUGA
DEBUG36  EQU   DEBUGA
DEBUG35  EQU   DEBUGA
DEBUG34  EQU   DEBUGA
DEBUG33  EQU   DEBUGA
DEBUG32  EQU   DEBUGA
DEBUG31  EQU   DEBUG+3
DEBUG30  EQU   DEBUG+3
DEBUG29  EQU   DEBUG+3
DEBUG28  EQU   DEBUG+3
DEBUG27  EQU   DEBUG+3
DEBUG26  EQU   DEBUG+3
DEBUG25  EQU   DEBUG+3
DEBUG24  EQU   DEBUG+3
DEBUG23  EQU   DEBUG+2
DEBUG22  EQU   DEBUG+2
DEBUG21  EQU   DEBUG+2
DEBUG20  EQU   DEBUG+2
DEBUG19  EQU   DEBUG+2
DEBUG18  EQU   DEBUG+2
DEBUG17  EQU   DEBUG+2
DEBUG16  EQU   DEBUG+2
DEBUG15  EQU   DEBUG+1
DEBUG14  EQU   DEBUG+1
DEBUG13  EQU   DEBUG+1
DEBUG12  EQU   DEBUG+1
DEBUG11  EQU   DEBUG+1
DEBUG10  EQU   DEBUG+1
DEBUG9   EQU   DEBUG+1
DEBUG8   EQU   DEBUG+1
DEBUG7   EQU   DEBUG
DEBUG6   EQU   DEBUG
DEBUG5   EQU   DEBUG
DEBUG4   EQU   DEBUG
DEBUG3   EQU   DEBUG
DEBUG2   EQU   DEBUG
DEBUG1   EQU   DEBUG
DEBUG0   EQU   DEBUG
SORTBRK  EQU   SWITCHES+1
ANALYSIS EQU   SWITCHES+1
SHIFT3RD EQU   SWITCHES+1
DEVEXCL  EQU   SWITCHES+1
ZEROALL  EQU   SWITCHES+1
NOTALL   EQU   SWITCHES+1
NOSDR    EQU   SWITCHES
TIMESEQ  EQU   SWITCHES
SYSUM    EQU   SWITCHES
PARMTHR  EQU   SWITCHES
TREND    EQU   SWITCHES
SHORTOBR EQU   SWITCHES
PARMMES  EQU   SWITCHES
RDESUM   EQU   SWITCHES
PCCHFRAM EQU   RECTYPE+1
PMCHFRAM EQU   RECTYPE+1
PTTYP    EQU   RECTYPE+1
PEOD     EQU   RECTYPE
PMIH     EQU   RECTYPE
PDDR     EQU   RECTYPE
PIPL     EQU   RECTYPE
PSOFT    EQU   RECTYPE
POBR     EQU   RECTYPE
PCHAN    EQU   RECTYPE
PMCH     EQU   RECTYPE
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00283 EQU   @RC00236
@RC00276 EQU   @RC00236
@RC00263 EQU   @RC00236
@RC00240 EQU   @RC00236
@RF00294 EQU   @RC00236
@RF00309 EQU   @EL00002
@RC00321 EQU   @EL00003
@RF00350 EQU   @EL00005
@RF00400 EQU   @RC00394
@RF00408 EQU   @EL00007
@RF00436 EQU   @EL00008
@RC00440 EQU   @EL00009
@RC00463 EQU   @EL00010
@RC00486 EQU   @EL00011
@RF00567 EQU   @EL00014
@RC00610 EQU   @EL00015
@RC00615 EQU   @EL00015
@RC00622 EQU   @EL00015
@RC00620 EQU   @EL00015
@RC00618 EQU   @EL00015
@RC00634 EQU   @RC00632
@RC00663 EQU   @EL00016
@RC00661 EQU   @EL00016
@RF00676 EQU   @EL00017
@RC00699 EQU   @EL00018
@RC00706 EQU   @EL00018
@RC00713 EQU   @EL00018
@RC00720 EQU   @EL00018
@RC00730 EQU   @EL00019
@RC00762 EQU   @EL00019
@RC00760 EQU   @EL00019
@RC00758 EQU   @EL00019
@RC00752 EQU   @EL00019
@RF00912 EQU   @RC00908
@RF00919 EQU   @RC00915
@RF00932 EQU   @EL00022
@RC01031 EQU   @EL00025
@RC01048 EQU   @EL00025
@RF01098 EQU   @RC01095
@RF01115 EQU   @EL00027
@RC01223 EQU   @EL00031
@RC01208 EQU   @EL00031
@RC01235 EQU   @EL00031
@RC01226 EQU   @EL00031
@RF01313 EQU   @EL00035
@RF01350 EQU   @EL00037
@RF01433 EQU   @EL00044
@PB00046 EQU   @EL00001
@RF00258 EQU   @RC00240
@RF00266 EQU   @RC00263
@RF00454 EQU   @RC00440
@RC00442 EQU   @RC00440
@RF00477 EQU   @RC00463
@RC00465 EQU   @RC00463
@RF00500 EQU   @RC00486
@RC00488 EQU   @RC00486
@RC00611 EQU   @RC00610
@RC00701 EQU   @RC00699
@RC00708 EQU   @RC00706
@RC00715 EQU   @RC00713
@RC00754 EQU   @RC00752
@RC01033 EQU   @RC01031
@RC01042 EQU   @RC01031
@RC01050 EQU   @RC01048
@RC01059 EQU   @RC01048
@RC01210 EQU   @RC01208
@RC01218 EQU   @RC01208
@RC01216 EQU   @RC01208
@RC01228 EQU   @RC01226
@PB00045 EQU   @PB00046
@PB00044 EQU   @PB00045
@PB00043 EQU   @PB00044
@PB00042 EQU   @PB00043
@PB00041 EQU   @PB00042
@PB00040 EQU   @PB00041
@PB00039 EQU   @PB00040
@PB00038 EQU   @PB00039
@PB00037 EQU   @PB00038
@PB00036 EQU   @PB00037
@PB00035 EQU   @PB00036
@PB00034 EQU   @PB00035
@PB00033 EQU   @PB00034
@PB00032 EQU   @PB00033
@PB00031 EQU   @PB00032
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@RF00224 EQU   @PB00002
@ENDDATA EQU   *
         END   IFCNFPDR,(C'PLS0239',0702,79011)

         TITLE 'IKJEFLEA, LOGON PHASE1, PARSE-SCAN INTERFACE RTN       *
                        '
IKJEFLEA CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFLEA  78.177'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
LWASWAR  EQU   4
LWAMSPE  EQU   16
INITDONE EQU  4
NQUSERID EQU  8
DQUSERID EQU  12
SCHEDULE EQU  16
BCDONE   EQU  20
TERMINAT EQU  24
NQDQ0    EQU  0
NQDQ4    EQU  4
NQDQ8    EQU  8
STARTP2  EQU  16
INITRDY  EQU  20
ENDTASK  EQU  24
*   PRMPNTR = PARM;                                                0126
*                                                                  0126
*                                                                  0126
         L     @03,BACKPTR(,SAVEPTR)                               0126
         L     PRMPNTR,PARM(,@03)                                  0126
*   LWAPTR = PTRLWA;              /* INITIALIZE ADDRESS OF THE LWA.  */
         L     LWAPTR,PTRLWA(,PRMPNTR)                             0127
*   LWALEA = '1'B;                /* INDICATE LEA HAS CONTROL  Y02669*/
         OI    LWALEA(LWAPTR),B'00001000'                          0128
*   RTNCODE = 0;                  /* INITIALIZE RETURN CODE TO ZERO. */
         SLR   @08,@08                                             0129
         ST    @08,RTNCODE(,@03)                                   0129
*   ASCBPTR=LWAPASCB;             /* SET PTR TO ASCB           Y02669*/
         L     @08,LWAPASCB(,LWAPTR)                               0130
         ST    @08,ASCBPTR                                         0130
*   EABITS = 0;                   /* INIT BITS FOR LEA         Y02669*/
         MVI   EABITS,X'00'                                        0131
*   TSBPTR = ASCBTSB;             /* SET PTR TO TSB            Y02669*/
*                                                                  0132
         MVC   TSBPTR(4),ASCBTSB(@08)                              0132
*   /*****************************************************************/
*/*       INITIALIZE COMMAND SCAN'S PARAMETER LIST                   */
*   /*****************************************************************/
*                                                                  0133
*   CNDPARM = IOPARM;             /* INITIALIZE UPT, ECT AND CANCEL
*                                    ECB ADDRESSES                   */
         L     @08,PTRIOLST(,PRMPNTR)                              0133
         MVC   CNDPARM(12),IOPARM(@08)                             0133
*   CNDFLG = ADDR(FLGWORD);       /* INITIALIZE POINTER TO FLAG WORD */
         LA    @08,FLGWORD                                         0134
         ST    @08,CNDFLG                                          0134
*   FLAGCND = '00'X;              /* INDICATE COMMAND NAME TO BE     */
         MVI   FLAGCND,X'00'                                       0135
*                                 /* SYNTAX CHECKED                  */
*   CNDOUT = ADDR(OUTPCND);       /* SET POINTER TO COMMAND SCAN   0136
*                                    OUTPUT AREA                     */
*                                                                  0136
*                                                                  0136
         LA    @08,OUTPCND                                         0136
         ST    @08,CNDOUT                                          0136
*   IF PTYPE = 3                  /*IF INITIAL SCAN OF LINE REQUESTED*/
*     THEN                                                         0137
         L     @08,FUNCPTR(,PRMPNTR)                               0137
         LH    @08,PTYPE(,@08)                                     0137
         CH    @08,@CH00136                                        0137
         BE    @RT00137                                            0137
*       GOTO SCAN;                /* SCAN LINE                       */
*                                                                  0138
*                                                                  0138
*   IF PTYPE = 4                  /* IF SCAN OF LINE NEEDED          */
*     THEN                                                         0139
         CH    @08,@CH00134                                        0139
         BE    @RT00139                                            0139
*       GOTO SCANCMND;            /* SCAN LINE FOR LOGON OR LOGOFF   */
*                                                                  0140
*   GOTO SETUPPRS;                /* SCAN OF LINE NOT NEEDED         */
*                                                                  0141
*                                                                  0141
*                                                                  0141
         B     SETUPPRS                                            0141
*   /*****************************************************************/
*   /*     SCAN ENTRY POINT:                                         */
*   /*                                                               */
*   /*     THIS ENTRY POINT IS USED BY MODULE IKJEFLE TO COPY        */
*   /*     THE RELOGON BUFFER FROM SUBPOOOL 230 TO SUBPOOL 1.        */
*   /*     THE RELOGON BUFFER IS THEN SET TO BLANKS, THE             */
*   /*     HEADER INITIALIZED TO LENGTH 256 AND THE OFFSET TO 0.     */
*   /*****************************************************************/
*                                                                  0142
*                                                                  0142
*SCAN:                                                             0142
*                                                                  0142
*   /*****************************************************************/
*   /*     COPY RELOGON OR ATTENTION BUFFER FROM SUBPOOL 230 TO 1    */
*   /*****************************************************************/
*                                                                  0142
*   GEN(GETMAIN R,SP=1,LV=256);   /* GET CORE TO MOVE RELOGON      0142
*                                    BUFFER INTO.                    */
SCAN     GETMAIN R,SP=1,LV=256
*   RESPECIFY (GTMNPTR) RSTD;                                      0143
*   INBUF = GTMNPTR;              /* SAVE ADDRESS OF BUFFER INTO WHICH
*                                    RELOGON BUFFER WILL BE COPIED.  */
         L     @08,PTRIOLST(,PRMPNTR)                              0144
         L     @08,PTRINBUF(,@08)                                  0144
         ST    GTMNPTR,INBUF(,@08)                                 0144
*   RESPECIFY (GTMNPTR) UNRSTD;                                    0145
*   CMNDTEXT(1:252) = PSCBRLGB -> CMNDTEXT(1:252); /* SAVE TEXT    0146
*                                    PORTION OF RELOGON BUFFER.      */
         L     @08,PTRIOLST(,PRMPNTR)                              0146
         L     @08,PTRINBUF(,@08)                                  0146
         L     @08,INBUF(,@08)                                     0146
         L     @03,LWAPSCB(,LWAPTR)                                0146
         L     @03,PSCBRLGB(,@03)                                  0146
         MVC   CMNDTEXT(252,@08),CMNDTEXT(@03)                     0146
*   CMNDLNG = 256;                /* SAVE LENGTH OF COMMAND BUFFER   */
         MVC   CMNDLNG(2,@08),@CH01699                             0147
*   CMNDOFST = 0;                 /* SET COMMAND BUFFER OFFSET TO  0148
*                                    ZERO. THE COMMAND MAY BE      0148
*                                    RESCANNED, AND THE OFFSET MUST BE
*                                    ZERO.                           */
*                                                                  0148
         SLR   @03,@03                                             0148
         STH   @03,CMNDOFST(,@08)                                  0148
*   /*****************************************************************/
*   /*     FIX THE RELOGON BUFFER:  SET IT TO BLANKS, INITIALIZE     */
*   /*     THE HEADER TO LENGTH 256 AND OFFSET 0.                    */
*   /*****************************************************************/
*                                                                  0149
*FIXRLGB:                                                          0149
*   PSCBRLGB -> CMNDTEXT(1:252) = ''; /* BLANK OUT RELOGON BUFFER.   */
FIXRLGB  L     @08,LWAPSCB(,LWAPTR)                                0149
         L     @08,PSCBRLGB(,@08)                                  0149
         MVI   CMNDTEXT(@08),C' '                                  0149
         MVC   CMNDTEXT+1(251,@08),CMNDTEXT(@08)                   0149
*   PSCBRLGB -> CMNDLNG = 256;    /* RESET LENGTH OF RELOGON BUFFER. */
         MVC   CMNDLNG(2,@08),@CH01699                             0150
*   PSCBRLGB -> CMNDOFST = 0;     /* RESET OFFSET TO ZERO.           */
         SLR   @03,@03                                             0151
         STH   @03,CMNDOFST(,@08)                                  0151
*   RETURN;                                                        0152
*                                                                  0152
@EL00001 L     @13,4(,@13)                                         0152
@EF00001 L     @00,@SIZDATD                                        0152
         LR    @01,@11                                             0152
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0152
         BR    @14                                                 0152
*   /*****************************************************************/
*   /*     SCANCMND ENTRY POINT:                                     */
*   /*                                                               */
*   /*     THIS ENTRY POINT IS USED BY MODULE IKJEFLE FOR SCAN       */
*   /*     OF INPUT LINE WHEN IT NEEDS A LOGON OR LOGOFF COMMAND.    */
*   /*     NORMALLY, CONTROL IS PASSED BACK TO MODULE IKJEFLE ONLY   */
*   /*     WHEN A LOGON OR LOGOFF COMMAND HAS BEEN ENTERED.          */
*   /*****************************************************************/
*                                                                  0153
*SCANCMND:                                                         0153
*   PMSGNM = 1;                   /* SET MESSAGE NUMBER TO ENTER   0153
*                                    LOGON×LOGOFF MESSAGE.           */
SCANCMND L     @08,FUNCPTR(,PRMPNTR)                               0153
         MVC   PMSGNM(2,@08),@CH00032                              0153
*   IF INBUF = 0                  /* IF THERE IS NO COMMAND BUFFER,
*                                    GOTO PROMPT FOR LOGON×LOGOFF.   */
*     THEN                                                         0154
         SLR   @08,@08                                             0154
         L     @03,PTRIOLST(,PRMPNTR)                              0154
         L     @03,PTRINBUF(,@03)                                  0154
         L     @03,INBUF(,@03)                                     0154
         CR    @03,@08                                             0154
         BE    @RT00154                                            0154
*       GOTO LOGONOFF;                                             0155
*                                                                  0155
*   /*****************************************************************/
*   /*   LINK TO COMMAND SCAN TO FIND COMMAND NAME AND CHECK SYNTAX  */
*   /*****************************************************************/
*                                                                  0156
*   CNDBUF = INBUF;               /* INITIALIZE POINTER TO COMMAND 0156
*                                    BUFFER FOR COMMAND SCAN.        */
         ST    @03,CNDBUF                                          0156
*   RESPECIFY (PARMPTR) RSTD;                                      0157
*   PARMPTR = ADDR(CNDSCLST);     /* SET POINTER TO COMMAND SCAN   0158
*                                    PARAMETER LIST                  */
         LA    PARMPTR,CNDSCLST                                    0158
*   DO; /*CALLTSSR EP(IKJSCAN)*/                                   0159
*     RESPECIFY GPR01P RSTD;                                       0160
*     IF CVTSCAN = 0                                               0161
*       THEN                                                       0161
         L     @03,CVTPTR                                          0161
         C     @08,CVTSCAN(,@03)                                   0161
         BNE   @RF00161                                            0161
*         GEN(LINK EP=IKJSCAN);                                    0162
         LINK EP=IKJSCAN
*       ELSE                                                       0163
*         CALL CVTSCAN;                                            0163
         B     @RC00161                                            0163
@RF00161 L     @08,CVTPTR                                          0163
         L     @15,CVTSCAN(,@08)                                   0163
         BALR  @14,@15                                             0163
*     RESPECIFY GPR01P UNRSTD;                                     0164
@RC00161 DS    0H                                                  0165
*   END;       /* LINK TO COMMAND SCAN            */               0165
*   RESPECIFY (PARMPTR) UNRSTD;                                    0166
*                                                                  0166
*                                                                  0166
*   IF RTNREG ^= 0                /* IF ERROR RETURN CODE            */
*     THEN                                                         0167
         SLR   @14,@14                                             0167
         CR    RTNREG,@14                                          0167
         BNE   @RT00167                                            0167
*       GOTO ERRSCAN;             /* PROCESS ERROR                   */
*                                                                  0168
*                                                                  0168
*   IF OUTFLGS = '10'X            /* IF INPUT LINE IS NULL, PROMPT 0169
*                                    FOR LOGON OR LOGOFF COMMAND     */
*     THEN                                                         0169
         CLI   OUTFLGS,X'10'                                       0169
         BE    @RT00169                                            0169
*       GOTO CMNDMSG;                                              0170
*                                                                  0170
*                                                                  0170
*         PMSGNM = 3;             /* SET MESSAGE NUMBER TO INVALID 0171
*                                    COMMAND MESSAGE                 */
*                                                                  0171
         L     @08,FUNCPTR(,PRMPNTR)                               0171
         MVC   PMSGNM(2,@08),@CH00136                              0171
*   IF OUTFLGS = '08'X            /* IF SYNTACTICALLY INVALID, GO TO
*                                    PUT OUT ERROR MESSAGE.          */
*     THEN                                                         0172
         CLI   OUTFLGS,X'08'                                       0172
         BE    @RT00172                                            0172
*       GOTO CMNDMSG;                                              0173
*                                                                  0173
*   /*****************************************************************/
*/* IF COMMAND IS LOGOFF, RETURN TO IKJEFLE INDICATING THAT THE      */
*/* TERMINAL SHOULD BE DISCONNECTED                                  */
*   /*****************************************************************/
*                                                                  0174
*   IF CNDLGTH = 6                /* IF COMMAND IS SIX CHARACTERS  0174
*                                    LONG, IT MAY BE LOGOFF.         */
*     THEN                                                         0174
         CLC   CNDLGTH(2),@CH00218                                 0174
         BNE   @RF00174                                            0174
*       IF COMNDNM(1:6) = 'LOGOFF'      /* IF IT IS LOGOFF, GO TO  0175
*                                    CLEANUP RESOURCES.              */
*         THEN DO;                                                 0175
*                                                                  0175
         L     @08,CNDNAME                                         0175
         CLC   COMNDNM(6,@08),@CC01734                             0175
         BNE   @RF00175                                            0175
*   /*****************************************************************/
*/* 'LOGOFF HOLD' OR'LOGOFF DISCONNECT' MAY HAVE BEEN SPECIFIED.Y02669*
*/* IF 'LOGOFF HOLD' WAS ENTERED, TSBHLDL IS SET TO 1 -         Y02669*
*/* WHICH INFORMS TCAM NOT TO DROP THE LINE.                    Y02669*
*   /*****************************************************************/
*         IF LWAVTAM = '0'B       /*IF THIS IS NOT VTAM THEN       0177
*                                   CLEAN UP                 @Z40DQKU*/
*           THEN DO;                                               0177
         TM    LWAVTAM(LWAPTR),B'00100000'                         0177
         BNZ   @RF00177                                            0177
*             PRSPARM=IOPARM;      /*INITIALIZE UPT, ECT, AND   Y02669
*                                    CANCEL ECB ADDRESS         Y02669*
         L     @08,PTRIOLST(,PRMPNTR)                              0179
         MVC   PRSPARM(12),IOPARM(@08)                             0179
*             PRSANS=ADDR(PRSPDL); /*INITIALIZE POINTER TO ANS  Y02669
*                                    POINTER                    Y02669*
         LA    @03,PRSPDL                                          0180
         ST    @03,PRSANS                                          0180
*             PRSBUF=INBUF;        /*INITIALIZE POINTER TO      Y02669
*                                    COMMAND BUFFER             Y02669*
         L     @08,PTRINBUF(,@08)                                  0181
         MVC   PRSBUF(4),INBUF(@08)                                0181
*             PRSPCL=ADDR(IKJEFLE2); /*POINT TO LOGOFF PCL      Y02669*
         L     @08,@CV00078                                        0182
         ST    @08,PRSPCL                                          0182
*             PARMPTR=ADDR(PARSELST); /*SET REG 1 TO ADDRESS OF Y02669
*                                      PARSE'S PARAMETER LIST   Y02669*
         LA    PARMPTR,PARSELST                                    0183
*             DO; /*CALLTSSR EP(IKJPARS)*/                         0184
*               RESPECIFY GPR01P RSTD;                             0185
*               IF CVTPARS = 0                                     0186
*                 THEN                                             0186
         L     @08,CVTPTR                                          0186
         C     @14,CVTPARS(,@08)                                   0186
         BNE   @RF00186                                            0186
*                   GEN(LINK EP=IKJPARS);                          0187
         LINK EP=IKJPARS
*                 ELSE                                             0188
*                   CALL CVTPARS;                                  0188
         B     @RC00186                                            0188
@RF00186 L     @08,CVTPTR                                          0188
         L     @15,CVTPARS(,@08)                                   0188
         BALR  @14,@15                                             0188
*               RESPECIFY GPR01P UNRSTD;                           0189
@RC00186 DS    0H                                                  0190
*             END;/*LINK TO PARSE SERVICE ROUT Y02669*/            0190
*                                                                  0190
*             RESPECIFY (SVRTN) RSTD;                         /*Y02669*
*             SVRTN=RTNREG;       /*SAVE RETURN CODE FROM PARSE Y02669*
         LR    SVRTN,RTNREG                                        0192
*             IF SVRTN ^= 0        /*IF PARSE HAD ERROR, CLEAN  Y02669
*                                    UP PDL AND COMMAND BUFFER, Y02669
*                                    THEN RETURN TO TERMINATE   Y02669
*                                    SESSION.                   Y02669*
*               THEN                                          /*Y02669*
         LTR   SVRTN,SVRTN                                         0193
         BNZ   @RT00193                                            0193
*                 GO TO ENDPRSER;                             /*Y02669*
*             RESPECIFY (SVRTN) UNRSTD;                       /*Y02669*
*                                                                  0195
*             RESPECIFY (PDLBASE,PDEPTR) RSTD;                /*Y02669*
*             PDLBASE=PRSPDL;      /*LOAD BASE REGISTER FOR     Y02669
*                                    PDL                        Y02669*
         L     PDLBASE,PRSPDL                                      0197
*             GEN(USING LOGOFFAN,PDLBASE); /*ESTABLISH ADDRESS  Y02669
*                                            FOR PDL            Y02669*
         USING LOGOFFAN,PDLBASE
*             IF HOLDP=1           /* IF 'LOGOFF HOLD' ENTERED  Y02669*
*               THEN                                               0199
         CLC   HOLDP(2),@CH00032                                   0199
         BNE   @RF00199                                            0199
*                 DO;              /* TELL TIOC TO HOLD LINE    Y02669*
*                                   /* BEFORE UPDATING TSB,    Y02669*/
*                                   /* LOCAL AND CMS LOCKS     Y02669*/
*                                   /* MUST BE HOLD.           Y02669*/
*                                                                  0201
*                   RESPECIFY (SAVED11,SAVED12) RSTD; /*       Y02669*/
*                   SAVED11=R11;    /* SAVE REGS 11,12,13      Y02669*/
         LR    SAVED11,R11                                         0202
*                   SAVED12=R12;    /* AND 14. ALL ARE         Y02669*/
         LR    SAVED12,R12                                         0203
*                   SAVED13=SAVEPTR; /*DESTROYED BY SETLOCK    Y02669*/
         ST    SAVEPTR,SAVED13                                     0204
*                   SAVED14=R14;    /*                         Y02669*/
*                                                                  0205
         ST    R14,SAVED14                                         0205
*                   GEN             /* OBTAIN LOCAL LOCK       Y02669*/
*      (SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(TSB,IKJEFLEA))
*         REFS(PSALITA,FLC);                                 /*Y02669*/
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(TSB,IKJEFLEA)
*                   R12=SAVED12;    /*RESTORE ADDRESS. TO CODE Y02669*/
*                                                                  0207
         LR    R12,SAVED12                                         0207
*                   IF LOCKRTNC=0   /*IF NO ERROR FROM SETLOCK Y02669*/
*                     THEN          /* THEN                    Y02669*/
         LTR   LOCKRTNC,LOCKRTNC                                   0208
         BNZ   @RF00208                                            0208
*                      DO;                                         0209
*                        GEN        /*OBTAIN CMS LOCK          Y02669*/
*      (SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=(TSB,IKJEFLEA))
*         REFS(PSALITA,FLC);                                 /*Y02669*/
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=(TSB,IKJEFLEA)
*                        R12=SAVED12; /*RESTORE REG12          Y02669*/
*                                                                  0211
         LR    R12,SAVED12                                         0211
*                        IF LOCKRTNC=0 /*IF SETLOCK OK         Y02669*/
*                           THEN       /*THEN                  Y02669*/
         LTR   LOCKRTNC,LOCKRTNC                                   0212
         BNZ   @RF00212                                            0212
*                             DO;                                  0213
*                               R11=SAVED11; /*RESTORE REG11   Y02669*/
         LR    R11,SAVED11                                         0214
*                                            /*SET HOLD BIT    Y02669*/
*                               TSBHLDL='1'B;   /*IN TSB       Y02669*/
         L     @06,TSBPTR                                          0215
         OI    TSBHLDL(@06),B'00000001'                            0215
*                                 /*IF ERROR OCCURS NOW, WILL  Y02669*/
*                                 /*BE RELEASE ERROR           Y02669*/
*                               RELSLCK='1'B;                /*Y02669*/
*                                                                  0216
         OI    RELSLCK,B'10000000'                                 0216
*                               GEN   /*RELEASE CMS LOCK       Y02669*/
*      (SETLOCK RELEASE,TYPE=CMS,RELATED=(TSB,IKJEFLEA))           0217
*         REFS(PSALITA,FLC);                                /* Y02669*/
         SETLOCK RELEASE,TYPE=CMS,RELATED=(TSB,IKJEFLEA)
*                               R12=SAVED12; /*RESTORE REG12   Y02669*/
*                                                                  0218
         LR    R12,SAVED12                                         0218
*                               IF LOCKRTNC=0 /*IF RELEASE OK  Y02669*/
*                                 THEN /*THEN                  Y02669*/
         LTR   LOCKRTNC,LOCKRTNC                                   0219
         BNZ   @RF00219                                            0219
*                                   DO;                            0220
*                                     GEN    /*RELS LOCAL LCK  Y02669*/
*      (SETLOCK RELEASE,TYPE=LOCAL,RELATED=(TSB,IKJEFLEA))         0221
*         REFS(PSALITA,FLC);                                /* Y02669*/
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(TSB,IKJEFLEA)
*                                     R11=SAVED11;          /* Y02669*/
         LR    R11,SAVED11                                         0222
*                                     R12=SAVED12;          /* Y02669*/
*                                                                  0223
         LR    R12,SAVED12                                         0223
*                                      /*IF RELEASE OK         Y02669*/
*                                      IF LOCKRTNC=0        /* Y02669*/
*                                        THEN      /*CONTINUE  Y02669*/
         LTR   LOCKRTNC,LOCKRTNC                                   0224
         BZ    @RT00224                                            0224
*                                          GO TO CONTINUE;  /* Y02669*/
*                                                                  0225
*                                  END;                            0226
*                             END;                                 0227
@RF00219 DS    0H                                                  0228
*                       END;                                       0228
*                                                                  0228
@RF00212 DS    0H                                                  0229
*                                  /*IF UNSUCCESSFUL SETLOCK,  Y02669*/
*                                  /*PUT OUT ERROR MSG AND     Y02669*/
*                                  /*DISCONNECT TERMINAL       Y02669*/
*                   R11=SAVED11;   /*RESTORE REG 11            Y02669*/
@RF00208 LR    R11,SAVED11                                         0229
*                   GEN;           /*PREPARE RTN CODE FOR MSG  Y02669*/
*                                                                  0230
                    CVD LOCKRTNC,PACKDEC   CONVERT TO DECIMAL  Y02669
                    UNPK ZONEDEC(8),PACKDEC(8)                 Y02669
                    OI   ZONEDEC+7,X'F0'   CHANGE SIGN         Y02669
*                   PMSGNM=20;       /*SET MSG NUMBER TO       Y02669*/
         L     @06,FUNCPTR(,PRMPNTR)                               0231
         MVC   PMSGNM(2,@06),@CH01738                              0231
*                                    /*SERVICE RTN ERROR       Y02669*/
*                   TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*GET ADDR  Y02669*/
         L     @06,PTRIOLST(,PRMPNTR)                              0232
         L     @06,SEGS1PTR(,@06)                                  0232
         LA    @05,TEXTSEGS                                        0232
         ST    @05,TEXTINT1(,@06)                                  0232
*                                    /*OF ERROR ROUTINE SEG    Y02669*/
*                   IF RELSLCK='1'B  /*IF RLSE ERROR           Y02669*/
*                     THEN         /*THEN SET UP RLSE ERR MSG  Y02669*/
         TM    RELSLCK,B'10000000'                                 0233
         BNO   @RF00233                                            0233
*                       DO;                                 /* Y02669*/
*                         TEXTSLEN(1)=16; /*LEN OF TEXT        Y02669*/
         MVC   TEXTSLEN(2),@CH00109                                0235
*                         TEXTSTXT(1,1:12)='RELEASE LOCK';         0236
         MVC   TEXTSTXT(12),@CC01739                               0236
*                                  /*PUT IN TEXT OF MSG        Y02669*/
*                       END;                                       0237
*                                                                  0237
*                     ELSE         /*ELSE SET UP OBTAIN LOCK   Y02669*/
*                       DO;        /*MESSAGE                   Y02669*/
         B     @RC00233                                            0238
@RF00233 DS    0H                                                  0239
*                         TEXTSLEN(1)=15; /*LENGTH OF TEXT     Y02669*/
         MVC   TEXTSLEN(2),@CH00117                                0239
*                         TEXTSTXT(1,1:11)='OBTAIN LOCK';   /* Y02669*/
         MVC   TEXTSTXT(11),@CC01741                               0240
*                       END;                                       0241
*                                                                  0241
*                     TEXTSOST(1)=0; /*SET UP OFFSET           Y02669*/
@RC00233 SLR   @06,@06                                             0242
         STH   @06,TEXTSOST                                        0242
*                     TEXTINT1(2)=ADDR(TEXTSEGS(2)); /*GET ADDR Y02669*
         L     @05,PTRIOLST(,PRMPNTR)                              0243
         L     @05,SEGS1PTR(,@05)                                  0243
         LA    @15,TEXTSEGS+24                                     0243
         ST    @15,TEXTINT1+4(,@05)                                0243
*                                  /*OF RETURN CODE SEGMENT    Y02669*/
*                     TEXTSLEN(2)=7; /*SET LEN OF TEXT         Y02669*/
         MVC   TEXTSLEN+24(2),@CH00146                             0244
*                     TEXTSOST(2)=0; /*SET OFFSET OF TEXT      Y02669*/
         STH   @06,TEXTSOST+24                                     0245
*                     TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*PUT IN   Y02669*/
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            0246
*                                  /*RETURN CODE               Y02669*/
*                                                                  0247
*                     IF LWPUSERL ^=0  /*IF USERID IS KNOWN, @Z40NQKC*/
*                       THEN       /* THEN POINT TO USERID SEG Y02669*/
         L     @15,PTRBUF(,PRMPNTR)                                0247
         CH    @06,LWPUSERL(,@15)                                  0247
         BE    @RF00247                                            0247
*                         TEXTINT1(3)=ADDR(LWPUSERI);      /*@Z40NQKC*/
         LA    @06,LWPUSERI(,@15)                                  0248
         ST    @06,TEXTINT1+8(,@05)                                0248
*                                  /*ELSE USERID IS UNKNOWN    Y02669*/
*                     ELSE TEXTINT1(3)=0;                    /*Y02669*/
*                                                                  0249
         B     @RC00247                                            0249
@RF00247 L     @06,PTRIOLST(,PRMPNTR)                              0249
         L     @06,SEGS1PTR(,@06)                                  0249
         SLR   @05,@05                                             0249
         ST    @05,TEXTINT1+8(,@06)                                0249
*                     IF LWPPROCL ^=0  /*IF PROCNAME KNOWN   @Z40NQKC*/
*                       THEN      /*THEN POINT TO PROC SGMENT  Y02669*/
@RC00247 L     @06,PTRBUF(,PRMPNTR)                                0250
         LH    @05,LWPPROCL(,@06)                                  0250
         LTR   @05,@05                                             0250
         BZ    @RF00250                                            0250
*                         TEXTINT1(4)=ADDR(LWPPROCI);      /*@Z40NQKC*/
         L     @05,PTRIOLST(,PRMPNTR)                              0251
         L     @05,SEGS1PTR(,@05)                                  0251
         LA    @06,LWPPROCI(,@06)                                  0251
         ST    @06,TEXTINT1+12(,@05)                               0251
*                                  /*ELSE PROC IS UNKNOWN      Y02669*/
*                     ELSE TEXTINT1(4)=0;                    /*Y02669*/
*                                                                  0252
         B     @RC00250                                            0252
@RF00250 L     @06,PTRIOLST(,PRMPNTR)                              0252
         L     @06,SEGS1PTR(,@06)                                  0252
         SLR   @05,@05                                             0252
         ST    @05,TEXTINT1+12(,@06)                               0252
*                     SAVEPTR=SAVED13; /*RESTORE SAVE AREA PTR Y02669*/
@RC00250 L     SAVEPTR,SAVED13                                     0253
*                     R14=SAVED14; /*RESTORE REG14             Y02669*/
         L     R14,SAVED14                                         0254
*                     GO TO TERMMSG; /*PUT OUT ERROR MSG       Y02669*/
*                                                                  0255
         B     TERMMSG                                             0255
*CONTINUE:          SAVEPTR=SAVED13;/*RESTORE SAVE AREA PTR    Y02669*/
CONTINUE L     SAVEPTR,SAVED13                                     0256
*                   R14=SAVED14;   /*RESTORE REG 14            Y02669*/
         L     R14,SAVED14                                         0257
*                END;                                         /*Y02669*
*                                                                  0258
*             RESPECIFY (PARMPTR) RSTD;                       /*Y02669*
@RF00199 DS    0H                                                  0260
*             PARMPTR=PRSANS;      /*POINT TO PDL TO BE FREED   Y02669*
         L     PARMPTR,PRSANS                                      0260
*             GEN(IKJRLSA (PARMPTR));   /* FREE PDL             Y02669*
         IKJRLSA (PARMPTR)
*             RESPECIFY (PARMPTR) UNRSTD;                     /*Y02669*
*            END;                  /* END OF NOT VTAM CLEANUP @Z40DQKU*
*             GO TO DISCO;         /* TELL E TO DISCONNECT TERM Y02669*
         B     DISCO                                               0264
*             RESPECIFY (PDLBASE,PDEPTR) UNRSTD;              /*Y02669*
*           END;                                              /*Y02669*
*                                                                  0266
*   /*****************************************************************/
*/* IF COMMAND IS LOGON, RETURN TO IKJEFLE TO PERFORM FURTHER        */
*/* PROCESSING OF INPUT LINE.                                        */
*   /*****************************************************************/
*                                                                  0267
*   IF CNDLGTH = 5                /* IF COMMAND IS FIVE CHARACTERS 0267
*                                    LONG, IT MAY BE LOGON.          */
*     THEN                                                         0267
@RF00175 DS    0H                                                  0267
@RF00174 CLC   CNDLGTH(2),@CH00087                                 0267
         BNE   @RF00267                                            0267
*       IF COMNDNM(1:5) = 'LOGON' /* IF LOGON, GO TO PROCESS         */
*         THEN                                                     0268
         L     @08,CNDNAME                                         0268
         CLC   COMNDNM(5,@08),@CC01746                             0268
         BE    @RT00268                                            0268
*           RETURN;                                                0269
*                                                                  0269
*   /*****************************************************************/
*/*  IF COMMAND IS NEITHER LOGON NOR LOGOFF, SET UP COMMAND NOT      */
*/*  ACCEPTED MESSAGE.                                               */
*   /*****************************************************************/
*                                                                  0270
*   PMSGNM = 4;                   /* ISSUE COMMAND NOT ACCEPTED    0270
*                                    DURING LOGON MESSAGE.           */
*                                                                  0270
*                                                                  0270
@RF00267 LA    @08,4                                               0270
         L     @06,FUNCPTR(,PRMPNTR)                               0270
         STH   @08,PMSGNM(,@06)                                    0270
*   TEXTINT1(1) = ADDR(TEXTSEGS(1)); /* POINT TO TEXT INSERTION    0271
*                                    SEGMENT (COMMAND NAME WHICH IS
*                                    NOT ACCEPTED DURING LOGON).     */
         L     @06,PTRIOLST(,PRMPNTR)                              0271
         L     @06,SEGS1PTR(,@06)                                  0271
         LA    @15,TEXTSEGS                                        0271
         ST    @15,TEXTINT1(,@06)                                  0271
*   TEXTSLEN(1) = CNDLGTH + 4;    /* SET LENGTH OF COMMAND NAME    0272
*                                    PLUS LENGTH OF HEADER.          */
         AH    @08,CNDLGTH                                         0272
         STH   @08,TEXTSLEN                                        0272
*   TEXTSTXT(1,1:8) = COMNDNM;    /* MOVE COMMAND NAME TO TEXT     0273
*                                    INSERTION BUFFER.               */
         L     @08,CNDNAME                                         0273
         MVC   TEXTSTXT(8),COMNDNM(@08)                            0273
*   RESPECIFY (LENSTR,ADRSTR) RSTD;                                0274
*                                                                  0274
*CMNDMSG:                                                          0275
*                                                                  0275
*   /*****************************************************************/
*/*          FREE CORE OCCUPIED BY COMMAND BUFFER                    */
*   /*****************************************************************/
*                                                                  0275
*   LENSTR = CMNDLNG;             /* GET LENGTH OF BUFFER TO BE FREED*/
CMNDMSG  L     @08,PTRIOLST(,PRMPNTR)                              0275
         L     @08,PTRINBUF(,@08)                                  0275
         L     @08,INBUF(,@08)                                     0275
         LH    LENSTR,CMNDLNG(,@08)                                0275
*   ADRSTR = ADDR(CMNDLNG);       /* GET ADDRESS OF BUFFER TO      0276
*                                    BE FREED                        */
         LR    ADRSTR,@08                                          0276
*   GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=(ADRSTR)); /* FREE COMMAND   0277
*                                    BUFFER CORE.                    */
         FREEMAIN R,SP=1,LV=(LENSTR),A=(ADRSTR)
*   RESPECIFY (LENSTR,ADRSTR) UNRSTD;                              0278
*   INBUF = 0;                    /* INDICATE THAT THERE IS CURRENTLY
*                                    NO COMMAND BUFFER.              */
*                                                                  0279
         L     @08,PTRIOLST(,PRMPNTR)                              0279
         L     @08,PTRINBUF(,@08)                                  0279
         SLR   @06,@06                                             0279
         ST    @06,INBUF(,@08)                                     0279
*LOGONOFF:                                                         0280
*                                                                  0280
*   /*****************************************************************/
*   /*             PROMPT USER FOR LOGON/LOGOFF COMMAND              */
*   /*****************************************************************/
*                                                                  0280
*   RESPECIFY(PARMPTR) RSTD;                                       0280
LOGONOFF DS    0H                                                  0281
*   PARMPTR = ADDR(UPTPTR2);      /* GET ADDRESS OF MESSAGE MODULE'S
*                                    PARAMETER LIST.                 */
         L     PARMPTR,PTRIOLST(,PRMPNTR)                          0281
*   CALL IKJEFLGM;                /* CALL MESSAGE MODULE TO        0282
*                                    SEND MESSAGE AND GET INPUT    0282
*                                    FROM TERMINAL                   */
         L     @15,@CV00036                                        0282
         BALR  @14,@15                                             0282
*   RESPECIFY(PARMPTR) UNRSTD;                                     0283
*                                                                  0283
*                                                                  0283
*   IF RTNREG ^= 0                /* IF NOT SUCCESSFUL COMPLETION, 0284
*                                    I/O ERROR FROM MESSAGE MODULE.
*                                    TERMINATE THE SESSION.          */
*     THEN                                                         0284
         LTR   RTNREG,RTNREG                                       0284
         BNZ   @RT00284                                            0284
*       GOTO ERRLGM;                                               0285
*   GOTO SCANCMND;                /* GO TO CHECK COMMAND TYPE AND  0286
*                                    SYNTAX                          */
         B     SCANCMND                                            0286
*SETUPPRS:                                                         0287
*   /*****************************************************************/
*/*          INITIALIZE PARSE PARAMETER LIST                         */
*   /*****************************************************************/
*                                                                  0287
*   PRSPARM = IOPARM;             /* INITIALIZE UPT, ECT AND CANCEL
*                                    ECB ADDRESS                     */
SETUPPRS L     @08,PTRIOLST(,PRMPNTR)                              0287
         MVC   PRSPARM(12),IOPARM(@08)                             0287
*   PRSANS = ADDR(PRSPDL);        /* INITIALIZE POINTER TO ANS     0288
*                                     POINTER                        */
         LA    @06,PRSPDL                                          0288
         ST    @06,PRSANS                                          0288
*   PRSBUF = INBUF;               /* INITIALIZE POINTER TO COMMAND 0289
*                                    BUFFER.                         */
*                                                                  0289
         L     @08,PTRINBUF(,@08)                                  0289
         MVC   PRSBUF(4),INBUF(@08)                                0289
*   SAV10 = R10;                  /*SAVE REG 10 FOR VAL CHECK  Y02669*/
         ST    R10,SAV10                                           0290
*   SAV11 = R11;                  /*SAVE REG 11 FOR VAL CHECK  Y02669*/
         ST    R11,SAV11                                           0291
*   SAV12 = R12;                  /*SAVE REG 12 FOR VAL CHECK  Y02669*/
         ST    R12,SAV12                                           0292
*   PRSWKA=ADDR(SAVREGS);         /*POINT TO WORK AREA         Y02669*/
*                                                                  0293
         LA    @08,SAVREGS                                         0293
         ST    @08,PRSWKA                                          0293
*   IF PTYPE = 2                  /* IF WE ARE BEING ENTERED FOR   0294
*                                    ENTRY POINT PROMPT1,          0294
*                                    BRANCH TO IT                    */
*     THEN                                                         0294
         L     @08,FUNCPTR(,PRMPNTR)                               0294
         LH    @06,PTYPE(,@08)                                     0294
         CH    @06,@CH00197                                        0294
         BE    @RT00294                                            0294
*       GOTO PROMPT1;                                              0295
*                                                                  0295
*                                                                  0295
*   IF PTYPE = 1                  /* IF ENTERED FOR PROMPT OF USER 0296
*                                    AND PARSE OF LINE, GO TO      0296
*                                    'PROMPT'                        */
*     THEN                                                         0296
         CH    @06,@CH00032                                        0296
         BE    @RT00296                                            0296
*       GOTO PROMPT;                                               0297
*                                                                  0297
*                                                                  0297
*    IF PTYPE = 5                 /* IF ENTERED TO BUILD JCLS,     0298
*                                    GO TO BUILD THEM.               */
*     THEN                                                         0298
         LA    @15,5                                               0298
         CR    @06,@15                                             0298
         BE    @RT00298                                            0298
*       GOTO BUILDJCL;                                             0299
*                                                                  0299
*   /*****************************************************************/
*   /*    IF WE ARE NOT BEING ENTERED FOR ONE OF FIVE SUPPORTED      */
*   /*    FUNCTIONS, MODULE IKJEFLE HAS SUPPLIED BAD PARAMETERS      */
*   /*****************************************************************/
*                                                                  0300
*   RTNCODE = 12;                 /* GIVE CALLER BAD PARAMETERS    0300
*                                    RETURN CODE.                    */
         L     @06,BACKPTR(,SAVEPTR)                               0300
         MVC   RTNCODE(4,@06),@CF00034                             0300
*   PTYPE =  5;                   /* INDICATE MODULE IKJEFLEA GAVE 0301
*                                    BAD PARAMETERS RETURN CODE.     */
         STH   @15,PTYPE(,@08)                                     0301
*   RETURN;                                                        0302
*                                                                  0302
         B     @EL00001                                            0302
*   /*****************************************************************/
*   /*     PROMPT ENTRY POINT:                                       */
*   /*                                                               */
*   /*     USED WHEN MODULE IKJEFLE NEEDS A LOGON PARAMETER WHICH    */
*   /*     EITHER HASNOT BEEN SUPPLIED BUT IS NEEDED OR HAS BEEN     */
*   /*     SUPPLIED BUT IS NOT AUTHORIZED.                           */
*   /*     TWO CHECKS ARE MADE BEFORE GOING TO THE TERMINAL USER FOR */
*   /*     INFORMATION:                                              */
*   /*     1.  IF THE INSTALLATION SUPPLIED (OR DID NOT SUPPLY)      */
*   /*         THE INFORMATION, THE TERMINAL SESSION IS              */
*   /*         TERMINATED AFTER SENDING AN ERROR MESSAGE, AND        */
*   /*     2.  IF THE USER HAS BEEN PROMPTED THE MAXIMUM NUMBER OF   */
*   /*         TIMES ALLOWED BY THE INSTALLATION, THE SESSION WILL   */
*   /*         BE TERMINATED AFTER SENDING AN ERROR MESSAGE.         */
*   /*****************************************************************/
*                                                                  0303
*                                                                  0303
*PROMPT:                                                           0303
*                                                                  0303
*                                                                  0303
*                                                                  0303
*   IF LWANOPR = '1'B             /* IF INSTALLATION SUPPLIED      0303
*                                    PARAMETERS AND IT IS NECESSARY TO
*                                    PROMPT USER, THE INSTALLTION MADE
*                                    AN ERROR.                       */
*     THEN                                                         0303
PROMPT   TM    LWANOPR(LWAPTR),B'00001000'                         0303
         BNO   @RF00303                                            0303
*       DO;                                                        0304
*         PMSGNM = 21;            /* SET MESSAGE NUMBER TO INSTAL- 0305
*                                    LATION EXIT ERROR MESSAGE       */
         L     @08,FUNCPTR(,PRMPNTR)                               0305
         MVC   PMSGNM(2,@08),@CH01755                              0305
*         TEXTINT1(1) = ADDR(TEXTSEGS(1)); /* GET ADDRESS OF       0306
*                                    INSTALLATION ERROR TEXT       0306
*                                    INSERTION BUFFER.               */
         L     @06,PTRIOLST(,PRMPNTR)                              0306
         L     @06,SEGS1PTR(,@06)                                  0306
         LA    @15,TEXTSEGS                                        0306
         ST    @15,TEXTINT1(,@06)                                  0306
*         TEXTSLEN(1) = 14;       /* LENGTH OF TEXT TO BE INSERTED 0307
*                                    PLUS LENGTH OF HEADER.    Y02669*/
         MVC   TEXTSLEN(2),@CH01756                                0307
*         TEXTSTXT(1,1:10) = 'TERMINATED'; /*SET UP FIRST      Y02669*/
         MVC   TEXTSTXT(10),@CC01757                               0308
*                                 /* TEXT INSERT               Y02669*/
*         TEXTINT1(2) = ADDR(TEXTSEGS(2)); /* GET ADDRESS OF   Y02669*/
         LA    @15,TEXTSEGS+24                                     0309
         ST    @15,TEXTINT1+4(,@06)                                0309
*                                 /*SECOND TEXT INSERT         Y02669*/
*         TEXTSLEN(2) = 9;        /* LENGTH OF TEXT TO BE INSERTED 0310
*                                    PLUS LENGTH OF HEADER.    Y02669*/
         MVC   TEXTSLEN+24(2),@CH01759                             0310
*         TEXTSTXT(2,1:5) = 'ERROR'; /*SET UP SECOND           Y02669*/
         MVC   TEXTSTXT+24(5),@CC01760                             0311
*                                 /* TEXT INSERT               Y02669*/
*         TEXTINT1(3) = ADDR(TEXTSEGS(3)); /* GET ADDRESS OF       0312
*                                    INSTALLATION EXIT ERROR NUMBER
*                                    BUFFER. TEXT INSERTION    Y02669*/
         LA    @15,TEXTSEGS+48                                     0312
         ST    @15,TEXTINT1+8(,@06)                                0312
*         TEXTSLEN(3) = 7;        /* LENGTH OF TEXT TO BE INSERTED 0313
*                                    PLUS LENGTH OF HEADER.    Y02669*/
         MVC   TEXTSLEN+48(2),@CH00146                             0313
*         TEXTSTXT(3,1:3) = INSTERR(PRMTSWC); /* INDICATE INSTALLATION
*                                    EXIT ERROR NUMBER         Y02669*/
         LH    @08,PRMTSWC(,@08)                                   0314
         MH    @08,@CH00136                                        0314
         LA    @06,INSTERR-3(@08)                                  0314
         MVC   TEXTSTXT+48(3),0(@06)                               0314
*         GOTO TERMMSG;           /* GOTO SEND ERROR MESSAGE         */
         B     TERMMSG                                             0315
*       END;                                                       0316
*                                                                  0316
*                                                                  0316
*   PTRYS = PTRYS + 1;            /* INCREMENT NUMBER OF TRYS WE   0317
*                                    HAVE PROMPTED USER BY ONE.      */
@RF00303 L     @08,FUNCPTR(,PRMPNTR)                               0317
         LA    @06,1                                               0317
         AL    @06,PTRYS(,@08)                                     0317
         ST    @06,PTRYS(,@08)                                     0317
*   IF PTRYS >  LP0PRMT           /* IF THE NUMBER OF TIMES WE HAVE
*                                    PROMPTED FOR A VALID LOGON    0318
*                                    COMMAND EXCEEDS THE MAXIMUM   0318
*                                    NUMBER ESTABLISHED AT SUBSYSGEN
*                                    TIME, TERMINATE USER    @ZA26226*/
*     THEN                                                         0318
         L     @08,@CV00037                                        0318
         C     @06,LP0PRMT(,@08)                                   0318
         BNH   @RF00318                                            0318
*       DO;                                                        0319
*MAXPRMPT:                                                         0320
*          PMSGNM = 23;           /* SET MESSAGE NUMBER TO TOO MANY
*                                    ATTEMPTS MESSAGE.               */
MAXPRMPT L     @08,FUNCPTR(,PRMPNTR)                               0320
         MVC   PMSGNM(2,@08),@CH01762                              0320
*         TEXTINT1(1) = ADDR(LWPUSERI); /* GET ADDRESS       @Z40NQKC
*                                    INSERTION BUFFER.               */
*                                                                  0321
         L     @08,PTRIOLST(,PRMPNTR)                              0321
         L     @08,SEGS1PTR(,@08)                                  0321
         L     @06,PTRBUF(,PRMPNTR)                                0321
         LA    @06,LWPUSERI(,@06)                                  0321
         ST    @06,TEXTINT1(,@08)                                  0321
*TERMMSG:                                                          0322
*                                                                  0322
*                                                                  0322
*         RESPECIFY(PARMPTR) RSTD;                                 0322
TERMMSG  DS    0H                                                  0323
*         ECBPTR = ADDR(DUMMYECB);                                 0323
         L     @08,PTRIOLST(,PRMPNTR)                              0323
         LA    @06,DUMMYECB                                        0323
         ST    @06,ECBPTR(,@08)                                    0323
*         PARMPTR = ADDR(UPTPTR2);/* GET ADDRESS OF MESSAGE MODULE'S
*                                    PARAMETER LIST.                 */
         LR    PARMPTR,@08                                         0324
*         CALL IKJEFLGM;          /* CALL MESSAGE MODULE TO        0325
*                                    SEND MESSAGE TO TERMINAL.       */
         L     @15,@CV00036                                        0325
         BALR  @14,@15                                             0325
*         RESPECIFY(PARMPTR) UNRSTD;                               0326
*         GOTO DISCO;             /* RETURN TO SET RETURN CODE TO  0327
*                                    TWENTY AND CLEAN UP RESOURCES.  */
         B     DISCO                                               0327
*       END;                                                       0328
*                                                                  0328
*   /*****************************************************************/
*   /*  IN ALL CASES WHERE A LOGON PARAMETER IS NEEDED , THE         */
*   /*  FOLLOWING BUFFER WILL BE CONSTRUCTED:                        */
*   /*                                                               */
*   /*     × 24 × 0 ×  USERID / PASSWORD  XXX ×                      */
*   /*     ×____×___×_________________________×                      */
*   /*                                                               */
*   /*       WHERE:                                                  */
*   /*         24 - LENGTH OF BUILD BUFFER                           */
*   /*         0 - OFFSET OF BUILD BUFFER                            */
*   /*         USERID - USERID ALREADY SUPPLIED AND AUTHORIZED.      */
*   /*            BLANK IF PROMPT FOR USERID.                        */
*   /*         /  - PLACED IN BUFFER FOR PROMPT OF PASSWORD OR       */
*   /*            PROMPT OF KEYWORD PARAMETERS AND NON-NULL          */
*   /*            PASSWORD                                           */
*   /*         PASSWORD - PLACED IN BUFFER FOR PROMPT OF KEYWORD     */
*   /*            PARAMETERS AND IF PASSWORD NONE NULL.              */
*   /*         XXX- AC(IF PROMPT FOR ACCOUNT NUMBER,                 */
*   /*            PR(IF PROMPT FOR PROCEDURE NAME,                   */
*   /*            SI(IF PROMPT FOR REGION SIZE, OR                   */
*   /*            PE( IF PROMPT FOR PERFORMANCE GROUP                */
*   /*            OTHERWISE, LEFT BLANK.                             */
*   /*                                                               */
*   /*                                                               */
*   /*  IN THOSE CASES WHERE PROMPT IS FOR A PARAMETER WHICH IS      */
*   /*  NOT AUTHORIZED, THE ABOVE BUILD BUFFER WILL BE               */
*   /*  CONCATINATED WITH THE INPUT LINE OBTAINED FROM THE TERMINAL. */
*   /*  THE BUFFER BUILT WILL LOOK AS FOLLOWS:                       */
*   /*                                                               */
*   /*     × LEN × 0 ×    BUILD BUFFER         ×   INPUT LINE  ×     */
*   /*     ×_____×___×_________________________×_______________×     */
*   /*                                                               */
*   /*       WHERE:                                                  */
*   /*         LEN - 24 + LENGTH OF TEXT PORTION OF LINE OBTAINED    */
*   /*            FROM TERMINAL                                      */
*   /*         0 - OFFSET OF BUFFER                                  */
*   /*         BUILD BUFFER - AS DESCRIBED ABOVE.                    */
*   /*         INPUT LINE - TEXT PORTION OF LINE OBTAINED FROM       */
*   /*            TERMINAL. NONE EXISTENT IF LINE OBTAINED IS        */
*   /*            NULL                                               */
*   /*****************************************************************/
*                                                                  0329
*                                                                  0329
*   /*****************************************************************/
*/*          GET CORE FOR BUILD BUFFER AND INITIALIZE                */
*   /*****************************************************************/
*   GEN(GETMAIN R,SP=1,LV=33);    /* GET CORE FOR BUILD BUFFER       */
@RF00318 DS    0H                                                  0329
         GETMAIN R,SP=1,LV=33
*   RESPECIFY (NULLBUF) RSTD;                                      0330
*   NULLBUF = GTMNPTR;            /* SAVE ADDRESS OF BUILD BUFFER    */
         LR    NULLBUF,GTMNPTR                                     0331
*   NULLBUF->CMNDLNG = 33;        /* SET LENGTH OF BUILD BUFFER      */
         MVC   CMNDLNG(2,NULLBUF),@CH01765                         0332
*   NULLBUF->CMNDOFST = 0;        /* SET OFFSET OF BUILD BUFFER TO 0 */
         SLR   @06,@06                                             0333
         STH   @06,CMNDOFST(,NULLBUF)                              0333
*   NULLBUF->CMNDTEXT(1:29) = ''; /* SET TEXT PORTION OF BUILD     0334
*                                    BUFFER TO BLANKS                */
*                                                                  0334
*                                                                  0334
         MVI   CMNDTEXT(NULLBUF),C' '                              0334
         MVC   CMNDTEXT+1(28,NULLBUF),CMNDTEXT(NULLBUF)            0334
*   IF PRMTSWC = 1                /* IF PROMPT IS FOR USERID, LEAVE
*                                    BUILD BUFFER BLANK.             */
*     THEN                                                         0335
         L     @06,FUNCPTR(,PRMPNTR)                               0335
         LH    @06,PRMTSWC(,@06)                                   0335
         CH    @06,@CH00032                                        0335
         BE    @RT00335                                            0335
*       GOTO REENTER;             /* GO TO GET NEW USERID FROM USER  */
*                                                                  0336
*   /*****************************************************************/
*/*          PLACE USERID INTO BUILD BUFFER                          */
*   /*****************************************************************/
*                                                                  0337
*   NULLBUF->CMNDTEXT(1:7) = LWPUSER; /* MOVE USERID TO BUFF @Z40NQKC*/
*                                                                  0337
*                                                                  0337
         L     @01,PTRBUF(,PRMPNTR)                                0337
         MVC   CMNDTEXT(7,NULLBUF),LWPUSER(@01)                    0337
*   IF PRMTSWC = 2                /* IF PROMPT IS FOR PASSWORD,    0338
*                                    PLACE '/' INTO BUILD BUFFER.    */
*     THEN                                                         0338
         CH    @06,@CH00197                                        0338
         BNE   @RF00338                                            0338
*       DO;                                                        0339
*         NULLBUF->CMNDTEXT(8) = '/';                              0340
         MVI   CMNDTEXT+7(NULLBUF),C'/'                            0340
*         GOTO REENTER;           /* GO TO GET NEW PASSWORD.         */
         B     REENTER                                             0341
*       END;                                                       0342
*                                                                  0342
*                                                                  0342
*   IF LWPPSWDL ^= 0               /* IF PASSWORD            @Z40NQKC
*                                    PLACE '/PASSWORD' INTO        0343
*                                    BUILD BUFFER                    */
*     THEN                                                         0343
@RF00338 L     @06,PTRBUF(,PRMPNTR)                                0343
         LH    @15,LWPPSWDL(,@06)                                  0343
         LTR   @15,@15                                             0343
         BZ    @RF00343                                            0343
*       DO;                                                        0344
*         NULLBUF->CMNDTEXT(8) = '/';                              0345
         MVI   CMNDTEXT+7(NULLBUF),C'/'                            0345
*         NULLBUF->CMNDTEXT(9:16) = LWPPSWD; /* PLACE PSWD   @Z40NQKC
*                                    BUILD BUFFER*/                0346
         MVC   CMNDTEXT+8(8,NULLBUF),LWPPSWD(@06)                  0346
*       END;                                                       0347
*   NULLBUF->CMNDTEXT(18:20) = FORCEP(PRMTSWC-2); /* PLACE 'AC(' FOR
*                                    PROMPT OF ACCOUNT, 'PR(' FOR  0348
*                                    PROMPT OF PROCEDURE, 'SI('    0348
*                                    FOR SIZE,                     0348
*                                    AND 'PE(' FOR PERFORM     Y02669
*                                    AND '/  ' FOR NEW-PSWD  @Z40RQKC
*                                    INTO BUILD BUFFER         Y02669*/
@RF00343 L     @06,FUNCPTR(,PRMPNTR)                               0348
         LH    @06,PRMTSWC(,@06)                                   0348
         MH    @06,@CH00136                                        0348
         LA    @01,FORCEP-9(@06)                                   0348
         MVC   CMNDTEXT+17(3,NULLBUF),0(@01)                       0348
*REENTER:                                                          0349
*                                                                  0349
*                                                                  0349
*   IF PMSGNM = 0                 /* IF HERE TO GET PARAMETER WHICH
*                                    HAS NOT BEEN ENTERED BEFORE,  0349
*                                    DONOT PROMPT USER               */
*     THEN                                                         0349
REENTER  L     @06,FUNCPTR(,PRMPNTR)                               0349
         LH    @06,PMSGNM(,@06)                                    0349
         LTR   @06,@06                                             0349
         BNZ   @RF00349                                            0349
*       DO;                                                        0350
*         INBUF = NULLBUF;        /* POINT TO BUILD BUFFER FOR PARSE */
         L     @06,PTRIOLST(,PRMPNTR)                              0351
         L     @06,PTRINBUF(,@06)                                  0351
         ST    NULLBUF,INBUF(,@06)                                 0351
*         GOTO PROMPT1;           /* GO TO PROMPT IN PARSE           */
         B     PROMPT1                                             0352
*       END;                                                       0353
*   ELSE                                                           0354
*     IF PMSGNM = 40 THEN         /* PASSWORD REQ'D DONOT PROMPT     */
@RF00349 L     @06,FUNCPTR(,PRMPNTR)                               0354
         CLC   PMSGNM(2,@06),@CH00260                              0354
         BNE   @RF00354                                            0354
*       DO;                       /* LET PARSE PROMPT INSTEAD@ZM44467*/
*         RESPECIFY(PARMPTR) RSTD;                                 0356
*         PARMPTR = ADDR(UPTPTR2);/* GET ADDRESS OF MESSAGE MODULE'S
*                                    PARAMETER LIST.         @ZM44467*/
         L     PARMPTR,PTRIOLST(,PRMPNTR)                          0357
*         CALL IKJEFLGM;          /* CALL MESSAGE MODULE TO        0358
*                                    SEND MESSAGE            @ZM44467*/
         L     @15,@CV00036                                        0358
         BALR  @14,@15                                             0358
*         RESPECIFY(PARMPTR) UNRSTD;                               0359
*         IF RTNREG ^= 0 THEN     /* IF NOT SUCCESSFUL RETURN, SET 0360
*                                    RETURN CODE TO MESSAGE MODULE'S
*                                    RETURN CODE AND EXIT.   @ZM44467*/
         LTR   RTNREG,RTNREG                                       0360
         BNZ   @RT00360                                            0360
*             GOTO ERRLGM;        /*                         @ZM44467*/
*         INBUF = NULLBUF;        /* POINT TO BUILD BUF      @ZM44467*/
         L     @06,PTRIOLST(,PRMPNTR)                              0362
         L     @06,PTRINBUF(,@06)                                  0362
         ST    NULLBUF,INBUF(,@06)                                 0362
*         GOTO PROMPT1;           /* GOTO PROMPT IN PARSE    @ZM44467*/
         B     PROMPT1                                             0363
*       END;                      /*                         @ZM44467*/
*                                                                  0364
*   /*****************************************************************/
*   /*  IF PROMPT IS FOR A PARAMETER THAT HAS BEEN PREVIOUSLY        */
*   /*  ENTERED BUT IS UNAUTHORIZED, ISSUE UNAUTHORIZED MESSAGE AND  */
*   /*  ASK USER TO REENTER PARAMETER. CONCATENATE LINE OBTAINED     */
*   /*  FROM USER AT END OF BUILD BUFFER.                            */
*   /*****************************************************************/
*                                                                  0365
*   RESPECIFY(PARMPTR) RSTD;                                       0365
@RF00354 DS    0H                                                  0366
*   PARMPTR = ADDR(UPTPTR2);      /* GET ADDRESS OF MESSAGE MODULE'S
*                                    PARAMETER LIST.                 */
         L     PARMPTR,PTRIOLST(,PRMPNTR)                          0366
*   CALL IKJEFLGM;                /* CALL MESSAGE MODULE TO        0367
*                                    SEND MESSAGE AND GET INPUT.     */
         L     @15,@CV00036                                        0367
         BALR  @14,@15                                             0367
*   RESPECIFY(PARMPTR) UNRSTD;                                     0368
*   IF RTNREG ^= 0                /* IF NOT SUCCESSFUL RETURN,     0369
*                                    SET RETURN CODE TO MESSAGE    0369
*                                    MODULE'S RETURN CODE AND EXIT.  */
*     THEN                                                         0369
         LTR   RTNREG,RTNREG                                       0369
         BNZ   @RT00369                                            0369
*       GOTO ERRLGM;                                               0370
*   RESPECIFY (LENSTR) RSTD;                                       0371
*                                                                  0371
*                                                                  0371
*   IF CMNDLNG = 4                /* IF LINE OBTAINED IS NULL,     0372
*                                    NO NEED FOR CONCATENATION.      */
*     THEN                                                         0372
         LA    @06,4                                               0372
         L     @05,PTRIOLST(,PRMPNTR)                              0372
         L     @05,PTRINBUF(,@05)                                  0372
         L     @15,INBUF(,@05)                                     0372
         CH    @06,CMNDLNG(,@15)                                   0372
         BNE   @RF00372                                            0372
*       DO;                                                        0373
*         RESPECIFY (FREELEN,ADRSTR) RSTD;                         0374
*         FREELEN = 4;            /* NULL BUFFER IS 4 BYTES LONG     */
         ST    @05,@TF00001                                        0375
         LR    FREELEN,@06                                         0375
*         ADRSTR = INBUF;         /* GET ADDRESS OF NULL BUFFER      */
         LR    ADRSTR,@15                                          0376
*         INBUF = NULLBUF;        /* POINT TO BUILD BUFFER FOR PARSE */
         L     @06,@TF00001                                        0377
         ST    NULLBUF,INBUF(,@06)                                 0377
*         IF PRMTSWC=6            /*IF PROMPT WAS FOR          Y02669*/
*           THEN                  /*PERFORM GROUP              Y02669*/
         L     @06,FUNCPTR(,PRMPNTR)                               0378
         CLC   PRMTSWC(2,@06),@CH00218                             0378
         BNE   @RF00378                                            0378
*             NOPERFRM='1'B;      /*DON'T PROMPT AGAIN -       Y02669*/
         OI    NOPERFRM,B'00100000'                                0379
*                                /*RETURN TO LE WITH NOPERFORM Y02669*/
*                                                                  0380
*         GOTO FREINBUF;          /* GO TO FREE CORE OCCUPIED BY   0380
*                                    NULL INPUT BUFFER               */
         B     FREINBUF                                            0380
*         RESPECIFY (FREELEN,ADRSTR) UNRSTD;                       0381
*       END;                                                       0382
*                                                                  0382
*   /*****************************************************************/
*/*          PERFORM CONCATENATION OF BUFFERS                        */
*   /*****************************************************************/
*                                                                  0383
*   LENSTR = CMNDLNG + 20;        /* GET LENGTH OF BUFFER NEEDED TO
*                                    PERFORM CONCATENATION           */
@RF00372 L     @06,PTRIOLST(,PRMPNTR)                              0383
         L     @06,PTRINBUF(,@06)                                  0383
         L     @06,INBUF(,@06)                                     0383
         LA    LENSTR,20                                           0383
         AH    LENSTR,CMNDLNG(,@06)                                0383
*   GEN(GETMAIN R,SP=1,LV=(LENSTR)); /* GET CORE FOR BUFFER.         */
         GETMAIN R,SP=1,LV=(LENSTR)
*   RESPECIFY (GTMNPTR) RSTD;                                      0385
*                                                                  0385
*   GTMNPTR->CMNDLNG = LENSTR;    /* SET LENGTH OF NEW BUFFER        */
*                                                                  0386
         STH   LENSTR,CMNDLNG(,GTMNPTR)                            0386
*   GTMNPTR->CMNDOFST = 0;        /* SET OFFSET TO ZERO.             */
         SLR   @06,@06                                             0387
         STH   @06,CMNDOFST(,GTMNPTR)                              0387
*   GTMNPTR->CMNDTEXT(1:20) = NULLBUF->CMNDTEXT(1:20); /* MOVE     0388
*                                    BUILD BUFFER TO NEW BUFFER */ 0388
         MVC   CMNDTEXT(20,GTMNPTR),CMNDTEXT(NULLBUF)              0388
*   LENSTR = CMNDLNG - 4;         /* LENGTH OF TEXT PORTION ONLY   0389
*                                    IN USER'S RESPONSE              */
         LA    @06,4                                               0389
         L     @15,PTRIOLST(,PRMPNTR)                              0389
         L     @15,PTRINBUF(,@15)                                  0389
         L     @14,INBUF(,@15)                                     0389
         LH    LENSTR,CMNDLNG(,@14)                                0389
         SLR   LENSTR,@06                                          0389
*   GTMNPTR->CMNDTEXT(21:LENSTR+20) = CMNDTEXT;                    0390
*                                                                  0390
         LR    @05,LENSTR                                          0390
         BCTR  @05,0                                               0390
         EX    @05,@SM01863                                        0390
*   /*****************************************************************/
*/*          FREE CORE OCCUPIED BY BUILD BUFFER                      */
*   /*****************************************************************/
*                                                                  0391
*   RESPECIFY (FREELEN,PDEPTR,ADRSTR) RSTD;                        0391
*   FREELEN = LENSTR + 4;         /* GET LENGTH OF USER RESPONSE.    */
         ALR   @06,LENSTR                                          0392
         LR    FREELEN,@06                                         0392
*   PDEPTR = GTMNPTR;             /* SAVE POINTER TO CONCATENATED  0393
*                                    BUFFER.                         */
         LR    PDEPTR,GTMNPTR                                      0393
*   RESPECIFY (GTMNPTR) UNRSTD;                                    0394
*   ADRSTR = ADDR(CMNDLNG);                                        0395
         LR    ADRSTR,@14                                          0395
*   INBUF = PDEPTR;               /* SAVE ADDRESS OF COMMAND BUFFER. */
         ST    PDEPTR,INBUF(,@15)                                  0396
*   GEN(FREEMAIN  R,SP=1,LV=24,A=(NULLBUF)); /* FREE CORE          0397
*                                    OCCUPIED BY BUILD BUFFER        */
*                                                                  0397
         FREEMAIN  R,SP=1,LV=24,A=(NULLBUF)
*   /*****************************************************************/
*/*           FREE CORE OCCUPIED BY INPUT BUFFER                     */
*   /*****************************************************************/
*                                                                  0398
*FREINBUF:                                                         0398
*   GEN(FREEMAIN R,SP=1,LV=(FREELEN),A=(ADRSTR)); /* FREE THE      0398
*                                    BUFFER HE GAVE US.              */
FREINBUF FREEMAIN R,SP=1,LV=(FREELEN),A=(ADRSTR)
*   RESPECIFY (PDEPTR,LENSTR,FREELEN,ADRSTR,NULLBUF) UNRSTD;       0399
*                                                                  0399
*    IF NOPERFRM='1'B             /*IF PROMPT FOR PERFORM      Y02669*/
*      THEN                       /*GROUP WAS NULL, RETURN     Y02669*/
         TM    NOPERFRM,B'00100000'                                0400
         BO    @RT00400                                            0400
*        RETURN;                  /*TO IKJEFLE                 Y02669*/
*                                                                  0401
*PROMPT1:                                                          0402
*                                                                  0402
*   /*****************************************************************/
*   /*  SET UP COMMAND BUFFER ADDRESS AND LINK TO PARSE              */
*   /*  ON RETURN FROM PARSE, CHECK THE RETURN CODE TO DETERMINE     */
*   /*  IF PARSE WAS SUCCESSFUL. IF UNSUCCESSFUL, RETURN TO IKJEFLE. */
*   /*  IF SUCCESSFUL, TRANSCRIBE ALL PARAMETERS SUPPLIED FROM PDL   */
*   /*  TO BUFFER SUPPLIED BY IKJEFLE.                               */
*   /*****************************************************************/
*                                                                  0402
*   PRSBUF = INBUF;               /* INITIALIZE COMMAND BUFFER     0402
*                                    ADDRESS FOR PARSE.              */
PROMPT1  L     @08,PTRIOLST(,PRMPNTR)                              0402
         L     @08,PTRINBUF(,@08)                                  0402
         MVC   PRSBUF(4),INBUF(@08)                                0402
*   PRSPCL = ADDR(IKJEFLE1);      /* GET ADDRESS OF APPROPRIATE PCL  */
         L     @08,@CV00065                                        0403
         ST    @08,PRSPCL                                          0403
*   PARMPTR = ADDR(PARSELST);     /* SET REGISTER ONE TO ADDRESS OF
*                                    PARSE'S PARAMETER LIST.         */
         LA    PARMPTR,PARSELST                                    0404
*   DO; /*CALLTSSR EP(IKJPARS)*/                                   0405
*     RESPECIFY GPR01P RSTD;                                       0406
*     IF CVTPARS = 0                                               0407
*       THEN                                                       0407
         L     @08,CVTPTR                                          0407
         L     @08,CVTPARS(,@08)                                   0407
         LTR   @08,@08                                             0407
         BNZ   @RF00407                                            0407
*         GEN(LINK EP=IKJPARS);                                    0408
         LINK EP=IKJPARS
*       ELSE                                                       0409
*         CALL CVTPARS;                                            0409
         B     @RC00407                                            0409
@RF00407 L     @08,CVTPTR                                          0409
         L     @15,CVTPARS(,@08)                                   0409
         BALR  @14,@15                                             0409
*     RESPECIFY GPR01P UNRSTD;                                     0410
@RC00407 DS    0H                                                  0411
*   END;        /* LINK TO PARSE SERVICE ROUTINE.  */              0411
*   RESPECIFY (SVRTN) RSTD;                                        0412
*   SVRTN = RTNREG;               /* SAVE RETURN CODE FROM PARSE.    */
         LR    SVRTN,RTNREG                                        0413
*   IF SVRTN ^= 0                 /* IF NOT SUCCESSFUL COMPLETION BY
*                                    PARSE, GOTO CLEANUP PDL AND   0414
*                                    COMMAND BUFFER, THEN RETURN TO
*                                    TERMINATE SESSION.              */
*     THEN                                                         0414
         LTR   SVRTN,SVRTN                                         0414
         BNZ   @RT00414                                            0414
*       GOTO ENDPRSER;                                             0415
*   RESPECIFY (SVRTN) UNRSTD;                                      0416
*                                                                  0416
*                                                                  0416
*   /*****************************************************************/
*   /*  IF PROMPTING FOR USERID OR PASSWORD, ALL OTHER PARAMETERS    */
*   /*    (ACCOUNT NUMBER, PROCEDURE NAME, REGION SIZE, PERFORMANCE  */
*   /*    GROUP, DEST USERID, MAIL AND NOTICES AND RECONNECT) MAY    */
*   /*    BE ENTERED AND WILL BE RECORDED.                           */
*   /*  ONCE THE TWO POSITIONALS HAVE BEEN AUTHORIZED, ONLY THE      */
*   /*    KEYWORD PARAMETERS WILL BE ACCEPTED                        */
*   /*****************************************************************/
*                                                                  0417
*   RESPECIFY (PDLBASE,PDEPTR) RSTD;                               0417
*   PDLBASE = PRSPDL;             /* LOAD BASE REGISTER FOR        0418
*                                    CURRENT PDL.                    */
         L     PDLBASE,PRSPDL                                      0418
*   GEN(USING ANSALL,PDLBASE);    /* ESTABLISH ADDRESSABILITY FOR PDL*/
*                                                                  0419
         USING ANSALL,PDLBASE
*   /*****************************************************************/
*   /*  IF USERID SUPPLIED, COPY USERID FROM PDL TO USERID BUFFER    */
*   /*****************************************************************/
*                                                                  0420
*   PDEPTR = ADDR(USERID);        /* GET POINTER TO USERID AND     0420
*                                    PASSWORD PDE.                   */
*                                                                  0420
         LA    PDEPTR,USERID                                       0420
*   IF PDELEN ^= 0                /* IF A USERID HAS BEEN SUPPLIED,
*                                    COPY IT FROM THE PDL TO THE   0421
*                                    USERID BUFFER                   */
*     THEN                                                         0421
         LH    @06,PDELEN(,PDEPTR)                                 0421
         LTR   @06,@06                                             0421
         BZ    @RF00421                                            0421
*       DO;                                                        0422
*         LWPUSER = '';             /* BLANK OUT THE USERID  @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0423
         MVI   LWPUSER(@05),C' '                                   0423
         MVC   LWPUSER+1(6,@05),LWPUSER(@05)                       0423
*         LWPUSERL = PDELEN;       /* SAVE USERID LENGTH     @Z40NQKC*/
         STH   @06,LWPUSERL(,@05)                                  0424
*         LWPUSERM = LWPUSERL+4;   /* SET INSERT LENGTH      @Z40NQKC*/
         LA    @15,4                                               0425
         ALR   @15,@06                                             0425
         STH   @15,LWPUSERM(,@05)                                  0425
*         LWPUSER(1:PDELEN) = PDESTR(1:PDELEN);            /*@Z40NQKC*/
         BCTR  @06,0                                               0426
         L     @01,PDESTRPT(,PDEPTR)                               0426
         EX    @06,@SM01865                                        0426
*                                    /* MOVE THE USERID FROM THE   0427
*                                    PDL TO THE USERID BUFFER        */
*       END;                                                       0427
*                                                                  0427
*   /*****************************************************************/
*   /*  IF PASSWORD SUPPLIED, COPY IF FROM PDL TO PASSWORD BUFFER.   */
*   /*****************************************************************/
*                                                                  0428
*   IF PDELEN2 ^= 0               /* IF A PASSWORD HAS BEEN SUPPLIED,
*                                    COPY IT FROM THE PDL TO THE   0428
*                                    PASSWORD BUFFER                 */
*     THEN                                                         0428
@RF00421 LH    @06,PDELEN2(,PDEPTR)                                0428
         LTR   @06,@06                                             0428
         BZ    @RF00428                                            0428
*       DO;                                                        0429
*         LWPPSWD = '';             /* BLANK OUT THE PSWD    @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0430
         MVI   LWPPSWD(@05),C' '                                   0430
         MVC   LWPPSWD+1(7,@05),LWPPSWD(@05)                       0430
*         LWPPSWDL = PDELEN2;      /* SAVE LENGTH OF PSWD    @Z40NQKC*/
         STH   @06,LWPPSWDL(,@05)                                  0431
*         LWPPSWDM = PDELEN2 + 4; /* TEXT INSERT LENGTH      @Z40NQKC*/
         LA    @15,4                                               0432
         ALR   @15,@06                                             0432
         STH   @15,LWPPSWDM(,@05)                                  0432
*         LWPPSWD(1:PDELEN2) = PDESTR2(1:PDELEN2);         /*@Z40NQKC*/
         BCTR  @06,0                                               0433
         L     @01,PDESTRP2(,PDEPTR)                               0433
         EX    @06,@SM01867                                        0433
*                                    /* MOVE PASSWORD FROM PDL TO  0434
*                                    PASSWORD BUFFER                 */
*       END;                                                       0434
*                                                                  0434
*   IF PDELEN3 ^= 0               /* NEW-PSWD SUPPLIED       @Z40RQKC*/
*     THEN DO;                                                     0435
@RF00428 LH    @06,PDELEN3(,PDEPTR)                                0435
         LTR   @06,@06                                             0435
         BZ    @RF00435                                            0435
*       LWPNPSWD = '';            /* BLANK OUT NEW PSWD      @Z40RQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0437
         MVI   LWPNPSWD(@05),C' '                                  0437
         MVC   LWPNPSWD+1(7,@05),LWPNPSWD(@05)                     0437
*       LWPNPSWL = PDELEN3;       /* LEN OF NEW-PSWD         @Z40RQKC*/
         STH   @06,LWPNPSWL(,@05)                                  0438
*       LWPNPSWM = PDELEN3+4;     /* INSERT LENGTH           @Z40RQKC*/
         LA    @15,4                                               0439
         ALR   @15,@06                                             0439
         STH   @15,LWPNPSWM(,@05)                                  0439
*       LWPNPSWD(1:PDELEN3) =     /* THE NEW PSWD            @Z40RQKC*/
*           PDESTR3(1:PDELEN3);                                    0440
         BCTR  @06,0                                               0440
         L     @01,PDESTRP3(,PDEPTR)                               0440
         EX    @06,@SM01869                                        0440
*       END;                                                       0441
*                                                                  0441
*   /*****************************************************************/
*   /*  IF ACCT NUMBER SUPPLIED, COPY IF FROM PDL TO ACCT BUFFER.    */
*   /*****************************************************************/
*                                                                  0442
*   PDEPTR = ADDR(ACCTNUM1);      /* GET POINTER TO ACCOUNT NUMBER 0442
*                                    PDE.                            */
*                                                                  0442
@RF00435 LA    PDEPTR,ACCTNUM1                                     0442
*   IF PDELEN ^= 0                /* IF AN ACCOUNT NUMBER HAS BEEN 0443
*                                    SUPPLIED, COPY IT FROM THE PDL
*                                    TO THE ACCOUNT NUMBER BUFFER    */
*     THEN                                                         0443
         LH    @06,PDELEN(,PDEPTR)                                 0443
         LTR   @06,@06                                             0443
         BZ    @RF00443                                            0443
*       DO;                                                        0444
*         LWPACCTL = PDELEN;       /* SAVE LENGTH OF ACCOUNT @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0445
         STH   @06,LWPACCTL(,@05)                                  0445
*         LWPACCTM = LWPACCTL+4;   /* SET LENGTH FOR INSERT  @Z40NQKC*/
         LA    @15,4                                               0446
         ALR   @15,@06                                             0446
         STH   @15,LWPACCTM(,@05)                                  0446
*         LWPACCT(1:PDELEN) = PDESTR(1:PDELEN);            /*@Z40NQKC*/
         BCTR  @06,0                                               0447
         L     @01,PDESTRPT(,PDEPTR)                               0447
         EX    @06,@SM01871                                        0447
*                                    /* MOVE ACCOUNT NUMBER FROM PDL
*                                    TO ACCOUNT NUMBER BUFFER        */
*       END;                                                       0448
*                                                                  0448
*   /*****************************************************************/
*   /*  IF PROCNAME SUPPLIED, COPY IT FROM PDL TO PROC NAME BUFFER.  */
*   /*****************************************************************/
*                                                                  0449
*   PDEPTR = ADDR(PROCNM1);       /* GET POINTER TO PROCNAME PDE.    */
*                                                                  0449
@RF00443 LA    PDEPTR,PROCNM1                                      0449
*   IF PDELEN ^= 0                /* IF A PROCEDURE NAME HAS BEEN  0450
*                                    SUPPLIED, COPY IT FROM THE PDL
*                                    TO THE PROCEDURE NAME BUFFER    */
*     THEN                                                         0450
         LH    @06,PDELEN(,PDEPTR)                                 0450
         LTR   @06,@06                                             0450
         BZ    @RF00450                                            0450
*       DO;                                                        0451
*         LWPPROC = '';             /* BLANK OUT PROCNAME    @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0452
         MVI   LWPPROC(@05),C' '                                   0452
         MVC   LWPPROC+1(7,@05),LWPPROC(@05)                       0452
*         LWPPROCL = PDELEN;       /* SAVE PROCNAME LENGTH   @Z40NQKC*/
         STH   @06,LWPPROCL(,@05)                                  0453
*         LWPPROCM = LWPPROCL+4;   /* SET INSERT LENGTH      @Z40NQKC*/
         LA    @15,4                                               0454
         ALR   @15,@06                                             0454
         STH   @15,LWPPROCM(,@05)                                  0454
*                                 /* MOVE PROCEDURE NAME FROM PDL TO
*                                    PROCEDURE NAME BUFFER           */
*         LWPPROC(1:PDELEN) = PDESTR(1:PDELEN);            /*@Z40NQKC*/
         BCTR  @06,0                                               0455
         L     @01,PDESTRPT(,PDEPTR)                               0455
         EX    @06,@SM01873                                        0455
*       END;                                                       0456
*                                                                  0456
*   PDEPTR = ADDR($GROUP);        /* ADDRESS THE PDE         @Z40RQKC*/
*                                                                  0457
@RF00450 LA    PDEPTR,$GROUP                                       0457
*   IF PDELEN ^= 0                /* GROUP HAS BEEN SUPPLIED @Z40RQKC*/
*     THEN DO;                                                     0458
         LH    @06,PDELEN(,PDEPTR)                                 0458
         LTR   @06,@06                                             0458
         BZ    @RF00458                                            0458
*       LWPGRP = '';              /* BLANK OUT GROUP         @Z40RQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0460
         MVI   LWPGRP(@05),C' '                                    0460
         MVC   LWPGRP+1(7,@05),LWPGRP(@05)                         0460
*       LWPGRPL = PDELEN;         /* SET THE LENGTH          @Z40RQKC*/
         STH   @06,LWPGRPL(,@05)                                   0461
*       LWPGRPM = PDELEN + 4;     /* INSERT LENGTH           @Z40RQKC*/
         LA    @15,4                                               0462
         ALR   @15,@06                                             0462
         STH   @15,LWPGRPM(,@05)                                   0462
*       LWPGRP(1:PDELEN) =        /* COPY GROUP FROM PDE     @Z40RQKC*/
*          PDESTR(1:PDELEN);                               /*@Z40RQKC*/
         BCTR  @06,0                                               0463
         L     @01,PDESTRPT(,PDEPTR)                               0463
         EX    @06,@SM01875                                        0463
*       END;                                               /*@Z40RQKC*/
*                                                                  0464
*   /*****************************************************************/
*   /*  CONVERT AND SAVE REGION SIZE.                                */
*   /*****************************************************************/
*                                                                  0465
*   PDEPTR = ADDR(RGNSIZE1);      /* GET POINTER TO REGION SIZE PDE. */
*                                                                  0465
@RF00458 LA    PDEPTR,RGNSIZE1                                     0465
*   IF PDELEN ^= 0                /* IF REGION SIZE HAS BEEN       0466
*                                    SUPPLIED, CONVERT IT FROM EBCDIC
*                                    TO BINARY AND SAVE IN REGION  0466
*                                    SIZE BUFFER                     */
*     THEN                                                         0466
         LH    @06,PDELEN(,PDEPTR)                                 0466
         LTR   @06,@06                                             0466
         BZ    @RF00466                                            0466
*       DO;                                                        0467
*         CONVERT = CONVERT && CONVERT; /* BLANK OUT CONVERSION AREA
*                                    FOR CONVERT TO BINARY         0468
*                                    OPERATION                       */
         XC    CONVERT(8),CONVERT                                  0468
*         LWPREGN = PDESTR(1:PDELEN);/* SAVE REGION SIZE     @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0469
         MVI   LWPREGN+1(@05),C' '                                 0469
         MVC   LWPREGN+2(6,@05),LWPREGN+1(@05)                     0469
         LR    @15,@06                                             0469
         BCTR  @15,0                                               0469
         L     @14,PDESTRPT(,PDEPTR)                               0469
         EX    @15,@SM01877                                        0469
*         LWPREGNL = PDELEN;         /* SAVE LENGTH          @Z40NQKC*/
         STH   @06,LWPREGNL(,@05)                                  0470
*         LWPREGNM = PDELEN + 4;     /* LENGTH FOR INSERT    @Z40NQKC*/
         LA    @15,4                                               0471
         ALR   @15,@06                                             0471
         STH   @15,LWPREGNM(,@05)                                  0471
*         CONVERT(6-PDELEN:5) = PDESTR(1:PDELEN);                  0472
         LCR   @06,@06                                             0472
         AH    @06,@CH00218                                        0472
         LA    @05,CONVERT-1(@06)                                  0472
         LCR   @06,@06                                             0472
         AH    @06,@CH00087                                        0472
         EX    @06,@SM01879                                        0472
*                                    /* MOVE REGION SIZE AS        0473
*                                    SUPPLIED BY USER TO           0473
*                                    CONVERSION AREA.                */
*         GEN(PACK  CONVERT(8),CONVERT(5)); /* PACK REGION SIZE FOR
*                                    CONVERSION                      */
         PACK  CONVERT(8),CONVERT(5)
*         RESPECIFY (REGION) RSTD;                                 0474
*         GEN(CVB   REGION,CONVERT);                               0475
         CVB   REGION,CONVERT
*         LWPREGNX = REGION;         /* SAVE REGION SIZE     @Z40NQKC*/
         L     @06,PTRBUF(,PRMPNTR)                                0476
         ST    REGION,LWPREGNX(,@06)                               0476
*         RESPECIFY ( REGION) UNRSTD;                              0477
*       END;                                                       0478
*                                                                  0478
*   /*****************************************************************/
*   /*  CONVERT AND SAVE PERFORMANCE GROUP                     Y02669*/
*   /*****************************************************************/
*                                                                  0479
*   PDEPTR = ADDR(PRFMG1);        /* GET POINTER TO PERFORM    Y02669*/
@RF00466 LA    PDEPTR,PRFMG1                                       0479
*                                 /*GROUP PDE                  Y02669*/
*                                                                  0480
*   IF PDELEN ^= 0                /* IF PERFORM GROUP HAS BEEN Y02669
*                                    SUPPLIED, CONVERT IT FROM Y02669
*                                    EBCDIC TO BINARY AND SAVE Y02669
*                                    IN PERFORM GROUP BUFFER   Y02669*/
*     THEN                                                   /*Y02669*/
         LH    @06,PDELEN(,PDEPTR)                                 0480
         LTR   @06,@06                                             0480
         BZ    @RF00480                                            0480
*       DO;                                                  /*Y02669*/
*         CONVERT = ''B;          /* ZERO OUT WORK AREA      @Z40NQKC*/
         XC    CONVERT(8),CONVERT                                  0482
*         LWPPERF = PDESTR(1:PDELEN);/* SAVE PERF GROUP      @Z40NQKC*/
         L     @05,PTRBUF(,PRMPNTR)                                0483
         MVI   LWPPERF+1(@05),C' '                                 0483
         MVC   LWPPERF+2(6,@05),LWPPERF+1(@05)                     0483
         LR    @15,@06                                             0483
         BCTR  @15,0                                               0483
         L     @14,PDESTRPT(,PDEPTR)                               0483
         EX    @15,@SM01881                                        0483
*         LWPPERFL = PDELEN;         /* SAVE LENGTH          @Z40NQKC*/
         STH   @06,LWPPERFL(,@05)                                  0484
*         LWPPERFM = PDELEN + 4;     /* LENGTH FOR INSERT    @Z40NQKC*/
         LA    @15,4                                               0485
         LR    @01,@06                                             0485
         ALR   @01,@15                                             0485
         STH   @01,LWPPERFM(,@05)                                  0485
*         CONVERT(4-PDELEN:3) = PDESTR(1:PDELEN);            /*Y02669*/
         SLR   @15,@06                                             0486
         LA    @06,CONVERT-1(@15)                                  0486
         LCR   @15,@15                                             0486
         AH    @15,@CH00136                                        0486
         EX    @15,@SM01883                                        0486
*         GEN(PACK  CONVERT(8),CONVERT(3)); /* PACK PERFORM    Y02669
*                                    GROUP FOR CONVERSION      Y02669*/
         PACK  CONVERT(8),CONVERT(3)
*         RESPECIFY (PRFORMGP) RSTD;                         /*Y02669*/
*         GEN(CVB   PRFORMGP,CONVERT);                       /*Y02669*/
         CVB   PRFORMGP,CONVERT
*         LWPPERFX= PRFORMGP;         /* SAVE PERFORM GROUP  @Z40NQKC*/
         L     @06,PTRBUF(,PRMPNTR)                                0490
         ST    PRFORMGP,LWPPERFX(,@06)                             0490
*         RESPECIFY (PRFORMGP) UNRSTD;                       /*Y02669*/
*       END;                                                 /*Y02669*/
*                                                                  0492
*   /*****************************************************************/
*   /*  PROCESS MAIL AND NOMAIL PARAMETERS                           */
*   /*****************************************************************/
*                                                                  0493
*   IF MAILP = 2                  /* IF NOMAIL HAS BEEN ENTERED    0493
*                                    ON LOGON COMMAND, SET 'ECTNMAL'
*                                    BIT TO ONE                      */
*     THEN DO;                    /*                         @G32OPKU*/
@RF00480 CLC   MAILP(2),@CH00197                                   0493
         BNE   @RF00493                                            0493
*       ECTNMAL = '1'B;                                            0495
         L     @06,LWAPECT(,LWAPTR)                                0495
         OI    ECTNMAL(@06),B'00001000'                            0495
*       LWPMAIL = YES;            /* TELL FLE MAIL/NOMAIL    @G32OPKU*/
         L     @06,PTRBUF(,PRMPNTR)                                0496
         OI    LWPMAIL(@06),B'01000000'                            0496
*     END;                        /* WAS REQUESTED ON LOGON  @G32OPKU*/
*                                                                  0497
*   IF MAILP = 1                  /* IF MAIL HAS BEEN ENTERED      0498
*                                    ON LOGON COMMAND, SET 'ECTNMAL'
*                                    BIT TO ZERO                     */
*     THEN DO;                    /*                         @G32OPKU*/
@RF00493 CLC   MAILP(2),@CH00032                                   0498
         BNE   @RF00498                                            0498
*       ECTNMAL = '0'B;                                            0500
         L     @06,LWAPECT(,LWAPTR)                                0500
         NI    ECTNMAL(@06),B'11110111'                            0500
*       LWPMAIL = YES;            /* TELL FLE MAIL/NOMAIL    @G32OPKU*/
         L     @06,PTRBUF(,PRMPNTR)                                0501
         OI    LWPMAIL(@06),B'01000000'                            0501
*     END;                        /* WAS REQUESTED ON LOGON  @G32OPKU*/
*                                                                  0502
*   /*****************************************************************/
*   /*  PROCESS NOTICES AND NONOTICES PARAMETERS                     */
*   /*****************************************************************/
*                                                                  0503
*   IF NOTICESP = 2               /* IF NONOTICES HAS BEEN ENTERED 0503
*                                    ON LOGON COMMAND, SET 'ECTNNOT'
*                                    TO ONE                          */
*     THEN DO;                    /*                        @G32OPKU*/
@RF00498 CLC   NOTICESP(2),@CH00197                                0503
         BNE   @RF00503                                            0503
*       ECTNNOT = '1'B;                                            0505
         L     @06,LWAPECT(,LWAPTR)                                0505
         OI    ECTNNOT(@06),B'00000100'                            0505
*       LWPNOTIC = YES;           /* TELL FLE NOTICES/      @G32OPKU*/
         L     @06,PTRBUF(,PRMPNTR)                                0506
         OI    LWPNOTIC(@06),B'00100000'                           0506
*     END;                        /* NONOTICES ON LOGON CMD @G32OPKU*/
*                                                                  0507
*   IF NOTICESP = 1               /* IF NOTICES HAS BEEN ENTERED   0508
*                                    ON LOGON COMMAND, SET 'ECTNNOT'
*                                    TO ZERO                         */
*     THEN DO;                    /*                        @G32OPKU*/
@RF00503 CLC   NOTICESP(2),@CH00032                                0508
         BNE   @RF00508                                            0508
*       ECTNNOT = '0'B;                                            0510
         L     @06,LWAPECT(,LWAPTR)                                0510
         NI    ECTNNOT(@06),B'11111011'                            0510
*       LWPNOTIC = YES;           /* TELL FLE NOTICES/      @G32OPKU*/
         L     @06,PTRBUF(,PRMPNTR)                                0511
         OI    LWPNOTIC(@06),B'00100000'                           0511
*     END;                        /* NONOTICES ON LOGON CMD @G32OPKU*/
*                                 /* COMMAND                        */
*   IF OIDCARDP = 1               /* IF OIDCARD KEYWORD     @G32OPKU*/
*     THEN                                                         0513
@RF00508 CLC   OIDCARDP(2),@CH00032                                0513
         BNE   @RF00513                                            0513
*       LWPOIDCD = '1'B;          /* ENTERED, REMEMBER IT   @G32OPKU*/
*                                                                  0514
         L     @06,PTRBUF(,PRMPNTR)                                0514
         OI    LWPOIDCD(@06),B'00010000'                           0514
*/********************************************************************/
*/*                                                                  */
*/*KEYWORD-                                                          */
*/*          RECONNECT                                               */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @G32OPKU-                                                   */
*/*          THE RECONNECT SEGMENT WAS MOVED FROM MODULE IKJEFLEA    */
*/*          TO MODULE IKJEFLE TO SUPPORT RACF VERSION 2             */
*/*          REQUIREMENTS                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0515
*   IF RECONCTP = 1 &             /* RECONNECT WAS ENTERED     Y02669*/
*      MODE ^= SUBMIT             /* NOT INVOKED BY SUBMIT   @Z40NQKC*/
*     THEN LWPRECON = YES;        /* TURN ON BIT TO LET      @G32OPKU*/
@RF00513 CLC   RECONCTP(2),@CH00032                                0515
         BNE   @RF00515                                            0515
         L     @06,FUNCPTR(,PRMPNTR)                               0515
         CLI   MODE(@06),X'01'                                     0515
         BE    @RF00515                                            0515
         L     @06,PTRBUF(,PRMPNTR)                                0516
         OI    LWPRECON(@06),B'10000000'                           0516
*                                 /* IKJEFLE KNOW THAT THIS          */
*                                 /* WAS A REQUEST FOR RECONNECT     */
*                                                                  0517
*   RESPECIFY (SVRTN) RSTD;                                        0517
@RF00515 DS    0H                                                  0518
*ENDPRS:                                                           0518
*                                                                  0518
*   /*****************************************************************/
*   /*  CLEANUP:                                                     */
*   /*           FREE PDL AND COMMAND BUFFER                         */
*   /*****************************************************************/
*                                                                  0518
*                                                                  0518
*   SVRTN = 0;                    /* SET PARSE RETURN CODE TO ZERO 0518
*                                    TO INDICATE SUCCESSFUL        0518
*                                    COMPLETION.                     */
*                                                                  0518
ENDPRS   SLR   SVRTN,SVRTN                                         0518
*FREEPDL:                                                    /*Y02669*/
*   RESPECIFY (PARMPTR) RSTD;                                      0519
*                                                                  0519
FREEPDL  DS    0H                                                  0520
*   PARMPTR = PRSANS;             /* GET ADDRESS OF WORD WHICH     0520
*                                    CONTAINS ADDRESS OF PDL       0520
*                                    TO BE FREED.                    */
         L     PARMPTR,PRSANS                                      0520
*   GEN(IKJRLSA  (PARMPTR) );     /* FREE PDL CORE.                  */
         IKJRLSA  (PARMPTR)
*   RESPECIFY (PARMPTR) UNRSTD;                                    0522
*                                                                  0522
*ENDPRSER:                        /* IF UNSUCCESSFUL RETURN FROM   0523
*                                    PARSE, WE BRANCH HERE. SVRTN WILL
*                                    BE NONZERO.                     */
*                                                                  0523
*   IF MODE ^= SUBMIT             /* NOT ENTERED FROM SUBMIT @Z40NQKC*/
*     THEN DO;                                             /*@Z40NQKC*/
ENDPRSER L     @06,FUNCPTR(,PRMPNTR)                               0523
         CLI   MODE(@06),X'01'                                     0523
         BE    @RF00523                                            0523
*       RESPECIFY (FREELEN,ADRSTR) RSTD;                           0525
*       FREELEN = CMNDLNG;        /* GET LENGTH OF COMMAND BUFFER.   */
         L     @06,PTRIOLST(,PRMPNTR)                              0526
         L     @06,PTRINBUF(,@06)                                  0526
         L     @06,INBUF(,@06)                                     0526
         LH    FREELEN,CMNDLNG(,@06)                               0526
*       ADRSTR = ADDR(CMNDLNG);   /* GET ADDRESS OF COMMAND BUFFER   */
         LR    ADRSTR,@06                                          0527
*       GEN(FREEMAIN R,SP=1,LV=(FREELEN),A=(ADRSTR)); /* FREE THE CORE
*                                    OCCUPIED BY THE COMMAND BUFFER. */
         FREEMAIN R,SP=1,LV=(FREELEN),A=(ADRSTR)
*       RESPECIFY (FREELEN,ADRSTR) UNRSTD;                         0529
*       INBUF = 0;                /* INDICATE THAT NO COMMAND      0530
*                                    BUFFER EXISTS.                  */
         L     @06,PTRIOLST(,PRMPNTR)                              0530
         L     @06,PTRINBUF(,@06)                                  0530
         SLR   @05,@05                                             0530
         ST    @05,INBUF(,@06)                                     0530
*     END;                                                 /*@Z40NQKC*/
*                                                                  0531
*   /*****************************************************************/
*   /*  RETURN TO IKJEFLE TO CHECK VALIDITY OF OPERANDS              */
*   /*****************************************************************/
*                                                                  0532
*   LWALEA='0'B;              /*INDICATE LEA IS LOSING CONTROL Y02669*/
*                                                                  0532
@RF00523 NI    LWALEA(LWAPTR),B'11110111'                          0532
*   IF DISCONCT = '1'B            /*IF USER RECONNECTED        Y02669*/
*     THEN                        /*IN OTHER MEMORY, THEN      Y02669*/
         TM    DISCONCT,B'01000000'                                0533
         BO    @RT00533                                            0533
*       GO TO DISCO;              /*DISCONNECT THIS MEMORY     Y02669*/
*                                                                  0534
*   IF SVRTN = 0                  /* RETURN CODE FROM PARSE INDICATES
*                                    THAT EVERYTHING WAS SUCCESSFUL,
*                                    RETURN TO CALLER NORMALLY.      */
*     THEN                                                         0535
         LTR   SVRTN,SVRTN                                         0535
         BZ    @RT00535                                            0535
*       RETURN;                                                    0536
*                                                                  0536
*                                                                  0536
* PTYPE = 2;                      /* INDICATE THAT ERROR WAS IN PARSE*/
         L     @06,FUNCPTR(,PRMPNTR)                               0537
         MVC   PTYPE(2,@06),@CH00197                               0537
* GOTO CLEANUP;                                                    0538
*                                                                  0538
         B     CLEANUP                                             0538
*ERRLGM:                                                           0539
*                                                                  0539
*                                                                  0539
*   SVRTN = RTNREG;                                                0539
ERRLGM   LR    SVRTN,RTNREG                                        0539
*   PTYPE = 4;                    /* INDICATE THAT ERROR WAS IN    0540
*                                    MODULE IKJEFLGM                 */
         L     @06,FUNCPTR(,PRMPNTR)                               0540
         MVC   PTYPE(2,@06),@CH00134                               0540
*   GOTO CLEANUP;                                                  0541
*                                                                  0541
*                                                                  0541
         B     CLEANUP                                             0541
*ERRSCAN:                                                          0542
*                                                                  0542
*                                                                  0542
*   SVRTN = RTNREG;               /* SAVE RETURN CODE FROM COMMAND 0542
*                                    SCAN                            */
ERRSCAN  LR    SVRTN,RTNREG                                        0542
*   SVRTN = SVRTN + 8;                                             0543
         AH    SVRTN,@CH00085                                      0543
*   PTYPE = 3;                    /* INDICATE THAT ERROR WAS FROM  0544
*                                    COMMAND SCAN                    */
         L     @06,FUNCPTR(,PRMPNTR)                               0544
         MVC   PTYPE(2,@06),@CH00136                               0544
*   GOTO CLEANUP;                                                  0545
*                                                                  0545
         B     CLEANUP                                             0545
*DISCO:                                                            0546
*   LWALEA = '0'B;                 /* IKJEFLEA LOSING CONTROL Y02669 */
*                                                                  0546
DISCO    NI    LWALEA(LWAPTR),B'11110111'                          0546
*   SVRTN = 20;                   /* SET RETURN CODE TO 20 (DISCONNECT
*                                    TERMINAL AND NO MESSAGES.)      */
*                                                                  0547
         LA    SVRTN,20                                            0547
*CLEANUP:                                                          0548
*                                                                  0548
*                                                                  0548
*   RTNCODE = SVRTN;              /* SAVE RETURN CODE FOR IKJEFLE    */
CLEANUP  L     @06,BACKPTR(,SAVEPTR)                               0548
         ST    SVRTN,RTNCODE(,@06)                                 0548
*   RETURN;                       /* RETURN TO IKJEFLE               */
         B     @EL00001                                            0549
*RESPECIFY (SVRTN) UNRSTD;                                         0550
*                                                                  0550
*    RESPECIFY (JCLSPTR,POSITION) RSTD;                            0551
*BUILDJCL:                                                         0552
*                                                                  0552
*   /*****************************************************************/
*   /*  GETJCLS:  GET AND BUILD THE JOB CARD JCLS                    */
*   /*****************************************************************/
*                                                                  0552
*   JCLSPTR = 0;                 /* GET THE JOB CARD JCLS.           */
BUILDJCL SLR   JCLSPTR,JCLSPTR                                     0552
*   CALL GETJCLS;                                                  0553
*                                                                  0553
         BAL   @14,GETJCLS                                         0553
*   /*****************************************************************/
*   /*            BUILD THE JOB CARD JCLS(S).                        */
*   /*****************************************************************/
*                                                                  0554
*   JCLSLABL(1:7) = LWPUSER;        /* THE USERID IS THE     @Z40NQKC
*                                    JOB NAME.                       */
         L     @06,PTRBUF(,PRMPNTR)                                0554
         MVC   JCLSLABL(7,JCLSPTR),LWPUSER(@06)                    0554
*   JCLSTYPE(1:3) = 'JOB';        /* SET VERB TO 'JOB'.              */
         MVC   JCLSTYPE(3,JCLSPTR),@CC01785                        0555
*   POSITION = 1;                 /* SET CURRENT AVAILABLE POSITION
*                                    IN JCL CARD IMAGE               */
*                                                                  0556
         LA    POSITION,1                                          0556
*   /*****************************************************************/
*   /*  PLACE ACCOUNT NUMBER ON JOB CARD, IF SUPPLIED.               */
*   /*****************************************************************/
*                                                                  0557
*   IF LWPACCTL ^= 0               /* IF ACCOUNT NUMBER WAS  @Z40NQKC
*                                    SUPPLIED, PLACE IT ON JOB CARD. */
*     THEN                                                         0557
         LH    @15,LWPACCTL(,@06)                                  0557
         LTR   @15,@15                                             0557
         BZ    @RF00557                                            0557
*       DO;                                                        0558
*         JCLSTYPE(5) = '''';     /* ENCLOSE ACCOUNT NUMBER IN QUOTES*/
*                                                                  0559
         MVI   JCLSTYPE+4(JCLSPTR),C''''                           0559
*                                 /* MOVE ACCOUNT NUMBER TO JOB CARD */
*         POSITION = LWPACCTL;     /* SET POSITION TO NEW    @Z40NQKC
*                                    AVALIABLE POSITION              */
         LR    POSITION,@15                                        0560
*         JCLSBODY(1:POSITION) = LWPACCT;                  /*@Z40NQKC*/
         LR    @15,POSITION                                        0561
         BCTR  @15,0                                               0561
         EX    @15,@SM01890                                        0561
*                                 /* ENCLOSE ACCOUNT NUMBER IN QUOTES*/
*         JCLSBODY(POSITION+1) = '''';  /*                     M00044*/
         LR    @06,JCLSPTR                                         0562
         ALR   @06,POSITION                                        0562
         MVI   JCLSBODY(@06),C''''                                 0562
*         POSITION = POSITION +2; /* NEW AVAILABLE POSITION    M00044*/
         AH    POSITION,@CH00197                                   0563
*       END;                                                       0564
*   /*****************************************************************/
*   /*  PLACE REGION SIZE ON JOB CARD, IF SUPPLIED.                  */
*   /*****************************************************************/
*                                                                  0565
*    IF LWPREGNX ^= 0                 /* REGION SIZE GIVEN   @Z40NQKC
*                                    PLACE REGION PARAMETER ON JOB 0565
*                                    CARD.                           */
*      THEN                                                        0565
@RF00557 SLR   @06,@06                                             0565
         L     @15,PTRBUF(,PRMPNTR)                                0565
         C     @06,LWPREGNX(,@15)                                  0565
         BE    @RF00565                                            0565
*        DO;                                                       0566
*          IF LWPACCTL^=0           /*IF ACCT AND REGION SIZE@Z40NQKC*/
*           THEN                   /*SUPPLIED, THEN            M00044*/
         CH    @06,LWPACCTL(,@15)                                  0567
         BE    @RF00567                                            0567
*             DO;                /*PUT COMMA AFTER ACCT NUMBER M00044*/
*               JCLSBODY(POSITION)=','; /*                     M00044*/
         LR    @06,JCLSPTR                                         0569
         ALR   @06,POSITION                                        0569
         MVI   JCLSBODY-1(@06),C','                                0569
*               POSITION=POSITION+1;  /*NEW AVAILABLE POSITION M00044*/
         AH    POSITION,@CH00032                                   0570
*             END;                 /*                          M00044*/
*                                                                  0571
*          JCLSBODY(POSITION:POSITION+6) = 'REGION='; /*           0572
*                                    INITIALIZE REGION PARAMETER ON
*                                    JOB CARD.                       */
@RF00567 LR    @06,JCLSPTR                                         0572
         ALR   @06,POSITION                                        0572
         MVC   JCLSBODY-1(7,@06),@CC01788                          0572
*          POSITION = POSITION +7;/* NEW AVAILABLE POSITION          */
*                                                                  0573
         AH    POSITION,@CH00146                                   0573
*         CVD(LWPREGNX,PACKDEC);  /* BINARY TO PACKED        @Z40NQKC*/
         L     @06,PTRBUF(,PRMPNTR)                                0574
         L     @06,LWPREGNX(,@06)                                  0574
         CVD   @06,PACKDEC                                         0574
*         UNPK(ZONEDEC(1:5),PACKDEC);  /* PACKED TO ZONED    @Z40NQKC*/
         UNPK  ZONEDEC(5),PACKDEC(8)                               0575
*         ZONEDEC(5) = ZONEDEC(5) × 'F0'X; /* 'CN'X TO 'FN'X @Z40NQKC*/
         OI    ZONEDEC+4,X'F0'                                     0576
*         JCLSBODY(POSITION:POSITION+4) = ZONEDEC; /* SET RGN@Z40NQKC*/
         LR    @06,JCLSPTR                                         0577
         ALR   @06,POSITION                                        0577
         MVC   JCLSBODY-1(5,@06),ZONEDEC                           0577
*         JCLSBODY(POSITION+5) = 'K';                      /*@Z40NQKC*/
         LR    @06,JCLSPTR                                         0578
         ALR   @06,POSITION                                        0578
         MVI   JCLSBODY+4(@06),C'K'                                0578
*         END;                                                     0579
*                                                                  0579
*                                                                  0579
*   CALL GETJCLS;                 /* GET EXEC JCLS.                  */
@RF00565 BAL   @14,GETJCLS                                         0580
*   JCLSLABL(1:8) = LWPPROC;        /* PROCNAME USED         @Z40NQKC
*                                    AS THE PROC-STEP-NAME.          */
*                                                                  0581
         L     @06,PTRBUF(,PRMPNTR)                                0581
         MVC   JCLSLABL(8,JCLSPTR),LWPPROC(@06)                    0581
*   JCLSTYPE(2:5) = 'EXEC';       /* SET JCL VERB TO 'EXEC'.         */
         MVC   JCLSTYPE+1(4,JCLSPTR),@CC01793                      0582
*   JCLSBODY(2:LWPPROCL+1) = LWPPROC;/* PLACE PROCNAME ON    @Z40NQKC
*                                    THE EXEC CARD.                  */
         LH    @15,LWPPROCL(,@06)                                  0583
         LR    @14,@15                                             0583
         BCTR  @14,0                                               0583
         EX    @14,@SM01892                                        0583
*   IF LWPPERFX ^= 0              /* PERF GROUP SUPPLIED     @Z40NQKC*/
*     THEN DO;                                             /*@Z40NQKC*/
         L     @06,LWPPERFX(,@06)                                  0584
         LTR   @06,@06                                             0584
         BZ    @RF00584                                            0584
*       POSITION = LWPPROCL + 2;  /* START OF PERFORM=       @Z40NQKC*/
         AH    @15,@CH00197                                        0586
         LR    POSITION,@15                                        0586
*       JCLSBODY(POSITION:POSITION+LENGTH(',PERFORM=')-1) =/*@Z40NQKC*/
*             ',PERFORM=';                                 /*@Z40NQKC*/
         LR    @01,JCLSPTR                                         0587
         ALR   @01,POSITION                                        0587
         MVC   JCLSBODY-1(9,@01),@CC01794                          0587
*       POSITION = POSITION + LENGTH(',PERFORM=');         /*@Z40NQKC*/
         AH    POSITION,@CH01759                                   0588
*       CVD(LWPPERFX,PACKDEC);    /* BINARY TO PACKED        @Z40NQKC*/
         CVD   @06,PACKDEC                                         0589
*       UNPK(ZONEDEC(1:3),PACKDEC); /* PACKED TO ZONED       @Z40NQKC*/
         UNPK  ZONEDEC(3),PACKDEC(8)                               0590
*       ZONEDEC(3) = ZONEDEC(3) × 'F0'X; /* 'CN'X TO 'FN'X   @Z40NQKC*/
         OI    ZONEDEC+2,X'F0'                                     0591
*       JCLSBODY(POSITION:POSITION+2) = ZONEDEC;           /*@Z40NQKC*/
         LR    @06,JCLSPTR                                         0592
         ALR   @06,POSITION                                        0592
         MVC   JCLSBODY-1(3,@06),ZONEDEC                           0592
*       END;                                                       0593
*   LWALEA = '0'B;                 /* IKJEFLEA LOSING CONTROL  Y02669*/
@RF00584 NI    LWALEA(LWAPTR),B'11110111'                          0594
*   RESPECIFY (JCLSPTR,POSITION) UNRSTD;                           0595
*   RETURN;                       /* RETURN TO IKJEFLE               */
         B     @EL00001                                            0596
*VADACCT:  PROC  OPTIONS(NOSAVEAREA);                              0597
*                                                                  0597
VADACCT  STM   @14,@12,12(@13)                                     0597
*   /*****************************************************************/
*   /*      SCAN THE ACCOUNT NUMBER FOR ANY OCCURENCE OF A 'QUOTE'.  */
*   /*      IF A QUOTE APPEARS IN THE ACCOUNT NUMBER, INDICATE TO    */
*   /*        PARSE THAT IT MUST PROMPT FOR A NEW ACCOUNT NUMBER.    */
*   /*        (RETURN CODE 4).                                       */
*   /*      OTHERWISE, TELL PARSE THAT THE ACCOUNT NUMBER IS         */
*   /*        ACCEPTABLE. (RETURN CODE 0).                           */
*   /*****************************************************************/
*                                                                  0598
*   DCL QUOTESCN REG(5) FIXED(31);                                 0598
*   DCL CHECKPTR REG(6) PTR(31);                                   0599
*   DCL VADPARMP REG(7) PTR(31);                                   0600
*   DCL VADRTNCD PTR(31) BASED(SAVEPTR) POSITION(17);              0601
*   DCL 1 * BASED (VADPARMP),                                      0602
*         2 ACCTPPDE PTR(31),                                      0602
*         2 USERDATA PTR(31);                                      0602
*   DCL 1 * BASED(ACCTPPDE),                                       0603
*         2 ACCTNMP PTR(31),                                       0603
*         2 ACCTNMLN FIXED(15);                                    0603
*   DCL ACCTNM CHAR(1) BASED(CHECKPTR);                            0604
*                                                                  0604
*   RESPECIFY (VADPARMP,CHECKPTR,QUOTESCN) RSTD;                   0605
*                                                                  0605
*   /*****************************************************************/
*   /*     SET UP TO CHECK ACCOUNT NUMBER                            */
*   /*****************************************************************/
*                                                                  0606
*   GENERATE;                                               /* Y02669*/
         L     3,4(1)             GET ADDR OF USERWORD           Y02669
         LM    10,12,0(3)         SET UP ADDR TO DATA            Y02669
*   VADPARMP = PARMPTR;           /* GET ADDRESS OF PARAMETER LIST 0607
*                                    PASSED BY PARSE.                */
         LR    VADPARMP,PARMPTR                                    0607
*   CHECKPTR = ACCTNMP;           /* GET ADDRESS OF ACCOUNT NUMBER 0608
*                                    CHARACTER STRING WHICH MUST BE
*                                    VALIDITY CHECKED.               */
*                                                                  0608
         L     @01,ACCTPPDE(,VADPARMP)                             0608
         L     CHECKPTR,ACCTNMP(,@01)                              0608
*   QUOTESCN = 1;                 /* SET SCAN INDEX TO FIRST       0609
*                                    CHARACTER OF ACCOUNT NUMBER     */
*                                                                  0609
         LA    QUOTESCN,1                                          0609
*CHECKNXT:                                                         0610
*   IF ACCTNM(QUOTESCN) = ''''    /* REJECT ACCOUNT NUMBER IF IT   0610
*                                    CONTAINS A QUOTE MARK           */
*     THEN                                                         0610
CHECKNXT LR    @01,CHECKPTR                                        0610
         ALR   @01,QUOTESCN                                        0610
         BCTR  @01,0                                               0610
         CLI   ACCTNM(@01),C''''                                   0610
         BE    @RT00610                                            0610
*       GOTO INVADACT;                                             0611
*                                                                  0611
*                                                                  0611
*   QUOTESCN = QUOTESCN + 1;      /* BUMP SCAN INDEX TO NEXT       0612
*                                    CHARACTER OF ACCOUNT NUMBER     */
*                                                                  0612
*                                                                  0612
         AH    QUOTESCN,@CH00032                                   0612
*   IF QUOTESCN ^> ACCTNMLN       /* IF MORE CHARACTERS TO BE      0613
*                                    CHECKED, GO TO CHECK NEXT ONE   */
*     THEN                                                         0613
         L     @01,ACCTPPDE(,VADPARMP)                             0613
         CH    QUOTESCN,ACCTNMLN(,@01)                             0613
         BNH   @RT00613                                            0613
*       GOTO CHECKNXT;                                             0614
*                                                                  0614
*                                                                  0614
*   VADRTNCD = 0;                 /* NO QUOTES, ACCEPT ACCOUNT NUMBER*/
         SLR   @15,@15                                             0615
         ST    @15,VADRTNCD(,SAVEPTR)                              0615
*   RETURN;                       /* RETURN TO PARSE                 */
*                                                                  0616
@EL00002 DS    0H                                                  0616
@EF00002 DS    0H                                                  0616
@ER00002 LM    @14,@12,12(@13)                                     0616
         BR    @14                                                 0616
*INVADACT:                                                         0617
*                                                                  0617
*                                                                  0617
*   VADRTNCD = 4;                 /* QUOTES, REJECT ACCOUNT NUMBER   */
INVADACT MVC   VADRTNCD(4,SAVEPTR),@CF00134                        0617
*RESPECIFY (VADPARMP,CHECKPTR,QUOTESCN) UNRSTD;                    0618
*END VADACCT;                     /* RETURN TO PARSE                 */
         B     @EL00002                                            0619
*VADPRFM: PROC OPTIONS(NOSAVEAREA);                          /*Y02669*/
VADPRFM  STM   @14,@12,12(@13)                                     0620
*   /*****************************************************************/
*   /* THIS VALIDITY CHECK EXIT ROUTINE CHECKS THAT THE        Y02669*/
*   /* PERFORMANCE GROUP ENTERED WAS FROM 1 TO 255, INCLUSIVE. Y02669*/
*   /* IF THE NUMBER ENTERED WAS SYNTACTICALLY INVALID,        Y02669*/
*   /* INDICATE TO PARSE THAT IT MUST PROMPT FOR A NEW         Y02669*/
*   /* PERFORMANCE GROUP (RETURN CODE = 4).                    Y02669*/
*   /* OTHERWISE, TELL PARSE THAT NUMBER IS VALID              Y02669*/
*   /* (RETURN CODE = 0).                                      Y02669*/
*   /*****************************************************************/
*                                                                  0621
*   DCL PRFMGRP REG(5) FIXED(31);  /*PERFORMANCE GROUP ENTERED Y02669*/
*   DCL PKAREA  CHAR(8);           /*AREA TO BE PACKED         Y02669*/
*   DCL PKAREA1 CHAR(3) BASED(PRFMGRP);  /*PART OF PKAREA      Y02669*/
*                                        /*WITH EBCDIC CHARS   Y02669*/
*   DCL CVBAREA CHAR(8) BDY(DWORD);  /*AREA TO CVB'D           Y02669*/
*   DCL VADPFRTC PTR(31) BASED(SAVEPTR) POSITION(17);        /*Y02669*/
*   DCL VADPRMPT REG(7) PTR(31);   /*PTR TO PARMS FROM PARSE   Y02669*/
*                                                                  0626
*   DCL 1 * BASED(VADPRMPT),       /*PARMS FROM PARSE          Y02669*/
*         2 PRFMPPDE PTR(31),      /*PTR TO PERFORM PDE        Y02669*/
*         2 USERWORD PTR(31);      /*PTR TO VALUES FOR         Y02669*/
*                                  /*REGS 11 AND 12            Y02669*/
*                                                                  0628
*   DCL 1 * BASED(PRFMPPDE),       /*PERFORM GROUP PDE         Y02669*/
*         2 PRFMP PTR(31),         /*PTR TO PERFORM CHAR STRINGY02669*/
*         2 PRFMLN FIXED(15);      /*LENGTH OF CHAR STRING     Y02669*/
*                                                                  0628
*   DCL EBCDICPG CHAR(3) BASED(PRFMP);  /*PERFORMANCE GROUP    Y02669*/
*                                  /*ENTERED IN EBCDIC         Y02669*/
*                                                                  0630
*   GENERATE;                                                /*Y02669*/
*                                                                  0630
      L  3,4(1)                      GET ADDR OF USERWORD      Y02669
      LM 10,12,0(3)                  SET UP ADDRESS. TO DATA   Y02669
*   RESPECIFY (VADPRMPT) RSTD;                               /*Y02669*/
*   VADPRMPT=PARMPTR;              /* GET ADDRESS OF PARM      Y02669*/
         LR    VADPRMPT,PARMPTR                                    0632
*                                  /* LIST PASSED BY PARSE     Y02669*/
*   PKAREA='F0F0F0F0F0F0F0F0'X;    /*SET WORKAREA TO EBCDIC    Y02669*/
         MVC   PKAREA(8),@CB01832                                  0633
*                                  /*ZEROES                    Y02669*/
*   RESPECIFY (PRFMGRP) RSTD;                                /*Y02669*/
*   PRFMGRP = 8-PRFMLN+ADDR(PKAREA); /*POINT TO PROPER         Y02669*/
         L     @06,PRFMPPDE(,VADPRMPT)                             0635
         LH    @15,PRFMLN(,@06)                                    0635
         LA    PRFMGRP,8                                           0635
         SLR   PRFMGRP,@15                                         0635
         LA    @14,PKAREA                                          0635
         ALR   PRFMGRP,@14                                         0635
*                                    /*BUFFER POSITION         Y02669*/
*   PKAREA1(1:PRFMLN)=EBCDICPG(1:PRFMLN); /*MOVE EBCDIC CHARS Y02669*/
         BCTR  @15,0                                               0636
         L     @06,PRFMP(,@06)                                     0636
         EX    @15,@SM01894                                        0636
*                                    /*TO AREA TO BE PACKED    Y02669*/
*   GEN;                                                     /*Y02669*/
*                                                                  0637
    PACK CVBAREA(8),PKAREA(8)      PACK NUMBER                 Y02669
    CVB  PRFMGRP,CVBAREA           CONVERT TO BINARY           Y02669
*   IF PRFMGRP < 1 ×               /*PERFORM GROUP CANNOT BE   Y02669*/
*      PRFMGRP > 255               /*LESS THAN 1 OR GREATER    Y02669*/
*                                  /*THAN 255                  Y02669*/
*      THEN                                                        0638
         LTR   PRFMGRP,PRFMGRP                                     0638
         BNP   @RT00638                                            0638
         CH    PRFMGRP,@CH01834                                    0638
         BNH   @RF00638                                            0638
@RT00638 DS    0H                                                  0639
*        VADPFRTC = 4;             /*REJECT PERFORM GROUP      Y02669*/
         MVC   VADPFRTC(4,SAVEPTR),@CF00134                        0639
*    ELSE VADPFRTC = 0;            /*ELSE ACCEPT PERFORM GROUP Y02669*/
         B     @RC00638                                            0640
@RF00638 SLR   @06,@06                                             0640
         ST    @06,VADPFRTC(,SAVEPTR)                              0640
*    RETURN;                       /*RETURN TO PARSE           Y02669*/
*                                                                  0641
@EL00003 DS    0H                                                  0641
@EF00003 DS    0H                                                  0641
@ER00003 LM    @14,@12,12(@13)                                     0641
         BR    @14                                                 0641
*    RESPECIFY (VADPRMPT,PRFMGRP) UNRSTD;                    /*Y02669*/
*END VADPRFM;                                                /*Y02669*/
         B     @EL00003                                            0643
*GETJCLS:  PROC   OPTIONS(NOSAVE,NOSAVEAREA);                      0644
*                                                                  0644
*                                                                  0644
GETJCLS  DS    0H                                                  0645
*   RESPECIFY (GTMNPTR,JCLSPTR,LWAPTR) RSTD;                       0645
*   SAV14=R14;                    /* SAVE RETURN POINT         Y02669*/
         ST    R14,SAV14                                           0646
*   GEN(GETMAIN  R,SP=1,LV=88);   /* GET STORAGE FOR ONE JCLS        */
*                                                                  0647
         GETMAIN  R,SP=1,LV=88
*   /*****************************************************************/
*   /*      IF JCLSPTR IS ZERO, THIS IS THE FIRST JCLS. THEREFORE,   */
*   /*         JSELJCL MUST BE SET TO POINT TO JCLS.                 */
*   /*      IF JCLSPTR NOT ZERO, NEW JCLS MUST BE CHAINED TO         */
*   /*         PREVIOUS JCLS.                                        */
*   /*****************************************************************/
*                                                                  0648
*   IF JCLSPTR = 0                /* IF THIS IS THE FIRST JCLS, THEN */
*     THEN                                                         0648
         LTR   JCLSPTR,JCLSPTR                                     0648
         BNZ   @RF00648                                            0648
*       JSELJCL = GTMNPTR;        /* SET JSELJCL TO FIRST JCLS, OR   */
         L     @06,LWAJSEL(,LWAPTR)                                0649
         ST    GTMNPTR,JSELJCL(,@06)                               0649
*     ELSE                                                         0650
*       JCLSJCLS = GTMNPTR;       /* CHAIN NEW JCLS TO PREVIOUS JCLS */
*                                                                  0650
*                                                                  0650
         B     @RC00648                                            0650
@RF00648 ST    GTMNPTR,JCLSJCLS(,JCLSPTR)                          0650
*   JCLSPTR = GTMNPTR;            /* UPDATE JCLSPTR TO POINT TO    0651
*                                    CURRENT OR NEW JCLS.            */
@RC00648 LR    JCLSPTR,GTMNPTR                                     0651
*   RESPECIFY (GTMNPTR) UNRSTD;                                    0652
*                                                                  0652
*   JCLSHDR = JCLSHDR && JCLSHDR; /* SET FIRST TWO WORDS OF JCLS TO 0*/
         XC    JCLSHDR(8,JCLSPTR),JCLSHDR(JCLSPTR)                 0653
*   JCLSCARD(1:80) = '';          /* BLANK OUT JCL CARD IMAGE IN JCLS*/
         MVI   JCLSCARD(JCLSPTR),C' '                              0654
         MVC   JCLSCARD+1(79,JCLSPTR),JCLSCARD(JCLSPTR)            0654
*   JCLSLASH = '//';              /* PLACE // IN JCL CARD.           */
         MVC   JCLSLASH(2,JCLSPTR),@CC01838                        0655
*   R14=SAV14;                    /* RESTORE RETURN POINT      Y02669*/
         L     R14,SAV14                                           0656
*   RESPECIFY (JCLSPTR,LWAPTR) UNRSTD;                             0657
*   END GETJCLS;                  /* RETURN TO CALLER                */
@EL00004 DS    0H                                                  0658
@EF00004 DS    0H                                                  0658
@ER00004 BR    @14                                                 0658
*   /*****************************************************************/
*   /*           PARAMETER CONTROL LIST FOR PARSE (PCL) - OF LOGON   */
*   /*****************************************************************/
*GENERATE;                                                         0659
*                                                                  0659
*                                                                  0659
IKJEFLE1 IKJPARM  DSECT=ANSALL
**********************************************************************
USERID   IKJPOSIT  UID2PSWD,PROMPT='USERID'
ACCTNUM  IKJKEYWD
         IKJNAME  'ACCT',SUBFLD=ACCTSUB
**********************************************************************
PROCNM   IKJKEYWD
         IKJNAME  'PROC',SUBFLD=PROCSUB
**********************************************************************
RGNSIZE  IKJKEYWD
         IKJNAME  'SIZE',SUBFLD=RGNSUB
**********************************************************************
PRFORMG  IKJKEYWD
         IKJNAME  'PERFORM',SUBFLD=PRFMSUB                   Y02669
**********************************************************************
RECONECT IKJKEYWD
         IKJNAME  'RECONNECT'                                Y02669
**********************************************************************
MAIL     IKJKEYWD
         IKJNAME  'MAIL'
         IKJNAME  'NOMAIL'
**********************************************************************
NOTICES  IKJKEYWD
         IKJNAME  'NOTICES'
         IKJNAME  'NONOTICES'
#GROUP   IKJKEYWD
         IKJNAME  'GROUP',SUBFLD=@GROUP
*************************************************************@G32OPKU
OIDCARD  IKJKEYWD
         IKJNAME  'OIDCARD'
**********************************************************************
*              SUBFIELD DESCRIPTIONS                                 *
**********************************************************************
         SPACE
RGNSUB   IKJSUBF
RGNSIZE1 IKJIDENT 'REGION SIZE',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=5, X
               PROMPT='REGION SIZE'
**********************************************************************
PROCSUB  IKJSUBF
PROCNM1  IKJIDENT  'PROCEDURE NAME',MAXLNTH=8,OTHER=ALPHANUM,          X
               PROMPT='PROCEDURE NAME'
**********************************************************************
ACCTSUB  IKJSUBF
ACCTNUM1 IKJIDENT  'ACCOUNT NUMBER',MAXLNTH=40,FIRST=ANY,OTHER=ANY,    X
               PROMPT='ACCOUNT NUMBER',VALIDCK=VADACCT
**********************************************************************
PRFMSUB   IKJSUBF
PRFMG1    IKJIDENT 'PERFORMANCE GROUP',MAXLNTH=3,FIRST=NUMERIC,        *
               PROMPT='PERFORMANCE GROUP',VALIDCK=VADPRFM,             *
               OTHER=NUMERIC,HELP='VALUE BETWEEN 1 AND 255,INCLUSIVE'
@GROUP   IKJSUBF
$GROUP   IKJIDENT  'GROUP ID',MAXLNTH=8,OTHER=ALPHANUM,                *
               PROMPT='GROUP ID'
         IKJENDP
*   /******************************************************************
*   /* PARAMETER CONTROL LIST FOR PARSE - FOR LOGOFF COMMAND    Y02669*
*   /******************************************************************
*                                                                  0660
* GENERATE;                                                        0660
*                                                                  0660
IKJEFLE2 IKJPARM DSECT=LOGOFFAN                                Y02669
**********************************************************************
HOLD      IKJKEYWD
          IKJNAME  'HOLD'                                       Y02669
          IKJNAME  'DISCONNECT'                                 Y02669
**********************************************************************
          IKJENDP
*   /******************************************************************
*   /* PARAMETER CONTROL LIST FOR PARSE                         Y02669*
*   /*   PASSWORD FOR RECONNECT                                 Y02669*
*   /******************************************************************
*                                                                  0661
* GENERATE;                                                        0661
*                                                                  0661
IKJEFLE3 IKJPARM DSECT=PSWDANS                                 Y02669
**********************************************************************
PSWORD   IKJIDENT  'PASSWORD',MAXLNTH=8,FIRST=ALPHANUM,                *
               OTHER=ALPHANUM,PROMPT='PASSWORD',PTBYPS,                *
               HELP=('PASSWORD FOR LOGON RECONNECT')
**********************************************************************
          IKJENDP
*   /*****************************************************************/
*   /* PARAMETER CONTROL LIST FOR PARSE                        Y02669*/
*   /*   USERID AND PASSWORD FOR RECONNECT                     Y02669*/
*   /*****************************************************************/
*                                                                  0662
* GENERATE;                                                        0662
*                                                                  0662
*                                                                  0662
IKJEFLE4 IKJPARM DSECT=RCNTANS                                   Y02669
***********************************************************************
USERPWD  IKJPOSIT UID2PSWD,PROMPT='USERID'
         IKJENDP
*  DECLARE /*GENERAL PURPOSE REGISTERS */                          0663
*    GPR00P PTR(31) REG(0),                                        0663
*    GPR01P PTR(31) REG(1),                                        0663
*    GPR02P PTR(31) REG(2),                                        0663
*    GPR03P PTR(31) REG(3),                                        0663
*    GPR04P PTR(31) REG(4),                                        0663
*    GPR05P PTR(31) REG(5),                                        0663
*    GPR06P PTR(31) REG(6),                                        0663
*    GPR07P PTR(31) REG(7),                                        0663
*    GPR08P PTR(31) REG(8),                                        0663
*    GPR09P PTR(31) REG(9),                                        0663
*    GPR14P PTR(31) REG(14),                                       0663
*    GPR15P PTR(31) REG(15);                                       0663
*                                                                  0663
*  DECLARE /* COMMON VARIABLES */                                  0664
*    I256C CHAR(256) BASED,                                        0664
*    I031F FIXED(31) BASED,                                        0664
*    I031P PTR(31)   BASED,                                        0664
*    I015F FIXED(15) BASED,                                        0664
*    I015P PTR(15)   BASED,                                        0664
*    I008P PTR(8)    BASED,                                        0664
*    I001C CHAR(1)   BASED;                                        0664
*END IKJEFLEA                                                      0665
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJEFLWP)                                        *
*/*%INCLUDE SYSLIB  (IKJEFLWA)                                        *
*/*%INCLUDE SYSLIB  (IKJEFLP0)                                        *
*/*%INCLUDE SYSLIB  (IKJECT  )                                        *
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        *
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        *
*/*%INCLUDE SYSLIB  (IHAASCB )                                        *
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        *
*/*%INCLUDE SYSLIB  (IEFVJSEL)                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IEFJCLS )                                        *
*;                                                                 0665
         B     @EL00001                                            0665
@DATA    DS    0H
@CH00032 DC    H'1'
@CH00197 DC    H'2'
@CH00136 DC    H'3'
@CH00087 DC    H'5'
@CH00218 DC    H'6'
@CH00146 DC    H'7'
@CH00085 DC    H'8'
@CH01759 DC    H'9'
@CH01756 DC    H'14'
@CH00117 DC    H'15'
@CH00109 DC    H'16'
@CH01738 DC    H'20'
@CH01755 DC    H'21'
@CH01762 DC    H'23'
@CH01765 DC    H'33'
@CH00260 DC    H'40'
@CH01834 DC    H'255'
@CH01699 DC    H'256'
@SM01863 MVC   CMNDTEXT+20(0,GTMNPTR),CMNDTEXT(@14)
@SM01865 MVC   LWPUSER(0,@05),PDESTR(@01)
@SM01867 MVC   LWPPSWD(0,@05),PDESTR2(@01)
@SM01869 MVC   LWPNPSWD(0,@05),PDESTR3(@01)
@SM01871 MVC   LWPACCT(0,@05),PDESTR(@01)
@SM01873 MVC   LWPPROC(0,@05),PDESTR(@01)
@SM01875 MVC   LWPGRP(0,@05),PDESTR(@01)
@SM01877 MVC   LWPREGN(0,@05),PDESTR(@14)
@SM01879 MVC   0(0,@05),PDESTR(@14)
@SM01881 MVC   LWPPERF(0,@05),PDESTR(@14)
@SM01883 MVC   0(0,@06),PDESTR(@14)
@SM01890 MVC   JCLSBODY(0,JCLSPTR),LWPACCT(@06)
@SM01892 MVC   JCLSBODY+1(0,JCLSPTR),LWPPROC(@06)
@SM01894 MVC   PKAREA1(0,PRFMGRP),EBCDICPG(@06)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@TF00001 DS    F
@ZTEMPS  DS    C
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJEFLEA CSECT
         DS    0F
@CF00134 DC    F'4'
@CH00134 EQU   @CF00134+2
@CF00034 DC    F'12'
@DATD    DSECT
         DS    0D
ASCBPTR  DS    A
SAVED13  DS    A
SAVED14  DS    A
SAV14    DS    A
TSBPTR   DS    A
PRSPDL   DS    A
SAVECBUF DS    A
SAVEDANS DS    A
EABITS   DS    AL1
         ORG   EABITS
RELSLCK  DS    BL1
DISCONCT EQU   EABITS+0
NOPERFRM EQU   EABITS+0
@NM00001 EQU   EABITS+0
         ORG   EABITS+1
         DS    CL7
CONVERT  DS    CL8
ZONEDEC  DS    CL8
PACKDEC  DS    CL8
PRSBF    DS    CL12
         ORG   PRSBF
PRSBFLEN DS    FL2
PRSBFOFF DS    FL2
PRSBFUSR DS    CL7
PRSBFSLH DS    CL1
         ORG   PRSBF+12
CNDSCLST DS    CL24
         ORG   CNDSCLST
CNDUPT   DS    AL4
CNDECT   DS    AL4
CNDECB   DS    AL4
CNDFLG   DS    AL4
CNDOUT   DS    AL4
CNDBUF   DS    AL4
         ORG   CNDSCLST+24
FLGWORD  DS    CL4
         ORG   FLGWORD
FLAGCND  DS    CL1
@NM00003 DS    CL3
         ORG   FLGWORD+4
OUTPCND  DS    CL8
         ORG   OUTPCND
CNDNAME  DS    AL4
CNDLGTH  DS    FL2
OUTFLGS  DS    CL1
@NM00004 DS    CL1
         ORG   OUTPCND+8
TIOCPARM DS    CL8
         ORG   TIOCPARM
PTRUSER  DS    AL4
PTRPSWRD DS    AL4
         ORG   TIOCPARM+8
PARSELST DS    CL28
         ORG   PARSELST
PRSUPT   DS    AL4
PRSECT   DS    AL4
PRSECB   DS    AL4
PRSPCL   DS    AL4
PRSANS   DS    AL4
PRSBUF   DS    AL4
PRSWKA   DS    AL4
         ORG   PARSELST+28
SAVREGS  DS    CL12
         ORG   SAVREGS
SAV10    DS    AL4
SAV11    DS    AL4
SAV12    DS    AL4
         ORG   SAVREGS+12
PKAREA   DS    CL8
CVBAREA  DS    CL8
PASSWORD DS    CL8
USER     DS    CL8
TEXTSEGS DS    CL22
         ORG   TEXTSEGS+0
TEXTSLEN DS    FL2
TEXTSOST DS    FL2
TEXTSTXT DS    CL18
         ORG   TEXTSEGS+72
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFLEA CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00036 DC    V(IKJEFLGM)
@CV00037 DC    V(IKJEFLP0)
@CV00065 DC    V(IKJEFLE1)
@CV00078 DC    V(IKJEFLE2)
@CV00079 DC    V(IKJEFLE3)
@CV00080 DC    V(IKJEFLE4)
@CV00038 DC    V(IKTLOGR)
         DS    0D
DUMMYECB DC    F'0'
@CC01739 DC    C'RELEASE LOCK'
@CC01741 DC    C'OBTAIN LOCK'
@CC01757 DC    C'TERMINATED'
@CC01794 DC    C',PERFORM='
@CC01788 DC    C'REGION='
@CC01734 DC    C'LOGOFF'
@CC01746 DC    C'LOGON'
@CC01760 DC    C'ERROR'
@CC01793 DC    C'EXEC'
@CC01785 DC    C'JOB'
@CC01838 DC    C'//'
@CB01832 DC    X'F0F0F0F0F0F0F0F0'
BLANKS   DC    CL8'        '
SYSIKJUA DC    CL8'SYSIKJUA'
         DS    CL2
PATCH    DC    50F'0'
         DS    50XL4
FORCEP   DC    CL3'AC('
         DC    CL3'PR('
         DC    CL3'SI('
         DC    CL3'PE('
         DC    CL3'/  '
         DC    CL3'GR('
INSTERR  DC    CL3'044'
         DC    CL3'060'
         DC    CL3'076'
         DC    CL3'096'
         DC    CL3'104'
         DC    CL3'224'
         DC    CL3'262'
         DC    CL3'278'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
PARMPTR  EQU   @01
GTMNPTR  EQU   @01
REGION   EQU   @01
LWAPTR   EQU   @02
FREELEN  EQU   @03
SAVED11  EQU   @03
JCLSPTR  EQU   @04
PDEPTR   EQU   @04
LENSTR   EQU   @04
POSITION EQU   @05
ADRSTR   EQU   @05
SVRTN    EQU   @07
SAVED12  EQU   @07
PRFORMGP EQU   @07
NULLBUF  EQU   @08
PDLBASE  EQU   @08
PRMPNTR  EQU   @09
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
SAVEPTR  EQU   @13
R14      EQU   @14
LOCKRTNC EQU   @13
RTNREG   EQU   @15
GPR01P   EQU   @01
QUOTESCN EQU   @05
CHECKPTR EQU   @06
VADPARMP EQU   @07
PRFMGRP  EQU   @05
VADPRMPT EQU   @07
GPR00P   EQU   @00
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR08P   EQU   @08
GPR09P   EQU   @09
GPR14P   EQU   @14
GPR15P   EQU   @15
REASONCD EQU   @00
CVTPTR   EQU   16
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
BACKPTR  EQU   4
PARM     EQU   24
RTNCODE  EQU   16
PARMLST  EQU   0
PTRLWA   EQU   PARMLST
PTRBUF   EQU   PARMLST+4
PTRIOLST EQU   PARMLST+8
FUNCPTR  EQU   PARMLST+12
@NM00002 EQU   0
PRMTSWC  EQU   @NM00002
PMSGNM   EQU   @NM00002+2
PTYPE    EQU   @NM00002+4
PTRYS    EQU   @NM00002+8
MODE     EQU   @NM00002+12
MSGLST   EQU   0
UPTPTR2  EQU   MSGLST
ECBPTR   EQU   MSGLST+8
PTRINBUF EQU   MSGLST+16
SEGS1PTR EQU   MSGLST+20
INBUF    EQU   0
INTTEXT  EQU   0
TEXTINT1 EQU   INTTEXT
COMNDNM  EQU   0
CMNDBUFR EQU   0
CMNDLNG  EQU   CMNDBUFR
CMNDOFST EQU   CMNDBUFR+2
CMNDTEXT EQU   CMNDBUFR+4
PDESTRUC EQU   0
PDESTRPT EQU   PDESTRUC
PDELEN   EQU   PDESTRUC+4
PDESTRP2 EQU   PDESTRUC+8
PDELEN2  EQU   PDESTRUC+12
PDESTRP3 EQU   PDESTRUC+16
PDELEN3  EQU   PDESTRUC+20
PDESTR   EQU   0
PDESTR2  EQU   0
PDESTR3  EQU   0
IKJEFLWP EQU   0
LWPUSERS EQU   IKJEFLWP
LWPUSERI EQU   LWPUSERS+4
LWPUSERM EQU   LWPUSERI
LWPUSERL EQU   LWPUSERI+2
LWPUSER  EQU   LWPUSERI+4
LWPPSWDS EQU   IKJEFLWP+16
LWPPSWDI EQU   LWPPSWDS+4
LWPPSWDM EQU   LWPPSWDI
LWPPSWDL EQU   LWPPSWDI+2
LWPPSWD  EQU   LWPPSWDI+4
LWPPROCS EQU   IKJEFLWP+32
LWPPROCI EQU   LWPPROCS+4
LWPPROCM EQU   LWPPROCI
LWPPROCL EQU   LWPPROCI+2
LWPPROC  EQU   LWPPROCI+4
LWPACCTS EQU   IKJEFLWP+48
LWPACCTI EQU   LWPACCTS+4
LWPACCTM EQU   LWPACCTI
LWPACCTL EQU   LWPACCTI+2
LWPACCT  EQU   LWPACCTI+4
@NM00009 EQU   IKJEFLWP+96
LWPREGNI EQU   @NM00009+4
LWPREGNM EQU   LWPREGNI
LWPREGNL EQU   LWPREGNI+2
LWPREGN  EQU   LWPREGNI+4
LWPREGNX EQU   LWPREGNI+12
@NM00010 EQU   IKJEFLWP+116
LWPPERFI EQU   @NM00010+4
LWPPERFM EQU   LWPPERFI
LWPPERFL EQU   LWPPERFI+2
LWPPERF  EQU   LWPPERFI+4
LWPPERFX EQU   LWPPERFI+12
LWPDESTS EQU   IKJEFLWP+136
LWPDESTI EQU   LWPDESTS+4
LWPNPSWS EQU   IKJEFLWP+152
LWPNPSWI EQU   LWPNPSWS+4
LWPNPSWM EQU   LWPNPSWI
LWPNPSWL EQU   LWPNPSWI+2
LWPNPSWD EQU   LWPNPSWI+4
LWPGRPS  EQU   IKJEFLWP+168
LWPGRPI  EQU   LWPGRPS+4
LWPGRPM  EQU   LWPGRPI
LWPGRPL  EQU   LWPGRPI+2
LWPGRP   EQU   LWPGRPI+4
LWPFLAGS EQU   IKJEFLWP+184
LWPFLGS1 EQU   LWPFLAGS
LWPRECON EQU   LWPFLGS1
LWPMAIL  EQU   LWPFLGS1
LWPNOTIC EQU   LWPFLGS1
LWPOIDCD EQU   LWPFLGS1
LWA      EQU   0
LWAPASCB EQU   LWA+16
LWAPSCB  EQU   LWA+24
LWAJSEL  EQU   LWA+28
LWAPECT  EQU   LWA+32
LWAAECB  EQU   LWA+36
LWAPECB  EQU   LWA+40
LWASECB  EQU   LWA+44
LWAFLGS  EQU   LWA+56
@NM00016 EQU   LWAFLGS
LWALEA   EQU   @NM00016
@NM00017 EQU   LWAFLGS+1
@NM00019 EQU   LWAFLGS+2
LWAVTAM  EQU   @NM00019
LWAFLGS4 EQU   LWAFLGS+3
LWACTLS  EQU   LWA+64
LWANOPR  EQU   LWACTLS
LWANAME  EQU   LWA+72
LWAELST  EQU   LWA+92
LWAPECBP EQU   LWAELST+4
@NM00025 EQU   0
LP0PRMT  EQU   @NM00025+8
ECT      EQU   0
ECTSWS   EQU   ECT+28
ECTNMAL  EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
TSB      EQU   0
TSBASCBA EQU   TSB
TSBSTAT  EQU   TSBASCBA
TSBFLG1  EQU   TSB+4
TSBFLG2  EQU   TSB+16
TSBFLG3  EQU   TSB+24
TSBFLG5  EQU   TSB+25
TSBTERMC EQU   TSB+26
TSBTERM1 EQU   TSBTERMC
TSBTERM2 EQU   TSBTERMC+1
TSBSTCC  EQU   TSB+34
TSBFLG4  EQU   TSB+41
TSBHLDL  EQU   TSBFLG4
TSBRCB   EQU   TSB+64
TSBLINKA EQU   TSBRCB+4
TSBTPOST EQU   TSB+72
TSBTPFLG EQU   TSBTPOST
TSBMINL  EQU   TSB+84
ASCB     EQU   0
ASCBTSB  EQU   ASCB+60
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
PSCB     EQU   0
PSCBATR1 EQU   PSCB+16
PSCBRLGB EQU   PSCB+48
JSEL     EQU   0
JSELJCL  EQU   JSEL+12
JSELASCB EQU   JSEL+20
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
JCLS     EQU   0
JCLSHDR  EQU   JCLS
JCLSJCLS EQU   JCLSHDR
JCLSCARD EQU   JCLS+8
JCLSLASH EQU   JCLSCARD
JCLSLABL EQU   JCLSCARD+2
JCLSTYPE EQU   JCLSCARD+10
JCLSBODY EQU   JCLSCARD+15
VADRTNCD EQU   16
@NM00080 EQU   0
ACCTPPDE EQU   @NM00080
@NM00081 EQU   0
ACCTNMP  EQU   @NM00081
ACCTNMLN EQU   @NM00081+4
ACCTNM   EQU   0
PKAREA1  EQU   0
VADPFRTC EQU   16
@NM00082 EQU   0
PRFMPPDE EQU   @NM00082
@NM00083 EQU   0
PRFMP    EQU   @NM00083
PRFMLN   EQU   @NM00083+4
EBCDICPG EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
LOGONTCB EQU   0
IOPARM   EQU   UPTPTR2
CNDPARM  EQU   CNDUPT
PRSPARM  EQU   PRSUPT
RECONCTP EQU   RECONECT
MAILP    EQU   MAIL
NOTICESP EQU   NOTICES
OIDCARDP EQU   OIDCARD
HOLDP    EQU   HOLD
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTSCAN  EQU   CVTS01+132
CVTPARS  EQU   CVTS01+176
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
USERWORD EQU   @NM00082+4
USERDATA EQU   @NM00080+4
JCLSSEQ  EQU   JCLSCARD+72
JCLSCNTN EQU   JCLSCARD+71
@NM00079 EQU   JCLSHDR+4
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00078 EQU   CVTFIX+248
@NM00077 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
JSELEOL  EQU   JSELASCB
JSELJSXL EQU   JSEL+16
JSELCSCB EQU   JSEL+8
JSELJSOL EQU   JSEL+4
@NM00076 EQU   JSEL
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBDEST EQU   PSCB+40
@NM00075 EQU   PSCB+36
@NM00074 EQU   PSCB+32
PSCBSOUT EQU   PSCB+31
PSCBSUBM EQU   PSCB+30
PSCBSUBC EQU   PSCB+29
PSCBSUBH EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00073 EQU   PSCBATR1
@NM00072 EQU   PSCBATR1
PSCBRCVR EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
PSCBUSRL EQU   PSCB+7
PSCBUSER EQU   PSCB
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
TSBEND   EQU   TSB+120
TSBSF1   EQU   TSB+112
TSBTRMID EQU   TSB+104
TSBALTC  EQU   TSB+103
TSBALTR  EQU   TSB+102
TSBPRMC  EQU   TSB+101
TSBPRMR  EQU   TSB+100
TSBEXTNT EQU   TSB+96
TSBPSWD  EQU   TSB+88
TSBLECB  EQU   TSBMINL
TSBLINE  EQU   TSB+82
TSBSTAX  EQU   TSB+81
TSBATTNC EQU   TSB+80
TSBF1V   EQU   TSBTPOST+7
TSBF1M   EQU   TSBTPOST+6
TSBF2V   EQU   TSBTPOST+5
TSBF2M   EQU   TSBTPOST+4
TSBFLAGV EQU   TSBTPOST+3
TSBFLAGM EQU   TSBTPOST+2
@NM00071 EQU   TSBTPOST+1
@NM00070 EQU   TSBTPFLG
@NM00069 EQU   TSBTPFLG
@NM00068 EQU   TSBTPFLG
@NM00067 EQU   TSBTPFLG
TSBNEWID EQU   TSBTPFLG
TSBTPAYI EQU   TSBTPFLG
TSBTPQCB EQU   TSBTPFLG
TSBPOSTO EQU   TSBTPFLG
TSBLINKB EQU   TSBLINKA+1
TSBPRI   EQU   TSBLINKA
TSBRQCB  EQU   TSBRCB
TSBCTCB  EQU   TSB+60
TSBERSDS EQU   TSB+56
TSBAUTOI EQU   TSB+52
TSBAUTOS EQU   TSB+48
TSBATNCC EQU   TSB+44
TSBASRCE EQU   TSB+42
TSBGETBF EQU   TSBFLG4
TSBCANC  EQU   TSBFLG4
TSBHOLD  EQU   TSBFLG4
TSBHUNG  EQU   TSBFLG4
TSBOWAIT EQU   TSBFLG4
TSBIWAIT EQU   TSBFLG4
TSBOCAB  EQU   TSBFLG4
TSBLNNO  EQU   TSB+40
TSBATNTC EQU   TSB+38
TSBATNLC EQU   TSB+36
TSBCHDCC EQU   TSBSTCC+1
TSBLNDCC EQU   TSBSTCC
TSBWTJID EQU   TSB+32
TSBECB   EQU   TSB+28
TSBC1050 EQU   TSBTERM2
@NM00066 EQU   TSBTERM2
@NM00065 EQU   TSBTERM2
@NM00064 EQU   TSBTERM2
@NM00063 EQU   TSBTERM2
TSBCTWX  EQU   TSBTERM2
@NM00062 EQU   TSBTERM2
@NM00061 EQU   TSBTERM2
@NM00060 EQU   TSBTERM1
@NM00059 EQU   TSBTERM1
@NM00058 EQU   TSBTERM1
TSBC2741 EQU   TSBTERM1
TSBC5041 EQU   TSBTERM1
TSBCATTN EQU   TSBTERM1
TSBCBRK  EQU   TSBTERM1
TSBCIHBN EQU   TSBTERM1
TSBVTAM  EQU   TSBFLG5
TSBKEYS  EQU   TSBFLG5
@NM00057 EQU   TSBFLG5
TSBSPF   EQU   TSBFLG5
TSBATMP  EQU   TSBFLG5
TSBNFLOP EQU   TSBFLG3
TSBNOBRK EQU   TSBFLG3
TSBTPUT  EQU   TSBFLG3
TSBAWOIP EQU   TSBFLG3
TSBNBKSP EQU   TSBFLG3
TSBSPIT  EQU   TSBFLG3
TSBTJMSG EQU   TSBFLG3
TSBATTN  EQU   TSBFLG3
TSBIBFP  EQU   TSB+21
TSBNIBF  EQU   TSB+20
TSBITBFP EQU   TSB+17
TSBSATN2 EQU   TSBFLG2
TSBSATN1 EQU   TSBFLG2
TSBSTAUT EQU   TSBFLG2
TSBAUTOC EQU   TSBFLG2
TSBAULST EQU   TSBFLG2
TSBBRKIN EQU   TSBFLG2
TSBAUTON EQU   TSBFLG2
TSBBIPI  EQU   TSBFLG2
TSBOBFP  EQU   TSB+13
TSBNOBF  EQU   TSB+12
TSBOTBFP EQU   TSB+9
TSBLNSZ  EQU   TSB+8
TSBWTCB  EQU   TSB+5
TSBTJBF  EQU   TSBFLG1
TSBTJIP  EQU   TSBFLG1
TSBTJOW  EQU   TSBFLG1
TSBIFLSH EQU   TSBFLG1
TSBWOWIP EQU   TSBFLG1
TSBOWIP  EQU   TSBFLG1
TSBOFLSH EQU   TSBFLG1
TSBANSR  EQU   TSBFLG1
TSBASCB  EQU   TSBASCBA+1
TSBATNLD EQU   TSBSTAT
TSB3270  EQU   TSBSTAT
TSBDISC  EQU   TSBSTAT
TSBITOFF EQU   TSBSTAT
TSBNOBUF EQU   TSBSTAT
TSBDSPLY EQU   TSBSTAT
TSBLWAIT EQU   TSBSTAT
TSBINUSE EQU   TSBSTAT
@NM00032 EQU   ECT+52
@NM00031 EQU   ECT+48
@NM00030 EQU   ECT+44
@NM00029 EQU   ECTSWS2+1
@NM00028 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00027 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
LP0MWAT  EQU   @NM00025+4
@NM00026 EQU   @NM00025
@NM00024 EQU   LWA+152
LWASPF   EQU   LWA+148
LWASWKA  EQU   LWA+144
LWAGBWKA EQU   LWA+140
LWADEST2 EQU   LWA+132
LWASTCB  EQU   LWA+128
LWATCON1 EQU   LWA+124
LWATCON  EQU   LWA+120
LWATSRU1 EQU   LWA+116
LWATSRU  EQU   LWA+112
LWATCPU1 EQU   LWA+108
LWATCPU  EQU   LWA+104
LWARCDE  EQU   LWA+100
LWAEOEL  EQU   LWAPECBP
LWAAECBP EQU   LWAELST
LWANQDQ  EQU   LWA+80
LWARNM   EQU   LWANAME+1
LWARNML  EQU   LWANAME
LWARTCD  EQU   LWA+68
@NM00023 EQU   LWACTLS+1
LWABEND  EQU   LWACTLS+1
LWADEST  EQU   LWACTLS+1
LWANONQ  EQU   LWACTLS+1
LWABUPT  EQU   LWACTLS+1
LWAUNIT  EQU   LWACTLS+1
LWAATR2  EQU   LWACTLS+1
LWAATR1  EQU   LWACTLS+1
@NM00022 EQU   LWACTLS
LWAJJCL  EQU   LWACTLS
LWANUAD  EQU   LWACTLS
LWADISC  EQU   LWACTLS
LWAFAIL  EQU   LWACTLS
LWAMOUNT EQU   LWACTLS
LWAUFAI  EQU   LWACTLS
LWAPTID  EQU   LWA+60
LWAILGN  EQU   LWAFLGS4
LWAINX1  EQU   LWAFLGS4
LWATNBT  EQU   LWAFLGS4
LWALTBC  EQU   LWAFLGS4
LWASICSP EQU   LWAFLGS4
LWAQTIP  EQU   LWAFLGS4
LWANORDR EQU   LWAFLGS4
@NM00021 EQU   LWAFLGS4
LWABND   EQU   @NM00019
LWAMCK   EQU   @NM00019
LWAPCK   EQU   @NM00019
LWAPSW   EQU   @NM00019
LWAPHASE EQU   @NM00019
LWARACF  EQU   @NM00019
@NM00020 EQU   @NM00019
@NM00018 EQU   @NM00017
LWALS    EQU   @NM00017
LWALGB   EQU   @NM00017
LWALG    EQU   @NM00017
LWALK    EQU   @NM00017
LWALJ    EQU   @NM00017
LWALGM   EQU   @NM00017
LWALL    EQU   @NM00016
LWALH    EQU   @NM00016
LWALI    EQU   @NM00016
LWALE    EQU   @NM00016
LWALC    EQU   @NM00016
LWALB    EQU   @NM00016
LWALA    EQU   @NM00016
LWAPDCB  EQU   LWA+52
LWALPCNT EQU   LWA+48
LWASBCE  EQU   LWASECB+3
@NM00015 EQU   LWASECB
LWAPBCE  EQU   LWAPECB+3
@NM00014 EQU   LWAPECB
LWAABCE  EQU   LWAAECB+3
@NM00013 EQU   LWAAECB
LWAACCT  EQU   LWA+20
LWATEST  EQU   LWA+12
LWALWA   EQU   LWA+4
LWAPPTR  EQU   LWA
@NM00012 EQU   LWPFLAGS+1
@NM00011 EQU   LWPFLGS1
LWPGRPP  EQU   LWPGRPS
LWPNPSWP EQU   LWPNPSWS
LWPDEST  EQU   LWPDESTI+4
LWPDESTL EQU   LWPDESTI+2
LWPDESTM EQU   LWPDESTI
LWPDESTP EQU   LWPDESTS
LWPPERFP EQU   @NM00010
LWPREGNP EQU   @NM00009
LWPACCTP EQU   LWPACCTS
LWPPROCP EQU   LWPPROCS
LWPPSWDP EQU   LWPPSWDS
@NM00008 EQU   LWPUSERI+11
LWPUSERP EQU   LWPUSERS
@NM00007 EQU   PDESTRUC+22
@NM00006 EQU   PDESTRUC+14
@NM00005 EQU   PDESTRUC+6
SEGS2PTR EQU   MSGLST+24
MSGNMPTR EQU   MSGLST+12
ECTPTR2  EQU   MSGLST+4
@NM00056 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00055 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00054 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00053 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00052 EQU   FLCFSA
@NM00051 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00050 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00049 EQU   FLCIOA
@NM00048 EQU   FLCMCLA+15
@NM00047 EQU   FLCMCLA+14
@NM00046 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00045 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00044 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00043 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00042 EQU   FLCPER
@NM00041 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00040 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00039 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00038 EQU   FLCPIILC
@NM00037 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00036 EQU   FLCSVILC
@NM00035 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00034 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00033 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00137 EQU   SCAN
@RT00139 EQU   SCANCMND
@RT00154 EQU   LOGONOFF
@RT00167 EQU   ERRSCAN
@RT00169 EQU   CMNDMSG
@RT00172 EQU   CMNDMSG
@RT00193 EQU   ENDPRSER
@RT00224 EQU   CONTINUE
@RF00177 EQU   DISCO
@RT00268 EQU   @EL00001
@RT00284 EQU   ERRLGM
@RT00294 EQU   PROMPT1
@RT00296 EQU   PROMPT
@RT00298 EQU   BUILDJCL
@RT00335 EQU   REENTER
@RT00360 EQU   ERRLGM
@RT00369 EQU   ERRLGM
@RF00378 EQU   FREINBUF
@RT00400 EQU   @EL00001
@RT00414 EQU   ENDPRSER
@RT00533 EQU   DISCO
@RT00535 EQU   @EL00001
@RT00610 EQU   INVADACT
@RT00613 EQU   CHECKNXT
@RC00638 EQU   @EL00003
@ENDDATA EQU   *
         END   IKJEFLEA,(C'PLS1802',0701,78177)

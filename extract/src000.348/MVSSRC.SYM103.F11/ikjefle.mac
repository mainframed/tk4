         TITLE 'IKJEFLE, PHASE I PROMPTER                              *
                        '
IKJEFLE  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IKJEFLE   78.177'                                 0001
IKJEFLES DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00171-IKJEFLES)
         ENTRY IKJEFLES
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @10,4095(,@12)                                      0001
         LA    @09,4095(,@10)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@10                                    0001
         USING @PSTART+8190,@09                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @15,@01,16(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 MVC   @PC00001(4),0(@01)                                  0001
LWASWAR  EQU   4
LWAMSPE  EQU   16
INITDONE EQU  4
NQUSERID EQU  8
DQUSERID EQU  12
SCHEDULE EQU  16
BCDONE   EQU  20
TERMINAT EQU  24
NQDQ0    EQU  0
NQDQ4    EQU  4
NQDQ8    EQU  8
STARTP2  EQU  16
INITRDY  EQU  20
ENDTASK  EQU  24
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*/********************************************************************/
*/*                                                                  */
*/*MODULE-                                                           */
*/*          IKJEFLE                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          ENTRY POINT TO LOGON FOR IKJEFLC                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0166
*   LWAPTR   = ADDR(LOGONWA);        /* ADDRESS OF LWA       @Z40NQKC*/
         L     @08,@PC00001                                        0166
         ST    @08,LWAPTR                                          0166
*   LWPPTR   = ADDR($LWP);           /* AREA FOR LOGON DATA  @Z40NQKC*/
         LA    @08,$LWP                                            0167
         ST    @08,LWPPTR                                          0167
*   MODE     = LOGON;             /* ENTERED FROM IKJEFLC    @Z40NQKC*/
*                                                                  0168
         MVI   MODE,X'00'                                          0168
*   CALL MAINLINE;                   /* PROCEED WITH LOGON   @Z40NQKC*/
*                                                                  0169
         BAL   @14,MAINLINE                                        0169
*   RETURN;                       /* RETURN TO IKJEFLC       @Z40NQKC*/
@EL00001 L     @13,4(,@13)                                         0170
@EF00001 L     @00,@SIZDATD                                        0170
         LR    @01,@11                                             0170
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0170
         BR    @14                                                 0170
*/********************************************************************/
*/*                                                                  */
*/*MODULE-                                                           */
*/*          IKJEFLES                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          ENTRY POINT TO LOGON FOR SUBMIT                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0171
*IKJEFLES:                                                         0171
*        ENTRY(SUBLOGON,SUBITEMS,SUBECT,SUBUPT);                   0171
*                                                                  0171
@EP00171 MVC   @PC00001+4(16),0(@01)                               0171
*   RESPECIFY (GPR02P,GPR03P,GPR04P,GPR05P) RSTD;                  0172
*   GPR02P = ADDR($DUMMY);           /* ZERO OUT CNTL BLOCKS @Z40NQKC*/
         LA    GPR02P,$DUMMY                                       0173
*   GPR03P = LENGTH($DUMMY);                               /*@Z40NQKC*/
         LA    GPR03P,1084                                         0174
*   GPR04P = ZERO;                   /* PADD WITH ZEROES     @Z40NQKC*/
         SLR   GPR04P,GPR04P                                       0175
*   GPR05P = ZERO;                                         /*@Z40NQKC*/
         SLR   GPR05P,GPR05P                                       0176
*   GEN(MVCL GPR02P,GPR04P);                               /*@Z40NQKC*/
         MVCL GPR02P,GPR04P
*   RESPECIFY (GPR02P,GPR03P,GPR04P,GPR05P) UNRSTD;                0178
*                                                                  0178
*   LWAPTR   = ADDR($LWA);           /* INITIALIZE LWA       @Z40NQKC*/
         LA    @08,$LWA                                            0179
         ST    @08,LWAPTR                                          0179
*   LWAPECT  = ADDR($ECT);                                 /*@Z40NQKC*/
         LA    @15,$ECT                                            0180
         ST    @15,LWAPECT(,@08)                                   0180
*   LWAJSEL  = ADDR($JSEL);                                /*@Z40NQKC*/
         LA    @15,$JSEL                                           0181
         ST    @15,LWAJSEL(,@08)                                   0181
*   LWAPSCB  = ADDR($PSCB);                                /*@Z40NQKC*/
         LA    @14,$PSCB                                           0182
         ST    @14,LWAPSCB(,@08)                                   0182
*   LWAPASCB = ADDR($ASCB);                                /*@Z40NQKC*/
         LA    @07,$ASCB                                           0183
         ST    @07,LWAPASCB(,@08)                                  0183
*   LWAILGN  = YES;                                        /*@Z40NQKC*/
*                                                                  0184
         OI    LWAILGN(@08),B'00000001'                            0184
*   MODE     = SUBMIT;               /* IN SUBMIT MODE       @Z40NQKC*/
*                                                                  0185
         MVI   MODE,X'01'                                          0185
*   LWPPTR   = ADDR(SUBITEMS);       /* AREA FOR LOGON DATA  @Z40NQKC*/
*                                                                  0186
         L     @08,@PC00001+8                                      0186
         ST    @08,LWPPTR                                          0186
*   ASCBTSB  = ADDR($TSB);           /* INITIALIZE ASCB      @Z40NQKC*/
         LA    @08,$TSB                                            0187
         ST    @08,ASCBTSB(,@07)                                   0187
*   ASCBASXB = ADDR($ASXB);                                /*@Z40NQKC*/
*                                                                  0188
         LA    @08,$ASXB                                           0188
         ST    @08,ASCBASXB(,@07)                                  0188
*   JSELCSCB = ADDR($CSCB);          /* INITIALIZE JSEL      @Z40NQKC*/
*                                                                  0189
         LA    @08,$CSCB                                           0189
         ST    @08,JSELCSCB(,@15)                                  0189
*   $UPT     = SUBUPT(1:LENGTH(UPT));/* USE SUBMIT UPT       @Z40NQKC*/
         L     @08,@PC00001+16                                     0190
         MVC   $UPT(24),SUBUPT(@08)                                0190
*   PSCBUPT  = ADDR($UPT);           /* INITIALIZE UPT       @Z40NQKC*/
         LA    @08,$UPT                                            0191
         ST    @08,PSCBUPT(,@14)                                   0191
*   PSCBUPTL = LENGTH($UPT);                               /*@Z40NQKC*/
*                                                                  0192
         MVC   PSCBUPTL(2,@14),@CH00080                            0192
*   $ECT     = SUBECT(1:LENGTH(ECT));/* USE SUBMIT ECT       @Z40NQKC*/
         L     @08,@PC00001+12                                     0193
         MVC   $ECT(56),SUBECT(@08)                                0193
*   INBUF    = ADDR(SUBLOGON);       /* THE LOGON COMMAND    @Z40NQKC*/
         L     @08,@PC00001+4                                      0194
         ST    @08,INBUF                                           0194
*   CALL MAINLINE;                   /* PROCEED WITH LOGON   @Z40NQKC*/
         BAL   @14,MAINLINE                                        0195
*   RETURN CODE(RTNREG);             /* RETURN TO SUBMIT     @Z40NQKC*/
         LR    @08,@15                                             0196
         L     @13,4(,@13)                                         0196
         L     @00,@SIZDATD                                        0196
         LR    @01,@11                                             0196
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@08                                             0196
         L     @14,12(,@13)                                        0196
         LM    @00,@12,20(@13)                                     0196
         BR    @14                                                 0196
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          MAINLINE                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          NORMAL LOGON PARSING AND PROMPTING                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0197
*MAINLINE:                                                         0197
*        PROCEDURE;                                                0197
*                                                                  0197
MAINLINE STM   @14,@12,@SA00002                                    0197
*   LWALE = '1'B;                 /*INDICATE LE HAS CONTROL    Y02669*/
         L     @08,LWAPTR                                          0198
         OI    LWALE(@08),B'00010000'                              0198
*   PTRINBUF = ADDR(INBUF);       /* INITIALIZE POINTER TO INPUT   0199
*                                    BUFFER POINTER                  */
         LA    @15,INBUF                                           0199
         ST    @15,PTRINBUF                                        0199
*   PTRYS = 0;                    /* INDICATE THAT USER HAS NOT BEEN
*                                    PROMPTED YET.                   */
         SLR   @15,@15                                             0200
         ST    @15,PTRYS                                           0200
*   TSBPTR=ASCBTSB;               /* SET POINTER TO TSB        Y02669*/
         L     @01,LWAPASCB(,@08)                                  0201
         L     @14,ASCBTSB(,@01)                                   0201
         ST    @14,TSBPTR                                          0201
*   SAVEPERP = 0;                 /*INIT OFFSET TO PERFORM     Y02669*/
         ST    @15,SAVEPERP                                        0202
*                                 /*GROUP DATA IN UADS         Y02669*/
*   STATUS = CONTINUE;            /* STATUS IS CONTINUE      @Z40RQKC*/
*                                                                  0203
         ST    @15,STATUS                                          0203
*   /*****************************************************************/
*   /*       INITIALIZE IKJEFLI'S PARAMETER LIST                     */
*   /*****************************************************************/
*                                                                  0204
*   PTRLWA = LWAPTR;              /* SET UP POINTER TO LWA           */
         ST    @08,PTRLWA                                          0204
*   PTRBUF = ADDR(IKJEFLWP);      /* ADDR OF LOGON PARMS     @Z40NQKC*/
         L     @15,LWPPTR                                          0205
         ST    @15,PTRBUF                                          0205
*   PTRIOLST = ADDR(MSGLST);      /* INTIALIZE ADDRESS OF MESSAGE  0206
*                                    MODULE PARAMETER LIST.          */
         LA    @15,MSGLST                                          0206
         ST    @15,PTRIOLST                                        0206
*   FUNCPTR = ADDR(PRMTSWC);      /* INDICATES FUNCTION TO BE      0207
*                                    PERFORMED BY IKJEFLEA           */
*                                                                  0207
         LA    @15,PRMTSWC                                         0207
         ST    @15,FUNCPTR                                         0207
*   /*****************************************************************/
*   /*       INITIALIZE MESSAGE MODULE'S PARAMETER LIST (IKJEFLGM)   */
*   /*****************************************************************/
*                                                                  0208
*   UPTPTR2 = PSCBUPT;            /* INITIALIZE POINTER TO UPT.      */
         L     @01,LWAPSCB(,@08)                                   0208
         L     @15,PSCBUPT(,@01)                                   0208
         ST    @15,UPTPTR2                                         0208
*   ECTPTR2 = LWAPECT;            /* INITIALIZE POINTER TO ECT.      */
         L     @15,LWAPECT(,@08)                                   0209
         ST    @15,ECTPTR2                                         0209
*   ECBPTR = ADDR(CHCECB);        /* INITIALIZE CANCEL ECB POINTER.  */
         L     @08,LWAJSEL(,@08)                                   0210
         L     @08,JSELCSCB(,@08)                                  0210
         LA    @08,CHCECB(,@08)                                    0210
         ST    @08,ECBPTR                                          0210
*   MSGNMPTR = ADDR(PMSGNM);      /* INITIALIZE ADDRESS OF MESSAGE 0211
*                                    NUMBER.                         */
         LA    @08,PMSGNM                                          0211
         ST    @08,MSGNMPTR                                        0211
*   SEGS1PTR = ADDR(TEXTINT1(1) );/* FIRST TEXT INSERTION POINTER.   */
         LA    @08,TEXTINT1                                        0212
         ST    @08,SEGS1PTR                                        0212
*   SEGS2PTR = ADDR(TEXTINT1(1) );/* SECOND TEXT INSERTION POINTER   */
*                                                                  0213
         ST    @08,SEGS2PTR                                        0213
*   /*****************************************************************/
*   /*       INITIALIZE LIST FORMS OF MACRO INSTRUCTIONS             */
*   /*****************************************************************/
*                                                                  0214
*   GEN(MVC    MOVEMACS(MACLEN),MACSTRT);                          0214
*                                                                  0214
         MVC    MOVEMACS(MACLEN),MACSTRT
*CNTPRMPT:                                                         0215
*                                                                  0215
*   /*****************************************************************/
*   /*       INITIALIZE THE PSCB USERID LENGTH FIELD TO ZERO         */
*   /*       INITIALIZE ECT DEFAULT VALUES (MAIL NOTICES)            */
*   /*****************************************************************/
*                                                                  0215
*   IKJEFLWP = ''B;               /* ZERO OUT LOGON DATA     @Z40NQKC*/
CNTPRMPT L     @08,LWPPTR                                          0215
         XC    IKJEFLWP(188,@08),IKJEFLWP(@08)                     0215
*   LWPPSWD = '';                 /* INIT PSWD BUFFER        @Z40NQKC
*                                    BLANKS                          */
         MVI   LWPPSWD(@08),C' '                                   0216
         MVC   LWPPSWD+1(7,@08),LWPPSWD(@08)                       0216
*   LWPUSERM = PSCBUSRL;          /* SAVE USERID LENGTH      @Z40NQKC*/
         L     @15,LWAPTR                                          0217
         L     @14,LWAPSCB(,@15)                                   0217
         SLR   @07,@07                                             0217
         IC    @07,PSCBUSRL(,@14)                                  0217
         STH   @07,LWPUSERM(,@08)                                  0217
*   ROIDLEN = ''B;                /* ZERO LENGTH FIELD       @G32OPKU*/
         SLR   @07,@07                                             0218
         STC   @07,ROIDLEN                                         0218
*   ROIDDATA = '';                /* BLANK TEXT FIELD        @G32OPKU*/
         MVI   ROIDDATA,C' '                                       0219
         MVC   ROIDDATA+1(254),ROIDDATA                            0219
*   LWPUSER = PSCBUSER;           /* SAVE USERID FROM PSCB   @Z40NQKC*/
         MVC   LWPUSER(7,@08),PSCBUSER(@14)                        0220
*   PSCBUSRL = 0;                 /* INITIALIZE USERID LENGTH TO ZERO
*                                    IN PSCB, INDICATING THAT WE HAVE
*                                    NOT FOUND A VALID USERID YET.   */
         MVI   PSCBUSRL(@14),X'00'                                 0221
*   JSELJCL = 0;                  /* INDICATE THAT NO JCLS'S HAVE  0222
*                                    BEEN CONSTRUCTED FOR THIS USER. */
         SLR   @08,@08                                             0222
         L     @01,LWAJSEL(,@15)                                   0222
         ST    @08,JSELJCL(,@01)                                   0222
*   READBUF = 0;                  /* INITIALIZE POINTER TO UADS    0223
*                                    INPUT BUFFER TO ZERO.           */
         ST    @08,READBUF                                         0223
*   ECTNMAL = '0'B;               /* SET MAIL AS DEFAULT VALUE       */
*   ECTNNOT = '0'B;               /* SET NOTICES AS DEFAULT VAULE    */
         L     @01,LWAPECT(,@15)                                   0225
         NI    ECTNMAL(@01),B'11110011'                            0225
*   SWCS = SWCS && SWCS;          /* INITIALIZE IKJEFLE'S INTERNAL 0226
*                                    COMMUNICATION SWITCHES TO ZERO
*                                    BITS.                           */
         XC    SWCS(1),SWCS                                        0226
*   IF MODE ^= SUBMIT             /* NORMAL TYPE LOGON       @Z40NQKC*/
*     THEN INBUF = ZERO;          /* INSURE NO COMMAND YET   @Z40NQKC*/
*                                                                  0227
         CLI   MODE,X'01'                                          0227
         BE    @RF00227                                            0227
         ST    @08,INBUF                                           0228
*   /********************************************************@G32OPKU*/
*   /*   INITIALIZE OIDCARD VERIFY ROUTINE POINTERS          @G32OPKU*/
*   /********************************************************@G32OPKU*/
*                                                                  0229
*   OIDPTR = ''B;                 /* CLEAR OIDCD BFR POINTER @G32OPKU*/
@RF00227 SLR   @08,@08                                             0229
         ST    @08,OIDPTR                                          0229
*   OIDLEN = ''B;                 /* CLEAR OIDCD LEN PTR     @G32OPKU*/
*                                                                  0230
         STH   @08,OIDLEN                                          0230
*   /*****************************************************************/
*   /*   TEST LWAILGN BIT IN LWA TO DETERMINE IF INITIAL LOGON,      */
*   /*     RELOGON, OR ATTENTION PROCESSING.                         */
*   /*     IF LWAILGN BIT IS ONE, THIS IS INITIAL LOGON.             */
*   /*     OTHERWISE, IT MAY BE RE-LOGON OR REINITIATION OF LOGON    */
*   /*     PROMPTING DUE TO ATTENTION BEING STRUCK.                  */
*   /*****************************************************************/
*                                                                  0231
*   IF LWAILGN = '1'B             /* IF INITIAL LOGON, GO TO SEE IF
*                                    AN INSTALLATION EXIT (IKJEFLD)
*                                    EXISTS.                         */
*     THEN DO;                       /* INITIA LOGON                 */
         L     @08,LWAPTR                                          0231
         TM    LWAILGN(@08),B'00000001'                            0231
         BNO   @RF00231                                            0231
*       IF TSBVTAM = '1'B            /* VTAM NOT TCAM        @Z40DQKC*/
*         THEN CALL IKTXLOG(INBUF);  /* IKTXLOG WILL SET...  @Z40DQKC*/
         L     @08,TSBPTR                                          0233
         TM    TSBVTAM(@08),B'00000001'                            0233
         BNO   @RF00233                                            0233
         LA    @08,INBUF                                           0234
         ST    @08,@AL00001                                        0234
         L     @15,@CV00276                                        0234
         LA    @01,@AL00001                                        0234
         BALR  @14,@15                                             0234
*                                    /* ...INBUF=ADDR(BUF)   @Z40DQKC*/
*       GO TO GOTOIER;               /* CHECK FOR IKJEFLD            */
         B     GOTOIER                                             0235
*       END;                                                       0236
*    LWADEST2 = '0000000000000000'X; /*CLEAR LWA DEST        @ZA19323*/
@RF00231 L     @08,LWAPTR                                          0237
         MVC   LWADEST2(8,@08),@CB02921                            0237
*    PSCBDEST = '0000000000000000'X; /*CLEAR PSCB DEST       @ZA19323*/
*                                                                  0238
         L     @08,LWAPSCB(,@08)                                   0238
         MVC   PSCBDEST(8,@08),@CB02921                            0238
*   CALL SCAN1;                   /* CALL IKJEFLEA TO COPY         0239
*                                    RELOGON BUFFER                  */
         BAL   @14,SCAN1                                           0239
*   LWAILGN = '0'B;               /* INDICATE THAT IT IS NOLONGER  0240
*                                    INITIAL LOGON                   */
*                                                                  0240
         L     @08,LWAPTR                                          0240
         NI    LWAILGN(@08),B'11111110'                            0240
*GOTOIER:                                                          0241
*                                                                  0241
*   /*****************************************************************/
*   /*       SET UP USER PROFILE TABLE (UPT)                         */
*   /*****************************************************************/
*                                                                  0241
*   IF MODE ^= SUBMIT             /* NORMAL LOGON            @Z40NQKC*/
*     THEN UPT(1:PSCBUPTL) =      /* ZERO OUT THE UPT                */
GOTOIER  CLI   MODE,X'01'                                          0241
         BE    @RF00241                                            0241
*          UPT(1:PSCBUPTL) && UPT(1:PSCBUPTL);                     0242
         L     @08,LWAPTR                                          0242
         L     @08,LWAPSCB(,@08)                                   0242
         L     @01,PSCBUPT(,@08)                                   0242
         LH    @08,PSCBUPTL(,@08)                                  0242
         BCTR  @08,0                                               0242
         EX    @08,@SX03252                                        0242
*   UPTMID = '1'B;                /* INDICATE THAT MESSAGE ID'S WILL
*                                    BE PRINTER DURING LOGON.        */
*                                                                  0243
*                                                                  0243
@RF00241 L     @08,LWAPTR                                          0243
         L     @08,LWAPSCB(,@08)                                   0243
         L     @08,PSCBUPT(,@08)                                   0243
         OI    UPTMID(@08),B'00100000'                             0243
*    IF ADDR(IKJEFLD) ^= 0 &      /* THERE IS LOGON EXIT     @Z40NQKC*/
*       MODE ^= SUBMIT            /* NOT INVOKED BY SUBMIT   @Z40NQKC*/
*     THEN                                                         0244
         L     @08,@CV00270                                        0244
         LTR   @08,@08                                             0244
         BZ    @RF00244                                            0244
         CLI   MODE,X'01'                                          0244
         BE    @RF00244                                            0244
*       DO;                                                        0245
*                                                                  0245
*         /***********************************************************/
*   /*       SET UP TO GO TO INSTALLATION EXIT ROUTINE               */
*         /***********************************************************/
*                                                                  0246
*        RESPECIFY (GPR01P) RSTD;                          /*@Z40NQKC*/
*        GPR01P = ADDR(PARMLST);  /* PARMS FOR IKJEFLI       @Z40NQKC*/
         LA    GPR01P,PARMLST                                      0247
*         CALL  IKJEFLI;      /*  &&&&&&&&*/                       0248
         L     @15,@CV00273                                        0248
         BALR  @14,@15                                             0248
*        RESPECIFY (GPR01P) UNRSTD;                        /*@Z40NQKC*/
*       END;                                                       0250
*                                                                  0250
*   /*****************************************************************/
*   /*       RESET LWA FAIL BITS                                     */
*   /*****************************************************************/
*                                                                  0251
*   LWAUFAI = '0'B;               /* RESET USERID ENQ FAIL BIT       */
@RF00244 DS    0H                                                  0252
*   LWAFAIL = '0'B;               /* RESET SYSTEM RESOURCE FAIL BIT  */
*                                                                  0252
         L     @08,LWAPTR                                          0252
         NI    LWAUFAI(@08),B'01011111'                            0252
*   /*****************************************************************/
*   /*    IF LOGON TO TERMINATE THE TERMINAL SESSION, GO TO SET      */
*   /*    DISCONNECT INDICATOR AND CLEANUP RESOURCES.                */
*   /*****************************************************************/
*                                                                  0253
*   IF LWADISC = '1'B                                              0253
*     THEN                                                         0253
         TM    LWADISC(@08),B'00010000'                            0253
         BO    @RT00253                                            0253
*       GOTO CLEANUP4;                                             0254
*                                                                  0254
*                                                                  0254
*   /*****************************************************************/
*   /*   IF CANCEL ECB HAS BEEN POSTED, GOTO SET DISCONNECT          */
*   /*   INDICATOR AND CLEAN UP RESOURCES.                           */
*   /*****************************************************************/
*                                                                  0255
*   IF CHCECB ^= 0                                                 0255
*     THEN                                                         0255
         L     @01,LWAJSEL(,@08)                                   0255
         L     @01,JSELCSCB(,@01)                                  0255
         L     @15,CHCECB(,@01)                                    0255
         LTR   @15,@15                                             0255
         BZ    @RF00255                                            0255
*       DO;                                                        0256
*         LWAILGN = '0'B;         /* INDICATE THAT IT IS NO LONGER 0257
*                                    INITIAL LOGON                   */
         NI    LWAILGN(@08),B'11111110'                            0257
*         GOTO CLEANUP4;                                           0258
         B     CLEANUP4                                            0258
*       END;                                                       0259
*                                                                  0259
*                                                                  0259
*   IF LWANOPR = '1'B             /* IF INSTALLATION SUPPLIED PARMS  */
*     THEN                                                         0260
@RF00255 L     @08,LWAPTR                                          0260
         TM    LWANOPR(@08),B'00001000'                            0260
         BNO   @RF00260                                            0260
*       DO;                                                        0261
*         LWAILGN = '0'B;         /* INDICATE THAT IT IS NO LONGER 0262
*                                    INITIAL LOGON                   */
*                                                                  0262
*                                                                  0262
         NI    LWAILGN(@08),B'11111110'                            0262
*         IF LWANUAD = '1'B       /* IF UADS NOT TO BE ACCESSED      */
*           THEN                                                   0263
         TM    LWANUAD(@08),B'00000100'                            0263
         BO    @RT00263                                            0263
*             GOTO BUILDJCL;      /* GO TO SEE IF JCL TO BE BUILT    */
*         GOTO OPEN;              /* GO TO CHECK AUTHORIZATION OF  0265
*                                    INSTALLATION SUPPLIED PARAMETERS*/
         B     OPEN                                                0265
*       END;                                                       0266
*                                                                  0266
*     ELSE                        /* IF INSTALLATION HAS NOT SUPPLIED
*                                    PARMS                           */
*       DO;                                                        0267
*                                                                  0267
*                                                                  0267
@RF00260 DS    0H                                                  0268
*         IF LWAILGN = '1'B       /* INITIAL LOGON, SEE IF WE MUST 0268
*                                    GET LINE                        */
*           THEN                                                   0268
         L     @08,LWAPTR                                          0268
         TM    LWAILGN(@08),B'00000001'                            0268
         BNO   @RF00268                                            0268
*             DO;                                                  0269
*               LWAILGN = '0'B;   /* INDICATE NOT INITIAL LOGON    0270
*                                    ANY MORE                        */
         NI    LWAILGN(@08),B'11111110'                            0270
*               PMSGNM = 0;       /* SET MESSAGE NUMBER TO ZERO TO 0271
*                                    INDICATE GETLINE                */
*                                                                  0271
         SLR   @08,@08                                             0271
         STH   @08,PMSGNM                                          0271
*               IF INBUF = 0      /* IF NO INPUT LINE RETURNED BY  0272
*                                    INSTALLATION, GET FIRST LINE     *
*                 THEN                                             0272
         C     @08,INBUF                                           0272
         BNE   @RF00272                                            0272
*                   CALL LGM;     /* CALL IKJEFLGM TO GET LINE       */
         BAL   @14,LGM                                             0273
*             END;                                                 0274
@RF00272 DS    0H                                                  0275
*       END;                                                       0275
*                                                                  0275
@RF00268 DS    0H                                                  0276
*SCANCMND:                                                         0276
*                                                                  0276
*                                                                  0276
*   CALL SCAN2;                   /* CALL IKJEFLEA TO SCAN INPUT LINE
*                                    FOR LOGON OR LOGOFF            */
*                                                                  0276
SCANCMND BAL   @14,SCAN2                                           0276
*STRTLOGN:                                                         0277
*                                                                  0277
*   /*****************************************************************/
*   /*       PREPARE TO EXAMINE USERID                               */
*   /*****************************************************************/
*                                                                  0277
*   PRMTSWC =  1 ;                /* SET PROMPTING SWITCHES TO     0277
*                                    INDICATE PROMPTING IS FOR     0277
*                                    USERID.                         */
STRTLOGN MVC   PRMTSWC(2),@CH00037                                 0277
*   PMSGNM = 7;                   /* INDICATE USERID NOT AUTHORIZED
*                                    MESSAGE TO BE LISTED.           */
         MVC   PMSGNM(2),@CH00133                                  0278
*   CALL PROMPT1;                 /* PARSE FOR USERID                */
*                                                                  0279
         BAL   @14,PROMPT1                                         0279
*   IF MODE = SUBMIT              /* IF INVOKED BY SUBMIT... @Z40NQKC*/
*     THEN RETURN CODE(RTNREG);   /*   THEN RETURN TO SUBMIT @Z40NQKC*/
         CLI   MODE,X'01'                                          0280
         BNE   @RF00280                                            0280
         L     @14,@SA00002                                        0281
         LM    @00,@12,@SA00002+8                                  0281
         BR    @14                                                 0281
*   IF LWPRECON = YES              /* IF RECONNECT REQUESTED  @G32OPKU*
*     THEN CALL RECONECT;          /*  AND NOT SUBMIT         @G32OPKU*
@RF00280 L     @08,LWPPTR                                          0282
         TM    LWPRECON(@08),B'10000000'                           0282
         BNO   @RF00282                                            0282
         BAL   @14,RECONECT                                        0283
*                                  /*  THEN TRY TO RECONNECT          *
*OPEN:                                                             0284
*                                                                  0284
*   /*****************************************************************/
*   /*       SET NO PASSWORD REQUIRED BIT ON                         */
*   /*        ENQUEUE ON AND OPEN UADS                               */
*   /*****************************************************************/
*                                                                  0284
*   JSCBPASS = '1'B;              /* SET NO PASSWORD REQUIRED BIT  0284
*                                    ON IN THE JSCB.          A41867 */
@RF00282 DS    0H                                                  0284
OPEN     L     @08,CVTPTR                                          0284
         L     @08,CVTTCBP(,@08)                                   0284
         L     @08,TCBCPTR(,@08)                                   0284
         L     @08,TCBJSCB(,@08)                                   0284
         OI    JSCBPASS(@08),B'10000000'                           0284
*   CALL ENQUADS;                 /* ENQ ON SYS1.UADS        @Z40NQKC*/
*                                                                  0285
         BAL   @14,ENQUADS                                         0285
*   GEN(OPEN   (UADSDCB,INPUT),MF=(E,OPENUADS)); /* OPEN UADS        */
*                                                                  0286
*                                                                  0286
         OPEN   (UADSDCB,INPUT),MF=(E,OPENUADS)
*   IF DCBOFLGS(4) ^= '1'B        /* IF DCB HAS NOT BEEN OPENED    0287
*                                    SUCCESSFULLY, GO TO SYSTEM    0287
*                                    TROUBLE ROUTINE.                */
*     THEN                                                         0287
         TM    DCBOFLGS,B'00010000'                                0287
         BNO   @RT00287                                            0287
*       GOTO NOOPEN;              /* GOTO SEND TERMINATION MESSAGE 0288
*                                    TO TERMINAL USER.               */
*   LWAPDCB=ADDR(UADSDCB);        /*POINT TO DCB - USED IN     Y02653*/
         LA    @08,UADSDCB                                         0289
         L     @01,LWAPTR                                          0289
         ST    @08,LWAPDCB(,@01)                                   0289
*                                 /*STAI PROCESSING            Y02653*/
*                                                                  0290
*CKUSER:                                                           0290
*                                                                  0290
*   /*****************************************************************/
*   /*       CHECK AUTHORIZATION OF USER                             */
*   /*****************************************************************/
*                                                                  0290
*   FINDNAME = LWPUSER;           /* INIT NAME TO FIND       @Z40NQKC*/
CKUSER   MVI   FINDNAME+7,C' '                                     0290
         L     @08,LWPPTR                                          0290
         MVC   FINDNAME(7),LWPUSER(@08)                            0290
*   FINDNAME(LWPUSERL+1) = '0';   /* 1ST PHYSICAL BLOCK      @Z40NQKC
*                                    BLOCK FOR THIS USERID           */
         LH    @08,LWPUSERL(,@08)                                  0291
         LA    @01,FINDNAME(@08)                                   0291
         MVI   0(@01),C'0'                                         0291
*   GEN(FIND  UADSDCB,FINDNAME,D); /* SEARCH DIRECTORY FOR USERID    */
         FIND  UADSDCB,FINDNAME,D
*   RESPECIFY (GPR15P,SVRTN) RSTD;                         /*@Z40NQKC*/
*   SVRTN = GPR15P;               /* SAVE FIND RETURN CODE   @Z40NQKC*/
         LR    SVRTN,GPR15P                                        0294
*   RESPECIFY (GPR15P) UNRSTD;                             /*@Z40NQKC*/
*   /*****************************************************************/
*   /*  TEST RETURN CODES FROM FIND.                                 */
*   /*  RETURN CODE               CONDITION                          */
*   /*      0       USERID IS AUTHORIZED TO SYSTEM - CONTINUE        */
*   /*              LOGON PROCESSING                                 */
*   /*      4       USERID NOT AUTHORIZED - PROMPT USER FOR A        */
*   /*              NEW USERID                                       */
*   /*      8       I/O ERROR ON UADS DIRECTORY - TRANSMIT  ERROR    */
*   /*              MESSAGE TO TERMINAL AND SYSTEM OPERATOR, THEN    */
*   /*              DISCONNECT TERMINAL.                             */
*   /*****************************************************************/
*                                                                  0296
*   IF SVRTN ^= 0                 /* IF USERID NOT AUTHORIZED,     0296
*                                    DETERMINE REASON FOR FAILURE.   */
*     THEN                                                         0296
         LTR   SVRTN,SVRTN                                         0296
         BZ    @RF00296                                            0296
*       DO;                                                        0297
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) ); /* CLOSE UADS DCB   */
         CLOSE (UADSDCB),MF=(E,CLOSUADS)
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0299
*                                    OFF IN THE JSCB.         A41867 */
         L     @08,CVTPTR                                          0299
         L     @08,CVTTCBP(,@08)                                   0299
         L     @08,TCBCPTR(,@08)                                   0299
         L     @08,TCBJSCB(,@08)                                   0299
         NI    JSCBPASS(@08),B'01111111'                           0299
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/
*                                                                  0300
         L     @08,LWAPTR                                          0300
         SLR   @06,@06                                             0300
         ST    @06,LWAPDCB(,@08)                                   0300
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/
*                                                                  0301
         BAL   @14,DEQUADS                                         0301
*         IF SVRTN = 4            /* IF USERID NOT AUTHORIZED, PROMPT
*                                    USER FOR A NEW USERID.          */
*           THEN                                                   0302
         C     SVRTN,@CF00098                                      0302
         BNE   @RF00302                                            0302
*             DO;                                                  0303
*               TEXTINT1(1) = ADDR(LWPUSERI); /* GET ADDRESS @Z40NQKC
*                                    USERID TEXT INSERTION BUFFER.   */
         L     @08,LWPPTR                                          0304
         LA    @08,LWPUSERI(,@08)                                  0304
         ST    @08,TEXTINT1                                        0304
*               PRMTSWC =  1 ;    /* SET PROMPTING SWITCH TO ONE,  0305
*                                    INDICATING PROMPT FOR USERID.   */
         MVC   PRMTSWC(2),@CH00037                                 0305
*               CALL PROMPT;      /* PROMPT FOR A NEW USERID         */
         BAL   @14,PROMPT                                          0306
*               GOTO OPEN;        /* CHECK AUTHORIZATION OF USERID.  */
         B     OPEN                                                0307
*             END;                                                 0308
*         GOTO IOERROR;           /* I/O ERROR ON UADS DIRECTORY.  0309
*                                    GOTO TERMINATE SESSION.         */
         B     IOERROR                                             0309
*       END;                                                       0310
*   RESPECIFY (SVRTN) UNRSTD;                                      0311
*                                                                  0311
@RF00296 DS    0H                                                  0312
*                                                                  0312
*   /*****************************************************************/
*   /*       PUT USERID AND USERID LENGTH INTO THE PSCB              */
*   /*****************************************************************/
*                                                                  0312
*   FINDNAME(LWPUSERL+1) = '';    /* BLANK THE NAME          @Z40NQKC*/
         L     @08,LWPPTR                                          0312
         LH    @08,LWPUSERL(,@08)                                  0312
         LA    @01,FINDNAME(@08)                                   0312
         MVI   0(@01),C' '                                         0312
*   PSCBUSER(1:7) = FINDNAME;     /* MOVE USERID TO PSCB USERID FIELD*/
         L     @15,LWAPTR                                          0313
         L     @14,LWAPSCB(,@15)                                   0313
         MVC   PSCBUSER(7,@14),FINDNAME                            0313
*   LWARNM = FINDNAME(1:7);       /* USERID TO LWA                   */
         MVC   LWARNM(7,@15),FINDNAME                              0314
*   PSCBUSRL = LWPUSERL;          /* SAVE LENGTH OF USERID.  @Z40NQKC*/
         STC   @08,PSCBUSRL(,@14)                                  0315
*   LWARNML = LWPUSERL;           /* USERID LENGTH TO LWA            */
         STC   @08,LWARNML(,@15)                                   0316
*   RESPECIFY (WECBPTR) RSTD;                                      0317
*                                                                  0317
*  DO;  /*ENQ (SYSIKJUA,LWARNM,E,LWARNML,SYSTEM) TCB(LWASTCB->LOGONTCB)
*RET(USE)*/                                                        0318
*  RESPECIFY (GPR01P) RESTRICTED;                                  0319
*  I056(1:20)=I056(1:20) &&I056(1:20);  /*ZERO OUT THE TABLE*/     0320
         XC    I056(20),I056                                       0320
*  I05604(1)=LWARNML;  /*LENGTH OF MINOR RESOURCE NAME*/           0321
         STC   @08,I05604                                          0321
*  I05606(1)=ADDR(SYSIKJUA);  /*ADDRESS OF MAJOR RESOURCE NAME*/   0322
         LA    @08,SYSIKJUA                                        0322
         ST    @08,I05606                                          0322
*  I05607(1)=ADDR(LWARNM);  /*ADDRESS OF MINOR RESOURCE NAME*/     0323
         LA    @08,LWARNM(,@15)                                    0323
         ST    @08,I05607                                          0323
*  I05603(1)='00000001'B;  /*SET BIT STRING 1 FOR RESOURCE ELEMENT*/
         MVI   I05603,B'00000001'                                  0324
*  I05605(1)='01000011'B;  /*SET BIT STRING 2 FOR RESOURCE ELEMENT*/
         MVI   I05605,B'01000011'                                  0325
*  I05601=ADDR(LWASTCB->LOGONTCB);  /*TCB ADDRESS*/                0326
         L     @08,LWASTCB(,@15)                                   0326
         ST    @08,I05601                                          0326
*  I05603(1,1)='1'B;  /*SET END OF LIST BIT*/                      0327
         OI    I05603,B'10000000'                                  0327
*  GPR01P=ADDR(I05602);  /*LOAD LIST ADDRESS*/                     0328
         LA    GPR01P,I05602                                       0328
*  SVC (56);  /*ISSUE ENQ SVC*/                                    0329
         SVC   56                                                  0329
*  RESPECIFY (GPR01P) UNRESTRICTED;                                0330
*  END;  /*ENQ (SYSIKJUA,LWARNM,E,LWARNML,SYSTEM) TCB(LWASTCB->LOGONTCB
* RET(USE)*/                                                       0331
*   RESPECIFY (WECBPTR) UNRSTD;                                    0332
*   /*****************************************************************/
*   /*       IF ENQUEUE UNSUCCESSFUL, THEN SET ENQUEUE FAIL BIT      */
*   /*       IN CONTROL BIT STRING (LWA)                             */
*   /*       CLOSE UADS DCB                                          */
*   /*       SET NO PASSWORD REQUIRED BIT OFF                        */
*   /*       SEND ERROR MESSAGE TO TERMINAL & PROMPT FOR LOGON       */
*   /*       OR LOGOFF                                               */
*   /*****************************************************************/
*                                                                  0333
*   IF I05655(1) ^= 0             /* IF ENQ ON USERID FAILED @Z40RQKC
*                                    SET BIT IN CONTROL BIT STRING TO
*                                    INDICATE UNSUCCESSFUL ENQUEUE.  */
*     THEN                                                         0333
         CLI   I05655,0                                            0333
         BE    @RF00333                                            0333
*       DO;                                                        0334
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/
         BAL   @14,DEQUADS                                         0335
*                                 /* AFTER I05655 ENQ CHECK  @Z40NQKC*/
*         LWAUFAI = '1'B;         /* TURN ENQUEUE FAIL BIT ON        */
         L     @08,LWAPTR                                          0336
         OI    LWAUFAI(@08),B'10000000'                            0336
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) ); /* CLOSE UADS DCB   */
         CLOSE (UADSDCB),MF=(E,CLOSUADS)
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0338
*                                    OFF IN THE JSCB.         A41867 */
         L     @08,CVTPTR                                          0338
         L     @08,CVTTCBP(,@08)                                   0338
         L     @08,TCBCPTR(,@08)                                   0338
         L     @08,TCBJSCB(,@08)                                   0338
         NI    JSCBPASS(@08),B'01111111'                           0338
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/
*                                                                  0339
         L     @08,LWAPTR                                          0339
         SLR   @15,@15                                             0339
         ST    @15,LWAPDCB(,@08)                                   0339
*UENQFAIL:                                                         0340
*                                                                  0340
*         PMSGNM = 24;            /* SET MESSAGE NUMBER TO USERID  0340
*                                    IN USE MESSAGE.                 */
UENQFAIL MVC   PMSGNM(2),@CH00080                                  0340
*         TEXTINT1(1) = ADDR(LWPUSERI); /* ADDR OF USERID    @Z40NQKC
*                                    INSERTION BUFFER.               */
         L     @08,LWPPTR                                          0341
         LA    @08,LWPUSERI(,@08)                                  0341
         ST    @08,TEXTINT1                                        0341
*         CALL LGM;               /* CALL MESSAGE MODULE TO        0342
*                                    SEND MESSAGE TO TERMINAL.       */
*                                                                  0342
         BAL   @14,LGM                                             0342
*         /***********************************************************/
*         /*  ZERO OUT 'PSCBUSRL' FIELD SO THAT WE DO NOT TRY TO     */
*         /*  DEQUEUE FROM IT IN ERROR CLEANUP ROUTINE. REINITIALIZE */
*         /*  'USERID', 'PASSWORD', 'ACCOUNT NUMBER', ETC., BUFFER.  */
*         /*  FREE ANY 'JCLS' BUILT BY MODULE IKJEFLI.               */
*         /***********************************************************/
*                                                                  0343
*         PSCBUSRL = 0;           /* INDICATE NO 'USERID' FOUND YET  */
         L     @08,LWAPTR                                          0343
         L     @01,LWAPSCB(,@08)                                   0343
         MVI   PSCBUSRL(@01),X'00'                                 0343
*         IKJEFLWP = ''B;         /* ZERO LOGON DATA         @Z40NQKC
*                                    ACCOUNT NUMBER, ETC., BUFFER.   */
         L     @15,LWPPTR                                          0344
         XC    IKJEFLWP(188,@15),IKJEFLWP(@15)                     0344
*         LWPPSWD = ' ';          /* BLANK THE PASSWORD      @Z40NQKC*/
         MVI   LWPPSWD+1(@15),C' '                                 0345
         MVC   LWPPSWD+2(6,@15),LWPPSWD+1(@15)                     0345
         MVI   LWPPSWD(@15),C' '                                   0345
*         ECTNMAL = '0'B;         /* RESET DEFAULT OF 'MAIL'         */
*         ECTNNOT = '0'B;         /* RESET DEFAULT OF 'NOTICES'      */
         L     @08,LWAPECT(,@08)                                   0347
         NI    ECTNMAL(@08),B'11110011'                            0347
*         CALL FREEJCLS;          /* FREE ANY JCLS BUILT BY IKJEFLI  */
         BAL   @14,FREEJCLS                                        0348
*         GOTO GOTOIER;           /* GOTO INSTALLATION EXIT ROUTINE. */
         B     GOTOIER                                             0349
*       END;                                                       0350
*     ELSE CALL DEQUADS;          /* DEQUE FROM UADS DIR     @Z40NQKC*/
*                                                                  0351
@RF00333 BAL   @14,DEQUADS                                         0351
*   /*****************************************************************/
*   /*       USERID IS VALID, SO CONTINUE VALIDITY CHECKING          */
*   /*       REMAINING LOGON PARAMETERS.                             */
*   /*       PUT USERID INTO CSCB.                                   */
*   /*****************************************************************/
*   CHKEY = FINDNAME;             /* MOVE USERID TO THE CSCB         */
         L     @08,LWAPTR                                          0352
         L     @01,LWAJSEL(,@08)                                   0352
         L     @15,JSELCSCB(,@01)                                  0352
         MVC   CHKEY(8,@15),FINDNAME                               0352
*   ASCBJBNS=ADDR(CHKEY);         /*PUT PTR TO USERID IN ASCB  Y02669*/
*                                                                  0353
         L     @08,LWAPASCB(,@08)                                  0353
         LA    @15,CHKEY(,@15)                                     0353
         ST    @15,ASCBJBNS(,@08)                                  0353
*   /*****************************************************************/
*   /*       OBTAIN BUFFER FOR UADS MEMBER                           */
*   /*       READ IN HEADER BLOCK FOR THIS USER                      */
*   /*****************************************************************/
*                                                                  0354
*   RESPECIFY (LENBUF) RSTD;                                       0354
*   LENBUF = DCBBLKSI;            /* GET LENGTH OF BLOCKSIZE NEEDED
*                                    FOR UADS MEMBER RECORD          */
         LH    LENBUF,DCBBLKSI                                     0355
*   GEN(GETMAIN  R,SP=1,LV=(LENBUF)); /* OBTAIN CORE FOR ONE BUFFER  */
         GETMAIN  R,SP=1,LV=(LENBUF)
*   RESPECIFY (GTMNPTR) RSTD;                                      0357
*   READBUF = GTMNPTR;            /* SAVE ADDRESS OF UADS BUFFER     */
         ST    GTMNPTR,READBUF                                     0358
*   RESPECIFY (GTMNPTR,LENBUF) UNRSTD;                             0359
*   UADSNDAT = 0;                                                  0360
         SLR   @08,@08                                             0360
         ST    @08,UADSNDAT                                        0360
*   CALL FIND1;                   /* READ IN FIRST PHYSICAL MEMBER 0361
*                                    FROM UADS FOR THIS USERID       */
*                                                                  0361
         BAL   @14,FIND1                                           0361
*   IF UADSEXPF='1'B              /*IF EXPANDED FORMAT UADS    Y02669*/
*     THEN                        /*THEN                       Y02669*/
         L     @08,READBUF                                         0362
         TM    UADSEXPF(@08),B'01000000'                           0362
         BNO   @RF00362                                            0362
*       DO;                       /*                           Y02669*/
*         EXPUADS='1'B;           /*SAVE INDICATOR FOR EXPUADS Y02669*/
         OI    EXPUADS,B'00001000'                                 0364
*         SAVEPERP=UADSPERP;      /*SAVE OFFSET TO             Y02669*/
         L     @15,UADSPERP(,@08)                                  0365
         ST    @15,SAVEPERP                                        0365
*                                 /*PERFORMANCE GROUP DATA     Y02669*/
*         IF LWADEST='0'B &       /*IF INSTALLATION DID NOT    Y02664*/
*                                 /*SUPPLY DEST AND            Y02664*/
*                                 /*DEST IS NOT DEFAULT DEST   Y02664*/
*            UADSDEST^='0000000000000000'X  /* THEN            Y02664*/
*          THEN                   /*HAVE SUBSYSTEM VERIFY DEST Y02664*/
         L     @01,LWAPTR                                          0366
         TM    LWADEST(@01),B'00000100'                            0366
         BNZ   @RF00366                                            0366
         CLC   UADSDEST(8,@08),@CB02921                            0366
         BE    @RF00366                                            0366
*            DO;                  /*                           Y02664*/
*              SSOB=SSOB&&SSOB;   /*CLEAR CONTROL BLOCK        Y02664*/
         XC    SSOB(20),SSOB                                       0368
*              SSOBID='SSOB';     /*SET CNTL BLOCK ID          Y02664*/
         MVC   SSOBID(4),@CC02957                                  0369
*              SSOBLEN=LENGTH(SSOB); /*SET CNTL BLOCK LENGTH   Y02664*/
         MVC   SSOBLEN(2),@CH00340                                 0370
*              SSOBFUNC=SSOBUSER; /*SET FUNCTION ID            Y02664*/
         MVC   SSOBFUNC(2),@CH00033                                0371
*              SSOBINDV=ADDR(SSUS);  /*SET PTR TO FNCTION AREA Y02664*/
         LA    @03,SSUS                                            0372
         ST    @03,SSOBINDV                                        0372
*              SSUS=SSUS&&SSUS;   /*CLEAR CONTROL BLOCK        Y02664*/
         XC    SSUS(16),SSUS                                       0373
*              SSUSLEN=LENGTH(SSUS); /*SET LEN OF FUNCTN AREA  Y02664*/
         MVC   SSUSLEN(2),@CH00145                                 0374
*              SSUSUSER=UADSDEST; /*INDICATE DESTINATION FROM  Y02664*/
         MVC   SSUSUSER(8),UADSDEST(@08)                           0375
*                                 /*UADS TO BE VERIFIED        Y02664*/
*                                                                  0376
*              SSIBPTR=ADDR(DUMYSSIB);  /*POINT TO SSIB        Y02664*/
         LA    SSIBPTR,DUMYSSIB                                    0376
*              SSOBSSIB=SSIBPTR;  /*POINT SSOB TO SSIB         Y02664*/
         ST    SSIBPTR,SSOBSSIB                                    0377
*              SSIB=SSIB&&SSIB;   /*CLEAR SSIB                 Y02664*/
         XC    SSIB(36,SSIBPTR),SSIB(SSIBPTR)                      0378
*              SSIBID='SSIB';     /*SET CNTL BLK ID            Y02664*/
         MVC   SSIBID(4,SSIBPTR),@CC02958                          0379
*              SSIBLEN=LENGTH(SSIB); /*SET CNTL BLOCK LEN      Y02664*/
         MVC   SSIBLEN(2,SSIBPTR),@CH00497                         0380
*              SSIBSSNM=JESPJESN; /*SET SUBSYSTEM NAME         Y02664*/
*                                                                  0381
*                                                                  0381
         L     @08,CVTPTR                                          0381
         L     @08,CVTJESCT(,@08)                                  0381
         MVC   SSIBSSNM(4,SSIBPTR),JESPJESN(@08)                   0381
*               /* ? IEFSSREQ  (SSOB);*/                           0382
*/*                                           */                   0382
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO   */                   0382
*/*  PROCESS REQUEST -                        */                   0382
*/*                                           */                   0382
*/*    INPUT - REGISTER 1 POINTS TO A ONE-    */                   0382
*/*            WORD PARAMETER LIST WHICH      */                   0382
*/*            POINTS TO THE SSOB             */                   0382
*/*                                           */                   0382
*CALL SSREQ(SSOB);   /*INVOKE SUBSYSTEM           Y02664*/         0382
*                                                                  0382
         LA    @15,SSOB                                            0382
         ST    @15,@AL00001                                        0382
         MVI   @AL00001,X'80'                                      0382
         L     @15,JESSSREQ(,@08)                                  0382
         LA    @01,@AL00001                                        0382
         BALR  @14,@15                                             0382
*              RESPECIFY (RTNREG) RSTD;  /*                    Y02664*/
*              IF RTNREG = 0         /*IF SUBSYSTEM INTERFACE  Y02664*/
*                THEN                /*WAS VALID               Y02664*/
         SLR   @14,@14                                             0384
         CR    RTNREG,@14                                          0384
         BNE   @RF00384                                            0384
*                 DO;                /*THEN                    Y02664*/
*                   IF SSOBRETN=SSUSRTOK   /*IF DEST WAS VALID Y02664*/
*                     THEN DO;               /* SAVE DEST            */
         C     @14,SSOBRETN                                        0386
         BNE   @RF00386                                            0386
*                       LWADEST2 = UADSDEST;                       0388
         L     @14,LWAPTR                                          0388
         L     @08,READBUF                                         0388
         MVC   LWADEST2(8,@14),UADSDEST(@08)                       0388
*                       PSCBDEST = UADSDEST;               /*@ZA07487*/
         L     @14,LWAPSCB(,@14)                                   0389
         MVC   PSCBDEST(8,@14),UADSDEST(@08)                       0389
*                       END;                                       0390
*                      ELSE             /*IF DEST NOT VALID    Y02664*/
*                        IF SSOBRETN=SSUSNOUS /*IF UNDEFINED   Y02664*/
*                          THEN         /* THEN                Y02664*/
         B     @RC00386                                            0391
@RF00386 CLC   SSOBRETN(4),@CF00098                                0391
         BNE   @RF00391                                            0391
*                            DO;  /*PUT OUT MSG-'INVALID DEST, Y02664*/
*                                 /*  DEFAULT DEST TO BE USED' Y02664*/
*                              PMSGNM=49;  /*                  Y02664*/
         MVC   PMSGNM(2),@CH02959                                  0393
*                                /*SET UP TEXT INSERT FOR DEST Y02664*/
*                              TEXTINT1(1)=ADDR(TEXTSEGS(1));/*Y02664*/
         LA    @14,TEXTSEGS                                        0394
         ST    @14,TEXTINT1                                        0394
*                              TEXTSLEN(1)=12;       /*        Y02664*/
         MVC   TEXTSLEN(2),@CH00034                                0395
*                              TEXTSTXT(1)=UADSDEST; /*        Y02664*/
         MVI   TEXTSTXT+8,C' '                                     0396
         MVC   TEXTSTXT+9(11),TEXTSTXT+8                           0396
         L     @14,READBUF                                         0396
         MVC   TEXTSTXT(8),UADSDEST(@14)                           0396
*                              CALL LGM;  /*SEND MSG TO TERM   Y02664*/
         BAL   @14,LGM                                             0397
*                            END;         /*                   Y02664*/
*                                                                  0398
*                        ELSE     /*IF SUBSYSTEM ERROR CODE    Y02664*/
*                          DO;    /*PUT OUT ERROR MSG          Y02664*/
         B     @RC00391                                            0399
@RF00391 DS    0H                                                  0400
*                                 /*AND TERMINATE              Y02664*/
*                            RESPECIFY (SUBSYSRC) RSTD;    /*@Z40RQKC*/
*                            SUBSYSRC=SSOBRETN; /*PREPARE CVD  Y02664*/
         L     SUBSYSRC,SSOBRETN                                   0401
*                            GENERATE;    /*                   Y02664*/
                             CVD SUBSYSRC,CONVERT   CONVERT RC Y02664
                             UNPK ZONEDEC(8),CONVERT(8)        Y02664
                             OI   ZONEDEC+7,X'F0' FIX SIGN     Y02664
*                                 /*PUT RETURN CODE IN MSG      02664*/
*                            RESPECIFY (SUBSYSRC) UNRSTD;  /*@Z40RQKC*/
*                            TEXTSLEN(2)=7;  /*SET TEXT LEN    Y02664*/
         MVC   TEXTSLEN+24(2),@CH00133                             0404
*                            TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*  Y02664*/
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            0405
*                            TEXTSLEN(1)=8;  /*SET TEXT LEN    Y02664*/
         MVC   TEXTSLEN(2),@CH00046                                0406
*                            TEXTSTXT(1,1:4)=JESPJESN; /*PUT   Y02664*/
         L     @14,CVTPTR                                          0407
         L     @14,CVTJESCT(,@14)                                  0407
         MVC   TEXTSTXT(4),JESPJESN(@14)                           0407
*                                         /*IN SUBSYSTEM NAME  Y02664*/
*                            GO TO SETUPMSG; /*SEND OUT MSG    Y02664*/
         B     SETUPMSG                                            0408
*                          END;         /*                     Y02664*/
*                  END;                 /*                     Y02664*/
*                                                                  0410
*              ELSE               /*IF SUBSYSTEM INTERFACE     Y02664*/
*                DO;              /*PROBLEM, PUT OUT MSG       Y02664*/
         B     @RC00384                                            0411
@RF00384 DS    0H                                                  0412
*                  GENERATE;          /*                       Y02664*/
*                                                                  0412
                   CVD RTNREG,CONVERT CONVERT RC               Y02664
                   UNPK ZONEDEC(8),CONVERT(8)                  Y02664
                   OI   ZONEDEC+7,X'F0'  FIX SIGN              Y02664
*                  TEXTSLEN(2)=7; /*SET TEXT LEN               Y02664*/
         MVC   TEXTSLEN+24(2),@CH00133                             0413
*                  TEXTSTXT(2,1:3)=ZONEDEC(6:8);  /*           Y02664*/
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            0414
*                  TEXTSTXT(1,1:5)=JESPJESN; /*PUT IN          Y02664*/
         MVI   TEXTSTXT+4,C' '                                     0415
         L     @14,CVTPTR                                          0415
         L     @14,CVTJESCT(,@14)                                  0415
         MVC   TEXTSTXT(4),JESPJESN(@14)                           0415
*                                 /*SUBSYSTEM NAME             Y02664*/
*                  TEXTSTXT(1,6:14)='INTERFACE'; /*            Y02664*/
         MVC   TEXTSTXT+5(9),@CC02962                              0416
*                  TEXTSLEN(1)=18;  /*SET TEXT LEN             Y02664*/
         MVC   TEXTSLEN(2),@CH00090                                0417
*                  GO TO SETUPMSG;  /*SEND OUT ERROR MSG       Y02664*/
         B     SETUPMSG                                            0418
*                END;             /*                           Y02664*/
*           END;                  /*                           Y02664*/
@RC00384 DS    0H                                                  0421
*      END;                       /*                           Y02664*/
@RF00366 DS    0H                                                  0422
*                RESPECIFY (RTNREG) UNRSTD; /*                 Y02664*/
*                                                                  0422
@RF00362 DS    0H                                                  0423
*   IF UADSMAXC = 0               /* IF MAXIMUM CORE SIZE IN UADS IS
*                                    ZERO, INDICATE NO MAXIMUM SIZE. */
*     THEN                                                         0423
         L     @08,READBUF                                         0423
         LH    @08,UADSMAXC(,@08)                                  0423
         N     @08,@CF03257                                        0423
         LTR   @08,@08                                             0423
         BNZ   @RF00423                                            0423
*       MAXCORE = 32767;          /* DEFAULT MAXIMUM REGION SIZE     */
         MVC   MAXCORE(2),@CH02964                                 0424
*     ELSE                                                         0425
*       MAXCORE = UADSMAXC;       /* RECORD MAXIMUM FROM UADS HEADER */
*                                                                  0425
*                                                                  0425
         B     @RC00423                                            0425
@RF00423 L     @08,READBUF                                         0425
         LH    @08,UADSMAXC(,@08)                                  0425
         N     @08,@CF03257                                        0425
         STH   @08,MAXCORE                                         0425
*   IF LWAATR1 = '0'B             /* IF INSTALLATION EXIT DID NOT  0426
*                                    SUPPLY FIRST ATTRIBUTE BIT    0426
*                                    STRING, THEN RECORD IT FROM UADS*/
*     THEN                                                         0426
@RC00423 L     @08,LWAPTR                                          0426
         TM    LWAATR1(@08),B'10000000'                            0426
         BNZ   @RF00426                                            0426
*         PSCBATR1 = UADSATR;                                      0427
*                                                                  0427
         L     @08,LWAPSCB(,@08)                                   0427
         L     @01,READBUF                                         0427
         MVC   PSCBATR1(2,@08),UADSATR(@01)                        0427
*   IF LWAATR2 = '0'B             /* IF INSTALLATION EXIT DIDNOT   0428
*                                    SUPPLY SECOND ATTRIBUTE BIT   0428
*                                    STRING, RECORD IT FROM UADS.    */
*     THEN                                                         0428
@RF00426 L     @08,LWAPTR                                          0428
         TM    LWAATR2(@08),B'01000000'                            0428
         BNZ   @RF00428                                            0428
*       PSCBATR2 = UADSINST;                                       0429
*                                                                  0429
         L     @08,LWAPSCB(,@08)                                   0429
         L     @01,READBUF                                         0429
         MVC   PSCBATR2(2,@08),UADSINST(@01)                       0429
*    PSCBSUBH = UADSSUBH;         /* HOLD CLASS              @DZ04005*/
@RF00428 L     @08,LWAPTR                                          0430
         L     @15,LWAPSCB(,@08)                                   0430
         L     @14,READBUF                                         0430
         MVC   PSCBSUBH(1,@15),UADSSUBH(@14)                       0430
*    PSCBSUBC = UADSSUBC;         /* JOB CLASS               @DZ04005*/
         MVC   PSCBSUBC(1,@15),UADSSUBC(@14)                       0431
*    PSCBSUBM = UADSSUBM;         /* MESSAGE CLASS           @DZ04005*/
         MVC   PSCBSUBM(1,@15),UADSSUBM(@14)                       0432
*    PSCBSOUT = UADSSOUT;         /* SYSOUT CLASS            @DZ04005*/
*                                                                  0433
         MVC   PSCBSOUT(1,@15),UADSSOUT(@14)                       0433
*   UADSNSUB = UADSPWD1;          /* SAVE OFFSET TO THE FIRST      0434
*                                    PASSWORD OFFSET BLOCK.          */
*                                                                  0434
*                                                                  0434
         L     @15,UADSPWD1(,@14)                                  0434
         ST    @15,UADSNSUB                                        0434
*   IF LWABUPT = '0'B             /* IF INSTALLATION EXIT DID NOT  0435
*                                    SUPPLY UPT IMAGE, RECORD IT FROM
*                                    THE UADS.                       */
*     THEN                                                         0435
         TM    LWABUPT(@08),B'00010000'                            0435
         BNZ   @RF00435                                            0435
*       DO;                                                        0436
*         UADSNDAT = UADSUPTP;    /* SET UP FIND PROCEDURE INTERFACE
*                                    TO READ UPT FROM UADS.          */
         L     @08,UADSUPTP(,@14)                                  0437
         ST    @08,UADSNDAT                                        0437
*         CALL FIND1;             /* CALL FIND TO READ UPT FROM UADS.*/
         BAL   @14,FIND1                                           0438
*         IF EXPUADS = '1'B       /*IF EXPANDED FORMAT UADS    Y02669*/
*           THEN                  /*                           Y02669*/
         TM    EXPUADS,B'00001000'                                 0439
         BNO   @RF00439                                            0439
*             UPT=UADSBUFR->UPT;  /*THEN READ EXPANDED UPT     Y02669*/
         L     @08,LWAPTR                                          0440
         L     @08,LWAPSCB(,@08)                                   0440
         L     @08,PSCBUPT(,@08)                                   0440
         L     @01,UADSBUFR                                        0440
         MVC   UPT(24,@08),UPT(@01)                                0440
*                                 /*ELSE READ OLD FORMAT UPT   Y02669*/
*         ELSE UPT(1:16)=UADSBUFR->UPT;                    /*@Z40RQKC*/
*                                                                  0441
         B     @RC00439                                            0441
@RF00439 L     @08,LWAPTR                                          0441
         L     @08,LWAPSCB(,@08)                                   0441
         L     @08,PSCBUPT(,@08)                                   0441
         L     @01,UADSBUFR                                        0441
         MVC   UPT(16,@08),UPT(@01)                                0441
*         PSCBCHAR=UPTCDEL;       /*PUT CHAR DEL CHAR IN PSCB  Y02669*/
@RC00439 L     @08,LWAPTR                                          0442
         L     @08,LWAPSCB(,@08)                                   0442
         L     @15,PSCBUPT(,@08)                                   0442
         MVC   PSCBCHAR(1,@08),UPTCDEL(@15)                        0442
*         PSCBLINE=UPTLDEL;       /*PUT LINE DEL CHAR IN PSCB  Y02669*/
         MVC   PSCBLINE(1,@08),UPTLDEL(@15)                        0443
*         IF UPTALD = '1'B        /* IF ATTN INDICATOR IS ON   Y02669*/
*           THEN PSCBATTN = '1'B; /* IN UPT, COPY TO PSCB      Y02669*/
*                                                                  0444
         TM    UPTALD(@15),B'00000100'                             0444
         BNO   @RF00444                                            0444
         OI    PSCBATTN(@08),B'00001000'                           0445
*       END;                                                       0446
*                                                                  0446
@RF00444 DS    0H                                                  0447
*   IF EXPUADS = '1'B             /*IF EXPANDED FORMAT UADS    Y02669*/
*     THEN                        /* THEN                      Y02669*/
@RF00435 TM    EXPUADS,B'00001000'                                 0447
         BNO   @RF00447                                            0447
*       DO;                       /* READ USER'S               Y02669*/
*                                 /* VALID PERFORMANCE GROUPS  Y02669*/
*         IF SAVEPERP ^= 0        /* IF PERFORMANCE GROUPS     Y02669*/
*                                 /* AUTHORIZED FOR USERID     Y02669*/
*           THEN                  /* THEN                      Y02669*/
         L     @08,SAVEPERP                                        0449
         LTR   @08,@08                                             0449
         BZ    @RF00449                                            0449
*             DO;                 /*                           Y02669*/
*               UADSNDAT=SAVEPERP; /* SET UP FIND INTERFACE TO Y02669*/
         ST    @08,UADSNDAT                                        0451
*                                 /*READ PERFORM GRP FROM UADS Y02669*/
*               CALL FIND1;       /* CALL FIND TO READ         Y02669*/
         BAL   @14,FIND1                                           0452
*                                 /* AUTHORIZED PERFORM GROUPS Y02669*/
*               UADSPFG1=UADSBUFR->UADSPG; /* MOVE PERFORM     Y02669*/
         L     @08,UADSBUFR                                        0453
         MVC   UADSPFG1(32),UADSPG(@08)                            0453
*                                 /* GROUP DATA FROM UADS      Y02669*/
*                                 /* TO WORK AREA              Y02669*/
*             END;                                                 0454
*         ELSE NOPERFRM='1'B;     /* ELSE INDICATE NO PERFORM  Y02669*/
         B     @RC00449                                            0455
@RF00449 OI    NOPERFRM,B'00010000'                                0455
*                                 /* GROUP IS VALID FOR USERID Y02669*/
*       END;                      /*                           Y02669*/
*                                                                  0456
*   ELSE                          /* IF PRE-VS2/2 UADS FORMAT  Y02669*/
*     DO;                         /* PROVIDE DEFAULTS FOR DEST Y02669*/
         B     @RC00447                                            0457
@RF00447 DS    0H                                                  0458
*                                 /* AND PERFORM GROUPS        Y02669*/
*       IF LWADEST = '0'B         /* IF INSTALLATION DID NOT   Y02669*/
*                                 /* SUPPLY DEST FIELD         Y02669*/
*         THEN                    /* THEN SUPPLY DEFAULT DEST  Y02669*/
         L     @08,LWAPTR                                          0458
         TM    LWADEST(@08),B'00000100'                            0458
         BNZ   @RF00458                                            0458
*           LWADEST2='0000000000000000'X;                   /* Y02669*/
         MVC   LWADEST2(8,@08),@CB02921                            0459
*       NOPERFRM='1'B;            /* INDICATE NO PERFORMANCE   Y02669*/
@RF00458 OI    NOPERFRM,B'00010000'                                0460
*                                 /* GROUPS ARE VALID          Y02669*/
*       IF LWABUPT = '0'B         /* IF INSTALLATION DID NOT   Y02669*/
*                                 /* SUPPLY UPT                Y02669*/
*         THEN                    /* THEN                      Y02669*/
         L     @08,LWAPTR                                          0461
         TM    LWABUPT(@08),B'00010000'                            0461
         BNZ   @RF00461                                            0461
*           DO;                   /*                           Y02669*/
*             UPTPREFX=PSCBUSER;  /*INITIALIZE DSNAME PREFIX   Y02669*/
         L     @08,LWAPSCB(,@08)                                   0463
         L     @15,PSCBUPT(,@08)                                   0463
         MVC   UPTPREFX(7,@15),PSCBUSER(@08)                       0463
*                                 /*FIELD IN UPT TO 'USERID'   Y02669*/
*             UPTPREFL=PSCBUSRL;  /*INITIALIZE DSNAME PREFIX   Y02669*/
         IC    @14,PSCBUSRL(,@08)                                  0464
         STC   @14,UPTPREFL(,@15)                                  0464
*           END;                                                   0465
*     END;                                                         0466
@RF00461 DS    0H                                                  0467
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          FNDPSWD                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INTERFACE WITH RACF THEN CHECK PASSWORD                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0467
*   IF LWPOIDCD = YES &           /* IF IODCARD KEYWORD AND  @G32OPKU*/
*               CVTRAC ^= ZERO &  /* RACF AND                @G32OPKU*/
*               RCVTRID0 ^= ZERO  /* OIDCD VERIFY RTN IS     @G32OPKU*/
*     THEN DO;                    /* PRESENT                 @G32OPKU*/
@RC00447 L     @08,LWPPTR                                          0467
         TM    LWPOIDCD(@08),B'00010000'                           0467
         BNO   @RF00467                                            0467
         SLR   @08,@08                                             0467
         L     @01,CVTPTR                                          0467
         L     @15,CVTRAC(,@01)                                    0467
         CR    @15,@08                                             0467
         BE    @RF00467                                            0467
         C     @08,RCVTRID0(,@15)                                  0467
         BE    @RF00467                                            0467
*       PMSGNM = MSG56437;        /* ENTER OIDCARD MESSAGE   @G32OPKU*/
         MVC   PMSGNM(2),@CH00385                                  0469
*       CALL OIDVERFY;            /* PROMPT FOR OIDCARD      @G32OPKU*/
         BAL   @14,OIDVERFY                                        0470
*       END;                      /*                         @G32OPKU*/
*   CALL RACVERFY;                /* INTERFACE WITH RACF     @Z40RQKC*/
*                                                                  0472
@RF00467 BAL   @14,RACVERFY                                        0472
*   UADSSAVE = UADSNSUB;          /* SAVE OFFSET TO FIRST PROC OFFSET
*                                    BLOCK                           */
         L     @08,UADSNSUB                                        0473
         LR    UADSSAVE,@08                                        0473
*   UADSNNEX = UADSNSUB;          /* SET UP OFFSET IMAGE TO FIND FIRST
*                                    PASSWORD OFFSET AND DATA FIELDS */
         ST    @08,@TF00001                                        0474
         MVC   UADSNNEX(3),@TF00001+1                              0474
*   CALL FIND;                    /* GET FIRST PASSWORD OFFSET AND 0475
*                                    DATA BLOCKS                     */
         BAL   @14,FIND                                            0475
*   IF LWARACF = YES              /* RACF USER               @Z40RQKC*/
*     THEN GO TO RCDPSWD;         /* PSWD ALREADY CHECKED    @Z40RQKC*/
*                                                                  0476
         L     @08,LWAPTR                                          0476
         TM    LWARACF(@08),B'01000000'                            0476
         BO    @RT00476                                            0476
*   PMSGNM = 0;                   /* INDICATE PARAMETER NOT SUPPLIED.*/
         SLR   @08,@08                                             0478
         STH   @08,PMSGNM                                          0478
*   PRMTSWC =  2 ;                                                 0479
*                                                                  0479
*                                                                  0479
         MVC   PRMTSWC(2),@CH00135                                 0479
*   IF UADSNDAT = 0               /* IF PASSWORD NOT SUPPORTED IN  0480
*                                   UADS, RECORD SUPPLIED PSWD     0480
*                                   INTO TSB.                  Y02669*/
*     THEN                                                         0480
         C     @08,UADSNDAT                                        0480
         BE    @RT00480                                            0480
*       GO TO RCDPSWD;                                       /*Y02669*/
*                                                                  0481
*                                                                  0481
*   IF LWPPSWDL = 0               /* IF PASSWORD NOT SUPPLIED, GOTO
*                                    PROMPT USER FOR A NEW ONE.      */
*     THEN                                                         0482
         L     @04,LWPPTR                                          0482
         CH    @08,LWPPSWDL(,@04)                                  0482
         BE    @RT00482                                            0482
*       GOTO PRMTPSWD;                                             0483
*                                                                  0483
*CKPSWD:                                                           0484
*                                                                  0484
*                                                                  0484
*   IF LWPPSWD = UADSPPWD         /* IF PASSWORD AUTHORIZED  @Z40NQKC
*                                    THEN GO TO RECORD IT INTO THE 0484
*                                    TSB                       Y02669*/
*     THEN                                                         0484
CKPSWD   L     @08,LWPPTR                                          0484
         L     @04,UADSBUFR                                        0484
         CLC   LWPPSWD(8,@08),UADSPPWD(@04)                        0484
         BE    @RT00484                                            0484
*       GOTO RCDPSWD;                                              0485
*                                                                  0485
*                                                                  0485
*   IF UADSNFLG ^= '1'B           /* IF MORE PASSWORDS ON THE CHAIN
*                                    FIND NEXT PASSWORD AUTHORIZED TO
*                                    THIS USER.                      */
*     THEN                                                         0486
         TM    UADSNFLG,B'10000000'                                0486
         BO    @RF00486                                            0486
*       DO;                                                        0487
*FNDPSWD1:                                                         0488
*         CALL FIND;              /* GET NEXT PASSWORD OFFSET AND DATA
*                                    DATA BLOCKS.                    */
FNDPSWD1 BAL   @14,FIND                                            0488
*         GOTO CKPSWD;            /* GO TO CHECK VALIDITY OF       0489
*                                    PASSWORD THAT HAS BEEN SUPPLIED.*/
         B     CKPSWD                                              0489
*       END;                                                       0490
*                                                                  0490
*                                                                  0490
*   PMSGNM = 8;                   /* INDICATE PSWD NOT AUTHORIZED  0491
*                                    MESSAGE TO BE LISTED.           */
*                                                                  0491
@RF00486 MVC   PMSGNM(2),@CH00046                                  0491
*PRMTPSWD:                                                         0492
*                                                                  0492
*                                                                  0492
*   CALL PROMPT;                  /* PROMPT FOR NEW PASSWORD.        */
PRMTPSWD BAL   @14,PROMPT                                          0492
*   UADSNNEX = UADSSAVE;          /* SET PASSWORD OFFSET USED BY FIND
*                                    ROUTINE BACK TO OFFSET OF FIRST
*                                    PASSWORD OFFSET BLOCK FOR THIS
*                                    CHAIN (IN UADS).                */
         ST    UADSSAVE,@TF00001                                   0493
         MVC   UADSNNEX(3),@TF00001+1                              0493
*   GOTO FNDPSWD1;                /* BRANCH TO RESTART PASSWORD    0494
*                                    CHECKING.                       */
*                                                                  0494
         B     FNDPSWD1                                            0494
*RCDPSWD:                                                          0495
*                                                                  0495
*  CALL SETLOCK;                  /* OBTAIN CMS LOCK         @G32OPKU*/
*                                                                  0495
RCDPSWD  BAL   @14,SETLOCK                                         0495
*  IF LWPNPSWL ^= ZERO &          /* IF NEW PASSWORD         @G32OPKU*/
*     LWARACF = YES               /* AND RACF HAS OK'ED IT   @G32OPKU*/
*    THEN                         /*                         @G32OPKU*/
         L     @08,LWPPTR                                          0496
         LH    @15,LWPNPSWL(,@08)                                  0496
         LTR   @15,@15                                             0496
         BZ    @RF00496                                            0496
         L     @01,LWAPTR                                          0496
         TM    LWARACF(@01),B'01000000'                            0496
         BNO   @RF00496                                            0496
*      TSBPSWD=LWPNPSWD;          /* MOVE PASSWORD TO TSB    @Z40NQKC*/
         L     @01,TSBPTR                                          0497
         MVC   TSBPSWD(8,@01),LWPNPSWD(@08)                        0497
*    ELSE                         /* OTHERWISE SET           @G32OPKU*/
*      TSBPSWD = LWPPSWD;         /* PASSWORD IN TSB         @G32OPKU*/
*                                                                  0498
         B     @RC00496                                            0498
@RF00496 L     @08,TSBPTR                                          0498
         L     @01,LWPPTR                                          0498
         MVC   TSBPSWD(8,@08),LWPPSWD(@01)                         0498
*  CALL RELLOCK;                  /* RELEASE CMS/LOCAL LOCKS @G32OPKU*/
*                                                                  0499
@RC00496 BAL   @14,RELLOCK                                         0499
*  IF LWPNPSWL ^= ZERO &             /* NEW PASSWORD ENTERED @Z40RQKC*/
*     LWARACF = NO                   /* NON RACF USER        @Z40RQKC*/
*    THEN DO;                                                      0500
         SLR   @08,@08                                             0500
         L     @01,LWPPTR                                          0500
         CH    @08,LWPNPSWL(,@01)                                  0500
         BE    @RF00500                                            0500
         L     @01,LWAPTR                                          0500
         TM    LWARACF(@01),B'01000000'                            0500
         BNZ   @RF00500                                            0500
*      IF CVTRAC = ZERO           /* RACF NOT IN SYSTEM      @Z40RQKC*/
*        THEN PMSGNM = MSG56426;  /* UNSUPPORTED-KEYWORD MSG @Z40RQKC*/
         L     @01,CVTPTR                                          0502
         C     @08,CVTRAC(,@01)                                    0502
         BNE   @RF00502                                            0502
         MVC   PMSGNM(2),@CH00786                                  0503
*        ELSE PMSGNM = MSG56419;  /* UNAUTHORIZED-USER MSG   @Z40RQKC*/
*                                                                  0504
         B     @RC00502                                            0504
@RF00502 MVC   PMSGNM(2),@CH00925                                  0504
*     TEXTINT1(1) = ADDR(INSNPSWD);  /* NEW-PSWD INSERT      @Z40RQKC*/
*                                                                  0505
@RC00502 LA    @08,INSNPSWD                                        0505
         ST    @08,TEXTINT1                                        0505
*     CALL LGM;                      /* SEND MESSAGE         @Z40RQKC*/
*                                                                  0506
         BAL   @14,LGM                                             0506
*     LWPNPSWL = ZERO;               /* INDICATE NO NEW-PSWD @Z40RQKC*/
         L     @08,LWPPTR                                          0507
         SLR   @15,@15                                             0507
         STH   @15,LWPNPSWL(,@08)                                  0507
*     END;                                                         0508
*                                                                  0508
*   IF (ROIDLEN ^= 0                /* OIDCARD ENTERED  AND @G32OPKU*/
*       LWPOIDCD = YES) &            /*                      @G32OPKU*/
*              LWARACF = NO          /* NON RACF USER        @G32OPKU*/
*     THEN DO;                       /*                      @G32OPKU*/
@RF00500 CLI   ROIDLEN,0                                           0509
         BNE   @GL00007                                            0509
         L     @08,LWPPTR                                          0509
         TM    LWPOIDCD(@08),B'00010000'                           0509
         BNO   @RF00509                                            0509
@GL00007 L     @08,LWAPTR                                          0509
         TM    LWARACF(@08),B'01000000'                            0509
         BNZ   @RF00509                                            0509
*       IF CVTRAC = ZERO             /* RACF NOT IN SYSTEM   @G32OPKU*/
*         THEN                                                     0511
         L     @08,CVTPTR                                          0511
         L     @08,CVTRAC(,@08)                                    0511
         LTR   @08,@08                                             0511
         BNZ   @RF00511                                            0511
*           PMSGNM = MSG56426;       /* UNSUPPORTED KEYWORD  @G32OPKU*/
         MVC   PMSGNM(2),@CH00786                                  0512
*         ELSE                                                     0513
*           PMSGNM = MSG56419;       /* UNAUTHORIZED USER MSG@G32OPKU*/
         B     @RC00511                                            0513
@RF00511 MVC   PMSGNM(2),@CH00925                                  0513
*       TEXTINT1(1) = ADDR(INSOIDCD);/* SET OIDCARD INSERT   @G32OPKU*/
*                                                                  0514
@RC00511 LA    @08,INSOIDCD                                        0514
         ST    @08,TEXTINT1                                        0514
*       CALL LGM;                    /* PUT OUT MSG          @G32OPKU*/
         BAL   @14,LGM                                             0515
*       ROIDLEN = ZERO;              /* INDICATE NO OIDCARD  @G32OPKU*/
         MVI   ROIDLEN,X'00'                                       0516
*       END;                                                       0517
*FNDACCT:                                                          0518
*                                                                  0518
*   /*****************************************************************/
*   /*       CHECK ACCOUNT NUMBER                                    */
*   /*****************************************************************/
*                                                                  0518
*   UADSACCT = UADSNSUB;                                           0518
@RF00509 DS    0H                                                  0518
FNDACCT  L     @08,UADSNSUB                                        0518
         ST    @08,UADSACCT                                        0518
*   UADSNNEX = UADSACCT;          /* INITIALIZE OFFSET BLOCK IMAGE TO
*                                    CHECK ACCOUNT NUMBER IN UADS    */
*                                                                  0519
         ST    @08,@TF00001                                        0519
         MVC   UADSNNEX(3),@TF00001+1                              0519
*KEYWORD:                                                          0520
*                                                                  0520
*   CALL FIND;                    /* FIND FIRST ACCOUNT NUMBER OFFSET
*                                    AND DATA BLOCKS.                */
KEYWORD  BAL   @14,FIND                                            0520
*   PMSGNM = 0;                   /* INDICATE PARAMETER NOT SUPPLIED.*/
         SLR   @08,@08                                             0521
         STH   @08,PMSGNM                                          0521
*   TEXTINT1(1) = ADDR(LWPACCTI); /* GET ADDR OF ACCT#       @Z40NQKC
*                                    TEXT INSERTION BUFFER.          */
         L     @15,LWPPTR                                          0522
         LA    @14,LWPACCTI(,@15)                                  0522
         ST    @14,TEXTINT1                                        0522
*   PRMTSWC =  3 ;                /* INDICATE PROMPT IS FOR        0523
*                                    ACCOUNT NUMBER                  */
         MVC   PRMTSWC(2),@CH00087                                 0523
*   RESPECIFY (LENSTR) RSTD;                                       0524
*   LENSTR = LWPACCTL;            /* ACCT# LENGTH            @Z40NQKC*/
*                                                                  0525
         LH    LENSTR,LWPACCTL(,@15)                               0525
*   IF UADSNDAT = 0               /* IF ACCOUNT NUMBERS ARE NOT    0526
*                                    SUPPORTED IN UADS, GOTO CHECK 0526
*                                    PROC NAME.                      */
*     THEN                                                         0526
         C     @08,UADSNDAT                                        0526
         BE    @RT00526                                            0526
*       GOTO FNDPROC;                                              0527
*                                                                  0527
*   IF LENSTR = 0                 /* IF ACCOUNT NUMBER NOT SUPPLIED,
*                                    CHECK FOR DEFAULT ACCOUNT NUMBER*/
*     THEN                                                         0528
         CR    LENSTR,@08                                          0528
         BE    @RT00528                                            0528
*       GOTO ACCTEND;                                              0529
*                                                                  0529
*CKACCT:                                                           0530
*   IF LENSTR = UADSALEN          /* CHECK IF ACCOUNT NUMBER         */
*     THEN                        /* IS SAME AS UADS ACCOUNT         */
CKACCT   L     @08,UADSBUFR                                        0530
         MVC   @ZT00003+3(1),UADSALEN(@08)                         0530
         C     LENSTR,@ZT00003                                     0530
         BNE   @RF00530                                            0530
*       IF LWPACCT(1:LENSTR) = UADSANUM(1:LENSTR)          /*@Z40NQKC*/
*         THEN                                                     0531
         LR    @05,LENSTR                                          0531
         BCTR  @05,0                                               0531
         L     @01,LWPPTR                                          0531
         EX    @05,@SC03258                                        0531
         BNE   @RF00531                                            0531
*           DO;                                                    0532
*             LWATCPU=TOTLCPU;    /*PUT CUMULATIVE CPU TIME    Y02669*/
         L     @05,LWAPTR                                          0533
         L     @15,TOTLCPU(,@08)                                   0533
         ST    @15,LWATCPU(,@05)                                   0533
*             LWATCPU1=TOTLCPU1;  /*IN LWA                     Y02669*/
         L     @15,TOTLCPU1(,@08)                                  0534
         ST    @15,LWATCPU1(,@05)                                  0534
*             LWATCON=TOTLCON;    /*PUT CUMULATIVE CONNECT     Y02669*/
         L     @15,TOTLCON(,@08)                                   0535
         ST    @15,LWATCON(,@05)                                   0535
*             LWATCON1=TOTLCON1;  /*TIME IN LWA                Y02669*/
         L     @15,TOTLCON1(,@08)                                  0536
         ST    @15,LWATCON1(,@05)                                  0536
*             LWATSRU=TOTLSU;     /*PUT CUMULATIVE SERVICE     Y02669*/
         L     @15,TOTLSU(,@08)                                    0537
         ST    @15,LWATSRU(,@05)                                   0537
*             LWATSRU1=TOTLSU1;   /*UNITS IN LWA               Y02669*/
         L     @08,TOTLSU1(,@08)                                   0538
         ST    @08,LWATSRU1(,@05)                                  0538
*             GOTO FNDPROC;                                        0539
         B     FNDPROC                                             0539
*           END;                                                   0540
*                                                                  0540
*   IF UADSNFLG ^= '1'B          /* IF MORE ACCOUNT NUMBERS ON    0541
*                                    ACCOUNT CHAIN, FIND NEXT ONE.   */
*      (LWARACF = YES &           /* FOR RACF ALL ACCT#S     @Z40RQKC*/
*       UADSNNEX > 0)             /* ARE VALID               @Z40RQKC*/
*     THEN                                                         0541
@RF00531 DS    0H                                                  0541
@RF00530 TM    UADSNFLG,B'10000000'                                0541
         BNO   @RT00541                                            0541
         L     @08,LWAPTR                                          0541
         TM    LWARACF(@08),B'01000000'                            0541
         BNO   @RF00541                                            0541
         L     @08,UADSNNEX-1                                      0541
         LA    @08,0(,@08)                                         0541
         LTR   @08,@08                                             0541
         BNP   @RF00541                                            0541
@RT00541 DS    0H                                                  0542
*       DO;                                                        0542
*FNDACCT1:                                                         0543
*         CALL FIND;              /* FIND NEXT ACCOUNT OFFSET AND  0543
*                                    DATA BLOCKS.                    */
FNDACCT1 BAL   @14,FIND                                            0543
*         GOTO CKACCT;            /* GO TO CHECK VALIDITY OF SUPPLIED
*                                    ACCOUNT NUMBER.                 */
         B     CKACCT                                              0544
*       END;                                                       0545
*                                                                  0545
*   PMSGNM = 9;                   /* INDICATE ACCTNUM NOT AUTHORIZED
*                                    MESSAGE TO BE LISTED.           */
*                                                                  0546
@RF00541 MVC   PMSGNM(2),@CH00036                                  0546
*PRMTACCT:                                                         0547
*                                                                  0547
*                                                                  0547
*   CALL PROMPT;                  /* PROMPT FOR NEW LOGON PARAMETER  */
PRMTACCT BAL   @14,PROMPT                                          0547
*   UADSNNEX = UADSACCT;          /* SET ACCOUNT OFFSET USED BY FIND
*                                    ROUTINE BACK TO OFFSET OF FIRST
*                                    ACCOUNT NUMBER OFFSET BLOCK FOR
*                                    THIS CHAIN (IN UADS).           */
         MVC   UADSNNEX(3),UADSACCT+1                              0548
*   GOTO KEYWORD;                 /* BRANCH TO RESTART ACCOUNT NUMBER
*                                    CHECKING.                       */
         B     KEYWORD                                             0549
*   RESPECIFY (LENSTR) UNRSTD;                                     0550
*                                                                  0550
*ACCTEND:                                                          0551
*                                                                  0551
*                                                                  0551
*   IF UADSNFLG = '0'B           /* IF MORE THAN ONE ACCOUNT NUMBER
*                                    ON CHAIN, USER MUST BE PROMPTED
*                                    TO ENTER ONE.           @ZA12418*/
*      (LWARACF = YES &             /* FOR RACF ALL ACCT NOS @ZA12418*/
*       UADSNNEX  > 0)              /* ARE VALID             @ZA12418*/
*     THEN                                                         0551
ACCTEND  TM    UADSNFLG,B'10000000'                                0551
         BZ    @RT00551                                            0551
         L     @08,LWAPTR                                          0551
         TM    LWARACF(@08),B'01000000'                            0551
         BNO   @RF00551                                            0551
         L     @08,UADSNNEX-1                                      0551
         LA    @08,0(,@08)                                         0551
         LTR   @08,@08                                             0551
         BP    @RT00551                                            0551
*       GOTO PRMTACCT;                                             0552
*                                                                  0552
*                                                                  0552
*   LWPACCTL = UADSALEN;          /* ACCT# LENGTH            @Z40NQKC*/
@RF00551 L     @08,LWPPTR                                          0553
         L     @15,UADSBUFR                                        0553
         SLR   @14,@14                                             0553
         IC    @14,UADSALEN(,@15)                                  0553
         STH   @14,LWPACCTL(,@08)                                  0553
*   LWPACCT(1:LWPACCTL) = UADSANUM; /* MOVE LEN FROM UADS TO @Z40NQKC
*                                    THE ACCOUNT BUFFER.             */
*                                                                  0554
         BCTR  @14,0                                               0554
         EX    @14,@SM03260                                        0554
*FNDPROC:                                                          0555
*                                                                  0555
*   /*****************************************************************/
*   /*            CHECK PROCEDURE NAME FIELD IN UADS.                */
*   /*****************************************************************/
*                                                                  0555
*   LWAACCT = UADSNDAT;                                            0555
FNDPROC  L     @08,UADSNDAT                                        0555
         L     @01,LWAPTR                                          0555
         ST    @08,LWAACCT(,@01)                                   0555
*   UADSNNEX = UADSNSUB;          /* PREPARE TO SCAN PROC OFFSET   0556
*                                    CHAIN                           */
         MVC   UADSNNEX(3),UADSNSUB+1                              0556
*   CALL FIND;                    /* GET FIRST PROC OFFSET AND DATA
*                                    FIELDS.                         */
         BAL   @14,FIND                                            0557
*   PMSGNM = 0;                   /*INDICATE PARAMETER NOT SUPPLIED. */
         SLR   @08,@08                                             0558
         STH   @08,PMSGNM                                          0558
*   TEXTINT1(1) = ADDR(LWPPROCI); /* GET ADDR OF PROCNAME    @Z40NQKC
*                                    TEXT INSERTION BUFFER.          */
         L     @15,LWPPTR                                          0559
         LA    @14,LWPPROCI(,@15)                                  0559
         ST    @14,TEXTINT1                                        0559
*   PRMTSWC =  4 ;                /* INDICATE PROMPT FOR PROC NAME   */
*                                                                  0560
*                                                                  0560
         MVC   PRMTSWC(2),@CH00098                                 0560
*   IF LWPPROCL = 0               /* NO PROCNAME SUPPLIED    @Z40NQKC
*                                    GOTO CHECK FOR DEFAULT PROC   0561
*                                    IN THE UADS.                    */
*     THEN                                                         0561
         CH    @08,LWPPROCL(,@15)                                  0561
         BE    @RT00561                                            0561
*       GOTO PROCEND;                                              0562
*                                                                  0562
*CKPROC:                                                           0563
*                                                                  0563
*                                                                  0563
*   IF LWPPROC = UADSRNAM         /* PROC IS IN UADS         @Z40NQKC
*                                    RECORD IT INTO THE CSCB.        */
*     THEN                                                         0563
CKPROC   L     @08,LWPPTR                                          0563
         L     @01,UADSBUFR                                        0563
         CLC   LWPPROC(8,@08),UADSRNAM(@01)                        0563
         BE    @RT00563                                            0563
*       GOTO RCDPROC;                                              0564
*                                                                  0564
*                                                                  0564
*   IF UADSNFLG = '0'B            /* IF MORE PROCNAMES ON THIS CHAIN,
*                                    FIND NEXT PROCNAME AUTHORIZED 0565
*                                    TO USER.                        */
*     THEN                                                         0565
         TM    UADSNFLG,B'10000000'                                0565
         BNZ   @RF00565                                            0565
*       DO;                                                        0566
*FNDPROC1:                                                         0567
*         CALL FIND;              /* FIND NEXT PROCNAME OFFSET AND 0567
*                                    DATA BLOCKS.                    */
FNDPROC1 BAL   @14,FIND                                            0567
*         GOTO CKPROC;            /* GOTO CHECK VALIDITY OF PROCNAME */
         B     CKPROC                                              0568
*       END;                                                       0569
*                                                                  0569
*   PMSGNM = 10;                  /* SET MESSAGE NUMBER TO PROCEDURE
*                                    NAME NOT AUTHORIZED MESSAGE     */
@RF00565 MVC   PMSGNM(2),@CH00035                                  0570
*   GOTO PRMTACCT;                /* GO TO PROMPT FOR PROCEDURE      */
*                                                                  0571
         B     PRMTACCT                                            0571
*PROCEND:                                                          0572
*                                                                  0572
*                                                                  0572
*   IF UADSNFLG = '0'B            /* IF MORE THAN ONE PROC,        0572
*                                    EITHER TERMINATE OR PROMPT.     */
*     THEN                                                         0572
PROCEND  TM    UADSNFLG,B'10000000'                                0572
         BZ    @RT00572                                            0572
*       GOTO PRMTACCT;                                             0573
*                                                                  0573
*                                                                  0573
*   LWPPROC = UADSRNAM;           /* SAVE DEFAULT PROCNAME   @Z40NQKC
*                                    IN PROCEDURE BUFFER             */
*                                                                  0574
         L     @08,LWPPTR                                          0574
         L     @01,UADSBUFR                                        0574
         MVC   LWPPROC(8,@08),UADSRNAM(@01)                        0574
*   /*****************************************************************/
*   /*       DETERMINE LENGTH OF PROCNAME IN CHARACTERS              */
*   /*****************************************************************/
*                                                                  0575
*   DO SCANINDX = 2 TO 8 BY 1;                                     0575
         LA    SCANINDX,2                                          0575
@DL00575 DS    0H                                                  0576
*     IF LWPPROC(SCANINDX) = ' '                           /*@Z40NQKC*/
*       THEN                                                       0576
         L     @08,LWPPTR                                          0576
         ALR   @08,SCANINDX                                        0576
         CLI   LWPPROC-1(@08),C' '                                 0576
         BE    @RT00576                                            0576
*         GOTO RCDPROCL;                                           0577
*   END;                                                           0578
*                                                                  0578
         AL    SCANINDX,@CF00037                                   0578
         C     SCANINDX,@CF00046                                   0578
         BNH   @DL00575                                            0578
*RCDPROCL:                                                         0579
*                                                                  0579
*   LWPPROCL = SCANINDX - 1;                               /*@Z40NQKC*/
RCDPROCL L     @08,LWPPTR                                          0579
         LR    @03,SCANINDX                                        0579
         BCTR  @03,0                                               0579
         STH   @03,LWPPROCL(,@08)                                  0579
*   LWPPROCM = LWPPROCL + 4;                               /*@Z40NQKC*/
*                                                                  0580
         AL    @03,@CF00098                                        0580
         STH   @03,LWPPROCM(,@08)                                  0580
*RCDPROC:                                                          0581
*                                                                  0581
*                                                                  0581
*   CHCLS = UADSRNAM;             /* RECORD PROC NAME IN CSCB        */
*                                                                  0581
*                                                                  0581
RCDPROC  L     @08,LWAPTR                                          0581
         L     @01,LWAJSEL(,@08)                                   0581
         L     @01,JSELCSCB(,@01)                                  0581
         L     @15,UADSBUFR                                        0581
         MVC   CHCLS(8,@01),UADSRNAM(@15)                          0581
*   IF LWAUNIT = '0'B             /* IF INSTALLATION DIDNOT SUPPLY 0582
*                                    UNIT TYPE, RECORD FROM UADS.    */
*     THEN                                                         0582
         TM    LWAUNIT(@08),B'00100000'                            0582
         BNZ   @RF00582                                            0582
*       PSCBGPNM = UADSUNAM;      /* MOVE UNIT TYPE TO PSCB          */
*                                                                  0583
         L     @08,LWAPSCB(,@08)                                   0583
         MVC   PSCBGPNM(8,@08),UADSUNAM(@15)                       0583
*FNDRGN:                                                           0584
*                                                                  0584
*   /*****************************************************************/
*   /*            CHECK VALIDITY OF REGION SIZE                      */
*   /*****************************************************************/
*                                                                  0584
*   RESPECIFY (REGION) RSTD;                                       0584
@RF00582 DS    0H                                                  0584
FNDRGN   DS    0H                                                  0585
*   REGION = MAXCORE;             /* GET MAXIMUM ALLOWABLE REGION  0585
*                                    SIZE                            */
         LH    REGION,MAXCORE                                      0585
*   SCANINDX = 2;                 /* SET TEXT POINTER TO FIRST TEXT
*                                    BUFFER                          */
         LA    SCANINDX,2                                          0586
*   CALL CNVRGN;                  /* CONVERT TO EBCDIC               */
         BAL   @14,CNVRGN                                          0587
*   RESPECIFY (REGION) UNRSTD;                                     0588
*   PMSGNM = 11;                  /* INDICATE REGION SIZE EXCEEDS  0589
*                                    MAXIMUM ALLOWABLE REGION SIZE 0589
*                                    MESSAGE IS TO BE LISTED.        */
         MVC   PMSGNM(2),@CH00033                                  0589
*   PRMTSWC =  5;                 /* INDICATE THAT PROMPT IS FOR   0590
*                                    REGION SIZE.                    */
*                                                                  0590
*                                                                  0590
         MVC   PRMTSWC(2),@CH00209                                 0590
*   IF LWANOPR = '0'B             /* IF INSTALLATION DID NOT SUPPLY
*                                    REGION SIZE, CHECK TO SEE IF  0591
*                                    USER DID.                       */
*     THEN                                                         0591
         L     @08,LWAPTR                                          0591
         TM    LWANOPR(@08),B'00001000'                            0591
         BNZ   @RF00591                                            0591
*       DO;                                                        0592
*                                                                  0592
*                                                                  0592
*         IF LWPREGNX = 0         /* REGION SIZE NOT SUPPLIED@Z40NQKC
*                                    SIZE, USE REGION SIZE ASSOCIATED
*                                    WITH PROCNAME IN UADS.          */
*           THEN                                                   0593
         L     @08,LWPPTR                                          0593
         L     @08,LWPREGNX(,@08)                                  0593
         LTR   @08,@08                                             0593
         BZ    @RT00593                                            0593
*             GOTO UADRGN;                                         0594
*       END;                                                       0595
*                                                                  0595
*CKRGN:                                                            0596
*                                                                  0596
*                                                                  0596
*   IF LWPREGNX <= MAXCORE        /* LARGER THAN THE MAXIMUM @Z40NQKC
*                                    ALLOWED FOR THIS USER, EITHER 0596
*                                    PROMPT IF USER SUPPLIED, OR   0596
*                                    TERMINATE IF INSTALLATION     0596
*                                    SUPPLIED.                       */
*     THEN                                                         0596
@RF00591 DS    0H                                                  0596
CKRGN    L     @08,LWPPTR                                          0596
         L     @08,LWPREGNX(,@08)                                  0596
         CH    @08,MAXCORE                                         0596
         BNH   @RT00596                                            0596
*       GOTO RCDRGN;                                               0597
*                                                                  0597
*PRMTRGN:                                                          0598
*                                                                  0598
*   /*****************************************************************/
*   /*           PROMPT USER FOR A NEW REGION SIZE                   */
*   /*****************************************************************/
*                                                                  0598
*   SCANINDX = 1;                                                  0598
PRMTRGN  LA    SCANINDX,1                                          0598
*   RESPECIFY (REGION) RSTD;                                       0599
*   REGION = LWPREGNX;            /* COPY REGION SIZE        @Z40NQKC*/
         L     @03,LWPPTR                                          0600
         L     REGION,LWPREGNX(,@03)                               0600
*   CALL CNVRGN;                                                   0601
         BAL   @14,CNVRGN                                          0601
*   RESPECIFY (REGION) UNRSTD;                                     0602
*   GOTO PRMTACCT;                  /* PROMPT FOR NEW REGION SIZE.   */
*                                                                  0603
         B     PRMTACCT                                            0603
*UADRGN:                                                           0604
*                                                                  0604
*                                                                  0604
*   LWPREGNX = UADSRSIZ;          /* COPY UADS REGION SIZE   @Z40NQKC*/
*                                                                  0604
UADRGN   L     @08,UADSBUFR                                        0604
         LH    @08,UADSRSIZ(,@08)                                  0604
         N     @08,@CF03257                                        0604
         L     @01,LWPPTR                                          0604
         ST    @08,LWPREGNX(,@01)                                  0604
*RCDRGN:                                                           0605
*                                                                  0605
*                                                                  0605
*   PSCBRSZ = (LWPREGNX + 1)/2;   /* REGION IN PSCB MUST BE  @Z40NQKC
*                                    NUMBER OF 2K BLOCKS OF CORE   0605
*                                    NEEDED.                         */
RCDRGN   L     @08,LWAPTR                                          0605
         L     @08,LWAPSCB(,@08)                                   0605
         LA    @00,1                                               0605
         L     @15,LWPPTR                                          0605
         AL    @00,LWPREGNX(,@15)                                  0605
         SRDA  @00,32                                              0605
         D     @00,@CF00135                                        0605
         ST    @01,PSCBRSZ(,@08)                                   0605
*CHKPFGRP:                                                   /*Y02669*/
*                                                                  0606
*   /*****************************************************************/
*   /*            CHECK VALIDITY OF PERFORMANCE GROUP          Y02669*/
*   /*****************************************************************/
*                                                                  0606
*   IF LWPPERFX ^= 0              /*IF PERFORMANCE GROUP     @Z40NQKC*/
*                                 /*IS SUPPLIED                Y02669*/
*     THEN                                                   /*Y02669*/
CHKPFGRP L     @08,LWPPTR                                          0606
         L     @00,LWPPERFX(,@08)                                  0606
         LTR   @00,@00                                             0606
         BZ    @RF00606                                            0606
*       DO;                                                  /*Y02669*/
*         PRMTSWC=6;              /*INDICATE PROMPT IS FOR     Y02669*/
         MVC   PRMTSWC(2),@CH00178                                 0608
*                                 /*PERFORMANCE GROUP          Y02669*/
*         IF NOPERFRM='1'B        /*IF USER NOT AUTHORIZED     Y02669*/
*                                 /*TO USE PERFORMANCE GROUPS  Y02669*/
*           THEN                  /*THEN                       Y02669*/
         TM    NOPERFRM,B'00010000'                                0609
         BNO   @RF00609                                            0609
*             DO;                                            /*Y02669*/
*               IF LWANOPR='1'B   /*IF INSTALLATION SUPPLIED   Y02669*/
*                 THEN            /*PERFORM GROUP, TERMINATE   Y02669*/
         L     @15,LWAPTR                                          0611
         TM    LWANOPR(@15),B'00001000'                            0611
         BO    @RT00611                                            0611
*                   GO TO PROMPTPF;  /*SESSION                 Y02669*/
*                                                                  0612
*               ELSE              /*ELSE WAS SUPPLIED ON       Y02669*/
*                 DO;             /*LOGON COMMAND              Y02669*/
*                   PMSGNM=44;    /*SET MSG NUMBER TO          Y02669*/
         MVC   PMSGNM(2),@CH00175                                  0614
*                                 /*'PERFORM GROUP NOT         Y02669*/
*                                 /*AUTHORIZED FOR USERID' MSG Y02669*/
*                   TEXTINT1(1)=ADDR(LWPUSERI);   /*SET PTR  @Z40RQKC*/
         LA    @08,LWPUSERI(,@08)                                  0615
         ST    @08,TEXTINT1                                        0615
*                                 /*TO TEXT INSERT FOR USERID  Y02669*/
*                   CALL LGM;     /*PUT OUT 'NOT AUTHORIZED'   Y02669*/
         BAL   @14,LGM                                             0616
*                                 /*MESSAGE                    Y02669*/
*                   LWPPERFX=0;   /*NO PERFM GRP TO BE USED  @Z40NQKC*/
         L     @08,LWPPTR                                          0617
         SLR   @00,@00                                             0617
         ST    @00,LWPPERFX(,@08)                                  0617
*                   GO TO BUILDJCL;/* VERIFY GROUP           @Z40RQKC*/
         B     BUILDJCL                                            0618
*                 END;                                       /*Y02669*/
*             END;                                           /*Y02669*/
*                                                                  0620
*         /*IF A PERFORMANCE GROUP IS VALID FOR THE USER,      Y02669*/
*         /* CHECK TO SEE IF THE PERFORM GROUP HE ENTERED IS   Y02669*/
*         /* VALID FOR HIM.  IN THE UADS, A 256-BIT FIELD IS   Y02669*/
*         /* USED TO DESIGNATE PERFORM GROUP.  IF THE FIRST    Y02669*/
*         /* BIT IN THIS FIELD IS ON, THE USER IS AUTHORIZED   Y02669*/
*         /* TO USE PERFORM GROUP 1, AND SO ON TO 255.         Y02669*/
*                                                                  0621
*         THEBYTE=((LWPPERFX-1)/8) +1; /*FIND CORRECT BYTE   @Z40NQKC*/
@RF00609 LA    @08,1                                               0621
         L     @15,LWPPTR                                          0621
         L     @15,LWPPERFX(,@15)                                  0621
         BCTR  @15,0                                               0621
         LR    @04,@15                                             0621
         SRDA  @04,32                                              0621
         D     @04,@CF00046                                        0621
         ALR   @05,@08                                             0621
         LR    THEBYTE,@05                                         0621
*         THEBIT=((LWPPERFX-1)//8) +1; /*FIND CORRECT BIT    @Z40NQKC*/
*                                                                  0622
         LR    @04,@15                                             0622
         SRDA  @04,32                                              0622
         D     @04,@CF00046                                        0622
         ALR   @04,@08                                             0622
         LR    THEBIT,@04                                          0622
*         RESPECIFY (BITPOS,BYTEPOS) RSTD;                   /*Y02669*/
*         BITPOS=TMARRAY(THEBIT);/*FIND TM OPERAND TO TEST BIT Y02669*/
         SLR   BITPOS,BITPOS                                       0624
         IC    BITPOS,TMARRAY-1(THEBIT)                            0624
*         BYTEPOS=ADDR(UADSPFGR(THEBYTE)); /*FIND BYTE TO TEST Y02669*/
         LA    BYTEPOS,UADSPFGR-1(THEBYTE)                         0625
*         GEN REFS(TM)(EX  BITPOS,TM);  /*TEST BIT IN UADS   @Z40RQKC*/
         EX  BITPOS,TM
*         BC(1,UADSPFOK);                                  /*@Z40NQKC*/
         BC    1,UADSPFOK                                          0627
*         RESPECIFY (BITPOS,BYTEPOS) UNRSTD;                       0628
*                                                                  0628
*         PMSGNM=45;           /*SET MSG NUMBER TO PRFRM GROUP Y02669*/
         MVC   PMSGNM(2),@CH03017                                  0629
*         RESPECIFY (PRFRMGP) RSTD;                          /*Y02669*/
*         PRFRMGP=LWPPERFX;                                /*@Z40NQKC*/
         L     @15,LWPPTR                                          0631
         L     PRFRMGP,LWPPERFX(,@15)                              0631
*         CALL CNVPRFRM;       /*CALL SUBROUTINE TO CONVERT    Y02669*/
         BAL   @14,CNVPRFRM                                        0632
*                              /*PERFORM GROUP TO EBCDIC -     Y02669*/
*                              /*FOR TEXT INSERTION            Y02669*/
*         RESPECIFY (PRFRMGP) UNRSTD;                        /*Y02669*/
*                                                                  0633
*         TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*POINT TO TEXT       Y02669*/
         LA    @08,TEXTSEGS                                        0634
         ST    @08,TEXTINT1                                        0634
*                              /*INSERTION POINTERS            Y02669*/
*         TEXTINT1(2)=ADDR(LWPUSERI);                      /*@Z40RQKC*/
         L     @08,LWPPTR                                          0635
         LA    @08,LWPUSERI(,@08)                                  0635
         ST    @08,TEXTINT1+4                                      0635
*         GO TO PROMPTPF;      /*PROMPT FOR NEW PERFORM GROUP  Y02669*/
*                                                                  0636
         B     PROMPTPF                                            0636
*UADSPFOK:                                                         0637
*                              /*CALL OPTIMIZER TO VALIDATE    Y02669*/
*                              /*PERFORMANCE GROUP             Y02669*/
*         OPTMZRPM=0;          /*INIT PARM TO OPTIMIZER        Y02669*/
UADSPFOK SLR   @08,@08                                             0637
         ST    @08,OPTMZRPM                                        0637
*         OPTMZPF=GROUP;       /*PUT PERFORM GROUP TO BE       Y02669*/
         L     @08,LWPPTR                                          0638
         IC    @00,GROUP(,@08)                                     0638
         STC   @00,OPTMZPF                                         0638
*                              /*VALIDATED IN PARM             Y02669*/
*         RESPECIFY (PARMPTR) RSTD;                          /*Y02669*/
*         PARMPTR=OPTMZRPM;    /*INPUT TO OPT IS REG 1         Y02669*/
         L     PARMPTR,OPTMZRPM                                    0640
*         GEN (SYSEVENT VERIFYPG);   /*VERIFY PERFORM GROUP    Y02669*/
*                                                                  0641
         SYSEVENT VERIFYPG
*         OPTMZRPM=PARMPTR;    /*OUTPUT FROM OPT IS REG 1      Y02669*/
         ST    PARMPTR,OPTMZRPM                                    0642
*         RESPECIFY (PARMPTR) UNRSTD;                        /*Y02669*/
*         IF OPTMZCD=0         /*IF PERFORM GROUP IS VALID     Y02669*/
*           THEN                                             /*Y02669*/
         CLI   OPTMZCD,0                                           0644
         BE    @RT00644                                            0644
*             GO TO BUILDJCL;                                      0645
*                              /*ELSE PUT OUT 'PERFORM GROUP   Y02669*/
*                              /*NOT DEFINED TO SYSTEM' MSG    Y02669*/
*         PMSGNM=46;           /*SET MSG NUMBER TO 'NOT DEF'D' Y02669*/
         MVC   PMSGNM(2),@CH03019                                  0646
*         RESPECIFY (PRFRMGP) RSTD;                          /*Y02669*/
*         PRFRMGP=LWPPERFX;                                /*@Z40NQKC*/
         L     @01,LWPPTR                                          0648
         L     PRFRMGP,LWPPERFX(,@01)                              0648
*         CALL CNVPRFRM;       /*CALL SUBROUTINE TO CONVERT    Y02669*/
         BAL   @14,CNVPRFRM                                        0649
*                              /*PERFORM GROUP TO EBCDIC -     Y02669*/
*                              /*FOR TEXT INSERTION            Y02669*/
*         RESPECIFY (PRFRMGP) UNRSTD;                        /*Y02669*/
*         TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*POINT TO TEXT       Y02669*/
         LA    @08,TEXTSEGS                                        0651
         ST    @08,TEXTINT1                                        0651
*                              /*INSERTION POINTERS            Y02669*/
*                                                                  0652
*PROMPTPF:                     /*PROMPT FOR NEW PERFORM GROUP  Y02669*/
*         LWPPERFX=0;          /*INDICATE NO VALID PERFORM   @Z40NQKC*/
PROMPTPF L     @08,LWPPTR                                          0652
         SLR   @15,@15                                             0652
         ST    @15,LWPPERFX(,@08)                                  0652
*                              /*GROUP YET FOR USER            Y02669*/
*         CALL PROMPT;         /*PROMPT FOR NEW LOGON PARM     Y02669*/
         BAL   @14,PROMPT                                          0653
*         GO TO CHKPFGRP;      /*BRANCH TO RESTART PERFORM     Y02669*/
         B     CHKPFGRP                                            0654
*                              /*GROUP CHECKING                Y02669*/
*       TM:  GEN(TM 0(BYTEPOS),0);                                 0655
TM       TM 0(BYTEPOS),0
*       END;                                                 /*Y02669*/
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          BUILDJCL                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          IF IKJEFLD DID NOT SUPPLY THE JCL CARDS THEN THEY MUST  */
*/*          BE BUILT                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0657
*BUILDJCL:                                                         0657
*                                                                  0657
*   IF LWANUAD = NO               /* NO IKJEFLD DATA         @Z40RQKC*/
*     THEN CALL VERGROUP;         /* VERIFY GROUP            @Z40RQKC*/
*                                                                  0657
@RF00606 DS    0H                                                  0657
BUILDJCL L     @08,LWAPTR                                          0657
         TM    LWANUAD(@08),B'00000100'                            0657
         BNZ   @RF00657                                            0657
         BAL   @14,VERGROUP                                        0658
*   IF LWARACF = NO               /* NON RACF USER           @Z40RQKC*/
*     THEN DO;                                                     0659
@RF00657 L     @08,LWAPTR                                          0659
         TM    LWARACF(@08),B'01000000'                            0659
         BNZ   @RF00659                                            0659
*       DUMMYRAC = YES;           /* DO DUMMY RACINIT        @Z40RQKC*/
*                                                                  0661
         OI    DUMMYRAC,B'00000010'                                0661
*       CALL RACINIT;             /* DO THE RACINIT          @Z40RQKC*/
*                                                                  0662
         BAL   @14,RACINIT                                         0662
*       DUMMYRAC = NO;            /* NO MORE DUMMY RACF      @Z40RQKC*/
*                                                                  0663
         NI    DUMMYRAC,B'11111101'                                0663
*       IF RETCODE ^= ZERO &      /* RACF ERROR              @Z40RQKC*/
*          RETCODE ^= NORACF      /* RACF IS ACTIVE          @Z40RQKC*/
*         THEN GO TO CLEANUP4;    /* TERMINATE               @Z40RQKC*/
         L     @08,RETCODE                                         0664
         LTR   @08,@08                                             0664
         BZ    @RF00664                                            0664
         C     @08,@CF00357                                        0664
         BNE   @RT00664                                            0664
*       END;                                                       0666
*                                                                  0666
@RF00664 DS    0H                                                  0667
*   IF LWAJJCL = '0'B             /* IF THE INSTALLATION DID NOT   0667
*                                    SUPPLY JCL CARD IMAGES, CALL  0667
*                                    MODULE IKJEFLEA TO BUILD THEM.  */
*     THEN                                                         0667
@RF00659 L     @08,LWAPTR                                          0667
         TM    LWAJJCL(@08),B'00000010'                            0667
         BNZ   @RF00667                                            0667
*       CALL JCLBLD;                                               0668
*                                                                  0668
         BAL   @14,JCLBLD                                          0668
*   IF LWABUPT='1'B &             /*IF INSTALLATION SUPPLIED   Y02669*/
*                                 /*UPT TO BE USED AND         Y02669*/
*      UPTPREFX(1)='00'X          /*DSNAME PREFIX FIELD WAS    Y02669*/
*                                 /*NOT INITIALIZED,           Y02669*/
*     THEN                        /*THEN                       Y02669*/
@RF00667 L     @08,LWAPTR                                          0669
         TM    LWABUPT(@08),B'00010000'                            0669
         BNO   @RF00669                                            0669
         L     @08,LWAPSCB(,@08)                                   0669
         L     @15,PSCBUPT(,@08)                                   0669
         CLI   UPTPREFX(@15),X'00'                                 0669
         BNE   @RF00669                                            0669
*       DO;                       /*                           Y02669*/
*         UPTPREFX=PSCBUSER;      /*INIT DS NAME TO USERID     Y02669*/
         MVC   UPTPREFX(7,@15),PSCBUSER(@08)                       0671
*         UPTPREFL=PSCBUSRL;      /*INIT LEN TO LEN OF USERID  Y02669*/
         IC    @14,PSCBUSRL(,@08)                                  0672
         STC   @14,UPTPREFL(,@15)                                  0672
*       END;                      /*                           Y02669*/
*   IF LWADEST = '1'B             /* DEST PROVIDED BY INST   @ZA15332*/
*     THEN                        /* EXIT ? YES, MOVE IT INTO@ZA15332*/
@RF00669 L     @08,LWAPTR                                          0674
         TM    LWADEST(@08),B'00000100'                            0674
         BNO   @RF00674                                            0674
*       PSCBDEST = LWPDEST;       /* THE PSCB                @ZA15332*/
         L     @08,LWAPSCB(,@08)                                   0675
         L     @01,LWPPTR                                          0675
         MVC   PSCBDEST(8,@08),LWPDEST(@01)                        0675
*   /*****************************************************************/
*   /*       SEND 'LOGON IN PROGRESS' MESSAGE TO TERMINAL USER       */
*   /*****************************************************************/
*                                                                  0676
*   TEXTINT1(1) = ADDR(LWPUSERI); /* POINT TO USERID         @Z40NQKC
*                                    POINTER                         */
@RF00674 L     @08,LWPPTR                                          0676
         LA    @08,LWPUSERI(,@08)                                  0676
         ST    @08,TEXTINT1                                        0676
*   TEXTINT1(2) = ADDR(TEXTSEGS(1)); /* SET TIME OF DAY TEXT       0677
*                                    INSERTION BUFFER ADDRESS        */
         LA    @08,TEXTSEGS                                        0677
         ST    @08,TEXTINT1+4                                      0677
*   TEXTINT1(3) = ADDR(TEXTSEGS(2)); /* SET MONTH AND YEAR TEXT    0678
*                                    INSERTION BUFFER ADDRESS        */
         LA    @08,TEXTSEGS+24                                     0678
         ST    @08,TEXTINT1+8                                      0678
*   CALL IKJEFLPA                 /* BUILD TOD,DATE INSERTS  @Z40RQKC*/
*          (TEXTSEGS(1),TEXTSEGS(2));                      /*@Z40RQKC*/
         LA    @08,TEXTSEGS                                        0679
         ST    @08,@AL00001                                        0679
         LA    @08,TEXTSEGS+24                                     0679
         ST    @08,@AL00001+4                                      0679
         L     @15,@CV00274                                        0679
         LA    @01,@AL00001                                        0679
         BALR  @14,@15                                             0679
*   PMSGNM = 27;                  /* SET MESSAGE NUMBER TO LOGON IN
*                                    PROCESS MESSAGE.                */
         MVC   PMSGNM(2),@CH03025                                  0680
*   CALL LGM;                     /* SEND MESSAGE TO TERMINAL        */
         BAL   @14,LGM                                             0681
*   GOTO CLEANUP;                                                  0682
*                                                                  0682
         B     CLEANUP                                             0682
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          CLEANUP4                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          CLEANUP FOR ABNORMAL LOGON/LOGOFF TERMINATION           */
*/*                                                                  */
*/*REASONS-                                                          */
*/*          LOGON INSTALLATION EXIT SET LWADISC                     */
*/*                                                                  */
*/*          CHCECB POSTED                                           */
*/*                                                                  */
*/*          SERVICE ROUTINE ERROR                                   */
*/*                                                                  */
*/*          RACINIT ERROR                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0683
*CLEANUP4:                                                         0683
*                                                                  0683
*   IF STATUS = RACERROR          /* RACINIT ERROR           @Z40RQKC*/
*     THEN CALL HANDLRAC;         /* SEND OUT MESSAGE        @Z40RQKC*/
*                                                                  0683
CLEANUP4 CLC   STATUS(4),@CF00037                                  0683
         BNE   @RF00683                                            0683
         BAL   @14,HANDLRAC                                        0684
*   LWADISC='1'B;                 /* SET DISCONNECT INDICATOR  Y02669*/
@RF00683 L     @08,LWAPTR                                          0685
         OI    LWADISC(@08),B'00010000'                            0685
*ECBPOSTD:                                                         0686
*   NOPRMPT = '0'B;               /* MAKE SURE NO-PROMPT BIT IS OFF  */
*                                                                  0686
ECBPOSTD NI    NOPRMPT,B'11011111'                                 0686
*CLEANUP0:                        /* CLEANUP ENTRY FOR NO-PROMPT   0687
*                                    PROCESSING                      */
*                                                                  0687
*                                                                  0687
*   /*****************************************************************/
*   /*   IF THE USERID LENGTH FIELD IN THE PSCB IS ZERO,             */
*   /*   WE HAVE NOT ENQUEUED ON A USERID AND THEREFORE MUST         */
*   /*   NOT TRY TO DEQUEUE FROM THE USERID.                         */
*   /*   IF THE LENGTH FIELD IS NONE ZERO, WE HAVE ENQUEUED          */
*   /*   ON THE USERID AND THEREFORE MUST DEQUEUE FROM IT.           */
*   /*****************************************************************/
*                                                                  0687
*   IF LWARNML  ^= 0 &            /* IF USER LENGTH NON-ZERO,        */
*        LWPRECON ^= '1'B         /* AND NOT RECONNECTING    @ZM44318*/
*     THEN                        /* THEN                            */
CLEANUP0 L     @08,LWAPTR                                          0687
         CLI   LWARNML(@08),0                                      0687
         BE    @RF00687                                            0687
         L     @01,LWPPTR                                          0687
         TM    LWPRECON(@01),B'10000000'                           0687
         BO    @RF00687                                            0687
*       DO; /* DEQ (SYSIKJUA,LWARNM,LWARNML,SYSTEM) RET(HAVE) TCB(LWAST
*B->LOGONTCB)*/                                                    0688
*          I048(1:20)=I048(1:20)&&I048(1:20);                      0689
         XC    I048(20),I048                                       0689
*          RFY GPR01F RESTRICTED;                                  0690
*          I04804(1)='10000001'B;     /*LISTEND BYTE*/             0691
         MVI   I04804,B'10000001'                                  0691
*          I04805(1)=LWARNML;   /*SET LENGTH*/                     0692
         IC    @00,LWARNML(,@08)                                   0692
         STC   @00,I04805                                          0692
*          I04806(1)='01000001'B;    /*OPTIONS*/                   0693
         MVI   I04806,B'01000001'                                  0693
*          I04807(1)=ADDR(SYSIKJUA);   /*QNAME ADDRESS*/           0694
         LA    @00,SYSIKJUA                                        0694
         ST    @00,I04807                                          0694
*          I04808(1)=ADDR(LWARNM);   /*RNAME ADDRESS*/             0695
         LA    @00,LWARNM(,@08)                                    0695
         ST    @00,I04808                                          0695
*          I04801=ADDR(LWASTCB->LOGONTCB);   /*TCB ADDRESS*/       0696
         L     @08,LWASTCB(,@08)                                   0696
         ST    @08,I04801                                          0696
*          GPR01F=ADDR(I04802);                                    0697
         LA    GPR01F,I04802                                       0697
*          SVC  (48);                                              0698
         SVC   48                                                  0698
*          RFY GPR01F UNRESTRICTED;                                0699
*       END; /* DEQ (SYSIKJUA,LWARNM,LWARNML,SYSTEM) RET(HAVE) TCB(LWAS
*CB->LOGONTCB)*/                                                   0700
*                                                                  0700
*   /*****************************************************************/
*   /*       FREEJCLS:  FREE ANY JCLS THAT HAVE BEEN CONSTRUCTED     */
*   /*****************************************************************/
*                                                                  0701
*   CALL FREEJCLS;                                                 0701
*                                                                  0701
@RF00687 BAL   @14,FREEJCLS                                        0701
*CLEANUP:                                                          0702
*                                                                  0702
*   /*****************************************************************/
*   /*  IF THE UADS HAVE BEEN ACCESSED, THERE IS AN INPUT BUFFER     */
*   /*  WHICH MUST BE FREED.                                         */
*   /*****************************************************************/
*                                                                  0702
*   IF READBUF ^= 0               /* IF THE POINTER TO THE UADS INPUT
*                                    BUFFER IS NON-ZERO, THEN THE  0702
*                                    BUFFER HAS BEEN OBTAINED AND MUST
*                                    BE FREED.                       */
*     THEN                                                         0702
CLEANUP  L     @08,READBUF                                         0702
         LTR   @08,@08                                             0702
         BZ    @RF00702                                            0702
*       DO;                                                        0703
*         RESPECIFY (LENSTR) RSTD;                                 0704
*         LENSTR = DCBBLKSI;      /* GET LENGTH IN BYTES OF        0705
*                                    INPUT BUFFER.                   */
         LH    LENSTR,DCBBLKSI                                     0705
*         GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=READBUF); /* FREE CORE 0706
*                                    OCCUPIED BY INPUT BUFFER        */
         FREEMAIN R,SP=1,LV=(LENSTR),A=READBUF
*         RESPECIFY (LENSTR) UNRSTD;                               0707
*       END;                                                       0708
*                                                                  0708
*                                                                  0708
*   /*****************************************************************/
*   /*  IF THE UADS DCB IS CURRENTLY OPEN, IT MUST BE CLOSED.        */
*   /*****************************************************************/
*                                                                  0709
*   IF DCBOFLGS(4) = '1'B         /* IF UADS DCB IS OPEN, CLOSE IT.  */
*     THEN                                                         0709
@RF00702 TM    DCBOFLGS,B'00010000'                                0709
         BNO   @RF00709                                            0709
*       DO;                                                        0710
*         GEN(CLOSE (UADSDCB),MF=(E,CLOSUADS) );                   0711
         CLOSE (UADSDCB),MF=(E,CLOSUADS)
*         JSCBPASS = '0'B;        /* SET NO PASSWORD REQUIRED BIT  0712
*                                    OFF IN THE JSCB.         A41867 */
         L     @08,CVTPTR                                          0712
         L     @08,CVTTCBP(,@08)                                   0712
         L     @08,TCBCPTR(,@08)                                   0712
         L     @08,TCBJSCB(,@08)                                   0712
         NI    JSCBPASS(@08),B'01111111'                           0712
*         LWAPDCB=0;              /* INDICATE NO DCB IS OPEN   Y02653*/
*                                                                  0713
         L     @08,LWAPTR                                          0713
         SLR   @15,@15                                             0713
         ST    @15,LWAPDCB(,@08)                                   0713
*       END;                                                       0714
*                                                                  0714
*   /*****************************************************************/
*   /*       DEQUEUE FROM THE UADS IF CURRENTLY ENQUEUED ON          */
*   /*****************************************************************/
*                                                                  0715
*   CALL DEQUADS;                 /* DEQ FROM SYS1.UADS      @Z40NQKC*/
*                                                                  0715
*                                                                  0715
@RF00709 BAL   @14,DEQUADS                                         0715
*   IF INBUF ^= 0                 /* IF COMMAND BUFFER EXISTS,     0716
*                                    (POINTER TO IT NOT ZERO)      0716
*                                    THEN FREE THE CORE IT OCCUPIES. */
*     THEN                                                         0716
         L     @08,INBUF                                           0716
         LTR   @08,@08                                             0716
         BZ    @RF00716                                            0716
*       DO;                                                        0717
*         RESPECIFY (LENSTR) RSTD;                                 0718
*         LENSTR = CMNDLNG;       /* GET LENGTH OF BUFFER TO BE FREED*/
         LH    LENSTR,CMNDLNG(,@08)                                0719
*         GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF); /* FREE COMMAND
*                                    BUFFER CORE.                    */
         FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF
*         RESPECIFY (LENSTR) UNRSTD;                               0721
*       END;                                                       0722
*                                                                  0722
*   IF NOPRMPT = '1'B             /* CHECK FOR NOPROMPT PROCESSING   */
*     THEN                                                         0723
@RF00716 TM    NOPRMPT,B'00100000'                                 0723
         BO    @RT00723                                            0723
*       GOTO CNTPRMPT;                                             0724
*                                                                  0724
*                                                                  0724
*   LWARTCD = 0;                  /* ZERO RETURN CODE FIELD IN LWA   */
         L     @08,LWAPTR                                          0725
         SLR   @15,@15                                             0725
         ST    @15,LWARTCD(,@08)                                   0725
*   LWABEND='0'B;                 /*TURN OFF ABEND INDICATOR   Y02669*/
         NI    LWABEND(@08),B'11111101'                            0726
*                                 /*IN CASE OF PREVIOUS ABEND. Y02669*/
*                                 /*THEN B WILL NOT REATTACH C Y02669*/
*   LWALE = '0'B;                 /* INDICATE LE IS LOSING     Y02669*/
         NI    LWALE(@08),B'11101111'                              0727
*                                 /* CONTROL                   Y02669*/
*                                                                  0728
*   /*****************************************************************/
*   /*     RETURN TO IKJEFLC                                         */
*   /*****************************************************************/
*                                                                  0728
*   RETURN;                                                        0728
@EL00002 DS    0H                                                  0728
@EF00002 DS    0H                                                  0728
@ER00002 LM    @14,@12,@SA00002                                    0728
         BR    @14                                                 0728
*                                                                  0729
*                                                                  0729
*                                                                  0729
*NOOPEN:                                                           0729
*                                                                  0729
*   /*****************************************************************/
*   /*  AN ATTEMPT TO OPEN THE UADS DATA SET HAS FAILED.             */
*   /*  SEND TERMINATION MESSAGE TO TERMINAL AND SYSTEM OPERATOR.    */
*   /*****************************************************************/
*                                                                  0729
*   TEXTSLEN(1) = 8;              /* TEXT MESSAGE IS FOUR CHARACTERS.*/
NOOPEN   MVC   TEXTSLEN(2),@CH00046                                0729
*   TEXTSTXT(1,1:4) = 'OPEN';     /* OPEN ERROR TO BE INSERTED.      */
         MVC   TEXTSTXT(4),@CC03046                                0730
*   GOTO CMNIOERR;                /* GOTO PROCESS REMAINDER OF MESSAG*/
*                                                                  0731
*                                                                  0731
         B     CMNIOERR                                            0731
*IOERROR:                                                          0732
*                                                                  0732
*   /*****************************************************************/
*   /*  AN UNCORRECTABLE I/O ERROR HAS OCCURED EITHER ON THE         */
*   /*  UADS DIRECTORY OR ONE OF ITS MEMBERS.  AN ERROR              */
*   /*  ERROR MESSAGE WILL BE SENT TO THE TERMINAL USER AND          */
*   /*  TO THE SYSTEM OPERATOR, AFTER WHICH THE TERMINAL WILL        */
*   /*  WILL BE DISCONNECTED.                                        */
*   /*****************************************************************/
*                                                                  0732
*   TEXTSLEN(1) = 7;              /* LENGTH OF INSERTED TEXT IS    0732
*                                    THREE CHARACTERS.               */
IOERROR  MVC   TEXTSLEN(2),@CH00133                                0732
*   TEXTSTXT(1,1:3) = 'I/O';      /* I/O ERROR TEXT TO BE INSERTED.  */
         MVC   TEXTSTXT(3),@CC03049                                0733
*CMNIOERR:                        /* REMAINDER OF CODE IS USED FOR BOTH
*                                    I/O AND OPEN ERRORS ON UADS.    */
*                                                                  0734
*   PMSGNM = 18;                  /* SET MESSAGE NUMBER TO IO ERROR  */
CMNIOERR MVC   PMSGNM(2),@CH00090                                  0734
*   TEXTSLEN(2) = 11;             /* LENGTH OF INSERTED TEXT IS    0735
*                                    SEVEN CHARACTERS.               */
         MVC   TEXTSLEN+24(2),@CH00033                             0735
*   TEXTSTXT(2,1:7) = 'SYSUADS';  /* SYSUADS DDNAME TEXT TO BE     0736
*                                    INSERTED.                       */
*                                                                  0736
         MVC   TEXTSTXT+24(7),@CC03051                             0736
*                                 /*SET UP TEXT INSERT FOR     Y02669*/
*                                 /*TERMINAL MSG.  WTO MSG IS  Y02669*/
*                                /*OPEN OR I/O ERROR. TERMINAL Y02669*/
*                                 /*MSG IS LOGON TERMINATED.   Y02669*/
*   TEXTSLN2=14;                  /*LEN OF INSERTED TEXT IS 10 Y02669*/
         MVC   TEXTSLN2(2),@CH02961                                0737
*   TEXTOFF2=0;                   /*PUT IN OFFSET              Y02669*/
         SLR   @08,@08                                             0738
         STH   @08,TEXTOFF2                                        0738
*   TEXTXT2='TERMINATED';         /*PUT IN TEXT                Y02669*/
*                                                                  0739
         MVI   TEXTXT2+10,C' '                                     0739
         MVC   TEXTXT2+11(7),TEXTXT2+10                            0739
         MVC   TEXTXT2(10),@CC03052                                0739
*   TEXTINT2(1)=ADDR(TEXTSEG2); /*POINT TO 'TERMINATED' INSERT Y02669*/
         LA    @08,TEXTSEG2                                        0740
         ST    @08,TEXTINT2                                        0740
*   SEGS2PTR=ADDR(TEXTINT2);      /*POINT TO INSERT POINTER    Y02669*/
*                                                                  0741
         LA    @08,TEXTINT2                                        0741
         ST    @08,SEGS2PTR                                        0741
*ERRGTMN:                                                          0742
*                                                                  0742
*   TEXTINT1(1) = ADDR(TEXTSEGS(1));                               0742
ERRGTMN  LA    @08,TEXTSEGS                                        0742
         ST    @08,TEXTINT1                                        0742
*   TEXTINT1(2) = ADDR(TEXTSEGS(2));                               0743
         LA    @08,TEXTSEGS+24                                     0743
         ST    @08,TEXTINT1+4                                      0743
*   TEXTINT1(3) = 0;              /* IN CASE USERID IS UNKNOWN,    0744
*                                    SET TEXT SEGMENT POINTER TO ZERO*/
         SLR   @08,@08                                             0744
         ST    @08,TEXTINT1+8                                      0744
*   TEXTINT1(4) = 0;              /* IN CASE PROCNAME IS UNKNOWN,  0745
*                                    SET TEXT SEGMENT POINTER TO ZERO*/
*                                                                  0745
         ST    @08,TEXTINT1+12                                     0745
*   IF LWPUSERL ^= 0              /* IS THERE USERID         @Z40NQKC
*                                    USERID TEXT SEGMENT.            */
*     THEN                                                         0746
         L     @15,LWPPTR                                          0746
         CH    @08,LWPUSERL(,@15)                                  0746
         BE    @RF00746                                            0746
*       TEXTINT1(3) = ADDR(LWPUSERI);                      /*@Z40NQKC*/
*                                                                  0747
         LA    @08,LWPUSERI(,@15)                                  0747
         ST    @08,TEXTINT1+8                                      0747
*   IF LWPPROCL ^= 0              /* IS THERE PROCNAME       @Z40NQKC
*                                    PROCNAME TEXT SEGMENT.          */
*     THEN                                                         0748
@RF00746 L     @08,LWPPTR                                          0748
         LH    @15,LWPPROCL(,@08)                                  0748
         LTR   @15,@15                                             0748
         BZ    @RF00748                                            0748
*       TEXTINT1(4) = ADDR(LWPPROCI);                      /*@Z40NQKC*/
*                                                                  0749
*                                                                  0749
         LA    @08,LWPPROCI(,@08)                                  0749
         ST    @08,TEXTINT1+12                                     0749
*   RESPECIFY (PARMPTR) RSTD;                                      0750
@RF00748 DS    0H                                                  0751
*   ECBPTR = ADDR(DUMMYECB);                                       0751
         LA    @08,DUMMYECB                                        0751
         ST    @08,ECBPTR                                          0751
*   PARMPTR = ADDR(UPTPTR2);      /* GET ADDRESS OF PARAMETER LIST 0752
*                                    FOR MESSAGE FORMATING MODULE.   */
         LA    PARMPTR,UPTPTR2                                     0752
*   CALL IKJEFLGM;                /* CALL MESSAGE MODULE TO        0753
*                                    SEND MESSAGE TO TERMINAL.       */
         L     @15,@CV00272                                        0753
         BALR  @14,@15                                             0753
*   RESPECIFY (PARMPTR) UNRSTD;                                    0754
*   SEGS2PTR=ADDR(TEXTINT1(1));   /*RESTORE PTR TO TEXT INSERT Y02669*/
         LA    @08,TEXTINT1                                        0755
         ST    @08,SEGS2PTR                                        0755
*   RESPECIFY (SVRTN) RSTD;                                        0756
*                                                                  0756
*SRERROR:                                                          0757
*                                                                  0757
*   /*****************************************************************/
*   /*  IN CASE OF UNSUCCESSFUL RETURN CODE FROM IKJEFLGM OR         */
*   /*  IKJEFLEA, WE RETURN HERE. REGISTER 15 WILL CONTAIN THE       */
*   /*  NONZERO RETURN CODE.                                         */
*   /*****************************************************************/
*   RFY (RTNREG) RSTD;                                     /*@Z40RQKC*/
SRERROR  DS    0H                                                  0758
*   SVRTN = RTNREG;               /* SAVE RETURN CODE FROM PARSE     */
         LR    SVRTN,RTNREG                                        0758
*   RFY (RTNREG) UNRSTD;                                   /*@Z40RQKC*/
*                                                                  0759
*   IF MSGSWC = '1'B              /* IF HERE FOR GETMAIN ERROR MESSAGE,
*                                    ERROR RECOVERY ALREADY ATTEMPTED.
*                                    DONOT CHECK RETURN CODES - GO 0760
*                                    DIRECTLY TO CLEANUP.            */
*     THEN                                                         0760
         TM    MSGSWC,B'01000000'                                  0760
         BO    @RT00760                                            0760
*       GOTO CLEANUP4;                                             0761
*                                                                  0761
*                                                                  0761
*   IF SVRTN = 8 &                /* IF COMMUNICATIONS ECB   @ZA10809*/
*      CHCECB ^= 0                /* POSTED, GOTO CLEANUP    @ZA10809*/
*     THEN                                                         0762
         C     SVRTN,@CF00046                                      0762
         BNE   @RF00762                                            0762
         L     @08,LWAPTR                                          0762
         L     @08,LWAJSEL(,@08)                                   0762
         L     @08,JSELCSCB(,@08)                                  0762
         L     @08,CHCECB(,@08)                                    0762
         LTR   @08,@08                                             0762
         BNZ   @RT00762                                            0762
*       GOTO ECBPOSTD;                                             0763
*   IF SVRTN = 8 &                /* IF ECB NOT POSTED, RC IS@ZA10809*/
*      CHCECB = 0                 /* 8, THEN LINE DROPPED,   @ZA10809*/
*     THEN                        /* DISCONNECT TERMINAL AND @ZA10809*/
@RF00762 C     SVRTN,@CF00046                                      0764
         BNE   @RF00764                                            0764
         L     @08,LWAPTR                                          0764
         L     @08,LWAJSEL(,@08)                                   0764
         L     @08,JSELCSCB(,@08)                                  0764
         L     @08,CHCECB(,@08)                                    0764
         LTR   @08,@08                                             0764
         BZ    @RT00764                                            0764
*        GOTO CLEANUP4;           /* CLEANUP                 @ZA10809*/
*                                                                  0765
*                                                                  0765
*   IF SVRTN = 16                 /* IF GETMAIN FAILURE, BRANCH TO 0766
*                                    SEND TERMINATION MESSAGE AND  0766
*                                    DISCONNECT TERMINAL.            */
*     THEN                                                         0766
@RF00764 C     SVRTN,@CF00145                                      0766
         BE    @RT00766                                            0766
*       GOTO GTMNERR;                                              0767
*                                                                  0767
*                                                                  0767
*   IF SVRTN = 4                  /* IF UNABLE TO PROMPT, LOGON CAN
*                                    NOT CONTINUE. MUST TERMINATE  0768
*                                    CURRENT SESSION AND PROMPT FOR
*                                    LOGONLOGOFF COMMAND.           */
*     THEN                                                         0768
         C     SVRTN,@CF00098                                      0768
         BNE   @RF00768                                            0768
*       DO;                                                        0769
*         NOPRMPT = '1'B;         /* SET NOPROMPT SWITCH ON          */
         OI    NOPRMPT,B'00100000'                                 0770
*         GOTO CLEANUP0;                                           0771
         B     CLEANUP0                                            0771
*       END;                                                       0772
*                                                                  0772
*                                                                  0772
*                                                                  0772
*   IF SVRTN = 12                 /* IF WE GAVE A SERVICE ROUTINE BAD
*                                    PARAMETERS, WE'RE IN TROUBLE.   */
*     THEN                                                         0773
@RF00768 C     SVRTN,@CF00034                                      0773
         BNE   @RF00773                                            0773
*       DO;                                                        0774
*         TEXTSTXT(2,1:3) = '012';                                 0775
         MVC   TEXTSTXT+24(3),@CC03059                             0775
*         GOTO BADPARMS;                                           0776
         B     BADPARMS                                            0776
*       END;                                                       0777
*   GOTO CLEANUP4;               /* GO HANDLE DISCONNECTION        0778
*                                   OF TERMINAL.                     */
         B     CLEANUP4                                            0778
*   RESPECIFY (SVRTN) UNRSTD;                                      0779
*                                                                  0779
*GTMNERR:                                                          0780
*                                                                  0780
*   /*****************************************************************/
*   /*  AN UNCONDITIONAL GETMAIN WAS ISSUED AND THERE WAS            */
*   /*  INSUFFICIENT STORAGE TO SATISFY THE REQUEST.                 */
*   /*  SEND ERROR MESSAGE TO THE TERMINAL AND OPERATOR'S CONSOLE,   */
*   /*  THEN TERMINATE THE TERMINAL SESSION.                         */
*   /*****************************************************************/
*                                                                  0780
*   PTYPE = 1;                    /* INDICATE 'GETMAIN TEXT INSERTION*/
GTMNERR  MVC   PTYPE(2),@CH00037                                   0780
*   TEXTSTXT(2,1:3) = '004';      /* INDICATE GETMAIN FAILURE NUMBER.*/
*                                                                  0781
         MVC   TEXTSTXT+24(3),@CC03062                             0781
*BADPARMS:                                                         0782
*                                                                  0782
*   /*****************************************************************/
*   /*    IF RECEIVED BAD PARAMETER RETURN CODE FROM SOME MODULE     */
*   /*    (IKJEFLGM, IKJEFLEA, ETC.) OR IF GETMAIN FAILURE,          */
*   /*    SET UP TEXT INSERTION BUFFERS FOR 'SRNAME' ERROR MESSAGE   */
*   /*****************************************************************/
*                                                                  0782
*   TEXTSLEN(1) = 12;             /*                           Y02669*/
BADPARMS MVC   TEXTSLEN(2),@CH00034                                0782
*   TEXTSTXT(1,1:8) = SRNAMES(PTYPE);  /*                      Y02669*/
*                                                                  0783
         LH    @08,PTYPE                                           0783
         SLA   @08,3                                               0783
         LA    @01,SRNAMES-8(@08)                                  0783
         MVC   TEXTSTXT(8),0(@01)                                  0783
*   TEXTSLEN(2) = 7;              /* LENGTH OF TEXT PLUS LENGTH    0784
*                                    OF HEADER.                      */
         MVC   TEXTSLEN+24(2),@CH00133                             0784
*SETUPMSG:                                                         0785
*   MSGSWC = '1'B;                /* SET MESSAGE SWITCH TO ONE. THIS
*                                    WILL PREVENT AN UNENDING LOOP 0785
*                                    FROM OCCURING WHEN TESTING    0785
*                                    ERROR CONDITIONS AT 'SRERROR'   */
*                                                                  0785
SETUPMSG OI    MSGSWC,B'01000000'                                  0785
*   PMSGNM = 20;                  /* SET MESSAGE NUMBER TO 'SRNAME'
*                                    ERROR.                          */
         MVC   PMSGNM(2),@CH00340                                  0786
*   GOTO ERRGTMN;                 /* GO TO SEND SRNAME ERROR MESSAGE */
*                                                                  0787
*                                                                  0787
         B     ERRGTMN                                             0787
*END MAINLINE;                                                     0788
*   /*****************************************************************/
*   /*  ISSUE ALL NECESSARY LIST FORMS OF MACROS.                    */
*   /*****************************************************************/
*                                                                  0789
*GEN DATA;                                                         0789
*                                                                  0789
*GEN;                                                              0790
*                                                                  0790
         DS    0F
MACSTRT  EQU   *
OPENUADD OPEN  (UADSDCBD),MF=L
CLOSUADD CLOSE (UADSDCBD),MF=L
UADSDCBD DCB   DDNAME=SYSUADS,MACRF=R,DSORG=PO,SYNAD=SYNAD,KEYLEN=0
READUADD READ  UADSDECD,SF,,,,'S',,MF=L
MACLEN   EQU   *-MACSTRT
*CNVRGN:  PROC   OPTIONS(NOSAVEAREA);                              0791
*                                                                  0791
*                                                                  0791
         B     @PB00003                                            0791
CNVRGN   STM   @14,@12,12(@13)                                     0791
*   RESPECIFY(REGION) RSTD;                                        0792
*                                                                  0792
*   /*****************************************************************/
*   /*       CONVERT REGION SIZE TO EBCDIC STRING                    */
*   /*****************************************************************/
*                                                                  0793
*   GEN(CVD   REGION,CONVERT);                                     0793
         CVD   REGION,CONVERT
*   GEN(UNPK  CONVERT(5),CONVERT+5(3));                            0794
         UNPK  CONVERT(5),CONVERT+5(3)
*   CONVERT(5) = CONVERT(5)  'F0'X;                               0795
*                                                                  0795
         OI    CONVERT+4,X'F0'                                     0795
*   /*****************************************************************/
*   /*       SET UP TEXT INSERTION BUFFER FOR REGION SIZE            */
*   /*****************************************************************/
*                                                                  0796
*   TEXTSTXT(SCANINDX,1:5) = CONVERT(1:5); /* MOVE REGION SIZE     0796
*                                    CHARACTER STRING TO TEXT      0796
*                                    INSERTION BUFFER                */
         LR    @03,SCANINDX                                        0796
         MH    @03,@CH00080                                        0796
         LA    @01,TEXTSTXT-24(@03)                                0796
         MVC   0(5,@01),CONVERT                                    0796
*   TEXTSLEN(SCANINDX) = 9;       /* LENGTH OF REGION SIZE CHARACTER
*                                    STRING PLUS LENGTH OF HEADER(4).*/
         LA    @15,9                                               0797
         STH   @15,TEXTSLEN-24(@03)                                0797
*   TEXTINT1(SCANINDX) = ADDR(TEXTSEGS(SCANINDX)); /* GET ADDRESS OF
*                                    TEXT INSERTION BUFFER.          */
         LR    @15,SCANINDX                                        0798
         SLA   @15,2                                               0798
         LA    @03,TEXTSEGS-24(@03)                                0798
         ST    @03,TEXTINT1-4(@15)                                 0798
*   RESPECIFY (REGION) UNRSTD;                                     0799
*   /*****************************************************************/
*   /*       RETURN TO CALLER                                        */
*   /*****************************************************************/
*                                                                  0800
*END CNVRGN;                                                       0800
@EL00003 DS    0H                                                  0800
@EF00003 DS    0H                                                  0800
@ER00003 LM    @14,@12,12(@13)                                     0800
         BR    @14                                                 0800
*CNVPRFRM:  PROC   OPTIONS(NOSAVEAREA);                      /*Y02669*/
*                                                                  0801
*                                                                  0801
CNVPRFRM STM   @14,@12,12(@13)                                     0801
*   RESPECIFY(PRFRMGP) RSTD;                                 /*Y02669*/
*                                                                  0802
*   /*****************************************************************/
*   /*       CONVERT PERFORMANCE GROUP TO EBCDIC STRING        Y02669*/
*   /*****************************************************************/
*                                                                  0803
*   GEN(CVD   PRFRMGP,CONVERT);                              /*Y02669*/
         CVD   PRFRMGP,CONVERT
*   GEN(UNPK  CONVERT(3),CONVERT+6(2));                      /*Y02669*/
         UNPK  CONVERT(3),CONVERT+6(2)
*   CONVERT(3) = CONVERT(3)  'F0'X;                         /*Y02669*/
*                                                                  0805
         OI    CONVERT+2,X'F0'                                     0805
*   /*****************************************************************/
*   /*       SET UP TEXT INSERTION BUFFER FOR PERFORMANCE GROUP Y02669*
*   /*****************************************************************/
*                                                                  0806
*   TEXTSLEN(1)=7;                 /*SET UP LENGTH OF TEXT     Y02669*/
         MVC   TEXTSLEN(2),@CH00133                                0806
*   TEXTSOST(1)=0;                 /*SET UP OFFSET             Y02669*/
         SLR   @15,@15                                             0807
         STH   @15,TEXTSOST                                        0807
*   TEXTSTXT(1,1:3)=CONVERT(1:3);  /*PUT IN PERFORM GROUP      Y02669*/
*                                                                  0808
         MVC   TEXTSTXT(3),CONVERT                                 0808
*   RESPECIFY (PRFRMGP) UNRSTD;                              /*Y02669*/
*                                  /*RETURN TO CALLER          Y02669*/
*END CNVPRFRM;                                               /*Y02669*/
@EL00004 DS    0H                                                  0810
@EF00004 DS    0H                                                  0810
@ER00004 LM    @14,@12,12(@13)                                     0810
         BR    @14                                                 0810
*FREEJCLS:  PROC   OPTIONS(NOSAVEAREA);                            0811
FREEJCLS STM   @14,@12,12(@13)                                     0811
*   RESPECIFY (JCLSPTR) RSTD;                                      0812
*                                                                  0812
*                                                                  0812
*FREEJCL:                                                          0813
*                                                                  0813
*   JCLSPTR = JSELJCL;            /* POINT TO FIRST JCLS             */
FREEJCL  L     @08,LWAPTR                                          0813
         L     @08,LWAJSEL(,@08)                                   0813
         L     JCLSPTR,JSELJCL(,@08)                               0813
*   IF JCLSPTR = 0                /* IF NO JCLS                      */
*     THEN                                                         0814
         LTR   JCLSPTR,JCLSPTR                                     0814
         BZ    @RT00814                                            0814
*       RETURN;                   /* THEN RETURN TO CALLER           */
*                                                                  0815
*   JSELJCL = JCLSJCLS;           /* SET JSELJCL TO ADDR OF NEXT JCLS*/
         L     @05,JCLSJCLS(,JCLSPTR)                              0816
         ST    @05,JSELJCL(,@08)                                   0816
*   GEN(FREEMAIN  R,SP=1,LV=88,A=(JCLSPTR)); /* FREE CURRENT JCLS    */
         FREEMAIN  R,SP=1,LV=88,A=(JCLSPTR)
*   GOTO FREEJCL;                                                  0818
         B     FREEJCL                                             0818
*   RESPECIFY (JCLSPTR) UNRSTD;                                    0819
*END FREEJCLS;                                                     0820
@EL00005 DS    0H                                                  0820
@EF00005 DS    0H                                                  0820
@ER00005 LM    @14,@12,12(@13)                                     0820
         BR    @14                                                 0820
*LGM:  PROC  OPTIONS(NOSAVE,NOSAVEAREA);                           0821
LGM      DS    0H                                                  0822
*   RFY (R14) RSTD;                                        /*@Z40RQKC*/
*   SAVEBK = R14;                                                  0823
         LR    SAVEBK,R14                                          0823
*   RFY (R14) UNRSTD;                                      /*@Z40RQKC*/
*   /*****************************************************************/
*   /*       SET ERROR CODE TO 'IKJEFLGM'                            */
*   /*       CALL LOGON MESSAGE MODULE                               */
*   /*****************************************************************/
*                                                                  0825
*   PTYPE = 4;                                                     0825
         MVC   PTYPE(2),@CH00098                                   0825
*   RESPECIFY (PARMPTR) RSTD;                                      0826
*   PARMPTR = ADDR(UPTPTR2);                                       0827
         LA    PARMPTR,UPTPTR2                                     0827
*   CALL IKJEFLGM;                                                 0828
         L     @15,@CV00272                                        0828
         BALR  @14,@15                                             0828
*   RESPECIFY (R14) RSTD;                                  /*@Z40RQKC*/
*   R14 = SAVEBK;                                                  0830
         LR    R14,SAVEBK                                          0830
*   RFY (PARMPTR,R14) UNRSTD;                              /*@Z40RQKC*/
*   IF RTNREG = 0                 /* IF NO ERROR FROM LGM            */
*     THEN                                                         0832
         LTR   RTNREG,RTNREG                                       0832
         BZ    @RT00832                                            0832
*       RETURN;                   /* THEN RETURN TO CALLER           */
*                                                                  0833
*                                                                  0833
*   RETURN TO SRERROR;                                             0834
         LA    @14,SRERROR                                         0834
@EL00006 DS    0H                                                  0834
@EF00006 DS    0H                                                  0834
@ER00006 BR    @14                                                 0834
*END LGM;                                                          0835
         B     @EL00006                                            0835
*PROMPT:  PROC  OPTIONS(NOSAVE,NOSAVEAREA);                        0836
*                                                                  0836
PROMPT   DS    0H                                                  0837
*   /*****************************************************************/
*   /*       SET TYPE TO 'PROMPT'                                    */
*   /*****************************************************************/
*                                                                  0837
*   PTYPE = 1;                                                     0837
         MVC   PTYPE(2),@CH00037                                   0837
*   GOTO LEA;                                                      0838
         B     LEA                                                 0838
*PROMPT1: ENTRY;                                                   0839
*                                                                  0839
PROMPT1  DS    0H                                                  0840
*   /*****************************************************************/
*   /*       SET TYPE TO 'PROMPT1'                                   */
*   /*****************************************************************/
*                                                                  0840
*   PTYPE = 2;                                                     0840
         MVC   PTYPE(2),@CH00135                                   0840
*   GOTO LEA;                                                      0841
         B     LEA                                                 0841
*SCAN1:  ENTRY;                                                    0842
*                                                                  0842
SCAN1    DS    0H                                                  0843
*   /*****************************************************************/
*   /*       SET TYPE TO SCAN OF RE-LOGON BUFFER                     */
*   /*****************************************************************/
*                                                                  0843
*   PTYPE =3;                                                      0843
         MVC   PTYPE(2),@CH00087                                   0843
*   GOTO LEA;                                                      0844
         B     LEA                                                 0844
*SCAN2:  ENTRY;                                                    0845
*                                                                  0845
SCAN2    DS    0H                                                  0846
*   /*****************************************************************/
*   /*       SET TYPE TO SCAN AND PROMPT FOR LOGON  LOGOFF          */
*   /*****************************************************************/
*                                                                  0846
*   PTYPE = 4;                                                     0846
         MVC   PTYPE(2),@CH00098                                   0846
*   GOTO LEA;                                                      0847
         B     LEA                                                 0847
*JCLBLD:  ENTRY;                                                   0848
*                                                                  0848
JCLBLD   DS    0H                                                  0849
*   /*****************************************************************/
*   /*       SET TYPE TO BUILD JCLS                                  */
*   /*****************************************************************/
*                                                                  0849
*   PTYPE = 5;                                                     0849
         MVC   PTYPE(2),@CH00209                                   0849
*LEA:                                                              0850
*                                                                  0850
*   /*****************************************************************/
*   /*       PERFORM 'SCAN', 'PROMPT', OR JCLS BUILD                 */
*   /*****************************************************************/
*   RESPECIFY (R14,RTNREG,PARMPTR) RSTD;                   /*@Z40RQKC*/
LEA      DS    0H                                                  0851
*   SAVEBK = R14;                                                  0851
         LR    SAVEBK,R14                                          0851
*   PARMPTR = ADDR(PARMLST);                                       0852
         LA    PARMPTR,PARMLST                                     0852
*   RESPECIFY (R14) UNRSTD;                                /*@Z40RQKC*/
*   CALL IKJEFLEA;                                                 0854
         L     @15,@CV00271                                        0854
         BALR  @14,@15                                             0854
*   RESPECIFY (R14) RSTD;                                  /*@Z40RQKC*/
*   R14 = SAVEBK;                                                  0856
*                                                                  0856
*                                                                  0856
         LR    R14,SAVEBK                                          0856
*   IF RTNREG = 0                /* IF NO ERROR FROM IKJEFLEA       */
*      MODE = SUBMIT              /* OR CALLED FROM SUBMIT  @Z40NQKC*/
*     THEN                                                         0857
         LTR   RTNREG,RTNREG                                       0857
         BZ    @RT00857                                            0857
         CLI   MODE,X'01'                                          0857
         BNE   @RF00857                                            0857
@RT00857 DS    0H                                                  0858
*       RETURN CODE(RTNREG);      /* THEN RETURN TO CALLER           */
*                                                                  0858
@EL00007 DS    0H                                                  0858
@EF00007 DS    0H                                                  0858
@ER00007 BR    @14                                                 0858
*   RESPECIFY (R14,RTNREG,PARMPTR) UNRSTD;                 /*@Z40RQKC*/
@RF00857 DS    0H                                                  0860
*   RETURN TO SRERROR;                                             0860
         LA    @14,SRERROR                                         0860
         BR    @14                                                 0860
*END PROMPT;                                                       0861
*                                                                  0862
*   /*****************************************************************/
*   /*      THIS SUBROUTINE LOCATES ANY DATA FROM THE UADS           */
*   /*      WHICH IS REQUIRED BY MODULE IKJEFLE                      */
*   /*****************************************************************/
*                                                                  0862
*FIND: PROC;                                                       0862
*                                                                  0862
*                                                                  0862
*                                                                  0862
FIND     STM   @14,@12,@SA00008                                    0862
*   /*****************************************************************/
*   /*          REGISTER VARIABLES USED BY 'FIND'                    */
*   /*****************************************************************/
*                                                                  0863
*   DCL NEXTADDR PTR(24) REG(3);  /* PTR FOR LABEL VARIABLE          */
*   DCL DCBPTR PTR(24) REG(4);    /* PTR TO UADS DCB                 */
*   DCL DATAADDR PTR(24) REG(4);  /* ADDR WORK AREA                  */
*   DCL BLOCKNUM PTR(31) REG(4);  /* EXTENT BLOCK NUMBER             */
*   DCL MEMBRPTR PTR(24) REG(5);  /* PTR TO UADS MEMBER NAME         */
*   DCL NBLKNUM PTR(31) REG(6);   /* NEW BLOCK NUMBER ADDRESS        */
*   DCL BUFRPTR PTR(24) REG (7);  /* PTR TO THE INPUT BUFFER         */
*                                                                  0869
*   DCL INDIRECT LABEL BASED(NEXTADDR); /* GENERAL LABEL FOR       0870
*                                    BRANCHES IN ROUTINE             */
*   DCL FIELD CHAR(12) BASED(DATAADDR); /* DUMMY DATA FIELD          */
*   DCL STRBLKNM CHAR(1) BASED(NBLKNUM); /* USED TO STORE EXTENT   0872
*                                    NUMBER INTO USERID MEMBER NAME
*                                    FIELD                           */
*   DCL SAVBLKNM CHAR(1);         /* USED TO CHANGE EXTENT NUMBER  0873
*                                    IN USERID MEMBER NAME FIELD   0873
*                                    FROM HEX ('00' TO '09') TO    0873
*                                    EBCDIC (0 TO 9)                 */
*   DCL STOREIT PTR(8) DEFINED(SAVBLKNM); /* SAVE EXTENT NUMBER      */
*   /*****************************************************************/
*   /*          DECLARE BRANCH LABELS USED IN 'FIND'                 */
*   /*****************************************************************/
*                                                                  0875
*   DCL STOREOFF LABEL;                                            0875
*   DCL STORDATA LABEL;                                            0876
*   DCL ENDFIND LABEL;                                             0877
*   RESPECIFY(DATAADDR,NEXTADDR) RSTD;                             0878
*                                                                  0878
*   /*****************************************************************/
*   /*       GET POINTER TO NEXT OFFSET BLOCK                        */
*   /*****************************************************************/
*                                                                  0879
*   DATAADDR = UADSNNEX;          /* GET PTR TO NEXT OFFSET BLOCK    */
         L     DATAADDR,UADSNNEX-1                                 0879
         LA    DATAADDR,0(,DATAADDR)                               0879
*   NEXTADDR = ADDR(STOREOFF);    /* GET ADDR OF ROUTINE TO        0880
*                                    STORE THE OFFSET BLOCK          */
         LA    NEXTADDR,STOREOFF                                   0880
*   RESPECIFY(BUFRPTR) RSTD;                                       0881
*FINDBLOK:                                                         0882
*                                                                  0882
*   /*****************************************************************/
*   /*       GET POINTER TO INPUT BUFFER                             */
*   /*****************************************************************/
*                                                                  0882
*   BUFRPTR = READBUF;            /* GET PTR TO THE INPUT BUFFER     */
FINDBLOK L     BUFRPTR,READBUF                                     0882
*   RESPECIFY(BLOCKNUM)RSTD;                                       0883
*                                                                  0883
*   /*****************************************************************/
*   /*       GET EXTENT NUMBER FOR THIS OFFSET BLOCK                 */
*   /*****************************************************************/
*                                                                  0884
*   BLOCKNUM = DATAADDR/DCBBLKSI; /* GET EXTENT BLOCK NUMBER       0884
*                                    OF DATA FIELD                   */
         LR    @01,DATAADDR                                        0884
         SLR   @00,@00                                             0884
         LH    @08,DCBBLKSI                                        0884
         DR    @00,@08                                             0884
         LR    BLOCKNUM,@01                                        0884
*   RESPECIFY(NBLKNUM) RSTD;                                       0885
*   NBLKNUM = ADDR(FINDNAME(LWPUSERL+1)); /* ADDR OF EXTENT  @Z40NQKC
*                                    IN USERID MEMBER-NAME FIELD     */
         L     @08,LWPPTR                                          0886
         LH    NBLKNUM,LWPUSERL(,@08)                              0886
         LA    NBLKNUM,FINDNAME(NBLKNUM)                           0886
*   STOREIT = BLOCKNUM;           /* SAVE EXTENT NUMBER              */
         STC   BLOCKNUM,STOREIT                                    0887
*   SAVBLKNM = SAVBLKNM  '0';                                     0888
         OI    SAVBLKNM,C'0'                                       0888
*   IF SAVBLKNM ^= STRBLKNM       /* IF DATA BLOCK IS NOT IN CORE, 0889
*                                    READ THE DATA BLOCK INTO CORE 0889
*                                    FROM THE UADS.                  */
*     THEN                                                         0889
         CLC   SAVBLKNM(1),STRBLKNM(NBLKNUM)                       0889
         BE    @RF00889                                            0889
*       DO;                                                        0890
*                                                                  0890
*   /*****************************************************************/
*   /*       ENQUEUE ON UADS DIRECTORY                               */
*   /*       FIND EXTENT WHICH CONTAINS OFFSET BLOCK                 */
*   /*       DEQUEUE FROM UADS                                       */
*   /*****************************************************************/
*                                                                  0891
*         STRBLKNM = SAVBLKNM;    /* STORE EXTENT BLOCK NUMBER IN  0891
*                                    FIND NAME AREA                  */
         MVC   STRBLKNM(1,NBLKNUM),SAVBLKNM                        0891
*         RESPECIFY (NBLKNUM) UNRSTD;                              0892
*         RESPECIFY(DCBPTR) RSTD;                                  0893
*         DCBPTR = ADDR(UADSDCB); /* GET UADS DCB ADDRESS IN REGISTER*/
         LA    DCBPTR,UADSDCB                                      0894
*         RESPECIFY(MEMBRPTR) RSTD;                                0895
*         MEMBRPTR = ADDR(FINDNAME); /* GET ADDRESS OF THE MEMBER  0896
*                                    NAME INTO A REGISTER.           */
*                                                                  0896
         LA    MEMBRPTR,FINDNAME                                   0896
*         CALL ENQUADS;           /* ENQ ON SYS1.UADS        @Z40NQKC*/
*                                                                  0897
         BAL   @14,ENQUADS                                         0897
*         RFY (RTNREG) RSTD;                               /*@Z40RQKC*/
*         GEN(FIND  UADSDCB,FINDNAME,D); /* FIND MEMBER ADDR ON D.A.
*                                    DEVICE                          */
         FIND  UADSDCB,FINDNAME,D
*         RETCODE = RTNREG;       /* SAVE RETURN CODE FROM FIND      */
         ST    RTNREG,RETCODE                                      0900
*         RFY (RTNREG) UNRSTD;                             /*@Z40RQKC*/
*         CALL DEQUADS;           /* DEQ FROM SYS1.UADS      @Z40NQKC*/
*                                                                  0902
*                                                                  0902
         BAL   @14,DEQUADS                                         0902
*         IF RETCODE ^= 0         /* IF MEMBER WAS NOT LOCATED,    0903
*                                    TEST FOR ERROR CONDITIONS       */
*           THEN                                                   0903
         L     @08,RETCODE                                         0903
         LTR   @08,@08                                             0903
         BZ    @RF00903                                            0903
*             DO;                                                  0904
*                                                                  0904
*                                                                  0904
*               IF RETCODE = 4    /* IF MEMBER WAS NOT FOUND,      0905
*                                    SEND 'INCONSISTENT AUTHORIZATION
*                                    DATA' MESSAGE TO TERMINAL USER  */
*                 THEN                                             0905
         C     @08,@CF00098                                        0905
         BNE   @RF00905                                            0905
*                   DO;                                            0906
*                                                                  0906
*                     TEXTINT1(1) = ADDR(LWPUSERI);        /*@Z40NQKC*/
*                                                                  0907
         L     @08,LWPPTR                                          0907
         LA    @08,LWPUSERI(,@08)                                  0907
         ST    @08,TEXTINT1                                        0907
*                     PMSGNM = 33;                                 0908
         MVC   PMSGNM(2),@CH03117                                  0908
*                     CALL LGM;   /* SEND ERROR MESSAGE              */
         BAL   @14,LGM                                             0909
*                     NOPRMPT = '1'B; /* NO PROMPT PROCESSING TO BE
*                                    PERFORMED SO THAT NECESSARY   0910
*                                    CLEANUP CALL BE PERFORMED       */
         OI    NOPRMPT,B'00100000'                                 0910
*                     RETURN TO CLEANUP0;                          0911
         LA    @14,CLEANUP0                                        0911
         LM    @15,@12,@SA00008+4                                  0911
         BR    @14                                                 0911
*                   END;                                           0912
*                 ELSE                                             0913
*                   GOTO RTNIOERR; /* IF I/O ERROR IN FIND,        0913
*                                    RETURN TO I/O ERROR ROUTINE     */
*             END;                                                 0914
*                                                                  0914
*                                                                  0914
*         IOSWC = '0'B;           /* INITIALIZE IOSWC TO ZERO,     0915
*                                    INDICATING THAT NO I/O ERROR  0915
*                                    HAS OCCURED.                    */
@RF00903 NI    IOSWC,B'01111111'                                   0915
*         GEN(READ  UADSDECB,SF,(DCBPTR),(BUFRPTR),,,,MF=E); /*    0916
*                                    READ UADS MEMBER FROM UADS      */
         READ  UADSDECB,SF,(DCBPTR),(BUFRPTR),,,,MF=E
*         GEN(CHECK UADSDECB);    /* CHECK READ FOR COMPLETION       */
*                                                                  0917
         CHECK UADSDECB
*         /***********************************************************/
*         /*      IF WE HAD AN I/O ERROR IN TRYING TO READ A         */
*         /*      RECORD, THE SYNAD ROUTINE SET IOSWC BIT TO ONE.    */
*         /*      IN THAT CASE RETURN TO SEND ERROR MESSAGE TO       */
*         /*      TERMINAL AND CANCEL SESSION.                       */
*         /***********************************************************/
*                                                                  0918
*         IF IOSWC = '1'B         /* IF IOSWC SET BY SYNAD ROUTINE   */
*           THEN                                                   0918
         TM    IOSWC,B'10000000'                                   0918
         BNO   @RF00918                                            0918
*RTNIOERR:                                                         0919
*                                                                  0919
*             RETURN TO IOERROR;  /* THEN RETURN TO IO ERROR         */
RTNIOERR LA    @14,IOERROR                                         0919
         LM    @15,@12,@SA00008+4                                  0919
         BR    @14                                                 0919
*       END;                                                       0920
*                                                                  0920
*                                                                  0920
@RF00918 DS    0H                                                  0921
*   GO TO INDIRECT;               /* BRANCH TO PREDETERMINED       0921
*                                    ROUTINE                         */
@RF00889 BR    NEXTADDR                                            0921
*STOREOFF:                                                         0922
*                                                                  0922
*         /***********************************************************/
*       /*    LOCATE OFFSET BLOCK                                    */
*         /***********************************************************/
*                                                                  0922
*   DATAADDR = BUFRPTR + (UADSNNEX//DCBBLKSI); /* GET ADDRESS OF   0922
*                                    OFFSET BLOCK                    */
STOREOFF L     @00,UADSNNEX-1                                      0922
         N     @00,@CF03266                                        0922
         SRDA  @00,32                                              0922
         LH    DATAADDR,DCBBLKSI                                   0922
         DR    @00,DATAADDR                                        0922
         ALR   @00,BUFRPTR                                         0922
         LR    DATAADDR,@00                                        0922
*   UADSNODE(1:12) = FIELD;       /* MOVE OFFSET DATA FROM UADS    0923
*                                    BUFFER TO OFFSET IMAGE BLOCK    */
*                                                                  0923
*                                                                  0923
         MVC   UADSNODE(12),FIELD(DATAADDR)                        0923
*   IF UADSNDAT = 0               /* IF INSTALLATION DOES NOT      0924
*                                    SUPPORT THIS FIELD, RETURN TO 0924
*                                    IKJEFLE                         */
*     THEN                                                         0924
         L     @08,UADSNDAT                                        0924
         LTR   @08,@08                                             0924
         BZ    @RT00924                                            0924
*       GO TO ENDFIND;                                             0925
*                                                                  0926
*   /*****************************************************************/
*   /*         SECOND ENTRY TO FIND TO GET DATA ONLY                 */
*   /*****************************************************************/
*                                                                  0926
*FIND1: ENTRY;                                                     0926
*                                                                  0926
         B     @EC00926                                            0926
FIND1    STM   @14,@12,@SA00008                                    0926
@EC00926 DS    0H                                                  0927
*   DATAADDR = UADSNDAT;          /* GET OFFSET TO DATA FIELD        */
         L     DATAADDR,UADSNDAT                                   0927
*   NEXTADDR = ADDR(STORDATA);    /* GET ADDRESS OF ROUTINE TO STORE
*                                    THE IN-BUFFER DATA ADDRESS      */
         LA    NEXTADDR,STORDATA                                   0928
*   GO TO FINDBLOK;               /* BRANCH TO READ DATA BLOCK       */
         B     FINDBLOK                                            0929
*STORDATA:                                                         0930
*                                                                  0930
*   /*****************************************************************/
*   /*       LOCATE DATA BLOCK                                       */
*   /*****************************************************************/
*                                                                  0930
*   UADSBUFR = UADSNDAT//DCBBLKSI;/* FIND OFFSET OF DATA BLOCK     0930
*                                    INTO THE UADS INPUT BUFFER      */
STORDATA L     @00,UADSNDAT                                        0930
         SRDA  @00,32                                              0930
         LH    @08,DCBBLKSI                                        0930
         DR    @00,@08                                             0930
         ST    @00,UADSBUFR                                        0930
*   UADSBUFR = UADSBUFR + BUFRPTR;/* FIND ACTUAL IN-CORE ADDRESS   0931
*                                    OF THE DATA BLOCK               */
         ALR   @00,BUFRPTR                                         0931
         ST    @00,UADSBUFR                                        0931
*   RESPECIFY (DATAADDR,NEXTADDR,BUFRPTR,BLOCKNUM,NBLKNUM,DCBPTR,  0932
*             MEMBRPTR) UNRSTD;                                    0932
*ENDFIND:                                                          0933
*                                                                  0933
*   RETURN;                       /* RETURN TO CALLER                */
*                                                                  0933
@EL00008 DS    0H                                                  0933
@EF00008 DS    0H                                                  0933
@ER00008 LM    @14,@12,@SA00008                                    0933
         BR    @14                                                 0933
*   /*****************************************************************/
*   /*                   SYNAD ERROR ROUTINE --                      */
*   /*****************************************************************/
*   /*     A PERMANENT I/O ERROR HAS OCCURED WHILE TRYING TO READ    */
*   /*     A RECORD FROM THE UADS IN THE INTERNAL PROCEDURE, FIND.   */
*   /*     NO ERROR MESSAGES WILL BE SENT TO THE USER'S TERMINAL     */
*   /*     NOR TO THE OPERATORS CONSOLE FROM THIS ROUTINE. A SWITCH  */
*   /*     WILL BE SET WHICH FIND EXAMINES AFTER ISSUING THE CHECK   */
*   /*     MACRO. FIND WILL THEN RETURN TO A ROUTINE WHICH WILL      */
*   /*     PROCESS THE ERROR.                                        */
*   /*****************************************************************/
*                                                                  0934
*SYNAD:                                                            0934
*                                                                  0934
*   IOSWC = '1'B;                 /* SET I/O ERROR SWITCH TO INDICATE
*                                    THAT AN I/O ERROR HAS OCCURED.  */
*                                                                  0934
SYNAD    OI    IOSWC,B'10000000'                                   0934
*   /*****************************************************************/
*/*           R  RETURN TO SUPERVISOR                                */
*   /*****************************************************************/
*                                                                  0935
*   GEN(BR    @14);               /* RETURN TO CHECK ROUTINE.        */
*                                                                  0935
         BR    @14
*END FIND;                        /* END OF INTERNAL PROCEDURE FIND  */
         B     @EL00008                                            0936
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          ENQUADS                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          ENQUE ON SYSIKJUA.OPENUADS WHILE READING SYS1.UADS.     */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40NQKC-                                                   */
*/*          SEPARATE SEGMENT CREATED DUE TO THE PHYSICAL NUMBER OF  */
*/*          ENQS IN THIS MODULE                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0937
*ENQUADS:                                                          0937
*        PROCEDURE;                                                0937
*                                                                  0937
ENQUADS  STM   @14,@12,12(@13)                                     0937
*   DO;  /*ENQ (SYSIKJUA,OPENENQ,S,LENGTH(OPENENQ),SYSTEM)*/       0938
*   RESPECIFY (GPR01P) RESTRICTED;                                 0939
*   I056(1:20)=I056(1:20) &&I056(1:20);  /*ZERO OUT THE TABLE*/    0940
         XC    I056(20),I056                                       0940
*   I05604(1)=LENGTH(OPENENQ);  /*LENGTH OF MINOR RESOURCE NAME*/  0941
         MVI   I05604,X'08'                                        0941
*   I05606(1)=ADDR(SYSIKJUA);  /*ADDRESS OF MAJOR RESOURCE NAME*/  0942
         LA    @08,SYSIKJUA                                        0942
         ST    @08,I05606                                          0942
*   I05607(1)=ADDR(OPENENQ);  /*ADDRESS OF MINOR RESOURCE NAME*/   0943
         LA    @08,OPENENQ                                         0943
         ST    @08,I05607                                          0943
*   I05603(1)='01000000'B;  /*SET BIT STRING 1 FOR RESOURCE ELEMENT*/
         MVI   I05603,B'01000000'                                  0944
*   I05605(1)='11000000'B;  /*SET BIT STRING 2 FOR RESOURCE ELEMENT*/
         MVI   I05605,B'11000000'                                  0945
*   I05603(1,1)='1'B;  /*SET END OF LIST BIT*/                     0946
         OI    I05603,B'10000000'                                  0946
*   GPR01P=ADDR(I05602);  /*LOAD LIST ADDRESS*/                    0947
         LA    GPR01P,I05602                                       0947
*   SVC (56);  /*ISSUE ENQ SVC*/                                   0948
         SVC   56                                                  0948
*   RESPECIFY (GPR01P) UNRESTRICTED;                               0949
*   END;  /*ENQ (SYSIKJUA,OPENENQ,S,LENGTH(OPENENQ),SYSTEM)*/      0950
*                                                                  0950
*END ENQUADS;                                                      0951
@EL00009 DS    0H                                                  0951
@EF00009 DS    0H                                                  0951
@ER00009 LM    @14,@12,12(@13)                                     0951
         BR    @14                                                 0951
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          DEQUADS                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          CONDITIONALLY DEQ FROM SYSIKJUA.OPENUADS                */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40NQKC-                                                   */
*/*          SEPARATE SEGMENT CREATED DUE TO THE PHYSICAL NUMBER OF  */
*/*          DEQS IN THIS MODULE                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0952
*DEQUADS:                                                          0952
*        PROCEDURE;                                                0952
*                                                                  0952
DEQUADS  STM   @14,@12,12(@13)                                     0952
*   DO; /* DEQ (SYSIKJUA,OPENENQ,LENGTH(OPENENQ),SYSTEM) RET(HAVE)*/
*      I048(1:20)=I048(1:20)&&I048(1:20);                          0954
         XC    I048(20),I048                                       0954
*      RFY GPR01F RESTRICTED;                                      0955
*      I04804(1)='11000000'B;     /*LISTEND BYTE*/                 0956
         MVI   I04804,B'11000000'                                  0956
*      I04805(1)=LENGTH(OPENENQ);   /*SET LENGTH*/                 0957
         MVI   I04805,X'08'                                        0957
*      I04806(1)='01000001'B;    /*OPTIONS*/                       0958
         MVI   I04806,B'01000001'                                  0958
*      I04807(1)=ADDR(SYSIKJUA);   /*QNAME ADDRESS*/               0959
         LA    @08,SYSIKJUA                                        0959
         ST    @08,I04807                                          0959
*      I04808(1)=ADDR(OPENENQ);   /*RNAME ADDRESS*/                0960
         LA    @08,OPENENQ                                         0960
         ST    @08,I04808                                          0960
*      GPR01F=ADDR(I04802);                                        0961
         LA    GPR01F,I04802                                       0961
*      SVC  (48);                                                  0962
         SVC   48                                                  0962
*      RFY GPR01F UNRESTRICTED;                                    0963
*   END; /* DEQ (SYSIKJUA,OPENENQ,LENGTH(OPENENQ),SYSTEM) RET(HAVE)*/
*                                                                  0964
*END DEQUADS;                                                      0965
@EL00010 DS    0H                                                  0965
@EF00010 DS    0H                                                  0965
@ER00010 LM    @14,@12,12(@13)                                     0965
         BR    @14                                                 0965
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RACVERFY                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INTERFACE WITH RACINIT TO VERIFY USERID,PASSWORD,GROUP  */
*/*          AND NEW PASSWORD                                        */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40RQKC-                                                   */
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */
*/*                                                                  */
*/********************************************************************/
*RACVERFY:                                                         0966
*        PROCEDURE;                                                0966
*                                                                  0966
*                                                                  0966
RACVERFY STM   @14,@12,@SA00011                                    0966
*   CALL RACINIT;                    /* INVOKE RACINIT               */
*                                                                  0967
         BAL   @14,RACINIT                                         0967
* ONCEMORE:                          /*                      @G32OPKU*/
*   DO WHILE RETCODE = OIDREQD      /* OIDCARD REQUIRED     @G32OPKU*/
*            RETCODE = OIDINV;       /* OIDCARD INVALID      @G32OPKU*/
ONCEMORE B     @DE00968                                            0968
@DL00968 DS    0H                                                  0969
*     IF LWANORDR = NO  &            /* IF TERMINAL TYPE     @G32OPKU*/
*               BADVERFY = NO        /* SUPPORTS OIDCARD RDR @G32OPKU*/
*       THEN DO;                     /* AND NOT BAD VERIFY   @G32OPKU*/
         L     @08,LWAPTR                                          0969
         TM    LWANORDR(@08),B'01000000'                           0969
         BNZ   @RF00969                                            0969
         TM    BADVERFY,B'00000001'                                0969
         BNZ   @RF00969                                            0969
*         IF RETCODE = OIDREQD       /* CHECK FOR MESSAGE    @G32OPKU*/
*           THEN                     /*                      @G32OPKU*/
         CLC   RETCODE(4),@CF00499                                 0971
         BNE   @RF00971                                            0971
*             PMSGNM = MSG56434;     /* OIDCARD REQ'D MSG    @G32OPKU*/
         MVC   PMSGNM(2),@CH00937                                  0972
*           ELSE                     /* ASSUME OIDCARD       @G32OPKU*/
*             PMSGNM = MSG56433;     /* NOT AUTHORIZED MSG   @G32OPKU*/
*                                                                  0973
         B     @RC00971                                            0973
@RF00971 MVC   PMSGNM(2),@CH00935                                  0973
*         CALL OIDVERFY;             /* VERIFY OIDCARD       @G32OPKU*/
*                                                                  0974
@RC00971 BAL   @14,OIDVERFY                                        0974
*         IF OIDVERRC = ZERO         /* OIDCARD OK ??        @G32OPKU*/
*           THEN                     /* YES, NEXT GIVE RACF  @G32OPKU*/
         L     @08,OIDVERRC                                        0975
         LTR   @08,@08                                             0975
         BNZ   @RF00975                                            0975
*             CALL RACINIT;          /* A CRACK AT IT        @G32OPKU*/
         BAL   @14,RACINIT                                         0976
*           ELSE                     /* NO,                  @G32OPKU*/
*             GOTO CLEANUP4;         /* GOTO ERROR EXIT      @G32OPKU*/
*       END;                                                       0978
*     ELSE                           /*                      @G32OPKU*/
*       GOTO CLEANUP4;               /* NO SUPPORT FOR RDR   @G32OPKU*/
*   END;                             /* END LOOP FOR OIDCARD @G32OPKU*/
@DE00968 L     @08,RETCODE                                         0980
         C     @08,@CF00499                                        0980
         BE    @DL00968                                            0980
         C     @08,@CF00175                                        0980
         BE    @DL00968                                            0980
*   LWANORDR = NO;                   /* TURN OFF NO OID RDR  @G32OPKU*/
         L     @08,LWAPTR                                          0981
         NI    LWANORDR(@08),B'10111111'                           0981
*   BADVERFY = NO;                   /* AND BAD VERIFY       @G32OPKU*/
         NI    BADVERFY,B'11111110'                                0982
*                                    /* RETURN CODE BITS AS THERE    */
*                                    /* WILL NOT BE ANOTHER OIDCARD  */
*                                    /* CHECK ---- AS PER SPECS      */
*   DO WHILE RETCODE ^= ZERO &       /* NOT SUCCESSFUL               */
*            RETCODE ^= NORACF &     /* RACF IS ACTIVE               */
*            RETCODE ^= NOPROF;      /* PROFILE FOR USERID           */
*                                                                  0983
         B     @DE00983                                            0983
@DL00983 DS    0H                                                  0984
*     IF RETCODE = INVPSWD           /* INVALID PASSWORD             */
*       THEN DO;                                                   0984
         CLC   RETCODE(4),@CF00046                                 0984
         BNE   @RF00984                                            0984
*         IF LWPPSWDL = ZERO         /* NO PSWD GOTTEN FROM USER     */
*           THEN PMSGNM = ZERO;      /* REQUEST PSWD FROM USER       */
         SLR   @08,@08                                             0986
         L     @01,LWPPTR                                          0986
         CH    @08,LWPPSWDL(,@01)                                  0986
         BNE   @RF00986                                            0986
         STH   @08,PMSGNM                                          0987
*           ELSE PMSGNM = MSG56421;  /* TRUELY AN INVALID PSWD       */
*                                                                  0988
         B     @RC00986                                            0988
@RF00986 MVC   PMSGNM(2),@CH00046                                  0988
*         PRMTSWC =  2 ;             /* PROMPT FOR ANOTHER PASSWORD  */
@RC00986 MVC   PRMTSWC(2),@CH00135                                 0989
*         END;                                                     0990
*                                                                  0990
*       ELSE                                                       0991
*         IF RETCODE = PSWDEXP       /* CURRENT PASSWORD EXPIRED     */
*           THEN DO;                                               0991
         B     @RC00984                                            0991
@RF00984 CLC   RETCODE(4),@CF00034                                 0991
         BNE   @RF00991                                            0991
*             PMSGNM = MSG56415;     /* PASSWORD-EXPIRED MSG         */
         MVC   PMSGNM(2),@CH00919                                  0993
*             PRMTSWC = PNPSWD;      /* PROMPT FOR NEW-PASSWORD      */
         MVC   PRMTSWC(2),@CH00133                                 0994
*             END;                                                 0995
*                                                                  0995
*           ELSE                                                   0996
*             IF RETCODE = INVNPSWD  /* INVALID NEW PASSWORD         */
*               THEN DO;                                           0996
         B     @RC00991                                            0996
@RF00991 CLC   RETCODE(4),@CF00145                                 0996
         BNE   @RF00996                                            0996
*                 PMSGNM = MSG56414; /* INVALID NEW-PASSWORD MSG     */
         MVC   PMSGNM(2),@CH00601                                  0998
*                 PRMTSWC = PNPSWD;  /* PROMPT FOR NEW-PASSWORD      */
         MVC   PRMTSWC(2),@CH00133                                 0999
*                 END;                                             1000
*                                                                  1000
*               ELSE                                               1001
*                 IF RETCODE = INVGROUP /* INVALID GROUP             */
*                   THEN DO;                                       1001
         B     @RC00996                                            1001
@RF00996 CLC   RETCODE(4),@CF00340                                 1001
         BNE   @RF01001                                            1001
*                     PRMTSWC = PGROUP; /* PROMPT FOR GROUP          */
         MVC   PRMTSWC(2),@CH00046                                 1003
*                     TEXTINT1(1) = ADDR(LWPGRPI); /* GROUP INSERT   */
         L     @08,LWPPTR                                          1004
         LA    @08,LWPGRPI(,@08)                                   1004
         ST    @08,TEXTINT1                                        1004
*                     PMSGNM = MSG56417;/* INVALID GROUP MSG         */
         MVC   PMSGNM(2),@CH00923                                  1005
*                     END;                                         1006
*                                                                  1006
*                   ELSE                   /*                @G32OPKU*/
*                     IF RETCODE = GROUPREV/* IF GROUP ACCESS REVOKED*/
*                       THEN DO;           /* PROMPT FOR NEW GROUP   */
         B     @RC01001                                            1007
@RF01001 CLC   RETCODE(4),@CF00497                                 1007
         BNE   @RF01007                                            1007
*                         PRMTSWC = PGROUP;/* WANT PROMPT FOR GR     */
         MVC   PRMTSWC(2),@CH00046                                 1009
*                         PMSGNM = MSG56438;/* GROUP REVOKED MSG     */
         MVC   PMSGNM(2),@CH00944                                  1010
*                         END;             /*                @G32POKU*/
*                       ELSE               /*                @G32OPKU*/
*                         IF RETCODE = OIDREQD  /* OID REQD?@G32OPKU*/
*                            RETCODE = OIDINV /* OR INVALID ?@G32OPKU*/
*                              THEN           /* YES ,START  @G32OPKU*/
         B     @RC01007                                            1012
@RF01007 L     @08,RETCODE                                         1012
         C     @08,@CF00499                                        1012
         BE    @RT01012                                            1012
         C     @08,@CF00175                                        1012
         BE    @RT01012                                            1012
*                                GOTO ONCEMORE;/* OVER AT TOP@G32OPKU*/
*                              ELSE GO TO CLEANUP4;                1014
         B     CLEANUP4                                            1014
*      CALL PROMPT;                  /* PROMPT THE USER              */
*                                                                  1015
@RC01007 DS    0H                                                  1015
@RC01001 DS    0H                                                  1015
@RC00996 DS    0H                                                  1015
@RC00991 DS    0H                                                  1015
@RC00984 BAL   @14,PROMPT                                          1015
*      CALL RACINIT;                 /* INVOKE RACINIT AGAIN         */
         BAL   @14,RACINIT                                         1016
*    END;                                                          1017
*                                                                  1017
@DE00983 L     @08,RETCODE                                         1017
         LTR   @08,@08                                             1017
         BZ    @DC00983                                            1017
         C     @08,@CF00357                                        1017
         BE    @DC00983                                            1017
         C     @08,@CF00098                                        1017
         BNE   @DL00983                                            1017
@DC00983 DS    0H                                                  1018
*END RACVERFY;                                                     1018
@EL00011 DS    0H                                                  1018
@EF00011 DS    0H                                                  1018
@ER00011 LM    @14,@12,@SA00011                                    1018
         BR    @14                                                 1018
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RACINIT                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          INVOKE RACF TO BUILD SECURITY RELATED CNTL BLOCKS       */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          THE GROUP-ID WILL ARBITRARILY BE CHANGED AFTER UADS     */
*/*          VERIFICATION IS COMPLETE JUST IN CASE A NEW GROUP WAS   */
*/*          ENTERED WHEN THE USER WAS BEING PROMPTED FOR SOMETHING  */
*/*          ELSE                                                    */
*/*                                                                  */
*/*          A DUMMY RACINIT WILL BE DONE AFTER UADS-VERIFICATION    */
*/*          IS COMPLETE IF THE USER IS NOT RACF DEFINED             */
*/*                                                                  */
*/*          RACINITS WITH USERID,PASSWORD,GROUP,AND NEW PASSWORD    */
*/*          WILL BE DONE DEPENDING ON WHAT IS IN IKJEFLWP WHICH     */
*/*          REFLECTS WHAT WAS ENTERED ON THE LOGON COMMAND          */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40RQKC-                                                   */
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */
*/*                                                                  */
*/********************************************************************/
*RACINIT:                                                          1019
*        PROCEDURE;                                                1019
*                                                                  1019
RACINIT  STM   @14,@12,@SA00012                                    1019
*   RFY (GPR15P) RSTD;                                             1020
*   STATUS = ZERO;                   /* ZERO FOR STATUS              */
*                                                                  1021
         SLR   @14,@14                                             1021
         ST    @14,STATUS                                          1021
*   DO; /* RACINIT  MF(M,RACLST,COMPLETE)*/                        1022
*   RACLST = RACLST && RACLST;/*INIT. LIST*/                       1023
         XC    RACLST(48),RACLST                                   1023
*   RACLST01 = 48;/*PARM LIST LENGTH*/                             1024
         MVI   RACLST01,X'30'                                      1024
*   RACLST02 = '00000000'B;/*RESERVED FIELD*/                      1025
         MVI   RACLST02,B'00000000'                                1025
*   RACLST03 = '00000000'B;/*RESERVED FIELD*/                      1026
         MVI   RACLST03,B'00000000'                                1026
*   RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/                    1027
         MVI   RACLST04,B'00000000'                                1027
*   END; /* RACINIT  MF(M,RACLST,COMPLETE)*/                       1028
*                                                                  1028
*   IF CHKGROUP = YES                                              1029
*     THEN DO;                                                     1029
         TM    CHKGROUP,B'00000100'                                1029
         BNO   @RF01029                                            1029
*       DO; /* RACINIT  MF(E,RACLST,COMPLETE) GROUP(RACGROUP) ENVIR(CHA
*GE)*/  RACLST = RACLST && RACLST;/*INIT. LIST*/                   1031
         XC    RACLST(48),RACLST                                   1032
*       RACLST01 = 48;/*PARM LIST LENGTH*/                         1033
         MVI   RACLST01,X'30'                                      1033
*       RACLST02 = '00000000'B;/*RESERVED FIELD*/                  1034
         MVI   RACLST02,B'00000000'                                1034
*       RACLST03 = '00000000'B;/*RESERVED FIELD*/                  1035
         MVI   RACLST03,B'00000000'                                1035
*       RACLST04 = '01000000'B; /*SET ENVIR FLAGS*/                1036
         MVI   RACLST04,B'01000000'                                1036
*       RACLST09 = ADDR(RACGROUP); /*ADDR OF GROUP*/               1037
         L     @08,LWPPTR                                          1037
         LA    @08,RACGROUP(,@08)                                  1037
         ST    @08,RACLST09                                        1037
*       RESPECIFY GPR01P RESTRICTED;                               1038
*       GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/            1039
         LA    GPR01P,RACLST                                       1039
*       IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/            1040
         L     @08,CVTPTR                                          1040
         L     @08,CVTRAC(,@08)                                    1040
         CR    @08,@14                                             1040
         BE    @RF01040                                            1040
         TM    RCVTRNA(@08),B'10000000'                            1040
         BNZ   @RF01040                                            1040
*       SVC (131); /*ISSUE RACINIT SVC*/                           1041
         SVC   131                                                 1041
*       ELSE/*RACF NOT ACTIVE*/                                    1042
*       DO;                                                        1042
         B     @RC01040                                            1042
@RF01040 DS    0H                                                  1043
*       RFY GPR15P RSTD;                                           1043
*       GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                 1044
         LA    GPR15P,32                                           1044
*       RFY GPR15P UNRSTD;                                         1045
*       END;                                                       1046
*       RESPECIFY GPR01P UNRESTRICTED;                             1047
@RC01040 DS    0H                                                  1048
*       END; /* RACINIT  MF(E,RACLST,COMPLETE) GROUP(RACGROUP) ENVIR(CH
*NGE)*/                                                            1048
*       RETCODE = GPR15P;            /* SAVE RETURN CODE             */
         ST    GPR15P,RETCODE                                      1049
*       END;                                                       1050
*                                                                  1050
*     ELSE DO;                                                     1051
         B     @RC01029                                            1051
@RF01029 DS    0H                                                  1052
*       IF DUMMYRAC ^= YES           /* DO NORMAL RACINIT            */
*         THEN DO;                                                 1052
         TM    DUMMYRAC,B'00000010'                                1052
         BO    @RF01052                                            1052
*           DO; /* RACINIT  MF(M,RACLST) USERID(LWANAME) ENVIR(CREATE)*
*           RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/            1055
         MVI   RACLST04,B'00000000'                                1055
*           RACLST05 = ADDR(LWANAME); /*ADDR OF USERID*/           1056
         L     @08,LWAPTR                                          1056
         LA    @08,LWANAME(,@08)                                   1056
         ST    @08,RACLST05                                        1056
*           END; /* RACINIT  MF(M,RACLST) USERID(LWANAME) ENVIR(CREATE)
*/                                                                 1057
*                                                                  1057
*           IF LWPPSWDL ^= ZERO      /* PSWD ON LOGON COMMAND        */
*             THEN DO;                                             1058
         SLR   @08,@08                                             1058
         L     @15,LWPPTR                                          1058
         CH    @08,LWPPSWDL(,@15)                                  1058
         BE    @RF01058                                            1058
*               DO; /* RACINIT  MF(M,RACLST) PASSWRD(RACPSWD)*/    1060
*               RACLST06 = ADDR(RACPSWD); /*ADDR OF PASSWORD*/     1061
         LA    @14,RACPSWD(,@15)                                   1061
         ST    @14,RACLST06                                        1061
*               END; /* RACINIT  MF(M,RACLST) PASSWRD(RACPSWD)*/   1062
*                                                                  1062
*               IF LWPNPSWL ^= ZERO   /* NEW-PSWD ON LOGON CMND      */
*                 THEN                                             1063
         CH    @08,LWPNPSWL(,@15)                                  1063
         BE    @RF01063                                            1063
*                   DO; /* RACINIT  MF(M,RACLST) NEWPASS(RACNPSWD)*/
*                   RACLST10 = ADDR(RACNPSWD); /*ADDR OF NEW PASSWORD*/
         LA    @08,RACNPSWD(,@15)                                  1065
         ST    @08,RACLST10                                        1065
*                   END; /* RACINIT  MF(M,RACLST) NEWPASS(RACNPSWD)*/
*               END;                                               1067
*                                                                  1067
@RF01063 DS    0H                                                  1068
*           IF ROIDLEN ^= ZERO       /* OIDCARD AVAILABLE    @G32OPKU*/
*             THEN                   /*                      @G32OPKU*/
@RF01058 CLI   ROIDLEN,0                                           1068
         BE    @RF01068                                            1068
*                 DO; /* RACINIT  MF(M,RACLST) OIDCARD(RACOID)*/   1069
*                 RACLST13 = ADDR(RACOID); /*ADDR OF MAGNETIC STRIP INF
**/               END; /* RACINIT  MF(M,RACLST) OIDCARD(RACOID)*//*
*G32OPKU*/                                                         1070
*                                                                  1070
         LA    @08,RACOID                                          1070
         ST    @08,RACLST13                                        1070
*           IF LWPGRPL ^= ZERO       /* GROUP ON LOGON COMMAND       */
*             THEN                                                 1072
@RF01068 L     @08,LWPPTR                                          1072
         LH    @15,LWPGRPL(,@08)                                   1072
         LTR   @15,@15                                             1072
         BZ    @RF01072                                            1072
*               DO; /* RACINIT  MF(M,RACLST) GROUP(RACGROUP)*/     1073
*               RACLST09 = ADDR(RACGROUP); /*ADDR OF GROUP*/       1074
         LA    @08,RACGROUP(,@08)                                  1074
         ST    @08,RACLST09                                        1074
*               END; /* RACINIT  MF(M,RACLST) GROUP(RACGROUP)*/    1075
*           END;                                                   1076
*                                                                  1076
@RF01072 DS    0H                                                  1077
*       DO; /* RACINIT  MF(M,RACLST) TERMID(TSBTRMID)*/            1077
@RF01052 DS    0H                                                  1078
*       RACLST14 = ADDR(TSBTRMID); /*ADDR OF TERMINAL ID INFO*/    1078
         L     @08,TSBPTR                                          1078
         LA    @08,TSBTRMID(,@08)                                  1078
         ST    @08,RACLST14                                        1078
*       END; /* RACINIT  MF(M,RACLST) TERMID(TSBTRMID)*//*         1079
*G32OPKU*/                                                         1079
*                                                                  1079
*       DO; /* RACINIT  MF(E,RACLST)*/                             1080
*       RACLST01 = 48;/*PARM LIST LENGTH*/                         1081
         MVI   RACLST01,X'30'                                      1081
*       RACLST02 = '00000000'B;/*RESERVED FIELD*/                  1082
         MVI   RACLST02,B'00000000'                                1082
*       RACLST03 = '00000000'B;/*RESERVED FIELD*/                  1083
         MVI   RACLST03,B'00000000'                                1083
*       RACLST04 = '00000000'B; /*SET ENVIR FLAGS*/                1084
         MVI   RACLST04,B'00000000'                                1084
*       RESPECIFY GPR01P RESTRICTED;                               1085
*       GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/            1086
         LA    GPR01P,RACLST                                       1086
*       IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/            1087
         L     @08,CVTPTR                                          1087
         L     @08,CVTRAC(,@08)                                    1087
         LTR   @08,@08                                             1087
         BZ    @RF01087                                            1087
         TM    RCVTRNA(@08),B'10000000'                            1087
         BNZ   @RF01087                                            1087
*       SVC (131); /*ISSUE RACINIT SVC*/                           1088
         SVC   131                                                 1088
*       ELSE/*RACF NOT ACTIVE*/                                    1089
*       DO;                                                        1089
         B     @RC01087                                            1089
@RF01087 DS    0H                                                  1090
*       RFY GPR15P RSTD;                                           1090
*       GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                 1091
         LA    GPR15P,32                                           1091
*       RFY GPR15P UNRSTD;                                         1092
*       END;                                                       1093
*       RESPECIFY GPR01P UNRESTRICTED;                             1094
@RC01087 DS    0H                                                  1095
*       END; /* RACINIT  MF(E,RACLST)*/                            1095
*                                                                  1095
*       RETCODE = GPR15P;            /* SAVE RACINIT ERROR           */
         ST    GPR15P,RETCODE                                      1096
*       END;                                                       1097
*   RESPECIFY (GPR15P) UNRSTD;                                     1098
*                                                                  1098
@RC01029 DS    0H                                                  1099
*   IF RETCODE ^= ZERO               /* ERROR IN RACINIT             */
*     THEN DO;                                                     1099
         L     @08,RETCODE                                         1099
         LTR   @08,@08                                             1099
         BZ    @RF01099                                            1099
*       IF RETCODE = NOPROF         /* NON RACF USER                */
*          RETCODE = NORACF          /* RACF IS NOT ACTIVE           */
*         THEN STATUS = CONTINUE;    /* NOT A RACF ERROR             */
         C     @08,@CF00098                                        1101
         BE    @RT01101                                            1101
         C     @08,@CF00357                                        1101
         BNE   @RF01101                                            1101
@RT01101 DS    0H                                                  1102
         SLR   @08,@08                                             1102
         ST    @08,STATUS                                          1102
*         ELSE STATUS = RACERROR;    /* A RACF ERROR                 */
*                                                                  1103
         B     @RC01101                                            1103
@RF01101 MVC   STATUS(4),@CF00037                                  1103
*       LWARACF = NO;                /* NON RACF USER                */
@RC01101 L     @08,LWAPTR                                          1104
         NI    LWARACF(@08),B'10111111'                            1104
*       END;                                                       1105
*                                                                  1105
*     ELSE DO;                                                     1106
         B     @RC01099                                            1106
@RF01099 DS    0H                                                  1107
*       STATUS = CONTINUE;           /* EVERYTHING IS OK             */
         SLR   @08,@08                                             1107
         ST    @08,STATUS                                          1107
*       LWARACF = YES;               /* A RACF USER                  */
*                                                                  1108
         L     @08,LWAPTR                                          1108
         OI    LWARACF(@08),B'01000000'                            1108
*       CALL SETLOCK;                /* GET CMS LOCK FOR TSB @G32OPKU*/
         BAL   @14,SETLOCK                                         1109
*       TSBSF1 = ACEEGRPN;           /* MOVE IN GROUP NAME   @G32OPKU*/
         L     @08,TSBPTR                                          1110
         L     @01,LWAPTR                                          1110
         L     @01,LWAPASCB(,@01)                                  1110
         L     @01,ASCBASXB(,@01)                                  1110
         L     @01,ACEEPTR(,@01)                                   1110
         MVC   TSBSF1(8,@08),ACEEGRPN(@01)                         1110
*       CALL RELLOCK;                /* RELEASE LOCAL/CMS LOC@G32OPKU*/
*                                                                  1111
         BAL   @14,RELLOCK                                         1111
*       LWPGRPL=ZERO;                /* ZERO RACF GROUP LENGTH FIELD
*                                       TO PREVENT REDUNDANT RACINIT
*                                       FOR GROUP AT THE END @Z40RPKU*/
         L     @08,LWPPTR                                          1112
         SLR   @15,@15                                             1112
         STH   @15,LWPGRPL(,@08)                                   1112
*       END;                                                       1113
*                                                                  1113
*END RACINIT;                                                      1114
@EL00012 DS    0H                                                  1114
@EF00012 DS    0H                                                  1114
@ER00012 LM    @14,@12,@SA00012                                    1114
         BR    @14                                                 1114
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          VERGROUP                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          VERIFY ONLY THE GROUP-ID                                */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF THERE IS A GROUP-ID AND THE USER IS A RACF USER      */
*/*          THEN DO A RACINIT TO CHECK THE GROUP-ID.THIS WILL BE    */
*/*          AN ENVIRONMENT=CHANGE VERIFICATION.THIS RACINIT IS      */
*/*          DONE JUST IN CASE THE GROUP-ID HAS CHANGED DUE TO A     */
*/*          PROMPT FOR SOME OTHER KEYWORD AFTER THE INITIAL RACINIT */
*/*                                                                  */
*/*          IF THE GROUP-ID TO BE VERIFIED IS NOT AUTHORIZED THEN   */
*/*          PROMPT FOR A NEW GROUP AND GO TO THE TOP TO REVERIFY    */
*/*          EVERYTHING                                              */
*/*                                                                  */
*/*          IF THE USER IS NOT A RACF USER THEN ISSUE A MESSAGE     */
*/*          AND CONTINUE                                            */
*/*                                                                  */
*/*MESSAGES-                                                         */
*/*      IKJ56419-                                                   */
*/*          GROUP KEYWORD IS IGNORED FOR NON RACF USER              */
*/*                                                                  */
*/*      IKJ56426-                                                   */
*/*          GROUP IGNORED,RACF NOT IN SYSTEM                        */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40RQKC-                                                   */
*/*          NEW SEGMENT FOR VS2 RELEASE 4                           */
*/*                                                                  */
*/********************************************************************/
*VERGROUP:                                                         1115
*        PROCEDURE;                                                1115
*                                                                  1115
VERGROUP STM   @14,@12,@SA00013                                    1115
*   IF LWPGRPL ^= ZERO               /* GROUP KEYWORD ENTERED        */
*     THEN                                                         1116
         L     @08,LWPPTR                                          1116
         LH    @08,LWPGRPL(,@08)                                   1116
         LTR   @08,@08                                             1116
         BZ    @RF01116                                            1116
*       IF LWARACF = YES             /* A RACF USER                  */
*         THEN DO;                                                 1117
         L     @08,LWAPTR                                          1117
         TM    LWARACF(@08),B'01000000'                            1117
         BNO   @RF01117                                            1117
*           CHKGROUP = YES;          /* RACINIT WILL CHECK ONLY GROUP*/
*                                                                  1119
         OI    CHKGROUP,B'00000100'                                1119
*           CALL RACINIT;            /* DO THE RACINIT               */
*                                                                  1120
         BAL   @14,RACINIT                                         1120
*           CHKGROUP = NO;           /* NO MORE CHECK GROUP          */
*                                                                  1121
         NI    CHKGROUP,B'11111011'                                1121
*           IF RETCODE = INVGROUP   /* GROUP IS INVALID FOR USERID  */
*                 RETCODE = GROUPREV /* OR GRP ACCESS REVOKED@G32OPKU*/
*             THEN DO;                                             1122
         L     @08,RETCODE                                         1122
         C     @08,@CF00340                                        1122
         BE    @RT01122                                            1122
         C     @08,@CF00497                                        1122
         BNE   @RF01122                                            1122
@RT01122 DS    0H                                                  1123
*               LWARACF = YES;       /* STILL A VALID RACF USER      */
         L     @08,LWAPTR                                          1124
         OI    LWARACF(@08),B'01000000'                            1124
*               STATUS = CONTINUE;   /* NO RACF ERRORS               */
         SLR   @08,@08                                             1125
         ST    @08,STATUS                                          1125
*               IF RETCODE = GROUPREV/* GROUP ACCESS REVKED ?@G32OPKU*/
*                 THEN               /* PUT OUT MSG - GROUP  @G32OPKU*/
         CLC   RETCODE(4),@CF00497                                 1126
         BNE   @RF01126                                            1126
*                   PMSGNM = MSG56438;/* ACCESS REVOKED      @G32OPKU*/
         MVC   PMSGNM(2),@CH00944                                  1127
*                 ELSE               /*                      @G32OPKU*/
*                   PMSGNM = MSG56417;/* INVALID GROUP MSG           */
         B     @RC01126                                            1128
@RF01126 MVC   PMSGNM(2),@CH00923                                  1128
*               PRMTSWC = PGROUP;    /* IKJEFLEA WILL PROMPT FOR GRP */
@RC01126 MVC   PRMTSWC(2),@CH00046                                 1129
*               TEXTINT1(1) = ADDR(LWPGRPI);  /* GROUP INSERT        */
         L     @08,LWPPTR                                          1130
         LA    @08,LWPGRPI(,@08)                                   1130
         ST    @08,TEXTINT1                                        1130
*               GO TO PRMTACCT;      /* PROMPT AND REVERIFY ALL      */
         B     PRMTACCT                                            1131
*               END;                                               1132
*                                                                  1132
*             ELSE                                                 1133
*               IF RETCODE ^= ZERO   /* ERROR IN RACINIT             */
*                 THEN GO TO CLEANUP4; /* TERMINATE                  */
@RF01122 L     @08,RETCODE                                         1133
         LTR   @08,@08                                             1133
         BNZ   @RT01133                                            1133
*           END;                                                   1135
*                                                                  1135
*         ELSE DO;                                                 1136
         B     @RC01117                                            1136
@RF01117 DS    0H                                                  1137
*           IF CVTRAC = ZERO         /* RACF NOT IN SYSTEM           */
*             THEN PMSGNM = MSG56426;/* UNSUPPORTED-KEYWORD MSG      */
         L     @08,CVTPTR                                          1137
         L     @08,CVTRAC(,@08)                                    1137
         LTR   @08,@08                                             1137
         BNZ   @RF01137                                            1137
         MVC   PMSGNM(2),@CH00786                                  1138
*             ELSE PMSGNM = MSG56419;/* UNAUTHORIZED-USER MSG        */
*                                                                  1139
         B     @RC01137                                            1139
@RF01137 MVC   PMSGNM(2),@CH00925                                  1139
*           TEXTINT1(1) = ADDR(INSGROUP); /* GROUP INSERT            */
*                                                                  1140
@RC01137 LA    @08,INSGROUP                                        1140
         ST    @08,TEXTINT1                                        1140
*           CALL LGM;                /* SEND MESSAGE                 */
         BAL   @14,LGM                                             1141
*           END;                                                   1142
*                                                                  1142
*END VERGROUP;                                                     1143
@EL00013 DS    0H                                                  1143
@EF00013 DS    0H                                                  1143
@ER00013 LM    @14,@12,@SA00013                                    1143
         BR    @14                                                 1143
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          BLDNUMB                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          BUILD A RETURN CODE TEXT INSERT                         */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          CONVERT THE RETURN CODE FROM BINARY TO PACKED DECIMAL   */
*/*                                                                  */
*/*          EDMK WILL CONVERT THE RETURN CODE FROM PACKED DECIMAL   */
*/*          TO ZONED DECIMAL AND POINT REGISTER ONE TO THE FIRST    */
*/*          SIGNIFICANT CHARACTER                                   */
*/*                                                                  */
*/*          LEFT JUSTIFY THE RETURN CODE IN THE TEXT FIELD AND      */
*/*          UPDATE THE TEXT INSER LENGTH                            */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40RQKC-                                                   */
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1144
*BLDNUMB:                                                          1144
*        PROCEDURE(BLD#,BLDINS);                                   1144
*                                                                  1144
BLDNUMB  STM   @14,@12,@SA00014                                    1144
         MVC   @PC00014(8),0(@01)                                  1144
*DECLARE                                                           1145
*  1 BLDINS,                         /* THE INSERT                   */
*    2 BLDHEAD,                                                    1145
*      3 BLDLEN FIXED(15),                                         1145
*      3 BLDOFF FIXED(15),                                         1145
*    2 BLDTEXT CHAR(16);                                           1145
*                                                                  1145
*   CVD(BLD#,CONVERT);               /* BINARY TO PACKED DECIMAL     */
         L     @08,@PC00014                                        1146
         L     @08,BLD#(,@08)                                      1146
         CVD   @08,CONVERT                                         1146
*   BLDTEXT = EDITMASK;              /* INITIALIZE THE EDIT MASK     */
*                                                                  1147
         L     @08,@PC00014+4                                      1147
         MVC   BLDTEXT(16,@08),@CB00466                            1147
*   RESPECIFY (GPR01P) RSTD;                                       1148
*   GPR01P = ADDR(BLDTEXT);          /* THE TEXT FIELD               */
         LA    GPR01P,BLDTEXT(,@08)                                1149
*   GEN REFS(CONVERT)                /* EDIT THE RETURN CODE         */
*       (EDMK 0(16,1),CONVERT);                                    1150
         EDMK 0(16,1),CONVERT
*   BLDLEN = LENGTH(BLDTEXT) -       /* ORIGINAL LENGTH              */
*            (GPR01P -               /* FIRST NON-ZERO DIGIT         */
*             ADDR(BLDTEXT));        /* FIRST ZERO DIGIT             */
         L     @08,@PC00014+4                                      1151
         LA    @15,BLDTEXT(,@08)                                   1151
         LR    @00,@15                                             1151
         SLR   @00,GPR01P                                          1151
         AL    @00,@CF00145                                        1151
         STH   @00,BLDLEN(,@08)                                    1151
*   BLDTEXT(1:BLDLEN) =              /* LEFT JUSTIFY THE RETURN CODE */
*       BLDTEXT(GPR01P-ADDR(BLDTEXT)+1:LENGTH(BLDTEXT));           1152
         LR    @14,@00                                             1152
         BCTR  @14,0                                               1152
         LCR   @15,@15                                             1152
         ALR   @15,GPR01P                                          1152
         ALR   @15,@08                                             1152
         MVC   @TS00001(16),BLDTEXT(@15)                           1152
         EX    @14,@SM03270                                        1152
*   RESPECIFY (GPR01P) UNRSTD;                                     1153
*                                                                  1153
*   BLDLEN = BLDLEN +                /* RETURN CODE LENGTH           */
*            LENGTH(BLDHEAD);        /* TEXT INSERT HEADER LENGTH    */
*                                                                  1154
         AL    @00,@CF00098                                        1154
         STH   @00,BLDLEN(,@08)                                    1154
*END BLDNUMB;                                                      1155
@EL00014 DS    0H                                                  1155
@EF00014 DS    0H                                                  1155
@ER00014 LM    @14,@12,@SA00014                                    1155
         BR    @14                                                 1155
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          HANDLRAC                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          HANDLE RACF ERRORS                                      */
*/*                                                                  */
*/*MESSAGES-                                                         */
*/*      IKJ56413-                                                   */
*/*          RACINIT FAILED BY RACINIT-INSTALLATION-EXIT             */
*/*                                                                  */
*/*      IKJ56414-                                                   */
*/*          USER ACCESS REVOKED DUE TO BUSY PROFILE                 */
*/*                                                                  */
*/*      IKJ56416-                                                   */
*/*          ERROR IN RACINIT                                        */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @Z40RQKC-                                                   */
*/*          NEW SEGMENT FOR VS2 RELEASE 4 RACF SUPPORT              */
*/*                                                                  */
*/********************************************************************/
*HANDLRAC:                                                         1156
*        PROCEDURE;                                                1156
*                                                                  1156
HANDLRAC STM   @14,@12,@SA00015                                    1156
*   IF RETCODE = RACEXIT                  /* RACF EXIT FAILED RACINIT*/
*     THEN                                                         1157
         CLC   RETCODE(4),@CF00080                                 1157
         BNE   @RF01157                                            1157
*       IF LWPRECON = YES                 /* RECONNECT PUTOUT@G32OPKU*/
*         THEN                            /* YES, FAIL RECON @G32OPKU*/
         L     @08,LWPPTR                                          1158
         TM    LWPRECON(@08),B'10000000'                           1158
         BNO   @RF01158                                            1158
*           PMSGNM = MSG56442;            /* MSG             @G32OPKU*/
         MVC   PMSGNM(2),@CH00952                                  1159
*         ELSE                            /*                 @G32OPKU*/
*           PMSGNM = MSG56413;            /* FAIL RACF INIT  @G32OPKU*/
         B     @RC01158                                            1160
@RF01158 MVC   PMSGNM(2),@CH00053                                  1160
*     ELSE                                                         1161
*       IF RETCODE = REVOKE               /* PROFILE ALREADY IN USE  */
*         THEN                                                     1161
         B     @RC01157                                            1161
@RF01157 CLC   RETCODE(4),@CF00490                                 1161
         BNE   @RF01161                                            1161
*           IF LWPRECON = YES             /* RECONNECT PUTOUT@G32OPKU*/
*             THEN                        /* YES, PUT OUT MSG@G32OPKU*/
         L     @08,LWPPTR                                          1162
         TM    LWPRECON(@08),B'10000000'                           1162
         BNO   @RF01162                                            1162
*               PMSGNM = MSG56443;        /* USER REVOKED    @G32OPKU*/
         MVC   PMSGNM(2),@CH00954                                  1163
*             ELSE                        /*                 @G32OPKU*/
*               PMSGNM = MSG56425;        /* ACCESS REVOKED  @G32OPKU*/
         B     @RC01162                                            1164
@RF01162 MVC   PMSGNM(2),@CH00928                                  1164
*         ELSE                              /*               @G32OPKU*/
*           IF LWANORDR = YES &             /* NO OIDCARD RDR@G32OPKU*/
*              (OIDVERRC = NOTOIDRD        /* SUPPORT AND OIDCARD   */
*               RETCODE = OIDREQD          /* REQ'D BY RACINIT      */
*               RETCODE = OIDINV)           /* THEN SET MSG  @G32OPKU*/
*             THEN                          /* LOGON TERMINATED,OIDCD*/
         B     @RC01161                                            1165
@RF01161 L     @08,LWAPTR                                          1165
         TM    LWANORDR(@08),B'01000000'                           1165
         BNO   @RF01165                                            1165
         CLC   OIDVERRC(4),@CF00098                                1165
         BE    @RT01165                                            1165
         L     @08,RETCODE                                         1165
         C     @08,@CF00499                                        1165
         BE    @RT01165                                            1165
         C     @08,@CF00175                                        1165
         BNE   @RF01165                                            1165
@RT01165 DS    0H                                                  1166
*               PMSGNM = MSG56436;          /* NOT SUPPORTED ON THIS */
         MVC   PMSGNM(2),@CH00941                                  1166
*                                           /* TERMINAL      @G32OPKU*/
*             ELSE                        /*                 @G32OPKU*/
*               IF RETCODE = NOTERMID     /* TERMINAL NOT OK @G32OPKU*/
*                 THEN                    /* FOR USER        @G32OPKU*/
         B     @RC01165                                            1167
@RF01165 CLC   RETCODE(4),@CF00502                                 1167
         BNE   @RF01167                                            1167
*                   IF LWPRECON = YES     /* RECON REJECTED  @G32OPKU*/
*                     THEN                /* PUT OUT MSG     @G32OPKU*/
         L     @08,LWPPTR                                          1168
         TM    LWPRECON(@08),B'10000000'                           1168
         BNO   @RF01168                                            1168
*                       PMSGNM = MSG56432;/* USER NOT AUTH   @G32OPKU*/
         MVC   PMSGNM(2),@CH00933                                  1169
*                     ELSE                /* PUT OUT MSG     @G32OPKU*/
*                       PMSGNM = MSG56431;/* USER NOT AUTH   @G32OPKU*/
*                                                                  1170
         B     @RC01168                                            1170
@RF01168 MVC   PMSGNM(2),@CH00931                                  1170
*                 ELSE DO;                                         1171
         B     @RC01167                                            1171
@RF01167 DS    0H                                                  1172
*                   PMSGNM = MSG56416;    /* A RACINIT ERROR         */
         MVC   PMSGNM(2),@CH00921                                  1172
*                   TEXTINT1(3) =         /* LOGON TERMINATED        */
*                      ADDR(INSLOGON);                             1173
         LA    @08,INSLOGON                                        1173
         ST    @08,TEXTINT1+8                                      1173
*                   TEXTINT1(2) =         /* SEND MSG WITH RET CODE  */
*                      ADDR(TEXTSEGS(1));                          1174
         LA    @08,TEXTSEGS                                        1174
         ST    @08,TEXTINT1+4                                      1174
*                   IF BADVERFY = YES     /* BAD OID RC ?? @G32OPKU  */
*                     THEN DO;                                     1175
         TM    BADVERFY,B'00000001'                                1175
         BNO   @RF01175                                            1175
*                       TEXTINT1(1) = ADDR(INSOIDCD); /* OIDCARD NAME*/
         LA    @08,INSOIDCD                                        1177
         ST    @08,TEXTINT1                                        1177
*                       CALL BLDNUMB(OIDVERRC,TEXTSEGS(1));/*INSERT  */
         LA    @08,OIDVERRC                                        1178
         ST    @08,@AL00001                                        1178
         LA    @08,TEXTSEGS                                        1178
         ST    @08,@AL00001+4                                      1178
         LA    @01,@AL00001                                        1178
         BAL   @14,BLDNUMB                                         1178
*                       END;              /*                 @G32OPKU*/
*                     ELSE DO;                                     1180
         B     @RC01175                                            1180
@RF01175 DS    0H                                                  1181
*                       TEXTINT1(1) = ADDR(INSRINIT);/* SAY RACINIT  */
         LA    @08,INSRINIT                                        1181
         ST    @08,TEXTINT1                                        1181
*                       CALL BLDNUMB(RETCODE,TEXTSEGS(1));         1182
         LA    @08,RETCODE                                         1182
         ST    @08,@AL00001                                        1182
         LA    @08,TEXTSEGS                                        1182
         ST    @08,@AL00001+4                                      1182
         LA    @01,@AL00001                                        1182
         BAL   @14,BLDNUMB                                         1182
*                                                     /*BUILD RC TEXT*/
*                       END;                /* INSERT                */
*                   END;                                           1184
*                                                                  1184
@RC01175 DS    0H                                                  1185
*   CALL LGM;                        /* SEND RACF ERROR MESSAGES     */
*                                                                  1185
@RC01167 DS    0H                                                  1185
@RC01165 DS    0H                                                  1185
@RC01161 DS    0H                                                  1185
@RC01157 BAL   @14,LGM                                             1185
*END HANDLRAC;                                                     1186
@EL00015 DS    0H                                                  1186
@EF00015 DS    0H                                                  1186
@ER00015 LM    @14,@12,@SA00015                                    1186
         BR    @14                                                 1186
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RECONNECT                                               */
*/*                                                                  */
*/*RECONNECT RETURN CODES-                                           */
*/*      RC=0-                                                       */
*/*          RECONNECT TO PREVIOUS MEMORY WAS SUCCESSFUL,LOGON WILL  */
*/*          TERMINATE IN THIS MEMORY                                */
*/*                                                                  */
*/*      RC=4-                                                       */
*/*          PASSWORDS DO NOT MATCH--EITHER THE ONE SUPPLIED IS      */
*/*          INCORRECT OR NO PASSWORD WAS SUPPLIED AT XXX.USER IS    */
*/*          REPROMPTED FOR A PASSWORD AND THE RECONNECT IS TRIED    */
*/*          AGAIN                                                   */
*/*                                                                  */
*/*      RC=8-                                                       */
*/*          USERID NOT VALID--EITHER IT WAS NOT FOUND OR IT WAS     */
*/*          FOUND TO BE IN USE I.E.THE LINE HAD NOT DROPPED.THE     */
*/*          USER WILL BE PROMPTED FOR A NEW LOGON COMMAND           */
*/*                                                                  */
*/*      RC>8-                                                       */
*/*          SOME SORT OF RECONNECT ERROR--ISSUE AN ERROR MESSAGE    */
*/*          AND TERMINATE                                           */
*/*                                                                  */
*/*CHANGE ACTIVITY-                                                  */
*/*      @G32OPKU-                                                   */
*/*          THIS SEGMENT FOR RECONNECT ACTIVITY WAS MOVED FROM      */
*/*          MODULE IKJEFLEA TO MODULE IKJFELE FOR RACF VERSION 2    */
*/*          SUPPORT                                                 */
*/*                                                                  */
*/********************************************************************/
*RECONECT:                                                         1187
*        PROCEDURE;                                                1187
*                                                                  1187
RECONECT STM   @14,@12,@SA00016                                    1187
*                                  /*RECONNECT WAS          @G32OPKU*/
*                                  /*REQUESTED ON LOGON             */
*                                                                  1188
*         IF LWPACCTL ^= 0        /* IF ANY OTHER KEYWORDS  @Z40NQKC*/
*            LWPPROCL ^= 0        /* WERE ENTERED ON THE    @Z40NQKC*/
*            LWPREGNX ^= 0        /* LOGON COMMAND PUT OUT  @Z40NQKC*/
*            LWPPERFX ^= 0        /* WARNING MESSAGE        @Z40NQKC*/
*            LWPMAIL  ^= NO       /*'RECONNECT SPECIFIED-   @G32OPKU*/
*            LWPNOTIC ^= NO       /*OTHER OPERANDS IGNORED' @G32OPKU*/
*            LWPOIDCD ^= NO        /* IGNORE OIDCARD ALSO    @G32OPKU*/
*         THEN                     /*                          Y02669*/
         SLR   @08,@08                                             1188
         L     @15,LWPPTR                                          1188
         CH    @08,LWPACCTL(,@15)                                  1188
         BNE   @RT01188                                            1188
         CH    @08,LWPPROCL(,@15)                                  1188
         BNE   @RT01188                                            1188
         C     @08,LWPREGNX(,@15)                                  1188
         BNE   @RT01188                                            1188
         C     @08,LWPPERFX(,@15)                                  1188
         BNE   @RT01188                                            1188
         TM    LWPMAIL(@15),B'01110000'                            1188
         BZ    @RF01188                                            1188
@RT01188 DS    0H                                                  1189
*           DO;                                                    1189
*             PMSGNM = 38;         /*SET 'IGNORED' MSG NUMBER  Y02669*/
         MVC   PMSGNM(2),@CH03168                                  1190
*             CALL LGM;            /*PUT OUT 'IGNORED' MSG   @G32OPKU*/
         BAL   @14,LGM                                             1191
*           END;                                                   1192
*                                                                  1192
*         LWARNML = LWPUSERL;      /* USERID LENGTH TO LWA   @ZM44318*/
@RF01188 L     @08,LWAPTR                                          1193
         L     @15,LWPPTR                                          1193
         LH    @14,LWPUSERL(,@15)                                  1193
         STC   @14,LWARNML(,@08)                                   1193
*         LWARNM = '';             /* INIT TO BLANKS         @ZM44318*/
         MVI   LWARNM(@08),C' '                                    1194
         MVC   LWARNM+1(6,@08),LWARNM(@08)                         1194
*         LWARNM(1:LWARNML) = LWPUSER;/* GET USERID          @ZM44318*/
*                                                                  1195
         BCTR  @14,0                                               1195
         EX    @14,@SM03272                                        1195
*         CALL FDOLDTSB;           /* GET OLD TSB ADDR       @G32OPKU*/
*                                                                  1196
         BAL   @14,FDOLDTSB                                        1196
*         CALL RECONRAC;           /* RACINIT FOR USER       @G32OPKU*/
*                                                                  1197
         BAL   @14,RECONRAC                                        1197
*         IF LWPNPSWL ^= ZERO &    /* IF NEW PASSWRD ENTERED @G32OPKU*/
*            LWARACF = NO          /* AND RACF DIDN'T LIKE IT@G32OPKU*/
*           THEN DO;                                               1198
         SLR   @08,@08                                             1198
         L     @01,LWPPTR                                          1198
         CH    @08,LWPNPSWL(,@01)                                  1198
         BE    @RF01198                                            1198
         L     @01,LWAPTR                                          1198
         TM    LWARACF(@01),B'01000000'                            1198
         BNZ   @RF01198                                            1198
*             IF CVTRAC = ZERO     /* RACF NOT IN SYS        @G32OPKU*/
*               THEN               /*                        @G32OPKU*/
         L     @01,CVTPTR                                          1200
         C     @08,CVTRAC(,@01)                                    1200
         BNE   @RF01200                                            1200
*                 PMSGNM = MSG56426; /* UNSUPPORTED KEYWD MSG@G32OPKU*/
         MVC   PMSGNM(2),@CH00786                                  1201
*               ELSE               /*                        @G32OPKU*/
*                 PMSGNM = MSG56419; /* UNAUTH USER MSG      @G32OPKU*/
         B     @RC01200                                            1202
@RF01200 MVC   PMSGNM(2),@CH00925                                  1202
*             TEXTINT1(1) = ADDR(INSNPSWD);/* NEW PASWD INSRT@G32OPKU*/
@RC01200 LA    @08,INSNPSWD                                        1203
         ST    @08,TEXTINT1                                        1203
*             CALL LGM;            /* PUTOUT MSG             @G32OPKU*/
         BAL   @14,LGM                                             1204
*             LWPNPSWL = ZERO;     /* ZERO FOR LATER REF     @G32OPKU*/
         L     @08,LWPPTR                                          1205
         SLR   @15,@15                                             1205
         STH   @15,LWPNPSWL(,@08)                                  1205
*             END;                 /*                        @G32OPKU*/
*                                                                  1206
*                                  /*CALL TIOC TO SEARCH TSB   Y02669*/
*                                  /*TABLE FOR USERID AND/OR   Y02669*/
*                                  /*PASSWORD TO BE            Y02669*/
*                                  /*RECONNECTED               Y02669*/
*         USER = LWPUSER;            /*MOVE USERID FROM LE'S @Z40NQKC*/
@RF01198 MVI   USER+7,C' '                                         1207
         L     @08,LWPPTR                                          1207
         MVC   USER(7),LWPUSER(@08)                                1207
*                                  /*PARM LIST TO EIGHT BYTE   Y02669*/
*                                  /*FIELD FOR TIOC            Y02669*/
*         IF LWPPSWDL = 0           /*IF NO PASSWORD SUPPLIED@Z40NQKC*/
*           THEN                   /*THEN SET FIELD TO         Y02669*/
         LH    @08,LWPPSWDL(,@08)                                  1208
         LTR   @08,@08                                             1208
         BNZ   @RF01208                                            1208
*             PASSWORD=' ';        /*BLANKS                    Y02669*/
*                                                                  1209
         MVI   PASSWORD+1,C' '                                     1209
         MVC   PASSWORD+2(6),PASSWORD+1                            1209
         MVI   PASSWORD,C' '                                       1209
*           ELSE PASSWORD=LWPPSWD;   /*ELSE PUT IN PASSWORD  @Z40NQKC*/
*                                                                  1210
         B     @RC01208                                            1210
@RF01208 L     @08,LWPPTR                                          1210
         MVC   PASSWORD(8),LWPPSWD(@08)                            1210
*         PTRUSER=ADDR(USER);      /*POINT TO USERID           Y02669*/
@RC01208 LA    @08,USER                                            1211
         ST    @08,PTRUSER                                         1211
*         PTRPSWRD=ADDR(PASSWORD); /*POINT TO PASSWORD         Y02669*/
         LA    @08,PASSWORD                                        1212
         ST    @08,PTRPSWRD                                        1212
*CALLTIOC:                                                   /*Y02669*/
*        IF TSBVTAM = '1'B         /* FOR SNA/VTAM           @Z40DQKC*/
*          THEN DO;                /* VTAM RECONNECT         @Z40DQKC*/
CALLTIOC L     @08,TSBPTR                                          1213
         TM    TSBVTAM(@08),B'00000001'                            1213
         BNO   @RF01213                                            1213
*            RFY GPR01P RSTD;                              /*@Z40DQKC*/
*            GPR01P = ADDR(TIOCPARM); /* VTAM PARMLIST ADDR  @Z40DQKC*/
         LA    GPR01P,TIOCPARM                                     1216
*            CALL IKTLOGR;            /* PERFORM RECONNECT   @Z40DQKC*/
         L     @15,@CV00277                                        1217
         BALR  @14,@15                                             1217
*            RFY GPR01P UNRSTD;                            /*@Z40DQKC*/
*            END;                                          /*@Z40DQKC*/
*          ELSE DO;                /* TCAM RECONNECT         @Z40DQKC*/
         B     @RC01213                                            1220
@RF01213 DS    0H                                                  1221
*            RFY GPR15P RSTD;                              /*@Z40DQKC*/
*            GPR15P = ADDR(TIOCPARM); /* QTIP PARMLIST ADDR  @Z40DQKC*/
         LA    GPR15P,TIOCPARM                                     1222
*            GEN(QTIP 1);             /* PERFORM RECONNECT   @Z40DQKC*/
         QTIP 1
*            RFY GPR15P UNRSTD;                            /*@Z40DQKC*/
*            END;                                          /*@Z40DQKC*/
*                                                                  1225
*         RESPECIFY (REASONCD,RTNREG) RSTD;                  /*Y02669*/
@RC01213 DS    0H                                                  1227
*         IF RTNREG = 0            /*IF SUCCESSFUL RETURN-     Y02669*/
*                                  /*USER HAS BEEN             Y02669*/
*                                  /* RECONNECTED              Y02669*/
*           THEN DO;               /*                        @G32OPKU*/
*                                                                  1227
         SLR   @14,@14                                             1227
         CR    RTNREG,@14                                          1227
         BNE   @RF01227                                            1227
*             IF LWPNPSWL ^= ZERO  /* IF NEW PASSWORD        @G32OPKU*/
*                & LWARACF = YES   /* AND DEFINED TO RACF    @ZM44711*/
*               THEN DO;           /* HAS BEEN GIVEN         @G32OPKU*/
         L     @08,LWPPTR                                          1229
         CH    @14,LWPNPSWL(,@08)                                  1229
         BE    @RF01229                                            1229
         L     @14,LWAPTR                                          1229
         TM    LWARACF(@14),B'01000000'                            1229
         BNO   @RF01229                                            1229
*                 CALL SETLOCK;    /* OBTAIN CMS LOCK        @G32OPKU*/
         BAL   @14,SETLOCK                                         1231
*                 ROLDTSB->TSBPSWD = LWPNPSWD;/* MOVE PASSWD @G32OPKU*/
         L     @14,ROLDTSB                                         1232
         L     @08,LWPPTR                                          1232
         MVC   TSBPSWD(8,@14),LWPNPSWD(@08)                        1232
*                 CALL RELLOCK;    /* FREE LOCKS             @G32OPKU*/
         BAL   @14,RELLOCK                                         1233
*                 END;             /*                        @G32OPKU*/
*            GOTO CLEANUP4;        /* PACK IT IN-HOME FREE   @G32OPKU*/
         B     CLEANUP4                                            1235
*            END;                  /*                        @G32OPKU*/
*                                                                  1236
*         IF RTNREG = 4            /*IF PASSWORD DID NOT       Y02669*/
*                                  /*MATCH PREVIOUS SESSION'S  Y02669*/
*           THEN                                                   1237
@RF01227 C     RTNREG,@CF00098                                     1237
         BNE   @RF01237                                            1237
*             DO;                                                  1238
*               IF LWARACF = YES   /* IF RACF ENVIRONMENT    @G32OPKU*/
*                 THEN DO;         /*                        @G32OPKU*/
         L     @14,LWAPTR                                          1239
         TM    LWARACF(@14),B'01000000'                            1239
         BNO   @RF01239                                            1239
*                   CALL RACFDEL;  /* DELETE ENVIORNMENT     @G32OPKU*/
         BAL   @14,RACFDEL                                         1241
*                   PMSGNM = MSG56440;/* RECON REJECTED MSG  @G32OPKU*/
         MVC   PMSGNM(2),@CH00948                                  1242
*                   CALL LGM;      /* PUT OUT MSG            @G32OPKU*/
         BAL   @14,LGM                                             1243
*                   STATUS = CONTINUE;/* OK TO TRY AGAIN     @G32OPKU*/
         SLR   @14,@14                                             1244
         ST    @14,STATUS                                          1244
*                   NOPRMPT = YES; /* TRY AGAIN BIT ON       @G32OPKU*/
         OI    NOPRMPT,B'00100000'                                 1245
*                   GOTO CLEANUP4; /* LET'S CLEAN UP FIRST   @G32OPKU*/
         B     CLEANUP4                                            1246
*                   END;           /*                        @G32OPKU*/
*               IF PASSWORD=' '    /*IF NO PASSWORD ENTERED    Y02669*/
*                 THEN PMSGNM=40;  /*ISSUE PASSWORD REQUIRED @G32OPKU*/
@RF01239 CLI   PASSWORD,C' '                                       1248
         BNE   @RF01248                                            1248
         MVC   PMSGNM(2),@CH00499                                  1249
*                 ELSE PMSGNM=39;  /*ISSUE PASSWORK INVALID  @G32OPKU*/
*                                                                  1250
         B     @RC01248                                            1250
@RF01248 MVC   PMSGNM(2),@CH03174                                  1250
*               PRMTSWC =  2 ;     /*PROMPT FOR ANOTHER      @G32OPKU*/
@RC01248 MVC   PRMTSWC(2),@CH00135                                 1251
*                                  /*PASSWORD                        */
*               CALL PROMPT;       /*PROMPT USER             @G32OPKU*/
*                                                                  1252
         BAL   @14,PROMPT                                          1252
*               PASSWORD = LWPPSWD;  /*SET NEW PASSWORD      @G32OPKU*/
         L     @14,LWPPTR                                          1253
         MVC   PASSWORD(8),LWPPSWD(@14)                            1253
*                                    /*AND TRY AGAIN         @G32OPKU*/
*               GO TO CALLTIOC;                             /* Y02669*/
         B     CALLTIOC                                            1254
*              END;                                         /* Y02669*/
*                                                                  1255
*                                                                  1255
*     IF RTNREG = 8                /*IF USERID NOT VALID       Y02669*/
*      THEN                        /*THEN                      Y02669*/
@RF01237 C     RTNREG,@CF00046                                     1256
         BNE   @RF01256                                            1256
*       DO;                        /*SET UP ERROR MESSAGE      Y02669*/
*                                                                  1257
*        IF REASONCD=0             /*IF USERID NOT FOUND       Y02669*/
*           THEN                   /*THEN                      Y02669*/
         LTR   REASONCD,REASONCD                                   1258
         BNZ   @RF01258                                            1258
*             PMSGNM=42;           /*SET MSG NUMBER TO 'USERID Y02669*/
         MVC   PMSGNM(2),@CH03175                                  1259
*                                  /*NOT FOUND' MESSAGE        Y02669*/
*           ELSE PMSGNM=43;        /*ELSE SET MSG NUMBER TO    Y02669*/
         B     @RC01258                                            1260
@RF01258 MVC   PMSGNM(2),@CH03176                                  1260
*                                  /*'USERID IN USE' MSG       Y02669*/
*         TEXTINT1(1)=ADDR(LWPUSERI);/*GET USERID INSERT FOR @G32OPKU*/
@RC01258 L     @14,LWPPTR                                          1261
         LA    @14,LWPUSERI(,@14)                                  1261
         ST    @14,TEXTINT1                                        1261
*                                  /*MESSAGE BUFFER                  */
*                                                                  1262
*         CALL LGM;                /*PUT OUT ERROR MESSAGE   @G32OPKU*/
*                                                                  1262
         BAL   @14,LGM                                             1262
*         CALL RACFDEL;            /* DELETE ENVIRONMENT BEFOR EXIT
*                                                            @G32OPKU*/
         BAL   @14,RACFDEL                                         1263
*         STATUS = CONTINUE;       /* OK TO GO ON            @G32OPKU*/
         SLR   @14,@14                                             1264
         ST    @14,STATUS                                          1264
*         NOPRMPT = YES;           /*I AM NOT SURE OF THIS   @G32OPKU*/
         OI    NOPRMPT,B'00100000'                                 1265
*                                  /*BUT IT GETS PROCESSED AS BEFORE */
*         GO TO CLEANUP0;          /*GO TO CLEANUP ENTRY     @G32OPKU*/
         B     CLEANUP0                                            1266
*                                  /*FOR NO-PROMPT           @G32OPKU*/
*                                  /*PROCESSING AS PREVIOUSLY DONE   */
*       END;                                                       1267
*                                                                  1267
*    ELSE                          /*MUST BE QTIP ERROR       Y02669*/
*      DO;                         /*SET UP ERROR MESSAGE     Y02669*/
@RF01256 DS    0H                                                  1269
*        GEN;                      /*PREPARE RTN CODE FOR MSG  Y02669*/
*                                                                  1269
         CVD RTNREG,PACKDEC                CONVERT TO DECIMAL  Y02669
         UNPK ZONEDEC(8),PACKDEC(8)                            Y02669
         OI   ZONEDEC+7,X'F0'              CHANGE SIGN         Y02669
*        STATUS = CONTINUE;        /* OK TO GO ON            @G32OPKU*/
*                                                                  1270
         SLR   @14,@14                                             1270
         ST    @14,STATUS                                          1270
*        PMSGNM=20;                /*SET MSG NUMBER TO       @G32OPKU*/
         MVC   PMSGNM(2),@CH00340                                  1271
*                                  /*SERVICE RTN ERROR         Y02669*/
*        TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*GET ADDR OF ERROR    Y02669*/
         LA    @08,TEXTSEGS                                        1272
         ST    @08,TEXTINT1                                        1272
*                                  /*ROUTINE SEGMENT           Y02669*/
*        TEXTSLEN(1)=8;            /*SET LEN OF TEXT           Y02669*/
         MVC   TEXTSLEN(2),@CH00046                                1273
*        TEXTSOST(1)=0;            /*SET OFFSET OF TEXT        Y02669*/
         STH   @14,TEXTSOST                                        1274
*        IF TSBVTAM = YES          /*IF THIS WAS VTAM SET IN @G32OPKU*/
*           THEN TEXTSTXT(1,1:7)='IKTLOGR';/*ERR MOD NAME    @G32OPKU*/
         L     @14,TSBPTR                                          1275
         TM    TSBVTAM(@14),B'00000001'                            1275
         BNO   @RF01275                                            1275
         MVC   TEXTSTXT(7),@CC03177                                1276
*           ELSE TEXTSTXT(1,1:4)='QTIP';/*OR QTIP ERR        @G32OPKU*/
*                                                                  1277
         B     @RC01275                                            1277
@RF01275 MVC   TEXTSTXT(4),@CC03178                                1277
*        TEXTINT1(2)=ADDR(TEXTSEGS(2)); /*GET ADDR OF ERROR    Y02669*/
@RC01275 LA    @14,TEXTSEGS+24                                     1278
         ST    @14,TEXTINT1+4                                      1278
*                                  /*RETURN CODE SEGMENT       Y02669*/
*        TEXTSLEN(2)=7;            /*SET LEN OF TEXT           Y02669*/
         MVC   TEXTSLEN+24(2),@CH00133                             1279
*        TEXTSOST(2)=0;            /*SET OFFSET OF TEXT        Y02669*/
         SLR   @14,@14                                             1280
         STH   @14,TEXTSOST+24                                     1280
*        TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*PUT IN RETURN CODE    Y02669*/
*                                                                  1281
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1281
*         IF LWPUSERL ^=0           /*IF USERID IS KNOWN,    @Z40NQKC*/
*           THEN                   /* THEN POINT TO USERID SEG Y02669*/
         L     @08,LWPPTR                                          1282
         CH    @14,LWPUSERL(,@08)                                  1282
         BE    @RF01282                                            1282
*             TEXTINT1(3)=ADDR(LWPUSERI);                  /*@Z40NQKC*/
         LA    @14,LWPUSERI(,@08)                                  1283
         ST    @14,TEXTINT1+8                                      1283
*                                  /*ELSE USERID IS UNKNOWN    Y02669*/
*             ELSE TEXTINT1(3)=0;                            /*Y02669*/
*                                                                  1284
         B     @RC01282                                            1284
@RF01282 SLR   @14,@14                                             1284
         ST    @14,TEXTINT1+8                                      1284
*         IF LWPPROCL ^=0           /*IF PROCNAME IS KNOWN   @Z40NQKC*/
*           THEN                   /*THEN POINT TO PROC SGMENT Y02669*/
@RC01282 L     @14,LWPPTR                                          1285
         LH    @08,LWPPROCL(,@14)                                  1285
         LTR   @08,@08                                             1285
         BZ    @RF01285                                            1285
*             TEXTINT1(4)=ADDR(LWPPROCI);                  /*@Z40NQKC*/
         LA    @14,LWPPROCI(,@14)                                  1286
         ST    @14,TEXTINT1+12                                     1286
*                                  /*ELSE PROC IS UNKNOWN      Y02669*/
*           ELSE TEXTINT1(4)=0;                                    1287
         B     @RC01285                                            1287
@RF01285 SLR   @14,@14                                             1287
         ST    @14,TEXTINT1+12                                     1287
*         CALL LGM;                /*PUT OUT ERROR MESSAGE     Y02669*/
@RC01285 BAL   @14,LGM                                             1288
*         GO TO CLEANUP4;          /*AND CLOSE OUT LOGON     @G32OPKU*/
         B     CLEANUP4                                            1289
*       END;                                                 /*Y02669*/
*                                                                  1290
* RESPECIFY (REASONCD,RTNREG) UNRSTD; /*                     @G32OPKU*/
*                                                                  1291
*                                                                  1291
*END RECONECT;                                                     1292
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          SETLOCK                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          OBTAIN THE LOCAL AND CMS LOCKS TO ACCESS THE TSB        */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          FIRST THE LOCAL LOCK IS OBTAINED.IF SUCCESSFUL,THEN     */
*/*          THE CMS LOCK IS OBTAINED                                */
*/*                                                                  */
*/*          IF EITHER OBTAIN LOCK FAILS,A MESSAGE IS SENT TO THE    */
*/*          OPERATOR WITH THE ERROR RETURN CODE.ALSO,THE USERID     */
*/*          AND PROC ARE INCLUDED IF AVAILABLE                      */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          NEW SEGMENT FOR RACF VERSION 2 SUPPORT                  */
*/*                                                                  */
*/********************************************************************/
*SETLOCK:                                                          1293
*        PROCEDURE;                                                1293
*                                                                  1293
SETLOCK  STM   @14,@12,@SA00017                                    1293
*   RFY (RTNREG) RSTD;                                             1294
*   GEN REFS(PSALITA,FLC);             /* OBTAIN THE LOCAL LOCK      */
  SETLOCK  OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,RELATED=(TSB,RELLOCK)
*   LOCKRC = RTNREG;                   /* SAVE SETLOCK RETURN CODE   */
*                                                                  1296
         LR    LOCKRC,RTNREG                                       1296
*   IF LOCKRC = ZERO                   /* IF ZERO RETURN CODE        */
*     THEN DO;                         /* AQUIRE THE CMS LOCK        */
         LTR   LOCKRC,LOCKRC                                       1297
         BNZ   @RF01297                                            1297
*       GEN REFS(PSALITA,FLC);                                     1299
  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,RELATED=(TSB,RELLOCK)
*       LOCKRC=RTNREG;                 /* SAVE SETLOCK RETURN CODE   */
         LR    LOCKRC,RTNREG                                       1300
*       END;                                                       1301
*  RFY (RTNREG) UNRSTD;                /* RETURN REG TO THE COMPILER */
*                                                                  1302
@RF01297 DS    0H                                                  1303
*  IF LOCKRC ^= ZERO                   /* IF ONE OF THE LOCKS DID NOT*/
*    THEN                              /* WORK SO VERY RED HOT START */
         LTR   LOCKRC,LOCKRC                                       1303
         BZ    @RF01303                                            1303
*      DO;                             /* PUTTING A MSG TOGETHER     */
*        CVD(LOCKRC,PACKDEC);          /* CONVERT THE RET CODE       */
         CVD   LOCKRC,PACKDEC                                      1305
*        UNPK(ZONEDEC,PACKDEC);        /* TO PRINTABLE               */
         UNPK  ZONEDEC(8),PACKDEC(8)                               1306
*        GEN(OI ZONEDEC+7,X'F0');      /* HIT THE ZONE BYTE          */
*                                                                  1307
         OI ZONEDEC+7,X'F0'
*        PMSGNM = 20;                  /* SET ERROR MSG NUMBER       */
*                                                                  1308
         MVC   PMSGNM(2),@CH00340                                  1308
*        TEXTINT1(1) = ADDR(TEXTSEGS(1)); /* POINT TO INSERT SEGMENT */
         LA    @08,TEXTSEGS                                        1309
         ST    @08,TEXTINT1                                        1309
*        TEXTSLEN(1) = 15;                /* SET UP MSG LENGTH,      */
         MVC   TEXTSLEN(2),@CH00053                                1310
*        TEXTSOST(1) = 0;                 /* OFFSET,                 */
         SLR   @08,@08                                             1311
         STH   @08,TEXTSOST                                        1311
*        TEXTSTXT(1,1:11) = 'OBTAIN LOCK';/* AND MSG TEXT            */
*                                                                  1312
         MVC   TEXTSTXT(11),@CC03183                               1312
*        TEXTINT1(2) = ADDR(TEXTSEGS(2)); /* POINT TO SECOND INSERT  */
         LA    @15,TEXTSEGS+24                                     1313
         ST    @15,TEXTINT1+4                                      1313
*        TEXTSLEN(2) = 7;                 /* SET UP MSG LENGTH,      */
         MVC   TEXTSLEN+24(2),@CH00133                             1314
*        TEXTSOST(2) = 0;                 /* OFFSET,                 */
         STH   @08,TEXTSOST+24                                     1315
*        TEXTSTXT(2,1:3) = ZONEDEC(6:8);  /* AND ERROR RET CODE      */
*                                                                  1316
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1316
*        IF LWPUSERL ^= 0                 /* IS THER A USERID ???    */
*          THEN                                                    1317
         L     @15,LWPPTR                                          1317
         CH    @08,LWPUSERL(,@15)                                  1317
         BE    @RF01317                                            1317
*            TEXTINT1(3) = ADDR(LWPUSERI);/* YES, PLUG IT IN         */
         LA    @08,LWPUSERI(,@15)                                  1318
         ST    @08,TEXTINT1+8                                      1318
*          ELSE                                                    1319
*            TEXTINT1(3) = 0;             /* OTHERWISE ZERO PTR      */
         B     @RC01317                                            1319
@RF01317 SLR   @08,@08                                             1319
         ST    @08,TEXTINT1+8                                      1319
*        IF LWPPROCL ^= 0                 /* IS THERE A PROC NAME ?? */
*          THEN                                                    1320
@RC01317 L     @08,LWPPTR                                          1320
         LH    @15,LWPPROCL(,@08)                                  1320
         LTR   @15,@15                                             1320
         BZ    @RF01320                                            1320
*            TEXTINT1(4) = ADDR(LWPPROCI);/* YES, PLUG IT IN         */
         LA    @08,LWPPROCI(,@08)                                  1321
         ST    @08,TEXTINT1+12                                     1321
*          ELSE                                                    1322
*            TEXTINT1(4) = 0;             /* OTHERWISE ZERO PTR      */
         B     @RC01320                                            1322
@RF01320 SLR   @08,@08                                             1322
         ST    @08,TEXTINT1+12                                     1322
*        CALL LGM;                        /* PUT OUT ERROR MSG       */
*                                                                  1323
@RC01320 BAL   @14,LGM                                             1323
*        GOTO CLEANUP4;                   /* RETURN FOR ERROR        */
         B     CLEANUP4                                            1324
*      END;                                                        1325
*  RETURN;                                                         1326
*                                                                  1326
*                                                                  1326
*                                                                  1326
@EL00017 DS    0H                                                  1326
@EF00017 DS    0H                                                  1326
@ER00017 LM    @14,@12,@SA00017                                    1326
         BR    @14                                                 1326
*END SETLOCK;                                                      1327
         B     @EL00017                                            1327
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RELLOCK                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          RELEASE CMS AND LOCAL LOCKS AFTER ACCESSING THE TSB     */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          FIRST THE CMS LOCK IS RELEASED.IF SUCCESSFUL THE LOCAL  */
*/*          LOCK IS THEN RELEASED                                   */
*/*                                                                  */
*/*          IF EITHER RELEASE LOCK FAILS,A MESSAGE IS SENT TO THE   */
*/*          OPERATOR WITH THE ERROR RETURN CODE.ALSO,THE USERID     */
*/*          AND PROC NAME ARE INCLUDED IF AVAILABLE                 */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          NEW SEGMENT FOR RACF VERSION2 SUPPORT                   */
*/*                                                                  */
*/********************************************************************/
*RELLOCK:                                                          1328
*        PROCEDURE;                                                1328
*                                                                  1328
RELLOCK  STM   @14,@12,@SA00018                                    1328
*  RFY (RTNREG) RSTD;                                              1329
*  GENERATE REFS(PSALITA,FLC);     /* RELEASE CMS LOCK               */
     SETLOCK RELEASE,TYPE=CMS,REGS=USE,RELATED=(TSB,SETLOCK)
*  LOCKRC = RTNREG;                /* SAVE RET CODE                  */
         LR    LOCKRC,RTNREG                                       1331
*        GEN REFS(PSALITA,FLC);                                    1332
*                                                                  1332
     SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,RELATED=(TSB,SETLOCK)
* IF LOCKRC ^= ZERO  RTNREG ^= ZERO   /* IF ONE OF THE LOCKS DID NOT*/
*   THEN                               /* WORK SO VERY RED HOT       */
         SLR   @14,@14                                             1333
         CR    LOCKRC,@14                                          1333
         BNE   @RT01333                                            1333
         CR    RTNREG,@14                                          1333
         BE    @RF01333                                            1333
@RT01333 DS    0H                                                  1334
*     DO;                               /* START PUTTING MSG TOGETHER*/
*       IF LOCKRC = ZERO                /* IF FAILURE NO IN CMS LOCK */
*         THEN                          /* IT MUST BE IN LOCAL LOCK  */
         LTR   LOCKRC,LOCKRC                                       1335
         BNZ   @RF01335                                            1335
*           LOCKRC = RTNREG;            /* SAVE LOCAL LOCK RET CODE  */
         LR    LOCKRC,RTNREG                                       1336
*       RFY (RTNREG) UNRSTD;            /* RELEASE  REG R15          */
@RF01335 DS    0H                                                  1338
*       CVD(LOCKRC,PACKDEC);            /* CONVERT THE RET CODE      */
         CVD   LOCKRC,PACKDEC                                      1338
*       UNPK(ZONEDEC,PACKDEC);          /* TO PRINTABLE              */
         UNPK  ZONEDEC(8),PACKDEC(8)                               1339
*       GEN(OI ZONEDEC+7,X'F0');        /* HIT THE ZONE BYTE         */
*                                                                  1340
         OI ZONEDEC+7,X'F0'
*       PMSGNM = 20;                    /* SET ERROR MSG NUMBER      */
*                                                                  1341
         MVC   PMSGNM(2),@CH00340                                  1341
*       TEXTINT1(1) = ADDR(TEXTSEGS(1));/* POINT TO INSERT SEGMENT   */
         LA    @08,TEXTSEGS                                        1342
         ST    @08,TEXTINT1                                        1342
*       TEXTSLEN(1) = 16;               /* SET UP MSG LENGTH,        */
         MVC   TEXTSLEN(2),@CH00145                                1343
*       TEXTSOST(1) = 0;                /* OFFSET,                   */
         SLR   @08,@08                                             1344
         STH   @08,TEXTSOST                                        1344
*       TEXTSTXT(1,1:12) = 'RELEASE LOCK';/* AND MSG TEXT            */
*                                                                  1345
         MVC   TEXTSTXT(12),@CC03188                               1345
*       TEXTINT1(2) = ADDR(TEXTSEGS(2));/* POINT TO SECOND INSERT    */
         LA    @15,TEXTSEGS+24                                     1346
         ST    @15,TEXTINT1+4                                      1346
*       TEXTSLEN(2) = 7;                /* SET UP MSG LENGTH,        */
         MVC   TEXTSLEN+24(2),@CH00133                             1347
*       TEXTSOST(2) = 0;                /* OFFSET,                   */
         STH   @08,TEXTSOST+24                                     1348
*       TEXTSTXT(2,1:3) = ZONEDEC(6:8); /* AND ERROR RET CODE        */
*                                                                  1349
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1349
*       IF LWPUSERL ^= 0                /* IS THER A USERID ???      */
*         THEN                                                     1350
         L     @15,LWPPTR                                          1350
         CH    @08,LWPUSERL(,@15)                                  1350
         BE    @RF01350                                            1350
*           TEXTINT1(3) = ADDR(LWPUSERI);/* YES, PLUG IT IN          */
         LA    @08,LWPUSERI(,@15)                                  1351
         ST    @08,TEXTINT1+8                                      1351
*         ELSE                                                     1352
*           TEXTINT1(3) = 0;            /* OTHERWISE ZERO PTR        */
         B     @RC01350                                            1352
@RF01350 SLR   @08,@08                                             1352
         ST    @08,TEXTINT1+8                                      1352
*       IF LWPPROCL ^= 0                /* IS THERE A PROC NAME ??   */
*         THEN                                                     1353
@RC01350 L     @08,LWPPTR                                          1353
         LH    @15,LWPPROCL(,@08)                                  1353
         LTR   @15,@15                                             1353
         BZ    @RF01353                                            1353
*           TEXTINT1(4) = ADDR(LWPPROCI);/* YES, PLUG IT IN          */
         LA    @08,LWPPROCI(,@08)                                  1354
         ST    @08,TEXTINT1+12                                     1354
*         ELSE                                                     1355
*           TEXTINT1(4) = 0;            /* OTHERWISE ZERO PTR        */
         B     @RC01353                                            1355
@RF01353 SLR   @08,@08                                             1355
         ST    @08,TEXTINT1+12                                     1355
*       CALL LGM;                       /* PUT OUT ERROR MSG         */
*                                                                  1356
@RC01353 BAL   @14,LGM                                             1356
*       GOTO CLEANUP4;                  /* RETURN FOR ERROR          */
         B     CLEANUP4                                            1357
*     END;                                                         1358
*  RETURN;                                                         1359
*                                                                  1359
*                                                                  1359
*                                                                  1359
@EL00018 DS    0H                                                  1359
@EF00018 DS    0H                                                  1359
@ER00018 LM    @14,@12,@SA00018                                    1359
         BR    @14                                                 1359
*END RELLOCK;                                                      1360
         B     @EL00018                                            1360
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          OIDVERFY                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          VERIFY OIDCARD                                          */
*/*                                                                  */
*/*OPERATION-                                                        */
*/*          IF OIDCARD WAS ENTERED ON LOGON COMMAND,IT WILL BE      */
*/*          PROMPTED FOR NOW.IF RACINIT REQUIRES AN OIDCARD AND     */
*/*          NONE WAS ENTERED OR THE USER ENTERED AN INVALID         */
*/*          OIDCARD,A PROMPT WILL BE ISSUED.                        */
*/*                                                                  */
*/*          IF AN OIDCARD IS REQUIRED BY RACINIT AND THE USER IS    */
*/*          ON A TERMINAL THAT DOES NOT SUPPORT AN OIDCARD READER,  */
*/*          LOGON WILL TERMINATE.                                   */
*/*                                                                  */
*/*          IKJEFLGM WILL HANDLE PROMPTING BECAUSE THE OIDCARD      */
*/*          MUST BE READ ASIS.ICHRID00 WILL BE CALLED TO HANDLE     */
*/*          OIDCARD CHECKING.                                       */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          THIS SEGMENT WAS ADDED TO SUPPORT RACF VERSION2         */
*/*                                                                  */
*/********************************************************************/
*OIDVERFY:                                                         1361
*        PROCEDURE;                                                1361
*                                                                  1361
*                                                                  1361
OIDVERFY STM   @14,@12,@SA00019                                    1361
*DCL HOLDLEN FIXED(31);           /* TEMP SAVE AREA FOR BUFFER LEN   */
*OIDVERRC = BADOID;               /* INITIALIZE FOR DO LOOP          */
*                                                                  1363
         MVC   OIDVERRC(4),@CF00046                                1363
*DO WHILE OIDVERRC = BADOID;      /* AS LONG AS OIDCD NOT GOOD     1364
*                                    KEEP PROMPTING                  */
         B     @DE01364                                            1364
@DL01364 DS    0H                                                  1365
*  PTRYS = PTRYS+1;               /* INCREASE NUMBER OF TRYS         */
         LA    @08,1                                               1365
         AL    @08,PTRYS                                           1365
         ST    @08,PTRYS                                           1365
*  IF PTRYS >= LP0PRMT            /* IF USER HAS HAD TOO MANY TRYS   */
*    THEN DO;                     /* TO LOGON                        */
         L     @15,@CV00275                                        1366
         C     @08,LP0PRMT(,@15)                                   1366
         BL    @RF01366                                            1366
*      PMSGNM = MSGTOOAT;         /* PUT OUT THE ERROR MSG WITH      */
         MVC   PMSGNM(2),@CH00483                                  1368
*      TEXTINT1(1) = ADDR(LWPUSERI);/* USERID                        */
         L     @08,LWPPTR                                          1369
         LA    @08,LWPUSERI(,@08)                                  1369
         ST    @08,TEXTINT1                                        1369
*      CALL LGM;                  /* SEND IT                         */
         BAL   @14,LGM                                             1370
*      GOTO CLEANUP4;             /* AND THEN EXIT STAGE LEFT---     */
         B     CLEANUP4                                            1371
*      END;                                                        1372
*  CALL LGM;                      /* IF OK, PROMPT FOR OIDCARD       */
*                                                                  1373
@RF01366 BAL   @14,LGM                                             1373
*  HOLDLEN = CMNDLNG;             /* SAVE BUFFER LEN FOR FREEMAIN    */
         L     @08,INBUF                                           1374
         LH    @15,CMNDLNG(,@08)                                   1374
         LR    HOLDLEN,@15                                         1374
*  CMNDLNG = CMNDLNG - 4;         /* DECRIMENT FOR VERIFY ROUTINE    */
         SL    @15,@CF00098                                        1375
         STH   @15,CMNDLNG(,@08)                                   1375
*  INOID = ADDR(CMNDTEXT);        /* POINT TO OID BUFFER             */
         LA    @04,CMNDTEXT(,@08)                                  1376
         ST    @04,INOID                                           1376
*  INLENOID = ADDR(CMNDLNG);      /* POINT TO OIDCARD LENGTH         */
         ST    @08,INLENOID                                        1377
*  OUTOID = ADDR(OIDPTR);         /* PTR TO OUTPUT OIDCARD           */
         LA    @08,OIDPTR                                          1378
         ST    @08,OUTOID                                          1378
*  OUTLENID = ADDR(OIDLEN);       /* PTR TO OUTPUTOIDCARD LENGTH     */
*                                                                  1379
         LA    @08,OIDLEN                                          1379
         ST    @08,OUTLENID                                        1379
*  RFY (PARMPTR,RTNREG) RSTD;                                      1380
*  PARMPTR = ADDR(OIDPARM);       /* POINT TO PARM LIST              */
         LA    PARMPTR,OIDPARM                                     1381
*  CALL ICHRID00;                 /* OIDCARD VERIFY ROUTINE INVOKED  */
*                                                                  1382
         L     @08,CVTPTR                                          1382
         L     @08,CVTRAC(,@08)                                    1382
         L     @15,RCVTRID0(,@08)                                  1382
         BALR  @14,@15                                             1382
*  OIDVERRC = RTNREG;             /* SAVE RET CODE                   */
*                                                                  1383
         ST    RTNREG,OIDVERRC                                     1383
*  RFY (PARMPTR,RTNREG) UNRSTD;                                    1384
*  IF OIDVERRC = ZERO             /* OIDCARD WAS OK                  */
*    THEN DO;                                                      1385
         L     @08,OIDVERRC                                        1385
         LTR   @08,@08                                             1385
         BNZ   @RF01385                                            1385
*      ROIDDATA(1:OIDLEN) = OIDPTR->CMNDBUFR(1:OIDLEN);/* MOVE DATA  */
         LH    @08,OIDLEN                                          1387
         BCTR  @08,0                                               1387
         L     @04,OIDPTR                                          1387
         EX    @08,@SM03274                                        1387
*      ROIDLEN = CDLEN;           /* SET OID LEN FIELD               */
         IC    @08,CDLEN                                           1388
         STC   @08,ROIDLEN                                         1388
*      END;                                                        1389
*    ELSE                                                          1390
*      IF OIDVERRC = NOTOIDRD     /* IF TERM DOES NOT SUPPORT OID    */
*        THEN                                                      1390
         B     @RC01385                                            1390
@RF01385 CLC   OIDVERRC(4),@CF00098                                1390
         BNE   @RF01390                                            1390
*          LWANORDR = YES;        /* TELL THE WORLD ABOUT IT         */
         L     @08,LWAPTR                                          1391
         OI    LWANORDR(@08),B'01000000'                           1391
*        ELSE                                                      1392
*          IF OIDVERRC = BADOID   /* IF OIDCD INVALIDLY SETUP        */
*            THEN                                                  1392
         B     @RC01390                                            1392
@RF01390 CLC   OIDVERRC(4),@CF00046                                1392
         BNE   @RF01392                                            1392
*              PMSGNM = MSG56435; /* PROMPT FOR ANOTHER OIDCARD      */
         MVC   PMSGNM(2),@CH00939                                  1393
*            ELSE                                                  1394
*              BADVERFY = YES;    /* PACK UP YOUR TENT ALIBABA       */
*                                                                  1394
*                                                                  1394
         B     @RC01392                                            1394
@RF01392 OI    BADVERFY,B'00000001'                                1394
*  /******************************************************************/
*  /*  FREE BUFFER GOTTEN ON THE OIDCARD PROMPT                      */
*  /******************************************************************/
*                                                                  1395
*  IF INBUF ^= ZERO               /* IF BUFFER EXISTS - FREE IT      */
*    THEN DO;                                                      1395
@RC01392 DS    0H                                                  1395
@RC01390 DS    0H                                                  1395
@RC01385 L     @08,INBUF                                           1395
         LTR   @08,@08                                             1395
         BZ    @RF01395                                            1395
*      RFY (LENSTR) RSTD;                                          1397
*      LENSTR = HOLDLEN;          /* LENGTH TO BE FREED              */
         LR    LENSTR,HOLDLEN                                      1398
*      GEN(FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF); /* DOIT TOIT        */
         FREEMAIN R,SP=1,LV=(LENSTR),A=INBUF
*      INBUF = '0'X;              /* ZERO BUFFER PTR         @ZM44311*/
         SLR   @08,@08                                             1400
         ST    @08,INBUF                                           1400
*      RFY (LENSTR) UNRSTD;                                        1401
*      END;                                                        1402
*END;                                                              1403
*                                                                  1403
@RF01395 DS    0H                                                  1403
@DE01364 CLC   OIDVERRC(4),@CF00046                                1403
         BE    @DL01364                                            1403
*END OIDVERFY;                                                     1404
@EL00019 DS    0H                                                  1404
@EF00019 DS    0H                                                  1404
@ER00019 LM    @14,@12,@SA00019                                    1404
         BR    @14                                                 1404
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RECONRAC                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          THIS SEGMENT HANDLES RACINIT FOR LOGON RECONNECT        */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          THIS SEGMENT ADDED FOR RACF VERSION 2 SUPPORT           */
*/*                                                                  */
*/********************************************************************/
*RECONRAC:                                                         1405
*        PROCEDURE;                                                1405
*                                                                  1405
*                                                                  1405
RECONRAC STM   @14,@12,@SA00020                                    1405
*CALL RACINIT;                                                     1406
*                                                                  1406
         BAL   @14,RACINIT                                         1406
*ONCEAGAN:                                                         1407
*                                                                  1407
*DO WHILE RETCODE = OIDREQD         /* OIDCARD REQUIRED             */
*         RETCODE = OIDINV;          /* OIDCARD INVALID              */
ONCEAGAN B     @DE01407                                            1407
@DL01407 DS    0H                                                  1408
*  IF LWANORDR = NO  &               /* IF TERMINAL TYPE             */
*            BADVERFY = NO           /* SUPPORTS OIDCARD RDR         */
*    THEN DO;                        /* AND NOT BAD VERIFY           */
         L     @08,LWAPTR                                          1408
         TM    LWANORDR(@08),B'01000000'                           1408
         BNZ   @RF01408                                            1408
         TM    BADVERFY,B'00000001'                                1408
         BNZ   @RF01408                                            1408
*      IF RETCODE = OIDREQD          /* CHECK FOR MESSAGE            */
*        THEN                        /*                              */
         CLC   RETCODE(4),@CF00499                                 1410
         BNE   @RF01410                                            1410
*          PMSGNM = MSG56434;        /* OIDCARD REQ'D MSG            */
         MVC   PMSGNM(2),@CH00937                                  1411
*        ELSE                        /* ASSUME OIDCARD               */
*          PMSGNM = MSG56433;        /* NOT AUTHORIZED MSG           */
*                                                                  1412
         B     @RC01410                                            1412
@RF01410 MVC   PMSGNM(2),@CH00935                                  1412
*      CALL OIDVERFY;                /* VERIFY OIDCARD               */
*                                                                  1413
@RC01410 BAL   @14,OIDVERFY                                        1413
*      IF OIDVERRC = ZERO            /* OIDCARD OK ??                */
*        THEN                        /* YES, NEXT GIVE RACF          */
         L     @08,OIDVERRC                                        1414
         LTR   @08,@08                                             1414
         BNZ   @RF01414                                            1414
*          CALL RACINIT;             /* A CRACK AT IT                */
         BAL   @14,RACINIT                                         1415
*        ELSE                        /* NO,                          */
*          GOTO CLEANUP4;            /* GOTO ERROR EXIT              */
*    END;                                                          1417
*END;                                                              1418
*                                                                  1418
@RF01408 DS    0H                                                  1418
@DE01407 L     @08,RETCODE                                         1418
         C     @08,@CF00499                                        1418
         BE    @DL01407                                            1418
         C     @08,@CF00175                                        1418
         BE    @DL01407                                            1418
*DO WHILE RETCODE = PSWDEXP         /* OLD PASSWORD EXPIRED         */
*         RETCODE = INVNPSWD        /* NEW PASSWORD INVALID         */
*         RETCODE = INVPSWD;         /* ENTERED PASSWD INVALID       */
*                                                                  1419
         B     @DE01419                                            1419
@DL01419 DS    0H                                                  1420
*  IF RETCODE = PSWDEXP                                            1420
*    THEN DO;                                                      1420
         CLC   RETCODE(4),@CF00034                                 1420
         BNE   @RF01420                                            1420
*      PMSGNM = MSG56415;            /* PASSWORD EXPIRED MSG         */
         MVC   PMSGNM(2),@CH00919                                  1422
*      PRMTSWC = PNPSWD;             /* PROMPT FOR NEW PASSWORD      */
         MVC   PRMTSWC(2),@CH00133                                 1423
*      END;                                                        1424
*    ELSE                                                          1425
*      IF RETCODE = INVNPSWD         /* INVALID NEW PASSWORD         */
*        THEN DO;                                                  1425
         B     @RC01420                                            1425
@RF01420 CLC   RETCODE(4),@CF00145                                 1425
         BNE   @RF01425                                            1425
*        PRMTSWC = PNPSWD;           /* PROMPT FOR NEW PASSWORD      */
         MVC   PRMTSWC(2),@CH00133                                 1427
*        PMSGNM = MSG56414;          /* INVALID NEW PASSWORD MSG     */
         MVC   PMSGNM(2),@CH00601                                  1428
*        END;                                                      1429
*      ELSE DO;                                                    1430
         B     @RC01425                                            1430
@RF01425 DS    0H                                                  1431
*        IF LWPPSWDL = ZERO          /* IF NO PASSWORD GIVEN         */
*          THEN PMSGNM = ZERO;       /* REQUEST PASSWORD FROM USER   */
         SLR   @08,@08                                             1431
         L     @01,LWPPTR                                          1431
         CH    @08,LWPPSWDL(,@01)                                  1431
         BNE   @RF01431                                            1431
         STH   @08,PMSGNM                                          1432
*          ELSE PMSGNM = MSG56421;   /* TRUELY AN INVALID PASSWORD   */
         B     @RC01431                                            1433
@RF01431 MVC   PMSGNM(2),@CH00046                                  1433
*        PRMTSWC = 2;                /* PROMPT FOR ANOTHER PASSWORD  */
@RC01431 MVC   PRMTSWC(2),@CH00135                                 1434
*        END;                                                      1435
*                                                                  1435
*  CALL PROMPT;                      /* PROMPT USER FOR NEW PASSWORD */
*                                                                  1436
@RC01425 DS    0H                                                  1436
@RC01420 BAL   @14,PROMPT                                          1436
*  CALL RACINIT;                     /* TEST IT OUT ON RACINIT AGAIN */
*                                                                  1437
         BAL   @14,RACINIT                                         1437
*  END;                                                            1438
@DE01419 L     @08,RETCODE                                         1438
         C     @08,@CF00034                                        1438
         BE    @DL01419                                            1438
         C     @08,@CF00145                                        1438
         BE    @DL01419                                            1438
         C     @08,@CF00046                                        1438
         BE    @DL01419                                            1438
*IF RETCODE ^= ZERO &                /* IF UNSUCCESSFUL AND          */
*   RETCODE ^= NORACF                /* RACF IS ACTIVE, CHECK FOR ERR*/
*  THEN DO;                                                        1439
         LTR   @08,@08                                             1439
         BZ    @RF01439                                            1439
         C     @08,@CF00357                                        1439
         BE    @RF01439                                            1439
*    IF RETCODE = NOPROF             /* USERID NOT DEFINED TO RACF   */
*      THEN DO;                                                    1441
         C     @08,@CF00098                                        1441
         BNE   @RF01441                                            1441
*        DUMMYRAC = YES;             /* DO DUMMY RACINIT             */
*                                                                  1443
         OI    DUMMYRAC,B'00000010'                                1443
*        CALL RACINIT;                                             1444
*                                                                  1444
         BAL   @14,RACINIT                                         1444
*        DUMMYRAC = NO;              /* TURN OFF DUMMY SWITCH        */
         NI    DUMMYRAC,B'11111101'                                1445
*        LWPNPSWL = 0;               /* USER NOT DEFINED TO RACF   1446
*                                       CAN'T USE NEW PASSWD @ZM44711*/
         SLR   @08,@08                                             1446
         L     @01,LWPPTR                                          1446
         STH   @08,LWPNPSWL(,@01)                                  1446
*        IF RETCODE ^= ZERO &        /* IF NOT SUCCESSFUL AND        */
*           RETCODE ^= NORACF        /* RACF IS ACTIVE               */
*          THEN                                                    1447
         L     @15,RETCODE                                         1447
         CR    @15,@08                                             1447
         BE    @RF01447                                            1447
         C     @15,@CF00357                                        1447
         BNE   @RT01447                                            1447
*            GOTO CLEANUP4;          /* BUZZ OFF IN PEACE            */
*      END;                                                        1449
*    ELSE DO;                        /* USER IS DEFINED TO RACF      */
         B     @RC01441                                            1450
@RF01441 DS    0H                                                  1451
*      IF RETCODE = INVGROUP         /* BUT GROUP NOT AUTHORIZED     */
*        THEN                        /* SEND MSG                     */
         CLC   RETCODE(4),@CF00340                                 1451
         BNE   @RF01451                                            1451
*          PMSGNM = MSG56441;        /* RECON REJECT GROUP INVALID   */
         MVC   PMSGNM(2),@CH00950                                  1452
*        ELSE                        /* ANOTHER POSSIBILITY IS...    */
*          IF RETCODE = GROUPREV     /* USERS GROUP  REVOKED         */
*            THEN                    /* TELL THE POOR SLOB RECONECT  */
         B     @RC01451                                            1453
@RF01451 CLC   RETCODE(4),@CF00497                                 1453
         BNE   @RF01453                                            1453
*              PMSGNM = MSG56444;    /* REJECTED - GROUP REVOKED     */
         MVC   PMSGNM(2),@CH00956                                  1454
*            ELSE                    /* IF NON OF THE ABOVE...       */
*              IF RETCODE = OIDREQD  /* OID REQD?                   */
*                 RETCODE = OIDINV   /* OR INVALID ?                 */
*                THEN                /* YES ,START                   */
         B     @RC01453                                            1455
@RF01453 L     @08,RETCODE                                         1455
         C     @08,@CF00499                                        1455
         BE    @RT01455                                            1455
         C     @08,@CF00175                                        1455
         BE    @RT01455                                            1455
*                  GOTO ONCEAGAN;    /* OVER AT TOP                  */
*                ELSE                                              1457
*                  GOTO CLEANUP4;    /* SELL YOUR WAR BONDS          */
         B     CLEANUP4                                            1457
*      CALL LGM;                     /* PUT OUT THE MSG              */
*                                                                  1458
@RC01453 DS    0H                                                  1458
@RC01451 BAL   @14,LGM                                             1458
*      NOPRMPT = YES;                /* SET UP  FOR ANOTHER LOGON    */
         OI    NOPRMPT,B'00100000'                                 1459
*      STATUS = CONTINUE;            /* OK TO TRY AGAIN              */
         SLR   @08,@08                                             1460
         ST    @08,STATUS                                          1460
*      GOTO CLEANUP0;                /* I KNEW WE WOULD BE EXITING   */
         B     CLEANUP0                                            1461
*      END;                          /* SOONER OR LATER  BUT THIS ?? */
*  END;                                                            1463
*                                                                  1463
*                                                                  1463
*END RECONRAC;                                                     1464
@EL00020 DS    0H                                                  1464
@EF00020 DS    0H                                                  1464
@ER00020 LM    @14,@12,@SA00020                                    1464
         BR    @14                                                 1464
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          RACFDEL                                                 */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          SEGMENT ISSUES RACINIT TO DELETE SECURITY RELATED       */
*/*          CONTROL BLOCKS                                          */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          NEW SEGMENT ADDED FOR RACF VERSION 2 SUPPORT            */
*/*                                                                  */
*/********************************************************************/
*RACFDEL:                                                          1465
*        PROCEDURE;                                                1465
*                                                                  1465
*                                                                  1465
RACFDEL  STM   @14,@12,@SA00021                                    1465
*IF LWARACF = YES                    /* IF RACF ENVIRONMENT EXISTED  */
*  THEN DO;                                                        1466
         L     @08,LWAPTR                                          1466
         TM    LWARACF(@08),B'01000000'                            1466
         BNO   @RF01466                                            1466
*    LWARACF = NO;                   /* TURN OFF BIT AND DELETE RACF */
         NI    LWARACF(@08),B'10111111'                            1468
*    RFY (GPR15P) RSTD;                                            1469
*      DO; /* RACINIT  MF(E,RACLST,COMPLETE) ENVIR(DELETE)*/       1470
*      RACLST = RACLST && RACLST;/*INIT. LIST*/                    1471
         XC    RACLST(48),RACLST                                   1471
*      RACLST01 = 48;/*PARM LIST LENGTH*/                          1472
         MVI   RACLST01,X'30'                                      1472
*      RACLST02 = '00000000'B;/*RESERVED FIELD*/                   1473
         MVI   RACLST02,B'00000000'                                1473
*      RACLST03 = '00000000'B;/*RESERVED FIELD*/                   1474
         MVI   RACLST03,B'00000000'                                1474
*      RACLST04 = '10000000'B; /*SET ENVIR FLAGS*/                 1475
         MVI   RACLST04,B'10000000'                                1475
*      RESPECIFY GPR01P RESTRICTED;                                1476
*      GPR01P = ADDR(RACLST); /*ADDR OF RACINIT LIST*/             1477
         LA    GPR01P,RACLST                                       1477
*      IF CVTRAC^=0 & RCVTRNA='0'B THEN/*RACF ACTIVE*/             1478
         L     @14,CVTPTR                                          1478
         L     @14,CVTRAC(,@14)                                    1478
         LTR   @14,@14                                             1478
         BZ    @RF01478                                            1478
         TM    RCVTRNA(@14),B'10000000'                            1478
         BNZ   @RF01478                                            1478
*      SVC (131); /*ISSUE RACINIT SVC*/                            1479
         SVC   131                                                 1479
*      ELSE/*RACF NOT ACTIVE*/                                     1480
*      DO;                                                         1480
         B     @RC01478                                            1480
@RF01478 DS    0H                                                  1481
*      RFY GPR15P RSTD;                                            1481
*      GPR15P=32;/*SET RACF NOT ACTIVE RET CODE*/                  1482
         LA    GPR15P,32                                           1482
*      RFY GPR15P UNRSTD;                                          1483
*      END;                                                        1484
*      RESPECIFY GPR01P UNRESTRICTED;                              1485
@RC01478 DS    0H                                                  1486
*      END; /* RACINIT  MF(E,RACLST,COMPLETE) ENVIR(DELETE)*/      1486
*                                                                  1486
*    RETCODE = GPR15P;               /* SAVE RETURN CODE             */
         ST    GPR15P,RETCODE                                      1487
*    RFY (GPR15P) UNRSTD;                                          1488
*                                                                  1488
*    IF RETCODE ^= ZERO              /* IF RETURN CODE WAS BAD       */
*      THEN DO;                      /* SEE YA 'ROUND CHARLIE        */
         L     @08,RETCODE                                         1489
         LTR   @08,@08                                             1489
         BZ    @RF01489                                            1489
*        PMSGNM = MSG56416;          /* RACINIT ERROR, SET INSERTS   */
         MVC   PMSGNM(2),@CH00921                                  1491
*        TEXTINT1(3) = ADDR(INSLOGON);/* LOGON TERMINATE             */
         LA    @08,INSLOGON                                        1492
         ST    @08,TEXTINT1+8                                      1492
*        TEXTINT1(1) = ADDR(INSRINIT);/* RACINIT ERROR               */
         LA    @08,INSRINIT                                        1493
         ST    @08,TEXTINT1                                        1493
*        TEXTINT1(2) = ADDR(TEXTSEGS(1));/* ERROR RETURN CODE        */
         LA    @08,TEXTSEGS                                        1494
         ST    @08,TEXTINT1+4                                      1494
*        CALL BLDNUMB(RETCODE,TEXTSEGS(1));/*CONVERT RET CODE        */
*                                                                  1495
         LA    @08,RETCODE                                         1495
         ST    @08,@AL00001                                        1495
         LA    @08,TEXTSEGS                                        1495
         ST    @08,@AL00001+4                                      1495
         LA    @01,@AL00001                                        1495
         BAL   @14,BLDNUMB                                         1495
*        CALL LGM;                   /* SEND ERROR MESSAGE           */
*                                                                  1496
         BAL   @14,LGM                                             1496
*        CALL CLEANUP4;              /* EXIT STAGE RIGHT             */
         BAL   @14,CLEANUP4                                        1497
*        END;                                                      1498
*    END;                                                          1499
*                                                                  1499
*                                                                  1499
*END RACFDEL;                                                      1500
@EL00021 DS    0H                                                  1500
@EF00021 DS    0H                                                  1500
@ER00021 LM    @14,@12,@SA00021                                    1500
         BR    @14                                                 1500
*/********************************************************************/
*/*                                                                  */
*/*SEGMENT-                                                          */
*/*          FDOLDTSB                                                */
*/*                                                                  */
*/*FUNCTION-                                                         */
*/*          THIS SEGMENT CALLS TSBSRCH TO SEARCH OLD TSBS FOR       */
*/*          RECONNECT                                               */
*/*                                                                  */
*/*      @G32OPKU-                                                   */
*/*          NEW SEGMENT ADDED FOR RACF VERSION 2 SUPPORT            */
*/*                                                                  */
*/********************************************************************/
*FDOLDTSB:                                                         1501
*        PROCEDURE;                                                1501
*                                                                  1501
*                                                                  1501
FDOLDTSB STM   @14,@12,@SA00022                                    1501
*RETCODE = RPSWDBAD;                 /* INIT FOR LOOP                */
         MVC   RETCODE(4),@CF00098                                 1502
*RECONUSR = LWPUSER;                 /* USERID FOR RECONNECT         */
         MVI   RECONUSR+7,C' '                                     1503
         L     @08,LWPPTR                                          1503
         MVC   RECONUSR(7),LWPUSER(@08)                            1503
*IF LWPPSWDL = 0                     /* IF NO PASSWORD               */
*  THEN                                                            1504
         LH    @08,LWPPSWDL(,@08)                                  1504
         LTR   @08,@08                                             1504
         BNZ   @RF01504                                            1504
*    RECONPSW = '';                  /* BLANK FIELD                  */
         MVI   RECONPSW,C' '                                       1505
         MVC   RECONPSW+1(7),RECONPSW                              1505
*  ELSE                                                            1506
*    RECONPSW = LWPPSWD;             /* FILL IN PASSWORD             */
         B     @RC01504                                            1506
@RF01504 L     @08,LWPPTR                                          1506
         MVC   RECONPSW(8),LWPPSWD(@08)                            1506
*DO WHILE RETCODE = RPSWDBAD;        /* TRY FOR MATCHING PASSWORD    */
@RC01504 B     @DE01507                                            1507
@DL01507 DS    0H                                                  1508
*  RECUSRID = ADDR(RECONUSR);        /* PTR TO USERID                */
         LA    @08,RECONUSR                                        1508
         ST    @08,RECUSRID                                        1508
*  RECPSWD = ADDR(RECONPSW);         /* PTR TO PASSWORD              */
         LA    @08,RECONPSW                                        1509
         ST    @08,RECPSWD                                         1509
*  ROLDTSB = ''B;                    /* ZERO RETURN FIELD            */
         SLR   @08,@08                                             1510
         ST    @08,ROLDTSB                                         1510
*  RFY (PARMPTR,RTNREG) RSTD;                                      1511
*                                                                  1511
*  PARMPTR = ADDR(XSFPARM);          /* SET UP PARM LIST             */
         LA    PARMPTR,XSFPARM                                     1512
*  CALL TSBSRCH;                                                   1513
         BAL   @14,TSBSRCH                                         1513
*  RETCODE = RTNREG;                 /* SAVE RETURN CODE             */
         ST    RTNREG,RETCODE                                      1514
*  RFY (PARMPTR,RTNREG) UNRSTD;                                    1515
*  IF RETCODE = ZERO                 /* SUCCESSFUL                   */
*    THEN DO;                                                      1516
         L     @08,RETCODE                                         1516
         LTR   @08,@08                                             1516
         BNZ   @RF01516                                            1516
*      CALL SETLOCK;                 /* GET CMS LOCK FOR TSB         */
         BAL   @14,SETLOCK                                         1518
*      LWPGRP = ROLDTSB->TSBSF1;     /* GET OLD MEMORY GROUP NAME    */
         L     @08,LWPPTR                                          1519
         L     @01,ROLDTSB                                         1519
         MVC   LWPGRP(8,@08),TSBSF1(@01)                           1519
*      CALL RELLOCK;                 /* RELEASE LOCAL/CMS LOCKS      */
*                                                                  1520
         BAL   @14,RELLOCK                                         1520
*      LWPGRPL = LENGTH(LWPGRP);     /* PRIME FOR LEN=8 CASE @ZM44318*/
         LA    @08,8                                               1521
         L     @01,LWPPTR                                          1521
         STH   @08,LWPGRPL(,@01)                                   1521
*      DO I = LENGTH(LWPGRP) TO 1 BY -1 /* FIND LEN OF GROUP NAME    */
*        WHILE LWPGRP(I) = ' ';      /*                      @ZM44318*/
         LR    I,@08                                               1522
@DL01522 L     @08,LWPPTR                                          1522
         LR    @03,@08                                             1522
         ALR   @03,I                                               1522
         CLI   LWPGRP-1(@03),C' '                                  1522
         BNE   @DC01522                                            1522
*        LWPGRPL = I - 1;            /* SET LENGTH OF GROUP          */
         LR    @03,I                                               1523
         BCTR  @03,0                                               1523
         STH   @03,LWPGRPL(,@08)                                   1523
*        END;                                                      1524
         BCTR  I,0                                                 1524
         LTR   I,I                                                 1524
         BP    @DL01522                                            1524
@DC01522 DS    0H                                                  1525
*      LWPGRPM = I+4;                /* SET GROUP LEN PLUS 4 @ZM44318*/
         LA    @08,4                                               1525
         ALR   @08,I                                               1525
         L     @03,LWPPTR                                          1525
         STH   @08,LWPGRPM(,@03)                                   1525
*    END;                                                          1526
*                                                                  1526
*    ELSE                                                          1527
*      IF RETCODE = RPSWDBAD         /* PASSWORD DID NOT MATCH       */
*        THEN DO;                                                  1527
         B     @RC01516                                            1527
@RF01516 CLC   RETCODE(4),@CF00098                                 1527
         BNE   @RF01527                                            1527
*          IF RECONPSW = ' '         /* IF NO PASSWORD               */
*            THEN                    /* PUT OUT MSG                  */
         CLI   RECONPSW,C' '                                       1529
         BNE   @RF01529                                            1529
*              PMSGNM = 40;          /* PASSWORD REQUIRED            */
         MVC   PMSGNM(2),@CH00499                                  1530
*            ELSE                    /* IF PASSWORD INVALID          */
*              PMSGNM = 39;          /* ISSUE PASSWORD INVALID MSG   */
         B     @RC01529                                            1531
@RF01529 MVC   PMSGNM(2),@CH03174                                  1531
*          PRMTSWC = 2;              /* PROMPT FOR PASSWORD          */
*                                                                  1532
@RC01529 MVC   PRMTSWC(2),@CH00135                                 1532
*          CALL PROMPT;              /* PROMPT USER                  */
*                                                                  1533
         BAL   @14,PROMPT                                          1533
*          RECONPSW = LWPPSWD;       /* SET IN NEW PASSWORD          */
         L     @08,LWPPTR                                          1534
         MVC   RECONPSW(8),LWPPSWD(@08)                            1534
*          END;                                                    1535
*                                                                  1535
*        ELSE                                                      1536
*          IF RETCODE = RUIDNOT     /* IF USERID NOT FOUND          */
*             RETCODE = RUIDUSED     /* OR ALREADY IN USE            */
*            THEN DO;                                              1536
         B     @RC01527                                            1536
@RF01527 L     @08,RETCODE                                         1536
         C     @08,@CF00046                                        1536
         BE    @RT01536                                            1536
         C     @08,@CF00034                                        1536
         BNE   @RF01536                                            1536
@RT01536 DS    0H                                                  1537
*              IF RETCODE = RUIDNOT  /* IF USERID NOT FOUND          */
*                THEN                                              1538
         CLC   RETCODE(4),@CF00046                                 1538
         BNE   @RF01538                                            1538
*                  PMSGNM = 42;      /* USERID NOT FOUND MSG         */
         MVC   PMSGNM(2),@CH03175                                  1539
*                ELSE                                              1540
*                  PMSGNM = 43;      /* USERID IN USE MSG            */
         B     @RC01538                                            1540
@RF01538 MVC   PMSGNM(2),@CH03176                                  1540
*              TEXTINT1(1) = ADDR(LWPUSERI);/* MOVE IN USERID        */
@RC01538 L     @08,LWPPTR                                          1541
         LA    @08,LWPUSERI(,@08)                                  1541
         ST    @08,TEXTINT1                                        1541
*              CALL LGM;             /* GO TELL USER                 */
         BAL   @14,LGM                                             1542
*              NOPRMPT = YES;        /* TELL LOGON TO START AGAIN    */
         OI    NOPRMPT,B'00100000'                                 1543
*              GOTO CLEANUP4;        /* PACK IT IN JETHROW           */
         B     CLEANUP4                                            1544
*              END;                                                1545
*                                                                  1545
*            ELSE DO;                /* SET UP ERROR MESSAGE         */
@RF01536 DS    0H                                                  1547
*              RFY (RTNREG) RSTD;                                  1547
*              RTNREG = RETCODE;     /* SETUP FOR CVD INST           */
         L     RTNREG,RETCODE                                      1548
*              GEN REFS(RTNREG,PACKDEC);/* PREPARE RTN CODE FOR MSG  */
         CVD   RTNREG,PACKDEC               CONVERT TO DECIMAL
         UNPK  ZONEDEC(8),PACKDEC(8)        UNPACK
         OI    ZONEDEC+7,X'F0'              CHANGE SIGN
*              RFY (RTNREG) UNRSTD;                                1550
*                                                                  1550
*              STATUS = CONTINUE;    /* OK TO GO ON                  */
*                                                                  1551
         SLR   @08,@08                                             1551
         ST    @08,STATUS                                          1551
*              PMSGNM=20;            /*SET MSG NUMBER TO             */
         MVC   PMSGNM(2),@CH00340                                  1552
*                                    /*SERVICE RTN ERROR             */
*              TEXTINT1(1)=ADDR(TEXTSEGS(1)); /*GET ADDR OF ERROR    */
         LA    @15,TEXTSEGS                                        1553
         ST    @15,TEXTINT1                                        1553
*                                    /*ROUTINE SEGMENT               */
*              TEXTSLEN(1)=8;        /*SET LEN OF TEXT               */
         MVC   TEXTSLEN(2),@CH00046                                1554
*              TEXTSOST(1)=0;        /*SET OFFSET OF TEXT            */
         STH   @08,TEXTSOST                                        1555
*              TEXTSTXT(1,1:7)='IKJEFLE';/*ERR MOD NAME              */
*                                                                  1556
         MVC   TEXTSTXT(7),@CC03209                                1556
*              TEXTINT1(2)=ADDR(TEXTSEGS(2)); /*GET ADDR OF ERROR    */
         LA    @15,TEXTSEGS+24                                     1557
         ST    @15,TEXTINT1+4                                      1557
*                                    /*RETURN CODE SEGMENT           */
*              TEXTSLEN(2)=7;        /*SET LEN OF TEXT               */
         MVC   TEXTSLEN+24(2),@CH00133                             1558
*              TEXTSOST(2)=0;        /*SET OFFSET OF TEXT            */
         STH   @08,TEXTSOST+24                                     1559
*              TEXTSTXT(2,1:3)=ZONEDEC(6:8); /*PUT IN RETURN CODE    */
*                                                                  1560
         MVC   TEXTSTXT+24(3),ZONEDEC+5                            1560
*              IF LWPUSERL ^=0       /*IF USERID IS KNOWN,           */
*                THEN                /* THEN POINT TO USERID SEG     */
         L     @15,LWPPTR                                          1561
         CH    @08,LWPUSERL(,@15)                                  1561
         BE    @RF01561                                            1561
*                  TEXTINT1(3)=ADDR(LWPUSERI);                     1562
         LA    @08,LWPUSERI(,@15)                                  1562
         ST    @08,TEXTINT1+8                                      1562
*                                    /*ELSE USERID IS UNKNOWN        */
*                  ELSE TEXTINT1(3)=0;                             1563
*                                                                  1563
         B     @RC01561                                            1563
@RF01561 SLR   @08,@08                                             1563
         ST    @08,TEXTINT1+8                                      1563
*              IF LWPPROCL ^=0       /*IF PROCNAME IS KNOWN          */
*                THEN                /*THEN POINT TO PROC SGMENT     */
@RC01561 L     @08,LWPPTR                                          1564
         LH    @15,LWPPROCL(,@08)                                  1564
         LTR   @15,@15                                             1564
         BZ    @RF01564                                            1564
*                  TEXTINT1(4)=ADDR(LWPPROCI);                     1565
         LA    @08,LWPPROCI(,@08)                                  1565
         ST    @08,TEXTINT1+12                                     1565
*                                    /*ELSE PROC IS UNKNOWN          */
*                ELSE TEXTINT1(4)=0;                               1566
         B     @RC01564                                            1566
@RF01564 SLR   @08,@08                                             1566
         ST    @08,TEXTINT1+12                                     1566
*              CALL LGM;             /*PUT OUT ERROR MESSAGE         */
@RC01564 BAL   @14,LGM                                             1567
*              GO TO CLEANUP4;       /*AND CLOSE OUT LOGON           */
         B     CLEANUP4                                            1568
*            END;                                                  1569
*END;                                                              1570
@RC01527 DS    0H                                                  1570
@RC01516 DS    0H                                                  1570
@DE01507 CLC   RETCODE(4),@CF00098                                 1570
         BE    @DL01507                                            1570
*TSBSRCH:                                                          1571
*   PROC OPTIONS(NOSAVE(15));                                      1571
         B     @PB00023                                            1571
TSBSRCH  ST    @14,@SA00023                                        1571
         STM   @00,@12,@SA00023+4                                  1571
*   /*****************************************************************/
*   /*                                                               */
*   /* REGISTER DECLARES                                             */
*   /*                                                               */
*   /*****************************************************************/
*   DCL                                                            1572
*     RPTPTR REG(5);                /* HOLDS ADDRESS OF TIOCRPT      */
*   /*****************************************************************/
*   /*                                                               */
*   /* TEMPORARY AND AUTOMATIC VARIABLES                             */
*   /*                                                               */
*   /*****************************************************************/
*   DCL                                                            1573
*    (NEWTSB,                       /* USED TO HOLD THE ADDRESS OF 1573
*                                      THE NEW TSB                   */
*     TSBPTR2,                      /* USED TO HOLD @ OF CURRENT VTAM
*                                      TSB                           */
*     LASTTSB,                      /* USED TO HOLD ADDRESS OF LAST
*                                      TCAM TSB                      */
*     EXTNTPTR) PTR(31);            /* HOLDS ADDRESS OF TSB EXTENT   */
*   DCL                                                            1574
*    (SIZETSB,                      /* HOLDS THE TSB SIZE            */
*     RETRNCD)                      /* HOLDS THE RETURN CODE         */
*         FIXED(31);                                               1574
*   /*****************************************************************/
*   /*                                                               */
*   /* THE TIOCRPT DOES NOT HAVE PLS VERSION. THE MACRO IS INVOKED   */
*   /* HERE                                                          */
*   /*                                                               */
*   /*****************************************************************/
*   GEN DATA DEFS(TIOCRPT,TIOCNTSB,TIOCTSBS,TIOCTSB);              1575
*   DCL                                                            1576
*     TIOCRPT GEND,                 /* TIOC REFERENCE POINTER TABLE  */
*     TIOCNTSB GEND FIXED(15),      /* THE NUMBER OF TSBS            */
*     TIOCTSBS GEND FIXED(8),       /* THE TSB SIZE                  */
*     TIOCTSB GEND PTR(24);         /* PTR TO FIRST TIOC TSB         */
*   NEWTSB=ASCBTSB;                                                1577
         L     @08,LWAPTR                                          1577
         L     @08,LWAPASCB(,@08)                                  1577
         L     NEWTSB,ASCBTSB(,@08)                                1577
*   RETRNCD = 8;                    /* PRIME THE PUMP FOR LOOPS      */
         LA    RETRNCD,8                                           1578
*   CALL SETLOCK;                   /* OBTAIN LOCAL/CMS LOCK         */
         BAL   @14,SETLOCK                                         1579
*   IF NEWTSB -> TSBVTAM = '0'B THEN/* IF NOT VTAM CHECK TCAM TSBS   */
         TM    TSBVTAM(NEWTSB),B'00000001'                         1580
         BNZ   @RF01580                                            1580
*     DO;                                                          1581
*       RFY                                                        1582
*         ASCB BASED(TSBASCBA);                                    1582
*       RFY                                                        1583
*         CHAIN BASED(ASCBCSCB);    /* LOOK AT THE CURRENT CHCB      */
*       RFY                                                        1584
*         RPTPTR RSTD;                                             1584
*       RPTPTR=TCXRPT;              /* ADDRESS OF TIOCRPT            */
         L     @08,CVTPTR                                          1585
         L     @08,TCXPTR(,@08)                                    1585
         L     RPTPTR,TCXRPT(,@08)                                 1585
*       GEN(USING TIOCRPT,RPTPTR);                                 1586
         USING TIOCRPT,RPTPTR
*       TSBPTR=TIOCTSB;             /* START OF TCAM TSBS            */
         L     @08,TIOCTSB-1                                       1587
         LA    @08,0(,@08)                                         1587
         ST    @08,TSBPTR                                          1587
*       SIZETSB=TIOCTSBS;           /* SIZE OF A TSB                 */
         SLR   SIZETSB,SIZETSB                                     1588
         IC    SIZETSB,TIOCTSBS                                    1588
*       LASTTSB=TSBPTR+(SIZETSB*(TIOCNTSB-1));/* CALCULATE THE END OF
*                                      THE TCAM TSBS                 */
         LH    @01,TIOCNTSB                                        1589
         BCTR  @01,0                                               1589
         MR    @00,SIZETSB                                         1589
         ALR   @08,@01                                             1589
         LR    LASTTSB,@08                                         1589
*       RFY                                                        1590
*         RPTPTR UNRSTD;            /* TIOCRPT @ NO LONGER NEEDED    */
*       GEN(DROP RPTPTR);                                          1591
         DROP RPTPTR
*       DO UNTIL(TSBPTR>LASTTSBRETRNCD^=8);                       1592
@DL01592 DS    0H                                                  1593
*         IF(TSBPTR^=NEWTSB&TSBASCBA^=0) THEN /* IF THIS ISN'T THE NEW
*                                      TSB AND ASCB @ IS VALID       */
         L     @08,TSBPTR                                          1593
         CR    @08,NEWTSB                                          1593
         BE    @RF01593                                            1593
         L     @07,TSBASCBA(,@08)                                  1593
         LTR   @07,@07                                             1593
         BZ    @RF01593                                            1593
*           IF RECONUSR=CHKEY THEN  /* IF USERID'S MATCH             */
         L     @07,ASCBCSCB(,@07)                                  1594
         CLC   RECONUSR(8),CHKEY(@07)                              1594
         BNE   @RF01594                                            1594
*             IF TSBHUNG='0'B THEN  /* IF THIS IS OLD TSB            */
         TM    TSBHUNG(@08),B'00010000'                            1595
         BNZ   @RF01595                                            1595
*               RETRNCD=12;                                        1596
         LA    RETRNCD,12                                          1596
*             ELSE                                                 1597
*               IF RECONPSW=TSBPSWD THEN/* IF PASSWORDS MATCH        */
         B     @RC01595                                            1597
@RF01595 L     @08,TSBPTR                                          1597
         CLC   RECONPSW(8),TSBPSWD(@08)                            1597
         BNE   @RF01597                                            1597
*                 DO;                                              1598
*                   RETRNCD=0;      /* SUCCESSFUL RETURN CODE        */
         SLR   RETRNCD,RETRNCD                                     1599
*                   ROLDTSB=TSBPTR;                                1600
         ST    @08,ROLDTSB                                         1600
*                 END;                                             1601
*               ELSE                                               1602
*                 RETRNCD=4;        /* PASSWORDS DON'T MATCH         */
         B     @RC01597                                            1602
@RF01597 LA    RETRNCD,4                                           1602
*         TSBPTR=TSBPTR+SIZETSB;    /* POINT TO NEXT TCAM TSB        */
@RC01597 DS    0H                                                  1603
@RC01595 DS    0H                                                  1603
@RF01594 DS    0H                                                  1603
@RF01593 LR    @08,SIZETSB                                         1603
         AL    @08,TSBPTR                                          1603
         ST    @08,TSBPTR                                          1603
*       END;                                                       1604
@DE01592 C     LASTTSB,TSBPTR                                      1604
         BL    @DC01592                                            1604
         C     RETRNCD,@CF00046                                    1604
         BE    @DL01592                                            1604
@DC01592 DS    0H                                                  1605
*       TSBPTR=NEWTSB;              /* RESTORE TSBPTR        @ZM44986*/
         ST    NEWTSB,TSBPTR                                       1605
*     END;                                                         1606
*   ELSE                            /* IF THIS IS A VTAM TSB         */
*     DO;                                                          1607
         B     @RC01580                                            1607
@RF01580 DS    0H                                                  1608
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK VTAM TSBS                                           */
*       /*                                                           */
*       /*************************************************************/
*       RFY                                                        1608
*         TSB BASED(TSBPTR2);                                      1608
*       TSBPTR2=TCASTSB;            /* PTR TO START OF VTAM TSBS     */
         L     @08,CVTPTR                                          1609
         L     @08,TCASTPTR(,@08)                                  1609
         L     TSBPTR2,TCASTSB(,@08)                               1609
*       DO UNTIL(TSBPTR2=0RETRNCD^=8);                            1610
@DL01610 DS    0H                                                  1611
*         EXTNTPTR=TSBEXTNT;        /* GET ADDRESS OF TSB EXTENT     */
         L     EXTNTPTR,TSBEXTNT(,TSBPTR2)                         1611
*         RFY                                                      1612
*           TSBX BASED(EXTNTPTR);                                  1612
*         IF TSBPTR2^=NEWTSB THEN   /* IF THIS ISN'T THE NEW TSB     */
         CR    TSBPTR2,NEWTSB                                      1613
         BE    @RF01613                                            1613
*           IF RECONUSR=TSBXUID THEN/* IF USER ID'S MATCH            */
         CLC   RECONUSR(8),TSBXUID(EXTNTPTR)                       1614
         BNE   @RF01614                                            1614
*             IF TSBXWREC='0'B THEN /* IF USER IS STILL RUNNING      */
         TM    TSBXWREC(EXTNTPTR),B'00010000'                      1615
         BNZ   @RF01615                                            1615
*               RETRNCD=12;         /* USER ALREADY LOGGED ON        */
         LA    RETRNCD,12                                          1616
*             ELSE                                                 1617
*               IF RECONPSW=TSBPSWD THEN/* PASSWORD'S MATCH          */
         B     @RC01615                                            1617
@RF01615 CLC   RECONPSW(8),TSBPSWD(TSBPTR2)                        1617
         BNE   @RF01617                                            1617
*                 DO;                                              1618
*                   RETRNCD=0;      /* SUCCESSFUL                    */
         SLR   RETRNCD,RETRNCD                                     1619
*                   ROLDTSB=TSBPTR2;/* RETURN TSB ADDRESS            */
         ST    TSBPTR2,ROLDTSB                                     1620
*                 END;                                             1621
*               ELSE                                               1622
*                 RETRNCD=4;        /* PASSWORDS DON'T MATCH         */
         B     @RC01617                                            1622
@RF01617 LA    RETRNCD,4                                           1622
*         TSBPTR2=TSBXFWD;          /* ADDRESS OF NEXT VTAM TSB      */
@RC01617 DS    0H                                                  1623
@RC01615 DS    0H                                                  1623
@RF01614 DS    0H                                                  1623
@RF01613 L     TSBPTR2,TSBXFWD(,EXTNTPTR)                          1623
*       END;                                                       1624
@DE01610 LTR   TSBPTR2,TSBPTR2                                     1624
         BZ    @DC01610                                            1624
         C     RETRNCD,@CF00046                                    1624
         BE    @DL01610                                            1624
@DC01610 DS    0H                                                  1625
*     END;                                                         1625
*   CALL RELLOCK;                   /* RELEASE LOCAL/CMS LOCKS       */
@RC01580 BAL   @14,RELLOCK                                         1626
*   RETURN CODE(RETRNCD);           /* PUT RC IN REG 15              */
         LR    @15,RETRNCD                                         1627
@EL00023 DS    0H                                                  1627
@EF00023 DS    0H                                                  1627
@ER00023 L     @14,@SA00023                                        1627
         LM    @00,@12,@SA00023+4                                  1627
         BR    @14                                                 1627
*   END TSBSRCH;                                                   1628
*                                                                  1628
*                                                                  1628
*END FDOLDTSB;                                                     1629
@EL00022 DS    0H                                                  1629
@EF00022 DS    0H                                                  1629
@ER00022 LM    @14,@12,@SA00022                                    1629
         BR    @14                                                 1629
@PB00022 DS    0H                                                  1630
*/********************************************************************/
*/*                                                                  */
*/*DECLARE-                                                          */
*/*          PATCH AREA                                              */
*/*                                                                  */
*/********************************************************************/
*   DCL PATCHLOC FIXED(31) STATIC;                                 1630
*  GEN DATA DEFS(PATCHLOC);                                        1631
*/********************************************************************/
*/*                                                                  */
*/*DECLARE-                                                          */
*/*          EPILOG                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1632
*                                                                  1632
*  DECLARE /*GENERAL PURPOSE REGISTERS */                          1632
*    GPR01F FIXED(31) REG(1),                                      1632
*    GPR01P PTR(31) REG(1),                                        1632
*    GPR15P PTR(31) REG(15);                                       1632
*  DCL 1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),  /*LIST FOR ENQ*/  1633
*    3 I05600 PTR(31),  /*TCB ADDR IF BOTH TCB AND ECB*/           1633
*    3 I05601 PTR(31),  /*TCB OR ECB ADDRESS*/                     1633
*    3 I05602 (*) CHAR(12) BDY(WORD),  /*ARRAY OF RESOURCE ELEMENTS*/
*      5 I05603 BIT(8),  /*BIT FLAGS 1*/                           1633
*      5 I05604 PTR(8),  /*MINOR RESOURCE NAME LENGTH*/            1633
*      5 I05605 BIT(8),  /*BIT FLAGS 2*/                           1633
*      5 I05655 CHAR(1),  /*CONTROL PGM USE*/                      1633
*      5 I05606 PTR(31),  /*MAJOR RESOURCE NAME ADDR*/             1633
*      5 I05607 PTR(31);  /*MINOR RESOURCE NAME ADDR*/             1633
*  DCL 1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                    1634
*     3 I04801 PTR(31) , /* TCB ADDR */                            1634
*     3 I04802(*) CHAR(12) BDY(WORD),                              1634
*        5 I04803 PTR(31), /* UCB @ IN LAST ENTRY */               1634
*           7 I04804 BIT(8),   /* FLAGS */                         1634
*           7 I04805 PTR(8),   /*MINOR RESOURCE NAME LENGTH*/      1634
*           7 I04806 BIT(8),   /* FLAGS */                         1634
*           7 *      CHAR(1),  /* CONTROL PROGRAM USE */           1634
*        5 I04807 PTR(31),  /* MAJOR RESOURCE NAME @ */            1634
*        5 I04808 PTR(31); /* MINOR RESOURCE NAME @ */             1634
*                                                                  1634
*  DECLARE ILIST CHAR(20) BDY(DWORD); /*STANDARD LIST*/            1635
*                                                                  1635
*  DECLARE /* COMMON VARIABLES */                                  1636
*    I256C CHAR(256) BASED,                                        1636
*    I031F FIXED(31) BASED,                                        1636
*    I031P PTR(31)   BASED,                                        1636
*    I015F FIXED(15) BASED,                                        1636
*    I015P PTR(15)   BASED,                                        1636
*    I008P PTR(8)    BASED,                                        1636
*    I001C CHAR(1)   BASED;                                        1636
*END IKJEFLE                                                       1637
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (TTCXD   )                                        *
*/*%INCLUDE SYSLIB  (IKTTCAST)                                        *
*/*%INCLUDE SYSLIB  (ICHPRCVT)                                        *
*/*%INCLUDE SYSLIB  (IHAACEE )                                        *
*/*%INCLUDE SYSLIB  (IKJEFLWP)                                        *
*/*%INCLUDE SYSLIB  (IKJTSB  )                                        *
*/*%INCLUDE SYSLIB  (IKTTSBX )                                        *
*/*%INCLUDE SYSLIB  (IEFJCLS )                                        *
*/*%INCLUDE SYSLIB  (IKJEFLWA)                                        *
*/*%INCLUDE SYSLIB  (IKJEFLP0)                                        *
*/*%INCLUDE SYSLIB  (IKJECT  )                                        *
*/*%INCLUDE SYSLIB  (IEFVJSEL)                                        *
*/*%INCLUDE SYSLIB  (IEECHAIN)                                        *
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*/*%INCLUDE SYSLIB  (IHAASCB )                                        *
*/*%INCLUDE SYSLIB  (IHAASXB )                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        *
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        *
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        *
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        *
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                        *
*/*%INCLUDE SYSLIB  (IEFJESCT)                                        *
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                        *
*;                                                                 1637
         B     @EL00001                                            1637
@DATA    DS    0H
@CH00087 DC    H'3'
@CH00209 DC    H'5'
@CH00178 DC    H'6'
@CH00133 DC    H'7'
@CH00036 DC    H'9'
@CH00035 DC    H'10'
@CH00033 DC    H'11'
@CH00601 DC    H'13'
@CH02961 DC    H'14'
@CH00053 DC    H'15'
@CH00090 DC    H'18'
@CH00483 DC    H'23'
@CH03025 DC    H'27'
@CH03117 DC    H'33'
@CH03168 DC    H'38'
@CH03174 DC    H'39'
@CH03175 DC    H'42'
@CH03176 DC    H'43'
@CH03017 DC    H'45'
@CH03019 DC    H'46'
@CH02959 DC    H'49'
@CH00928 DC    H'51'
@CH00919 DC    H'52'
@CH00921 DC    H'53'
@CH00923 DC    H'54'
@CH00925 DC    H'55'
@CH00786 DC    H'56'
@CH00931 DC    H'57'
@CH00933 DC    H'58'
@CH00935 DC    H'59'
@CH00937 DC    H'60'
@CH00939 DC    H'61'
@CH00941 DC    H'62'
@CH00385 DC    H'63'
@CH00944 DC    H'64'
@CH00948 DC    H'66'
@CH00950 DC    H'67'
@CH00952 DC    H'68'
@CH00954 DC    H'69'
@CH00956 DC    H'70'
@CH02964 DC    H'32767'
@SX03252 XC    UPT(0,@01),UPT(@01)
@SC03258 CLC   LWPACCT(0,@01),UADSANUM(@08)
@SM03260 MVC   LWPACCT(0,@08),UADSANUM(@15)
@SM03270 MVC   BLDTEXT(0,@08),@TS00001
@SM03272 MVC   LWARNM(0,@08),LWPUSER(@15)
@SM03274 MVC   ROIDDATA(0),CMNDBUFR(@04)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    5F
@SA00008 DS    15F
@SA00002 DS    15F
@SA00016 DS    18F
@SA00019 DS    15F
@SA00011 DS    15F
@SA00017 DS    15F
@SA00018 DS    15F
@SA00013 DS    15F
@SA00012 DS    15F
@SA00015 DS    15F
@SA00014 DS    15F
@PC00014 DS    2F
@SA00022 DS    15F
@SA00020 DS    15F
@SA00021 DS    15F
@SA00023 DS    14F
@AL00001 DS    2A
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJEFLE  CSECT
         DS    0F
@CF00037 DC    F'1'
@CH00037 EQU   @CF00037+2
@CF00135 DC    F'2'
@CH00135 EQU   @CF00135+2
@CF00098 DC    F'4'
@CH00098 EQU   @CF00098+2
@CF00046 DC    F'8'
@CH00046 EQU   @CF00046+2
@CF00034 DC    F'12'
@CH00034 EQU   @CF00034+2
@CF00145 DC    F'16'
@CH00145 EQU   @CF00145+2
@CF00340 DC    F'20'
@CH00340 EQU   @CF00340+2
@CF00080 DC    F'24'
@CH00080 EQU   @CF00080+2
@CF00490 DC    F'28'
@CF00357 DC    F'32'
@CF00497 DC    F'36'
@CH00497 EQU   @CF00497+2
@CF00499 DC    F'40'
@CH00499 EQU   @CF00499+2
@CF00175 DC    F'44'
@CH00175 EQU   @CF00175+2
@CF00502 DC    F'48'
@CF03266 DC    F'16777215'
@CF03257 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
LWAPTR   DS    A
LWPPTR   DS    A
OIDVERRC DS    F
STATUS   DS    A
RETCODE  DS    A
TSBPTR   DS    A
SAVEPERP DS    A
OPTMZRPM DS    FL4
         ORG   OPTMZRPM
@NM00033 DS    AL2
OPTMZCD  DS    AL1
OPTMZPF  DS    AL1
         ORG   OPTMZRPM+4
UADSACCT DS    A
READBUF  DS    A
OIDPTR   DS    F
INBUF    DS    A
MAXCORE  DS    H
OIDLEN   DS    FL2
         ORG   OIDLEN
@NM00037 DS    AL1
CDLEN    DS    AL1
         ORG   OIDLEN+2
@TS00001 DS    CL16
SWCS     DS    BL1
         ORG   SWCS
IOSWC    DS    BL1
MSGSWC   EQU   SWCS+0
NOPRMPT  EQU   SWCS+0
NOPERFRM EQU   SWCS+0
EXPUADS  EQU   SWCS+0
CHKGROUP EQU   SWCS+0
DUMMYRAC EQU   SWCS+0
BADVERFY EQU   SWCS+0
         ORG   SWCS+1
         DS    CL3
INTTEXT  DS    CL16
         ORG   INTTEXT
TEXTINT1 DS    4A
         ORG   INTTEXT+16
INTTEXT2 DS    CL16
         ORG   INTTEXT2
TEXTINT2 DS    4A
         ORG   INTTEXT2+16
TEXTSEG2 DS    CL22
         ORG   TEXTSEG2
TEXTSLN2 DS    FL2
TEXTOFF2 DS    FL2
TEXTXT2  DS    CL18
         ORG   TEXTSEG2+22
         DS    CL2
PARMLST  DS    CL16
         ORG   PARMLST
PTRLWA   DS    AL4
PTRBUF   DS    AL4
PTRIOLST DS    AL4
FUNCPTR  DS    AL4
         ORG   PARMLST+16
@NM00032 DS    CL13
         ORG   @NM00032
PRMTSWC  DS    FL2
PMSGNM   DS    FL2
PTYPE    DS    FL2
         DS    CL2
PTRYS    DS    FL4
MODE     DS    CL1
         ORG   @NM00032+13
         DS    CL3
CONVERT  DS    CL8
ZONEDEC  DS    CL8
PACKDEC  DS    CL8
UADSNODE DS    CL16
         ORG   UADSNODE
UADSNNEL DS    BL1
         ORG   UADSNNEL
UADSNFLG DS    BL1
@NM00036 EQU   UADSNNEL+0
         ORG   UADSNODE+1
UADSNNEX DS    AL3
UADSNSUB DS    AL4
UADSNDAT DS    AL4
UADSBUFR DS    AL4
         ORG   UADSNODE+16
FINDNAME DS    CL8
TIOCPARM DS    CL8
         ORG   TIOCPARM
PTRUSER  DS    AL4
PTRPSWRD DS    AL4
         ORG   TIOCPARM+8
USER     DS    CL8
PASSWORD DS    CL8
OIDPARM  DS    CL16
         ORG   OIDPARM
INOID    DS    AL4
INLENOID DS    AL4
OUTOID   DS    AL4
OUTLENID DS    AL4
         ORG   OIDPARM+16
XSFPARM  DS    CL12
         ORG   XSFPARM
RECUSRID DS    AL4
RECPSWD  DS    AL4
ROLDTSB  DS    AL4
         ORG   XSFPARM+12
RECONUSR DS    CL8
RECONPSW DS    CL8
RACOID   DS    CL256
         ORG   RACOID
ROIDLEN  DS    AL1
ROIDDATA DS    CL255
         ORG   RACOID+256
RACLST   DS    CL48
         ORG   RACLST
RACLST01 DS    AL1
RACLST02 DS    BL1
RACLST03 DS    BL1
RACLST04 DS    BL1
RACLST05 DS    AL4
RACLST06 DS    AL4
RACLST07 DS    AL4
RACLST08 DS    AL4
RACLST09 DS    AL4
RACLST10 DS    AL4
RACLST11 DS    AL4
RACLST12 DS    AL4
RACLST13 DS    AL4
RACLST14 DS    AL4
RACLST15 DS    AL4
         ORG   RACLST+48
MSGLST   DS    CL28
         ORG   MSGLST
UPTPTR2  DS    AL4
ECTPTR2  DS    AL4
ECBPTR   DS    AL4
MSGNMPTR DS    AL4
PTRINBUF DS    AL4
SEGS1PTR DS    AL4
SEGS2PTR DS    AL4
         ORG   MSGLST+28
$LWP     DS    CL188
$DUMMY   DS    CL1084
         ORG   $DUMMY
$ASCB    DS    CL208
$ASXB    DS    CL232
$CSCB    DS    CL176
$TSB     DS    CL120
$JSEL    DS    CL24
$LWA     DS    CL172
$PSCB    DS    CL72
$UPT     DS    CL24
$ECT     DS    CL56
         ORG   $DUMMY+1084
SSOB     DS    CL20
         ORG   SSOB
SSOBID   DS    CL4
SSOBLEN  DS    FL2
SSOBFUNC DS    FL2
SSOBSSIB DS    AL4
SSOBRETN DS    AL4
SSOBINDV DS    AL4
         ORG   SSOB+20
SSUS     DS    CL16
         ORG   SSUS
SSUSLEN  DS    FL2
@NM00156 DS    FL2
@NM00157 DS    FL4
SSUSUSER DS    CL8
         ORG   SSUS+16
DUMYSSIB DS    CL36
SAVBLKNM DS    CL1
         DS    CL7
ILIST    DS    CL20
TEXTSEGS DS    CL24
         ORG   TEXTSEGS+0
TEXTSLEN DS    FL2
TEXTSOST DS    FL2
TEXTSTXT DS    CL20
         ORG   TEXTSEGS+48
UADSPFGR DS    32CL1
IKJEFLE  CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@CV00270 DC    V(IKJEFLD)
@CV00271 DC    V(IKJEFLEA)
@CV00272 DC    V(IKJEFLGM)
@CV00273 DC    V(IKJEFLI)
@CV00274 DC    V(IKJEFLPA)
@CV00275 DC    V(IKJEFLP0)
@CV00276 DC    V(IKTXLOG)
@CV00277 DC    V(IKTLOGR)
         DS    0D
DUMMYECB DC    F'0'
@CC03188 DC    C'RELEASE LOCK'
@CC03183 DC    C'OBTAIN LOCK'
@CC03052 DC    C'TERMINATED'
@CC02962 DC    C'INTERFACE'
@CC03051 DC    C'SYSUADS'
@CC03177 DC    C'IKTLOGR'
@CC03209 DC    C'IKJEFLE'
@CC02957 DC    C'SSOB'
@CC02958 DC    C'SSIB'
@CC03046 DC    C'OPEN'
@CC03178 DC    C'QTIP'
@CC03049 DC    C'I/O'
@CC03059 DC    C'012'
@CC03062 DC    C'004'
@CB00466 DC    X'40202020202020202020202020202020'
@CB02921 DC    X'0000000000000000'
OPENENQ  DC    CL8'OPENUADS'
INSLOGON DS    CL9
         ORG   INSLOGON
@NM00043 DC    H'9'
@NM00044 DS    FL2
@NM00045 DC    CL5'LOGON'
         ORG   INSLOGON+9
         DS    CL1
INSGROUP DS    CL9
         ORG   INSGROUP
@NM00046 DC    H'9'
@NM00047 DC    H'0'
@NM00048 DC    CL5'GROUP'
         ORG   INSGROUP+9
         DS    CL1
INSNPSWD DS    CL17
         ORG   INSNPSWD
@NM00049 DC    H'17'
@NM00050 DC    H'0'
@NM00051 DC    CL13'/NEW-PASSWORD'
         ORG   INSNPSWD+17
         DS    CL1
INSOIDCD DS    CL11
         ORG   INSOIDCD
@NM00052 DC    H'11'
@NM00053 DC    H'0'
@NM00054 DC    CL7'OIDCARD'
         ORG   INSOIDCD+11
         DS    CL1
INSRINIT DS    CL11
         ORG   INSRINIT
@NM00055 DC    H'11'
@NM00056 DC    H'0'
@NM00057 DC    CL7'RACINIT'
         ORG   INSRINIT+11
SYSIKJUA DC    CL8'SYSIKJUA'
TMARRAY  DC    X'80'
         DC    X'40'
         DC    X'20'
         DC    X'10'
         DC    X'08'
         DC    X'04'
         DC    X'02'
         DC    X'01'
SRNAMES  DC    CL8'GETMAIN'
         DC    CL8'IKJPARS'
         DC    CL8'IKJSCAN'
         DC    CL8'IKJEFLGM'
         DC    CL8'IKJEFLEA'
@DATD    DSECT
         DS    0F
MOVEMACS EQU   *
OPENUADS OPEN  (UADSDCBD),MF=L
CLOSUADS CLOSE (UADSDCBD),MF=L
UADSDCB  DCB   DDNAME=SYSUADS,MACRF=R,DSORG=PO
READUADS READ  UADSDECB,SF,,,,'S',,MF=L
@DATD    DSECT
          IKJTIOCP
IKJEFLE  CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFLE  CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RETRNCD  EQU   @02
SIZETSB  EQU   @03
EXTNTPTR EQU   @04
LASTTSB  EQU   @04
TSBPTR2  EQU   @03
NEWTSB   EQU   @06
HOLDLEN  EQU   @05
I        EQU   @02
UADSSAVE EQU   @05
SCANINDX EQU   @02
SSIBPTR  EQU   @02
THEBYTE  EQU   @03
THEBIT   EQU   @02
SAVEBK   EQU   @04
LOCKRC   EQU   @02
PARMPTR  EQU   @01
GTMNPTR  EQU   @01
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
REGION   EQU   @08
PRFRMGP  EQU   @08
SUBSYSRC EQU   @08
JCLSPTR  EQU   @04
WECBPTR  EQU   @04
LENSTR   EQU   @04
ADRSTR   EQU   @05
LENBUF   EQU   @05
BITPOS   EQU   @05
BYTEPOS  EQU   @07
SVRTN    EQU   @07
R14      EQU   @14
RTNREG   EQU   @15
REASONCD EQU   @00
GPR01P   EQU   @01
GPR15P   EQU   @15
GPR01F   EQU   @01
NEXTADDR EQU   @03
DCBPTR   EQU   @04
DATAADDR EQU   @04
BLOCKNUM EQU   @04
MEMBRPTR EQU   @05
NBLKNUM  EQU   @06
BUFRPTR  EQU   @07
RPTPTR   EQU   @05
PECBPTR  EQU   @04
CVTPTR   EQU   16
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
IEDQTCXD EQU   0
TCXATTEN EQU   IEDQTCXD+4
TCXFLAG1 EQU   IEDQTCXD+34
TCXRPT   EQU   IEDQTCXD+36
TCXBUFA  EQU   IEDQTCXD+80
TCXDSAVE EQU   IEDQTCXD+104
TCAST    EQU   0
TCASUSER EQU   TCAST+4
TCASTSB  EQU   TCAST+68
TCASFLG1 EQU   TCAST+88
TCASFLG2 EQU   TCAST+89
RCVT     EQU   0
RCVTSTAT EQU   RCVT+53
RCVTRNA  EQU   RCVTSTAT
RCVTSTA1 EQU   RCVT+150
RCVTAUOP EQU   RCVT+151
RCVTFLGS EQU   RCVT+153
RCVTEROP EQU   RCVT+154
RCVTRID0 EQU   RCVT+168
ACEE     EQU   0
ACEECORE EQU   ACEE+4
ACEEUSER EQU   ACEE+20
ACEEGRP  EQU   ACEE+29
ACEEGRPN EQU   ACEEGRP+1
ACEEFLG1 EQU   ACEE+38
ACEEFLG2 EQU   ACEE+39
ACEEFLG3 EQU   ACEE+40
ACEEFLG4 EQU   ACEE+56
ICHRID00 EQU   0
UADSPG   EQU   0
CMNDBUFR EQU   0
CMNDLNG  EQU   CMNDBUFR
CMNDTEXT EQU   CMNDBUFR+4
IKJEFLWP EQU   0
LWPUSERS EQU   IKJEFLWP
LWPUSERI EQU   LWPUSERS+4
LWPUSERM EQU   LWPUSERI
LWPUSERL EQU   LWPUSERI+2
LWPUSER  EQU   LWPUSERI+4
LWPPSWDS EQU   IKJEFLWP+16
LWPPSWDI EQU   LWPPSWDS+4
LWPPSWDL EQU   LWPPSWDI+2
LWPPSWD  EQU   LWPPSWDI+4
LWPPROCS EQU   IKJEFLWP+32
LWPPROCI EQU   LWPPROCS+4
LWPPROCM EQU   LWPPROCI
LWPPROCL EQU   LWPPROCI+2
LWPPROC  EQU   LWPPROCI+4
LWPACCTS EQU   IKJEFLWP+48
LWPACCTI EQU   LWPACCTS+4
LWPACCTL EQU   LWPACCTI+2
LWPACCT  EQU   LWPACCTI+4
@NM00039 EQU   IKJEFLWP+96
LWPREGNI EQU   @NM00039+4
LWPREGNX EQU   LWPREGNI+12
@NM00040 EQU   IKJEFLWP+116
LWPPERFI EQU   @NM00040+4
LWPPERFX EQU   LWPPERFI+12
LWPDESTS EQU   IKJEFLWP+136
LWPDESTI EQU   LWPDESTS+4
LWPDEST  EQU   LWPDESTI+4
LWPNPSWS EQU   IKJEFLWP+152
LWPNPSWI EQU   LWPNPSWS+4
LWPNPSWL EQU   LWPNPSWI+2
LWPNPSWD EQU   LWPNPSWI+4
LWPGRPS  EQU   IKJEFLWP+168
LWPGRPI  EQU   LWPGRPS+4
LWPGRPM  EQU   LWPGRPI
LWPGRPL  EQU   LWPGRPI+2
LWPGRP   EQU   LWPGRPI+4
LWPFLAGS EQU   IKJEFLWP+184
LWPFLGS1 EQU   LWPFLAGS
LWPRECON EQU   LWPFLGS1
LWPMAIL  EQU   LWPFLGS1
LWPNOTIC EQU   LWPFLGS1
LWPOIDCD EQU   LWPFLGS1
TSB      EQU   0
TSBASCBA EQU   TSB
TSBSTAT  EQU   TSBASCBA
TSBFLG1  EQU   TSB+4
TSBFLG2  EQU   TSB+16
TSBFLG3  EQU   TSB+24
TSBFLG5  EQU   TSB+25
TSBVTAM  EQU   TSBFLG5
TSBTERMC EQU   TSB+26
TSBTERM1 EQU   TSBTERMC
TSBTERM2 EQU   TSBTERMC+1
TSBSTCC  EQU   TSB+34
TSBFLG4  EQU   TSB+41
TSBHUNG  EQU   TSBFLG4
TSBRCB   EQU   TSB+64
TSBLINKA EQU   TSBRCB+4
TSBTPOST EQU   TSB+72
TSBTPFLG EQU   TSBTPOST
TSBMINL  EQU   TSB+84
TSBPSWD  EQU   TSB+88
TSBEXTNT EQU   TSB+96
TSBTRMID EQU   TSB+104
TSBSF1   EQU   TSB+112
TSBX     EQU   0
TSBXFWD  EQU   TSBX
TSBXUID  EQU   TSBX+24
TSBXFLG1 EQU   TSBX+32
TSBXWREC EQU   TSBXFLG1
TSBXTERM EQU   TSBX+72
JCLS     EQU   0
JCLSHDR  EQU   JCLS
JCLSJCLS EQU   JCLSHDR
JCLSCARD EQU   JCLS+8
LWA      EQU   0
LWAPASCB EQU   LWA+16
LWAACCT  EQU   LWA+20
LWAPSCB  EQU   LWA+24
LWAJSEL  EQU   LWA+28
LWAPECT  EQU   LWA+32
LWAAECB  EQU   LWA+36
LWAPECB  EQU   LWA+40
LWASECB  EQU   LWA+44
LWAPDCB  EQU   LWA+52
LWAFLGS  EQU   LWA+56
@NM00085 EQU   LWAFLGS
LWALE    EQU   @NM00085
@NM00086 EQU   LWAFLGS+1
@NM00088 EQU   LWAFLGS+2
LWARACF  EQU   @NM00088
LWAFLGS4 EQU   LWAFLGS+3
LWANORDR EQU   LWAFLGS4
LWAILGN  EQU   LWAFLGS4
LWACTLS  EQU   LWA+64
LWAUFAI  EQU   LWACTLS
LWAFAIL  EQU   LWACTLS
LWADISC  EQU   LWACTLS
LWANOPR  EQU   LWACTLS
LWANUAD  EQU   LWACTLS
LWAJJCL  EQU   LWACTLS
LWAATR1  EQU   LWACTLS+1
LWAATR2  EQU   LWACTLS+1
LWAUNIT  EQU   LWACTLS+1
LWABUPT  EQU   LWACTLS+1
LWADEST  EQU   LWACTLS+1
LWABEND  EQU   LWACTLS+1
LWARTCD  EQU   LWA+68
LWANAME  EQU   LWA+72
LWARNML  EQU   LWANAME
LWARNM   EQU   LWANAME+1
LWAELST  EQU   LWA+92
LWAPECBP EQU   LWAELST+4
LWATCPU  EQU   LWA+104
LWATCPU1 EQU   LWA+108
LWATSRU  EQU   LWA+112
LWATSRU1 EQU   LWA+116
LWATCON  EQU   LWA+120
LWATCON1 EQU   LWA+124
LWASTCB  EQU   LWA+128
LWADEST2 EQU   LWA+132
LOGONTCB EQU   0
@NM00094 EQU   0
LP0PRMT  EQU   @NM00094+8
ECT      EQU   0
ECTSWS   EQU   ECT+28
ECTNMAL  EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
JSEL     EQU   0
JSELCSCB EQU   JSEL+8
JSELJCL  EQU   JSEL+12
JSELASCB EQU   JSEL+20
CHAIN    EQU   0
CHFLG    EQU   CHAIN+4
CHSTS    EQU   CHFLG+2
CHACT    EQU   CHFLG+3
CHKEY    EQU   CHAIN+8
CHPARM   EQU   CHKEY
CHCLS    EQU   CHAIN+16
CHPKE    EQU   CHAIN+28
CHTJID   EQU   CHAIN+30
CHPROCSN EQU   CHAIN+32
CHACT1   EQU   CHPROCSN+3
CHASM    EQU   CHAIN+40
CHCIBP   EQU   CHASM+4
CHRGNSZ  EQU   CHASM+8
CHCECB   EQU   CHASM+20
CHSTEP   EQU   CHASM+24
CHSWT    EQU   CHSTEP
CHSHORT  EQU   CHASM+32
PSCB     EQU   0
PSCBUSER EQU   PSCB
PSCBUSRL EQU   PSCB+7
PSCBGPNM EQU   PSCB+8
PSCBATR1 EQU   PSCB+16
PSCBATTN EQU   PSCBATR1
PSCBATR2 EQU   PSCB+18
PSCBSUBH EQU   PSCB+28
PSCBSUBC EQU   PSCB+29
PSCBSUBM EQU   PSCB+30
PSCBSOUT EQU   PSCB+31
PSCBDEST EQU   PSCB+40
PSCBUPT  EQU   PSCB+52
PSCBUPTL EQU   PSCB+56
PSCBCHAR EQU   PSCB+58
PSCBLINE EQU   PSCB+59
PSCBRSZ  EQU   PSCB+60
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTMID   EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTCDEL  EQU   UPT+13
UPTLDEL  EQU   UPT+14
UPTPREFX EQU   UPT+16
UPTPREFL EQU   UPT+23
ASCB     EQU   0
ASCBCSCB EQU   ASCB+56
ASCBTSB  EQU   ASCB+60
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBASXB EQU   ASCB+108
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBJBNS EQU   ASCB+176
ASXB     EQU   0
ASXBAEQ  EQU   ASXB+168
ASXBSECR EQU   ASXB+199
ASCBSFLG EQU   ASXBSECR
ASXBSENV EQU   ASXBSECR+1
ASXBCASW EQU   ASXB+216
ASXBCRB1 EQU   ASXBCASW
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBPTRS  EQU   0
TCBCPTR  EQU   TCBPTRS+4
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBPASS EQU   JSCBSWT1
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
DHED     EQU   0
UADSMHDR EQU   DHED
UADSBN01 EQU   UADSMHDR+12
UADSEXPF EQU   UADSBN01+1
UADSMAXC EQU   UADSMHDR+14
UADSATTR EQU   DHED+16
UADSINST EQU   DHED+18
UADSUPTP EQU   DHED+20
UADSPWD1 EQU   DHED+24
UADSPERP EQU   DHED+28
UADSDEST EQU   DHED+32
UADSSUBH EQU   DHED+40
UADSSUBC EQU   DHED+41
UADSSUBM EQU   DHED+42
UADSSOUT EQU   DHED+43
DPOBD    EQU   0
UADSPPWD EQU   DPOBD+4
DNOBD    EQU   0
UADSADRF EQU   DNOBD+4
UADSALEN EQU   DNOBD+44
UADSANUM EQU   DNOBD+45
DROBD    EQU   0
UADSRNAM EQU   DROBD+4
UADSRSIZ EQU   DROBD+14
UADSUNAM EQU   DROBD+16
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESPJESN EQU   JESCT+28
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
SSREQ    EQU   0
SSIB     EQU   0
SSIBID   EQU   SSIB
SSIBLEN  EQU   SSIB+4
SSIBFLG1 EQU   SSIB+6
SSIBSSNM EQU   SSIB+8
INDIRECT EQU   0
FIELD    EQU   0
STRBLKNM EQU   0
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
STRING   EQU   0
SWAMGR   EQU   0
LOGONWA  EQU   0
SUBLOGON EQU   0
SUBITEMS EQU   0
SUBECT   EQU   0
SUBUPT   EQU   0
BLD#     EQU   0
BLDINS   EQU   0
BLDHEAD  EQU   BLDINS
BLDLEN   EQU   BLDHEAD
BLDTEXT  EQU   BLDINS+4
TCXPTR   EQU   CVTAQAVT
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
CVTRAC   EQU   CVTS01+644
CVTTCASP EQU   CVTS01+664
TCASTPTR EQU   CVTTCASP
ACEEPTR  EQU   ASXBSENV
UADSPFG1 EQU   UADSPFGR
PRFGRP   EQU   LWPPERFX
GROUP    EQU   PRFGRP+3
DCBBLKSI EQU   UADSDCB+62
DCBOFLGS EQU   UADSDCB+48
ACCTINFO EQU   UADSADRF
TOTLCPU  EQU   ACCTINFO
TOTLCPU1 EQU   ACCTINFO+4
TOTLCON  EQU   ACCTINFO+8
TOTLCON1 EQU   ACCTINFO+12
TOTLSU   EQU   ACCTINFO+16
TOTLSU1  EQU   ACCTINFO+20
UADSATR  EQU   UADSATTR
RACPSWD  EQU   LWPPSWDL+1
RACNPSWD EQU   LWPNPSWL+1
RACGROUP EQU   LWPGRPL+1
CHAINS01 EQU   CHASM
CHTYPE   EQU   CHAINS01+124
CHTRSTAT EQU   CHAINS01+125
CHCSYSO  EQU   CHAINS01+134
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCSCT   EQU   JSCBSEC3+68
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
I056     EQU   ILIST
I05601   EQU   I056+4
I05602   EQU   I056+8
I05603   EQU   I05602
I05604   EQU   I05602+1
I05605   EQU   I05602+2
I05655   EQU   I05602+3
I05606   EQU   I05602+4
I05607   EQU   I05602+8
I048     EQU   ILIST
I04801   EQU   I048
I04802   EQU   I048+4
I04803   EQU   I04802
I04804   EQU   I04803
I04805   EQU   I04803+1
I04806   EQU   I04803+2
I04807   EQU   I04802+4
I04808   EQU   I04802+8
STOREIT  EQU   SAVBLKNM
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00160 EQU   I04803+3
I05600   EQU   I056
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00146 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00145 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
CHLAST   EQU   CHAINS01+136
CHSPA    EQU   CHAINS01+135
CHUSERID EQU   CHCSYSO
CHJB     EQU   CHCSYSO
CHDUMP   EQU   CHCSYSO
CHQUE    EQU   CHCSYSO
CHHOLD   EQU   CHCSYSO
CHOUT    EQU   CHCSYSO
CHINN    EQU   CHCSYSO
CHALL    EQU   CHCSYSO
CHINC    EQU   CHAINS01+132
CHPEND   EQU   CHAINS01+128
CHARID   EQU   CHAINS01+127
CHCNID   EQU   CHAINS01+126
@NM00106 EQU   CHTRSTAT
CHTSL    EQU   CHTRSTAT
CHTS     EQU   CHTRSTAT
CHINITL  EQU   CHTRSTAT
CHINIT   EQU   CHTRSTAT
CHJOBSL  EQU   CHTRSTAT
CHJOBS   EQU   CHTRSTAT
CHDEF    EQU   CHTYPE
CHHIAR   EQU   CHTYPE
CHARSV29 EQU   CHTYPE
CHARSV28 EQU   CHTYPE
CHARSV27 EQU   CHTYPE
CHARSV26 EQU   CHTYPE
CHARSV25 EQU   CHTYPE
CHDSTAT  EQU   CHTYPE
CHBUF    EQU   CHAINS01
@NM00035 EQU   PRFGRP+2
@NM00034 EQU   PRFGRP
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
BLDOFF   EQU   BLDHEAD+2
SSIBSUSE EQU   SSIB+32
SSIBRSV1 EQU   SSIB+28
SSIBDEST EQU   SSIB+20
SSIBJBID EQU   SSIB+12
SSIBRESV EQU   SSIB+7
@NM00159 EQU   SSIBFLG1
SSIBPJES EQU   SSIBFLG1
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00158 EQU   JESCT
@NM00155 EQU   DROBD+12
@NM00154 EQU   DROBD+1
UADSRCTR EQU   DROBD
@NM00153 EQU   DNOBD+1
UADSACTR EQU   DNOBD
@NM00152 EQU   DPOBD+1
UADSPCTR EQU   DPOBD
@NM00151 EQU   DHED+44
@NM00150 EQU   UADSATTR
USATR04  EQU   UADSATTR
@NM00149 EQU   UADSATTR
USATR03  EQU   UADSATTR
USATR02  EQU   UADSATTR
USATR01  EQU   UADSATTR
USATR00  EQU   UADSATTR
@NM00148 EQU   UADSBN01+1
UADSXUSD EQU   UADSBN01+1
UADSXBLK EQU   UADSBN01+1
UADSNUSP EQU   UADSBN01+1
@NM00147 EQU   UADSBN01
UADSUSER EQU   UADSMHDR+4
UADSFSQP EQU   UADSMHDR+2
UADSBLNG EQU   UADSMHDR
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00144 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00143 EQU   IEZJSCB
@NM00142 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBCAUF  EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00141 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00140 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00139 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
TCBNPTR  EQU   TCBPTRS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00114 EQU   CVTFIX+248
@NM00113 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
ASXBEND  EQU   ASXB+232
ASXBRV25 EQU   ASXB+228
ASXBRV24 EQU   ASXB+224
ASXBPT0E EQU   ASXB+220
ASXBCRB4 EQU   ASXBCASW+3
ASXBCRB3 EQU   ASXBCASW+2
ASXBCRB2 EQU   ASXBCASW+1
ASXBCR06 EQU   ASXBCRB1
ASXBCR05 EQU   ASXBCRB1
ASXBCR04 EQU   ASXBCRB1
ASXBCR03 EQU   ASXBCRB1
ASXBCR02 EQU   ASXBCRB1
ASXBCR01 EQU   ASXBCRB1
ASXBTFD  EQU   ASXBCRB1
ASXBPIP  EQU   ASXBCRB1
ASXBCTDC EQU   ASXB+212
ASXBTDCB EQU   ASXB+208
ASXBRV19 EQU   ASXB+204
ASXBRV34 EQU   ASCBSFLG
ASXBRV33 EQU   ASCBSFLG
ASXBRV32 EQU   ASCBSFLG
ASXBRV31 EQU   ASCBSFLG
ASXBRV30 EQU   ASCBSFLG
ASXBRV29 EQU   ASCBSFLG
ASXBRV28 EQU   ASCBSFLG
ASXBRV27 EQU   ASCBSFLG
ASXBUSER EQU   ASXB+192
ASXBLSRB EQU   ASXBAEQ+20
ASXBFSRB EQU   ASXBAEQ+16
ASXBLRQE EQU   ASXBAEQ+12
ASXBFRQE EQU   ASXBAEQ+8
ASXBLIQE EQU   ASXBAEQ+4
ASXBFIQE EQU   ASXBAEQ
ASXBETSK EQU   ASXB+164
ASXBSIRB EQU   ASXB+160
ASXBPSWD EQU   ASXB+152
ASXBPRG  EQU   ASXB+136
ASXBRV26 EQU   ASXB+132
ASXBOUSB EQU   ASXB+128
ASXBDDR  EQU   ASXB+124
ASXBRCTD EQU   ASXB+120
ASXBRSMD EQU   ASXB+116
ASXBSPSA EQU   ASXB+112
ASXBFRWA EQU   ASXB+108
ASXBFLSA EQU   ASXB+36
ASXBIHSA EQU   ASXB+32
ASXBRV15 EQU   ASXB+28
ASXBRV14 EQU   ASXB+24
ASXBLWA  EQU   ASXB+20
ASXBMPST EQU   ASXB+16
ASXBRS00 EQU   ASXB+14
ASXBTCBS EQU   ASXB+12
ASXBLTCB EQU   ASXB+8
ASXBFTCB EQU   ASXB+4
ASXBASXB EQU   ASXB
ASXBEGIN EQU   ASXB
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
@NM00112 EQU   UPT+15
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
UPTRCVR  EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00111 EQU   UPT
PSCBU    EQU   PSCB+64
PSCBRLGB EQU   PSCB+48
@NM00110 EQU   PSCB+36
@NM00109 EQU   PSCB+32
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
@NM00108 EQU   PSCBATR1
@NM00107 EQU   PSCBATR1
PSCBRCVR EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
CHARSV16 EQU   CHSHORT+100
CHARSV15 EQU   CHSHORT+96
CHJSCBVS EQU   CHSHORT+92
CHUSCVS  EQU   CHSHORT+88
@NM00105 EQU   CHSHORT+84
@NM00104 EQU   CHSHORT+80
CHSQA    EQU   CHSHORT+44
CHQPA    EQU   CHSHORT+8
CHJCL    EQU   CHSHORT+4
CHSPC    EQU   CHSHORT
CHSPB    EQU   CHSTEP+4
CHTCB    EQU   CHSTEP+1
CHARSV23 EQU   CHSWT
CHARSV22 EQU   CHSWT
CHARSV21 EQU   CHSWT
CHAC     EQU   CHSWT
CHPSF    EQU   CHSWT
CHPSD    EQU   CHSWT
CHJCT    EQU   CHSWT
CHARSV20 EQU   CHSWT
CHECB    EQU   CHASM+16
CHRGNAD  EQU   CHASM+12
CHARSV18 EQU   CHRGNSZ+1
CHRPRTY  EQU   CHRGNSZ
@NM00103 EQU   CHCIBP
CHEND    EQU   CHCIBP
CHECBP   EQU   CHASM
CHDER    EQU   CHPROCSN+4
CHARSV10 EQU   CHACT1
CHARSV09 EQU   CHACT1
CHARSV08 EQU   CHACT1
CHARSV07 EQU   CHACT1
CHARSV06 EQU   CHACT1
CHARSV05 EQU   CHACT1
CHARSV04 EQU   CHACT1
CHRDWTR  EQU   CHACT1
CHARSV30 EQU   CHPROCSN+2
CHQID    EQU   CHPROCSN
CHASID   EQU   CHTJID
CHUCMP   EQU   CHAIN+29
CHTRKID  EQU   CHPKE
CHCIBCTR EQU   CHAIN+27
CHUNIT   EQU   CHAIN+24
CHPCOI   EQU   CHPARM
CHIFY    EQU   CHACT
CHAIFX   EQU   CHACT
CHCLD    EQU   CHACT
CHCL     EQU   CHACT
CHDSI    EQU   CHACT
CHDISC   EQU   CHACT
CHTERM   EQU   CHACT
CHSWAP   EQU   CHACT
CHABTERM EQU   CHSTS
CHFC     EQU   CHSTS
CHDL     EQU   CHSTS
CHAD     EQU   CHSTS
CHQSPC   EQU   CHSTS
CHSOUT   EQU   CHSTS
CHSYS    EQU   CHSTS
CHAP     EQU   CHSTS
CHSZE    EQU   CHFLG+1
CHVCD    EQU   CHFLG
CHPTR    EQU   CHAIN
JSELEOL  EQU   JSELASCB
JSELJSXL EQU   JSEL+16
JSELJSOL EQU   JSEL+4
@NM00102 EQU   JSEL
@NM00101 EQU   ECT+52
@NM00100 EQU   ECT+48
@NM00099 EQU   ECT+44
@NM00098 EQU   ECTSWS2+1
@NM00097 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
ECTATRM  EQU   ECTSWS
@NM00096 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
ECTRTCD  EQU   ECT+1
ECTRCDF  EQU   ECT
LP0MWAT  EQU   @NM00094+4
@NM00095 EQU   @NM00094
@NM00093 EQU   LWA+152
LWASPF   EQU   LWA+148
LWASWKA  EQU   LWA+144
LWAGBWKA EQU   LWA+140
LWARCDE  EQU   LWA+100
LWAEOEL  EQU   LWAPECBP
LWAAECBP EQU   LWAELST
LWANQDQ  EQU   LWA+80
@NM00092 EQU   LWACTLS+1
LWANONQ  EQU   LWACTLS+1
@NM00091 EQU   LWACTLS
LWAMOUNT EQU   LWACTLS
LWAPTID  EQU   LWA+60
LWAINX1  EQU   LWAFLGS4
LWATNBT  EQU   LWAFLGS4
LWALTBC  EQU   LWAFLGS4
LWASICSP EQU   LWAFLGS4
LWAQTIP  EQU   LWAFLGS4
@NM00090 EQU   LWAFLGS4
LWABND   EQU   @NM00088
LWAMCK   EQU   @NM00088
LWAPCK   EQU   @NM00088
LWAPSW   EQU   @NM00088
LWAPHASE EQU   @NM00088
LWAVTAM  EQU   @NM00088
@NM00089 EQU   @NM00088
@NM00087 EQU   @NM00086
LWALS    EQU   @NM00086
LWALGB   EQU   @NM00086
LWALG    EQU   @NM00086
LWALK    EQU   @NM00086
LWALJ    EQU   @NM00086
LWALGM   EQU   @NM00086
LWALL    EQU   @NM00085
LWALH    EQU   @NM00085
LWALI    EQU   @NM00085
LWALEA   EQU   @NM00085
LWALC    EQU   @NM00085
LWALB    EQU   @NM00085
LWALA    EQU   @NM00085
LWALPCNT EQU   LWA+48
LWASBCE  EQU   LWASECB+3
@NM00084 EQU   LWASECB
LWAPBCE  EQU   LWAPECB+3
@NM00083 EQU   LWAPECB
LWAABCE  EQU   LWAAECB+3
@NM00082 EQU   LWAAECB
LWATEST  EQU   LWA+12
LWALWA   EQU   LWA+4
LWAPPTR  EQU   LWA
JCLSSEQ  EQU   JCLSCARD+72
JCLSCNTN EQU   JCLSCARD+71
JCLSBODY EQU   JCLSCARD+15
JCLSTYPE EQU   JCLSCARD+10
JCLSLABL EQU   JCLSCARD+2
JCLSLASH EQU   JCLSCARD
@NM00081 EQU   JCLSHDR+4
TSBXEND  EQU   TSBX+88
@NM00080 EQU   TSBX+80
TSBXRPL  EQU   TSBX+76
TSBXTMBF EQU   TSBXTERM+2
@NM00079 EQU   TSBXTERM+1
TSBXTMTP EQU   TSBXTERM
TSBXAIND EQU   TSBX+70
@NM00078 EQU   TSBX+68
TSBXLBUF EQU   TSBX+64
TSBXCSAP EQU   TSBX+60
TSBXSRB  EQU   TSBX+56
TSBXSRBI EQU   TSBX+52
@NM00077 EQU   TSBX+48
TSBXTOM  EQU   TSBX+44
TSBXTIM  EQU   TSBX+40
TSBXTVWA EQU   TSBX+36
@NM00076 EQU   TSBX+33
@NM00075 EQU   TSBXFLG1
TSBXLOGF EQU   TSBXFLG1
TSBXACTV EQU   TSBXFLG1
TSBXASCI EQU   TSBXFLG1
@NM00074 EQU   TSBX+16
@NM00073 EQU   TSBX+12
TSBXECB  EQU   TSBX+8
TSBXBCK  EQU   TSBX+4
TSBEND   EQU   TSB+120
TSBALTC  EQU   TSB+103
TSBALTR  EQU   TSB+102
TSBPRMC  EQU   TSB+101
TSBPRMR  EQU   TSB+100
TSBLECB  EQU   TSBMINL
TSBLINE  EQU   TSB+82
TSBSTAX  EQU   TSB+81
TSBATTNC EQU   TSB+80
TSBF1V   EQU   TSBTPOST+7
TSBF1M   EQU   TSBTPOST+6
TSBF2V   EQU   TSBTPOST+5
TSBF2M   EQU   TSBTPOST+4
TSBFLAGV EQU   TSBTPOST+3
TSBFLAGM EQU   TSBTPOST+2
@NM00072 EQU   TSBTPOST+1
@NM00071 EQU   TSBTPFLG
@NM00070 EQU   TSBTPFLG
@NM00069 EQU   TSBTPFLG
@NM00068 EQU   TSBTPFLG
TSBNEWID EQU   TSBTPFLG
TSBTPAYI EQU   TSBTPFLG
TSBTPQCB EQU   TSBTPFLG
TSBPOSTO EQU   TSBTPFLG
TSBLINKB EQU   TSBLINKA+1
TSBPRI   EQU   TSBLINKA
TSBRQCB  EQU   TSBRCB
TSBCTCB  EQU   TSB+60
TSBERSDS EQU   TSB+56
TSBAUTOI EQU   TSB+52
TSBAUTOS EQU   TSB+48
TSBATNCC EQU   TSB+44
TSBASRCE EQU   TSB+42
TSBHLDL  EQU   TSBFLG4
TSBGETBF EQU   TSBFLG4
TSBCANC  EQU   TSBFLG4
TSBHOLD  EQU   TSBFLG4
TSBOWAIT EQU   TSBFLG4
TSBIWAIT EQU   TSBFLG4
TSBOCAB  EQU   TSBFLG4
TSBLNNO  EQU   TSB+40
TSBATNTC EQU   TSB+38
TSBATNLC EQU   TSB+36
TSBCHDCC EQU   TSBSTCC+1
TSBLNDCC EQU   TSBSTCC
TSBWTJID EQU   TSB+32
TSBECB   EQU   TSB+28
TSBC1050 EQU   TSBTERM2
@NM00067 EQU   TSBTERM2
@NM00066 EQU   TSBTERM2
@NM00065 EQU   TSBTERM2
@NM00064 EQU   TSBTERM2
TSBCTWX  EQU   TSBTERM2
@NM00063 EQU   TSBTERM2
@NM00062 EQU   TSBTERM2
@NM00061 EQU   TSBTERM1
@NM00060 EQU   TSBTERM1
@NM00059 EQU   TSBTERM1
TSBC2741 EQU   TSBTERM1
TSBC5041 EQU   TSBTERM1
TSBCATTN EQU   TSBTERM1
TSBCBRK  EQU   TSBTERM1
TSBCIHBN EQU   TSBTERM1
TSBKEYS  EQU   TSBFLG5
@NM00058 EQU   TSBFLG5
TSBSPF   EQU   TSBFLG5
TSBATMP  EQU   TSBFLG5
TSBNFLOP EQU   TSBFLG3
TSBNOBRK EQU   TSBFLG3
TSBTPUT  EQU   TSBFLG3
TSBAWOIP EQU   TSBFLG3
TSBNBKSP EQU   TSBFLG3
TSBSPIT  EQU   TSBFLG3
TSBTJMSG EQU   TSBFLG3
TSBATTN  EQU   TSBFLG3
TSBIBFP  EQU   TSB+21
TSBNIBF  EQU   TSB+20
TSBITBFP EQU   TSB+17
TSBSATN2 EQU   TSBFLG2
TSBSATN1 EQU   TSBFLG2
TSBSTAUT EQU   TSBFLG2
TSBAUTOC EQU   TSBFLG2
TSBAULST EQU   TSBFLG2
TSBBRKIN EQU   TSBFLG2
TSBAUTON EQU   TSBFLG2
TSBBIPI  EQU   TSBFLG2
TSBOBFP  EQU   TSB+13
TSBNOBF  EQU   TSB+12
TSBOTBFP EQU   TSB+9
TSBLNSZ  EQU   TSB+8
TSBWTCB  EQU   TSB+5
TSBTJBF  EQU   TSBFLG1
TSBTJIP  EQU   TSBFLG1
TSBTJOW  EQU   TSBFLG1
TSBIFLSH EQU   TSBFLG1
TSBWOWIP EQU   TSBFLG1
TSBOWIP  EQU   TSBFLG1
TSBOFLSH EQU   TSBFLG1
TSBANSR  EQU   TSBFLG1
TSBASCB  EQU   TSBASCBA+1
TSBATNLD EQU   TSBSTAT
TSB3270  EQU   TSBSTAT
TSBDISC  EQU   TSBSTAT
TSBITOFF EQU   TSBSTAT
TSBNOBUF EQU   TSBSTAT
TSBDSPLY EQU   TSBSTAT
TSBLWAIT EQU   TSBSTAT
TSBINUSE EQU   TSBSTAT
@NM00042 EQU   LWPFLAGS+1
@NM00041 EQU   LWPFLGS1
LWPGRPP  EQU   LWPGRPS
LWPNPSWM EQU   LWPNPSWI
LWPNPSWP EQU   LWPNPSWS
LWPDESTL EQU   LWPDESTI+2
LWPDESTM EQU   LWPDESTI
LWPDESTP EQU   LWPDESTS
LWPPERF  EQU   LWPPERFI+4
LWPPERFL EQU   LWPPERFI+2
LWPPERFM EQU   LWPPERFI
LWPPERFP EQU   @NM00040
LWPREGN  EQU   LWPREGNI+4
LWPREGNL EQU   LWPREGNI+2
LWPREGNM EQU   LWPREGNI
LWPREGNP EQU   @NM00039
LWPACCTM EQU   LWPACCTI
LWPACCTP EQU   LWPACCTS
LWPPROCP EQU   LWPPROCS
LWPPSWDM EQU   LWPPSWDI
LWPPSWDP EQU   LWPPSWDS
@NM00038 EQU   LWPUSERI+11
LWPUSERP EQU   LWPUSERS
CMNDOFST EQU   CMNDBUFR+2
ACEEAMP  EQU   ACEE+72
ACEETRID EQU   ACEE+64
ACEETRDA EQU   ACEE+60
ACEETRLV EQU   ACEE+59
@NM00031 EQU   ACEE+58
@NM00030 EQU   ACEEFLG4
ACEETERM EQU   ACEEFLG4
ACEETAPE EQU   ACEEFLG4
ACEEDASD EQU   ACEEFLG4
@NM00029 EQU   ACEEFLG4
ACEEUATH EQU   ACEEFLG4
@NM00028 EQU   ACEEFLG4
@NM00027 EQU   ACEEFLG4
ACEETRMP EQU   ACEE+52
ACEEPROC EQU   ACEE+44
ACEEDATE EQU   ACEE+41
@NM00026 EQU   ACEEFLG3
@NM00025 EQU   ACEEFLG3
@NM00024 EQU   ACEEFLG3
@NM00023 EQU   ACEEFLG3
@NM00022 EQU   ACEEFLG3
@NM00021 EQU   ACEEFLG3
@NM00020 EQU   ACEEFLG3
ACEEGRPA EQU   ACEEFLG3
ACEENONE EQU   ACEEFLG2
@NM00019 EQU   ACEEFLG2
@NM00018 EQU   ACEEFLG2
@NM00017 EQU   ACEEFLG2
ACEEREAD EQU   ACEEFLG2
ACEEUPDT EQU   ACEEFLG2
ACEECNTL EQU   ACEEFLG2
ACEEALTR EQU   ACEEFLG2
ACEERACF EQU   ACEEFLG1
@NM00016 EQU   ACEEFLG1
@NM00015 EQU   ACEEFLG1
ACEELOGU EQU   ACEEFLG1
ACEEAUDT EQU   ACEEFLG1
ACEEOPER EQU   ACEEFLG1
ACEEADSP EQU   ACEEFLG1
ACEESPEC EQU   ACEEFLG1
ACEEGRPL EQU   ACEEGRP
ACEEUSRI EQU   ACEEUSER+1
ACEEUSRL EQU   ACEEUSER
ACEEINST EQU   ACEE+16
ACEEIEP  EQU   ACEE+12
@NM00014 EQU   ACEE+8
ACEELEN  EQU   ACEECORE+1
ACEESP   EQU   ACEECORE
ACEEACEE EQU   ACEE
RCVTEXTA EQU   RCVT+173
RCVTVERS EQU   RCVT+172
RCVTRCXP EQU   RCVT+164
RCVTRIXP EQU   RCVT+160
RCVTRAU0 EQU   RCVT+156
RCVTPINV EQU   RCVT+155
@NM00013 EQU   RCVTEROP
RCVTSAUD EQU   RCVTEROP
RCVTAVIO EQU   RCVTEROP
RCVTTUAC EQU   RCVTEROP
RCVTTERP EQU   RCVTEROP
RCVTNDUP EQU   RCVTFLGS
RCVTSHR  EQU   RCVTFLGS
RCVTRDHD EQU   RCVTFLGS
RCVTROFF EQU   RCVTFLGS
RCVTAXTA EQU   RCVT+152
RCVTATER EQU   RCVTAUOP
RCVTATAP EQU   RCVTAUOP
RCVTADAS EQU   RCVTAUOP
RCVTADAT EQU   RCVTAUOP
RCVTAUSE EQU   RCVTAUOP
RCVTAGRO EQU   RCVTAUOP
@NM00012 EQU   RCVTAUOP
@NM00011 EQU   RCVTSTA1
RCVTTAPE EQU   RCVTSTA1
RCVTUVOL EQU   RCVT+144
RCVTUADS EQU   RCVT+100
RCVTDSN  EQU   RCVT+56
RCVTNREC EQU   RCVT+54
@NM00010 EQU   RCVTSTAT
RCVTNTMS EQU   RCVTSTAT
RCVTNDVS EQU   RCVTSTAT
RCVTNTVS EQU   RCVTSTAT
RCVTNDSS EQU   RCVTSTAT
RCVTNLS  EQU   RCVTSTAT
RCVTDSNL EQU   RCVT+52
RCVTISTL EQU   RCVT+48
RCVTBAM  EQU   RCVT+44
RCVTXLEN EQU   RCVT+40
RCVTRUCB EQU   RCVT+36
RCVTRDX  EQU   RCVT+32
RCVTRCX  EQU   RCVT+28
RCVTRIX  EQU   RCVT+24
RCVTHDR  EQU   RCVT+20
RCVTTEMP EQU   RCVT+16
RCVTINDX EQU   RCVT+12
RCVTDEB  EQU   RCVT+8
RCVTDCB  EQU   RCVT+4
RCVTID   EQU   RCVT
TCASTEND EQU   TCAST+128
@NM00009 EQU   TCAST+120
@NM00008 EQU   TCAST+118
TCASBR14 EQU   TCAST+116
@NM00007 EQU   TCAST+112
TCASASCI EQU   TCAST+108
TCASTTQH EQU   TCAST+104
TCASNIBL EQU   TCAST+102
TCASEXL  EQU   TCAST+100
TCASRPLL EQU   TCAST+98
TCASACBL EQU   TCAST+96
TCASASCB EQU   TCAST+92
@NM00006 EQU   TCAST+90
@NM00005 EQU   TCASFLG2
TCASTERM EQU   TCASFLG2
@NM00004 EQU   TCASFLG1
TCASNACT EQU   TCASFLG1
TCASESTA EQU   TCASFLG1
TCASABND EQU   TCASFLG1
TCASTPEN EQU   TCASFLG1
TCASLQIS EQU   TCASFLG1
TCASLTE  EQU   TCAST+84
TCASTPND EQU   TCAST+80
TCASOQM  EQU   TCAST+76
TCASIQM  EQU   TCAST+72
TCASTTL  EQU   TCAST+64
TCASWA   EQU   TCAST+60
TCASFAIL EQU   TCAST+56
TCASMSGS EQU   TCAST+52
TCASTECB EQU   TCAST+48
TCASMECB EQU   TCAST+44
TCASXECB EQU   TCAST+40
TCASTID  EQU   TCAST+32
@NM00003 EQU   TCAST+31
TCASCHNL EQU   TCAST+30
TCASCRSZ EQU   TCAST+28
TCASLBUF EQU   TCAST+24
TCASHBUF EQU   TCAST+20
TCASCLSZ EQU   TCAST+18
TCASRCON EQU   TCAST+16
TCASACBP EQU   TCAST+8
TCASUMAX EQU   TCASUSER+2
TCASUSEC EQU   TCASUSER
TCASID   EQU   TCAST
TCXEND   EQU   IEDQTCXD+208
TCXUNUS1 EQU   IEDQTCXD+204
TCXESAVE EQU   IEDQTCXD+132
TCXERPPM EQU   IEDQTCXD+128
TCXERPSV EQU   IEDQTCXD+116
TCXSATTN EQU   IEDQTCXD+112
@NM00002 EQU   TCXDSAVE+4
@NM00001 EQU   TCXDSAVE
TCXPLCB  EQU   IEDQTCXD+100
TCXBITS  EQU   IEDQTCXD+97
TCXBIT1  EQU   IEDQTCXD+96
TCXCOMPT EQU   IEDQTCXD+92
TCXAVAIL EQU   IEDQTCXD+88
TCXBUFL  EQU   IEDQTCXD+84
TCXTOTE  EQU   TCXBUFA
TCXCKPM  EQU   IEDQTCXD+79
TCXNCKPR EQU   IEDQTCXD+78
TCXSZAIB EQU   IEDQTCXD+76
TCXAIBC  EQU   IEDQTCXD+72
TCXPEBC  EQU   IEDQTCXD+68
TCXPEWAC EQU   IEDQTCXD+64
TCXQRQ   EQU   IEDQTCXD+60
TCXOCQ   EQU   IEDQTCXD+56
TCXPNTQ  EQU   IEDQTCXD+52
TCXPUTQ  EQU   IEDQTCXD+48
TCXGETQ  EQU   IEDQTCXD+44
TCXTSI   EQU   IEDQTCXD+40
TCXCC3TS EQU   IEDQTCXD+35
TCXAPPL  EQU   TCXFLAG1
TCXRTM   EQU   TCXFLAG1
TCXMCPCD EQU   TCXFLAG1
TCXAUTH  EQU   TCXFLAG1
TCXASID  EQU   IEDQTCXD+32
TCXASCB  EQU   IEDQTCXD+28
TCXREADY EQU   IEDQTCXD+24
TCXPASWD EQU   IEDQTCXD+16
TCXDISP  EQU   IEDQTCXD+12
TCXTCB   EQU   IEDQTCXD+8
TCXATTLN EQU   TCXATTEN
TCXAVT   EQU   IEDQTCXD
@NM00138 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00137 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00136 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00135 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00134 EQU   FLCFSA
@NM00133 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00132 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00131 EQU   FLCIOA
@NM00130 EQU   FLCMCLA+15
@NM00129 EQU   FLCMCLA+14
@NM00128 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00127 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00126 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00125 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00124 EQU   FLCPER
@NM00123 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00122 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00121 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00120 EQU   FLCPIILC
@NM00119 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00118 EQU   FLCSVILC
@NM00117 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00116 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00115 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00233 EQU   GOTOIER
@RT00253 EQU   CLEANUP4
@RT00263 EQU   BUILDJCL
@RT00287 EQU   NOOPEN
@RF00302 EQU   IOERROR
@RC00391 EQU   @RC00384
@RC00386 EQU   @RC00384
@RC00449 EQU   @RC00447
@RT00476 EQU   RCDPSWD
@RT00480 EQU   RCDPSWD
@RT00482 EQU   PRMTPSWD
@RT00484 EQU   RCDPSWD
@RT00526 EQU   FNDPROC
@RT00528 EQU   ACCTEND
@RT00551 EQU   PRMTACCT
@RT00561 EQU   PROCEND
@RT00563 EQU   RCDPROC
@RT00572 EQU   PRMTACCT
@RT00576 EQU   RCDPROCL
@RT00593 EQU   UADRGN
@RT00596 EQU   RCDRGN
@RT00611 EQU   PROMPTPF
@RT00644 EQU   BUILDJCL
@RT00664 EQU   CLEANUP4
@RT00723 EQU   CNTPRMPT
@RT00760 EQU   CLEANUP4
@RT00762 EQU   ECBPOSTD
@RT00764 EQU   CLEANUP4
@RT00766 EQU   GTMNERR
@RF00773 EQU   CLEANUP4
@RT00814 EQU   @EL00005
@RT00832 EQU   @EL00006
@RF00905 EQU   RTNIOERR
ENDFIND  EQU   @EL00008
@RF00975 EQU   CLEANUP4
@RF00969 EQU   CLEANUP4
@RT01012 EQU   ONCEMORE
@RF01012 EQU   CLEANUP4
@RC01099 EQU   @EL00012
@RT01133 EQU   CLEANUP4
@RC01117 EQU   @EL00013
@RF01116 EQU   @EL00013
@RC01158 EQU   @RC01157
@RC01162 EQU   @RC01161
@RC01168 EQU   @RC01167
@RF01229 EQU   CLEANUP4
@RF01303 EQU   @EL00017
@RF01333 EQU   @EL00018
@RF01414 EQU   CLEANUP4
@RT01447 EQU   CLEANUP4
@RT01455 EQU   ONCEAGAN
@RF01455 EQU   CLEANUP4
@RF01439 EQU   @EL00020
@RC01441 EQU   @EL00020
@RF01466 EQU   @EL00021
@RF01489 EQU   @EL00021
@PB00021 EQU   @PB00022
@PB00023 EQU   @EL00022
@RT00924 EQU   ENDFIND
@RF01447 EQU   @RC01441
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@ENDDATA EQU   *
         END   IKJEFLE,(C'PLS1746',0701,78177)

         TITLE 'IKJEFF07 - JCL IDENTIFY ROUTINE                        *
                        '
IKJEFF07 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFF07  75.344'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         LM    @00,@01,20(@13)                                     0001
         MVC   @PC00001(12),0(@01)                                 0001
*                                      TWO AND THREE           Y02993*/
*                                                                  0032
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF THE IKJEFFHT MAPPING MACRO                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0033
*                                                                  0033
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION FOR SCAN OF INPUT CARD                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0033
*   HTPTR=ADDR(HIST);               /* LOCAL POINTER TO HISTORY TABLE*/
         L     HTPTR,@PC00001                                      0033
*   INIDENT='1'B;                   /* INDICATE IN THIS MODULE       */
         OI    INIDENT(HTPTR),B'01000000'                          0034
*   ENDCOL=71;                      /* INITIALIZE THE ENDCOL         */
         LA    ENDCOL,71                                           0035
*   WORK=WORK&&WORK;                /* ZERO INTERNAL WORK AREA       */
         XC    WORK(4),WORK                                        0036
*   CARDPTR=STMTPTR;                /* LOCAL POINTER TO INPUT CARD   */
         L     @10,@PC00001+4                                      0037
         L     CARDPTR,STMTPTR(,@10)                               0037
*   OPOFF=0;                        /* ZERO THE OPERAND OFFSET       */
*                                                                  0038
         MVI   OPOFF(HTPTR),X'00'                                  0038
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR TYPE OF JCL CARD. NOTE THAT MODULE IKJEFF05 DOES A  */
*   /* PRE-SCAN AND PROCESSES DATA CARDS ITSELF, FOR EFFICIENCY      */
*   /* (DUPLICATION OF LINES 283600-352000 AND 742932,742936). ALL   */
*   /* THE ABOVE LINES ARE STILL NEEDED IN MODULE IKJEFF07 AS PART OF*/
*   /* THE JCL CARD PROCESSING.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0039
*   IF HTDLMSW=OFF×CCONEX=ON THEN   /* CHECK FOR DLM= NOT FOUND ON A
*                                      PRIOR // DD * OR DD DATA CARD
*                                      OR CONTINUATION OF A // CARD  */
         TM    HTDLMSW(HTPTR),B'10000000'                          0039
         BZ    @RT00039                                            0039
         TM    CCONEX(HTPTR),B'10000000'                           0039
         BNO   @RF00039                                            0039
@RT00039 DS    0H                                                  0040
*NODLM:                             /* NORMAL CASE CODE              */
*     DO;                                                          0040
*                                                                  0040
NODLM    DS    0H                                                  0041
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR // JCL CARD                                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0041
*       IF CARD(1:2)='//' THEN      /* MAKE BASIC TEST TO DISTINGUISH
*                                      BETWEEN JCL AND NON-JCL STMTS */
         CLC   CARD(2,CARDPTR),@CC00225                            0041
         BE    @RT00041                                            0041
*         GO TO JCL;                /* SPECIAL PROCESSING FOR JCL    */
*                                                                  0043
*       /*************************************************************/
*       /*                                                           */
*       /* SLASH-ASTERISK CARD                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0043
*       IF CARD(1:2)='/*' THEN                                     0043
         CLC   CARD(2,CARDPTR),@CC00227                            0043
         BNE   @RF00043                                            0043
*         DO;                                                      0044
*           IF CARD(3)=' ' THEN     /* NOTE - JOB ENTRY SUBSYSTEM  0045
*                                      CARDS MAY BE SLASH-ASTERISK-
*                                      NONBLANK               @Y02064*/
         CLI   CARD+2(CARDPTR),C' '                                0045
         BNE   @RF00045                                            0045
*             DO;                                                  0046
*                                                                  0046
*               /*****************************************************/
*               /*                                                   */
*               /* SLASH-ASTERISK-BLANK DELIMITER CARD               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0047
*               IF CDATA=ON THEN    /* THIS SLASH-ASTERISK-BLANK CARD
*                                      WAS USED AS A DELIMITER, SO 0047
*                                      COPY THE DATA SWITCH, IF ANY
*                                      -- ALWAYS SET DELIMITER SWITCH
*                                      ON                            */
         TM    CDATA(HTPTR),B'01000000'                            0047
         BNO   @RF00047                                            0047
*                 WDATA=ON;                                        0048
         OI    WDATA,B'01000000'                                   0048
*               WDELIM=ON;                                         0049
@RF00047 OI    WDELIM,B'10000000'                                  0049
*             END;                                                 0050
*                                                                  0050
*           /*********************************************************/
*           /*                                                       */
*           /* SLASH-ASTERISK-NONBLANK JOB ENTRY SUBSYSTEM CONTROL   */
*           /* CARD                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0051
*           ELSE                                                   0051
*             IF CDDDATA=ON×CDDAST=ON THEN/* IF THIS CARD IS IN A  0051
*                                      DATA STREAM                   */
         B     @RC00045                                            0051
@RF00045 TM    CDDDATA(HTPTR),B'11000000'                          0051
         BNZ   @RT00051                                            0051
*               GO TO SETDATA;      /* DON'T DO ANY JCL CHECKING - 0052
*                                      JUST PROCESS AS DATA          */
*           GO TO CHKCON;           /* GO CHECK FOR CONTINUATION   0053
*                                      EXPECTED FOR SLASH-ASTERISK 0053
*                                      CARD                   @Y02064*/
         B     CHKCON                                              0053
*         END;                                                     0054
*     END NODLM;                                                   0055
*                                                                  0056
*   /*****************************************************************/
*   /*                                                               */
*   /* DLM= DATA CARD (COULD BE //)                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0056
*   ELSE                            /* KNOW HTDLMSW IS ON            */
*     DO;                                                          0056
*                                                                  0056
         B     @RC00039                                            0056
@RF00039 DS    0H                                                  0057
*       /*************************************************************/
*       /*                                                           */
*       /* HAVE FOUND THE DLM= DELIMITER?                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0057
*       IF CARD(1:2)=HTDLM×(CDDAST=ON&CARD(1:2)='//') THEN/* NOTE  0057
*                                      THAT // CAN ALSO BE DELIM FOR
*                                      // DD * DATA STREAM           */
         CLC   CARD(2,CARDPTR),HTDLM(HTPTR)                        0057
         BE    @RT00057                                            0057
         TM    CDDAST(HTPTR),B'10000000'                           0057
         BNO   @RF00057                                            0057
         CLC   CARD(2,CARDPTR),@CC00225                            0057
         BNE   @RF00057                                            0057
@RT00057 DS    0H                                                  0058
*         DO;                       /* IF SO,                        */
*           HTDLMSW=OFF;            /* STOP LOOKING FOR IT           */
         NI    HTDLMSW(HTPTR),B'01111111'                          0059
*           IF CARD(1:2)='//' THEN  /* IF JCL CARD (AS WELL AS A DLM=
*                                      DELIMITER)                    */
         CLC   CARD(2,CARDPTR),@CC00225                            0060
         BE    @RT00060                                            0060
*             GO TO JCL;            /* SCAN THE JCL CARD             */
*           ELSE                    /* IF ANY OTHER DELIMITER        */
*             DO;                                                  0062
*               WDATA=ON;           /* SAY THIS IS A DATA CARD       */
*               WDELIM=ON;          /* SAY THIS IS A DELIMITER CARD  */
         OI    WDATA,B'11000000'                                   0064
*               GO TO CHKCON;       /* TAKE NORMAL EXIT FROM IKJEFF07*/
         B     CHKCON                                              0065
*             END;                                                 0066
*         END;                      /* END OF DLM=VALUE FOUND CODE   */
*       ELSE                        /* THIS CARD WASN'T THE DELIMITER
*                                      FOR DLM=                      */
*         GO TO SETDATA;            /* PROCESS CARD AS DATA          */
*     END;                                                         0069
*                                                                  0070
*   /*****************************************************************/
*   /*                                                               */
*   /* DATA CARD                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0070
*   IF CDDAST=ON THEN               /* DATA SWITCH (DD *) ON         */
@RC00039 TM    CDDAST(HTPTR),B'10000000'                           0070
         BO    @RT00070                                            0070
*     GO TO SETDATA;                /* FINISH PROCESSING DATA CARD   */
*   IF CDDDATA=ON THEN              /* DATA SWITCH (DD DATA) ON      */
         TM    CDDDATA(HTPTR),B'01000000'                          0072
         BO    @RT00072                                            0072
*     GO TO SETDATA;                /* FINISH PROCESSING DATA CARD   */
*   WDDAST=ON;                      /* IF NO TYPE OF DATA SWITCH IS
*                                      ON, SYSTEM GENERATES A //SYSIN
*                                      DD * STMT, SO SET SWITCHES TO
*                                      SHOW SUCH A 'GENERATION'      */
         OI    WDDAST,B'10000000'                                  0074
*   WDATA=ON;                                                      0075
*                                                                  0075
         OI    WDATA,B'01000000'                                   0075
*   /*****************************************************************/
*   /*                                                               */
*   /* IF EXPECTING CONTINUATION, TURN ON ERROR SWITCH               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0076
*CHKCON:                            /* CONTINUATION IS NOT EXPECTED-
*                                      ENTERED FROM EITHER NODLM CODE
*                                      FOR SLASH-ASTERISK OR DLM CODE
*                                      IF DLM=DELIMETER FOUND        */
*   IF CCONEX=ON THEN               /* IF CONTINUATION EXPECTED TURN
*                                      ERROR SWITCH ON               */
CHKCON   TM    CCONEX(HTPTR),B'10000000'                           0076
         BNO   @RF00076                                            0076
*     WCONERR=ON;                                                  0077
*                                                                  0077
         OI    WCONERR,B'00100000'                                 0077
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR JOB ENTRY SUBSYSTEM CONTROL CARD                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0078
*   IF CARD(1:2)='/*'&CARD(3)^=' ' THEN/* SCAN FOR JOB ENTRY       0078
*                                      SUBSYSTEM CONTROL CARD. NOTE
*                                      JES3 CARD COULD BE          0078
*                                      SLASH-SLASH-ASTERISK, INSTEAD.
*                                                             @Y02064*/
@RF00076 CLC   CARD(2,CARDPTR),@CC00227                            0078
         BNE   @RF00078                                            0078
         CLI   CARD+2(CARDPTR),C' '                                0078
         BE    @RF00078                                            0078
*     DO;                           /*                       @ZA06659*/
*       WJES=ON;                    /* ON IF SLASH-ASTERISK-NONBLANK
*                                      CARD                   @Y02064*/
         OI    WJES,B'10000000'                                    0080
*       K=2;                        /* INITIALIZE COLUMN     @ZA06659*/
         LA    K,2                                                 0081
*       CALL SKIPTO;                /* GO TO NEXT BLANK      @ZA06659*/
         BAL   @14,SKIPTO                                          0082
*       CALL SKIPOVER;              /* SKIP OVER BLANKS TO VERB    0083
*                                                            @ZA06659*/
         BAL   @14,SKIPOVER                                        0083
*       OPOFF=K;                    /* SAVE OPERAND OFFSET FOR     0084
*                                      INSTALLATION EXIT     @ZA06659*/
         STC   K,OPOFF(,HTPTR)                                     0084
*     END;                          /* END JES LOGIC         @ZA06659*/
*   GO TO UPDATE;                   /* EXIT FROM IKJEFF07            */
*                                                                  0086
         B     UPDATE                                              0086
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP HISTORY TABLE INFORMATION FOR DATA CARD                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0087
*SETDATA:                           /* ENTER FOR DD DATA OR DD * DATA*/
*   WDTYPE=CDTYPE;                  /* COPY TYPE OF DATA             */
SETDATA  MVC   WDTYPE(1),CDTYPE(HTPTR)                             0087
*   WDATA=ON;                       /* INDICATE DATA CARD            */
         OI    WDATA,B'01000000'                                   0088
*   GO TO UPDATE;                   /* AND EXIT                      */
         B     UPDATE                                              0089
*                                                                  0090
*   /*****************************************************************/
*   /*                                                               */
*   /* ANY // CARD                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0090
*JCL:                               /* COME HERE TO START PROCESSING
*                                      FOR SLASH-SLASH JCL CARDS     */
*   IF CDDDATA=ON THEN                                             0090
JCL      TM    CDDDATA(HTPTR),B'01000000'                          0090
         BNO   @RF00090                                            0090
*     DO;                           /* IF DD DATA SW IS ON AND     0091
*                                      CONTINUATION IS NOT EXPECTED,
*                                      THEN THIS IS THE DATA ITSELF  */
*       IF CCONEX=OFF THEN          /* IF DON'T NEED CONTINUATION OF
*                                      // DD DATA CARD               */
         TM    CCONEX(HTPTR),B'10000000'                           0092
         BZ    @RT00092                                            0092
*         GO TO SETDATA;            /* TREAT // CARD AS DATA CARD    */
*     END;                          /* IF CDDAST IS ON AND CCONEXP IS
*                                      OFF SHOULD GENERATE A       0094
*                                      SLASH-AST                     */
*   K=2;                            /* INITIALIZE KOLUMN INDEX       */
@RF00090 LA    K,2                                                 0095
*   IF CCONEX=ON THEN               /* IF CONTINUATION       @ZA06659*/
         TM    CCONEX(HTPTR),B'10000000'                           0096
         BNO   @RF00096                                            0096
*     CCOMMENT=OFF;                 /* DON'T PROPAGATE COMMENT INFO
*                                                            @ZA06659*/
*                                                                  0097
         NI    CCOMMENT(HTPTR),B'11111110'                         0097
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR //* CARD                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0098
*   IF CARD(3)='*' THEN             /* CHECK FOR //* (COMMENT CARD)  */
@RF00096 CLI   CARD+2(CARDPTR),C'*'                                0098
         BNE   @RF00098                                            0098
*     DO;                           /*                       @ZA06659*/
*       IF CCONEX=ON THEN           /* ALLOWED TO HAVE COMMENT WITHIN
*                                      CONTINUATION IN MVS   @ZA06659*/
         TM    CCONEX(HTPTR),B'10000000'                           0100
         BNO   @RF00100                                            0100
*         DO;                       /*                       @ZA06659*/
*           WORK=CURRJCL;           /* KEEP STATEMENT INFO   @ZA06659*/
         MVC   WORK(4),CURRJCL(HTPTR)                              0102
*           WVERBCOP=ON;            /* REMEMBER VERB IS BEING      0103
*                                      CONTINUED             @ZA06659*/
         OI    WVERBCOP,B'00001000'                                0103
*         END;                      /* END CONTIN. LOGIC     @ZA06659*/
*       CALL SKIPTO;                /* GO TO NEXT BLANK      @ZA06659*/
@RF00100 BAL   @14,SKIPTO                                          0105
*       CALL SKIPOVER;              /* SKIP OVER BLANKS TO VERB    0106
*                                                            @ZA06659*/
         BAL   @14,SKIPOVER                                        0106
*       OPOFF=K;                    /* SAVE OPERAND OFFSET FOR     0107
*                                      INSTALLATION EXIT     @ZA06659*/
         STC   K,OPOFF(,HTPTR)                                     0107
*       WCOMMENT=ON;                /* NOTE COULD ALSO BE JES3     0108
*                                      CONTROL CARD           @Y02064*/
         OI    WCOMMENT,B'00000001'                                0108
*       GO TO UPDATE;               /* UPDATE HISTORY TABLE FOR JCL
*                                      CARD                          */
         B     UPDATE                                              0109
*     END;                          /* END COMMENT LOGIC     @ZA06659*/
*                                                                  0110
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR // CARD WITH NAME FIELD                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0111
*   IF CARD(3)^=' ' THEN            /* CHECK FOR A NAME ON // CARD   */
@RF00098 CLI   CARD+2(CARDPTR),C' '                                0111
         BE    @RF00111                                            0111
*     DO;                                                          0112
*       WNAME=ON;                                                  0113
         OI    WNAME,B'00010000'                                   0113
*       IF CCONEX=ON THEN           /* NOT ALLOWED TO HAVE NAME FIELD
*                                      ON CONTINUATION CARD          */
         TM    CCONEX(HTPTR),B'10000000'                           0114
         BNO   @RF00114                                            0114
*         WCONERR=ON;               /* INDICATE CONTINUATION ERROR   */
         OI    WCONERR,B'00100000'                                 0115
*     END;                                                         0116
@RF00114 DS    0H                                                  0117
*                                                                  0117
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOK FOR VERB FIELD                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0117
*   CALL SKIPTO;                    /* GO TO NEXT BLANK              */
@RF00111 BAL   @14,SKIPTO                                          0117
*   CALL SKIPOVER;                  /* SKIP OVER BLANKS TO VERB      */
*                                                                  0118
         BAL   @14,SKIPOVER                                        0118
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NO VERB FIELD                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0119
*   IF K=0 THEN                     /* IF NO NEXT (VERB) FIELD       */
         LTR   K,K                                                 0119
         BNZ   @RF00119                                            0119
*     DO;                                                          0120
*                                                                  0120
*       /*************************************************************/
*       /*                                                           */
*       /* 'NOTHING' CARD - //NAME NOOPERAND                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0121
*       IF WNAME=ON THEN            /* THEN IF NAMED, IT IS NOTHING  */
         TM    WNAME,B'00010000'                                   0121
         BNO   @RF00121                                            0121
*         DO;                                                      0122
*           WNOTHING=ON;            /* NOTE WCONERR SWITCH ALREADY ON
*                                      IF EXPECTED CONTINUATION CARD */
         OI    WNOTHING,B'00000010'                                0123
*           GO TO UPDATE;           /* EXIT FROM IKJEFF07            */
         B     UPDATE                                              0124
*         END;                                                     0125
*                                                                  0125
*       /*************************************************************/
*       /*                                                           */
*       /* NULL CARD                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0126
*       IF CCONEX=OFF THEN          /* THEN IF BLANK, AND NOT      0126
*                                      CONTINUATION                  */
@RF00121 TM    CCONEX(HTPTR),B'10000000'                           0126
         BNZ   @RF00126                                            0126
*         DO;                                                      0127
*           WNULL=ON;               /* IT IS NULL                    */
         OI    WNULL,B'00100000'                                   0128
*           GO TO UPDATE;           /* EXIT FROM IKJEFF07            */
         B     UPDATE                                              0129
*         END;                                                     0130
*       ELSE                        /* NULL CARD USED FOR CONTINUING */
*         DO;                                                      0131
@RF00126 DS    0H                                                  0132
*           WVERB=CVERB;            /* THEN BLANK AND CONTINUATION   */
         MVC   WVERB(2),CVERB(HTPTR)                               0132
*           WVERBCOP=ON;            /* COPY THE VERB                 */
         OI    WVERBCOP,B'00001000'                                0133
*           WDTYPE=CDTYPE;                                         0134
         MVC   WDTYPE(1),CDTYPE(HTPTR)                             0134
*           IF COPCONEX=ON THEN     /* ERROR IF OPERAND CONTINUATION */
         TM    COPCONEX(HTPTR),B'01000000'                         0135
         BNO   @RF00135                                            0135
*             WCONERR=ON;           /* EXPECTED BUT NOT FOUND        */
         OI    WCONERR,B'00100000'                                 0136
*           GO TO SCANEXIT;         /* END SCAN OF // NULL CARD      */
         B     SCANEXIT                                            0137
*         END;                                                     0138
*     END;                          /* END CODE FOR NO NEXT (VERB) 0139
*                                      FIELD                         */
*                                                                  0140
*   /*****************************************************************/
*   /*                                                               */
*   /* // CARD WITH VERB FIELD                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0140
*   A=K+3;                                                         0140
@RF00119 LA    A,3                                                 0140
         ALR   A,K                                                 0140
*   IF CARD(K:A)='JOB ' THEN        /* VERB = JOB                    */
         LR    @10,A                                               0141
         SLR   @10,K                                               0141
         LR    @01,CARDPTR                                         0141
         ALR   @01,K                                               0141
         BCTR  @01,0                                               0141
         EX    @10,@SC00299                                        0141
         BNE   @RF00141                                            0141
*     DO;                                                          0142
*       IF WNAME=ON THEN            /* NEED TO SAVE THE JOB NAME FOR
*                                      USE IN MESSAGES               */
         TM    WNAME,B'00010000'                                   0143
         BNO   @RF00143                                            0143
*         DO;                                                      0144
*           IF CCOMCON='1'B THEN    /* IF LAST STMT SAYS THIS SHOULD
*                                      BE TREATED AS A COMMENT       */
         TM    CCOMCON(HTPTR),B'00000100'                          0145
         BO    @RT00145                                            0145
*             GO TO SCANOP;         /* FORGET THE NAME               */
*           NAME=' ';               /* BLANK OUT THE RECEIVING FIELD
*                                      FOR THE STMT NAME             */
         MVI   NAME+1,C' '                                         0147
         MVC   NAME+2(6),NAME+1                                    0147
         MVI   NAME,C' '                                           0147
*           A=K-1;                                                 0148
         LR    A,K                                                 0148
         BCTR  A,0                                                 0148
*           IF K>10 THEN            /* MAXIMUM NAME LENGTH IS 8      */
         C     K,@CF00240                                          0149
         BNH   @RF00149                                            0149
*             NAME=CARD(3:10);                                     0150
         MVC   NAME(8),CARD+2(CARDPTR)                             0150
*           ELSE                    /* PICK UP SHORTER NAME          */
*             NAME=CARD(3:A);                                      0151
         B     @RC00149                                            0151
@RF00149 MVI   NAME+1,C' '                                         0151
         MVC   NAME+2(6),NAME+1                                    0151
         LR    @10,A                                               0151
         SL    @10,@CF00106                                        0151
         EX    @10,@SM00301                                        0151
*           WJOB=ON;                                               0152
@RC00149 OI    WJOB,B'00010000'                                    0152
*           JOBNAME=NAME;           /* SAVE THE NAME ON THE JOB CARD */
         L     @10,@PC00001+8                                      0153
         MVC   JOBNAME(8,@10),NAME                                 0153
*           GO TO SCANOP;           /* NOW SCAN THE OPERAND FIELD    */
         B     SCANOP                                              0154
*         END;                                                     0155
*     END;                                                         0156
@RF00143 DS    0H                                                  0157
*   IF WNAME=OFF THEN               /* IF NO NAME FIELD ON THIS // 0157
*                                      CARD                          */
@RF00141 TM    WNAME,B'00010000'                                   0157
         BNZ   @RF00157                                            0157
*     DO;                                                          0158
*       IF CCONEX=OFF THEN          /* IF NOT CONTINUATION           */
         TM    CCONEX(HTPTR),B'10000000'                           0159
         BZ    @RT00159                                            0159
*         GO TO CHKEXEC;            /* STILL CHECK THE VERB FIELD    */
*       WVERB=CVERB;                /* IF NO NAME AND CONTINUED      */
         MVC   WVERB(2),CVERB(HTPTR)                               0161
*       WDTYPE=CDTYPE;              /* COPY DATA TYPE                */
         MVC   WDTYPE(1),CDTYPE(HTPTR)                             0162
*       WVERBCOP=ON;                /* INDICATE VALID CONTINUATION   */
         OI    WVERBCOP,B'00001000'                                0163
*       GO TO CHKOP16;              /* CHECK FOR VALID OPERAND       */
         B     CHKOP16                                             0164
*     END;                                                         0165
*CHKEXEC:                           /* CHECK FOR VERB = EXEC         */
*   A=K+4;                                                         0166
@RF00157 DS    0H                                                  0166
CHKEXEC  LA    A,4                                                 0166
         ALR   A,K                                                 0166
*   IF CARD(K:A)='EXEC ' THEN       /* EXEC                          */
         LR    @10,A                                               0167
         SLR   @10,K                                               0167
         LR    @01,CARDPTR                                         0167
         ALR   @01,K                                               0167
         BCTR  @01,0                                               0167
         EX    @10,@SC00303                                        0167
         BNE   @RF00167                                            0167
*     DO;                                                          0168
*       WEXEC=ON;                                                  0169
         OI    WEXEC,B'00001000'                                   0169
*       GO TO SCANOP;               /* NOW CHECK OPERAND FIELD       */
         B     SCANOP                                              0170
*     END;                                                         0171
*   A=K+2;                                                         0172
@RF00167 LA    A,2                                                 0172
         ALR   A,K                                                 0172
*   IF CARD(K:A)^='DD ' THEN        /* CHECK FOR NOT DD              */
         LR    @10,A                                               0173
         SLR   @10,K                                               0173
         LR    @01,CARDPTR                                         0173
         ALR   @01,K                                               0173
         BCTR  @01,0                                               0173
         EX    @10,@SC00305                                        0173
         BE    @RF00173                                            0173
*     DO;                                                          0174
*       WCOMMAND=ON;                /* IF A COMMAND (DEFAULT VERB  0175
*                                      TYPE - COULD BE PROC OR PEND
*                                                            @ZA06659*/
         OI    WCOMMAND,B'00000010'                                0175
*     END;                          /* NOW CHECK OPERAND     @ZA06659*/
*   ELSE                            /* DD                            */
*     WDD=ON;                                                      0177
         B     @RC00173                                            0177
@RF00173 OI    WDD,B'00000100'                                     0177
*                                                                  0178
*   /*****************************************************************/
*   /*                                                               */
*   /* // CARD WITH OPERAND FIELD                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0178
*SCANOP:                                                           0178
*   CALL SKIPTO;                    /* GO TO NEXT BLANK              */
@RC00173 DS    0H                                                  0178
SCANOP   BAL   @14,SKIPTO                                          0178
*   CALL SKIPOVER;                  /* GO TO NEXT (OPERAND) FIELD    */
*                                                                  0179
         BAL   @14,SKIPOVER                                        0179
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT IF NO OPERAND FIELD                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0180
*   IF K=0 THEN                     /* IF NO OPERAND FIELD           */
         LTR   K,K                                                 0180
         BZ    @RT00180                                            0180
*     GO TO SCANEXIT;               /* CLEAN UP AND EXIT             */
*   GO TO CHKOP;                    /* GO CHECK OPERAND              */
*                                                                  0182
         B     CHKOP                                               0182
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS CONTINUATION CARDS HERE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0183
*CHKOP16:                           /* CONTINUATIONS COME HERE --  0183
*                                      SHOULD BE IN OR PRIOR TO COL16*/
*                                                                  0183
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR IF DON'T EXPECT OPERAND CONTINUATION                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0183
*   IF COPCONEX=OFF THEN                                           0183
CHKOP16  TM    COPCONEX(HTPTR),B'01000000'                         0183
         BZ    @RT00183                                            0183
*     GO TO SCANEXIT;               /* CLEAN UP AND EXIT             */
*                                                                  0184
*   /*****************************************************************/
*   /*                                                               */
*   /* ERROR IF CONTINUATION STARTS AFTER COLUMN 16                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0185
*   IF K>16 THEN                    /* THIS IS A CONERR IF THE     0185
*                                      OPERAND CONTINUATION STARTS 0185
*                                      BEYOND COL 16 -- THE READER/
*                                      INTERPRETER WILL THINK IT A 0185
*                                      COMMENT WHEN IT IS NOT        */
         C     K,@CF00249                                          0185
         BNH   @RF00185                                            0185
*     DO;                                                          0186
*       WCONERR=ON;                                                0187
         OI    WCONERR,B'00100000'                                 0187
*       GO TO SCANEXIT;             /* CLEAN UP AND EXIT             */
         B     SCANEXIT                                            0188
*     END;                                                         0189
*                                                                  0190
*   /*****************************************************************/
*   /*                                                               */
*   /* RE-SCAN OPERAND FIELD TO CHECK FOR PAIRED QUOTES              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0190
*CHKOP:                                                            0190
*   S=K;                            /* HOLD START OF FIELD           */
@RF00185 DS    0H                                                  0190
CHKOP    LR    S,K                                                 0190
*   OPOFF=K;                        /* MARK THE OPERAND OFFSET       */
         STC   K,OPOFF(,HTPTR)                                     0191
*MOREQ:                             /* FIND END OF FIELD AND QUOTES  */
*   Q=K;                            /* HOLD START OF FIELD           */
MOREQ    LR    Q,K                                                 0192
*   CALL SKIPTO;                    /* SKIP K TO NEXT BLANK          */
         BAL   @14,SKIPTO                                          0193
*   IF K=0 THEN                     /* IF NO BLANK FOUND             */
         LTR   K,K                                                 0194
         BNZ   @RF00194                                            0194
*     L=72;                                                        0195
         LA    L,72                                                0195
*   ELSE                            /* BLANK BEFORE OR AT END        */
*     L=K;                          /* FIND BLANK OR END             */
         B     @RC00194                                            0196
@RF00194 LR    L,K                                                 0196
*   K=Q;                            /* THEN START OVER AND           */
@RC00194 LR    K,Q                                                 0197
*   CALL SKIPTOQ;                   /* FIND A QUOTE                  */
         BAL   @14,SKIPTOQ                                         0198
*   IF K=0 THEN                     /* NO MORE BLANKS ON CARD        */
         LTR   K,K                                                 0199
         BZ    @RT00199                                            0199
*     GO TO NOQ;                    /* SO HAVE NO QUOTE              */
*   IF L<K THEN                     /* OR BLANK COMES FIRST          */
         CR    L,K                                                 0201
         BL    @RT00201                                            0201
*     GO TO NOQ;                    /* CONSIDER HAVE NO QUOTE        */
*   K=K+1;                          /* PT TO CHAR AFTER THE QUOTE    */
         AL    K,@CF00042                                          0203
*   CALL SKIPTOQ;                   /* FIND NEXT QUOTE               */
         BAL   @14,SKIPTOQ                                         0204
*   IF K=0 THEN                     /* IF NO QUOTE FOUND             */
         LTR   K,K                                                 0205
         BZ    @RT00205                                            0205
*     GO TO NOQ;                    /* CONTINUE                      */
*   GO TO MOREQ;                    /* OTHERWISE GO AGAIN            */
*                                                                  0207
         B     MOREQ                                               0207
*   /*****************************************************************/
*   /*                                                               */
*   /* // CARD ENDING WITH COMMA                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0208
*NOQ:                               /* S = START OF FIELD. L = CHAR
*                                      AFTER FIELD                   */
*   A=L-1;                                                         0208
NOQ      LR    A,L                                                 0208
         BCTR  A,0                                                 0208
*   IF CARD(A)=COMMA THEN           /* IF THE OPERAND ENDS WITH A  0209
*                                      COMMA THEN SET THE OPERAND CON
*                                      EXPECTED SW ON                */
         LR    @10,CARDPTR                                         0209
         ALR   @10,A                                               0209
         BCTR  @10,0                                               0209
         CLI   CARD(@10),C','                                      0209
         BNE   @RF00209                                            0209
*     DO;                                                          0210
*       WOPCONEX=ON;                                               0211
*       WCONEX=ON;                                                 0212
         OI    WOPCONEX,B'11000000'                                0212
*     END;                                                         0213
*                                                                  0214
*/********************************************************************/
*/*          // DD *                                                 */
*/*      OR  // DD DATA   CARD                                       */
*/********************************************************************/
*                                                                  0214
*   IF WDD=ON THEN                  /* IF DD CARD (OR DD           0214
*                                      CONTINUATION)                 */
@RF00209 TM    WDD,B'00000100'                                     0214
         BNO   @RF00214                                            0214
*DDCODE:                            /* SPECIAL PROCESSING FOR OPERAND
*                                      OF DD CARD                    */
*     DO;                                                          0215
DDCODE   DS    0H                                                  0216
*       IF WVERBCOP=OFF THEN        /* CHECK FOR DD * OR DD DATA IF
*                                      NOT A CONTINUATION CARD       */
         TM    WVERBCOP,B'00001000'                                0216
         BNZ   @RF00216                                            0216
*         DO;                                                      0217
*           IF CARD(S)='*' THEN     /* CHECK FOR // DD *             */
         LR    @10,CARDPTR                                         0218
         ALR   @10,S                                               0218
         BCTR  @10,0                                               0218
         CLI   CARD(@10),C'*'                                      0218
         BNE   @RF00218                                            0218
*             WDDAST=ON;                                           0219
         OI    WDDAST,B'10000000'                                  0219
*           ELSE                    /* CHECK FOR // DD DATA          */
*             DO;                                                  0220
         B     @RC00218                                            0220
@RF00218 DS    0H                                                  0221
*               L=S+3;                                             0221
         LA    L,3                                                 0221
         ALR   L,S                                                 0221
*               IF CARD(S:L)='DATA' THEN/* IF FOUND // DD DATA       */
         LR    @10,L                                               0222
         SLR   @10,S                                               0222
         LR    @05,CARDPTR                                         0222
         ALR   @05,S                                               0222
         BCTR  @05,0                                               0222
         EX    @10,@SC00308                                        0222
         BNE   @RF00222                                            0222
*                 WDDDATA=ON;       /* REMEMBER IT                   */
         OI    WDDDATA,B'01000000'                                 0223
*             END;                                                 0224
@RF00222 DS    0H                                                  0225
*         END;                                                     0225
@RC00218 DS    0H                                                  0226
*       IF(WDDAST=ON×WDDDATA=ON)&HTDLMSW=OFF THEN/* IF THIS IS A DD *
*                                      OR DD DATA CARD AND HAVEN'T 0226
*                                      FOUND A DLM= KEYWORD YET    0226
*                                      (COULD BE CONTINUATION OF THE
*                                      DD CARD)                      */
*                                                                  0226
@RF00216 TM    WDDAST,B'11000000'                                  0226
         BZ    @RF00226                                            0226
         TM    HTDLMSW(HTPTR),B'10000000'                          0226
         BNZ   @RF00226                                            0226
*         /***********************************************************/
*         /*                                                         */
*         /* FF07SDLM CODE - SEARCHES FOR DLM= KEYWORD ON DD CARD    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0227
*CHKDLM:                                                           0227
*         DO;                                                      0227
CHKDLM   DS    0H                                                  0228
*           DLMWORK=DLMWORK&&DLMWORK;/* ZERO OUT SWITCH AREA         */
         XC    DLMWORK(1),DLMWORK                                  0228
*           DO S=S TO A BY 1 WHILE WDLMFND=OFF;/* SEARCH IS FROM   0229
*                                      FIRST TO LAST COLUMN OF     0229
*                                      OPERAND FIELD, AND END SEARCH
*                                      WHEN FIND DLM=                */
         B     @DE00229                                            0229
@DL00229 TM    WDLMFND,B'00000001'                                 0229
         BNZ   @DC00229                                            0229
*             PREVCOL=S-1;          /* WILL CHECK COLUMN BEFORE DLM= */
         LR    PREVCOL,S                                           0230
         BCTR  PREVCOL,0                                           0230
*             D=S+3;                /* POINT TO END CHARACTER OF DLM=*/
*                                                                  0231
         LA    D,3                                                 0231
         ALR   D,S                                                 0231
*             /*******************************************************/
*             /*                                                     */
*             /* CODE FOR 'DLM=' FOUND                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0232
*             IF CARD(S:D)='DLM=' THEN/* FIRST CHECK FOR DLM=KEYWORD */
         LR    @10,D                                               0232
         SLR   @10,S                                               0232
         LR    @09,CARDPTR                                         0232
         ALR   @09,S                                               0232
         BCTR  @09,0                                               0232
         EX    @10,@SC00310                                        0232
         BNE   @RF00232                                            0232
*               IF CARD(PREVCOL)=COMMA×CARD(PREVCOL)=BLANK THEN/*  0233
*                                      O.K. IF ',DLM=' OR ' DLM='    */
         LR    @10,CARDPTR                                         0233
         ALR   @10,PREVCOL                                         0233
         BCTR  @10,0                                               0233
         CLI   CARD(@10),C','                                      0233
         BE    @RT00233                                            0233
         LR    @10,CARDPTR                                         0233
         ALR   @10,PREVCOL                                         0233
         BCTR  @10,0                                               0233
         CLI   CARD(@10),C' '                                      0233
         BNE   @RF00233                                            0233
@RT00233 DS    0H                                                  0234
*DLMCODE:                           /* SPECIAL PROCESSING FOR DLM=   */
*                 DO;                                              0234
DLMCODE  DS    0H                                                  0235
*                   WDLMFND=ON;     /* INDICATE END OF SEARCH        */
         OI    WDLMFND,B'00000001'                                 0235
*                   D=D+1;          /* POINT TO VALUE (MUST CHECK IT
*                                      FOR ERRORS)                   */
*                                                                  0236
         LA    @10,1                                               0236
         ALR   D,@10                                               0236
*                   /*************************************************/
*                   /*                                               */
*                   /* DLM= VALUE IN QUOTES (CONTAINS SPECIAL        */
*                   /* CHARACTERS)                                   */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0237
*                   IF CARD(D)=QUOTE THEN                          0237
         LR    @09,CARDPTR                                         0237
         ALR   @09,D                                               0237
         BCTR  @09,0                                               0237
         CLI   CARD(@09),C''''                                     0237
         BNE   @RF00237                                            0237
*                     DO;                                          0238
*                       D=D+1;      /* SKIP OVER LEFT QUOTE          */
         ALR   D,@10                                               0239
*                       IF CARD(D)=QUOTE×CARD(D)=AMPRSAND THEN/*   0240
*                                      CHECK FOR AMPERSAND OR QUOTE
*                                      AS FIRST DLM= CHARACTER (THEY
*                                      NEED SPECIAL CHECKS, SINCE '
*                                      AND & ARE REPRESENTED AS '' 0240
*                                      AND && IN VALUE FIELD)        */
         LR    @10,CARDPTR                                         0240
         ALR   @10,D                                               0240
         BCTR  @10,0                                               0240
         CLI   CARD(@10),C''''                                     0240
         BE    @RT00240                                            0240
         LR    @10,CARDPTR                                         0240
         ALR   @10,D                                               0240
         BCTR  @10,0                                               0240
         CLI   CARD(@10),C'&&'                                     0240
         BNE   @RF00240                                            0240
@RT00240 DS    0H                                                  0241
*                         DO;                                      0241
*                           PREVCOL=D;/* SAVE THIS COLUMN NUMBER     */
         LR    PREVCOL,D                                           0242
*                           D=D+1;  /* SKIP DUPLICATE CHAR ON LEFT   */
         AL    D,@CF00042                                          0243
*                           IF CARD(PREVCOL)^=CARD(D) THEN/* IF NOT
*                                      DOUBLE QUOTE OR DOUBLE      0244
*                                      AMPERSAND                     */
         LR    @10,CARDPTR                                         0244
         ALR   @10,PREVCOL                                         0244
         BCTR  @10,0                                               0244
         LR    @09,CARDPTR                                         0244
         ALR   @09,D                                               0244
         BCTR  @09,0                                               0244
         CLC   CARD(1,@10),CARD(@09)                               0244
         BE    @RF00244                                            0244
*                             DLMERR=ON;/* BAD DLM= VALUE            */
         OI    DLMERR,B'01000000'                                  0245
*                         END;                                     0246
@RF00244 DS    0H                                                  0247
*                       IF DLMERR=OFF THEN/* IF NO ERROR YET         */
@RF00240 TM    DLMERR,B'01000000'                                  0247
         BNZ   @RF00247                                            0247
*CHAR2:                             /* CHECK SECOND CHAR OF VALUE    */
*                         DO;                                      0248
CHAR2    DS    0H                                                  0249
*                           N=D+1;  /* POINT TO SECOND DLM= CHAR     */
         LA    N,1                                                 0249
         ALR   N,D                                                 0249
*                           IF CARD(N)=QUOTE×CARD(N)=AMPRSAND THEN/*
*                                      CHECK FOR AMPERSAND OR QUOTE
*                                      AS SECOND DLM= CHARACTER      */
         LR    @10,CARDPTR                                         0250
         ALR   @10,N                                               0250
         BCTR  @10,0                                               0250
         CLI   CARD(@10),C''''                                     0250
         BE    @RT00250                                            0250
         LR    @10,CARDPTR                                         0250
         ALR   @10,N                                               0250
         BCTR  @10,0                                               0250
         CLI   CARD(@10),C'&&'                                     0250
         BNE   @RF00250                                            0250
@RT00250 DS    0H                                                  0251
*                             DO;                                  0251
*                               PREVCOL=N;/* SAVE THIS COLUMN NUMBER */
         LR    PREVCOL,N                                           0252
*                               N=N+1;/* SKIP DUPLICATE CHAR ON LEFT */
         AL    N,@CF00042                                          0253
*                               IF CARD(PREVCOL)^=CARD(N) THEN/* IF
*                                      NOT DOUBLE QUOTE OR DOUBLE  0254
*                                      AMPERSAND                     */
         LR    @10,CARDPTR                                         0254
         ALR   @10,PREVCOL                                         0254
         BCTR  @10,0                                               0254
         LR    @09,CARDPTR                                         0254
         ALR   @09,N                                               0254
         BCTR  @09,0                                               0254
         CLC   CARD(1,@10),CARD(@09)                               0254
         BE    @RF00254                                            0254
*                                 DLMERR=ON;/* BAD DLM= VALUE        */
         OI    DLMERR,B'01000000'                                  0255
*                             END;                                 0256
@RF00254 DS    0H                                                  0257
*                           IF DLMERR=OFF THEN/* IF NO ERROR, CHECK
*                                      FOR END                       */
@RF00250 TM    DLMERR,B'01000000'                                  0257
         BNZ   @RF00257                                            0257
*                             DO;                                  0258
*                               N=N+1;/* POINT TO CHAR AFTER DLM=  0259
*                                      VALUE                         */
         AL    N,@CF00042                                          0259
*                               IF CARD(N)^=QUOTE THEN/* NEED AN END
*                                      QUOTE AFTER THE VALUE         */
         LR    @10,CARDPTR                                         0260
         ALR   @10,N                                               0260
         BCTR  @10,0                                               0260
         CLI   CARD(@10),C''''                                     0260
         BE    @RF00260                                            0260
*                                 DLMERR=ON;/* REMEMBER HAVE BAD   0261
*                                      VALUE                         */
         OI    DLMERR,B'01000000'                                  0261
*                               ELSE/* IF ENTIRE DLM= VALUE O.K.     */
*                                 N=N+1;/* POINT TO COLUMN AFTER   0262
*                                      QUOTE                         */
         B     @RC00260                                            0262
@RF00260 AL    N,@CF00042                                          0262
*                             END;                                 0263
*                         END CHAR2;                               0264
*                     END;          /* END CODE FOR VALUE IN QUOTES  */
*                                                                  0265
*                   /*************************************************/
*                   /*                                               */
*                   /* DLM= VALUE NOT SPECIAL CHARACTERS             */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0266
*                   ELSE                                           0266
*                     DO;                                          0266
         B     @RC00237                                            0266
@RF00237 DS    0H                                                  0267
*                       DO I=DIM(DLMCH) TO 1 BY-1 WHILE DLMEND=OFF;/*
*                                      CHECK FOR FIRST CHARACTER   0267
*                                      ALPHAMERIC OR NATIONAL        */
         LA    I,39                                                0267
@DL00267 TM    DLMEND,B'10000000'                                  0267
         BNZ   @DC00267                                            0267
*                         IF CARD(D)=DLMCH(I) THEN/* EXIT IF MATCH   */
         LR    @10,CARDPTR                                         0268
         ALR   @10,D                                               0268
         BCTR  @10,0                                               0268
         LA    @09,DLMCH-1(I)                                      0268
         CLC   CARD(1,@10),0(@09)                                  0268
         BNE   @RF00268                                            0268
*                           DLMEND=ON;                             0269
         OI    DLMEND,B'10000000'                                  0269
*                       END;                                       0270
@RF00268 BCTR  I,0                                                 0270
         LTR   I,I                                                 0270
         BP    @DL00267                                            0270
@DC00267 DS    0H                                                  0271
*                       IF DLMEND=ON THEN/* IF FIRST CHAR O.K. CHECK
*                                      NEXT                          */
         TM    DLMEND,B'10000000'                                  0271
         BNO   @RF00271                                            0271
*                         DO;                                      0272
*                           N=D+1;  /* POINT TO SECOND CHAR          */
         LA    N,1                                                 0273
         ALR   N,D                                                 0273
*                           DO I=DIM(DLMCH) TO 1 BY-1 WHILE DLMEND=ON;
         LA    I,39                                                0274
@DL00274 TM    DLMEND,B'10000000'                                  0274
         BNO   @DC00274                                            0274
*                                   /* CHECK FOR VALID CHARACTER     */
*                             IF CARD(N)=DLMCH(I) THEN/* EXIT IF   0275
*                                      MATCH                         */
         LR    @10,CARDPTR                                         0275
         ALR   @10,N                                               0275
         BCTR  @10,0                                               0275
         LA    @09,DLMCH-1(I)                                      0275
         CLC   CARD(1,@10),0(@09)                                  0275
         BNE   @RF00275                                            0275
*                               DLMEND=OFF;                        0276
         NI    DLMEND,B'01111111'                                  0276
*                           END;                                   0277
@RF00275 BCTR  I,0                                                 0277
         LTR   I,I                                                 0277
         BP    @DL00274                                            0277
@DC00274 DS    0H                                                  0278
*                           IF DLMEND=OFF THEN/* IF BOTH CHARS O.K.  */
         TM    DLMEND,B'10000000'                                  0278
         BNZ   @RF00278                                            0278
*                             N=N+1;/* POINT TO CHAR AFTER VALUE     */
         AL    N,@CF00042                                          0279
*                           ELSE    /* IF SECOND CHAR BAD            */
*                             DLMERR=ON;/* REMEMBER                  */
         B     @RC00278                                            0280
@RF00278 OI    DLMERR,B'01000000'                                  0280
*                         END;      /* END OF CODE - FIRST CHAR O.K. */
*                       ELSE        /* IF FIRST CHAR BAD             */
*                         DLMERR=ON;/* REMEMBER                      */
         B     @RC00271                                            0282
@RF00271 OI    DLMERR,B'01000000'                                  0282
*                     END;          /* END CODE FOR NON-SPECIAL DLM= */
*                                                                  0283
@RC00271 DS    0H                                                  0284
*                   /*************************************************/
*                   /*                                               */
*                   /* IF NO ERRORS, SAVE DLM= VALUE                 */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0284
*                   IF DLMERR=OFF THEN/* PROCEED IF NO ERROR FOUND 0284
*                                      YET                           */
@RC00237 TM    DLMERR,B'01000000'                                  0284
         BNZ   @RF00284                                            0284
*                     DO;           /* - CHECK FOR DLM= KWD LEN O.K. */
*                       IF CARD(N)=BLANK×CARD(N)=COMMA THEN/* IF HAVE
*                                      VALID DLM= KEYWORD (AND VALUE)*/
         LR    @10,CARDPTR                                         0286
         ALR   @10,N                                               0286
         BCTR  @10,0                                               0286
         CLI   CARD(@10),C' '                                      0286
         BE    @RT00286                                            0286
         LR    @10,CARDPTR                                         0286
         ALR   @10,N                                               0286
         BCTR  @10,0                                               0286
         CLI   CARD(@10),C','                                      0286
         BNE   @RF00286                                            0286
@RT00286 DS    0H                                                  0287
*                         DO;                                      0287
*                           HTDLMSW=ON;/* INDICATE SEARCH FOR DELIM
*                                      NOW                           */
         OI    HTDLMSW(HTPTR),B'10000000'                          0288
*                           HTDLM=CARD(D:D+1);/* SAVE DLM= VALUE     */
         LR    @10,CARDPTR                                         0289
         ALR   @10,D                                               0289
         BCTR  @10,0                                               0289
         MVC   HTDLM(2,HTPTR),CARD(@10)                            0289
*                         END;                                     0290
*                     END;                                         0291
@RF00286 DS    0H                                                  0292
*                 END DLMCODE;      /* END CHECKING OF DLM= VALUE    */
@RF00284 DS    0H                                                  0293
*           END;                    /* END SCAN FOR DLM= KEYWORD     */
@RF00233 DS    0H                                                  0293
@RF00232 AL    S,@CF00042                                          0293
@DE00229 CR    S,A                                                 0293
         BNH   @DL00229                                            0293
@DC00229 DS    0H                                                  0294
*         END CHKDLM;               /* END SEARCH FOR DLM= KEYWORD   */
*     END DDCODE;                                                  0295
@RF00226 DS    0H                                                  0296
*                                                                  0296
*   /*****************************************************************/
*   /*                                                               */
*   /* END THE SCAN OF // CARD - DO SPECIAL PROCESSING IF            */
*   /* CONTINUATION                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0296
*SCANEXIT:                                                         0296
*   IF CARD(72)^=' ' THEN                                          0296
@RF00214 DS    0H                                                  0296
SCANEXIT CLI   CARD+71(CARDPTR),C' '                               0296
         BE    @RF00296                                            0296
*     WCONEX=ON;                    /* NEXT CARD SHOULD CONTINUE THIS
*                                      CARD                          */
         OI    WCONEX,B'10000000'                                  0297
*   IF CCOMCON='1'B THEN            /* PRIOR STMT SAYS THIS ONE    0298
*                                      SHOULD BECOME A COMMENT AND A
*                                      CONTINUATION CHECKED FOR -- 0298
*                                      THIS SITUATION ARISES WHEN  0298
*                                      PROMPTJOB HAS NO ROOM TO    0298
*                                      CHANGE A JOB CARD -- IT CALLS
*                                      GENJOB AND THEN TURNS THE   0298
*                                      ORIGINAL JOB CARD INTO A    0298
*                                      COMMENT, SO ALL FURTHER     0298
*                                      CONTINUATIONS OF THE ORIGINAL
*                                      MUST ALSO BECOME COMMENT CARDS
*                                      (COMMENTS CANNOT BY THEMSELVES
*                                      BE CONTINUED)                 */
@RF00296 TM    CCOMCON(HTPTR),B'00000100'                          0298
         BNO   @RF00298                                            0298
*     DO;                                                          0299
*       CARD(3:4)='* ';                                            0300
         MVC   CARD+2(2,CARDPTR),@CC00270                          0300
*       WCOMMENT='1'B;                                             0301
*       WJOB='0'B;                                                 0302
         OI    WCOMMENT,B'00000001'                                0302
         NI    WJOB,B'11101111'                                    0302
*       IF WCONEX='1'B THEN         /* IF THIS CARD IS CONTINUED     */
         TM    WCONEX,B'10000000'                                  0303
         BNO   @RF00303                                            0303
*         WCOMCON='1'B;             /* MAKE NEXT CARD A COMMENT, TOO */
         OI    WCOMCON,B'00000100'                                 0304
*     END;                                                         0305
*                                                                  0305
@RF00303 DS    0H                                                  0306
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE HISTORY TABLE FOR THIS CARD, THEN RETURN TO CALLER     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0306
*UPDATE:                            /* CURR BECOMES PRIOR AND WORK 0306
*                                      BECOMES CURR                  */
*   PRIORJCL=CURRJCL;                                              0306
@RF00298 DS    0H                                                  0306
UPDATE   MVC   PRIORJCL(4,HTPTR),CURRJCL(HTPTR)                    0306
*   CURRJCL=WORK;                                                  0307
         MVC   CURRJCL(4,HTPTR),WORK                               0307
*   INIDENT='0'B;                   /* INDICATE EXITED FROM THIS   0308
*                                      MODULE                        */
         NI    INIDENT(HTPTR),B'10111111'                          0308
*                                                                  0309
*/********************************************************************/
*/* INTERNAL PROCEDURES USED TO SCAN CARD                            */
*/********************************************************************/
*                                                                  0309
*SKIPTOQ:                                                          0309
*                                                                  0309
*   /*****************************************************************/
*   /*                                                               */
*   /* SKIPTOQ -- PROC TO SKIP K (COLUMN POINTER) TO A QUOTE         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0309
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0309
@EL00001 DS    0H                                                  0309
@EF00001 L     @00,@SIZDATD                                        0309
         LR    @01,@11                                             0309
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0309
         BR    @14                                                 0309
SKIPTOQ  DS    0H                                                  0310
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF
*                                      CARD                          */
         LTR   K,K                                                 0310
         BZ    @RF00310                                            0310
*     DO;                                                          0311
*       DO K=K TO ENDCOL;           /* SCAN COLUMNS OF CARD          */
         B     @DE00312                                            0312
@DL00312 DS    0H                                                  0313
*         IF CARD(K)='''' THEN      /* CHECK FOR QUOTE               */
         LR    @10,CARDPTR                                         0313
         ALR   @10,K                                               0313
         BCTR  @10,0                                               0313
         CLI   CARD(@10),C''''                                     0313
         BE    @RT00313                                            0313
*           GO TO ENDSKIPQ;         /* SCAN SUCCESSFUL               */
*       END;                        /* END OF SCAN THRU COLUMNS      */
         AL    K,@CF00042                                          0315
@DE00312 CR    K,ENDCOL                                            0315
         BNH   @DL00312                                            0315
*       K=0;                        /* SCAN FAILED                   */
         SLR   K,K                                                 0316
*     END;                                                         0317
*ENDSKIPQ:                          /* NORMAL EXIT FROM THIS PROC    */
*   END SKIPTOQ;                                                   0318
*                                                                  0318
@EL00002 DS    0H                                                  0318
@EF00002 DS    0H                                                  0318
@ER00002 BR    @14                                                 0318
*   /*****************************************************************/
*   /*                                                               */
*   /* SKIPTO -- PROC TO SKIP K TO NEXT BLANK                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0319
*SKIPTO:                                                           0319
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0319
SKIPTO   DS    0H                                                  0320
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF
*                                      CARD                          */
         LTR   K,K                                                 0320
         BZ    @RF00320                                            0320
*     DO;                                                          0321
*       DO K=K TO ENDCOL;           /* SCAN THRU COLUMNS OF CARD     */
         B     @DE00322                                            0322
@DL00322 DS    0H                                                  0323
*         IF CARD(K)=' ' THEN       /* CHECK FOR BLANK               */
         LR    @10,CARDPTR                                         0323
         ALR   @10,K                                               0323
         BCTR  @10,0                                               0323
         CLI   CARD(@10),C' '                                      0323
         BE    @RT00323                                            0323
*           GO TO ENDTO;            /* SCAN SUCCESSFUL               */
*       END;                                                       0325
         AL    K,@CF00042                                          0325
@DE00322 CR    K,ENDCOL                                            0325
         BNH   @DL00322                                            0325
*       K=0;                        /* SCAN FAILED                   */
         SLR   K,K                                                 0326
*     END;                                                         0327
*ENDTO:                             /* NORMAL EXIT FROM THIS PROC    */
*   END SKIPTO;                                                    0328
@EL00003 DS    0H                                                  0328
@EF00003 DS    0H                                                  0328
@ER00003 BR    @14                                                 0328
*                                                                  0329
*   /*****************************************************************/
*   /*                                                               */
*   /* SKIPOVER -- PROC TO SKIP K OVER BLANKS TO NEXT NON-BLANK      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0329
*SKIPOVER:                                                         0329
*   PROC OPTIONS(DONTSAVE,NOSAVEAREA);                             0329
SKIPOVER DS    0H                                                  0330
*   IF K^=0 THEN                    /* DO THE SCAN IF NOT AT END OF
*                                      CARD                          */
         LTR   K,K                                                 0330
         BZ    @RF00330                                            0330
*     DO;                                                          0331
*       DO K=K TO ENDCOL;           /* SCAN THRU COLUMNS OF CARD     */
         B     @DE00332                                            0332
@DL00332 DS    0H                                                  0333
*         IF CARD(K)^=' ' THEN      /* CHECK FOR NON-BLANK CHAR      */
         LR    @10,CARDPTR                                         0333
         ALR   @10,K                                               0333
         BCTR  @10,0                                               0333
         CLI   CARD(@10),C' '                                      0333
         BNE   @RT00333                                            0333
*           GO TO ENDOVER;          /* SCAN SUCCESSFUL               */
*       END;                                                       0335
         AL    K,@CF00042                                          0335
@DE00332 CR    K,ENDCOL                                            0335
         BNH   @DL00332                                            0335
*       K=0;                        /* SCAN FAILED                   */
         SLR   K,K                                                 0336
*     END;                                                         0337
*ENDOVER:                           /* NORMAL EXIT FROM THIS PROC    */
*   END SKIPOVER;                                                  0338
@EL00004 DS    0H                                                  0338
@EF00004 DS    0H                                                  0338
@ER00004 BR    @14                                                 0338
*   END IKJEFF07                                                   0339
*                                                                  0339
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (FF07PRLG)                                       */
*/*%INCLUDE SYSUT5  (FF07DCLS)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFHT)                                       */
*/*%INCLUDE SYSUT5  (FF07SDLM)                                       */
*                                                                  0339
*       ;                                                          0339
@DATA    DS    0H
@SC00299 CLC   CARD(0,@01),@CC00238
@SM00301 MVC   NAME(0),CARD+2(CARDPTR)
@SC00303 CLC   CARD(0,@01),@CC00244
@SC00305 CLC   CARD(0,@01),@CC00245
@SC00308 CLC   CARD(0,@05),@CC00259
@SC00310 CLC   CARD(0,@09),@CC00262
@DATD    DSECT
         DS    0F
@PC00001 DS    3F
IKJEFF07 CSECT
         DS    0F
@CF00042 DC    F'1'
@CF00106 DC    F'3'
@CF00240 DC    F'10'
@CF00249 DC    F'16'
@DATD    DSECT
         DS    0D
NAME     DS    CL8
WORK     DS    CL4
         ORG   WORK
WVERB    DS    CL2
         ORG   WVERB
WDELIM   DS    BL1
WDATA    EQU   WVERB+0
WNULL    EQU   WVERB+0
WJOB     EQU   WVERB+0
WEXEC    EQU   WVERB+0
WDD      EQU   WVERB+0
WCOMMAND EQU   WVERB+0
WCOMMENT EQU   WVERB+0
WJES     DS    BL1
@NM00001 EQU   WVERB+1
         ORG   WORK+2
WDTYPE   DS    CL1
         ORG   WDTYPE
WDDAST   DS    BL1
WDDDATA  EQU   WDTYPE+0
         ORG   WORK+3
WMISC    DS    CL1
         ORG   WMISC
WCONEX   DS    BL1
WOPCONEX EQU   WMISC+0
WCONERR  EQU   WMISC+0
WNAME    EQU   WMISC+0
WVERBCOP EQU   WMISC+0
WCOMCON  EQU   WMISC+0
WNOTHING EQU   WMISC+0
WDLMFND  EQU   WMISC+0
         ORG   WORK+4
DLMWORK  DS    CL1
         ORG   DLMWORK
DLMEND   DS    BL1
DLMERR   EQU   DLMWORK+0
DLMQUOTE EQU   DLMWORK+0
DLMAMP   EQU   DLMWORK+0
         ORG   DLMWORK+1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFF07 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00244 DC    C'EXEC '
@CC00238 DC    C'JOB '
@CC00259 DC    C'DATA'
@CC00262 DC    C'DLM='
@CC00245 DC    C'DD '
@CC00225 DC    C'//'
@CC00227 DC    C'/*'
@CC00270 DC    C'* '
DLMVALCH DC    CL39'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#$@'
         ORG   DLMVALCH
DLMCH    DS    39CL1
         ORG   DLMVALCH+39
PATCH    DC    17CL3'ZAP'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
HTPTR    EQU   @04
I        EQU   @05
PREVCOL  EQU   @05
N        EQU   @06
D        EQU   @02
S        EQU   @08
A        EQU   @07
K        EQU   @02
L        EQU   @09
Q        EQU   @07
ENDCOL   EQU   @05
CARDPTR  EQU   @03
CARD     EQU   0
HISTORY  EQU   0
WHATMOD  EQU   HISTORY+12
INIDENT  EQU   WHATMOD+3
JCLSWITS EQU   HISTORY+16
PRIORJCL EQU   JCLSWITS
PVERB    EQU   PRIORJCL
PDTYPE   EQU   PRIORJCL+2
PMISC    EQU   PRIORJCL+3
CURRJCL  EQU   JCLSWITS+4
CVERB    EQU   CURRJCL
CDATA    EQU   CVERB
CCOMMENT EQU   CVERB
CDTYPE   EQU   CURRJCL+2
CDDAST   EQU   CDTYPE
CDDDATA  EQU   CDTYPE
CMISC    EQU   CURRJCL+3
CCONEX   EQU   CMISC
COPCONEX EQU   CMISC
CCOMCON  EQU   CMISC
STATICSW EQU   HISTORY+24
GENL     EQU   STATICSW
TAKEXITS EQU   STATICSW+1
OPOFF    EQU   STATICSW+2
CODEFLD  EQU   STATICSW+3
DLMONJCL EQU   HISTORY+32
HTDLM    EQU   DLMONJCL
HTSWITCH EQU   HISTORY+34
HTDLMSW  EQU   HTSWITCH
HTACCNTP EQU   HISTORY+40
HTACCNTI EQU   0
HIST     EQU   0
STMTPTR  EQU   0
JOBNAME  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00011 EQU   HISTORY+50
HTACNTC2 EQU   HISTORY+48
HTACNTC1 EQU   HISTORY+46
HTACCNTL EQU   HISTORY+44
@NM00010 EQU   HISTORY+36
@NM00009 EQU   HISTORY+35
@NM00008 EQU   HTSWITCH
@NM00007 EQU   HISTORY+28
HTCODE   EQU   CODEFLD
@NM00006 EQU   TAKEXITS
COMNTX   EQU   TAKEXITS
JESX     EQU   TAKEXITS
NULLX    EQU   TAKEXITS
CMDX     EQU   TAKEXITS
DDX      EQU   TAKEXITS
EXECX    EQU   TAKEXITS
JOBX     EQU   TAKEXITS
NONOTIFY EQU   GENL
FIRST    EQU   GENL
FLUSH    EQU   GENL
QUIT     EQU   GENL
CDLMFND  EQU   CMISC
CNOTHING EQU   CMISC
CVERBCOP EQU   CMISC
CNAME    EQU   CMISC
CCONERR  EQU   CMISC
@NM00005 EQU   CVERB+1
@NM00004 EQU   CVERB+1
CJES     EQU   CVERB+1
CCOMMAND EQU   CVERB
CDD      EQU   CVERB
CEXEC    EQU   CVERB
CJOB     EQU   CVERB
CNULL    EQU   CVERB
CDELIM   EQU   CVERB
PDLMFND  EQU   PMISC
PNOTHING EQU   PMISC
PCOMCON  EQU   PMISC
PVERBCOP EQU   PMISC
PNAME    EQU   PMISC
PCONERR  EQU   PMISC
POPCONEX EQU   PMISC
PCONEX   EQU   PMISC
PDDDATA  EQU   PDTYPE
PDDAST   EQU   PDTYPE
@NM00003 EQU   PVERB+1
@NM00002 EQU   PVERB+1
PJES     EQU   PVERB+1
PCOMMENT EQU   PVERB
PCOMMAND EQU   PVERB
PDD      EQU   PVERB
PEXEC    EQU   PVERB
PJOB     EQU   PVERB
PNULL    EQU   PVERB
PDATA    EQU   PVERB
PDELIM   EQU   PVERB
INOINIT  EQU   WHATMOD+3
INCOMPIN EQU   WHATMOD+3
INMSG    EQU   WHATMOD+3
INDAIRIN EQU   WHATMOD+3
INWRMGR  EQU   WHATMOD+3
INEXIT   EQU   WHATMOD+3
INREAD   EQU   WHATMOD+3
INGEN    EQU   WHATMOD+2
INPROMPT EQU   WHATMOD+1
INCONTRL EQU   WHATMOD
SUBTAB   EQU   HISTORY
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00041 EQU   JCL
@RT00051 EQU   SETDATA
@RC00045 EQU   CHKCON
@RF00043 EQU   @RC00039
@RT00060 EQU   JCL
@RF00057 EQU   SETDATA
@RT00070 EQU   SETDATA
@RT00072 EQU   SETDATA
@RF00078 EQU   UPDATE
@RT00092 EQU   SETDATA
@RF00135 EQU   SCANEXIT
@RT00145 EQU   SCANOP
@RT00159 EQU   CHKEXEC
@RT00180 EQU   SCANEXIT
@RT00183 EQU   SCANEXIT
@RT00199 EQU   NOQ
@RT00201 EQU   NOQ
@RT00205 EQU   NOQ
@RF00247 EQU   @RC00237
@RF00257 EQU   @RC00237
@RC00260 EQU   @RC00237
@RC00278 EQU   @RC00271
@RF00310 EQU   @EL00002
ENDSKIPQ EQU   @EL00002
@RF00320 EQU   @EL00003
ENDTO    EQU   @EL00003
@RF00330 EQU   @EL00004
ENDOVER  EQU   @EL00004
@PB00004 EQU   @EL00001
@RT00313 EQU   ENDSKIPQ
@RT00323 EQU   ENDTO
@PB00003 EQU   @PB00004
@RT00333 EQU   ENDOVER
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IKJEFF07,(C'PLS1749',0701,75344)

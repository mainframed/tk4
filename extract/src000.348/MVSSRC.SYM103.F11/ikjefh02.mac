         TITLE 'IKJEFH02 PROCESSING ROUTINE                          '
IKJEFH02 CSECT ,                                                   0001
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
         MVC   @PC00001(8),0(@01)                                  0001
*                                                                  0021
*                                                                  0021
*        PARMPTR1=ADDR(COMMON);     /* SET LOCAL ADDRESS OF        0022
*                                      PARAMETERS */               0022
         L     PARMPTR1,@PC00001                                   0022
*        PARMPTR2=ADDR(TABLE(1));   /* SET LOCAL ADDRESS OF        0023
*                                      PARAMETERS */               0023
*                                                                  0023
         L     PARMPTR2,@PC00001+4                                 0023
*    BEGIN:                                                        0024
*                                                                  0024
*        /************************************************************/
*        /*                                                          */
*        /*  READ 80 BYTES                                           */
*        /*                                                          */
*        /************************************************************/
*                                                                  0024
*                                                                  0024
*        CALL IKJEFH03 (COMMON);    /* CALL READ ROUTINE TO PASS BACK
*                                      80 BYTES OF THE HELP DATA SET
*                                      */                          0024
*                                                                  0024
*                                                                  0024
BEGIN    L     @14,@PC00001                                        0024
         ST    @14,@AL00001                                        0024
         L     @15,@CV00148                                        0024
         LA    @01,@AL00001                                        0024
         BALR  @14,@15                                             0024
*        /************************************************************/
*        /*                                                          */
*        /*  EXAMINE SWITCHES TO DETERMINE ACTION TO BE TAKEN        */
*        /*                                                          */
*        /************************************************************/
*                                                                  0025
*        IF SWEOD='1'B THEN                                        0025
         TM    SWEOD(PARMPTR1),B'00001000'                         0025
         BO    @RT00025                                            0025
*                                   /* IF END OF DATA OCCURED RETURN
*                                      TO CALLER */                0026
*          RETURN;                                                 0026
*                                                                  0026
*        IF SWERRMSG='1'B THEN                                     0027
         TM    SWERRMSG(PARMPTR1),B'00000001'                      0027
         BO    @RT00027                                            0027
*                                   /* IF ERROR MESSAGE PUT OUT    0028
*                                      RETURN TO CALLER */         0028
*          RETURN;                                                 0028
*                                                                  0028
*        IF SWCOMAND='1'B THEN                                     0029
         TM    SWCOMAND(PARMPTR1),B'00100000'                      0029
         BO    @RT00029                                            0029
*                                   /* IF DONT WANT TO CHECK FOR   0030
*                                      CONTROL CHARACTERS SKIP TO PUT
*                                      OUT INFORMATION */          0030
*          GO TO PUTOUT;                                           0030
*                                                                  0030
*                                                                  0030
*        /************************************************************/
*        /*                                                          */
*        /*  EXAMINE THE DATA RETURNED FROM IKJEFH03                 */
*        /*                                                          */
*        /************************************************************/
*                                                                  0031
*        IF DATAREA(1)='=' THEN                                    0031
         L     @14,DATAREAP(,PARMPTR1)                             0031
         CLI   DATAREA(@14),C'='                                   0031
         BE    @RT00031                                            0031
*                                   /* BEGINNING OF NEXT SUBCOMMAND
*                                      IN MEMBER QUIT */           0032
*          RETURN;                                                 0032
*                                                                  0032
*        IF DATAREA(1)=')' THEN                                    0033
         CLI   DATAREA(@14),C')'                                   0033
         BNE   @RF00033                                            0033
*          IF DATAREA(2)^=BLANK THEN                               0034
         CLC   DATAREA+1(1,@14),BLANK                              0034
         BE    @RF00034                                            0034
*            IF DATAREA(3)=BLANK THEN                              0035
         CLC   DATAREA+2(1,@14),BLANK                              0035
         BE    @RT00035                                            0035
*                                   /* COLUMNS 1-3 OF THE CARD IMAGE
*                                      MEAN A CONTROL CHARACTER NOT
*                                      INDICATING A KEYWORD */     0036
*              GO TO CTRLCHAR;      /* PROCESS THE CONTROL CHARACTER
*                                      */                          0036
*                                                                  0036
*        IF DATAREA(1:2)='))' THEN                                 0037
@RF00034 DS    0H                                                  0037
@RF00033 L     @14,DATAREAP(,PARMPTR1)                             0037
         CLC   DATAREA(2,@14),@CC00156                             0037
         BE    @RT00037                                            0037
*                                   /* COLUMNS 1+2 OF THE CARD IMAGE
*                                      INDICATE A KEYWORD */       0038
*          GO TO KEYCHAR;           /* GO TO PROCESS KEYWORD */    0038
*                                                                  0038
*        IF SWPRINT='1'B THEN                                      0039
         TM    SWPRINT(PARMPTR1),B'00000100'                       0039
         BO    @RT00039                                            0039
*                                   /* WHEN NOT CONTROL CHARACTER OR
*                                      KEYWORD IS PROGRMM IN THE   0040
*                                      MIDST OF RRINTING REQUESTED 0040
*                                      INFORMATION */              0040
*          GO TO PUTOUT;            /* YES, GO TO PUT LINE OUT */  0040
*        GO TO BEGIN;               /* NOT PRINTING, REPEAT PROCESS
*                                      */                          0041
*                                                                  0041
*                                                                  0041
*                                                                  0041
         B     BEGIN                                               0041
*    KEYCHAR:                                                      0042
*                                                                  0042
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS KEYWORD                                         */
*        /*                                                          */
*        /************************************************************/
*                                                                  0042
*                                                                  0042
*        SWPRINT='0'B;              /* TURN OFF PRINT SWITCH */    0042
KEYCHAR  NI    SWPRINT(PARMPTR1),B'11111011'                       0042
*        I=1;                       /* INITIALIZE INDEX THROUGH PARSE
*                                      INFORMATION TABLE */        0043
*                                                                  0043
*                                                                  0043
         LA    I,1                                                 0043
*    OPERTST:                                                      0044
*                                   /* CHECK FOR OPERAND INFORMATION
*                                      REQUESTED */                0044
*        IF CONTRL(I)=' O' THEN                                    0044
OPERTST  LR    @14,I                                               0044
         AR    @14,@14                                             0044
         ST    @14,@TF00001                                        0044
         ALR   @14,PARMPTR2                                        0044
         CLC   CONTRL-2(2,@14),@CC00161                            0044
         BE    @RT00044                                            0044
*                                   /* ALL OPERAND INFORMATION WANTED
*                                      */                          0045
*          GO TO BLANKOUT;          /* GO TO PUT OUT THE INFORMATION
*                                      REMOVING THE '))' */        0045
*                                                                  0045
*        IF CONTRL(I)='FFFF'X THEN                                 0046
         LR    @14,PARMPTR2                                        0046
         AL    @14,@TF00001                                        0046
         CLC   CONTRL-2(2,@14),@CB00164                            0046
         BE    @RT00046                                            0046
*                                   /* END OF CONTROL CHARACTER LIST
*                                      AND ALL OPERANDS NOT SPECIFIED
*                                      */                          0047
*          GO TO FOUNDTST;          /* THEN GO TO CHECK TO SEE IF THE
*                                      PARTICULAR KEYWORD HAS BEEN 0047
*                                      REQUESTED */                0047
*                                                                  0047
*        I=I+1;                     /* OTHERWISE LOOK AT NEXT ITEM IN
*                                      PARSE TABLE */              0048
         AH    I,@CH00048                                          0048
*        GO TO OPERTST;             /* CONTINUE SEARCH FOR OPERAND 0049
*                                      CONTROL CHARACTER */        0049
*                                                                  0049
*                                                                  0049
         B     OPERTST                                             0049
*    FOUNDTST:                                                     0050
*        IF SWFOUND='1'B THEN                                      0050
FOUNDTST TM    SWFOUND(PARMPTR1),B'10000000'                       0050
         BO    @RT00050                                            0050
*                                   /* ALL INFORMATION REQUESTED HAS
*                                      BEEN FOUND */               0051
*          RETURN;                  /* YES, FINISHED PROCESSING SO 0051
*                                      RETURN */                   0051
*                                                                  0051
*        IF KEYPTR='FF000000'X THEN                                0052
         L     @14,KEYPTR(,PARMPTR2)                               0052
         CL    @14,@CF00167                                        0052
         BE    @RT00052                                            0052
*                                   /* NO KEYWORDS SPECIFIED IN PARSE
*                                      TABLE BUT HAVEN'T FOUND ALL 0053
*                                      CONTROL CHARACTER INFORMATION
*                                      THEN REPEAT PROCESS */      0053
*                                                                  0053
*          GO TO BEGIN;                                            0053
*        LISTP=KEYPTR;              /* POINT TO BEGINNING OF KEYWORD
*                                      LIST TO START SEARCH FOR    0054
*                                      KEYWORD */                  0054
*                                                                  0054
*                                                                  0054
         LR    LISTP,@14                                           0054
*    COMPKEY:                                                      0055
*                                   /* LOOK THROUGH LIST FOR THE   0055
*                                      KEYWORD READ FROM THE CARD */
*        IF KWRD='0'B THEN                                         0055
COMPKEY  TM    KWRD(LISTP),B'10000000'                             0055
         BZ    @RT00055                                            0055
*                                   /* KEYWORD ALREADY FOUND THEN  0056
*                                      SKIP TO LOOK AT NEXT ONE */ 0056
*          GO TO NEXTK;                                            0056
*        IF KEYWORD(1:KWRDL)=DATAREA(3:KWRDL+2) THEN               0057
         L     @14,KWRDP(,LISTP)                                   0057
         L     @10,DATAREAP(,PARMPTR1)                             0057
         MVC   @ZT00002+2(2),KWRDL(LISTP)                          0057
         L     @06,@ZT00002                                        0057
         BCTR  @06,0                                               0057
         EX    @06,@SC00204                                        0057
         BNE   @RF00057                                            0057
*                                   /* COMPARE KEYWORDS USING LENGTH
*                                      OF KEYWORD AT TERMINAL AS BASE
*                                      - THIS ALLOWS INFORMATION ON
*                                      ABREVIATIONS */             0058
*          DO;                                                     0058
*            IF SWFIRST='0'B THEN                                  0059
         TM    SWFIRST(PARMPTR1),B'00000010'                       0059
         BNZ   @RF00059                                            0059
*              DO;                                                 0060
*                SWFIRST='1'B;      /* FIRST KEYWORD FOUND */      0061
*                SWBLK='1'B;        /* INDICATE THAT MUST PUT IN   0062
*                                      BLANK LINE BEFORE KEYWORD INFO
*                                      PUT OUT */                  0062
         OI    SWFIRST(PARMPTR1),B'00000011'                       0062
*              END;                                                0063
*            KWRD='0'B;             /* IF EQUAL INDICATE KEYWORD   0064
*                                      FOUND*/                     0064
@RF00059 NI    KWRD(LISTP),B'01111111'                             0064
*            SWKEY='1'B;            /* SET SWITCH INDICATING THE   0065
*                                      KEYWORD HAS BEEN FOUND AND  0065
*                                      CHECK THROUGH THE REST OF THE
*                                      LIST FOR DUPLICATES */      0065
         OI    SWKEY(PARMPTR1),B'00100000'                         0065
*          END;                                                    0066
*                                                                  0066
*                                                                  0066
*    NEXTK:                                                        0067
*        IF NXTLSTP='FF000000'X THEN                               0067
@RF00057 DS    0H                                                  0067
NEXTK    CLC   NXTLSTP(4,LISTP),@CF00167                           0067
         BNE   @RF00067                                            0067
*                                   /* AT END OF KEYWORD LIST */   0068
*          DO;                                                     0068
*            IF SWKEY='1'B THEN                                    0069
         TM    SWKEY(PARMPTR1),B'00100000'                         0069
         BNO   @RF00069                                            0069
*                                   /* FOUND KEYWORD NEEDED */     0070
*              DO;                                                 0070
*                SWKEY='0'B;        /* REINITIALIZE SWITCH WHICH   0071
*                                      INDICATED THE KEYWORD WAS   0071
*                                      FOUND- SO IT CAN BE USED AGAIN
*                                      */                          0071
         NI    SWKEY(PARMPTR1),B'11011111'                         0071
*                GO TO CKFOUND;     /* GO TO SEE IF ALL NEEDED     0072
*                                      INFORMATION HAS BEEN FOUND */
         B     CKFOUND                                             0072
*              END;                                                0073
*                                                                  0073
*            ELSE                                                  0074
*                                   /* AT END OF KEYWORD LIST AND  0074
*                                      HAVEN'T FOUND KEYWORD WANTED
*                                      */                          0074
*              GO TO BEGIN;         /* REPEAT PROCESS */           0074
*          END;                                                    0075
*                                                                  0075
*        LISTP=NXTLSTP;             /* NOT AT END OF KEYWORD LIST, 0076
*                                      POINT TO NEXT KEYWORD */    0076
@RF00067 L     LISTP,NXTLSTP(,LISTP)                               0076
*        GO TO COMPKEY;             /* REPEAT COMPARISON */        0077
*                                                                  0077
*                                                                  0077
         B     COMPKEY                                             0077
*    CTRLCHAR:                                                     0078
*                                                                  0078
*        /************************************************************/
*        /*                                                          */
*        /*  PROCESS CONTROL CHARACTERS                              */
*        /*                                                          */
*        /************************************************************/
*                                                                  0078
*                                                                  0078
*                                                                  0078
*                                                                  0078
*        SWPRINT='0'B;              /* HAVE FOUND A CONTROL CHARACTER
*                                      SO TURN OFF PRINT SWITCH*/  0078
*                                                                  0078
CTRLCHAR NI    SWPRINT(PARMPTR1),B'11111011'                       0078
*        IF SWFOUND='1'B THEN                                      0079
         TM    SWFOUND(PARMPTR1),B'10000000'                       0079
         BO    @RT00079                                            0079
*                                   /* ALL REQUESTED INFORMATION HAS
*                                      BEEN FOUND */               0080
*          RETURN;                  /* THEN FINISHED PROCESSING SO 0080
*                                      RETURN, HAVE READ ONE EXTRA 0080
*                                      CONTROL CHARACTER */        0080
*                                                                  0080
*        I=1;                       /* INITIALIZE PARSE TABLE INDEX
*                                      */                          0081
*                                                                  0081
*                                                                  0081
         LA    I,1                                                 0081
*    CNTRLTST:                                                     0082
*                                   /* SEARCH FOR CONTROL CHARACTERS
*                                      IN PARSE INFORMATION TABLE */
*        IF CONTRL(I)=DATAREA(1:2) THEN                            0082
CNTRLTST LR    @14,I                                               0082
         AR    @14,@14                                             0082
         L     @10,DATAREAP(,PARMPTR1)                             0082
         ST    @14,@TF00001                                        0082
         ALR   @14,PARMPTR2                                        0082
         CLC   CONTRL-2(2,@14),DATAREA(@10)                        0082
         BE    @RT00082                                            0082
*          GO TO FOUND;             /* WHEN FIND CHARACTER WANTED, GO
*                                      TO CONTINUE PROCESSING */   0083
*                                                                  0083
*        IF CONTRL(I)='FFFF'X THEN                                 0084
         LR    @14,PARMPTR2                                        0084
         AL    @14,@TF00001                                        0084
         CLC   CONTRL-2(2,@14),@CB00164                            0084
         BE    @RT00084                                            0084
*          GO TO BEGIN;             /* IF GET TO END OF PARSE TABLE
*                                      WITHOUT FINDING CHARACTER,  0085
*                                      THEN DON'T WANT THE         0085
*                                      INFORMATION ON THE CARD IMAGE
*                                      - GO TO REPEAT PROCESS */   0085
*                                                                  0085
*        I=I+1;                     /* CONSIDER NEXT ITEM IN PARSE 0086
*                                      TABLE */                    0086
         AH    I,@CH00048                                          0086
*        GO TO CNTRLTST;            /* CONTINUE SEARCH */          0087
*                                                                  0087
*                                                                  0087
         B     CNTRLTST                                            0087
*    FOUND:                                                        0088
*        PAREN(I)=BLANK;            /* INDICATE FOUND IN PARSE     0088
*                                      INFORMATION TABLE */        0088
FOUND    LR    @14,I                                               0088
         AR    @14,@14                                             0088
         ALR   @14,PARMPTR2                                        0088
         MVC   PAREN-2(1,@14),BLANK                                0088
*        SWMOVOR='1'B;                                             0089
*                                                                  0089
*                                                                  0089
         OI    SWMOVOR(PARMPTR1),B'00000100'                       0089
*    CKFOUND:                                                      0090
*                                                                  0090
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK TO SEE IF ALL OF THE INFORMATION IN THE PARSE     */
*        /*  TABLE HAS BEEN FOUND                                    */
*        /*                                                          */
*        /************************************************************/
*                                                                  0090
*        I=1;                       /* INITIALIZE INDEX */         0090
*                                                                  0090
*                                                                  0090
CKFOUND  LA    I,1                                                 0090
*    CKAGN:                                                        0091
*                                   /* CHECK CONTROL CHARACTER     0091
*                                      INFORMATION */              0091
*                                                                  0091
*        IF CONTRL(I)='FFFF'X THEN                                 0091
CKAGN    LR    @14,I                                               0091
         AR    @14,@14                                             0091
         ST    @14,@TF00001                                        0091
         ALR   @14,PARMPTR2                                        0091
         CLC   CONTRL-2(2,@14),@CB00164                            0091
         BE    @RT00091                                            0091
*                                   /* END OF CONTROL CHARACTERS WITH
*                                      EVERYTHING FOUND, GO TO CHECK
*                                      KEYWORD LIST */             0092
*          GO TO CKKEYWD;                                          0092
*                                                                  0092
*        IF PAREN(I)^=BLANK THEN                                   0093
         LR    @14,PARMPTR2                                        0093
         AL    @14,@TF00001                                        0093
         CLC   PAREN-2(1,@14),BLANK                                0093
         BNE   @RT00093                                            0093
*                                   /* IF NOT ALL CONTROL CHARACTER
*                                      INFORMATION IN TABLE FOUND  0094
*                                      THEN DON'T SET FOUND SWITCH */
*          GO TO BLANKOUT;          /* BUT GO TO PUT OUT INFORMATION
*                                      */                          0094
*                                                                  0094
*        I=I+1;                     /* LOOK AT NEXT CONTROL CHARACTER
*                                      */                          0095
         AH    I,@CH00048                                          0095
*        GO TO CKAGN;               /* REPEAT CHECKING */          0096
*                                                                  0096
*                                                                  0096
         B     CKAGN                                               0096
*    CKKEYWD:                                                      0097
*                                   /* CHECK KEYWORDS FOUND */     0097
*        LISTP=KEYPTR;              /* POINT TO BEGINING OF KEYWORD
*                                      CHAIN */                    0097
*                                                                  0097
*                                                                  0097
CKKEYWD  L     LISTP,KEYPTR(,PARMPTR2)                             0097
*    CKNKEYWD:                                                     0098
*        IF LISTP='FF000000'X THEN                                 0098
CKNKEYWD CL    LISTP,@CF00167                                      0098
         BNE   @RF00098                                            0098
*                                   /* END OF KEYWORD CHAIN AND    0099
*                                      EVERYTHING FOUND TURN ON FOUND
*                                      SWITCH */                   0099
*          DO;                                                     0099
*            SWFOUND='1'B;          /* TURN ON FOUND SWITCH */     0100
         OI    SWFOUND(PARMPTR1),B'10000000'                       0100
*            GO TO BLANKOUT;        /* GO TO PUT OUT INFORMATION */
         B     BLANKOUT                                            0101
*          END;                                                    0102
*                                                                  0102
*        IF KWRD='1'B THEN                                         0103
@RF00098 TM    KWRD(LISTP),B'10000000'                             0103
         BO    @RT00103                                            0103
*                                   /* IF SOME KEYWORD EXISTS FOR  0104
*                                      WHICH INFORMATION HAS NOT BEEN
*                                      FOUND, DON'T TURN ON FOUND  0104
*                                      SWITCH */                   0104
*          GO TO BLANKOUT;          /* GO TO PUT OUT INFORMATION */
*                                                                  0104
*        LISTP=NXTLSTP;             /* POINT TO NEXT KEYWORD */    0105
         L     LISTP,NXTLSTP(,LISTP)                               0105
*        GO TO CKNKEYWD;            /* REPEAT CHECK */             0106
*                                                                  0106
*                                                                  0106
         B     CKNKEYWD                                            0106
*    BLANKOUT:                                                     0107
*                                                                  0107
*        /************************************************************/
*        /*                                                          */
*        /*  REMOVE CONTROL CHARACTERS FROM CARD IMAGE               */
*        /*                                                          */
*        /************************************************************/
*                                                                  0107
*                                                                  0107
*        DATAREA(1:2)='  ';         /* BLANK OUT FIRST TWO CHARACTERS
*                                      OF DATA TO BE PUT OUT TO    0107
*                                      TERMINAL */                 0107
*                                                                  0107
BLANKOUT L     @14,DATAREAP(,PARMPTR1)                             0107
         MVC   DATAREA(2,@14),@CC00185                             0107
*        SWPRINT='1'B;              /* TURN ON PRINT SWITCH SO THAT
*                                      SUCCESDING CARD IMAGES WILL BE
*                                      PUT OUT UNTIL ANOTHER CONTROL
*                                      CHARACTER IS ENCOUNTERED */ 0108
*                                                                  0108
*                                                                  0108
         OI    SWPRINT(PARMPTR1),B'00000100'                       0108
*    PUTOUT:                                                       0109
*                                                                  0109
*        /************************************************************/
*        /*                                                          */
*        /*  PUT OUT CARD IMAGE TO THE TERMINAL USING IKJEFF02       */
*        /*                                                          */
*        /************************************************************/
*                                                                  0109
*        SW=0;                  /* INIT SWITCHES TO ZERO  Y02668*/ 0109
PUTOUT   L     @14,MSGPTR(,PARMPTR1)                               0109
         MVI   SW(@14),X'00'                                       0109
*        SW2=0;                 /* INIT SWITCHES TO ZERO  Y02668*/ 0110
         MVI   SW2(@14),X'00'                                      0110
*        MTNOIDSW='1'B;        /* SET SWITCHES TO PUT OUT DATA     0111
*                                      NOT A MESSAGE Y02668*/      0111
*        MTPUTLSW='1'B;           /* USE PUTLINE  Y02668*/         0112
         OI    MTNOIDSW(@14),B'11000000'                           0112
*        MSGID='200Z';              /* SET MESSAGE ID NUMBER */    0113
         MVC   MSGID(4,@14),@CC00189                               0113
*        IF SWBLK='1'B THEN                                        0114
         TM    SWBLK(PARMPTR1),B'00000001'                         0114
         BO    @RT00114                                            0114
*          GO TO BLKLINE;                                          0115
*        IF SWMOVOR='1'B THEN                                      0116
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0116
         BNO   @RF00116                                            0116
*          DO;                      /* PUT OUT BLANK LINE TO FORMAT
*                                      HELP DATA */                0117
*                                                                  0117
*    BLKLINE:                                                      0118
*            VAR1=ADDR(BLANK);      /* MSG IS BLANK LINE     Y02668*/
BLKLINE  L     @14,MSGPTR(,PARMPTR1)                               0118
         LA    @10,BLANK                                           0118
         ST    @10,@TF00001                                        0118
         MVC   VAR1(3,@14),@TF00001+1                              0118
*            L1='01'X;              /* ONE CHAR LONG         Y02668*/
         MVI   L1(@14),X'01'                                       0119
*            GO TO CALMSG;                                         0120
         B     CALMSG                                              0120
*          END;                                                    0121
*                                                                  0121
*    SETMSG:                                                       0122
*                                   /* PUT OUT HELP DATA */        0122
*        VAR1=DATAREAP;        /* ADDRESS OF HELP DATA Y02668*/    0122
@RF00116 DS    0H                                                  0122
SETMSG   L     @14,MSGPTR(,PARMPTR1)                               0122
         L     @10,DATAREAP(,PARMPTR1)                             0122
         ST    @10,@TF00001                                        0122
         MVC   VAR1(3,@14),@TF00001+1                              0122
*        L1='01000111'B;        /* LENGTH OF HELP DATA = 71 Y02668*/
         MVI   L1(@14),X'47'                                       0123
*        IF SWMOVOR='1'B THEN                                      0124
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0124
         BNO   @RF00124                                            0124
*          DO;                                                     0125
*            VAR1=VAR1+3; /* SKIP CONTROL CHARACTERS Y02668*/      0126
         AH    @10,@CH00154                                        0126
         ST    @10,@TF00001                                        0126
         MVC   VAR1(3,@14),@TF00001+1                              0126
*            L1='01000100'B;    /* CHANGE LENGTH OF HELP DATA TO   0127
*                                      68 - SO SEQUENCE NUMBERS ARE
*                                      NOT PUT OUT Y02668*/        0127
         MVI   L1(@14),X'44'                                       0127
*          END;                                                    0128
*        SWBLK='0'B;                /* RE-INITIALIZE */            0129
@RF00124 DS    0H                                                  0130
*        SWMOVOR='0'B;                                             0130
*                                                                  0130
         NI    SWBLK(PARMPTR1),B'11111010'                         0130
*    CALMSG:                                                       0131
*        REG1 = ADDR(MSGTABLE);             /*  Y02668*/           0131
CALMSG   L     REG1,MSGPTR(,PARMPTR1)                              0131
*        CALL IKJEFF02;                                            0132
         L     @15,@CV00199                                        0132
         BALR  @14,@15                                             0132
*                                   /* CALL MESSAGE ROUTINE */     0133
*                                                                  0133
*                                                                  0133
*        /************************************************************/
*        /*                                                          */
*        /*  CHECK RETURN CODE FROM MESSAGE ROUTINE                  */
*        /*                                                          */
*        /************************************************************/
*                                                                  0133
*        IF REG15^=0 THEN                                          0133
         LTR   REG15,REG15                                         0133
         BZ    @RF00133                                            0133
*                                   /* IF MESSAGE ROUTINE NOT      0134
*                                      SUCCESSFUL FOR ANY REASON THEN
*                                      QUIT */                     0134
*          DO;                                                     0134
*            SWERRMSG='1'B;         /* INDICATE WILL SKIP FURTHER  0135
*                                      PROCESSING */               0135
         OI    SWERRMSG(PARMPTR1),B'00000001'                      0135
*            RETURN;                                               0136
@EL00001 L     @13,4(,@13)                                         0136
@EF00001 L     @00,@SIZDATD                                        0136
         LR    @01,@11                                             0136
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0136
         BR    @14                                                 0136
*          END;                                                    0137
*                                                                  0137
*                                                                  0137
*        IF SWBLK='1'B THEN                                        0138
@RF00133 TM    SWBLK(PARMPTR1),B'00000001'                         0138
         BO    @RT00138                                            0138
*          GO TO SETMSG;            /* IF JUST PUT OUT BLANK LINE GO
*                                      BACK TO PUT OUT HELP DATA */
*        IF SWMOVOR='1'B THEN                                      0140
         TM    SWMOVOR(PARMPTR1),B'00000100'                       0140
         BO    @RT00140                                            0140
*          GO TO SETMSG;                                           0141
*                                                                  0141
*                                                                  0141
*        /************************************************************/
*        /*                                                          */
*        /*  REPEAT PROCESS                                          */
*        /*                                                          */
*        /************************************************************/
*        GO TO BEGIN;               /* REPEAT PROCESS */           0142
         B     BEGIN                                               0142
*        RETURN;                                                   0143
*        GENERATE;                                                 0144
        DS    90C                 FOR MAINTANENCE
*/*IKJEFH02: CHART */                                              0145
*/*%START: E START */                                              0145
*/*%CALH03: S IKJEFH03:READ A CARD IMAGE */                        0145
*/* D (NO,,YES,%RET:LT) DID EOD OCCUR IN IKJEFH03 ? */             0145
*/* D (NO,,YES,%RET:LT) DID AN ERROR OCCUR ? */                    0145
*/* D (NO,,YES,%DATA:LT) IS THE MEMBER THE COMMANDS MEMBER ? */    0145
*/* D (NO,,YES,%RET:LT) BEGINNING OF A SUBCOM ? */                 0145
*/* D (YES,,NO,%KEY) DOES CARD HAVE A CONTROL CHARACTER ON IT ? */ 0145
*/* D (YES,%RET:RT,NO,) FOUND EVERYTHING LOOKING FOR ? */          0145
*/* D (NO,%CALH03:LL,YES,%PARFND) CHARACTER IN PARSE TABLE? */     0145
*/*%KEY: D (NO,%OUT,YES,) DOES CARD HAVE A KEYWORD ON IT? */       0145
*/* D (NO,%FNDALL,YES,%BLK:LL) IS ALL OPER INFO WANTED ? */        0145
*/*%OUT: D (NO,%CALH03:RL,YES,%DATA:TT) SHOULD CARD BE PUT OUT ? */
*/*%FNDALL: D (YES,%RET:RT,N0,) HAS HELP CP FOUND AL INFO REQ ? */ 0145
*/* D (NO,%CALH03:BL,YES,%PARFND) IS KEYWORD ON CARD IN PARSE TABLE?*/
*/*%PARFND: P INDICATE ITEM FOUND IN PARSE TABLE */                0145
*/*%BLK: P REMOVE CONTROL CHARACTERS FROM HELP DATA */             0145
*/*%DATA: P SET UP HELP DATA TO BE PUT OUT */                      0145
*/* S IKJEFF02:PUT OUT DATA TO TERMINAL */                         0145
*/* D (YES,%CALH03:RL,NO,) IKJEFF02 SUCCESSFUL ? */                0145
*/* P INDICATE ERROR OCCURED */                                    0145
*/*%RET: R RETURN */                                               0145
*/*IKJEFH02: END */                                                0145
*        END IKJEFH02                                              0145
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        *
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                        *
*;                                                                 0145
         B     @EL00001                                            0145
@DATA    DS    0H
@CH00048 DC    H'1'
@CH00154 DC    H'3'
@SC00204 CLC   KEYWORD(0,@14),DATAREA+2(@10)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@AL00001 DS    1A
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
IKJEFH02 CSECT
         DS    0F
@CF00167 DC    XL4'FF000000'
@DATD    DSECT
         DS    0D
FULWRD   DS    F
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFH02 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00148 DC    V(IKJEFH03)
@CV00199 DC    V(IKJEFF02)
         DS    0D
@CC00156 DC    C'))'
@CC00161 DC    C' O'
@CC00185 DC    C'  '
@CC00189 DC    C'200Z'
@CB00164 DC    X'FFFF'
BLANK    DC    CL1' '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
LISTP    EQU   @02
REG15    EQU   @15
REG1     EQU   @01
PARMPTR1 EQU   @05
PARMPTR2 EQU   @07
I        EQU   @03
SAVEPARM EQU   0
CPPLPTR  EQU   SAVEPARM
SWITCHES EQU   SAVEPARM+4
SWCOMAND EQU   SWITCHES
SWPRINT  EQU   SWITCHES
SWERRMSG EQU   SWITCHES
SWFOUND  EQU   SWITCHES+1
SWKEY    EQU   SWITCHES+1
SWEOD    EQU   SWITCHES+1
SWMOVOR  EQU   SWITCHES+1
SWFIRST  EQU   SWITCHES+1
SWBLK    EQU   SWITCHES+1
DATAREAP EQU   SAVEPARM+8
MSGPTR   EQU   SAVEPARM+16
CPPL     EQU   0
MSGTABLE EQU   0
TMCTPTR  EQU   MSGTABLE+4
ECBPTR   EQU   MSGTABLE+8
@NM00001 EQU   MSGTABLE+12
SW       EQU   MSGTABLE+20
MTNOIDSW EQU   SW
MTPUTLSW EQU   SW
RETMSG   EQU   MSGTABLE+21
SW2      EQU   MSGTABLE+24
MSGID    EQU   MSGTABLE+40
MTINSRTS EQU   MSGTABLE+44
L1       EQU   MTINSRTS
VAR1     EQU   MTINSRTS+1
L2       EQU   MTINSRTS+4
L3       EQU   MTINSRTS+8
L4       EQU   MTINSRTS+12
RET      EQU   0
PARSETAB EQU   0
KEYPTR   EQU   PARSETAB
CONTRL   EQU   PARSETAB+4
PAREN    EQU   CONTRL
LIST     EQU   0
KWRDP    EQU   LIST
@NM00007 EQU   LIST+4
KWRDL    EQU   @NM00007
KWRDF    EQU   @NM00007+2
KWRD     EQU   KWRDF
NXTLSTP  EQU   LIST+8
KEYWORD  EQU   0
DATAREA  EQU   0
MSGECB   EQU   0
MSGTMCT  EQU   0
COMMON   EQU   0
TABLE    EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CONCHAR  EQU   CONTRL+1
RETCHAR  EQU   RET+2
RETSIZE  EQU   RET
MSGRTN   EQU   MSGTABLE+60
VAR4     EQU   MTINSRTS+13
HIGHL4   EQU   L4
VAR3     EQU   MTINSRTS+9
HIGHL3   EQU   L3
VAR2     EQU   MTINSRTS+5
HIGHL2   EQU   L2
HIGHL1   EQU   L1
@NM00006 EQU   MSGTABLE+36
@NM00005 EQU   MSGTABLE+32
MTOLDPTR EQU   MSGTABLE+28
@NM00004 EQU   MSGTABLE+25
@NM00003 EQU   SW2
MT2OLDSW EQU   SW2
@NM00002 EQU   SW
MTJOBISW EQU   SW
MTKEY1SW EQU   SW
MTHEXSW  EQU   SW
MTWTOSW  EQU   SW
MSGCSECT EQU   MSGTABLE+16
MTHIGH   EQU   @NM00001
MTCPPL   EQU   TMCTPTR
LISTPTR  EQU   MSGTABLE
CPPLECT  EQU   CPPL+12
CPPLPSCB EQU   CPPL+8
CPPLUPT  EQU   CPPL+4
CPPLCBUF EQU   CPPL
TOTALEX  EQU   SAVEPARM+24
COMECB   EQU   SAVEPARM+20
READCBP  EQU   SAVEPARM+12
SWMSGLOP EQU   SWITCHES+1
SWREAD   EQU   SWITCHES+1
SWSUBSER EQU   SWITCHES
SWPARSE  EQU   SWITCHES
SWSUBCOM EQU   SWITCHES
SWPARS   EQU   SWITCHES
SWCLOSE  EQU   SWITCHES
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00025 EQU   @EL00001
@RT00027 EQU   @EL00001
@RT00029 EQU   PUTOUT
@RT00031 EQU   @EL00001
@RT00035 EQU   CTRLCHAR
@RT00037 EQU   KEYCHAR
@RT00039 EQU   PUTOUT
@RT00044 EQU   BLANKOUT
@RT00046 EQU   FOUNDTST
@RT00050 EQU   @EL00001
@RT00052 EQU   BEGIN
@RT00055 EQU   NEXTK
@RF00069 EQU   BEGIN
@RT00079 EQU   @EL00001
@RT00082 EQU   FOUND
@RT00084 EQU   BEGIN
@RT00091 EQU   CKKEYWD
@RT00093 EQU   BLANKOUT
@RT00103 EQU   BLANKOUT
@RT00114 EQU   BLKLINE
@RT00138 EQU   SETMSG
@RT00140 EQU   SETMSG
@ENDDATA EQU   *
         END   IKJEFH02

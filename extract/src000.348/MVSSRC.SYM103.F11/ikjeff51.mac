         TITLE 'IKJEFF51 - INSTALLATION EXIT INTERFACE                 *
                       '
IKJEFF51 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IKJEFF51  73.293'                                 0001
         DROP  @15
@PROLOG  ST    @14,12(,@13)                                        0001
         STM   @00,@12,20(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(8),0(@01)                                  0001
DUMMYLBL DS    0H                                                  0003
*                                                                  0050
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZATION OF LOCAL POINTERS AND DATA                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0050
*   FIBCMPTR=ADDR(FIBPARML);        /* USE LOCAL POINTER TO FIBCPARM
*                                      FOR EFFICIENCY                */
         L     FIBCMPTR,@PC00001                                   0050
*   CSPLPTR=ADDR(CSPARML);          /* USE LOCAL POINTER TO PARMLIST
*                                      FOR EFFICIENCY                */
         L     CSPLPTR,@PC00001+4                                  0051
*   HOLDER=JOBLISTP;                /* SAVE POINTER TO HEAD OF     0052
*                                      JOBNAME AND JOBID TABLE       */
         L     HOLDER,JOBLISTP(,CSPLPTR)                           0052
*   SAVENO=TBLCOUNT;                /* SAVE COUNT OF JOBS - WILL   0053
*                                      DECREMENT THIS COUNT IF EXIT
*                                      REJECTS A JOB                 */
*                                                                  0053
         L     @04,NUMJOBSP(,CSPLPTR)                              0053
         L     SAVENO,TBLCOUNT(,@04)                               0053
*   /*****************************************************************/
*   /*                                                               */
*   /* GO TO INSTALLATION EXIT FOR STATUS COMMAND WITH OPERANDS AND  */
*   /* FOR CANCEL COMMAND                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0054
*   IF STATAUTO='0'B THEN           /* IF STATUS COMMAND WITH      0054
*                                      OPERANDS                      */
         L     @04,SWITPTR(,CSPLPTR)                               0054
         TM    STATAUTO(@04),B'00100000'                           0054
         BNZ   @RF00054                                            0054
*STATCAN:                           /* LABEL FOR DO/END GROUP        */
*     DO;                                                          0055
STATCAN  DS    0H                                                  0056
*       RFY                                                        0056
*         R0 RSTD;                                                 0056
*       GEN(LOAD EP=IKJEFF53);      /* THEN WILL NEED TO CALL      0057
*                                      INSTALLATION EXIT (IF STATUS
*                                      WAS ENTERED WITH NO OPERANDS,
*                                      BYPASS THIS DO LOOP)          */
         LOAD EP=IKJEFF53
*       SAVER0=R0;                  /* SAVE ADDRESS OF WHERE IKJEFF53
*                                      WAS LOADED                    */
         LR    SAVER0,R0                                           0058
*       RFY                                                        0059
*         R0 UNRSTD;                                               0059
*                                                                  0060
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP INTERFACE TO THE INSTALLATION EXIT                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0060
*       EXITPARM=EXITPARM&&EXITPARM;/* CLEAR EXIT PARAMETER AREA     */
         XC    EXITPARM(40),EXITPARM                               0060
*       USERIDPT=ADDR(FIBPSCBU);    /* PLACE POINTER TO USERID IN  0061
*                                      PARAMETER LIST                */
         LA    @08,FIBPSCBU(,FIBCMPTR)                             0061
         ST    @08,USERIDPT                                        0061
*       IDLENPTR=ADDR(FIBPSCBL);    /* PUT ADDRESS OF LENGTH IN    0062
*                                      PARAMETER LIST                */
         LA    @08,FIBPSCBL(,FIBCMPTR)                             0062
         ST    @08,IDLENPTR                                        0062
*       IF CANCELSW='1'B THEN       /* IF THE CANCEL SWITCH IS ON    */
         L     @08,SWITPTR(,CSPLPTR)                               0063
         TM    CANCELSW(@08),B'10000000'                           0063
         BNO   @RF00063                                            0063
*         COMMCODE=4;               /* TELL THE EXIT THAT CANCEL IS
*                                      CALLING                       */
         MVI   COMMCODE,X'04'                                      0064
*       ELSE                        /* OTHERWISE STATUS IS CALLER    */
*         COMMCODE=0;                                              0065
         B     @RC00063                                            0065
@RF00063 MVI   COMMCODE,X'00'                                      0065
*       CCODEPTR=ADDR(COMMCODE);    /* PLACE ADDRESS OF CODE       0066
*                                      INDICATING WHAT COMMAND IS  0066
*                                      CALLING THE EXIT INTO THE   0066
*                                      PARAMETER LIST                */
@RC00063 LA    @08,COMMCODE                                        0066
         ST    @08,CCODEPTR                                        0066
*       JOBIDLN=ADDR(SIZE);         /* SAVE POINTER TO AREA        0067
*                                      CONTAINING THE JOBID LENGTH   */
         LA    @08,SIZE                                            0067
         ST    @08,JOBIDLN                                         0067
*       NAMELENP=ADDR(LEN);         /* SAVE POINTER TO AREA TO     0068
*                                      CONTAIN THE JOBNAME LENGTH    */
         LA    @08,LEN                                             0068
         ST    @08,NAMELENP                                        0068
*       EXITHIGH='1'B;              /* END OF EXIT PARMLIST          */
*                                                                  0069
         OI    EXITHIGH,B'10000000'                                0069
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THRU JOBNAME LIST (GO TO EXIT FOR EACH) - PASS       */
*       /* INFORMATION FOR A JOB ON THE JOBLIST                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0070
*LOOP:                                                             0070
*       DO I=1 TO TBLCOUNT WHILE(QUIT='0'B&SAVENO^=0);/* LOOP THRU 0070
*                                      JOBNAMES - STOP EARLY IF    0070
*                                      SERIOUS ERROR OR IF TOOK LAST
*                                      JOBNAME OFF JOBNAME LIST      */
LOOP     LA    I,1                                                 0070
         B     @DE00070                                            0070
@DL00070 L     @04,SWITPTR(,CSPLPTR)                               0070
         TM    QUIT(@04),B'00001000'                               0070
         BNZ   @DC00070                                            0070
         LTR   SAVENO,SAVENO                                       0070
         BZ    @DC00070                                            0070
*         JOBNMPTR=ADDR(JOBNMID);   /* PLACE A POINTER TO JOB NAME 0071
*                                      LIST IN EXIT PARAMETER LIST   */
         L     @04,JOBLISTP(,CSPLPTR)                              0071
         LA    @04,JOBNMID(,@04)                                   0071
         ST    @04,JOBNMPTR                                        0071
*         LEN=LENGTH(JOBNMID);      /* INITIALIZE LENGTH OF JOBNAME
*                                      TO EIGHT                      */
*                                                                  0072
         MVC   LEN(2),@CH00063                                     0072
*         /***********************************************************/
*         /*                                                         */
*         /* PICK UP JOBNAME                                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0073
*         DO T=1 TO LENGTH(JOBNMID);/* SPACE OVER UNTIL THE LAST     */
         LA    T,1                                                 0073
@DL00073 DS    0H                                                  0074
*           IF JOBLISTP->JOBNMID(1,T:T)=' '/* CHARACTER OF THE       */
*             THEN                  /* NAME IS FOUND                 */
         L     @04,JOBLISTP(,CSPLPTR)                              0074
         ALR   @04,T                                               0074
         CLI   JOBNMID-1(@04),C' '                                 0074
         BNE   @RF00074                                            0074
*             DO;                                                  0075
*               LEN=T-1;            /* PLACE LENGTH IN PARM LIST     */
         LR    @04,T                                               0076
         BCTR  @04,0                                               0076
         STH   @04,LEN                                             0076
*               T=LENGTH(JOBNMID);  /* INDICATES GET OUT OF LOOP     */
         LA    T,8                                                 0077
*             END;                                                 0078
*         END;                                                     0079
*                                                                  0079
@RF00074 AH    T,@CH00046                                          0079
         CH    T,@CH00063                                          0079
         BNH   @DL00073                                            0079
*         /***********************************************************/
*         /*                                                         */
*         /* PICK UP JOBID, IF PRESENT                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0080
*         IF JOBLISTP->LEN1(1)=IDJOBID THEN                        0080
         L     @04,JOBLISTP(,CSPLPTR)                              0080
         CLI   LEN1(@04),X'44'                                     0080
         BNE   @RF00080                                            0080
*           DO;                                                    0081
*             JOBLISTP=JOBLISTP     /* UPDATE TO JOBID               */
*                 +LENGTH(JOBLIST);                                0082
         AH    @04,@CH00095                                        0082
         ST    @04,JOBLISTP(,CSPLPTR)                              0082
*             JOBIDPTR=JOBLISTP     /* PLACE POINTER TO JOBID IN EXIT
*                                      PARAMETER LIST                */
*                 +LENGTH(LEN1);                                   0083
         LA    @15,1                                               0083
         AR    @04,@15                                             0083
         ST    @04,JOBIDPTR                                        0083
*             SIZE=LENGTH(JOBNMID); /* INITIALIZE LENGTH TO EIGHT    */
         MVC   SIZE(2),@CH00063                                    0084
*             DO T=1 TO LENGTH(JOBNMID);/* FIND LENGTH OF JOBID      */
         LR    T,@15                                               0085
@DL00085 DS    0H                                                  0086
*               IF JOBLISTP->JOBNMID(1,T:T)=' ' THEN/* CHECK FOR END
*                                      OF JOBID                      */
         L     @04,JOBLISTP(,CSPLPTR)                              0086
         ALR   @04,T                                               0086
         CLI   JOBNMID-1(@04),C' '                                 0086
         BNE   @RF00086                                            0086
*                 DO;                                              0087
*                   SIZE=T-1;       /* POINTING TO ONE BEYOND SO   0088
*                                      LENGTH IS ONE LESS            */
         LR    @04,T                                               0088
         BCTR  @04,0                                               0088
         STH   @04,SIZE                                            0088
*                   T=LENGTH(JOBNMID);/* FOUND LENGTH, SO GET OUT    */
         LA    T,8                                                 0089
*                 END;                                             0090
*             END;                                                 0091
@RF00086 AH    T,@CH00046                                          0091
         CH    T,@CH00063                                          0091
         BNH   @DL00085                                            0091
*             JOBIDSW='1'B;         /* HAVE A JOBID TO PASS SO TURN
*                                      FOUND BIT ON                  */
         L     @04,SWITPTR(,CSPLPTR)                               0092
         OI    JOBIDSW(@04),B'00010000'                            0092
*             I=I+1;                /* UPDATE COUNT OF MAIN DO LOOP
*                                      BECAUSE TAKING TWO ITEMS OUT
*                                      OF LIST AT ONE TIME           */
         AH    I,@CH00046                                          0093
*           END;                                                   0094
*         ELSE                      /* NO JOBID CASE                 */
*           DO;                                                    0095
         B     @RC00080                                            0095
@RF00080 DS    0H                                                  0096
*             JOBIDSW='0'B;                                        0096
         L     @04,SWITPTR(,CSPLPTR)                               0096
         NI    JOBIDSW(@04),B'11101111'                            0096
*             JOBIDPTR=0;                                          0097
         SLR   @04,@04                                             0097
         ST    @04,JOBIDPTR                                        0097
*             SIZE=0;               /* JOBID LENGTH IS ZERO          */
         STH   @04,SIZE                                            0098
*           END;                                                   0099
*         MESSAGEP=0;               /* ZERO OUT THE MESSAGE POINTER
*                                      -- EXIT MAY USE THIS AREA     */
@RC00080 SLR   @04,@04                                             0100
         ST    @04,MESSAGEP                                        0100
*         REPLYPTR=0;               /* ZERO OUT REPLY POINTER -- EXIT
*                                      MAY LOOK FOR THE ADDRESS OF A
*                                      REPLY HERE                    */
         ST    @04,REPLYPTR                                        0101
*                                                                  0102
*         /***********************************************************/
*         /*                                                         */
*         /* CALL THE INSTALLATION EXIT - MAY BE RE-ENTRY AFTER      */
*         /* RETURN CODE 4 OR 8 IS PROCESSED                         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0102
*CALL53:                                                           0102
*         RFY                                                      0102
*          (R0,                                                    0102
*           R1,                                                    0102
*           R15)RSTD;                                              0102
CALL53   DS    0H                                                  0103
*         R1=ADDR(EXITPARM);        /* PUT ADDRESS OF PARAMETER LIST
*                                      IN REGISTER ONE               */
         LA    R1,EXITPARM                                         0103
*         CALL IKJEFF53;            /* CALL THE EXIT                 */
         LR    @15,SAVER0                                          0104
         BALR  @14,@15                                             0104
*         RETCODE=R15;              /* SAVE RETURN CODE FROM THE EXIT*/
         ST    R15,RETCODE                                         0105
*         IF REPLYPTR^=0 THEN       /* WE HAVE BEEN TO THE EXIT    0106
*                                      ALREADY AND THE EXIT REQUESTED
*                                      A REPLY - NOW IT HAS SEEN IT
*                                      SO FREE CORE USED             */
         L     @14,REPLYPTR                                        0106
         LTR   @14,@14                                             0106
         BZ    @RF00106                                            0106
*           DO;                                                    0107
*             R0=REPSIZE;           /* PICK UP SIZE OF AREA USED     */
         LH    R0,REPSIZE(,@14)                                    0108
*             R1=REPLYPTR;          /* PICK UP PTR TO REPLY AREA     */
         LR    R1,@14                                              0109
*             GEN(FREEMAIN R,LV=(0),A=(1));/* FREE THE CORE          */
         FREEMAIN R,LV=(0),A=(1)
*             REPLYPTR=0;           /* ZERO REPLY POINTER FOR NEXT 0111
*                                      JOBNAME                       */
         SLR   @14,@14                                             0111
         ST    @14,REPLYPTR                                        0111
*           END;                                                   0112
*         RFY                                                      0113
*          (R0,                                                    0113
*           R1,                                                    0113
*           R15)UNRSTD;                                            0113
@RF00106 DS    0H                                                  0114
*                                                                  0114
*/********************************************************************/
*/*                                                                  */
*/* PROCESS RETURN CODE FROM THE EXIT                                */
*/*                                                                  */
*/*     0 = O.K., CONTINUE PROCESSING                                */
*/*     4 = ISSUE PROMPT MSG IKJ56208A AND RETURN THE REPLY TO EXIT  */
*/*     8 = ISSUE INFORMATIVE MSG IKJ56208I AND RETURN TO EXIT       */
*/*          (THE IBM-SUPPLIED EXIT ISSUES R.C.=8 FOR A CANCEL WITH  */
*/*           JOBNAME ^= USERID PLUS AT LEAST ONE CHARACTER)         */
*/*     12= REJECT THIS JOB AND CONTINUE PROCESSING ANY OTHER JOBS   */
*/*          (USED AFTER R.C.=4 OR 8 PROCESSED)                      */
*/*     16= ABORT THE COMMAND                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0114
*         IF RETCODE^=EXITRC0 THEN                                 0114
         L     @04,RETCODE                                         0114
         LTR   @04,@04                                             0114
         BZ    @RF00114                                            0114
*RCODE:                                                            0115
*           DO;                     /* IF THE RETURN CODE FROM THE 0115
*                                      EXIT WAS NOT ZERO THEN START
*                                      THE RETURN CODE DIAGNOSIS     */
RCODE    DS    0H                                                  0116
*             IF RETCODE^=EXITRC16 THEN/* DID THE EXIT WISH CANCEL OR
*                                      STATUS TO ABORT               */
         CLC   RETCODE(4),@CF00067                                 0116
         BE    @RF00116                                            0116
*CODEN16:                           /* LABEL FOR DO/END GROUP        */
*               DO;                                                0117
CODEN16  DS    0H                                                  0118
*                 IF RETCODE^=EXITRC12 THEN/* NO-NO ABORT--DID THE 0118
*                                      EXIT WISH THE JOBNAME TO BE 0118
*                                      DELETED                       */
         CLC   RETCODE(4),@CF00065                                 0118
         BE    @RF00118                                            0118
*CODEN12:                           /* LABEL FOR DO/END GROUP        */
*                   DO;                                            0119
*                                                                  0119
CODEN12  DS    0H                                                  0120
*                     /***********************************************/
*                     /*                                             */
*                     /* R.C.8 -- PUT OUT EXIT'S MSG WITH NO PROMPT  */
*                     /* THEN RETURN TO EXIT                         */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0120
*                     IF RETCODE=EXITRC8 THEN                      0120
         CLC   RETCODE(4),@CF00063                                 0120
         BNE   @RF00120                                            0120
*CODE8:                                                            0121
*                       DO;         /* NO DELETION - IS THIS A     0121
*                                      REQUEST FOR A MESSAGE WITH NO
*                                      RESPONSE                      */
CODE8    DS    0H                                                  0122
*                         MSGID='208I';/* YES, SO INDICATE MESSAGE 0122
*                                      THAT IS TO BE PUT OUT         */
         L     @04,MSGPTR(,CSPLPTR)                                0122
         MVC   MSGID(4,@04),@CC00221                               0122
*                         L1=MLEN-LENGTH(MSGLNGTH);/* INDICATE LENGTH
*                                      OF MESSAGE                    */
         LA    @15,2                                               0123
         L     @14,MESSAGEP                                        0123
         SLR   @03,@03                                             0123
         IC    @03,MLEN(,@14)                                      0123
         SR    @03,@15                                             0123
         STC   @03,L1(,@04)                                        0123
*                         VAR1=MESSAGEP+LENGTH(MSGLNGTH);/* SET UP 0124
*                                      TEXT OF MESSAGE AS AN INSERT,
*                                      AND PLACE IT IN MESSAGE     0124
*                                      PARAMETER LIST                */
         AR    @14,@15                                             0124
         STCM  @14,7,VAR1(@04)                                     0124
*                       END CODE8;                                 0125
*                                                                  0126
*                     /***********************************************/
*                     /*                                             */
*                     /* R.C.4 -- PUT OUT EXIT'S MSG AND PROMPT FOR  */
*                     /* REPLY, THEN RETURN TO EXIT                  */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0126
*                     ELSE                                         0126
*                       IF RETCODE=EXITRC4 THEN/* IF WANT PUTGET     */
         B     @RC00120                                            0126
@RF00120 CLC   RETCODE(4),@CF00061                                 0126
         BNE   @RF00126                                            0126
*CODE4:                             /* LABEL FOR DO/END GROUP        */
*                         DO;                                      0127
CODE4    DS    0H                                                  0128
*                           MSGID='208A';/* INDICATE MSGID OF MESSAGE*/
         L     @04,MSGPTR(,CSPLPTR)                                0128
         MVC   MSGID(4,@04),@CC00224                               0128
*                           L1=MLEN-LENGTH(MSGLNGTH);/* INDICATE   0129
*                                      LENGTH OF MSG                 */
         LA    @15,2                                               0129
         L     @14,MESSAGEP                                        0129
         SLR   @03,@03                                             0129
         IC    @03,MLEN(,@14)                                      0129
         SR    @03,@15                                             0129
         STC   @03,L1(,@04)                                        0129
*                           VAR1=MESSAGEP+LENGTH(MSGLNGTH);/* SET UP
*                                      TEXT OF MESSAGE AS AN INSERT,
*                                      AND PLACE IT IN MESSAGE     0130
*                                      PARAMETER LIST                */
         AR    @14,@15                                             0130
         STCM  @14,7,VAR1(@04)                                     0130
*                           MTPUTLSW='0'B;/* INDICATE PUTGET MESSAGE */
         NI    MTPUTLSW(@04),B'10111111'                           0131
*                         END CODE4;                               0132
*                                                                  0132
*                     /***********************************************/
*                     /*                                             */
*                     /* UNDIAGNOSED R.C. SO PUT OUT ERROR MESSAGE   */
*                     /* AND TAKE ERROR EXIT                         */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0133
*                       ELSE                                       0133
*CODEOTH:                                                          0133
*                         DO;       /* HAD A NONZERO RETURN CODE FROM
*                                      EXIT - HOWEVER WAS UNABLE TO
*                                      DIAGNOSE IT SO PUT OUT UNABLE
*                                      TO DIAGNOSE MESSAGE           */
         B     @RC00126                                            0133
@RF00126 DS    0H                                                  0133
CODEOTH  DS    0H                                                  0134
*                           MSGID='219I';/* INDICATE 'UNKNOWN RETURN
*                                      CODE' MESSAGE ID              */
         L     @04,MSGPTR(,CSPLPTR)                                0134
         MVC   MSGID(4,@04),@CC00227                               0134
*                           VAR1=ADDR(EXITWD);/* INSERT IN FIRST   0135
*                                      LEVEL MESSAGE = 'INSTALLATION
*                                      EXIT'                         */
         LA    @15,EXITWD                                          0135
         STCM  @15,7,VAR1(@04)                                     0135
*                           L1=LENGTH(EXITWD);                     0136
         MVI   L1(@04),X'11'                                       0136
*                           VAR2=ADDR(RETCODE);/* INSERT THE RETURN
*                                      CODE                          */
         LA    @15,RETCODE                                         0137
         STCM  @15,7,VAR2(@04)                                     0137
*                           L2='84'X;/* LENGTH OF VARIABLE INSERTION
*                                      AND CONVERT R.C. TO PRINTABLE */
         MVI   L2(@04),X'84'                                       0138
*                           QUIT='1'B;/* INDICATE ERROR EXIT         */
         L     @04,SWITPTR(,CSPLPTR)                               0139
         OI    QUIT(@04),B'00001000'                               0139
*                         END CODEOTH;                             0140
*                                                                  0141
*                     /***********************************************/
*                     /*                                             */
*                     /* ISSUE MESSAGE                               */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0141
*                     RFY                                          0141
*                      (R1,                                        0141
*                       R15)RSTD;                                  0141
@RC00126 DS    0H                                                  0141
@RC00120 DS    0H                                                  0142
*                     R1=ADDR(MSGTABLE);/* GET ADDRESS OF IKJEFF02 0142
*                                      PARAMETER LIST                */
         L     R1,MSGPTR(,CSPLPTR)                                 0142
*                     CALL IKJEFF02;/* ISSUE THE MESSAGE             */
         L     @15,MSGRTNPT(,CSPLPTR)                              0143
         BALR  @14,@15                                             0143
*                     MSGCODE=R15;  /* ONLY CHECK FOR IKJEFF02     0144
*                                      R.C.=12, (ALWAYS ASSUME CAN DO
*                                      A PUTLINE WHEN WORKING WITH 0144
*                                      INSTALLATION EXIT MESSAGES)   */
         LR    MSGCODE,R15                                         0144
*                     RFY                                          0145
*                      (R1,                                        0145
*                       R15)UNRSTD;                                0145
*                     MTPUTLSW='1'B;/* ENSURE PUTLINE, NOT PUTGET  0146
*                                      (NOPROMPT)                    */
         L     @01,MSGPTR(,CSPLPTR)                                0146
         OI    MTPUTLSW(@01),B'01000000'                           0146
*                     IF RETCODE=EXITRC8×(RETCODE=EXITRC4&MSGCODE^=
*                         MSGRC12)THEN/* IF RETURN CODE FROM EXIT WAS
*                                      EITHER 4 0R 8 WILL NEED     0147
*                                      RE-ENTRY INTO THE EXIT        */
         L     @15,RETCODE                                         0147
         CH    @15,@CH00063                                        0147
         BE    @RT00147                                            0147
         CH    @15,@CH00061                                        0147
         BNE   @RF00147                                            0147
         CH    MSGCODE,@CH00065                                    0147
         BE    @RF00147                                            0147
@RT00147 DS    0H                                                  0148
*                       DO;                                        0148
*                         IF RETCODE=EXITRC4 THEN/* RETURN REPLY FROM
*                                      PUTGET MESSAGE TO THE EXIT    */
         CLC   RETCODE(4),@CF00061                                 0149
         BNE   @RF00149                                            0149
*                           REPLYPTR=RETMSG;                       0150
         L     @04,MSGPTR(,CSPLPTR)                                0150
         SLR   @15,@15                                             0150
         ICM   @15,7,RETMSG(@04)                                   0150
         ST    @15,REPLYPTR                                        0150
*                         MTINSRTS=MTINSRTS&&MTINSRTS;/* CLEAR     0151
*                                      MESSAGE INSERT AREA           */
@RF00149 L     @04,MSGPTR(,CSPLPTR)                                0151
         XC    MTINSRTS(16,@04),MTINSRTS(@04)                      0151
*                         GO TO CALL53;/* CALL THE EXIT AGAIN        */
         B     CALL53                                              0152
*                       END;                                       0153
*                                                                  0153
*                     /***********************************************/
*                     /*                                             */
*                     /* ERROR MSG IF R.C.=4 AND USER IN NOPROMPT    */
*                     /* MODE                                        */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0154
*                     ELSE                                         0154
*                       IF MSGCODE=MSGRC12&RETCODE=EXITRC4 THEN/*  0154
*                                      TRIED TO GET REPLY BUT USER IN
*                                      NO PROMPT MODE                */
@RF00147 CH    MSGCODE,@CH00065                                    0154
         BNE   @RF00154                                            0154
         CLC   RETCODE(4),@CF00061                                 0154
         BNE   @RF00154                                            0154
*                         DO;                                      0155
*                           QUIT='1'B;/* CONSIDER THIS AN ERROR SO 0156
*                                      QUIT                          */
         L     @04,SWITPTR(,CSPLPTR)                               0156
         OI    QUIT(@04),B'00001000'                               0156
*                           MSGID='218I';/* PICK UP ID OF ERROR MSG  */
         L     @04,MSGPTR(,CSPLPTR)                                0157
         MVC   MSGID(4,@04),@CC00229                               0157
*                           IF L1>80 THEN/* MSG WITH TOO MANY CHARS  */
         CLI   L1(@04),80                                          0158
         BNH   @RF00158                                            0158
*                             L1=80;/* WANT TO PUT OUT PART OF MSG 0159
*                                      THAT THE EXIT TRIED TO PUT  0159
*                                      OUT, BUT ONLY 80 CHARS (VAR1
*                                      IS SAME) (THIS IS INSERT FOR
*                                      2ND LEVEL MSG)                */
         MVI   L1(@04),X'50'                                       0159
*                           L2=LENGTH(FIBECTCN);/* INSERT =          */
@RF00158 L     @04,MSGPTR(,CSPLPTR)                                0160
         MVI   L2(@04),X'08'                                       0160
*                           VAR2=ADDR(FIBECTCN);/* COMMAND NAME      */
         LA    @15,FIBECTCN(,FIBCMPTR)                             0161
         STCM  @15,7,VAR2(@04)                                     0161
*                           L3=LENGTH(EXITWD);/* INSERT =            */
         MVI   L3(@04),X'11'                                       0162
*                           VAR3=ADDR(EXITWD);/* 'INSTALLATION EXIT' */
         LA    @15,EXITWD                                          0163
         STCM  @15,7,VAR3(@04)                                     0163
*                           RFY                                    0164
*                             R1 RSTD;                             0164
*                           R1=ADDR(MSGTABLE);/* GET ADDRESS OF MSG
*                                      RTN PARAMETER LIST            */
         LR    R1,@04                                              0165
*                           CALL IKJEFF02;/* ISSUE THE MESSAGE       */
         L     @15,MSGRTNPT(,CSPLPTR)                              0166
         BALR  @14,@15                                             0166
*                           RFY                                    0167
*                             R1 UNRSTD;                           0167
*                         END;                                     0168
*                   END CODEN12;                                   0169
*                                                                  0169
*                 /***************************************************/
*                 /*                                                 */
*                 /* R.C.=12, SO DELETE THIS JOB FROM THE PARAMETER  */
*                 /* LIST. (ASSUME EXIT HAS PREVIOUSLY ISSUED AN     */
*                 /* ERROR MESSAGE.)                                 */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0170
*                 ELSE              /* THE EXIT DID PASS             */
*CODE12:                                                           0170
*                   DO;             /* BACK A TWELVE RETURN CODE     */
         B     @RC00118                                            0170
@RF00118 DS    0H                                                  0170
CODE12   DS    0H                                                  0171
*                     SAVENO=SAVENO-1;/* SUBTRACT FROM THE NUMBER OF
*                                      ENTRIES IN THE JOBNAME LIST 0171
*                                      BECAUSE THE EXIT WANTED THIS
*                                      JOBNAME DELETED               */
         BCTR  SAVENO,0                                            0171
*                     IF JOBIDSW=ON THEN/* IF JOBID, BACK            */
         L     @04,SWITPTR(,CSPLPTR)                               0172
         TM    JOBIDSW(@04),B'00010000'                            0172
         BNO   @RF00172                                            0172
*                       DO;         /* UP TO JOBNAME                 */
*                         JOBLISTP=JOBLISTP/* BACK UP ONE            */
*                             -LENGTH(JOBLIST);                    0174
         L     @04,JOBLISTP(,CSPLPTR)                              0174
         SH    @04,@CH00095                                        0174
         ST    @04,JOBLISTP(,CSPLPTR)                              0174
*                         SAVENO=SAVENO-1;/* SUBTRACT FROM NUMBER OF
*                                      ENTRIES                       */
         BCTR  SAVENO,0                                            0175
*                         JOBPTR=JOBLISTP+18;/* POINT TO NEXT SLOT   */
         AH    @04,@CH00161                                        0176
         LR    JOBPTR,@04                                          0176
*                       END;                                       0177
*                     ELSE          /* POINTING TO JOBNAME           */
*                       JOBPTR=JOBLISTP/* POINT TO NEXT SLOT SO CAN
*                                      MOVE ALL JOBS UP              */
*                           +LENGTH(JOBLIST);                      0178
         B     @RC00172                                            0178
@RF00172 LA    JOBPTR,9                                            0178
         A     JOBPTR,JOBLISTP(,CSPLPTR)                           0178
*                                                                  0179
*                     /***********************************************/
*                     /*                                             */
*                     /* TEST FOR POSITION ON JOBLIST                */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0179
*                     IF I=TBLCOUNT THEN                           0179
*                                                                  0179
@RC00172 L     @04,NUMJOBSP(,CSPLPTR)                              0179
         C     I,TBLCOUNT(,@04)                                    0179
         BNE   @RF00179                                            0179
*                       /*********************************************/
*                       /*                                           */
*                       /* THIS ENTRY IS AT END (DON'T USE JOBPTR)   */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0180
*                       JOBLISTP=JOBLISTP/* BACK UP TO PRIOR ENTRY   */
*                           -LENGTH(JOBLIST);                      0180
*                                                                  0180
         L     @04,JOBLISTP(,CSPLPTR)                              0180
         SH    @04,@CH00095                                        0180
         ST    @04,JOBLISTP(,CSPLPTR)                              0180
*                     /***********************************************/
*                     /*                                             */
*                     /* THIS ENTRY IS AT BEGINNING OR IN THE MIDDLE */
*                     /* OF JOB LIST (AND IS NOT THE ONLY ENTRY)     */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0181
*                     ELSE                                         0181
*NOTEND:                            /* LABEL FOR DO/END GROUP        */
*                       DO;                                        0181
         B     @RC00179                                            0181
@RF00179 DS    0H                                                  0181
NOTEND   DS    0H                                                  0182
*                         SAVEHEAD=JOBLISTP;/* SAVE HEAD FROM THIS 0182
*                                      POINT ON                      */
         L     @04,JOBLISTP(,CSPLPTR)                              0182
         ST    @04,SAVEHEAD                                        0182
*                         DO WHILE JOBPTR->LEN1(1)^=IDLASTJB;/* END
*                                      UPDATE LOOP AT LAST JOB'S   0183
*                                      ENTRY (LAST ENTRY IS MOVED UP)*/
         B     @DE00183                                            0183
@DL00183 DS    0H                                                  0184
*                           JOBLISTP->JOBLIST(1)=JOBEL;/* COPY     0184
*                                      CURRENT ENTRY TO PRIOR      0184
*                                      POSITION                      */
         L     @04,JOBLISTP(,CSPLPTR)                              0184
         MVC   JOBLIST(9,@04),JOBEL(JOBPTR)                        0184
*                           JOBLISTP=JOBLISTP+LENGTH(JOBLIST);/*   0185
*                                      UPDATE POSITION POINTER BY ONE
*                                      FIELD                         */
         LA    @03,9                                               0185
         AR    @04,@03                                             0185
         ST    @04,JOBLISTP(,CSPLPTR)                              0185
*                           JOBPTR=JOBPTR+LENGTH(JOBLIST);/* UPDATE
*                                      ENTRY POINTER BY ONE FIELD    */
         AR    JOBPTR,@03                                          0186
*                         END;                                     0187
@DE00183 CLI   LEN1(JOBPTR),X'80'                                  0187
         BNE   @DL00183                                            0187
*                         JOBLISTP->JOBLIST(1)=JOBEL;/* NOW HANDLE 0188
*                                      THE LAST ENTRY                */
         L     @04,JOBLISTP(,CSPLPTR)                              0188
         MVC   JOBLIST(9,@04),JOBEL(JOBPTR)                        0188
*                       END NOTEND;                                0189
*                                                                  0189
*                     /***********************************************/
*                     /*                                             */
*                     /* INDICATE THE NEW LAST ENTRY (UNLESS THIS IS */
*                     /* THE ONLY ENTRY ON THE JOBLIST)              */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0190
*                     IF SAVENO^=0 THEN                            0190
@RC00179 LTR   SAVENO,SAVENO                                       0190
         BZ    @RF00190                                            0190
*                       JOBLISTP->LEN1(1)=IDLASTJB;/* MARK THIS AS 0191
*                                      LAST ENTRY                    */
         L     @04,JOBLISTP(,CSPLPTR)                              0191
         MVI   LEN1(@04),X'80'                                     0191
*                   END CODE12;                                    0192
*               END CODEN16;                                       0193
*                                                                  0193
*             /*******************************************************/
*             /*                                                     */
*             /* R.C.=16 SO TAKE ERROR EXIT WITHOUT ISSUING MESSAGE  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0194
*             ELSE                                                 0194
*CODE16:                                                           0194
*               DO;                 /* THE EXIT DID PASS BACK A    0194
*                                      RETURN CODE OF SIXTEEN        */
         B     @RC00116                                            0194
@RF00116 DS    0H                                                  0194
CODE16   DS    0H                                                  0195
*                 QUIT='1'B;        /* TURN ON QUIT BIT              */
         L     @04,SWITPTR(,CSPLPTR)                               0195
         OI    QUIT(@04),B'00001000'                               0195
*               END CODE16;                                        0196
*           END RCODE;              /* END NON-ZERO R.C.             */
*                                                                  0197
@RC00116 DS    0H                                                  0198
*         /***********************************************************/
*         /*                                                         */
*         /* CONTINUE LOOP THRU JOBNAMES IN PARAMETER LIST UNLESS    */
*         /* QUIT SWITCH IS NOW ON                                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0198
*         IF RETCODE=EXITRC12 THEN                                 0198
@RF00114 CLC   RETCODE(4),@CF00065                                 0198
         BNE   @RF00198                                            0198
*           JOBLISTP=SAVEHEAD;      /* USE THIS JOBNAME - ALREADY  0199
*                                      UPDATED                       */
         L     @04,SAVEHEAD                                        0199
         ST    @04,JOBLISTP(,CSPLPTR)                              0199
*         ELSE                      /* NO ERROR WITH THIS ENTRY SO   */
*           JOBLISTP=JOBLISTP       /* UPDATE TO NEXT JOBNAME        */
*               +LENGTH(JOBLIST);                                  0200
         B     @RC00198                                            0200
@RF00198 LA    @04,9                                               0200
         A     @04,JOBLISTP(,CSPLPTR)                              0200
         ST    @04,JOBLISTP(,CSPLPTR)                              0200
*       END LOOP;                   /* END OF ALL CALLS TO THE EXIT  */
@RC00198 AH    I,@CH00046                                          0201
@DE00070 L     @04,NUMJOBSP(,CSPLPTR)                              0201
         C     I,TBLCOUNT(,@04)                                    0201
         BNH   @DL00070                                            0201
@DC00070 DS    0H                                                  0202
*       GEN(DELETE EP=IKJEFF53);    /* DONE WITH EXIT                */
         DELETE EP=IKJEFF53
*     END STATCAN;                  /* END OF INTERFACE, CALL, AND 0203
*                                      DIAGNOSIS                     */
*                                                                  0204
*   /*****************************************************************/
*   /*                                                               */
*   /* GO TO NEXT CANCEL/STATUS MODULE IF NO ERROR AND JOB LEFT ON   */
*   /* LIST.                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0204
*   IF SAVENO^=0&QUIT^='1'B THEN                                   0204
@RF00054 LTR   SAVENO,SAVENO                                       0204
         BZ    @RF00204                                            0204
         L     @04,SWITPTR(,CSPLPTR)                               0204
         TM    QUIT(@04),B'00001000'                               0204
         BO    @RF00204                                            0204
*CALLNEXT:                                                         0205
*     DO;                           /* IF NO ERRORS ENCOUNTERED OR AT
*                                      LEAST HAVE ONE JOB IN LIST  0205
*                                      THEN PROCEED                  */
CALLNEXT DS    0H                                                  0206
*       JOBLISTP=HOLDER;            /* RESTORE POINTER TO HEAD OF JOB
*                                      NAME LIST                     */
         ST    HOLDER,JOBLISTP(,CSPLPTR)                           0206
*       TBLCOUNT=SAVENO;            /* PUT NEW NUMBER OF ENTRIES IN
*                                      PARAMETER LIST                */
         L     @10,NUMJOBSP(,CSPLPTR)                              0207
         ST    SAVENO,TBLCOUNT(,@10)                               0207
*       MTINSRTS=MTINSRTS&&MTINSRTS;/* ZERO MESSAGE INSERT AREA OF 0208
*                                      MSGTABLE                      */
         L     @10,MSGPTR(,CSPLPTR)                                0208
         XC    MTINSRTS(16,@10),MTINSRTS(@10)                      0208
*       JOBIDSW='0'B;               /* CLEAR SWITCH IN PARMLIST      */
*                                                                  0209
         L     @10,SWITPTR(,CSPLPTR)                               0209
         NI    JOBIDSW(@10),B'11101111'                            0209
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP PARAMETERS TO PASS INTO NEXT MODULE                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0210
*       CSPTR1=ADDR(FIBCPARM);      /* R1 -> CSPTR1 -> FIBCPARM      */
         ST    FIBCMPTR,CSPTR1                                     0210
*       CSPTR2=ADDR(PARMLIST);      /* PASS A POINTER TO           0211
*                                      CANCEL/STATUS PARAMETER LIST  */
         ST    CSPLPTR,CSPTR2                                      0211
*       CSHIGH='1'B;                /* STANDARD LINKAGE CONVENTION   */
         OI    CSHIGH,B'10000000'                                  0212
*       RFY                                                        0213
*         R1 RSTD;                                                 0213
*       R1=ADDR(CSPTRS);            /* SET UP REG ONE AS CONVEYOR OF
*                                      PARAMETERS                    */
         LA    R1,CSPTRS                                           0214
*       IF CANCELSW='1'B THEN       /* THIS IS A CANCEL SO           */
         TM    CANCELSW(@10),B'10000000'                           0215
         BNO   @RF00215                                            0215
*         CALL IKJEFF54;            /* GO PROCESS CANCEL COMMAND     */
         L     @15,@CV00050                                        0216
         BALR  @14,@15                                             0216
*       ELSE                        /* STATUSSW OR STATAUTO ON       */
*         CALL IKJEFF52;            /* SO PROCESS STATUS COMMAND     */
         B     @RC00215                                            0217
@RF00215 L     @15,@CV00049                                        0217
         BALR  @14,@15                                             0217
*       RFY                                                        0218
*         R15 RSTD;                                                0218
@RC00215 DS    0H                                                  0219
*       RETCODE=R15;                /* SAVE THE RETURN CODE          */
         ST    R15,RETCODE                                         0219
*       RFY                                                        0220
*        (R1,                                                      0220
*         R15)UNRSTD;                                              0220
*     END CALLNEXT;                                                0221
*   ELSE                            /* NO REASON TO GO TO NEXT MODULE*/
*     DO;                                                          0222
         B     @RC00204                                            0222
@RF00204 DS    0H                                                  0223
*       IF QUIT='1'B THEN           /* HAD A TERMINATING ERROR FOUND */
         L     @10,SWITPTR(,CSPLPTR)                               0223
         TM    QUIT(@10),B'00001000'                               0223
         BNO   @RF00223                                            0223
*         RETCODE=12;                                              0224
         MVC   RETCODE(4),@CF00065                                 0224
*       IF SAVENO=0 THEN            /* HAD ALL JOBS REJECTED BY EXIT */
@RF00223 SLR   @10,@10                                             0225
         CR    SAVENO,@10                                          0225
         BNE   @RF00225                                            0225
*         RETCODE=0;                                               0226
         ST    @10,RETCODE                                         0226
*     END;                                                         0227
@RF00225 DS    0H                                                  0228
*   RETURN CODE(RETCODE);           /* RETURN WITH APPROPRIATE CODE  */
@RC00204 L     @10,RETCODE                                         0228
         L     @13,4(,@13)                                         0228
         L     @00,@SIZDATD                                        0228
         LR    @01,@11                                             0228
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0228
         L     @14,12(,@13)                                        0228
         LM    @00,@12,20(@13)                                     0228
         BR    @14                                                 0228
*   END IKJEFF51                                                   0229
*                                                                  0229
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IKJEFFB2)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFPT)                                       */
*/*%INCLUDE SYSLIB  (IKJEFFMT)                                       */
*                                                                  0229
*       ;                                                          0229
@DATA    DS    0H
@CH00046 DC    H'1'
@CH00095 DC    H'9'
@CH00161 DC    H'18'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
IKJEFF51 CSECT
         DS    0F
@CF00061 DC    F'4'
@CH00061 EQU   @CF00061+2
@CF00063 DC    F'8'
@CH00063 EQU   @CF00063+2
@CF00065 DC    F'12'
@CH00065 EQU   @CF00065+2
@CF00067 DC    F'16'
@DATD    DSECT
         DS    0D
RETCODE  DS    A
SAVEHEAD DS    A
LEN      DS    H
SIZE     DS    H
COMMCODE DS    AL1
         DS    CL3
CSPTRS   DS    CL8
         ORG   CSPTRS
CSPTR1   DS    AL4
CSPTR2   DS    AL4
         ORG   CSPTR2
CSHIGH   DS    BL1
         ORG   CSPTRS+8
EXITPARM DS    CL40
         ORG   EXITPARM
JOBNMPTR DS    AL4
NAMELENP DS    AL4
USERIDPT DS    AL4
IDLENPTR DS    AL4
MESSAGEP DS    AL4
REPLYPTR DS    AL4
CCODEPTR DS    AL4
JOBIDPTR DS    AL4
JOBIDLN  DS    AL4
@NM00010 DS    AL4
         ORG   @NM00010
EXITHIGH DS    BL1
         ORG   EXITPARM+40
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IKJEFF51 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00049 DC    V(IKJEFF52)
@CV00050 DC    V(IKJEFF54)
         DS    0D
@CC00221 DC    C'208I'
@CC00224 DC    C'208A'
@CC00227 DC    C'219I'
@CC00229 DC    C'218I'
EXITWD   DC    CL17'INSTALLATION EXIT'
PATCH    DS    CL51
         ORG   PATCH
PTCHINIT DC    17CL3'ZAP'
         ORG   PATCH+51
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MSGCODE  EQU   @04
T        EQU   @02
I        EQU   @08
SAVENO   EQU   @06
JOBPTR   EQU   @02
HOLDER   EQU   @10
SAVER0   EQU   @09
CSPLPTR  EQU   @05
FIBCMPTR EQU   @07
R0       EQU   @00
R1       EQU   @01
R15      EQU   @15
IKJEFF53 EQU   0
FIBCPARM EQU   0
FIBPSCBU EQU   FIBCPARM+4
FIBPSCBL EQU   FIBCPARM+11
FIBECTCN EQU   FIBCPARM+28
FIBFLAGS EQU   FIBCPARM+36
PARMLIST EQU   0
JOBLISTP EQU   PARMLIST
NUMJOBSP EQU   PARMLIST+4
SWITPTR  EQU   PARMLIST+8
MSGRTNPT EQU   PARMLIST+12
MSGPTR   EQU   PARMLIST+16
JOBLIST  EQU   0
LEN1     EQU   JOBLIST
JOBNMID  EQU   JOBLIST+1
TBLCOUNT EQU   0
SWITCHES EQU   0
CANCELSW EQU   SWITCHES
STATAUTO EQU   SWITCHES
JOBIDSW  EQU   SWITCHES
QUIT     EQU   SWITCHES
IKJEFF02 EQU   0
MSGTABLE EQU   0
TMCTPTR  EQU   MSGTABLE+4
ECBPTR   EQU   MSGTABLE+8
@NM00005 EQU   MSGTABLE+12
SW       EQU   MSGTABLE+20
MTPUTLSW EQU   SW
RETMSG   EQU   MSGTABLE+21
SW2      EQU   MSGTABLE+24
MSGID    EQU   MSGTABLE+40
MTINSRTS EQU   MSGTABLE+44
L1       EQU   MTINSRTS
VAR1     EQU   MTINSRTS+1
L2       EQU   MTINSRTS+4
VAR2     EQU   MTINSRTS+5
L3       EQU   MTINSRTS+8
VAR3     EQU   MTINSRTS+9
L4       EQU   MTINSRTS+12
RET      EQU   0
REPTEXT  EQU   0
REPSIZE  EQU   REPTEXT
MSGLNGTH EQU   0
MLEN     EQU   MSGLNGTH+1
JOBEL    EQU   0
MSGECB   EQU   0
MSGTMCT  EQU   0
FIBPARML EQU   0
CSPARML  EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00011 EQU   MSGLNGTH
REPBUF   EQU   REPTEXT+2
RETCHAR  EQU   RET+2
RETSIZE  EQU   RET
MSGRTN   EQU   MSGTABLE+60
VAR4     EQU   MTINSRTS+13
HIGHL4   EQU   L4
HIGHL3   EQU   L3
HIGHL2   EQU   L2
HIGHL1   EQU   L1
@NM00009 EQU   MSGTABLE+36
@NM00008 EQU   MSGTABLE+32
MTOLDPTR EQU   MSGTABLE+28
@NM00007 EQU   MSGTABLE+25
@NM00006 EQU   SW2
MTDOMSW  EQU   SW2
MT2OLDSW EQU   SW2
MTNHEXSW EQU   SW
MTWTPSW  EQU   SW
MTJOBISW EQU   SW
MTKEY1SW EQU   SW
MTHEXSW  EQU   SW
MTWTOSW  EQU   SW
MTNOIDSW EQU   SW
MSGCSECT EQU   MSGTABLE+16
MTHIGH   EQU   @NM00005
MTCPPL   EQU   TMCTPTR
LISTPTR  EQU   MSGTABLE
@NM00004 EQU   SWITCHES
PTPURGSW EQU   SWITCHES
STATUSSW EQU   SWITCHES
PTHIGH   EQU   MSGPTR
FIBCMDBF EQU   FIBCPARM+52
@NM00003 EQU   FIBCPARM+48
@NM00002 EQU   FIBCPARM+44
FIBCUSER EQU   FIBCPARM+40
@NM00001 EQU   FIBCPARM+38
FIBECTNO EQU   FIBFLAGS
FIBCPPLE EQU   FIBCPARM+24
FIBCPPLP EQU   FIBCPARM+20
FIBCPPLU EQU   FIBCPARM+16
FIBCPPLC EQU   FIBCPARM+12
FIBCID   EQU   FIBCPARM+2
FIBCLEN  EQU   FIBCPARM
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00118 EQU   @RC00116
@RF00190 EQU   @RC00116
@RF00154 EQU   @RC00118
@ENDDATA EQU   *
         END   IKJEFF51,(C'PL/S-II',0502,73293)

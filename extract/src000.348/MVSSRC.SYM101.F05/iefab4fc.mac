         TITLE 'IEFAB4FC - TIOT MANAGER CONTROL ROUTINE                *
                        '
IEFAB4FC CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFAB4FC  74.099'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@12                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE  R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(4),0(@01)                               01S0001
         MODESET EXTKEY=SCHED
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*/* END OF DATA DEFINITIONS                                          */
*TIORBPTR = INRBPTR;                   /*INIT PTR TO REQUEST BLOCK   */
         L     @08,@PC00001                                     01S0048
         L     TIORBPTR,INRBPTR(,@08)                           01S0048
*RETCODE = NOERROR;                    /*INIT RETURN CODE FIELD      */
         SLR   RETCODE,RETCODE                                  01S0049
*RFY IEZJSCB BASED(JSCBPTR);                                    01S0050
*JSCBPTR = TIOMJSCP;                   /*SET PTR TO INPUT JSCB       */
         L     JSCBPTR,TIOMJSCP(,TIORBPTR)                      01S0051
*IF TIOMBLD = YES THEN                 /*CREATE REQUESTED?           */
         TM    TIOMBLD(TIORBPTR),B'10000000'                    01S0052
         BNO   @RF00052                                         01S0052
*  DO;                                                          01S0053
*/********************************************************************/
*/* SEGMENT NAME - GETTIOT                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GET TIOT/QDB CORE                             */
*/*                                                                  */
*/* FUNCTION - GETS/CLEARS CORE FOR TIOT AND DSAB QDB. INITIALIZES   */
*/*   THE FIXED FIELDS OF THE DSAB QDB.                              */
*/*                                                                  */
*/* ENTRY - IN-LINE ROUTINE IS ENTERED AT TOP BY TIOT MANAGER WHEN   */
*/*   THE CREATE FUNCTION IS REQUESTED                               */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JSCBPTR - POINTER TO INPUT JSCB                              */
*/*       JSCBSWSP - SWA SUBPOOL ID                                  */
*/*     TIORBPTR  - POINTER TO TIOT MANAGER REQUEST BLOCK            */
*/*       TIOMTSZE - REQUESTED TIOT SIZE                             */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION 1 - NO GETMAIN ERRORS                                */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*     JSCB UPDATED                                                 */
*/*       JSCTMCOR - PTR TO TIOT CORE                                */
*/*       JSCDSABQ - PTR TO QSAB QDB                                 */
*/*     QDB (FIXED) FIELDS INITIALIZED                               */
*/*                                                                  */
*/*   RETURN CODE -                                                  */
*/*     RETCODE = 0                                                  */
*/*                                                                  */
*/*   CONDITION 2 - NO CORE AVAILABLE FOR TIOT OR FOR QDB            */
*/*                                                                  */
*/*   OUTPUT - NONE                                                  */
*/*                                                                  */
*/*   RETURN CODE -                                                  */
*/*     RETCODE = 4                                                  */
*/********************************************************************/
*                                                               02S0054
*SWASPID = JSCBSWSP;                   /*SET SWA SUBPOOL ID          */
         SLR   @08,@08                                          02S0054
         IC    @08,JSCBSWSP(,JSCBPTR)                           02S0054
         ST    @08,SWASPID                                      02S0054
*TIOTSIZE = TIOMTSZE;                  /*SET AMT OF CORE REQUIRED    */
         LH    TIOTSIZE,TIOMTSZE(,TIORBPTR)                     02S0055
* /* ?GETSTORG (SWASPID,TIOTSIZE,TMCORPTR) NOCLEAR;*/           02S0056
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0056
*   DCL                                                         02S0056
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0056
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0056
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0056
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0056
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0056
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0057
*   GTSTR0 = TIOTSIZE; /* SET AMOUNT*/                          02S0058
         LR    GTSTR0,TIOTSIZE                                  02S0058
*   GTSTR2 = SWASPID; /* SET SUBPOOL*/                          02S0059
         LR    GTSTR2,@08                                       02S0059
*   GENERATE CODE;                                              02S0060
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0061
         ST    GTSTR15,GTSTRTCD                                 02S0061
*   TMCORPTR = GTSTR1; /* ADDR OF GOTN STORG*/                  02S0062
         LR    TMCORPTR,GTSTR1                                  02S0062
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0063
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0064
         L     @08,GTSTRTCD                                     02S0064
         LR    GTSTR15,@08                                      02S0064
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET CORE FOR TIOT   */                                       02S0065
*RETCODE = REG15;                      /*SAVE RETURN CODE            */
*                                                               02S0065
         LR    RETCODE,REG15                                    02S0065
*IF RETCODE = NOERROR THEN                                      02S0066
         SLR   @08,@08                                          02S0066
         CR    RETCODE,@08                                      02S0066
         BNE   @RF00066                                         02S0066
*  DO;                                                          02S0067
*     DO; /*MODESET  KEYADDR(ZERO)*/                            02S0068
*       SPKA (ZERO); /*SET PSW KEY*/                            02S0069
         SPKA  0(@08)                                           02S0069
*     END; /*MODESET  KEYADDR(ZERO)*/           /*GET KEY ZERO TO UPDAT
* JSCB */                                                       02S0070
*    JSCTMCOR = TMCORPTR;                                       02S0071
         ST    TMCORPTR,JSCTMCOR(,JSCBPTR)                      02S0071
*     DO; /*MODESET  EXTKEY(SCHED)*/                            02S0072
*       SPKA (16); /*SET PSW KEY*/                              02S0073
         LA    @08,16                                           02S0073
         SPKA  0(@08)                                           02S0073
*     END; /*MODESET  EXTKEY(SCHED)*/           /*RETURN TO SCHEDULER K
*Y     */                                                       02S0074
*    DSAQDBLN = LENGTH(DSABQDB);                                02S0075
         LA    @08,28                                           02S0075
         ST    @08,DSAQDBLN                                     02S0075
*     /* ?GETSTORG (SWASPID,DSAQDBLN,DQDBCORP);*/               02S0076
*       DCL                                                     02S0076
*         GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/           02S0076
*         GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/           02S0076
*         GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/           02S0076
*         GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/           02S0076
*         GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/           02S0076
*         GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/           02S0076
*         GTSTZERO FIXED(31) INIT(0),                           02S0076
*         GTST253  FIXED(31) CONSTANT(253);                     02S0076
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           02S0077
*       GTSTR0 = DSAQDBLN; /* SET AMOUNT*/                      02S0078
         LR    GTSTR0,@08                                       02S0078
*       GTSTR2 = SWASPID; /* SET SUBPOOL*/                      02S0079
         L     GTSTR2,SWASPID                                   02S0079
*       GENERATE CODE;                                          02S0080
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           02S0081
         ST    GTSTR15,GTSTRTCD                                 02S0081
*       DQDBCORP = GTSTR1; /* ADDR OF GOTN STORG*/              02S0082
         ST    GTSTR1,DQDBCORP                                  02S0082
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            02S0083
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           02S0084
         L     @08,GTSTRTCD                                     02S0084
         LTR   @08,@08                                          02S0084
         BNZ   @RF00084                                         02S0084
*         DO;               /* YES, CLEAR STORAGE.*/            02S0085
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0086
*                              GTSTR7,GTSTR8) RSTD;             02S0086
*           GTSTR4 = DQDBCORP; /*STORG PTR*/                    02S0087
         L     @03,DQDBCORP                                     02S0087
         LR    GTSTR4,@03                                       02S0087
*           GTSTR5 = DSAQDBLN; /*STORG AMNT*/                   02S0088
         L     GTSTR5,DSAQDBLN                                  02S0088
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           02S0089
         SLR   GTSTR7,GTSTR7                                    02S0089
*           IF SWASPID = GTST253 THEN                           02S0090
         CLC   SWASPID(4),@CF00638                              02S0090
         BNE   @RF00090                                         02S0090
*          GEN                                                  02S0091
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       02S0091
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*           GEN REFS(GTSTR4,GTSTR6);                            02S0092
@RF00090 DS    0H                                               02S0092
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*           IF SWASPID = GTST253 THEN                           02S0093
         CLC   SWASPID(4),@CF00638                              02S0093
         BNE   @RF00093                                         02S0093
*             GEN (MODESET KEYADDR=(2));                        02S0094
         MODESET KEYADDR=(2)
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0095
*                              GTSTR7,GTSTR8) UNRSTD;           02S0095
@RF00093 DS    0H                                               02S0096
*         END;       /* STORAGE CLEARING COMPLETED */           02S0096
*       ELSE                                                    02S0097
*       DQDBCORP= 0;   /* CLEAR RETURN ADDR. */                 02S0097
         B     @RC00084                                         02S0097
@RF00084 SLR   @08,@08                                          02S0097
         ST    @08,DQDBCORP                                     02S0097
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           02S0098
@RC00084 L     GTSTR15,GTSTRTCD                                 02S0098
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET CORE FOR DSAB CHAIN                                            A
*CHOR BLOCK.               */                                   02S0099
*    RETCODE = REG15;                                           02S0099
         LR    RETCODE,REG15                                    02S0099
*  END;                                                         02S0100
*IF RETCODE = NOERROR THEN             /*ANY GETMAIN ERROR?          */
@RF00066 SLR   @08,@08                                          02S0101
         CR    RETCODE,@08                                      02S0101
         BNE   @RF00101                                         02S0101
*  DO;                                 /*NO, SET UP QDB FOR STEP     */
*     DO; /*MODESET  KEYADDR(ZERO)*/                            02S0103
*       SPKA (ZERO); /*SET PSW KEY*/                            02S0104
         SPKA  0(@08)                                           02S0104
*     END; /*MODESET  KEYADDR(ZERO)*/           /*GET KEY ZERO TO UPDAT
* JSCB */                                                       02S0105
*    JSCDSABQ = DQDBCORP;              /*SET PTR TO START OF QDB CORE
*                                        INTO JSCB                   */
         L     @06,DQDBCORP                                     02S0106
         ST    @06,JSCDSABQ(,JSCBPTR)                           02S0106
*     DO; /*MODESET  EXTKEY(SCHED)*/                            02S0107
*       SPKA (16); /*SET PSW KEY*/                              02S0108
         LA    @03,16                                           02S0108
         SPKA  0(@03)                                           02S0108
*     END; /*MODESET  EXTKEY(SCHED)*/           /*RETURN TO SCHEDULER K
*Y     */                                                       02S0109
*    DSQDBID = DSABNM;                 /*SET 'Q' ACRONYM TO 'DSAB'   */
         MVC   DSQDBID(4,@06),@CC00592                          02S0110
*    DSQDBLN = LENGTH(DSABQDB);        /*LENGTH OF DSAB QDB          */
         MVC   DSQDBLN(2,@06),@CH00655                          02S0111
*    DSABPTR = ZERO;                   /*INSURE BASE PTR IS 0        */
         LR    DSABPTR,@08                                      02S0112
*    DSQFDSP = ADDR(DSABFCHN);         /*DISPLACEMENT WITHIN DSAB
*                                        OF FWD PTR                  */
         LA    @08,DSABFCHN(,DSABPTR)                           02S0113
         STH   @08,DSQFDSP(,@06)                                02S0113
*    DSQBDSP = ADDR(DSABBCHN);         /*DISPLACEMENT WITHIN DSAB
*                                        OF BACK PTR                 */
         LA    @08,DSABBCHN(,DSABPTR)                           02S0114
         STH   @08,DSQBDSP(,@06)                                02S0114
*  END;                                                         02S0115
*     IF RETCODE = NOERROR THEN        /*GETMAIN OK?                 */
@RF00101 SLR   @08,@08                                          01S0116
         CR    RETCODE,@08                                      01S0116
         BNE   @RF00116                                         01S0116
*       DO;                            /*YES, INIT TIOT & QDB        */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - INITTIOT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - INITIALIZE TIOT/DSAB QDB                      */
*/*                                                                  */
*/* FUNCTION-                                                        */
*/*   .INITIALIZE TIOT PREFIX AREA                                   */
*/*      SET  POINTER TO BEGINNING OF FREE SPACE                     */
*/*      SET LENGTH OF FREE SPACE                                    */
*/*      SET POINTER TO BEGINNING OF TIOT AND LENGTH OF TIOT         */
*/*        INTO TIOT LIST                                            */
*/*                                                                  */
*/*   .INITIALIZE TIOT HEADER AND SET 'END-OF-TIOT' INDICATOR        */
*/*                                                                  */
*/*   .INITIALIZE DSAB QDB                                           */
*/*      CLEAR VARIABLE FIELDS OF QDB                                */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JSCTMCOR - POINTER TO TIOT CORE (IN JSCB)                    */
*/*     TIOMIUSL - IN-LINE LIMIT                                     */
*/*     TIOMJNMP - POINTER TO JOB NAME (IN TIOT MGR REQUEST BLOCK)   */
*/*     TIOMSCTP - POINTER TO STEP NAME (IN TIOT MGR REQUEST BLOCK)  */
*/*     TIOMPSNP - POINTER TO STEP NAME (IN TIOT MGR REQUEST         */
*/*                BLOCK)                                            */
*/*     TIOMSIZE - SIZE OF TIOT CORE (IN TIOT MGR REQUEST BLOCK)     */
*/*     TIOMRETP - PTR TO RETURN INFO AREA                           */
*/* EXITS -                                                          */
*/*   CONDITIONS - SUCCESSFUL INITIALIZATION                         */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       TIOT PREFIX,TIOT HEADER AND DSAB QDB ARE INITIALIZED       */
*/*       (NOTE:  FREE SPACE POINTER AND LENGTH, IN PREFIX AREA,     */
*/*       ARE ADJUSTED TO EXCLUDE THE 'END-OF-TIOT' INDICATOR)       */
*/*       A POINTER TO THE TIOT LIST IS RETURNED IN THE RETURN INFO  */
*/*         AREA                                                     */
*/*     RETURN CODES - 0                                             */
*/********************************************************************/
*TIOTPTR = JSCTMCOR +LENGTH(TIOPREFX); /*SET PTR TO BEGINNING OF
*                                        TIOT IN TIOT LIST           */
         L     @06,JSCTMCOR(,JSCBPTR)                           02S0118
         LA    @02,32                                           02S0118
         LR    @15,@06                                          02S0118
         ALR   @15,@02                                          02S0118
         ST    @15,TIOTPTR(,@06)                                02S0118
*TIOTLEN = TIOMTSZE - LENGTH(TIOPREFX);/*LENGTH OF TIOT, LESS PREFIX
*                                        AREA, INTO TIOT LIST        */
         LCR   @02,@02                                          02S0119
         AH    @02,TIOMTSZE(,TIORBPTR)                          02S0119
         ST    @02,TIOTLEN(,@06)                                02S0119
*TIOFREEP =                            /*POINT TO START OF FREE SPACE*/
*    TIOTPTR + LENGTH(TIOTHDR) + LENGTH(TIOTEND);               02S0120
         LA    @14,28                                           02S0120
         LR    @05,@15                                          02S0120
         ALR   @05,@14                                          02S0120
         ST    @05,TIOFREEP(,@06)                               02S0120
*TIOFRLEN =                            /*SET LENGTH OF FREE SPACE    */
*    TIOTLEN - (LENGTH(TIOTHDR) + LENGTH(TIOTEND));             02S0121
         SLR   @02,@14                                          02S0121
         ST    @02,TIOFRLEN(,@06)                               02S0121
*TIOFENTP = ZERO;                      /*CLEAR PTR TO FIRST FREE
*                                        ENTRY ON CHAIN              */
         ST    @08,TIOFENTP(,@06)                               02S0122
*DSQNELMS = ZERO;                      /*CLEAR VARIABLE QDB FIELDS   */
         L     @02,JSCDSABQ(,JSCBPTR)                           02S0123
         ST    @08,DSQNELMS(,@02)                               02S0123
*DSQFRSTP = ZERO;                                               02S0124
         ST    @08,DSQFRSTP(,@02)                               02S0124
*DSQLASTP = ZERO;                                               02S0125
         ST    @08,DSQLASTP(,@02)                               02S0125
*TIONIUSL = TIOMIUSL;                  /*COPY IN-LINE LIMIT TO TIOT
*                                        PREFIX AREA                 */
         MVC   TIONIUSL(2,@06),TIOMIUSL(TIORBPTR)               02S0126
*TIOJNAME = JOBNAME;                   /*JOB NAME TO TIOT HEADER     */
         L     @02,TIOMJNMP(,TIORBPTR)                          02S0127
         MVC   TIOJNAME(8,@15),JOBNAME(@02)                     02S0127
*TIOSNAME = STEPNAME;                  /*STEP NAME TO HEADER         */
         L     @02,TIOMSNMP(,TIORBPTR)                          02S0128
         MVC   TIOSNAME(8,@15),STEPNAME(@02)                    02S0128
*TIOPSNME = PSTPNAME;                  /*PROC STEP NAME TO HEADER    */
         L     @02,TIOMPSNP(,TIORBPTR)                          02S0129
         MVC   TIOPSNME(8,@15),PSTPNAME(@02)                    02S0129
*TIOENTP = TIOTPTR + LENGTH(TIOTHDR);  /*POINT BEYOUND HEADER        */
         AH    @15,@CH00064                                     02S0130
         LR    TIOENTP,@15                                      02S0130
*TIOENTP->TIOENTRY(1:4) =TIOTEND;      /*SET END INDICATOR           */
         ST    @08,TIOENTRY(,TIOENTP)                           02S0131
* DO; /*MODESET  KEYADDR(ZERO)*/                                02S0132
*   SPKA (ZERO); /*SET PSW KEY*/                                02S0133
         SPKA  0(@08)                                           02S0133
* END; /*MODESET  KEYADDR(ZERO)*/                               02S0134
*TIORETNP = ADDR(TIOTLIST);            /*SET PTR TO TIOT LIST FOR
*                                        CALLER                      */
         L     @08,TIOMRETP(,TIORBPTR)                          02S0135
         LA    @06,TIOTLIST(,@06)                               02S0135
         ST    @06,TIORETNP(,@08)                               02S0135
* DO; /*MODESET  EXTKEY(SCHED)*/                                02S0136
*   SPKA (16); /*SET PSW KEY*/                                  02S0137
         LA    @10,16                                           02S0137
         SPKA  0(@10)                                           02S0137
* END; /*MODESET  EXTKEY(SCHED)*/                               02S0138
*       END;                                                    01S0139
*  END;                                                         01S0140
*ELSE                                                           01S0141
*  IF TIOMALOC = YES THEN              /*ALLOCATE REQUESTED?         */
         B     @RC00052                                         01S0141
@RF00052 TM    TIOMALOC(TIORBPTR),B'00100000'                   01S0141
         BNO   @RF00141                                         01S0141
*    DO;                                                        01S0142
*      REQENTLN = TIOMELEN;            /*SET LENGTH OF ENTRY REQ'D   */
         LH    REQENTLN,TIOMELEN(,TIORBPTR)                     01S0143
*      CALL ALOCTIOE;                  /*CALL RTN TO ALLOC AN ENTRY  */
         BAL   @14,ALOCTIOE                                     01S0144
*      IF RETCODE = NOERROR THEN                                01S0145
         SLR   @06,@06                                          01S0145
         CR    RETCODE,@06                                      01S0145
         BNE   @RF00145                                         01S0145
*        DO;                                                    01S0146
*           DO; /*MODESET  KEYADDR(ZERO)*/                      01S0147
*             SPKA (ZERO); /*SET PSW KEY*/                      01S0148
         SPKA  0(@06)                                           01S0148
*           END; /*MODESET  KEYADDR(ZERO)*/                     01S0149
*          TIORETNP = TIOENTP;         /*SET PTR TO ALOC'D ENTRY     */
         L     @06,TIOMRETP(,TIORBPTR)                          01S0150
         ST    TIOENTP,TIORETNP(,@06)                           01S0150
*           DO; /*MODESET  EXTKEY(SCHED)*/                      01S0151
*             SPKA (16); /*SET PSW KEY*/                        01S0152
         LA    @10,16                                           01S0152
         SPKA  0(@10)                                           01S0152
*           END; /*MODESET  EXTKEY(SCHED)*/                     01S0153
*        END;                                                   01S0154
*    END;                                                       01S0155
*  ELSE                                                         01S0156
*    IF TIOMRLSE = YES THEN            /*RELEASE REQUESTED?          */
         B     @RC00141                                         01S0156
@RF00141 TM    TIOMRLSE(TIORBPTR),B'00010000'                   01S0156
         BNO   @RF00156                                         01S0156
*      DO;                                                      01S0157
*        REQENTP = TIOMENTP;           /*SET PTR TO INPUT ENTRY      */
         L     REQENTP,TIOMENTP(,TIORBPTR)                      01S0158
*        CALL RLSETIOT;                /*RELEASE A TIOT DD ENTRY     */
         BAL   @14,RLSETIOT                                     01S0159
*      END;                                                     01S0160
*    ELSE                                                       01S0161
*       IF TIOMUPD = YES THEN          /*UPDATE REQUESTED?           */
         B     @RC00156                                         01S0161
@RF00156 TM    TIOMUPD(TIORBPTR),B'00001000'                    01S0161
         BNO   @RF00161                                         01S0161
*         DO;                                                   01S0162
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UPDTIOT                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UPDATE (COMPRESS & REORDER) TIOT              */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE IS RESPONSIBLE FOR INSURING THAT ALL VALID DD     */
*/*   ENTRIES IN THE TIOT ARE BOTH CONTIGUOUS AND IN THE SAME ORDER  */
*/*   AS THE INPUT SIOT CHAIN. THE DSAB CHAIN WILL ALSO BE REORDERED */
*/*   TO CORRESPOND TO THE SIOT CHAIN AND THE                        */
*/*   DSAB QUEUE DESCRIPTOR BLOCK (QDB) UPDATED TO REFLECT THE NEW   */
*/*   ORDER (IF NECESSARY).                                          */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     .OBTAIN WORK SPACE                                           */
*/*       THE ROUTINE MUST DETERMINE THE AMOUNT OF CORE REQUIRED FOR */
*/*       ITS WORK SPACE (I.E.,AREA IN WHICH TIOT WILL BE REBUILT).  */
*/*       THE AMOUNT OF SPACE NECESSARY IS THE SUM OF THE ENTRY      */
*/*       LENGTHS.                                                   */
*/*       IF THERE IS ENOUGH FREE SPACE IN THE TIOT ITSELF,THAT AREA */
*/*       WILL BE USED. OTHERWISE CORE WILL BE REQUESTED FROM SUB-   */
*/*       POOL 230.                                                  */
*/*                                                                  */
*/*     .REBUILDING THE TIOT                                         */
*/*       IF WORK SPACE IS SUCCESSFULLY OBTAINED THE DD ENTRIES      */
*/*       ARE MOVED INTO IT IN THE ORDER IN WHICH THE SIOTS APPEAR   */
*/*       ON THE INPUT CHAIN. THE COMPRESSED AND REORDERED TIOT IS   */
*/*       THEN MOVED BACK TO THE "REAL" TIOT. IF WORK SPACE WAS NOT  */
*/*       AVAILABLE PROCESSING IS TERMINATED AND AN ERROR RETURN     */
*/*       CODE SET.                                                  */
*/*                                                                  */
*/*     .REORDER DSAB CHAIN                                          */
*/*       THE INPUT SIOT CHAIN IS USED TO DETERMINE THE REQUIRED     */
*/*       ORDER OF THE DSAB CHAIN. THE DSABS ARE RECHAINED AND THE   */
*/*       DSAB QDB POINTERS TO THE FIRST AND LAST DSAB ARE UPDATED.  */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     TIOMSIOP - PTR TO FIRST SIOT ON CHAIN                        */
*/*     JSCBPTR  - PTR TO JOB STEP CONTROL BLOCK                     */
*/*     JSCTMCOR - PTR TO TIOT CORE                                  */
*/*     JSCDSABQ - PTR TO DSAB QDB                                   */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - FUNCTIONS COMPLETED SUCCESSFULLY                   */
*/*                                                                  */
*/*     OUTPUT - UPDATED TIOT, DSAB AND QDB                          */
*/*                                                                  */
*/*     RETURN CODE - RETCODE = 0                                    */
*/*                                                                  */
*/*   CONDITION - WORK SPACE NOT AVAILABLE                           */
*/*                                                                  */
*/*     OUTPUT - TIOT & QDB REMAIN UNCHANGED                         */
*/*                                                                  */
*/*     RETURN CODE - RETCODE = 4                                    */
*/********************************************************************/
*WSLNTH = ZERO;                        /*INITIALIZE WORK SPACE LENGTH*/
         SLR   @08,@08                                          02S0163
         ST    @08,WSLNTH                                       02S0163
*SIOTPTR = TIOMSIOP;                   /*PT TO FIRST SIOT ON CHAIN   */
         L     SIOTPTR,TIOMSIOP(,TIORBPTR)                      02S0164
*DO WHILE (SIOTPTR ^= ZERO);           /*SCAN SIOT CHAIN             */
         B     @DE00165                                         02S0165
@DL00165 DS    0H                                               02S0166
*  DSABPTR = SIOTETIO;                 /*POINT TO ETIOT FOR REQUEST  */
         L     DSABPTR,SIOTETIO(,SIOTPTR)                       02S0166
*  DSABPALC = ON;                      /*PERM. ALLOCATED ATTRIBUTE   */
         OI    DSABPALC(DSABPTR),B'01000000'                    02S0167
*  IF DSABCATM = ON THEN               /*MEMBER OF CONCAT GROUP ?    */
         TM    DSABCATM(DSABPTR),B'00000010'                    02S0168
         BNO   @RF00168                                         02S0168
*    DSABPCAT = ON;                    /*PERM CONCAT ATTRIBUTE       */
         OI    DSABPCAT(DSABPTR),B'00000100'                    02S0169
*  ELSE;                                                        02S0170
@RF00168 DS    0H                                               02S0171
*  WSLNTH = WSLNTH + TIOELNGH;         /*CALCULATE TOTAL LENGTH      */
         L     @08,DSABTIOT(,DSABPTR)                           02S0171
         SLR   @06,@06                                          02S0171
         IC    @06,TIOELNGH(,@08)                               02S0171
         AL    @06,WSLNTH                                       02S0171
         ST    @06,WSLNTH                                       02S0171
*  SIOTPTR = SIOTNPTR;                 /*POINT TO NEXT SIOT          */
         L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       02S0172
*END;                                                           02S0173
@DE00165 LTR   SIOTPTR,SIOTPTR                                  02S0173
         BNZ   @DL00165                                         02S0173
*GETMNSW = NO;                         /*INIT GETMAIN SWITCH         */
         NI    GETMNSW,B'01111111'                              02S0174
*IF WSLNTH <= TIOFRLEN THEN            /*ENOUGH FREE SPACE IN TIOT?  */
         L     @08,JSCTMCOR(,JSCBPTR)                           02S0175
         L     @06,WSLNTH                                       02S0175
         C     @06,TIOFRLEN(,@08)                               02S0175
         BH    @RF00175                                         02S0175
*  TIOENTP = TIOFREEP;                 /*YES,SET PTR TO WORK SPACE   */
         L     TIOENTP,TIOFREEP(,@08)                           02S0176
*ELSE                                  /*NO, MUST GET CORE           */
*  DO;                                                          02S0177
         B     @RC00175                                         02S0177
@RF00175 DS    0H                                               02S0178
*    GETMNSW = YES;                    /*INDICATE GETMAIN DONE       */
         OI    GETMNSW,B'10000000'                              02S0178
*    SUBPLID  = WSSUBPL;               /*SET SUBPOOL NUMBER          */
         LA    @08,230                                          02S0179
         ST    @08,SUBPLID                                      02S0179
*     /* ?GETSTORG (SUBPLID,WSLNTH,WSPTR);*/                    02S0180
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           02S0180
*       GTSTR0 = WSLNTH; /* SET AMOUNT*/                        02S0181
         L     GTSTR0,WSLNTH                                    02S0181
*       GTSTR2 = SUBPLID; /* SET SUBPOOL*/                      02S0182
         LR    GTSTR2,@08                                       02S0182
*       GENERATE CODE;                                          02S0183
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           02S0184
         ST    GTSTR15,GTSTRTCD                                 02S0184
*       WSPTR = GTSTR1; /* ADDR OF GOTN STORG*/                 02S0185
         ST    GTSTR1,WSPTR                                     02S0185
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            02S0186
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           02S0187
         L     @08,GTSTRTCD                                     02S0187
         LTR   @08,@08                                          02S0187
         BNZ   @RF00187                                         02S0187
*         DO;               /* YES, CLEAR STORAGE.*/            02S0188
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0189
*                              GTSTR7,GTSTR8) RSTD;             02S0189
*           GTSTR4 = WSPTR; /*STORG PTR*/                       02S0190
         L     @03,WSPTR                                        02S0190
         LR    GTSTR4,@03                                       02S0190
*           GTSTR5 = WSLNTH; /*STORG AMNT*/                     02S0191
         L     GTSTR5,WSLNTH                                    02S0191
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           02S0192
         SLR   GTSTR7,GTSTR7                                    02S0192
*           IF SUBPLID = GTST253 THEN                           02S0193
         CLC   SUBPLID(4),@CF00638                              02S0193
         BNE   @RF00193                                         02S0193
*          GEN                                                  02S0194
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       02S0194
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*           GEN REFS(GTSTR4,GTSTR6);                            02S0195
@RF00193 DS    0H                                               02S0195
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*           IF SUBPLID = GTST253 THEN                           02S0196
         CLC   SUBPLID(4),@CF00638                              02S0196
         BNE   @RF00196                                         02S0196
*             GEN (MODESET KEYADDR=(2));                        02S0197
         MODESET KEYADDR=(2)
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   02S0198
*                              GTSTR7,GTSTR8) UNRSTD;           02S0198
@RF00196 DS    0H                                               02S0199
*         END;       /* STORAGE CLEARING COMPLETED */           02S0199
*       ELSE                                                    02S0200
*       WSPTR= 0;   /* CLEAR RETURN ADDR. */                    02S0200
         B     @RC00187                                         02S0200
@RF00187 SLR   @08,@08                                          02S0200
         ST    @08,WSPTR                                        02S0200
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           02S0201
@RC00187 L     GTSTR15,GTSTRTCD                                 02S0201
*                                      /* RESTORE LIST PRINT STATUS  */
*/*INVOKE GETSPACE RTN         */                               02S0202
*    RETCODE = REG15;                  /*SAVE RETURN CODE            */
         LR    RETCODE,REG15                                    02S0202
*    TIOENTP = WSPTR;                  /*SET PTR TO WORK SPACE       */
         L     TIOENTP,WSPTR                                    02S0203
*  END;                                                         02S0204
*DO I = 1 TO 2 WHILE (RETCODE = NOERROR);/*                     02S0205
*                                        MOVE DD ENTRIES TO WORK
*                                        SPACE THEN BACK TO REAL TIOT*/
@RC00175 LA    I,1                                              02S0205
@DL00205 LTR   RETCODE,RETCODE                                  02S0205
         BNZ   @DC00205                                         02S0205
*  SIOTPTR = TIOMSIOP;                 /*SET PTR TO FIRST SIOT       */
         L     SIOTPTR,TIOMSIOP(,TIORBPTR)                      02S0206
*    DO WHILE (SIOTPTR ^= ZERO);       /*SCAN SIOT CHAIN             */
         B     @DE00207                                         02S0207
@DL00207 DS    0H                                               02S0208
*      DSABPTR = SIOTETIO;             /*SET PTR TO ETIOT ENTRY      */
         L     DSABPTR,SIOTETIO(,SIOTPTR)                       02S0208
*      TIOENTP -> TIOENTRY(1:TIOELNGH) = /*MOVE DD ENTRY             */
*          TIOENTRY;                                            02S0209
         L     @08,DSABTIOT(,DSABPTR)                           02S0209
         SLR   @06,@06                                          02S0209
         IC    @06,TIOELNGH(,@08)                               02S0209
         BCTR  @06,0                                            02S0209
         EX    @06,@SM00662                                     02S0209
*      DSABTIOT = TIOENTP;             /*SET PTR TO DD ENTRY IN DSAB */
         ST    TIOENTP,DSABTIOT(,DSABPTR)                       02S0210
*      TIOENTP = TIOENTP + TIOELNGH;   /*POINT TO NEXT SLOT  IN TIOT */
         L     @08,DSABTIOT(,DSABPTR)                           02S0211
         SLR   @06,@06                                          02S0211
         IC    @06,TIOELNGH(,@08)                               02S0211
         ALR   TIOENTP,@06                                      02S0211
*      SIOTPTR = SIOTNPTR;             /*POINT TO NEXT SIOT          */
         L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       02S0212
*    END;                                                       02S0213
@DE00207 LTR   SIOTPTR,SIOTPTR                                  02S0213
         BNZ   @DL00207                                         02S0213
*  TIOENTP = TIOTPTR + LENGTH(TIOTHDR); /*RESET PTR TO BEG. TIOT
*                                        FOR THE MOVE BACK           */
         L     @08,JSCTMCOR(,JSCBPTR)                           02S0214
         LA    TIOENTP,24                                       02S0214
         AL    TIOENTP,TIOTPTR(,@08)                            02S0214
*END;                                                           02S0215
         AH    I,@CH00062                                       02S0215
         CH    I,@CH00113                                       02S0215
         BNH   @DL00205                                         02S0215
@DC00205 DS    0H                                               02S0216
*IF RETCODE = NOERROR THEN                                      02S0216
         SLR   @08,@08                                          02S0216
         CR    RETCODE,@08                                      02S0216
         BNE   @RF00216                                         02S0216
*  DO;                                                          02S0217
*    TIOENTP =                         /*POINT TO END OF TIOT ENTRIES*/
*        TIOTPTR + WSLNTH + LENGTH(TIOTHDR);                    02S0218
         L     @06,WSLNTH                                       02S0218
         L     @15,JSCTMCOR(,JSCBPTR)                           02S0218
         L     TIOENTP,TIOTPTR(,@15)                            02S0218
         ALR   TIOENTP,@06                                      02S0218
         AH    TIOENTP,@CH00064                                 02S0218
*    TIOENTP -> TIOENTRY(1:4) = TIOTEND;/*SET END OF TIOT INDICATOR  */
         ST    @08,TIOENTRY(,TIOENTP)                           02S0219
*    TIOFREEP = TIOENTP + LENGTH(TIOTEND);/*UPDATE FREE SPACE PTR    */
         LA    @02,4                                            02S0220
         ALR   @02,TIOENTP                                      02S0220
         ST    @02,TIOFREEP(,@15)                               02S0220
*    TIOFENTP = ZERO;                  /*CLEAR FREE ENTRY PTR        */
         ST    @08,TIOFENTP(,@15)                               02S0221
*    IF GETMNSW = ON THEN              /*WAS A GETMAIN DONE?         */
         TM    GETMNSW,B'10000000'                              02S0222
         BNO   @RF00222                                         02S0222
*      DO;                             /*YES, FREE WORK SPACE        */
*        RFY (REG0,REG1) RSTD;                                  02S0224
*        SPID = SUBPLID;               /*SET SUBPOOL NUMBER          */
         MVC   SPID(1),SUBPLID+3                                02S0225
*        BLKLEN = WSLNTH;              /*LENGTH OF AREA TO FREE      */
         STCM  @06,7,BLKLEN                                     02S0226
*        REG0 = FREELEN;                                        02S0227
         L     REG0,FREELEN                                     02S0227
*        REG1 = WSPTR;                 /*POINT TO WORK SPACE         */
         L     REG1,WSPTR                                       02S0228
*        GEN(FREEMAIN R,LV=(0),A=(1)); /*FREE WORK SPACE CORE        */
         FREEMAIN R,LV=(0),A=(1)
*        RFY (REG0,REG1) UNRSTD;                                02S0230
*      END;                                                     02S0231
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UPDSACHN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UPDATE DSAB CHAIN                             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE WILL REORDER THE INPUT DSAB CHAIN TO CORRESPOND   */
*/*   TO THE ORDER OF THE INPUT SIOT CHAIN. THE DSAB QDB IS ALSO     */
*/*   UPDATED TO REFLECT THE NEW ORDER.                              */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     TIOMSIOP - PTR TO FIRST SIOT ON CHAIN                        */
*/*       SIOTETIO - PTR TO DSAB (IN EACH SIOT)                      */
*/*     JSCBPTR - PTR TO JOB STEP CONTROL BLOCK                      */
*/*       JSCDSABQ - PTR TO DSAB QDB                                 */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - DSAB CHAIN REORDERED                               */
*/*     OUTPUT -                                                     */
*/*       DSABFCHN AND DSABBCHN FIELDS UPDATED IN EACH DSAB          */
*/*       DSQFRSTP AND DSQLASTP FIELDS UPDATED IN DSAB QDB           */
*/*       DSABCATM AND DSABPCAT BITS SET ON IF NECESSARY             */
*/*     RETURN CODE -                                                */
*/*       RETCODE - SAME AS ON ENTRY                                 */
*/*                                                                  */
*/********************************************************************/
*SIOTPTR = TIOMSIOP;                   /*SET PTR TO FIRST SIOT       */
@RF00222 L     SIOTPTR,TIOMSIOP(,TIORBPTR)                      03S0232
*DSABPTR = SIOTETIO;                   /*SET PTR TO FIRT DSAB        */
         L     DSABPTR,SIOTETIO(,SIOTPTR)                       03S0233
*DSQFRSTP = DSABPTR;                   /*SET FIRST DSAB PTR IN QDB   */
         L     @10,JSCDSABQ(,JSCBPTR)                           03S0234
         ST    DSABPTR,DSQFRSTP(,@10)                           03S0234
*DSABBCHN = ZERO;                      /*ZERO BACK CHAIN PTR IN FIRST*/
         SLR   @10,@10                                          03S0235
         ST    @10,DSABBCHN(,DSABPTR)                           03S0235
*DO WHILE (SIOTPTR ^= ZERO);           /*PROCESS ALL DSABS           */
         B     @DE00236                                         03S0236
@DL00236 DS    0H                                               03S0237
*  IF SIOTNPTR ^= ZERO THEN            /*ANOTHER SIOT ON CHAIN       */
         L     @10,SIOTNPTR(,SIOTPTR)                           03S0237
         LTR   @10,@10                                          03S0237
         BZ    @RF00237                                         03S0237
*    DO;                               /*YES, CONTINUE               */
*      DSABFCHN = SIOTNPTR -> SIOTETIO; /*SET FWD PTR TO NEXT DSAB   */
         L     @10,SIOTETIO(,@10)                               03S0239
         ST    @10,DSABFCHN(,DSABPTR)                           03S0239
*      DSABFCHN -> DSABBCHN = SIOTETIO; /*SET BACK PTR IN NEXT DSAB  */
         MVC   DSABBCHN(4,@10),SIOTETIO(SIOTPTR)                03S0240
*      IF DSABFCHN->DSABCATM = ON      /*NXT DSAB IN CONCAT          */
*        & SCTDDNAM(1) ^= BLANK THEN   /*& THIS IS MOTHER DSAB       */
         TM    DSABCATM(@10),B'00000010'                        03S0241
         BNO   @RF00241                                         03S0241
         CLC   SCTDDNAM(1,SIOTPTR),BLANK                        03S0241
         BE    @RF00241                                         03S0241
*        DO;                                                    03S0242
*          DSABCATM = ON;              /*SET CONCAT BIT IN MOTHER
*                                        DSAB                        */
*          DSABPCAT = ON;              /*PERM CONCAT                 */
         OI    DSABCATM(DSABPTR),B'00000110'                    03S0244
*        END;                                                   03S0245
*    END;                                                       03S0246
@RF00241 DS    0H                                               03S0247
*  SIOTPTR = SIOTNPTR;                 /*POINT TO NEXT SIOT          */
@RF00237 L     SIOTPTR,SIOTNPTR(,SIOTPTR)                       03S0247
*  IF SIOTPTR ^= ZERO THEN             /*IS THERE ANOTHER SIOT?      */
         LTR   SIOTPTR,SIOTPTR                                  03S0248
         BZ    @RF00248                                         03S0248
*    DSABPTR = SIOTETIO;               /*YES,POINT TO ITS DSAB       */
         L     DSABPTR,SIOTETIO(,SIOTPTR)                       03S0249
*END;                                                           03S0250
@RF00248 DS    0H                                               03S0250
@DE00236 SLR   @10,@10                                          03S0250
         CR    SIOTPTR,@10                                      03S0250
         BNE   @DL00236                                         03S0250
*DSABFCHN = ZERO;                      /*ZERO FWD CHN PTR IN LAST
*                                        DSAB                        */
         ST    @10,DSABFCHN(,DSABPTR)                           03S0251
*DSQLASTP = DSABPTR;                   /*SET PTR TO LAST DSAB IN QDB */
         L     @10,JSCDSABQ(,JSCBPTR)                           03S0252
         ST    DSABPTR,DSQLASTP(,@10)                           03S0252
*  END;                                                         02S0253
*         END;                                                  01S0254
*       ELSE                                                    01S0255
*         IF TIOMUNAL = YES THEN       /*UNALLOCATE REQUESTED?       */
         B     @RC00161                                         01S0255
@RF00161 TM    TIOMUNAL(TIORBPTR),B'00000010'                   01S0255
         BNO   @RF00255                                         01S0255
*           DO;                                                 01S0256
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UNALCTIO                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UNALLOCATE DSAB/TIOT DD ENTRY                 */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE PERFORMS THE FOLLOWING FUNCTIONS:                 */
*/*     .RELEASES TIOT DD ENTRIES,IF REQUIRED                        */
*/*     .FREES THE CORE FOR THE DSAB AND ITS ASSOCIATED TABLES       */
*/*     .UPDATES THE DSAB QDB                                        */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     FOR EACH DSAB IN THE INPUT LIST THE ROUTINE PROCESSES IT AS  */
*/*     FOLLOWS:                                                     */
*/*       IF THE TIOT DD ENTRY IS TO BE RELEASED, THE 'RELEASE       */
*/*       TIOT ENTRY' SUBROUTINE IS INVOKED TO PLACE THE ENTRY       */
*/*       ON TO THE FREE ENTRY CHAIN AND TO MERGE CONTIGUOUS FREE    */
*/*       ENTRIES.                                                   */
*/*                                                                  */
*/*       THE CORE FOR THE DSAB GROUP ID LIST, THE DSAB ALTERNATE    */
*/*       NAME LIST AND THE DSAB ITSELF, IS FREED. IF THIS DSAB      */
*/*       IS EITHER THE FIRST OR THE LAST ON THE CHAIN THE           */
*/*       CORRESPONDING DSAB QDB POINTER IS UPDATED. THE NUMBER OF   */
*/*       ELEMENTS ON THE CHAIN IS DECREMENTED FOR EACH DSAB FREED   */
*/*       AND THE REMAINING ELEMENTS ARE RECHAINED.                  */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*   INPUT -                                                        */
*/*     TIOT MGR REQUEST BLOCK                                       */
*/*       TIOMRENT - IF ON,RELEASE DD ENTRIES                        */
*/*       TIOMNDSA - NO. DSABS TO PROCESS                            */
*/*       TIOMDSAP - PTR TO LIST OF DSAB POINTERS (DSLIST)           */
*/*         EACH DSAB CONTAINS                                       */
*/*           PTR TO NEXT DSAB (OR 0 IF LAST)                        */
*/*           PTR TO LAST DSAB (OR 0 IF FIRST)                       */
*/*           PTR TO TIOT DD ENTRY                                   */
*/*           PTR TO GROUP ID LIST                                   */
*/*           PTR TO ALTERNATE DATA SET NAME LIST                    */
*/*           LENGTH OF DSAB                                         */
*/*       TIOMJSCP - PTR TO JSCB                                     */
*/*         JSCBDSAQ - PTR TO DSAB QDB                               */
*/*                                                                  */
*/* EXIT -                                                           */
*/*    CONDITION - REQUESTED FUNCTIONS COMPLETED                     */
*/*     OUTPUT -                                                     */
*/*       TIOT ENTRY FREE CHAIN UPDATED                              */
*/*       DSAB CHAIN UPDATED                                         */
*/*       DSAB QDB UPDATED                                           */
*/*     RETURN CODES -                                               */
*/*       NONE                                                       */
*/*                                                                  */
*/********************************************************************/
*DO DSABCTR = 1 TO TIOMNDSA;           /*PROCESS ALL DSABS IN LIST   */
         LA    DSABCTR,1                                        02S0257
         B     @DE00257                                         02S0257
@DL00257 DS    0H                                               02S0258
*  DSABPTR = DSLENT(DSABCTR);          /*SET BASE FOR THIS DSAB      */
         LR    @08,DSABCTR                                      02S0258
         SLA   @08,2                                            02S0258
         L     @01,TIOMDSAP(,TIORBPTR)                          02S0258
         AL    @01,@CF00664                                     02S0258
         L     DSABPTR,DSLENT(@08,@01)                          02S0258
*  IF TIOMRENT = YES THEN              /*DD ENTRIES TO BE RELEASED   */
         TM    TIOMRENT(TIORBPTR),B'10000000'                   02S0259
         BNO   @RF00259                                         02S0259
*    DO;                               /*RELEASE ENTRY               */
*      REQENTP = DSABTIOT;             /*SET PTR TO DD ENTRY         */
         L     REQENTP,DSABTIOT(,DSABPTR)                       02S0261
*      CALL RLSETIOT;                  /*RELEASE DD ENTRY            */
         BAL   @14,RLSETIOT                                     02S0262
*    END;                                                       02S0263
*  IF DSQNELMS > ONE THEN              /*MORE THAN 1 DSAB ON CHAIN   */
@RF00259 L     @08,JSCDSABQ(,JSCBPTR)                           02S0264
         L     @08,DSQNELMS(,@08)                               02S0264
         CH    @08,@CH00062                                     02S0264
         BNH   @RF00264                                         02S0264
*    DO;                                                        02S0265
*      IF DSABFCHN ^= ZERO THEN        /*THIS DSAB NOT LAST ON CHAIN */
         L     @08,DSABFCHN(,DSABPTR)                           02S0266
         LTR   @08,@08                                          02S0266
         BZ    @RF00266                                         02S0266
*        DSABFCHN->DSABBCHN = DSABBCHN; /*UPDATE NEXT BACK PTR       */
         MVC   DSABBCHN(4,@08),DSABBCHN(DSABPTR)                02S0267
*      ELSE                            /*CURRENT LAST BEING FREED    */
*        DSABBCHN->DSABFCHN = ZERO;    /*SET ZERO IN NEW LAST        */
         B     @RC00266                                         02S0268
@RF00266 L     @08,DSABBCHN(,DSABPTR)                           02S0268
         SLR   @03,@03                                          02S0268
         ST    @03,DSABFCHN(,@08)                               02S0268
*      IF DSABBCHN ^= ZERO THEN        /*THIS DSAB NOT FIRST         */
@RC00266 L     @08,DSABBCHN(,DSABPTR)                           02S0269
         LTR   @08,@08                                          02S0269
         BZ    @RF00269                                         02S0269
*        DSABBCHN->DSABFCHN = DSABFCHN; /*UPDATE LAST FWD PTR        */
         MVC   DSABFCHN(4,@08),DSABFCHN(DSABPTR)                02S0270
*      ELSE                            /*CURRENT FIRST BEING FREED   */
*        DSABFCHN->DSABBCHN = ZERO;    /*SET ZERO BACK PTR IN NEW
*                                        FIRST                       */
         B     @RC00269                                         02S0271
@RF00269 L     @08,DSABFCHN(,DSABPTR)                           02S0271
         SLR   @03,@03                                          02S0271
         ST    @03,DSABBCHN(,@08)                               02S0271
*    END;                                                       02S0272
@RC00269 DS    0H                                               02S0273
*  IF DSQFRSTP = DSABPTR THEN          /*FIRST DSAB BEING FREED      */
@RF00264 L     @08,JSCDSABQ(,JSCBPTR)                           02S0273
         C     DSABPTR,DSQFRSTP(,@08)                           02S0273
         BNE   @RF00273                                         02S0273
*    DSQFRSTP = DSABFCHN;              /*SET QDB PTR TO NEW FIRST    */
         MVC   DSQFRSTP(4,@08),DSABFCHN(DSABPTR)                02S0274
*  IF DSQLASTP = DSABPTR THEN          /*LAST DSAB BEING FREED       */
@RF00273 L     @08,JSCDSABQ(,JSCBPTR)                           02S0275
         C     DSABPTR,DSQLASTP(,@08)                           02S0275
         BNE   @RF00275                                         02S0275
*    DSQLASTP = DSABBCHN;              /*SET QDB PTR TO NEW LAST     */
         MVC   DSQLASTP(4,@08),DSABBCHN(DSABPTR)                02S0276
*  DSQNELMS = DSQNELMS - ONE;          /*DECR. NO. DSABS             */
@RF00275 L     @08,JSCDSABQ(,JSCBPTR)                           02S0277
         L     @03,DSQNELMS(,@08)                               02S0277
         BCTR  @03,0                                            02S0277
         ST    @03,DSQNELMS(,@08)                               02S0277
*  RFY(REG0,REG1) RSTD;                                         02S0278
*  IF DSABGIDP ^= ZERO THEN                                     02S0279
         L     @08,DSABGIDP(,DSABPTR)                           02S0279
         LTR   @08,@08                                          02S0279
         BZ    @RF00279                                         02S0279
*    DO;                               /*FREE GROUP ID LIST          */
*      BLKLEN = DSABLLEN;                                       02S0281
         MVC   BLKLEN(3),DSABLLEN+1(@08)                        02S0281
*      SPID  = JSCBSWSP;                                        02S0282
         MVC   SPID(1),JSCBSWSP(JSCBPTR)                        02S0282
*      REG0 = FREELEN;                                          02S0283
         L     REG0,FREELEN                                     02S0283
*      REG1 = DSABGIDP;                                         02S0284
         LR    REG1,@08                                         02S0284
*      GEN(FREEMAIN R,LV=(0),A=(1));                            02S0285
         FREEMAIN R,LV=(0),A=(1)
*    END;                                                       02S0286
*  IF DSABANMP ^= ZERO THEN                                     02S0287
@RF00279 L     @08,DSABANMP(,DSABPTR)                           02S0287
         LTR   @08,@08                                          02S0287
         BZ    @RF00287                                         02S0287
*    DO;                               /*FREE ALTERNATE DSN LIST     */
*      BLKLEN = DSABANML + LENGTH(DSABANML);                    02S0289
         LA    @03,1                                            02S0289
         SLR   @15,@15                                          02S0289
         IC    @15,DSABANML(,@08)                               02S0289
         ALR   @03,@15                                          02S0289
         STCM  @03,7,BLKLEN                                     02S0289
*      SPID = JSCBSWSP;                                         02S0290
         MVC   SPID(1),JSCBSWSP(JSCBPTR)                        02S0290
*      REG0 = FREELEN;                                          02S0291
         L     REG0,FREELEN                                     02S0291
*      REG1 = DSABANMP;                                         02S0292
         LR    REG1,@08                                         02S0292
*      GEN(FREEMAIN R,LV=(0),A=(1));                            02S0293
         FREEMAIN R,LV=(0),A=(1)
*    END;                                                       02S0294
*  BLKLEN = DSABLNTH;                                           02S0295
@RF00287 LH    @08,DSABLNTH(,DSABPTR)                           02S0295
         STCM  @08,7,BLKLEN                                     02S0295
*  SPID = JSCBSWSP;                                             02S0296
         MVC   SPID(1),JSCBSWSP(JSCBPTR)                        02S0296
*  REG0 = FREELEN;                                              02S0297
         L     REG0,FREELEN                                     02S0297
*  REG1 = DSABPTR;                                              02S0298
         LR    REG1,DSABPTR                                     02S0298
*  GEN(FREEMAIN R,LV=(0),A=(1));       /*FREE THE DSAB               */
         FREEMAIN R,LV=(0),A=(1)
*  RFY(REG0,REG1) UNRSTD;                                       02S0300
*END;                                                           02S0301
         AH    DSABCTR,@CH00062                                 02S0301
@DE00257 CH    DSABCTR,TIOMNDSA(,TIORBPTR)                      02S0301
         BNH   @DL00257                                         02S0301
*           END;                                                01S0302
*         ELSE                                                  01S0303
*           IF TIOMFREE = YES THEN     /*FREE TIOT & QDB CORE?       */
         B     @RC00255                                         01S0303
@RF00255 TM    TIOMFREE(TIORBPTR),B'00000001'                   01S0303
         BNO   @RF00303                                         01S0303
*             DO;                                               01S0304
*               SPID = JSCBSWSP;       /*SET SUBPOOL ID TO FREE      */
         MVC   SPID(1),JSCBSWSP(JSCBPTR)                        01S0305
*               RFY(REG0,REG1) RSTD;   /*RESTRICT REGS FOR MACRO     */
*               IF JSCTMCOR ^=ZERO THEN                         01S0307
         L     @10,JSCTMCOR(,JSCBPTR)                           01S0307
         LTR   @10,@10                                          01S0307
         BZ    @RF00307                                         01S0307
*                 DO;                                           01S0308
*                   BLKLEN=TIOTLEN + LENGTH(TIOPREFX);          01S0309
         LA    @08,32                                           01S0309
         AL    @08,TIOTLEN(,@10)                                01S0309
         STCM  @08,7,BLKLEN                                     01S0309
*                   REG0 = FREELEN;                             01S0310
         L     REG0,FREELEN                                     01S0310
*                   REG1 = JSCTMCOR;   /*SET PTR TO TIOT CORE        */
         LR    REG1,@10                                         01S0311
*                   GEN(FREEMAIN R,LV=(0),A=(1)); /*FREE  TIOT CORE  */
         FREEMAIN R,LV=(0),A=(1)
*                    DO; /*MODESET  KEYADDR(ZERO)*/             01S0313
*                      SPKA (ZERO); /*SET PSW KEY*/             01S0314
         SLR   @10,@10                                          01S0314
         SPKA  0(@10)                                           01S0314
*                    END; /*MODESET  KEYADDR(ZERO)*/            01S0315
*                   JSCTMCOR = ZERO;   /*CLEAR PTR FIELD IN JSCB     */
         ST    @10,JSCTMCOR(,JSCBPTR)                           01S0316
*                    DO; /*MODESET  EXTKEY(SCHED)*/             01S0317
*                      SPKA (16); /*SET PSW KEY*/               01S0318
         LA    @10,16                                           01S0318
         SPKA  0(@10)                                           01S0318
*                    END; /*MODESET  EXTKEY(SCHED)*/            01S0319
*                 END;                                          01S0320
*               IF JSCDSABQ ^= ZERO THEN                        01S0321
@RF00307 L     @10,JSCDSABQ(,JSCBPTR)                           01S0321
         LTR   @10,@10                                          01S0321
         BZ    @RF00321                                         01S0321
*                 DO;                                           01S0322
*                   BLKLEN = LENGTH(DSABQDB);                   01S0323
         MVC   BLKLEN(3),@CF00655+1                             01S0323
*                   REG0 = FREELEN;                             01S0324
         L     REG0,FREELEN                                     01S0324
*                   REG1 = JSCDSABQ;   /*SET PTR TO QDB CORE         */
         LR    REG1,@10                                         01S0325
*                   GEN(FREEMAIN R,LV=(0),A=(1)); /*FREE QDB CORE    */
         FREEMAIN R,LV=(0),A=(1)
*                    DO; /*MODESET  KEYADDR(ZERO)*/             01S0327
*                      SPKA (ZERO); /*SET PSW KEY*/             01S0328
         SLR   @10,@10                                          01S0328
         SPKA  0(@10)                                           01S0328
*                    END; /*MODESET  KEYADDR(ZERO)*/            01S0329
*                   JSCDSABQ = ZERO;   /*CLEAR PTR FIELD IN JSCB     */
         ST    @10,JSCDSABQ(,JSCBPTR)                           01S0330
*                    DO; /*MODESET  EXTKEY(SCHED)*/             01S0331
*                      SPKA (16); /*SET PSW KEY*/               01S0332
         LA    @10,16                                           01S0332
         SPKA  0(@10)                                           01S0332
*                    END; /*MODESET  EXTKEY(SCHED)*/            01S0333
*                 END;                                          01S0334
*               RFY(REG0,REG1) UNRSTD;                          01S0335
@RF00321 DS    0H                                               01S0336
*                DO; /*MODESET  KEYADDR(ZERO)*/                 01S0336
*                  SPKA (ZERO); /*SET PSW KEY*/                 01S0337
         SLR   @10,@10                                          01S0337
         SPKA  0(@10)                                           01S0337
*                END; /*MODESET  KEYADDR(ZERO)*/                01S0338
*               JSCSIOTS = OFF;        /*CLEAR C/R SIOT SCAN INDIC   */
         NI    JSCSIOTS(JSCBPTR),B'11111101'                    01S0339
*                DO; /*MODESET  EXTKEY(SCHED)*/                 01S0340
*                  SPKA (16); /*SET PSW KEY*/                   01S0341
         LA    @10,16                                           01S0341
         SPKA  0(@10)                                           01S0341
*                END; /*MODESET  EXTKEY(SCHED)*//*RETURN TO SCHEDULER K
*Y     */                                                       01S0342
*             END;                                              01S0343
*           ELSE                                                01S0344
*             IF TIOMCCAT = YES THEN   /*CONCATENATE REQUESTED       */
         B     @RC00303                                         01S0344
@RF00303 TM    TIOMCCAT(TIORBPTR),B'00000100'                   01S0344
         BNO   @RF00344                                         01S0344
*               DO;                                             01S0345
*/********************************************************************/
*/* SEGMENT NAME - CONCATIO                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CONCATENATE TIOT DD ENTRIES                   */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE WILL INSURE THAT THE TIOT DD ENTRIES FOR EACH     */
*/*   DSAB ON THE INPUT LIST  ARE CONTIGUOUS IN THE TIOT AND ARE     */
*/*   IN THE ORDER SPECIFIED BY THE LIST.  THE ROUTINE WILL ALSO     */
*/*   UPDATE THE DSAB CHAIN AND THE DSAB QDB TO REFLECT ANY REORDER- */
*/*   ING NECESSARY.  THE DSABS WILL BE PUT AT THE END OF THE CHAIN  */
*/*   IN THE ORDER SPECIFIED BY THE LIST.                            */
*/*                                                                  */
*/*   THE ROUTINE WILL USE THE ALLOCATE SUBROUTINE (ALOCTIOE) TO     */
*/*   OBTAIN SPACE EQUAL IN LENGTH TO THE COMBINED LENGTH OF THE     */
*/*   ENTRIES TO BE CONCATENATED. IF ENOUGH SPACE IS AVAILABLE IN THE*/
*/*   TIOT, THE  DATA IN THE EXISTING ENTRIES IS MOVED TO THE NEW    */
*/*   SPACE  AND THE EXISTING ENTRIES RELEASED USING THE RELEASE     */
*/*   SUBROUTINE  (RLSETIOT).  IF THERE IS NOT ENOUGH SPACE AVAILABLE*/
*/*   IN THE TIOT AN ERROR CODE IS RETURNED TO THE CALLER.           */
*/*                                                                  */
*/*   THIS ROUTINE WILL ALSO SET DSABCATM IN THE DSAB FOR EACH       */
*/*   MEMBER OF A CONCATENATED GROUP INCLUDING THE MEMBER WITH       */
*/*   THE DDNAME.                                                    */
*/* NOTE:  THE SIOTS ARE NOT CHANGED OR RECHAINED.                   */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   THIS ROUTINE WILL CALCULATE THE SIZE OF THE TIOT ENTRY THAT    */
*/*   IS REQUIRED FOR THE REQUESTED CONCATENATION.IT LOCATES AN      */
*/*   ENTRY IN THE TIOT BY CALLING ALOCTIOE WHICH RETURNS A POINTER  */
*/*   TO AN ENTRY IF THERE IS ENOUGH SPACE AND SETS A RETURN CODE TO */
*/*   ZERO,(IF A NON-ZERO RETURN CODE IS RETURNED,PROCESSING IS      */
*/*   TERMINATED). THE ROUTINE THEN MOVES THE TIOT ENTRIES TO BE     */
*/*   CONCATENATED TO THE NEW TIOT ENTRY IN THE ORDER SPECIFIED,     */
*/*   SETS THE DSAB POINTERS TO THE NEW ENTRIES, AND RELEASES THE OLD*/
*/*   TIOT ENTRIES VIA A CALL TO RLSETIOT.  CONCAT DSAB (CCATDSAB) IS*/
*/*   THEN INCLUDED TO REORDER THE DSAB CHAIN & QDB.  AFTER          */
*/*   THE DSAB CHAIN IS UPDATED, THE DSABCATM BIT IS SET FOR EACH    */
*/*   DSAB ON THE LIST AND THE TIOT DDNAME FOR EACH DSAB ENTRY ON THE*/
*/*   LIST, EXCEPT FOR THE FIRST ONE, IS BLANKED OUT.                */
*/*                                                                  */
*/*                                                                  */
*/* ENTRY - INLINE SEGMENT                                           */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*   INPUT -                                                        */
*/*     TIOMDSAP - PTR TO LIST OF DSABS TO BE CONCATENATED           */
*/*         DSABTIOT- PTR TO TIOT DD ENTRY                           */
*/*           TIOELNGH- LENGTH OF TIOT DD ENTRY                      */
*/*     TIOMNDSA - NUMBER OF DSABS TO BE CONCATENATED                */
*/*     JSCBPTR - PTR TO JOB STEP CONTROL BLOCK                      */
*/*       JSCDSABQ - PTR TO DSAB QDB                                 */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - DD ENTRIES CONTIGUOUS IN TIOT                      */
*/*                                                                  */
*/*     OUTPUT DATA -                                                */
*/*       UPDATED TIOT AND FREE ENTRY CHAIN                          */
*/*       UPDATED DSAB CHAIN AND DSAB QDB                            */
*/*                                                                  */
*/*     RETURN CODE - 0                                              */
*/*                                                                  */
*/*   CONDITON - NOT ENOUGH SPACE AVAILABLE IN TIOT                  */
*/*                                                                  */
*/*     OUTPUT DATA - NONE                                           */
*/*                                                                  */
*/*     RETURN CODE - 4                                              */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*/* CALCULATE TIOT ENTRY SIZE NEEDED:                                */
*RETCODE = NOERROR;                    /*INITIALIZE RETURN CODE      */
         SLR   @08,@08                                          02S0346
         LR    RETCODE,@08                                      02S0346
*REQENTLN = ZERO;                      /*INITIALIZE LENGTH FIELD     */
         LR    REQENTLN,@08                                     02S0347
*DO TEMPDCTR = ONE TO TIOMNDSA;        /*PROCESS ALL DSABS ON LIST   */
         LA    TEMPDCTR,1                                       02S0348
         B     @DE00348                                         02S0348
@DL00348 DS    0H                                               02S0349
*  DSABPTR = DSABLIST(TEMPDCTR);       /*PT TO CURRENT DSAB          */
         LR    @06,TEMPDCTR                                     02S0349
         SLA   @06,2                                            02S0349
         L     @05,TIOMDSAP(,TIORBPTR)                          02S0349
         AL    @05,@CF00664                                     02S0349
         L     DSABPTR,DSABLIST(@06,@05)                        02S0349
*  REQENTLN=REQENTLN + TIOELNGH;       /*ACCUMULATE LENGH            */
         L     @06,DSABTIOT(,DSABPTR)                           02S0350
         SLR   @05,@05                                          02S0350
         IC    @05,TIOELNGH(,@06)                               02S0350
         ALR   REQENTLN,@05                                     02S0350
*  DO WHILE  DSABPTR   ^= ZERO &       /*DSABS EXIST ?       @YM07296*/
*            DSABFCHN  ^= ZERO &       /*NOT ALL DONE WITH DSAB CHAIN*/
*            DSABFCHN->DSABCATM=ON &   /*PROCESS DSABS ALREADY CONCAT*/
*            DSABFCHN->DSABTIOT->TIOEDDNM = BLANKS8;  /* TIOT DDNAME
*                                        BLANK ?             @YM07296*/
         B     @DE00351                                         02S0351
@DL00351 DS    0H                                               02S0352
*    DSABPTR = DSABFCHN;               /*POINT TO NEXT DSAB          */
         L     DSABPTR,DSABFCHN(,DSABPTR)                       02S0352
*    REQENTLN = REQENTLN + TIOELNGH;   /*UPDATE LENGTH TOTAL         */
         L     @06,DSABTIOT(,DSABPTR)                           02S0353
         SLR   @05,@05                                          02S0353
         IC    @05,TIOELNGH(,@06)                               02S0353
         ALR   REQENTLN,@05                                     02S0353
*  END;                                                         02S0354
@DE00351 SLR   @06,@06                                          02S0354
         CR    DSABPTR,@06                                      02S0354
         BE    @DC00351                                         02S0354
         L     @05,DSABFCHN(,DSABPTR)                           02S0354
         CR    @05,@06                                          02S0354
         BE    @DC00351                                         02S0354
         TM    DSABCATM(@05),B'00000010'                        02S0354
         BNO   @DC00351                                         02S0354
         L     @06,DSABTIOT(,@05)                               02S0354
         CLC   TIOEDDNM(8,@06),BLANKS8                          02S0354
         BE    @DL00351                                         02S0354
@DC00351 DS    0H                                               02S0355
*END;                                                           02S0355
         AH    TEMPDCTR,@CH00062                                02S0355
@DE00348 CH    TEMPDCTR,TIOMNDSA(,TIORBPTR)                     02S0355
         BNH   @DL00348                                         02S0355
*CALL ALOCTIOE;                        /*LOCATE ENTRY LARGE ENOUGH   */
         BAL   @14,ALOCTIOE                                     02S0356
*IF RETCODE = NOERROR THEN             /*IF YES, SPACE FOUND         */
         LTR   RETCODE,RETCODE                                  02S0357
         BNZ   @RF00357                                         02S0357
*  DO;                                                          02S0358
*    TCATPTR = TIOENTP;                /*TEMP WORK POINTER.  TIOENTP
*                                       IS THE PTR TO ALLOCATED ENTRY*/
         LR    TCATPTR,TIOENTP                                  02S0359
*    DO TEMPDCTR = ONE TO TIOMNDSA;    /*PROCESS ALL DSABS ON LIST   */
         LA    TEMPDCTR,1                                       02S0360
         B     @DE00360                                         02S0360
@DL00360 DS    0H                                               02S0361
*      DSABPTR = DSABLIST(TEMPDCTR);   /*POINT TO CURRENT DSAB       */
         LR    @15,TEMPDCTR                                     02S0361
         SLA   @15,2                                            02S0361
         L     @01,TIOMDSAP(,TIORBPTR)                          02S0361
         AL    @01,@CF00664                                     02S0361
         L     DSABPTR,DSABLIST(@15,@01)                        02S0361
*      TCATPTR->TIOENTRY(1:TIOELNGH)=                           02S0362
*                 TIOENTRY(1:TIOELNGH); /*MOVE TIOT DD ENTRY         */
         L     @03,DSABTIOT(,DSABPTR)                           02S0362
         SLR   @15,@15                                          02S0362
         IC    @15,TIOELNGH(,@03)                               02S0362
         BCTR  @15,0                                            02S0362
         EX    @15,@SM00666                                     02S0362
*      REQENTP = DSABTIOT;             /*POINT TO ENTRY TO RELEASE   */
         LR    REQENTP,@03                                      02S0363
*      DSABTIOT = TCATPTR;             /*UPDATE PTR TO TIOT          */
         ST    TCATPTR,DSABTIOT(,DSABPTR)                       02S0364
*      REQENTLN = REQENTLN - TIOELNGH; /*GET REMAINING LENGTH@YM07296*/
         L     @03,DSABTIOT(,DSABPTR)                           02S0365
         SLR   @15,@15                                          02S0365
         IC    @15,TIOELNGH(,@03)                               02S0365
         SLR   REQENTLN,@15                                     02S0365
*      TCATPTR = TCATPTR+TIOELNGH;     /*POINT TO END OF NEW ENTRY   */
         ALR   TCATPTR,@15                                      02S0366
*      IF REQENTLN ^= ZERO THEN        /*MORE SPACE REMAINS? @YM07296*/
         LTR   REQENTLN,REQENTLN                                02S0367
         BZ    @RF00367                                         02S0367
*        TCATPTR->TIOELNGH = REQENTLN; /*SET NEXT ENTRY LEN  @YM07296*/
         STC   REQENTLN,TIOELNGH(,TCATPTR)                      02S0368
*      CALL RLSETIOT;                  /*RELEASE OLD ENTRY           */
@RF00367 BAL   @14,RLSETIOT                                     02S0369
*      DO WHILE DSABFCHN ^= ZERO  &    /*MORE DSABS EXIST            */
*               DSABFCHN->DSABCATM = ON  &  /*NEXT DSAB IS CONCAT'D  */
*               DSABFCHN->DSABTIOT->TIOEDDNM = BLANKS8; /* TO THIS
*                                        GROUP               @YM07296*/
         B     @DE00370                                         02S0370
@DL00370 DS    0H                                               02S0371
*        DSABPTR = DSABFCHN;             /*POINT TO DSAB/TIOT TO MOVE*/
         L     DSABPTR,DSABFCHN(,DSABPTR)                       02S0371
*        TCATPTR ->TIOENTRY(1:TIOELNGH)=    /*MOVE TIOT DD ENTRY     */
*                      TIOENTRY(1:TIOELNGH);                    02S0372
         L     @03,DSABTIOT(,DSABPTR)                           02S0372
         SLR   @15,@15                                          02S0372
         IC    @15,TIOELNGH(,@03)                               02S0372
         BCTR  @15,0                                            02S0372
         EX    @15,@SM00666                                     02S0372
*        REQENTP = DSABTIOT;             /*UPDATE PTR TO TIOT ENTRY  */
         LR    REQENTP,@03                                      02S0373
*        DSABTIOT = TCATPTR;             /*UPDATE PTR TO TIOT        */
         ST    TCATPTR,DSABTIOT(,DSABPTR)                       02S0374
*        REQENTLN = REQENTLN - TIOELNGH; /*GET REMAINING LENGTH      */
         L     @03,DSABTIOT(,DSABPTR)                           02S0375
         SLR   @15,@15                                          02S0375
         IC    @15,TIOELNGH(,@03)                               02S0375
         SLR   REQENTLN,@15                                     02S0375
*        TCATPTR = TCATPTR + TIOELNGH;   /*POINT TO NEXT ENTRY TO USE*/
         ALR   TCATPTR,@15                                      02S0376
*        IF REQENTLN ^= ZERO THEN                               02S0377
         LTR   REQENTLN,REQENTLN                                02S0377
         BZ    @RF00377                                         02S0377
*          TCATPTR->TIOELNGH = REQENTLN; /*SET NEXT ENTRY LENGTH     */
         STC   REQENTLN,TIOELNGH(,TCATPTR)                      02S0378
*        CALL RLSETIOT;                  /*RELEASE OLD ENTRY         */
@RF00377 BAL   @14,RLSETIOT                                     02S0379
*      END;                                                     02S0380
@DE00370 L     @05,DSABFCHN(,DSABPTR)                           02S0380
         LTR   @05,@05                                          02S0380
         BZ    @DC00370                                         02S0380
         TM    DSABCATM(@05),B'00000010'                        02S0380
         BNO   @DC00370                                         02S0380
         L     @05,DSABTIOT(,@05)                               02S0380
         CLC   TIOEDDNM(8,@05),BLANKS8                          02S0380
         BE    @DL00370                                         02S0380
@DC00370 DS    0H                                               02S0381
*    END;                                                       02S0381
         AH    TEMPDCTR,@CH00062                                02S0381
@DE00360 CH    TEMPDCTR,TIOMNDSA(,TIORBPTR)                     02S0381
         BNH   @DL00360                                         02S0381
*/********************************************************************/
*/*TIOT ENTRIES FOR THE REQUEST ARE NOW CONTIGUOUS AND IN THE ORDER  */
*/*SPECIFIED.  THE POINTERS TO THE TIOT ENTRIES ARE UPDATED(DSABTIOT)*/
*/*AND THE OLD TIOT ENTRIES HAVE BEEN RELEASED.                      */
*/********************************************************************/
*/********************************************************************/
*/* SEGMENT NAME - CCATDSAB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CONCATENATE DSABS                             */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE WILL RECHAIN THE DSAB ENTRIES FOR A CONCAT REQUEST*/
*/*   SO THAT THEY ARE IN THE ORDER SPECIFIED BY THE DSAB LIST.      */
*/*   IT WILL PLACE THEM AT THE END OF THE DSAB CHAIN IF THERE ARE   */
*/*   OTHER DSABS. IF A DSAB ALREADY HAS A DSAB CONCATENATED TO IT,  */
*/*   THAT PREVIOUS CONCATENATION WILL BE PRESERVED BY CONCATENATING */
*/*   THE NEW ELEMENT(S) TO THE END OF THAT PREVIOUSLY CONCATENATED  */
*/*   GROUP. IT ALSO SETS BITS FOR DYNAMIC ALLOCATION RECOVERY TO    */
*/*   INDICATE THE CONDITION OF THE DSAB CHAIN IN CASE AN ABEND      */
*/*   OCCURS.                                                        */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     A CHECK IS MADE TO SEE IF THE DSAB POINTED TO HAS ANY DSABS  */
*/*     CONCATENATED TO IT FROM PREVIOUS CONCAT OPERATIONS. IT WILL  */
*/*     CHAIN THE DSAB (OR DSAB GROUP IF THERE WERE PREVIOUS CONCATE-*/
*/*     NATIONS) TO THE BOTTOM OF THE DSAB CHAIN. THE FORWARD CHAINS */
*/*     ARE UPDATED FIRST AND BACKCHAINS ARE UPDATED LAST. A COUNTER */
*/*     (TEMPDCTR) WILL BE INCREMENTED TO POINT TO EACH DSAB POINTER */
*/*     ON THE LIST.  THIS OPERATION WILL BE REPEATED FOR EACH DSAB  */
*/*     ON THE LIST.                                                 */
*/*                                                                  */
*/* ENTRY - INLINE SEGMENT                                           */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*   INPUT -                                                        */
*/*     TIOMDSAP - PTR TO THE LIST OF DSABS TO BE CONCATENATED       */
*/*     TIOMNDSA - NUMBER OF DSABS TO BE CONCATENATED                */
*/*     JSCBPTR  - PTR TO JSCB                                       */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - SPECIFIED DSABS REORDERED & RECHAINED, DSAB LIST   */
*/*               COMPLETELY PROCESSED.                              */
*/*     OUTPUT -                                                     */
*/*       UPDATED DSAB CHAIN AND DSAB QDB                            */
*/*     RETURN CODE - NONE                                           */
*/********************************************************************/
*DO TEMPDCTR = ONE TO TIOMNDSA;        /*PROCESS ALL DSABS IN LIST   */
         LA    TEMPDCTR,1                                       03S0382
         B     @DE00382                                         03S0382
@DL00382 DS    0H                                               03S0383
*  DSABPTR = DSABLIST(TEMPDCTR);       /*POINT TO DSAB               */
         LR    @06,TEMPDCTR                                     03S0383
         SLA   @06,2                                            03S0383
         L     @05,TIOMDSAP(,TIORBPTR)                          03S0383
         AL    @05,@CF00664                                     03S0383
         L     DSABPTR,DSABLIST(@06,@05)                        03S0383
*  LASTDSAB = DSABPTR;                 /*INIT PTR TO LAST CONCAT DSAB*/
         LR    LASTDSAB,DSABPTR                                 03S0384
*  RFY DSAB BASED(LASTDSAB);           /*RESET DSAB BASE PTR         */
*  DO WHILE DSABFCHN^= ZERO            /*PROC. TO END OF CHAIN OF ANY
*                                        DSABS PREVIOUSLY CONCAT'D   */
*       &  DSABFCHN ->DSABCATM = ON                             03S0386
*       &  DSABFCHN->DSABTIOT->TIOEDDNM(1) = BLANK;             03S0386
         B     @DE00386                                         03S0386
@DL00386 DS    0H                                               03S0387
*    LASTDSAB = LASTDSAB->DSABFCHN;    /*PTR TO LAST MEMBER OF  03S0387
*                                        PREVIOUS CONCATENATION      */
         L     LASTDSAB,DSABFCHN(,LASTDSAB)                     03S0387
*  END;                                                         03S0388
@DE00386 L     @06,DSABFCHN(,LASTDSAB)                          03S0388
         LTR   @06,@06                                          03S0388
         BZ    @DC00386                                         03S0388
         TM    DSABCATM(@06),B'00000010'                        03S0388
         BNO   @DC00386                                         03S0388
         L     @06,DSABTIOT(,@06)                               03S0388
         CLC   TIOEDDNM(1,@06),BLANK                            03S0388
         BE    @DL00386                                         03S0388
@DC00386 DS    0H                                               03S0389
*  RFY DSAB BASED(DSABPTR);            /*RESET DSAB BASE POINTER     */
*  IF LASTDSAB->DSABFCHN ^= ZERO THEN  /*IF DSAB (OR GROUP) IS NOT AT*/
         SLR   @06,@06                                          03S0390
         L     @05,DSABFCHN(,LASTDSAB)                          03S0390
         CR    @05,@06                                          03S0390
         BE    @RF00390                                         03S0390
*                                      /*END OF CHAIN ALREADY        */
*    DO;                               /*MOVE TO END OF DSAB CHAIN   */
*      TEMPENTP = LASTDSAB->DSABFCHN;  /*SAVE CURRENT LAST DSAB 03S0392
*                                        ADDRESS FOR CHAIN RECOVERY  */
         L     @15,DSABFCHN(,LASTDSAB)                          03S0392
         LR    TEMPENTP,@15                                     03S0392
*      DSQBADFC = ON;                  /*RECOVERY INDICATOR-FORWARD
*                                        CHAIN IS INCORRECT          */
         L     @14,JSCDSABQ(,JSCBPTR)                           03S0393
         OI    DSQBADFC(@14),B'10000000'                        03S0393
*      IF DSABBCHN = ZERO THEN         /*IF DSAB IS  1ST ON CHAIN    */
         C     @06,DSABBCHN(,DSABPTR)                           03S0394
         BNE   @RF00394                                         03S0394
*        DSQFRSTP = LASTDSAB->DSABFCHN; /*UPDATE NEW 1ST DSAB QDB PTR*/
         ST    @15,DSQFRSTP(,@14)                               03S0395
*      ELSE                            /*DSAB IS NOT 1ST ON CHAIN    */
*        DSABBCHN->DSABFCHN = LASTDSAB->DSABFCHN; /*UPDATE FORWARD PTR
*                                        OF PRECEEDING DSAB ON CHAIN */
         B     @RC00394                                         03S0396
@RF00394 L     @06,DSABBCHN(,DSABPTR)                           03S0396
         MVC   DSABFCHN(4,@06),DSABFCHN(LASTDSAB)               03S0396
*      DSQLASTP->DSABFCHN = DSABPTR;   /*UPDATE FORWARD PTR OF CURRENT
*                                        LAST DSAB ON CHAIN          */
@RC00394 L     @06,JSCDSABQ(,JSCBPTR)                           03S0397
         L     @01,DSQLASTP(,@06)                               03S0397
         ST    DSABPTR,DSABFCHN(,@01)                           03S0397
*      LASTDSAB->DSABFCHN = ZERO;      /*NEW LAST DSAB ON CHAIN HAS
*                                        FORWARD POINTER OF ZERO     */
         SLR   @15,@15                                          03S0398
         ST    @15,DSABFCHN(,LASTDSAB)                          03S0398
*      DSQBADBC = ON;                  /*RECOVERY INDICATOR-BACKWARD
*                                        CHAIN IS INCORRECT          */
         OI    DSQBADBC(@06),B'10000000'                        03S0399
*      DSQBADFC = OFF;                 /*FORWARD CHAIN IS CORRECT    */
         NI    DSQBADFC(@06),B'01111111'                        03S0400
*      TEMPENTP->DSABBCHN = DSABBCHN;  /*UPDATE BACK PTR OF DSAB
*                                        NEXT AFTER LAST ONE MOVED   */
         MVC   DSABBCHN(4,TEMPENTP),DSABBCHN(DSABPTR)           03S0401
*      DSABBCHN = DSQLASTP;            /*NEW BACK PTR FOR 1ST DSAB
*                                        MOVED TO END OF CHAIN       */
         MVC   DSABBCHN(4,DSABPTR),DSQLASTP(@06)                03S0402
*      DSQLASTP = LASTDSAB;            /*UPDATE NEW QDB LAST DSAB PTR*/
         ST    LASTDSAB,DSQLASTP(,@06)                          03S0403
*      DSQBADBC = OFF;                 /*BACKWARD CHAIN IS CORRECT   */
         NI    DSQBADBC(@06),B'01111111'                        03S0404
*    END;                              /*END DSAB CHAINING PROCESS   */
*  ELSE;                               /*DSAB (GROUP) ALREADY AT END OF
*                                        CHAIN; NO RECHAIN REQUIRED. */
@RF00390 DS    0H                                               03S0407
*END;                                                           03S0407
         AH    TEMPDCTR,@CH00062                                03S0407
@DE00382 CH    TEMPDCTR,TIOMNDSA(,TIORBPTR)                     03S0407
         BNH   @DL00382                                         03S0407
*    TCATPTR = TIOENTP;                /*INIT TIOT ENTRY POINTER     */
         LR    TCATPTR,TIOENTP                                  02S0408
*    DO TEMPDCTR = ONE TO TIOMNDSA;    /*PROCESS ALL DSABS ON LIST   */
         LA    TEMPDCTR,1                                       02S0409
         B     @DE00409                                         02S0409
@DL00409 DS    0H                                               02S0410
*      DSABPTR = DSABLIST(TEMPDCTR);   /*POINT TO EACH DSAB          */
         LR    @09,TEMPDCTR                                     02S0410
         SLA   @09,2                                            02S0410
         L     @01,TIOMDSAP(,TIORBPTR)                          02S0410
         AL    @01,@CF00664                                     02S0410
         L     DSABPTR,DSABLIST(@09,@01)                        02S0410
*      DSABCATM = ON;                  /*SET CONCAT INDICATOR        */
         OI    DSABCATM(DSABPTR),B'00000010'                    02S0411
*      IF TCATPTR  ^= TIOENTP THEN     /*IS THIS THE 1ST TIOT ENTRY
*                                        FOR THIS CONCAT REQUEST?    */
         CR    TCATPTR,TIOENTP                                  02S0412
         BE    @RF00412                                         02S0412
*         TIOEDDNM = BLANKS8;          /*IF NO, BLANK OUT TIOT DDNAME*/
         L     @09,DSABTIOT(,DSABPTR)                           02S0413
         MVC   TIOEDDNM(8,@09),BLANKS8                          02S0413
*      ELSE;                                                    02S0414
@RF00412 DS    0H                                               02S0415
*      TCATPTR = TCATPTR  + TIOELNGH;  /*POINT TO NEXT TIOT ENTRY    */
         L     @09,DSABTIOT(,DSABPTR)                           02S0415
         SLR   @15,@15                                          02S0415
         IC    @15,TIOELNGH(,@09)                               02S0415
         ALR   TCATPTR,@15                                      02S0415
*    END;                                                       02S0416
         AH    TEMPDCTR,@CH00062                                02S0416
@DE00409 CH    TEMPDCTR,TIOMNDSA(,TIORBPTR)                     02S0416
         BNH   @DL00409                                         02S0416
*  END;                                                         02S0417
*ELSE;                                                          02S0418
@RF00357 DS    0H                                               02S0419
*               END;                                            01S0419
*                                                               01S0419
*RETURN CODE(RETCODE);                                          01S0420
@RF00344 DS    0H                                               01S0420
@RC00303 DS    0H                                               01S0420
@RC00255 DS    0H                                               01S0420
@RC00161 DS    0H                                               01S0420
@RC00156 DS    0H                                               01S0420
@RC00141 DS    0H                                               01S0420
@RC00052 IC    @02,@OLDKEY                                      01S0420
         L     @13,4(,@13)                                      01S0420
         L     @00,@SIZDATD                                     01S0420
         LR    @01,@11                                          01S0420
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         LR    @15,@07                                          01S0420
         L     @14,12(,@13)                                     01S0420
         LM    @00,@12,20(@13)                                  01S0420
         BR    @14                                              01S0420
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ALOCTIOE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ALLOCATE A TIOT DD ENTRY                      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE IS RESPONSIBLE FOR LOCATING A FREE ENTRY IN THE   */
*/*   TIOT OF THE LENGTH REQUESTED BY THE CALLER. IF THERE ARE NO    */
*/*   ENTRIES ELIGIBLE, A NON-ZERO RETURN CODE IS RETURNED TO THE    */
*/*   CALLER.                                                        */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THIS ROUTINE WILL FIRST ATTEMPT TO ALLOCATE AN ENTRY FROM    */
*/*     ONE ON THE FREE ENTRY CHAIN. IF THERE IS AN ENTRY OF THE     */
*/*     REQUESTED LENGTH IT IS REMOVED FROM THE FREE CHAIN AND A     */
*/*     PTR TO IT RETURNED TO THE CALLER. IF, HOWEVER, THE           */
*/*     FREE ENTRY IS LARGER THAN THE REQUESTED LENGTH THE           */
*/*     ROUTINE CHECKS TO INSURE THAT THE REMAINING PORTION OF THE   */
*/*     FREE ENTRY IS AT LEAST 20 BYTES LONG - THE MINIMUM ENTRY     */
*/*     SIZE. IF IT IS NOT, THIS ENTRY CANNOT BE ALLOCATED.          */
*/*     IF A VALID ENTRY REMAINS, AN ENTRY OF THE REQUESTED SIZE IS  */
*/*     ALLOCATED AND THE REMAINING PORTION OF THE ENTRY FORMS A NEW */
*/*     ENTRY WHICH IS PLACED ON THE FREE ENTRY CHAIN.               */
*/*     A PTR TO THE ALLOCATED ENTRY IS RETURNED TO THE CALLER.      */
*/*                                                                  */
*/*     IF THERE ARE NO FREE ENTRIES ON THE CHAIN OR IF THERE WERE   */
*/*     NONE ELIGIBLE TO ALLOCATE, THE ROUTINE ATTEMPTS TO ALLOCATE  */
*/*     FROM THE CONTIGUOUS FREE SPACE IN THE TIOT CORE. IF THERE    */
*/*     IS ENOUGH SPACE, A PTR TO THE SPACE IS RETURNED TO THE       */
*/*     CALLER AND THE TIOT END INDICATOR INSERTED AFTER THE SPACE   */
*/*     ALLOCATED. THE FREE SPACE INFORMATION IN THE TIOT PREFIX     */
*/*     AREA IS UPDATED.                                             */
*/*                                                                  */
*/* ENTRY POINT - ALOCTIOE  (CLOSED SUBROUTINE)                      */
*/*   PURPOSE - TO FIND AN ELIGIBLE FREE TIOT DD ENTRY               */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JSCTMCOR - PTR TO TIOT CORE (IN JSCB)                        */
*/*     TIOFENTP - PTR TO FIRST FREE DD ENTRY                        */
*/*     TIOFREEP - PTR TO BEGINNING OF CONTIGUOUS FREE SPACE         */
*/*     TIOFRLEN - LENGTH OF FREE SPACE                              */
*/*     REQENTLN - SIZE OF ENTRY REQUESTED                           */
*/*                                                                  */
*/* EXITS - CLOSED SUBROUTINE ALWAYS RETURNS TO CALLER               */
*/*   CONDITION  - ELIGIBLE DD ENTRY FOUND                           */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       A PTR TO THE ELIGIBLE ENTRY IN TIOENTP                     */
*/*                                                                  */
*/*     RETURN CODE                                                  */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/*   CONDITION - NO ELIGIBLE ENTRY FOUND                            */
*/*     OUTPUT -                                                     */
*/*       NONE                                                       */
*/*     RETURN CODE                                                  */
*/*       RETCODE = 4                                                */
*/********************************************************************/
*ALOCTIOE: PROC;                       /*SBRTN TO ALLOCATE A DD ENTRY*/
@EL00001 IC    @02,@OLDKEY                                      02S0421
         L     @13,4(,@13)                                      02S0421
@EF00001 L     @00,@SIZDATD                                     02S0421
         LR    @01,@11                                          02S0421
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
@ER00001 LM    @14,@12,12(@13)                                  02S0421
         BR    @14                                              02S0421
@PB00001 DS    0H                                               02S0421
ALOCTIOE STM   @14,@02,12(@13)                                  02S0421
         STM   @04,@06,36(@13)                                  02S0421
         STM   @08,@12,52(@13)                                  02S0421
*TIOENTP = TIOFENTP;                   /*PT TO FIRST FREE ENTRY      */
         L     @10,JSCTMCOR(,JSCBPTR)                           02S0422
         L     TIOENTP,TIOFENTP(,@10)                           02S0422
*FRENTSW = NOTFOUND;                   /*INIT LOOP EXIT SWITCH       */
         NI    FRENTSW,B'01111111'                              02S0423
*RFY TIOENTRY BASED(TIOENTP);                                   02S0424
*DO WHILE(TIOENTP ^= ZERO              /*SCAN FREE ENTRY CHAIN       */
*         & FRENTSW = NOTFOUND);       /*TO FIND ELIGIBLE ENTRY      */
         B     @DE00425                                         02S0425
@DL00425 DS    0H                                               02S0426
*  IF TIOELNGH >= REQENTLN THEN        /*IS ENTRY AS LARGE AS REQ'D? */
         SLR   @10,@10                                          02S0426
         IC    @10,TIOELNGH(,TIOENTP)                           02S0426
         CR    @10,REQENTLN                                     02S0426
         BL    @RF00426                                         02S0426
*    DO;                               /*YES, CONTINUE CHECKING      */
*      IF TIOELNGH = REQENTLN THEN     /*IS FREE ENTRY EQ. REQ'D SIZE*/
         CR    @10,REQENTLN                                     02S0428
         BNE   @RF00428                                         02S0428
*        DO;                           /*YES, CAN ALLOCATE THIS ENTRY*/
*          FRENTSW = FOUND;            /*INDICATE ENTRY FOUND        */
         OI    FRENTSW,B'10000000'                              02S0430
*          NXTFENTP = TIONFENP;        /*SET CHAIN PTR FOR MOVE      */
         MVC   NXTFENTP(4),TIONFENP(TIOENTP)                    02S0431
*        END;                                                   02S0432
*      ELSE                            /*ENTRY LARGER THAN REQ'D     */
*        IF TIOELNGH - REQENTLN >= MINENTRY THEN /*IS EXCESS OVER 20 */
         B     @RC00428                                         02S0433
@RF00428 SLR   @10,@10                                          02S0433
         IC    @10,TIOELNGH(,TIOENTP)                           02S0433
         SLR   @10,REQENTLN                                     02S0433
         CH    @10,@CH00598                                     02S0433
         BL    @RF00433                                         02S0433
*          DO;                         /*YES,ALOC REQ'D SIZE & CREATE
*                                        A NEW FREE ENTRY            */
*            FRENTSW = FOUND;                                   02S0435
         OI    FRENTSW,B'10000000'                              02S0435
*            NXTFENTP = TIOENTP + REQENTLN;/*SET PTR TO NEW FREE ENT.*/
         LR    @08,TIOENTP                                      02S0436
         ALR   @08,REQENTLN                                     02S0436
         ST    @08,NXTFENTP                                     02S0436
*            NXTFENTP -> TIONFENP      /*MOVE CHN PTR TO NEW ENTRY...*/
*                = TIONFENP;           /*...FROM ENT. TO BE ALOC'D   */
         MVC   TIONFENP(4,@08),TIONFENP(TIOENTP)                02S0437
*            NXTFENTP -> TIOFRSW = ON; /*SET FREE ENTRY INDICATOR    */
         OI    TIOFRSW(@08),B'10000000'                         02S0438
*            NXTFENTP -> TIOELNGH =    /*SET NEW ENTRY LENGTH        */
*                TIOELNGH - REQENTLN;                           02S0439
         STC   @10,TIOELNGH(,@08)                               02S0439
*            NXTFENTP->TIOEFSRT=0;     /*MAKE ENTRY DUMMY FOR ANYONE
*                                        SEARCHING TIOT      @YM08165*/
         SLR   @10,@10                                          02S0440
         STCM  @10,7,TIOEFSRT(@08)                              02S0440
*          END;                                                 02S0441
*      IF FRENTSW = FOUND THEN         /*ELIGIBLE ENTRY FOUND?       */
@RF00433 DS    0H                                               02S0442
@RC00428 TM    FRENTSW,B'10000000'                              02S0442
         BNO   @RF00442                                         02S0442
*        DO;                           /*YES, REMOVE FROM FREE CHAIN */
*          IF TIOENTP = TIOFENTP THEN  /*WAS FOUND ENTRY FIRST ON CHN*/
         L     @10,JSCTMCOR(,JSCBPTR)                           02S0444
         C     TIOENTP,TIOFENTP(,@10)                           02S0444
         BNE   @RF00444                                         02S0444
*            TIOFENTP = NXTFENTP;      /*YES, UPDATE FIRST ENTRY PTR */
         MVC   TIOFENTP(4,@10),NXTFENTP                         02S0445
*          ELSE                                                 02S0446
*            LSTFENTP -> TIONFENP=NXTFENTP;/*UPDATE FREE CHAIN PTR IN
*                                        PREVIOUS FREE ENTRY         */
         B     @RC00444                                         02S0446
@RF00444 L     @10,LSTFENTP                                     02S0446
         MVC   TIONFENP(4,@10),NXTFENTP                         02S0446
*          TIOFRSW = OFF;              /*RESET FREE ENTRY INDICATOR  */
@RC00444 NI    TIOFRSW(TIOENTP),B'01111111'                     02S0447
*          TIOELNGH = REQENTLN;        /*SET LENGTH OF ALC'D ENTRY   */
         STC   REQENTLN,TIOELNGH(,TIOENTP)                      02S0448
*        END;                                                   02S0449
*      ELSE;                                                    02S0450
@RF00442 DS    0H                                               02S0451
*    END;                                                       02S0451
*  ELSE;                               /*ENTRY NOT LARGE ENOUGH      */
@RF00426 DS    0H                                               02S0453
*  IF FRENTSW = NOTFOUND THEN                                   02S0453
         TM    FRENTSW,B'10000000'                              02S0453
         BNZ   @RF00453                                         02S0453
*    DO;                                                        02S0454
*      LSTFENTP = TIOENTP;             /*SAVE PTR TO CURRENT ENTRY   */
         ST    TIOENTP,LSTFENTP                                 02S0455
*      TIOENTP = TIONFENP;             /*POINT TO NEXT FREE ENTRY    */
         L     TIOENTP,TIONFENP(,TIOENTP)                       02S0456
*    END;                                                       02S0457
*END;                                                           02S0458
@RF00453 DS    0H                                               02S0458
@DE00425 LTR   TIOENTP,TIOENTP                                  02S0458
         BZ    @DC00425                                         02S0458
         TM    FRENTSW,B'10000000'                              02S0458
         BZ    @DL00425                                         02S0458
@DC00425 DS    0H                                               02S0459
*IF FRENTSW = NOTFOUND THEN            /*WAS AN ENTRY FOUND ON CHAIN?*/
         TM    FRENTSW,B'10000000'                              02S0459
         BNZ   @RF00459                                         02S0459
*  DO;                                 /*NO,CHECK FREE SPACE         */
*    IF TIOFREEP ^= ZERO THEN          /*ANY CONTIGUOUS FREE SPACE?  */
         SLR   @10,@10                                          02S0461
         L     @08,JSCTMCOR(,JSCBPTR)                           02S0461
         L     @06,TIOFREEP(,@08)                               02S0461
         CR    @06,@10                                          02S0461
         BE    @RF00461                                         02S0461
*      DO;                             /*YES, SEE IF IT'S ELIGIBLE   */
*        TIOENTP = TIOFREEP            /*POINT TO START OF AREA      */
*            - LENGTH(TIOTEND);        /*ADJUST FOR END OF TIOT INDIC*/
         LA    @05,4                                            02S0463
         SLR   @06,@05                                          02S0463
         LR    TIOENTP,@06                                      02S0463
*        IF TIOFRLEN >= REQENTLN THEN  /*ENOUGH SPACE?               */
         L     @06,TIOFRLEN(,@08)                               02S0464
         CR    @06,REQENTLN                                     02S0464
         BL    @RF00464                                         02S0464
*          DO;                         /*YES, CAN ALLOCATE THE ENTRY */
*            FRENTSW = FOUND;          /*INDICATE AN ENTRY FOUND     */
         OI    FRENTSW,B'10000000'                              02S0466
*            TIOELNGH = REQENTLN;      /*SET LENGTH OF ALOC'D ENTRY  */
         STC   REQENTLN,TIOELNGH(,TIOENTP)                      02S0467
*            TIOFREEP = TIOENTP        /*UPDATE FREE SPACE POINTER   */
*                + REQENTLN;           /*TO END OF ALLOCATED ENTRY   */
         LR    @02,TIOENTP                                      02S0468
         ALR   @02,REQENTLN                                     02S0468
         ST    @02,TIOFREEP(,@08)                               02S0468
*            TIOFREEP -> TIOENTRY(1:4) = TIOTEND; /*INSERT AN 'END OF
*                                        TIOT' INDICATOR             */
         ST    @10,TIOENTRY(,@02)                               02S0469
*            TIOFREEP = TIOFREEP                                02S0470
*                + LENGTH(TIOTEND);    /*PT TO NEW BEG. OF FREE SPACE*/
         ALR   @02,@05                                          02S0470
         ST    @02,TIOFREEP(,@08)                               02S0470
*            TIOFRLEN  = TIOFRLEN - REQENTLN; /*SET AMT FREE SPACE
*                                        REMAINING                   */
         SLR   @06,REQENTLN                                     02S0471
         ST    @06,TIOFRLEN(,@08)                               02S0471
*          END;                                                 02S0472
*        ELSE                          /*NOT ENOUGH FREE SPACE       */
*          RETCODE = NOSPACE;          /*SET RETURN CODE TO 4        */
         B     @RC00464                                         02S0473
@RF00464 LA    RETCODE,4                                        02S0473
*      END;                                                     02S0474
*    ELSE                              /*NO FREE ENTRY OR FREE SPACE */
*      RETCODE = NOSPACE;              /*SET RETURN CODE TO 4        */
         B     @RC00461                                         02S0475
@RF00461 LA    RETCODE,4                                        02S0475
*  END;                                                         02S0476
*ELSE;                                 /*ENTRY ALOC'D FROM FREE CHAIN*/
@RF00459 DS    0H                                               02S0478
*RFY TIOENTRY BASED(DSABTIOT);                                  02S0478
*RETURN;                                                        02S0479
@EL00002 DS    0H                                               02S0479
@EF00002 DS    0H                                               02S0479
@ER00002 LM    @14,@02,12(@13)                                  02S0479
         LM    @04,@06,36(@13)                                  02S0479
         LM    @08,@12,52(@13)                                  02S0479
         BR    @14                                              02S0479
*END ALOCTIOE;                                                  02S0480
         B     @EL00002                                         02S0480
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RLSETIOT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - RELEASE A TIOT DD ENTRY                       */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS ROUTINE IS RESPONSIBLE FOR THE FOLLOWING FUNCTIONS:       */
*/*     .PLACING THE INPUT ENTRY ONTO THE FREE ENTRY CHAIN           */
*/*     .COMBINING CONTIGUOUS FREE ENTRIES INTO ONE UP TO THE        */
*/*      MAXIMUM ENTRY SIZE OF 252 BYTES.                            */
*/*                                                                  */
*/* OPERATION -                                                      */
*/*   TO PLACE AN ENTRY ON THE FREE CHAIN THE ROUTINE WILL SCAN THE  */
*/*   CHAIN AND INSERT THE ENTRY IN SEQUENTIAL ADDRESS ORDER. THE    */
*/*   ELEMENTS ON THE CHAIN WILL, THEREFORE, ALWAYS BE IN ORDER OF   */
*/*   ASCENDING ADDRESSES. THE ROUTINE UPDATES THE CHAIN POINTERS    */
*/*   ONCE THE POINT OF INSERTION IS DETERMINED. IF THE ENTRY BEING  */
*/*   RELEASED IS THE FIRST TO GO ON THE CHAIN, THE FIRST FREE ENTRY */
*/*   POINTER IS UPDATED AND THE CHAIN POINTER FIELD OF THE ENTRY IS */
*/*   SET TO ZERO.                                                   */
*/*                                                                  */
*/*   TO COMBINE CONTIGOUS FREE ENTRIES THE MRGNTRYS ROUTINE WILL    */
*/*   SCAN THE CHAIN FOR CONTIGOUS ENTRIES WHICH CAN BE MERGED       */
*/*   INTO ONE (SEE MRGESPEC FOR DETAILS).                           */
*/*                                                                  */
*/*                                                                  */
*/* ENTRY POINT - RLSETIOT (CLOSED SUBROUTINE)                       */
*/*   PURPOSE - TO RELEASE A TIOT ENTRY                              */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     PTR TO ENTRY TO BE RELEASED. THE ENTRY ITSELF CONTAINS THE   */
*/*     LENGTH.                                                      */
*/*     PTR TO JSCB                                                  */
*/*       JSCB CONTAINS A POINTER TO THE TIOT CORE                   */
*/*                                                                  */
*/* EXIT - CLOSED SUBROUTINE. ALWAYS RETURNS TO CALLER               */
*/*   CONDITION - INPUT DD ENTRY RELEASED                            */
*/*                                                                  */
*/*     OUTPUT -                                                     */
*/*       UPDATED TIOT ENTRY FREE CHAIN                              */
*/*                                                                  */
*/*     RETURN CODE                                                  */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/********************************************************************/
*RLSETIOT: PROC;                       /*RELEASE A DD ENTRY          */
RLSETIOT STM   @14,@02,12(@13)                                  02S0481
         STM   @04,@12,36(@13)                                  02S0481
*RFY TIOENTRY BASED (TIOENTP);                                  02S0482
*REQENTP->TIOEFSRT=0;                  /*MAKE ENTRY LOOK DUMMY, FOR
*                                        ANYONE SERCHING TIOT@YM08165*/
         SLR   @10,@10                                          02S0483
         STCM  @10,7,TIOEFSRT(REQENTP)                          02S0483
*FRSRCHSW = OFF;                       /*INIT SEARCH SWITCH          */
         NI    FRSRCHSW,B'01111111'                             02S0484
*TIOENTP = TIOFENTP;                   /*POINT TO FIRST FREE ENTRY   */
         L     @08,JSCTMCOR(,JSCBPTR)                           02S0485
         L     @04,TIOFENTP(,@08)                               02S0485
         LR    TIOENTP,@04                                      02S0485
*IF TIOENTP ^= ZERO THEN               /*ANY ENTRIES ON CHAIN?       */
         CR    TIOENTP,@10                                      02S0486
         BE    @RF00486                                         02S0486
*  IF REQENTP < TIOENTP THEN           /*NEW ENTRY FIRST ON CHAIN    */
         CR    REQENTP,TIOENTP                                  02S0487
         BNL   @RF00487                                         02S0487
*    DO;                                                        02S0488
*      REQENTP->TIONFENP = TIOFENTP;   /*SET CHAIN PTR IN NEW ENTRY  */
         ST    @04,TIONFENP(,REQENTP)                           02S0489
*      REQENTP->TIOFRSW = ON;          /*SET FREE ENTRY INDICATOR    */
         OI    TIOFRSW(REQENTP),B'10000000'                     02S0490
*      TIOFENTP = REQENTP;             /*SET PTR TO NEW FIRST        */
         ST    REQENTP,TIOFENTP(,@08)                           02S0491
*    END;                                                       02S0492
*  ELSE                                /*MUST INSERT NEW ENTRY       */
*    DO WHILE (TIOENTP ^= ZERO         /*FIND PLACE TO INSERT   02S0493
*                                        ENTRY BEING RELEASED        */
*              & FRSRCHSW = OFF);                               02S0493
         B     @RC00487                                         02S0493
@RF00487 B     @DE00493                                         02S0493
@DL00493 DS    0H                                               02S0494
*      IF TIOENTP < REQENTP THEN       /*IS ENTRY BETWEEN CURRENT ...*/
         CR    TIOENTP,REQENTP                                  02S0494
         BNL   @RF00494                                         02S0494
*        IF TIONFENP > REQENTP         /*...AND NEXT FREE ENTRIES ...*/
*             TIONFENP = ZERO THEN    /*...OR IS CURRENT ALSO LAST  */
         L     @10,TIONFENP(,TIOENTP)                           02S0495
         CR    @10,REQENTP                                      02S0495
         BH    @RT00495                                         02S0495
         LTR   @10,@10                                          02S0495
         BNZ   @RF00495                                         02S0495
@RT00495 DS    0H                                               02S0496
*          DO;                         /*YES, INSERT INPUT ENTRY HERE*/
*            FRSRCHSW = ON;            /*INDICATE END OF SEARCH      */
         OI    FRSRCHSW,B'10000000'                             02S0497
*            REQENTP->TIONFENP = TIONFENP; /*SET CHAIN PTR IN THIS
*                                        ENTRY                       */
         MVC   TIONFENP(4,REQENTP),TIONFENP(TIOENTP)            02S0498
*            REQENTP->TIOFRSW = ON;    /*SET FREE ENTRY INDICATOR    */
         OI    TIOFRSW(REQENTP),B'10000000'                     02S0499
*            TIONFENP = REQENTP;       /*CHANGE CHAIN PTR IN CURRENT
*                                        TO POINT TO INPUT ENTRY     */
         ST    REQENTP,TIONFENP(,TIOENTP)                       02S0500
*          END;                                                 02S0501
*        ELSE;                                                  02S0502
@RF00495 DS    0H                                               02S0503
*      ELSE;                                                    02S0503
@RF00494 DS    0H                                               02S0504
*      TIOENTP = TIONFENP;             /*UPDATE PTR TO NEXT FREE
*                                        ENTRY                       */
         L     TIOENTP,TIONFENP(,TIOENTP)                       02S0504
*    END;                                                       02S0505
@DE00493 LTR   TIOENTP,TIOENTP                                  02S0505
         BZ    @DC00493                                         02S0505
         TM    FRSRCHSW,B'10000000'                             02S0505
         BZ    @DL00493                                         02S0505
@DC00493 DS    0H                                               02S0506
*ELSE                                  /*INPUT ENTRY IS FIRST ON
*                                        FREE CHAIN                  */
*  DO;                                                          02S0506
         B     @RC00486                                         02S0506
@RF00486 DS    0H                                               02S0507
*    REQENTP -> TIOFRSW = ON;          /*SET FREE ENTRY INDICATOR    */
         OI    TIOFRSW(REQENTP),B'10000000'                     02S0507
*    REQENTP -> TIONFENP = ZERO;       /*ZERO PTR TO NEXT FREE ENTRY */
         SLR   @10,@10                                          02S0508
         ST    @10,TIONFENP(,REQENTP)                           02S0508
*    TIOFENTP = REQENTP;               /*SET PTR TO FIRST FREE ENTRY */
         L     @10,JSCTMCOR(,JSCBPTR)                           02S0509
         ST    REQENTP,TIOFENTP(,@10)                           02S0509
*  END;                                                         02S0510
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MRGNTRYS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - MERGE TIOT FREE ENTRIES                       */
*/*                                                                  */
*/* FUNCTION                                                         */
*/*   THIS ROUTINE ATTEMPTS TO COMBINE CONTIGUOUS FREE TIOT ENTRIES  */
*/*   INTO ONE ENTRY OF MAXIMUM SIZE. THE ROUTINE IS INVOKED EACH    */
*/*   TIME AN ENTRY IS PLACED ON THE FREE CHAIN IN AN ATTEMPT TO     */
*/*   MINIMIZE THE AMOUNT OF FRAGMENTATION OF TIOT CORE WHICH WILL   */
*/*   OCCUR.                                                         */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE ROUTINE SCANS THE TIOT FREE CHAIN TO FIND A PAIR OF      */
*/*     CONTIGUOUS FREE ENTRIES AND COMPUTES THEIR COMBINED LENGTH.  */
*/*     WHEN THE COMBINED LENGTH IS 252 BYTES OR LESS, THE ENTRIES   */
*/*     ARE MERGED INTO ONE AND THE CHAIN UPDATED TO REFLECT THE     */
*/*     MERGE.                                                       */
*/*     IF THE COMBINED LENGTH IS GREATER THAN 252 BYTES BUT EXCEEDS */
*/*     IT BY AT LEAST 20 BYTES, THE ENTRIES ARE SPLIT INTO ONE OF   */
*/*     MAXIMUM SIZE AND A NEW SMALLER ONE. THE CHAIN IS UPDATED TO  */
*/*     CONTAIN THE NEW ENTRIES.                                     */
*/*     WHEN THERE ARE NO CONTIGUOUS ENTRIES, OR THERE ARE NO MORE   */
*/*     CONTIGUOUS ENTRIES WHICH CAN BE COMBINED, THE PROCESSING IS  */
*/*     COMPLETE.                                                    */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     TIOFENTP - POINTER TO FIRST FREE ENTRY (IN TIOT PREFIX AREA) */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - NO MORE CONTIGUOUS ENTRIES OR END OF FREE CHAIN    */
*/*                                                                  */
*/*   OUTPUT - UPDATED FREE ENTRY CHAIN                              */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*EXITSW = OFF;                                                  03S0511
@RC00486 NI    EXITSW,B'01111111'                               03S0511
*TIOENTP = TIOFENTP;                                            03S0512
         L     @10,JSCTMCOR(,JSCBPTR)                           03S0512
         L     TIOENTP,TIOFENTP(,@10)                           03S0512
*DO WHILE (TIOENTP ^= ZERO             /*SCAN CHAIN TO END OR UNTIL  */
*          & EXITSW = OFF);            /*SUCCESSFUL MERGE COMPLETED  */
         B     @DE00513                                         03S0513
@DL00513 DS    0H                                               03S0514
*  MERGESW = NO;                       /*ASSUME EXIT CONDITION       */
         NI    MERGESW,B'10111111'                              03S0514
*  TEMPENTP = TIOENTP + TIOELNGH;      /*POINT TO NEXT ENTRY         */
         LR    TEMPENTP,TIOENTP                                 03S0515
         SLR   @10,@10                                          03S0515
         IC    @10,TIOELNGH(,TIOENTP)                           03S0515
         ALR   TEMPENTP,@10                                     03S0515
*  DO WHILE (TEMPENTP=TIONFENP);       /*MERGE ALL CONTIGUOUS ENTRIES*/
         B     @DE00516                                         03S0516
@DL00516 DS    0H                                               03S0517
*    TEMPLNTH = TIOELNGH               /*COMPUTE COMBINED LENGTH     */
*        + TEMPENTP -> TIOELNGH;                                03S0517
         SLR   TEMPLNTH,TEMPLNTH                                03S0517
         IC    TEMPLNTH,TIOELNGH(,TIOENTP)                      03S0517
         SLR   @10,@10                                          03S0517
         IC    @10,TIOELNGH(,TEMPENTP)                          03S0517
         ALR   TEMPLNTH,@10                                     03S0517
*    IF TEMPLNTH <= MAXLNTH THEN       /*IS IT L.T./EQ MAX LENGTH    */
         CH    TEMPLNTH,@CH00610                                03S0518
         BH    @RF00518                                         03S0518
*      DO;                             /*YES, MERGE THEM             */
*        MERGESW = YES;                /*INDICATE A MERGE DONE       */
         OI    MERGESW,B'01000000'                              03S0520
*        TIONFENP =                                             03S0521
*            TEMPENTP -> TIONFENP;     /*MOVE CHAIN PTR FROM ENTRY
*                                        BEING MERGED                */
         MVC   TIONFENP(4,TIOENTP),TIONFENP(TEMPENTP)           03S0521
*        TIOELNGH = TEMPLNTH;          /*SET NEW ENTRY LENGTH        */
         STC   TEMPLNTH,TIOELNGH(,TIOENTP)                      03S0522
*      END;                                                     03S0523
*    ELSE                              /*COMBINED LENGTH G.T. MAX    */
*      DO;                             /*SEE IF CAN SPLIT ONE        */
         B     @RC00518                                         03S0524
@RF00518 DS    0H                                               03S0525
*        NEWLNTH = TEMPLNTH - MAXLNTH; /*REDUCE LENGTH BY MAX        */
         LA    @10,252                                          03S0525
         LR    NEWLNTH,TEMPLNTH                                 03S0525
         SLR   NEWLNTH,@10                                      03S0525
*        IF NEWLNTH >= MINLNTH THEN    /*IS A MIN. FREE ENTRY LEFT   */
         CH    NEWLNTH,@CH00598                                 03S0526
         BL    @RF00526                                         03S0526
*          DO;                         /*YES, MAKE ONE MAX & ONE NEW */
*            MERGESW = YES;            /*INDICATE A MERGE DONE       */
         OI    MERGESW,B'01000000'                              03S0528
*            NEWENTP = TIOENTP         /*GET PTR TO NEW FREE ENTRY   */
*                + MAXLNTH;                                     03S0529
         ALR   @10,TIOENTP                                      03S0529
         LR    NEWENTP,@10                                      03S0529
*            NEWENTP -> TIONFENP =     /*MOVE CHAIN PTR TO NEW ENTRY */
*                TEMPENTP -> TIONFENP;                          03S0530
         MVC   TIONFENP(4,NEWENTP),TIONFENP(TEMPENTP)           03S0530
*            NEWENTP -> TIOELNGH =     /*SET LENGTH OF NEW FREE ENTRY*/
*                NEWLNTH;                                       03S0531
         STC   NEWLNTH,TIOELNGH(,NEWENTP)                       03S0531
*            NEWENTP -> TIOFRSW = ON;  /*SET FREE ENTRY INDICATOR    */
         OI    TIOFRSW(NEWENTP),B'10000000'                     03S0532
*            TIONFENP = NEWENTP;       /* SET CHAIN PTR TO NEW ENTRY */
         ST    NEWENTP,TIONFENP(,TIOENTP)                       03S0533
*            TIOELNGH = MAXLNTH;       /*SET MAX LENGTH IN MRG'D ENT */
         MVI   TIOELNGH(TIOENTP),X'FC'                          03S0534
*            TIOENTP = TIONFENP;       /*UPDATE TO NEXT FREE ENTRY   */
         L     @10,TIONFENP(,TIOENTP)                           03S0535
         LR    TIOENTP,@10                                      03S0535
*          END;                                                 03S0536
*        ELSE                          /*NOT ENOUGH SPACE FOR   03S0537
*                                        MERGE               @YM06157*/
*          TIOENTP = TIOENTP + TIOELNGH; /*POINT TO NEXT ENTRY  03S0537
*                                                            @YM06157*/
         B     @RC00526                                         03S0537
@RF00526 SLR   @10,@10                                          03S0537
         IC    @10,TIOELNGH(,TIOENTP)                           03S0537
         ALR   TIOENTP,@10                                      03S0537
*       END;                                                    03S0538
@RC00526 DS    0H                                               03S0539
*     TEMPENTP = TIOENTP + TIOELNGH;   /*UPDATE PTR TO NEXT ENTRY    */
@RC00518 LR    TEMPENTP,TIOENTP                                 03S0539
         SLR   @10,@10                                          03S0539
         IC    @10,TIOELNGH(,TIOENTP)                           03S0539
         ALR   TEMPENTP,@10                                     03S0539
*  END;                                /*END OF MERGE LOOP           */
@DE00516 L     @10,TIONFENP(,TIOENTP)                           03S0540
         CR    TEMPENTP,@10                                     03S0540
         BE    @DL00516                                         03S0540
*  IF MERGESW = NO THEN                /*WAS A MERGE DONE?           */
         TM    MERGESW,B'01000000'                              03S0541
         BNZ   @RF00541                                         03S0541
*    TIOENTP = TIONFENP;               /*NO, PT TO NEXT FREE ENTRY   */
         LR    TIOENTP,@10                                      03S0542
*  ELSE                                /*MERGE WAS SUCCESSFUL        */
*   EXITSW = ON;                       /*SET SWITCH TO EXIT LOOP     */
         B     @RC00541                                         03S0543
@RF00541 OI    EXITSW,B'10000000'                               03S0543
*END;                                                           03S0544
@RC00541 DS    0H                                               03S0544
@DE00513 LTR   TIOENTP,TIOENTP                                  03S0544
         BZ    @DC00513                                         03S0544
         TM    EXITSW,B'10000000'                               03S0544
         BZ    @DL00513                                         03S0544
@DC00513 DS    0H                                               03S0545
*RFY TIOENTRY BASED(DSABTIOT);                                  02S0545
*RETURN;                                                        02S0546
@EL00003 DS    0H                                               02S0546
@EF00003 DS    0H                                               02S0546
@ER00003 LM    @14,@02,12(@13)                                  02S0546
         LM    @04,@12,36(@13)                                  02S0546
         BR    @14                                              02S0546
*END RLSETIOT;                                                  02S0547
*END IEFAB4FC                                                   01S0548
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (A4FCSPEC)                                        *
*/*%INCLUDE SYSLIB  (A4FCDATA)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IHADSAB )                                        *
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                        *
*/*%INCLUDE SYSLIB  (IEFZB424)                                        *
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        *
*/*%INCLUDE SYSLIB  (IHAQDB  )                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D5)                                        *
*/*%INCLUDE SYSLIB  (GTIODATA)                                        *
*/*%INCLUDE SYSLIB  (ATIODATA)                                        *
*/*%INCLUDE SYSLIB  (RTIODATA)                                        *
*/*%INCLUDE SYSLIB  (MRGEDATA)                                        *
*/*%INCLUDE SYSLIB  (UPDTDATA)                                        *
*/*%INCLUDE SYSLIB  (UTIODATA)                                        *
*/*%INCLUDE SYSLIB  (GETTIOT )                                        *
*/*%INCLUDE SYSLIB  (GTIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (INITTIOT)                                        *
*/*%INCLUDE SYSLIB  (ITIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (UPDTIOT )                                        *
*/*%INCLUDE SYSLIB  (UPDTSPEC)                                        *
*/*%INCLUDE SYSLIB  (UPDSACHN)                                        *
*/*%INCLUDE SYSLIB  (UDSASPEC)                                        *
*/*%INCLUDE SYSLIB  (UNALCTIO)                                        *
*/*%INCLUDE SYSLIB  (UTIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (CONCATIO)                                        *
*/*%INCLUDE SYSLIB  (CTIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (CCATDSAB)                                        *
*/*%INCLUDE SYSLIB  (CCATSPEC)                                        *
*/*%INCLUDE SYSLIB  (ALOCTIOE)                                        *
*/*%INCLUDE SYSLIB  (ATIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (RLSETIOT)                                        *
*/*%INCLUDE SYSLIB  (RTIOSPEC)                                        *
*/*%INCLUDE SYSLIB  (MRGNTRYS)                                        *
*/*%INCLUDE SYSLIB  (MRGESPEC)                                        *
*;                                                              01S0548
@DATA    DS    0H
@CH00062 DC    H'1'
@CH00113 DC    H'2'
@CH00598 DC    H'20'
@CH00064 DC    H'24'
@CH00610 DC    H'252'
@SM00662 MVC   TIOENTRY(0,TIOENTP),TIOENTRY(@08)
@SM00666 MVC   TIOENTRY(0,TCATPTR),TIOENTRY(@03)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
IEFAB4FC CSECT
         DS    0F
@CF00655 DC    F'28'
@CH00655 EQU   @CF00655+2
@CF00638 DC    F'253'
@CF00664 DC    F'-4'
@DATD    DSECT
         DS    0D
TCBJSCB  DS    A
QDBPTR   DS    A
DQDBCORP DS    A
DSAQDBLN DS    F
SWASPID  DS    F
LSTFENTP DS    A
NXTFENTP DS    A
WSPTR    DS    A
SUBPLID  DS    F
WSLNTH   DS    F
GTSTRTCD DS    F
SAVECHNP DS    A
FREELEN  DS    CL4
         ORG   FREELEN
SPID     DS    CL1
BLKLEN   DS    AL3
         ORG   FREELEN+4
FRENTSW  DS    BL1
FRSRCHSW DS    BL1
MRGSWS   DS    BL1
         ORG   MRGSWS
EXITSW   DS    BL1
MERGESW  EQU   MRGSWS+0
         ORG   MRGSWS+1
GETMNSW  DS    BL1
@OLDKEY  DS    AL1
IEFAB4FC CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
GTSTZERO DC    F'0'
@CC00592 DC    C'DSAB'
BLANKS8  DC    CL8' '
BLANK    DC    CL1' '
IEFAB4FC CSECT
         DS   0H
A4FCPTCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFAB4FC CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
DSABCTR  EQU   @06
I        EQU   @05
TEMPLNTH EQU   @02
NEWLNTH  EQU   @04
NEWENTP  EQU   @02
TIOTSIZE EQU   @03
TMCORPTR EQU   @06
RETCODE  EQU   @07
REQENTLN EQU   @04
TEMPDCTR EQU   @08
LASTDSAB EQU   @04
TIORBPTR EQU   @10
TIOENTP  EQU   @03
TEMPENTP EQU   @05
TCATPTR  EQU   @06
SIOTPTR  EQU   @04
REQENTP  EQU   @05
JSCBPTR  EQU   @09
DSABPTR  EQU   @02
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
DSABLIST EQU   0
TIORETNP EQU   0
JOBNAME  EQU   0
PSTPNAME EQU   0
STEPNAME EQU   0
TIOPREFX EQU   0
TIOFREEP EQU   TIOPREFX
TIOFRLEN EQU   TIOPREFX+4
TIOFENTP EQU   TIOPREFX+8
TIONIUSL EQU   TIOPREFX+22
TIOTLIST EQU   TIOPREFX+24
TIOTPTR  EQU   TIOTLIST
TIOTLEN  EQU   TIOTLIST+4
TIOTHDR  EQU   0
TIOJNAME EQU   TIOTHDR
TIOSNAME EQU   TIOTHDR+8
TIOPSNME EQU   TIOTHDR+16
INDMSIOT EQU   0
SCTDDNAM EQU   INDMSIOT+4
SCTUSADD EQU   INDMSIOT+20
SIOTBYT1 EQU   INDMSIOT+43
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTALTD EQU   INDMSIOT+92
SIOTBYT2 EQU   INDMSIOT+103
SIOTETIO EQU   INDMSIOT+148
SIOTNPTR EQU   INDMSIOT+152
DSAB     EQU   0
DSABFCHN EQU   DSAB+4
DSABBCHN EQU   DSAB+8
DSABLNTH EQU   DSAB+12
DSABTIOT EQU   DSAB+16
DSABGIDP EQU   DSAB+24
DSABANMP EQU   DSAB+28
DSABORG  EQU   DSAB+32
DSABORG1 EQU   DSABORG
DSABORG2 EQU   DSABORG+1
DSABFLG1 EQU   DSAB+34
DSABPALC EQU   DSABFLG1
DSABPCAT EQU   DSABFLG1
DSABCATM EQU   DSABFLG1
DSABFLG2 EQU   DSAB+35
DSABFLG3 EQU   DSAB+36
DSABFLG4 EQU   DSAB+37
DSABANMI EQU   0
DSABANML EQU   DSABANMI
DSABGIDL EQU   0
DSABLLEN EQU   DSABGIDL
TIOT1    EQU   0
TIOENTRY EQU   0
TIOELNGH EQU   TIOENTRY
TIOESTTA EQU   TIOENTRY+1
TIOERLOC EQU   TIOENTRY+2
TIOELINK EQU   TIOERLOC+1
TIOESYOT EQU   TIOELINK
TIOEDDNM EQU   TIOENTRY+4
TIOESTTC EQU   TIOENTRY+15
TIOESTTB EQU   TIOENTRY+16
TIOEFSRT EQU   TIOENTRY+17
POOLSTAR EQU   TIOENTRY+20
TIOMGRRB EQU   0
TIOMFMAP EQU   TIOMGRRB
TIOMBLD  EQU   TIOMFMAP
TIOMALOC EQU   TIOMFMAP
TIOMRLSE EQU   TIOMFMAP
TIOMUPD  EQU   TIOMFMAP
TIOMCCAT EQU   TIOMFMAP
TIOMUNAL EQU   TIOMFMAP
TIOMFREE EQU   TIOMFMAP
TIOMRENT EQU   TIOMFMAP+1
TIOMTSZE EQU   TIOMGRRB+2
TIOMJSCP EQU   TIOMGRRB+4
TIOMJNMP EQU   TIOMGRRB+8
TIOMSNMP EQU   TIOMGRRB+12
TIOMENTP EQU   TIOMGRRB+16
TIOMDSAP EQU   TIOMGRRB+20
TIOMSIOP EQU   TIOMGRRB+24
TIOMRETP EQU   TIOMGRRB+28
TIOMPSNP EQU   TIOMGRRB+32
TIOMIUSL EQU   TIOMGRRB+36
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCSIOTS EQU   JSCBOPTS
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
QDB      EQU   0
DSLIST   EQU   0
DSLENT   EQU   DSLIST
INRBPTR  EQU   0
TIONFENP EQU   TIOEDDNM
TIOFRSW  EQU   TIOESTTA
TIOEDEVE EQU   TIOESTTB
TIOSTTB  EQU   TIOEDEVE
TIOMELEN EQU   TIOMTSZE
TIOMNDSA EQU   TIOMTSZE
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCDSABQ EQU   JSCBSEC3+60
JSCSCT   EQU   JSCBSEC3+68
JSCTMCOR EQU   JSCBSEC3+72
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV35 EQU   JSCBSEC3+96
JSCRSV36 EQU   JSCRSV35
JSCRSV37 EQU   JSCRSV35+2
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
DSABQDB  EQU   QDB
DSQDBID  EQU   DSABQDB
DSQDBLN  EQU   DSABQDB+6
DSQNELMS EQU   DSABQDB+8
DSQFRSTP EQU   DSABQDB+12
DSQBADBC EQU   DSQFRSTP
DSQLASTP EQU   DSABQDB+16
DSQBADFC EQU   DSQLASTP
DSQFDSP  EQU   DSABQDB+20
DSQBDSP  EQU   DSABQDB+22
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00040 EQU   DSABQDB+24
DSQATTRS EQU   DSABQDB+4
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCRSV41 EQU   JSCRSV37+1
JSCRSV40 EQU   JSCRSV37
JSCRSV39 EQU   JSCRSV36+1
JSCRSV38 EQU   JSCRSV36
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00039 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00038 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCRSV25 EQU   JSCBSEC3+10
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
TIOUCBP  EQU   TIOEDEVE+1
TIOVERF  EQU   TIOSTTB
TIOUNLD  EQU   TIOSTTB
TIOMNTD  EQU   TIOSTTB
TIOSETU  EQU   TIOSTTB
TIOVLSR  EQU   TIOSTTB
TIOPVIO  EQU   TIOSTTB
TIOREQD  EQU   TIOSTTB
TIOUSED  EQU   TIOSTTB
QDBRV002 EQU   QDB+28
QDBPRDS  EQU   QDB+26
QDBPRSZ  EQU   QDB+24
QDBBPTDS EQU   QDB+22
QDBFPTDS EQU   QDB+20
QDBLELMP EQU   QDB+16
QDBFELMP EQU   QDB+12
QDBNELMS EQU   QDB+8
QDBRV001 EQU   QDB+6
QDBATTR  EQU   QDB+4
QDBQDB   EQU   QDB
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00037 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00036 EQU   IEZJSCB
@NM00035 EQU   TIOMFMAP+1
@NM00034 EQU   TIOMFMAP+1
@NM00033 EQU   TIOMFMAP+1
@NM00032 EQU   TIOMFMAP+1
@NM00031 EQU   TIOMFMAP+1
@NM00030 EQU   TIOMFMAP+1
@NM00029 EQU   TIOMFMAP+1
@NM00028 EQU   TIOMFMAP
TIOTFEND EQU   POOLSTAR+16
TIOPSLOT EQU   POOLSTAR+13
TIOPSTTB EQU   POOLSTAR+12
TIOPPOOL EQU   POOLSTAR+4
TIOPNSRT EQU   POOLSTAR+3
@NM00027 EQU   POOLSTAR+2
TIOPNSLT EQU   POOLSTAR+1
@NM00026 EQU   POOLSTAR
TIOSVERF EQU   TIOESTTB
TIOSUNLD EQU   TIOESTTB
TIOSMNTD EQU   TIOESTTB
TIOSSETU EQU   TIOESTTB
TIOSVLSR EQU   TIOESTTB
TIOSPVIO EQU   TIOESTTB
TIOSREQD EQU   TIOESTTB
TIOSUSED EQU   TIOESTTB
TIOSBALS EQU   TIOESTTC
TIOSBALP EQU   TIOESTTC
TIOSVOLS EQU   TIOESTTC
TIOSVOLP EQU   TIOESTTC
TIOSAFFS EQU   TIOESTTC
TIOSAFFP EQU   TIOESTTC
TIOSDEFR EQU   TIOESTTC
TIOSDKCR EQU   TIOESTTC
TIOEJFCB EQU   TIOENTRY+12
TIOTREM  EQU   TIOELINK
TIOESSDS EQU   TIOESYOT
TIOESYIN EQU   TIOELINK
TIOEQNAM EQU   TIOELINK
TIOEDYNM EQU   TIOELINK
TIOTTERM EQU   TIOELINK
TIOTRV01 EQU   TIOELINK
TIOSYOUT EQU   TIOELINK
TIOEWTCT EQU   TIOERLOC
TIOSDSP2 EQU   TIOESTTA
TIOSDSP1 EQU   TIOESTTA
TIOSLABL EQU   TIOESTTA
TIOSDADS EQU   TIOESTTA
TIOSJBLB EQU   TIOESTTA
TIOSPLTS EQU   TIOESTTA
TIOSPLTP EQU   TIOESTTA
TIOSLTYP EQU   TIOESTTA
TIOCSTEP EQU   TIOT1+8
TIOCNJOB EQU   TIOT1
DSABGRID EQU   DSABGIDL+4
DSABANAM EQU   DSABANMI+1
DSABRS04 EQU   DSAB+68
DSABSIOT EQU   DSAB+64
DSABRS03 EQU   DSAB+62
DSABDCBM EQU   DSAB+56
DSABSSCM EQU   DSAB+52
DSABSSNM EQU   DSAB+48
DSABPTTR EQU   DSAB+44
DSABTCBP EQU   DSAB+40
DSABRS02 EQU   DSAB+38
@NM00025 EQU   DSABFLG4
DSABCKSI EQU   DSABFLG4
DSABCKVL EQU   DSABFLG4
DSABCKDS EQU   DSABFLG4
@NM00024 EQU   DSABFLG3
DSABJSCT EQU   DSABFLG3
DSABCATL EQU   DSABFLG3
DSABVMSC EQU   DSABFLG3
DSABVAM  EQU   DSABFLG3
DSABPASS EQU   DSABFLG3
DSABDEFR EQU   DSABFLG3
@NM00023 EQU   DSABFLG2
DSABUNAL EQU   DSABFLG2
DSABIRM  EQU   DSABFLG2
DSABOPEN EQU   DSABFLG2
DSABNUSE EQU   DSABFLG1
DSABDCAT EQU   DSABFLG1
DSABCONV EQU   DSABFLG1
DSABDCNV EQU   DSABFLG1
DSABDALC EQU   DSABFLG1
@NM00022 EQU   DSABORG2
DSABTR   EQU   DSABORG2
DSABAM   EQU   DSABORG2
@NM00021 EQU   DSABORG2
DSABTQ   EQU   DSABORG2
DSABTX   EQU   DSABORG2
DSABGS   EQU   DSABORG2
DSABU    EQU   DSABORG1
DSABPO   EQU   DSABORG1
DSABMQ   EQU   DSABORG1
DSABCQ   EQU   DSABORG1
DSABCX   EQU   DSABORG1
DSABDA   EQU   DSABORG1
DSABPS   EQU   DSABORG1
DSABIS   EQU   DSABORG1
DSABSSVA EQU   DSAB+21
DSABRS01 EQU   DSAB+20
DSABOPCT EQU   DSAB+14
DSABID   EQU   DSAB
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTJFX  EQU   INDMSIOT+160
SJFCBPTR EQU   INDMSIOT+156
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SCTANAME EQU   INDMSIOT+122
@NM00020 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
SIODDQCR EQU   SIOTBYT2
SIOVDQCR EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
@NM00019 EQU   INDMSIOT+93
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00018 EQU   SIOTALTD
@NM00017 EQU   SIOTALTD
@NM00016 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00015 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00014 EQU   INDMSIOT+81
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00013 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00012 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
@NM00011 EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SCTDUMMY EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
@NM00010 EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
@NM00009 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
@NM00008 EQU   SIOTTSTC
@NM00007 EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00006 EQU   INDMSIOT+35
SCTPJFCB EQU   INDMSIOT+32
@NM00005 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
@NM00004 EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
@NM00003 EQU   TIOPREFX+20
@NM00002 EQU   TIOPREFX+16
@NM00001 EQU   TIOPREFX+12
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00116 EQU   @RC00052
@RF00145 EQU   @RC00141
@RF00216 EQU   @RC00161
@RC00459 EQU   @EL00002
@RC00487 EQU   @RC00486
@PB00003 EQU   @EL00001
@RC00461 EQU   @RC00459
@PB00002 EQU   @PB00003
@RC00464 EQU   @RC00461
@ENDDATA EQU   *
         END   IEFAB4FC

         TITLE 'IEAVSOUT: SWAP OUT                                     *
                        '
*                                                        /*@Z40WPYC */
IEAVSOUT CSECT
         USING *,R15
         MODID
         ENTRY IEAVSOU2                   @Z40WPYC
IEAVSOU2 DS    0H                         @Z40WPYC
OFFSET16 EQU   16                     OFFSET INTO SAVE AREA
         STM   R2,R14,OFFSET16(R13)
         DROP  R15
         BALR  BASEREG,0              ESTABLISH BASE REGISTER
         USING *,BASEREG
         USING *+4094,BASEREG2
         LA    BASEREG2,4094(BASEREG) ADJUST BASE REGISTER
*   R5=R13;                         /* SAVE R13 OVER CALL            */
*                                                                  0114
         LR    R5,R13                                              0114
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL STATUS STOP NON-QUIESABLE SRBS AND SET THE REAL STORAGE  */
*   /* MANAGEMENT FRR                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0115
*   R15=ADDR(IEAVSSNQ);             /* GET ENTRY POINT ADDRESS       */
         L     R15,@CV02498                                        0115
*   GEN REFS(R15) SETS(R11,R12,R13,R14,R15) NOFLOWS;               0116
*                                                                  0116
         BALR  R15,R15                RETURN IS ON R15
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A MEMORY TERMINATION IS ALREADY IN PROCESS IEAVSOUT WILL   */
*   /* RETURN TO RCT AS IF SWAPOUT WAS SUCCESSFUL. THIS WILL FORCE   */
*   /* RCT TO WAIT. SINCE THE MEMORY IS TERMINATED IT IS NOT         */
*   /* NECESSARY THAT RCT BE POSTED. SRM WILL BE NOTIFIED BY MEMORY  */
*   /* DELETE PROCESSING.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0117
*   IF R1->ASCBTERM='1'B THEN       /* IF ALREADY IN PROCESS OF    0117
*                                      TERMINATION, RETURN   @Z40WPYC*/
         TM    ASCBTERM(R1),B'00010000'                            0117
         BNO   @RF00117                                            0117
*     DO;                           /* RETURN                @Z40WPYC*/
*       GENERATE NODEFS REFS(R2,R5,R14,R15) NOSETS NOFLOWS;        0119
        SR  R15,R15   INDICATE SUCCESSFUL SWAPOUT           @Z40WPYC
        LM  R2,R14,OFFSET16(R5) RESTORE CALLERS REGS        @Z40WPYC
        BR  R14                 RETURN TO RCT               @Z40WPYC
*     END;                          /* END OF RETURN PROCESSING    0120
*                                                            @Z40WPYC*/
*   ELSE                                                           0121
*     ;                             /* NOT MEMTERM - CONTINUE      0121
*                                                            @Z40WPYC*/
@RF00117 DS    0H                                                  0122
*   RFY                                                            0122
*    (R15) UNRSTD;                                                 0122
*   RFY                                                            0123
*    (R11) RSTD;                                                   0123
*   PVTPTR=CVTPVTP;                 /* GET PVT ADDRESS               */
         L     @12,CVTPTR                                          0124
         L     PVTPTR,CVTPVTP(,@12)                                0124
*   R1=PVTPRCV;                     /* GET THE ENTRY POINT TO THE RSM
*                                      RECOVERY ROUTINE              */
*                                                                  0125
         L     R1,PVTPRCV(,PVTPTR)                                 0125
*   /*****************************************************************/
*   /*                                                               */
*   /* SET THE FRR                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0126
*GETFRR:                                                           0126
*   GENERATE CODE REFS(PSA,PSACSTK,FRRSCURR,FRRS,FRRSELEN,FRRSCURR,
*       FRRSFRRA,FRRSLAST,FRRSENTR,FRRSPARM) SETS(R1,R11,R12);     0126
GETFRR   DS    0H                                                  0126
         SETFRR A,FRRAD=(1),PARMAD=(1),WRKREGS=(11,12),               **
               RELATED=(RSM,IEAVSOUT(FREEFRR))
*   R1->RCACSECT=RCACSPOT;          /* SET CSECT ID                  */
         MVI   RCACSECT(R1),X'1A'                                  0127
*   R1->RCASOUT='1'B;               /* SET MODULE ENTERED BIT        */
         OI    RCASOUT(R1),B'10000000'                             0128
*   RFY                                                            0129
*    (R14) RSTD;                                                   0129
*                                                                  0129
*   /*****************************************************************/
*   /*                                                               */
*   /* GET THE SALLOC LOCK, AND TEST FOR A ZERO SPCT ADDRESS. NON    */
*   /* SWAPPABLE ADDRESS SPACES DO NOT HAVE SWAP CONTROL TABLES      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0130
*GETSALL:                                                          0130
*   GENERATE CODE REFS(PSALITA,FLC) SETS(R11,R12,R13,R14);         0130
GETSALL  DS    0H                                                  0130
         SETLOCK OBTAIN,TYPE=SALLOC,MODE=UNCOND,                      **
               RELATED=(RSM,IEAVSOUT(FREESALL))
*   PVTPRCA=R1;                     /* SAVE THE ADDRESS OF THE RCA   */
         ST    R1,PVTPRCA(,PVTPTR)                                 0131
*   R1->RCASAL='1'B;                /* SET SALLOC LOCK HELD BIT      */
         OI    RCASAL(R1),B'10000000'                              0132
*   WORKAREA=WORKAREA&&WORKAREA;    /* CLEAR WORK SAVE AREA, INCLUDES
*                                      SETTING ALL INTERNAL FLAGS TO
*                                      ZERO.                         */
         XC    WORKAREA(72,PVTPTR),WORKAREA(PVTPTR)                0133
*   CALLER13=R5;                    /* SAVE REG 13                   */
         ST    R5,CALLER13(,PVTPTR)                                0134
*   RFY                                                            0135
*    (R5,                                                          0135
*     R11,                                                         0135
*     R14) UNRSTD;                                                 0135
*   SAVERCA=R1;                     /* SAVE THE RCA ADDRESS TO     0136
*                                      RESTORE IT AFTER ANY VSM CALL */
         L     @12,CALLER13(,PVTPTR)                               0136
         ST    R1,SAVERCA(,@12)                                    0136
*   RSMHDPTR=ASCBRSM;               /* GET THE RSM HEADER ADDRESS    */
         L     @12,ASCBPTR                                         0137
         L     RSMHDPTR,ASCBRSM(,@12)                              0137
*   SPCTPTR=RSMSPCT;                /* GET THE ADDRESS OF THE SPCT   */
         L     @12,RSMSPCT(,RSMHDPTR)                              0138
         LR    SPCTPTR,@12                                         0138
*   IF RSMSPCT=0 THEN               /* TEST IF SPCT EXISTS           */
         LTR   @12,@12                                             0139
         BNZ   @RF00139                                            0139
*     DO;                           /* ERROR HAS OCCURRED. RECORD  0140
*                                      ERROR THEN RETURN TO RCT WITH
*                                      A BAD RETURN CODE             */
*       R0='12'X;                   /* NO SPCT EXISTS                */
         LA    R0,18                                               0141
*       CALL DOABEND;               /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         0142
*       RETNCODE=BADCALL;           /* SET RETURN CODE TO SHOW SWAP
*                                      OUT WAS NOT DONE.             */
         MVC   RETNCODE(4,PVTPTR),@CF00039                         0143
*       GO TO RETN;                 /* GO TO THE EXIT POINT.         */
         B     RETN                                                0144
*     END;                                                         0145
*   SPCTOUT='1'B;                   /* SET SWAP OUT FLAG             */
@RF00139 OI    SPCTOUT(SPCTPTR),B'01000000'                        0146
*                                                                  0147
*   /*****************************************************************/
*   /*                                                               */
*   /* MUST AVOID USING LOCATION ZERO AS A PCB WHEN WE INITIALIZE ALL*/
*   /* PCBS. THERE MUST BE AT LEAST A FRAME COUNT OF 1 FOR THE ONE   */
*   /* LSQA FRAME WHICH MUST BE THERE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0147
*   IF ASCBFMCT=0 THEN                                             0147
         L     @12,ASCBPTR                                         0147
         LH    @12,ASCBFMCT(,@12)                                  0147
         LTR   @12,@12                                             0147
         BNZ   @RF00147                                            0147
*     DO;                                                          0148
*       R0='17'X;                   /* RECORD ERROR IN FRAME COUNT 0149
*                                      AND DO NOT ATTEMPT ANY FIX UP
*                                      AS THE LSQA PROCESSOR DEPENDS
*                                      ON THE EXISTANCE OF ONE LSQA
*                                      FRAME                         */
         LA    R0,23                                               0149
*       CALL DOABEND;               /* RECORD ERROR IN FRAME COUNT   */
         BAL   @14,DOABEND                                         0150
*       GO TO CLEANUP2;             /* GO ABORT SWAP                 */
         B     CLEANUP2                                            0151
*     END;                                                         0152
*                                                                  0153
*   /*****************************************************************/
*   /*                                                               */
*   /* GET ENOUGH PCBS TO SWAP OUT EVERY PRIVATE AREA FRAME IN USE BY*/
*   /* THIS ADDRESS SPACE PLUS 1. THIS EXTRA PCB IS USED AS AN AREA  */
*   /* TO CONTAIN A PARAMETER LIST TO BE PASSED TO SRM WHEN THE      */
*   /* SWAPOUT SYSEVENT IS ISSUED BY IEAVSWPC. IF THE BUILD FAILS,   */
*   /* SET A NONZERO RETURN CODE SO RCT WILL RESTORE THE ADDRESS     */
*   /* SPACE.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0153
*   FMCTASCB=ASCBFMCT;              /* SAVE FRAME COUNT AT BEGINNING
*                                      OF SWAP OUT                   */
@RF00147 L     @12,ASCBPTR                                         0153
         LH    @12,ASCBFMCT(,@12)                                  0153
         STH   @12,FMCTASCB(,PVTPTR)                               0153
*   R0=ASCBFMCT+1;                  /* NUMBER OF PCBS DESIRED        */
         AL    @12,@CF00064                                        0154
         LR    R0,@12                                              0154
*   R1=0;                           /* MAKE IT A BUILD OPTION        */
         SLR   R1,R1                                               0155
*   CALL IEAVPCB;                   /* GET PCBS                      */
         L     @15,PVTPCB(,PVTPTR)                                 0156
         BALR  @14,@15                                             0156
*   IF R15^=0 THEN                  /* CHECK RETURN CODE             */
         LTR   R15,R15                                             0157
         BZ    @RF00157                                            0157
*     DO;                                                          0158
*       R0='0E'X;                   /* RECORD PCB MANAGER ERROR      */
         LA    R0,14                                               0159
*       CALL DOABEND;               /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         0160
*       GO TO CLEANUP2;             /* GO FREE SRB AND THEN EXIT     */
         B     CLEANUP2                                            0161
*     END;                                                         0162
*   PTRPCBS=R1;                     /* SAVE ADDRESS OF PCBS          */
@RF00157 STCM  R1,7,PTRPCBS(PVTPTR)                                0163
*   RFY                                                            0164
*    (R15) UNRSTD;                                                 0164
*                                                                  0165
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE SPCT FOR SWAP OUT PROCESSING                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0165
*   SPCTSWRT=0;                     /* ENSURE PTR TO SRM WORKAREA IS
*                                      ZEROED                @Z40WPYC*/
         SLR   @12,@12                                             0165
         ST    @12,SPCTSWRT(,SPCTPTR)                              0165
*   SPCTLSQA=0;                     /* ZERO NUMBER OF LSQA ENTRIES   */
         STH   @12,SPCTLSQA(,SPCTPTR)                              0166
*   SPCTFIX=0;                      /* ZERO NUMBER OF FIX ENTRIES    */
         STH   @12,SPCTFIX(,SPCTPTR)                               0167
*   SPCTPURG='0'B;                  /* CLEAR PURGE FLAG              */
*   SPCTSWIN='0'B;                  /* CLEAR SWAP IN FLAG            */
*   SPCTPSET='0'B;                  /* ZERO LSQA PAGE DATASET FLAG 0170
*                                                            @Z40WPYC*/
         NI    SPCTPURG(SPCTPTR),B'01010111'                       0170
*   SPCTWSSZ=0;                     /* INITIALIZE WORKING SET SIZE   */
         STH   @12,SPCTWSSZ(,SPCTPTR)                              0171
*   RFY                                                            0172
*    (R11,                                                         0172
*     R12) RSTD;                                                   0172
*   R12=ADDR(SPCTSWAP);             /* GET ADDRESS OF SWAP ENTRIES 0173
*                                      AREA                          */
         LA    R12,SPCTSWAP(,SPCTPTR)                              0173
*   R12->SPCTENT=R12->SPCTENT&&R12->SPCTENT;/* ZERO OLD SWAP ENTRIES */
*                                                                  0174
         XC    SPCTENT(48,R12),SPCTENT(R12)                        0174
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR BIT MASK OF EACH SEGMENT ENTRY IN SPCT                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0175
*   R0=0;                           /* GET A ZERO                    */
         SLR   R0,R0                                               0175
*   R11=LENGTH(SPCTSEGE);           /* GET LENGTH TO USE AS INCREMENT*/
         LA    R11,6                                               0176
*   R12=ADDR(SPCTSEGS)+R11*(SPCTSSEG-1);/* CALCULATE ENDING ADDRESS  */
         LA    R12,SPCTSEGS(,SPCTPTR)                              0177
         SLR   @05,@05                                             0177
         IC    @05,SPCTSSEG(,SPCTPTR)                              0177
         BCTR  @05,0                                               0177
         MR    @04,R11                                             0177
         ALR   R12,@05                                             0177
*STOPHIST:                                                         0178
*   DO R1=ADDR(SPCTSEGS) BY R11 TO R12;/* THE LABEL IS TO PREVENT PLS
*                                      FROM GENERATING HISTORY     0178
*                                      TEMPORARY STORAGE             */
STOPHIST LA    R1,SPCTSEGS(,SPCTPTR)                               0178
         B     @DE00178                                            0178
@DL00178 DS    0H                                                  0179
*     R1->SPCTBITM=R0;              /* CLEAR A BIT MASK TO ZERO      */
         STH   R0,SPCTBITM(,R1)                                    0179
*   END;                                                           0180
         ALR   R1,R11                                              0180
@DE00178 CR    R1,R12                                              0180
         BNH   @DL00178                                            0180
*   RFY                                                            0181
*    (R11,                                                         0181
*     R12) UNRSTD;                                                 0181
*                                                                  0182
*   /*****************************************************************/
*   /*                                                               */
*   /* MAINLINE SETUP IS NOW DONE. CALL THE VARIOUS SUBROUTINES TO   */
*   /* GET THE WORK DONE.                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0182
*   RFY                                                            0182
*    (ENDPTR,                                                      0182
*     SWAPPTR) RSTD;                /* SWAPPTR IS PASSED BACK BY   0182
*                                      LSQANTRY                      */
*   CALL LSQANTRY;                  /* CALL SUBROUTINE TO BUILD LSQA
*                                      ENTRIES                       */
*                                                                  0183
         BAL   @14,LSQANTRY                                        0183
*   /*****************************************************************/
*   /*                                                               */
*   /* IF HERE, ALL LSQA FRAMES HAVE BEEN PROCESSED. POINTERS MUST BE*/
*   /* SET UP FOR THE FIX PROCESSOR WHICH IS NEXT. THESE ADD AND     */
*   /* SHIFT OPER WILL ROUND SWAPPTR TO THE NEXT DOUBLE- WORD        */
*   /* BOUNDARY IF ALREADY ON A DOUBLE-WORD BOUNDARY,THE OPER WILL   */
*   /* NOT CHANGE IT.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0184
*   GENERATE CODE;                                                 0184
         LA    SWAPPTR,7(SWAPPTR)    ADD SEVEN TO SWAPPTR @Z40WPYC
         SRL   SWAPPTR,3             CLEAR LOW 3 BITS     @Z40WPYC
         SLL   SWAPPTR,3             RESTORE REGISTER     @Z40WPYC
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE EXTENSION HAS NO
*                                      MORE ROOM.                    */
         CR    SWAPPTR,ENDPTR                                      0185
         BNE   @RF00185                                            0185
*     DO;                           /* EXTENSION IS FULL. FIX      0186
*                                      PROCESSOR IS NEVER PASSED A 0186
*                                      FULL EXTENSION. GET AN      0186
*                                      ADDITIONAL EXTENSION.         */
*       RESPECIFY                                                  0187
*        (BEGPTR) RESTRICTED;                                      0187
*       BEGPTR=BEGEXT;              /* GET THE ADDRESS OF THE      0188
*                                      EXTENSION BEGINNING.          */
         L     BEGPTR,BEGEXT(,PVTPTR)                              0188
*       CALL GETEXT;                /* CALL SUBROUTINE TO GET AN   0189
*                                      ADDITIONAL EXTENSION.         */
         BAL   @14,GETEXT                                          0189
*       RESPECIFY                                                  0190
*        (BEGPTR) UNRESTRICTED;                                    0190
*                                                                  0190
*       /*************************************************************/
*       /*                                                           */
*       /* IF CONTROL COMES HERE FROM THE GETEXT SUBROUTINE, AN      */
*       /* ADDITIONAL EXTENSION WAS OBTAINED SUCCESSFULLY.           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0191
*     END;                          /* ON RETURN, A NEW EXTENSION FOR
*                                      THE FIX ENTRIES HAS BEEN    0191
*                                      OBTAINED AND SWAPPTR POINTS TO
*                                      THE FIRST AVAILABLE FIX ENTRY
*                                      IN THE NEW EXTENSION.         */
*   RFY                                                            0192
*    (ENDPTR) UNRSTD;                                              0192
@RF00185 DS    0H                                                  0193
*   FIXBEG=BEGEXT;                  /* FIRST EXTENSION WITH FIX    0193
*                                      ENTRIES IS THE LATEST       0193
*                                      EXTENSION.                    */
         L     @11,BEGEXT(,PVTPTR)                                 0193
         ST    @11,FIXBEG(,PVTPTR)                                 0193
*   PTRFIRST=SWAPPTR;               /* SWAPPTR WAS SET UP TO POINT TO
*                                      THE FIRST AVAILABLE FIX ENTRY.
*                                      PRTLAST IS ALREADY ZERO FROM
*                                      WORKAREA ZEROING. IT INDICATES
*                                      THERE ARE NO FIX ENTRIES IN 0194
*                                      THE SPCT.                     */
*                                                                  0194
         ST    SWAPPTR,PTRFIRST(,PVTPTR)                           0194
*   /*****************************************************************/
*   /*                                                               */
*   /* ONCE THE LSQA ENTRIES HAVE BEEN MADE IN THE SPCT NO FOES CAN  */
*   /* BE FREEMAINED AS THE FREEMAIN MAY FREE AN LSQA FRAME FOR WHICH*/
*   /* THERE IS ALREADY AN ENTRY                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*   CALL FIXENTRY;                  /* CALL SUBROUTINE TO BUILD FIXED
*                                      ENTRIES                       */
         BAL   @14,FIXENTRY                                        0195
*   RFY                                                            0196
*    (SWAPPTR) UNRSTD;                                             0196
*   PURGDON='1'B;                   /* FROM NOW ON GETEXT IS TO    0197
*                                      RETURN TO ITS CALLER IF A   0197
*                                      GETMAIN FAILS, AND INITPCB IS
*                                      TO RETURN TO ITS CALLER IF IT
*                                      RUNS OUT OF PCBS              */
         OI    PURGDON(PVTPTR),B'00001000'                         0197
*                                                                  0198
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF THERE WILL BE ENOUGH PCBS FOR STAGE1 TO PAGE OUT ALL */
*   /* LSQA AND PRIVATE AREA FIXED FRAMES. IF NOT, RECORD AN ERROR   */
*   /* AND ABORT THE SWAP AS THERE IS NO WAY FOR STAGE1 PROCESSOR TO */
*   /* BACK OUT IF IT RUNS OUT OF PCBS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0198
*   IF PAFIX+SPCTLSQA>FMCTASCB THEN                                0198
         LH    @12,SPCTLSQA(,SPCTPTR)                              0198
         AL    @12,PAFIX(,PVTPTR)                                  0198
         CH    @12,FMCTASCB(,PVTPTR)                               0198
         BNH   @RF00198                                            0198
*     DO;                                                          0199
*       R0='17'X;                   /* FRAME COUNT IS IN ERROR       */
         LA    R0,23                                               0200
*       CALL DOABEND;               /* RECORD ERR IN FRAME COUNT     */
         BAL   @14,DOABEND                                         0201
*       ASCBFMCT=PAFIX+SPCTLSQA;    /* MAKE FRAME COUNT MORE CORRECT
*                                      THEN IT WAS AT ENTRY TO SWAP
*                                      OUT                           */
         LH    @12,SPCTLSQA(,SPCTPTR)                              0202
         AL    @12,PAFIX(,PVTPTR)                                  0202
         L     @11,ASCBPTR                                         0202
         STH   @12,ASCBFMCT(,@11)                                  0202
*       GO TO CLEANUP1;             /* GO ABORT SWAP                 */
         B     CLEANUP1                                            0203
*     END;                                                         0204
*                                                                  0204
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION INITIALIZES ONE PCB AS A SPECIAL PCB TO CONTAIN  */
*   /* THE SRM PARMLIST, A WORKAREA, AND AN SRB TO SCHEDULE IEAVPIOI */
*   /* AND PARTIALLY INITIALIZES ALL PCBS ON THE CHAIN TO BE SWAP OUT*/
*   /* PCBS                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0205
*   SPCTSWRT=PTRPCBS;               /* SET PTR TO PCB CONTAINING THE
*                                      SWAPOUT PARAMETER LIST      0205
*                                                            @Z40WPYC*/
@RF00198 L     @12,PTRPCBS-1(,PVTPTR)                              0205
         LA    @12,0(,@12)                                         0205
         ST    @12,SPCTSWRT(,SPCTPTR)                              0205
*   RESPECIFY                                                      0206
*     SOUTPARM BASED(SPCTSWRT);     /*                       @Z40WPYC*/
*   PCBPTR=PTRPCBS->PCBFQPA;        /* GET ADDR OF FIRST SWAPOUT PCB
*                                                            @Z40WPYC*/
         L     PCBPTR,PCBFQPA-1(,@12)                              0207
         LA    PCBPTR,0(,PCBPTR)                                   0207
*   SOUTWRKA=PTRPCBS->PCBFQP;       /* SAVE PTR TO FIRST PCB AND THE
*                                      QUEUE ID(FF) IN CASE THE    0208
*                                      SWAPOUT IS TERMINATED AND ALL
*                                      PCB'S MUST BE FREED.ALSO THE
*                                      FIRST PCB IS ASSUMED TO BE FOR
*                                      LSQA, AND WILL BE PASSED AS 0208
*                                      INPUT TO IEAVPIOI     @Z40WPYC*/
         L     @11,PCBFQP(,@12)                                    0208
         ST    @11,SOUTWRKA(,@12)                                  0208
*   PTRPCBS->PCBFQPA=0;             /* BREAK THE CHAIN       @Z40WPYC*/
         SLR   @11,@11                                             0209
         STCM  @11,7,PCBFQPA(@12)                                  0209
*   PTRPCBS=PCBPTR;                 /* POINT TO FIRST SWAPOUT PCB  0210
*                                                            @Z40WPYC*/
         STCM  PCBPTR,7,PTRPCBS(PVTPTR)                            0210
*   NEXTPCB=PCBPTR;                 /* ADDRESS OF FIRST PCB TO BE  0211
*                                      USED AS A SWAP OUT PCB        */
         ST    PCBPTR,NEXTPCB(,PVTPTR)                             0211
*   PCBBQPA=0;                      /* FIRST SWAP OUT PCB HAS NO   0212
*                                      PREVIOUS PCBS.                */
         ST    @11,PCBBQPA(,PCBPTR)                                0212
*   PCBIOI='1'B;                    /* OUTPUT I/O.                   */
         OI    PCBIOI(PCBPTR),B'00000010'                          0213
*   PCBFREAL='1'B;                  /* FREE THE FRAME AFTER THE SWAP
*                                      OUT I/O COMPLETES.            */
         OI    PCBFREAL(PCBPTR),B'10000000'                        0214
*   PCBSWPOT='1'B;                  /* SWAP OUT OPERATION.           */
         OI    PCBSWPOT(PCBPTR),B'10000000'                        0215
*   PCBASCB=ASCBPTR;                /* GET THE ASCB ADDRESS          */
         L     @12,ASCBPTR                                         0216
         ST    @12,PCBASCB(,PCBPTR)                                0216
*   AIAWRITE='1'B;                  /* WRITE OPERATION       @Z40WPYC*/
         OI    AIAWRITE(PCBPTR),B'10000000'                        0217
*   R1=PCBFQPA;                     /* GET THE ADDRESS OF THE NEXT 0218
*                                      PCB TO BE INITIALIZED.        */
         L     R1,PCBFQPA-1(,PCBPTR)                               0218
         LA    R1,0(,R1)                                           0218
*   DO WHILE R1^=0;                 /* THIS DO GROUP WILL PARTIALLY
*                                      INITIALIZE ALL THE REMAINING
*                                      PCBS BY MOVING THE DATA FROM
*                                      THE FIRST PARTLY INITIALIZED
*                                      PCB TO EACH REMAINING PCB ON
*                                      THE INTERNAL CHAIN.           */
         B     @DE00219                                            0219
@DL00219 DS    0H                                                  0220
*     R1->AREA=PCBPTR->AREA;        /* INITIALIZE THE PRESENT PCB AND
*                                      AIA.                          */
         MVC   AREA(56,R1),AREA(PCBPTR)                            0220
*     R1=R1->PCBFQPA;               /* GET THE ADDRESS OF THE NEXT 0221
*                                      PCB ON THE CHAIN AND LOOP.    */
         L     @12,PCBFQPA-1(,R1)                                  0221
         LA    @12,0(,@12)                                         0221
         LR    R1,@12                                              0221
*   END;                                                           0222
@DE00219 LTR   R1,R1                                               0222
         BNZ   @DL00219                                            0222
*                                                                  0223
*   /*****************************************************************/
*   /*                                                               */
*   /* FROM THIS POINT ON THE SWAPOUT CAN NOT BE ABORTED             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0223
*   CALL PIOPURGE;                  /* CALL SUBROUTINE TO PURGE    0223
*                                      PAGING I/O.                   */
         BAL   @14,PIOPURGE                                        0223
*   CALL STAGE1;                    /* GO CREATE PCBS FOR FIX AND  0224
*                                      LSQA ENTRIES                  */
         BAL   @14,STAGE1                                          0224
*   CALL WORKSET;                   /* CALL SUBROUTINE TO BUILD    0225
*                                      WORKING SET PCBS              */
*                                                                  0225
         BAL   @14,WORKSET                                         0225
*   /*****************************************************************/
*   /*                                                               */
*   /* ADJUST SPCT COUNTS                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0226
*   PCBRPTR=SPCTSWRT;               /* GET THE SPECIAL PCB TO CONTAIN
*                                      THE SRM PARAMETER LIST      0226
*                                                            @Z40WPYC*/
         L     @11,SPCTSWRT(,SPCTPTR)                              0226
         LR    PCBRPTR,@11                                         0226
*   OPTSOUT=ROOTCNT;                /* TELL SRM COUNT OF PAGES     0227
*                                      SWAPPED OUT                   */
         LH    @12,ROOTCNT(,PVTPTR)                                0227
         STH   @12,OPTSOUT(,@11)                                   0227
*   SPCTWSSZ=SPCTWSSZ+SPCTLSQA+SPCTFIX;/* SWAP IN SIZE IS SUM OF FIX,
*                                      LSQA, AND INCORE PAGES.       */
         LH    @12,SPCTWSSZ(,SPCTPTR)                              0228
         AH    @12,SPCTLSQA(,SPCTPTR)                              0228
         AH    @12,SPCTFIX(,SPCTPTR)                               0228
         STH   @12,SPCTWSSZ(,SPCTPTR)                              0228
*   OPTSIN=SPCTWSSZ;                /* GET SWAP IN SIZE FOR SRM.     */
*                                                                  0229
         STH   @12,OPTSIN(,@11)                                    0229
*   /*****************************************************************/
*   /*                                                               */
*   /* UPDATE COUNT OF NUMBER OF FRAMES FREED BY SWAP OUT BUT NOT    */
*   /* PAGED OUT                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0230
*   PVTSPFR=PVTSPFR+FMCTASCB-ASCBFMCT;/* CALCULATE NUMBER OF FRAMES
*                                      FREED IN SWAP OUT MAINLINE  0230
*                                      PROCESSING AND ADD NUMBER TO
*                                      COUNTER FOR SYSTEM RESOURSE 0230
*                                      MANAGER                       */
         LH    @12,FMCTASCB(,PVTPTR)                               0230
         LH    @06,PVTSPFR(,PVTPTR)                                0230
         N     @06,@CF02704                                        0230
         ALR   @06,@12                                             0230
         L     @15,ASCBPTR                                         0230
         LH    @15,ASCBFMCT(,@15)                                  0230
         SLR   @06,@15                                             0230
         STH   @06,PVTSPFR(,PVTPTR)                                0230
*   OPTSPFR=FMCTASCB-ASCBFMCT;      /* COUNT OF FRAMES FREED WITHOUT
*                                      I/O                   @YM05621*/
*                                                                  0231
         SLR   @12,@15                                             0231
         STH   @12,OPTSPFR(,@11)                                   0231
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE UNUSED PCBS AND PUT PAGE OUT PCBS ON LOCAL I/O ACTIVE    */
*   /* QUEUE                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0232
*   IF NEXTPCB^=0 THEN                                             0232
         SLR   @12,@12                                             0232
         L     @11,NEXTPCB(,PVTPTR)                                0232
         CR    @11,@12                                             0232
         BE    @RF00232                                            0232
*     DO;                                                          0233
*       R1=NEXTPCB;                 /* FIRST PCB TO BE FREED         */
         LR    R1,@11                                              0234
*       R13=NEXTPCB->PCBBQPA;       /* GET ADDRESS OF LAST PAGE OUT
*                                      PCB                           */
         L     R13,PCBBQPA(,@11)                                   0235
*       NEXTPCB->PCBBQPA=0;         /* ZERO BACKWARD POINTER OF PCB
*                                      AT HEAD OF CHAIN WHICH IS TO
*                                      BE FREED.                     */
         ST    @12,PCBBQPA(,@11)                                   0236
*       R13->PCBFQPA=0;             /* ZERO FORWARD POINTER OF LAST
*                                      PCB ON CHAIN                  */
         STCM  @12,7,PCBFQPA(R13)                                  0237
*       R13->AIANXAIA=0;            /* ZERO AIA FORWARD PTR OF LAST
*                                      AIA                           */
         ST    @12,AIANXAIA(,R13)                                  0238
*       R0=PCBFREQN;                /* SEND PCB'S TO FREE Q          */
         LA    R0,16                                               0239
*       CALL IEAVPCB;               /* FREE UNUSED PCBS              */
         L     @15,PVTPCB(,PVTPTR)                                 0240
         BALR  @14,@15                                             0240
*     END;                                                         0241
*   R0=PCBLIOQN;                    /* PCBS TO LOCAL Q               */
@RF00232 LA    R0,136                                              0242
*   R1=PTRPCBS;                     /* ADDRESS OF FIRST PCB ON CHAIN
*                                      WHICH GOES TO LOCAL I/O ACTIVE
*                                      Q                             */
         L     R1,PTRPCBS-1(,PVTPTR)                               0243
         LA    R1,0(,R1)                                           0243
*   CALL IEAVPCB;                   /* PCBS TO LOCAL Q               */
*                                                                  0244
         L     @15,PVTPCB(,PVTPTR)                                 0244
         BALR  @14,@15                                             0244
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL ASM TO INITIATE I/O FOR SWAPOUT OF THE NON-LSQA (FIXED)  */
*   /* PAGES                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   IF NLSQAPCB^=0&NEXTPCB^=NLSQAPCB THEN/* IS THERE AT LEAST ONE FIX
*                                      PCB TO PROCESS        @Z40WPYC*/
         L     @12,SPCTSWRT(,SPCTPTR)                              0245
         L     @12,NLSQAPCB-1(,@12)                                0245
         LA    @12,0(,@12)                                         0245
         LTR   @12,@12                                             0245
         BZ    @RF00245                                            0245
         C     @12,NEXTPCB(,PVTPTR)                                0245
         BE    @RF00245                                            0245
*     DO;                           /* YES - CALL ASM TO START THE 0246
*                                      OUTPUT I/O FOR THE PRIVATE  0246
*                                      AREA NON-LSQA PAGES. THE I/O
*                                      FOR THE LSQA PAGES WILL BE  0246
*                                      STARTED BY IEAVPIOI IN THE  0246
*                                      MASTER ADDRESS SPACE (SCHEDULE
*                                      BY IEAVESOUT)         @Z40WPYC*/
*       RESPECIFY                                                  0247
*        (R15) RESTRICTED;          /*                       @Z40WPYC*/
*       RESPECIFY                                                  0248
*         PCB BASED(R1);            /*                       @Z40WPYC*/
*       R1=NLSQAPCB;                /* SET PTR TO FIRST PCB  @Z40WPYC*/
         LR    R1,@12                                              0249
*       R1=ADDR(PCBAIA);            /* SET PTR TO FIRST AIA FOR ASM
*                                                            @Z40WPYC*/
         LA    @14,PCBAIA(,R1)                                     0250
         LR    R1,@14                                              0250
*       RESPECIFY                                                  0251
*         PCB BASED(PCBPTR);        /*                       @Z40WPYC*/
*       CALL ILRPAGIO;              /* START I/O FOR SWAPOUT @Z40WPYC*/
         L     @15,PVTPAGIO(,PVTPTR)                               0252
         BALR  @14,@15                                             0252
*       IF R15^=0 THEN              /* IF ASM FOUND ERROR WHILE    0253
*                                      PROCESSING INPUT AIA QUEUE  0253
*                                                            @Z40WPYC*/
         LTR   R15,R15                                             0253
         BZ    @RF00253                                            0253
*         DO;                       /* PROCESS ERROR         @Z40WPYC*/
*           PCBPTR=NLSQAPCB->PCBBQPA;/* OBTAIN PTR TO LAST LSQA    0255
*                                                            @Z40WPYC*/
         L     @14,SPCTSWRT(,SPCTPTR)                              0255
         L     @12,NLSQAPCB-1(,@14)                                0255
         L     PCBPTR,PCBBQPA(,@12)                                0255
*           AIANXAIA=R1;            /* CHAIN FIRST AIA IN ERROR TO 0256
*                                      LAST LSQA AIA         @ZA16398*/
         ST    R1,AIANXAIA(,PCBPTR)                                0256
*           R1=ADDR(LSQAPCBS->PCBAIA);/* SET PTR TO FIRST LSQA AIA.
*                                      IEAVSWPC WILL TURN OFF      0257
*                                      PFTPCBSI FOR EACH AIA, AND  0257
*                                      FREE THE PCB.         @Z40WPYC*/
         L     R1,LSQAPCBS-1(,@14)                                 0257
         LA    R1,0(,R1)                                           0257
         LA    R1,PCBAIA(,R1)                                      0257
*           R0=8;                   /* SET RET CODE FOR SWPC @Z40WPYC*/
         LA    R0,8                                                0258
*           CALL IEAVSWPC;          /* TERM. THE ADDR SPACE  @Z40WPYC*/
         L     @15,PVTPSWPC(,PVTPTR)                               0259
         BALR  @14,@15                                             0259
*           PVTPRCA=SAVERCA;        /* RESTORE RCA ADDRESS   @Z40WPYC*/
*                                                                  0260
         L     @14,CALLER13(,PVTPTR)                               0260
         L     @14,SAVERCA(,@14)                                   0260
         ST    @14,PVTPRCA(,PVTPTR)                                0260
*           /*********************************************************/
*           /*                                                       */
*           /* NOTE THAT A SUCCESSFUL RETURN CODE WILL BE RETURNED,  */
*           /* TO FORCE RCT TO WAIT. THE ADDRESS SPACE WILL BE       */
*           /* TERMINATED BY SWPC                                    */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0261
*         END;                      /* END ERROR PROCESSING  @Z40WPYC*/
*       ELSE                                                       0262
*         ;                         /* I/O STARTED SUCCESSFULLY    0262
*                                                            @Z40WPYC*/
@RF00253 DS    0H                                                  0263
*     END;                          /* CALL ASM              @Z40WPYC*/
*   ELSE                                                           0264
*     ;                             /* NO I/O                @Z40WPYC*/
@RF00245 DS    0H                                                  0265
*   RESPECIFY                                                      0265
*    (R15) UNRESTRICTED;            /*                       @Z40WPYC*/
*   IF SPCTSWRT^=0 THEN             /* IS SWAPOUT STILL ON   @Z40WPYC*/
         L     @12,SPCTSWRT(,SPCTPTR)                              0266
         LTR   @12,@12                                             0266
         BZ    @RF00266                                            0266
*     DO;                           /* YES - SCHEDULE IEAVPIOI TO  0267
*                                      INITIATE THE I/O FOR THE LSQA
*                                      PAGES                 @Z40WPYC*/
*                                                                  0267
*       /*************************************************************/
*       /*                                                           */
*       /* INITIALIZE AN SRB TO SCHEDULE IEAVPIOI            @Z40WPYC*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0268
*       SRBPTR=ADDR(PIOISRB);       /* GET SRB PTR - NOTE THAT THE 0268
*                                      SRB HAS PREVIOUSLY BEEN     0268
*                                      CLEARED BY IEAVPCB    @Z40WPYC*/
         LA    SRBPTR,PIOISRB(,@12)                                0268
*       ASVTPTR=CVTASVT;            /* GET ADDR OF ADDRESS SPACE   0269
*                                      VECTOR TABLE                  */
         L     @11,CVTPTR                                          0269
         L     @06,CVTASVT(,@11)                                   0269
         ST    @06,ASVTPTR(,@11)                                   0269
*       SRBASCB=ASVTENTY(1);        /* THE FIRST ENTRY IN THE ASVT 0270
*                                      CONTAINS THE ADDRESS OF MASTER
*                                      SCHEDULER ASCB                */
         L     @11,ASVTENTY(,@06)                                  0270
         ST    @11,SRBASCB(,SRBPTR)                                0270
*       SRBEP=PVTPPIOI;             /* SET TO IEAVPIOI ENTRY POINT 0271
*                                                            @Z40WPYC*/
         L     @11,PVTPPIOI(,PVTPTR)                               0271
         ST    @11,SRBEP(,SRBPTR)                                  0271
*       SRBPASID=ASCBASID;          /* ASID OF ADDRESS SPACE BEING 0272
*                                      SWAPPED OUT                   */
         L     @11,ASCBPTR                                         0272
         LH    @11,ASCBASID(,@11)                                  0272
         N     @11,@CF02704                                        0272
         STH   @11,SRBPASID(,SRBPTR)                               0272
*       SRBID='SRB ';               /* GET ID                        */
         MVC   SRBID(4,SRBPTR),@CC02532                            0273
*       SRBPRIOR=4;                 /* NONQUIESSABLE LEVEL           */
         MVI   SRBPRIOR(SRBPTR),X'04'                              0274
*       SRBPARM=SPCTSWRT;           /* PASS PTR TO THE SWAPOUT     0275
*                                      PARAMETER LIST        @Z40WPYC*/
         ST    @12,SRBPARM(,SRBPTR)                                0275
*       SRBRMTR=PVTPSRBP;           /* RSM PURGE ROUTINE     @Z40WPYC*/
         L     @12,PVTPSRBP(,PVTPTR)                               0276
         ST    @12,SRBRMTR(,SRBPTR)                                0276
*       GENERATE REFS(R1,CVTGSMQ,SRBSECT,CVTMAP,SRBFLNK) SETS(R0,R15)
*           NOFLOWS;                                               0277
               SCHEDULE   SRB=(1),SCOPE=LOCAL
*     END;                          /* END SRB PROCESSING    @Z40WPYC*/
*   ELSE                                                           0279
*     ;                             /* IEAVSWPC WAS CALLED, BYPASS 0279
*                                      SCHEDULING OF IEAVPIOI      0279
*                                                            @Z40WPYC*/
@RF00266 DS    0H                                                  0280
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE UNUSED EXTENSIONS                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*   RESPECIFY                                                      0280
*    (R4,                                                          0280
*     R14,                                                         0280
*     R15) RESTRICTED;                                             0280
*   R1=BEGEXT->SPCTEXT;             /* GET THE ADDRESS OF THE NEXT 0281
*                                      EXTENSION FROM THE LAST USED
*                                      EXTENSION.                    */
         L     @12,BEGEXT(,PVTPTR)                                 0281
         L     R1,SPCTEXT(,@12)                                    0281
*   BEGEXT->SPCTEXT=0;              /* ZERO THE FOREWARD EXTENSION 0282
*                                      POINTER.                      */
         SLR   @11,@11                                             0282
         ST    @11,SPCTEXT(,@12)                                   0282
*NEXTEXT:                                                          0283
*   IF R1=0 THEN                    /* TEST IF ALL UNUSED EXTENSIONS
*                                      ARE NOW FREE.                 */
NEXTEXT  LTR   R1,R1                                               0283
         BZ    @RT00283                                            0283
*     GOTO RETN;                    /* ALL UNUSED EXTENSIONS       0284
*                                      FREE.EXIT                     */
*   RESPECIFY                                                      0285
*    (SAVEEXT) RESTRICTED;                                         0285
*   SAVEEXT=R1->SPCTEXT;            /* SAVE THE ADDRESS OF THE NEXT
*                                      EXTENSION.                    */
         L     SAVEEXT,SPCTEXT(,R1)                                0286
*   R0=LENGTH(SPCTEXTM);            /* GET THE LENGTH OF AN EXTENSION*/
         LA    R0,56                                               0287
*   R4=0;                           /* GLOBAL SQA REQUEST DOES NOT 0288
*                                      NEED A TCB.                   */
         SLR   R4,R4                                               0288
*   R7=ASCBPTR;                     /* ASCB IS THIS ASCB             */
         L     R7,ASCBPTR                                          0289
*/********************************************************************/
*/*                                                                  */
*/*                     FREEMAIN AN UNUSED EXTENSION.                */
*/*                   INPUT:                                         */
*/*              R0: LENGTH OF THE EXTENSION                         */
*/*              R1: ADDRESS OF THE EXTENSION                        */
*/*              R2: UNUSED                                          */
*/*              R3: LOADED BY THE MACRO                             */
*/*              R4: ZERO                                            */
*/*              R5 - R6: UNUSED                                     */
*/*              R7: ADDRESS OF THE ASCB                             */
*/*              R8 - R13: UNUSED                                    */
*/*              R14: RETURN ADDRESS LOADED BY MACRO                 */
*/*              R15: ENTRY POINT ADDRESS LOADED BY MACRO            */
*/*                   OUTPUT:                                        */
*/*              R0 - R14: RESTORED                                  */
*/*              R15: RETURN CODE                                    */
*/*                     0 - SUCCESSFUL                               */
*/*                     NON-0 - UNSUCCESSFUL                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0290
*   GENERATE CODE;                                                 0290
FREECORE FREEMAIN RC,LV=(0),A=(1),SP=245,BRANCH=YES,                  **
               RELATED=(SPCT-EXT,IEAVSOUT(GETCORE))
*   RESPECIFY                                                      0291
*    (R4,                                                          0291
*     R14) UNRESTRICTED;                                           0291
*   PVTPTR=CVTPVTP;                 /* RESTORE THE PVT ADDRESS       */
         L     @14,CVTPTR                                          0292
         L     PVTPTR,CVTPVTP(,@14)                                0292
*   PVTPRCA=SAVERCA;                /* RESTORE THE RCA POINTER       */
         L     @14,CALLER13(,PVTPTR)                               0293
         L     @14,SAVERCA(,@14)                                   0293
         ST    @14,PVTPRCA(,PVTPTR)                                0293
*   IF R15^=0 THEN                  /* TEST FOR A BAD RETURN CODE.   */
         LTR   R15,R15                                             0294
         BZ    @RF00294                                            0294
*     DO;                           /* RETURN CODE IS BAD. RECORD THE
*                                      ERROR, BUT CONTINUE THE SWAP. */
*       R0='03'X;                   /* RECORD FREEMAIN FAILURE       */
         LA    R0,3                                                0296
*       CALL DOABEND;               /* RECORD THE ERROR              */
         BAL   @14,DOABEND                                         0297
*       GOTO RETN;                  /* EXIT. DO NOT CONTINUE FREEING
*                                      EXTENSIONS BECAUSE OF ERRORS. */
         B     RETN                                                0298
*     END;                                                         0299
*   RESPECIFY                                                      0300
*    (R15) UNRESTRICTED;                                           0300
@RF00294 DS    0H                                                  0301
*   R1=SAVEEXT;                     /* GET THE ADDRESS OF THE NEXT 0301
*                                      UNUSED EXTENSION.             */
         LR    R1,SAVEEXT                                          0301
*   GOTO NEXTEXT;                   /* GO FREE THE NEXT UNUSED     0302
*                                      EXTENSION.                    */
         B     NEXTEXT                                             0302
*   RESPECIFY                                                      0303
*    (SAVEEXT) UNRESTRICTED;                                       0303
*                                                                  0304
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE UP ALL THE PCBS ACQUIRED AND THE SRB                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0304
*CLEANUP1:                                                         0304
*   RESPECIFY                                                      0304
*    (R0,                                                          0304
*     R1) RESTRICTED;               /*                       @Z40WPYC*/
CLEANUP1 DS    0H                                                  0305
*   R0=PCBFREQN;                    /* PCBS TO FREE QUEUE    @Z40WPYC*/
         LA    R0,16                                               0305
*   IF SPCTSWRT^=0 THEN             /* HAS SRM WORK AREA BEEN      0306
*                                      OBTAINED              @Z40WPYC*/
         SLR   @12,@12                                             0306
         L     @11,SPCTSWRT(,SPCTPTR)                              0306
         CR    @11,@12                                             0306
         BE    @RF00306                                            0306
*     DO;                           /* YES - RECHAIN PCBS    @Z40WPYC*/
*       SPCTSWRT->PCBFQP=SOUTWRKA;  /* RELINK SWAPOUT PARAMETER LIST
*                                      SO IT APPEARS AS FIRST PCB ON
*                                      CHAIN TO BE FIXED.    @Z40WPYC*/
         L     @06,SOUTWRKA(,@11)                                  0308
         ST    @06,PCBFQP(,@11)                                    0308
*       PTRPCBS->PCBBQPA=SPCTSWRT;  /* RESTORE BACK PTR OF FIRST   0309
*                                      SWAPOUT PCB.          @Z40WPYC*/
         L     @06,PTRPCBS-1(,PVTPTR)                              0309
         ST    @11,PCBBQPA(,@06)                                   0309
*       R1=SPCTSWRT;                /* SEND BACK ALL THE PCBS WE GOT
*                                                            @Z40WPYC*/
         LR    R1,@11                                              0310
*       SPCTSWRT=0;                 /* CLEAR ADDR OF SWAPOUT W.A   0311
*                                                            @Z40WPYC*/
         ST    @12,SPCTSWRT(,SPCTPTR)                              0311
*     END;                          /* END PCB RECHAIN PROC  @Z40WPYC*/
*   ELSE                            /* PCB CHAIN STILL CMPLETE     0313
*                                                            @Z40WPYC*/
*     R1=PTRPCBS;                   /* SET PTR TO FIRST PCB  @Z40WPYC*/
         B     @RC00306                                            0313
@RF00306 L     R1,PTRPCBS-1(,PVTPTR)                               0313
         LA    R1,0(,R1)                                           0313
*   CALL IEAVPCB;                   /* FREE PCBS                     */
@RC00306 L     @15,PVTPCB(,PVTPTR)                                 0314
         BALR  @14,@15                                             0314
*CLEANUP2:                                                         0315
*   RETNCODE=TRYLATER;              /* SET RETURN CODE       @Z40WPYC*/
CLEANUP2 MVC   RETNCODE(4,PVTPTR),@CF00057                         0315
*   SPCTOUT='0'B;                   /* TURN OFF SWAPOUT IN PROGRESS
*                                      FLAG                          */
         NI    SPCTOUT(SPCTPTR),B'10111111'                        0316
*                                                                  0317
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE SALLOC LOCK AND FRR, RESTORE REGISTERS AND RETURN TO     */
*   /* REGION CONTROL TASK                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0317
*RETN:                                                             0317
*   RFY                                                            0317
*    (R5,                                                          0317
*     R14) RSTD;                                                   0317
RETN     DS    0H                                                  0318
*   R5=CALLER13;                    /* SAVE R13 OVER SETLOCK         */
         L     R5,CALLER13(,PVTPTR)                                0318
*   R5->SAVER15=RETNCODE;           /* MOVE RETURN CODE TO SAVE AREA */
         L     @15,RETNCODE(,PVTPTR)                               0319
         ST    @15,SAVER15(,R5)                                    0319
*FREESALL:                                                         0320
*   GENERATE CODE REFS(PSALITA,FLC) SETS(R11,R12,R13,R14);         0320
*                                                                  0320
FREESALL DS    0H                                                  0320
         SETLOCK RELEASE,TYPE=SALLOC,                                 **
               RELATED=(RSM,IEAVSOUT(GETSALL)),DISABLED
*   /*****************************************************************/
*   /*                                                               */
*   /* IF WE ARE IN A BACKOUT, RESTART SRBS                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0321
*   IF R5->SAVER15^=0 THEN                                         0321
         L     @15,SAVER15(,R5)                                    0321
         LTR   @15,@15                                             0321
         BZ    @RF00321                                            0321
*     DO;                                                          0322
*       R0=ASCBASID;                /* GET ASID FOR STATUS           */
         L     @15,ASCBPTR                                         0323
         LH    R0,ASCBASID(,@15)                                   0323
         N     R0,@CF02704                                         0323
*       GEN CODE(SLL R0,16)                                        0324
*       SETS(R0) REFS(R0);          /* MOVE ASID TO LEFT SIDE OF   0324
*                                      REGISTER                      */
         SLL R0,16
*       R1=13;                      /* START SRBS                    */
         LA    R1,13                                               0325
*       R0=R0R1;                   /* COMBINE ASID AND THE 13       */
         OR    R0,R1                                               0326
*       R1=ABIT;                    /* GET A BIT TO INDICATE START   */
         LA    R1,128                                              0327
*       GEN CODE(SLL R1,24)                                        0328
*       SETS(R1) REFS(R1);          /* MOVE BIT INTO HIGH ORDER BIT
*                                      POSITION                      */
         SLL R1,24
*       CALL STATUS;                /* START QUIESSABLE AND NON    0329
*                                      QUIESSABLE SRBS               */
         L     @12,CVTPTR                                          0329
         L     @12,SCVTSPTR(,@12)                                  0329
         L     @15,SCVTSTAT(,@12)                                  0329
         BALR  @14,@15                                             0329
*       IF FRPINCNT=255 THEN        /* IS SWAP OUT BEING ABORTED FOR
*                                      A BAD LSQA FRAME?     @ZA19960*/
         CLI   FRPINCNT(RSMHDPTR),255                              0330
         BNE   @RF00330                                            0330
*         DO;                       /* YES THEN LOCK THE MEMORY IN 0331
*                                      STORAGE               @ZA19960*/
*           R13=WSALRSM;            /* ADDRESS OF RSM LOCAL WORK SAVE
*                                      AREA                  @ZA19960*/
         L     @15,ASCBPTR                                         0332
         L     @15,ASXBPTR(,@15)                                   0332
         L     @15,ASXBSPSA(,@15)                                  0332
         L     R13,WSALRSM(,@15)                                   0332
*           GENERATE NODEFS SETS(R0,R14,R15) REFS(CVTOPTE,CVT,CVTPTR)
*               NOFLOWS;                                           0333
        SYSEVENT DONTSWAP,ENTRY=BRANCH                        @ZA19960
*           FRPINCNT=0;             /* RESET THE PINNED COUNT      0334
*                                                            @ZA19960*/
         MVI   FRPINCNT(RSMHDPTR),X'00'                            0334
*         END;                      /* END OF LOCK MEMORY IN CORE  0335
*                                                            @ZA19960*/
*     END;                                                         0336
@RF00330 DS    0H                                                  0337
*FREEFRR:                                                          0337
*   GENERATE CODE REFS(PSA,PSACSTK,FRRS,FRRSELEN,FRRSCURR,FRRSEMP) SETS
*       (R11,R12);                                                 0337
*                                                                  0337
@RF00321 DS    0H                                                  0337
FREEFRR  DS    0H                                                  0337
         SETFRR D,WRKREGS=(11,12),                                    **
               RELATED=(RSM,IEAVSOUT(GETFRR))
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO THE CALLER OF SWAPOUT                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0338
*   GENERATE NODEFS REFS(R5,R14) NOSETS NOFLOWS;                   0338
          LM   R2,R15,OFFSET16(R5)      RESTORE CALLERS REGISTERS
          BR   R14                      RETURN TO REGION CONTROL TASK
*   RFY                                                            0339
*    (R1,                                                          0339
*     R5) UNRSTD;                                                  0339
*                                                                  0340
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION SCANS THE LOCAL SQA FRAME QUEUE AND BUILDS SPCT  */
*   /* LSQA ENTRIES FOR EACH PAGE IN A FRAME.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*LSQANTRY:                                                         0340
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0340
LSQANTRY DS    0H                                                  0341
*   RESPECIFY                                                      0341
*    (SWAPPTR,                                                     0341
*     R14) RESTRICTED;                                             0341
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV1RTN(,PVTPTR)                                0342
*   RESPECIFY                                                      0343
*    (R14) UNRESTRICTED;                                           0343
*   SWAPPTR=ADDR(SPCTSWAP);         /* GET THE ADDRESS OF THE AREA 0344
*                                      FOR LSQA AND FIX ENTRIES IN 0344
*                                      THE SPCT.                     */
         LA    SWAPPTR,SPCTSWAP(,SPCTPTR)                          0344
*   BEGEXT=SWAPPTR;                 /* SAVE THE PTR TO THE FIRST   0345
*                                      EXTENSION.                    */
         ST    SWAPPTR,BEGEXT(,PVTPTR)                             0345
*   RESPECIFY                                                      0346
*    (ENDPTR) RESTRICTED;                                          0346
*   ENDPTR=ADDR(SPCTSEGS);          /* CALC THE END ADDRESS OF THE 0347
*                                      EXTENSION.                    */
         LA    ENDPTR,SPCTSEGS(,SPCTPTR)                           0347
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* SET UP TO
*                                      OBTAIN THE FIRST LSQA ENTRY.  */
         AL    SWAPPTR,@CF00057                                    0348
*   RESPECIFY                                                      0349
*    (PFTEPTR) RESTRICTED;                                         0349
*   PFTEPTR=PVTPFTP+RSMLSQAF;       /* SET UP POINTER TO FIRST LSQA
*                                      PFTE. EVERY ADDRESS SPACE MUST
*                                      HAVE AT LEAST ONE LSQA FRAME. */
         LH    PFTEPTR,RSMLSQAF(,RSMHDPTR)                         0350
         N     PFTEPTR,@CF02704                                    0350
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0350
*GETPFTE:                                                          0351
*   IF PFTBADPG='1'B THEN           /* TEST FOR A BAD FRAME (SOME  0351
*                                      KIND OF HARDWARE ERROR HAS  0351
*                                      OCCURRED WHEN USING THE     0351
*                                      FRAME).                       */
*                                                                  0351
GETPFTE  TM    PFTBADPG(PFTEPTR),B'00000100'                       0351
         BNO   @RF00351                                            0351
*     /***************************************************************/
*     /*                                                             */
*     /* FRAME IS BAD. THE SWAP OUT IS TERMINATED SO THAT THE ADDRESS*/
*     /* SPACE CAN STILL POSSIBLY RUN RATHER THAN BE ABENDED BECAUSE */
*     /* OF I/O ERRORS ON THE BAD FRAME.                             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0352
*     DO;                           /* RECORD THE STORAGE ERROR    0352
*                                      BEFORE ABORTING THE SWAP    0352
*                                                            @ZA19960*/
*       FRPINCNT=255;               /* SRM RETRIES THE RCT         0353
*                                      QUIESCE/SWAP OUT SEQUENCE SO
*                                      OFTEN THAT A 078 ABEND LOOP 0353
*                                      RESULTS - SET A UNIQUE PINNED
*                                      COUNT SO THAT SOUT WILL ISSUE
*                                      A SYSEVENT DONTSWAP AFTER   0353
*                                      CLEANING UP ITS RESOURCES - 0353
*                                      THIS WILL PIN THE ADDRESS   0353
*                                      SPACE IN CORE UNTIL THE     0353
*                                      OUCBNDS FIELD IS RESET TO ZERO
*                                      BY SYSEVENT INITDET   @ZA19960*/
         MVI   FRPINCNT(RSMHDPTR),X'FF'                            0353
*       IF PFTPREF='0'B THEN        /* FRAME OUTSIDE PREFERRED AREA ?*/
         TM    PFTPREF(PFTEPTR),B'00000100'                        0354
         BNZ   @RF00354                                            0354
*         DO;                       /* YES, RECORD TO DOCUMENT     0355
*                                      POSSIBLE INABILITY TO VARY  0355
*                                      STORAGE OFF                   */
*           R0='20'X;               /* SET STORAGE PINNED FOR STORAGE
*                                      ERROR CODE            @ZA19960*/
         LA    R0,32                                               0356
*           CALL DOABEND;           /* RECORD THE STORAGE PINNING  0357
*                                                            @ZA19960*/
         BAL   @14,DOABEND                                         0357
*           RETURN TO CLEANUP1;     /* EXIT ROUTINE.                 */
         LA    @14,CLEANUP1                                        0358
@EL00002 DS    0H                                                  0358
@EF00002 DS    0H                                                  0358
@ER00002 BR    @14                                                 0358
*         END;                      /* END ERROR RECORDING           */
*     END;                          /* END OF BAD LSQA FRAME       0360
*                                      PROCESSING            @ZA19960*/
@RF00354 DS    0H                                                  0361
*   SPCTLSQA=SPCTLSQA+1;            /* INCREMENT COUNT OF LSQA     0361
*                                      ENTRIES IN THE SPCT.          */
@RF00351 LA    @01,1                                               0361
         AH    @01,SPCTLSQA(,SPCTPTR)                              0361
         STH   @01,SPCTLSQA(,SPCTPTR)                              0361
*   SPCTVBN=PFTVBN;                 /* SET LSQA VBN IN THE SPCT -  0362
*                                      NOTE: ASSUME THAT LOW-ORDER 4
*                                      BITS ARE ALWAYS ZERO. @Z40WPYC*/
         MVC   SPCTVBN(2,SWAPPTR),PFTVBN(PFTEPTR)                  0362
*   SPCTLSQ='1'B;                   /* MARK ENTRY AS LSQA ENTRY.     */
         OI    SPCTLSQ(SWAPPTR),B'01000000'                        0363
*   SWAPPTR=SWAPPTR+LENGTH(SPCTLS); /* GET THE ADDRESS OF THE NEXT 0364
*                                      LSQA ENTRY IN THIS EXTENSION. */
         AL    SWAPPTR,@CF00970                                    0364
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE EXTENSION IS FULL.*/
         CR    SWAPPTR,ENDPTR                                      0365
         BNE   @RF00365                                            0365
*     DO;                           /* THE EXTENSION IS FULL OF LSQA
*                                      ENTRIES. AN ADDITIONAL      0366
*                                      EXTENSION MUST BE OBTAINED.   */
*       RESPECIFY                                                  0367
*        (BEGPTR) RESTRICTED;                                      0367
*       BEGPTR=BEGEXT;              /* GET THE ADDRESS OF THE      0368
*                                      EXTENSION BEGINNING.          */
         L     BEGPTR,BEGEXT(,PVTPTR)                              0368
*       CALL GETEXT;                /* CALL SUBROUTINE TO GET AN   0369
*                                      ADDITIONAL EXTENSION.         */
         BAL   @14,GETEXT                                          0369
*       RESPECIFY                                                  0370
*        (BEGPTR) UNRESTRICTED;                                    0370
*                                                                  0370
*       /*************************************************************/
*       /*                                                           */
*       /* IF CONTROL COMES TO HERE, AN ADDITIONAL EXTENSION WAS     */
*       /* OBTAINED SUCCESSFULLY.                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0371
*     END;                          /* ON RETURN, SWAPPTR POINTS TO
*                                      THE FIRST AVAILABLE SPCT LSQA
*                                      ENTRY                         */
*   IF PFTFQPTR^=0 THEN             /* TEST FOR MORE LSQA FRAMES.    */
@RF00365 LH    @01,PFTFQPTR(,PFTEPTR)                              0372
         N     @01,@CF02704                                        0372
         LTR   @01,@01                                             0372
         BZ    @RF00372                                            0372
*     DO;                           /* ARE MORE PFTES. GET THE     0373
*                                      ADDRESS OF THE NEXT.          */
*       PFTEPTR=PVTPFTP+PFTFQPTR;   /* GET THE ADDRESS OF THE NEXT 0374
*                                      PFTE FROM THE FOREWARD RBN PTR
*                                      OF THE PRESENT PFTE.          */
         AL    @01,PVTPFTP(,PVTPTR)                                0374
         LR    PFTEPTR,@01                                         0374
*       GOTO GETPFTE;               /* ARE MORE LSQA FRAMES. GO    0375
*                                      PROCESS THEM.                 */
         B     GETPFTE                                             0375
*     END;                                                         0376
*                                                                  0376
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM THE LSQA PROCESSOR                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0377
*EXITLSQA:                                                         0377
*   RESPECIFY                                                      0377
*    (R14) RESTRICTED;                                             0377
@RF00372 DS    0H                                                  0377
EXITLSQA DS    0H                                                  0378
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV1RTN(,PVTPTR)                                0378
*   RESPECIFY                                                      0379
*    (R14,                                                         0379
*     SWAPPTR,                                                     0379
*     ENDPTR,                                                      0379
*     PFTEPTR) UNRESTRICTED;                                       0379
*   END LSQANTRY;                                                  0380
         B     @EL00002                                            0380
*                                                                  0381
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION BUILDS FIX ENTRIES IN THE SPCT FOR EACH VBN FIXED*/
*   /* BY A TCB. THE ENTRIES ARE MADE FROM ALL FOES CHAINED OUT OF   */
*   /* ALL TCBS IN THE ADDRESS SPACE.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0381
*FIXENTRY:                                                         0381
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0381
FIXENTRY DS    0H                                                  0382
*   RESPECIFY                                                      0382
*    (TCBPTR,                                                      0382
*     FOEPTR,                                                      0382
*     R14) RESTRICTED;                                             0382
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV1RTN(,PVTPTR)                                0383
*   RESPECIFY                                                      0384
*    (R14) UNRESTRICTED;                                           0384
*   TCBPTR=ASXBFTCB;                /* GET THE ADDRESS OF THE FIRST
*                                      TCB IN THE ADDRESS SPACE.   0385
*                                      SINCE SWAP OUT IS RUNNING   0385
*                                      UNDER THE RCT TCB, THERE MUST
*                                      BE AT LEAST ONE TCB.          */
         L     @12,ASCBPTR                                         0385
         L     @01,ASXBPTR(,@12)                                   0385
         L     TCBPTR,ASXBFTCB(,@01)                               0385
*FIRSTFOE:                                                         0386
*   FOEPTR=TCBFOEA;                 /* GET THE POINTER TO THE FIRST
*                                      FOE FOR THIS TCB.             */
FIRSTFOE L     FOEPTR,TCBFOEA-1(,TCBPTR)                           0386
         LA    FOEPTR,0(,FOEPTR)                                   0386
*   IF FOEPTR=0 THEN                /* TEST FOR NO MORE FOES FOR THIS
*                                      TCB.                          */
         LTR   FOEPTR,FOEPTR                                       0387
         BZ    @RT00387                                            0387
*     GOTO NEXTTCB;                 /* ARE NO MORE FOES FOR THIS TCB.
*                                      GO GET THE NEXT TCB AND     0388
*                                      PROCESS SIMILARLY.            */
*                                                                  0388
*   /*****************************************************************/
*   /*                                                               */
*   /* IF HERE, THERE IS A FOE FOR THE TCB. NOTE THAT IF THE FOE FIX */
*   /* COUNT IS ZERO, THE FOE CANNOT BE FREEMAINED. FREEMAINING THE  */
*   /* FOE MAY CAUSE LSQA TO CONTRACT, PERHAPS WITH THE RESULT THAT A*/
*   /* LSQA PAGE IS FREED. SINCE THE LSQA ENTRIES ARE ALREADY BUILT, */
*   /* THIS WOULD RESULT IN SWAPPING IN A PAGE THAT HAD BEEN FREED.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0389
*TESTFIX:                                                          0389
*   IF FOEFXCT^=0 THEN              /* TEST IF THE FOE HAS A FIX   0389
*                                      COUNT (NON-ZERO).             */
TESTFIX  LH    @12,FOEFXCT(,FOEPTR)                                0389
         LTR   @12,@12                                             0389
         BZ    @RF00389                                            0389
*     DO;                                                          0390
*       RESPECIFY                                                  0391
*        (R1,                                                      0391
*         SWAPPTR) RESTRICTED;                                     0391
*       R1=FOEVINDX;                /* GET THE VBN OF THE FIXED PAGE.*/
         LH    R1,FOEVINDX(,FOEPTR)                                0392
         N     R1,@CF02704                                         0392
*       CALL GETFIX;                /* CALL SUBROUTINE TO GET THE  0393
*                                      SPCT ENTRY FOR THIS FIXED VBN
*                                      OR TO CREATE A NEW SPCT FIX 0393
*                                      ENTRY FOR THE VBN. ON RETURN
*                                      FROM GETFIX, SWAPPTR POINTS TO
*                                      THE FIX ENTRY.                */
         BAL   @14,GETFIX                                          0393
*       SPCTFIXC=SPCTFIXC+FOEFXCT;  /* INCREMENT THE TOTAL FIX COUNT
*                                      FOR THE PAGE BY THE FIX COUNT
*                                      FOR THIS TCB.                 */
         LH    @11,SPCTFIXC(,SWAPPTR)                              0394
         AH    @11,FOEFXCT(,FOEPTR)                                0394
         STH   @11,SPCTFIXC(,SWAPPTR)                              0394
*       RESPECIFY                                                  0395
*        (R1,                                                      0395
*         SWAPPTR) UNRESTRICTED;                                   0395
*     END;                          /* FINISHED PROC FOR A NORMAL  0396
*                                      FOE.                          */
*   FOEPTR=FOEFLINK;                /* GET THE ADDRESS OF THE NEXT 0397
*                                      FOE TO BE PROCESSED.          */
@RF00389 L     @12,FOEFLINK-1(,FOEPTR)                             0397
         LA    @12,0(,@12)                                         0397
         LR    FOEPTR,@12                                          0397
*   IF FOEPTR^=0 THEN               /* TEST IF THERE ARE MORE FOES 0398
*                                      FOR THIS TCB TO BE PROCESSED. */
         LTR   FOEPTR,FOEPTR                                       0398
         BNZ   @RT00398                                            0398
*     GOTO TESTFIX;                 /* ARE MORE FOES. GO PROCESS   0399
*                                      THEM.                         */
*NEXTTCB:                                                          0400
*   TCBPTR=TCBTCB;                  /* GET THE ADDRESS OF THE NEXT 0400
*                                      TCB IN THE ADDRESS SPACE.     */
NEXTTCB  L     TCBPTR,TCBTCB(,TCBPTR)                              0400
*   IF TCBPTR^=0 THEN               /* TEST IF THERE IS ANOTHER TCB
*                                      FOR THE ADDRESS SPACE.        */
         LTR   TCBPTR,TCBPTR                                       0401
         BNZ   @RT00401                                            0401
*     GOTO FIRSTFOE;                /* THERE IS ANOTHER TCB TO DO. GO
*                                      GET THE FIRST FOE FOR THE NEW
*                                      TCB AND PROCESS.              */
*                                                                  0402
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM THE FIX ENTRY PROCESSOR                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0403
*EXITFIX:                                                          0403
*   RESPECIFY                                                      0403
*    (R14) RESTRICTED;                                             0403
EXITFIX  DS    0H                                                  0404
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV1RTN(,PVTPTR)                                0404
*   RESPECIFY                                                      0405
*    (TCBPTR,                                                      0405
*     FOEPTR,                                                      0405
*     R14) UNRESTRICTED;                                           0405
*   END FIXENTRY;                                                  0406
@EL00003 DS    0H                                                  0406
@EF00003 DS    0H                                                  0406
@ER00003 BR    @14                                                 0406
*                                                                  0407
*   /*****************************************************************/
*   /*                                                               */
*   /* PAGING PURGE PROCESSOR. PROCESS THE COMMON I/O ACTIVE QUEUE,  */
*   /* THE LOCAL I/O ACTIVE QUEUE AND THE GFA DEFER QUEUE IN THAT    */
*   /* ORDER.                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0407
*PIOPURGE:                                                         0407
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0407
PIOPURGE DS    0H                                                  0408
*   RFY                                                            0408
*    (R1,                                                          0408
*     R4,                                                          0408
*     R11,                                                         0408
*     R14) RSTD;                                                   0408
*   RFY                                                            0409
*     XPTE BASED(PCBXPTA);                                         0409
*   RFY                                                            0410
*     PGTPTE BASED(PCBPGTA);                                       0410
*   RFY                                                            0411
*     PCBR BASED(PCBRTPA);                                         0411
*   LEV1RTN=R14;                    /* SAVE RETURN ADDRESS           */
         ST    R14,LEV1RTN(,PVTPTR)                                0412
*   RFY                                                            0413
*    (R14) UNRSTD;                                                 0413
*   DOINGCOM='1'B;                  /* DOING COMMON QUEUE, DOING GFA
*                                      QUEUE FLAG AND NOSPCTE FLAG 0414
*                                      ARE ALREADY ZERO              */
         OI    DOINGCOM(PVTPTR),B'01000000'                        0414
*   R11=PVTCIOQL;                   /* ADDRESS OF LAST PCB ON COMMON
*                                      Q                             */
*                                                                  0415
         L     R11,PVTCIOQL(,PVTPTR)                               0415
*   /*****************************************************************/
*   /*                                                               */
*   /* DO EVERY PCB ON THE COMMON I/O ACTIVE Q                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*NEXPCB:                                                           0416
*   DO WHILE(R11^=0);                                              0416
NEXPCB   B     @DE00416                                            0416
@DL00416 DS    0H                                                  0417
*     R4=R11;                       /* HOLD ADDR OF LAST RELATED   0417
*                                      PROCESSED                     */
         LR    R4,R11                                              0417
*     PCBPTR=R11->PCBRLPA;          /* GET ADDRESS OF RELATED        */
*                                                                  0418
         L     PCBPTR,PCBRLPA-1(,R11)                              0418
         LA    PCBPTR,0(,PCBPTR)                                   0418
*     /***************************************************************/
*     /*                                                             */
*     /* DO ALL RELATED PCB'S ON THIS Q'D PCB                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0419
*     DO WHILE(PCBPTR^=0);          /* DO ALL RELATEDS FIRST         */
         B     @DE00419                                            0419
@DL00419 DS    0H                                                  0420
*       IF PCBASCB=PSAAOLD THEN     /* IF THE PCB IS FOR THIS ADDRESS
*                                      SPACE PROCESS IT              */
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0420
         BNE   @RF00420                                            0420
*         DO;                                                      0421
*           LASTRLT=R4;             /* SAVE PTR TO LAST RLT          */
         ST    R4,LASTRLT(,PVTPTR)                                 0422
*           CALL PCBPROC;           /* PROCESS RELATED PCB           */
         BAL   @14,PCBPROC                                         0423
*           IF KEEPPCB='1'B THEN    /* IS PCB TO BE KEPT             */
         TM    KEEPPCB(PVTPTR),B'00010000'                         0424
         BO    @RT00424                                            0424
*             GO TO RLTDEND;        /* DO NOT REMOVE THIS RELATED    */
*           R4=LASTRLT;             /* GET PTR TO LAST RLT           */
         L     R4,LASTRLT(,PVTPTR)                                 0426
*           R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM     0427
*                                      RELATED CHAIN                 */
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0427
*           R0=PCBFREQN;            /* PCB TO FREE Q                 */
         LA    R0,16                                               0428
*           R1=PCBPTR;              /* ADDRESS OF PCB                */
         LR    R1,PCBPTR                                           0429
*           CALL IEAVPCB;           /* GO FREE IT                    */
         L     @15,PVTPCB(,PVTPTR)                                 0430
         BALR  @14,@15                                             0430
*           GO TO RLTDE2;           /* GO SET TO NEXT RELATED        */
         B     RLTDE2                                              0431
*         END;                                                     0432
*RLTDEND:                                                          0433
*       R4=PCBPTR;                  /* UPDATE POINTER TO LAST RELATED
*                                      PCB PROCESSED                 */
@RF00420 DS    0H                                                  0433
RLTDEND  LR    R4,PCBPTR                                           0433
*RLTDE2:                                                           0434
*       PCBPTR=R4->PCBRLPA;         /* SET PCBPTR TO CHECK FOR     0434
*                                      ANOTHER RELATED PCB           */
RLTDE2   L     PCBPTR,PCBRLPA-1(,R4)                               0434
         LA    PCBPTR,0(,PCBPTR)                                   0434
*     END;                                                         0435
@DE00419 LTR   PCBPTR,PCBPTR                                       0435
         BNZ   @DL00419                                            0435
*                                                                  0436
*     /***************************************************************/
*     /*                                                             */
*     /* ALL RELATEDS HAVE BEEN PROCESSED, NOW PROCESS THE Q'D COMMON*/
*     /* AREA PCB                                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0436
*     PCBPTR=R11;                   /* COPY POINTER TO PROCESS Q'D   */
         LR    PCBPTR,R11                                          0436
*     R11=PCBBQPA;                  /* SET TO NEXT PCB ON Q          */
         L     R11,PCBBQPA(,PCBPTR)                                0437
*     IF PCBASCB=PSAAOLD THEN       /* IS THE QUEUED PCB FOR THIS  0438
*                                      ADDRESS SPACE                 */
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0438
         BNE   @RF00438                                            0438
*       DO;                                                        0439
*                                                                  0439
*         /***********************************************************/
*         /*                                                         */
*         /* IS Q'D PCB A PAGE OUT PCB                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0440
*         IF PCBIOI='1'B THEN                                      0440
         TM    PCBIOI(PCBPTR),B'00000010'                          0440
         BNO   @RF00440                                            0440
*           IF PCBSUPRS='0'B THEN   /* WAS PAGE OUT RECLAIMED BY GFA */
         TM    PCBSUPRS(PCBPTR),B'00001000'                        0441
         BNZ   @RF00441                                            0441
*             PCBFREAL='1'B;        /* IF RBN CAN BE USED MAKE SURE
*                                      FRAME IS FREED WHEN I/O     0442
*                                      COMPLETES                     */
         OI    PCBFREAL(PCBPTR),B'10000000'                        0442
*           ELSE                                                   0443
*             ;                     /* WAS GFA RECLAIM               */
@RF00441 DS    0H                                                  0444
*         ELSE                      /* PCB IS A PAGE IN PCB          */
*           DO;                                                    0444
         B     @RC00440                                            0444
@RF00440 DS    0H                                                  0445
*             CALL PCBPROC;         /* PROCESS Q'D PAGE IN PCB       */
*                                                                  0445
         BAL   @14,PCBPROC                                         0445
*             /*******************************************************/
*             /*                                                     */
*             /* ARE THERE ANY RELATEDS LEFT ON RLTD CHAIN           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0446
*             IF PCBRLPA^=0 THEN                                   0446
         L     @12,PCBRLPA-1(,PCBPTR)                              0446
         LA    @12,0(,@12)                                         0446
         LTR   @12,@12                                             0446
         BZ    @RF00446                                            0446
*               DO;                                                0447
*                                                                  0447
*                 /***************************************************/
*                 /*                                                 */
*                 /* THERE ARE RLTDS LEFT, IS I/O COMP               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0448
*                 IF PCBIOCMP='1'B THEN                            0448
*                                                                  0448
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0448
         BNO   @RF00448                                            0448
*                   /*************************************************/
*                   /*                                               */
*                   /* I/O IS COMPLETE, FREE Q'D PCB                 */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0449
*                   DO;                                            0449
*                     PCBVBN=0;     /* CLEAR VBN TO PREVENT TWO ON Q
*                                      WITH SAME VBN AT SAME TIME    */
         SLR   @06,@06                                             0450
         STH   @06,PCBVBN(,PCBPTR)                                 0450
*                     R1=PCBRLPA;                                  0451
         LR    R1,@12                                              0451
*                     R0=PCBCIOQN;  /* RELATED CHAIN TO COMMON Q     */
         LA    R0,32                                               0452
*                     CALL IEAVPCB; /* ENQ                           */
         L     @15,PVTPCB(,PVTPTR)                                 0453
         BALR  @14,@15                                             0453
*                     CALL IEAVOPBR;/* SCHED IOCP FOR FIRST RLTD     */
         L     @15,PVTPOPBR(,PVTPTR)                               0454
         BALR  @14,@15                                             0454
*                     R0=PCBFREQN;                                 0455
         LA    R0,16                                               0455
*                     R1=PCBPTR;    /* FREE Q'D                      */
         LR    R1,PCBPTR                                           0456
*                     CALL IEAVPCB; /* FREE QUEUED                   */
         L     @15,PVTPCB(,PVTPTR)                                 0457
         BALR  @14,@15                                             0457
*                   END;                                           0458
*                 ELSE                                             0459
*                   ;                                              0459
@RF00448 DS    0H                                                  0460
*               END;                                               0460
*                                                                  0460
*             /*******************************************************/
*             /*                                                     */
*             /* NO RELATEDS LEFT, PROCESS Q'D                       */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0461
*             ELSE                                                 0461
*               DO;                 /* THERE ARE NO RELATEDS LEFT    */
         B     @RC00446                                            0461
@RF00446 DS    0H                                                  0462
*                 IF PCBIOERR='1'B THEN/* IS THIS AN I/O COMP AND I/O
*                                      ERR PCB                       */
         TM    PCBIOERR(PCBPTR),B'00100000'                        0462
         BNO   @RF00462                                            0462
*                   DO;                                            0463
*                     RFY                                          0464
*                      (R5) RSTD;                                  0464
*                     R5=PVTPFTP+PCBRBN;                           0465
         LH    R5,PCBRBN(,PCBPTR)                                  0465
         N     R5,@CF02704                                         0465
         AL    R5,PVTPFTP(,PVTPTR)                                 0465
*                     R5->PFTPCBSI='0'B;/* PCB DEFINED OFF           */
         NI    PFTPCBSI(R5),B'11110111'                            0466
*                     IF R5->PFTDFRLS='1'B THEN/* IS IT DEFERED    0467
*                                      RELEASE                       */
         TM    PFTDFRLS(R5),B'10000000'                            0467
         BNO   @RF00467                                            0467
*                       DO;                                        0468
*                         IF R5->PFTFXCT^=0 THEN                   0469
         LH    @12,PFTFXCT(,R5)                                    0469
         LTR   @12,@12                                             0469
         BZ    @RF00469                                            0469
*                           DO;                                    0470
*                             IF PCBVBN>=PVTLCSA THEN              0471
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0471
         BL    @RF00471                                            0471
*                               PVTCOMFX=PVTCOMFX-1;/* DECREMENT   0472
*                                      GLOBAL COMMON AREA FIX COUNT
*                                                            @YA01572*/
         LH    @12,PVTCOMFX(,PVTPTR)                               0472
         BCTR  @12,0                                               0472
         STH   @12,PVTCOMFX(,PVTPTR)                               0472
*                             ELSE                                 0473
*                               RSMCNTFX=RSMCNTFX-1;/* DECREMENT   0473
*                                      COUNT FOR ADDR SPACE  @YA01572*/
         B     @RC00471                                            0473
@RF00471 LH    @12,RSMCNTFX(,RSMHDPTR)                             0473
         BCTR  @12,0                                               0473
         STH   @12,RSMCNTFX(,RSMHDPTR)                             0473
*                             PVTCNTFX=PVTCNTFX-1;/* DECREMENT SYSTEM
*                                      COUNT                 @YA01572*/
@RC00471 LH    @12,PVTCNTFX(,PVTPTR)                               0474
         BCTR  @12,0                                               0474
         STH   @12,PVTCNTFX(,PVTPTR)                               0474
*                           END;                                   0475
*                         R5->PFTFXCT=0;/* FIX CT MUST BE ZEROED   0476
*                                      SINCE ALL PCB'S HAVE GONE AWAY*/
@RF00469 SLR   @12,@12                                             0476
         STH   @12,PFTFXCT(,R5)                                    0476
*                         R1=PCBVBN*256;/* MAKE VBN AN ADDR TO BE  0477
*                                      RELEASED                      */
         LH    R1,PCBVBN(,PCBPTR)                                  0477
         N     R1,@CF02704                                         0477
         SLA   R1,8                                                0477
*                         CALL IEAVRELF;/* CALL DEFERED RELEASE      */
         L     @15,PVTPRELF(,PVTPTR)                               0478
         BALR  @14,@15                                             0478
*                         RFY                                      0479
*                          (R15) RSTD;                             0479
*                         RCACSECT=RCACSPOT;/* RESET CSECT ID        */
         L     @14,RCAPTR(,PVTPTR)                                 0480
         MVI   RCACSECT(@14),X'1A'                                 0480
*                         IF R15^=0 THEN/* TEST FOR SUCCESSFUL     0481
*                                      COMPLETION                    */
         LTR   R15,R15                                             0481
         BZ    @RF00481                                            0481
*                           DO;                                    0482
*                             R0='0F'X;/* RECORD ERROR IN COMPLETION
*                                      OF DEFERED RELEASE PROCESSING */
         LA    R0,15                                               0483
*                             CALL DOABEND;/* RECORD THE ERROR.      */
         BAL   @14,DOABEND                                         0484
*                           END;                                   0485
*                         RESPECIFY                                0486
*                          (R5,                                    0486
*                           R15) UNRESTRICTED;                     0486
@RF00481 DS    0H                                                  0487
*                       END;                                       0487
*                     ELSE                                         0488
*                       ;           /* NOT DEFERED RELEASE           */
*                                                                  0488
@RF00467 DS    0H                                                  0489
*                     /***********************************************/
*                     /*                                             */
*                     /* FRAME CAN BE FREED                          */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0489
*                     R0=PCBRBN;                                   0489
         LH    R0,PCBRBN(,PCBPTR)                                  0489
         N     R0,@CF02704                                         0489
*                     R0=R0CONSPFTE;/* FRAME TO FRONT OF AFQ        */
         O     R0,@CF02502                                         0490
*                     CALL IEAVPFTE;/* FREE FRAME                    */
         L     @15,PVTPFTE(,PVTPTR)                                0491
         BALR  @14,@15                                             0491
*                     R0=PCBFREQN;  /* GET THE FREE QUEUE ID.        */
         LA    R0,16                                               0492
*                     R1=PCBPTR;    /* GET THE ADDR OF THE PCB TO BE
*                                      FREED.                        */
         LR    R1,PCBPTR                                           0493
*                     CALL IEAVPCB; /* FREE THE PCB.                 */
         L     @15,PVTPCB(,PVTPTR)                                 0494
         BALR  @14,@15                                             0494
*                   END;            /* END OF I/O ERR PROCESS        */
*                 ELSE              /* THERE ARE NO RELATEDS AND   0496
*                                      THERE WAS NO I/O ERROR. IF I/O
*                                      COMPLETED NORMALLY FREE THE 0496
*                                      PCB.                          */
*                   DO;                                            0496
         B     @RC00462                                            0496
@RF00462 DS    0H                                                  0497
*                     IF PCBIOCMP='1'B THEN/* IS I/O COMPLETE        */
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0497
         BNO   @RF00497                                            0497
*                       DO;                                        0498
*                         R0=PCBFREQN;                             0499
         LA    R0,16                                               0499
*                         R1=PCBPTR;/* PCB TO BE FREED               */
         LR    R1,PCBPTR                                           0500
*                         CALL IEAVPCB;/* FREE Q'D PCB FRAME WAS   0501
*                                      VALIDATED                     */
         L     @15,PVTPCB(,PVTPTR)                                 0501
         BALR  @14,@15                                             0501
*                       END;                                       0502
*                     ELSE          /* I/O IS NOT COMPLETE, TURN ON
*                                      FREAL FLAG UNLESS PCB WAS A 0503
*                                      ZERO TCB FIX AND FIX IS TO  0503
*                                      COMPLETE NORMALLY.            */
*                       IF KEEPPCB='0'B THEN/* DO WE KEEP PCB        */
         B     @RC00497                                            0503
@RF00497 TM    KEEPPCB(PVTPTR),B'00010000'                         0503
         BNZ   @RF00503                                            0503
*                         PCBFREAL='1'B;                           0504
         OI    PCBFREAL(PCBPTR),B'10000000'                        0504
*                   END;                                           0505
@RF00503 DS    0H                                                  0505
@RC00497 DS    0H                                                  0506
*               END;                                               0506
@RC00462 DS    0H                                                  0507
*           END;                    /* END OF Q'D PCB IS PAGE IN PCB */
@RC00446 DS    0H                                                  0508
*       END;                                                       0508
@RC00440 DS    0H                                                  0509
*   END;                            /* END OF COMMON Q LOOP          */
@RF00438 DS    0H                                                  0509
@DE00416 LTR   R11,R11                                             0509
         BNZ   @DL00416                                            0509
*                                                                  0510
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS LOCAL I/O ACTIVE QUEUE                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0510
*   R11=RSMLIOQL;                   /* SET TO LAST PCB ON LOCAL I/O
*                                      ACTIVE Q                      */
         L     R11,RSMLIOQL(,RSMHDPTR)                             0510
*   DOINGCOM='0'B;                  /* NO LONGER DOING COMMON Q      */
         NI    DOINGCOM(PVTPTR),B'10111111'                        0511
*   RSMCPNU='0'B;                   /* CLEAR FLAG TO SCHEDULE IOCP 0512
*                                      WITH THE LOCAL LOCK   @Z30GNYD*/
*   RSMCPNC='0'B;                   /* CLEAR FLAG TO SCHEDULE IOCP 0513
*                                      WITHOUT THE LOCAL LOCK      0513
*                                                            @Z30GNYD*/
         NI    RSMCPNU(RSMHDPTR),B'11100111'                       0513
*   DO WHILE(R11^=0);               /* DO FOR EVERY PCB ON LOCAL Q   */
         B     @DE00514                                            0514
@DL00514 DS    0H                                                  0515
*     PCBPTR=R11;                   /* SET PCBPTR TO PROCESS THE   0515
*                                      QUEUED PCB                    */
*                                                                  0515
         LR    PCBPTR,R11                                          0515
*     /***************************************************************/
*     /*                                                             */
*     /* IF IT IS A VIO FRAME ON THE WAY IN DO NOT SET BIT MASK AS A */
*     /* COPY WILL NOT BE AVAILABLE UNDER MEMORY LPID. ALSO IF THE   */
*     /* PAGE WAS ON ITS WAY OUT DO NOT SET A BIT IN THE BIT MASK.   */
*     /* THE XPT ADDRESS MAY NOT BE VALID FOR A RELEASED (FREEMAINED)*/
*     /* PAGE SO THE ORDER OF TESTS IS IMPORTANT                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0516
*     IF(PCBIOI='1'B&PCBRLPA=0)(PCBVBN^=0&XPTVIO='1'B&XPTVIOLP='1'B)
*       THEN                        /*                       @Z40WPYC*/
         TM    PCBIOI(PCBPTR),B'00000010'                          0516
         BNO   @GL00002                                            0516
         L     @12,PCBRLPA-1(,PCBPTR)                              0516
         LA    @12,0(,@12)                                         0516
         LTR   @12,@12                                             0516
         BZ    @RT00516                                            0516
@GL00002 LH    @12,PCBVBN(,PCBPTR)                                 0516
         N     @12,@CF02704                                        0516
         LTR   @12,@12                                             0516
         BZ    @RF00516                                            0516
         L     @12,PCBXPTA-1(,PCBPTR)                              0516
         TM    XPTVIO(@12),B'10001000'                             0516
         BNO   @RF00516                                            0516
@RT00516 DS    0H                                                  0517
*       MASKFLG='0'B;               /* PREVENTS BIT MASK FROM BEING
*                                      SET                           */
         NI    MASKFLG(PVTPTR),B'11011111'                         0517
*     ELSE                                                         0518
*       MASKFLG='1'B;               /* ASSUME BIT MASK SHOULD BE SET,
*                                      A FIX WILL CAUSE MASKFLG TO BE
*                                      SET TO ZERO                   */
*                                                                  0518
         B     @RC00516                                            0518
@RF00516 OI    MASKFLG(PVTPTR),B'00100000'                         0518
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS THE QUEUED PCB, THEN PROCESS EACH RELATED. IS THE   */
*     /* PCB A PAGE IN OR A PAGE OUT                                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0519
*     IF PCBIOI='0'B THEN                                          0519
@RC00516 TM    PCBIOI(PCBPTR),B'00000010'                          0519
         BNZ   @RF00519                                            0519
*       DO;                                                        0520
*         CALL PCBPROC;             /* PROCESS QUEUED PCB            */
*                                                                  0521
         BAL   @14,PCBPROC                                         0521
*         /***********************************************************/
*         /*                                                         */
*         /* IF PCB WAS A ZERO TCB FIX AND A FIX ENTRY COULD NOT BE  */
*         /* MADE IN THE SPCT, THE PCB SHOULD NOT BE MARKED FREAL.   */
*         /* THUS THE ZERO TCB FIX PCB WILL BE ALLOWED TO COMPLETE   */
*         /* NORMALLY EVEN THOUGH THE FRAME WILL NOT BE VALIDATED    */
*         /* UNTIL THE ADDRESS SPACE IS SWAPPED BACK IN              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0522
*         IF KEEPPCB='0'B THEN                                     0522
         TM    KEEPPCB(PVTPTR),B'00010000'                         0522
         BNZ   @RF00522                                            0522
*           DO;                                                    0523
*             PCBFREAL='1'B;        /* FREAL IS SET ON SO FRAME WILL
*                                      BE FREED WHEN I/0 DOES      0524
*                                      COMPLETE. IF I/O DID ALREADY
*                                      COMPLETE SUCCESSFULLY THE   0524
*                                      FRAME WAS VALIDATED           */
         OI    PCBFREAL(PCBPTR),B'10000000'                        0524
*             IF PCBIOCMP='0'B THEN /* IF FRAME IN PRIVATE AREA HAS
*                                      INPUT I/O IN PROGRESS (PAGE 0525
*                                      FAULT, FIX, OR LOAD), IT WILL
*                                      NOT BE PAGED OUT BY IEAVSOUT
*                                      AND WILL STILL BE REFLECTED IN
*                                      ASCBFMCT AT THE TIME PVTSPFR
*                                      IS INCREMENTED IN THE IEAVSOUT
*                                      MAINLINE. THEREFORE, INCREMENT
*                                      PVTSPFR HERE TO INDICATE FRAME
*                                      WAS FREED AT SWAP OUT TIME  0525
*                                                            @VS07609*/
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0525
         BNZ   @RF00525                                            0525
*               PVTSPFR=PVTSPFR+1;  /* INCR FRAMES FREED COUNT     0526
*                                                            @VS07609*/
         LA    @12,1                                               0526
         LH    @06,PVTSPFR(,PVTPTR)                                0526
         N     @06,@CF02704                                        0526
         ALR   @12,@06                                             0526
         STH   @12,PVTSPFR(,PVTPTR)                                0526
*           END;                                                   0527
*       END;                                                       0528
*     ELSE                                                         0529
*       IF PCBSUPRS='0'B THEN       /* IF RBN CAN BE USED MAKE SURE
*                                      FRAME IS FREED AFTER PAGE OUT
*                                      COMPLETES                     */
         B     @RC00519                                            0529
@RF00519 TM    PCBSUPRS(PCBPTR),B'00001000'                        0529
         BNZ   @RF00529                                            0529
*         PCBFREAL='1'B;            /* SET TO FREE FRAME WHEN I/O  0530
*                                      COMPLETES                     */
         OI    PCBFREAL(PCBPTR),B'10000000'                        0530
*     R4=R11;                       /* SET ADDRESS OF LAST PROCESSED
*                                      PCB                           */
@RF00529 DS    0H                                                  0531
@RC00519 LR    R4,R11                                              0531
*     PCBPTR=R11->PCBRLPA;          /* GET ADDRESS OF FIRST RELATED  */
         L     PCBPTR,PCBRLPA-1(,R11)                              0532
         LA    PCBPTR,0(,PCBPTR)                                   0532
*     DO WHILE(PCBPTR^=0);                                         0533
         B     @DE00533                                            0533
@DL00533 DS    0H                                                  0534
*       LASTRLT=R4;                 /* SAVE R4 OVER CALL             */
         ST    R4,LASTRLT(,PVTPTR)                                 0534
*       CALL PCBPROC;               /* PROCESS RELATED PCB           */
         BAL   @14,PCBPROC                                         0535
*       IF KEEPPCB='1'B THEN        /* DO WE KEEP PCB                */
         TM    KEEPPCB(PVTPTR),B'00010000'                         0536
         BO    @RT00536                                            0536
*         GO TO SAVL1;              /* DO NOT FREE RELATED           */
*       R4=LASTRLT;                 /* RESTORE R4                    */
         L     R4,LASTRLT(,PVTPTR)                                 0538
*       R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM CHAIN     */
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0539
*       R0=PCBFREQN;                /* PCB TO FREE Q                 */
         LA    R0,16                                               0540
*       R1=PCBPTR;                  /* ADDRESS OF PCB TO FREE        */
         LR    R1,PCBPTR                                           0541
*       CALL IEAVPCB;               /* FREE IT                       */
         L     @15,PVTPCB(,PVTPTR)                                 0542
         BALR  @14,@15                                             0542
*       GO TO SAVL2;                /* SET TO NEXT RELATED           */
         B     SAVL2                                               0543
*SAVL1:                                                            0544
*       R4=PCBPTR;                  /* UPDATE LAST PROCESSED PTR     */
SAVL1    LR    R4,PCBPTR                                           0544
*SAVL2:                                                            0545
*       PCBPTR=R4->PCBRLPA;         /* UPDATE PCB TO BE PROCESSED PTR*/
SAVL2    L     PCBPTR,PCBRLPA-1(,R4)                               0545
         LA    PCBPTR,0(,PCBPTR)                                   0545
*     END;                                                         0546
@DE00533 LTR   PCBPTR,PCBPTR                                       0546
         BNZ   @DL00533                                            0546
*     PCBPTR=R11;                   /* SET PTR TO LOOK AT QUEUED PCB */
         LR    PCBPTR,R11                                          0547
*     R11=PCBBQPA;                  /* UPDATE PTR TO NEXT PCB ON   0548
*                                      LOCAL Q                       */
*                                                                  0548
         L     R11,PCBBQPA(,PCBPTR)                                0548
*     /***************************************************************/
*     /*                                                             */
*     /* IS A BIT MASK ENTRY TO BE MADE                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0549
*     IF MASKFLG='1'B&PCBVBN^=0 THEN                               0549
         TM    MASKFLG(PVTPTR),B'00100000'                         0549
         BNO   @RF00549                                            0549
         LH    @12,PCBVBN(,PCBPTR)                                 0549
         N     @12,@CF02704                                        0549
         LTR   @12,@12                                             0549
         BZ    @RF00549                                            0549
*       DO;                                                        0550
*         R1=PCBVBN;                /* VBN FOR SUBROUTINE            */
         LR    R1,@12                                              0551
*         CALL SETMASK;             /* SET BIT MASK                  */
         BAL   @14,SETMASK                                         0552
*         PGTPVM='1'B;              /* INVALIDATE PAGE       @Z40WPYC*/
         L     @12,PCBPGTA-1(,PCBPTR)                              0553
         OI    PGTPVM(@12),B'00001000'                             0553
*       END;                                                       0554
*                                                                  0554
*     /***************************************************************/
*     /*                                                             */
*     /* IF I/O IS COMPLETE FREE THE QUEUED PCB. ALL RELATED PCBS    */
*     /* WILL HAVE BEEN FREED IF I/O IS COMPLETE. I/O WILL NEVER BE  */
*     /* COMPLETE FOR A PAGE OUT PCB.                                */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0555
*     IF PCBIOCMP='1'B THEN                                        0555
@RF00549 TM    PCBIOCMP(PCBPTR),B'00000001'                        0555
         BNO   @RF00555                                            0555
*       DO;                                                        0556
*                                                                  0556
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE VBN IS ZERO THERE IS NO FRAME ASSOCIATED WITH    */
*         /* THIS PCB                                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0557
*         IF PCBVBN^=0 THEN                                        0557
         LH    @12,PCBVBN(,PCBPTR)                                 0557
         N     @12,@CF02704                                        0557
         LTR   @12,@12                                             0557
         BZ    @RF00557                                            0557
*           DO;                                                    0558
*             R4=PVTPFTP+PCBRBN;    /* GET ADDRESS OF PFTE           */
         LH    R4,PCBRBN(,PCBPTR)                                  0559
         N     R4,@CF02704                                         0559
         AL    R4,PVTPFTP(,PVTPTR)                                 0559
*             R4->PFTPCBSI='0'B;    /* PCB DEFINED OFF               */
*                                                                  0560
         NI    PFTPCBSI(R4),B'11110111'                            0560
*             /*******************************************************/
*             /*                                                     */
*             /* IF THE FRAME IS NOT VALID, FREE IT                  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0561
*             RFY                                                  0561
*              (R5) RSTD;                                          0561
*             R5=PCBVBN*256;        /* CHANGE VBN TO VSA             */
         SLA   @12,8                                               0562
         LR    R5,@12                                              0562
*             GEN CODE(LRA R1,0(R5))                               0563
*             SETS(R1) REFS(R1,R5); /* IF FRAME VALID                */
         LRA R1,0(R5)
*             BC(8,FREQD);          /* BRANCH IF VALID               */
         BC    8,FREQD                                             0564
*             RFY                                                  0565
*              (R5) UNRSTD;                                        0565
*             R0=PCBRBN;                                           0566
         LH    R0,PCBRBN(,PCBPTR)                                  0566
         N     R0,@CF02704                                         0566
*             IF MASKFLG='0'B THEN  /* IF NO BIT MASK ENTRY WAS MADE
*                                      THEN MOVE PFTE TO FRONT OF  0567
*                                      AFQ.                  @Z40WPYC*/
         TM    MASKFLG(PVTPTR),B'00100000'                         0567
         BNZ   @RF00567                                            0567
*               R0=R0CONSPFTE;     /* PFTE TO FRONT OF AFQ          */
         O     R0,@CF02502                                         0568
*             ELSE                                                 0569
*               ;                   /* BIT MASK ENTRY WAS MADE, FRAME
*                                      TO END OF AFQ.THIS WILL PERMIT
*                                      A GREATER CHANCE THAT THE   0569
*                                      FRAME WILL BE RECLAIMED BY GFA
*                                      DURING SWAPIN.        @Z40WPYC*/
@RF00567 DS    0H                                                  0570
*             CALL IEAVPFTE;        /* FREE FRAME                    */
         L     @15,PVTPFTE(,PVTPTR)                                0570
         BALR  @14,@15                                             0570
*           END;                                                   0571
*FREQD:                                                            0572
*         R0=PCBFREQN;              /* PCB TO FREE Q                 */
@RF00557 DS    0H                                                  0572
FREQD    LA    R0,16                                               0572
*         R1=PCBPTR;                /* PCB TO BE FREED               */
         LR    R1,PCBPTR                                           0573
*         CALL IEAVPCB;             /* FREE PCB                      */
         L     @15,PVTPCB(,PVTPTR)                                 0574
         BALR  @14,@15                                             0574
*       END;                                                       0575
*     ELSE                          /* I/O IS NOT COMPLETE. MUST ZERO
*                                      THE VBN IN THE PCB SO THAT THE
*                                      PCB WILL NOT BE PROCESSED BY
*                                      SOMEONE ELSE. IF OUTPUT PCB OR
*                                      A FIX PCB (QUEUED OR RELATED)
*                                      COULD NOT BE PUT IN THE SPCT,
*                                      DO NOT ZERO THE VBN SO THAT 0576
*                                      THESE PCBS CAN LATER BE     0576
*                                      PROCESSED CORRECTLY.  @YM07609*/
*       IF PCBIOI='0'B&PCBRLPA=0&PCBFXC=0 THEN/* TEST TO ZERO VBN  0576
*                                                            @YM07609*/
         B     @RC00555                                            0576
@RF00555 TM    PCBIOI(PCBPTR),B'00000010'                          0576
         BNZ   @RF00576                                            0576
         L     @12,PCBRLPA-1(,PCBPTR)                              0576
         LA    @12,0(,@12)                                         0576
         LTR   @12,@12                                             0576
         BNZ   @RF00576                                            0576
         CLI   PCBFXC(PCBPTR),0                                    0576
         BNE   @RF00576                                            0576
*         PCBVBN=0;                 /* ZERO THE VBN          @YM07609*/
         SLR   @12,@12                                             0577
         STH   @12,PCBVBN(,PCBPTR)                                 0577
*   END;                            /* END OF Q'D PCB LOOP           */
@RF00576 DS    0H                                                  0578
@RC00555 DS    0H                                                  0578
@DE00514 LTR   R11,R11                                             0578
         BNZ   @DL00514                                            0578
*                                                                  0579
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS GFA DEFER Q                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0579
*   DOINGGFA='1'B;                  /* SET FLAG TO INDICATE GFA Q IS
*                                      BEING PROCESSED               */
         OI    DOINGGFA(PVTPTR),B'10000000'                        0579
*   R11=PVTGFADL;                   /* GET ADDRESS OF LAST PCB ON GFA
*                                      DEFER Q                       */
         L     R11,PVTGFADL(,PVTPTR)                               0580
*   DO WHILE(R11^=0);               /* DO FOR EACH PCB ON DEFER Q    */
         B     @DE00581                                            0581
@DL00581 DS    0H                                                  0582
*     NOSPCTE='0'B;                 /* INITALIZE FLAG FOR THIS PCB 0582
*                                                            @YM02790*/
         NI    NOSPCTE(PVTPTR),B'11111011'                         0582
*     PCBPTR=R11;                   /* INITIALIZE PCBPTR FOR SCAN  0583
*                                                            @YM02389*/
*                                                                  0583
         LR    PCBPTR,R11                                          0583
*     /***************************************************************/
*     /*                                                             */
*     /* DETERMINE IF THERE IS AN ECB OUT OF STORAGE FOR ANY REQUEST */
*     /* ON THIS VBN IN THE ADDRESS SPACE TO BE SWAPPED OUT. ALSO    */
*     /* DETERMINE IF THERE IS A FIX AS A FIRST REFERENCE TO THIS    */
*     /* PAGE                                                        */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0584
*     DO WHILE(PCBPTR^=0);          /* LOOK AT QUEUED AND RELATEDS 0584
*                                                            @YM02790*/
         B     @DE00584                                            0584
@DL00584 DS    0H                                                  0585
*       IF PCBASCB=PSAAOLD&PCBROOT='1'B THEN/* PCB IS FOR THIS     0585
*                                      ADDRESS SPACE AND HAS A ROOT,
*                                      IS THE ECB IN STORAGE @YM02790*/
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0585
         BNE   @RF00585                                            0585
         TM    PCBROOT(PCBPTR),B'00000100'                         0585
         BNO   @RF00585                                            0585
*         DO;                       /*                       @YM02790*/
*           IF XPTXAV='0'B THEN     /* IF THERE IS NO AUX AS YET   0587
*                                      ASSIGNED TO THE PAGE, THIS IS
*                                      THE FIRST REFERENCE TO IT   0587
*                                                            @YM02461*/
         L     @12,PCBXPTA-1(,PCBPTR)                              0587
         TM    XPTXAV(@12),B'01000000'                             0587
         BZ    @RT00587                                            0587
*             GO TO NOTINFET;       /* GO REMOVE FIX ENTRY FROM SPCT
*                                                            @YM02461*/
*           R1=PCBRECB;             /* GET ECB ADDRESS       @YM02790*/
         L     @12,PCBRTPA-1(,PCBPTR)                              0589
         L     R1,PCBRECB(,@12)                                    0589
*           GEN CODE REFS(R1) SETS(R1) NOFLOWS NODEFS;             0590
         LRA R1,0(R1)
*           BC(7,NOTINFET);         /* BRANCH IF ECB IS NOT IN     0591
*                                      STORAGE               @YM02790*/
         BC    7,NOTINFET                                          0591
*         END;                                                     0592
*       PCBPTR=PCBRLPA;             /* SET TO NEXT PCB ON RELATED  0593
*                                      CHAIN                 @YM02790*/
@RF00585 L     @12,PCBRLPA-1(,PCBPTR)                              0593
         LA    @12,0(,@12)                                         0593
         LR    PCBPTR,@12                                          0593
*     END;                                                         0594
@DE00584 LTR   PCBPTR,PCBPTR                                       0594
         BNZ   @DL00584                                            0594
*     GO TO NORMGFA;                /* NO OUT OF STORAGE ECBS      0595
*                                                            @YM02790*/
*                                                                  0595
         B     NORMGFA                                             0595
*     /***************************************************************/
*     /*                                                             */
*     /* WE FOUND ONE ECB OUT OF STORAGE, OR THIS IS A FIRST         */
*     /* REFERENCE CASE. NO ENTRY IS TO BE MADE IN THE SPCT FOR THIS */
*     /* VBN. THE PCB IS TO BE LEFT ON THE GFA DEFER QUEUE BECAUSE   */
*     /* THE ECB CAN NOT BE POSTED. IF THIS IS A FIRST REFERENCE CASE*/
*     /* THE PAGE CAN NOT BE BROUGHT IN AT SWAP IN TIME.             */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0596
*NOTINFET:                                                         0596
*     NOSPCTE='1'B;                 /* SET FLAG FOR PCBPROC  @YM02790*/
NOTINFET OI    NOSPCTE(PVTPTR),B'00000100'                         0596
*     PCBPTR=R11;                   /* SET POINTER                   */
         LR    PCBPTR,R11                                          0597
*     DO WHILE(PCBPTR^=0);          /* DO FOR EVERY PCB ON RELATED 0598
*                                      CHAIN                         */
         B     @DE00598                                            0598
@DL00598 DS    0H                                                  0599
*       IF PCBASCB=PSAAOLD&PCBROOT='1'B&PCBFXC^=0&PCBRTCBA^=0 THEN 0599
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0599
         BNE   @RF00599                                            0599
         TM    PCBROOT(PCBPTR),B'00000100'                         0599
         BNO   @RF00599                                            0599
         CLI   PCBFXC(PCBPTR),0                                    0599
         BE    @RF00599                                            0599
         L     @12,PCBRTPA-1(,PCBPTR)                              0599
         L     @12,PCBRTCBA-1(,@12)                                0599
         LA    @12,0(,@12)                                         0599
         LTR   @12,@12                                             0599
         BZ    @RF00599                                            0599
*         CALL PCBPROC;             /* REMOVE FIX FROM SPCT          */
         BAL   @14,PCBPROC                                         0600
*       PCBPTR=PCBRLPA;             /* UPDATE POINTER                */
@RF00599 L     @12,PCBRLPA-1(,PCBPTR)                              0601
         LA    @12,0(,@12)                                         0601
         LR    PCBPTR,@12                                          0601
*     END;                                                         0602
@DE00598 LTR   PCBPTR,PCBPTR                                       0602
         BNZ   @DL00598                                            0602
*     R11=R11->PCBBQPA;             /* ADJUST TO NEXT QUEUED PCB     */
         L     R11,PCBBQPA(,R11)                                   0603
*     GO TO DIDQDD;                 /* SKIP NORMAL GFA DEFER Q     0604
*                                      PROCESSING                    */
         B     DIDQDD                                              0604
*                                                                  0605
*     /***************************************************************/
*     /*                                                             */
*     /* SCAN GFA DEFER QUEUE FOR PCBS FOR THIS ADDRESS SPACE. MAKE  */
*     /* ENTRIES IN SPCT FOR PRIVATE AREA ZERO TCB FIXES. REMOVE PAGE*/
*     /* FAULTS AFTER THEIR EXISTENCE HAS BEEN NOTED IN THE SPCT.    */
*     /* REMOVE NON ZERO TCB FIXES                                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0605
*NORMGFA:                                                          0605
*     PCBPTR=R11;                   /* SET PTR                       */
*                                                                  0605
NORMGFA  LR    PCBPTR,R11                                          0605
*     /***************************************************************/
*     /*                                                             */
*     /* IF PCB IS FOR A VIO PAGE IN, NO BIT MASK ENTRY IS TO BE MADE*/
*     /* AS THIS VIO FRAME CANNOT BE BROUGHT IN AT SWAP IN TIME USING*/
*     /* A MEMORY LPID. NO BIT MASK ENTRY IS TO BE MADE IF THE FRAME */
*     /* IS FIXED AS A FIX TYPE ENTRY WILL ALREADY BE IN THE SPCT NO */
*     /* BIT MASK ENTRIES ARE TO BE MADE EXCEPT FOR PRIVATE AREA     */
*     /* PAGES                                                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0606
*     IF PCBVBN>=PVTLCSA THEN                                      0606
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0606
         BL    @RF00606                                            0606
*       MASKFLG='0'B;               /* DO NOT MAKE BIT MASK ENTRY AS
*                                      THE PAGE IS FOR THE COMMON  0607
*                                      AREA                          */
         NI    MASKFLG(PVTPTR),B'11011111'                         0607
*     ELSE                                                         0608
*       MASKFLG='1'B;               /* MAKE BIT MASK ENTRY UNLESS A
*                                      FIX IS IN PROGRESS OR THE PAGE
*                                      IS A VIO PAGE                 */
         B     @RC00606                                            0608
@RF00606 OI    MASKFLG(PVTPTR),B'00100000'                         0608
*     R4=R11;                       /* R4 WILL CONTAIN THE ADDRESS OF
*                                      THE PREVIOUS PCB              */
@RC00606 LR    R4,R11                                              0609
*     PCBPTR=R11->PCBRLPA;          /* SET TO FIRST ON RELATED CHAIN */
*                                                                  0610
         L     PCBPTR,PCBRLPA-1(,R11)                              0610
         LA    PCBPTR,0(,PCBPTR)                                   0610
*     /***************************************************************/
*     /*                                                             */
*     /* DO FOR EACH RELATED ON THIS QUEUED PCB                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0611
*     DO WHILE(PCBPTR^=0);                                         0611
         B     @DE00611                                            0611
@DL00611 DS    0H                                                  0612
*       IF PCBASCB=PSAAOLD THEN                                    0612
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0612
         BNE   @RF00612                                            0612
*         DO;                                                      0613
*           IF XPTVIOLP='1'B&XPTVIO='1'BXPTXAV='0'B THEN          0614
         L     @12,PCBXPTA-1(,PCBPTR)                              0614
         LA    @12,0(,@12)                                         0614
         TM    XPTVIOLP(@12),B'10001000'                           0614
         BO    @RT00614                                            0614
         TM    XPTXAV(@12),B'01000000'                             0614
         BNZ   @RF00614                                            0614
@RT00614 DS    0H                                                  0615
*             MASKFLG='0'B;         /* IF PAGE IS VIO OR FIRST     0615
*                                      REFERENCE DO NOT MAKE BIT MASK
*                                      ENTRY                 @YM02461*/
         NI    MASKFLG(PVTPTR),B'11011111'                         0615
*/*                                                          @Z40WPYC*/
*                                                                  0616
*           LASTRLT=R4;             /* SAVE PTR                      */
@RF00614 ST    R4,LASTRLT(,PVTPTR)                                 0616
*           CALL PCBPROC;           /* PROCESS RELATED PCB           */
         BAL   @14,PCBPROC                                         0617
*           IF KEEPPCB='1'B THEN                                   0618
         TM    KEEPPCB(PVTPTR),B'00010000'                         0618
         BO    @RT00618                                            0618
*             GO TO SAVPCB;                                        0619
*           R4=LASTRLT;             /* RESTORE POINTER               */
         L     R4,LASTRLT(,PVTPTR)                                 0620
*           R4->PCBRLPA=PCBPTR->PCBRLPA;/* REMOVE RELATED FROM     0621
*                                      RELATED CHAIN                 */
         MVC   PCBRLPA(3,R4),PCBRLPA(PCBPTR)                       0621
*           R0=PCBFREQN;            /* PCB TO FREE Q                 */
         LA    R0,16                                               0622
*           R1=PCBPTR;              /* PCB TO BE FREED               */
         LR    R1,PCBPTR                                           0623
*           CALL IEAVPCB;           /* FREE IT                       */
         L     @15,PVTPCB(,PVTPTR)                                 0624
         BALR  @14,@15                                             0624
*           GO TO SAVPCB2;                                         0625
         B     SAVPCB2                                             0625
*         END;                                                     0626
*SAVPCB:                                                           0627
*       R4=PCBPTR;                  /* UPDATE PREVIOUS PCB PTR       */
@RF00612 DS    0H                                                  0627
SAVPCB   LR    R4,PCBPTR                                           0627
*SAVPCB2:                                                          0628
*       PCBPTR=R4->PCBRLPA;         /* SET TO NEXT PCB ON RELATED  0628
*                                      CHAIN                         */
SAVPCB2  L     PCBPTR,PCBRLPA-1(,R4)                               0628
         LA    PCBPTR,0(,PCBPTR)                                   0628
*     END;                          /* END OF RELATED LOOP           */
@DE00611 LTR   PCBPTR,PCBPTR                                       0629
         BNZ   @DL00611                                            0629
*                                                                  0630
*     /***************************************************************/
*     /*                                                             */
*     /* NOW PROCESS THE QUEUED GFA DEFER QUEUE PCB                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0630
*     PCBPTR=R11;                   /* NOW WORK ON QUEUED            */
         LR    PCBPTR,R11                                          0630
*     R11=PCBBQPA;                  /* ADJUST TO NEXT Q'D PCB        */
         L     R11,PCBBQPA(,PCBPTR)                                0631
*     IF PCBASCB=PSAAOLD THEN                                      0632
         CLC   PCBASCB(4,PCBPTR),PSAAOLD                           0632
         BNE   @RF00632                                            0632
*       DO;                                                        0633
*         IF XPTVIOLP='1'B&XPTVIO='1'BXPTXAV='0'B THEN            0634
         L     @12,PCBXPTA-1(,PCBPTR)                              0634
         LA    @12,0(,@12)                                         0634
         TM    XPTVIOLP(@12),B'10001000'                           0634
         BO    @RT00634                                            0634
         TM    XPTXAV(@12),B'01000000'                             0634
         BNZ   @RF00634                                            0634
@RT00634 DS    0H                                                  0635
*           MASKFLG='0'B;           /* IF PAGE IS VIO OR FIRST     0635
*                                      REFERENCE DO NOT MAKE BIT MASK
*                                      ENTRY                 @YM02461*/
         NI    MASKFLG(PVTPTR),B'11011111'                         0635
*/*                                                          @Z40WPYC*/
*                                                                  0636
*         CALL PCBPROC;             /* PROCESS Q'D PCB               */
@RF00634 BAL   @14,PCBPROC                                         0636
*         IF KEEPPCB='1'B THEN                                     0637
         TM    KEEPPCB(PVTPTR),B'00010000'                         0637
         BO    @RT00637                                            0637
*           GO TO DIDQDD;                                          0638
*         ELSE                                                     0639
*           DO;                                                    0639
*                                                                  0639
*             /*******************************************************/
*             /*                                                     */
*             /* ARE THERE ANY RELATEDS LEFT ON Q'D                  */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0640
*             IF PCBRLPA^=0 THEN                                   0640
         L     @12,PCBRLPA-1(,PCBPTR)                              0640
         LA    @12,0(,@12)                                         0640
         LTR   @12,@12                                             0640
         BZ    @RF00640                                            0640
*               DO;                                                0641
*                 PCBVBN=0;         /* ZERO VBN TO HAVE UNIQUE VBN'S
*                                      ON Q                          */
         SLR   @06,@06                                             0642
         STH   @06,PCBVBN(,PCBPTR)                                 0642
*                 R0=PCBDEFRN;      /* RELATED CHAIN TO GFA Q        */
         LA    R0,24                                               0643
*                 R1=PCBRLPA;       /* ADDR OF FIRST RELATED         */
         LR    R1,@12                                              0644
*                 PCBRLPA=0;        /* CLEAR OLD RLTD ADDR           */
         STCM  @06,7,PCBRLPA(PCBPTR)                               0645
*                 CALL IEAVPCB;     /* ENQ RELATED CHAIN             */
         L     @15,PVTPCB(,PVTPTR)                                 0646
         BALR  @14,@15                                             0646
*               END;                                               0647
*             ELSE                                                 0648
*               DO;                                                0648
         B     @RC00640                                            0648
@RF00640 DS    0H                                                  0649
*                 XPTDEFER='0'B;    /* LAST PCB ON THE DEFER Q FOR 0649
*                                      THIS VBN IS BEING FREED, SO 0649
*                                      DEFER FLAG IS ZEROED          */
*                                                                  0649
         L     @12,PCBXPTA-1(,PCBPTR)                              0649
         NI    XPTDEFER(@12),B'11111101'                           0649
*                 /***************************************************/
*                 /*                                                 */
*                 /* IS A BIT MASK ENTRY TO BE MADE                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0650
*                 IF MASKFLG='1'B THEN                             0650
         TM    MASKFLG(PVTPTR),B'00100000'                         0650
         BNO   @RF00650                                            0650
*                   DO;                                            0651
*                     R1=PCBVBN;    /* VBN FOR SUBROUTINE            */
         LH    R1,PCBVBN(,PCBPTR)                                  0652
         N     R1,@CF02704                                         0652
*                     CALL SETMASK; /* MAKE BIT MASK ENTRY FOR THIS
*                                      PRIVATE AREA VBN              */
         BAL   @14,SETMASK                                         0653
*                     PGTPVM='1'B;  /* INVALIDATE THE PAGE   @Z40WPYC*/
         L     @12,PCBPGTA-1(,PCBPTR)                              0654
         OI    PGTPVM(@12),B'00001000'                             0654
*                   END;                                           0655
*                 ELSE                                             0656
*                   ;                                              0656
@RF00650 DS    0H                                                  0657
*               END;                                               0657
*                                                                  0657
*             /*******************************************************/
*             /*                                                     */
*             /* FREE THE QUEUED PCB                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0658
*             R0=PCBFREQN;                                         0658
@RC00640 LA    R0,16                                               0658
*             R1=PCBPTR;                                           0659
         LR    R1,PCBPTR                                           0659
*             CALL IEAVPCB;                                        0660
         L     @15,PVTPCB(,PVTPTR)                                 0660
         BALR  @14,@15                                             0660
*           END;                    /* END OF ZERO TCB TEST          */
*       END;                        /* END OF ASCB TEST              */
*DIDQDD:                                                           0663
*   END;                            /* END OF Q'D PCB LOOP           */
@RF00632 DS    0H                                                  0663
DIDQDD   DS    0H                                                  0663
@DE00581 LTR   R11,R11                                             0663
         BNZ   @DL00581                                            0663
*   RFY                                                            0664
*    (R14) RSTD;                                                   0664
*   R14=LEV1RTN;                    /* GET RETURN ADDRESS            */
         L     R14,LEV1RTN(,PVTPTR)                                0665
*   RFY                                                            0666
*    (R1,                                                          0666
*     R4,                                                          0666
*     R14) UNRSTD;                                                 0666
*   RFY                                                            0667
*     PGTPTE BASED(PTEPTR);                                        0667
*   RFY                                                            0668
*     XPTE BASED(XPTEPTR);                                         0668
*   RFY                                                            0669
*     PCBR BASED(PCBRPTR);                                         0669
*PRCEND1:                                                          0670
*   END PIOPURGE;                                                  0670
@EL00004 DS    0H                                                  0670
@EF00004 DS    0H                                                  0670
@ER00004 BR    @14                                                 0670
*STAGE1:                                                           0671
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0671
*                                                                  0671
STAGE1   DS    0H                                                  0672
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION BUILDS SWAP OUT PCBS FOR THE STAGE 1 PAGES.      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0672
*   RESPECIFY                                                      0672
*    (PCBPTR,                                                      0672
*     PCBRPTR,                                                     0672
*     R14) RESTRICTED;                                             0672
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV1RTN(,PVTPTR)                                0673
*   RESPECIFY                                                      0674
*    (R14) UNRESTRICTED;                                           0674
*   RESPECIFY                                                      0675
*    (PFTEPTR,                                                     0675
*     SWAPPTR,                                                     0675
*     ENDPTR) RESTRICTED;           /*                       @Z40WPYC*/
*   PFTEPTR=PVTPFTP+RSMLSQAF;       /* SET UP POINTERS TO THE FIRST
*                                      LSQA FRAME. EVERY ADDRESS   0676
*                                      SPACE MUST HAVE AT LEAST ONE
*                                      LSQA FRAME.                   */
         LH    PFTEPTR,RSMLSQAF(,RSMHDPTR)                         0676
         N     PFTEPTR,@CF02704                                    0676
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0676
*   SWAPPTR=ADDR(SPCTSWAP);         /* GET ADDRESS OF SWAP ENTRIES 0677
*                                                            @Z40WPYC*/
         LA    SWAPPTR,SPCTSWAP(,SPCTPTR)                          0677
*   LSQAEXT=SWAPPTR;                /* SAVE PTR TO FIRST LSQA      0678
*                                      EXTENSION.            @Z40WPYC*/
         ST    SWAPPTR,LSQAEXT(,PVTPTR)                            0678
*   ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* CALC END ADDR OF EXT  @Z40WPYC*/
         LA    ENDPTR,56                                           0679
         ALR   ENDPTR,SWAPPTR                                      0679
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET PTR TO
*                                      FIRST LSQA SPCTE      @Z40WPYC*/
         AL    SWAPPTR,@CF00057                                    0680
*NEXTPFT:                                                          0681
*   R0=0;                           /* SET FLAG: FINDPAGE MUST BE  0681
*                                      DONE                          */
NEXTPFT  SLR   R0,R0                                               0681
*   CALL INITPCB;                   /* CALL SUBROUTINE TO INITIALIZE
*                                      THE NEXT AVAILABLE SWAP OUT 0682
*                                      PCB FOR THIS PAGE. RETURN CODE
*                                      IS NOT CHECKED HERE AS THE  0682
*                                      NUMBER OF PCBS WAS CHECKED  0682
*                                      BEFORE CALLING PIOPURGE       */
         BAL   @14,INITPCB                                         0682
*   AIALSQA='1'B;                   /* INDICATE AN LSQA SWAP PAGE  0683
*                                                            @Z40WPYC*/
         OI    AIALSQA(PCBPTR),B'00001000'                         0683
*   PCBSPCTE=SWAPPTR;               /* INIT PTR TO LSQA SPCTE FOR ASM
*                                                            @Z40WPYC*/
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0684
*   IF PFTFQPTR^=0 THEN             /* TEST FOR MORE LSQA FRAMES.    */
         LH    @01,PFTFQPTR(,PFTEPTR)                              0685
         N     @01,@CF02704                                        0685
         LTR   @01,@01                                             0685
         BZ    @RF00685                                            0685
*     DO;                           /* GET THE NEXT PFTE TO PROCESS. */
*       PFTEPTR=PVTPFTP+PFTFQPTR;   /* GET THE ADDRESS OF THE NEXT 0687
*                                      PFTE ON THE LSQA QUEUE.       */
         AL    @01,PVTPFTP(,PVTPTR)                                0687
         LR    PFTEPTR,@01                                         0687
*       SWAPPTR=SWAPPTR+LENGTH(SPCTLS);/* CALC PTR TO NEXT SPCTE   0688
*                                                            @Z40WPYC*/
         AL    SWAPPTR,@CF00970                                    0688
*       IF SWAPPTR=ENDPTR THEN      /* TEST IF THE EXTENSION IS FULL
*                                                            @Z40WPYC*/
         CR    SWAPPTR,ENDPTR                                      0689
         BNE   @RF00689                                            0689
*         DO;                       /* THE EXTENSION IS FULL OF LSQA
*                                      ENTRIES. OBTAIN AN ADDITIONAL
*                                      EXTENSION             @Z40WPYC*/
*           SWAPPTR=LSQAEXT->SPCTEXT;/* GET ADDR OF NEXT EXTENSION 0691
*                                                            @Z40WPYC*/
         L     @01,LSQAEXT(,PVTPTR)                                0691
         L     SWAPPTR,SPCTEXT(,@01)                               0691
*           LSQAEXT=SWAPPTR;        /* SAVE PTR TO START OF EXT    0692
*                                                            @Z40WPYC*/
         ST    SWAPPTR,LSQAEXT(,PVTPTR)                            0692
*           ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* GET END ADDR OF EXT 0693
*                                                            @Z40WPYC*/
         LA    ENDPTR,56                                           0693
         ALR   ENDPTR,SWAPPTR                                      0693
*           SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET
*                                      ADDR OF FIRST ENTRY IN THE  0694
*                                      EXTENSION             @Z40WPYC*/
         AL    SWAPPTR,@CF00057                                    0694
*         END;                      /* END NEW EXTENSION PROCESSING
*                                                            @Z40WPYC*/
*       ELSE                                                       0696
*         ;                         /* NOT END OF EXTENSION  @Z40WPYC*/
@RF00689 DS    0H                                                  0697
*       GOTO NEXTPFT;               /* ARE MORE LSQA FRAMES. PREPARE
*                                      THEM FOR SWAP OUT.            */
         B     NEXTPFT                                             0697
*     END;                                                         0698
*                                                                  0699
*/********************************************************************/
*/*                                                                  */
*/*   IF HERE, ALL LSQA PAGES HAVE BEEN PROCESSED. FIX ENTRIES ARE   */
*/* NEXT TO BE SWAPPED OUT.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0699
*   IF PTRLAST=0 THEN               /* TEST IF NO FIX ENTRIES EXIST. */
@RF00685 SLR   @01,@01                                             0699
         C     @01,PTRLAST(,PVTPTR)                                0699
         BE    @RT00699                                            0699
*     GOTO EXITSTG1;                /* ARE NO FIX ENTRIES IN THE   0700
*                                      SPCT. CAN EXIT AT THIS TIME.  */
*                                                                  0700
*   /*****************************************************************/
*   /*                                                               */
*   /* IF HERE, THERE ARE FIX ENTRIES IN THE SPCT. A PCB MUST BE     */
*   /* BUILT FOR EACH IN-CORE FIX AND PFTE FIX COUNT PROCESSING MUST */
*   /* BE DONE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0701
*   NLSQAPCB=NEXTPCB;               /* SAVE PTR TO FIRST FIX PCB   0701
*                                                            @Z40WPYC*/
         L     @15,SPCTSWRT(,SPCTPTR)                              0701
         MVC   NLSQAPCB(3,@15),NEXTPCB+1(PVTPTR)                   0701
*   AIANXAIA=0;                     /* SEPARATE THE LSQA FROM THE FIX
*                                      AIAS                  @Z40WPYC*/
         ST    @01,AIANXAIA(,PCBPTR)                               0702
*   RESPECIFY                                                      0703
*    (LRAREG) RESTRICTED;                                          0703
*   SWAPPTR=PTRFIRST;               /* GET THE ADDRESS OF THE FIRST
*                                      SPCT FIX ENTRY.               */
         L     SWAPPTR,PTRFIRST(,PVTPTR)                           0704
*   ENDPTR=FIXBEG+LENGTH(SPCTEXTM); /* GET THE ADDRESS OF THE END OF
*                                      THE FIRST EXTENSION WITH FIX
*                                      ENTRIES.                      */
         LA    ENDPTR,56                                           0705
         AL    ENDPTR,FIXBEG(,PVTPTR)                              0705
*DOENTRY:                                                          0706
*   LRAREG=(SPCTVBN*256);           /* MAKE THE VSA.         @Z40WPYC*/
*                                                                  0706
DOENTRY  LH    LRAREG,SPCTVBN(,SWAPPTR)                            0706
         N     LRAREG,@CF02704                                     0706
         SLA   LRAREG,8                                            0706
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST IF FIXED PAGE IS IN CORE.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0707
*   GENERATE CODE FLOWS(STG1ERR,NEXTSPCT);                         0707
         LRA   LRAREG,0(0,LRAREG)    LOAD THE REAL ADDRESS
         BC    2,NEXTSPCT           IF NOT IN CORE, GET NEXT ENTRY
         BC    5,STG1ERR            IF SEGMENT INVALID, PROCESS ERROR
         SRL   LRAREG,8             MAKE RBN FROM RSA
*   PFTEPTR=PVTPFTP+LRAREG;         /* GET THE ADDRESS OF THE PFTE 0708
*                                      FOR THE FIXED IN-CORE PAGE    */
         LR    PFTEPTR,LRAREG                                      0708
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0708
*   RESPECIFY                                                      0709
*    (LRAREG) UNRESTRICTED;                                        0709
*   IF PFTDFRLS='1'B THEN           /* TEST FOR A DEFERRED RELEASE 0710
*                                      PAGE (FREEMAINED BUT STILL  0710
*                                      FIXED.)                       */
         TM    PFTDFRLS(PFTEPTR),B'10000000'                       0710
         BNO   @RF00710                                            0710
*     DO;                           /* IS DEFERRED RELEASE.          */
*       SPCTDEFR='1'B;              /* FLAG SPCT FIX ENTRY AS      0712
*                                      DEFERRED RELEASED.            */
         OI    SPCTDEFR(SWAPPTR),B'00010000'                       0712
*       IF PFTVBN^<PVTLCSA THEN     /* TEST IF PAGE IS IN THE COMMON
*                                      AREA.                         */
         CLC   PFTVBN(2,PFTEPTR),PVTLCSA(PVTPTR)                   0713
         BNL   @RT00713                                            0713
*         GOTO NEXTSPCT;            /* IS A COMMON AREA DEFERRED   0714
*                                      RELEASE PAGE. THE PFTE FIX  0714
*                                      COUNT IS NOT DECREMENTED SO 0714
*                                      THAT THE FRAME DOES NOT GO  0714
*                                      AWAY.                         */
*     END;                                                         0715
*                                                                  0716
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING CODE PROCESSES ONLY IN STORAGES FIXES BECAUSE OF*/
*   /* THE PRECEEDING LRA - A FIXED FRAME WITH PFTPCBSI ON CAN ONLY  */
*   /* BE FOR IN BOUND I/O - ASM SHOULD BE ABLE TO HANDLE READ ERRORS*/
*   /* TO BAD PAGES, THIS CODE DOES NOT ATTEMPT TO CANCEL ANY I/O    */
*   /* THAT IS IN PROGRESS TO BAD PAGES PRIOR TO SWAP OUT.   @ZA19960*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0716
*   IF PFTBADPG='1'B THEN           /* STORAGE ERROR IN THIS PAGE? 0716
*                                                            @ZA19960*/
@RF00710 TM    PFTBADPG(PFTEPTR),B'00000100'                       0716
         BNO   @RF00716                                            0716
*     DO;                           /* YES, REMOVE THIS FIX ENTRY  0717
*                                      FROM THE SPCT. THE FIXED FRAME
*                                      IS LEFT ON THE LOCAL FRAME  0717
*                                      QUEUE WHILE THE ADDRESS SPACE
*                                      IS SWAPPED OUT        @ZA19960*/
*                                                                  0717
*       /*************************************************************/
*       /*                                                           */
*       /* FIXED FRAMES BACKED OUT OF THE SPCT AT THIS TIME ARE      */
*       /* PROCESSED AGAIN IN ROUTINE WORKSET - THUS THE FRAME PINNED*/
*       /* COUNT(FRPINCNT) IS NOT INCREMENTED NOR THE LOGGING ABEND  */
*       /* ISSUED AT THIS TIME.                              @ZA19960*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0718
*       IF SWAPPTR^=PTRLAST THEN    /* PROCESSING THE LAST ENTRY?  0718
*                                                            @ZA19960*/
         L     @01,PTRLAST(,PVTPTR)                                0718
         CR    SWAPPTR,@01                                         0718
         BE    @RF00718                                            0718
*         SPCTSWPE=PTRLAST->SPCTSWPE;/* NO - MOVE LAST ENTRY TO THIS
*                                      ENTRY                 @ZA19960*/
         MVC   SPCTSWPE(8,SWAPPTR),SPCTSWPE(@01)                   0719
*       PTRLAST->SPCTSWPE=''B;      /* ZERO THE LAST ENTRY   @ZA19960*/
@RF00718 L     @01,PTRLAST(,PVTPTR)                                0720
         XC    SPCTSWPE(8,@01),SPCTSWPE(@01)                       0720
*       SPCTFIX=SPCTFIX-1;          /* DECREMENT THE NUMBER OF FIX 0721
*                                      ENTRIES IN THE SPCT   @ZA19960*/
         LH    @01,SPCTFIX(,SPCTPTR)                               0721
         BCTR  @01,0                                               0721
         STH   @01,SPCTFIX(,SPCTPTR)                               0721
*       IF SPCTFIX=0 THEN           /* ANY SPCT FIX ENTRIES REMAIN?
*                                                            @ZA19960*/
         SLR   @15,@15                                             0722
         CR    @01,@15                                             0722
         BNE   @RF00722                                            0722
*         DO;                       /* NO SO INDICATE SUCH AND     0723
*                                      TERMINATE THE LOOP    @ZA19960*/
*           PTRLAST=0;              /* ADDRESS OF LAST FIX ENTRY - 0
*                                      MEANS NO ENTRIES      @ZA19960*/
         ST    @15,PTRLAST(,PVTPTR)                                0724
*           GOTO EXITSTG1;          /* DONE WITH STAGE ONE ENTRIES 0725
*                                                            @ZA19960*/
         B     EXITSTG1                                            0725
*         END;                      /* END OF NO FIX ENTRIES REMAIN
*                                                            @ZA19960*/
*       ELSE                        /*                       @ZA19960*/
*         DO;                       /* YES, SO SET NEW LAST ENTRY  0727
*                                      ADDRESS AND REPROCESS THIS  0727
*                                      ENTRY SINCE IT NOW CONTAINS 0727
*                                      NEW DATA.             @ZA19960*/
@RF00722 DS    0H                                                  0728
*           R0=PTRLAST;             /* SAVE PREVIOUS LAST ADDRESS  0728
*                                                            @ZA19960*/
         L     @15,PTRLAST(,PVTPTR)                                0728
         LR    R0,@15                                              0728
*           PTRLAST=PTRLAST-LENGTH(SPCTSWPE);/* ADDRESS OF PREVIOUS
*                                      SPCT FIX ENTRY        @ZA19960*/
         SL    @15,@CF00057                                        0729
         ST    @15,PTRLAST(,PVTPTR)                                0729
*           RESPECIFY                                              0730
*             R4 RESTRICTED;        /*                       @ZA19960*/
*           R4=FIXBEG;              /* GET ADDRESS OF FIRST EXTENSION
*                                      CONTAINING FIX ENTRIES      0731
*                                                            @ZA19960*/
         L     R4,FIXBEG(,PVTPTR)                                  0731
*           DO WHILE(R4^=0);        /* LOOP THROUGH ALL EXTENSIONS 0732
*                                                            @ZA19960*/
         B     @DE00732                                            0732
@DL00732 DS    0H                                                  0733
*             IF R4->SPCTEXT=PTRLAST THEN/* POINT TO FRONT OF AN   0733
*                                      EXTENSION?            @ZA19960*/
         CLC   SPCTEXT(4,R4),PTRLAST(PVTPTR)                       0733
         BNE   @RF00733                                            0733
*               DO;                 /* YES, SO BACK UP TO LAST ENTRY
*                                      IN PREVIOUS EXTENSION @ZA19960*/
*                 PTRLAST=R4+LENGTH(SPCTEXTM)-LENGTH(SPCTSWPE);/*  0735
*                                      ADJUST LAST POINTER TO LAST 0735
*                                      FIX ENTRY IN THE PREVIOUS   0735
*                                      EXTENSION             @ZA19960*/
         LR    @05,R4                                              0735
         SL    @05,@CF02696                                        0735
         ST    @05,PTRLAST(,PVTPTR)                                0735
*                 GOTO DLENTRY;     /* GO CHECK IF LAST ENTRY WAS  0736
*                                      DELETED               @ZA19960*/
         B     DLENTRY                                             0736
*               END;                /* FOUND PTRLAST POINTING TO   0737
*                                      FRONT OF AN EXTENSION @ZA19960*/
*             ELSE                  /*                       @ZA19960*/
*               R4=R4->SPCTEXT;     /* ONWARD TO NEXT EXTENSION    0738
*                                                            @ZA19960*/
@RF00733 L     R4,SPCTEXT(,R4)                                     0738
*           END;                    /* END OF EXTENSION SCAN LOOP -
*                                      PTRLAST DOES NOT POINT TO ANY
*                                      ENTENSION, THEREFORE IT MUST
*                                      POINT TO A VALID FIX ENTRY  0739
*                                      WITHIN AN EXTENSION.  @ZA19960*/
@DE00732 LTR   R4,R4                                               0739
         BNZ   @DL00732                                            0739
*           RESPECIFY                                              0740
*             R4 UNRESTRICTED;      /*                       @ZA19960*/
*DLENTRY:                                                          0741
*           IF R0=SWAPPTR THEN      /* WAS LAST ENTRY DELETED?     0741
*                                                            @ZA19960*/
DLENTRY  CR    R0,SWAPPTR                                          0741
         BE    @RT00741                                            0741
*             GOTO EXITSTG1;        /* YES, SO STAGE ONE NOW DONE  0742
*                                                            @ZA19960*/
*           ELSE                    /*                       @ZA19960*/
*             GOTO DOENTRY;         /* NO, SO GO REPROCESS THE     0743
*                                      CURRENT ENTRY         @ZA19960*/
         B     DOENTRY                                             0743
*         END;                      /* END OF THERE ARE FIX ENTRIES
*                                      REMAINING IN THE SPCT @ZA19960*/
*     END;                          /* END OF STORAGE ERROR IN PAGE
*                                      PROCESSING            @ZA19960*/
*   PFTFXCT=PFTFXCT-SPCTFIXC;       /* DECREMENT PFTE FIX COUNT BY 0746
*                                      NUMBER OF FIXES ON THE PAGE BY
*                                      THIS ADDRESS SPACE. (EXCEPT 0746
*                                      COMMON AREA DEF.RELS.)        */
@RF00716 LH    @01,PFTFXCT(,PFTEPTR)                               0746
         SH    @01,SPCTFIXC(,SWAPPTR)                              0746
         STH   @01,PFTFXCT(,PFTEPTR)                               0746
*   IF PFTVBN^<PVTLCSA THEN         /* TEST FOR COMMON AREA VBN.     */
         CLC   PFTVBN(2,PFTEPTR),PVTLCSA(PVTPTR)                   0747
         BL    @RF00747                                            0747
*     DO;                           /* SPECIAL PROCESSING FOR COMMON
*                                      AREA FIXES                    */
*       IF PFTFXCT=0 THEN           /* TEST IF FRAME IS NOW FREED    */
         LTR   @01,@01                                             0749
         BNZ   @RF00749                                            0749
*         DO;                                                      0750
*           PVTCOMFX=PVTCOMFX-1;    /* DECREMENT GLOBAL COMMON AREA
*                                      FIX COUNT             @YA01572*/
         LH    @01,PVTCOMFX(,PVTPTR)                               0751
         BCTR  @01,0                                               0751
         STH   @01,PVTCOMFX(,PVTPTR)                               0751
*           PVTCNTFX=PVTCNTFX-1;    /* DECREMENT SYSTEM FIX COUNT  0752
*                                                            @YA01572*/
         LH    @01,PVTCNTFX(,PVTPTR)                               0752
         BCTR  @01,0                                               0752
         STH   @01,PVTCNTFX(,PVTPTR)                               0752
*           PFTVRPLT='0'B;          /* FRAME NOT POLLUTING V=R     0753
*                                                            @ZA31128*/
         NI    PFTVRPLT(PFTEPTR),B'11101111'                       0753
*         END;                                                     0754
*       GOTO NEXTSPCT;              /* COMMON AREA FIX. DO NOT SWAP. */
         B     NEXTSPCT                                            0755
*     END;                                                         0756
*   ELSE                            /* A LOCAL FRAME                 */
*     IF PFTFXCT=0 THEN                                            0757
@RF00747 LH    @01,PFTFXCT(,PFTEPTR)                               0757
         LTR   @01,@01                                             0757
         BNZ   @RF00757                                            0757
*       DO;                                                        0758
*         RSMCNTFX=RSMCNTFX-1;      /* DECREMENT FIX COUNT FOR     0759
*                                      ADDRESS SPACE         @YA01572*/
         LH    @01,RSMCNTFX(,RSMHDPTR)                             0759
         BCTR  @01,0                                               0759
         STH   @01,RSMCNTFX(,RSMHDPTR)                             0759
*         PVTCNTFX=PVTCNTFX-1;      /* DECREMENT SYSTEM FIX        0760
*                                      COUNT@YA01572                 */
         LH    @01,PVTCNTFX(,PVTPTR)                               0760
         BCTR  @01,0                                               0760
         STH   @01,PVTCNTFX(,PVTPTR)                               0760
*       END;                                                       0761
*     ELSE                                                         0762
*       ;                                                          0762
@RF00757 DS    0H                                                  0763
*   CALL INITPCB;                   /* CALL SUBROUTINE TO INITIALIZE
*                                      A PCB TO SWAP OUT THE FIXED 0763
*                                      PAGE.                         */
         BAL   @14,INITPCB                                         0763
*   RESPECIFY                                                      0764
*    (R1,                                                          0764
*     R15) RESTRICTED;              /*                       @Z40WPYC*/
*   IF RETNCODE^=0 THEN             /* IF FINDPAGE ERROR, GET NEXT 0765
*                                      ENTRY                 @Z40WPYC*/
         SLR   @14,@14                                             0765
         C     @14,RETNCODE(,PVTPTR)                               0765
         BE    @RF00765                                            0765
*     DO;                           /* CLEAR RETURN CODE     @Z40WPYC*/
*       RETNCODE=0;                 /* CLEAR RETURN CODE     @Z40WPYC*/
         ST    @14,RETNCODE(,PVTPTR)                               0767
*       GOTO NEXTSPCT;              /* GET NEXT ENTRY        @Z40WPYC*/
         B     NEXTSPCT                                            0768
*     END;                          /* END FINDPAGE ERROR    @Z40WPYC*/
*   ELSE                                                           0770
*     ;                             /* FINDPAGE SUCCESSFUL   @Z40WPYC*/
@RF00765 DS    0H                                                  0771
*   PCBSPCTE=SWAPPTR;               /* INIT PTR TO SPCTE FOR ASM   0771
*                                                            @Z40WPYC*/
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0771
*   AIASWPFX='1'B;                  /* INDICATE PRIVATE AREA FIX SWAP
*                                      PAGE                  @Z40WPYC*/
         OI    AIASWPFX(PCBPTR),B'00000010'                        0772
*   R1->XPTXAV='1'B;                /* SET AUX VALID         @Z40WPYC*/
         OI    XPTXAV(R1),B'01000000'                              0773
*   RESPECIFY                                                      0774
*    (R1,                                                          0774
*     R15) UNRESTRICTED;            /*                       @Z40WPYC*/
*                                                                  0774
*   /*****************************************************************/
*   /*                                                               */
*   /* SET TO NEXT FIX ENTRY IN SPCT                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0775
*NEXTSPCT:                                                         0775
*   IF SWAPPTR=PTRLAST THEN         /* TEST IF AT END OF SPCT FIX  0775
*                                      ENTRIES.                      */
NEXTSPCT C     SWAPPTR,PTRLAST(,PVTPTR)                            0775
         BE    @RT00775                                            0775
*     GOTO EXITSTG1;                /* ARE DONE WITH ALL FIXED PAGES.
*                                      EXIT.                         */
*   SWAPPTR=SWAPPTR+LENGTH(SPCTSWPE);/* GET THE ADDRESS OF THE NEXT
*                                      SPCT FIX ENTRY TO BE        0777
*                                      PROCESSED.                    */
         LA    @01,8                                               0777
         ALR   SWAPPTR,@01                                         0777
*   IF SWAPPTR=ENDPTR THEN          /* NOT AT END OF FIX ENTRIES.  0778
*                                      TEST IF AT END OF THE PRESENT
*                                      EXTENSION.                    */
         CR    SWAPPTR,ENDPTR                                      0778
         BNE   @RF00778                                            0778
*     DO;                           /* ARE AT THE END OF THE       0779
*                                      EXTENSION. SET UP TO PROCESS
*                                      THE NEXT EXTENSION.           */
*       ENDPTR=ENDPTR-LENGTH(SPCTEXTM);/* GET THE BEGINNING OF THE 0780
*                                      EXTENSION.                    */
         LA    @15,56                                              0780
         SLR   ENDPTR,@15                                          0780
*       ENDPTR=ENDPTR->SPCTEXT;     /* GET THE ADDRESS OF THE NEXT 0781
*                                      EXTENSION.                    */
*                                                                  0781
         L     ENDPTR,SPCTEXT(,ENDPTR)                             0781
*       /*************************************************************/
*       /*                                                           */
*       /* GET THE ADDRESS OF THE FIRST FIX ENTRY IN THE NEW         */
*       /* EXTENSION.                                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0782
*       SWAPPTR=ENDPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));         0782
         ALR   @01,ENDPTR                                          0782
         LR    SWAPPTR,@01                                         0782
*       ENDPTR=ENDPTR+LENGTH(SPCTEXTM);/* GET THE ADDRESS OF THE END
*                                      OF THE NEW EXTENSION.         */
         ALR   ENDPTR,@15                                          0783
*     END;                          /* ARE READY TO PROCESS THE NEXT
*                                      EXTENSION.                    */
*   GOTO DOENTRY;                   /* GO PROCESS THE NEXT SPCT FIX
*                                      ENTRY.                        */
         B     DOENTRY                                             0785
*STG1ERR:                                                          0786
*   R0='01'X;                       /* RECORD LRA FAILURE            */
STG1ERR  LA    R0,1                                                0786
*   CALL DOABEND;                   /* RECORD THE ERROR              */
         BAL   @14,DOABEND                                         0787
*   GO TO NEXTSPCT;                 /* GO PROCESS NEXT ENTRY         */
*                                                                  0788
         B     NEXTSPCT                                            0788
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT STAGE 1 PROCESSOR                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0789
*EXITSTG1:                                                         0789
*   RESPECIFY                                                      0789
*    (R14) RESTRICTED;                                             0789
EXITSTG1 DS    0H                                                  0790
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV1RTN(,PVTPTR)                                0790
*   RESPECIFY                                                      0791
*    (SWAPPTR,                                                     0791
*     PFTEPTR,                                                     0791
*     PCBPTR,                                                      0791
*     ENDPTR,                                                      0791
*     R14) UNRESTRICTED;                                           0791
*   END STAGE1;                                                    0792
@EL00005 DS    0H                                                  0792
@EF00005 DS    0H                                                  0792
@ER00005 BR    @14                                                 0792
*                                                                  0793
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION BUILDS SWAP OUT PCBS FOR IN CORE, NON FIXED      */
*   /* CHANGED PAGES OR IN CORE ZERO TCB FIXED PAGES                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0793
*WORKSET:                                                          0793
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0793
WORKSET  DS    0H                                                  0794
*   RESPECIFY                                                      0794
*    (PFTEPTR,                                                     0794
*     PCBPTR,                                                      0794
*     R14) RESTRICTED;                                             0794
*   LEV1RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV1RTN(,PVTPTR)                                0795
*   RESPECIFY                                                      0796
*    (R14) UNRESTRICTED;                                           0796
*                                                                  0796
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS LOCAL FRAME QUEUE FIRST                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0797
*   IF RSMLFQF=0 THEN               /* TEST FOR NO LOCAL FRAMES.     */
         LH    @12,RSMLFQF(,RSMHDPTR)                              0797
         N     @12,@CF02704                                        0797
         LTR   @12,@12                                             0797
         BZ    @RT00797                                            0797
*     GOTO EXITWS;                  /* ARE NO FRAMES. GO EXIT        */
*   IF NLSQAPCB=0 THEN              /* IF NO FIXED PCBS EXIT, SET  0799
*                                      NON-LSQA PTR TO NEXT AVAILABLE
*                                      PCB                   @Z40WPYC*/
         L     @12,SPCTSWRT(,SPCTPTR)                              0799
         L     @06,NLSQAPCB-1(,@12)                                0799
         LA    @06,0(,@06)                                         0799
         LTR   @06,@06                                             0799
         BNZ   @RF00799                                            0799
*     DO;                           /* NO FIXED PCB          @Z40WPYC*/
*       AIANXAIA=0;                 /* SEPARATE LSQA AIAS FROM     0801
*                                      NON-LSQA AIAS         @Z40WPYC*/
         SLR   @06,@06                                             0801
         ST    @06,AIANXAIA(,PCBPTR)                               0801
*       NLSQAPCB=NEXTPCB;           /* SET NON-LSQA PTR IN CASE A  0802
*                                      FIXED OR STAGE2 PCB IS      0802
*                                      CONSTRUCTED           @Z40WPYC*/
         MVC   NLSQAPCB(3,@12),NEXTPCB+1(PVTPTR)                   0802
*     END;                          /* END OF NO FIXED PCBS  @Z40WPYC*/
*   ELSE                                                           0804
*     ;                             /* NLSQAPCB ALREADY INITIALIZED
*                                                            @Z40WPYC*/
@RF00799 DS    0H                                                  0805
*   PFTEPTR=PVTPFTP+RSMLFQF;        /* GET THE ADDRESS OF THE FIRST
*                                      LOCAL FRAME.                  */
         LH    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0805
         N     PFTEPTR,@CF02704                                    0805
         AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0805
*   GOTO PROCPFTE;                  /* GO PROCESS THE PFTE.          */
         B     PROCPFTE                                            0806
*NEXTPFTE:                                                         0807
*   FPCALLED='0'B;                  /* INDICATE THAT FINDPAGE HAS NOT
*                                      BEEN CALLED FOR THIS FRAME. 0807
*                                      (REG0 DOES NOT CONTAIN THE  0807
*                                      PFTE ADDR AND REG 1 DOES NOT
*                                      HAVE THE XPTE ADDRESS FOR THIS
*                                      FRAME).               @Z40WPYD*/
NEXTPFTE NI    FPCALLED(PVTPTR),B'11111101'                        0807
*   PFTEPTR=PVTPFTP+PFTFQPTR;       /* GET THE ADDRESS OF THE NEXT 0808
*                                      LOCAL FRAME.                  */
*                                                                  0808
         LH    @12,PFTFQPTR(,PFTEPTR)                              0808
         N     @12,@CF02704                                        0808
         AL    @12,PVTPFTP(,PVTPTR)                                0808
         LR    PFTEPTR,@12                                         0808
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS PFTE, IF FRAME IS VIO IRREGULAR AND NO I/O IS GOING ON*/
*   /* FOR IT, FREE THE FRAME                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0809
*PROCPFTE:                                                         0809
*   IF PFTIRRG='1'B THEN            /* TEST IF AN IRREGULAR (VIO)  0809
*                                      PAGE.                         */
PROCPFTE TM    PFTIRRG(PFTEPTR),B'00010000'                        0809
         BNO   @RF00809                                            0809
*     IF PFTPCBSI='0'B THEN         /* IS AN IRREGULAR PAGE, SO TEST
*                                      THAT NO I/O IS IN PROGRESS.   */
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0810
         BNZ   @RF00810                                            0810
*       DO;                         /* FREE THE FRAME.               */
*         R0=PFTEPTR-PVTPFTP;       /* GET THE RBN OF THE PFTE.      */
         LR    R0,PFTEPTR                                          0812
         SL    R0,PVTPFTP(,PVTPTR)                                 0812
*         R0=CONSPFTER0;           /* SET UP PFTE E/D INTERFACE.    */
         O     R0,@CF02502                                         0813
*         PFTEPTR=PFTBQPTR;         /* GET THE RBN OF THE PREVIOUS 0814
*                                      PFTE, WHICH WILL HAVE RBN OF
*                                      THE NEXT PFTE TO DO.          */
         LH    @12,PFTBQPTR(,PFTEPTR)                              0814
         N     @12,@CF02704                                        0814
         LR    PFTEPTR,@12                                         0814
*         CALL IEAVPFTE;            /* CALL PFTE ENQ/DEQ TO FREE THE
*                                      IRREGULAR FRAME.              */
*                                                                  0815
         L     @15,PVTPFTE(,PVTPTR)                                0815
         BALR  @14,@15                                             0815
*         /***********************************************************/
*         /*                                                         */
*         /* ADJUST PFTEPTR TO NEXT PFTE                             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0816
*         IF PFTEPTR=0 THEN         /* TEST IF THE FREED PFTE WAS THE
*                                      FIRST ON THE QUEUE.           */
         LTR   PFTEPTR,PFTEPTR                                     0816
         BNZ   @RF00816                                            0816
*           PFTEPTR=ADDR(RSMLFQF)-LENGTH(PFTPGID);/* FREED THE FIRST
*                                      ON THE QUEUE SO MUST GET THE
*                                      NEW FIRST PFTE.               */
         LA    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0817
         SL    PFTEPTR,@CF00039                                    0817
*         ELSE                      /* THE FREED PFTE IS NOT THE   0818
*                                      FIRST, SO THE SAVED BACKWARD
*                                      RBN IS THE NEXT PFTE TO DO.   */
*           PFTEPTR=PVTPFTP+PFTEPTR;/* GET THE PREVIOUS PFTE. HAS THE
*                                      NEXT PFTE TO DO.              */
         B     @RC00816                                            0818
@RF00816 AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0818
*         GOTO TESTRBN;             /* GO PROCESS THE NEXT LOCAL   0819
*                                      FRAME.                        */
         B     TESTRBN                                             0819
*       END;                        /* END FREEING IRREG FRAME.      */
*     ELSE                          /* I/O IS IN PROGRESS. DO NOT  0821
*                                      FREE FRAME.                   */
*       GOTO TESTRBN;               /* GO PROCESS THE NEXT PFTE.     */
*   ELSE                                                           0822
*     ;                             /* END IRREGULAR PAGE PROCESSING.*/
@RF00809 DS    0H                                                  0823
*                                                                  0823
*   /*****************************************************************/
*   /*                                                               */
*   /* FRAME IS NOT VIO IRREGULAR, IS A PCB DEFINED FOR THIS FRAME   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0823
*   IF PFTPCBSI='1'B THEN           /* TEST IF A PCB IS DEFINED FOR
*                                      THE FRAME.                    */
*                                                                  0823
         TM    PFTPCBSI(PFTEPTR),B'00001000'                       0823
         BNO   @RF00823                                            0823
*     /***************************************************************/
*     /*                                                             */
*     /* A PCB IS DEFINED, SO EITHER I/O WAS PURGED AND NOT YET      */
*     /* COMPLETE OR THE PAGE IS FIXED AND THE STAGE1 PROCESSOR BUILT*/
*     /* A SWAP OUT PCB. THE PAGE DOES NOT NEED TO BE SWAPPED OUT BY */
*     /* THIS PROCESSOR. TEST IF THERE ARE FIXES STILL IN THE FRAME. */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0824
*     IF PFTFXCT^=0 THEN                                           0824
         LH    @12,PFTFXCT(,PFTEPTR)                               0824
         LTR   @12,@12                                             0824
         BZ    @RF00824                                            0824
*       DO;                         /* ARE FIXES IN THE FRAME STILL.
*                                      CAN ONLY BE 0-TCB FIXES WHICH
*                                      DID NOT HAVE A FOE AND THE PCB
*                                      EITHER WAS BUILT BY FIXENTRY
*                                      OR WAS A ZERO TCB FIX FOR   0825
*                                      WHICH PIOPURGE COULD NOT MAKE
*                                      A FIX ENTRY.                  */
*         RESPECIFY                                                0826
*          (R1,                                                    0826
*           SWAPPTR) RESTRICTED;                                   0826
*                                                                  0826
*         /***********************************************************/
*         /*                                                         */
*         /* IF FRAME IS NOT VALID IT IS A ZERO TCB FIX FOR WHICH    */
*         /* PIOPURGE WAS UNABLE TO MAKE A FIX ENTRY. FRAME WILL BE  */
*         /* VALIDATED WHEN I/O COMPLETES AND IOCP RUNS. ROOT PCB    */
*         /* PROCESSING WAS NOT DONE                                 */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0827
*         LRAREG=PFTVBN*256;        /* GET RSA                       */
         LH    LRAREG,PFTVBN(,PFTEPTR)                             0827
         N     LRAREG,@CF02704                                     0827
         SLA   LRAREG,8                                            0827
*         GEN CODE REFS(LRAREG) SETS(LRAREG) FLOWS(TESTRBN);       0828
         LRA LRAREG,0(LRAREG)       GET REAL ADDRESS
         BC  2,TESTRBN              GET NEXT PFTE IF PGTE INVALID
*         R1=PFTVBN;                /* GET THE VBN OF THE PAGE.      */
         LH    R1,PFTVBN(,PFTEPTR)                                 0829
         N     R1,@CF02704                                         0829
*         CALL GETFIX;              /* GET THE SPCT FIX ENTRY.       */
*                                                                  0830
         BAL   @14,GETFIX                                          0830
*         /***********************************************************/
*         /*                                                         */
*         /* IF RETURN CODE IS NOT ZERO, A SERIOUS ERROR SUCH AS THE */
*         /* SPCT OR PVT BEING CLOBBERED HAS OCCURED, THE VBN SHOULD */
*         /* HAVE BEEN THERE. ALTHOUGH FIX COUNTS FOR THIS FRAME ARE */
*         /* IN 2 PLACES (THE PFTE AND THE MISSING SPCT ENTRY)       */
*         /* PROCESSING CONTINUES WITH THE NEXT PFTE.                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0831
*         IF RETNCODE=0 THEN                                       0831
         SLR   @06,@06                                             0831
         C     @06,RETNCODE(,PVTPTR)                               0831
         BNE   @RF00831                                            0831
*           DO;                                                    0832
*             IF SPCTFIXC=0 THEN    /* WAS A NEW ENTRY CREATED       */
         CH    @06,SPCTFIXC(,SWAPPTR)                              0833
         BNE   @RF00833                                            0833
*               DO;                                                0834
*                 R0='15'X;         /* AN ENTRY SHOULD HAVE BEEN   0835
*                                      THERE. RECORD THE ERROR AND 0835
*                                      HOPE.                         */
         LA    R0,21                                               0835
*                 CALL DOABEND;     /* RECORD ERROR                  */
         BAL   @14,DOABEND                                         0836
*               END;                                               0837
*             SPCTFIXC=SPCTFIXC+PFTFXCT;/* ADD THE 0-TCB FIXES TO THE
*                                      TOTAL FIX COUNT IN THE SPCT.  */
@RF00833 LH    @06,SPCTFIXC(,SWAPPTR)                              0838
         AH    @06,PFTFXCT(,PFTEPTR)                               0838
         STH   @06,SPCTFIXC(,SWAPPTR)                              0838
*             RSMCNTFX=RSMCNTFX-1;  /* DECREMENT FIX COUNT FOR THIS
*                                      ADDRESS SPACE         @YA01572*/
         LH    @06,RSMCNTFX(,RSMHDPTR)                             0839
         BCTR  @06,0                                               0839
         STH   @06,RSMCNTFX(,RSMHDPTR)                             0839
*             PVTCNTFX=PVTCNTFX-1;  /* DECREMENT THE SYSTEM FIX COUNT
*                                                            @YA01572*/
         LH    @06,PVTCNTFX(,PVTPTR)                               0840
         BCTR  @06,0                                               0840
         STH   @06,PVTCNTFX(,PVTPTR)                               0840
*             PFTFXCT=0;            /* ZERO THE PFTE FIX COUNT.      */
         SLR   @06,@06                                             0841
         STH   @06,PFTFXCT(,PFTEPTR)                               0841
*           END;                                                   0842
*         ELSE                      /* TRIED TO CREATE NEW ENTRY     */
*           DO;                                                    0843
         B     @RC00831                                            0843
@RF00831 DS    0H                                                  0844
*             R0='15'X;             /* AN ATTEMPT WAS MADE TO CREATE
*                                      A NEW ENTRY BUT THE ATTEMPT 0844
*                                      FAILED AN EXISTING ENTRY    0844
*                                      SHOULD HAVE BEEN THERE        */
         LA    R0,21                                               0844
*             CALL DOABEND;         /* RECORD ERROR                  */
         BAL   @14,DOABEND                                         0845
*             RETNCODE=0;           /* CLEAR RETURN CODE             */
         SLR   @06,@06                                             0846
         ST    @06,RETNCODE(,PVTPTR)                               0846
*           END;                                                   0847
*         RESPECIFY                                                0848
*          (R1,                                                    0848
*           SWAPPTR) UNRESTRICTED;                                 0848
@RC00831 DS    0H                                                  0849
*       END;                        /* END 0-TCB PROC. GET NEXT PFTE.*/
*     ELSE                                                         0850
*       ;                           /* PAGING I/O WAS PURGED, OR   0850
*                                      THERE WERE NO ZERO TCB FIXES
*                                      SO DO NOT SWAP OUT THE PAGE.
*                                      GET NEXT PFTE.                */
@RF00824 DS    0H                                                  0851
*                                                                  0851
*   /*****************************************************************/
*   /*                                                               */
*   /* NO PCB DEFINED, SO THE PAGE IS IN CORE. HAVE WORK TO DO.      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0851
*   ELSE                                                           0851
*     DO;                                                          0851
         B     @RC00823                                            0851
@RF00823 DS    0H                                                  0852
*       RFY                                                        0852
*        (R1,                                                      0852
*         R4,                                                      0852
*         SWAPPTR) RSTD;                                           0852
*       IF PFTFXCT=0 THEN           /* TEST FOR AN IN CORE, NON-FIXED
*                                      PAGE.                         */
         LH    @06,PFTFXCT(,PFTEPTR)                               0853
         LTR   @06,@06                                             0853
         BNZ   @RF00853                                            0853
*         DO;                       /* IN CORE, NON-FIXED PAGE. MAY
*                                      BE PART OF THE WORKING SET.   */
*           RESPECIFY                                              0855
*            (R15) RESTRICTED;                                     0855
*           R1=PFTVBN*256;          /* GET THE VSA FROM THE VBN.     */
         LH    R1,PFTVBN(,PFTEPTR)                                 0856
         N     R1,@CF02704                                         0856
         SLA   R1,8                                                0856
*           CALL IEAVFP2;           /* CALL FINDPAGE TO GET THE PGTE
*                                      AND XPTE ADDRESSES.           */
         L     @15,PVTPFP2(,PVTPTR)                                0857
         BALR  @14,@15                                             0857
*           IF R15^=0 THEN          /* TEST FOR A BAD RETURN CODE.   */
         LTR   R15,R15                                             0858
         BZ    @RF00858                                            0858
*             DO;                   /* INTERNAL ERROR IF BAD RETURN
*                                      CODE. PAGE AND SEGMENT MUST BE
*                                      VALID IF THERE IS A FRAME   0859
*                                      ASSIGNED.                     */
*               R0='01'X;           /* RECORD FINDPAGE FAILURE       */
         LA    R0,1                                                0860
*               CALL DOABEND;       /* RECORD THE ERROR              */
         BAL   @14,DOABEND                                         0861
*               GO TO TESTRBN;      /* GO DO NEXT FRAME THIS FRAME 0862
*                                      REMAINS IN STORAGE            */
         B     TESTRBN                                             0862
*             END;                                                 0863
*           RESPECIFY                                              0864
*            (R15) UNRESTRICTED;                                   0864
*                                                                  0864
@RF00858 DS    0H                                                  0865
*           /*********************************************************/
*           /*                                                       */
*           /* TEST IF AUX STORAGE DOES NOT NEED TO BE SAVED. IF NOT */
*           /* TO BE SAVED AND PAGE NOT CHANGED, CAN FREE FRAME      */
*           /* WITHOUT HAVING TO SWAP OUT.                           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0865
*           IF R1->XPTVIOLP='0'B THEN                              0865
         TM    XPTVIOLP(R1),B'10000000'                            0865
         BNZ   @RF00865                                            0865
*             DO;                   /* DO NOT SAVE AUX. SEE IF PAGE
*                                      IS CHANGED.           @Z40WPYC*/
*               TEMPSAVE=R1;        /* SAVE REG 1.                   */
         ST    R1,TEMPSAVE(,PVTPTR)                                0867
*               R1=R0;              /* GET THE PGTE ADDRESS TO GET 0868
*                                      RBN.                          */
         LR    R1,R0                                               0868
*               R1=R1->PGTRSA;      /* GET THE RBN.                  */
*                                                                  0869
         SLR   @06,@06                                             0869
         ICM   @06,3,PGTRSA(R1)                                    0869
         LR    R1,@06                                              0869
*               /*****************************************************/
*               /*                                                   */
*               /* GET RSA AND CHECK CHANGE BITS.                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0870
*               GENERATE CODE FLOWS(DOMASK,DOMASKA,NCHANGE1,REF1S2K);
*                                                      /* YM04950*/
         SRL   R1,4            CLEAR FLAG BITS
         SLL   R1,12           GET RSA FROM RBN
         RRB   0(R1)           CHECK FOR CHANGE IN FIRST 2K
         BC    1,DOMASKA       1ST 2K REFERENCED AND CHANGED
         BC    8,NCHANGE1      1ST 2K NOT REFERENCED OR CHANGED
         BC    2,REF1S2K       1ST 2K REFERENCED BUT NOT CHANGED
         RRB   2048(R1)        1ST 2K UNREFED BUT CHANGED CK 2ND 2K
         BC    3,DOMASKA       FRAME IS REFERENCED AND CHANGED
         B     DOMASK          FRAME IS CHANGED BUT NOT REFERENCED
*REF1S2K:                                                          0871
*               PFTUIC='FF'X;       /* 1ST 2K WAS REFERENCED AND NOT
*                                      CHANGED YM04950               */
REF1S2K  MVI   PFTUIC(PFTEPTR),X'FF'                               0871
*NCHANGE1:                                                         0872
*               GEN CODE FLOWS(DOMASK,DOMASKA,ZEROZERO);           0872
NCHANGE1 DS    0H                                                  0872
*                                                       /*  YM04950*/
         RRB   2048(R1)        CK 2ND 2K
         BC    1,DOMASKA       2ND 2K IS REFERENCED AND CHANGED
         BC    4,DOMASK        2ND 2K IS NOT REFERENCED BUT IS CHANGED
         BC    8,ZEROZERO      2ND 2K IS NOT REFERENCED OR CHANGED
*               PFTUIC='FF'X;       /* FRAME WAS REFERENCED AND NOT
*                                      CHANGED                YM04950*/
         MVI   PFTUIC(PFTEPTR),X'FF'                               0873
*ZEROZERO:                                                         0874
*               R1=TEMPSAVE;        /* GET XPT ADDRESS        YM04950*/
ZEROZERO L     R1,TEMPSAVE(,PVTPTR)                                0874
*               R4=R0;              /* GET THE PGTE ADDRESS          */
         LR    R4,R0                                               0875
*               R0=CONSPFTE;        /* PFTE TO FRONT OF AVAILABLE  0876
*                                      FRAME Q               @Z40WPYC*/
         L     R0,@CF02502                                         0876
*               IF(PFTUIC<OUXBSTCPFTUIC='FF'X)&R1->XPTXAV='1'B THEN
         L     @06,ASCBPTR                                         0877
         L     @06,OUXBPTR(,@06)                                   0877
         SLR   @05,@05                                             0877
         IC    @05,PFTUIC(,PFTEPTR)                                0877
         CH    @05,OUXBSTC(,@06)                                   0877
         BL    @GL00014                                            0877
         CLI   PFTUIC(PFTEPTR),255                                 0877
         BNE   @RF00877                                            0877
@GL00014 TM    XPTXAV(R1),B'01000000'                              0877
         BNO   @RF00877                                            0877
*                                   /* DETERMINE IF THE FRAME SHOULD
*                                      BE STOLEN. CHECK FOR A FIRST
*                                      REFERENCE CASE SO SWIN WILL 0878
*                                      NOT TRY TO PAGE-IN A PAGE   0878
*                                      WHICH WAS NEVER PAGED OUT   0878
*                                                             YM04950*/
*                 DO;               /*                        YM04950*/
*                   R1=PFTVBN;      /* GET VBN FOR SETMASK    YM04950*/
         LH    R1,PFTVBN(,PFTEPTR)                                 0879
         N     R1,@CF02704                                         0879
*                   CALL SETMASK;   /* GO SET MASK BIT        YM04950*/
         BAL   @14,SETMASK                                         0880
*                   R0=0;           /* PFTE TO BACK OF AFQ   @Z40WPYC*/
         SLR   R0,R0                                               0881
*                 END;              /*                        YM04950*/
*               R1=PFTEPTR-PVTPFTP; /* GET RBN AGAIN YM04950         */
*                                                                  0883
@RF00877 LR    R1,PFTEPTR                                          0883
         SL    R1,PVTPFTP(,PVTPTR)                                 0883
*               /*****************************************************/
*               /*                                                   */
*               /* IF HERE, PAGE IS UNCHANGED AND FRAME CAN BE FREED */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0884
*               R0=R1R0;           /* SET UP PFTE INTERFACE @Z40WPYC*/
         OR    R0,R1                                               0884
*               PFTEPTR=PFTBQPTR;   /* GET THE RBN OF THE PREVIOUS 0885
*                                      PFTE, WHICH WILL HAVE RBN OF
*                                      THE NEXT PFTE TO DO.          */
*                                                                  0885
         LH    @06,PFTBQPTR(,PFTEPTR)                              0885
         N     @06,@CF02704                                        0885
         LR    PFTEPTR,@06                                         0885
*               /*****************************************************/
*               /*                                                   */
*               /* IF A BIT MARK ENTRY IS MADE, THE PFTE IS MOVED TO */
*               /* THE BACK OF THE AFQ IN ORDER THAT RECLAIM WILL    */
*               /* HAVE A BETTER CHANCE OF SUCCESS DURING SWAPIN     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0886
*               CALL IEAVPFTE;      /* CALL PFTE ENQ/DEQ TO FREE THE
*                                      FRAME.                        */
         L     @15,PVTPFTE(,PVTPTR)                                0886
         BALR  @14,@15                                             0886
*               IF PFTEPTR=0 THEN   /* TEST IF THE FREED PFTE WAS THE
*                                      FIRST ON THE QUEUE.           */
         LTR   PFTEPTR,PFTEPTR                                     0887
         BNZ   @RF00887                                            0887
*                 PFTEPTR=ADDR(RSMLFQF)-LENGTH(PFTPGID);/* SET UP THE
*                                      FIRST PFTE.                   */
         LA    PFTEPTR,RSMLFQF(,RSMHDPTR)                          0888
         SL    PFTEPTR,@CF00039                                    0888
*               ELSE                /* THE FREED PFTE IS NOT THE   0889
*                                      FIRST, SO THE SAVED BACKWARD
*                                      RBN IS THE NEXT PFTE TO DO.   */
*                 PFTEPTR=PVTPFTP+PFTEPTR;/* GET THE PREVIOUS PFTE.  */
         B     @RC00887                                            0889
@RF00887 AL    PFTEPTR,PVTPFTP(,PVTPTR)                            0889
*               GOTO INVALPGT;      /* GO INVALIDATE THE PGTE AND  0890
*                                      PROCESS THE NEXT LOCAL FRAME. */
*                                                                  0890
         B     INVALPGT                                            0890
*               /*****************************************************/
*               /*                                                   */
*               /* PAGE WAS CHANGED, INITIALIZE A PCB, SET BIT MASK  */
*               /* AND INVALIDATE PGTE                               */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0891
*DOMASKA:                                                          0891
*               PFTUIC='FF'X;       /* SET UIC TO ZERO SO FRAME WILL
*                                      NOT BE STOLEN          YM04950*/
DOMASKA  MVI   PFTUIC(PFTEPTR),X'FF'                               0891
*DOMASK:                                                           0892
*               R1=TEMPSAVE;        /* RESTORE REG 1.                */
DOMASK   L     R1,TEMPSAVE(,PVTPTR)                                0892
*             END;                                                 0893
*           ELSE                                                   0894
*             ;                     /* AUX STORAGE MUST BE SAVED, SO
*                                      SWAP OUT THE PAGE.    @Z40WPYC*/
@RF00865 DS    0H                                                  0895
*           FPCALLED='1'B;          /* INDICATE FINDPAGE WAS CALLED
*                                      FOR THIS FRAME. (R0 & R1    0895
*                                      CONTAIN THE PGTE AND XPTE   0895
*                                      ADDRESS, RESPECTIVELY.)     0895
*                                                            @Z40WPYD*/
         OI    FPCALLED(PVTPTR),B'00000010'                        0895
*           CALL INITPCB;           /* INITIALIZE A PCB TO SWAP OUT
*                                      THE PAGE. WE MAY RUN OUT OF 0896
*                                      PCBS                          */
*                                                                  0896
         BAL   @14,INITPCB                                         0896
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO MORE PCBS WERE AVAILABLE THE FRAME IS LEFT VALID*/
*           /* ON THE LOCAL FRAME QUEUE AND WILL STILL BE VALID AND  */
*           /* IN STORAGE AT SWAPIN TIME.                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0897
*           IF RETNCODE^=0 THEN                                    0897
         SLR   @06,@06                                             0897
         C     @06,RETNCODE(,PVTPTR)                               0897
         BE    @RF00897                                            0897
*             DO;                                                  0898
*               RETNCODE=0;         /* CLEAR RETURN CODE             */
         ST    @06,RETNCODE(,PVTPTR)                               0899
*               GO TO TESTRBN;      /* GO DO NEXT PFTE               */
         B     TESTRBN                                             0900
*             END;                                                 0901
*           R1->XPTXAV='1'B;        /* SET AUX VALID FLAG            */
@RF00897 OI    XPTXAV(R1),B'01000000'                              0902
*           R4=R0;                  /* SAVE PGTE ADDRESS             */
         LR    R4,R0                                               0903
*           IF PFTUIC<OUXBSTCPFTUIC='FF'X THEN/* TEST IF PFTE IS NOT
*                                      TO BE STOLEN. IF NOT, SET BIT
*                                      MASK IN ORDER TO SWAP IN THE
*                                      PAGE. YM06031                 */
         L     @06,ASCBPTR                                         0904
         L     @06,OUXBPTR(,@06)                                   0904
         SLR   @05,@05                                             0904
         IC    @05,PFTUIC(,PFTEPTR)                                0904
         CH    @05,OUXBSTC(,@06)                                   0904
         BL    @RT00904                                            0904
         CLI   PFTUIC(PFTEPTR),255                                 0904
         BNE   @RF00904                                            0904
@RT00904 DS    0H                                                  0905
*             DO;                                                  0905
*               R1=PFTVBN;          /* SET UP VBN TO SET BIT MASK.   */
         LH    R1,PFTVBN(,PFTEPTR)                                 0906
         N     R1,@CF02704                                         0906
*               CALL SETMASK;       /* CALL SUBROUTINE TO SET THE BIT
*                                      MASK FOR THE WORKING SET PAGE.*/
         BAL   @14,SETMASK                                         0907
*             END;                                                 0908
*INVALPGT:                                                         0909
*           R4->PGTPVM='1'B;        /* INVALIDATE PAGE.ITHE PTLB IS
*                                      DONE BY SWPC.         @Z40WPYC*/
@RF00904 DS    0H                                                  0909
INVALPGT OI    PGTPVM(R4),B'00001000'                              0909
*         END;                                                     0910
*                                                                  0911
*       /*************************************************************/
*       /*                                                           */
*       /* NO PCB DEFINED AND FIX COUNT IS NOT ZERO. MUST HAVE BEEN  */
*       /* AN IN CORE PAGE WITH ONLY 0-TCB FIXES. GET A PCB, CREATE A*/
*       /* SPCT FIX ENTRY AND IF BOTH SUCCEED INITIALIZE THE PCB TO  */
*       /* PAGE OUT THE FRAME                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0911
*       ELSE                                                       0911
*         DO;                                                      0911
*                                                                  0911
         B     @RC00853                                            0911
@RF00853 DS    0H                                                  0912
*           /*********************************************************/
*           /*                                                       */
*           /* SINCE THE ADDITION OF STORAGE ERROR PROCESSING IN     */
*           /* ROUTINE STAGE1, TCB MODE FIXES FOR BAD FRAMES(PFTBADPG*/
*           /* = 1) WILL GET HERE WITH A NONZERO PFTE FIX COUNT - IN */
*           /* ANY EVENT THE CODE IN ROUTINE INITPCB DEPENDS UPON    */
*           /* THIS CALL TO IT FROM WORKSET BEING AHEAD OF THE       */
*           /* CREATION OF A SPCT FIX ENTRY AND THE DECREMENTING OF  */
*           /* THE PFTE FIX COUNT SINCE THE FRAME WILL BE SKIPPED    */
*           /* WHEN PFTBADPG IS ON.                          @ZA19960*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0912
*           CALL INITPCB;           /* CALL SUBROUTINE TO INITIALIZE
*                                      A SWAP OUT PCB FOR THE IN CORE
*                                      FIX.                          */
         BAL   @14,INITPCB                                         0912
*           IF RETNCODE^=0 THEN     /* CHECK RETURN CODE             */
         SLR   @06,@06                                             0913
         C     @06,RETNCODE(,PVTPTR)                               0913
         BE    @RF00913                                            0913
*             DO;                                                  0914
*               RETNCODE=0;         /* CLEAR RETURN CODE RAN OUT OF
*                                      PCBS                          */
         ST    @06,RETNCODE(,PVTPTR)                               0915
*               GO TO TESTRBN;      /* GO DO NEXT FRAME              */
         B     TESTRBN                                             0916
*             END;                                                 0917
*           R4=R1;                  /* SAVE XPTE ADDR        @Z40WPYC*/
@RF00913 LR    R4,R1                                               0918
*           R1=PFTVBN;              /* GET VBN FOR GETFIX            */
         LH    R1,PFTVBN(,PFTEPTR)                                 0919
         N     R1,@CF02704                                         0919
*           CALL GETFIX;            /* GET FIX ENTRY                 */
*                                                                  0920
         BAL   @14,GETFIX                                          0920
*           /*********************************************************/
*           /*                                                       */
*           /* IF WE COULD NOT MAKE ENTRY IN SPCT FOR THIS ZERO TCB  */
*           /* FIXED FRAME, RESET THE WORK DONE BY INITPCB. NOTE THAT*/
*           /* IT IS NOT NECESSARY TO ZERO PCBPGTA AND PCBXPTA SINCE */
*           /* THESE FIELDS ARE ALWAYS INIT IN PRIVATE AREA PCB'S    */
*           /* (LSQA PCB'S HAVE ALREADY BEEN CONSTRUCTED).           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0921
*           IF RETNCODE^=0 THEN                                    0921
         SLR   @06,@06                                             0921
         C     @06,RETNCODE(,PVTPTR)                               0921
         BE    @RF00921                                            0921
*             DO;                                                  0922
*               PFTPCBSI='0'B;      /* PCB JUST BUILT WILL NOT BE  0923
*                                      USED FIXED FRAME REMAINS IN 0923
*                                      STORAGE                       */
         NI    PFTPCBSI(PFTEPTR),B'11110111'                       0923
*               ROOTCNT=ROOTCNT-1;  /* DECREMENT ROOT COUNT          */
         LH    @05,ROOTCNT(,PVTPTR)                                0924
         BCTR  @05,0                                               0924
         STH   @05,ROOTCNT(,PVTPTR)                                0924
*               NEXTPCB=PCBPTR;     /* BACK UP POINTER BY 1 PCB      */
         ST    PCBPTR,NEXTPCB(,PVTPTR)                             0925
*               RETNCODE=0;         /* CLEAR RETURN CODE             */
         ST    @06,RETNCODE(,PVTPTR)                               0926
*             END;                                                 0927
*           ELSE                    /* MADE ENTRY CORRECTLY          */
*             DO;                                                  0928
         B     @RC00921                                            0928
@RF00921 DS    0H                                                  0929
*               PCBSPCTE=SWAPPTR;   /* INIT PTR TO SPCTE FOR ASM   0929
*                                                            @Z40WPYC*/
         ST    SWAPPTR,PCBSPCTE(,PCBPTR)                           0929
*               AIASWPFX='1'B;      /* INDICATE PRIVATE AREA FIX SWAP
*                                      PAGE                  @Z40WPYC*/
         OI    AIASWPFX(PCBPTR),B'00000010'                        0930
*               R4->XPTXAV='1'B;    /* INDICATE SAVE AUX STORAGE   0931
*                                                            @Z40WPYC*/
         OI    XPTXAV(R4),B'01000000'                              0931
*               SPCTFIXC=PFTFXCT;   /* MAKE FIX ENTRY                */
         LH    @06,PFTFXCT(,PFTEPTR)                               0932
         STH   @06,SPCTFIXC(,SWAPPTR)                              0932
*               RSMCNTFX=RSMCNTFX-1;/* DECREMENT FIX COUNT FOR THIS
*                                      ADDRESS SPACE         @YA01572*/
         LH    @06,RSMCNTFX(,RSMHDPTR)                             0933
         BCTR  @06,0                                               0933
         STH   @06,RSMCNTFX(,RSMHDPTR)                             0933
*               PVTCNTFX=PVTCNTFX-1;/* DECREMENT THE SYSTEM FIX    0934
*                                      COUNT@YA01572                 */
         LH    @06,PVTCNTFX(,PVTPTR)                               0934
         BCTR  @06,0                                               0934
         STH   @06,PVTCNTFX(,PVTPTR)                               0934
*               PFTFXCT=0;          /* CLEAR FIX COUNT IN PFTE       */
         SLR   @06,@06                                             0935
         STH   @06,PFTFXCT(,PFTEPTR)                               0935
*               IF PFTDFRLS='1'B THEN/* IS FRAME DEFERED RELEASE     */
         TM    PFTDFRLS(PFTEPTR),B'10000000'                       0936
         BNO   @RF00936                                            0936
*                 SPCTDEFR='1'B;    /* SET DEFER RELEASE FLAG IN SPCT*/
         OI    SPCTDEFR(SWAPPTR),B'00010000'                       0937
*             END;                                                 0938
@RF00936 DS    0H                                                  0939
*         END;                                                     0939
@RC00921 DS    0H                                                  0940
*       RESPECIFY                                                  0940
*        (R1,                                                      0940
*         R4,                                                      0940
*         SWAPPTR) UNRESTRICTED;                                   0940
@RC00853 DS    0H                                                  0941
*     END;                                                         0941
*TESTRBN:                                                          0942
*   IF PFTFQPTR^=0 THEN             /* TEST IF THERE ARE ANY MORE  0942
*                                      LOCAL FRAMES TO PROCESS.      */
@RC00823 DS    0H                                                  0942
TESTRBN  LH    @12,PFTFQPTR(,PFTEPTR)                              0942
         N     @12,@CF02704                                        0942
         LTR   @12,@12                                             0942
         BNZ   @RT00942                                            0942
*     GOTO NEXTPFTE;                /* ARE MORE. GO DO THEM.         */
*                                                                  0943
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT WORKING SET PROCESSOR                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0944
*EXITWS:                                                           0944
*   RESPECIFY                                                      0944
*    (R14) RESTRICTED;                                             0944
EXITWS   DS    0H                                                  0945
*   R14=LEV1RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV1RTN(,PVTPTR)                                0945
*   RESPECIFY                                                      0946
*    (R14,                                                         0946
*     PFTEPTR) UNRESTRICTED;                                       0946
*   END WORKSET;                                                   0947
@EL00006 DS    0H                                                  0947
@EF00006 DS    0H                                                  0947
@ER00006 BR    @14                                                 0947
*                                                                  0948
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE RECEIVES AS INPUT THE ADDRESS OF A PCB FOR THE   */
*   /* ADDRESS SPACE BEING SWAPPED OUT.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0948
*PCBPROC:                                                          0948
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0948
PCBPROC  DS    0H                                                  0949
*   RFY                                                            0949
*    (R4,                                                          0949
*     R5,                                                          0949
*     R6) RSTD;                                                    0949
*   RFY                                                            0950
*     PCBR BASED(PCBRTPA);                                         0950
*   RFY                                                            0951
*    (R14) RSTD;                                                   0951
*   LEV2RTN=R14;                    /* SAVE RETURN ADDRESS           */
         ST    R14,LEV2RTN(,PVTPTR)                                0952
*   RFY                                                            0953
*    (R14) UNRSTD;                                                 0953
*   IF NOSPCTE='1'B THEN            /* IS ECB OUT OF STORAGE OR IS IT
*                                      FIRST REFERENCE CASE  @YM02790*/
         TM    NOSPCTE(PVTPTR),B'00000100'                         0954
         BO    @RT00954                                            0954
*     GO TO REPAIRFX;               /* GO REMOVE FIX FROM SPCT     0955
*                                                            @YM02790*/
*   KEEPPCB='0'B;                   /* SET FLAG TO INDICATE THE PCB
*                                      CAN BE FREED BY PIOPURGE. THE
*                                      FLAG WILL BE ONE IF PCB IS  0956
*                                      COMMON AREA FOR WHICH I/O IS
*                                      NOT COMPLETE AND FOR PRIVATE
*                                      AREA ZERO TCB FIX I/O NOT   0956
*                                      COMPLETE FOR WHICH GETFIX WAS
*                                      UNABLE TO MAKE A FIX ENTRY    */
*                                                                  0956
         NI    KEEPPCB(PVTPTR),B'11101111'                         0956
*   /*****************************************************************/
*   /*                                                               */
*   /* IS PCB FOR A PAGE FAULT. THERE SHOULD BE NO SRBMD PCBS LEFT ON*/
*   /* THE QUEUE AS A RESULT OF (A) THE STATUS STOP OF QUIESSABLE    */
*   /* SRBS DONE BY REGION CONTROL TASK PRIOR TO CALLING SWAP OUT AND*/
*   /* (B) THE STATUS STOP OF NON QUIESSABLE SRBS DONE BY SWAP OUT.  */
*   /* ALSO THERE SHOULD BE NO LOCKED TCBS AS A RESULT OF THE STATUS */
*   /* STOP TCB DONE BY REGION CONTROL TASK PRIOR TO CALLING SWAP    */
*   /* OUT.                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0957
*   IF PCBRESET='1'B THEN                                          0957
         TM    PCBRESET(PCBPTR),B'00010000'                        0957
         BNO   @RF00957                                            0957
*     DO;                                                          0958
*       IF PCBSRBMD='1'B THEN       /* IF PCB IS FOR SRB THEN PREPARE
*                                      R4 AND R5 TO SHOW SRB. IF PCB
*                                      IS FOR RB THEN PREPARE R4 AND
*                                      R5 TO SHOW RB                 */
         TM    PCBSRBMD(PCBPTR),B'00100000'                        0959
         BNO   @RF00959                                            0959
*         DO;                                                      0960
*           R4=PCBSRB;              /* ADDRESS OF SRB FOR RESET      */
         L     R4,PCBSRB(,PCBPTR)                                  0961
*           R5=0;                   /* ZERO INDICATES SRB            */
         SLR   R5,R5                                               0962
*         END;                                                     0963
*       ELSE                        /* NOT SRB MODE                  */
*         DO;                                                      0964
         B     @RC00959                                            0964
@RF00959 DS    0H                                                  0965
*           R4=PCBRTPA;             /* R4 GETS TCB ADDR FOR NON-SRB
*                                      PCBS                          */
         L     R4,PCBRTPA-1(,PCBPTR)                               0965
         LA    R4,0(,R4)                                           0965
*           R5=PCBRB;               /* R5 GETS RB ADDRESS PCBSRB   0966
*                                      CONTAINS THE RB ADDRESS IF  0966
*                                      RESET IS ON AND SRBMD IS OFF
*                                                            @Z40WPYC*/
         L     R5,PCBRB(,PCBPTR)                                   0966
*         END;                                                     0967
*       IF PCBIOERR='0'B THEN       /* WAS THERE AN I/O ERROR        */
@RC00959 TM    PCBIOERR(PCBPTR),B'00100000'                        0968
         BNZ   @RF00968                                            0968
*         R6=0;                     /* SIGNAL SUCCESSFUL COMPLETION
*                                      EVEN THOUGH PAGE IN MAY NOT 0969
*                                      HAVE COMPLETED                */
         SLR   R6,R6                                               0969
*       ELSE                        /* I/O ERROR OCCURED             */
*         DO;                                                      0970
         B     @RC00968                                            0970
@RF00968 DS    0H                                                  0971
*           R6=4;                   /* SIGNAL ERROR COMPLETION       */
         LA    R6,4                                                0971
*           MASKFLG='0'B;           /* PAGE SUFFERED I/O ERROR ON  0972
*                                      PAGE IN, DO NOT BRING IN AS 0972
*                                      STAGE 2 PAGE                  */
         NI    MASKFLG(PVTPTR),B'11011111'                         0972
*         END;                                                     0973
*       R13=ADDR(PVTSAVE);          /* SAVE AREA ADDRESS             */
@RC00968 LA    R13,PVTSAVE(,PVTPTR)                                0974
*       CALL IEAVRSET;              /* RESET PAGE FAULTER            */
         L     @15,PVTPRSET(,PVTPTR)                               0975
         BALR  @14,@15                                             0975
*       PCBRESET='0'B;              /* TURN RESET FLAG OFF, THIS   0976
*                                      MAKES PCB LOOK LIKE A LOAD IN
*                                      CASE I/O IS NOT YET COMPLETE. */
         NI    PCBRESET(PCBPTR),B'11101111'                        0976
*       SPCTPURG='1'B;              /* SOME PAGING WAS PURGED        */
         OI    SPCTPURG(SPCTPTR),B'00100000'                       0977
*       RFY                                                        0978
*        (R6) UNRSTD;                                              0978
*       GO TO GOBACK;               /* EXIT FROM SUBROUTINE  @YM07609*/
         B     GOBACK                                              0979
*     END;                                                         0980
*                                                                  0981
*   /*****************************************************************/
*   /*                                                               */
*   /* DOES THE PCB HAVE A ROOT                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0981
*   IF PCBROOT='1'B THEN                                           0981
@RF00957 TM    PCBROOT(PCBPTR),B'00000100'                         0981
         BNO   @RF00981                                            0981
*     DO;                                                          0982
*       IF PCBIOERR='1'B THEN       /* DID THE I/O FAIL              */
         TM    PCBIOERR(PCBPTR),B'00100000'                        0983
         BNO   @RF00983                                            0983
*         PCBRFAIL='1'B;            /* SET ROOT FAIL BIT IN THE    0984
*                                      FIX/LOAD ROOT IF I/O IS     0984
*                                      COMPLETE AND FAILED           */
*                                                                  0984
         L     @01,PCBRTPA-1(,PCBPTR)                              0984
         OI    PCBRFAIL(@01),B'00001000'                           0984
*       /*************************************************************/
*       /*                                                           */
*       /* IS THERE A FIX COUNT                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0985
*       IF PCBFXC^=0 THEN                                          0985
@RF00983 CLI   PCBFXC(PCBPTR),0                                    0985
         BE    @RF00985                                            0985
*         DO;                                                      0986
*           MASKFLG='0'B;           /* A BIT MASK ENTRY IS NOT TO BE
*                                      MADE AS A FIX ENTRY WAS OR  0987
*                                      WILL BE MADE                  */
*                                                                  0987
         NI    MASKFLG(PVTPTR),B'11011111'                         0987
*           /*********************************************************/
*           /*                                                       */
*           /* WAS THERE AN I/O ERROR                                */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0988
*           IF PCBIOERR='1'B THEN                                  0988
*                                                                  0988
         TM    PCBIOERR(PCBPTR),B'00100000'                        0988
         BNO   @RF00988                                            0988
*             /*******************************************************/
*             /*                                                     */
*             /* IS IT A ZERO TCB ADDRESS FIX                        */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0989
*             IF PCBRTCBA^=0 THEN                                  0989
         L     @01,PCBRTPA-1(,PCBPTR)                              0989
         L     @12,PCBRTCBA-1(,@01)                                0989
         LA    @12,0(,@12)                                         0989
         LTR   @12,@12                                             0989
         BNZ   @RT00989                                            0989
*               GO TO REPAIRFX;     /* REMOVE THE FIX COUNT FOR THIS
*                                      PCB FROM THE SPCT FIX ENTRY.
*                                      RETURN IS TO DOROOT BELOW     */
*             ELSE                                                 0991
*               ;                                                  0991
*           ELSE                                                   0992
*             DO;                   /* NO I/O ERROR, BUT NON ZERO FIX
*                                      COUNT                         */
*                                                                  0992
         B     @RC00988                                            0992
@RF00988 DS    0H                                                  0993
*               /*****************************************************/
*               /*                                                   */
*               /* THE PCB HAS A NON ZERO FIX COUNT AND DID NOT      */
*               /* SUFFER AN I/O ERROR. IF IT IS A COMMON AREA ZERO  */
*               /* TCB FIX FOR WHICH I/O HAS NOT YET COMPLETED, IT IS*/
*               /* TO REMAIN ON THE QUEUE.                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0993
*               IF DOINGCOM='1'BPCBVBN>=PVTLCSA THEN              0993
         TM    DOINGCOM(PVTPTR),B'01000000'                        0993
         BO    @RT00993                                            0993
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    0993
         BL    @RF00993                                            0993
@RT00993 DS    0H                                                  0994
*                 DO;               /* IT IS COMMON AREA             */
*                   IF PCBRTCBA=0 THEN/* IT IS ZERO TCB FIX          */
         L     @01,PCBRTPA-1(,PCBPTR)                              0995
         L     @12,PCBRTCBA-1(,@01)                                0995
         LA    @12,0(,@12)                                         0995
         LTR   @12,@12                                             0995
         BNZ   @RF00995                                            0995
*                     DO;                                          0996
*                       IF PCBIOCMP='0'B THEN/* I/O NOT YET COMPLETE */
         TM    PCBIOCMP(PCBPTR),B'00000001'                        0997
         BNZ   @RF00997                                            0997
*                         DO;                                      0998
*                           RFY                                    0999
*                            (R14) RSTD;                           0999
*                           KEEPPCB='1'B;/* SET TO KEEP PCB          */
         OI    KEEPPCB(PVTPTR),B'00010000'                         1000
*                           R14=LEV2RTN;                           1001
         L     R14,LEV2RTN(,PVTPTR)                                1001
*                           RFY                                    1002
*                            (R14) UNRSTD;                         1002
*                           RETURN; /* RETURN                        */
@EL00007 DS    0H                                                  1003
@EF00007 DS    0H                                                  1003
@ER00007 BR    @14                                                 1003
*                         END;                                     1004
*                       ELSE                                       1005
*                         ;         /* I/O WAS COMPLETE              */
@RF00997 DS    0H                                                  1006
*                     END;                                         1006
*                   ELSE            /* NOT ZERO TCB FIX              */
*                     GO TO DOFIXCT;/* PCB IS COMMON AREA, NON ZERO
*                                      TCB FIX                       */
*                 END;                                             1008
*               ELSE                /* PCB IS NOT COMMON AREA        */
*                 DO;                                              1009
*                                                                  1009
         B     @RC00993                                            1009
@RF00993 DS    0H                                                  1010
*                   /*************************************************/
*                   /*                                               */
*                   /* PCB IS FOR PRIVATE AREA. IF FIX IS ZERO TCB   */
*                   /* FIX, A FIX ENTRY FOR THIS VBN MUST BE MADE OR */
*                   /* UPDATED. IF THE VBN IS ZERO, THE PCB CANNOT BE*/
*                   /* PROCESSED. THE PCBVBN WILL BE ZERO BETWEEN    */
*                   /* RUNS OF IEAVIOCP.                     @YM07609*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  1010
*                   IF PCBRTCBA=0&PCBVBN^=0 THEN                   1010
         L     @01,PCBRTPA-1(,PCBPTR)                              1010
         L     @12,PCBRTCBA-1(,@01)                                1010
         LA    @12,0(,@12)                                         1010
         LTR   @12,@12                                             1010
         BNZ   @RF01010                                            1010
         LH    @12,PCBVBN(,PCBPTR)                                 1010
         N     @12,@CF02704                                        1010
         LTR   @12,@12                                             1010
         BZ    @RF01010                                            1010
*                     DO;                                          1011
*                       RFY                                        1012
*                        (SWAPPTR,                                 1012
*                         R1) RSTD;                                1012
*                       R1=PCBVBN;  /* VBN FOR SUBROUTINE            */
         LH    @06,PCBVBN(,PCBPTR)                                 1013
         N     @06,@CF02704                                        1013
         LR    R1,@06                                              1013
*                       CALL GETFIX;/* CREATE A NEW ENTRY OR LOCATE
*                                      THE EXISTING ENTRY            */
         BAL   @14,GETFIX                                          1014
*                       RFY                                        1015
*                        (R1) UNRSTD;                              1015
*                                                                  1015
*                       /*********************************************/
*                       /*                                           */
*                       /* IF THE GETFIX FAILS THE RETNCODE FIELD    */
*                       /* WILL NOT BE ZERO                          */
*                       /*                                           */
*                       /*********************************************/
*                                                                  1016
*                       IF RETNCODE=0 THEN                         1016
         L     @06,RETNCODE(,PVTPTR)                               1016
         LTR   @06,@06                                             1016
         BNZ   @RF01016                                            1016
*                         SPCTFIXC=SPCTFIXC+PCBFXC;/* UPDATE FIX   1017
*                                      ENTRY                         */
         SLR   @06,@06                                             1017
         IC    @06,PCBFXC(,PCBPTR)                                 1017
         AH    @06,SPCTFIXC(,SWAPPTR)                              1017
         STH   @06,SPCTFIXC(,SWAPPTR)                              1017
*                       ELSE                                       1018
*                         DO;       /* CANNOT PUT THIS FIX IN THE  1018
*                                      SPCT. IF I/O IS COMPLETE,   1018
*                                      VALIDATE THE PAGE AND LEAVE IT
*                                      IN CORE WHILE THE MEMORY IS 1018
*                                      SWAPPED OUT. IF I/O IS NOT  1018
*                                      COMPLETE, LEAVE THE PCB TO BE
*                                      PROCESSED BY IEAVPIOP WHEN THE
*                                      I/O IS DONE           @YM07609*/
         B     @RC01016                                            1018
@RF01016 DS    0H                                                  1019
*                           RETNCODE=0;/* CLEAR RETURN CODE          */
         SLR   @06,@06                                             1019
         ST    @06,RETNCODE(,PVTPTR)                               1019
*                           IF PCBIOCMP='0'B THEN/* WAS I/O COMPLETE */
         TM    PCBIOCMP(PCBPTR),B'00000001'                        1020
         BNZ   @RF01020                                            1020
*                             DO;   /* I/O NOT COMPLETE. LEAVE THE 1021
*                                      PCB TO BE PROCESSED BY PIOP 1021
*                                      AND IOCP WHEN IT IS DONE    1021
*                                                            @YM07609*/
*                               KEEPPCB='1'B;/* SET TO KEEP PCB      */
         OI    KEEPPCB(PVTPTR),B'00010000'                         1022
*                               GO TO GOBACK;/* DO NOT DECREMENT PFTE
*                                      FIX CT                        */
         B     GOBACK                                              1023
*                             END;  /* END I/O NOT COMPLETE SECTION
*                                                            @YM07609*/
*                           ELSE    /* I/O IS COMPLETE. VALIDATE THE
*                                      PAGE AND LEAVE IT ON THE LFQ
*                                      WHILE THE MEMORY IS SWAPPED 1025
*                                      OUT. IT WILL AUTOMATICALLY BE
*                                      RECLAIMED AT SWAP IN TIME. THE
*                                      PCB WILL BE FREED IN PIOPURGE.
*                                                            @YM07609*/
*                             DO;   /* VALIDATE THE PAGE.    @YM07609*/
@RF01020 DS    0H                                                  1026
*                               R5=PCBVBN*256;/* GET VBN AS A ADDRESS
*                                                            @YM07609*/
         LH    R5,PCBVBN(,PCBPTR)                                  1026
         N     R5,@CF02704                                         1026
         SLA   R5,8                                                1026
*                               GEN CODE(LRA R4,0(R5))             1027
*                               REFS(R4,R5) SETS(R4);              1027
         LRA R4,0(R5)
*                               BC(8,DOROOT);/* IF THE PAGE IS VALID,
*                                      DO NOT VALIDATE IT AGAIN    1028
*                                                            @YM07609*/
         BC    8,DOROOT                                            1028
*                               R4=PCBXPTA->XPTPROT;/* GET STORAGE 1029
*                                      KEY                   @YM07609*/
         L     @01,PCBXPTA-1(,PCBPTR)                              1029
         SLR   R4,R4                                               1029
         IC    R4,XPTPROT(,@01)                                    1029
*                               R5=PCBRBN*256;/* GET REAL STORAGE  1030
*                                      ADDRESS               @YM07609*/
         LH    R5,PCBRBN(,PCBPTR)                                  1030
         N     R5,@CF02704                                         1030
         SLA   R5,8                                                1030
*                               GEN REFS(R4,R5) SETS(R5);          1031
           SSK   R4,R5                  SET KEY
           LA    R5,2048(R5)            SET TO NEXT 2K
           SSK   R4,R5                  SET KEY AGAIN
*                               PCBPGTA->PGTPVM='0'B;/* VALIDATE PAGE
*                                                            @YM07609*/
         L     @01,PCBPGTA-1(,PCBPTR)                              1032
         NI    PGTPVM(@01),B'11110111'                             1032
*                               PCBVBN=0;/* ZERO THE VBN SO A BITMASK
*                                      ENTRY IS NOT MADE IN PIOPURGE.
*                                                            @YM07609*/
         SLR   @06,@06                                             1033
         STH   @06,PCBVBN(,PCBPTR)                                 1033
*                               PCBFXC=0;/* ZERO THE FIX COUNT     1034
*                                                            @YM07609*/
         MVI   PCBFXC(PCBPTR),X'00'                                1034
*                               GOTO DOROOT;/* GO PROCESS THE ROOT 1035
*                                      PCB.                  @YM07609*/
         B     DOROOT                                              1035
*                             END;  /* END VALIDATION OF I/O COMPLETE
*                                      FIX WHICH COULD NOT BE PUT IN
*                                      THE SPCT.             @YM07609*/
*                         END;      /* END BAD RTN CODE FROM GETFIX  */
*                     END;          /* END OF PRIVATE AREA ZERO TCB
*                                      LOOP                          */
*                                                                  1038
@RC01016 DS    0H                                                  1039
*                   /*************************************************/
*                   /*                                               */
*                   /* FIX IS FOR PRIVATE AREA, IF I/O WAS STARTED   */
*                   /* BUT HAS NOT COMPLETED, SUBTRACT PCB FIX COUNT */
*                   /* FROM PFTE FIX COUNT. PCB WILL BE TURNED INTO A*/
*                   /* LOAD AND I/O WILL BE ALLOWED TO COMPLETE COULD*/
*                   /* ALSO BE A COMMON AREA FIX BETWEEN IEAVPIP AND */
*                   /* IEAVIOCP OR BETWEEN IEAVIOCP AND IEAVIOCP FOR */
*                   /* WHICH THE FIX COUNTIS REMOVED FROM THE PFTE.  */
*                   /*                                               */
*                   /*************************************************/
*                                                                  1039
*                   RFY                                            1039
*                    (SWAPPTR) UNRSTD;                             1039
@RF01010 DS    0H                                                  1040
*                   RFY                                            1040
*                    (R1) RSTD;                                    1040
*DOFIXCT:                                                          1041
*                   IF PCBIOCMP='0'B&DOINGGFA='0'B THEN/* IF I/O IS
*                                      NOT COMPLETE OR NO FRAME IS 1041
*                                      ASSIGNED DO NOT PROCESS FIX 1041
*                                      COUNT                         */
DOFIXCT  TM    PCBIOCMP(PCBPTR),B'00000001'                        1041
         BNZ   @RF01041                                            1041
         TM    DOINGGFA(PVTPTR),B'10000000'                        1041
         BNZ   @RF01041                                            1041
*                     DO;                                          1042
*                       R1=PVTPFTP+PCBRBN;/* GET PFTE ADDRESS        */
         LH    R1,PCBRBN(,PCBPTR)                                  1043
         N     R1,@CF02704                                         1043
         AL    R1,PVTPFTP(,PVTPTR)                                 1043
*                       R1->PFTFXCT=R1->PFTFXCT-PCBFXC;/* SUBTRACT 1044
*                                      PCB FIX COUNT FROM PFTE       */
         LH    @12,PFTFXCT(,R1)                                    1044
         SLR   @06,@06                                             1044
         IC    @06,PCBFXC(,PCBPTR)                                 1044
         SLR   @12,@06                                             1044
         STH   @12,PFTFXCT(,R1)                                    1044
*                       PCBFXC=0;   /* PCB NOW LOOKS LIKE A LOAD     */
         MVI   PCBFXC(PCBPTR),X'00'                                1045
*                       IF R1->PFTFXCT=0 THEN/* ARE THERE STILL FIX
*                                      REQUESTS FOR THIS FRAME       */
         LTR   @12,@12                                             1046
         BNZ   @RF01046                                            1046
*                         DO;       /* NO, THERE ARE NO FIX REQUESTS
*                                                            @YA01572*/
*                           IF PCBVBN>=PVTLCSA/* IS THIS FRAME IN  1048
*                                      COMMON AREA                   */
*                             THEN                                 1048
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    1048
         BL    @RF01048                                            1048
*                             PVTCOMFX=PVTCOMFX-1;/* YES, DECREMENT
*                                      COMMON FIX COUNT      @YA01572*/
         LH    @12,PVTCOMFX(,PVTPTR)                               1049
         BCTR  @12,0                                               1049
         STH   @12,PVTCOMFX(,PVTPTR)                               1049
*                           ELSE    /*                       @ZA18822*/
*                                                                  1050
*                             /***************************************/
*                             /*                                     */
*                             /* SINCE THIS PAGE WILL NOT BE PAGED   */
*                             /* OUT AS PART OF THE SWAP, THE SLOT ID*/
*                             /* OF THE PAGE MUST BE PUT INTO THE    */
*                             /* SPCT FIX ENTRY SO THAT ON THE SWAP  */
*                             /* IN, A ZERO LSID WILL NOT BE PASSED  */
*                             /* TO ASM. THIS NEED ONLY BE DONE FOR  */
*                             /* PRIVATE AREA PAGES SINCE COMMON AREA*/
*                             /* PAGES ARE NEVER SWAPPED OUT, AND THE*/
*                             /* LSID IS GOTTEN FROM THE XPTE ON THE */
*                             /* SWAP-IN.                    @ZA18822*/
*                             /*                                     */
*                             /***************************************/
*                                                                  1050
*                             DO;   /*                       @ZA18822*/
         B     @RC01048                                            1050
@RF01048 DS    0H                                                  1051
*                               RSMCNTFX=RSMCNTFX-1;/* DECREMENT   1051
*                                      ADDRESS SPACE FIX COUNT     1051
*                                                            @YA01572*/
         LH    @12,RSMCNTFX(,RSMHDPTR)                             1051
         BCTR  @12,0                                               1051
         STH   @12,RSMCNTFX(,RSMHDPTR)                             1051
*                               RFY                                1052
*                                (SWAPPTR) RSTD;/*           @ZA18822*/
*                               R1=PCBVBN;/* VBN FOR GETFIX INTF   1053
*                                                            @ZA18822*/
         LH    R1,PCBVBN(,PCBPTR)                                  1053
         N     R1,@CF02704                                         1053
*                               CALL GETFIX;/* FIND SPCT FIX ENTRY 1054
*                                                            @ZA18822*/
         BAL   @14,GETFIX                                          1054
*                               IF RETNCODE=0 THEN/*         @ZA18822*/
         L     @06,RETNCODE(,PVTPTR)                               1055
         LTR   @06,@06                                             1055
         BNZ   @RF01055                                            1055
*                                 DO;/* ENTRY FOUND          @ZA18822*/
*                                   SPCTSSID=AIALSID;/* LSID TO SPCT
*                                                            @ZA18822*/
         MVC   SPCTSSID(3,SWAPPTR),AIALSID+1(PCBPTR)               1057
*                                   SPCTLVAL='1'B;/* LSID VALID    1058
*                                                            @ZA18822*/
         OI    SPCTLVAL(SWAPPTR),B'10000000'                       1058
*                                 END;/*                     @ZA18822*/
*                               RFY                                1060
*                                (SWAPPTR) UNRSTD;/*         @ZA18822*/
@RF01055 DS    0H                                                  1061
*                             END;  /*                       @ZA18822*/
*                           PVTCNTFX=PVTCNTFX-1;/* DECREMENT SYSTEM
*                                      FIX COUNT             @YA01572*/
@RC01048 LH    @12,PVTCNTFX(,PVTPTR)                               1062
         BCTR  @12,0                                               1062
         STH   @12,PVTCNTFX(,PVTPTR)                               1062
*                         END;                                     1063
*                                                                  1063
*/*  PFTFXCT WILL BE INCREMENTED DURING SWAPIN FROM VALUE STORED   1064
*    IN SPCTE                                                        */
*                                                                  1064
*                     END;                                         1064
@RF01046 DS    0H                                                  1065
*                 END;              /* END OF ELSE CLAUSE WHICH IS 1065
*                                      EXECUTED FOR PRIVATE AREA   1065
*                                      FIXES                         */
@RF01041 DS    0H                                                  1066
*             END;                  /* END OF ELSE CLAUSE FOR NO I/O
*                                      ERROR AND NON ZERO FIX COUNT  */
@RC00993 DS    0H                                                  1067
*         END;                      /* END OF NON ZERO FIX CT CLAUSE */
@RC00988 DS    0H                                                  1068
*DOROOT:                                                           1068
*       PCBROOT='0'B;               /* MAKE PCB BE A LOAD WITHOUT ECB*/
@RF00985 DS    0H                                                  1068
DOROOT   NI    PCBROOT(PCBPTR),B'11111011'                         1068
*       PCBRCNT=PCBRCNT-1;          /* DECREMENT ROOT COUNT          */
         L     @12,PCBRTPA-1(,PCBPTR)                              1069
         LA    @12,0(,@12)                                         1069
         LH    @06,PCBRCNT(,@12)                                   1069
         BCTR  @06,0                                               1069
         STH   @06,PCBRCNT(,@12)                                   1069
*       IF PCBRCNT=0 THEN           /* DID ROOT CT GO TO ZERO        */
         LTR   @06,@06                                             1070
         BNZ   @RF01070                                            1070
*         DO;                                                      1071
*           R1=PCBRTPA;             /* ROOT ADDRESS FOR ROOT EXIT RTN*/
         LR    R1,@12                                              1072
*           CALL ROOTEXIT;          /* CALL ROOT EXIT ROUTINE        */
         L     @15,PCBRGOTO(,@12)                                  1073
         BALR  @14,@15                                             1073
*           RCACSECT=RCACSPOT;      /* RESET CSECT ID                */
         L     @12,RCAPTR(,PVTPTR)                                 1074
         MVI   RCACSECT(@12),X'1A'                                 1074
*           SPCTPURG='1'B;          /* INDICATE PAGING WAS PURGED    */
         OI    SPCTPURG(SPCTPTR),B'00100000'                       1075
*         END;                                                     1076
*     END;                          /* END OF THERE IS A ROOT CLAUSE */
@RF01070 DS    0H                                                  1078
*   RFY                                                            1078
*    (R1) UNRSTD;                                                  1078
@RF00981 DS    0H                                                  1079
*                                                                  1079
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT FROM PCB PROCESSOR                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1079
*GOBACK:                                                           1079
*   RFY                                                            1079
*    (R14) RSTD;                                                   1079
GOBACK   DS    0H                                                  1080
*   R14=LEV2RTN;                    /* GET RETURN ADDRESS            */
         L     R14,LEV2RTN(,PVTPTR)                                1080
*   RFY                                                            1081
*    (R14) UNRSTD;                                                 1081
*   RETURN;                         /* RETURN TO PIOPURGE            */
         B     @EL00007                                            1082
*                                                                  1083
*   /*****************************************************************/
*   /*                                                               */
*   /* AN I/O ERROR ON A NON ZERO TCB FIX OR AN ECB IS OUT OF STORAGE*/
*   /* FOR A FIX ON A VBN WHOSE PCB IS ON THE GFA DEFER QUEUE HAS    */
*   /* BEEN ENCOUNTERED. THE FIX COUNT MUST BE REMOVED FROM THE SPCT */
*   /* FOR THE I/O ERROR THE FIX MUST ALSO BE REMOVED FROM THE FOE.  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1083
*   RFY                                                            1083
*    (R1) RSTD;                                                    1083
*REPAIRFX:                                                         1084
*   R1=PCBVBN;                      /* VBN FOR SUBROUTINE            */
REPAIRFX LH    R1,PCBVBN(,PCBPTR)                                  1084
         N     R1,@CF02704                                         1084
*   CALL GETFIX;                    /* LOCATE FIX ENTRY IN SPCT      */
         BAL   @14,GETFIX                                          1085
*   RFY                                                            1086
*    (R1) UNRSTD;                                                  1086
*                                                                  1086
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE ENTRY DID NOT EXIST AND CREATION OF A NEW ENTRY WAS    */
*   /* ATTEMPTED, RECORD ERROR, AS THE ENTRY FOR A NON ZERO TCB FIX  */
*   /* SHOULD HAVE EXISTED                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1087
*   RESPECIFY                                                      1087
*    (SWAPPTR) RESTRICTED;                                         1087
*   IF RETNCODE^=0 THEN             /* CHECK RETURN CODE             */
         L     @06,RETNCODE(,PVTPTR)                               1088
         LTR   @06,@06                                             1088
         BZ    @RF01088                                            1088
*     DO;                                                          1089
*       R0='15'X;                   /* RECORD ERROR                  */
         LA    R0,21                                               1090
*       CALL DOABEND;               /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         1091
*       RETNCODE=0;                 /* CLEAR RETURN CODE FOR FURTHER
*                                      PROCESSING                    */
         SLR   @06,@06                                             1092
         ST    @06,RETNCODE(,PVTPTR)                               1092
*       GO TO DOFOE;                /* NO SPCT PROCESSING NEED BE  1093
*                                      DONE, GO PROCESS FOE          */
         B     DOFOE                                               1093
*     END;                                                         1094
*                                                                  1094
*   /*****************************************************************/
*   /*                                                               */
*   /* SWAPPTR IS SET BY GETFIX                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1095
*   IF SPCTFIXC^=0 THEN                                            1095
@RF01088 LH    @06,SPCTFIXC(,SWAPPTR)                              1095
         LTR   @06,@06                                             1095
         BZ    @RF01095                                            1095
*     SPCTFIXC=SPCTFIXC-PCBFXC;     /* DECREMENT FIX COUNT IN SPCT   */
         SLR   @01,@01                                             1096
         IC    @01,PCBFXC(,PCBPTR)                                 1096
         SLR   @06,@01                                             1096
         STH   @06,SPCTFIXC(,SWAPPTR)                              1096
*   ELSE                                                           1097
*                                                                  1097
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE FIX COUNT IS ZERO, A NEW ENTRY WAS CREATED. RECORD   */
*     /* ERROR AS ENTRY SHOULD HAVE BEEN IN SPCT                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1097
*     DO;                                                          1097
         B     @RC01095                                            1097
@RF01095 DS    0H                                                  1098
*       R0='15'X;                   /* RECORD ERROR                  */
         LA    R0,21                                               1098
*       CALL DOABEND;               /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         1099
*       GO TO REMVFIX;              /* GO REMOVE FIX ENTRY FROM SPCT */
         B     REMVFIX                                             1100
*     END;                                                         1101
*                                                                  1101
*   /*****************************************************************/
*   /*                                                               */
*   /* IF REMOVAL OF THIS FIX CAUSES THE FIX CT IN THE ENTRY TO GO TO*/
*   /* ZERO, REMOVE THE ENTRY                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1102
*   IF SPCTFIXC^=0 THEN                                            1102
@RC01095 LH    @06,SPCTFIXC(,SWAPPTR)                              1102
         LTR   @06,@06                                             1102
         BNZ   @RT01102                                            1102
*     GO TO DOFOE;                  /* GO PROCESS FOE                */
*   SPCTSWPE=PTRLAST->SPCTSWPE;     /* MOVE LAST ENTRY TO THIS ENTRY
*                                      AND ZERO THE LAST ENTRY       */
         L     @06,PTRLAST(,PVTPTR)                                1104
         MVC   SPCTSWPE(8,SWAPPTR),SPCTSWPE(@06)                   1104
*   PTRLAST->SPCTSWPE(1:LENGTH(SPCTSWPE))=''B;/* ZERO LAST ENTRY.  1105
*                                      THIS MUST BE DONE IN CASE   1105
*                                      ENTRY IS REUSED.      @Z40WPYC*/
         XC    SPCTSWPE(8,@06),SPCTSWPE(@06)                       1105
*   RFY                                                            1106
*    (SWAPPTR) UNRSTD;                                             1106
*REMVFIX:                                                          1107
*   SPCTFIX=SPCTFIX-1;              /* DEC NUMBER OF FIX ENTRIES     */
*                                                                  1107
REMVFIX  LH    @12,SPCTFIX(,SPCTPTR)                               1107
         BCTR  @12,0                                               1107
         STH   @12,SPCTFIX(,SPCTPTR)                               1107
*   /*****************************************************************/
*   /*                                                               */
*   /* DID WE REMOVE THE ONLY FIX ENTRY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1108
*   IF SPCTFIX=0 THEN                                              1108
         SLR   @06,@06                                             1108
         CR    @12,@06                                             1108
         BNE   @RF01108                                            1108
*     PTRLAST=0;                    /* THERE ARE NO FIX ENTRIES LEFT
*                                      IN THE SPCT                   */
         ST    @06,PTRLAST(,PVTPTR)                                1109
*   ELSE                                                           1110
*     DO;                                                          1110
         B     @RC01108                                            1110
@RF01108 DS    0H                                                  1111
*       PTRLAST=PTRLAST-LENGTH(SPCTSWPE);/* WE DID NOT REMOVE THE  1111
*                                      ONLY FIX ENTRY. UPDATE PTRLAST
*                                      TO POINT TO WHAT WAS THE NEXT
*                                      TO LAST FIX ENTRY     @Z40WPYC*/
         L     @12,PTRLAST(,PVTPTR)                                1111
         SL    @12,@CF00057                                        1111
         ST    @12,PTRLAST(,PVTPTR)                                1111
*       R4=FIXBEG;                  /* GET ADDRESS OF FIRST EXTENSION
*                                      CONTAINING FIX ENTRIES        */
         L     R4,FIXBEG(,PVTPTR)                                  1112
*       DO WHILE(R4^=0);                                           1113
         B     @DE01113                                            1113
@DL01113 DS    0H                                                  1114
*         IF R4->SPCTEXT=PTRLAST THEN/* DETERMINE IF PTRLAST IS    1114
*                                      POINTING AT A FIX ENTRY OR THE
*                                      BEGINNING OF AN EXT           */
         CLC   SPCTEXT(4,R4),PTRLAST(PVTPTR)                       1114
         BNE   @RF01114                                            1114
*           DO;                                                    1115
*             PTRLAST=R4+LENGTH(SPCTEXTM)-LENGTH(SPCTSWPE);/* ADJUST
*                                      PTR TO LAST FIX ENTRY IN    1116
*                                      PREVIOUS EXT                  */
         LR    @12,R4                                              1116
         SL    @12,@CF02696                                        1116
         ST    @12,PTRLAST(,PVTPTR)                                1116
*             GO TO DOFOE;          /* GO PROCESS FOE                */
         B     DOFOE                                               1117
*           END;                                                   1118
*         R4=R4->SPCTEXT;           /* ADJUST TO NEXT EXT            */
@RF01114 L     R4,SPCTEXT(,R4)                                     1119
*       END;                        /* WE HAVE LOOKED AT ALL       1120
*                                      EXTENSIONS AND PTRLAST IS NOT
*                                      POINTING TO THE BEGINNING OF
*                                      AN EXTENSION, THEREFORE IT  1120
*                                      MUST BE POINTING TO A FIX   1120
*                                      ENTRY                         */
@DE01113 LTR   R4,R4                                               1120
         BNZ   @DL01113                                            1120
*     END;                                                         1121
*                                                                  1122
*   /*****************************************************************/
*   /*                                                               */
*   /* IF PROCESSING IS FOR THE PURPOSE OF REMOVING A FIX FROM THE   */
*   /* SPCT BECAUSE THE ECB IS OUT OF STORAGE THEN RETURN, OTHERWISE */
*   /* DECREMENT THE FOE FIX COUNT AND IF THE COUNT GOES TO ZERO FREE*/
*   /* THE FOE                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1122
*DOFOE:                                                            1122
*   IF NOSPCTE='1'B THEN            /* DOES THIS PCB HAVE AN OUT OF
*                                      STORAGE ECB OR IS IT FIRST  1122
*                                      REFERENCE CASE        @YM02790*/
@RC01108 DS    0H                                                  1122
DOFOE    TM    NOSPCTE(PVTPTR),B'00000100'                         1122
         BNO   @RF01122                                            1122
*     DO;                                                          1123
*       RFY                                                        1124
*        (R14) RSTD;                                               1124
*       R14=LEV2RTN;                /* RESTORE RETURN ADDRESS        */
         L     R14,LEV2RTN(,PVTPTR)                                1125
*       RETURN;                     /* RETURN TO CALLER              */
         B     @EL00007                                            1126
*       RFY                                                        1127
*        (R14) UNRSTD;                                             1127
*     END;                                                         1128
*   R4=PCBRTCBA;                    /* GET TCB ADDRESS               */
@RF01122 L     @01,PCBRTPA-1(,PCBPTR)                              1129
         L     R4,PCBRTCBA-1(,@01)                                 1129
         LA    R4,0(,R4)                                           1129
*   R5=ADDR(R4->TCBFOE);            /* SAVE ADDR                     */
         LA    R5,TCBFOE(,R4)                                      1130
*   R4=R4->TCBFOEA;                 /* GET FOE ADDRESS               */
*                                                                  1131
         L     @12,TCBFOEA-1(,R4)                                  1131
         LA    @12,0(,@12)                                         1131
         LR    R4,@12                                              1131
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN FOR MATCHING VBN IN FOE                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1132
*   DO WHILE(R4^=0);                                               1132
         B     @DE01132                                            1132
@DL01132 DS    0H                                                  1133
*     IF R4->FOEVINDX=PCBVBN THEN   /* DID WE FIND FOE               */
         CLC   FOEVINDX(2,R4),PCBVBN(PCBPTR)                       1133
         BE    @RT01133                                            1133
*       GO TO DECFOE;               /* GO PROCESS IT                 */
*     R5=R4;                        /* SAVE ADDR OF LAST FOE SO YOU
*                                      CAN DEQUE AN FOE              */
         LR    R5,R4                                               1135
*     R4=R4->FOEFLINK;                                             1136
         L     @12,FOEFLINK-1(,R4)                                 1136
         LA    @12,0(,@12)                                         1136
         LR    R4,@12                                              1136
*   END;                                                           1137
@DE01132 LTR   R4,R4                                               1137
         BNZ   @DL01132                                            1137
*   R0='10'X;                       /* RECORD ERROR, COULD NOT FIND
*                                      FOE                           */
         LA    R0,16                                               1138
*   CALL DOABEND;                   /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         1139
*   GO TO DECPFTE;                  /* COULD NOT FIND FOE, GO PROCESS
*                                      PFTE                          */
*                                                                  1140
         B     DECPFTE                                             1140
*   /*****************************************************************/
*   /*                                                               */
*   /* FOE WAS FOUND, DECREMENT FIX COUNT IN FOE, IF COUNT GOES TO   */
*   /* ZERO, FREE FOE. IF FOE FIX COUNT GOES TO ZERO IT SHOULD BE    */
*   /* FREED BUT IT CAN NOT BE FREED AT THIS TIME AS THE FREEMAIN MAY*/
*   /* CAUSE AN LSQA FRAME TO BE FREED AND THERE IS ALREADY AN ENTRY */
*   /* IN THE SPCT FOR ALL LSQA FRAMES                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1141
*DECFOE:                                                           1141
*   R4->FOEFXCT=R4->FOEFXCT-PCBFXC; /* DEC FOE FIX COUNT             */
*                                                                  1141
DECFOE   LH    @12,FOEFXCT(,R4)                                    1141
         SLR   @06,@06                                             1141
         IC    @06,PCBFXC(,PCBPTR)                                 1141
         SLR   @12,@06                                             1141
         STH   @12,FOEFXCT(,R4)                                    1141
*   /*****************************************************************/
*   /*                                                               */
*   /* DECREMENT PFTE FIX COUNT BY PCB FIX COUNT                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1142
*DECPFTE:                                                          1142
*   R4=PVTPFTP+PCBRBN;              /* THE RBN CANNOT BE ZERO AS THE
*                                      IOERR FLAG WAS ON IN THE PCB  */
DECPFTE  LH    R4,PCBRBN(,PCBPTR)                                  1142
         N     R4,@CF02704                                         1142
         AL    R4,PVTPFTP(,PVTPTR)                                 1142
*   R4->PFTFXCT=R4->PFTFXCT-PCBFXC; /* DECREMENT PFTE FIX COUNT      */
         LH    @12,PFTFXCT(,R4)                                    1143
         SLR   @06,@06                                             1143
         IC    @06,PCBFXC(,PCBPTR)                                 1143
         SLR   @12,@06                                             1143
         STH   @12,PFTFXCT(,R4)                                    1143
*   IF R4->PFTFXCT=0 THEN           /* ARE THERE STILL FIX REQUESTS
*                                      FOR THIS FRAME                */
         LTR   @12,@12                                             1144
         BNZ   @RF01144                                            1144
*     DO;                           /* NO, THERE ARE NO FIX REQUESTS
*                                                            @YA01572*/
*       IF PCBVBN>=PVTLCSA          /* IS THIS FRAME IN COMMON AREA  */
*         THEN                                                     1146
         CLC   PCBVBN(2,PCBPTR),PVTLCSA(PVTPTR)                    1146
         BL    @RF01146                                            1146
*         PVTCOMFX=PVTCOMFX-1;      /* YES, DECREMENT COMMON FIX   1147
*                                      COUNT                 @YA01572*/
         LH    @12,PVTCOMFX(,PVTPTR)                               1147
         BCTR  @12,0                                               1147
         STH   @12,PVTCOMFX(,PVTPTR)                               1147
*       ELSE                                                       1148
*         RSMCNTFX=RSMCNTFX-1;      /* DECREMENT ADDRESS SPACE FIX 1148
*                                      COUNT                 @YA01572*/
         B     @RC01146                                            1148
@RF01146 LH    @12,RSMCNTFX(,RSMHDPTR)                             1148
         BCTR  @12,0                                               1148
         STH   @12,RSMCNTFX(,RSMHDPTR)                             1148
*       PVTCNTFX=PVTCNTFX-1;        /* DECREMENT SYSTEM FIX COUNT  1149
*                                                            @YA01572*/
@RC01146 LH    @12,PVTCNTFX(,PVTPTR)                               1149
         BCTR  @12,0                                               1149
         STH   @12,PVTCNTFX(,PVTPTR)                               1149
*     END;                                                         1150
*   GO TO DOROOT;                   /* RETURN TO NON ERROR PATH      */
         B     DOROOT                                              1151
*   RFY                                                            1152
*    (R4,                                                          1152
*     R5) UNRSTD;                                                  1152
*   RFY                                                            1153
*     PCBR BASED(PCBRPTR);                                         1153
*   END PCBPROC;                                                   1154
*                                                                  1155
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE SETS A BIT IN THE SPCT WHICH CAUSES THE PAGE TO  */
*   /* BE SWAPPED IN AS A STAGE 2 PAGE. THE LOCATION OF THE BIT IS IN*/
*   /* THE SEGMENT ENTRY THAT CORRESPONDS TO THE SEGMENT ID PART OF  */
*   /* THE VBN PASSED AS INPUT. THE BIT POSITION IN THE MASK IS      */
*   /* DETERMINED BY 2**(15-P) WHERE P IS THE PAGE TABLE INDEX PART  */
*   /* OF THE VBN                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*SETMASK:                                                          1155
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1155
SETMASK  DS    0H                                                  1156
*   RFY                                                            1156
*    (R1,                                                          1156
*     R11,                                                         1156
*     R14,                                                         1156
*     R15) RSTD;                                                   1156
*   LEV3RTN=R14;                    /* SAVE RETURN ADDRESS           */
         ST    R14,LEV3RTN(,PVTPTR)                                1157
*   GEN CODE(SRL R1,4(0))                                          1158
*   REFS(R1) SETS(R1);              /* SHIFT OUT 4 LOW ORDER BITS    */
         SRL R1,4(0)
*   R0=R1;                          /* COPY VBN                      */
         LR    R0,R1                                               1159
*   GEN CODE(SRL R0,4(0))                                          1160
*   REFS(R0) SETS(R0);              /* SHIFT SS PART RT 4 BITS, HIGH
*                                      ORDER PART OF REGISTER IS   1160
*                                      ASSUMED ZERO                  */
         SRL R0,4(0)
*   R2=ADDR(SPCTSEGS);              /* INITIALIZE SEGSPTR            */
*                                                                  1161
         LA    R2,SPCTSEGS(,SPCTPTR)                               1161
*   /*****************************************************************/
*   /*                                                               */
*   /* SCAN SPCT SEGMENT ENTRIES FOR MATCH BY SEGMENT INDEX          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1162
*   DO R14=SPCTSSEG TO 1 BY-1;                                     1162
         SLR   R14,R14                                             1162
         IC    R14,SPCTSSEG(,SPCTPTR)                              1162
         B     @DE01162                                            1162
@DL01162 DS    0H                                                  1163
*     R15=R2->SPCTSEGX;                                            1163
*                                                                  1163
         SLR   R15,R15                                             1163
         IC    R15,SPCTSEGX(,R2)                                   1163
*     /***************************************************************/
*     /*                                                             */
*     /* DO THE SEGMENT IDS MATCH                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  1164
*     IF R15=R0 THEN                                               1164
         CR    R15,R0                                              1164
         BE    @RT01164                                            1164
*       GO TO MATCHSEG;                                            1165
*     R2=R2+LENGTH(SPCTSEGE);       /* INCREMENT PTR BY LENGTH OF  1166
*                                      ENTRY                         */
         AL    R2,@CF00970                                         1166
*   END;                                                           1167
*                                                                  1167
         BCTR  R14,0                                               1167
@DE01162 LTR   R14,R14                                             1167
         BP    @DL01162                                            1167
*   /*****************************************************************/
*   /*                                                               */
*   /* RECORD ERROR, WE FAILED TO FIND A SEGMENT ENTRY WHICH SHOULD  */
*   /* HAVE BEEN THERE                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   R0='18'X;                       /* RECORD LOST ENTRY             */
         LA    R0,24                                               1168
*   CALL DOABEND;                   /* RECORD THE ERROR.             */
         BAL   @14,DOABEND                                         1169
*   GO TO MASKRTN;                                                 1170
*                                                                  1170
         B     MASKRTN                                             1170
*   /*****************************************************************/
*   /*                                                               */
*   /* WE FOUND THE CORRECT SEGMENT ENTRY                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1171
*MATCHSEG:                                                         1171
*   R1=R1&PMASK;                    /* ISOLATE P PART OF VBN         */
MATCHSEG N     R1,@CF02506                                         1171
*   R1=15-R1;                       /* COMPUTE SHIFT AMOUNT          */
         LA    @12,15                                              1172
         SLR   @12,R1                                              1172
         LR    R1,@12                                              1172
*   R0=1;                           /* GET A 1 TO SHIFT              */
         LA    R0,1                                                1173
*   GEN CODE(SLL R0,0(R1))                                         1174
*   SETS(R0) REFS(R0,R1);                                          1174
         SLL R0,0(R1)
*   R2->SPCTBITM=R2->SPCTBITMR0;   /* OR ON NEW BIT                 */
         LH    @12,SPCTBITM(,R2)                                   1175
         N     @12,@CF02704                                        1175
         OR    @12,R0                                              1175
         STH   @12,SPCTBITM(,R2)                                   1175
*   SPCTWSSZ=SPCTWSSZ+1;            /* INCREMENT WORKING SET SIZE    */
         LA    @12,1                                               1176
         AH    @12,SPCTWSSZ(,SPCTPTR)                              1176
         STH   @12,SPCTWSSZ(,SPCTPTR)                              1176
*MASKRTN:                                                          1177
*   R2=ASCBRSM;                     /* RESTORE HEADER ADDRESS        */
MASKRTN  L     @12,ASCBPTR                                         1177
         L     R2,ASCBRSM(,@12)                                    1177
*   R14=LEV3RTN;                    /* GET RETURN ADDRESS            */
         L     R14,LEV3RTN(,PVTPTR)                                1178
*   RFY                                                            1179
*    (R1,                                                          1179
*     R11,                                                         1179
*     R14,                                                         1179
*     R15) UNRSTD;                                                 1179
*PRCEND3:                                                          1180
*   END SETMASK;                                                   1180
@EL00008 DS    0H                                                  1180
@EF00008 DS    0H                                                  1180
@ER00008 BR    @14                                                 1180
*GETFIX:                                                           1181
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1181
*                                                                  1181
GETFIX   DS    0H                                                  1182
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION GETS A NEW SPCT EXTENSION. IF THE PRESENT        */
*   /* EXTENSION POINTS TO AN UNUSED EXTENSION, THAT EXTENSION WILL  */
*   /* BE USED. IF THERE IS NOT AN UNUSED EXTENSION, A NEW EXTENSION */
*   /* IS GETMAINED. THE NEW EXTENSION IS INITIALIZED AND CONTROL    */
*   /* RETURNS TO THE CALLER. INPUT IS R1 WITH THE FIX VBN. OUTPUT IS*/
*   /* SWAPPTR POINTING TO A NEW FIX ENTRY OR AN EXISTING ONE IF ONE */
*   /* EXISTS.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1182
*   RESPECIFY                                                      1182
*    (SWAPPTR,                                                     1182
*     R1,                                                          1182
*     R4,                                                          1182
*     ENDPTR,                                                      1182
*     BEGPTR,                                                      1182
*     R11,                                                         1182
*     R14) RESTRICTED;                                             1182
*   LEV3RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV3RTN(,PVTPTR)                                1183
*   RESPECIFY                                                      1184
*    (R14) UNRESTRICTED;                                           1184
*   SWAPPTR=PTRFIRST;               /* GET THE ADDRESS OF THE FIRST
*                                      FIX ENTRY IN THE SPCT.        */
         L     SWAPPTR,PTRFIRST(,PVTPTR)                           1185
*   BEGPTR=FIXBEG;                  /* GET THE ADDRESS OF THE START
*                                      OF THE FIRST EXTENSION WITH 1186
*                                      FIX ENTRIES.                  */
         L     BEGPTR,FIXBEG(,PVTPTR)                              1186
*   ENDPTR=BEGPTR+LENGTH(SPCTEXTM); /* GET THE ADDRESS OF THE END OF
*                                      THE FIRST EXTENSION WITH FIX
*                                      ENTRIES.                      */
         LA    ENDPTR,56                                           1187
         ALR   ENDPTR,BEGPTR                                       1187
*   IF PTRLAST=0 THEN               /* TEST IF THERE ANY FIX ENTRIES
*                                      IN THE SPCT.                  */
         L     @15,PTRLAST(,PVTPTR)                                1188
         LTR   @15,@15                                             1188
         BZ    @RT01188                                            1188
*     GOTO INITFIX;                 /* ARE NO FIX ENTRIES YET. GO  1189
*                                      INITIALIZE THE FIRST.         */
*TESTVBN:                                                          1190
*   RESPECIFY                                                      1190
*    (R15) RESTRICTED;                                             1190
TESTVBN  DS    0H                                                  1191
*   R15=SPCTVBN;                    /* GET THE VBN.          @Z40WPYC*/
         LH    R15,SPCTVBN(,SWAPPTR)                               1191
         N     R15,@CF02704                                        1191
*   IF R15=R1 THEN                  /* TEST IF THE SPCT ENTRY IS FOR
*                                      THE VBN BEING PROCESSED.      */
         CR    R15,R1                                              1192
         BE    @RT01192                                            1192
*     GOTO EXITPT;                  /* HAVE FOUND A SPCT FIX ENTRY 1193
*                                      FOR THE INPUT VBN. PASS IT  1193
*                                      BACK TO THE CALLER.           */
*   RESPECIFY                                                      1194
*    (R15) UNRESTRICTED;                                           1194
*   SWAPPTR=SWAPPTR+LENGTH(SPCTSWPE);/* HAVE NOT FOUND THE VBN ENTRY
*                                      YET. GET THE ADDRESS OF THE 1195
*                                      NEXT FIX ENTRY AND TRY AGAIN. */
         LA    @15,8                                               1195
         ALR   SWAPPTR,@15                                         1195
*   IF SWAPPTR^=PTRLAST+LENGTH(SPCTSWPE) THEN/* TEST IF THE END OF 1196
*                                      THE FIX ENTRIES HAS BEEN    1196
*                                      REACHED.                      */
         L     @14,PTRLAST(,PVTPTR)                                1196
         ALR   @14,@15                                             1196
         CR    SWAPPTR,@14                                         1196
         BE    @RF01196                                            1196
*     DO;                           /* NOT AT END OF SPCT. ARE MORE
*                                      FIX ENTRIES TO SEARCH.        */
*       IF SWAPPTR=ENDPTR THEN      /* TEST IF AT END OF THE       1198
*                                      EXTENSION.                    */
         CR    SWAPPTR,ENDPTR                                      1198
         BNE   @RF01198                                            1198
*         DO;                       /* ARE AT END OF THE EXTENSION.
*                                      GET THE NEXT EXTENSION TO BE
*                                      PROCESSED.                    */
*           BEGPTR=BEGPTR->SPCTEXT; /* GET THE ADDRESS OF THE NEXT 1200
*                                      EXTENSION TO BE PROCESSED.    */
*                                                                  1200
         L     BEGPTR,SPCTEXT(,BEGPTR)                             1200
*           /*********************************************************/
*           /*                                                       */
*           /* GET THE ADDRESS OF THE FIRST FIX ENTRY IN THE         */
*           /* EXTENSION.                                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1201
*           SWAPPTR=BEGPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));     1201
         ALR   @15,BEGPTR                                          1201
         LR    SWAPPTR,@15                                         1201
*           ENDPTR=BEGPTR+LENGTH(SPCTEXTM);/* GET THE ADDRESS OF THE
*                                      END OF THE EXTENSION.         */
         LA    ENDPTR,56                                           1202
         ALR   ENDPTR,BEGPTR                                       1202
*         END;                                                     1203
*       GOTO TESTVBN;               /* TEST THE NEXT SPCT FIX ENTRY. */
         B     TESTVBN                                             1204
*     END;                                                         1205
*                                                                  1205
*   /*****************************************************************/
*   /*                                                               */
*   /* IF HERE, THERE IS NOT A SPCT FIX ENTRY WITH THE SAME VBN AS   */
*   /* THE INPUT VBN. A NEW ENTRY IS CREATED.                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1206
*   IF SWAPPTR=ENDPTR THEN          /* TEST IF THE PRESENT EXTENSION
*                                      IS FULL.                      */
@RF01196 CR    SWAPPTR,ENDPTR                                      1206
         BNE   @RF01206                                            1206
*     DO;                           /* EXTENSION IS FULL, SO GET AN
*                                      ADDITIONAL EXTENSION.         */
*       CALL GETEXT;                /* GET A NEW EXTENSION.          */
         BAL   @14,GETEXT                                          1208
*       IF RETNCODE^=0 THEN         /* TEST IF RETURN CODE IS BAD. WE
*                                      RETURN HERE ONLY IF CALLED  1209
*                                      FROM WORKSET OR PIOPURGE      */
         L     @15,RETNCODE(,PVTPTR)                               1209
         LTR   @15,@15                                             1209
         BNZ   @RT01209                                            1209
*         GOTO EXITPT;              /* ERROR OCCURRED. RETURN TO THE
*                                      CALLER.                       */
*     END;                                                         1211
*INITFIX:                                                          1212
*   SPCTVBN=R1;                     /* STORE THE VBN IN THE FIX    1212
*                                      ENTRY.                @Z40WPYC*/
@RF01206 DS    0H                                                  1212
INITFIX  STH   R1,SPCTVBN(,SWAPPTR)                                1212
*   IF R1^<PVTLCSA THEN             /* TEST IF THE VBN IS FOR THE  1213
*                                      COMMON AREA.                  */
         LH    @15,PVTLCSA(,PVTPTR)                                1213
         N     @15,@CF02704                                        1213
         CR    R1,@15                                              1213
         BL    @RF01213                                            1213
*     SPCTCOMM='1'B;                /* SET COMMON AREA FLAG IN THE 1214
*                                      FIX ENTRY.                    */
         OI    SPCTCOMM(SWAPPTR),B'00100000'                       1214
*   ELSE                            /* FIX IS IN PRIVATE AREA        */
*     DO;                           /* TEST IF FIXED PAGE IS IN CORE
*                                      FOR COUNTER           @YM07609*/
         B     @RC01213                                            1215
@RF01213 DS    0H                                                  1216
*       RESPECIFY                                                  1216
*        (R14) RESTRICTED;                                         1216
*       GEN CODE REFS(R1) SETS(R14) FLOWS(RSETVBN);                1217
         SLL   R1,8      MAKE VSA FROM VBN
         LRA   R14,0(R1) LOAD REAL ADDRESS
         BC    7,RSETVBN IF PAGE NOT IN CORE, DO NOT COUNT IT
*       PAFIX=PAFIX+1;              /* INCREMENT NUMBER OF PRIVATE 1218
*                                      AREA FIXES                    */
         LA    @15,1                                               1218
         AL    @15,PAFIX(,PVTPTR)                                  1218
         ST    @15,PAFIX(,PVTPTR)                                  1218
*RSETVBN:                                                          1219
*       GEN(SRL  R1,8)              /* MAKE THE VSA A VBN    @YM07609*/
*       REFS(R1) SETS(R1) NOFLOWS;                                 1219
RSETVBN  SRL  R1,8
*       RESPECIFY                                                  1220
*        (R14) UNRESTRICTED;                                       1220
*     END;                                                         1221
*   SPCTFIX=SPCTFIX+1;              /* INCREMENT THE COUNT OF FIX  1222
*                                      ENTRIES IN THE SPCT           */
@RC01213 LA    @15,1                                               1222
         AH    @15,SPCTFIX(,SPCTPTR)                               1222
         STH   @15,SPCTFIX(,SPCTPTR)                               1222
*   PTRLAST=SWAPPTR;                /* SAVE THE ADDRESS OF THE NEW 1223
*                                      LAST FIX ENTRY.               */
*                                                                  1223
         ST    SWAPPTR,PTRLAST(,PVTPTR)                            1223
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT GETFIX ROUTINE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1224
*EXITPT:                                                           1224
*   RESPECIFY                                                      1224
*    (R14) RESTRICTED;                                             1224
EXITPT   DS    0H                                                  1225
*   R14=LEV3RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV3RTN(,PVTPTR)                                1225
*   RESPECIFY                                                      1226
*    (R1,                                                          1226
*     R4,                                                          1226
*     SWAPPTR,                                                     1226
*     ENDPTR,                                                      1226
*     BEGPTR,                                                      1226
*     R11,                                                         1226
*     R14) UNRESTRICTED;                                           1226
*   END GETFIX;                                                    1227
@EL00009 DS    0H                                                  1227
@EF00009 DS    0H                                                  1227
@ER00009 BR    @14                                                 1227
*                                                                  1228
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION GETS A PARTIALLY INITIALIZED PCB AND COMPLETES   */
*   /* THE INITIALIZATION NECESSARY TO SWAP OUT THE VIRTUAL PAGE.    */
*   /* INPUT IS PFTEPTR POINTING TO THE PFTE TO BE PAGED OUT OUTPUT  */
*   /* IS AN INITIALIZED PCB FOR THE PFTE AND PCBPTR POINTING TO THE */
*   /* PCB JUST INITIALIZED AND NEXTPCB UPDATED. NOTE THAT PCBSPCTE  */
*   /* IS NOT INITIALIZED BY THIS ROUTINE. THE CALLER IS RESPONSIBLE */
*   /* FOR INITIALIZING THIS FIELD FOR EACH SWAPOUT LSQA OR FIX'D    */
*   /* PAGE (INCLUDING ZERO TCB FIX).                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1228
*INITPCB:                                                          1228
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1228
INITPCB  DS    0H                                                  1229
*   RESPECIFY                                                      1229
*    (R0,                                                          1229
*     R1,                                                          1229
*     R4,                                                          1229
*     PFTEPTR,                                                     1229
*     ENDPTR,                                                      1229
*     SWAPPTR,                                                     1229
*     R14) RESTRICTED;                                             1229
*   LEV3RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV3RTN(,PVTPTR)                                1230
*   RESPECIFY                                                      1231
*    (R14) UNRESTRICTED;                                           1231
*   IF PFTBADPG='1'B THEN           /* STORAGE ERROR IN THE PAGE?  1232
*                                                            @ZA19960*/
*                                                                  1232
         TM    PFTBADPG(PFTEPTR),B'00000100'                       1232
         BNO   @RF01232                                            1232
*     /***************************************************************/
*     /*                                                             */
*     /* THIS CODE PROCESSES ONLY NON LSQA PRIVATE AREA FRAMES - LSQA*/
*     /* IS DONE IN THE LSQANTRY ROUTINE - FIXED PRIVATE IS DONE IN  */
*     /* THE STAGE1 ROUTINE AND HERE WHEN CALLED FROM THE WORKSET    */
*     /* ROUTINE - THIS IS THE ONLY PLACE STORAGE ERRORS IN CHANGED  */
*     /* PAGEABLE PRIVATE AREA ARE PROCESSED WHEN CALLED FROM WORKSET*/
*     /* ROUTINE.                                            @ZA19960*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  1233
*     DO;                           /* RECORD AND SKIP PCB BUILD   1233
*                                                            @ZA19960*/
*       IF FRPINCNT^>MXPINCNT&PFTPREF='0'B THEN/* LOGGED TOO MANY  1234
*                                      YET?                  @ZA19960*/
         CLI   FRPINCNT(RSMHDPTR),5                                1234
         BH    @RF01234                                            1234
         TM    PFTPREF(PFTEPTR),B'00000100'                        1234
         BNZ   @RF01234                                            1234
*         DO;                       /* COUNT NOT EXCEEDED SO LOG IT
*                                                            @ZA19960*/
*           FRPINCNT=FRPINCNT+1;    /* INCREMENT THE LOGGED COUNT  1236
*                                                            @ZA19960*/
         LA    @05,1                                               1236
         SLR   @15,@15                                             1236
         IC    @15,FRPINCNT(,RSMHDPTR)                             1236
         ALR   @05,@15                                             1236
         STC   @05,FRPINCNT(,RSMHDPTR)                             1236
*           R0='20'X;               /* SET STORAGE PINNED FOR STORAGE
*                                      ERROR CODE            @ZA19960*/
         LA    R0,32                                               1237
*           CALL DOABEND;           /* RECORD THE STORAGE PINNING  1238
*                                                            @ZA19960*/
         BAL   @14,DOABEND                                         1238
*         END;                      /* END OF STORAGE ERROR LOGGING
*                                      DO GROUP              @ZA19960*/
*       FPCALLED='0'B;              /* RESET FIND PAGE CALLED      1240
*                                      INDICATOR             @ZA19960*/
@RF01234 NI    FPCALLED(PVTPTR),B'11111101'                        1240
*       GOTO BADPAGE;               /* DO NOT SWAP OUT A BAD PAGE  1241
*                                                            @ZA19960*/
         B     BADPAGE                                             1241
*     END;                          /* END OF RECORD - GOING TO THE
*                                      SKIP BUILD PCB CODE   @ZA19960*/
*                                                                  1242
*   /*****************************************************************/
*   /*                                                               */
*   /* ARE THERE ANY MORE PCBS                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1243
*   PCBPTR=NEXTPCB;                 /* SET TO NEXT PCB TO INIT       */
@RF01232 L     PCBPTR,NEXTPCB(,PVTPTR)                             1243
*   IF PCBPTR=0 THEN                /* ANY PCBS LEFT                 */
         LTR   PCBPTR,PCBPTR                                       1244
         BNZ   @RF01244                                            1244
*     DO;                                                          1245
*       R0='17'X;                   /* ERROR WAS ORIGINALLY IN     1246
*                                      ASCBFMCT                      */
         LA    R0,23                                               1246
*       CALL DOABEND;               /* RECORD ERROR                  */
         BAL   @14,DOABEND                                         1247
*       IF PURGDON='0'B THEN        /* HAS PAGING BEEN PURGED        */
         TM    PURGDON(PVTPTR),B'00001000'                         1248
         BNZ   @RF01248                                            1248
*         RETURN TO CLEANUP1;       /* RETURN AND ABORT SWAP         */
         LA    @14,CLEANUP1                                        1249
@EL00010 DS    0H                                                  1249
@EF00010 DS    0H                                                  1249
@ER00010 BR    @14                                                 1249
*BADPAGE:                                                          1250
*       ;                           /* DO NOT BUILD A PCB FOR BAD  1250
*                                      FRAMES                @ZA19960*/
@RF01248 DS    0H                                                  1250
BADPAGE  DS    0H                                                  1251
*       RETNCODE=TRYLATER;          /* SET RETURN CODE               */
         MVC   RETNCODE(4,PVTPTR),@CF00057                         1251
*       GO TO INITEXT;              /* RETURN WITHOUT INITING PCB    */
         B     INITEXT                                             1252
*     END;                                                         1253
*   RESPECIFY                                                      1254
*    (R15) RESTRICTED;                                             1254
@RF01244 DS    0H                                                  1255
*   IF PFTLSQA^='1'B THEN           /* FOR EVERY PRIVATE AREA PAGE,
*                                      MUST SET THE PGT/XPT ADDR IN
*                                      PCB                   @Z40WPYC*/
         TM    PFTLSQA(PFTEPTR),B'00100000'                        1255
         BO    @RF01255                                            1255
*     DO;                           /* PRIVATE AREA          @Z40WPYC*/
*       IF FPCALLED^='1'B           /* HAS FIND PAGE BEEN CALLED     */
*         THEN                                                     1257
         TM    FPCALLED(PVTPTR),B'00000010'                        1257
         BO    @RF01257                                            1257
*         DO;                       /* NO, CALL FINDPAGE     @Z40WPYD*/
*           R1=PFTVBN*256;          /* GET THE VSA FROM THE VBN    1259
*                                                            @Z40WPYC*/
         LH    R1,PFTVBN(,PFTEPTR)                                 1259
         N     R1,@CF02704                                         1259
         SLA   R1,8                                                1259
*           CALL IEAVFP2;           /* CALL FINDPAGE TO GET THE PGTE
*                                      AND XPTE ADDRESSES    @Z40WPYC*/
         L     @15,PVTPFP2(,PVTPTR)                                1260
         BALR  @14,@15                                             1260
*           IF R15^=0 THEN          /* INTERNAL ERROR IF BAD RETURN
*                                      CODE. PAGE AND SEGMENT MUST BE
*                                      VALID IF FRAME IS ASSIGNED. 1261
*                                                            @Z40WPYC*/
         LTR   R15,R15                                             1261
         BZ    @RF01261                                            1261
*             DO;                   /* INTERNAL ERROR        @Z40WPYC*/
*               R0='01'X;           /* INDICATE FINDPAGE FAILURE   1263
*                                                            @Z40WPYC*/
         LA    R0,1                                                1263
*               CALL DOABEND;       /* RECORD THE ERROR      @Z40WPYC*/
         BAL   @14,DOABEND                                         1264
*               RETNCODE=TRYLATER;  /* SET FAILURE RETURN CODE     1265
*                                                            @Z40WPYC*/
         MVC   RETNCODE(4,PVTPTR),@CF00057                         1265
*               GOTO INITEXT;       /* RETURN WITHOUT INIT PCB     1266
*                                                            @Z40WPYC*/
         B     INITEXT                                             1266
*             END;                  /* END FAILURE PROCESSING      1267
*                                                            @Z40WPYC*/
*           ELSE                                                   1268
*             ;                     /* FOUND PGTE            @Z40WPYC*/
@RF01261 DS    0H                                                  1269
*           RESPECIFY                                              1269
*            (R15) UNRESTRICTED;    /*                       @Z40WPYC*/
*         END;                                                     1270
*       ELSE                                                       1271
*         FPCALLED='0'B;            /* YES, FINDPAGE WAS CALLED FOR
*                                      THIS FRAME. SET FLAG OFF    1271
*                                                            @Z40WPYD*/
         B     @RC01257                                            1271
@RF01257 NI    FPCALLED(PVTPTR),B'11111101'                        1271
*       PCBPGTA=R0;                 /* SET PGTE ADDRESS      @Z40WPYC*/
@RC01257 STCM  R0,7,PCBPGTA(PCBPTR)                                1272
*       PCBXPTA=R1;                 /* SET XPTE ADDRESS      @Z40WPYC*/
         STCM  R1,7,PCBXPTA(PCBPTR)                                1273
*       AIAPRIV='1'B;               /* INDICATE PRIVATE AREA PAGE  1274
*                                                            @Z40WPYC*/
         OI    AIAPRIV(PCBPTR),B'01000000'                         1274
*     END;                          /* END PRIVATE AREA ONLY @Z40WPYC*/
*   ELSE                                                           1276
*     ;                             /* LSQA ENTRY - START COMMON   1276
*                                      PROCESSING            @Z40WPYC*/
@RF01255 DS    0H                                                  1277
*   GEN REFS(R14,PCBPTR,SOUTENTR) SETS(R14,PCB);                   1277
*                                          /*               @Z40WPYC*/
TRACEZS1 EQU  *         PCB TRACE - SOUT ENTERED            @Z40WPYC
         B    *+16      BRANCH AROUND TRACE CODE            @Z40WPYC
         L    R14,64(PCBPTR) GET CURRENT COUNT              @Z40WPYC
         AL   R14,SOUTENTR   INCREMENT BY 1                 @Z40WPYC
         ST   R14,64(PCBPTR) STORE NEW COUNT                @Z40WPYC
*   PCBVBN=PFTVBN;                  /* STORE THE VBN IN THE PCB.     */
         MVC   PCBVBN(2,PCBPTR),PFTVBN(PFTEPTR)                    1278
*   PFTPCBSI='1'B;                  /* A PCB IS DEFINED FOR THE    1279
*                                      FRAME.                        */
         OI    PFTPCBSI(PFTEPTR),B'00001000'                       1279
*   PCBRBN=PFTEPTR-PVTPFTP;         /* GET THE RBN FROM THE PFTE   1280
*                                      ADDRESS.                      */
         LR    @05,PFTEPTR                                         1280
         SL    @05,PVTPFTP(,PVTPTR)                                1280
         STH   @05,PCBRBN(,PCBPTR)                                 1280
*   ROOTCNT=ROOTCNT+1;              /* INCREMENT THE ROOT COUNT.     */
         LA    @05,1                                               1281
         AH    @05,ROOTCNT(,PVTPTR)                                1281
         STH   @05,ROOTCNT(,PVTPTR)                                1281
*   IF PCBFQPA=0 THEN               /* LAST PCB                      */
         L     @05,PCBFQPA-1(,PCBPTR)                              1282
         LA    @05,0(,@05)                                         1282
         LTR   @05,@05                                             1282
         BNZ   @RF01282                                            1282
*     AIANXAIA=0;                   /* ZERO NEXT AIA ADDRESS         */
         SLR   @05,@05                                             1283
         ST    @05,AIANXAIA(,PCBPTR)                               1283
*   ELSE                            /* NOT LAST PCB                  */
*     AIANXAIA=ADDR(PCBFQPA->PCBAIA);/* GET THE ADDRESS OF THE NEXT
*                                      AIA.                          */
         B     @RC01282                                            1284
@RF01282 L     @05,PCBFQPA-1(,PCBPTR)                              1284
         LA    @05,0(,@05)                                         1284
         LA    @05,PCBAIA(,@05)                                    1284
         ST    @05,AIANXAIA(,PCBPTR)                               1284
*   NEXTPCB=PCBFQPA;                /* SET POINTER TO NEXT AVAILABLE
*                                      PCB.                          */
@RC01282 L     @05,PCBFQPA-1(,PCBPTR)                              1285
         LA    @05,0(,@05)                                         1285
         ST    @05,NEXTPCB(,PVTPTR)                                1285
*   RESPECIFY                                                      1286
*    (R14) RESTRICTED;                                             1286
*INITEXT:                                                          1287
*   R14=LEV3RTN;                    /* GET THE RETURN ADDRESS.       */
INITEXT  L     R14,LEV3RTN(,PVTPTR)                                1287
*   RESPECIFY                                                      1288
*    (R1,                                                          1288
*     PFTEPTR,                                                     1288
*     R4,                                                          1288
*     R5,                                                          1288
*     ENDPTR,                                                      1288
*     SWAPPTR,                                                     1288
*     R14) UNRESTRICTED;                                           1288
*   END INITPCB;                                                   1289
         B     @EL00010                                            1289
*                                                                  1290
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION GETS AN ADDITIONAL EXTENSION TO THE SPCT. IF AN  */
*   /* UNUSED EXTENSION EXISTS POINTED TO BY THE PRESENT EXTENSION,  */
*   /* THAT EXTENSION IS USED. OTHERWISE A NEW EXTENSION IS          */
*   /* GETMAINED.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1290
*GETEXT:                                                           1290
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1290
GETEXT   DS    0H                                                  1291
*   RESPECIFY                                                      1291
*    (R1,                                                          1291
*     R4,                                                          1291
*     SWAPPTR,                                                     1291
*     PFTEPTR,                                                     1291
*     BEGPTR,                                                      1291
*     ENDPTR,                                                      1291
*     R14) RESTRICTED;                                             1291
*   LEV4RTN=R14;                    /* SAVE THE RETURN ADDRESS.      */
         ST    R14,LEV4RTN(,PVTPTR)                                1292
*   RESPECIFY                                                      1293
*    (R14) UNRESTRICTED;                                           1293
*   IF BEGPTR->SPCTEXT=0 THEN       /* TEST IF AN EXTENSION ALREADY
*                                      EXISTS.                       */
         L     @15,SPCTEXT(,BEGPTR)                                1294
         LTR   @15,@15                                             1294
         BNZ   @RF01294                                            1294
*     DO;                           /* AN EXTENSION DOES NOT EXIST,
*                                      SO ONE MUST BE GETMAINED.     */
*       TEMPSAVE=R1;                /* SAVE REG 1 ACROSS GETMAIN.    */
         ST    R1,TEMPSAVE(,PVTPTR)                                1296
*       REG7SAVE=R7;                /* SAVE REG 7 OVER GETMAIN.      */
         ST    R7,REG7SAVE(,PVTPTR)                                1297
*       R0=LENGTH(SPCTEXTM);        /* GET THE LENGTH OF AN EXTENSION*/
         LA    R0,56                                               1298
*       R1=0;                       /* ZERO FOR GETMAIN.             */
         SLR   R1,R1                                               1299
*       REG4SAVE=R4;                /* SAVE R4 OVER GETMAIN          */
         L     @15,CALLER13(,PVTPTR)                               1300
         ST    R4,REG4SAVE(,@15)                                   1300
*       R4=0;                       /* SQA REQUEST DOES NOT NEED A 1301
*                                      TCB.                          */
         SLR   R4,R4                                               1301
*       R7=ASCBPTR;                 /* ASCB IS THIS ASCB             */
         L     R7,ASCBPTR                                          1302
*/********************************************************************/
*/*                                                                  */
*/*                     GETMAIN AN NEW EXTENSION.                    */
*/*                   INPUT:                                         */
*/*              R0: LENGTH OF THE EXTENSION                         */
*/*              R1: ZERO                                            */
*/*              R2: UNUSED                                          */
*/*              R3: LOADED BY THE MACRO                             */
*/*              R4: ZERO                                            */
*/*              R5 - R6: UNUSED                                     */
*/*              R7: ADDRESS OF THE ASCB                             */
*/*              R8 - R13: UNUSED                                    */
*/*              R14: RETURN ADDRESS LOADED BY MACRO                 */
*/*              R15: ENTRY POINT ADDRESS LOADED BY MACRO            */
*/*                   OUTPUT:                                        */
*/*              R0: RESTORED                                        */
*/*              R1: ADDRESS OF THE NEW EXTENSION                    */
*/*              R2 - R14: RESTORED                                  */
*/*              R15: RETURN CODE                                    */
*/*                     0 - SUCCESSFUL                               */
*/*                     NON-0 - UNSUCCESSFUL                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1303
*       GENERATE REFS(R0,R1,R4,R7,R14,R15) SETS(R0,R1,R4,R7,R14,R15)
*           CODE;                                                  1303
GETCORE  GETMAIN RC,LV=(0),SP=245,BRANCH=YES,                         **
               RELATED=(SPCT-EXT,IEAVSOUT(FREECORE))
*       RESPECIFY                                                  1304
*        (R15) RSTD;                                               1304
*       PVTPTR=CVTPVTP;             /* RESTORE THE PVT POINTER.      */
         L     @14,CVTPTR                                          1305
         L     PVTPTR,CVTPVTP(,@14)                                1305
*       PVTPRCA=SAVERCA;            /* RESTORE THE RCA ADDRESS.      */
         L     @14,CALLER13(,PVTPTR)                               1306
         MVC   PVTPRCA(4,PVTPTR),SAVERCA(@14)                      1306
*       R4=REG4SAVE;                /* RESTOR REGISTER 4             */
         L     R4,REG4SAVE(,@14)                                   1307
*       R7=REG7SAVE;                /* RESTORE REG 7.                */
         L     R7,REG7SAVE(,PVTPTR)                                1308
*       IF R15^=0 THEN              /* TEST FOR A BAD RETURN CODE.   */
         LTR   R15,R15                                             1309
         BZ    @RF01309                                            1309
*         DO;                       /* RETURN CODE IS BAD. STOP THE
*                                      SWAP OUT, BUT IT CAN BE TRIED
*                                      AGAIN LATER.                  */
*           R0='05'X;               /* RECORD GETMAIN FAILURE        */
         LA    R0,5                                                1311
*           CALL DOABEND;           /* RECORD THE ERROR              */
         BAL   @14,DOABEND                                         1312
*           IF PURGDON='0'B THEN    /* HAS PAGING BEEN PURGED        */
         TM    PURGDON(PVTPTR),B'00001000'                         1313
         BNZ   @RF01313                                            1313
*             RETURN TO CLEANUP1;   /* ABORT SWAPOUT                 */
         LA    @14,CLEANUP1                                        1314
@EL00011 DS    0H                                                  1314
@EF00011 DS    0H                                                  1314
@ER00011 BR    @14                                                 1314
*           RETNCODE=TRYLATER;      /* SET CALLERS RETURN CODE TO  1315
*                                      STOP SWAP OUT AND TRY AGAIN 1315
*                                      LATER.                        */
@RF01313 MVC   RETNCODE(4,PVTPTR),@CF00057                         1315
*           GOTO EXITEXT;           /* GO TO THE EXIT POINT.         */
         B     EXITEXT                                             1316
*         END;                                                     1317
*       RESPECIFY                                                  1318
*        (R15) UNRESTRICTED;                                       1318
@RF01309 DS    0H                                                  1319
*       SWAPPTR=R1;                 /* GET THE ADDRESS OF THE NEW  1319
*                                      EXTENSION.                    */
         LR    SWAPPTR,R1                                          1319
*       SWAPPTR->SPCTEXTM=SWAPPTR->SPCTEXTM&&SWAPPTR->SPCTEXTM;/*  1320
*                                      CLEAR ENTIRE NEW EXTENSION  1320
*                                                            @YM03600*/
         XC    SPCTEXTM(56,SWAPPTR),SPCTEXTM(SWAPPTR)              1320
*       R1=TEMPSAVE;                /* RESTORE REG 1.                */
         L     R1,TEMPSAVE(,PVTPTR)                                1321
*       BEGPTR->SPCTEXT=SWAPPTR;    /* CHAIN THE PREVIOUS EXTENSION
*                                      TO POINT TO THE NEW EXTENSION.*/
         ST    SWAPPTR,SPCTEXT(,BEGPTR)                            1322
*     END;                          /* END OF GETMAIN PROCESSING.    */
*   ELSE                            /* AN UNUSED EXTENSION ALREADY 1324
*                                      EXISTS AND CAN BE USED.       */
*     DO;                           /*                       @YM03600*/
         B     @RC01294                                            1324
@RF01294 DS    0H                                                  1325
*       SWAPPTR=BEGPTR->SPCTEXT;    /* GET THE ADDRESS OF THE UNUSED
*                                      EXTENSION.                    */
         L     SWAPPTR,SPCTEXT(,BEGPTR)                            1325
*       SWAPPTR->SPCTENT=SWAPPTR->SPCTENT&&SWAPPTR->SPCTENT;/* ZERO
*                                      THE NEW EXTENSION. MAKE SURE
*                                      THAT ONLY THE ENTRY PART IS 1326
*                                      ZEROED. AN OLD EXTENSION MAY
*                                      HAVE THE ADDRESS OF ANOTHER 1326
*                                      EXTENSION.                    */
         XC    SPCTENT(48,SWAPPTR),SPCTENT(SWAPPTR)                1326
*     END;                          /*                       @YM03600*/
*   BEGEXT=SWAPPTR;                 /* SAVE THE BEGINNING ADDRESS OF
*                                      THE NEW LAST EXTENSION.       */
@RC01294 ST    SWAPPTR,BEGEXT(,PVTPTR)                             1328
*   BEGPTR=SWAPPTR;                 /* LOAD SAME ADDRESS INTO A    1329
*                                      REGISTER FOR WORK.            */
         LR    BEGPTR,SWAPPTR                                      1329
*   ENDPTR=SWAPPTR+LENGTH(SPCTEXTM);/* GET THE END ADDRESS OF THE NEW
*                                      LAST EXTENSION IN A REGISTER. */
         LA    ENDPTR,56                                           1330
         ALR   ENDPTR,SWAPPTR                                      1330
*   SWAPPTR=SWAPPTR+(LENGTH(SPCTEXTM)-LENGTH(SPCTENT));/* GET THE  1331
*                                      ADDRESS OF THE FIRST AVAILABLE
*                                      ENTRY IN THE NEW EXTENSION.   */
*                                                                  1331
         AL    SWAPPTR,@CF00057                                    1331
*   /*****************************************************************/
*   /*                                                               */
*   /* EXIT GET EXTENSION PROCESSOR                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1332
*EXITEXT:                                                          1332
*   RESPECIFY                                                      1332
*    (R14) RESTRICTED;                                             1332
EXITEXT  DS    0H                                                  1333
*   R14=LEV4RTN;                    /* GET THE RETURN ADDRESS.       */
         L     R14,LEV4RTN(,PVTPTR)                                1333
*   RESPECIFY                                                      1334
*    (R1,                                                          1334
*     R4,                                                          1334
*     SWAPPTR,                                                     1334
*     PFTEPTR,                                                     1334
*     BEGPTR,                                                      1334
*     ENDPTR,                                                      1334
*     R14) UNRESTRICTED;                                           1334
*   END GETEXT;                                                    1335
         B     @EL00011                                            1335
*                                                                  1336
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SECTION RECORDS AN ERROR DETECTED BY THE SWAP OUT        */
*   /* PROCESSOR                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1336
*DOABEND:                                                          1336
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1336
DOABEND  DS    0H                                                  1337
*   RESPECIFY                                                      1337
*    (R1,                                                          1337
*     R4,                                                          1337
*     R5,                                                          1337
*     R6,                                                          1337
*     R11,                                                         1337
*     R12,                                                         1337
*     R14) RESTRICTED;                                             1337
*   R1=PVTPRCA;                     /* GET THE RCA ADDRESS.          */
         L     R1,PVTPRCA(,PVTPTR)                                 1338
*   R1->RCARCRD=R0;                 /* SET THE REASON CODE: RECORD 1339
*                                      ONLY.                         */
         STC   R0,RCARCRD(,R1)                                     1339
*   GENERATE CODE SETS(R1);                                        1340
         ABEND X'C0D',,,SYSTEM      RECORD THE ERROR
*   RESPECIFY                                                      1341
*    (R1,                                                          1341
*     R4,                                                          1341
*     R5,                                                          1341
*     R6,                                                          1341
*     R11,                                                         1341
*     R12,                                                         1341
*     R14) RESTRICTED;                                             1341
*   END DOABEND;                                                   1342
@EL00012 DS    0H                                                  1342
@EF00012 DS    0H                                                  1342
@ER00012 BR    @14                                                 1342
@PB00012 DS    0H                                                  1342
*   END IEAVSOUT                                                   1343
*                                                                  1343
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAASXB )                                       */
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHAFOE  )                                       */
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */
*/*%INCLUDE SYSLIB  (IHAOUXB )                                       */
*/*%INCLUDE SYSLIB  (IHAPCB  )                                       */
*/*%INCLUDE SYSLIB  (IHAPCBR )                                       */
*/*%INCLUDE SYSLIB  (IHAPFTE )                                       */
*/*%INCLUDE SYSLIB  (IHAPGTE )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHAPVT  )                                       */
*/*%INCLUDE SYSLIB  (IHARCA  )                                       */
*/*%INCLUDE SYSLIB  (IHARSMHD)                                       */
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */
*/*%INCLUDE SYSLIB  (IHASPCT )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHAXPTE )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (ILRAIA  )                                       */
*                                                                  1343
*       ;                                                          1343
@DATA    DS    0H
@DATD    DSECT
         DS    0F
IEAVSOUT CSECT
         DS    0F
@CF00064 DC    F'1'
@CF00039 DC    F'4'
@CF00970 DC    F'6'
@CF00057 DC    F'8'
@CF02696 DC    F'-48'
@CF02502 DC    XL4'80000000'
@CF02506 DC    XL4'0000000F'
@CF02704 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
@ENDDATD EQU   *
IEAVSOUT CSECT
         NOPR  ((@ENDDATD-@DATD)*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV02498 DC    V(IEAVSSNQ)
         DS    0D
SOUTENTR DC    XL4'00001000'
@CC02532 DC    C'SRB '
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FOEPTR   EQU   @13
PCBPTR   EQU   @07
PCBRPTR  EQU   @13
PFTEPTR  EQU   @11
PTEPTR   EQU   @01
PVTPTR   EQU   @03
RSMHDPTR EQU   @02
SPCTPTR  EQU   @08
SWAPPTR  EQU   @12
SRBPTR   EQU   @01
XPTEPTR  EQU   @01
TCBPTR   EQU   @04
R0       EQU   @00
R1       EQU   @01
LRAREG   EQU   @01
R2       EQU   @02
R4       EQU   @04
R5       EQU   @05
BEGPTR   EQU   @05
R6       EQU   @06
ENDPTR   EQU   @06
SAVEEXT  EQU   @06
R7       EQU   @07
BASEREG2 EQU   @09
BASEREG  EQU   @10
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
R10      EQU   @10
R3       EQU   @03
R8       EQU   @08
R9       EQU   @09
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
FLCCVT   EQU   FLCICCW2
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBASID EQU   ASCB+36
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBTERM EQU   ASCBFLG1
ASCBASXB EQU   ASCB+108
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBOUXB EQU   ASCB+148
ASCBFMCT EQU   ASCB+152
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASXB     EQU   0
ASXBFTCB EQU   ASXB+4
ASXBSPSA EQU   ASXB+112
ASXBAEQ  EQU   ASXB+168
ASXBSECR EQU   ASXB+199
ASCBSFLG EQU   ASXBSECR
ASXBCASW EQU   ASXB+216
ASXBCRB1 EQU   ASXBCASW
WSAL     EQU   0
WSALRSM  EQU   WSAL+52
CVTMAP   EQU   0
CVT      EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTABEND EQU   CVTMAP+200
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
FOE      EQU   0
FOEFLNKF EQU   FOE
FOEFLAG  EQU   FOEFLNKF
FOEFLINK EQU   FOEFLNKF+1
FOEVINDX EQU   FOE+4
FOEFXCT  EQU   FOE+6
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSEMP  EQU   FRRSHEAD
FRRSLAST EQU   FRRSHEAD+4
FRRSELEN EQU   FRRSHEAD+8
FRRSCURR EQU   FRRSHEAD+12
FRRSENTR EQU   0
FRRSFRRA EQU   FRRSENTR
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
FRRSPARM EQU   FRRSENTR+8
OUXB     EQU   0
OUXBSTC  EQU   OUXB+54
PCB      EQU   0
PCBFQP   EQU   PCB
PCBFQPA  EQU   PCBFQP+1
PCBBQP   EQU   PCB+4
PCBBQPA  EQU   PCBBQP
PCBRTP   EQU   PCB+8
PCBFL1   EQU   PCBRTP
PCBSRBMD EQU   PCBFL1
PCBROOT  EQU   PCBFL1
PCBIOI   EQU   PCBFL1
PCBIOCMP EQU   PCBFL1
PCBRTPA  EQU   PCBRTP+1
PCBRLP   EQU   PCB+12
PCBFXC   EQU   PCBRLP
PCBRLPA  EQU   PCBRLP+1
PCBXPT   EQU   PCB+16
PCBFL2   EQU   PCBXPT
PCBFREAL EQU   PCBFL2
PCBIOERR EQU   PCBFL2
PCBRESET EQU   PCBFL2
PCBSUPRS EQU   PCBFL2
PCBXPTA  EQU   PCBXPT+1
PCBPGT   EQU   PCB+20
PCBFL3   EQU   PCBPGT
PCBSWPOT EQU   PCBFL3
PCBPGTA  EQU   PCBPGT+1
PCBRBN   EQU   PCB+24
PCBVBN   EQU   PCB+26
PCBBLOCK EQU   PCB+28
PCBSRB   EQU   PCBBLOCK
PCBRB    EQU   PCBSRB
PCBSPCTE EQU   PCBRB
PCBASCB  EQU   PCB+32
PCBAIA   EQU   PCB+36
PCBR     EQU   0
PCBRTCB  EQU   PCBR
PCBRFLAG EQU   PCBRTCB
PCBRFAIL EQU   PCBRFLAG
PCBRTCBA EQU   PCBRTCB+1
PCBRGOTO EQU   PCBR+4
PCBRECB  EQU   PCBR+8
PCBRCNT  EQU   PCBR+16
PFTE     EQU   0
PFTPGID  EQU   PFTE
PFTVBN   EQU   PFTPGID+2
PFTQPTRS EQU   PFTE+4
PFTFQPTR EQU   PFTQPTRS
PFTBQPTR EQU   PFTQPTRS+2
PFTFXCT  EQU   PFTE+8
PFTFLAGS EQU   PFTE+12
PFTFLAG1 EQU   PFTFLAGS
PFTLSQA  EQU   PFTFLAG1
PFTVRPLT EQU   PFTFLAG1
PFTPCBSI EQU   PFTFLAG1
PFTBADPG EQU   PFTFLAG1
PFTFLAG2 EQU   PFTFLAGS+1
PFTDFRLS EQU   PFTFLAG2
PFTIRRG  EQU   PFTFLAG2
PFTPREF  EQU   PFTFLAG2
PFTUIC   EQU   PFTE+15
PGTPTE   EQU   0
PGTRSA   EQU   PGTPTE
PGTBITS  EQU   PGTRSA+1
PGTPVM   EQU   PGTBITS
PVT      EQU   0
PVTFLAG1 EQU   PVT
PVTFLAG2 EQU   PVT+1
PVTPFTP  EQU   PVT+12
PVTLCSA  EQU   PVT+26
PVTPRCA  EQU   PVT+52
PVTPCB   EQU   PVT+104
PVTPFTE  EQU   PVT+108
PVTPFP2  EQU   PVT+116
PVTPPIOI EQU   PVT+128
PVTPRCV  EQU   PVT+156
PVTPSWPC EQU   PVT+168
PVTPSRBP EQU   PVT+188
PVTPRELF EQU   PVT+216
PVTPOPBR EQU   PVT+220
PVTPAGIO EQU   PVT+236
PVTPRSET EQU   PVT+244
PVTSPFR  EQU   PVT+302
PVTQS    EQU   PVT+304
PVTWSAX  EQU   PVT+344
PVTWSA15 EQU   PVTWSAX+1040
PVTSAVE  EQU   PVTWSAX+1328
PVTCNTFX EQU   PVT+1830
PVTCOMFX EQU   PVT+1834
PVTPCBQS EQU   PVT+1852
PVTGFADL EQU   PVTPCBQS+28
PVTCIOQL EQU   PVTPCBQS+36
RCA      EQU   0
RCANAME7 EQU   RCA+8
RCACSECT EQU   RCA+9
RCAFLAGS EQU   RCA+10
RCASAL   EQU   RCAFLAGS
RCARCRD  EQU   RCA+11
RCANAMES EQU   RCA+12
RCANAME1 EQU   RCANAMES
RCANAME2 EQU   RCANAMES+1
RCANAME3 EQU   RCANAMES+2
RCANAME4 EQU   RCANAMES+3
RCASOUT  EQU   RCANAME4
RCANAME5 EQU   RCANAMES+4
RCANAME6 EQU   RCANAMES+5
RSMHD    EQU   0
RSMSPCT  EQU   RSMHD+4
RSMFLG1  EQU   RSMHD+12
RSMCPNU  EQU   RSMFLG1
RSMCPNC  EQU   RSMFLG1
RSMRSV1  EQU   RSMHD+13
RSMCNTFX EQU   RSMHD+14
RSMQS    EQU   RSMHD+20
RSMLFQ   EQU   RSMQS
RSMLFQF  EQU   RSMLFQ
RSMLSQA  EQU   RSMQS+4
RSMLSQAF EQU   RSMLSQA
RSMLIOQ  EQU   RSMQS+8
RSMLIOQL EQU   RSMLIOQ+4
SCVTSECT EQU   0
SCVTSTAT EQU   SCVTSECT+148
SPCT     EQU   0
SPCTSWRT EQU   SPCT
SPCTFIX  EQU   SPCT+4
SPCTLSQA EQU   SPCT+6
SPCTSSEG EQU   SPCT+9
SPCTFLG1 EQU   SPCT+10
SPCTSWIN EQU   SPCTFLG1
SPCTOUT  EQU   SPCTFLG1
SPCTPURG EQU   SPCTFLG1
SPCTPSET EQU   SPCTFLG1
SPCTWSSZ EQU   SPCT+12
SPCTSWAP EQU   SPCT+16
SPCTSEGS EQU   SPCT+72
SPCTSEGE EQU   0
SPCTSEGX EQU   SPCTSEGE
SPCTBITM EQU   SPCTSEGE+4
SEGSPTR  EQU   0
SPCTSWPE EQU   0
SPCTLS   EQU   SPCTSWPE
SPCTFLAG EQU   SPCTLS
SPCTLVAL EQU   SPCTFLAG
SPCTLSQ  EQU   SPCTFLAG
SPCTCOMM EQU   SPCTFLAG
SPCTDEFR EQU   SPCTFLAG
SPCTSSID EQU   SPCTLS+1
SPCTVBN  EQU   SPCTLS+4
SPCTFIXC EQU   SPCTSWPE+6
SPCTEXTM EQU   0
SPCTEXT  EQU   SPCTEXTM
SPCTENT  EQU   SPCTEXTM+8
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBID    EQU   SRB
SRBFLNK  EQU   SRB+4
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBPASID EQU   SRBFLC+2
SRBEP    EQU   SRB+20
SRBRMTR  EQU   SRB+24
SRBPARM  EQU   SRB+28
SRBPRIOR EQU   SRB+37
XPTE     EQU   0
XPTPROT  EQU   XPTE
XPTFLAGS EQU   XPTE+2
XPTVIOLP EQU   XPTFLAGS
XPTXAV   EQU   XPTFLAGS
XPTVIO   EQU   XPTFLAGS
XPTDEFER EQU   XPTFLAGS
XPTFLAG2 EQU   XPTE+3
XPTLPID  EQU   XPTE+4
XPTLGN   EQU   XPTLPID
XPTLPN   EQU   XPTLPID+4
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTCB   EQU   TCB+116
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBXSCT  EQU   TCB+240
TCBXSCT1 EQU   TCBXSCT
TCBFOE   EQU   TCB+244
TCBFOEA  EQU   TCBFOE+1
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
REGSAVER EQU   0
SAVERCA  EQU   REGSAVER+8
REG4SAVE EQU   REGSAVER+12
SAVER15  EQU   REGSAVER+68
SOUTPARM EQU   0
SOUTFLGS EQU   SOUTPARM+4
NLSQAPCB EQU   SOUTPARM+5
SRMPARMS EQU   SOUTPARM+8
SOUTWRKA EQU   SOUTPARM+16
LSQAPCBS EQU   SOUTWRKA+1
PIOISRB  EQU   SOUTPARM+20
ROOTEXIT EQU   0
IEAVFP2  EQU   0
IEAVPCB  EQU   0
IEAVRSET EQU   0
IEAVPFTE EQU   0
IEAVOPBR EQU   0
IEAVRELF EQU   0
ILRPAGIO EQU   0
IEAVSWPC EQU   0
STATUS   EQU   0
FOEEND   EQU   0
PGTEND   EQU   0
ASCBPTR  EQU   PSAAOLD
CVTS01   EQU   CVTPGSIA
CVTPVTP  EQU   CVTS01+8
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTOPTE  EQU   CVTS01+188
CVTASVT  EQU   CVTS01+208
CVTGSMQ  EQU   CVTS01+264
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
ASVTPTR  EQU   CVTASVT
ASXBPTR  EQU   ASCBASXB
CVTPTR   EQU   FLCCVT
OUXBPTR  EQU   ASCBOUXB
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
PSACSTK  EQU   PSARSVTE
RCAPTR   EQU   PVTPRCA
FRPINCNT EQU   RSMRSV1
SCVTSPTR EQU   CVTABEND
RSMAIA   EQU   PCBAIA
AIA      EQU   RSMAIA
AIAFLG1  EQU   AIA+9
AIAWRITE EQU   AIAFLG1
AIAPRIV  EQU   AIAFLG1
AIALSQA  EQU   AIAFLG1
AIASWPFX EQU   AIAFLG1
AIAFLG2  EQU   AIA+10
AIAFLG3  EQU   AIA+11
AIANXAIA EQU   AIA+12
AIAID    EQU   AIA+16
AIALPID  EQU   AIAID
AIALGID  EQU   AIALPID
AIALSID  EQU   AIALGID
AIASSID  EQU   AIALSID+1
AIARPN   EQU   AIALPID+4
AIALSID2 EQU   AIARPN
AIALPMEP EQU   AIALSID2
AIAGRPSZ EQU   AIA+24
AIALGE   EQU   AIAGRPSZ
WORKAREA EQU   PVTWSA15
@NM00096 EQU   WORKAREA
FLAGS    EQU   @NM00096
DOINGGFA EQU   FLAGS
DOINGCOM EQU   FLAGS
MASKFLG  EQU   FLAGS
KEEPPCB  EQU   FLAGS
PURGDON  EQU   FLAGS
NOSPCTE  EQU   FLAGS
FPCALLED EQU   FLAGS
PTRPCBS  EQU   @NM00096+1
@NM00098 EQU   WORKAREA+4
ROOTCNT  EQU   @NM00098
FMCTASCB EQU   @NM00098+2
PTRFIRST EQU   WORKAREA+8
PTRLAST  EQU   WORKAREA+12
FIXBEG   EQU   WORKAREA+16
BEGEXT   EQU   WORKAREA+20
LEV1RTN  EQU   WORKAREA+24
LEV2RTN  EQU   WORKAREA+28
LEV3RTN  EQU   WORKAREA+32
LEV4RTN  EQU   WORKAREA+36
NEXTPCB  EQU   WORKAREA+40
LASTRLT  EQU   WORKAREA+44
LSQAEXT  EQU   WORKAREA+48
REG7SAVE EQU   WORKAREA+52
TEMPSAVE EQU   WORKAREA+56
PAFIX    EQU   WORKAREA+60
RETNCODE EQU   WORKAREA+64
CALLER13 EQU   WORKAREA+68
AREAPCB  EQU   PCB
AREA     EQU   AREAPCB+8
OPTLIST  EQU   SRMPARMS
@NM00101 EQU   OPTLIST
OPTSOUT  EQU   @NM00101
OPTSIN   EQU   @NM00101+2
@NM00102 EQU   OPTLIST+4
OPTSPFR  EQU   @NM00102
@NM00104 EQU   @NM00102+3
*                                      START UNREFERENCED COMPONENTS
OPTWAIT  EQU   @NM00104
OPTOK    EQU   @NM00104
@NM00105 EQU   @NM00104
@NM00103 EQU   @NM00102+2
@NM00099 EQU   AREAPCB
@NM00097 EQU   FLAGS
AIADPXCT EQU   AIALGE
AIACEPTR EQU   AIALPMEP
AIASLOT  EQU   AIASSID+1
@NM00093 EQU   AIASSID
@NM00092 EQU   AIALSID
AIARCSN  EQU   AIANXAIA+2
AIACYL   EQU   AIANXAIA
AIARSV9  EQU   AIAFLG3
AIARSV8  EQU   AIAFLG3
AIARSV7  EQU   AIAFLG3
AIALPMEC EQU   AIAFLG3
AIARSV6  EQU   AIAFLG3
AIATRPSP EQU   AIAFLG3
AIAPRINO EQU   AIAFLG3
AIARSV5  EQU   AIAFLG3
AIABADID EQU   AIAFLG2
AIAERROR EQU   AIAFLG2
AIASECER EQU   AIAFLG2
AIAPRIER EQU   AIAFLG2
AIARSV4  EQU   AIAFLG2
AIAIORTY EQU   AIAFLG2
AIATERMR EQU   AIAFLG2
AIAFRAUX EQU   AIAFLG2
AIARSV1  EQU   AIAFLG1
AIAPAGDS EQU   AIAFLG1
AIADUPLX EQU   AIAFLG1
AIAVIO   EQU   AIAFLG1
AIAOP    EQU   AIA+8
AIABQPA  EQU   AIA+4
AIAFQPA  EQU   AIA
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
QINDEX   EQU   SOUTWRKA
@NM00100 EQU   SOUTFLGS
SOUTINT  EQU   SOUTFLGS
FWRDPTR  EQU   SOUTPARM
SAVER14  EQU   REGSAVER+64
SAVER13  EQU   REGSAVER+60
SAVER12  EQU   REGSAVER+56
SAVER11  EQU   REGSAVER+52
SAVER10  EQU   REGSAVER+48
SAVER9   EQU   REGSAVER+44
SAVER8   EQU   REGSAVER+40
SAVER7   EQU   REGSAVER+36
SAVER6   EQU   REGSAVER+32
SAVER5   EQU   REGSAVER+28
SAVER4   EQU   REGSAVER+24
SAVER3   EQU   REGSAVER+20
SAVER2   EQU   REGSAVER+16
@NM00095 EQU   REGSAVER+4
@NM00094 EQU   REGSAVER
@NM00091 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00090 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBRV327 EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBRV326 EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBSTAWA EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBRSV42 EQU   TCBFOE
TCBCCPVI EQU   TCBXSCT+2
TCBRV325 EQU   TCBXSCT+1
TCBRV324 EQU   TCBXSCT1
TCBRV323 EQU   TCBXSCT1
TCBRV322 EQU   TCBXSCT1
TCBRV321 EQU   TCBXSCT1
TCBRV320 EQU   TCBXSCT1
TCBRV319 EQU   TCBXSCT1
TCBS3A   EQU   TCBXSCT1
TCBACTIV EQU   TCBXSCT1
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00089 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00088 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
XPTLSID2 EQU   XPTLPN
XPTLSID  EQU   XPTLGN
@NM00087 EQU   XPTFLAG2
XPTIOERR EQU   XPTFLAG2
XPTPOINP EQU   XPTFLAG2
XPTRES1  EQU   XPTFLAG2
XPTVALID EQU   XPTFLAG2
XPTRSV4  EQU   XPTFLAGS
XPTRES2  EQU   XPTFLAGS
@NM00086 EQU   XPTFLAGS
XPTCKF   EQU   XPTFLAGS
XPTRSV1  EQU   XPTE+1
@NM00085 EQU   SRB+40
@NM00084 EQU   SRB+38
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBPTCB  EQU   SRBFLC+4
SRBCPAFF EQU   SRBFLC
SPCTXEND EQU   SPCTENT+48
SPCTENTS EQU   SPCTENT
@NM00083 EQU   SPCTEXTM+4
@NM00082 EQU   SPCTFLAG
SPCTPGT  EQU   SPCTSEGE+1
SPCTSIZE EQU   SPCT+14
SPCTIDEN EQU   SPCT+11
@NM00081 EQU   SPCTFLG1
SPCTVROT EQU   SPCTFLG1
SPCTBIG  EQU   SPCTFLG1
SPCTNSEG EQU   SPCT+8
@NM00080 EQU   SCVTSECT+180
@NM00079 EQU   SCVTSECT+176
SCVTPIQE EQU   SCVTSECT+172
@NM00078 EQU   SCVTSECT+168
SCVTPTRM EQU   SCVTSECT+164
@NM00077 EQU   SCVTSECT+160
@NM00076 EQU   SCVTSECT+156
SCVTQCBR EQU   SCVTSECT+152
@NM00075 EQU   SCVTSECT+144
SCVTTQE  EQU   SCVTSECT+140
@NM00074 EQU   SCVTSECT+136
SCVTSVCT EQU   SCVTSECT+132
@NM00073 EQU   SCVTSECT+128
@NM00072 EQU   SCVTSECT+124
SCVTRXLQ EQU   SCVTSECT+120
@NM00071 EQU   SCVTSECT+116
SCVTCTCB EQU   SCVTSECT+112
@NM00070 EQU   SCVTSECT+108
@NM00069 EQU   SCVTSECT+104
@NM00068 EQU   SCVTSECT+100
@NM00067 EQU   SCVTSECT+96
SCVTCOMM EQU   SCVTSECT+92
@NM00066 EQU   SCVTSECT+88
@NM00065 EQU   SCVTSECT+84
@NM00064 EQU   SCVTSECT+80
@NM00063 EQU   SCVTSECT+76
@NM00062 EQU   SCVTSECT+72
SCVTGMBR EQU   SCVTSECT+68
SCVTRPTR EQU   SCVTSECT+64
SCVTHSKP EQU   SCVTSECT+60
@NM00061 EQU   SCVTSECT+56
@NM00060 EQU   SCVTSECT+52
SCVTLFRM EQU   SCVTSECT+48
SCVTCDCL EQU   SCVTSECT+44
@NM00059 EQU   SCVTSECT+40
SCVTRACE EQU   SCVTSECT+36
@NM00058 EQU   SCVTSECT+32
SCVTRMBR EQU   SCVTSECT+28
@NM00057 EQU   SCVTSECT+24
@NM00056 EQU   SCVTSECT+20
@NM00055 EQU   SCVTSECT+16
@NM00054 EQU   SCVTSECT+14
SCVTBR14 EQU   SCVTSECT+12
SCVTSPET EQU   SCVTSECT+8
SCVTPGWR EQU   SCVTSECT+4
SCVTPGTM EQU   SCVTSECT
RSMASMHD EQU   RSMHD+40
RSMFOEQ  EQU   RSMHD+36
RSMLIOQF EQU   RSMLIOQ
RSMLSQAL EQU   RSMLSQA+2
RSMLFQL  EQU   RSMLFQ+2
RSMRSV2  EQU   RSMHD+16
@NM00053 EQU   RSMFLG1
RSMFAIL  EQU   RSMFLG1
RSMGFADD EQU   RSMFLG1
RSMGFAD  EQU   RSMFLG1
RSMIOCPC EQU   RSMFLG1
RSMIOCPU EQU   RSMFLG1
RSMASCB  EQU   RSMHD+8
RSMVSTO  EQU   RSMHD
RCARETAD EQU   RCA+20
RCATASID EQU   RCA+18
RCAREP1  EQU   RCANAME6
RCAPSIF  EQU   RCANAME6
RCAPSIX  EQU   RCANAME6
RCAVEQRP EQU   RCANAME6
RCARCFC  EQU   RCANAME6
RCACSGB  EQU   RCANAME6
RCAFXL   EQU   RCANAME6
RCAPS113 EQU   RCANAME6
RCAFREE  EQU   RCANAME5
RCARFR2  EQU   RCANAME5
RCACPBR  EQU   RCANAME5
RCAOPBR  EQU   RCANAME5
RCASORT  EQU   RCANAME5
RCASIRT  EQU   RCANAME5
RCARELV  EQU   RCANAME5
RCARELF  EQU   RCANAME5
RCAGFAD  EQU   RCANAME4
RCAVEQRI EQU   RCANAME4
RCAVEQRF EQU   RCANAME4
RCAVEQRC EQU   RCANAME4
RCATERM  EQU   RCANAME4
RCASQA   EQU   RCANAME4
RCASWIN  EQU   RCANAME4
RCARFR   EQU   RCANAME3
RCARELS  EQU   RCANAME3
RCARCFI  EQU   RCANAME3
RCARCF   EQU   RCANAME3
RCAPSII  EQU   RCANAME3
RCAPSIB  EQU   RCANAME3
RCAPS112 EQU   RCANAME3
RCAPIX   EQU   RCANAME3
RCAPIOP  EQU   RCANAME2
RCASWPC  EQU   RCANAME2
RCASWPP  EQU   RCANAME2
RCAPFTE  EQU   RCANAME2
RCAPCB   EQU   RCANAME2
RCAOUT   EQU   RCANAME2
RCAITAS  EQU   RCANAME2
RCAIOCP  EQU   RCANAME2
RCAINV   EQU   RCANAME1
RCAGFA   EQU   RCANAME1
RCAFXLD  EQU   RCANAME1
RCAVEQR  EQU   RCANAME1
RCADSEG  EQU   RCANAME1
RCADLAS  EQU   RCANAME1
RCACSEG  EQU   RCANAME1
RCAVAMSI EQU   RCANAME1
@NM00052 EQU   RCAFLAGS
RCADISP  EQU   RCAFLAGS
@NM00051 EQU   RCAFLAGS
RCAQS    EQU   RCAFLAGS
RCAPSIER EQU   RCAFLAGS
RCAABEND EQU   RCAFLAGS
RCALL    EQU   RCAFLAGS
@NM00050 EQU   RCANAME7
RCAPRSS  EQU   RCANAME7
RCAPRSR  EQU   RCANAME7
RCAPRSB  EQU   RCANAME7
RCAPSIY  EQU   RCANAME7
RCAPIOI  EQU   RCANAME7
RCAPARM1 EQU   RCA+4
RCAPARM0 EQU   RCA
PVTEND   EQU   PVT+1944
PVTTASID EQU   PVT+1942
PVTXXXXX EQU   PVT+1940
PVTMVCLC EQU   PVT+1936
PVTVCONS EQU   PVT+1896
PVTPRSB  EQU   PVT+1892
PVTCIOQF EQU   PVTPCBQS+32
PVTGFADF EQU   PVTPCBQS+24
PVTFPCBL EQU   PVTPCBQS+20
PVTFPCBF EQU   PVTPCBQS+16
PVTPCBQR EQU   PVTPCBQS
PVTLPAFX EQU   PVT+1850
PVTLSQAF EQU   PVT+1848
PVTLPAR  EQU   PVT+1844
PVTLPAI  EQU   PVT+1840
PVTLPAFC EQU   PVT+1838
PVTCHUIC EQU   PVT+1836
PVTSQAFX EQU   PVT+1832
PVTDEFFX EQU   PVT+1828
PVTFIXOK EQU   PVT+1826
PVTPEROK EQU   PVT+1824
PVTMAXFX EQU   PVT+1822
PVTPERFX EQU   PVT+1820
PVTRSRB  EQU   PVT+1776
PVTRESV5 EQU   PVT+1773
PVTSRBS  EQU   PVT+1772
PVTSSRB  EQU   PVT+1768
PVTACA   EQU   PVTWSAX+1400
PVTWSA18 EQU   PVTWSAX+1256
PVTWSA17 EQU   PVTWSAX+1184
PVTWSA16 EQU   PVTWSAX+1112
PVTWSA14 EQU   PVTWSAX+968
PVTWSA13 EQU   PVTWSAX+896
PVTWSA12 EQU   PVTWSAX+824
PVTWSA11 EQU   PVTWSAX+752
PVTWSA10 EQU   PVTWSAX+672
PVTWSA9  EQU   PVTWSAX+592
PVTWSA8  EQU   PVTWSAX+504
PVTWSA7  EQU   PVTWSAX+432
PVTWSA6  EQU   PVTWSAX+360
PVTWSA5  EQU   PVTWSAX+288
PVTWSA4  EQU   PVTWSAX+216
PVTWSA3  EQU   PVTWSAX+144
PVTWSA2  EQU   PVTWSAX+72
PVTWSA1  EQU   PVTWSAX
PVTPFTQR EQU   PVTQS+20
PVTRSBQL EQU   PVTQS+18
PVTRSBQF EQU   PVTQS+16
PVTSQAQL EQU   PVTQS+14
PVTSQAQF EQU   PVTQS+12
PVTCFQL  EQU   PVTQS+10
PVTCFQF  EQU   PVTQS+8
PVTRSRVL EQU   PVTQS+6
PVTRSRVF EQU   PVTQS+4
PVTAFQL  EQU   PVTQS+2
PVTAFQF  EQU   PVTQS
PVTCFMCT EQU   PVT+300
PVTSPREC EQU   PVT+296
PVTCAREC EQU   PVT+292
PVTCAOUT EQU   PVT+288
PVTCAIN  EQU   PVT+284
PVTNSWPS EQU   PVT+280
PVTNPREC EQU   PVT+276
PVTSPOUT EQU   PVT+272
PVTSPIN  EQU   PVT+268
PVTVAMR  EQU   PVT+264
PVTVAMO  EQU   PVT+260
PVTVAMI  EQU   PVT+256
PVTNPOUT EQU   PVT+252
PVTNPIN  EQU   PVT+248
PVTFRSLT EQU   PVT+240
PVTSWPIO EQU   PVT+232
PVTPSWPP EQU   PVT+228
PVTPPREF EQU   PVT+224
PVTPRELV EQU   PVT+212
PVTPFREE EQU   PVT+208
PVTPRELS EQU   PVT+204
PVTPOUT  EQU   PVT+200
PVTPFXLD EQU   PVT+196
PVTPITAS EQU   PVT+192
PVTPDSEG EQU   PVT+184
PVTPCSGB EQU   PVT+180
PVTPCSEG EQU   PVT+176
PVTPINV  EQU   PVT+172
PVTPSOUT EQU   PVT+164
PVTPSWIN EQU   PVT+160
PVTPRCFI EQU   PVT+152
PVTPRCF  EQU   PVT+148
PVTPVRC  EQU   PVT+144
PVTPVRIN EQU   PVT+140
PVTPVRLS EQU   PVT+136
PVTPVEQR EQU   PVT+132
PVTPVRPO EQU   PVT+124
PVTPRFR  EQU   PVT+120
PVTPFP   EQU   PVT+112
PVTREP2  EQU   PVT+100
PVTPIOCP EQU   PVT+96
PVTPIOP  EQU   PVT+92
PVTPGFAD EQU   PVT+88
PVTPGFA  EQU   PVT+84
PVTPSQA  EQU   PVT+80
PVTPSINT EQU   PVT+76
PVTPSIB  EQU   PVT+72
PVTSRBID EQU   PVT+68
PVTPCIWA EQU   PVT+64
PVTHQSA  EQU   PVT+62
PVTLQSA  EQU   PVT+60
PVTOROOT EQU   PVT+56
PVTREUS  EQU   PVT+48
PVTSQNPC EQU   PVT+47
PVTSQVRC EQU   PVT+46
PVTRSUS  EQU   PVT+44
PVTVROOT EQU   PVT+40
PVTPCBLO EQU   PVT+38
PVTPCBCT EQU   PVT+36
PVTDFRS  EQU   PVT+34
PVTRSQA  EQU   PVT+32
PVTPTLB  EQU   PVT+31
PVTPCBNO EQU   PVT+30
PVTSRBNO EQU   PVT+29
PVTSQDC  EQU   PVT+28
PVTLPRIV EQU   PVT+24
PVTLVR   EQU   PVT+22
PVTFVR   EQU   PVT+20
PVTLPFN  EQU   PVT+18
PVTFPFN  EQU   PVT+16
PVTSSPIN EQU   PVT+11
PVTPCBS  EQU   PVT+10
PVTPOOL  EQU   PVT+8
PVTAFCOK EQU   PVT+6
PVTAFCLO EQU   PVT+4
PVTAFC   EQU   PVT+2
@NM00049 EQU   PVTFLAG2
PVTRSMGM EQU   PVTFLAG2
PVTDUMP  EQU   PVTFLAG1
PVTSIT   EQU   PVTFLAG1
PVTLSI   EQU   PVTFLAG1
PVTAPREF EQU   PVTFLAG1
PVTPCBLT EQU   PVTFLAG1
PVTSRBIU EQU   PVTFLAG1
PVTBGMS  EQU   PVTFLAG1
PVTPMSG  EQU   PVTFLAG1
PGTPAM   EQU   PGTBITS
@NM00024 EQU   PGTBITS
@NM00023 EQU   PGTBITS
@NM00022 EQU   PGTBITS
@NM00021 EQU   PGTBITS
@NM00020 EQU   PGTBITS
@NM00019 EQU   PGTBITS
PGTREAL  EQU   PGTRSA
PFTQNDX  EQU   PFTE+14
@NM00018 EQU   PFTFLAG2
@NM00017 EQU   PFTFLAG2
PFTSTEAL EQU   PFTFLAG2
PFTVR    EQU   PFTFLAG2
PFTOFFLN EQU   PFTFLAG2
PFTOFINT EQU   PFTFLAG1
PFTVRALC EQU   PFTFLAG1
PFTVRINT EQU   PFTFLAG1
PFTONAVQ EQU   PFTFLAG1
PFTRSV1  EQU   PFTE+10
PFTASID  EQU   PFTPGID
PCBRWRKB EQU   PCBR+60
PCBRWRKA EQU   PCBR+56
PCBRWRK9 EQU   PCBR+52
PCBRWRK8 EQU   PCBR+48
PCBRWRK7 EQU   PCBR+44
PCBRWRK6 EQU   PCBR+40
PCBRWRK5 EQU   PCBR+36
PCBRWRK4 EQU   PCBR+32
PCBRWRK3 EQU   PCBR+28
PCBRWRK2 EQU   PCBR+24
PCBRWRK1 EQU   PCBR+20
PCBRRSV1 EQU   PCBR+18
PCBRASCB EQU   PCBR+12
PCBRPOF  EQU   PCBRFLAG
PCBRFECB EQU   PCBRFLAG
PCBRLOAD EQU   PCBRFLAG
PCBRFPCB EQU   PCBRFLAG
PCBRPB   EQU   PCBRFLAG
PCBRETRY EQU   PCBRFLAG
PCBRINT  EQU   PCBRFLAG
PCBEND   EQU   PCB+64
PCBSWPS2 EQU   PCBFL3
@NM00016 EQU   PCBFL3
PCBNOREC EQU   PCBFL3
PCBDFRLS EQU   PCBFL3
PCBSWPLS EQU   PCBFL3
PCBSWPS1 EQU   PCBFL3
PCBSWPIN EQU   PCBFL3
@NM00015 EQU   PCBFL2
@NM00014 EQU   PCBFL2
PCBVIO   EQU   PCBFL2
PCBGFAD  EQU   PCBFL2
PCBLFR   EQU   PCBFL1
PCBLLHLD EQU   PCBFL1
PCBPEX   EQU   PCBFL1
@NM00013 EQU   PCBFL1
PCBCQN   EQU   PCBFQP
OUXBEND  EQU   OUXB+144
OUXBTSW  EQU   OUXB+140
OUXBFIXC EQU   OUXB+138
OUXBNVC  EQU   OUXB+136
OUXBUIC  EQU   OUXB+134
OUXBVSC  EQU   OUXB+132
OUXBILS  EQU   OUXB+128
OUXBRSV1 EQU   OUXB+126
OUXBWCT  EQU   OUXB+124
OUXBPRS  EQU   OUXB+120
OUXBSTD  EQU   OUXB+116
OUXBITD  EQU   OUXB+112
OUXBMSS  EQU   OUXB+104
OUXBCPS  EQU   OUXB+96
OUXBAET  EQU   OUXB+92
OUXBTRR  EQU   OUXB+88
OUXBJBR  EQU   OUXB+84
OUXBTRT  EQU   OUXB+80
OUXBTRS  EQU   OUXB+76
OUXBJBT  EQU   OUXB+72
OUXBJBS  EQU   OUXB+68
OUXBTRC  EQU   OUXB+64
OUXBNQT  EQU   OUXB+60
OUXBIOSM EQU   OUXB+56
OUXBIOS  EQU   OUXB+52
OUXBSTCT EQU   OUXB+48
OUXBCAPR EQU   OUXB+44
OUXBCAPI EQU   OUXB+40
OUXBVAMR EQU   OUXB+36
OUXBVAMO EQU   OUXB+32
OUXBVAMI EQU   OUXB+28
OUXBPREC EQU   OUXB+24
OUXBPOUT EQU   OUXB+20
OUXBPIN  EQU   OUXB+16
OUXBRSW  EQU   OUXB+12
OUXBMET  EQU   OUXB+8
OUXBPET  EQU   OUXB+4
OUXBNAME EQU   OUXB
@NM00012 EQU   FRRSFLGS+1
@NM00011 EQU   FRRSFLG1
FRRSNEST EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
@NM00010 EQU   FOEFLAG
@NM00009 EQU   FOEFLAG
@NM00008 EQU   FOEFLAG
@NM00007 EQU   FOEFLAG
@NM00006 EQU   FOEFLAG
@NM00005 EQU   FOEFLAG
@NM00004 EQU   FOEFLAG
FOEINT   EQU   FOEFLAG
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00003 EQU   CVTFIX+248
@NM00002 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTBAH   EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTRV490 EQU   CVTMAP+388
CVTSU    EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTVS1B  EQU   CVTOPTB
CVTVS1A  EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
WSALACHP EQU   WSAL+56
WSALEVNT EQU   WSAL+48
WSALSTAE EQU   WSAL+44
WSALSTAT EQU   WSAL+40
WSALWAIT EQU   WSAL+36
WSALPOST EQU   WSAL+32
WSALEXIT EQU   WSAL+28
WSALS2EE EQU   WSAL+24
WSALCIRB EQU   WSAL+20
WSALABTM EQU   WSAL+16
WSALSDMP EQU   WSAL+12
WSALRTM2 EQU   WSAL+8
WSALVALC EQU   WSAL+4
WSALCWSA EQU   WSAL
ASXBEND  EQU   ASXB+232
ASXBRV25 EQU   ASXB+228
ASXBRV24 EQU   ASXB+224
ASXBPT0E EQU   ASXB+220
ASXBCRB4 EQU   ASXBCASW+3
ASXBCRB3 EQU   ASXBCASW+2
ASXBCRB2 EQU   ASXBCASW+1
ASXBCR06 EQU   ASXBCRB1
ASXBCR05 EQU   ASXBCRB1
ASXBCR04 EQU   ASXBCRB1
ASXBCR03 EQU   ASXBCRB1
ASXBCR02 EQU   ASXBCRB1
ASXBCR01 EQU   ASXBCRB1
ASXBTFD  EQU   ASXBCRB1
ASXBPIP  EQU   ASXBCRB1
ASXBCTDC EQU   ASXB+212
ASXBTDCB EQU   ASXB+208
ASXBRV19 EQU   ASXB+204
ASXBSENV EQU   ASXBSECR+1
ASXBRV34 EQU   ASCBSFLG
ASXBRV33 EQU   ASCBSFLG
ASXBRV32 EQU   ASCBSFLG
ASXBRV31 EQU   ASCBSFLG
ASXBRV30 EQU   ASCBSFLG
ASXBRV29 EQU   ASCBSFLG
ASXBRV28 EQU   ASCBSFLG
ASXBRV27 EQU   ASCBSFLG
ASXBUSER EQU   ASXB+192
ASXBLSRB EQU   ASXBAEQ+20
ASXBFSRB EQU   ASXBAEQ+16
ASXBLRQE EQU   ASXBAEQ+12
ASXBFRQE EQU   ASXBAEQ+8
ASXBLIQE EQU   ASXBAEQ+4
ASXBFIQE EQU   ASXBAEQ
ASXBETSK EQU   ASXB+164
ASXBSIRB EQU   ASXB+160
ASXBPSWD EQU   ASXB+152
ASXBPRG  EQU   ASXB+136
ASXBRV26 EQU   ASXB+132
ASXBOUSB EQU   ASXB+128
ASXBDDR  EQU   ASXB+124
ASXBRCTD EQU   ASXB+120
ASXBRSMD EQU   ASXB+116
ASXBFRWA EQU   ASXB+108
ASXBFLSA EQU   ASXB+36
ASXBIHSA EQU   ASXB+32
ASXBRV15 EQU   ASXB+28
ASXBRV14 EQU   ASXB+24
ASXBLWA  EQU   ASXB+20
ASXBMPST EQU   ASXB+16
ASXBRS00 EQU   ASXB+14
ASXBTCBS EQU   ASXB+12
ASXBLTCB EQU   ASXB+8
ASXBASXB EQU   ASXB
ASXBEGIN EQU   ASXB
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00001 EQU   ASVT
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBVEQR EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCB2LPU EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
@NM00048 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00047 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00046 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00045 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00044 EQU   FLCFSA
@NM00043 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00042 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00041 EQU   FLCIOA
@NM00040 EQU   FLCMCLA+15
@NM00039 EQU   FLCMCLA+14
@NM00038 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00037 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00036 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00035 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00034 EQU   FLCPER
@NM00033 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00032 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00031 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00030 EQU   FLCPIILC
@NM00029 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00028 EQU   FLCSVILC
@NM00027 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00026 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00025 EQU   FLCICCW2+4
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RT00283 EQU   RETN
@RT00387 EQU   NEXTTCB
@RT00398 EQU   TESTFIX
@RT00401 EQU   FIRSTFOE
@RT00424 EQU   RLTDEND
@RF00522 EQU   @RC00519
@RF00525 EQU   @RC00519
@RT00536 EQU   SAVL1
@RT00587 EQU   NOTINFET
@RT00618 EQU   SAVPCB
@RT00637 EQU   DIDQDD
PRCEND1  EQU   @EL00004
@RT00699 EQU   EXITSTG1
@RT00713 EQU   NEXTSPCT
@RT00741 EQU   EXITSTG1
@RF00741 EQU   DOENTRY
@RF00749 EQU   NEXTSPCT
@RT00775 EQU   EXITSTG1
@RF00778 EQU   DOENTRY
@RT00797 EQU   EXITWS
@RC00816 EQU   TESTRBN
@RF00810 EQU   TESTRBN
@RC00887 EQU   INVALPGT
@RT00942 EQU   NEXTPFTE
@RT00954 EQU   REPAIRFX
@RT00989 EQU   REPAIRFX
@RF00995 EQU   DOFIXCT
@RT01102 EQU   DOFOE
@RT01133 EQU   DECFOE
@RF01144 EQU   DOROOT
@RT01164 EQU   MATCHSEG
PRCEND3  EQU   @EL00008
@RT01188 EQU   INITFIX
@RT01192 EQU   EXITPT
@RF01198 EQU   TESTVBN
@RT01209 EQU   EXITPT
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IEAVSOUT,(C'PLS2040',0701,78164)

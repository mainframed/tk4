         TITLE 'IGFDV0, DDR - COMMON SELECT ROUTINE                    *
                        '
IGFDV0   CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IGFDV0    76.246'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @08,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@08                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0001
         USING @DATD,@09                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @09,8(,@13)                                         0001
         LR    @13,@09                                             0001
*   DO;                             /* ?IGFDERR INIT                 */
*                                                                  0110
*     /***************************************************************/
*     /*                                                             */
*     /* IGFDERR - INITIALIZE RECOVERY ENVIRONMENT                   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0111
*     DERPLIST=DERPLIST&&DERPLIST;  /* CLEAR PARAMETER LIST          */
         XC    DERPLIST(48),DERPLIST                               0111
*     DERFUNK=DERINIT;              /* INDICATE INIT FUNCTION        */
         MVI   DERFUNK,X'01'                                       0112
*     DERREC=ADDR(DERRECPM);        /* POINT TO REC PARMS            */
         LA    @14,DERRECPM                                        0113
         ST    @14,DERREC                                          0113
*     DERRETRY=ADDR(IGFDV0R);       /* POINT TO RETRY ROUTINE        */
         LA    @14,IGFDV0R                                         0114
         ST    @14,DERRETRY                                        0114
*     GEN SETS(DERDATD)(MVC DERDATD,@SIZDATD);/* SET UP SPN, SIZE    */
         MVC DERDATD,@SIZDATD
*     DERPFX=DERRMASK;              /* SET UP RUB MASK               */
         MVC   DERPFX(2),@CB00288                                  0116
*     DERRCODE=CODEBASE;            /* SAVE CODEREG                  */
         ST    CODEBASE,DERRCODE                                   0117
*     DERRDATA=DATABASE;            /* SAVE DATAREG                  */
         ST    DATABASE,DERRDATA                                   0118
*     DERRDDR=DDRPTR;               /* SAVE DDRCOM POINTER           */
         ST    DDRPTR,DERRDDR                                      0119
*     DERRSAVE=SAVEPTR;             /* SAVE REGISTER 13              */
         ST    SAVEPTR,DERRSAVE                                    0120
*     CALL IGFDE0(DERPLIST);        /* ISSUE ESTAE                   */
         LA    @14,DERPLIST                                        0121
         ST    @14,@AL00001                                        0121
         L     @15,@CV00050                                        0121
         LA    @01,@AL00001                                        0121
         BALR  @14,@15                                             0121
*   END;                            /* ?IGFDERR INIT                 */
*                                                                  0122
*   /*****************************************************************/
*   /*                                                               */
*   /* VALIDATE THE 'FROM' DEVICE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0123
*   DDRINV2=DDRVFM;                 /* INDICATE 'FROM' VALIDATION    */
         MVI   DDRINV2(DDRPTR),X'01'                               0123
*   CALL IGFDV0V;                   /* CALL PROPER VALIDATION ROUTINE*/
         BAL   @14,IGFDV0V                                         0124
*   IF DERLRC^=VALID                /* IS 'FROM' VALID               */
*     THEN                          /* NO, CANNOT SWAP THIS DEVICE   */
         CLI   DERLRC,0                                            0125
         BE    @RF00125                                            0125
*     IF DERLRC=INVALID             /* IS DEVICE INVALID OR WAS THERE
*                                      A CATASTROPHIC ERROR          */
*       THEN                        /* DEVICE IS INVALID             */
*                                                                  0126
         CLI   DERLRC,4                                            0126
         BNE   @RF00126                                            0126
*       /*************************************************************/
*       /*                                                           */
*       /* IGF513I DEVICE DDD INVALID FOR SWAP - INVALID-CODE        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0127
*       DO;                         /* ?IGFDMSG MSG(IGF513I)CODE(FROM
*                                      -CUA,INVALID-CODE)RETRY(2)    */
*                                                                  0127
*         /***********************************************************/
*         /*                                                         */
*         /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0128
*         DDRMSGCD=DDRM513I;        /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0128
*         DDRMSGPN=2;               /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'02'                              0129
*         DDRMSGPC(1)=DDRPFM;       /* SET SUBSTITUTION CODE 1       */
         MVI   DDRMSGPC(DDRPTR),X'02'                              0130
*         DDRMSGPC(2)=DDRPIC;       /* SET SUBSTITUTION CODE 2       */
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0131
*         RTNCODE=12;               /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0132
*         DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE*/
         LA    @14,1                                               0133
         STC   @14,DDRRETRY(,DDRPTR)                               0133
@DL00133 C     RTNCODE,@CF00042                                    0133
         BNE   @DC00133                                            0133
*           CALL IGFDM0;            /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0134
         BALR  @14,@15                                             0134
*         END;                      /* END OF RETRY LOOP             */
         LA    @14,1                                               0135
         SLR   @12,@12                                             0135
         IC    @12,DDRRETRY(,DDRPTR)                               0135
         ALR   @14,@12                                             0135
         STC   @14,DDRRETRY(,DDRPTR)                               0135
         C     @14,@CF00082                                        0135
         BNH   @DL00133                                            0135
@DC00133 DS    0H                                                  0136
*       END;                        /* ?IGFDMSG MSG(IGF513I)CODE(FROM
*                                      -CUA,INVALID-CODE)RETRY(2)    */
*     ELSE                                                         0137
*       ;                           /* CATASTROPHIC ERROR - NO MSG   */
@RF00126 DS    0H                                                  0138
*   ELSE                            /* 'FROM' DEVICE IS VALID        */
*     DO;                           /* CONTINUE PROCESSING           */
         B     @RC00125                                            0138
@RF00125 DS    0H                                                  0139
*       IF DDRFIRST='0'B THEN       /* IS THIS THE FIRST PASS FOR  0139
*                                      THIS SWAP REQUEST             */
         TM    DDRFIRST(DDRPTR),B'00000001'                        0139
         BNZ   @RF00139                                            0139
*         DO;                       /* YES, MAY HAVE A 'TO' DEVICE   */
*           DDRFIRST='1'B;          /* INDICATE NOT FIRST PASS       */
         OI    DDRFIRST(DDRPTR),B'00000001'                        0141
*           IF DDRSYS='1'B THEN     /* IS THIS A SYSTEM SWAP         */
         TM    DDRSYS(DDRPTR),B'01000000'                          0142
         BNO   @RF00142                                            0142
*             DO;                   /* YES,MUST LOOK UP A SUITABLE 0143
*                                      'TO' DEVICE                   */
*               CALL IGFDL1;        /* TRY TO FIND A COMPATIBLE    0144
*                                      DEVICE TO SWAP TO             */
         L     @15,@CV00051                                        0144
         BALR  @14,@15                                             0144
*               IF RTNCODE^=VALID THEN/* WAS A SUITABLE DEVICE FOUND */
         SLR   @14,@14                                             0145
         CR    RTNCODE,@14                                         0145
         BE    @RF00145                                            0145
*                 DO;               /* NO, MUST REQUEST DEVICE       */
*                   DDRTOUCB=0;     /* INDICATE NO 'TO' UCB FOUND    */
         ST    @14,DDRTOUCB(,DDRPTR)                               0147
*                   DDRTOCUA=0;     /* INDICATE NO 'TO' DEVICE FOUND */
         STCM  @14,7,DDRTOCUA(DDRPTR)                              0148
*                 END;                                             0149
*               DDRTER1=0;          /* IGNORE ERRORS IN IGFDL1       */
@RF00145 MVI   DDRTER1(DDRPTR),X'00'                               0150
*             END;                                                 0151
*           ELSE                    /* FIRST PASS OPERATOR SWAP      */
*             DO;                   /* YES, MUST VALIDATE THE      0152
*                                      SPECIFIED 'TO' DEVICE         */
         B     @RC00142                                            0152
@RF00142 DS    0H                                                  0153
*               DDRINV2=DDRVCM;     /* INDICATE 'TO' VALIDATION      */
         MVI   DDRINV2(DDRPTR),X'02'                               0153
*               CALL IGFDV0V;       /* CALL THE PROPER VALIDATION RTN*/
         BAL   @14,IGFDV0V                                         0154
*               IF DERLRC^=VALID THEN/* IS 'TO' DEVICE VALID         */
         CLI   DERLRC,0                                            0155
         BE    @RF00155                                            0155
*                 DO;               /* NO, CANNOT USE IT             */
*                   IF DERLRC=INVALID/* IS THE DEVICE INVALID        */
*                     THEN          /* YES, DIAGNOSE THE PROBLEM     */
*                                                                  0157
         CLI   DERLRC,4                                            0157
         BNE   @RF00157                                            0157
*                     /***********************************************/
*                     /*                                             */
*                     /* IGF513I DEVICE DDD INVALID FOR SWAP -       */
*                     /* INV-CODE                                    */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0158
*                     DO;           /* ?IGFDMSG MSG(IGF513I)CODE(TO-C
*                                      UA,INVALID-CODE)RETRY(2)      */
*                                                                  0158
*                       /*********************************************/
*                       /*                                           */
*                       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE      */
*                       /* WRITER                                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0159
*                       DDRMSGCD=DDRM513I;/* SET UP MSG CODE         */
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0159
*                       DDRMSGPN=2; /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'02'                              0160
*                       DDRMSGPC(1)=DDRPTO;/* SET SUBSTITUTION CODE 1*/
         MVI   DDRMSGPC(DDRPTR),X'03'                              0161
*                       DDRMSGPC(2)=DDRPIC;/* SET SUBSTITUTION CODE 2*/
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0162
*                       RTNCODE=12; /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0163
*                       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP
*                                      UNTIL MSG DONE                */
         LA    @14,1                                               0164
         STC   @14,DDRRETRY(,DDRPTR)                               0164
@DL00164 C     RTNCODE,@CF00042                                    0164
         BNE   @DC00164                                            0164
*                         CALL IGFDM0;/* OUTPUT MESSAGE              */
         L     @15,@CV00052                                        0165
         BALR  @14,@15                                             0165
*                       END;        /* END OF RETRY LOOP             */
         LA    @14,1                                               0166
         SLR   @12,@12                                             0166
         IC    @12,DDRRETRY(,DDRPTR)                               0166
         ALR   @14,@12                                             0166
         STC   @14,DDRRETRY(,DDRPTR)                               0166
         C     @14,@CF00082                                        0166
         BNH   @DL00164                                            0166
@DC00164 DS    0H                                                  0167
*                     END;          /* ?IGFDMSG MSG(IGF513I)CODE(TO-C
*                                      UA,INVALID-CODE)RETRY(2)      */
*                   DDRTER1=0;      /* IGNORE ERROR CODE             */
@RF00157 MVI   DDRTER1(DDRPTR),X'00'                               0168
*                   DDRTOUCB=0;     /* INDICATE NO 'TO' DEVICE FOUND */
         SLR   @14,@14                                             0169
         ST    @14,DDRTOUCB(,DDRPTR)                               0169
*                 END;                                             0170
*             END;                                                 0171
@RF00155 DS    0H                                                  0172
*         END;                                                     0172
*                                                                  0172
@RC00142 DS    0H                                                  0173
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE PROPER SWAP MESSAGE AND ANALYZE OPERATOR REPLY  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0173
*       CALL IGFDV03;               /* ISSUE MESSAGE                 */
@RF00139 BAL   @14,IGFDV03                                         0173
*       IF DERLRC=VALID THEN        /* DID OPERATOR CANCEL SWAP      */
         CLI   DERLRC,0                                            0174
         BNE   @RF00174                                            0174
*         DO;                       /* NO, CONTINUE SWAP             */
*                                                                  0175
*           /*********************************************************/
*           /*                                                       */
*           /* RECORD THE CONTENTS OF THE BUFFERED LOGS IF APPLICABLE*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0176
*           IF DDRDA='1'B&DDRBUFL='1'B THEN/* DOES THE SWAP INVOLVE
*                                      DIRECT ACCESS DEVICES WITH  0176
*                                      BUFFERED LOGS                 */
         TM    DDRDA(DDRPTR),B'11000000'                           0176
         BNO   @RF00176                                            0176
*             DO;                   /* YES, RECORD LOGS              */
*               DDRREC1=DDRRBLF;    /* INDICATE RECORD BUFFERED LOG  */
         MVI   DDRREC1(DDRPTR),X'03'                               0178
*               DDRRFMTO='1'B;      /* INDICATE 'FROM' DEVICE        */
         OI    DDRRFMTO(DDRPTR),B'10000000'                        0179
*               CALL IGFDR0;        /* RECORD LOG OF 'FROM' DEVICE   */
         L     @15,@CV00054                                        0180
         BALR  @14,@15                                             0180
*               DDRRFMTO='0'B;      /* INDICATE 'TO' DEVICE          */
         NI    DDRRFMTO(DDRPTR),B'01111111'                        0181
*               IF DDRFMUCB^=DDRTOUCB/* IS ONLY ONE DEVICE INVOLVED
*                                      IN THE SWAP                   */
*                 THEN              /* NO, RECORD BOTH LOGS          */
         CLC   DDRFMUCB(4,DDRPTR),DDRTOUCB(DDRPTR)                 0182
         BE    @RF00182                                            0182
*                 CALL IGFDR0;      /* RECORD LOG OF 'TO' DEVICE     */
         L     @15,@CV00054                                        0183
         BALR  @14,@15                                             0183
*               DDRTER1=0;          /* IGNORE RECORDING ERRORS       */
@RF00182 MVI   DDRTER1(DDRPTR),X'00'                               0184
*             END;                                                 0185
*                                                                  0185
*           /*********************************************************/
*           /*                                                       */
*           /* GAIN CONTROL OF THE 'FROM' AND 'TO' DEVICES           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0186
*           IF DDRMT='1'B THEN      /* IS THIS A TAPE DEVICE         */
@RF00176 TM    DDRMT(DDRPTR),B'00100000'                           0186
         BNO   @RF00186                                            0186
*             DDRIOF1=DDRRUN;       /* YES, INDICATE REWIND/UNLOAD   */
         MVI   DDRIOF1(DDRPTR),X'0F'                               0187
*           ELSE                    /* NO, NOT TAPE SWAP             */
*             DDRIOF1=DDRNOP;       /* INDICATE NOP TO DEVICE        */
         B     @RC00186                                            0188
@RF00186 MVI   DDRIOF1(DDRPTR),X'03'                               0188
*           DDRIOF2=0;              /* CLEAR FLAG BYTE               */
@RC00186 MVI   DDRIOF2(DDRPTR),X'00'                               0189
*           DDRITAKE='1'B;          /* INDICATE TAKE CONTROL OF DEVC */
*           DDRWHICH='1'B;          /* INDICATE 'FROM' DEVICE        */
         OI    DDRITAKE(DDRPTR),B'11000000'                        0191
*           CALL IGFDM1;            /* CONTROL THE 'FROM' DEVICE     */
         L     @15,@CV00053                                        0192
         BALR  @14,@15                                             0192
*           IF RTNCODE^=VALID THEN  /* WAS DEVICE CONTROLLED OK      */
         LTR   RTNCODE,RTNCODE                                     0193
         BZ    @RF00193                                            0193
*             DERLRC=RTNCODE;       /* NO, INDICATE ERROR CODE       */
         STC   RTNCODE,DERLRC                                      0194
*           ELSE                    /* YES, CONTINUE WITH SWAP       */
*             DO;                                                  0195
         B     @RC00193                                            0195
@RF00193 DS    0H                                                  0196
*               DDRWHICH='0'B;      /* INDICATE 'TO' DEVICE          */
         NI    DDRWHICH(DDRPTR),B'01111111'                        0196
*               CALL IGFDM1;        /* CONTROL THE 'TO' DEVICE       */
         L     @15,@CV00053                                        0197
         BALR  @14,@15                                             0197
*               IF RTNCODE^=VALID THEN/* WAS DEVICE CONTROLLED OK    */
         LTR   RTNCODE,RTNCODE                                     0198
         BZ    @RF00198                                            0198
*                 DERLRC=RTNCODE;   /* NO, INDICATE ERROR CODE       */
         STC   RTNCODE,DERLRC                                      0199
*               ELSE                /* YES, CONTINUE WITH SWAP       */
*                 DO;                                              0200
*                                                                  0200
         B     @RC00198                                            0200
@RF00198 DS    0H                                                  0201
*                   /*************************************************/
*                   /*                                               */
*                   /* RECORD THE VOLUME DISMOUNT RECORD IF THIS IS A*/
*                   /* TAPE SWAP                                     */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0201
*                   IF DDRMT='1'B THEN/* IS THIS A TAPE SWAP         */
         TM    DDRMT(DDRPTR),B'00100000'                           0201
         BNO   @RF00201                                            0201
*                     DO;           /* YES, RECORD DISMOUNT          */
*                       DDRREC1=DDRR91;/* INDICATE VOLUME DISMOUNT 0203
*                                      RECORD REQUEST                */
         MVI   DDRREC1(DDRPTR),X'02'                               0203
*                       CALL IGFDR0;/* PERFORM RECORDING             */
         L     @15,@CV00054                                        0204
         BALR  @14,@15                                             0204
*                       DDRTER1=0;  /* IGNORE RECORDING ERRORS       */
         MVI   DDRTER1(DDRPTR),X'00'                               0205
*                     END;                                         0206
*                                                                  0206
*                   /*************************************************/
*                   /*                                               */
*                   /* SWAP THE UCBS FOR THE 'FROM' AND 'TO' DEVICES */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0207
*                   CALL IGFDW0;    /* SWAP THE UCBS                 */
@RF00201 L     @15,@CV00057                                        0207
         BALR  @14,@15                                             0207
*                   DERLRC=RTNCODE; /* COPY RETURN CODE              */
         STC   RTNCODE,DERLRC                                      0208
*                 END;                                             0209
*             END;                                                 0210
@RC00198 DS    0H                                                  0211
*         END;                                                     0211
@RC00193 DS    0H                                                  0212
*     END;                                                         0212
@RF00174 DS    0H                                                  0213
*IGFDV0R:                           /* ESTAE RETRY ENTRY POINT       */
*   DO;                             /* ?IGFDERR CANCEL               */
*                                                                  0213
@RC00125 DS    0H                                                  0213
IGFDV0R  DS    0H                                                  0214
*     /***************************************************************/
*     /*                                                             */
*     /* IGFDERR - CANCEL RECOVERY ENVIRONMENT                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0214
*     DERFUNK=DERCANC;              /* INDICATE CANCEL               */
         MVI   DERFUNK,X'02'                                       0214
*     CALL IGFDE0(DERPLIST);        /* CANCEL ESTAE                  */
         LA    @14,DERPLIST                                        0215
         ST    @14,@AL00001                                        0215
         L     @15,@CV00050                                        0215
         LA    @01,@AL00001                                        0215
         BALR  @14,@15                                             0215
*   END;                            /* ?IGFDERR CANCEL               */
*   RETURN CODE(DERLRC);            /* RETURN TO CALLER              */
         SLR   @12,@12                                             0217
         IC    @12,DERLRC                                          0217
         L     @13,4(,@13)                                         0217
         L     @00,@SIZDATD                                        0217
         LR    @01,@09                                             0217
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@12                                             0217
         L     @14,12(,@13)                                        0217
         LM    @00,@12,20(@13)                                     0217
         BR    @14                                                 0217
*   GENERATE NOREFS NOSETS(EJECT);                                 0218
*                                                                  0218
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBROUTINE IGFDV03 - REPEATEDLY ASK THE OPERATOR FOR A 'TO'   */
*   /* DEVICE UNTIL HE CANCELS THE SWAP REQUEST OR REPLIES WITH THE  */
*   /* ADDRESS OF AN ACCEPTABLE DEVICE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0219
*IGFDV03:                           /* SUBROUTINE ENTRY POINT        */
*   PROCEDURE;                                                     0219
         B     @PB00002                                            0219
IGFDV03  STM   @14,@12,@SA00002                                    0219
*   CONTROL='1'B;                   /* INDICATE DEVICE NOT ACCEPTED
*                                      YET                           */
*                                                                  0220
         OI    CONTROL,B'10000000'                                 0220
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP UNTIL A DEVICE IS ACCEPTED OR THE SWAP IS CANCELLED      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0221
*   DO WHILE(CONTROL='1'B);                                        0221
         B     @DE00221                                            0221
@DL00221 DS    0H                                                  0222
*     CALL IGFDV02;                 /* ISSUE SWAP MESSAGE AND ANALYZE
*                                      REPLY                         */
         BAL   @14,IGFDV02                                         0222
*     IF DERLRC^=VALID THEN         /* SHOULD SWAP BE TERMINATED     */
         CLI   DERLRC,0                                            0223
         BE    @RF00223                                            0223
*       CONTROL='0'B;               /* YES, TERMINATE LOOP           */
         NI    CONTROL,B'01111111'                                 0224
*     ELSE                          /* NO, CONTINUE PROCESSING       */
*       DO;                                                        0225
         B     @RC00223                                            0225
@RF00223 DS    0H                                                  0226
*         DDRINV2=DDRVUS;           /* INDICATE USER VALIDATION      */
         MVI   DDRINV2(DDRPTR),X'03'                               0226
*         CALL IGFDV0V;             /* INSURE THAT THE USER IS STILL
*                                      IN THE SYSTEM                 */
         BAL   @14,IGFDV0V                                         0227
*         IF DERLRC^=VALID THEN     /* HAS USER GONE AWAY            */
         CLI   DERLRC,0                                            0228
         BE    @RF00228                                            0228
*           DO;                     /* YES, TERMINATE SWAP           */
*             DDRTER1=DDRTNF;       /* INDICATE NO USER FOUND        */
         MVI   DDRTER1(DDRPTR),X'01'                               0230
*             CONTROL='0'B;         /* TERMINATE LOOP                */
         NI    CONTROL,B'01111111'                                 0231
*           END;                                                   0232
*         ELSE                      /* NO, CONTINUE SWAP             */
*           DO;                                                    0233
*                                                                  0233
         B     @RC00228                                            0233
@RF00228 DS    0H                                                  0234
*             /*******************************************************/
*             /*                                                     */
*             /* VALIDATE THE 'TO' DEVICE AND ITS COMPATIBILITY WITH */
*             /* THE 'FROM' DEVICE                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0234
*             DDRINV2=DDRVCM;       /* INDICATE 'TO' VALIDATION      */
         MVI   DDRINV2(DDRPTR),X'02'                               0234
*             CALL IGFDV0V;         /* VALIDATE 'TO' DEVICE          */
         BAL   @14,IGFDV0V                                         0235
*             IF DERLRC=VALID THEN  /* IS 'TO' DEVICE VALID          */
         CLI   DERLRC,0                                            0236
         BNE   @RF00236                                            0236
*               CONTROL='0'B;       /* YES, TERMINATE LOOP WITH VALID
*                                      DEVICE SPECIFIED              */
         NI    CONTROL,B'01111111'                                 0237
*             ELSE                  /* NO, DIAGNOSE THE PROBLEM      */
*               DO;                                                0238
         B     @RC00236                                            0238
@RF00236 DS    0H                                                  0239
*                 DDRTOUCB=0;       /* INDICATE NO 'TO' DEVICE FOUND
*                                      YET                           */
         SLR   @14,@14                                             0239
         ST    @14,DDRTOUCB(,DDRPTR)                               0239
*                 IF DERLRC^=INVALID THEN/* WAS IT A DEVICE ERROR    */
         CLI   DERLRC,4                                            0240
         BE    @RF00240                                            0240
*                   CONTROL='0'B;   /* NO, TERMINATE SWAP            */
         NI    CONTROL,B'01111111'                                 0241
*                 ELSE              /* YES, CONTINUE                 */
*                   DO;             /* REPORT DEVICE ERROR           */
*                                                                  0242
         B     @RC00240                                            0242
@RF00240 DS    0H                                                  0243
*                     /***********************************************/
*                     /*                                             */
*                     /* IGF513I DEVICE DDD INVALID FOR SWAP -       */
*                     /* INVALID-CODE                                */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0243
*                     DO;           /* ?IGFDMSG MSG(IGF513I)CODE(TO-C
*                                      UA,INVALID-CODE)RETRY(2)      */
*                                                                  0243
*                       /*********************************************/
*                       /*                                           */
*                       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE      */
*                       /* WRITER                                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0244
*                       DDRMSGCD=DDRM513I;/* SET UP MSG CODE         */
         MVI   DDRMSGCD(DDRPTR),X'0A'                              0244
*                       DDRMSGPN=2; /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'02'                              0245
*                       DDRMSGPC(1)=DDRPTO;/* SET SUBSTITUTION CODE 1*/
         MVI   DDRMSGPC(DDRPTR),X'03'                              0246
*                       DDRMSGPC(2)=DDRPIC;/* SET SUBSTITUTION CODE 2*/
         MVI   DDRMSGPC+1(DDRPTR),X'09'                            0247
*                       RTNCODE=12; /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0248
*                       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP
*                                      UNTIL MSG DONE                */
         LA    @14,1                                               0249
         STC   @14,DDRRETRY(,DDRPTR)                               0249
@DL00249 C     RTNCODE,@CF00042                                    0249
         BNE   @DC00249                                            0249
*                         CALL IGFDM0;/* OUTPUT MESSAGE              */
         L     @15,@CV00052                                        0250
         BALR  @14,@15                                             0250
*                       END;        /* END OF RETRY LOOP             */
         LA    @14,1                                               0251
         SLR   @12,@12                                             0251
         IC    @12,DDRRETRY(,DDRPTR)                               0251
         ALR   @14,@12                                             0251
         STC   @14,DDRRETRY(,DDRPTR)                               0251
         C     @14,@CF00082                                        0251
         BNH   @DL00249                                            0251
@DC00249 DS    0H                                                  0252
*                     END;          /* ?IGFDMSG MSG(IGF513I)CODE(TO-C
*                                      UA,INVALID-CODE)RETRY(2)      */
*                     DDRTER1=0;    /* IGNORE ERRORS IN IGFDM0       */
         MVI   DDRTER1(DDRPTR),X'00'                               0253
*                   END;                                           0254
*               END;                                               0255
@RC00240 DS    0H                                                  0256
*           END;                                                   0256
@RC00236 DS    0H                                                  0257
*       END;                                                       0257
@RC00228 DS    0H                                                  0258
*   END;                            /* END OF PROMPTING LOOP         */
@RC00223 DS    0H                                                  0258
@DE00221 TM    CONTROL,B'10000000'                                 0258
         BO    @DL00221                                            0258
*   RETURN;                         /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0259
@EF00002 DS    0H                                                  0259
@ER00002 LM    @14,@12,@SA00002                                    0259
         BR    @14                                                 0259
*   END IGFDV03;                    /* END OF INTERNAL PROCEDURE     */
@PB00002 DS    0H                                                  0261
*   GENERATE NOREFS NOSETS(EJECT);                                 0261
*                                                                  0261
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBROUTINE IGFDV02 - OUTPUT THE PROPER SWAP MESSAGES AND      */
*   /* ANALYZE THE REPLY FROM THE OPERATOR                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0262
*IGFDV02:                           /* SUBROUTINE ENTRY POINT        */
*   PROCEDURE;                                                     0262
*                                                                  0262
         B     @PB00003                                            0262
IGFDV02  STM   @14,@12,@SA00003                                    0262
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE 'FROM' DEVICE IS A SHARED DASD DEVICE, THE 'TO' DEVICE */
*   /* MUST BE THE SAME AS THE 'FROM' DEVICE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0263
*   IF DDRDA='1'B&UCBRR='1'B THEN   /* IS THE 'FROM' SHARED DASD   0263
*                                      YM02576                       */
         TM    DDRDA(DDRPTR),B'01000000'                           0263
         BNO   @RF00263                                            0263
         L     @14,UCBPTR(,DDRPTR)                                 0263
         TM    UCBRR(@14),B'00100000'                              0263
         BNO   @RF00263                                            0263
*     DO;                           /* YES, FORCE SWAP TO ITSELF     */
*       DDRTOCUA=DDRFMCUA;          /* SET CUAS EQUAL                */
         MVC   DDRTOCUA(3,DDRPTR),DDRFMCUA(DDRPTR)                 0265
*       DDRTOUCB=DDRFMUCB;          /* POINT TO SAME UCB             */
         L     @14,DDRFMUCB(,DDRPTR)                               0266
         ST    @14,DDRTOUCB(,DDRPTR)                               0266
*     END;                                                         0267
*                                                                  0267
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT THE FIRST OF THE PROPER PAIR OF MESSAGES               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0268
*   IF DDRTOUCB=0                   /* IS THERE A 'TO' DEVICE        */
*     THEN                          /* NO, ASK FOR 'TO' DEVICE       */
*                                                                  0268
@RF00263 L     @14,DDRTOUCB(,DDRPTR)                               0268
         LTR   @14,@14                                             0268
         BNZ   @RF00268                                            0268
*     /***************************************************************/
*     /*                                                             */
*     /* IGF509I SWAP XXX - REASON-CODE                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0269
*     DO;                           /* ?IGFDMSG MSG(IGF509I)CODE(FROM
*                                      -CUA,REASON)RETRY(2)          */
*                                                                  0269
*       /*************************************************************/
*       /*                                                           */
*       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0270
*       DDRMSGCD=DDRM509I;          /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'06'                              0270
*       DDRMSGPN=2;                 /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'02'                              0271
*       DDRMSGPC(1)=DDRPFM;         /* SET SUBSTITUTION CODE 1       */
         MVI   DDRMSGPC(DDRPTR),X'02'                              0272
*       DDRMSGPC(2)=DDRPRC;         /* SET SUBSTITUTION CODE 2       */
         MVI   DDRMSGPC+1(DDRPTR),X'0B'                            0273
*       RTNCODE=12;                 /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0274
*       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE  */
         LA    @14,1                                               0275
         STC   @14,DDRRETRY(,DDRPTR)                               0275
@DL00275 C     RTNCODE,@CF00042                                    0275
         BNE   @DC00275                                            0275
*         CALL IGFDM0;              /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0276
         BALR  @14,@15                                             0276
*       END;                        /* END OF RETRY LOOP             */
         LA    @14,1                                               0277
         SLR   @12,@12                                             0277
         IC    @12,DDRRETRY(,DDRPTR)                               0277
         ALR   @14,@12                                             0277
         STC   @14,DDRRETRY(,DDRPTR)                               0277
         C     @14,@CF00082                                        0277
         BNH   @DL00275                                            0277
@DC00275 DS    0H                                                  0278
*     END;                          /* ?IGFDMSG MSG(IGF509I)CODE(FROM
*                                      -CUA,REASON)RETRY(2)          */
*   ELSE                            /* YES, MAY HAVE GOOD DEVICE     */
*                                                                  0279
*     /***************************************************************/
*     /*                                                             */
*     /* IGF500I SWAP XXX TO YYY - REASON-CODE                       */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0279
*     DO;                           /* ?IGFDMSG MSG(IGF500I)CODE(FROM
*                                      -CUA,TO-CUA,REASON)RETRY(2)   */
*                                                                  0279
         B     @RC00268                                            0279
@RF00268 DS    0H                                                  0280
*       /*************************************************************/
*       /*                                                           */
*       /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0280
*       DDRMSGCD=DDRM500I;          /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'01'                              0280
*       DDRMSGPN=3;                 /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'03'                              0281
*       DDRMSGPC(1)=DDRPFM;         /* SET SUBSTITUTION CODE 1       */
         MVI   DDRMSGPC(DDRPTR),X'02'                              0282
*       DDRMSGPC(2)=DDRPTO;         /* SET SUBSTITUTION CODE 2       */
         MVI   DDRMSGPC+1(DDRPTR),X'03'                            0283
*       DDRMSGPC(3)=DDRPRC;         /* SET SUBSTITUTION CODE 3       */
         MVI   DDRMSGPC+2(DDRPTR),X'0B'                            0284
*       RTNCODE=12;                 /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0285
*       DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG DONE  */
         LA    @14,1                                               0286
         STC   @14,DDRRETRY(,DDRPTR)                               0286
@DL00286 C     RTNCODE,@CF00042                                    0286
         BNE   @DC00286                                            0286
*         CALL IGFDM0;              /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0287
         BALR  @14,@15                                             0287
*       END;                        /* END OF RETRY LOOP             */
         LA    @14,1                                               0288
         SLR   @12,@12                                             0288
         IC    @12,DDRRETRY(,DDRPTR)                               0288
         ALR   @14,@12                                             0288
         STC   @14,DDRRETRY(,DDRPTR)                               0288
         C     @14,@CF00082                                        0288
         BNH   @DL00286                                            0288
@DC00286 DS    0H                                                  0289
*     END;                          /* ?IGFDMSG MSG(IGF500I)CODE(FROM
*                                      -CUA,TO-CUA,REASON)RETRY(2)   */
*   IF RTNCODE^=VALID THEN          /* WAS MESSAGE WRITTEN           */
@RC00268 LTR   RTNCODE,RTNCODE                                     0290
         BZ    @RF00290                                            0290
*     DERLRC=RTNCODE;               /* NO, COPY ERROR CODE           */
         STC   RTNCODE,DERLRC                                      0291
*   ELSE                            /* YES, CONTINUE PROCESSING      */
*     DO;                                                          0292
*                                                                  0292
         B     @RC00290                                            0292
@RF00290 DS    0H                                                  0293
*       /*************************************************************/
*       /*                                                           */
*       /* IF DASD CAUTION OPERATOR ABOUT HEAD CRASHES       @OZ12139*/
*       /*                                                           */
*       /*************************************************************/
*                                                                  0293
*       IF DDRDA='1'B&              /* IF DASD AND           @OZ12139*/
*           (DDRPAGE='1'BDDRSYS='1'B)&/* I/O ERROR &        @OZ12139*/
*           (UCBTBYT4='08'X        /* 2314 OR               @OZ12139*/
*           UCBTBYT4='09'X         /* 3330 OR               @OZ12139*/
*           UCBTBYT4='0D'X) THEN    /* 3330-2                @OZ12139*/
         TM    DDRDA(DDRPTR),B'01000000'                           0293
         BNO   @RF00293                                            0293
         TM    DDRPAGE(DDRPTR),B'01100000'                         0293
         BZ    @RF00293                                            0293
         L     @14,UCBPTR(,DDRPTR)                                 0293
         CLI   UCBTBYT4(@14),X'08'                                 0293
         BE    @RT00293                                            0293
         CLI   UCBTBYT4(@14),X'09'                                 0293
         BE    @RT00293                                            0293
         CLI   UCBTBYT4(@14),X'0D'                                 0293
         BNE   @RF00293                                            0293
@RT00293 DS    0H                                                  0294
*         DO;                       /* ?IGFDMSG MSG(IGF514I)RETRY(2) */
*                                                                  0294
*           /*********************************************************/
*           /*                                                       */
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0295
*           DDRMSGCD=DDRM514I;      /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'0C'                              0295
*           DDRMSGPN=0;             /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'00'                              0296
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0297
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0298
*                                      DONE                          */
         LA    @14,1                                               0298
         STC   @14,DDRRETRY(,DDRPTR)                               0298
@DL00298 C     RTNCODE,@CF00042                                    0298
         BNE   @DC00298                                            0298
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0299
         BALR  @14,@15                                             0299
*           END;                    /* END OF RETRY LOOP             */
         LA    @14,1                                               0300
         SLR   @12,@12                                             0300
         IC    @12,DDRRETRY(,DDRPTR)                               0300
         ALR   @14,@12                                             0300
         STC   @14,DDRRETRY(,DDRPTR)                               0300
         C     @14,@CF00082                                        0300
         BNH   @DL00298                                            0300
@DC00298 DS    0H                                                  0301
*         END;                      /* ?IGFDMSG MSG(IGF514I)RETRY(2)
*                                      WARN OPERATOR         @OZ12139*/
*       ELSE                                                       0302
*         ;                         /*                       @OZ12139*/
*                                                                  0302
@RF00293 DS    0H                                                  0303
*       /*************************************************************/
*       /*                                                           */
*       /* OUTPUT THE SECOND OF THE PROPER PAIR OF MESSAGES          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0303
*       IF DDRTOUCB=0               /* IS THERE A 'TO' DEVICE        */
*         THEN                      /* NO, ASK FOR ONE               */
*                                                                  0303
         L     @14,DDRTOUCB(,DDRPTR)                               0303
         LTR   @14,@14                                             0303
         BNZ   @RF00303                                            0303
*         /***********************************************************/
*         /*                                                         */
*         /* IGF509D REPLY DEVICE, OR 'NO'                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0304
*         DO;                       /* ?IGFDMSG MSG(IGF509D)RETRY(2) */
*                                                                  0304
*           /*********************************************************/
*           /*                                                       */
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0305
*           DDRMSGCD=DDRM509D;      /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'07'                              0305
*           DDRMSGPN=0;             /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'00'                              0306
*           DDRMSGOP=DDRWTOR;       /* INDICATE WTOR REQUEST         */
         MVI   DDRMSGOP(DDRPTR),X'01'                              0307
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0308
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0309
*                                      DONE                          */
         LA    @14,1                                               0309
         STC   @14,DDRRETRY(,DDRPTR)                               0309
@DL00309 C     RTNCODE,@CF00042                                    0309
         BNE   @DC00309                                            0309
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0310
         BALR  @14,@15                                             0310
*           END;                    /* END OF RETRY LOOP             */
         LA    @14,1                                               0311
         SLR   @12,@12                                             0311
         IC    @12,DDRRETRY(,DDRPTR)                               0311
         ALR   @14,@12                                             0311
         STC   @14,DDRRETRY(,DDRPTR)                               0311
         C     @14,@CF00082                                        0311
         BNH   @DL00309                                            0311
@DC00309 DS    0H                                                  0312
*         END;                      /* ?IGFDMSG MSG(IGF509D)RETRY(2) */
*       ELSE                        /* YES, A TO DEVICE YM02576      */
*                                                                  0313
*         /***********************************************************/
*         /*                                                         */
*         /* IGF500D REPLY 'YES', DEVICE, OR 'NO'                    */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0313
*         DO;                       /* ?IGFDMSG MSG(IGF500D)CODE(DEVI
*                                      CE)RETRY(2)                   */
*                                                                  0313
         B     @RC00303                                            0313
@RF00303 DS    0H                                                  0314
*           /*********************************************************/
*           /*                                                       */
*           /* IGFDMSG - INVOKE THE DDR/MIH MESSAGE WRITER           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0314
*           DDRMSGCD=DDRM500D;      /* SET UP MSG CODE               */
         MVI   DDRMSGCD(DDRPTR),X'02'                              0314
*           DDRMSGPN=1;             /* SET UP NO. OF SUBST. CODES    */
         MVI   DDRMSGPN(DDRPTR),X'01'                              0315
*           DDRMSGPC(1)=DDRPDV;     /* SET SUBSTITUTION CODE 1       */
         MVI   DDRMSGPC(DDRPTR),X'0A'                              0316
*           DDRMSGOP=DDRWTOR;       /* INDICATE WTOR REQUEST         */
         MVI   DDRMSGOP(DDRPTR),X'01'                              0317
*           RTNCODE=12;             /* INDICATE MESSAGE NOT DONE YET */
         LA    RTNCODE,12                                          0318
*           DO DDRRETRY=1 TO 2 WHILE(RTNCODE=12);/* LOOP UNTIL MSG 0319
*                                      DONE                          */
         LA    @14,1                                               0319
         STC   @14,DDRRETRY(,DDRPTR)                               0319
@DL00319 C     RTNCODE,@CF00042                                    0319
         BNE   @DC00319                                            0319
*             CALL IGFDM0;          /* OUTPUT MESSAGE                */
         L     @15,@CV00052                                        0320
         BALR  @14,@15                                             0320
*           END;                    /* END OF RETRY LOOP             */
         LA    @14,1                                               0321
         SLR   @12,@12                                             0321
         IC    @12,DDRRETRY(,DDRPTR)                               0321
         ALR   @14,@12                                             0321
         STC   @14,DDRRETRY(,DDRPTR)                               0321
         C     @14,@CF00082                                        0321
         BNH   @DL00319                                            0321
@DC00319 DS    0H                                                  0322
*         END;                      /* ?IGFDMSG MSG(IGF500D)CODE(DEVI
*                                      CE)RETRY(2)                   */
*       IF RTNCODE^=VALID THEN      /* WAS MESSAGE WRITTEN           */
@RC00303 LTR   RTNCODE,RTNCODE                                     0323
         BZ    @RF00323                                            0323
*         DERLRC=RTNCODE;           /* NO, COPY ERROR CODE           */
         STC   RTNCODE,DERLRC                                      0324
*       ELSE                        /* YES, ANALYZE REPLY            */
*         IF DDRMSGOP=DDRNO THEN    /* DID OPERATOR REPLY 'NO'       */
         B     @RC00323                                            0325
@RF00323 CLI   DDRMSGOP(DDRPTR),X'03'                              0325
         BNE   @RF00325                                            0325
*           DO;                     /* YES, CANCEL SWAP              */
*             DDRTER1=DDRTCO;       /* INDICATE CANCELLED BY OPERATOR*/
         MVI   DDRTER1(DDRPTR),X'05'                               0327
*             DERLRC=INVALID;       /* INDICATE CANCEL SWAP          */
         MVI   DERLRC,X'04'                                        0328
*           END;                                                   0329
*         ELSE                      /* NO, CAN PROCESS 'TO' DEVICE   */
*           DERLRC=VALID;           /* INDICATE SWAP CAN PROCEED     */
         B     @RC00325                                            0330
@RF00325 MVI   DERLRC,X'00'                                        0330
*     END;                                                         0331
*   RETURN;                         /* RETURN TO CALLER              */
@EL00003 DS    0H                                                  0332
@EF00003 DS    0H                                                  0332
@ER00003 LM    @14,@12,@SA00003                                    0332
         BR    @14                                                 0332
*   GENERATE NOREFS NOSETS(EJECT);                                 0333
*                                                                  0333
         EJECT
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBROUTINE IGFDV0V - CALLS THE PROPER VALIDATION MODULE       */
*   /* DEPENDING ON THE DEVICE CLASS OF THE 'FROM' DEVICE            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0334
*IGFDV0V:                           /* SUBROUTINE ENTRY POINT        */
*   ENTRY;                                                         0334
         B     @EC00334                                            0334
IGFDV0V  STM   @14,@12,@SA00003                                    0334
@EC00334 DS    0H                                                  0335
*   IF DDRDA='1'B THEN              /* IS IT A DIRECT ACCESS DEVICE  */
         TM    DDRDA(DDRPTR),B'01000000'                           0335
         BNO   @RF00335                                            0335
*     CALL IGFDD1;                  /* YES, CALL DASD VALIDATION     */
         L     @15,@CV00049                                        0336
         BALR  @14,@15                                             0336
*   ELSE                                                           0337
*     IF DDRMT='1'B THEN            /* IS IT A MAGNETIC TAPE DEVICE  */
         B     @RC00335                                            0337
@RF00335 TM    DDRMT(DDRPTR),B'00100000'                           0337
         BNO   @RF00337                                            0337
*       CALL IGFDT1;                /* YES, CALL TAPE VALIDATION     */
         L     @15,@CV00055                                        0338
         BALR  @14,@15                                             0338
*     ELSE                                                         0339
*       IF DDRUR='1'B THEN          /* IS IT A UNIT RECORD DEVICE    */
         B     @RC00337                                            0339
@RF00337 TM    DDRUR(DDRPTR),B'00010000'                           0339
         BNO   @RF00339                                            0339
*         CALL IGFDU1;              /* YES, CALL UNIT REC VALIDATE   */
         L     @15,@CV00056                                        0340
         BALR  @14,@15                                             0340
*       ELSE                        /* NO, INVALID DEVICE CLASS      */
*         DO;                                                      0341
         B     @RC00339                                            0341
@RF00339 DS    0H                                                  0342
*           DDRTER1=DDRTCE;         /* INDICATE CATASTROPHIC ERROR   */
         MVI   DDRTER1(DDRPTR),X'07'                               0342
*           RTNCODE=CATERR;         /* SET RETURN CODE TO 12         */
         LA    RTNCODE,12                                          0343
*         END;                                                     0344
*   DERLRC=RTNCODE;                 /* COPY RETURN CODE FOR CALLER   */
@RC00339 DS    0H                                                  0345
@RC00337 DS    0H                                                  0345
@RC00335 STC   RTNCODE,DERLRC                                      0345
*   RETURN;                         /* RETURN TO CALLER              */
         B     @EL00003                                            0346
*   END IGFDV02;                    /* END OF INTERNAL PROCEDURE     */
         B     @EL00003                                            0347
*   END IGFDV0                      /* END OF MODULE                 */
*                                                                  0348
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHADDR  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*                                                                  0348
*       ;                                                          0348
@EL00001 L     @13,4(,@13)                                         0348
@EF00001 L     @00,@SIZDATD                                        0348
         LR    @01,@09                                             0348
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0348
         BR    @14                                                 0348
@DATA    DS    0H
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
@SA00003 DS    15F
@AL00001 DS    1A
IGFDV0   CSECT
         DS    0F
@CF00082 DC    F'2'
@CF00042 DC    F'12'
@DATD    DSECT
         DS    0D
CONTROL  DS    BL1
         DS    CL3
DERPLIST DS    CL48
         ORG   DERPLIST
DERFUNK  DS    AL1
DERSWCHS DS    BL1
         ORG   DERSWCHS
DERCRASH DS    BL1
DERPERK  EQU   DERSWCHS+0
DERECALL EQU   DERSWCHS+0
DERESTAE EQU   DERSWCHS+0
@NM00009 EQU   DERSWCHS+0
         ORG   DERPLIST+2
@NM00010 DS    CL2
DERREC   DS    AL4
DERSPEC  DS    AL4
DERRETRY DS    AL4
DERDATD  DS    CL4
         ORG   DERDATD
DERDASPN DS    FL1
DERDALNG DS    FL3
         ORG   DERPLIST+20
DERRSRC  DS    BL1
         ORG   DERRSRC
DERTAPE  DS    BL1
DERUREC  EQU   DERRSRC+0
DERDISK  EQU   DERRSRC+0
@NM00011 EQU   DERRSRC+0
         ORG   DERPLIST+21
DERLRC   DS    AL1
DERRUB   DS    CL18
         ORG   DERRUB
DERPFX   DS    BL2
DERRCODE DS    AL4
DERRDATA DS    AL4
DERRDDR  DS    AL4
DERRSAVE DS    AL4
         ORG   DERPLIST+40
DERGMSPL DS    CL4
         ORG   DERGMSPL
DERGMSPN DS    FL1
DERGMLNG DS    FL3
         ORG   DERPLIST+44
DERGMADR DS    AL4
         ORG   DERPLIST+48
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IGFDV0   CSECT
         DS    0F
@SIZDATD DC    AL1(245)
         DC    AL3(@ENDDATD-@DATD)
@CV00049 DC    V(IGFDD1)
@CV00050 DC    V(IGFDE0)
@CV00051 DC    V(IGFDL1)
@CV00052 DC    V(IGFDM0)
@CV00053 DC    V(IGFDM1)
@CV00054 DC    V(IGFDR0)
@CV00055 DC    V(IGFDT1)
@CV00056 DC    V(IGFDU1)
@CV00057 DC    V(IGFDW0)
         DS    0D
@CB00288 DC    B'0000000011100100'
DERRECPM DS    CL24
         ORG   DERRECPM
@NM00012 DC    CL8'IGFDI0'
@NM00013 DC    CL8'IGFDV0'
@NM00014 DC    CL8'76246'
         ORG   DERRECPM+24
         DS    CL2
IGFDV0P  DC    13F'0'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CODEBASE EQU   @08
DATABASE EQU   @09
DDRPTR   EQU   @10
SAVEPTR  EQU   @13
RTNCODE  EQU   @15
DDRCOM   EQU   0
DDRSHORT EQU   DDRCOM
DDRCNTRL EQU   DDRSHORT+8
DDRSRC   EQU   DDRCNTRL
DDRSYS   EQU   DDRSRC
DDRPAGE  EQU   DDRSRC
DDRSTAT  EQU   DDRCNTRL+1
DDRDCHAR EQU   DDRCNTRL+2
DDRDSTAT EQU   DDRDCHAR+1
DDRBUFL  EQU   DDRDSTAT
DDRDA    EQU   DDRDSTAT
DDRMT    EQU   DDRDSTAT
DDRUR    EQU   DDRDSTAT
DDRFMCUA EQU   DDRSHORT+18
DDRTOCUA EQU   DDRSHORT+21
DDRLONG  EQU   DDRCOM+24
DDRTOUCB EQU   DDRLONG
DDRFMUCB EQU   DDRLONG+4
DDRROWN  EQU   DDRLONG+8
DDRFIRST EQU   DDRROWN
DDRMIHT  EQU   DDRLONG+12
DDRTER   EQU   DDRLONG+36
DDRTER1  EQU   DDRTER
DDRINV   EQU   DDRLONG+38
DDRINV2  EQU   DDRINV+1
DDRAPP   EQU   DDRLONG+40
DDRIOF   EQU   DDRLONG+52
DDRIOF1  EQU   DDRIOF
DDRIOF2  EQU   DDRIOF+1
DDRWHICH EQU   DDRIOF2
DDRITAKE EQU   DDRIOF2
DDRMSG   EQU   DDRLONG+54
DDRMSGOP EQU   DDRMSG
DDRMSGCD EQU   DDRMSG+1
DDRMSGP  EQU   DDRLONG+56
DDRMSGPN EQU   DDRMSGP
DDRMSGPC EQU   DDRMSGP+1
DDRLABEL EQU   DDRLONG+64
DDRRETRY EQU   DDRLONG+65
DDRREC   EQU   DDRLONG+66
DDRREC1  EQU   DDRREC
DDRREC2  EQU   DDRREC+1
DDRRFMTO EQU   DDRREC2
DDRUSER  EQU   DDRLONG+68
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCBRR    EQU   UCBDUDN1
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00018 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
UCBBGN   EQU   0
UCBPTR   EQU   DDRFMUCB
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00017 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
UCBRV042 EQU   UCBOBS08+5
UCBCTCF1 EQU   UCBOBS08+4
UCBCTCAD EQU   UCBOBS08
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00017
UCBSKPFG EQU   @NM00017
UCBRIPND EQU   @NM00017
UCBRTIAC EQU   @NM00017
UCBRSV79 EQU   @NM00017
UCBRSV78 EQU   @NM00017
UCBRSV77 EQU   @NM00017
UCBOLTEP EQU   @NM00017
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBRV038 EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00016 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBFL44  EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRV028 EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBRSV50 EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBRV043 EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBRV034 EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBRV032 EQU   UCBFLP1
UCBRV031 EQU   UCBFLP1
UCBRV030 EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00018
UCBHALI  EQU   @NM00018
UCBRSV09 EQU   @NM00018
UCBRSV08 EQU   @NM00018
UCBRSV07 EQU   @NM00018
UCBRSV06 EQU   @NM00018
UCBRSV05 EQU   @NM00018
UCBRSV04 EQU   @NM00018
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRPS   EQU   UCBDUDN2
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBFLB7  EQU   UCBFLB
UCBFLB6  EQU   UCBFLB
UCBFLB5  EQU   UCBFLB
UCBFLB4  EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBRSV02 EQU   UCBJBNR
UCBRSV01 EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBRV002 EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00015 EQU   UCB
DDRSSOB  EQU   DDRLONG+76
DDRUBCNT EQU   DDRLONG+72
@NM00008 EQU   DDRUSER+1
DDRUMODE EQU   DDRUSER
@NM00007 EQU   DDRREC2
DDRLNOP  EQU   DDRLABEL
@NM00006 EQU   DDRLABEL
DDRLSD   EQU   DDRLABEL
DDRLNSL  EQU   DDRLABEL
DDRLNL   EQU   DDRLABEL
DDRLBLP  EQU   DDRLABEL
DDRLAL   EQU   DDRLABEL
@NM00005 EQU   DDRIOF2
DDRICNT  EQU   DDRIOF2
DDRIMNT  EQU   DDRIOF2
DDRILAB  EQU   DDRIOF2
DDRCOUNT EQU   DDRLONG+48
DDRIBUF  EQU   DDRLONG+44
DDRIBUFL EQU   DDRLONG+42
DDRAPP2  EQU   DDRAPP+1
DDRAPP1  EQU   DDRAPP
DDRINV1  EQU   DDRINV
DDRTER2  EQU   DDRTER+1
DDRTEST  EQU   DDRLONG+32
DDRUASCB EQU   DDRLONG+28
DDRUTCB  EQU   DDRLONG+24
DDRUIOB  EQU   DDRLONG+20
DDRUDEB  EQU   DDRMIHT+4
DDRUDCB  EQU   DDRMIHT
DDRASID  EQU   DDRLONG+10
DDRMIH   EQU   DDRLONG+9
DDRJES3L EQU   DDRROWN
@NM00004 EQU   DDRROWN
DDRRDENQ EQU   DDRROWN
DDRRUENQ EQU   DDRROWN
DDRRTENQ EQU   DDRROWN
DDRUASID EQU   DDRSHORT+16
DDRUIOSB EQU   DDRSHORT+12
@NM00003 EQU   DDRDSTAT
DDRMDR   EQU   DDRDCHAR
@NM00002 EQU   DDRSTAT
DDRSIRB  EQU   DDRSTAT
DDRPRG   EQU   DDRSTAT
DDRRMV   EQU   DDRSTAT
DDRHAMA  EQU   DDRSTAT
DDRQUE   EQU   DDRSTAT
DDRACTV  EQU   DDRSTAT
@NM00001 EQU   DDRSRC
DDROPER  EQU   DDRSRC
DDRNXT   EQU   DDRSHORT+4
DDRID    EQU   DDRSHORT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00290 EQU   @EL00003
@RC00325 EQU   @EL00003
@RC00323 EQU   @EL00003
@PB00003 EQU   @EL00001
@ENDDATA EQU   *
         END   IGFDV0,(C'PLS1817',0701,76246)

         TITLE 'IEECB904 - VARY RANGE PROCESSOR MODULE                 *
                        '
IEECB904 CSECT ,                                                   0001
@PROLOG  BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
         MODID BR=YES
DEFREG   DS    0H                                                  0004
*                                                                  0094
*/*                      END OF CSCB                                 */
*                                                                  0095
         EJECT
*                                                                  0095
*/********************************************************************/
*/*                                                                  */
*/* THIS IS THE MAIN VARY RANGE ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0095
         SPACE 1
*   IF XAARNG1=OFF THEN             /* IS THIS FIRST TIME ENTRY?     */
         TM    XAARNG1+42(XSAPTR),B'10000000'                      0095
         BNZ   @RF00095                                            0095
*     DO;                           /* YES, DO INITIALIZATION        */
*       CALL GETSAVE;               /* GET VARY RANGE WORKAREA       */
         BAL   @14,GETSAVE                                         0097
*       RFY                                                        0098
*        (R8,                                                      0098
*         R10,                                                     0098
*         R12) UNRSTD;                                             0098
*       RFY                                                        0099
*         BUFF BASED(XAL);                                         0099
*       IF CHARSCAN(ONE:ONE)=LEFTPARN THEN/* IF FIRST CHAR IS A '(', */
         L     @12,XAL-1(,XSAPTR)                                  0100
         LA    @12,0(,@12)                                         0100
         L     @10,SCANPTR(,@12)                                   0100
         CLI   CHARSCAN(@10),C'('                                  0100
         BNE   @RF00100                                            0100
*         SCANPTR=SCANPTR+ONE;      /* INDEX TO NEXT CHARACTER       */
         AL    @10,@CF00099                                        0101
         ST    @10,SCANPTR(,@12)                                   0101
*     END;                                                         0102
*   ELSE                                                           0103
*     LM(R0,R13,REGSAVE);           /* OBTAIN REGISTERS              */
         B     @RC00095                                            0103
@RF00095 L     @12,XAL-1(,XSAPTR)                                  0103
         LM    R0,R13,REGSAVE(@12)                                 0103
*   IF XAARNG3=OFF THEN             /* TERMINATION EXIT?             */
@RC00095 TM    XAARNG3+42(XSAPTR),B'00100000'                      0104
         BNZ   @RF00104                                            0104
*     DO WHILE((CHARSCAN(ONE:SIX)^=ONL)&(CHARSCAN(ONE:SEVEN)^=OFFL)&(
*           CHARSCAN(ONE:SEVEN)^=COMAONL)&(CHARSCAN(ONE:EIGHT)^=   0105
*           COMAOFFL));             /* NO, WORK ON COMMAND UNTIL   0105
*                                      'ONLINE' OR 'OFFLINE'         */
         B     @DE00105                                            0105
@DL00105 DS    0H                                                  0106
*       SWITCH=OFF;                 /* CLEAR THE SWITCH              */
         NI    SWITCH(R9),B'01111111'                              0106
*       IF((FIRST=ZERO)&(LAST=ZERO)&(CURRENT=ZERO)) THEN/* A NEW     */
         SLR   @12,@12                                             0107
         L     @10,XAL-1(,XSAPTR)                                  0107
         LA    @10,0(,@10)                                         0107
         CH    @12,FIRST(,@10)                                     0107
         BNE   @RF00107                                            0107
         CH    @12,LAST(,@10)                                      0107
         BNE   @RF00107                                            0107
         CH    @12,CURRENT(,@10)                                   0107
         BNE   @RF00107                                            0107
*         DO;                       /* RANGE TO BE WORKED ON?        */
*           CALL SYNTAX;            /* YES, INSPECT THE RANGE        */
         BAL   @14,SYNTAX                                          0109
*           IF SWITCH=ON THEN       /* IS THE RANGE CORRECT          */
         TM    SWITCH(R9),B'10000000'                              0110
         BNO   @RF00110                                            0110
*             DO;                   /* CHARACTER-WISE?               */
*               MSGCODE=UNITINV;    /* NO, SET ERROR CODE            */
         MVI   MSGCODE(R9),X'01'                                   0112
*               CALL WRITEOUT;      /* WRITE OUT ERROR MESSAGE       */
         BAL   @14,WRITEOUT                                        0113
*             END;                                                 0114
*           ELSE                    /* YES, INSERT RANGE UNITS       */
*             CALL SETUP;           /* INTO THE NEW BUFFER           */
         B     @RC00110                                            0115
@RF00110 BAL   @14,SETUP                                           0115
*           IF((SWITCH=OFF)&(FIRST>LAST)) THEN/* WAS A VALID RANGE   */
@RC00110 TM    SWITCH(R9),B'10000000'                              0116
         BNZ   @RF00116                                            0116
         L     @12,XAL-1(,XSAPTR)                                  0116
         LA    @12,0(,@12)                                         0116
         CLC   FIRST(2,@12),LAST(@12)                              0116
         BNH   @RF00116                                            0116
*             DO;                   /* SPECIFIED?                    */
*               SWITCH=ON;          /* NO, SET SWITCH ON             */
         OI    SWITCH(R9),B'10000000'                              0118
*               MSGCODE=RANGEINV;   /* SET ERROR CODE                */
         MVI   MSGCODE(R9),X'03'                                   0119
*               CALL WRITEOUT;      /* WRITE OUT ERROR MESSAGE       */
         BAL   @14,WRITEOUT                                        0120
*             END;                                                 0121
*         END;                                                     0122
@RF00116 DS    0H                                                  0123
*       IF SWITCH=OFF THEN          /* IF NO ERRORS INCURRED, DO     */
@RF00107 TM    SWITCH(R9),B'10000000'                              0123
         BNZ   @RF00123                                            0123
*         DO;                       /* FURTHER PROCESSING            */
*           IF HIGHADDR=FOXFFF THEN /* HAS HIGH ADDRESS BEEN         */
         L     @12,XAL-1(,XSAPTR)                                  0125
         LA    @12,0(,@12)                                         0125
         CLC   HIGHADDR(2,@12),@CH00153                            0125
         BNE   @RF00125                                            0125
*             DO;                   /* PROCESSED?                    */
*               SWITCH=ON;          /* YES, SET SWITCH ON            */
         OI    SWITCH(R9),B'10000000'                              0127
*               IF VALCTR=ZERO THEN /* IS THERE ANY VALID UNITS      */
         LH    @10,VALCTR(,@12)                                    0128
         LTR   @10,@10                                             0128
         BNZ   @RF00128                                            0128
*                 DO;               /* TO BE DISPLAYED?              */
*                   MSGCODE=UNITSINV;/* NO, SET ERROR CODE           */
         MVI   MSGCODE(R9),X'02'                                   0130
*                   IF FIRST=LAST THEN/* IF RANGE ENDPOINTS ARE      */
         CLC   FIRST(2,@12),LAST(@12)                              0131
         BNE   @RF00131                                            0131
*                     MSGCODE=UNITINV;/* SAME, WRITE OUT ONE UNIT    */
         MVI   MSGCODE(R9),X'01'                                   0132
*                   IF XAARNG5=ON THEN/* ANY NON-COUNTED DEVICES?    */
@RF00131 TM    XAARNG5+42(XSAPTR),B'00001000'                      0133
         BNO   @RF00133                                            0133
*                     MSGCODE=VARYPROC;/* YES, PUT OUT PROCESS. MSG  */
         MVI   MSGCODE(R9),X'04'                                   0134
*                   CALL WRITEOUT;  /* WRITE OUT THE MESSAGE         */
@RF00133 BAL   @14,WRITEOUT                                        0135
*                 END;                                             0136
*               ELSE                /* YES, DO A 'DISPLAY UNITS'     */
*                 CALL DISPLAY;     /* FOR ALL VALID UNITS           */
         B     @RC00128                                            0137
@RF00128 BAL   @14,DISPLAY                                         0137
*             END;                                                 0138
@RC00128 DS    0H                                                  0139
*         END;                                                     0139
@RF00125 DS    0H                                                  0140
*       IF SWITCH=ON THEN           /* WERE THERE ANY OUTPUT         */
@RF00123 TM    SWITCH(R9),B'10000000'                              0140
         BNO   @RF00140                                            0140
*         DO;                       /* PROCESSED?                    */
*           FIRST=ZERO;             /* YES, ZERO OUT OLD RANGE       */
         SLR   @12,@12                                             0142
         L     @10,XAL-1(,XSAPTR)                                  0142
         LA    @10,0(,@10)                                         0142
         STH   @12,FIRST(,@10)                                     0142
*           LAST=ZERO;              /* SPECIFICATIONS FOR NEXT       */
         STH   @12,LAST(,@10)                                      0143
*           CURRENT=ZERO;           /* PASS, IF ANY                  */
         STH   @12,CURRENT(,@10)                                   0144
*           VALCTR=ZERO;            /* ZERO VALID UNIT COUNTER       */
         STH   @12,VALCTR(,@10)                                    0145
*           XAARNG5=OFF;            /* TURN OFF ALT. PATH BIT        */
         NI    XAARNG5+42(XSAPTR),B'11110111'                      0146
*           SCANPTR=SCANPTR+EIGHT;  /* UPDATE CHARACTER POINTER      */
         LA    @12,8                                               0147
         AL    @12,SCANPTR(,@10)                                   0147
         ST    @12,SCANPTR(,@10)                                   0147
*         END;                                                     0148
*       ELSE                        /* NO OUTPUT, THEN IT MUST BE    */
*         DO;                       /* A NEW COMMAND TO BE BUILT     */
         B     @RC00140                                            0149
@RF00140 DS    0H                                                  0150
*           CALL BUILDER;           /* BUILD THE NEW COMMAND         */
         BAL   @14,BUILDER                                         0150
*           IF CURRENT>LAST THEN    /* INDICATE HIGH ADDRESS HAS     */
         L     @12,XAL-1(,XSAPTR)                                  0151
         LA    @12,0(,@12)                                         0151
         CLC   CURRENT(2,@12),LAST(@12)                            0151
         BNH   @RF00151                                            0151
*             HIGHADDR=FOXFFF;      /* BEEN REACHED                  */
         MVC   HIGHADDR(2,@12),@CH00153                            0152
*           LM(R0,R15,REGSAVE);     /* RESTORE IEE3603D'S REGS.      */
@RF00151 L     @12,XAL-1(,XSAPTR)                                  0153
         LM    R0,R15,REGSAVE(@12)                                 0153
*           CALL IEE36ENT;          /* PROCESS THRU VARY AREA        */
         L     @15,@CV00275                                        0154
         BALR  @14,@15                                             0154
*         END;                                                     0155
*     END;                                                         0156
@RC00140 DS    0H                                                  0156
@DE00105 L     @12,XAL-1(,XSAPTR)                                  0156
         L     @12,SCANPTR(,@12)                                   0156
         CLC   CHARSCAN(6,@12),ONL                                 0156
         BE    @DC00105                                            0156
         CLC   CHARSCAN(7,@12),OFFL                                0156
         BE    @DC00105                                            0156
         CLC   CHARSCAN(7,@12),COMAONL                             0156
         BE    @DC00105                                            0156
         CLC   CHARSCAN(8,@12),COMAOFFL                            0156
         BNE   @DL00105                                            0156
@DC00105 DS    0H                                                  0157
*   RFY                                                            0157
*    (R10) RSTD;                    /* RESTRICT REGISTER 10          */
@RF00104 DS    0H                                                  0158
*   CALL TERMEXIT;                  /* PREPARE FOR TERMINATION       */
         BAL   @14,TERMEXIT                                        0158
*   R14=R10;                        /* GET CALLER'S ADDRESS          */
         LR    R14,R10                                             0159
         EJECT
*GETSAVE:                                                          0160
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0160
*                                                                  0160
@EL00001 DS    0H                                                  0160
@EF00001 DS    0H                                                  0160
@ER00001 BR    @14                                                 0160
GETSAVE  DS    0H                                                  0161
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE IS CALLED ON A FIRST TIME ENTRY TO IEECB904 AS   */
*/* TO ESTABLISH THE NECESSARY DATA AREAS                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0161
         SPACE 1
*   RFY                                                            0161
*    (R8,                                                          0161
*     R10,                                                         0161
*     R12) RSTD;                    /* RESTRICT REGISTERS            */
*   XAARNG1=ON;                     /* INDICATE VARY RANGE IS UP     */
         OI    XAARNG1+42(XSAPTR),B'10000000'                      0162
*   R0=GETINFO;                     /* PREPARE FOR GETMAIN           */
         L     R0,GETINFO                                          0163
*   DO;                             /* GETMAIN (R) LV(R0)            */
*     RESPECIFY                                                    0165
*      (GPR01F,                                                    0165
*       GPR00F) RESTRICTED;                                        0165
*     GPR00F=R0;                    /* LENGTH REQUESTED              */
*     GPR01F=-1;                    /* INDICATE A GETMAIN REQUEST    */
         SLR   GPR01F,GPR01F                                       0167
         BCTR  GPR01F,0                                            0167
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0168
*     RESPECIFY                                                    0169
*      (GPR01F,                                                    0169
*       GPR00F) UNRESTRICTED;                                      0169
*   END;                            /* GETMAIN (R) LV(R0) ISSUE    0170
*                                      GETMAIN                       */
*   RFY                                                            0171
*     BUFF BASED(R1);                                              0171
*   BUFF(K125:K208)=''B;            /* ZERO OUT DATA AREAS           */
         XC    BUFF+124(84,R1),BUFF+124(R1)                        0172
*   SCANPTR=XAL;                    /* SAVE OLD XAL IN DATA AREA     */
         L     @03,XAL-1(,XSAPTR)                                  0173
         LA    @03,0(,@03)                                         0173
         ST    @03,SCANPTR(,R1)                                    0173
*   RFY                                                            0174
*     BUFF BASED(XAL);              /* ESTABLISH XAL TO POINT TO     */
*   XAL=R1;                         /* THE NEWLY OBTAINED BUFFER     */
         STCM  R1,7,XAL(XSAPTR)                                    0175
*   STM(R0,R15,REGSAVE);            /* SAVE IEE3603D'S REGISTERS     */
         L     @03,XAL-1(,XSAPTR)                                  0176
         LA    @03,0(,@03)                                         0176
         STM   R0,R15,REGSAVE(@03)                                 0176
*   RFY                                                            0177
*    (R8,                                                          0177
*     R10,                                                         0177
*     R12) UNRSTD;                  /* UNRESTRICT RESTRICTED REGS    */
*   END GETSAVE;                                                   0178
@EL00002 DS    0H                                                  0178
@EF00002 DS    0H                                                  0178
@ER00002 BR    @14                                                 0178
         EJECT
*SYNTAX:                                                           0179
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0179
*                                                                  0179
SYNTAX   DS    0H                                                  0180
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE IS CALLED TO CHECK THE VALIDITY OF EACH          */
*/* CHARACTER IN THE RANGE SPECIFICATION                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0180
         SPACE 1
*   SYNPTR=SCANPTR;                 /* SET POINTER FOR SCANNING      */
         L     @12,XAL-1(,XSAPTR)                                  0180
         L     SYNPTR,SCANPTR(,@12)                                0180
*   MSGPTR=SYNPTR;                  /* SET POINTER FOR MESSAGE       */
         ST    SYNPTR,MSGPTR(,R9)                                  0181
*   DO COUNTERA=ONE BY ONE TO TWO WHILE SWITCH=OFF;/* SCAN THE RANGE */
         LA    COUNTERA,1                                          0182
@DL00182 TM    SWITCH(R9),B'10000000'                              0182
         BNZ   @DC00182                                            0182
*     DO COUNTER=ONE BY ONE TO THREE;/* SCAN THE 3 DIGIT UNIT        */
         LA    COUNTER,1                                           0183
@DL00183 DS    0H                                                  0184
*       IF(((SYNSCAN<FOXZERO)×(SYNSCAN>FOXNINE))&((SYNSCAN<ABLE)×( 0184
*           SYNSCAN>FOX))) THEN     /* IF AN INCORRECT CHARACTER     */
         CLI   SYNSCAN(SYNPTR),C'0'                                0184
         BL    @GL00007                                            0184
         CLI   SYNSCAN(SYNPTR),C'9'                                0184
         BNH   @RF00184                                            0184
@GL00007 CLI   SYNSCAN(SYNPTR),C'A'                                0184
         BL    @RT00184                                            0184
         CLI   SYNSCAN(SYNPTR),C'F'                                0184
         BNH   @RF00184                                            0184
@RT00184 DS    0H                                                  0185
*         SWITCH=ON;                /* IS DETECTED, MARK IT          */
         OI    SWITCH(R9),B'10000000'                              0185
*       SYNPTR=SYNPTR+ONE;          /* UPDATE TO NEXT DIGIT          */
@RF00184 AL    SYNPTR,@CF00099                                     0186
*     END;                                                         0187
         AL    COUNTER,@CF00099                                    0187
         C     COUNTER,@CF00103                                    0187
         BNH   @DL00183                                            0187
*     IF((SYNSCAN=HYPHEN)&(SWITCH=OFF)) THEN/* END OF FIRST UNIT     */
         CLI   SYNSCAN(SYNPTR),C'-'                                0188
         BNE   @RF00188                                            0188
         TM    SWITCH(R9),B'10000000'                              0188
         BNZ   @RF00188                                            0188
*       DO;                         /* WITHOUT ANY ERROR(S)?         */
*         SYNPTR=SYNPTR+ONE;        /* YES, UPDATE TO NEXT UNIT      */
         AL    SYNPTR,@CF00099                                     0190
*         MSGPTR=SYNPTR;            /* UPDATE MESSAGE POINTER        */
         ST    SYNPTR,MSGPTR(,R9)                                  0191
*       END;                                                       0192
*   END;                                                           0193
@RF00188 AL    COUNTERA,@CF00099                                   0193
         C     COUNTERA,@CF00101                                   0193
         BNH   @DL00182                                            0193
@DC00182 DS    0H                                                  0194
*   END SYNTAX;                                                    0194
@EL00003 DS    0H                                                  0194
@EF00003 DS    0H                                                  0194
@ER00003 BR    @14                                                 0194
         EJECT
*SETUP:                                                            0195
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0195
*                                                                  0195
SETUP    DS    0H                                                  0196
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE INSERTS THE LOW AND HIGH ADDRESSES INTO ITS      */
*/* RESPECTIVE DATA AREAS IN THE BUFFER AFTER PACKING                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0196
         SPACE 1
*   SYNPTR=SCANPTR;                 /* SET POINTER FOR SCANNING      */
         L     @12,XAL-1(,XSAPTR)                                  0196
         L     SYNPTR,SCANPTR(,@12)                                0196
*   DO UNTIL((SYNSCAN=COMMA)×(SYNSCAN=RGHTPARN));/* SCAN THE RANGE   */
@DL00197 DS    0H                                                  0198
*     TEMPAREA(ONE:THREE)=MOVEUNIT; /* PUT UNIT IN TEMPORARY AREA    */
         MVC   TEMPAREA(3,R9),MOVEUNIT(SYNPTR)                     0198
*     TEMPTR=ADDR(TEMPAREA);        /* GET TEMPORARY AREA POINTER    */
         LA    TEMPTR,TEMPAREA(,R9)                                0199
*     DO COUNTER=ONE BY ONE TO THREE;/* SCAN THE 3 DIGIT UNIT        */
         LA    COUNTER,1                                           0200
@DL00200 DS    0H                                                  0201
*       IF((TRANAREA(ONE:ONE)>=ABLE)&(TRANAREA(ONE:ONE)<=FOX)) THEN
         CLI   TRANAREA(TEMPTR),C'A'                               0201
         BL    @RF00201                                            0201
         CLI   TRANAREA(TEMPTR),C'F'                               0201
         BH    @RF00201                                            0201
*         TR(TRANAREA,TABLEA);      /* CONVERT IT IF 'A' TO 'F'      */
         TR    TRANAREA(1,TEMPTR),TABLEA                           0202
*       TEMPTR=TEMPTR+ONE;          /* GO TO NEXT CHARACTER          */
@RF00201 AL    TEMPTR,@CF00099                                     0203
*     END;                                                         0204
         AL    COUNTER,@CF00099                                    0204
         C     COUNTER,@CF00103                                    0204
         BNH   @DL00200                                            0204
*     PACK(PACKAREA(ONE:TWO),TEMPAREA(ONE:THREE));/* PACK THE 3    0205
*                                      DIGITS                        */
         PACK  PACKAREA(2,R9),TEMPAREA(3,R9)                       0205
*     SRL(PACKAREA,FOUR);           /* SHIFT OUT THE SIGN BIT        */
         LH    @12,PACKAREA(,R9)                                   0206
         N     @12,@CF00627                                        0206
         LA    @10,4                                               0206
         SRL   @12,0(@10)                                          0206
         STH   @12,PACKAREA(,R9)                                   0206
*     DIGIT=DIGIT&ZEROFFF;          /* REMOVE HIGH BIT               */
         LA    @12,4095                                            0207
         LH    @10,DIGIT(,R9)                                      0207
         N     @10,@CF00627                                        0207
         NR    @12,@10                                             0207
         STH   @12,DIGIT(,R9)                                      0207
*     IF HYPHENCK=HYPHEN THEN       /* IS THIS THE FIRST UNIT OF     */
         CLI   HYPHENCK(SYNPTR),C'-'                               0208
         BNE   @RF00208                                            0208
*       DO;                         /* THE RANGE SPECIFICATION?      */
*         FIRST=PACKAREA;           /* YES, PUT PACKED UNIT INTO     */
         L     @12,XAL-1(,XSAPTR)                                  0210
         LA    @12,0(,@12)                                         0210
         LH    @10,PACKAREA(,R9)                                   0210
         N     @10,@CF00627                                        0210
         STH   @10,FIRST(,@12)                                     0210
*         CURRENT=PACKAREA;         /* RESPECTIVE AREAS              */
         STH   @10,CURRENT(,@12)                                   0211
*         SYNPTR=SYNPTR+ONE;        /* UPDATE POINTER BY ONE         */
         AL    SYNPTR,@CF00099                                     0212
*       END;                                                       0213
*     ELSE                          /* NO, PUT PACKED UNIT INTO      */
*       LAST=PACKAREA;              /* 'LAST' DATA AREA              */
         B     @RC00208                                            0214
@RF00208 L     @12,XAL-1(,XSAPTR)                                  0214
         LH    @10,PACKAREA(,R9)                                   0214
         N     @10,@CF00627                                        0214
         STH   @10,LAST(,@12)                                      0214
*     SYNPTR=SYNPTR+THREE;          /* UPDATE POINTER PAST UNIT      */
@RC00208 AL    SYNPTR,@CF00103                                     0215
*   END;                                                           0216
@DE00197 CLI   SYNSCAN(SYNPTR),C','                                0216
         BE    @DC00197                                            0216
         CLI   SYNSCAN(SYNPTR),C')'                                0216
         BNE   @DL00197                                            0216
@DC00197 DS    0H                                                  0217
*   END SETUP;                                                     0217
@EL00004 DS    0H                                                  0217
@EF00004 DS    0H                                                  0217
@ER00004 BR    @14                                                 0217
         EJECT
*WRITEOUT:                                                         0218
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0218
*                                                                  0218
WRITEOUT DS    0H                                                  0219
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE INVOKES A MESSAGE PRINTOUT                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0219
         SPACE 1
*   STM(R0,R1,SAVEPTRS);            /* SAVE REGISTERS 0 AND 1        */
         STM   R0,R1,SAVEPTRS(R9)                                  0219
*   IF((MSGCODE=UNITINV)×(MSGCODE=UNITSINV)) THEN/* IS IT UNIT REF 0220
*                                      INV?                          */
         CLI   MSGCODE(R9),X'01'                                   0220
         BE    @RT00220                                            0220
         CLI   MSGCODE(R9),X'02'                                   0220
         BNE   @RF00220                                            0220
@RT00220 DS    0H                                                  0221
*     DO;                           /* YES, PROCESS                  */
*       MSGBUFF(ONE:K42)=UNTMSG;    /* INSERT UNIT REF INV. TEXT     */
         L     @12,XAL-1(,XSAPTR)                                  0222
         LA    @12,0(,@12)                                         0222
         MVC   MSGBUFF(42,@12),UNTMSG                              0222
*       IF MSGCODE=UNITINV THEN     /* ONE UNIT INVALID?             */
         CLI   MSGCODE(R9),X'01'                                   0223
         BNE   @RF00223                                            0223
*         UNIT(ONE:THREE)=MSG;      /* YES, INSERT THE UNIT          */
         L     @10,MSGPTR(,R9)                                     0224
         MVC   UNIT(3,@12),MSG(@10)                                0224
*       ELSE                        /* NO, IT IS AN INVALID          */
*         UNIT(ONE:SEVEN)=CHARSCAN; /* VARY RANGE SPECIFICATION      */
         B     @RC00223                                            0225
@RF00223 L     @12,XAL-1(,XSAPTR)                                  0225
         LA    @12,0(,@12)                                         0225
         L     @10,SCANPTR(,@12)                                   0225
         MVC   UNIT(7,@12),CHARSCAN(@10)                           0225
*     END;                                                         0226
*   ELSE                                                           0227
*     DO;                                                          0227
         B     @RC00220                                            0227
@RF00220 DS    0H                                                  0228
*       IF MSGCODE=VARYPROC THEN    /* IS IT A COMPLETION CODE?      */
         CLI   MSGCODE(R9),X'04'                                   0228
         BNE   @RF00228                                            0228
*         MSGBUFF(ONE:K44)=VRYMSG;  /* YES, SET MESSAGE TEXT         */
         L     @12,XAL-1(,XSAPTR)                                  0229
         MVC   MSGBUFF(44,@12),VRYMSG                              0229
*       ELSE                                                       0230
*         DO;                       /* INSERT THE INVALID RANGE      */
         B     @RC00228                                            0230
@RF00228 DS    0H                                                  0231
*           MSGBUFF(ONE:K42)=RNGMSG;/* MESSAGE TEXT                  */
         L     @12,XAL-1(,XSAPTR)                                  0231
         LA    @12,0(,@12)                                         0231
         MVC   MSGBUFF(42,@12),RNGMSG                              0231
*           RANGE(ONE:SEVEN)=CHARSCAN;/* INSERT THE RANGE UNITS      */
         L     @10,SCANPTR(,@12)                                   0232
         MVC   RANGE(7,@12),CHARSCAN(@10)                          0232
*         END;                                                     0233
*     END;                                                         0234
@RC00228 DS    0H                                                  0235
*   R0=ZEROZERO;                    /* CLEAR WTO REGISTER    @ZM30445*/
@RC00220 SLR   R0,R0                                               0235
*   IF XAU^=RI THEN                 /* FROM INPUT STREAM?    @ZM30445*/
         CLI   XAU(XSAPTR),X'80'                                   0236
         BE    @RF00236                                            0236
*     R0=XAU;                       /* INSERT CONSOLE ID     @ZM30445*/
         SLR   R0,R0                                               0237
         IC    R0,XAU(,XSAPTR)                                     0237
*   DO;                             /* WTOP MF(E,MSGBUFF)            */
@RF00236 DS    0H                                                  0239
*     RFY                                                          0239
*       GPR01P RSTD;                /* RESTRICT REG 1                */
*     GPR01P=ADDR(MSGBUFF);         /* ADDRESS CONTROL PROGRAM LIST  */
         L     GPR01P,XAL-1(,XSAPTR)                               0240
         LA    GPR01P,0(,GPR01P)                                   0240
*     SVC(35);                      /* ISSUE WTO SVC                 */
         SVC   35                                                  0241
*     RFY                                                          0242
*       GPR01P UNRSTD;              /* RELEASE REG 1                 */
*   END;                            /* WTOP MF(E,MSGBUFF) WRITE OUT
*                                      THE MESSAGE                   */
*   LM(R0,R1,SAVEPTRS);             /* RESTORE REGISTERS 0 AND 1     */
         LM    R0,R1,SAVEPTRS(R9)                                  0244
*   END WRITEOUT;                                                  0245
@EL00005 DS    0H                                                  0245
@EF00005 DS    0H                                                  0245
@ER00005 BR    @14                                                 0245
         EJECT
*BUILDER:                                                          0246
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0246
*                                                                  0246
BUILDER  DS    0H                                                  0247
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE BUILDS A NEW COMMAND IMAGE FROM A SPECIFIED      */
*/* RANGE BY INSERTING INDIVIDUAL UNITS                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0247
         SPACE 1
*   OPERAND(ONE:K124)=BLANK;        /* BLANK OUT THE COMMAND IMAGE 0247
*                                      FIELD                         */
         L     @12,XAL-1(,XSAPTR)                                  0247
         LA    @12,0(,@12)                                         0247
         MVI   OPERAND+1(@12),C' '                                 0247
         MVC   OPERAND+2(122,@12),OPERAND+1(@12)                   0247
         MVI   OPERAND(@12),C' '                                   0247
*   OPERPTR=XAL;                    /* SET POINTER TO 1ST INSERT     */
         LR    OPERPTR,@12                                         0248
*   INSERTS(ONE:ONE)=LEFTPARN;      /* INSERT A LEFT PARENTHESIS     */
         MVI   INSERTS(OPERPTR),C'('                               0249
*   DO COUNTER=ONE BY ONE TO K28 WHILE LAST>=CURRENT;/* INSERTION  0250
*                                      LOOP                          */
         LA    COUNTER,1                                           0250
@DL00250 L     @12,XAL-1(,XSAPTR)                                  0250
         LA    @12,0(,@12)                                         0250
         LH    @10,CURRENT(,@12)                                   0250
         CH    @10,LAST(,@12)                                      0250
         BH    @DC00250                                            0250
*     OPERPTR=OPERPTR+ONE;          /* UPDATE INSERTION POINTER      */
         AL    OPERPTR,@CF00099                                    0251
*     PACKAREA=CURRENT;             /* OBTAIN PACKED VALUE           */
         STH   @10,PACKAREA(,R9)                                   0252
*SHIFTLBL:                                                         0253
*     SLL(PACKAREA,FOUR);           /* SHIFT TO PUT IN SIGN BIT ***
*                                      'SHIFTLBL' LABEL IS USED TO 0253
*                                      BREAK PLS REGISTER HISTORY ****/
SHIFTLBL LH    @12,PACKAREA(,R9)                                   0253
         N     @12,@CF00627                                        0253
         LA    @10,4                                               0253
         SLL   @12,0(@10)                                          0253
         STH   @12,PACKAREA(,R9)                                   0253
*     DIGIT=DIGIT×ZEROFOX;          /* INSERT SIGN BIT               */
         LA    @12,15                                              0254
         LH    @10,DIGIT(,R9)                                      0254
         N     @10,@CF00627                                        0254
         OR    @12,@10                                             0254
         STH   @12,DIGIT(,R9)                                      0254
*     UNPK(TEMPAREA(ONE:THREE),PACKAREA(ONE:TWO));/* UNPACK THE VALUE*/
         UNPK  TEMPAREA(3,R9),PACKAREA(2,R9)                       0255
*     TR(TEMPAREA,TABLEB);          /* ASSURE CORRECT HEX VALUES     */
         TR    TEMPAREA(3,R9),TABLEB                               0256
*     INSERTS(ONE:THREE)=TEMPAREA;  /* PUT VALUE INTO BUFFER         */
         MVC   INSERTS(3,OPERPTR),TEMPAREA(R9)                     0257
*     OPERPTR=OPERPTR+THREE;        /* UPDATE BUFFER PAST UNIT       */
         AL    OPERPTR,@CF00103                                    0258
*     INSERTS(ONE:ONE)=COMMA;       /* INSERT A COMMA                */
         MVI   INSERTS(OPERPTR),C','                               0259
*     CURRENT=CURRENT+ONE;          /* INCREMENT UNIT VALUE          */
         L     @12,XAL-1(,XSAPTR)                                  0260
         LA    @12,0(,@12)                                         0260
         LA    @10,1                                               0260
         AH    @10,CURRENT(,@12)                                   0260
         STH   @10,CURRENT(,@12)                                   0260
*   END;                                                           0261
         AL    COUNTER,@CF00099                                    0261
         C     COUNTER,@CF00113                                    0261
         BNH   @DL00250                                            0261
@DC00250 DS    0H                                                  0262
*   INSERTS(ONE:ONE)=RGHTPARN;      /* INSERT A RIGHT PARENTHESIS    */
         MVI   INSERTS(OPERPTR),C')'                               0262
*   OPERPTR=OPERPTR+ONE;            /* UPDATE POINTER BY ONE         */
         LA    @12,1                                               0263
         ALR   OPERPTR,@12                                         0263
*   INSERTS(ONE:ONE)=COMMA;         /* INSERT A COMMA                */
         MVI   INSERTS(OPERPTR),C','                               0264
*   OPERPTR=OPERPTR+ONE;            /* UPDATE POINTER PAST COMMA     */
         ALR   OPERPTR,@12                                         0265
*   IF XAARNG4=ON THEN              /* IF THIS IS ONLINE, THEN       */
         TM    XAARNG4+42(XSAPTR),B'00010000'                      0266
         BNO   @RF00266                                            0266
*     INSERTS(ONE:SIX)=ONL;         /* INSERT 'ONLINE' KEYWORD       */
         MVC   INSERTS(6,OPERPTR),ONL                              0267
*   ELSE                            /* NO, THIS IS OFFLINE, SO       */
*     INSERTS(ONE:SEVEN)=OFFL;      /* INSERT 'OFFLINE' KEYWORD      */
         B     @RC00266                                            0268
@RF00266 MVC   INSERTS(7,OPERPTR),OFFL                             0268
*   END BUILDER;                                                   0269
@EL00006 DS    0H                                                  0269
@EF00006 DS    0H                                                  0269
@ER00006 BR    @14                                                 0269
         EJECT
*DISPLAY:                                                          0270
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0270
*                                                                  0270
DISPLAY  DS    0H                                                  0271
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE IS CALLED TO ISSUE A DISPLAY UNIT FOR VALID UNITS*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0271
         SPACE 1
*   STM(R0,R1,SAVEPTRS);            /* SAVE REGISTERS 0 AND 1        */
         STM   R0,R1,SAVEPTRS(R9)                                  0271
*   CMDCOPY=DSPIMAGE;               /* SET UP THE COMMAND            */
         L     @12,XAL-1(,XSAPTR)                                  0272
         LA    @12,0(,@12)                                         0272
         MVC   CMDCOPY(43,@12),DSPIMAGE                            0272
*   UNITNUM(ONE:THREE)=CHARSCAN;    /* INSERT FIRST UNIT             */
         L     @10,SCANPTR(,@12)                                   0273
         MVC   UNITNUM(3,@12),CHARSCAN(@10)                        0273
*   CVD(VALCTR,CVDAREA);            /* CONVERT COUNT TO DECIMAL      */
         LH    @10,VALCTR(,@12)                                    0274
         CVD   @10,CVDAREA(,R9)                                    0274
*   TEMPAREA(ONE:THREE)=CVDAREA(SIX:EIGHT);/* PREPARE FOR UNPACK     */
         MVC   TEMPAREA(3,R9),CVDAREA+5(R9)                        0275
*   DIGITA=DIGITA×ZEROFOXA;         /* INSERT SIGN BIT               */
         LA    @10,15                                              0276
         SLR   @08,@08                                             0276
         ICM   @08,7,DIGITA(R9)                                    0276
         OR    @10,@08                                             0276
         STCM  @10,7,DIGITA(R9)                                    0276
*   UNPK(NUMAREA(ONE:FOUR),TEMPAREA(ONE:THREE));/* UNPACK THE COUNTER*/
         UNPK  NUMAREA(4,R9),TEMPAREA(3,R9)                        0277
*   TR(NUMAREA,TABLEB);             /* ASSURE CORRECT HEX VALUES     */
         TR    NUMAREA(4,R9),TABLEB                                0278
*   NUMBER=NUMAREA;                 /* PUT COUNT INTO COMMAND        */
         MVC   NUMBER(4,@12),NUMAREA(R9)                           0279
*   R0=ZEROZERO;                    /* CLEAR WTO REGISTER    @ZM30445*/
         SLR   R0,R0                                               0280
*   IF XAU^=RI THEN                 /* FROM INPUT STREAM?    @ZM30445*/
         CLI   XAU(XSAPTR),X'80'                                   0281
         BE    @RF00281                                            0281
*     R0=XAU;                       /* OBTAIN CONSOLE ID     @ZM30445*/
         SLR   R0,R0                                               0282
         IC    R0,XAU(,XSAPTR)                                     0282
*   R1=XAL;                         /* OBTAIN THE COMMAND ADDRESS    */
@RF00281 L     R1,XAL-1(,XSAPTR)                                   0283
         LA    R1,0(,R1)                                           0283
*   GENERATE;                                                      0284
*                                  /* ISSUE THE COMMAND             */
 MGCR (R1)
*   LM(R0,R1,SAVEPTRS);             /* RESTORE REGISTERS 0 AND 1     */
         LM    R0,R1,SAVEPTRS(R9)                                  0285
*   END DISPLAY;                                                   0286
@EL00007 DS    0H                                                  0286
@EF00007 DS    0H                                                  0286
@ER00007 BR    @14                                                 0286
         EJECT
*TERMEXIT:                                                         0287
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0287
*                                                                  0287
TERMEXIT DS    0H                                                  0288
*/********************************************************************/
*/*                                                                  */
*/* THIS SUBROUTINE IS CALLED TO PROCESS A PREPARATION FOR A RETURN  */
*/* TO CALLER                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0288
         SPACE 1
*CDEQUE:                                                           0288
*   DO;                             /* DEQ LS(2) MF(E,IEFDEQ)        */
CDEQUE   DS    0H                                                  0289
*     RFY                                                          0289
*       GPR01F RESTRICTED;                                         0289
*     GPR01F=ADDR(IEFDEQ02);                                       0290
         LA    GPR01F,IEFDEQ02                                     0290
*     SVC(48);                                                     0291
         SVC   48                                                  0291
*     RFY                                                          0292
*       GPR01F UNRESTRICTED;                                       0292
*   END;                            /* DEQ LS(2) MF(E,IEFDEQ) RELEASE
*                                      THE RESOURCES                 */
*   RFY                                                            0294
*    (R10) RSTD;                                                   0294
*   LM(R0,R13,REGSAVE);             /* RETREIVE PERTINENT REGS       */
         L     @12,XAL-1(,XSAPTR)                                  0295
         LM    R0,R13,REGSAVE(@12)                                 0295
*   R0=IEE36GMP;                    /* PREPARE FOR FREEMAIN          */
         ICM   R0,15,IEE36GMP                                      0296
*   DO;                             /* FREEMAIN(R) LV(R0)A(IEE36WRK) */
*     RESPECIFY                                                    0298
*      (GPR01F,                                                    0298
*       GPR00F) RESTRICTED;                                        0298
*     GPR00F=R0;                    /* LENGTH REQUESTED              */
*     GPR01F=ADDR(IEE36WRK);        /* SET REGISTER ONE              */
         LR    GPR01F,R8                                           0300
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0301
*     RESPECIFY                                                    0302
*      (GPR01F,                                                    0302
*       GPR00F) UNRESTRICTED;                                      0302
*   END;                            /* FREEMAIN(R) LV(R0)A(IEE36WRK)
*                                      FREE IEE3603D'S WORK AREA     */
*   R0=DATAAREA;                    /* PREPARE FOR FREEMAIN          */
         L     R0,DATAAREA                                         0304
*   DO;                             /* FREEMAIN(R) LV(R0)A(WORKAREA) */
*     RESPECIFY                                                    0306
*      (GPR01F,                                                    0306
*       GPR00F) RESTRICTED;                                        0306
*     GPR00F=R0;                    /* LENGTH REQUESTED              */
*     GPR01F=ADDR(WORKAREA);        /* SET REGISTER ONE              */
         LR    GPR01F,R9                                           0308
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0309
*     RESPECIFY                                                    0310
*      (GPR01F,                                                    0310
*       GPR00F) UNRESTRICTED;                                      0310
*   END;                            /* FREEMAIN(R) LV(R0)A(WORKAREA)
*                                      FREE THE DATA AREA CORE       */
*   IF RANGEXAP^=ZEROZERO THEN      /* DID WE LOAD IEEVDEV?          */
         L     @12,XAL-1(,XSAPTR)                                  0312
         L     @12,RANGEXAP(,@12)                                  0312
         LTR   @12,@12                                             0312
         BZ    @RF00312                                            0312
*     DO;                           /* YES, DELETE IEEVDEV           */
*       DO;                         /* DELETE EP(IEEVDEV)            */
*         RESPECIFY                                                0315
*          (GPR00P) RESTRICTED;                                    0315
*         GPR00P=ADDR(IEEVDEV);     /* ->ENTRY NAME                  */
         LA    GPR00P,@CC00097                                     0316
*         SVC(9);                   /* DELETE SVC                    */
         SVC   9                                                   0317
*         RESPECIFY                                                0318
*          (GPR00P) UNRESTRICTED;                                  0318
*       END;                        /* DELETE EP(IEEVDEV) DELETE   0319
*                                      IEEVDEV                       */
*       RANGEXAP=ZEROZERO;          /* INDICATE IEEVDEV DELETED      */
         SLR   @12,@12                                             0320
         L     @08,XAL-1(,XSAPTR)                                  0320
         LA    @08,0(,@08)                                         0320
         ST    @12,RANGEXAP(,@08)                                  0320
*       IF RANGEXAD^=ZEROZERO THEN  /* IEEVDEV CORE EXISTING?        */
         L     @08,RANGEXAD(,@08)                                  0321
         CR    @08,@12                                             0321
         BE    @RF00321                                            0321
*         DO;                       /* YES, FREE IEEVDEV CORE        */
*           R0=THREE08;             /* GET IEEVDEV CORE SIZE         */
         ICM   R0,15,THREE08                                       0323
*           DO;                     /* FREEMAIN(R) LV(R0)A(VDEVCORE) */
*             RESPECIFY                                            0325
*              (GPR01F,                                            0325
*               GPR00F) RESTRICTED;                                0325
*             GPR00F=R0;            /* LENGTH REQUESTED              */
*             GPR01F=ADDR(VDEVCORE);/* SET REGISTER ONE              */
         LR    GPR01F,@08                                          0327
*             SVC(10);              /* R-FORM OF GETMAIN             */
         SVC   10                                                  0328
*             RESPECIFY                                            0329
*              (GPR01F,                                            0329
*               GPR00F) UNRESTRICTED;                              0329
*           END;                    /* FREEMAIN(R) LV(R0)A(VDEVCORE)
*                                      FREE THE IEEVDEV CORE         */
*           RANGEXAD=ZEROZERO;      /* INDICATE CORE FREED           */
         L     @12,XAL-1(,XSAPTR)                                  0331
         SLR   @08,@08                                             0331
         ST    @08,RANGEXAD(,@12)                                  0331
*         END;                                                     0332
*     END;                                                         0333
@RF00321 DS    0H                                                  0334
*   R0=GETINFO;                     /* PREPARE FOR FREEMAIN          */
@RF00312 L     R0,GETINFO                                          0334
*   DO;                             /* FREEMAIN(R) LV(R0)A(XALCORE)  */
*     RESPECIFY                                                    0336
*      (GPR01F,                                                    0336
*       GPR00F) RESTRICTED;                                        0336
*     GPR00F=R0;                    /* LENGTH REQUESTED              */
*     GPR01F=ADDR(XALCORE);         /* SET REGISTER ONE              */
         L     GPR01F,XAL-1(,XSAPTR)                               0338
         LA    GPR01F,0(,GPR01F)                                   0338
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0339
*     RESPECIFY                                                    0340
*      (GPR01F,                                                    0340
*       GPR00F) UNRESTRICTED;                                      0340
*   END;                            /* FREEMAIN(R) LV(R0)A(XALCORE)
*                                      FREE THE BUFFER CORE          */
*   R1=CSCBPTR;                     /* GET THE CSCB POINTER          */
         L     @12,CSCBPTR(,R13)                                   0342
         LR    R1,@12                                              0342
*   CHFC=ON;                        /* SET FREE CSCB BIT             */
         OI    CHFC(@12),B'00000010'                               0343
*   GENERATE;                                                      0344
*                                  /* DECHAIN THE CSCB FOR THIS     */
 MGCR (R1),CHAIN                   /* COMMAND                       */
*   R0=K132;                        /* GET XSA SIZE                  */
         LA    R0,132                                              0345
*   DO;                             /* FREEMAIN(R) LV(R0)A(XSAVARY)  */
*     RESPECIFY                                                    0347
*      (GPR01F,                                                    0347
*       GPR00F) RESTRICTED;                                        0347
*     GPR00F=R0;                    /* LENGTH REQUESTED              */
*     GPR01F=ADDR(XSAVARY);         /* SET REGISTER ONE              */
         LR    GPR01F,R2                                           0349
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0350
*     RESPECIFY                                                    0351
*      (GPR01F,                                                    0351
*       GPR00F) UNRESTRICTED;                                      0351
*   END;                            /* FREEMAIN(R) LV(R0)A(XSAVARY)
*                                      FREE THE XSA CORE             */
*   END TERMEXIT;                                                  0353
@EL00008 DS    0H                                                  0353
@EF00008 DS    0H                                                  0353
@ER00008 BR    @14                                                 0353
*   RFY                                                            0354
*    (R10) UNRSTD;                                                 0354
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     0355
*     GPR01F FIXED(31) REG(1),                                     0355
*     GPR00P PTR(31) REG(0),                                       0355
*     GPR01P PTR(31) REG(1);                                       0355
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0356
*     I031F FIXED(31) BASED,                                       0356
*     I031P PTR(31) BASED,                                         0356
*     I015F FIXED(15) BASED,                                       0356
*     I015P PTR(15) BASED,                                         0356
*     I008P PTR(8) BASED,                                          0356
*     I001C CHAR(1) BASED;                                         0356
*   END IEECB904                                                   0357
*                                                                  0357
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEEXSA  )                                       */
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */
*                                                                  0357
*       ;                                                          0357
@DATA    DS    0H
@CH00153 DC    XL2'FFFF'
@DATD    DSECT
         DS    0F
IEECB904 CSECT
         DS    0F
@CF00627 DC    XL4'0000FFFF'
@CF00099 DC    XL4'01'
@CF00101 DC    XL4'02'
@CF00103 DC    XL4'03'
@CF00113 DC    XL4'1C'
@DATD    DSECT
         DS    0D
IEECB904 CSECT
         NOPR  ((@ENDDATD-@DATD)*16)
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00275 DC    V(IEE36ENT)
         DS    0D
@CC00085 DC    C'SYSIEFSD'
@CC00097 DC    C'IEEVDEV '
@CC00091 DC    C'VARYDEV'
@CC00088 DC    C'Q4'
         DS    CL3
GETINFO  DS    CL4
         ORG   GETINFO
SBPOOL   DC    X'E6'
SPSIZE   DC    AL3(208)
         ORG   GETINFO+4
IEE36GMP DS    CL4
         ORG   IEE36GMP
SBPOOLA  DC    X'E5'
ZEROES   DC    X'0000'
SPSIZEA  DC    X'13'
         ORG   IEE36GMP+4
DATAAREA DS    CL4
         ORG   DATAAREA
SBPOOLB  DC    X'E5'
SPSIZEB  DC    AL3(32)
         ORG   DATAAREA+4
COMAONL  DS    CL7
         ORG   COMAONL
@NM00001 DC    CL1','
ONL      DC    CL6'ONLINE'
         ORG   COMAONL+7
COMAOFFL DS    CL8
         ORG   COMAOFFL
@NM00002 DC    CL1','
OFFL     DC    CL7'OFFLINE'
         ORG   COMAOFFL+8
THREE08  DS    CL4
         ORG   THREE08
SBPOOLC  DC    X'00'
ZEROESB  DC    X'00'
SPSIZEC  DC    X'0134'
         ORG   THREE08+4
         DS    CL1
UNTMSG   DS    CL42
         ORG   UNTMSG
UNTMSG01 DC    H'38'
UNTMSG02 DC    B'1110000000000000'
UNTMSG03 DC    CL34'IEE313I          UNIT REF. INVALID'
UNTMSG04 DC    B'0000100000000000'
UNTMSG05 DC    B'0000000000000000'
         ORG   UNTMSG+42
         DS    CL2
RNGMSG   DS    CL42
         ORG   RNGMSG
RNGMSG01 DC    H'38'
RNGMSG02 DC    B'1110000000000000'
RNGMSG03 DC    CL34'IEE779I VARY         RANGE INVALID'
RNGMSG04 DC    B'0000100000000000'
RNGMSG05 DC    B'0000000000000000'
         ORG   RNGMSG+42
         DS    CL2
VRYMSG   DS    CL44
         ORG   VRYMSG
VRYMSG01 DC    H'40'
VRYMSG02 DC    B'1110000000000000'
VRYMSG03 DC    CL36'IEE712I VARY     PROCESSING COMPLETE'
VRYMSG04 DC    B'0000100000000000'
VRYMSG05 DC    B'0000000000000000'
         ORG   VRYMSG+44
DSPIMAGE DS    CL43
         ORG   DSPIMAGE
HEAD1    DC    XL2'002B'
HEAD2    DC    XL2'0000'
DUCMD    DC    CL39'D U,,,DDD,NNNN,L=Z   VARY RANGE DISPLAY'
         ORG   DSPIMAGE+43
PATCH    DC    CL80'*** IEECB904 PATCH AREA ***'
         DS    CL1
IEFDEQ   DS    CL1
         ORG   IEFDEQ
IEFDEQ01 DS    AL4
IEFDEQ02 DS    CL12
         ORG   IEFDEQ02+0
IEFDEQ03 DC    B'01000000'
IEFDEQ04 DC    AL1(2)
IEFDEQ05 DC    B'01000001'
@NM00007 DS    CL1
IEFDEQ06 DC    AL4(@CC00085)
IEFDEQ07 DC    AL4(@CC00088)
         ORG   IEFDEQ02+12
         ORG   IEFDEQ02+12
         DC    B'11000000'
         DC    AL1(7)
         DC    B'01000001'
         DS    CL1
         DC    AL4(@CC00085)
         DC    AL4(@CC00091)
         ORG   IEFDEQ+28
IEFDEQ08 DS    AL4
         ORG   IEFDEQ+32
@DATD    DSECT
IEECB904 CSECT
TABLEA   EQU *-C'A'
         DC  X'FAFBFCFDFEFF'
TABLEB   EQU *-C'0'
         DC  C'0123456789ABCDEF'
@DATD    DSECT
@ENDDATD EQU   *
IEECB904 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
TEMPTR   EQU   @04
OPERPTR  EQU   @03
COUNTERA EQU   @04
COUNTER  EQU   @05
SYNPTR   EQU   @03
R9       EQU   @09
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R8       EQU   @08
R10      EQU   @10
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
XSAPTR   EQU   @02
GPR01F   EQU   @01
GPR00F   EQU   @00
GPR01P   EQU   @01
GPR00P   EQU   @00
R11      EQU   @11
R3       EQU   @03
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
XALCORE  EQU   0
XSAVARY  EQU   0
IEE36WRK EQU   0
VDEVCORE EQU   0
CHARSCAN EQU   0
SYNSCAN  EQU   0
MSG      EQU   0
INSERTS  EQU   0
TRANAREA EQU   0
BUFF     EQU   0
OPERAND  EQU   BUFF
FIRST    EQU   BUFF+124
LAST     EQU   BUFF+126
CURRENT  EQU   BUFF+128
VALCTR   EQU   BUFF+130
SCANPTR  EQU   BUFF+132
RANGEXAD EQU   BUFF+136
RANGEXAP EQU   BUFF+140
REGSAVE  EQU   BUFF+144
MGCRCSCB EQU   0
CSCBPTR  EQU   MGCRCSCB+64
WORKAREA EQU   0
MSGPTR   EQU   WORKAREA
SWAREA   EQU   WORKAREA+4
SWITCH   EQU   SWAREA
MSGCODE  EQU   WORKAREA+5
PACKAREA EQU   WORKAREA+6
CVDAREA  EQU   WORKAREA+8
NUMAREA  EQU   CVDAREA
SAVEPTRS EQU   WORKAREA+16
TEMPAREA EQU   WORKAREA+24
SYNSCANA EQU   0
MOVEUNIT EQU   SYNSCANA
HYPHENCK EQU   SYNSCANA+3
MSGBUFF  EQU   0
BUF313   EQU   0
UNIT     EQU   BUF313+12
BUF779   EQU   0
RANGE    EQU   BUF779+17
CMDCOPY  EQU   0
UNITNUM  EQU   CMDCOPY+10
NUMBER   EQU   CMDCOPY+14
XSAMAP   EQU   0
XASVRB   EQU   XSAMAP
XSA      EQU   XASVRB
XAD      EQU   XSA+4
XAX      EQU   XASVRB+8
@NM00008 EQU   XASVRB+16
@NM00009 EQU   XASVRB+20
XAL      EQU   @NM00009+1
XAS      EQU   XASVRB+32
XAU      EQU   XASVRB+40
XAA      EQU   XASVRB+42
XASAVLOC EQU   XSAMAP+48
XASAVLOX EQU   XASAVLOC
XASAVSTD EQU   XSAMAP+64
XASAVSTR EQU   XASAVSTD
EEXSAS01 EQU   0
EEXSAS02 EQU   0
XADUSWIT EQU   EEXSAS02
EEXSAS03 EQU   0
XASDS    EQU   EEXSAS03+2
@NM00012 EQU   EEXSAS03+4
EEXSAS04 EQU   0
XAXMASK  EQU   EEXSAS04
EEXSAS05 EQU   0
XASOPCOD EQU   EEXSAS05
XASWITCH EQU   EEXSAS05+1
XALTCHG  EQU   XASWITCH
XACOMPMS EQU   XASWITCH
XARESV   EQU   EEXSAS05+2
EEXSAS06 EQU   0
XAAVRANG EQU   EEXSAS06
XAARNG1  EQU   XAAVRANG
XAARNG3  EQU   XAAVRANG
XAARNG4  EQU   XAAVRANG
XAARNG5  EQU   XAAVRANG
XAAVRNG2 EQU   EEXSAS06+1
CHAIN    EQU   0
CHFLG    EQU   CHAIN+4
CHSTS    EQU   CHFLG+2
CHFC     EQU   CHSTS
CHACT    EQU   CHFLG+3
CHKEY    EQU   CHAIN+8
CHPARM   EQU   CHKEY
CHPKE    EQU   CHAIN+28
CHTJID   EQU   CHAIN+30
CHPROCSN EQU   CHAIN+32
CHACT1   EQU   CHPROCSN+3
CHASM    EQU   CHAIN+40
CHCIBP   EQU   CHASM+4
CHRGNSZ  EQU   CHASM+8
CHSTEP   EQU   CHASM+24
CHSWT    EQU   CHSTEP
CHSHORT  EQU   CHASM+32
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
DIGIT    EQU   PACKAREA
DIGITA   EQU   TEMPAREA
HIGHADDR EQU   CURRENT
CHAINS01 EQU   CHASM
CHTYPE   EQU   CHAINS01+124
CHTRSTAT EQU   CHAINS01+125
CHCSYSO  EQU   CHAINS01+134
*                                      START UNREFERENCED COMPONENTS
CHLAST   EQU   CHAINS01+136
CHSPA    EQU   CHAINS01+135
CHUSERID EQU   CHCSYSO
CHJB     EQU   CHCSYSO
CHDUMP   EQU   CHCSYSO
CHQUE    EQU   CHCSYSO
CHHOLD   EQU   CHCSYSO
CHOUT    EQU   CHCSYSO
CHINN    EQU   CHCSYSO
CHALL    EQU   CHCSYSO
CHINC    EQU   CHAINS01+132
CHPEND   EQU   CHAINS01+128
CHARID   EQU   CHAINS01+127
CHCNID   EQU   CHAINS01+126
@NM00018 EQU   CHTRSTAT
CHTSL    EQU   CHTRSTAT
CHTS     EQU   CHTRSTAT
CHINITL  EQU   CHTRSTAT
CHINIT   EQU   CHTRSTAT
CHJOBSL  EQU   CHTRSTAT
CHJOBS   EQU   CHTRSTAT
CHDEF    EQU   CHTYPE
CHHIAR   EQU   CHTYPE
CHARSV29 EQU   CHTYPE
CHARSV28 EQU   CHTYPE
CHARSV27 EQU   CHTYPE
CHARSV26 EQU   CHTYPE
CHARSV25 EQU   CHTYPE
CHDSTAT  EQU   CHTYPE
CHBUF    EQU   CHAINS01
CHARSV16 EQU   CHSHORT+100
CHARSV15 EQU   CHSHORT+96
CHJSCBVS EQU   CHSHORT+92
CHUSCVS  EQU   CHSHORT+88
@NM00017 EQU   CHSHORT+84
@NM00016 EQU   CHSHORT+80
CHSQA    EQU   CHSHORT+44
CHQPA    EQU   CHSHORT+8
CHJCL    EQU   CHSHORT+4
CHSPC    EQU   CHSHORT
CHSPB    EQU   CHSTEP+4
CHTCB    EQU   CHSTEP+1
CHARSV23 EQU   CHSWT
CHARSV22 EQU   CHSWT
CHARSV21 EQU   CHSWT
CHAC     EQU   CHSWT
CHPSF    EQU   CHSWT
CHPSD    EQU   CHSWT
CHJCT    EQU   CHSWT
CHARSV20 EQU   CHSWT
CHCECB   EQU   CHASM+20
CHECB    EQU   CHASM+16
CHRGNAD  EQU   CHASM+12
CHARSV18 EQU   CHRGNSZ+1
CHRPRTY  EQU   CHRGNSZ
@NM00015 EQU   CHCIBP
CHEND    EQU   CHCIBP
CHECBP   EQU   CHASM
CHDER    EQU   CHPROCSN+4
CHARSV10 EQU   CHACT1
CHARSV09 EQU   CHACT1
CHARSV08 EQU   CHACT1
CHARSV07 EQU   CHACT1
CHARSV06 EQU   CHACT1
CHARSV05 EQU   CHACT1
CHARSV04 EQU   CHACT1
CHRDWTR  EQU   CHACT1
CHARSV30 EQU   CHPROCSN+2
CHQID    EQU   CHPROCSN
CHASID   EQU   CHTJID
CHUCMP   EQU   CHAIN+29
CHTRKID  EQU   CHPKE
CHCIBCTR EQU   CHAIN+27
CHUNIT   EQU   CHAIN+24
CHCLS    EQU   CHAIN+16
CHPCOI   EQU   CHPARM
CHIFY    EQU   CHACT
CHAIFX   EQU   CHACT
CHCLD    EQU   CHACT
CHCL     EQU   CHACT
CHDSI    EQU   CHACT
CHDISC   EQU   CHACT
CHTERM   EQU   CHACT
CHSWAP   EQU   CHACT
CHABTERM EQU   CHSTS
CHDL     EQU   CHSTS
CHAD     EQU   CHSTS
CHQSPC   EQU   CHSTS
CHSOUT   EQU   CHSTS
CHSYS    EQU   CHSTS
CHAP     EQU   CHSTS
CHSZE    EQU   CHFLG+1
CHVCD    EQU   CHFLG
CHPTR    EQU   CHAIN
XAARNG16 EQU   XAAVRNG2
XAARNG15 EQU   XAAVRNG2
XAARNG14 EQU   XAAVRNG2
XAARNG13 EQU   XAAVRNG2
XAARNG12 EQU   XAAVRNG2
XAARNG11 EQU   XAAVRNG2
XAARNG10 EQU   XAAVRNG2
XAARNG9  EQU   XAAVRNG2
XAARNG8  EQU   XAAVRANG
XAARNG7  EQU   XAAVRANG
XAARNG6  EQU   XAAVRANG
XAARNG2  EQU   XAAVRANG
XARTCODE EQU   EEXSAS05+6
XACMDATH EQU   EEXSAS05+4
XALTPTR  EQU   EEXSAS05+3
XACRT2   EQU   XARESV
XACENDCK EQU   XARESV
XARES1   EQU   XASWITCH
XASMF44  EQU   XASWITCH
XASMF42  EQU   XASWITCH
XAHRDREQ EQU   XASWITCH
XASTHDCP EQU   XACOMPMS
XAINHDCP EQU   XALTCHG
XAHRDCMD EQU   XASWITCH
XAROUT   EQU   XASWITCH
XALTCON  EQU   XASOPCOD
XACMD    EQU   XASOPCOD
XALTCOM  EQU   XASOPCOD
XARESB   EQU   XASOPCOD
XAOFF    EQU   XASOPCOD
XAON     EQU   XASOPCOD
XARESA   EQU   XASOPCOD
XACON    EQU   XASOPCOD
XAXSACB  EQU   EEXSAS04+4
XAXUTME  EQU   EEXSAS04+2
XAXFREE  EQU   EEXSAS04+1
@NM00014 EQU   XAXMASK
XAXTSL   EQU   XAXMASK
XAXTS    EQU   XAXMASK
@NM00013 EQU   XAXMASK
XAXJOBSL EQU   XAXMASK
XAXJOBS  EQU   XAXMASK
XASOPTR  EQU   @NM00012+1
XASTSAVE EQU   @NM00012
XASPLS3  EQU   EEXSAS03+3
XASSDS8  EQU   XASDS
XASSDS7  EQU   XASDS
XASSDS6  EQU   XASDS
XASSDS5  EQU   XASDS
XASSDS4  EQU   XASDS
XASSDS3  EQU   XASDS
XASSDS2  EQU   XASDS
XASSDS1  EQU   XASDS
XASDID   EQU   EEXSAS03+1
XASCID   EQU   EEXSAS03
XACAHOLD EQU   EEXSAS02+2
XADRES1  EQU   EEXSAS02+1
XAUBLANK EQU   XADUSWIT
XAOUNIT  EQU   XADUSWIT
XAIOCOMP EQU   XADUSWIT
XARES3   EQU   XADUSWIT
XAUDVC   EQU   XADUSWIT
XARES2   EQU   XADUSWIT
XAIPAREN EQU   XADUSWIT
XAXPAREN EQU   XADUSWIT
@NM00011 EQU   EEXSAS01+44
XAT      EQU   EEXSAS01+20
XAF      EQU   EEXSAS01+12
XAI      EQU   EEXSAS01+4
XAH      EQU   EEXSAS01
XASAVSDR EQU   XASAVSTR+68
XASAVSDQ EQU   XASAVSTR+64
XASAVSDP EQU   XASAVSTR+60
XASAVSDO EQU   XASAVSTR+56
XASAVSDN EQU   XASAVSTR+52
XASAVSDM EQU   XASAVSTR+48
XASAVSDL EQU   XASAVSTR+44
XASAVSDK EQU   XASAVSTR+40
XASAVSDJ EQU   XASAVSTR+36
XASAVSDI EQU   XASAVSTR+32
XASAVSDH EQU   XASAVSTR+28
XASAVSDG EQU   XASAVSTR+24
XASAVSDF EQU   XASAVSTR+20
XASAVSDE EQU   XASAVSTR+16
XASAVSDD EQU   XASAVSTR+12
XASAVSDC EQU   XASAVSTR+8
XASAVSDB EQU   XASAVSTR+4
XASAVSDA EQU   XASAVSTR
XASAVLC4 EQU   XASAVLOX+12
XASAVLC3 EQU   XASAVLOX+8
XASAVLC2 EQU   XASAVLOX+4
XASAVLC1 EQU   XASAVLOX
XAK      EQU   XASVRB+44
@NM00010 EQU   XASVRB+41
XAV      EQU   XASVRB+24
XAN      EQU   @NM00009
XAR      EQU   @NM00008+1
XAE      EQU   @NM00008
XAP      EQU   XSA
COMMAL   EQU   CMDCOPY+18
ONECOMMA EQU   CMDCOPY+13
FRONT    EQU   CMDCOPY
SUFFIXA  EQU   BUF779+24
PREFIXA  EQU   BUF779
SUFFIX   EQU   BUF313+19
PREFIX   EQU   BUF313
@NM00006 EQU   WORKAREA+28
@NM00005 EQU   WORKAREA+27
@NM00004 EQU   CVDAREA+4
@NM00003 EQU   SWAREA
OFFSET   EQU   MGCRCSCB
*                                      END UNREFERENCED COMPONENTS
@RF00100 EQU   @RC00095
@RC00223 EQU   @RC00220
@RC00266 EQU   @EL00006
@PB00008 EQU   @EL00001
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IEECB904,(C'PLS1546',0701,76177)

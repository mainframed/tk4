         TITLE 'ALLOCATION/UNALLOCATION BUFFERER * IEEAB400 *          *
                        '
IEEAB400 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IEEAB400  78.090'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         STC   @02,@OLDKEY                                         0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(8),0(@01)                                  0001
         MODESET EXTKEY=SCHED
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*   WPLPTR=WTOPTR;                  /* INIT WPL POINTER              */
         L     @15,@PC00001                                        0056
         L     WPLPTR,WTOPTR(,@15)                                 0056
*   JSCBADDR=JSCBPTR;               /* INIT JSCB POINTER             */
         L     @15,@PC00001+4                                      0057
         L     JSCBADDR,JSCBPTR(,@15)                              0057
*   CALL CKIFWTP;                   /* CK IF MSG IS A WTP            */
         BAL   @14,CKIFWTP                                         0058
*   IF RETCODE=0 THEN               /* WTP MSG THEN CONTINUE         */
         SLR   @15,@15                                             0059
         CR    RETCODE,@15                                         0059
         BNE   @RF00059                                            0059
*     DO;                                                          0060
*       IF JSCBUFPT=0 THEN          /* DOES A BUFFER EXIST?          */
         C     @15,JSCBUFPT(,JSCBADDR)                             0061
         BNE   @RF00061                                            0061
*         DO;                                                      0062
*           CALL BUFCREAT;          /* NO,ISSUE GETMAIN FOR BUF      */
         BAL   @14,BUFCREAT                                        0063
*         END;                                                     0064
*       ELSE                                                       0065
*         BUFPTR=JSCBUFPT;          /* GET BUFFER PTR                */
         B     @RC00061                                            0065
@RF00061 L     @15,JSCBUFPT(,JSCBADDR)                             0065
         ST    @15,BUFPTR                                          0065
*       IF BUFLENTH>WPLLGH&BUFLENTH>132 THEN/* ENOUGH ROOM   @YM6959P
*                                      IN BUFFER                     */
@RC00061 L     @15,JSCBUFPT(,JSCBADDR)                             0066
         L     @15,BUFLENTH(,@15)                                  0066
         CH    @15,WPLLGH(,WPLPTR)                                 0066
         BNH   @RF00066                                            0066
         C     @15,@CF00496                                        0066
         BNH   @RF00066                                            0066
*         DO;                       /* YES, CONTINUE WITH PRESENT BUF*/
*           CALL CKROUTCD;          /* CK IF OTHER ROUTE CODES       */
         BAL   @14,CKROUTCD                                        0068
*           CALL MOVEMSG;           /* MOVE MSG TO BUF, REMOVE     0069
*                                      LENGTH,FLAGS AND ROUTCD       */
         BAL   @14,MOVEMSG                                         0069
*         END;                                                     0070
*       ELSE                                                       0071
*         DO;                       /* NO ROOM IN BUF GET NEW ONE    */
         B     @RC00066                                            0071
@RF00066 DS    0H                                                  0072
*           REG1=JSCBADDR;          /* JSCB PTR TO REG1              */
         LR    REG1,JSCBADDR                                       0072
*           CALL IEEAB401;          /* CALL PUT ROUTINE              */
         L     @15,@CV00068                                        0073
         BALR  @14,@15                                             0073
*           CALL BUFCREAT;          /* ISSUE GETMAIN FOR NEW BUFFER  */
         BAL   @14,BUFCREAT                                        0074
*           CALL CKROUTCD;          /* CK IF OTHER ROUTE CODES ON MSG*/
         BAL   @14,CKROUTCD                                        0075
*           CALL MOVEMSG;           /* MOVE MSG TO BUFFER            */
         BAL   @14,MOVEMSG                                         0076
*         END;                                                     0077
*     END;                                                         0078
*   RETURN;                                                        0079
@EL00001 IC    @02,@OLDKEY                                         0079
         L     @13,4(,@13)                                         0079
@EF00001 L     @00,@SIZDATD                                        0079
         LR    @01,@11                                             0079
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
@ER00001 LM    @14,@12,12(@13)                                     0079
         BR    @14                                                 0079
*CKIFWTP:                                                          0080
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0080
*                                                                  0080
         B     @EL00001                                            0080
CKIFWTP  DS    0H                                                  0081
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE CHECKS IF THIS IS A WTP MESSAGE. IF IT ISNT   */
*   /* THEN A WTO IS ISSUED AND NO FURTHER PROCESSING CARRIED OUT.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0081
*   IF WPLRLN^='00'X THEN           /* IS THIS A WTOR MSG            */
         CLI   WPLRLN(WPLPTR),0                                    0081
         BE    @RF00081                                            0081
*     DO;                                                          0082
*       WTORPRFX=WPLPTR;            /* SAVE PTR TO WTOR PREFIX       */
         ST    WPLPTR,WTORPRFX                                     0083
*       WPLPTR=WTORPRFX+LENGTH(WPLRF);/* INCREMNT PASS PREFIX        */
         L     @15,WTORPRFX                                        0084
         AL    @15,@CF00059                                        0084
         LR    WPLPTR,@15                                          0084
*     END;                                                         0085
*   ELSE                                                           0086
*     WTORPRFX=0;                   /* NOT WTOR,ZERO PREFIX POINTER  */
         B     @RC00081                                            0086
@RF00081 SLR   @15,@15                                             0086
         ST    @15,WTORPRFX                                        0086
*   IF WPLMCSFA='1'B THEN           /* DO ROUTE CODES EXIST          */
@RC00081 TM    WPLMCSFA(WPLPTR),B'10000000'                        0087
         BNO   @RF00087                                            0087
*     DO;                           /* YES, CK FOR WTP               */
*       MSGLENTH=WPLLGH-4;          /* SAVE LENGTH OF MESSAGE        */
         LH    @15,WPLLGH(,WPLPTR)                                 0089
         LR    @08,@15                                             0089
         SL    @08,@CF00072                                        0089
         ST    @08,MSGLENTH                                        0089
*       WPLSAVPT=WPLPTR;            /* SAVE WPL POINTER              */
         LR    WPLSAVPT,WPLPTR                                     0090
*       WPLPTR=WPLPTR+WPLLGH;       /* GET ADDRESS OF ROUTE CODES    */
         ALR   WPLPTR,@15                                          0091
*       IF WPLROUTK^='1'B THEN      /* IS THIS A WTP MSG             */
         TM    WPLROUTK(WPLPTR),B'00100000'                        0092
         BO    @RF00092                                            0092
*         DO;                                                      0093
*           IF WTORPRFX^=0 THEN     /* IS IT A WTOR MSG              */
         L     @15,WTORPRFX                                        0094
         LTR   @15,@15                                             0094
         BZ    @RF00094                                            0094
*             REG1=WTORPRFX;        /* YES,THEN GET WTORPTR          */
         LR    REG1,@15                                            0095
*           ELSE                                                   0096
*             REG1=WPLSAVPT;        /* NO,THEN GET WTO PTR           */
         B     @RC00094                                            0096
@RF00094 LR    REG1,WPLSAVPT                                       0096
*           GEN(WTO MF=(E,(1)));    /* ISSUE WTO                     */
@RC00094 DS    0H                                                  0097
         WTO MF=(E,(1))
*           RETCODE=4;              /* INDICATE NOT A WTP            */
         LA    RETCODE,4                                           0098
*         END;                                                     0099
*       ELSE                                                       0100
*         DO;                       /* INDICATE A WTP MSG            */
         B     @RC00092                                            0100
@RF00092 DS    0H                                                  0101
*           RETCODE=0;              /* CONTINUE PROCESSING           */
         SLR   RETCODE,RETCODE                                     0101
*           WPLPTR=WPLSAVPT;        /* RESTORE WPL POINTER           */
         LR    WPLPTR,WPLSAVPT                                     0102
*         END;                                                     0103
*     END;                                                         0104
*   ELSE                                                           0105
*     DO;                           /* NO ROUTE CODES                */
         B     @RC00087                                            0105
@RF00087 DS    0H                                                  0106
*       IF WTORPRFX^=0 THEN         /* IS IT A WTOR MESSAGE          */
         L     @15,WTORPRFX                                        0106
         LTR   @15,@15                                             0106
         BZ    @RF00106                                            0106
*         REG1=WTORPRFX;            /* YES,GET WPL PTR FROM REG 3    */
         LR    REG1,@15                                            0107
*       ELSE                                                       0108
*         REG1=WPLPTR;              /* NOT WTOR GET PTR FROM REG 2   */
         B     @RC00106                                            0108
@RF00106 LR    REG1,WPLPTR                                         0108
*       GEN(WTO MF=(E,(1)));        /* ISSUE SVC 35                  */
@RC00106 DS    0H                                                  0109
         WTO MF=(E,(1))
*       RETCODE=4;                  /* NO FURTHER PROCESSING         */
         LA    RETCODE,4                                           0110
*     END;                                                         0111
*   END;                                                           0112
@EL00002 DS    0H                                                  0112
@EF00002 DS    0H                                                  0112
@ER00002 BR    @14                                                 0112
*BUFCREAT:                                                         0113
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0113
*                                                                  0113
BUFCREAT DS    0H                                                  0114
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE ISSUES A GETMAIN FOR A BUFFER. IT SAVES THE      */
*   /* BUFFER POINTER IN THE JSCB.                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0114
*   REG1=4000;                                                     0114
         LA    REG1,4000                                           0114
*   GEN(GETMAIN R,LV=(1),SP=231);   /* ISSUE GETMAIN FOR BUFFER FROM
*                                      CSA                   @ZA24503*/
         GETMAIN R,LV=(1),SP=231
*   RESPECIFY                                                      0116
*    (REG4,                                                        0116
*     REG5,                                                        0116
*     REG6,                                                        0116
*     REG7) RESTRICTED;                                            0116
*   REG4=REG1;                      /* GET BUFFER PTR        @ZA06210*/
         LR    REG4,REG1                                           0117
*   REG5=4000;                      /* SIZE OF BUFFER                */
         LA    REG5,4000                                           0118
*   REG6=0;                         /* ZERO OUT 'TO' FIELD FOR MOVE  */
         SLR   REG6,REG6                                           0119
*   REG7=' ';                       /* PADDING CHARACTER             */
         LA    REG7,64                                             0120
*   GEN;                                                           0121
     SLL REG7,24                      PADDING CHAR TO HIGH BYTE
     MVCL REG4,REG6                   BLANKS INTO BUFFER
*   BUFPTR=REG1;                    /* GET BUFFER POINTER    @ZA06210*/
         ST    REG1,BUFPTR                                         0122
*   RFY                                                            0123
*     BUFCONTL BASED(REG1);         /* BUFFER BASED ON R1    @ZA06210*/
*   BUFLENTH=4000-LENGTH(BUFCONTL); /* INITIALIZE SIZE OF BUF        */
         MVC   BUFLENTH(4,REG1),@CF00520                           0124
*   TOTALMSG=LENGTH(BUFCONTL);      /* INITIALIZE PASS CONTROL       */
         MVC   TOTALMSG(4,REG1),@CF00059                           0125
*   DO;                             /* MODESET KEYADDR(0)            */
*     SPKA(0);                      /* SET PSW KEY                   */
         SLR   @15,@15                                             0127
         SPKA  0(@15)                                              0127
*   END;                            /* MODESET KEYADDR(0) GO TO KEY
*                                      ZERO                          */
*   JSCBUFPT=REG1;                  /* SAVE BUFFER PTR       @ZA06210*/
         ST    REG1,JSCBUFPT(,JSCBADDR)                            0129
*   RFY                                                            0130
*     BUFCONTL BASED(JSCBUFPT);     /* BUFFER ON JSCB PTR    @ZA06210*/
*   DO;                             /* MODESET EXTKEY(SCHED)         */
*     SPKA(16);                     /* SET PSW KEY                   */
         LA    @15,16                                              0132
         SPKA  0(@15)                                              0132
*   END;                            /* MODESET EXTKEY(SCHED)       0133
*                                      SCHEDULER KEY                 */
*   RESPECIFY                                                      0134
*    (REG4,                                                        0134
*     REG5,                                                        0134
*     REG6,                                                        0134
*     REG7) UNRESTRICTED;                                          0134
*   END;                                                           0135
@EL00003 DS    0H                                                  0135
@EF00003 DS    0H                                                  0135
@ER00003 BR    @14                                                 0135
*CKROUTCD:                                                         0136
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0136
*                                                                  0136
CKROUTCD DS    0H                                                  0137
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE CHECKS IF THERE ARE OTHER ROUTE CODES IN ADDITION*/
*   /* TO ROUTE CODE 11 OR IF A MESSAGE TYPE FIELD EXISTS. IF THERE  */
*   /* ARE THEN THE MESSAGE IS MOVED INTO THE BUFFER, THE ROUTE CODE */
*   /* 11 IS REMOVED AND SVC 35 ISSUED. ON RETURN FROM SVC35 THE     */
*   /* ROUTE CODE 11 IS PROCESSED                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0137
*   IF WTORPRFX^=0 THEN             /* IS IT A WTOR MSG              */
         L     @15,WTORPRFX                                        0137
         LTR   @15,@15                                             0137
         BZ    @RF00137                                            0137
*     WPLPTR=WTORPRFX+LENGTH(WPLRF);/* INCREMENT PAST WTOR PREFIX  0138
*                                      FIELDS                        */
         AL    @15,@CF00059                                        0138
         LR    WPLPTR,@15                                          0138
*   WPLSAVPT=WPLPTR;                /* SAVE WPL POINTER              */
@RF00137 LR    WPLSAVPT,WPLPTR                                     0139
*   WPLPTR=WPLPTR+WPLLGH;           /* POINT TO ROUTE CODES          */
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0140
*   IF WPLROUT^='0020'X×WTORPRFX^=0 /* IS THIS A WTOR MSG            */
*       ×WPLSAVPT->WPLMCSFD='1'B THEN/* MSG TYPE FIELD PRESENT     0141
*                                                            @YM04915*/
         CLC   WPLROUT(2,WPLPTR),@CB00514                          0141
         BNE   @RT00141                                            0141
         L     @15,WTORPRFX                                        0141
         LTR   @15,@15                                             0141
         BNZ   @RT00141                                            0141
         TM    WPLMCSFD(WPLSAVPT),B'00010000'                      0141
         BNO   @RF00141                                            0141
@RT00141 DS    0H                                                  0142
*     DO;                           /* OR OTHER ROUTE CODES          */
*       WPLPTR=WPLSAVPT;            /* RESTORE WPL POINTER           */
         LR    WPLPTR,WPLSAVPT                                     0143
*       WPLSIZE=LENGTH(WPLDESC)+LENGTH(WPLROUT);/* SIZE OF ROUTE AND
*                                      DESCRIPTOR CODE FIELDS        */
         LA    WPLSIZE,4                                           0144
*       IF WPLMCSFD='1'B THEN       /* MESSAGE TYPE FIELD EXIST      */
         TM    WPLMCSFD(WPLPTR),B'00010000'                        0145
         BNO   @RF00145                                            0145
*         WPLSIZE=WPLSIZE+LENGTH(WPLMSGTY);/* YES,GET LENGTH         */
         AL    WPLSIZE,@CF00151                                    0146
*       WPLPTR=WPLPTR+WPLLGH;       /* POINT TO CODE FIELD           */
@RF00145 AH    WPLPTR,WPLLGH(,WPLPTR)                              0147
*       IF WPLMSGTD='1'B THEN       /* QID FIELD EXIST               */
         TM    WPLMSGTD(WPLPTR),B'00010000'                        0148
         BNO   @RF00148                                            0148
*         WPLSIZE=WPLSIZE+LENGTH(WPLQID);/* YES,GET ITS LENGTH       */
         AL    WPLSIZE,@CF00151                                    0149
*       IF WTORPRFX^=0 THEN         /* WTOR MESSAGE                  */
@RF00148 L     @15,WTORPRFX                                        0150
         LTR   @15,@15                                             0150
         BZ    @RF00150                                            0150
*         WPLSIZE=WPLSIZE+LENGTH(WPLRF);/* ADD WTOR PREFIX LENTH     */
         AL    WPLSIZE,@CF00059                                    0151
*       BUFPTR=JSCBUFPT+TOTALMSG;   /* YES,GET ADDR OF NEXT SLOT     */
@RF00150 L     @15,JSCBUFPT(,JSCBADDR)                             0152
         LR    @09,@15                                             0152
         AL    @09,TOTALMSG(,@15)                                  0152
         ST    @09,BUFPTR                                          0152
*       IF WTORPRFX^=0 THEN         /* IS IT A WTOR MSG              */
         L     @15,WTORPRFX                                        0153
         LTR   @15,@15                                             0153
         BZ    @RF00153                                            0153
*         WPLPTR=WTORPRFX;          /* POINT TO START OF PREFIX      */
         LR    WPLPTR,@15                                          0154
*       ELSE                                                       0155
*         WPLPTR=WPLSAVPT;          /* POINT TO WPLLGH FIELD         */
         B     @RC00153                                            0155
@RF00153 LR    WPLPTR,WPLSAVPT                                     0155
*       BUFFER(1:WPLLGH+WPLSIZE)=WPL(1:WPLLGH+WPLSIZE);/* MOVE MSG TO
*                                      BUFFER                        */
@RC00153 L     @15,BUFPTR                                          0156
         LH    @08,WPLLGH(,WPLPTR)                                 0156
         LR    @07,WPLSIZE                                         0156
         ALR   @07,@08                                             0156
         BCTR  @07,0                                               0156
         EX    @07,@SM00521                                        0156
*       IF WTORPRFX^=0 THEN         /* WTOR MSG                      */
         L     @04,WTORPRFX                                        0157
         LTR   @04,@04                                             0157
         BZ    @RF00157                                            0157
*         WPLPTR=BUFPTR+WPLLGH+LENGTH(WPLRF);/* POINT TO END MESSAGE
*                                      TEXT,INCLUDE PREFIX           */
         ALR   @15,@08                                             0158
         AL    @15,@CF00059                                        0158
         LR    WPLPTR,@15                                          0158
*       ELSE                                                       0159
*         WPLPTR=BUFPTR+WPLLGH;     /* NOT WTOR, DO NOT INCLUDE    0159
*                                      PREFIX, POINT TO MSG END      */
         B     @RC00157                                            0159
@RF00157 LH    @15,WPLLGH(,WPLPTR)                                 0159
         AL    @15,BUFPTR                                          0159
         LR    WPLPTR,@15                                          0159
*       WPLROUTK='0'B;              /* TURN OFF WTP BIT              */
@RC00157 NI    WPLROUTK(WPLPTR),B'11011111'                        0160
*       REG0=0;                     /* INIT REG 0 FOR SVC 35         */
         SLR   REG0,REG0                                           0161
*       REG1=BUFPTR;                /* POINT TO MSG IN BUFFER        */
         L     REG1,BUFPTR                                         0162
*       GEN(WTO MF=(E,(1)));        /* ISSUE SVC 35                  */
         WTO MF=(E,(1))
*       BUFPTR=JSCBUFPT;            /* RESTORE BUFFER PR             */
         L     @15,JSCBUFPT(,JSCBADDR)                             0164
         ST    @15,BUFPTR                                          0164
*     END;                                                         0165
*   WPLPTR=WPLSAVPT;                /* RESTORE WPL POINTER           */
@RF00141 LR    WPLPTR,WPLSAVPT                                     0166
*   END;                                                           0167
@EL00004 DS    0H                                                  0167
@EF00004 DS    0H                                                  0167
@ER00004 BR    @14                                                 0167
*MOVEMSG:                                                          0168
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0168
*                                                                  0168
MOVEMSG  DS    0H                                                  0169
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE MOVE THE MSG INTO THE BUFFER,REMOVING THE        */
*   /* LENGTH,FLAGS,ROUTE AND DESCRIPTOR CODES FROM THE MSG.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0169
*   BUFPTR=JSCBUFPT+TOTALMSG;       /* GET NEXT BUFFER SLOT          */
         L     @15,JSCBUFPT(,JSCBADDR)                             0169
         L     @08,TOTALMSG(,@15)                                  0169
         LR    @07,@15                                             0169
         ALR   @07,@08                                             0169
         ST    @07,BUFPTR                                          0169
*   BUFFER(1:132)='';               /* BLANK OUT BUFFER SLOT         */
         MVI   BUFFER(@07),C' '                                    0170
         MVC   BUFFER+1(131,@07),BUFFER(@07)                       0170
*   BUFFER(1:MSGLENTH)=WPLTXT(1:MSGLENTH);/* MOVE ONLY MESSAGE TO BUF*/
         L     @06,MSGLENTH                                        0171
         BCTR  @06,0                                               0171
         EX    @06,@SM00524                                        0171
*   TOTALMSG=TOTALMSG+132;          /* UPDATE TOTAL MSG LENGTH     0172
*                                                            @YM6959P*/
         LA    @09,132                                             0172
         ALR   @08,@09                                             0172
         ST    @08,TOTALMSG(,@15)                                  0172
*   BUFLENTH=BUFLENTH-132;          /* DECREASE BUF SIZE LEFT      0173
*                                                            @YM6959P*/
         LCR   @09,@09                                             0173
         AL    @09,BUFLENTH(,@15)                                  0173
         ST    @09,BUFLENTH(,@15)                                  0173
*   END;                                                           0174
@EL00005 DS    0H                                                  0174
@EF00005 DS    0H                                                  0174
@ER00005 BR    @14                                                 0174
*   END                                                            0175
*                                                                  0175
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */
*                                                                  0175
*       ;                                                          0175
@DATA    DS    0H
@SM00521 MVC   BUFFER(0,@15),WPL(WPLPTR)
@SM00524 MVC   BUFFER(0,@07),WPLTXT(WPLPTR)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
IEEAB400 CSECT
         DS    0F
@CF00151 DC    F'2'
@CF00072 DC    F'4'
@CF00059 DC    F'8'
@CF00496 DC    F'132'
@CF00520 DC    F'3992'
@DATD    DSECT
         DS    0D
BUFPTR   DS    A
MSGLENTH DS    A
WTORPRFX DS    A
TCBJSCB  DS    A
BYTELEFT DS    F
NUM256   DS    F
@OLDKEY  DS    AL1
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEEAB400 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00068 DC    V(IEEAB401)
         DS    0D
@CB00514 DC    X'0020'
PATCH    DS    CL50
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WPLPTR   EQU   @09
RETCODE  EQU   @04
JSCBADDR EQU   @10
WPLSAVPT EQU   @05
WPLSIZE  EQU   @04
REG0     EQU   @00
REG1     EQU   @01
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG14    EQU   @14
BUFFER   EQU   0
BUFCONTL EQU   0
BUFLENTH EQU   BUFCONTL
TOTALMSG EQU   BUFCONTL+4
IFGRPL   EQU   0
RPLCOMN  EQU   IFGRPL
RPLIDWD  EQU   RPLCOMN
RPLLEN   EQU   RPLIDWD+3
RPLECB   EQU   RPLCOMN+8
RPLFDBWD EQU   RPLCOMN+12
RPLFDBK  EQU   RPLFDBWD+1
RPLRTNCD EQU   RPLFDBK
RPLCNDCD EQU   RPLFDBK+1
RPLCMPON EQU   RPLCNDCD
RPLFDB2  EQU   RPLCMPON
RPLERRCD EQU   RPLCNDCD+1
RPLFDB3  EQU   RPLERRCD
RPLKEYLE EQU   RPLCOMN+16
RPLARG   EQU   RPLCOMN+36
RPLOPTCD EQU   RPLCOMN+40
RPLOPT1  EQU   RPLOPTCD
RPLECBSW EQU   RPLOPT1
RPLOPT2  EQU   RPLOPTCD+1
RPLADR   EQU   RPLOPT2
RPLOPT3  EQU   RPLOPTCD+2
RPLNXTRP EQU   RPLCOMN+44
RPLOPTC2 EQU   RPLCOMN+56
RPLOPT5  EQU   RPLOPTC2
RPLWRTYP EQU   RPLOPT5
RPLOPT6  EQU   RPLOPTC2+1
RPLUNTYP EQU   RPLOPT6
RPLOPT7  EQU   RPLOPTC2+2
RPLCNOPT EQU   RPLOPT7
RPLOPT8  EQU   RPLOPTC2+3
RPLRBAR  EQU   RPLCOMN+60
RPLAIXID EQU   RPLRBAR+2
RPLEXTDS EQU   RPLCOMN+68
RPLEXTD1 EQU   RPLEXTDS
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPLRLN   EQU   WPLRPTR
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSFA EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSF2 EQU   WPLMCSF+1
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLROUTK EQU   WPLROUT2
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGTD EQU   WPLMSGT1
WPLMSGT2 EQU   WPLMSGTY+1
WPLQID   EQU   WPLFLGS+6
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLML    EQU   0
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
WTOPTR   EQU   0
JSCBPTR  EQU   0
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCSCT   EQU   JSCBSEC3+68
JSCBUFPT EQU   JSCBSEC3+92
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV53 EQU   JSCBSEC3+82
JSCDDNNO EQU   JSCBSEC3+80
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCDSABQ EQU   JSCBSEC3+60
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00009 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00008 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCBPSCB EQU   JSCBSEC3+4
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00007 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00006 EQU   IEZJSCB
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLLTC EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLMLLEN EQU   WPLML+1
WPLML0   EQU   WPLML
WPLLINES EQU   WPLLS01+3
WPLAREA  EQU   WPLLS01+2
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFC  EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00005 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFJ EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
RPLERMSA EQU   RPLCOMN+72
RPLEMLEN EQU   RPLCOMN+70
RPLACTIV EQU   RPLCOMN+69
RPLBRANC EQU   RPLEXTD1
RPLNIB   EQU   RPLEXTD1
@NM00004 EQU   RPLEXTD1
RPLEXIT  EQU   RPLEXTD1
RPLNEXIT EQU   RPLEXTD1
RPLEXSCH EQU   RPLEXTD1
RPLDDDD  EQU   RPLRBAR+4
@NM00003 EQU   RPLRBAR+3
@NM00002 EQU   RPLAIXID
RPLAXPKP EQU   RPLAIXID
RPLAIXPC EQU   RPLRBAR
RPLRSV88 EQU   RPLOPT8
RPLUNCON EQU   RPLOPT8
RPLACTV  EQU   RPLOPT8
RPLSESS  EQU   RPLOPT8
RPLPEND  EQU   RPLOPT8
RPLODPRM EQU   RPLOPT8
RPLODACP EQU   RPLOPT8
RPLODACQ EQU   RPLOPT8
RPLRSV78 EQU   RPLOPT7
RPLRSV77 EQU   RPLOPT7
RPLRLSOP EQU   RPLOPT7
RPLTPOST EQU   RPLOPT7
RPLQOPT  EQU   RPLOPT7
RPLCNIMM EQU   RPLCNOPT
RPLCNANY EQU   RPLCNOPT
RPLCNALL EQU   RPLCNOPT
RPLRSV68 EQU   RPLOPT6
RPLRSV67 EQU   RPLOPT6
RPLLOCK  EQU   RPLOPT6
RPLNCOND EQU   RPLOPT6
RPLCOND  EQU   RPLOPT6
RPLEOT   EQU   RPLUNTYP
RPLEOM   EQU   RPLUNTYP
RPLEOB   EQU   RPLUNTYP
RPLWROPT EQU   RPLOPT5
RPLNODE  EQU   RPLOPT5
RPLERACE EQU   RPLWRTYP
RPLEAU   EQU   RPLWRTYP
RPLNERAS EQU   RPLWRTYP
RPLPSOPT EQU   RPLOPT5
RPLSSNIN EQU   RPLOPT5
RPLDLGIN EQU   RPLOPT5
RPLBUFL  EQU   RPLCOMN+52
RPLRLEN  EQU   RPLCOMN+48
RPLCHAIN EQU   RPLNXTRP
RPLOPT4  EQU   RPLOPTCD+3
RPLALIGN EQU   RPLOPT3
RPLFMT   EQU   RPLOPT3
RPLFLD   EQU   RPLOPT3
RPLVFY   EQU   RPLOPT3
RPLBLK   EQU   RPLOPT3
RPLSFORM EQU   RPLOPT3
RPLEODS  EQU   RPLOPT3
RPLNSP   EQU   RPLOPT2
RPLUPD   EQU   RPLOPT2
@NM00001 EQU   RPLOPT2
RPLLRD   EQU   RPLOPT2
RPLBWD   EQU   RPLOPT2
RPLCNV   EQU   RPLOPT2
RPLADD   EQU   RPLADR
RPLKEY   EQU   RPLOPT2
RPLECBIN EQU   RPLECBSW
RPLGEN   EQU   RPLOPT1
RPLKGE   EQU   RPLOPT1
RPLASY   EQU   RPLOPT1
RPLSKP   EQU   RPLOPT1
RPLSEQ   EQU   RPLOPT1
RPLDIR   EQU   RPLOPT1
RPLLOC   EQU   RPLOPT1
RPLDAF   EQU   RPLARG+2
RPLSAF   EQU   RPLARG
RPLAREA  EQU   RPLCOMN+32
RPLTCBPT EQU   RPLCOMN+28
RPLDACB  EQU   RPLCOMN+24
RPLCCHAR EQU   RPLCOMN+20
RPLSTRID EQU   RPLCOMN+18
RPLKEYL  EQU   RPLKEYLE
RPLRDSOH EQU   RPLFDB3
RPLRLG   EQU   RPLFDB3
RPLLGFRC EQU   RPLFDB3
RPLREOT  EQU   RPLFDB3
RPLREOM  EQU   RPLFDB3
RPLREOB  EQU   RPLFDB3
RPLSV32  EQU   RPLFDB3
RPLUINPT EQU   RPLFDB3
RPLSTSAV EQU   RPLFDB2
RPLCUERR EQU   RPLFDB2
RPLDLGFL EQU   RPLFDB2
RPLIOERR EQU   RPLFDB2
RPLDVUNS EQU   RPLFDB2
RPLATND  EQU   RPLFDB2
RPLRVID  EQU   RPLFDB2
RPLERLK  EQU   RPLFDB2
RPLERREG EQU   RPLRTNCD
RPLSTAT  EQU   RPLFDBWD
RPLPOST  EQU   RPLECB
RPLWAIT  EQU   RPLECB
RPLPLHPT EQU   RPLCOMN+4
RPLLEN2  EQU   RPLLEN
RPLREQ   EQU   RPLIDWD+2
RPLSTYP  EQU   RPLIDWD+1
RPLID    EQU   RPLIDWD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00059 EQU   @EL00001
@RC00066 EQU   @EL00001
@RC00087 EQU   @EL00002
@RC00092 EQU   @RC00087
@ENDDATA EQU   *
         END   IEEAB400,(C'PLS1144',0701,78090)

         TITLE 'DISPLAY / TRACK COMMON PROCESSOR - BASE                *
                        '
IEECB800 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'IEECB800  78.053'                                 0001
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  LA    @04,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@04                                    0001
         LR    @10,@01                                             0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         LR    @01,@10                                             0001
         ST    @13,@SA00001+4                                      0001
         LR    @13,@12                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*   R14SAVE=R14;                    /* SAVE THE RETURN ADDRESS       */
         ST    R14,R14SAVE                                         0181
*   TRACESWS=TRACESWS&&TRACESWS;    /* ZERO THE TRACE SWITCHES       */
         XC    TRACESWS(32),TRACESWS                               0182
*   TRPF1TOP=ON;                    /* MARK FLAG FOR TOP PROC AS   0183
*                                      ENTERED                       */
         LA    @15,TRCURRSW                                        0183
         OI    TRPF1TOP(@15),B'10000000'                           0183
*   TRTITLE=TRTITLES;               /* MOVE TITLE 'TRCE' IN CORE   0184
*                                      BEFORE SWITCHES               */
         MVC   TRTITLE(4),@CC02938                                 0184
*   ABENDSW=OFF;                    /* ABEND NOT WANTED YET          */
         NI    ABENDSW,B'11111101'                                 0185
*   CALL SETESTAE;                                                 0186
         BAL   @14,SETESTAE                                        0186
*   IF CHVCD=TRCMD THEN             /* IS THIS A TRACK COMMAND       */
         CLI   CHVCD(CSCBPTR),X'C4'                                0187
         BNE   @RF00187                                            0187
*     DO;                           /* YES IT IS A TRACK COMMAND     */
*                                                                  0188
*       /*************************************************************/
*       /*                                                           */
*       /* SET UP LOWER LEVEL TRACK ESTAE. IF ESTAE FAILS THEN       */
*       /* CONTROL IS NOT RETURNED HERE BUT TO STAEFAIL WHICH THEN   */
*       /* RETURNS TO THE TOP PROC AT RETSYS. ABENDSW WILL BE ON SO  */
*       /* ABEND 102 IS ISSUED.                                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0189
*       CALL TRKESTAE;                                             0189
*                                                                  0189
         BAL   @14,TRKESTAE                                        0189
*       /*************************************************************/
*       /*                                                           */
*       /* DO TRACK PROCESSING. CONTROL IS PASSED HERE WHEN IT IS    */
*       /* TIME FOR THE NEXT TRACK UPDATE OR THE TRACKING IS TO BE   */
*       /* ENDED. IF THE DISPLAY IS TO STOP THEN CONTROL IS GIVEN TO */
*       /* LABEL ALLDONE IN THIS PROCEDURE. IF THE DISPLAY IS NOT    */
*       /* WANTED OR THE PREVIOUS DISPLAY IS NOT FINISHED, THEN      */
*       /* CONTROL IS GIVEN TO THE STATEMENT AFTER THE CALL.         */
*       /* PROCEDURE TRACK DETERMINES WHERE TO RETURN TO.            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0190
*AWAKE:                                                            0190
*       CALL TRACK;                                                0190
*                                                                  0190
AWAKE    BAL   @14,TRACK                                           0190
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE THE STIMER AND THEN DETERMINE IF THE DISPLAY SHOULD */
*       /* BE UPDATED.                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0191
*       R1=ADDR(CHPEND);            /* ADDR OF TIME INTERVAL         */
         LA    R1,CHPEND(,CSCBPTR)                                 0191
*       GEN REFS(TIMEPOP) FLOWS(ALLDONE) SETS(R0,R14,R15);         0192
*                                                                  0192
         STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE
*/********************************************************************/
*/*  IS AN UPDATE WANTED AT THIS TIME ?                              */
*/********************************************************************/
*                                                                  0193
*       IF TRKNOUP=ON THEN          /* ANY REASON NOT TO ISSUE     0193
*                                      DISPLAY ?                     */
         TM    TRKNOUP,B'00000100'                                 0193
         BNO   @RF00193                                            0193
*         CALL WAIT;                /* YES, DISPLAY SHOULD NOT BE  0194
*                                      UPDATED. CONTROL IS NOT     0194
*                                      RETURNED HERE BUT TO LABEL  0194
*                                      AWAKE IN THE TOP PROCEDURE    */
         BAL   @14,WAIT                                            0194
*       FIRSTRAK=OFF;               /* 1ST TRACK HAS BEEN PROCESSED  */
@RF00193 NI    FIRSTRAK,B'01111111'                                0195
*       CALL DISPLAY;               /* DO THE DISPLAY FOR THE TRACK
*                                      UPDATE                        */
         BAL   @14,DISPLAY                                         0196
*       CALL WAIT;                  /* ISSUE WAIT. CONTROL IS NEVER
*                                      RETURNED HERE BUT TO LABEL  0197
*                                      AWAKE.                        */
         BAL   @14,WAIT                                            0197
*     END;                                                         0198
*   ELSE                            /* DISPLAY COMMAND               */
*     CALL DISPLAY;                                                0199
*                                                                  0199
         B     @RC00187                                            0199
@RF00187 BAL   @14,DISPLAY                                         0199
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS CODE IS USED BY BOTH TRACK AND DISPLAY PROCESSING AS A   */
*   /* FINAL CLEANUP ROUTINE. CONTROL MAY BE RETURNED TO ALLDONE FROM*/
*   /* PROCEDURE TRACK. THE CSCB IS FREED VIA MGCR                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0200
*ALLDONE:                                                          0200
*   TRPF1ALD=ON;                    /* MARK FLAG FOR LABEL ALLDONE AS
*                                      ENTERED                       */
@RC00187 DS    0H                                                  0200
ALLDONE  LA    @15,TRCURRSW                                        0200
         OI    TRPF1ALD(@15),B'00010000'                           0200
*   R1=CSCBPTR;                     /* RESTORE CSCB ADDRESS          */
         LR    R1,CSCBPTR                                          0201
*   CHFC=ON;                        /* MARK TO FREE CSCB CORE        */
         OI    CHFC(CSCBPTR),B'00000010'                           0202
*   GEN SETS(R0,R1)(MGCR (1),CHAIN);/* CSCB FREED BY SVC 34          */
*                                                                  0203
         MGCR (1),CHAIN
*   /*****************************************************************/
*   /*                                                               */
*   /* CONTROL IS GIVEN HERE BY COMING FROM ALLDONE OR BY RETURNING  */
*   /* FROM STAEFAIL. IF AN ABEND IS WANTED, THEN ABENDSW=ON. I.E.   */
*   /* BECAUSE THE LOWER LEVEL TRACE ESTAE FAILED.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0204
*   RFY                                                            0204
*     R15 RSTD;                     /* RESTRICT RETURN CODE REGISTER */
*RETSYS:                                                           0205
*   TRPF1RET=ON;                    /* MARK FLAG FOR LABEL RETSYS AS
*                                      ENTERED                       */
RETSYS   LA    @10,TRCURRSW                                        0205
         OI    TRPF1RET(@10),B'00001000'                           0205
*   R14=R14SAVE;                    /* RESTORE THE RETURN ADDR       */
         L     R14,R14SAVE                                         0206
*   IF ABENDSW=ON THEN              /* IS AN ABEND WANTED?           */
         TM    ABENDSW,B'00000010'                                 0207
         BNO   @RF00207                                            0207
*     DO;                           /* YES                           */
*       TRPF2ABN=ON;                /* MARK FLAG FOR LABEL ABEND AS
*                                      ENTERED                       */
         OI    TRPF2ABN(@10),B'10000000'                           0209
*       RETURN TO ABEND;            /* YES, FREE CORE, ABEND         */
         L     @13,4(,@13)                                         0210
         L     @00,@SIZDATD                                        0210
         LR    @01,@12                                             0210
         FREEMAIN R,LV=(0),A=(1)
         LA    @14,ABEND                                           0210
         BR    @14                                                 0210
*     END;                                                         0211
*   ELSE                            /* NORMAL RETURN                 */
*     RETURN;                       /* RETURN TO SYSTEM              */
*ABEND:                             /* TRACK ESTAE FAILED            */
*   GEN SETS(R1) EXIT NOSEQFLOW(ABEND 102);/* USER ABEND 102         */
ABEND    ABEND 102
*   RFY                                                            0214
*    (R1,                                                          0214
*     R14,                                                         0214
*     R15) UNRSTD;                                                 0214
*                                                                  0215
*   /*****************************************************************/
*   /*                                                               */
*   /* END OF THE TOP PROCEDURE                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0215
*                                                                  0215
*/*********************************************************************
**               S E T E S T A E   P R O C E D U R E                  *
** ENTRY REASON - SET UP ESTAE ENVIRONMENT FOR DISPLAY AND TRACK CMDS *
** ENTRY FROM   - TOP PROCEDURE                                       *
** EXIT TO      - 1) PROCEDURE STAEFAIL (IF TRACK COMMAND AND THE     *
**                   ESTAE FAILED)                                    *
**                2) LABEL ALLDONE IN TOP PROCEDURE (IF DISPLAY CMD   *
**                   AND ESTAE FAILED)                                *
**                3) NORMAL RETURN TO TOP PROCEDURE (IF ESTAE WORKED) *
** FUNCTION     - 1) ESTABLISH CSCB ADDRESSIBILITY.                   *
**                2) HAVE AN ESTAE ENVIRONMENT CREATED BY IEECB860.   *
**                   A) PASS THE DATA AND BASE REGISTERS              *
**                   B) PASS THE CSCB ADDRESS AND RETURN ADDRESS      *
**                   C) PASS THE LENGTH AND NAME OF COMMAND BEING     *
**                      PROCESSED                                     *
**                   D) LOAD THE ESTAE CREATION MODULE - IEECB860     *
**                   E) PASS CONTROL TO IEECB860 TO INVOKE ESTAE      *
**                      CREATION                                      *
**                3) RESTORE THE BASE REGISTERS AND CSCB POINTER      *
**                4) SEE IF ESTAE CREATION SUCCESSFUL                 *
**                   A) ESTAE SETUP FAILED                            *
**                      1) DELETE IEECB860                            *
**                      2) FOR A TRACK COMMAND                        *
**                         A) INITIALIZE FOR STAEFAIL PROCEDURE       *
**                         B) CALL STAEFAIL WHO RETURNS TO THE TOP    *
**                            PROCEDURE AND THEN TO THE SYSTEM        *
**                      3) FOR A DISPLAY COMMAND                      *
**                         A) RETURN TO LABEL ALLDONE IN THE TOP PROC *
**                   B) ESTAE SETUP WORKED                            *
**                      1) ZERO PARM LIST                             *
**                      2) DELETE IEECB860                            *
**                      3) RETURN TO THE TOP PROC                     *
** NOTE         - CONTROL IS NEVER RETURNED HERE IF PROCEDURE STAEFAIL*
**                IS CALLED                                           *
**********************************************************************/
*                                                                  0215
*SETESTAE:                                                         0215
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0215
@EL00001 L     @13,4(,@13)                                         0215
@EF00001 L     @00,@SIZDATD                                        0215
         LR    @01,@12                                             0215
         FREEMAIN R,LV=(0),A=(1)
@ER00001 BR    @14                                                 0215
SETESTAE DS    0H                                                  0216
*   RFY                                                            0216
*    (R1,                                                          0216
*     R4,                                                          0216
*     R11,                                                         0216
*     R12,                                                         0216
*     R14) RSTD;                                                   0216
*   SETESAVE=R14;                   /* SAVE RETURN TO TOP PROC ADDR  */
         ST    R14,SETESAVE                                        0217
*   TRPF1SET=ON;                    /* MARK FLAG FOR SETESTAE PROC AS
*                                      ENTERED                       */
         LA    @15,TRCURRSW                                        0218
         OI    TRPF1SET(@15),B'01000000'                           0218
*   CSCBPTR=R1;                     /* ESTABLISH CSCB ADDRESSABILITY */
         LR    CSCBPTR,R1                                          0219
*   REGDATA=R12;                    /* SAVE DATA REG                 */
         LA    @15,STAELIST                                        0220
         ST    R12,REGDATA(,@15)                                   0220
*   REGCODE1=R4;                    /* SAVE BASE REG         @ZA00073*/
         ST    R4,REGCODE1(,@15)                                   0221
*   REGCODE2=R11;                   /* SAVE BASE REG         @ZA00073*/
         ST    R11,REGCODE2(,@15)                                  0222
*   CSCBPASS=CSCBPTR;               /* PUT CSCB ADDRESS IN PARM LIST */
         ST    CSCBPTR,CSCBPASS(,@15)                              0223
*   RFY                                                            0224
*    (R11,                                                         0224
*     R12) UNRSTD;                                                 0224
*   IF CHVCD=TRCMD THEN             /* IS THIS FOR A TRACK COMMAND?  */
         CLI   CHVCD(CSCBPTR),X'C4'                                0225
         BNE   @RF00225                                            0225
*     COMMAND=ADDR(TCOMM);          /* YES, ADDR AND LENGTH OF TRACK */
         LA    @10,TCOMM                                           0226
         ST    @10,COMMAND(,@15)                                   0226
*   ELSE                                                           0227
*     COMMAND=ADDR(DCOMM);          /* NO, ADDR AND LENGTH OF DISPLAY*/
         B     @RC00225                                            0227
@RF00225 LA    @15,STAELIST                                        0227
         LA    @10,DCOMM                                           0227
         ST    @10,COMMAND(,@15)                                   0227
*   GEN SETS(R0,R1)(LOAD EP=IEECB860);/* LOAD ESTAE CREATION MOD     */
@RC00225 DS    0H                                                  0228
         LOAD EP=IEECB860
*   RESPECIFY                                                      0229
*    (R0,                                                          0229
*     R15) RESTRICTED;                                             0229
*   R15=R0;                         /* PUT ESTAE ENTRY ADDRESS IN R15*/
         LR    R15,R0                                              0230
*   R1=ADDR(STAELIST);              /* GET ADDRESS OF STAELIST       */
         LA    R1,STAELIST                                         0231
*   RESPECIFY                                                      0232
*     R0 UNRESTRICTED;                                             0232
*                                                                  0232
*   /*****************************************************************/
*   /*                                                               */
*   /* 2) SET UP ESTAE ENVIRONMENT                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   GEN SETS(R14) REFS(R15)(BALR R14,R15);/* ESTABLISH ESTAE       0233
*                                      ENVIRONMENT                   */
         BALR R14,R15
*   RFY                                                            0234
*    (R11,                                                         0234
*     R12) RSTD;                                                   0234
*   R12=R1->REGDATA;                /* RESTORE DATA REG              */
         L     R12,REGDATA(,R1)                                    0235
*   R4=REGCODE1;                    /* RESTORE SECONDARY BASE REG  0236
*                                                            @ZA00073*/
         LA    @10,STAELIST                                        0236
         L     R4,REGCODE1(,@10)                                   0236
*   R11=REGCODE2;                   /* RESTORE BASE REG      @ZA00073*/
         L     R11,REGCODE2(,@10)                                  0237
*   CSCBPTR=CSCBPASS;               /* RESTORE CSCB BASE REG         */
*                                                                  0238
         L     CSCBPTR,CSCBPASS(,@10)                              0238
*   /*****************************************************************/
*   /*                                                               */
*   /* 5) ESTAE ENVIRONMENT SET UP OK ?                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0239
*   IF R15^=ZERO THEN               /* BAD RETURN CODE FROM ESTAE?   */
         LTR   R15,R15                                             0239
         BZ    @RF00239                                            0239
*     DO;                           /* YES, REQUEST SVC34 TO FREE  0240
*                                      CSCB, RETURN                  */
*       RESPECIFY                                                  0241
*        (R15) UNRESTRICTED;                                       0241
*       GEN SETS(R0)(DELETE EP=IEECB860);                          0242
         DELETE EP=IEECB860
*       IF CHVCD=TRCMD THEN         /* IS THIS A TRACK CMD?  @YM4795P*/
         CLI   CHVCD(CSCBPTR),X'C4'                                0243
         BNE   @RF00243                                            0243
*         DO;                       /* YES,ZERO OUT REG 7 AND      0244
*                                                            @YM4795P*/
*           HAVESDWA=OFF;           /* FOR STEAFAIL ROUTINE  @YM4795P*/
         NI    HAVESDWA,B'11101111'                                0245
*           CALL STAEFAIL;          /* FOR CLEAN EXIT. CONTROL IS  0246
*                                      NEVER RETURNED HERE BUT TO THE
*                                      TOP PROCEDURE WHICH THEN    0246
*                                      RETURNS CONTROL TO THE SYSTEM */
         BAL   @14,STAEFAIL                                        0246
*         END;                      /*                       @YM4795P*/
*       ELSE                        /*                       @YM4795P*/
*         RETURN TO ALLDONE;        /* RETURN TOP PROC               */
         B     @RC00243                                            0248
@RF00243 LA    @14,ALLDONE                                         0248
@EL00002 DS    0H                                                  0248
@EF00002 DS    0H                                                  0248
@ER00002 BR    @14                                                 0248
*     END;                                                         0249
@RC00243 DS    0H                                                  0250
*   PARMLIST=PARMLIST&&PARMLIST;    /* INITIALIZE IEECB801   @ZA00055
*                                      PARAMETER LIST        @ZA00055*/
@RF00239 XC    PARMLIST(17),PARMLIST                               0250
*   CSCBADDR=CSCBPTR;               /* SAVE CSCB ADDR IN PARMLIST    */
         ST    CSCBPTR,CSCBADDR                                    0251
*   GEN SETS(R0)(DELETE EP=IEECB860);                              0252
         DELETE EP=IEECB860
*   R14=SETESAVE;                   /* RESTORE RETURN ADDR TO TOP    */
         L     R14,SETESAVE                                        0253
*   RFY                                                            0254
*    (R1,                                                          0254
*     R4,                                                          0254
*     R11,                                                         0254
*     R12,                                                         0254
*     R14) UNRSTD;                                                 0254
*   END SETESTAE;                   /* RETURN TO TOP PROC            */
         B     @EL00002                                            0255
*                                                                  0256
*/*********************************************************************
**               T R K E S T A E   P R O C E D U R E                  *
** ENTRY REASON - TRACK CMD ISSUED SO SET UP LOWER LEVEL ESTAE        *
** ENTRY FROM   - TOP PROCEDURE                                       *
** EXIT  TO     - STAEFAIL PROCEDURE (IF LOWER LEVEL ESTAE FAILED)    *
**                NORMAL RETURN TO TOP PROCEDURE (IF ESTAE WORKED)    *
** FUNCTION     - 1) A LOWER LEVEL ESTAE ENVIRONMENT IS CREATED FOR   *
**                   THE TRACK CMD FOR CLEANUP PURPOSES. AN ESTAE IS  *
**                   ISSUED SPECIFYING THAT ROUTINE 'STAEXIT' SHOULD  *
**                   GET CONTROL WITH ADDRESSABILITY TO 'STAELIST' IF *
**                   AN UNPREDICTABLE ERROR OCCURS.                   *
**                2) IF ESTAE WAS NOT SUCCESSFULLY CREATED THEN       *
**                   A) INITIALIZE FOR STAEFAIL PROCEDURE             *
**                   B) CALL STAEFAIL WHICH RETURNS TO THE TOP PROC   *
**                      AT LABEL RETSYS WHICH GIVES CONTROL TO LABEL  *
**                      ABEND WHICH ISSUES ABEND 102                  *
**                3) IF ESTAE WAS SUCCESSFUL THEN                     *
**                   A) TURN ON FLAG 'FIRSTRAK' TO INDICATE THAT THIS *
**                      IS THE FIRST TIME THROUGH THIS CODE FOR THIS  *
**                      TRACK COMMAND.                                *
**                   B) RETURN TO THE TOP PROCEDURE                   *
**********************************************************************/
*                                                                  0256
*TRKESTAE:                                                         0256
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0256
TRKESTAE DS    0H                                                  0257
*   RFY                                                            0257
*    (R1,                                                          0257
*     R8,                                                          0257
*     R9,                                                          0257
*     R14) RSTD;                                                   0257
*   TRKESAVE=R14;                   /* SAVE RETURN ADDR TO TOP PROC  */
         ST    R14,TRKESAVE                                        0258
*   RFY                                                            0259
*     R14 UNRSTD;                                                  0259
*   TRPF1TES=ON;                    /* MARK FLAG FOR TRKESTAE PROC AS
*                                      ENTERED                       */
         LA    @10,TRCURRSW                                        0260
         OI    TRPF1TES(@10),B'00100000'                           0260
*   ESTAELST=ESTAELST&&ESTAELST;    /* ESTAE INTERFACE               */
         XC    ESTAELST(24),ESTAELST                               0261
*   SACBADDR=ZERO;                  /* ZERO THESE ADDR FOR ESTAE     */
         LA    @10,STAELIST                                        0262
         SLR   @00,@00                                             0262
         ST    @00,SACBADDR(,@10)                                  0262
*   R1=ADDR(ESTAELST);              /* REQUIRED FOR ESTAE MACRO      */
         LA    R1,ESTAELST                                         0263
*   R8=ADDR(STAEXIT);               /* THIS TASK'S STAE RTN ADDR     */
         LA    R8,STAEXIT                                          0264
*   R9=ADDR(STAELIST);              /* INPUT TO THIS TASK'S STAE RTN */
         LR    R9,@10                                              0265
*   GEN SETS(R0,R1,R8) REFS(R3,R9);                                0266
         ESTAE (8),RECORD=YES,PARAM=(9),MF=(E,(1))
*   RFY                                                            0267
*    (R1,                                                          0267
*     R8,                                                          0267
*     R9) UNRSTD;                                                  0267
*   RESPECIFY                                                      0268
*    (R15) RESTRICTED;                                             0268
*   IF R15^=ZERO THEN               /* SUCCESSFYLLY CREATED?         */
         LTR   R15,R15                                             0269
         BZ    @RF00269                                            0269
*     DO;                           /* ESTAE FAILED          @YM4795P*/
*       HAVESDWA=OFF;               /* TURN SDWA BIT OFF     @YM4795P*/
*       ABENDSW=ON;                 /* ABEND 102 IS WANTED           */
         OI    ABENDSW,B'00000010'                                 0272
         NI    HAVESDWA,B'11101111'                                0272
*       CALL STAEFAIL;              /* FREE CSCB,CLEAR SACB. CONTROL
*                                      IS NOT RETURNED HERE BUT TO 0273
*                                      THE TOP PROCEDURE AND THEN  0273
*                                      ABEND 102 IS ISSUED.          */
         BAL   @14,STAEFAIL                                        0273
*     END;                          /* IEECB860 WILL ISSUE COMMAND 0274
*                                      FAIL MESSAGE                  */
*   RESPECIFY                                                      0275
*     R15 UNRSTD;                   /*                       @YM4795P*/
@RF00269 DS    0H                                                  0276
*   FIRSTRAK=ON;                    /* SWITCH FOR DCMADEND CHECK   0276
*                                                            @YM01918*/
         OI    FIRSTRAK,B'10000000'                                0276
*   RFY                                                            0277
*     R14 RSTD;                                                    0277
*   R14=TRKESAVE;                   /* RESTORE RETURN ADDR TO TOP  0278
*                                      PROC                          */
         L     R14,TRKESAVE                                        0278
*   RFY                                                            0279
*     R14 UNRSTD;                                                  0279
*   END TRKESTAE;                   /* RETURN TO TOP PROC            */
@EL00003 DS    0H                                                  0280
@EF00003 DS    0H                                                  0280
@ER00003 BR    @14                                                 0280
*                                                                  0281
*/*********************************************************************
**                    T R A C K    P R O C E D U R E                  *
** ENTRY REASON - AN ECB WAS POSTED OR THIS IS THE FIRST TIME DISPLAY *
**                SHOULD BE ISSUED                                    *
** ENTRY FROM   - TOP PROCEDURE                                       *
** EXIT TO      - 1) NORMAL RETURN TO THE TOP PROCEDURE.              *
**                2) LABEL ALLDONE IN TOP PROC (IF THE ECB WAS POSTED *
**                   BY DIDOCS).                                      *
**                3) LABEL ALLDONE IF THE ECB WAS POSTED BY STOP TRACK*
**                   OR IF THE TRACK OPTIONS ARE ZERO OR IF THE       *
**                   UPDATE TIME INTERVAL IS ZERO)                    *
** FUNCTION     - 1) THE CMS AND LOCAL  LOCKS  ARE OBTAINED TO INSURE *
**                   SERIALIZATION OF THE TRACK TERMINATION BITS IN   *
**                   THE SACB AND THE POSTING OF THE ECB IN THE CSCB  *
**                2) OBTAIN THE ADDRESS OF THE SACB (SCREEN AREA      *
**                   CONTROL BLOCK) WHICH DEFINES THE AREA INTO WHICH *
**                   THE TRACK DISPLAY SHOULD BE PLACED.              *
**                3) IF THE TRACK ECB IN THE CSCB HAS BEEN POSTED BY  *
**                   CONSOLE CLOSE OR BY DIDOCS: COMPLETION CODE =0   *
**                   A) THE LOCKS ARE RELEASED                        *
**                   B) RETURN TO LABEL ALLDONE IN THE TOP PROCEDURE  *
**                4) IF THE TRACK ECB IN THE CSCB HAS BEEN POSTED AS  *
**                   A RESULT OF A STOPTR COMMAND: COMPLETION CODE=4  *
**                   OR IF THE TRACK OPTIONS ARE ZERO OR IF THE TIME  *
**                   INTERVAL UPDATE IS ZERO THEN                     *
**                   A) CLEAR THE TRACK BITS, TIME INTERVAL AND THE   *
**                      ADDRESS OF THE TRACK ECB IN THE SACB          *
**                   B) RELEASE THE LOCKS                             *
**                   C) RETURN TO LABEL ALLDONE IN THE TOP PROCEDURE  *
**                5) MOVE THE MOST RECENT TRACK OPTIONS AND THE TIME  *
**                   INTERVAL FROM THE SACB TO THE CSCB               *
**                6) IF IN HOLD MODE THEN                             *
**                   A) RELEASE THE LOCKS AND SET TRKNOUP SWITCH      *
**                   B) NORMAL RETURN TO THE TOP PROCEDURE            *
**                7) IF THIS IS NOT THE FIRST TRACK DISPLAY AND DIDOCS*
**                   HAS NOT FINISHED WRITING THE SCREEN YET AND THE  *
**                   SCREEN AREA IS NOT FULL YET THEN                 *
**                   A) RELEASE THE LOCKS AND SET TRKNOUP SWITCH      *
**                   B) BUILD MSG 'IEE920I NO TR UPDATE AT HH.MM.SS'  *
**                   C) CALL IEECB801 TO ISSUE THE MESSAGE            *
**                   D) NORMAL RETURN TO THE TOP PROCEDURE            *
**                8) RELEASE THE LOCKS AND RETURN                     *
** NOTE         - FUNCTION (4) MENTIONED ABOVE CHECKS TO SEE IF THERE *
**                IS ANY REASON WHY THE TRACK SHOULD STOP AND IF      *
**                THERE IS THEN TRACK PROCESSING IS STOPPED.          *
**********************************************************************/
*                                                                  0281
*TRACK:                                                            0281
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0281
TRACK    DS    0H                                                  0282
*   RFY                                                            0282
*     R14 RSTD;                                                    0282
*   TRACKSAV=R14;                   /* SAVE RETURN ADDR TO TOP PROC  */
         ST    R14,TRACKSAV                                        0283
*   RFY                                                            0284
*     R14 UNRSTD;                                                  0284
*   TRCF1TRI=ON;                    /* MARK TRACK PROC AS IN       0285
*                                      PROCESSING                    */
*   TRCF1TRE=ON;                    /* MARK TRACK PROC AS ENTERED    */
         LA    @10,TRCURRSW                                        0286
         OI    TRCF1TRI(@10),B'00110000'                           0286
*   TRKNOUP=OFF;                    /* UPDATE IS WANTED AT THIS TIME */
         NI    TRKNOUP,B'11111011'                                 0287
*   GEN SETS(LOCKSAVE,R6) REFS(R11,R12,R14);                       0288
*                                                                  0288
             STM     R11,R14,LOCKSAVE    SAVE REGISTERS ACROSS SETLOCK
             LR      R6,R12              SAVE DATA REGISTER
             SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                    X
               RELATED=(SACB,IEECB800(LOCKSOFF))
             SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                      X
               RELATED=(SACB,IEECB800(LOCKSOFF))
             LR      R12,R6              RESTORE DATA REGISTER
             LM      R11,R14,LOCKSAVE    RESTORE REGISTERS
*   /*****************************************************************/
*   /*                                                               */
*   /* THE CSCB POINTER MUST BE RESTORED FROM THE STAELIST EACH TIME */
*   /* THE TRACK PROCESSOR IS REACTIVATED.                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0289
*   CSCBPTR=CSCBPASS;               /* TO INSURE PROPER CSCB ADDRESS */
*                                                                  0289
         LA    @10,STAELIST                                        0289
         L     CSCBPTR,CSCBPASS(,@10)                              0289
*   /*****************************************************************/
*   /*                                                               */
*   /* 2) FIND THE SCREEN AREA CONTROL BLOCK                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0290
*   CALL FINDSACB;                  /* LOCATE TRACKS SACB    @YM4795P*/
*                                                                  0290
         BAL   @14,FINDSACB                                        0290
*   /*****************************************************************/
*   /*                                                               */
*   /* 3) ECB POSTED BY DIDOCS OR NO SACB FOUND ?                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0291
*   IF CHCECB=POSTED×SACBPTR=ZERO THEN/* WAS ECB POSTED BY DIDOCS OR
*                                      NO SACB FOUND                 */
         CLC   CHCECB(4,CSCBPTR),POSTED                            0291
         BE    @RT00291                                            0291
         LTR   SACBPTR,SACBPTR                                     0291
         BNZ   @RF00291                                            0291
@RT00291 DS    0H                                                  0292
*     DO;                           /* YES, RELEASE LOCKS, REQUEST 0292
*                                      SVC34 TO FREE CSCB AND RETURN */
*       CALL LOCKSOFF;              /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0293
*       TRCF1TRI=OFF;               /* MARK TRACK PROC AS CONTROL  0294
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0294
         NI    TRCF1TRI(@10),B'11011111'                           0294
*       RETURN TO ALLDONE;          /* FINISHED,RETURN TO ALLDONE IN
*                                      TOP PROCEDURE                 */
         LA    @14,ALLDONE                                         0295
@EL00004 DS    0H                                                  0295
@EF00004 DS    0H                                                  0295
@ER00004 BR    @14                                                 0295
*     END;                                                         0296
*                                                                  0296
*   /*****************************************************************/
*   /*                                                               */
*   /* 4) ECB POSTED BY STOP TRK OR ANY OTHER REASON TO STOP ?       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0297
*   IF CHCECB=PTPOSTED              /* WAS ECB POSTED BY STOPTR?     */
*       ×DCMATRCK=OFFBYTE           /* ANY TRACK OPTION      @ZA00073*/
*       ×DCMAUTME=OFFHALF THEN      /* TIME INTERVAL?        @ZA00073*/
@RF00291 CLC   CHCECB(4,CSCBPTR),PTPOSTED                          0297
         BE    @RT00297                                            0297
         CLI   DCMATRCK(SACBPTR),X'00'                             0297
         BE    @RT00297                                            0297
         LH    @10,DCMAUTME(,SACBPTR)                              0297
         LTR   @10,@10                                             0297
         BNZ   @RF00297                                            0297
@RT00297 DS    0H                                                  0298
*     DO;                           /* YES, CLEAR TRACK FIELDS IN  0298
*                                      SACB, RELEASE LOCKS, REQUEST
*                                      SVC34 TO FREE CSCB AND RETURN */
*       DCMADFLG=DCMADFLG&CLEAROPT; /* TURN ALL OFF BUT DIDOCS BIT   */
         NI    DCMADFLG(SACBPTR),X'20'                             0299
*       DCMATRCK=OFFBYTE;           /* TURN OFF TRACK OPTIONS        */
         MVI   DCMATRCK(SACBPTR),X'00'                             0300
*       DCMAUTME=OFFHALF;           /* CLEAR TRACK TIME INTERVAL     */
         SLR   @10,@10                                             0301
         STH   @10,DCMAUTME(,SACBPTR)                              0301
*       DCMATECB=CLEARECB;          /* CLEAR TRACK CANCEL ECB ADDR   */
         SLR   @10,@10                                             0302
         ST    @10,DCMATECB(,SACBPTR)                              0302
*       CALL LOCKSOFF;              /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0303
*       TRCF1TRI=OFF;               /* MARK TRACK PROC AS CONTROL  0304
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0304
         NI    TRCF1TRI(@10),B'11011111'                           0304
*       RETURN TO ALLDONE;          /* FINISHED,RETURN TO ALLDONE IN
*                                      TOP PROCEDURE                 */
         LA    @14,ALLDONE                                         0305
         BR    @14                                                 0305
*     END;                                                         0306
*   CHTRSTAT=DCMATRCK;              /* SAVE TRACK REQUEST INDICATORS */
@RF00297 MVC   CHTRSTAT(1,CSCBPTR),DCMATRCK(SACBPTR)               0307
*   CHPEND=DCMAUTME*ONEHUND;        /* SAVE TRACK TIME INTERVAL      */
         LH    @10,DCMAUTME(,SACBPTR)                              0308
         MH    @10,@CH00934                                        0308
         ST    @10,CHPEND(,CSCBPTR)                                0308
*   CHCECB=ZERO;                    /* ZERO OUT DIDOCS/PT/K D,U ECB
*                                                            @YM2779P*/
         SLR   @10,@10                                             0309
         ST    @10,CHCECB(,CSCBPTR)                                0309
*   STIMECB=ZERO;                   /* ZERO OUT STIMER ECB IN SACB 0310
*                                                            @YM2779P*/
         LA    @03,STAELIST                                        0310
         ST    @10,STIMECB(,@03)                                   0310
*/*********************************************************************
**     6) IN HOLD MODE?                                               *
**     7) NOT IN HOLD MODE, THE SACB FLAGS ARE NEXT INTERROGATED TO   *
**        SEE IF DIDOCS HAS FINISHED WRITING THE PREVIOUS TRACK       *
**        DISPLAY TO THE SCREEN. FIRSTRAK WILL BE ON IF THIS IS THE   *
**        FIRST DISPLAY AND THERE IS NO PREVIOUS DISPLAY. DCMADEND    *
**        WILL BE ON IF DIDOCS HAS FINISHED ITS I/O.                  *
**           IF NOT:                                                  *
**           1)  'IEE920I NO TR A UPDATE AT HH.MM.SS YY.DDD' WILL BE  *
**               ISSUED.                                              *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE920I NO TRACK UPDATE AT HH.MM.SS YY.DDD'     ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**********************************************************************/
*                                                                  0311
*   /*****************************************************************/
*   /*                                                               */
*   /* 6) IN HOLD MODE ?                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0311
*   IF DCMAHOLD=OFF THEN            /* IS TRACK DISPLAY IN HOLD MODE?*/
         TM    DCMAHOLD(SACBPTR),B'01000000'                       0311
         BNZ   @RF00311                                            0311
*     IF FIRSTRAK^=ON&              /* NO, IS THIS NOT FIRST TRACK &
*                                                            @YM01918*/
*         DCMADEND^=ON&             /* HAS DIDOCS NOT FINISHED?      */
*         DCMAFULL^=ON THEN         /* THE AREA IS NOT FULL  @YM2772P*/
         TM    FIRSTRAK,B'10000000'                                0312
         BO    @RF00312                                            0312
         TM    DCMADEND(SACBPTR),B'00101000'                       0312
         BNZ   @RF00312                                            0312
*       DO;                         /* RIGHT ON                      */
*         CALL LOCKSOFF;            /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0314
*         TRKNOUP=ON;               /* DON'T UPDATE THE DISPLAY      */
         OI    TRKNOUP,B'00000100'                                 0315
*         WTOBUF(ONE:NOUPLGTH)=NOUPDATE(ONE:NOUPLGTH);/* IEE920I     */
         SLR   @10,@10                                             0316
         IC    @10,NOUPLGTH                                        0316
         BCTR  @10,0                                               0316
         EX    @10,@SM03157                                        0316
*         WPLPTR=ADDR(CHSWT)+SIXTEEN;/* SET FOR TIME STAMP   @YM01918*/
         LA    WPLPTR,CHSWT(,CSCBPTR)                              0317
         AL    WPLPTR,@CF00963                                     0317
*         CALL TIMESNAP;            /* GO GET TIME STAMP             */
         BAL   @14,TIMESNAP                                        0318
*         NOUPFLAG=ON;              /* INDICATE IEE920I TO BE ISSUED */
         OI    NOUPFLAG,B'01000000'                                0319
*         CALL ISSUEMSG;            /* ISSUE NO TRK UPDATE MESSAGE   */
         BAL   @14,ISSUEMSG                                        0320
*       END;                                                       0321
*     ELSE                                                         0322
*       CALL LOCKSOFF;              /* RELEASE THE LOCKS             */
         B     @RC00312                                            0322
@RF00312 BAL   @14,LOCKSOFF                                        0322
*   ELSE                                                           0323
*     DO;                                                          0323
         B     @RC00311                                            0323
@RF00311 DS    0H                                                  0324
*       CALL LOCKSOFF;              /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0324
*       TRKNOUP=ON;                 /* DON'T UPDATE THE DISPLAY      */
         OI    TRKNOUP,B'00000100'                                 0325
*     END;                                                         0326
*   TRCF1TRI=OFF;                   /* MARK TRACK PROC AS CONTROL  0327
*                                      LEAVING                       */
@RC00311 LA    @10,TRCURRSW                                        0327
         NI    TRCF1TRI(@10),B'11011111'                           0327
*   RFY                                                            0328
*     R14 RSTD;                                                    0328
*   R14=TRACKSAV;                   /* RESTORE RETURN ADDR OF TOP  0329
*                                      PROC                          */
         L     R14,TRACKSAV                                        0329
*   RFY                                                            0330
*     R14 UNRSTD;                                                  0330
*   END TRACK;                      /* RETURN TO TOP PROC TO ISSUE 0331
*                                      DISPLAY                       */
         B     @EL00004                                            0331
*                                                                  0332
*/*********************************************************************
**                D I S P L A Y    P R O C E D U R E                  *
** ENTRY REASON - A DISPLAY COMMAND WAS ISSUED OR A TRACK COMMAND     *
**                WAS ISSUED OR A TRACK UPDATE IS WANTED NOW          *
** ENTRY FROM   - TOP PROCEDURE (TWO PLACES)                          *
**                   1) TRACK COMMAND ISSUED                          *
**                   2) DISPLAY COMMAND ISSUED                        *
** EXIT  TO     - NORMAL RETURN TO TOP PROCEDURE                      *
** FUNCTION     - THIS PROCEDURE CONTROLS THE LOGIC FLOW FOR DISPLAY  *
**                PROCESSING                                          *
**                1) ENQ SHR ON TO THE CSCB CHAIN AND DETERMINE THE   *
**                   NUMBER OF JOBS, INITIATORS AND TSO USERS         *
**                2) GET BUFFER AREA FOR LINKED LIST AND BUILD THE    *
**                   HEADER LINE.                                     *
**                3) IF BUFFER NOT GOTTEN THEN RETURN.                *
**                4) DETERMINE WHICH  OPTIONS WANTED AND BUILD THE    *
**                   APPROPRIATE LINES.                               *
**                5) DEQUEUE OFF THE CSCB CHAIN                       *
**                6) WRITE THE DISPLAY                                *
**                7) FREE THE BUFFER AREA                             *
**                8) RETURN TO THE TOP PROCEDURE                      *
** NOTE         - THE BUFFER AREA CONTAINS A LINKED LIST OF CONNECTING*
**                    MLWTOS. EACH GROUP WILL CONTAIN 10 LINES EXCEPT *
**                    FOR THE LAST ONE WHICH MAY CONTAIN 1-10 LINES.  *
**                    THE SIZE OF THE BUFFER IS DETERMINED BY THE     *
**                    NUMBER OF LINES NEEDED TO FINISH THE DISPLAY    *
**                    AND THE TYPE OF LINES IN THE DISPLAY. THE TOTAL *
**                    DISPLAY IS BUILT IN THE BUFFER AND THEN IT IS   *
**                    WRITTEN OUT. THIS WAS DONE SO THE CSCB CHAIN    *
**                    COULD BE DEQUEUED FROM WHILE IEECB801 IS        *
**                    ISSUING TPUTS.                                  *
**                WPLPTR POINTS TO THE NEXT AVAILABLE WPL UPON ENTRY  *
**                    TO ANY PROCEDURES CALLED BY DISPLAY OR THEIR    *
**                    INTERNAL PROCEDURES EXCEPT NEXTWPL PROC WHICH   *
**                    EXPECTS WPLPTR TO POINT TO THE CURRENT WPL.     *
**********************************************************************/
*                                                                  0332
*DISPLAY:                                                          0332
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0332
DISPLAY  DS    0H                                                  0333
*   RFY                                                            0333
*     R14 RSTD;                                                    0333
*   DISPSAVE=R14;                   /* SAVE RETURN ADDR TO TOP PROC  */
         ST    R14,DISPSAVE                                        0334
*   RFY                                                            0335
*     R14 UNRSTD;                                                  0335
*   TRCF3DPI=ON;                    /* MARK DISPLAY PROC AS IN     0336
*                                      PROCESSING                    */
*   TRCF3DPE=ON;                    /* MARK DISPLAY PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0337
         OI    TRCF3DPI(@10),B'00000011'                           0337
*   BUFPTR=ZERO;                    /* IF IT REMAINS ZERO THEN THE 0338
*                                      BUFFER COULD NOT BE GOTTEN  0338
*                                                            @ZA07770*/
*                                                                  0338
         SLR   @10,@10                                             0338
         ST    @10,BUFPTR                                          0338
*   /*****************************************************************/
*   /*                                                               */
*   /* 1) THE CSCB CHAIN IS ENQUEUED UPON AND THEN SCANNED AND A     */
*   /* COUNT OF THE NUMBER OF JOBS, INITIATORS AND TSO USERS IS KEPT.*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0339
*   CALL TYPECSCB;                                                 0339
*                                                                  0339
         BAL   @14,TYPECSCB                                        0339
*   /*****************************************************************/
*   /*                                                               */
*   /* 2) DO GETMAIN FOR THE NUMBER OF MLWTO LINES NEEDED. IF THE    */
*   /* CORE IS NOT AVAILIABLE THEN ISSUE A MESSAGE STATING SO. IF THE*/
*   /* CORE IS AVAILIABLE THEN BUILD THE HEADER LINE 'IEE102I        */
*   /* HH.MM.SS YY.DDD ACTIVITY'                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0340
*   CALL HEADERLN;                                                 0340
*                                                                  0340
         BAL   @14,HEADERLN                                        0340
*   /*****************************************************************/
*   /*                                                               */
*   /* 3) BUFFER AREA GOTTEN ?                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0341
*   IF BUFPTR^=ZERO THEN                                           0341
         L     @10,BUFPTR                                          0341
         LTR   @10,@10                                             0341
         BZ    @RF00341                                            0341
*     DO;                           /* BUFFER GOTTEN                 */
*                                                                  0342
*       /*************************************************************/
*       /*                                                           */
*       /* 4) IF 'JOBS','JOBS,LIST','A' OR 'A,LIST' THEN BUILD THE   */
*       /* JOB INITIATOR LINE '00000 JOBS 00000 INITIATORS'          */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0343
*       IF TASKCSCB->CHJOBS=ON×     /* JOBS OR JOBS,LIST             */
*           TASKCSCB->CHJOBSL=ON THEN/* OPTION SPECIFIED?            */
         L     @10,TASKCSCB                                        0343
         TM    CHJOBS(@10),B'11000000'                             0343
         BZ    @RF00343                                            0343
*         DO;                       /* YES                           */
*           CALL JOBLINE;           /* BUILD JOB-INITIATOR LINE      */
         BAL   @14,JOBLINE                                         0345
*           IF TASKCSCB->CHJOBSL=ON&/* JOBS,LIST WANTED AND          */
*               JOBNUM^=ZERO THEN   /* THERE WAS A JOB CSCB          */
         L     @10,TASKCSCB                                        0346
         TM    CHJOBSL(@10),B'01000000'                            0346
         BNO   @RF00346                                            0346
         LH    @10,JOBNUM                                          0346
         LTR   @10,@10                                             0346
         BZ    @RF00346                                            0346
*             CALL LISTJOBS;        /* BUILD MLWTO LINES TO LIST JOB */
         BAL   @14,LISTJOBS                                        0347
*         END;                                                     0348
*                                                                  0348
@RF00346 DS    0H                                                  0349
*       /*************************************************************/
*       /*                                                           */
*       /* IF 'TS','TS,LIST','A' OR 'A,LIST' THEN BUILD THE TSO LINE */
*       /* AND THE VTAM TSO USER LINE                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0349
*       IF TASKCSCB->CHTS=ON×       /* TS OPTION OR                  */
*           TASKCSCB->CHTSL=ON THEN /* TS,LIST OPTION SPECIFIED      */
@RF00343 L     @10,TASKCSCB                                        0349
         TM    CHTS(@10),B'00001100'                               0349
         BZ    @RF00349                                            0349
*         DO;                       /* YES                           */
*           CALL TSVTMLIN;          /* BUILD TSO LINE AND VTAM TSO 0351
*                                      LINE                  @Z40DQSS*/
         BAL   @14,TSVTMLIN                                        0351
*           IF TASKCSCB->CHTSL=ON&  /* TS,LIST WANTED AND            */
*               TSNUM^=ZERO THEN    /* THERE ARE TSO USERS?          */
         L     @10,TASKCSCB                                        0352
         TM    CHTSL(@10),B'00000100'                              0352
         BNO   @RF00352                                            0352
         LH    @10,TSNUM                                           0352
         LTR   @10,@10                                             0352
         BZ    @RF00352                                            0352
*             CALL LISTSO;          /* YES, LIST TSO USERS           */
         BAL   @14,LISTSO                                          0353
*         END;                                                     0354
@RF00352 DS    0H                                                  0355
*       CALL LASTLINE;              /* MARK LAST LINE AS END OF MLWTO*/
@RF00349 BAL   @14,LASTLINE                                        0355
*       CALL DQCSCB;                /* DEQ FROM THE CSCB CHAIN     0356
*                                                            @ZA07770*/
         BAL   @14,DQCSCB                                          0356
*       CALL CALL801;               /* ISSUE THE MLWTOS      @ZA07770*/
         BAL   @14,CALL801                                         0357
*       CALL FREEBUF;               /* FREE THE BUFFER       @ZA07770*/
         BAL   @14,FREEBUF                                         0358
*     END;                                                         0359
*   TRCF3DPI=OFF;                   /* MARK DISPLAY PROC AS CONTROL
*                                      LEAVING                       */
@RF00341 LA    @10,TRCURRSW                                        0360
         NI    TRCF3DPI(@10),B'11111101'                           0360
*   RFY                                                            0361
*     R14 RSTD;                                                    0361
*   R14=DISPSAVE;                   /* RESTORE RETURN ADDR TO TOP  0362
*                                      PROC                          */
         L     R14,DISPSAVE                                        0362
*   RFY                                                            0363
*     R14 UNRSTD;                                                  0363
*   END DISPLAY;                    /* RETURN TO TOP PROC            */
@EL00005 DS    0H                                                  0364
@EF00005 DS    0H                                                  0364
@ER00005 BR    @14                                                 0364
*                                                                  0365
*/*********************************************************************
**                T Y P E C S C B   P R O C E D U R E                 *
** ENTRY REASON - DETERMINE NUMBER OF JOBS, INITIATORS AND TSO CSCBS  *
**                ON THE CHAIN. NUMBERS USED IN DETERMINING THE SIZE  *
**                OF THE BUFFER AREA AND ARE PUT INTO THE DISPLAY LINE*
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT  TO     - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) ENQUEUE SHARED ON THE CSCB CHAIN                 *
**                2) SCAN CSCB CHAIN AND DETERMINE THE NUMBER OF      *
**                   JOBS, INITIATORS AND TSO USERS                   *
**                   A) IF THE OPTION WAS 'JOBS','JOBS,LIST','A' OR   *
**                      'A,LIST' THEN                                 *
**                      1) INCREMENT JOB COUNTER FOR EACH JOB OR TASK *
**                         CSCB FOUND.                                *
**                      2) INCREMENT INIT COUNTER FOR EACH INITIATOR  *
**                         CSCB FOUND.                                *
**                   B) IF THE OPTION WAS 'TS','TS,LIST','A' OR       *
**                      'A,LIST' THEN                                 *
**                      1) INCREMENT TS COUNTER FOR EACH TSO USER     *
**                         CSCB FOUND.                                *
**********************************************************************/
*                                                                  0365
*   RFY                                                            0365
*    (R1,                                                          0365
*     R14) RSTD;                                                   0365
*TYPECSCB:                                                         0366
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0366
TYPECSCB DS    0H                                                  0367
*   TYPESAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0367
*                                      PROC                          */
         ST    R14,TYPESAVE                                        0367
*   RFY                                                            0368
*     R14 UNRSTD;                                                  0368
*   TRCF4TCI=ON;                    /* MARK TYPECSCB PROC AS IN    0369
*                                      PROCESSING                    */
*   TRCF4TCE=ON;                    /* MARK TYPECSCB PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0370
         OI    TRCF4TCI(@10),B'00110000'                           0370
*   ENQDEQL(ONE:ELEN)=EENQ(ONE:ELEN);/* BUILD ENQ LIST               */
         LH    @10,ELEN                                            0371
         BCTR  @10,0                                               0371
         EX    @10,@SM03159                                        0371
*   R1=ADDR(ENQDEQL);               /* WORKAREA ADDRESSED BY REG 1   */
         LA    R1,ENQDEQL                                          0372
*   GEN(ENQ MF=(E,(1)));                                           0373
         ENQ MF=(E,(1))
*   RFY                                                            0374
*     R1 UNRSTD;                                                   0374
*   CSCBPTR=BACHN;                  /* GET ADDR OF 1ST CSCB FROM   0375
*                                      BASEA                         */
         L     @10,CVTPTR                                          0375
         L     @10,CVTMSER(,@10)                                   0375
         L     CSCBPTR,BACHN(,@10)                                 0375
*   JOBNUM=ZERO;                    /* INIT ACTIVE JOBS & TASK     0376
*                                      COUNTER                       */
         SLR   @10,@10                                             0376
         STH   @10,JOBNUM                                          0376
*   INITNUM=ZERO;                   /* INIT ACTIVE INIT COUNTER      */
         STH   @10,INITNUM                                         0377
*   TSNUM=ZERO;                     /* INIT ACTIVE TS USERS COUNTER  */
         STH   @10,TSNUM                                           0378
*   TASKCSCB=CSCBPASS;              /* INIT THIS TASK'S CSCB BASE    */
         LA    @10,STAELIST                                        0379
         L     @10,CSCBPASS(,@10)                                  0379
         ST    @10,TASKCSCB                                        0379
*   DO WHILE CSCBPTR^=ZERO;         /* LOOP THRU ENTIRE CSCB CHAIN   */
         B     @DE00380                                            0380
@DL00380 DS    0H                                                  0381
*     IF TASKCSCB->CHJOBS=ON×       /* JOBS OR JOBS,LIST             */
*         TASKCSCB->CHJOBSL=ON THEN /* OPTION SPECIFIED?             */
         L     @10,TASKCSCB                                        0381
         TM    CHJOBS(@10),B'11000000'                             0381
         BZ    @RF00381                                            0381
*       DO;                                                        0382
*         IF CHTRKID='02'X THEN     /* YES, THIS JOB OR TASK CSCB    */
         CLI   CHTRKID(CSCBPTR),X'02'                              0383
         BNE   @RF00383                                            0383
*           JOBNUM=JOBNUM+ONE;      /* YES, INCREMENT COUNTER        */
         LH    @10,JOBNUM                                          0384
         LA    @10,1(,@10)                                         0384
         STH   @10,JOBNUM                                          0384
*         IF CHTRKID='03'X THEN     /* IS THIS INIT CSCB?            */
@RF00383 CLI   CHTRKID(CSCBPTR),X'03'                              0385
         BNE   @RF00385                                            0385
*           INITNUM=INITNUM+ONE;    /* YES,INCREMENT COUNTER         */
         LH    @10,INITNUM                                         0386
         LA    @10,1(,@10)                                         0386
         STH   @10,INITNUM                                         0386
*       END;                                                       0387
@RF00385 DS    0H                                                  0388
*     IF TASKCSCB->CHTS=ON×         /* TS OR TS,LIST                 */
*         TASKCSCB->CHTSL=ON THEN   /* OPTION SPECIFIED?             */
@RF00381 L     @10,TASKCSCB                                        0388
         TM    CHTS(@10),B'00001100'                               0388
         BZ    @RF00388                                            0388
*       IF CHTRKID='01'X THEN       /* YES, IS THIS TSO USER         */
         CLI   CHTRKID(CSCBPTR),X'01'                              0389
         BNE   @RF00389                                            0389
*         TSNUM=TSNUM+ONE;          /* YES, INCREMENT COUNTER        */
         LH    @10,TSNUM                                           0390
         LA    @10,1(,@10)                                         0390
         STH   @10,TSNUM                                           0390
*     CSCBPTR=CHPTR;                /* POINTER TO NEXT CSCB          */
@RF00389 DS    0H                                                  0391
@RF00388 L     CSCBPTR,CHPTR(,CSCBPTR)                             0391
*   END;                            /* WHEN 0, LAST ONE              */
@DE00380 LTR   CSCBPTR,CSCBPTR                                     0392
         BNZ   @DL00380                                            0392
*   TRCF4TCI=OFF;                   /* MARK TYPECSCB PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0393
         NI    TRCF4TCI(@10),B'11011111'                           0393
*   RFY                                                            0394
*     R14 RSTD;                                                    0394
*   R14=TYPESAVE;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                          */
         L     R14,TYPESAVE                                        0395
*   RFY                                                            0396
*     R14 UNRSTD;                                                  0396
*   END TYPECSCB;                                                  0397
@EL00006 DS    0H                                                  0397
@EF00006 DS    0H                                                  0397
@ER00006 BR    @14                                                 0397
*                                                                  0398
*/*********************************************************************
**               H E A D E R L N    P R O C E D U R E                 *
** ENTRY REASON - GET BUFFER AREA AND BUILD THE HEADER LINE.          *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT  TO     - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) GET THE BUFFER AREA TO BUILD THE MLWTO LIST      *
**                   A) IF THE GETMAIN FAILED THEN                    *
**                      1) BUILD HEADER LINE STATING 'INSUFFICIENT    *
**                         STORAGE'  IN THE CSCB COMMAND BUFFER AREA  *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE102I HH.MM.SS YY.DDD ACTIVITY'               ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'DISPLAY TRUNCATED - INSUFFICIENT STORAGE'        ×  *
**          C ------------------------------------------------------  *
**                      2) GET TIME STAMP. IF NO STAMP THEN TIME WILL *
**                         BE ZERO.                                   *
**                      3) DEQUEUE OFF THE CSCB CHAIN                 *
**                      4) ISSUE THE MESSAGE                          *
**                      5) RETURN                                     *
**                   B) IF THE GETMAIN WAS SUCCESSFUL  THEN           *
**                      1) ZERO OUT THE BUFFER                        *
**                      2) BUILD THE HEADER LINE                      *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE102I HH.MM.SS YY.DDD ACTIVITY'               ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**                         A) IF TIME STAMP ERROR THEN THE TIME WILL  *
**                            BE ZERO                                 *
**                         B) RETURN TO DISPLAY PROCEDURE             *
**********************************************************************/
*                                                                  0398
*   RFY                                                            0398
*    (R1,                                                          0398
*     R6,                                                          0398
*     R14,                                                         0398
*     R15) RSTD;                                                   0398
*HEADERLN:                                                         0399
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0399
HEADERLN DS    0H                                                  0400
*   HEADSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0400
*                                      PROC                          */
         ST    R14,HEADSAVE                                        0400
*   RFY                                                            0401
*     R14 UNRSTD;                                                  0401
*   TRCF4HDI=ON;                    /* MARK HEADERLN PROC AS IN    0402
*                                      PROCESSING                    */
*   TRCF4HDE=ON;                    /* MARK HEADERLN PROC AS ENTERED */
         LA    @14,TRCURRSW                                        0403
         OI    TRCF4HDI(@14),B'00000011'                           0403
*   CONNEXT=OFF;                    /* SEE PROLOG IN PROCEDURE     0404
*                                      NEXTWPL                       */
*   CONEND=OFF;                     /* SEE PROLOG IN PROCEDURE     0405
*                                      NEXTWPL                       */
         NI    CONNEXT,B'10011111'                                 0405
*   FIRSTIME=ON;                    /* 1ST 10-AT-A-TIME SWITCH       */
         OI    FIRSTIME,B'00100000'                                0406
*   GETLIST(ONE:GETLGTH)=GETAREA(ONE:GETLGTH);/* BUILD GETMAIN LIST  */
         LH    @14,GETLGTH                                         0407
         BCTR  @14,0                                               0407
         EX    @14,@SM03161                                        0407
*   CALL CALCORE;                   /* CALCULATE THE BUFFER SIZE   0408
*                                                            @ZA07770*/
         BAL   @14,CALCORE                                         0408
*   GENLGTH=COREBYTE;               /* THE CORE SIZE NEEDED IS     0409
*                                      INITIALIZED           @ZA07770*/
         L     @14,COREBYTE                                        0409
         ST    @14,GENLGTH                                         0409
*   R6=ADDR(BUFPTR);                /* BUFPTR=ADDRESS OF GOTTEN CORE */
         LA    R6,BUFPTR                                           0410
*   R1=ADDR(GETLIST);               /* REG 1 POINTS TO GETMAIN LIST  */
         LA    R1,GETLIST                                          0411
*   GEN SETS(R6) REFS(R1)(GETMAIN MF=(E,(1)),A=(6));               0412
         GETMAIN MF=(E,(1)),A=(6)
*   RFY                                                            0413
*    (R1,                                                          0413
*     R6) UNRSTD;                                                  0413
*                                                                  0413
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST FOR SUCCESSFUL GETMAIN                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0414
*   IF R15^=ZERO THEN               /* WAS IT SUCCESSFUL?            */
         LTR   R15,R15                                             0414
         BZ    @RF00414                                            0414
*     DO;                           /* NO, MOVE MAIN & ERR INTO CSCB */
*       RFY                                                        0416
*         R15 UNRSTD;                                              0416
*       CSCBPTR=CSCBPASS;           /* RESTORE TO THIS TASKS CSCB  0417
*                                                            @ZA07770*/
         LA    @10,STAELIST                                        0417
         L     CSCBPTR,CSCBPASS(,@10)                              0417
*       WPLPTR=ADDR(CHSWT);         /* ESTABLISH ADDRESSABILITY FOR
*                                      MESSAGE TEXT                  */
         LA    WPLPTR,CHSWT(,CSCBPTR)                              0418
*       WPL(ONE:HEADLGTH)=HEADTEXT(ONE:HEADLGTH);/* MAIN HEADER    0419
*                                                            @YM01918*/
         SLR   @10,@10                                             0419
         IC    @10,HEADLGTH                                        0419
         BCTR  @10,0                                               0419
         EX    @10,@SM03163                                        0419
*       CALL TIMESNAP;              /* GO GET TIME STAMP             */
         BAL   @14,TIMESNAP                                        0420
*       WPLPTR=WPLPTR+WPLLGH;       /*                       @ZA05477*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0421
*       WPLDESCJ=OFF;               /* TURN OFF DESC CODE 10 @ZA05477*/
         NI    WPLDESCJ(WPLPTR),B'10111111'                        0422
*       WPLPTR=WPLPTR+LENGTH(WPLFLGS)-FOUR;/* NEXT WPL       @ZA05477*/
         SL    WPLPTR,@CF03131                                     0423
*       WPLAREA=CHARID;             /* GET AREA ID FOR CRT (Z=PAPER) */
         MVC   WPLAREA(1,WPLPTR),CHARID(CSCBPTR)                   0424
*       WPLLINES=TWO;               /* NUMBER OF LINES = 2           */
         MVI   WPLLINES(WPLPTR),X'02'                              0425
*       WPLPTR=WPLPTR+LENGTH(WPLLS01);/*                     @YM01918*/
         AL    WPLPTR,@CF00034                                     0426
*       WPLML(ONE:ERRLGTH)=ERRTEXT(ONE:ERRLGTH);/* ERROR LINE      0427
*                                                            @YM01918*/
         SLR   @10,@10                                             0427
         IC    @10,ERRLGTH                                         0427
         BCTR  @10,0                                               0427
         EX    @10,@SM03166                                        0427
*       WPLMLLTC=ON;                /* MARK AS A DATA LINE   @ZA05477*/
*       WPLMLLTD=ON;                /* MARK AS THE END LINE  @ZA05477*/
         OI    WPLMLLTC(WPLPTR),B'00110000'                        0429
*       CSCBFLAG=ON;                /* INDICATE MSG IN CSCB          */
         OI    CSCBFLAG,B'10000000'                                0430
*       CALL DQCSCB;                /* DEQUEUE OFF THE CSCB CHAIN    */
         BAL   @14,DQCSCB                                          0431
*       CALL ISSUEMSG;              /* ISSUE THE MESSAGE             */
         BAL   @14,ISSUEMSG                                        0432
*     END;                          /* END IF GETMAIN NOT SUCCESSFUL */
*   ELSE                            /* GETMAIN WAS SUCCESSFUL        */
*     DO;                                                          0434
         B     @RC00414                                            0434
@RF00414 DS    0H                                                  0435
*       RFY                                                        0435
*        (R2,                                                      0435
*         R3,                                                      0435
*         R6,                                                      0435
*         R7) RSTD;                                                0435
*       R2=BUFPTR;                  /* ADDR OF GOTTEN CORE   @ZA07770*/
         L     R2,BUFPTR                                           0436
*       R3=COREBYTE;                /* LENGTH OF GOTTEN CORE @ZA07770*/
         L     R3,COREBYTE                                         0437
*       R6=R6&&R6;                  /* ZERO SOURCE ADDR      @ZA07770*/
         XR    R6,R6                                               0438
*       R7=R7&&R7;                  /* PAD WITH ZEROS        @ZA07770*/
         XR    R7,R7                                               0439
*       MVCL(R2,R6);                /* ZERO OUT THE CORE     @ZA07770*/
         MVCL  R2,R6                                               0440
*       RFY                                                        0441
*        (R2,                                                      0441
*         R3,                                                      0441
*         R6,                                                      0441
*         R7) UNRSTD;                                              0441
*       COUNT=ZERO;                 /* INITIALIZE LINE COUNT TO 0    */
         MVI   COUNT,X'00'                                         0442
*       WPLPTR=BUFPTR+LINKLGTH;     /* FIRST MLWTO PLACE     @ZA07770*/
         LA    WPLPTR,4                                            0443
         AL    WPLPTR,BUFPTR                                       0443
*       WPL(ONE:HEADLGTH)=HEADTEXT(ONE:HEADLGTH);/* MOVE MAIN HEADER */
         SLR   @10,@10                                             0444
         IC    @10,HEADLGTH                                        0444
         BCTR  @10,0                                               0444
         EX    @10,@SM03163                                        0444
*       CALL TIMESNAP;              /* GET TIME STAMP                */
         BAL   @14,TIMESNAP                                        0445
*       WPLPTR=WPLPTR+WPLLGH;       /*                       @ZA05477*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0446
*       IF CSCBPASS->CHVCD^=TRCMD THEN/* IS THIS A TR CMD    @ZA05477*/
         LA    @10,STAELIST                                        0447
         L     @10,CSCBPASS(,@10)                                  0447
         CLI   CHVCD(@10),X'C4'                                    0447
         BE    @RF00447                                            0447
*         WPLDESCJ=OFF;             /* NO ITS DISPLAY. TURN OFF DESC
*                                      10                    @ZA05477*/
         NI    WPLDESCJ(WPLPTR),B'10111111'                        0448
*       WPLPTR=WPLPTR+LENGTH(WPLFLGS)-FOUR+LENGTH(WPLLS01);/* GET  0449
*                                      NEXT WPL              @ZA05477*/
@RF00447 AL    WPLPTR,@CF00196                                     0449
*       COUNT=COUNT+ONE;            /* INCREMENT LINE COUNT          */
         IC    @10,COUNT                                           0450
         LA    @10,1(,@10)                                         0450
         STC   @10,COUNT                                           0450
*     END;                                                         0451
*   TRCF4HDI=OFF;                   /* MARK HEADERLN PROC AS CONTROL
*                                      LEAVING                       */
@RC00414 LA    @10,TRCURRSW                                        0452
         NI    TRCF4HDI(@10),B'11111101'                           0452
*   RFY                                                            0453
*     R14 RSTD;                                                    0453
*   R14=HEADSAVE;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                          */
         L     R14,HEADSAVE                                        0454
*   RFY                                                            0455
*     R14 UNRSTD;                                                  0455
*   END HEADERLN;                                                  0456
@EL00007 DS    0H                                                  0456
@EF00007 DS    0H                                                  0456
@ER00007 BR    @14                                                 0456
*                                                                  0457
*/*********************************************************************
**             I S S U E M S G    P R O C E D U R E                   *
** ENTRY REASON - 1) ISSUE NO TRK UPDATE MESSAGE                      *
**                2) ISSUE INSUFFICENT STORAGE MESSAGE                *
** ENTRY FROM   - 1) TRACK PROCEDURE                                  *
**                2) HEADERLN PROCEDURE                               *
** EXIT TO      - RETURN TO CALLING PROCEDURE                         *
** FUNCTION     - 1) FILL IN PARM LIST                                *
**                2) HAVE IEECB801 ISSUE THE MESSAGES                 *
**                3) RETURN                                           *
**********************************************************************/
*                                                                  0457
*ISSUEMSG:                                                         0457
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0457
ISSUEMSG DS    0H                                                  0458
*   RFY                                                            0458
*    (R1,                                                          0458
*     R14) RSTD;                                                   0458
*   IMSGSAVE=R14;                   /* SAVE RETURN ADDR TO HEADERLN
*                                      PROC                          */
         ST    R14,IMSGSAVE                                        0459
*   RFY                                                            0460
*     R14 UNRSTD;                                                  0460
*   TRCFCIMI=ON;                    /* MARK FLAG AS ISSUEMSG PROC IN
*                                      CONTROL                       */
*   TRCFCIME=ON;                    /* MARK FLAG AS ISSUEMSG PROC  0462
*                                      ENTERED                       */
         LA    @10,TRCURRSW                                        0462
         OI    TRCFCIMI(@10),B'00110000'                           0462
*   R1=ADDR(PARMLIST);              /* PARM LIST FOR IEECB801        */
         LA    R1,PARMLIST                                         0463
*   MESSADDR=ADDR(CHSWT);           /* ADDR OF MSG IN PARM LIST      */
         LA    @09,CHSWT(,CSCBPTR)                                 0464
         ST    @09,MESSADDR                                        0464
*   TRCFACBI=ON;                    /* MARK IEECB801 AS IN PROCESSING*/
*   TRCFACBE=ON;                    /* MARK IEECB801 AS ENTERED      */
         OI    TRCFACBI(@10),B'00000011'                           0466
*   CALL IEECB801;                  /* GO TO IEECB801 TO ISSUE MSG   */
         L     @15,@CV02746                                        0467
         BALR  @14,@15                                             0467
*   TRCFACBI=OFF;                   /* MARK IEECB801 AS CONTROL HAS
*                                      COME BACK                     */
         LA    @10,TRCURRSW                                        0468
         NI    TRCFACBI(@10),B'11111101'                           0468
*   TRCFCIMI=OFF;                   /* MARK FLAG AS CONTROL LEAVING
*                                      ISSUEMSG PROC                 */
         NI    TRCFCIMI(@10),B'11011111'                           0469
*   RFY                                                            0470
*     R14 RSTD;                                                    0470
*   R14=IMSGSAVE;                   /* RESTORE RETURN ADDR OF      0471
*                                      HEADERLN PROC                 */
         L     R14,IMSGSAVE                                        0471
*   RFY                                                            0472
*    (R1,                                                          0472
*     R14) UNRSTD;                                                 0472
*   END ISSUEMSG;                                                  0473
@EL00008 DS    0H                                                  0473
@EF00008 DS    0H                                                  0473
@ER00008 BR    @14                                                 0473
*                                                                  0474
*/*********************************************************************
**                 C A L C O R E   P R O C E D U R E                  *
** ENTRY REASON - CALCULATE THE NUMBER OF BYTES NEEDED FOR THE BUFFER *
** ENTRY FROM   - HEADERLN PROCEDURE                                  *
** EXIT TO      - HEADERLN PROCEDURE                                  *
** FUNCTION     - 1) FIND THE NUMBER OF LINES AND BYTES FOR THE       *
**                   HEADER LINE                                      *
**                2) IF 'JOBS','JOBS,LIST','A' OR 'A,LIST' THEN       *
**                   CALCULATE THE NUMBER OF LINES AND BYTES NEEDED   *
**                   FOR THE DISPLAY                                  *
**                3) IF 'TS','TS,LIST','A' OR 'A,LIST' THEN CALCULATE *
**                   THE NUMBER OF LINES AND BYTES NEEDED FOR THESE   *
**                   OPTIONS                                          *
**                4) FIND THE NUMBER OF MLWTO'S TO BE WRITTEN         *
**                5) ADD EXTRA BYTES TO THE BUFFER SIZE FOR THE LINK  *
**                   POINTERS (FOR THE MLWTO LINKED LIST) AND THE     *
**                   EXTRA BYTES FOR THE FIRST LINE OF EACH CONNECTING*
**                   MLWTO                                            *
**                   (THE 1ST LINE IS LONGER THAN THE OTHER LINES)    *
**                6) RETURN                                           *
**********************************************************************/
*                                                                  0474
*CALCORE:                                                          0474
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA07770*/
CALCORE  DS    0H                                                  0475
*   RFY                                                            0475
*     R14 RSTD;                     /*                       @ZA07770*/
*   CALCSAVE=R14;                   /* SAVE RETURN ADDR TO HEADERLN
*                                      PROC                  @ZA07770*/
         ST    R14,CALCSAVE                                        0476
*   RFY                                                            0477
*     R14 UNRSTD;                   /*                       @ZA07770*/
*   TRCF5CRI=ON;                    /* MARK CALCORE PROC AS IN     0478
*                                      PROCESSING                    */
*   TRCF5CRE=ON;                    /* MARK CALCORE PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0479
         OI    TRCF5CRI(@10),B'00110000'                           0479
*   COREBYTE=HED#BYTE;              /* # BYTES FOR THE HEADER LINE 0480
*                                                            @ZA07770*/
         LA    @10,44                                              0480
         ST    @10,COREBYTE                                        0480
*   NUMLINES=ONE;                   /* # LINES IS ONE FOR HEADER   0481
*                                                            @ZA07770*/
         LA    @15,1                                               0481
         LR    NUMLINES,@15                                        0481
*   IF TASKCSCB->CHJOBS=ON×TASKCSCB->CHJOBSL=ON THEN/* JOBS OR JOBS
*                                      LIST WANTED ?         @ZA07770*/
         L     @02,TASKCSCB                                        0482
         TM    CHJOBS(@02),B'11000000'                             0482
         BZ    @RF00482                                            0482
*     DO;                           /* YES                   @ZA07770*/
*       COREBYTE=COREBYTE+JOB#BYTE; /* INCREASE FOR JOB-INIT LINE  0484
*                                                            @ZA07770*/
         AL    @10,@CF02944                                        0484
         ST    @10,COREBYTE                                        0484
*       NUMLINES=NUMLINES+ONE;      /* INCREASE FOR JOB-INIT @ZA07770*/
         ALR   NUMLINES,@15                                        0485
*       IF TASKCSCB->CHJOBSL=ON THEN/* JOBS, LIST WANTED?    @ZA07770*/
         TM    CHJOBSL(@02),B'01000000'                            0486
         BNO   @RF00486                                            0486
*         DO;                       /* YES                   @ZA07770*/
*           COREBYTE=COREBYTE+(JBL#BYTE*JOBNUM);/* INCREASE FOR # OF
*                                      JOBS TO BE LISTED     @ZA07770*/
         LH    @02,JOBNUM                                          0488
         LR    @15,@02                                             0488
         MH    @15,@CH02946                                        0488
         ALR   @10,@15                                             0488
         ST    @10,COREBYTE                                        0488
*           NUMLINES=NUMLINES+JOBNUM;/* INCREASE FOR # OF JOBS TO BE
*                                      LISTED                @ZA07770*/
         ALR   NUMLINES,@02                                        0489
*           IF JOBNUM>SEVEN THEN    /* MORE JOBS THAN NAX V=R JOBS ?
*                                                            @ZA07770*/
         C     @02,@CF01401                                        0490
         BNH   @RF00490                                            0490
*             COREBYTE=COREBYTE+(SEVEN*JBREXTRA);/* ADD BYTES TO LIST
*                                      MAX NUMBER OF V=R JOBS. SEVEN
*                                      IS THE MAX NUMBER ALLOWED.  0491
*                                                            @ZA07770*/
         AL    @10,@CF03132                                        0491
         ST    @10,COREBYTE                                        0491
*           ELSE                    /*                       @ZA07770*/
*             COREBYTE=COREBYTE+(JOBNUM*JBREXTRA);/* ADD BYTES TO  0492
*                                      LIST POSSIBLE V=R JOBS      0492
*                                                            @ZA07770*/
         B     @RC00490                                            0492
@RF00490 LH    @10,JOBNUM                                          0492
         MH    @10,@CH00961                                        0492
         AL    @10,COREBYTE                                        0492
         ST    @10,COREBYTE                                        0492
*         END;                      /*                       @ZA07770*/
@RC00490 DS    0H                                                  0494
*     END;                                                         0494
@RF00486 DS    0H                                                  0495
*   IF TASKCSCB->CHTS=ON×TASKCSCB->CHTSL=ON THEN/* TS OR TS,LIST   0495
*                                      WANTED ?              @ZA07770*/
@RF00482 L     @10,TASKCSCB                                        0495
         TM    CHTS(@10),B'00001100'                               0495
         BZ    @RF00495                                            0495
*     DO;                           /* YES                   @ZA07770*/
*       COREBYTE=COREBYTE+TS#BYTE+VTM#BYTE;/* INCREASE FOR TS USER 0497
*                                      AND VTAM LINES        @Z40DQSS*/
         LA    @02,76                                              0497
         AL    @02,COREBYTE                                        0497
         ST    @02,COREBYTE                                        0497
*       NUMLINES=NUMLINES+TWO;      /* INCR FOR TS USER AND VTAM LINE
*                                                            @Z40DQSS*/
         AL    NUMLINES,@CF00127                                   0498
*       IF TASKCSCB->CHTSL=ON THEN  /* TS,LIST WANTED?       @ZA07770*/
         TM    CHTSL(@10),B'00000100'                              0499
         BNO   @RF00499                                            0499
*         DO;                       /* YES                   @ZA07770*/
*           TEMPLACE=((TSNUM+TSNAM#-ONE)/TSNAM#);/* # LINES NEEDED TO
*                                      LIST THE TSO USERS. TSNAM# IS
*                                      THE # OF USERS LISTED PER   0501
*                                      LINE.                 @ZA07770*/
         LH    @00,TSNUM                                           0501
         SL    @00,@CF03134                                        0501
         SRDA  @00,32                                              0501
         D     @00,@CF01254                                        0501
         LR    TEMPLACE,@01                                        0501
*           COREBYTE=COREBYTE+TSL#BYTE*TEMPLACE;/* INCR FOR THE LINES
*                                      NEEDED TO LIST THE TSO USERS.
*                                                            @ZA07770*/
         L     @10,COREBYTE                                        0502
         LR    @15,TEMPLACE                                        0502
         MH    @15,@CH02950                                        0502
         ALR   @10,@15                                             0502
         ST    @10,COREBYTE                                        0502
*           NUMLINES=NUMLINES+TEMPLACE;/* INCR FOR # LINES TO LIST 0503
*                                      TSO USERS             @ZA07770*/
         ALR   NUMLINES,TEMPLACE                                   0503
*         END;                      /*                       @ZA07770*/
*     END;                                                         0505
@RF00499 DS    0H                                                  0506
*   MLWTO#=(NUMLINES+MLWTOLIN-ONE)/MLWTOLIN;/* # OF MLWTO'S GROUPS 0506
*                                      WITH A LIMIT OF MLWTOLIN LINES
*                                      FOR EACH MLWTO GROUP  @ZA07770*/
@RF00495 LR    @00,NUMLINES                                        0506
         SL    @00,@CF03135                                        0506
         SRDA  @00,32                                              0506
         D     @00,@CF02881                                        0506
         LR    MLWTO#,@01                                          0506
*   COREBYTE=COREBYTE+LENGTH(WPLLS01)*(MLWTO#-ONE);/* INCR EXTRA   0507
*                                      BYTES FOR EACH 1ST LINE OF  0507
*                                      MLWTO'S EXCEPT THE 1ST CONTROL
*                                      LINE FOR LINE TYPE, AREA ID 0507
*                                      AND # OF LINES IN MLWTO     0507
*                                                            @ZA07770*/
         LR    @10,MLWTO#                                          0507
         BCTR  @10,0                                               0507
         SLA   @10,2                                               0507
         AL    @10,COREBYTE                                        0507
         ST    @10,COREBYTE                                        0507
*   COREBYTE=COREBYTE+LINKLGTH*MLWTO#;/* INCR FOR LINK PTRS FOR EACH
*                                      MLWTO GROUP           @ZA07770*/
         LR    @03,MLWTO#                                          0508
         SLA   @03,2                                               0508
         ALR   @10,@03                                             0508
         ST    @10,COREBYTE                                        0508
*   TRCF5CRI=OFF;                   /* MARK CALCORE PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0509
         NI    TRCF5CRI(@10),B'11011111'                           0509
*   RFY                                                            0510
*     R14 RSTD;                     /*                       @ZA07770*/
*   R14=CALCSAVE;                   /* RESTORE RETURN ADDR TO      0511
*                                      HEADERLN PROC         @ZA07770*/
         L     R14,CALCSAVE                                        0511
*   RFY                                                            0512
*     R14 UNRSTD;                   /*                       @ZA07770*/
*   END CALCORE;                    /*                       @ZA07770*/
@EL00009 DS    0H                                                  0513
@EF00009 DS    0H                                                  0513
@ER00009 BR    @14                                                 0513
*                                                                  0514
*/*********************************************************************
**                J O B L I N E   P R O C E D U R E                   *
** ENTRY REASON - OPTIONS 'JOBS','JOBS,LIST','A' OR 'A,LIST' WANTED   *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT TO      - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) BUILD THE JOB-INIT LINE                          *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 JOBS    00000 INITIATORS'                  ×  *
**          C ------------------------------------------------------  *
**                2) THE JOB AND INIT COUNTS ARE CONVERTED AND PUT    *
**                   INTO THE DISPLAY LINE                            *
**                3) RETURN                                           *
**********************************************************************/
*                                                                  0514
*   RFY                                                            0514
*    (R6,                                                          0514
*     R7,                                                          0514
*     R14) RSTD;                                                   0514
*JOBLINE:                                                          0515
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0515
JOBLINE  DS    0H                                                  0516
*   JOBLSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0516
*                                      PROC                          */
         ST    R14,JOBLSAVE                                        0516
*   RFY                                                            0517
*     R14 UNRSTD;                                                  0517
*   TRCF5JBI=ON;                    /* MARK JOBLINE PROC AS IN     0518
*                                      PROCESSING                    */
*   TRCF5JBE=ON;                    /* MARK JOBLINE PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0519
         OI    TRCF5JBI(@10),B'00000011'                           0519
*   WPLML(ONE:JOBLGTH)=JOBTEXT(ONE:JOBLGTH);/* GET JOBS SUB MSG      */
         SLR   @10,@10                                             0520
         IC    @10,JOBLGTH                                         0520
         BCTR  @10,0                                               0520
         EX    @10,@SM03168                                        0520
*   WPLSAVE=WPLPTR;                 /* SAVE ADDR OF LINE JUST FILLED */
         ST    WPLPTR,WPLSAVE                                      0521
*   WPLMLLTC=ON;                    /* DATA LINE                     */
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0522
*   IF JOBNUM^=ZERO THEN            /* ANY JOBS CSCB'S?              */
         LH    @10,JOBNUM                                          0523
         LTR   @10,@10                                             0523
         BZ    @RF00523                                            0523
*     DO;                           /* YES                           */
*       R7=JOBNUM;                  /* SAVE # OF ACTIVE JOBS & TASKS */
         LR    R7,@10                                              0525
*       R6=WPLPTR+FOUR;             /* JOBS SUB-HEADER ADDRESS       */
         LA    R6,4                                                0526
         ALR   R6,WPLPTR                                           0526
*       CALL CVDCOUNT;              /* CONVERT NUMBER TO DECIMAL     */
         BAL   @14,CVDCOUNT                                        0527
*     END;                                                         0528
*   IF INITNUM^=ZERO THEN           /* ANY INIT CSCB'S       @ZA07770*/
@RF00523 LH    @10,INITNUM                                         0529
         LTR   @10,@10                                             0529
         BZ    @RF00529                                            0529
*     DO;                           /* YES                   @ZA07770*/
*       R7=INITNUM;                 /* # OF ACTIVE INITS     @ZA07770*/
         LR    R7,@10                                              0531
*       R6=WPLPTR+EIGHTEEN;         /* WHERE TO PUT CONVERTD NUMBER
*                                                            @ZA07770*/
         LA    R6,18                                               0532
         ALR   R6,WPLPTR                                           0532
*       CALL CVDCOUNT;              /* CONVERT NUMBER TO DEC @ZA07770*/
         BAL   @14,CVDCOUNT                                        0533
*     END;                          /*                       @ZA07770*/
*   COUNT=COUNT+ONE;                /* INCREMENT LINE COUNT          */
@RF00529 IC    @10,COUNT                                           0535
         LA    @10,1(,@10)                                         0535
         STC   @10,COUNT                                           0535
*   WPLPTR=WPLPTR+WPLMLLEN;         /* POINT TO NEXT LINE IN MLWTO   */
         SLR   @10,@10                                             0536
         IC    @10,WPLMLLEN(,WPLPTR)                               0536
         ALR   WPLPTR,@10                                          0536
*   TRCF5JBI=OFF;                   /* MARK JOBLINE PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0537
         NI    TRCF5JBI(@10),B'11111101'                           0537
*   RFY                                                            0538
*     R14 RSTD;                                                    0538
*   R14=JOBLSAVE;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                          */
         L     R14,JOBLSAVE                                        0539
*   RFY                                                            0540
*    (R6,                                                          0540
*     R7,                                                          0540
*     R14) UNRSTD;                                                 0540
*   END JOBLINE;                                                   0541
@EL00010 DS    0H                                                  0541
@EF00010 DS    0H                                                  0541
@ER00010 BR    @14                                                 0541
*                                                                  0542
*/*********************************************************************
**               L I S T J O B S   P R O C E D U R E                  *
** ENTRY REASON - OPTIONS 'JOBS,LIST' OR 'A,LIST' WAS WANTED          *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT TO      - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) SCAN CSCB CHAIN FOR JOB CSCB                     *
**                2) WHEN ONE IS FOUND THEN                           *
**                   A) MOVE IN GENERAL LINE FORMAT                   *
**                   B) CALL JOBLFILL TO FILL IN THE SPECIFIC NAMES   *
**                3) FIND NEXT WPL ADDRESS                            *
** NOTE         - THE LINES OF OUTPUT LOOK DIFFERENT DEPENDING IF THE *
**                LINE IS THE 1ST LINE OF A CONNECTING MLWTO OR NOT.  *
**                CONNEXT  IS TESTED TO SEE WHICH LINE IS TO BE ISSUED*
**    WHEN 'CONNEXT ' IS OFF:                                         *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING    V=R      00000K - 00000K'   ×  *
**           ×                         OR                          ×  *
**           ×   'STARTING STARTING    V=V      S'                 ×  *
**          C ------------------------------------------------------  *
**    WHEN 'CONNEXT ' IS ON:                                          *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING    V=R      00000K - 00000K'   ×  *
**           ×                         OR                          ×  *
**           ×   'STARTING STARTING    V=V      S'                 ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**         B' ------------------------------------------------------  *
**********************************************************************/
*                                                                  0542
*LISTJOBS:                                                         0542
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0542
LISTJOBS DS    0H                                                  0543
*   RFY                                                            0543
*     R14 RSTD;                                                    0543
*   LISTJSAV=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0544
*                                      PROC                          */
         ST    R14,LISTJSAV                                        0544
*   RFY                                                            0545
*     R14 UNRSTD;                                                  0545
*   TRCF6LJI=ON;                    /* MARK LISTJOBS PROC AS IN    0546
*                                      PROCESSING                    */
*   TRCF6LJE=ON;                    /* MARK LISTJOBS PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0547
         OI    TRCF6LJI(@10),B'00000011'                           0547
*   CSCBPTR=BACHN;                                                 0548
         L     @10,CVTPTR                                          0548
         L     @10,CVTMSER(,@10)                                   0548
         L     CSCBPTR,BACHN(,@10)                                 0548
*   DO WHILE CSCBPTR^=ZERO;                                        0549
         B     @DE00549                                            0549
@DL00549 DS    0H                                                  0550
*     IF CHTRKID='02'X THEN         /* IS THIS A JOB OR TASK CSCB?   */
         CLI   CHTRKID(CSCBPTR),X'02'                              0550
         BNE   @RF00550                                            0550
*       DO;                                                        0551
*         IF CHRGNAD=ZERO×CHCLS=ZEROES THEN/*                @YM7265P*/
         L     @10,CHRGNAD(,CSCBPTR)                               0552
         LTR   @10,@10                                             0552
         BZ    @RT00552                                            0552
         CLC   CHCLS(8,CSCBPTR),ZEROES                             0552
         BNE   @RF00552                                            0552
@RT00552 DS    0H                                                  0553
*           WPL(ONE:JOBLGTHV)=JOBLISTV(ONE:JOBLGTHV);/* LENGTH JOB,L
*                                      V=V WTO               @YM7265P*/
         SLR   @10,@10                                             0553
         IC    @10,JOBLGTHV                                        0553
         BCTR  @10,0                                               0553
         EX    @10,@SM03170                                        0553
*         ELSE                      /*                       @YM7265P*/
*           WPL(ONE:JOBLLGTH)=JOBLIST(ONE:JOBLLGTH);/*       @YM7265P
*                                      LENGTH JOB,L V=R WTO  @YM7265P*/
         B     @RC00552                                            0554
@RF00552 SLR   @10,@10                                             0554
         IC    @10,JOBLLGTH                                        0554
         BCTR  @10,0                                               0554
         EX    @10,@SM03172                                        0554
*         CALL JOBLFILL;            /* FILL IN JOBNAMES, STEPNAMES 0555
*                                      PROCNAMES, ETC.               */
@RC00552 BAL   @14,JOBLFILL                                        0555
*         CALL NEXTWPL;             /* GET ADDR OF NEXT WPL          */
         BAL   @14,NEXTWPL                                         0556
*       END;                                                       0557
*     CSCBPTR=CHPTR;                /* POINT TO NEXT CSCB, IF 0      */
@RF00550 L     CSCBPTR,CHPTR(,CSCBPTR)                             0558
*   END;                            /* FALL THROUGH - END OF CHAIN   */
@DE00549 LTR   CSCBPTR,CSCBPTR                                     0559
         BNZ   @DL00549                                            0559
*   TRCF6LJI=OFF;                   /* MARK LISTJOBS PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0560
         NI    TRCF6LJI(@10),B'11111101'                           0560
*   RFY                                                            0561
*     R14 RSTD;                                                    0561
*   R14=LISTJSAV;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                          */
         L     R14,LISTJSAV                                        0562
*   RFY                                                            0563
*     R14 UNRSTD;                                                  0563
*   END LISTJOBS;                                                  0564
@EL00011 DS    0H                                                  0564
@EF00011 DS    0H                                                  0564
@ER00011 BR    @14                                                 0564
*                                                                  0565
*/*********************************************************************
**               J O B L F I L L   P R O C E D U R E                  *
** ENTRY REASON - OPTIONS 'JOBS,LIST' OR 'A,LIST' IS WANTED AND THE   *
**                NUMBER OF JOBS DOES NOT EQUAL ZERO                  *
** ENTRY FROM   - LISTJOBS PROCEDURE                                  *
** EXIT TO      - LISTJOBS PROCEDURE                                  *
** FUNCTION     - 1) FILL IN THE JOBNAME, STEPNAME AND PROC STEPNAME  *
**                   A) IF THE JOB IS A START OR MOUNT THEN           *
**                      1) JOBNAME IS IN CHCLS                        *
**                      2) STEPNAME IS IN CHKEY                       *
**                      3) PROC STEPNAME IS IN CHPROCSN               *
**                   B) IF THE JOB IS EXECUTING THEN                  *
**                      1) JOBNAME IS IN CHKEY                        *
**                      2) STEPNAME IS IN CHSTEP                      *
**                      3) PROC STEPNAME IS IN CHPROCSN               *
**                   C) IF JOBNAME OR STEPNAME IS NOT SPECIFIED THEN  *
**                      THE DEFAULT IS 'STARTING'                     *
**                   D) IF PROC STEPNAME IS NOT SPECIFIED, THE DEFAULT*
**                      IS BLANKS                                     *
**                   E) IF SWAPPED OUT, FILL IN 'S'           @ZA07770*
**                2) FILL IN THE BEGINNING AND ENDING ADDRESSES FOR   *
**                   THE JOBS REGION                                  *
**                   A) IF THE JOB REGION BEGINNING ADDRESS(CHRGNAD)  *
**                      OR JOB REGION SIZE(CHRGNSZ) ARE ZERO THEN THE *
**                      DEFAULT IS V=V REGION.                        *
**                   B) IF NOT V=V REGION THEN ITS A V=R REGION       *
**                      1) JOB REGION ENDING ADDRESS IS CALCULATED    *
**                      2) BEGINNING AND ENDING ADDRESS ARE CHANGED   *
**                         TO K MULTIPLES AND CONVERTED TO DECIMAL,   *
**                         UNPACKED AND PLACED IN MESSAGE TEXT.       *
**                3) RETURN                                           *
**********************************************************************/
*                                                                  0565
*JOBLFILL:                                                         0565
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0565
JOBLFILL DS    0H                                                  0566
*   RFY                                                            0566
*     R14 RSTD;                                                    0566
*   JOBLFSAV=R14;                   /* SAVE RETURN ADDR TO LISTJOBS
*                                      PROC                          */
         ST    R14,JOBLFSAV                                        0567
*   RFY                                                            0568
*     R14 UNRSTD;                                                  0568
*   TRCFBJFI=ON;                    /* MARK FLAG AS CONTROL GIVEN TO
*                                      JOBLFILL PROC                 */
*   TRCFBJFE=ON;                    /* MARK FLAG AS JOBLFILL PROC AS
*                                      ENTERED                       */
         LA    @10,TRCURRSW                                        0570
         OI    TRCFBJFI(@10),B'00000011'                           0570
*   IF CHVCD=STARTJOB×CHVCD=MOUNTJOB THEN/*                  @YM6960P
*                                      START OR MOUNT ?      @YM6960P*/
         CLI   CHVCD(CSCBPTR),X'04'                                0571
         BE    @RT00571                                            0571
         CLI   CHVCD(CSCBPTR),X'0C'                                0571
         BNE   @RF00571                                            0571
@RT00571 DS    0H                                                  0572
*     DO;                           /* YES                   @YM6960P*/
*       IF CHCLS^=ZEROES THEN       /* IS IT ZERO            @YM6960P*/
         CLC   CHCLS(8,CSCBPTR),ZEROES                             0573
         BE    @RF00573                                            0573
*         JOBNM=CHCLS;              /* NO MOVE IN JOBNAME    @YM6960P*/
         MVC   JOBNM(8,WPLPTR),CHCLS(CSCBPTR)                      0574
*       ELSE                                                       0575
*         ;                         /* DEFAULT=STARTING      @YM6960P*/
@RF00573 DS    0H                                                  0576
*       IF CHKEY^=ZEROES THEN       /* IS IT ZERO            @YM6960P*/
         CLC   CHKEY(8,CSCBPTR),ZEROES                             0576
         BE    @RF00576                                            0576
*         STEPNM=CHKEY;             /* NO MOVE IN STEPNAME   @YM6960P*/
         MVC   STEPNM(8,WPLPTR),CHKEY(CSCBPTR)                     0577
*       ELSE                                                       0578
*         ;                         /* DEFAULT=STARTING      @YM6960P*/
@RF00576 DS    0H                                                  0579
*     END;                          /*                       @YM6960P*/
*   ELSE                            /* EXECUTING JOB         @YM6960P*/
*     DO;                           /*                       @YM6960P*/
         B     @RC00571                                            0580
@RF00571 DS    0H                                                  0581
*       IF CHKEY^=ZEROES THEN       /* IS IT ZERO?           @YM6960P*/
         CLC   CHKEY(8,CSCBPTR),ZEROES                             0581
         BE    @RF00581                                            0581
*         JOBNM=CHKEY;              /* NO MOVE IN JOBNAME    @YM6960P*/
         MVC   JOBNM(8,WPLPTR),CHKEY(CSCBPTR)                      0582
*       ELSE                                                       0583
*         ;                         /* DEFAULT=STARTING      @YM6960P*/
@RF00581 DS    0H                                                  0584
*       IF CHSTEP^=ZEROES THEN      /* IS IT ZERO?           @YM6960P*/
         CLC   CHSTEP(8,CSCBPTR),ZEROES                            0584
         BE    @RF00584                                            0584
*         STEPNM=CHSTEP;            /* NO MOVE IN STEPNAME@YM6960P   */
         MVC   STEPNM(8,WPLPTR),CHSTEP(CSCBPTR)                    0585
*       ELSE                                                       0586
*         ;                         /* DEFAULT=STARTING      @YM6960P*/
@RF00584 DS    0H                                                  0587
*     END;                          /*                       @YM6960P*/
*   IF CHPROCSN^=ZEROES THEN        /* IS IT ZEROES          @YM6960P*/
@RC00571 CLC   CHPROCSN(8,CSCBPTR),ZEROES                          0588
         BE    @RF00588                                            0588
*     PROCSNM=CHPROCSN;             /* NO PROC STEPNAME      @YM6960P*/
         MVC   PROCSNM(8,WPLPTR),CHPROCSN(CSCBPTR)                 0589
*   ELSE                                                           0590
*     ;                             /* DEFAULT=BLANKS        @YM6960P*/
@RF00588 DS    0H                                                  0591
*   IF JOBNM^=STARTING THEN                                        0591
         CLC   JOBNM(8,WPLPTR),STARTING                            0591
         BE    @RF00591                                            0591
*     DO;                           /* OUT OF SYSTEM TASK CONTROL    */
*       JREGION=CHRGNAD;            /* REGION START ADDR             */
         L     JREGION,CHRGNAD(,CSCBPTR)                           0593
*       JSIZE=CHRGNSZ;              /* REGION SIZE                   */
         L     JSIZE,CHRGNSZ(,CSCBPTR)                             0594
*       IF JREGION^=ZERO&           /* NOT BEING INITIALED           */
*           JSIZE^=ZERO THEN        /* OR TERMINATED                 */
         SLR   @10,@10                                             0595
         CR    JREGION,@10                                         0595
         BE    @RF00595                                            0595
         CR    JSIZE,@10                                           0595
         BE    @RF00595                                            0595
*         DO;                                                      0596
*           RFY                                                    0597
*            (R6,                                                  0597
*             R7) RSTD;                                            0597
*           R7=JREGION;             /* BEGINNING ADDRESS             */
         LR    R7,JREGION                                          0598
*           R7=R7/TEN24;            /* # OF K                        */
         LR    @00,R7                                              0599
         SRDA  @00,32                                              0599
         D     @00,@CF02911                                        0599
         LR    R7,@01                                              0599
*           R6=ADDR(STRADDR)-THREE; /*                       @YM01918*/
         LA    R6,STRADDR(,WPLPTR)                                 0600
         SL    R6,@CF00425                                         0600
*           CALL CVDCOUNT;          /* PUT VALUE IN MSG              */
         BAL   @14,CVDCOUNT                                        0601
*           R7=JREGION+JSIZE;       /* ENDING ADDRESS                */
         LR    R7,JREGION                                          0602
         ALR   R7,JSIZE                                            0602
*           R7=R7/TEN24;            /* # OF K                        */
         LR    @00,R7                                              0603
         SRDA  @00,32                                              0603
         D     @00,@CF02911                                        0603
         LR    R7,@01                                              0603
*           R6=ADDR(ENDADDR)-THREE; /*                       @YM01918*/
         LA    R6,ENDADDR(,WPLPTR)                                 0604
         SL    R6,@CF00425                                         0604
*           CALL CVDCOUNT;          /* PUT VALUE IN MSG              */
         BAL   @14,CVDCOUNT                                        0605
*           RFY                                                    0606
*            (R6,                                                  0606
*             R7) UNRSTD;                                          0606
*         END;                                                     0607
*       ELSE                                                       0608
*         ;                         /* V=V REGION                    */
@RF00595 DS    0H                                                  0609
*     END;                                                         0609
*   RFY                                                            0610
*     ASCB BASED(ASVTASCB);         /* BASE ASCB             @ZA07770*/
@RF00591 DS    0H                                                  0611
*   ASCBENT=((CHASID*4)+ADDR(ASVTENTY)-4);/* ADDRESS JOB'S ASCB    0611
*                                                            @ZA07770*/
         LH    ASCBENT,CHASID(,CSCBPTR)                            0611
         SLA   ASCBENT,2                                           0611
         L     @10,CVTPTR                                          0611
         L     @10,ASVTPTR(,@10)                                   0611
         LA    @10,ASVTENTY(,@10)                                  0611
         ALR   ASCBENT,@10                                         0611
         SL    ASCBENT,@CF00034                                    0611
*   IF ASCBOUT=ON THEN              /* IF JOB IS SWAPPED OUT,      0612
*                                                            @ZA07770*/
         L     @10,ASVTASCB(,ASCBENT)                              0612
         TM    ASCBOUT(@10),B'00000100'                            0612
         BNO   @RF00612                                            0612
*     SWAPIND=SWAPPED;              /* SHOW IT.              @ZA07770*/
         MVI   SWAPIND+39(WPLPTR),C'S'                             0613
*   TRCFBJFI=OFF;                   /* MARK FLAG AS CONTROL LEAVING
*                                      JOBLFILL PROC                 */
@RF00612 LA    @10,TRCURRSW                                        0614
         NI    TRCFBJFI(@10),B'11111101'                           0614
*   RFY                                                            0615
*     R14 RSTD;                                                    0615
*   R14=JOBLFSAV;                   /* RESTORE RETURN ADDR TO      0616
*                                      LISTJOBS PROC                 */
         L     R14,JOBLFSAV                                        0616
*   RFY                                                            0617
*     R14 UNRSTD;                                                  0617
*   END JOBLFILL;                                                  0618
@EL00012 DS    0H                                                  0618
@EF00012 DS    0H                                                  0618
@ER00012 BR    @14                                                 0618
*                                                                  0619
*/*********************************************************************
**               T S V T M L I N   P R O C E D U R E                  *
** ENTRY REASON - OPTION 'TS','TS,LIST','A' OR 'A,LIST' WANTED SO     *
**                BUILD THE TSO AND VTAM LINES                        *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT TO      - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) BUILD TS LINE '00000 TIME SHARING USERS'         *
**                2) BUILD VTAM LINE '00000 ACTIVE  00000 MAX VTAM    *
**                   TSO USERS'                                       *
**                3) PUT IN MAXIMUM VTAM TSO USER NUMBER IN THE LINE  *
**                4) RETURN                                           *
**********************************************************************/
*                                                                  0619
*TSVTMLIN:                                                         0619
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @Z40DQSS*/
TSVTMLIN DS    0H                                                  0620
*   RFY                                                            0620
*     R14 RSTD;                     /*                       @Z40DQSS*/
*   TSVTSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0621
*                                      PROC                  @Z40DQSS*/
         ST    R14,TSVTSAVE                                        0621
*   RFY                                                            0622
*     R14 UNRSTD;                   /*                       @Z40DQSS*/
*   TRCF7TVI=ON;                    /* MARK TSVTMLIN PROC AS IN    0623
*                                      PROCESSING                    */
*   TRCF7TVE=ON;                    /* MARK TSVTMLIN PROC AS ENTERED */
*                                                                  0624
         LA    @10,TRCURRSW                                        0624
         OI    TRCF7TVI(@10),B'00000011'                           0624
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD WPL FOR '00000 TIME SHARING USERS'                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   CALL FILLINE(TSTEXT,TSLGTH,TSNUM);/* BUILD TS LINE       @Z40DQSS*/
*                                                                  0625
         MVC   @AL00001(8),@AL00625                                0625
         LA    @10,TSNUM                                           0625
         ST    @10,@AL00001+8                                      0625
         LA    @01,@AL00001                                        0625
         BAL   @14,FILLINE                                         0625
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD WPL FOR '00000 ACTIVE 00000 MAX VTAM TSO USERS'         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*   IF TCASTPTR^=ZERO THEN          /* DOES THE TCAST TABLE EXIST? 0626
*                                                            @Z40DQSS*/
         L     @10,CVTPTR                                          0626
         L     @10,TCASTPTR(,@10)                                  0626
         LTR   @10,@10                                             0626
         BZ    @RF00626                                            0626
*     DO;                           /* YES                   @Z40DQSS*/
*       CALL FILLINE(VTAMTEXT,VTAMLGTH,TCASUSEC);/* BUILD VTAM LINE
*                                                            @Z40DQSS*/
*                                                                  0628
         MVC   @AL00001(8),@AL00628                                0628
         LA    @10,TCASUSEC(,@10)                                  0628
         ST    @10,@AL00001+8                                      0628
         LA    @01,@AL00001                                        0628
         BAL   @14,FILLINE                                         0628
*       /*************************************************************/
*       /*                                                           */
*       /* PROCEDURE FILLINE SAVES THE ADDRESS OF THE WPL IT JUST    */
*       /* FILLED IN WPLSAVE. THIS IS SO THE MAX VTAM TSO USERS MAY  */
*       /* BE FILLED INTO THE CORRECT WPL.                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0629
*       IF TCASUMAX^=ZERO THEN      /* IS THERE A MAXIMUM NUMBER?  0629
*                                                            @Z40DQSS*/
         L     @10,CVTPTR                                          0629
         L     @10,TCASTPTR(,@10)                                  0629
         LH    @10,TCASUMAX(,@10)                                  0629
         LTR   @10,@10                                             0629
         BZ    @RF00629                                            0629
*         DO;                       /* YES                   @Z40DQSS*/
*           RFY                                                    0631
*            (R6,                                                  0631
*             R7) RSTD;             /*                       @Z40DQSS*/
*           R7=TCASUMAX;            /* MAX NUMBER TO PUT IN LINE   0632
*                                                            @Z40DQSS*/
         LR    R7,@10                                              0632
*           R6=WPLSAVE+EIGHTEEN;    /* WHERE TO PUT NUMBER   @Z40DQSS*/
         LA    R6,18                                               0633
         AL    R6,WPLSAVE                                          0633
*           CALL CVDCOUNT;          /* MAKE # PRINTABLE AND STORE IT
*                                      IN THE LINE           @Z40DQSS*/
         BAL   @14,CVDCOUNT                                        0634
*           RFY                                                    0635
*            (R6,                                                  0635
*             R7) UNRSTD;           /*                       @Z40DQSS*/
*         END;                      /*                       @Z40DQSS*/
*     END;                          /*                       @Z40DQSS*/
*   ELSE                                                           0638
*     ;                             /* THE TCAST TABLE DOES NOT EXIST
*                                                            @ZA29762*/
@RF00626 DS    0H                                                  0639
*/* DELETE CALL TO FILLINE FOR 0 VTAM USERS IF NO TCAS       @ZA29762*/
*                                                                  0639
*   TRCF7TVI=OFF;                   /* MARK TSVTMLIN PROC AS CONTROL
*                                      LEAVING                       */
@RC00626 LA    @10,TRCURRSW                                        0639
         NI    TRCF7TVI(@10),B'11111101'                           0639
*   RFY                                                            0640
*     R14 RSTD;                                                    0640
*   R14=TSVTSAVE;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                  @Z40DQSS*/
         L     R14,TSVTSAVE                                        0641
*   RFY                                                            0642
*     R14 UNRSTD;                                                  0642
*   END TSVTMLIN;                   /*                       @Z40DQSS*/
@EL00013 DS    0H                                                  0643
@EF00013 DS    0H                                                  0643
@ER00013 BR    @14                                                 0643
*                                                                  0644
*/*********************************************************************
**                F I L L I N E   P R O C E D U R E                   *
** ENTRY REASON - OPTION 'TS','TS,LIST','A' OR 'A,LIST' WAS REQUESTED *
**                THE TS LINE  OR THE VTAM LINE ARE TO BE BUILT.      *
** ENTRY FROM   - TSVTMLIN (TWO PLACES-ONCE FOR THE TS LINE AND ONCE  *
**                FOR THE VTAM LINE)                                  *
** EXIT TO      - TSVTMLIN PROCEDURE                                  *
** FUNCTION     - 1) BUILD THE TS OR VTAM LINE                        *
**                2) FILL IN THE NUMBER OF USERS                      *
**                3) RETURN                                           *
** NOTE         - THIS PROCEDURE IS USED TO BUILD BOTH TS AND VTAM    *
**                    LINES DEPENDING ON THE INPUT PARAMETERS.        *
**                FOR BOTH THE TS AND VTAM LINES, THE LINES TO BE     *
**                    BUILT WILL LOOK DIFFERENT IF THE LINE IS THE    *
**                    1ST IN A CONNECTING MLWTO OF IF IT IS ANY OF THE*
**                    REST.  CONNEXT  IS TESTED TO DETERMINE WHAT TYPE*
**                    OF LINE IS BEING PROCESSED.                     *
**                WHEN CONNEXT  IS OFF THEN:                          *
**                A  -----------------------------------------------  *
**         WPLML     × MESSAGE LENGTH + 4 = × MCS FLAGS =          ×  *
**                   -----------------------------------------------  *
**                   × '00000 TIME SHARING USERS'                  ×  *
**                   ×            OR                               ×  *
**                   × '00000 ACTIVE  00000 MAX VTAM TSO USERS     ×  *
**                B  -----------------------------------------------  *
**                                                                    *
**                WHEN CONNEXT  IS ON THEN:                           *
**                A' -----------------------------------------------  *
**         WPL       × MESSAGE LENGTH + 4 = × MCS FLAGS =          ×  *
**                   -----------------------------------------------  *
**                   × '00000 TIME SHARING USERS'                  ×  *
**                   ×            OR                               ×  *
**                   × '00000 ACTIVE  00000 MAX VTAM TSO USERS     ×  *
**                   -----------------------------------------------  *
**         WPLLS01   × LINE TYPE = × AREA ID = × NUMBER OF LINES = ×  *
**                B' -----------------------------------------------  *
**********************************************************************/
*                                                                  0644
*FILLINE:                                                          0644
*   PROC(TEXT,TXTLGTH,NUMBER) OPTIONS(NOSAVE,NOSAVEAREA);          0644
FILLINE  MVC   @PC00014(12),0(@01)                                 0644
*   DCL                                                            0645
*     TEXT CHAR(*);                 /* TEXT TO BE PUT IN WPL @Z40DQSS*/
*   DCL                                                            0646
*     TXTLGTH PTR(8);               /* LENGTH OF TEXT FIELD  @Z40DQSS*/
*   DCL                                                            0647
*     NUMBER FIXED(15);             /* VALUE TO BE CONVERTED AND   0647
*                                      PLACED IN WPL LINE    @Z40DQSS*/
*   RFY                                                            0648
*     R14 RSTD;                     /*                       @Z40DQSS*/
*   FILLSAVE=R14;                   /* SAVE RETURN ADDR TO TSVTMLIN
*                                      PROC                  @Z40DQSS*/
         ST    R14,FILLSAVE                                        0649
*   RFY                                                            0650
*     R14 UNRSTD;                   /*                       @Z40DQSS*/
*   TRCF8FLI=ON;                    /* MARK FILLINE PROC AS IN     0651
*                                      PROCESSING                    */
*   TRCF8FLE=ON;                    /* MARK FILLINE PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0652
         OI    TRCF8FLI(@10),B'00110000'                           0652
*   WPL(ONE:TXTLGTH)=TEXT(ONE:TXTLGTH);/* MOVE TEXT TO WPL   @Z40DQSS*/
         L     @10,@PC00014+4                                      0653
         SLR   @09,@09                                             0653
         IC    @09,TXTLGTH(,@10)                                   0653
         BCTR  @09,0                                               0653
         L     @10,@PC00014                                        0653
         EX    @09,@SM03174                                        0653
*   IF NUMBER^=ZERO THEN            /* ANY NUMBER TO BE CONVERTED ?
*                                                            @Z40DQSS*/
         L     @10,@PC00014+8                                      0654
         LH    @10,NUMBER(,@10)                                    0654
         LTR   @10,@10                                             0654
         BZ    @RF00654                                            0654
*     DO;                           /* YES                   @Z40DQSS*/
*       RFY                                                        0656
*        (R6,                                                      0656
*         R7) RSTD;                 /*                       @Z40DQSS*/
*       R7=NUMBER;                  /* # TO CONVERT AND INSERT INTO
*                                      LINE                  @Z40DQSS*/
         LR    R7,@10                                              0657
*       R6=WPLPTR+FOUR;             /* WHERE TO PUT NUMBER   @Z40DQSS*/
         LA    R6,4                                                0658
         ALR   R6,WPLPTR                                           0658
*       CALL CVDCOUNT;              /* CONVERT # TO PRINTABLE FORM 0659
*                                      AND PUT IN THE LINE   @Z40DQSS*/
         BAL   @14,CVDCOUNT                                        0659
*       RFY                                                        0660
*        (R6,                                                      0660
*         R7) UNRSTD;               /*                       @Z40DQSS*/
*     END;                          /*                       @Z40DQSS*/
*   CALL NEXTWPL;                   /* GET ADDR OF NEXT WPL  @Z40DQSS*/
@RF00654 BAL   @14,NEXTWPL                                         0662
*   TRCF8FLI=OFF;                   /* MARK FILLINE PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0663
         NI    TRCF8FLI(@10),B'11011111'                           0663
*   RFY                                                            0664
*     R14 RSTD;                     /*                       @Z40DQSS*/
*   R14=FILLSAVE;                   /* RESTORE RETURN ADDR TO      0665
*                                      TSVTMLIN PROC         @Z40DQSS*/
         L     R14,FILLSAVE                                        0665
*   RFY                                                            0666
*     R14 UNRSTD;                   /*                       @Z40DQSS*/
*   END FILLINE;                    /*                       @Z40DQSS*/
@EL00014 DS    0H                                                  0667
@EF00014 DS    0H                                                  0667
@ER00014 BR    @14                                                 0667
*                                                                  0668
*/*********************************************************************
**                 L I S T S O   P R O C E D U R E                    *
** ENTRY REASON - OPTION 'TS,LIST' OR 'A,LIST' IS WANTED AND THE      *
**                TSO USER COUNT IS NOT ZERO. LIST THE USERIDS OF     *
**                THE TSO USERS.                                      *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT TO      - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) SCAN CSCB CHAIN AND FIND TSO USERS CSCB          *
**                2) GET A WPL   LINE AND BLANK IT OUT.               *
**                3) INSERT THE TSO USERID INTO THE LINE. THE ID IS   *
**                   IN CHKEY BUT IF CHKEY IS ZERO OR BLANK THEN A    *
**                   DEFAULT OF 'STARTING' IS USED.                   *
**                4) IF USERS' ADDRESS SPACE IS SWAPPED OUT,  @ZA07770*
**                   MOVE IN 'S' AFTER THE USER ID.           @ZA07770*
**                5) RETURN                                   @ZA07770*
** NOTE         - A) THERE ARE TSNAME# OF USER IDS LISTED PER LINE    *
**                B) LINES ARE DIFFERENT DEPENDING IF THEY ARE THE    *
**                   1ST LINE OF A CONNECTING MLWTO OR NOT. CONNEXT   *
**                   IS TESTED TO SEE WHAT TYPE THE LINE IS.          *
**               WHEN CONNEXT  IS OFF THEN:                           *
**                 A  ----------------------------------------------- *
**          WPLML     × MESSAGE LENGTH + 4 = × MCS FLAGS =          × *
**                    ----------------------------------------------- *
**                    × 'STARTINGS' ONE TO TSNAM# OF THEM           × *
**                 B  ----------------------------------------------- *
**                                                                    *
**                   WHEN CONNEXT  IS ON THEN:                        *
**                 A' ----------------------------------------------- *
**          WPL       × MESSAGE LENGTH + 4 = × MCS FLAGS =          × *
**                    ----------------------------------------------- *
**                    × 'STARTINGS' ONE TO TSNAM# OF THEM           × *
**                    ----------------------------------------------- *
**          WPLLS01   × LINE TYPE = × AREA ID = × NUMBER OF LINES = × *
**                 B' ----------------------------------------------- *
**********************************************************************/
*                                                                  0668
*LISTSO:                                                           0668
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0668
LISTSO   DS    0H                                                  0669
*   RFY                                                            0669
*     R14 RSTD;                                                    0669
*   LISTSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0670
*                                      PROC                          */
         ST    R14,LISTSAVE                                        0670
*   RFY                                                            0671
*     R14 UNRSTD;                                                  0671
*   TRCF8LTI=ON;                    /* MARK LISTSO PROC AS IN      0672
*                                      PROCESSING                    */
*   TRCF8LTE=ON;                    /* MARK LISTSO PROC AS ENTERED   */
         LA    @10,TRCURRSW                                        0673
         OI    TRCF8LTI(@10),B'00000011'                           0673
*   CSCBPTR=BACHN;                  /* BEGIN CSCB CHAIN              */
         L     @10,CVTPTR                                          0674
         L     @10,CVTMSER(,@10)                                   0674
         L     CSCBPTR,BACHN(,@10)                                 0674
*   MSGCTR=ZERO;                    /* INIT COUNTER                  */
         SLR   MSGCTR,MSGCTR                                       0675
*   DO WHILE CSCBPTR^=ZERO;                                        0676
         B     @DE00676                                            0676
@DL00676 DS    0H                                                  0677
*     IF CHTRKID='01'X THEN         /* IS THIS A TSO CSCB            */
         CLI   CHTRKID(CSCBPTR),X'01'                              0677
         BNE   @RF00677                                            0677
*       DO;                         /* YES                           */
*         IF MSGCTR=ZERO THEN       /* NEED NEW LINE ?               */
         LTR   MSGCTR,MSGCTR                                       0679
         BNZ   @RF00679                                            0679
*           DO;                     /* YES                           */
*             WPL(ONE:TSLLGTH)=TSLIST(ONE:TSLLGTH);/*        @YM01918*/
         SLR   @10,@10                                             0681
         IC    @10,TSLLGTH                                         0681
         BCTR  @10,0                                               0681
         EX    @10,@SM03176                                        0681
*             WPLSAVE=WPLPTR;       /* SAVE WPL ADDR THAT JUST FILLED*/
         ST    WPLPTR,WPLSAVE                                      0682
*           END;                                                   0683
*         TSNAMPTR=ADDR(TSID1)+     /* POSITION ON LINE              */
*             (LENGTH(TSID1)*MSGCTR);                              0684
@RF00679 LA    TSNAMPTR,TSID1(,WPLPTR)                             0684
         LR    @10,MSGCTR                                          0684
         MH    @10,@CH02881                                        0684
         ALR   TSNAMPTR,@10                                        0684
*         IF CHKEY^=BLANKS&CHKEY^=ZEROES THEN                      0685
         CLC   CHKEY(8,CSCBPTR),@CC02921                           0685
         BE    @RF00685                                            0685
         CLC   CHKEY(8,CSCBPTR),ZEROES                             0685
         BE    @RF00685                                            0685
*           TSID=CHKEY;             /* TS USERID                     */
         MVC   TSID(8,TSNAMPTR),CHKEY(CSCBPTR)                     0686
*         ELSE                      /* DEFAULT = STARTING            */
*           TSID=STARTING;                                         0687
         B     @RC00685                                            0687
@RF00685 MVC   TSID(8,TSNAMPTR),STARTING                           0687
*         ASCBENT=((CHASID*4)+ADDR(ASVTENTY)-4);/* ADDRESS USER'S  0688
*                                      ASCB                  @ZA07770*/
@RC00685 LH    ASCBENT,CHASID(,CSCBPTR)                            0688
         SLA   ASCBENT,2                                           0688
         L     @10,CVTPTR                                          0688
         L     @10,ASVTPTR(,@10)                                   0688
         LA    @10,ASVTENTY(,@10)                                  0688
         ALR   ASCBENT,@10                                         0688
         SL    ASCBENT,@CF00034                                    0688
*         IF ASCBOUT=ON THEN        /* IF USER IS SWAPPED OUT,     0689
*                                                            @ZA07770*/
         L     @10,ASVTASCB(,ASCBENT)                              0689
         TM    ASCBOUT(@10),B'00000100'                            0689
         BNO   @RF00689                                            0689
*           TSSWPIND=SWAPPED;       /* SHOW IT.              @ZA07770*/
         MVI   TSSWPIND(TSNAMPTR),C'S'                             0690
*         MSGCTR=MSGCTR+ONE;        /* INCREMENT ID COUNT PER LINE   */
@RF00689 AL    MSGCTR,@CF00042                                     0691
*         WPLMLLEN=(LENGTH(TSID1)*MSGCTR)+SIX;/* LENGTH MINOR LINE   */
         LA    @10,6                                               0692
         LR    @09,MSGCTR                                          0692
         MH    @09,@CH02881                                        0692
         ALR   @09,@10                                             0692
         STC   @09,WPLMLLEN(,WPLPTR)                               0692
*         IF MSGCTR=TSNAM# THEN     /* MAX ON THIS LINE ?            */
         CR    MSGCTR,@10                                          0693
         BNE   @RF00693                                            0693
*           DO;                     /* YES                           */
*             CALL NEXTWPL;         /* GET ADDR OF NEXT WPL          */
         BAL   @14,NEXTWPL                                         0695
*             MSGCTR=ZERO;          /* REINITIALIZE COUNTER          */
         SLR   MSGCTR,MSGCTR                                       0696
*           END;                                                   0697
*       END;                                                       0698
@RF00693 DS    0H                                                  0699
*     CSCBPTR=CHPTR;                /* POINT TO NEXT CSCB, IF 0      */
@RF00677 L     CSCBPTR,CHPTR(,CSCBPTR)                             0699
*   END;                            /* FULL THROUGH, END OF CHAIN    */
@DE00676 LTR   CSCBPTR,CSCBPTR                                     0700
         BNZ   @DL00676                                            0700
*   IF WPLSAVE=WPLPTR THEN          /* WAS WPLPTR UPDATED?           */
         C     WPLPTR,WPLSAVE                                      0701
         BNE   @RF00701                                            0701
*     CALL NEXTWPL;                 /* NO SO UPDATE IT               */
         BAL   @14,NEXTWPL                                         0702
*   TRCF8LTI=OFF;                   /* MARK LISTSO PROC AS CONTROL 0703
*                                      LEAVING                       */
@RF00701 LA    @10,TRCURRSW                                        0703
         NI    TRCF8LTI(@10),B'11111101'                           0703
*   RFY                                                            0704
*     R14 RSTD;                                                    0704
*   R14=LISTSAVE;                   /* RESTSORE RETURN ADDR TO     0705
*                                      DISPLAY PROC                  */
         L     R14,LISTSAVE                                        0705
*   RFY                                                            0706
*     R14 UNRSTD;                                                  0706
*   END LISTSO;                                                    0707
@EL00015 DS    0H                                                  0707
@EF00015 DS    0H                                                  0707
@ER00015 BR    @14                                                 0707
*                                                                  0708
*/*********************************************************************
**              N E X T W P L      P R O C E D U R E                  *
** ENTRY REASON - GET THE ADDR OF THE NEXT WPL TO BE USED.            *
** ENTRY FROM   - LISTJOBS PROCEDURE                                  *
**                FILLINE PROCEDURE                           @ZA07770*
**                LISTSO PROCEDURE                                    *
** EXIT  TO     - CALLING PROCEDURE                                   *
** FUNCTION     - 1) SAVE ADDR OF WPL JUST FILLED IN.                 *
**                2) INCREASE COUNT OF # LINES IN MLWTO               *
**                3) IF 1ST LINE IS A CONNECTING MLWTO THEN           *
**                   A) MARK AS A DATA LINE                           *
**                   B) GET ADDR OF NEXT WPL                          *
**                   C) RETURN                                        *
**                4) IF 2ND LINE IN CONNECTING MLWTO THEN MARK SWITCH *
**                   TO SHOW DONE WITH THE 2ND LINE.                  *
**                5) GET ADDR OF NEXT WPL                             *
**                6) IF CONNECTING MLWTO IS FULL, ADD IT TO THE LIST  *
**                   AND MARK SWITCH TO SHOW THAT IT IS STARTING WITH *
**                   A NEW CONNECTING MLWTO.                          *
**                7) RETURN                                           *
** NOTE         - MEANINGS OF SWITCHES CONNEXT AND CONEND             *
**                IN THIS PROCEDURE:                                  *
**                   CONNEXT = ON : JUST FILLED IN THE FIRST LINE OF  *
**                                  A GROUP OF MLWTOS                 *
**                           = OFF: JUST FILLED IN ANY LINE BUT THE   *
**                                  FIRST IN THE GROUP OF MLWTOS      *
**                   CONEND  = ON : JUST FILLED IN THE SECOND LINE OF *
**                                  A GROUP                           *
**                           = OFF: FILLED IN ANY LINE BUT THE SECOND *
**                                  IN A GROUP                        *
**                IN PROCEDURE LASTLINE:                              *
**                   CONNEXT = ON : THE LINE JUST FILLED IS THE TENTH *
**                                  LINE OF THE GROUP AND SHOULD BE   *
**                                  MARKED AS THE END LINE.           *
**                           = OFF: THE LINE FILLED IN IS ANY LINE BUT*
**                                  THE TENTH.                        *
**                   CONEND  = ON : THE LINE FILLED IN IS THE FIRST   *
**                                  LINE OF A GROUP.                  *
**                           = OFF: THE LAST LINE IS ANY BUT THE FIRST*
**                                  LINE OF A GROUP                   *
**                ANY WHERE ELSE :                                    *
**                   CONNEXT = ON : THE FIRST LINE OF A GROUP IS NEXT *
**                                  TO BE FILLED IN.                  *
**                   CONEND  = ON : THE SECOND LINE OF A GROUP IS NEXT*
**                                  TO BE FILLED IN.                  *
**********************************************************************/
*                                                                  0708
*   RFY                                                            0708
*     R14 RSTD;                                                    0708
*NEXTWPL:                                                          0709
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0709
NEXTWPL  DS    0H                                                  0710
*   NEXTSAVE=R14;                   /* SAVE RETURN ADDR              */
         ST    R14,NEXTSAVE                                        0710
*   RFY                                                            0711
*     R14 UNRSTD;                                                  0711
*   TRCFCNXI=ON;                    /* MARK NEXTWPL PROC AS IN     0712
*                                      PROCESSING                    */
*   TRCFCNXE=ON;                    /* MARK NEXTWPL PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0713
         OI    TRCFCNXI(@10),B'00000011'                           0713
*   WPLSAVE=WPLPTR;                 /* SAVE ADDR OF LAST WPL FILLED  */
         ST    WPLPTR,WPLSAVE                                      0714
*   COUNT=COUNT+ONE;                /* INCREASE COUNT OF # LINES IN
*                                      MLWTO                         */
         IC    @10,COUNT                                           0715
         LA    @10,1(,@10)                                         0715
         STC   @10,COUNT                                           0715
*   IF CONNEXT=ON THEN              /* PROCESSING 1ST LINE ?         */
         TM    CONNEXT,B'01000000'                                 0716
         BNO   @RF00716                                            0716
*     DO;                           /* YES                           */
*       WPLMCSFJ=ON;                /* MARK AS MLWTO LINE            */
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0718
*       WPLPTR=WPLPTR+WPLLGH;       /* MOVE POINTER TO FLAGS IN WPL  */
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0719
*       WPLLTFC=ON;                 /* MARK AS DATA LINE             */
         OI    WPLLTFC(WPLPTR),B'00100000'                         0720
*       WPLPTR=WPLPTR+LENGTH(WPLLS01);/* MOVE PTR TO NEXT WPL        */
         AL    WPLPTR,@CF00034                                     0721
*       CONNEXT=OFF;                /* DONE PROCESSING 1ST LINE      */
*       CONEND=ON;                  /* START PROCESSING 2ND LINE     */
         OI    CONEND,B'00100000'                                  0723
         NI    CONNEXT,B'10111111'                                 0723
*     END;                                                         0724
*   ELSE                                                           0725
*     DO;                                                          0725
         B     @RC00716                                            0725
@RF00716 DS    0H                                                  0726
*       WPLMLLTC=ON;                /* MARK AS DATA LINE             */
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0726
*       IF CONEND=ON THEN           /* PROCESSING 2ND LINE ?         */
         TM    CONEND,B'00100000'                                  0727
         BNO   @RF00727                                            0727
*         CONEND=OFF;               /* YES, DONE PROCESSING 2ND LINE */
         NI    CONEND,B'11011111'                                  0728
*       WPLPTR=WPLPTR+WPLMLLEN;     /* POINT TO NEXT LINE IN MLWTO   */
@RF00727 SLR   @10,@10                                             0729
         IC    @10,WPLMLLEN(,WPLPTR)                               0729
         ALR   WPLPTR,@10                                          0729
*       IF COUNT=TEN THEN           /* REACH MAX MLWTO LINES YET ?   */
         CLI   COUNT,10                                            0730
         BNE   @RF00730                                            0730
*         DO;                       /* YES                           */
*           CALL FINMLWTO;          /* PUT MLWTO ON LIST TO BE     0732
*                                      WRITTEN                       */
         BAL   @14,FINMLWTO                                        0732
*           CONNEXT=ON;             /* PROCESSING 1ST LINE           */
         OI    CONNEXT,B'01000000'                                 0733
*         END;                                                     0734
*     END;                                                         0735
@RF00730 DS    0H                                                  0736
*   TRCFCNXI=OFF;                   /* MARK NEXTWPL PROC AS CONTROL
*                                      LEAVING                       */
@RC00716 LA    @10,TRCURRSW                                        0736
         NI    TRCFCNXI(@10),B'11111101'                           0736
*   RFY                                                            0737
*     R14 RSTD;                                                    0737
*   R14=NEXTSAVE;                   /* RESTORE RETURN ADDR TO CALLING
*                                      PROC                          */
         L     R14,NEXTSAVE                                        0738
*   RFY                                                            0739
*     R14 UNRSTD;                                                  0739
*   END NEXTWPL;                                                   0740
@EL00016 DS    0H                                                  0740
@EF00016 DS    0H                                                  0740
@ER00016 BR    @14                                                 0740
*                                                                  0741
*/*********************************************************************
**               F I N M L W T O   P R O C E D U R E                  *
** ENTRY REASON - THE TEN LINES OF A MLWTO HAVE BEEN BUILT AND SHOULD *
**                NOW BE ADDED TO THE MLWTO LINKED LIST.              *
** ENTRY FROM   - NEXTWPL  PROCEDURE                                  *
**                LASTLINE PROCEDURE                                  *
** EXIT  TO     - THE PROCEDURE WHICH CALLED IT                       *
** FUNCTION     - 1) LINK THE MLWTO TO THE LIST                       *
**                2) FILL IN THE NUMBER OF LINES IN THIS MLWTO        *
**                3) FILL IN THE AREA ID OF WHERE TO WRITE THE DISPLAY*
**                4) RETURN                                           *
**********************************************************************/
*                                                                  0741
*FINMLWTO:                                                         0741
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/*                       @ZA07770*/
FINMLWTO DS    0H                                                  0742
*   RFY                                                            0742
*     R14 RSTD;                                                    0742
*   FINMSAVE=R14;                   /* SAVE RETURN ADDR OF CALLING 0743
*                                      PROC                          */
         ST    R14,FINMSAVE                                        0743
*   RFY                                                            0744
*     R14 UNRSTD;                                                  0744
*   TRCF7MLI=ON;                    /* MARK FINMLWTO PROC AS IN    0745
*                                      PROCESSING                    */
*   TRCF7MLE=ON;                    /* MARK FINMLWTO PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0746
         OI    TRCF7MLI(@10),B'00110000'                           0746
*   IF FIRSTIME=ON THEN             /* IS THIS THE 1ST MLWTO?      0747
*                                                            @ZA07770*/
         TM    FIRSTIME,B'00100000'                                0747
         BNO   @RF00747                                            0747
*     DO;                           /* YES.CONTROL LINE 1ST LINE   0748
*                                                            @ZA07770*/
*       TEMPLACE=WPLPTR;            /* SAVE ADDR OF NEXT MLWTO     0749
*                                                            @ZA07770*/
         LR    TEMPLACE,WPLPTR                                     0749
*       WPLPTR=BUFPTR+LINKLGTH;     /* POINT TO BEGINING OF BUFF   0750
*                                                            @ZA07770*/
         L     @10,BUFPTR                                          0750
         LA    @03,4                                               0750
         LR    WPLPTR,@10                                          0750
         ALR   WPLPTR,@03                                          0750
*       WPLPTR=WPLPTR+WPLLGH+FOUR;  /* MOVE TO END 1ST LINE  @ZA07770*/
         LR    @09,WPLPTR                                          0751
         AH    @09,WPLLGH(,WPLPTR)                                 0751
         ALR   @09,@03                                             0751
         LR    WPLPTR,@09                                          0751
*       LASTNODE=BUFPTR;            /* LAST NODE ON LIST IS BEG OF 0752
*                                      BUFF                  @ZA07770*/
         ST    @10,LASTNODE                                        0752
*       FIRSTIME=OFF;               /* NOT FIRST TIME ANYMORE      0753
*                                                            @ZA07770*/
         NI    FIRSTIME,B'11011111'                                0753
*     END;                          /*                       @ZA07770*/
*   ELSE                            /* NO, 1ST LINE IS DATA LINE   0755
*                                                            @ZA07770*/
*     DO;                           /*                       @ZA07770*/
         B     @RC00747                                            0755
@RF00747 DS    0H                                                  0756
*       TEMPLACE=WPLPTR;            /* SAVE ADDR OF WHERE TO START 0756
*                                      NEXT MLWTO            @ZA07770*/
         LR    TEMPLACE,WPLPTR                                     0756
*       WPLPTR=NEXTNODE+LINKLGTH;   /* POINT WPLPTR TO BEGINING OF 0757
*                                      FIRST LINE IN THIS MLWTO    0757
*                                                            @ZA07770*/
         L     @10,NEXTNODE                                        0757
         LA    WPLPTR,4                                            0757
         ALR   WPLPTR,@10                                          0757
*       LASTNODE->LINK=NEXTNODE;    /* LINK THIS NODE TO END OF LIST
*                                                            @ZA07770*/
         L     @09,LASTNODE                                        0758
         ST    @10,LINK(,@09)                                      0758
*       LASTNODE=NEXTNODE;          /* MAKE LASTNODE POINT TO THIS 0759
*                                      NODE                  @ZA07770*/
         ST    @10,LASTNODE                                        0759
*       WPLPTR=WPLPTR+WPLLGH;       /* MOVE TO END OF 1ST LINE     0760
*                                                            @ZA07770*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0760
*     END;                          /*                       @ZA07770*/
*   LASTNODE->LINK=ZERO;            /* MARK THIS NODE AS LAST      0762
*                                                            @ZA07770*/
@RC00747 L     @10,LASTNODE                                        0762
         SLR   @09,@09                                             0762
         ST    @09,LINK(,@10)                                      0762
*   WPLLINES=COUNT;                 /* NUMBER OF LINES IN MLWTO    0763
*                                                            @ZA07770*/
         IC    @10,COUNT                                           0763
         STC   @10,WPLLINES(,WPLPTR)                               0763
*   WPLAREA=TASKCSCB->CHARID;       /* GET AREA ID FOR CRT(Z=PAPER)
*                                                            @ZA07770*/
         L     @10,TASKCSCB                                        0764
         MVC   WPLAREA(1,WPLPTR),CHARID(@10)                       0764
*   NEXTNODE=TEMPLACE;              /* ADDR OF LINK OF NEXT NODE   0765
*                                                            @ZA07770*/
         ST    TEMPLACE,NEXTNODE                                   0765
*   WPLPTR=TEMPLACE+LINKLGTH;       /* SKIP OVER LINK FIELD. POINT TO
*                                      BEGINING OF NEXT NODE TO FILL.
*                                                            @ZA07770*/
         LA    WPLPTR,4                                            0766
         ALR   WPLPTR,TEMPLACE                                     0766
*   COUNT=ZERO;                     /* ZERO COUNT OF LINES FOR NEXT
*                                      MLWTO                 @ZA07770*/
         MVI   COUNT,X'00'                                         0767
*   TRCF7MLI=OFF;                   /* MARK FINMLWTO PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0768
         NI    TRCF7MLI(@10),B'11011111'                           0768
*   RFY                                                            0769
*     R14 RSTD;                                                    0769
*   R14=FINMSAVE;                   /* RESTORE RETURN ADDR OF CALLING
*                                      PROC                          */
         L     R14,FINMSAVE                                        0770
*   RFY                                                            0771
*     R14 UNRSTD;                                                  0771
*   END FINMLWTO;                   /*                       @ZA07770*/
@EL00017 DS    0H                                                  0772
@EF00017 DS    0H                                                  0772
@ER00017 BR    @14                                                 0772
*                                                                  0773
*/*********************************************************************
**               L A S T L I N E   P R O C E D U R E                  *
** ENTRY REASON - THE LAST LINE OF THE DISPLAY HAS BEEN BUILT SO FILL *
**                IN THE INFORMATION FOR THE LAST LINE OF A MLWTO.    *
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT  TO     - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) BACK UP AND MARK THE LAST LINE OF THE MLWTO AS   *
**                   THE END LINE.                                    *
**                2) PUT THE LAST MLWTO ON THE LIST                   *
**                3) RETURN                                           *
** NOTE         - IF CONNEXT  IS ON THEN NO NEED TO ADD THE CONNECTING*
**                MLWTO TO THE LIST SINCE IT HAS ALREADY BEEN ADDED.  *
**                                                                    *
**                FOR AN EXPLANATION OF SWITCHES CONNEXT AND CONEND   *
**                SEE THE PROLOG OF PROCEDURE NEXTWPL.                *
**********************************************************************/
*                                                                  0773
*LASTLINE:                                                         0773
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0773
LASTLINE DS    0H                                                  0774
*   RFY                                                            0774
*     R14 RSTD;                     /*                       @ZA07770*/
*   LASTSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0775
*                                      PROC                  @ZA07770*/
         ST    R14,LASTSAVE                                        0775
*   RFY                                                            0776
*     R14 UNRSTD;                   /*                       @ZA07770*/
*   TRCF9LLI=ON;                    /* MARK LASTLINE PROC AS IN    0777
*                                      PROCESSING                    */
*   TRCF9LLE=ON;                    /* MARK LASTLINE PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0778
         OI    TRCF9LLI(@10),B'00110000'                           0778
*   TEMPLACE=WPLPTR;                /* SAVE NEXT WPL LINE ADDR     0779
*                                                            @ZA07770*/
         LR    TEMPLACE,WPLPTR                                     0779
*   WPLPTR=WPLSAVE;                 /* GET ADDR OF LAST LINE FILLED
*                                      IN                    @ZA07770*/
         L     WPLPTR,WPLSAVE                                      0780
*   IF CONEND=ON THEN               /* 1ST LINE OF MLWTO WAS LAST? 0781
*                                                            @ZA07770*/
         TM    CONEND,B'00100000'                                  0781
         BNO   @RF00781                                            0781
*     DO;                           /* YES                   @ZA07770*/
*       WPLPTR=WPLPTR+WPLLGH;       /* ADJUST THE POINTER    @ZA07770*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0783
*       WPLLTFD=ON;                 /* MARK AS ENDLINE       @ZA07770*/
         OI    WPLLTFD(WPLPTR),B'00010000'                         0784
*     END;                          /*                       @ZA07770*/
*   ELSE                            /* MORE THAN ONE LINE IN MLWTO 0786
*                                                            @ZA07770*/
*     WPLMLLTD=ON;                  /* MARK AS ENDLINE       @ZA07770*/
         B     @RC00781                                            0786
@RF00781 OI    WPLMLLTD(WPLPTR),B'00010000'                        0786
*   WPLPTR=TEMPLACE;                /* RESTORE POINTER       @ZA07770*/
@RC00781 LR    WPLPTR,TEMPLACE                                     0787
*   IF CONNEXT=OFF THEN             /* HAS MLWTO BEEN ADDED TO THE 0788
*                                      LIST ?                        */
         TM    CONNEXT,B'01000000'                                 0788
         BNZ   @RF00788                                            0788
*     CALL FINMLWTO;                /* NO, SO ADD THE MLWTO TO THE 0789
*                                      LIST                  @ZA07770*/
         BAL   @14,FINMLWTO                                        0789
*   TRCF9LLI=OFF;                   /* MARK LASTLINE PROC AS CONTROL
*                                      LEAVING                       */
@RF00788 LA    @10,TRCURRSW                                        0790
         NI    TRCF9LLI(@10),B'11011111'                           0790
*   RFY                                                            0791
*     R14 RSTD;                     /*                       @ZA07770*/
*   R14=LASTSAVE;                   /* RESTORE RETURN ADDR TO DISPLAY
*                                      PROC                  @ZA07770*/
         L     R14,LASTSAVE                                        0792
*   RFY                                                            0793
*     R14 UNRSTD;                   /*                       @ZA07770*/
*   END LASTLINE;                                                  0794
@EL00018 DS    0H                                                  0794
@EF00018 DS    0H                                                  0794
@ER00018 BR    @14                                                 0794
*                                                                  0795
*/*********************************************************************
**                F R E E B U F   P R O C E D U R E                   *
** ENTRY REASON - TO FREE THE MLWTO LIST BUFFER                       *
** EXIT  TO     - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) FREE THE CORE GOTTEN FOR THE MLWTO LIST BUFFER   *
**                2) RETURN                                           *
**********************************************************************/
*                                                                  0795
*   RFY                                                            0795
*    (R1,                                                          0795
*     R2,                                                          0795
*     R14) RSTD;                                                   0795
*FREEBUF:                                                          0796
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0796
FREEBUF  DS    0H                                                  0797
*   FREESAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0797
*                                      PROC                          */
         ST    R14,FREESAVE                                        0797
*   RFY                                                            0798
*     R14 UNRSTD;                                                  0798
*   TRCFBFBI=ON;                    /* MARK FREEBUF PROC AS IN     0799
*                                      PROCESSING                    */
*   TRCFBFBE=ON;                    /* MARK FREEBUF PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0800
         OI    TRCFBFBI(@10),B'00110000'                           0800
*   R2=COREBYTE;                    /* PLACE LENGTH IN R2            */
         L     R2,COREBYTE                                         0801
*   R1=BUFPTR;                      /* PLACE BEGINNING ADDRESS IN R1 */
         L     R1,BUFPTR                                           0802
*   GEN SETS(R0,R1) REFS(R2)(FREEMAIN R,SP=229,LV=(2),A=(1));      0803
         FREEMAIN R,SP=229,LV=(2),A=(1)
*   TRCFBFBI=OFF;                   /* MARK FREEBUF PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0804
         NI    TRCFBFBI(@10),B'11011111'                           0804
*   RFY                                                            0805
*     R14 RSTD;                                                    0805
*   R14=FREESAVE;                   /* RESTORE RETURN ADDR OF DISPLAY
*                                      PROC                          */
         L     R14,FREESAVE                                        0806
*   RFY                                                            0807
*    (R1,                                                          0807
*     R2,                                                          0807
*     R14) UNRSTD;                                                 0807
*   END FREEBUF;                                                   0808
@EL00019 DS    0H                                                  0808
@EF00019 DS    0H                                                  0808
@ER00019 BR    @14                                                 0808
*                                                                  0809
*/*********************************************************************
**                 D Q C S C B   P R O C E D U R E                    *
** ENTRY REASON - TO DEQUEUE OFF THE CSCB CHAIN                       *
** ENTRY FROM   - DISPLAY PROCEDURE (AFTER THE MLWTO BUFFER IS FULL)  *
**                ISSUEMSG PROCEDURE(IF GETMAIN FAILED FOR THE BUFFER)*
** EXIT TO      - CALLING PROCEDURE                                   *
** FUNCTION     - 1) DEQUEUE OFF THE CSCB CHAIN                       *
**                2) RESTORE CSCBPTR TO THIS TASK'S CSCB ADDRESS      *
**                3) RETURN                                           *
**********************************************************************/
*                                                                  0809
*   RFY                                                            0809
*    (R1,                                                          0809
*     R14) RSTD;                                                   0809
*DQCSCB:                                                           0810
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0810
DQCSCB   DS    0H                                                  0811
*   DQCBSAVE=R14;                   /* SAVE RETURN ADDRESS OF CALLING
*                                      PROC                          */
         ST    R14,DQCBSAVE                                        0811
*   RFY                                                            0812
*     R14 UNRSTD;                                                  0812
*   TRCF9DQI=ON;                    /* MARK DQCSCB PROC AS IN      0813
*                                      PROCESSING                    */
*   TRCF9DQE=ON;                    /* MARK DQCSCB PROC AS ENTERED   */
         LA    @10,TRCURRSW                                        0814
         OI    TRCF9DQI(@10),B'00000011'                           0814
*   ENQDEQL(1:DLEN)=DDEQ(1:DLEN);   /* BUILD DEQ LIST                */
         LH    @10,DLEN                                            0815
         BCTR  @10,0                                               0815
         EX    @10,@SM03178                                        0815
*   R1=ADDR(ENQDEQL);               /* WITH REG 1 ADDRESSING IT      */
         LA    R1,ENQDEQL                                          0816
*   GEN(DEQ ,MF=(E,(1)));           /* DEQ FROM THE CSCB CHAIN       */
         DEQ ,MF=(E,(1))
*   CSCBPTR=CSCBPASS;               /* RESTORE THIS TASK'S CSCB    0818
*                                      ADDRESS                       */
         LA    @10,STAELIST                                        0818
         L     CSCBPTR,CSCBPASS(,@10)                              0818
*   TRCF9DQI=OFF;                   /* MARK FLAG AS CONTROL LEAVING
*                                      DQCSCB PROC                   */
         LA    @10,TRCURRSW                                        0819
         NI    TRCF9DQI(@10),B'11111101'                           0819
*   RFY                                                            0820
*     R14 RSTD;                                                    0820
*   R14=DQCBSAVE;                   /* RESTORE RETURN ADDR OF CALLING
*                                      PROC                          */
         L     R14,DQCBSAVE                                        0821
*   RFY                                                            0822
*    (R1,                                                          0822
*     R14) UNRSTD;                                                 0822
*   END DQCSCB;                                                    0823
@EL00020 DS    0H                                                  0823
@EF00020 DS    0H                                                  0823
@ER00020 BR    @14                                                 0823
*                                                                  0824
*/*********************************************************************
**                 C A L L 8 0 1   P R O C E D U R E                  *
** ENTRY REASON - THE MLWTO LIST IS FINISHED AND THEY SHOULD BE ISSUED*
** ENTRY FROM   - DISPLAY PROCEDURE                                   *
** EXIT  TO     - DISPLAY PROCEDURE                                   *
** FUNCTION     - 1) POINT TO BEGINNING OF BUFFER                     *
**                2) LOOP THROUGH LIST UNTIL THE MLWTO IS ISSUED.     *
**                3) IF A NON-ZERO RETURN CODE FROM IEECB801 IS FOUND *
**                   THEN THE LOOPING IS STOPPED.                     *
**                4) RETURN                                           *
**********************************************************************/
*                                                                  0824
*CALL801:                                                          0824
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0824
CALL801  DS    0H                                                  0825
*   RFY                                                            0825
*    (R1,                                                          0825
*     R14) RSTD;                                                   0825
*   CALLSAVE=R14;                   /* SAVE RETURN ADDR TO DISPLAY 0826
*                                      PROC                  @ZA07770*/
         ST    R14,CALLSAVE                                        0826
*   RFY                                                            0827
*     R14 UNRSTD;                                                  0827
*   TRCFACLI=ON;                    /* MARK CALL801 PROC AS IN     0828
*                                      PROCESSING                    */
*   TRCFACLE=ON;                    /* MARK CALL801 PROC AS ENTERED  */
         LA    @10,TRCURRSW                                        0829
         OI    TRCFACLI(@10),B'00110000'                           0829
*   R1=ADDR(PARMLIST);              /* PARMLIST TO IEECB801          */
         LA    R1,PARMLIST                                         0830
*   LINKPTR=BUFPTR;                 /* POINT TO 1ST MLWTO IN BUF   0831
*                                                            @ZA07770*/
         L     LINKPTR,BUFPTR                                      0831
*   FIRSTIME=ON;                    /* 1ST MLWTO HAS A CONTROL LINE.
*                                      IEECB801 WILL TURN FLAG OFF 0832
*                                                            @ZA07770*/
*                                                                  0832
         OI    FIRSTIME,B'00100000'                                0832
*   /*****************************************************************/
*   /*                                                               */
*   /* WPLPTR POINTS TO THE BEGINING OF THE MLWTO. LINKPTR HAS THE   */
*   /* ADDR OF THE LINK FIELD OF THE MLWTO. IF LINKPTR=ZERO THEN THE */
*   /* LIST OF MLWTOS HAS BEEN WRITTEN OR AN ERROR WAS FOUND BY      */
*   /* IEECB801 AND NO MORE MLWTOS SHOULD BE WRITTEN.                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*   DO WHILE LINKPTR^=ZERO;         /*                       @ZA07770*/
         B     @DE00833                                            0833
@DL00833 DS    0H                                                  0834
*     WPLPTR=LINKPTR+LINKLGTH;      /* POINT TO NEXT MLWTO TO ISSUE  */
         LA    WPLPTR,4                                            0834
         ALR   WPLPTR,LINKPTR                                      0834
*     MESSADDR=WPLPTR;              /* ADDR OF MLWTO TO WRITE      0835
*                                                            @ZA07770*/
         ST    WPLPTR,MESSADDR                                     0835
*     TRCFACBI=ON;                  /* MARK IEECB801 AS IN PROCESSING*/
*     TRCFACBE=ON;                  /* MARK IEECB801 AS ENTERED      */
         LA    @10,TRCURRSW                                        0837
         OI    TRCFACBI(@10),B'00000011'                           0837
*     CALL IEECB801;                /* WRITE MLWTO           @ZA07770*/
         L     @15,@CV02746                                        0838
         BALR  @14,@15                                             0838
*     TRCFACBI=OFF;                 /* MARK IEECB801 AS CONTROL HAS
*                                      COME BACK                     */
         LA    @10,TRCURRSW                                        0839
         NI    TRCFACBI(@10),B'11111101'                           0839
*     IF RETCODE=ZERO THEN          /* ANY ERRORS FOUND      @ZA07770*/
         L     @10,RETCODE                                         0840
         LTR   @10,@10                                             0840
         BNZ   @RF00840                                            0840
*       LINKPTR=LINKPTR->LINK;      /* NO,POINT TO NEXT NODE @ZA07770*/
         L     LINKPTR,LINK(,LINKPTR)                              0841
*     ELSE                          /* YES,THERE WAS AN ERROR      0842
*                                                            @ZA07770*/
*       LINKPTR=ZERO;               /* ERROR SO STOP WRITING @ZA07770*/
         B     @RC00840                                            0842
@RF00840 SLR   LINKPTR,LINKPTR                                     0842
*   END;                            /* END OF DO WHILE       @ZA07770*/
@RC00840 DS    0H                                                  0843
@DE00833 LTR   LINKPTR,LINKPTR                                     0843
         BNZ   @DL00833                                            0843
*   TRCFACLI=OFF;                   /* MARK CALL801 PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0844
         NI    TRCFACLI(@10),B'11011111'                           0844
*   RFY                                                            0845
*     R14 RSTD;                                                    0845
*   R14=CALLSAVE;                   /* RESTORE RETURN ADDR OF DISPLAY
*                                      PROC                          */
         L     R14,CALLSAVE                                        0846
*   RFY                                                            0847
*    (R1,                                                          0847
*     R14) UNRSTD;                                                 0847
*   END CALL801;                                                   0848
@EL00021 DS    0H                                                  0848
@EF00021 DS    0H                                                  0848
@ER00021 BR    @14                                                 0848
*                                                                  0849
*/*********************************************************************
**                   W A I T   P R O C E D U R E                      *
** ENTRY REASON - WAIT ON ECBS UNTIL NEXT TRACK UPDATE OR A STOP TRACK*
**                IS WANTED                                           *
** ENTRY FROM   - 1) TOP PROCEDURE                                    *
**                   A) A DISPLAY FOR A TRACK COMMAND HAS JUST        *
**                      FINISHED SO WAIT UNTIL THE TIME INTERVAL FOR  *
**                      THE NEXT UPDATE IS UP                         *
**                   B) IN HOLD MODE SO DISPLAY MAY NOT BE UPDATED    *
**                   C) PREVIOUS DISPLAY NOT FINISHED YET SO NO       *
**                      UPDATE IS POSSIBLE                            *
** EXIT  TO     - LABEL AWAKE IN THE TOP PROCEDURE                    *
** FUNCTION     - 1) WAIT ON ONE OF TWO ECBS                          *
**                   A) ONE IS THE UPDATE TIME INTERVAL ECB           *
**                   B) THE OTHER IS POSTED IF A STOPTR COMMAND IS    *
**                      ISSUED, OR IF A K D,U COMMAND WAS ISSUED OR   *
**                      IF DIDOCS OR CONSOLE CLOSE WANTS THE TRACK    *
**                      TO STOP.                                      *
**                2) RETURN TO LABEL AWAKE IN THE TOP PROCEDURE TO SEE*
**                   WHY AN ECB WAS POSTED                            *
**********************************************************************/
*                                                                  0849
*   RFY                                                            0849
*     R1 RSTD;                                                     0849
*WAIT:                                                             0850
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0850
WAIT     DS    0H                                                  0851
*   TRCF3WTI=ON;                    /* MARK WAIT PROC AS IN        0851
*                                      PROCESSING                    */
*   TRCF3WTE=ON;                    /* MARK WAIT PROC AS ENTERED     */
         LA    @10,TRCURRSW                                        0852
         OI    TRCF3WTI(@10),B'00110000'                           0852
*   ECB1=ADDR(STIMECB);             /* BUILD ECB LIST                */
         LA    @10,STAELIST                                        0853
         LA    @10,STIMECB(,@10)                                   0853
         ST    @10,ECB1                                            0853
*   ECB2=ADDR(CHCECB);                                             0854
         LA    @10,CHCECB(,CSCBPTR)                                0854
         ST    @10,ECB2                                            0854
*   ECB2=ECB2×HIMASK;               /* MARK LAST ECB ON LIST         */
         O     @10,HIMASK                                          0855
         ST    @10,ECB2                                            0855
*   R1=ADDR(ECBS);                  /* ADDR OF LIST IN R1            */
         LA    R1,ECBS                                             0856
*   GEN SETS(R0,R1)(WAIT 1,ECBLIST=(1));/* WAIT TO BE POSTED         */
         WAIT 1,ECBLIST=(1)
*   TRCF3WTI=OFF;                   /* MARK WAIT PROC AS CONTROL   0858
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0858
         NI    TRCF3WTI(@10),B'11011111'                           0858
*   TRPREVSW=TRCURRSW;              /* SAVE TRACE SWITCHES           */
         MVC   TRPREVSW(14),TRCURRSW                               0859
*   TRCFLAGS=TRCFLAGS&&TRCFLAGS;    /* RESET CHANGABLE SWITCHES      */
         XC    TRCFLAGS(12,@10),TRCFLAGS(@10)                      0860
*   RETURN TO AWAKE;                /* FIND OUT WHY POSTED AND ACT 0861
*                                      ACCORDINGLY                   */
         LA    @14,AWAKE                                           0861
@EL00022 DS    0H                                                  0861
@EF00022 DS    0H                                                  0861
@ER00022 BR    @14                                                 0861
*   RFY                                                            0862
*     R1 UNRSTD;                                                   0862
*   END WAIT;                                                      0863
*                                                                  0864
*/*********************************************************************
**               T I M E S N A P   P R O C E D U R E                  *
** ENTRY REASON - TO GET A TIME STAMP FOR AN OUTPUT LINE              *
** ENTRY FROM   - 1) TRACK PROCEDURE (FILL IN FOR NO TR UPDATE MSG)   *
**                2) HEADERLN PROCEDURE (FILL IN FOR INSUFFICIENT     *
**                   STORAGE MESSAGE)                                 *
**                3) HEADERLN PROCEDURE (FILL IN FOR DISPLAY HEADER)  *
** EXIT TO      - 1) CALLING PROCEDURE IF NO ERROR FOUND              *
**                2) IF AN ERROR IS FOUND, CONTROL IS PASSED TO       *
**                   LABEL NOTIME IN THIS PROCEDURE.                  *
** FUNCTION     - 1) ISSUE THE TIME MACRO                             *
**                   A) IF IN ERROR, GO TO LABEL NOTIME.              *
**                2) UNPACK THE TIME                                  *
**                3) INSERT THE TIME INTO MESSAGE TEXT                *
**                   A) IEE102I HH.MM.SS YY.DDD ACTIVITY              *
**                      IEE921I NO TR UPDATE AT HH.MM.SS YY.DDD       *
**                   B) THE BUFFERS CONTAINING THE ABOVE MESSAGES ARE *
**                      MAPPED BY DSECT 'CLWTO' BASED ON WPLPTR.      *
**                      FOR MSG IEE921I, WPLPTR MUST BE ADVANCED 16   *
**                      BYTES TO MAP IN HRS, MIN, SEC  PROPERLY       *
**                4) UNPACK THE DATE                                  *
**                5) INSERT THE DATE INTO THE MESSAGE TEXT            *
**********************************************************************/
*                                                                  0864
*   RFY                                                            0864
*     R14 RSTD;                                                    0864
*TIMESNAP:                                                         0865
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0865
TIMESNAP DS    0H                                                  0866
*   TIMESAVE=R14;                   /* SAVE RETURN ADDR OF CALLING 0866
*                                      PROCEDURE                     */
         ST    R14,TIMESAVE                                        0866
*   RFY                                                            0867
*     R14 UNRSTD;                                                  0867
*   TRCF2TMI=ON;                    /* MARK TIMESNAP PROC AS IN    0868
*                                      PROCESSING                    */
*   TRCF2TME=ON;                    /* MARK TIMESNAP PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0869
         OI    TRCF2TMI(@10),B'00000011'                           0869
*   GEN SETS(R0,R1,R15) FLOWS(NOTIME)(TIME DEC,ERRET=NOTIME);      0870
         TIME DEC,ERRET=NOTIME
*   RFY                                                            0871
*    (R0,                                                          0871
*     R1) RSTD;                                                    0871
*   SAVETIME=R0;                    /* SAVE TIME STAMP VALUE         */
         STCM  R0,15,SAVETIME                                      0872
*   RESPECIFY                                                      0873
*    (R0) UNRESTRICTED;                                            0873
*   UNPK(UNPACK(1:8),SAVETIME(1:4));/* UNPACK TIME VALUE             */
         UNPK  UNPACK(8),SAVETIME(4)                               0874
*   HRS=HOURS;                      /* FILL IN HOURS                 */
         MVC   HRS(2,WPLPTR),HOURS                                 0875
*   MIN=MINUTES;                    /* FILL IN MINUTES               */
         MVC   MIN(2,WPLPTR),MINUTES                               0876
*   SEC=SECONDS;                    /* FILL IN SECONDS               */
         MVC   SEC(2,WPLPTR),SECONDS                               0877
*   SAVEDATE=R1;                    /* SAVE THE PACKED FORM OF THE 0878
*                                      DATE                          */
         STCM  R1,15,SAVEDATE                                      0878
*   RFY                                                            0879
*     R1 UNRSTD;                                                   0879
*   UNPK(UNPACK(1:8),DATEAREA(2:5));/* UNPACK THE DATE               */
         UNPK  UNPACK(8),DATEAREA+1(4)                             0880
*   CLYEAR=YEAR;                    /* PUT THE YEAR IN THE MESSAGE 0881
*                                      TEXT                          */
         MVC   CLYEAR(2,WPLPTR),YEAR                               0881
*   CLDAY=DAY;                      /* PUT THE DAY IN THE MESSAGE  0882
*                                      TEXT                          */
         MVC   CLDAY(3,WPLPTR),DAY                                 0882
*NOTIME:                                                           0883
*   ;                                                              0883
NOTIME   DS    0H                                                  0884
*   TRCF2TMI=OFF;                   /* MARK TIMESNAP PROC AS CONTROL
*                                      LEAVING                       */
         LA    @10,TRCURRSW                                        0884
         NI    TRCF2TMI(@10),B'11111101'                           0884
*   RFY                                                            0885
*     R14 RSTD;                                                    0885
*   R14=TIMESAVE;                   /* RESTORE RETURN ADDR OF CALLING
*                                      PROCEDURE                     */
         L     R14,TIMESAVE                                        0886
*   RFY                                                            0887
*     R14 UNRSTD;                                                  0887
*   END TIMESNAP;                                                  0888
@EL00023 DS    0H                                                  0888
@EF00023 DS    0H                                                  0888
@ER00023 BR    @14                                                 0888
*                                                                  0889
*/*********************************************************************
**               C V D C O U N T   P R O C E D U R E                  *
** ENTRY REASON - TO CONVERT NUMBERS INTO PRINTABLE FORM AND INSERT   *
**                THEM INTO THE MESSAGE TEXT.                         *
** ENTRY FROM   - 1) JOBLINE PROCEDURE (2 PLACES)                     *
**                   A) FOR THE NUMBER OF JOBS                        *
**                   B) FOR THE NUMBER OF INITIATORS                  *
**                2) JOBLFILL PROCEDURE (2 PLACES)                    *
**                   A) FOR THE STARTING ADDRESS OF THE REGION        *
**                   B) FOR THE ENDING ADDRESS OF THE REGION          *
**                3) TSVTMLIN PROCEDURE                               *
**                   A) FILL IN MAX NUMBER OF VTAM TSO USERS  @ZA07770*
**                4) FILLINE PROCEDURE                                *
**                   A) FILL IN THE NUMBER OF ACTIVE TSO USERS OR TO  *
**                      FILL IN THE NUMBER OF ACTIVE VTAM TSO USERS   *
**                                                            @ZA07770*
**                5) STAEFAIL PROCEDURE                               *
**                   A) FILL IN CONSOLE ID FOR MESSAGE                *
** EXIT  TO     - CALLING PROCEDURE                                   *
** FUNCTION     - 1) CONVERT THE NUMBER TO DECIMAL                    *
**                2) UNPACK IT INTO THE MESSAGE                       *
**                3) MAKE LAST DIGIT A VALID NUMBER                   *
**                4) RETURN                                           *
** NOTE         - ON ENTRY:                                           *
**                   R6 - CONTAINS THE ADDRESS WITHIN THE BUFFER OF   *
**                        WHERE THE RESULTING VALUE IS TO BE PLACED.  *
**                   R7 - CONTAINS THE NUMBER TO BE CONVERTED.        *
**********************************************************************/
*                                                                  0889
*CVDCOUNT:                                                         0889
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0889
CVDCOUNT DS    0H                                                  0890
*   RESPECIFY                                                      0890
*    (R6,                                                          0890
*     R7,                                                          0890
*     R14) RSTD;                                                   0890
*   TRCF6CVI=ON;                    /* MARK CVDCOUNT PROC AS IN    0891
*                                      PROCESSING                    */
*   TRCF6CVE=ON;                    /* MARK CVDCOUNT PROC AS ENTERED */
         LA    @15,TRCURRSW                                        0892
         OI    TRCF6CVI(@15),B'00110000'                           0892
*   CVD(R7,UNPACK);                 /* CONVERT THE VALUE TO DECIMAL  */
         CVD   R7,UNPACK                                           0893
*   UNPK(CONVERT(4:8),UNPACK(4:8)); /* UNPACK THE VALUE              */
         UNPK  CONVERT+3(5,R6),UNPACK+3(5)                         0894
*   GEN REFS(R6)(OI 7(R6),X'F0');   /* MAKE LAST DIGIT VALID NUMBER  */
         OI 7(R6),X'F0'
*   TRCF6CVI=OFF;                   /* MARK CVDCOUNT PROC AS CONTROL
*                                      LEAVING                       */
         LA    @15,TRCURRSW                                        0896
         NI    TRCF6CVI(@15),B'11011111'                           0896
*   RFY                                                            0897
*    (R6,                                                          0897
*     R7,                                                          0897
*     R14) UNRSTD;                                                 0897
*   END CVDCOUNT;                                                  0898
@EL00024 DS    0H                                                  0898
@EF00024 DS    0H                                                  0898
@ER00024 BR    @14                                                 0898
*                                                                  0899
*/*********************************************************************
**               F I N D S A C B    P R O C E D U R E                 *
** ENTRY REASON - TO FIND TRACKS SCREEN AREA CONTROL BLOCK            *
** ENTRY FROM   - 1) TRACK PROCEDURE (FOR EVERY TIME THROUGH TRACK)   *
**                2) STAEFAIL PROCEDURE (ESTAE CREATED BY IEECB860    *
**                   FAILED OR ESTAE FOR TRACK CMD FAILED.)           *
** EXIT  TO     - CALLING PROCEDURE                                   *
** FUNCTION     - 1) FIND TRACKS SACB (SCREEN AREA CONTROL BLOCK)     *
**                2) SAVE ITS ADDRESS IN THE ESTAE PARMLIST(STAELIST) *
**                3) RETURN                                           *
**********************************************************************/
*                                                                  0899
*   RFY                                                            0899
*     R14 RSTD;                                                    0899
*FINDSACB:                                                         0900
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0900
FINDSACB DS    0H                                                  0901
*   TRCF2FSI=ON;                    /* MARK FINDSACB PROC AS IN    0901
*                                      PROCESSING                    */
*   TRCF2FSE=ON;                    /* MARK FINDSACB PROC AS ENTERED */
         LA    @15,TRCURRSW                                        0902
         OI    TRCF2FSI(@15),B'00110000'                           0902
*   DISPLACE=UCMVEZ*(CHCNID-ONE);   /* INDEX TO UCME                 */
         L     @15,CVTPTR                                          0903
         L     @15,UCMBASPT(,@15)                                  0903
         SLR   DISPLACE,DISPLACE                                   0903
         IC    DISPLACE,CHCNID(,CSCBPTR)                           0903
         BCTR  DISPLACE,0                                          0903
         LR    @01,DISPLACE                                        0903
         M     @00,UCMVEZ(,@15)                                    0903
         LR    DISPLACE,@01                                        0903
*   UCMDVEPT=UCMVEA+DISPLACE;       /* PROPER UCME ADDRESS           */
         LR    UCMDVEPT,DISPLACE                                   0904
         AL    UCMDVEPT,UCMVEA(,@15)                               0904
*   SACBPTR=DCMADSDS;               /* FIRST SACB ADDRESS            */
         L     @15,DCMTSPTR(,UCMDVEPT)                             0905
         L     SACBPTR,DCMADSDS(,@15)                              0905
*   SACBPRES=OFF;                   /* NO SACB FOUND YET             */
         NI    SACBPRES,B'11110111'                                0906
*   DO WHILE(SACBPTR^=ZERO&SACBPRES=OFF);/* LOOP TIL END OF CHAIN OR
*                                      FIND SACB                     */
         B     @DE00907                                            0907
@DL00907 DS    0H                                                  0908
*     IF DCMAID=CHARID THEN         /* TRACKS SACB ?                 */
         CLC   DCMAID(1,SACBPTR),CHARID(CSCBPTR)                   0908
         BNE   @RF00908                                            0908
*       SACBPRES=ON;                /* YES                           */
         OI    SACBPRES,B'00001000'                                0909
*     ELSE                                                         0910
*       SACBPTR=DCMACBNX;           /* NEXT SACB                     */
         B     @RC00908                                            0910
@RF00908 L     SACBPTR,DCMACBNX(,SACBPTR)                          0910
*   END;                                                           0911
@RC00908 DS    0H                                                  0911
@DE00907 LTR   SACBPTR,SACBPTR                                     0911
         BZ    @DC00907                                            0911
         TM    SACBPRES,B'00001000'                                0911
         BZ    @DL00907                                            0911
@DC00907 DS    0H                                                  0912
*   IF SACBPRES=OFF THEN            /* WAS THE SACB FOUND ?          */
         TM    SACBPRES,B'00001000'                                0912
         BNZ   @RF00912                                            0912
*     SACBPTR=ZERO;                 /* NO                            */
         SLR   SACBPTR,SACBPTR                                     0913
*   SACBADDR=SACBPTR;               /* SAVE ADDRESS OF SACB          */
@RF00912 LA    @15,STAELIST                                        0914
         ST    SACBPTR,SACBADDR(,@15)                              0914
*   TRCF2FSI=OFF;                   /* MARK FINDSACB PROC AS CONTROL
*                                      LEAVING                       */
         LA    @15,TRCURRSW                                        0915
         NI    TRCF2FSI(@15),B'11011111'                           0915
*   RFY                                                            0916
*     R14 UNRSTD;                                                  0916
*   END FINDSACB;                                                  0917
@EL00025 DS    0H                                                  0917
@EF00025 DS    0H                                                  0917
@ER00025 BR    @14                                                 0917
*                                                                  0918
*/*********************************************************************
**               L O C K S O F F   P R O C E D U R E                  *
** ENTRY REASON - RELEASE THE CMS AND LOCAL LOCKS                     *
** ENTRY FROM   - 1) TRACK PROCEDURE (3 CALLS)                        *
**                   A) ECB WAS POSTED BY DIDOCS                      *
**                   B) ECB WAS POSTED FOR A STOP TRACK               *
**                   C) DONE IF IN HOLD MODE OR NO TR UPDATE OR A     *
**                      DISPLAY IS WANTED                             *
**                2) STAEFAIL                                         *
** EXIT  TO     - CALLING PROCEDURE                                   *
** FUNCTION     - 1) SAVE REGISTERS                                   *
**                2) RELEASE CMS LOCK                                 *
**                3) RELEASE LOCAL LOCK                               *
**                4) RESTORE REGS                                     *
**                5) RETURN                                           *
** NOTE         - REGISTER 12 MUST BE SAVED SEPARATELY BECAUSE IT IS  *
**                THE BASE REGISTER FOR 'LOCKSAVE'                    *
**********************************************************************/
*                                                                  0918
*LOCKSOFF:                                                         0918
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0918
LOCKSOFF DS    0H                                                  0919
*   RFY                                                            0919
*     R14 RSTD;                                                    0919
*   TRCF1LKI=ON;                    /* MARK LOCKSOFF PROC AS IN    0920
*                                      PROCESSING                    */
*   TRCF1LKE=ON;                    /* MARK LOCKSOFF PROC AS ENTERED */
         LA    @15,TRCURRSW                                        0921
         OI    TRCF1LKI(@15),B'00000011'                           0921
*   GENERATE SETS(LOCKSAVE,R6) REFS(R11,R12,R14);                  0922
         STM     R11,R14,LOCKSAVE SAVE REGISTERS ACROSS SETLOCK
         LR      R6,R12           SAVE DATA REGISTER
         SETLOCK RELEASE,TYPE=CMS,                                     X
               RELATED=(SACB,IEECB800(TRACK,STAEFAIL))
         SETLOCK RELEASE,TYPE=LOCAL,                                   X
               RELATED=(SACB,IEECB800(TRACK,STAEFAIL))
         LR      R12,R6           RESTORE DATA REGISTER
         LM      R11,R14,LOCKSAVE RESTORE REGISTERS
*   TRCF1LKI=OFF;                   /* MARK LOCKSOFF PROC AS CONTROL
*                                      LEAVING                       */
         LA    @15,TRCURRSW                                        0923
         NI    TRCF1LKI(@15),B'11111101'                           0923
*   RFY                                                            0924
*     R14 UNRSTD;                                                  0924
*   END LOCKSOFF;                                                  0925
@EL00026 DS    0H                                                  0925
@EF00026 DS    0H                                                  0925
@ER00026 BR    @14                                                 0925
*                                                                  0926
*/*********************************************************************
**           T I M E P O P   P R O C E D U R E                        *
**   THIS ROUTINE RECEIVES CONTROL WHEN THE STIMER EXPIRES.   @YM8271P*
**   IT RECEIVES CONTROL UNDER THE IRB SCHEDULED BY THE       @YM8271P*
**   STIMER. AT THIS POINT IEECB800 MUST RESTORE ITS          @YM8271P*
**   ADDRESSIBILITY AND WAKE ITSELF UP BY POSTING ITS OWN     @YM8271P*
**   ECB.                                                     @YM8271P*
**       1. REGISTER 15 HAS THE ADDRESS OF TIMEPOP. IT WILL   @YM8271P*
**          BE USED AS THE BASE REGISTER.                     @YM8271P*
**       2. LOCATE TRACKS'S SCB BY SCANNING THE SCB CHAIN.    @YM8271P*
**          COMPARE THE SCBEXIT ADDRESS WITH THE STAEXIT      @YM8271P*
**          ADDRESS. WHEN THEY ARE EQUAL ITS THE TRACK SCB.   @YM8271P*
**       3. LOCATE THE ECB IN THE STAE PARAMETER LIST.        @YM8271P*
**       4. POST IT.                                          @YM8271P*
**       5. RETURN TO THE SUPERVISOR TO ELIMINATE THE IRB AND @YM8271P*
**          GIVE RETURN TO IEECB800 AT ITS WAIT. INSIDE THE   @YM8271P*
**          PROCDEURE WAIT.                                           *
**       6. IF THE SCB CAN NOT BE LOCATED RETURN TO THE       @YM8271P*
**          SUPERVISOR.                                       @YM8271P*
**       7. DROP REGISTER 15 AS THE BASE REGISTER.            @YM8271P*
**********************************************************************/
*                                                                  0926
*TIMEPOP:                                                          0926
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0926
TIMEPOP  DS    0H                                                  0927
*   RFY                                                            0927
*    (R1,                                                          0927
*     R6,                                                          0927
*     R14,                                                         0927
*     R15) RSTD;                                                   0927
*   GEN REFS(R4,R15);                                              0928
         DROP  R4                PERMIT TIMER ROUTINE ADDRESSABILITY
         USING *,R15             ESTABLISH ROUTINE ADDRESSABILITY
*   R6=ADDR(STAEXIT);               /* TRACK STAE EXIT ADDRESS     0929
*                                                            @YM8271P*/
         LA    R6,STAEXIT                                          0929
*   R1=ADDR(SCB);                   /* FIND 1ST SCB          @YM8271P*/
         L     @10,CVTPTR                                          0930
         L     @10,CVTTCBP(,@10)                                   0930
         L     @10,TCBPTR(,@10)                                    0930
         L     R1,SCBPTR(,@10)                                     0930
*   DO WHILE R1^=ZERO;              /* SCAN SCB CHAIN        @YM8271P*/
         B     @DE00931                                            0931
@DL00931 DS    0H                                                  0932
*     IF R1->SCBEXIT=R6 THEN        /* IF TRACK              @YM8271P*/
         C     R6,SCBEXIT(,R1)                                     0932
         BNE   @RF00932                                            0932
*       DO;                         /* SCB THEN:             @YM8271P*/
*         R1=R1->SCBPARM;           /* ADDRESS OF STAE PARMLIST    0934
*                                                            @ZA05507*/
         L     R1,SCBPARM(,R1)                                     0934
*         R1=ADDR(R1->STIMECB);     /* ADDRESS OF THE ECB IN SCB     */
         LA    @10,STIMECB(,R1)                                    0935
         LR    R1,@10                                              0935
*         GEN SETS(R0,R1) REFS(R14) EXIT NOSEQFLOW;                0936
*                                           /*POST WITH CODE OF 4    */
         POST (1),4             POST WITH CODE OF FOUR
         BR   R14               RETURN TO THE SUPERVISOR SO THAT THE   X
                                IRB WILL BE ELIMINATED TO ALLOW THE
*                               MAIN LINE TO RECEIVE CONTROL.
*       END;                        /*                       @YM8271P*/
*     ELSE                          /*                       @YM8271P*/
*       R1=R1->SCBCHAIN;            /* ADDR NEXT SCB         @YM8271P*/
@RF00932 L     R1,SCBCHAIN(,R1)                                    0938
*   END;                            /*                       @YM8271P*/
@DE00931 LTR   R1,R1                                               0939
         BNZ   @DL00931                                            0939
*   GEN REFS(R4,R14,R15) EXIT NOSEQFLOW;                           0940
         BR   R14              NONE FOUND,SO RETURN
         DROP R15              RESTORE R11 AS BASE REG       @YM8271P*/
         USING @PSTART+4095,R4 RESTORE R4 AS SECONDARY BASE REG
*   RFY                                                            0941
*    (R1,                                                          0941
*     R6,                                                          0941
*     R14,                                                         0941
*     R15) UNRSTD;                                                 0941
*   END TIMEPOP;                                                   0942
*                                                                  0943
*/*********************************************************************
**                                                                    *
**             S T A E X I T    E N T R Y     P O I N T               *
**                                                                    *
**     THIS ROUTINE IN GIVEN CONTROL AS THE RESULT OF AN UNPREDICTABLE*
**   ERROR ENCOUNTERED WHILE PROCESSING A TRACK COMMAND.              *
**   ON ENTRY IF REG 0 CONTAINS 12 - REG 1 CONTAINS THE ABEND CODE    *
**                                   REG 2 ADDRESSES THE STAE PARM    *
**                                   LIST (STAELIST)                  *
**            IF REG 0 DOES NOT CONTAIN 12 - REG 1 ADDRESSES THE SDWA *
**                                   IN WHICH SDWAPARM ADDRESSES THE  *
**                                   STAE PARM LIST (STAELIST)        *
**            REG 14 CONTAINS THE ADDRESS TO WHICH CONTROL SHOULD BE  *
**                RETURNED WHEN THIS TASK'S ESTAE PROCESSING HAS      *
**                COMPLETED                                           *
**   THE STAE PARM LIST CONTAINS THE FOLLOWING INFORMATION:           *
**            1) THE MODULE'S BASE REGISTER                           *
**            2) THE DATA AREA'S BASE REGISTER                        *
**   THIS INFORMATION IS RECOVERED.                                   *
**   SDUMP IS NOT ISSUED IF PERCOLATED TO BY A LOWER LEVEL ESTAE,     *
**   SINCE THE DUMP SHOULD HAVE BEEN TAKEN AT THE EXIT CLOSER TO THE  *
**   ERROR.                                                           *
**********************************************************************/
*                                                                  0943
*STAEXIT:                                                          0943
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0943
STAEXIT  DS    0H                                                  0944
*   RFY                                                            0944
*    (R0,                                                          0944
*     R1,                                                          0944
*     SDWAPTR,                                                     0944
*     R2,                                                          0944
*     R4,                                                          0944
*     R6,                                                          0944
*     R11,                                                         0944
*     R12,                                                         0944
*     R14,                                                         0944
*     R15) RSTD;                                                   0944
*   R6=R15;                         /* SET BASE REG TO ENTRY POINT 0945
*                                      ADDRESS                       */
         LR    R6,R15                                              0945
*   GEN REFS(R4,R6);                                               0946
*                                          /* SET UP TEMPORARY BASE */
         USING STAEXIT,R6
         DROP  R4
*   IF R0=TWELVE THEN               /* IS THERE AN SDWA?             */
         C     R0,@CF00035                                         0947
         BNE   @RF00947                                            0947
*     DO;                           /* NO, R2 ADDRESSES STAE PARM  0948
*                                      LIST                          */
*       RESPECIFY                                                  0949
*        (R0) UNRESTRICTED;                                        0949
*       R4=R2->REGCODE1;            /* RESTORE BASE REG              */
         L     R4,REGCODE1(,R2)                                    0950
*       R11=R2->REGCODE2;           /* RESTORE BASE REG              */
         L     R11,REGCODE2(,R2)                                   0951
*       R12=R2->REGDATA;            /* RESTORE THE DATA AREA'S REG   */
         L     R12,REGDATA(,R2)                                    0952
*       TRPF2SEX=ON;                /* MARK EXITSTAE PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0953
         OI    TRPF2SEX(@10),B'01000000'                           0953
*       HAVESDWA=OFF;               /* INDICATE THERE WAS NO SDWA  0954
*                                                            @YM01918*/
         NI    HAVESDWA,B'11101111'                                0954
*       CSCBPTR=CSCBPASS;           /* RESTORE CSCB BASE REG         */
         LA    @10,STAELIST                                        0955
         L     CSCBPTR,CSCBPASS(,@10)                              0955
*       WTOBUF(ONE:SLEN)=SLIST(ONE:SLEN);/* BUILD SDUMP LIST IN      */
         LH    @10,SLEN                                            0956
         BCTR  @10,0                                               0956
         EX    @10,@SM03181                                        0956
*       R1=ADDR(CHSWT);             /* CSCB BUFFER ADDRESSED BY R1   */
         LA    R1,CHSWT(,CSCBPTR)                                  0957
*       GEN SETS(R1)(SDUMP MF=(E,(1)));/* GET DUMP AS SOON AS      0958
*                                      POSSIBLE                      */
         SDUMP MF=(E,(1))
*       RESPECIFY                                                  0959
*        (R2) UNRESTRICTED;                                        0959
*     END;                                                         0960
*   ELSE                            /* HAVE SDWA                     */
*     DO;                           /* STAE PARM PTR IN SDWA         */
         B     @RC00947                                            0961
@RF00947 DS    0H                                                  0962
*       RESPECIFY                                                  0962
*        (R8) RESTRICTED;                                          0962
*       R8=R1;                      /* SAVE BASE OF SDWA             */
         LR    R8,R1                                               0963
*       R4=SDWAPARM->REGCODE1;      /* RESTORE BASE REG              */
         L     @10,SDWAPARM(,SDWAPTR)                              0964
         L     R4,REGCODE1(,@10)                                   0964
*       R11=SDWAPARM->REGCODE2;     /* RESTORE BASE REG              */
         L     R11,REGCODE2(,@10)                                  0965
*       R12=SDWAPARM->REGDATA;      /* RESTORE DATA AREA'S BASE      */
         L     R12,REGDATA(,@10)                                   0966
*       TRPF2SEX=ON;                /* MARK EXITSTAE PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0967
         OI    TRPF2SEX(@10),B'01000000'                           0967
*       HAVESDWA=ON;                /* INDICATE THERE IS A SDWA    0968
*                                                            @YM01918*/
         OI    HAVESDWA,B'00010000'                                0968
*       CSCBPTR=CSCBPASS;           /* RESTORE CSCB BASE REG         */
         LA    @10,STAELIST                                        0969
         L     CSCBPTR,CSCBPASS(,@10)                              0969
*       IF SDWAPERC=OFF&            /* IS THERE STAE PERCULATION?    */
*           SDWAMCHK=OFF THEN       /* WAS THERE A MACHINE CHECK?    */
         TM    SDWAPERC(SDWAPTR),B'00010000'                       0970
         BNZ   @RF00970                                            0970
         TM    SDWAMCHK(SDWAPTR),B'10000000'                       0970
         BNZ   @RF00970                                            0970
*         DO;                       /* NO                            */
*           WTOBUF(ONE:SLEN)=SLIST(ONE:SLEN);/* BUILD SDUMP LIST IN  */
         LH    @10,SLEN                                            0972
         BCTR  @10,0                                               0972
         EX    @10,@SM03181                                        0972
*           R1=ADDR(CHSWT);         /* CSCB BUFFER ADDRESSED BY R1   */
         LA    R1,CHSWT(,CSCBPTR)                                  0973
*           GEN SETS(R1)(SDUMP MF=(E,(1)));/* GET DUMP AS SOON AS  0974
*                                      POSSIBL                       */
         SDUMP MF=(E,(1))
*         END;                                                     0975
*       ELSE                                                       0976
*         ;                         /* THERE IS PERCULATION, SO NO 0976
*                                      SDUMP                         */
@RF00970 DS    0H                                                  0977
*     END;                                                         0977
*   GEN REFS(R4,R6);                                               0978
@RC00947 DS    0H                                                  0978
*                                    /* DROP TEMPORARY BASE REG */
         DROP R6
         USING @PSTART+4095,R4    RESTORE R4 BASE REG
*   R14SAVE=R14;                                                   0979
         ST    R14,R14SAVE                                         0979
*   CALL STAEFAIL;                  /* CONTROL IS NEVER RETURNED.  0980
*                                      STAEFAIL RETURNS TO THE SYSTEM*/
         BAL   @14,STAEFAIL                                        0980
*   RFY                                                            0981
*    (R1,                                                          0981
*     SDWAPTR,                                                     0981
*     R4,                                                          0981
*     R6,                                                          0981
*     R8,                                                          0981
*     R11,                                                         0981
*     R12,                                                         0981
*     R14,                                                         0981
*     R15) UNRSTD;                                                 0981
*   END STAEXIT;                                                   0982
@EL00028 DS    0H                                                  0982
@EF00028 DS    0H                                                  0982
@ER00028 BR    @14                                                 0982
*                                                                  0983
*/*********************************************************************
**            S T A E F A I L    P R O C E D U R E                    *
** ENTRY REASON - AN ESTAE FAILED TO SET UP PROPERLY                  *
** ENTRY FROM   - 1) SETESTAE PROCEDURE                               *
**                   A) IEECB860 FAILED TO SET UP PROPERLY            *
**                2) TRKESTAE PROCEDURE                               *
**                   A) LOWER LEVEL TRACK ESTAE FAILED                *
**                3) EXITSTAE PROCEDURE                               *
**                   A) AN ERROR WAS FOUND SO ESTAE ROUTINE GOT       *
**                      CONTROL.                                      *
** EXIT  TO     - LABEL RETSYS IN THE TOP PROCEDURE WHERE CONTROL IS  *
**                RETURN TO THE SYSTEM OR ABEND 102 IS ISSUED.        *
** FUNCTION     -                                                     *
**  1) THE LOCAL AND CMS LOCKS ARE OBTAINED TO SERIALIZE ON THE SACB. *
**  2) FIND TRACKS SACB                                               *
**  3) IF AN SACB IS PRESENT AND THIS TASK WAS NOT POSTED BY DIDOCS,  *
**     THE TRACK FIELDS IN THE SACB ARE CLEARED TO PREVENT ANY        *
**     FURTHER PROCESSING BY SVC 34 OR DIDOCS.                        *
**  4)  THE LOCKS ARE RELEASED.                                       *
**  5)  IF THERE IS A VALID (NON-ZERO) UCME ECB ADDRESS,       @YM4795P
**      THEN ISSUE A MESSAGE TELLING THE OPERATOR TO ISSUE A          *
**      K E,D,L=CCA (AREA TRACK IS IN). THIS WILL                     *
**      INDICATE TO DIDOCS TO CLEAR THE SCREEN                 @YM4795P
**   6) THE TRACK CSCB IS FREED VIA MGCR.                             *
**   7) IF AN SDWA EXISTS, A SETRP IS ISSUED TO INDICATE THE ACTION   *
**      TO BE TAKEN BY ASIR (ABEND - STAE INTERFACE ROUTINE)          *
**   8) OTHERWISE REG 15 IS SET WITH A 0 RETURN CODE                  *
**   9) RETURN TO TOP PROCEDURE AT LABEL RETSYS WHERE R14 IS RESTORED *
**      AND CONTROL IS RETURNED TO ASIR.                              *
** NOTE:  REGISTER 12 MUST BE SAVED SEPARATELY BECAUSE IT IS THE      *
**        BASE REGISTER FOR 'LOCKSAVE'                                *
**********************************************************************/
*                                                                  0983
*   RFY                                                            0983
*     R8 RSTD;                                                     0983
*STAEFAIL:                                                         0984
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0984
STAEFAIL DS    0H                                                  0985
*   TRPF2SFL=ON;                    /* MARK STAEFAIL PROC AS ENTERED */
         LA    @10,TRCURRSW                                        0985
         OI    TRPF2SFL(@10),B'00100000'                           0985
*   GEN SETS(LOCKSAVE,R6) REFS(R11,R12,R14);                       0986
         STM     R11,R14,LOCKSAVE    SAVE REGISTERS ACROSS SETLOCK
         LR      R6,R12              SAVE DATA REGISTER
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        X
               RELATED=(SACB,IEECB800(LOCKSOFF))
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          X
               RELATED=(SACB,IEECB800(LOCKSOFF))
         LR      R12,R6              RESTORE DATA REGISTER
         LM      R11,R14,LOCKSAVE    RESTORE REGISTERS
*   CALL FINDSACB;                  /* FIND TRACKS SACB              */
         BAL   @14,FINDSACB                                        0987
*   IF SACBPTR^=ZERO&CHCECB^=POSTED THEN/* SACB EXISTS &             */
         LTR   SACBPTR,SACBPTR                                     0988
         BZ    @RF00988                                            0988
         CLC   CHCECB(4,CSCBPTR),POSTED                            0988
         BE    @RF00988                                            0988
*     DO;                           /* DIDOCS DID NOT POST           */
*       DCMADFLG=DCMADFLG&CLEAROPT; /* CLEAR ALL BUT DIDOCS DIDOCS 0990
*                                      BIT                           */
         NI    DCMADFLG(SACBPTR),X'20'                             0990
*       DCMATRCK=OFFBYTE;           /* CLEAR TRACK OPTIONS INDICATORS*/
         MVI   DCMATRCK(SACBPTR),X'00'                             0991
*       DCMAUTME=OFFHALF;           /* CLEAR TRACK TIME INTERVAL     */
         SLR   @10,@10                                             0992
         STH   @10,DCMAUTME(,SACBPTR)                              0992
*       DCMATECB=CLEARECB;          /* CLEAR TRACK CANCEL ECB ADDR   */
         SLR   @10,@10                                             0993
         ST    @10,DCMATECB(,SACBPTR)                              0993
*     END;                                                         0994
*   CMDBUFR(ONE:KEDLGTH)=KED(ONE:KEDLGTH);/* MOVE MESSAGE IN CSCB  0995
*                                                            @YM4795P*/
@RF00988 SLR   @10,@10                                             0995
         IC    @10,KEDLGTH                                         0995
         BCTR  @10,0                                               0995
         EX    @10,@SM03183                                        0995
*   RFY                                                            0996
*    (R6,                                                          0996
*     R7) RSTD;                                                    0996
*   R7=CHCNID;                      /* PICK UP CONSOLE ID FOR MSG  0997
*                                      CONVERT               @ZA00073*/
         SLR   R7,R7                                               0997
         IC    R7,CHCNID(,CSCBPTR)                                 0997
*   R6=ADDR(CNIDAREA);              /* ADDR OF AREA FOR UNPACK     0998
*                                                            @ZA00073*/
         LA    R6,CNIDAREA                                         0998
*   CALL CVDCOUNT;                  /* PROCESS CONSOLE ID FOR MSG  0999
*                                      TEXT                  @ZA00073*/
         BAL   @14,CVDCOUNT                                        0999
*   CNSID=CNID;                     /* INIT MSG WITH CONSOLE ID    1000
*                                                            @ZA00073*/
         LA    @10,64                                              1000
         ALR   @10,CSCBPTR                                         1000
         MVC   CNSID(2,@10),CNID                                   1000
*   CNSLAREA=DCMAID;                /* SCREEN AREA ID        @YM4795P*/
         MVC   CNSLAREA(1,@10),DCMAID(SACBPTR)                     1001
*   RFY                                                            1002
*    (R6,                                                          1002
*     R7) UNRSTD;                   /*                       @Z40DQSS*/
*   CALL LOCKSOFF;                  /* REGARDLESS RELEASE LOCKS      */
         BAL   @14,LOCKSOFF                                        1003
*   RFY                                                            1004
*    (R0,                                                          1004
*     R1) RSTD;                     /*                       @Z40DQSS*/
*   R0=CHUCMP;                      /* CONSOLE ID                    */
         SLR   R0,R0                                               1005
         IC    R0,CHUCMP(,CSCBPTR)                                 1005
*   R1=ADDR(CHSWT);                 /* MSG BUFFER IN REG1    @YM4795P*/
         LA    R1,CHSWT(,CSCBPTR)                                  1006
*   GEN SETS(R1)(WTO MF=(E,(R1)));  /* ISSUE WTO             @YM4795P*/
         WTO MF=(E,(R1))
*   RESPECIFY                                                      1008
*     R0 UNRESTRICTED;                                             1008
*   R1=CSCBPTR;                     /* RESTORE CSCB PTR              */
         LR    R1,CSCBPTR                                          1009
*   CHFC=ON;                        /* INDICATE TO FREE CSCB CORE    */
         OI    CHFC(CSCBPTR),B'00000010'                           1010
*   GEN SETS(R0,R1)(MGCR (1),CHAIN);/* HAVE CSCB CORE FREED BY SVC 34*/
         MGCR (1),CHAIN
*   IF HAVESDWA=ON THEN             /* WAS THERE AN SDWA?    @YM01918*/
         TM    HAVESDWA,B'00010000'                                1012
         BNO   @RF01012                                            1012
*     DO;                           /* YES, ISSUE SETPR              */
*       R1=R8;                      /* REINIT BASE OF SDWA           */
         LR    R1,R8                                               1014
*       DO;                         /* SETRP                       1015
*                                      RECORD(YES)RECPARM(LRECINF)   */
*         RESPECIFY                                                1016
*          (GPR00P,                                                1016
*           GPR01P,                                                1016
*           GPR14P,                                                1016
*           GPR15P) RSTD;                                          1016
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              1017
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */
         OI    SDWARCRD(GPR01P),B'10000000'                        1018
*         GPR15P=ADDR(LRECINF);     /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,LRECINF                                      1019
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      1020
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   1020
*         RESPECIFY                                                1021
*          (GPR00P,                                                1021
*           GPR01P,                                                1021
*           GPR14P,                                                1021
*           GPR15P) UNRSTD;                                        1021
*       END;                                                       1022
*     END;                                                         1023
*   ELSE                            /* NO SDWA                       */
*     DO;                                                          1024
         B     @RC01012                                            1024
@RF01012 DS    0H                                                  1025
*       RESPECIFY                                                  1025
*        (R15) RESTRICTED;                                         1025
*       R15=ZERO;                   /* SET RETURN CODE = 0           */
         SLR   R15,R15                                             1026
*     END;                                                         1027
*   RETURN TO RETSYS;               /* RETURN TO TOP PROCEDURE AND 1028
*                                      ISSUE ABEND OR RETURN TO THE
*                                      SYSTEM.                       */
@RC01012 LA    @14,RETSYS                                          1028
@EL00029 DS    0H                                                  1028
@EF00029 DS    0H                                                  1028
@ER00029 BR    @14                                                 1028
*   RFY                                                            1029
*    (R1,                                                          1029
*     R7,                                                          1029
*     R8,                                                          1029
*     R15) UNRSTD;                                                 1029
*   END STAEFAIL;                                                  1030
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00P PTR(31) REG(0),                                       1031
*     GPR01P PTR(31) REG(1),                                       1031
*     GPR14P PTR(31) REG(14),                                      1031
*     GPR15P PTR(31) REG(15);                                      1031
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1032
*     I031F FIXED(31) BASED,                                       1032
*     I031P PTR(31) BASED,                                         1032
*     I015F FIXED(15) BASED,                                       1032
*     I015P PTR(15) BASED,                                         1032
*     I008P PTR(8) BASED,                                          1032
*     I001C CHAR(1) BASED;                                         1032
*   END IEECB800                                                   1033
*                                                                  1033
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEERDCM )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */
*/*%INCLUDE SYSLIB  (IEFPTRS )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*/*%INCLUDE SYSLIB  (IHASCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IKTTCAST)                                       */
*                                                                  1033
*       ;                                                          1033
@DATA    DS    0H
@CH00961 DC    H'14'
@CH02946 DC    H'40'
@CH02950 DC    H'66'
@CH00934 DC    H'100'
@SM03157 MVC   WTOBUF(0,CSCBPTR),NOUPDATE
@SM03159 MVC   ENQDEQL(0),EENQ
@SM03161 MVC   GETLIST(0),GETAREA
@SM03163 MVC   WPL(0,WPLPTR),HEADTEXT
@SM03166 MVC   WPLML(0,WPLPTR),ERRTEXT
@SM03168 MVC   WPLML(0,WPLPTR),JOBTEXT
@SM03170 MVC   WPL(0,WPLPTR),JOBLISTV
@SM03172 MVC   WPL(0,WPLPTR),JOBLIST
@SM03174 MVC   WPL(0,WPLPTR),TEXT(@10)
@SM03176 MVC   WPL(0,WPLPTR),TSLIST
@SM03178 MVC   ENQDEQL(0),DDEQ
@SM03181 MVC   WTOBUF(0,CSCBPTR),SLIST
@SM03183 MVC   CMDBUFR+64(0,CSCBPTR),KED
         DS    0F
@AL00625 DC    A(TSTEXT)               LIST WITH   2 ARGUMENT(S)
         DC    A(TSLGTH)
@AL00628 DC    A(VTAMTEXT)             LIST WITH   2 ARGUMENT(S)
         DC    A(VTAMLGTH)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@PC00014 DS    3F
@AL00001 DS    3A
IEECB800 CSECT
         DS    0F
@CF00042 DC    F'1'
@CF00127 DC    F'2'
@CF00425 DC    F'3'
@CF00034 DC    F'4'
@CF01254 DC    F'6'
@CF01401 DC    F'7'
@CF00196 DC    F'8'
@CF02881 DC    F'10'
@CH02881 EQU   @CF02881+2
@CF00035 DC    F'12'
@CF00963 DC    F'16'
@CF02944 DC    F'37'
@CF03132 DC    F'98'
@CF02911 DC    F'1024'
@CF03135 DC    F'-9'
@CF03134 DC    F'-5'
@CF03131 DC    F'-4'
@DATD    DSECT
         DS    0D
UCMEXTPT DS    A
UCMMCSPT DS    A
UCMEILPT DS    A
UCMUEWPT DS    A
UCMFXPTR DS    A
UCMPXPTR DS    A
COREBYTE DS    F
BUFPTR   DS    A
TASKCSCB DS    A
WPLSAVE  DS    A
NEXTNODE DS    A
LASTNODE DS    A
TSNUM    DS    H
JOBNUM   DS    H
INITNUM  DS    H
COUNT    DS    AL1
         DS    CL1
TRACESWS DS    CL32
         ORG   TRACESWS
TRTITLE  DS    CL4
TRCURRSW DS    CL14
TRPREVSW DS    CL14
         ORG   TRACESWS+32
PROCSAVE DS    CL88
         ORG   PROCSAVE
SETESAVE DS    AL4
TRKESAVE DS    AL4
TRACKSAV DS    AL4
DISPSAVE DS    AL4
TYPESAVE DS    AL4
HEADSAVE DS    AL4
CALCSAVE DS    AL4
JOBLSAVE DS    AL4
LISTJSAV DS    AL4
JOBLFSAV DS    AL4
TSVTSAVE DS    AL4
FILLSAVE DS    AL4
LISTSAVE DS    AL4
FINMSAVE DS    AL4
LASTSAVE DS    AL4
FREESAVE DS    AL4
DQCBSAVE DS    AL4
CALLSAVE DS    AL4
TIMESAVE DS    AL4
IMSGSAVE DS    AL4
NEXTSAVE DS    AL4
R14SAVE  DS    AL4
         ORG   PROCSAVE+88
SAVETIME DS    CL4
ENQDEQL  DS    CL12
LOCKSAVE DS    CL16
ESTAELST DS    CL24
STAELIST DS    CL28
GETLIST  DS    CL12
         ORG   GETLIST
GENLGTH  DS    AL4
COREADDR DS    AL4
GETFLAGS DS    AL2
GETSUBP  DS    AL2
         ORG   GETLIST+12
PARMLIST DS    CL17
         ORG   PARMLIST
CSCBADDR DS    AL4
MESSADDR DS    AL4
MLID     DS    CL4
         ORG   MLID
MLWTOID  DS    CL3
CONSOLID DS    CL1
         ORG   PARMLIST+12
RETCODE  DS    CL4
MSGFLAGS DS    CL1
         ORG   MSGFLAGS
CSCBFLAG DS    BL1
NOUPFLAG EQU   MSGFLAGS+0
FIRSTIME EQU   MSGFLAGS+0
         ORG   PARMLIST+17
         DS    CL7
UNPACK   DS    CL8
DATEAREA DS    CL5
         ORG   DATEAREA
SAVEDATE DS    CL4
SIGNBYTE DS    CL1
         ORG   DATEAREA+5
CNIDAREA DS    CL8
         ORG   CNIDAREA
@NM00161 DS    CL6
CNID     DS    CL2
         ORG   CNIDAREA+8
SWITCHES DS    CL1
         ORG   SWITCHES
FIRSTRAK DS    BL1
CONNECT  EQU   SWITCHES+0
         ORG   CONNECT
CONNEXT  EQU   CONNECT+0
CONEND   EQU   CONNECT+0
         ORG   SWITCHES+0
HAVESDWA EQU   SWITCHES+0
SACBPRES EQU   SWITCHES+0
TRKNOUP  EQU   SWITCHES+0
ABENDSW  EQU   SWITCHES+0
         ORG   SWITCHES+1
         DS    CL2
ECBS     DS    CL8
         ORG   ECBS
ECB1     DS    AL4
ECB2     DS    AL4
         ORG   ECBS+8
IEECB800 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV02746 DC    V(IEECB801)
         DS    0D
HIMASK   DC    XL4'80000000'
POSTED   DC    XL4'40000000'
PTPOSTED DC    XL4'40000004'
@CC02921 DC    C'        '
@CC02938 DC    C'TRCE'
STARTING DC    CL8'STARTING'
DCOMM    DS    CL8
         ORG   DCOMM
DCLEN    DC    X'07'
DCOM     DC    CL7'DISPLAY'
         ORG   DCOMM+8
TCOMM    DS    CL8
         ORG   TCOMM
TCLEN    DC    X'06'
TCOM     DC    CL7'TRACK'
         ORG   TCOMM+8
LRECINF  DS    CL24
         ORG   LRECINF
MODNAME  DC    CL8'IEECB800'
@NM00162 DC    CL8'IEECB800'
@NM00163 DC    CL8' '
         ORG   LRECINF+24
ZEROES   DC    X'0000000000000000'
@DATD    DSECT
         IHAPSA
IEECB800 CSECT
         DS    0F
HEADTEXT WTO   ('IEE102I 00.00.00 00.000 ACTIVITY',C),                 *
               MF=L,DESC=(5,8,9,10),MCSFLAG=(REG0,RESP),AREAID=Z
*                                                              @ZA07770
HEADLGTH DC    AL1(*-HEADTEXT)    LENGTH OF MAIN HEADER
JOBTEXT  WTO   ('   00000 JOBS    00000 INITIATORS'),MF=L      @ZA07770
JOBLGTH  DC    AL1(*-JOBTEXT)     LENGTH OF JOBS SUB-HEADER
VTAMTEXT WTO   ('   00000 ACTIVE  00000 MAX VTAM TSO USERS'),MF=L
*                                                              @Z40DQSS
VTAMLGTH DC    AL1(*-VTAMTEXT)    LENGTH OF VTAM SUB-HEADER    @Z40DQSS
TSTEXT   WTO   ('   00000 TIME SHARING USERS'),MF=L            @ZA07770
TSLGTH   DC    AL1(*-TSTEXT)      LENGTH OF TS SUB-HEADER
JOBLIST  WTO   ('  STARTING STARTING           V=R  00000K - 00000K'), *
               MF=L                                            @ZA07770
JOBLLGTH DC    AL1(*-JOBLIST)     LENGTH OF INDIVIDUAL JOBS WTO
ERRTEXT  WTO   ('DISPLAY TRUNCATED - INSUFFICIENT STORAGE'),MF=L
ERRLGTH  DC    AL1(*-ERRTEXT)     LENGTH OF ERR MESSAGE
JOBLISTV WTO   ('  STARTING STARTING           V=V   '),MF=L   @ZA07770
JOBLGTHV DC    AL1(*-JOBLISTV)    LENGTH OF VIRTUAL JOB WTO    @YM7265P
TSLIST   WTO   ('                                                      X
                       '),MF=L                                 @ZA07770
TSLLGTH  DC    AL1(*-TSLIST)      LENGTH OF INDIVIDUAL TS WTO
NOUPDATE WTO   ('IEE920I NO TR UPDATE AT 00.00.00 00.000'),MF=L,       *
               DESC=(5),MCSFLAG=(REG0,RESP)
NOUPLGTH DC    AL1(*-NOUPDATE)    LENGTH OF NO UPDATE MESSAGE
         DS    0F
EENQ     ENQ   (MAJOR,MINOR,S,3,SYSTEM),RET=HAVE,MF=L
         DS    0H
ELEN     DC    AL2(*-EENQ)
DDEQ     DEQ   (MAJOR,MINOR,3,SYSTEM),RET=HAVE,MF=L
         DS    0H
DLEN     DC    AL2(*-DDEQ)
MAJOR    DC    CL8'SYSIEFSD'
MINOR    DC    CL3'Q10'
         DS    0F
GETAREA  GETMAIN EC,LV=0,A=AWAKE,SP=229,MF=L
         DS    0H
GETLGTH  DC    AL2(*-GETAREA)
         DS    0F
SLIST    SDUMP HDR='IEECB800 - TRACK COMMAND',SDATA=(SQA,PSA,NUC,LSQA, *
               RGN,LPA,TRT,CSA,ALLPSA),MF=L
         DS    0H
SLEN     DC    AL2(*-SLIST)
KED      WTO   ('IEE713I TRACK COMMAND PROCESSOR FAILED-ISSUE K E,D,L=CC
               CA TO DELETE'),MF=L,DESC=(5),MCSFLAG=(REG0,RESP)
KEDLGTH  DC    AL1(*-KED)     LENGTH OF TEXT                   @ZA00073
PATCH    DC    CL250'*****PATCH AREA - IEECB800*****'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEECB800 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
LINKPTR  EQU   @02
ASCBENT  EQU   @06
TSNAMPTR EQU   @03
MLWTO#   EQU   @02
TEMPLACE EQU   @02
NUMLINES EQU   @03
JSIZE    EQU   @09
JREGION  EQU   @03
DISPLACE EQU   @02
MSGCTR   EQU   @02
WPLPTR   EQU   @08
CSCBPTR  EQU   @05
UCMDVEPT EQU   @03
SACBPTR  EQU   @02
SDWAPTR  EQU   @01
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R3       EQU   @03
R4       EQU   @04
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
R11      EQU   @11
R12      EQU   @12
R14      EQU   @14
R15      EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
R13      EQU   @13
CVTPTR   EQU   16
DCMTSRT  EQU   0
DCMRFLGS EQU   DCMTSRT+5
@NM00008 EQU   DCMTSRT+14
DCMDEVTY EQU   DCMTSRT+15
DCMADSDS EQU   DCMTSRT+16
DCMR2FLG EQU   DCMTSRT+44
DCMR3FLG EQU   DCMTSRT+45
DCMPACB  EQU   DCMTSRT+60
DCMACB   EQU   0
DCMACBNX EQU   DCMACB
DCMAID   EQU   DCMACB+4
DCMASACB EQU   DCMACB+5
DCMACLR  EQU   DCMACB+9
DCMAFLG1 EQU   DCMACLR+17
DCMADEND EQU   DCMAFLG1
DCMAFULL EQU   DCMAFLG1
DCMAFLG2 EQU   DCMACLR+18
DCMATFLG EQU   DCMACLR+19
DCMADFLG EQU   DCMATFLG
DCMAHOLD EQU   DCMADFLG
DCMATRCK EQU   DCMATFLG+1
DCMAUTME EQU   DCMATFLG+2
DCMATECB EQU   DCMACLR+23
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTCUCB  EQU   CVTMAP+100
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTMSER  EQU   CVTMAP+148
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
UCM2EXT  EQU   0
UCM2STA  EQU   UCM2EXT+8
UCM2SFLG EQU   UCM2STA
UCMPRFX  EQU   0
UCMSAVE0 EQU   UCMPRFX+4
UCMSFLGS EQU   UCMPRFX+84
UCMSFLG1 EQU   UCMSFLGS
UCMSFLG2 EQU   UCMSFLGS+1
UCMXSA   EQU   UCMPRFX+104
UCMSDS1  EQU   UCMPRFX+156
UCM      EQU   0
UCMDECB  EQU   UCM+12
UCMRPYI  EQU   UCM+32
UCMPXB   EQU   UCM+68
UCMMODE  EQU   UCMPXB
UCMVDATA EQU   UCM+72
UCMVEA   EQU   UCMVDATA
UCMVEZ   EQU   UCMVDATA+4
UCMRSV42 EQU   UCM+300
UCMRSV51 EQU   UCM+301
UCMEIL   EQU   0
UCMRECBA EQU   UCMEIL+24
UCMEXIT  EQU   0
UCMLIST  EQU   0
UCMSTS   EQU   UCMLIST+24
UCMATR   EQU   UCMLIST+25
UCMXA    EQU   UCMLIST+26
UCMXB    EQU   UCMLIST+28
UCMAUTH  EQU   UCMLIST+40
UCMAUTHA EQU   UCMAUTH
UCMDISP  EQU   UCMLIST+42
UCMDISP1 EQU   UCMDISP
UCMDISP2 EQU   UCMDISP+1
UCMMSG   EQU   UCMLIST+60
UCMMSG1  EQU   UCMMSG
UCMDEVC  EQU   UCMLIST+63
UCMRCT   EQU   UCMLIST+68
UCMSDS5  EQU   UCMRCT
UCMFEXTA EQU   0
UCMFMGFS EQU   UCMFEXTA+8
UCMFFLG1 EQU   UCMFMGFS
UCMPEXTA EQU   0
UCMPDM1  EQU   UCMPEXTA+4
BASE     EQU   0
BACHN    EQU   BASE
@NM00050 EQU   BASE+13
BALGSTAT EQU   BASE+24
BALOG    EQU   BALGSTAT+4
BASFL    EQU   BASE+36
BARSW    EQU   BASFL
MSLOGST  EQU   BASE+46
BASPBYTE EQU   BASE+47
BAMONITR EQU   BASE+56
@NM00072 EQU   BASE+104
MSLGCLOZ EQU   BASE+108
MSCLOSSW EQU   MSLGCLOZ
MSLGWLOG EQU   BASE+112
MSWLOGSW EQU   MSLGWLOG
MSLGWTR  EQU   BASE+116
MSWTRSW  EQU   MSLGWTR
MSLGSTRT EQU   BASE+120
MSSTRTSW EQU   MSLGSTRT
MS1BASEX EQU   BASE+136
BASES01  EQU   0
MSNTAL   EQU   BASES01
MSSSB    EQU   BASES01+1
MSBTN    EQU   MSSSB
MSPFG    EQU   BASES01+2
MSECBFL  EQU   BASES01+3
MSTUS    EQU   BASES01+4
MSSSA    EQU   MSTUS
MSINLSW  EQU   MSSSA
MSREOF   EQU   MSSSA
MSNWP    EQU   MSSSA
MSFHF    EQU   BASES01+5
CHAIN    EQU   0
CHPTR    EQU   CHAIN
CHFLG    EQU   CHAIN+4
CHVCD    EQU   CHFLG
CHSTS    EQU   CHFLG+2
CHFC     EQU   CHSTS
CHACT    EQU   CHFLG+3
CHIFY    EQU   CHACT
CHKEY    EQU   CHAIN+8
CHPARM   EQU   CHKEY
CHCLS    EQU   CHAIN+16
CHPKE    EQU   CHAIN+28
CHTRKID  EQU   CHPKE
CHUCMP   EQU   CHAIN+29
CHTJID   EQU   CHAIN+30
CHASID   EQU   CHTJID
CHPROCSN EQU   CHAIN+32
CHACT1   EQU   CHPROCSN+3
CHASM    EQU   CHAIN+40
CHCIBP   EQU   CHASM+4
CHRGNSZ  EQU   CHASM+8
CHRGNAD  EQU   CHASM+12
CHCECB   EQU   CHASM+20
CHSTEP   EQU   CHASM+24
CHSWT    EQU   CHSTEP
CHSHORT  EQU   CHASM+32
TCBASCB  EQU   0
TCBPTR   EQU   TCBASCB+4
ASCBPTR  EQU   TCBASCB+12
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
SDWA     EQU   0
SDWAPARM EQU   SDWA
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAMCHK EQU   SDWAERRA
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAPERC EQU   SDWAERRC
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWARCDE EQU   SDWAPARQ
SDWAACF2 EQU   SDWAPARQ+1
SDWARCRD EQU   SDWAACF2
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
SCB      EQU   0
SCBCHAIN EQU   SCB
SCBEXIT  EQU   SCB+4
SCBPARM  EQU   SCB+8
SCBFLGS1 EQU   SCBPARM
SCBIOPRC EQU   SCBFLGS1
SCBOWNR  EQU   SCB+12
SCBFLGS2 EQU   SCBOWNR
SCBDATA  EQU   SCB+16
SCBFLGS3 EQU   SCBDATA
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSF2 EQU   WPLMCSF+1
WPLMCSFJ EQU   WPLMCSF2
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESC2 EQU   WPLDESC+1
WPLDESCJ EQU   WPLDESC2
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLLTFC  EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLAREA  EQU   WPLLS01+2
WPLLINES EQU   WPLLS01+3
WPLML    EQU   0
WPLMLLEN EQU   WPLML+1
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
WPLMLLTC EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASCB     EQU   0
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBOUT  EQU   ASCBRCTF
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
TCAST    EQU   0
TCASUSER EQU   TCAST+4
TCASUSEC EQU   TCASUSER
TCASUMAX EQU   TCASUSER+2
TCASFLG1 EQU   TCAST+88
TCASFLG2 EQU   TCAST+89
TRACEMAP EQU   0
TRPFLAGS EQU   TRACEMAP
TRPFLAG1 EQU   TRPFLAGS
TRPF1TOP EQU   TRPFLAG1
TRPF1SET EQU   TRPFLAG1
TRPF1TES EQU   TRPFLAG1
TRPF1ALD EQU   TRPFLAG1
TRPF1RET EQU   TRPFLAG1
TRPFLAG2 EQU   TRPFLAGS+1
TRPF2ABN EQU   TRPFLAG2
TRPF2SEX EQU   TRPFLAG2
TRPF2SFL EQU   TRPFLAG2
TRCFLAGS EQU   TRACEMAP+2
TRCFLAG1 EQU   TRCFLAGS
TRCF1TRI EQU   TRCFLAG1
TRCF1TRE EQU   TRCFLAG1
TRCF1LKI EQU   TRCFLAG1
TRCF1LKE EQU   TRCFLAG1
TRCFLAG2 EQU   TRCFLAGS+1
TRCF2FSI EQU   TRCFLAG2
TRCF2FSE EQU   TRCFLAG2
TRCF2TMI EQU   TRCFLAG2
TRCF2TME EQU   TRCFLAG2
TRCFLAG3 EQU   TRCFLAGS+2
TRCF3WTI EQU   TRCFLAG3
TRCF3WTE EQU   TRCFLAG3
TRCF3DPI EQU   TRCFLAG3
TRCF3DPE EQU   TRCFLAG3
TRCFLAG4 EQU   TRCFLAGS+3
TRCF4TCI EQU   TRCFLAG4
TRCF4TCE EQU   TRCFLAG4
TRCF4HDI EQU   TRCFLAG4
TRCF4HDE EQU   TRCFLAG4
TRCFLAG5 EQU   TRCFLAGS+4
TRCF5CRI EQU   TRCFLAG5
TRCF5CRE EQU   TRCFLAG5
TRCF5JBI EQU   TRCFLAG5
TRCF5JBE EQU   TRCFLAG5
TRCFLAG6 EQU   TRCFLAGS+5
TRCF6CVI EQU   TRCFLAG6
TRCF6CVE EQU   TRCFLAG6
TRCF6LJI EQU   TRCFLAG6
TRCF6LJE EQU   TRCFLAG6
TRCFLAG7 EQU   TRCFLAGS+6
TRCF7MLI EQU   TRCFLAG7
TRCF7MLE EQU   TRCFLAG7
TRCF7TVI EQU   TRCFLAG7
TRCF7TVE EQU   TRCFLAG7
TRCFLAG8 EQU   TRCFLAGS+7
TRCF8FLI EQU   TRCFLAG8
TRCF8FLE EQU   TRCFLAG8
TRCF8LTI EQU   TRCFLAG8
TRCF8LTE EQU   TRCFLAG8
TRCFLAG9 EQU   TRCFLAGS+8
TRCF9LLI EQU   TRCFLAG9
TRCF9LLE EQU   TRCFLAG9
TRCF9DQI EQU   TRCFLAG9
TRCF9DQE EQU   TRCFLAG9
TRCFLAGA EQU   TRCFLAGS+9
TRCFACLI EQU   TRCFLAGA
TRCFACLE EQU   TRCFLAGA
TRCFACBI EQU   TRCFLAGA
TRCFACBE EQU   TRCFLAGA
TRCFLAGB EQU   TRCFLAGS+10
TRCFBFBI EQU   TRCFLAGB
TRCFBFBE EQU   TRCFLAGB
TRCFBJFI EQU   TRCFLAGB
TRCFBJFE EQU   TRCFLAGB
TRCFLAGC EQU   TRCFLAGS+11
TRCFCIMI EQU   TRCFLAGC
TRCFCIME EQU   TRCFLAGC
TRCFCNXI EQU   TRCFLAGC
TRCFCNXE EQU   TRCFLAGC
ASVTASCB EQU   0
LINK     EQU   0
CONVERT  EQU   0
STAELMAP EQU   0
CSCBPASS EQU   STAELMAP
COMMAND  EQU   STAELMAP+4
REGDATA  EQU   STAELMAP+8
REGCODE1 EQU   STAELMAP+12
REGCODE2 EQU   STAELMAP+16
STIMECB  EQU   STAELMAP+20
SACBADDR EQU   STAELMAP+24
CLWTO    EQU   0
CLMSG    EQU   CLWTO+4
CLTIME   EQU   CLMSG+8
HRS      EQU   CLTIME
MIN      EQU   CLTIME+3
SEC      EQU   CLTIME+6
CLDATE   EQU   CLMSG+17
CLYEAR   EQU   CLDATE
CLDAY    EQU   CLDATE+3
JOBBUILD EQU   0
JOBSTEXT EQU   JOBBUILD+4
JOBNM    EQU   JOBSTEXT+2
STEPNM   EQU   JOBSTEXT+11
PROCSNM  EQU   JOBSTEXT+20
STRADDR  EQU   JOBSTEXT+35
ENDADDR  EQU   JOBSTEXT+44
SWAPIND  EQU   0
TSBUILD  EQU   0
TSLTEXT  EQU   TSBUILD+4
TSID1    EQU   TSLTEXT+2
TSNAME   EQU   0
TSID     EQU   TSNAME
TSSWPIND EQU   TSNAME+8
CMDBUFR  EQU   0
TEXTWTO  EQU   CMDBUFR+4
CNSID    EQU   TEXTWTO+53
CNSLAREA EQU   TEXTWTO+55
I256C    EQU   0
DCMREND  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
UCMPRFXP EQU   0
UCM2PTR  EQU   0
DMY      EQU   0
TEXT     EQU   0
TXTLGTH  EQU   0
NUMBER   EQU   0
DCMTSPTR EQU   UCMXB
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTASVT  EQU   CVTS01+208
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
CVTTCASP EQU   CVTS01+664
UCMBASPT EQU   CVTCUCB
UCMIECBA EQU   UCMRECBA+4
CHAINS01 EQU   CHASM
CHTYPE   EQU   CHAINS01+124
CHTRSTAT EQU   CHAINS01+125
CHJOBS   EQU   CHTRSTAT
CHJOBSL  EQU   CHTRSTAT
CHTS     EQU   CHTRSTAT
CHTSL    EQU   CHTRSTAT
CHCNID   EQU   CHAINS01+126
CHARID   EQU   CHAINS01+127
CHPEND   EQU   CHAINS01+128
CHCSYSO  EQU   CHAINS01+134
SCBPTR   EQU   TCBSTAB
ASVTPTR  EQU   CVTASVT
TCASTPTR EQU   CVTTCASP
WTOBUF   EQU   CHSWT
UNPKDATE EQU   UNPACK
DATE     EQU   UNPKDATE+1
YEAR     EQU   DATE
DAY      EQU   DATE+2
UNPKTIME EQU   UNPACK
HOURS    EQU   UNPKTIME+1
MINUTES  EQU   UNPKTIME+3
SECONDS  EQU   UNPKTIME+5
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
UNPCKRS2 EQU   UNPKTIME+7
UNPCKRSV EQU   UNPKTIME
UNPKDRS2 EQU   UNPKDATE+6
UNPKDRS1 EQU   UNPKDATE
CHLAST   EQU   CHAINS01+136
CHSPA    EQU   CHAINS01+135
CHUSERID EQU   CHCSYSO
CHJB     EQU   CHCSYSO
CHDUMP   EQU   CHCSYSO
CHQUE    EQU   CHCSYSO
CHHOLD   EQU   CHCSYSO
CHOUT    EQU   CHCSYSO
CHINN    EQU   CHCSYSO
CHALL    EQU   CHCSYSO
CHINC    EQU   CHAINS01+132
@NM00092 EQU   CHTRSTAT
CHINITL  EQU   CHTRSTAT
CHINIT   EQU   CHTRSTAT
CHDEF    EQU   CHTYPE
CHHIAR   EQU   CHTYPE
CHARSV29 EQU   CHTYPE
CHARSV28 EQU   CHTYPE
CHARSV27 EQU   CHTYPE
CHARSV26 EQU   CHTYPE
CHARSV25 EQU   CHTYPE
CHDSTAT  EQU   CHTYPE
CHBUF    EQU   CHAINS01
UCMIECBP EQU   UCMIECBA+1
UCMIECBF EQU   UCMIECBA
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
DESCRTC  EQU   CMDBUFR+69
@NM00169 EQU   TEXTWTO+56
@NM00168 EQU   TEXTWTO
FLAGWTO  EQU   CMDBUFR+2
LGTHWTO  EQU   CMDBUFR
TSBL     EQU   TSNAME+9
@NM00167 EQU   TSLTEXT
@NM00166 EQU   TSBUILD
SECONDK  EQU   JOBSTEXT+49
FIRSTK   EQU   JOBSTEXT+40
JTEXT    EQU   JOBSTEXT+28
SBLANK   EQU   JOBSTEXT+19
JBLANK   EQU   JOBSTEXT+10
@NM00165 EQU   JOBSTEXT
@NM00164 EQU   JOBBUILD
CLNMBR   EQU   CLWTO+43
CLAREAID EQU   CLWTO+42
CLLTYPE  EQU   CLWTO+40
CLROUT   EQU   CLWTO+38
CLDESC   EQU   CLWTO+36
CLTITLE  EQU   CLMSG+23
CLPER3   EQU   CLDATE+2
CLBLANK  EQU   CLMSG+16
PER2     EQU   CLTIME+5
PER1     EQU   CLTIME+2
CLID     EQU   CLMSG
CLMCS    EQU   CLWTO+2
CLLENG   EQU   CLWTO
TRCFCRV2 EQU   TRCFLAGC
TRCFCRV1 EQU   TRCFLAGC
TRCFBRV2 EQU   TRCFLAGB
TRCFBRV1 EQU   TRCFLAGB
TRCFARV2 EQU   TRCFLAGA
TRCFARV1 EQU   TRCFLAGA
TRCF9RV2 EQU   TRCFLAG9
TRCF9RV1 EQU   TRCFLAG9
TRCF8RV2 EQU   TRCFLAG8
TRCF8RV1 EQU   TRCFLAG8
TRCF7RV2 EQU   TRCFLAG7
TRCF7RV1 EQU   TRCFLAG7
TRCF6RV2 EQU   TRCFLAG6
TRCF6RV1 EQU   TRCFLAG6
TRCF5RV2 EQU   TRCFLAG5
TRCF5RV1 EQU   TRCFLAG5
TRCF4RV2 EQU   TRCFLAG4
TRCF4RV1 EQU   TRCFLAG4
TRCF3RV2 EQU   TRCFLAG3
TRCF3RV1 EQU   TRCFLAG3
TRCF2RV2 EQU   TRCFLAG2
TRCF2RV1 EQU   TRCFLAG2
TRCF1RV2 EQU   TRCFLAG1
TRCF1RV1 EQU   TRCFLAG1
TRPF2RSV EQU   TRPFLAG2
TRPF1RSV EQU   TRPFLAG1
TCASTEND EQU   TCAST+128
@NM00160 EQU   TCAST+124
TCASOMJR EQU   TCAST+120
@NM00159 EQU   TCAST+118
TCASBR14 EQU   TCAST+116
@NM00158 EQU   TCAST+112
TCASASCI EQU   TCAST+108
TCASTTQH EQU   TCAST+104
TCASNIBL EQU   TCAST+102
TCASEXL  EQU   TCAST+100
TCASRPLL EQU   TCAST+98
TCASACBL EQU   TCAST+96
TCASASCB EQU   TCAST+92
@NM00157 EQU   TCAST+90
@NM00156 EQU   TCASFLG2
TCASTERM EQU   TCASFLG2
@NM00155 EQU   TCASFLG1
TCASNACT EQU   TCASFLG1
TCASESTA EQU   TCASFLG1
TCASABND EQU   TCASFLG1
TCASTPEN EQU   TCASFLG1
TCASLQIS EQU   TCASFLG1
TCASLTE  EQU   TCAST+84
TCASTPND EQU   TCAST+80
TCASOQM  EQU   TCAST+76
TCASIQM  EQU   TCAST+72
TCASTSB  EQU   TCAST+68
TCASTTL  EQU   TCAST+64
TCASWA   EQU   TCAST+60
TCASFAIL EQU   TCAST+56
TCASMSGS EQU   TCAST+52
TCASTECB EQU   TCAST+48
TCASMECB EQU   TCAST+44
TCASXECB EQU   TCAST+40
TCASTID  EQU   TCAST+32
@NM00154 EQU   TCAST+31
TCASCHNL EQU   TCAST+30
TCASCRSZ EQU   TCAST+28
TCASLBUF EQU   TCAST+24
TCASHBUF EQU   TCAST+20
TCASCLSZ EQU   TCAST+18
TCASRCON EQU   TCAST+16
TCASACBP EQU   TCAST+8
TCASID   EQU   TCAST
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00153 EQU   ASVT
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLML0   EQU   WPLML
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTK EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00152 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLMCSFA EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
WPLRLN   EQU   WPLRPTR
SCBRSVRE EQU   SCBDATA+3
SCBID    EQU   SCBDATA+2
SCBPKEY  EQU   SCBDATA+1
@NM00151 EQU   SCBFLGS3
SCBTERMO EQU   SCBFLGS3
SCBBRNTR EQU   SCBFLGS3
SCBPRNTR EQU   SCBFLGS3
SCBCNCEL EQU   SCBFLGS3
SCBRECRD EQU   SCBFLGS3
SCBTERMI EQU   SCBFLGS3
@NM00150 EQU   SCBFLGS3
SCBOWNRA EQU   SCBOWNR+1
SCBSUPER EQU   SCBFLGS2
SCBKEY0  EQU   SCBFLGS2
@NM00149 EQU   SCBFLGS2
@NM00148 EQU   SCBFLGS2
SCBINUSE EQU   SCBFLGS2
@NM00147 EQU   SCBFLGS2
SCBXCTL2 EQU   SCBFLGS2
@NM00146 EQU   SCBFLGS2
SCBPARMA EQU   SCBPARM+1
SCBHALT  EQU   SCBIOPRC
SCBNOIOP EQU   SCBIOPRC
SCBASYNC EQU   SCBFLGS1
@NM00145 EQU   SCBFLGS1
SCBESTAE EQU   SCBFLGS1
SCBDUMMY EQU   SCBFLGS1
SCBSTAR  EQU   SCBFLGS1
SCBSTAI  EQU   SCBFLGS1
@NM00144 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00143 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00142 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00141 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00140 EQU   SDWADDAT+3
@NM00139 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00138 EQU   SDWADDAT+1
@NM00137 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00136 EQU   SDWADUMP+2
@NM00135 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00134 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00133 EQU   SDWA+290
SDWAASID EQU   SDWA+288
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00132 EQU   SDWAACF3
@NM00131 EQU   SDWAACF2
SDWAFREE EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
@NM00130 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00129 EQU   SDWAACF2
SDWALCPU EQU   SDWACPUA+2
@NM00128 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
SDWARTYA EQU   SDWA+240
@NM00127 EQU   SDWA+239
@NM00126 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00125 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00124 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00123 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAABTM EQU   SDWAERRA
SDWASVCD EQU   SDWAERRA
SDWARKEY EQU   SDWAERRA
SDWAPCHK EQU   SDWAERRA
SDWATIME EQU   SDWAMCH+20
SDWARFSA EQU   SDWAMCH+16
@NM00122 EQU   SDWAMCH+14
SDWAVEQR EQU   SDWARSR2
SDWAPGFX EQU   SDWARSR2
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00121 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAREGU EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00120 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00119 EQU   SDWAINC2
@NM00118 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00117 EQU   SDWAILC2
@NM00116 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00115 EQU   SDWANXT2
@NM00114 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00113 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00112 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00111 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00110 EQU   SDWAINC1
@NM00109 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00108 EQU   SDWAILC1
@NM00107 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00106 EQU   SDWANXT1
@NM00105 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00104 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00103 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00102 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00101 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR15 EQU   SDWAGRSV+60
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00100 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00099 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
SDWACMPC EQU   SDWAABCC+1
@NM00098 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00097 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
SDWAREQ  EQU   SDWACMPF
@NM00096 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBCAUF  EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00095 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00094 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00093 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
ASCBNEXT EQU   TCBASCB+8
TCBNEXT  EQU   TCBASCB
CHSAVWD2 EQU   CHSHORT+100
CHSAVWD1 EQU   CHSHORT+96
CHJSCBVS EQU   CHSHORT+92
CHUSCVS  EQU   CHSHORT+88
@NM00091 EQU   CHSHORT+84
@NM00090 EQU   CHSHORT+80
CHSQA    EQU   CHSHORT+44
CHQPA    EQU   CHSHORT+8
CHJCL    EQU   CHSHORT+4
CHSPC    EQU   CHSHORT
CHSPB    EQU   CHSTEP+4
CHTCB    EQU   CHSTEP+1
CHARSV23 EQU   CHSWT
CHARSV22 EQU   CHSWT
CHARSV21 EQU   CHSWT
CHAC     EQU   CHSWT
CHPSF    EQU   CHSWT
CHPSD    EQU   CHSWT
CHJCT    EQU   CHSWT
CHARSV20 EQU   CHSWT
CHECB    EQU   CHASM+16
CHARSV18 EQU   CHRGNSZ+1
CHRPRTY  EQU   CHRGNSZ
@NM00089 EQU   CHCIBP
CHEND    EQU   CHCIBP
CHECBP   EQU   CHASM
CHDER    EQU   CHPROCSN+4
CHARSV10 EQU   CHACT1
CHARSV09 EQU   CHACT1
CHARSV08 EQU   CHACT1
CHARSV07 EQU   CHACT1
CHARSV06 EQU   CHACT1
CHARSV05 EQU   CHACT1
CHARSV04 EQU   CHACT1
CHRDWTR  EQU   CHACT1
CHARSV30 EQU   CHPROCSN+2
CHQID    EQU   CHPROCSN
CHCIBCTR EQU   CHAIN+27
CHUNIT   EQU   CHAIN+24
CHPCOI   EQU   CHPARM
CHAFORCE EQU   CHIFY
CHAIFX   EQU   CHACT
CHCLD    EQU   CHACT
CHCL     EQU   CHACT
CHDSI    EQU   CHACT
CHDISC   EQU   CHACT
CHTERM   EQU   CHACT
CHSWAP   EQU   CHACT
CHABTERM EQU   CHSTS
CHDL     EQU   CHSTS
CHAD     EQU   CHSTS
CHQSPC   EQU   CHSTS
CHSOUT   EQU   CHSTS
CHSYS    EQU   CHSTS
CHAP     EQU   CHSTS
CHSZE    EQU   CHFLG+1
MSSPARE  EQU   BASES01+48
MSUCBAL  EQU   BASES01+44
MSUCBPR  EQU   BASES01+40
MSBOBECB EQU   BASES01+36
MSSJQ    EQU   BASES01+32
MSECB    EQU   BASES01+28
MSPBP    EQU   BASES01+24
MSERM    EQU   BASES01+22
MSPASS   EQU   BASES01+14
MSVRB    EQU   BASES01+6
MSQHR    EQU   MSFHF
@NM00088 EQU   MSFHF
MSPSDT   EQU   MSFHF
MSREPLYB EQU   MSFHF
MSFAX    EQU   MSFHF
MSTTT    EQU   MSFHF
MSCSD    EQU   MSFHF
MSNMF    EQU   MSFHF
MSJNF    EQU   MSSSA
MSYOUT   EQU   MSNWP
MSNRP    EQU   MSSSA
MSSRDR   EQU   MSREOF
MSWRLOG  EQU   MSSSA
MSNUPSW  EQU   MSSSA
MSWRPEN  EQU   MSSSA
MSSSSIPL EQU   MSINLSW
MSSUM    EQU   MSECBFL
MSMCR    EQU   MSECBFL
MSYSOUT  EQU   MSECBFL
MSYSIN   EQU   MSECBFL
MSATTN   EQU   MSECBFL
MSWTL    EQU   MSECBFL
MSWTO    EQU   MSECBFL
MSEXT    EQU   MSECBFL
MSCCS    EQU   MSPFG
MSBSP    EQU   MSPFG
MSSYT    EQU   MSPFG
MSSYN    EQU   MSPFG
MSICR    EQU   MSPFG
MSCMC    EQU   MSPFG
MSPNB    EQU   MSPFG
MSDATE   EQU   MSPFG
@NM00087 EQU   MSBTN
MSTN     EQU   MSBTN
@NM00086 EQU   MSBTN
@NM00085 EQU   MSBTN
MSSO     EQU   MSBTN
MSROLFLG EQU   MSBTN
MSCANFLG EQU   MSBTN
MSCONFLG EQU   MSBTN
MSPNIP   EQU   MSNTAL
MSQNIP   EQU   MSNTAL
MSCURE34 EQU   MSNTAL
@NM00084 EQU   MSNTAL
@NM00083 EQU   MSNTAL
@NM00082 EQU   MSNTAL
@NM00081 EQU   MSNTAL
MSNIP    EQU   MSNTAL
@NM00080 EQU   MS1BASEX+40
@NM00079 EQU   MS1BASEX+20
@NM00078 EQU   MS1BASEX
@NM00077 EQU   BASE+128
MSLGJSCB EQU   BASE+124
@NM00076 EQU   MSSTRTSW
MSSTRTP  EQU   MSSTRTSW
MSSTRTW  EQU   MSSTRTSW
@NM00075 EQU   MSWTRSW
MSWTRP   EQU   MSWTRSW
MSWTRW   EQU   MSWTRSW
@NM00074 EQU   MSWLOGSW
MSWLOGP  EQU   MSWLOGSW
MSWLOGW  EQU   MSWLOGSW
@NM00073 EQU   MSCLOSSW
MSCLOSP  EQU   MSCLOSSW
MSCLOSW  EQU   MSCLOSSW
MSLOGLMT EQU   @NM00072+1
MSLOGCLS EQU   @NM00072
BAASCB   EQU   BASE+100
MSSMFPRM EQU   BASE+96
MSCOMMND EQU   BASE+92
BASP12   EQU   BASE+90
BASTCNT  EQU   BASE+88
BASESCT  EQU   BASE+86
BAJNCNT  EQU   BASE+84
BASUBECB EQU   BASE+80
BALOGCOM EQU   BASE+76
BADACNT  EQU   BASE+74
BATACNT  EQU   BASE+72
BAJBNR   EQU   BASE+64
BASP11   EQU   BASE+62
BALCCNT  EQU   BASE+61
BADUMPID EQU   BASE+60
BABCMAX  EQU   BASE+58
BAMONTR2 EQU   BASE+57
@NM00071 EQU   BAMONITR
BAMACTVE EQU   BAMONITR
@NM00070 EQU   BAMONITR
@NM00069 EQU   BAMONITR
@NM00068 EQU   BAMONITR
@NM00067 EQU   BAMONITR
BASPACE  EQU   BAMONITR
BADSN    EQU   BAMONITR
BADSO    EQU   BASE+52
BALOGECB EQU   BASE+48
@NM00066 EQU   BASPBYTE
@NM00065 EQU   BASPBYTE
@NM00064 EQU   BASPBYTE
@NM00063 EQU   BASPBYTE
@NM00062 EQU   BASPBYTE
BAMASCH  EQU   BASPBYTE
BATRACE  EQU   BASPBYTE
BAMSSTAR EQU   BASPBYTE
@NM00061 EQU   MSLOGST
@NM00060 EQU   MSLOGST
MSLOGSTA EQU   MSLOGST
MSLOGIPL EQU   MSLOGST
MSLOGDAR EQU   MSLOGST
MSLOGCOM EQU   MSLOGST
MSLOGTHD EQU   MSLOGST
MSLOGENQ EQU   MSLOGST
BAMIPAR2 EQU   BASE+44
BAMINPAR EQU   BASE+42
BAPKES   EQU   BASE+40
BAICTR   EQU   BASE+38
@NM00059 EQU   BASE+37
BADSET   EQU   BARSW
BANOSET  EQU   BARSW
BAMIDNT  EQU   BARSW
BAHR     EQU   BARSW
BAVU     EQU   BARSW
BAINTSET EQU   BARSW
MSTODWTO EQU   BARSW
BAIN     EQU   BARSW
BACV     EQU   BASE+32
@NM00058 EQU   BALOG
@NM00057 EQU   BALOG
@NM00056 EQU   BALOG
@NM00055 EQU   BALOG
@NM00054 EQU   BALOG
@NM00053 EQU   BALOG
@NM00052 EQU   BALOG
BALOGINT EQU   BALOG
MSLOGSVC EQU   BALGSTAT
BAPRC    EQU   BASE+20
BAQ      EQU   BASE+16
BAIPLCC  EQU   @NM00050+2
@NM00051 EQU   @NM00050
BAIPL    EQU   BASE+12
BALAD    EQU   BASE+8
BATRM    EQU   BASE+4
UCMPRSV2 EQU   UCMPEXTA+20
UCMPRSV1 EQU   UCMPDM1+8
UCMPNMCC EQU   UCMPDM1+4
UCMPWQE  EQU   UCMPDM1
UCMPUCMP EQU   UCMPEXTA
UCMFRSV3 EQU   UCMFEXTA+20
UCMF80WQ EQU   UCMFEXTA+18
UCMF60WQ EQU   UCMFEXTA+16
UCMFRSV2 EQU   UCMFMGFS+4
UCMFRSV1 EQU   UCMFMGFS+2
UCMFFLG2 EQU   UCMFMGFS+1
UCMFBR07 EQU   UCMFFLG1
UCMFBR06 EQU   UCMFFLG1
UCMFBR05 EQU   UCMFFLG1
UCMFBR04 EQU   UCMFFLG1
UCMFBR03 EQU   UCMFFLG1
UCMFMSGN EQU   UCMFFLG1
UCMFMSGA EQU   UCMFFLG1
UCMFMSGE EQU   UCMFFLG1
UCMFPPTR EQU   UCMFEXTA+4
UCMFUCMF EQU   UCMFEXTA
UCMRCTA  EQU   UCMRCT+1
UCMRSV31 EQU   UCMSDS5
UCMSDS5G EQU   UCMSDS5
UCMSDS5F EQU   UCMSDS5
UCMRSV30 EQU   UCMSDS5
UCMRSV29 EQU   UCMSDS5
UCMSDS5C EQU   UCMSDS5
UCMSDS5B EQU   UCMSDS5
UCMSDS5A EQU   UCMSDS5
UCMMLAST EQU   UCMLIST+64
UCMVHRSN EQU   UCMDEVC
UCMDEVG  EQU   UCMDEVC
UCMDEVF  EQU   UCMDEVC
UCMDEVE  EQU   UCMDEVC
UCMDEVD  EQU   UCMDEVC
UCMDEVCC EQU   UCMDEVC
UCMDEVB  EQU   UCMDEVC
UCMDEVA  EQU   UCMDEVC
UCMXOR   EQU   UCMLIST+62
UCMMSG2  EQU   UCMMSG+1
UCMRSV27 EQU   UCMMSG1
UCMRSV26 EQU   UCMMSG1
UCMMSGF  EQU   UCMMSG1
UCMMSGE  EQU   UCMMSG1
UCMMSGD  EQU   UCMMSG1
UCMMSGC  EQU   UCMMSG1
UCMMSGB  EQU   UCMMSG1
UCMMSGA  EQU   UCMMSG1
UCMCOMPC EQU   UCMLIST+56
UCMWLAST EQU   UCMLIST+52
UCMOAOEN EQU   UCMLIST+48
UCMALTEN EQU   UCMLIST+44
UCMRV007 EQU   UCMDISP2
UCMRV006 EQU   UCMDISP2
UCMRV005 EQU   UCMDISP2
UCMRV004 EQU   UCMDISP2
UCMRV003 EQU   UCMDISP2
UCMDISPK EQU   UCMDISP2
UCMDISPJ EQU   UCMDISP2
UCMDISPI EQU   UCMDISP2
UCMDISPH EQU   UCMDISP1
UCMDISPG EQU   UCMDISP1
UCMDISPF EQU   UCMDISP1
UCMDISPE EQU   UCMDISP1
UCMDISPD EQU   UCMDISP1
UCMDISPC EQU   UCMDISP1
UCMDISPB EQU   UCMDISP1
UCMDISPA EQU   UCMDISP1
UCMAUTHB EQU   UCMAUTH+1
UCMRSV23 EQU   UCMAUTHA
UCMRSV22 EQU   UCMAUTHA
UCMRSV21 EQU   UCMAUTHA
UCMRSV20 EQU   UCMAUTHA
UCMRSV19 EQU   UCMAUTHA
UCMAUTH3 EQU   UCMAUTHA
UCMAUTH2 EQU   UCMAUTHA
UCMAUTH1 EQU   UCMAUTHA
UCMOUTQ  EQU   UCMLIST+36
UCMRSV18 EQU   UCMLIST+34
UCMRTCD  EQU   UCMLIST+32
@NM00049 EQU   UCMXA+1
UCMID    EQU   UCMXA
UCMRSV17 EQU   UCMATR
UCMRSV16 EQU   UCMATR
UCMAT04  EQU   UCMATR
UCMLF    EQU   UCMATR
UCMUF    EQU   UCMATR
UCMXF    EQU   UCMATR
UCMIF    EQU   UCMATR
UCMOF    EQU   UCMATR
UCMTC    EQU   UCMSTS
UCMTD    EQU   UCMSTS
UCMTB    EQU   UCMSTS
UCMTA    EQU   UCMSTS
UCMCF    EQU   UCMSTS
UCMBF    EQU   UCMSTS
UCMPF    EQU   UCMSTS
UCMAF    EQU   UCMSTS
UCMNAME  EQU   UCMLIST+16
UCMUCB   EQU   UCMLIST+12
UCMDCB   EQU   UCMLIST+8
UCMSBR   EQU   UCMLIST+4
UCMECB   EQU   UCMLIST
UCMTPSAV EQU   UCMEXIT+208
UCMXTSAV EQU   UCMEXIT+136
UCMDESCD EQU   UCMEXIT+132
UCMROUTC EQU   UCMEXIT+128
UCMMSTXT EQU   UCMEXIT
UCMDECBA EQU   UCMEIL+20
UCMOECBA EQU   UCMEIL+16
UCMAECBA EQU   UCMEIL+12
UCMXECBA EQU   UCMEIL+8
UCMNIPTR EQU   UCMEIL+4
UCMRSV15 EQU   UCMEIL+3
UCMRTCT  EQU   UCMEIL+2
UCMRPYL  EQU   UCMEIL+1
@NM00048 EQU   UCMEIL
UCMRSV60 EQU   UCM+302
UCMRSV59 EQU   UCMRSV51
UCMRSV58 EQU   UCMRSV51
UCMRSV57 EQU   UCMRSV51
UCMRSV56 EQU   UCMRSV51
UCMRSV55 EQU   UCMRSV51
UCMRSV54 EQU   UCMRSV51
UCMRSV53 EQU   UCMRSV51
UCMRSV52 EQU   UCMRSV51
UCMRSV50 EQU   UCMRSV42
UCMRSV49 EQU   UCMRSV42
UCMRSV48 EQU   UCMRSV42
UCMRSV47 EQU   UCMRSV42
UCMRSV46 EQU   UCMRSV42
UCMRSV45 EQU   UCMRSV42
UCMRSV44 EQU   UCMRSV42
UCMRSV43 EQU   UCMRSV42
UCMJES3T EQU   UCM+296
UCMWAKUP EQU   UCM+292
UCMFRRAD EQU   UCM+288
UCMSWCH  EQU   UCM+284
UCMASCB  EQU   UCM+280
UCMWQECP EQU   UCM+276
UCMORECP EQU   UCM+272
UCMOECBT EQU   UCM+268
UCMOECBH EQU   UCM+264
UCMWECBT EQU   UCM+260
UCMWECBH EQU   UCM+256
UCMMBEND EQU   UCM+252
UCMCTID  EQU   UCM+250
UCMRSV61 EQU   UCM+248
UCMRP2AD EQU   UCM+244
UCMCRAAD EQU   UCM+240
UCMWQLM1 EQU   UCM+238
UCMRV001 EQU   UCM+237
UCMRQLM1 EQU   UCM+236
UCMMBPTR EQU   UCM+232
UCMMQNXT EQU   UCM+228
UCMMQEND EQU   UCM+224
UCMMQPTR EQU   UCM+220
UCMTRECB EQU   UCM+216
UCMMNECB EQU   UCM+212
UCMMNTR  EQU   UCM+208
UCMR9SV  EQU   UCM+204
UCMSAVE4 EQU   UCM+140
UCMSAVE3 EQU   UCM+84
UCMVEL   EQU   UCMVDATA+8
UCMINCR  EQU   UCM+71
UCMMODEL EQU   UCM+70
UCMCORE  EQU   UCM+69
UCMFIX   EQU   UCMMODE
UCMMCS   EQU   UCMMODE
UCMOGCE  EQU   UCMMODE
UCMAMFA  EQU   UCMMODE
UCMRSV14 EQU   UCMMODE
UCMTPUTA EQU   UCMMODE
UCMNOCON EQU   UCMMODE
UCMRSV11 EQU   UCMMODE
UCMPXA   EQU   UCM+64
UCMWQEND EQU   UCM+60
UCMWQNR  EQU   UCM+58
UCMRQNR  EQU   UCM+56
UCMWQECB EQU   UCM+52
UCMRQECB EQU   UCM+48
UCMWQLM  EQU   UCM+46
UCMRQLM  EQU   UCM+45
@NM00047 EQU   UCMRPYI
UCMRPYQ  EQU   UCM+28
UCMWTOQ  EQU   UCM+24
UCMLSTP  EQU   UCM+20
UCMARECB EQU   UCM+16
UCMLECB  EQU   UCMDECB
UCMOECB  EQU   UCM+8
UCMAECB  EQU   UCM+4
UCMXECB  EQU   UCM
UCMGMCNT EQU   UCMPRFX+158
UCMSDS2  EQU   UCMPRFX+157
UCMRSV09 EQU   UCMSDS1
UCMRSV08 EQU   UCMSDS1
UCMRSV07 EQU   UCMSDS1
UCMRSV06 EQU   UCMSDS1
UCMRSV05 EQU   UCMSDS1
UCMRSV04 EQU   UCMSDS1
UCMSDS1B EQU   UCMSDS1
UCMSDS1A EQU   UCMSDS1
UCMDTINT EQU   UCMPRFX+152
UCMLOGAD EQU   UCMPRFX+148
UCMNPECB EQU   UCMPRFX+144
UCMTPPTR EQU   UCMPRFX+140
UCMDOMRT EQU   UCMPRFX+136
UCMRUTCK EQU   UCMPRFX+132
UCMQRTN  EQU   UCMPRFX+128
UCM6WD   EQU   UCMXSA+20
UCM5WD   EQU   UCMXSA+16
UCM4WD   EQU   UCMXSA+12
UCM3WD   EQU   UCMXSA+8
UCM2WD   EQU   UCMXSA+4
UCM1WD   EQU   UCMXSA
UCMRSV03 EQU   UCMPRFX+102
UCMHRDRT EQU   UCMPRFX+100
UCMUEXIT EQU   UCMPRFX+97
UCMXCT   EQU   UCMPRFX+96
UCMHCUCM EQU   UCMPRFX+92
UCMCMID  EQU   UCMPRFX+88
UCMOWTOR EQU   UCMPRFX+86
UCMRSV02 EQU   UCMSFLG2
UCMSYSO  EQU   UCMSFLG2
UCMSYSN  EQU   UCMSFLG2
UCMSYSM  EQU   UCMSFLG2
UCMSYSL  EQU   UCMSFLG2
UCMSYSK  EQU   UCMSFLG2
UCMSYSJ  EQU   UCMSFLG2
UCMSYSI  EQU   UCMSFLG2
UCMRSV35 EQU   UCMSFLG1
UCMSYSG  EQU   UCMSFLG1
UCMSYSF  EQU   UCMSFLG1
UCMSYSE  EQU   UCMSFLG1
UCMSYSD  EQU   UCMSFLG1
UCMSYSC  EQU   UCMSFLG1
UCMSYSB  EQU   UCMSFLG1
UCMRSV01 EQU   UCMSFLG1
UCMWTOX  EQU   UCMPRFX+80
UCMDOME  EQU   UCMPRFX+76
UCMSVR0  EQU   UCMSAVE0+68
UCMSVQ0  EQU   UCMSAVE0+64
UCMSVP0  EQU   UCMSAVE0+60
UCMSVO0  EQU   UCMSAVE0+56
UCMSVN0  EQU   UCMSAVE0+52
UCMSVM0  EQU   UCMSAVE0+48
UCMSVL0  EQU   UCMSAVE0+44
UCMSVK0  EQU   UCMSAVE0+40
UCMSVJ0  EQU   UCMSAVE0+36
UCMSVI0  EQU   UCMSAVE0+32
UCMSVH0  EQU   UCMSAVE0+28
UCMSVG0  EQU   UCMSAVE0+24
UCMSVF0  EQU   UCMSAVE0+20
UCMSVE0  EQU   UCMSAVE0+16
UCMSVD0  EQU   UCMSAVE0+12
UCMSVC0  EQU   UCMSAVE0+8
UCMSVB0  EQU   UCMSAVE0+4
UCMSVA0  EQU   UCMSAVE0
UCMMCENT EQU   UCMPRFX
UCM2FEXT EQU   UCM2EXT+12
UCM2STAA EQU   UCM2STA+1
UCMRV008 EQU   UCM2SFLG
UCMRSV34 EQU   UCM2SFLG
UCMRSV33 EQU   UCM2SFLG
UCM2WTOI EQU   UCM2SFLG
UCM2DSTR EQU   UCM2SFLG
UCM2DTAK EQU   UCM2SFLG
UCM2SENT EQU   UCM2SFLG
UCM2SDWA EQU   UCM2SFLG
UCM2PST  EQU   UCM2EXT+4
UCM2RID  EQU   UCM2EXT+2
UCM2WID  EQU   UCM2EXT
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00046 EQU   CVTFIX+248
@NM00045 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
DCMACBND EQU   DCMACB+40
DCMAPAD  EQU   DCMACLR+27
@NM00044 EQU   DCMATRCK
@NM00043 EQU   DCMATRCK
DCMATTSL EQU   DCMATRCK
DCMATTS  EQU   DCMATRCK
@NM00042 EQU   DCMATRCK
@NM00041 EQU   DCMATRCK
DCMATJBL EQU   DCMATRCK
DCMATJOB EQU   DCMATRCK
@NM00040 EQU   DCMADFLG
@NM00039 EQU   DCMADFLG
@NM00038 EQU   DCMADFLG
@NM00037 EQU   DCMADFLG
@NM00036 EQU   DCMADFLG
DCMACSIB EQU   DCMADFLG
DCMADD   EQU   DCMADFLG
@NM00035 EQU   DCMAFLG2
@NM00034 EQU   DCMAFLG2
@NM00033 EQU   DCMAFLG2
@NM00032 EQU   DCMAFLG2
DCMAMJFR EQU   DCMAFLG2
DCMARCON EQU   DCMAFLG2
DCMAWCON EQU   DCMAFLG2
DCMALMIN EQU   DCMAFLG2
@NM00031 EQU   DCMAFLG1
@NM00030 EQU   DCMAFLG1
DCMABL   EQU   DCMAFLG1
DCMAFRPR EQU   DCMAFLG1
DCMADISP EQU   DCMAFLG1
@NM00029 EQU   DCMAFLG1
DCMAMT   EQU   DCMACLR+15
DCMATIME EQU   DCMACLR+11
DCMAMIN  EQU   DCMACLR+7
DCMAMJWQ EQU   DCMACLR+3
DCMAFR   EQU   DCMACLR+1
DCMAROW  EQU   DCMACLR
DCMATOP  EQU   DCMACB+8
DCMALN   EQU   DCMACB+6
DCMAGM   EQU   DCMASACB
DCMAUSE  EQU   DCMASACB
DCMPLNPR EQU   DCMPACB+2
DCMPLN   EQU   DCMPACB
DCMMSGSV EQU   DCMTSRT+56
@NM00028 EQU   DCMTSRT+52
DCMRQDEL EQU   DCMTSRT+48
@NM00027 EQU   DCMTSRT+46
@NM00026 EQU   DCMR3FLG
@NM00025 EQU   DCMR3FLG
DCMRXHMT EQU   DCMR3FLG
DCMR3PKA EQU   DCMR3FLG
DCMRXSCN EQU   DCMR3FLG
DCMCLPR  EQU   DCMR3FLG
DCMKVIP  EQU   DCMR3FLG
DCMSTSWT EQU   DCMR3FLG
@NM00024 EQU   DCMR2FLG
DCMRXTIM EQU   DCMR2FLG
@NM00023 EQU   DCMR2FLG
DCMRXDEL EQU   DCMR2FLG
DCMRXRLL EQU   DCMR2FLG
DCMRXTMR EQU   DCMR2FLG
DCMRXUNV EQU   DCMR2FLG
DCMRXSFL EQU   DCMR2FLG
DCMTMCTR EQU   DCMTSRT+42
DCMINTVL EQU   DCMTSRT+40
DCMADPFK EQU   DCMTSRT+36
DCMSUBAD EQU   DCMTSRT+32
DCMDOMKY EQU   DCMTSRT+30
DCMRMSAL EQU   DCMTSRT+28
DCMWLAST EQU   DCMTSRT+24
DCMADRMS EQU   DCMTSRT+21
DCMRMS   EQU   DCMTSRT+20
@NM00022 EQU   DCMDEVTY
@NM00021 EQU   DCMDEVTY
@NM00020 EQU   DCMDEVTY
@NM00019 EQU   DCMDEVTY
@NM00018 EQU   DCMDEVTY
@NM00017 EQU   DCMDEVTY
DCMTY50  EQU   DCMDEVTY
DCMTY60  EQU   DCMDEVTY
@NM00016 EQU   @NM00008
@NM00015 EQU   @NM00008
@NM00014 EQU   @NM00008
@NM00013 EQU   @NM00008
@NM00012 EQU   @NM00008
@NM00011 EQU   @NM00008
@NM00010 EQU   @NM00008
@NM00009 EQU   @NM00008
DCMTOPDS EQU   DCMTSRT+13
DCMTOPAR EQU   DCMTSRT+12
DCMADKP  EQU   DCMTSRT+8
DCMLEN   EQU   DCMTSRT+6
@NM00007 EQU   DCMRFLGS
@NM00006 EQU   DCMRFLGS
@NM00005 EQU   DCMRFLGS
DCMNIPP  EQU   DCMRFLGS
DCMDOM   EQU   DCMRFLGS
@NM00004 EQU   DCMRFLGS
@NM00003 EQU   DCMRFLGS
@NM00002 EQU   DCMRFLGS
@NM00001 EQU   DCMTSRT+4
DCMADTRN EQU   DCMTSRT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RF00207 EQU   @EL00001
@RC00312 EQU   @RC00311
@RF00629 EQU   @RC00626
@ENDDATA EQU   *
         END   IEECB800,(C'PLS1033',0701,78053)

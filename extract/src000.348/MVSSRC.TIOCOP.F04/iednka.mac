         TITLE 'IEDNKA, CONTROL NIR GENERATOR                          *
                        '
IEDNKA   CSECT ,                                                01S0001
@PROLOG  DS    0H                                               01S0002
*                                                         /* @Y17XAIK*/
*                                   /*
         USING *,RBASE                 MODULE ADDRESSABILITY
         DC    AL4(0)                  ELEMENT CHAIN
         DC    AL4(0)                  LINK FIELD
         DC    XL1'06'                 STCB VTO
         DC    AL3(*-1)                POINTER TO STCB VTO
*   RBASE=IEDQQPTR;                 /* SET MODULE BASE REG           */
         LR    RBASE,IEDQQPTR                                   02S0567
*   GEN REFS(RBASE) NOSETS;                                     02S0568
*                                                         /* @Y17XAIK*/
*                                   /*
IEDNKA   IEDHJN AFTERHJN,HJN            IDENTIFICATION MACRO
*   RFY                                                         02S0569
*     IEDQQPTR UNRSTD;              /* RELEASE REGISTER              */
*                                                               02S0570
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS: PROCESS SEGMENT - THIS SEGMENT IS THE TOP LEVEL      */
*   /* PROCESS SEGMENT FOR THIS MODULE.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0570
*   IF RPARM->PRFTICON=ON THEN      /* IF ELEMENT IS A BUFFER THEN   */
         TM    PRFTICON(RPARM),B'00001000'                      02S0570
         BNO   @RF00570                                         02S0570
*                                                               03S0571
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS.BUFFER: BUFFER INPUT SEGMENT.                       */
*     /*                                                             */
*     /***************************************************************/
*                                                               03S0571
*     DO;                                                       03S0571
*       RPRF=RPARM;                 /* SET BFR BASE REG              */
         LR    RPRF,RPARM                                       03S0572
*       IF PRFPRI=PRIASYNC THEN     /* TEST TYPE OF BFR INPUT        */
         CLI   PRFPRI(RPRF),X'E6'                               03S0573
         BNE   @RF00573                                         03S0573
*         DO;                       /* IT IS AN ASYNCHRONOUS REQUEST */
*           RPARM=PRFDEST;          /* GET TNT INDEX                 */
         LH    RPARM,PRFDEST(,RPRF)                             03S0575
*           CALL IEDQTNT;           /* GET TRM ADDRESS               */
         L     @15,AVTRNMPT(,RAVT)                              03S0576
         BALR  @14,@15                                          03S0576
*           RTRM=RPARM-LENGTH(IEDNTRM);/* SET TRM BASE REG           */
         LA    @10,14                                           03S0577
         LR    RTRM,RPARM                                       03S0577
         SLR   RTRM,@10                                         03S0577
*           IF TRMSNA=ON THEN       /* IF IT IS A SNA RESOURCE THEN
*                                      IT IS A REQUEST FOR A NEGATIVE
*                                      RESPONSE TO RTR.              */
         TM    TRMSNA(RTRM),B'00000010'                         03S0578
         BNO   @RF00578                                         03S0578
*                                                               04S0579
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.BUFFER.SNARESP: THIS SEGMENT BUILDS A       */
*             /* NEGATIVE RESPONSE TO RTR IN THE BUFFER WITH WHICH   */
*             /* NKA WAS INVOKED AND THEN POSTS THE RESPONSE TO      */
*             /* IEDDFOUT.                                   @Y17XAIK*/
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0579
*             DO;                                               04S0579
*               RFY                                             04S0580
*                 IEDRH BASED(ADDR(PIURH));/*                @Y17XAIK*/
*               RFY                                             04S0581
*                 IEDTH BASED(ADDR(PIUTH));/*                @Y17XAIK*/
*               BUFTOCLR(1:BUFTCLEN)=BUFTOCLR(1:BUFTCLEN)&&/*   04S0582
*                                                            @Y17XAIK*/
*                   BUFTOCLR(1:BUFTCLEN);/* CLEAR INPUT BUFFER FOR
*                                      PIU BUILD             @Y17XAIK*/
         LA    @09,8                                            04S0582
         LR    @07,RPRF                                         04S0582
         SLR   @07,@09                                          04S0582
         SLR   @05,@05                                          04S0582
         IC    @05,BUFTCLEN                                     04S0582
         BCTR  @05,0                                            04S0582
         EX    @05,@SX02496                                     04S0582
*               PRF2TNTI=ON;        /* SET PIU PRIME FLAG    @Y17XAIK*/
         OI    PRF2TNTI(@07),B'10000000'                        04S0583
*               PRFTIC=PRFINTIC;    /* RESTORE BUFFER INDICATORS
*                                                            @Y17XAIK*/
         MVC   PRFTIC(4,RPRF),@CB01537                          04S0584
*               PRFPIUO=PIUO;       /* SETUP PIU OFFSET IN BUFFER
*                                                            @Y17XAIK*/
         MVI   PRFPIUO(RPRF),X'01'                              04S0585
*               TTHFTYPE=TTHFID1;   /* SET FID1              @Y17XAIK*/
         LA    @07,PRFPIUO(,RPRF)                               04S0586
         LA    @05,1                                            04S0586
         ALR   @05,@07                                          04S0586
         NI    TTHFTYPE(@05),B'00011111'                        04S0586
         OI    TTHFTYPE(@05),B'00010000'                        04S0586
*               TTHBBIU=ON;         /* SET BEGIN BIU..       @Y17XAIK*/
*               TTHEBIU=ON;         /* AND END BIU TO INDICATE ONLY
*                                      SEGMENT               @Y17XAIK*/
         OI    TTHBBIU(@05),B'00001100'                         04S0588
*               TTHSNF=LCBTHSQ;     /* GET SEQUENCE NUMBER SAVED FROM
*                                      REQUEST               @Y17XAIK*/
         MVC   TTHSNF(2,@05),LCBTHSQ(RLCB)                      04S0589
*               SIBPTR=TRMSIBPT;    /* SET SIB BASE REGISTER @Y17XAIK*/
         SLR   SIBPTR,SIBPTR                                    04S0590
         ICM   SIBPTR,7,TRMSIBPT(RTRM)                          04S0590
*               TTHOAF=SIBINDEX;    /* SOURCE TTCIN          @Y17XAIK*/
         MVC   TTHOAF(2,@05),SIBINDEX(SIBPTR)                   04S0591
*               TTHDAF=PRFDEST;     /* DESTINATION TTCIN     @Y17XAIK*/
         MVC   TTHDAF(2,@05),PRFDEST(RPRF)                      04S0592
*               TTHDCF=LENGTH(IEDRH)+LENGTH(NEGRSPRU);/* RH+SENSE
*                                      DATA+                 @Y17XAIK
*                                      COMMAND CODE          @Y17XAIK*/
         STCM  @09,3,TTHDCF(@05)                                04S0593
*               TRHTYPE=ON;         /* SET RESPONSE          @Y17XAIK*/
         LA    @09,11                                           04S0594
         ALR   @09,@07                                          04S0594
         OI    TRHTYPE(@09),B'10000000'                         04S0594
*               TRHRUCAT=TRHDFC;    /* SET DATA FLOW CONTROL @Y17XAIK*/
         NI    TRHRUCAT(@09),B'11011111'                        04S0595
         OI    TRHRUCAT(@09),B'01000000'                        04S0595
*               TRHFI=ON;           /* SET FORMATTED INDICATOR  04S0596
*                                                            @Y17XAIK*/
*               TRHSDI=ON;          /* SET SENSE DATA INCLUDED  04S0597
*                                                            @Y17XAIK*/
*               TRHBC=ON;           /* SET BEGIN CHAIN..     @Y17XAIK*/
*               TRHEC=ON;           /* AND SET END CHAIN TO INDICATE
*                                      ONLY CHAIN            @Y17XAIK*/
         OI    TRHFI(@09),B'00001111'                           04S0599
*               TRHER=ON;           /* EXCEPTION RESPONSE    @Y17XAIK*/
*               TRHDR1=ON;          /* DEFINITE RESPONSE ONE @Y17XAIK*/
         OI    TRHER(@09),B'10010000'                           04S0601
*               NEGRSPRU=RTRNREQD;  /* RTR NOT REQUIRED EXCEPTION
*                                      RESPONSE              @Y17XAIK*/
         ALR   @07,@10                                          04S0602
         MVC   NEGRSPRU(5,@07),RTRNREQD                         04S0602
*               PRFQCBA=SAVTDFCO;   /* ADDRESS OF IEDDFOUT QCB  04S0603
*                                                            @Y17XAIK*/
         L     @10,AVTSAVTP(,RAVT)                              04S0603
         MVC   PRFQCBA(3,RPRF),SAVTDFCO+1(@10)                  04S0603
*               PRFPRI=PRIOUTBD;    /* OUTBOUND PRIORITY     @Y17XAIK*/
         MVI   PRFPRI(RPRF),X'E4'                               04S0604
*               RPARM=RPRF;         /* POST THE PIU PRIME    @Y17XAIK*/
         LR    RPARM,RPRF                                       04S0605
*               CALL DSPPOSTR;      /* HAVE THE DISPATCHER PLACE OUR
*                                      PIU PRIME             @Y17XAIK
*                                      ON THE READY QUEUE FOR   04S0606
*                                      EVENTUAL POSTING TO IEDDFOUT
*                                                            @Y17XAIK*/
         LA    @15,DSPPOSTR(,RDISP)                             04S0606
         BALR  @14,@15                                          04S0606
*               LCBRTRRO=OFF;       /* RESET RESPONSE OWED TO RTR
*                                                            @Y17XAIK*/
         NI    LCBRTRRO(RLCB),B'11111011'                       04S0607
*               RFY                                             04S0608
*                 IEDTH BASED;      /*                       @Y17XAIK*/
*               RFY                                             04S0609
*                 IEDRH BASED;      /*                       @Y17XAIK*/
*             END;                                              04S0610
*           ELSE                    /* IF IT IS A BSC/SS RESOURCE
*                                      THEN IT IS A REQUEST FOR A
*                                      RESET ERROR LOCK.             */
*                                                               04S0611
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.BUFFER.BSRESET: BISYNC/START STOP RESET     */
*             /* ERROR LOCK SEGMENT - THIS SEGMENT BUILDS A TNT INDEX*/
*             /* RESET ERROR LOCK PIU AND TPOSTS IT TO IEDSAO.       */
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0611
*             DO;                                               04S0611
         B     @RC00578                                         04S0611
@RF00578 DS    0H                                               04S0612
*               RPARM=PRFDEST;      /* PASS DAF AS PARAMETER         */
         LH    RPARM,PRFDEST(,RPRF)                             04S0612
*               CALL IPBSTHRH;      /* INITIALIZE FID0 TH/RH         */
         BAL   @14,IPBSTHRH                                     04S0613
*               IEDBDU=''B;         /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               04S0614
         AL    @10,@CF00095                                     04S0614
         XC    IEDBDU(6,@10),IEDBDU(@10)                        04S0614
*               BDUCMND=CD0CTRL;    /* SET CONTROL COMMAND           */
         MVI   BDUCMND(@10),X'08'                               04S0615
*               BDUMODIF=CD0CREL;   /* SET RESET ERROR LOCK MODIF    */
         MVI   BDUMODIF(@10),X'41'                              04S0616
*               TRMERLCK=OFF;       /* RESET ERROR LOCK INDICATOR    */
         NI    TRMERLCK(RTRM),B'11111011'                       04S0617
*               PRFPRI=PRIASYNC;    /* SET ASYNCHRONOUS PRIORITY     */
         MVI   PRFPRI(RPRF),X'E6'                               04S0618
*               CALL IPBSSAO;       /* POST FID0 PIU TO IEDSAO       */
         BAL   @14,IPBSSAO                                      04S0619
*             END;                                              04S0620
*         END;                                                  03S0621
*       ELSE                        /* IT IS NOT AN ASYNC REQUEST    */
*         DO;                                                   03S0622
         B     @RC00573                                         03S0622
@RF00573 DS    0H                                               03S0623
*           RLCB=PRFLCB;            /* SET PLCB BASE REG             */
         L     RLCB,PRFLCB-1(,RPRF)                             03S0623
         LA    RLCB,0(,RLCB)                                    03S0623
*           RPARM=LCBTTCIN;         /* GET TNT INDEX                 */
         LH    RPARM,LCBTTCIN(,RLCB)                            03S0624
         N     RPARM,@CF02504                                   03S0624
*           CALL IEDQTNT;           /* GET TRM ADDRESS               */
         L     @15,AVTRNMPT(,RAVT)                              03S0625
         BALR  @14,@15                                          03S0625
*           RTRM=RPARM-LENGTH(IEDNTRM);/* SET TRM BASE REG           */
         LR    RTRM,RPARM                                       03S0626
         SL    RTRM,@CF02135                                    03S0626
*           IF LCBSENDN=ON THEN     /* IF SENDING, THEN IT IS THE
*                                      SPECOUT RESPONSE BFR FROM
*                                      IEDSAC TO RESUME PROCESSING AN
*                                      INITIAL SEND                  */
         TM    LCBSENDN(RLCB),B'00000001'                       03S0627
         BNO   @RF00627                                         03S0627
*                                                               04S0628
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.BUFFER.BSSENDR: BISYNC/START STOP SEND      */
*             /* RESUME SEGMENT - THIS SEGMENT PROCESSES THE RESPONSE*/
*             /* TO A SPECOUT OPERATION AND RESUMES THE SEND         */
*             /* OPERATION ACCORDINGLY.                              */
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0628
*             DO;                                               04S0628
*               TRMNLOUT=OFF;       /* RESET NULL OUT INDICATION     */
         NI    TRMNLOUT(RTRM),B'11111011'                       04S0629
*               PRFNBUNT=0;         /* PRFNBUNT HAS THE PIU  @YM04691
*                                      OFFSET.IT MUST BE SET @YM04691
*                                      TO 0 TO FREE THE UNIT @YM04691*/
         MVI   PRFNBUNT(RPRF),X'00'                             04S0630
*               PRFQCBA=ADDR(AVTBFRTB);/* SET QCB TO BFR RETURN      */
         LA    @10,AVTBFRTB(,RAVT)                              04S0631
         STCM  @10,7,PRFQCBA(RPRF)                              04S0631
*               PRFPRI=PRIBFRTB;    /* SET RETURN PRIORITY           */
         MVI   PRFPRI(RPRF),X'E0'                               04S0632
*               RPARM=RPRF;         /* SET BUFFER AS ELEMENT         */
         LR    RPARM,RPRF                                       04S0633
*               CALL DSPPOSTR;      /* FREE SPECOUT RESPONSE BFR     */
         LA    @15,DSPPOSTR(,RDISP)                             04S0634
         BALR  @14,@15                                          04S0634
*               IF SCBSLCTN=ON THEN /* IF REAL ERROR OCCURRED THEN   */
         L     @10,LCBSCBA-1(,RLCB)                             04S0635
         TM    SCBSLCTN(@10),B'10000000'                        04S0635
         BNO   @RF00635                                         04S0635
*                 DO;                                           04S0636
*                   CALL IPERRBFR;  /* TPOST ERROR BFR TO MH         */
         BAL   @14,IPERRBFR                                     04S0637
*                   IF LCBBFRSV^=CHAINEND THEN/* IF MORE BFRS THEN   */
         L     @10,LCBBFRSV-1(,RLCB)                            04S0638
         LA    @10,0(,@10)                                      04S0638
         LTR   @10,@10                                          04S0638
         BZ    @RF00638                                         04S0638
*                     CALL IPFREBFR;/* FREE THEM                     */
         BAL   @14,IPFREBFR                                     04S0639
*                 END;                                          04S0640
*               ELSE                /* IT WAS NOT A REAL ERROR       */
*                 DO;                                           04S0641
         B     @RC00635                                         04S0641
@RF00635 DS    0H                                               04S0642
*                   IF TRMNOSND=ON THEN/* IF SCHEDULING ERROR THEN   */
         TM    TRMNOSND(RTRM),B'00000010'                       04S0642
         BNO   @RF00642                                         04S0642
*                     DO;                                       04S0643
*                       CALL IPFREBFR;/* FREE BFRS ON SAVE CHAIN     */
         BAL   @14,IPFREBFR                                     04S0644
*                       LCBQCBA=AVTMSGS->BDQCB;/* SET IEDQBD QCB ADDR*/
         L     @10,AVTMSGS-1(,RAVT)                             04S0645
         MVC   LCBQCBA(3,RLCB),BDQCB+1(@10)                     04S0645
*                       LCBPRI=PRILCB;/* SET CLEANUP PRIORITY        */
         MVI   LCBPRI(RLCB),X'E7'                               04S0646
*                       LCBRCLLN=ON;/* NO BUFFERS TO FREE    @YM07396*/
         OI    LCBRCLLN(RLCB),B'10000000'                       04S0647
*                       QCBSDFFO=OFF;/* RESET SENDING FEFO   @YM07439*/
         SLR   @10,@10                                          04S0648
         ICM   @10,7,TRMDESTQ(RTRM)                             04S0648
         NI    QCBSDFFO(@10),B'11111011'                        04S0648
*                       RPARM=RLCB; /* SET PLCB AS ELEMENT           */
         LR    RPARM,RLCB                                       04S0649
*                       CALL DSPPOSTR;/* TPOST PLCB TO IEDQBD FOR
*                                      CLEANUP                       */
         LA    @15,DSPPOSTR(,RDISP)                             04S0650
         BALR  @14,@15                                          04S0650
*                     END;                                      04S0651
*                   ELSE            /* THERE WERE NO ERRORS          */
*                     CALL IPMHBFR; /* TPOST BFRS ON THE SAVE CHAIN
*                                      TO OUTPUT MH                  */
         B     @RC00642                                         04S0652
@RF00642 BAL   @14,IPMHBFR                                      04S0652
*                 END;                                          04S0653
*             END;                                              04S0654
*           ELSE                    /* IT IS A RECEIVE CONTINUE 03S0655
*                                      BUFFER FROM IEDQBT OR THE
*                                      ABORT RESPONSE FROM IEDSAC    */
*                                                               04S0655
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.BUFFER.BSRECVCB: BISYNC/START STOP RECEIVE  */
*             /* CONTINUE BUFFER SEGMENT - THIS SEGMENT PROCESSES    */
*             /* READ CONTINUE OR STOP ABORT REQUESTS FROM IEDQBT AND*/
*             /* THE RESPONSE TO AN ABORT FROM IEDSAC.               */
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0655
*             DO;                                               04S0655
         B     @RC00627                                         04S0655
@RF00627 DS    0H                                               04S0656
*               RFY                                             04S0656
*                (RUNITNUM,                                     04S0656
*                 RBFRNUM,                                      04S0656
*                 RRETCODE) RSTD;                               04S0656
*               IF PRFPRI=PRIRESUM THEN/* IF RESPONSE TO ABORT FROM  */
         CLI   PRFPRI(RPRF),X'E5'                               04S0657
         BNE   @RF00657                                         04S0657
*                 DO;               /* IEDSAC THEN                   */
*                   PRFNBUNT=0;     /* PRFNBUNT HAS THE PIU  @YM04691
*                                      OFFSET.IT MUST BE SET @YM04691
*                                      TO 0 TO FREE THE UNIT @YM04691*/
         MVI   PRFNBUNT(RPRF),X'00'                             04S0659
*                   PRFQCBA=ADDR(AVTBFRTB);/* SET BFR RETURN QCB ADDR*/
         LA    @14,AVTBFRTB(,RAVT)                              04S0660
         STCM  @14,7,PRFQCBA(RPRF)                              04S0660
*                   PRFPRI=PRIBFRTB;/* SET BFR RETURN PRIORITY       */
         MVI   PRFPRI(RPRF),X'E0'                               04S0661
*                   RPARM=RPRF;     /* SET ABORT RESPONSE BFR AS
*                                      ELEMENT                       */
         LR    RPARM,RPRF                                       04S0662
*                   CALL DSPPOSTR;  /* FREE ABORT RESPONSE BFR       */
         LA    @15,DSPPOSTR(,RDISP)                             04S0663
         BALR  @14,@15                                          04S0663
*                   RPARM=LCBBFRSV; /* GET ORIGINAL INPUT BFR        */
         L     RPARM,LCBBFRSV-1(,RLCB)                          04S0664
         LA    RPARM,0(,RPARM)                                  04S0664
*                   LCBBFRSV=RPARM->PRFLINK;/* DELINK IT             */
         MVC   LCBBFRSV(3,RLCB),PRFLINK(RPARM)                  04S0665
*                   RPARM->PRFQCBA=LCBMHA;/* SET MH QCB ADDR @YM06085*/
         MVC   PRFQCBA(3,RPARM),LCBMHA(RLCB)                    04S0666
*                   RPARM->PRFPRI=PRIERBFR;/* SET ERROR BFR PRIORITY */
         MVI   PRFPRI(RPARM),X'E3'                              04S0667
*                   CALL DSPPOSTR;  /* TPOST ERROR BFR TO INPUT MH   */
         LA    @15,DSPPOSTR(,RDISP)                             04S0668
         BALR  @14,@15                                          04S0668
*                 END;                                          04S0669
*               ELSE                /* IT IS BFR FROM IEDQBT         */
*                 DO;                                           04S0670
         B     @RC00657                                         04S0670
@RF00657 DS    0H                                               04S0671
*                   LCBBFRSV=RPRF;  /* SAVE INPUT BFR IN SAVE CHAIN  */
         STCM  RPRF,7,LCBBFRSV(RLCB)                            04S0671
*                   PRFLINK=CHAINEND;/* SET END OF CHAIN INDICATOR   */
         SLR   @14,@14                                          04S0672
         STCM  @14,7,PRFLINK(RPRF)                              04S0672
*                   RBFRNUM=1;      /* REQUEST ONE BFR               */
         LA    @14,1                                            04S0673
         LR    RBFRNUM,@14                                      04S0673
*                   RUNITNUM=1;     /* REQUEST ONE UNIT PER BFR      */
         LR    RUNITNUM,@14                                     04S0674
*                   CALL IEDQGA02;  /* ATTEMPT TO STEAL BFR          */
         L     @15,AVTSTEAL(,RAVT)                              04S0675
         BALR  @14,@15                                          04S0675
*                   IF RRETCODE^=0 THEN/* IF BFR OBTAINED THEN       */
         LTR   RRETCODE,RRETCODE                                04S0676
         BZ    @RF00676                                         04S0676
*                     DO;                                       04S0677
*                       LCBERBCH=RRETCODE;/* PUT BFR ON ERB CHAIN    */
         STCM  RRETCODE,7,LCBERBCH(RLCB)                        04S0678
*                       CALL IPBSSTCN;/* EXECUTE STOP OR CONTINUE    */
         BAL   @14,IPBSSTCN                                     04S0679
*                     END;                                      04S0680
*                   ELSE            /* BFR WAS NOT OBTAINED          */
*                     CALL IPREQBFR;/* REQUEST A BFR FROM IEDQGA     */
         B     @RC00676                                         04S0681
@RF00676 BAL   @14,IPREQBFR                                     04S0681
*                 END;                                          04S0682
@RC00676 DS    0H                                               04S0683
*               RFY                                             04S0683
*                (RUNITNUM,                                     04S0683
*                 RBFRNUM,                                      04S0683
*                 RRETCODE) UNRSTD;                             04S0683
@RC00657 DS    0H                                               04S0684
*             END;                                              04S0684
*         END;                                                  03S0685
*     END;                                                      03S0686
*   ELSE                            /* THE ELEMENT IS AN ERB         */
*                                                               03S0687
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS.ERB: ERB INPUT SEGMENT.                             */
*     /*                                                             */
*     /***************************************************************/
*                                                               03S0687
*     DO;                           /* SET PLCB BASE REG             */
         B     @RC00570                                         03S0687
@RF00570 DS    0H                                               03S0688
*       RLCB=RPARM-(ADDR(LCBERB)-ADDR(IEDQLCB));                03S0688
         LR    @10,RPARM                                        03S0688
         SL    @10,@CF02485                                     03S0688
         LR    RLCB,@10                                         03S0688
*       RPARM=LCBTTCIN;             /* GET TNT INDEX                 */
         LH    RPARM,LCBTTCIN(,RLCB)                            03S0689
         N     RPARM,@CF02504                                   03S0689
*       CALL IEDQTNT;               /* GET TRM ADDRESS               */
         L     @15,AVTRNMPT(,RAVT)                              03S0690
         BALR  @14,@15                                          03S0690
*       RTRM=RPARM-LENGTH(IEDNTRM); /* SET TRM BASE REG              */
         LR    RTRM,RPARM                                       03S0691
         SL    RTRM,@CF02135                                    03S0691
*       IF TRMSNA=ON THEN           /* IF SNA RESOURCE, THEN THIS IS
*                                      A SNA SEND INITIAL ERB FROM
*                                      IEDQFA OR IEDAYO              */
         TM    TRMSNA(RTRM),B'00000010'                         03S0692
         BNO   @RF00692                                         03S0692
*                                                               04S0693
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS.ERB.SNASEND: IF THE BIND FAILED, POST AN ERROR  */
*         /* BUFFER TO THE MH AND THEN FREE THE REMAINING BUFFERS IN */
*         /* THE MESSAGE. IF THE BIND DID NOT FAIL, INVOKE THE USER'S*/
*         /* PURGE EXIT IF THERE IS ONE. IF OUTPUT IS TO BE PURGED,  */
*         /* POST AN ERROR BUFFER TO THE MH AND THEN FREE THE        */
*         /* REMAINING BUFFERS IN THE MESSAGE. IF THE OUTPUT IS TO BE*/
*         /* SENT, POST IT TO THE MH.                        @Y17XAIK*/
*         /*                                                         */
*         /***********************************************************/
*                                                               04S0693
*         DO;                                                   04S0693
*           LCBBFRSV=LCBERBCH;      /* MOVE THE BUFFER CHAIN ADDRESS
*                                                            @Y17XAIK*/
         MVC   LCBBFRSV(3,RLCB),LCBERBCH(RLCB)                  04S0694
*           LCBERBCH=CHAINEND;      /* INDICATE NOT IN USE BY   04S0695
*                                      CLEARING              @Y17XAIK*/
         SLR   @10,@10                                          04S0695
         STCM  @10,7,LCBERBCH(RLCB)                             04S0695
*           SIBPTR=TRMSIBPT;        /* SET UP SIB ADDRESSABILITY
*                                                            @Y17XAIK*/
         SLR   SIBPTR,SIBPTR                                    04S0696
         ICM   SIBPTR,7,TRMSIBPT(RTRM)                          04S0696
*           IF SIBCHAIN=CHAINEND    /* IF NO LU-LU SIB       @Y17XAIK*/
*               ×SIBDSTAT^=SIBDACTV /* ..OR DATA TRAFFIC STATE IS NOT
*                                      ACTIVE                @Y17XAIK*/
*             THEN                                              04S0697
         C     @10,SIBCHAIN(,SIBPTR)                            04S0697
         BE    @RT00697                                         04S0697
         TM    SIBDSTAT(SIBPTR),B'00000011'                     04S0697
         BO    @RF00697                                         04S0697
@RT00697 DS    0H                                               04S0698
*             DO;                   /* THEN THE BIND FAILED  @Y17XAIK*/
*               SCBSLCTN=ON;        /* SET SELECTION ERROR FOR THE MH
*                                                            @Y17XAIK*/
*               SCBCONNN=ON;        /* SET CONNECTION ERROR FOR THE
*                                      MH                    @Y17XAIK*/
         L     @10,LCBSCBA-1(,RLCB)                             04S0700
         OI    SCBSLCTN(@10),B'10100000'                        04S0700
*               CALL IPERRBFR;      /* POST AN ERROR BUFFER TO THE MH
*                                                            @Y17XAIK*/
         BAL   @14,IPERRBFR                                     04S0701
*               IF LCBBFRSV^=CHAINEND/* IF THERE ARE MORE BUFFERS IN
*                                      THE                   @Y17XAIK
*                                      MESSAGE               @Y17XAIK*/
*                 THEN                                          04S0702
         L     @10,LCBBFRSV-1(,RLCB)                            04S0702
         LA    @10,0(,@10)                                      04S0702
         LTR   @10,@10                                          04S0702
         BZ    @RF00702                                         04S0702
*                 CALL IPFREBFR;    /* ..THEN FREE THE REMAINING
*                                      BUFFERS IN            @Y17XAIK
*                                      THE MESSAGE           @Y17XAIK*/
         BAL   @14,IPFREBFR                                     04S0703
*               ELSE                                            04S0704
*                 ;                 /*                       @Y17XAIK*/
@RF00702 DS    0H                                               04S0705
*             END;                  /*                       @Y17XAIK*/
*           ELSE                                                04S0706
*             DO;                   /* ELSE THE BIND DID NOT FAIL
*                                                            @Y17XAIK*/
         B     @RC00697                                         04S0706
@RF00697 DS    0H                                               04S0707
*               CALL IPPURGEX;      /* INVOKE THE USER'S PURGE EXIT
*                                      IF THERE IS           @Y17XAIK
*                                      ONE                   @Y17XAIK*/
         BAL   @14,IPPURGEX                                     04S0707
*               IF SCBTRMLN=ON      /* IF OUTPUT BUFFERS ARE TO BE
*                                      PURGED                @Y17XAIK*/
*                 THEN                                          04S0708
         L     @10,LCBSCBA-1(,RLCB)                             04S0708
         TM    SCBTRMLN(@10),B'00010000'                        04S0708
         BNO   @RF00708                                         04S0708
*                 DO;               /*                       @Y17XAIK*/
*                   CALL IPERRBFR;  /* POST AN ERROR BUFFER TO THE MH
*                                                            @Y17XAIK*/
         BAL   @14,IPERRBFR                                     04S0710
*                   IF LCBBFRSV^=CHAINEND/* IF THERE ARE MORE BUFFERS
*                                      IN THE                @Y17XAIK
*                                      MESSAGE               @Y17XAIK*/
*                     THEN                                      04S0711
         L     @10,LCBBFRSV-1(,RLCB)                            04S0711
         LA    @10,0(,@10)                                      04S0711
         LTR   @10,@10                                          04S0711
         BZ    @RF00711                                         04S0711
*                     CALL IPFREBFR;/* ..THEN FREE THE REMAINING
*                                      BUFFERS IN            @Y17XAIK
*                                      THE MESSAGE           @Y17XAIK*/
         BAL   @14,IPFREBFR                                     04S0712
*                   ELSE                                        04S0713
*                     ;             /*                       @Y17XAIK*/
@RF00711 DS    0H                                               04S0714
*                 END;              /*                       @Y17XAIK*/
*               ELSE                                            04S0715
*                 CALL IPMHBFR;     /* POST THE BUFFERS TO THE OUTPUT
*                                      MH                    @Y17XAIK*/
         B     @RC00708                                         04S0715
@RF00708 BAL   @14,IPMHBFR                                      04S0715
*             END;                  /*                       @Y17XAIK*/
*         END;                                                  04S0717
*       ELSE                        /* IT IS A BSC/SS RESOURCE       */
*         IF LCBSENDN=ON THEN       /* IF SENDING, THEN THIS IS 03S0718
*                                      EITHER THE SEND INITIAL ERB
*                                      FROM IEDQFA OR IEDAYO, OR IT
*                                      IS THE ERB FROM IEDIAQ   03S0718
*                                      REQUESTING A DIAL OUT         */
         B     @RC00692                                         03S0718
@RF00692 TM    LCBSENDN(RLCB),B'00000001'                       03S0718
         BNO   @RF00718                                         03S0718
*                                                               04S0719
*           /*********************************************************/
*           /*                                                       */
*           /* PROCESS.ERB.BSSEND: BISYNC/START STOP SEND SEGMENT -  */
*           /* THIS SEGMENT PROCESSES AN INITIAL BISYNC/START STOP   */
*           /* SEND OPERATION.                                       */
*           /*                                                       */
*           /*********************************************************/
*                                                               04S0719
*           DO;                                                 04S0719
*             IF TRMDIAL=ON&TRMSESSN=OFF THEN/* IF DIAL TERMINAL AND
*                                      DIAL OUT NEEDED THEN          */
         TM    TRMDIAL(RTRM),B'00001000'                        04S0720
         BNO   @RF00720                                         04S0720
         TM    TRMSESSN(RTRM),B'01000000'                       04S0720
         BNZ   @RF00720                                         04S0720
*                                                               05S0721
*               /*****************************************************/
*               /*                                                   */
*               /* PROCESS.ERB.BSSEND.BSSENDD: BISYNC/START STOP DIAL*/
*               /* OUT SEGMENT - THIS SEGMENT PROCESSES AN ERB FROM  */
*               /* IEDIAQ REQUESTING A DIAL FOR A DIAL OUT WRITE.    */
*               /*                                                   */
*               /*****************************************************/
*                                                               05S0721
*               DO;                                             05S0721
*                 LCBBFRSV=LCBERBCH;/* MOVE BFR TO SAVE CHAIN        */
         MVC   LCBBFRSV(3,RLCB),LCBERBCH(RLCB)                  05S0722
*                 LCBERBCH=CHAINEND;/* CLEAR ERB CHAIN               */
         SLR   @10,@10                                          05S0723
         STCM  @10,7,LCBERBCH(RLCB)                             05S0723
*                 IF SCBTRMLN=ON THEN/* IF OUTPUT PREVIOUSLY PURGED  */
         L     @10,LCBSCBA-1(,RLCB)                             05S0724
         TM    SCBTRMLN(@10),B'00010000'                        05S0724
         BNO   @RF00724                                         05S0724
*                   CALL IPERRBFR;  /* TPOST ERROR BFR TO OUTPUT MH  */
         BAL   @14,IPERRBFR                                     05S0725
*                 ELSE              /* OUTPUT NOT PREVIOUSLY PURGED  */
*                   DO;                                         05S0726
         B     @RC00724                                         05S0726
@RF00724 DS    0H                                               05S0727
*                     IF LCBCONNN=ON THEN/* DID PREVIOUS ATTEMPT TO
*                                      CONTACT FAIL          @YM08436*/
         TM    LCBCONNN(RLCB),B'00100000'                       05S0727
         BNO   @RF00727                                         05S0727
*                       DO;         /* YES                   @YM08436*/
*                         SCBCONNN=ON;/* SET CONTACT FAILED  @YM08436*/
*                         SCBTRMLN=ON;/* SET TRM ERROR       @YM08436*/
         L     @10,LCBSCBA-1(,RLCB)                             05S0730
         OI    SCBCONNN(@10),B'00110000'                        05S0730
*                       END;        /*                       @YM08436*/
*                     ELSE          /* CONTACT NOT DONE YET  @YM08436*/
*                       CALL IPPURGEX;/* TAKE PURGE EXIT IF ONE 05S0732
*                                      EXISTS                        */
         B     @RC00727                                         05S0732
@RF00727 BAL   @14,IPPURGEX                                     05S0732
*                     IF SCBTRMLN=ON THEN/* IF OUTPUT PURGED THEN    */
@RC00727 L     @10,LCBSCBA-1(,RLCB)                             05S0733
         TM    SCBTRMLN(@10),B'00010000'                        05S0733
         BNO   @RF00733                                         05S0733
*                       DO;                                     05S0734
*                         CALL IPFREBFR;/* FREE EMPTY BFR UNIT       */
         BAL   @14,IPFREBFR                                     05S0735
*                         LCBRBCT1=1;/* REQUEST ONE BFR OF MSG       */
         MVI   LCBRBCT1(RLCB),X'01'                             05S0736
*                         LCBERBQB=ADDR(AVTDSIOB);/* SET IEDQFA QCB
*                                      ADDRESS                       */
         LA    @10,AVTDSIOB(,RAVT)                              05S0737
         STCM  @10,7,LCBERBQB(RLCB)                             05S0737
*                         LCBERBPY=PRIINTRQ;/* SET INITIAL REQUEST
*                                      PRIORITY                      */
         MVI   LCBERBPY(RLCB),X'E4'                             05S0738
*                         LCBDLNKN=OFF;/* INDICATE ERB POSTED   05S0739
*                                                            @YM08436*/
         NI    LCBDLNKN(RLCB),B'11111110'                       05S0739
*                         RPARM=ADDR(LCBERB);/* SET ERB AS ELEMENT   */
         LA    RPARM,LCBERB(,RLCB)                              05S0740
*                         CALL DSPPOSTR;/* TPOST ERB TO IEDQFA TO
*                                      REQ. THE FIRST BFR OF THE MSG */
         LA    @15,DSPPOSTR(,RDISP)                             05S0741
         BALR  @14,@15                                          05S0741
*                       END;                                    05S0742
*                     ELSE          /* OUTPUT NOT PURGED             */
*                       DO;                                     05S0743
         B     @RC00733                                         05S0743
@RF00733 DS    0H                                               05S0744
*                         QCBSDFFO=OFF;/* RESET CURRENTLY SENDING    */
         SLR   @10,@10                                          05S0744
         ICM   @10,7,TRMDESTQ(RTRM)                             05S0744
         NI    QCBSDFFO(@10),B'11111011'                        05S0744
*                         RPRF=LCBBFRSV;/* GET EMPTY BFR UNIT        */
         L     RPRF,LCBBFRSV-1(,RLCB)                           05S0745
         LA    RPRF,0(,RPRF)                                    05S0745
*                         LCBBFRSV=PRFLINK;/* DELINK IT              */
         MVC   LCBBFRSV(3,RLCB),PRFLINK(RPRF)                   05S0746
*                         CALL IPBSCALL;/* ISSUE CONTACT             */
         BAL   @14,IPBSCALL                                     05S0747
*                         CALL IPFRPLCB;/* FREE THE PLCB             */
         BAL   @14,IPFRPLCB                                     05S0748
*                       END;                                    05S0749
*                   END;                                        05S0750
*               END;                                            05S0751
*             ELSE                  /* EITHER IT IS A LEASED TERMINAL
*                                      OR A DIAL TERMINAL THAT HAS
*                                      ALREADY BEEN CALLED           */
*                                                               05S0752
*               /*****************************************************/
*               /*                                                   */
*               /* PROCESS.ERB.BSSEND.BSSENDC: BISYNC/START STOP SEND*/
*               /* COMMON SEGMENT - THIS SEGMENT DOES THE PRE OUTPUT */
*               /* MH PROCESSING FOR AN INITIAL SEND OPERATION FOR   */
*               /* BOTH DIAL AND LEASED DEVICES.                     */
*               /*                                                   */
*               /*****************************************************/
*                                                               05S0752
*               DO;                                             05S0752
         B     @RC00720                                         05S0752
@RF00720 DS    0H                                               05S0753
*                 RFY                                           05S0753
*                  (RUNITNUM,                                   05S0753
*                   RBFRNUM,                                    05S0753
*                   RSTATE,                                     05S0753
*                   RRETCODE) RSTD;                             05S0753
*                 RSTATE=SEND;      /* INIT STATE TO SEND            */
         SLR   RSTATE,RSTATE                                    05S0754
*                 IF LCBBFRSV=CHAINEND THEN/* IF ERB FROM IEDQFA     */
         L     @14,LCBBFRSV-1(,RLCB)                            05S0755
         LA    @14,0(,@14)                                      05S0755
         LTR   @14,@14                                          05S0755
         BNZ   @RF00755                                         05S0755
*                   DO;                                         05S0756
*                     LCBBFRSV=LCBERBCH;/* SAVE BFR CHAIN            */
         MVC   LCBBFRSV(3,RLCB),LCBERBCH(RLCB)                  05S0757
*                     LCBERBCH=CHAINEND;/* CLEAR ERB CHAIN           */
         SLR   @14,@14                                          05S0758
         STCM  @14,7,LCBERBCH(RLCB)                             05S0758
*                     IF(TRMGPACT=ON&TRMSESSN=OFF)×/* GENERAL POLL
*                                      NOT IN SESSION                */
*                         TRMSPOUT=ON THEN/* OR SPECOUT REQUESTED    */
         TM    TRMGPACT(RTRM),B'00001000'                       05S0759
         BNO   @GL00003                                         05S0759
         TM    TRMSESSN(RTRM),B'01000000'                       05S0759
         BZ    @RT00759                                         05S0759
@GL00003 TM    TRMSPOUT(RTRM),B'00000010'                       05S0759
         BNO   @RF00759                                         05S0759
@RT00759 DS    0H                                               05S0760
*                       DO;                                     05S0760
*                         RBFRNUM=1;/* REQUEST ONE BFR               */
         LA    @14,1                                            05S0761
         LR    RBFRNUM,@14                                      05S0761
*                         RUNITNUM=1;/* REQUEST ONE UNIT PER BFR     */
         LR    RUNITNUM,@14                                     05S0762
*                         CALL IEDQGA02;/* ATTEMPT TO STEAL BFR      */
         L     @15,AVTSTEAL(,RAVT)                              05S0763
         BALR  @14,@15                                          05S0763
*                         IF RRETCODE^=0 THEN/* IF BFR OBTAINED      */
         LTR   RRETCODE,RRETCODE                                05S0764
         BZ    @RF00764                                         05S0764
*                           LCBERBCH=RRETCODE;/* PUT BFR ON ERB      */
         STCM  RRETCODE,7,LCBERBCH(RLCB)                        05S0765
*                         ELSE      /* BFR NOT OBTAINED              */
*                           DO;                                 05S0766
         B     @RC00764                                         05S0766
@RF00764 DS    0H                                               05S0767
*                             CALL IPREQBFR;/* REQ. BFR FROM IEDQGA  */
         BAL   @14,IPREQBFR                                     05S0767
*                             RSTATE=NOSEND;/* STOP SEND             */
         LA    RSTATE,1                                         05S0768
*                           END;                                05S0769
*                       END;                                    05S0770
*                   END;                                        05S0771
*                 ELSE              /* ERB IS RETURNING FROM IEDQGA  */
*                   LCBPRCPG=OFF;   /* RESET RETURN ERB INDICATOR    */
         B     @RC00755                                         05S0772
@RF00755 NI    LCBPRCPG(RLCB),B'11111101'                       05S0772
*                                                               05S0773
*                 /***************************************************/
*                 /*                                                 */
*                 /* THIS IS A CONTINUATION OF BSSENDC. RSTATE=SEND  */
*                 /* UNLESS THE ERB HAD TO BE TPOSTED TO IEDQGA TO   */
*                 /* REQUEST A BUFFER.                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                               05S0773
*                 IF RSTATE=SEND THEN/* CONTINUE SEND                */
@RC00755 LTR   RSTATE,RSTATE                                    05S0773
         BNZ   @RF00773                                         05S0773
*                   DO;             /* YES                           */
*                     CALL IPPURGEX;/* TAKE PURGE EXIT IF ONE        */
         BAL   @14,IPPURGEX                                     05S0775
*                     IF SCBTRMLN=OFF THEN/* OUTPUT NOT PURGED       */
         L     @14,LCBSCBA-1(,RLCB)                             05S0776
         TM    SCBTRMLN(@14),B'00010000'                        05S0776
         BNZ   @RF00776                                         05S0776
*                       DO;                                     05S0777
*                         IF(TRMGPACT=ON&TRMSESSN=OFF)×/* IF GENERAL
*                                      POLL NOT IN            SESSION*/
*                             TRMSPOUT=ON THEN/* OR SPECOUT REQUESTED
*                                      THEN                          */
         TM    TRMGPACT(RTRM),B'00001000'                       05S0778
         BNO   @GL00005                                         05S0778
         TM    TRMSESSN(RTRM),B'01000000'                       05S0778
         BZ    @RT00778                                         05S0778
@GL00005 TM    TRMSPOUT(RTRM),B'00000010'                       05S0778
         BNO   @RF00778                                         05S0778
@RT00778 DS    0H                                               05S0779
*                           DO;                                 05S0779
*                             RPRF=LCBERBCH;/* GET EMPTY BFR UNIT    */
         L     RPRF,LCBERBCH-1(,RLCB)                           05S0780
         LA    RPRF,0(,RPRF)                                    05S0780
*                             LCBERBCH=PRFLINK;/* DELINK IT          */
         MVC   LCBERBCH(3,RLCB),PRFLINK(RPRF)                   05S0781
*                             CALL IPBSSPEC;/* PROCESS SPECOUT       */
         BAL   @14,IPBSSPEC                                     05S0782
*                           END;                                05S0783
*                         ELSE      /* SPECOUT NOT REQUESTED         */
*                           CALL IPMHBFR;/* TPOST BFRS TO MH         */
         B     @RC00778                                         05S0784
@RF00778 BAL   @14,IPMHBFR                                      05S0784
*                       END;                                    05S0785
*                     ELSE          /* OUTPUT IS TO BE PURGED        */
*                       DO;                                     05S0786
         B     @RC00776                                         05S0786
@RF00776 DS    0H                                               05S0787
*                         CALL IPERRBFR;/* TPOST ERROR BFR TO MH     */
         BAL   @14,IPERRBFR                                     05S0787
*                         IF LCBBFRSV^=CHAINEND THEN/* IF MORE BFRS  */
         L     @14,LCBBFRSV-1(,RLCB)                            05S0788
         LA    @14,0(,@14)                                      05S0788
         LTR   @14,@14                                          05S0788
         BZ    @RF00788                                         05S0788
*                           CALL IPFREBFR;/* FREE THEM               */
         BAL   @14,IPFREBFR                                     05S0789
*                         IF LCBERBCH^=CHAINEND THEN/* BFR ON ERB    */
@RF00788 L     @14,LCBERBCH-1(,RLCB)                            05S0790
         LA    @14,0(,@14)                                      05S0790
         LTR   @14,@14                                          05S0790
         BZ    @RF00790                                         05S0790
*                           DO;                                 05S0791
*                             LCBBFRSV=LCBERBCH;/* MOVE IT           */
         MVC   LCBBFRSV(3,RLCB),LCBERBCH(RLCB)                  05S0792
*                             LCBERBCH=CHAINEND;/* CLEAR ERB CHAIN   */
         SLR   @14,@14                                          05S0793
         STCM  @14,7,LCBERBCH(RLCB)                             05S0793
*                             CALL IPFREBFR;/* FREE BFR ON SAVE CHAIN*/
         BAL   @14,IPFREBFR                                     05S0794
*                           END;                                05S0795
*                       END;                                    05S0796
@RF00790 DS    0H                                               05S0797
*                   END;                                        05S0797
@RC00776 DS    0H                                               05S0798
*                 RFY                                           05S0798
*                  (RUNITNUM,                                   05S0798
*                   RBFRNUM,                                    05S0798
*                   RSTATE,                                     05S0798
*                   RRETCODE) UNRSTD;                           05S0798
@RF00773 DS    0H                                               05S0799
*               END;                                            05S0799
*           END;                                                04S0800
*         ELSE                                                  03S0801
*           IF LCBCONT=ON THEN      /* IF A CONTINUE OPERATION, THEN
*                                      THIS IS EITHER A READ CONTINUE
*                                      ERB FROM IEDQBO OR IT IS THE
*                                      ERB RETURNING FROM IEDQGA WITH
*                                      AN EMPTY BFR FOR READ CONTINUE
*                                      OR ABORT PROCESSING           */
         B     @RC00718                                         03S0801
@RF00718 TM    LCBCONT(RLCB),B'00001000'                        03S0801
         BNO   @RF00801                                         03S0801
*                                                               04S0802
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.ERB.BSRECVCE: BISYNC/START STOP RECEIVE     */
*             /* CONTINUE ERB SEGMENT - THIS SEGMENT PROCESSES AN ERB*/
*             /* FROM IEDQBO REQUESTING A READ CONTINUE, AND AN ERB  */
*             /* RETURNING FROM IEDQGA WITH AN EMPTY BUFFER WHEN     */
*             /* IEDQGA02 PREVIOUSLY FAILED TO GET A BUFFER FOR      */
*             /* EITHER A READ CONTINUE OR AN ABORT.                 */
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0802
*             DO;                                               04S0802
*               RFY                                             04S0803
*                (RUNITNUM,                                     04S0803
*                 RBFRNUM,                                      04S0803
*                 RRETCODE) RSTD;                               04S0803
*               IF LCBERBCH=CHAINEND THEN/* IF ENTRY FROM IEDQBO THEN*/
         L     @14,LCBERBCH-1(,RLCB)                            04S0804
         LA    @14,0(,@14)                                      04S0804
         LTR   @14,@14                                          04S0804
         BNZ   @RF00804                                         04S0804
*                 DO;                                           04S0805
*                   RBFRNUM=1;      /* REQUEST ONE BFR FOR READ CONT */
         LA    @14,1                                            04S0806
         LR    RBFRNUM,@14                                      04S0806
*                   RUNITNUM=1;     /* REQUEST ONE UNIT PER BFR      */
         LR    RUNITNUM,@14                                     04S0807
*                   CALL IEDQGA02;  /* ATTEMPT TO STEAL BFR          */
         L     @15,AVTSTEAL(,RAVT)                              04S0808
         BALR  @14,@15                                          04S0808
*                   IF RRETCODE^=0 THEN/* IF BFR OBTAINED THEN       */
         LTR   RRETCODE,RRETCODE                                04S0809
         BZ    @RF00809                                         04S0809
*                     DO;                                       04S0810
*                       LCBERBCH=RRETCODE;/* PUT BFR ON ERB CHAIN    */
         STCM  RRETCODE,7,LCBERBCH(RLCB)                        04S0811
*                       CALL IPBSSTCN;/* GO BUILD READ CONTINUE      */
         BAL   @14,IPBSSTCN                                     04S0812
*                     END;                                      04S0813
*                   ELSE            /* BFR WAS NOT OBTAINED          */
*                     CALL IPREQBFR;/* REQUEST A BFR FROM IEDQGA     */
         B     @RC00809                                         04S0814
@RF00809 BAL   @14,IPREQBFR                                     04S0814
*                 END;                                          04S0815
*               ELSE                /* ENTRY IS FROM IEDQGA          */
*                 DO;                                           04S0816
         B     @RC00804                                         04S0816
@RF00804 DS    0H                                               04S0817
*                   LCBPRCPG=OFF;   /* RESET RETURN ERB INDICATOR    */
         NI    LCBPRCPG(RLCB),B'11111101'                       04S0817
*                   CALL IPBSSTCN;  /* GO BUILD EITHER READ CONTINUE
*                                      OR ABORT                      */
         BAL   @14,IPBSSTCN                                     04S0818
*                 END;                                          04S0819
*               RFY                                             04S0820
*                (RUNITNUM,                                     04S0820
*                 RBFRNUM,                                      04S0820
*                 RRETCODE) UNRSTD;                             04S0820
@RC00804 DS    0H                                               04S0821
*             END;                                              04S0821
*           ELSE                    /* IT IS RECEIVE INITIAL ERB FROM
*                                      IEDIAM                        */
*                                                               04S0822
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS.ERB.BSRECV: BISYNC/START STOP RECEIVE       */
*             /* INITIAL SEGMENT - THIS SEGMENT PROCESSES AN INITIAL */
*             /* BISYNC/START STOP RECEIVE OPERATION.                */
*             /*                                                     */
*             /*******************************************************/
*                                                               04S0822
*             DO;                                               04S0822
         B     @RC00801                                         04S0822
@RF00801 DS    0H                                               04S0823
*               RPRF=LCBERBCH;      /* GET BFR UNIT FROM ERB CHAIN   */
         L     RPRF,LCBERBCH-1(,RLCB)                           04S0823
         LA    RPRF,0(,RPRF)                                    04S0823
*               LCBERBCH=PRFLINK;   /* DELINK IT FROM THE CHAIN      */
         MVC   LCBERBCH(3,RLCB),PRFLINK(RPRF)                   04S0824
*               IF TRMDIAL=ON THEN  /* IF DIAL TERMINAL THEN         */
         TM    TRMDIAL(RTRM),B'00001000'                        04S0825
         BNO   @RF00825                                         04S0825
*                                                               05S0826
*                 /***************************************************/
*                 /*                                                 */
*                 /* PROCESS.ERB.BSRECV.BSRECVD: BISYNC/START STOP   */
*                 /* RECEIVE FROM DIAL SEGMENT - THIS SEGMENT        */
*                 /* PROCESSES AN ERB FROM IEDIAM REQUESTING AN      */
*                 /* INITIAL RECEIVE OPERATION FOR A DIAL TERMINAL.  */
*                 /*                                                 */
*                 /***************************************************/
*                                                               05S0826
*                 DO;                                           05S0826
*                   IF TRMSESSN=OFF THEN/* IF NOT IN SESSION YET THEN*/
         TM    TRMSESSN(RTRM),B'01000000'                       05S0827
         BNZ   @RF00827                                         05S0827
*                     DO;                                       05S0828
*                       IF TRMTYPE=TRMCTERM THEN/* IF CTERM THEN     */
         CLI   TRMTYPE(RTRM),X'48'                              05S0829
         BNE   @RF00829                                         05S0829
*                         CALL IPBSRDIN;/* ISSUE INVITE              */
         BAL   @14,IPBSRDIN                                     05S0830
*                       ELSE        /* IT IS NOT THE CTERM           */
*                         CALL IPBSCALL;/* ISSUE CONTACT TO CALL OUT */
         B     @RC00829                                         05S0831
@RF00829 BAL   @14,IPBSCALL                                     05S0831
*                       CALL IPFRPLCB;/* FREE THE PLCB               */
@RC00829 BAL   @14,IPFRPLCB                                     05S0832
*                     END;                                      05S0833
*                   ELSE            /* THE TRM IS ALREADY IN SESSION */
*                     DO;                                       05S0834
         B     @RC00827                                         05S0834
@RF00827 DS    0H                                               05S0835
*                       IF LCBRESP=ON THEN/* IF RESPONSE OWED THEN   */
         TM    LCBRESP(RLCB),B'00000001'                        05S0835
         BNO   @RF00835                                         05S0835
*                         CALL IPBSRESP;/* RETURN A NULL RESPONSE    */
         BAL   @14,IPBSRESP                                     05S0836
*                       ELSE        /* IF TRM HAS HUNG UP, TIMED OUT,
*                                      REACHED NEGATIVE POLL LIMIT,
*                                      OR ITS LINE IS BEING STOPPED,
*                                      OR NCP CLOSEDOWN OR TCAM 05S0837
*                                      CLOSEDOWN IS IN PROGRESS      */
*                         DO;                                   05S0837
         B     @RC00835                                         05S0837
@RF00835 DS    0H                                               05S0838
*                           IF LCBNEGRP=ON THEN/* IF DISCONNECT REQ'D
*                                                            @YM08120*/
         TM    LCBNEGRP(RLCB),B'00001000'                       05S0838
         BNO   @RF00838                                         05S0838
*                             CALL IPBSDISC;/* ISSUE DISCONNECT      */
         BAL   @14,IPBSDISC                                     05S0839
*                           ELSE                                05S0840
*                             DO;                               05S0840
         B     @RC00838                                         05S0840
@RF00838 DS    0H                                               05S0841
*                               IF TRMPREP=ON THEN/* IF MONITOR REQ. */
         TM    TRMPREP(RTRM),B'00000100'                        05S0841
         BNO   @RF00841                                         05S0841
*                                 CALL IPBSMNTR;/* ISSUE MONITOR     */
         BAL   @14,IPBSMNTR                                     05S0842
*                               ELSE                            05S0843
*                                 CALL IPBSRDIN;/* ISSUE READ INITIAL*/
         B     @RC00841                                         05S0843
@RF00841 BAL   @14,IPBSRDIN                                     05S0843
*                               CALL IPFRPLCB;/* FREE PLCB IF   05S0844
*                                      POSSIBLE                      */
@RC00841 BAL   @14,IPFRPLCB                                     05S0844
*                             END;                              05S0845
*                         END;                                  05S0846
*                     END;                                      05S0847
*                 END;                                          05S0848
*               ELSE                /* IT IS A LEASED TERMINAL       */
*                 IF TRMTYPE=TRMCLUST THEN/* IF CLUSTER THEN         */
         B     @RC00825                                         04S0849
@RF00825 CLI   TRMTYPE(RTRM),X'40'                              04S0849
         BNE   @RF00849                                         04S0849
*                                                               05S0850
*                   /*************************************************/
*                   /*                                               */
*                   /* PROCESS.ERB.BSRECV.BSRECVCL: BISYNC/START STOP*/
*                   /* RECEIVE FROM CLUSTER SEGMENT - THIS SEGMENT   */
*                   /* PROCESSES AN ERB FROM IEDIAM FOR A 3270       */
*                   /* CLUSTER. IT BUILDS AN INVITE PERPETUAL TNT    */
*                   /* INDEX PIU AND TPOSTS IT TO IEDSAO IN ORDER TO */
*                   /* START GENERAL POLL FOR A 3270 CLUSTER.        */
*                   /*                                               */
*                   /*************************************************/
*                                                               05S0850
*                   DO;                                         05S0850
*                     RPARM=LCBTTCIN;/* PASS TNT INDEX DAF AS PARM   */
         LH    RPARM,LCBTTCIN(,RLCB)                            05S0851
         N     RPARM,@CF02504                                   05S0851
*                     CALL IPBSTHRH;/* INITIALIZE FID0 TH/RH         */
         BAL   @14,IPBSTHRH                                     05S0852
*                     IEDBDU=''B;   /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               05S0853
         AL    @10,@CF00095                                     05S0853
         XC    IEDBDU(6,@10),IEDBDU(@10)                        05S0853
*                     BDUCMND=CD0INV;/* SET INVITE COMMAND           */
         MVI   BDUCMND(@10),X'05'                               05S0854
*                     BDUMODIF=CD0IP;/* SET PERPETUAL MODIFIER       */
         MVI   BDUMODIF(@10),X'06'                              05S0855
*                     BDUXERLK=ON;  /* RESET ERROR LOCK              */
         OI    BDUXERLK(@10),B'10000000'                        05S0856
*                     TRMERLCK=OFF; /* RESET TCAM ERROR LOCK BIT     */
         NI    TRMERLCK(RTRM),B'11111011'                       05S0857
*                     TRMINOUT=ON;  /* INDICATE INVITE OUTSTANDING   */
         OI    TRMINOUT(RTRM),B'00000001'                       05S0858
*                     PRFPRI=PRIOUTBD;/* SET NORMAL OUTBOUND PRIORITY*/
         MVI   PRFPRI(RPRF),X'E4'                               05S0859
*                     CALL IPBSSAO; /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      05S0860
*                     CALL IPFRPLCB;/* FREE THE PLCB                 */
         BAL   @14,IPFRPLCB                                     05S0861
*                   END;                                        05S0862
*                 ELSE                                          04S0863
*                   IF TRMGPACT=ON THEN/* IF GENERAL POLL ACTIVE THEN*/
         B     @RC00849                                         04S0863
@RF00849 TM    TRMGPACT(RTRM),B'00001000'                       04S0863
         BNO   @RF00863                                         04S0863
*                                                               05S0864
*                     /***********************************************/
*                     /*                                             */
*                     /* PROCESS.ERB.BSRECV.BSRECVGP: BISYNC/START   */
*                     /* STOP RECEIVE FOR GENERAL POLLED TERMINAL    */
*                     /* SEGMENT - THIS SEGMENT GETS CONTROL WHEN AN */
*                     /* ERB IS BYPASSED FROM IEDIAM WHEN EITHER     */
*                     /* MSGLIMIT IS REACHED ON INPUT FROM A GENERAL */
*                     /* POLLED TERMINAL OR A GENERAL POLLED TERMINAL*/
*                     /* OR ITS LINE IS BEING STOPPED AND THE        */
*                     /* TERMINAL IS STILL IN NCP SESSION.           */
*                     /*                                             */
*                     /***********************************************/
*                                                               05S0864
*                     DO;                                       05S0864
*                       IF LCBNEGRP=ON×/* IF DISC REQ'D OR   @YM08120*/
*                           SCBMLMTN=ON THEN/* MSGLIMIT REACHED THEN
*                                                            @YM08120*/
         TM    LCBNEGRP(RLCB),B'00001000'                       05S0865
         BO    @RT00865                                         05S0865
         L     @10,LCBSCBA-1(,RLCB)                             05S0865
         TM    SCBMLMTN(@10),B'00000001'                        05S0865
         BNO   @RF00865                                         05S0865
@RT00865 DS    0H                                               05S0866
*                         CALL IPBSDISC;/* ISSUE DISCONNECT          */
         BAL   @14,IPBSDISC                                     05S0866
*                     END;                                      05S0867
*                   ELSE            /* IT IS NOT GENERAL POLLED      */
*                                                               05S0868
*                     /***********************************************/
*                     /*                                             */
*                     /* PROCESS.ERB.BSRECV.BSRECVL: BISYNC/START    */
*                     /* STOP RECEIVE LEASED SEGMENT - THIS SEGMENT  */
*                     /* PROCESSES AN INITIAL RECEIVE ERB FROM IEDIAM*/
*                     /* FOR BISYNC/START STOP LEASED DEVICES THAT   */
*                     /* ARE NEITHER CLUSTERS NOR CURRENTLY BEING    */
*                     /* GENERAL POLLED.                             */
*                     /*                                             */
*                     /***********************************************/
*                                                               05S0868
*                     DO;                                       05S0868
         B     @RC00863                                         05S0868
@RF00863 DS    0H                                               05S0869
*                       IF TRMSESSN=ON THEN/* IF TRM IN NCP SESSION  */
         TM    TRMSESSN(RTRM),B'01000000'                       05S0869
         BNO   @RF00869                                         05S0869
*                         DO;                                   05S0870
*                           IF LCBRESP=ON THEN/* IF RESPONSE OWED    */
         TM    LCBRESP(RLCB),B'00000001'                        05S0871
         BNO   @RF00871                                         05S0871
*                             CALL IPBSRESP;/* RETURN A RESPONSE     */
         BAL   @14,IPBSRESP                                     05S0872
*                           ELSE    /* A RESPONSE IS NOT OWED        */
*                             DO;                               05S0873
         B     @RC00871                                         05S0873
@RF00871 DS    0H                                               05S0874
*                               IF LCBNEGRP=ON×/* IF DISC REQ'D OR
*                                                            @YM08120*/
*                                   SCBMLMTN=ON THEN/* MSGLIMIT 05S0874
*                                      REACHED THEN          @YM08120*/
         TM    LCBNEGRP(RLCB),B'00001000'                       05S0874
         BO    @RT00874                                         05S0874
         L     @10,LCBSCBA-1(,RLCB)                             05S0874
         TM    SCBMLMTN(@10),B'00000001'                        05S0874
         BNO   @RF00874                                         05S0874
@RT00874 DS    0H                                               05S0875
*                                 CALL IPBSDISC;/* ISSUE DISCONNECT  */
         BAL   @14,IPBSDISC                                     05S0875
*                               ELSE/* NO NEED FOR DISCONNECT        */
*                                 DO;/*                      @YM02939*/
         B     @RC00874                                         05S0876
@RF00874 DS    0H                                               05S0877
*                                   IF TRMPREP=ON THEN/* IF MONITOR  */
         TM    TRMPREP(RTRM),B'00000100'                        05S0877
         BNO   @RF00877                                         05S0877
*                                    CALL IPBSMNTR;/* ISSUE MONITOR  */
         BAL   @14,IPBSMNTR                                     05S0878
*                                   ELSE/* MONITOR NOT REQUESTED     */
*                                    CALL IPBSRDIN;/* ISSUE READ     */
         B     @RC00877                                         05S0879
@RF00877 BAL   @14,IPBSRDIN                                     05S0879
*                                   CALL IPFRPLCB;/* FREE THE PLCB IF
*                                      POSSIBLE                      */
@RC00877 BAL   @14,IPFRPLCB                                     05S0880
*                                 END;/*                     @YM02939*/
*                             END;                              05S0882
*                         END;                                  05S0883
*                       ELSE        /* TRM NOT IN NCP SESSION        */
*                         DO;                                   05S0884
         B     @RC00869                                         05S0884
@RF00869 DS    0H                                               05S0885
*                           IF TRMPREP=ON THEN/* IF MONITOR REQ. THEN*/
         TM    TRMPREP(RTRM),B'00000100'                        05S0885
         BNO   @RF00885                                         05S0885
*                             CALL IPBSMNTR;/* ISSUE MONITOR         */
         BAL   @14,IPBSMNTR                                     05S0886
*                           ELSE    /* MONITOR NOT REQUESTED         */
*                             CALL IPBSRDIN;/* ISSUE INVITE          */
         B     @RC00885                                         05S0887
@RF00885 BAL   @14,IPBSRDIN                                     05S0887
*                           CALL IPFRPLCB;/* FREE PLCB IF POSSIBLE   */
@RC00885 BAL   @14,IPFRPLCB                                     05S0888
*                         END;                                  05S0889
*                     END;                                      05S0890
@RC00869 DS    0H                                               05S0891
*             END;                                              04S0891
@RC00863 DS    0H                                               04S0891
@RC00849 DS    0H                                               04S0891
@RC00825 DS    0H                                               04S0892
*     END;                                                      03S0892
@RC00801 DS    0H                                               03S0892
@RC00718 DS    0H                                               03S0892
@RC00692 DS    0H                                               03S0893
*   CALL DSPDISP;                   /* RETURN TO THE DISPATCHER      */
@RC00570 LA    @15,DSPDISP(,RDISP)                              02S0893
         BALR  @14,@15                                          02S0893
*                                                               02S0894
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSABRT: BISYNC/START STOP ABORT INTERNAL PROCEDURE - THIS   */
*   /* INTERNAL PROCEDURE BUILDS AN ABORT PIU TO ABORT AN INPUT      */
*   /* OPERATION WHEN AN ERROR HAS OCCURRED AND STOP=YES IS          */
*   /* SPECIFIED. RPRF MUST HAVE THE ADDRESS OF THE BUFFER UNIT IN   */
*   /* WHICH THE PIU IS TO BE BUILT.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0894
*IPBSABRT:                                                      02S0894
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0894
@EL00001 DS    0H                                               02S0894
@EF00001 DS    0H                                               02S0894
@ER00001 BR    @14                                              02S0894
IPBSABRT ST    @14,@SA00002                                     02S0894
*   RFY                                                         02S0895
*     IEDTH BASED(ADDR(PIU0TH));                                02S0895
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0896
         N     RPARM,@CF02504                                   02S0896
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S0897
*   TTHTAG2=TTHABORT;               /* SET ABORT ID TAG              */
         LA    @10,PRFPIUO(,RPRF)                               02S0898
         MVI   TTHTAG2+1(@10),X'04'                             02S0898
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         AL    @10,@CF00095                                     02S0899
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0899
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@10),B'10000000'                        02S0900
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
         NI    TRMERLCK(RTRM),B'11111011'                       02S0901
*   IF TRMDIAL=ON THEN              /* IF DIAL TERMINAL THEN         */
         TM    TRMDIAL(RTRM),B'00001000'                        02S0902
         BNO   @RF00902                                         02S0902
*     DO;                                                       02S0903
*       BDUCMND=CD0WRT;             /* SET WRITE COMMAND             */
         MVI   BDUCMND(@10),X'02'                               02S0904
*       BDUMODIF=CD0WT;             /* SET TRANSMISSION MODIFIER     */
         MVI   BDUMODIF(@10),X'02'                              02S0905
*     END;                                                      02S0906
*   ELSE                            /* IT IS LEASED TERMINAL         */
*     DO;                                                       02S0907
         B     @RC00902                                         02S0907
@RF00902 DS    0H                                               02S0908
*       BDUCMND=CD0DISC;            /* SET DISCONNECT COMMAND        */
         LA    @10,PRFPIUO(,RPRF)                               02S0908
         AL    @10,@CF00095                                     02S0908
         MVI   BDUCMND(@10),X'07'                               02S0908
*       BDUMODIF=CD0D;              /* SET NORMAL MODIFIER           */
         MVI   BDUMODIF(@10),X'00'                              02S0909
*       TRMSESSN=OFF;               /* RESET NCP SESSION     @YM08436*/
         NI    TRMSESSN(RTRM),B'10111111'                       02S0910
*     END;                                                      02S0911
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
@RC00902 MVI   PRFPRI(RPRF),X'E4'                               02S0912
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S0913
*   RFY                                                         02S0914
*     IEDTH BASED;                                              02S0914
*   END IPBSABRT;                                               02S0915
@EL00002 DS    0H                                               02S0915
@EF00002 DS    0H                                               02S0915
@ER00002 L     @14,@SA00002                                     02S0915
         BR    @14                                              02S0915
*                                                               02S0916
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSCALL: BISYNC/START STOP CALL OUT INTERNAL PROCEDURE - THIS*/
*   /* INTERNAL PROCEDURE BUILDS A FID0 CONTACT PIU FOR CALLING OUT  */
*   /* TO DIAL TERMINALS. RPRF MUST HAVE THE ADDRESS OF THE BUFFER   */
*   /* UNIT IN WHICH THE PIU IS TO BE BUILT.                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0916
*IPBSCALL:                                                      02S0916
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0916
IPBSCALL ST    @14,@SA00003                                     02S0916
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0917
         N     RPARM,@CF02504                                   02S0917
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S0918
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S0919
         AL    @10,@CF00095                                     02S0919
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0919
*   BDUCMND=CD0CONT;                /* SET CONTACT COMMAND           */
         MVI   BDUCMND(@10),X'06'                               02S0920
*   BDUMODIF=CD0CRSID;              /* SET RETURN RSID OF LINE MODIF.*/
         MVI   BDUMODIF(@10),X'01'                              02S0921
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@10),B'10000000'                        02S0922
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
*   TRMCONT=ON;                     /* INDICATE CALL OUT             */
         OI    TRMCONT(RTRM),B'10000000'                        02S0924
         NI    TRMERLCK(RTRM),B'11111011'                       02S0924
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
         MVI   PRFPRI(RPRF),X'E4'                               02S0925
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S0926
*   END IPBSCALL;                                               02S0927
@EL00003 DS    0H                                               02S0927
@EF00003 DS    0H                                               02S0927
@ER00003 L     @14,@SA00003                                     02S0927
         BR    @14                                              02S0927
*                                                               02S0928
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSDISC: BISYNC/START STOP DISCONNECT INTERNAL PROCEDURE -   */
*   /* THIS INTERNAL PROCEDURE BUILDS A DISCONNECT WITH END OF CALL  */
*   /* PIU. RPRF MUST HAVE THE ADDRESS OF THE BUFFER UNIT IN WHICH   */
*   /* THE PIU IS TO BE BUILT.                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0928
*IPBSDISC:                                                      02S0928
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0928
IPBSDISC ST    @14,@SA00004                                     02S0928
*   RPARM=LCBTTCIN;                 /* PASS DAF AS PARM              */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0929
         N     RPARM,@CF02504                                   02S0929
*   CALL IPBSTHRH;                  /* INITIALIZE FID0 TH/RH         */
         BAL   @14,IPBSTHRH                                     02S0930
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S0931
         AL    @10,@CF00095                                     02S0931
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0931
*   BDUCMND=CD0DISC;                /* SET DISCONNECT COMMAND        */
         MVI   BDUCMND(@10),X'07'                               02S0932
*   BDUMODIF=CD0DE;                 /* SET END OF CALL MODIFIER      */
         MVI   BDUMODIF(@10),X'02'                              02S0933
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@10),B'10000000'                        02S0934
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
*   TRMSESSN=OFF;                   /* RESET NCP SESSION     @YM08436*/
         NI    TRMERLCK(RTRM),B'10111011'                       02S0936
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
         MVI   PRFPRI(RPRF),X'E4'                               02S0937
*   CALL IPBSSAO;                   /* POST FID0 PIU TO IEDSAO       */
         BAL   @14,IPBSSAO                                      02S0938
*   END IPBSDISC;                                               02S0939
@EL00004 DS    0H                                               02S0939
@EF00004 DS    0H                                               02S0939
@ER00004 L     @14,@SA00004                                     02S0939
         BR    @14                                              02S0939
*                                                               02S0940
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSMNTR: BISYNC/START STOP MONITOR INTERNAL PROCEDURE - THIS */
*   /* INTERNAL PROCEDURE BUILDS A FID0 SET DESTINATION MODE PIU     */
*   /* WHICH STARTS THE MONITOR TASK IN THE NCP. RPRF MUST HAVE THE  */
*   /* ADDRESS OF THE BUFFER UNIT IS WHICH THE PIU IS TO BE BUILT.   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0940
*IPBSMNTR:                                                      02S0940
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0940
IPBSMNTR ST    @14,@SA00005                                     02S0940
*   RFY                                                         02S0941
*     IEDTH BASED(ADDR(PIU0TH));                                02S0941
*   RFY                                                         02S0942
*    (RMASK,                                                    02S0942
*     RMOD) RSTD;                                               02S0942
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0943
         N     RPARM,@CF02504                                   02S0943
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S0944
*   TTHDCF=TTHDCF+LENGTH(MODNEW);   /* UPDATE DATA COUNT             */
         LA    @14,PRFPIUO(,RPRF)                               02S0945
         AL    @14,@CF00059                                     02S0945
         LA    @10,2                                            02S0945
         SLR   @09,@09                                          02S0945
         ICM   @09,3,TTHDCF(@14)                                02S0945
         ALR   @10,@09                                          02S0945
         STCM  @10,3,TTHDCF(@14)                                02S0945
*   RMASK=TRMRNTMK;                 /* SET MASK FOR TRMRNTRM BIT     */
         LA    RMASK,16                                         02S0946
*   RPARM=RTRM+LENGTH(IEDNTRM);     /* PASS TRM ADDRESS              */
         LA    RPARM,14                                         02S0947
         ALR   RPARM,RTRM                                       02S0947
*   CALL IEDQTL;                    /* LOCATE DEV. DEP. FIELD        */
         L     @15,AVTDDFT(,RAVT)                               02S0948
         BALR  @14,@15                                          02S0948
*   MODNMNTR=ON;                    /* SET ACTIVATE MONITOR BIT      */
*   MODNMNTP=OFF;                   /* INDICATE THAT THE MONITOR TASK
*                                      SHOULD BE AUTOMATICALLY  02S0950
*                                      DEACTIVATED ON THE NEXT I/O   */
         OI    MODNMNTR(RMOD),B'00000010'                       02S0950
         NI    MODNMNTP(RMOD),B'11111110'                       02S0950
*   MODCUR=MODNEW;                  /* SET CURRENT MODE TO NEW MODE  */
         MVC   MODCUR(2,RMOD),MODNEW(RMOD)                      02S0951
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @14,PRFPIUO(,RPRF)                               02S0952
         LA    @10,15                                           02S0952
         ALR   @10,@14                                          02S0952
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0952
*   BDUCMND=CD0CTRL;                /* SET CONTROL COMMAND           */
         MVI   BDUCMND(@10),X'08'                               02S0953
*   BDUMODIF=CD0CSDM;               /* SET SET DEST. MODE MODIFIER   */
         MVI   BDUMODIF(@10),X'9A'                              02S0954
*   TEXT(1:2)=MODNEW;               /* SET MODE AS PIU TEXT          */
         MVC   TEXT+21(2,@14),MODNEW(RMOD)                      02S0955
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
         MVI   PRFPRI(RPRF),X'E4'                               02S0956
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S0957
*   TRMINPTP=ON;                    /* INDICATE INPUT PENDING        */
         OI    TRMINPTP(RTRM),B'01000000'                       02S0958
*   RFY                                                         02S0959
*    (RMASK,                                                    02S0959
*     RMOD) UNRSTD;                                             02S0959
*   RFY                                                         02S0960
*     IEDTH BASED;                                              02S0960
*   END IPBSMNTR;                                               02S0961
@EL00005 DS    0H                                               02S0961
@EF00005 DS    0H                                               02S0961
@ER00005 L     @14,@SA00005                                     02S0961
         BR    @14                                              02S0961
*                                                               02S0962
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSRDCN: BISYNC/START STOP READ CONTINUE INTERNAL PROCEDURE -*/
*   /* THIS INTERNAL PROCEDURE BUILDS A READ CONTINUE FID0 PIU. RPRF */
*   /* MUST HAVE THE ADDRESS OF THE BUFFER UNIT IN WHICH THE PIU IS  */
*   /* TO BE BUILT.                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0962
*IPBSRDCN:                                                      02S0962
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0962
IPBSRDCN ST    @14,@SA00006                                     02S0962
*   LCBRESP=OFF;                    /* RESET RESPONSE OWED           */
         NI    LCBRESP(RLCB),B'11111110'                        02S0963
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0964
         N     RPARM,@CF02504                                   02S0964
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S0965
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S0966
         AL    @10,@CF00095                                     02S0966
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0966
*   BDUCMND=CD0READ;                /* SET READ COMMAND              */
         MVI   BDUCMND(@10),X'01'                               02S0967
*   BDUPOSAK=ON;                    /* INDICATE POSITIVE ACK         */
         OI    BDUPOSAK(@10),B'00000100'                        02S0968
*   IF LCBEOT=ON THEN               /* IF RVI REQUESTED THEN         */
         TM    LCBEOT(RLCB),B'00000010'                         02S0969
         BNO   @RF00969                                         02S0969
*     DO;                                                       02S0970
*       LCBEOT=OFF;                 /* RESET RVI REQUEST             */
         NI    LCBEOT(RLCB),B'11111101'                         02S0971
*       BDUNEGAK=ON;                /* SET NEGATIVE ACK ALSO, THE
*                                      COMBINATION OF POS. ACK AND
*                                      NEG. ACK INDICATES RVI        */
         OI    BDUNEGAK(@10),B'00000010'                        02S0972
*     END;                                                      02S0973
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
@RF00969 LA    @10,PRFPIUO(,RPRF)                               02S0974
         OI    BDUXERLK+15(@10),B'10000000'                     02S0974
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
         NI    TRMERLCK(RTRM),B'11111011'                       02S0975
*   CALL IPBSRMOD;                  /* SET APPROPRIATE MODIFIER      */
         BAL   @14,IPBSRMOD                                     02S0976
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
         MVI   PRFPRI(RPRF),X'E4'                               02S0977
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S0978
*   END IPBSRDCN;                                               02S0979
@EL00006 DS    0H                                               02S0979
@EF00006 DS    0H                                               02S0979
@ER00006 L     @14,@SA00006                                     02S0979
         BR    @14                                              02S0979
*                                                               02S0980
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSRDIN: BISYNC/START STOP READ/INVITE INTERNAL PROCEDURE -  */
*   /* THIS INTERNAL PROCEDURE BUILDS THE APPROPRIATE READ OR INVITE */
*   /* PIU FOR AN INITIAL BISYNC/START STOP SPECIFIC POLL OPERATION. */
*   /* RPRF MUST HAVE THE ADDRESS OF THE BUFFER UNIT IN WHICH THE PIU*/
*   /* IS TO BE BUILT.                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0980
*IPBSRDIN:                                                      02S0980
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0980
IPBSRDIN ST    @14,@SA00007                                     02S0980
*   RPARM=LCBTTCIN;                 /* PASS DAF AS PARAMETER         */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S0981
         N     RPARM,@CF02504                                   02S0981
*   CALL IPBSTHRH;                  /* INITIALIZE FID0 TH/RH         */
         BAL   @14,IPBSTHRH                                     02S0982
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S0983
         AL    @10,@CF00095                                     02S0983
         XC    IEDBDU(6,@10),IEDBDU(@10)                        02S0983
*   BDUHEADR=ON;                    /* INDICATE HEADER BDU           */
         OI    BDUHEADR(@10),B'01000000'                        02S0984
*   IF QCBTSSES=OFF THEN            /* IF NOT IN TSO SESSION THEN    */
         SLR   @09,@09                                          02S0985
         ICM   @09,7,TRMDESTQ(RTRM)                             02S0985
         TM    QCBTSSES(@09),B'10000000'                        02S0985
         BNZ   @RF00985                                         02S0985
*     DO;                                                       02S0986
*       BDUXERLK=ON;                /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@10),B'10000000'                        02S0987
*       TRMERLCK=OFF;               /* RESET TCAM ERROR LOCK         */
         NI    TRMERLCK(RTRM),B'11111011'                       02S0988
*     END;                                                      02S0989
*   IF TRMSESSN=ON THEN             /* IS TERMINAL IN SESSION        */
@RF00985 TM    TRMSESSN(RTRM),B'01000000'                       02S0990
         BNO   @RF00990                                         02S0990
*     DO;                           /* YES                           */
*       BDUCMND=CD0READ;            /* SET READ COMMAND              */
         LA    @10,PRFPIUO(,RPRF)                               02S0992
         MVI   BDUCMND+15(@10),X'01'                            02S0992
*       TRMRDOUT=ON;                /* SET READ OUTSTANDING          */
         OI    TRMRDOUT(RTRM),B'00000010'                       02S0993
*     END;                                                      02S0994
*   ELSE                            /* NO, TERMINAL IS NOT IN SESSION*/
*     DO;                                                       02S0995
         B     @RC00990                                         02S0995
@RF00990 DS    0H                                               02S0996
*       BDUCMND=CD0INV;             /* SET INVITE COMMAND            */
         LA    @10,PRFPIUO(,RPRF)                               02S0996
         MVI   BDUCMND+15(@10),X'05'                            02S0996
*       TRMINOUT=ON;                /* SET INVITE OUTSTANDING        */
         OI    TRMINOUT(RTRM),B'00000001'                       02S0997
*     END;                                                      02S0998
*   CALL IPBSRMOD;                  /* SET BDU MODIFIER              */
@RC00990 BAL   @14,IPBSRMOD                                     02S0999
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
         MVI   PRFPRI(RPRF),X'E4'                               02S1000
*   CALL IPBSSAO;                   /* POST FID0 PIU TO IEDSAO       */
         BAL   @14,IPBSSAO                                      02S1001
*   END IPBSRDIN;                                               02S1002
@EL00007 DS    0H                                               02S1002
@EF00007 DS    0H                                               02S1002
@ER00007 L     @14,@SA00007                                     02S1002
         BR    @14                                              02S1002
*                                                               02S1003
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSRESP: BISYNC/START STOP NULL RESPONSE INTERNAL PROCEDURE -*/
*   /* THIS PROCEDURE BUILDS AND RETURNS A NULL RESPONSE WHEN ONE IS */
*   /* STILL OWED BY THE TIME ANOTHER READ IS SCHEDULED. RPRF MUST   */
*   /* HAVE THE ADDRESS OF THE BUFFER UNIT IN WHICH THE NULL RESPONSE*/
*   /* PIU IS TO BE BUILT.                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1003
*IPBSRESP:                                                      02S1003
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1003
IPBSRESP ST    @14,@SA00008                                     02S1003
*   RFY                                                         02S1004
*     IEDTH BASED(ADDR(PIU0TH));                                02S1004
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S1005
         N     RPARM,@CF02504                                   02S1005
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S1006
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S1007
         LA    @09,15                                           02S1007
         ALR   @09,@10                                          02S1007
         XC    IEDBDU(6,@09),IEDBDU(@09)                        02S1007
*   BDUCMND=CD0WRT;                 /* SET WRITE COMMAND             */
         MVI   BDUCMND(@09),X'02'                               02S1008
*   BDUMODIF=CD0WT;                 /* SET TRANSMISSION MODIFIER     */
         MVI   BDUMODIF(@09),X'02'                              02S1009
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@09),B'10000000'                        02S1010
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
         NI    TRMERLCK(RTRM),B'11111011'                       02S1011
*   TRMNLOUT=ON;                    /* SET NULL WRITE OUTSTANDING    */
         OI    TRMNLOUT(RTRM),B'00000100'                       02S1012
*   RPARM=AVTCSTCS+(AVTDCTLN*(TRMCHCIN-1));/* GET DCT BASE           */
         SLR   RPARM,RPARM                                      02S1013
         IC    RPARM,TRMCHCIN(,RTRM)                            02S1013
         BCTR  RPARM,0                                          02S1013
         MH    RPARM,AVTDCTLN(,RAVT)                            02S1013
         AL    RPARM,AVTCSTCS(,RAVT)                            02S1013
*   IF DCT3270=ON THEN              /* IF 3270 THEN                  */
         TM    DCT3270(RPARM),B'00000100'                       02S1014
         BNO   @RF01014                                         02S1014
*     DO;                                                       02S1015
*       TEXT(1:2)=NULLTEXT;         /* SEND NULL 3270 COMMAND        */
         MVC   TEXT+21(2,@10),@CB02362                          02S1016
*       TTHDCF=TTHDCF+LENGTH(NULLTEXT)/8;/* UPDATE DATA COUNT        */
         AL    @10,@CF00059                                     02S1017
         LA    @09,2                                            02S1017
         SLR   @07,@07                                          02S1017
         ICM   @07,3,TTHDCF(@10)                                02S1017
         ALR   @09,@07                                          02S1017
         STCM  @09,3,TTHDCF(@10)                                02S1017
*     END;                                                      02S1018
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
@RF01014 MVI   PRFPRI(RPRF),X'E4'                               02S1019
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S1020
*   RFY                                                         02S1021
*     IEDTH BASED;                                              02S1021
*   END IPBSRESP;                                               02S1022
@EL00008 DS    0H                                               02S1022
@EF00008 DS    0H                                               02S1022
@ER00008 L     @14,@SA00008                                     02S1022
         BR    @14                                              02S1022
*                                                               02S1023
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSRMOD: BISYNC/START STOP READ PIU MODIFIER INTERNAL        */
*   /* PROCEDURE - THIS PROCEDURE SETS THE CORRECT MODIFIER FOR READ */
*   /* AND INVITE PIUS. RPRF MUST HAVE THE ADDRESS OF THE BUFFER UNIT*/
*   /* IN WHICH THE PIU IS BEING BUILT.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1023
*IPBSRMOD:                                                      02S1023
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1023
IPBSRMOD ST    @14,12(,@13)                                     02S1023
*   RFY                                                         02S1024
*     RMH RSTD;                     /* RESTRICT RMH                  */
*   RMH=LCBMHA;                     /* SET MH QCB BASE REG   @YM06085*/
         L     RMH,LCBMHA-1(,RLCB)                              02S1025
         LA    RMH,0(,RMH)                                      02S1025
*   IF QCBALTMH=ON THEN             /* IF ALT. MH IS BEING USED THEN */
         SLR   @10,@10                                          02S1026
         ICM   @10,7,TRMDESTQ(RTRM)                             02S1026
         TM    QCBALTMH(@10),B'00001000'                        02S1026
         BNO   @RF01026                                         02S1026
*     RMH=STMHALT;                  /* SET ALTERNATE MH QCB AS BASE  */
         L     RMH,STMHALT(,RMH)                                02S1027
*   IF STMHLOG=ON×                  /* IF LOGICAL CHECKING OR        */
*       STMHLMD=ON THEN             /* LMD IS REQUESTED THEN         */
@RF01026 TM    STMHLOG(RMH),B'00000100'                         02S1028
         BO    @RT01028                                         02S1028
         TM    STMHLMD(RMH),B'00000001'                         02S1028
         BNO   @RF01028                                         02S1028
@RT01028 DS    0H                                               02S1029
*     BDUMODIF=CD0RB;               /* SET BLOCK MODIFIER            */
         LA    @10,PRFPIUO(,RPRF)                               02S1029
         MVI   BDUMODIF+15(@10),X'01'                           02S1029
*   ELSE                            /* NEITHER LOGICAL CHECKING NOR
*                                      LMD IS REQUESTED              */
*     IF STMHCONV=ON THEN           /* IF CONV. MODE IS REQ. THEN    */
         B     @RC01028                                         02S1030
@RF01028 TM    STMHCONV(RMH),B'00010000'                        02S1030
         BNO   @RF01030                                         02S1030
*       DO;                                                     02S1031
*         IF LCBSYNC=OFF THEN       /* IF TRM IS START STOP THEN     */
         TM    LCBSYNC(RLCB),B'00000100'                        02S1032
         BNZ   @RF01032                                         02S1032
*           BDUMODIF=CD0RB;         /* SET BLOCK MODIFIER            */
         LA    @10,PRFPIUO(,RPRF)                               02S1033
         MVI   BDUMODIF+15(@10),X'01'                           02S1033
*         ELSE                      /* THE TRM IS BISYNC SO          */
*           BDUMODIF=CD0RM;         /* SET MESSAGE MODIFIER          */
         B     @RC01032                                         02S1034
@RF01032 LA    @10,PRFPIUO(,RPRF)                               02S1034
         MVI   BDUMODIF+15(@10),X'02'                           02S1034
*       END;                                                    02S1035
*     ELSE                          /* IT IS NOT CONVERSATIONAL MODE */
*       BDUMODIF=CD0RT;             /* SET TRANSMISSION MODIFIER     */
         B     @RC01030                                         02S1036
@RF01030 LA    @10,PRFPIUO(,RPRF)                               02S1036
         MVI   BDUMODIF+15(@10),X'03'                           02S1036
*   RFY                                                         02S1037
*     RMH UNRSTD;                   /* RELEASE RMH                   */
*   END IPBSRMOD;                                               02S1038
@EL00009 DS    0H                                               02S1038
@EF00009 DS    0H                                               02S1038
@ER00009 L     @14,12(,@13)                                     02S1038
         BR    @14                                              02S1038
*                                                               02S1039
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSSAO: BISYNC/START STOP FID0 PIU POST INTERNAL PROCEDURE - */
*   /* THIS INTERNAL PROCEDURE TPOSTS A BUFFER CONTAINING A FID0 TNT */
*   /* INDEX PIU TO IEDSAO. RPRF MUST HAVE THE ADDRESS OF THE BUFFER */
*   /* UNIT CONTAINING THE PIU AND PRFPRI MUST BE SET BY THE CALLER. */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1039
*IPBSSAO:                                                       02S1039
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1039
IPBSSAO  ST    @14,@SA00010                                     02S1039
*   PRFQCBA=SAVTSAO;                /* SET IEDSAO QCB ADDRESS        */
         L     @10,AVTSAVTP(,RAVT)                              02S1040
         MVC   PRFQCBA(3,RPRF),SAVTSAO+1(@10)                   02S1040
*   RPARM=RPRF;                     /* SET BUFFER AS ELEMENT         */
         LR    RPARM,RPRF                                       02S1041
*   CALL DSPPOSTR;                  /* PUT BFR ON READY QUEUE        */
         LA    @15,DSPPOSTR(,RDISP)                             02S1042
         BALR  @14,@15                                          02S1042
*   END IPBSSAO;                                                02S1043
@EL00010 DS    0H                                               02S1043
@EF00010 DS    0H                                               02S1043
@ER00010 L     @14,@SA00010                                     02S1043
         BR    @14                                              02S1043
*                                                               02S1044
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSSPEC: BISYNC/START STOP SPECIAL OUTPUT INTERNAL PROCEDURE */
*   /* - THIS INTERNAL PROCEDURE BUILDS THE APPROPRIATE NULL COMMAND */
*   /* PIU FOR SPECOUT PROCESSING. RPRF MUST HAVE THE ADDRESS OF THE */
*   /* BUFFER UNIT IN WHICH THE PIU IS TO BE BUILT.                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1044
*IPBSSPEC:                                                      02S1044
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1044
IPBSSPEC ST    @14,@SA00011                                     02S1044
*   RFY                                                         02S1045
*     IEDTH BASED(ADDR(PIU0TH));                                02S1045
*   RPARM=LCBTTCIN;                 /* PASS TNT INDEX DAF AS PARM    */
         LH    RPARM,LCBTTCIN(,RLCB)                            02S1046
         N     RPARM,@CF02504                                   02S1046
*   CALL IPBSTHRH;                  /* BUILD FID0 TH/RH              */
         BAL   @14,IPBSTHRH                                     02S1047
*   IEDBDU=''B;                     /* CLEAR BDU                     */
         LA    @10,PRFPIUO(,RPRF)                               02S1048
         LA    @09,15                                           02S1048
         ALR   @09,@10                                          02S1048
         XC    IEDBDU(6,@09),IEDBDU(@09)                        02S1048
*   BDUXERLK=ON;                    /* RESET NCP ERROR LOCK          */
         OI    BDUXERLK(@09),B'10000000'                        02S1049
*   BDUFRSTB=ON;                    /* INDICATE FIRST BLOCK  @OY16373*/
         OI    BDUFRSTB(@09),B'00010000'                        02S1050
*   TRMERLCK=OFF;                   /* RESET TCAM ERROR LOCK         */
         NI    TRMERLCK(RTRM),B'11111011'                       02S1051
*   TRMNLOUT=ON;                    /* INDICATE NULL OUTPUT          */
         OI    TRMNLOUT(RTRM),B'00000100'                       02S1052
*   IF TRMSESSN=ON THEN             /* IF IN NCP SESSION THEN        */
         TM    TRMSESSN(RTRM),B'01000000'                       02S1053
         BNO   @RF01053                                         02S1053
*     DO;                                                       02S1054
*       BDUCMND=CD0WRT;             /* SET WRITE COMMAND             */
         MVI   BDUCMND(@09),X'02'                               02S1055
*       BDUMODIF=CD0W;              /* SET NORMAL (BLOCK) MODIFIER   */
         MVI   BDUMODIF(@09),X'00'                              02S1056
*       RPARM=AVTCSTCS+(AVTDCTLN*(TRMCHCIN-1));/* GET DCT BASE       */
         SLR   RPARM,RPARM                                      02S1057
         IC    RPARM,TRMCHCIN(,RTRM)                            02S1057
         BCTR  RPARM,0                                          02S1057
         MH    RPARM,AVTDCTLN(,RAVT)                            02S1057
         AL    RPARM,AVTCSTCS(,RAVT)                            02S1057
*       IF DCT3270=ON THEN          /* IF 3270 THEN                  */
         TM    DCT3270(RPARM),B'00000100'                       02S1058
         BNO   @RF01058                                         02S1058
*         DO;                                                   02S1059
*           TEXT(1:2)=NULLTEXT;     /* SEND NULL 3270 COMMAND        */
         MVC   TEXT+21(2,@10),@CB02362                          02S1060
*           TTHDCF=TTHDCF+LENGTH(NULLTEXT)/8;/* UPDATE DATA COUNT    */
         AL    @10,@CF00059                                     02S1061
         LA    @09,2                                            02S1061
         SLR   @07,@07                                          02S1061
         ICM   @07,3,TTHDCF(@10)                                02S1061
         ALR   @09,@07                                          02S1061
         STCM  @09,3,TTHDCF(@10)                                02S1061
*         END;                                                  02S1062
*     END;                                                      02S1063
*   ELSE                            /* TRM IS NOT IN NCP SESSION     */
*     DO;                                                       02S1064
         B     @RC01053                                         02S1064
@RF01053 DS    0H                                               02S1065
*       BDUCMND=CD0CONT;            /* SET CONTACT COMMAND           */
         LA    @10,PRFPIUO(,RPRF)                               02S1065
         AL    @10,@CF00095                                     02S1065
         MVI   BDUCMND(@10),X'06'                               02S1065
*       BDUMODIF=CD0C;              /* SET NORMAL MODIFIER           */
         MVI   BDUMODIF(@10),X'00'                              02S1066
*     END;                                                      02S1067
*   PRFPRI=PRIOUTBD;                /* SET NORMAL OUTBOUND PRIORITY  */
@RC01053 MVI   PRFPRI(RPRF),X'E4'                               02S1068
*   CALL IPBSSAO;                   /* TPOST PIU TO IEDSAO           */
         BAL   @14,IPBSSAO                                      02S1069
*   RFY                                                         02S1070
*     IEDTH BASED;                                              02S1070
*   END IPBSSPEC;                                               02S1071
@EL00011 DS    0H                                               02S1071
@EF00011 DS    0H                                               02S1071
@ER00011 L     @14,@SA00011                                     02S1071
         BR    @14                                              02S1071
*                                                               02S1072
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSSTCN: BISYNC/START STOP STOP AND CONTINUE PROCESSING      */
*   /* INTERNAL PROCEDURE - THIS INTERNAL PROCEDURE DISTINGUISHES    */
*   /* BETWEEN STOP AND CONTINUE PROCESSING AND CALLS THE ABORT AND  */
*   /* READ CONTINUE INTERNAL PROCEDURES RESPECTIVELY. LCBERBCH MUST */
*   /* CONTAIN THE ADDRESS OF AN EMPTY BUFFER UNIT IN WHICH TO BUILD */
*   /* EITHER A READ CONTINUE OR AN ABORT PIU.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1072
*IPBSSTCN:                                                      02S1072
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1072
IPBSSTCN ST    @14,@SA00012                                     02S1072
*   RPRF=LCBERBCH;                  /* GET EMPTY BFR UNIT            */
         L     RPRF,LCBERBCH-1(,RLCB)                           02S1073
         LA    RPRF,0(,RPRF)                                    02S1073
*   LCBERBCH=PRFLINK;               /* DELINK IT                     */
         MVC   LCBERBCH(3,RLCB),PRFLINK(RPRF)                   02S1074
*   IF LCBABRTN=ON&LCBEOT=OFF THEN  /* IF STOP=YES THEN              */
         TM    LCBABRTN(RLCB),B'00000001'                       02S1075
         BNO   @RF01075                                         02S1075
         TM    LCBEOT(RLCB),B'00000010'                         02S1075
         BNZ   @RF01075                                         02S1075
*     CALL IPBSABRT;                /* ISSUE ABORT                   */
         BAL   @14,IPBSABRT                                     02S1076
*   ELSE                            /* IT IS A READ CONTINUE         */
*     DO;                                                       02S1077
         B     @RC01075                                         02S1077
@RF01075 DS    0H                                               02S1078
*       CALL IPBSRDCN;              /* ISSUE READ CONTINUE           */
         BAL   @14,IPBSRDCN                                     02S1078
*       IF LCBBFRSV^=CHAINEND THEN  /* IF READ CONTINUE REQUEST CAME
*                                      FROM IEDQBT THEN              */
         L     @10,LCBBFRSV-1(,RLCB)                            02S1079
         LA    @10,0(,@10)                                      02S1079
         LTR   @10,@10                                          02S1079
         BZ    @RF01079                                         02S1079
*         DO;                                                   02S1080
*           RPARM=LCBBFRSV;         /* GET SAVED INPUT BFR           */
         LR    RPARM,@10                                        02S1081
*           LCBBFRSV=RPARM->PRFLINK;/* DELINK IT                     */
         MVC   LCBBFRSV(3,RLCB),PRFLINK(RPARM)                  02S1082
*           RPARM->PRFQCBA=LCBMHA;  /* SET MH QCB ADDR       @YM06085*/
         MVC   PRFQCBA(3,RPARM),LCBMHA(RLCB)                    02S1083
*           RPARM->PRFPRI=PRIMHBFR; /* SET MH PRIORITY               */
         MVI   PRFPRI(RPARM),X'E4'                              02S1084
*           CALL DSPPOSTR;          /* TPOST INPUT BFR TO INPUT MH   */
         LA    @15,DSPPOSTR(,RDISP)                             02S1085
         BALR  @14,@15                                          02S1085
*         END;                                                  02S1086
*     END;                                                      02S1087
*   END IPBSSTCN;                                               02S1088
@EL00012 DS    0H                                               02S1088
@EF00012 DS    0H                                               02S1088
@ER00012 L     @14,@SA00012                                     02S1088
         BR    @14                                              02S1088
*                                                               02S1089
*   /*****************************************************************/
*   /*                                                               */
*   /* IPBSTHRH: BISYNC/START STOP FID0 TH/RH INITIALIZATION INTERNAL*/
*   /* PROCEDURE - THIS INTERNAL PROCEDURE PROCESSES THE COMMON      */
*   /* INITIALIZATION FOR FID0 TH/RH'S. IT INITIALIZES THE TTHTAG    */
*   /* FIELD TO TTHTAG0 AND THE TTHDCF FIELD TO THE LENGTH OF THE    */
*   /* RH+THE PIU PAD+THE BDU. CALLING PROCEDURES THAT REQUIRE THESE */
*   /* TWO FIELDS TO BE INITIALIZED OTHERWISE MUST MODIFY THEM AFTER */
*   /* RETURN FROM THIS INTERNAL PROCEDURE. INPUTS REQUIRED:         */
*   /* RPARM=THE TNT INDEX DAF TO BE PLACED IN TTHDAF, RPRF=ADDRESS  */
*   /* OF THE BUFFER UNIT IN WHICH THE TH/RH IS TO BE BUILT.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1089
*IPBSTHRH:                                                      02S1089
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1089
IPBSTHRH ST    @14,12(,@13)                                     02S1089
*   RFY                                                         02S1090
*     IEDRH BASED(ADDR(PIU0RH));    /* ADDRESSABILITY FOR FID0 RH    */
*   RFY                                                         02S1091
*     IEDTH BASED(ADDR(PIU0TH));    /* ADDRESSABILITY FOR FID0 TH    */
*   IEDPF2=''B;                     /* CLEAR THE NEGATIVE PREFIX     */
         LR    @10,RPRF                                         02S1092
         SL    @10,@CF00044                                     02S1092
         XC    IEDPF2(8,@10),IEDPF2(@10)                        02S1092
*   PRF2TNTI=ON;                    /* INDICATE TNT INDEX PIU        */
         OI    PRF2TNTI(@10),B'10000000'                        02S1093
*   PRFPIUO=PIUO;                   /* SET PIU OFFSET                */
         MVI   PRFPIUO(RPRF),X'01'                              02S1094
*   TTHBYTE0=TTH0BYT0;              /* SET FID0 CONSTANT FOR BYTE0   */
         LA    @10,PRFPIUO(,RPRF)                               02S1095
         LA    @09,1                                            02S1095
         ALR   @09,@10                                          02S1095
         MVI   TTHBYTE0(@09),X'0C'                              02S1095
*   TTHBYTE1=TTH0BYT1;              /* SET FID0 CONSTANT FOR BYTE1   */
         MVI   TTHBYTE1(@09),X'00'                              02S1096
*   TTHDAF=RPARM;                   /* SET DAF                       */
         STCM  RPARM,3,TTHDAF(@09)                              02S1097
*   TTHOAF=SAVTTCPU;                /* SET OAF TO TCAM PU            */
         L     @07,AVTSAVTP(,RAVT)                              02S1098
         MVC   TTHOAF(2,@09),SAVTTCPU(@07)                      02S1098
*   TTHTAG=TTHTAG0;                 /* SET ZERO ID TAG               */
         SLR   @07,@07                                          02S1099
         STCM  @07,3,TTHTAG(@09)                                02S1099
*   TTHDCF=LENGTH(PIU0RH)+LENGTH(PIU0PAD)+LENGTH(IEDBDU);/* SET DATA
*                                      COUNT FIELD                   */
         MVC   TTHDCF(2,@09),@CH01430                           02S1100
*   IEDRH=TRHFID0;                  /* SET FID0 CONSTANT FOR RH      */
         MVC   IEDRH+11(3,@10),@CB02131                         02S1101
*   PIU0PAD=PIU0PAD0;               /* SET CONSTANT PAD VALUE        */
         MVI   PIU0PAD(@09),X'00'                               02S1102
*   RFY                                                         02S1103
*     IEDRH BASED;                  /* DROP FID0 RH ADDRESSABILITY   */
*   RFY                                                         02S1104
*     IEDTH BASED;                  /* DROP FID0 TH ADDRESSABILITY   */
*   END IPBSTHRH;                                               02S1105
@EL00013 DS    0H                                               02S1105
@EF00013 DS    0H                                               02S1105
@ER00013 L     @14,12(,@13)                                     02S1105
         BR    @14                                              02S1105
*                                                               02S1106
*   /*****************************************************************/
*   /*                                                               */
*   /* IPERRBFR: OUTPUT ERROR BUFFER INTERNAL PROCEDURE - THIS       */
*   /* INTERNAL PROCEDURE BUILDS AND TPOSTS AN ERROR BUFFER TO THE   */
*   /* OUTPUT MH. LCBBFRSV MUST CONTAIN THE ADDRESS OF THE FIRST     */
*   /* OUTPUT BUFFER ON THE SAVE CHAIN.                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1106
*IPERRBFR:                                                      02S1106
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1106
IPERRBFR ST    @14,@SA00014                                     02S1106
*   RPRF=LCBBFRSV;                  /* GET FIRST BFR IN SAVE CHAIN   */
         L     RPRF,LCBBFRSV-1(,RLCB)                           02S1107
         LA    RPRF,0(,RPRF)                                    02S1107
*   LCBBFRSV=PRFLINK;               /* DELINK IT                     */
         MVC   LCBBFRSV(3,RLCB),PRFLINK(RPRF)                   02S1108
*   IEDPF1=''B;                     /* CLEAR NEGATIVE PREFIX         */
         LR    @10,RPRF                                         02S1109
         AL    @10,@CF02511                                     02S1109
         XC    IEDPF1(8,@10),IEDPF1(@10)                        02S1109
*   PRFNLSTN=OFF;                   /* MARK BFR LAST                 */
         NI    PRFNLSTN(RPRF),B'11111101'                       02S1110
*   PRFSIZE=0;                      /* SET ZERO SIZE                 */
         SLR   @10,@10                                          02S1111
         STH   @10,PRFSIZE(,RPRF)                               02S1111
*   PRFQCBA=LCBMHA;                 /* SET MH QCB ADDR       @YM06085*/
         MVC   PRFQCBA(3,RPRF),LCBMHA(RLCB)                     02S1112
*   PRFPRI=PRIERBFR;                /* SET ERROR BFR PRIORITY        */
         MVI   PRFPRI(RPRF),X'E3'                               02S1113
*   RPARM=RPRF;                     /* SET BFR AS ELEMENT            */
         LR    RPARM,RPRF                                       02S1114
*   CALL DSPPOSTR;                  /* TPOST BFR TO OUTPUT MH        */
         LA    @15,DSPPOSTR(,RDISP)                             02S1115
         BALR  @14,@15                                          02S1115
*   END IPERRBFR;                                               02S1116
@EL00014 DS    0H                                               02S1116
@EF00014 DS    0H                                               02S1116
@ER00014 L     @14,@SA00014                                     02S1116
         BR    @14                                              02S1116
*                                                               02S1117
*   /*****************************************************************/
*   /*                                                               */
*   /* IPFREBFR: FREE BUFFER INTERNAL PROCEDURE - THIS INTERNAL      */
*   /* PROCEDURE FREES ALL OF THE BUFFERS THAT ARE CHAINED ON THE    */
*   /* BUFFER SAVE CHAIN. LCBBFRSV MUST CONTAIN THE ADDRESS OF THE   */
*   /* FIRST BUFFER IN THE CHAIN.                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1117
*IPFREBFR:                                                      02S1117
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1117
IPFREBFR ST    @14,@SA00015                                     02S1117
*   RPRF=LCBBFRSV;                  /* GET FIRST BFR IN SAVE CHAIN   */
         L     RPRF,LCBBFRSV-1(,RLCB)                           02S1118
         LA    RPRF,0(,RPRF)                                    02S1118
*   DO UNTIL RPRF=CHAINEND;         /* FREE ALL BUFFERS ON LCBBFRSV  */
@DL01119 DS    0H                                               02S1120
*     PRFQCBA=ADDR(AVTBFRTB);       /* SET BFR RETURN QCB ADDRESS    */
         LA    @10,AVTBFRTB(,RAVT)                              02S1120
         STCM  @10,7,PRFQCBA(RPRF)                              02S1120
*     PRFPRI=PRIBFRTB;              /* SET BFR RETURN PRIORITY       */
         MVI   PRFPRI(RPRF),X'E0'                               02S1121
*     RPARM=RPRF;                   /* SET BFR AS ELEMENT            */
         LR    RPARM,RPRF                                       02S1122
*     RPRF=PRFLINK;                 /* GET NEXT BFR                  */
         L     @10,PRFLINK-1(,RPRF)                             02S1123
         LA    @10,0(,@10)                                      02S1123
         LR    RPRF,@10                                         02S1123
*     CALL DSPPOSTR;                /* TPOST BFR TO BFR RETURN       */
         LA    @15,DSPPOSTR(,RDISP)                             02S1124
         BALR  @14,@15                                          02S1124
*   END;                                                        02S1125
@DE01119 SLR   @10,@10                                          02S1125
         CR    RPRF,@10                                         02S1125
         BNE   @DL01119                                         02S1125
*   LCBBFRSV=CHAINEND;              /* CLEAR SAVE CHAIN POINTER      */
         STCM  @10,7,LCBBFRSV(RLCB)                             02S1126
*   END IPFREBFR;                                               02S1127
@EL00015 DS    0H                                               02S1127
@EF00015 DS    0H                                               02S1127
@ER00015 L     @14,@SA00015                                     02S1127
         BR    @14                                              02S1127
*                                                               02S1128
*   /*****************************************************************/
*   /*                                                               */
*   /* IPFRPLCB: FREE PLCB INTERNAL PROCEDURE - THIS INTERNAL        */
*   /* PROCEDURE WILL FREE THE PLCB IF CONDITIONS ALLOW. IF THE SEND */
*   /* SCHEDULER IS STILL IN THE PLCB AT THE TIME THE PLCB IS TO BE  */
*   /* FREED, THEN IT IS MOVED TO THE DESTINATION QCB AND QCBSNDRQ IS*/
*   /* SET TO INSURE THAT IT IS REINSERTED WHEN A PLCB IS REASSIGNED.*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1128
*IPFRPLCB:                                                      02S1128
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1128
IPFRPLCB ST    @14,@SA00016                                     02S1128
*   RFY                                                         02S1129
*    (RTOQCB,                                                   02S1129
*     RFROMQCB) RSTD;                                           02S1129
*                                   /* IF NOT IN LMD MIDDLE OF  02S1130
*                                      MESSAGE AND NOT IN EXTENDED
*                                      LOCK MODE THEN THE PLCB CAN BE
*                                      FREED                         */
*   IF SCBBFMM=OFF&(SCBLCK1N=OFF×SCBMSGLN=ON) THEN              02S1130
         L     @10,LCBSCBA-1(,RLCB)                             02S1130
         LA    @10,0(,@10)                                      02S1130
         TM    SCBBFMM(@10),B'00000001'                         02S1130
         BNZ   @RF01130                                         02S1130
         TM    SCBMSGLN(@10),B'00001000'                        02S1130
         BNZ   @RT01130                                         02S1130
         TM    SCBLCK1N(@10),B'00100000'                        02S1130
         BO    @RF01130                                         02S1130
@RT01130 DS    0H                                               02S1131
*     DO;                                                       02S1131
*       IF LCBSTCBA->STCBVTO=DSPSEND THEN/* IF THE SEND SCHEDULER IS
*                                      STILL IN THE PLCB THEN REMOVE
*                                      IT                            */
         L     @10,LCBSTCBA-1(,RLCB)                            02S1132
         CLI   STCBVTO(@10),X'22'                               02S1132
         BNE   @RF01132                                         02S1132
*         DO;                                                   02S1133
*           QCBSNDRQ=ON;            /* REQUEST SEND SCHEDULER NEXT
*                                      TIME PLCB ASSIGNED            */
         SLR   @10,@10                                          02S1134
         ICM   @10,7,TRMDESTQ(RTRM)                             02S1134
         LR    @09,@10                                          02S1134
         AL    @09,@CF02512                                     02S1134
         OI    QCBSNDRQ-4(@09),B'00100000'                      02S1134
*           RTOQCB=TRMDESTQ;        /* SET DEST. QCB AS TO QCB       */
         LR    RTOQCB,@10                                       02S1135
*           RFROMQCB=RLCB;          /* SET PLCB AS FROM QCB          */
         LR    RFROMQCB,RLCB                                    02S1136
*           CALL DSPUNAVR;          /* MOVE SEND SCHED. TO DEST. QCB */
         LA    @15,DSPUNAVR(,RDISP)                             02S1137
         BALR  @14,@15                                          02S1137
*         END;                                                  02S1138
*       RPARM=RLCB;                 /* SET PLCB AS PARM TO FREE      */
@RF01132 LR    RPARM,RLCB                                       02S1139
*       CALL IEDIAP07;              /* FREE THE PLCB                 */
         L     @10,AVTSAVTP(,RAVT)                              02S1140
         L     @15,SAVTPRTN(,@10)                               02S1140
         BALR  @14,@15                                          02S1140
*     END;                                                      02S1141
*   RFY                                                         02S1142
*    (RTOQCB,                                                   02S1142
*     RFROMQCB) UNRSTD;                                         02S1142
*   END IPFRPLCB;                                               02S1143
@EL00016 DS    0H                                               02S1143
@EF00016 DS    0H                                               02S1143
@ER00016 L     @14,@SA00016                                     02S1143
         BR    @14                                              02S1143
*                                                               02S1144
*   /*****************************************************************/
*   /*                                                               */
*   /* IPMHBFR: TPOST BUFFERS TO OUTPUT MH INTERNAL PROCEDURE - THIS */
*   /* INTERNAL PROCEDURE TPOSTS THE BUFFERS SAVED ON THE BUFFER SAVE*/
*   /* CHAIN TO THE OUTPUT MH. INPUTS REQUIRED: LCBBFRSV=ADDRESS OF  */
*   /* THE FIRST BUFFER IN THE CHAIN.                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1144
*IPMHBFR:                                                       02S1144
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1144
IPMHBFR  ST    @14,@SA00017                                     02S1144
*   RPRF=LCBBFRSV;                  /* GET FIRST BFR IN SAVE CHAIN   */
         L     RPRF,LCBBFRSV-1(,RLCB)                           02S1145
         LA    RPRF,0(,RPRF)                                    02S1145
*   DO UNTIL RPRF=CHAINEND;         /* POST BFRS TO OUTPUT MH        */
@DL01146 DS    0H                                               02S1147
*     PRFQCBA=LCBMHA;               /* SET MH QCB ADDRESS    @YM06085*/
         MVC   PRFQCBA(3,RPRF),LCBMHA(RLCB)                     02S1147
*     PRFPRI=PRIMHBFR;              /* SET MH PRIORITY               */
         MVI   PRFPRI(RPRF),X'E4'                               02S1148
*     RPARM=RPRF;                   /* SET BFR AS ELEMENT            */
         LR    RPARM,RPRF                                       02S1149
*     RPRF=PRFLINK;                 /* GET NEXT BFR IN THE SAVE CHAIN*/
         L     @10,PRFLINK-1(,RPRF)                             02S1150
         LA    @10,0(,@10)                                      02S1150
         LR    RPRF,@10                                         02S1150
*     CALL DSPPOSTR;                /* PUT BFR ON READY QUEUE        */
         LA    @15,DSPPOSTR(,RDISP)                             02S1151
         BALR  @14,@15                                          02S1151
*   END;                                                        02S1152
@DE01146 SLR   @10,@10                                          02S1152
         CR    RPRF,@10                                         02S1152
         BNE   @DL01146                                         02S1152
*   LCBBFRSV=CHAINEND;              /* CLEAR BFR SAVE CHAIN          */
         STCM  @10,7,LCBBFRSV(RLCB)                             02S1153
*   END IPMHBFR;                                                02S1154
@EL00017 DS    0H                                               02S1154
@EF00017 DS    0H                                               02S1154
@ER00017 L     @14,@SA00017                                     02S1154
         BR    @14                                              02S1154
*                                                               02S1155
*   /*****************************************************************/
*   /*                                                               */
*   /* IPPURGEX: PURGE EXIT INTERNAL PROCEDURE - THIS INTERNAL       */
*   /* PROCEDURE GIVES CONTROL TO THE USER'S PURGE EXIT, IF          */
*   /* SPECIFIED, AND SETS THE APPROPRIATE ERROR BITS WHEN A MESSAGE */
*   /* IS PURGED.                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1155
*IPPURGEX:                                                      02S1155
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1155
IPPURGEX ST    @14,@SA00018                                     02S1155
*   RFY                                                         02S1156
*     RRETCODE RSTD;                                            02S1156
*   IF RDYPURGA^=0 THEN             /* IF PURGE EXIT WAS SPECIFIED   */
         L     @14,AVTRDYA(,RAVT)                               02S1157
         L     @14,RDYPURGA(,@14)                               02S1157
         LTR   @14,@14                                          02S1157
         BZ    @RF01157                                         02S1157
*     DO;                                                       02S1158
*       RPARM=RTRM+LENGTH(IEDNTRM); /* PASS TRM ADDR TO EXIT         */
         LA    RPARM,14                                         02S1159
         ALR   RPARM,RTRM                                       02S1159
*       STM(RMH,RBASE,PURGSAVE);    /* SAVE TCAM REGS                */
         STM   RMH,RBASE,PURGSAVE(RAVT)                         02S1160
*       CALL PURGEXIT;              /* GIVE CONTROL TO PURGE EXIT    */
         LR    @15,@14                                          02S1161
         BALR  @14,@15                                          02S1161
*       LM(RMH,RBASE,PURGSAVE);     /* RESTORE TCAM REGS             */
         LM    RMH,RBASE,PURGSAVE(RAVT)                         02S1162
*       IF RRETCODE=4 THEN          /* IF MSG IS TO BE PURGED THEN   */
         CL    RRETCODE,@CF00330                                02S1163
         BNE   @RF01163                                         02S1163
*         DO;                                                   02S1164
*           SCBSLCTN=ON;            /* SET SELECTION ERROR           */
*           SCBTRMLN=ON;            /* SET TERMINAL ERROR            */
         L     @14,LCBSCBA-1(,RLCB)                             02S1166
         OI    SCBSLCTN(@14),B'10010000'                        02S1166
*         END;                                                  02S1167
*     END;                                                      02S1168
*   RFY                                                         02S1169
*     RRETCODE UNRSTD;                                          02S1169
*   END IPPURGEX;                                               02S1170
@EL00018 DS    0H                                               02S1170
@EF00018 DS    0H                                               02S1170
@ER00018 L     @14,@SA00018                                     02S1170
         BR    @14                                              02S1170
*                                                               02S1171
*   /*****************************************************************/
*   /*                                                               */
*   /* IPREQBFR: REQUEST BUFFER INTERNAL PROCEDURE - THIS INTERNAL   */
*   /* PROCEDURE SETS UP THE ERB AND TPOSTS IT TO IEDQGA TO REQUEST  */
*   /* BUFFERS. INPUTS REQUIRED: RBFRNUM=NUMBER OF BUFFERS TO        */
*   /* REQUEST, RUNITNUM=NUMBER OF UNITS PER BUFFER.                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1171
*IPREQBFR:                                                      02S1171
*   PROC OPTIONS(RETREG,SAVE(14));                              02S1171
IPREQBFR ST    @14,@SA00019                                     02S1171
*   RFY                                                         02S1172
*    (RUNITNUM,                                                 02S1172
*     RBFRNUM) RSTD;                                            02S1172
*   LCBRBCT1=RBFRNUM;               /* SET NUMBER OF BUFFERS         */
         STC   RBFRNUM,LCBRBCT1(,RLCB)                          02S1173
*   LCBRBCT2=RUNITNUM;              /* SET NUMBER OF UNITS PER BUFFER*/
         STC   RUNITNUM,LCBRBCT2(,RLCB)                         02S1174
*   LCBRCQCB=SAVTCNIR;              /* SET RETURN TO THIS MODULE     */
         L     @10,AVTSAVTP(,RAVT)                              02S1175
         L     @10,SAVTCNIR(,@10)                               02S1175
         ST    @10,LCBRCQCB(,RLCB)                              02S1175
*   LCBPRCPG=ON;                    /* INDICATE RETURN ERB           */
         OI    LCBPRCPG(RLCB),B'00000010'                       02S1176
*   LCBERBQB=ADDR(AVTBFREB);        /* SET BFR REQUEST QCB ADDR      */
         LA    @10,AVTBFREB(,RAVT)                              02S1177
         STCM  @10,7,LCBERBQB(RLCB)                             02S1177
*   LCBERBPY=PRIINTRQ;              /* SET INITIAL REQUEST PRIORITY  */
         MVI   LCBERBPY(RLCB),X'E4'                             02S1178
*   RPARM=ADDR(LCBERB);             /* SET ERB AS ELEMENT            */
         LA    RPARM,LCBERB(,RLCB)                              02S1179
*   CALL DSPPOSTR;                  /* TPOST ERB TO IEDQGA           */
         LA    @15,DSPPOSTR(,RDISP)                             02S1180
         BALR  @14,@15                                          02S1180
*   RFY                                                         02S1181
*    (RUNITNUM,                                                 02S1181
*     RBFRNUM) UNRSTD;                                          02S1181
*   END IPREQBFR;                                               02S1182
@EL00019 DS    0H                                               02S1182
@EF00019 DS    0H                                               02S1182
@ER00019 L     @14,@SA00019                                     02S1182
         BR    @14                                              02S1182
*   END IEDNKA                                                  01S1183
*                                                               01S1183
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */
*/*%INCLUDE SYSLIB  (TBDUD   )                                       */
*/*%INCLUDE SYSLIB  (TCD0D   )                                       */
*/*%INCLUDE SYSLIB  (TCD1D   )                                       */
*/*%INCLUDE SYSLIB  (TDCTD   )                                       */
*/*%INCLUDE SYSLIB  (TDISPD  )                                       */
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */
*/*%INCLUDE SYSLIB  (TLGBD   )                                       */
*/*%INCLUDE SYSLIB  (TMODD   )                                       */
*/*%INCLUDE SYSLIB  (TPIUD   )                                       */
*/*%INCLUDE SYSLIB  (TPIU0D  )                                       */
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */
*/*%INCLUDE SYSLIB  (TQCBD   )                                       */
*/*%INCLUDE SYSLIB  (TRDYD   )                                       */
*/*%INCLUDE SYSLIB  (TSCBD   )                                       */
*/*%INCLUDE SYSLIB  (TSIBD   )                                       */
*/*%INCLUDE SYSLIB  (TSNSD   )                                       */
*/*%INCLUDE SYSLIB  (TSTCBD  )                                       */
*/*%INCLUDE SYSLIB  (TSTMHD  )                                       */
*/*%INCLUDE SYSLIB  (TRHD    )                                       */
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */
*/*%INCLUDE SYSLIB  (TTHD    )                                       */
*/*%INCLUDE SYSUT5  (RFY     )                                       */
*/*%INCLUDE SYSUT5  (DCL     )                                       */
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */
*/*%INCLUDE SYSUT5  (PROCESS )                                       */
*/*%INCLUDE SYSUT5  (BUFFER  )                                       */
*/*%INCLUDE SYSUT5  (SNARESP )                                       */
*/*%INCLUDE SYSUT5  (BSRESET )                                       */
*/*%INCLUDE SYSUT5  (BSSENDR )                                       */
*/*%INCLUDE SYSUT5  (BSRECVCB)                                       */
*/*%INCLUDE SYSUT5  (ERB     )                                       */
*/*%INCLUDE SYSUT5  (SNASEND )                                       */
*/*%INCLUDE SYSUT5  (BSSEND  )                                       */
*/*%INCLUDE SYSUT5  (BSSENDD )                                       */
*/*%INCLUDE SYSUT5  (BSSENDC )                                       */
*/*%INCLUDE SYSUT5  (BSRECVCE)                                       */
*/*%INCLUDE SYSUT5  (BSRECV  )                                       */
*/*%INCLUDE SYSUT5  (BSRECVD )                                       */
*/*%INCLUDE SYSUT5  (BSRECVCL)                                       */
*/*%INCLUDE SYSUT5  (BSRECVGP)                                       */
*/*%INCLUDE SYSUT5  (BSRECVL )                                       */
*/*%INCLUDE SYSUT5  (IPBSABRT)                                       */
*/*%INCLUDE SYSUT5  (IPBSCALL)                                       */
*/*%INCLUDE SYSUT5  (IPBSDISC)                                       */
*/*%INCLUDE SYSUT5  (IPBSMNTR)                                       */
*/*%INCLUDE SYSUT5  (IPBSRDCN)                                       */
*/*%INCLUDE SYSUT5  (IPBSRDIN)                                       */
*/*%INCLUDE SYSUT5  (IPBSRESP)                                       */
*/*%INCLUDE SYSUT5  (IPBSRMOD)                                       */
*/*%INCLUDE SYSUT5  (IPBSSAO )                                       */
*/*%INCLUDE SYSUT5  (IPBSSPEC)                                       */
*/*%INCLUDE SYSUT5  (IPBSSTCN)                                       */
*/*%INCLUDE SYSUT5  (IPBSTHRH)                                       */
*/*%INCLUDE SYSUT5  (IPERRBFR)                                       */
*/*%INCLUDE SYSUT5  (IPFREBFR)                                       */
*/*%INCLUDE SYSUT5  (IPFRPLCB)                                       */
*/*%INCLUDE SYSUT5  (IPMHBFR )                                       */
*/*%INCLUDE SYSUT5  (IPPURGEX)                                       */
*/*%INCLUDE SYSUT5  (IPREQBFR)                                       */
*                                                               01S1183
*       ;                                                       01S1183
@DATA    DS    0H
@CH01430 DC    H'10'
@SX02496 XC    BUFTOCLR(0,@07),BUFTOCLR(@07)
         DS    0F
@SA00010 DS    1F
@SA00014 DS    1F
@SA00015 DS    1F
@SA00017 DS    1F
@SA00012 DS    1F
@SA00019 DS    1F
@SA00018 DS    1F
@SA00003 DS    1F
@SA00016 DS    1F
@SA00011 DS    1F
@SA00007 DS    1F
@SA00008 DS    1F
@SA00004 DS    1F
@SA00005 DS    1F
@SA00002 DS    1F
@SA00006 DS    1F
         DS    0F
@CF00059 DC    F'1'
@CF00330 DC    F'4'
@CF00044 DC    F'8'
@CF02135 DC    F'14'
@CF00095 DC    F'15'
@CF02485 DC    F'76'
@CF02511 DC    F'-8'
@CF02512 DC    F'-4'
@CF02504 DC    XL4'0000FFFF'
         DS    0D
BUFTCLEN DC    AL1(8+8+4+1+10+3+5)
@CB01537 DC    X'08000002'
@CB02131 DC    X'0B8000'
@CB02362 DC    X'27F1'
RTRNREQD DS    CL5
         ORG   RTRNREQD
@NM00215 DC    X'08'
@NM00216 DC    X'19'
@NM00217 DC    AL2(0)
@NM00218 DC    X'05'
         ORG   RTRNREQD+5
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SIBPTR   EQU   @02
IEDQAPTR EQU   @13
RDISP    EQU   @11
IEDQLPTR EQU   @04
LCBXPTR  EQU   @05
IEDNLPTR EQU   @10
RMOD     EQU   @15
IEDQPPTR EQU   @06
IEDQQPTR EQU   @07
IEDQSPTR EQU   @03
RTRM     EQU   @08
RAVT     EQU   @13
RPARM    EQU   @01
RLCB     EQU   @04
RPRF     EQU   @06
RMH      EQU   @02
RUNITNUM EQU   @00
RMASK    EQU   @00
RBFRNUM  EQU   @01
RTOQCB   EQU   @03
RFROMQCB EQU   @07
RSTATE   EQU   @10
RBASE    EQU   @12
RRETCODE EQU   @15
RRETADDR EQU   @14
IEDQAVTD EQU   0
AVTSAVE3 EQU   IEDQAVTD+72
AVTSAVEX EQU   IEDQAVTD+216
AVTCSTCS EQU   IEDQAVTD+256
@NM00003 EQU   IEDQAVTD+316
AVTCKFLG EQU   @NM00003
AVTBASE  EQU   IEDQAVTD+340
AVTPKF   EQU   AVTBASE
AVTRNMPT EQU   IEDQAVTD+352
AVTRDYA  EQU   IEDQAVTD+356
AVTOSECB EQU   IEDQAVTD+420
AVTECB1  EQU   AVTOSECB
AVTHG02  EQU   IEDQAVTD+456
AVTDISP  EQU   IEDQAVTD+480
AVTHD    EQU   IEDQAVTD+484
AVTSCOPT EQU   AVTHD
AVTSAVTP EQU   IEDQAVTD+540
AVTSAVTF EQU   AVTSAVTP
AVTCKPEL EQU   IEDQAVTD+580
AVTCKRMV EQU   AVTCKPEL
AVTCKELF EQU   IEDQAVTD+608
AVTCKBYT EQU   IEDQAVTD+619
AVTHG01  EQU   IEDQAVTD+620
AVTCKLNK EQU   IEDQAVTD+624
AVTCRELE EQU   IEDQAVTD+636
AVTCCELE EQU   AVTCRELE
AVTCLRHI EQU   IEDQAVTD+644
AVTADBUF EQU   IEDQAVTD+648
AVTSYSER EQU   IEDQAVTD+656
AVTMSGS  EQU   IEDQAVTD+657
AVTBFREB EQU   IEDQAVTD+708
AVTBFRTB EQU   IEDQAVTD+720
AVTCKPQB EQU   IEDQAVTD+732
AVTCKPTB EQU   AVTCKPQB
AVTCKPEC EQU   AVTCKPQB+4
AVTCKPCC EQU   AVTCKPEC
AVTOPCQB EQU   IEDQAVTD+744
AVTOPCOB EQU   AVTOPCQB
AVTOPCEC EQU   AVTOPCQB+4
AVTOPCCC EQU   AVTOPCEC
AVTOLTQB EQU   IEDQAVTD+756
AVTDSIOB EQU   IEDQAVTD+804
AVTCWFL1 EQU   IEDQAVTD+852
AVTCWFL2 EQU   IEDQAVTD+853
AVTSUBT  EQU   IEDQAVTD+876
AVTIOTR  EQU   IEDQAVTD+877
AVTBIT1  EQU   IEDQAVTD+978
AVTBIT2  EQU   IEDQAVTD+979
AVTBIT3  EQU   IEDQAVTD+980
AVTSTEAL EQU   IEDQAVTD+988
AVTDDFT  EQU   IEDQAVTD+992
AVTDCTLN EQU   IEDQAVTD+1000
AVTBIT4  EQU   IEDQAVTD+1064
@NM00085 EQU   IEDQAVTD+1160
IEDNSVTD EQU   0
SAVTDIAG EQU   IEDNSVTD
SAVTDIAF EQU   SAVTDIAG
SAVTPRTN EQU   IEDNSVTD+32
SAVTCNIR EQU   IEDNSVTD+56
SAVTLUSQ EQU   IEDNSVTD+88
SAVTSAO  EQU   IEDNSVTD+196
SAVTDFCO EQU   IEDNSVTD+200
SAVTTCPU EQU   IEDNSVTD+238
SAVTZELM EQU   IEDNSVTD+270
SAVTRDRV EQU   IEDNSVTD+284
SAVTCKQB EQU   IEDNSVTD+300
SAVTCKTB EQU   SAVTCKQB
SAVTCKEC EQU   SAVTCKQB+4
SAVTCKCC EQU   SAVTCKEC
IEDBDU   EQU   0
BDUCMND  EQU   IEDBDU
BDUMODIF EQU   IEDBDU+1
BDUFNFLG EQU   IEDBDU+2
BDUHEADR EQU   BDUFNFLG
BDUFRSTB EQU   BDUFNFLG
BDUPOSAK EQU   BDUFNFLG
BDUNEGAK EQU   BDUFNFLG
BDUBDUFG EQU   IEDBDU+3
BDUXERLK EQU   BDUBDUFG
BDURSP   EQU   IEDBDU+4
BDUSYRSP EQU   BDURSP
BDUEXRSP EQU   BDURSP+1
BDUEND   EQU   IEDBDU+6
IEDDCT   EQU   0
DCTBYTE1 EQU   IEDDCT+1
DCT3270  EQU   DCTBYTE1
DCTBYTE2 EQU   IEDDCT+2
DCTBYTE3 EQU   IEDDCT+3
DCTBYTE4 EQU   IEDDCT+4
DCTBYTE5 EQU   IEDDCT+5
IEDQDISP EQU   0
DSPDISP  EQU   4
DSPPOSTR EQU   28
DSPUNAVR EQU   44
IEDQLCB  EQU   0
LCBRCB   EQU   IEDQLCB
LCBQCBA  EQU   LCBRCB+1
LCBPRI   EQU   LCBRCB+4
LCBSTCBA EQU   IEDQLCB+9
LCBTSOB  EQU   IEDQLCB+19
LCBCHAIN EQU   IEDQLCB+20
LCBSCRNN EQU   LCBCHAIN
LCBTETEN EQU   LCBCHAIN
LCBABRTN EQU   LCBCHAIN
LCBINSRC EQU   IEDQLCB+21
LCBLKMDE EQU   LCBINSRC+2
LCBNTXT  EQU   IEDQLCB+24
LCBSTAT4 EQU   LCBNTXT
LCBPHASE EQU   LCBSTAT4
LCBSCBDA EQU   IEDQLCB+25
LCBMHA   EQU   IEDQLCB+29
LCBFLAG1 EQU   IEDQLCB+32
LCBIOBSN EQU   IEDQLCB+33
LCBSNS   EQU   LCBIOBSN+1
LCBSENS0 EQU   LCBSNS
LCBLOSDT EQU   LCBSENS0
LCBTMOUT EQU   LCBSENS0
LCBFLAG3 EQU   LCBIOBSN+7
LCBCSW   EQU   LCBIOBSN+8
LCBCSWST EQU   LCBCSW+3
LCBCSWUS EQU   LCBCSWST
LCBCSWCS EQU   LCBCSWST+1
LCBSIOCC EQU   LCBIOBSN+15
LCBDCBPT EQU   IEDQLCB+52
LCBRCQCB EQU   IEDQLCB+56
LCBTHSQ  EQU   IEDQLCB+60
LCBINCAM EQU   LCBTHSQ
LCBERRCT EQU   IEDQLCB+62
LCBLSPCI EQU   IEDQLCB+65
LCBRCBFR EQU   LCBLSPCI
LCBSTATE EQU   IEDQLCB+70
LCBSTAT1 EQU   LCBSTATE
LCBRCLLN EQU   LCBSTAT1
LCBCONT  EQU   LCBSTAT1
LCBSENDN EQU   LCBSTAT1
LCBSTAT2 EQU   LCBSTATE+1
LCBBEOTN EQU   LCBSTAT2
LCBCONNN EQU   LCBBEOTN
LCBNEGRP EQU   LCBSTAT2
LCBSYNC  EQU   LCBSTAT2
LCBDIAL  EQU   LCBSTAT2
LCBRESP  EQU   LCBSTAT2
LCBTSTSW EQU   IEDQLCB+72
LCBERB   EQU   IEDQLCB+76
LCBERBQB EQU   LCBERB+1
LCBERBPY EQU   IEDQLCB+80
LCBERBST EQU   IEDQLCB+84
LCBPRCPG EQU   LCBERBST
LCBDLNKN EQU   LCBERBST
LCBERBCH EQU   IEDQLCB+85
LCBERBCT EQU   IEDQLCB+88
LCBRBCT1 EQU   LCBERBCT
LCBRBCT2 EQU   LCBERBCT+1
LCBTTCIN EQU   IEDQLCB+90
LCBMSGFM EQU   IEDQLCB+92
LCBEOT   EQU   LCBMSGFM
LCBSCBA  EQU   IEDQLCB+93
LCBOBRCH EQU   IEDQLCB+96
LCBINVPT EQU   LCBOBRCH+1
LCBBFRW  EQU   LCBINVPT
LCBTPCD  EQU   IEDQLCB+100
LCBSTAT5 EQU   LCBTPCD
LCBBFRSV EQU   LCBTPCD+1
LCBSTAT6 EQU   LCBTPCD+4
LCBRTRRO EQU   LCBSTAT6
LCBRSPSV EQU   LCBTPCD+8
LCBSAVSN EQU   IEDQLCB+112
LCBERCCW EQU   IEDQLCB+120
LCBCPA   EQU   IEDQLCB+144
LCBCCW5  EQU   LCBCPA+32
LCBATTEL EQU   LCBCCW5
LCBQEBPL EQU   LCBATTEL
IEDQLCBX EQU   0
LCBXCON  EQU   IEDQLCBX
LCBXFLAG EQU   LCBXCON
LCBXDCT  EQU   LCBXCON+1
LCBXRADR EQU   LCBXCON+4
IEDNLGB  EQU   0
LGBBUFOU EQU   IEDNLGB+20
LGBPCI   EQU   IEDNLGB+25
LGBBYTE  EQU   IEDNLGB+29
LGBOFLGS EQU   IEDNLGB+48
LGBRESER EQU   IEDNLGB+56
IEDQMOD  EQU   0
MODCUR   EQU   IEDQMOD+1
MODCUR1  EQU   MODCUR
MODCUR2  EQU   MODCUR+1
MODCEIBJ EQU   MODCUR2
MODNEW   EQU   IEDQMOD+3
MODNEW1  EQU   MODNEW
MODNEW2  EQU   MODNEW+1
MODNEIBJ EQU   MODNEW2
MODNMNTR EQU   MODNEW2
MODNMNTP EQU   MODNEW2
IEDPIU   EQU   0
PIUTH    EQU   IEDPIU
PIURH    EQU   IEDPIU+10
PIURU    EQU   IEDPIU+13
IEDPIU0  EQU   0
PIU0TH   EQU   IEDPIU0
PIU0RH   EQU   IEDPIU0+10
PIU0PAD  EQU   IEDPIU0+13
PIU0RU   EQU   IEDPIU0+14
IEDQPRF  EQU   0
PRFRCB   EQU   IEDQPRF
PRFKEY   EQU   PRFRCB
PRFQCBA  EQU   PRFRCB+1
PRFPRI   EQU   PRFRCB+4
PRFLINK  EQU   PRFRCB+5
PRFTIC   EQU   IEDQPRF+8
PRFTICC  EQU   PRFTIC
PRFTICON EQU   PRFTICC
PRFNBUNT EQU   IEDQPRF+12
PRFSUNIT EQU   PRFNBUNT
PRFPLQCB EQU   PRFSUNIT
PRFPIUO  EQU   PRFPLQCB
PRFLCB   EQU   IEDQPRF+13
@NM00176 EQU   IEDQPRF+16
PRFSVFFO EQU   @NM00176
PRFSIZE  EQU   PRFSVFFO+2
PRFSTAT1 EQU   IEDQPRF+20
PRFEOFN  EQU   PRFSTAT1
PRFNLSTN EQU   PRFSTAT1
PRFCORE  EQU   IEDQPRF+21
PRFXTRA  EQU   PRFCORE
PRFSCAN  EQU   IEDQPRF+24
PRFTQBCK EQU   IEDQPRF+26
PRFNTXT  EQU   PRFTQBCK
PRFEOBOF EQU   PRFNTXT
PRFCHDR  EQU   IEDQPRF+32
PRFHQBCK EQU   IEDQPRF+35
PRFDEST  EQU   IEDQPRF+40
IEDPF1   EQU   0
PRF1FLG1 EQU   IEDPF1+3
PRF1WD2  EQU   IEDPF1+4
PRF1SEQP EQU   PRF1WD2
PRF1SQID EQU   PRF1SEQP
PRF1TAG1 EQU   PRF1SQID
IEDPF2   EQU   0
PRF2FLG2 EQU   IEDPF2
PRF2TNTI EQU   PRF2FLG2
PRF2WD2  EQU   IEDPF2+4
IEDQQCB  EQU   0
QCBDSFLG EQU   IEDQQCB
QCBDISK  EQU   QCBDSFLG
QCBALTMH EQU   QCBDSFLG
QCBEOLDT EQU   IEDQQCB+16
QCBBYTE1 EQU   QCBEOLDT+1
QCBLKRLN EQU   IEDQQCB+18
QCBRETCT EQU   QCBLKRLN
QCBSTAT  EQU   IEDQQCB+19
QCBINSRC EQU   IEDQQCB+21
@NM00184 EQU   QCBINSRC
QCBTSOF2 EQU   @NM00184+1
QCBTSOF1 EQU   @NM00184+2
QCBINTVL EQU   IEDQQCB+24
QCBPREN  EQU   IEDQQCB+28
QCBLKRRN EQU   QCBPREN+1
QCBDCBAD EQU   IEDQQCB+33
QCBFLAG  EQU   IEDQQCB+36
QCBTSSES EQU   QCBFLAG
QCBSDFFO EQU   QCBFLAG
IEDQPQCB EQU   0
QCBFHDLZ EQU   IEDQPQCB+3
QCBPFEFO EQU   QCBFHDLZ+1
QCBFHDTZ EQU   IEDQPQCB+6
QCBINTLF EQU   IEDQPQCB+12
IEDNQCB  EQU   0
QCBSTAT1 EQU   IEDNQCB+4
QCBSNDRQ EQU   QCBSTAT1
QCBPLCBA EQU   IEDNQCB+5
IEDRDY   EQU   0
RDYPURGA EQU   IEDRDY+8
RDYFLAGS EQU   IEDRDY+16
IEDQSCB  EQU   0
SCBSTATE EQU   IEDQSCB
SCBSEQIN EQU   SCBSTATE
SCBLCK1N EQU   SCBSTATE
SCBMSGLN EQU   SCBSTATE
SCBRCVCT EQU   IEDQSCB+4
SCBMBHEN EQU   IEDQSCB+5
SCBBKFCT EQU   IEDQSCB+9
SCBEOBSZ EQU   SCBBKFCT+1
SCBSALEV EQU   IEDQSCB+12
SCBQTYPE EQU   SCBSALEV
SCBBFMM  EQU   SCBQTYPE
SCBERRST EQU   IEDQSCB+16
SCBERR1  EQU   SCBERRST
SCBHDRRN EQU   SCBERR1
SCBORIGN EQU   SCBERR1
SCBNOTRM EQU   SCBERR1
SCBSEQHN EQU   SCBERR1
SCBSEQLN EQU   SCBERR1
SCBCUTFN EQU   SCBERR1
SCBERR2  EQU   SCBERRST+1
SCBABRTN EQU   SCBERR2
SCBERR3  EQU   SCBERRST+2
SCBLOSTN EQU   SCBERR3
SCBTMIDN EQU   SCBERR3
SCBFORMN EQU   SCBERR3
SCBATTN  EQU   SCBERR3
SCBXCEPN EQU   SCBERR3
SCBERR4  EQU   SCBERRST+3
SCBSLCTN EQU   SCBERR4
SCBTXTTN EQU   SCBERR4
SCBCONNN EQU   SCBERR4
SCBTRMLN EQU   SCBERR4
SCBCTLUN EQU   SCBERR4
SCBCHANN EQU   SCBERR4
SCBDLPTR EQU   IEDQSCB+22
SCBEOBAC EQU   SCBDLPTR
SCBCTBAC EQU   SCBEOBAC
SCBBSCFM EQU   IEDQSCB+24
SCBDATEN EQU   SCBBSCFM
SCBMLMTN EQU   SCBBSCFM
SCBITBSZ EQU   IEDQSCB+40
SCBCTBSV EQU   SCBITBSZ
SCBDNSEG EQU   IEDQSCB+41
SCBCLSEG EQU   IEDQSCB+45
SCBITBAC EQU   IEDQSCB+48
SCBCTBFL EQU   SCBITBAC
SCBBLKCT EQU   SCBCTBFL
SCBDCSEG EQU   IEDQSCB+49
SCBSTAT1 EQU   IEDQSCB+60
SCBCORE  EQU   IEDQSCB+61
SCBSCAN  EQU   IEDQSCB+64
SCBNTXT  EQU   IEDQSCB+66
SCBCHDR  EQU   IEDQSCB+72
SCBCCSEG EQU   IEDQSCB+75
SCBEND   EQU   IEDQSCB+84
IEDSIBD  EQU   0
SIBCHAIN EQU   IEDSIBD+4
SIBINDEX EQU   IEDSIBD+8
SIBSESSN EQU   IEDSIBD+10
SIBDSTAT EQU   SIBSESSN
SIBPACIN EQU   IEDSIBD+11
SIBSEQN  EQU   IEDSIBD+12
SIBSTAT1 EQU   IEDSIBD+16
SIBSTAT2 EQU   IEDSIBD+17
SIBBIND  EQU   IEDSIBD+20
SIBBIND1 EQU   SIBBIND
SIBBIND2 EQU   SIBBIND+1
SIBBIND3 EQU   SIBBIND+2
SIBSTAT0 EQU   IEDSIBD+23
IEDSNSD  EQU   0
SNSSYSTM EQU   IEDSNSD
SNSUSER  EQU   IEDSNSD+2
SNSPTR   EQU   0
IEDQSTCB EQU   0
STCBVTO  EQU   IEDQSTCB
IEDSTMH  EQU   0
STMHALT  EQU   IEDSTMH
STMHFLG2 EQU   IEDSTMH+4
STMHCONV EQU   STMHFLG2
STMHLOG  EQU   STMHFLG2
STMHAEIX EQU   IEDSTMH+12
STMHLMD  EQU   STMHAEIX
STMHLMOP EQU   IEDSTMH+17
IEDRH    EQU   0
TRHBYTE0 EQU   IEDRH
TRHTYPE  EQU   TRHBYTE0
TRHRUCAT EQU   TRHBYTE0
TRHFI    EQU   TRHBYTE0
TRHSDI   EQU   TRHBYTE0
TRHBC    EQU   TRHBYTE0
TRHEC    EQU   TRHBYTE0
TRHBYTE1 EQU   IEDRH+1
TRHDR1   EQU   TRHBYTE1
TRHER    EQU   TRHBYTE1
TRHBYTE2 EQU   IEDRH+2
IEDTRM   EQU   0
IEDNTRM  EQU   IEDTRM
TRMBYTE4 EQU   IEDNTRM
TRMBYTE3 EQU   IEDNTRM+1
TRMBYTE2 EQU   IEDNTRM+2
TRMINPG  EQU   TRMBYTE2
TRMGPACT EQU   TRMBYTE2
TRMPREP  EQU   TRMBYTE2
TRMNOSND EQU   TRMBYTE2
TRMBYTE1 EQU   IEDNTRM+3
TRMSCPRQ EQU   TRMBYTE1
TRMINPTP EQU   TRMBYTE1
TRMBYTE0 EQU   IEDNTRM+6
TRMDIAL  EQU   TRMBYTE0
TRMSNA   EQU   TRMBYTE0
TRMSIBPT EQU   IEDNTRM+7
TRMTYPE  EQU   IEDNTRM+11
IEDQTRM  EQU   IEDTRM+14
TRMSTATE EQU   IEDQTRM
TRMLOG   EQU   TRMSTATE
TRMDESTQ EQU   IEDQTRM+1
TRMINSEQ EQU   IEDQTRM+4
TLISTCNT EQU   TRMINSEQ
TRMOUTSQ EQU   IEDQTRM+6
TLISTEN  EQU   TRMOUTSQ
TRMDSORG EQU   TLISTEN
TRMALTD  EQU   IEDQTRM+8
TRMDEVFL EQU   IEDQTRM+10
TRMSTAT  EQU   IEDQTRM+12
TRMCHCIN EQU   IEDQTRM+16
IEDTH    EQU   0
TTHBYTE0 EQU   IEDTH
TTHFTYPE EQU   TTHBYTE0
TTHBBIU  EQU   TTHBYTE0
TTHEBIU  EQU   TTHBYTE0
TTHBYTE1 EQU   IEDTH+1
TTHDAF   EQU   IEDTH+2
TTHOAF   EQU   IEDTH+4
TTHSNF   EQU   IEDTH+6
TTHTAG   EQU   TTHSNF
TTHTAG1  EQU   TTHTAG
TTHTAG2  EQU   TTHTAG+1
TTHDCF   EQU   IEDTH+8
NEGRSPRU EQU   0
BUFTOCLR EQU   0
TEXT     EQU   0
BDQCB    EQU   0
IEDIAP07 EQU   0
IEDQGA02 EQU   0
IEDQTL   EQU   0
IEDQTNT  EQU   0
PURGEXIT EQU   0
DSPBYPAS EQU   20
DSPCHAIN EQU   12
DSPLIFO  EQU   56
DSPLIFOR EQU   60
DSPLIST  EQU   8
DSPPOST  EQU   24
DSPPRIO  EQU   48
DSPPRIOR EQU   52
DSPTRACE EQU   64
DSPTSTQ  EQU   32
DSPTSTQR EQU   36
DSPUNAV  EQU   40
DSPWAIT  EQU   16
QCBLDCB  EQU   0
LCBRSPIN EQU   LCBIOBSN
LCBLUSNS EQU   LCBRSPIN+5
LCBSCPRS EQU   LCBRSPIN+9
LCBCSWU1 EQU   LCBSCPRS+2
LCBRSPFG EQU   LCBRSPIN+15
LCBCOREQ EQU   LCBTPCD
@NM00133 EQU   LCBCPA+40
LCBQNX   EQU   LCBERCCW
LCBQNXMN EQU   LCBQNX
LCBCANCL EQU   LCBSAVSN
LCBCANFG EQU   LCBCANCL
TRMPRE1  EQU   TRMBYTE4
TRMCONT  EQU   TRMPRE1
TRMSESSN EQU   TRMPRE1
TRMERLCK EQU   TRMPRE1
TRMSPOUT EQU   TRMPRE1
TRMNCP1  EQU   TRMBYTE4
TRMPRE   EQU   TRMBYTE3
TRMNLOUT EQU   TRMPRE
TRMRDOUT EQU   TRMPRE
TRMINOUT EQU   TRMPRE
TRMNCP   EQU   TRMBYTE3
TRMPU    EQU   TRMBYTE3
TRMLU    EQU   TRMBYTE3
TRMLINK  EQU   TRMBYTE3
PURGSAVE EQU   AVTSAVE3
BDUTEXT  EQU   BDUEND
PRFSHDR  EQU   IEDQPRF+42
SCBRGSAV EQU   SCBEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00212 EQU   TRMLINK
TRMLSTAT EQU   TRMLINK
TRMLINT  EQU   TRMLINK
TRMEPMOD EQU   TRMLINK
TRMLULOG EQU   TRMLU
TRMINERR EQU   TRMLU
TRMLUREQ EQU   TRMLU
TRMSESRQ EQU   TRMLU
TRMTDIFF EQU   TRMLU
TRMLUTM  EQU   TRMLU
TRMLUIT  EQU   TRMLU
TRMAUTO  EQU   TRMLU
TRMPCONT EQU   TRMPU
@NM00211 EQU   TRMPU
TRMNCONT EQU   TRMNCP
TRMQUCKN EQU   TRMNCP
TRMSLOWN EQU   TRMNCP
TRMSYGEN EQU   TRMNCP
TRMNCPCL EQU   TRMNCP
TRMIPLDM EQU   TRMNCP
TRMWROUT EQU   TRMPRE
TRMASNXI EQU   TRMPRE
TRMSTMM  EQU   TRMPRE
TRMCMODE EQU   TRMPRE
TRMSTPND EQU   TRMPRE
@NM00210 EQU   TRMNCP1
TRMINOP  EQU   TRMNCP1
TRMLYNCH EQU   TRMPRE1
TRMQNPL  EQU   TRMPRE1
TRMSPACT EQU   TRMPRE1
TRMOCNI  EQU   TRMPRE1
@NM00141 EQU   LCBCANCL+3
LCBCANTH EQU   LCBCANCL+1
@NM00140 EQU   LCBCANFG
LCBCANCD EQU   LCBCANFG
@NM00139 EQU   LCBCANFG
LCBCANEB EQU   LCBCANFG
LCBCANXT EQU   LCBCANFG
LCBUNADD EQU   LCBQNX+21
LCBUASZE EQU   LCBQNX+20
LCBDSTEA EQU   LCBQNX+16
@NM00138 EQU   LCBQNX+8
LCBIOSBS EQU   LCBQNX+5
@NM00137 EQU   LCBQNX+4
LCBSTSAV EQU   LCBQNX+1
@NM00136 EQU   LCBQNXMN
LCBNX509 EQU   LCBQNXMN
LCBNX162 EQU   LCBQNXMN
LCBNX142 EQU   LCBQNXMN
LCBNX064 EQU   LCBQNXMN
@NM00135 EQU   @NM00133+4
LCBNCPPT EQU   @NM00133+1
@NM00134 EQU   @NM00133
LCBWRSCH EQU   LCBCOREQ+8
LCBCQLNK EQU   LCBCOREQ+4
LCBCQELE EQU   LCBCOREQ
LCBPAKCH EQU   LCBRSPIN+16
@NM00132 EQU   LCBRSPFG
LCBRSRH  EQU   LCBRSPFG
LCBEXPI  EQU   LCBRSPFG
@NM00131 EQU   LCBRSPIN+12
LCBUSUE1 EQU   LCBCSWU1
@NM00130 EQU   LCBCSWU1
@NM00129 EQU   LCBSCPRS+1
LCBDFCMD EQU   LCBSCPRS
LCBUSER  EQU   LCBLUSNS+2
LCBSMIN  EQU   LCBLUSNS+1
LCBSMAJ  EQU   LCBLUSNS
LCBRHSV  EQU   LCBRSPIN+2
LCBSNS0  EQU   LCBRSPIN+1
@NM00128 EQU   LCBRSPIN
NPRUEND  EQU   NEGRSPRU+5
@NM00219 EQU   NEGRSPRU
@NM00214 EQU   TTHTAG1
TTHTAGS  EQU   TTHTAG1
TTHEFI   EQU   TTHBYTE0
@NM00213 EQU   TTHBYTE0
TRMOPT   EQU   IEDTRM+34
TRMOPTBL EQU   IEDQTRM+18
TRMOPNO  EQU   IEDQTRM+17
TRMSENSE EQU   TRMSTAT+3
TRMTEMPR EQU   TRMSTAT+2
TRMSIO   EQU   TRMSTAT
@NM00209 EQU   TRMDEVFL+1
TRMTPIN  EQU   TRMDEVFL+1
TRMNCPI  EQU   TRMDEVFL+1
TRMRNTRM EQU   TRMDEVFL+1
@NM00208 EQU   TRMDEVFL+1
TRMLMD   EQU   TRMDEVFL+1
TRMCONC  EQU   TRMDEVFL+1
TRMTSOB  EQU   TRMDEVFL
TRMBFDY  EQU   TRMDEVFL
TRMTBLK  EQU   TRMDEVFL
TRMSBLK  EQU   TRMDEVFL
TRMBLKS  EQU   TRMDEVFL
TRMADDC  EQU   TRMDEVFL
TRMDDIG  EQU   TRMDEVFL
TRMBUFS  EQU   TRMDEVFL
TRMPRILK EQU   TRMALTD
TRMLGB   EQU   TRMDSORG
TRMUTERM EQU   TLISTCNT
TRMSCNYN EQU   TRMSTATE
TRMOPTFN EQU   TRMSTATE
TRMHELDN EQU   TRMSTATE
TRMACPTN EQU   TRMSTATE
TRMPREF  EQU   TRMSTATE
TRMPROC  EQU   TRMLOG
TRMLIST  EQU   TRMLOG
TRMLINE  EQU   TRMSTATE
TRMSUBST EQU   IEDNTRM+12
TRMRLMCT EQU   IEDNTRM+10
TRMCOHTG EQU   TRMSIBPT+1
TRMGPCNT EQU   TRMSIBPT
TRMBUFRD EQU   TRMBYTE0
TRMGP    EQU   TRMBYTE0
@NM00207 EQU   TRMBYTE0
TRMOUTPT EQU   TRMBYTE0
TRMINPUT EQU   TRMBYTE0
TRMUDEF  EQU   TRMBYTE0
TRMCOHRT EQU   IEDNTRM+4
TRMSTOTE EQU   TRMBYTE1
TRMCKPRN EQU   TRMBYTE1
TRMTSATN EQU   TRMBYTE1
TRMTRACE EQU   TRMBYTE1
TRMSWBCK EQU   TRMBYTE1
TRMAUTOC EQU   TRMBYTE1
TRMWTNEG EQU   TRMSCPRQ
TRMWRBRK EQU   TRMBYTE2
TRMANDL  EQU   TRMBYTE2
TRMCLOSN EQU   TRMINPG
TRMREMB  EQU   TRMBYTE2
TRMRSACT EQU   TRMBYTE2
@NM00206 EQU   TRHBYTE2
@NM00205 EQU   TRHBYTE2
@NM00204 EQU   TRHBYTE2
TRHCSI   EQU   TRHBYTE2
@NM00203 EQU   TRHBYTE2
TRHCDI   EQU   TRHBYTE2
TRHEB    EQU   TRHBYTE2
TRHBB    EQU   TRHBYTE2
TRHPI    EQU   TRHBYTE1
@NM00202 EQU   TRHBYTE1
@NM00201 EQU   TRHBYTE1
@NM00200 EQU   TRHBYTE1
TRHDR2   EQU   TRHBYTE1
@NM00199 EQU   TRHBYTE1
@NM00198 EQU   TRHBYTE0
STMHOPT  EQU   IEDSTMH+18
STMHCOPO EQU   STMHLMOP
STMHLOPO EQU   IEDSTMH+16
STMHROUT EQU   IEDSTMH+13
STMHLMDO EQU   STMHAEIX
@NM00197 EQU   STMHAEIX
STMHSTCB EQU   IEDSTMH+9
STMHLENG EQU   IEDSTMH+8
STMHTSO  EQU   IEDSTMH+5
STMHTSFG EQU   STMHFLG2
STMHLOP  EQU   STMHFLG2
STMHCOP  EQU   STMHFLG2
STMHSTC  EQU   STMHFLG2
STMHCONT EQU   STMHFLG2
STMHLCIN EQU   STMHFLG2
STCBLINK EQU   IEDQSTCB+5
STCBPRI  EQU   IEDQSTCB+4
STCBTCIN EQU   IEDQSTCB+2
STCBINDX EQU   IEDQSTCB+1
SNSUSR2  EQU   SNSUSER+1
SNSUSR1  EQU   SNSUSER
SNSMIN   EQU   SNSSYSTM+1
SNSMAJ   EQU   SNSSYSTM
SIBLUTYP EQU   SIBSTAT0
SIBCD    EQU   SIBSTAT0
@NM00196 EQU   SIBBIND3
SIBCRES  EQU   SIBBIND3
SIBSPKR  EQU   SIBBIND3
SIBRECOV EQU   SIBBIND3
SIBFMODE EQU   SIBBIND3
SIBALT   EQU   SIBBIND2
SIBBTERM EQU   SIBBIND2
SIBBRACK EQU   SIBBIND2
SIBFMUSE EQU   SIBBIND2
SIBSEBI  EQU   SIBBIND2
SIBSCMP  EQU   SIBBIND2
SIBSEXC  EQU   SIBBIND2
SIBSDEF  EQU   SIBBIND2
SIBSRQM  EQU   SIBBIND1
SIBSCHNG EQU   SIBBIND1
SIBPEBI  EQU   SIBBIND1
SIBPCMP  EQU   SIBBIND1
SIBPEXC  EQU   SIBBIND1
SIBPDEF  EQU   SIBBIND1
SIBPRQM  EQU   SIBBIND1
SIBPCHN  EQU   SIBBIND1
SIBFMPRO EQU   IEDSIBD+19
SIBTSPRO EQU   IEDSIBD+18
@NM00195 EQU   SIBSTAT2
SIBDACLU EQU   SIBSTAT2
SIBRDSCN EQU   SIBSTAT2
SIBTERM  EQU   SIBSTAT2
SIBUSS   EQU   SIBSTAT2
SIBBSTAT EQU   SIBSTAT1
SIBRTRP  EQU   SIBSTAT1
SIBFTERM EQU   SIBSTAT1
SIBRQEND EQU   SIBSTAT1
SIBRQSHT EQU   SIBSTAT1
SIBSEQO  EQU   SIBSEQN+2
SIBSEQI  EQU   SIBSEQN
SIBNCNT  EQU   SIBPACIN
SIBMCNT  EQU   SIBPACIN
SIBSSTAT EQU   SIBSESSN
SIBINBIU EQU   SIBSESSN
SIBSHUTC EQU   SIBSESSN
SIBLGOFF EQU   SIBSESSN
SIBRUSEG EQU   IEDSIBD
SCBTRANS EQU   IEDQSCB+81
SCBUNTCT EQU   IEDQSCB+80
SCBEOB   EQU   IEDQSCB+78
SCBNXCPB EQU   SCBCCSEG
SCBNHDR  EQU   SCBCHDR
SCBCRCD  EQU   IEDQSCB+69
SCBTQBCK EQU   SCBNTXT
SCBOSEQ  EQU   SCBSCAN
SCBXTRA  EQU   SCBCORE
SCBNOPST EQU   SCBSTAT1
SCBNIDLE EQU   SCBSTAT1
SCBCEND  EQU   SCBSTAT1
SCBCBGN  EQU   SCBSTAT1
SCBSIZE  EQU   IEDQSCB+58
SCBSRCE  EQU   IEDQSCB+56
SCBDEOB  EQU   IEDQSCB+52
SCBFEFO  EQU   SCBDCSEG
SCBCTBND EQU   SCBBLKCT
SCBSCHDR EQU   SCBCLSEG
SCBHBFNO EQU   IEDQSCB+44
SCBSCSEG EQU   SCBDNSEG
SCBBCTR  EQU   SCBCTBSV
SCBCCHDR EQU   IEDQSCB+37
SCBDESTL EQU   IEDQSCB+36
SCBDCHDR EQU   IEDQSCB+33
SCBCPBNO EQU   IEDQSCB+32
SCBMBSSA EQU   IEDQSCB+25
SCBNOEOT EQU   SCBBSCFM
@NM00194 EQU   SCBBSCFM
SCBNPDTR EQU   SCBDATEN
SCBCNTEN EQU   SCBBSCFM
SCBRCVTX EQU   SCBBSCFM
SCBNONTR EQU   SCBBSCFM
SCBTRNSP EQU   SCBBSCFM
SCBENDCR EQU   SCBCTBAC+1
SCBCRLEN EQU   SCBCTBAC
SCBMRFSD EQU   IEDQSCB+20
SCBUNDFN EQU   SCBERR4
SCBSTERN EQU   SCBCHANN
SCBCPMEN EQU   SCBCTLUN
@NM00193 EQU   SCBERR4
SCBAPERR EQU   SCBTXTTN
SCBPERRN EQU   SCBXCEPN
SCBTHRSN EQU   SCBATTN
SCBFIERN EQU   SCBFORMN
SCBUSERN EQU   SCBERR3
SCBSATTN EQU   SCBERR3
SCBTMINN EQU   SCBERR3
SCBXPD   EQU   SCBTMIDN
SCBXPI   EQU   SCBLOSTN
SCBSOHE  EQU   SCBERR2
SCBFRWDN EQU   SCBERR2
SCBRRJN  EQU   SCBABRTN
SCBOLTR  EQU   SCBERR2
SCBALN   EQU   SCBERR2
SCBCODER EQU   SCBERR2
SCBCRMAX EQU   SCBERR2
SCBCRMIN EQU   SCBERR2
SCBRVISL EQU   SCBCUTFN
SCBNOBFN EQU   SCBERR1
@NM00192 EQU   SCBERR1
SCBNOVAC EQU   SCBSEQLN
SCBNOTSO EQU   SCBSEQHN
SCBRVITX EQU   SCBNOTRM
SCBHANG  EQU   SCBORIGN
SCBNOLOG EQU   SCBHDRRN
SCBMRFPL EQU   IEDQSCB+13
SCBBBFTM EQU   SCBQTYPE
SCBNOFF  EQU   SCBQTYPE
SCBCONC  EQU   SCBQTYPE
SCBNREUS EQU   SCBQTYPE
SCBREUS  EQU   SCBQTYPE
SCBCOREQ EQU   SCBQTYPE
SCBNORCL EQU   SCBQTYPE
SCBCTBSZ EQU   SCBEOBSZ
@NM00191 EQU   SCBBKFCT
SCBPRI   EQU   IEDQSCB+8
SCBMACR  EQU   SCBMBHEN
SCBSNDCT EQU   SCBRCVCT
SCBDESTQ EQU   IEDQSCB+1
SCBCODE  EQU   SCBSTATE
SCBPRER  EQU   SCBSTATE
SCBCKPT  EQU   SCBSTATE
SCBERSDS EQU   SCBSTATE
SCBMGFMN EQU   SCBSEQIN
SCBTRANP EQU   SCBSTATE
@NM00190 EQU   IEDRDY+17
@NM00189 EQU   RDYFLAGS
RDYOPENI EQU   RDYFLAGS
RDYOPEND EQU   RDYFLAGS
RDYPRIA  EQU   IEDRDY+12
RDYRSMA  EQU   IEDRDY+4
RDYGMMA  EQU   IEDRDY
QCBTTCIN EQU   QCBPLCBA+1
@NM00188 EQU   QCBPLCBA
@NM00187 EQU   QCBSTAT1
QCBFLUSH EQU   QCBSTAT1
QCBNDXRQ EQU   QCBSTAT1
QCBESIG  EQU   QCBSTAT1
QCBRCVRQ EQU   QCBSTAT1
QCBWAITC EQU   QCBSTAT1
QCBPLCBN EQU   QCBSTAT1
QCBCHAIN EQU   IEDNQCB
QCBPQBCK EQU   IEDQPQCB+25
QCBPRIPQ EQU   IEDQPQCB+24
QCBCFHDR EQU   IEDQPQCB+21
QCBLFEFO EQU   IEDQPQCB+18
QCBFFEFO EQU   IEDQPQCB+15
QCBPREVF EQU   QCBINTLF
QCBINTFF EQU   IEDQPQCB+9
QCBDATSQ EQU   QCBFHDTZ+1
@NM00186 EQU   QCBFHDTZ
@NM00185 EQU   QCBPFEFO
QCBDATFL EQU   QCBFHDLZ
QCBDNHDR EQU   IEDQPQCB
QCBQBACK EQU   IEDQQCB+37
QCBCKPT  EQU   QCBFLAG
QCBPROC  EQU   QCBFLAG
QCBTERMQ EQU   QCBFLAG
QCBRSRV  EQU   QCBFLAG
QCBREAD  EQU   QCBFLAG
QCBNOBRK EQU   QCBFLAG
QCBLGBAD EQU   QCBDCBAD
QCBRELLN EQU   IEDQQCB+32
QCBTJID  EQU   QCBLKRRN+1
QCBCARCT EQU   QCBLKRRN
QCBPRLVL EQU   QCBPREN
QCBMSGCT EQU   IEDQQCB+26
QCBEXTO  EQU   QCBINTVL
QCBDISC  EQU   QCBTSOF1
QCBDELAY EQU   QCBTSOF1
QCBPARTO EQU   QCBTSOF1
QCBSATRD EQU   QCBTSOF1
QCBNOBUF EQU   QCBTSOF1
QCBTPUT  EQU   QCBTSOF1
QCBTGET  EQU   QCBTSOF1
QCBWRBRK EQU   QCBTSOF1
QCBSATLC EQU   QCBTSOF2
QCBSATTI EQU   QCBTSOF2
QCBSATCH EQU   QCBTSOF2
QCBSIMRD EQU   QCBTSOF2
QCBDSSMI EQU   QCBTSOF2
QCBPOSTO EQU   QCBTSOF2
QCBBUFQ  EQU   QCBTSOF2
QCBINHBN EQU   QCBTSOF2
QCBSATCT EQU   @NM00184
QCBSCBOF EQU   IEDQQCB+20
QCBTIME  EQU   QCBSTAT
QCBCLOCK EQU   QCBSTAT
QCBSCHDL EQU   QCBSTAT
QCBSMODE EQU   QCBSTAT
QCBSEND  EQU   QCBSTAT
QCBBUFRD EQU   QCBSTAT
QCBTRMHO EQU   QCBSTAT
QCBEOM   EQU   QCBSTAT
QCBHUCT  EQU   QCBRETCT
QCBIEND  EQU   QCBRETCT
QCBEND   EQU   QCBRETCT
QCBNL    EQU   QCBRETCT
QCBLOGCT EQU   QCBRETCT
@NM00183 EQU   QCBBYTE1
QCBRITRM EQU   QCBBYTE1
@NM00182 EQU   QCBEOLDT
QCBSLINK EQU   IEDQQCB+13
QCBSTPRI EQU   IEDQQCB+12
QCBSTCHN EQU   IEDQQCB+9
QCBSTVTO EQU   IEDQQCB+8
QCBLINK  EQU   IEDQQCB+5
QCBPRI   EQU   IEDQQCB+4
QCBELCHN EQU   IEDQQCB+1
QCBHELD  EQU   QCBDSFLG
QCBFQCB  EQU   QCBDSFLG
QCBDRQQ  EQU   QCBDSFLG
QCBREUS  EQU   QCBDISK
QCBNREUS EQU   QCBDISK
QCBCORE  EQU   QCBDSFLG
QCBTSQ   EQU   QCBDSFLG
PRF2SEQP EQU   PRF2WD2
@NM00181 EQU   IEDPF2+1
@NM00180 EQU   PRF2FLG2
PRF2TERM EQU   PRF2FLG2
PRF2SMI  EQU   PRF2FLG2
PRF2FORM EQU   PRF2FLG2
PRF1RULN EQU   PRF1SEQP+2
PRF1TAG2 EQU   PRF1SQID+1
@NM00179 EQU   PRF1TAG1
PRF1TAGS EQU   PRF1TAG1
@NM00178 EQU   PRF1FLG1
PRF1LOGD EQU   PRF1FLG1
PRF1USS  EQU   PRF1FLG1
PRF1FORM EQU   PRF1FLG1
PRF1EXPI EQU   PRF1FLG1
PRF1FIDI EQU   PRF1FLG1
PRF1RH   EQU   IEDPF1
PRFISEQ  EQU   IEDQPRF+38
PRFSTXT  EQU   PRFHQBCK
PRFNHDR  EQU   PRFCHDR
PRFCRCD  EQU   IEDQPRF+29
PRFSVSEQ EQU   PRFNTXT+1
PRFSVPRI EQU   PRFEOBOF
PRFISIZE EQU   PRFSCAN+1
@NM00177 EQU   PRFSCAN
PRFEOB   EQU   PRFXTRA+1
PRFSTSO  EQU   PRFXTRA
PRFNHDRN EQU   PRFSTAT1
PRFLOCK  EQU   PRFEOFN
PRFDUPLN EQU   PRFSTAT1
PRFTSMSG EQU   PRFSTAT1
PRFITCPN EQU   PRFSTAT1
PRFERMGN EQU   PRFSTAT1
PRFCNCLN EQU   PRFSTAT1
PRFSVFLG EQU   @NM00176+3
PRFSRCE  EQU   PRFSVFFO
PRFTI0   EQU   PRFTIC+1
@NM00175 EQU   PRFTICC
@NM00174 EQU   PRFTICC
@NM00173 EQU   PRFTICC
@NM00172 EQU   PRFTICC
@NM00171 EQU   PRFTICC
PRFBFMM  EQU   PRFTICC
PRFEOMSG EQU   PRFTICC
PRFCOUNT EQU   PRFLINK+1
@NM00170 EQU   PRFLINK
PRFFLAGS EQU   PRFPRI
PRFIOADR EQU   PRFQCBA
PRFOPCDE EQU   PRFKEY
MODNINTE EQU   MODNEW2
MODNSUBB EQU   MODNEW2
MODNINTO EQU   MODNEIBJ
MODNRLGR EQU   MODNEW2
MODNRERP EQU   MODNEW2
@NM00169 EQU   MODNEW2
MODNCTXT EQU   MODNEW1
MODNEMLC EQU   MODNEW1
MODNITFL EQU   MODNEW1
@NM00168 EQU   MODNEW1
MODNEIBD EQU   MODNEW1
MODNRLGW EQU   MODNEW1
MODNWERP EQU   MODNEW1
@NM00167 EQU   MODNEW1
MODCMNTP EQU   MODCUR2
MODCMNTR EQU   MODCUR2
MODCINTE EQU   MODCUR2
MODCSUBB EQU   MODCUR2
MODCINTO EQU   MODCEIBJ
MODCRLGR EQU   MODCUR2
MODCRERP EQU   MODCUR2
@NM00166 EQU   MODCUR2
MODCCTXT EQU   MODCUR1
MODCEMLC EQU   MODCUR1
MODCITFL EQU   MODCUR1
@NM00165 EQU   MODCUR1
MODCEIBD EQU   MODCUR1
MODCRLGW EQU   MODCUR1
MODCWERP EQU   MODCUR1
@NM00164 EQU   MODCUR1
MODLNG   EQU   IEDQMOD
LGBIVLST EQU   IEDNLGB+60
LGBRESV4 EQU   LGBRESER+3
LGBRESV3 EQU   LGBRESER+2
LGBRESV2 EQU   LGBRESER+1
LGBRESV1 EQU   LGBRESER
LGBBUFSI EQU   IEDNLGB+54
@NM00163 EQU   IEDNLGB+53
LGBILCT  EQU   IEDNLGB+52
LGBSCTAD EQU   IEDNLGB+49
@NM00162 EQU   LGBOFLGS
LGBOPEN  EQU   LGBOFLGS
@NM00161 EQU   LGBOFLGS
LGBNAME  EQU   IEDNLGB+40
@NM00160 EQU   IEDNLGB+36
LGBTRANS EQU   IEDNLGB+33
@NM00159 EQU   IEDNLGB+32
@NM00158 EQU   IEDNLGB+31
LGBOPACE EQU   IEDNLGB+30
@NM00157 EQU   LGBBYTE
LGBPACK  EQU   LGBBYTE
LGBBUFMA EQU   IEDNLGB+28
LGBDSORG EQU   IEDNLGB+26
@NM00156 EQU   LGBPCI
@NM00155 EQU   LGBPCI
LGBPCINO EQU   LGBPCI
@NM00154 EQU   LGBPCI
LGBPCIAO EQU   LGBPCI
@NM00153 EQU   LGBPCI
@NM00152 EQU   LGBPCI
@NM00151 EQU   LGBPCI
@NM00150 EQU   IEDNLGB+24
LGBMHA   EQU   IEDNLGB+21
@NM00149 EQU   LGBBUFOU
LGBPREF  EQU   LGBBUFOU
@NM00148 EQU   LGBBUFOU
LGBSUBST EQU   IEDNLGB+18
LGBTYPE  EQU   IEDNLGB+17
@NM00147 EQU   IEDNLGB
LCBERADR EQU   LCBXRADR+1
LCBPCIRC EQU   LCBXRADR
LCBDCT3  EQU   LCBXDCT+2
LCBDCT2  EQU   LCBXDCT+1
LCBDCT1  EQU   LCBXDCT
@NM00146 EQU   LCBXFLAG
LCBERPND EQU   LCBXFLAG
LCBSRCPF EQU   LCBXFLAG
LCBGPCTV EQU   LCBXFLAG
@NM00145 EQU   LCBXFLAG
@NM00144 EQU   LCBXFLAG
@NM00143 EQU   LCBXFLAG
@NM00142 EQU   LCBXFLAG
LCBCCW10 EQU   LCBCPA+72
LCBCCW9  EQU   LCBCPA+64
LCBCCW8  EQU   LCBCPA+56
LCBCCW7  EQU   LCBCPA+48
LCBCCW6  EQU   LCBCPA+40
LCBCP    EQU   LCBQEBPL+4
LCBIOSB  EQU   LCBQEBPL+1
LCBSIO   EQU   LCBQEBPL
LCBCCW4  EQU   LCBCPA+24
LCBCCW3  EQU   LCBCPA+16
LCBCCW2  EQU   LCBCPA+8
LCBCCW1  EQU   LCBCPA
@NM00127 EQU   LCBERCCW+16
LCBATL05 EQU   LCBERCCW+8
@NM00126 EQU   LCBERCCW
LCBCSWSV EQU   LCBSAVSN+1
LCBSNSV  EQU   LCBSAVSN
LCBBFSNS EQU   LCBRSPSV
LCBWAITC EQU   LCBTPCD+5
LCBINPAK EQU   LCBSTAT6
LCBMHBID EQU   LCBSTAT6
LCBHDRPD EQU   LCBSTAT6
LCBCHN   EQU   LCBSTAT6
@NM00125 EQU   LCBSTAT5
LCBLUS   EQU   LCBSTAT5
LCBLUNIT EQU   LCBSTAT5
LCBPERM  EQU   LCBSTAT5
LCBNXCMD EQU   LCBBFRW
LCBERMSK EQU   LCBOBRCH
LCBOLT   EQU   LCBMSGFM
LCBENQ   EQU   LCBMSGFM
LCBTTD   EQU   LCBMSGFM
LCBRSTRT EQU   LCBMSGFM
LCBVSTRT EQU   LCBMSGFM
LCBACKI  EQU   LCBMSGFM
LCBNAK   EQU   LCBMSGFM
@NM00124 EQU   LCBRBCT2
LCBDCNT  EQU   LCBRBCT2
LCBCOMPL EQU   LCBDLNKN
LCBERROR EQU   LCBERBST
@NM00123 EQU   LCBERBST
LCBINQ   EQU   LCBERBST
LCBRDERR EQU   LCBERBST
LCBEOMSG EQU   LCBERBST
LCBMSG   EQU   LCBERBST
LCBERBLK EQU   IEDQLCB+81
LCBERBKY EQU   LCBERB
LCBRECAD EQU   IEDQLCB+73
@NM00122 EQU   LCBTSTSW
@NM00121 EQU   LCBTSTSW
@NM00120 EQU   LCBTSTSW
@NM00119 EQU   LCBTSTSW
@NM00118 EQU   LCBTSTSW
@NM00117 EQU   LCBTSTSW
@NM00116 EQU   LCBTSTSW
LCBCONCT EQU   LCBTSTSW
LCBBFRAV EQU   LCBDIAL
LCBATTN  EQU   LCBSYNC
LCBSNDPR EQU   LCBSTAT2
LCBMSGNN EQU   LCBSTAT2
LCBTRACE EQU   LCBSTAT2
LCBRECVN EQU   LCBSTAT1
LCBFREEN EQU   LCBSTAT1
LCBINITN EQU   LCBSTAT1
LCBOCNI  EQU   LCBSTAT1
LCBOCWTN EQU   LCBSTAT1
LCBRECOF EQU   IEDQLCB+68
LCBRDBFR EQU   LCBRCBFR
LCBUCBX  EQU   IEDQLCB+64
LCBTTBIN EQU   LCBERRCT
@NM00115 EQU   LCBINCAM
LCBGETMN EQU   LCBINCAM
LCBRESTR EQU   LCBRCQCB
LCBPCILK EQU   LCBDCBPT
LCBSTART EQU   LCBIOBSN+16
LCBAP4OL EQU   LCBSIOCC
LCBAP3OL EQU   LCBSIOCC
LCBAP2OL EQU   LCBSIOCC
LCBAP1OL EQU   LCBSIOCC
LCBSIOC2 EQU   LCBSIOCC
LCBSIOC1 EQU   LCBSIOCC
@NM00114 EQU   LCBSIOCC
LCBCSWRC EQU   LCBCSW+5
LCBCSCHC EQU   LCBCSWCS
LCBCSICC EQU   LCBCSWCS
LCBCSCCC EQU   LCBCSWCS
LCBCSCDC EQU   LCBCSWCS
LCBCSPTC EQU   LCBCSWCS
LCBCSPGC EQU   LCBCSWCS
LCBCSIL  EQU   LCBCSWCS
LCBCSPCI EQU   LCBCSWCS
LCBUSUE  EQU   LCBCSWUS
LCBUSUC  EQU   LCBCSWUS
LCBUSDE  EQU   LCBCSWUS
LCBUSCE  EQU   LCBCSWUS
LCBUSBSY EQU   LCBCSWUS
LCBUSCUE EQU   LCBCSWUS
LCBUSSM  EQU   LCBCSWUS
LCBUSAT  EQU   LCBCSWUS
LCBCSWCA EQU   LCBCSW
LCBOBR   EQU   LCBFLAG3
LCBOBRRD EQU   LCBFLAG3
LCBIOMSG EQU   LCBFLAG3
LCBSOHC  EQU   LCBFLAG3
LCBRLAD  EQU   LCBFLAG3
LCBSOHR  EQU   LCBFLAG3
@NM00113 EQU   LCBFLAG3
LCBECBPT EQU   LCBIOBSN+4
LCBECBCC EQU   LCBIOBSN+3
LCBSENS1 EQU   LCBSNS+1
LCBABORT EQU   LCBTMOUT
LCBNOTIN EQU   LCBLOSDT
LCBOVRUN EQU   LCBSENS0
LCBDATCK EQU   LCBSENS0
LCBEQUCK EQU   LCBSENS0
LCBBUSCK EQU   LCBSENS0
LCBINTRQ EQU   LCBSENS0
LCBCMDRJ EQU   LCBSENS0
LCBFLAG2 EQU   LCBIOBSN
@NM00112 EQU   LCBFLAG1
LCBUNREL EQU   LCBFLAG1
LCBEXCPN EQU   LCBFLAG1
@NM00111 EQU   LCBFLAG1
LCBERPIN EQU   LCBFLAG1
@NM00110 EQU   LCBFLAG1
LCBFSBFR EQU   LCBMHA
LCBISZE  EQU   IEDQLCB+28
LCBLNENT EQU   LCBSCBDA+1
@NM00109 EQU   LCBSCBDA
LCBCPGMH EQU   LCBSTAT4
LCBREAL  EQU   LCBPHASE
@NM00108 EQU   LCBSTAT4
LCBACTRQ EQU   LCBSTAT4
LCBIPLRQ EQU   LCBSTAT4
LCBDACRQ EQU   LCBSTAT4
LCBDMPRQ EQU   LCBSTAT4
@NM00107 EQU   LCBLKMDE
LCBLOCKI EQU   LCBLKMDE
LCBLOCKR EQU   LCBLKMDE
LCBHMFLG EQU   LCBLKMDE
LCBBDFLG EQU   LCBLKMDE
@NM00106 EQU   LCBINSRC
LCBCTLMD EQU   LCBTETEN
LCBBFRSZ EQU   LCBCHAIN
LCBUREQN EQU   LCBCHAIN
LCBNORTY EQU   LCBCHAIN
LCBERMSG EQU   LCBCHAIN
LCBEXCP  EQU   LCBCHAIN
LCBINVRQ EQU   LCBSCRNN
LCB2741N EQU   LCBTSOB
LCBINHBN EQU   LCBTSOB
LCBCIRCD EQU   LCBTSOB
LCBPREP  EQU   LCBTSOB
LCBSOPL  EQU   LCBTSOB
LCBSATRD EQU   LCBTSOB
LCBTSBUF EQU   LCBTSOB
LCBWRBRK EQU   LCBTSOB
LCBTDL   EQU   IEDQLCB+18
LCBEOLTD EQU   IEDQLCB+16
LCBRSLNK EQU   IEDQLCB+13
LCBRSPRI EQU   IEDQLCB+12
LCBRSKEY EQU   IEDQLCB+8
LCBLINK  EQU   LCBRCB+5
LCBKEY   EQU   LCBRCB
@NM00105 EQU   DCTBYTE5
DCTL3270 EQU   DCTBYTE5
DCTSCS   EQU   DCTBYTE5
DCTTSPRF EQU   DCTBYTE4
DCTFMPRF EQU   DCTBYTE4
DCT2760  EQU   DCTBYTE3
DCTNOIDL EQU   DCTBYTE3
DCTCONTN EQU   DCTBYTE3
DCTBUFF  EQU   DCTBYTE3
DCTCHECK EQU   DCTBYTE3
DCTENCTL EQU   DCTBYTE3
DCTWTTA  EQU   DCTBYTE3
DCT1050  EQU   DCTBYTE3
DCTAUDIO EQU   DCTBYTE2
DCTLOCAL EQU   DCTBYTE2
DCTCONT  EQU   DCTBYTE2
DCTXMIT  EQU   DCTBYTE2
DCTSTCTL EQU   DCTBYTE2
DCTTWX   EQU   DCTBYTE2
DCTBRDST EQU   DCTBYTE2
DCTBISYN EQU   DCTBYTE2
DCTUMASK EQU   DCTBYTE1
DCTSADEV EQU   DCTBYTE1
DCT2741  EQU   DCTBYTE1
DCT5041  EQU   DCTBYTE1
DCTATTEN EQU   DCTBYTE1
DCTBREAK EQU   DCTBYTE1
DCTINHIB EQU   DCTBYTE1
DCTBYTE0 EQU   IEDDCT
BDUXGRPH EQU   BDUEXRSP
BDUXFINL EQU   BDUEXRSP
BDUXINIT EQU   BDUEXRSP
BDURESP  EQU   BDUSYRSP
BDUPHASE EQU   BDUSYRSP
BDUERROR EQU   BDUSYRSP
BDUALTAK EQU   BDUFNFLG
BDUTPTX  EQU   BDUFNFLG
BDULEADG EQU   BDUFNFLG
BDUSTHDR EQU   BDUFNFLG
SAVTBITN EQU   IEDNSVTD+312
@NM00104 EQU   SAVTCKQB+8
@NM00103 EQU   SAVTCKEC+1
@NM00102 EQU   SAVTCKCC
SAVTCKPO EQU   SAVTCKCC
SAVTCKWA EQU   SAVTCKCC
SAVTCKCH EQU   SAVTCKTB+1
SAVTCKVT EQU   SAVTCKTB
@NM00101 EQU   IEDNSVTD+297
SAVTRDFG EQU   SAVTRDRV+12
@NM00100 EQU   SAVTRDRV+5
SAVTRDPY EQU   SAVTRDRV+4
SAVTRDQB EQU   SAVTRDRV+1
SAVTRDKY EQU   SAVTRDRV
SAVTNID  EQU   IEDNSVTD+280
SAVTDVAS EQU   IEDNSVTD+276
SAVTPLSZ EQU   IEDNSVTD+274
@NM00099 EQU   IEDNSVTD+273
SAVTSUBL EQU   IEDNSVTD+272
@NM00098 EQU   SAVTZELM+1
SAVTSUBM EQU   SAVTZELM
SAVTMHDX EQU   IEDNSVTD+268
SAVTNAT1 EQU   IEDNSVTD+266
SAVTSH20 EQU   IEDNSVTD+264
SAVTLCBS EQU   IEDNSVTD+260
SAVTRNMP EQU   IEDNSVTD+256
SAVTTNTX EQU   IEDNSVTD+252
SAVTNAX  EQU   IEDNSVTD+248
SAVTSUBV EQU   IEDNSVTD+247
SAVTSUBA EQU   IEDNSVTD+246
SAVTSIBC EQU   IEDNSVTD+244
SAVTBSM  EQU   IEDNSVTD+240
SAVTSCPT EQU   SAVTTCPU
SAVTRQTG EQU   IEDNSVTD+236
SAVTRQCH EQU   IEDNSVTD+232
SAVTMAND EQU   IEDNSVTD+228
SAVTSPLN EQU   IEDNSVTD+224
SAVTNADL EQU   IEDNSVTD+222
SAVTNATL EQU   IEDNSVTD+220
SAVTMHTB EQU   IEDNSVTD+216
SAVTSSMH EQU   IEDNSVTD+212
SAVTQRS  EQU   IEDNSVTD+208
SAVTRQIN EQU   IEDNSVTD+204
SAVTSARI EQU   IEDNSVTD+192
SAVTSAC  EQU   IEDNSVTD+188
SAVTSAI  EQU   IEDNSVTD+184
SAVTCSCI EQU   IEDNSVTD+180
SAVTSSRP EQU   IEDNSVTD+176
SAVTSSRQ EQU   IEDNSVTD+172
SAVTSCLU EQU   IEDNSVTD+168
SAVTXTRQ EQU   IEDNSVTD+164
SAVTMVBF EQU   IEDNSVTD+160
@NM00097 EQU   IEDNSVTD+148
SAVTIPCQ EQU   IEDNSVTD+144
@NM00096 EQU   IEDNSVTD+136
SAVTXFMI EQU   IEDNSVTD+132
@NM00095 EQU   IEDNSVTD+124
SAVTXFMO EQU   IEDNSVTD+120
@NM00094 EQU   IEDNSVTD+116
SAVTSSSR EQU   IEDNSVTD+112
SAVTSCPQ EQU   IEDNSVTD+108
SAVTSLCB EQU   IEDNSVTD+104
SAVTLUSR EQU   IEDNSVTD+100
@NM00093 EQU   SAVTLUSQ+8
SAVTLUSP EQU   SAVTLUSQ+4
SAVTLUSB EQU   SAVTLUSQ
@NM00092 EQU   IEDNSVTD+84
SAVTSAT  EQU   IEDNSVTD+80
SAVTNAT  EQU   IEDNSVTD+76
SAVTCLUP EQU   IEDNSVTD+72
SAVTPIUT EQU   IEDNSVTD+68
SAVTRNTA EQU   IEDNSVTD+64
SAVTDNIR EQU   IEDNSVTD+60
SAVTFLDH EQU   IEDNSVTD+52
SAVTSRTN EQU   IEDNSVTD+48
SAVTSREQ EQU   IEDNSVTD+44
SAVTFAIL EQU   IEDNSVTD+42
SAVTSUSE EQU   IEDNSVTD+40
SAVTSIB  EQU   IEDNSVTD+36
@NM00091 EQU   IEDNSVTD+28
SAVTWH20 EQU   IEDNSVTD+26
SAVTPWT  EQU   IEDNSVTD+24
SAVTPRTQ EQU   IEDNSVTD+20
SAVTPREQ EQU   IEDNSVTD+16
SAVTPH20 EQU   IEDNSVTD+14
SAVTPUSE EQU   IEDNSVTD+12
SAVTPLCB EQU   IEDNSVTD+8
SAVTPOOL EQU   IEDNSVTD+4
SAVTPRMT EQU   SAVTDIAF
SAVTVIRT EQU   SAVTDIAF
AVTCPBNO EQU   IEDQAVTD+1172
AVTHRESS EQU   IEDQAVTD+1171
@NM00090 EQU   IEDQAVTD+1170
@NM00089 EQU   IEDQAVTD+1169
@NM00088 EQU   IEDQAVTD+1168
@NM00087 EQU   IEDQAVTD+1165
@NM00086 EQU   IEDQAVTD+1164
AVTHRESE EQU   @NM00085
AVTRADDR EQU   IEDQAVTD+1156
AVTNADDR EQU   IEDQAVTD+1152
AVTHRESN EQU   IEDQAVTD+1148
AVTVOLRN EQU   IEDQAVTD+1144
AVTTOTNN EQU   IEDQAVTD+1140
AVTTRCYN EQU   IEDQAVTD+1136
AVTRCTRN EQU   IEDQAVTD+1132
AVTNOVON EQU   IEDQAVTD+1128
AVTADEBN EQU   IEDQAVTD+1124
AVTVOLRR EQU   IEDQAVTD+1120
AVTTOTNR EQU   IEDQAVTD+1116
AVTTRCYR EQU   IEDQAVTD+1112
AVTRCTRR EQU   IEDQAVTD+1108
AVTNOVOR EQU   IEDQAVTD+1104
AVTADEBR EQU   IEDQAVTD+1100
AVTLODPT EQU   IEDQAVTD+1096
AVTIOBN  EQU   IEDQAVTD+1092
AVTIOBR  EQU   IEDQAVTD+1088
AVTCPBPT EQU   IEDQAVTD+1084
AVTFCPB  EQU   IEDQAVTD+1080
@NM00084 EQU   IEDQAVTD+1076
AVTINCPQ EQU   IEDQAVTD+1072
@NM00083 EQU   IEDQAVTD+1068
@NM00082 EQU   IEDQAVTD+1065
@NM00081 EQU   AVTBIT4
@NM00080 EQU   AVTBIT4
@NM00079 EQU   AVTBIT4
@NM00078 EQU   AVTBIT4
@NM00077 EQU   AVTBIT4
@NM00076 EQU   AVTBIT4
@NM00075 EQU   AVTBIT4
AVTRUFTN EQU   AVTBIT4
@NM00074 EQU   IEDQAVTD+1060
AVTNOBFQ EQU   IEDQAVTD+1056
@NM00073 EQU   IEDQAVTD+1052
AVTDKENQ EQU   IEDQAVTD+1048
@NM00072 EQU   IEDQAVTD+1044
AVTDKAPQ EQU   IEDQAVTD+1040
AVTCOPY  EQU   IEDQAVTD+1036
AVTIA    EQU   IEDQAVTD+1032
AVTFL    EQU   IEDQAVTD+1028
@NM00071 EQU   IEDQAVTD+1024
AVTNCPBQ EQU   IEDQAVTD+1020
AVTTOTNC EQU   IEDQAVTD+1016
AVTCMAX  EQU   IEDQAVTD+1012
AVTCMIN  EQU   IEDQAVTD+1008
AVTHM02  EQU   IEDQAVTD+1004
AVTOPCIN EQU   IEDQAVTD+1002
AVTOPMSK EQU   IEDQAVTD+996
AVTOPTN  EQU   IEDQAVTD+984
AVTDSKCT EQU   IEDQAVTD+982
AVTCKRST EQU   IEDQAVTD+981
AVTSTAN  EQU   AVTBIT3
AVTSTACN EQU   AVTBIT3
AVTSTAIN EQU   AVTBIT3
AVTSTAYN EQU   AVTBIT3
AVTOLTBN EQU   AVTBIT3
AVTTSAB  EQU   AVTBIT3
AVTRFULN EQU   AVTBIT3
AVTRECVN EQU   AVTBIT3
@NM00070 EQU   AVTBIT2
@NM00069 EQU   AVTBIT2
AVTOPEIN EQU   AVTBIT2
AVTSTRTN EQU   AVTBIT2
AVTTOPOL EQU   AVTBIT2
AVTCOPYN EQU   AVTBIT2
AVTREUSN EQU   AVTBIT2
AVTEXTSC EQU   AVTBIT2
AVTDISKN EQU   AVTBIT1
AVTQUCKN EQU   AVTBIT1
AVTCLOSN EQU   AVTBIT1
AVTREADN EQU   AVTBIT1
AVTDLAYN EQU   AVTBIT1
AVTAQTAN EQU   AVTBIT1
AVTTSON  EQU   AVTBIT1
AVTAPLKN EQU   AVTBIT1
AVTDUMBR EQU   IEDQAVTD+976
AVTDLQX  EQU   IEDQAVTD+974
AVTINTLV EQU   IEDQAVTD+972
AVTSMCNT EQU   IEDQAVTD+970
AVTAVFCT EQU   IEDQAVTD+968
AVTOPCON EQU   IEDQAVTD+966
AVTOPCNT EQU   IEDQAVTD+964
AVTLNCNT EQU   IEDQAVTD+962
AVTKEYLE EQU   IEDQAVTD+960
AVTHA16  EQU   IEDQAVTD+958
AVTHA7   EQU   IEDQAVTD+956
AVTHA4   EQU   IEDQAVTD+954
AVTHA3   EQU   IEDQAVTD+952
AVTHA2   EQU   IEDQAVTD+950
AVTGETMS EQU   IEDQAVTD+949
@NM00068 EQU   IEDQAVTD+948
AVTGETMD EQU   IEDQAVTD+944
AVTGETMN EQU   IEDQAVTD+940
AVTCWTOT EQU   IEDQAVTD+936
AVTCWINT EQU   IEDQAVTD+884
AVTDTRAP EQU   IEDQAVTD+880
@NM00067 EQU   IEDQAVTD+878
@NM00066 EQU   AVTIOTR
AVTIOTRH EQU   AVTIOTR
AVTIOTRE EQU   AVTIOTR
@NM00065 EQU   AVTSUBT
AVTSUBPT EQU   AVTSUBT
AVTSUBON EQU   AVTSUBT
AVTAFE30 EQU   IEDQAVTD+872
AVTAFE20 EQU   IEDQAVTD+868
AVTAFE10 EQU   IEDQAVTD+864
AVTCWEC2 EQU   IEDQAVTD+860
AVTCWPM2 EQU   IEDQAVTD+856
AVTCWTS2 EQU   IEDQAVTD+855
AVTCWTS1 EQU   IEDQAVTD+854
AVTCWCLD EQU   AVTCWFL2
AVTCWRAP EQU   AVTCWFL2
@NM00064 EQU   AVTCWFL2
@NM00063 EQU   AVTCWFL2
@NM00062 EQU   AVTCWFL2
@NM00061 EQU   AVTCWFL2
@NM00060 EQU   AVTCWFL2
AVTCWACT EQU   AVTCWFL2
@NM00059 EQU   AVTCWFL1
@NM00058 EQU   AVTCWFL1
@NM00057 EQU   AVTCWFL1
@NM00056 EQU   AVTCWFL1
@NM00055 EQU   AVTCWFL1
@NM00054 EQU   AVTCWFL1
@NM00053 EQU   AVTCWFL1
AVTCOMWN EQU   AVTCWFL1
AVTCWEC1 EQU   IEDQAVTD+848
AVTCWPM1 EQU   IEDQAVTD+844
AVTCAREA EQU   IEDQAVTD+840
AVTFZERO EQU   IEDQAVTD+836
AVTCADDR EQU   IEDQAVTD+832
AVTCOREC EQU   IEDQAVTD+828
@NM00052 EQU   IEDQAVTD+820
AVTCPBCB EQU   IEDQAVTD+816
@NM00051 EQU   IEDQAVTD+808
@NM00050 EQU   IEDQAVTD+796
AVTCPRMB EQU   IEDQAVTD+792
@NM00049 EQU   IEDQAVTD+784
AVTCLOSB EQU   IEDQAVTD+780
@NM00048 EQU   IEDQAVTD+772
AVTACTIB EQU   IEDQAVTD+768
@NM00047 EQU   IEDQAVTD+764
AVTOLTEB EQU   IEDQAVTD+760
AVTOLTCH EQU   AVTOLTQB+1
AVTOLTVT EQU   AVTOLTQB
@NM00046 EQU   AVTOPCQB+8
@NM00045 EQU   AVTOPCEC+1
@NM00044 EQU   AVTOPCCC
AVTOPCPO EQU   AVTOPCCC
AVTOPCWA EQU   AVTOPCCC
AVTOPCCH EQU   AVTOPCOB+1
AVTOPCVT EQU   AVTOPCOB
@NM00043 EQU   AVTCKPQB+9
AVTCKPTS EQU   AVTCKPQB+8
@NM00042 EQU   AVTCKPEC+1
@NM00041 EQU   AVTCKPCC
AVTCKPPO EQU   AVTCKPCC
AVTCKPWA EQU   AVTCKPCC
AVTCKPCH EQU   AVTCKPTB+1
AVTCKPVT EQU   AVTCKPTB
@NM00040 EQU   IEDQAVTD+724
@NM00039 EQU   IEDQAVTD+712
AVTTIMQ  EQU   IEDQAVTD+704
@NM00038 EQU   IEDQAVTD+700
AVTIMQPS EQU   IEDQAVTD+696
AVTINOUT EQU   IEDQAVTD+694
AVTREFTM EQU   IEDQAVTD+692
@NM00037 EQU   IEDQAVTD+680
AVTDELYB EQU   IEDQAVTD+676
AVTOCQPT EQU   IEDQAVTD+672
AVTTSOPT EQU   IEDQAVTD+668
AVTSUPPT EQU   IEDQAVTD+664
AVTCBQCB EQU   IEDQAVTD+660
@NM00036 EQU   AVTSYSER
@NM00035 EQU   AVTSYSER
@NM00034 EQU   AVTSYSER
@NM00033 EQU   AVTSYSER
@NM00032 EQU   AVTSYSER
@NM00031 EQU   AVTSYSER
AVTCMAXN EQU   AVTSYSER
AVTCMINN EQU   AVTSYSER
AVT2260L EQU   IEDQAVTD+652
AVTABEPL EQU   AVTADBUF
AVTHFF   EQU   AVTCLRHI+2
@NM00030 EQU   AVTCLRHI
AVTCCLNK EQU   AVTCRELE+5
AVTCCPRI EQU   AVTCRELE+4
AVTCCQCB EQU   AVTCCELE+1
AVTCCKEY EQU   AVTCCELE
AVTDELAD EQU   IEDQAVTD+632
AVTDELEM EQU   IEDQAVTD+628
AVTBSX   EQU   AVTCKLNK
AVTOPETR EQU   AVTHG01
@NM00029 EQU   AVTCKBYT
AVTCKONQ EQU   AVTCKBYT
@NM00028 EQU   AVTCKBYT
@NM00027 EQU   AVTCKBYT
@NM00026 EQU   AVTCKBYT
@NM00025 EQU   AVTCKBYT
@NM00024 EQU   AVTCKBYT
@NM00023 EQU   AVTCKBYT
AVTOPERT EQU   IEDQAVTD+618
AVTOPXCL EQU   IEDQAVTD+616
AVTOPERL EQU   IEDQAVTD+615
@NM00022 EQU   IEDQAVTD+614
AVTCKTIM EQU   IEDQAVTD+612
AVTCKELV EQU   IEDQAVTD+610
AVTCPRCD EQU   IEDQAVTD+609
AVTWARMN EQU   AVTCKELF
AVTCRTLN EQU   AVTCKELF
AVTCPIPN EQU   AVTCKELF
AVTCCLCN EQU   AVTCKELF
AVTCINCN EQU   AVTCKELF
@NM00021 EQU   AVTCKELF
AVTCMCPN EQU   AVTCKELF
AVTNQBCK EQU   AVTCKELF
AVTCKQAD EQU   IEDQAVTD+605
AVTSCBSZ EQU   IEDQAVTD+604
@NM00020 EQU   IEDQAVTD+600
AVTCKELE EQU   IEDQAVTD+596
@NM00019 EQU   AVTCKPEL+8
AVTCKRLK EQU   AVTCKPEL+5
AVTCKRPR EQU   AVTCKPEL+4
AVTCKRMQ EQU   AVTCKRMV+1
AVTCKRKY EQU   AVTCKRMV
AVTHK    EQU   IEDQAVTD+576
AVTHI    EQU   IEDQAVTD+572
AVTIOT   EQU   IEDQAVTD+568
AVTNX    EQU   IEDQAVTD+564
AVTTONE  EQU   IEDQAVTD+560
AVTA3TL  EQU   IEDQAVTD+556
AVTDMECB EQU   IEDQAVTD+552
AVTABEND EQU   IEDQAVTD+546
AVTPLCBN EQU   IEDQAVTD+544
@NM00018 EQU   AVTSAVTP+1
@NM00017 EQU   AVTSAVTF
AVTSNA   EQU   AVTSAVTF
AVTONSNA EQU   AVTSAVTF
AVTVTMCP EQU   AVTSAVTF
@NM00016 EQU   IEDQAVTD+536
AVTCMBSS EQU   IEDQAVTD+532
AVTRCV   EQU   IEDQAVTD+528
AVTSEND  EQU   IEDQAVTD+524
AVTCSCH  EQU   IEDQAVTD+520
AVTQ1    EQU   IEDQAVTD+516
AVTE7    EQU   IEDQAVTD+512
AVTHB    EQU   IEDQAVTD+508
AVTR1    EQU   IEDQAVTD+504
AVTBZ    EQU   IEDQAVTD+500
AVTEZ    EQU   IEDQAVTD+496
AVTEC    EQU   IEDQAVTD+492
AVTEW    EQU   IEDQAVTD+488
AVTNDIAL EQU   AVTSCOPT
AVTN2741 EQU   AVTSCOPT
AVTCONCO EQU   AVTSCOPT
AVTCONC  EQU   AVTSCOPT
AVTCMBUF EQU   AVTSCOPT
AVTAPDMP EQU   AVTSCOPT
@NM00015 EQU   AVTSCOPT
AVTHA    EQU   AVTDISP
AVTEA    EQU   IEDQAVTD+476
AVTAX    EQU   IEDQAVTD+472
AVTA3    EQU   IEDQAVTD+468
AVTGD    EQU   IEDQAVTD+464
AVTAL    EQU   IEDQAVTD+460
AVTOLTST EQU   AVTHG02
AVTE8    EQU   IEDQAVTD+452
AVTUI    EQU   IEDQAVTD+448
AVTCOMPT EQU   IEDQAVTD+444
AVTCRSRF EQU   IEDQAVTD+440
@NM00014 EQU   IEDQAVTD+436
AVTKA02  EQU   IEDQAVTD+432
AVTOPTPT EQU   IEDQAVTD+428
AVTPCBPT EQU   IEDQAVTD+424
@NM00013 EQU   AVTECB1
AVTCOMP  EQU   AVTECB1
@NM00012 EQU   AVTECB1
AVTOPECA EQU   IEDQAVTD+416
AVTOLECA EQU   IEDQAVTD+412
AVTCKECA EQU   IEDQAVTD+408
AVTCWECA EQU   IEDQAVTD+404
AVTCWTCB EQU   IEDQAVTD+400
AVTOLTCB EQU   IEDQAVTD+396
AVTOCTCB EQU   IEDQAVTD+392
AVTCKTCB EQU   IEDQAVTD+388
AVTAS    EQU   IEDQAVTD+384
AVTNOLBF EQU   IEDQAVTD+382
AVTNCKPR EQU   IEDQAVTD+381
AVTCIB   EQU   IEDQAVTD+380
AVTSPLPT EQU   IEDQAVTD+376
AVTMVBFR EQU   IEDQAVTD+372
AVTSBTA  EQU   IEDQAVTD+368
AVTRARTN EQU   IEDQAVTD+364
AVTBSCAN EQU   IEDQAVTD+360
AVTDISTR EQU   IEDQAVTD+348
AVTPARM3 EQU   IEDQAVTD+344
@NM00011 EQU   AVTPKF
@NM00010 EQU   AVTPKF
@NM00009 EQU   AVTPKF
AVTFTCHF EQU   AVTPKF
@NM00008 EQU   AVTPKF
@NM00007 EQU   AVTPKF
@NM00006 EQU   AVTPKF
@NM00005 EQU   AVTPKF
AVTPARM  EQU   IEDQAVTD+336
AVTEXS2A EQU   IEDQAVTD+330
AVTEXA2S EQU   IEDQAVTD+324
AVTOCGET EQU   IEDQAVTD+320
AVTCKAVT EQU   @NM00003+1
@NM00004 EQU   AVTCKFLG
AVTCKHLT EQU   AVTCKFLG
AVTCKREQ EQU   AVTCKFLG
AVTCKENV EQU   AVTCKFLG
AVTCKNAC EQU   AVTCKFLG
AVTCKTAC EQU   AVTCKFLG
@NM00002 EQU   IEDQAVTD+312
AVTREADD EQU   IEDQAVTD+308
AVTREADY EQU   IEDQAVTD+304
AVTRACE  EQU   IEDQAVTD+300
AVTTCB   EQU   IEDQAVTD+296
AVTPASWD EQU   IEDQAVTD+288
AVTCTLCH EQU   IEDQAVTD+280
AVTDOUBL EQU   IEDQAVTD+272
AVTDOUBX EQU   IEDQAVTD+264
AVTDPARM EQU   IEDQAVTD+260
AVTDLQ   EQU   AVTSAVEX+32
@NM00001 EQU   AVTSAVEX
AVTSAVE4 EQU   IEDQAVTD+144
AVTSAVE2 EQU   IEDQAVTD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00573 EQU   @RC00570
@RC00627 EQU   @RC00570
@RC00697 EQU   @RC00692
@RC00708 EQU   @RC00692
@RF00759 EQU   @RC00755
@RC00764 EQU   @RC00755
@RC00778 EQU   @RC00776
@RC00720 EQU   @RC00718
@RC00809 EQU   @RC00804
@RC00827 EQU   @RC00825
@RC00835 EQU   @RC00825
@RC00838 EQU   @RC00825
@RF00865 EQU   @RC00863
@RC00871 EQU   @RC00869
@RC00874 EQU   @RC00869
@RC01030 EQU   @EL00009
@RC01028 EQU   @EL00009
@RF01058 EQU   @RC01053
@RC01075 EQU   @EL00012
@RF01079 EQU   @EL00012
@RF01130 EQU   @EL00016
@RF01157 EQU   @EL00018
@RF01163 EQU   @EL00018
@PB00019 EQU   @EL00001
@RC00578 EQU   @RC00573
@RC00635 EQU   @RC00627
@RC00642 EQU   @RC00627
@RC00724 EQU   @RC00720
@RC00733 EQU   @RC00720
@RC01032 EQU   @RC01030
@PB00018 EQU   @PB00019
@RF00638 EQU   @RC00635
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IEDNKA,(C'PLS1729',0701,77203)

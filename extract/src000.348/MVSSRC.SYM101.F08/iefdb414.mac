         TITLE 'IEFDB414 - BUILD TABLES                                *
                        '
IEFDB414 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(24)                                          01S0001
         DC    C'IEFDB414 78089  UZ17548 '                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @12,0                                            01S0001
@PSTART  LA    @09,4095(,@12)                                   01S0001
         USING @PSTART,@12                                      01S0001
         USING @PSTART+4095,@09                                 01S0001
         L     @00,@SIZDATD                                     01S0001
         GSPACE   R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
         MVC   @PC00001(28),0(@01)                              01S0001
JSCBDISP EQU 188
JSCBAOS1 EQU  72
JSCBAOS2 EQU 192
*                                       USE                          */
*                                                               01S0084
*IF JSCDDNUM<MAXDD THEN                /*NUMBER ALLOC LESS THAN LIMIT*/
         L     @10,@PC00001                                     01S0085
         L     @10,JSCBPTR(,@10)                                01S0085
         LH    @10,JSCDDNUM(,@10)                               01S0085
         C     @10,@CF00092                                     01S0085
         BNL   @RF00085                                         01S0085
*  DO;                                 /*YES,SET UP FOR RECORD ASSIGN*/
*    SWACTLS=SWACTLS && SWACTLS;       /*CLEAR SWA INTERFACE CONTROLS*/
         LH    @10,SWACTLS                                      01S0087
         N     @10,@CF02505                                     01S0087
         LR    @15,@10                                          01S0087
         XR    @15,@10                                          01S0087
         STH   @15,SWACTLS                                      01S0087
*    SWASN=ON;                         /*INDICATE ASSIGN FUNCTION    */
*    SWNEW=ON;                         /*INDICATE TO CREATE EPA'S    */
         OI    SWASN,B'10001000'                                01S0089
*    SWCHN=ON;                         /*INDICATE TO CHAIN EPA'S     */
         OI    SWCHN,B'10000000'                                01S0090
*    NUMRCORD=2;                       /*INDICATE TWO RECORDS        */
         MVC   NUMRCORD(4),@CF00058                             01S0091
*    SMIID(SIOTPOS)=3;                 /*SET SIOT SWA RECORD ID      */
         MVI   SMIID,X'03'                                      01S0092
*    SMIID(JFCBPOS)=28;                /*SET JFCB SWA RECORD ID      */
         MVI   SMIID+4,X'1C'                                    01S0093
*    CALL IEFAB4F7 (SWACTLS,0,LSJXEPAP,ADDR(SMISVAID),          01S0094
*                   ADDR(SMISVAB),RCORDLEN,NUMRCORD); /*SWA INTERFACE
*                                        RTN. TO ASSIGN SIOT AND JFCB*/
         LA    @10,SWACTLS                                      01S0094
         ST    @10,@AL00001                                     01S0094
         LA    @10,@CF00090                                     01S0094
         ST    @10,@AL00001+4                                   01S0094
         L     @10,@PC00001+4                                   01S0094
         ST    @10,@AL00001+8                                   01S0094
         LA    @10,SMISVAID                                     01S0094
         ST    @10,@TF00001                                     01S0094
         LA    @10,@TF00001                                     01S0094
         ST    @10,@AL00001+12                                  01S0094
         LA    @10,SMISVAB                                      01S0094
         ST    @10,@TF00002                                     01S0094
         LA    @10,@TF00002                                     01S0094
         ST    @10,@AL00001+16                                  01S0094
         LA    @10,@CF00102                                     01S0094
         ST    @10,@AL00001+20                                  01S0094
         LA    @10,NUMRCORD                                     01S0094
         ST    @10,@AL00001+24                                  01S0094
         L     @15,@CV00086                                     01S0094
         LA    @01,@AL00001                                     01S0094
         BALR  @14,@15                                          01S0094
*    RFY INDMSIOT BASED(FSIOTPTR);     /*TEMP BASE FOR SIOT MAPPING  */
*    FSIOTPTR=SMISVAB(SIOTPOS);        /*RETURN SIOT PTR TO CALLER   */
         L     @10,@PC00001+12                                  01S0096
         L     @15,SMISVAB                                      01S0096
         ST    @15,FSIOTPTR(,@10)                               01S0096
*    SIOTDSKA=SMISVA(SIOTPOS);         /*SET SIOT SELF SVA           */
         MVC   SIOTDSKA(3,@15),SMISVA                           01S0097
*    SIOTTYPE=3;                       /*SET SIOT RECORD ID          */
         MVI   SIOTTYPE(@15),X'03'                              01S0098
*    SCTPJFCB=SMISVA(JFCBPOS);         /*SET SIOT JFCB SVA           */
         MVC   SCTPJFCB(3,@15),SMISVA+4                         01S0099
*    IF PCATINIT = ON THEN             /*IF PRIVATE CATALOG ALLOC
*                                        TO INITIATOR THEN   @G24LPSJ*/
         L     @10,@PC00001+16                                  01S0100
         TM    PCATINIT(@10),B'01000000'                        01S0100
         BNO   @RF00100                                         01S0100
*       SCTDDINO = 0;                  /*SET DD NUM TO ZERO  @G24LPSJ*/
         SLR   @10,@10                                          01S0101
         STH   @10,SCTDDINO(,@15)                               01S0101
*    ELSE                              /*ELSE                @G24LPSJ*/
*       SCTDDINO = 1;                  /*SET TO ONE          @G24LPSJ*/
         B     @RC00100                                         01S0102
@RF00100 L     @10,@PC00001+12                                  01S0102
         L     @10,FSIOTPTR(,@10)                               01S0102
         MVC   SCTDDINO(2,@10),@CH00072                         01S0102
*    SJFCBPTR=SMISVAB(JFCBPOS);        /*SET SIOT JFCB IN-CORE PTR   */
@RC00100 L     @10,@PC00001+12                                  01S0103
         L     @10,FSIOTPTR(,@10)                               01S0103
         L     @15,SMISVAB+4                                    01S0103
         ST    @15,SJFCBPTR(,@10)                               01S0103
*     DO; /*MODESET  KEYADDR(KEYZERO)*/                         01S0104
*       SPKA (KEYZERO); /*SET PSW KEY*/                         01S0105
         L     @01,KEYZERO                                      01S0105
         SPKA  0(@01)                                           01S0105
*     END; /*MODESET  KEYADDR(KEYZERO)*/       /*CHANGE TO ZERO PROTECT
*KEY  */                                                        01S0106
*    JSCDDNUM=JSCDDNUM+1;              /*UPDATE NUMBER OF ALLOCATIONS*/
         L     @15,@PC00001                                     01S0107
         L     @15,JSCBPTR(,@15)                                01S0107
         LA    @14,1                                            01S0107
         AH    @14,JSCDDNUM(,@15)                               01S0107
         STH   @14,JSCDDNUM(,@15)                               01S0107
*     DO; /*MODESET  EXTKEY(SCHED)*/                            01S0108
*       SPKA (16); /*SET PSW KEY*/                              01S0109
         LA    @01,16                                           01S0109
         SPKA  0(@01)                                           01S0109
*     END; /*MODESET  EXTKEY(SCHED)*/          /*CHANGE BACK TO SCHEDUL
*R KEY*/                                                        01S0110
*    RFY INDMSIOT BASED(SIOTPTR);      /*RESET SIOT MAPPING BASE     */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - TABSETUP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SIOT, JFCB, JFCBX TABLE SET UP                */
*/*                                                                  */
*/* FUNCTION - FILL IN SIOT, JFCB, AND JFCBX'S ACCORDING TO          */
*/*   INFORMATION SPECIFIED IN USER'S TEXT UNITS. SUPPLY DEFAULTS    */
*/*   WHERE APPLICABLE.                                              */
*/*                                                                  */
*/*   OPERATION - THE TIME MACRO IS ISSUED TO OBTAIN THE CURRENT     */
*/*     DATE AND TIME IF A STATUS OF NEW OR MOD IS SPECIFIED,        */
*/*     RETENTION PERIOD IS SPECIFIED, DSNAME IS NOT SPECIFIED,      */
*/*     OR AN &NAME IS SPECIFIED. THE DATE WILL BE USED IF           */
*/*     A DSNAME IS TO BE GENERATED AND FOR THE DATA SET             */
*/*     CREATE DATE AND RETENTION PERIOD. THE TIME IS                */
*/*     USED IN THE GENERATED DSNAME.                                */
*/*                                                                  */
*/*     IF A DDNAME IS SPECIFIED, IT IS PLACED IN THE SIOT.          */
*/*     OTHERWISE, THE DDNAME GENERATION ROUTINE, IEFDB4FD, IS       */
*/*     INVOKED TO GENERATE A DDNAME WHICH IS PLACED IN THE SIOT.    */
*/*                                                                  */
*/*     OTHER TEXT UNITS ARE PROCESSED AS FOLOWS:                    */
*/*       SEGMENT  TEXT UNITS                                        */
*/*       DUMDSN   DUMMY, TERM, QNAME, DSNAME, MEMBER NAME           */
*/*       STATDISP STATUS, NORMAL DISP, CONDITIONAL DISP             */
*/*       SPACE    SPACE RELATED TEXT UNITS                          */
*/*       UNIT     UNIT  RELATED TEXT UNITS                          */
*/*       VOLUME   VOLUME RELATED TEXT UNITS                         */
*/*       SUBSYSOU SYSOUT RELATED TEXT UNITS, SUBSYSTEM TEXT UNIT    */
*/*       LABEL    LABEL TEXT UNITS, INCLUDING EXPIRATION DATE       */
*/*                AND RETENTION PERIOD, CREATE DATE                 */
*/*       FCBUCS   FCB AND UCS TEXT UNITS                            */
*/*       DCB      DCB ATTRIBUTES AND DCB REFERENCE                  */
*/*                                                                  */
*/*     IF THE UNALLOC AT CLOSE TEXT UNIT IS SPECIFIED, THE          */
*/*     APPROPRIATE SIOT INDICATOR IS SET.                           */
*/*                                                                  */
*/*     IF SPECIFIED BY THE USER, SPECIAL BITS ARE SET TO            */
*/*     INDICATE THE DATA SET IS A CATALOG.                          */
*/*                                                                  */
*/*     IF MSVGP IS SPECIFIED AND DUMMY IS NOT SPECIFIED, THE@Y30LPPD*/
*/*     MSVGP NAME IS MOVED INTO THE JFCB, AND BIT JFCBMSGP  @Y30LPPD*/
*/*     IS SET TO INDICATE THAT THE USER SPECIFIED MSVGP. THE@Y30LPPD*/
*/*     THE PRIVATE BIT IS TURNED ON IN THE SIOT.            @Y30LPPD*/
*/*                                                          @Y30LPPD*/
*/* INPUT - KEYTABLE - TO DETERMINE IF TEXT UNIT IS SPECIFIED        */
*/*         ALFNCMAP - TO DETERMINE IF CATALOG DATA SET INDICATORS   */
*/*                    ARE TO BE SET.                                */
*/*                                                                  */
*/* OUTPUT - SIOT, JFCB, AND JFCBX(S) REFLECT USER'S REQUEST         */
*/*                                                                  */
*/********************************************************************/
*KEYTABP = KEYTBPTR;                   /*SET KEY TABLE MAP BASE PTR */
         L     @15,@PC00001+8                                   02S0112
         L     KEYTABP,KEYTBPTR(,@15)                           02S0112
*SIOTPTR = FSIOTPTR;                   /*SET SIOT MAP BASE PTR       */
         LR    SIOTPTR,@10                                      02S0113
*JFCBPTR = SJFCBPTR;                   /*SET JFCB MAP BASE PTR       */
*                                                               02S0114
         L     JFCBPTR,SJFCBPTR(,SIOTPTR)                       02S0114
*IF STATSTUP->TEXTUPAR(1) = NEW        /*NEW SPECIFIED?              */
*  × STATSTUP->TEXTUPAR(1) = MOD       /*OR MOD SPECIFIED?           */
*  × RETPDTUP ^= ZERO                  /*RETENTION PERIOD SPECIFIED? */
*  × DSNAMTUP = ZERO ×                                          02S0115
*    DSNAMTUP->TEXTUPAR(1) = '&'THEN   /*OR WILL GENERATE A DSNAME?  */
         L     @10,STATSTUP(,KEYTABP)                           02S0115
         CLI   TEXTUPAR(@10),X'04'                              02S0115
         BE    @RT00115                                         02S0115
         CLI   TEXTUPAR(@10),X'02'                              02S0115
         BE    @RT00115                                         02S0115
         SLR   @10,@10                                          02S0115
         C     @10,RETPDTUP(,KEYTABP)                           02S0115
         BNE   @RT00115                                         02S0115
         L     @15,DSNAMTUP(,KEYTABP)                           02S0115
         CR    @15,@10                                          02S0115
         BE    @RT00115                                         02S0115
         CLI   TEXTUPAR(@15),C'&&'                              02S0115
         BNE   @RF00115                                         02S0115
@RT00115 DS    0H                                               02S0116
*  DO;                                                          02S0116
*    RFY (R0,R1) RESTRICTED;                                    02S0117
*    GEN ( TIME  DEC)                  /*YES,GET CURRENT DATE & TIME */
*      SETS(R0,R1);                                             02S0118
          TIME  DEC
*    TIME = R0;                        /*SAVE TIME                   */
         STCM  R0,15,TIME                                       02S0119
*    DATE = R1;                        /*SAVE DATE                   */
         STCM  R1,15,DATE                                       02S0120
*    RFY (R0,R1) UNRESTRICTED;                                  02S0121
*  END;                                                         02S0122
*                                                               02S0122
*RFY TEXTUNIT BASED(DDNAMTUP);         /*BASE FOR DDNAME TEXTUNIT    */
@RF00115 DS    0H                                               02S0124
*IF DDNAMTUP ^= ZERO THEN              /*DDNAME SPECIFIED?           */
         L     @10,DDNAMTUP(,KEYTABP)                           02S0124
         LTR   @10,@10                                          02S0124
         BZ    @RF00124                                         02S0124
*  DO;                                                          02S0125
*    SCTDDNAM = '';                    /*YES,BLANK OUT SIOT DDN FIELD*/
         MVI   SCTDDNAM(SIOTPTR),C' '                           02S0126
         MVC   SCTDDNAM+1(7,SIOTPTR),SCTDDNAM(SIOTPTR)          02S0126
*    SCTDDNAM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*PUT DDN IN SIOT  */
         ICM   @15,12,TEXTULNG(@10)                             02S0127
         SRA   @15,16                                           02S0127
         BCTR  @15,0                                            02S0127
         EX    @15,@SM02507                                     02S0127
*  END;                                                         02S0128
*ELSE                                                           02S0129
*  CALL IEFDB4FD (JSCBPTR,ADDR(SCTDDNAM),0); /*GENERATE A DDNAME     */
*                                                               02S0129
         B     @RC00124                                         02S0129
@RF00124 L     @10,@PC00001                                     02S0129
         ST    @10,@AL00001                                     02S0129
         LA    @10,SCTDDNAM(,SIOTPTR)                           02S0129
         ST    @10,@TF00001                                     02S0129
         LA    @10,@TF00001                                     02S0129
         ST    @10,@AL00001+4                                   02S0129
         LA    @10,@CF00090                                     02S0129
         ST    @10,@AL00001+8                                   02S0129
         L     @15,@CV00172                                     02S0129
         LA    @01,@AL00001                                     02S0129
         BALR  @14,@15                                          02S0129
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DUMDSN                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DUMMY, TERM, QNAME, DSNAME AND MEMBER NAME    */
*/*   TEXT UNIT PROCESSING.                                          */
*/*                                                                  */
*/*   OPERATION - THE JFCB DSNAME FIELD AND SIOT ALTERNATE NAME      */
*/*     FIELD ARE INITIALIZED TO BLANKS. IF TERM IS SPECIFIED AND    */
*/*     THE USER IS IN A TSO ENVIRONMENT, THE SIOT TERM AND DUMMY    */
*/*     BITS ARE SET ON, AND NULLFILE IS SET AS THE DSNAME IN THE    */
*/*     JFCB.                                                        */
*/*                                                                  */
*/*     IF TERM IS NOT PROCESSED AND DUMMY IS SPECIFIED, THE SIOT    */
*/*     DUMMY BIT IS SET AND NULLFILE IS SET AS THE DSNAME IN THE    */
*/*     JFCB.                                                        */
*/*                                                                  */
*/*     IF NEITHER TERM NOR DUMMY ARE PROCESSED AND QNAME IS         */
*/*     SPECIFIED, THE SIOT QNAME AND DUMMY INDICATORS ARE SET, AND  */
*/*     THE QNAME IS SET IN THE JFCB.                                */
*/*                                                                  */
*/*     IF NEITHER TERM, NOR DUMMY, NOR QNAME IS SPECIFIED, THEN     */
*/*     IF A NON-&DSNAME IS SPECIFIED, IT IS PLACED IN THE JFCB.     */
*/*     IF THE DSNAME IS NULLFILE, THE SIOT DUMMY BIT IS SET ON. IF  */
*/*     THE DSNAME CONTAINS A PERIOD, THE SIOT QUALIFIED DSNAME      */
*/*     INDICATOR IS SET. IF AN &DSNAME IS SPECIFIED, THE NAME IS    */
*/*     PLACED IN THE SIOT ALTERNATE FIELD AND THE GENDSNAM          */
*/*     SUBROUTINE IS INVOKED TO GENERATE A REAL DSNAME.             */
*/*                                                                  */
*/*     IF NO DSNAME IS SPECIFIED AND SYSOUT IS NOT SPECIFIED,       */
*/*     THE GENERATE DSNAME SUBROUTINE IS INVOKED. (THE SUBSYSTEM    */
*/*     GENERATES DSNAMES FOR SYSOUT DATA SETS.)                     */
*/*                                                                  */
*/*     THE JFCB MEMBER NAME FIELD IS BLANKED. IF A MEMBER NAME IS   */
*/*     SPECIFIED, IT IS FILLED IN.  IF THE FIRST CHARACTER OF THE   */
*/*     MEMBER IS '+', '0', OR '-', THE JFCB GDG SINGLE BIT IS SET.  */
*/*     OTHERWISE THE JFCB  PDS MEMBER INDICATOR IS SET.             */
*/*                                                                  */
*/* INPUT -                                                          */
*/*   KEYTABLE - TO DETERMINE IF TEXT UNITS ARE SPECIFIED.           */
*/*   ASCB - TO DETERMINE IF USER IS A TSO USER                      */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*   SIOT AND JFCB   FILLED IN FOR SPECIFIED TEXT UNITS             */
*/*                                                                  */
*/********************************************************************/
*JFCBDSNM = '';                        /*BLANK JFCB DSNAME FIELD     */
@RC00124 MVI   JFCBDSNM(JFCBPTR),C' '                           03S0130
         MVC   JFCBDSNM+1(43,JFCBPTR),JFCBDSNM(JFCBPTR)         03S0130
*SCTANAME = '';                        /*BLANK SIOT ALT. NAME FIELD  */
         MVI   SCTANAME(SIOTPTR),C' '                           03S0131
         MVC   SCTANAME+1(7,SIOTPTR),SCTANAME(SIOTPTR)          03S0131
*IF (TERMTUP ^= ZERO                   /*TERMINAL SPECIFIED?         */
*    & ASCBTSB ^= ZERO)                /*AND USER IN TSO ENVIRONMENT */
*  × DUMMYTUP ^= ZERO THEN             /*OR DUMMY SPECIFIED?         */
         SLR   @10,@10                                          03S0132
         C     @10,TERMTUP(,KEYTABP)                            03S0132
         BE    @GL00005                                         03S0132
         L     @15,@PC00001                                     03S0132
         L     @01,ASCBPTR(,@15)                                03S0132
         C     @10,ASCBTSB(,@01)                                03S0132
         BNE   @RT00132                                         03S0132
@GL00005 L     @10,DUMMYTUP(,KEYTABP)                           03S0132
         LTR   @10,@10                                          03S0132
         BZ    @RF00132                                         03S0132
@RT00132 DS    0H                                               03S0133
*  DO;                                                          03S0133
*    SCTDUMMY = ON;                    /*YES,SET SIOT DUMMY TYPE BIT */
         OI    SCTDUMMY(SIOTPTR),B'10000000'                    03S0134
*    JFCBDSNM(1:8) = 'NULLFILE';       /*SET NULL DSNAME             */
         MVC   JFCBDSNM(8,JFCBPTR),@CC02430                     03S0135
*    IF (TERMTUP ^= ZERO               /*PROCESSING FOR TERMINAL?    */
*        & ASCBTSB ^= ZERO) THEN       /*NOTE: TERM OVERRIDES DUMMY  */
         SLR   @10,@10                                          03S0136
         C     @10,TERMTUP(,KEYTABP)                            03S0136
         BE    @RF00136                                         03S0136
         L     @15,@PC00001                                     03S0136
         L     @01,ASCBPTR(,@15)                                03S0136
         C     @10,ASCBTSB(,@01)                                03S0136
         BE    @RF00136                                         03S0136
*      SIOTTERM = ON;                  /*YES,SET SIOT TERM INDICATOR */
         OI    SIOTTERM(SIOTPTR),B'01000000'                    03S0137
*  END;                                                         03S0138
*                                                               03S0138
@RF00136 DS    0H                                               03S0139
*RFY TEXTUNIT BASED(QNAMETUP);         /*BASE FOR QNAME TEXTUNIT     */
@RF00132 DS    0H                                               03S0140
*IF QNAMETUP ^= ZERO                   /*QNAME SPECIFIED?            */
*  & SCTDUMMY = OFF THEN               /*AND NOT DUMMY OR TERM?      */
         L     @10,QNAMETUP(,KEYTABP)                           03S0140
         LTR   @10,@10                                          03S0140
         BZ    @RF00140                                         03S0140
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0140
         BNZ   @RF00140                                         03S0140
*  DO;                                                          03S0141
*    JFCBQNAM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,MOVE TO JFCB */
         ICM   @15,12,TEXTULNG(@10)                             03S0142
         SRA   @15,16                                           03S0142
         BCTR  @15,0                                            03S0142
         EX    @15,@SM02510                                     03S0142
*    SIOTQNAM = ON;                    /*SET SIOT QNAME INDICATOR    */
         OI    SIOTQNAM(SIOTPTR),B'00000001'                    03S0143
*    SCTDUMMY = ON;                    /*SET SIOT DUMMY TYPE BIT     */
         OI    SCTDUMMY(SIOTPTR),B'10000000'                    03S0144
*  END;                                                         03S0145
*                                                               03S0145
*RFY TEXTUNIT BASED(DSNAMTUP);         /*BASE FOR DSNAME TEXTUNIT    */
@RF00140 DS    0H                                               03S0147
*IF SCTDUMMY = OFF THEN                /*DUMMY TYPE D.S. SPECIFIED?  */
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0147
         BNZ   @RF00147                                         03S0147
*  IF DSNAMTUP ^= ZERO THEN            /*NO, DSNAME SPECIFIED?       */
         L     @10,DSNAMTUP(,KEYTABP)                           03S0148
         LTR   @10,@10                                          03S0148
         BZ    @RF00148                                         03S0148
*    IF TEXTUPAR(1) ^= '&' THEN        /*YES,IS IT &NAME?            */
         CLI   TEXTUPAR(@10),C'&&'                              03S0149
         BE    @RF00149                                         03S0149
*      DO;                                                      03S0150
*        JFCBDSNM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*NO, JFCB DSN */
         ICM   @15,12,TEXTULNG(@10)                             03S0151
         SRA   @15,16                                           03S0151
         BCTR  @15,0                                            03S0151
         EX    @15,@SM02513                                     03S0151
*        IF JFCBDSNM(1:8) = 'NULLFILE' /*NULLFILE SPECIFIED?         */
*          & JFCBDSNM(9) = ' ' THEN                             03S0152
         CLC   JFCBDSNM(8,JFCBPTR),@CC02430                     03S0152
         BNE   @RF00152                                         03S0152
         CLI   JFCBDSNM+8(JFCBPTR),C' '                         03S0152
         BNE   @RF00152                                         03S0152
*          SCTDUMMY = ON;              /*YES,SIOT DUMMY INDICATOR    */
         OI    SCTDUMMY(SIOTPTR),B'10000000'                    03S0153
*        ELSE                          /*NO,CHECK FOR QUALIFIED DSN  */
*          DO I=1 TO TEXTULNG WHILE(SIOTQDSN=OFF & JFCBDSNM(I)^=' ');
         B     @RC00152                                         03S0154
@RF00152 LA    I,1                                              03S0154
         B     @DE00154                                         03S0154
@DL00154 TM    SIOTQDSN(SIOTPTR),B'00001000'                    03S0154
         BNZ   @DC00154                                         03S0154
         LR    @10,JFCBPTR                                      03S0154
         ALR   @10,I                                            03S0154
         BCTR  @10,0                                            03S0154
         CLI   JFCBDSNM(@10),C' '                               03S0154
         BE    @DC00154                                         03S0154
*            IF JFCBDSNM(I) = '.' THEN /*PERIOD IN DSN=QUALIFIED DSN */
         LR    @10,JFCBPTR                                      03S0155
         ALR   @10,I                                            03S0155
         BCTR  @10,0                                            03S0155
         CLI   JFCBDSNM(@10),C'.'                               03S0155
         BNE   @RF00155                                         03S0155
*              SIOTQDSN = ON;          /*SET SIOT INDICATOR IF QUAL. */
         OI    SIOTQDSN(SIOTPTR),B'00001000'                    03S0156
*          END;                                                 03S0157
@RF00155 AL    I,@CF00072                                       03S0157
@DE00154 L     @10,DSNAMTUP(,KEYTABP)                           03S0157
         ICM   @10,12,TEXTULNG(@10)                             03S0157
         SRA   @10,16                                           03S0157
         CR    I,@10                                            03S0157
         BNH   @DL00154                                         03S0157
@DC00154 DS    0H                                               03S0158
*      END;                                                     03S0158
*    ELSE                              /*& WAS SPECIFIED             */
*      DO;                                                      03S0159
         B     @RC00149                                         03S0159
@RF00149 DS    0H                                               03S0160
*        IF TEXTUPAR(2) = '&' THEN     /*&&NAME SPECIFIED?           */
         L     @10,DSNAMTUP(,KEYTABP)                           03S0160
         CLI   TEXTUPAR+1(@10),C'&&'                            03S0160
         BNE   @RF00160                                         03S0160
*          SCTANAME(1:MIN(TEXTULNG-2,8)) =                      03S0161
*            TEXTUPAR(3:MIN(TEXTULNG-2,8)); /*YES, ALT. NAME TO SIOT */
         ICM   @15,12,TEXTULNG(@10)                             03S0161
         SRA   @15,16                                           03S0161
         BCTR  @15,0                                            03S0161
         BCTR  @15,0                                            03S0161
         LA    @14,8                                            03S0161
         CR    @15,@14                                          03S0161
         BNH   *+6
         LR    @15,@14                                          03S0161
         BCTR  @15,0                                            03S0161
         EX    @15,@SM02516                                     03S0161
*        ELSE                          /*NO,&NAME WAS SPECIFIED      */
*          SCTANAME(1:MIN(TEXTULNG-1,8)) =                      03S0162
*            TEXTUPAR(2:MIN(TEXTULNG-1,8)); /*ALT. NAME TO SIOT      */
         B     @RC00160                                         03S0162
@RF00160 L     @10,DSNAMTUP(,KEYTABP)                           03S0162
         ICM   @15,12,TEXTULNG(@10)                             03S0162
         SRA   @15,16                                           03S0162
         BCTR  @15,0                                            03S0162
         LA    @14,8                                            03S0162
         CR    @15,@14                                          03S0162
         BNH   *+6
         LR    @15,@14                                          03S0162
         BCTR  @15,0                                            03S0162
         EX    @15,@SM02518                                     03S0162
*        CALL GENDSNAM;                /*GENERATE REAL DSNAME IN JFCB*/
@RC00160 BAL   @14,GENDSNAM                                     03S0163
*      END;                                                     03S0164
*  ELSE                                /*DSNAME NOT SPECIFIED?       */
*    IF SYSOUTUP = ZERO THEN           /*SYSOUT NOT SPECIFIED?       */
         B     @RC00148                                         03S0165
@RF00148 L     @10,SYSOUTUP(,KEYTABP)                           03S0165
         LTR   @10,@10                                          03S0165
         BNZ   @RF00165                                         03S0165
*      CALL GENDSNAM;                  /*YES,GENERATE DSNAME         */
         BAL   @14,GENDSNAM                                     03S0166
*    ELSE;                                                      03S0167
@RF00165 DS    0H                                               03S0168
*ELSE;                                 /*DUMMY TYPE D.S. WAS SPEC.   */
*                                                               03S0168
@RF00147 DS    0H                                               03S0169
*RFY TEXTUNIT BASED(MEMBRTUP);         /*BASE FOR MEMBERNAME TEXTUNIT*/
@RC00147 DS    0H                                               03S0170
*JFCBELNM = '';                        /*BLANK JFCB MEMBER NAME FIELD*/
         MVI   JFCBELNM(JFCBPTR),C' '                           03S0170
         MVC   JFCBELNM+1(7,JFCBPTR),JFCBELNM(JFCBPTR)          03S0170
*IF MEMBRTUP ^= ZERO THEN              /*MEMBER NAME SPECIFIED?      */
         L     @10,MEMBRTUP(,KEYTABP)                           03S0171
         LTR   @10,@10                                          03S0171
         BZ    @RF00171                                         03S0171
*  DO;                                                          03S0172
*    JFCBELNM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,NAME TO JFCB */
         ICM   @15,12,TEXTULNG(@10)                             03S0173
         SRA   @15,16                                           03S0173
         BCTR  @15,0                                            03S0173
         EX    @15,@SM02520                                     03S0173
*    IF JFCBELNM(1) = '+'              /*IS A GDG MEMBER SPECIFIED?  */
*      × JFCBELNM(1) = '0'                                      03S0174
*      × JFCBELNM(1) = '-' THEN                                 03S0174
         CLI   JFCBELNM(JFCBPTR),C'+'                           03S0174
         BE    @RT00174                                         03S0174
         CLI   JFCBELNM(JFCBPTR),C'0'                           03S0174
         BE    @RT00174                                         03S0174
         CLI   JFCBELNM(JFCBPTR),C'-'                           03S0174
         BNE   @RF00174                                         03S0174
@RT00174 DS    0H                                               03S0175
*      DO;                             /*SET GDG INDICATOR BITS      */
*        JFCGDG = ON;                  /*SET GDG MEMBER BIT          */
         OI    JFCGDG(JFCBPTR),B'00000010'                      03S0176
*        SCTSGDGS = ON;                /*YES,SET SIOT GDG SINGLE BIT */
         OI    SCTSGDGS(SIOTPTR),B'10000000'                    03S0177
*      END;                            /*END SETTING GDG BITS        */
*    ELSE                                                       03S0179
*      JFCPDS = ON;                    /*NO,SET JFCB PDS MEMBER BIT  */
         B     @RC00174                                         03S0179
@RF00174 OI    JFCPDS(JFCBPTR),B'00000001'                      03S0179
*  END;                                                         03S0180
@RC00174 DS    0H                                               03S0181
*                                                               02S0181
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - STATDISP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - STATUS, NORMAL DISP, AND CONDITIONAL DISP     */
*/*   TEXT UNIT PROCESSING.                                          */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     STATUS IS SET IN THE SIOT AND JFCB AS SPECIFIED              */
*/*     BY THE USER OR DEFAULTED BY ALLOC CONTROL.                   */
*/*                                                                  */
*/*     IF NEITHER DSNAME, NOR OLD OR SHR, NOR DUMMY TYPE DATA SET   */
*/*     IS SPECIFIED, OR IF A &DSNAME IS SPECIFIED, NORMAL AND       */
*/*     CONDITIONAL DISPOSITIONS OF DELETE ARE FORCED, AND THE JFCB  */
*/*     TEMPORARY DATA SET INDICATOR IS SET.                         */
*/*                                                                  */
*/*     OTHERWISE, NORMAL AND CONDITIONAL DISPOSITIONS SPECIFIED     */
*/*     BY THE USER ARE SET. THE JFCB TEMPORARY DATA SET INDICATOR   */
*/*     IS ALSO SET IF NORMAL DISP IS DELETE.                        */
*/*                                                                  */
*/* NOTES -                                                          */
*/*   ALLOC CONTROL DEFAULTS THE NORMAL DISP TEXT UNIT               */
*/*   TO DELETE IF STATUS IS NEW. OTHER DISPOSITION DEFAULTING       */
*/*   IS DONE BY JFCB HOUSEKEEPING.                                  */
*/*                                                                  */
*/* INPUT -                                                          */
*/*   KEYTABLE - TO DETERMINE IF TEXT UNITS ARE SPECIFIED            */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   SIOT AND JFCB   FILLED IN FOR SPECIFIED TEXT UNITS             */
*/*                                                                  */
*/********************************************************************/
*RFY TEXTUNIT BASED(STATSTUP);         /*BASE FOR STATUS TEXTUNIT    */
@RF00171 DS    0H                                               03S0182
*IF TEXTUPAR(1) = NEW THEN             /*NEW SPECIFIED?              */
         L     @10,STATSTUP(,KEYTABP)                           03S0182
         CLI   TEXTUPAR(@10),X'04'                              03S0182
         BNE   @RF00182                                         03S0182
*  DO;                                                          03S0183
*    SCTSNEW = ON;                     /*YES,SET SIOT NEW INDICATOR  */
         OI    SCTSNEW(SIOTPTR),B'00000100'                     03S0184
*    JFCDISP = '11'B;                  /*SET JFCB NEW INDICATOR      */
         OI    JFCDISP(JFCBPTR),B'11000000'                     03S0185
*  END;                                                         03S0186
*ELSE                                  /*NEW NOT SPECIFIED           */
*  IF TEXTUPAR(1) = MOD THEN           /*MOD SPECIFIED?              */
         B     @RC00182                                         03S0187
@RF00182 L     @10,STATSTUP(,KEYTABP)                           03S0187
         CLI   TEXTUPAR(@10),X'02'                              03S0187
         BNE   @RF00187                                         03S0187
*    DO;                                                        03S0188
*      SCTSMOD = ON;                   /*YES,SET SIOT MOD INDICATOR  */
         OI    SCTSMOD(SIOTPTR),B'00000010'                     03S0189
*      JFCDISP = '10'B;                /*SET JFCB MOD INDICATOR      */
         NI    JFCDISP(JFCBPTR),B'10111111'                     03S0190
         OI    JFCDISP(JFCBPTR),B'10000000'                     03S0190
*    END;                                                       03S0191
*  ELSE                                /*NEITHER MOD NOR NEW SPEC    */
*    DO;                                                        03S0192
         B     @RC00187                                         03S0192
@RF00187 DS    0H                                               03S0193
*      SCTSOLD = ON;                   /*SET SIOT OLD INDICATOR      */
         OI    SCTSOLD(SIOTPTR),B'00000001'                     03S0193
*      JFCDISP = '01'B;                /*SET JFCB OLD INDICATOR      */
         NI    JFCDISP(JFCBPTR),B'01111111'                     03S0194
         OI    JFCDISP(JFCBPTR),B'01000000'                     03S0194
*      IF TEXTUPAR(1) = SHR THEN       /*SHR SPECIFIED?              */
         L     @10,STATSTUP(,KEYTABP)                           03S0195
         CLI   TEXTUPAR(@10),X'08'                              03S0195
         BNE   @RF00195                                         03S0195
*        JFCSHARE = ON;                /*YES,SET JFCB SHR INDICATOR  */
         OI    JFCSHARE(JFCBPTR),B'00001000'                    03S0196
*    END;                                                       03S0197
*                                                               03S0197
@RF00195 DS    0H                                               03S0198
*IF (DSNAMTUP = ZERO                   /*DSNAME NOT SPECIFIED?       */
*    & SCTSOLD = OFF                   /*AND OLD OR SHR NOT SPECIFIED*/
*    & SCTDUMMY = OFF)                 /*AND NOT A DUMMY DATA SET?   */
*  × SCTANAME(1) ^=' ' THEN            /*OR &NAME SPECIFIED?         */
@RC00187 DS    0H                                               03S0198
@RC00182 L     @10,DSNAMTUP(,KEYTABP)                           03S0198
         LTR   @10,@10                                          03S0198
         BNZ   @GL00013                                         03S0198
         TM    SCTSOLD(SIOTPTR),B'00000001'                     03S0198
         BNZ   @GL00013                                         03S0198
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0198
         BZ    @RT00198                                         03S0198
@GL00013 CLI   SCTANAME(SIOTPTR),C' '                           03S0198
         BE    @RF00198                                         03S0198
@RT00198 DS    0H                                               03S0199
*  DO;                                                          03S0199
*    SIOTDLET = ON;                    /*FORCE NORMAL DISP OF DELETE */
         OI    SIOTDLET(SIOTPTR),B'00000100'                    03S0200
*    SIOTADEL = ON;                    /*FORCE COND DISP OF DELETE   */
         OI    SIOTADEL(SIOTPTR),B'00000100'                    03S0201
*    JFCTEMP = ON;                     /*INDICATE TEMPORARY DATA SET */
         OI    JFCTEMP(JFCBPTR),B'00000001'                     03S0202
*  END;                                                         03S0203
*ELSE                                  /*NON-&DSNAME, OLD OR SHR, OR */
*  DO;                                 /*DUMMY WAS SPECIFIED         */
         B     @RC00198                                         03S0204
@RF00198 DS    0H                                               03S0205
*    IF NDISPTUP ^= ZERO THEN          /*NORMAL DISP SPECIFIED?      */
         L     @10,NDISPTUP(,KEYTABP)                           03S0205
         LTR   @10,@10                                          03S0205
         BZ    @RF00205                                         03S0205
*      DO;                                                      03S0206
*        SCTSDISP=NDISPTUP->TEXTUPAR(1);/*YES,PUT NORM DISP INTO SIOT*/
         MVC   SCTSDISP(1,SIOTPTR),TEXTUPAR(@10)                03S0207
*        IF SIOTDLET = ON THEN         /*NORMAL DISP OF DELETE?      */
         TM    SIOTDLET(SIOTPTR),B'00000100'                    03S0208
         BNO   @RF00208                                         03S0208
*          JFCTEMP = ON;               /*YES,SET JFCB TEMP D.S. BIT  */
         OI    JFCTEMP(JFCBPTR),B'00000001'                     03S0209
*      END;                                                     03S0210
@RF00208 DS    0H                                               03S0211
*    IF CDISPTUP ^= ZERO THEN          /*CONDITIONAL DISP SPECIFIED? */
@RF00205 L     @10,CDISPTUP(,KEYTABP)                           03S0211
         LTR   @10,@10                                          03S0211
         BZ    @RF00211                                         03S0211
*      SIOTALTD = CDISPTUP->TEXTUPAR(1); /*YES,SET COND. DISP IN SIOT*/
         MVC   SIOTALTD(1,SIOTPTR),TEXTUPAR(@10)                03S0212
*  END;                                                         03S0213
@RF00211 DS    0H                                               03S0214
*                                                               02S0214
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SPACE                                             */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SPACE RELATED TEXT UNIT PROCESSING            */
*/*                                                                  */
*/* FUNCTION - PROCESS TRACK, CYLINDER, BLOCK LENGTH, PRIMARY        */
*/*   QUANTITY, SECONDARY QUANTITY, DIRECTORY, RELEASE UNUSED        */
*/*   SPACE (RLSE), SPACE FORMAT (ALX, CONTIG,MXIG), AND ROUND       */
*/*   TEXT UNITS.                                                    */
*/*                                                                  */
*/*   OPERATION - SET APPROPRIATE INDICATORS IN THE JFCB FOR         */
*/*     SPECIFIED TEXT UNITS.                                        */
*/*                                                                  */
*/* INPUT -                                                          */
*/*   KEYTABLE - TO DETERMINE IF TEXT UNITS ARE SPECIFIED            */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*   JFCB FILLED IN FOR SPECIFIED TEXT UNITS                        */
*/*                                                                  */
*/********************************************************************/
*IF TRKTUP ^= ZERO THEN                /*TRK SPECIFIED?              */
@RC00198 L     @10,TRKTUP(,KEYTABP)                             03S0214
         LTR   @10,@10                                          03S0214
         BZ    @RF00214                                         03S0214
*  JFCBSPAC = '10'B;                   /*YES,SET JFCB TRK INDICATOR  */
         NI    JFCBSPAC(JFCBPTR),B'10111111'                    03S0215
         OI    JFCBSPAC(JFCBPTR),B'10000000'                    03S0215
*ELSE                                                           03S0216
*  IF CYLTUP ^= ZERO THEN              /*NO,CYL SPECIFIED?           */
         B     @RC00214                                         03S0216
@RF00214 L     @10,CYLTUP(,KEYTABP)                             03S0216
         LTR   @10,@10                                          03S0216
         BZ    @RF00216                                         03S0216
*    JFCBSPAC = '11'B;                 /*YES,SET JFCB CYL INDICATOR  */
         OI    JFCBSPAC(JFCBPTR),B'11000000'                    03S0217
*  ELSE                                                         03S0218
*    IF BLKLNTUP ^= ZERO THEN          /*NO,BLOCK LENGTH SPECIFIED?  */
         B     @RC00216                                         03S0218
@RF00216 L     @10,BLKLNTUP(,KEYTABP)                           03S0218
         LTR   @10,@10                                          03S0218
         BZ    @RF00218                                         03S0218
*      DO;                                                      03S0219
*        JFCBSPAC = '01'B;             /*YES,SET JFCB BLOCK INDICATOR*/
         NI    JFCBSPAC(JFCBPTR),B'01111111'                    03S0220
         OI    JFCBSPAC(JFCBPTR),B'01000000'                    03S0220
*        JFCBDRLH = BLKLNTUP->TEXTUPAR(1:3); /*MOVE BLOCK LEN TO JFCB*/
         MVC   JFCBDRLH(3,JFCBPTR),TEXTUPAR(@10)                03S0221
*      END;                                                     03S0222
*                                                               03S0222
*IF PRIMETUP ^= ZERO THEN              /*PRIMARY SPACE SPECIFIED?    */
@RF00218 DS    0H                                               03S0223
@RC00216 DS    0H                                               03S0223
@RC00214 L     @10,PRIMETUP(,KEYTABP)                           03S0223
         LTR   @10,@10                                          03S0223
         BZ    @RF00223                                         03S0223
*  JFCBPQTY = PRIMETUP->TEXTUPAR(1:3); /*YES,MOVE PRIMARY TO JFCB    */
*                                                               03S0224
         MVC   JFCBPQTY(3,JFCBPTR),TEXTUPAR(@10)                03S0224
*IF SECNDTUP ^= ZERO THEN              /*SECONDARY SPACE SPECIFIED?  */
@RF00223 L     @10,SECNDTUP(,KEYTABP)                           03S0225
         LTR   @10,@10                                          03S0225
         BZ    @RF00225                                         03S0225
*  JFCBSQTY = SECNDTUP->TEXTUPAR(1:3); /*YES,MOVE SECONDARY TO JFCB  */
*                                                               03S0226
         MVC   JFCBSQTY(3,JFCBPTR),TEXTUPAR(@10)                03S0226
*IF DIRTUP ^= ZERO THEN                /*DIRECTORY SPACE SPECIFIED?  */
@RF00225 L     @10,DIRTUP(,KEYTABP)                             03S0227
         LTR   @10,@10                                          03S0227
         BZ    @RF00227                                         03S0227
*  JFCBDQTY = DIRTUP->TEXTUPAR(1:3);   /*YES,MOVE DIRECTORY TO JFCB  */
*                                                               03S0228
         MVC   JFCBDQTY(3,JFCBPTR),TEXTUPAR(@10)                03S0228
*IF RLSETUP ^= ZERO THEN               /*RELEASE UNUSED SPACE SPEC.? */
@RF00227 L     @10,RLSETUP(,KEYTABP)                            03S0229
         LTR   @10,@10                                          03S0229
         BZ    @RF00229                                         03S0229
*  JFCRLSE = RLSE;                     /*YES,SET JFCB RLSE INDICATOR */
*                                                               03S0230
         OI    JFCRLSE(JFCBPTR),B'11000000'                     03S0230
*IF SPFRMTUP ^= ZERO THEN              /*SPACE FORMAT SPECIFIED?     */
@RF00229 L     @10,SPFRMTUP(,KEYTABP)                           03S0231
         LTR   @10,@10                                          03S0231
         BZ    @RF00231                                         03S0231
*  JFCBCTRI = JFCBCTRI × SPFRMTUP->TEXTUPAR(1); /*YES,SET MXIG, ALX,
*                                        OR CONTIG INDICATOR IN JFCB */
*                                                               03S0232
         OC    JFCBCTRI(1,JFCBPTR),TEXTUPAR(@10)                03S0232
*IF ROUNDTUP ^= ZERO THEN              /*ROUND SPECIFIED?            */
@RF00231 L     @10,ROUNDTUP(,KEYTABP)                           03S0233
         LTR   @10,@10                                          03S0233
         BZ    @RF00233                                         03S0233
*  JFCROUND = ON;                      /*YES,SET JFCB ROUND INDICATOR*/
         OI    JFCROUND(JFCBPTR),B'00000001'                    03S0234
*                                                               02S0235
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UNIT                                              */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UNIT RELATED TEXT UNIT PROCESSING             */
*/*                                                                  */
*/* FUNCTION - PROCESS UNIT NAME, UNIT COUNT, AND PARALLEL MOUNT     */
*/*   TEXT UNITS.                                                    */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE SIOT UNIT TYPE FIELD IS FILLED IN WITH EITHER            */
*/*     THE SPECIFIED UNIT NAME, OR IF NONE,                         */
*/*     THE UNIT NAME FROM THE USER'S PROFILE, OR IF NONE, WITH A    */
*/*     DEFAULT FROM THE ALLOCATION DEFAULT MODULE, IEFAB445.        */
*/*     NOTE: TO SUPPORT CHECKPOINT RESTART PROCESSING, A    @YM07317*/
*/*           SPECIFIED UNIT NAME MAY BE A GENERIC DEVICE    @YM07317*/
*/*           TYPE, WITH OR WITHOUT A UCB ADDRESS. THE CASE  @YM07317*/
*/*           WHERE THE UCB ADDRESS IS GIVEN IMPLIES A VIO   @YM07317*/
*/*           DATA SET, AND APPROPRIATE FIELDS IN THE SIOT   @YM08189*/
*/*           AND JFCB MUST BE SET.                          @YM07317*/
*/*                                                                  */
*/*     IF A UNIT COUNT OF OTHER THAN ZERO IS SPECIFIED, IT IS SET IN*/
*/*     THE SIOT UNIT COUNT FIELD. IF NOT, A DEFAULT OF ONE IS SET.  */
*/*                                                                  */
*/*     IF PARALLEL MOUNT IS SPECIFIED, THE APPROPIATE SIOT INDICATOR*/
*/*     IS SET. (NOTE: PARALLEL MOUNT IS MUTUALLY EXCLUSIVE WITH     */
*/*     UNIT COUNT.)                                                 */
*/*                                                                  */
*/* INPUT -                                                          */
*/*   JSCB - PTR TO PSCB                                             */
*/*   PSCB - UNIT NAME DEFAULT(FROM USER'S PROFILE)                  */
*/*   KEYTABLE - DETERMINE WHICH TEXT UNITS ARE SPECIFIED            */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*   SIOT FILLED IN FOR SPECIFIED TEXT UNITS.                       */
*/*                                                                  */
*/* EXTERNAL REFERENCES                                              */
*/*   IEFAB445 - ALLOCATION DEFAULTS CSECT                           */
*/*                                                                  */
*/********************************************************************/
*IF SCTDUMMY = OFF THEN                /*DUMMY TYPE DATA SET?        */
@RF00233 TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0235
         BNZ   @RF00235                                         03S0235
*  DO;                                 /*NO,PROCESS UNIT PARAMETERS  */
*    RFY TEXTUNIT BASED(UNITTUP);      /*BASE FOR UNIT TEXTUNIT      */
*    IF UNITTUP ^= ZERO THEN           /*UNIT NAME SPECIFIED?        */
         L     @10,UNITTUP(,KEYTABP)                            03S0238
         LTR   @10,@10                                          03S0238
         BZ    @RF00238                                         03S0238
*      IF UNITDEVT = ON THEN           /*NAME A DEV TYPE     @YM07317*/
         L     @15,@PC00001+16                                  03S0239
         TM    UNITDEVT(@15),B'10000000'                        03S0239
         BNO   @RF00239                                         03S0239
*        DO;                           /*                    @YM07317*/
*          SCTUTYPE = SCTUTYPE && SCTUTYPE; /*ZERO UNIT FIELD@YM07317*/
         XC    SCTUTYPE(8,SIOTPTR),SCTUTYPE(SIOTPTR)            03S0241
*          SCTUTYPE(1:TEXTULNG)=TEXTUPAR(1:TEXTULNG); /*MOVE NAME
*                                        TO SIOT             @YM07317*/
         ICM   @15,12,TEXTULNG(@10)                             03S0242
         SRA   @15,16                                           03S0242
         BCTR  @15,0                                            03S0242
         EX    @15,@SM02527                                     03S0242
*          IF SIOUCBAD ^= ZERO THEN    /*NON-ZERO UCB ADDR   @YM07317*/
         L     @10,SIOUCBAD-1(,SIOTPTR)                         03S0243
         LA    @10,0(,@10)                                      03S0243
         LTR   @10,@10                                          03S0243
         BZ    @RF00243                                         03S0243
*            DO;                       /*IMPLIES VIO D.S.    @YM07317*/
*              SIOVAMDS = ON;          /*SET ON VIO IN SIOT  @YM07317*/
         OI    SIOVAMDS(SIOTPTR),B'00100000'                    03S0245
*              JFCVRDS = ON;           /*SET ON VIO IN JFCB  @YM07317*/
         OI    JFCVRDS(JFCBPTR),B'00000100'                     03S0246
*              SCTVOLCT=1;             /* ONE VOLUME FOR VIO @YM08189*/
         MVI   SCTVOLCT(SIOTPTR),X'01'                          03S0247
*              JFCBNVOL=1;             /* DATA SETS.         @YM08189*/
         MVI   JFCBNVOL(JFCBPTR),X'01'                          03S0248
*            END;                      /*                    @YM07317*/
*        END;                          /*                    @YM07317*/
*      ELSE                            /*EBCIDIC UNIT NAME   @YM07317*/
*        DO;                                                    03S0251
         B     @RC00239                                         03S0251
@RF00239 DS    0H                                               03S0252
*          SCTUTYPE = '';              /*BLANK SIOT UNIT FIELD       */
         MVI   SCTUTYPE(SIOTPTR),C' '                           03S0252
         MVC   SCTUTYPE+1(7,SIOTPTR),SCTUTYPE(SIOTPTR)          03S0252
*          SCTUTYPE(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*MOVE UNIT
*                                                  NAME TO SIOT      */
         L     @10,UNITTUP(,KEYTABP)                            03S0253
         ICM   @15,12,TEXTULNG(@10)                             03S0253
         SRA   @15,16                                           03S0253
         BCTR  @15,0                                            03S0253
         EX    @15,@SM02527                                     03S0253
*        END;                                                   03S0254
*    ELSE                              /*UNIT NOT SPECIFIED          */
*      IF JSCBPSCB ^= ZERO & PSCBGPNM(1) ^= ' ' THEN            03S0255
         B     @RC00238                                         03S0255
@RF00238 L     @10,@PC00001                                     03S0255
         L     @10,JSCBPTR(,@10)                                03S0255
         L     @10,JSCBPSCB(,@10)                               03S0255
         LTR   @10,@10                                          03S0255
         BZ    @RF00255                                         03S0255
         CLI   PSCBGPNM(@10),C' '                               03S0255
         BE    @RF00255                                         03S0255
*                                      /*USER PROFILE UNIT NAME EXIST*/
*        SCTUTYPE = PSCBGPNM;          /*YES,SET SIOT UNIT FROM PROF.*/
         MVC   SCTUTYPE(8,SIOTPTR),PSCBGPNM(@10)                03S0256
*      ELSE                                                     03S0257
*        SCTUTYPE = DEFUNIT;           /*NO,DEFAULT UNIT TO SIOT     */
*                                                               03S0257
         B     @RC00255                                         03S0257
@RF00255 L     @10,@CA01813                                     03S0257
         MVC   SCTUTYPE(8,SIOTPTR),DEFUNIT-IEFAB445(@10)        03S0257
*    RFY TEXTUNIT BASED(UNCNTTUP);     /*BASE FOR UNIT COUNT TEXTUNIT*/
@RC00255 DS    0H                                               03S0258
@RC00238 DS    0H                                               03S0259
*    IF UNCNTTUP^=ZERO & TEXTUPAR(1)^=ZERO THEN /*UNIT COUNT SPECIF'D*/
         SLR   @10,@10                                          03S0259
         L     @15,UNCNTTUP(,KEYTABP)                           03S0259
         CR    @15,@10                                          03S0259
         BE    @RF00259                                         03S0259
         SLR   @14,@14                                          03S0259
         IC    @14,TEXTUPAR(,@15)                               03S0259
         CR    @10,@14                                          03S0259
         BE    @RF00259                                         03S0259
*      SCTNMBUT = TEXTUPAR(1);         /*YES,SET UNIT COUNT IN SIOT  */
         MVC   SCTNMBUT(1,SIOTPTR),TEXTUPAR(@15)                03S0260
*    ELSE                              /*NO,UNIT COUNT NOT SPECIFIED */
*      DO;                                                      03S0261
         B     @RC00259                                         03S0261
@RF00259 DS    0H                                               03S0262
*        SCTNMBUT = 1;                 /*DEFAULT UNIT COUNT          */
         MVI   SCTNMBUT(SIOTPTR),X'01'                          03S0262
*        IF PARALTUP ^= ZERO THEN      /*PARALLEL MOUNT SPECIFIED?   */
         L     @10,PARALTUP(,KEYTABP)                           03S0263
         LTR   @10,@10                                          03S0263
         BZ    @RF00263                                         03S0263
*          SCTPARLM = ON;              /*YES,SET SIOT INDICATOR      */
         OI    SCTPARLM(SIOTPTR),B'00000100'                    03S0264
*      END;                                                     03S0265
@RF00263 DS    0H                                               03S0266
*  END;                                                         03S0266
@RC00259 DS    0H                                               03S0267
*                                                               02S0267
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - VOLUME                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - VOLUME RELATED TEXT UNIT PROCESSING           */
*/*                                                                  */
*/* FUNCTION - PROCESS PRIVATE VOLUME, VOLUME SEQUENCE, VOLUME       */
*/*   COUNT, VOLUME SERIAL, AND VOLUME REFERENCE TEXT UNITS.         */
*/*   ASSIGN AND SET UP JFCBX'S AS REQUIRED                          */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE JFCB VOLUME SERIAL FIELD IS INITIALIZED TO BLANKS.       */
*/*     NO FURTHER PROCESSING IS DONE FOR DUMMY TYPE DATA SETS.      */
*/*     FOR NON-DUMMY TYPE DATA SETS, PRIVATE AND VOLUME SEQUENCE    */
*/*     NUMBER INDICATIONS ARE SET IF SPECIFIED. VOLUME COUNT IS SET */
*/*     IF SPECIFIED AND NOT ZERO. OTHERWISE A DEFAULT OF ONE IS SET.*/
*/*     REQUIRED JFCBX ARE ASSIGNED (SEE ASNJFCBX SEGMENT).          */
*/*     SPECIFIED VOLUME SERIALS ARE PLACED IN THE JFCB AND JFCBX(S).*/
*/*     IF VOLUME REFERENCE TO A DSNAME IS SPECIFIED, THE DSNAME     */
*/*     TABLE IS UPDATED (SEE DSNTPROC SEGMENT) AND SIOT INDICATORS  */
*/*     ARE SET. (THE DSNAME REFERENCE WILL BE RESOLVED BY JFCB      */
*/*     HOUSEKEEPING.)                                               */
*/*                                                                  */
*/* INPUT                                                            */
*/*   KEYTABLE - DETERMINE WHICH TEXT UNITS ARE SPECIFIED.           */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   SIOT,JFCB,AND JFCBX FILLED IN FOR SPECIFIED TEXT UNITS         */
*/*   DSNT - UPDATED IF VOL REF TO A DSN IS SPECIFIED.               */
*/*                                                                  */
*/********************************************************************/
*JFCBVOLS = '';                        /*BLANK JFCB VOL SER FIELDS   */
@RF00235 MVI   JFCBVOLS(JFCBPTR),C' '                           03S0267
         MVC   JFCBVOLS+1(29,JFCBPTR),JFCBVOLS(JFCBPTR)         03S0267
*IF SCTDUMMY = OFF THEN                /*NOT A DUMMY DATA SET?       */
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0268
         BNZ   @RF00268                                         03S0268
*  DO;                                                          03S0269
*    IF PRIVTTUP ^= ZERO THEN          /*PRIVATE VOLUME SPECIFIED?   */
         L     @10,PRIVTTUP(,KEYTABP)                           03S0270
         LTR   @10,@10                                          03S0270
         BZ    @RF00270                                         03S0270
*      SIOTPRIV = ON;                  /*YES,SET SIOT INDICATOR      */
*                                                               03S0271
         OI    SIOTPRIV(SIOTPTR),B'00100000'                    03S0271
*    IF VLSEQTUP ^= ZERO THEN          /*VOLUME SEQUENCE SPECIFIED   */
@RF00270 L     @10,VLSEQTUP(,KEYTABP)                           03S0272
         LTR   @10,@10                                          03S0272
         BZ    @RF00272                                         03S0272
*      JFCBVLSQ = VLSEQTUP->TEXTUPAR(1:2); /*YES,SET JFCB INDICATOR  */
*                                                               03S0273
         MVC   JFCBVLSQ(2,JFCBPTR),TEXTUPAR(@10)                03S0273
*    RFY TEXTUNIT BASED(VLCNTTUP);     /*BASE FOR VOLUME COUNT TEXTU.*/
@RF00272 DS    0H                                               03S0275
*    IF VLCNTTUP^=ZERO                 /*VOLUME COUNT SPECIFIED?     */
*      & TEXTUPAR(1)^=ZERO THEN        /*AND COUNT NOT ZERO?         */
         SLR   @10,@10                                          03S0275
         L     @15,VLCNTTUP(,KEYTABP)                           03S0275
         CR    @15,@10                                          03S0275
         BE    @RF00275                                         03S0275
         SLR   @14,@14                                          03S0275
         IC    @14,TEXTUPAR(,@15)                               03S0275
         CR    @10,@14                                          03S0275
         BE    @RF00275                                         03S0275
*      SIOTVLCT = TEXTUPAR(1);         /*YES,SET SIOT VOLUME COUNT   */
         MVC   SIOTVLCT(1,SIOTPTR),TEXTUPAR(@15)                03S0276
*    ELSE                                                       03S0277
*      SIOTVLCT = 1;                   /*DEFAULT VOL COUNT           */
         B     @RC00275                                         03S0277
@RF00275 MVI   SIOTVLCT(SIOTPTR),X'01'                          03S0277
*    JFCBVLCT = SIOTVLCT;              /*SET JFCB VOLUME COUNT FIELD */
*                                                               03S0278
@RC00275 MVC   JFCBVLCT(1,JFCBPTR),SIOTVLCT(SIOTPTR)            03S0278
*    RFY TEXTUNIT BASED(VLSERTUP);     /*BASE FOR VOL SERIAL TEXTUNIT*/
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - ASNJFCBX                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - ASSIGN JFCBXS                                 */
*/*                                                                  */
*/* FUNCTION - ASSIGN AND CHAIN JFCBXS                               */
*/*                                                                  */
*/*   OPERATION - THE MAXIMUM OF THE UNIT COUNT, VOLUME COUNT, AND   */
*/*     NUMBER OF VOLUME SERIALS IS DETERMINED.   THIS NUMBER        */
*/*     LESS 5 (FOR VOLUME SERIALS IN JFCB) IS THE NUMBER OF JFCBX   */
*/*     VOLUME SLOTS REQUIRED. A JFCBX IS ASSIGNED FOR EACH 15       */
*/*     OF THESE SLOTS, PLUS AN ADDITIONAL JFCBX FOR THE REMAINDER,  */
*/*     IF ANY. THE SWA MANAGER INTERFACE ROUTINE, IEFAB4F7, IS      */
*/*     INVOKED FOR THE ASSIGNS. THE SIOT IS UPDATED WITH THE        */
*/*     IN-CORE ADDRESS OF THE FIRST ASSIGNED JFCBX, AND THE         */
*/*     SVA OF THIS RECORD IS SET IN THE JFCB. EACH RECORD IS        */
*/*     INITIALIZED BY BLANKING OUT THE VOLUME SLOTS, AND BY SETTING */
*/*     THE IN-CORE ADDRESS AND SVA OF THE NEXT JFCBX RECORD, IF ANY.*/
*/*                                                                  */
*/* INPUT                                                            */
*/*   SIOT UNIT COUNT                                                */
*/*   SIOT VOLUME COUNT                                              */
*/*   VOL SER TEXT UNIT                                              */
*/*   SWACTLS - SWA MGR INTERFACE RTN, CONTROLS, SET UP BY CONTROL   */
*/*     ROUTINE                                                      */
*/*   LSJXEPAP - POINTER TO LAST EPA FOR ASSIGNED SIOT'S JFCB'S,     */
*/*     AND JFCBX'S.                                                 */
*/*                                                                  */
*/* OUTPUT -                                                         */
*/*   SIOT - SIOTJFX CONTAINS IN-CORE ADDRESS OF FIRST JFCBX         */
*/*   JFCB - JFCBEXAD CONTAINS SVA OF FIRST JFCBX, VOL SERS FILLED IN*/
*/*   JFCBX'S - CHAINED AND FILLED IN                                */
*/*   NUMJFCBX - NUMBER OF ASSIGNED JFCBX'S (FOR VOLUME SEGMENT)     */
*/*                                                                  */
*/********************************************************************/
*NUMJFCBX = MAX(SCTNMBUT,SIOTVLCT);    /*WORK AREA FOR # OF VOL SER'S,
*                                        FROM WHICH # OF JFCBX'S
*                                        NEEDED WILL BE CALCULATED.
*                                        NOW EQUAL GREATER OF UNIT
*                                        COUNT AND VOLUME COUNT.     */
         SLR   NUMJFCBX,NUMJFCBX                                04S0280
         IC    NUMJFCBX,SCTNMBUT(,SIOTPTR)                      04S0280
         SLR   @10,@10                                          04S0280
         IC    @10,SIOTVLCT(,SIOTPTR)                           04S0280
         CR    NUMJFCBX,@10                                     04S0280
         BNL   *+6
         LR    NUMJFCBX,@10                                     04S0280
*IF VLSERTUP^=ZERO THEN                /*YES,VOL SERS SPECIFIED?     */
         L     @10,VLSERTUP(,KEYTABP)                           04S0281
         LTR   @10,@10                                          04S0281
         BZ    @RF00281                                         04S0281
*  NUMJFCBX = MAX(TEXTUNUM,NUMJFCBX);  /*YES,UPDATE WORK COUNT IF >
*                                        UNIT COUNT AND VOLUME COUNT */
         ICM   @10,12,TEXTUNUM(@10)                             04S0282
         SRA   @10,16                                           04S0282
         CR    NUMJFCBX,@10                                     04S0282
         BNL   *+6
         LR    NUMJFCBX,@10                                     04S0282
*NUMJFCBX = NUMJFCBX - 5;              /*LESS # JFCB SER=# JFCBX SER */
@RF00281 SL    NUMJFCBX,@CF00117                                04S0283
*IF NUMJFCBX > ZERO THEN               /*JFCBX REQUIRED?             */
         LTR   NUMJFCBX,NUMJFCBX                                04S0284
         BNP   @RF00284                                         04S0284
*  DO;                                 /*YES,CALCULATE # REQUIRED    */
*    NUMJFCBX = NUMJFCBX / 15          /*ONE JFCBX PER 15 VOL SERS   */
*      + MIN(1, NUMJFCBX//15 );        /*PLUS 1 JFCBX IF ANY REMAINDR*/
         LA    @10,15                                           04S0286
         LR    @00,NUMJFCBX                                     04S0286
         SRDA  @00,32                                           04S0286
         DR    @00,@10                                          04S0286
         LA    @02,1                                            04S0286
         LR    @04,NUMJFCBX                                     04S0286
         SRDA  @04,32                                           04S0286
         DR    @04,@10                                          04S0286
         CR    @04,@02                                          04S0286
         BNH   *+6
         LR    @04,@02                                          04S0286
         ALR   @01,@04                                          04S0286
         LR    NUMJFCBX,@01                                     04S0286
*    DO I=1 TO NUMJFCBX;               /*LOOP FOR EACH JFCBX NEEDED  */
         LA    @10,1                                            04S0287
         LR    I,@10                                            04S0287
         B     @DE00287                                         04S0287
@DL00287 DS    0H                                               04S0288
*      SMIID(I) = JFCBXID;             /*JFCBX TABLE ID IN SMI PARMS */
         LR    @10,I                                            04S0288
         SLA   @10,2                                            04S0288
         LA    @01,SMIID-4(@10)                                 04S0288
         MVI   0(@01),X'1D'                                     04S0288
*    END;                                                       04S0289
         AL    I,@CF00072                                       04S0289
@DE00287 CR    I,NUMJFCBX                                       04S0289
         BNH   @DL00287                                         04S0289
*    NUMRCORD = NUMJFCBX;              /*NUMBER OF RECORDS TO ASSIGN */
         ST    NUMJFCBX,NUMRCORD                                04S0290
*    CALL IEFAB4F7 (SWACTLS,0,LSJXEPAP,ADDR(SMISVAID),          04S0291
*                   ADDR(SMISVAB),RCORDLEN,NUMRCORD); /*ASSIGN FOR
*                                        JFCBX VIA SWA MANAGER  04S0291
*                                        INTERFACE ROUTINE           */
         LA    @02,SWACTLS                                      04S0291
         ST    @02,@AL00001                                     04S0291
         LA    @02,@CF00090                                     04S0291
         ST    @02,@AL00001+4                                   04S0291
         L     @02,@PC00001+4                                   04S0291
         ST    @02,@AL00001+8                                   04S0291
         LA    @02,SMISVAID                                     04S0291
         ST    @02,@TF00001                                     04S0291
         LA    @02,@TF00001                                     04S0291
         ST    @02,@AL00001+12                                  04S0291
         LA    @02,SMISVAB                                      04S0291
         ST    @02,@TF00002                                     04S0291
         LA    @02,@TF00002                                     04S0291
         ST    @02,@AL00001+16                                  04S0291
         LA    @02,@CF00102                                     04S0291
         ST    @02,@AL00001+20                                  04S0291
         LA    @02,NUMRCORD                                     04S0291
         ST    @02,@AL00001+24                                  04S0291
         L     @15,@CV00086                                     04S0291
         LA    @01,@AL00001                                     04S0291
         BALR  @14,@15                                          04S0291
*    JFCBXPTR = SMISVAB(1);            /*INIT JFCBX MAP BASE         */
         L     @02,SMISVAB                                      04S0292
         LR    JFCBXPTR,@02                                     04S0292
*    SIOTJFX = SMISVAB(1);             /*SET SIOT JFCBX CORE PTR     */
         ST    @02,SIOTJFX(,SIOTPTR)                            04S0293
*    JFCBEXAD = SMISVA(1);             /*SET JFCB JFCBX SVA          */
         MVC   JFCBEXAD(3,JFCBPTR),SMISVA                       04S0294
*    DO I=1 TO NUMJFCBX;               /*LOOP FOR EACH JFCBX         */
         LA    I,1                                              04S0295
         B     @DE00295                                         04S0295
@DL00295 DS    0H                                               04S0296
*      JXVOLSER = '';                  /*BLANK JFCBX VOL SER FIELDS  */
         MVI   JXVOLSER(JFCBXPTR),C' '                          04S0296
         MVC   JXVOLSER+1(89,JFCBXPTR),JXVOLSER(JFCBXPTR)       04S0296
*      IF I < NUMJFCBX THEN            /*LAST JFCBX?                 */
         CR    I,NUMJFCBX                                       04S0297
         BNL   @RF00297                                         04S0297
*        DO;                                                    04S0298
*          JFCBXTTR = SMISVA(I+1);     /*NO,SET SVA OF NEXT JFCBX    */
         LR    @15,I                                            04S0299
         SLA   @15,2                                            04S0299
         LA    @14,SMISVA(@15)                                  04S0299
         MVC   JFCBXTTR(3,JFCBXPTR),0(@14)                      04S0299
*          JFCBXNXT = SMISVAB(I+1);    /*SET NEXT JFCBX IN-CORE PTR  */
         L     @15,SMISVAB(@15)                                 04S0300
         ST    @15,JFCBXNXT(,JFCBXPTR)                          04S0300
*          JFCBXPTR = JFCBXNXT;        /*SET MAP BASE TO NEXT JFCBX  */
         LR    JFCBXPTR,@15                                     04S0301
*        END;                                                   04S0302
*    END;                                                       04S0303
@RF00297 AL    I,@CF00072                                       04S0303
@DE00295 CR    I,NUMJFCBX                                       04S0303
         BNH   @DL00295                                         04S0303
*  END;                                /*END JFCBX REQUIRED PROCESS  */
*                                                               04S0304
*                                                               03S0305
*    IF VLSERTUP ^= ZERO THEN          /*VOLUME SERIALS SPECIFIED?   */
@RF00284 L     @10,VLSERTUP(,KEYTABP)                           03S0305
         LTR   @10,@10                                          03S0305
         BZ    @RF00305                                         03S0305
*      DO;                                                      03S0306
*        SCTVOLCT = TEXTUNUM;          /*YES,SET SIOT # OF VOL SERS  */
         ICM   @02,12,TEXTUNUM(@10)                             03S0307
         SRA   @02,16                                           03S0307
         STC   @02,SCTVOLCT(,SIOTPTR)                           03S0307
*        JFCBNVOL = TEXTUNUM;          /*SET JFCB # OF VOL SERS      */
         STC   @02,JFCBNVOL(,JFCBPTR)                           03S0308
*        NUMVOLS = TEXTUNUM;           /*SET WORK COUNT OF VOL SERS  */
         LR    NUMVOLS,@02                                      03S0309
*        TXTUFLDP = ADDR(TEXTUENT);    /*INIT PTR TO SCAN TEXT UNIT  */
         LA    TXTUFLDP,TEXTUENT(,@10)                          03S0310
*        DO I=1 TO NUMVOLS WHILE(I<=5);/*LOOP TO SET JFCB VOL SERS   */
         LA    I,1                                              03S0311
         B     @DE00311                                         03S0311
@DL00311 C     I,@CF00117                                       03S0311
         BH    @DC00311                                         03S0311
*          JFCAVOLS(I,1:TEXTULEN)=TEXTUPRM(1:TEXTULEN); /*SER TO JFCB*/
         LR    @10,I                                            03S0312
         MH    @10,@CH00120                                     03S0312
         ALR   @10,JFCBPTR                                      03S0312
         ICM   @15,12,TEXTULEN(TXTUFLDP)                        03S0312
         SRA   @15,16                                           03S0312
         LR    @14,@15                                          03S0312
         BCTR  @14,0                                            03S0312
         EX    @14,@SM02530                                     03S0312
*          TXTUFLDP = TXTUFLDP + TEXTULEN                       03S0313
*            + LENGTH(TEXTULEN);       /*POINT TO NEXT VOL SER IN TU.*/
         ALR   @15,TXTUFLDP                                     03S0313
         AL    @15,@CF00058                                     03S0313
         LR    TXTUFLDP,@15                                     03S0313
*        END;                                                   03S0314
         AL    I,@CF00072                                       03S0314
@DE00311 CR    I,NUMVOLS                                        03S0314
         BNH   @DL00311                                         03S0314
@DC00311 DS    0H                                               03S0315
*        JFCBXPTR = SIOTJFX;           /*POINT TO FIRST JFCBX, IF ANY*/
         L     JFCBXPTR,SIOTJFX(,SIOTPTR)                       03S0315
*        NUMVOLS = NUMVOLS   - 5;      /*NUMBER VOL SERS LEFT TO INIT*/
         SL    NUMVOLS,@CF00117                                 03S0316
*        DO J=1 TO NUMJFCBX WHILE(NUMVOLS > ZERO); /*PUT VOL SER, IF
*                                        ANY, IN JFCBX               */
         LA    @02,1                                            03S0317
         B     @DE00317                                         03S0317
@DL00317 LTR   NUMVOLS,NUMVOLS                                  03S0317
         BNP   @DC00317                                         03S0317
*          DO I=1 TO NUMVOLS WHILE(I<=15 & NUMVOLS > ZERO);     03S0318
         LA    I,1                                              03S0318
         B     @DE00318                                         03S0318
@DL00318 C     I,@CF00088                                       03S0318
         BH    @DC00318                                         03S0318
         LTR   NUMVOLS,NUMVOLS                                  03S0318
         BNP   @DC00318                                         03S0318
*                                      /*LOOP TO SET VOL SERS IN A
*                                        JFCBX, MAX IS 15 PER JFCBX  */
*            JFCBXVOL(I,1:TEXTULEN) =                           03S0319
*              TEXTUPRM(1:TEXTULEN);   /*SER FROM TEXT UNIT TO JFCBX */
         LR    @15,I                                            03S0319
         MH    @15,@CH00120                                     03S0319
         ALR   @15,JFCBXPTR                                     03S0319
         BCTR  @15,0                                            03S0319
         BCTR  @15,0                                            03S0319
         ICM   @14,12,TEXTULEN(TXTUFLDP)                        03S0319
         SRA   @14,16                                           03S0319
         LR    @01,@14                                          03S0319
         BCTR  @01,0                                            03S0319
         EX    @01,@SM02532                                     03S0319
*            TXTUFLDP = TXTUFLDP + TEXTULEN                     03S0320
*              + LENGTH(TEXTULEN);     /*POINT TO NEXT VOL SER IN TU */
         ALR   @14,TXTUFLDP                                     03S0320
         AL    @14,@CF00058                                     03S0320
         LR    TXTUFLDP,@14                                     03S0320
*          END;                                                 03S0321
         AL    I,@CF00072                                       03S0321
@DE00318 CR    I,NUMVOLS                                        03S0321
         BNH   @DL00318                                         03S0321
@DC00318 DS    0H                                               03S0322
*          JFCBXPTR = JFCBXNXT;        /*POINT TO NEXT JFCBX         */
         L     JFCBXPTR,JFCBXNXT(,JFCBXPTR)                     03S0322
*          NUMVOLS = NUMVOLS - 15;     /*# VOL SER LEFT TO INIT      */
         SL    NUMVOLS,@CF00088                                 03S0323
*        END;                                                   03S0324
         LA    @02,1                                            03S0324
         AH    @02,J                                            03S0324
@DE00317 STH   @02,J                                            03S0324
         CR    @02,NUMJFCBX                                     03S0324
         BNH   @DL00317                                         03S0324
@DC00317 DS    0H                                               03S0325
*      END;                                                     03S0325
*                                                               03S0325
*    IF VLRDSTUP ^= ZERO THEN          /*VOL REF TO DSN SPECIFIED?   */
@RF00305 L     @10,VLRDSTUP(,KEYTABP)                           03S0326
         LTR   @10,@10                                          03S0326
         BZ    @RF00326                                         03S0326
*      DO;                                                      03S0327
*        REFRNCTU = VLRDSTUP;          /*ADDR VOLUME REFERENCE TO
*                                        DSNAME TEXT UNIT            */
         LR    REFRNCTU,@10                                     03S0328
*        CALL DSNTPROC;                /*PUT ENTRY IN DSNT           */
         BAL   @14,DSNTPROC                                     03S0329
*        SIOVDSNL = LENGHDSN;          /*LENGTH OF DSN IN DSNT       */
         STC   LENGHDSN,SIOVDSNL(,SIOTPTR)                      03S0330
*        SIOVDSNT = OFFSET;            /*OFFSET TO DSNT ENTRY        */
         STH   OFFSET,SIOVDSNT(,SIOTPTR)                        03S0331
*        SCTVOLAF = ON;                /*INDICATE VOL REF SPECIFIED  */
         OI    SCTVOLAF(SIOTPTR),B'00100000'                    03S0332
*        SCTDSNRF = ON;                /*VOLREF IS TO DSNAME         */
         OI    SCTDSNRF(SIOTPTR),B'10000000'                    03S0333
*      END;                                                     03S0334
*  END;                                                         03S0335
@RF00326 DS    0H                                               03S0336
*                                                               02S0336
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SUBSYSOU                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SUBSYSTEM AND SYSOUT RELATED TEXT UNIT        */
*/*   PROCESSING                                                     */
*/*                                                                  */
*/* FUNCTION - PROCESS SYSOUT CLASS, PROGRAM NAME, FORM NUMBER,      */
*/*   OUTPUT LIMIT, COPIES, DESTINATION, HOLD QUEUE,                 */
*/*   AND THE SUBSYSTEM REQUEST TEXT UNITS (SSREQTUP,        @G29AN2F*/
*/*   SSNMTUP, AND SSPRMTUP).                                @G29AN2F*/
*/*                                                                  */
*/*   OPERATION - THE SIOT SYSOUT CLASS, PROGRAM NAME, FORM #,       */
*/*     DESTINATION, AND SUBSYSTEM NAME FIELDS ARE BLANKED. FOR DUMMY*/
*/*     TYPE REQUESTS, NO FURTHER PROCESSING IS DONE.                */
*/*                                                                  */
*/*     FOR NON-DUMMY TYPE REQUESTS, IF SYSOUT IS SPECIFIED,         */
*/*     THE SIOT AND JFCB SYSOUT INDICATORS ARE SET, AND THE SIOT    */
*/*     SUBSYSTEM DATA SET INDICATOR IS SET.                         */
*/*     A STATUS OF MOD IS SET IN THE JFCB FOR DATA MANAGEMENT.      */
*/*     SEGMENT SYSOUT IS THEN EXECUTED TO PROCESS THE       @G29AN2F*/
*/*     SYSOUT RELATED TEXT UNITS.                           @G29AN2F*/
*/*                                                                  */
*/*     IF A SUBSYSTEM REQUEST (SSREQTUP) IS                 @G29AN2F*/
*/*     SPECIFIED IN A NON-DUMMY TYPE OF                     @G29AN2F*/
*/*     REQUEST, THE SIOT SUBSYSTEM INDICATOR IS SET, AND IF A       */
*/*     SUBSYSTEM NAME IS ALSO SPECIFIED, IT IS PLACED IN THE SIOT.  */
*/*                                                          @G29AN2F*/
*/*     IF A SUBSYSTEM NAME REQUEST(SSNMTUP) IS SPECIFIED    @G29AN2F*/
*/*     IN A NON-DUMMY TYPE REQUEST, THE SIOT SUBSYSTEM      @G29AN2F*/
*/*     INDICATOR AND SIOT SUBSYSTEM GROUP REQUEST INDICATORS@G29AN2F*/
*/*     ARE SET.  SEGMENT SSNAME IS THEN EXECUTED TO         @G29AN2F*/
*/*     PROCESS THE SUBSYSTEM NAME AND THE SUBSYSTEM         @G29AN2F*/
*/*     PARAMETER TEXT UNITS                                 @G29AN2F*/
*/*                                                                  */
*/* INPUT -                                                          */
*/*   SIOT DUMMY DATA SET INDICATOR                                  */
*/*   KEYTABLE - TO DETERMINE WHAT TEXT UNITS ARE SPECIFIED          */
*/*   JCT - DEFAULT MESSAGE CLASS                                    */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   SIOT, JFCB AND SSWA - UPDATED FOR TEXT UNITS.          @G29AN2F*/
*/*    SSWA - CREATED AND INITIALIZED                        @G29AN2F*/
*/*                                                                  */
*/********************************************************************/
*SCTOUTPN = '';                        /*BLANK SIOT OUTPUT CLASS     */
@RF00268 MVI   SCTOUTPN(SIOTPTR),C' '                           03S0336
*SCTOUTNM = '';                        /*BLANK SIOT PROGRAM NAME     */
         MVI   SCTOUTNM(SIOTPTR),C' '                           03S0337
         MVC   SCTOUTNM+1(7,SIOTPTR),SCTOUTNM(SIOTPTR)          03S0337
*SCTOUTNO = '';                        /*BLANK SIOT FORM NUMBER      */
         MVI   SCTOUTNO(SIOTPTR),C' '                           03S0338
         MVC   SCTOUTNO+1(3,SIOTPTR),SCTOUTNO(SIOTPTR)          03S0338
*SIOTDEST = '';                        /*BLANK SIOT DESTINATION      */
         MVI   SIOTDEST(SIOTPTR),C' '                           03S0339
         MVC   SIOTDEST+1(7,SIOTPTR),SIOTDEST(SIOTPTR)          03S0339
*SIOTSSNM = '';                        /*BLANK SIOT SUBSYSTEM NAME   */
         MVI   SIOTSSNM(SIOTPTR),C' '                           03S0340
         MVC   SIOTSSNM+1(3,SIOTPTR),SIOTSSNM(SIOTPTR)          03S0340
*IF SYSOUTUP ^= ZERO                   /*SYSOUT SPECIFIED?           */
*  & SCTDUMMY = OFF THEN               /*AND NOT DUMMY TYPE DATA SET?*/
         SLR   @10,@10                                          03S0341
         L     @15,SYSOUTUP(,KEYTABP)                           03S0341
         CR    @15,@10                                          03S0341
         BE    @RF00341                                         03S0341
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0341
         BNZ   @RF00341                                         03S0341
*  DO;                                                          03S0342
*    SCTSYSOU = ON;                    /*YES,SET SYSOUT INDICATOR    */
         OI    SCTSYSOU(SIOTPTR),B'00001000'                    03S0343
*    SIOTSSDS = ON;                    /*SET SUBSYSTEM D.S. INDICATOR*/
         OI    SIOTSSDS(SIOTPTR),B'10000000'                    03S0344
*    JFCSDS = ON;                      /*SET JFCB SYSOUT INDICATOR   */
         OI    JFCSDS(JFCBPTR),B'00100000'                      03S0345
*    JFCDISP = '10'B;                  /*FORCE DISP OF MOD FOR  03S0346
*                                        DATA MANAGEMENT             */
         NI    JFCDISP(JFCBPTR),B'10111111'                     03S0346
         OI    JFCDISP(JFCBPTR),B'10000000'                     03S0346
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SYSOUT                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SYSOUT AND ASSOCIATED TEXT UNIT               */
*/*   PROCESSING                                                     */
*/*   NOTE-THIS SEGMENT WAS CREATED TO PRESERVE THE          @G29AN2F*/
*/*   PROGRAM STRUCTURE AS PART OF SUPPORT CODE G29AN2F      @G29AN2F*/
*/*   HOWEVER THE CODE IS UNCHANGED                          @G29AN2F*/
*/*                                                                  */
*/* FUNCTION  -  PROCESS SYSOUT CLASS, PROGRAM NAME, FORM            */
*/*   NUMBER, OUTPUT LIMIT, COPIES, DESTINATION, AND HOLD            */
*/*   QUEUE TEXT UNITS.                                              */
*/*                                                                  */
*/*   OPERATION - IF A CLASS IS SPECIFIED IT IS PLACED IN THE        */
*/*     SIOT. IF NOT, THE OUTPUT CLASS IS DEFAULTED TO THE           */
*/*     MESSAGE CLASS. THE PROGRAM NAME, FORM #, OUTPUT              */
*/*     LIMIT, COPIES, AND DESTINATION ARE PLACED IN THE SIOT        */
*/*     IF THEY ARE SPECIFIED. IF COPIES IS NOT SPECIFIED A          */
*/*     DEFAULT OF 1 IS SET. IF HOLD IS SPECIFIED A                  */
*/*     DEFAULT OF 1 IS SET. IF HOLD IS SPECIFIED A                  */
*/*     SIOT INDICATOR IS SET.                                       */
*/*                                                                  */
*/* INPUT                                                            */
*/*   JCT - DEFAULT MESSAGE CLASS                                    */
*/*   PROCESSING                                                     */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   SIOT - UPDATED FOR TEXT UNITS                                  */
*/*                                                                  */
*/********************************************************************/
*RFY TEXTUNIT BASED(SYSOUTUP);         /*BASE FOR SYSOUT TEXT UNIT   */
*IF TEXTUNUM ^=ZERO THEN               /*CLASS SPECIFIED?            */
         ICM   @14,12,TEXTUNUM(@15)                             04S0348
         SRA   @14,16                                           04S0348
         CR    @10,@14                                          04S0348
         BE    @RF00348                                         04S0348
*  SCTOUTPN = TEXTUPAR(1);             /*YES,SET SIOT OUTPUT CLASS   */
         MVC   SCTOUTPN(1,SIOTPTR),TEXTUPAR(@15)                04S0349
*ELSE                                                           04S0350
*  DO;                                 /*NO CLASS SPECIFIED  @ZA17350*/
         B     @RC00348                                         04S0350
@RF00348 DS    0H                                               04S0351
*    SCTOUTPN = JCTJMGPO;              /*NO,DEFAULT TO MESSAGE CLASS */
         L     @10,@PC00001                                     04S0351
         L     @10,JCTPTR(,@10)                                 04S0351
         MVC   SCTOUTPN(1,SIOTPTR),JCTJMGPO(@10)                04S0351
*  END;                                /*                    @ZA17350*/
*                                                               04S0352
*RFY TEXTUNIT BASED(SPGNMTUP);         /*BASE FOR PROGRAM NAME TEXTUN*/
@RC00348 DS    0H                                               04S0354
*IF SPGNMTUP ^= ZERO THEN              /*SYSOUT PROGRAM NAME SPECIF'D*/
         L     @10,SPGNMTUP(,KEYTABP)                           04S0354
         LTR   @10,@10                                          04S0354
         BZ    @RF00354                                         04S0354
*  SCTOUTNM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,SET IN SIOT    */
*                                                               04S0355
         ICM   @15,12,TEXTULNG(@10)                             04S0355
         SRA   @15,16                                           04S0355
         BCTR  @15,0                                            04S0355
         EX    @15,@SM02534                                     04S0355
*RFY TEXTUNIT BASED(SFMNOTUP);         /*BASE FOR FORM NUMBER TEXTUNT*/
@RF00354 DS    0H                                               04S0357
*IF SFMNOTUP ^= ZERO THEN              /*SYSOUT FORM NUMBER SPECIFIED*/
         L     @10,SFMNOTUP(,KEYTABP)                           04S0357
         LTR   @10,@10                                          04S0357
         BZ    @RF00357                                         04S0357
*  SCTOUTNO(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,SET IN SIOT    */
*                                                               04S0358
         ICM   @15,12,TEXTULNG(@10)                             04S0358
         SRA   @15,16                                           04S0358
         BCTR  @15,0                                            04S0358
         EX    @15,@SM02536                                     04S0358
*IF OUTLMTUP ^= ZERO THEN              /*SYSOUT OUTPUT LIMIT SPECIF'D*/
@RF00357 L     @10,OUTLMTUP(,KEYTABP)                           04S0359
         LTR   @10,@10                                          04S0359
         BZ    @RF00359                                         04S0359
*  JFCOUTLI = OUTLMTUP->TEXTUPAR(1:3); /*YES,MOVE OUTLIM TO JFCB     */
*                                                               04S0360
         MVC   JFCOUTLI(3,JFCBPTR),TEXTUPAR(@10)                04S0360
*IF COPYSTUP ^= ZERO THEN              /*SYSOUT COPIES SPECIFIED?    */
@RF00359 L     @10,COPYSTUP(,KEYTABP)                           04S0361
         LTR   @10,@10                                          04S0361
         BZ    @RF00361                                         04S0361
*  SIOTOUTC = COPYSTUP->TEXTUPAR(1);   /*YES,MOVE COPIES TO SIOT     */
         MVC   SIOTOUTC(1,SIOTPTR),TEXTUPAR(@10)                04S0362
*ELSE                                  /*NO, COPIES NOT SPECIFIED    */
*  SIOTOUTC = 1;                       /*DEFAULT TO ONE              */
*                                                               04S0363
         B     @RC00361                                         04S0363
@RF00361 MVI   SIOTOUTC(SIOTPTR),X'01'                          04S0363
*RFY TEXTUNIT BASED(SUSERTUP);         /*BASE FOR REMOTE USER TEXTUNT*/
@RC00361 DS    0H                                               04S0365
*IF SUSERTUP ^= ZERO THEN              /*SYSOUT REMOTE USER SPECIFIED*/
         L     @10,SUSERTUP(,KEYTABP)                           04S0365
         LTR   @10,@10                                          04S0365
         BZ    @RF00365                                         04S0365
*  SIOTDEST(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,SET IN SIOT    */
         ICM   @15,12,TEXTULNG(@10)                             04S0366
         SRA   @15,16                                           04S0366
         BCTR  @15,0                                            04S0366
         EX    @15,@SM02538                                     04S0366
*/*     FOR A TSO TASK IF DESTINATION WAS NOT SPECIFIED, THE @ZA08773*/
*/*     DEFAULT DESTINATION IS USED FROM THE PSCB.           @ZA08773*/
*ELSE                                  /*REMOTE USER NOT SPCD@ZA08773*/
*  IF JSCBPSCB ^= ZERO &               /*TEST FOR TSO DEFAULT@ZA15302*/
*     PSCBDEST ^= NODEST THEN          /*TEST PSCB FOR ZERO  @ZA15302*/
         B     @RC00365                                         04S0367
@RF00365 L     @10,@PC00001                                     04S0367
         L     @10,JSCBPTR(,@10)                                04S0367
         L     @10,JSCBPSCB(,@10)                               04S0367
         LTR   @10,@10                                          04S0367
         BZ    @RF00367                                         04S0367
         CLC   PSCBDEST(8,@10),NODEST                           04S0367
         BE    @RF00367                                         04S0367
*    SIOTDEST = PSCBDEST;              /*DEFAULT REMOTE USER @ZA08773*/
*                                                               04S0368
         MVC   SIOTDEST(8,SIOTPTR),PSCBDEST(@10)                04S0368
*IF SHOLDTUP ^= ZERO THEN              /*SYSOUT HOLD QUEUE SPECIFIED?*/
@RF00367 DS    0H                                               04S0369
@RC00365 L     @10,SHOLDTUP(,KEYTABP)                           04S0369
         LTR   @10,@10                                          04S0369
         BZ    @RF00369                                         04S0369
*  SIOTHOLD = ON;                      /*YES,SET SIOT INDICATOR      */
         OI    SIOTHOLD(SIOTPTR),B'01000000'                    04S0370
*  END;                                                         03S0371
*                                                               03S0371
@RF00369 DS    0H                                               03S0372
*RFY TEXTUNIT BASED(SSREQTUP);         /*BASE FOR SUBSYSTEM REQ TEXTU*/
@RF00341 DS    0H                                               03S0373
*IF SSREQTUP ^= ZERO                   /*SUBSYSTEM REQUEST SPECIFIED?*/
*  & SCTDUMMY = OFF THEN               /*AND NOT DUMMY TYPE DATA SET?*/
         SLR   @10,@10                                          03S0373
         L     @15,SSREQTUP(,KEYTABP)                           03S0373
         CR    @15,@10                                          03S0373
         BE    @RF00373                                         03S0373
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0373
         BNZ   @RF00373                                         03S0373
*  DO;                                                          03S0374
*    SIOTSSDS = ON;                    /*YES,SET SIOT INDICATOR      */
         OI    SIOTSSDS(SIOTPTR),B'10000000'                    03S0375
*    IF TEXTUNUM ^= ZERO THEN          /*SUBSYSTEM NAME SPECIFIED?   */
         ICM   @14,12,TEXTUNUM(@15)                             03S0376
         SRA   @14,16                                           03S0376
         CR    @10,@14                                          03S0376
         BE    @RF00376                                         03S0376
*      SIOTSSNM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,SET IN SIOT*/
         ICM   @10,12,TEXTULNG(@15)                             03S0377
         SRA   @10,16                                           03S0377
         BCTR  @10,0                                            03S0377
         EX    @10,@SM02540                                     03S0377
*  END;                                                         03S0378
@RF00376 DS    0H                                               03S0379
*IF SU29BIT = ON                       /*IS SU29 INSTALLED ? @G29AN2F*/
*  & SSNMTUP ^= ZERO                   /*SUBSYS NAME PRESENT?@G29AN2F*/
*  & SCTDUMMY = OFF THEN               /*AND NOT DUMMY REQ?  @G29AN2F*/
@RF00373 L     @10,CVTPTR                                       03S0379
         L     @10,CVTIHASU(,@10)                               03S0379
         TM    SU29BIT(@10),B'00000100'                         03S0379
         BNO   @RF00379                                         03S0379
         SLR   @10,@10                                          03S0379
         L     @15,SSNMTUP(,KEYTABP)                            03S0379
         CR    @15,@10                                          03S0379
         BE    @RF00379                                         03S0379
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    03S0379
         BNZ   @RF00379                                         03S0379
*  DO;                                 /*YES, PROCESS REQUEST@G29AN2F*/
*    SIOTSSDS = ON;                    /*SET SUBSYSTEM D.S.  @G29AN2F*/
         OI    SIOTSSDS(SIOTPTR),B'10000000'                    03S0381
*    SIOTSSGP = ON;                    /*INDIC GROUP REQUEST @G29AN2F*/
         OI    SIOTSSGP(SIOTPTR),B'00010000'                    03S0382
*    JFCSDS = ON;                      /*SET JFCB INDICATOR  @G29AN2F*/
         OI    JFCSDS(JFCBPTR),B'00100000'                      03S0383
*    JFCDISP = '10'B;                  /*FORCE DISP OF MOD      03S0384
*                                        FOR DATA MANAGEMENT @G29AN2F*/
         NI    JFCDISP(JFCBPTR),B'10111111'                     03S0384
         OI    JFCDISP(JFCBPTR),B'10000000'                     03S0384
*/***********************************************************@G29AN2F*/
*/*                                                          @G29AN2F*/
*/* SEGMENT NAME - SSNAME                                    @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* DESCRIPTIVE NAME - SUBSYSTEM NAME AND PARAMETERS TEXT    @G29AN2F*/
*/*   UNIT PROCESSING                                        @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* FUNCTION - PROCESS SUBSYSTEM NAME (SSNMTUP) IF ONE       @G29AN2F*/
*/*   IS SPECIFIED, CREATE A SSWA BLOCK TO CONTAIN THE       @G29AN2F*/
*/*   SUBSYSTEM PARAMETERS, INITIALIZE THE SSWA WITH THE     @G29AN2F*/
*/*   PARAMETERS, WRITE THE SSWA IN SWA, AND CHAIN IT TO     @G29AN2F*/
*/*   THE SIOT.                                              @G29AN2F*/
*/*                                                          @G29AN2F*/
*/*   OPERATION - IF A SUBSYSTEM NAME IS SPECIFIED IT IS     @G29AN2F*/
*/*     PLACED IN THE SIOT. SEGMENT GETSSWA IS CALLED TO     @G29AN2F*/
*/*     CALCULATE THE SIZE OF THE SSWA REQUIRED AND TO       @G29AN2F*/
*/*     CALL THE SWA MANAGER TO ASSIGN THE SSWA. THE SSWA    @G29AN2F*/
*/*     IS THEN INITIALIZED WITH THE SUBSYSTEM NAME, IF      @G29AN2F*/
*/*     SPECIFIED, AND THE SUBSYSTEM PARAMETERS (SSPRMTUP)   @G29AN2F*/
*/*     IF THE TEXT UNIT WAS SPECIFIED. THE COMPLETED SSWA   @G29AN2F*/
*/*     IS THEN WRITTEN IN SWA AND CHAINED TO THE SIOT.      @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* INPUT -                                                  @G29AN2F*/
*/*   KEYTABLE - TO DETERMINE THE TEXT UNITS SPECIFIED       @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* OUTPUT                                                   @G29AN2F*/
*/*   SIOT - UPDATED FOR THE TEXT UNITS                      @G29AN2F*/
*/*   SSWA - CREATED, INITIALIZED, WRITTEN TO SWA AND        @G29AN2F*/
*/*     CHAINED TO THE SIOT.                                 @G29AN2F*/
*/*                                                          @G29AN2F*/
*/***********************************************************@G29AN2F*/
*RFY TEXTUNIT BASED(SSNMTUP);         /*BASE FOR SSNAME TU   @G29AN2F*/
*IF TEXTUNUM ^= ZERO THEN             /*IS NAME SPECIFIED?   @G29AN2F*/
         ICM   @14,12,TEXTUNUM(@15)                             04S0386
         SRA   @14,16                                           04S0386
         CR    @10,@14                                          04S0386
         BE    @RF00386                                         04S0386
*  SIOTSSNM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG);/*YES, PUT       04S0387
*                                        THE NAME INTO SIOT  @G29AN2F*/
         ICM   @10,12,TEXTULNG(@15)                             04S0387
         SRA   @10,16                                           04S0387
         BCTR  @10,0                                            04S0387
         EX    @10,@SM02540                                     04S0387
*/***********************************************************@G29AN2F*/
*/*                                                          @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* SEGMENT NAME - GETSSWA                                   @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* DESCRIPTIVE NAME - GET SUBSYSTEM SCHEDULER               @G29AN2F*/
*/*                    WORK AREA (SSWA)                      @G29AN2F*/
*/*                                                          @G29AN2F*/
*/*   CONTAIN THE USER SPECIFIED SUBSYSTEM PARAMETERS AND    @G29AN2F*/
*/*   ASSIGN THE SWA BLOCK REQUIRED.                         @G29AN2F*/
*/*                                                          @G29AN2F*/
*/*   OPERATION - THE SIZE OF THE MINIMUM SSWA IS SET. IF    @G29AN2F*/
*/*     SUBSYSTEM PARAMETERS WERE SPECIFIED(SSPRMTUP) THEN   @G29AN2F*/
*/*     THE NUMBER AND LENGTH OF THE PARAMETERS ARE USED TO  @G29AN2F*/
*/*     THE PARAMETERS. THE SWA MANAGER INTERFACE ROUTINE,   @G29AN2F*/
*/*     IEFAB4F7, IS INVOKED TO ASSIGN THE SSWA BLOCK.       @G29AN2F*/
*/*                                                          @G29AN2F*/
*/* INPUT                                                    @G29AN2F*/
*/*   KEYTABLE - TO DETERMINE THE ADDRESS OF THE SUBSYSTEM   @G29AN2F*/
*/*   PARAMETERS TEXT UNIT.                                  @G29AN2F*/
*/* OUTPUT                                                   @G29AN2F*/
*/*   SSWAPTR - POINTER TO SSWA                              @G29AN2F*/
*/*                                                          @G29AN2F*/
*/***********************************************************@G29AN2F*/
*DO;                                   /*                    @G29AN2F*/
@RF00386 DS    0H                                               05S0389
*  SIZESSWA = LENGTH(SSWAHDR);         /*INIT SSWA SIZE      @G29AN2F*/
         MVC   SIZESSWA(4),@CF00094                             05S0389
*  IF SSPRMTUP ^= ZERO THEN            /*ARE SUBSYSTEM PARAMETERS
*                                        SPECIFIED?          @G29AN2F*/
         L     @10,SSPRMTUP(,KEYTABP)                           05S0390
         LTR   @10,@10                                          05S0390
         BZ    @RF00390                                         05S0390
*    DO;                               /*YES,CALC SSWA REQD  @G29AN2F*/
*      RFY TEXTUNIT BASED(SSPRMTUP);   /*SET PARM BASE       @G29AN2F*/
*      TXTUFLDP = ADDR(TEXTUENT);      /*SET PTR TO 1ST PARM @G29AN2F*/
         LA    TXTUFLDP,TEXTUENT(,@10)                          05S0393
*      RFY TEXTUFLD BASED(TXTUFLDP);   /*SET INDIVIDUAL PARM    05S0394
*                                        BASE                @G29AN2F*/
*      DO I = TEXTUNUM TO 1 BY -1;     /*SCAN ALL PARMS      @G29AN2F*/
         ICM   I,12,TEXTUNUM(@10)                               05S0395
         SRA   I,16                                             05S0395
         B     @DE00395                                         05S0395
@DL00395 DS    0H                                               05S0396
*        ITEMLEN = TEXTULEN;           /*GET LEN OF PARM ITEM@G29AN2F*/
         ICM   ITEMLEN,12,TEXTULEN(TXTUFLDP)                    05S0396
         SRA   ITEMLEN,16                                       05S0396
*        SIZESSWA = SIZESSWA + ITEMLEN /*ADD LENGTH OF PARM  @G29AN2F*/
*          + LENGTH(SSWAPLEN);         /*PLUS SIZE OF LEN    @G29AN2F*/
         LR    @10,ITEMLEN                                      05S0397
         AL    @10,SIZESSWA                                     05S0397
         AL    @10,@CF00072                                     05S0397
         ST    @10,SIZESSWA                                     05S0397
*        TXTUFLDP = TXTUFLDP + ITEMLEN /*INCREMENT PTR TO    @G29AN2F*/
*          + LENGTH(TEXTULEN);         /*NEXT LEN/PARM PAIR  @G29AN2F*/
         LR    @10,TXTUFLDP                                     05S0398
         ALR   @10,ITEMLEN                                      05S0398
         AL    @10,@CF00058                                     05S0398
         LR    TXTUFLDP,@10                                     05S0398
*      END;                            /*GET NEX PAIR        @G29AN2F*/
         BCTR  I,0                                              05S0399
@DE00395 LTR   I,I                                              05S0399
         BP    @DL00395                                         05S0399
*      RFY TEXTUFLD;                   /*RESET BASE          @G29AN2F*/
*    END;                              /*                    @G29AN2F*/
*  LCLEPA = LCLEPA && LCLEPA;          /*CLEAR EPA           @G29AN2F*/
@RF00390 XC    LCLEPA(16),LCLEPA                                05S0402
*  SWACTLS = SWACTLS && SWACTLS;       /*RESET SWA I/F CTLS  @G29AN2F*/
         LH    @10,SWACTLS                                      05S0403
         N     @10,@CF02505                                     05S0403
         LR    @04,@10                                          05S0403
         XR    @04,@10                                          05S0403
         STH   @04,SWACTLS                                      05S0403
*  SWASN = ON;                         /*ASSIGN SWA RECORD   @G29AN2F*/
*  SWMOD = ON;                         /*MODIFY EPA          @G29AN2F*/
         OI    SWASN,B'10000010'                                05S0405
*  NUMRCORD = 1;                       /*INDICATE 1 RECORD   @G29AN2F*/
         MVC   NUMRCORD(4),@CF00072                             05S0406
*  SMIID(1) = '31'X;                   /*SET SSWA RECORD ID  @G29AN2F*/
         MVI   SMIID,X'31'                                      05S0407
*  CALL IEFAB4F7                       /*ASSIGN SSWA         @G29AN2F*/
*     (SWACTLS,ADDR(LCLEPA),0,ADDR(SMISVAID),                   05S0408
*      ADDR(SMISVAB),SIZESSWA,NUMRCORD);                        05S0408
         LA    @10,SWACTLS                                      05S0408
         ST    @10,@AL00001                                     05S0408
         LA    @10,LCLEPA                                       05S0408
         ST    @10,@TF00001                                     05S0408
         LA    @10,@TF00001                                     05S0408
         ST    @10,@AL00001+4                                   05S0408
         LA    @10,@CF00090                                     05S0408
         ST    @10,@AL00001+8                                   05S0408
         LA    @10,SMISVAID                                     05S0408
         ST    @10,@TF00002                                     05S0408
         LA    @10,@TF00002                                     05S0408
         ST    @10,@AL00001+12                                  05S0408
         LA    @10,SMISVAB                                      05S0408
         ST    @10,@TF00003                                     05S0408
         LA    @10,@TF00003                                     05S0408
         ST    @10,@AL00001+16                                  05S0408
         LA    @10,SIZESSWA                                     05S0408
         ST    @10,@AL00001+20                                  05S0408
         LA    @10,NUMRCORD                                     05S0408
         ST    @10,@AL00001+24                                  05S0408
         L     @15,@CV00086                                     05S0408
         LA    @01,@AL00001                                     05S0408
         BALR  @14,@15                                          05S0408
*  SSWAPTR = SMISVAB(1);               /*SET PTR TO SSWA     @G29AN2F*/
         L     SSWAPTR,SMISVAB                                  05S0409
*END;                                                           05S0410
*SSWATYPE = SSWASYST;                 /*INDICATE SSWA TYPE   @G29AN2F*/
         MVC   SSWATYPE(2,SSWAPTR),@CH00072                     04S0411
*SSWASSNM = SIOTSSNM;                 /*SET SUBSYSTEM NAME   @G29AN2F*/
         MVC   SSWASSNM(4,SSWAPTR),SIOTSSNM(SIOTPTR)            04S0412
*IF SSPRMTUP ^= ZERO THEN             /*ARE SUBSYS PARMS        04S0413
*                                       SPECIFIED?           @G29AN2F*/
         L     @10,SSPRMTUP(,KEYTABP)                           04S0413
         LTR   @10,@10                                          04S0413
         BZ    @RF00413                                         04S0413
*  DO;                                /*YES, PUT PARMS IN    @G29AN2F*/
*    RFY TEXTUNIT BASED(SSPRMTUP);    /*SET PARM T.U. BASE   @G29AN2F*/
*    TXTUFLDP = ADDR(TEXTUENT);       /*SET PTR TO 1ST PARM  @G29AN2F*/
         L     @15,SSPRMTUP(,KEYTABP)                           04S0416
         LA    TXTUFLDP,TEXTUENT(,@15)                          04S0416
*    RFY TEXTUFLD BASED(TXTUFLDP);    /*SET INDIV PARM BASE  @G29AN2F*/
*    PTRSSWAI = ADDR(SSWAPREN);       /*PTR TO 1ST PARM POS  @G29AN2F*/
         LA    PTRSSWAI,SSWAPREN(,SSWAPTR)                      04S0418
*    RFY SSWAIFLD BASED(PTRSSWAI);    /*SET INDIVIDUAL SSWA     04S0419
*                                       PARM ITEM POSITION   @G29AN2F*/
*    DO I = TEXTUNUM TO 1 BY -1;      /*MOVE ALL PARM ITEMS  @G29AN2F*/
         ICM   I,12,TEXTUNUM(@15)                               04S0420
         SRA   I,16                                             04S0420
         B     @DE00420                                         04S0420
@DL00420 DS    0H                                               04S0421
*      ITEMLEN = TEXTULEN;            /*GET ITEM LENGTH      @G29AN2F*/
         ICM   ITEMLEN,12,TEXTULEN(TXTUFLDP)                    04S0421
         SRA   ITEMLEN,16                                       04S0421
*      IF ITEMLEN > 0 THEN            /*ITS ITEM VALUE CODED @G29AN2F*/
         LTR   ITEMLEN,ITEMLEN                                  04S0422
         BNP   @RF00422                                         04S0422
*        DO;                          /*YES, MOVE            @G29AN2F*/
*          SSWAIPRM(1:ITEMLEN) = TEXTUPRM(1:ITEMLEN);/*         04S0424
*                                        MOVE ITEM VALUE IN  @G29AN2F*/
         LR    @15,ITEMLEN                                      04S0424
         BCTR  @15,0                                            04S0424
         EX    @15,@SM02543                                     04S0424
*        END;                         /*                     @G29AN2F*/
*      SSWAILEN = ITEMLEN;            /*PUT ITEM LENGTH IN   @G29AN2F*/
@RF00422 STC   ITEMLEN,SSWAILEN(,PTRSSWAI)                      04S0426
*      TXTUFLDP = TXTUFLDP + ITEMLEN  /*POINT TO NEXT TEXT   @G29AN2F*/
*        + LENGTH(TEXTULEN);          /*UNIT PARM            @G29AN2F*/
         LR    @15,TXTUFLDP                                     04S0427
         ALR   @15,ITEMLEN                                      04S0427
         AL    @15,@CF00058                                     04S0427
         LR    TXTUFLDP,@15                                     04S0427
*      PTRSSWAI = PTRSSWAI + ITEMLEN  /*POINT TO NEXT SSWA   @G29AN2F*/
*        + LENGTH(SSWAILEN);          /*ITEM AREA            @G29AN2F*/
         LR    @15,PTRSSWAI                                     04S0428
         ALR   @15,ITEMLEN                                      04S0428
         AL    @15,@CF00072                                     04S0428
         LR    PTRSSWAI,@15                                     04S0428
*    END;                             /*GET NEXT PARM ITEM   @G29AN2F*/
         BCTR  I,0                                              04S0429
@DE00420 LTR   I,I                                              04S0429
         BP    @DL00420                                         04S0429
*    SSWAPRNO = TEXTUNUM;             /*INSERT NO OF PARMS   @G29AN2F*/
         L     @10,SSPRMTUP(,KEYTABP)                           04S0430
         MVC   SSWAPRNO(2,SSWAPTR),TEXTUNUM(@10)                04S0430
*  END;                               /*                     @G29AN2F*/
*ELSE                                 /*NO PARMS SPECIFIED   @G29AN2F*/
*  SSWAPRNO = ZERO;                   /*SET NO OF PARM TO 0  @G29AN2F*/
         B     @RC00413                                         04S0432
@RF00413 SLR   @10,@10                                          04S0432
         STH   @10,SSWAPRNO(,SSWAPTR)                           04S0432
*SWACTLS = SWACTLS && SWACTLS;        /*CLEAR SWA I/F CTLS   @G29AN2F*/
@RC00413 LH    @10,SWACTLS                                      04S0433
         N     @10,@CF02505                                     04S0433
         LR    @15,@10                                          04S0433
         XR    @15,@10                                          04S0433
         STH   @15,SWACTLS                                      04S0433
*SWOLD = ON;                          /*USE THE EXISTING EPA @G29AN2F*/
*SWWRT = ON;                          /*INDICATE WRITE       @G29AN2F*/
         OI    SWOLD,B'00010001'                                04S0435
*CALL IEFAB4F7(SWACTLS,ADDR(LCLEPA), 0,0,0,0,0); /*WRITE COMPLETED
*                                       SSWA TO SWA          @G29AN2F*/
         MVC   @AL00001+8(20),@AL00436                          04S0436
         LA    @10,SWACTLS                                      04S0436
         ST    @10,@AL00001                                     04S0436
         LA    @10,LCLEPA                                       04S0436
         ST    @10,@TF00001                                     04S0436
         LA    @10,@TF00001                                     04S0436
         ST    @10,@AL00001+4                                   04S0436
         L     @15,@CV00086                                     04S0436
         LA    @01,@AL00001                                     04S0436
         BALR  @14,@15                                          04S0436
*SIOTSSWA = SMISVA(1);                /*PUT SSWA SVA IN SIOT @G29AN2F*/
         MVC   SIOTSSWA(3,SIOTPTR),SMISVA                       04S0437
*  END;                                                         03S0438
*                                                               02S0439
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - LABEL                                             */
*/*                                                                  */
*/* DESCRIPTIVE NAME - LABEL RELATED TEXT UNIT PROCESSING            */
*/*                                                                  */
*/* FUNCTION - PROCESS LABEL TYPE, DATA SET SEQUENCE NUMBER,         */
*/*   PASSWORD PROTECTION, INPUT ONLY/OUTPUT ONLY, EXPIRATION DATE,  */
*/*   AND RETENTION PERIOD TEXT UNITS. SET CREATE DATE.              */
*/*                                                                  */
*/*   OPERATION - IF LABEL TYPE IS SPECIFIED, IT IS PLACED IN THE    */
*/*     JFCB. OTHERWISE A DEFAULT OF STANDARD LABEL IS SET. SIOT     */
*/*     INDICATORS FOR NO LABEL, USASI OR NON-STANDARD LABEL ARE SET */
*/*     DEPENDING ON THE LABEL TYPE. IF BLP IS THE LABEL TYPE        */
*/*     SPECIFIED AND THE USER IS NOT AUTHORIZED THE USE BLP AS      */
*/*     INDICATED IN THE THE JCT, THE LABEL TYPE IS CHANGED TO NL.   */
*/*                                                                  */
*/*     IF A DATA SET SEQUENCE NUMBER IS SPECIFIED, IT IS PLACED IN  */
*/*     THE JFCB.                                                    */
*/*                                                                  */
*/*     PASSWORD PROTECTION AND INOUT INDICATORS ARE SET             */
*/*     IN THE JFCB IF SPECIFIED.                                    */
*/*                                                                  */
*/*     IF A STATUS OF NEW OR MOD IS                                 */
*/*     INDICATED, OR RETENTION PERIOD IS SPECIFIED,                 */
*/*     THE JFCB DATA SET CREATION DATE FIELD IS SET                 */
*/*     WITH THE CURRENT DATE.                                       */
*/*                                                                  */
*/*     IF EXPIRATION DATE IS SPECIFIED,                             */
*/*     IT IS CONVERTED TO BINARY AND PLACED IN THE JFCB.            */
*/*     IF THE EXPIRATION DATE SPECIFIED IS ZERO AND DCB DSNAME      */
*/*     REFERENCE IS SPECIFIED, THE EXPIRATION DATE                  */
*/*     FIELD IS SET TO F'S.  THIS IS AN INDICATOR TO JFCB           */
*/*     HOUSEKEEPING TO NOT OVERLAY THE FIELD WITH THE EXPIRATION    */
*/*     DATE OF THE REFERENCED DATA SET. HOUSEKEEPING WILL RESET     */
*/*     THE FIELD TO ZERO.                                           */
*/*                                                                  */
*/*     IF A RETENTION PERIOD IS SPECIFIED,                          */
*/*     IT IS ADDED TO THE CREATE DATE AND PLACED IN THE JFCB        */
*/*     EXPIRATION DATE FIELD. IF THIS SUM IS A DATE GREATER THAN    */
*/*     THE LAST DAY IN THE 20TH CENTURY, IT IS CHANGED TO THE       */
*/*     LAST DAY IN THE 20TH CENTURY.                                */
*/*                                                                  */
*/* INPUT                                                            */
*/*   KEYTABLE - TO DETERMINE WHAT TEXT UNITS ARE SPECIFIED          */
*/*   CURRENT DATE                                                   */
*/*   SIOT - TO DETERMINE STATUS                                     */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   JFCB FILLED IN FOR SPECIFIED TEXT UNITS, DEFAULT LABEL TYPE,   */
*/*     AND DATA SET CREATION DATE.                                  */
*/*   SIOT FILLED IN FOR LABEL TYPE                                  */
*/*                                                                  */
*/********************************************************************/
*IF LABELTUP ^= ZERO THEN              /*LABEL TYPE SPECIFIED?       */
@RF00379 L     @10,LABELTUP(,KEYTABP)                           03S0439
         LTR   @10,@10                                          03S0439
         BZ    @RF00439                                         03S0439
*  DO;                                                          03S0440
*    JFCBLTYP = LABELTUP->TEXTUPAR(1); /*YES,MOVE LABEL TO JFCB      */
         MVC   JFCBLTYP(1,JFCBPTR),TEXTUPAR(@10)                03S0441
*    IF JFCBLP = ON                    /*BYPASS LABEL PROC SPECIFIED?*/
*      & JCTBLP = OFF THEN             /*AND USER NOT BLP AUTHORIZED?*/
         TM    JFCBLP(JFCBPTR),B'00010000'                      03S0442
         BNO   @RF00442                                         03S0442
         L     @10,@PC00001                                     03S0442
         L     @10,JCTPTR(,@10)                                 03S0442
         TM    JCTBLP(@10),B'00000100'                          03S0442
         BNZ   @RF00442                                         03S0442
*      DO;                                                      03S0443
*        JFCBLP = OFF;                 /*YES,CHANGE BLP TO NL        */
*        JFCNL = ON;                                            03S0445
         OI    JFCNL(JFCBPTR),B'00000001'                       03S0445
         NI    JFCBLP(JFCBPTR),B'11101111'                      03S0445
*      END;                                                     03S0446
*    IF JFCNL = ON × JFCBLP = ON THEN  /*NO LABEL OR BYPASS LABEL?   */
@RF00442 TM    JFCNL(JFCBPTR),B'00010001'                       03S0447
         BZ    @RF00447                                         03S0447
*      SCTUNLBD = ON;                  /*YES,SET SIOT NO LABEL INDIC.*/
         OI    SCTUNLBD(SIOTPTR),B'00001000'                    03S0448
*    IF JFCNSL = ON THEN               /*NON-STANDARD LABEL?         */
@RF00447 TM    JFCNSL(JFCBPTR),B'00000100'                      03S0449
         BNO   @RF00449                                         03S0449
*      SCTLABEL = ON;                  /*YES,SET SIOT NSL INDICATOR  */
         OI    SCTLABEL(SIOTPTR),B'00000100'                    03S0450
*    IF JFCBAL = ON THEN               /*USASI LABEL?                */
@RF00449 TM    JFCBAL(JFCBPTR),B'01000000'                      03S0451
         BNO   @RF00451                                         03S0451
*      SIOTASCI = ON;                  /*YES,SET SIOT USASI INDICATOR*/
         OI    SIOTASCI(SIOTPTR),B'00010000'                    03S0452
*  END;                                                         03S0453
*ELSE                                  /*LABEL TYPE NOT SPECIFIED    */
*  JFCSL = ON;                         /*DEFAULT TO SL               */
*                                                               03S0454
         B     @RC00439                                         03S0454
@RF00439 OI    JFCSL(JFCBPTR),B'00000010'                       03S0454
*IF DSSEQTUP ^= ZERO THEN              /*DATA SET SEQUENCE # SPECIF'D*/
@RC00439 L     @10,DSSEQTUP(,KEYTABP)                           03S0455
         LTR   @10,@10                                          03S0455
         BZ    @RF00455                                         03S0455
*  JFCBFLSQ = DSSEQTUP->TEXTUPAR(1:2); /*YES,MOVE SEQ. # TO JFCB     */
*                                                               03S0456
         MVC   JFCBFLSQ(2,JFCBPTR),TEXTUPAR(@10)                03S0456
*IF PASPRTUP ^= ZERO THEN              /*PASSWORD PROTECTION SPECIF'D*/
@RF00455 L     @10,PASPRTUP(,KEYTABP)                           03S0457
         LTR   @10,@10                                          03S0457
         BZ    @RF00457                                         03S0457
*  JFCBIND2 = JFCBIND2 × PASPRTUP->TEXTUPAR(1); /*YES,SET JFCB INDIC */
*                                                               03S0458
         OC    JFCBIND2(1,JFCBPTR),TEXTUPAR(@10)                03S0458
*RFY TEXTUNIT BASED(INOUTTUP);         /*BASE FOR INOUT TEXT UNIT    */
@RF00457 DS    0H                                               03S0460
*IF INOUTTUP ^= ZERO THEN              /*INPUT ONLY/OUTPUT ONLY SPEC?*/
         L     @10,INOUTTUP(,KEYTABP)                           03S0460
         LTR   @10,@10                                          03S0460
         BZ    @RF00460                                         03S0460
*  JFCBFLG2 = JFCBFLG2 × TEXTUPAR(1);  /*YES,SET JFCB INDICATORS     */
*                                                               03S0461
         OC    JFCBFLG2(1,JFCBPTR),TEXTUPAR(@10)                03S0461
*IF SCTSNEW = ON × SCTSMOD = ON        /*NEW OR MOD SPECIFIED?       */
*  × RETPDTUP ^= ZERO THEN             /*OR RETENTION PERIOD SPEC.?  */
@RF00460 TM    SCTSNEW(SIOTPTR),B'00000110'                     03S0462
         BNZ   @RT00462                                         03S0462
         L     @10,RETPDTUP(,KEYTABP)                           03S0462
         LTR   @10,@10                                          03S0462
         BZ    @RF00462                                         03S0462
@RT00462 DS    0H                                               03S0463
*  DO;                                 /*YES,PROCESS CREATE DATE     */
*    RFY YEARDAYS BASED(ADDR(JFCBCRDT)); /*BASE WORK MAP ON JFCB
*                                        CREATE DATE FIELD           */
*    WORKCHR4 = DATE;                  /*WORKCHR4 =  00 YY DD DF     */
         MVC   WORKCHR4(4),DATE                                 03S0465
*    CVB (DAYS,WORKCHR4(3:4));         /*SET CREATE DAYS DATE        */
         XC    @TS00001(8),@TS00001                             03S0466
         MVC   @TS00001+6(2),WORKCHR4+2                         03S0466
         CVB   @10,@TS00001                                     03S0466
         LA    @15,80                                           03S0466
         ALR   @15,JFCBPTR                                      03S0466
         STCM  @10,3,DAYS(@15)                                  03S0466
*    MVO (WORKCHR4,WORKCHR4(2));       /*WORKCHR2 = 00 00 0Y YF      */
         MVO   WORKCHR4(4),WORKCHR4+1(1)                        03S0467
*    CVB (YEAR,WORKCHR4(3:4));         /*SET CREATE DATE YEAR        */
         XC    @TS00001(8),@TS00001                             03S0468
         MVC   @TS00001+6(2),WORKCHR4+2                         03S0468
         CVB   @10,@TS00001                                     03S0468
         STC   @10,YEAR(,@15)                                   03S0468
*  END;                                                         03S0469
*                                                               03S0469
*RFY TEXTUNIT BASED(EXPDTTUP);         /*BASE FOR EXPIRATION DATE TU */
@RF00462 DS    0H                                               03S0471
*IF EXPDTTUP ^= ZERO THEN              /*EXPIRATION DATE SPECIFIED?  */
         SLR   @10,@10                                          03S0471
         L     @15,EXPDTTUP(,KEYTABP)                           03S0471
         CR    @15,@10                                          03S0471
         BE    @RF00471                                         03S0471
*  DO;                                                          03S0472
*    RFY YEARDAYS BASED(ADDR(JFCBXPDT)); /*BASE WORK MAP ON JFCB
*                                        EXPIRATION DATE FIELD       */
*    PACK (WORKCHR2,TEXTUPAR(1:2));    /*PACK EXPIRATION DATE YEAR   */
         PACK  WORKCHR2(2),TEXTUPAR(2,@15)                      03S0474
*    CVB (YEAR,WORKCHR2);              /*SET EXP DATE YEAR IN JFCB   */
         XC    @TS00001(8),@TS00001                             03S0475
         MVC   @TS00001+6(2),WORKCHR2                           03S0475
         CVB   @14,@TS00001                                     03S0475
         LA    @05,83                                           03S0475
         ALR   @05,JFCBPTR                                      03S0475
         STC   @14,YEAR(,@05)                                   03S0475
*    PACK (WORKCHR2,TEXTUPAR(3:5));    /*PACK EXPIRATION DATE DAYS   */
         PACK  WORKCHR2(2),TEXTUPAR+2(3,@15)                    03S0476
*    CVB (DAYS,WORKCHR2);              /*SET EXP DATE DAYS IN JFCB   */
         XC    @TS00001(8),@TS00001                             03S0477
         MVC   @TS00001+6(2),WORKCHR2                           03S0477
         CVB   @04,@TS00001                                     03S0477
         STCM  @04,3,DAYS(@05)                                  03S0477
*    IF YEARDAYS = ZERO                /*ZERO EXP. DATE SPECIFIED?   */
*      & DCBDSTUP ^= ZERO THEN         /*AND DCB DSN REF SPECIFIED?  */
         SLR   @04,@04                                          03S0478
         ICM   @04,7,YEARDAYS(@05)                              03S0478
         CR    @10,@04                                          03S0478
         BNE   @RF00478                                         03S0478
         C     @10,DCBDSTUP(,KEYTABP)                           03S0478
         BE    @RF00478                                         03S0478
*      YEARDAYS = 'FFFFFF'X;           /*YES,PREVENT OVERLAY BY DCB
*                                        REF TO DSNAME PROCESSING
*                                        IN JFCB HOUSEKEEPING        */
         MVC   YEARDAYS(3,@05),@CB02471                         03S0479
*  END;                                                         03S0480
*                                                               03S0480
@RF00478 DS    0H                                               03S0481
*RFY TEXTUNIT BASED(RETPDTUP);         /*BASE FOR RETENTION PERIOD TU*/
@RF00471 DS    0H                                               03S0482
*IF RETPDTUP ^= ZERO THEN              /*RETENTION PERIOD SPECIFIED? */
         L     @10,RETPDTUP(,KEYTABP)                           03S0482
         LTR   @10,@10                                          03S0482
         BZ    @RF00482                                         03S0482
*  DO;                                                          03S0483
*    RFY YEARDAYS BASED(ADDR(JFCBXPDT)); /*BASE WORK MAP ON JFCB
*                                        EXPIRATION DATE FIELD       */
*    YEARDAYS = JFCBCRDT;              /*CREATE DATE TO EXPDT DATE   */
         LA    @15,83                                           03S0485
         ALR   @15,JFCBPTR                                      03S0485
         MVC   YEARDAYS(3,@15),JFCBCRDT(JFCBPTR)                03S0485
*    DAYS = DAYS + TEXTUPAR(1:2);      /*ADD RETENTION PERIOD        */
         ICM   @14,12,DAYS(@15)                                 03S0486
         SRA   @14,16                                           03S0486
         SLR   @05,@05                                          03S0486
         ICM   @05,3,TEXTUPAR(@10)                              03S0486
         ALR   @14,@05                                          03S0486
         STCM  @14,3,DAYS(@15)                                  03S0486
*    YEAR = YEAR + DAYS / 365;         /*ADJUST FOR CORRECT YEAR     */
         LA    @10,365                                          03S0487
         LR    @00,@14                                          03S0487
         SRDA  @00,32                                           03S0487
         DR    @00,@10                                          03S0487
         SLR   @00,@00                                          03S0487
         IC    @00,YEAR(,@15)                                   03S0487
         ALR   @01,@00                                          03S0487
         STC   @01,YEAR(,@15)                                   03S0487
*    DAYS = DAYS // 365;               /*ADJUST FOR CORRECT DAYS     */
         ST    @15,@TF00001                                     03S0488
         SRDA  @14,32                                           03S0488
         DR    @14,@10                                          03S0488
         L     @15,@TF00001                                     03S0488
         STCM  @14,3,DAYS(@15)                                  03S0488
*    IF YEAR > 99 THEN                 /*CREATE DATE + RETENTION
*                                        PERIOD=EXPDT IN 21ST CENTURY*/
         L     @01,@TF00001                                     03S0489
         CLI   YEAR(@01),99                                     03S0489
         BNH   @RF00489                                         03S0489
*      DO;                                                      03S0490
*        YEAR = 99;                    /*YES,SET EXPDT DATE TO LAST  */
         L     @01,@TF00001                                     03S0491
         MVI   YEAR(@01),X'63'                                  03S0491
*        DAYS = 365;                   /*DAY IN 20TH CENTURY         */
         L     @01,@TF00001                                     03S0492
         STCM  @10,3,DAYS(@01)                                  03S0492
*      END;                                                     03S0493
*  END;                                                         03S0494
@RF00489 DS    0H                                               03S0495
*                                                               02S0495
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - FCBUCS                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - FCB AND UCS TEXT UNIT RELATED PROCESSING      */
*/*                                                                  */
*/* FUNCTION - PROCESS FCB IMAGE, FCB ALIGN/VERIFY, UCS, UCS FOLD,   */
*/*   AND UCS VERIFY TEXT UNITS                                      */
*/*                                                                  */
*/*   OPERATION - THE JFCB IS FILLED IN FOR SPECIFIED TEXT UNITS.    */
*/*                                                                  */
*/* INPUT                                                            */
*/*   KEYTABLE - TO DETERMINE WHAT TEXT UNITS ARE SPECIFIED          */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   JFCB FILLED IN FOR SPECIFIED TEXT UNITS.                       */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0495
*                                                               03S0495
*                                                               03S0495
*RFY TEXTUNIT BASED(FCBIMTUP);         /*BASE FOR FCB IMAGE ID TEXTUN*/
@RF00482 DS    0H                                               03S0496
*IF FCBIMTUP ^= ZERO THEN              /*FCB IMAGE SPECIFIED?        */
         L     @10,FCBIMTUP(,KEYTABP)                           03S0496
         LTR   @10,@10                                          03S0496
         BZ    @RF00496                                         03S0496
*  JFCFCBID(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,MOVE TO JFCB   */
*                                                               03S0497
         ICM   @15,12,TEXTULNG(@10)                             03S0497
         SRA   @15,16                                           03S0497
         BCTR  @15,0                                            03S0497
         EX    @15,@SM02545                                     03S0497
*RFY TEXTUNIT BASED(FCBAVTUP);         /*BASE FOR FCB ALIGN/VERIFY   */
@RF00496 DS    0H                                               03S0499
*IF FCBAVTUP ^= ZERO THEN              /*FCB ALIGN/VERIFY SPECIFIED? */
         L     @10,FCBAVTUP(,KEYTABP)                           03S0499
         LTR   @10,@10                                          03S0499
         BZ    @RF00499                                         03S0499
*  JFCUCSOP = JFCUCSOP × TEXTUPAR(1);  /*YES,SET JFCB INDICATOR      */
*                                                               03S0500
         OC    JFCUCSOP(1,JFCBPTR),TEXTUPAR(@10)                03S0500
*RFY TEXTUNIT BASED(UCSTUP);           /*BASE FOR UCS TEXTUNIT       */
@RF00499 DS    0H                                               03S0502
*IF UCSTUP ^= ZERO THEN                /*UCS SPECIFIED?              */
         L     @10,UCSTUP(,KEYTABP)                             03S0502
         LTR   @10,@10                                          03S0502
         BZ    @RF00502                                         03S0502
*  JFCUCSID(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*YES,MOVE TO JFCB   */
*                                                               03S0503
         ICM   @15,12,TEXTULNG(@10)                             03S0503
         SRA   @15,16                                           03S0503
         BCTR  @15,0                                            03S0503
         EX    @15,@SM02547                                     03S0503
*IF UFOLDTUP ^= ZERO THEN              /*UCS FOLD MODE SPECIFIED?    */
@RF00502 L     @10,UFOLDTUP(,KEYTABP)                           03S0504
         LTR   @10,@10                                          03S0504
         BZ    @RF00504                                         03S0504
*  JFCFOLD = ON;                       /*YES,SET JFCB INDICATOR      */
*                                                               03S0505
         OI    JFCFOLD(JFCBPTR),B'01000000'                     03S0505
*IF UVRFYTUP ^= ZERO THEN              /*UCS VERIFY SPECIFIED?       */
@RF00504 L     @10,UVRFYTUP(,KEYTABP)                           03S0506
         LTR   @10,@10                                          03S0506
         BZ    @RF00506                                         03S0506
*  JFCVER = ON;                        /*YES,SET JFCB INDICATOR      */
         OI    JFCVER(JFCBPTR),B'00010000'                      03S0507
*                                                               02S0508
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DCB                                               */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DCB RELATED TEXT UNIT PROCESSING              */
*/*                                                                  */
*/* FUNCTION - DCB DSNAME REFERENCE, DCB DDNAME REFERENCE, AND       */
*/*   DCB ATTRIBUTES TEXT UNIT PROCESSING                            */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     IF DCB DSNAME REFERENCE IS SPECIFIED, THE DSNAME TABLE (DSNT)*/
*/*     IS UPDATED (SEE DSNTPROC SEGMENT), AND SIOT INDICATORS       */
*/*     ARE SET. (THE DSNAME REFERENCE WILL BE RESOLVED BY JFCB      */
*/*     HOUSEKEEPING.)                                               */
*/*                                                                  */
*/*     IF DCB DDNAME REFERENCE IS SPECIFIED, THE DDNAME SEARCH      */
*/*     ROUTINE,IEFDB4FC, IS INVOKED TO FIND THE DSAB ASSOCIATED     */
*/*     WITH THE REFERENCED DDNAME. IF NOT FOUND, AN ERROR CODE      */
*/*     IS SET. IF FOUND, DCB INFORMATION FROM THE REFERENCED        */
*/*     DDNAME'S JFCB IS COPIED.  FOR TSO USER'S, THE LABEL PARM     */
*/*     EXPIRATION DATE IN/OUT OPTION AND DIAGNOSE = TRACE   @YM05556*/
*/*     INDICATOR (JFCTRACE) ARE ALSO COPIED                 @YM05556*/
*/*     IF THEY ARE NOT SPECIFIED. THIS IS                           */
*/*     DONE TO BE COMPATIBLE WITH THE OS/VS2 REL. 1 TSO 'USING'     */
*/*     FUNCTION OF DYNAMIC ALLOCATION ('USING' IS ACCOMPLISHED      */
*/*     IN REL. 2 VIA DCB DDNAME REFERENCE).                         */
*/*                                                                  */
*/*     IF THERE WAS NO ERROR                                        */
*/*     ABOVE AND IF THE CONTROL FUNCTION MAP INDICATES DCB PARMS    */
*/*     WERE SPECIFIED, IEFDB417 IS INVOKED TO SET THE DCB PARMS IN  */
*/*     THE JFCB.                                                    */
*/*                                                                  */
*/* INPUT                                                            */
*/*   ASCB - TO DETERMINE IF USER IS A TSO USER                      */
*/*   KEYTABLE - TO DETERMINE WHICH TEXT UNITS ARE SPECIFIED         */
*/*   ALLOC CONTROL FUNCTION MAP - TO DETERMINE IF ANY DCB           */
*/*     PARMS ARE SPECIFIED                                          */
*/*   ADDRESS OF FIRST ALLOCATED DSAB                                */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   JFCB FILLED IN FOR SPECIFIED TEXT UNITS                        */
*/*   DSNT - UPDATED IF DCB DSNAME REFERENCE IS SPECIFIED.           */
*/*   ERRCODE - SET IF THE REFERENCED DDNAME NOT FOUND               */
*/*                                                                  */
*/********************************************************************/
*RESPECIFY TEXTUNIT BASED(DCBDSTUP);   /*BASE FOR DCB REF TO DSN TU  */
@RF00506 DS    0H                                               03S0509
*IF DCBDSTUP ^= ZERO THEN              /*DCB REF TO DSNAME SPECIFIED?*/
         L     @10,DCBDSTUP(,KEYTABP)                           03S0509
         LTR   @10,@10                                          03S0509
         BZ    @RF00509                                         03S0509
*  DO;                                                          03S0510
*    REFRNCTU = DCBDSTUP;              /*ADDR OF DCB REFERENCE TO
*                                           DSN TEXT UNIT            */
         LR    REFRNCTU,@10                                     03S0511
*    CALL DSNTPROC;                    /*PUT ENTRY IN DSNT           */
         BAL   @14,DSNTPROC                                     03S0512
*    SIODDSNL = LENGHDSN;              /*LENGTH OF DSN IN DSNT       */
         STC   LENGHDSN,SIODDSNL(,SIOTPTR)                      03S0513
*    SIODSNTE = OFFSET;                /*OFFSET TO DSNT ENTRY        */
         STH   OFFSET,SIODSNTE(,SIOTPTR)                        03S0514
*  END;                                                         03S0515
*                                                               03S0515
*RESPECIFY TEXTUNIT BASED(DCBDDTUP);   /*BASE FOR DCB REF TO DDN TU  */
@RF00509 DS    0H                                               03S0517
*IF DCBDDTUP ^= ZERO THEN              /*DCB REF TO DDNAME SPECIFIED?*/
         L     @10,DCBDDTUP(,KEYTABP)                           03S0517
         LTR   @10,@10                                          03S0517
         BZ    @RF00517                                         03S0517
*  DO;                                                          03S0518
*    REFDDNAM = '';                    /*YES, CLEAR 8 BYTE WORK AREA */
         MVI   REFDDNAM,C' '                                    03S0519
         MVC   REFDDNAM+1(7),REFDDNAM                           03S0519
*    REFDDNAM(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*SET REF DDNAME   */
         ICM   @15,12,TEXTULNG(@10)                             03S0520
         SRA   @15,16                                           03S0520
         BCTR  @15,0                                            03S0520
         EX    @15,@SM02549                                     03S0520
*    CALL IEFDB4FC(DSQFRSTP,ADDR(REFDDNAM),ADDR(DSABPTR)); /*FIND REF*/
         L     @10,@PC00001                                     03S0521
         L     @10,JSCBPTR(,@10)                                03S0521
         L     @10,JSCDSABQ(,@10)                               03S0521
         LA    @10,DSQFRSTP(,@10)                               03S0521
         ST    @10,@AL00001                                     03S0521
         LA    @10,REFDDNAM                                     03S0521
         ST    @10,@TF00001                                     03S0521
         LA    @10,@TF00001                                     03S0521
         ST    @10,@AL00001+4                                   03S0521
         LA    @10,DSABPTR                                      03S0521
         ST    @10,@TF00002                                     03S0521
         LA    @10,@TF00002                                     03S0521
         ST    @10,@AL00001+8                                   03S0521
         L     @15,@CV00171                                     03S0521
         LA    @01,@AL00001                                     03S0521
         BALR  @14,@15                                          03S0521
*    IF DSABPTR ^= ZERO THEN           /*REFERENCED DDNAME FOUND?    */
         L     @10,DSABPTR                                      03S0522
         LTR   @10,@10                                          03S0522
         BZ    @RF00522                                         03S0522
*      DO;                                                      03S0523
*        REFJFCBP = DSABPTR->DSABSIOT->SJFCBPTR; /*YES, SET PTR TO
*                                        JFCB ASSOCIATED WITH REF DDN*/
         L     @10,DSABSIOT(,@10)                               03S0524
         L     REFJFCBP,SJFCBPTR(,@10)                          03S0524
*        DCBJFCB = REFJFCBP->DCBJFCB;  /*COPY DCB INFO INTO NEW JFCB */
         MVC   DCBJFCB(28,JFCBPTR),DCBJFCB(REFJFCBP)            03S0525
*        IF REFJFCBP->JFCBBUFF = ON THEN /*REF DDN HAVE BUFFER OFFSET*/
         TM    JFCBBUFF(REFJFCBP),B'00000010'                   03S0526
         BNO   @RF00526                                         03S0526
*          DO;                                                  03S0527
*            JFCBUFOF = REFJFCBP->JFCBUFOF; /*YES,COPY BUFFER OFFSET */
         IC    @10,JFCBUFOF(,REFJFCBP)                          03S0528
         STC   @10,JFCBUFOF(,JFCBPTR)                           03S0528
*            JFCBBUFF = ON;            /*SET BUFOFF PRESENT INDICATOR*/
         OI    JFCBBUFF(JFCBPTR),B'00000010'                    03S0529
*          END;                                                 03S0530
*        IF ASCBTSB ^= ZERO THEN       /*TSO USER?                   */
@RF00526 SLR   @10,@10                                          03S0531
         L     @03,@PC00001                                     03S0531
         L     @03,ASCBPTR(,@03)                                03S0531
         C     @10,ASCBTSB(,@03)                                03S0531
         BE    @RF00531                                         03S0531
*          DO;                         /*YES, DO COMPATIBILITY COPY  */
*            IF EXPDTTUP = ZERO THEN   /*EXPIRATION DATE SPECIFIED?  */
         C     @10,EXPDTTUP(,KEYTABP)                           03S0533
         BNE   @RF00533                                         03S0533
*              JFCBXPDT = REFJFCBP->JFCBXPDT; /*NO, COPY EXPIR. DATE */
         MVC   JFCBXPDT(3,JFCBPTR),JFCBXPDT(REFJFCBP)           03S0534
*            IF INOUTTUP = ZERO THEN   /*INOUT OPTION SPECIFIED?     */
@RF00533 L     @10,INOUTTUP(,KEYTABP)                           03S0535
         LTR   @10,@10                                          03S0535
         BNZ   @RF00535                                         03S0535
*              DO;                     /*NO,COPY OPTIONS             */
*                IF REFJFCBP->JFCINOP = ON THEN /*INPUT ONLY OPTION? */
         TM    JFCINOP(REFJFCBP),B'10000000'                    03S0537
         BNO   @RF00537                                         03S0537
*                  JFCINOP = ON;       /*YES, SET INPUT ONLY INDIC.  */
         OI    JFCINOP(JFCBPTR),B'10000000'                     03S0538
*                IF REFJFCBP->JFCOUTOP = ON THEN /*OUTPUT ONLY OPT?*/
@RF00537 TM    JFCOUTOP(REFJFCBP),B'01000000'                   03S0539
         BNO   @RF00539                                         03S0539
*                  JFCOUTOP = ON;      /*YES, SET OUTPUT ONLY INDIC. */
         OI    JFCOUTOP(JFCBPTR),B'01000000'                    03S0540
*                IF REFJFCBP->JFCTRACE = ON THEN /*DIAGNOSE = TRACE ON?
*                                                            @YM05556*/
@RF00539 TM    JFCTRACE(REFJFCBP),B'00000100'                   03S0541
         BNO   @RF00541                                         03S0541
*                  JFCTRACE = ON;      /*SET TRACE INDIC.    @YM05556*/
         OI    JFCTRACE(JFCBPTR),B'00000100'                    03S0542
*              END;                                             03S0543
*          END;                                                 03S0544
*      END;                                                     03S0545
*    ELSE                              /*REFERENCED DDNAME NOT FOUND */
*      ERRCODE = RCDCBRNF;             /*SET DCB REF TO DDN NOT FOUND*/
         B     @RC00522                                         03S0546
@RF00522 L     @10,@PC00001+20                                  03S0546
         MVC   ERRCODE(2,@10),@CB00998                          03S0546
*  END;                                                         03S0547
*                                                               03S0547
@RC00522 DS    0H                                               03S0548
*IF DCBSPCSW = ON                      /*DCB PARMS SPECIFIED?        */
*  & ERRCODE = ZERO THEN               /*AND NO ERROR ABOVE?         */
@RF00517 L     @10,@PC00001+16                                  03S0548
         TM    DCBSPCSW(@10),B'00000100'                        03S0548
         BNO   @RF00548                                         03S0548
         L     @10,@PC00001+20                                  03S0548
         ICM   @15,3,ERRCODE(@10)                               03S0548
         BNZ   @RF00548                                         03S0548
*  CALL IEFDB417 (JFCBPTR,KEYTBPTR);   /*YES,SET DCB PARMS SPECIFIED
*                                        IN TEXTUNITS INTO JFCB      */
         ST    JFCBPTR,@TF00001                                 03S0549
         LA    @10,@TF00001                                     03S0549
         ST    @10,@AL00001                                     03S0549
         L     @10,@PC00001+8                                   03S0549
         ST    @10,@AL00001+4                                   03S0549
         L     @15,@CV00170                                     03S0549
         LA    @01,@AL00001                                     03S0549
         BALR  @14,@15                                          03S0549
*                                                               02S0550
*IF (SU32BIT=ON &                      /*PROTECT ONLY VALID IF SU32
*                                        INSTALLED           @G32HPPJ*/
*   PROTTUP ^= ZERO)  THEN             /*WAS PROTECT SPECIFIED  02S0550
*                                                            @G32HPPJ*/
@RF00548 L     @10,CVTPTR                                       02S0550
         L     @10,CVTIHASU(,@10)                               02S0550
         TM    SU32BIT(@10),B'10000000'                         02S0550
         BNO   @RF00550                                         02S0550
         L     @10,PROTTUP(,KEYTABP)                            02S0550
         LTR   @10,@10                                          02S0550
         BZ    @RF00550                                         02S0550
*   SIOTPROT = ON;                     /*YES, SET INDICATOR  @G32HPPJ*/
         OI    SIOTPROT(SIOTPTR),B'10000000'                    02S0551
*IF CLOSETUP ^= ZERO THEN              /*UNALLOC AT CLOSE SPECIFIED? */
@RF00550 L     @10,CLOSETUP(,KEYTABP)                           02S0552
         LTR   @10,@10                                          02S0552
         BZ    @RF00552                                         02S0552
*  SIOCLUNL = ON;                      /*YES, SET SIOT INDICATOR     */
*                                                               02S0553
         OI    SIOCLUNL(SIOTPTR),B'10000000'                    02S0553
*IF CATLOGSW = ON THEN                 /*IS DATA SET A CATALOG?      */
@RF00552 L     @10,@PC00001+16                                  02S0554
         TM    CATLOGSW(@10),B'00000010'                        02S0554
         BNO   @RF00554                                         02S0554
*  DO;                                 /*YES,SET INDICATORS          */
*    SIOTCATL = ON;                    /*SET CATALOG D.S. BIT IN SIOT *
         OI    SIOTCATL(SIOTPTR),B'01000000'                    02S0556
*    SIOTGDGA = ON;                    /*INDICATE GENERATED SIOT     */
         OI    SIOTGDGA(SIOTPTR),B'01000000'                    02S0557
*    JFCENT = ON;                      /*INDICATE GENERATED JFCB     */
         OI    JFCENT(JFCBPTR),B'00000100'                      02S0558
*  END;                                                         02S0559
*                                                               02S0559
*RFY TEXTUNIT BASED(MSVGPTUP);         /*ADDR MSVGP TEXT UNIT@Y30LPPD*/
@RF00554 DS    0H                                               02S0561
*IF SCTDUMMY = OFF &                   /*NOT DUMMY DATA SET? @Y30LPPD*/
*  MSVGPTUP ^= ZERO THEN               /*MSVGP SPECIFIED?    @Y30LPPD*/
         TM    SCTDUMMY(SIOTPTR),B'10000000'                    02S0561
         BNZ   @RF00561                                         02S0561
         L     @10,MSVGPTUP(,KEYTABP)                           02S0561
         LTR   @10,@10                                          02S0561
         BZ    @RF00561                                         02S0561
*  DO;                                 /*YES                 @Y30LPPD*/
*    JFCMSVGP(1:TEXTULNG) = TEXTUPAR(1:TEXTULNG); /*MOVE SPECIFIED
*                                        MSVGP NAME TO JFCB  @Y30LPPD*/
         ICM   @15,12,TEXTULNG(@10)                             02S0563
         SRA   @15,16                                           02S0563
         BCTR  @15,0                                            02S0563
         EX    @15,@SM02551                                     02S0563
*    JFCBMSGP = ON;                    /*INDICATE MSVGP KEYWORD WAS
*                                        SPECIFIED BY USER   @Y30LPPD*/
         OI    JFCBMSGP(JFCBPTR),B'00100000'                    02S0564
*    SIOTPRIV = ON;                    /*SET PRIVATE IN SIOT @Y30LPPD*/
         OI    SIOTPRIV(SIOTPTR),B'00100000'                    02S0565
*  END;                                /*                    @Y30LPPD*/
*  END;                                                         01S0567
*ELSE                                  /*AT ALLOCATION LIMIT         */
*  ERRCODE=RCLIMITS;                   /*SET LIMIT ERROR REASON CODE */
         B     @RC00085                                         01S0568
@RF00085 L     @10,@PC00001+20                                  01S0568
         MVC   ERRCODE(2,@10),@CB00996                          01S0568
*RETURN CODE(0);                       /*ALWAYS PASS BACK R15 = 0    */
@RC00085 L     @13,4(,@13)                                      01S0569
         L     @00,@SIZDATD                                     01S0569
         LR    @01,@11                                          01S0569
         FSPACE   R,LV=(0),A=(1)
         SLR   @15,@15                                          01S0569
         L     @14,12(,@13)                                     01S0569
         LM    @00,@12,20(@13)                                  01S0569
         BR    @14                                              01S0569
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - GENDSNAM                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - GENERATE DSNAME ROUTINE                       */
*/*                                                                  */
*/* FUNCTION - GENERATE A UNIQUE DSNAME IN THE JFCB DSNAME FIELD.    */
*/*   THE FORMAT IS 'SYSYYDDD.TXXXXXX.RA000.JOBNAME.ZZZZZZZZ' WHERE  */
*/*   'YYDDD' IS THE CURRENT DATE, 'XXXXXX' IS THE CURRENT TIME, 'R' */
*/*   INDICATES A TEMPORARY DATA SET, 'A' INDICATES THE NAME IS      */
*/*   GENERATED BY THE VS/2 SYSTEM, 'JOBNAME' IS THE NAME OF THE JOB,*/
*/*   AND 'ZZZZZZZZ' IS THE NAME IN THE &NAME, IF SPECIFIED, OR      */
*/*   'R' PLUS A UNIQUE NUMBER.  THE NUMBER USED IS JSCDDNNO,@ZA02396*/
*/*   THE COUNT OF DDNAMES GENERATED FOR THE JOBSTEP.        @ZA02396*/
*/*   THIS IS DONE TO AVOID DUPLICATE NAMES.                 @ZA02396*/
*/*                                                                  */
*/*   OPERATION - THE STATIC PORTION OF THE NAME IS PLACED IN THE    */
*/*     JFCB. THE DATE AND TIME ARE PLACED IN THE NAME. THE JOBNAME  */
*/*     FROM THE JCT IS PLACED IN THE NAME. A PERIOD AND THE SIOT    */
*/*     ALTERNATE NAME ARE PLACED IN THE NAME AFTER THE LAST         */
*/*     CHARACTER IN THE JOB NAME, UNLESS THERE IS NO ALTERNATE NAME.*/
*/*     IN THIS CASE, .R + A UNIQUE NUMBER IS PLACED AFTER   @ZA02396*/
*/*     JOBNAME. SEE FUNCTION ABOVE.                         @ZA02396*/
*/*                                                                  */
*/* INPUT                                                            */
*/*   CURRENT DATE AND TIME                                          */
*/*   NAME PART OF &NAME = SIOT ALTERNATE NAME                       */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   GENERATED NAME IN JFCB DSNAME FILED                            */
*/*                                                                  */
*/********************************************************************/
*GENDSNAM: PROC;                       /*INTERNAL PROC-GENERATE DSN  */
@EL00001 L     @13,4(,@13)                                      02S0570
@EF00001 L     @00,@SIZDATD                                     02S0570
         LR    @01,@11                                          02S0570
         FSPACE   R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  02S0570
         BR    @14                                              02S0570
GENDSNAM STM   @14,@12,12(@13)                                  02S0570
*RFY (JFCBPTR,SIOTPTR,KEYTABP) RESTRICTED;                      02S0571
*JFCBDSNM(1:LENGTH(GENNAME1)) = GENNAME1; /*BASE OF GEN NAME TO JFCB */
         MVC   JFCBDSNM(23,JFCBPTR),GENNAME1                    02S0572
*UNPK (YYDDD,DATE(2:4));               /*DATE TO JFCB GENERATED NAME */
         UNPK  YYDDD(5,JFCBPTR),DATE+1(3)                       02S0573
*TIME(4) = TIME(4) × '0F'X;            /*PREPARE TIME BUFFER FOR UNPK*/
         OI    TIME+3,X'0F'                                     02S0574
*MVO (TIME,TIME(1:3));                 /*TIME = 0H HM MS SF          */
         MVO   TIME(4),TIME(3)                                  02S0575
*UNPK (TTTTTT,TIME);                   /*TIME TO JFCB GENERATED NAME */
         UNPK  TTTTTT(6,JFCBPTR),TIME(4)                        02S0576
*JOBNAME = JCTJNAME;                   /*JOBNAME TO JFCB GEN NAME    */
         L     @10,@PC00001                                     02S0577
         L     @10,JCTPTR(,@10)                                 02S0577
         MVC   JOBNAME(8,JFCBPTR),JCTJNAME(@10)                 02S0577
*I=2;                                  /*I WILL INDEX INTO JOBNAME   */
         LA    I,2                                              02S0578
*DO WHILE(JOBNAME(I)^=' ');            /*FIND JOBNAME END            */
         B     @DE00579                                         02S0579
@DL00579 DS    0H                                               02S0580
*  I = I + 1;                                                   02S0580
         AL    I,@CF00072                                       02S0580
*END;                                                           02S0581
@DE00579 LR    @10,JFCBPTR                                      02S0581
         ALR   @10,I                                            02S0581
         CLI   JOBNAME-1(@10),C' '                              02S0581
         BNE   @DL00579                                         02S0581
*WORKPTR = ADDR(JOBNAME(I));           /*ADDR OF JOBNAME END IN JFCB */
         LA    WORKPTR,JOBNAME-1(I,JFCBPTR)                     02S0582
*WORKPTR -> DOT = '.';                 /*SET . IF JFCB NAME  @ZA02396*/
         MVI   DOT(WORKPTR),C'.'                                02S0583
*IF SCTANAME(1) = ' ' THEN             /*&NAME SPECIFIED?            */
         CLI   SCTANAME(SIOTPTR),C' '                           02S0584
         BNE   @RF00584                                         02S0584
*   DO;                                /*                    @ZA02396*/
*     GENDSNUM = JSCDDNNO;             /*USE DD NAME COUNTER TO 02S0586
*                                        GENERATE UNIQUE TEMPORARY
*                                        DATA SET NAME       @ZA02396*/
         L     @10,@PC00001                                     02S0586
         L     @10,JSCBPTR(,@10)                                02S0586
         LH    @15,JSCDDNNO(,@10)                               02S0586
         LR    GENDSNUM,@15                                     02S0586
*     CVD(GENDSNUM,DSNUM1);            /*CONVERT HEX TO PRINTABLE
*                                        CHARACTERS          @ZA02396*/
         CVD   GENDSNUM,DSNUM1                                  02S0587
*     UNPK(DSNUM2,DSNUM1);             /*                    @ZA02396*/
         UNPK  DSNUM2(8),DSNUM1(8)                              02S0588
*     DSNUM2(8) = DSNUM2(8) × CHGSIGN; /*CHANGE SIGN OF LAST CHARACTER
*                                                            @ZA02396*/
         OI    DSNUM2+7,B'11110000'                             02S0589
*     DSNUM2(1) = GENNAME2;            /*INSERT 'R'          @ZA02396*/
         MVC   DSNUM2(1),GENNAME2                               02S0590
*     WORKPTR->AMPNAME = DSNUM2;       /*MOVE TO JFCB NAME   @ZA02396*/
         MVC   AMPNAME(8,WORKPTR),DSNUM2                        02S0591
*      DO; /*MODESET  KEYADDR(KEYZERO)*/                        02S0592
*        SPKA (KEYZERO); /*SET PSW KEY*/                        02S0593
         L     @01,KEYZERO                                      02S0593
         SPKA  0(@01)                                           02S0593
*      END; /*MODESET  KEYADDR(KEYZERO)*/       /*GET INTO KEY ZERO   @
*A02396*/                                                       02S0594
*     JSCDDNNO = JSCDDNNO + ONE;       /*UPDATE DDNAME COUNTER SO THAT
*                                        NEXT DSNAME WILL BE UNIQUE
*                                        EVEN IF NO DDNAME GENERATED
*                                                            @ZA02396*/
         AL    @15,@CF00072                                     02S0595
         STH   @15,JSCDDNNO(,@10)                               02S0595
*      DO; /*MODESET  EXTKEY(SCHED)*/                           02S0596
*        SPKA (16); /*SET PSW KEY*/                             02S0597
         LA    @10,16                                           02S0597
         SPKA  0(@10)                                           02S0597
*      END; /*MODESET  EXTKEY(SCHED)*/          /*RETURN TO SCHED KEY @
*A02396*/                                                       02S0598
*   END;                               /*                    @ZA02396*/
*ELSE                                  /*YES-&NAME SPECIFIED         */
*  DO;                                                          02S0600
         B     @RC00584                                         02S0600
@RF00584 DS    0H                                               02S0601
*    WORKPTR->AMPNAME = SCTANAME;      /*&NAME TO JFCB GEN NAME W/O &*/
         MVC   AMPNAME(8,WORKPTR),SCTANAME(SIOTPTR)             02S0601
*  END;                                                         02S0602
*SIOTGDSN = ON;                        /*SET SIOT GENERATED DSN BIT  */
@RC00584 DS    0H                                               02S0604
*SIOTQDSN = ON;                        /*SET SIOT QUALIFIED DSN BIT  */
         OI    SIOTGDSN(SIOTPTR),B'00011000'                    02S0604
*END GENDSNAM;                                                  02S0605
@EL00002 DS    0H                                               02S0605
@EF00002 DS    0H                                               02S0605
@ER00002 LM    @14,@12,12(@13)                                  02S0605
         BR    @14                                              02S0605
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DSNTPROC                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DATASET NAME TABLE (DSNT) PROCESSING          */
*/*                                                                  */
*/* FUNCTION - ADD AN ENTRY TO THE DATASET NAME TABLE FOR DCB OR     */
*/*   VOLUME REFERENCE TO A DATASET NAME. RETURN THE OFFSET OF THE   */
*/*   NAME IN THE DSNT, AND THE ACTUAL LENGTH OF DATASET NAME.       */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     DETERMINE THE ACTUAL LENGTH OF THE DSNAME SINCE              */
*/*     IT MAY BE PADDED WITH BLANKS IN THE INPUT TEXT UNIT.         */
*/*                                                                  */
*/*     IF THE DSNT ALREADY EXISTS, READ THE LAST RECORD (BY READING */
*/*     ONE RECORD AT A TIME, STARTING WITH THE FIRST) USING THE SWA */
*/*     MANAGER INTERFACE ROUTINE, IEFAB4F7.                         */
*/*                                                                  */
*/*     IF THE DSNT DOESN'T EXIST OR THE LAST RECORD DOES NOT HAVE   */
*/*     ENOUGH ROOM FOR THE INPUT DATASET NAME, USE IEFAB4F7 TO      */
*/*     ASSIGN A NEW RECORD.  THE HEADER OF THE ASSIGNED RECORD IS   */
*/*     INITIALIZED BY THIS ROUTINE.                                 */
*/*                                                                  */
*/*     WHEN THE ASSIGN IS COMPLETE OR IF IT WAS NOT NECESSARY, THE  */
*/*     INPUT DATASET NAME IS ADDED TO THE TABLE.  THE OFFSET OF THIS*/
*/*     NEW ENTRY IS DETERMINED AND THE SCT IS UPDATED TO REFLECT    */
*/*     THE NEW NUMBER OF BYTES USED IN THE DSNT.                    */
*/*                                                                  */
*/*     THE UPDATED DSNT RECORD(S) IS(ARE) WRITTEN VIA THE SWA       */
*/*     MANAGER INTERFACE ROUTINE.  (THIS IS NECESSARY SINCE THE     */
*/*     DSNT WILL HAVE TO BE READ BY JFCB HOUSEKEEPING BEFORE THE    */
*/*     TABLES WOULD BE WRITTEN AT THE END OF SVC99 CONTROL.) THE    */
*/*     EPA(S) FOR THIS WRITE WILL HAVE BEEN FILLED IN BY THE SWA    */
*/*     MANAGER INTERFACE ROUTINE: THE EPA FOR THE LAST DSNT RECORD  */
*/*     WAS FILLED IN WHEN IT WAS READ, AND THE EPA FOR THE NEW      */
*/*     DSNT RECORD WAS FILLED IN DURING THE ASSIGN.                 */
*/*                                                                  */
*/*     AFTER THE WRITE IS DONE, IF A RECORD WAS ASSIGNED,   @YM08602*/
*/*     IT IS NOW CHAINED INTO EITHER THE SCT (IF IT IS THE  @YM08602*/
*/*     FIRST DSNT RECORD), OR INTO THE PREVIOUSLY LAST DSNT @YM08602*/
*/*     RECORD. THIS IS DONE NOW TO PREVENT ANY PROBLEMS     @YM08602*/
*/*     READING IN THE DSNT ON SUBSEQUENT CALLS TO SVC99,    @YM08602*/
*/*     SHOULD THIS ROUTINE LOSE CONTROL WITH THE RECORDS    @YM08602*/
*/*     CHAINED, BUT BEFORE THE WRITE WAS DONE.              @YM08602*/
*/*                                                                  */
*/*     SINCE THE SCT IS ALWAYS UPDATED BY THIS ROUTINE, IF AN EPA   */
*/*     FOR THE SCT IS NOT ALREADY ON THE CHAIN, AN EPA IS GOTTEN,   */
*/*     FILLED IN AND ADDED TO THE CHAIN. (THE SCT IS NOT WRITTEN    */
*/*     HERE SINCE JFCB HOUSEKEEPING WILL NOT ATTEMPT TO READ IT.)   */
*/*                                                                  */
*/* INPUT -                                                          */
*/*   REFRNCTU - ADDRESS OF THE VOLUME OR DCB DSN REFERENCE TEXT UNIT*/
*/*   SCTLDSTB - NUMBER OF BYTES USED IN DSNT                        */
*/*   SCTADSTB - SVA OF FIRST DSNT RECORD OR ZERO IF THE TABLE DOES  */
*/*              NOT YET EXIST                                       */
*/*   LASTEPAP - ADDRESS OF LAST EPA OF RECORDS TO BE WRITTEN        */
*/*   EPASCTSW - IF ON, INDICATES SCT EPA ALREADY ON CHAIN           */
*/*                                                                  */
*/* OUTPUT-                                                          */
*/*   LENGHDSN - ACTUAL LENGTH OF DSNAME IN INPUT TEXT UNIT          */
*/*   OFFSET   - OFFSET OF ENTRY IN DSNT                             */
*/*   SCTLDSTB - NUMBER OF BYTES USED IN DSNT                        */
*/*   SCTADSTB - SVA OF FIRST DSNT RECORD                            */
*/*   EPASCTSW - ON, INDICATING SCT EPA ON CHAIN                     */
*/*   LASTEPAP - ADDRESS OF EPA FOR SCT IF EPA FOR SCT NOT ALREADY ON*/
*/*              THE EPA CHAIN OF RECORDS TO BE WRITTEN              */
*/*   NEW ENTRY MADE IN DSNT                                         */
*/*                                                                  */
*/********************************************************************/
*DSNTPROC:PROC;                                                 02S0606
DSNTPROC STM   @14,@03,@SA00003                                 02S0606
         STM   @06,@12,@SA00003+24                              02S0606
*EPAS=EPAS && EPAS;                    /*CLEAR THE EPA CORE          */
         XC    EPAS(32),EPAS                                    02S0607
*RFY TEXTUNIT BASED(REFRNCTU);         /*REFERENCE DSNAME TEXT UNIT  */
*DO LENGHDSN=TEXTULNG TO 1 BY -1 WHILE(TEXTUPAR(LENGHDSN)=BLANK);
         ICM   LENGHDSN,12,TEXTULNG(REFRNCTU)                   02S0609
         SRA   LENGHDSN,16                                      02S0609
         B     @DE00609                                         02S0609
@DL00609 LR    @10,REFRNCTU                                     02S0609
         ALR   @10,LENGHDSN                                     02S0609
         CLI   TEXTUPAR-1(@10),C' '                             02S0609
         BNE   @DC00609                                         02S0609
*END;                                  /*FIND ACTUAL DSNAME LENGTH   */
         BCTR  LENGHDSN,0                                       02S0610
@DE00609 LTR   LENGHDSN,LENGHDSN                                02S0610
         BP    @DL00609                                         02S0610
@DC00609 DS    0H                                               02S0611
*IF SCTADSTB^=ZERO THEN                /*DOES DSNAME TABLE EXIST     */
         L     @10,@PC00001                                     02S0611
         L     @10,SCTPTR(,@10)                                 02S0611
         SLR   @05,@05                                          02S0611
         ICM   @05,7,SCTADSTB(@10)                              02S0611
         LTR   @05,@05                                          02S0611
         BZ    @RF00611                                         02S0611
*  DO;                                 /*YES, GET TO LAST RECORD     */
*    SWACTLS=SWACTLS && SWACTLS;       /*CLEAR SWA MGR INTERFACE MAP */
         LH    @10,SWACTLS                                      02S0613
         N     @10,@CF02505                                     02S0613
         LR    @03,@10                                          02S0613
         XR    @03,@10                                          02S0613
         STH   @03,SWACTLS                                      02S0613
*    SWREAD=ON;                        /*READ FUNCTION               */
*    SWMOD=ON;                         /*USE EXISTING EPA            */
         OI    SWREAD,B'00100010'                               02S0615
*    SMISVA(1)=SCTADSTB;               /*SVA OF FIRST DSNT RECORD    */
         STCM  @05,7,SMISVA                                     02S0616
*    DO WHILE(SMISVA(1)^=ZERO);        /*READ TO LAST RECORD         */
         B     @DE00617                                         02S0617
@DL00617 DS    0H                                               02S0618
*      CALL IEFAB4F7(SWACTLS,ADDR(DSNTEPA),0,ADDR(SMISVA(1)),   02S0618
*                    ADDR(DSNTPTR),0,1); /*READ A RECORD             */
         LA    @10,SWACTLS                                      02S0618
         ST    @10,@AL00001                                     02S0618
         LA    @10,DSNTEPA                                      02S0618
         ST    @10,@TF00001                                     02S0618
         LA    @10,@TF00001                                     02S0618
         ST    @10,@AL00001+4                                   02S0618
         LA    @10,@CF00090                                     02S0618
         ST    @10,@AL00001+8                                   02S0618
         LA    @10,SMISVA                                       02S0618
         ST    @10,@TF00002                                     02S0618
         LA    @10,@TF00002                                     02S0618
         ST    @10,@AL00001+12                                  02S0618
         LA    @10,DSNTPTR                                      02S0618
         ST    @10,@TF00003                                     02S0618
         LA    @10,@TF00003                                     02S0618
         ST    @10,@AL00001+16                                  02S0618
         LA    @10,@CF00090                                     02S0618
         ST    @10,@AL00001+20                                  02S0618
         LA    @10,@CF00072                                     02S0618
         ST    @10,@AL00001+24                                  02S0618
         L     @15,@CV00086                                     02S0618
         LA    @01,@AL00001                                     02S0618
         BALR  @14,@15                                          02S0618
*      SMISVA(1)=DSNTNSVA;             /*SVA OF NEXT REC OR ZERO     */
         L     @10,DSNTPTR                                      02S0619
         MVC   SMISVA(3),DSNTNSVA(@10)                          02S0619
*    END;                              /*END OF READ TO LAST RECORD  */
@DE00617 ICM   @10,7,SMISVA                                     02S0620
         BNZ   @DL00617                                         02S0620
*    OLDLSTP=DSNTPTR;                  /*SAVE PTR TO LAST    @YM08602*/
         L     @10,DSNTPTR                                      02S0621
         ST    @10,OLDLSTP                                      02S0621
*  END;                                /*END OF GET TO LAST RECORD   */
*ASSIGN=OFF;                           /*ASSUME ASSIGN IS NOT NEEDED */
@RF00611 DS    0H                                               02S0624
*UPDATE=ON;                            /*ASSUME RECORD TO BE UPDATED */
         OI    UPDATE,B'01000000'                               02S0624
         NI    ASSIGN,B'01111111'                               02S0624
*OFFSET=SCTLDSTB;                      /*OFFSET TO NEW ENTRY IF DSNAME
*                                        FITS IN THE LAST RECORD     */
         L     @10,@PC00001                                     02S0625
         L     @10,SCTPTR(,@10)                                 02S0625
         L     @03,SCTLDSTB(,@10)                               02S0625
         LR    OFFSET,@03                                       02S0625
*IF SCTADSTB=ZERO ×                    /*TABLE DOESN'T EXIST         */
*   SCTLDSTB//AVAILABL = ZERO ×        /*LAST RECORD IS FULL         */
*   ( AVAILABL - (SCTLDSTB//AVAILABL) < LENGHDSN ) THEN         02S0626
         ICM   @15,7,SCTADSTB(@10)                              02S0626
         BZ    @RT00626                                         02S0626
         L     @10,AVAILABL                                     02S0626
         LR    @01,@03                                          02S0626
         SLR   @00,@00                                          02S0626
         DR    @00,@10                                          02S0626
         LTR   @00,@00                                          02S0626
         BZ    @RT00626                                         02S0626
         LR    @01,@03                                          02S0626
         SLR   @00,@00                                          02S0626
         DR    @00,@10                                          02S0626
         SLR   @10,@00                                          02S0626
         CR    @10,LENGHDSN                                     02S0626
         BNL   @RF00626                                         02S0626
@RT00626 DS    0H                                               02S0627
*                                      /*ENTRY WILL NOT FIT IN RECORD*/
*  DO;                                 /*ASSIGN IS NECESSARY         */
*    SWACTLS=SWACTLS && SWACTLS;       /*CLEAR SWA MGR INTERFACE MAP */
         LH    @10,SWACTLS                                      02S0628
         N     @10,@CF02505                                     02S0628
         LR    @03,@10                                          02S0628
         XR    @03,@10                                          02S0628
         STH   @03,SWACTLS                                      02S0628
*    SWASN=ON;                         /*ASSIGN FUNCTION             */
*    SWMOD=ON;                         /*USE THE EXISTING EPA        */
         OI    SWASN,B'10000010'                                02S0630
*    SMIID(1)=DSNTTID;                 /*ID OF DSNT                  */
         MVI   SMIID,X'07'                                      02S0631
*    CALL IEFAB4F7(SWACTLS,ADDR(ASSGNEPA),0,ADDR(SMISVA(1)),    02S0632
*                  ADDR(SMISVAB(1)),RCORDLEN,1); /*ASSIGN DSNT RECORD*/
         LA    @10,SWACTLS                                      02S0632
         ST    @10,@AL00001                                     02S0632
         LA    @10,ASSGNEPA                                     02S0632
         ST    @10,@TF00001                                     02S0632
         LA    @10,@TF00001                                     02S0632
         ST    @10,@AL00001+4                                   02S0632
         LA    @10,@CF00090                                     02S0632
         ST    @10,@AL00001+8                                   02S0632
         LA    @10,SMISVA                                       02S0632
         ST    @10,@TF00002                                     02S0632
         LA    @10,@TF00002                                     02S0632
         ST    @10,@AL00001+12                                  02S0632
         LA    @10,SMISVAB                                      02S0632
         ST    @10,@TF00003                                     02S0632
         LA    @10,@TF00003                                     02S0632
         ST    @10,@AL00001+16                                  02S0632
         LA    @10,@CF00102                                     02S0632
         ST    @10,@AL00001+20                                  02S0632
         LA    @10,@CF00072                                     02S0632
         ST    @10,@AL00001+24                                  02S0632
         L     @15,@CV00086                                     02S0632
         LA    @01,@AL00001                                     02S0632
         BALR  @14,@15                                          02S0632
*    ASGNSVA=SMISVA(1);                /*SAVE ASSIGNED SVA   @YM08602*/
         MVC   ASGNSVA(3),SMISVA                                02S0633
*    DSNTPTR=SMISVAB(1);               /*ADDRESS OF NEW DSNT RECORD  */
         L     @10,SMISVAB                                      02S0634
         ST    @10,DSNTPTR                                      02S0634
*    DSNTSVA=SMISVA(1);                /*SVA OF NEW DSNT RECORD      */
         MVC   DSNTSVA(3,@10),SMISVA                            02S0635
*    DSNTID=DSNTTID;                   /*ID OF DSNT                  */
         MVI   DSNTID(@10),X'07'                                02S0636
*    ASSIGN=ON;                        /*INDICATE ASSIGN PERFORMED   */
         OI    ASSIGN,B'10000000'                               02S0637
*    IF SCTLDSTB^=ZERO THEN            /*ENTRY WOULD NOT FIT IN OLD  */
         L     @10,@PC00001                                     02S0638
         L     @10,SCTPTR(,@10)                                 02S0638
         L     @10,SCTLDSTB(,@10)                               02S0638
         LTR   @10,@10                                          02S0638
         BZ    @RF00638                                         02S0638
*      DO;                             /*YES, UPDATE OFFSET TO NEW   */
*        OFFSET=((SCTLDSTB/AVAILABL)+                           02S0640
*               MIN(SCTLDSTB//AVAILABL,ONE))*AVAILABL;          02S0640
         L     @03,AVAILABL                                     02S0640
         LR    @01,@10                                          02S0640
         SLR   @00,@00                                          02S0640
         DR    @00,@03                                          02S0640
         LR    @15,@10                                          02S0640
         SLR   @14,@14                                          02S0640
         DR    @14,@03                                          02S0640
         LA    OFFSET,1                                         02S0640
         CR    @14,OFFSET                                       02S0640
         BNH   *+6
         LR    @14,OFFSET                                       02S0640
         ALR   @01,@14                                          02S0640
         MR    @00,@03                                          02S0640
         LR    OFFSET,@01                                       02S0640
*                                      /*OFFSET TO NEW RECORD IS
*                                        NUMBER OF OLD RECORDS  02S0641
*                                        TIMES NUMBER OF BYTES/RECORD*/
*      END;                            /*END UPDATE OFFSET TO NEW    */
*    ELSE                              /*TABLE DID NOT EXIST         */
*      UPDATE=OFF;                     /*NO DSNT TO UPDATE, OFFSET=0 */
         B     @RC00638                                         02S0642
@RF00638 NI    UPDATE,B'10111111'                               02S0642
*  END;                                /*END ASSIGN PROCESSING       */
@RC00638 DS    0H                                               02S0644
*RECBYTE=(OFFSET//AVAILABL)+1;         /*FIND AVAILABLE BYTE IN REC  */
@RF00626 LR    @00,OFFSET                                       02S0644
         SRDA  @00,32                                           02S0644
         D     @00,AVAILABL                                     02S0644
         AL    @00,@CF00072                                     02S0644
         LR    RECBYTE,@00                                      02S0644
*DSNENTRY(RECBYTE:RECBYTE+LENGHDSN-1)=                          02S0645
*                 TEXTUPAR(1:LENGHDSN); /*MOVE DSNAME TO DSNT RECORD */
         L     @10,DSNTPTR                                      02S0645
         ALR   @10,RECBYTE                                      02S0645
         LR    @15,LENGHDSN                                     02S0645
         BCTR  @15,0                                            02S0645
         EX    @15,@SM02553                                     02S0645
*IF UPDATE=ON THEN                     /*DSNT UPDATED                */
         TM    UPDATE,B'01000000'                               02S0646
         BNO   @RF00646                                         02S0646
*  DO;                                 /*YES, GET CORRECT EPA        */
*    SWEPAPTR=ADDR(DSNTEPA);           /*ADDR OF EPA OF UPDATED REC  */
         LA    @10,DSNTEPA                                      02S0648
         ST    @10,SWEPAPTR                                     02S0648
*    IF ASSIGN=ON THEN                 /*NEW RECORD ASSIGNED ALSO    */
         TM    ASSIGN,B'10000000'                               02S0649
         BNO   @RF00649                                         02S0649
*      SWCHNPTR=ADDR(ASSGNEPA);        /*YES, CHAIN EPA'S FOR WRITE  */
         LA    @15,ASSGNEPA                                     02S0650
         ST    @15,SWCHNPTR(,@10)                               02S0650
*  END;                                /*END UPDATE DSNT             */
*ELSE                                  /*DSNT DIDN'T EXIST           */
*  SWEPAPTR=ADDR(ASSGNEPA);            /*ADDR OF EPA OF NEW RECORD   */
         B     @RC00646                                         02S0652
@RF00646 LA    @10,ASSGNEPA                                     02S0652
         ST    @10,SWEPAPTR                                     02S0652
*SWACTLS=SWACTLS && SWACTLS;           /*CLEAR SWA MGR INTERFACE MAP */
@RC00646 LH    @10,SWACTLS                                      02S0653
         N     @10,@CF02505                                     02S0653
         LR    @15,@10                                          02S0653
         XR    @15,@10                                          02S0653
         STH   @15,SWACTLS                                      02S0653
*SWWRT=ON;                             /*WRITE FUNCTION              */
*SWOLD=ON;                             /*USE EXISTING EPA            */
         OI    SWWRT,B'00010001'                                02S0655
*CALL IEFAB4F7(SWACTLS,SWEPAPTR,0,0,0,0,0);                     02S0656
         MVC   @AL00001+8(20),@AL00656                          02S0656
         LA    @10,SWACTLS                                      02S0656
         ST    @10,@AL00001                                     02S0656
         LA    @10,SWEPAPTR                                     02S0656
         ST    @10,@AL00001+4                                   02S0656
         L     @15,@CV00086                                     02S0656
         LA    @01,@AL00001                                     02S0656
         BALR  @14,@15                                          02S0656
*                                      /*WRITE UPDATED RECORD(S)     */
*IF ASSIGN=ON THEN                     /*IF ASSIGN DONE      *YM08602*/
         TM    ASSIGN,B'10000000'                               02S0657
         BNO   @RF00657                                         02S0657
*  IF SCTADSTB = ZERO THEN             /*IF NO DSNT EXISTED  @YM08602*/
         L     @10,@PC00001                                     02S0658
         L     @10,SCTPTR(,@10)                                 02S0658
         ICM   @15,7,SCTADSTB(@10)                              02S0658
         BNZ   @RF00658                                         02S0658
*    SCTADSTB = ASGNSVA;               /*CHAIN NEW BLK TO SCT@YM08602*/
         MVC   SCTADSTB(3,@10),ASGNSVA                          02S0659
*  ELSE                                /*DSNT EXISTED BEFORE @YM08602*/
*    OLDLSTP->DSNTNSVA=ASGNSVA;        /*CHAIN TO OLD LAST   @YM08602*/
         B     @RC00658                                         02S0660
@RF00658 L     @10,OLDLSTP                                      02S0660
         MVC   DSNTNSVA(3,@10),ASGNSVA                          02S0660
*ELSE;                                 /*NO ASSIGN DONE      @YM08602*/
@RF00657 DS    0H                                               02S0662
*SCTLDSTB=OFFSET+LENGHDSN;             /*UPDATE LENGTH IN SCT        */
@RC00657 L     @10,@PC00001                                     02S0662
         L     @10,SCTPTR(,@10)                                 02S0662
         LR    @15,OFFSET                                       02S0662
         ALR   @15,LENGHDSN                                     02S0662
         ST    @15,SCTLDSTB(,@10)                               02S0662
*IF EPASCTSW=OFF THEN                  /*EPA FOR SCT ALREADY ON CHAIN*/
         L     @10,@PC00001+16                                  02S0663
         TM    EPASCTSW(@10),B'10000000'                        02S0663
         BNZ   @RF00663                                         02S0663
*  DO;                                 /*NO, GET EPA, BUILD AND CHAIN*/
*    RFY (R0,R1) RESTRICTED;           /*RESTRICT REGS 0 AND 1       */
*    R0=LENGTH(SWAEPA);                /*LENGTH OF EPA FOR GETMAIN   */
         LA    R0,16                                            02S0666
*    R0=R0×SUBPOLNO;                   /*GET FROM CORRECT SUBPOOL    */
         O     R0,@CF00105                                      02S0667
*    GENERATE ( GETMAIN R,LV=(0) );    /*GET CORE FOR EPA            */
          GETMAIN R,LV=(0)
*    SWEPAPTR=R1;                      /*ADDR OF EPA FOR SCT         */
         ST    R1,SWEPAPTR                                      02S0669
*    RFY (R0,R1) UNRESTRICTED;         /*RELEASE REGS 0 AND 1        */
*    SWAEPA=SWAEPA && SWAEPA;          /*INITIALIZE SWAEPA TO ZERO   */
         L     @10,SWEPAPTR                                     02S0671
         XC    SWAEPA(16,@10),SWAEPA(@10)                       02S0671
*    SWBLKPTR=SCTPTR;                  /*ADDRESS OF SCT TO EPA       */
         L     @15,@PC00001                                     02S0672
         L     @15,SCTPTR(,@15)                                 02S0672
         ST    @15,SWBLKPTR(,@10)                               02S0672
*    SWVA=SCTDISKA;                    /*SVA OF SCT TO EPA           */
         MVC   SWVA(3,@10),SCTDISKA(@15)                        02S0673
*    SWBLKID=SCTTBLID;                 /*ID OF SCT TO EPA            */
         MVC   SWBLKID(1,@10),SCTTBLID(@15)                     02S0674
*    SWLNGTH=LENGTH(INSMSCT);          /*LENGTH OF SCT TO EPA        */
         MVC   SWLNGTH(4,@10),@CF00102                          02S0675
*    LASTEPAP->SWCHNPTR=SWEPAPTR;      /*CHAIN SCT EPA TO INPUT EPA  */
         L     @15,@PC00001+24                                  02S0676
         L     @01,LASTEPAP(,@15)                               02S0676
         ST    @10,SWCHNPTR(,@01)                               02S0676
*    LASTEPAP=SWEPAPTR;                /*UPDATE ADDRESS OF LAST EPA  */
         ST    @10,LASTEPAP(,@15)                               02S0677
*    EPASCTSW=ON;                      /*EPA FOR SCT NOW ON CHAIN    */
         L     @10,@PC00001+16                                  02S0678
         OI    EPASCTSW(@10),B'10000000'                        02S0678
*  END;                                                         02S0679
*END DSNTPROC;                                                  02S0680
@EL00003 DS    0H                                               02S0680
@EF00003 DS    0H                                               02S0680
@ER00003 LM    @14,@03,@SA00003                                 02S0680
         LM    @06,@12,@SA00003+24                              02S0680
         BR    @14                                              02S0680
*END IEFDB414                                                   01S0681
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (BLDTABDT)                                        *
*/*%INCLUDE SYSLIB  (IEFZB505)                                        *
*/*%INCLUDE SYSLIB  (IEFDSNT )                                        *
*/*%INCLUDE SYSLIB  (CVT     )                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D7)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4DA)                                        *
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        *
*/*%INCLUDE SYSLIB  (IEFASCTB)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                        *
*/*%INCLUDE SYSLIB  (IEFJSSWA)                                        *
*/*%INCLUDE SYSLIB  (IEFZB436)                                        *
*/*%INCLUDE SYSLIB  (IEFZB445)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D1)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D3)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D5)                                        *
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        *
*/*%INCLUDE SYSLIB  (IHAASCB )                                        *
*/*%INCLUDE SYSLIB  (IHADSAB )                                        *
*/*%INCLUDE SYSLIB  (IHASUBIT)                                        *
*/*%INCLUDE SYSLIB  (IHAQDB  )                                        *
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        *
*/*%INCLUDE SYSLIB  (TABSETUP)                                        *
*/*%INCLUDE SYSLIB  (DUMDSN  )                                        *
*/*%INCLUDE SYSLIB  (STATDISP)                                        *
*/*%INCLUDE SYSLIB  (SPACE   )                                        *
*/*%INCLUDE SYSLIB  (UNIT    )                                        *
*/*%INCLUDE SYSLIB  (VOLUME  )                                        *
*/*%INCLUDE SYSLIB  (ASNJFCBX)                                        *
*/*%INCLUDE SYSLIB  (SUBSYSOU)                                        *
*/*%INCLUDE SYSLIB  (SYSOUT  )                                        *
*/*%INCLUDE SYSLIB  (SSNAME  )                                        *
*/*%INCLUDE SYSLIB  (GETSSWA )                                        *
*/*%INCLUDE SYSLIB  (LABEL   )                                        *
*/*%INCLUDE SYSLIB  (FCBUCS  )                                        *
*/*%INCLUDE SYSLIB  (DCB     )                                        *
*/*%INCLUDE SYSLIB  (GENDSNAM)                                        *
*/*%INCLUDE SYSLIB  (DSNTPROC)                                        *
*;                                                              01S0681
@DATA    DS    0H
@CH00120 DC    H'6'
@SM02507 MVC   SCTDDNAM(0,SIOTPTR),TEXTUPAR(@10)
@SM02510 MVC   JFCBQNAM(0,JFCBPTR),TEXTUPAR(@10)
@SM02513 MVC   JFCBDSNM(0,JFCBPTR),TEXTUPAR(@10)
@SM02516 MVC   SCTANAME(0,SIOTPTR),TEXTUPAR+2(@10)
@SM02518 MVC   SCTANAME(0,SIOTPTR),TEXTUPAR+1(@10)
@SM02520 MVC   JFCBELNM(0,JFCBPTR),TEXTUPAR(@10)
@SM02527 MVC   SCTUTYPE(0,SIOTPTR),TEXTUPAR(@10)
@SM02530 MVC   JFCAVOLS-6(0,@10),TEXTUPRM(TXTUFLDP)
@SM02532 MVC   JFCBXVOL-4(0,@15),TEXTUPRM(TXTUFLDP)
@SM02534 MVC   SCTOUTNM(0,SIOTPTR),TEXTUPAR(@10)
@SM02536 MVC   SCTOUTNO(0,SIOTPTR),TEXTUPAR(@10)
@SM02538 MVC   SIOTDEST(0,SIOTPTR),TEXTUPAR(@10)
@SM02540 MVC   SIOTSSNM(0,SIOTPTR),TEXTUPAR(@15)
@SM02543 MVC   SSWAIPRM(0,PTRSSWAI),TEXTUPRM(TXTUFLDP)
@SM02545 MVC   JFCFCBID(0,JFCBPTR),TEXTUPAR(@10)
@SM02547 MVC   JFCUCSID(0,JFCBPTR),TEXTUPAR(@10)
@SM02549 MVC   REFDDNAM(0),TEXTUPAR(@10)
@SM02551 MVC   JFCMSVGP(0,JFCBPTR),TEXTUPAR(@10)
@SM02553 MVC   DSNENTRY-1(0,@10),TEXTUPAR(REFRNCTU)
         DS    0F
@AL00436 EQU   *                       LIST WITH   5 ARGUMENT(S)
@AL00656 DC    A(@CF00090)             LIST WITH   5 ARGUMENT(S)
         DC    A(@CF00090)
         DC    A(@CF00090)
         DC    A(@CF00090)
         DC    A(@CF00090)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    7F
@SA00003 DS    13F
@AL00001 DS    7A
@TF00001 DS    F
@TF00002 DS    F
@TF00003 DS    F
IEFDB414 CSECT
         DS    0F
@CF00090 DC    F'0'
@CF00072 DC    F'1'
@CH00072 EQU   @CF00072+2
@CF00058 DC    F'2'
@CF00117 DC    F'5'
@CF00094 DC    F'8'
@CF00088 DC    F'15'
@CF00102 DC    F'176'
@CF00092 DC    F'1635'
@CF00105 DC    XL4'E6000000'
@CF02505 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
SWEPAPTR DS    A
NUMRCORD DS    F
SIZESSWA DS    F
DSABPTR  DS    A
DSNTPTR  DS    A
OLDLSTP  DS    A
S99TXTPP DS    A
TCBJSCB  DS    A
QDBPTR   DS    A
PSCBPTR  DS    A
J        DS    H
SWACTLS  DS    FL2
         ORG   SWACTLS
SWASN    DS    BL1
SWDEL    EQU   SWACTLS+0
SWREAD   EQU   SWACTLS+0
SWWRT    EQU   SWACTLS+0
SWNEW    EQU   SWACTLS+0
SWFREE   EQU   SWACTLS+0
SWMOD    EQU   SWACTLS+0
SWOLD    EQU   SWACTLS+0
SWCHN    DS    BL1
@NM00079 EQU   SWACTLS+1
         ORG   SWACTLS+2
ASGNSVA  DS    FL3
         DS    0D
@TS00001 DS    CL8
LCLEPA   DS    CL16
DSNUM1   DS    CL8
DSNUM2   DS    CL8
DATE     DS    CL4
REFDDNAM DS    CL8
TIME     DS    CL4
WORKCHR4 DS    CL4
         ORG   WORKCHR4
WORKFIX2 DS    FL2
WORKCHR2 DS    CL2
         ORG   WORKCHR4+4
EPAS     DS    CL32
         ORG   EPAS
DSNTEPA  DS    CL16
ASSGNEPA DS    CL16
         ORG   EPAS+32
DSNTSWS  DS    CL1
         ORG   DSNTSWS
ASSIGN   DS    BL1
UPDATE   EQU   DSNTSWS+0
@NM00011 EQU   DSNTSWS+0
         ORG   DSNTSWS+1
         DS    CL3
SMISVAB  DS    17F
SMISVAID DS    FL4
         ORG   SMISVAID+0
SMISVA   DS    CL3
SMIID    DS    CL1
         ORG   SMISVAID+68
IEFDB414 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00086 DC    V(IEFAB4F7)
@CV00170 DC    V(IEFDB417)
@CV00171 DC    V(IEFDB4FC)
@CV00172 DC    V(IEFDB4FD)
@CA01813 DC    A(IEFAB445)
         DS    0D
KEYZERO  DC    F'0'
AVAILABL DC    AL4(168)
@CC02430 DC    C'NULLFILE'
@CB02471 DC    X'FFFFFF'
@CB00996 DC    X'0450'
@CB00998 DC    X'0454'
NODEST   DC    X'0000000000000000'
GENNAME1 DS    CL23
         ORG   GENNAME1
@NM00004 DC    CL3'SYS'
@NM00005 DS    CL5
@NM00006 DC    CL2'.T'
@NM00007 DS    CL6
@NM00008 DC    CL7'.RA000.'
         ORG   GENNAME1+23
GENNAME2 DS    CL1
         ORG   GENNAME2
@NM00009 DC    CL1'R'
         ORG   GENNAME2+1
IEFDB414 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFDB414 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
RECBYTE  EQU   @03
OFFSET   EQU   @05
LENGHDSN EQU   @04
REFRNCTU EQU   @02
NUMVOLS  EQU   @05
NUMJFCBX EQU   @03
I        EQU   @02
TXTUFLDP EQU   @04
REFJFCBP EQU   @02
JFCBXPTR EQU   @10
GENDSNUM EQU   @02
WORKPTR  EQU   @03
ITEMLEN  EQU   @03
SSWAPTR  EQU   @05
PTRSSWAI EQU   @10
KEYTABP  EQU   @06
JFCBPTR  EQU   @07
SIOTPTR  EQU   @08
R0       EQU   @00
R1       EQU   @01
         EXTRN IEFAB445
CVTPTR   EQU   16
SWAEPA   EQU   0
SWBLKPTR EQU   SWAEPA
SWVAFW   EQU   SWAEPA+4
SWVA     EQU   SWVAFW
SWBLKID  EQU   SWVAFW+3
SWLNGTH  EQU   SWAEPA+8
SWCHNPTR EQU   SWAEPA+12
GDSNMAP2 EQU   0
DOT      EQU   GDSNMAP2
AMPNAME  EQU   GDSNMAP2+1
YEARDAYS EQU   0
YEAR     EQU   YEARDAYS
DAYS     EQU   YEARDAYS+1
DSNTABLE EQU   0
DSNTSVA  EQU   DSNTABLE
DSNTID   EQU   DSNTABLE+3
DSNTNSVA EQU   DSNTABLE+4
DSNENTRY EQU   DSNTABLE+8
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
INJMJCT  EQU   0
JCTJSTAT EQU   INJMJCT+5
INDMCTLG EQU   JCTJSTAT
JCTJMGPO EQU   INJMJCT+6
JCTJBYTE EQU   INJMJCT+7
JCTJMGLV EQU   JCTJBYTE
JCTJNAME EQU   INJMJCT+8
JCTCCODE EQU   INJMJCT+54
JCTRSW1  EQU   INJMJCT+86
JCTRSW2  EQU   INJMJCT+87
JCTJSB   EQU   INJMJCT+111
JCTSTAT2 EQU   INJMJCT+116
JCTBLP   EQU   JCTSTAT2
IEFAACTB EQU   0
INSMSCT  EQU   0
SCTDISKA EQU   INSMSCT
SCTTBLID EQU   INSMSCT+3
SCTSSTAT EQU   INSMSCT+4
SCTADSTB EQU   INSMSCT+40
SCTSTYPE EQU   INSMSCT+67
SCTLDSTB EQU   INSMSCT+80
SCTSDPTY EQU   INSMSCT+94
SCTSTAT2 EQU   INSMSCT+104
SCTBCT   EQU   SCTSTAT2
SCTCDENT EQU   INSMSCT+118
SCTSTEND EQU   INSMSCT+172
@NM00056 EQU   0
SCTABCND EQU   @NM00056
INDMSIOT EQU   0
SIOTDSKA EQU   INDMSIOT
SIOTTYPE EQU   INDMSIOT+3
SCTDDNAM EQU   INDMSIOT+4
SIOTDEST EQU   INDMSIOT+12
SCTUSADD EQU   INDMSIOT+20
SIODSNTE EQU   INDMSIOT+22
SCTPJFCB EQU   INDMSIOT+32
SIOTBYT1 EQU   INDMSIOT+43
SIOTHOLD EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SCTDDINO EQU   INDMSIOT+44
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTTERM EQU   SIOTTSTC
SIOTSSGP EQU   SIOTTSTC
SIOTQNAM EQU   SIOTTSTC
SCTVOLCT EQU   INDMSIOT+49
SIOTBYT0 EQU   INDMSIOT+52
SIOTSSDS EQU   SIOTBYT0
SCTNMBUT EQU   INDMSIOT+53
SIOTVLCT EQU   INDMSIOT+54
SCTSDISP EQU   INDMSIOT+55
SIOTPRIV EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SCTSBYT1 EQU   INDMSIOT+56
SCTDUMMY EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SCTSBYT2 EQU   INDMSIOT+57
SIOCLUNL EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTSBYT3 EQU   INDMSIOT+58
SCTDSNRF EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSOLD  EQU   SCTSBYT3
SCTSBYT4 EQU   INDMSIOT+59
SCTSGDGS EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOUCBAD EQU   SCTUTYPE+5
SCTOUTNM EQU   INDMSIOT+68
SCTOUTNO EQU   INDMSIOT+76
SCTOUTPN EQU   INDMSIOT+80
SIOTBYT4 EQU   INDMSIOT+81
SIOTPROT EQU   SIOTBYT4
SIOTALTD EQU   INDMSIOT+92
SIOTADEL EQU   SIOTALTD
SIOTSSWA EQU   INDMSIOT+93
SIOTOUTC EQU   INDMSIOT+96
SIOTBYT2 EQU   INDMSIOT+103
SIOTSSNM EQU   INDMSIOT+104
SCTANAME EQU   INDMSIOT+122
SJFCBPTR EQU   INDMSIOT+156
SIOTJFX  EQU   INDMSIOT+160
SIOVDSNT EQU   INDMSIOT+170
SIOVDSNL EQU   INDMSIOT+172
SIODDSNL EQU   INDMSIOT+173
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBQNAM EQU   JFCBDSNM
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCSDS   EQU   JFCBTSDM
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBAL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNL    EQU   JFCBLTYP
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBVLSQ EQU   INFMJFCB+70
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCINOP  EQU   JFCBFLG2
JFCOUTOP EQU   JFCBFLG2
JFCDEFER EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCBCRDT EQU   INFMJFCB+80
JFCBXPDT EQU   INFMJFCB+83
JFCBIND1 EQU   INFMJFCB+86
JFCRLSE  EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCPDS   EQU   JFCBIND1
JFCBIND2 EQU   INFMJFCB+87
JFCDISP  EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCTEMP  EQU   JFCBIND2
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
JFCBX    EQU   0
JFCBXTTR EQU   JFCBX
JFCBXVOL EQU   JFCBX+4
JFCBXNXT EQU   JFCBX+172
SSWA     EQU   0
SSWAHDR  EQU   SSWA
SSWATYPE EQU   SSWAHDR
SSWASSNM EQU   SSWAHDR+2
SSWAPRNO EQU   SSWAHDR+6
SSWAPREN EQU   SSWA+8
SSWAPLEN EQU   SSWAPREN
SSWAIFLD EQU   0
SSWAILEN EQU   SSWAIFLD
SSWAIPRM EQU   SSWAIFLD+1
TXTUPLST EQU   0
TXTUNITP EQU   TXTUPLST
TXTUPELM EQU   0
TXTPLENT EQU   TXTUPELM
TEXTUNIT EQU   0
TEXTUNUM EQU   TEXTUNIT+2
TEXTUENT EQU   TEXTUNIT+4
TEXTULNG EQU   TEXTUENT
TEXTUPAR EQU   TEXTUENT+2
TEXTUFLD EQU   0
TEXTULEN EQU   TEXTUFLD
TEXTUPRM EQU   TEXTUFLD+2
KEYTABLE EQU   0
DDNAMTUP EQU   KEYTABLE
DSNAMTUP EQU   KEYTABLE+4
MEMBRTUP EQU   KEYTABLE+8
STATSTUP EQU   KEYTABLE+12
NDISPTUP EQU   KEYTABLE+16
CDISPTUP EQU   KEYTABLE+20
TRKTUP   EQU   KEYTABLE+24
CYLTUP   EQU   KEYTABLE+28
BLKLNTUP EQU   KEYTABLE+32
PRIMETUP EQU   KEYTABLE+36
SECNDTUP EQU   KEYTABLE+40
DIRTUP   EQU   KEYTABLE+44
RLSETUP  EQU   KEYTABLE+48
SPFRMTUP EQU   KEYTABLE+52
ROUNDTUP EQU   KEYTABLE+56
VLSERTUP EQU   KEYTABLE+60
PRIVTTUP EQU   KEYTABLE+64
VLSEQTUP EQU   KEYTABLE+68
VLCNTTUP EQU   KEYTABLE+72
VLRDSTUP EQU   KEYTABLE+76
UNITTUP  EQU   KEYTABLE+80
UNCNTTUP EQU   KEYTABLE+84
PARALTUP EQU   KEYTABLE+88
SYSOUTUP EQU   KEYTABLE+92
SPGNMTUP EQU   KEYTABLE+96
SFMNOTUP EQU   KEYTABLE+100
OUTLMTUP EQU   KEYTABLE+104
CLOSETUP EQU   KEYTABLE+108
COPYSTUP EQU   KEYTABLE+112
LABELTUP EQU   KEYTABLE+116
DSSEQTUP EQU   KEYTABLE+120
PASPRTUP EQU   KEYTABLE+124
INOUTTUP EQU   KEYTABLE+128
EXPDTTUP EQU   KEYTABLE+132
RETPDTUP EQU   KEYTABLE+136
DUMMYTUP EQU   KEYTABLE+140
FCBIMTUP EQU   KEYTABLE+144
FCBAVTUP EQU   KEYTABLE+148
QNAMETUP EQU   KEYTABLE+152
TERMTUP  EQU   KEYTABLE+156
UCSTUP   EQU   KEYTABLE+160
UFOLDTUP EQU   KEYTABLE+164
UVRFYTUP EQU   KEYTABLE+168
DCBDSTUP EQU   KEYTABLE+172
DCBDDTUP EQU   KEYTABLE+176
SUSERTUP EQU   KEYTABLE+348
SHOLDTUP EQU   KEYTABLE+352
SSREQTUP EQU   KEYTABLE+364
MSVGPTUP EQU   KEYTABLE+372
SSNMTUP  EQU   KEYTABLE+376
SSPRMTUP EQU   KEYTABLE+380
PROTTUP  EQU   KEYTABLE+384
QDB      EQU   0
IEZJSCB  EQU   0
JSCBSEC1 EQU   IEZJSCB+188
JSCHPCE  EQU   JSCBSEC1+4
JSCBDCB  EQU   JSCBSEC1+36
JSCBOPTS EQU   JSCBSEC1+48
JSCBSWT1 EQU   JSCBSEC1+55
JSCBWTP  EQU   JSCBSEC1+64
JSCBWTFG EQU   JSCBWTP
JSCBEND1 EQU   IEZJSCB+260
ASCB     EQU   0
ASCBTSB  EQU   ASCB+60
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
DSAB     EQU   0
DSABGIDP EQU   DSAB+24
DSABANMP EQU   DSAB+28
DSABORG  EQU   DSAB+32
DSABORG1 EQU   DSABORG
DSABORG2 EQU   DSABORG+1
DSABFLG1 EQU   DSAB+34
DSABFLG2 EQU   DSAB+35
DSABFLG3 EQU   DSAB+36
DSABFLG4 EQU   DSAB+37
DSABSIOT EQU   DSAB+64
DSABANMI EQU   0
DSABGIDL EQU   0
SUBITS   EQU   0
SUBYTE1  EQU   SUBITS
SUBYTE2  EQU   SUBITS+1
SUBYTE3  EQU   SUBITS+2
SUBYTE4  EQU   SUBITS+3
SU29BIT  EQU   SUBYTE4
SUBYTE5  EQU   SUBITS+4
SU32BIT  EQU   SUBYTE5
SUBYTE6  EQU   SUBITS+5
SUBYTE7  EQU   SUBITS+6
SUBYTE8  EQU   SUBITS+7
SUBYTE9  EQU   SUBITS+8
SUBYTE10 EQU   SUBITS+9
SUBYTE11 EQU   SUBITS+10
SUBYTE12 EQU   SUBITS+11
SUBYTE13 EQU   SUBITS+12
PSCB     EQU   0
PSCBGPNM EQU   PSCB+8
PSCBATR1 EQU   PSCB+16
PSCBDEST EQU   PSCB+40
INDMDSNT EQU   0
DEFSPACE EQU   IEFAB445
@NM00080 EQU   DEFSPACE+12
DEFUNIT  EQU   IEFAB445+13
SYSCTBLK EQU   0
JSCBPTR  EQU   SYSCTBLK
ASCBPTR  EQU   SYSCTBLK+4
JCTPTR   EQU   SYSCTBLK+12
SCTPTR   EQU   SYSCTBLK+16
LSJXEPAP EQU   0
KEYTBPTR EQU   0
FSIOTPTR EQU   0
ALFNCMAP EQU   0
INPUTSW  EQU   ALFNCMAP
CATLOGSW EQU   INPUTSW+2
UNITDEVT EQU   INPUTSW+3
PCATINIT EQU   INPUTSW+3
PROCESSW EQU   ALFNCMAP+6
ERRPROSW EQU   PROCESSW
DCBSPCSW EQU   PROCESSW
EPASCTSW EQU   PROCESSW+1
REASONCD EQU   0
ERRCODE  EQU   REASONCD
LASTEPAP EQU   0
GDSNMAP1 EQU   JFCBDSNM
YYDDD    EQU   GDSNMAP1+3
TTTTTT   EQU   GDSNMAP1+10
JOBNAME  EQU   GDSNMAP1+23
DCBJFCB  EQU   JFCBUFNO
JXVOLSER EQU   JFCBXVOL
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
CVTIHASU EQU   CVTS01+696
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSID EQU   JFCUCSEG
JFCUCSOP EQU   JFCUCSEG+4
JFCFOLD  EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBNVOL EQU   JFCUCSEG+9
JFCBVOLS EQU   JFCUCSEG+10
JFCAVOLS EQU   JFCBVOLS
JFCBS001 EQU   JFCBVOLS
JFCMSVGP EQU   JFCBS001+22
JFCBEXAD EQU   JFCBS001+31
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSPAC EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCROUND EQU   JFCBCTRI
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCVRDS  EQU   JFCFLGS1
JFCBDQTY EQU   JFCBS001+42
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
JFCBDRLH EQU   JFCBS001+53
JFCBVLCT EQU   JFCBS001+56
DSABQDB  EQU   QDB
DSQFRSTP EQU   DSABQDB+12
DSQLASTP EQU   DSABQDB+16
JSCBSEC2 EQU   JSCBEND1
JSCBSEC3 EQU   JSCBEND1
JSCBJCT  EQU   JSCBSEC3
JSCBJCTA EQU   JSCBJCT+1
JSCBPSCB EQU   JSCBSEC3+4
JSCBASID EQU   JSCBSEC3+8
JSCBFBYT EQU   JSCBSEC3+10
JSCBJNL  EQU   JSCBSEC3+28
JSCBJJSB EQU   JSCBJNL
JSCBSUB  EQU   JSCBSEC3+40
JSCDSABQ EQU   JSCBSEC3+60
JSCSCT   EQU   JSCBSEC3+68
JSCDDNNO EQU   JSCBSEC3+80
JSCDDNUM EQU   JSCBSEC3+84
JSCRSV45 EQU   JSCBSEC3+112
JSCRSV46 EQU   JSCRSV45
JSCRSV47 EQU   JSCRSV45+2
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
JSCBEND3 EQU   JSCBSEC3+120
JSCRSV52 EQU   JSCBSEC3+116
JSCRSV51 EQU   JSCRSV47+1
JSCRSV50 EQU   JSCRSV47
JSCRSV49 EQU   JSCRSV46+1
JSCRSV48 EQU   JSCRSV46
JSCRSV44 EQU   JSCBSEC3+108
JSCRSV43 EQU   JSCBSEC3+104
JSCRSV42 EQU   JSCBSEC3+100
JSCBASWA EQU   JSCBSEC3+96
JSCBUFPT EQU   JSCBSEC3+92
JSCBACT  EQU   JSCBSEC3+88
JSCBSWSP EQU   JSCBSEC3+87
JSCRSV33 EQU   JSCBSEC3+86
JSCRSV53 EQU   JSCBSEC3+82
JSCBVATA EQU   JSCBSEC3+76
JSCTMCOR EQU   JSCBSEC3+72
JSCSCTP  EQU   JSCSCT+1
JSCRSV55 EQU   JSCSCT
JSCRSV54 EQU   JSCBSEC3+64
JSCBSSIB EQU   JSCBSEC3+56
JSCBFRBA EQU   JSCBSEC3+48
JSCRSV28 EQU   JSCBSEC3+46
JSCBSONO EQU   JSCBSEC3+44
JSCBSUBA EQU   JSCBSUB+1
JSCRSV31 EQU   JSCBSUB
JSCBSMLR EQU   JSCBSEC3+36
JSCBJNLR EQU   JSCBSEC3+32
JSCBJNLA EQU   JSCBJNL+1
JSCBJSBT EQU   JSCBJJSB
JSCBJSBX EQU   JSCBJJSB
JSCBJSBA EQU   JSCBJJSB
JSCBJSBI EQU   JSCBJJSB
@NM00085 EQU   JSCBJJSB
JSCBJNLE EQU   JSCBJJSB
JSCBJNLF EQU   JSCBJJSB
JSCBJNLN EQU   JSCBJJSB
@NM00084 EQU   JSCBSEC3+24
JSCBJRBA EQU   JSCBSEC3+16
JSCBIECB EQU   JSCBSEC3+12
JSCBRV08 EQU   JSCBSEC3+11
JSCBRV07 EQU   JSCBFBYT
JSCBRV06 EQU   JSCBFBYT
JSCBRV05 EQU   JSCBFBYT
JSCBRV04 EQU   JSCBFBYT
JSCBRV03 EQU   JSCBFBYT
JSCBRV02 EQU   JSCBFBYT
JSCBADSP EQU   JSCBFBYT
JSCBRV01 EQU   JSCBFBYT
JSCBTJID EQU   JSCBASID
JSCJCTP  EQU   JSCBJCTA
JSCRSV24 EQU   JSCBJCT
JSCBEND2 EQU   JSCBSEC2
@NM00081 EQU   DSABQDB+24
DSQBDSP  EQU   DSABQDB+22
DSQFDSP  EQU   DSABQDB+20
DSQBADFC EQU   DSQLASTP
DSQBADBC EQU   DSQFRSTP
DSQNELMS EQU   DSABQDB+8
DSQDBLN  EQU   DSABQDB+6
DSQATTRS EQU   DSABQDB+4
DSQDBID  EQU   DSABQDB
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBEXP  EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXTL EQU   JFCBS001+30
@NM00075 EQU   JFCBS001
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00074 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00073 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00003 EQU   GDSNMAP1+16
@NM00002 EQU   GDSNMAP1+8
@NM00001 EQU   GDSNMAP1
INFOCODE EQU   REASONCD+2
@NM00016 EQU   PROCESSW+1
DYNMSSOK EQU   PROCESSW+1
HSKPDQSW EQU   PROCESSW+1
DISMSGSW EQU   PROCESSW+1
USERERSW EQU   PROCESSW+1
EPALSISW EQU   PROCESSW+1
EPAJCTSW EQU   PROCESSW
FRRPERSW EQU   PROCESSW
NQEXCLSW EQU   PROCESSW
UNALOCSW EQU   ERRPROSW
DEQDSNSW EQU   ERRPROSW
COPYSW   EQU   PROCESSW
DYNMSSTM EQU   PROCESSW
@NM00015 EQU   INPUTSW+3
MOUNTSW  EQU   INPUTSW+2
TIOTNQSW EQU   INPUTSW+2
OFFLINSW EQU   INPUTSW+2
WTUNTSW  EQU   INPUTSW+2
NORESSW  EQU   INPUTSW+2
WTDSNSW  EQU   INPUTSW+2
WTVOLSW  EQU   INPUTSW+2
@NM00014 EQU   INPUTSW
JOBRLSYS EQU   INPUTSW
NOMONTSW EQU   INPUTSW
NOCNVTSW EQU   INPUTSW
ONCNVTSW EQU   INPUTSW
TCBPTR   EQU   SYSCTBLK+8
DEFROUND EQU   @NM00080
DEFALX   EQU   @NM00080
DEFMIXG  EQU   @NM00080
DEFCONTG EQU   @NM00080
DEFRLSE  EQU   @NM00080
DEFBLKLN EQU   @NM00080
DEFCYL   EQU   @NM00080
DEFTRK   EQU   @NM00080
DEFDQTY  EQU   DEFSPACE+9
DEFDRLH  EQU   DEFSPACE+6
DEFSQTY  EQU   DEFSPACE+3
DEFPQTY  EQU   DEFSPACE
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
@NM00094 EQU   PSCB+36
@NM00093 EQU   PSCB+32
PSCBSOUT EQU   PSCB+31
PSCBSUBM EQU   PSCB+30
PSCBSUBC EQU   PSCB+29
PSCBSUBH EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00092 EQU   PSCBATR1
@NM00091 EQU   PSCBATR1
PSCBRCVR EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBUSRL EQU   PSCB+7
PSCBUSER EQU   PSCB
SURV104  EQU   SUBITS+13
SURV103  EQU   SUBYTE13
SURV102  EQU   SUBYTE13
SURV101  EQU   SUBYTE13
SU100BT  EQU   SUBYTE13
SU99BIT  EQU   SUBYTE13
SU98BIT  EQU   SUBYTE13
SU97BIT  EQU   SUBYTE13
SU96BIT  EQU   SUBYTE13
SU95BIT  EQU   SUBYTE12
SU94BIT  EQU   SUBYTE12
SU93BIT  EQU   SUBYTE12
SU92BIT  EQU   SUBYTE12
SU91BIT  EQU   SUBYTE12
SU90BIT  EQU   SUBYTE12
SU89BIT  EQU   SUBYTE12
SU88BIT  EQU   SUBYTE12
SU87BIT  EQU   SUBYTE11
SU86BIT  EQU   SUBYTE11
SU85BIT  EQU   SUBYTE11
SU84BIT  EQU   SUBYTE11
SU83BIT  EQU   SUBYTE11
SU82BIT  EQU   SUBYTE11
SU81BIT  EQU   SUBYTE11
SU80BIT  EQU   SUBYTE11
SU79BIT  EQU   SUBYTE10
SU78BIT  EQU   SUBYTE10
SU77BIT  EQU   SUBYTE10
SU76BIT  EQU   SUBYTE10
SU75BIT  EQU   SUBYTE10
SU74BIT  EQU   SUBYTE10
SU73BIT  EQU   SUBYTE10
SU72BIT  EQU   SUBYTE10
SU71BIT  EQU   SUBYTE9
SU70BIT  EQU   SUBYTE9
SU69BIT  EQU   SUBYTE9
SU68BIT  EQU   SUBYTE9
SU67BIT  EQU   SUBYTE9
SU66BIT  EQU   SUBYTE9
SU65BIT  EQU   SUBYTE9
SU64BIT  EQU   SUBYTE9
SU63BIT  EQU   SUBYTE8
SU62BIT  EQU   SUBYTE8
SU61BIT  EQU   SUBYTE8
SU60BIT  EQU   SUBYTE8
SU59BIT  EQU   SUBYTE8
SU58BIT  EQU   SUBYTE8
SU57BIT  EQU   SUBYTE8
SU56BIT  EQU   SUBYTE8
SU55BIT  EQU   SUBYTE7
SU54BIT  EQU   SUBYTE7
SU53BIT  EQU   SUBYTE7
SU52BIT  EQU   SUBYTE7
SU51BIT  EQU   SUBYTE7
SU50BIT  EQU   SUBYTE7
SU49BIT  EQU   SUBYTE7
SU48BIT  EQU   SUBYTE7
SU47BIT  EQU   SUBYTE6
SU46BIT  EQU   SUBYTE6
SU45BIT  EQU   SUBYTE6
SU44BIT  EQU   SUBYTE6
SU43BIT  EQU   SUBYTE6
SU42BIT  EQU   SUBYTE6
SU41BIT  EQU   SUBYTE6
SU40BIT  EQU   SUBYTE6
SU39BIT  EQU   SUBYTE5
SU38BIT  EQU   SUBYTE5
SU37BIT  EQU   SUBYTE5
SU36BIT  EQU   SUBYTE5
SU35BIT  EQU   SUBYTE5
SU34BIT  EQU   SUBYTE5
SU33BIT  EQU   SUBYTE5
SU31BIT  EQU   SUBYTE4
SU30BIT  EQU   SUBYTE4
SU28BIT  EQU   SUBYTE4
SU27BIT  EQU   SUBYTE4
SU26BIT  EQU   SUBYTE4
SU25BIT  EQU   SUBYTE4
SU24BIT  EQU   SUBYTE4
SU23BIT  EQU   SUBYTE3
SU22BIT  EQU   SUBYTE3
SU21BIT  EQU   SUBYTE3
SU20BIT  EQU   SUBYTE3
SU19BIT  EQU   SUBYTE3
SU18BIT  EQU   SUBYTE3
SU17BIT  EQU   SUBYTE3
SU16BIT  EQU   SUBYTE3
SU15BIT  EQU   SUBYTE2
SU14BIT  EQU   SUBYTE2
SU13BIT  EQU   SUBYTE2
SU12BIT  EQU   SUBYTE2
SU11BIT  EQU   SUBYTE2
SU10BIT  EQU   SUBYTE2
SU9BIT   EQU   SUBYTE2
SU8BIT   EQU   SUBYTE2
SU7BIT   EQU   SUBYTE1
SU6BIT   EQU   SUBYTE1
SU5BIT   EQU   SUBYTE1
SU4BIT   EQU   SUBYTE1
SU3BIT   EQU   SUBYTE1
SU2BIT   EQU   SUBYTE1
SU1BIT   EQU   SUBYTE1
SU0BIT   EQU   SUBYTE1
DSABGRID EQU   DSABGIDL+4
DSABLLEN EQU   DSABGIDL
DSABANAM EQU   DSABANMI+1
DSABANML EQU   DSABANMI
DSABRS04 EQU   DSAB+68
DSABRS03 EQU   DSAB+62
DSABDCBM EQU   DSAB+56
DSABSSCM EQU   DSAB+52
DSABSSNM EQU   DSAB+48
DSABPTTR EQU   DSAB+44
DSABTCBP EQU   DSAB+40
DSABRS02 EQU   DSAB+38
@NM00090 EQU   DSABFLG4
DSABCKSI EQU   DSABFLG4
DSABCKVL EQU   DSABFLG4
DSABCKDS EQU   DSABFLG4
@NM00089 EQU   DSABFLG3
DSABJSCT EQU   DSABFLG3
DSABCATL EQU   DSABFLG3
DSABVMSC EQU   DSABFLG3
DSABVAM  EQU   DSABFLG3
DSABPASS EQU   DSABFLG3
DSABDEFR EQU   DSABFLG3
@NM00088 EQU   DSABFLG2
DSABUNAL EQU   DSABFLG2
DSABIRM  EQU   DSABFLG2
DSABOPEN EQU   DSABFLG2
DSABNUSE EQU   DSABFLG1
DSABCATM EQU   DSABFLG1
DSABPCAT EQU   DSABFLG1
DSABDCAT EQU   DSABFLG1
DSABCONV EQU   DSABFLG1
DSABDCNV EQU   DSABFLG1
DSABPALC EQU   DSABFLG1
DSABDALC EQU   DSABFLG1
@NM00087 EQU   DSABORG2
DSABTR   EQU   DSABORG2
DSABAM   EQU   DSABORG2
@NM00086 EQU   DSABORG2
DSABTQ   EQU   DSABORG2
DSABTX   EQU   DSABORG2
DSABGS   EQU   DSABORG2
DSABU    EQU   DSABORG1
DSABPO   EQU   DSABORG1
DSABMQ   EQU   DSABORG1
DSABCQ   EQU   DSABORG1
DSABCX   EQU   DSABORG1
DSABDA   EQU   DSABORG1
DSABPS   EQU   DSABORG1
DSABIS   EQU   DSABORG1
DSABSSVA EQU   DSAB+21
DSABRS01 EQU   DSAB+20
DSABTIOT EQU   DSAB+16
DSABOPCT EQU   DSAB+14
DSABLNTH EQU   DSAB+12
DSABBCHN EQU   DSAB+8
DSABFCHN EQU   DSAB+4
DSABID   EQU   DSAB
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
JSCBCSCB EQU   JSCBSEC1+68
JSCBPMG  EQU   JSCBWTP+2
JSCBWTSP EQU   JSCBWTP+1
JSCRSV23 EQU   JSCBWTFG
JSCRSV22 EQU   JSCBWTFG
JSCRSV21 EQU   JSCBWTFG
JSCRSV20 EQU   JSCBWTFG
JSCRSV19 EQU   JSCBWTFG
JSCRSV18 EQU   JSCBWTFG
JSCBRET  EQU   JSCBWTFG
JSCBIOFG EQU   JSCBWTFG
@NM00083 EQU   JSCBSEC1+60
JSCBQMPI EQU   JSCBSEC1+56
JSCBPMSG EQU   JSCBSWT1
JSCRSV16 EQU   JSCBSWT1
JSCRSV15 EQU   JSCBSWT1
JSCRSV14 EQU   JSCBSWT1
JSCRSV13 EQU   JSCBSWT1
JSCRSV12 EQU   JSCBSWT1
JSCRSV11 EQU   JSCBSWT1
JSCBPASS EQU   JSCBSWT1
JSCBTTTR EQU   JSCBSEC1+52
JSCRSV10 EQU   JSCBSEC1+49
JSCBAUTH EQU   JSCBOPTS
JSCSIOTS EQU   JSCBOPTS
JSCRSV08 EQU   JSCBOPTS
JSCRSV07 EQU   JSCBOPTS
JSCRSV06 EQU   JSCBOPTS
JSCBLONG EQU   JSCBOPTS
JSCRSV05 EQU   JSCBOPTS
JSCRSV04 EQU   JSCBOPTS
JSCBSECB EQU   JSCBSEC1+44
JSCRSV03 EQU   JSCBSEC1+41
JSCBSTEP EQU   JSCBSEC1+40
JSCBDCBA EQU   JSCBDCB+1
JSCRSV02 EQU   JSCBDCB
JSCBID   EQU   JSCBSEC1+32
JSCBDBTB EQU   JSCBSEC1+28
JSCBIJSC EQU   JSCBSEC1+24
JSCBTCBP EQU   JSCBSEC1+20
JSCBPCC  EQU   JSCBSEC1+16
JSCBTCP  EQU   JSCBSEC1+12
JSCBSHR  EQU   JSCBSEC1+8
JSCHPCEA EQU   JSCHPCE+1
JSCRSV32 EQU   JSCHPCE
JSCRSV01 EQU   JSCBSEC1
@NM00082 EQU   IEZJSCB
QDBRV002 EQU   QDB+28
QDBPRDS  EQU   QDB+26
QDBPRSZ  EQU   QDB+24
QDBBPTDS EQU   QDB+22
QDBFPTDS EQU   QDB+20
QDBLELMP EQU   QDB+16
QDBFELMP EQU   QDB+12
QDBNELMS EQU   QDB+8
QDBRV001 EQU   QDB+6
QDBATTR  EQU   QDB+4
QDBQDB   EQU   QDB
RTVOLTUP EQU   KEYTABLE+368
FRIDTUP  EQU   KEYTABLE+360
FUNCTUP  EQU   KEYTABLE+356
RTORGTUP EQU   KEYTABLE+344
RTDSNTUP EQU   KEYTABLE+340
RTDDNTUP EQU   KEYTABLE+336
DIAGNTUP EQU   KEYTABLE+332
CNVRTTUP EQU   KEYTABLE+328
PERMATUP EQU   KEYTABLE+324
IPLTXTUP EQU   KEYTABLE+320
PASSWTUP EQU   KEYTABLE+316
TRTCHTUP EQU   KEYTABLE+312
THRSHTUP EQU   KEYTABLE+308
STACKTUP EQU   KEYTABLE+304
SOWATUP  EQU   KEYTABLE+300
RSRVSTUP EQU   KEYTABLE+296
RSRVFTUP EQU   KEYTABLE+292
RECFMTUP EQU   KEYTABLE+288
PRTSPTUP EQU   KEYTABLE+284
PCISTUP  EQU   KEYTABLE+280
PCIRTUP  EQU   KEYTABLE+276
OPTCDTUP EQU   KEYTABLE+272
NCPTUP   EQU   KEYTABLE+268
MODETUP  EQU   KEYTABLE+264
LRECLTUP EQU   KEYTABLE+260
LIMCTTUP EQU   KEYTABLE+256
KYLENTUP EQU   KEYTABLE+252
INTVLTUP EQU   KEYTABLE+248
GNCPTUP  EQU   KEYTABLE+244
EROPTTUP EQU   KEYTABLE+240
DSORGTUP EQU   KEYTABLE+236
DENTUP   EQU   KEYTABLE+232
CPRITUP  EQU   KEYTABLE+228
CODETUP  EQU   KEYTABLE+224
BUFSZTUP EQU   KEYTABLE+220
BUFRQTUP EQU   KEYTABLE+216
BUFOUTUP EQU   KEYTABLE+212
BUFOFTUP EQU   KEYTABLE+208
BUFNOTUP EQU   KEYTABLE+204
BUFMXTUP EQU   KEYTABLE+200
BUFLTUP  EQU   KEYTABLE+196
BUFINTUP EQU   KEYTABLE+192
BLKSZTUP EQU   KEYTABLE+188
BFTEKTUP EQU   KEYTABLE+184
BFALNTUP EQU   KEYTABLE+180
TEXTUKEY EQU   TEXTUNIT
TXTPLEND EQU   TXTPLENT
TXTUPEND EQU   TXTUNITP
SSWAPVAL EQU   SSWAPREN+1
@NM00078 EQU   JFCBX+144
JFCBXDEV EQU   JFCBX+140
JFCBXNAM EQU   JFCBX+96
@NM00077 EQU   JFCBX+94
@NM00076 EQU   JFCBX+3
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCREQ   EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCBPWBP EQU   JFCOPEN
@NM00072 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCSUL   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTNPTR EQU   INDMSIOT+152
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SIOTSSIC EQU   INDMSIOT+120
@NM00071 EQU   INDMSIOT+108
@NM00070 EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDSPD EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTAUNC EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTAKEP EQU   SIOTALTD
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00069 EQU   SIOTALTD
@NM00068 EQU   SIOTALTD
@NM00067 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00066 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00065 EQU   SIOTBYT4
SIOTRACT EQU   SIOTBYT4
SIOTRACD EQU   SIOTBYT4
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00064 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
@NM00063 EQU   SCTSBYT4
SCTVREF  EQU   SCTSBYT3
SCTALCHK EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTSPOOL EQU   INDMSIOT+48
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
SIOTSSMG EQU   SIOTTSTC
@NM00062 EQU   SIOTTSTC
SIOTINFC EQU   SIOTTSTC
@NM00061 EQU   SIOTBYT3
SIOTDSID EQU   SIOTBYT3
S3400OFF EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00060 EQU   INDMSIOT+35
@NM00059 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
SIOTVLSP EQU   INDMSIOT+24
SIOTUNAF EQU   SCTUSADD
@NM00058 EQU   @NM00056+1
SCTONLY  EQU   SCTABCND
SCTEVEN  EQU   SCTABCND
SCTABEND EQU   SCTABCND
SCTONLYC EQU   SCTABCND
SCTABCAN EQU   SCTABCND
@NM00057 EQU   SCTABCND
@NM00055 EQU   INSMSCT+173
@NM00054 EQU   SCTSTEND
SCTSYSCK EQU   SCTSTEND
SCTSTPND EQU   SCTSTEND
SCTSTSRT EQU   SCTSTEND
@NM00053 EQU   INSMSCT+168
SCTCATCT EQU   INSMSCT+166
SCTSDPSA EQU   SCTCDENT+3
SCTSDPOP EQU   SCTCDENT+2
SCTSDPCD EQU   SCTCDENT
@NM00052 EQU   INSMSCT+117
SCTPRFMF EQU   INSMSCT+116
SCTPGMNM EQU   INSMSCT+108
SCTTIOT  EQU   INSMSCT+105
@NM00051 EQU   SCTBCT
SCTJBEND EQU   SCTBCT
SCTSPSYS EQU   SCTBCT
SCTSTPLB EQU   SCTBCT
@NM00050 EQU   SCTBCT
SCTMCVOL EQU   SCTBCT
@NM00049 EQU   SCTBCT
SCTGOTTR EQU   INSMSCT+100
SCTSMF   EQU   INSMSCT+96
@NM00048 EQU   SCTSDPTY+1
SCTSDP   EQU   SCTSDPTY
SCTFSTEP EQU   SCTSDPTY
@NM00047 EQU   SCTSDPTY
@NM00046 EQU   SCTSDPTY
SCTNIUSL EQU   INSMSCT+92
@NM00045 EQU   INSMSCT+90
SCTMSSZE EQU   INSMSCT+88
SCTPCAT  EQU   INSMSCT+84
SCTSRBT  EQU   INSMSCT+76
SCTMSADR EQU   INSMSCT+72
@NM00044 EQU   INSMSCT+71
SCTXBTTR EQU   INSMSCT+68
SCTJSCAT EQU   SCTSTYPE
SCTINITB EQU   SCTSTYPE
SCTSJFHK EQU   SCTSTYPE
SCTOUTMC EQU   SCTSTYPE
SCTINPUT EQU   SCTSTYPE
SCTGOSTP EQU   SCTSTYPE
@NM00043 EQU   INSMSCT+66
SCTNSMSG EQU   INSMSCT+65
SCTSNUMB EQU   INSMSCT+64
@NM00042 EQU   INSMSCT+62
SCTRPACT EQU   INSMSCT+60
SCTSNAME EQU   INSMSCT+52
SCTSCLPC EQU   INSMSCT+44
@NM00041 EQU   INSMSCT+43
@NM00040 EQU   INSMSCT+36
@NM00039 EQU   INSMSCT+35
SCTAFACT EQU   INSMSCT+32
SCTDDNT  EQU   INSMSCT+28
@NM00038 EQU   INSMSCT+27
SCTLSIOT EQU   INSMSCT+24
@NM00037 EQU   INSMSCT+23
SCTANSCT EQU   INSMSCT+20
@NM00036 EQU   INSMSCT+19
SCTAALOC EQU   INSMSCT+16
@NM00035 EQU   INSMSCT+15
SCTFSIOT EQU   INSMSCT+12
SCTLALOC EQU   INSMSCT+10
SCTSEXEC EQU   INSMSCT+8
SCTSTIME EQU   INSMSCT+5
INCMSSTS EQU   SCTSSTAT
SCTGRPH  EQU   SCTSSTAT
SCTKEY0  EQU   SCTSSTAT
SCTDORST EQU   SCTSSTAT
SCTNOCKP EQU   SCTSSTAT
SCTNORST EQU   SCTSSTAT
EACAUSER EQU   SCTSSTAT
EAADDRBT EQU   SCTSSTAT
ACTACCNT EQU   IEFAACTB+32
ACTJNFLD EQU   IEFAACTB+31
ACTJTIME EQU   IEFAACTB+28
ACTPRGNM EQU   IEFAACTB+8
@NM00034 EQU   IEFAACTB+7
ACTNEXT  EQU   IEFAACTB+4
ACTIDENT EQU   IEFAACTB+3
ACTDSKAD EQU   IEFAACTB
@NM00033 EQU   INJMJCT+175
JCTVULDP EQU   INJMJCT+172
JCTACODE EQU   INJMJCT+168
JCTPRFMF EQU   INJMJCT+167
JCTUSER  EQU   INJMJCT+160
JCTSSD   EQU   INJMJCT+157
@NM00032 EQU   INJMJCT+156
JCTSRBT  EQU   INJMJCT+152
JCTJMRJD EQU   INJMJCT+149
JCTJMRJT EQU   INJMJCT+146
JCTJMRSS EQU   INJMJCT+143
JCTJMRTL EQU   INJMJCT+140
JCTJMRCL EQU   INJMJCT+139
JCTJMROP EQU   INJMJCT+138
JCTJMRD  EQU   INJMJCT+137
JCTJMR   EQU   INJMJCT+134
JCTCKIDT EQU   INJMJCT+118
JCTCKIDL EQU   INJMJCT+117
@NM00031 EQU   JCTSTAT2
JCTPERFM EQU   JCTSTAT2
JCTSWSM  EQU   JCTSTAT2
JCTENDIT EQU   JCTSTAT2
JCTADSPC EQU   JCTSTAT2
JCTSPSYS EQU   JCTSTAT2
@NM00030 EQU   INJMJCT+115
JCTSSTR  EQU   INJMJCT+112
JCTJSBTM EQU   JCTJSB
JCTJSBEX EQU   JCTJSB
JCTJSBAL EQU   JCTJSB
JCTJSBIN EQU   JCTJSB
@NM00029 EQU   JCTJSB
JCTVOLSQ EQU   INJMJCT+110
JCTNRCKP EQU   INJMJCT+108
JCTNTRK  EQU   INJMJCT+107
JCTCKTTR EQU   INJMJCT+104
JCTDEVT  EQU   INJMJCT+100
@NM00028 EQU   INJMJCT+99
JCTSTIOT EQU   INJMJCT+96
JCTSNUMB EQU   INJMJCT+95
JCTQIDNT EQU   INJMJCT+94
JCTEQREG EQU   INJMJCT+92
@NM00027 EQU   INJMJCT+91
JCTDETDA EQU   INJMJCT+88
JCTDSDRA EQU   JCTRSW2
JCTDSOJB EQU   JCTRSW2
JCTDSOCR EQU   JCTRSW2
JCTRESTT EQU   JCTRSW2
JCTNOCKP EQU   JCTRSW2
JCTNORST EQU   JCTRSW2
JCTNARST EQU   JCTRSW2
JCTSYSCK EQU   JCTRSW2
@NM00026 EQU   JCTRSW1
JCTSTEPR EQU   JCTRSW1
JCTCKPTR EQU   JCTRSW1
JCTCKFT  EQU   JCTRSW1
JCTCONTR EQU   JCTRSW1
JCTSTERM EQU   JCTRSW1
JCTWARMS EQU   JCTRSW1
@NM00025 EQU   JCTCCODE+3
JCTJDPOP EQU   JCTCCODE+2
JCTJDPCD EQU   JCTCCODE
@NM00024 EQU   INJMJCT+53
JCTSCT   EQU   INJMJCT+52
JCTSMRBA EQU   INJMJCT+44
@NM00023 EQU   INJMJCT+43
JCTACTAD EQU   INJMJCT+40
@NM00022 EQU   INJMJCT+39
JCTJCTX  EQU   INJMJCT+36
@NM00021 EQU   INJMJCT+35
JCTSDKAD EQU   INJMJCT+32
JCTJCSMF EQU   INJMJCT+31
JCTGDGNT EQU   INJMJCT+28
@NM00020 EQU   INJMJCT+27
JCTPDIP  EQU   INJMJCT+24
JCTJTPTN EQU   INJMJCT+16
JCTJPRTY EQU   JCTJBYTE
INCMMGL1 EQU   JCTJMGLV
INCMMGL2 EQU   JCTJMGLV
@NM00019 EQU   JCTJMGLV
INCMALL  EQU   JCTJMGLV
INCMNSET EQU   JCTJSTAT
INCMCAT  EQU   INDMCTLG
INCMSTS  EQU   JCTJSTAT
JCTABEND EQU   JCTJSTAT
@NM00018 EQU   JCTJSTAT
JCTJSTPC EQU   JCTJSTAT
@NM00017 EQU   JCTJSTAT
JCTJBLBS EQU   JCTJSTAT
JCTJSRNO EQU   INJMJCT+4
JCTIDENT EQU   INJMJCT+3
JCTDSKAD EQU   INJMJCT
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00013 EQU   CVTFIX+248
@NM00012 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00010 EQU   DSNTABLE+7
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00148 EQU   @RC00147
@RC00239 EQU   @RC00238
@RF00451 EQU   @RC00439
@RF00531 EQU   @RC00522
@RF00535 EQU   @RC00522
@RF00541 EQU   @RC00522
@RF00561 EQU   @RC00085
@RF00649 EQU   @RC00646
@RC00658 EQU   @RC00657
@RF00663 EQU   @EL00003
@RC00149 EQU   @RC00148
@RF00243 EQU   @RC00239
@RC00152 EQU   @RC00149
@ENDDATA EQU   *
         END   IEFDB414,(C'PLS1721',0701,78089)

         TITLE 'IEFDB4D0 - DAIR                                        *
                        '
IEFDB4D0 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFDB4D0  76.202'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @09,0                                            01S0001
@PSTART  LA    @10,4095(,@09)                                   01S0001
         LA    @12,4095(,@10)                                   01S0001
         USING @PSTART,@09                                      01S0001
         USING @PSTART+4095,@10                                 01S0001
         USING @PSTART+8190,@12                                 01S0001
         L     @00,@SIZDATD                                     01S0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                          01S0001
         USING @DATD,@11                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @11,8(,@13)                                      01S0001
         LR    @13,@11                                          01S0001
*DAPLPTR = R1;                         /* INCOMING R1 PTS TO DAPL    */
         LR    DAPLPTR,R1                                       01S0083
*RESPECIFY R1 UNRESTRICTED;            /* RELEASE REG 1 USAGE        */
*RETCODE = 0;                          /* INITIALIZE R15 RETURN CODE */
*                                                               01S0085
         SLR   RETCODE,RETCODE                                  01S0085
*S99RBPTR = ADDR(S99RB);               /* BEGIN BUILDING THE SVC 99
*                                         PARM LIST                  */
         LA    @08,S99RB                                        01S0086
         ST    @08,S99RBPTR                                     01S0086
*S99RBPND = '1'B;                                               01S0087
         OI    S99RBPND,B'10000000'                             01S0087
*S99RB = S99RB && S99RB;                                        01S0088
         XC    S99RB(20),S99RB                                  01S0088
*S99RBLN = LENGTH(S99RB);                                       01S0089
         MVI   S99RBLN,X'14'                                    01S0089
*S99TXTPP = ADDR(TUP(1));                                       01S0090
*                                                               01S0090
         LA    @08,TUP                                          01S0090
         ST    @08,S99TXTPP                                     01S0090
*QUIT = OFF;                           /* EXIT LOOP WHEN ON          */
         NI    QUIT,B'01111111'                                 01S0091
*DO I=1 BY 1 WHILE(QUIT = OFF);        /* LOOP FOR EACH DAIR CODE,
*                                        I.E. ONCE, EXCEPT FOR DAIR28*/
         LA    I,1                                              01S0092
         B     @DE00092                                         01S0092
@DL00092 DS    0H                                               01S0093
*  S99VERB = '00'X;                    /* FILLED IN BY INDIV. FUNCT  */
         MVI   S99VERB,X'00'                                    01S0093
*  IF DAPLDAPB -> DAIRCODE = '0028'X THEN /* MULTIPLE FUNCTION CALL ?*/
         L     @08,DAPLDAPB(,DAPLPTR)                           01S0094
         CLC   DAIRCODE(2,@08),@CB00173                         01S0094
         BNE   @RF00094                                         01S0094
*    IF DA28NOP = 0 THEN               /* VALID NUMBER IN DA28NOP ?  */
         LH    @08,DA28NOP(,@08)                                01S0095
         LTR   @08,@08                                          01S0095
         BNZ   @RF00095                                         01S0095
*      DO;                             /* NO, INVALID DA28NOP        */
*        QUIT = ON;                    /* EXIT LOOP                  */
         OI    QUIT,B'10000000'                                 01S0097
*        RETCODE = DRINVLST;           /* INDICATE INVALID PARM LIST */
         LA    RETCODE,4                                        01S0098
*      END;                            /* END OF INVALID DA28NOP     */
*    ELSE                              /* VALID DA28NOP              */
*      DO;                             /* PROCESS LIST               */
         B     @RC00095                                         01S0100
@RF00095 DS    0H                                               01S0101
*        IF I > DA28NOP THEN           /* ALL PROCESSING DONE ?      */
         L     @08,DAPLDAPB(,DAPLPTR)                           01S0101
         CH    I,DA28NOP(,@08)                                  01S0101
         BNH   @RF00101                                         01S0101
*          QUIT = ON;                  /* YES, EXIT LOOP             */
         OI    QUIT,B'10000000'                                 01S0102
*        ELSE                          /* CHECK LIST FURTHER         */
*          IF DA28OPTR(I) = 0 THEN     /* IS OPERATION PTR 0 ?       */
         B     @RC00101                                         01S0103
@RF00101 LR    @08,I                                            01S0103
         SLA   @08,2                                            01S0103
         L     @04,DAPLDAPB(,DAPLPTR)                           01S0103
         LA    @04,DA28PFOP(,@04)                               01S0103
         L     @08,DA28OPTR(@08,@04)                            01S0103
         LTR   @08,@08                                          01S0103
         BNZ   @RF00103                                         01S0103
*            DO;                       /* YES, INVALID PTR           */
*              QUIT = ON;              /* EXIT LOOP                  */
         OI    QUIT,B'10000000'                                 01S0105
*              RETCODE = DRINVLST;     /* INDICATE INVALID PARM LIST */
         LA    RETCODE,4                                        01S0106
*            END;                      /* END INVALID PTR            */
*          ELSE                        /* MORE PROCESSING NEEDED     */
*            DO;                       /* GET NEXT PTR               */
         B     @RC00103                                         01S0108
@RF00103 DS    0H                                               01S0109
*              BLOCKPTR = DA28OPTR(I); /* GET NEXT ELEMENT IN LIST   */
         LR    @08,I                                            01S0109
         SLA   @08,2                                            01S0109
         L     @04,DAPLDAPB(,DAPLPTR)                           01S0109
         LA    @15,DA28PFOP(,@04)                               01S0109
         L     BLOCKPTR,DA28OPTR(@08,@15)                       01S0109
*              DA28PFOP = 0;           /* ZERO FAILING FUNCTION PTR  */
         SLR   @08,@08                                          01S0110
         ST    @08,DA28PFOP(,@04)                               01S0110
*            END;                      /* END PTR UPDATE             */
*       END;                           /* END LIST PROCESSING        */
*  ELSE                                /* CODE NOT 28                */
*    BLOCKPTR = DAPLDAPB;              /* BASE FOR NON-28 PARM BLOCK */
         B     @RC00094                                         01S0113
@RF00094 L     BLOCKPTR,DAPLDAPB(,DAPLPTR)                      01S0113
*  IF QUIT=OFF THEN                    /* OK TO PROCEED              */
@RC00094 TM    QUIT,B'10000000'                                 01S0114
         BNZ   @RF00114                                         01S0114
*    DO;                                                        01S0115
*      TUPTRS = TUPTRS && TUPTRS;      /* INIT TEXT UNIT POINTERS    */
         XC    TUPTRS(120),TUPTRS                               01S0116
*      IF BLOCKPTR->DAIRCODE='0000'X THEN /* IS DAIR CODE 00         */
         CLC   DAIRCODE(2,BLOCKPTR),@CB01101                    01S0117
         BNE   @RF00117                                         01S0117
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR00                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 00 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR00 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR00 IS INVOKED       */
*/*            IN ORDER TO SEARCH THE DSAB CHAIN BY DDNAME OR        */
*/*            DSNAME FOR INFORMATION ABOUT A DATA SET.              */
*/*                                                                  */
*/* OPERATION - THE DSNAME CHECK ROUTINE IS INVOKED TO DETERMINE     */
*/*             IF A VALID DATA SET NAME HAS BEEN SUPPLIED.  IF      */
*/*             THE NAME IS INVALID, THEN THE RETURN CODE IS SET     */
*/*             TO 4(INVALID PARAMETER LIST) AND NO FURTHER          */
*/*             PROCESSING IS DONE.  IF NEITHER DSNAME NOR DDNAME    */
*/*             IS SPECIFIED, THE RETURN CODE IS SET TO 4 AND        */
*/*             NO FURTHER PROCESSING IS DONE.                       */
*/*                                                                  */
*/*             IF THE DSNAME IS VALID OR DDNAME WAS SPECIFIED,      */
*/*             THEN PROCESSING CONTINUES.  THE INFORMATION          */
*/*             RETRIEVAL VERB CODE IS SET.  TEXT UNITS ARE BUILT    */
*/*             REQUESTING RETURN OF DSORG AND DYNAMIC ALLOCATION    */
*/*             ATTRIBUTES.  IF THE SEARCH IS BY DSNAME, THE DSNAME  */
*/*             TEXT UNIT IS BUILT AND DYNAMIC ALLOCATION IS INVOKED.*/
*/*             IF THE SEARCH IS BY DDNAME, THE RETURN DATA SET TYPE */
*/*             TEXT UNIT IS BUILT AND THE DDNAME TEXT UNIT          */
*/*             IS BUILT.                                            */
*/*                                                                  */
*/*             IF SUCCESSFUL (R15 = 0) THEN DATA FROM THE TEXT      */
*/*             UNITS IS STORED INTO THE DAIR PARM BLOCK, THE DA00DSE*/
*/*             BIT IS TURNED ON (SET TO 1) TO INDICATE THE SEARCH BY*/
*/*             DSNAME OR DDNAME WAS SUCCESSFUL (THE PROPER DSAB WAS */
*/*             FOUND).                                              */
*/*                                                                  */
*/*             IF R15 ^= O AFTER INVOKING DYNAMIC ALLOCATION,       */
*/*             THE DA00DSE BIT IS SET TO OFF(0) AND THE             */
*/*             APPROPRIATE DAIR  RETURN CODE IS SET, (PLEASE SEE    */
*/*             RETURN CODE SECTION).                                */
*/*                                                                  */
*/* ENTRY - DAIR00(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR00 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*                                                                  */
*/*   OUTPUT - DA00DSE SET ON, DA00DSO                               */
*/*                                                                  */
*/*   RETURN CODE - REG 15 IS SET TO ZERO                            */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*                                                                  */
*/*   OUTPUT - DA00DSE SET OFF                                       */
*/*                                                                  */
*/*   RETURN CODE - THE FOLLOWING RETURN CODE IS ISSUED              */
*/*                                                                  */
*/*                52 - REQUEST FAILED BY INSTALLATION EXIT          */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*CALL DSNCHECK (DA00CTL,DA00PDSN);     /* VALIDY CHECK DSNAME        */
         LA    @08,DA00CTL(,BLOCKPTR)                           02S0119
         ST    @08,@AL00001                                     02S0119
         LA    @08,DA00PDSN(,BLOCKPTR)                          02S0119
         ST    @08,@AL00001+4                                   02S0119
         LA    @01,@AL00001                                     02S0119
         BAL   @14,DSNCHECK                                     02S0119
*IF R15 ^= 0                           /* IS DSNAME VALID ?          */
*  × (DSNBUF(1) = ' ' & DA00DDN(1) = ' ') THEN /*  IS A DATA SET NAME
*                                              OR DDNAME PRESENT ?   */
         LTR   R15,R15                                          02S0120
         BNZ   @RT00120                                         02S0120
         CLI   DSNBUF,C' '                                      02S0120
         BNE   @RF00120                                         02S0120
         CLI   DA00DDN(BLOCKPTR),C' '                           02S0120
         BNE   @RF00120                                         02S0120
@RT00120 DS    0H                                               02S0121
*  RETCODE = DRINVLST;                 /* INVALID PARM LIST RETCODE  */
         LA    RETCODE,4                                        02S0121
*ELSE                                  /* VALID PARM LIST            */
*  DO;                                 /* SET UP FOR DYNAMIC ALLOC   */
         B     @RC00120                                         02S0122
@RF00120 DS    0H                                               02S0123
*    S99VERB = S99VRBIN;               /* SET INFORMATION RETRIEVAL
*                                         VERB CODE                  */
         MVI   S99VERB,X'07'                                    02S0123
*                           /* GENERATE TEXT UNITS        */    02S0124
*                                                               02S0124
*       DO;                                                     02S0124
*         TUP(1) = ADDR(TU(1));                                 02S0125
         LA    @08,TU                                           02S0125
         ST    @08,TUP                                          02S0125
*         TUP(1)->S99TUKEY = DINRTORG;                          02S0126
         MVC   S99TUKEY(2,@08),@CB00910                         02S0126
*         TUP(1)->S99TUNUM = 1;                                 02S0127
         LA    @04,1                                            02S0127
         STCM  @04,3,S99TUNUM(@08)                              02S0127
*         TUP(1)->S99TULNG = 2;                                 02S0128
         MVC   S99TULNG(2,@08),@CH00062                         02S0128
*         TUP(1)->S99TUPAR(1:2) = ZERO;                         02S0129
         SLR   @03,@03                                          02S0129
         STCM  @03,3,S99TUPAR(@08)                              02S0129
*       END;                                                    02S0130
*                                                               02S0130
*       DO;                                                     02S0131
*         TUP(2) = ADDR(TU(2));                                 02S0132
         LA    @08,TU+14                                        02S0132
         ST    @08,TUP+4                                        02S0132
*         TUP(2)->S99TUKEY = DINRTATT;                          02S0133
         MVC   S99TUKEY(2,@08),@CB00159                         02S0133
*         TUP(2)->S99TUNUM = 1;                                 02S0134
         STCM  @04,3,S99TUNUM(@08)                              02S0134
*         TUP(2)->S99TULNG = 1;                                 02S0135
         STCM  @04,3,S99TULNG(@08)                              02S0135
*         TUP(2)->S99TUPAR(1:1) = ZERO;                         02S0136
         STC   @03,S99TUPAR(,@08)                               02S0136
*       END;                                                    02S0137
*    IF DSNBUF(1) ^= ' ' THEN          /* RETURN DSNAME IF PRESENT   */
*                                                               02S0138
         CLI   DSNBUF,C' '                                      02S0138
         BE    @RF00138                                         02S0138
*         DO;                                                   02S0139
*           TUP(3) = ADDR(TUDSN);                               02S0140
         LA    @08,TUDSN                                        02S0140
         ST    @08,TUP+8                                        02S0140
*           TUP(3)->S99TUKEY = DINDSNAM;                        02S0141
         MVC   S99TUKEY(2,@08),@CB00896                         02S0141
*           TUP(3)->S99TUNUM = 1;                               02S0142
         STCM  @04,3,S99TUNUM(@08)                              02S0142
*           TUP(3)->S99TULNG = LENGTH(DSNBUF);                  02S0143
         MVC   S99TULNG(2,@08),@CH00092                         02S0143
*           TUP(3)->S99TUPAR(1:LENGTH(DSNBUF)) = DSNBUF;        02S0144
         MVC   S99TUPAR(44,@08),DSNBUF                          02S0144
*         END;                                                  02S0145
*    ELSE                              /* NO DSNAME PRESENT          */
*      DO;                             /* SEARCH BY DDNAME           */
*                                                               02S0146
         B     @RC00138                                         02S0146
@RF00138 DS    0H                                               02S0147
*           DO;                                                 02S0147
*             TUP(4) = ADDR(TU(4));                             02S0148
         LA    @08,TU+42                                        02S0148
         ST    @08,TUP+12                                       02S0148
*             TUP(4)->S99TUKEY = DINDDNAM;                      02S0149
         MVC   S99TUKEY(2,@08),@CB00894                         02S0149
*             TUP(4)->S99TUNUM = 1;                             02S0150
         LA    @04,1                                            02S0150
         STCM  @04,3,S99TUNUM(@08)                              02S0150
*             TUP(4)->S99TULNG = LENGTH(DA00DDN);               02S0151
         MVC   S99TULNG(2,@08),@CH00048                         02S0151
*             TUP(4)->S99TUPAR(1:LENGTH(DA00DDN)) = DA00DDN;    02S0152
         MVC   S99TUPAR(8,@08),DA00DDN(BLOCKPTR)                02S0152
*           END;                                                02S0153
*                                                               02S0153
*           DO;                                                 02S0154
*             TUP(5) = ADDR(TU(5));                             02S0155
         LA    @08,TU+56                                        02S0155
         ST    @08,TUP+16                                       02S0155
*             TUP(5)->S99TUKEY = DINRTTYP;                      02S0156
         MVC   S99TUKEY(2,@08),@CB00917                         02S0156
*             TUP(5)->S99TUNUM = 1;                             02S0157
         STCM  @04,3,S99TUNUM(@08)                              02S0157
*             TUP(5)->S99TULNG = 1;                             02S0158
         STCM  @04,3,S99TULNG(@08)                              02S0158
*             TUP(5)->S99TUPAR(1:1) = ZERO;                     02S0159
         MVI   S99TUPAR(@08),X'00'                              02S0159
*           END;                                                02S0160
*      END;                            /* END BUILDING DDN SRCH TEXT */
*                                                               02S0161
*     TUP(5) = TUP(5) × '80000000'X;                            02S0162
@RC00138 L     @08,TUP+16                                       02S0162
         O     @08,@CF01105                                     02S0162
         ST    @08,TUP+16                                       02S0162
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0163
         LA    R1,S99RBPTR                                      02S0163
*     /*MACDATE Y-2 73082*/                                     02S0164
*     SVC (99);                                                 02S0164
         SVC   99                                               02S0164
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT R15 USAGE         */
*    IF R15 = 0 THEN                   /* WAS DYN/ALLOC SUCCESSFUL ? */
         LTR   R15,R15                                          02S0166
         BNZ   @RF00166                                         02S0166
*      DO;                             /* YES,STORE RETURNED DATA IN
*                                         DAIR PARM LIST             */
*        DA00DSE = ON;                 /* INDICATE DDNAME OR DSNAME
*                                         FOUND IN DSAB CHAIN        */
         OI    DA00DSE(BLOCKPTR),B'00000010'                    02S0168
*        DA00DSO = TUP(1)->S99TUPAR(1); /* RETURN DSORG              */
         L     @14,TUP                                          02S0169
         MVC   DA00DSO(1,BLOCKPTR),S99TUPAR(@14)                02S0169
*        IF TUP(2)->PERMALOC = ON THEN /* IS DSAB MARKED PERM ALLOC? */
         L     @14,TUP+4                                        02S0170
         TM    PERMALOC(@14),B'00100000'                        02S0170
         BNO   @RF00170                                         02S0170
*          DA00PERM = ON;              /* YES, TURN ON DAIR PERM BIT */
         OI    DA00PERM(BLOCKPTR),B'00001000'                   02S0171
*        IF DSNBUF(1) = ' ' THEN       /* WAS SEARCH BY DDNAME ?     */
@RF00170 CLI   DSNBUF,C' '                                      02S0172
         BNE   @RF00172                                         02S0172
*          IF TUP(5)->TERMINAL = ON THEN /* TERM BIT ON IN TEXT ?    */
         L     @14,TUP+16                                       02S0173
         TM    TERMINAL(@14),B'01000000'                        02S0173
         BNO   @RF00173                                         02S0173
*            DA00TERM = ON;            /* SET TERM BIT IN DAIR LIST  */
         OI    DA00TERM(BLOCKPTR),B'00000001'                   02S0174
*      END;                            /* END PROCESSING SUCCESSFUL
*                                         RETURN OF DATA             */
*    ELSE                              /* DYNAMIC ALLOCATION FAILED  */
*      DA00DSE = OFF;                  /* INDICATE ENTRY NOT FOUND   */
         B     @RC00166                                         02S0176
@RF00166 NI    DA00DSE(BLOCKPTR),B'11111101'                    02S0176
*      IF R15 = 8 THEN                 /* REQUEST DENIED BY     02S0177
*                                         INSTALLATION EXIT ?        */
@RC00166 C     R15,@CF00048                                     02S0177
         BNE   @RF00177                                         02S0177
*        RETCODE = DRREQDEN;           /* SET DAIR RETURN CODE TO
*                                         INSTALLATION EXIT FAILURE  */
         LA    RETCODE,52                                       02S0178
*  END;                                /* END DYN/ALLOC SETUP        */
@RF00177 DS    0H                                               02S0180
*        END;                          /* END CODE 00                */
@RC00120 DS    0H                                               01S0181
*      IF BLOCKPTR->DAIRCODE='0004'X THEN /* IS DAIR CODE 04         */
@RF00117 CLC   DAIRCODE(2,BLOCKPTR),@CB00155                    01S0181
         BNE   @RF00181                                         01S0181
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR04                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 04 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR04 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR04 IS INVOKED       */
*/*            IN ORDER TO SEARCH THE DSAB CHAIN OR CATALOG          */
*/*            (USING LOCATE) BY DSNAME TO RETURN INFORMATION        */
*/*            ABOUT THE DATA SET.                                   */
*/*                                                                  */
*/* OPERATION - THE DSNAME CHECK ROUTINE IS INVOKED TO DETERMINE     */
*/*             IF A VALID DATA SET NAME HAS BEEN SUPPLIED.  IF      */
*/*             THE NAME IS INVALID OR HAS NOT BEEN SPECIFIED, THE   */
*/*             RETURN CODE IS SET TO 4(INVALID PARAMETER LIST) AND  */
*/*             NO FURTHER PROCESSING IS DONE.                       */
*/*                                                                  */
*/*             IF THE DSNAME IS VALID, THE INFORMATION RETRIEVAL    */
*/*             VERB CODE IS SET.  TEXT UNITS ARE BUILT REQUESTING   */
*/*             RETURN OF THE DSORG AND DYNAMIC ALLOCATION IS        */
*/*             INVOKED TO SEARCH THE DSAB CHAIN.                    */
*/*                                                                  */
*/*             IF SUCCESSFUL (R15=0), THE DA04DSE BIT IS TURNED     */
*/*             ON(SET TO 1) INDICATING DSNAME FOUND IN DSAB CHAIN   */
*/*             AND THE DSORG IS STORED IN THE DAIR PARM BLOCK.      */
*/*                                                                  */
*/*             IF THE RETURN CODE FROM DYNAMIC ALLOCATION WAS NOT   */
*/*             ZERO(R15^=0), IT IS CHECKED FOR BEING 8 (REQUEST     */
*/*             DENIED BY INSTALLATION EXIT).  IF SO, THE RETURN     */
*/*             CODE IS SET TO 52(REQUEST DENIED BY INSTALLATION     */
*/*             EXIT) AND NO FURTHER PROCESSING IS DONE.             */
*/*                                                                  */
*/*             IF THE RETURN CODE IS NOT 8, THE S99ERROR            */
*/*             FIELD IS CHECKED FOR DSNAME NOT FOUND.               */
*/*             IF THE DSNAME WAS NOT FOUND, A LOCATE IS ISSUED      */
*/*             FOR THE DSNAME TO DETERMINE IF IT IS IN THE          */
*/*             CATALOG.  THE RETURN CODE IN R15 IS STORED IN        */
*/*             THE DA04CTRC FIELD.  IF DA04CTRC IS ZERO, THE        */
*/*             DA04CAT BIT IS TURNED ON(SET TO 1) INDICATING        */
*/*             DSNAME FOUND IN THE CATALOG.  IF DA04CTRC IS NOT     */
*/*             ZERO, DA04CAT IS TURNED OFF(SET TO 0) AND THE        */
*/*             RETURN CODE SET TO 8(INDICATING CATALOG MANAGEMENT   */
*/*             ERROR).                                              */
*/*                                                                  */
*/* ENTRY - DAIR04(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR04 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*                                                                  */
*/*   OUTPUT - DA04DSE SET ON IF DSNAME FOUND ALLOCATED, DA04DSO     */
*/*            DA04CAT SET ON IF FOUND IN CATALOG                    */
*/*                                                                  */
*/*   RETURN CODE - REG 15 SET TO ZERO                               */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*                                                                  */
*/*   OUTPUT - DA04DSE AND DA04CAT SET OFF                           */
*/*                                                                  */
*/*   RETURN CODE - THE FOLLOWING RETURN CODES ARE ISSUED            */
*/*                                                                  */
*/*                 8 - CATALOG MANAGEMENT ERROR, CATALOG RETURN     */
*/*                     CODE IN DA04CTRC                             */
*/*                                                                  */
*/*                52 - REQUEST DENIED BY INSTALLATION EXIT          */
*/********************************************************************/
*DA04CTRC = 0;                         /* ZERO CATALOG ERROR CODE    */
         SLR   @14,@14                                          02S0183
         STH   @14,DA04CTRC(,BLOCKPTR)                          02S0183
*CALL DSNCHECK (DA04CTL,DA04PDSN);     /* VALIDITY CHECK DSNAME      */
         LA    @14,DA04CTL(,BLOCKPTR)                           02S0184
         ST    @14,@AL00001                                     02S0184
         LA    @14,DA04PDSN(,BLOCKPTR)                          02S0184
         ST    @14,@AL00001+4                                   02S0184
         LA    @01,@AL00001                                     02S0184
         BAL   @14,DSNCHECK                                     02S0184
*IF R15 ^= 0 × DSNBUF(1) = ' ' THEN    /* INVALID DSNAME OR DSNAME
*                                         NOT PRESENT                */
         LTR   R15,R15                                          02S0185
         BNZ   @RT00185                                         02S0185
         CLI   DSNBUF,C' '                                      02S0185
         BNE   @RF00185                                         02S0185
@RT00185 DS    0H                                               02S0186
*  RETCODE = DRINVLST;                 /* INVALID PARM LIST RETCODE  */
         LA    RETCODE,4                                        02S0186
*ELSE                                  /* VALID PARM LIST            */
*  DO;                                 /* PROCESS VALID PARM LIST    */
         B     @RC00185                                         02S0187
@RF00185 DS    0H                                               02S0188
*    S99VERB = S99VRBIN;               /* SET INFORMATION RETRIEVAL
*                                         VERB CODE                  */
*                                                               02S0188
*                                                               02S0188
         MVI   S99VERB,X'07'                                    02S0188
*       DO;                                                     02S0189
*         TUP(1) = ADDR(TU(1));                                 02S0190
         LA    @14,TU                                           02S0190
         ST    @14,TUP                                          02S0190
*         TUP(1)->S99TUKEY = DINRTORG;                          02S0191
         MVC   S99TUKEY(2,@14),@CB00910                         02S0191
*         TUP(1)->S99TUNUM = 1;                                 02S0192
         LA    @08,1                                            02S0192
         STCM  @08,3,S99TUNUM(@14)                              02S0192
*         TUP(1)->S99TULNG = 2;                                 02S0193
         MVC   S99TULNG(2,@14),@CH00062                         02S0193
*         TUP(1)->S99TUPAR(1:2) = ZERO;                         02S0194
         SLR   @04,@04                                          02S0194
         STCM  @04,3,S99TUPAR(@14)                              02S0194
*       END;                                                    02S0195
*                                                               02S0195
*       DO;                                                     02S0196
*         TUP(2) = ADDR(TUDSN);                                 02S0197
         LA    @14,TUDSN                                        02S0197
         ST    @14,TUP+4                                        02S0197
*         TUP(2)->S99TUKEY = DINDSNAM;                          02S0198
         MVC   S99TUKEY(2,@14),@CB00896                         02S0198
*         TUP(2)->S99TUNUM = 1;                                 02S0199
         STCM  @08,3,S99TUNUM(@14)                              02S0199
*         TUP(2)->S99TULNG = LENGTH(DSNBUF);                    02S0200
         MVC   S99TULNG(2,@14),@CH00092                         02S0200
*         TUP(2)->S99TUPAR(1:LENGTH(DSNBUF)) = DSNBUF;          02S0201
         MVC   S99TUPAR(44,@14),DSNBUF                          02S0201
*       END;                                                    02S0202
*                                                               02S0202
*     TUP(2) = TUP(2) × '80000000'X;                            02S0203
         O     @14,@CF01105                                     02S0203
         ST    @14,TUP+4                                        02S0203
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0204
         LA    R1,S99RBPTR                                      02S0204
*     /*MACDATE Y-2 73082*/                                     02S0205
*     SVC (99);                                                 02S0205
         SVC   99                                               02S0205
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT R15 USAGE         */
*    IF R15 = 0 THEN                   /* WAS DSNAME FOUND ?         */
         LTR   R15,R15                                          02S0207
         BNZ   @RF00207                                         02S0207
*      DO;                             /* YES, RETURN DSORG          */
*        DA04DSE = ON;                 /* TURN ON DATA SET FOUND IN
*                                         DSAB CHAIN                 */
         OI    DA04DSE(BLOCKPTR),B'00000010'                    02S0209
*        DA04DSO = TUP(1) -> S99TUPAR(1); /* RETURN DSORG            */
         L     @14,TUP                                          02S0210
         MVC   DA04DSO(1,BLOCKPTR),S99TUPAR(@14)                02S0210
*      END;                            /* END DATA RETURN            */
*    ELSE                              /* NOT SUCCESSFUL             */
*      DO;                             /* PROCESS NON ZERO RETURN    */
         B     @RC00207                                         02S0212
@RF00207 DS    0H                                               02S0213
*        DA04DSE = OFF;                /* NOT FOUND IN DSAB CHAIN    */
         NI    DA04DSE(BLOCKPTR),B'11111101'                    02S0213
*        IF R15 = 8 THEN               /* WAS REQUEST FAILED BY 02S0214
*                                         INSTALLATION EXIT ?        */
         C     R15,@CF00048                                     02S0214
         BNE   @RF00214                                         02S0214
*          RETCODE = DRREQDEN;         /* YES, SET DAIR INSTALLATION
*                                         EXIT RETURN CODE           */
         LA    RETCODE,52                                       02S0215
*        ELSE                          /* NOT INSTALLATION EXIT ERROR*/
*          IF S99ERROR = RCDSNFND THEN /* DATA SET NOT FOUND ?       */
         B     @RC00214                                         02S0216
@RF00214 CLC   S99ERROR(2),@CB00292                             02S0216
         BNE   @RF00216                                         02S0216
*            DO;                       /* YES, BUILD LOCATE PARM LIST*/
*              CTRL = '44000000'X;     /* INDICATE SEARCH BY DSNAME  */
         MVC   CTRL(4),@CF01108                                 02S0218
*              LOCDSPTR = ADDR(DSNBUF);/* ADDRESS OF DSNAME          */
         LA    @14,DSNBUF                                       02S0219
         ST    @14,LOCDSPTR                                     02S0219
*              NOPTION = 0;            /* ZERO OPTION FIELD          */
         SLR   @14,@14                                          02S0220
         ST    @14,NOPTION                                      02S0220
*              AREAPTR = ADDR(LOCAREA);/* LOCATE WORK AREA ADDRESS   */
         LA    @14,LOCAREA                                      02S0221
         ST    @14,AREAPTR                                      02S0221
*              R1 = ADDR(LOCPARM);     /* GET ADDRESS OF PARM LIST   */
         LA    R1,LOCPARM                                       02S0222
*              GEN( LOCATE (1) );      /* ISSUE LOCATE               */
          LOCATE (1)
*              DA04CTRC = R15;         /* SAVE LOCATE RETURN CODE    */
         STH   R15,DA04CTRC(,BLOCKPTR)                          02S0224
*              IF DA04CTRC = 0 THEN    /* WAS DATA SET FOUND ?       */
         LH    @14,DA04CTRC(,BLOCKPTR)                          02S0225
         LTR   @14,@14                                          02S0225
         BNZ   @RF00225                                         02S0225
*                DA04CAT = ON;         /* YES,INDICATE FOUND IN CATLG*/
         OI    DA04CAT(BLOCKPTR),B'00000100'                    02S0226
*              ELSE                    /* DATA SET NOT FOUND         */
*                DO;                   /* INDICATE NOT FOUND         */
         B     @RC00225                                         02S0227
@RF00225 DS    0H                                               02S0228
*                  DA04CAT = OFF;      /* INDICATE NOT FOUND IN CATLG*/
         NI    DA04CAT(BLOCKPTR),B'11111011'                    02S0228
*                  RETCODE = DRCATMGT; /* CATLG MANAGEMENT ERROR     */
         LA    RETCODE,8                                        02S0229
*                END;                  /* END CATLG MGT ERROR CODE   */
*            END;                      /* END DSNAME NOT FOUND CODE  */
*          ELSE;                       /* NOT DSNAME NOT FOUND       */
@RF00216 DS    0H                                               02S0233
*      END;                            /* END NON ZERO RETURN        */
@RC00216 DS    0H                                               02S0233
@RC00214 DS    0H                                               02S0234
*  END;                                /* END PROCESS VALID PARM LIST*/
@RC00207 DS    0H                                               02S0235
*        END;                          /* END CODE 04                */
@RC00185 DS    0H                                               01S0236
*      IF BLOCKPTR->DAIRCODE='0008'X THEN /* IS DAIR CODE 08         */
@RF00181 CLC   DAIRCODE(2,BLOCKPTR),@CB00157                    01S0236
         BNE   @RF00236                                         01S0236
*        CALL DAIR08;                  /* YES, EXECUTE CODE          */
         BAL   @14,DAIR08                                       01S0237
*      IF BLOCKPTR->DAIRCODE='000C'X THEN /* IS DAIR CODE 0C         */
@RF00236 CLC   DAIRCODE(2,BLOCKPTR),@CB00159                    01S0238
         BNE   @RF00238                                         01S0238
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR0C                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 0C PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR0C PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR0C IS INVOKED       */
*/*            IN ORDER TO CONCATENATE DATA SETS BY DDNAME.          */
*/*                                                                  */
*/* OPERATION - THE DA0CNUMB FIELD IS TESTED FOR 0(NO DDNAMES        */
*/*             SUPPLIED).  IF 0, THE RETURN CODE IS SET TO 4        */
*/*             (INVLAID PARAMETER LIST) AND NO FURTHER PROCESSING   */
*/*             IS DONE.                                             */
*/*                                                                  */
*/*             IF THE DA0CNUMB FIELD IS 1, THERE IS NOTHING TO      */
*/*             CONCATENATE, THE RETURN CODE IS SET TO 0 AND         */
*/*             NO FURTHER PROCESSING IS DONE.                       */
*/*                                                                  */
*/*             IF NONE OF THE ABOVE CONDITIONS EXIST, THERE ARE     */
*/*             DATA SETS TO CONCATENATE AND PROCESSING CONTINUES.   */
*/*             THE DA0CNUMB IS USED IN A CALCULATION TO DETERMINE   */
*/*             THE AMOUNT OF CORE NECESSARY TO BUILD TEXT UNITS     */
*/*             FOR CONCATENATION.  A GETMAIN (R FORM) IS ISSUED     */
*/*             AND THE TEXT UNIT IS BUILT IN THE GOTTEN CORE.       */
*/*             DYNAMIC ALLOCATION IS THEN INVOKED.                  */
*/*                                                                  */
*/*             THE RETURN CODE(IN REG15) FROM DYNAMIC ALLOCATION    */
*/*             IS THEN EXAMINED.                                    */
*/*                                                                  */
*/*             IF REG15 = 8, THE DAIR RETURN CODE IS SET TO 52      */
*/*             (REQUEST DENIED BY INSTALLATION EXIT), THE GOTTEN    */
*/*             CORE IS FREED AND NO FURTHER PROCESSING IS DONE.     */
*/*                                                                  */
*/*             IF R15 = 12, THE S99ERROR CODE IS TESTED FOR         */
*/*             RCINPARM (INVALID PARM IN TEXT UNIT).  IF THE        */
*/*             S99ERROR WAS RCINPARM, THE DA0CDARC FIELD IS SET     */
*/*             TO DRDDNSPC (BLANK DDNAME SPECIFIED) OTHERWISE       */
*/*             THE S99ERROR IS STORED IN THE DA0CDARC AND THE       */
*/*             DAIR RETURN IS SET TO 12.  THE GOTTEN CORE IS        */
*/*             FREED AND NO FURTHER PROCESSING IS DONE.             */
*/*                                                                  */
*/*             IF R15 = 4, THE S99ERROR CODE IS TESTED FOR RCDDNFND */
*/*             (SPECIFIED DDNAME NOT FOUND).  IF THE S99ERROR       */
*/*             WAS RCDDNFND, THE DA0CDARC FIELD IS SET TO DRDDNFND  */
*/*             (DDNAME NOT FOUND).  OTHERWISE, THE S99ERROR         */
*/*             CODE IS STORED IN DA0CDARC, AND THE RETURN CODE      */
*/*             IS SET TO 12.  THE GOTTEN CORE IS FREED AND          */
*/*             NO FURTHER PROCESSING IS DONE.                       */
*/*                                                                  */
*/*             IF NO ERROR CONDITION EXISTS, THE GOTTEN CORE        */
*/*             IS FREED AND NO FURTHER PROCESSING IS DONE.          */
*/*                                                                  */
*/* ENTRY - DAIR0C(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR0C PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   RETURN CODE - REG15 SET TO ZERO(SUCCESSFUL CONCATENATION)      */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*   RETURN CODE - REG15 IS SET TO ONE OF THE FOLLOWING             */
*/*                 4 - INVALID PARAMETER LIST                       */
*/*                12 - DYNAMIC ALLOCATION ERROR                     */
*/*                52 - REQUEST DENIED BY INSTALLATION EXIT          */
*/*                                                                  */
*/********************************************************************/
*DA0CDARC = 0;                         /* ZERO DARC FIELD            */
         SLR   @14,@14                                          02S0240
         STH   @14,DA0CDARC(,BLOCKPTR)                          02S0240
*S99VERB = S99VRBCC;                   /* SET VERB CODE TO CONCAT    */
         MVI   S99VERB,X'03'                                    02S0241
*IF DA0CNUMB <= 0 THEN                 /* ARE THERE DD'S TO CONCAT ? */
         CH    @14,DA0CNUMB(,BLOCKPTR)                          02S0242
         BL    @RF00242                                         02S0242
*  RETCODE = DRINVLST;                 /* NO, RETURN 4(INVALID PARM) */
         LA    RETCODE,4                                        02S0243
*ELSE                                  /* DD COUNT GREATER THAN ZERO */
*  IF DA0CNUMB = 1 THEN                /* IF COUNT= 1, NO PROCESSING */
         B     @RC00242                                         02S0244
@RF00242 CLC   DA0CNUMB(2,BLOCKPTR),@CH00035                    02S0244
         BNE   @RF00244                                         02S0244
*    RETCODE = 0;                      /* RETURN 0(SUCCESSFUL)       */
         SLR   RETCODE,RETCODE                                  02S0245
*  ELSE                                /* DD COUNT GREATER THAN ONE  */
*    DO;                               /* PROCESS CONCAT REQUEST     */
         B     @RC00244                                         02S0246
@RF00244 DS    0H                                               02S0247
*      RESPECIFY R0 RESTRICTED;        /* RESTRICT USAGE OF REG0     */
*      R0 = (10 *DA0CNUMB) +4;         /* CALCULATE CORE FOR TEXT    */
         LH    R0,DA0CNUMB(,BLOCKPTR)                           02S0248
         MH    R0,@CH00033                                      02S0248
         AL    R0,@CF00059                                      02S0248
*      R0 =R0 × SUBPOOL1;              /* SET SUBPOOL TO 1           */
         O     R0,@CF00150                                      02S0249
*      CORESIZE = R0;                  /* SAVE SIZE AND SUBPOOL      */
         ST    R0,CORESIZE                                      02S0250
*      GEN (GETMAIN R,LV=(0));         /* ISSUE R FORM GETMAIN       */
         GETMAIN R,LV=(0)
*      RESPECIFY R0 UNRESTRICTED;                               02S0252
*      TUP(1) = R1;                    /* SAVE ADDRESS OF GOTTEN CORE*/
         ST    R1,TUP                                           02S0253
*      TUP(1) = TUP(1) × '80000000'X;  /* INDICATE LAST TEXT UNIT    */
         L     @14,TUP                                          02S0254
         O     @14,@CF01105                                     02S0254
         ST    @14,TUP                                          02S0254
*      TUP(1) ->S99TUKEY = DCCDDNAM;   /* DDNAME KEY                 */
         MVC   S99TUKEY(2,@14),@CB00894                         02S0255
*      TUP(1) ->S99TUNUM = DA0CNUMB;   /* NUMBER OF TEXT ENTRIES     */
         MVC   S99TUNUM(2,@14),DA0CNUMB(BLOCKPTR)               02S0256
*      S99TUFP = TUP(1) + 4;           /* GET ADDRESS TO MOVE DDNAMES*/
         AL    @14,@CF00059                                     02S0257
         LR    S99TUFP,@14                                      02S0257
*      DO I = 1 BY 1 TO DA0CNUMB;      /* CONTROL # OF MOVES         */
         LA    I,1                                              02S0258
         B     @DE00258                                         02S0258
@DL00258 DS    0H                                               02S0259
*        S99TULEN = 8;                 /* LENGTH OF DDNAME           */
         MVC   S99TULEN(2,S99TUFP),@CH00048                     02S0259
*        S99TUPRM(1:8) = DA0CDDN(I);   /* MOVE DDNAME INTO TEXT UNIT */
         LR    @14,I                                            02S0260
         SLA   @14,3                                            02S0260
         LA    @04,DA0CNUMB(,BLOCKPTR)                          02S0260
         ALR   @04,@14                                          02S0260
         AL    @04,@CF01192                                     02S0260
         MVC   S99TUPRM(8,S99TUFP),DA0CDDN(@04)                 02S0260
*        S99TUFP = S99TUFP + 10;       /* INCREMENT TO NEXT SLOT     */
         AL    S99TUFP,@CF00033                                 02S0261
*      END;                            /* END DDNAME MOVES           */
         AL    I,@CF00035                                       02S0262
@DE00258 CH    I,DA0CNUMB(,BLOCKPTR)                            02S0262
         BNH   @DL00258                                         02S0262
*      R1 = ADDR(S99RBPTR);            /* GET PARM PTR ADDRESS       */
*                                                               02S0263
         LA    R1,S99RBPTR                                      02S0263
*       /*MACDATE Y-2 73082*/                                   02S0264
*       SVC (99);                                               02S0264
         SVC   99                                               02S0264
*      RESPECIFY R15 RESTRICTED;       /* RESTRICT REG15 USAGE       */
*      IF R15 = 8 THEN                 /* REQUEST DENIED ?           */
         C     R15,@CF00048                                     02S0266
         BNE   @RF00266                                         02S0266
*        RETCODE = DRREQDEN;           /* SET RETURN CODE TO REQUEST
*                                         DENIED BY INSTALLATION EXIT*/
         LA    RETCODE,52                                       02S0267
*      IF R15 = 12 THEN                /* INVALID PARM LIST ?        */
@RF00266 C     R15,@CF00034                                     02S0268
         BNE   @RF00268                                         02S0268
*        DO;                           /* YES, EXAMINE ERROR CODES   */
*          IF S99ERROR = RCINPARM THEN /* INVALID PARM IN TEXT UNIT? */
         CLC   S99ERROR(2),@CB00248                             02S0270
         BNE   @RF00270                                         02S0270
*            DA0CDARC = DRDDNSPC;      /* YES, SET ERROR CODE IN DARC*/
         MVC   DA0CDARC(2,BLOCKPTR),@CH00179                    02S0271
*          ELSE                        /* NOT INVALID TEXT PARMS     */
*            DA0CDARC = S99ERROR;      /* STORE DYNAMIC ALLOCATION
*                                         ERROR CODE IN DARC         */
         B     @RC00270                                         02S0272
@RF00270 LH    @14,S99ERROR                                     02S0272
         N     @14,@CF01193                                     02S0272
         STH   @14,DA0CDARC(,BLOCKPTR)                          02S0272
*          RETCODE = DRDYNERR;         /* INDICATE DYNAMIC ALLOCATION
*                                         ERROR                      */
@RC00270 LA    RETCODE,12                                       02S0273
*        END;                          /* END INVALID PARM LIST CODE */
*      IF R15 = 4 THEN                 /* ENVIRONMENTAL ERROR ?      */
@RF00268 C     R15,@CF00059                                     02S0275
         BNE   @RF00275                                         02S0275
*        DO;                           /* YES                        */
*          IF S99ERROR = RCDDNFND THEN /* DDNAME NOT FOUND ?         */
         CLC   S99ERROR(2),@CB00288                             02S0277
         BNE   @RF00277                                         02S0277
*            DA0CDARC = DRDDNFND;      /* YES,STORE ERRCODE INTO DARC*/
         MVC   DA0CDARC(2,BLOCKPTR),@CH00181                    02S0278
*          ELSE                        /* NOT DDNAME NOT FOUND       */
*            DA0CDARC = S99ERROR;      /* STORE DYNAMIC ALLOCATION
*                                         ERROR CODE INTO DARC       */
         B     @RC00277                                         02S0279
@RF00277 LH    @14,S99ERROR                                     02S0279
         N     @14,@CF01193                                     02S0279
         STH   @14,DA0CDARC(,BLOCKPTR)                          02S0279
*          RETCODE = DRDYNERR;         /* INDICATE DYNAMIC ALLOCATION
*                                         ERROR                      */
@RC00277 LA    RETCODE,12                                       02S0280
*        END;                          /* END DYNAMIC ALLOCATION
*                                         ERROR CODE                 */
*      RESPECIFY R15 UNRESTRICTED;                              02S0282
@RF00275 DS    0H                                               02S0283
*      RESPECIFY (R0,R1) RESTRICTED;                            02S0283
*      R0 = CORESIZE;                  /* GET SIZE AND SUBPOOL       */
         L     R0,CORESIZE                                      02S0284
*      R1 = TUP(1);                    /* GET ADDRESS OF GOTTEN CORE */
         L     R1,TUP                                           02S0285
*      GEN ( FREEMAIN R,LV=(0),A=(1)); /* FREE CORE GOTTEN FOR TEXT
*                                         UNIT                       */
          FREEMAIN R,LV=(0),A=(1)
*      RESPECIFY (R0,R1) UNRESTRICTED;                          02S0287
*    END;                              /* END PROCESSING CONCAT CODE */
*        END;                          /* END CODE 0C                */
@RC00244 DS    0H                                               01S0289
@RC00242 DS    0H                                               01S0290
*      IF BLOCKPTR->DAIRCODE='0010'X THEN /* IS DAIR CODE 10         */
@RF00238 CLC   DAIRCODE(2,BLOCKPTR),@CB00161                    01S0290
         BNE   @RF00290                                         01S0290
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR10                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 10 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR10 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR10 IS INVOKED       */
*/*            IN ORDER TO DECONCATENATE DATA SETS BY DDNAME.        */
*/*                                                                  */
*/* OPERATION - THE DA10DDN FIELD IS CHECKED FOR BEING BLANK.  IF    */
*/*             BLANK, THE RETURN CODE IS SET TO 4(INVALID           */
*/*             PARAMETER LIST) AND NO FURTHER PROCESSING IS DONE.   */
*/*                                                                  */
*/*             IF THE DA10DDN FIELD IS NOT BLANK, THE S99VERB       */
*/*             CODE(IN THE DYNAMIC ALLOCATION PARM LIST) IS SET     */
*/*             TO DECONCAT.  A TEXT UNIT IS BUILT USING THE DDNAME  */
*/*             SUPPLIED IN THE DAIR10 PARM BLOCK(DA10DDN).          */
*/*             DYNAMIC ALLOCATION IS THEN INVOKED.                  */
*/*                                                                  */
*/*             THE RETURN CODE(IN REG15) FROM DYNAMIC ALLOCATION    */
*/*             IS THEN EXAMINED.                                    */
*/*                                                                  */
*/*             IF R15 = 4, THE S99ERROR CODE IS TESTED FOR RCDCONDD */
*/*             (DECONCATENATION WOULD CAUSE DUPLICATE DDNAMES).  IF */
*/*             THE S99ERROR WAS RCDCONDD, THE DA10DARC FIELD IS SET */
*/*             TO DRDUPEDD.  IF THE S99ERROR CODE WASN'T RCDCONDD,  */
*/*             BUT WAS RCDDNFND (DDNAME NOT FOUND), THE DA10DARC IS */
*/*             SET TO DRDDNFND.  IF NONE OF THE ABOVE, THE S99ERROR */
*/*             CODE IS STORED IN THE DA10DARC.  THE RETURN CODE IS  */
*/*             SET TO 12(DYNAMIC ALLOCATION ERROR) FOR ANY OF THE   */
*/*             ABOVE CONDITIONS.                                    */
*/*                                                                  */
*/*             IF R15 = 8(REQUEST DENIED BY INSTALLATION EXIT),THE  */
*/*             RETURN CODE SET TO 52.                               */
*/*                                                                  */
*/*             IF R15 = 12(INVALID PARAMETER LIST) THE S99ERROR     */
*/*             FIELD IS STORED INTO DA10DARC AND THE RETURN CODE    */
*/*             IS SET TO 4.                                         */
*/*                                                                  */
*/* ENTRY - DAIR10(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR10 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   RETURN CODE - REG15 SET TO ZERO(SUCCESSFUL DECONCATENATION)    */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*   RETURN CODE - REG15 IS SET TO ONE OF THE FOLLOWING             */
*/*                 4 - INVALID PARAMETER LIST                       */
*/*                12 - DYNAMIC ALLOCATION ERROR                     */
*/*                52 - REQUEST DENIED BY INSTALLATION EXIT          */
*/*                                                                  */
*/********************************************************************/
*DA10DARC = 0;                         /* ZERO DARC FILED            */
         SLR   @08,@08                                          02S0292
         STH   @08,DA10DARC(,BLOCKPTR)                          02S0292
*IF DA10DDN(1) = ' ' THEN              /* WAS DDNAME SUPPLIED        */
         CLI   DA10DDN(BLOCKPTR),C' '                           02S0293
         BNE   @RF00293                                         02S0293
*  RETCODE = DRINVLST;                 /* YES, RETURN 4(INVALID PARM)*/
         LA    RETCODE,4                                        02S0294
*ELSE                                  /* PARM LIST VALID            */
*  DO;                                 /* PROCESS DECONCAT REQUEST   */
         B     @RC00293                                         02S0295
@RF00293 DS    0H                                               02S0296
*    S99VERB = S99VRBDC;               /* SET VERB CODE TO DECONCAT  */
*                                                               02S0296
*                                                               02S0296
         MVI   S99VERB,X'04'                                    02S0296
*       DO;                                                     02S0297
*         TUP(1) = ADDR(TU(1));                                 02S0298
         LA    @08,TU                                           02S0298
         ST    @08,TUP                                          02S0298
*         TUP(1)->S99TUKEY = DDCDDNAM;                          02S0299
         MVC   S99TUKEY(2,@08),@CB00894                         02S0299
*         TUP(1)->S99TUNUM = 1;                                 02S0300
         MVC   S99TUNUM(2,@08),@CH00035                         02S0300
*         TUP(1)->S99TULNG = LENGTH(DA10DDN);                   02S0301
         MVC   S99TULNG(2,@08),@CH00048                         02S0301
*         TUP(1)->S99TUPAR(1:LENGTH(DA10DDN)) = DA10DDN;        02S0302
         MVC   S99TUPAR(8,@08),DA10DDN(BLOCKPTR)                02S0302
*       END;                                                    02S0303
*                                                               02S0303
*     TUP(1) = TUP(1) × '80000000'X;                            02S0304
         O     @08,@CF01105                                     02S0304
         ST    @08,TUP                                          02S0304
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0305
         LA    R1,S99RBPTR                                      02S0305
*     /*MACDATE Y-2 73082*/                                     02S0306
*     SVC (99);                                                 02S0306
         SVC   99                                               02S0306
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT REG15 USAGE       */
*    IF R15 = 4 THEN                   /* ENVIRONMENTAL ERROR ?      */
         C     R15,@CF00059                                     02S0308
         BNE   @RF00308                                         02S0308
*      DO;                             /* YES, EXAMINE S99ERROR CODE */
*        IF S99ERROR = RCDCONDD THEN   /* WOULD DECONCAT CAUSE  02S0310
*                                         DUPLICATE DDNAMES          */
         CLC   S99ERROR(2),@CB00284                             02S0310
         BNE   @RF00310                                         02S0310
*          DA10DARC = DRDUPEDD;        /* SET ERROR CODE IN DARC     */
         MVC   DA10DARC(2,BLOCKPTR),@CH00183                    02S0311
*        ELSE                          /* S99ERROR IS NOT RCDCONDD   */
*          IF S99ERROR = RCDDNFND THEN /* DDNAME NOT FOUND ?         */
         B     @RC00310                                         02S0312
@RF00310 CLC   S99ERROR(2),@CB00288                             02S0312
         BNE   @RF00312                                         02S0312
*            DA10DARC = DRDDNFND;      /* SET ERROR CODE IN DARC     */
         MVC   DA10DARC(2,BLOCKPTR),@CH00181                    02S0313
*          ELSE                        /* S99ERROR IS NOT RCDDNFND   */
*            DA10DARC = S99ERROR;      /* STORE DYNAMIC ALLOCATION
*                                         ERROR CODE IN DARC         */
         B     @RC00312                                         02S0314
@RF00312 LH    @14,S99ERROR                                     02S0314
         N     @14,@CF01193                                     02S0314
         STH   @14,DA10DARC(,BLOCKPTR)                          02S0314
*        RETCODE = DRDYNERR;           /* INDICATE DYNAMIC ALLOCATION
*                                         ERROR                      */
@RC00312 DS    0H                                               02S0315
@RC00310 LA    RETCODE,12                                       02S0315
*      END;                            /* END ENVIRONMENTAL ERR CODE */
*    IF R15 = 8 THEN                   /* WAS REQUEST DENIED BY 02S0317
*                                         INSTALLATION EXIT ?        */
@RF00308 C     R15,@CF00048                                     02S0317
         BNE   @RF00317                                         02S0317
*      RETCODE = DRREQDEN;             /* YES,SET RETURN CODE        */
         LA    RETCODE,52                                       02S0318
*    IF R15  = 12 THEN                 /* INVALID DYNAMIC ALLOCATION
*                                         PARM LIST ?                */
@RF00317 C     R15,@CF00034                                     02S0319
         BNE   @RF00319                                         02S0319
*      DO;                             /* YES, RETURN S99ERROR       */
*        DA10DARC = S99ERROR;          /* STORE DYNAMIC ALLOCATION
*                                         ERROR CODE IN DARC         */
         LH    @14,S99ERROR                                     02S0321
         N     @14,@CF01193                                     02S0321
         STH   @14,DA10DARC(,BLOCKPTR)                          02S0321
*        RETCODE = DRDYNERR;           /* INDICATE DYNAMIC      02S0322
*                                         ALLOCATION ERROR           */
         LA    RETCODE,12                                       02S0322
*      END;                            /* END INVALID PARM LIST CODE */
*    RESPECIFY R15 UNRESTRICTED;                                02S0324
@RF00319 DS    0H                                               02S0325
*  END;                                /* END DECONCAT REQUEST  02S0325
*                                         PROCESSING                 */
*        END;                          /* END CODE 10                */
@RC00293 DS    0H                                               01S0327
*      IF BLOCKPTR->DAIRCODE='0014'X & /* IS DAIR CODE 14            */
*         DAPLDAPB->DAIRCODE^='0028'X THEN                      01S0327
@RF00290 CLC   DAIRCODE(2,BLOCKPTR),@CB00163                    01S0327
         BNE   @RF00327                                         01S0327
         L     @08,DAPLDAPB(,DAPLPTR)                           01S0327
         CLC   DAIRCODE(2,@08),@CB00173                         01S0327
         BE    @RF00327                                         01S0327
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DAIR14                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR ENTRY CODE 14 PROCESSING                 */
*/*                                                                  */
*/* FUNCTION - TO PERFORM DAIR ENTRY CODE 14 PROCESSING, I.E., RETURN*/
*/*   LOW LEVEL QUALIFIERS FOR THE INPUT DSNAME.                     */
*/*                                                                  */
*/*   OPERATION - DETERMINE THE VALIDITY OF THE INPUT PARAMETER LIST.*/
*/*     IF IT IS INCORRECT, SET RETURN CODE 4. IF THE PARAMETERS ARE */
*/*     CORRECT, INVOKE THE DSNCHECK ROUTINE TO PREFIX THE USERID TO */
*/*     THE DSNAME IF NECESSARY. AN ERROR FROM THE ROUTINE CAUSES    */
*/*     PROCESSING TO TERMINATE. IF NO ERROR OCCURRED, THE NUMBER OF */
*/*     QUALIFIERS WHICH WILL FIT IN THE RETURN AREA PASSED BY THE   */
*/*     USER IS DETERMINED, AND THE ENTIRE RETURN AREA IS ZEROED.    */
*/*     CORE IS THEN OBTAINED FOR A WORK AREA INTO WHICH IKJEHCIR    */
*/*     (CIR) CAN RETURN THE LEVELS.  (A GETMAIN IS NECESSARY SINCE  */
*/*     EACH ENTRY RETURNED BY CIR CONTAINS AN IDENTIFIER AND THE    */
*/*     LEVEL, WHILE THE DAIR RETURN AREA CONTAINS ONLY A LEVEL.)    */
*/*     THE CIR PARAMETER LIST IS INITIALIZED AND IKJEHCIR IS        */
*/*     INVOKED. IF THE CIR RETURN CODE IS ZERO OR FOUR, MOVE ALL    */
*/*     THE LEVELS FROM THE CIR RETURN AREA TO THE DAIR RETURN       */
*/*     AREA.  IF THE CIR RETURN CODE IS FOUR AND THE LOCATE         */
*/*     RETURN CODE IS 44 (AREA PROVIDED IS NOT LARGE                */
*/*     ENOUGH TO CONTAIN ALL THE LEVELS), SET THE DAIR RETURN       */
*/*     CODE TO 40.   FOR ALL OTHER CIR RETURN CODES SET THE         */
*/*     DAIR RETURN CODE TO 36.                                      */
*/*     IN ALL CASES, THE CIR WORK AREA IS FREED.                    */
*/*                                                                  */
*/* INPUT - DAIR14 PARAMETER BLOCK                                   */
*/*                                                                  */
*/* OUTPUT - RETURN AREA OF DAIR14 PARAMETER BLOCK FILLED IN WITH    */
*/*          THE RETURNED LEVELS.                                    */
*/*          THE DAIR RETURN CODE IS SET TO FORTY IF THE DAIR14      */
*/*          RETURN AREA IS NOT LARGE ENOUGH FOR ALL THE LEVELS.     */
*/*          THE DAIR RETURN CODE IS SET TO FOUR FOR AN INVALID      */
*/*          PARAMETER LIST.                                         */
*/*          THE DAIR RETURN CODE IS SET TO THIRTY-SIX IF AN ERROR   */
*/*          WAS ENCOUNTERED BY THE IKJEHCIR ROUTINE.                */
*/********************************************************************/
*CALL DSNCHECK(DA14CTL,DA14PDSN);      /*VALIDATE INPUT DSNAME       */
         LA    @08,DA14CTL(,BLOCKPTR)                           02S0329
         ST    @08,@AL00001                                     02S0329
         LA    @08,DA14PDSN(,BLOCKPTR)                          02S0329
         ST    @08,@AL00001+4                                   02S0329
         LA    @01,@AL00001                                     02S0329
         BAL   @14,DSNCHECK                                     02S0329
*RESPECIFY R15 RESTRICTED;             /*RESTRICT REG 15 USAGE       */
*IF R15^=ZERO THEN                     /*ANY ERROR                   */
         LTR   R15,R15                                          02S0331
         BZ    @RF00331                                         02S0331
*  RETCODE=4;                          /*YES, SET DAIR RETURN CODE   */
         LA    RETCODE,4                                        02S0332
*ELSE                                                           02S0333
*  DO;                                 /*NO, CONTINUE PARM CHECK     */
         B     @RC00331                                         02S0333
@RF00331 DS    0H                                               02S0334
*    RESPECIFY R15 UNRESTRICTED;       /*RELEASE REG 15 USAGE        */
*    IF DSNBUF(1)=' ' ×                /*DSNAME NOT SPECIFIED        */
*       DA14PRET=ZERO ×                /*RETURN AREA NOT SPECIFIED   */
*       DA14QLEN<8 THEN                /*RETURN AREA FOR LESS THAN
*                                        ONE LEVEL OF QUALIFICATION  */
         CLI   DSNBUF,C' '                                      02S0335
         BE    @RT00335                                         02S0335
         L     @08,DA14PRET(,BLOCKPTR)                          02S0335
         LTR   @08,@08                                          02S0335
         BZ    @RT00335                                         02S0335
         LH    @08,DA14QLEN(,@08)                               02S0335
         C     @08,@CF00048                                     02S0335
         BNL   @RF00335                                         02S0335
@RT00335 DS    0H                                               02S0336
*      RETCODE=4;                      /*SET DAIR RETURN CODE        */
         LA    RETCODE,4                                        02S0336
*    ELSE                                                       02S0337
*      DO;                             /*PARAMETER LIST IS VALID     */
         B     @RC00335                                         02S0337
@RF00335 DS    0H                                               02S0338
*        NUMLEVEL=DA14QLEN/8;          /*NUMBER OF LEVELS WHICH CAN
*                                        BE PLACED IN USER AREA      */
         L     @06,DA14PRET(,BLOCKPTR)                          02S0338
         LH    @06,DA14QLEN(,@06)                               02S0338
         LR    @00,@06                                          02S0338
         SRDA  @00,32                                           02S0338
         D     @00,@CF00048                                     02S0338
         LR    NUMLEVEL,@01                                     02S0338
*        RTRNLEN=DA14QLEN;             /*LENGTH OF DAIR14 RETURN AREA
*                                        WHICH WILL BE OVERLAYED BY
*                                        FIRST QUALIFIER RETURNED    */
         LR    RTRNLEN,@06                                      02S0339
*        DO I=1 BY 256 WHILE(RTRNLEN>ZERO); /*CLEAR DAIR14 RETRN AREA*/
         LA    I,1                                              02S0340
         B     @DE00340                                         02S0340
@DL00340 DS    0H                                               02S0341
*          DA14AREA(I:I+MIN(RTRNLEN,256))=                      02S0341
*          DA14AREA(I:I+MIN(RTRNLEN,256))  &&                   02S0341
*          DA14AREA(I:I+MIN(RTRNLEN,256));                      02S0341
         L     @04,DA14PRET(,BLOCKPTR)                          02S0341
         ALR   @04,I                                            02S0341
         BCTR  @04,0                                            02S0341
         LA    @15,256                                          02S0341
         LR    @14,@15                                          02S0341
         CR    @14,RTRNLEN                                      02S0341
         BNH   *+6
         LR    @14,RTRNLEN                                      02S0341
         EX    @14,@SX01194                                     02S0341
*          RTRNLEN=RTRNLEN-256;        /*DECREMENT CHARS MOVED BY THE
*                                        MAXIMUM LENGTH              */
         SLR   RTRNLEN,@15                                      02S0342
*        END;                                                   02S0343
         AL    I,@CF01110                                       02S0343
@DE00340 LTR   RTRNLEN,RTRNLEN                                  02S0343
         BP    @DL00340                                         02S0343
*        CIRPARMS=CIRPARMS&&CIRPARMS;  /*ZERO IKJEFCIR(CIR) PARM LIST*/
         XC    CIRPARMS(100),CIRPARMS                           02S0344
*        CORELEN=LENGTH(CIRHDR)+(NUMLEVEL*LENGTH(CIRENT))+1; /*LENGTH
*                                        OF CIR WORK AREA VARIES BASED
*                                        ON THE SIZE OF THE DAIR14 AREA
*                                                            @ZA10507*/
         LR    @04,NUMLEVEL                                     02S0345
         MH    @04,@CH00032                                     02S0345
         AL    @04,@CF01104                                     02S0345
         ST    @04,CORELEN                                      02S0345
*        RFY (R0,R1) RESTRICTED;       /*RESTRICT REG 0 AND 1 USAGE  */
*        R0=CORELEN;                   /*LENGTH OF AREA              */
         LR    R0,@04                                           02S0347
*        R0=R0 × SUBPOOL1;             /*SET SUBPOOL NUMBER          */
         O     R0,@CF00150                                      02S0348
*        CORESIZE=R0;                  /*SAVE LENGTH AND SUBPOOL FOR
*                                        FREEMAIN                    */
         ST    R0,CORESIZE                                      02S0349
*        GEN REFS(R0) SETS(R1);        /*CORE FOR CIR RETURN AREA    */
        GETMAIN R,LV=(0)
*        CIRWA=R1;                     /*PLACE ADDR IN CIR LIST      */
         ST    R1,CIRWA                                         02S0351
*        RFY (R0,R1) UNRESTRICTED;     /*RELEASE REG 0 AND 1 USAGE   */
*        CIRLEN=CORELEN;               /*PUT LENGTH IN RETURN ADDR   */
         L     @04,CIRWA                                        02S0353
         L     @03,CORELEN                                      02S0353
         STH   @03,CIRLEN(,@04)                                 02S0353
*        CIROPT=DSNOPT;                /*RETURN LOW LEVEL FOR DSNAME */
         MVI   CIROPT,X'01'                                     02S0354
*        CIRSRCH=ADDR(DSNBUF);         /*ADDR OF DSNAME FOR SEARCH   */
         LA    @04,DSNBUF                                       02S0355
         ST    @04,CIRSRCH                                      02S0355
*        CIRSAVE=ADDR(CIRRSA);         /*ADDR OF RSA                 */
         LA    @04,CIRRSA                                       02S0356
         ST    @04,CIRSAVE                                      02S0356
*        R1=ADDR(CIRPARMS);            /*ADDRESS OF CIR PARAMETERS   */
         LA    R1,CIRPARMS                                      02S0357
*        GEN (LINK EP=IKJEHCIR);       /*INVOKE CIR                  */
         LINK EP=IKJEHCIR
*        RFY R15 RESTRICTED;           /*RESTRICT RETURN CODE REG    */
*        IF R15=ZERO ×                 /*CIR WORK AREA HAS LEVELS    */
*           (R15=4 & CIRLOCRC=44) THEN /*BUT NEEDED MORE ROOM        */
         LTR   R15,R15                                          02S0360
         BZ    @RT00360                                         02S0360
         C     R15,@CF00059                                     02S0360
         BNE   @RF00360                                         02S0360
         CLI   CIRLOCRC,44                                      02S0360
         BNE   @RF00360                                         02S0360
@RT00360 DS    0H                                               02S0361
*          DO;                         /*YES,MOVE INFO TO USER AREA  */
*            DO I=1 TO NUMLEVEL BY 1 WHILE(CIRID(I)^=FINISH);   02S0362
         LA    I,1                                              02S0362
         B     @DE00362                                         02S0362
@DL00362 L     @14,CIRWA                                        02S0362
         LR    @04,I                                            02S0362
         MH    @04,@CH00032                                     02S0362
         ST    @04,@TF00001                                     02S0362
         ALR   @04,@14                                          02S0362
         AL    @04,@CF01196                                     02S0362
         CLI   CIRID-4(@04),X'FF'                               02S0362
         BE    @DC00362                                         02S0362
*                                      /*RETURN LEVELS               */
*              DA14LEVL(I)=CIRNAME(I); /*MOVE LEVEL TO DIAR14 AREA   */
         LR    @04,I                                            02S0363
         SLA   @04,3                                            02S0363
         L     @03,DA14PRET(,BLOCKPTR)                          02S0363
         ALR   @03,@04                                          02S0363
         AL    @03,@CF01197                                     02S0363
         AL    @14,@TF00001                                     02S0363
         AL    @14,@CF01192                                     02S0363
         MVC   DA14LEVL(8,@03),CIRNAME-5(@14)                   02S0363
*            END;                                               02S0364
         AL    I,@CF00035                                       02S0364
@DE00362 CR    I,NUMLEVEL                                       02S0364
         BNH   @DL00362                                         02S0364
@DC00362 DS    0H                                               02S0365
*            IF R15=4 THEN             /*RETURN AREA NOT LARGE ENOUGH*/
         C     R15,@CF00059                                     02S0365
         BNE   @RF00365                                         02S0365
*              RETCODE=DRRTAREA;       /*YES, SET DAIR RETURN CODE   */
         LA    RETCODE,40                                       02S0366
*          END;                                                 02S0367
*        ELSE                          /*CIR RETURN NOT ZERO OR FOUR */
*          RETCODE=DRCIRERR;           /*SET DAIR RETURN CODE        */
         B     @RC00360                                         02S0368
@RF00360 LA    RETCODE,36                                       02S0368
*        RFY R15 UNRESTRICTED;         /*RELEASE RETURN CODE REG     */
@RC00360 DS    0H                                               02S0370
*        RFY (R0,R1) RESTRICTED;       /*RESTRICT REG 0 AND 1 USAGE  */
*        R0=CORESIZE;                  /*LENGTH AND SUBPOOL OF CIR
*                                        WORK AREA                   */
         L     R0,CORESIZE                                      02S0371
*        R1=CIRWA;                     /*ADDRESS OF CIR WORK AREA    */
         L     R1,CIRWA                                         02S0372
*        GEN (FREEMAIN R,LV=(0),A=(1)); /*FREE CIR WORK AREA         */
         FREEMAIN R,LV=(0),A=(1)
*        RFY (R0,R1) UNRESTRICTED;     /*RELEASE REG 0 AND 1 USAGE   */
*      END;                                                     02S0375
*  END;                                                         02S0376
@RC00335 DS    0H                                               02S0377
*        END;                          /* END CODE 14                */
@RC00331 DS    0H                                               01S0378
*      IF BLOCKPTR->DAIRCODE='0018'X THEN /* IS DAIR CODE 18         */
@RF00327 CLC   DAIRCODE(2,BLOCKPTR),@CB00165                    01S0378
         BNE   @RF00378                                         01S0378
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR18                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 18 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR18 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR18 IS INVOKED       */
*/*            IN ORDER TO FREE A DATA SET BY DDNAME OR BY DATA      */
*/*            SET NAME.                                             */
*/*                                                                  */
*/* OPERATION - THE DSNAME CHECK ROUTINE IS INVOKED TO DETERMINE     */
*/*             IF A VALID DATA SET NAME HAS BEEN SUPPLIED.  IF      */
*/*             THE NAME IS INVALID, THE RETURN CODE IS SET TO       */
*/*             4(INVALID PARAMETER LIST) AND NO FURTHER PROCESSING  */
*/*             IS DONE.                                             */
*/*                                                                  */
*/*             IF THE DSNAME IS VALID OR NO DSNAME WAS SPECIFIED    */
*/*             PROCESSING CONTINUES.                                */
*/*                                                                  */
*/*             IF THE DSNAME IS PRESENT, A TEXT UNIT IS BUILT       */
*/*             TO FREE BY DATA SET NAME.  A TEXT UNIT FOR MEMBER    */
*/*             NAME IS ALSO BUILT IF MEMBER NAME IS SUPPLIED.       */
*/*                                                                  */
*/*             IF THE DSNAME IS NOT PRESENT,  A TEXT UNIT TO        */
*/*             FREE BY DDNAME IS BUILT IF THE DDNAME IS PRESENT.    */
*/*             IF THE DSNAME AND DDNAME ARE NOT PRESENT, THE        */
*/*             RETURN CODE IS SET TO 4.  NO FURTHER PROCESSING      */
*/*             IS THEN DONE.                                        */
*/*                                                                  */
*/*             IF AN OVERRIDING DISPOSITION WAS SUPPLIED IN THE     */
*/*             DAIR18 PARM BLOCK, A TEXT UNIT IS BUILT FOR THIS     */
*/*             PARAMETER.                                           */
*/*                                                                  */
*/*             IF THE DA18PERM BIT IN DA18CTL IS ON, A TEXT         */
*/*             UNIT SPECIFYING FREE PERMANENTLY ALLOCATED DATA      */
*/*             SETS IS BUILT.                                       */
*/*                                                                  */
*/*             IF THE SYSOUT CLASS WAS SPECIFIED, A TEXT UNIT       */
*/*             SPECIFYING THE SYSOUT CLASS IS BUILT.                */
*/*                                                                  */
*/*             DYNAMIC ALLOCATION IS NOW INVOKED TO DO THE          */
*/*             UNALLOCATION.                                        */
*/*                                                                  */
*/*             UPON RETURN, THE RETURN CODE IN REG 15 IS TESTED     */
*/*             TO DETERMINE IF AN ERROR OCCURRED.  THE FOLLOWING    */
*/*             TESTS ARE DONE.                                      */
*/*                                                                  */
*/*             IF R15 = 0 AND S99INFO CODE IS NON-ZERO(^=0), A      */
*/*             BIT IN DA18FLG(DA18FPE) IS TURNED ON AND THE         */
*/*             S99INFO DATA IS STORED IN THE DARC.                  */
*/*                                                                  */
*/*             IF AN ENVIRONMENTAL ERROR WAS FOUND(R15=4), THE      */
*/*             S99ERROR FIELD IS EXAMINED FOR DDNAME AND            */
*/*             DSNAME NOT FOUND.  IF EITHER  IS FOUND, THE          */
*/*             DAIR RETURN CODE IS SET TO 28.  IF THE DSNAME WAS    */
*/*             A MEMBER OF A PERMANENTLY CONCATENATED GROUP,        */
*/*             THE DAIR RETURN CODE IS SET TO 24. IF DECONCATENATION*/
*/*             WOULD CREATE DUPLICATE DDNAMES THE DAIR RETURN CODE  */
*/*             IS SET TO 12 AND DRDUPEDD IS STORED IN THE DA18DARC  */
*/*             FIELD.  IF THE DAIR RETURN CODE IS UNDETERMINED      */
*/*             AFTER THE ABOVE TESTS, THE RETURN CODE IS SET TO     */
*/*             12 AND THE S99ERROR DATA STORED IN DA18DARC.         */
*/*                                                                  */
*/*             IF R15 = 8(REQUEST DENIED BY INSTALLATION EXIT),     */
*/*             THE DAIR RETURN CODE IS SET TO 52.                   */
*/*                                                                  */
*/*             IF R15 = 12(INVALID PARM LIST), THE S99ERROR FIELD   */
*/*             IS TESTED FOR INVALID PARM IN TEXT.  IF              */
*/*             INVALID PARM, THE S99INFO FIELD IS TESTED TO         */
*/*             DETERMINE IF THE ERROR WAS IN OVERRIDING SYSOUT      */
*/*             CLASS OR INVALID DISPOSITION.  IF SYSOUT CLASS,      */
*/*             THE DARC IS SET TO DRSYSCLS.  IF INVALID DISPOSITION,*/
*/*             THE DARC IS SET TO DRDSPINV.  IN EITHER CASE, THE    */
*/*             DAIR RETURN CODE IS SET TO 12.                       */
*/*                                                                  */
*/* ENTRY - DAIR18(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR18 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*                                                                  */
*/*   OUTPUT - REG 15 SET TO 0, IF SECONDARY ERROR REG 15 IS SET     */
*/*            TO 12 AND S99INFO DATA IS STORED IN DA18DARC, AND     */
*/*            DA18FPE IS SET ON.                                    */
*/*                                                                  */
*/*   RETURN CODE - 0 - SUCCESSFUL UNALLOCATION                      */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*                                                                  */
*/*   OUTPUT - DA18DARC (SEE OPERATION TEXT)                         */
*/*                                                                  */
*/*   RETURN CODE - THE FOLLOWING RETURN CODES ARE ISSUED            */
*/*                 4 - INVALID PARM LIST                            */
*/*                12 - ERROR IN DYNAMIC ALLOCATION                  */
*/*                24 - DSNAME REQUESTED IS MEMBER OF CONCAT GROUP   */
*/*                28 - DDNAME OR DSNAME NOT CURRENTLY               */
*/*                     ALLOCATED                                    */
*/*                52 - REQUEST FAILED BY INSTALLATION EXIT          */
*/*                                                                  */
*/*   OUTPUT - DA18DARC (SEE OPERATION TEXT)                         */
*/*                                                                  */
*/* CHANGE LEVEL - OZ06629                                           */
*/*                                                                  */
*/********************************************************************/
*DA18DARC = 0;                         /* ZERO DARC FIELD            */
         SLR   @08,@08                                          02S0380
         STH   @08,DA18DARC(,BLOCKPTR)                          02S0380
*DA18CTRC = 0;                         /* ZERO CTRC FIELD            */
         STH   @08,DA18CTRC(,BLOCKPTR)                          02S0381
*DA18FLG = 0;                          /* ZERO FLAG FIELD            */
         STH   @08,DA18FLG(,BLOCKPTR)                           02S0382
*S99VERB = S99VRBUN;                   /* SET VERB CODE TO UNALLOC   */
*                                                               02S0383
         MVI   S99VERB,X'02'                                    02S0383
*CALL DSNCHECK(DA18CTL,DA18PDSN);      /* VALIDITY CHECK DSNAME      */
         LA    @08,DA18CTL(,BLOCKPTR)                           02S0384
         ST    @08,@AL00001                                     02S0384
         LA    @08,DA18PDSN(,BLOCKPTR)                          02S0384
         ST    @08,@AL00001+4                                   02S0384
         LA    @01,@AL00001                                     02S0384
         BAL   @14,DSNCHECK                                     02S0384
*RETCODE = R15;                        /* SAVE RET CODE FROM DSNCHECK*/
         LR    RETCODE,R15                                      02S0385
*IF RETCODE = 0 THEN                   /* IS DSNAME VALID ?          */
         LTR   RETCODE,RETCODE                                  02S0386
         BNZ   @RF00386                                         02S0386
*  IF DSNBUF(1) ^= ' ' THEN            /* YES, WAS DSNAME SUPPLIED ? */
         CLI   DSNBUF,C' '                                      02S0387
         BE    @RF00387                                         02S0387
*    DO;                               /* YES, DSNAME SUPPLIED       */
*                                                               02S0388
*         DO;                                                   02S0389
*           TUP(1) = ADDR(TUDSN);                               02S0390
         LA    @08,TUDSN                                        02S0390
         ST    @08,TUP                                          02S0390
*           TUP(1)->S99TUKEY = DUNDSNAM;                        02S0391
         MVC   S99TUKEY(2,@08),@CB00896                         02S0391
*           TUP(1)->S99TUNUM = 1;                               02S0392
         LA    @04,1                                            02S0392
         STCM  @04,3,S99TUNUM(@08)                              02S0392
*           TUP(1)->S99TULNG = LENGTH(DSNBUF);                  02S0393
         MVC   S99TULNG(2,@08),@CH00092                         02S0393
*           TUP(1)->S99TUPAR(1:LENGTH(DSNBUF)) = DSNBUF;        02S0394
         MVC   S99TUPAR(44,@08),DSNBUF                          02S0394
*         END;                                                  02S0395
*                                                               02S0395
*       IF DA18MNM^=' ' THEN                                    02S0396
         CLI   DA18MNM(BLOCKPTR),C' '                           02S0396
         BE    @RF00396                                         02S0396
*         DO;                                                   02S0397
*           TUP(2) = ADDR(TU(2));                               02S0398
         LA    @08,TU+14                                        02S0398
         ST    @08,TUP+4                                        02S0398
*           TUP(2)->S99TUKEY = DUNMEMBR;                        02S0399
         MVC   S99TUKEY(2,@08),@CB00898                         02S0399
*           TUP(2)->S99TUNUM = 1;                               02S0400
         STCM  @04,3,S99TUNUM(@08)                              02S0400
*           TUP(2)->S99TULNG = LENGTH(DA18MNM);                 02S0401
         MVC   S99TULNG(2,@08),@CH00048                         02S0401
*           TUP(2)->S99TUPAR(1:LENGTH(DA18MNM)) = DA18MNM;      02S0402
         MVC   S99TUPAR(8,@08),DA18MNM(BLOCKPTR)                02S0402
*         END;                                                  02S0403
*    END;                              /* END BUILDING TEXT UNITS    */
*  ELSE                                /* DSNAME NOT SUPPLIED        */
*    IF DA18DDN(1) ^= ' ' THEN         /* WAS DDNAME SUPPLIED ?      */
*                                                               02S0405
         B     @RC00387                                         02S0405
@RF00387 CLI   DA18DDN(BLOCKPTR),C' '                           02S0405
         BE    @RF00405                                         02S0405
*         DO;                                                   02S0406
*           TUP(2) = ADDR(TU(2));                               02S0407
         LA    @08,TU+14                                        02S0407
         ST    @08,TUP+4                                        02S0407
*           TUP(2)->S99TUKEY = DUNDDNAM;                        02S0408
         MVC   S99TUKEY(2,@08),@CB00894                         02S0408
*           TUP(2)->S99TUNUM = 1;                               02S0409
         MVC   S99TUNUM(2,@08),@CH00035                         02S0409
*           TUP(2)->S99TULNG = LENGTH(DA18DDN);                 02S0410
         MVC   S99TULNG(2,@08),@CH00048                         02S0410
*           TUP(2)->S99TUPAR(1:LENGTH(DA18DDN)) = DA18DDN;      02S0411
         MVC   S99TUPAR(8,@08),DA18DDN(BLOCKPTR)                02S0411
*         END;                                                  02S0412
*    ELSE                              /* DSNAME & DDNAME NOT PRESENT*/
*      RETCODE = DRINVLST;             /* SET INVALID PARM LIST 02S0413
*                                         RETURN CODE                */
         B     @RC00405                                         02S0413
@RF00405 LA    RETCODE,4                                        02S0413
*IF RETCODE = 0 THEN                   /* ANY ERROR FOUND ?          */
@RC00405 DS    0H                                               02S0414
@RC00387 DS    0H                                               02S0414
@RF00386 LTR   RETCODE,RETCODE                                  02S0414
         BNZ   @RF00414                                         02S0414
*  DO;                                 /* NO ERROR                   */
*                                                               02S0415
*     IF DA18DPS2^=ZERO THEN                                    02S0416
         CLI   DA18DPS2(BLOCKPTR),0                             02S0416
         BE    @RF00416                                         02S0416
*       DO;                                                     02S0417
*         TUP(3) = ADDR(TU(3));                                 02S0418
         LA    @08,TU+28                                        02S0418
         ST    @08,TUP+8                                        02S0418
*         TUP(3)->S99TUKEY = DUNOVDSP;                          02S0419
         MVC   S99TUKEY(2,@08),@CB00901                         02S0419
*         TUP(3)->S99TUNUM = 1;                                 02S0420
         LA    @04,1                                            02S0420
         STCM  @04,3,S99TUNUM(@08)                              02S0420
*         TUP(3)->S99TULNG = LENGTH(DA18DPS2);                  02S0421
         STCM  @04,3,S99TULNG(@08)                              02S0421
*         TUP(3)->S99TUPAR(1:LENGTH(DA18DPS2)) = DA18DPS2;      02S0422
         MVC   S99TUPAR(1,@08),DA18DPS2(BLOCKPTR)               02S0422
*       END;                                                    02S0423
*                                                               02S0423
*     IF DA18PERM^='0'B THEN                                    02S0424
@RF00416 TM    DA18PERM(BLOCKPTR),B'00010000'                   02S0424
         BZ    @RF00424                                         02S0424
*       DO;                                                     02S0425
*         TUP(4) = ADDR(TU(4));                                 02S0426
         LA    @08,TU+42                                        02S0426
         ST    @08,TUP+12                                       02S0426
*         TUP(4)->S99TUKEY = DUNUNALC;                          02S0427
         MVC   S99TUKEY(2,@08),@CB00905                         02S0427
*         TUP(4)->S99TUNUM = 0;                                 02S0428
         SLR   @04,@04                                          02S0428
         STCM  @04,3,S99TUNUM(@08)                              02S0428
*         TUP(4)->S99TULNG = 0;                                 02S0429
         STCM  @04,3,S99TULNG(@08)                              02S0429
*       END;                                                    02S0430
*    IF DA18SCLS(1)^=' ' & DA18SCLS(1)^='00'X THEN /*SYSOUT CLASS
*                                        1ST CHAR?           @ZA06629*/
*                                                               02S0431
@RF00424 CLI   DA18SCLS(BLOCKPTR),C' '                          02S0431
         BE    @RF00431                                         02S0431
         CLI   DA18SCLS(BLOCKPTR),X'00'                         02S0431
         BE    @RF00431                                         02S0431
*         DO;                                                   02S0432
*           TUP(5) = ADDR(TU(5));                               02S0433
         LA    @08,TU+56                                        02S0433
         ST    @08,TUP+16                                       02S0433
*           TUP(5)->S99TUKEY = DUNOVCLS;                        02S0434
         MVC   S99TUKEY(2,@08),@CB00165                         02S0434
*           TUP(5)->S99TUNUM = 1;                               02S0435
         LA    @04,1                                            02S0435
         STCM  @04,3,S99TUNUM(@08)                              02S0435
*           TUP(5)->S99TULNG = 1;                               02S0436
         STCM  @04,3,S99TULNG(@08)                              02S0436
*           TUP(5)->S99TUPAR(1:1) = DA18SCLS;                   02S0437
         MVC   S99TUPAR(1,@08),DA18SCLS(BLOCKPTR)               02S0437
*         END;                                                  02S0438
*                                                               02S0438
*     TUP(5) = TUP(5) × '80000000'X;                            02S0439
@RF00431 L     @08,TUP+16                                       02S0439
         O     @08,@CF01105                                     02S0439
         ST    @08,TUP+16                                       02S0439
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0440
         LA    R1,S99RBPTR                                      02S0440
*     /*MACDATE Y-2 73082*/                                     02S0441
*     SVC (99);                                                 02S0441
         SVC   99                                               02S0441
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT REG15 USAGE       */
*    IF R15 = 0                        /* WAS DATA SET UNALLOCATED ? */
*      & S99INFO ^= 0 THEN             /* YES, WAS THERE A SECONDARY
*                                         ERROR ?                    */
         SLR   @14,@14                                          02S0443
         CR    R15,@14                                          02S0443
         BNE   @RF00443                                         02S0443
         LH    @08,S99INFO                                      02S0443
         N     @08,@CF01193                                     02S0443
         CR    @08,@14                                          02S0443
         BE    @RF00443                                         02S0443
*      DO;                             /* YES                        */
*        DA18FPE = ON;                 /* INDICATE SECONDARY ERROR   */
         OI    DA18FPE(BLOCKPTR),B'10000000'                    02S0445
*        DA18DARC = S99INFO;           /* STORE DYNAMIC ALLOCATION
*                                         INFO  CODE IN DARC         */
         STH   @08,DA18DARC(,BLOCKPTR)                          02S0446
*      END;                            /* END PROCESSING SECONDARY
*                                         ERROR                      */
*    IF R15 = 4 THEN                   /* ENVIRONMENTAL ERROR        */
@RF00443 C     R15,@CF00059                                     02S0448
         BNE   @RF00448                                         02S0448
*      DO;                             /* YES, RETURN APPROPRIATE
*                                         ERROR CODES                */
*        IF S99ERROR = RCDDNFND        /* DDNAME NOT FOUND ?         */
*         × S99ERROR = RCDSNFND  THEN  /* DSNAME NOT FOUND ?         */
         CLC   S99ERROR(2),@CB00288                             02S0450
         BE    @RT00450                                         02S0450
         CLC   S99ERROR(2),@CB00292                             02S0450
         BNE   @RF00450                                         02S0450
@RT00450 DS    0H                                               02S0451
*          RETCODE = 28;               /* INDICATE DDNAME OR DSNAME
*                                         NOT CURRENTLY ALLOCATED    */
         LA    RETCODE,28                                       02S0451
*        IF S99ERROR = RCPRMCAT THEN   /* DSNAME MEMBER OF PERM 02S0452
*                                         CONCATENATED GROUP ?       */
@RF00450 CLC   S99ERROR(2),@CB00306                             02S0452
         BNE   @RF00452                                         02S0452
*          RETCODE = DRDSCCAT;         /* INDICATE DSNAME MEMBER OF
*                                         A CONCATENATED GROUP       */
         LA    RETCODE,24                                       02S0453
*        IF S99ERROR = RCDCONDD THEN   /* WOULD DECONCATENATION CREATE
*                                         DUPLICATE DDNAMES ?        */
@RF00452 CLC   S99ERROR(2),@CB00284                             02S0454
         BNE   @RF00454                                         02S0454
*          DO;                         /* YES                        */
*            RETCODE = DRDYNERR;       /* INDICATE DYN ALLOC ERROR   */
         LA    RETCODE,12                                       02S0456
*            DA18DARC = DRDUPEDD;      /* RESTORING DDNAMES WOULD
*                                         CREATE DUPLICATE DDNAMES   */
         MVC   DA18DARC(2,BLOCKPTR),@CH00183                    02S0457
*          END;                        /* END DECONCAT ERROR CODE    */
*        IF RETCODE = 0 THEN           /* HAS ERROR BEEN DETERMINED  */
@RF00454 LTR   RETCODE,RETCODE                                  02S0459
         BNZ   @RF00459                                         02S0459
*          DO;                         /* NO, RETURN S99ERROR IN DARC*/
*            DA18DARC = S99ERROR;      /* STORE S99ERROR IN DA18DARC */
         LH    @14,S99ERROR                                     02S0461
         N     @14,@CF01193                                     02S0461
         STH   @14,DA18DARC(,BLOCKPTR)                          02S0461
*            RETCODE = DRDYNERR;       /* INDICATE DYN ALLOC ERROR   */
         LA    RETCODE,12                                       02S0462
*          END;                        /* END RETURN S99ERROR        */
*      END;                            /* END ENVIRONMENTAL ERROR
*                                         PROCESSING                 */
@RF00459 DS    0H                                               02S0465
*    IF R15 = 8 THEN                   /* WAS REQUEST DENIED BY 02S0465
*                                         INSTALLATION EXIT ?        */
@RF00448 C     R15,@CF00048                                     02S0465
         BNE   @RF00465                                         02S0465
*      RETCODE = DRREQDEN;             /* YES, SET RETURN CODE TO 52 */
         LA    RETCODE,52                                       02S0466
*    IF R15 = 12 THEN                  /* INVALID PARM LIST TO  02S0467
*                                         DYNAMIC ALLOCATION ?       */
@RF00465 C     R15,@CF00034                                     02S0467
         BNE   @RF00467                                         02S0467
*      DO;                             /* YES                        */
*        IF S99ERROR = RCINPARM THEN   /* INVALID PARM SPECIFIED IN
*                                         TEXT ?                     */
         CLC   S99ERROR(2),@CB00248                             02S0469
         BNE   @RF00469                                         02S0469
*          IF S99INFO = DUNOVCLS THEN  /* YES, WAS IT OUTPUT CLASS   */
         CLC   S99INFO(2),@CB00165                              02S0470
         BNE   @RF00470                                         02S0470
*            DA18DARC = DRSYSCLS;      /* YES, RETURN INVALID   02S0471
*                                         CHARACTERS IN OUTPUT CLASS */
         MVC   DA18DARC(2,BLOCKPTR),@CH00195                    02S0471
*          ELSE                        /* OTHERWISE, INVALID DISP    */
*            DA18DARC = DRDSPINV;      /* RETURN INVALID DISPOSITION */
         B     @RC00470                                         02S0472
@RF00470 MVC   DA18DARC(2,BLOCKPTR),@CH00201                    02S0472
*        ELSE                          /* OTHERWISE, RETURN S99ERROR
*                                         ERROR CODE                 */
*          DA18DARC = S99ERROR;        /* RETURN DYNAMIC ALLOCATION
*                                         ERROR CODE                 */
         B     @RC00469                                         02S0473
@RF00469 LH    @14,S99ERROR                                     02S0473
         N     @14,@CF01193                                     02S0473
         STH   @14,DA18DARC(,BLOCKPTR)                          02S0473
*        RETCODE = DRDYNERR;           /* INDICATE DYNAMIC ALLOCATION
*                                         ERROR                      */
@RC00469 LA    RETCODE,12                                       02S0474
*      END;                            /* END INVALID PARM LIST CODE */
*    RESPECIFY R15 UNRESTRICTED;                                02S0476
@RF00467 DS    0H                                               02S0477
*  END;                                /* END PROCESSING VALID DAIR
*                                         18 PARM LIST               */
*        END;                          /* END CODE 18                */
@RF00414 DS    0H                                               01S0479
*      IF BLOCKPTR->DAIRCODE='001C'X THEN /* IS DAIR CODE 1C         */
@RF00378 CLC   DAIRCODE(2,BLOCKPTR),@CB00167                    01S0479
         BNE   @RF00479                                         01S0479
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR1C                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 1C PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR1C PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR1C IS INVOKED       */
*/*            IN ORDER TO ALLOCATE A DDNAME TO A TERMINAL.          */
*/*                                                                  */
*/* OPERATION - THE DAIR1C PARM BLOCK IS EXAMINED TO DETERMINE IF    */
*/*             AN ATTRIBUTE LIST IS PRESENT.  IF DA1CATRL BIT IS    */
*/*             ON (1) AND DA1CALN (ATTRIBUTE LIST NAME) IS NOT      */
*/*             BLANK, A TEXT UNIT IS BUILT FOR A DCB DDNAME         */
*/*             REFERENCE.  IF THE DA1CATRL BIT IS ON AND THE        */
*/*             DA1CALN IS BLANK THE RETURN CODE IS SET TO 4         */
*/*             (INVALID PARAMETER LIST) AND NO FURTHER PROCESSING   */
*/*             IS DONE.                                             */
*/*                                                                  */
*/*             IF A DDNAME IS PRESENT, A TEXT UNIT IS BUILT         */
*/*             REQUESTING TERMINAL ALLOCATION TO THE SPECIFIED      */
*/*             DDNAME.  IF THE DDNAME IS NOT PRESENT, A TEXT        */
*/*             UNIT IS BUILT REQUESTING TERMINAL ALLOCATION         */
*/*             AND RETURN OF THE DDNAME ASSOCIATED WITH IT.         */
*/*                                                                  */
*/*             A TEXT UNIT IS BUILT REQUESTING PERMANENT            */
*/*             ALLOCATION, IF THE DA1CPERM BIT(IN DA1CCTL) IS ON.   */
*/*                                                                  */
*/*             DYNAMIC ALLOCATION IS INVOKED TO DO THE ALLOCATION   */
*/*             OF THE TERMINAL.                                     */
*/*                                                                  */
*/*             UPON RETURN, THE DYNAMIC ALLOCATION RETURN CODE      */
*/*             (IN REG 15) IS EXAMINED TO DETERMINE IF AN ERROR     */
*/*             OCCURRED.  THE FOLLOWING TESTS ARE MADE.             */
*/*                                                                  */
*/*             IF R15 = 0, THE DAIR RETURN CODE IS 0 AND THE        */
*/*             DDNAME ASSOCIATED WITH THE ALLOCATION IS RETURNED.   */
*/*             (ONLY IF A DDNAME WAS NOT SUPPLIED.)                 */
*/*                                                                  */
*/*             IF R15 = 4, AN ENVIRONMENTAL ERROR OCCURRED, AND     */
*/*             FURTHER TESTING IS DONE IN ORDER TO RETURN THE       */
*/*             PROPER CODES.  THE FOLLOWING TESTS ARE DONE:         */
*/*               1. IF S99ERROR = RCDDUNAV THE DAIR RETURN CODE     */
*/*                  IS 20.  THE SPECIFIED DDNAME IS UNAVAILABLE.    */
*/*               2. IF S99ERROR = RCNTUNLC OR RCLIMITS THE DAIR     */
*/*                  RETURN CODE IS 16.  THE RESOURCES COULD NOT BE  */
*/*                  UNALLOCATED TO DECREASE THE NUMBER OF RESOURCES */
*/*                  TO THE CONTROL VALUE OR THE LIMIT OF 1635       */
*/*                  CONCURRENT ALLOCATIONS HAS BEEN REACHED.        */
*/*               3. IF S99ERROR = RCDCBRNF THE DAIR RETURN CODE     */
*/*                  IS 28.  THE DDNAME SPECIFIED IS NOT CURRENTLY   */
*/*                  ALLOCATED  (OBJECT OF DCB REFERBACK NOT FOUND). */
*/*               4. IF THE DAIR RETURN CODE HAS NOT YET BEEN        */
*/*                  DETERMINED, THE S99ERROR IS STORED IN DA1CDARC  */
*/*                  AND THE DAIR RETURN CODE IS 12.  DYNAMIC        */
*/*                  ALLOCATION ERROR.                               */
*/*                                                                  */
*/*             IF R15 = 8, THE DAIR RETURN CODE IS 52.  REQUEST     */
*/*             DENIED BY INSTALLATION EXIT.                         */
*/*                                                                  */
*/*             IF R15 = 12, THE S99ERROR CODE IS TESTED FOR         */
*/*             INVALID PARM IN THE TEXT UNIT AND THE                */
*/*             S99INFO CODE IS TESTED FOR THE DDNAME TEXT           */
*/*             KEY.  IF BOTH CONDITIONS EXIST, THE DA1CDARC IS SET  */
*/*             TO DRDDNINV (INVALID CHARACTERS IN DDNAME).          */
*/*             OTHERWISE, THE S99ERROR IS STORED IN DA1CDARC.  IN   */
*/*             ANY EVENT, THE DAIR RETURN CODE IS SET TO 12.        */
*/*                                                                  */
*/* ENTRY - DAIR1C(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR1C PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*                                                                  */
*/*   OUTPUT - REG 15 IS 0, IF DDNAME WAS NOT SUPPLIED IN THE DAIR   */
*/*            PARM BLOCK, THE DDNAME ASSOCIATED WITH THE ALLOCATION */
*/*            IS RETURNED.                                          */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*                                                                  */
*/*   RETURN CODE - THE FOLLOWING RETURN CODES ARE ISSUED            */
*/*                 4 - INVALID PARM LIST                            */
*/*                12 - ERROR IN DYNAMIC ALLOCATION                  */
*/*                16 - RESOURCES COULD NOT BE UNALLOCATED TO        */
*/*                     DECREASE THE NUMBER OF RESOURCES HELD IN     */
*/*                     ANTICIPATION OF REUSE TO THE CONTROL VALUE   */
*/*                     OR THE ALLOCATION LIMIT OF 1635 CONCURRENT   */
*/*                     ALLOCATION HAS BEEN REACHED                  */
*/*                20 - THE DDNAME REQUESTED IS UNAVAILABLE          */
*/*                28 - THE DDNAME OR DSNAME SPECIFIED IS NOT        */
*/*                     CURRENTLY ALLOCATED                          */
*/*                52 - REQUEST DENIED BY INSTALLATION EXIT          */
*/*                                                                  */
*/*   OUTPUT - DA1CDARC (SEE OPERATION TEXT)                         */
*/*                                                                  */
*/********************************************************************/
*DA1CDARC = 0;                         /* ZERO DARC FIELD            */
         SLR   @08,@08                                          02S0481
         STH   @08,DA1CDARC(,BLOCKPTR)                          02S0481
*S99VERB = S99VRBAL;                   /* SET VERB CODE TO ALLOC     */
*                                                               02S0482
*                                                               02S0482
         MVI   S99VERB,X'01'                                    02S0482
*   DO;                                                         02S0483
*     TUP(1) = ADDR(TU(1));                                     02S0484
         LA    @04,TU                                           02S0484
         ST    @04,TUP                                          02S0484
*     TUP(1)->S99TUKEY = DALTERM;                               02S0485
         MVC   S99TUKEY(2,@04),@CB00173                         02S0485
*     TUP(1)->S99TUNUM = 0;                                     02S0486
         STCM  @08,3,S99TUNUM(@04)                              02S0486
*     TUP(1)->S99TULNG = 0;                                     02S0487
         STCM  @08,3,S99TULNG(@04)                              02S0487
*   END;                                                        02S0488
*IF DA1CATRL = '1'B THEN               /* WAS ATTRIBUTE NAME SUPPLIED*/
         TM    DA1CATRL(BLOCKPTR),B'00000010'                   02S0489
         BNO   @RF00489                                         02S0489
*  IF DA1CALN(1) ^= ' ' THEN           /* IS ATTRIBUTE NAME BLANK ?  */
*                                                               02S0490
         CLI   DA1CALN(BLOCKPTR),C' '                           02S0490
         BE    @RF00490                                         02S0490
*       DO;                                                     02S0491
*         TUP(2) = ADDR(TU(2));                                 02S0492
         LA    @08,TU+14                                        02S0492
         ST    @08,TUP+4                                        02S0492
*         TUP(2)->S99TUKEY = DALDCBDD;                          02S0493
         MVC   S99TUKEY(2,@08),@CB00971                         02S0493
*         TUP(2)->S99TUNUM = 1;                                 02S0494
         MVC   S99TUNUM(2,@08),@CH00035                         02S0494
*         TUP(2)->S99TULNG = LENGTH(DA1CALN);                   02S0495
         MVC   S99TULNG(2,@08),@CH00048                         02S0495
*         TUP(2)->S99TUPAR(1:LENGTH(DA1CALN)) = DA1CALN;        02S0496
         MVC   S99TUPAR(8,@08),DA1CALN(BLOCKPTR)                02S0496
*       END;                                                    02S0497
*  ELSE                                /* BLANK ATTRIBUTE NAME       */
*    RETCODE = DRINVLST;               /* INVALID PARM LIST          */
         B     @RC00490                                         02S0498
@RF00490 LA    RETCODE,4                                        02S0498
*ELSE;                                 /* NO ATTRIBUTE LIST          */
@RF00489 DS    0H                                               02S0500
*IF RETCODE = 0 THEN                   /* ANY ERROR ?                */
@RC00489 LTR   RETCODE,RETCODE                                  02S0500
         BNZ   @RF00500                                         02S0500
*  DO;                                 /* NO                         */
*    IF DA1CDDN(1) ^= ' ' THEN         /* IS DDNAME PRESENT          */
*                                                               02S0502
         CLI   DA1CDDN(BLOCKPTR),C' '                           02S0502
         BE    @RF00502                                         02S0502
*         DO;                                                   02S0503
*           TUP(3) = ADDR(TU(3));                               02S0504
         LA    @08,TU+28                                        02S0504
         ST    @08,TUP+8                                        02S0504
*           TUP(3)->S99TUKEY = DALDDNAM;                        02S0505
         MVC   S99TUKEY(2,@08),@CB00894                         02S0505
*           TUP(3)->S99TUNUM = 1;                               02S0506
         MVC   S99TUNUM(2,@08),@CH00035                         02S0506
*           TUP(3)->S99TULNG = LENGTH(DA1CDDN);                 02S0507
         MVC   S99TULNG(2,@08),@CH00048                         02S0507
*           TUP(3)->S99TUPAR(1:LENGTH(DA1CDDN)) = DA1CDDN;      02S0508
         MVC   S99TUPAR(8,@08),DA1CDDN(BLOCKPTR)                02S0508
*         END;                                                  02S0509
*    ELSE                              /* RETURN DDNAME              */
*                                                               02S0510
*       DO;                                                     02S0510
         B     @RC00502                                         02S0510
@RF00502 DS    0H                                               02S0511
*         TUP(3) = ADDR(TU(3));                                 02S0511
         LA    @08,TU+28                                        02S0511
         ST    @08,TUP+8                                        02S0511
*         TUP(3)->S99TUKEY = DALRTDDN;                          02S0512
         MVC   S99TUKEY(2,@08),@CB01049                         02S0512
*         TUP(3)->S99TUNUM = 1;                                 02S0513
         MVC   S99TUNUM(2,@08),@CH00035                         02S0513
*         TUP(3)->S99TULNG = 8;                                 02S0514
         MVC   S99TULNG(2,@08),@CH00048                         02S0514
*         TUP(3)->S99TUPAR(1:8) = '';                           02S0515
         MVI   S99TUPAR(@08),C' '                               02S0515
         MVC   S99TUPAR+1(7,@08),S99TUPAR(@08)                  02S0515
*       END;                                                    02S0516
*                                                               02S0516
*     IF DA1CPERM^='0'B THEN                                    02S0517
@RC00502 TM    DA1CPERM(BLOCKPTR),B'00001000'                   02S0517
         BZ    @RF00517                                         02S0517
*       DO;                                                     02S0518
*         TUP(4) = ADDR(TU(4));                                 02S0519
         LA    @08,TU+42                                        02S0519
         ST    @08,TUP+12                                       02S0519
*         TUP(4)->S99TUKEY = DALPERMA;                          02S0520
         MVC   S99TUKEY(2,@08),@CB01043                         02S0520
*         TUP(4)->S99TUNUM = 0;                                 02S0521
         SLR   @04,@04                                          02S0521
         STCM  @04,3,S99TUNUM(@08)                              02S0521
*         TUP(4)->S99TULNG = 0;                                 02S0522
         STCM  @04,3,S99TULNG(@08)                              02S0522
*       END;                                                    02S0523
*                                                               02S0523
*     TUP(4) = TUP(4) × '80000000'X;                            02S0524
@RF00517 L     @08,TUP+12                                       02S0524
         O     @08,@CF01105                                     02S0524
         ST    @08,TUP+12                                       02S0524
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0525
         LA    R1,S99RBPTR                                      02S0525
*     /*MACDATE Y-2 73082*/                                     02S0526
*     SVC (99);                                                 02S0526
         SVC   99                                               02S0526
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT R15 USAGE         */
*    IF R15 = 0 THEN                   /* ALLOCATION SUCCESSFUL ?    */
         LTR   R15,R15                                          02S0528
         BNZ   @RF00528                                         02S0528
*      DA1CDDN = TUP(3) -> S99TUPAR(1:8); /* YES, RETURN DDNAME      */
         L     @14,TUP+8                                        02S0529
         MVC   DA1CDDN(8,BLOCKPTR),S99TUPAR(@14)                02S0529
*    ELSE                              /* RETURN CODE NOT 0          */
*      DO;                             /* PROCESS RETURN CODE        */
         B     @RC00528                                         02S0530
@RF00528 DS    0H                                               02S0531
*        IF R15 = 4 THEN               /* ENVIRONMENTAL ERROR ?      */
         C     R15,@CF00059                                     02S0531
         BNE   @RF00531                                         02S0531
*          DO;                         /* YES                        */
*            IF S99ERROR = RCDDUNAV THEN /* DDNAME UNAVAILABLE ?     */
         CLC   S99ERROR(2),@CB00280                             02S0533
         BNE   @RF00533                                         02S0533
*              RETCODE = DRDDUNAV;     /* YES, RETURN CODE = 20      */
         LA    RETCODE,20                                       02S0534
*            IF S99ERROR = RCNTUNLC × S99ERROR = RCLIMITS THEN  02S0535
@RF00533 CLC   S99ERROR(2),@CB00290                             02S0535
         BE    @RT00535                                         02S0535
         CLC   S99ERROR(2),@CB00300                             02S0535
         BNE   @RF00535                                         02S0535
@RT00535 DS    0H                                               02S0536
*              RETCODE =16;            /* LIMIT EXCEEDED ?           */
         LA    RETCODE,16                                       02S0536
*            IF S99ERROR = RCDCBRNF THEN /* DCB REFERBACK NOT FOUND ?*/
@RF00535 CLC   S99ERROR(2),@CB00302                             02S0537
         BNE   @RF00537                                         02S0537
*              RETCODE = 28;           /* YES, RETURN CODE = 28      */
         LA    RETCODE,28                                       02S0538
*            IF RETCODE = 0 THEN       /* ERROR DETERMINED ?         */
@RF00537 LTR   RETCODE,RETCODE                                  02S0539
         BNZ   @RF00539                                         02S0539
*              DO;                     /* NO                         */
*                DA1CDARC = S99ERROR;  /* RETURN DYN ALLOC ERROR     */
         LH    @14,S99ERROR                                     02S0541
         N     @14,@CF01193                                     02S0541
         STH   @14,DA1CDARC(,BLOCKPTR)                          02S0541
*                RETCODE = DRDYNERR;   /* INDICATE DYN ALLOC ERROR   */
         LA    RETCODE,12                                       02S0542
*              END;                    /* END RETURN DYN ALLOC ERROR */
*          END;                        /* END ENVIRONMENTAL ERROR    */
@RF00539 DS    0H                                               02S0545
*        IF R15 = 8 THEN               /* REQUEST DENIED ?           */
@RF00531 C     R15,@CF00048                                     02S0545
         BNE   @RF00545                                         02S0545
*          RETCODE = DRREQDEN;         /* RETURN 52 REQUEST DENIED
*                                         BY INSTALLATION EXIT       */
         LA    RETCODE,52                                       02S0546
*        IF R15 = 12 THEN              /* INVALID PARM LIST          */
@RF00545 C     R15,@CF00034                                     02S0547
         BNE   @RF00547                                         02S0547
*          DO;                         /* PROCESS INVALID CODE       */
*            IF S99ERROR = RCINPARM & S99INFO = DALDDNAM THEN   02S0549
         CLC   S99ERROR(2),@CB00248                             02S0549
         BNE   @RF00549                                         02S0549
         CLC   S99INFO(2),@CB00894                              02S0549
         BNE   @RF00549                                         02S0549
*              DA1CDARC = DRDDNINV;    /* INVALID CHARACTER IN DDNAME*/
         MVC   DA1CDARC(2,BLOCKPTR),@CH00185                    02S0550
*            ELSE                      /* OTHERWISE NOT DETERMINED   */
*              DA1CDARC = S99ERROR;    /* RETURN S99ERROR            */
         B     @RC00549                                         02S0551
@RF00549 LH    @14,S99ERROR                                     02S0551
         N     @14,@CF01193                                     02S0551
         STH   @14,DA1CDARC(,BLOCKPTR)                          02S0551
*            RETCODE = DRDYNERR;       /* INDICATE DYNAMIC ALLOCATION
*                                         ERROR                      */
@RC00549 LA    RETCODE,12                                       02S0552
*          END;                        /* END INVALID CODE PROCESSING*/
*      END;                            /* END UNSUCCESSFUL ALLOCATION*/
@RF00547 DS    0H                                               02S0555
*    RESPECIFY R15 UNRESTRICTED;       /* RELEASE R15 USAGE          */
@RC00528 DS    0H                                               02S0556
*  END;                                /* END NO ERROR PROCESSING    */
*        END;                          /* END CODE 1C                */
@RF00500 DS    0H                                               01S0558
*      IF BLOCKPTR->DAIRCODE='0024'X THEN /* IS DAIR CODE 24         */
@RF00479 CLC   DAIRCODE(2,BLOCKPTR),@CB00171                    01S0558
         BNE   @RF00558                                         01S0558
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR24                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 24 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR24 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR24 IS INVOKED       */
*/*            IN ORDER TO ALLOCATE BY DDNAME(IE. MARK IN USE)       */
*/*            OR, IF THE DDNAME IS NOT FOUND, ALLOCATE BY DSNAME.   */
*/*                                                                  */
*/* OPERATION - THE DSNAME CHECK ROUTINE IS INVOKED TO DETERMINE     */
*/*             IF A VALID DATA SET NAME HAS BEEN SUPPLIED.  IF      */
*/*             THE NAME IS INVALID, THE RETURN CODE IS SET TO       */
*/*             4(INVALID PARAMETER LIST) AND NO FURTHER PROCESSING  */
*/*             IS DONE.                                             */
*/*                                                                  */
*/*             THE DDNAME AND DATA SET NAME ARE REQUIRED AND, IF    */
*/*             NOT SUPPLIED, THE RETURN CODE IS SET TO 4 AND NO     */
*/*             FURTHER PROCESSING IS DONE.                          */
*/*                                                                  */
*/*             IF NONE OF THE ABOVE ERROR CONDITIONS EXIST, TEXT    */
*/*             UNITS ARE BUILT TO ALLOCATE BY DDNAME AND RETURN     */
*/*             A DUMMY DATA SET INDICATOR.  DYNAMIC ALLOCATION IS   */
*/*             INVOKED TO ALLOCATE BY DDNAME.                       */
*/*                                                                  */
*/*             IF THE ALLOCATION WAS SUCCESSFUL, THE DUMMY          */
*/*             INDICATOR IS TESTED AND IF DUMMY, THE DA24DMY BIT    */
*/*             IN DA24FLG IS TURNED ON(SET TO 1).  RETCODE IS SET   */
*/*             TO 20 AND TEXT UNITS ARE BUILT TO UNALLOCATE BY      */
*/*             DDNAME.  DYNAMIC ALLOCATION IS THEN INVOKED TO       */
*/*             UNALLOCATE BY DDNAME.  THE UNALLOCATION IS DONE IN   */
*/*             ORDER TO BE COMPATIBLE WITH PREVIOUS RELEASES OF     */
*/*             DAIR.  THE PREVIOUS RELEASES OF DAIR DETERMINED      */
*/*             A DUMMY PRIOR TO ALLOCATION AND HENCE, NO            */
*/*             ALLOCATION WAS DONE.                                 */
*/*                                                                  */
*/*             IF THE ALLOCATION WAS SUCCESSFUL AND THE DATA SET    */
*/*             WASN'T A DUMMY, TEXT UNITS ARE BUILT TO RETRIEVE THE */
*/*             DATA SET NAME AND DATA SET ORGANIZATION.  DYNAMIC    */
*/*             ALLOCATION IS INVOKED FOR RETRIEVAL.  UPON RETURN,   */
*/*             THE DSNAME LENGTH, DSNAME AND DATA SET ORGANIZATION  */
*/*             ARE STORED IN THE DAIR24 PARM LIST.                  */
*/*                                                                  */
*/*             IF THE ALLOCATION WAS NOT SUCCESSFUL(REG 15 ^= 0),   */
*/*             THE FOLLOWING TESTS ARE MADE:                        */
*/*             1. IF R15 = 8 THEN RETCODE IS SET TO 52.  REQUEST    */
*/*                DENIED BY INSTALLATION EXIT.                      */
*/*             2. IF R15 ^= 8, THE FOLLOWING TESTS ARE MADE:        */
*/*                A. IF S99ERROR = RCDDUNAV, RETCODE IS SET TO 20.  */
*/*                   THE DDNAME SPECIFIED IS UNAVAILABLE.           */
*/*                B. IF S99ERROR = RCDDNFND OR RCDDCONV (DDNAME     */
*/*                   NOT FOUND   OR ASSOCIATED WITH A CONVERTIBLE   */
*/*                   OR NON-PERMANENTLY CONCATENATED RESOURCE),     */
*/*                   THE DA24DDN FIELD IS BLANKED(IN ORDER TO       */
*/*                   GET A GENERATED DDNAME RETURNED).  A CALL TO   */
*/*                   DAIR08 IS THEN MADE IN ORDER TO ALLOCATE       */
*/*                   BY DSNAME.                                     */
*/*                   (NOTE: THE DAIR08 AND DAIR24 PARM BLOCKS ARE   */
*/*                   IDENTICAL. THE DIFFERENCE IN PROCESSING IS THAT*/
*/*                   DAIR24 ALLOCATES BY DDNAME FIRST.  IF THE      */
*/*                   DDNAME IS FOUND, THE DSORG OF THE DATA SET     */
*/*                   ASSOCIATED WITH THE DDNAME IS RETURNED.        */
*/*                   ONLY IF THE DDNAME IS NOT FOUND, DOES          */
*/*                   DSNAME ALLOCATION TAKE PLACE.)  THE DDNAME     */
*/*                   ASSOCIATED WITH THE DSNAME ALLOCATION          */
*/*                   IS THEN RETURNED.                              */
*/*                C. IF NONE OF THE ABOVE ERRORS EXIST, THE         */
*/*                   S99ERROR CODE IS STORED IN DA24DARC AND        */
*/*                   RETCODE IS SET TO 12.                          */
*/*                                                                  */
*/* ENTRY - DAIR24(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR24 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   OUTPUT - DSORG & DA24DMY BIT OFF                               */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 0 SUCCESSFUL                           */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*   OUTPUT - DA24DARC (SEE OPERATION TEXT) AND DA24DMY ON (IF      */
*/*            ASSOCIATED WITH A DUMMY ALLOCATION)                   */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 4 INVALID PARAMETER LIST               */
*/*                 RETCODE = 12 DYNAMIC ALLOCATION ERROR            */
*/*                 RETCODE = 20 DDNAME REQUESTED IS UNAVAILABLE     */
*/*                              OR ASSOCIATED WITH A DUMMY          */
*/*                              ALLOCATION                          */
*/*                 RETCODE = 52 REQUEST DENIED BY INSTALLATION EXIT */
*/*                                                                  */
*/********************************************************************/
*DA24DARC = 0;                         /* ZERO DARC FIELD            */
         SLR   @08,@08                                          02S0560
         STH   @08,DA24DARC(,BLOCKPTR)                          02S0560
*DA24CTRC = 0;                         /* ZERO CTRC FIELD            */
         STH   @08,DA24CTRC(,BLOCKPTR)                          02S0561
*DA24DMY = OFF;                        /* ZERO DUMMY INDICATOR       */
         NI    DA24DMY(BLOCKPTR),B'11110111'                    02S0562
*CALL DSNCHECK(DA24CTL,DA24PDSN);      /* VALIDITY CHECK DSNAME      */
         LA    @08,DA24CTL(,BLOCKPTR)                           02S0563
         ST    @08,@AL00001                                     02S0563
         LA    @08,DA24PDSN(,BLOCKPTR)                          02S0563
         ST    @08,@AL00001+4                                   02S0563
         LA    @01,@AL00001                                     02S0563
         BAL   @14,DSNCHECK                                     02S0563
*RETCODE = R15;                        /* SAVE DSNCHECK RETURN CODE  */
         LR    RETCODE,R15                                      02S0564
*IF RETCODE ^= 0                       /* VALID DSNAME ?             */
*  × (DA24DDN(1) = ' ' × DSNBUF(1) = ' ') THEN /* BLANK DSNAME OR
*                                                 DDNAME IS INVALID  */
         LTR   RETCODE,RETCODE                                  02S0565
         BNZ   @RT00565                                         02S0565
         CLI   DA24DDN(BLOCKPTR),C' '                           02S0565
         BE    @RT00565                                         02S0565
         CLI   DSNBUF,C' '                                      02S0565
         BNE   @RF00565                                         02S0565
@RT00565 DS    0H                                               02S0566
*  RETCODE = DRINVLST;                 /* SET INVALID PARM LIST CODE */
         LA    RETCODE,4                                        02S0566
*ELSE                                  /* RETURN CODE IS 0 AND DDNAME
*                                         AND DSNAME SPECIFIED       */
*  DO;                                 /* PROCESS VALID REQUEST      */
         B     @RC00565                                         02S0567
@RF00565 DS    0H                                               02S0568
*    S99VERB = S99VRBDN;               /* SET VERB TO DDNAME ALLOC   */
*                                                               02S0568
*                                                               02S0568
         MVI   S99VERB,X'06'                                    02S0568
*       DO;                                                     02S0569
*         TUP(1) = ADDR(TU(1));                                 02S0570
         LA    @08,TU                                           02S0570
         ST    @08,TUP                                          02S0570
*         TUP(1)->S99TUKEY = DDNDDNAM;                          02S0571
         MVC   S99TUKEY(2,@08),@CB00894                         02S0571
*         TUP(1)->S99TUNUM = 1;                                 02S0572
         LA    @04,1                                            02S0572
         STCM  @04,3,S99TUNUM(@08)                              02S0572
*         TUP(1)->S99TULNG = LENGTH(DA24DDN);                   02S0573
         MVC   S99TULNG(2,@08),@CH00048                         02S0573
*         TUP(1)->S99TUPAR(1:LENGTH(DA24DDN)) = DA24DDN;        02S0574
         MVC   S99TUPAR(8,@08),DA24DDN(BLOCKPTR)                02S0574
*       END;                                                    02S0575
*                                                               02S0575
*       DO;                                                     02S0576
*         TUP(2) = ADDR(TU(2));                                 02S0577
         LA    @08,TU+14                                        02S0577
         ST    @08,TUP+4                                        02S0577
*         TUP(2)->S99TUKEY = DDNRTDUM;                          02S0578
         MVC   S99TUKEY(2,@08),@CB00896                         02S0578
*         TUP(2)->S99TUNUM = 1;                                 02S0579
         STCM  @04,3,S99TUNUM(@08)                              02S0579
*         TUP(2)->S99TULNG = 1;                                 02S0580
         STCM  @04,3,S99TULNG(@08)                              02S0580
*         TUP(2)->S99TUPAR(1:1) = ZERO;                         02S0581
         MVI   S99TUPAR(@08),X'00'                              02S0581
*       END;                                                    02S0582
*                                                               02S0582
*     TUP(2) = TUP(2) × '80000000'X;                            02S0583
         O     @08,@CF01105                                     02S0583
         ST    @08,TUP+4                                        02S0583
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0584
         LA    R1,S99RBPTR                                      02S0584
*     /*MACDATE Y-2 73082*/                                     02S0585
*     SVC (99);                                                 02S0585
         SVC   99                                               02S0585
*    RESPECIFY R15 RESTRICTED;         /* RESTRICT REG 15 USAGE      */
*    IF R15 = 0 THEN                   /* SUCCESSFUL ALLOCATION ?    */
         SLR   @14,@14                                          02S0587
         CR    R15,@14                                          02S0587
         BNE   @RF00587                                         02S0587
*      IF TUP(2) -> S99TUPAR(1) = '80'X THEN /* WAS DD A DUMMY ?     */
         L     @08,TUP+4                                        02S0588
         CLI   S99TUPAR(@08),X'80'                              02S0588
         BNE   @RF00588                                         02S0588
*        DO;                           /* YES, DUMMY RETURNED        */
*          DA24DMY = ON;               /* INDICATE DUMMY ALLOCATION  */
         OI    DA24DMY(BLOCKPTR),B'00001000'                    02S0590
*          RETCODE = DRDDUNAV;         /* SET DAIR RETURN CODE       */
         LA    RETCODE,20                                       02S0591
*          S99VERB = S99VRBUN;         /* SET VERB CODE TO UNALLOC   */
*                                                               02S0592
*                                                               02S0592
         MVI   S99VERB,X'02'                                    02S0592
*             DO;                                               02S0593
*               TUP(1) = ADDR(TU(1));                           02S0594
         LA    @08,TU                                           02S0594
         ST    @08,TUP                                          02S0594
*               TUP(1)->S99TUKEY = DUNDDNAM;                    02S0595
         MVC   S99TUKEY(2,@08),@CB00894                         02S0595
*               TUP(1)->S99TUNUM = 1;                           02S0596
         MVC   S99TUNUM(2,@08),@CH00035                         02S0596
*               TUP(1)->S99TULNG = LENGTH(DA24DDN);             02S0597
         MVC   S99TULNG(2,@08),@CH00048                         02S0597
*               TUP(1)->S99TUPAR(1:LENGTH(DA24DDN)) = DA24DDN;  02S0598
         MVC   S99TUPAR(8,@08),DA24DDN(BLOCKPTR)                02S0598
*             END;                                              02S0599
*                                                               02S0599
*             DO;                                               02S0600
*               TUP(2) = ADDR(TU(2));                           02S0601
         LA    @08,TU+14                                        02S0601
         ST    @08,TUP+4                                        02S0601
*               TUP(2)->S99TUKEY = DUNREMOV;                    02S0602
         MVC   S99TUKEY(2,@08),@CB00157                         02S0602
*               TUP(2)->S99TUNUM = 0;                           02S0603
         STCM  @14,3,S99TUNUM(@08)                              02S0603
*               TUP(2)->S99TULNG = 0;                           02S0604
         STCM  @14,3,S99TULNG(@08)                              02S0604
*             END;                                              02S0605
*                                                               02S0605
*           TUP(2) = TUP(2) × '80000000'X;                      02S0606
         O     @08,@CF01105                                     02S0606
         ST    @08,TUP+4                                        02S0606
*          R1 = ADDR(S99RBPTR);        /* GET PARM PTR ADDRESS       */
*                                                               02S0607
         LA    R1,S99RBPTR                                      02S0607
*           /*MACDATE Y-2 73082*/                               02S0608
*           SVC (99);                                           02S0608
         SVC   99                                               02S0608
*        END;                          /* END DUMMY PROCESSING       */
*      ELSE                            /* NOT DUMMY                  */
*        DO;                           /* RETRIEVE DATA              */
         B     @RC00588                                         02S0610
@RF00588 DS    0H                                               02S0611
*          S99VERB = S99VRBIN;         /* SET VERB CODE TO RETRIEVAL */
*                                                               02S0611
*                                                               02S0611
         MVI   S99VERB,X'07'                                    02S0611
*             DO;                                               02S0612
*               TUP(1) = ADDR(TU(1));                           02S0613
         LA    @14,TU                                           02S0613
         ST    @14,TUP                                          02S0613
*               TUP(1)->S99TUKEY = DINRTORG;                    02S0614
         MVC   S99TUKEY(2,@14),@CB00910                         02S0614
*               TUP(1)->S99TUNUM = 1;                           02S0615
         LA    @08,1                                            02S0615
         STCM  @08,3,S99TUNUM(@14)                              02S0615
*               TUP(1)->S99TULNG = 2;                           02S0616
         MVC   S99TULNG(2,@14),@CH00062                         02S0616
*               TUP(1)->S99TUPAR(1:2) = ZERO;                   02S0617
         SLR   @04,@04                                          02S0617
         STCM  @04,3,S99TUPAR(@14)                              02S0617
*             END;                                              02S0618
*                                                               02S0618
*             DO;                                               02S0619
*               TUP(2) = ADDR(TU(2));                           02S0620
         LA    @14,TU+14                                        02S0620
         ST    @14,TUP+4                                        02S0620
*               TUP(2)->S99TUKEY = DINDDNAM;                    02S0621
         MVC   S99TUKEY(2,@14),@CB00894                         02S0621
*               TUP(2)->S99TUNUM = 1;                           02S0622
         STCM  @08,3,S99TUNUM(@14)                              02S0622
*               TUP(2)->S99TULNG = LENGTH(DA24DDN);             02S0623
         MVC   S99TULNG(2,@14),@CH00048                         02S0623
*               TUP(2)->S99TUPAR(1:LENGTH(DA24DDN)) = DA24DDN;  02S0624
         MVC   S99TUPAR(8,@14),DA24DDN(BLOCKPTR)                02S0624
*             END;                                              02S0625
*                                                               02S0625
*           TUP(2) = TUP(2) × '80000000'X;                      02S0626
         O     @14,@CF01105                                     02S0626
         ST    @14,TUP+4                                        02S0626
*          R1 = ADDR(S99RBPTR);        /* GET PARM PTR ADDRESS       */
*                                                               02S0627
         LA    R1,S99RBPTR                                      02S0627
*           /*MACDATE Y-2 73082*/                               02S0628
*           SVC (99);                                           02S0628
         SVC   99                                               02S0628
*          DA24DSO = TUP(1) -> S99TUPAR(1:2); /* RETURN DSORG        */
         L     @14,TUP                                          02S0629
         MVC   DA24DSO(1,BLOCKPTR),S99TUPAR(@14)                02S0629
*        END;                          /* END DATA RETRIEVAL         */
*    ELSE                              /* ALLOCATION NOT SUCCESSFUL  */
*      DO;                             /* DETERMINE TYPE OF ERROR    */
         B     @RC00587                                         02S0631
@RF00587 DS    0H                                               02S0632
*        IF R15 = 8 THEN               /* WAS REQUEST DENIED BY 02S0632
*                                         INSTALLATION EXIT ?        */
         C     R15,@CF00048                                     02S0632
         BNE   @RF00632                                         02S0632
*          RETCODE = DRREQDEN;         /* YES, SET RETCODE TO 52     */
         LA    RETCODE,52                                       02S0633
*        ELSE                          /* R15 IS NOT 8               */
*          IF S99ERROR = RCDDUNAV THEN /* DDNAME UNAVAILABLE ?       */
         B     @RC00632                                         02S0634
@RF00632 CLC   S99ERROR(2),@CB00280                             02S0634
         BNE   @RF00634                                         02S0634
*            RETCODE = DRDDUNAV;       /* YES, SET RETCODE TO 20     */
         LA    RETCODE,20                                       02S0635
*          ELSE                        /* S99ERROR IS NOT '0410'X    */
*            IF S99ERROR = RCDDNFND    /* DDNAME NOT FOUND ?         */
*              × S99ERROR =RCDDCONV THEN /* DDNAME ASSOCIATED WITH A
*                                          CONVERTIBLE OR NON- PERM
*                                          CONCAT RESOURCE ?         */
         B     @RC00634                                         02S0636
@RF00634 CLC   S99ERROR(2),@CB00288                             02S0636
         BE    @RT00636                                         02S0636
         CLC   S99ERROR(2),@CB00286                             02S0636
         BNE   @RF00636                                         02S0636
@RT00636 DS    0H                                               02S0637
*              DO;                     /* YES, ALLOC BY DSNAME       */
*                DA24DDN = '';         /* BLANK DDNAME               */
         MVI   DA24DDN(BLOCKPTR),C' '                           02S0638
         MVC   DA24DDN+1(7,BLOCKPTR),DA24DDN(BLOCKPTR)          02S0638
*                CALL DAIR08;          /* CALL DAIR08 TO ALLOCATE    */
         BAL   @14,DAIR08                                       02S0639
*              END;                    /* END CALL TO DAIR08         */
*            ELSE                      /* ERROR NOT DETERMINED       */
*              DO;                     /* SET RETURN CODE            */
         B     @RC00636                                         02S0641
@RF00636 DS    0H                                               02S0642
*                RETCODE = DRDYNERR;   /* INDICATE DYN/ALLOC ERROR   */
         LA    RETCODE,12                                       02S0642
*                DA24DARC = S99ERROR;  /* STORE S99ERROR CODE IN DARC*/
         LH    @14,S99ERROR                                     02S0643
         N     @14,@CF01193                                     02S0643
         STH   @14,DA24DARC(,BLOCKPTR)                          02S0643
*              END;                    /* END UNDETERMINED ERROR     */
*      END;                            /* END ALLOCATION FAILURE
*                                         PROCESSING                 */
@RC00636 DS    0H                                               02S0645
@RC00634 DS    0H                                               02S0645
@RC00632 DS    0H                                               02S0646
*  END;                                /* END VALID REQUEST          */
@RC00587 DS    0H                                               02S0647
*        END;                          /* END CODE 24                */
@RC00565 DS    0H                                               01S0648
*      IF BLOCKPTR->DAIRCODE='002C'X THEN /* IS DAIR CODE 2C         */
@RF00558 CLC   DAIRCODE(2,BLOCKPTR),@CB00175                    01S0648
         BNE   @RF00648                                         01S0648
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR2C                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 2C PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR2C PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR2C IS INVOKED       */
*/*            IN ORDER TO MARK DSABS NOT IN USE.                    */
*/*                                                                  */
*/* OPERATION - THE DA2CFLG FIELD IS TESTED FOR '0001'X(MARK DSAB    */
*/*             ASSOCIATED WITH SUPPLIED DDNAME NOT IN USE).  IF     */
*/*             THE DA2CFLG FIELD IS '0001'X AND A DDNAME IS PRESENT,*/
*/*             TEXT UNITS ARE BUILT TO MARK THE DSAB NOT IN USE.    */
*/*             DYNAMIC ALLOCATION IS INVOKED.  IF THE RETURN CODE   */
*/*             FROM DYNAMIC ALLOCATION IS 8, RETCODE IS SET TO      */
*/*             52(REQUEST DENIED BY INSTALLATION EXIT).  NO OTHER   */
*/*             RETURN CODES FROM DYNAMIC ALLOCATION ARE TESTED FOR. */
*/*             IF THE DA2CFLG IS '0001'X AND THE DDNAME IS NOT      */
*/*             SUPPLIED, RETCODE IS SET TO 4(INVALID PARM LIST).    */
*/*                                                                  */
*/*             IF DA2CFLG FIELD IS NOT '0001'X, IT IS TESTED FOR    */
*/*             '0002'X(MARK ALL DSABS ASSOCIATED WITH LOWER TASKS   */
*/*             NOT IN USE).  IF THE DA2CFLG FIELD IS '0002'X, A     */
*/*             TEXT UNIT IS BUILT TO MARK DSABS OF LOWER TASKS      */
*/*             NOT IN USE.  DYNAMIC ALLOCATION IS INVOKED.  IF      */
*/*             THE RETURN CODE FROM DYNAMIC ALLOCATION IS 8,        */
*/*             RETCODE IS SET TO 52(REQUEST DENIED BY INSTALLATION  */
*/*             EXIT).  NO OTHER DYNAMIC ALLOCATION RETURN CODES ARE */
*/*             TESTED FOR.                                          */
*/*                                                                  */
*/*             IF DA2CFLG FIELD IS NOT '0001'X OR '0002'X, IT IS    */
*/*             TESTED FOR '0000'X.  IF IT IS NOT '0000', RETCODE    */
*/*             IS SET TO 4(INVALID PARM LIST).  IF DA2CFLG IS       */
*/*             '0000'X BUT THE TCB ADDRESS IS NOT PRESENT, RETCODE  */
*/*             IS SET TO 4 ALSO.  IF NONE OF THE ABOVE ERRORS       */
*/*             EXIST, A TEXT UNIT IS BUILT TO MARK ALL DSABS        */
*/*             ASSOCIATED WITH THE SPECIFIED TCB NOT IN USE.        */
*/*             DYNAMIC ALLOCATION IS INVOKED.  IF THE RETURN CODE   */
*/*             FROM DYNAMIC ALLOCATION IS 8, RETCODE IS SET TO 52   */
*/*             (REQUEST DENIED BY INSTALLATION EXIT).  NO OTHER     */
*/*             DYNAMIC ALLOCATION RETURN CODES ARE TESTED FOR.      */
*/*             NOTE: TO REMOVE THE IN-USE ATTRIBUTE, UNALLOCATION   */
*/*                   IS USED FOR DDNAME(DA2CFLG = '0001'X),         */
*/*                   OTHERWISE THE REMOVE IN USE FUNCTION OF        */
*/*                   DYNAMIC ALLOCATION IS USED(DA2CFLG = '0000'X   */
*/*                   OR '0002'X).                                   */
*/*                                                                  */
*/* ENTRY - DAIR2C(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR2C PARM BLOCK,SVC99 PARM LIST                   */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   RETURN CODE - RETCODE = 0 SUCCESSFUL                           */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*   RETURN CODE - RETCODE = 4 INVALID PARM LIST                    */
*/*                 RETCODE = 52 REQUEST DENIED BY INSTALLATION      */
*/*                              EXIT                                */
*/*                                                                  */
*/********************************************************************/
*IF DA2CFLG = '0001'X THEN             /* MARK SPECIFIED DDNAME ?    */
         CLC   DA2CFLG(2,BLOCKPTR),@CH00894                     02S0650
         BNE   @RF00650                                         02S0650
*  IF DA2CDDN(1) ^= ' ' THEN           /* IS DDNAME PRESENT ?        */
         CLI   DA2CDDN(BLOCKPTR),C' '                           02S0651
         BE    @RF00651                                         02S0651
*    DO;                               /* YES, CONTINUE PROCESSING   */
*      S99VERB = S99VRBUN;             /* SET VERB CODE TO UNALLOC   */
*                                                               02S0653
*                                                               02S0653
         MVI   S99VERB,X'02'                                    02S0653
*         DO;                                                   02S0654
*           TUP(1) = ADDR(TU(1));                               02S0655
         LA    @14,TU                                           02S0655
         ST    @14,TUP                                          02S0655
*           TUP(1)->S99TUKEY = DUNDDNAM;                        02S0656
         MVC   S99TUKEY(2,@14),@CB00894                         02S0656
*           TUP(1)->S99TUNUM = 1;                               02S0657
         MVC   S99TUNUM(2,@14),@CH00035                         02S0657
*           TUP(1)->S99TULNG = LENGTH(DA2CDDN);                 02S0658
         MVC   S99TULNG(2,@14),@CH00048                         02S0658
*           TUP(1)->S99TUPAR(1:LENGTH(DA2CDDN)) = DA2CDDN;      02S0659
         MVC   S99TUPAR(8,@14),DA2CDDN(BLOCKPTR)                02S0659
*         END;                                                  02S0660
*                                                               02S0660
*         DO;                                                   02S0661
*           TUP(2) = ADDR(TU(2));                               02S0662
         LA    @14,TU+14                                        02S0662
         ST    @14,TUP+4                                        02S0662
*           TUP(2)->S99TUKEY = DUNREMOV;                        02S0663
         MVC   S99TUKEY(2,@14),@CB00157                         02S0663
*           TUP(2)->S99TUNUM = 0;                               02S0664
         SLR   @08,@08                                          02S0664
         STCM  @08,3,S99TUNUM(@14)                              02S0664
*           TUP(2)->S99TULNG = 0;                               02S0665
         STCM  @08,3,S99TULNG(@14)                              02S0665
*         END;                                                  02S0666
*                                                               02S0666
*       TUP(2) = TUP(2) × '80000000'X;                          02S0667
         O     @14,@CF01105                                     02S0667
         ST    @14,TUP+4                                        02S0667
*      R1 = ADDR(S99RBPTR);            /* GET PARM PTR ADDRESS       */
*                                                               02S0668
         LA    R1,S99RBPTR                                      02S0668
*       /*MACDATE Y-2 73082*/                                   02S0669
*       SVC (99);                                               02S0669
         SVC   99                                               02S0669
*      IF R15 = 8 THEN                 /* WAS REQUEST DENIED BY 02S0670
*                                         INSTALLATION EXIT ?        */
         C     R15,@CF00048                                     02S0670
         BNE   @RF00670                                         02S0670
*        RETCODE = DRREQDEN;           /* SET RETCODE TO 52          */
         LA    RETCODE,52                                       02S0671
*    END;                              /* END MARK DDNAME NOT IN USE */
*  ELSE                                /* DDNAME NOT SUPPLIED        */
*    RETCODE = DRINVLST;               /* INVALID PARAMETER LIST     */
         B     @RC00651                                         02S0673
@RF00651 LA    RETCODE,4                                        02S0673
*ELSE                                  /* DA2CFLG FIELD ISN'T '0001'X*/
*  IF DA2CFLG = '0002'X THEN           /* MARK DSABS ASSOCIATED WITH
*                                         LOWER TASKS NOT IN USE     */
         B     @RC00650                                         02S0674
@RF00650 CLC   DA2CFLG(2,BLOCKPTR),@CH00896                     02S0674
         BNE   @RF00674                                         02S0674
*    DO;                               /* YES, CONTINUE PROCESSING   */
*      S99VERB = S99VRBRI;             /* SET VERB CODE TO REMOVE
*                                         IN USE                     */
*                                                               02S0676
*                                                               02S0676
         MVI   S99VERB,X'05'                                    02S0676
*         DO;                                                   02S0677
*           TUP(1) = ADDR(TU(1));                               02S0678
         LA    @14,TU                                           02S0678
         ST    @14,TUP                                          02S0678
*           TUP(1)->S99TUKEY = DRICURNT;                        02S0679
         MVC   S99TUKEY(2,@14),@CB00896                         02S0679
*           TUP(1)->S99TUNUM = 0;                               02S0680
         SLR   @08,@08                                          02S0680
         STCM  @08,3,S99TUNUM(@14)                              02S0680
*           TUP(1)->S99TULNG = 0;                               02S0681
         STCM  @08,3,S99TULNG(@14)                              02S0681
*         END;                                                  02S0682
*                                                               02S0682
*       TUP(1) = TUP(1) × '80000000'X;                          02S0683
         O     @14,@CF01105                                     02S0683
         ST    @14,TUP                                          02S0683
*      R1 = ADDR(S99RBPTR);            /* GET PARM PTR ADDRESS       */
*                                                               02S0684
         LA    R1,S99RBPTR                                      02S0684
*       /*MACDATE Y-2 73082*/                                   02S0685
*       SVC (99);                                               02S0685
         SVC   99                                               02S0685
*      IF R15 = 8 THEN                 /* WAS REQUEST DENIED BY 02S0686
*                                         INSTALLATION EXIT ?        */
         C     R15,@CF00048                                     02S0686
         BNE   @RF00686                                         02S0686
*        RETCODE = DRREQDEN;           /* YES, SET RETCODE TO 52     */
         LA    RETCODE,52                                       02S0687
*    END;                              /* END MARK DSABS OF LOWER
*                                         TASKS NOT IN USE           */
*  ELSE                                /* DA2CFLG FIELD ISN'T '0002'X*/
*    IF DA2CFLG = '0000'X              /* MARK ALL DSABS ASSOCIATED
*                                         WITH SUPPLIED TCB NOT INUSE*/
*      & DA2CTCB ^= 0 THEN             /* TCB ADDRESS SUPPLIED ?     */
         B     @RC00674                                         02S0689
@RF00674 LH    @14,DA2CFLG(,BLOCKPTR)                           02S0689
         LTR   @14,@14                                          02S0689
         BNZ   @RF00689                                         02S0689
         L     @14,DA2CTCB(,BLOCKPTR)                           02S0689
         LTR   @14,@14                                          02S0689
         BZ    @RF00689                                         02S0689
*      DO;                             /* GENERATE TEXT UNITS        */
*        S99VERB = S99VRBRI;           /* SET VERB CODE TO REMOVE
*                                         IN USE                     */
*                                                               02S0691
*                                                               02S0691
         MVI   S99VERB,X'05'                                    02S0691
*           DO;                                                 02S0692
*             TUP(1) = ADDR(TU(1));                             02S0693
         LA    @08,TU                                           02S0693
         ST    @08,TUP                                          02S0693
*             TUP(1)->S99TUKEY = DRITCBAD;                      02S0694
         MVC   S99TUKEY(2,@08),@CB00894                         02S0694
*             TUP(1)->S99TUNUM = 1;                             02S0695
         MVC   S99TUNUM(2,@08),@CH00035                         02S0695
*             TUP(1)->S99TULNG = LENGTH(DA2CTCB);               02S0696
         MVC   S99TULNG(2,@08),@CH00059                         02S0696
*             TUP(1)->S99TUPAR(1:LENGTH(DA2CTCB)) = DA2CTCB;    02S0697
         STCM  @14,15,S99TUPAR(@08)                             02S0697
*           END;                                                02S0698
*                                                               02S0698
*         TUP(1) = TUP(1) × '80000000'X;                        02S0699
         O     @08,@CF01105                                     02S0699
         ST    @08,TUP                                          02S0699
*        R1 = ADDR(S99RBPTR);          /* GET PARM PTR ADDRESS       */
*                                                               02S0700
         LA    R1,S99RBPTR                                      02S0700
*         /*MACDATE Y-2 73082*/                                 02S0701
*         SVC (99);                                             02S0701
         SVC   99                                               02S0701
*        IF R15 = 8 THEN               /* WAS REQUEST DENIED BY 02S0702
*                                         INSTALLATION EXIT ?        */
         C     R15,@CF00048                                     02S0702
         BNE   @RF00702                                         02S0702
*          RETCODE = DRREQDEN;         /* YES, SET RETCODE TO 52     */
         LA    RETCODE,52                                       02S0703
*      END;                            /* END MARKING DSABS ASSOCIATED
*                                         WITH SUPPLIED TCB ADDRESS
*                                         NOT IN USE                 */
*    ELSE                              /* DA2CFLG IS NOT VALID       */
*      RETCODE = DRINVLST;             /* INDICATE INVALID PARM LIST */
         B     @RC00689                                         02S0705
@RF00689 LA    RETCODE,4                                        02S0705
*        END;                          /* END CODE 2C                */
@RC00689 DS    0H                                               01S0706
@RC00674 DS    0H                                               01S0706
@RC00650 DS    0H                                               01S0707
*      IF BLOCKPTR->DAIRCODE='0030'X THEN /* IS DAIR CODE 30         */
@RF00648 CLC   DAIRCODE(2,BLOCKPTR),@CB00210                    01S0707
         BNE   @RF00707                                         01S0707
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR30                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 30 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - DAIR30 IS INVOKED WHEN A DAIR30 PARM BLOCK            */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR30 IS INVOKED       */
*/*            IN ORDER TO ALLOCATE A SYSOUT DATA SET.               */
*/*                                                                  */
*/* OPERATION - THE DAIR30 PARM BLOCK IS EXAMINED FOR THE FOLLOWING  */
*/*             INVALID CONDITIONS:                                  */
*/*              1. DA30ATRL BIT ON AND ATTRIBUTE LIST NAME BLANK    */
*/*              2. DA30UNIT = 0  ZERO IN UNIT NAME                  */
*/*              3. DA30PDSN ^= 0  DSNAME BUFFER NOT SUPPLIED        */
*/*                 DA30DSNL NOT 44  DSNAME BUFFER LENGTH NOT 44     */
*/*                 DA30DSN NOT BLANK  DSNAME BUFFER NOT BLANK       */
*/*             IF ANY OF THE ABOVE ERROR CONDITIONS ARE FOUND,      */
*/*             RETCODE IS SET TO 4 AND NO FURTHER PROCESSING        */
*/*             IS DONE.                                             */
*/*                                                                  */
*/*             IF NONE OF THE ABOVE ERRORS ARE FOUND, TEXT UNITS    */
*/*             ARE BUILT USING DATA FROM THE DAIR30 PARM BLOCK.     */
*/*             AFTER THE TEXT UNITS ARE COMPLETED, DYNAMIC          */
*/*             ALLOCATION IS INVOKED TO ALLOCATE THE SYSOUT         */
*/*             DATA SET.                                            */
*/*                                                                  */
*/*             THE DYNAMIC ALLOCATION RETURN CODE (IN REG15) IS     */
*/*             EXAMINED TO DETERMINE IF THERE WERE ANY ERRORS.      */
*/*                                                                  */
*/*             IF REG 15 = 8 AFTER INVOKING DYNAMIC ALLOCATION,     */
*/*             RETCODE IS SET TO 52.  THIS INDICATES THE REQUEST    */
*/*             WAS DENIED BY THE INSTALLATION EXIT ROUTINE.         */
*/*                                                                  */
*/*             IF REG 15 = 12 AFTER INVOKING DYNAMIC ALLOCATION     */
*/*             (INDICATING INVALID DYN/ALLOC PARMS), THE S99ERROR   */
*/*             AND S99INFO CODES ARE EXAMINED TO DETERMINE WHICH    */
*/*             DYNAMIC ALLOCATION REASON CODE TO RETURN IN THE      */
*/*             DA30DARC.  THE FOLLOWING TESTS ARE DONE              */
*/*              1. IF S99ERROR IS RCINPARM THE S99INFO CODE IS      */
*/*                 EXAMINED AND THE DARC IS SET IN THE FOLLOWING    */
*/*                 MANNER:                                          */
*/*                  A. IF S99INFO = DALDDNAM KEY, THE DDNAME HAS    */
*/*                     INVALID CHARACTERS AND THE DARC IS SET TO    */
*/*                     DRDDNINV.                                    */
*/*                  B. IF S99INFO = DALSPGMN KEY, THE SYSOUT        */
*/*                     PROGRAM NAME HAS INVALID CHARACTERS AND      */
*/*                     THE DARC IS SET TO DRSYSPGM.                 */
*/*                  C. IF S99INFO = DALSFORM KEY, THE FORM          */
*/*                     NUMBER HAS INVALID CHARACTERS AND THE        */
*/*                     DARC IS SET TO DRSYSFRM.                     */
*/*                  D. IF NONE OF THE ABOVE ERRORS EXIST, THE       */
*/*                     S99ERROR CODE IS STORED INTO DA30DARC.       */
*/*              2. IF THE S99ERROR CODE WAS NOT RCINPARM, THE       */
*/*                 S99ERROR IS STORED IN THE DARC.                  */
*/*             ANY OF THE ABOVE ERRORS RESULT IN RETCODE BEING      */
*/*             SET TO 12.                                           */
*/*                                                                  */
*/*             IF REG 15 = 4 AFTER INVOKING DYNAMIC ALLOCATION      */
*/*             (ENVIRONMENTAL ERROR), THE S99ERROR CODE IS          */
*/*             EXAMINED TO DETERMINE WHICH DYNAMIC ALLOCATION       */
*/*             REASON CODE TO RETURN IN THE DA30DARC.  THE          */
*/*             FOLLOWING TESTS ARE DONE.                            */
*/*              1. IF S99ERROR = RCDDUNAV THE DDNAME IS UNAVAILABLE */
*/*                 AND RETCODE IS SET TO 20.                        */
*/*              2. IF S99ERROR = RCNTUNLC(RESOURCES COULD NOT BE    */
*/*                 UNALLOCATED TO THE CONTROL VALUE) OR RCLIMITS    */
*/*                 (REQUEST WOULD EXCEED LIMIT OF 1635 ALLOCATIONS),*/
*/*                 RETCODE IS SET TO 16.                            */
*/*              3. IF S99ERROR = RCDCBRNF(DCB REFERBACK NOT FOUND), */
*/*                 RETCODE IS SET TO 28.                            */
*/*             IF RETCODE IS STILL 0 AFTER THE ABOVE TESTS,         */
*/*             THE S99ERROR CODE IS STORED IN THE DARC AND          */
*/*             RETCODE IS SET TO 12.                                */
*/*                                                                  */
*/*             IF THE RETURN CODE FROM DYNAMIC ALLOCATION IS ZERO,  */
*/*             THE DSNAME LENGTH, DSNAME AND DDNAME ARE             */
*/*             STORED INTO THE DAIR30 PARM BLOCK.                   */
*/*                                                                  */
*/* ENTRY - DAIR30(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR30 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   OUTPUT - DSNAME LENGTH,DSNAME AND DDNAME RETURNED              */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 0 SUCCESSFUL ALLOCATION                */
*/*                                                                  */
*/*  ERROR -                                                         */
*/*   OUTPUT - DA30DARC (SEE OPERATION TEXT)                         */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 4 INVALID PARAMETER LIST               */
*/*                          12 DYNAMIC ALLOCATION ERROR             */
*/*                          16 RESOURCES COULD NOT BE UNALLOCATED   */
*/*                             TO LIMIT OR REQUEST WOULD EXCEED     */
*/*                             1635 CONCURRENT ALLOCATIONS          */
*/*                          20 DDNAME REQUESTED IS UNAVAILABLE      */
*/*                          28 DDNAME SPECIFIED IS NOT ALLOCATED    */
*/*                          52 REQUEST DENIED BY INSTALLATION EXIT  */
*/*                                                                  */
*/********************************************************************/
*IF (DA30ATRL = ON & DA30ALN(1) = ' ') /* TEST FOR INVALID PARAMETERS*/
*  × (DA30PDSN ^= 0 & (DA30DSNL ^= 44 × DA30DSN(1) ^= ' '))     02S0709
*  × DA30UNIT(1) = '00'X THEN                                   02S0709
         TM    DA30ATRL(BLOCKPTR),B'00000010'                   02S0709
         BNO   @GL00019                                         02S0709
         CLI   DA30ALN(BLOCKPTR),C' '                           02S0709
         BE    @RT00709                                         02S0709
@GL00019 L     @14,DA30PDSN(,BLOCKPTR)                          02S0709
         LTR   @14,@14                                          02S0709
         BZ    @GL00018                                         02S0709
         CLC   DA30DSNL(2,@14),@CH00092                         02S0709
         BNE   @RT00709                                         02S0709
         CLI   DA30DSN(@14),C' '                                02S0709
         BNE   @RT00709                                         02S0709
@GL00018 CLI   DA30UNIT(BLOCKPTR),X'00'                         02S0709
         BNE   @RF00709                                         02S0709
@RT00709 DS    0H                                               02S0710
*  RETCODE = DRINVLST;                                          02S0710
         LA    RETCODE,4                                        02S0710
*ELSE                                  /* NOTHING INVALID            */
*  DO;                                 /* CONTINUE PROCESSING REQUEST*/
         B     @RC00709                                         02S0711
@RF00709 DS    0H                                               02S0712
*    S99VERB = S99VRBAL;               /* SET VERB CODE TO ALLOCATE  */
*                                                               02S0712
         MVI   S99VERB,X'01'                                    02S0712
*    IF DA30PDSN ^= 0 THEN             /* IS DSNAME BUFFER PRESENT ? */
*                                                               02S0713
         L     @14,DA30PDSN(,BLOCKPTR)                          02S0713
         LTR   @14,@14                                          02S0713
         BZ    @RF00713                                         02S0713
*         DO;                                                   02S0714
*           TUP(1) = ADDR(TUDSN);                               02S0715
         LA    @14,TUDSN                                        02S0715
         ST    @14,TUP                                          02S0715
*           TUP(1)->S99TUKEY = DALRTDSN;                        02S0716
         MVC   S99TUKEY(2,@14),@CB01051                         02S0716
*           TUP(1)->S99TUNUM = 1;                               02S0717
         MVC   S99TUNUM(2,@14),@CH00035                         02S0717
*           TUP(1)->S99TULNG = 44;                              02S0718
         MVC   S99TULNG(2,@14),@CH00092                         02S0718
*           TUP(1)->S99TUPAR(1:44) = '';                        02S0719
         MVI   S99TUPAR(@14),C' '                               02S0719
         MVC   S99TUPAR+1(43,@14),S99TUPAR(@14)                 02S0719
*         END;                                                  02S0720
*    IF DA30DDN(1) = ' ' THEN                                   02S0721
*                                                               02S0721
@RF00713 CLI   DA30DDN(BLOCKPTR),C' '                           02S0721
         BNE   @RF00721                                         02S0721
*         DO;                                                   02S0722
*           TUP(2) = ADDR(TU(2));                               02S0723
         LA    @14,TU+14                                        02S0723
         ST    @14,TUP+4                                        02S0723
*           TUP(2)->S99TUKEY = DALRTDDN;                        02S0724
         MVC   S99TUKEY(2,@14),@CB01049                         02S0724
*           TUP(2)->S99TUNUM = 1;                               02S0725
         MVC   S99TUNUM(2,@14),@CH00035                         02S0725
*           TUP(2)->S99TULNG = 8;                               02S0726
         MVC   S99TULNG(2,@14),@CH00048                         02S0726
*           TUP(2)->S99TUPAR(1:8) = '';                         02S0727
         MVI   S99TUPAR(@14),C' '                               02S0727
         MVC   S99TUPAR+1(7,@14),S99TUPAR(@14)                  02S0727
*         END;                                                  02S0728
*    ELSE                                                       02S0729
*                                                               02S0729
*         DO;                                                   02S0729
         B     @RC00721                                         02S0729
@RF00721 DS    0H                                               02S0730
*           TUP(2) = ADDR(TU(2));                               02S0730
         LA    @14,TU+14                                        02S0730
         ST    @14,TUP+4                                        02S0730
*           TUP(2)->S99TUKEY = DALDDNAM;                        02S0731
         MVC   S99TUKEY(2,@14),@CB00894                         02S0731
*           TUP(2)->S99TUNUM = 1;                               02S0732
         MVC   S99TUNUM(2,@14),@CH00035                         02S0732
*           TUP(2)->S99TULNG = LENGTH(DA30DDN);                 02S0733
         MVC   S99TULNG(2,@14),@CH00048                         02S0733
*           TUP(2)->S99TUPAR(1:LENGTH(DA30DDN)) = DA30DDN;      02S0734
         MVC   S99TUPAR(8,@14),DA30DDN(BLOCKPTR)                02S0734
*         END;                                                  02S0735
*                                                               02S0735
*     IF DA30UNIT^=' ' THEN                                     02S0736
@RC00721 CLI   DA30UNIT(BLOCKPTR),C' '                          02S0736
         BE    @RF00736                                         02S0736
*       DO;                                                     02S0737
*         TUP(3) = ADDR(TU(3));                                 02S0738
         LA    @14,TU+28                                        02S0738
         ST    @14,TUP+8                                        02S0738
*         TUP(3)->S99TUKEY = DALUNIT;                           02S0739
         MVC   S99TUKEY(2,@14),@CB00929                         02S0739
*         TUP(3)->S99TUNUM = 1;                                 02S0740
         MVC   S99TUNUM(2,@14),@CH00035                         02S0740
*         TUP(3)->S99TULNG = LENGTH(DA30UNIT);                  02S0741
         MVC   S99TULNG(2,@14),@CH00048                         02S0741
*         TUP(3)->S99TUPAR(1:LENGTH(DA30UNIT)) = DA30UNIT;      02S0742
         MVC   S99TUPAR(8,@14),DA30UNIT(BLOCKPTR)               02S0742
*       END;                                                    02S0743
*                                                               02S0743
*     IF DA30ATRL^='0'B THEN                                    02S0744
@RF00736 TM    DA30ATRL(BLOCKPTR),B'00000010'                   02S0744
         BZ    @RF00744                                         02S0744
*       DO;                                                     02S0745
*         TUP(4) = ADDR(TU(4));                                 02S0746
         LA    @14,TU+42                                        02S0746
         ST    @14,TUP+12                                       02S0746
*         TUP(4)->S99TUKEY = DALDCBDD;                          02S0747
         MVC   S99TUKEY(2,@14),@CB00971                         02S0747
*         TUP(4)->S99TUNUM = 1;                                 02S0748
         MVC   S99TUNUM(2,@14),@CH00035                         02S0748
*         TUP(4)->S99TULNG = LENGTH(DA30ALN);                   02S0749
         MVC   S99TULNG(2,@14),@CH00048                         02S0749
*         TUP(4)->S99TUPAR(1:LENGTH(DA30ALN)) = DA30ALN;        02S0750
         MVC   S99TUPAR(8,@14),DA30ALN(BLOCKPTR)                02S0750
*       END;                                                    02S0751
*    IF DA30PQTY(2:4) ^= ZERO THEN     /* WAS PRIMARY SPACE SUPPLIED?*/
@RF00744 SLR   @14,@14                                          02S0752
         SLR   @08,@08                                          02S0752
         ICM   @08,7,DA30PQTY+1(BLOCKPTR)                       02S0752
         CR    @14,@08                                          02S0752
         BE    @RF00752                                         02S0752
*      DO;                             /* YES, PROCESS ALL SPACE
*                                         RELATED DATA               */
*                                                               02S0753
*           DO;                                                 02S0754
*             TUP(5) = ADDR(TU(5));                             02S0755
         LA    @08,TU+56                                        02S0755
         ST    @08,TUP+16                                       02S0755
*             TUP(5)->S99TUKEY = DALPRIME;                      02S0756
         MVC   S99TUKEY(2,@08),@CB00910                         02S0756
*             TUP(5)->S99TUNUM = 1;                             02S0757
         LA    @04,1                                            02S0757
         STCM  @04,3,S99TUNUM(@08)                              02S0757
*             TUP(5)->S99TULNG = 3;                             02S0758
         LA    @03,3                                            02S0758
         STCM  @03,3,S99TULNG(@08)                              02S0758
*             TUP(5)->S99TUPAR(1:3) = DA30PQTY(2:4);            02S0759
         MVC   S99TUPAR(3,@08),DA30PQTY+1(BLOCKPTR)             02S0759
*           END;                                                02S0760
*                                                               02S0760
*         IF DA30SQTY(2:4)^=ZERO THEN                           02S0761
         SLR   @08,@08                                          02S0761
         ICM   @08,7,DA30SQTY+1(BLOCKPTR)                       02S0761
         CR    @14,@08                                          02S0761
         BE    @RF00761                                         02S0761
*           DO;                                                 02S0762
*             TUP(6) = ADDR(TU(6));                             02S0763
         LA    @14,TU+70                                        02S0763
         ST    @14,TUP+20                                       02S0763
*             TUP(6)->S99TUKEY = DALSECND;                      02S0764
         MVC   S99TUKEY(2,@14),@CB00912                         02S0764
*             TUP(6)->S99TUNUM = 1;                             02S0765
         STCM  @04,3,S99TUNUM(@14)                              02S0765
*             TUP(6)->S99TULNG = 3;                             02S0766
         STCM  @03,3,S99TULNG(@14)                              02S0766
*             TUP(6)->S99TUPAR(1:3) = DA30SQTY(2:4);            02S0767
         MVC   S99TUPAR(3,@14),DA30SQTY+1(BLOCKPTR)             02S0767
*           END;                                                02S0768
*        IF DA30TRKS = ON & DA30ABKL = ON THEN/* CYLINDER ALLOCATION?*/
*                                                               02S0769
@RF00761 TM    DA30TRKS(BLOCKPTR),B'11000000'                   02S0769
         BNO   @RF00769                                         02S0769
*              DO;                                              02S0770
*                TUP(7) = ADDR(TU(7));                          02S0771
         LA    @14,TU+84                                        02S0771
         ST    @14,TUP+24                                       02S0771
*                TUP(7)->S99TUKEY = DALCYL;                     02S0772
         MVC   S99TUKEY(2,@14),@CB00157                         02S0772
*                TUP(7)->S99TUNUM = 0;                          02S0773
         SLR   @08,@08                                          02S0773
         STCM  @08,3,S99TUNUM(@14)                              02S0773
*                TUP(7)->S99TULNG = 0;                          02S0774
         STCM  @08,3,S99TULNG(@14)                              02S0774
*              END;                                             02S0775
*        ELSE                          /* NOT CYLINDER ALLOCATION    */
*          DO;                         /* DETERMINE TYPE OF UNITS    */
*                                                               02S0776
         B     @RC00769                                         02S0776
@RF00769 DS    0H                                               02S0777
*             IF DA30TRKS^='0'B THEN                            02S0777
         TM    DA30TRKS(BLOCKPTR),B'10000000'                   02S0777
         BZ    @RF00777                                         02S0777
*               DO;                                             02S0778
*                 TUP(7) = ADDR(TU(7));                         02S0779
         LA    @14,TU+84                                        02S0779
         ST    @14,TUP+24                                       02S0779
*                 TUP(7)->S99TUKEY = DALTRK;                    02S0780
         MVC   S99TUKEY(2,@14),@CB00905                         02S0780
*                 TUP(7)->S99TUNUM = 0;                         02S0781
         SLR   @08,@08                                          02S0781
         STCM  @08,3,S99TUNUM(@14)                              02S0781
*                 TUP(7)->S99TULNG = 0;                         02S0782
         STCM  @08,3,S99TULNG(@14)                              02S0782
*               END;                                            02S0783
*                                                               02S0783
*             IF DA30ABKL^='0'B THEN                            02S0784
@RF00777 TM    DA30ABKL(BLOCKPTR),B'01000000'                   02S0784
         BZ    @RF00784                                         02S0784
*               DO;                                             02S0785
*                 TUP(8) = ADDR(TU(8));                         02S0786
         LA    @14,TU+98                                        02S0786
         ST    @14,TUP+28                                       02S0786
*                 TUP(8)->S99TUKEY = DALBLKLN;                  02S0787
         MVC   S99TUKEY(2,@14),@CB00908                         02S0787
*                 TUP(8)->S99TUNUM = 1;                         02S0788
         MVC   S99TUNUM(2,@14),@CH00035                         02S0788
*                 TUP(8)->S99TULNG = 3;                         02S0789
         MVC   S99TULNG(2,@14),@CH00079                         02S0789
*                 TUP(8)->S99TUPAR(1:3) = DA30BLK(2:4);         02S0790
         MVC   S99TUPAR(3,@14),DA30BLK+1(BLOCKPTR)              02S0790
*               END;                                            02S0791
*          END;                        /* END UNITS DETERMINATION    */
*                                                               02S0792
@RF00784 DS    0H                                               02S0793
*         IF DA30RLSE^='0'B THEN                                02S0793
@RC00769 TM    DA30RLSE(BLOCKPTR),B'00010000'                   02S0793
         BZ    @RF00793                                         02S0793
*           DO;                                                 02S0794
*             TUP(9) = ADDR(TU(9));                             02S0795
         LA    @14,TU+112                                       02S0795
         ST    @14,TUP+32                                       02S0795
*             TUP(9)->S99TUKEY = DALRLSE;                       02S0796
         MVC   S99TUKEY(2,@14),@CB00915                         02S0796
*             TUP(9)->S99TUNUM = 0;                             02S0797
         SLR   @08,@08                                          02S0797
         STCM  @08,3,S99TUNUM(@14)                              02S0797
*             TUP(9)->S99TULNG = 0;                             02S0798
         STCM  @08,3,S99TULNG(@14)                              02S0798
*           END;                                                02S0799
*        IF DA30BLK(2:4) ^= 0                                   02S0800
*          & DA30ATRL = OFF THEN                                02S0800
*                                                               02S0800
@RF00793 ICM   @14,7,DA30BLK+1(BLOCKPTR)                        02S0800
         BZ    @RF00800                                         02S0800
         TM    DA30ATRL(BLOCKPTR),B'00000010'                   02S0800
         BNZ   @RF00800                                         02S0800
*             DO;                                               02S0801
*               TUP(10) = ADDR(TU(10));                         02S0802
         LA    @14,TU+126                                       02S0802
         ST    @14,TUP+36                                       02S0802
*               TUP(10)->S99TUKEY = DALBLKSZ;                   02S0803
         MVC   S99TUKEY(2,@14),@CB00210                         02S0803
*               TUP(10)->S99TUNUM = 1;                          02S0804
         MVC   S99TUNUM(2,@14),@CH00035                         02S0804
*               TUP(10)->S99TULNG = 2;                          02S0805
         MVC   S99TULNG(2,@14),@CH00062                         02S0805
*               TUP(10)->S99TUPAR(1:2) = DA30BLK(3:4);          02S0806
         MVC   S99TUPAR(2,@14),DA30BLK+2(BLOCKPTR)              02S0806
*             END;                                              02S0807
*      END;                            /* END PROCESSING SPACE DATA  */
*                                                               02S0808
@RF00800 DS    0H                                               02S0809
*     IF DA30PERM^='0'B THEN                                    02S0809
@RF00752 TM    DA30PERM(BLOCKPTR),B'00001000'                   02S0809
         BZ    @RF00809                                         02S0809
*       DO;                                                     02S0810
*         TUP(11) = ADDR(TU(11));                               02S0811
         LA    @14,TU+140                                       02S0811
         ST    @14,TUP+40                                       02S0811
*         TUP(11)->S99TUKEY = DALPERMA;                         02S0812
         MVC   S99TUKEY(2,@14),@CB01043                         02S0812
*         TUP(11)->S99TUNUM = 0;                                02S0813
         SLR   @08,@08                                          02S0813
         STCM  @08,3,S99TUNUM(@14)                              02S0813
*         TUP(11)->S99TULNG = 0;                                02S0814
         STCM  @08,3,S99TULNG(@14)                              02S0814
*       END;                                                    02S0815
*                                                               02S0815
*     IF DA30DMMY^='0'B THEN                                    02S0816
@RF00809 TM    DA30DMMY(BLOCKPTR),B'00000100'                   02S0816
         BZ    @RF00816                                         02S0816
*       DO;                                                     02S0817
*         TUP(12) = ADDR(TU(12));                               02S0818
         LA    @14,TU+154                                       02S0818
         ST    @14,TUP+44                                       02S0818
*         TUP(12)->S99TUKEY = DALDUMMY;                         02S0819
         MVC   S99TUKEY(2,@14),@CB00171                         02S0819
*         TUP(12)->S99TUNUM = 0;                                02S0820
         SLR   @08,@08                                          02S0820
         STCM  @08,3,S99TUNUM(@14)                              02S0820
*         TUP(12)->S99TULNG = 0;                                02S0821
         STCM  @08,3,S99TULNG(@14)                              02S0821
*       END;                                                    02S0822
*                                                               02S0822
*     IF DA30PGNM^=' ' THEN                                     02S0823
@RF00816 CLI   DA30PGNM(BLOCKPTR),C' '                          02S0823
         BE    @RF00823                                         02S0823
*       DO;                                                     02S0824
*         TUP(13) = ADDR(TU(13));                               02S0825
         LA    @14,TU+168                                       02S0825
         ST    @14,TUP+48                                       02S0825
*         TUP(13)->S99TUKEY = DALSPGNM;                         02S0826
         MVC   S99TUKEY(2,@14),@CB00936                         02S0826
*         TUP(13)->S99TUNUM = 1;                                02S0827
         MVC   S99TUNUM(2,@14),@CH00035                         02S0827
*         TUP(13)->S99TULNG = LENGTH(DA30PGNM);                 02S0828
         MVC   S99TULNG(2,@14),@CH00048                         02S0828
*         TUP(13)->S99TUPAR(1:LENGTH(DA30PGNM)) = DA30PGNM;     02S0829
         MVC   S99TUPAR(8,@14),DA30PGNM(BLOCKPTR)               02S0829
*       END;                                                    02S0830
*                                                               02S0830
*     IF DA30FORM^=' ' THEN                                     02S0831
@RF00823 CLI   DA30FORM(BLOCKPTR),C' '                          02S0831
         BE    @RF00831                                         02S0831
*       DO;                                                     02S0832
*         TUP(14) = ADDR(TU(14));                               02S0833
         LA    @14,TU+182                                       02S0833
         ST    @14,TUP+52                                       02S0833
*         TUP(14)->S99TUKEY = DALSFMNO;                         02S0834
         MVC   S99TUKEY(2,@14),@CB00938                         02S0834
*         TUP(14)->S99TUNUM = 1;                                02S0835
         MVC   S99TUNUM(2,@14),@CH00035                         02S0835
*         TUP(14)->S99TULNG = LENGTH(DA30FORM);                 02S0836
         MVC   S99TULNG(2,@14),@CH00059                         02S0836
*         TUP(14)->S99TUPAR(1:LENGTH(DA30FORM)) = DA30FORM;     02S0837
         MVC   S99TUPAR(4,@14),DA30FORM(BLOCKPTR)               02S0837
*       END;                                                    02S0838
*                                                               02S0838
*       DO;                                                     02S0839
@RF00831 DS    0H                                               02S0840
*         TUP(15) = ADDR(TU(15));                               02S0840
         LA    @14,TU+196                                       02S0840
         ST    @14,TUP+56                                       02S0840
*         TUP(15)->S99TUKEY = DALSYSOU;                         02S0841
         MVC   S99TUKEY(2,@14),@CB00165                         02S0841
*         TUP(15)->S99TUNUM = 0;                                02S0842
         SLR   @08,@08                                          02S0842
         STCM  @08,3,S99TUNUM(@14)                              02S0842
*         TUP(15)->S99TULNG = 0;                                02S0843
         STCM  @08,3,S99TULNG(@14)                              02S0843
*       END;                                                    02S0844
*                                                               02S0844
*     TUP(15) = TUP(15) × '80000000'X;                          02S0845
         O     @14,@CF01105                                     02S0845
         ST    @14,TUP+56                                       02S0845
*    R1 = ADDR(S99RBPTR);              /* GET PARM PTR ADDRESS       */
*                                                               02S0846
         LA    R1,S99RBPTR                                      02S0846
*     /*MACDATE Y-2 73082*/                                     02S0847
*     SVC (99);                                                 02S0847
         SVC   99                                               02S0847
*    RESPECIFY R15 RESTRICTED;                                  02S0848
*    IF R15 = 0 THEN                   /* WAS ALLOCATION SUCCESSFUL  */
         SLR   @14,@14                                          02S0849
         CR    R15,@14                                          02S0849
         BNE   @RF00849                                         02S0849
*      DO;                             /* YES, RETURN DATA           */
*        IF TUP(1) ^= 0 THEN           /* RETURN DSN REQUEST PRESENT?*/
         L     @08,TUP                                          02S0851
         CR    @08,@14                                          02S0851
         BE    @RF00851                                         02S0851
*          DO;                         /* YES, RETURN DSNAME         */
*            DA30PDSN -> DSNL = TUP(1) -> S99TULNG; /* RETURN DSN LEN*/
         L     @14,DA30PDSN(,BLOCKPTR)                          02S0853
         ICM   @04,12,S99TULNG(@08)                             02S0853
         SRA   @04,16                                           02S0853
         STH   @04,DSNL(,@14)                                   02S0853
*            DA30PDSN -> DSN (1:DA30PDSN -> DSNL) =             02S0854
*             TUP(1) -> S99TUPAR(1:DA30PDSN -> DSNL);           02S0854
         BCTR  @04,0                                            02S0854
         EX    @04,@SM01199                                     02S0854
*          END;                        /* END RETURN DSNAME          */
*        DA30DDN = TUP(2) -> S99TUPAR(1:8); /* RETURN DDNAME         */
@RF00851 L     @14,TUP+4                                        02S0856
         MVC   DA30DDN(8,BLOCKPTR),S99TUPAR(@14)                02S0856
*      END;                            /* END RETURN OF DATA         */
*    ELSE                              /* ALLOCATION NOT SUCCESSFUL  */
*      DO;                             /* EXAMINE DYN/ALLOC RTRN CODE*/
         B     @RC00849                                         02S0858
@RF00849 DS    0H                                               02S0859
*        IF R15 = 8 THEN               /* REQUEST DENIED ?           */
         C     R15,@CF00048                                     02S0859
         BNE   @RF00859                                         02S0859
*          RETCODE = DRREQDEN;         /* SET RETCODE TO 52          */
         LA    RETCODE,52                                       02S0860
*        IF R15 = 12 THEN              /* INVALID DYN/ALLOC PARMS ?  */
@RF00859 C     R15,@CF00034                                     02S0861
         BNE   @RF00861                                         02S0861
*          DO;                         /* EXAMINE S99ERROR CODES     */
*            IF S99ERROR = RCINPARM THEN /*INVALID PARM IN TEXT UNIT?*/
         CLC   S99ERROR(2),@CB00248                             02S0863
         BNE   @RF00863                                         02S0863
*              DO;                     /* YES, EXAMINE S99INFO CODE  */
*                IF S99INFO = DALDDNAM THEN /* INVALID DDNAME ?      */
         CLC   S99INFO(2),@CB00894                              02S0865
         BNE   @RF00865                                         02S0865
*                  DA30DARC = DRDDNINV; /* SET DARC TO DRDDNINV      */
         MVC   DA30DARC(2,BLOCKPTR),@CH00185                    02S0866
*                IF S99INFO = DALSPGNM THEN /* INVALID PROGRAM NAME ?*/
@RF00865 CLC   S99INFO(2),@CB00936                              02S0867
         BNE   @RF00867                                         02S0867
*                  DA30DARC = DRSYSPGM; /* SET DARC TO DRSYSPGM      */
         MVC   DA30DARC(2,BLOCKPTR),@CH00191                    02S0868
*                IF S99INFO = DALSFMNO THEN /* INVALID FORM NUMBER ? */
@RF00867 CLC   S99INFO(2),@CB00938                              02S0869
         BNE   @RF00869                                         02S0869
*                  DA30DARC = DRSYSFRM; /* SET DARC TO DRSYSFRM      */
         MVC   DA30DARC(2,BLOCKPTR),@CH00193                    02S0870
*              END;                    /* END S99INFO TESTS          */
*            ELSE;                     /* NOT INVALID PARM IN TEXT   */
@RF00863 DS    0H                                               02S0873
*              IF DA30DARC = ZERO THEN /* WAS ERROR DETERMINED ?     */
@RC00863 LH    @14,DA30DARC(,BLOCKPTR)                          02S0873
         LTR   @14,@14                                          02S0873
         BNZ   @RF00873                                         02S0873
*                DA30DARC = S99ERROR;  /* STORE S99ERROR CODE        */
         LH    @14,S99ERROR                                     02S0874
         N     @14,@CF01193                                     02S0874
         STH   @14,DA30DARC(,BLOCKPTR)                          02S0874
*            RETCODE = DRDYNERR;       /* SET DYN/ALLOC RETURN CODE  */
@RF00873 LA    RETCODE,12                                       02S0875
*          END;                        /* END PROCESSING INVALID PARM*/
*        IF R15 = 4 THEN               /* ENVIRONMENTAL ERROR ?      */
@RF00861 C     R15,@CF00059                                     02S0877
         BNE   @RF00877                                         02S0877
*          DO;                         /* YES, DETERMINE TYPE        */
*            IF S99ERROR = RCDDUNAV THEN /* DDNAME UNAVAILABLE ?     */
         CLC   S99ERROR(2),@CB00280                             02S0879
         BNE   @RF00879                                         02S0879
*              RETCODE = DRDDUNAV;     /* SET RETCODE TO 20          */
         LA    RETCODE,20                                       02S0880
*            IF S99ERROR = RCNTUNLC    /* CAN'T UNALLOC TO CONTROL #?*/
*              × S99ERROR = RCLIMITS THEN /*WOULD REQUEST EXCEED 1635*/
@RF00879 CLC   S99ERROR(2),@CB00290                             02S0881
         BE    @RT00881                                         02S0881
         CLC   S99ERROR(2),@CB00300                             02S0881
         BNE   @RF00881                                         02S0881
@RT00881 DS    0H                                               02S0882
*              RETCODE = 16;           /* SET RETCODE TO 16          */
         LA    RETCODE,16                                       02S0882
*            IF S99ERROR = RCDCBRNF THEN /* DCB REFERBACK NOT FOUND ?*/
@RF00881 CLC   S99ERROR(2),@CB00302                             02S0883
         BNE   @RF00883                                         02S0883
*              RETCODE = 28;           /* SET RETCODE TO 28          */
         LA    RETCODE,28                                       02S0884
*            IF RETCODE = 0 THEN       /* UNDETERMINED ERROR ?       */
@RF00883 LTR   RETCODE,RETCODE                                  02S0885
         BNZ   @RF00885                                         02S0885
*              DO;                     /* YES                        */
*                DA30DARC = S99ERROR;  /* STORE S99ERROR DATA IN DARC*/
         LH    @14,S99ERROR                                     02S0887
         N     @14,@CF01193                                     02S0887
         STH   @14,DA30DARC(,BLOCKPTR)                          02S0887
*                RETCODE = DRDYNERR;   /* SET RETCODE TO 12          */
         LA    RETCODE,12                                       02S0888
*              END;                    /* END UNDETERMINED ERROR     */
*          END;                        /* END ENVIRONMENTAL ERROR    */
@RF00885 DS    0H                                               02S0891
*      END;                            /* END DYN/ALLOC ERROR PROCESS*/
@RF00877 DS    0H                                               02S0892
*  END;                                /* END VALID PARM LIST PROCESS*/
@RC00849 DS    0H                                               02S0893
*        END;                          /* END CODE 30                */
@RC00709 DS    0H                                               01S0894
*      IF BLOCKPTR->DAIRCODE='0034'X THEN /* IS DAIR CODE 34         */
@RF00707 CLC   DAIRCODE(2,BLOCKPTR),@CB00177                    01S0894
         BNE   @RF00894                                         01S0894
*        DO;                           /* YES, EXECUTE CODE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT - DAIR34                                                 */
*/*                                                                  */
*/* DESCRIPTIVE NAME - DAIR CODE 34 PROCESSOR                        */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN A DAIR34 PARM BLOCK      */
*/*            IS PASSED TO IEFDB4D0(DAIR).  DAIR34 IS INVOKED       */
*/*            IN ORDER TO ALLOCATE A DUMMY DATA SET USING THE       */
*/*            SUPPLIED DCB PARAMETERS AND DDNAME.  THE PURPOSE OF   */
*/*            ALLOCATING A DUMMY DD WITH DCB PARMS IS TO PROVIDE    */
*/*            AN OBJECT FOR A DCB REFERBACK.  DAIR34 IS ALSO        */
*/*            INVOKED TO SEARCH FOR A DDNAME OR DELETE A DD ENTRY.  */
*/*                                                                  */
*/* OPERATION - IF THE FIRST BYTE OF THE DA34NAME FIELD CONTAINS     */
*/*             BLANK OR ZERO, RETCODE IS SET TO 4 (INVALID          */
*/*             PARAMETER LIST) AND NO FURTHER PROCESSING IS DONE.   */
*/*                                                                  */
*/*             IF THE DA34SRCH BIT IN THE DA34CTRL FIELD IS ON,     */
*/*             THE DYNAMIC ALLOCATION VERB CODE IS SET TO           */
*/*             INFORMATION RETRIEVAL.  TEXT UNITS ARE BUILT TO      */
*/*             SEARCH BY DDNAME(THE DA34NAME FIELD).  DYNAMIC       */
*/*             ALLOCATION IS INVOKED.  THE RETURN CODE(IN REG 15)   */
*/*             IS TESTED TO DETERMINE IF THE DDNAME WAS FOUND.      */
*/*             IF FOUND, THE DA34FIND BIT IS TURNED ON.             */
*/*             IF REG 15 IS NON-ZERO, DA34FIND BIT IS SET TO OFF (0)*/
*/*             IF REG 15 IS 8, RETCODE IS SET                       */
*/*             TO 52(REQUEST DENIED BY INSTALLATION EXIT).          */
*/*                                                                  */
*/*             IF THE DA34CHN BIT IN THE DA34CTRL FIELD IS ON,      */
*/*             THE DYNAMIC ALLOCATION VERB CODE IS SET TO           */
*/*             ALLOCATION.  TEXT UNITS ARE BUILT TO ALLOCATE A      */
*/*             DUMMY DATA SET USING THE SUPPLIED DCB PARAMETERS     */
*/*             AND DDNAME.  DYNAMIC ALLOCATION IS INVOKED.  THE     */
*/*             RETURN CODE(IN REG 15) IS TESTED FOR NON-ZERO        */
*/*             (FAILURE).  IF NON-ZERO RETURN CODE, THE S99ERROR    */
*/*             CODE IS TESTED FOR RCDDUNAV. IF S99ERROR WAS RCDDUNAV*/
*/*             RETCODE IS SET TO 20(DDNAME REQUESTED IS UNAVAILABLE)*/
*/*             IF S99ERROR WAS NOT RCDDUNAV, THE RETURN CODE IS     */
*/*             TESTED FOR 8 AND IF 8, RETCODE IS SET TO 52(REQUEST  */
*/*             DENIED BY INSTALLATION EXIT).  IF THE RETURN CODE    */
*/*             WAS NOT 8, THE S99ERROR IS TESTED FOR INVALID        */
*/*             PARAMETER LIST(S99ERROR = RCINPARM).  IF THE ERROR   */
*/*             WAS INVALID PARAMETER LIST, THE S99INFO CODE         */
*/*             IS EXAMINED TO DETERMINE IF THE FAILING KEY WAS      */
*/*             THE DDNAME KEY, IF SO THE DA34DARC IS SET TO         */
*/*             DRDDNINV (INVALID DDNAME) AND THE RETCODE IS SET     */
*/*             TO 12.  IF NONE OF THE ABOVE ERRORS, THE S99ERROR    */
*/*             CODE IS STORED INTO THE DA34DARC FIELD AND           */
*/*             RETCODE IS SET TO 12(DYNAMIC ALLOCATION ERROR).      */
*/*                                                                  */
*/*             IF THE DA34UNCH BIT IN THE DA34CTRL FIELD IS ON,     */
*/*             THE DYNAMIC ALLOCATION VERB CODE IS SET TO           */
*/*             UNALLOCATION.  TEXT UNITS ARE BUILT TO UNALLOCATE    */
*/*             BY DDNAME.  DYNAMIC ALLOCATION IS INVOKED.  THE      */
*/*             RETURN CODE(IN REG 15) IS TESTED FOR NON-ZERO        */
*/*             (FAILURE).  IF NON-ZERO, THE RETURN CODE IS TESTED   */
*/*             FOR 8(REQUEST DENIED BY INSTALLATION EXIT) AND IF    */
*/*             FOUND, RETCODE IS SET TO 52.  OTHERWISE, RETCODE     */
*/*             IS SET TO 28(DDNAME NOT FOUND).                      */
*/*                                                                  */
*/*             IF NONE OF THE FUNCTION BITS IN THE DA34CTRL FIELD   */
*/*             ARE ON, RETCODE IS SET TO 4(INVALID PARAMETER LIST). */
*/*                                                                  */
*/* ENTRY - DAIR34(INCLUDED SEGMENT)                                 */
*/*                                                                  */
*/* INPUT DATA - DAIR34 PARM BLOCK, SVC99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL -                                                        */
*/*   OUTPUT - DA34FIND BIT SET FOR SEARCH FUNCTION                  */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 0 SUCCESSFUL                           */
*/*                                                                  */
*/*  ERROR                                                           */
*/*   OUTPUT - DA34DARC(SEE OPERATION TEXT)                          */
*/*                                                                  */
*/*   RETURN CODE - RETCODE = 4 INVALID PARAMETER LIST               */
*/*                          12 DYNAMIC ALLOCATION ERROR             */
*/*                          52 REQUEST DENIED BY INSTALLATION EXIT  */
*/*                                                                  */
*/********************************************************************/
*IF DA34NAME(1) = ' ' × DA34NAME(1) = '00'X THEN /* VALID LIST NAME ?*/
         CLI   DA34NAME(BLOCKPTR),C' '                          02S0896
         BE    @RT00896                                         02S0896
         CLI   DA34NAME(BLOCKPTR),X'00'                         02S0896
         BNE   @RF00896                                         02S0896
@RT00896 DS    0H                                               02S0897
*  RETCODE = DRINVLST;                 /* NO, INDICATE INVALID LIST  */
         LA    RETCODE,4                                        02S0897
*ELSE                                  /* LIST NAME PRESENT          */
*  DO;                                 /* PROCESS LIST               */
         B     @RC00896                                         02S0898
@RF00896 DS    0H                                               02S0899
*    IF DA34SRCH = ON THEN             /* SEARCH FOR DDNAME ?        */
         TM    DA34SRCH(BLOCKPTR),B'10000000'                   02S0899
         BNO   @RF00899                                         02S0899
*      DO;                             /* YES                        */
*        S99VERB = S99VRBIN;           /* SET VERB TO INFO RETRIEVAL */
*                                                               02S0901
*                                                               02S0901
         MVI   S99VERB,X'07'                                    02S0901
*           DO;                                                 02S0902
*             TUP(1) = ADDR(TU(1));                             02S0903
         LA    @14,TU                                           02S0903
         ST    @14,TUP                                          02S0903
*             TUP(1)->S99TUKEY = DINDDNAM;                      02S0904
         MVC   S99TUKEY(2,@14),@CB00894                         02S0904
*             TUP(1)->S99TUNUM = 1;                             02S0905
         MVC   S99TUNUM(2,@14),@CH00035                         02S0905
*             TUP(1)->S99TULNG = LENGTH(DA34NAME);              02S0906
         MVC   S99TULNG(2,@14),@CH00048                         02S0906
*             TUP(1)->S99TUPAR(1:LENGTH(DA34NAME)) = DA34NAME;  02S0907
         MVC   S99TUPAR(8,@14),DA34NAME(BLOCKPTR)               02S0907
*           END;                                                02S0908
*                                                               02S0908
*         TUP(1) = TUP(1) × '80000000'X;                        02S0909
         O     @14,@CF01105                                     02S0909
         ST    @14,TUP                                          02S0909
*        R1 = ADDR(S99RBPTR);          /* GET PARM PTR ADDRESS       */
*                                                               02S0910
         LA    R1,S99RBPTR                                      02S0910
*         /*MACDATE Y-2 73082*/                                 02S0911
*         SVC (99);                                             02S0911
         SVC   99                                               02S0911
*        RESPECIFY R15 RESTRICTED;     /* RESTRICT REG 15 USAGE      */
*        IF R15 = 0 THEN               /* WAS DDNAME FOUND ?         */
         LTR   R15,R15                                          02S0913
         BNZ   @RF00913                                         02S0913
*          DA34FIND = ON;              /* YES, INDICATE DDNAME FOUND */
         OI    DA34FIND(BLOCKPTR),B'10000000'                   02S0914
*        ELSE                          /* ERROR ENCOUNTERED          */
*          DA34FIND = OFF;             /* INDICATE NOT FOUND         */
         B     @RC00913                                         02S0915
@RF00913 NI    DA34FIND(BLOCKPTR),B'01111111'                   02S0915
*        IF R15 = 8 THEN               /* REQUEST DENIED ?           */
@RC00913 C     R15,@CF00048                                     02S0916
         BNE   @RF00916                                         02S0916
*          RETCODE = DRREQDEN;         /* INDICATE REQUEST DENIED
*                                         BY INSTALLATION EXIT       */
         LA    RETCODE,52                                       02S0917
*      END;                            /* END DDNAME SEARCH          */
*    ELSE                              /* NOT DDNAME SEARCH          */
*      IF DA34CHN = ON THEN            /* ADD NEW DDNAME ?           */
         B     @RC00899                                         02S0919
@RF00899 TM    DA34CHN(BLOCKPTR),B'01000000'                    02S0919
         BNO   @RF00919                                         02S0919
*        DO;                           /* BUILD TEXT UNITS           */
*          S99VERB = S99VRBAL;         /* SET VERB CODE TO ALLOCATE  */
*                                                               02S0921
*                                                               02S0921
         MVI   S99VERB,X'01'                                    02S0921
*             DO;                                               02S0922
*               TUP(1) = ADDR(TU(1));                           02S0923
         LA    @14,TU                                           02S0923
         ST    @14,TUP                                          02S0923
*               TUP(1)->S99TUKEY = DALDDNAM;                    02S0924
         MVC   S99TUKEY(2,@14),@CB00894                         02S0924
*               TUP(1)->S99TUNUM = 1;                           02S0925
         LA    @08,1                                            02S0925
         STCM  @08,3,S99TUNUM(@14)                              02S0925
*               TUP(1)->S99TULNG = LENGTH(DA34NAME);            02S0926
         MVC   S99TULNG(2,@14),@CH00048                         02S0926
*               TUP(1)->S99TUPAR(1:LENGTH(DA34NAME)) = DA34NAME;
         MVC   S99TUPAR(8,@14),DA34NAME(BLOCKPTR)               02S0927
*             END;                                              02S0928
*                                                               02S0928
*             DO;                                               02S0929
*               TUP(2) = ADDR(TU(2));                           02S0930
         LA    @14,TU+14                                        02S0930
         ST    @14,TUP+4                                        02S0930
*               TUP(2)->S99TUKEY = DALDUMMY;                    02S0931
         MVC   S99TUKEY(2,@14),@CB00171                         02S0931
*               TUP(2)->S99TUNUM = 0;                           02S0932
         SLR   @04,@04                                          02S0932
         STCM  @04,3,S99TUNUM(@14)                              02S0932
*               TUP(2)->S99TULNG = 0;                           02S0933
         STCM  @04,3,S99TULNG(@14)                              02S0933
*             END;                                              02S0934
*                                                               02S0934
*             DO;                                               02S0935
*               TUP(3) = ADDR(TU(3));                           02S0936
         LA    @14,TU+28                                        02S0936
         ST    @14,TUP+8                                        02S0936
*               TUP(3)->S99TUKEY = DALPERMA;                    02S0937
         MVC   S99TUKEY(2,@14),@CB01043                         02S0937
*               TUP(3)->S99TUNUM = 0;                           02S0938
         STCM  @04,3,S99TUNUM(@14)                              02S0938
*               TUP(3)->S99TULNG = 0;                           02S0939
         STCM  @04,3,S99TULNG(@14)                              02S0939
*             END;                                              02S0940
*                                                               02S0940
*           IF DAILABEL^=ZERO THEN                              02S0941
         L     @14,DA34ADDR(,BLOCKPTR)                          02S0941
         CLI   DAILABEL(@14),0                                  02S0941
         BE    @RF00941                                         02S0941
*             DO;                                               02S0942
*               TUP(4) = ADDR(TU(4));                           02S0943
         LA    @04,TU+42                                        02S0943
         ST    @04,TUP+12                                       02S0943
*               TUP(4)->S99TUKEY = DALINOUT;                    02S0944
         MVC   S99TUKEY(2,@04),@CB00950                         02S0944
*               TUP(4)->S99TUNUM = 1;                           02S0945
         STCM  @08,3,S99TUNUM(@04)                              02S0945
*               TUP(4)->S99TULNG = LENGTH(DAILABEL);            02S0946
         STCM  @08,3,S99TULNG(@04)                              02S0946
*               TUP(4)->S99TUPAR(1:LENGTH(DAILABEL)) = DAILABEL;
         MVC   S99TUPAR(1,@04),DAILABEL(@14)                    02S0947
*             END;                                              02S0948
*          IF DAIEXPDT ^= ZERO THEN    /* EXPIRATION DATE PRESENT ?  */
@RF00941 L     @14,DA34ADDR(,BLOCKPTR)                          02S0949
         ICM   @08,7,DAIEXPDT(@14)                              02S0949
         BZ    @RF00949                                         02S0949
*            DO;                       /* YES, CONVERT TO USABLE FORM*/
*              CVD (DAIYEAR,TEMPAREA(1:2)); /* CONVERT TO DECIMAL    */
         SLR   @08,@08                                          02S0951
         IC    @08,DAIYEAR(,@14)                                02S0951
         CVD   @08,@TS00001                                     02S0951
         MVC   TEMPAREA(2),@TS00001+6                           02S0951
*              TEMPAREA(2) = TEMPAREA(2) × '0F'X;               02S0952
         OI    TEMPAREA+1,X'0F'                                 02S0952
*              UNPK (YY,TEMPAREA(1:2)); /* UNPACK TO EBCDIC          */
         UNPK  YY(2),TEMPAREA(2)                                02S0953
*              CVD (DAIDAY,TEMPAREA);  /* CONVERT TO DECIMAL         */
         LH    @14,DAIDAY(,@14)                                 02S0954
         CVD   @14,@TS00001                                     02S0954
         MVC   TEMPAREA(3),@TS00001+5                           02S0954
*              TEMPAREA(3) = TEMPAREA(3) × '0F'X;               02S0955
         OI    TEMPAREA+2,X'0F'                                 02S0955
*              UNPK (DDD,TEMPAREA);    /* UNPACK TO EBCDIC           */
*                                                               02S0956
         UNPK  DDD(3),TEMPAREA(3)                               02S0956
*                 DO;                                           02S0957
*                   TUP(5) = ADDR(TUEXPDT);                     02S0958
         LA    @14,TUEXPDT                                      02S0958
         ST    @14,TUP+16                                       02S0958
*                   TUP(5)->S99TUKEY = DALEXPDT;                02S0959
         MVC   S99TUKEY(2,@14),@CB00952                         02S0959
*                   TUP(5)->S99TUNUM = 1;                       02S0960
         MVC   S99TUNUM(2,@14),@CH00035                         02S0960
*                   TUP(5)->S99TULNG = LENGTH(EXPDTPAR);        02S0961
         MVC   S99TULNG(2,@14),@CH01104                         02S0961
*                   TUP(5)->S99TUPAR(1:LENGTH(EXPDTPAR)) = EXPDTPAR;
         MVC   S99TUPAR(5,@14),EXPDTPAR                         02S0962
*                 END;                                          02S0963
*            END;                      /* END PROCESSING EXPIRATION  */
*                                                               02S0964
*           IF DAIBUFNO^=ZERO THEN                              02S0965
@RF00949 L     @14,DA34ADDR(,BLOCKPTR)                          02S0965
         CLI   DAIBUFNO(@14),0                                  02S0965
         BE    @RF00965                                         02S0965
*             DO;                                               02S0966
*               TUP(6) = ADDR(TU(6));                           02S0967
         LA    @08,TU+70                                        02S0967
         ST    @08,TUP+20                                       02S0967
*               TUP(6)->S99TUKEY = DALBUFNO;                    02S0968
         MVC   S99TUKEY(2,@08),@CB00177                         02S0968
*               TUP(6)->S99TUNUM = 1;                           02S0969
         LA    @04,1                                            02S0969
         STCM  @04,3,S99TUNUM(@08)                              02S0969
*               TUP(6)->S99TULNG = LENGTH(DAIBUFNO);            02S0970
         STCM  @04,3,S99TULNG(@08)                              02S0970
*               TUP(6)->S99TUPAR(1:LENGTH(DAIBUFNO)) = DAIBUFNO;
         MVC   S99TUPAR(1,@08),DAIBUFNO(@14)                    02S0971
*             END;                                              02S0972
*          WORK = DAIBFTEK & 'FC'X;    /* CLEAR BFALN BITS           */
*                                                               02S0973
@RF00965 L     @14,DA34ADDR(,BLOCKPTR)                          02S0973
         MVC   WORK(1),DAIBFTEK(@14)                            02S0973
         NI    WORK,X'FC'                                       02S0973
*           IF WORK^=ZERO THEN                                  02S0974
         CLI   WORK,0                                           02S0974
         BE    @RF00974                                         02S0974
*             DO;                                               02S0975
*               TUP(7) = ADDR(TU(7));                           02S0976
         LA    @14,TU+84                                        02S0976
         ST    @14,TUP+24                                       02S0976
*               TUP(7)->S99TUKEY = DALBFTEK;                    02S0977
         MVC   S99TUKEY(2,@14),@CB00975                         02S0977
*               TUP(7)->S99TUNUM = 1;                           02S0978
         LA    @08,1                                            02S0978
         STCM  @08,3,S99TUNUM(@14)                              02S0978
*               TUP(7)->S99TULNG = LENGTH(WORK);                02S0979
         STCM  @08,3,S99TULNG(@14)                              02S0979
*               TUP(7)->S99TUPAR(1:LENGTH(WORK)) = WORK;        02S0980
         MVC   S99TUPAR(1,@14),WORK                             02S0980
*             END;                                              02S0981
*          WORK = DAIBFTEK & '03'X;    /* CLEAR BFTEK BITS           */
*                                                               02S0982
@RF00974 L     @14,DA34ADDR(,BLOCKPTR)                          02S0982
         MVC   WORK(1),DAIBFTEK(@14)                            02S0982
         NI    WORK,X'03'                                       02S0982
*           IF WORK^=ZERO THEN                                  02S0983
         CLI   WORK,0                                           02S0983
         BE    @RF00983                                         02S0983
*             DO;                                               02S0984
*               TUP(8) = ADDR(TU(8));                           02S0985
         LA    @14,TU+98                                        02S0985
         ST    @14,TUP+28                                       02S0985
*               TUP(8)->S99TUKEY = DALBFALN;                    02S0986
         MVC   S99TUKEY(2,@14),@CB00973                         02S0986
*               TUP(8)->S99TUNUM = 1;                           02S0987
         LA    @08,1                                            02S0987
         STCM  @08,3,S99TUNUM(@14)                              02S0987
*               TUP(8)->S99TULNG = LENGTH(WORK);                02S0988
         STCM  @08,3,S99TULNG(@14)                              02S0988
*               TUP(8)->S99TUPAR(1:LENGTH(WORK)) = WORK;        02S0989
         MVC   S99TUPAR(1,@14),WORK                             02S0989
*             END;                                              02S0990
*                                                               02S0990
*           IF DAIBUFL^=ZERO THEN                               02S0991
@RF00983 L     @14,DA34ADDR(,BLOCKPTR)                          02S0991
         LH    @14,DAIBUFL(,@14)                                02S0991
         LTR   @14,@14                                          02S0991
         BZ    @RF00991                                         02S0991
*             DO;                                               02S0992
*               TUP(9) = ADDR(TU(9));                           02S0993
         LA    @08,TU+112                                       02S0993
         ST    @08,TUP+32                                       02S0993
*               TUP(9)->S99TUKEY = DALBUFL;                     02S0994
         MVC   S99TUKEY(2,@08),@CB00980                         02S0994
*               TUP(9)->S99TUNUM = 1;                           02S0995
         MVC   S99TUNUM(2,@08),@CH00035                         02S0995
*               TUP(9)->S99TULNG = LENGTH(DAIBUFL);             02S0996
         MVC   S99TULNG(2,@08),@CH00062                         02S0996
*               TUP(9)->S99TUPAR(1:LENGTH(DAIBUFL)) = DAIBUFL;  02S0997
         STCM  @14,3,S99TUPAR(@08)                              02S0997
*             END;                                              02S0998
*                                                               02S0998
*           IF DAIEROPT^=ZERO THEN                              02S0999
@RF00991 L     @14,DA34ADDR(,BLOCKPTR)                          02S0999
         CLI   DAIEROPT(@14),0                                  02S0999
         BE    @RF00999                                         02S0999
*             DO;                                               02S1000
*               TUP(10) = ADDR(TU(10));                         02S1001
         LA    @08,TU+126                                       02S1001
         ST    @08,TUP+36                                       02S1001
*               TUP(10)->S99TUKEY = DALEROPT;                   02S1002
         MVC   S99TUKEY(2,@08),@CB01001                         02S1002
*               TUP(10)->S99TUNUM = 1;                          02S1003
         LA    @04,1                                            02S1003
         STCM  @04,3,S99TUNUM(@08)                              02S1003
*               TUP(10)->S99TULNG = LENGTH(DAIEROPT);           02S1004
         STCM  @04,3,S99TULNG(@08)                              02S1004
*               TUP(10)->S99TUPAR(1:LENGTH(DAIEROPT)) = DAIEROPT;
         MVC   S99TUPAR(1,@08),DAIEROPT(@14)                    02S1005
*             END;                                              02S1006
*                                                               02S1006
*           IF DAIKEYLE^=ZERO THEN                              02S1007
@RF00999 L     @14,DA34ADDR(,BLOCKPTR)                          02S1007
         CLI   DAIKEYLE(@14),0                                  02S1007
         BE    @RF01007                                         02S1007
*             DO;                                               02S1008
*               TUP(11) = ADDR(TU(11));                         02S1009
         LA    @08,TU+140                                       02S1009
         ST    @08,TUP+40                                       02S1009
*               TUP(11)->S99TUKEY = DALKYLEN;                   02S1010
         MVC   S99TUKEY(2,@08),@CB01007                         02S1010
*               TUP(11)->S99TUNUM = 1;                          02S1011
         LA    @04,1                                            02S1011
         STCM  @04,3,S99TUNUM(@08)                              02S1011
*               TUP(11)->S99TULNG = LENGTH(DAIKEYLE);           02S1012
         STCM  @04,3,S99TULNG(@08)                              02S1012
*               TUP(11)->S99TUPAR(1:LENGTH(DAIKEYLE)) = DAIKEYLE;
         MVC   S99TUPAR(1,@08),DAIKEYLE(@14)                    02S1013
*             END;                                              02S1014
*                                                               02S1014
*           IF DAIRECFM^=ZERO THEN                              02S1015
@RF01007 L     @14,DA34ADDR(,BLOCKPTR)                          02S1015
         CLI   DAIRECFM(@14),0                                  02S1015
         BE    @RF01015                                         02S1015
*             DO;                                               02S1016
*               TUP(12) = ADDR(TU(12));                         02S1017
         LA    @08,TU+154                                       02S1017
         ST    @08,TUP+44                                       02S1017
*               TUP(12)->S99TUKEY = DALRECFM;                   02S1018
         MVC   S99TUKEY(2,@08),@CB01025                         02S1018
*               TUP(12)->S99TUNUM = 1;                          02S1019
         LA    @04,1                                            02S1019
         STCM  @04,3,S99TUNUM(@08)                              02S1019
*               TUP(12)->S99TULNG = LENGTH(DAIRECFM);           02S1020
         STCM  @04,3,S99TULNG(@08)                              02S1020
*               TUP(12)->S99TUPAR(1:LENGTH(DAIRECFM)) = DAIRECFM;
         MVC   S99TUPAR(1,@08),DAIRECFM(@14)                    02S1021
*             END;                                              02S1022
*                                                               02S1022
*           IF DAIOPTCD^=ZERO THEN                              02S1023
@RF01015 L     @14,DA34ADDR(,BLOCKPTR)                          02S1023
         CLI   DAIOPTCD(@14),0                                  02S1023
         BE    @RF01023                                         02S1023
*             DO;                                               02S1024
*               TUP(13) = ADDR(TU(13));                         02S1025
         LA    @08,TU+168                                       02S1025
         ST    @08,TUP+48                                       02S1025
*               TUP(13)->S99TUKEY = DALOPTCD;                   02S1026
         MVC   S99TUKEY(2,@08),@CB01017                         02S1026
*               TUP(13)->S99TUNUM = 1;                          02S1027
         LA    @04,1                                            02S1027
         STCM  @04,3,S99TUNUM(@08)                              02S1027
*               TUP(13)->S99TULNG = LENGTH(DAIOPTCD);           02S1028
         STCM  @04,3,S99TULNG(@08)                              02S1028
*               TUP(13)->S99TUPAR(1:LENGTH(DAIOPTCD)) = DAIOPTCD;
         MVC   S99TUPAR(1,@08),DAIOPTCD(@14)                    02S1029
*             END;                                              02S1030
*                                                               02S1030
*           IF DAIBLKSI^=ZERO THEN                              02S1031
@RF01023 L     @14,DA34ADDR(,BLOCKPTR)                          02S1031
         LH    @14,DAIBLKSI(,@14)                               02S1031
         LTR   @14,@14                                          02S1031
         BZ    @RF01031                                         02S1031
*             DO;                                               02S1032
*               TUP(14) = ADDR(TU(14));                         02S1033
         LA    @08,TU+182                                       02S1033
         ST    @08,TUP+52                                       02S1033
*               TUP(14)->S99TUKEY = DALBLKSZ;                   02S1034
         MVC   S99TUKEY(2,@08),@CB00210                         02S1034
*               TUP(14)->S99TUNUM = 1;                          02S1035
         MVC   S99TUNUM(2,@08),@CH00035                         02S1035
*               TUP(14)->S99TULNG = LENGTH(DAIBLKSI);           02S1036
         MVC   S99TULNG(2,@08),@CH00062                         02S1036
*               TUP(14)->S99TUPAR(1:LENGTH(DAIBLKSI)) = DAIBLKSI;
         STCM  @14,3,S99TUPAR(@08)                              02S1037
*             END;                                              02S1038
*                                                               02S1038
*           IF DAILRECL^=ZERO THEN                              02S1039
@RF01031 L     @14,DA34ADDR(,BLOCKPTR)                          02S1039
         LH    @14,DAILRECL(,@14)                               02S1039
         LTR   @14,@14                                          02S1039
         BZ    @RF01039                                         02S1039
*             DO;                                               02S1040
*               TUP(15) = ADDR(TU(15));                         02S1041
         LA    @08,TU+196                                       02S1041
         ST    @08,TUP+56                                       02S1041
*               TUP(15)->S99TUKEY = DALLRECL;                   02S1042
         MVC   S99TUKEY(2,@08),@CB01011                         02S1042
*               TUP(15)->S99TUNUM = 1;                          02S1043
         MVC   S99TUNUM(2,@08),@CH00035                         02S1043
*               TUP(15)->S99TULNG = LENGTH(DAILRECL);           02S1044
         MVC   S99TULNG(2,@08),@CH00062                         02S1044
*               TUP(15)->S99TUPAR(1:LENGTH(DAILRECL)) = DAILRECL;
         STCM  @14,3,S99TUPAR(@08)                              02S1045
*             END;                                              02S1046
*                                                               02S1046
*           IF DAINCP^=ZERO THEN                                02S1047
@RF01039 L     @14,DA34ADDR(,BLOCKPTR)                          02S1047
         CLI   DAINCP(@14),0                                    02S1047
         BE    @RF01047                                         02S1047
*             DO;                                               02S1048
*               TUP(16) = ADDR(TU(16));                         02S1049
         LA    @08,TU+210                                       02S1049
         ST    @08,TUP+60                                       02S1049
*               TUP(16)->S99TUKEY = DALNCP;                     02S1050
         MVC   S99TUKEY(2,@08),@CB01015                         02S1050
*               TUP(16)->S99TUNUM = 1;                          02S1051
         LA    @04,1                                            02S1051
         STCM  @04,3,S99TUNUM(@08)                              02S1051
*               TUP(16)->S99TULNG = LENGTH(DAINCP);             02S1052
         STCM  @04,3,S99TULNG(@08)                              02S1052
*               TUP(16)->S99TUPAR(1:LENGTH(DAINCP)) = DAINCP;   02S1053
         MVC   S99TUPAR(1,@08),DAINCP(@14)                      02S1053
*             END;                                              02S1054
*                                                               02S1054
*           TUP(16) = TUP(16) × '80000000'X;                    02S1055
@RF01047 L     @14,TUP+60                                       02S1055
         O     @14,@CF01105                                     02S1055
         ST    @14,TUP+60                                       02S1055
*          R1 = ADDR(S99RBPTR);        /* GET PARM PTR ADDRESS       */
*                                                               02S1056
         LA    R1,S99RBPTR                                      02S1056
*           /*MACDATE Y-2 73082*/                               02S1057
*           SVC (99);                                           02S1057
         SVC   99                                               02S1057
*          RESPECIFY R15 RESTRICTED;   /* RESTRICT REG 15 USAGE      */
*          IF R15 ^= 0 THEN            /* WAS DYN/ALLOC SUCCESSFUL ? */
         LTR   R15,R15                                          02S1059
         BZ    @RF01059                                         02S1059
*            IF S99ERROR = RCDDUNAV THEN /* IS DDNAME UNAVAILABLE ?  */
         CLC   S99ERROR(2),@CB00280                             02S1060
         BNE   @RF01060                                         02S1060
*              RETCODE = DRDDUNAV;     /* SET RETCODE TO 20          */
         LA    RETCODE,20                                       02S1061
*            ELSE                      /* NOT DDNAME UNAVAILABLE     */
*              IF R15 = 8 THEN         /* WAS REQUEST DENIED         */
         B     @RC01060                                         02S1062
@RF01060 C     R15,@CF00048                                     02S1062
         BNE   @RF01062                                         02S1062
*                RETCODE = DRREQDEN;   /* SET RETCODE TO 52          */
         LA    RETCODE,52                                       02S1063
*              ELSE                    /* NOT REQUEST DENIED         */
*                DO;                   /* DETERMINE TYPE OF ERROR    */
         B     @RC01062                                         02S1064
@RF01062 DS    0H                                               02S1065
*                  IF S99ERROR = RCINPARM & /* WAS LIST INVALID ?    */
*                    S99INFO = DALDDNAM THEN /* INVALID DDNAME ?     */
         CLC   S99ERROR(2),@CB00248                             02S1065
         BNE   @RF01065                                         02S1065
         CLC   S99INFO(2),@CB00894                              02S1065
         BNE   @RF01065                                         02S1065
*                    DA34DARC = DRDDNINV; /* INDICATE INVALID DDNAME */
         MVC   DA34DARC(2,BLOCKPTR),@CH00185                    02S1066
*                  ELSE                /* NOT INVALID DDNAME         */
*                    DA34DARC = S99ERROR; /* STORE S99ERROR IN DARC  */
         B     @RC01065                                         02S1067
@RF01065 LH    @14,S99ERROR                                     02S1067
         N     @14,@CF01193                                     02S1067
         STH   @14,DA34DARC(,BLOCKPTR)                          02S1067
*                  RETCODE = DRDYNERR; /* INDICATE DYN/ALLOC ERROR   */
@RC01065 LA    RETCODE,12                                       02S1068
*                END;                  /* END ERROR DETERMINATION    */
*        END;                          /* END ADDING NEW DDNAME      */
*      ELSE                            /* ELSE NOT CHAIN             */
*        IF DA34UNCH = ON THEN         /* DELETE DDNAME ?            */
         B     @RC00919                                         02S1071
@RF00919 TM    DA34UNCH(BLOCKPTR),B'00100000'                   02S1071
         BNO   @RF01071                                         02S1071
*          DO;                         /* YES                        */
*            S99VERB = S99VRBUN;       /* SET VERB CODE TO UNALLOC   */
*                                                               02S1073
*                                                               02S1073
         MVI   S99VERB,X'02'                                    02S1073
*               DO;                                             02S1074
*                 TUP(1) = ADDR(TU(1));                         02S1075
         LA    @14,TU                                           02S1075
         ST    @14,TUP                                          02S1075
*                 TUP(1)->S99TUKEY = DUNDDNAM;                  02S1076
         MVC   S99TUKEY(2,@14),@CB00894                         02S1076
*                 TUP(1)->S99TUNUM = 1;                         02S1077
         MVC   S99TUNUM(2,@14),@CH00035                         02S1077
*                 TUP(1)->S99TULNG = LENGTH(DA34NAME);          02S1078
         MVC   S99TULNG(2,@14),@CH00048                         02S1078
*                 TUP(1)->S99TUPAR(1:LENGTH(DA34NAME)) = DA34NAME;
         MVC   S99TUPAR(8,@14),DA34NAME(BLOCKPTR)               02S1079
*               END;                                            02S1080
*                                                               02S1080
*               DO;                                             02S1081
*                 TUP(2) = ADDR(TU(2));                         02S1082
         LA    @14,TU+14                                        02S1082
         ST    @14,TUP+4                                        02S1082
*                 TUP(2)->S99TUKEY = DUNUNALC;                  02S1083
         MVC   S99TUKEY(2,@14),@CB00905                         02S1083
*                 TUP(2)->S99TUNUM = 0;                         02S1084
         SLR   @08,@08                                          02S1084
         STCM  @08,3,S99TUNUM(@14)                              02S1084
*                 TUP(2)->S99TULNG = 0;                         02S1085
         STCM  @08,3,S99TULNG(@14)                              02S1085
*               END;                                            02S1086
*                                                               02S1086
*             TUP(2) = TUP(2) × '80000000'X;                    02S1087
         O     @14,@CF01105                                     02S1087
         ST    @14,TUP+4                                        02S1087
*            R1 = ADDR(S99RBPTR);      /* GET PARM PTR ADDRESS       */
*                                                               02S1088
         LA    R1,S99RBPTR                                      02S1088
*             /*MACDATE Y-2 73082*/                             02S1089
*             SVC (99);                                         02S1089
         SVC   99                                               02S1089
*            RESPECIFY R15 RESTRICTED; /* RESTRICT REG 15 USAGE      */
*            IF R15 ^= 0 THEN          /* WAS DYN/ALLOC SUCCESSFUL ? */
         LTR   R15,R15                                          02S1091
         BZ    @RF01091                                         02S1091
*              IF R15 = 8 THEN         /* WAS REQUEST DENIED ?       */
         C     R15,@CF00048                                     02S1092
         BNE   @RF01092                                         02S1092
*                RETCODE = DRREQDEN;   /* INDICATE REQUEST DENIED
*                                         BY INSTALLATION EXIT       */
         LA    RETCODE,52                                       02S1093
*              ELSE                    /* NOT REQUEST DENIED         */
*                RETCODE = DRNOTALC;   /* INDICATE DD NOT FOUND      */
         B     @RC01092                                         02S1094
@RF01092 LA    RETCODE,28                                       02S1094
*          END;                        /* END DELETE DDNAME          */
*        ELSE                          /* NO FUNCTION SPECIFIED      */
*          RETCODE = DRINVLST;         /* SET RETCODE TO 4(INVALID
*                                         PARAMETER LIST)            */
         B     @RC01071                                         02S1096
@RF01071 LA    RETCODE,4                                        02S1096
*      END;                            /* END OF PARM LIST PROCESSING*/
@RC01071 DS    0H                                               02S1097
@RC00919 DS    0H                                               02S1097
@RC00899 DS    0H                                               02S1098
*        END;                          /* END CODE 34                */
*                                                               01S1098
@RC00896 DS    0H                                               01S1099
*      IF S99VERB='00'X                /* NOT FILLED BECAUSE CODE BAD*/
*         & (BLOCKPTR->DAIRCODE^='0028'X &  /* CODE 28 IGNORED       */
*            BLOCKPTR->DAIRCODE^='0014'X)   /* CODE 14 IGNORED       */
*         & RETCODE = 0 THEN           /* HAS RETCODE BEEN SET ?     */
@RF00894 CLI   S99VERB,X'00'                                    01S1099
         BNE   @RF01099                                         01S1099
         CLC   DAIRCODE(2,BLOCKPTR),@CB00173                    01S1099
         BE    @RF01099                                         01S1099
         CLC   DAIRCODE(2,BLOCKPTR),@CB00163                    01S1099
         BE    @RF01099                                         01S1099
         LTR   RETCODE,RETCODE                                  01S1099
         BNZ   @RF01099                                         01S1099
*        DO;                                                    01S1100
*          RETCODE = DRINVLST;         /* R15 RETURN CODE            */
         LA    RETCODE,4                                        01S1101
*          QUIT = ON;                  /* FORCE LOOP EXIT            */
         OI    QUIT,B'10000000'                                 01S1102
*        END;                                                   01S1103
*      IF DAPLDAPB->DAIRCODE^='0028'X THEN/*NOT MULT-FUNCTION REQUEST*/
@RF01099 L     @14,DAPLDAPB(,DAPLPTR)                           01S1104
         CLC   DAIRCODE(2,@14),@CB00173                         01S1104
         BE    @RF01104                                         01S1104
*        QUIT = ON;                    /* FORCE LOOP EXIT            */
         OI    QUIT,B'10000000'                                 01S1105
*      ELSE                            /* CODE IS 28 (MULT FUNCT.)   */
*        IF RETCODE^=0 THEN            /* BUT LAST FUNCT. FAILED     */
         B     @RC01104                                         01S1106
@RF01104 LTR   RETCODE,RETCODE                                  01S1106
         BZ    @RF01106                                         01S1106
*          DO;                                                  01S1107
*            QUIT = ON;                /* FORCE LOOP EXIT            */
         OI    QUIT,B'10000000'                                 01S1108
*            DA28PFOP = BLOCKPTR;      /* ADDR OF FAILING FCT BLOCK  */
         L     @14,DAPLDAPB(,DAPLPTR)                           01S1109
         ST    BLOCKPTR,DA28PFOP(,@14)                          01S1109
*          END;                                                 01S1110
*    END;                                                       01S1111
@RF01106 DS    0H                                               01S1111
@RC01104 DS    0H                                               01S1112
*    RESPECIFY R15 UNRESTRICTED;       /* RELEASE REG 15 USAGE       */
@RF00114 DS    0H                                               01S1113
*END;                                  /* END MAJOR DO-LOOP          */
*                                                               01S1113
         AL    I,@CF00035                                       01S1113
@DE00092 TM    QUIT,B'10000000'                                 01S1113
         BZ    @DL00092                                         01S1113
*RETURN CODE(RETCODE);                 /* RETURN TO CALLER           */
         L     @13,4(,@13)                                      01S1114
         L     @00,@SIZDATD                                     01S1114
         LR    @01,@11                                          01S1114
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@05                                          01S1114
         L     @14,12(,@13)                                     01S1114
         LM    @00,@12,20(@13)                                  01S1114
         BR    @14                                              01S1114
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DAIR08                                            */
*/*                                                                  */
*/* DESCRIPTIVE - DAIR CODE 08 ROUTINE                               */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED WHEN ALLOCATION OF A DATA SET */
*/*      IS DESIRED.                                                 */
*/*                                                                  */
*/* OPERATION - THIS ROUTINE CHECKS FOR THE ATTRIBUTE LIST SUPPLIED  */
*/*             BIT IN THE CONTROL FIELD AND A BLANK ATTRIBUTE NAME, */
*/*             ZERO IN THE UNIT NAME FIELD OR ZERO IN THE VOLSER    */
*/*             FIELD. IF ANY OF THE ABOVE CONDITIONS ARE TRUE, THE  */
*/*             RETURN CODE IS SET TO 4. OTHERWISE, THE DSNAME CHECK */
*/*             ROUTINE IS INVOKED TO VALIDITY CHECK THE DSNAME.     */
*/*             IF THE DSNAME IS VALID(ZERO RETURN CODE), THEN THE   */
*/*             FOLLOWING VALIDITY TESTS ARE DONE:                   */
*/*               1. IF NEW STATUS, THEN KEEP AND UNCATLG ARE INVALID*/
*/*                  DISPOSITIONS.                                   */
*/*               2. IF STATUS IS NOT NEW OR MOD AND THE DSNAME IS   */
*/*                  BLANK, THIS IS AN ERROR CONDITION.              */
*/*             EITHER OF THE ABOVE CONDITIONS RESULT IN A RETURN    */
*/*             CODE OF 4.                                           */
*/*                                                                  */
*/*             IF THE RETURN CODE IS ZERO AFTER ALL THE ABOVE       */
*/*             TESTS, THE DSNAME,STATUS AND DISPOSITION ARE VALID.  */
*/*             IN ORDER TO DO AN ALLOCATION, TEXT UNITS ARE BUILT   */
*/*             USING DATA SUPPLIED IN THE DAIR08 PARM BLOCK OR      */
*/*             DATA FROM THE DEFAULT CSECT IEFAB445.  TEXT  @YM06251*/
*/*             UNITS ARE ALSO BUILT REQUESTING THE RETURN OF CERTAIN*/
*/*             DATA(SEE BELOW).                                     */
*/*               1. DSORG                                           */
*/*               2. DDNAME(IF NOT SUPPLIED).                        */
*/*               3. DSNAME(IF NOT SUPPLIED).                        */
*/*             AFTER THE TEXT UNITS ARE BUILT, DYNAMIC ALLOCATION   */
*/*             IS INVOKED (SVC 99).                                 */
*/*                                                                  */
*/*             IF DYNAMIC ALLOCATION WAS SUCCESSFUL(REG 15 IS ZERO),*/
*/*             THE FOLLOWING ERROR CONDITION IS TESTED FOR:         */
*/*               1. MEMBERNAME SUPPLIED AND DSORG RETURNED IS       */
*/*                  NOT PARTITIONED.                                */
*/*             IF THE ABOVE ERROR CONDITION IS FOUND, TEXT UNITS    */
*/*             ARE BUILT TO UNALLOCATE THE DATASET BY DDNAME AND    */
*/*             DYNAMIC UNALLOCATION(SVC 99) IS INVOKED, THE         */
*/*             DA08DARC IS SET TO DRNOMBRP.                         */
*/*                                                                  */
*/*             IF THE ABOVE ERROR CONDITION WAS NOT FOUND, THE      */
*/*             DSORG, DDNAME, DSNAME AND DSNAME LENGTH ARE STORED   */
*/*             INTO THE DAIR08 PARM BLOCK.                          */
*/*             IF REG 15 IS NOT ZERO AFTER INVOKING DYNAMIC         */
*/*             ALLOCATION, REG 15 AND S99ERROR FIELD(FROM SVC 99    */
*/*             PARAMETER LIST) ARE INTERROGATED IN ORDER TO         */
*/*             GENERATE PROPER DARC,CTRC AND RETURN CODES.  PLEASE  */
*/*             SEE RETURN CODE SECTION.                             */
*/*                                                                  */
*/* ENTRY - DAIR08 (INTERNAL PROCEDURE)                              */
*/*                                                                  */
*/*  PURPOSE - SEE FUNCTION                                          */
*/*                                                                  */
*/*  INPUT DATA - DAIR PARM BLOCK, SVC 99 PARM LIST                  */
*/*                                                                  */
*/* EXITS - ALL ARE TO NEXT SEQUENTIAL INSTRUCTION                   */
*/*                                                                  */
*/*  NORMAL - RETURN VIA REG 14                                      */
*/*                                                                  */
*/*   RETURN CODE - REG 15 SET TO ZERO                               */
*/*                                                                  */
*/*  ERROR - RETURN VIA REG 14                                       */
*/*                                                                  */
*/*   RETURN CODE - THE FOLLOWING RETURN, DARC AND CTRC CODES ARE    */
*/*                 RETURNED                                         */
*/*                                                                  */
*/*      THE FOLLOWING RETURN CODES(WITH EXPLANATION OF EACH CODE)   */
*/*      WILL BE ISSUED:                                             */
*/*        0 - SUCCESS                                               */
*/*        4 - INVALID PARAMETER LIST PASSED TO DAIR                 */
*/*        8 - ERROR IN CATALOG MANAGEMENT ROUTINE, ERROR CODE       */
*/*            STORED IN CTRC OF DAIR PARM BLOCK                     */
*/*       12 - ERROR IN DYNAMIC ALLOCATION, ERROR CODE STORED IN     */
*/*            DARC OF DAIR PARM BLOCK                               */
*/*       16 - RESOURCES COULD NOT BE UNALLOCATED TO DECREASE THE    */
*/*            NUMBER OF RESOURCES HELD IN ANTICIPATION OF REUSE     */
*/*            TO THE CONTROL VALUE, OR THE LIMIT OF 1635 CONCURRENT */
*/*            ALLOCATIONS HAS BEEN REACHED                          */
*/*       20 - THE DDNAME REQUESTED IS UNAVAILABLE                   */
*/*       28 - THE DDNAME OR DSNAME SPECIFIED IS NOT CURRENTLY       */
*/*            ALLOCATED                                             */
*/*       32 - THE DATA REQUESTED AS NEW WAS FOUND ALLOCATED         */
*/*       44 - THE EXISTING DATA SET REQUESTED WAS FOUND ALLOCATED   */
*/*            AS ELIGIBLE FOR DELETION                              */
*/*       48 - RESERVED                                              */
*/*       52 - REQUEST FAILED BY INSTALLATION EXIT                   */
*/*                                                                  */
*/*      REG 15 = 0 AFTER CALL TO DYNAMIC ALLOCATION                 */
*/*                                                                  */
*/*       CONDITION - MEMBERNAME SPECIFIED BUT DSORG RETURNED IS     */
*/*                   NOT PARTITIONED                                */
*/*       DARC = DRNOMBRP                                            */
*/*       RETCODE = 12                                               */
*/*                                                                  */
*/*      REG 15 = 4 AFTER CALL TO DYNAMIC ALLOCATION                 */
*/*                                                                  */
*/*       CONDITIONS                                                 */
*/*        1. S99ERROR = RCDDUNAV AFTER CALL TO DYNAMIC ALLOCATION   */
*/*           RETCODE IS SET TO 20                                   */
*/*           MEANING - DDNAME REQUESTED IS UNAVAILABLE              */
*/*                                                                  */
*/*        2. S99ERROR = RCDCONDD AFTER CALL TO DYNAMIC ALLOCATION   */
*/*           DARC IS SET DRDUPEDD                                   */
*/*           RETCODE IS SET TO 12                                   */
*/*           MEANING - RESTORING DDNAMES FOR DECONCATENATION PROCESS*/
*/*                     WOULD RESULT IN DUPLICATE DDNAMES            */
*/*                                                                  */
*/*       3. S99ERROR = RCNTUNLC OR RCLIMITS AFTER CALL TO DYNAMIC   */
*/*                     ALLOCATION                                   */
*/*          RETCODE IS SET TO 16                                    */
*/*          MEANING - RCNTUNLC = RESOURCES COULD NOT BE UNALLOCATED */
*/*                          TO DECREASE THE NUMBER OF RESOURCES HELD*/
*/*                          IN ANTICIPATION OF REUSE TO THE CONTROL */
*/*                          VALUE                                   */
*/*                    RCLIMITS = REQUEST WOULD CAUSE THE LIMIT OF   */
*/*                          1635 CONCURRENT ALLOCATIONS TO BE       */
*/*                          EXCEEDED                                */
*/*                                                                  */
*/*        4. S99ERROR = RCNEWFND AFTER CALL TO DYNAMIC ALLOCATION   */
*/*           RETCODE IS SET TO 32                                   */
*/*           MEANING - THE DATA SET REQUESTED AS NEW WAS FOUND      */
*/*                     ALLOCATED                                    */
*/*                                                                  */
*/*        5. S99ERROR = RCDELETE AFTER CALL TO DYNAMIC ALLOCATION   */
*/*           RETCODE IS SET TO 44                                   */
*/*           MEANING - THE EXISTING DATA SET REQUESTED WAS FOUND    */
*/*                     ALLOCATED AS ELIGIBLE FOR DELETION           */
*/*                                                                  */
*/*        6. S99ERROR = RCDCBRNF AFTER CALL TO DYNAMIC ALLOCATION   */
*/*           RETCODE IS SET TO 28                                   */
*/*           MEANING - OBJECT OF DCB REFERBACK NOT FOUND            */
*/*                                                                  */
*/*        7. S99ERROR - IF THE 1ST BYTE OF THE S99ERROR FIELD       */
*/*                      CONTAINS '17'X (LOCATE ERROR) OR '57'X(CATLG*/
*/*                      ERROR), THE 2ND BYTE OF THE S99ERROR FIELD  */
*/*                      IS MOVED TO THE CTRC. IN ADDITION, IF A     */
*/*                      LOCATE ERROR IS FOUND, THE WHOLE S99ERROR   */
*/*                      FIELD IS MOVED INTO THE DARC.               */
*/*           RETCODE IS SET TO 8                                    */
*/*           MEANING - AN ERROR OCCURRED IN A CATALOG MANAGEMENT    */
*/*                     ROUTINE                                      */
*/*                                                                  */
*/*        8. IF RETCODE IS ZERO AFTER THE ABOVE TESTS, THE          */
*/*           S99ERROR FIELD DATA IS MOVED TO THE DARC.              */
*/*           RETCODE IS SET TO 12                                   */
*/*           MEANING - A DYNAMIC ALLOCATION ERROR HAS OCCURRED, THE */
*/*                     ERROR CODE IS STORED IN THE DARC             */
*/*                                                                  */
*/*      REG 15 = 8 AFTER CALL TO DYNAMIC ALLOCATION                 */
*/*        RETCODE IS SET TO 52                                      */
*/*        MEANING - THE REQUEST WAS FAILED BY THE INSTALLATION      */
*/*                  EXIT ROUTINE                                    */
*/*                                                                  */
*/*      REG 15 = 12 AFTER CALL TO DYNAMIC ALLOCATION                */
*/*                                                                  */
*/*       CONDITIONS                                                 */
*/*        1. S99ERROR = RCINPARM AFTER CALL TO DYNAMIC ALLOCATION   */
*/*                      THE S99INFO FIELD MUST ALSO BE EXAMINED     */
*/*                      TO DETERMINE WHICH CODE SHOULD BE RETURNED  */
*/*                      IN THE DARC.  AFTER EXAMINING THE S99INFO   */
*/*                      FIELD, THE DARC WILL BE SET TO ONE OF THE   */
*/*                      FOLLOWING CODES                             */
*/*                      DRDDNINV - INVALID CHARACTERS IN DDNAME     */
*/*                      DRDSNINV - INVALID CHARACTERS IN DSNAME     */
*/*                      DRMBRINV - INVALID CHARACTERS IN MEMBER NAME*/
*/*                      DRDSPINV - INVALID DISPOSITION              */
*/*                                                                  */
*/*        2. S99ERROR = RCINKEYL AFTER CALL TO DYNAMIC ALLOCATION.  */
*/*                      THE S99INFO FIELD IS EXAMINED TO DETERMINE  */
*/*                      IF THE DSNAME TEXT UNIT IS IN ERROR.  IF    */
*/*                      THE DSNAME TEXT UNIT IS IN ERROR THE        */
*/*                      DARC=DRDSNLEN - DSNAME LENGTH GREATER THAN  */
*/*                      44 CHARACTERS.                              */
*/*                                                                  */
*/*        3. IF THE DARC IS ZERO AFTER THE ABOVE TESTS, THE         */
*/*           S99ERROR FIELD DATA IS STORED IN THE DARC.             */
*/*                                                                  */
*/*       AS A RESULT OF REG15 = 12 AFTER INVOKING DYNAMIC           */
*/*       ALLOCATION, RETCODE IS SET TO 12(ERROR OCCURRED IN         */
*/*       DYNAMIC ALLOCATION, THE DYNAMIC ALLOCATION ERROR           */
*/*       CODE IS STORED IN THE DARC).                               */
*/*                                                                  */
*/* OUTPUT DATA - DSORG,DDNAME DSNAME & DSNAME LENGTH STORED INTO    */
*/*               DAIR PARM BLOCK, RETCODE, DARC & CTRC CODES SET    */
*/*                                                                  */
*/********************************************************************/
*DAIR08: PROC;                                                  02S1115
@EL00001 L     @13,4(,@13)                                      02S1115
@EF00001 L     @00,@SIZDATD                                     02S1115
         LR    @01,@11                                          02S1115
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                  02S1115
         BR    @14                                              02S1115
DAIR08   STM   @14,@04,@SA00002                                 02S1115
         STM   @06,@12,@SA00002+28                              02S1115
*DA08DARC=ZERO;                        /*CLEAR REASON CODE FIELD     */
         SLR   @08,@08                                          02S1116
         STH   @08,DA08DARC(,BLOCKPTR)                          02S1116
*DA08CTRC=ZERO;                        /*CLEAR CATALOG RTN CODE FIELD*/
         STH   @08,DA08CTRC(,BLOCKPTR)                          02S1117
*DEFADDR = ZERO;                       /* CLEAR DEFAULT CSECT(IEFAB445)
*                                         BASE PTR           @YM06251*/
         SLR   DEFADDR,DEFADDR                                  02S1118
*DDBLANK = OFF;                        /* TURN OFF SWITCH            */
         NI    DDBLANK,B'01111111'                              02S1119
*IF (DA08ATRL='1'B & DA08ALN(1)=' ')   /*BLANK ATTRIBUTE LIST NAME?  */
*  × DA08UNIT(1)='00'X                 /*ZERO IN UNIT NAME FIELD?    */
*  × DA08SER(1)='00'X THEN             /*ZERO IN VOL SER FIELD?      */
         TM    DA08ATRL(BLOCKPTR),B'00000010'                   02S1120
         BNO   @GL00031                                         02S1120
         CLI   DA08ALN(BLOCKPTR),C' '                           02S1120
         BE    @RT01120                                         02S1120
@GL00031 CLI   DA08UNIT(BLOCKPTR),X'00'                         02S1120
         BE    @RT01120                                         02S1120
         CLI   DA08SER(BLOCKPTR),X'00'                          02S1120
         BNE   @RF01120                                         02S1120
@RT01120 DS    0H                                               02S1121
*  RETCODE=4;                          /*YES,BAD PARM LIST ERROR CODE*/
         LA    RETCODE,4                                        02S1121
*ELSE                                                           02S1122
*  DO;                                                          02S1122
         B     @RC01120                                         02S1122
@RF01120 DS    0H                                               02S1123
*    CALL DSNCHECK (DA08CTL,DA08PDSN); /*DSNAME PROCESSING           */
         LA    @08,DA08CTL(,BLOCKPTR)                           02S1123
         ST    @08,@AL00001                                     02S1123
         LA    @08,DA08PDSN(,BLOCKPTR)                          02S1123
         ST    @08,@AL00001+4                                   02S1123
         LA    @01,@AL00001                                     02S1123
         BAL   @14,DSNCHECK                                     02S1123
*    RETCODE=R15;                      /*SAVE RETURN CODE            */
         LR    RETCODE,R15                                      02S1124
*  END;                                                         02S1125
*IF RETCODE=ZERO THEN                  /*SUCCESSFUL SO FAR?          */
@RC01120 LTR   RETCODE,RETCODE                                  02S1126
         BNZ   @RF01126                                         02S1126
*  IF DA08DSP1 = NEW THEN              /*YES,NEW SPECIFIED?          */
         CLI   DA08DSP1(BLOCKPTR),X'04'                         02S1127
         BNE   @RF01127                                         02S1127
*    IF DA08DPS2 = KEEP                /*YES,KEEP SPECIFIED?         */
*      × DA08DPS2 = UNCATLG THEN       /*OR UNCATALOG SPECIFIED?     */
         CLI   DA08DPS2(BLOCKPTR),X'08'                         02S1128
         BE    @RT01128                                         02S1128
         CLI   DA08DPS2(BLOCKPTR),X'01'                         02S1128
         BNE   @RF01128                                         02S1128
@RT01128 DS    0H                                               02S1129
*      RETCODE=4;                      /*YES,SET PARM LIST ERROR CODE*/
         LA    RETCODE,4                                        02S1129
*    ELSE;                                                      02S1130
@RF01128 DS    0H                                               02S1131
*  ELSE                                /*NEW NOT SPECIFIED           */
*    IF DSNBUF(1) = ' '                /*DSNAME NOT SPECIFIED        */
*      & DA08DSP1 ^= MOD               /*AND STATUS NOT MOD          */
*      & DA08DMMY = OFF THEN           /* AND NOT DUMMY ?            */
         B     @RC01127                                         02S1131
@RF01127 CLI   DSNBUF,C' '                                      02S1131
         BNE   @RF01131                                         02S1131
         CLI   DA08DSP1(BLOCKPTR),X'02'                         02S1131
         BE    @RF01131                                         02S1131
         TM    DA08DMMY(BLOCKPTR),B'00000100'                   02S1131
         BNZ   @RF01131                                         02S1131
*      RETCODE=4;                      /*YES,SET PARM LIST ERROR CODE*/
         LA    RETCODE,4                                        02S1132
*    ELSE;                                                      02S1133
@RF01131 DS    0H                                               02S1134
*ELSE;                                                          02S1134
@RF01126 DS    0H                                               02S1135
*IF RETCODE=ZERO THEN                  /*SUCCESSFUL SO FAR?          */
@RC01126 SLR   @08,@08                                          02S1135
         CR    RETCODE,@08                                      02S1135
         BNE   @RF01135                                         02S1135
*  DO;                                 /*YES                         */
*    S99VERB=S99VRBAL;                 /*SET DSNAME ALLOC VERB CODE
*                                        IN SVC 99 PARMLIST          */
         MVI   S99VERB,X'01'                                    02S1137
*                           /*TEXT UNIT MACRO INIT        */    02S1138
*                                                               02S1138
*       DO;                                                     02S1138
*         TUP(1) = ADDR(TU(1));                                 02S1139
         LA    @07,TU                                           02S1139
         ST    @07,TUP                                          02S1139
*         TUP(1)->S99TUKEY = DALRTORG;                          02S1140
         MVC   S99TUKEY(2,@07),@CB01053                         02S1140
*         TUP(1)->S99TUNUM = 1;                                 02S1141
         LA    @04,1                                            02S1141
         STCM  @04,3,S99TUNUM(@07)                              02S1141
*         TUP(1)->S99TULNG = 2;                                 02S1142
         MVC   S99TULNG(2,@07),@CH00062                         02S1142
*         TUP(1)->S99TUPAR(1:2) = ZERO;                         02S1143
         STCM  @08,3,S99TUPAR(@07)                              02S1143
*       END;                /*RETURN DSORG TEXT UNIT   */       02S1144
*    IF DA08DDN(1)=' ' THEN            /*DDNAME SPECIFIED?           */
*                                                               02S1145
         CLI   DA08DDN(BLOCKPTR),C' '                           02S1145
         BNE   @RF01145                                         02S1145
*         DO;                                                   02S1146
*           TUP(2) = ADDR(TU(2));                               02S1147
         LA    @08,TU+14                                        02S1147
         ST    @08,TUP+4                                        02S1147
*           TUP(2)->S99TUKEY = DALRTDDN;                        02S1148
         MVC   S99TUKEY(2,@08),@CB01049                         02S1148
*           TUP(2)->S99TUNUM = 1;                               02S1149
         STCM  @04,3,S99TUNUM(@08)                              02S1149
*           TUP(2)->S99TULNG = 8;                               02S1150
         MVC   S99TULNG(2,@08),@CH00048                         02S1150
*           TUP(2)->S99TUPAR(1:8) = '';                         02S1151
         MVI   S99TUPAR(@08),C' '                               02S1151
         MVC   S99TUPAR+1(7,@08),S99TUPAR(@08)                  02S1151
*         END;                /*NO, RETURN DDNAME TEXT U.*/     02S1152
*    ELSE                              /*DDNAME WAS SPECIFIED        */
*                                                               02S1153
*         DO;                                                   02S1153
         B     @RC01145                                         02S1153
@RF01145 DS    0H                                               02S1154
*           TUP(2) = ADDR(TU(2));                               02S1154
         LA    @08,TU+14                                        02S1154
         ST    @08,TUP+4                                        02S1154
*           TUP(2)->S99TUKEY = DALDDNAM;                        02S1155
         MVC   S99TUKEY(2,@08),@CB00894                         02S1155
*           TUP(2)->S99TUNUM = 1;                               02S1156
         MVC   S99TUNUM(2,@08),@CH00035                         02S1156
*           TUP(2)->S99TULNG = LENGTH(DA08DDN);                 02S1157
         MVC   S99TULNG(2,@08),@CH00048                         02S1157
*           TUP(2)->S99TUPAR(1:LENGTH(DA08DDN)) = DA08DDN;      02S1158
         MVC   S99TUPAR(8,@08),DA08DDN(BLOCKPTR)                02S1158
*         END;                /*DDNAME TEXT UNIT */             02S1159
*    IF DSNBUF(1)=' ' THEN             /*DSNAME SPECIFIED?           */
*                                                               02S1160
@RC01145 CLI   DSNBUF,C' '                                      02S1160
         BNE   @RF01160                                         02S1160
*         DO;                                                   02S1161
*           TUP(3) = ADDR(TUDSN);                               02S1162
         LA    @08,TUDSN                                        02S1162
         ST    @08,TUP+8                                        02S1162
*           TUP(3)->S99TUKEY = DALRTDSN;                        02S1163
         MVC   S99TUKEY(2,@08),@CB01051                         02S1163
*           TUP(3)->S99TUNUM = 1;                               02S1164
         MVC   S99TUNUM(2,@08),@CH00035                         02S1164
*           TUP(3)->S99TULNG = 44;                              02S1165
         MVC   S99TULNG(2,@08),@CH00092                         02S1165
*           TUP(3)->S99TUPAR(1:44) = '';                        02S1166
         MVI   S99TUPAR(@08),C' '                               02S1166
         MVC   S99TUPAR+1(43,@08),S99TUPAR(@08)                 02S1166
*         END;                /*RETURN DSNAME  */               02S1167
*    ELSE                              /*DSNAME WAS SPECIFIED        */
*                                                               02S1168
*         DO;                                                   02S1168
         B     @RC01160                                         02S1168
@RF01160 DS    0H                                               02S1169
*           TUP(3) = ADDR(TUDSN);                               02S1169
         LA    @08,TUDSN                                        02S1169
         ST    @08,TUP+8                                        02S1169
*           TUP(3)->S99TUKEY = DALDSNAM;                        02S1170
         MVC   S99TUKEY(2,@08),@CB00896                         02S1170
*           TUP(3)->S99TUNUM = 1;                               02S1171
         MVC   S99TUNUM(2,@08),@CH00035                         02S1171
*           TUP(3)->S99TULNG = LENGTH(DSNBUF);                  02S1172
         MVC   S99TULNG(2,@08),@CH00092                         02S1172
*           TUP(3)->S99TUPAR(1:LENGTH(DSNBUF)) = DSNBUF;        02S1173
         MVC   S99TUPAR(44,@08),DSNBUF                          02S1173
*         END;                /* DSN TU */                      02S1174
*                                                               02S1174
*     IF DA08MNM^=' ' THEN                                      02S1175
@RC01160 CLI   DA08MNM(BLOCKPTR),C' '                           02S1175
         BE    @RF01175                                         02S1175
*       DO;                                                     02S1176
*         TUP(4) = ADDR(TU(4));                                 02S1177
         LA    @08,TU+42                                        02S1177
         ST    @08,TUP+12                                       02S1177
*         TUP(4)->S99TUKEY = DALMEMBR;                          02S1178
         MVC   S99TUKEY(2,@08),@CB00898                         02S1178
*         TUP(4)->S99TUNUM = 1;                                 02S1179
         MVC   S99TUNUM(2,@08),@CH00035                         02S1179
*         TUP(4)->S99TULNG = LENGTH(DA08MNM);                   02S1180
         MVC   S99TULNG(2,@08),@CH00048                         02S1180
*         TUP(4)->S99TUPAR(1:LENGTH(DA08MNM)) = DA08MNM;        02S1181
         MVC   S99TUPAR(8,@08),DA08MNM(BLOCKPTR)                02S1181
*       END;                   /* MEMBER NAME TEXT UNIT */      02S1182
*                                                               02S1182
*     IF DA08UNIT^=' ' THEN                                     02S1183
@RF01175 CLI   DA08UNIT(BLOCKPTR),C' '                          02S1183
         BE    @RF01183                                         02S1183
*       DO;                                                     02S1184
*         TUP(5) = ADDR(TU(5));                                 02S1185
         LA    @08,TU+56                                        02S1185
         ST    @08,TUP+16                                       02S1185
*         TUP(5)->S99TUKEY = DALUNIT;                           02S1186
         MVC   S99TUKEY(2,@08),@CB00929                         02S1186
*         TUP(5)->S99TUNUM = 1;                                 02S1187
         MVC   S99TUNUM(2,@08),@CH00035                         02S1187
*         TUP(5)->S99TULNG = LENGTH(DA08UNIT);                  02S1188
         MVC   S99TULNG(2,@08),@CH00048                         02S1188
*         TUP(5)->S99TUPAR(1:LENGTH(DA08UNIT)) = DA08UNIT;      02S1189
         MVC   S99TUPAR(8,@08),DA08UNIT(BLOCKPTR)               02S1189
*       END;                   /* UNIT NAME TEXT UNIT   */      02S1190
*                                                               02S1190
*     IF DA08SER^=' ' THEN                                      02S1191
@RF01183 CLI   DA08SER(BLOCKPTR),C' '                           02S1191
         BE    @RF01191                                         02S1191
*       DO;                                                     02S1192
*         TUP(6) = ADDR(TU(6));                                 02S1193
         LA    @08,TU+70                                        02S1193
         ST    @08,TUP+20                                       02S1193
*         TUP(6)->S99TUKEY = DALVLSER;                          02S1194
         MVC   S99TUKEY(2,@08),@CB00161                         02S1194
*         TUP(6)->S99TUNUM = 1;                                 02S1195
         MVC   S99TUNUM(2,@08),@CH00035                         02S1195
*         TUP(6)->S99TULNG = 6;                                 02S1196
         MVC   S99TULNG(2,@08),@CH00090                         02S1196
*         TUP(6)->S99TUPAR(1:6) = DA08SER;                      02S1197
         MVC   S99TUPAR(6,@08),DA08SER(BLOCKPTR)                02S1197
*       END;                /* VOLSER TEXT UNIT    */           02S1198
*    STATBUF=DA08DSP1;                 /*STATUS TO WORK BUFFER       */
@RF01191 MVC   STATBUF(1),DA08DSP1(BLOCKPTR)                    02S1199
*    IF STATBUF='00'X THEN             /*STATUS SPECIFIED?           */
         CLI   STATBUF,X'00'                                    02S1200
         BNE   @RF01200                                         02S1200
*      STATBUF=OLD;                    /*DEFAULT TO OLD              */
*                                                               02S1201
         MVI   STATBUF,X'01'                                    02S1201
*       DO;                                                     02S1202
@RF01200 DS    0H                                               02S1203
*         TUP(7) = ADDR(TU(7));                                 02S1203
         LA    @08,TU+84                                        02S1203
         ST    @08,TUP+24                                       02S1203
*         TUP(7)->S99TUKEY = DALSTATS;                          02S1204
         MVC   S99TUKEY(2,@08),@CB00155                         02S1204
*         TUP(7)->S99TUNUM = 1;                                 02S1205
         LA    @07,1                                            02S1205
         STCM  @07,3,S99TUNUM(@08)                              02S1205
*         TUP(7)->S99TULNG = LENGTH(STATBUF);                   02S1206
         STCM  @07,3,S99TULNG(@08)                              02S1206
*         TUP(7)->S99TUPAR(1:LENGTH(STATBUF)) = STATBUF;        02S1207
         MVC   S99TUPAR(1,@08),STATBUF                          02S1207
*       END;                /*BUILD STATUS TEXT UNIT     */     02S1208
*                                                               02S1208
*     IF DA08DPS2^=ZERO THEN                                    02S1209
         CLI   DA08DPS2(BLOCKPTR),0                             02S1209
         BE    @RF01209                                         02S1209
*       DO;                                                     02S1210
*         TUP(8) = ADDR(TU(8));                                 02S1211
         LA    @08,TU+98                                        02S1211
         ST    @08,TUP+28                                       02S1211
*         TUP(8)->S99TUKEY = DALNDISP;                          02S1212
         MVC   S99TUKEY(2,@08),@CB00901                         02S1212
*         TUP(8)->S99TUNUM = 1;                                 02S1213
         STCM  @07,3,S99TUNUM(@08)                              02S1213
*         TUP(8)->S99TULNG = LENGTH(DA08DPS2);                  02S1214
         STCM  @07,3,S99TULNG(@08)                              02S1214
*         TUP(8)->S99TUPAR(1:LENGTH(DA08DPS2)) = DA08DPS2;      02S1215
         MVC   S99TUPAR(1,@08),DA08DPS2(BLOCKPTR)               02S1215
*       END;                     /*NORMAL DISP TEXT UNIT      */
*                                                               02S1216
*     IF DA08DPS3^=ZERO THEN                                    02S1217
@RF01209 CLI   DA08DPS3(BLOCKPTR),0                             02S1217
         BE    @RF01217                                         02S1217
*       DO;                                                     02S1218
*         TUP(9) = ADDR(TU(9));                                 02S1219
         LA    @08,TU+112                                       02S1219
         ST    @08,TUP+32                                       02S1219
*         TUP(9)->S99TUKEY = DALCDISP;                          02S1220
         MVC   S99TUKEY(2,@08),@CB00903                         02S1220
*         TUP(9)->S99TUNUM = 1;                                 02S1221
         LA    @07,1                                            02S1221
         STCM  @07,3,S99TUNUM(@08)                              02S1221
*         TUP(9)->S99TULNG = LENGTH(DA08DPS3);                  02S1222
         STCM  @07,3,S99TULNG(@08)                              02S1222
*         TUP(9)->S99TUPAR(1:LENGTH(DA08DPS3)) = DA08DPS3;      02S1223
         MVC   S99TUPAR(1,@08),DA08DPS3(BLOCKPTR)               02S1223
*       END;                    /*CONDITIONAL DISP TEXT UNIT  */
*    IF DA08ATRL='1'B THEN             /*ATTRIBUTE LIST NAME SPECIF'D*/
*                                                               02S1225
@RF01217 TM    DA08ATRL(BLOCKPTR),B'00000010'                   02S1225
         BNO   @RF01225                                         02S1225
*         DO;                                                   02S1226
*           TUP(10) = ADDR(TU(10));                             02S1227
         LA    @08,TU+126                                       02S1227
         ST    @08,TUP+36                                       02S1227
*           TUP(10)->S99TUKEY = DALDCBDD;                       02S1228
         MVC   S99TUKEY(2,@08),@CB00971                         02S1228
*           TUP(10)->S99TUNUM = 1;                              02S1229
         MVC   S99TUNUM(2,@08),@CH00035                         02S1229
*           TUP(10)->S99TULNG = LENGTH(DA08ALN);                02S1230
         MVC   S99TULNG(2,@08),@CH00048                         02S1230
*           TUP(10)->S99TUPAR(1:LENGTH(DA08ALN)) = DA08ALN;     02S1231
         MVC   S99TUPAR(8,@08),DA08ALN(BLOCKPTR)                02S1231
*         END;                /*DCB DD REF TEXT UNIT     */     02S1232
*                                                               02S1232
*     IF DA08PSWD^=' ' THEN                                     02S1233
@RF01225 CLI   DA08PSWD(BLOCKPTR),C' '                          02S1233
         BE    @RF01233                                         02S1233
*       DO;                                                     02S1234
*         TUP(11) = ADDR(TU(11));                               02S1235
         LA    @08,TU+140                                       02S1235
         ST    @08,TUP+40                                       02S1235
*         TUP(11)->S99TUKEY = DALPASSW;                         02S1236
         MVC   S99TUKEY(2,@08),@CB01039                         02S1236
*         TUP(11)->S99TUNUM = 1;                                02S1237
         MVC   S99TUNUM(2,@08),@CH00035                         02S1237
*         TUP(11)->S99TULNG = LENGTH(DA08PSWD);                 02S1238
         MVC   S99TULNG(2,@08),@CH00048                         02S1238
*         TUP(11)->S99TUPAR(1:LENGTH(DA08PSWD)) = DA08PSWD;     02S1239
         MVC   S99TUPAR(8,@08),DA08PSWD(BLOCKPTR)               02S1239
*       END;                /*BUILD PASSWORD TU        */       02S1240
*    IF DA08DMMY = '0'B &              /* NON DUMMY ?        @YM07275*/
*      (DA08DQTY(2:4) ^= ZERO & DA08PQTY = ZERO &               02S1241
*       (DA08DSP1 = NEW × DA08DSP1 = MOD)) THEN /* IS ALLOCATION NEW
*                                       OR MOD AND IS DIRECTORY 02S1241
*                                       SPACE SPECIFIED AND NO PRIMARY
*                                       QUANTITY SUPPLIED ?  @YM06251*/
@RF01233 TM    DA08DMMY(BLOCKPTR),B'00000100'                   02S1241
         BNZ   @RF01241                                         02S1241
         SLR   @08,@08                                          02S1241
         SLR   @07,@07                                          02S1241
         ICM   @07,7,DA08DQTY+1(BLOCKPTR)                       02S1241
         CR    @08,@07                                          02S1241
         BE    @RF01241                                         02S1241
         CL    @08,DA08PQTY(,BLOCKPTR)                          02S1241
         BNE   @RF01241                                         02S1241
         CLI   DA08DSP1(BLOCKPTR),X'04'                         02S1241
         BE    @RT01241                                         02S1241
         CLI   DA08DSP1(BLOCKPTR),X'02'                         02S1241
         BNE   @RF01241                                         02S1241
@RT01241 DS    0H                                               02S1242
*      DO;                             /* DEFAULT SPACE      @YM06251*/
*        GEN (LOAD EP=IEFAB445);       /* GET ADDRESSABILITY TO DEFAULT
*                                         SPACE CSECT        @YM06251*/
         LOAD EP=IEFAB445
*        DEFADDR = R0;                 /* SAVE ADDRESS       @YM06251*/
*                                                               02S1244
         LR    DEFADDR,R0                                       02S1244
*           DO;                                                 02S1245
*             TUP(12) = ADDR(TU(12));                           02S1246
         LA    @08,TU+154                                       02S1246
         ST    @08,TUP+44                                       02S1246
*             TUP(12)->S99TUKEY = DALDIR;                       02S1247
         MVC   S99TUKEY(2,@08),@CB00159                         02S1247
*             TUP(12)->S99TUNUM = 1;                            02S1248
         LA    @07,1                                            02S1248
         STCM  @07,3,S99TUNUM(@08)                              02S1248
*             TUP(12)->S99TULNG = 3;                            02S1249
         LA    @04,3                                            02S1249
         STCM  @04,3,S99TULNG(@08)                              02S1249
*             TUP(12)->S99TUPAR(1:3) = DA08DQTY(2:4);           02S1250
         MVC   S99TUPAR(3,@08),DA08DQTY+1(BLOCKPTR)             02S1250
*           END;                /* BUILD DIR                    02S1251
*                 SPACE TU              @YM06251*/              02S1251
*                                                               02S1251
*         IF DEFPQTY^=ZERO THEN                                 02S1252
         ICM   @08,7,DEFPQTY(DEFADDR)                           02S1252
         BZ    @RF01252                                         02S1252
*           DO;                                                 02S1253
*             TUP(13) = ADDR(TU(13));                           02S1254
         LA    @08,TU+168                                       02S1254
         ST    @08,TUP+48                                       02S1254
*             TUP(13)->S99TUKEY = DALPRIME;                     02S1255
         MVC   S99TUKEY(2,@08),@CB00910                         02S1255
*             TUP(13)->S99TUNUM = 1;                            02S1256
         STCM  @07,3,S99TUNUM(@08)                              02S1256
*             TUP(13)->S99TULNG = 3;                            02S1257
         STCM  @04,3,S99TULNG(@08)                              02S1257
*             TUP(13)->S99TUPAR(1:3) = DEFPQTY;                 02S1258
         MVC   S99TUPAR(3,@08),DEFPQTY(DEFADDR)                 02S1258
*           END;                /* PRIMARY SPACE                02S1259
*                           DEFAULT TU            @YM06251*/    02S1259
*                                                               02S1259
*         IF DEFSQTY^=ZERO THEN                                 02S1260
@RF01252 ICM   @08,7,DEFSQTY(DEFADDR)                           02S1260
         BZ    @RF01260                                         02S1260
*           DO;                                                 02S1261
*             TUP(14) = ADDR(TU(14));                           02S1262
         LA    @08,TU+182                                       02S1262
         ST    @08,TUP+52                                       02S1262
*             TUP(14)->S99TUKEY = DALSECND;                     02S1263
         MVC   S99TUKEY(2,@08),@CB00912                         02S1263
*             TUP(14)->S99TUNUM = 1;                            02S1264
         MVC   S99TUNUM(2,@08),@CH00035                         02S1264
*             TUP(14)->S99TULNG = 3;                            02S1265
         MVC   S99TULNG(2,@08),@CH00079                         02S1265
*             TUP(14)->S99TUPAR(1:3) = DEFSQTY;                 02S1266
         MVC   S99TUPAR(3,@08),DEFSQTY(DEFADDR)                 02S1266
*           END;                /* SECONDARY SPACE              02S1267
*                           DEFAULT TU            @YM06251*/    02S1267
*        IF DEFTRK = '1'B THEN         /* TRK ALLOC DEFAULT? @YM06251*/
*                                                               02S1268
@RF01260 TM    DEFTRK(DEFADDR),B'10000000'                      02S1268
         BNO   @RF01268                                         02S1268
*             DO;                                               02S1269
*               TUP(15) = ADDR(TU(15));                         02S1270
         LA    @08,TU+196                                       02S1270
         ST    @08,TUP+56                                       02S1270
*               TUP(15)->S99TUKEY = DALTRK;                     02S1271
         MVC   S99TUKEY(2,@08),@CB00905                         02S1271
*               TUP(15)->S99TUNUM = 0;                          02S1272
         SLR   @07,@07                                          02S1272
         STCM  @07,3,S99TUNUM(@08)                              02S1272
*               TUP(15)->S99TULNG = 0;                          02S1273
         STCM  @07,3,S99TULNG(@08)                              02S1273
*             END;                      /* BUILD TRK TU       @YM06251*
*        ELSE                          /* TRK NOT DEFAULT    @YM06251*/
*          IF DEFCYL = '1'B THEN       /* CYL ALLOC DEFAULT? @YM06251*/
*                                                               02S1275
         B     @RC01268                                         02S1275
@RF01268 TM    DEFCYL(DEFADDR),B'01000000'                      02S1275
         BNO   @RF01275                                         02S1275
*               DO;                                             02S1276
*                 TUP(15) = ADDR(TU(15));                       02S1277
         LA    @08,TU+196                                       02S1277
         ST    @08,TUP+56                                       02S1277
*                 TUP(15)->S99TUKEY = DALCYL;                   02S1278
         MVC   S99TUKEY(2,@08),@CB00157                         02S1278
*                 TUP(15)->S99TUNUM = 0;                        02S1279
         SLR   @07,@07                                          02S1279
         STCM  @07,3,S99TUNUM(@08)                              02S1279
*                 TUP(15)->S99TULNG = 0;                        02S1280
         STCM  @07,3,S99TULNG(@08)                              02S1280
*               END;                /* BUILD CYL TU   @YM06251*/
*          ELSE                        /* CYL NOT DEFAULT    @YM06251*/
*            IF DEFBLKLN = '1'B THEN   /* AVG BLOCK LENGTH AS   02S1282
*                                         DEFAULT?           @YM06251*/
         B     @RC01275                                         02S1282
@RF01275 TM    DEFBLKLN(DEFADDR),B'00100000'                    02S1282
         BNO   @RF01282                                         02S1282
*              DO;                                              02S1283
*                IF DA08BLK(2:4) ^= ZERO THEN /*             @ZA03233*/
         ICM   @08,7,DA08BLK+1(BLOCKPTR)                        02S1284
         BZ    @RF01284                                         02S1284
*                                      /* USE SPECIFIED BLK  @ZA03233*/
*                                                               02S1285
*                     DO;                                       02S1285
*                       TUP(15) = ADDR(TU(15));                 02S1286
         LA    @08,TU+196                                       02S1286
         ST    @08,TUP+56                                       02S1286
*                       TUP(15)->S99TUKEY = DALBLKLN;           02S1287
         MVC   S99TUKEY(2,@08),@CB00908                         02S1287
*                       TUP(15)->S99TUNUM = 1;                  02S1288
         MVC   S99TUNUM(2,@08),@CH00035                         02S1288
*                       TUP(15)->S99TULNG = 3;                  02S1289
         MVC   S99TULNG(2,@08),@CH00079                         02S1289
*                       TUP(15)->S99TUPAR(1:3) = DA08BLK(2:4);  02S1290
         MVC   S99TUPAR(3,@08),DA08BLK+1(BLOCKPTR)              02S1290
*                     END;                                      02S1291
*                ELSE                  /*                    @ZA03233*/
*                                      /* USE DEFAULT BLK    @ZA03233*/
*                                                               02S1292
*                 DO;                                           02S1292
         B     @RC01284                                         02S1292
@RF01284 DS    0H                                               02S1293
*                   TUP(15) = ADDR(TU(15));                     02S1293
         LA    @08,TU+196                                       02S1293
         ST    @08,TUP+56                                       02S1293
*                   TUP(15)->S99TUKEY = DALBLKLN;               02S1294
         MVC   S99TUKEY(2,@08),@CB00908                         02S1294
*                   TUP(15)->S99TUNUM = 1;                      02S1295
         MVC   S99TUNUM(2,@08),@CH00035                         02S1295
*                   TUP(15)->S99TULNG = 3;                      02S1296
         MVC   S99TULNG(2,@08),@CH00079                         02S1296
*                   TUP(15)->S99TUPAR(1:3) = DEFDRLH;           02S1297
         MVC   S99TUPAR(3,@08),DEFDRLH(DEFADDR)                 02S1297
*                 END;                                          02S1298
*              END;                    /* END BLKSIZE TU     @ZA03233*/
@RC01284 DS    0H                                               02S1300
*                                      /* BUILD AVG BLOCK TU @YM06251*/
*        IF DEFRLSE = '1'B THEN        /* RELEASE A DEFAULT? @YM06251*/
*                                                               02S1300
@RF01282 DS    0H                                               02S1300
@RC01275 DS    0H                                               02S1300
@RC01268 TM    DEFRLSE(DEFADDR),B'00010000'                     02S1300
         BNO   @RF01300                                         02S1300
*             DO;                                               02S1301
*               TUP(16) = ADDR(TU(16));                         02S1302
         LA    @08,TU+210                                       02S1302
         ST    @08,TUP+60                                       02S1302
*               TUP(16)->S99TUKEY = DALRLSE;                    02S1303
         MVC   S99TUKEY(2,@08),@CB00915                         02S1303
*               TUP(16)->S99TUNUM = 0;                          02S1304
         SLR   @07,@07                                          02S1304
         STCM  @07,3,S99TUNUM(@08)                              02S1304
*               TUP(16)->S99TULNG = 0;                          02S1305
         STCM  @07,3,S99TULNG(@08)                              02S1305
*             END;                     /* BUILD RELEASE TU   @YM06251*/
*        IF DEFCONTG = '1'B THEN       /* CONTIGUOUS SPACE A    02S1307
*                                         DEFAULT?           @YM06251*/
*                                                               02S1307
@RF01300 TM    DEFCONTG(DEFADDR),B'00001000'                    02S1307
         BNO   @RF01307                                         02S1307
*             DO;                                               02S1308
*               TUP(17) = ADDR(TU(17));                         02S1309
         LA    @08,TU+224                                       02S1309
         ST    @08,TUP+64                                       02S1309
*               TUP(17)->S99TUKEY = DALSPFRM;                   02S1310
         MVC   S99TUKEY(2,@08),@CB00917                         02S1310
*               TUP(17)->S99TUNUM = 1;                          02S1311
         LA    @07,1                                            02S1311
         STCM  @07,3,S99TUNUM(@08)                              02S1311
*               TUP(17)->S99TULNG = 1;                          02S1312
         STCM  @07,3,S99TULNG(@08)                              02S1312
*               TUP(17)->S99TUPAR(1:1) = '08'X;                 02S1313
         MVI   S99TUPAR(@08),X'08'                              02S1313
*             END;                /* DEFAULT CONTIGUOUS         02S1314
*                       SPACE                 @YM06251*/        02S1314
*        ELSE                          /* CONTIG NOT DEFAULT @YM06251*/
*          IF DEFMIXG = '1'B THEN      /* MAXIMUM CONTIGUOUS SPACE
*                                         A DEFAULT?         @YM06251*/
*                                                               02S1315
         B     @RC01307                                         02S1315
@RF01307 TM    DEFMIXG(DEFADDR),B'00000100'                     02S1315
         BNO   @RF01315                                         02S1315
*               DO;                                             02S1316
*                 TUP(17) = ADDR(TU(17));                       02S1317
         LA    @08,TU+224                                       02S1317
         ST    @08,TUP+64                                       02S1317
*                 TUP(17)->S99TUKEY = DALSPFRM;                 02S1318
         MVC   S99TUKEY(2,@08),@CB00917                         02S1318
*                 TUP(17)->S99TUNUM = 1;                        02S1319
         LA    @07,1                                            02S1319
         STCM  @07,3,S99TUNUM(@08)                              02S1319
*                 TUP(17)->S99TULNG = 1;                        02S1320
         STCM  @07,3,S99TULNG(@08)                              02S1320
*                 TUP(17)->S99TUPAR(1:1) = '04'X;               02S1321
         MVI   S99TUPAR(@08),X'04'                              02S1321
*               END;                /* DEFAULT                  02S1322
*               MAX CONTIGUOUS SPACE  @YM06251*/                02S1322
*          ELSE                        /* NOT MAX CONTIG     @YM06251*/
*            IF DEFALX = '1'B THEN     /* ALX DEFAULT?       @YM06251*/
*                                                               02S1323
         B     @RC01315                                         02S1323
@RF01315 TM    DEFALX(DEFADDR),B'00000010'                      02S1323
         BNO   @RF01323                                         02S1323
*                 DO;                                           02S1324
*                   TUP(17) = ADDR(TU(17));                     02S1325
         LA    @08,TU+224                                       02S1325
         ST    @08,TUP+64                                       02S1325
*                   TUP(17)->S99TUKEY = DALSPFRM;               02S1326
         MVC   S99TUKEY(2,@08),@CB00917                         02S1326
*                   TUP(17)->S99TUNUM = 1;                      02S1327
         LA    @07,1                                            02S1327
         STCM  @07,3,S99TUNUM(@08)                              02S1327
*                   TUP(17)->S99TULNG = 1;                      02S1328
         STCM  @07,3,S99TULNG(@08)                              02S1328
*                   TUP(17)->S99TUPAR(1:1) = '02'X;             02S1329
         MVI   S99TUPAR(@08),X'02'                              02S1329
*                 END;                /* BUILD                  02S1330
*                ALX DEFAULT TU        @YM06251*/               02S1330
*        IF DEFROUND = '1'B THEN       /* IS DEFAULT ROUND?  @YM06251*/
*                                                               02S1331
@RF01323 DS    0H                                               02S1331
@RC01315 DS    0H                                               02S1331
@RC01307 TM    DEFROUND(DEFADDR),B'00000001'                    02S1331
         BNO   @RF01331                                         02S1331
*             DO;                                               02S1332
*               TUP(18) = ADDR(TU(18));                         02S1333
         LA    @08,TU+238                                       02S1333
         ST    @08,TUP+68                                       02S1333
*               TUP(18)->S99TUKEY = DALROUND;                   02S1334
         MVC   S99TUKEY(2,@08),@CB00919                         02S1334
*               TUP(18)->S99TUNUM = 0;                          02S1335
         SLR   @07,@07                                          02S1335
         STCM  @07,3,S99TUNUM(@08)                              02S1335
*               TUP(18)->S99TULNG = 0;                          02S1336
         STCM  @07,3,S99TULNG(@08)                              02S1336
*             END;                    /* BUILD ROUND TU     @YM06251*/
*      END;                            /* END SPACE DEFAULT  @YM06251*/
*    ELSE                              /* NOT A DEFAULT CASE @YM06251*/
*      IF DA08DMMY = '0'B &            /* NON DUMMY ?        @YM07275*/
*        DA08PQTY(2:4) ^= ZERO &       /* WAS PRIMARY SPACE SUPPLIED?*/
*         (DA08DSP1 =NEW × DA08DSP1 = MOD) THEN /* AND IS STATUS NEW
*                                                  OR MOD?   @YM06251*/
         B     @RC01241                                         02S1339
@RF01241 TM    DA08DMMY(BLOCKPTR),B'00000100'                   02S1339
         BNZ   @RF01339                                         02S1339
         ICM   @08,7,DA08PQTY+1(BLOCKPTR)                       02S1339
         BZ    @RF01339                                         02S1339
         CLI   DA08DSP1(BLOCKPTR),X'04'                         02S1339
         BE    @RT01339                                         02S1339
         CLI   DA08DSP1(BLOCKPTR),X'02'                         02S1339
         BNE   @RF01339                                         02S1339
@RT01339 DS    0H                                               02S1340
*        DO;                           /* YES, PROCESS ALL SPACE
*                                         RELATED DATA               */
*                                                               02S1340
*             DO;                                               02S1341
*               TUP(19) = ADDR(TU(19));                         02S1342
         LA    @08,TU+252                                       02S1342
         ST    @08,TUP+72                                       02S1342
*               TUP(19)->S99TUKEY = DALPRIME;                   02S1343
         MVC   S99TUKEY(2,@08),@CB00910                         02S1343
*               TUP(19)->S99TUNUM = 1;                          02S1344
         LA    @07,1                                            02S1344
         STCM  @07,3,S99TUNUM(@08)                              02S1344
*               TUP(19)->S99TULNG = 3;                          02S1345
         LA    @04,3                                            02S1345
         STCM  @04,3,S99TULNG(@08)                              02S1345
*               TUP(19)->S99TUPAR(1:3) = DA08PQTY(2:4);         02S1346
         MVC   S99TUPAR(3,@08),DA08PQTY+1(BLOCKPTR)             02S1346
*             END;               /*PRIMARY SPC*/                02S1347
*                                                               02S1347
*           IF DA08SQTY(2:4)^=ZERO THEN                         02S1348
         ICM   @08,7,DA08SQTY+1(BLOCKPTR)                       02S1348
         BZ    @RF01348                                         02S1348
*             DO;                                               02S1349
*               TUP(20) = ADDR(TU(20));                         02S1350
         LA    @08,TU+266                                       02S1350
         ST    @08,TUP+76                                       02S1350
*               TUP(20)->S99TUKEY = DALSECND;                   02S1351
         MVC   S99TUKEY(2,@08),@CB00912                         02S1351
*               TUP(20)->S99TUNUM = 1;                          02S1352
         STCM  @07,3,S99TUNUM(@08)                              02S1352
*               TUP(20)->S99TULNG = 3;                          02S1353
         STCM  @04,3,S99TULNG(@08)                              02S1353
*               TUP(20)->S99TUPAR(1:3) = DA08SQTY(2:4);         02S1354
         MVC   S99TUPAR(3,@08),DA08SQTY+1(BLOCKPTR)             02S1354
*             END;               /* SECONDARY SPACE */          02S1355
*                                                               02S1355
*           IF DA08DQTY(2:4)^=ZERO THEN                         02S1356
@RF01348 ICM   @08,7,DA08DQTY+1(BLOCKPTR)                       02S1356
         BZ    @RF01356                                         02S1356
*             DO;                                               02S1357
*               TUP(21) = ADDR(TU(21));                         02S1358
         LA    @08,TU+280                                       02S1358
         ST    @08,TUP+80                                       02S1358
*               TUP(21)->S99TUKEY = DALDIR;                     02S1359
         MVC   S99TUKEY(2,@08),@CB00159                         02S1359
*               TUP(21)->S99TUNUM = 1;                          02S1360
         MVC   S99TUNUM(2,@08),@CH00035                         02S1360
*               TUP(21)->S99TULNG = 3;                          02S1361
         MVC   S99TULNG(2,@08),@CH00079                         02S1361
*               TUP(21)->S99TUPAR(1:3) = DA08DQTY(2:4);         02S1362
         MVC   S99TUPAR(3,@08),DA08DQTY+1(BLOCKPTR)             02S1362
*             END;                /*DIRECTORY SPACE   */        02S1363
*          IF DA08TRKS=ON & DA08ABKL=ON THEN /* CYLINDER SPECIFIED   */
*                                                               02S1364
@RF01356 TM    DA08TRKS(BLOCKPTR),B'11000000'                   02S1364
         BNO   @RF01364                                         02S1364
*               DO;                                             02S1365
*                 TUP(22) = ADDR(TU(22));                       02S1366
         LA    @08,TU+294                                       02S1366
         ST    @08,TUP+84                                       02S1366
*                 TUP(22)->S99TUKEY = DALCYL;                   02S1367
         MVC   S99TUKEY(2,@08),@CB00157                         02S1367
*                 TUP(22)->S99TUNUM = 0;                        02S1368
         SLR   @07,@07                                          02S1368
         STCM  @07,3,S99TUNUM(@08)                              02S1368
*                 TUP(22)->S99TULNG = 0;                        02S1369
         STCM  @07,3,S99TULNG(@08)                              02S1369
*               END;                    /* CYLINDER TU                *
*          ELSE                        /* CYLINDER NOT SPECIFIED     */
*            DO;                                                02S1371
*                                                               02S1371
         B     @RC01364                                         02S1371
@RF01364 DS    0H                                               02S1372
*               IF DA08TRKS^='0'B THEN                          02S1372
         TM    DA08TRKS(BLOCKPTR),B'10000000'                   02S1372
         BZ    @RF01372                                         02S1372
*                 DO;                                           02S1373
*                   TUP(22) = ADDR(TU(22));                     02S1374
         LA    @08,TU+294                                       02S1374
         ST    @08,TUP+84                                       02S1374
*                   TUP(22)->S99TUKEY = DALTRK;                 02S1375
         MVC   S99TUKEY(2,@08),@CB00905                         02S1375
*                   TUP(22)->S99TUNUM = 0;                      02S1376
         SLR   @07,@07                                          02S1376
         STCM  @07,3,S99TUNUM(@08)                              02S1376
*                   TUP(22)->S99TULNG = 0;                      02S1377
         STCM  @07,3,S99TULNG(@08)                              02S1377
*                 END;                /* TRK TU */              02S1378
*                                                               02S1378
*               IF DA08ABKL^='0'B THEN                          02S1379
@RF01372 TM    DA08ABKL(BLOCKPTR),B'01000000'                   02S1379
         BZ    @RF01379                                         02S1379
*                 DO;                                           02S1380
*                   TUP(23) = ADDR(TU(23));                     02S1381
         LA    @08,TU+308                                       02S1381
         ST    @08,TUP+88                                       02S1381
*                   TUP(23)->S99TUKEY = DALBLKLN;               02S1382
         MVC   S99TUKEY(2,@08),@CB00908                         02S1382
*                   TUP(23)->S99TUNUM = 1;                      02S1383
         MVC   S99TUNUM(2,@08),@CH00035                         02S1383
*                   TUP(23)->S99TULNG = 3;                      02S1384
         MVC   S99TULNG(2,@08),@CH00079                         02S1384
*                   TUP(23)->S99TUPAR(1:3) = DA08BLK(2:4);      02S1385
         MVC   S99TUPAR(3,@08),DA08BLK+1(BLOCKPTR)              02S1385
*                 END;                                          02S1386
*                                      /* OR AVG BLOCK TU            */
*            END;                                               02S1387
@RF01379 DS    0H                                               02S1388
*        END;                          /* END PROCESSING SPACE DATA  */
@RC01364 DS    0H                                               02S1389
*        IF (DA08DSP1 = NEW × DA08DSP1 = MOD) &                 02S1389
*           DA08ATRL = OFF THEN        /* BUILD DCB BLKSIZE TU ONLY
*                                         FOR A NEW OR MOD ALLOCATION
*                                         WITHOUT AN ATTRIBUTE LIST
*                                                            @YM06251*/
@RF01339 DS    0H                                               02S1389
@RC01241 CLI   DA08DSP1(BLOCKPTR),X'04'                         02S1389
         BE    @GL00043                                         02S1389
         CLI   DA08DSP1(BLOCKPTR),X'02'                         02S1389
         BNE   @RF01389                                         02S1389
@GL00043 TM    DA08ATRL(BLOCKPTR),B'00000010'                   02S1389
         BNZ   @RF01389                                         02S1389
*          DO;                         /*                    @ZA03233*/
*            IF DA08BLK(3:4) ^= ZERO THEN /* BLKSIZE GIVEN   @ZA03233*/
*                                                               02S1391
         ICM   @08,3,DA08BLK+2(BLOCKPTR)                        02S1391
         BZ    @RF01391                                         02S1391
*                 DO;                                           02S1392
*                   TUP(24) = ADDR(TU(24));                     02S1393
         LA    @08,TU+322                                       02S1393
         ST    @08,TUP+92                                       02S1393
*                   TUP(24)->S99TUKEY = DALBLKSZ;               02S1394
         MVC   S99TUKEY(2,@08),@CB00210                         02S1394
*                   TUP(24)->S99TUNUM = 1;                      02S1395
         MVC   S99TUNUM(2,@08),@CH00035                         02S1395
*                   TUP(24)->S99TULNG = 2;                      02S1396
         MVC   S99TULNG(2,@08),@CH00062                         02S1396
*                   TUP(24)->S99TUPAR(1:2) = DA08BLK(3:4);      02S1397
         MVC   S99TUPAR(2,@08),DA08BLK+2(BLOCKPTR)              02S1397
*                 END;                                          02S1398
*          END;                        /*                    @ZA03233*/
*                                                               02S1399
@RF01391 DS    0H                                               02S1400
*     IF DA08PERM^='0'B THEN                                    02S1400
@RF01389 TM    DA08PERM(BLOCKPTR),B'00001000'                   02S1400
         BZ    @RF01400                                         02S1400
*       DO;                                                     02S1401
*         TUP(25) = ADDR(TU(25));                               02S1402
         LA    @08,TU+336                                       02S1402
         ST    @08,TUP+96                                       02S1402
*         TUP(25)->S99TUKEY = DALPERMA;                         02S1403
         MVC   S99TUKEY(2,@08),@CB01043                         02S1403
*         TUP(25)->S99TUNUM = 0;                                02S1404
         SLR   @07,@07                                          02S1404
         STCM  @07,3,S99TUNUM(@08)                              02S1404
*         TUP(25)->S99TULNG = 0;                                02S1405
         STCM  @07,3,S99TULNG(@08)                              02S1405
*       END;                /*PERM ALLOC'D TU         */        02S1406
*    IF DA08RLSE='1'B & ((DEFADDR^=ZERO & DEFRLSE='0'B)×        02S1407
*       DEFADDR=ZERO) THEN                                      02S1407
@RF01400 TM    DA08RLSE(BLOCKPTR),B'00010000'                   02S1407
         BNO   @RF01407                                         02S1407
         LTR   DEFADDR,DEFADDR                                  02S1407
         BZ    @GL00046                                         02S1407
         TM    DEFRLSE(DEFADDR),B'00010000'                     02S1407
         BZ    @RT01407                                         02S1407
@GL00046 LTR   DEFADDR,DEFADDR                                  02S1407
         BNZ   @RF01407                                         02S1407
@RT01407 DS    0H                                               02S1408
*            /* NO DEFAULT CSECT LOADED, NO RLSE DEFAULT, RLSE  02S1408
*               SPECIFIED, THEN BUILD RELEASE TEXT UNIT.     @ZA08639*/
*                                                               02S1408
*       DO;                                                     02S1408
*         TUP(26) = ADDR(TU(26));                               02S1409
         LA    @08,TU+350                                       02S1409
         ST    @08,TUP+100                                      02S1409
*         TUP(26)->S99TUKEY = DALRLSE;                          02S1410
         MVC   S99TUKEY(2,@08),@CB00915                         02S1410
*         TUP(26)->S99TUNUM = 0;                                02S1411
         SLR   @07,@07                                          02S1411
         STCM  @07,3,S99TUNUM(@08)                              02S1411
*         TUP(26)->S99TULNG = 0;                                02S1412
         STCM  @07,3,S99TULNG(@08)                              02S1412
*       END;                 /* RELEASE SPACE TU.            @ZA08639*/
*                                                               02S1413
*     IF DA08DMMY^='0'B THEN                                    02S1414
@RF01407 TM    DA08DMMY(BLOCKPTR),B'00000100'                   02S1414
         BZ    @RF01414                                         02S1414
*       DO;                                                     02S1415
*         TUP(27) = ADDR(TU(27));                               02S1416
         LA    @08,TU+364                                       02S1416
         ST    @08,TUP+104                                      02S1416
*         TUP(27)->S99TUKEY = DALDUMMY;                         02S1417
         MVC   S99TUKEY(2,@08),@CB00171                         02S1417
*         TUP(27)->S99TUNUM = 0;                                02S1418
         SLR   @07,@07                                          02S1418
         STCM  @07,3,S99TUNUM(@08)                              02S1418
*         TUP(27)->S99TULNG = 0;                                02S1419
         STCM  @07,3,S99TULNG(@08)                              02S1419
*       END;                /* DUMMY DATASET TU       */        02S1420
*                                                               02S1420
*     TUP(27) = TUP(27) × '80000000'X;                        /* END OF
* BTU'S FOR 08       */                                         02S1421
@RF01414 L     @08,TUP+104                                      02S1421
         O     @08,@CF01105                                     02S1421
         ST    @08,TUP+104                                      02S1421
*    R1 = ADDR(S99RBPTR);              /* PT TO ADDR OF S99RB        */
*                                                               02S1422
         LA    R1,S99RBPTR                                      02S1422
*     /*MACDATE Y-2 73082*/                                     02S1423
*     SVC (99);                        /* INVOKE DYNAMIC ALLOCATION  */
*                                                               02S1423
         SVC   99                                               02S1423
*    RFY R15 RESTRICTED;                                        02S1424
*    IF R15=ZERO THEN                  /* ALLOC SUCCESSFUL           */
         LTR   R15,R15                                          02S1425
         BNZ   @RF01425                                         02S1425
*      DO;                             /* YES                        */
*        IF DA08DDN(1) = ' ' THEN      /* WAS DDNAME SUPPLIED ?      */
         CLI   DA08DDN(BLOCKPTR),C' '                           02S1427
         BNE   @RF01427                                         02S1427
*          DDBLANK = ON;               /* SET SWITCH ON              */
         OI    DDBLANK,B'10000000'                              02S1428
*        DA08DSO=TUP(1)->S99TUPAR(1:LENGTH(DA08DSO)); /*RET DSORG    */
@RF01427 L     @14,TUP                                          02S1429
         MVC   DA08DSO(1,BLOCKPTR),S99TUPAR(@14)                02S1429
*        DA08DDN=TUP(2)->S99TUPAR(1:LENGTH(DA08DDN)); /* RET DDN     */
         L     @14,TUP+4                                        02S1430
         MVC   DA08DDN(8,BLOCKPTR),S99TUPAR(@14)                02S1430
*        IF DA08PDSN ^= ZERO &         /* IS PTR TO DSNBUF 0 ?       */
*          DA08PDSN -> DSNL = '2C'X &  /* IS DSNBUFFER 44 CHAR LONG? */
*          DA08PDSN -> DSN(1) = ' ' THEN /* IS BUFFER BLANK ?        */
         L     @14,DA08PDSN(,BLOCKPTR)                          02S1431
         LTR   @14,@14                                          02S1431
         BZ    @RF01431                                         02S1431
         CLC   DSNL(2,@14),@CH01134                             02S1431
         BNE   @RF01431                                         02S1431
         CLI   DSN(@14),C' '                                    02S1431
         BNE   @RF01431                                         02S1431
*          DO;                         /* RETURN DSNAME              */
*            DA08PDSN->DSNL=TUP(3)->S99TULNG; /* RETURN DSNAME LENGTH*/
         L     @08,TUP+8                                        02S1433
         ICM   @07,12,S99TULNG(@08)                             02S1433
         SRA   @07,16                                           02S1433
         STH   @07,DSNL(,@14)                                   02S1433
*            DA08PDSN->DSN(1:DA08PDSN->DSNL) =                  02S1434
*             TUP(3)->S99TUPAR(1:DA08PDSN->DSNL); /* RETURN DSNAME   */
         BCTR  @07,0                                            02S1434
         EX    @07,@SM01199                                     02S1434
*          END;                        /* END RETURN DSNAME          */
*        IF DA08MNM(1)^=' '            /* MEMBER NAME SPECIFIED      */
*          & TUP(1)->PODSORG^=ON THEN  /* AND DS NOT PARTITIONED     */
@RF01431 CLI   DA08MNM(BLOCKPTR),C' '                           02S1436
         BE    @RF01436                                         02S1436
         L     @14,TUP                                          02S1436
         TM    PODSORG(@14),B'00000010'                         02S1436
         BO    @RF01436                                         02S1436
*          DO;                         /* YES,MUST UNALLOC           */
*            S99VERB=S99VRBUN;         /* SET SVC 99 VERB CODE       */
*                                                               02S1438
*                                                               02S1438
         MVI   S99VERB,X'02'                                    02S1438
*               DO;                                             02S1439
*                 TUP(1) = ADDR(TU(1));                         02S1440
         LA    @14,TU                                           02S1440
         ST    @14,TUP                                          02S1440
*                 TUP(1)->S99TUKEY = DUNDDNAM;                  02S1441
         MVC   S99TUKEY(2,@14),@CB00894                         02S1441
*                 TUP(1)->S99TUNUM = 1;                         02S1442
         MVC   S99TUNUM(2,@14),@CH00035                         02S1442
*                 TUP(1)->S99TULNG = LENGTH(DA08DDN);           02S1443
         MVC   S99TULNG(2,@14),@CH00048                         02S1443
*                 TUP(1)->S99TUPAR(1:LENGTH(DA08DDN)) = DA08DDN;
         MVC   S99TUPAR(8,@14),DA08DDN(BLOCKPTR)                02S1444
*               END;                /* DDNAME TEXT UNIT  */     02S1445
*                                                               02S1445
*               DO;                                             02S1446
*                 TUP(2) = ADDR(TU(2));                         02S1447
         LA    @14,TU+14                                        02S1447
         ST    @14,TUP+4                                        02S1447
*                 TUP(2)->S99TUKEY = DUNREMOV;                  02S1448
         MVC   S99TUKEY(2,@14),@CB00157                         02S1448
*                 TUP(2)->S99TUNUM = 0;                         02S1449
         SLR   @08,@08                                          02S1449
         STCM  @08,3,S99TUNUM(@14)                              02S1449
*                 TUP(2)->S99TULNG = 0;                         02S1450
         STCM  @08,3,S99TULNG(@14)                              02S1450
*               END;                  /* UNALLOC OPTION             */
*                                                               02S1451
*             TUP(2) = TUP(2) × '80000000'X;                    02S1452
         O     @14,@CF01105                                     02S1452
         ST    @14,TUP+4                                        02S1452
*            R1=ADDR(S99RBPTR);        /* POINT TO ADDR OF S99RB     */
*                                                               02S1453
         LA    R1,S99RBPTR                                      02S1453
*             /*MACDATE Y-2 73082*/                             02S1454
*             SVC (99);                /* ISSUE SVC 99               */
         SVC   99                                               02S1454
*            DA08DARC=DRNOMBRP;        /* MEM SPEC,DS NOT PO RET CODE*/
         MVC   DA08DARC(2,BLOCKPTR),@CH00197                    02S1455
*            RETCODE=DRDYNERR;         /* DYN ALLOC RETURN CODE      */
         LA    RETCODE,12                                       02S1456
*            IF DDBLANK = ON THEN      /* WAS DDNAME SUPPLIED ?      */
         TM    DDBLANK,B'10000000'                              02S1457
         BNO   @RF01457                                         02S1457
*              DA08DDN = '';           /* NO, SET TO BLANKS AGAIN    */
         MVI   DA08DDN(BLOCKPTR),C' '                           02S1458
         MVC   DA08DDN+1(7,BLOCKPTR),DA08DDN(BLOCKPTR)          02S1458
*          END;                                                 02S1459
@RF01457 DS    0H                                               02S1460
*      END;                                                     02S1460
*                                                               02S1460
@RF01436 DS    0H                                               02S1461
*    IF R15=4 THEN                     /* ENVIRONMENT ERROR?         */
@RF01425 C     R15,@CF00059                                     02S1461
         BNE   @RF01461                                         02S1461
*      DO;                             /* YES, TRANSLATE CODE        */
*        IF S99ERROR=RCDDUNAV THEN     /* DDNAME UNAVAILABLE         */
         CLC   S99ERROR(2),@CB00280                             02S1463
         BNE   @RF01463                                         02S1463
*          RETCODE=20;                                          02S1464
         LA    RETCODE,20                                       02S1464
*        IF S99ERROR=RCDCONDD THEN     /* DUPLICATE DDN IF DECONCAT  */
@RF01463 CLC   S99ERROR(2),@CB00284                             02S1465
         BNE   @RF01465                                         02S1465
*          DO;                                                  02S1466
*            DA08DARC=DRDUPEDD;                                 02S1467
         MVC   DA08DARC(2,BLOCKPTR),@CH00183                    02S1467
*            RETCODE=DRDYNERR;                                  02S1468
         LA    RETCODE,12                                       02S1468
*          END;                                                 02S1469
*        IF S99ERROR=RCNTUNLC          /* NOT-IN-USE LIMIT           */
*          × S99ERROR=RCLIMITS THEN    /* OR AT ALLOC LIMIT          */
@RF01465 CLC   S99ERROR(2),@CB00290                             02S1470
         BE    @RT01470                                         02S1470
         CLC   S99ERROR(2),@CB00300                             02S1470
         BNE   @RF01470                                         02S1470
@RT01470 DS    0H                                               02S1471
*          RETCODE=16;                                          02S1471
         LA    RETCODE,16                                       02S1471
*        IF S99ERROR=RCNEWFND THEN     /* NEW D.S. EXIST             */
@RF01470 CLC   S99ERROR(2),@CB00296                             02S1472
         BNE   @RF01472                                         02S1472
*          RETCODE=32;                                          02S1473
         LA    RETCODE,32                                       02S1473
*        IF S99ERROR=RCDELETE THEN     /* OLD D.S. ELIGIBLE FOR DELET*/
@RF01472 CLC   S99ERROR(2),@CB00298                             02S1474
         BNE   @RF01474                                         02S1474
*          RETCODE=44;                                          02S1475
         LA    RETCODE,44                                       02S1475
*        IF S99ERROR=RCDCBRNF THEN     /* DCB REF NOT FOUND          */
@RF01474 CLC   S99ERROR(2),@CB00302                             02S1476
         BNE   @RF01476                                         02S1476
*          RETCODE=28;                                          02S1477
         LA    RETCODE,28                                       02S1477
*        IF S99ERROR(1)='17'X          /* LOCATE ERROR               */
*          × S99ERROR(1)='57'X THEN    /* OR CATALOG ERROR           */
@RF01476 CLI   S99ERROR,X'17'                                   02S1478
         BE    @RT01478                                         02S1478
         CLI   S99ERROR,X'57'                                   02S1478
         BNE   @RF01478                                         02S1478
@RT01478 DS    0H                                               02S1479
*          DO;                                                  02S1479
*            DA08CTRC=S99ERROR(2);                              02S1480
         SLR   @14,@14                                          02S1480
         IC    @14,S99ERROR+1                                   02S1480
         STH   @14,DA08CTRC(,BLOCKPTR)                          02S1480
*            RETCODE=DRCATMGT;                                  02S1481
         LA    RETCODE,8                                        02S1481
*            IF S99ERROR(1)='17'X THEN /* LOCATE ERROR               */
         CLI   S99ERROR,X'17'                                   02S1482
         BNE   @RF01482                                         02S1482
*              DA08DARC=S99ERROR;      /* SET SVC 99 RET CODE ALSO   */
         LH    @14,S99ERROR                                     02S1483
         N     @14,@CF01193                                     02S1483
         STH   @14,DA08DARC(,BLOCKPTR)                          02S1483
*          END;                                                 02S1484
@RF01482 DS    0H                                               02S1485
*        IF RETCODE=ZERO THEN          /* RETURN CODE SET YET?       */
@RF01478 LTR   RETCODE,RETCODE                                  02S1485
         BNZ   @RF01485                                         02S1485
*          DO;                         /* NO                         */
*            DA08DARC=S99ERROR;        /* SET REASON CODE            */
         LH    @14,S99ERROR                                     02S1487
         N     @14,@CF01193                                     02S1487
         STH   @14,DA08DARC(,BLOCKPTR)                          02S1487
*            RETCODE =DRDYNERR;        /* SET SVC 99 RETCODE CODE    */
         LA    RETCODE,12                                       02S1488
*          END;                                                 02S1489
*      END;                                                     02S1490
*                                                               02S1490
@RF01485 DS    0H                                               02S1491
*    IF R15=8 THEN                     /* INSTALLATION EXIT FAIL     */
@RF01461 C     R15,@CF00048                                     02S1491
         BNE   @RF01491                                         02S1491
*      RETCODE=DRREQDEN;               /* SET RETURN CODE TO 52   */
*                                                               02S1492
         LA    RETCODE,52                                       02S1492
*    IF R15=12 THEN                    /* SVC99 PARAMETER ERROR      */
@RF01491 C     R15,@CF00034                                     02S1493
         BNE   @RF01493                                         02S1493
*      DO;                                                      02S1494
*        IF S99ERROR=RCINPARM THEN     /* INVALID TEXT UNIT PARM     */
         CLC   S99ERROR(2),@CB00248                             02S1495
         BNE   @RF01495                                         02S1495
*          DO;                                                  02S1496
*            IF S99INFO=DALDDNAM THEN  /* INVALID DDNAME PARM        */
         CLC   S99INFO(2),@CB00894                              02S1497
         BNE   @RF01497                                         02S1497
*              DA08DARC=DRDDNINV;                               02S1498
         MVC   DA08DARC(2,BLOCKPTR),@CH00185                    02S1498
*            IF S99INFO=DALDSNAM THEN  /* INVALID DSNAME PARM        */
@RF01497 CLC   S99INFO(2),@CB00896                              02S1499
         BNE   @RF01499                                         02S1499
*              DA08DARC=DRDSNINV;                               02S1500
         MVC   DA08DARC(2,BLOCKPTR),@CH00189                    02S1500
*            IF S99INFO=DALMEMBR THEN  /* INVALID MEMBER NAME PARM   */
@RF01499 CLC   S99INFO(2),@CB00898                              02S1501
         BNE   @RF01501                                         02S1501
*              DA08DARC=DRMBRINV;                               02S1502
         MVC   DA08DARC(2,BLOCKPTR),@CH00187                    02S1502
*            IF S99INFO=DALSTATS       /* INVALID STATUS             */
*              × S99INFO=DALNDISP      /* OR INVALID NORMAL DISP     */
*              × S99INFO=DALCDISP THEN /* OR INVALID CONDITIONAL DISP*/
@RF01501 CLC   S99INFO(2),@CB00155                              02S1503
         BE    @RT01503                                         02S1503
         CLC   S99INFO(2),@CB00901                              02S1503
         BE    @RT01503                                         02S1503
         CLC   S99INFO(2),@CB00903                              02S1503
         BNE   @RF01503                                         02S1503
@RT01503 DS    0H                                               02S1504
*              DA08DARC=DRDSPINV;                               02S1504
         MVC   DA08DARC(2,BLOCKPTR),@CH00201                    02S1504
*          END;                                                 02S1505
@RF01503 DS    0H                                               02S1506
*        IF S99ERROR=RCINKEYL          /* INVALID DSNAME TU LENGTH   */
*          & S99INFO=DALDSNAM THEN                              02S1506
@RF01495 CLC   S99ERROR(2),@CB00262                             02S1506
         BNE   @RF01506                                         02S1506
         CLC   S99INFO(2),@CB00896                              02S1506
         BNE   @RF01506                                         02S1506
*          DA08DARC=DRDSNLEN;                                   02S1507
         MVC   DA08DARC(2,BLOCKPTR),@CH00199                    02S1507
*        IF DA08DARC=ZERO THEN         /* REASON CODE SET YET?       */
@RF01506 LH    @14,DA08DARC(,BLOCKPTR)                          02S1508
         LTR   @14,@14                                          02S1508
         BNZ   @RF01508                                         02S1508
*          RETCODE = 4;                /* INVALID PARMS      @YM07275*/
         LA    RETCODE,4                                        02S1509
*        ELSE                          /* ALLOCATION ERROR   @YM07275*/
*          RETCODE=DRDYNERR;           /* SET RETURN CODE            */
         B     @RC01508                                         02S1510
@RF01508 LA    RETCODE,12                                       02S1510
*      END;                                                     02S1511
@RC01508 DS    0H                                               02S1512
*    RFY R15 UNRESTRICTED;                                      02S1512
@RF01493 DS    0H                                               02S1513
*  END;                                                         02S1513
*IF DEFADDR ^= ZERO THEN                /* WAS DEFAULT CSECT LOADED?
*                                                            @YM06251*/
@RF01135 LTR   DEFADDR,DEFADDR                                  02S1514
         BZ    @RF01514                                         02S1514
*  GEN (DELETE EP=IEFAB445);            /* YES, DELETE IT    @YM06251*/
         DELETE EP=IEFAB445
*END DAIR08;                                                    02S1516
@EL00002 DS    0H                                               02S1516
@EF00002 DS    0H                                               02S1516
@ER00002 LM    @14,@04,@SA00002                                 02S1516
         LM    @06,@12,@SA00002+28                              02S1516
         BR    @14                                              02S1516
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - DSNCHECK                                          */
*/* DESCRIPTIVE NAME - DATA SET NAME CHECK ROUTINE                   */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE IS INVOKED TO DETERMINE:                 */
*/*            1. IF THE DATA SET NAME LENGTH IS A LEAST 1           */
*/*               CHARACTER AND NOT GREATER THAN 44 CHARACTERS.      */
*/*            2. IF THE USERID SHOULD PREFIX THE DATA SET NAME AND  */
*/*               IF SO, WILL THE RESULTING DATA SET NAME BE TOO     */
*/*               LONG(GREATER THAN 44 CHARACTERS).                  */
*/*                                                                  */
*/*            THIS ROUTINE ALSO PREFIXES THE USERID TO THE DATA     */
*/*            SET NAME IF NECESSARY.                                */
*/*                                                                  */
*/* OPERATION - IF THE PREFIX USERID BIT IS ON, THE FOLLOWING TESTS  */
*/*             ARE DONE BEFORE ANY SUBSEQUENT TESTS.                */
*/*             1. IS PTR TO DSNAME ZERO ?                           */
*/*             2. IS THE 1ST CHARACTER OF THE DSNAME BLANK ?        */
*/*             3. IS THE 1ST CHARACTER & (TEMPORARY DSNAME) ?       */
*/*             IF ANY OF THE ABOVE CONDITIONS EXIST, THIS IS AN     */
*/*             ERROR AND A RETURN CODE OF 4 IS RETURNED IN REG 15.  */
*/*                                                                  */
*/*             THE FOLLOWING TESTS ARE ALWAYS DONE:                 */
*/*             1. IS THE DSNAME LENGTH GREATER THAN 44 ?            */
*/*             2. IS THE DSNAME LENGTH LESS THAN 1 ?                */
*/*             3. IF THE USERID IS TO PREFIX THE DSNAME, WILL THE   */
*/*                RESULTING LENGTH EXCEED 44 CHARACTERS ?           */
*/*             4. IS THE 1ST CHARACTER OF THE DSNAME BLANK AND      */
*/*                THE DSNAME LENGTH NOT EQUAL TO 44 ?               */
*/*             IF ANY OF THE ABOVE CONDITIONS EXIST, THIS IS AN     */
*/*             ERROR AND A RETURN CODE OF 4 IS RETURNED IN REG 15.  */
*/*                                                                  */
*/*             IF NO ERROR CONDITIONS EXIST AND THE USERID IS TO    */
*/*             PREFIX THE DSNAME, THE USERID(FROM THE UPT) IS       */
*/*             MOVED TO THE DAIR DSNAME BUFFER, A PERIOD IS         */
*/*             INSERTED AFTER THE USERID AND THE DSNAME IS THEN     */
*/*             MOVED.                                               */
*/*                                                                  */
*/*             IF THE USERID IS NOT TO PREFIX THE DSNAME, ONLY THE  */
*/*             DSNAME IS MOVED INTO THE DAIR DSNAME BUFFER.         */
*/*                                                                  */
*/* ENTRY - DSNCHECK (INTERNAL PROCEDURE)                            */
*/*                                                                  */
*/* PURPOSE - SEE FUNCTION                                           */
*/*                                                                  */
*/* INPUT DATA - DANNCTL(NN = THE DAIR CODE NUMBER) THE DAIR         */
*/*              CONTROL BYTE FIELD                                  */
*/*              DANNPDSN(NN = THE DAIR CODE NUMBER) THE POINTER     */
*/*              TO THE DSNAME                                       */
*/* EXITS - ALL ARE TO THE NEXT SEQUENTIAL INSTRUCTION               */
*/*                                                                  */
*/*  NORMAL - RETURN VIA REG 14                                      */
*/*                                                                  */
*/*  ERROR - RETURN VIA REG 14                                       */
*/*                                                                  */
*/* OUTPUT DATA - DSNAME IS IN DAIR DSNAME BUFFER.                   */
*/*               0 IN REG 15 IF EVERYTHING IS VALID                 */
*/*               4 IN REG 15 IF INVALID CONDITION                   */
*/*                                                                  */
*/********************************************************************/
*DSNCHECK: PROC (UBYTE,DSNP);                                   02S1517
*                                                               02S1517
DSNCHECK STM   @14,@12,12(@13)                                  02S1517
         MVC   @PC00003(8),0(@01)                               02S1517
*DSNRTCD = 0;                          /* INIT R15 RETURN CODE       */
         SLR   DSNRTCD,DSNRTCD                                  02S1518
*DSNBUF = '';                          /* INIT DSNBUF TO BLANKS      */
         MVI   DSNBUF,C' '                                      02S1519
         MVC   DSNBUF+1(43),DSNBUF                              02S1519
*IF PREFIXU='1'B                       /* PREFIX TSO USERID REQUESTED*/
*   & (DSNP=0                          /* ERR IF NO DSNAME SUPPLIED  */
*      × DSN(1)=' '                    /* ERR IF DSNAME IS BLANK     */
*      × DSN(1)='&') THEN              /* ERR IF TEMP. DSNAME        */
         L     @08,@PC00003                                     02S1520
         TM    PREFIXU(@08),B'00100000'                         02S1520
         BNO   @RF01520                                         02S1520
         L     @08,@PC00003+4                                   02S1520
         L     @08,DSNP(,@08)                                   02S1520
         LTR   @08,@08                                          02S1520
         BZ    @RT01520                                         02S1520
         CLI   DSN(@08),C' '                                    02S1520
         BE    @RT01520                                         02S1520
         CLI   DSN(@08),C'&&'                                   02S1520
         BNE   @RF01520                                         02S1520
@RT01520 DS    0H                                               02S1521
*   DSNRTCD = 4;                       /* WILL RETURN WITH R15=4     */
         LA    DSNRTCD,4                                        02S1521
*IF DSNP^=0 THEN                       /* DSNAME SUPPLIED            */
@RF01520 L     @08,@PC00003+4                                   02S1522
         L     @08,DSNP(,@08)                                   02S1522
         LTR   @08,@08                                          02S1522
         BZ    @RF01522                                         02S1522
*  DO;                                                          02S1523
*    IF DSNL>44 × DSNL<1               /* DSNAME LENGTH INVALID      */
*      × (PREFIXU='1'B & (UPTPREFL+DSNL+1>44))  /* OR CONCAT'D NAME
*                                                  TOO BIG           */
*      × (DSN(1)=' ' & DSNL^=44) THEN  /* INVALID RETN FIELD         */
         LA    @06,44                                           02S1524
         LH    @08,DSNL(,@08)                                   02S1524
         CR    @08,@06                                          02S1524
         BH    @RT01524                                         02S1524
         LA    @15,1                                            02S1524
         CR    @08,@15                                          02S1524
         BL    @RT01524                                         02S1524
         L     @14,@PC00003                                     02S1524
         TM    PREFIXU(@14),B'00100000'                         02S1524
         BNO   @GL00059                                         02S1524
         L     @01,DAPLUPT(,DAPLPTR)                            02S1524
         SLR   @00,@00                                          02S1524
         IC    @00,UPTPREFL(,@01)                               02S1524
         ALR   @08,@00                                          02S1524
         ALR   @08,@15                                          02S1524
         CR    @08,@06                                          02S1524
         BH    @RT01524                                         02S1524
@GL00059 L     @08,@PC00003+4                                   02S1524
         L     @08,DSNP(,@08)                                   02S1524
         CLI   DSN(@08),C' '                                    02S1524
         BNE   @RF01524                                         02S1524
         CLC   DSNL(2,@08),@CH00092                             02S1524
         BE    @RF01524                                         02S1524
@RT01524 DS    0H                                               02S1525
*      DSNRTCD = 4;                    /* RETURN R15=4 TO CALLER     */
*                                                               02S1525
         LA    DSNRTCD,4                                        02S1525
*    IF DSNRTCD=0 THEN                 /* NO ERR & DSNAME GIVEN      */
@RF01524 LTR   DSNRTCD,DSNRTCD                                  02S1526
         BNZ   @RF01526                                         02S1526
*      IF PREFIXU='1'B &               /* PREFIX USERID REQUESTED ?  */
*         UPTPREFL ^= 0 THEN           /* IS USERID PRESENT ?@YM05038*/
         L     @08,@PC00003                                     02S1527
         TM    PREFIXU(@08),B'00100000'                         02S1527
         BNO   @RF01527                                         02S1527
         L     @08,DAPLUPT(,DAPLPTR)                            02S1527
         CLI   UPTPREFL(@08),0                                  02S1527
         BE    @RF01527                                         02S1527
*          DO;                         /* PREFIX THE USERID          */
*            DSNBUF(1:UPTPREFL) = UPTPREFX(1:UPTPREFL);/* MOVE USERID*/
         SLR   @06,@06                                          02S1529
         IC    @06,UPTPREFL(,@08)                               02S1529
         LR    @15,@06                                          02S1529
         BCTR  @15,0                                            02S1529
         EX    @15,@SM01201                                     02S1529
*            DSNBUF(UPTPREFL+1) = '.'; /* SEPARATOR                  */
         LA    @08,DSNBUF(@06)                                  02S1530
         MVI   0(@08),C'.'                                      02S1530
*            DSNBUF(UPTPREFL+2:UPTPREFL+1+DSNL) = DSN(1:DSNL);  02S1531
         LA    @08,DSNBUF+1(@06)                                02S1531
         LA    @15,1                                            02S1531
         ALR   @15,@06                                          02S1531
         L     @14,@PC00003+4                                   02S1531
         L     @14,DSNP(,@14)                                   02S1531
         AH    @15,DSNL(,@14)                                   02S1531
         SLR   @15,@06                                          02S1531
         BCTR  @15,0                                            02S1531
         BCTR  @15,0                                            02S1531
         EX    @15,@SM01203                                     02S1531
*                                      /* MOVE DATA SET NAME         */
*          END;                        /* END PREFIX USERID          */
*      ELSE                            /* DON'T PREFIX USERID        */
*        DSNBUF(1:DSNL) = DSN(1:DSNL); /* DSNAME ONLY IS RESULT      */
         B     @RC01527                                         02S1533
@RF01527 L     @08,@PC00003+4                                   02S1533
         L     @08,DSNP(,@08)                                   02S1533
         LH    @06,DSNL(,@08)                                   02S1533
         BCTR  @06,0                                            02S1533
         EX    @06,@SM01205                                     02S1533
*  END;                                                         02S1534
*                                                               02S1534
@RC01527 DS    0H                                               02S1534
@RF01526 DS    0H                                               02S1535
*RETURN CODE(DSNRTCD);                 /* RETURN TO CALLER           */
@RF01522 LR    @15,DSNRTCD                                      02S1535
         L     @14,12(,@13)                                     02S1535
         LM    @00,@12,20(@13)                                  02S1535
         BR    @14                                              02S1535
*END DSNCHECK;                                                  02S1536
*RESPECIFY R4 UNRESTRICTED;            /* RELEASE USE OF R4          */
*END IEFDB4D0                                                   01S1538
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (DAIRSPEC)                                        *
*/*%INCLUDE SYSLIB  (DAIRDATA)                                        *
*/*%INCLUDE SYSLIB  (IKJDAPL )                                        *
*/*%INCLUDE SYSLIB  (IEFZB4DA)                                        *
*/*%INCLUDE SYSLIB  (BTUMACRO)                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*/*%INCLUDE SYSLIB  (IKJDAP00)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP04)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP08)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP0C)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP10)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP14)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP18)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP1C)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP24)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP28)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP2C)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP30)                                        *
*/*%INCLUDE SYSLIB  (IKJDAP34)                                        *
*/*%INCLUDE SYSLIB  (IKJDACB )                                        *
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                        *
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                        *
*/*%INCLUDE SYSLIB  (DAIR00  )                                        *
*/*%INCLUDE SYSLIB  (DAIR00SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR04  )                                        *
*/*%INCLUDE SYSLIB  (DAIR04SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR0C  )                                        *
*/*%INCLUDE SYSLIB  (DAIR0CSP)                                        *
*/*%INCLUDE SYSLIB  (DAIR10  )                                        *
*/*%INCLUDE SYSLIB  (DAIR10SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR14  )                                        *
*/*%INCLUDE SYSLIB  (DAIR14SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR18  )                                        *
*/*%INCLUDE SYSLIB  (DAIR18SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR1C  )                                        *
*/*%INCLUDE SYSLIB  (DAIR1CSP)                                        *
*/*%INCLUDE SYSLIB  (DAIR24  )                                        *
*/*%INCLUDE SYSLIB  (DAIR24SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR2C  )                                        *
*/*%INCLUDE SYSLIB  (DAIR2CSP)                                        *
*/*%INCLUDE SYSLIB  (DAIR30  )                                        *
*/*%INCLUDE SYSLIB  (DAIR30SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR34  )                                        *
*/*%INCLUDE SYSLIB  (DAIR34SP)                                        *
*/*%INCLUDE SYSLIB  (DAIR08  )                                        *
*/*%INCLUDE SYSLIB  (DAIR08SP)                                        *
*/*%INCLUDE SYSLIB  (DSNCHECK)                                        *
*/*%INCLUDE SYSLIB  (DSNCHKSP)                                        *
*;                                                              01S1538
@DATA    DS    0H
@CH00062 DC    H'2'
@CH00079 DC    H'3'
@CH00090 DC    H'6'
@CH00032 DC    H'9'
@CH00092 DC    H'44'
@CH00179 DC    XL2'0304'
@CH00181 DC    XL2'0308'
@CH00183 DC    XL2'0314'
@CH00185 DC    XL2'0318'
@CH00187 DC    XL2'031C'
@CH00189 DC    XL2'0320'
@CH00191 DC    XL2'0324'
@CH00193 DC    XL2'0328'
@CH00195 DC    XL2'032C'
@CH00197 DC    XL2'0330'
@CH00199 DC    XL2'0334'
@CH00201 DC    XL2'0338'
@CH00894 DC    XL2'0001'
@CH00896 DC    XL2'0002'
@CH01134 DC    XL2'2C'
@SX01194 XC    DA14AREA(0,@04),DA14AREA(@04)
@SM01199 MVC   DSN(0,@14),S99TUPAR(@08)
@SM01201 MVC   DSNBUF(0),UPTPREFX(@08)
@SM01203 MVC   0(0,@08),DSN(@14)
@SM01205 MVC   DSNBUF(0),DSN(@08)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00003 DS    2F
@SA00002 DS    14F
@AL00001 DS    2A
@TF00001 DS    F
IEFDB4D0 CSECT
         DS    0F
@CF00035 DC    F'1'
@CH00035 EQU   @CF00035+2
@CF00059 DC    F'4'
@CH00059 EQU   @CF00059+2
@CF01104 DC    F'5'
@CH01104 EQU   @CF01104+2
@CF00048 DC    F'8'
@CH00048 EQU   @CF00048+2
@CF00033 DC    F'10'
@CH00033 EQU   @CF00033+2
@CF00034 DC    F'12'
@CF01110 DC    F'256'
@CF01197 DC    F'-8'
@CF01196 DC    F'-5'
@CF01192 DC    F'-4'
@CF00150 DC    XL4'01000000'
@CF01105 DC    XL4'80000000'
@CF01108 DC    XL4'44000000'
@CF01193 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
CORELEN  DS    F
CORESIZE DS    F
UPTPTR   DS    A
DAPB0PTR DS    A
DAPB1PTR DS    A
DAPB2PTR DS    A
DAPB3PTR DS    A
DACBPTR  DS    A
PSCBPTR  DS    A
S99RBPTR DS    AL4
         ORG   S99RBPTR
S99RBPND DS    BL1
         ORG   S99RBPTR+4
         DS    0D
@TS00001 DS    CL8
STATBUF  DS    CL1
TEMPAREA DS    CL3
SW       DS    BL1
         ORG   SW
QUIT     DS    BL1
         ORG   SW+1
         DS    CL3
TUPTRS   DS    CL120
         ORG   TUPTRS
TUP      DS    30A
         ORG   TUPTRS+120
TUDSN    DS    CL50
         ORG   TUDSN
@NM00003 DS    CL6
DSNBUF   DS    CL44
         ORG   TUDSN+50
TUEXPDT  DS    CL11
         ORG   TUEXPDT
@NM00004 DS    CL6
EXPDTPAR DS    CL5
         ORG   EXPDTPAR
YY       DS    CL2
DDD      DS    CL3
         ORG   TUEXPDT+11
         DS    CL3
CIRPARMS DS    CL100
         ORG   CIRPARMS
CIROPT   DS    CL1
@NM00005 DS    CL2
CIRLOCRC DS    AL1
CIRSRCH  DS    AL4
CIRCVOL  DS    AL4
CIRWA    DS    AL4
CIRSAVE  DS    AL4
CIRPSWD  DS    AL4
CIRRSA   DS    19A
         ORG   CIRPARMS+100
         DS    CL4
LOCPARM  DS    CL281
         ORG   LOCPARM
CTRL     DS    FL4
LOCDSPTR DS    AL4
NOPTION  DS    FL4
AREAPTR  DS    AL4
LOCAREA  DS    CL265
         ORG   LOCPARM+281
DDBLANK  DS    BL1
WORK     DS    CL1
         DS    CL1
S99RB    DS    CL20
         ORG   S99RB
S99RBLN  DS    CL1
S99VERB  DS    CL1
S99FLAG1 DS    CL2
         ORG   S99FLAG1
S99FLG11 DS    CL1
         ORG   S99FLG11
S99ONCNV DS    BL1
S99NOCNV EQU   S99FLG11+0
S99NOMNT EQU   S99FLG11+0
S99JBSYS EQU   S99FLG11+0
         ORG   S99FLAG1+1
S99FLG12 DS    CL1
         ORG   S99RB+4
S99RSC   DS    CL4
         ORG   S99RSC
S99ERROR DS    CL2
S99INFO  DS    CL2
         ORG   S99RB+8
S99TXTPP DS    AL4
S99RSV01 DS    FL4
S99FLAG2 DS    CL4
         ORG   S99FLAG2
S99FLG21 DS    CL1
         ORG   S99FLG21
S99WTVOL DS    BL1
S99WTDSN EQU   S99FLG21+0
S99NORES EQU   S99FLG21+0
S99WTUNT EQU   S99FLG21+0
S99OFFLN EQU   S99FLG21+0
S99TIONQ EQU   S99FLG21+0
S99CATLG EQU   S99FLG21+0
S99MOUNT EQU   S99FLG21+0
         ORG   S99FLAG2+1
S99FLG22 DS    CL1
         ORG   S99FLG22
S99UDEVT DS    BL1
S99PCINT EQU   S99FLG22+0
         ORG   S99FLAG2+2
S99FLG23 DS    CL1
S99FLG24 DS    CL1
         ORG   S99RB+20
DISPBUF  DS    CL1
TU       DS    30CL14
IEFDB4D0 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CB00155 DC    X'0004'
@CB00157 DC    X'0008'
@CB00159 DC    X'000C'
@CB00161 DC    X'0010'
@CB00163 DC    X'0014'
@CB00165 DC    X'0018'
@CB00167 DC    X'001C'
@CB00171 DC    X'0024'
@CB00173 DC    X'0028'
@CB00175 DC    X'002C'
@CB00177 DC    X'0034'
@CB00210 DC    X'0030'
@CB00248 DC    X'035C'
@CB00262 DC    X'037C'
@CB00280 DC    X'0410'
@CB00284 DC    X'0424'
@CB00286 DC    X'0434'
@CB00288 DC    X'0438'
@CB00290 DC    X'043C'
@CB00292 DC    X'0440'
@CB00296 DC    X'0448'
@CB00298 DC    X'044C'
@CB00300 DC    X'0450'
@CB00302 DC    X'0454'
@CB00306 DC    X'045C'
@CB00894 DC    X'0001'
@CB00896 DC    X'0002'
@CB00898 DC    X'0003'
@CB00901 DC    X'0005'
@CB00903 DC    X'0006'
@CB00905 DC    X'0007'
@CB00908 DC    X'0009'
@CB00910 DC    X'000A'
@CB00912 DC    X'000B'
@CB00915 DC    X'000D'
@CB00917 DC    X'000E'
@CB00919 DC    X'000F'
@CB00929 DC    X'0015'
@CB00936 DC    X'0019'
@CB00938 DC    X'001A'
@CB00950 DC    X'0021'
@CB00952 DC    X'0022'
@CB00971 DC    X'002D'
@CB00973 DC    X'002E'
@CB00975 DC    X'002F'
@CB00980 DC    X'0032'
@CB01001 DC    X'003D'
@CB01007 DC    X'0040'
@CB01011 DC    X'0042'
@CB01015 DC    X'0044'
@CB01017 DC    X'0045'
@CB01025 DC    X'0049'
@CB01039 DC    X'0050'
@CB01043 DC    X'0052'
@CB01049 DC    X'0055'
@CB01051 DC    X'0056'
@CB01053 DC    X'0057'
@CB01101 DC    X'0000'
IEFDB4D0 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFDB4D0 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
S99TUFP  EQU   @08
DSNRTCD  EQU   @03
DEFADDR  EQU   @06
RTRNLEN  EQU   @03
NUMLEVEL EQU   @08
RETCODE  EQU   @05
I        EQU   @06
DAPLPTR  EQU   @07
BLOCKPTR EQU   @02
R0       EQU   @00
R1       EQU   @01
R4       EQU   @04
R15      EQU   @15
DAPL     EQU   0
DAPLUPT  EQU   DAPL
DAPLPSCB EQU   DAPL+12
DAPLDAPB EQU   DAPL+16
@NM00001 EQU   0
DA14AREA EQU   @NM00001
DA14LEVL EQU   DA14AREA
@NM00002 EQU   0
DA30DSNL EQU   @NM00002
DA30DSN  EQU   @NM00002+2
DA28OPTR EQU   0
DAIRCODE EQU   0
DSNB     EQU   0
DSNL     EQU   DSNB
DSN      EQU   DSNB+2
CIRRETRN EQU   0
CIRHDR   EQU   CIRRETRN
CIRLEN   EQU   CIRHDR
CIRENT   EQU   CIRRETRN+4
CIRID    EQU   CIRENT
CIRNAME  EQU   CIRENT+1
DEFAULTS EQU   0
DEFSPACE EQU   DEFAULTS
DEFPQTY  EQU   DEFSPACE
DEFSQTY  EQU   DEFSPACE+3
DEFDRLH  EQU   DEFSPACE+6
@NM00006 EQU   DEFSPACE+12
DEFTRK   EQU   @NM00006
DEFCYL   EQU   @NM00006
DEFBLKLN EQU   @NM00006
DEFRLSE  EQU   @NM00006
DEFCONTG EQU   @NM00006
DEFMIXG  EQU   @NM00006
DEFALX   EQU   @NM00006
DEFROUND EQU   @NM00006
DA0CDDN  EQU   0
DAPB00   EQU   0
DA00FLG  EQU   DAPB00+2
DA00PERM EQU   DA00FLG
DA00DSE  EQU   DA00FLG
DA00TERM EQU   DA00FLG
DA00PDSN EQU   DAPB00+4
DA00DDN  EQU   DAPB00+8
DA00CTL  EQU   DAPB00+16
DA00DSO  EQU   DAPB00+19
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTPREFX EQU   UPT+16
UPTPREFL EQU   UPT+23
DAPB04   EQU   0
DA04FLG  EQU   DAPB04+2
DA04CAT  EQU   DA04FLG
DA04DSE  EQU   DA04FLG
DA04CTRC EQU   DAPB04+6
DA04PDSN EQU   DAPB04+8
DA04CTL  EQU   DAPB04+12
DA04DSO  EQU   DAPB04+15
DAPB08   EQU   0
DA08FLG  EQU   DAPB08+2
DA08DARC EQU   DAPB08+4
DA08CTRC EQU   DAPB08+6
DA08PDSN EQU   DAPB08+8
DA08DDN  EQU   DAPB08+12
DA08UNIT EQU   DAPB08+20
DA08SER  EQU   DAPB08+28
DA08BLK  EQU   DAPB08+36
DA08PQTY EQU   DAPB08+40
DA08SQTY EQU   DAPB08+44
DA08DQTY EQU   DAPB08+48
DA08MNM  EQU   DAPB08+52
DA08PSWD EQU   DAPB08+60
DA08DSP1 EQU   DAPB08+68
DA08DPS2 EQU   DAPB08+69
DA08DPS3 EQU   DAPB08+70
DA08CTL  EQU   DAPB08+71
DA08TRKS EQU   DA08CTL
DA08ABKL EQU   DA08CTL
DA08RLSE EQU   DA08CTL
DA08PERM EQU   DA08CTL
DA08DMMY EQU   DA08CTL
DA08ATRL EQU   DA08CTL
DA08DSO  EQU   DAPB08+75
DA08ALN  EQU   DAPB08+76
DAPB0C   EQU   0
DA0CDARC EQU   DAPB0C+4
DA0CNUMB EQU   DAPB0C+8
DAPB10   EQU   0
DA10DARC EQU   DAPB10+4
DA10DDN  EQU   DAPB10+8
DAPB14   EQU   0
DA14PDSN EQU   DAPB14+4
DA14PRET EQU   DAPB14+8
DA14CTL  EQU   DAPB14+12
DAPB18   EQU   0
DA18FLG  EQU   DAPB18+2
DA18FPE  EQU   DA18FLG
DA18DARC EQU   DAPB18+4
DA18CTRC EQU   DAPB18+6
DA18PDSN EQU   DAPB18+8
DA18DDN  EQU   DAPB18+12
DA18MNM  EQU   DAPB18+20
DA18SCLS EQU   DAPB18+28
DA18DPS2 EQU   DAPB18+30
DA18CTL  EQU   DAPB18+31
DA18PERM EQU   DA18CTL
DAPB1C   EQU   0
DA1CDARC EQU   DAPB1C+4
DA1CCTL  EQU   DAPB1C+7
DA1CPERM EQU   DA1CCTL
DA1CATRL EQU   DA1CCTL
DA1CDDN  EQU   DAPB1C+8
DA1CALN  EQU   DAPB1C+16
DAPB24   EQU   0
DA24FLG  EQU   DAPB24+2
DA24DMY  EQU   DA24FLG
DA24DARC EQU   DAPB24+4
DA24CTRC EQU   DAPB24+6
DA24PDSN EQU   DAPB24+8
DA24DDN  EQU   DAPB24+12
DA24DSP1 EQU   DAPB24+68
DA24DPS2 EQU   DAPB24+69
DA24DPS3 EQU   DAPB24+70
DA24CTL  EQU   DAPB24+71
DA24DSO  EQU   DAPB24+75
DAPB28   EQU   0
DA28NOP  EQU   DAPB28+2
DA28PFOP EQU   DAPB28+4
DAPB2C   EQU   0
DA2CFLG  EQU   DAPB2C+2
DA2CTCB  EQU   DAPB2C+4
DA2CDDN  EQU   DAPB2C+8
DAPB30   EQU   0
DA30FLG  EQU   DAPB30+2
DA30DARC EQU   DAPB30+4
DA30PDSN EQU   DAPB30+8
DA30DDN  EQU   DAPB30+12
DA30UNIT EQU   DAPB30+20
DA30BLK  EQU   DAPB30+36
DA30PQTY EQU   DAPB30+40
DA30SQTY EQU   DAPB30+44
DA30PGNM EQU   DAPB30+48
DA30FORM EQU   DAPB30+56
DA30CTL  EQU   DAPB30+63
DA30TRKS EQU   DA30CTL
DA30ABKL EQU   DA30CTL
DA30RLSE EQU   DA30CTL
DA30PERM EQU   DA30CTL
DA30DMMY EQU   DA30CTL
DA30ATRL EQU   DA30CTL
DA30ALN  EQU   DAPB30+64
DAPB34   EQU   0
DA34FLG  EQU   DAPB34+2
DA34FIND EQU   DA34FLG
DA34DARC EQU   DAPB34+4
DA34CTRL EQU   DAPB34+6
DA34SRCH EQU   DA34CTRL
DA34CHN  EQU   DA34CTRL
DA34UNCH EQU   DA34CTRL
DA34NAME EQU   DAPB34+8
DA34ADDR EQU   DAPB34+16
DAIRACB  EQU   0
DAIMASK  EQU   DAIRACB+8
DAILABEL EQU   DAIMASK+6
DAIEXPDT EQU   DAIRACB+19
DAIYEAR  EQU   DAIEXPDT
DAIDAY   EQU   DAIEXPDT+1
DAIBUFNO EQU   DAIRACB+24
DAIBFTEK EQU   DAIRACB+25
DAIBFALN EQU   DAIBFTEK
DAIAUTO  EQU   DAIBFALN
DAIBUFL  EQU   DAIRACB+26
DAIEROPT EQU   DAIRACB+28
DAIKEYLE EQU   DAIRACB+29
DAIRECFM EQU   DAIRACB+36
DAIUNDEF EQU   DAIRECFM
DAIOPTCD EQU   DAIRACB+37
DAIBLKSI EQU   DAIRACB+38
DAILRECL EQU   DAIRACB+40
DAINCP   EQU   DAIRACB+42
PSCB     EQU   0
PSCBATR1 EQU   PSCB+16
S99TUPL  EQU   0
S99TUPTR EQU   S99TUPL
S99TUP   EQU   0
S99TUNIT EQU   0
S99TUKEY EQU   S99TUNIT
S99TUNUM EQU   S99TUNIT+2
S99TUENT EQU   S99TUNIT+4
S99TULNG EQU   S99TUENT
S99TUPAR EQU   S99TUENT+2
S99TUFLD EQU   0
S99TULEN EQU   S99TUFLD
S99TUPRM EQU   S99TUFLD+2
DSNP     EQU   0
UBYTE    EQU   0
PREFIXU  EQU   UBYTE
DA14QLEN EQU   DA14AREA
@NM00007 EQU   S99TUPAR
PODSORG  EQU   @NM00007
@NM00010 EQU   S99TUPAR
PERMALOC EQU   @NM00010
@NM00012 EQU   S99TUPAR
TERMINAL EQU   @NM00012
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00013 EQU   @NM00012
@NM00011 EQU   @NM00010
@NM00008 EQU   @NM00007
@NM00009 EQU   UBYTE
S99TUPND EQU   S99TUP
S99TUPLN EQU   S99TUPTR
PSCBU    EQU   PSCB+64
PSCBRSZ  EQU   PSCB+60
PSCBLINE EQU   PSCB+59
PSCBCHAR EQU   PSCB+58
PSCBUPTL EQU   PSCB+56
PSCBUPT  EQU   PSCB+52
PSCBRLGB EQU   PSCB+48
PSCBDEST EQU   PSCB+40
@NM00145 EQU   PSCB+36
@NM00144 EQU   PSCB+32
@NM00143 EQU   PSCB+28
PSCBLTI2 EQU   PSCB+24
PSCBLTIM EQU   PSCB+20
PSCBATR2 EQU   PSCB+18
@NM00142 EQU   PSCBATR1
@NM00141 EQU   PSCBATR1
@NM00140 EQU   PSCBATR1
PSCBATTN EQU   PSCBATR1
PSCBVMNT EQU   PSCBATR1
PSCBJCL  EQU   PSCBATR1
PSCBACCT EQU   PSCBATR1
PSCBCTRL EQU   PSCBATR1
PSCBGPNM EQU   PSCB+8
PSCBUSRL EQU   PSCB+7
PSCBUSER EQU   PSCB
@NM00139 EQU   DAIRACB+43
DAIUSERT EQU   DAIOPTCD
@NM00138 EQU   DAIOPTCD
DAIANSI  EQU   DAIOPTCD
@NM00137 EQU   DAIOPTCD
DAISCHED EQU   DAIOPTCD
@NM00136 EQU   DAIOPTCD
DAIWRTCK EQU   DAIOPTCD
DAIMACH  EQU   DAIRECFM
DAIASA   EQU   DAIRECFM
DAISTAND EQU   DAIRECFM
DAIBLOCK EQU   DAIRECFM
DAITRKOV EQU   DAIRECFM
DAIVARIB EQU   DAIUNDEF
DAIFIXED EQU   DAIUNDEF
@NM00135 EQU   DAIRACB+30
DAIABNOR EQU   DAIEROPT
DAISKIP  EQU   DAIEROPT
DAIACEPT EQU   DAIEROPT
DAIFULL  EQU   DAIBFALN
DAIDOUBL EQU   DAIBFALN
@NM00134 EQU   DAIBFALN
DAIEXC   EQU   DAIBFALN
DAIRECRD EQU   DAIAUTO
DAISIMPL EQU   DAIAUTO
@NM00133 EQU   DAIBFALN
@NM00132 EQU   DAIRACB+22
@NM00131 EQU   DAIRACB+16
@NM00130 EQU   DAIMASK+7
DAIOUTIN EQU   DAILABEL
DAIINOUT EQU   DAILABEL
@NM00129 EQU   DAIMASK
@NM00128 EQU   DAIRACB
@NM00127 EQU   DAPB34+7
DA34CD   EQU   DAPB34
@NM00126 EQU   DA30CTL
DA30UID  EQU   DA30CTL
@NM00125 EQU   DAPB30+62
DA30OCLS EQU   DAPB30+60
DA30SER  EQU   DAPB30+28
@NM00124 EQU   DAPB30+6
@NM00123 EQU   DA30FLG
@NM00122 EQU   DA30FLG
@NM00121 EQU   DA30FLG
@NM00120 EQU   DA30FLG
@NM00119 EQU   DA30FLG
@NM00118 EQU   DA30FLG
@NM00117 EQU   DA30FLG
DA30FPE  EQU   DA30FLG
DA30CD   EQU   DAPB30
DA2CCD   EQU   DAPB2C
DA28CD   EQU   DAPB28
DA24ALN  EQU   DAPB24+76
@NM00116 EQU   DAPB24+72
@NM00115 EQU   DA24CTL
DA24ATRL EQU   DA24CTL
DA24DMMY EQU   DA24CTL
DA24PERM EQU   DA24CTL
DA24RLSE EQU   DA24CTL
DA24UID  EQU   DA24CTL
DA24ABKL EQU   DA24CTL
DA24TRKS EQU   DA24CTL
DA24UNCT EQU   DA24DPS3
DA24CATL EQU   DA24DPS3
DA24DELE EQU   DA24DPS3
DA24KEP  EQU   DA24DPS3
@NM00114 EQU   DA24DPS3
@NM00113 EQU   DA24DPS3
@NM00112 EQU   DA24DPS3
@NM00111 EQU   DA24DPS3
DA24UCAT EQU   DA24DPS2
DA24CAT  EQU   DA24DPS2
DA24DEL  EQU   DA24DPS2
DA24KEEP EQU   DA24DPS2
@NM00110 EQU   DA24DPS2
@NM00109 EQU   DA24DPS2
@NM00108 EQU   DA24DPS2
@NM00107 EQU   DA24DPS2
DA24OLD  EQU   DA24DSP1
DA24MOD  EQU   DA24DSP1
DA24NEW  EQU   DA24DSP1
DA24SHR  EQU   DA24DSP1
@NM00106 EQU   DA24DSP1
@NM00105 EQU   DA24DSP1
@NM00104 EQU   DA24DSP1
@NM00103 EQU   DA24DSP1
DA24PSWD EQU   DAPB24+60
DA24MNM  EQU   DAPB24+52
DA24DQTY EQU   DAPB24+48
DA24SQTY EQU   DAPB24+44
DA24PQTY EQU   DAPB24+40
DA24BLK  EQU   DAPB24+36
DA24SER  EQU   DAPB24+28
DA24UNIT EQU   DAPB24+20
@NM00102 EQU   DA24FLG
@NM00101 EQU   DA24FLG
@NM00100 EQU   DA24FLG
@NM00099 EQU   DA24FLG
@NM00098 EQU   DA24FLG
@NM00097 EQU   DA24FLG
DA24FPE  EQU   DA24FLG
DA24CD   EQU   DAPB24
@NM00096 EQU   DA1CCTL
@NM00095 EQU   DA1CCTL
@NM00094 EQU   DA1CCTL
@NM00093 EQU   DAPB1C+6
DA1CFLG  EQU   DAPB1C+2
DA1CCD   EQU   DAPB1C
DA18JBNM EQU   DAPB18+32
@NM00092 EQU   DA18CTL
@NM00091 EQU   DA18CTL
@NM00090 EQU   DA18CTL
@NM00089 EQU   DA18CTL
DA18UID  EQU   DA18CTL
@NM00088 EQU   DA18CTL
@NM00087 EQU   DA18CTL
DA18UCAT EQU   DA18DPS2
DA18CAT  EQU   DA18DPS2
DA18DEL  EQU   DA18DPS2
DA18KEEP EQU   DA18DPS2
@NM00086 EQU   DA18DPS2
@NM00085 EQU   DA18DPS2
@NM00084 EQU   DA18DPS2
@NM00083 EQU   DA18DPS2
@NM00082 EQU   DA18FLG
@NM00081 EQU   DA18FLG
@NM00080 EQU   DA18FLG
@NM00079 EQU   DA18FLG
@NM00078 EQU   DA18FLG
@NM00077 EQU   DA18FLG
@NM00076 EQU   DA18FLG
DA18CD   EQU   DAPB18
@NM00075 EQU   DAPB14+13
@NM00074 EQU   DA14CTL
@NM00073 EQU   DA14CTL
@NM00072 EQU   DA14CTL
@NM00071 EQU   DA14CTL
@NM00070 EQU   DA14CTL
DA14UID  EQU   DA14CTL
@NM00069 EQU   DA14CTL
@NM00068 EQU   DA14CTL
DA14FLG  EQU   DAPB14+2
DA14CD   EQU   DAPB14
@NM00067 EQU   DAPB10+6
DA10FLG  EQU   DAPB10+2
DA10CD   EQU   DAPB10
@NM00066 EQU   DAPB0C+10
@NM00065 EQU   DAPB0C+6
DA0CFLG  EQU   DAPB0C+2
DA0CCD   EQU   DAPB0C
@NM00064 EQU   DAPB08+72
@NM00063 EQU   DA08CTL
DA08UID  EQU   DA08CTL
DA08UNCT EQU   DA08DPS3
DA08CATL EQU   DA08DPS3
DA08DELE EQU   DA08DPS3
DA08KEP  EQU   DA08DPS3
@NM00062 EQU   DA08DPS3
@NM00061 EQU   DA08DPS3
@NM00060 EQU   DA08DPS3
@NM00059 EQU   DA08DPS3
DA08UCAT EQU   DA08DPS2
DA08CAT  EQU   DA08DPS2
DA08DEL  EQU   DA08DPS2
DA08KEEP EQU   DA08DPS2
@NM00058 EQU   DA08DPS2
@NM00057 EQU   DA08DPS2
@NM00056 EQU   DA08DPS2
@NM00055 EQU   DA08DPS2
DA08OLD  EQU   DA08DSP1
DA08MOD  EQU   DA08DSP1
DA08NEW  EQU   DA08DSP1
DA08SHR  EQU   DA08DSP1
@NM00054 EQU   DA08DSP1
@NM00053 EQU   DA08DSP1
@NM00052 EQU   DA08DSP1
@NM00051 EQU   DA08DSP1
@NM00050 EQU   DA08FLG
@NM00049 EQU   DA08FLG
@NM00048 EQU   DA08FLG
@NM00047 EQU   DA08FLG
@NM00046 EQU   DA08FLG
@NM00045 EQU   DA08FLG
@NM00044 EQU   DA08FLG
DA08FPE  EQU   DA08FLG
DA08CD   EQU   DAPB08
@NM00043 EQU   DAPB04+13
@NM00042 EQU   DA04CTL
@NM00041 EQU   DA04CTL
@NM00040 EQU   DA04CTL
@NM00039 EQU   DA04CTL
@NM00038 EQU   DA04CTL
DA04UID  EQU   DA04CTL
@NM00037 EQU   DA04CTL
@NM00036 EQU   DA04CTL
@NM00035 EQU   DAPB04+4
@NM00034 EQU   DA04FLG
@NM00033 EQU   DA04FLG
@NM00032 EQU   DA04FLG
@NM00031 EQU   DA04FLG
@NM00030 EQU   DA04FLG
@NM00029 EQU   DA04FLG
DA04CD   EQU   DAPB04
@NM00016 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
@NM00015 EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00014 EQU   UPT
@NM00028 EQU   DAPB00+17
@NM00027 EQU   DA00CTL
@NM00026 EQU   DA00CTL
@NM00025 EQU   DA00CTL
@NM00024 EQU   DA00CTL
@NM00023 EQU   DA00CTL
DA00UID  EQU   DA00CTL
@NM00022 EQU   DA00CTL
@NM00021 EQU   DA00CTL
DA00DYNM EQU   DA00FLG
@NM00020 EQU   DA00FLG
@NM00019 EQU   DA00FLG
@NM00018 EQU   DA00FLG
@NM00017 EQU   DA00FLG
DA00CD   EQU   DAPB00
DEFUNIT  EQU   DEFAULTS+13
DEFDQTY  EQU   DEFSPACE+9
CIRRLEN  EQU   CIRHDR+2
DAPLECB  EQU   DAPL+8
DAPLECT  EQU   DAPL+4
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00095 EQU   @RC00094
@RC00103 EQU   @RC00094
@RC00101 EQU   @RC00094
@RF00173 EQU   @RC00166
@RF00172 EQU   @RC00166
@RC00225 EQU   @RC00216
@RF00365 EQU   @RC00360
@RF00396 EQU   @RC00387
@RC00470 EQU   @RC00469
@RC00490 EQU   @RC00489
@RC00588 EQU   @RC00587
@RC00651 EQU   @RC00650
@RF00686 EQU   @RC00674
@RF00702 EQU   @RC00689
@RF00869 EQU   @RC00863
@RF00916 EQU   @RC00899
@RC01062 EQU   @RC00919
@RC01060 EQU   @RC00919
@RF01059 EQU   @RC00919
@RC01092 EQU   @RC01071
@RF01091 EQU   @RC01071
@RC01127 EQU   @RC01126
@RF01331 EQU   @RC01241
@RF01514 EQU   @EL00002
@RF00670 EQU   @RC00651
@ENDDATA EQU   *
         END   IEFDB4D0,(C'PLS1813',0701,76202)

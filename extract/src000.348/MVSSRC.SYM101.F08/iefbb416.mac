         TITLE 'IEFBB416 - JOB UNALLOCATION                            *
                        '
IEFBB416 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(24)                                          01S0001
         DC    C'IEFBB416 78124  UZ18622 '                      01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @11,0                                            01S0001
@PSTART  LA    @12,4095(,@11)                                   01S0001
         USING @PSTART,@11                                      01S0001
         USING @PSTART+4095,@12                                 01S0001
         L     @00,@SIZDATD                                     01S0001
         GSPACE   R,LV=(0)
         LR    @10,@01                                          01S0001
         USING @DATD,@10                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         LM    @00,@01,20(@13)                                  01S0001
         ST    @10,8(,@13)                                      01S0001
         LR    @13,@10                                          01S0001
         MVC   @PC00001(28),0(@01)                              01S0001
*ESTAJOB = OFF;                        /*JOB UNALLOC TRIED           */
*ESTAJOBU = ON;                        /*PVT VOL UNLOAD NOT TRIED    */
         L     @03,@PC00001+12                                  01S0082
         L     @03,ESTAPTR(,@03)                                01S0082
         OI    ESTAJOBU(@03),B'00100000'                        01S0082
         NI    ESTAJOB(@03),B'11101111'                         01S0082
*RETCODE = ZERO;                       /* INIT RETURN CODE           */
         SLR   @03,@03                                          01S0083
         STH   @03,RETCODE                                      01S0083
*FRBPTR = ZERO;                        /* INIT FIRST RB PTR          */
         ST    @03,FRBPTR                                       01S0084
*NUMREQS = ZERO;                       /* INIT NUMBER OF REQUESTS    */
         SLR   NUMREQS,NUMREQS                                  01S0085
*IF JOBDSPRC = ON THEN                 /* DO DISPOSITION PROCESSING  */
         L     @03,@PC00001                                     01S0086
         TM    JOBDSPRC(@03),B'00100000'                        01S0086
         BNO   @RF00086                                         01S0086
*  DO;                                                          01S0087
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - READPDIS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - LOCATE THE PDIS, SIOTS, JFCBS, AND JFCBXS     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO LOCATE EACH PDI BLOCK       */
*/*   AND ASSOCIATED SIOTS. FOR ALL NON-DUMMY DATA SETS,     @YM07452*/
*/*   IF THE 'PASS' INDICATOR IS ON IN THE PDI ENTRY                 */
*/*   OR THE DISPOSITION-HAS-BEEN-PROCESSED INDICATOR IS OFF         */
*/*   IN THE SIOT, THE SIOT IS CHAINED TO THE PDI ENTRY AND THE      */
*/*   JFCB AND JFCBXS ARE LOCATED AND CHAINED TO THE SIOT.           */
*/*   THESE SIOTS THAT ARE CHAINED TO THE PDI ENTRIES WILL HAVE      */
*/*   THEIR DISPOSITIONS PROCESSED BY JOB UNALLOCATION. ALL OTHER    */
*/*   SIOTS ARE IGNORED.                                             */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JCT -                                                        */
*/*       JCTPDIP - SVA OF FIRST PDI BLOCK                           */
*/*                                                                  */
*/*     PDI -                                                        */
*/*       PDICTR - NUMBER OF PDI ENTRIES IN THE PDI BLOCK            */
*/*                                                                  */
*/*       PDI ENTRY -                                                */
*/*         PDISIOTA - SVA OF THE ASSOCIATED SIOT                    */
*/*         PDIPASIN - PASS BIT (ON IF PASSED, OFF IF RECEIVED)      */
*/*                                                                  */
*/*       PDIBNXTP - ADDR OF THE NEXT PDI BLOCK                      */
*/*                                                                  */
*/*     SIOT -                                                       */
*/*       SIOTDSPD - DISPOSITION-HAS-BEEN-PROCESSED BIT              */
*/*                                                                  */
*/*       SCTPJFCB - SVA OF THE JFCB                                 */
*/*                                                                  */
*/*     JFCB -                                                       */
*/*       JFCBEXAD - SVA OF THE FIRST JFCB EXTENSION OF ZERO         */
*/*                                                                  */
*/*     JFCBX -                                                      */
*/*       JFCBXTTR - SVA OF THE NEXT JFCBX                           */
*/*                                                                  */
*/* EXITS -                                                          */
*/*   CONDITION - NORMAL COMPLETION                                  */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*                                                                  */
*/*     PDI -                                                        */
*/*                                                                  */
*/*       PDI ENTRY -                                                */
*/*         PDISIOTP - ADDRESS OF THE ASSOCIATED SIOT                */
*/*                                                                  */
*/*     SIOT -                                                       */
*/*       SJFCBPTR - JFCB ADDRESS                                    */
*/*       SIOTJFX - FIRST JFCBX ADDRESS                              */
*/*                                                                  */
*/*     JFCBX -                                                      */
*/*       JFCBXNXT - ADDRESS OF THE NEXT JFCBX                       */
*/*                                                                  */
*/*     NUMREQS - NUMBER OF REQUESTS TO BE PROCESSED BY JOB          */
*/*       UNALLOCATION                                               */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/********************************************************************/
*IF JCTPDIP ^= ZERO THEN               /* PDI EXISTS                 */
         L     @03,@PC00001+8                                   02S0088
         L     @03,JCTPTR(,@03)                                 02S0088
         ICM   @15,7,JCTPDIP(@03)                               02S0088
         BZ    @RF00088                                         02S0088
*  DO;                                 /* READ IN THE PDI            */
*    CALL IEFAB4EB                     /* READ THE PDI               */
*       (JCTPDIP,FPDIPTR,LPDIPTR,LEPAPTR);                      02S0090
         L     @15,@PC00001+8                                   02S0090
         L     @15,JCTPTR(,@15)                                 02S0090
         LA    @15,JCTPDIP(,@15)                                02S0090
         ST    @15,@AL00001                                     02S0090
         LA    @15,FPDIPTR                                      02S0090
         ST    @15,@AL00001+4                                   02S0090
         LA    @15,LPDIPTR                                      02S0090
         ST    @15,@AL00001+8                                   02S0090
         L     @15,@PC00001+16                                  02S0090
         ST    @15,@AL00001+12                                  02S0090
         L     @15,@CV00188                                     02S0090
         LA    @01,@AL00001                                     02S0090
         BALR  @14,@15                                          02S0090
*    PDIBLPTR = FPDIPTR;               /* BASE FOR FIRST PDI BLOCK   */
         L     PDIBLPTR,FPDIPTR                                 02S0091
*    DO WHILE (PDIBLPTR ^= ZERO );     /* ALL BLOCKS PROCESSED       */
         B     @DE00092                                         02S0092
@DL00092 DS    0H                                               02S0093
*      DO PDIECTR = ONE TO PDICTR;     /* ALL PDIES IN PDI BLOCK     */
         LA    PDIECTR,1                                        02S0093
         B     @DE00093                                         02S0093
@DL00093 DS    0H                                               02S0094
*        SWACTLS = SWACTLS && SWACTLS; /* CLEAR 4F7 FUNCTION MAP     */
         SLR   @05,@05                                          02S0094
         ICM   @05,3,SWACTLS                                    02S0094
         LR    @15,@05                                          02S0094
         XR    @15,@05                                          02S0094
         STH   @15,SWACTLS                                      02S0094
*        SWREAD = ON;                  /* READ A BLOCK               */
*        SWNEW = ON;                   /* CREATE AN EPA              */
*        SWFREE = ON;                  /* CHAIN THE EPA              */
         OI    SWREAD,B'00101100'                               02S0097
*        CALL IEFAB4F7                 /* READ THE ASSOCIATED SIOT   */
*           (SWACTLS,ZERO,ZERO,ADDR(PDISIOTA(PDIECTR)),         02S0098
*            ADDR(SIOTPTR),SWBLKLN,ONE);                        02S0098
         LA    @05,SWACTLS                                      02S0098
         ST    @05,@AL00001                                     02S0098
         LA    @05,@CF00184                                     02S0098
         ST    @05,@AL00001+4                                   02S0098
         LA    @05,@CF00184                                     02S0098
         ST    @05,@AL00001+8                                   02S0098
         LR    @05,PDIECTR                                      02S0098
         MH    @05,@CH01659                                     02S0098
         LA    @05,PDISIOTA-48(@05,PDIBLPTR)                    02S0098
         ST    @05,@TF00001                                     02S0098
         LA    @05,@TF00001                                     02S0098
         ST    @05,@AL00001+12                                  02S0098
         LA    @05,SIOTPTR                                      02S0098
         ST    @05,@TF00002                                     02S0098
         LA    @05,@TF00002                                     02S0098
         ST    @05,@AL00001+16                                  02S0098
         LA    @05,SWBLKLN                                      02S0098
         ST    @05,@AL00001+20                                  02S0098
         LA    @05,@CF00056                                     02S0098
         ST    @05,@AL00001+24                                  02S0098
         L     @15,@CV00191                                     02S0098
         LA    @01,@AL00001                                     02S0098
         BALR  @14,@15                                          02S0098
*        IF SCTDUMMY = OFF &           /* NOT DUMMY          @YM07452*/
*           (PDIPASIN(PDIECTR) = ON ×  /* PASSED, NOT RECEIVED       */
*            SIOTDSPD = OFF) THEN      /* DISP NOT PROCESSED         */
         L     @05,SIOTPTR                                      02S0099
         TM    SCTDUMMY(@05),B'10000000'                        02S0099
         BNZ   @RF00099                                         02S0099
         LR    @15,PDIECTR                                      02S0099
         MH    @15,@CH01659                                     02S0099
         ALR   @15,PDIBLPTR                                     02S0099
         AL    @15,@CF01946                                     02S0099
         TM    PDIPASIN-44(@15),B'00100000'                     02S0099
         BO    @RT00099                                         02S0099
         TM    SIOTDSPD(@05),B'01000000'                        02S0099
         BNZ   @RF00099                                         02S0099
@RT00099 DS    0H                                               02S0100
*          DO;                         /* READ THE JFCB              */
*            PDISIOTP(PDIECTR) = SIOTPTR; /* SET PDI PTR TO SIOT     */
         L     @15,SIOTPTR                                      02S0101
         LR    @14,PDIECTR                                      02S0101
         MH    @14,@CH01659                                     02S0101
         ST    @15,PDISIOTP-48(@14,PDIBLPTR)                    02S0101
*            CALL IEFAB4F7             /* READ THE JFCB              */
*               (SWACTLS,ZERO,ZERO,ADDR(SCTPJFCB),              02S0102
*                ADDR(SJFCBPTR),SWBLKLN,ONE);                   02S0102
         LA    @14,SWACTLS                                      02S0102
         ST    @14,@AL00001                                     02S0102
         LA    @14,@CF00184                                     02S0102
         ST    @14,@AL00001+4                                   02S0102
         LA    @14,@CF00184                                     02S0102
         ST    @14,@AL00001+8                                   02S0102
         LA    @14,SCTPJFCB(,@15)                               02S0102
         ST    @14,@TF00001                                     02S0102
         LA    @14,@TF00001                                     02S0102
         ST    @14,@AL00001+12                                  02S0102
         LA    @15,SJFCBPTR(,@15)                               02S0102
         ST    @15,@TF00002                                     02S0102
         LA    @15,@TF00002                                     02S0102
         ST    @15,@AL00001+16                                  02S0102
         LA    @15,SWBLKLN                                      02S0102
         ST    @15,@AL00001+20                                  02S0102
         LA    @15,@CF00056                                     02S0102
         ST    @15,@AL00001+24                                  02S0102
         L     @15,@CV00191                                     02S0102
         LA    @01,@AL00001                                     02S0102
         BALR  @14,@15                                          02S0102
*            JFCBPTR = SJFCBPTR;                                02S0103
         L     @15,SIOTPTR                                      02S0103
         L     JFCBPTR,SJFCBPTR(,@15)                           02S0103
*            IF JFCBEXAD ^= ZERO THEN  /* JFCBXS EXIST               */
         ICM   @14,7,JFCBEXAD(JFCBPTR)                          02S0104
         BZ    @RF00104                                         02S0104
*              DO;                     /* LOCATE THE JFCBXS          */
*                CALL IEFAB4F7         /* READ THE FIRST JFCBX       */
*                   (SWACTLS,ZERO,ZERO,ADDR(JFCBEXAD),          02S0106
*                    ADDR(SIOTJFX),SWBLKLN,ONE);                02S0106
         LA    @14,SWACTLS                                      02S0106
         ST    @14,@AL00001                                     02S0106
         LA    @14,@CF00184                                     02S0106
         ST    @14,@AL00001+4                                   02S0106
         LA    @14,@CF00184                                     02S0106
         ST    @14,@AL00001+8                                   02S0106
         LA    @14,JFCBEXAD(,JFCBPTR)                           02S0106
         ST    @14,@TF00001                                     02S0106
         LA    @14,@TF00001                                     02S0106
         ST    @14,@AL00001+12                                  02S0106
         LA    @15,SIOTJFX(,@15)                                02S0106
         ST    @15,@TF00002                                     02S0106
         LA    @15,@TF00002                                     02S0106
         ST    @15,@AL00001+16                                  02S0106
         LA    @15,SWBLKLN                                      02S0106
         ST    @15,@AL00001+20                                  02S0106
         LA    @15,@CF00056                                     02S0106
         ST    @15,@AL00001+24                                  02S0106
         L     @15,@CV00191                                     02S0106
         LA    @01,@AL00001                                     02S0106
         BALR  @14,@15                                          02S0106
*                JFCBXPTR = SIOTJFX;                            02S0107
         L     @05,SIOTPTR                                      02S0107
         MVC   JFCBXPTR(4),SIOTJFX(@05)                         02S0107
*                DO WHILE (JFCBXTTR ^= ZERO); /* LAST JFCBX READ     */
         B     @DE00108                                         02S0108
@DL00108 DS    0H                                               02S0109
*                  CALL IEFAB4F7       /* READ IN A JFCBX            */
*                     (SWACTLS,ZERO,ZERO,                       02S0109
*                      ADDR(JFCBXTTR),ADDR(JFCBXNXT),SWBLKLN,ONE);
         LA    @05,SWACTLS                                      02S0109
         ST    @05,@AL00001                                     02S0109
         LA    @05,@CF00184                                     02S0109
         ST    @05,@AL00001+4                                   02S0109
         LA    @05,@CF00184                                     02S0109
         ST    @05,@AL00001+8                                   02S0109
         LA    @05,JFCBXPTR                                     02S0109
         ST    @05,@AL00001+12                                  02S0109
         L     @05,JFCBXPTR                                     02S0109
         LA    @05,JFCBXNXT(,@05)                               02S0109
         ST    @05,@TF00001                                     02S0109
         LA    @05,@TF00001                                     02S0109
         ST    @05,@AL00001+16                                  02S0109
         LA    @05,SWBLKLN                                      02S0109
         ST    @05,@AL00001+20                                  02S0109
         LA    @05,@CF00056                                     02S0109
         ST    @05,@AL00001+24                                  02S0109
         L     @15,@CV00191                                     02S0109
         LA    @01,@AL00001                                     02S0109
         BALR  @14,@15                                          02S0109
*                  JFCBXPTR = JFCBXNXT;                         02S0110
         L     @05,JFCBXPTR                                     02S0110
         L     @05,JFCBXNXT(,@05)                               02S0110
         ST    @05,JFCBXPTR                                     02S0110
*                END;                                           02S0111
@DE00108 L     @05,JFCBXPTR                                     02S0111
         ICM   @15,7,JFCBXTTR(@05)                              02S0111
         BNZ   @DL00108                                         02S0111
*              END;                                             02S0112
*            NUMREQS = NUMREQS + ONE; /* BUMP COUNT OF REQUESTS      */
@RF00104 AL    NUMREQS,@CF00056                                 02S0113
*          END;                                                 02S0114
*      END;                                                     02S0115
@RF00099 AL    PDIECTR,@CF00056                                 02S0115
@DE00093 SLR   @05,@05                                          02S0115
         IC    @05,PDICTR(,PDIBLPTR)                            02S0115
         CR    PDIECTR,@05                                      02S0115
         BNH   @DL00093                                         02S0115
*      PDIBLPTR = PDIBNXTP;            /* GET NEXT PDI BLOCK         */
         L     PDIBLPTR,PDIBNXTP(,PDIBLPTR)                     02S0116
*    END;                                                       02S0117
@DE00092 LTR   PDIBLPTR,PDIBLPTR                                02S0117
         BNZ   @DL00092                                         02S0117
*  END;                                                         02S0118
*  END;                                                         01S0119
@RF00088 DS    0H                                               01S0120
*IF NUMREQS ^= ZERO THEN               /* REQUESTS EXIST             */
@RF00086 LTR   NUMREQS,NUMREQS                                  01S0120
         BZ    @RF00120                                         01S0120
*  DO;                                                          01S0121
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BLDCOMRB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD COMMON UNALLOCATION REQUEST BLOCKS      */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE PURPOSE OF THIS SEGMENT IS TO BUILD THE REQUEST BLOCKS     */
*/*   FOR COMMON UNALLOCATION. A REQUEST BLOCK IS BUILT FOR EACH     */
*/*   PDI ENTRY THAT HAS A NON-ZERO SIOT ADDRESS. THE REQUEST BLOCKS */
*/*   ARE CHAINED. THE OVERRIDE-DISPOSITION-PRESENT INDICATOR,       */
*/*   THE INVALID-UCB INDICATOR, AND THE NO-DATA-SET-RELEASE         */
*/*   INDICATOR ARE ALL SET ON. IF THE USE-CONDITIONAL-DISPOSITIONS  */
*/*   INDICATOR IS ON AND A CONDITIONAL DISPOSITION WAS SPECIFIED,   */
*/*   THE OVERRIDE DISPOSITION IS SET TO THE CONDITIONAL             */
*/*   DISPOSITION. IF THE USE-CONDITIONAL-DISPOSITIONS INDICATOR IS  */
*/*   NOT ON, OR A CONDITIONAL DISPOSITION WAS NOT PRESENT, THE      */
*/*   OVERRIDE DISPOSITION IS SET TO KEEP FOR DATA SETS THAT WERE    */
*/*   OLD WHEN ORIGINALLY PASSED, AND SET TO DELETE FOR DATA         */
*/*   SETS THAT WERE NEW WHEN ORIGINALLY PASSED.                     */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*                                                                  */
*/*     NUMREQS - NUMBER OF REQUESTS TO BE PROCESSED BY JOB          */
*/*       UNALLOCATION.                                              */
*/*                                                                  */
*/*     FPDIPTR - ADDRESS OF THE FIRST PDI BLOCK                     */
*/*                                                                  */
*/*     PDI -                                                        */
*/*       PDICTR - NUMBER OF PDI ENTRIES IN THE PDI BLOCK            */
*/*       PDIBNXTP - ADDRESS OF THE NEXT PDI BLOCK                   */
*/*                                                                  */
*/*       PDI ENTRY -                                                */
*/*         PDISIOTP - ADDRESS OF THE ASSOCIATED SIOT OR ZERO        */
*/*         PDIISTAT - ON IF DATA SET WAS OLD WHEN ORIGINALLY        */
*/*           PASSED.                                                */
*/*                                                                  */
*/*     JOBCNDSP - PROCESS-CONDITIONAL-DISPOSITIONS BIT              */
*/*                                                                  */
*/*     SIOT -                                                       */
*/*       SIOTALTD - CONDITIONAL DISPOSITION                         */
*/*         SIOTAKEP - DISP = ,,KEEP                                 */
*/*         SIOTADEL - DISP = ,,DELETE                               */
*/*         SIOTACAT - DISP = ,,CATLG                                */
*/*         SIOTAUNC - DISP = ,,UNCATLG                              */
*/*                                                                  */
*/* EXIT -                                                           */
*/*                                                                  */
*/* 1 CONDITION - NORMAL                                             */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*                                                                  */
*/*     FRBPTR - ADDRESS OF FIRST COMMON UNALLOCATION RB             */
*/*                                                                  */
*/*     CMUNRB - COMMON UNALLOCATION REQUEST BLOCK                   */
*/*       ALL FIELDS FILLED IN, SEE MAPPING MACRO                    */
*/*                                                                  */
*/*   RETURN CODE - 0                                                */
*/*                                                                  */
*/* 2 CONDITION - NO CORE AVAILABLE FOR RBS                          */
*/*                                                                  */
*/*   OUTPUT -                                                       */
*/*                                                                  */
*/*     RESNCODE - REASON CODE - SET TO 1                            */
*/*                                                                  */
*/*   RETURN CODE - 4                                                */
*/*                                                                  */
*/********************************************************************/
*GETLENTH = NUMREQS * LENGTH(CMUNRB);  /* LENGTH OF CORE FOR RBS     */
         LR    @03,NUMREQS                                      02S0122
         SLA   @03,4                                            02S0122
         ST    @03,GETLENTH                                     02S0122
* /* ?GETSTORG (SPID,GETLENTH,FRBPTR);*/                        02S0123
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0123
*   DCL                                                         02S0123
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0123
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0123
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0123
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0123
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0123
*   DCL                                                         02S0124
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               02S0124
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               02S0124
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               02S0124
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               02S0124
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               02S0124
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               02S0124
*     GTSTZERO FIXED(31) INIT(0),                               02S0124
*     GTST253  FIXED(31) CONSTANT(253);                         02S0124
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0125
*   GTSTR0 = GETLENTH; /* SET AMOUNT*/                          02S0126
         LR    GTSTR0,@03                                       02S0126
*   GTSTR2 = SPID; /* SET SUBPOOL*/                             02S0127
         LA    GTSTR2,230                                       02S0127
*   GENERATE CODE;                                              02S0128
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0129
         ST    GTSTR15,GTSTRTCD                                 02S0129
*   FRBPTR = GTSTR1; /* ADDR OF GOTN STORG*/                    02S0130
         ST    GTSTR1,FRBPTR                                    02S0130
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0131
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               02S0132
         L     @15,GTSTRTCD                                     02S0132
         LTR   @15,@15                                          02S0132
         BNZ   @RF00132                                         02S0132
*     DO;               /* YES, CLEAR STORAGE.*/                02S0133
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0134
*                          GTSTR7,GTSTR8) RSTD;                 02S0134
*       GTSTR4 = FRBPTR; /*STORG PTR*/                          02S0135
         L     @09,FRBPTR                                       02S0135
         LR    GTSTR4,@09                                       02S0135
*       GTSTR5 = GETLENTH; /*STORG AMNT*/                       02S0136
         L     GTSTR5,GETLENTH                                  02S0136
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               02S0137
         SLR   GTSTR7,GTSTR7                                    02S0137
*       IF SPID = GTST253 THEN                                  02S0138
         B     @RF00138                                         02S0138
*      GEN                                                      02S0139
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           02S0139
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*       GEN REFS(GTSTR4,GTSTR6);                                02S0140
@RF00138 DS    0H                                               02S0140
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*       IF SPID = GTST253 THEN                                  02S0141
         B     @RF00141                                         02S0141
*         GEN (MODESET KEYADDR=(2));                            02S0142
         MODESET KEYADDR=(2)
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0143
*                          GTSTR7,GTSTR8) UNRSTD;               02S0143
@RF00141 DS    0H                                               02S0144
*     END;       /* STORAGE CLEARING COMPLETED */               02S0144
*   ELSE                                                        02S0145
*   FRBPTR= 0;   /* CLEAR RETURN ADDR. */                       02S0145
         B     @RC00132                                         02S0145
@RF00132 SLR   @15,@15                                          02S0145
         ST    @15,FRBPTR                                       02S0145
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0146
@RC00132 L     GTSTR15,GTSTRTCD                                 02S0146
*                                      /* RESTORE LIST PRINT STATUS  */
*     /* GET SPACE FOR RBS          */                          02S0147
*IF REG15 = ZERO THEN                  /* CORE WAS GOTTEN            */
         LTR   REG15,REG15                                      02S0147
         BNZ   @RF00147                                         02S0147
*  DO;                                 /* CONTINUE                   */
*    PDIBLPTR = FPDIPTR;               /* GET FIRST PDI BLOCK        */
         L     PDIBLPTR,FPDIPTR                                 02S0149
*    CMRBPTR = FRBPTR;                 /* GET THE FIRST RB           */
         L     CMRBPTR,FRBPTR                                   02S0150
*    DO WHILE (PDIBLPTR ^= ZERO);      /* LOOP THRU PDI BLOCKS       */
         B     @DE00151                                         02S0151
@DL00151 DS    0H                                               02S0152
*      DO PDIECTR = ONE TO PDICTR;     /* LOOP THRU PDI ENTRIES      */
         LA    PDIECTR,1                                        02S0152
         B     @DE00152                                         02S0152
@DL00152 DS    0H                                               02S0153
*        IF PDISIOTP(PDIECTR) ^= ZERO THEN/* SIOT EXISTS,MUST PROCESS*/
         LR    @05,PDIECTR                                      02S0153
         MH    @05,@CH01659                                     02S0153
         L     @05,PDISIOTP-48(@05,PDIBLPTR)                    02S0153
         LTR   @05,@05                                          02S0153
         BZ    @RF00153                                         02S0153
*          DO;                                                  02S0154
*            SIOTPTR = PDISIOTP(PDIECTR); /* ADDRESS THE ASSOC. SIOT */
         ST    @05,SIOTPTR                                      02S0155
*            CMNRBPTR = CMRBPTR + LENGTH(CMUNRB); /* PTR TO NEXT RB  */
         LA    @15,16                                           02S0156
         ALR   @15,CMRBPTR                                      02S0156
         ST    @15,CMNRBPTR(,CMRBPTR)                           02S0156
*            CMSIOPTR = SIOTPTR;       /* SIOT ADDRESS IN RB         */
         ST    @05,CMSIOPTR(,CMRBPTR)                           02S0157
*            CMORDISP = ON;            /* USE OVERRIDE DISP          */
*            CMINVUCB = ON;            /* UCB ADDRESSES ARE INVALID  */
         OI    CMORDISP(CMRBPTR),B'00010100'                    02S0159
*            CMNODSR = ON;             /* NO DATA SET RELEASE        */
         OI    CMNODSR(CMRBPTR),B'10000000'                     02S0160
*            NOCNDISP = OFF;           /* INIT COND DISP WORK BIT    */
         NI    NOCNDISP,B'11110111'                             02S0161
*            IF JOBCNDSP = ON THEN     /* USE COND DISPS IF PRESENT  */
         L     @15,@PC00001                                     02S0162
         TM    JOBCNDSP(@15),B'10000000'                        02S0162
         BNO   @RF00162                                         02S0162
*              IF SIOTAKEP = ON THEN   /* DISP = ,, KEEP             */
         TM    SIOTAKEP(@05),B'00001000'                        02S0163
         BNO   @RF00163                                         02S0163
*                CMOKEEP = ON;         /* KEEP THE DATA SET          */
         OI    CMOKEEP(CMRBPTR),B'00001000'                     02S0164
*              ELSE                    /* NOT ,,KEEP                 */
*                IF SIOTADEL = ON THEN /* DISP = ,,DELETE            */
         B     @RC00163                                         02S0165
@RF00163 L     @05,SIOTPTR                                      02S0165
         TM    SIOTADEL(@05),B'00000100'                        02S0165
         BNO   @RF00165                                         02S0165
*                  CMODEL = ON;        /* DELETE THE DATA SET        */
         OI    CMODEL(CMRBPTR),B'00000100'                      02S0166
*                ELSE                  /* NOT ,,DELETE               */
*                  IF SIOTACAT = ON THEN /* DISP =,,CATLG            */
         B     @RC00165                                         02S0167
@RF00165 L     @05,SIOTPTR                                      02S0167
         TM    SIOTACAT(@05),B'00000010'                        02S0167
         BNO   @RF00167                                         02S0167
*                    CMOCATLG = ON;    /* CATALOG THE DATA SET       */
         OI    CMOCATLG(CMRBPTR),B'00000010'                    02S0168
*                  ELSE                /* NOT ,,CATLG                */
*                    IF SIOTAUNC = ON THEN /* DISP = ,,UNCATLG       */
         B     @RC00167                                         02S0169
@RF00167 L     @05,SIOTPTR                                      02S0169
         TM    SIOTAUNC(@05),B'00000001'                        02S0169
         BNO   @RF00169                                         02S0169
*                      CMOUNCAT = ON;  /* UNCATALOG THE DATA SET     */
         OI    CMOUNCAT(CMRBPTR),B'00000001'                    02S0170
*                    ELSE              /* NO COND DISP               */
*                      NOCNDISP = ON;  /* SET WORK BIT               */
         B     @RC00169                                         02S0171
@RF00169 OI    NOCNDISP,B'00001000'                             02S0171
*            IF JOBCNDSP = OFF ×       /* DONT USE COND DISP         */
*                NOCNDISP = ON THEN    /* NO COND DISP PRESENT       */
@RC00169 DS    0H                                               02S0172
@RC00167 DS    0H                                               02S0172
@RC00165 DS    0H                                               02S0172
@RC00163 DS    0H                                               02S0172
@RF00162 L     @05,@PC00001                                     02S0172
         TM    JOBCNDSP(@05),B'10000000'                        02S0172
         BZ    @RT00172                                         02S0172
         TM    NOCNDISP,B'00001000'                             02S0172
         BNO   @RF00172                                         02S0172
@RT00172 DS    0H                                               02S0173
*              IF PDIISTAT(PDIECTR) = ON THEN /* DISP = OLD          */
         LR    @05,PDIECTR                                      02S0173
         MH    @05,@CH01659                                     02S0173
         ALR   @05,PDIBLPTR                                     02S0173
         AL    @05,@CF01946                                     02S0173
         TM    PDIISTAT-44(@05),B'10000000'                     02S0173
         BNO   @RF00173                                         02S0173
*                CMOKEEP = ON;         /* KEEP THE DATA SET          */
         OI    CMOKEEP(CMRBPTR),B'00001000'                     02S0174
*              ELSE                    /* DISP = NEW                 */
*                CMODEL = ON;          /* DELETE THE DATA SET        */
         B     @RC00173                                         02S0175
@RF00173 OI    CMODEL(CMRBPTR),B'00000100'                      02S0175
*            CMRBPTR = CMNRBPTR;       /* NEXT RB                    */
@RC00173 DS    0H                                               02S0176
@RF00172 L     CMRBPTR,CMNRBPTR(,CMRBPTR)                       02S0176
*          END;                                                 02S0177
*      END;                                                     02S0178
@RF00153 AL    PDIECTR,@CF00056                                 02S0178
@DE00152 SLR   @05,@05                                          02S0178
         IC    @05,PDICTR(,PDIBLPTR)                            02S0178
         CR    PDIECTR,@05                                      02S0178
         BNH   @DL00152                                         02S0178
*      PDIBLPTR = PDIBNXTP;            /* GET NEXT PDI BLOCK         */
         L     PDIBLPTR,PDIBNXTP(,PDIBLPTR)                     02S0179
*    END;                                                       02S0180
@DE00151 SLR   @15,@15                                          02S0180
         CR    PDIBLPTR,@15                                     02S0180
         BNE   @DL00151                                         02S0180
*    EVAL(CMRBPTR-LENGTH(CMUNRB)) -> CMNRBPTR = ZERO; /* ZERO NEXT PTR
*                                         IN LAST RB                 */
         LR    @03,CMRBPTR                                      02S0181
         SH    @03,@CH00052                                     02S0181
         ST    @15,CMNRBPTR(,@03)                               02S0181
*  END;                                                         02S0182
*ELSE                                  /* NO CORE FOR RBS            */
*  DO;                                 /* SET RETURN INFO            */
         B     @RC00147                                         02S0183
@RF00147 DS    0H                                               02S0184
*    RETCODE = ERROR;                  /* BAD RETURN CODE            */
         MVC   RETCODE(2),@CH00098                              02S0184
*    RESNCODE = GETERROR;              /* GETMAIN ERROR              */
         L     @15,@PC00001+20                                  02S0185
         MVC   RESNCODE(2,@15),@CH00056                         02S0185
*  END;                                                         02S0186
*    IF RETCODE = ZERO THEN            /* RBS WERE BUILT             */
@RC00147 ICM   @15,3,RETCODE                                    01S0187
         BNZ   @RF00187                                         01S0187
*      DO;                             /* CONTINUE                   */
*        CMUNFMAP = CMUNFMAP && CMUNFMAP;/* CLEAR FUNCTION MAP       */
         LA    @15,CFMAPCOR                                     01S0189
         XC    CMUNFMAP(4,@15),CMUNFMAP(@15)                    01S0189
*        IF JOBMSGS = ON THEN          /* DISP MSGS REQUESTED        */
         L     @15,@PC00001                                     01S0190
         TM    JOBMSGS(@15),B'01000000'                         01S0190
         BNO   @RF00190                                         01S0190
*          CMDMSGS = ON;               /* SET IN COMMON FUNC. MAP    */
         LA    @15,CFMAPCOR                                     01S0191
         OI    CMDMSGS(@15),B'10000000'                         01S0191
*        IF JOBMSTAT = ON THEN         /* MN STATUS REQUESTED        */
@RF00190 L     @15,@PC00001                                     01S0192
         TM    JOBMSTAT(@15),B'00010000'                        01S0192
         BNO   @RF00192                                         01S0192
*          CMMNSTAT = ON;              /* SET IN COMMON FUNC. MAP    */
         LA    @15,CFMAPCOR                                     01S0193
         OI    CMMNSTAT(@15),B'01000000'                        01S0193
*        CMDISPRC = ON;                /* PROCESS DISPOSITIONS       */
@RF00192 LA    @15,CFMAPCOR                                     01S0194
         OI    CMDISPRC(@15),B'00100000'                        01S0194
*        CMNOPOST = ON;                /* DO NOT POST Q-MNGR         */
*        CMNOVUT = ON;                 /* DO NOT PROCESS VUT         */
         OI    CMNOPOST(@15),B'11000000'                        01S0196
*        CMSPSCR = ON;                 /* SPECIAL SCRATCH PROCESSING */
         OI    CMSPSCR(@15),B'00001000'                         01S0197
*        FSIOTP = ZERO;                /* NO STEP SIOT CHAIN         */
         SLR   @14,@14                                          01S0198
         ST    @14,FSIOTP                                       01S0198
*        CALL IEFAB4A0                 /* INVOKE COMMON UNALLOCATION */
*           (CMUNFMAP,FRBPTR,JSCBPTR,FSIOTP,JCTDETDA,ZERO,      01S0199
*            JCTVULDP,RESNCODE,0);                        /* @ZD03010*/
         ST    @15,@AL00001                                     01S0199
         LA    @15,FRBPTR                                       01S0199
         ST    @15,@AL00001+4                                   01S0199
         L     @15,@PC00001+4                                   01S0199
         ST    @15,@AL00001+8                                   01S0199
         LA    @15,FSIOTP                                       01S0199
         ST    @15,@AL00001+12                                  01S0199
         L     @15,@PC00001+8                                   01S0199
         L     @15,JCTPTR(,@15)                                 01S0199
         LA    @14,JCTDETDA(,@15)                               01S0199
         ST    @14,@AL00001+16                                  01S0199
         LA    @14,@CF00184                                     01S0199
         ST    @14,@AL00001+20                                  01S0199
         LA    @15,JCTVULDP(,@15)                               01S0199
         ST    @15,@AL00001+24                                  01S0199
         L     @15,@PC00001+20                                  01S0199
         ST    @15,@AL00001+28                                  01S0199
         LA    @15,@CF00184                                     01S0199
         ST    @15,@AL00001+32                                  01S0199
         L     @15,@CV00187                                     01S0199
         LA    @01,@AL00001                                     01S0199
         BALR  @14,@15                                          01S0199
*      END;                                                     01S0200
*  END;                                                         01S0201
@RF00187 DS    0H                                               01S0202
*ESTAJOBU = OFF;                       /* PVT UNLOAD TRIED           */
@RF00120 L     @08,@PC00001+12                                  01S0202
         L     @08,ESTAPTR(,@08)                                01S0202
         NI    ESTAJOBU(@08),B'11011111'                        01S0202
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - VOLCLNP                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - END OF JOB VOLUME CLEANUP                     */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THIS SEGMENT PROVIDES THE FOLLOWING FUNCTIONS:                 */
*/*                                                                  */
*/*     1. UNLOADING OR REWINDING VOLUMES -                          */
*/*        ANY VOLUME WHICH APPEARS IN THE VOLUME UNLOAD TABLE (VUT) */
*/*        AND WASN'T UNLOADED BY UNIT UNALLOCATION          @ZD03010*/
*/*        DURING THE JOB BEING UNALLOCATED                  @ZD03010*/
*/*        AND HAS THE FOLLOWING CHARACTERISTICS IS UNLOADED:        */
*/*                                                                  */
*/*        . VOLUME IS REMOVABLE                                     */
*/*        . VOLUME IS PRIVATE OR IS PUBLIC MSS VOLUME       @Z40LPPE*/
*/*        . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION           */
*/*        . VOLUME IS UNALLOCATED                                   */
*/*        . VOLUME IS TAPE OR DIRECT ACCESS                         */
*/*        . VOLUME IS NOT ON A JES3-MANAGED DIRECT ACCESS   @ZA06651*/
*/*          UNIT (UNLESS THE UNIT IS 3330V). JES3 ISSUES    @ZA06651*/
*/*          MOUNT/DEMOUNT MESSAGES FOR NON-3330V, D.A., JES3@ZA06651*/
*/*          MANAGED UNITS. A DEMOUNT MESSAGE ISSUED VIA     @ZA06651*/
*/*          IEFBB416 CALLING VM&V WOULD CONFUSE THE OPERATOR@ZA06651*/
*/*          OR POSSIBLY EVEN DESTROY A JES3 SETUP.          @ZA06651*/
*/*                                                                  */
*/*        ANY VOLUME WHICH APPEARS IN THE VUT AND HAS THE           */
*/*        FOLLOWING CHARACTERISTICS IS REWOUND:                     */
*/*                                                                  */
*/*        . VOLUME IS A TAPE                                        */
*/*        . VOLUME IS PUBLIC                                        */
*/*        . VOLUME IS REMOVABLE                                     */
*/*        . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION           */
*/*        . VOLUME IS UNALLOCATED                                   */
*/*                                                                  */
*/*        VOLUME MOUNT AND VERIFY (VM&V) IS USED TO UNLOAD          */
*/*        OR REWIND THESE VOLUMES AND INFORM THE OPERATOR           */
*/*        OF THE STATUS OF THOSE BEING UNLOADED. VOLUMES            */
*/*        APPEAR IN THE VUT AS A RESULT OF BEING PRIVATE OR         */
*/*        CONTAINING PASSED DATA SETS. THE PASS INDICATOR IN THE    */
*/*        UCB IS RESET FOR EACH VOLUME THAT IS UNLOADED OR REWOUND. */
*/*                                                                  */
*/*     2. ISSUE THE 'RELEASE' MESSAGE -                             */
*/*        A MESSAGE IS ISSUED TO THE SYSTEM OPERATOR INFORMING      */
*/*        HIM OF VOLUMES THAT WERE PREVIOUSLY DISMOUNTED    @ZA09506*/
*/*        WITH EITHER A RETAIN MESSAGE (AN 'R' TYPE UNLOAD  @ZA09506*/
*/*        MESSAGE) OR A KEEP MESSAGE FROM DATA MANAGEMENT.  @ZA09506*/
*/*        A VOLUME APPEARS IN THE RELEASE MESSAGE IF IT     @ZA09506*/
*/*        APPEARS IN THE VUT BUT IS NOT MOUNTED ON ANY UNIT IN THE  */
*/*        SYSTEM. ONE WAY FOR A VOLUME TO BECOME RETAINED IS IF IT  */
*/*        WAS DISMOUNTED BY ANOTHER ALLOCATION AND HAD THE PRIVATE  */
*/*        OR PASS INDICATORS ON IN THE UCB. NOTE THAT       @Y30LPPG*/
*/*        MSS VOLUMES ARE NEVER INCLUDED IN THIS            @Y30LPPG*/
*/*        MESSAGE, AS THERE IS NO INTERACTION BETWEEN MSS   @Y30LPPG*/
*/*        AND THE OPERATOR.                                 @Y30LPPG*/
*/*                                                                  */
*/*     3. CLEANUP UNOPENED NON-SPECIFIC TAPE UCBS -                 */
*/*        THE VOLUME SERIAL FIELD OF EACH UCB WHICH WAS ALLOCATED   */
*/*        TO THIS JOB FOR A NON-SPECIFIC TAPE REQUEST AND NEVER     */
*/*        OPENED IS SET TO ZERO. THESE VOLUMES ARE IDENTIFIED BY    */
*/*        HAVING HEX 'FF' IN THE FIRST BYTE OF THE VOLUME SERIAL    */
*/*        AND THE ASID OF THIS MEMORY IN THE FIFTH AND SIXTH BYTES. */
*/*                                                                  */
*/*     OPERATION -                                                  */
*/*       1. THE VUT IS ACCESSED VIA THE SWA MANAGER AND CHAINED     */
*/*          WITH IN-CORE ADDRESSES. AFTER THE VUT HAS BEEN READ     */
*/*          CORE IS GOTTEN TO BUILD A VOLUME LIST, VM&V     @Z40LPPK*/
*/*          REQUEST BLOCKS, AND A LIST OF UCBS. EACH        @Z40LPPK*/
*/*          UNIQUE VOLUME SERIAL IN THE VUT IS PLACED IN    @Z40LPPK*/
*/*          THE VOLUME LIST.                                @Z40LPPK*/
*/*                                                                  */
*/*       2. EACH UCB IN THE SYSTEM IS SCANNED TO DETERMINE IF IT    */
*/*          CONTAINS A VOLUME SERIAL THAT SHOULD BE HANDLED BY THIS */
*/*          ROUTINE. IF A VOL SER IN A GIVEN UCB IS IN THE VOL      */
*/*          LIST, THE ADDRESS OF THE UCB IS PLACED IN A     @Z40LPPK*/
*/*          LIST OF UCB'S.  THIS LIST WILL LATER BE PASSED  @Z40LPPK*/
*/*          TO A SERVICE ROUTINE WHICH WILL SERIALIZE,      @Z40LPPK*/
*/*          OR 'LOCK' ON THE GROUPS REPRESENTED BY THE UCB  @Z40LPPK*/
*/*          LIST.  IF THE UCB HAS A 'FF'                    @Z40LPPK*/
*/*          TAPE SERIAL NUMBER WITH THE ASID OF THIS MEMORY IT IS   */
*/*          ADDED TO THE LIST OF FF TAPES. THIS LIST IS USED TO     */
*/*          UPDATE THE TAPE UCBS.                           @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       3. THE VOLUME UNLOADING AND UCB CLEANUP IS         @Z40LPPK*/
*/*          SERIALIZED WITH OTHER UCB-DEPENDENT PROCESSES   @Z40LPPK*/
*/*          (FOR INSTANCE: ALLOCATION, VARY COMMAND         @Z40LPPK*/
*/*          PROCESSING, AND JES3 UNLOADING-VIA VM&V).       @Z40LPPK*/
*/*          THIS SERIALIZATION IS ACCOMPLISHED BY           @Z40LPPK*/
*/*          PASSING A LIST OF ALL UCB'S TO BE CLEANED UP    @Z40LPPK*/
*/*          OR TO HAVE THEIR VOLUMES UNLOADED TO A ROUTINE, @Z40LPPK*/
*/*          IEFAB4EC, WHICH WILL LOCK THE NECESSARY DEVICE  @Z40LPPK*/
*/*          GROUPS VIA THE ALLOCATION Q-MANAGER.            @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       4. VM&V REQUEST BLOCKS ARE BUILT AND CHAINED FOR   @Z40LPPK*/
*/*          ALL REWINDABLE OR UNLOADABLE VOLUMES.           @Z40LPPK*/
*/*                                                                  */
*/*       5. IF ANY VM&V REQUEST BLOCKS WERE BUILT, VM&V IS INVOKED  */
*/*          TO DO THE UNLOADING, REWINDING, AND ISSUING OF UNLOAD   */
*/*          MESSAGES                                                */
*/*                                                                  */
*/*       6. THE CMS AND LOCAL LOCKS ARE OBTAINED. THESE LOCKS ARE   */
*/*          NEEDED IN ORDER TO UPDATE THE UCBS.                     */
*/*                                                                  */
*/*       7. THE VOLUME SERIAL FIELD OF EACH UCB IN THE FF SERIAL    */
*/*          LIST IS CLEARED.                                        */
*/*                                                                  */
*/*       8. THE CMS AND LOCAL LOCKS ARE RELEASED.                   */
*/*                                                                  */
*/*                                                                  */
*/*       NOTE: IF NO VOLUME LIST IS BUILT AND THERE ARE     @YM04401*/
*/*             NO FF SERIALS TO PROCESS, STEPS 3 THROUGH 8  @Z40LPPK*/
*/*             ARE BYPASSED.                                @YM04401*/
*/*                                                                  */
*/*       9. IF ANY VOLUMES IN THE VOLUME LIST WERE NOT FOUND ON     */
*/*          THE SYSTEM AND WERE NOT UNLOADED WITH A 'KEEP'  @ZD03010*/
*/*          MSG, THE 'RELEASE' MESSAGE IS BUILT AND ISSUED. @ZD03010*/
*/*          A MULTI-LINE WTO IS USED.                               */
*/*                                                                  */
*/*       10. CORE USED BY THE VOLUME LIST, THE VM&V REQUEST BLOCKS, */
*/*           AND THE LIST OF UCB'S TO BE SERIALIZED ON      @Z40LPPK*/
*/*           IS FREED.                                      @Z40LPPK*/
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JCT -                                                        */
*/*       JCTVULDP - SVA  OF THE VUT                                 */
*/*       JCTJNAME - JOB NAME                                        */
*/*                                                                  */
*/*     VUNLDTAB - VOLUME UNLOAD TABLE (IEFZB438)                    */
*/*       VUTNSVA - SVA OF NEXT BLOCK                                */
*/*       VUTENTNO - NUMBER OF ENTRIES IN THE BLOCK                  */
*/*       VUTENVOL - VOLUME SERIAL                           @Y30LPPG*/
*/*                                                                  */
*/*     IOSLUT - IOS UCB LOOKUP TABLE                                */
*/*                                                                  */
*/*     ASCB -                                               @Z40FPPD*/
*/*       ASCBASID - ASID                                    @Z40FPPD*/
*/*                                                                  */
*/* EXIT -                                                           */
*/* 1 CONDITION - NORMAL COMPLETION                                  */
*/*     OUTPUT -                                                     */
*/*       VOLUMES UNLOADED                                           */
*/*       'RELEASE' MESSAGE ISSUED                                   */
*/*       TAPE UCBS RESET                                            */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/* 2 CONDITION - GETMAIN ERROR OCCURRED                             */
*/*     OUTPUT -                                                     */
*/*       SOME OF THE ABOVE DEPENDING ON WHERE THE ERROR OCCURRED    */
*/*       REASON CODE -                                              */
*/*         RESNCODE = 1                                             */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 4                                                */
*/*                                                                  */
*/* 3 CONDITION - ERROR IN GROUP LOCKING ROUTINE             @Z40LPPK*/
*/*     OUTPUT -                                             @Z40LPPK*/
*/*       REASON CODE - (IF ESTAE ERROR)                     @Z40LPPK*/
*/*         RESNCODE = 4                                     @Z40LPPK*/
*/*     RETURN CODE - IF ESTAE ERROR                         @Z40LPPK*/
*/*       RETCODE = 4                                        @Z40LPPK*/
*/*                                                                  */
*/********************************************************************/
*FUNLDRBP = ZERO;                      /* INIT FIRST VM&V RB PTR     */
         SLR   @08,@08                                          02S0203
         ST    @08,FUNLDRBP                                     02S0203
*RLSECTR = ZERO;                       /* INIT RLSE VOLSERS CTR      */
         ST    @08,RLSECTR                                      02S0204
*RETCODE = ZERO;                       /* INIT RETCODE TO OK         */
         STH   @08,RETCODE                                      02S0205
*VOLCOREP = ZERO;                      /* INIT VOLLST ADDRESS TO ZERO*/
         ST    @08,VOLCOREP                                     02S0206
*TOTVOLS = ZERO;                       /* NO VOLS IN VOLLIST         */
         SLR   TOTVOLS,TOTVOLS                                  02S0207
*FFSERCTR = ZERO;                      /* INIT TOTAL NO. OF FFSERS
*                                         TO NIL.            @Z40LPPK*/
         ST    @08,FFSERCTR                                     02S0208
*ASID = ASCBASID;                      /*OBTAIN ASID         @Z40FPPD*/
         L     @01,PSAAOLD                                      02S0209
         MVC   ASID(2),ASCBASID(@01)                            02S0209
*IF JCTVULDP ^= ZERO THEN              /* A VUT EXISTS               */
         L     @15,@PC00001+8                                   02S0210
         L     @01,JCTPTR(,@15)                                 02S0210
         SLR   @15,@15                                          02S0210
         ICM   @15,7,JCTVULDP(@01)                              02S0210
         LTR   @15,@15                                          02S0210
         BZ    @RF00210                                         02S0210
*  DO;                                 /* BUILD THE VOLUME LIST      */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - BVOLLIST                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD THE VOLUME LIST                         */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO GET CORE FOR THE            */
*/*   VOLUME LIST, ANY VM&V REQUEST BLOCKS THAT MAY BE       @Z40LPPK*/
*/*   NEEDED, THE LIST OF UCB'S WHOSE GROUPS NEED TO BE      @Z40LPPK*/
*/*   LOCKED VIA THE ALLOCATION Q-MANAGER,                   @Z40LPPK*/
*/*   AND BUILD THE VOLUME LIST. THE VOLUME LIST CONTAINS ALL        */
*/*   UNIQUE VOLUME SERIALS THAT WERE IN THE VOLUME UNLOAD           */
*/*   TABLE (VUT).                                                   */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*                                                                  */
*/*     1. ACCESS, CHAIN, AND COUNT -                                */
*/*        EACH VUT BLOCK IS ACCESSED VIA THE SWA MANAGER AND        */
*/*        CHAINED WITH IN-CORE ADDRESSES. A RUNNING TOTAL OF        */
*/*        VUT ENTRIES IS KEPT.                                      */
*/*                                                                  */
*/*     2. GET CORE FOR VOLLIST, VM&V REQUEST BLOCKS AND     @Z40LPPK*/
*/*        THE LIST OF UCB'S TO LOCK ON.                     @Z40LPPK*/
*/*        THE AMOUNT OF CORE OBTAINED IS AS FOLLOWS:        @Z40LPPK*/
*/*          (TOTAL VUT ENTRIES * (LENGTH(VLISTENT) +        @Z40LPPK*/
*/*                                LENGTH(VMVRB)    +        @Z40LPPK*/
*/*                                LENGTH(UCB LIST ENTRY)))  @Z40LPPK*/
*/*                     +                                    @Z40LPPK*/
*/*          NO.  OF FFSER ENTRIES IN FFSER BLK*             @Z40LPPK*/
*/*             LENGTH(UCB LIST ENTRY)                       @Z40LPPK*/
*/*          WHERE:                                                  */
*/*            TOTAL-VUT-ENTRIES IS THE NUMBER OF SERIALS IN         */
*/*              THE VUT                                             */
*/*            LENGTH(VLISTENT) IS THE LENGTH OF A VOLUME LIST       */
*/*              ENTRY                                               */
*/*            LENGTH(VM&VRB) IS THE LENGTH OF A VM&V REQUEST        */
*/*              BLOCK                                               */
*/*            LENGTH(UCB LIST ENTRY) IS THE LENGTH OF AN    @Z40LPPK*/
*/*              ENTRY IN THE LIST OF UCB'S TO LOCK ON.      @Z40LPPK*/
*/*                                                                  */
*/*     3. FILL IN THE VOLUME LIST -                                 */
*/*        EACH VOLUME SERIAL IS RETRIEVED FROM THE VUT AND THE      */
*/*        ENTRIES ALREADY IN THE VOLUME LIST ARE CHECKED TO SEE     */
*/*        IF THE VOLUME SERIAL IS IN THE VOLLIST. IF IT IS, THE     */
*/*        'VOLUME UNLOADED BY UNIT UNALLOCATION' INDICATOR  @ZD03010*/
*/*        IN THE VOLLIST IS SET ACCORDING TO THE SETTING    @ZD03010*/
*/*        OF THE CORRESPONDING INDICATOR IN THE MATCHING    @ZD03010*/
*/*        VUT ENTRY.  IF THE VOLUME SERIAL ISN'T IN THE     @ZD03010*/
*/*        VOLUME LIST ALREADY, AND THE VUT ENTRY DOESN'T    @ZD03010*/
*/*        INDICATE THAT THE VOLUME WAS UNLOADED,            @ZD03010*/
*/*        A NEW ENTRY FOR IT IS PUT IN                      @ZD03010*/
*/*        THE VOLUME LIST, ALONG WITH A VIRTUAL INDICATOR   @Y30LPPG*/
*/*        IF APPROPRIATE. A RUNNING TOTAL OF ENTRIES IN THE         */
*/*        VOLUME LIST IS MAINTAINED.                                */
*/*                                                                  */
*/*      4. INITIALIZE THE NUMBER OF VOLUMES TO BE PLACED IN THE     */
*/*            RELEASE MESSAGE -                                     */
*/*           THIS COUNTER IS INTIALIZED TO THE TOTAL NUMBER OF      */
*/*           VOLUMES IN THE LIST. IT WILL BE DECREMENTED EVERY TIME */
*/*           A VOLUME IS FOUND MOUNTED.                             */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     JCTVULDP - SVA OF THE VUT                                    */
*/*                                                                  */
*/*     VUNLDTAB - VOLUME UNLOAD TABLE                               */
*/*       VUTNSVA - SVA OF NEXT VUT ENTRY                            */
*/*       VUTENTNO - NUMBER OF ENTRIES IN BLOCK                      */
*/*       VUTENVOL - VOLUME SERIAL                           @Y30LPPG*/
*/*                                                                  */
*/* EXIT -                                                           */
*/* 1 CONDITION - CORE OBTAINED AND VOLLIST BUILT                    */
*/*     OUTPUT -                                                     */
*/*       VOLCOREP - ADDRESS OF GOTTEN CORE                          */
*/*       TOTVOLS - NUMBER OF ENTRIES IN VOLUME LIST                 */
*/*       RLSECTR - NUMBER OF VOLSERS TO BE RELEASED. SET TO TOTVOLS */
*/*       VOLCOREL - LENGTH OF GOTTEN CORE                           */
*/*       VLISTENT - VOLUME LIST ENTRIES                             */
*/*         VOLSER - VOLUME SERIAL                                   */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/* 2 CONDITION - CORE NOT AVAILABLE                                 */
*/*     OUTPUT -                                                     */
*/*       REASON CODE -                                              */
*/*         RESNCODE = 1                                             */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 4                                                */
*/*                                                                  */
*/********************************************************************/
*FVUTPTR = ZERO;                       /* NO VUT READ IN YET         */
         ST    @08,FVUTPTR                                      03S0212
*LVUTPTR = ZERO;                       /* NO LAST VUT YET            */
         SLR   LVUTPTR,LVUTPTR                                  03S0213
*FIRSTSW = ON;                         /* SET FIRST VUT SWITCH       */
         OI    FIRSTSW,B'01000000'                              03S0214
*SWACTLS = SWACTLS && SWACTLS;         /* CLEAR FUNC MAP FOR IEFAB4F7*/
         SLR   @08,@08                                          03S0215
         ICM   @08,3,SWACTLS                                    03S0215
         LR    @03,@08                                          03S0215
         XR    @03,@08                                          03S0215
         STH   @03,SWACTLS                                      03S0215
*SWREAD = ON;                          /* READ A BLOCK               */
*SWNEW = ON;                           /* CREATE A NEW EPA           */
*SWFREE = ON;                          /* FREE THE EPA               */
         OI    SWREAD,B'00101100'                               03S0218
*VUTSVA = JCTVULDP;                    /* FIRST VUT TABLE SVA        */
         STCM  @15,7,VUTSVA                                     03S0219
*DO WHILE (VUTSVA ^= ZERO);            /* READ ALL VUT BLOCKS IN     */
         B     @DE00220                                         03S0220
@DL00220 DS    0H                                               03S0221
*  CALL IEFAB4F7                       /* READ A VUT BLOCK           */
*      (SWACTLS,ZERO,ZERO,ADDR(VUTSVA),ADDR(VUTPTR),ZERO,ONE);  03S0221
         MVC   @AL00001+4(24),@AL00221                          03S0221
         LA    @08,SWACTLS                                      03S0221
         ST    @08,@AL00001                                     03S0221
         LA    @08,VUTSVA                                       03S0221
         ST    @08,@TF00001                                     03S0221
         LA    @08,@TF00001                                     03S0221
         ST    @08,@AL00001+12                                  03S0221
         LA    @08,VUTPTR                                       03S0221
         ST    @08,@TF00002                                     03S0221
         LA    @08,@TF00002                                     03S0221
         ST    @08,@AL00001+16                                  03S0221
         L     @15,@CV00191                                     03S0221
         LA    @01,@AL00001                                     03S0221
         BALR  @14,@15                                          03S0221
*  IF FIRSTSW = ON THEN                /* FIRST VUT BEING READ       */
         TM    FIRSTSW,B'01000000'                              03S0222
         BNO   @RF00222                                         03S0222
*    DO;                               /* BEGIN CHAIN                */
*      FIRSTSW = OFF;                  /* RESET FIRST TIME SWITCH    */
         NI    FIRSTSW,B'10111111'                              03S0224
*      FVUTPTR = VUTPTR;               /* ANCHOR CHAIN               */
         MVC   FVUTPTR(4),VUTPTR                                03S0225
*    END;                              /* END BEGIN CHAIN            */
*  ELSE                                /* NOT FIRST TIME             */
*    LVUTPTR -> VUTNPTR = VUTPTR;      /* CHAIN VUT TO LAST          */
         B     @RC00222                                         03S0227
@RF00222 MVC   VUTNPTR(4,LVUTPTR),VUTPTR                        03S0227
*  LVUTPTR = VUTPTR;                   /* SAVE THIS VUT FOR CHAINING */
@RC00222 L     @08,VUTPTR                                       03S0228
         LR    LVUTPTR,@08                                      03S0228
*  TOTVOLS = TOTVOLS + VUTENTNO;       /* ADD VOLS IN ENTRY TO TOTAL */
         SLR   @03,@03                                          03S0229
         IC    @03,VUTENTNO(,@08)                               03S0229
         ALR   TOTVOLS,@03                                      03S0229
*  VUTSVA = VUTNSVA;                   /* NEXT SVA TO READ           */
         MVC   VUTSVA(3),VUTNSVA(@08)                           03S0230
*END;                                  /* END READ ALL VUTS          */
@DE00220 SLR   @08,@08                                          03S0231
         SLR   @03,@03                                          03S0231
         ICM   @03,7,VUTSVA                                     03S0231
         CR    @08,@03                                          03S0231
         BNE   @DL00220                                         03S0231
*VUTNPTR = ZERO;                       /* TERMINATE CHAIN            */
         L     @01,VUTPTR                                       03S0232
         ST    @08,VUTNPTR(,@01)                                03S0232
*IF TOTVOLS ^= ZERO THEN               /* VALID VUT ENTRIES EXIST    */
         CR    TOTVOLS,@08                                      03S0233
         BE    @RF00233                                         03S0233
*  DO;                                 /* BUILD THE VOLLIST          */
*    VOLCOREL =                        /* AMNT OF CORE TO GET@Z40LPPK*/
*      (TOTVOLS * (LENGTH(VLISTENT) +  /* MAX SIZE VOL LIST  @Z40LPPK*/
*                  LENGTH(VMVRQBLK) +  /* MAX VM&V RB CORE   @Z40LPPK*/
*                  LENGTH(LOCKLIST))) +/* UCB'S TO LOCK ON   @Z40LPPK*/
*      LENGTH(LOCKNUM)              +  /* LOCKLIST HDR LEN   @Z40LPPK*/
*      DIM(FFSERUCB) * LENGTH(LOCKLIST); /* FF VOLUME SERIAL UCB'S
*                                           TO LOCK ON       @Z40LPPK*/
         LR    @08,TOTVOLS                                      03S0235
         MH    @08,@CH01926                                     03S0235
         AH    @08,@CH01928                                     03S0235
         ST    @08,VOLCOREL                                     03S0235
*     /* ?GETSTORG (SPID,VOLCOREL,VOLCOREP);*/                  03S0236
*       RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/           03S0236
*       GTSTR0 = VOLCOREL; /* SET AMOUNT*/                      03S0237
         LR    GTSTR0,@08                                       03S0237
*       GTSTR2 = SPID; /* SET SUBPOOL*/                         03S0238
         LA    GTSTR2,230                                       03S0238
*       GENERATE CODE;                                          03S0239
         GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*       GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/           03S0240
         ST    GTSTR15,GTSTRTCD                                 03S0240
*       VOLCOREP = GTSTR1; /* ADDR OF GOTN STORG*/              03S0241
         ST    GTSTR1,VOLCOREP                                  03S0241
*       RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */            03S0242
*       IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */           03S0243
         L     @08,GTSTRTCD                                     03S0243
         LTR   @08,@08                                          03S0243
         BNZ   @RF00243                                         03S0243
*         DO;               /* YES, CLEAR STORAGE.*/            03S0244
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   03S0245
*                              GTSTR7,GTSTR8) RSTD;             03S0245
*           GTSTR4 = VOLCOREP; /*STORG PTR*/                    03S0246
         L     @03,VOLCOREP                                     03S0246
         LR    GTSTR4,@03                                       03S0246
*           GTSTR5 = VOLCOREL; /*STORG AMNT*/                   03S0247
         L     GTSTR5,VOLCOREL                                  03S0247
*           GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/           03S0248
         SLR   GTSTR7,GTSTR7                                    03S0248
*           IF SPID = GTST253 THEN                              03S0249
         B     @RF00249                                         03S0249
*          GEN                                                  03S0250
*       (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);       03S0250
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*           GEN REFS(GTSTR4,GTSTR6);                            03S0251
@RF00249 DS    0H                                               03S0251
              MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*           IF SPID = GTST253 THEN                              03S0252
         B     @RF00252                                         03S0252
*             GEN (MODESET KEYADDR=(2));                        03S0253
         MODESET KEYADDR=(2)
*           RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                   03S0254
*                              GTSTR7,GTSTR8) UNRSTD;           03S0254
@RF00252 DS    0H                                               03S0255
*         END;       /* STORAGE CLEARING COMPLETED */           03S0255
*       ELSE                                                    03S0256
*       VOLCOREP= 0;   /* CLEAR RETURN ADDR. */                 03S0256
         B     @RC00243                                         03S0256
@RF00243 SLR   @08,@08                                          03S0256
         ST    @08,VOLCOREP                                     03S0256
*       GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */           03S0257
@RC00243 L     GTSTR15,GTSTRTCD                                 03S0257
*                                      /* RESTORE LIST PRINT STATUS  */
** CORE FOR VLST + VMV RBS    */                                03S0258
*    IF REG15 = ZERO THEN              /* GETMAIN WAS OK             */
         LTR   REG15,REG15                                      03S0258
         BNZ   @RF00258                                         03S0258
*      DO;                             /* BUILD THE VOLLIST          */
*        VUTPTR = FVUTPTR;             /* PICK UP FIRST VUT ENTRY    */
         MVC   VUTPTR(4),FVUTPTR                                03S0260
*        VOLCTR = ONE;                 /* USE FIRST VOLLIST ENTRY    */
         LA    VOLCTR,1                                         03S0261
*        DO WHILE (VUTPTR ^= ZERO);    /* SCAN ALL VUT BLOCKS        */
         B     @DE00262                                         03S0262
@DL00262 DS    0H                                               03S0263
*          DO VUTCTR = ONE TO VUTENTNO;/* SCAN EACH ENTRY IN BLOCK   */
         LA    VUTCTR,1                                         03S0263
         B     @DE00263                                         03S0263
@DL00263 DS    0H                                               03S0264
*            DUPSW = OFF;              /* INIT DUPLICATE SWITCH      */
         NI    DUPSW,B'01111111'                                03S0264
*            DO TVOLCTR = ONE TO VOLCTR - ONE;/* SCAN VLIST FOR DUPES*/
         LA    TVOLCTR,1                                        03S0265
         B     @DE00265                                         03S0265
@DL00265 DS    0H                                               03S0266
*              IF VUTENVOL(VUTCTR) =   /* VOLSER IN VUT ENTRY@Y30LPPG*/
*                  VOLSER(TVOLCTR) THEN/* VOLSER IS A DUPLICATE      */
         L     @05,VUTPTR                                       03S0266
         LR    @15,VUTCTR                                       03S0266
         MH    @15,@CH00119                                     03S0266
         L     @14,VOLCOREP                                     03S0266
         LR    @09,TVOLCTR                                      03S0266
         SLA   @09,4                                            03S0266
         ST    @15,@TF00001                                     03S0266
         ALR   @15,@05                                          03S0266
         ST    @09,@TF00002                                     03S0266
         ALR   @09,@14                                          03S0266
         AL    @09,@CF01958                                     03S0266
         CLC   VUTENVOL-7(6,@15),VOLSER-2(@09)                  03S0266
         BNE   @RF00266                                         03S0266
*                DO;                   /* PROCESS DUPLICATE. @ZD03010*/
*                  DUPSW = ON;         /* INDICATE DUP.      @ZD03010*/
         OI    DUPSW,B'10000000'                                03S0268
*                  IF VUTUNLOD(VUTCTR)=ON THEN /*VOL UNLOADED BY UNIT
*                                                UNALLOC.    @ZD03010*/
         AL    @05,@TF00001                                     03S0269
         TM    VUTUNLOD-7(@05),B'01000000'                      03S0269
         BNO   @RF00269                                         03S0269
*                    VOLUNLD(TVOLCTR) = ON;  /* VOL UNLOADED @ZD03010*/
         AL    @14,@TF00002                                     03S0270
         AL    @14,@CF01959                                     03S0270
         OI    VOLUNLD(@14),B'01000000'                         03S0270
*                  ELSE                /* VOL NOT UNLOADED   @ZD03010*/
*                    VOLUNLD(TVOLCTR) = OFF;  /* NOT UNLDD   @ZD03010*/
         B     @RC00269                                         03S0271
@RF00269 LR    @05,TVOLCTR                                      03S0271
         SLA   @05,4                                            03S0271
         L     @01,VOLCOREP                                     03S0271
         ALR   @01,@05                                          03S0271
         AL    @01,@CF01959                                     03S0271
         NI    VOLUNLD(@01),B'10111111'                         03S0271
*                END;                  /* END DUP. PROCESS.  @ZD03010*/
*              ELSE;                   /* VOL NOT DUPLICATE  @ZD03010*/
@RF00266 DS    0H                                               03S0274
*            END;                      /* END SCAN VOLLIST FOR DUPES*/
@RC00266 AL    TVOLCTR,@CF00056                                 03S0274
@DE00265 LR    @05,VOLCTR                                       03S0274
         BCTR  @05,0                                            03S0274
         CR    TVOLCTR,@05                                      03S0274
         BNH   @DL00265                                         03S0274
*            IF DUPSW = OFF &          /* VUT ENTRY IS NOT A DUPE    */
*               VUTUNLOD(VUTCTR) = OFF THEN /* NOT UNLOADED  @ZD03010*/
         TM    DUPSW,B'10000000'                                03S0275
         BNZ   @RF00275                                         03S0275
         L     @15,VUTPTR                                       03S0275
         LR    @14,VUTCTR                                       03S0275
         MH    @14,@CH00119                                     03S0275
         ST    @14,@TF00001                                     03S0275
         ALR   @14,@15                                          03S0275
         TM    VUTUNLOD-7(@14),B'01000000'                      03S0275
         BNZ   @RF00275                                         03S0275
*              DO;                     /* PUT VOLSER IN VOLLIST      */
*                VOLSER(VOLCTR) = VUTENVOL(VUTCTR);/* PUT SER IN LIST
*                                                            @Y30LPPG*/
         L     @14,VOLCOREP                                     03S0277
         LR    @09,VOLCTR                                       03S0277
         SLA   @09,4                                            03S0277
         ST    @09,@TF00002                                     03S0277
         ALR   @09,@14                                          03S0277
         AL    @09,@CF01958                                     03S0277
         LR    @08,@15                                          03S0277
         AL    @08,@TF00001                                     03S0277
         MVC   VOLSER-2(6,@09),VUTENVOL-7(@08)                  03S0277
*                IF VUTENVIR(VUTCTR) = ON THEN /*IF A VIRTUAL VOL
*                                                            @Y30LPPG*/
         AL    @15,@TF00001                                     03S0278
         TM    VUTENVIR-7(@15),B'10000000'                      03S0278
         BNO   @RF00278                                         03S0278
*                  VOLVIRSW(VOLCTR) = ON; /*SAY SO IN LIST   @Y30LPPG*/
         AL    @14,@TF00002                                     03S0279
         AL    @14,@CF01959                                     03S0279
         OI    VOLVIRSW(@14),B'00010000'                        03S0279
*                VOLCTR = VOLCTR + ONE;/* NEXT SLOT FOR VOLSER       */
@RF00278 AL    VOLCTR,@CF00056                                  03S0280
*              END;                    /* END PUT VOLSER IN VOLLIST  */
*         END;                         /* END SCAN EACH ENTRY IN BLK */
@RF00275 AL    VUTCTR,@CF00056                                  03S0282
@DE00263 L     @01,VUTPTR                                       03S0282
         SLR   @00,@00                                          03S0282
         IC    @00,VUTENTNO(,@01)                               03S0282
         CR    VUTCTR,@00                                       03S0282
         BNH   @DL00263                                         03S0282
*         VUTPTR = VUTNPTR;            /* NEXT VUT BLOCK             */
         L     @02,VUTPTR                                       03S0283
         L     @02,VUTNPTR(,@02)                                03S0283
         ST    @02,VUTPTR                                       03S0283
*        END;                          /* END SCAN ALL VUT BLOCKS    */
@DE00262 ICM   @02,15,VUTPTR                                    03S0284
         BNZ   @DL00262                                         03S0284
*        TOTVOLS = VOLCTR - ONE;       /* NUMBER OF VOLS IN VOLLIST  */
         LR    TOTVOLS,VOLCTR                                   03S0285
         BCTR  TOTVOLS,0                                        03S0285
*        RLSECTR = TOTVOLS;            /* INIT NUMBER TO BE RELEASED
*                                         TO ALL IN LIST             */
         ST    TOTVOLS,RLSECTR                                  03S0286
*      END;                            /* END BUILD THE VOLLIST      */
*    ELSE                              /* UNSUCCESSFUL GETMAIN       */
*      DO;                             /* SET RETURN & REASON CODES  */
         B     @RC00258                                         03S0288
@RF00258 DS    0H                                               03S0289
*        RETCODE = ERROR;              /* BAD RETURN CODE            */
         MVC   RETCODE(2),@CH00098                              03S0289
*        RESNCODE = GETERROR;          /* GETMAIN ERROR              */
         L     @08,@PC00001+20                                  03S0290
         MVC   RESNCODE(2,@08),@CH00056                         03S0290
*      END;                            /* END SET RETN & RESN CODES  */
*END;                                  /* END BUILD THE VOLLIST      */
@RC00258 DS    0H                                               03S0293
*  END;                                /* END BUILD THE VOLUME LIST  */
@RF00233 DS    0H                                               02S0294
*LOKINDEX = ONE;                       /* INIT UCB LIST INDEX@Z40LPPK*/
@RF00210 LA    @08,1                                            02S0294
         LR    LOKINDEX,@08                                     02S0294
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - SCANUCBS                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - SCAN UCBS AND BUILD LIST OF UCB'S TO  @Z40LPPK*/
*/*                    LOCK, PLUS A LIST OF UCB'S CONTAINING @Z40LPPK*/
*/*                    FF VOLUME SERIALS                     @Z40LPPK*/
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO CHECK EACH UCB IN THE       */
*/*   SYSTEM AND DETERMINE IF THE VOLUME SERIAL IS IN THE VOLUME     */
*/*   LIST. IF THE VOLUME SERIAL IS IN THE VOLUME LIST, THE  @Z40LPPK*/
*/*   UCB ADDRESS MAY BE PUT INTO A LIST OF UCB POINTERS.    @Z40LPPK*/
*/*   THIS LIST WILL LATER BE USED TO SERIALIZE VIA THE      @Z40LPPK*/
*/*   ALLOCATION Q-MANAGER ON GROUPS REPRESENTING ALL        @Z40LPPK*/
*/*   UNITS IN THE LIST.                                     @Z40LPPK*/
*/*   WHEN BUILDING THE LIST OF UCB'S TO LOCK, THE DEVICE    @ZA32215*/
*/*   TYPE IS CHECKED TO DETERMINE IT'S CLASS. IF THE UCB    @ZA32215*/
*/*   IS DA, DAUCB IS SET ON. IF THE UCB IS TAPE OR UNIT     @ZA32215*/
*/*   RECORD, TPURUCB IS SET ON. DAUCB AND TPURUCB ARE       @ZA32215*/
*/*   THEN USED BY SEGMENT, LOCKUCBS, TO INDICATE TO IEFAB4EC@ZA32215*/
*/*   WHICH DDR RESOURCES TO SERIALIZE                       @ZA32215*/
*/*   EACH UCB IS ALSO CHECKED TO DETERMINE IF IT CONTAINS           */
*/*   A VOLUME SERIAL WITH HEX 'FF' IN THE FIRST BYTE AND THE ASID   */
*/*   OF THIS MEMORY IN THE FIFTH AND SIXTH BYTES. IF THIS IS THE    */
*/*   CASE, THE ADDRESS OF THE UCB IS ADDED TO THE FF SER LIST.      */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*                                                                  */
*/*     1. EACH UCB IS PICKED UP BY GOING DOWN THE IOS UCB           */
*/*        LOOKUP TABLE. ONLY NON-ZERO ENTRIES FROM THE LOOKUP       */
*/*        TABLE ARE USED.                                           */
*/*                                                                  */
*/*     2. IF A VOLUME LIST EXISTS THE FOLLOWING PROCESSING IS       */
*/*        PERFORMED:                                                */
*/*                                                                  */
*/*           THE VOLUME LIST IS SCANNED TO DETERMINE IF THE         */
*/*           VOLUME SERIAL IN THE UCB IS IN THE VOLLIST. IF IT IS,  */
*/*           AND THE VOLUME IS TO BE UNLOADED OR            @Z40LPPK*/
*/*           REWOUND OR THE UCB IS TO HAVE THE 'PASSED      @Z40LPPK*/
*/*           DATA SET' INDICATOR CLEARED,                   @Z40LPPK*/
*/*           THE UCB ADDRESS IS PLACED IN THE LIST TO       @Z40LPPK*/
*/*           BE SERIALIZED ON AND IN THE VOLLIST ENTRY      @Z40LPPK*/
*/*           ITSELF.  THE 'PROCESSED' SWITCH IS SET         @Z40LPPK*/
*/*           IN THE VOLLIST ENTRY, BECAUSE OF THE POSSIBI-  @Z40LPPK*/
*/*           LITY OF FINDING THE SAME UCB ADDRESS TWICE     @Z40LPPK*/
*/*           IN THE IOS UCB LOOKUP TABLE.                   @Z40LPPK*/
*/*                                                                  */
*/*     3. IF THE UCB CONTAINS A 'FF' SERIAL NUMBER WITH THE ASID    */
*/*        OF THIS MEMORY IT IS ADDED TO THE FF SER LIST. THE        */
*/*        FF SER LIST IS AN ARRAY CONTAINING                @Z40LPPK*/
*/*        SPACE FOR THIRTY UCB POINTERS.                    @Z40LPPK*/
*/*        SPACE FOR 100 UCB POINTERS.                       @Z40LPPK*/
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*   INPUT -                                                        */
*/*     VLISTENT - VOLUME LIST ENTRY                                 */
*/*       VOLSER - VOLUME SERIAL                                     */
*/*                                                                  */
*/*     IOSLUT - IOS UCB LOOKUP TABLE                                */
*/*                                                                  */
*/*     ASID -                                                       */
*/*       ASID OF THE MEMORY                                         */
*/*                                                                  */
*/*     TOTVOLS - NUMBER OF ENTRIES IN THE VOLUME LIST               */
*/*                                                                  */
*/* EXITS -                                                          */
*/* 1 CONDITION - NORMAL COMPLETION                                  */
*/*     OUTPUT -                                                     */
*/*       VLISTENT - VOLUME LIST ENTRY                               */
*/*          VOLUCBP - UCB ADDRESS                                   */
*/*                                                                  */
*/*       FFSERBLK - FF SERIAL LIST ENTRY                    @Z40LPPK*/
*/*         FFSERUCB - UCB ADDRESS                                   */
*/*                                                                  */
*/*       LOKLISTP - POINTS TO UCB LIST IN GOTTEN CORE       @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       LOCKLIST - FILLED IN WITH UCB ADDRESSES OF UCB'S   @Z40LPPK*/
*/*                  CONTAINING VOLUME SERIALS MATCHING      @Z40LPPK*/
*/*                  THOSE IN THE VOLUME LIST.               @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       LOKINDEX - INDEX TO NEXT AVAILABLE SLOT IN         @Z40LPPK*/
*/*                  LOCKLIST                                @Z40LPPK*/
*/*                                                          @ZA32215*/
*/*       DAUCB - ON, INDICATING THERE IS AT LEAST ONE DA UCB@ZA32215*/
*/*               IN THE UCB'S TO BE LOCKED                  @ZA32215*/
*/*                                                                  */
*/*       TPURUCB - ON, INDICATING THERE IS AT LEAST ONE TAPE@ZA32215*/
*/*                 OR UNIT RECORD UCB IN THE UCB'S TO BE    @ZA32215*/
*/*                 LOCKED                                   @ZA32215*/
*/*     RETURN CODE -                                                */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/* 2 CONDITION - CORE NOT AVAILABLE FOR FF SER LIST                 */
*/*     OUTPUT -                                                     */
*/*       SAME AS ABOVE EXCEPT SOME FF SERIALS NOT PROCESSED         */
*/*       REASON CODE -                                              */
*/*         RESNCODE = 1                                             */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 4                                                */
*/*                                                                  */
*/********************************************************************/
*LOKVOLS = ZERO;                       /* INIT COUNT         @Z40LPPK*/
         SLR   LOKVOLS,LOKVOLS                                  03S0295
*DAUCB = OFF;                          /*INITIALIZE          @ZA32215*/
*TPURUCB = OFF;                        /*INITIALIZE          @ZA32215*/
*TPURUCB = OFF;                        /*INITIALIZE          @ZA32215*/
         NI    DAUCB,B'11111001'                                03S0298
*VMVREQBP = VOLCOREP +                 /* PTR FOR 1ST VM&V RB@Z40LPPK*/
*           TOTVOLS * LENGTH(VLISTENT); /* JUST PAST VOLLIST @Z40LPPK*/
         LR    VMVREQBP,TOTVOLS                                 03S0299
         SLA   VMVREQBP,4                                       03S0299
         AL    VMVREQBP,VOLCOREP                                03S0299
*LOKLISTP = VMVREQBP +                 /* ADDR OF LIST OF UCB'S TO
*                                         LOCK ON.           @Z40LPPK*/
*           TOTVOLS * LENGTH(VMVRQBLK); /* JUST PAST VM&VRB'S@Z40LPPK*/
         LR    @05,TOTVOLS                                      03S0300
         MH    @05,@CH01924                                     03S0300
         ALR   @05,VMVREQBP                                     03S0300
         ST    @05,LOKLISTP                                     03S0300
*DO LUTCTR = ONE BY ONE                /* PROCESS EACH ENTRY IN LUT  */
*    WHILE (IOSLUT(LUTCTR) ^= LUTEND); /* STOP AT END OF TABLE       */
         LR    LUTCTR,@08                                       03S0301
         B     @DE00301                                         03S0301
@DL00301 DS    0H                                               03S0302
*  UCBPTR = IOSLUT(LUTCTR);            /* PICK UP UCB ADDRESS        */
         LR    @08,LUTCTR                                       03S0302
         ALR   @08,@08                                          03S0302
         L     @15,@PC00001+24                                  03S0302
         L     @01,IOSLUTP(,@15)                                03S0302
         ALR   @01,@08                                          03S0302
         BCTR  @01,0                                            03S0302
         BCTR  @01,0                                            03S0302
         SLR   UCBPTR,UCBPTR                                    03S0302
         ICM   UCBPTR,3,IOSLUT(@01)                             03S0302
*  IF UCBPTR ^= ZERO &                 /* LUT ENTRY IS VALID         */
*      (UCB3TAPE = ON × UCB3DACC = ON) THEN /* TAPE OR DA            */
         SLR   @08,@08                                          03S0303
         CR    UCBPTR,@08                                       03S0303
         BE    @RF00303                                         03S0303
         TM    UCB3TAPE(UCBPTR),B'10100000'                     03S0303
         BZ    @RF00303                                         03S0303
*    DO;                               /* PROCESS THE UCB            */
*      FOUNDSW = OFF;                  /* INIT FOUND SWITCH          */
         NI    FOUNDSW,B'11011111'                              03S0305
*      IF VOLCOREP ^= ZERO THEN        /* VOLLIST WAS BUILT          */
         C     @08,VOLCOREP                                     03S0306
         BE    @RF00306                                         03S0306
*        DO VOLCTR = ONE TO TOTVOLS    /* SCAN VOLLIST FOR UCBVOLI   */
*            WHILE (FOUNDSW = OFF);    /* STOP SCAN IF FOUND         */
         LA    VOLCTR,1                                         03S0307
         B     @DE00307                                         03S0307
@DL00307 TM    FOUNDSW,B'00100000'                              03S0307
         BNZ   @DC00307                                         03S0307
*          IF VOLSER(VOLCTR) = UCBVOLI & /* VOLSERS MATCH @Z40LPPK*/
*             VOLFNDSW(VOLCTR)=OFF THEN /*VOLUME NOT ALREADY    03S0308
*                                         PROCESSED          @Z40LPPK*/
         L     @08,VOLCOREP                                     03S0308
         LR    @15,VOLCTR                                       03S0308
         SLA   @15,4                                            03S0308
         ST    @15,@TF00001                                     03S0308
         ALR   @15,@08                                          03S0308
         AL    @15,@CF01958                                     03S0308
         CLC   VOLSER-2(6,@15),UCBVOLI(UCBPTR)                  03S0308
         BNE   @RF00308                                         03S0308
         LR    @01,@08                                          03S0308
         AL    @01,@TF00001                                     03S0308
         AL    @01,@CF01959                                     03S0308
         TM    VOLFNDSW(@01),B'00100000'                        03S0308
         BNZ   @RF00308                                         03S0308
*            DO;                                                03S0309
*              VOLFNDSW(VOLCTR)=ON;    /*INDICATE VOL FOUND  @Z40LPPK*/
         AL    @08,@TF00001                                     03S0310
         AL    @08,@CF01959                                     03S0310
         OI    VOLFNDSW(@08),B'00100000'                        03S0310
*              FOUNDSW = ON;           /* SET FOUND SWITCH           */
         OI    FOUNDSW,B'00100000'                              03S0311
*              IF ((UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RES
*D  */             (UCBBPRV = ON  ×           /* PRIVATE OR        @Z40
*PPE*/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z40
*PPE*/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z40
*PPE*/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z40
*PPE*/             (UCBJES3 = OFF ×          /*NOT JES3 MANAGED    @ZA0
*651*/              UCB3TAPE = ON ×          /*OR TAPE             @ZA0
*651*/              (UCBTYP(3:4) =           /*OR 3330V            @ZA0
*651*/                DEV3330     &          /*                    @ZA0
*651*/               UCBRVDEV = ON)) &       /*                    @ZA0
*651*/             UCBALOC = OFF &           /* NOT ALLOCATED   03S0312
*   */             UCBNALOC = OFF) ×/*                          03S0312
*                                         VOL IS UNLOADABLE  @Z40LPPK*/
*                  (UCB3TAPE = ON &          /*VOL IS TAPE      03S0312
*   */              UCBRESV = OFF &          /*NOT RESERVED     03S0312
*   */              UCBNALOC = OFF &         /*NOT NON-USABLE   03S0312
*   */              UCBALOC = OFF &          /*UNALLOCATED      03S0312
*   */              UCBBPUB = ON) ×/*                           03S0312
*                                         VOL IS REWINDABLE  @Z40LPPK*/
*                  UCBMONT = ON)       /* PASS/RETAIN INDICATOR ON
*                                         IN UCB             @Z40FPPK*/
*                & VOLUNLD(VOLCTR)=OFF THEN/*VOL NOT UNLOADED@ZD03010*/
         TM    UCBPRES(UCBPTR),B'00100100'                      03S0312
         BNZ   @GL00009                                         03S0312
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0312
         BO    @GL00012                                         03S0312
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0312
         BNE   @GL00009                                         03S0312
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0312
         BNO   @GL00009                                         03S0312
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0312
         BNO   @GL00009                                         03S0312
@GL00012 TM    UCBJES3(UCBPTR),B'01000000'                      03S0312
         BZ    @GL00011                                         03S0312
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0312
         BO    @GL00011                                         03S0312
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0312
         BNE   @GL00009                                         03S0312
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0312
         BNO   @GL00009                                         03S0312
@GL00011 TM    UCBALOC(UCBPTR),B'00001000'                      03S0312
         BNZ   @GL00009                                         03S0312
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0312
         BZ    @GL00007                                         03S0312
@GL00009 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0312
         BNO   @GL00008                                         03S0312
         TM    UCBRESV(UCBPTR),B'00100000'                      03S0312
         BNZ   @GL00008                                         03S0312
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0312
         BNZ   @GL00008                                         03S0312
         TM    UCBALOC(UCBPTR),B'00001000'                      03S0312
         BNZ   @GL00008                                         03S0312
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0312
         BO    @GL00007                                         03S0312
@GL00008 TM    UCBMONT(UCBPTR),B'00000001'                      03S0312
         BNO   @RF00312                                         03S0312
@GL00007 L     @08,VOLCOREP                                     03S0312
         LR    @15,VOLCTR                                       03S0312
         SLA   @15,4                                            03S0312
         ST    @15,@TF00001                                     03S0312
         ALR   @15,@08                                          03S0312
         AL    @15,@CF01959                                     03S0312
         TM    VOLUNLD(@15),B'01000000'                         03S0312
         BNZ   @RF00312                                         03S0312
*                DO;                   /* CHECK FOR UNLOADABLE VOL   */
*                  VOLUCBP(VOLCTR) = UCBPTR; /* GET UCB ADDR IN VLLST
*                                               ENT                  */
         L     @01,@TF00001                                     03S0314
         AL    @01,@CF01946                                     03S0314
         ST    UCBPTR,VOLUCBP-12(@01,@08)                       03S0314
*                  LOCKLIST(LOKINDEX) = UCBPTR; /* UCB TO LOCK ON
*                                                            @Z40LPPK*/
         LR    @15,LOKINDEX                                     03S0315
         SLA   @15,2                                            03S0315
         L     @01,LOKLISTP                                     03S0315
         ST    UCBPTR,LOCKLIST-4(@15,@01)                       03S0315
*                  VOLINDX(VOLCTR) = LOKINDEX; /* SAVE LOCK LIST INDEX
*                                                            @Z40LPPK*/
         L     @01,@TF00001                                     03S0316
         AL    @08,@CF01961                                     03S0316
         ST    LOKINDEX,VOLINDX-8(@01,@08)                      03S0316
*                  LOKVOLS = LOKVOLS + ONE; /* BUMP COUNT.   @Z40LPPK*/
         LA    @08,1                                            03S0317
         ALR   LOKVOLS,@08                                      03S0317
*                  LOKINDEX = LOKINDEX + 1;/* BUMP LIST COUNT@Z40LPPK*/
         ALR   LOKINDEX,@08                                     03S0318
*                  IF UCB3DACC = ON THEN /*DIRECT ACCESS?    @ZA32215*/
         TM    UCB3DACC(UCBPTR),B'00100000'                     03S0319
         BNO   @RF00319                                         03S0319
*                    DAUCB = ON;       /*INDICATE DA UCB     @ZA32215*/
         OI    DAUCB,B'00000100'                                03S0320
*                  IF UCB3UREC = ON THEN /* UNIT RECORD ?    @ZA32215*/
@RF00319 TM    UCB3UREC(UCBPTR),B'00001000'                     03S0321
         BNO   @RF00321                                         03S0321
*                    TPURUCB = ON;     /*INDICATE TAPE×UR UCB@ZA32215*/
         OI    TPURUCB,B'00000010'                              03S0322
*                  IF UCB3TAPE = ON THEN /* TAPE             @ZA32215*/
@RF00321 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0323
         BNO   @RF00323                                         03S0323
*                    TPURUCB = ON;     /*INDICATE TAPE×UR UCB@ZA32215*/
         OI    TPURUCB,B'00000010'                              03S0324
*                END;                  /* END CHECK UNLDABLE VOLUME  */
*              ELSE                                             03S0326
*                DO;                   /*                    @Z40LPPK*/
         B     @RC00312                                         03S0326
@RF00312 DS    0H                                               03S0327
*                  VOLIGNOR(VOLCTR)=ON;/*SET IGNORE INDICATOR@Z40LPPK*/
         LR    @08,VOLCTR                                       03S0327
         SLA   @08,4                                            03S0327
         L     @01,VOLCOREP                                     03S0327
         ALR   @01,@08                                          03S0327
         AL    @01,@CF01959                                     03S0327
         OI    VOLIGNOR(@01),B'10000000'                        03S0327
*                  RLSECTR=RLSECTR-ONE; /*DECREMENT NO. VOLS IN 03S0328
*                                         RELEASE MESSAGE    @Z40LPPK*/
         L     @08,RLSECTR                                      03S0328
         BCTR  @08,0                                            03S0328
         ST    @08,RLSECTR                                      03S0328
*                END;                  /*                    @Z40LPPK*/
*            END;                                               03S0330
@RC00312 DS    0H                                               03S0331
*        END;                          /* END SCAN VOLLIST           */
@RF00308 AL    VOLCTR,@CF00056                                  03S0331
@DE00307 CR    VOLCTR,TOTVOLS                                   03S0331
         BNH   @DL00307                                         03S0331
@DC00307 DS    0H                                               03S0332
*      IF UCBVOLI(1) = NSTAPE &        /* NON-SPEC UNOPENED TAPE     */
*          UCBVOLI(5:6) = ASID THEN    /* ASID IN VOLSER MATCHES OURS*/
@RF00306 CLI   UCBVOLI(UCBPTR),X'FF'                            03S0332
         BNE   @RF00332                                         03S0332
         CLC   UCBVOLI+4(2,UCBPTR),ASID                         03S0332
         BNE   @RF00332                                         03S0332
*        DO;                           /* ADD UCB TO FF SER LIST     */
*          FFSERCTR = FFSERCTR + ONE;  /* INCREMENT FFSER COUNT      */
         LA    @08,1                                            03S0334
         AL    @08,FFSERCTR                                     03S0334
         ST    @08,FFSERCTR                                     03S0334
*          IF FFSERCTR > DIM(FFSERUCB) THEN /* BLOCK FULL?  @Z40LPPK*/
         CH    @08,@CH00088                                     03S0335
         BNH   @RF00335                                         03S0335
*            FFSERCTR = FFSERCTR - ONE; /* SET INDEX TO REUSE LAST
*                                          ENTRY.            @Z40LPPK*/
         BCTR  @08,0                                            03S0336
         ST    @08,FFSERCTR                                     03S0336
*          FFSERUCB(FFSERCTR) = UCBPTR; /* SAVE UCB ADDRESS          */
@RF00335 L     @08,FFSERCTR                                     03S0337
         SLA   @08,2                                            03S0337
         ST    UCBPTR,FFSERUCB-4(@08)                           03S0337
*        END;                          /* END ADD UCB TO LIST        */
*    END;                              /* END PROCESS UCB            */
@RF00332 DS    0H                                               03S0340
*END;                                  /* END PROCESS EACH LUT ENTRY */
@RF00303 AL    LUTCTR,@CF00056                                  03S0340
@DE00301 LR    @08,LUTCTR                                       03S0340
         ALR   @08,@08                                          03S0340
         L     @15,@PC00001+24                                  03S0340
         L     @01,IOSLUTP(,@15)                                03S0340
         ALR   @01,@08                                          03S0340
         BCTR  @01,0                                            03S0340
         BCTR  @01,0                                            03S0340
         CLC   IOSLUT(2,@01),@CH00166                           03S0340
         BNE   @DL00301                                         03S0340
*LOCKOKSW = OFF;                       /* ASSUME FAILURE.    @Z40LPPK*/
         NI    LOCKOKSW,B'11101111'                             02S0341
*IF FFSERCTR ^= ZERO ×                 /* FFSER UCB'S TO LOCK@Z40LPPK*/
*   LOKINDEX > ONE THEN                /* REW/UNLD UCB'S TO LOCK
*                                                            @Z40LPPK*/
         ICM   @08,15,FFSERCTR                                  02S0342
         BNZ   @RT00342                                         02S0342
         CH    LOKINDEX,@CH00056                                02S0342
         BNH   @RF00342                                         02S0342
@RT00342 DS    0H                                               02S0343
*  DO;                                 /* LOCK NEEDED GROUPS @Z40LPPK*/
*/***********************************************************@Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* SEGMENT NAME - LOCKUCBS                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* DESCRIPTIVE NAME - LOCK UCB'S FOR VOLUME UNLOADING AND   @Z40LPPK*/
*/*                    UCB CLEANUP                           @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* FUNCTION -                                               @Z40LPPK*/
*/*   THIS SEGMENT SERIALIZES ON THE DEVICE GROUPS NECESSARY @Z40LPPK*/
*/*   TO PROTECT VOLUME UNLOADING AND UCB CLEANUP PROCESSING.@Z40LPPK*/
*/*   OPERATION -                                            @Z40LPPK*/
*/*     1. IF CORE WERE OBTAINED FOR A VOLUME LIST, ETC.,    @Z40LPPK*/
*/*        THE LIST OF UCB'S TO BE SERIALIZED IS ASSEMBLED   @Z40LPPK*/
*/*        IN THE SAME BLOCK OF CORE OBTAINED FOR THE        @Z40LPPK*/
*/*        VOLUME LIST, ETC.  THIS UCB LIST FOLLOWS THE      @Z40LPPK*/
*/*        VM&V RB'S IN THAT BLOCK OF CORE.  UCB POINTERS    @Z40LPPK*/
*/*        REPRESENTING VOLUME LIST ENTRIES HAVE ALREADY     @Z40LPPK*/
*/*        BEEN PLACED IN THE LIST.  UCB POINTERS REPRE-     @Z40LPPK*/
*/*        SENTING FF VOLSER LIST ENTRIES ARE MOVED INTO     @Z40LPPK*/
*/*        THE LIST.                                         @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*        IF CORE WERE NOT OBTAINED FOR THE VOLUME LIST, OR @Z40LPPK*/
*/*        NO UCB PTRS FOR VOLLIST ENTRIES WERE MADE IN THE  @Z40LPPK*/
*/*        UCB LIST, THE FF VOLSER UCB BLOCK IS USED AS      @Z40LPPK*/
*/*        INPUT TO THE LOCKING MODULE.                      @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     2. IF THE LIST OF UCB'S NEEDING SERIALIZATION IS     @Z40LPPK*/
*/*        NOT EMPTY, THE GROUP LOCKING SERVICE ROUTINE      @Z40LPPK*/
*/*        IS CALLED.                                        @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     3. IF THE GROUP LOCKING ROUTINE IS SUCCESSFUL,       @Z40LPPK*/
*/*        AN INDICATOR IS SET, SAYING GROUPS WERE LOCKED.   @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* ENTRY - IN-LINE SEGMENT                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   PURPOSE - SEE FUNCTION                                 @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   INPUT -                                                @Z40LPPK*/
*/*     LOCKLIST - LIST OF UCB PTRS FOR UNLOADING/REWINDING  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     LOKLISTP - PTR TO LOCKLIST                           @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     FFSERBLK - BLK OF FFSER UCB PTRS                     @Z40LPPK*/
*/*       FFSERCTR - NO. OF UCB PTRS IN BLOCK                @Z40LPPK*/
*/*       FFSERUCB - UCB PTR                                 @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     LOKINDEX - INDEX TO NEXT AVAILABLE SLOT IN LOCKLIST  @Z40LPPK*/
*/*                ALSO, COUNT - PLUS ONE, OF ENTRIES IN     @Z40LPPK*/
*/*                LOCKLIST                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     LOCKOKSW - OFF, INDICATING NO LOCKING DONE YET       @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* EXIT -                                                   @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   1 CONDITION - NORMAL                                   @Z40LPPK*/
*/*       OUTPUT -                                           @Z40LPPK*/
*/*                                                          @ZA32215*/
*/*     DAUCB - ON, INDICATING THERE IS AT LEAST ONE DA UCB  @ZA32215*/
*/*             IN THE UCB'S TO BE LOCKED AND SO IEFAB4EC    @ZA32215*/
*/*             MUST BE TOLD TO SERIALIZE THE DDR DA         @ZA32215*/
*/*             RESOURCE.                                    @ZA32215*/
*/*                                                             03S0344
*/*     TPURUCB - ON, INDICATING THERE IS AT LEAST ONE TAPE  @ZA32215*/
*/*               OR UNIT RECORD UCB IN THE UCB'S TO BE      @ZA32215*/
*/*               LOCKED AND SO IEFAB4EC MUST BE TOLD TO     @ZA32215*/
*/*              SERIALIZE THE DDR TAPE×UNIT RECORD RESOURCE @ZA32215*/
*/*         LOCKLIST -                                       @Z40LPPK*/
*/*           0 SLOT INDICATES UCB GROUP NOT LOCKED.         @Z40LPPK*/
*/*           NON-0 SLOT (IE.,CONTAINING UCB PTR)  INDICATES @Z40LPPK*/
*/*             THAT THE UCB'S GROUP WAS LOCKED.             @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*         LOCKOKSW - ON                                    @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   2 CONDITION - ESTAE ERROR IN GROUP LOCKING ROUTINE     @Z40LPPK*/
*/*       OUTPUT                                             @Z40LPPK*/
*/*         REASON CODE -                                    @Z40LPPK*/
*/*           RESNCODE = 4                                   @Z40LPPK*/
*/*       RETURN CODE -                                      @Z40LPPK*/
*/*         RETCODE = 4                                      @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   3 CONDITION - NON-ESTAE ERROR IN GROUP LOCKING RTN     @Z40LPPK*/
*/*       OUTPUT -                                           @Z40LPPK*/
*/*         FUNCTION NOT PERFORMED                           @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       RETURN CODE - NONE                                 @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/***********************************************************@Z40LPPK*/
*IF LOKINDEX > ONE THEN                /* ANY ENTRIES YET?   @Z40LPPK*/
         LA    @08,1                                            03S0344
         CR    LOKINDEX,@08                                     03S0344
         BNH   @RF00344                                         03S0344
*  DO;                                 /* ADD FFSER UCB'S    @Z40LPPK*/
*    IF FFSERCTR > ZERO THEN           /* ANY FFSER UCB'S    @Z40LPPK*/
         ICM   @05,15,FFSERCTR                                  03S0346
         BNP   @RF00346                                         03S0346
*      DO SERCTR = ONE TO FFSERCTR;    /* PUT FFSER UCB'S INTO LIST
*                                         BEHIND VOLLIST UCBS@Z40LPPK*/
         LR    SERCTR,@08                                       03S0347
         B     @DE00347                                         03S0347
@DL00347 DS    0H                                               03S0348
*        LOCKLIST(LOKINDEX) = FFSERUCB(SERCTR); /* IN IT GOES@Z40LPPK*/
         LR    @08,LOKINDEX                                     03S0348
         SLA   @08,2                                            03S0348
         LR    @15,SERCTR                                       03S0348
         SLA   @15,2                                            03S0348
         L     @15,FFSERUCB-4(@15)                              03S0348
         L     @14,LOKLISTP                                     03S0348
         ST    @15,LOCKLIST-4(@08,@14)                          03S0348
*        LOKINDEX = LOKINDEX + ONE;    /* INDEX TO NEXT SLOT @Z40LPPK*/
         AL    LOKINDEX,@CF00056                                03S0349
*      END;                            /* DONE FILLING LIST  @Z40LPPK*/
         AL    SERCTR,@CF00056                                  03S0350
@DE00347 C     SERCTR,FFSERCTR                                  03S0350
         BNH   @DL00347                                         03S0350
*    LOCKNUM = LOKINDEX - ONE;         /* # ENTRIES IN LIST  @Z40LPPK*/
@RF00346 LR    @08,LOKINDEX                                     03S0351
         BCTR  @08,0                                            03S0351
         L     @05,LOKLISTP                                     03S0351
         ST    @08,LOCKNUM(,@05)                                03S0351
*  END;                                /* END FFSER UCB'S    @Z40LPPK*/
*ELSE                                  /* NO ENTRIES YET     @Z40LPPK*/
*  LOKLISTP = ADDR(FFSERBLK);          /* USE FFSER BLOCK    @Z40LPPK*/
         B     @RC00344                                         03S0353
@RF00344 LA    @08,FFSERBLK                                     03S0353
         ST    @08,LOKLISTP                                     03S0353
*IF LOCKNUM > ZERO THEN                /* ANYTHING TO LOCK   @Z40LPPK*/
@RC00344 SLR   @08,@08                                          03S0354
         L     @01,LOKLISTP                                     03S0354
         C     @08,LOCKNUM(,@01)                                03S0354
         BNL   @RF00354                                         03S0354
*  DO;                                 /* LOCK GROUPS        @Z40LPPK*/
*    LOCKFMAP = LOCKFMAP && LOCKFMAP;  /* CLEAR FUNC MAP     @Z40LPPK*/
         XC    LOCKFMAP(1),LOCKFMAP                             03S0356
*    LOCKGET = ON;                     /* GET LOCKS          @Z40LPPK*/
         OI    LOCKGET,B'10000000'                              03S0357
*    LOKWORKP = ZERO;                  /* CLEAR FOR LOCKER   @Z40LPPK*/
         ST    @08,LOKWORKP                                     03S0358
*    GROUPMSK = GROUPMSK && GROUPMSK;  /* CLEAR MASK AREA    @Z40LPPK*/
         XC    GROUPMSK(240),GROUPMSK                           03S0359
*    GRPMASKP = ADDR(GROUPMSK);        /* POINT TO MASK AREA @Z40LPPK*/
         LA    @08,GROUPMSK                                     03S0360
         ST    @08,GRPMASKP                                     03S0360
*    IF DAUCB = ON THEN                /* DA UCB             @ZA32215*/
         TM    DAUCB,B'00000100'                                03S0361
         BNO   @RF00361                                         03S0361
*      DDRDA = ON;                     /* YES  ENQ DDR DA    @ZA32215*/
         OI    DDRDA,B'00010000'                                03S0362
*    IF TPURUCB = ON THEN              /* TAPE×UNIT REC UCB  @ZA32215*/
@RF00361 TM    TPURUCB,B'00000010'                              03S0363
         BNO   @RF00363                                         03S0363
*      DDRTPUR = ON;                   /* YES, ENQ DDR TP×UR @ZA32215*/
         OI    DDRTPUR,B'00100000'                              03S0364
*    CALL IEFAB4EC                     /* CALL GROUP LOCKING    03S0365
*                                         SERVICE ROUTINE    @Z40LPPK*/
*       (LOCKFMAP,LOKLISTP,GRPMASKP,JSCBPTR,LOKWORKP); /*    @Z40LPPK*/
@RF00363 LA    @08,LOCKFMAP                                     03S0365
         ST    @08,@AL00001                                     03S0365
         LA    @08,LOKLISTP                                     03S0365
         ST    @08,@AL00001+4                                   03S0365
         LA    @08,GRPMASKP                                     03S0365
         ST    @08,@AL00001+8                                   03S0365
         L     @08,@PC00001+4                                   03S0365
         ST    @08,@AL00001+12                                  03S0365
         LA    @08,LOKWORKP                                     03S0365
         ST    @08,@AL00001+16                                  03S0365
         L     @15,@CV00189                                     03S0365
         LA    @01,@AL00001                                     03S0365
         BALR  @14,@15                                          03S0365
*    LOCKRC = REG15;                   /* GET RETURN CODE    @Z40LPPK*/
         LR    LOCKRC,REG15                                     03S0366
*    IF LOCKRC ^= ZERO THEN            /* FAILURE BY LOCKER? @Z40LPPK*/
         LTR   LOCKRC,LOCKRC                                    03S0367
         BZ    @RF00367                                         03S0367
*      IF LOCKRC = ESTAERR THEN        /* ESTAE ERROR?       @Z40LPPK*/
         LA    @08,4                                            03S0368
         CR    LOCKRC,@08                                       03S0368
         BNE   @RF00368                                         03S0368
*        DO;                           /* YES, SET CODES     @Z40LPPK*/
*          RESNCODE = ESTAERR;         /* REASON CODE        @Z40LPPK*/
         L     @15,@PC00001+20                                  03S0370
         STH   @08,RESNCODE(,@15)                               03S0370
*          RETCODE = ERROR;            /* RETURN CODE        @Z40LPPK*/
         STH   @08,RETCODE                                      03S0371
*        END;                                                   03S0372
*      ELSE;                           /* NOT ESTAE ERROR    @Z40LPPK*/
@RF00368 DS    0H                                               03S0374
*    ELSE                              /* NO ERROR           @Z40LPPK*/
*      LOCKOKSW = ON;                  /* LOCKING DONE OK    @Z40LPPK*/
         B     @RC00367                                         03S0374
@RF00367 OI    LOCKOKSW,B'00010000'                             03S0374
*  END;                                /* DONE GROUP LOCKING @Z40LPPK*/
@RC00367 DS    0H                                               03S0376
*  END;                                /*                    @Z40LPPK*/
@RF00354 DS    0H                                               02S0377
*IF LOCKOKSW = ON THEN                 /* LOCKING SUCCESSFUL @Z40LPPK*/
@RF00342 TM    LOCKOKSW,B'00010000'                             02S0377
         BNO   @RF00377                                         02S0377
*  DO;                                 /* DO VOLUME UNLOADING AND
*                                         UCB CLEANUP.       @Z40LPPK*/
*/********************************************************************/
*/*                                                          @Z40LPPK*/
*/* SEGMENT NAME - BUILDRBS                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* DESCRIPTIVE NAME - BUILD VM&V RB'S                       @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* FUNCTION -                                               @Z40LPPK*/
*/*   THE FUNCTION OF THIS SEGMENT IS TO BUILD VOLUME MOUNT  @Z40LPPK*/
*/*   AND VERIFY REQUEST BLOCKS FOR THE JOB'S VOLUMES WHICH  @Z40LPPK*/
*/*   ARE TO BE UNLOADED OR REWOUND.                         @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   OPERATION -                                            @Z40LPPK*/
*/*   EACH ENTRY IN THE VOLUME LIST IS CHECKED TO SEE IF THE @Z40LPPK*/
*/*   VOLUME SERIAL IN THE ENTRY IS THE SAME VOLUME SERIAL   @Z40LPPK*/
*/*   IN THE UCB POINTED TO BY THE VOLUME LIST ENTRY.  IF    @Z40LPPK*/
*/*   THE VOLSER IS THE SAME IN BOTH PLACES, WASN'T UNLOADED @ZD03010*/
*/*   BY UNIT UNALLOC DURING THE JOB, AND HAS THE FOLLOWING  @ZD03010*/
*/*   CHARACTERISTICS, AN UNLOAD VM&V REQUEST BLOCK IS BUILT         */
*/*   AND CHAINED FOR IT:                                            */
*/*      . VOLUME IS REMOVABLE                                       */
*/*      . VOLUME IS PRIVATE OR IS PUBLIC MSS VOLUME         @Z40LPPE*/
*/*      . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION             */
*/*      . VOLUME IS UNALLOCATED                                     */
*/*      . VOLUME IS TAPE OR DA                                      */
*/*      . VOLUME IS NOT ON A JES3-MANAGED DIRECT ACCESS     @ZA06651*/
*/*        UNIT (UNLESS THE UNIT IS 3330V). JES3 ISSUES      @ZA06651*/
*/*        MOUNT/DEMOUNT MESSAGES FOR NON-3330V, D.A., JES3  @ZA06651*/
*/*        MANAGED UNITS. A DEMOUNT MESSAGE ISSUED VIA       @ZA06651*/
*/*        IEFBB416 CALLING VM&V WOULD CONFUSE THE OPERATOR  @ZA06651*/
*/*        OR POSSIBLY EVEN DESTROY A JES3 SETUP.            @ZA06651*/
*/*   IF IT IS IN THE VOLUME LIST AND HAS THE FOLLOWING              */
*/*   CHARACTERISTICS A REWIND VM&V REQUEST BLOCK IS BUILT AND       */
*/*   CHAINED FOR IT:                                                */
*/*      . VOLUME IS REMOVABLE                                       */
*/*      . VOLUME IS A TAPE                                          */
*/*      . VOLUME IS PUBLIC                                          */
*/*      . VOLUME IS NOT MARKED NON-USABLE BY ALLOCATION             */
*/*      . VOLUME IS UNALLOCATED                                     */
*/*   IF THE VOLUME IS FOUND IN THE VOLLIST BUT DOES NOT HAVE        */
*/*   THE ABOVE CHARACTERISTICS, THE IGNORE-ENTRY INDICATOR IN       */
*/*   THE VOLLIST ENTRY IS SET.                                      */
*/*   EACH TIME A VOLUME SERIAL IN THE UCB MATCHES ONE IN THE        */
*/*   VOLLIST, THE NUMBER OF VOLUMES TO GO INTO THE 'RELEASE'        */
*/*   MESSAGE IS DECREMENTED.                                        */
*/* ENTRY - IN-LINE SEGMENT                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   PURPOSE - SEE FUNCTION                                 @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   INPUT -                                                @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     VOLUME LIST                                          @Z40LPPK*/
*/*     UCB'S - POINTED TO BY VOLUME LIST ENTRIES            @Z40LPPK*/
*/*     TOTVOLS - # OF ENTRIES IN THE VOLUME LIST            @Z40LPPK*/
*/*     RLSECTR - # OF VOLSERS FOR RELEASED MSG              @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/* EXITS -                                                  @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*   CONDITION - NORMAL COMPLETION                          @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*     OUTPUT -                                             @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       VMVRQBLK - VM&V RB'S BUILT                         @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       RLSECTR - # OF VOLSERS TO BE RELEASED              @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       FUNLDRBP - ADDRESS OF FIRST VM&V RB                @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*       VOLLIST - ENTRIES UPDATED                          @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/*    RETURN CODE - NONE                                    @Z40LPPK*/
*/*                                                          @Z40LPPK*/
*/***********************************************************@Z40LPPK*/
*IF LOCKNUM > FFSERCTR THEN            /* DID ANY UCB'S IN UCB LIST
*                                         COME FROM VOLLIST? @Z40LPPK*/
         L     @08,LOKLISTP                                     03S0379
         L     @08,LOCKNUM(,@08)                                03S0379
         C     @08,FFSERCTR                                     03S0379
         BNH   @RF00379                                         03S0379
*  DO VOLCTR = ONE TO TOTVOLS;         /* YES, SCAN VOLLIST  @Z40LPPK*/
         LA    VOLCTR,1                                         03S0380
         B     @DE00380                                         03S0380
@DL00380 DS    0H                                               03S0381
*    IF VOLINDX(VOLCTR) ^= ZERO THEN   /* WAS A UCB LIST ENTRY MADE
*                                         FOR THIS VOLLIST ENTRY?
*                                                            @Z40LPPK*/
         SLR   @08,@08                                          03S0381
         L     @02,VOLCOREP                                     03S0381
         LR    @15,VOLCTR                                       03S0381
         SLA   @15,4                                            03S0381
         LA    @01,0(@15,@02)                                   03S0381
         AL    @01,@CF01961                                     03S0381
         L     @14,VOLINDX-8(,@01)                              03S0381
         CR    @14,@08                                          03S0381
         BE    @RF00381                                         03S0381
*      DO;                             /* MAYBE BUILD VM&V RB@Z40LPPK*/
*        LOKINDEX = VOLINDX(VOLCTR);   /* CUR UCB LIST ENTRY @Z40LPPK*/
         LR    LOKINDEX,@14                                     03S0383
*        UCBPTR = VOLUCBP(VOLCTR);     /* UCB FROM VOLLIST   @Z40LPPK*/
         L     @05,VOLCOREP                                     03S0384
         LA    @01,0(@15,@05)                                   03S0384
         AL    @01,@CF01946                                     03S0384
         L     UCBPTR,VOLUCBP-12(,@01)                          03S0384
*        IF LOCKLIST(LOKINDEX)^= ZERO & /* GROUP WAS LOCKED  @Z40LPPK*/
*           VOLSER(VOLCTR) = UCBVOLI THEN /* VOL STILL MNTD  @Z40LPPK*/
         LR    @14,LOKINDEX                                     03S0385
         SLA   @14,2                                            03S0385
         L     @01,LOKLISTP                                     03S0385
         C     @08,LOCKLIST-4(@14,@01)                          03S0385
         BE    @RF00385                                         03S0385
         ST    @15,@TF00001                                     03S0385
         ALR   @15,@05                                          03S0385
         AL    @15,@CF01958                                     03S0385
         CLC   VOLSER-2(6,@15),UCBVOLI(UCBPTR)                  03S0385
         BNE   @RF00385                                         03S0385
*          DO;                         /* MAYBE BUILD VMV RB @Z40LPPK*/
*            RLSECTR = RLSECTR - ONE;  /* ONE LESS VOL FOR RETAINED
*                                         VOLS RELEASED MSG. @Z40LPPK*/
         L     @08,RLSECTR                                      03S0387
         BCTR  @08,0                                            03S0387
         ST    @08,RLSECTR                                      03S0387
*            VOLIGNOR(VOLCTR) = ON;    /* VOL NOT IN RLSE MSG@Z40LPPK*/
         AL    @05,@TF00001                                     03S0388
         AL    @05,@CF01959                                     03S0388
         OI    VOLIGNOR(@05),B'10000000'                        03S0388
*            IF (UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RESVD
**/             (UCBBPRV = ON  ×           /* PRIVATE OR        @Z40LPP
**/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z40LPP
**/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z40LPP
**/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z40LPP
**/             (UCBJES3 = OFF ×          /*NOT JES3 MANAGED    @ZA0665
**/              UCB3TAPE = ON ×          /*OR TAPE             @ZA0665
**/              (UCBTYP(3:4) =           /*OR 3330V            @ZA0665
**/                DEV3330     &          /*                    @ZA0665
**/               UCBRVDEV = ON)) &       /*                    @ZA0665
**/             UCBALOC = OFF &           /* NOT ALLOCATED      03S0389
**/             UCBNALOC = OFF) ×/*                             03S0389
*                                         VOL STILL UNLDABLE @Z40LPPK*/
*               (UCB3TAPE = ON &          /*VOL IS TAPE         03S0389
**/              UCBRESV = OFF &          /*NOT RESERVED        03S0389
**/              UCBNALOC = OFF &         /*NOT NON-USABLE      03S0389
**/              UCBALOC = OFF &          /*UNALLOCATED         03S0389
**/              UCBBPUB = ON) THEN/*                           03S0389
*                                         VOL STILL RWNDABLE @Z40LPPK*/
         TM    UCBPRES(UCBPTR),B'00100100'                      03S0389
         BNZ   @GL00027                                         03S0389
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0389
         BO    @GL00030                                         03S0389
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0389
         BNE   @GL00027                                         03S0389
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0389
         BNO   @GL00027                                         03S0389
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0389
         BNO   @GL00027                                         03S0389
@GL00030 TM    UCBJES3(UCBPTR),B'01000000'                      03S0389
         BZ    @GL00029                                         03S0389
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0389
         BO    @GL00029                                         03S0389
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0389
         BNE   @GL00027                                         03S0389
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0389
         BNO   @GL00027                                         03S0389
@GL00029 TM    UCBALOC(UCBPTR),B'00001000'                      03S0389
         BNZ   @GL00027                                         03S0389
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0389
         BZ    @RT00389                                         03S0389
@GL00027 TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0389
         BNO   @RF00389                                         03S0389
         TM    UCBRESV(UCBPTR),B'00100000'                      03S0389
         BNZ   @RF00389                                         03S0389
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0389
         BNZ   @RF00389                                         03S0389
         TM    UCBALOC(UCBPTR),B'00001000'                      03S0389
         BNZ   @RF00389                                         03S0389
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0389
         BNO   @RF00389                                         03S0389
@RT00389 DS    0H                                               03S0390
*              DO;                     /* BUILD VM&V RB      @Z40LPPK*/
*                IF FUNLDRBP = ZERO THEN /* FIRST RB IN CHAIN        */
         ICM   @08,15,FUNLDRBP                                  03S0391
         BNZ   @RF00391                                         03S0391
*                  FUNLDRBP = VMVREQBP;  /* SET CHAIN HEADER         */
         ST    VMVREQBP,FUNLDRBP                                03S0392
*                ELSE                    /* NOT FIRST RB IN THE CHAIN*/
*                  DO;                 /*CHAIN THIS RB TO LAST       */
         B     @RC00391                                         03S0393
@RF00391 DS    0H                                               03S0394
*                    VMVNREQP = VMVREQBP + LENGTH(VMVRQBLK);    03S0394
         LA    @08,52                                           03S0394
         ALR   @08,VMVREQBP                                     03S0394
         ST    @08,VMVNREQP(,VMVREQBP)                          03S0394
*                    VMVREQBP = VMVNREQP; /* GET NEW RB PTR          */
         LR    VMVREQBP,@08                                     03S0395
*                  END;                /* END CHAIN THIS RB TO LAST  */
*                IF (UCBPRES = OFF & UCBRESV = OFF & /* NOT PERM RES/RE
*VD  */             (UCBBPRV = ON  ×           /* PRIVATE OR        @Z4
*LPPE*/              (UCBTYP(3:4)=DEV3330 &   /*3330                @Z4
*LPPE*/               UCBRVDEV=ON &           /*VIRTUAL DEVICE WITH @Z4
*LPPE*/               UCBBPUB=ON)) &          /*PUBLIC VOLUME       @Z4
*LPPE*/             (UCBJES3 = OFF ×          /*NOT JES3 MANAGED    @ZA
*6651*/              UCB3TAPE = ON ×          /*OR TAPE             @ZA
*6651*/              (UCBTYP(3:4) =           /*OR 3330V            @ZA
*6651*/                DEV3330     &          /*                    @ZA
*6651*/               UCBRVDEV = ON)) &       /*                    @ZA
*6651*/             UCBALOC = OFF &           /* NOT ALLOCATED  03S0397
*    */             UCBNALOC = OFF) THEN/*                      03S0397
*                                         IF UNLOADABLE      @Z40LPPE*/
@RC00391 TM    UCBPRES(UCBPTR),B'00100100'                      03S0397
         BNZ   @RF00397                                         03S0397
         TM    UCBBPRV(UCBPTR),B'00010000'                      03S0397
         BO    @GL00044                                         03S0397
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0397
         BNE   @RF00397                                         03S0397
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0397
         BNO   @RF00397                                         03S0397
         TM    UCBBPUB(UCBPTR),B'00001000'                      03S0397
         BNO   @RF00397                                         03S0397
@GL00044 TM    UCBJES3(UCBPTR),B'01000000'                      03S0397
         BZ    @GL00043                                         03S0397
         TM    UCB3TAPE(UCBPTR),B'10000000'                     03S0397
         BO    @GL00043                                         03S0397
         CLC   UCBTYP+2(2,UCBPTR),DEV3330                       03S0397
         BNE   @RF00397                                         03S0397
         TM    UCBRVDEV(UCBPTR),B'00001000'                     03S0397
         BNO   @RF00397                                         03S0397
@GL00043 TM    UCBALOC(UCBPTR),B'00001000'                      03S0397
         BNZ   @RF00397                                         03S0397
         TM    UCBNALOC(UCBPTR),B'00000100'                     03S0397
         BNZ   @RF00397                                         03S0397
*                  DO;                                          03S0398
*                    VMVUNLOD = ON;    /*INDICATE VOLUME UNLOAD      */
         OI    VMVUNLOD(VMVREQBP),B'10000000'                   03S0399
*                    VMVKEEP = ON;     /*ISSUE KEEP TYPE MESSAGE     */
         OI    VMVKEEP(VMVREQBP),B'10000000'                    03S0400
*                  END;                                         03S0401
*                ELSE                  /*VOLUME NOT PRIVATE          */
*                  DO;                 /*                    @ZA02721*/
         B     @RC00397                                         03S0402
@RF00397 DS    0H                                               03S0403
*                    VOLREWND(VOLCTR) = ON;    /*VOL REWOUND @ZA02721*/
         LR    @08,VOLCTR                                       03S0403
         SLA   @08,4                                            03S0403
         L     @01,VOLCOREP                                     03S0403
         ALR   @01,@08                                          03S0403
         AL    @01,@CF01959                                     03S0403
         OI    VOLREWND(@01),B'00001000'                        03S0403
*                    VMVREWND = ON;    /*REWIND VOLUME               */
         OI    VMVREWND(VMVREQBP),B'00100000'                   03S0404
*                  END;                /*                    @ZA02721*/
*                VMVUCBP = UCBPTR;     /*POINT TO UCB                */
@RC00397 STCM  UCBPTR,7,VMVUCBP(VMVREQBP)                       03S0406
*                VMVUCB = ON;          /*VOLSER IN UCB               */
         OI    VMVUCB(VMVREQBP),B'01000000'                     03S0407
*                VMVJBNMP = ADDR(JCTJNAME); /*POINT TO JOB NAME      */
         L     @08,@PC00001+8                                   03S0408
         L     @08,JCTPTR(,@08)                                 03S0408
         LA    @08,JCTJNAME(,@08)                               03S0408
         ST    @08,VMVJBNMP(,VMVREQBP)                          03S0408
*                VOLUNLD(VOLCTR) = ON; /*SET VOL UNLOADED , REWOUND
*                                        IN VOLLIST                  */
         LR    @08,VOLCTR                                       03S0409
         SLA   @08,4                                            03S0409
         L     @02,VOLCOREP                                     03S0409
         ALR   @02,@08                                          03S0409
         AL    @02,@CF01959                                     03S0409
         OI    VOLUNLD(@02),B'01000000'                         03S0409
*              END;                    /* END RB BUILD       @Z40LPPK*/
*          END;                        /*                    @Z40LPPK*/
*        ELSE                                             /* @ZA08095*/
*          IF LOCKLIST(LOKINDEX)^=ZERO & /* GRP WAS LOCKED   @ZA08095*/
*          VOLVIRSW(VOLCTR) = ON THEN  /* VIRTUAL VOLUME     @ZA08095*/
         B     @RC00385                                         03S0412
@RF00385 LR    @08,LOKINDEX                                     03S0412
         SLA   @08,2                                            03S0412
         L     @05,LOKLISTP                                     03S0412
         L     @08,LOCKLIST-4(@08,@05)                          03S0412
         LTR   @08,@08                                          03S0412
         BZ    @RF00412                                         03S0412
         L     @08,VOLCOREP                                     03S0412
         LR    @05,VOLCTR                                       03S0412
         SLA   @05,4                                            03S0412
         ST    @05,@TF00001                                     03S0412
         ALR   @05,@08                                          03S0412
         AL    @05,@CF01959                                     03S0412
         TM    VOLVIRSW(@05),B'00010000'                        03S0412
         BNO   @RF00412                                         03S0412
*          DO;                         /*                    @ZA08095*/
*            RLSECTR = RLSECTR - ONE;  /* ONE LESS VOL FOR   @ZA08095*/
         L     @02,RLSECTR                                      03S0414
         BCTR  @02,0                                            03S0414
         ST    @02,RLSECTR                                      03S0414
*            VOLIGNOR(VOLCTR) = ON;    /* VOLS RELEASED MSG  @ZA08095*/
         AL    @08,@TF00001                                     03S0415
         AL    @08,@CF01959                                     03S0415
         OI    VOLIGNOR(@08),B'10000000'                        03S0415
*          END;                        /*                    @ZA08095*/
*      END;                            /*                    @Z40LPPK*/
*    ELSE;                             /* VOL NOT UP ON SCAN BEFORE
*                                         UCB LOCKED         @Z40LPPK*/
@RF00381 DS    0H                                               03S0419
*  END;                                /* END VOLLIST SCAN   @Z40LPPK*/
@RC00381 AL    VOLCTR,@CF00056                                  03S0419
@DE00380 CR    VOLCTR,TOTVOLS                                   03S0419
         BNH   @DL00380                                         03S0419
*ELSE;                                 /* NO UCB LIST ENTRIES MADE
*                                         FOR VOLLIST ENTRIES@Z40LPPK*/
@RF00379 DS    0H                                               03S0421
*    IF FUNLDRBP ^= ZERO THEN          /*VOLUMES MUST BE UNLOADED    */
         ICM   @08,15,FUNLDRBP                                  02S0421
         BZ    @RF00421                                         02S0421
*      CALL IEFAB49C(FUNLDRBP,ZERO,ZERO); /* UNLOAD VOLUMES          */
         MVC   @AL00001+4(8),@AL00422                           02S0422
         LA    @08,FUNLDRBP                                     02S0422
         ST    @08,@AL00001                                     02S0422
         L     @15,@CV00192                                     02S0422
         LA    @01,@AL00001                                     02S0422
         BALR  @14,@15                                          02S0422
*     DO; /*MODESET  KEYADDR(ZERO)*/                            02S0423
@RF00421 DS    0H                                               02S0424
*       SPKA (ZERO); /*SET PSW KEY*/                            02S0424
         SLR   @08,@08                                          02S0424
         SPKA  0(@08)                                           02S0424
*     END; /*MODESET  KEYADDR(ZERO)*/           /* GET KEY ZERO FOR UCB
*UPDATE*/                                                       02S0425
*     DO; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(LOCAL) REGS(USE) RELATE
*(UCBS,IEFBB416(VOLCLNP)) */                                    02S0426
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0427
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0428
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0429
         LR    GPR15P,GPR11P                                    02S0429
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0430
         LR    GPR00P,GPR12P                                    02S0430
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0431
         LR    GPR01P,GPR13P                                    02S0431
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */
         L     GPR13P,PSALITA                                   02S0432
*       GEN(LM GPR11P,GPR13P,576(GPR13P)); /* LOAD LOCKWORD, CLHT AND E
*TRY ADRS. */                                                   02S0433
         LM GPR11P,GPR13P,576(GPR13P)
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0434
         BALR GPR14P,GPR13P
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0435
         LR    GPR11P,GPR15P                                    02S0435
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0436
         LR    GPR15P,GPR13P                                    02S0436
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0437
         LR    GPR12P,GPR00P                                    02S0437
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0438
         LR    GPR13P,GPR01P                                    02S0438
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0439
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0440
*     END; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(LOCAL) REGS(USE) RELAT
*D(UCBS,IEFBB416(VOLCLNP)) */                                   02S0441
*     DO; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(CMS) REGS(USE) RELATED(
*CBS,IEFBB416(VOLCLNP)) */                                      02S0442
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0443
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0444
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0445
         LR    GPR15P,GPR11P                                    02S0445
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0446
         LR    GPR00P,GPR12P                                    02S0446
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0447
         LR    GPR01P,GPR13P                                    02S0447
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */
         L     GPR13P,PSALITA                                   02S0448
*       GEN(LM GPR11P,GPR13P,540(GPR13P)); /* LOAD LOCKWORD, CLHT AND E
*TRY ADRS. */                                                   02S0449
         LM GPR11P,GPR13P,540(GPR13P)
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0450
         BALR GPR14P,GPR13P
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0451
         LR    GPR11P,GPR15P                                    02S0451
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0452
         LR    GPR15P,GPR13P                                    02S0452
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0453
         LR    GPR12P,GPR00P                                    02S0453
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0454
         LR    GPR13P,GPR01P                                    02S0454
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0455
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0456
*     END; /* SETLOCK (OBTAIN) MODE(UNCOND) TYPE(CMS) REGS(USE) RELATED
*UCBS,IEFBB416(VOLCLNP)) */                                     02S0457
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UPDUCBS                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UPDATE UCBS                                   */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO CLEAR THE UCB               */
*/*   VOLSER FIELD FOR EACH UCB THAT HAD A NON-SPECIFIC UNOPENED     */
*/*   TAPE. UCBS WITH FF SERIALS ARE IN THE FF SER LIST.             */
*/*   THIS SEGMENT ALSO CLEARS THE PASS-DATA-SET-ON-VOLUME           */
*/*   INDICATOR FOR EACH VOLUME THAT WAS FOUND UP ON THE SYSTEM      */
*/*   BUT WAS NOT UNLOADABLE. THESE VOLUMES ARE IN THE VOLLIST       */
*/*   AND ARE MARKED AS BEING IGNORED OR REWOUND. VM&V WILL  @ZA02721*/
*/*   RESET THIS INDICATOR FOR EACH VOLUME THAT IT UNLOADS.  @ZA02721*/
*/*   NOTE:  FOR TAPE UNITS, THE ASID IN THE UCB MUST MATCH  @ZA02721*/
*/*          THE CURRENT ASID, INDICATING THAT THE CURRENT   @ZA02721*/
*/*          JOB WAS THE PASSING JOB.                        @ZA02721*/
*/*   NOTE:  IN ORDER TO UPDATE THESE UCB'S, THEIR GROUPS    @Z40LPPK*/
*/*          HAD TO BE LOCKED.  THE VOLLIST AND FF SER LIST  @Z40LPPK*/
*/*          WERE FILLED IN BEFORE THE GROUPS WERE LOCKED.   @Z40LPPK*/
*/*          IF THE GROUP WAS LOCKED, THE UCB POINTERS IN    @Z40LPPK*/
*/*          THE VOLLIST ENTRY AND CORRESPONDING UCB LIST    @Z40LPPK*/
*/*          ENTRY ARE EQUAL - A CHECK IS MADE FOR THIS.     @Z40LPPK*/
*/*          ALSO, THE FF SER UCB'S ARE CHECKED TO MAKE      @Z40LPPK*/
*/*          SURE THEY'RE STILL THERE.  SINCE VOLIGNOR AND   @Z40LPPK*/
*/*          VOLREWND ARE SET ON WHILE UNDER THE GROUP       @Z40LPPK*/
*/*          LOCKS, CHECKS OF THOSE INDICATORS INSURE THAT   @Z40LPPK*/
*/*          UPDATING OF THE UCB IS STILL VALID.             @Z40LPPK*/
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     FFSERBLK - FF SER LIST BLOCK                         @Z40LPPK*/
*/*       FFSERCTR - NUMBER OF ENTRIES IN THE BLOCK                  */
*/*       FFSERUCB - UCB ADDRESS (UP TO THIRTY)              @Z40LPPK*/
*/*                                                                  */
*/*     VOLLIST - VOLUME LIST                                        */
*/*       VLSTENT - VOLUME LIST ENTRY                                */
*/*         VOLUCBP - UCB ADDRESS                                    */
*/*         VOLIGNOR - IGNORE ENTRY INDICATOR                        */
*/*         VOLFNDSW - VOL FOUND MOUNTED                     @Z40LPPK*/
*/*                                                                  */
*/*     UCB - UNIT CONTROL BLOCK                                     */
*/*       UCBVOLI - VOLUME SERIAL                                    */
*/*       UCBMONT - PASS-DATA-SET-ON-VOLUME INDICATOR                */
*/*                                                          @Z40LPPK*/
*/*     LOCKLIST - ARRAY OF UCB'S/GROUPS LOCKED              @Z40LPPK*/
*/*                                                                  */
*/* EXIT -                                                           */
*/*   CONDITION - NORMAL                                             */
*/*     OUTPUT -                                                     */
*/*       UCB -                                                      */
*/*         UCBVOLI - VOLUME SERIAL                                  */
*/*     RETURN CODE - NONE                                           */
*/********************************************************************/
*DO VOLCTR = ONE TO TOTVOLS;           /* SCAN VLLST TO RESET UCBMONT*/
         LA    VOLCTR,1                                         03S0458
         B     @DE00458                                         03S0458
@DL00458 DS    0H                                               03S0459
*  IF VOLINDX(VOLCTR) ^= ZERO THEN     /* IF THERE IS A UCBLIST ENTRY
*                                         FOR THE VOLLIST ENTRY 03S0459
*                                                            @Z40LPPK*/
         L     @08,VOLCOREP                                     03S0459
         LR    @06,VOLCTR                                       03S0459
         SLA   @06,4                                            03S0459
         LA    @02,0(@06,@08)                                   03S0459
         AL    @02,@CF01961                                     03S0459
         L     @02,VOLINDX-8(,@02)                              03S0459
         LTR   @02,@02                                          03S0459
         BZ    @RF00459                                         03S0459
*    DO;                               /* PROCESS VLST ENTRY @Z40LPPK*/
*      LOKINDEX = VOLINDX(VOLCTR);     /* GET CORRECT INDEX  @Z40LPPK*/
         LR    LOKINDEX,@02                                     03S0461
*      IF LOCKLIST(LOKINDEX) =         /* CRNT UCB LIST ENTRY@Z40LPPK*/
*         VOLUCBP(VOLCTR) THEN         /* CRNT VOLLIST ENTRY @Z40LPPK*/
         LR    @05,LOKINDEX                                     03S0462
         SLA   @05,2                                            03S0462
         LA    @02,0(@06,@08)                                   03S0462
         AL    @02,@CF01946                                     03S0462
         L     @02,VOLUCBP-12(,@02)                             03S0462
         L     @01,LOKLISTP                                     03S0462
         C     @02,LOCKLIST-4(@05,@01)                          03S0462
         BNE   @RF00462                                         03S0462
*        DO;                           /* PROCESS VLST ENTRY @Z40LPPK*/
*          IF VOLIGNOR(VOLCTR) = ON ×  /* VOL NOT UNLOADED   @ZA02721*/
*             VOLREWND(VOLCTR) = ON THEN /* VOL REWOUND?     @ZA02721*/
         ALR   @08,@06                                          03S0464
         AL    @08,@CF01959                                     03S0464
         TM    VOLIGNOR(@08),B'10001000'                        03S0464
         BZ    @RF00464                                         03S0464
*            DO;                       /* CLEAR PASS INDIC.  @ZA02721*/
         ST    @02,@TF00001                                     03S0465
*              UCBPTR = VOLUCBP(VOLCTR); /* GET UCB PTR      @ZA02721*/
         L     UCBPTR,@TF00001                                  03S0466
*              IF UCB3DACC = ON THEN   /* DIRECT ACCESS      @ZA02721*/
         TM    UCB3DACC(UCBPTR),B'00100000'                     03S0467
         BNO   @RF00467                                         03S0467
*                 UCBMONT = OFF;       /* SET PASS INDIC OFF @ZA02721*/
         NI    UCBMONT(UCBPTR),B'11111110'                      03S0468
*              ELSE                    /* TAPE               @ZA02721*/
*                IF UCBASID = ASID  THEN/*CURRENT ASID IN UCB@ZA02721*/
         B     @RC00467                                         03S0469
@RF00467 L     @08,UCBEXTPT(,UCBPTR)                            03S0469
         SLR   @06,@06                                          03S0469
         ICM   @06,3,ASID                                       03S0469
         CH    @06,UCBASID(,@08)                                03S0469
         BNE   @RF00469                                         03S0469
*                  UCBMONT = OFF;      /* SET PASS INDIC OFF @ZA02721*/
         NI    UCBMONT(UCBPTR),B'11111110'                      03S0470
*                ELSE;                 /* NOT CURRENT ASID.  @ZA02721*/
@RF00469 DS    0H                                               03S0472
*            END;                      /* END PASS CLEARING. @ZA02721*/
*          ELSE;                       /* VOL WAS UNLOADED.  @ZA02721*/
@RF00464 DS    0H                                               03S0474
*        END;                          /* DONE VOLLIST ENTRY @Z40LPPK*/
*      ELSE;                           /* UCB NOT LOCKED     @Z40LPPK*/
@RF00462 DS    0H                                               03S0476
*    END;                              /* DONE VOLLIST ENTRY @Z40LPPK*/
*  ELSE;                               /* NON-CORRESPONDING VOL- UCB
*                                         LIST ENTRIES       @Z40LPPK*/
@RF00459 DS    0H                                               03S0478
*END;                                  /* END SCAN TO RESET UCBMONT  */
@RC00459 AL    VOLCTR,@CF00056                                  03S0478
@DE00458 CR    VOLCTR,TOTVOLS                                   03S0478
         BNH   @DL00458                                         03S0478
*LOKINDEX = LOKVOLS + ONE;             /* GET FIRST FFSER-CORRESPONDING
*                                         ENTRY IN LOCKLIST  @Z40LPPK*/
         LA    @08,1                                            03S0479
         LR    LOKINDEX,LOKVOLS                                 03S0479
         ALR   LOKINDEX,@08                                     03S0479
*DO SERCTR = ONE TO FFSERCTR;          /* PROCESS ALL ENTRIES IN BLK */
         LR    SERCTR,@08                                       03S0480
         B     @DE00480                                         03S0480
@DL00480 DS    0H                                               03S0481
*  IF FFSERUCB(SERCTR) =               /* CURRENT FFSER UCB  @Z40LPPK*/
*     LOCKLIST(LOKINDEX) THEN          /* CUR UCB LIST ENTRY @Z40LPPK*/
         LR    @08,SERCTR                                       03S0481
         SLA   @08,2                                            03S0481
         L     @08,FFSERUCB-4(@08)                              03S0481
         LR    @15,LOKINDEX                                     03S0481
         SLA   @15,2                                            03S0481
         L     @01,LOKLISTP                                     03S0481
         C     @08,LOCKLIST-4(@15,@01)                          03S0481
         BNE   @RF00481                                         03S0481
*    DO;                               /* PROCESS ENTRY      @Z40LPPK*/
*      UCBPTR = FFSERUCB(SERCTR);      /* GET UCB BASE       @Z40LPPK*/
         LR    UCBPTR,@08                                       03S0483
*      IF UCBVOLI(1) = NSTAPE &        /* NON-SPEC, UNOPENED TAPE
*                                                            @Z40LPPK*/
*         UCBVOLI(5:6) = ASID THEN     /* THIS MEMORY'S ASID @Z40LPPK*/
         CLI   UCBVOLI(UCBPTR),X'FF'                            03S0484
         BNE   @RF00484                                         03S0484
         CLC   UCBVOLI+4(2,UCBPTR),ASID                         03S0484
         BNE   @RF00484                                         03S0484
*        DO;                           /* PROCESS ENTRY      @Z40LPPK*/
*          UCBVOLI = UCBVOLI && UCBVOLI; /* ZERO OUT THE VOLSER      */
         XC    UCBVOLI(6,UCBPTR),UCBVOLI(UCBPTR)                03S0486
*          UCBBPUB = OFF;              /*RESET PUBLIC ATTRIBUTE      */
*          UCBBPRV = OFF;              /*RESET PRIVATE ATTRIBUTE     */
         NI    UCBBPUB(UCBPTR),B'11100111'                      03S0488
*          UCBMOUNT = OFF;             /*RESET MOUNT PENDING         */
         NI    UCBMOUNT(UCBPTR),B'01111111'                     03S0489
*          UCBMMSGP = OFF;         /* RESET MOUNT MESSAGE       03S0490
*                                     PENDING INDICATOR      @ZA18110*/
         NI    UCBMMSGP(UCBPTR),B'11111011'                     03S0490
*        END;                          /* DONE ENTRY         @Z40LPPK*/
*      ELSE;                           /* UCB VOLSER CHANGED @Z40LPPK*/
@RF00484 DS    0H                                               03S0493
*    END;                              /* DONE ENTRY         @Z40LPPK*/
*  ELSE;                               /* UCB/GRP NOT LOCKED @Z40LPPK*/
@RF00481 DS    0H                                               03S0495
*  LOKINDEX = LOKINDEX + ONE;          /* NXT UCB LIST ENTRY @Z40LPPK*/
         AL    LOKINDEX,@CF00056                                03S0495
*END;                                  /* END PROCESS ALL ENTRIES    */
         AL    SERCTR,@CF00056                                  03S0496
@DE00480 C     SERCTR,FFSERCTR                                  03S0496
         BNH   @DL00480                                         03S0496
*     DO; /* SETLOCK (RELEASE) TYPE(CMS) REGS(USE) RELATED(UCBS,IEFBB41
*(VOLCLNP)) */                                                  02S0497
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0498
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0499
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0500
         LR    GPR15P,GPR11P                                    02S0500
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0501
         LR    GPR00P,GPR12P                                    02S0501
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0502
         LR    GPR01P,GPR13P                                    02S0502
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */
         L     GPR13P,PSALITA                                   02S0503
*       GEN(LM GPR11P,GPR13P,552(GPR13P)); /* LOAD LOCKWORD, CLHT AND E
*TRY ADRS. */                                                   02S0504
         LM GPR11P,GPR13P,552(GPR13P)
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0505
         BALR GPR14P,GPR13P
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0506
         LR    GPR11P,GPR15P                                    02S0506
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0507
         LR    GPR15P,GPR13P                                    02S0507
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0508
         LR    GPR12P,GPR00P                                    02S0508
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0509
         LR    GPR13P,GPR01P                                    02S0509
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0510
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0511
*     END; /* SETLOCK (RELEASE) TYPE(CMS) REGS(USE) RELATED(UCBS,IEFBB4
*6(VOLCLNP)) */                                                 02S0512
*     DO; /* SETLOCK (RELEASE) TYPE(LOCAL) REGS(USE) RELATED(UCBS,IEFBB
*16(VOLCLNP)) */                                                02S0513
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) RSTD;                 02S0514
*       RFY (GPR15P,GPR00P,GPR01P) RSTD;                        02S0515
*       GPR15P = GPR11P; /* SAVE REG. 11 IN REG. 15. */         02S0516
         LR    GPR15P,GPR11P                                    02S0516
*       GPR00P = GPR12P; /* SAVE REG. 12 IN REG. 0. */          02S0517
         LR    GPR00P,GPR12P                                    02S0517
*       GPR01P = GPR13P; /* SAVE REG. 13 IN REG. 1. */          02S0518
         LR    GPR01P,GPR13P                                    02S0518
*       GPR13P = PSALITA; /* ADDRESS OF LOCK INTERFACE TABLE. */
         L     GPR13P,PSALITA                                   02S0519
*       GEN(LM GPR11P,GPR13P,588(GPR13P)); /* LOAD LOCKWORD, CLHT AND E
*TRY ADRS. */                                                   02S0520
         LM GPR11P,GPR13P,588(GPR13P)
*       GEN(BALR GPR14P,GPR13P); /* BALR TO SETLOCK RTN. */     02S0521
         BALR GPR14P,GPR13P
*       GPR11P = GPR15P; /* RESTORE REG. 11. */                 02S0522
         LR    GPR11P,GPR15P                                    02S0522
*       GPR15P = GPR13P; /* SAVE RETURN CODE. */                02S0523
         LR    GPR15P,GPR13P                                    02S0523
*       GPR12P = GPR00P; /* RESTORE REG. 12 */                  02S0524
         LR    GPR12P,GPR00P                                    02S0524
*       GPR13P = GPR01P; /* RESTORE REG. 13. */                 02S0525
         LR    GPR13P,GPR01P                                    02S0525
*       RFY(GPR15P,GPR00P,GPR01P) UNRSTD;                       02S0526
*       RFY (GPR11P,GPR12P,GPR13P,GPR14P) UNRSTD;               02S0527
*     END; /* SETLOCK (RELEASE) TYPE(LOCAL) REGS(USE) RELATED(UCBS,IEFB
*416(VOLCLNP)) */                                               02S0528
*     DO; /*MODESET  EXTKEY(SCHED)*/                            02S0529
*       SPKA (16); /*SET PSW KEY*/                              02S0530
         LA    @08,16                                           02S0530
         SPKA  0(@08)                                           02S0530
*     END; /*MODESET  EXTKEY(SCHED)*/           /* GET SCHEDULER KEY BA
*K     */                                                       02S0531
*    LOCKFMAP = LOCKFMAP && LOCKFMAP;  /* CLEAR FUNCTION MAP @Z40LPPK*/
         XC    LOCKFMAP(1),LOCKFMAP                             02S0532
*    LOCKFREE = ON;                    /* FREE LOCKED GROUPS @Z40LPPK*/
         OI    LOCKFREE,B'01000000'                             02S0533
*    CALL IEFAB4EC                     /* TERMINATE GROUP LOCKING
*                                         SERVICE ROUTINE    @Z40LPPK*/
*       (LOCKFMAP,LOKLISTP,GRPMASKP,JSCBPTR,LOKWORKP); /*    @Z40LPPK*/
         LA    @08,LOCKFMAP                                     02S0534
         ST    @08,@AL00001                                     02S0534
         LA    @08,LOKLISTP                                     02S0534
         ST    @08,@AL00001+4                                   02S0534
         LA    @08,GRPMASKP                                     02S0534
         ST    @08,@AL00001+8                                   02S0534
         L     @08,@PC00001+4                                   02S0534
         ST    @08,@AL00001+12                                  02S0534
         LA    @08,LOKWORKP                                     02S0534
         ST    @08,@AL00001+16                                  02S0534
         L     @15,@CV00189                                     02S0534
         LA    @01,@AL00001                                     02S0534
         BALR  @14,@15                                          02S0534
*  END;                                                         02S0535
*DO VOLCTR = ONE TO TOTVOLS;           /* SCAN VOL LIST FOR     02S0536
*                                         NON-SPECIFIC TAPE SERIALS OR
*                                        VIRTUAL VOLUMES     @Y30LPPG*/
@RF00377 LA    VOLCTR,1                                         02S0536
         B     @DE00536                                         02S0536
@DL00536 DS    0H                                               02S0537
*  IF VOLFNDSW(VOLCTR) = OFF THEN      /* VOL WAS NOT FOUND MOUNTED  */
         L     @08,VOLCOREP                                     02S0537
         LR    @02,VOLCTR                                       02S0537
         SLA   @02,4                                            02S0537
         ST    @02,@TF00001                                     02S0537
         ALR   @02,@08                                          02S0537
         AL    @02,@CF01959                                     02S0537
         TM    VOLFNDSW(@02),B'00100000'                        02S0537
         BNZ   @RF00537                                         02S0537
*    IF VOLTYPE(VOLCTR) = NSTAPE ×     /*NON-SPECIFIC TAPE   @Y30LPPG*/
*       VOLUNLD(VOLCTR) = ON ×         /*VOL UNLOADED WITH KEEP 02S0538
*                                        MSG                 @ZD03010*/
*       VOLVIRSW(VOLCTR) = ON THEN     /*OR VIRTUAL VOLUME   @Y30LPPG*/
         LR    @02,@08                                          02S0538
         AL    @02,@TF00001                                     02S0538
         AL    @02,@CF01958                                     02S0538
         CLI   VOLTYPE-2(@02),X'FF'                             02S0538
         BE    @RT00538                                         02S0538
         AL    @08,@TF00001                                     02S0538
         AL    @08,@CF01959                                     02S0538
         TM    VOLUNLD(@08),B'01010000'                         02S0538
         BZ    @RF00538                                         02S0538
@RT00538 DS    0H                                               02S0539
*      DO;                                                      02S0539
*        VOLIGNOR(VOLCTR) = ON;        /*DO NOT WRITE RELEASE MSG    */
         LR    @08,VOLCTR                                       02S0540
         SLA   @08,4                                            02S0540
         L     @02,VOLCOREP                                     02S0540
         ALR   @02,@08                                          02S0540
         AL    @02,@CF01959                                     02S0540
         OI    VOLIGNOR(@02),B'10000000'                        02S0540
*        RLSECTR = RLSECTR - ONE;      /*DECREMENT NO. MSGS NEEDED   */
         L     @08,RLSECTR                                      02S0541
         BCTR  @08,0                                            02S0541
         ST    @08,RLSECTR                                      02S0541
*      END;                                                     02S0542
*END;                                                           02S0543
@RF00538 DS    0H                                               02S0543
@RF00537 AL    VOLCTR,@CF00056                                  02S0543
@DE00536 CR    VOLCTR,TOTVOLS                                   02S0543
         BNH   @DL00536                                         02S0543
*IF RLSECTR ^= ZERO THEN               /* BUILD RELEASE VOLUMES MSG  */
         L     @15,RLSECTR                                      02S0544
         LTR   @15,@15                                          02S0544
         BZ    @RF00544                                         02S0544
*  DO;                                 /* BUILD THE MESSAGE          */
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - RLSEMSG                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME - BUILD AND ISSUE THE 'RELEASE' MESSAGE         */
*/*                                                                  */
*/* FUNCTION -                                                       */
*/*   THE FUNCTION OF THIS SEGMENT IS TO ISSUE THE 'FOLLOWING        */
*/*   VOLUMES NO LONGER NEEDED BY JJJJJJJJ' (RELEASE)                */
*/*   MESSAGE. EACH VOLUME SERIAL IN THE VOLUME LIST WHICH           */
*/*   DOES NOT HAVE THE UNLOADED OR IGNORE ENTRY INDICATORS          */
*/*   ON IS INCLUDED IN THIS MESSAGE. A MULTI-LINE WTO (MLWTO)       */
*/*   IS USED TO ISSUE THE MESSAGE.                                  */
*/*                                                                  */
*/*   OPERATION -                                                    */
*/*     THE TOTAL NUMBER OF LINES NEEDED FOR THIS MESSAGE            */
*/*     (NOT INCLUDING THE HEADER LINE) IS GIVEN BY:                 */
*/*        TOTLINES = (RLSECTR + VOLSPERL - ONE)/VOLSPERL            */
*/*        WHERE:                                                    */
*/*          RLSECTR IS THE TOTAL NUMBER OF VOLSERS TO APPEAR        */
*/*            IN THE MESSAGE                                        */
*/*          VOLSPERL IS THE NUMBER OF VOLSERS THAT WILL FIT         */
*/*            IN ONE LINE                                           */
*/*                                                                  */
*/*     CORE IS GOTTEN FOR THE BASIC SECTION OF THE WTO PARAMETER    */
*/*     LIST PLUS TOTLINE * LENGTH OF EACH LINE SECTION.             */
*/*     THE WTO PARAMETER LIST IS THEN CONSTRUCTED. MCSFLAGS         */
*/*     FOR ROUT/DESC CODES AND MLWTO ARE SET. ROUT CODES            */
*/*     FOR MASTER CONSOLE, TAPE POOL, AND DA POOL ARE SET.          */
*/*     DESC CODE FOR SYSTEM STATUS IS SET. THE HEADER LINE TYPE     */
*/*     IS SET TO LABEL LINE AND ALL OTHER LINE TYPES ARE SET TO     */
*/*     DATA LINES. THE LINE TYPE OF THE LAST LINE IS ALSO SET       */
*/*     TO END LINE.                                                 */
*/*                                                                  */
*/*     AFTER THE MESSAGE HAS BEEN CONSTRUCTED, THE WTO IS ISSUED    */
*/*     AND THE CORE USED TO BUILD THE MESSAGE IS FREED.             */
*/*                                                                  */
*/* ENTRY - IN-LINE SEGMENT                                          */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*   INPUT -                                                        */
*/*     VLISTENT - VOLUME LIST ENTRY                                 */
*/*       VOLIGNOR - IGNORE ENTRY INDICATOR                          */
*/*       VOLUNLD - VOLUME WAS UNLOADED                              */
*/*     JCT -                                                        */
*/*       JCTJNAME - JOB NAME                                        */
*/*                                                                  */
*/* EXIT -                                                           */
*/* 1 CONDITION - NORMAL COMPLETION                                  */
*/*     OUTPUT -                                                     */
*/*       MESSAGE ISSUED                                             */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 0                                                */
*/*                                                                  */
*/* 2 CONDITION - CORE NOT AVAILABLE FOR WTO PARM LIST               */
*/*     OUTPUT -                                                     */
*/*       REASON CODE -                                              */
*/*         RESNCODE = 1                                             */
*/*     RETURN CODE -                                                */
*/*       RETCODE = 4                                                */
*/*                                                                  */
*/********************************************************************/
*MSGGLNTH = LENGTH(WPL) + LENGTH(WPLFLGS) + LENGTH(WPLLS01) +   03S0546
*    ((RLSECTR + VOLSPERL - ONE)/VOLSPERL) * LENGTH(WPLML); /* CORE
*                                         FOR WTO PARM LIST          */
         L     @08,VOLSPERL                                     03S0546
         LR    @00,@15                                          03S0546
         ALR   @00,@08                                          03S0546
         BCTR  @00,0                                            03S0546
         SRDA  @00,32                                           03S0546
         DR    @00,@08                                          03S0546
         MH    @01,@CH01929                                     03S0546
         AH    @01,@CH01931                                     03S0546
         ST    @01,MSGGLNTH                                     03S0546
* /* ?GETSTORG (SPID,MSGGLNTH,WPLPTR);*/                        03S0547
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               03S0547
*   GTSTR0 = MSGGLNTH; /* SET AMOUNT*/                          03S0548
         L     @08,MSGGLNTH                                     03S0548
         LR    GTSTR0,@08                                       03S0548
*   GTSTR2 = SPID; /* SET SUBPOOL*/                             03S0549
         LA    GTSTR2,230                                       03S0549
*   GENERATE CODE;                                              03S0550
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               03S0551
         ST    GTSTR15,GTSTRTCD                                 03S0551
*   WPLPTR = GTSTR1; /* ADDR OF GOTN STORG*/                    03S0552
         LR    WPLPTR,GTSTR1                                    03S0552
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                03S0553
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               03S0554
         L     @08,GTSTRTCD                                     03S0554
         LTR   @08,@08                                          03S0554
         BNZ   @RF00554                                         03S0554
*     DO;               /* YES, CLEAR STORAGE.*/                03S0555
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0556
*                          GTSTR7,GTSTR8) RSTD;                 03S0556
*       GTSTR4 = WPLPTR; /*STORG PTR*/                          03S0557
         LR    GTSTR4,WPLPTR                                    03S0557
*       GTSTR5 = MSGGLNTH; /*STORG AMNT*/                       03S0558
         L     GTSTR5,MSGGLNTH                                  03S0558
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               03S0559
         SLR   GTSTR7,GTSTR7                                    03S0559
*       IF SPID = GTST253 THEN                                  03S0560
         B     @RF00560                                         03S0560
*      GEN                                                      03S0561
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           03S0561
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*       GEN REFS(GTSTR4,GTSTR6);                                03S0562
@RF00560 DS    0H                                               03S0562
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*       IF SPID = GTST253 THEN                                  03S0563
         B     @RF00563                                         03S0563
*         GEN (MODESET KEYADDR=(2));                            03S0564
         MODESET KEYADDR=(2)
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       03S0565
*                          GTSTR7,GTSTR8) UNRSTD;               03S0565
@RF00563 DS    0H                                               03S0566
*     END;       /* STORAGE CLEARING COMPLETED */               03S0566
*   ELSE                                                        03S0567
*   WPLPTR= 0;   /* CLEAR RETURN ADDR. */                       03S0567
         B     @RC00554                                         03S0567
@RF00554 SLR   WPLPTR,WPLPTR                                    03S0567
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               03S0568
@RC00554 L     GTSTR15,GTSTRTCD                                 03S0568
*                                      /* RESTORE LIST PRINT STATUS  */
*     /* GET CORE FOR WTO LIST      */                          03S0569
*IF REG15 = ZERO THEN                  /* CORE WAS GOTTEN            */
         LTR   REG15,REG15                                      03S0569
         BNZ   @RF00569                                         03S0569
*  DO;                                 /* BUILD THE MESSAGE          */
*    WPLMCSFA = ON;                    /* ROUT/DESC CODES PRESENT    */
         OI    WPLMCSFA(WPLPTR),B'10000000'                     03S0571
*    WPLMCSFJ = ON;                    /* MULTI-LINE WTO             */
         OI    WPLMCSFJ(WPLPTR),B'01000000'                     03S0572
*    WPLTXT(1:RLSEHDRL) = RLSEHDRM(1:RLSEHDRL); /* MOVE MSG HEADER IN*/
         L     @08,@CA00193                                     03S0573
         LH    @05,RLSEHDRL-RLSEHDR(,@08)                       03S0573
         LR    @15,@05                                          03S0573
         BCTR  @15,0                                            03S0573
         EX    @15,@SM01965                                     03S0573
*    MSGLNTH = RLSEHDRL;               /* MOVE LENGTH TO LOCAL AREA  */
         ST    @05,MSGLNTH                                      03S0574
*    RLSEJNAM = JCTJNAME;              /* PUT JOB NAME IN MSG        */
         LA    @05,WPLTXT(,WPLPTR)                              03S0575
         LH    @08,RLSEJBND-RLSEHDR(,@08)                       03S0575
         ALR   @08,@05                                          03S0575
         L     @15,@PC00001+8                                   03S0575
         L     @01,JCTPTR(,@15)                                 03S0575
         MVC   RLSEJNAM(8,@08),JCTJNAME(@01)                    03S0575
*    CALL IEFAB4F3(ADDR(WPLTXT),MSGLNTH,CMSGLNTH); /* COMPRESS BLANKS*/
         ST    @05,@TF00001                                     03S0576
         LA    @08,@TF00001                                     03S0576
         ST    @08,@AL00001                                     03S0576
         LA    @08,MSGLNTH                                      03S0576
         ST    @08,@AL00001+4                                   03S0576
         LA    @08,CMSGLNTH                                     03S0576
         ST    @08,@AL00001+8                                   03S0576
         L     @15,@CV00190                                     03S0576
         LA    @01,@AL00001                                     03S0576
         BALR  @14,@15                                          03S0576
*    WPLLGH = CMSGLNTH + LWTOBYTS;     /* SET WPL LENGTH (FIRST LINE)*/
         LA    @08,4                                            03S0577
         L     @05,CMSGLNTH                                     03S0577
         ALR   @05,@08                                          03S0577
         STH   @05,WPLLGH(,WPLPTR)                              03S0577
*    WPLFLGS = WPLFLGS && WPLFLGS;     /* CLEAR WPL FLAGS            */
         ALR   @05,WPLPTR                                       03S0578
         XC    WPLFLGS(8,@05),WPLFLGS(@05)                      03S0578
*    WPLDESCD = ON;                    /* DESC = SYSTEM STATUS       */
         OI    WPLDESCD(@05),B'00010000'                        03S0579
*    WPLROUTB = ON;                    /* ROUT = MSTR CONSL INFO     */
*    WPLROUTC = ON;                    /* ROUT = TAPE POOL           */
*    WPLROUTD = ON;                    /* ROUT = DA POOL             */
         OI    WPLROUTB(@05),B'01110000'                        03S0582
*    WPLLS01 = WPLLS01 && WPLLS01;     /* CLEAR MLWTO EXTENSION      */
         ALR   @08,@05                                          03S0583
         XC    WPLLS01(4,@08),WPLLS01(@08)                      03S0583
*    WPLLTFB = ON;                     /* LINE TYPE = LABEL          */
         OI    WPLLTFB(@08),B'01000000'                         03S0584
*    WPLLINES = (RLSECTR+VOLSPERL-ONE)/VOLSPERL + ONE; /* NUMBER
*                                         OF LINES                   */
         LA    @15,1                                            03S0585
         L     @14,VOLSPERL                                     03S0585
         L     @00,RLSECTR                                      03S0585
         ALR   @00,@14                                          03S0585
         BCTR  @00,0                                            03S0585
         SRDA  @00,32                                           03S0585
         DR    @00,@14                                          03S0585
         ALR   @01,@15                                          03S0585
         STC   @01,WPLLINES(,@08)                               03S0585
*    LINEPTR = ADDR(WPLLS01) + LENGTH(WPLLS01); /* ADDR OF FIRST LINE*/
         AH    @05,@CH00054                                     03S0586
         LR    LINEPTR,@05                                      03S0586
*    VOLCTR = ONE;                     /* VOLLIST INDEX INITIALIZED  */
         LR    VOLCTR,@15                                       03S0587
*    TOTSERCT = ZERO;                  /* TOTAL SERS IN MESSAGE      */
         SLR   TOTSERCT,TOTSERCT                                03S0588
*    DO WHILE (TOTSERCT < RLSECTR);    /* LOOP THRU VOLLIST          */
         B     @DE00589                                         03S0589
@DL00589 DS    0H                                               03S0590
*      SERCTR = ONE;                   /* INIT SERS IN LINE          */
         LA    SERCTR,1                                         03S0590
*      WPLML0 = WPLML0 && WPLML0;      /* ZERO OUT WPL INFO          */
         SLR   @08,@08                                          03S0591
         IC    @08,WPLML0(,LINEPTR)                             03S0591
         LR    @15,@08                                          03S0591
         XR    @15,@08                                          03S0591
         STC   @15,WPLML0(,LINEPTR)                             03S0591
*      WPLMLLTF = WPLMLLTF && WPLMLLTF; /* ZERO OUT WPL INFO         */
         XC    WPLMLLTF(2,LINEPTR),WPLMLLTF(LINEPTR)            03S0592
*      WPLMLLTC = ON;                  /* LINE TYPE = DATA LINE      */
         OI    WPLMLLTC(LINEPTR),B'00100000'                    03S0593
*      LINEHDR = BLANKS;               /* BLANK OUT BEGINNING OF LINE*/
         MVC   LINEHDR+4(8,LINEPTR),BLANKS                      03S0594
*      WPLMLLEN = LENGTH(LINEHDR) + LMLBYTS; /* INIT WPL ML LENGTH   */
         MVI   WPLMLLEN(LINEPTR),X'0C'                          03S0595
*      DO WHILE (SERCTR <= VOLSPERL &  /* DO UNTIL LINE IS FULL      */
*          TOTSERCT < RLSECTR);        /* STOP WHEN VOLLIST EMPTY    */
         B     @DE00596                                         03S0596
@DL00596 DS    0H                                               03S0597
*        IF VOLIGNOR(VOLCTR) = OFF &   /* VOL NOT MARKED IGNORE      */
*            VOLUNLD(VOLCTR) = OFF THEN/* VOL NOT UNLOADED           */
         L     @08,VOLCOREP                                     03S0597
         LR    @15,VOLCTR                                       03S0597
         SLA   @15,4                                            03S0597
         ST    @15,@TF00001                                     03S0597
         ALR   @15,@08                                          03S0597
         AL    @15,@CF01959                                     03S0597
         TM    VOLIGNOR(@15),B'11000000'                        03S0597
         BNZ   @RF00597                                         03S0597
*          DO;                         /* PUT VOLSER IN LINE         */
*            TOTSERCT = TOTSERCT + ONE;/* BUMP TOTAL SERS IN MSG     */
         AL    TOTSERCT,@CF00056                                03S0599
*            LINESER(SERCTR) = VOLSER(VOLCTR); /* MOVE VOLSER TO MSG */
         LR    @15,SERCTR                                       03S0600
         MH    @15,@CH00119                                     03S0600
         LA    @14,4                                            03S0600
         ALR   @14,LINEPTR                                      03S0600
         ST    @15,@TF00002                                     03S0600
         ALR   @15,@14                                          03S0600
         AL    @08,@TF00001                                     03S0600
         AL    @08,@CF01958                                     03S0600
         MVC   LINESER-7(6,@15),VOLSER-2(@08)                   03S0600
*            IF TOTSERCT = RLSECTR THEN/* LAST VOLSER IN MSG         */
         C     TOTSERCT,RLSECTR                                 03S0601
         BNE   @RF00601                                         03S0601
*              LINEDELM(SERCTR) = POINT; /* BLANK DELIMITER          */
         AL    @14,@TF00002                                     03S0602
         MVI   LINEDELM-7(@14),C'.'                             03S0602
*            ELSE                      /* NOT LAST VOLSER IN MSG     */
*              LINEDELM(SERCTR) = COMMA; /* COMMA DELIMITER          */
         B     @RC00601                                         03S0603
@RF00601 LR    @08,SERCTR                                       03S0603
         MH    @08,@CH00119                                     03S0603
         ALR   @08,LINEPTR                                      03S0603
         MVI   LINEDELM-3(@08),C','                             03S0603
*            WPLMLLEN = WPLMLLEN +     /* BUMP LENGTH OF LINE        */
*               LENGTH(LINESER) + LENGTH(LINEDELM);             03S0604
@RC00601 LA    @08,7                                            03S0604
         SLR   @15,@15                                          03S0604
         IC    @15,WPLMLLEN(,LINEPTR)                           03S0604
         ALR   @08,@15                                          03S0604
         STC   @08,WPLMLLEN(,LINEPTR)                           03S0604
*            SERCTR = SERCTR + ONE;    /* BUMP TO NEXT SER IN LINE   */
         AL    SERCTR,@CF00056                                  03S0605
*          END;                        /* END PUT VOLSERS IN LINE    */
*        VOLCTR = VOLCTR + ONE;        /* NEXT VOLSER IN VOLLIST     */
@RF00597 AL    VOLCTR,@CF00056                                  03S0607
*      END;                            /* END DO UNTIL LINE IS FULL  */
@DE00596 C     SERCTR,VOLSPERL                                  03S0608
         BH    @DC00596                                         03S0608
         C     TOTSERCT,RLSECTR                                 03S0608
         BL    @DL00596                                         03S0608
@DC00596 DS    0H                                               03S0609
*      IF TOTSERCT = RLSECTR THEN      /* LAST LINE IN MSG           */
         C     TOTSERCT,RLSECTR                                 03S0609
         BNE   @RF00609                                         03S0609
*        WPLMLLTD = ON;                /* LINE TYPE = END LINE       */
         OI    WPLMLLTD(LINEPTR),B'00010000'                    03S0610
*      ELSE                            /* NOT LAST LINE              */
*        LINEPTR = LINEPTR + WPLMLLEN; /* GET NEXT LINE              */
         B     @RC00609                                         03S0611
@RF00609 SLR   @08,@08                                          03S0611
         IC    @08,WPLMLLEN(,LINEPTR)                           03S0611
         ALR   LINEPTR,@08                                      03S0611
*    END;                              /* END LOOP THRU VOLLIST      */
@RC00609 DS    0H                                               03S0612
@DE00589 C     TOTSERCT,RLSECTR                                 03S0612
         BL    @DL00589                                         03S0612
*    RFY (REG0,REG1) RSTD;             /* RESERVE REGISTERS          */
*    REG0 = ZERO;                      /* INTERFACE TO WTO           */
         SLR   REG0,REG0                                        03S0614
*    REG1 = ADDR(WPL);                 /* INTERFACE TO WTO           */
         LR    REG1,WPLPTR                                      03S0615
*    GEN REFS(REG0,REG1)               /* ISSUE THE MESSAGE          */
*        (WTO MF=(E,(1)));                                      03S0616
         WTO MF=(E,(1))
*    REG0 = MSGGLNTH;                  /* LENGTH OF GOTTEN CORE      */
         L     REG0,MSGGLNTH                                    03S0617
*    REG0 = REG0 × SUBPL230;           /*SUBPOOL NO.                 */
         O     REG0,@CF00180                                    03S0618
*    REG1 = WPLPTR;                    /* ADDRESS OF GOTTEN CORE     */
         LR    REG1,WPLPTR                                      03S0619
*    GEN REFS(REG0,REG1)               /* FREE UP CORE USED FOR WPL  */
*       (FREEMAIN R,LV=(0),A=(1));                              03S0620
         FREEMAIN R,LV=(0),A=(1)
*    RFY (REG0,REG1) UNRSTD;           /* RELEASE REGISTERS          */
*  END;                                /* END BUILD MESSAGE          */
*ELSE                                  /* CORE NOT GOTTEN            */
*  DO;                                 /* SET RETURN AND REASON CODES*/
         B     @RC00569                                         03S0623
@RF00569 DS    0H                                               03S0624
*    RETCODE = ERROR;                  /* BAD RETURN CODE            */
         MVC   RETCODE(2),@CH00098                              03S0624
*    RESNCODE = GETERROR;              /* GETMAIN ERROR              */
         L     @15,@PC00001+20                                  03S0625
         MVC   RESNCODE(2,@15),@CH00056                         03S0625
*  END;                                /* END SET RETN & RESN CODES  */
*  END;                                /* END BUILD THE MESSAGE      */
@RC00569 DS    0H                                               02S0628
*RFY (REG0,REG1) RSTD;                 /* RESERVE REGISTERS          */
@RF00544 DS    0H                                               02S0629
*IF VOLCOREP ^= ZERO THEN              /* CORE WAS GOTTEN            */
         L     @15,VOLCOREP                                     02S0629
         LTR   @15,@15                                          02S0629
         BZ    @RF00629                                         02S0629
*  DO;                                 /* FREE THE GOTTEN CORE       */
*    REG0 = VOLCOREL;                  /* ELNGTH TO FREE             */
         L     REG0,VOLCOREL                                    02S0631
*    REG0 = REG0 × SUBPL230;           /*SUBPOOL NO.                 */
         O     REG0,@CF00180                                    02S0632
*    REG1 = VOLCOREP;                  /* ADDRESS TO FREE            */
         LR    REG1,@15                                         02S0633
*    GEN REFS(REG0,REG1)               /* FREE THE VOLUME LIST CORE  */
*       (FREEMAIN R,LV=(0),A=(1));                              02S0634
         FREEMAIN R,LV=(0),A=(1)
*  END;                                /* END FREE GOTTEN CORE       */
*RFY (REG0,REG1) UNRSTD;               /* RELEASE REGISTERS          */
@RF00629 DS    0H                                               02S0637
*IF FRBPTR ^= ZERO THEN                /* COMMON RBS EXIST           */
         L     @15,FRBPTR                                       01S0637
         LTR   @15,@15                                          01S0637
         BZ    @RF00637                                         01S0637
*  DO;                                 /* FREE CORE FOR RBS          */
*    RFY (REG0,REG1) RSTD;             /* RESERVE REGISTERS          */
*    REG0 = GETLENTH;                  /* LENGTH TO FREE             */
         L     REG0,GETLENTH                                    01S0640
*    REG0 = REG0 × SUBPL230;           /*SUBPOOL NO.                 */
         O     REG0,@CF00180                                    01S0641
*    REG1 = FRBPTR;                    /* ADDRESS OR RB CORE         */
         LR    REG1,@15                                         01S0642
*    GEN (FREEMAIN R,LV=(0),A=(1));    /* FREE THE RBS               */
         FREEMAIN R,LV=(0),A=(1)
*    RFY (REG0,REG1) UNRSTD;           /* RELEASE REGISTERS          */
*  END;                                                         01S0645
*RETURN CODE(RETCODE);                 /* RETURN TO CALLER           */
*                                                               01S0646
*                                                               01S0646
@RF00637 LH    @09,RETCODE                                      01S0646
         L     @13,4(,@13)                                      01S0646
         L     @00,@SIZDATD                                     01S0646
         LR    @01,@10                                          01S0646
         FSPACE   R,LV=(0),A=(1)
         LR    @15,@09                                          01S0646
         L     @14,12(,@13)                                     01S0646
         LM    @00,@12,20(@13)                                  01S0646
         BR    @14                                              01S0646
* DECLARE /*GENERAL PURPOSE REGISTERS */                        01S0647
*   GPR00P PTR(31) REG(0),                                      01S0647
*   GPR01P PTR(31) REG(1),                                      01S0647
*   GPR11P PTR(31) REG(11),                                     01S0647
*   GPR12P PTR(31) REG(12),                                     01S0647
*   GPR13P PTR(31) REG(13),                                     01S0647
*   GPR14P PTR(31) REG(14),                                     01S0647
*   GPR15P PTR(31) REG(15);                                     01S0647
*                                                               01S0647
* DECLARE /* COMMON VARIABLES */                                01S0648
*   I256C CHAR(256) BASED,                                      01S0648
*   I031F FIXED(31) BASED,                                      01S0648
*   I031P PTR(31)   BASED,                                      01S0648
*   I015F FIXED(15) BASED,                                      01S0648
*   I015P PTR(15)   BASED,                                      01S0648
*   I008P PTR(8)    BASED,                                      01S0648
*   I001C CHAR(1)   BASED;                                      01S0648
*END IEFBB416                                                   01S0649
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (B416SPEC)                                        *
*/*%INCLUDE SYSLIB  (B416DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFAJCTB)                                        *
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBX)                                        *
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        *
*/*%INCLUDE SYSLIB  (IEFZB431)                                        *
*/*%INCLUDE SYSLIB  (IEFZB435)                                        *
*/*%INCLUDE SYSLIB  (IEFZB436)                                        *
*/*%INCLUDE SYSLIB  (IEFZB438)                                        *
*/*%INCLUDE SYSLIB  (IEFZB439)                                        *
*/*%INCLUDE SYSLIB  (IEFZB440)                                        *
*/*%INCLUDE SYSLIB  (IEZWPL  )                                        *
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        *
*/*%INCLUDE SYSLIB  (IHAASCB )                                        *
*/*%INCLUDE SYSLIB  (READPDIS)                                        *
*/*%INCLUDE SYSLIB  (READSPEC)                                        *
*/*%INCLUDE SYSLIB  (BLDCOMRB)                                        *
*/*%INCLUDE SYSLIB  (BLDCSPEC)                                        *
*/*%INCLUDE SYSLIB  (VOLCLNP )                                        *
*/*%INCLUDE SYSLIB  (VOLCSPEC)                                        *
*/*%INCLUDE SYSLIB  (BVOLLIST)                                        *
*/*%INCLUDE SYSLIB  (BVOLSPEC)                                        *
*/*%INCLUDE SYSLIB  (SCANUCBS)                                        *
*/*%INCLUDE SYSLIB  (SCANSPEC)                                        *
*/*%INCLUDE SYSLIB  (LOCKUCBS)                                        *
*/*%INCLUDE SYSLIB  (LOCKSPEC)                                        *
*/*%INCLUDE SYSLIB  (BUILDRBS)                                        *
*/*%INCLUDE SYSLIB  (BILDSPEC)                                        *
*/*%INCLUDE SYSLIB  (UPDUCBS )                                        *
*/*%INCLUDE SYSLIB  (UPDUSPEC)                                        *
*/*%INCLUDE SYSLIB  (RLSEMSG )                                        *
*/*%INCLUDE SYSLIB  (RLSESPEC)                                        *
*;                                                              01S0649
@DATA    DS    0H
@CH00098 DC    H'4'
@CH00119 DC    H'7'
@CH00054 DC    H'8'
@CH00052 DC    H'16'
@CH01924 DC    H'52'
@CH01659 DC    H'56'
@CH01926 DC    H'72'
@CH00088 DC    H'100'
@CH01929 DC    H'130'
@CH01931 DC    H'142'
@CH01928 DC    H'404'
@CH00166 DC    XL2'FFFF'
@SM01965 MVC   WPLTXT(0,WPLPTR),RLSEHDRM-RLSEHDR(@08)
         DS    0F
@AL00221 DC    A(@CF00184)             LIST WITH   6 ARGUMENT(S)
         DC    A(@CF00184)
         DC    A(@CF00184)
@AL00422 DC    A(@CF00184)             LIST WITH   2 ARGUMENT(S)
         DC    A(@CF00184)
         DC    A(@CF00056)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    7F
@AL00001 DS    9A
@TF00001 DS    F
@TF00002 DS    F
IEFBB416 CSECT
         DS    0F
@CF00184 DC    F'0'
@CF00056 DC    F'1'
@CH00056 EQU   @CF00056+2
@CF01959 DC    F'-16'
@CF01958 DC    F'-14'
@CF01961 DC    F'-8'
@CF01946 DC    F'-4'
@CF00180 DC    XL4'E6000000'
@DATD    DSECT
         DS    0D
FRBPTR   DS    A
FPDIPTR  DS    A
FSIOTP   DS    A
FUNLDRBP DS    A
FVUTPTR  DS    A
GRPMASKP DS    A
JFCBXPTR DS    A
LOKLISTP DS    A
LOKWORKP DS    A
LPDIPTR  DS    A
SIOTPTR  DS    A
VOLCOREP DS    A
VUTPTR   DS    A
CMSGLNTH DS    F
GETLENTH DS    F
MSGLNTH  DS    F
RLSECTR  DS    F
SWBLKLN  DS    F
VOLCOREL DS    F
MSGGLNTH DS    F
CFMAPTR  DS    A
ASCBPTR  DS    A
GTSTRTCD DS    F
RETCODE  DS    H
SWACTLS  DS    FL2
         ORG   SWACTLS
SWASN    DS    BL1
SWDEL    EQU   SWACTLS+0
SWREAD   EQU   SWACTLS+0
SWWRT    EQU   SWACTLS+0
SWNEW    EQU   SWACTLS+0
SWFREE   EQU   SWACTLS+0
SWMOD    EQU   SWACTLS+0
SWOLD    EQU   SWACTLS+0
SWCHN    DS    BL1
@NM00056 EQU   SWACTLS+1
         ORG   SWACTLS+2
ASID     DS    CL2
         DS    CL2
FFSERBLK DS    CL404
         ORG   FFSERBLK
FFSERCTR DS    FL4
FFSERUCB DS    100F
         ORG   FFSERBLK+404
GROUPMSK DS    CL240
LOCKFMAP DS    BL1
         ORG   LOCKFMAP
LOCKGET  DS    BL1
LOCKFREE EQU   LOCKFMAP+0
DDRTPUR  EQU   LOCKFMAP+0
DDRDA    EQU   LOCKFMAP+0
@NM00001 EQU   LOCKFMAP+0
         ORG   LOCKFMAP+1
SWITCHES DS    BL1
         ORG   SWITCHES
DUPSW    DS    BL1
FIRSTSW  EQU   SWITCHES+0
FOUNDSW  EQU   SWITCHES+0
LOCKOKSW EQU   SWITCHES+0
NOCNDISP EQU   SWITCHES+0
DAUCB    EQU   SWITCHES+0
TPURUCB  EQU   SWITCHES+0
@NM00002 EQU   SWITCHES+0
         ORG   SWITCHES+1
VUTSVA   DS    CL3
CFMAPCOR DS    CL4
IEFBB416 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00187 DC    V(IEFAB4A0)
@CV00188 DC    V(IEFAB4EB)
@CV00189 DC    V(IEFAB4EC)
@CV00190 DC    V(IEFAB4F3)
@CV00191 DC    V(IEFAB4F7)
@CV00192 DC    V(IEFAB49C)
@CA00193 DC    A(RLSEHDR)
         DS    0D
VOLSPERL DC    AL4(8)
GTSTZERO DC    F'0'
BLANKS   DC    CL8' '
DEV3330  DC    X'2009'
IEFBB416 CSECT
         DS   0H
B416PTCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFBB416 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
VUTCTR   EQU   @02
VOLCTR   EQU   @03
TVOLCTR  EQU   @04
TOTVOLS  EQU   @09
TOTSERCT EQU   @04
SERCTR   EQU   @05
PDIECTR  EQU   @04
NUMREQS  EQU   @02
LUTCTR   EQU   @05
LOKINDEX EQU   @04
LOKVOLS  EQU   @07
LOCKRC   EQU   @02
WPLPTR   EQU   @09
VMVREQBP EQU   @06
UCBPTR   EQU   @02
PDIBLPTR EQU   @03
LVUTPTR  EQU   @02
LINEPTR  EQU   @02
JFCBPTR  EQU   @05
CMRBPTR  EQU   @02
REG0     EQU   @00
REG1     EQU   @01
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GPR11P   EQU   @11
GPR12P   EQU   @12
GPR13P   EQU   @13
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GTSTR3   EQU   @03
         EXTRN RLSEHDR
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
IOSLUT   EQU   0
LOCKUCBS EQU   0
LOCKNUM  EQU   LOCKUCBS
LOCKLIST EQU   LOCKUCBS+4
RLSEMSGL EQU   0
LINEHDR  EQU   RLSEMSGL
LINEENT  EQU   RLSEMSGL+8
LINESER  EQU   LINEENT
LINEDELM EQU   LINEENT+6
VOLLIST  EQU   0
VLISTENT EQU   VOLLIST
VLISTIND EQU   VLISTENT
VOLIGNOR EQU   VLISTIND
VOLUNLD  EQU   VLISTIND
VOLFNDSW EQU   VLISTIND
VOLVIRSW EQU   VLISTIND
VOLREWND EQU   VLISTIND
VOLSER   EQU   VLISTENT+2
VOLTYPE  EQU   VOLSER
VOLINDX  EQU   VLISTENT+8
VOLUCBP  EQU   VLISTENT+12
RLSEJNAM EQU   0
INJMJCT  EQU   0
JCTJSTAT EQU   INJMJCT+5
INDMCTLG EQU   JCTJSTAT
JCTJBYTE EQU   INJMJCT+7
JCTJMGLV EQU   JCTJBYTE
JCTJNAME EQU   INJMJCT+8
JCTPDIP  EQU   INJMJCT+24
JCTCCODE EQU   INJMJCT+54
JCTRSW1  EQU   INJMJCT+86
JCTRSW2  EQU   INJMJCT+87
JCTDETDA EQU   INJMJCT+88
JCTJSB   EQU   INJMJCT+111
JCTSTAT2 EQU   INJMJCT+116
JCTVULDP EQU   INJMJCT+172
IEFAACTB EQU   0
INDMSIOT EQU   0
SCTUSADD EQU   INDMSIOT+20
SCTPJFCB EQU   INDMSIOT+32
SIOTBYT1 EQU   INDMSIOT+43
SIOTBYT3 EQU   INDMSIOT+46
SIOTTSTC EQU   INDMSIOT+47
SIOTBYT0 EQU   INDMSIOT+52
SCTSDISP EQU   INDMSIOT+55
SCTSBYT1 EQU   INDMSIOT+56
SCTDUMMY EQU   SCTSBYT1
SCTSBYT2 EQU   INDMSIOT+57
SCTSBYT3 EQU   INDMSIOT+58
SCTSBYT4 EQU   INDMSIOT+59
SCTUTYPE EQU   INDMSIOT+60
SIOTDEVT EQU   SCTUTYPE
SIOUBYT3 EQU   SIOTDEVT+2
SIOTBYT4 EQU   INDMSIOT+81
SIOTALTD EQU   INDMSIOT+92
SIOTAKEP EQU   SIOTALTD
SIOTADEL EQU   SIOTALTD
SIOTACAT EQU   SIOTALTD
SIOTAUNC EQU   SIOTALTD
SIOTBYT2 EQU   INDMSIOT+103
SIOTDSPD EQU   SIOTBYT2
SJFCBPTR EQU   INDMSIOT+156
SIOTJFX  EQU   INDMSIOT+160
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
JFCBX    EQU   0
JFCBXTTR EQU   JFCBX
JFCBXNXT EQU   JFCBX+172
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBJES3  EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBMONT  EQU   UCBJBNR
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBRESV  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCBRVDEV EQU   UCBRWTAU
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3TAPE EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00044 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBASID  EQU   UCBCMEXT+14
UCBMIHTI EQU   UCBCMEXT+16
@NM00045 EQU   UCBMIHTI
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
VMVRQBLK EQU   0
VMVFNMAP EQU   VMVRQBLK
VMVOPTB1 EQU   VMVFNMAP
VMVUNLOD EQU   VMVOPTB1
VMVUCB   EQU   VMVOPTB1
VMVREWND EQU   VMVOPTB1
VMVOPTB2 EQU   VMVFNMAP+1
VMVOPTB3 EQU   VMVFNMAP+2
VMVNREQP EQU   VMVRQBLK+4
VMVUCBP  EQU   VMVRQBLK+9
VMVJBNMP EQU   VMVRQBLK+24
VMVMINFO EQU   VMVRQBLK+40
VMVACTON EQU   VMVMINFO
VMVKEEP  EQU   VMVACTON
VMVUSER  EQU   VMVRQBLK+48
PDIBLOCK EQU   0
PDICTR   EQU   PDIBLOCK+3
PDIBNXTP EQU   PDIBLOCK+4
PDIENTRY EQU   PDIBLOCK+8
PDIE     EQU   0
PDIUNWA  EQU   PDIE+44
PDIISTAT EQU   PDIUNWA
PDIPASIN EQU   PDIUNWA
PDISIOTA EQU   PDIE+48
PDISIOTP EQU   PDIE+52
VUNLDTAB EQU   0
VUTNSVA  EQU   VUNLDTAB
VUTENTNO EQU   VUNLDTAB+3
VUTNPTR  EQU   VUNLDTAB+4
VUTENTRY EQU   VUNLDTAB+8
VUTENFLG EQU   VUTENTRY
VUTENVIR EQU   VUTENFLG
VUTUNLOD EQU   VUTENFLG
VUTENVOL EQU   VUTENTRY+1
CMUNFMAP EQU   0
CMFMBYT1 EQU   CMUNFMAP
CMDMSGS  EQU   CMFMBYT1
CMMNSTAT EQU   CMFMBYT1
CMDISPRC EQU   CMFMBYT1
CMFMBYT2 EQU   CMUNFMAP+1
CMNOPOST EQU   CMFMBYT2
CMNOVUT  EQU   CMFMBYT2
CMFMBYT3 EQU   CMUNFMAP+2
CMSPSCR  EQU   CMFMBYT3
CMFMBYT4 EQU   CMUNFMAP+3
CMUNRB   EQU   0
CMNRBPTR EQU   CMUNRB
CMSIOPTR EQU   CMUNRB+4
CMINDIC  EQU   CMUNRB+8
CMRBBYT1 EQU   CMINDIC
CMORDISP EQU   CMRBBYT1
CMINVUCB EQU   CMRBBYT1
CMRBBYT2 EQU   CMINDIC+1
CMNODSR  EQU   CMRBBYT2
CMRBBYT3 EQU   CMINDIC+2
CMRBBYT4 EQU   CMINDIC+3
CMODISP  EQU   CMUNRB+12
CMOKEEP  EQU   CMODISP
CMODEL   EQU   CMODISP
CMOCATLG EQU   CMODISP
CMOUNCAT EQU   CMODISP
CMOPTFLD EQU   CMUNRB+16
ESTAPARM EQU   0
ESTUSERP EQU   ESTAPARM+248
ESTAFLGS EQU   ESTUSERP
ESTAJOBU EQU   ESTAFLGS
ESTAJOB  EQU   ESTAFLGS
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESCD EQU   WPLDESC1
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUTB EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUT2 EQU   WPLROUT+1
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLLTFB  EQU   WPLLTF1
WPLLINES EQU   WPLLS01+3
WPLML    EQU   0
WPLML0   EQU   WPLML
WPLMLLEN EQU   WPLML+1
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
WPLMLLTC EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLTXT EQU   WPLML+4
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSFA EQU   WPLMCSF1
WPLMCSF2 EQU   WPLMCSF+1
WPLMCSFJ EQU   WPLMCSF2
WPLTXT   EQU   WPL+4
ASCB     EQU   0
ASCBASID EQU   ASCB+36
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
UCBBGN   EQU   0
RLSEHDRL EQU   RLSEHDR
RLSEJBND EQU   RLSEHDR+2
RLSEHDRM EQU   RLSEHDR+4
JOBFNMAP EQU   0
JOBCNDSP EQU   JOBFNMAP
JOBMSGS  EQU   JOBFNMAP
JOBDSPRC EQU   JOBFNMAP
JOBMSTAT EQU   JOBFNMAP
JSCBPTR  EQU   0
JCTPTR   EQU   0
ESTAPTR  EQU   0
LEPAPTR  EQU   0
RESNCODE EQU   0
IOSLUTP  EQU   0
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBEXAD EQU   JFCBS001+31
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
JFCBSPNM EQU   JFCBS001+45
JFCBFLG3 EQU   JFCBSPNM
UCBOBS01 EQU   UCBDEV
UCBVOLI  EQU   UCBOBS01+4
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBMOUNT EQU   UCBDMCT
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00043 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
PSARSVTE EQU   PSARSVT
CMUIDPTR EQU   CMOPTFLD
FLC      EQU   PSA
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00043
UCBSKPFG EQU   @NM00043
UCBRIPND EQU   @NM00043
UCBRTIAC EQU   @NM00043
UCBRSV79 EQU   @NM00043
UCBRSV78 EQU   @NM00043
UCBRSV77 EQU   @NM00043
UCBOLTEP EQU   @NM00043
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBDQDSP EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00042 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBFL46  EQU   UCBFL4
UCBFL45  EQU   UCBFL4
UCBRV065 EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVTOC  EQU   UCBOBS01
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBRV08 EQU   JFCBSPNM+1
JFCBRV07 EQU   JFCBFLG3
JFCBRV06 EQU   JFCBFLG3
JFCBRV05 EQU   JFCBFLG3
JFCBRV04 EQU   JFCBFLG3
JFCBRV03 EQU   JFCBFLG3
JFCBRV02 EQU   JFCBFLG3
JFCBEXP  EQU   JFCBFLG3
JFCDQDSP EQU   JFCBFLG3
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00037 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00036 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00035 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
WPLTXTL  EQU   WPLTXT+125
@NM00075 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
WPLRLN   EQU   WPLRPTR
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLAREA  EQU   WPLLS01+2
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFC  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTK EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
ESTLEPAP EQU   ESTUSERP+20
ESTSIOTP EQU   ESTUSERP+16
ESTASCTP EQU   ESTUSERP+12
ESTAJCTP EQU   ESTUSERP+8
ESTALCTP EQU   ESTUSERP+4
@NM00074 EQU   ESTAFLGS
ESTRECRD EQU   ESTAFLGS
ESTRECUR EQU   ESTAFLGS
ESTASTEP EQU   ESTAFLGS
ESTAAUTO EQU   ESTAPARM
CMRETCDE EQU   CMUNRB+14
CMOSYOUT EQU   CMUNRB+13
@NM00073 EQU   CMODISP
@NM00072 EQU   CMRBBYT4
@NM00071 EQU   CMRBBYT4
CMNODEN  EQU   CMRBBYT4
CMSSERR  EQU   CMRBBYT4
CMINTERR EQU   CMRBBYT4
CMSSIERR EQU   CMRBBYT4
CMCATERR EQU   CMRBBYT4
CMSCRERR EQU   CMRBBYT4
@NM00070 EQU   CMRBBYT3
CMSSKEEP EQU   CMRBBYT3
CMNOHOLD EQU   CMRBBYT3
CMOVSYOT EQU   CMRBBYT3
CMWAIT   EQU   CMRBBYT3
CMDYNUNA EQU   CMRBBYT3
CMHOLD   EQU   CMRBBYT3
CMDEL    EQU   CMRBBYT3
@NM00069 EQU   CMRBBYT2
@NM00068 EQU   CMRBBYT2
@NM00067 EQU   CMRBBYT2
CMSETPRV EQU   CMRBBYT2
CMCKDAVL EQU   CMRBBYT2
CMCKAVOL EQU   CMRBBYT2
CMCHKUN  EQU   CMRBBYT2
@NM00066 EQU   CMRBBYT1
CMOUSRID EQU   CMRBBYT1
CMCNDISP EQU   CMRBBYT1
CMNMDISP EQU   CMRBBYT1
CMNODISP EQU   CMRBBYT1
@NM00065 EQU   CMFMBYT4
@NM00064 EQU   CMFMBYT4
@NM00063 EQU   CMFMBYT4
@NM00062 EQU   CMFMBYT4
@NM00061 EQU   CMFMBYT4
@NM00060 EQU   CMFMBYT4
CMALSTCT EQU   CMFMBYT4
CMLSTCJS EQU   CMFMBYT4
CMJES3   EQU   CMFMBYT3
@NM00059 EQU   CMFMBYT3
@NM00058 EQU   CMFMBYT3
CMPUBPRV EQU   CMFMBYT3
CMSCRVL1 EQU   CMFMBYT3
CMNOSMF  EQU   CMFMBYT3
CMDSRALL EQU   CMFMBYT3
CMTIOTNQ EQU   CMFMBYT2
CMPURGE  EQU   CMFMBYT2
CMNERMSG EQU   CMFMBYT2
CMRDDENT EQU   CMFMBYT2
CMGENDEQ EQU   CMFMBYT2
CMCHATTR EQU   CMFMBYT2
CMFDSABS EQU   CMFMBYT1
CMVLRLSE EQU   CMFMBYT1
CMUNUNIT EQU   CMFMBYT1
CMDSRLSE EQU   CMFMBYT1
CMDPCATS EQU   CMFMBYT1
@NM00057 EQU   VUTENFLG
@NM00055 EQU   PDIE+51
PDISTPNO EQU   PDIE+46
@NM00054 EQU   PDIE+45
@NM00053 EQU   PDIUNWA
PDIJOBLB EQU   PDIUNWA
@NM00052 EQU   PDIUNWA
PDICSTAT EQU   PDIUNWA
PDIDSNAM EQU   PDIE
PDINPDIP EQU   PDIBLOCK
@NM00051 EQU   VMVUSER
VMVPROCD EQU   VMVUSER
VMVVUNTP EQU   VMVRQBLK+44
@NM00050 EQU   VMVMINFO+1
@NM00049 EQU   VMVACTON
VMVRTAIN EQU   VMVACTON
VMVDSMT  EQU   VMVACTON
VMVRETCD EQU   VMVRQBLK+36
VMVJSNMP EQU   VMVRQBLK+32
VMVDSNMP EQU   VMVRQBLK+28
VMVMVLSR EQU   VMVRQBLK+18
VMVUVLSR EQU   VMVRQBLK+12
@NM00048 EQU   VMVRQBLK+8
VMVOPTB4 EQU   VMVFNMAP+3
@NM00047 EQU   VMVOPTB3
VMVNUMSG EQU   VMVOPTB3
VMVCUVOL EQU   VMVOPTB3
VMVDUPVL EQU   VMVOPTB3
VMVNSPVT EQU   VMVOPTB2
VMVNSLTP EQU   VMVOPTB2
VMVSLTAP EQU   VMVOPTB2
VMVNLTAP EQU   VMVOPTB2
VMVALTAP EQU   VMVOPTB2
VMVSTRG  EQU   VMVOPTB2
VMVPUBLC EQU   VMVOPTB2
VMVPRIVT EQU   VMVOPTB2
VMVVDEND EQU   VMVOPTB1
VMVVRLBL EQU   VMVOPTB1
VMVDWTOR EQU   VMVOPTB1
VMVMTMSG EQU   VMVOPTB1
VMVMOUNT EQU   VMVOPTB1
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBFCBPE EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
@NM00046 EQU   @NM00045
UCBMIHSF EQU   @NM00045
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBMIHPB EQU   UCBFLP1
UCBMIHTB EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBSWAPF EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00044
UCBHALI  EQU   @NM00044
UCBRSV09 EQU   @NM00044
UCBRSV08 EQU   @NM00044
UCBRSV07 EQU   @NM00044
UCBRSV06 EQU   @NM00044
UCBRSV05 EQU   @NM00044
UCBRSV04 EQU   @NM00044
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3COMM EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBNAME  EQU   UCBOB+13
UCBRV029 EQU   UCBWGT
UCBVHRSN EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBONLI  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBRV011 EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00041 EQU   UCB
@NM00040 EQU   JFCBX+144
JFCBXDEV EQU   JFCBX+140
JFCBXNAM EQU   JFCBX+96
@NM00039 EQU   JFCBX+94
JFCBXVOL EQU   JFCBX+4
@NM00038 EQU   JFCBX+3
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCDISP  EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00034 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
SIODDSNL EQU   INDMSIOT+173
SIOVDSNL EQU   INDMSIOT+172
SIOVDSNT EQU   INDMSIOT+170
SVOLUNNO EQU   INDMSIOT+168
SIOTVMVP EQU   INDMSIOT+164
SIOTNPTR EQU   INDMSIOT+152
SIOTETIO EQU   INDMSIOT+148
SIOTATE  EQU   INDMSIOT+144
SVOLUNAD EQU   INDMSIOT+140
SIOTEDLP EQU   INDMSIOT+136
SIOTEDLS EQU   INDMSIOT+132
SIOTRSNC EQU   INDMSIOT+130
SCTANAME EQU   INDMSIOT+122
SIOTSSIC EQU   INDMSIOT+120
@NM00033 EQU   INDMSIOT+108
SIOTSSNM EQU   INDMSIOT+104
@NM00032 EQU   SIOTBYT2
SIOTCVOL EQU   SIOTBYT2
SIOTCNEW EQU   SIOTBYT2
SIOTCALC EQU   SIOTBYT2
SIOTGALL EQU   SIOTBYT2
SIOTDMND EQU   SIOTBYT2
SIOTOPUC EQU   INDMSIOT+99
SIOTOUTR EQU   INDMSIOT+97
SIOTOUTC EQU   INDMSIOT+96
SIOTSSWA EQU   INDMSIOT+93
SIOTNPRV EQU   SIOTALTD
SIOJCATS EQU   SIOTALTD
@NM00031 EQU   SIOTALTD
@NM00030 EQU   SIOTALTD
@NM00029 EQU   INDMSIOT+91
SIOTNDSB EQU   INDMSIOT+88
@NM00028 EQU   INDMSIOT+84
SIOTDPCD EQU   INDMSIOT+82
@NM00027 EQU   SIOTBYT4
SIOTRACT EQU   SIOTBYT4
SIOTRACD EQU   SIOTBYT4
SIOTPROT EQU   SIOTBYT4
SCTOUTPN EQU   INDMSIOT+80
SCTOUTNO EQU   INDMSIOT+76
SCTOUTNM EQU   INDMSIOT+68
SIOUCBAD EQU   SCTUTYPE+5
SIOUCNVT EQU   SCTUTYPE+4
SIOUBYT4 EQU   SIOTDEVT+3
@NM00026 EQU   SIOUBYT3
SIO3UREC EQU   SIOUBYT3
SIO3DISP EQU   SIOUBYT3
SIO3DACC EQU   SIOUBYT3
SIO3COMM EQU   SIOUBYT3
SIO3TAPE EQU   SIOUBYT3
SIOUBYT2 EQU   SIOTDEVT+1
SIOUBYT1 EQU   SIOTDEVT
SIOTOMN  EQU   SCTSBYT4
SIOTIPDI EQU   SCTSBYT4
SIOTVAFF EQU   SCTSBYT4
SIOTSTEP EQU   SCTSBYT4
SIOTASCI EQU   SCTSBYT4
@NM00025 EQU   SCTSBYT4
SIOTGDGA EQU   SCTSBYT4
SCTSGDGS EQU   SCTSBYT4
SCTSOLD  EQU   SCTSBYT3
SCTSMOD  EQU   SCTSBYT3
SCTSNEW  EQU   SCTSBYT3
SCTSYSOU EQU   SCTSBYT3
SCTVREF  EQU   SCTSBYT3
SCTALCHK EQU   SCTSBYT3
SCTSYSNE EQU   SCTSBYT3
SCTDSNRF EQU   SCTSBYT3
SCTRECVD EQU   SCTSBYT2
SCTDEFER EQU   SCTSBYT2
SCTLABEL EQU   SCTSBYT2
SCTUNLBD EQU   SCTSBYT2
SCTJOBLB EQU   SCTSBYT2
SCTVOLAF EQU   SCTSBYT2
SIOTCATL EQU   SCTSBYT2
SIOCLUNL EQU   SCTSBYT2
SIOTJSCT EQU   SCTSBYT1
SCTUNAFF EQU   SCTSBYT1
SCTPARLM EQU   SCTSBYT1
SIOTQDSN EQU   SCTSBYT1
SIOTGDSN EQU   SCTSBYT1
SIOTCCAT EQU   SCTSBYT1
SCTSYSIN EQU   SCTSBYT1
SIOTUNCT EQU   SCTSDISP
SIOTCTLG EQU   SCTSDISP
SIOTDLET EQU   SCTSDISP
SIOTKEEP EQU   SCTSDISP
SIOTPASS EQU   SCTSDISP
SIOTPRIV EQU   SCTSDISP
S3400DSP EQU   SCTSDISP
SIOTRETN EQU   SCTSDISP
SIOTVLCT EQU   INDMSIOT+54
SCTNMBUT EQU   INDMSIOT+53
SIOTRTRY EQU   SIOTBYT0
SIOTPUPV EQU   SIOTBYT0
SIOTNOPV EQU   SIOTBYT0
SIOTGIGN EQU   SIOTBYT0
SPVTAMSG EQU   SIOTBYT0
SIOTFUDA EQU   SIOTBYT0
SIOTDYAL EQU   SIOTBYT0
SIOTSSDS EQU   SIOTBYT0
SIOTGIID EQU   INDMSIOT+50
SCTVOLCT EQU   INDMSIOT+49
SCTSPOOL EQU   INDMSIOT+48
SIOTQNAM EQU   SIOTTSTC
SIOTDSNM EQU   SIOTTSTC
SIOTTRKM EQU   SIOTTSTC
SIOTSSMG EQU   SIOTTSTC
SIOTSSGP EQU   SIOTTSTC
@NM00024 EQU   SIOTTSTC
SIOTTERM EQU   SIOTTSTC
SIOTINFC EQU   SIOTTSTC
@NM00023 EQU   SIOTBYT3
SIOTDSID EQU   SIOTBYT3
S3400OFF EQU   SIOTBYT3
SIOTJES3 EQU   SIOTBYT3
SIOCDEVT EQU   SIOTBYT3
SIOALIAS EQU   SIOTBYT3
SCTDDINO EQU   INDMSIOT+44
SIOTDDNT EQU   SIOTBYT1
SIOTALCD EQU   SIOTBYT1
SIODADSM EQU   SIOTBYT1
SIOTDADR EQU   SIOTBYT1
SIODUNAL EQU   SIOTBYT1
SIOVAMDS EQU   SIOTBYT1
SIOTHOLD EQU   SIOTBYT1
SIOTOCKP EQU   SIOTBYT1
SIOPSCNT EQU   INDMSIOT+42
SIOTREFN EQU   INDMSIOT+40
SIOTOTUN EQU   INDMSIOT+39
SIOTVRSB EQU   INDMSIOT+36
@NM00022 EQU   INDMSIOT+35
@NM00021 EQU   INDMSIOT+31
SCTPSIOT EQU   INDMSIOT+28
SIOTAFID EQU   INDMSIOT+26
SIOTVLSP EQU   INDMSIOT+24
SIODSNTE EQU   INDMSIOT+22
SIOTUNAF EQU   SCTUSADD
SIOTDEST EQU   INDMSIOT+12
SCTDDNAM EQU   INDMSIOT+4
SIOTTYPE EQU   INDMSIOT+3
SIOTDSKA EQU   INDMSIOT
ACTACCNT EQU   IEFAACTB+32
ACTJNFLD EQU   IEFAACTB+31
ACTJTIME EQU   IEFAACTB+28
ACTPRGNM EQU   IEFAACTB+8
@NM00020 EQU   IEFAACTB+7
ACTNEXT  EQU   IEFAACTB+4
ACTIDENT EQU   IEFAACTB+3
ACTDSKAD EQU   IEFAACTB
@NM00019 EQU   INJMJCT+175
JCTACODE EQU   INJMJCT+168
JCTPRFMF EQU   INJMJCT+167
JCTUSER  EQU   INJMJCT+160
JCTSSD   EQU   INJMJCT+157
@NM00018 EQU   INJMJCT+156
JCTSRBT  EQU   INJMJCT+152
JCTJMRJD EQU   INJMJCT+149
JCTJMRJT EQU   INJMJCT+146
JCTJMRSS EQU   INJMJCT+143
JCTJMRTL EQU   INJMJCT+140
JCTJMRCL EQU   INJMJCT+139
JCTJMROP EQU   INJMJCT+138
JCTJMRD  EQU   INJMJCT+137
JCTJMR   EQU   INJMJCT+134
JCTCKIDT EQU   INJMJCT+118
JCTCKIDL EQU   INJMJCT+117
@NM00017 EQU   JCTSTAT2
JCTBLP   EQU   JCTSTAT2
JCTPERFM EQU   JCTSTAT2
JCTSWSM  EQU   JCTSTAT2
JCTENDIT EQU   JCTSTAT2
JCTADSPC EQU   JCTSTAT2
JCTSPSYS EQU   JCTSTAT2
@NM00016 EQU   INJMJCT+115
JCTSSTR  EQU   INJMJCT+112
JCTJSBTM EQU   JCTJSB
JCTJSBEX EQU   JCTJSB
JCTJSBAL EQU   JCTJSB
JCTJSBIN EQU   JCTJSB
@NM00015 EQU   JCTJSB
JCTVOLSQ EQU   INJMJCT+110
JCTNRCKP EQU   INJMJCT+108
JCTNTRK  EQU   INJMJCT+107
JCTCKTTR EQU   INJMJCT+104
JCTDEVT  EQU   INJMJCT+100
@NM00014 EQU   INJMJCT+99
JCTSTIOT EQU   INJMJCT+96
JCTSNUMB EQU   INJMJCT+95
JCTQIDNT EQU   INJMJCT+94
JCTEQREG EQU   INJMJCT+92
@NM00013 EQU   INJMJCT+91
JCTDSDRA EQU   JCTRSW2
JCTDSOJB EQU   JCTRSW2
JCTDSOCR EQU   JCTRSW2
JCTRESTT EQU   JCTRSW2
JCTNOCKP EQU   JCTRSW2
JCTNORST EQU   JCTRSW2
JCTNARST EQU   JCTRSW2
JCTSYSCK EQU   JCTRSW2
@NM00012 EQU   JCTRSW1
JCTSTEPR EQU   JCTRSW1
JCTCKPTR EQU   JCTRSW1
JCTCKFT  EQU   JCTRSW1
JCTCONTR EQU   JCTRSW1
JCTSTERM EQU   JCTRSW1
JCTWARMS EQU   JCTRSW1
@NM00011 EQU   JCTCCODE+3
JCTJDPOP EQU   JCTCCODE+2
JCTJDPCD EQU   JCTCCODE
@NM00010 EQU   INJMJCT+53
JCTSCT   EQU   INJMJCT+52
JCTSMRBA EQU   INJMJCT+44
@NM00009 EQU   INJMJCT+43
JCTACTAD EQU   INJMJCT+40
@NM00008 EQU   INJMJCT+39
JCTJCTX  EQU   INJMJCT+36
@NM00007 EQU   INJMJCT+35
JCTSDKAD EQU   INJMJCT+32
JCTJCSMF EQU   INJMJCT+31
JCTGDGNT EQU   INJMJCT+28
@NM00006 EQU   INJMJCT+27
JCTJTPTN EQU   INJMJCT+16
JCTJPRTY EQU   JCTJBYTE
INCMMGL1 EQU   JCTJMGLV
INCMMGL2 EQU   JCTJMGLV
@NM00005 EQU   JCTJMGLV
INCMALL  EQU   JCTJMGLV
JCTJMGPO EQU   INJMJCT+6
INCMNSET EQU   JCTJSTAT
INCMCAT  EQU   INDMCTLG
INCMSTS  EQU   JCTJSTAT
JCTABEND EQU   JCTJSTAT
@NM00004 EQU   JCTJSTAT
JCTJSTPC EQU   JCTJSTAT
@NM00003 EQU   JCTJSTAT
JCTJBLBS EQU   JCTJSTAT
JCTJSRNO EQU   INJMJCT+4
JCTIDENT EQU   INJMJCT+3
JCTDSKAD EQU   INJMJCT
@NM00099 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00098 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00097 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00096 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00095 EQU   FLCFSA
@NM00094 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00093 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00092 EQU   FLCIOA
@NM00091 EQU   FLCMCLA+15
@NM00090 EQU   FLCMCLA+14
@NM00089 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00088 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00087 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00086 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00085 EQU   FLCPER
@NM00084 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00083 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00082 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00081 EQU   FLCPIILC
@NM00080 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00079 EQU   FLCSVILC
@NM00078 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00077 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00076 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00269 EQU   @RC00266
@RF00323 EQU   @RC00312
@RF00412 EQU   @RC00381
@RC00385 EQU   @RC00381
@RC00462 EQU   @RC00459
@RF00389 EQU   @RC00385
@RC00464 EQU   @RC00462
@RC00467 EQU   @RC00464
@ENDDATA EQU   *
         END   IEFBB416,(C'PLS1206',0701,78124)

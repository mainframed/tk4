         TITLE 'IEFDB4F8 - ALLOCATE TCTIOT CONTROL                     *
                        '
IEFDB4F8 CSECT ,                                                01S0001
@MAINENT DS    0H                                               01S0001
         USING *,@15                                            01S0001
         B     @PROLOG                                          01S0001
         DC    AL1(16)                                          01S0001
         DC    C'IEFDB4F8  75.304'                              01S0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                  01S0001
         BALR  @10,0                                            01S0001
@PSTART  DS    0H                                               01S0001
         USING @PSTART,@10                                      01S0001
         L     @00,@SIZDATD                                     01S0001
         MODESET EXTKEY=SCHED,SAVEKEY=(2)
         GSPACE   R,LV=(0)
         LR    @09,@01                                          01S0001
         USING @DATD,@09                                        01S0001
         ST    @13,@SA00001+4                                   01S0001
         STC   @02,@OLDKEY                                      01S0001
         MODESET KEYADDR=(2)
         LM    @00,@02,20(@13)                                  01S0001
         ST    @09,8(,@13)                                      01S0001
         LR    @13,@09                                          01S0001
         MODESET EXTKEY=ZERO
         MVC   @PC00001(12),0(@01)                              01S0001
         MODESET EXTKEY=SCHED
*                                           STACK SAVED BY RESTART
*                                           FLIH               MDC078*/
*                                                               01S0041
*SWCHBYT1 = SWCHBYT1 && SWCHBYT1;      /*CLEAR INTERNAL SWITCHES     */
         XC    SWCHBYT1(1),SWCHBYT1                             01S0042
*RETCODE = RETCODE && RETCODE;         /*INIT INTERNAL RETURN CODE   */
         L     @12,RETCODE                                      01S0043
         LR    @11,@12                                          01S0043
         XR    @11,@12                                          01S0043
         ST    @11,RETCODE                                      01S0043
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CALCSIZE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CALCULATE ADDITIONAL TCTIOT SPACE             */
*/*                                                                  */
*/* FUNCTION - TO SCAN THE LIST OF DYNAMICALLY ALLOCATED             */
*/*            TIOT ENTRIES AND CALCULATE THE FOLLOWING:             */
*/*             1)THE AMOUNT OF ADDITIONAL TCTIOT SPACE NEEDED.      */
*/*             2)THE NUMBER OF ADDITIONAL TCTIOT DD ENTRIES.        */
*/*             3)THE NUMBER OF ADDITIONAL TCTIOT DEVICE ENTRIES.    */
*/*                                                                  */
*/*   OPERATION - EXAMINES EACH TIOT ENTRY POINTED TO FROM INPUT     */
*/*               LIST IN ORDER TO OBTAIN THE THREE VALUES DESCRIBED */
*/*               UNDER FUNCTION.                                    */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT      -                                                   */
*/*            - LIST OF TIOT ENTRY PTRS. -(TIOTENTP)                */
*/*            - LAST INPUT LIST ENTRY INDICATOR -(LASTINDC)         */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - ALL TIOT ENTRIES IN LIST PROCESSED                 */
*/*                                                                  */
*/*   OUTPUT      - ADDLSIZE - ADD'L TCTIOT SPACE NEEDED.            */
*/*                 ADDLDDNO - NO. ADD'L TCTIOT DD ENTRIES.          */
*/*                 ADDLDVEN - NO. ADD'L TCTIOT DEVICE ENTRIES.      */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*ADDLSIZE = ADDLSIZE && ADDLSIZE;      /*CLEAR NEEDED SIZE FIELD     */
         XR    ADDLSIZE,ADDLSIZE                                02S0044
*ADDLDVEN = ADDLDVEN && ADDLDVEN;      /*CLEAR TOTAL DEVICE ENTRY CNT*/
         L     @12,ADDLDVEN                                     02S0045
         LR    @11,@12                                          02S0045
         XR    @11,@12                                          02S0045
         ST    @11,ADDLDVEN                                     02S0045
*EXITSW = OFF;                         /*INITIALIZE LOOP CONTROL     */
         NI    EXITSW,B'01111111'                               02S0046
*DO I = ONE BY ONE                     /*PROCESS LIST OF TIOT ENTRIES*/
*  WHILE(EXITSW = OFF);                /*UNTIL LAST ENTRY            */
         LA    I,1                                              02S0047
         B     @DE00047                                         02S0047
@DL00047 DS    0H                                               02S0048
*  RFY TIOENTRY BASED(TIOTENTP(I));    /*ADDRESS TIOT ENTRY          */
*  NUMDVENT = TIOEWTCT;                /*NO.DEVICE ENTRIES IN   02S0049
*                                        TIOT DD ENTRY               */
         LR    @12,I                                            02S0049
         MH    @12,@CH00041                                     02S0049
         L     @11,@PC00001+4                                   02S0049
         LA    @08,0(@12,@11)                                   02S0049
         AL    @08,@CF01128                                     02S0049
         L     @08,TIOTENTP(,@08)                               02S0049
         SLR   @06,@06                                          02S0049
         IC    @06,TIOEWTCT(,@08)                               02S0049
         LR    NUMDVENT,@06                                     02S0049
*  ADDLSIZE = ADDLSIZE                 /*TCTIOT SPACE NEEDED         */
*         + LENGTH(TCTLUENT)           /*LEN.ONE L/U TABLE ENTRY     */
*         + LENGTH(TCTOUTLM)           /*LEN.OUTLIM SECTION          */
*         + (LENGTH(TCTDVENT) * TIOEWTCT); /*SIZE ALL DEVICE ENTRIES */
         LA    @08,12                                           02S0050
         ALR   @08,ADDLSIZE                                     02S0050
         LR    @03,@06                                          02S0050
         SLA   @03,3                                            02S0050
         ALR   @08,@03                                          02S0050
         LR    ADDLSIZE,@08                                     02S0050
*  ADDLDVEN = ADDLDVEN + TIOEWTCT;     /*TOTAL NO.OF DEVICE ENTRIES  */
         AL    @06,ADDLDVEN                                     02S0051
         ST    @06,ADDLDVEN                                     02S0051
*  IF LASTINDC(I) = ON THEN            /*IF LAST TIOT ENTRY THEN     */
         ALR   @11,@12                                          02S0052
         BCTR  @11,0                                            02S0052
         TM    LASTINDC-4(@11),B'10000000'                      02S0052
         BNO   @RF00052                                         02S0052
*    DO;                                                        02S0053
*      EXITSW = ON;                    /*EXIT LOOP                   */
         OI    EXITSW,B'10000000'                               02S0054
*      ADDLDDNO = I;                   /*NUMBER TIOT ENTRIES         */
         ST    I,ADDLDDNO                                       02S0055
*    END;                                                       02S0056
*END;                                                           02S0057
@RF00052 AH    I,@CH00044                                       02S0057
@DE00047 TM    EXITSW,B'10000000'                               02S0057
         BZ    @DL00047                                         02S0057
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - CHKSPACE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - CHECK AVAILABLE TCTIOT SPACE                  */
*/*                                                                  */
*/* FUNCTION - THIS SEGMENT CALCULATES THE AMOUNT OF UNUSED TCTIOT   */
*/*            SPACE AVAILABLE.IF CURRENT UNUSED SPACE IS            */
*/*            INSUFFICIENT TO ACCOMODATE DYNAMIC ALLOCATION ENTRIES */
*/*            THEN THE TOTAL DD ENTRY NUMBER AND DEVICE ENTRY       */
*/*            NUMBER FOR A NEW TCTIOT IS CALCULATED.                */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE.           */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT      -                                                   */
*/*       ADDLSIZE - AMT.SPACE NEEDED FOR DYNAMIC ENTRIES.           */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - AMOUNT OF UNUSED TCTIOT SPACE CALCULATED.          */
*/*                                                                  */
*/*   OUTPUT      - CURRSIZE - AMT.SPACE NEEDED CURRENT TCTIOT       */
*/*                 TOTDDENT - TOTAL NO.DD'S IN NEW TCTIOT           */
*/*                 TOTDVENT - TOTAL NO.DEVICE ENTRIES IN NEW TCTIOT */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*TCTLUPTR = TCTIOTBL + LENGTH(TCTTIOT);/*FIRST L/U TABLE ENTRY       */
         L     @12,@PC00001                                     02S0058
         L     @12,TCBPTR(,@12)                                 02S0058
         L     @12,TCBTCT(,@12)                                 02S0058
         LA    TCTLUPTR,8                                       02S0058
         AL    TCTLUPTR,TCTIOTBL(,@12)                          02S0058
*EXITSW = OFF;                         /*INITIALIZE SWITCH           */
         NI    EXITSW,B'01111111'                               02S0059
*DO COUNT = ZERO BY ONE                /*SCAN L/U SECTION            */
*  WHILE(EXITSW = OFF);                                         02S0060
         SLR   COUNT,COUNT                                      02S0060
         B     @DE00060                                         02S0060
@DL00060 DS    0H                                               02S0061
*  IF TCTDCBTD = ZEROHALF THEN         /*IS THIS LAST ENTRY          */
         ICM   @12,3,TCTDCBTD(TCTLUPTR)                         02S0061
         BNZ   @RF00061                                         02S0061
*    DO;                                                        02S0062
*      CURRDDNO = COUNT;               /*COUNT OF TCTIOT L/U TAB ENT.*/
         ST    COUNT,CURRDDNO                                   02S0063
*      EXITSW = ON;                    /*EXIT LOOP                   */
         OI    EXITSW,B'10000000'                               02S0064
*    END;                                                       02S0065
*  ELSE                                /*NOT LAST ENTRY              */
*    DO;                                                        02S0066
         B     @RC00061                                         02S0066
@RF00061 DS    0H                                               02S0067
*      TCTLUPTR = TCTLUPTR +           /*PTR TO NEXT L/U ENTRY       */
*       LENGTH(TCTLUENT);              /*LEN ONE L/U ENTRY           */
         AH    TCTLUPTR,@CH00121                                02S0067
*    END;                                                       02S0068
*END;                                                           02S0069
@RC00061 AH    COUNT,@CH00044                                   02S0069
@DE00060 TM    EXITSW,B'10000000'                               02S0069
         BZ    @DL00060                                         02S0069
*EXTRSIZE =                            /*AMOUNT EXTRA TCTIOT SIZE    */
*           TCTSZEXT - (               /*LEN TCTIOT MINUS            */
*            LENGTH(TCTTIOT)           /*LEN.TCTIOT HEADER           */
*         + (LENGTH(TCTLUENT)          /*LEN.OF L/U TABLE ENTRY      */
*            * CURRDDNO)               /*TIMES NO.L/U ENTRIES        */
*         + LENGTH(TCTDCBLE)           /*PLUS END OF L/U TABLE FIELD */
*         + TCTSZLKP                   /*PLUS LEN DEV. ENTRIES       */
*         + (CURRDDNO * LENGTH(TCTOUTLM))); /*PLUS LEN OUTLIM ENTRIES*/
         L     @12,@PC00001                                     02S0070
         L     @12,TCBPTR(,@12)                                 02S0070
         L     @12,TCBTCT(,@12)                                 02S0070
         L     @12,TCTIOTBL(,@12)                               02S0070
         L     @11,CURRDDNO                                     02S0070
         LR    @08,@11                                          02S0070
         SLA   @08,2                                            02S0070
         LA    @06,12                                           02S0070
         ALR   @06,@08                                          02S0070
         LH    @15,TCTSZLKP(,@12)                               02S0070
         ALR   @06,@15                                          02S0070
         SLA   @11,3                                            02S0070
         ALR   @06,@11                                          02S0070
         LCR   @06,@06                                          02S0070
         AH    @06,TCTSZEXT(,@12)                               02S0070
         ST    @06,EXTRSIZE                                     02S0070
*IF EXTRSIZE >= ADDLSIZE THEN          /*IF TCTIOT HAS SPACE         */
         CR    @06,ADDLSIZE                                     02S0071
         BL    @RF00071                                         02S0071
*  DO;                                                          02S0072
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - EXPANDTB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - EXPAND TCTIOT                                 */
*/*                                                                  */
*/* FUNCTION - EXPAND THE CURRENT TCTIOT BY MOVING THE COUNTER TABLE */
*/*            SECTION TO MAKE ROOM FOR NEW LOOKUP TABLE EXTRIES     */
*/*            RELATING TO THE DYNAMIC ALLOCATION REQUEST(S).        */
*/*                                                                  */
*/*                                                                  */
*/*   OPERATION - THE OPERATION IS DOCUMENTED BY THE CODE.           */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT      - CURRDDNO - CURRENT NO.DD'S IN TCTIOT              */
*/*              ADDLDDNO - ADDITIONAL NO.DD SLOTS NEEDED            */
*/*              EXTRSIZE - AMOUNT UNUSED SPACE IN CURRENT TCTIOT    */
*/*              ADDLDVEN - ADDITIONAL NO. DEVICE ENTRIES            */
*/*                                                                  */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - TCTIOT EXPANDED TO MAKE ROOM FOR DYN.ALLOC. ENTRIES*/
*/*                                                                  */
*/*   OUTPUT      - EXPANDED TCTIOT                                  */
*/*                 NEXTLUEP - NEXT AVAILABLE L/U ENTRY PTR          */
*/*                 NXTCNTEP - NEXT AVAILABLE CNTR TABLE SLOT PTR    */
*/*                                                                  */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*SIZEMOVE =                            /*SIZE OF TCTIOT COUNTER TABLE*/
*          LENGTH(TCTDCBLE) +          /*LEN. END L/U TAB FIELD      */
*          (CURRDDNO * LENGTH(TCTOUTLM))/*EQUALS LEN OUTLIM ENTRIES +*/
*           + TCTSZLKP;                /*LENGTH DEVICE ENTRIES       */
         AH    @11,@CH00121                                     03S0073
         ALR   @11,@15                                          03S0073
         ST    @11,SIZEMOVE                                     03S0073
*MOVEDIST = ADDLDDNO                   /*DISTANCE COUNTER TABLE TO   */
*           * LENGTH(TCTLUENT);        /*BE MOVED TO MAKE ROOM FOR
*                                        NEW L/U TABLE ENTRIES       */
         L     @06,ADDLDDNO                                     03S0074
         SLA   @06,2                                            03S0074
         STH   @06,MOVEDIST                                     03S0074
*NEXTLUEP = TCTIOTBL + LENGTH(TCTTIOT)  /*PTR TO NEXT AVAIL. L/U ENTRY
*                                        SLOT                        */
*  + (CURRDDNO * LENGTH(TCTLUENT));                             03S0075
         AH    @12,@CH00105                                     03S0075
         ALR   @12,@08                                          03S0075
         ST    @12,NEXTLUEP                                     03S0075
*NEWENDP = NEXTLUEP + MOVEDIST;        /*END OF L/U TAB ENTRIES 03S0076
*                                        AFTER MOVE                  */
         ALR   @12,@06                                          03S0076
         LR    NEWENDP,@12                                      03S0076
*NXTCNTEP = NEWENDP + SIZEMOVE;        /*PTR NEXT AVAIL CNTR TAB SLOT*/
         ALR   @11,NEWENDP                                      03S0077
         ST    @11,NXTCNTEP                                     03S0077
*FRRZERO = ON;                         /*CLEAR TCTIOT PTR IF ABEND   */
         L     @12,@PC00001+8                                   03S0078
         L     @12,FRRPARMP(,@12)                               03S0078
         OI    FRRZERO(@12),B'10000000'                         03S0078
* DO; /*MODESET  KEYADDR(ZERO)*/                                03S0079
*   SPKA (ZERO); /*SET PSW KEY*/                                03S0080
         SLR   @12,@12                                          03S0080
         SPKA  0(@12)                                           03S0080
* END; /*MODESET  KEYADDR(ZERO)*/               /*GET KEY ZERO  03S0081
*      */                                                       03S0081
* RFY (R11,R12,R13,R14) RSTD;SV13=R13;GEN REFS(PSALITA);        03S0082
         LR    SV13,R13                                         03S0083
  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                              XX
               REGS=USE,RELATED=(TCTIOT,IEFDB4F8(UPTCTIOT))
  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                                XX
               REGS=USE,RELATED=(TCTIOT,IEFDB4F8(UPTCTIOT))
* R13=SV13;RFY (R11,R12,R13,R14) UNRSTD;              /*GET LOCAL AND C
*S LOCKS     */                                                 03S0085
         LR    R13,SV13                                         03S0085
*RFY (REG2,REG3,REG4) RSTD;                                     03S0087
*REG2 = ADDR(IEFDB403);                /*ADDR OF FRR EXIT RTN        */
         L     REG2,@CV00075                                    03S0088
*GEN;                                                           03S0089
  SETFRR A,FRRAD=(2),PARMAD=(3),WRKREGS=(3,4)
*PARMFRRP = REG3;                      /*PTR TO FRR SUPPLIED PARMS   */
         LR    PARMFRRP,REG3                                    03S0090
*RFY (REG2,REG3,REG4) UNRSTD;                                   03S0091
*FRRP = FRRPARMP;                      /*PTR TO USER FRR PARMS       */
         L     @12,@PC00001+8                                   03S0092
         MVC   FRRP(4,PARMFRRP),FRRPARMP(@12)                   03S0092
*TCTLUENP = TCTIOTBL + LENGTH(TCTTIOT); /*START L/U TABLE            */
         L     @12,@PC00001                                     03S0093
         L     @12,TCBPTR(,@12)                                 03S0093
         L     @12,TCBTCT(,@12)                                 03S0093
         LA    TCTLUENP,8                                       03S0093
         AL    TCTLUENP,TCTIOTBL(,@12)                          03S0093
*DO COUNTLUT = ONE TO CURRDDNO BY ONE; /*SCAN CURRENT L/U TABLE ENT. */
         LA    COUNTLUT,1                                       03S0094
         B     @DE00094                                         03S0094
@DL00094 DS    0H                                               03S0095
*  TCTCNTEO(COUNTLUT) = TCTCNTEO(COUNTLUT) + MOVEDIST; /*UP DD OFFSET*/
         LR    @12,COUNTLUT                                     03S0095
         SLA   @12,2                                            03S0095
         ST    @12,@TF00001                                     03S0095
         ALR   @12,TCTLUENP                                     03S0095
         BCTR  @12,0                                            03S0095
         BCTR  @12,0                                            03S0095
         SLR   @11,@11                                          03S0095
         ICM   @11,3,TCTCNTEO-2(@12)                            03S0095
         AH    @11,MOVEDIST                                     03S0095
         L     @12,@TF00001                                     03S0095
         BCTR  @12,0                                            03S0095
         BCTR  @12,0                                            03S0095
         STH   @11,TCTCNTEO-2(@12,TCTLUENP)                     03S0095
*END;                                                           03S0096
         AH    COUNTLUT,@CH00044                                03S0096
@DE00094 C     COUNTLUT,CURRDDNO                                03S0096
         BNH   @DL00094                                         03S0096
*DO I = SIZEMOVE TO 1 BY -1;           /*MOVE CNTR TABLE AND END OF  */
         L     I,SIZEMOVE                                       03S0097
         B     @DE00097                                         03S0097
@DL00097 DS    0H                                               03S0098
*  NEWEND(I) = OLDEND(I);              /*L/U TABLE INDIC. FIELD      */
         LR    @12,NEWENDP                                      03S0098
         ALR   @12,I                                            03S0098
         BCTR  @12,0                                            03S0098
         L     @11,NEXTLUEP                                     03S0098
         ALR   @11,I                                            03S0098
         BCTR  @11,0                                            03S0098
         MVC   NEWEND(1,@12),OLDEND(@11)                        03S0098
*END;                                                           03S0099
         BCTR  I,0                                              03S0099
@DE00097 LTR   I,I                                              03S0099
         BP    @DL00097                                         03S0099
*TCTSZLKP = TCTSZLKP + (ADDLDVEN * LENGTH(TCTDVENT));/*UPDATE LEN DEV
*                                        ENTRIES                     */
         L     @12,@PC00001                                     03S0100
         L     @12,TCBPTR(,@12)                                 03S0100
         L     @12,TCBTCT(,@12)                                 03S0100
         L     @12,TCTIOTBL(,@12)                               03S0100
         L     @11,ADDLDVEN                                     03S0100
         SLA   @11,3                                            03S0100
         AH    @11,TCTSZLKP(,@12)                               03S0100
         STH   @11,TCTSZLKP(,@12)                               03S0100
*RFY (REG2,REG3,REG4,REG5) RSTD;                                03S0101
*REG2 = NXTCNTEP;                      /* START OF UNUSED TCTIOT
*                                                            @ZA06969*/
         L     REG2,NXTCNTEP                                    03S0102
*REG3 = EXTRSIZE-MOVEDIST;             /* UNUSED TCTIOT LENGTH MINUS
*                                        LENGTH OF NEW L/U ENTRIES
*                                                            @ZA06969*/
         L     REG3,EXTRSIZE                                    03S0103
         SH    REG3,MOVEDIST                                    03S0103
*REG4 = ZERO;                          /* CLEAR REGISTER     @ZA06969*/
         SLR   REG4,REG4                                        03S0104
*REG5 = ZERO;                          /* SET PADDING CHAR.  @ZA06969*/
         SLR   REG5,REG5                                        03S0105
*GEN( MVCL 2,4);                       /* CLEAR STORAGE      @ZA06969*/
          MVCL 2,4
*RFY (REG2,REG3,REG4,REG5) UNRSTD;                              03S0107
*  END;                                                         02S0108
*ELSE                                  /*BIGGER TCTIOT NEEDED        */
*  DO;                                                          02S0109
         B     @RC00071                                         02S0109
@RF00071 DS    0H                                               02S0110
*    SPACESW = ON;                     /*GET ADDITIONAL SPACE INDIC. */
         OI    SPACESW,B'01000000'                              02S0110
*    CURRSIZE =                        /*CUR.TCTIOT SPACE NEEDED     */
*               TCTSZEXT -             /*GOTTEN SIZE                 */
*               (EXTRSIZE + LENGTH(TCTTIOT)); /*EXTRA SIZE+FIXED SIZE*/
         L     @12,@PC00001                                     02S0111
         L     @12,TCBPTR(,@12)                                 02S0111
         L     @12,TCBTCT(,@12)                                 02S0111
         L     @12,TCTIOTBL(,@12)                               02S0111
         LA    @11,8                                            02S0111
         L     @08,EXTRSIZE                                     02S0111
         ALR   @08,@11                                          02S0111
         LCR   @08,@08                                          02S0111
         AH    @08,TCTSZEXT(,@12)                               02S0111
         ST    @08,CURRSIZE                                     02S0111
*    TOTDDENT = CURRDDNO + ADDLDDNO;   /*TOTAL NO.DD'S IN NEW TCTIOT */
         L     @08,CURRDDNO                                     02S0112
         AL    @08,ADDLDDNO                                     02S0112
         ST    @08,TOTDDENT                                     02S0112
*    TOTDVENT = ADDLDVEN               /*TOTAL NO.DEVICE ENTRIES     */
*               + (TCTSZLKP / LENGTH(TCTDVENT)); /*NO DEV.ENT.CURRENT
*                                                  TCTIOT            */
         LH    @00,TCTSZLKP(,@12)                               02S0113
         SRDA  @00,32                                           02S0113
         DR    @00,@11                                          02S0113
         AL    @01,ADDLDVEN                                     02S0113
         ST    @01,TOTDVENT                                     02S0113
*  END;                                                         02S0114
*IF SPACESW = ON THEN                  /*IF LARGER TCTIOT NEEDED     */
@RC00071 TM    SPACESW,B'01000000'                              01S0115
         BNO   @RF00115                                         01S0115
*  DO;                                                          01S0116
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - OBTCTIOT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - OBTAIN NEW TCTIOT                             */
*/*                                                                  */
*/* FUNCTION - OBTAIN A NEW TCTIOT LARGE ENOUGH TO ACCOMODATE ALL    */
*/*            THE CURRENT TCTIOT ENTRIES(IF ANY) PLUS THE AMOUNT    */
*/*            OF SPACE NEEDED FOR THE NEW DYNAMIC ENTRIES OR PLUS   */
*/*            THE DEFAULT VALUE WHICHEVER IS LARGER.                */
*/*                                                                  */
*/*                                                                  */
*/*   OPERATION - OPERATION IS DOCUMENTED BY THE CODE.               */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*                                                                  */
*/*   INPUT    - ADDLSIZE - AMT.SPACE NEEDED FOR NEW DYNAMIC ENTRIES */
*/*              CURRSIZE - LEN.CURRENT TCTIOT VARIABLE FIELDS       */
*/*              TOTDDENT - TOTAL NO. DEVICE ENTRIES                 */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - NEW TCTIOT OBTAINED                                */
*/*                                                                  */
*/*   OUTPUT                                                         */
*/*     TCTSPOOL - TCTIOT SUB POOL                                   */
*/*     TCTSZEXT - TCTIOT LENGTH                                     */
*/*     TCTSZLKP - TCTIOT NO.DD'S TIMES EIGHT                        */
*/*     NEXTLUEP - NEXT AVAILABLE L/U ENTRY PTR                      */
*/*     NXTCNTEP - NEXT AVAILABLE CNTR TABLE SLOT PTR                */
*/*     SPACEPTR - PTR TO NEW TCTIOT                                 */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/* EXIT - ERROR - (INLINE SUBROUTINE - EXITS AT BOTTOM)             */
*/*                                                                  */
*/*   CONDITION - GETMAIN FOR NEW TCTIOT FAILS                       */
*/*                                                                  */
*/*   OUTPUT - NO ENTRIES FOR NEW DYNAMIC ALLOCATION REQUESTS        */
*/*            TCTIEX BIT IN TCT SET TO ONE                          */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*IF ADDLSIZE < DFLTSIZE THEN           /*IF NEEDED SIZE LESS THAN
*                                        DEFAULT SIZE                */
         LA    @12,200                                          02S0117
         CR    ADDLSIZE,@12                                     02S0117
         BNL   @RF00117                                         02S0117
*  ADDLSIZE = DFLTSIZE;                /*USE DEFAULT SIZE            */
         LR    ADDLSIZE,@12                                     02S0118
*ELSE;                                 /*USE NEEDED SIZE             */
@RF00117 DS    0H                                               02S0120
*GETSIZE =                             /*SIZE OF NEW TCTIOT          */
*          LENGTH(TCTTIOT) + LENGTH(TCTDCBLE) /*LEN.FIXED TCTIOT     */
*        + CURRSIZE                    /*PLUS CURRENT VARIABLE FIELDS*/
*        + ADDLSIZE;                   /*PLUS ADDL VARIABLE FIELDS   */
         LA    GETSIZE,12                                       02S0120
         AL    GETSIZE,CURRSIZE                                 02S0120
         ALR   GETSIZE,ADDLSIZE                                 02S0120
* DO; /*MODESET  KEYADDR(ZERO)*/                                02S0121
*   SPKA (ZERO); /*SET PSW KEY*/                                02S0122
         SLR   @08,@08                                          02S0122
         SPKA  0(@08)                                           02S0122
* END; /*MODESET  KEYADDR(ZERO)*/               /*NEED KEY ZERO WHEN UP
*ATING                                            TCTIOT AREA   02S0123
*      */                                                       02S0123
* /* ?GETSTORG (SPTCTIOT,GETSIZE,SPACEPTR);*/                   02S0124
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0124
*   DCL                                                         02S0124
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0124
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0124
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0124
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0124
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0124
*   DCL                                                         02S0125
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               02S0125
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               02S0125
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               02S0125
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               02S0125
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               02S0125
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               02S0125
*     GTSTZERO FIXED(31) INIT(0),                               02S0125
*     GTST253  FIXED(31) CONSTANT(253);                         02S0125
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0126
*   GTSTR0 = GETSIZE; /* SET AMOUNT*/                           02S0127
         LR    GTSTR0,GETSIZE                                   02S0127
*   GTSTR2 = SPTCTIOT; /* SET SUBPOOL*/                         02S0128
         LA    GTSTR2,255                                       02S0128
*   GENERATE CODE;                                              02S0129
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0130
         LR    GTSTRTCD,GTSTR15                                 02S0130
*   SPACEPTR = GTSTR1; /* ADDR OF GOTN STORG*/                  02S0131
         ST    GTSTR1,SPACEPTR                                  02S0131
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0132
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               02S0133
         LTR   GTSTRTCD,GTSTRTCD                                02S0133
         BNZ   @RF00133                                         02S0133
*     DO;               /* YES, CLEAR STORAGE.*/                02S0134
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0135
*                          GTSTR7,GTSTR8) RSTD;                 02S0135
*       GTSTR4 = SPACEPTR; /*STORG PTR*/                        02S0136
         L     @03,SPACEPTR                                     02S0136
         LR    GTSTR4,@03                                       02S0136
*       GTSTR5 = GETSIZE; /*STORG AMNT*/                        02S0137
         LR    GTSTR5,GETSIZE                                   02S0137
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               02S0138
         SLR   GTSTR7,GTSTR7                                    02S0138
*       IF SPTCTIOT = GTST253 THEN                              02S0139
         B     @RF00139                                         02S0139
*      GEN                                                      02S0140
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           02S0140
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8
*       GEN REFS(GTSTR4,GTSTR6);                                02S0141
@RF00139 DS    0H                                               02S0141
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG
*       IF SPTCTIOT = GTST253 THEN                              02S0142
         B     @RF00142                                         02S0142
*         GEN (MODESET KEYADDR=(2));                            02S0143
         MODESET KEYADDR=(2)
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0144
*                          GTSTR7,GTSTR8) UNRSTD;               02S0144
@RF00142 DS    0H                                               02S0145
*     END;       /* STORAGE CLEARING COMPLETED */               02S0145
*   ELSE                                                        02S0146
*   SPACEPTR= 0;   /* CLEAR RETURN ADDR. */                     02S0146
         B     @RC00133                                         02S0146
@RF00133 SLR   @08,@08                                          02S0146
         ST    @08,SPACEPTR                                     02S0146
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0147
@RC00133 LR    GTSTR15,GTSTRTCD                                 02S0147
*                                      /* RESTORE LIST PRINT STATUS  */
*/*GET NEW TCTIOT              */                               02S0148
*RETCODE = REG15;                      /*PICK UP RETURN CODE         */
         ST    REG15,RETCODE                                    02S0148
*IF RETCODE = SUCCESS THEN             /*IF GETMAIN SUCCESSFUL       */
         L     @11,RETCODE                                      02S0149
         LTR   @11,@11                                          02S0149
         BNZ   @RF00149                                         02S0149
*  DO;                                                          02S0150
*    TCTIOP = SPACEPTR;                /*NEW TCTIOT PTR TO FRR PARMS */
         L     @11,SPACEPTR                                     02S0151
         L     @15,@PC00001+8                                   02S0151
         L     @15,FRRPARMP(,@15)                               02S0151
         ST    @11,TCTIOP(,@15)                                 02S0151
*    TCTIOLN = GETSIZE;                /*LENGTH TO FRR PARMS         */
         ST    GETSIZE,TCTIOLN(,@15)                            02S0152
*    TCTIOLN = TCTIOLN × SUPLN;        /*SUBPOOL NUMBER TO FRR PARMS */
         L     @14,@PC00001+8                                   02S0153
         L     @01,FRRPARMP(,@14)                               02S0153
         L     @14,TCTIOLN(,@01)                                02S0153
         O     @14,@CF00151                                     02S0153
         ST    @14,TCTIOLN(,@15)                                02S0153
*    NEXTLUEP =                        /*NEXT AVAILABLE L/U ENTRY PTR*/
*               SPACEPTR               /*START GOTTEN SPACE          */
*             + LENGTH(TCTTIOT);       /*PLUS FIXED HEADER SPACE     */
         LA    @15,8                                            02S0154
         LR    @14,@11                                          02S0154
         ALR   @14,@15                                          02S0154
         ST    @14,NEXTLUEP                                     02S0154
*    NXTCNTEP =                        /*NEXT AVAILABLE CNTR TABLE
*                                        SLOT PTR                    */
*               NEXTLUEP               /*START L/U TABLE             */
*             + (LENGTH(TCTLUENT)      /*LEN OF A DEVICE ENTRY       */
*             * TOTDDENT)              /*NO.OF DEVICE ENTRIES        */
*             + LENGTH(TCTDCBLE);      /*PLUS END OF L/U TABLE FIELD */
         L     @05,TOTDDENT                                     02S0155
         SLA   @05,2                                            02S0155
         ALR   @05,@14                                          02S0155
         AH    @05,@CH00121                                     02S0155
         ST    @05,NXTCNTEP                                     02S0155
*    RFY TCTTIOT BASED(SPACEPTR);                               02S0156
*    TCTSZEXT = GETSIZE;               /*LENGTH TCTIOT GOTTEN        */
         STH   GETSIZE,TCTSZEXT(,@11)                           02S0157
*    TCTSPOOL = SUBPOOLN;              /*ASSIGN SUBPOOL NUMBER       */
         MVI   TCTSPOOL(@11),X'FF'                              02S0158
*    TCTSZLKP = TOTDVENT * LENGTH(TCTDVENT); /*LENGTH OF DEV ENTRIES */
         L     @12,TOTDVENT                                     02S0159
         SLA   @12,3                                            02S0159
         STH   @12,TCTSZLKP(,@11)                               02S0159
*    RFY TCTTIOT BASED(TCTIOTBL);                               02S0160
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - MVTCTIOT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - MOVE TCTIOT COUNTER TABLE SECTION             */
*/*                                                                  */
*/* FUNCTION - THIS SEGMENT MOVES THE L/U TABLE ENTRIES AND COUNTER  */
*/*            TABLE ENTRIES FROM THE OLD TCTIOT TO THE NEW TCTIOT.  */
*/*            COUNTER TABLE OFFSET IN THE L/U TABLE ARE THEN UPDATED*/
*/*            TO ACCOUNT FOR INCLUSION OF THE NEW L/U TABLE ENTRIES.*/
*/*                                                                  */
*/*   OPERATION - OPERATION IS DOCUMENTED BY THE CODE.               */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*  PURPOSE - SEE FUNCTION                                          */
*/*                                                                  */
*/*   INPUT  - CURRDDNO - NO.DD ENTRIES IN CURRENT TCTIOT            */
*/*              NEXTLUEP - PTR LOOK-UP TABLE AREA IN NEW TCTIOT     */
*/*              NXTCNTEP - PTR TO CNTR. TABLE AREA                  */
*/*              ADDLDDNO - NO. ADD'L TCTIOT DD ENTRIES              */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - TCTIOT COUNTER AND LOOK-UP SECTIONS MOVED          */
*/*                                                                  */
*/*   OUTPUT      - NEW TCTIOT UPDATED WITH L/U TABLE AND COUNTER    */
*/*                 TABLE ENTRIES FROM OLD TCTIOT.                   */
*/*               - NEXTLUEP - NEXT AVAILABLE L/U TABLE SLOT PTR.    */
*/*               - NXTCNTEP - NEXT AVAILABLE COUNTER TABLE SLOT PTR.*/
*/*               - TCTCNTEO - COUNTER TABLE OFFSETS IN TCTIOT       */
*/*                            UPDATED.                              */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*OLDLUTP = TCTIOTBL + LENGTH(TCTTIOT); /*PTR TO OLD L/U TABLE SECT   */
         L     @12,@PC00001                                     03S0161
         L     @12,TCBPTR(,@12)                                 03S0161
         L     @12,TCBTCT(,@12)                                 03S0161
         AL    @15,TCTIOTBL(,@12)                               03S0161
         LR    OLDLUTP,@15                                      03S0161
*MOVELEN = CURRDDNO * LENGTH(TCTLUENT);/*LEN OF OLD L/U TABLE ENTRIES*/
         L     MOVELEN,CURRDDNO                                 03S0162
         SLA   MOVELEN,2                                        03S0162
*RFY (REG2,REG3,REG4,REG5) RSTD;                                03S0163
*REG2 = NEXTLUEP;                      /*MOVE TO LOCATION            */
         LR    REG2,@14                                         03S0164
*REG3 = MOVELEN;                       /*LENGTH TO MOVE              */
         LR    REG3,MOVELEN                                     03S0165
*REG4 = OLDLUTP;                       /*MOVE FROM LOCATION          */
         LR    REG4,OLDLUTP                                     03S0166
*REG5 = MOVELEN;                       /*LENGTH TO MOVE              */
         LR    REG5,MOVELEN                                     03S0167
*GEN (MVCL 2,4);                                                03S0168
         MVCL 2,4
*RFY (REG2,REG3,REG4,REG5) UNRSTD;                              03S0169
*TCTLUENP = NEXTLUEP;                                           03S0170
         L     TCTLUENP,NEXTLUEP                                03S0170
*DO I = ONE TO CURRDDNO BY ONE;        /*SCAN MOVED L/U TAB ENTRIES  */
         LA    I,1                                              03S0171
         B     @DE00171                                         03S0171
@DL00171 DS    0H                                               03S0172
*  TCTCNTEO(I) = TCTCNTEO(I) +                                  03S0172
*  (ADDLDDNO * LENGTH(TCTLUENT));      /*UPDATE CNTR TBL OFFSET IN
*                                        LUT                         */
         LR    @12,I                                            03S0172
         SLA   @12,2                                            03S0172
         L     @11,ADDLDDNO                                     03S0172
         SLA   @11,2                                            03S0172
         ST    @12,@TF00001                                     03S0172
         ALR   @12,TCTLUENP                                     03S0172
         BCTR  @12,0                                            03S0172
         BCTR  @12,0                                            03S0172
         SLR   @03,@03                                          03S0172
         ICM   @03,3,TCTCNTEO-2(@12)                            03S0172
         ALR   @11,@03                                          03S0172
         L     @12,@TF00001                                     03S0172
         BCTR  @12,0                                            03S0172
         BCTR  @12,0                                            03S0172
         STH   @11,TCTCNTEO-2(@12,TCTLUENP)                     03S0172
*END;                                                           03S0173
         AH    I,@CH00044                                       03S0173
@DE00171 C     I,CURRDDNO                                       03S0173
         BNH   @DL00171                                         03S0173
*NEXTLUEP = NEXTLUEP +MOVELEN;         /*NEXT AVAILABLE L/U SLOT     */
         LR    @12,MOVELEN                                      03S0174
         AL    @12,NEXTLUEP                                     03S0174
         ST    @12,NEXTLUEP                                     03S0174
*OLDCNTP = OLDLUTP                     /*OLD CNTR SECT = OLD L/U TAB */
*        + MOVELEN                     /*PLUS LEN L/U TAB ENTRIES    */
*        + LENGTH(TCTDCBLE);           /*PLUS END L/U TAB FIELD      */
         LR    @12,OLDLUTP                                      03S0175
         ALR   @12,MOVELEN                                      03S0175
         AH    @12,@CH00121                                     03S0175
         ST    @12,OLDCNTP                                      03S0175
*MOVELEN =                             /*SIZE OLD CNTR TABLE         */
*         (CURRDDNO * LENGTH(TCTOUTLM))/*EQUALS LEN OUTLIM ENTRIES   */
*         + TCTSZLKP;                  /*PLUS LEN DEVICE ENTRIES     */
         L     MOVELEN,CURRDDNO                                 03S0176
         SLA   MOVELEN,3                                        03S0176
         L     @12,@PC00001                                     03S0176
         L     @12,TCBPTR(,@12)                                 03S0176
         L     @12,TCBTCT(,@12)                                 03S0176
         L     @12,TCTIOTBL(,@12)                               03S0176
         AH    MOVELEN,TCTSZLKP(,@12)                           03S0176
* RFY (R11,R12,R13,R14) RSTD;SV13=R13;GEN REFS(PSALITA);        03S0177
         LR    SV13,R13                                         03S0178
  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                              XX
               REGS=USE,RELATED=(TCTIOT,IEFDB4F8(UPTCTIOT))
  SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                                XX
               REGS=USE,RELATED=(TCTIOT,IEFDB4F8(UPTCTIOT))
* R13=SV13;RFY (R11,R12,R13,R14) UNRSTD;                        03S0180
         LR    R13,SV13                                         03S0180
*RFY (REG2,REG3,REG4,REG5) RSTD;                                03S0182
*REG2 = ADDR(IEFDB403);                /*ADDR OF FRR EXIT RTN        */
         L     REG2,@CV00075                                    03S0183
*GEN;                                                           03S0184
  SETFRR A,FRRAD=(2),PARMAD=(3),WRKREGS=(3,4)
*PARMFRRP = REG3;                      /*PTR TO FRR SUPPLIED PARMS   */
         LR    PARMFRRP,REG3                                    03S0185
*FRRP = FRRPARMP;                      /*PTR TO USER FRR PARMS       */
         L     @12,@PC00001+8                                   03S0186
         MVC   FRRP(4,PARMFRRP),FRRPARMP(@12)                   03S0186
*REG2 = NXTCNTEP;                      /*MOVE TO LOCATION            */
         L     REG2,NXTCNTEP                                    03S0187
*REG3 = MOVELEN;                       /*LENGTH TO MOVE              */
         LR    REG3,MOVELEN                                     03S0188
*REG4 = OLDCNTP;                       /*MOVE FROM LOCATION          */
         L     REG4,OLDCNTP                                     03S0189
*REG5 = MOVELEN;                       /*LENGTH TO MOVE              */
         LR    REG5,MOVELEN                                     03S0190
*GEN (MVCL 2,4);                                                03S0191
         MVCL 2,4
*RFY (REG2,REG3,REG4,REG5) UNRSTD;                              03S0192
*NXTCNTEP = NXTCNTEP + MOVELEN;        /*PTR TO NEXT AVAILABLE CNTR
*                                        TABLE SLOT                  */
         LR    @12,MOVELEN                                      03S0193
         AL    @12,NXTCNTEP                                     03S0193
         ST    @12,NXTCNTEP                                     03S0193
*  END;                                                         02S0194
*ELSE                                  /*RETURN INDICATES ERROR      */
*  TCTIEX = ON;                        /*INDICATE ERROR IN TCTIOT
*                                        I/O COUNT                   */
         B     @RC00149                                         02S0195
@RF00149 L     @12,@PC00001                                     02S0195
         L     @12,TCBPTR(,@12)                                 02S0195
         L     @12,TCBTCT(,@12)                                 02S0195
         OI    TCTIEX(@12),B'01000000'                          02S0195
*  END;                                                         01S0196
*ELSE                                  /*CURRENT TCTIOT HAS ENOUGH
*                                        SPACE                       */
*  SPACEPTR = TCTIOTBL;                /*PTR TO START TCTIOT         */
         B     @RC00115                                         01S0197
@RF00115 L     @12,@PC00001                                     01S0197
         L     @12,TCBPTR(,@12)                                 01S0197
         L     @12,TCBTCT(,@12)                                 01S0197
         MVC   SPACEPTR(4),TCTIOTBL(@12)                        01S0197
*IF RETCODE = SUCCESS THEN             /*IF NO ERROR                 */
@RC00115 ICM   @12,15,RETCODE                                   01S0198
         BNZ   @RF00198                                         01S0198
*  DO;                                                          01S0199
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME - UPTCTIOT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME - UPDATE TCTIOT                                 */
*/*                                                                  */
*/* FUNCTION - TO UPDATE THE TCTIOT WITH ENTRIES RELATING TO THE     */
*/*            DYNAMIC ALLOCATION REQUEST(S).IF A NEW TCTIOT HAS BEEN*/
*/*            CREATED AND AN OLD ONE EXISTED THE OLD ONE IS FREED.  */
*/*                                                                  */
*/*   OPERATION - OPERATION IS DOCUMENTED BY THE CODE                */
*/*                                                                  */
*/* ENTRY POINT -(INLINE SUBROUTINE - ENTERED AT THE TOP)            */
*/*                                                                  */
*/*   PURPOSE - SEE FUNCTION                                         */
*/*                                                                  */
*/*   INPUT  - NEXTLUEP - PTR TO FIRST AVAILABLE L/U TABLE SLOT      */
*/*              NXTCNTEP - PTR TO FIRST AVAILABLE CNTR TABLE SLOT   */
*/*              ADDLDDNO - NO. NEW DD'S                             */
*/*              LIST - LIST OF TIOT ENTRY PTRS AND SWITCHES         */
*/*              SPACEPTR - PTR TO TCTIOT SPACE                      */
*/*                                                                  */
*/* EXIT - NORMAL - (INLINE SUBROUTINE - EXITS AT BOTTOM)            */
*/*                                                                  */
*/*   CONDITION - TCTIOT UPDATED WITH NEW ENTRIES                    */
*/*                                                                  */
*/*   OUTPUT DATA - UPDATED TCTIOT                                   */
*/*                 IF A NEW TCTIOT HAS BEEN CREATED AND AN OLD ONE  */
*/*                 EXISTED IT IS FREED.                             */
*/*                                                                  */
*/*   RETURN CODE - NONE                                             */
*/*                                                                  */
*/********************************************************************/
*TCTLUENP = NEXTLUEP;                  /*PTR TO FIRST AVAILABLE L/U
*                                        TABLE ENTRY                 */
         L     TCTLUENP,NEXTLUEP                                02S0200
*DO I = ONE TO ADDLDDNO;               /*PROCESS EACH DD ENTRY       */
         LA    I,1                                              02S0201
         B     @DE00201                                         02S0201
@DL00201 DS    0H                                               02S0202
*  TIOTDDP = TIOTENTP(I);              /*PICK UP PTR TO TIOT ENTRY
*                                        FROM INPUT LIST             */
         LR    @12,I                                            02S0202
         MH    @12,@CH00041                                     02S0202
         L     @11,@PC00001+4                                   02S0202
         AL    @11,@CF01128                                     02S0202
         L     TIOTDDP,TIOTENTP(@12,@11)                        02S0202
*  TCTIOTO(I) = TIOTDDP - TCBTIO;      /*OFFSET FOR TIOT DD ENTRY    */
         LR    @12,I                                            02S0203
         SLA   @12,2                                            02S0203
         L     @11,@PC00001                                     02S0203
         L     @11,TCBPTR(,@11)                                 02S0203
         LR    @03,TIOTDDP                                      02S0203
         SL    @03,TCBTIO(,@11)                                 02S0203
         LR    @11,TCTLUENP                                     02S0203
         AL    @11,@CF01131                                     02S0203
         STH   @03,TCTIOTO(@12,@11)                             02S0203
*  TCTCNTEO(I) = NXTCNTEP - SPACEPTR;  /*OFFSET FOR TCTIOT CNTR ENTRY*/
         L     @11,NXTCNTEP                                     02S0204
         LR    @03,@11                                          02S0204
         SL    @03,SPACEPTR                                     02S0204
         BCTR  @12,0                                            02S0204
         BCTR  @12,0                                            02S0204
         STH   @03,TCTCNTEO-2(@12,TCTLUENP)                     02S0204
*  TCTDVENP = NXTCNTEP;                /*PTR TO 1ST DEV.ENT THIS DD  */
         LR    TCTDVENP,@11                                     02S0205
*  RFY TIOENTRY BASED(TIOTDDP);        /*ADDRESS TIOT ENTRY          */
*  TCTDSCTR(1) = TIOEWTCT;             /*NUMBER OF DEVICE ENTRIES    */
         MVC   TCTDSCTR(1,TCTDVENP),TIOEWTCT(TIOTDDP)           02S0207
*  DO K = ONE TO TIOEWTCT;             /*PROCESS ALL DEVICE ENTRIES
*                                        FOR THIS DD ENTRY           */
         LA    K,1                                              02S0208
         B     @DE00208                                         02S0208
@DL00208 DS    0H                                               02S0209
*    IF VAMINDC(I) = ON THEN           /*IF VAM DATA SET ENTRY       */
         LR    @12,I                                            02S0209
         MH    @12,@CH00041                                     02S0209
         L     @11,@PC00001+4                                   02S0209
         ALR   @11,@12                                          02S0209
         BCTR  @11,0                                            02S0209
         TM    VAMINDC-4(@11),B'01000000'                       02S0209
         BNO   @RF00209                                         02S0209
*      DO;                                                      02S0210
*        TCTDUCBP(K) = TCTDUCBP(K) && TCTDUCBP(K);  /*CLEAR UCB FIELD*/
         LR    @12,K                                            02S0211
         SLA   @12,3                                            02S0211
         ST    @12,@TF00001                                     02S0211
         ALR   @12,TCTDVENP                                     02S0211
         AL    @12,@CF01132                                     02S0211
         XC    TCTDUCBP(2,@12),TCTDUCBP(@12)                    02S0211
*        TCTFLAG3(K) = ON;             /*SET VAM FLAG                */
         LR    @12,TCTDVENP                                     02S0212
         AL    @12,@TF00001                                     02S0212
         AL    @12,@CF01128                                     02S0212
         OI    TCTFLAG3-3(@12),B'01000000'                      02S0212
*      END;                                                     02S0213
*    ELSE                              /*NOT VAM ENTRY               */
*      DO;                                                      02S0214
         B     @RC00209                                         02S0214
@RF00209 DS    0H                                               02S0215
*        TCTDUCBP(K) = TIOUCBP(K);     /*PTR UCB FOR THIS DEVICE     */
         LR    @12,K                                            02S0215
         SLA   @12,3                                            02S0215
         LR    @11,K                                            02S0215
         SLA   @11,2                                            02S0215
         L     @11,TIOUCBP-5(@11,TIOTDDP)                       02S0215
         LA    @11,0(,@11)                                      02S0215
         AL    @12,@CF01132                                     02S0215
         STH   @11,TCTDUCBP(@12,TCTDVENP)                       02S0215
*      END;                                                     02S0216
*  END;                                                         02S0217
@RC00209 AH    K,@CH00044                                       02S0217
@DE00208 SLR   @12,@12                                          02S0217
         IC    @12,TIOEWTCT(,TIOTDDP)                           02S0217
         CR    K,@12                                            02S0217
         BNH   @DL00208                                         02S0217
*  NXTCNTEP = NXTCNTEP                 /*UPDATE COUNTER TAB ENTRY PTR*/
*            + (TIOEWTCT * LENGTH(TCTDVENT)) /*LENGTH DEVICE ENTRIES */
*            + LENGTH(TCTOUTLM);       /*PLUS LEN OUTLIM ENTRY       */
         SLR   @12,@12                                          02S0218
         IC    @12,TIOEWTCT(,TIOTDDP)                           02S0218
         SLA   @12,3                                            02S0218
         AL    @12,NXTCNTEP                                     02S0218
         AH    @12,@CH00105                                     02S0218
         ST    @12,NXTCNTEP                                     02S0218
*END;                                                           02S0219
         AH    I,@CH00044                                       02S0219
@DE00201 C     I,ADDLDDNO                                       02S0219
         BNH   @DL00201                                         02S0219
*IF SPACESW = ON THEN                  /*IF OLD TCTIOT REPLACED      */
         TM    SPACESW,B'01000000'                              02S0220
         BNO   @RF00220                                         02S0220
*  DO;                                                          02S0221
*    TCTOLDP = TCTIOTBL;               /*PTR TO OLD TCTIOT           */
         L     @12,@PC00001                                     02S0222
         L     @12,TCBPTR(,@12)                                 02S0222
         L     @12,TCBTCT(,@12)                                 02S0222
         MVC   TCTOLDP(4),TCTIOTBL(@12)                         02S0222
*  END;                                                         02S0223
*IF SPACESW = ON THEN                  /*IF NEW TCTIOT OBTAINED      */
@RF00220 TM    SPACESW,B'01000000'                              02S0224
         BNO   @RF00224                                         02S0224
*  TCTIOTBL = SPACEPTR;                /*PTR TO NEW TCTIOT           */
         L     @12,@PC00001                                     02S0225
         L     @12,TCBPTR(,@12)                                 02S0225
         L     @12,TCBTCT(,@12)                                 02S0225
         MVC   TCTIOTBL(4,@12),SPACEPTR                         02S0225
*ELSE                                                           02S0226
*  TCTLUENT(ADDLDDNO + 1) =            /*CLEAR END-OF-L/U TABLE FIELD*/
*  TCTLUENT(ADDLDDNO + 1) && TCTLUENT(ADDLDDNO + 1);            02S0226
         B     @RC00224                                         02S0226
@RF00224 L     @12,ADDLDDNO                                     02S0226
         SLA   @12,2                                            02S0226
         ALR   @12,TCTLUENP                                     02S0226
         XC    TCTLUENT(4,@12),TCTLUENT(@12)                    02S0226
*FRRZERO = OFF;                        /*CLEAR FRR PARM SWITCH       */
@RC00224 L     @12,@PC00001+8                                   02S0227
         L     @12,FRRPARMP(,@12)                               02S0227
         NI    FRRZERO(@12),B'01111111'                         02S0227
*RFY (REG2,REG3) RSTD;                                          02S0228
*GEN( SETFRR D,WRKREGS=(2,3) );                                 02S0229
          SETFRR D,WRKREGS=(2,3)
*RFY (REG2,REG3) UNRSTD;                                        02S0230
* RFY (R11,R12,R13,R14) RSTD;SV13=R13;GEN;                      02S0231
         LR    SV13,R13                                         02S0232
  SETLOCK RELEASE,TYPE=CMS,REGS=USE,                                  XX
               RELATED=(TCTIOT,IEFDB4F8(EXPANDTB,MVTCTIOT,OBTCTIOT))
  SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                                XX
               RELATED=(TCTIOT,IEFDB4F8(EXPANDTB,MVTCTIOT,OBTCTIOT))
* R13=SV13;RFY (R11,R12,R13,R14) UNRSTD;                        02S0234
         LR    R13,SV13                                         02S0234
*IF SPACESW = ON THEN                  /*IF OLD TCTIOT EXISTS        */
         TM    SPACESW,B'01000000'                              02S0236
         BNO   @RF00236                                         02S0236
*  DO;                                                          02S0237
*    RFY (REG0,REG1) RSTD;                                      02S0238
*    REG0 = TCTOLDP -> TCTPLEXT;       /*LEN CORE AND SUBPOOL TO FREE*/
         L     @12,TCTOLDP                                      02S0239
         L     REG0,TCTPLEXT(,@12)                              02S0239
*    REG1 = TCTOLDP;                   /*PTR TO CORE TO FREE         */
         LR    REG1,@12                                         02S0240
*    GEN ( FREEMAIN R,LV=(0),A=(1)  ); /*FREE OLD TCTIOT             */
          FREEMAIN R,LV=(0),A=(1)
*    RFY (REG0,REG1) UNRSTD;                                    02S0242
*  END;                                                         02S0243
* DO; /*MODESET  EXTKEY(SCHED)*/                                02S0244
@RF00236 DS    0H                                               02S0245
*   SPKA (16); /*SET PSW KEY*/                                  02S0245
         LA    @12,16                                           02S0245
         SPKA  0(@12)                                           02S0245
* END; /*MODESET  EXTKEY(SCHED)*/               /*GET SCHED KEY 02S0246
*      */                                                       02S0246
*  END;                                                         01S0247
*ELSE;                                 /*ERROR OCCURED               */
@RF00198 DS    0H                                               01S0249
*RETURN CODE(ZERO);                                             01S0249
*                                                               01S0249
*                                                               01S0249
         IC    @02,@OLDKEY                                      01S0249
         L     @13,4(,@13)                                      01S0249
         L     @00,@SIZDATD                                     01S0249
         LR    @01,@09                                          01S0249
         FSPACE   R,LV=(0),A=(1)
         MODESET KEYADDR=(2)
         SLR   @15,@15                                          01S0249
         L     @14,12(,@13)                                     01S0249
         LM    @00,@12,20(@13)                                  01S0249
         BR    @14                                              01S0249
* DECLARE /* COMMON VARIABLES */                                01S0250
*   I256C CHAR(256) BASED,                                      01S0250
*   I031F FIXED(31) BASED,                                      01S0250
*   I031P PTR(31)   BASED,                                      01S0250
*   I015F FIXED(15) BASED,                                      01S0250
*   I015P PTR(15)   BASED,                                      01S0250
*   I008P PTR(8)    BASED,                                      01S0250
*   I001C CHAR(1)   BASED;                                      01S0250
*END IEFDB4F8                                                   01S0251
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (B4F8SPEC)                                        *
*/*%INCLUDE SYSLIB  (B4F8DATA)                                        *
*/*%INCLUDE SYSLIB  (IEFTCT  )                                        *
*/*%INCLUDE SYSLIB  (IHADSAB )                                        *
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                        *
*/*%INCLUDE SYSLIB  (IEFZB451)                                        *
*/*%INCLUDE SYSLIB  (IHAFRRS )                                        *
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        *
*/*%INCLUDE SYSLIB  (IHAPSA  )                                        *
*/*%INCLUDE SYSLIB  (CALCSIZE)                                        *
*/*%INCLUDE SYSLIB  (CALCSPEC)                                        *
*/*%INCLUDE SYSLIB  (CHKSPACE)                                        *
*/*%INCLUDE SYSLIB  (CHKSSPEC)                                        *
*/*%INCLUDE SYSLIB  (EXPANDTB)                                        *
*/*%INCLUDE SYSLIB  (EXPNSPEC)                                        *
*/*%INCLUDE SYSLIB  (OBTCTIOT)                                        *
*/*%INCLUDE SYSLIB  (OBTCSPEC)                                        *
*/*%INCLUDE SYSLIB  (MVTCTIOT)                                        *
*/*%INCLUDE SYSLIB  (MVTCSPEC)                                        *
*/*%INCLUDE SYSLIB  (UPTCTIOT)                                        *
*/*%INCLUDE SYSLIB  (UPDTSPEC)                                        *
*;                                                              01S0251
@DATA    DS    0H
@CH00044 DC    H'1'
@CH00121 DC    H'4'
@CH00041 DC    H'5'
@CH00105 DC    H'8'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@TF00001 DS    F
IEFDB4F8 CSECT
         DS    0F
@CF01132 DC    F'-8'
@CF01128 DC    F'-5'
@CF01131 DC    F'-4'
@CF00151 DC    XL4'FF000000'
@DATD    DSECT
         DS    0D
NEXTLUEP DS    A
NXTCNTEP DS    A
OLDCNTP  DS    A
SPACEPTR DS    A
TCTOLDP  DS    A
ADDLDDNO DS    F
ADDLDVEN DS    F
CURRDDNO DS    F
CURRSIZE DS    F
EXTRSIZE DS    F
RETCODE  DS    F
SIZEMOVE DS    F
TOTDDENT DS    F
TOTDVENT DS    F
DSABPTR  DS    A
TIOTPTR  DS    A
FRRSPTR  DS    A
FRREPTR  DS    A
FREESIZE DS    F
FROMPTR  DS    A
MOVEVAL  DS    F
TOPTR    DS    A
VARLEN   DS    F
MOVEDIST DS    H
TCTOUTLM DS    CL8
SWCHBYT1 DS    BL1
         ORG   SWCHBYT1
EXITSW   DS    BL1
SPACESW  EQU   SWCHBYT1+0
@NM00006 EQU   SWCHBYT1+0
         ORG   SWCHBYT1+1
@OLDKEY  DS    AL1
IEFDB4F8 CSECT
         DS    0F
@SIZDATD DC    AL1(230)
         DC    AL3(@ENDDATD-@DATD)
@CV00075 DC    V(IEFDB403)
         DS    0D
GTSTZERO DC    F'0'
IEFDB4F8 CSECT
         DS   0H
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEFDB4F8 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GTSTRTCD EQU   @11
SV13     EQU   @04
NUMDVENT EQU   @03
MOVELEN  EQU   @07
K        EQU   @03
I        EQU   @02
GETSIZE  EQU   @12
COUNTLUT EQU   @02
COUNT    EQU   @03
ADDLSIZE EQU   @07
TIOTDDP  EQU   @05
TCTLUPTR EQU   @02
TCTLUENP EQU   @08
TCTDVENP EQU   @04
OLDLUTP  EQU   @06
NEWENDP  EQU   @05
PARMFRRP EQU   @08
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG15    EQU   @15
GTSTR0   EQU   @00
GTSTR1   EQU   @01
GTSTR2   EQU   @02
GTSTR15  EQU   @15
GTSTR4   EQU   @04
GTSTR5   EQU   @05
GTSTR6   EQU   @06
GTSTR7   EQU   @07
GTSTR8   EQU   @08
GTSTR3   EQU   @03
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
NEWEND   EQU   0
OLDEND   EQU   0
PARMFRR  EQU   0
FRRP     EQU   PARMFRR
TCTDVENT EQU   0
TCTDUCBP EQU   TCTDVENT
TCTDSCTR EQU   TCTDVENT+2
TCTFLAGS EQU   TCTDVENT+3
TCTFLAG3 EQU   TCTFLAGS
TCTLUENT EQU   0
TCTIOTO  EQU   TCTLUENT
TCTCNTEO EQU   TCTLUENT+2
SMFTCT   EQU   0
TCTSW    EQU   SMFTCT+3
TCTIEX   EQU   TCTSW
TCTCRTBL EQU   SMFTCT+8
TCTIOTBL EQU   SMFTCT+12
TCTPOOL  EQU   SMFTCT+16
TCTJSTX  EQU   SMFTCT+36
TCTTJLM  EQU   SMFTCT+40
TCTPGSMF EQU   SMFTCT+64
TCTPGIN  EQU   TCTPGSMF
TCTPGOUT EQU   TCTPGSMF+4
TCTCORE  EQU   0
TCTTIOT  EQU   0
TCTPLEXT EQU   TCTTIOT
TCTSZEXT EQU   TCTPLEXT+2
TCTSZLKP EQU   TCTTIOT+4
TCTIODSP EQU   0
TCTDCBTD EQU   TCTIODSP
TCTIOTSD EQU   TCTIODSP+2
TCTDCBLE EQU   TCTIODSP+4
DSAB     EQU   0
DSABTIOT EQU   DSAB+16
DSABGIDP EQU   DSAB+24
DSABANMP EQU   DSAB+28
DSABORG  EQU   DSAB+32
DSABORG1 EQU   DSABORG
DSABORG2 EQU   DSABORG+1
DSABFLG1 EQU   DSAB+34
DSABFLG2 EQU   DSAB+35
DSABFLG3 EQU   DSAB+36
DSABFLG4 EQU   DSAB+37
DSABANMI EQU   0
DSABGIDL EQU   0
TIOT1    EQU   0
TIOENTRY EQU   0
TIOESTTA EQU   TIOENTRY+1
TIOERLOC EQU   TIOENTRY+2
TIOEWTCT EQU   TIOERLOC
TIOELINK EQU   TIOERLOC+1
TIOESYOT EQU   TIOELINK
TIOESTTC EQU   TIOENTRY+15
TIOESTTB EQU   TIOENTRY+16
POOLSTAR EQU   TIOENTRY+20
FRRPARMS EQU   0
FRRPARM  EQU   FRRPARMS+120
TCTIOP   EQU   FRRPARM+8
TCTIOLN  EQU   FRRPARM+12
FRRFLAGS EQU   FRRPARM+20
FRRZERO  EQU   FRRFLAGS
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSENTR EQU   0
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBTIO   EQU   TCB+12
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
NEWLUTAB EQU   0
OLDLUTAB EQU   0
TCBPTR   EQU   0
LIST     EQU   0
TIOTENTP EQU   LIST
LISTFLAG EQU   LIST+4
LASTINDC EQU   LISTFLAG
VAMINDC  EQU   LISTFLAG
FRRPARMP EQU   0
TCTSPOOL EQU   TCTPLEXT
TCTDDENT EQU   TCTDCBLE+4
TCTUCBP  EQU   TCTDDENT
TCTSCTR  EQU   TCTDDENT+2
TCTFLGS  EQU   TCTDDENT+3
TCTDCTR  EQU   TCTDDENT+4
TIOEDEVE EQU   TIOESTTB
TIOSTTB  EQU   TIOEDEVE
TIOUCBP  EQU   TIOEDEVE+1
PSARSVTE EQU   PSARSVT
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
TIOVERF  EQU   TIOSTTB
TIOUNLD  EQU   TIOSTTB
TIOMNTD  EQU   TIOSTTB
TIOSETU  EQU   TIOSTTB
TIOVLSR  EQU   TIOSTTB
TIOPVIO  EQU   TIOSTTB
TIOREQD  EQU   TIOSTTB
TIOUSED  EQU   TIOSTTB
TCTTKRLD EQU   TCTDDENT+13
TCTEXRLD EQU   TCTDDENT+12
TCTRSV10 EQU   TCTDDENT+8
TCTRSV26 EQU   TCTFLGS
TCTRSV25 EQU   TCTFLGS
TCTRSV24 EQU   TCTFLGS
TCTRSV23 EQU   TCTFLGS
TCTRSV22 EQU   TCTFLGS
TCTRSV21 EQU   TCTFLGS
TCTVAMDS EQU   TCTFLGS
TCTDDIND EQU   TCTFLGS
@NM00001 EQU   LISTFLAG
@NM00022 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00021 EQU   TCB+296
TCBRV185 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBRSV35 EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00020 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBRSV04 EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00019 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
FRRSPARM EQU   FRRSENTR+8
@NM00018 EQU   FRRSFLGS+1
@NM00017 EQU   FRRSFLG1
FRRSNEST EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSFRRA EQU   FRRSENTR
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
FRRSCURR EQU   FRRSHEAD+12
FRRSELEN EQU   FRRSHEAD+8
FRRSLAST EQU   FRRSHEAD+4
FRRSEMP  EQU   FRRSHEAD
@NM00016 EQU   FRRFLAGS
EXTCTIOP EQU   FRRPARM+16
DESTAPTR EQU   FRRPARM+4
TCTPTR   EQU   FRRPARM
FRRAUTO  EQU   FRRPARMS
TIOTFEND EQU   POOLSTAR+16
TIOPSLOT EQU   POOLSTAR+13
TIOPSTTB EQU   POOLSTAR+12
TIOPPOOL EQU   POOLSTAR+4
TIOPNSRT EQU   POOLSTAR+3
@NM00015 EQU   POOLSTAR+2
TIOPNSLT EQU   POOLSTAR+1
@NM00014 EQU   POOLSTAR
TIOEFSRT EQU   TIOENTRY+17
TIOSVERF EQU   TIOESTTB
TIOSUNLD EQU   TIOESTTB
TIOSMNTD EQU   TIOESTTB
TIOSSETU EQU   TIOESTTB
TIOSVLSR EQU   TIOESTTB
TIOSPVIO EQU   TIOESTTB
TIOSREQD EQU   TIOESTTB
TIOSUSED EQU   TIOESTTB
TIOSBALS EQU   TIOESTTC
TIOSBALP EQU   TIOESTTC
TIOSVOLS EQU   TIOESTTC
TIOSVOLP EQU   TIOESTTC
TIOSAFFS EQU   TIOESTTC
TIOSAFFP EQU   TIOESTTC
TIOSDEFR EQU   TIOESTTC
TIOSDKCR EQU   TIOESTTC
TIOEJFCB EQU   TIOENTRY+12
TIOEDDNM EQU   TIOENTRY+4
TIOTREM  EQU   TIOELINK
TIOESSDS EQU   TIOESYOT
TIOESYIN EQU   TIOELINK
TIOEQNAM EQU   TIOELINK
TIOEDYNM EQU   TIOELINK
TIOTTERM EQU   TIOELINK
TIOTRV01 EQU   TIOELINK
TIOSYOUT EQU   TIOELINK
TIOSDSP2 EQU   TIOESTTA
TIOSDSP1 EQU   TIOESTTA
TIOSLABL EQU   TIOESTTA
TIOSDADS EQU   TIOESTTA
TIOSJBLB EQU   TIOESTTA
TIOSPLTS EQU   TIOESTTA
TIOSPLTP EQU   TIOESTTA
TIOSLTYP EQU   TIOESTTA
TIOELNGH EQU   TIOENTRY
TIOCSTEP EQU   TIOT1+8
TIOCNJOB EQU   TIOT1
DSABGRID EQU   DSABGIDL+4
DSABLLEN EQU   DSABGIDL
DSABANAM EQU   DSABANMI+1
DSABANML EQU   DSABANMI
DSABRS04 EQU   DSAB+68
DSABSIOT EQU   DSAB+64
DSABRS03 EQU   DSAB+62
DSABDCBM EQU   DSAB+56
DSABSSCM EQU   DSAB+52
DSABSSNM EQU   DSAB+48
DSABPTTR EQU   DSAB+44
DSABTCBP EQU   DSAB+40
DSABRS02 EQU   DSAB+38
@NM00013 EQU   DSABFLG4
DSABCKSI EQU   DSABFLG4
DSABCKVL EQU   DSABFLG4
DSABCKDS EQU   DSABFLG4
@NM00012 EQU   DSABFLG3
DSABJSCT EQU   DSABFLG3
DSABCATL EQU   DSABFLG3
DSABVMSC EQU   DSABFLG3
DSABVAM  EQU   DSABFLG3
DSABPASS EQU   DSABFLG3
DSABDEFR EQU   DSABFLG3
@NM00011 EQU   DSABFLG2
DSABUNAL EQU   DSABFLG2
DSABIRM  EQU   DSABFLG2
DSABOPEN EQU   DSABFLG2
DSABNUSE EQU   DSABFLG1
DSABCATM EQU   DSABFLG1
DSABPCAT EQU   DSABFLG1
DSABDCAT EQU   DSABFLG1
DSABCONV EQU   DSABFLG1
DSABDCNV EQU   DSABFLG1
DSABPALC EQU   DSABFLG1
DSABDALC EQU   DSABFLG1
@NM00010 EQU   DSABORG2
DSABTR   EQU   DSABORG2
DSABAM   EQU   DSABORG2
@NM00009 EQU   DSABORG2
DSABTQ   EQU   DSABORG2
DSABTX   EQU   DSABORG2
DSABGS   EQU   DSABORG2
DSABU    EQU   DSABORG1
DSABPO   EQU   DSABORG1
DSABMQ   EQU   DSABORG1
DSABCQ   EQU   DSABORG1
DSABCX   EQU   DSABORG1
DSABDA   EQU   DSABORG1
DSABPS   EQU   DSABORG1
DSABIS   EQU   DSABORG1
DSABSSVA EQU   DSAB+21
DSABRS01 EQU   DSAB+20
DSABOPCT EQU   DSAB+14
DSABLNTH EQU   DSAB+12
DSABBCHN EQU   DSAB+8
DSABFCHN EQU   DSAB+4
DSABID   EQU   DSAB
TCTRSV11 EQU   TCTTIOT+6
@NM00008 EQU   TCTPLEXT
TCTLCS   EQU   TCTCORE+16
TCTRBA   EQU   TCTCORE+12
TCTRSZ   EQU   TCTCORE+10
TCTMINC  EQU   TCTCORE+8
TCTHWM   EQU   TCTCORE+4
TCTLWM   EQU   TCTCORE
TCTSOUT  EQU   TCTPGSMF+16
TCTSIN   EQU   TCTPGSMF+12
TCTRGNS  EQU   TCTPGSMF+8
TCTACT   EQU   TCTPGOUT
TCTAJS   EQU   TCTPGIN
TCTPPST  EQU   SMFTCT+60
TCTAST   EQU   SMFTCT+56
TCTLOUT  EQU   SMFTCT+52
TCTLIN   EQU   SMFTCT+48
TCTWLMT  EQU   SMFTCT+44
TCTSACT  EQU   TCTTJLM
TCTSTOF  EQU   TCTJSTX
TCTRSV08 EQU   SMFTCT+32
TCTJMR   EQU   SMFTCT+28
TCTUDATA EQU   SMFTCT+24
TCTUTL   EQU   SMFTCT+20
TCTSZE   EQU   TCTPOOL+2
@NM00007 EQU   TCTPOOL
TCTTCB   EQU   SMFTCT+4
TCTRSV07 EQU   TCTSW
TCTRSV06 EQU   TCTSW
TCTRSV05 EQU   TCTSW
TCTRSV04 EQU   TCTSW
TCTRSV03 EQU   TCTSW
TCTRSV02 EQU   TCTSW
TCTJSTI  EQU   TCTSW
TCTQA    EQU   SMFTCT
TCTDDCTR EQU   TCTDVENT+4
@NM00005 EQU   TCTFLAGS
@NM00004 EQU   TCTFLAGS
@NM00003 EQU   PARMFRR+8
@NM00002 EQU   PARMFRR+4
@NM00046 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00045 EQU   PSA+1040
PSAUSEND EQU   PSA+1040
PSARV062 EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00044 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00043 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSARV011 EQU   PSASUP3
PSARV010 EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSAIPCRP EQU   PSASUP1
PSAIPCDR EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00042 EQU   FLCFSA
@NM00041 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00040 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00039 EQU   FLCIOA
@NM00038 EQU   FLCMCLA+15
@NM00037 EQU   FLCMCLA+14
@NM00036 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00035 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00034 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00033 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00032 EQU   FLCPER
@NM00031 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00030 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00029 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00028 EQU   FLCPIILC
@NM00027 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00026 EQU   FLCSVILC
@NM00025 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00024 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00023 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RC00149 EQU   @RC00115
@ENDDATA EQU   *
         END   IEFDB4F8,(C'PLS1910',0701,75304)
